From marcelino.delacruz at upm.es  Thu Sep  1 12:07:53 2011
From: marcelino.delacruz at upm.es (marcelino.delacruz at upm.es)
Date: Thu, 01 Sep 2011 11:07:53 +0100
Subject: [R-sig-Geo] spatstat - how to choose an optimal bandwidth for
	smooth.ppp?
In-Reply-To: <CAGfc75mUG6vHsng_XD1O36EkJkm5n8mS6gAsZAALdfCR72_PyA@mail.gmail.com>
Message-ID: <PXOxSEIj.1314871673.9277140.marcelino.delacruz@upm.es>

Hi,
I dont know if there is an equivalent method to MSE for the density of
weighted points or the same method would apply, but for the question on
the default bandwith in smooth.ppp, you can see that smooth.ppp calls
density.ppp, and here, if not sigma is given, it takes sigma as  1/8 of
the minimum windows side. From the code of density.ppp:


 w <- x$window
        sigma <- (1/8) * min(diff(w$xrange), diff(w$yrange))

Cheers,

Marcelino


Con fecha 31/8/2011, "Mathieu Rajerison" <mathieu.rajerison at gmail.com>
escribi?:

>Hi,
>
>
>I know how to determine an optimal bandwidth for the kernel density of
>points using mean suared error method as possible with splancs package.
>
>But I was wondering if there was an equivalent method for the density of
>weighted points as performed by spatstat::smooth.ppp
>Also,how is bandwidth chosen by default when launching smooth.ppp(X)?
>
>
>Thanks,
>
>Mathieu
>
>	[[alternative HTML version deleted]]
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From mathieu.rajerison at gmail.com  Thu Sep  1 12:51:21 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Thu, 1 Sep 2011 12:51:21 +0200
Subject: [R-sig-Geo] spatstat - how to choose an optimal bandwidth for
	smooth.ppp?
In-Reply-To: <PXOxSEIj.1314871673.9277140.marcelino.delacruz@upm.es>
References: <CAGfc75mUG6vHsng_XD1O36EkJkm5n8mS6gAsZAALdfCR72_PyA@mail.gmail.com>
	<PXOxSEIj.1314871673.9277140.marcelino.delacruz@upm.es>
Message-ID: <CAGfc75n9_hRD_1WCg0DNq3_FvOmZ=VGj=YpYjLP3-BdVu-0LCg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110901/933214b5/attachment.pl>

From Giulia.Conchedda at fao.org  Thu Sep  1 14:41:14 2011
From: Giulia.Conchedda at fao.org (Conchedda, Giulia (AGAL))
Date: Thu, 01 Sep 2011 14:41:14 +0200
Subject: [R-sig-Geo] R-sig-Geo Digest, Vol 97, Issue 1
In-Reply-To: <mailman.17.1314871207.14711.r-sig-geo@r-project.org>
References: <mailman.17.1314871207.14711.r-sig-geo@r-project.org>
Message-ID: <7FAA73D70AEE6B4BA5BE48F8BD97BC9A0267905046@HQEXDB02.hq.un.fao.org>

Hi to All,

My question concerns the best practice to compare cell-by-cell two grids that are representing the same phenomenon (distribution of rural poor). The grids have the same spatial extent and cell size and I would like to quantify and provide statistics on how pixel values in the two grids differ. I first subtracted one from the other and in this way I can already say and spot where differences are more frequent. What is the best statistics to quantify this difference?

Thanks for advising,

Giulia


From mathieu.rajerison at gmail.com  Thu Sep  1 14:57:55 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Thu, 1 Sep 2011 14:57:55 +0200
Subject: [R-sig-Geo] R-sig-Geo Digest, Vol 97, Issue 1
In-Reply-To: <7FAA73D70AEE6B4BA5BE48F8BD97BC9A0267905046@HQEXDB02.hq.un.fao.org>
References: <mailman.17.1314871207.14711.r-sig-geo@r-project.org>
	<7FAA73D70AEE6B4BA5BE48F8BD97BC9A0267905046@HQEXDB02.hq.un.fao.org>
Message-ID: <CAGfc75=O8CwzUdJQHygSsy+JgrCz6d-4X5x_08O1sa_wUb=5=A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110901/1ee05e65/attachment.pl>

From mathieu.rajerison at gmail.com  Thu Sep  1 15:31:08 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Thu, 1 Sep 2011 15:31:08 +0200
Subject: [R-sig-Geo] R-sig-Geo Digest, Vol 97, Issue 1
In-Reply-To: <CAGfc75=O8CwzUdJQHygSsy+JgrCz6d-4X5x_08O1sa_wUb=5=A@mail.gmail.com>
References: <mailman.17.1314871207.14711.r-sig-geo@r-project.org>
	<7FAA73D70AEE6B4BA5BE48F8BD97BC9A0267905046@HQEXDB02.hq.un.fao.org>
	<CAGfc75=O8CwzUdJQHygSsy+JgrCz6d-4X5x_08O1sa_wUb=5=A@mail.gmail.com>
Message-ID: <CAGfc75=gQvJ4+A_1qR40yz=wyTYjTjzSYjAwbkXPjhH2-DAb4g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110901/ca7931b0/attachment.pl>

From a.mosnier at gmail.com  Thu Sep  1 19:20:11 2011
From: a.mosnier at gmail.com (Arnaud Mosnier)
Date: Thu, 1 Sep 2011 13:20:11 -0400
Subject: [R-sig-Geo] Read HDF files
Message-ID: <CANkFkEeQ1fZTnUXgv9FdrEu0KWspL9N3m-EMSP5ty=VpcqFf4A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110901/cf94adcf/attachment.pl>

From alexandre.castagna at gmail.com  Thu Sep  1 19:37:08 2011
From: alexandre.castagna at gmail.com (Alexandre Castagna)
Date: Thu, 1 Sep 2011 14:37:08 -0300
Subject: [R-sig-Geo] Read HDF files
In-Reply-To: <CANkFkEeQ1fZTnUXgv9FdrEu0KWspL9N3m-EMSP5ty=VpcqFf4A@mail.gmail.com>
References: <CANkFkEeQ1fZTnUXgv9FdrEu0KWspL9N3m-EMSP5ty=VpcqFf4A@mail.gmail.com>
Message-ID: <CAFiuoh+UenzJsfvuGVxTWSmqE9Q_cZAXyA9dvcBWNm6UXLkfrw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110901/80957cf7/attachment.pl>

From PDowney at urban.org  Thu Sep  1 19:58:31 2011
From: PDowney at urban.org (Downey, Patrick)
Date: Thu, 1 Sep 2011 13:58:31 -0400
Subject: [R-sig-Geo] Simulating spatially autocorrelated data
Message-ID: <0F96478603980B46AAAFBA77069582ED131C7A25@UIEXCH.urban.org>

Hello all,

I'm trying to simulate a spatially autocorrelated random variable, and I
cannot figure out what the problem is. All I want is a simple spatial lag
model where

Y = rho*W*Y + e

Where e is a vector of iid normal random variables, rho is the
autocorrelation, W is a row-normalized distance matrix (a spatial weights
matrix), and Y is the random variable.

I thought the following program should do it, but it's not working. At the
end of the program, I calculate Moran's I, and it is not even close to
rejecting the null hypothesis of no spatial autocorrelation, even when rho
is very high (for example, below, rho is 0.95). Can someone please identify
what the problem is and offer some guidance on how to fix it?

PS - I apologize in advance, but I am not familiar with R's spatial
packages. I've done very little spatial analysis in R, so if there's a
package that can already do this, please recommend.

BEGIN PROGRAM:

install.packages("fields");library(fields)
install.packages("ape");library(ape)

N <- 200
rho <- 0.95

x.coord <- runif(N,0,100)
y.coord <- runif(N,0,100)

points <- cbind(x.coord,y.coord)

e <- rnorm(N,0,1)

dist.nonnorm <- rdist(points,points)   # Matrix of Euclidean distances
dist <- dist.nonnorm/rowSums(dist.nonnorm)   # Row normalizing the distance
matrix
diag(dist) <- 0   # Ensuring that the main diagonal is exactly 0

I <- diag(N)   # Identity matrix (not Moran's I)

inv <- solve(I-rho.lag*dist)   # Inverting (I - rho*W)
y <- as.vector(inv %*% e)   # Generating data that is supposed to be
spatially autocorrelated

Moran.I(y,dist)   # Does not reject null hypothesis of no spatial
autocorrelation


From tgriffin at uaex.edu  Thu Sep  1 20:07:40 2011
From: tgriffin at uaex.edu (Terry Griffin)
Date: Thu, 1 Sep 2011 13:07:40 -0500
Subject: [R-sig-Geo] Simulating spatially autocorrelated data
In-Reply-To: <0F96478603980B46AAAFBA77069582ED131C7A25@UIEXCH.urban.org>
Message-ID: <c2ab2a6d-cb1c-4e15-a093-d5cce11cfa0e@zmail.uaex.edu>

Patrick,

Good questions, the package spdep has the functions you are looking for, specifically invIrM or invIrW. I suspect you'll figure it out from there but if not, please respond back.

Terry

Terry Griffin, Ph.D. 
Associate Professor - Economics 
University of Arkansas - Division of Agriculture 
501.249.6360 (SMS)
tgriffin at uaex.edu 




----- Original Message -----
From: "Patrick Downey" <PDowney at urban.org>
To: r-sig-geo at stat.math.ethz.ch
Sent: Thursday, September 1, 2011 12:58:31 PM
Subject: [R-sig-Geo] Simulating spatially autocorrelated data

Hello all,

I'm trying to simulate a spatially autocorrelated random variable, and I
cannot figure out what the problem is. All I want is a simple spatial lag
model where

Y = rho*W*Y + e

Where e is a vector of iid normal random variables, rho is the
autocorrelation, W is a row-normalized distance matrix (a spatial weights
matrix), and Y is the random variable.

I thought the following program should do it, but it's not working. At the
end of the program, I calculate Moran's I, and it is not even close to
rejecting the null hypothesis of no spatial autocorrelation, even when rho
is very high (for example, below, rho is 0.95). Can someone please identify
what the problem is and offer some guidance on how to fix it?

PS - I apologize in advance, but I am not familiar with R's spatial
packages. I've done very little spatial analysis in R, so if there's a
package that can already do this, please recommend.

BEGIN PROGRAM:

install.packages("fields");library(fields)
install.packages("ape");library(ape)

N <- 200
rho <- 0.95

x.coord <- runif(N,0,100)
y.coord <- runif(N,0,100)

points <- cbind(x.coord,y.coord)

e <- rnorm(N,0,1)

dist.nonnorm <- rdist(points,points)   # Matrix of Euclidean distances
dist <- dist.nonnorm/rowSums(dist.nonnorm)   # Row normalizing the distance
matrix
diag(dist) <- 0   # Ensuring that the main diagonal is exactly 0

I <- diag(N)   # Identity matrix (not Moran's I)

inv <- solve(I-rho.lag*dist)   # Inverting (I - rho*W)
y <- as.vector(inv %*% e)   # Generating data that is supposed to be
spatially autocorrelated

Moran.I(y,dist)   # Does not reject null hypothesis of no spatial
autocorrelation

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Roger.Bivand at nhh.no  Thu Sep  1 20:20:10 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 1 Sep 2011 20:20:10 +0200
Subject: [R-sig-Geo] Simulating spatially autocorrelated data
In-Reply-To: <0F96478603980B46AAAFBA77069582ED131C7A25@UIEXCH.urban.org>
References: <0F96478603980B46AAAFBA77069582ED131C7A25@UIEXCH.urban.org>
Message-ID: <alpine.LRH.2.00.1109012013370.6846@reclus.nhh.no>

On Thu, 1 Sep 2011, Downey, Patrick wrote:

> Hello all,
>
> I'm trying to simulate a spatially autocorrelated random variable, and I
> cannot figure out what the problem is. All I want is a simple spatial lag
> model where
>
> Y = rho*W*Y + e
>
> Where e is a vector of iid normal random variables, rho is the
> autocorrelation, W is a row-normalized distance matrix (a spatial weights
> matrix), and Y is the random variable.
>
> I thought the following program should do it, but it's not working. At the
> end of the program, I calculate Moran's I, and it is not even close to
> rejecting the null hypothesis of no spatial autocorrelation, even when rho
> is very high (for example, below, rho is 0.95). Can someone please identify
> what the problem is and offer some guidance on how to fix it?
>
> PS - I apologize in advance, but I am not familiar with R's spatial
> packages. I've done very little spatial analysis in R, so if there's a
> package that can already do this, please recommend.
>
> BEGIN PROGRAM:
>
> install.packages("fields");library(fields)
> install.packages("ape");library(ape)
>
> N <- 200
> rho <- 0.95
>
> x.coord <- runif(N,0,100)
> y.coord <- runif(N,0,100)
>
> points <- cbind(x.coord,y.coord)
>
> e <- rnorm(N,0,1)
>
> dist.nonnorm <- rdist(points,points)   # Matrix of Euclidean distances
> dist <- dist.nonnorm/rowSums(dist.nonnorm)   # Row normalizing the distance
> matrix
> diag(dist) <- 0   # Ensuring that the main diagonal is exactly 0

I think that you are using the distances as weights, not inverse 
distances, which seems more sensible.

>
> I <- diag(N)   # Identity matrix (not Moran's I)
>
> inv <- solve(I-rho.lag*dist)   # Inverting (I - rho*W)
> y <- as.vector(inv %*% e)   # Generating data that is supposed to be
> spatially autocorrelated
>
> Moran.I(y,dist)   # Does not reject null hypothesis of no spatial
> autocorrelation
>

As Terry Griffin says, you can use spdep for this:

library(spdep)
rho <- 0.95
N <- 200
x.coord <- runif(N,0,100)
y.coord <- runif(N,0,100)
points <- cbind(x.coord,y.coord)
e <- rnorm(N,0,1)
dnb <- dnearneigh(points, 0, 150)
dsts <- nbdists(dnb, points)
idw <- lapply(dsts, function(x) 1/x)
lw <- nb2listw(dnb, glist=idw, style="W")
inv <- invIrW(lw, rho)
y <- inv %*% e
moran.test(y, lw)

to reproduce your analysis with IDW, here without:

lw <- nb2listw(dnb, glist=dsts, style="W")
inv <- invIrW(lw, rho)
y <- inv %*% e
moran.test(y, lw)
# no autocorrelation

and here with a less inclusive distance threshold:

dnb <- dnearneigh(points, 0, 15)
dsts <- nbdists(dnb, points)
idw <- lapply(dsts, function(x) 1/x)
lw <- nb2listw(dnb, glist=idw, style="W")
inv <- invIrW(lw, rho)
y <- inv %*% e
moran.test(y, lw)


the larger the distance threshold, the less well the spatial process is 
captured, alternatively use idw <- lapply(dsts, function(x) 1/(x^2)), for 
example, to attenuate the weights more sharply.

Hope this clarifies,

Roger

> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From amorenos1 at ucentral.edu.co  Fri Sep  2 00:12:00 2011
From: amorenos1 at ucentral.edu.co (Angelo Moreno)
Date: Thu, 1 Sep 2011 15:12:00 -0700 (PDT)
Subject: [R-sig-Geo] Add shape over a ppp density plot
Message-ID: <1314915120820-6751971.post@n2.nabble.com>

Hi, I have  created a ppp with coordinates(longitude/lattitude),I have
obtained the density plot:

plot(density.ppp(ppbog07, 0.0003))

then I need, and I would like to see the shape map over this plot...I have
tried with this:

plot(shape,add=T)

but it doesn`t work. What problem could exist or maybe exist another way?

Thanks!

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Add-shape-over-a-ppp-density-plot-tp6751971p6751971.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From juantomas.sayago at gmail.com  Fri Sep  2 00:31:09 2011
From: juantomas.sayago at gmail.com (Juan Tomas Sayago)
Date: Thu, 1 Sep 2011 18:31:09 -0400
Subject: [R-sig-Geo] Add shape over a ppp density plot
In-Reply-To: <1314915120820-6751971.post@n2.nabble.com>
References: <1314915120820-6751971.post@n2.nabble.com>
Message-ID: <CAEOXpND_9cZY913---Guu5Cmwr2hPQXWtFwkViXX1RC_6u6O0Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110901/c9259c8a/attachment.pl>

From paul.hiemstra at knmi.nl  Fri Sep  2 09:22:47 2011
From: paul.hiemstra at knmi.nl (Paul Hiemstra)
Date: Fri, 02 Sep 2011 07:22:47 +0000
Subject: [R-sig-Geo] Read HDF files
In-Reply-To: <CANkFkEeQ1fZTnUXgv9FdrEu0KWspL9N3m-EMSP5ty=VpcqFf4A@mail.gmail.com>
References: <CANkFkEeQ1fZTnUXgv9FdrEu0KWspL9N3m-EMSP5ty=VpcqFf4A@mail.gmail.com>
Message-ID: <4E608447.8060107@knmi.nl>

 On 09/01/2011 05:20 PM, Arnaud Mosnier wrote:
> Hi Geo UseRs,
>
> I am searching a way to read and manage HDF files in R (like files provided
> by the ocean color web site, http://oceancolor.gsfc.nasa.gov/).
>
> Thanks
>
> Arnaud
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
The answer can be found by googling for "R read hdf". That leads to the
HDF5 package or building GDAL with HDF support. Alternatively, find a
(command)-line tool which can translate HDF5 to geotiff or netCDF (e.g.
gdal_translate or ) and then use readGDAL or the ncdf package.

Paul

-- 
Paul Hiemstra, Ph.D.
Global Climate Division
Royal Netherlands Meteorological Institute (KNMI)
Wilhelminalaan 10 | 3732 GK | De Bilt | Kamer B 3.39
P.O. Box 201 | 3730 AE | De Bilt
tel: +31 30 2206 494

http://intamap.geo.uu.nl/~paul
http://nl.linkedin.com/pub/paul-hiemstra/20/30b/770


From marcelino.delacruz at upm.es  Fri Sep  2 10:37:44 2011
From: marcelino.delacruz at upm.es (marcelino.delacruz at upm.es)
Date: Fri, 02 Sep 2011 09:37:44 +0100
Subject: [R-sig-Geo] R-sig-Geo Digest, Vol 97, Issue 1
In-Reply-To: <CAGfc75=gQvJ4+A_1qR40yz=wyTYjTjzSYjAwbkXPjhH2-DAb4g@mail.gmail.com>
Message-ID: <eJhXZeDZ.1314952664.0314340.marcelino.delacruz@upm.es>

Lacking more detail on the proposed objectives of this research, I would
suggest Syrjala's test (in the ecespa package) for the difference
between the spatial distributions of two populations.It consists of  a
two-sample Cramer-von Mises (or Kolmogorov-Smirnov)type test for a
difference between the spatial distributions of two populations,
although it focus more on the difference of spatial distributions than
on the differences in abundance between the two ppopulations.

HTH,

Marcelino



Con fecha 1/9/2011, "Mathieu Rajerison" <mathieu.rajerison at gmail.com>
escribi?:

>These statistical tests will only give you an idea on how these two matrixes
>differ but they do not take into account connectivity between cells, and
>dates of samples. And it seems that the difference interests you.
>
>Another test you could use is testing for spatial autocorrelation on using
>spdep package, after having established a list of neighbours for each cell
>with cell2nb.
>The test for sp. autocorrelation can either be global either local.
>
>It seems that you have some space time data. Maybe you should have a look at
>spacetime package, also?
>
>I'm just beginning in spatial statistics. Someone will tell me if I'm wrong.
>
>hth,
>
>Mathieu
>
>2011/9/1 Mathieu Rajerison <mathieu.rajerison at gmail.com>
>
>> Giulia,
>>
>>
>> You may look at Pearson, Student or Kolmogorov Smirnov test
>> cor.test, t.test, and ks.test
>> after having coerced your matrixes into vectors
>>
>> Maybe someone has another idea or thinks my advice is not right?
>>
>> hth
>>
>> Mathieu
>>
>> 2011/9/1 Conchedda, Giulia (AGAL) <Giulia.Conchedda at fao.org>
>>
>> Hi to All,
>>>
>>> My question concerns the best practice to compare cell-by-cell two grids
>>> that are representing the same phenomenon (distribution of rural poor). The
>>> grids have the same spatial extent and cell size and I would like to
>>> quantify and provide statistics on how pixel values in the two grids differ.
>>> I first subtracted one from the other and in this way I can already say and
>>> spot where differences are more frequent. What is the best statistics to
>>> quantify this difference?
>>>
>>> Thanks for advising,
>>>
>>> Giulia
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>>
>
>	[[alternative HTML version deleted]]
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From janverbesselt at gmail.com  Fri Sep  2 13:58:50 2011
From: janverbesselt at gmail.com (janverbesselt)
Date: Fri, 2 Sep 2011 04:58:50 -0700 (PDT)
Subject: [R-sig-Geo] Read HDF files
In-Reply-To: <CANkFkEeQ1fZTnUXgv9FdrEu0KWspL9N3m-EMSP5ty=VpcqFf4A@mail.gmail.com>
References: <CANkFkEeQ1fZTnUXgv9FdrEu0KWspL9N3m-EMSP5ty=VpcqFf4A@mail.gmail.com>
Message-ID: <1314964730610-6753611.post@n2.nabble.com>

You can try something like this;

# check out the raster and rgdal packages
library(raster)
library(rgdal)
# have the files in your current wd()
# for MODIS data MOD13C1 I do the following
fl <- list.files(pattern="\\.hdf$", recursive = TRUE) # without directories
GDALinfo(modis) # check out the name using this function
fndvi <- paste("HDF4_EOS:EOS_GRID:",fl[1],":MODIS_Grid_16Day_VI_CMG:CMG 0.05
Deg 16 days NDVI",sep='')

# then extract raster info and data and much more
system.time(data <- readGDAL(fndvi, offset=c(0,0), region.dim=c(1, 1))) #
centre is at (0,0)
parameters <- gridparameters(data)
res <- parameters$cellsize[1]
res

good luck.
Jan
http://www.grs.wur.nl/UK/Staff/Jan+Verbesselt/
http://bfast.r-forge.r-project.org/


--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Read-HDF-files-tp6750856p6753611.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From a.mosnier at gmail.com  Fri Sep  2 15:35:44 2011
From: a.mosnier at gmail.com (Arnaud Mosnier)
Date: Fri, 2 Sep 2011 09:35:44 -0400
Subject: [R-sig-Geo] Read HDF files
In-Reply-To: <4E608447.8060107@knmi.nl>
References: <CANkFkEeQ1fZTnUXgv9FdrEu0KWspL9N3m-EMSP5ty=VpcqFf4A@mail.gmail.com>
	<4E608447.8060107@knmi.nl>
Message-ID: <CANkFkEckJ++BYcj9=97OeGf0oOYTRTqtb7NJG9g-JofntS+JEA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110902/920999cd/attachment.pl>

From georgie.peters at gmail.com  Fri Sep  2 15:44:24 2011
From: georgie.peters at gmail.com (georgie)
Date: Fri, 2 Sep 2011 06:44:24 -0700 (PDT)
Subject: [R-sig-Geo] Ripley's K using ads
Message-ID: <1314971064577-6753910.post@n2.nabble.com>

I'm trying to do Ripley's K analysis using ads (one points shapefile, one
polygon area shapefile). Having created a bounding box than includes my
study area, I triangulated this box against a vertices file of my study
area. 

The triangulation runs without any errors, but when I try to run swin I get
the error message:
Error:!overlapping.polygons(convert(triangles)) is not all TRUE.

If anyone could point me in the right direction of what I'm doing wrong or
what this error message actually means (my searching has turned up nothing
useful) I would be eternally grateful.

Thanks, Georgie.

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Ripley-s-K-using-ads-tp6753910p6753910.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From janverbesselt at gmail.com  Fri Sep  2 15:50:09 2011
From: janverbesselt at gmail.com (janverbesselt)
Date: Fri, 2 Sep 2011 06:50:09 -0700 (PDT)
Subject: [R-sig-Geo] Read HDF files
In-Reply-To: <CANkFkEckJ++BYcj9=97OeGf0oOYTRTqtb7NJG9g-JofntS+JEA@mail.gmail.com>
References: <CANkFkEeQ1fZTnUXgv9FdrEu0KWspL9N3m-EMSP5ty=VpcqFf4A@mail.gmail.com>
	<4E608447.8060107@knmi.nl>
	<CANkFkEckJ++BYcj9=97OeGf0oOYTRTqtb7NJG9g-JofntS+JEA@mail.gmail.com>
Message-ID: <6ED153CE-FB8E-448D-8510-8F801688B268@gmail.com>

Please have a look at the example I provided, it should work for your HDF4 files. The MODIS data I am dealing with comes in HDF4 format. I did not need to build a specific GDAL version that supports HDF4 format.
I am using GDAL available via http://www.kyngchaos.com/software/frameworks for Mac OSx, and the latest version of rgdal for R2.13.1. In which environment are your working?
Best,
Jan


On 02/09/2011, at 3:36 PM, Arnaud Mosnier [via R-sig-geo] wrote:

> Hi Paul, 
> 
> Thanks for your answer ... in fact I googled for that before asking this R 
> list. 
> Oceancolor HDF files are in HDF4 format and provided as two HDF4 format, in 
> SIM (Standard Mapped Image) or BIN (binned). 
> I first tried to use the BIN format without success. I use the gdal version 
> provided with FWtools and gdal_info correctly identify the file as a HDF4 
> format, but it refuses to convert it to a geotiff. 
> I finally succeeded using the SIM format. 
> 
> But, now I am interested in doing that directly into R. 
> The version of gdal called by the library rgdal do not include support for 
> HDF4 format. 
> So my question is now ... can someone give me a step by step instruction 
> that I can use to build a GDAL version including the support for HDF4 format 
> (as it is the case in the version compiled with FWtools) ? 
> 
> Thanks, 
> 
> Arnaud 
> 
> 2011/9/2 Paul Hiemstra <[hidden email]> 
> 
> >  On 09/01/2011 05:20 PM, Arnaud Mosnier wrote: 
> > > Hi Geo UseRs, 
> > > 
> > > I am searching a way to read and manage HDF files in R (like files 
> > provided 
> > > by the ocean color web site, http://oceancolor.gsfc.nasa.gov/). 
> > > 
> > > Thanks 
> > > 
> > > Arnaud 
> > > 
> > >       [[alternative HTML version deleted]] 
> > > 
> > > _______________________________________________ 
> > > R-sig-Geo mailing list 
> > > [hidden email] 
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > The answer can be found by googling for "R read hdf". That leads to the 
> > HDF5 package or building GDAL with HDF support. Alternatively, find a 
> > (command)-line tool which can translate HDF5 to geotiff or netCDF (e.g. 
> > gdal_translate or ) and then use readGDAL or the ncdf package. 
> > 
> > Paul 
> > 
> > -- 
> > Paul Hiemstra, Ph.D. 
> > Global Climate Division 
> > Royal Netherlands Meteorological Institute (KNMI) 
> > Wilhelminalaan 10 | 3732 GK | De Bilt | Kamer B 3.39 
> > P.O. Box 201 | 3730 AE | De Bilt 
> > tel: +31 30 2206 494 
> > 
> > http://intamap.geo.uu.nl/~paul
> > http://nl.linkedin.com/pub/paul-hiemstra/20/30b/770
> > 
> >
> 
>         [[alternative HTML version deleted]] 
> 
> _______________________________________________ 
> R-sig-Geo mailing list 
> [hidden email] 
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 
> If you reply to this email, your message will be added to the discussion below:
> http://r-sig-geo.2731867.n2.nabble.com/Read-HDF-files-tp6750856p6753885.html
> To unsubscribe from Read HDF files, click here.



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Read-HDF-files-tp6750856p6753935.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From csilva at ipimar.pt  Fri Sep  2 17:31:10 2011
From: csilva at ipimar.pt (Cristina Silva)
Date: Fri, 02 Sep 2011 16:31:10 +0100
Subject: [R-sig-Geo] help on spplot
Message-ID: <4E60F6BE.205@ipimar.pt>

Dear all,

I am trying to map fish densities in different years from a 
SpatialPointsDataFrame. I managed to change the legend labels using 
lengendEntries and the their position using key.space, but not the font 
size. I have looked in help pages and in the books ASDAR and Lattice, 
and tried to use colorkey=list(cex=.5) but didn't work. Could anybody 
give me a hint on how to do this?

Thanks in advance.

Cristina

-- 
------------------------------------------
Cristina Silva
INRB/L-IPIMAR
Unidade de Recursos Marinhos e Sustentabilidade
Av. de Bras??lia, 1449-006 Lisboa
Portugal
Tel.: 351 21 3027096
Fax: 351 21 3015948
csilva at ipimar.pt


From landis at isciences.com  Fri Sep  2 17:37:05 2011
From: landis at isciences.com (Matthew Landis)
Date: Fri, 02 Sep 2011 11:37:05 -0400
Subject: [R-sig-Geo] help on spplot
In-Reply-To: <4E60F6BE.205@ipimar.pt>
References: <4E60F6BE.205@ipimar.pt>
Message-ID: <4E60F821.6090804@isciences.com>

Cristina,

I think you are on the right track with colorkey = list(cex = 0.5).  
Instead, try:

colorkey = list(labels = list(cex = 0.5))

I think I had to delve pretty deep into the documentation for levelplot 
or xyplot to figure that out.

Matt

On 9/2/2011 11:31 AM, Cristina Silva wrote:
> Dear all,
>
> I am trying to map fish densities in different years from a 
> SpatialPointsDataFrame. I managed to change the legend labels using 
> lengendEntries and the their position using key.space, but not the 
> font size. I have looked in help pages and in the books ASDAR and 
> Lattice, and tried to use colorkey=list(cex=.5) but didn't work. Could 
> anybody give me a hint on how to do this?
>
> Thanks in advance.
>
> Cristina
>

-- 
~~~~~~~~~~~~~~~~~~~~~~~~~~
Matthew Landis, Ph.D.
Research Scientist
ISciences, LLC
61 Main St. Suite 200
Burlington VT 05401
802.864.2999
~~~~~~~~~~~~~~~~~~~~~~~~~~


From r.hijmans at gmail.com  Fri Sep  2 18:24:59 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Fri, 2 Sep 2011 09:24:59 -0700
Subject: [R-sig-Geo] R-sig-Geo Digest, Vol 97, Issue 1
In-Reply-To: <7FAA73D70AEE6B4BA5BE48F8BD97BC9A0267905046@HQEXDB02.hq.un.fao.org>
References: <mailman.17.1314871207.14711.r-sig-geo@r-project.org>
	<7FAA73D70AEE6B4BA5BE48F8BD97BC9A0267905046@HQEXDB02.hq.un.fao.org>
Message-ID: <CANtt_hwC7JZ+JuzzTiDNL=wWvFdrhifu-rWyNNCVDw7BFhx-Gg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110902/2336247d/attachment.pl>

From marcelino.delacruz at upm.es  Sat Sep  3 14:21:50 2011
From: marcelino.delacruz at upm.es (marcelino.delacruz at upm.es)
Date: Sat, 03 Sep 2011 13:21:50 +0100
Subject: [R-sig-Geo] Ripley's K using ads
In-Reply-To: <1314971064577-6753910.post@n2.nabble.com>
Message-ID: <wWqtcrev.1315052510.2143350.marcelino.delacruz@upm.es>

Con fecha 2/9/2011, "georgie" <georgie.peters at gmail.com> escribi?:

>I'm trying to do Ripley's K analysis using ads (one points shapefile, one
>polygon area shapefile). Having created a bounding box than includes my
>study area, I triangulated this box against a vertices file of my study
>area.
>
>The triangulation runs without any errors, but when I try to run swin I get
>the error message:
>Error:!overlapping.polygons(convert(triangles)) is not all TRUE.
>
>If anyone could point me in the right direction



If nobody replies, I would point you to spatstat package which you can
easily use to  compute Ripley's K and where there are many users that
could help you

Cheers,

Marcelino

 of what I'm doing wrong or
>what this error message actually means (my searching has turned up nothing
>useful) I would be eternally grateful.
>
>Thanks, Georgie.
>
>--
>View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Ripley-s-K-using-ads-tp6753910p6753910.html
>Sent from the R-sig-geo mailing list archive at Nabble.com.
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From a.mosnier at gmail.com  Sat Sep  3 22:54:36 2011
From: a.mosnier at gmail.com (Arnaud Mosnier)
Date: Sat, 3 Sep 2011 16:54:36 -0400
Subject: [R-sig-Geo] Read HDF files
Message-ID: <CANkFkEcz8sfbwyq=K41u2zVMbPnDPRHuEp3+3F3cU_rKty-jxg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110903/9cda860a/attachment.pl>

From alp97 at hotmail.com  Sun Sep  4 13:49:13 2011
From: alp97 at hotmail.com (Alper ALTINOK)
Date: Sun, 4 Sep 2011 11:49:13 +0000
Subject: [R-sig-Geo] Cross nearest neighbor distance
Message-ID: <BLU161-W46AA2A2766D0409B75D5CABC1A0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110904/6ff1b157/attachment.pl>

From alp97 at hotmail.com  Sun Sep  4 14:19:47 2011
From: alp97 at hotmail.com (Alper ALTINOK)
Date: Sun, 4 Sep 2011 12:19:47 +0000
Subject: [R-sig-Geo] Cross Nearest Neighbor
Message-ID: <BLU161-W152BB1C979D3A2235A6E65BC1A0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110904/b4b776ed/attachment.pl>

From Roger.Bivand at nhh.no  Sun Sep  4 15:25:47 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sun, 4 Sep 2011 15:25:47 +0200 (CEST)
Subject: [R-sig-Geo] Read HDF files
In-Reply-To: <CANkFkEcz8sfbwyq=K41u2zVMbPnDPRHuEp3+3F3cU_rKty-jxg@mail.gmail.com>
References: <CANkFkEcz8sfbwyq=K41u2zVMbPnDPRHuEp3+3F3cU_rKty-jxg@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1109041512520.19585@reclus.nhh.no>

On Sat, 3 Sep 2011, Arnaud Mosnier wrote:

> Hi Jan,
>
> Thanks for you answer.
> I tried your script but unfortunatly it does not work for my case.

No, you did not. He is using rgdal built against an OSX framework GDAL 
that includes an HDF driver. If you type gdalDrivers() on your CRAN rgdal 
built statically against a minimal GDAL, you will see that you do not have 
an HDF driver. You need either to install rgdal from source linked to a 
GDAL that has the HDF driver (which I assume you do not want to do - see 
file.show(system.file("README.windows", package="rgdal")) for details if 
you do), or to use external software, such as a Windows version of 
gdal_translate to convert your HDF file to for example GTiff outside R, 
and then use the minimal set of drivers included in the CRAN rgdal to read 
the data.

GDAL potentially has well over 100 drivers, many of which must be linked 
against external libraries. It is not practically possible to build the 
CRAN Windows rgdal binaries (or the CRAN Extras OSX rgdal binaries) for 
more than a minimal set with very few external dependencies. A source of 
Windows GDAL binaries is:

http://www.gisinternals.com/sdk/

linked from:

http://trac.osgeo.org/gdal/wiki/DownloadingGdalBinaries

from:

http://www.gdal.org/

Hope this helps,

Roger

> If someone want to make some test with the kind of image I want to use, just
> try this script to download and uncompress it.
>
> TestFolder <- choose.dir()
>
> download.file("
> http://oceandata.sci.gsfc.nasa.gov/cgi/getfile/A20072132007243.L3m_MO_CHL_chlor_a_4km.bz2",
> f<-paste(TestlFolder, "/hdf4test.bz2", sep = "")
> library(R.utils)
> gunzip(f, f2<-paste(TestFolder, "/testhdf4.hdf", sep = "")
> GDALinfo(f2) # in my case it results on this message
> `C:/test/testhdf4.hdf' not recognised as a supported file format.
>
>
>
> Here is my sessionInfo() result.
>
> R version 2.12.0 (2010-10-15)
> Platform: x86_64-pc-mingw32/x64 (64-bit)
>
> locale:
> [1] LC_COLLATE=French_Canada.1252  LC_CTYPE=French_Canada.1252
> LC_MONETARY=French_Canada.1252 LC_NUMERIC=C
> LC_TIME=French_Canada.1252
>
> attached base packages:
> [1] grDevices datasets  splines   graphics  stats     tcltk     utils
> methods   base
>
> other attached packages:
> [1] R.utils_1.7.8     R.oo_1.8.1        R.methodsS3_1.2.1 rgdal_0.7-1
> raster_1.9-5      sp_0.9-84         svSocket_0.9-51   TinnR_1.0.3
> R2HTML_2.2        Hmisc_3.8-3       survival_2.35-8
>
> loaded via a namespace (and not attached):
> [1] cluster_1.14.0  grid_2.12.0     lattice_0.19-33 svMisc_0.9-61
> tools_2.12.0
>
>
> Thanks for any help !
>
> Arnaud
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From r.turner at auckland.ac.nz  Mon Sep  5 04:37:02 2011
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Mon, 05 Sep 2011 14:37:02 +1200
Subject: [R-sig-Geo] Cross nearest neighbor distance
In-Reply-To: <BLU161-W46AA2A2766D0409B75D5CABC1A0@phx.gbl>
References: <BLU161-W46AA2A2766D0409B75D5CABC1A0@phx.gbl>
Message-ID: <4E6435CE.8000205@auckland.ac.nz>

On 04/09/11 23:49, Alper ALTINOK wrote:
>
> Dear list,
>
> I have abot 10 set of points from same area, each set taken at different time periods (ie, one set is from May, other set is from June). Many of the points are exact same location, some are slightly different, very few are far apart. I want to compare point locations of pairs of these sets (may<->june,  june<->july etc.) to see how different or similar their point locations are. Despite my all efforts on finding a useful function in R or other stat packages, I could not find anything to reveal spatial dis/similarity between two point sets.
>
> The only method I was able to find is "Cross Nearest Neighbor Distance (V)", but I do not know how to apply it, do you know any package in R that provides this or a similar function ?
>
> I know there is a Kcross function in R, what I understand is its for a single (but multitype) point pattern.
>
> Looking for advices,

It is not clear to me just what you are trying to do and hence it is not
clear what (if any) the appropriate technique might be.   What do the
points actually consist of?  Are the points in the June pattern translations
(by varying amounts) of the points in the May pattern.  If so, it would seem
to me that you have a number of *trajectories* of points, observed at
``about 10'' (???) discrete times.  In which case point pattern analysis may
not be appropriate.

Be that as it may, you could apply the Kcross() function to your data by
combining your ``about 10'' patterns into a single pattern with marks
indicating the month in which the pattern was observed.  To combine the
patterns, use "superimpose()".  E.g. (triv. example with simulated data):

require(spatstat)
X <- list()
set.seed(42)
for(nm in month.abb) X[[nm]] <- rpoispp(100)
Y <- do.call(superimpose,X)
marks(Y) <- factor(marks(Y),levels=month.abb) # To get the months in the 
right order
kc <-alltypes(Y,fun="K")
plot(kc[1:4,1:4],title="Vacuous Example") # 12 x 12 makes the plots too 
small to be useful.

HTH

     cheers,

         Rolf Turner


From Adrian.Baddeley at csiro.au  Mon Sep  5 09:19:13 2011
From: Adrian.Baddeley at csiro.au (Adrian.Baddeley at csiro.au)
Date: Mon, 5 Sep 2011 15:19:13 +0800
Subject: [R-sig-Geo] spatstat - how to choose an optimal bandwidth for
	smooth.ppp ?
In-Reply-To: <mailman.11.1314957604.10856.r-sig-geo@r-project.org>
References: <mailman.11.1314957604.10856.r-sig-geo@r-project.org>
Message-ID: <57DC18C299094D4299F837570C5DF1C54E9137A1E2@EXWA-MBX01.nexus.csiro.au>

Mathieu Rajerison <mathieu.rajerison at gmail.com> writes:

> >I know how to determine an optimal bandwidth for the kernel density of
> >points using mean suared error method as possible with splancs package.
> >
> >But I was wondering if there was an equivalent method for the density of
> >weighted points as performed by spatstat::smooth.ppp

smooth.ppp does not compute the density of weighted points. That is computed by density.ppp with the argument 'weights'. 

smooth.ppp computes a kernel-smoothed average (Nadaraja-Watson smoother) of the ***mark values** of the point pattern. For example with the 'longleaf' pattern of trees marked by their diameter at breast height, plot(smooth.ppp(longleaf)) will show you a map of the spatially-varying average diameter of trees. 

In the next release of spatstat (1.23-4) to be released in a couple of days, I will include some code for automatic bandwidth selection for smooth.ppp by least squares cross-validation. 

Adrian Baddeley


From clement.tisseuil at gmail.com  Mon Sep  5 09:34:05 2011
From: clement.tisseuil at gmail.com (=?UTF-8?Q?Cl=C3=A9ment_Tisseuil?=)
Date: Mon, 5 Sep 2011 09:34:05 +0200
Subject: [R-sig-Geo] Partial residual plot from SAR model
Message-ID: <CAFRWSjn=6OtCpbqvy3LBUkSDSwYB1pUUzw5DpnAf41uEc+PMyQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110905/c5790d37/attachment.pl>

From Roger.Bivand at nhh.no  Mon Sep  5 10:07:06 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 5 Sep 2011 10:07:06 +0200
Subject: [R-sig-Geo] Partial residual plot from SAR model
In-Reply-To: <CAFRWSjn=6OtCpbqvy3LBUkSDSwYB1pUUzw5DpnAf41uEc+PMyQ@mail.gmail.com>
References: <CAFRWSjn=6OtCpbqvy3LBUkSDSwYB1pUUzw5DpnAf41uEc+PMyQ@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1109051004200.22482@reclus.nhh.no>

On Mon, 5 Sep 2011, Cl?ment Tisseuil wrote:

> Dear Mr. Bivand,
>
> Like the prplot function from the faraway package, I am trying to find a way
> to make partial residuals plots from a simultaneous autoregressive error
> model. When I look at the list of parameters from the SAR model ouput, I am
> just lost when trying to rebuild the correct SAR equation which should help
> me to make the partial plots...
>
> Would you have an idea ?

Did you actually try the advice I gave when you contacted me off-list, and 
which you append below? Do please try:

"Depending on which version of spdep you are running, the following may 
work:

library(spdep)
data(oldcol)
COL.errW.eig <- errorsarlm(CRIME ~ INC + HOVAL, data=COL.OLD,
  nb2listw(COL.nb, style="W"), method="eigen")
tarlm <- lm(COL.errW.eig$tary ~ COL.errW.eig$tarX - 1)
library(faraway)
prplot(tarlm, 1)
prplot(tarlm, 2)

but I think it grabs the whole matrix name in creating the labels. Maybe:

df0 <- as.data.frame(COL.errW.eig$tarX)
names(df0) <- names(COL.errW.eig$coefficients)
df <- cbind(y=COL.errW.eig$tary, df0[,-1])
str(df)
tarlm <- lm(y ~ INC + HOVAL, data=df)
prplot(tarlm, 1)
prplot(tarlm, 2)

The plots look the same, the first version is less code, but prplot() gets 
the legends wrong, and does not accept xlab=, ylab= to correct the 
problem. The tarX component includes the (I - \lambda W) X, which are the 
X you would need here, I think, not the unfiltered X."

Consider asking the author of prplot() to add ... to the function to pass 
plot arguments to the underlying plot function to save you the extra work.

Hope this helps,

Roger


>
> Thank you in advance for your attention.
>
> Kind regards
>
> Clement Tisseuil (PhD)
> Mus??um National d'Histoire Naturelle
> Equipe BOREA
> Paris
>
>
>
>
> ********************************************************************
>>> Please *do* write to the R-sig-geo list rather than to me directly -
>>> others can answer your question as well, perhaps better, and in a more
>>> timely way than I can. In addition, threads in the list can be searched
> in
>>> the archives, so others can avoid the same problem later.
>>>
>>> Depending on which version of spdep you are running, the following may
> work:
>>>
>>> library(spdep)
>>> data(oldcol)
>>> COL.errW.eig <- errorsarlm(CRIME ~ INC + HOVAL, data=COL.OLD,
>>>  nb2listw(COL.nb, style="W"), method="eigen")
>>> tarlm <- lm(COL.errW.eig$tary ~ COL.errW.eig$tarX - 1)
>>> library(faraway)
>>> prplot(tarlm, 1)
>>> prplot(tarlm, 2)
>>>
>>> but I think it grabs the whole matrix name in creating the labels. Maybe:
>>>
>>> df0 <- as.data.frame(COL.errW.eig$tarX)
>>> names(df0) <- names(COL.errW.eig$coefficients)
>>> df <- cbind(y=COL.errW.eig$tary, df0[,-1])
>>> str(df)
>>> tarlm <- lm(y ~ INC + HOVAL, data=df)
>>> prplot(tarlm, 1)
>>> prplot(tarlm, 2)
>>>
>>> The plots look the same, the first version is less code, but prplot()
> gets the legends wrong,
>>> and does not accept xlab=, ylab= to correct the problem. The tarX
> component includes
>>> the (I - \lambda W) X, which are the X you would need here, I think, not
> the unfiltered X.
>>>
>>> Hope this helps,
>>>
>>> Roger
>>>
>>>
>>> --
>>> Roger Bivand
>>> Department of Economics, NHH Norwegian School of Economics,
>>> Helleveien 30, N-5045 Bergen, Norway.
>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>> e-mail: Roger.Bivand at nhh.no
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From alp97 at hotmail.com  Mon Sep  5 15:13:34 2011
From: alp97 at hotmail.com (Alper ALTINOK)
Date: Mon, 5 Sep 2011 13:13:34 +0000
Subject: [R-sig-Geo] Cross nearest neighbor distance
In-Reply-To: <4E6435CE.8000205@auckland.ac.nz>
References: <BLU161-W46AA2A2766D0409B75D5CABC1A0@phx.gbl>,
	<4E6435CE.8000205@auckland.ac.nz>
Message-ID: <BLU161-W4980262CE11B156B41E313BC1D0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110905/7b7962a1/attachment.pl>

From nevil.amos at gmail.com  Tue Sep  6 03:03:34 2011
From: nevil.amos at gmail.com (Nevil Amos)
Date: Tue, 06 Sep 2011 11:03:34 +1000
Subject: [R-sig-Geo] Equivalent of raster Region Group command in ARCGIS
In-Reply-To: <mailman.9.1315216804.21838.r-sig-geo@r-project.org>
References: <mailman.9.1315216804.21838.r-sig-geo@r-project.org>
Message-ID: <4E657166.7070602@monash.edu>

Is there an equivalent  in one of the R raster packages of the spatial 
analyst command "Region Group,  that gives a unique identifier to each 
region of contiguous cells with the same value?

Thanks

Nevil Amos


From nevil.amos at gmail.com  Tue Sep  6 05:52:32 2011
From: nevil.amos at gmail.com (Nevil Amos)
Date: Tue, 06 Sep 2011 13:52:32 +1000
Subject: [R-sig-Geo] Equivalent of Region Group in spatial anayst
Message-ID: <4E659900.2010603@monash.edu>

Is there an equivalent of the ESRI spatial analyst "Region group"  
command in one of the r packages that handles rasters

ie function that assigns a unique id all cells of a contiguous area of 
the same value

Thanks

Nevil amos


From robin50488 at hotmail.com  Tue Sep  6 06:27:55 2011
From: robin50488 at hotmail.com (=?big5?B?s68gpcOwtg==?=)
Date: Tue, 6 Sep 2011 04:27:55 +0000
Subject: [R-sig-Geo] problem for installing "rgdal" package in r
Message-ID: <SNT123-W582B9DD86DDCC93F363E0E861C0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110906/6a1a2612/attachment.pl>

From lists at remoteinformation.com.au  Tue Sep  6 06:51:49 2011
From: lists at remoteinformation.com.au (Ben Madin)
Date: Tue, 6 Sep 2011 12:51:49 +0800
Subject: [R-sig-Geo] problem for installing "rgdal" package in r
In-Reply-To: <SNT123-W582B9DD86DDCC93F363E0E861C0@phx.gbl>
References: <SNT123-W582B9DD86DDCC93F363E0E861C0@phx.gbl>
Message-ID: <A0465C1E-861A-458F-A888-B45A634FBEFD@remoteinformation.com.au>

At a guess your error message was slightly longer than you have posted below - which only says that the install failed. 

The more information you provide the better your chances of help...

cheers

Ben


On 06/09/2011, at 12:27 PM, ? ?? wrote:

> 
> Hi,
> 
> I am a begginner using R in Linux system and I am doing some spatial
> research. Recently, I tried to install "rgdal" package in Linux system but
> I got the error message "installation of package 'rgdal' had non-zero exit
> status".
> It is impossible I can update the version of R because it is our
> department system. Therefore, I wonder if there is any other ways to
> install package.
> Can you help me to deal with this problem? Thank you in advance.
> 
> 
> 
> Yung-wei Chen
> 
> 		 	   		  
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From robin50488 at hotmail.com  Tue Sep  6 07:03:20 2011
From: robin50488 at hotmail.com (=?big5?B?s68gpcOwtg==?=)
Date: Tue, 6 Sep 2011 05:03:20 +0000
Subject: [R-sig-Geo] problem for installing "rgdal" package in r
In-Reply-To: <A0465C1E-861A-458F-A888-B45A634FBEFD@remoteinformation.com.au>
References: <SNT123-W582B9DD86DDCC93F363E0E861C0@phx.gbl>,
	<A0465C1E-861A-458F-A888-B45A634FBEFD@remoteinformation.com.au>
Message-ID: <SNT123-W30278B69D3DC18A1D4930B861C0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110906/67345852/attachment.pl>

From Craig.Mundy at utas.edu.au  Tue Sep  6 07:45:41 2011
From: Craig.Mundy at utas.edu.au (cmundy)
Date: Mon, 5 Sep 2011 22:45:41 -0700 (PDT)
Subject: [R-sig-Geo] Building RGDAL to enable access to new GDAL OGR drivers
Message-ID: <1315287941767-6762759.post@n2.nabble.com>

Hi all,

On the theme of building RGDAL to take advantage of new(ish) OGR drivers
available in GDAL, and, heeding Rogers comments on this topic in recent
posts, I am looking for help with an updated procedure (recipe) for
compiling RGDAL to take advantage of specific GDAL OGR  drivers 
(mssqspatial, wfs) on Windows 7 platforms.

At a recent GIS/Fisheries conference there was an interest from several
attendees on a more seemless integration of R with spatial RDBMS and/or web
portals for spatial data (e.g. as for postgre/postgis). We were all rather
daunted at the prospect of achieving this on Windows and my clumsy attempts
to date have not yielded success (although a scan of blogs and posts, it
seems less problematic on MacOS). 

The instructions/guides to compile RGDAL from source for MS windows to link
to the GDAL driver libraries are now quite dated, and a more up to date
guide would help us access drivers of interest that are not part of the
standard drivers included in RGDAL. One of the original authors of some of
those instructions was equally daunted by this task.

Some questions as a start;

1) has anyone achieved this on Win7 recently?

2) how important is it to compile everything from source: i.e.  R, rgdal,
gdal -   or can standard binaries be used for some components

3) is there a description anywhere of which Win7 system enviornmental
variables for GDAL are required by RGDAL 

Any assistance greatly appreciated.

Regards

Craig

P.s. Funding could be made available if there is interest to develop an
updated set of instructions for general use.









--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Building-RGDAL-to-enable-access-to-new-GDAL-OGR-drivers-tp6762759p6762759.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From lists at remoteinformation.com.au  Tue Sep  6 07:55:05 2011
From: lists at remoteinformation.com.au (Ben Madin)
Date: Tue, 6 Sep 2011 13:55:05 +0800
Subject: [R-sig-Geo] problem for installing "rgdal" package in r
In-Reply-To: <SNT123-W30278B69D3DC18A1D4930B861C0@phx.gbl>
References: <SNT123-W582B9DD86DDCC93F363E0E861C0@phx.gbl>,
	<A0465C1E-861A-458F-A888-B45A634FBEFD@remoteinformation.com.au>
	<SNT123-W30278B69D3DC18A1D4930B861C0@phx.gbl>
Message-ID: <9B2B861A-63ED-4F11-8DA8-1E74C2A97D19@remoteinformation.com.au>

Yung-wei,

If you read through this, it is one of the more instructive error messages you are likely to receive, so I would suggest that you work through the steps it suggests. 

My guess is that if you are on a shared machine, the gdal libraries are not installed, and you will have to speak to your administrators about installing them.

> ./configure: line 2013: gdal-config: command not found
> Error: gdal-config not found

The gdal-config script distributed with GDAL could not be found.

> If you have not installed the GDAL libraries, you can
> download the source from  http://www.gdal.org/

You may need to get help from admins to do this on a shared machine.

> If you have installed the GDAL libraries, then make sure that
> gdal-config is in your path. Try typing gdal-config at a
> shell prompt and see if it runs. If not, use:
>  --configure-args='--with-gdal-config=/usr/local/bin/gdal-config'
> with appropriate values for your installation.

You will have to look at the help for install.packages for details on how to do this - watch out for the quoting.

cheers

Ben






On 06/09/2011, at 1:03 PM, ? ?? wrote:

> Hi Ben,
>  
> Thanks for your remider and the following is the whole information I got:
>  
>  
>  
> Installing package(s) into ?/home/yungweichen/R/i486-pc-linux-gnu-library/2.13?
> (as ?lib? is unspecified)
> trying URL 'http://cran.cs.wwu.edu/src/contrib/rgdal_0.7-1.tar.gz'
> Content type 'application/x-gzip' length 1432509 bytes (1.4 Mb)
> opened URL
> ==================================================
> downloaded 1.4 Mb
> * installing *source* package ?rgdal? ...
> gdal-config: gdal-config
> ./configure: line 2013: gdal-config: command not found
> Error: gdal-config not found
> The gdal-config script distributed with GDAL could not be found.
> If you have not installed the GDAL libraries, you can
> download the source from  http://www.gdal.org/
> If you have installed the GDAL libraries, then make sure that
> gdal-config is in your path. Try typing gdal-config at a
> shell prompt and see if it runs. If not, use:
>  --configure-args='--with-gdal-config=/usr/local/bin/gdal-config'
> with appropriate values for your installation.
> ERROR: configuration failed for package ?rgdal?
> * removing ?/home/yungweichen/R/i486-pc-linux-gnu-library/2.13/rgdal?
> The downloaded packages are in
>  ?/tmp/RtmpjttzmJ/downloaded_packages?
> Warning message:
> In install.packages("rgdal") :
>   installation of package 'rgdal' had non-zero exit status
>  
>  
>  
>  
>  
> Yung-wei
> 
>  
> > Subject: Re: [R-sig-Geo] problem for installing "rgdal" package in r
> > From: lists at remoteinformation.com.au
> > Date: Tue, 6 Sep 2011 12:51:49 +0800
> > CC: r-sig-geo at r-project.org
> > To: robin50488 at hotmail.com
> > 
> > At a guess your error message was slightly longer than you have posted below - which only says that the install failed. 
> > 
> > The more information you provide the better your chances of help...
> > 
> > cheers
> > 
> > Ben
> > 
> > 
> > On 06/09/2011, at 12:27 PM, ? ?? wrote:
> > 
> > > 
> > > Hi,
> > > 
> > > I am a begginner using R in Linux system and I am doing some spatial
> > > research. Recently, I tried to install "rgdal" package in Linux system but
> > > I got the error message "installation of package 'rgdal' had non-zero exit
> > > status".
> > > It is impossible I can update the version of R because it is our
> > > department system. Therefore, I wonder if there is any other ways to
> > > install package.
> > > Can you help me to deal with this problem? Thank you in advance.
> > > 
> > > 
> > > 
> > > Yung-wei Chen
> > > 
> > > 
> > > [[alternative HTML version deleted]]
> > > 
> > > _______________________________________________
> > > R-sig-Geo mailing list
> > > R-sig-Geo at r-project.org
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > 


From rlist at zeidlers.de  Tue Sep  6 09:49:48 2011
From: rlist at zeidlers.de (Julian Zeidler)
Date: Tue, 06 Sep 2011 09:49:48 +0200
Subject: [R-sig-Geo] problem for installing "rgdal" package in r
In-Reply-To: <9B2B861A-63ED-4F11-8DA8-1E74C2A97D19@remoteinformation.com.au>
References: <SNT123-W582B9DD86DDCC93F363E0E861C0@phx.gbl>,
	<A0465C1E-861A-458F-A888-B45A634FBEFD@remoteinformation.com.au>	<SNT123-W30278B69D3DC18A1D4930B861C0@phx.gbl>
	<9B2B861A-63ED-4F11-8DA8-1E74C2A97D19@remoteinformation.com.au>
Message-ID: <4E65D09C.4000602@zeidlers.de>

Hi Yung-wei,

I had simislar Problems when first isntalling rgdal on my machine. It is 
due to missing (Linux-)Packages, that R needs to compile its bindings 
with gdal.
In my case ( on a Ubuntu System) the required packages where:  gdal-bin, 
libgdal1-dev, libproj-dev, build-essential. There might have been more 
or i had previously installed them. If you are on a different 
Distribution the names might be slightly different, but your Admin 
should be able to figure it out.

best,
Julian


Am 06.09.2011 07:55, schrieb Ben Madin:
> Yung-wei,
>
> If you read through this, it is one of the more instructive error messages you are likely to receive, so I would suggest that you work through the steps it suggests.
>
> My guess is that if you are on a shared machine, the gdal libraries are not installed, and you will have to speak to your administrators about installing them.
>
>> ./configure: line 2013: gdal-config: command not found
>> Error: gdal-config not found
> The gdal-config script distributed with GDAL could not be found.
>
>> If you have not installed the GDAL libraries, you can
>> download the source from  http://www.gdal.org/
> You may need to get help from admins to do this on a shared machine.
>
>> If you have installed the GDAL libraries, then make sure that
>> gdal-config is in your path. Try typing gdal-config at a
>> shell prompt and see if it runs. If not, use:
>>   --configure-args='--with-gdal-config=/usr/local/bin/gdal-config'
>> with appropriate values for your installation.
> You will have to look at the help for install.packages for details on how to do this - watch out for the quoting.
>
> cheers
>
> Ben
>
>
>
>
>
>
> On 06/09/2011, at 1:03 PM, ? ?? wrote:
>
>> Hi Ben,
>>
>> Thanks for your remider and the following is the whole information I got:
>>
>>
>>
>> Installing package(s) into ?/home/yungweichen/R/i486-pc-linux-gnu-library/2.13?
>> (as ?lib? is unspecified)
>> trying URL 'http://cran.cs.wwu.edu/src/contrib/rgdal_0.7-1.tar.gz'
>> Content type 'application/x-gzip' length 1432509 bytes (1.4 Mb)
>> opened URL
>> ==================================================
>> downloaded 1.4 Mb
>> * installing *source* package ?rgdal? ...
>> gdal-config: gdal-config
>> ./configure: line 2013: gdal-config: command not found
>> Error: gdal-config not found
>> The gdal-config script distributed with GDAL could not be found.
>> If you have not installed the GDAL libraries, you can
>> download the source from  http://www.gdal.org/
>> If you have installed the GDAL libraries, then make sure that
>> gdal-config is in your path. Try typing gdal-config at a
>> shell prompt and see if it runs. If not, use:
>>   --configure-args='--with-gdal-config=/usr/local/bin/gdal-config'
>> with appropriate values for your installation.
>> ERROR: configuration failed for package ?rgdal?
>> * removing ?/home/yungweichen/R/i486-pc-linux-gnu-library/2.13/rgdal?
>> The downloaded packages are in
>>   ?/tmp/RtmpjttzmJ/downloaded_packages?
>> Warning message:
>> In install.packages("rgdal") :
>>    installation of package 'rgdal' had non-zero exit status
>>
>>
>>
>>
>>
>> Yung-wei
>>
>>
>>> Subject: Re: [R-sig-Geo] problem for installing "rgdal" package in r
>>> From: lists at remoteinformation.com.au
>>> Date: Tue, 6 Sep 2011 12:51:49 +0800
>>> CC: r-sig-geo at r-project.org
>>> To: robin50488 at hotmail.com
>>>
>>> At a guess your error message was slightly longer than you have posted below - which only says that the install failed.
>>>
>>> The more information you provide the better your chances of help...
>>>
>>> cheers
>>>
>>> Ben
>>>
>>>
>>> On 06/09/2011, at 12:27 PM, ? ?? wrote:
>>>
>>>> Hi,
>>>>
>>>> I am a begginner using R in Linux system and I am doing some spatial
>>>> research. Recently, I tried to install "rgdal" package in Linux system but
>>>> I got the error message "installation of package 'rgdal' had non-zero exit
>>>> status".
>>>> It is impossible I can update the version of R because it is our
>>>> department system. Therefore, I wonder if there is any other ways to
>>>> install package.
>>>> Can you help me to deal with this problem? Thank you in advance.
>>>>
>>>>
>>>>
>>>> Yung-wei Chen
>>>>
>>>>
>>>> [[alternative HTML version deleted]]
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From johan.vandewauw at gmail.com  Tue Sep  6 10:01:11 2011
From: johan.vandewauw at gmail.com (Johan Van de Wauw)
Date: Tue, 6 Sep 2011 10:01:11 +0200
Subject: [R-sig-Geo] problem for installing "rgdal" package in r
In-Reply-To: <SNT123-W582B9DD86DDCC93F363E0E861C0@phx.gbl>
References: <SNT123-W582B9DD86DDCC93F363E0E861C0@phx.gbl>
Message-ID: <CAJOp35k_Fa_fEH=U2FenvHE5jS7vSMWvB7rpqwtv6VtXah48-g@mail.gmail.com>

This question has been asked here before. Which distribution are you using?

If you are using debian or ubuntu the admin should install
libgdal1-dev for building gdal. I also recommend installing r-base-dev
if it is not yet installed. It is needed for building most R packages

If the administrator is unreachable: try installing:
http://home.gdal.org/fwtools/FWTools-linux-2.0.6.tar.gz
and then run install.packages('rgdal',
configure.args=c(gdal='--with-gdal-config=~/FWTools-2.0.6/bin/gdal-config')


Johan
On Tue, Sep 6, 2011 at 6:27 AM, ? ?? <robin50488 at hotmail.com> wrote:
>
> Hi,
>
> I am a begginner using R in Linux system and I am doing some spatial
> research. Recently, I tried to install "rgdal" package in Linux system but
> I got the error message "installation of package 'rgdal' had non-zero exit
> status".
> It is impossible I can update the version of R because it is our
> department system. Therefore, I wonder if there is any other ways to
> install package.
> Can you help me to deal with this problem? Thank you in advance.
>
>
>
> Yung-wei Chen
>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From mlennert at club.worldonline.be  Tue Sep  6 10:54:22 2011
From: mlennert at club.worldonline.be (Moritz Lennert)
Date: Tue, 06 Sep 2011 10:54:22 +0200
Subject: [R-sig-Geo] extracting simple list of adjacent neighbours
Message-ID: <4E65DFBE.4080607@club.worldonline.be>

Hello,

I have a very simple problem, which I know will have a simple solution, 
but I just can't get my head wrapped around it.

I have a shapefile with regions, including an attribut containing a 
regional id.

I would like to extract a simple neighbourhood file, with neighbourhood 
defined by simple adjacency with symmetry of relationship in both 
directions.

Ideally, I would like to get something like this:

id_region_1 id_neighbour_1
id_region_1 id_neighbour_2
id_region_1 id_neighbour_3
id_region_2 id_neighbour_1
id_region_2 id_neighbour_2
id_region_3 id_neighbour_1
etc

What I've done so far:

originalmap<-readShapePoly("/path/to/shapefile.shp")
nb<-poly2nb(originalmap, row.names=originalmap$idcolumn)

With nb[] I can see that the list of lists of neighbours and the list of 
id's.

Here's where I'm stuck. How do I get a list as above with the row names 
defined in the poly2nb call ?
Or as an intermediate solution: how do I replace the line id's in the 
lists with the regional id's in the list of id's to at least get 
something like this:

id_region_1 id_neighbour_1 id_neighbour_2 id_neighbour_3
id_region_2 id_neighbour_1 id_neighbour_2
id_region_3 id_neighbour_1 etc..

?

I imagine that this is a very simple operation, but I just can't seem to 
find the way. Any pointers to doc is welcome.

Moritz


From s.meyer at lmu.de  Tue Sep  6 11:38:57 2011
From: s.meyer at lmu.de (Swen Meyer)
Date: Tue, 06 Sep 2011 11:38:57 +0200
Subject: [R-sig-Geo] LOOCV for a GLM?
Message-ID: <4E65EA31.70401@lmu.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110906/225f41fe/attachment.pl>

From a.mosnier at gmail.com  Tue Sep  6 14:49:55 2011
From: a.mosnier at gmail.com (Arnaud Mosnier)
Date: Tue, 6 Sep 2011 08:49:55 -0400
Subject: [R-sig-Geo] Read HDF files
In-Reply-To: <alpine.LRH.2.00.1109041512520.19585@reclus.nhh.no>
References: <CANkFkEcz8sfbwyq=K41u2zVMbPnDPRHuEp3+3F3cU_rKty-jxg@mail.gmail.com>
	<alpine.LRH.2.00.1109041512520.19585@reclus.nhh.no>
Message-ID: <CANkFkEcUzX8uqY97_P-10twFGvnLAwJaJ5wE8JEPDavGsG9BKg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110906/8f1c7734/attachment.pl>

From PDowney at urban.org  Tue Sep  6 20:02:04 2011
From: PDowney at urban.org (Downey, Patrick)
Date: Tue, 6 Sep 2011 14:02:04 -0400
Subject: [R-sig-Geo] Simulating spatially autocorrelated data
In-Reply-To: <alpine.LRH.2.00.1109012013370.6846@reclus.nhh.no>
References: <0F96478603980B46AAAFBA77069582ED131C7A25@UIEXCH.urban.org>
	<alpine.LRH.2.00.1109012013370.6846@reclus.nhh.no>
Message-ID: <0F96478603980B46AAAFBA77069582ED131C7A36@UIEXCH.urban.org>

Hi Roger and Terry,

Thank you very much for your help and directing me towards Roger's spdep
package, which of course had everything I needed. I've now worked through
this code and done some additional simulations.

I have one remaining question. You say "the larger the distance threshold,
the less well the spatial process is captured." I was wondering if you
could further provide some information on this, either by explaining or
referencing a document or webpage with explanation.

Decreasing the distance threshold, as you suggest, radically alters the
results and I'm looking for some guidance on how to select the appropriate
distance threshold when I don't know the true rho (that is, with
non-simulated data).

Thanks,
Mitch 


-----Original Message-----
From: Roger Bivand [mailto:Roger.Bivand at nhh.no] 
Sent: Thursday, September 01, 2011 2:20 PM
To: Downey, Patrick
Cc: r-sig-geo at stat.math.ethz.ch
Subject: Re: [R-sig-Geo] Simulating spatially autocorrelated data

On Thu, 1 Sep 2011, Downey, Patrick wrote:

> Hello all,
>
> I'm trying to simulate a spatially autocorrelated random variable, and 
> I cannot figure out what the problem is. All I want is a simple 
> spatial lag model where
>
> Y = rho*W*Y + e
>
> Where e is a vector of iid normal random variables, rho is the 
> autocorrelation, W is a row-normalized distance matrix (a spatial 
> weights matrix), and Y is the random variable.
>
> I thought the following program should do it, but it's not working. At 
> the end of the program, I calculate Moran's I, and it is not even 
> close to rejecting the null hypothesis of no spatial autocorrelation, 
> even when rho is very high (for example, below, rho is 0.95). Can 
> someone please identify what the problem is and offer some guidance on
how to fix it?
>
> PS - I apologize in advance, but I am not familiar with R's spatial 
> packages. I've done very little spatial analysis in R, so if there's a 
> package that can already do this, please recommend.
>
> BEGIN PROGRAM:
>
> install.packages("fields");library(fields)
> install.packages("ape");library(ape)
>
> N <- 200
> rho <- 0.95
>
> x.coord <- runif(N,0,100)
> y.coord <- runif(N,0,100)
>
> points <- cbind(x.coord,y.coord)
>
> e <- rnorm(N,0,1)
>
> dist.nonnorm <- rdist(points,points)   # Matrix of Euclidean distances
> dist <- dist.nonnorm/rowSums(dist.nonnorm)   # Row normalizing the
distance
> matrix
> diag(dist) <- 0   # Ensuring that the main diagonal is exactly 0

I think that you are using the distances as weights, not inverse distances,
which seems more sensible.

>
> I <- diag(N)   # Identity matrix (not Moran's I)
>
> inv <- solve(I-rho.lag*dist)   # Inverting (I - rho*W)
> y <- as.vector(inv %*% e)   # Generating data that is supposed to be
> spatially autocorrelated
>
> Moran.I(y,dist)   # Does not reject null hypothesis of no spatial
> autocorrelation
>

As Terry Griffin says, you can use spdep for this:

library(spdep)
rho <- 0.95
N <- 200
x.coord <- runif(N,0,100)
y.coord <- runif(N,0,100)
points <- cbind(x.coord,y.coord)
e <- rnorm(N,0,1)
dnb <- dnearneigh(points, 0, 150)
dsts <- nbdists(dnb, points)
idw <- lapply(dsts, function(x) 1/x)
lw <- nb2listw(dnb, glist=idw, style="W") inv <- invIrW(lw, rho) y <- inv
%*% e moran.test(y, lw)

to reproduce your analysis with IDW, here without:

lw <- nb2listw(dnb, glist=dsts, style="W") inv <- invIrW(lw, rho) y <- inv
%*% e moran.test(y, lw) # no autocorrelation

and here with a less inclusive distance threshold:

dnb <- dnearneigh(points, 0, 15)
dsts <- nbdists(dnb, points)
idw <- lapply(dsts, function(x) 1/x)
lw <- nb2listw(dnb, glist=idw, style="W") inv <- invIrW(lw, rho) y <- inv
%*% e moran.test(y, lw)


the larger the distance threshold, the less well the spatial process is
captured, alternatively use idw <- lapply(dsts, function(x) 1/(x^2)), for
example, to attenuate the weights more sharply.

Hope this clarifies,

Roger

> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

--
Roger Bivand
Department of Economics, NHH Norwegian School of Economics, Helleveien 30,
N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Tue Sep  6 21:41:52 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 6 Sep 2011 21:41:52 +0200 (CEST)
Subject: [R-sig-Geo] extracting simple list of adjacent neighbours
In-Reply-To: <4E65DFBE.4080607@club.worldonline.be>
References: <4E65DFBE.4080607@club.worldonline.be>
Message-ID: <alpine.LRH.2.00.1109062134470.28240@reclus.nhh.no>

On Tue, 6 Sep 2011, Moritz Lennert wrote:

> Hello,
>
> I have a very simple problem, which I know will have a simple solution, but I 
> just can't get my head wrapped around it.
>
> I have a shapefile with regions, including an attribut containing a regional 
> id.
>
> I would like to extract a simple neighbourhood file, with neighbourhood 
> defined by simple adjacency with symmetry of relationship in both directions.
>
> Ideally, I would like to get something like this:
>
> id_region_1 id_neighbour_1
> id_region_1 id_neighbour_2
> id_region_1 id_neighbour_3
> id_region_2 id_neighbour_1
> id_region_2 id_neighbour_2
> id_region_3 id_neighbour_1
> etc
>
> What I've done so far:
>
> originalmap<-readShapePoly("/path/to/shapefile.shp")
> nb<-poly2nb(originalmap, row.names=originalmap$idcolumn)

Roughly:

lw <- nb2listw(nb, style="B")
sn <- listw2sn(lw)

then the first two columns of the "spatial.neighbour" object sn (used in 
the S-PLUS SpatialStats module) are what you need. They can also be 
exported for use in Matlab.

Hope this helps,

Roger

>
> With nb[] I can see that the list of lists of neighbours and the list of 
> id's.
>
> Here's where I'm stuck. How do I get a list as above with the row names 
> defined in the poly2nb call ?
> Or as an intermediate solution: how do I replace the line id's in the lists 
> with the regional id's in the list of id's to at least get something like 
> this:
>
> id_region_1 id_neighbour_1 id_neighbour_2 id_neighbour_3
> id_region_2 id_neighbour_1 id_neighbour_2
> id_region_3 id_neighbour_1 etc..
>
> ?
>
> I imagine that this is a very simple operation, but I just can't seem to find 
> the way. Any pointers to doc is welcome.
>
> Moritz
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From r.hijmans at gmail.com  Wed Sep  7 02:48:51 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 6 Sep 2011 17:48:51 -0700
Subject: [R-sig-Geo] Equivalent of Region Group in spatial anayst
In-Reply-To: <4E659900.2010603@monash.edu>
References: <4E659900.2010603@monash.edu>
Message-ID: <CANtt_hxs15EwaJZm1ZaeRb5YBUV7FKng6syv0vm1vr8THBqV0g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110906/135b0d45/attachment.pl>

From nevil.amos at gmail.com  Wed Sep  7 04:20:25 2011
From: nevil.amos at gmail.com (Nevil Amos)
Date: Wed, 07 Sep 2011 12:20:25 +1000
Subject: [R-sig-Geo] Equivalent of Region Group in spatial analyst
In-Reply-To: <CANtt_hxs15EwaJZm1ZaeRb5YBUV7FKng6syv0vm1vr8THBqV0g@mail.gmail.com>
References: <4E659900.2010603@monash.edu>
	<CANtt_hxs15EwaJZm1ZaeRb5YBUV7FKng6syv0vm1vr8THBqV0g@mail.gmail.com>
Message-ID: <4E66D4E9.6020502@monash.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110907/e02b186b/attachment.pl>

From r.turner at auckland.ac.nz  Wed Sep  7 04:55:40 2011
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Wed, 7 Sep 2011 14:55:40 +1200
Subject: [R-sig-Geo] Cross nearest neighbor distance
In-Reply-To: <BLU161-W4980262CE11B156B41E313BC1D0@phx.gbl>
References: <BLU161-W46AA2A2766D0409B75D5CABC1A0@phx.gbl>,
	<4E6435CE.8000205@auckland.ac.nz>
	<BLU161-W4980262CE11B156B41E313BC1D0@phx.gbl>
Message-ID: <4E66DD2C.8050301@auckland.ac.nz>

On 06/09/11 01:13, Alper ALTINOK wrote:
>
> I appreciate for the advices, let me explain the situation a bit more with another example;
>
> Say, points are representing sampled fields for pests. Imagine you are making samplings from tomato fields to reveal possible clusters (hotspots) of pests, in a region, say 100km by 100km. Last year, you sampled 50 fields from that region, and this year 50 fields sampled. You want to compare these two years by means of cluster locations, but there is a problem; some tomato field locations are same with previous year, but some are changed to (nearby fields) due to crop-rotation, farmers' preferences etc., so these point sets do not overlap perfectly. The question is, can you compare (and comment on) pest clusters while point locations different among these point sets? (or, will it be statistically correct?)
>
> What I was hoping is, to find a way to tell, how (dis)similar the point locations of year1 and year2 are? In other words, when compared, whether the points of these two sampling sets are statistically significantly distributed against each other, or not. If not, I think comparison of two point sets will become possible. This is why I am looking for cross nearest neighor function.
>
> Well I did my best to explain the situation, hope this clarifies the issue, many thanks for the comments.

If I understand you correctly, the ``points'' of your pattern consist of 
these 50 fields.
Each year each field may be classified as having an infestation of pests 
or not.  What
this gives you is a binary random field on an irregular "grid" of 
points.  That field is evolving
over time, and is/has been observed at a number (10?) of regularly 
spaced times.

You are interested in knowing whether the locations of the ``1's'' 
(infestations) in your binary
random field (at each observation time) are dependent upon the locations 
of the 1's at the
previous observation time.

The fly in the ointment is that sometimes some of the 50 points in your 
irregular grid
change *a little bit* due to crop rotation etc.  This seems to me to be 
an aspect of the
problem that is very hard to model.  Off the top of my head I would 
approach it by
replacing any points that change by the *centroid* of their various 
manifestations.

This I think, would be a perfectly reasonable approximation provided 
that the amount
(distance) by which the points change location is *small* compared with 
distances
between genuinely distinct points.

Given that this approximation is acceptable, how can you go about 
answering the question
of interest?  You are *not* dealing with a point process, so point 
process techniques are
not of any use, although some of the machinery in spatstat would 
probably be of use in
effecting the calculations that you need to make.

I don't believe that there are any pre-programmed techniques in spatial 
statistical
analysis to handle the problem.  Others may correct me if I am wrong 
about this.
If I am correct then you will have to invent (and program up) your own 
technique.
I have a few ideas about how you might go about this, but I will refrain 
from making
any further suggestions at this time.

     cheers,

         Rolf Turner


From r.hijmans at gmail.com  Wed Sep  7 06:38:54 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 6 Sep 2011 21:38:54 -0700
Subject: [R-sig-Geo] Equivalent of Region Group in spatial analyst
In-Reply-To: <4E66D4E9.6020502@monash.edu>
References: <4E659900.2010603@monash.edu>
	<CANtt_hxs15EwaJZm1ZaeRb5YBUV7FKng6syv0vm1vr8THBqV0g@mail.gmail.com>
	<4E66D4E9.6020502@monash.edu>
Message-ID: <CANtt_hwT+K4AyGy2_cnFU2Fg-AFOfoSSEK7kp7QSVMpcBFTdxw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110906/8f48b7ac/attachment.pl>

From karl at huftis.org  Wed Sep  7 10:11:25 2011
From: karl at huftis.org (Karl Ove Hufthammer)
Date: Wed, 7 Sep 2011 10:11:25 +0200
Subject: [R-sig-Geo] Setting FID values when saving GML files with
	writeOGR
References: <j35ib5$h64$1@dough.gmane.org>
	<alpine.LRH.2.00.1108261939120.31153@reclus.nhh.no>
	<alpine.LRH.2.00.1108262024570.31153@reclus.nhh.no>
Message-ID: <j478ve$jnu$1@dough.gmane.org>

Roger Bivand wrote:

> Indeed, the driver internals are a possible solution, see:
> 
> http://www.gdal.org/ogr/drv_gml.html
> 
> which suggests that some reading is possible in OGR >= 1.8.0, but that
> writing will first come with OGR >= 1.9.0, that is the development
> version, I believe.

Thanks. I should have mentioned that I actually had read that page (and 
that was the reason I adding ?fid? and ?gml_id? columns), but couldn?t 
get the solution mentioned there to work.

Now I have actually managed to get it to work, on Linux. The Windows build 
of rgdal apparently uses a version of rgdal < 1.8.0. Is there a way to 
get information on which version (from inside R)?

My Linux system has OGR 1.8.1, which doesn?t support writing FID values 
(this will come in OGR 1.9.0), but *does* support writing gml:id values,
which is used in GML 3. GML 2 is the default, which means that to specifiy 
the feature ID, you have to:

1. Add a column called ?gml_id? to your spatial object.
2. Add the argument ?dataset_options="FORMAT=GML3"? to the writeOGR call.

This creates a GML 3 document with features identified by the values in the 
?gml_id? column (in the GML file they?re named ?gml:id?).

Note that neither RGDAL nor GDAL does any validation on the values in the 
?gml_id? column. To ensure that they?re valid, you can use the following 
?Name? regexp:

NameStartChar=":_A-Za-
z\uC0-\uD6\uD8-\uF6\uF8-\u2FF\u370-\u37D\u37F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD"
NameChar=paste(NameStartChar,"0-9\uB7\u0300-\u036F\u203F-\u2040F.-", sep="")
Name=paste("^[", NameStartChar, "][", NameChar, "]*$", sep="")

Example:
  grepl(Name,c("F23","23F","F","",":ABC","-ABC","A-B.","-AB","_.-",".-_","\u200C","\u200E"))

Note that the regexp is missing the character range \u10000-\uEFFFF, which I
couldn?t get R to recognise on my (UTF-8 Linux) system. But if R doesn?t
recognize the characters, they won?t appear in any strings, so this shouldn?t
be a problem ? :)

You also need to run ?anyDuplicated? to check that all the values are unique.

-- 
Karl Ove Hufthammer


From luca.candeloro at gmail.com  Wed Sep  7 13:12:36 2011
From: luca.candeloro at gmail.com (luca candeloro)
Date: Wed, 7 Sep 2011 13:12:36 +0200
Subject: [R-sig-Geo] Selecting polygons into buffer given center
Message-ID: <CAHF6Ynm_ttd58o0QFK71_UcJv56VwR5i4cjOfxHgH3Zk1vxA9Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110907/a225c22b/attachment.pl>

From tom.gottfried at tum.de  Wed Sep  7 13:41:10 2011
From: tom.gottfried at tum.de (Tom Gottfried)
Date: Wed, 07 Sep 2011 13:41:10 +0200
Subject: [R-sig-Geo] Selecting polygons into buffer given center
In-Reply-To: <CAHF6Ynm_ttd58o0QFK71_UcJv56VwR5i4cjOfxHgH3Zk1vxA9Q@mail.gmail.com>
References: <CAHF6Ynm_ttd58o0QFK71_UcJv56VwR5i4cjOfxHgH3Zk1vxA9Q@mail.gmail.com>
Message-ID: <4E675856.5000801@tum.de>

Hi Luca,

have a look at the functions in package rgeos.

regards,
Tom

Am 07.09.2011 13:12, schrieb luca candeloro:
> Hello,
> I'd like to select, given a SpatialPolygonDataframe and a point (of known
> coordinates), which are the polygons into the buffer (of a given distance)
> around the point.
> I tried the following code, but I don't know how to end it...
>
> UTM32WGS84<- CRS("+proj=utm +zone=32 +ellps=WGS84 +datum=WGS84 +no_defs")
> comuniUTM=spTransform(comuni, UTM32WGS84) #where comuni is a
> SpatialPolygonDataFrame
> puntoUTM<- spTransform(punto, UTM32WGS84) #where punto is a
> SpatialPointDataFrame
> #I create the spatial polygon whit the buffer of 4 km around the point using
> function disc() and converting it into a SpatialPolygons...
> discbuff<-disc(radius=4000, centre=puntoUTM at coords[,])
> discpoly<-Polygon(rbind(cbind(discbuff$bdry[[1]]$x,
> y=discbuff$bdry[[1]]$y), c(discbuff$bdry[[1]]$x[1],
> y=discbuff$bdry[[1]]$y[1])))
> discpoly=list(discpoly)
> discbuff<-Polygons(list(discpoly[[1]]), ID=1)
> discbuffSP=SpatialPolygons(list(discbuff))
> proj4string(discbuffSP)=UTM32WGS84
>
> #Does anyone konw how can I get the polygons in comuniUTM intersecting the
> discbuffSP?
>
> Thanks a lot,
> Luca.
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Technische Universit?t M?nchen
Department f?r Pflanzenwissenschaften
Lehrstuhl f?r Gr?nlandlehre
Alte Akademie 12
85350 Freising / Germany
Phone: ++49 (0)8161 715324
Fax:   ++49 (0)8161 713243
email: tom.gottfried at wzw.tum.de
http://www.wzw.tum.de/gruenland


From luca.candeloro at gmail.com  Wed Sep  7 13:59:50 2011
From: luca.candeloro at gmail.com (luca candeloro)
Date: Wed, 7 Sep 2011 13:59:50 +0200
Subject: [R-sig-Geo] Selecting polygons into buffer given center
In-Reply-To: <4E675856.5000801@tum.de>
References: <CAHF6Ynm_ttd58o0QFK71_UcJv56VwR5i4cjOfxHgH3Zk1vxA9Q@mail.gmail.com>
	<4E675856.5000801@tum.de>
Message-ID: <CAHF6YnnP5OHGJZWgAUc5B7U6M6oUu2u6N4OwUAyj-YvueagC1A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110907/615ef766/attachment.pl>

From benweinstein2010 at gmail.com  Wed Sep  7 14:26:59 2011
From: benweinstein2010 at gmail.com (Ben Weinstein)
Date: Wed, 7 Sep 2011 08:26:59 -0400
Subject: [R-sig-Geo] rgeos 'union' causes R crash
In-Reply-To: <CAC28k7SxebmSd44cLZ50Ta0iWQgUQyqszz-0ixaDXE4AA0ONSw@mail.gmail.com>
References: <CAC28k7TxJjLduE8jjCE5g7xgNa+0ZeND2vSxL36_FA0zunGMPw@mail.gmail.com>
	<CAC28k7TOOOYhVbue9VLhqKuq98RRdFEe9UaHGVo-KDO8GfUdYA@mail.gmail.com>
	<CAC28k7SxebmSd44cLZ50Ta0iWQgUQyqszz-0ixaDXE4AA0ONSw@mail.gmail.com>
Message-ID: <CAC28k7T88VNLFSD8WJKHNka6joOsCPzCSwtDyzjn6J436CHmcA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110907/05a297b0/attachment.pl>

From tom.gottfried at tum.de  Wed Sep  7 14:35:48 2011
From: tom.gottfried at tum.de (Tom Gottfried)
Date: Wed, 07 Sep 2011 14:35:48 +0200
Subject: [R-sig-Geo] Selecting polygons into buffer given center
In-Reply-To: <CAHF6YnnP5OHGJZWgAUc5B7U6M6oUu2u6N4OwUAyj-YvueagC1A@mail.gmail.com>
References: <CAHF6Ynm_ttd58o0QFK71_UcJv56VwR5i4cjOfxHgH3Zk1vxA9Q@mail.gmail.com>	<4E675856.5000801@tum.de>
	<CAHF6YnnP5OHGJZWgAUc5B7U6M6oUu2u6N4OwUAyj-YvueagC1A@mail.gmail.com>
Message-ID: <4E676524.90700@tum.de>

 From your initial question I suspect that what you want to do is

I <- gIntersects(b, comuniUTM, byID=TRUE)

Though this will probably rise the same error, which I suspect comes from the fact, that the 
polygons in comuniUTM are topologically not correct. You might want to clean them e.g. in GRASS. 
Others might correct me if there is an implementation for such a task in R.

Tom

Am 07.09.2011 13:59, schrieb luca candeloro:
> Thank you,
> I tried the following code:
>
> UTM32WGS84<- CRS("+proj=utm +zone=32 +ellps=WGS84 +datum=WGS84 +no_defs")
> comuniUTM=spTransform(comuni, UTM32WGS84) #where comuni is a
> SpatialPolygonDataFrame
> puntoUTM<- spTransform(punto, UTM32WGS84) #where punto is a
> SpatialPointDataFrame
>
> #I create the spatial polygon whit the buffer of 4 km around the point using function gbuffer from
> rgeos library (better than before)
> b=gBuffer(puntoUTM,width=4000,quadsegs=50)
>
> #Try to get intersection but an error occurs
> I=gIntersection(b,comuniUTM
>
> Errore in RGEOSBinTopoFunc(spgeom1, spgeom2, byid, id, "rgeos_intersection") :
> TopologyException: found non-noded intersection between LINESTRING (759692 4.85308e+006, 759729
> 4.85308e+006) and LINESTRING (759729 4.85308e+006, 759692 4.85308e+006) at 759723 4.85308e+006
>
> Do you konw about this error?
> Bye,
> Luca.
>
>
>
> 2011/9/7 Tom Gottfried <tom.gottfried at tum.de <mailto:tom.gottfried at tum.de>>
>
>     Hi Luca,
>
>     have a look at the functions in package rgeos.
>
>     regards,
>     Tom
>
>     Am 07.09.2011 13:12, schrieb luca candeloro:
>
>         Hello,
>         I'd like to select, given a SpatialPolygonDataframe and a point (of known
>         coordinates), which are the polygons into the buffer (of a given distance)
>         around the point.
>         I tried the following code, but I don't know how to end it...
>
>         UTM32WGS84<- CRS("+proj=utm +zone=32 +ellps=WGS84 +datum=WGS84 +no_defs")
>         comuniUTM=spTransform(comuni, UTM32WGS84) #where comuni is a
>         SpatialPolygonDataFrame
>         puntoUTM<- spTransform(punto, UTM32WGS84) #where punto is a
>         SpatialPointDataFrame
>         #I create the spatial polygon whit the buffer of 4 km around the point using
>         function disc() and converting it into a SpatialPolygons...
>         discbuff<-disc(radius=4000, centre=puntoUTM at coords[,])
>         discpoly<-Polygon(rbind(cbind(__discbuff$bdry[[1]]$x,
>         y=discbuff$bdry[[1]]$y), c(discbuff$bdry[[1]]$x[1],
>         y=discbuff$bdry[[1]]$y[1])))
>         discpoly=list(discpoly)
>         discbuff<-Polygons(list(__discpoly[[1]]), ID=1)
>         discbuffSP=SpatialPolygons(__list(discbuff))
>         proj4string(discbuffSP)=__UTM32WGS84
>
>         #Does anyone konw how can I get the polygons in comuniUTM intersecting the
>         discbuffSP?
>
>         Thanks a lot,
>         Luca.
>
>         [[alternative HTML version deleted]]
>
>         _________________________________________________
>         R-sig-Geo mailing list
>         R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>         https://stat.ethz.ch/mailman/__listinfo/r-sig-geo
>         <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>
>
>     --
>     Technische Universit?t M?nchen
>     Department f?r Pflanzenwissenschaften
>     Lehrstuhl f?r Gr?nlandlehre
>     Alte Akademie 12
>     85350 Freising / Germany
>     Phone: ++49 (0)8161 715324 <tel:%2B%2B49%20%280%298161%20715324>
>     Fax: ++49 (0)8161 713243 <tel:%2B%2B49%20%280%298161%20713243>
>     email: tom.gottfried at wzw.tum.de <mailto:tom.gottfried at wzw.tum.de>
>     http://www.wzw.tum.de/__gruenland <http://www.wzw.tum.de/gruenland>
>
>     _________________________________________________
>     R-sig-Geo mailing list
>     R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>     https://stat.ethz.ch/mailman/__listinfo/r-sig-geo <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>
>

-- 
Technische Universit?t M?nchen
Department f?r Pflanzenwissenschaften
Lehrstuhl f?r Gr?nlandlehre
Alte Akademie 12
85350 Freising / Germany
Phone: ++49 (0)8161 715324
Fax:   ++49 (0)8161 713243
email: tom.gottfried at wzw.tum.de
http://www.wzw.tum.de/gruenland


From dieter.mayr at boku.ac.at  Wed Sep  7 17:11:02 2011
From: dieter.mayr at boku.ac.at (didimayr)
Date: Wed, 7 Sep 2011 08:11:02 -0700 (PDT)
Subject: [R-sig-Geo] define projection for Raster data
Message-ID: <1315408262230-6768128.post@n2.nabble.com>

Hi all,
 

I have a very simple problem, I just want to define a projection for raster
data. However I have no experience with spatial analysis with R, so maybe
someone could give me a hint:
 
My data are radiation raster data for Austria, in .asc-format .
I have the following information:
 
Map projection: geographic (latitude/longitude), ellipsoid WGS84
North: 49N
South: 46:30N
West:  9:30E
East:   17:30E
Resolution 1'30''
 
...giving a total of 100 rows and 320 columns.

Is this information enough to get the right projection and if yes, how do I
define it in R?
 
Thank you so much and kind regards
Dieter Mayr from Vienna

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/define-projection-for-Raster-data-tp6768128p6768128.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From tgriffin at uaex.edu  Wed Sep  7 18:13:41 2011
From: tgriffin at uaex.edu (Terry Griffin)
Date: Wed, 7 Sep 2011 11:13:41 -0500
Subject: [R-sig-Geo] Simulating spatially autocorrelated data
In-Reply-To: <0F96478603980B46AAAFBA77069582ED131C7A36@UIEXCH.urban.org>
Message-ID: <a704895b-18d1-4f64-95f7-6558e63ba56c@zmail.uaex.edu>

Patrick,

Specification of the spatial weights matrix (W) is important, and, in general, the connectedness of the W influences the estimation and inference of the model. When you say that you do not know the "true rho", I suspect you are saying that you do not know the true underlying spatial structure of the data, and thus the appropriate specification of the spatial weights matrix. One tool in the spdep package that may be helpful to you is the sp.correlogram function for spatial correlogram; other techniques have been used including semivariograms. I would be interested in what others have to say regarding determining the optimal level of connectedness of W.

Two classic references regarding connectedness of W are:

Florax, R.J.G.M. and Rey, S. 1995 The Impacts of Misspecified Spatial Interaction in Linear Regression Models. In Anselin L, Florax R J G M (eds) New directions in spatial econometrics. Berlin, Springer: 111-135

Bell, K.P. and Bockstael, N.E. 2000. Applying the Generalized-Moment Estimation Approach to Spatial Problems Involving Micro level Data. The Review of Economics and Statistics, February 2000, 82 (1): 72-82.

Terry Griffin, Ph.D. 
Associate Professor - Economics 
University of Arkansas - Division of Agriculture 
501.249.6360 (SMS)
tgriffin at uaex.edu 




----- Original Message -----
From: "Patrick Downey" <PDowney at urban.org>
To: "Roger Bivand" <Roger.Bivand at nhh.no>
Cc: r-sig-geo at stat.math.ethz.ch
Sent: Tuesday, September 6, 2011 1:02:04 PM
Subject: Re: [R-sig-Geo] Simulating spatially autocorrelated data

Hi Roger and Terry,

Thank you very much for your help and directing me towards Roger's spdep
package, which of course had everything I needed. I've now worked through
this code and done some additional simulations.

I have one remaining question. You say "the larger the distance threshold,
the less well the spatial process is captured." I was wondering if you
could further provide some information on this, either by explaining or
referencing a document or webpage with explanation.

Decreasing the distance threshold, as you suggest, radically alters the
results and I'm looking for some guidance on how to select the appropriate
distance threshold when I don't know the true rho (that is, with
non-simulated data).

Thanks,
Mitch 


-----Original Message-----
From: Roger Bivand [mailto:Roger.Bivand at nhh.no] 
Sent: Thursday, September 01, 2011 2:20 PM
To: Downey, Patrick
Cc: r-sig-geo at stat.math.ethz.ch
Subject: Re: [R-sig-Geo] Simulating spatially autocorrelated data

On Thu, 1 Sep 2011, Downey, Patrick wrote:

> Hello all,
>
> I'm trying to simulate a spatially autocorrelated random variable, and 
> I cannot figure out what the problem is. All I want is a simple 
> spatial lag model where
>
> Y = rho*W*Y + e
>
> Where e is a vector of iid normal random variables, rho is the 
> autocorrelation, W is a row-normalized distance matrix (a spatial 
> weights matrix), and Y is the random variable.
>
> I thought the following program should do it, but it's not working. At 
> the end of the program, I calculate Moran's I, and it is not even 
> close to rejecting the null hypothesis of no spatial autocorrelation, 
> even when rho is very high (for example, below, rho is 0.95). Can 
> someone please identify what the problem is and offer some guidance on
how to fix it?
>
> PS - I apologize in advance, but I am not familiar with R's spatial 
> packages. I've done very little spatial analysis in R, so if there's a 
> package that can already do this, please recommend.
>
> BEGIN PROGRAM:
>
> install.packages("fields");library(fields)
> install.packages("ape");library(ape)
>
> N <- 200
> rho <- 0.95
>
> x.coord <- runif(N,0,100)
> y.coord <- runif(N,0,100)
>
> points <- cbind(x.coord,y.coord)
>
> e <- rnorm(N,0,1)
>
> dist.nonnorm <- rdist(points,points)   # Matrix of Euclidean distances
> dist <- dist.nonnorm/rowSums(dist.nonnorm)   # Row normalizing the
distance
> matrix
> diag(dist) <- 0   # Ensuring that the main diagonal is exactly 0

I think that you are using the distances as weights, not inverse distances,
which seems more sensible.

>
> I <- diag(N)   # Identity matrix (not Moran's I)
>
> inv <- solve(I-rho.lag*dist)   # Inverting (I - rho*W)
> y <- as.vector(inv %*% e)   # Generating data that is supposed to be
> spatially autocorrelated
>
> Moran.I(y,dist)   # Does not reject null hypothesis of no spatial
> autocorrelation
>

As Terry Griffin says, you can use spdep for this:

library(spdep)
rho <- 0.95
N <- 200
x.coord <- runif(N,0,100)
y.coord <- runif(N,0,100)
points <- cbind(x.coord,y.coord)
e <- rnorm(N,0,1)
dnb <- dnearneigh(points, 0, 150)
dsts <- nbdists(dnb, points)
idw <- lapply(dsts, function(x) 1/x)
lw <- nb2listw(dnb, glist=idw, style="W") inv <- invIrW(lw, rho) y <- inv
%*% e moran.test(y, lw)

to reproduce your analysis with IDW, here without:

lw <- nb2listw(dnb, glist=dsts, style="W") inv <- invIrW(lw, rho) y <- inv
%*% e moran.test(y, lw) # no autocorrelation

and here with a less inclusive distance threshold:

dnb <- dnearneigh(points, 0, 15)
dsts <- nbdists(dnb, points)
idw <- lapply(dsts, function(x) 1/x)
lw <- nb2listw(dnb, glist=idw, style="W") inv <- invIrW(lw, rho) y <- inv
%*% e moran.test(y, lw)


the larger the distance threshold, the less well the spatial process is
captured, alternatively use idw <- lapply(dsts, function(x) 1/(x^2)), for
example, to attenuate the weights more sharply.

Hope this clarifies,

Roger

> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

--
Roger Bivand
Department of Economics, NHH Norwegian School of Economics, Helleveien 30,
N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From afischbach at usgs.gov  Wed Sep  7 18:18:59 2011
From: afischbach at usgs.gov (Anthony Fischbach)
Date: Wed, 7 Sep 2011 09:18:59 -0700 (PDT)
Subject: [R-sig-Geo] define projection for Raster data
In-Reply-To: <1315408262230-6768128.post@n2.nabble.com>
References: <1315408262230-6768128.post@n2.nabble.com>
Message-ID: <1315412339351-6768425.post@n2.nabble.com>

Dear Dieter,
Please refer to the documentation of rgdal and sp.  Also as another newbie
to spatial data in R, I can strongly recommend starting your reading with
Bivand, Pebesma and G?mez-Rubio (2008: Applied Spatial Data Analysis with R. 
Springer).

To cast your raster map into a spatialPixelDataFrame, you will need to write
a script that has these elements.
require(rgdal) 
require(sp)
##read ascii grid using GDAL binding
map <- readGDAL("[your working directory]/map.asc") 
## coerce into a spatialPixelDataFrame
hab <- asc2spixdf(map) 
## Assign a Coordinate Reference System using a PROJ.4 string
prj <- CRS("+proj=longlat +ellps=WGS84 +datum=WGS84 + 
...[please see http://trac.osgeo.org/proj/wiki/GenParms to set your specific
parameters]")  
proj4string(hab) <- prj

HTH
Anthony



-----
Tony Fischbach, Wildlife Biologist
Walrus Research Program
Alaska Science Center
U.S. Geological Survey
4210 University Drive
Anchorage, AK 99508-4650

AFischbach at usgs.gov
http://alaska.usgs.gov/science/biology/walrus
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/define-projection-for-Raster-data-tp6768128p6768425.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From greenberg at ucdavis.edu  Wed Sep  7 20:01:22 2011
From: greenberg at ucdavis.edu (Jonathan Greenberg)
Date: Wed, 7 Sep 2011 11:01:22 -0700
Subject: [R-sig-Geo] Using stack() to extract every Nth band of the input
	files
Message-ID: <CABG0rft=WbFgAQCp9PfWrOzS-aD+-2U7k3_yQdp5Nt68SaGV=A@mail.gmail.com>

R-sig-geo'ers:

I'd like to make a stack from a set of 5-band images.  Using
stack(myfilenames,bands=3) doesn't appear to do it (I'm getting all
bands of all my input files).  Is it better to do something like:

my_rasters=sapply(myfilenames,function(x) { raster(x,band=3) },simplify=FALSE)
my_stack=stack(my_rasters)

... or is there an easier way to do this?

Thanks!

--j


From e.jahanshiri at gmail.com  Wed Sep  7 21:01:06 2011
From: e.jahanshiri at gmail.com (Ebrahim Jahanshiri)
Date: Thu, 8 Sep 2011 03:01:06 +0800
Subject: [R-sig-Geo] "dnearineigh" source code
Message-ID: <CANCB45tkFkC4GpMLFL0Wjkt4=ruVLSZgAT+RrdX235YFr=_Z0g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110908/cd049eea/attachment.pl>

From Roger.Bivand at nhh.no  Wed Sep  7 21:25:57 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 7 Sep 2011 21:25:57 +0200
Subject: [R-sig-Geo] "dnearineigh" source code
In-Reply-To: <CANCB45tkFkC4GpMLFL0Wjkt4=ruVLSZgAT+RrdX235YFr=_Z0g@mail.gmail.com>
References: <CANCB45tkFkC4GpMLFL0Wjkt4=ruVLSZgAT+RrdX235YFr=_Z0g@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1109072116300.31420@reclus.nhh.no>

On Thu, 8 Sep 2011, Ebrahim Jahanshiri wrote:

> I need to look into the code for "dnearneigh" so that I could get an idea of
> how to make weight matrices for any observation (i) based on some criteria.
> But a look into the spdep pack pointed me to the "spdep.dll". Probably
> written in some other languages. So I guess my question is how can I see the
> actual code for this and indeed other functions.

Please see:

http://cran.r-project.org/doc/Rnews/Rnews_2006-4.pdf

pp. 43-45 for a general answer. For all CRAN packages, the source code is 
always available for current versions on the package page, and for earlier 
versions in the archives. For some packages, including spdep, R-Forge 
hosting means that the source code can also be browsed online, at:

https://r-forge.r-project.org/scm/viewvc.php/?root=spdep

However, you are almost certainly not approaching this in a sensible way, 
as the glist= argument provides complete flexbility for adding arbitrary 
general weights to an nb object - list of neighbours. You do not need 
access to dnearneigh() internals to do this. If you want to define the 
neighbours in some specific way not already provided, you need to create a 
list of integer vectors of indices in the 1:n range for n observations, 
coding no-neighbour observations with the single integer id 0, adding 
class and other attributes.

Hope this helps,

Roger

>
> [The only answer I got by searching close to my problem is the answer by
> Prof. Bivand on the "lag.listw":
> http://r-sig-geo.2731867.n2.nabble.com/lag-listw-function-in-spdep-package-td2762785.html
> which belongs to 2006. ]
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Wed Sep  7 21:30:39 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 7 Sep 2011 21:30:39 +0200
Subject: [R-sig-Geo] Simulating spatially autocorrelated data
In-Reply-To: <a704895b-18d1-4f64-95f7-6558e63ba56c@zmail.uaex.edu>
References: <a704895b-18d1-4f64-95f7-6558e63ba56c@zmail.uaex.edu>
Message-ID: <alpine.LRH.2.00.1109072127280.31420@reclus.nhh.no>

On Wed, 7 Sep 2011, Terry Griffin wrote:

> Patrick,
>
> Specification of the spatial weights matrix (W) is important, and, in 
> general, the connectedness of the W influences the estimation and 
> inference of the model. When you say that you do not know the "true 
> rho", I suspect you are saying that you do not know the true underlying 
> spatial structure of the data, and thus the appropriate specification of 
> the spatial weights matrix. One tool in the spdep package that may be 
> helpful to you is the sp.correlogram function for spatial correlogram; 
> other techniques have been used including semivariograms. I would be 
> interested in what others have to say regarding determining the optimal 
> level of connectedness of W.
>
> Two classic references regarding connectedness of W are:
>
> Florax, R.J.G.M. and Rey, S. 1995 The Impacts of Misspecified Spatial 
> Interaction in Linear Regression Models. In Anselin L, Florax R J G M 
> (eds) New directions in spatial econometrics. Berlin, Springer: 111-135
>
> Bell, K.P. and Bockstael, N.E. 2000. Applying the Generalized-Moment 
> Estimation Approach to Spatial Problems Involving Micro level Data. The 
> Review of Economics and Statistics, February 2000, 82 (1): 72-82.

And a newer one:

Smith, T. E. (2009), Estimation Bias in Spatial Models with Strongly 
Connected Weight Matrices. Geographical Analysis, 41: 307?332. doi: 
10.1111/j.1538-4632.2009.00758.x

Sparse connections are present in the spatial weights, but the implied 
spatial process is dense, because the inverse of (I - \rho W) is dense. If 
the weights are strongly connected, the assumed process probably imples
"oversmoothing".

Roger

>
> Terry Griffin, Ph.D.
> Associate Professor - Economics
> University of Arkansas - Division of Agriculture
> 501.249.6360 (SMS)
> tgriffin at uaex.edu
>
>
>
>
> ----- Original Message -----
> From: "Patrick Downey" <PDowney at urban.org>
> To: "Roger Bivand" <Roger.Bivand at nhh.no>
> Cc: r-sig-geo at stat.math.ethz.ch
> Sent: Tuesday, September 6, 2011 1:02:04 PM
> Subject: Re: [R-sig-Geo] Simulating spatially autocorrelated data
>
> Hi Roger and Terry,
>
> Thank you very much for your help and directing me towards Roger's spdep
> package, which of course had everything I needed. I've now worked through
> this code and done some additional simulations.
>
> I have one remaining question. You say "the larger the distance threshold,
> the less well the spatial process is captured." I was wondering if you
> could further provide some information on this, either by explaining or
> referencing a document or webpage with explanation.
>
> Decreasing the distance threshold, as you suggest, radically alters the
> results and I'm looking for some guidance on how to select the appropriate
> distance threshold when I don't know the true rho (that is, with
> non-simulated data).
>
> Thanks,
> Mitch
>
>
> -----Original Message-----
> From: Roger Bivand [mailto:Roger.Bivand at nhh.no]
> Sent: Thursday, September 01, 2011 2:20 PM
> To: Downey, Patrick
> Cc: r-sig-geo at stat.math.ethz.ch
> Subject: Re: [R-sig-Geo] Simulating spatially autocorrelated data
>
> On Thu, 1 Sep 2011, Downey, Patrick wrote:
>
>> Hello all,
>>
>> I'm trying to simulate a spatially autocorrelated random variable, and
>> I cannot figure out what the problem is. All I want is a simple
>> spatial lag model where
>>
>> Y = rho*W*Y + e
>>
>> Where e is a vector of iid normal random variables, rho is the
>> autocorrelation, W is a row-normalized distance matrix (a spatial
>> weights matrix), and Y is the random variable.
>>
>> I thought the following program should do it, but it's not working. At
>> the end of the program, I calculate Moran's I, and it is not even
>> close to rejecting the null hypothesis of no spatial autocorrelation,
>> even when rho is very high (for example, below, rho is 0.95). Can
>> someone please identify what the problem is and offer some guidance on
> how to fix it?
>>
>> PS - I apologize in advance, but I am not familiar with R's spatial
>> packages. I've done very little spatial analysis in R, so if there's a
>> package that can already do this, please recommend.
>>
>> BEGIN PROGRAM:
>>
>> install.packages("fields");library(fields)
>> install.packages("ape");library(ape)
>>
>> N <- 200
>> rho <- 0.95
>>
>> x.coord <- runif(N,0,100)
>> y.coord <- runif(N,0,100)
>>
>> points <- cbind(x.coord,y.coord)
>>
>> e <- rnorm(N,0,1)
>>
>> dist.nonnorm <- rdist(points,points)   # Matrix of Euclidean distances
>> dist <- dist.nonnorm/rowSums(dist.nonnorm)   # Row normalizing the
> distance
>> matrix
>> diag(dist) <- 0   # Ensuring that the main diagonal is exactly 0
>
> I think that you are using the distances as weights, not inverse distances,
> which seems more sensible.
>
>>
>> I <- diag(N)   # Identity matrix (not Moran's I)
>>
>> inv <- solve(I-rho.lag*dist)   # Inverting (I - rho*W)
>> y <- as.vector(inv %*% e)   # Generating data that is supposed to be
>> spatially autocorrelated
>>
>> Moran.I(y,dist)   # Does not reject null hypothesis of no spatial
>> autocorrelation
>>
>
> As Terry Griffin says, you can use spdep for this:
>
> library(spdep)
> rho <- 0.95
> N <- 200
> x.coord <- runif(N,0,100)
> y.coord <- runif(N,0,100)
> points <- cbind(x.coord,y.coord)
> e <- rnorm(N,0,1)
> dnb <- dnearneigh(points, 0, 150)
> dsts <- nbdists(dnb, points)
> idw <- lapply(dsts, function(x) 1/x)
> lw <- nb2listw(dnb, glist=idw, style="W") inv <- invIrW(lw, rho) y <- inv
> %*% e moran.test(y, lw)
>
> to reproduce your analysis with IDW, here without:
>
> lw <- nb2listw(dnb, glist=dsts, style="W") inv <- invIrW(lw, rho) y <- inv
> %*% e moran.test(y, lw) # no autocorrelation
>
> and here with a less inclusive distance threshold:
>
> dnb <- dnearneigh(points, 0, 15)
> dsts <- nbdists(dnb, points)
> idw <- lapply(dsts, function(x) 1/x)
> lw <- nb2listw(dnb, glist=idw, style="W") inv <- invIrW(lw, rho) y <- inv
> %*% e moran.test(y, lw)
>
>
> the larger the distance threshold, the less well the spatial process is
> captured, alternatively use idw <- lapply(dsts, function(x) 1/(x^2)), for
> example, to attenuate the weights more sharply.
>
> Hope this clarifies,
>
> Roger
>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> --
> Roger Bivand
> Department of Economics, NHH Norwegian School of Economics, Helleveien 30,
> N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From rundel at gmail.com  Wed Sep  7 22:34:13 2011
From: rundel at gmail.com (Colin Rundel)
Date: Wed, 7 Sep 2011 16:34:13 -0400
Subject: [R-sig-Geo] rgeos 'union' causes R crash
In-Reply-To: <CAC28k7T88VNLFSD8WJKHNka6joOsCPzCSwtDyzjn6J436CHmcA@mail.gmail.com>
References: <CAC28k7TxJjLduE8jjCE5g7xgNa+0ZeND2vSxL36_FA0zunGMPw@mail.gmail.com>
	<CAC28k7TOOOYhVbue9VLhqKuq98RRdFEe9UaHGVo-KDO8GfUdYA@mail.gmail.com>
	<CAC28k7SxebmSd44cLZ50Ta0iWQgUQyqszz-0ixaDXE4AA0ONSw@mail.gmail.com>
	<CAC28k7T88VNLFSD8WJKHNka6joOsCPzCSwtDyzjn6J436CHmcA@mail.gmail.com>
Message-ID: <D1AD22B2-A637-4252-A531-CB3D12B5C7B5@gmail.com>

Hi Ben,

My best guess based on the information you have provided is that R is running out of memory, particularly for complex polygons Unions can use a huge amount of memory. Can you check with the task manager what the memory usage looks like when running your code?

-Colin

On Sep 7, 2011, at 8:26 AM, Ben Weinstein wrote:

> Hi all-
> 
> I'm having an odd issue with the gUnion family of commands from the rgeos
> package. I'm importing a series of polygons (species) and trying to find the
> centroid. Each species is only allowed one centroids, so i need to union the
> multiple polygons. this code works great when run line by line. But when run
> as an actual loop, but adding the {} at beginning and end, it gives me a
> runtime error. I have debugged it to the level that i know it is the union
> polygon step. I am running R 2.13, and it was designed for 2.13.1, is that
> really making the difference? When run, R completely freezes and windows
> shuts it down.
> 
> library(rgdal)
> library(PBSmapping)
> library(maptools)
> library(raster)
> library(rgeos)
> #Enter File Directory Below
> setwd("D:/Ben/R/Trochilidae")
> #Pull in all shapefiles in that folder that are polygons
> a<-list.files(pattern='pl.shp$', full.names=FALSE)
> output<-matrix(nrow=length(a),ncol=3)
> colnames(output)<-c("Sci_Name","X_centroid","Y_centroid")
> for(x in 1:length(a)){
> output[(x),1]<-paste(gsub(".shp","",a[x]))
> range<-readShapePoly(a[x], delete_null_obj=TRUE)
> subsetx<-range[range$PRESENCE == 1,]
> subsetx2<-subsetx[subsetx$ORIGIN ==1|subsetx$ORIGIN==2,]
> z<-matrix(length(subsetx2),1, data=1)
> Union<-unionSpatialPolygons(subsetx2,z)
> Breeding.ps<- SpatialPolygons2PolySet(Union)
> Breeding.centroids<- calcCentroid(Breeding.ps, rollup=1)
> output[x,2:3]<-as.matrix(Breeding.centroids[2:3])}
> 
> thanks
> 
> ben weinstein
> 
> 
> 
> 
> -- 
> Ben Weinstein
> Graduate Student
> Ecology and Evolution
> Stony Brook University
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From brenning at uwaterloo.ca  Thu Sep  8 03:19:06 2011
From: brenning at uwaterloo.ca (Alexander Brenning)
Date: Wed, 7 Sep 2011 21:19:06 -0400
Subject: [R-sig-Geo] new RSAGA release (update recommended)
Message-ID: <4E68180A.3090003@uwaterloo.ca>

Dear list,

a new release of RSAGA (version 0.92-2) is available on CRAN. It comes 
with several small but important updates and improvements, which is why 
I encourage RSAGA users to update to this latest release, and why I 
provide this short summary of changes. RSAGA integrates SAGA GIS into R, 
see http://cran.r-project.org/web/packages/RSAGA/index.html

This new release supports SAGA GIS versions 2.0.4 to 2.0.7 (previous 
RSAGA versions had trouble with recent changes in names of SAGA module 
arguments). It performs a version check and provides error/warning 
messages if necessary. Some minor adjustment have also been made that 
will make RSAGA run smoother on unix systems.

If you use RSAGA to apply fitted models to stacks of grids with 
predictor variables, this can now be done much faster with the new 
multi.local.function instead of the much more general 
multi.focal.function. On a test data set, the application of a GAM to a 
couple of nonlinear predictor variables ended up being 162 times faster 
with the new multi.local.function than in the multi.focal.function 
implementation (but I haven't compared it to equivalent functions in the 
raster package).

Thanks to Johan van der Wouw for testing the RSAGA on unix.

Cheers
   Alex

-- 
Alexander Brenning
brenning at uwaterloo.ca - T +1-519-888-4567 ext 35783
Department of Geography and Environmental Management
University of Waterloo
200 University Ave. W - Waterloo, ON - Canada N2L 3G1
http://www.environment.uwaterloo.ca/geography/faculty/brenning/


From luca.candeloro at gmail.com  Thu Sep  8 10:53:23 2011
From: luca.candeloro at gmail.com (luca candeloro)
Date: Thu, 8 Sep 2011 10:53:23 +0200
Subject: [R-sig-Geo] Selecting polygons into buffer given center
In-Reply-To: <4E676524.90700@tum.de>
References: <CAHF6Ynm_ttd58o0QFK71_UcJv56VwR5i4cjOfxHgH3Zk1vxA9Q@mail.gmail.com>
	<4E675856.5000801@tum.de>
	<CAHF6YnnP5OHGJZWgAUc5B7U6M6oUu2u6N4OwUAyj-YvueagC1A@mail.gmail.com>
	<4E676524.90700@tum.de>
Message-ID: <CAHF6YnkV9LdPyje+YjbNhdFZun60wNAiuUmgHYLmTSZ2g6H0=w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110908/b79f4e3d/attachment.pl>

From riccardog79 at gmail.com  Thu Sep  8 15:15:39 2011
From: riccardog79 at gmail.com (Riccardo Gaeta)
Date: Thu, 8 Sep 2011 15:15:39 +0200
Subject: [R-sig-Geo] Clustering 3D point
Message-ID: <CAHQmNyF2qRKYBXnp+tFpQ9+pWs_J4a4UzeaWM8j6UX0h4uJizg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110908/fbefc823/attachment.pl>

From marcelino.delacruz at upm.es  Thu Sep  8 16:07:53 2011
From: marcelino.delacruz at upm.es (Marcelino de la Cruz)
Date: Thu, 08 Sep 2011 16:07:53 +0200
Subject: [R-sig-Geo] Clustering 3D point
In-Reply-To: <CAHQmNyF2qRKYBXnp+tFpQ9+pWs_J4a4UzeaWM8j6UX0h4uJizg@mail.g
	mail.com>
References: <CAHQmNyF2qRKYBXnp+tFpQ9+pWs_J4a4UzeaWM8j6UX0h4uJizg@mail.gmail.com>
Message-ID: <201109081409.p88E99Nn002674@smtp.upm.es>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110908/9d7f2656/attachment.pl>

From riccardog79 at gmail.com  Thu Sep  8 17:23:37 2011
From: riccardog79 at gmail.com (Riccardo Gaeta)
Date: Thu, 8 Sep 2011 17:23:37 +0200
Subject: [R-sig-Geo] Clustering 3D point
In-Reply-To: <201109081409.p88E99Nn002674@smtp.upm.es>
References: <CAHQmNyF2qRKYBXnp+tFpQ9+pWs_J4a4UzeaWM8j6UX0h4uJizg@mail.gmail.com>
	<201109081409.p88E99Nn002674@smtp.upm.es>
Message-ID: <CAHQmNyFRHYhGPAV+=EuOYk7UFRuBa+iEh2oGVDNXYa8BDDydQA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110908/97ea986b/attachment.pl>

From benweinstein2010 at gmail.com  Thu Sep  8 19:16:07 2011
From: benweinstein2010 at gmail.com (Ben Weinstein)
Date: Thu, 8 Sep 2011 13:16:07 -0400
Subject: [R-sig-Geo]  rgeos 'union' causes R crash
In-Reply-To: <CAC28k7SwMffz8G7FQeu60grbPkSSz3qk5uTj+4Ae_VcmJod_5g@mail.gmail.com>
References: <CAC28k7TxJjLduE8jjCE5g7xgNa+0ZeND2vSxL36_FA0zunGMPw@mail.gmail.com>
	<CAC28k7TOOOYhVbue9VLhqKuq98RRdFEe9UaHGVo-KDO8GfUdYA@mail.gmail.com>
	<CAC28k7SxebmSd44cLZ50Ta0iWQgUQyqszz-0ixaDXE4AA0ONSw@mail.gmail.com>
	<CAC28k7T88VNLFSD8WJKHNka6joOsCPzCSwtDyzjn6J436CHmcA@mail.gmail.com>
	<D1AD22B2-A637-4252-A531-CB3D12B5C7B5@gmail.com>
	<CAC28k7SwMffz8G7FQeu60grbPkSSz3qk5uTj+4Ae_VcmJod_5g@mail.gmail.com>
Message-ID: <CAC28k7Tq7Fce6qO7tF1xSHYf4adGyL5+_MqNX1eQW+_aeZajoQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110908/4155a37a/attachment.pl>

From afischbach at usgs.gov  Thu Sep  8 21:53:42 2011
From: afischbach at usgs.gov (Anthony Fischbach)
Date: Thu, 8 Sep 2011 12:53:42 -0700 (PDT)
Subject: [R-sig-Geo] placing spdf back into adehabiatHR estUDm
In-Reply-To: <1312913036614-6669114.post@n2.nabble.com>
References: <1308601895714-6497315.post@n2.nabble.com>
	<4E0AD902.30108@oncfs.gouv.fr>
	<1312913036614-6669114.post@n2.nabble.com>
Message-ID: <1315511622963-6773497.post@n2.nabble.com>

I have worked from the script that you provided in your previous posting to
address the question, 
"Is there a means to convert the SpatialPixelDataFrame back into an estUDm?
"
My modifications to your script are noted by my initials, ***ASF**.

I have extended your script to work with an estUDm created by the BRB
function.

In delving into the estUDm object I noticed two odd things.
	1) estUD objects within the estUDm do not have names assigned when they are
created by the BRB function.
	2) each estUD object within the estUDm has a full listing of the D values
from all animals listed in the estUDm.

I was able to clip the estUD's using the habitat grid.  By use of the slot()
function I was able to placed the 'clipped' utilization distribution in the
form of a spatial pixel data frame back into the estUDm class object. 
However, the resultant estUDm raster appears to have the y coordinates
reversed.

The modified script is listed below.

## Load the data
library(adehabitatHR)
library(adehabitatLT)
data(puechabonsp)

## Store the relocations
loc <- puechabonsp$relocs

## and the map
elev <- puechabonsp$map

## have a look at the data
head(as.data.frame(loc))
## the first column of this data frame is the ID

## Look at the map
image(elev)

## Now we build a "fake" habitat map (1 = habitat and 0 = non habitat) from
the elevation map
fullgrid(elev) <- TRUE
hab <- elev
hab[[1]] <- as.numeric(!is.na(hab[[1]]))

## show this habitat map (yellow is habitat)
image(hab)

## Estimation of UD for the four animals, using
## the map hab as the grid
ud <- kernelUD(loc[,1], grid=hab)
###ASF### 
###ASF### try with BRB
###ASF### first make ltraj object
###ASF### Cast the Dates as POSIXct dates
loc$DT <-as.POSIXct(strptime(loc$Date, format='%y%m%d' ))
###ASF### Create an ltraj trajectory object.
ltraj <- as.ltraj(coordinates(loc), loc$DT, id = loc$Name, burst = loc$Name,
typeII = TRUE)
###ASF### Assigne parameter values for BRB
###ASF### Parameters for the Biased Random Bridge Kernel approach
tmax <- 5*(24*60*60) + 1	## set the maximum time between locations to be
just more than 5 day
lmin <- 0.1	## locations less than 0.1 meters apart are considered inactive.  
			## Set very very low to ensure that the acvitivy variable is used.
hMin <- 100	## arbitrarily set to be same as hab grid cell resolution

vv2<- BRB.likD(ltraj, Dr=c(1,50000), Tmax = tmax, Lmin = lmin,  habitat =
NULL)  ##
ud <-BRB(ltraj, D =vv2, Tmax =tmax, Lmin = lmin, hmin = hMin, habitat =
NULL,  
		grid = hab, b = TRUE, extent = 0, tau = 24*60*60 )
## ud is an object of the class estUDm
## get volumetric contours
ver <- getverticeshr(ud, percent=95,  standardize = TRUE, whi = id(ltraj))
###ASF###  !! PROBLEM !!
# > str(ud)
# List of 4
 # $ :Formal class 'estUD' [package "adehabitatHR"] with 9 slots
  # .. ..@ h          :List of 3
  # .. .. ..$ values:List of 2
  # .. .. .. ..$ hmin: num 100
  # .. .. .. ..$ D   :List of 4
  # .. .. .. .. ..$ Brock: num 4.26
  # .. .. .. .. ..$ Calou: num 1
  # .. .. .. .. ..$ Chou : num 1.86
  # .. .. .. .. ..$ Jean : num 6.21
  # ... further str(ud) results omitted
###ASF### 2 Problems apparent here: 
###ASF### 1) no names have been assigned to the items in the ud list;
###ASF### 2) the list of D values has been inflated such that a full listing
of D values is given under each animal, rather than just one for each animal
###ASF### address names in ud by assigning them to be the same as the ids in
ltraj
names(ud) <- id(ltraj)
## Convert it to SpatialPixelsDataFrame:
udspdf <- estUDm2spixdf(ud)

## udspdf is an object of class SpatialPixelsDataFrame
## have a look
mimage(udspdf)

## Convert the original map to fullgrid (i.e. SpatialGridDataFrame)
fullgrid(udspdf) <- TRUE

## and the same for the original habitat map (here, it is not needed,
## as the map hab is already fullgrid, but it might be required on you data)
fullgrid(hab)<-TRUE

## The two maps have the same dimensions:
## > length(udspdf[[1]])
## [1] 6636
## > length(hab[[1]])
## [1] 6636

## Then, you just have to multiply each column of udspdf by the habitat
variable:
resu <- lapply(1:ncol(udspdf), function(i) {
     udspdf[[i]] * hab[[1]] / sum(udspdf[[i]] * hab[[1]])
})
resu <- as.data.frame(resu)
names(resu) <- names(udspdf at data)

## and define it as data slot for udspdf
udspdf at data <- resu

## Have a look at the data (after conversion to SpatialPixelsDataFrame):
fullgrid(udspdf) <- FALSE
mimage(udspdf)

## Note that Brock and Calou, the UD have sharp limits
###ASF### Yes I see this.

###ASF### [2011 August 05]: Questions for ClementCalenge:
###ASF### ???? How can we extract home-range contours now that the home
range estimates are of class SpatialPixelsDataFrame?
###ASF### In an effort to return access the function getverticeshr, cast the
'clipped' udspdf back into the estUDm object
###ASF### Try stepping through each animal in the ud and replacing the @data
element.

ud2 <- ud	##make copy of the ud
	for (i in 1:length(ud2)){
		idStr <- id(ltraj[i])
		print(paste(i, "th animal is ", idStr, sep=""))
		temp <- udspdf[idStr]
		udf <- temp at data
		names(udf) = "dens"
		print(summary(slot(ud2[[i]], "data")))	## print summary of the ud object
		print(summary(udf))	## print summary of the udspdf object
		slot(ud2[[i]], "data", check = TRUE) <- udf	## Replaced the data slot with
the clipped data
	}
ver2 <- getverticeshr(ud2, percent=95,  standardize = TRUE, whi = id(ltraj))
###ASF### !!PROBLEM!! the coordinates are twisted.
###ASF### Have a look at the resulting ud
image(ud2)




-----
Tony Fischbach, Wildlife Biologist
Walrus Research Program
Alaska Science Center
U.S. Geological Survey
4210 University Drive
Anchorage, AK 99508-4650

AFischbach at usgs.gov
http://alaska.usgs.gov/science/biology/walrus
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Walruses-and-adehabitatHR-class-estUDm-exclusion-of-non-habitat-pixels-and-summary-over-all-animals-tp6497315p6773497.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From greenberg at ucdavis.edu  Thu Sep  8 22:25:15 2011
From: greenberg at ucdavis.edu (Jonathan Greenberg)
Date: Thu, 8 Sep 2011 13:25:15 -0700
Subject: [R-sig-Geo] Checking whether a file is a "good" raster
Message-ID: <CABG0rfvdwEXMMNsHF_sPuQU0XRbpE8gZg3kBuRyw2_b5E_YLUw@mail.gmail.com>

R-sig-geo'ers:

I'm trying to write a raster catalog function, and one thing I'm
running into is how to properly check if a file is a legitimate raster
format -- I'm defining "legit" as GDALinfo recognizing it as a
supported format, e.g. does not return:

Error in .local(.Object, ...) :
  `/pathto/myfile' not recognised as a supported file format.

I'm just looking for a TRUE/FALSE situation, at present (TRUE if
GDALinfo returns a valid response, FALSE if it returns the error
above).  Thoughts?

--j


-- 
Jonathan A. Greenberg, PhD
Assistant Project Scientist
Center for Spatial Technologies and Remote Sensing (CSTARS)
Department of Land, Air and Water Resources
University of California, Davis
One Shields Avenue
Davis, CA 95616
Phone: 415-763-5476
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307


From Roger.Bivand at nhh.no  Thu Sep  8 22:36:54 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 8 Sep 2011 22:36:54 +0200
Subject: [R-sig-Geo] Checking whether a file is a "good" raster
In-Reply-To: <CABG0rfvdwEXMMNsHF_sPuQU0XRbpE8gZg3kBuRyw2_b5E_YLUw@mail.gmail.com>
References: <CABG0rfvdwEXMMNsHF_sPuQU0XRbpE8gZg3kBuRyw2_b5E_YLUw@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1109082229480.3517@reclus.nhh.no>

On Thu, 8 Sep 2011, Jonathan Greenberg wrote:

> R-sig-geo'ers:
>
> I'm trying to write a raster catalog function, and one thing I'm
> running into is how to properly check if a file is a legitimate raster
> format -- I'm defining "legit" as GDALinfo recognizing it as a
> supported format, e.g. does not return:
>
> Error in .local(.Object, ...) :
>  `/pathto/myfile' not recognised as a supported file format.
>
> I'm just looking for a TRUE/FALSE situation, at present (TRUE if
> GDALinfo returns a valid response, FALSE if it returns the error
> above).  Thoughts?


> library(rgdal)
> o <- try(GDALinfo(system.file("external/test.ag", package="sp")[1]), 
+ silent=TRUE)
> class(o)
[1] "GDALobj"
> o <- try(GDALinfo(system.file("vectors/ps_cant_31.MIF", package = 
+ "rgdal")[1]), silent=TRUE)
> class(o)
[1] "try-error"

So wrap in try() and test that the output class is not "try-error". Also 
see ?tryCatch.

Roger

>
> --j
>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From edzer.pebesma at uni-muenster.de  Thu Sep  8 22:50:05 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 08 Sep 2011 22:50:05 +0200
Subject: [R-sig-Geo] placing spdf back into adehabiatHR estUDm
In-Reply-To: <1315511622963-6773497.post@n2.nabble.com>
References: <1308601895714-6497315.post@n2.nabble.com>	<4E0AD902.30108@oncfs.gouv.fr>	<1312913036614-6669114.post@n2.nabble.com>
	<1315511622963-6773497.post@n2.nabble.com>
Message-ID: <4E692A7D.70100@uni-muenster.de>

Anthony, your script fails for me at the following point:

> ver <- getverticeshr(ud, percent=95,  standardize = TRUE, whi = id(ltraj))
Error in getverticeshr.default(x[[i]], percent, ida = names(x)[i], unin,  :
  no method provided for this class

In general, it is easier for someone on the list to answer your question
if you send a minimal script that reproduces the problem -- I'm not sure
the 134 lines were all needed.

If you want to construct objects of a certain class at the low level,
using the slot() function, you should first fully understand how the
objects are organized. Documentation is sparse (as source code is
there), but

class?SpatialPixelsDataFrame

will help you as a start. A likely cause may be that you assume y
increases when you go along the pixels in the @data slot (as image()
assumes the first row is the most South-bound row), but this is not the
case for the sp grid classes.


On 09/08/2011 09:53 PM, Anthony Fischbach wrote:
> I have worked from the script that you provided in your previous posting to
> address the question, 
> "Is there a means to convert the SpatialPixelDataFrame back into an estUDm?
> "
> My modifications to your script are noted by my initials, ***ASF**.
> 
> I have extended your script to work with an estUDm created by the BRB
> function.
> 
> In delving into the estUDm object I noticed two odd things.
> 	1) estUD objects within the estUDm do not have names assigned when they are
> created by the BRB function.
> 	2) each estUD object within the estUDm has a full listing of the D values
> from all animals listed in the estUDm.
> 
> I was able to clip the estUD's using the habitat grid.  By use of the slot()
> function I was able to placed the 'clipped' utilization distribution in the
> form of a spatial pixel data frame back into the estUDm class object. 
> However, the resultant estUDm raster appears to have the y coordinates
> reversed.
> 
> The modified script is listed below.
> 
> ## Load the data
> library(adehabitatHR)
> library(adehabitatLT)
> data(puechabonsp)
> 
> ## Store the relocations
> loc <- puechabonsp$relocs
> 
> ## and the map
> elev <- puechabonsp$map
> 
> ## have a look at the data
> head(as.data.frame(loc))
> ## the first column of this data frame is the ID
> 
> ## Look at the map
> image(elev)
> 
> ## Now we build a "fake" habitat map (1 = habitat and 0 = non habitat) from
> the elevation map
> fullgrid(elev) <- TRUE
> hab <- elev
> hab[[1]] <- as.numeric(!is.na(hab[[1]]))
> 
> ## show this habitat map (yellow is habitat)
> image(hab)
> 
> ## Estimation of UD for the four animals, using
> ## the map hab as the grid
> ud <- kernelUD(loc[,1], grid=hab)
> ###ASF### 
> ###ASF### try with BRB
> ###ASF### first make ltraj object
> ###ASF### Cast the Dates as POSIXct dates
> loc$DT <-as.POSIXct(strptime(loc$Date, format='%y%m%d' ))
> ###ASF### Create an ltraj trajectory object.
> ltraj <- as.ltraj(coordinates(loc), loc$DT, id = loc$Name, burst = loc$Name,
> typeII = TRUE)
> ###ASF### Assigne parameter values for BRB
> ###ASF### Parameters for the Biased Random Bridge Kernel approach
> tmax <- 5*(24*60*60) + 1	## set the maximum time between locations to be
> just more than 5 day
> lmin <- 0.1	## locations less than 0.1 meters apart are considered inactive.  
> 			## Set very very low to ensure that the acvitivy variable is used.
> hMin <- 100	## arbitrarily set to be same as hab grid cell resolution
> 
> vv2<- BRB.likD(ltraj, Dr=c(1,50000), Tmax = tmax, Lmin = lmin,  habitat =
> NULL)  ##
> ud <-BRB(ltraj, D =vv2, Tmax =tmax, Lmin = lmin, hmin = hMin, habitat =
> NULL,  
> 		grid = hab, b = TRUE, extent = 0, tau = 24*60*60 )
> ## ud is an object of the class estUDm
> ## get volumetric contours
> ver <- getverticeshr(ud, percent=95,  standardize = TRUE, whi = id(ltraj))
> ###ASF###  !! PROBLEM !!
> # > str(ud)
> # List of 4
>  # $ :Formal class 'estUD' [package "adehabitatHR"] with 9 slots
>   # .. ..@ h          :List of 3
>   # .. .. ..$ values:List of 2
>   # .. .. .. ..$ hmin: num 100
>   # .. .. .. ..$ D   :List of 4
>   # .. .. .. .. ..$ Brock: num 4.26
>   # .. .. .. .. ..$ Calou: num 1
>   # .. .. .. .. ..$ Chou : num 1.86
>   # .. .. .. .. ..$ Jean : num 6.21
>   # ... further str(ud) results omitted
> ###ASF### 2 Problems apparent here: 
> ###ASF### 1) no names have been assigned to the items in the ud list;
> ###ASF### 2) the list of D values has been inflated such that a full listing
> of D values is given under each animal, rather than just one for each animal
> ###ASF### address names in ud by assigning them to be the same as the ids in
> ltraj
> names(ud) <- id(ltraj)
> ## Convert it to SpatialPixelsDataFrame:
> udspdf <- estUDm2spixdf(ud)
> 
> ## udspdf is an object of class SpatialPixelsDataFrame
> ## have a look
> mimage(udspdf)
> 
> ## Convert the original map to fullgrid (i.e. SpatialGridDataFrame)
> fullgrid(udspdf) <- TRUE
> 
> ## and the same for the original habitat map (here, it is not needed,
> ## as the map hab is already fullgrid, but it might be required on you data)
> fullgrid(hab)<-TRUE
> 
> ## The two maps have the same dimensions:
> ## > length(udspdf[[1]])
> ## [1] 6636
> ## > length(hab[[1]])
> ## [1] 6636
> 
> ## Then, you just have to multiply each column of udspdf by the habitat
> variable:
> resu <- lapply(1:ncol(udspdf), function(i) {
>      udspdf[[i]] * hab[[1]] / sum(udspdf[[i]] * hab[[1]])
> })
> resu <- as.data.frame(resu)
> names(resu) <- names(udspdf at data)
> 
> ## and define it as data slot for udspdf
> udspdf at data <- resu
> 
> ## Have a look at the data (after conversion to SpatialPixelsDataFrame):
> fullgrid(udspdf) <- FALSE
> mimage(udspdf)
> 
> ## Note that Brock and Calou, the UD have sharp limits
> ###ASF### Yes I see this.
> 
> ###ASF### [2011 August 05]: Questions for ClementCalenge:
> ###ASF### ???? How can we extract home-range contours now that the home
> range estimates are of class SpatialPixelsDataFrame?
> ###ASF### In an effort to return access the function getverticeshr, cast the
> 'clipped' udspdf back into the estUDm object
> ###ASF### Try stepping through each animal in the ud and replacing the @data
> element.
> 
> ud2 <- ud	##make copy of the ud
> 	for (i in 1:length(ud2)){
> 		idStr <- id(ltraj[i])
> 		print(paste(i, "th animal is ", idStr, sep=""))
> 		temp <- udspdf[idStr]
> 		udf <- temp at data
> 		names(udf) = "dens"
> 		print(summary(slot(ud2[[i]], "data")))	## print summary of the ud object
> 		print(summary(udf))	## print summary of the udspdf object
> 		slot(ud2[[i]], "data", check = TRUE) <- udf	## Replaced the data slot with
> the clipped data
> 	}
> ver2 <- getverticeshr(ud2, percent=95,  standardize = TRUE, whi = id(ltraj))
> ###ASF### !!PROBLEM!! the coordinates are twisted.
> ###ASF### Have a look at the resulting ud
> image(ud2)
> 
> 
> 
> 
> -----
> Tony Fischbach, Wildlife Biologist
> Walrus Research Program
> Alaska Science Center
> U.S. Geological Survey
> 4210 University Drive
> Anchorage, AK 99508-4650
> 
> AFischbach at usgs.gov
> http://alaska.usgs.gov/science/biology/walrus
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Walruses-and-adehabitatHR-class-estUDm-exclusion-of-non-habitat-pixels-and-summary-over-all-animals-tp6497315p6773497.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From pascaltitle at gmail.com  Thu Sep  8 22:53:32 2011
From: pascaltitle at gmail.com (Pascal Title)
Date: Thu, 8 Sep 2011 13:53:32 -0700
Subject: [R-sig-Geo] sp package seems to round my coordinates
Message-ID: <CAPSA=ydrf9E8DVfJWfp=t3zokPtTVfyKbm+5V0fnZTM=zocWnQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110908/060d4edc/attachment.pl>

From afischbach at usgs.gov  Thu Sep  8 23:24:43 2011
From: afischbach at usgs.gov (Anthony Fischbach)
Date: Thu, 8 Sep 2011 14:24:43 -0700 (PDT)
Subject: [R-sig-Geo] placing spdf back into adehabiatHR estUDm
In-Reply-To: <4E692A7D.70100@uni-muenster.de>
References: <1308601895714-6497315.post@n2.nabble.com>
	<4E0AD902.30108@oncfs.gouv.fr>
	<1312913036614-6669114.post@n2.nabble.com>
	<1315511622963-6773497.post@n2.nabble.com>
	<4E692A7D.70100@uni-muenster.de>
Message-ID: <1315517083182-6773846.post@n2.nabble.com>

The failure with the line in my posted script is due to the lack of names in
the estUDm object.
It runs if you first run *names* function then the *getverticeshr* function
-- highlighting the bug in the BRB function and in my posted script.

> names(ud) <- id(ltraj)
> ver <- getverticeshr(ud, percent=95,  standardize = TRUE, whi = id(ltraj))


Edzer Pebesma-2 wrote:
> 
> Anthony, your script fails for me at the following point:
> 
>> ver <- getverticeshr(ud, percent=95,  standardize = TRUE, whi =
>> id(ltraj))
> Error in getverticeshr.default(x[[i]], percent, ida = names(x)[i], unin, 
> :
>   no method provided for this class
> 


-----
Tony Fischbach, Wildlife Biologist
Walrus Research Program
Alaska Science Center
U.S. Geological Survey
4210 University Drive
Anchorage, AK 99508-4650

AFischbach at usgs.gov
http://alaska.usgs.gov/science/biology/walrus
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Walruses-and-adehabitatHR-class-estUDm-exclusion-of-non-habitat-pixels-and-summary-over-all-animals-tp6497315p6773846.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Roger.Bivand at nhh.no  Thu Sep  8 23:40:13 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 8 Sep 2011 23:40:13 +0200 (CEST)
Subject: [R-sig-Geo] sp package seems to round my coordinates
In-Reply-To: <CAPSA=ydrf9E8DVfJWfp=t3zokPtTVfyKbm+5V0fnZTM=zocWnQ@mail.gmail.com>
References: <CAPSA=ydrf9E8DVfJWfp=t3zokPtTVfyKbm+5V0fnZTM=zocWnQ@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1109082334590.3517@reclus.nhh.no>

On Thu, 8 Sep 2011, Pascal Title wrote:

> Hi
>
> I have a dataframe containing coordinates and metadata that I am converting
> to SpatialPointsDataFrame using the function from the sp package.
> However, I have noticed that the resulting coordinates have fewer decimal
> places than my original data. This is problematic for me because later on I
> will be using these coordinates to match them with the original records in
> order to retrieve other information.
>
> Is there any way I can have the function keep my coordinates as is?

This is a FAQ - you are mistaking the internal representation, which 
retails precision, with the displayed representation, which uses the 
default number of digits set by options() for all print() methods. So when 
you print splisttemp, you are actually saying:

print(splisttemp)

and could say:

print(splisttemp, digits=4)
print(splisttemp, digits=12)

or equivalently set the option to another value, with different output.

See:

set.seed(1)
x <- rnorm(10)
print(x)
print(x, digits=4)
print(x, digits=14)

Hope this clarifies,

Roger

> Here is an example:
>
>> splisttemp
>   DecimalLongitude DecimalLatitude SpAbbr InstitutionCode CatalogNumberText
> 1         -76.87271       3.6628163 BanRot       EBIRD_COL       OBS81997559
> 2         -76.97495       3.7168289 BanRot          AUDCLO       OBS89767945
> 3         -76.88397       3.6160872 BanRot          AUDCLO       OBS89769896
> 4         -77.51667       5.5166667 BanRot            AMNH       Skin-123476
> 5         -76.03337       4.8666900 BanRot            LACM             34848
> 6         -78.43333       1.4333333 BanRot           LSUMZ             38939
> 7         -78.55000       0.9500000 BanRot            ANSP            182799
> 8         -79.21389       0.4719444 BanRot          AUDCLO       OBS58485973
> 9         -78.51036       0.8953493 BanRot          AUDCLO       OBS84822747
> 10        -78.37810       1.5102800 BanRot          AUDCLO       OBS67916517
> 11        -75.15000       7.0700000 BanRot   8110002317-09         4743-5160
>
>>
> SpatialPointsDataFrame(coords=splisttemp[,c("DecimalLongitude","DecimalLatitude")],data=splisttemp[,c("SpAbbr","InstitutionCode","CatalogNumberText")],proj4string=CRS("+proj=longlat
> +datum=WGS84"))->tempshp
>> tempshp
>            coordinates SpAbbr InstitutionCode CatalogNumberText
> 1   (-76.8727, 3.66282) BanRot       EBIRD_COL       OBS81997559
> 2   (-76.9749, 3.71683) BanRot          AUDCLO       OBS89767945
> 3    (-76.884, 3.61609) BanRot          AUDCLO       OBS89769896
> 4   (-77.5167, 5.51667) BanRot            AMNH       Skin-123476
> 5   (-76.0334, 4.86669) BanRot            LACM             34848
> 6   (-78.4333, 1.43333) BanRot           LSUMZ             38939
> 7        (-78.55, 0.95) BanRot            ANSP            182799
> 8  (-79.2139, 0.471944) BanRot          AUDCLO       OBS58485973
> 9  (-78.5104, 0.895349) BanRot          AUDCLO       OBS84822747
> 10  (-78.3781, 1.51028) BanRot          AUDCLO       OBS67916517
> 11       (-75.15, 7.07) BanRot   8110002317-09         4743-5160
>
> Thanks for your help!
>
> -Pascal
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Thu Sep  8 23:56:31 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 8 Sep 2011 23:56:31 +0200 (CEST)
Subject: [R-sig-Geo] rgeos 'union' causes R crash
In-Reply-To: <CAC28k7Tq7Fce6qO7tF1xSHYf4adGyL5+_MqNX1eQW+_aeZajoQ@mail.gmail.com>
References: <CAC28k7TxJjLduE8jjCE5g7xgNa+0ZeND2vSxL36_FA0zunGMPw@mail.gmail.com>
	<CAC28k7TOOOYhVbue9VLhqKuq98RRdFEe9UaHGVo-KDO8GfUdYA@mail.gmail.com>
	<CAC28k7SxebmSd44cLZ50Ta0iWQgUQyqszz-0ixaDXE4AA0ONSw@mail.gmail.com>
	<CAC28k7T88VNLFSD8WJKHNka6joOsCPzCSwtDyzjn6J436CHmcA@mail.gmail.com>
	<D1AD22B2-A637-4252-A531-CB3D12B5C7B5@gmail.com>
	<CAC28k7SwMffz8G7FQeu60grbPkSSz3qk5uTj+4Ae_VcmJod_5g@mail.gmail.com>
	<CAC28k7Tq7Fce6qO7tF1xSHYf4adGyL5+_MqNX1eQW+_aeZajoQ@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1109082340470.3517@reclus.nhh.no>

On Thu, 8 Sep 2011, Ben Weinstein wrote:

> Thanks for taking the time to respond. Quick followup. I looked at my task
> manager, and although i do see a decent spike in CPU usage, memory usage
> seems flat. Furthermore a call to memory.size() shows that each loop is
> using around 50mb of memory. I am using a pretty top machine which has
> 8gigs, and atleast 3gig are free during the run. The memory.limit() is the
> full 8 gigs, and is not capped, mem.limits() returns NA. During the run teh
> physical memory never goes past 30%.
>
> The script runs if you do 3 files, 10 files, but somewhere around 20 it
> becomes less dependable. I don't really follow, if it is able to do it once,
> and write it to a matrix, why is it taking more memory to loop? I've added
> gc() after my union step to try to ensure that the garbage sweep is
> happening. The updated code is shown below.
>
> More interestingly, there seems to be something about number of time within
> R this runs. So if the first time i run this, i take in 20 files, it works
> great. I can then go, remove everything, and rerun it for 19 files, and it
> will crash!

Ben,

If you can make a zip archive with the shapefiles available (as a link), 
then it will be possible to check.

You may also note that gCentroid() is available in rgeos, giving a 
centroid for all member external rings, and that in fact each Polygons 
object has a centroid recorded (taking the value of the centroid of the 
largest member polygon, so differing in multi-ring cases only). They are 
accessed by coordinates() of a SpatialPolygons object. This is of course 
not a solution, but once we get that far, the conversion to a PolySet 
object may be redundant.

Roger

>
> #load required libraries
> library(rgdal)
> library(PBSmapping)
> library(maptools)
> library(raster)
> library(rgeos)
> #Enter File Directory Below
> setwd("D:/Ben/R/Trochilidae")
> #List all shapefiles in that folder that are polygons
> a<-list.files(pattern='pl.shp$', full.names=FALSE)
> #create an output matrix to store polygon centroids
> output<-matrix(nrow=length(a),ncol=3)
> #name the output matrix columns
> colnames(output)<-c("Sci_Name","X_centroid","Y_centroid")
> create a for loop
> for(x in 1:length(a)){
> #remove the .shp from the file name, add it to the output matrix
> output[(x),1]<-paste(gsub(".shp","",a[x]))
> #read in a single shapefile
> range<-readShapePoly(a[x], delete_null_obj=TRUE)
> #subset the data for Presence and Origin (species are NOT extinct, and
> breeding ranges only)
> subsetx<-range[range$PRESENCE == 1,]
> rm(range)
> subsetx2<-subsetx[subsetx$ORIGIN ==1|subsetx$ORIGIN==2,]
> rm(subsetx)
> #dissolve the polygons to make one big file, this is the problematic step
> Union<-unionSpatialPolygons(subsetx2,IDs=subsetx2$ENGL_NAME)
> gc()
> #Change data types
> Breeding.ps<- SpatialPolygons2PolySet(Union)
> rm(Union)
> #find the centroids of the new polygons
> Breeding.centroids<- calcCentroid(Breeding.ps, rollup=1)
> rm(Breeding.ps)
> output[x,2:3]<-as.matrix(Breeding.centroids[2:3])}
>
> thanks
>
> I appreciate the help
>
> ben
>
>
> On Wed, Sep 7, 2011 at 4:34 PM, Colin Rundel <rundel at gmail.com> wrote:
>
>> Hi Ben,
>>
>> My best guess based on the information you have provided is that R is
>> running out of memory, particularly for complex polygons Unions can use a
>> huge amount of memory. Can you check with the task manager what the memory
>> usage looks like when running your code?
>>
>> -Colin
>>
>> On Sep 7, 2011, at 8:26 AM, Ben Weinstein wrote:
>>
>>> Hi all-
>>>
>>> I'm having an odd issue with the gUnion family of commands from the rgeos
>>> package. I'm importing a series of polygons (species) and trying to find
>> the
>>> centroid. Each species is only allowed one centroids, so i need to union
>> the
>>> multiple polygons. this code works great when run line by line. But when
>> run
>>> as an actual loop, but adding the {} at beginning and end, it gives me a
>>> runtime error. I have debugged it to the level that i know it is the
>> union
>>> polygon step. I am running R 2.13, and it was designed for 2.13.1, is
>> that
>>> really making the difference? When run, R completely freezes and windows
>>> shuts it down.
>>>
>>> library(rgdal)
>>> library(PBSmapping)
>>> library(maptools)
>>> library(raster)
>>> library(rgeos)
>>> #Enter File Directory Below
>>> setwd("D:/Ben/R/Trochilidae")
>>> #Pull in all shapefiles in that folder that are polygons
>>> a<-list.files(pattern='pl.shp$', full.names=FALSE)
>>> output<-matrix(nrow=length(a),ncol=3)
>>> colnames(output)<-c("Sci_Name","X_centroid","Y_centroid")
>>> for(x in 1:length(a)){
>>> output[(x),1]<-paste(gsub(".shp","",a[x]))
>>> range<-readShapePoly(a[x], delete_null_obj=TRUE)
>>> subsetx<-range[range$PRESENCE == 1,]
>>> subsetx2<-subsetx[subsetx$ORIGIN ==1|subsetx$ORIGIN==2,]
>>> z<-matrix(length(subsetx2),1, data=1)
>>> Union<-unionSpatialPolygons(subsetx2,z)
>>> Breeding.ps<- SpatialPolygons2PolySet(Union)
>>> Breeding.centroids<- calcCentroid(Breeding.ps, rollup=1)
>>> output[x,2:3]<-as.matrix(Breeding.centroids[2:3])}
>>>
>>> thanks
>>>
>>> ben weinstein
>>>
>>>
>>>
>>>
>>> --
>>> Ben Weinstein
>>> Graduate Student
>>> Ecology and Evolution
>>> Stony Brook University
>>>
>>>       [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>
>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From marcelino.delacruz at upm.es  Fri Sep  9 10:12:07 2011
From: marcelino.delacruz at upm.es (marcelino.delacruz at upm.es)
Date: Fri, 09 Sep 2011 09:12:07 +0100
Subject: [R-sig-Geo] Clustering 3D point
In-Reply-To: <CAHQmNyFRHYhGPAV+=EuOYk7UFRuBa+iEh2oGVDNXYa8BDDydQA@mail.gmail.com>
Message-ID: <BNpCIHVV.1315555927.6804780.marcelino.delacruz@upm.es>

Maybe I didn't undestand your question on my first answer.

If you want to cluster your points you may use standard functions in R.
For example:

#compute a spatial distance between points:
dspatial <- dist (cbind(utm_x,utm_y))

# compute a temporal distance between points:

dtemporal <- wathever function to compute temporal distances (I don't
work with temporal data so I don't know yet!)

# truncate spatial distance matrix to work with distnaces less than 3 Km

dspatial.l.3 <-dspatial
dspatial.l.3[dspatial.l.3 > 3] <- 99999 # or wathever other big number
plot(hclust(dspatial.l.3, method = "single"))

# these are the clusters of points within 3 km from each other:
cutree(hclust(dspatial.l.3, method = "single"),h=3)

# truncate temporal distance matrix to work with distances less than 14
days

dtemporal.l.14 <- dtemporal
dtemporal.l.14[dtemporal.l.14 >14] <- 99999
dtemporal.l.14[dtemporal.l.14 <=14] <- 0


# sum spatial and teporal distances:
dspatiotemporal <- dspatial.l.3 + dtemporal.l.14

# compute clusters that include points within 3 Km and which had
earthquakes within 14 days
plot(hclust(dspatiotemporal,"single"))
cutree(hclust(dspatiotemporal,"single"),h=3)



HTH,

MArcelino





Con fecha 8/9/2011, "Riccardo Gaeta" <riccardog79 at gmail.com> escribi?:

>I've a look at spatstat, I've found the new object "ppx" but no idea to how
>manipulate it. Also in the guide on CRAN they don't speak about cluster or
>grouping data in 3D, there is just a function that calculate the distance in
>3D, but I have as result a matrix like a "dist" object, and the problem
>remains the same.
>
>Thanks anyway!
>
>
>
>2011/9/8 Marcelino de la Cruz <marcelino.delacruz at upm.es>
>
>>  Hi,
>>
>> you may consider using package spatstat, that has some functions to deal
>> with  multi-dimensional space-time point pattern objects
>>
>>
>> Cheers,
>>
>> Marcelino
>>
>>
>> At 15:15 08/09/2011, Riccardo Gaeta wrote:
>>
>> Hi all,
>> it's my first time I write on this list.
>> I expose my problem quickly and (hope) clearly.
>>
>> 1) FIRST APPROACH:
>> I have some spatial points that are related to each other by some
>> spatial&temporal conditions. I have a dataframe that contains the couple of
>> points in relation. For example:
>>
>> col1 ; col2
>> A       B
>> B       C
>> B       D
>> E       D
>>
>> I've obtained this list of couples by creating some "dist" object and
>> searching correspondence between them.
>> This list of couples means that: A is relate to B, B is relate to C and to
>> D, E is relate to D.
>> I would like to write a script that create a vector in which I have: A B C
>> D
>> E recognized as a unique group.
>> I've tried some "for loop" but I'm wondering if maybe there is a more
>> conventional function.
>>
>> 2) SECOND APPROACH:
>> In particularly I'm working on seismological data, and I'm studying a way
>> to
>> recognize seismic sequences, so to elaborate space-time cluster on my data.
>> I have 2D spatial points with indication of time of occurrence of the
>> seism,
>> and I would like to clusterize them with concern about these "3
>> dimensions":
>> coordinates x-y and time. I've successful used DBSCAN for space-clustering,
>> but it supports (I suppose) only 2 dimensions.
>>
>> I give you at the end of the mail more details in case you would like to
>> help me.
>>
>>
>> Thanks very much for any help,
>> Riccardo
>>
>>
>> ********************
>>
>> My "3D" spatial-temporal points:
>>
>>     utm_x  utm_y  date
>> 1  100000 4200 <callto:000 4200>000 "2008-06-17 04:12:27 CEST"
>> 2  155000 4250 <callto:000 4250>000 "2008-10-15 09:06:43 CEST"
>> 3  277000 4750 <callto:000 4750>000 "2010-10-25 22:50:42 CEST"
>>
>> ...(5600 points)
>>
>> My criterion to build cluster:
>> a- points within 3km of distance from each other
>> b- earthquakes happened within 14 days (2 weeks) from each other
>>
>> **
>>         ** [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>>  https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> **
>>
>> ** ____________________________________
>>
>> Marcelino de la Cruz Rot
>> Depto. Biologia Vegetal
>> EUIT Agricola
>> Universidad Politecnica de Madrid
>>
>> tel: 34 + 913365435
>> ____________________________________
>>


From clement.calenge at oncfs.gouv.fr  Fri Sep  9 10:35:36 2011
From: clement.calenge at oncfs.gouv.fr (Clement Calenge)
Date: Fri, 9 Sep 2011 10:35:36 +0200
Subject: [R-sig-Geo] placing spdf back into adehabiatHR estUDm
In-Reply-To: <1315511622963-6773497.post@n2.nabble.com>
References: <1308601895714-6497315.post@n2.nabble.com>	<4E0AD902.30108@oncfs.gouv.fr>	<1312913036614-6669114.post@n2.nabble.com>
	<1315511622963-6773497.post@n2.nabble.com>
Message-ID: <4E69CFD8.9040405@oncfs.gouv.fr>

Dear Antony,

You are right, there is indeed a problem with the object estUDm returned 
by the function BRB. As you rightly noted, each estUD object has a full 
listing of the D values from all animals (which does not impair the use 
of other functions, but indeed need to be corrected), and the estUD 
objects are not named (which does impair the use of this object in other 
functions, e.g. getverticeshr). For the last bug, as you noted, an easy 
workaround consists in manually defining these names (I will correct 
this bug ASAP). Many thanks for reporting.

Now, concerning your "clipping problem".

> ## Note that Brock and Calou, the UD have sharp limits
> ###ASF### Yes I see this.

This is because the extent of the grid is to small, compared with the 
size of the UD (or maybe your smoothing parameters are too large). In 
your example, the map contained in puechabonsp is too small and does not 
encompass all possible locations where the animals may have moved, given 
the diffusion and smoothing parameters that you defined. Another map, 
larger, would therefore be required. Note that if your aim is just to 
calculate home range contours, you do not need to use this map: you 
should define another grid with a larger extent, and then  (see the 
parameters grid and extent on the help page of BRB). If your aim is to 
measure the use intensity in each pixel of the habitat map, then you do 
not need home ranges limits.


> ###ASF### [2011 August 05]: Questions for ClementCalenge:
> ###ASF### ???? How can we extract home-range contours now that the home
> range estimates are of class SpatialPixelsDataFrame?

The class estUDm is simply a list of objects of class estUD. And an 
object of class estUD is simply a SpatialPixelsDataFrame with additional 
slots h (a list of two specifying how h is computed) and vol. Therefore, 
the following should work, using your objects:

fullgrid(udspdf) <- FALSE
re <- lapply(1:ncol(udspdf), function(i) {
     so <- new("estUD", udspdf[,i])
     so at h <- list(h=0, meth="specified") # fake value
     so at vol <- FALSE
     return(so)
})
names(re) <- names(udspdf)
class(re) <- "estUDm"

image(re)

## and find the contours
ver <- getverticeshr(re, standardize=TRUE)
plot(ver)


HTH,

Cl?ment Calenge

-- 
Cl?ment CALENGE
Cellule d'appui ? l'analyse de donn?es
Direction des Etudes et de la Recherche
Office national de la chasse et de la faune sauvage
Saint Benoist - 78610 Auffargis
tel. (33) 01.30.46.54.14


From educheyne at avia-gis.be  Fri Sep  9 12:45:28 2011
From: educheyne at avia-gis.be (Els Ducheyne)
Date: Fri, 9 Sep 2011 12:45:28 +0200
Subject: [R-sig-Geo] Calc function on a stack slow?
Message-ID: <5AFB8CA9-5310-4D42-AC7B-279EFF54A041@avia-gis.be>

Dear r-sig-geo list
I have a number of rasters with dim =  that I need to convert from Kelvin to Celsius. I though that stacking the layers and then perform a calculate would be the rrick. While this works, it is quite slow, so i wonder if there are faster ways in R to do this?

See below for code

Thanks for help

 R.Version()
$platform
[1] "i386-apple-darwin9.8.0"

$arch
[1] "i386"

$os
[1] "darwin9.8.0"

$system
[1] "i386, darwin9.8.0"

$status
[1] "Patched"

$major
[1] "2"

$minor
[1] "11.1"

$year
[1] "2010"

$month
[1] "08"

$day
[1] "30"

$`svn rev`
[1] "52862"

$language
[1] "R"

$version.string
[1] "R version 2.11.1 Patched (2010-08-30 r52862)"

and raster package 1.7-29

require(raster)
#get all the inputdata
start <- Sys.time()
inputlist <- list.files(pattern="lstday")
datadisplay <- seq(1,length(inputlist),16)
datadisplay <- c(datadisplay,length(inputlist))
n <- length(datadisplay)-1
for (i in 1:n){
input <- inputlist[datadisplay[i]:datadisplay[i+1]-1]
images <- stack(input)
images.celsius <- calc(images,fun=function(x){x - 273.15})
plot(images.celsius, zlim=c(-20,80),asp=1)
hist(images.celsius,xlim=c(-20,80),n=100)
}
end <- Sys.time()
print(end-start)


From alexander.arpaci at boku.ac.at  Fri Sep  9 12:58:09 2011
From: alexander.arpaci at boku.ac.at (Alexander Arpaci)
Date: Fri, 09 Sep 2011 12:58:09 +0200
Subject: [R-sig-Geo] Antw:  Calc function on a stack slow?
Message-ID: <4E6A0D6102000003000230E9@gwia1.boku.ac.at>

The package snow contains a function beginCluster () which helps to use if possible multicores for calculation of larger raster sets. Otherwise the use of brick could be helpful to speed things up..
hth

alex


MSc. Alexander Arpaci
Assistant researcher

Department of Forest - and Soil Sciences
Institute of Silviculture
Tel. +43-1-47654-4081
e-mail: alexander.arpaci at boku.ac.at
www.wabo.boku.ac.at 
>>> Els Ducheyne  09.09.11 12.46 Uhr >>>
Dear r-sig-geo list
I have a number of rasters with dim =  that I need to convert from Kelvin to Celsius. I though that stacking the layers and then perform a calculate would be the rrick. While this works, it is quite slow, so i wonder if there are faster ways in R to do this?

See below for code

Thanks for help

 R.Version()
$platform
[1] "i386-apple-darwin9.8.0"

$arch
[1] "i386"

$os
[1] "darwin9.8.0"

$system
[1] "i386, darwin9.8.0"

$status
[1] "Patched"

$major
[1] "2"

$minor
[1] "11.1"

$year
[1] "2010"

$month
[1] "08"

$day
[1] "30"

$`svn rev`
[1] "52862"

$language
[1] "R"

$version.string
[1] "R version 2.11.1 Patched (2010-08-30 r52862)"

and raster package 1.7-29

require(raster)
#get all the inputdata
start <- Sys.time()
inputlist <- list.files(pattern="lstday")
datadisplay <- seq(1,length(inputlist),16)
datadisplay <- c(datadisplay,length(inputlist))
n <- length(datadisplay)-1
for (i in 1:n){
input <- inputlist[datadisplay[i]:datadisplay[i+1]-1]
images <- stack(input)
images.celsius <- calc(images,fun=function(x){x - 273.15})
plot(images.celsius, zlim=c(-20,80),asp=1)
hist(images.celsius,xlim=c(-20,80),n=100)
}
end <- Sys.time()
print(end-start)

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From educheyne at avia-gis.be  Fri Sep  9 13:11:51 2011
From: educheyne at avia-gis.be (Els Ducheyne)
Date: Fri, 9 Sep 2011 13:11:51 +0200
Subject: [R-sig-Geo] Antw:  Calc function on a stack slow?
In-Reply-To: <4E6A0D6102000003000230E9@gwia1.boku.ac.at>
References: <4E6A0D6102000003000230E9@gwia1.boku.ac.at>
Message-ID: <AC056B63-CB8A-4D5D-A134-94CE53CB216B@avia-gis.be>

Dear Alex
thanks for this, I will try the cluster functionalities
For the Brick option - I assumed that this will result only in a single RasterLayer instead of a new brick?

Best
Els
On 9 Sep 2011, at 12:58, Alexander Arpaci wrote:

> The package snow contains a function beginCluster () which helps to use if possible multicores for calculation of larger raster sets. Otherwise the use of brick could be helpful to speed things up..
> hth
> 
> alex
> 
> 
> MSc. Alexander Arpaci
> Assistant researcher
> 
> Department of Forest - and Soil Sciences
> Institute of Silviculture
> Tel. +43-1-47654-4081
> e-mail: alexander.arpaci at boku.ac.at
> www.wabo.boku.ac.at 
>>>> Els Ducheyne  09.09.11 12.46 Uhr >>>
> Dear r-sig-geo list
> I have a number of rasters with dim =  that I need to convert from Kelvin to Celsius. I though that stacking the layers and then perform a calculate would be the rrick. While this works, it is quite slow, so i wonder if there are faster ways in R to do this?
> 
> See below for code
> 
> Thanks for help
> 
> R.Version()
> $platform
> [1] "i386-apple-darwin9.8.0"
> 
> $arch
> [1] "i386"
> 
> $os
> [1] "darwin9.8.0"
> 
> $system
> [1] "i386, darwin9.8.0"
> 
> $status
> [1] "Patched"
> 
> $major
> [1] "2"
> 
> $minor
> [1] "11.1"
> 
> $year
> [1] "2010"
> 
> $month
> [1] "08"
> 
> $day
> [1] "30"
> 
> $`svn rev`
> [1] "52862"
> 
> $language
> [1] "R"
> 
> $version.string
> [1] "R version 2.11.1 Patched (2010-08-30 r52862)"
> 
> and raster package 1.7-29
> 
> require(raster)
> #get all the inputdata
> start <- Sys.time()
> inputlist <- list.files(pattern="lstday")
> datadisplay <- seq(1,length(inputlist),16)
> datadisplay <- c(datadisplay,length(inputlist))
> n <- length(datadisplay)-1
> for (i in 1:n){
> input <- inputlist[datadisplay[i]:datadisplay[i+1]-1]
> images <- stack(input)
> images.celsius <- calc(images,fun=function(x){x - 273.15})
> plot(images.celsius, zlim=c(-20,80),asp=1)
> hist(images.celsius,xlim=c(-20,80),n=100)
> }
> end <- Sys.time()
> print(end-start)
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 


From johan.vandewauw at gmail.com  Fri Sep  9 13:33:57 2011
From: johan.vandewauw at gmail.com (Johan Van de Wauw)
Date: Fri, 9 Sep 2011 13:33:57 +0200
Subject: [R-sig-Geo] sp package seems to round my coordinates
In-Reply-To: <CAPSA=ydrf9E8DVfJWfp=t3zokPtTVfyKbm+5V0fnZTM=zocWnQ@mail.gmail.com>
References: <CAPSA=ydrf9E8DVfJWfp=t3zokPtTVfyKbm+5V0fnZTM=zocWnQ@mail.gmail.com>
Message-ID: <CAJOp35n6t_B2QWxEKqNhjExHnHt8FEL5nyAhPYp0m58w2qMYeA@mail.gmail.com>

On Thu, Sep 8, 2011 at 10:53 PM, Pascal Title <pascaltitle at gmail.com> wrote:
> Hi
>
> This is problematic for me because later on I
> will be using these coordinates to match them with the original records in
> order to retrieve other information.

Since no-one else noted this: this is a bad practice. It is much safer
to add one key integer column throughout your analysis. The code to
link one column is easier than linking two columns, you can adjust a
coordinate should it be needed, you can handle overlapping points and
if you save your data/open in other software you are much more sure
that you can still link it.

Johan


From alexander.arpaci at boku.ac.at  Fri Sep  9 13:40:54 2011
From: alexander.arpaci at boku.ac.at (Alexander Arpaci)
Date: Fri, 09 Sep 2011 13:40:54 +0200
Subject: [R-sig-Geo] Antw: Re: Antw:  Calc function on a stack slow?
Message-ID: <4E6A176602000003000230F9@gwia1.boku.ac.at>

The brick option will give you back a raster brick again 
if understand correct what you want to do..

r <- raster(ncol=10, nrow=10)
r[]=1:ncell(r)
s <- brick(r,r,r,r,r,r)

rs2 <- calc(s, fun=function(x){x * 10})
class(rs2)
cheers 

ales


MSc. Alexander Arpaci
Assistant researcher

Department of Forest - and Soil Sciences
Institute of Silviculture
Tel. +43-1-47654-4081
e-mail: alexander.arpaci at boku.ac.at
www.wabo.boku.ac.at 
>>> Els Ducheyne  09.09.11 13.12 Uhr >>>
Dear Alex
thanks for this, I will try the cluster functionalities
For the Brick option - I assumed that this will result only in a single RasterLayer instead of a new brick?

Best
Els
On 9 Sep 2011, at 12:58, Alexander Arpaci wrote:

> The package snow contains a function beginCluster () which helps to use if possible multicores for calculation of larger raster sets. Otherwise the use of brick could be helpful to speed things up..
> hth
> 
> alex
> 
> 
> MSc. Alexander Arpaci
> Assistant researcher
> 
> Department of Forest - and Soil Sciences
> Institute of Silviculture
> Tel. +43-1-47654-4081
> e-mail: alexander.arpaci at boku.ac.at
> www.wabo.boku.ac.at 
>>>> Els Ducheyne  09.09.11 12.46 Uhr >>>
> Dear r-sig-geo list
> I have a number of rasters with dim =  that I need to convert from Kelvin to Celsius. I though that stacking the layers and then perform a calculate would be the rrick. While this works, it is quite slow, so i wonder if there are faster ways in R to do this?
> 
> See below for code
> 
> Thanks for help
> 
> R.Version()
> $platform
> [1] "i386-apple-darwin9.8.0"
> 
> $arch
> [1] "i386"
> 
> $os
> [1] "darwin9.8.0"
> 
> $system
> [1] "i386, darwin9.8.0"
> 
> $status
> [1] "Patched"
> 
> $major
> [1] "2"
> 
> $minor
> [1] "11.1"
> 
> $year
> [1] "2010"
> 
> $month
> [1] "08"
> 
> $day
> [1] "30"
> 
> $`svn rev`
> [1] "52862"
> 
> $language
> [1] "R"
> 
> $version.string
> [1] "R version 2.11.1 Patched (2010-08-30 r52862)"
> 
> and raster package 1.7-29
> 
> require(raster)
> #get all the inputdata
> start <- Sys.time()
> inputlist <- list.files(pattern="lstday")
> datadisplay <- seq(1,length(inputlist),16)
> datadisplay <- c(datadisplay,length(inputlist))
> n <- length(datadisplay)-1
> for (i in 1:n){
> input <- inputlist[datadisplay[i]:datadisplay[i+1]-1]
> images <- stack(input)
> images.celsius <- calc(images,fun=function(x){x - 273.15})
> plot(images.celsius, zlim=c(-20,80),asp=1)
> hist(images.celsius,xlim=c(-20,80),n=100)
> }
> end <- Sys.time()
> print(end-start)
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 


From educheyne at avia-gis.be  Fri Sep  9 14:25:53 2011
From: educheyne at avia-gis.be (Els Ducheyne)
Date: Fri, 9 Sep 2011 14:25:53 +0200
Subject: [R-sig-Geo] Antw: Re: Antw:  Calc function on a stack slow?
In-Reply-To: <4E6A176602000003000230F9@gwia1.boku.ac.at>
References: <4E6A176602000003000230F9@gwia1.boku.ac.at>
Message-ID: <1BDB4815-9C18-494C-B868-3F77B07CD532@avia-gis.be>

Dear Alex
thanks for your reply - just something that I have noted
If I do :
>> input <- inputlist[datadisplay[i]:datadisplay[i+1]-1]
>> images <- brick(input)
>> images.celsius <- calc(images,fun=function(x){x - 273.15})
The class of images.celsius is a RasterLayer
On the other hand when I do the following:
>> input <- inputlist[datadisplay[i]:datadisplay[i+1]-1]
>> images <- brick(stack(input))
>> images.celsius <- calc(images,fun=function(x){x - 273.15})
ie. first make a stack, then a brick, the end result is a brick

any clues why? Nevertheless, I am now capable of processing the data in a more reasonable time using the brick option

Best
Els


On 9 Sep 2011, at 13:40, Alexander Arpaci wrote:

> The brick option will give you back a raster brick again 
> if understand correct what you want to do..
> 
> r <- raster(ncol=10, nrow=10)
> r[]=1:ncell(r)
> s <- brick(r,r,r,r,r,r)
> 
> rs2 <- calc(s, fun=function(x){x * 10})
> class(rs2)
> cheers 
> 
> ales
> 
> 
> MSc. Alexander Arpaci
> Assistant researcher
> 
> Department of Forest - and Soil Sciences
> Institute of Silviculture
> Tel. +43-1-47654-4081
> e-mail: alexander.arpaci at boku.ac.at
> www.wabo.boku.ac.at 
>>>> Els Ducheyne  09.09.11 13.12 Uhr >>>
> Dear Alex
> thanks for this, I will try the cluster functionalities
> For the Brick option - I assumed that this will result only in a single RasterLayer instead of a new brick?
> 
> Best
> Els
> On 9 Sep 2011, at 12:58, Alexander Arpaci wrote:
> 
>> The package snow contains a function beginCluster () which helps to use if possible multicores for calculation of larger raster sets. Otherwise the use of brick could be helpful to speed things up..
>> hth
>> 
>> alex
>> 
>> 
>> MSc. Alexander Arpaci
>> Assistant researcher
>> 
>> Department of Forest - and Soil Sciences
>> Institute of Silviculture
>> Tel. +43-1-47654-4081
>> e-mail: alexander.arpaci at boku.ac.at
>> www.wabo.boku.ac.at 
>>>>> Els Ducheyne  09.09.11 12.46 Uhr >>>
>> Dear r-sig-geo list
>> I have a number of rasters with dim =  that I need to convert from Kelvin to Celsius. I though that stacking the layers and then perform a calculate would be the rrick. While this works, it is quite slow, so i wonder if there are faster ways in R to do this?
>> 
>> See below for code
>> 
>> Thanks for help
>> 
>> R.Version()
>> $platform
>> [1] "i386-apple-darwin9.8.0"
>> 
>> $arch
>> [1] "i386"
>> 
>> $os
>> [1] "darwin9.8.0"
>> 
>> $system
>> [1] "i386, darwin9.8.0"
>> 
>> $status
>> [1] "Patched"
>> 
>> $major
>> [1] "2"
>> 
>> $minor
>> [1] "11.1"
>> 
>> $year
>> [1] "2010"
>> 
>> $month
>> [1] "08"
>> 
>> $day
>> [1] "30"
>> 
>> $`svn rev`
>> [1] "52862"
>> 
>> $language
>> [1] "R"
>> 
>> $version.string
>> [1] "R version 2.11.1 Patched (2010-08-30 r52862)"
>> 
>> and raster package 1.7-29
>> 
>> require(raster)
>> #get all the inputdata
>> start <- Sys.time()
>> inputlist <- list.files(pattern="lstday")
>> datadisplay <- seq(1,length(inputlist),16)
>> datadisplay <- c(datadisplay,length(inputlist))
>> n <- length(datadisplay)-1
>> for (i in 1:n){
>> input <- inputlist[datadisplay[i]:datadisplay[i+1]-1]
>> images <- stack(input)
>> images.celsius <- calc(images,fun=function(x){x - 273.15})
>> plot(images.celsius, zlim=c(-20,80),asp=1)
>> hist(images.celsius,xlim=c(-20,80),n=100)
>> }
>> end <- Sys.time()
>> print(end-start)
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
> 
> 
> 


From riccardog79 at gmail.com  Fri Sep  9 15:43:15 2011
From: riccardog79 at gmail.com (Riccardo Gaeta)
Date: Fri, 9 Sep 2011 15:43:15 +0200
Subject: [R-sig-Geo] Clustering 3D point
In-Reply-To: <BNpCIHVV.1315555927.6804780.marcelino.delacruz@upm.es>
References: <CAHQmNyFRHYhGPAV+=EuOYk7UFRuBa+iEh2oGVDNXYa8BDDydQA@mail.gmail.com>
	<BNpCIHVV.1315555927.6804780.marcelino.delacruz@upm.es>
Message-ID: <CAHQmNyFL0gj5667jCGLoDQ+eMcWc402xtQGmP5AHRRhE-RWK-g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110909/be6c6035/attachment.pl>

From tewksjj at uw.edu  Fri Sep  9 16:04:39 2011
From: tewksjj at uw.edu (Josh Tewksbury)
Date: Fri, 9 Sep 2011 07:04:39 -0700
Subject: [R-sig-Geo] grid overlay
Message-ID: <CAK87KAsp54L_BJzy4+-PzJkHkoj2gWi_NH8vqGSJbXi+M=6Veg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110909/952c1fce/attachment.pl>

From tewksjj at gmail.com  Fri Sep  9 18:16:16 2011
From: tewksjj at gmail.com (Josh Tewksbury)
Date: Fri, 9 Sep 2011 09:16:16 -0700
Subject: [R-sig-Geo] grid overlay
In-Reply-To: <CAK87KAsp54L_BJzy4+-PzJkHkoj2gWi_NH8vqGSJbXi+M=6Veg@mail.gmail.com>
References: <CAK87KAsp54L_BJzy4+-PzJkHkoj2gWi_NH8vqGSJbXi+M=6Veg@mail.gmail.com>
Message-ID: <CAK87KAtcrO8qbLoKNzX6SRddWor_qkz3s7xDRRX077K9Yhmp1A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110909/0bf3bd84/attachment.pl>

From rdbriscoe at ucdavis.edu  Fri Sep  9 22:31:33 2011
From: rdbriscoe at ucdavis.edu (Ryan Briscoe Runquist)
Date: Fri, 9 Sep 2011 13:31:33 -0700
Subject: [R-sig-Geo] Area of overlap between 2 polygons
Message-ID: <CAP7EohZLGhO+Bz6Ua_TtopNPy0b2AtbNue-ExBZk1UNJK8RM+g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110909/c24bd582/attachment.pl>

From afischbach at usgs.gov  Sat Sep 10 00:16:52 2011
From: afischbach at usgs.gov (Anthony Fischbach)
Date: Fri, 9 Sep 2011 15:16:52 -0700 (PDT)
Subject: [R-sig-Geo] placing spdf back into adehabiatHR estUDm
In-Reply-To: <4E69CFD8.9040405@oncfs.gouv.fr>
References: <1308601895714-6497315.post@n2.nabble.com>
	<4E0AD902.30108@oncfs.gouv.fr>
	<1312913036614-6669114.post@n2.nabble.com>
	<1315511622963-6773497.post@n2.nabble.com>
	<4E69CFD8.9040405@oncfs.gouv.fr>
Message-ID: <1315606612768-6777535.post@n2.nabble.com>

Wonderful!  I am so grateful to all that make this forum so rewarding.
Here is an example plot with walrus foraging behavior tracking data
(each red point is a daily walrus location, the kernel is weighted by daily
hours spent foraging, 
50th and 95th percentiles contour polygons are plotted as well as the
coastline.)
http://r-sig-geo.2731867.n2.nabble.com/file/n6777535/BRB06_All.png 
This method clearly defines the centers of foraging activity as well as
diffuse utilization regions.

-----
Tony Fischbach, Wildlife Biologist
Walrus Research Program
Alaska Science Center
U.S. Geological Survey
4210 University Drive
Anchorage, AK 99508-4650

AFischbach at usgs.gov
http://alaska.usgs.gov/science/biology/walrus
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Walruses-and-adehabitatHR-class-estUDm-exclusion-of-non-habitat-pixels-and-summary-over-all-animals-tp6497315p6777535.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From amorenos1 at ucentral.edu.co  Sat Sep 10 00:28:26 2011
From: amorenos1 at ucentral.edu.co (Angelo Moreno)
Date: Fri, 9 Sep 2011 15:28:26 -0700 (PDT)
Subject: [R-sig-Geo] Save GoogleVis Flash results
Message-ID: <1315607306924-6777557.post@n2.nabble.com>

Hi,I would like to save the results that I have with GoogleVis
Package(motioncharts,geomaps etc..),these results are in Flash format
online.May be somebody knows some way to  save them? 

Thanks 

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Save-GoogleVis-Flash-results-tp6777557p6777557.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From r.turner at auckland.ac.nz  Sat Sep 10 01:14:35 2011
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Sat, 10 Sep 2011 11:14:35 +1200
Subject: [R-sig-Geo] Area of overlap between 2 polygons
In-Reply-To: <CAP7EohZLGhO+Bz6Ua_TtopNPy0b2AtbNue-ExBZk1UNJK8RM+g@mail.gmail.com>
References: <CAP7EohZLGhO+Bz6Ua_TtopNPy0b2AtbNue-ExBZk1UNJK8RM+g@mail.gmail.com>
Message-ID: <4E6A9DDB.7010203@auckland.ac.nz>

On 10/09/11 08:31, Ryan Briscoe Runquist wrote:
> Dear All,
>
> I am new to spatial analysis in R, and I wanted to know if anyone could help
> me.  I am interested in finding the area of overlap between the ranges of 2
> species.  I have downloaded herbarium record data for a genus of plants that
> includes species names and the lat/long coordinates of the record.  I would
> like to be able to compute:
> the minimum convex polygon for each species (I have been able to do this
> with earth.poly{fossil}),
> the area of that polygon (also obtainable through earth.poly{fossil}),
> and the centroid coordinate of the polygon.
>
> I would then like to take these polygons and determine the pairwise area of
> overlap between all species combination and the distance between centroids.
> I have not been able to find a function that will help me do this.  Is there
> a function for this type of analysis and what class of data do I need to
> make this work.  Thank you in advance for any assistance.

The undocumented functions overlap.owin() and overlap.xypolygon()
in the "spatstat" package should do what you want.

     cheers,

         Rolf Turner


From tim.appelhans at gmail.com  Sat Sep 10 08:52:17 2011
From: tim.appelhans at gmail.com (Tim Appelhans)
Date: Sat, 10 Sep 2011 09:52:17 +0300
Subject: [R-sig-Geo] Save GoogleVis Flash results
In-Reply-To: <1315607306924-6777557.post@n2.nabble.com>
References: <1315607306924-6777557.post@n2.nabble.com>
Message-ID: <4E6B0921.2070702@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110910/e49be082/attachment.pl>

From tom.gottfried at tum.de  Mon Sep 12 09:24:32 2011
From: tom.gottfried at tum.de (Tom Gottfried)
Date: Mon, 12 Sep 2011 09:24:32 +0200
Subject: [R-sig-Geo] grid overlay
In-Reply-To: <CAK87KAtcrO8qbLoKNzX6SRddWor_qkz3s7xDRRX077K9Yhmp1A@mail.gmail.com>
References: <CAK87KAsp54L_BJzy4+-PzJkHkoj2gWi_NH8vqGSJbXi+M=6Veg@mail.gmail.com>
	<CAK87KAtcrO8qbLoKNzX6SRddWor_qkz3s7xDRRX077K9Yhmp1A@mail.gmail.com>
Message-ID: <4E6DB3B0.8020300@tum.de>

Hi Josh,

Am 09.09.2011 18:16, schrieb Josh Tewksbury:
> Hello - I am new to spatial stats in r.
>
> two lat long grids, one with higher grain, attempting to coerce the course
> grid into #the fine grid through an overlay process.
>
> here is some sample code
>
> x<-c(1,1.5,2,2.5,3,3.5,4,4.5,5.5)
> latA<-rep(x,each=9)
> y<-c(80,81,82,83,84,85,86,87,88)
> lonA<-rep(y,9)
> gridA<-cbind(latA,lonA)
> gridA<-data.frame(gridA)
>

Have a look at ?expand.grid to see how you can get that easier.

>>
>> #producing:
>> #>  gridA[1:12,]
>> #   latA lonA
>> #1   1.0   80
>> #2   1.0   81
>> #3   1.0   82
>> #4   1.0   83
>> #5   1.0   84
>> #6   1.0   85
>> #7   1.0   86
>> #8   1.0   87
>> #9   1.0   88
>> #10  1.5   80
>> #11  1.5   81
>> #12  1.5   82
>
>   x1<-c(1,2.6,4.2,5.8,7.4)
> latB<-rep(x1,each=5)
> y1<-c(80,82.1,84.2,86.3,88.4)
> lonB<-rep(y1,5)
> val_B<-sample(1:49,25,replace=F)
> gridB<-cbind(latB,lonB,val_B)
> gridB<-data.frame(gridB)
>
>>
>> #producing:
>> #>  gridB[1:12,]
>> #   latB lonB val_B
>> #1   1.0 80.0    40
>> #2   1.0 82.1     7
>> #3   1.0 84.2    19
>> #4   1.0 86.3    34
>> #5   1.0 88.4    36
>> #6   2.6 80.0    39
>> #7   2.6 82.1    38
>> #8   2.6 84.2    20
>> #9   2.6 86.3    29
>> #10  2.6 88.4     1
>> #11  4.2 80.0    22
>> #12  4.2 82.1     5
>> #etc....
>
> my objective is to add a column to gridA that contains the value from
> gridB$val_B that is closest in coordinates (lat and lon) to the coordinates
> in gridA
>
> my actual data is about 30,000 lines long, but the method should not change.
> I know there is an easy way to do this - is this in sp?

Yes it is:

library(sp)
coordinates(gridA) <- 1:2; gridded(gridA) <- TRUE; fullgrid(gridA) <- TRUE
coordinates(gridB) <- 1:2; gridded(gridB) <- TRUE; fullgrid(gridB) <- TRUE
gridA <- SpatialGridDataFrame(gridA, over(gridA, gridB))

But there might be more appropriate means in package raster.

Regards,
Tom

>
> thanks!
>
>
>> --
>> Joshua J. Tewksbury
>> Walker Professor of Natural History,
>> Department of Biology, University of Washington
>> 106 Kincaid Hall, Box 351800
>> Seattle WA 98195-1800
>> my lab and office are in 528 Kincaid Hall
>> cell phone 206/331-1893,
>> office phone: 206/616-2129
>> lab phone: 206/616-2132,
>> fax: 206/616-2011
>> website: http://faculty.washington.edu/tewksjj/index.html
>>
>> Please join the Natural History Network (
>> http://www.naturalhistorynetwork.org/)
>>
>>
>>
>>
>
>

-- 
Technische Universit?t M?nchen
Department f?r Pflanzenwissenschaften
Lehrstuhl f?r Gr?nlandlehre
Alte Akademie 12
85350 Freising / Germany
Phone: ++49 (0)8161 715324
Fax:   ++49 (0)8161 713243
email: tom.gottfried at wzw.tum.de
http://www.wzw.tum.de/gruenland


From Jan.Quets at ua.ac.be  Mon Sep 12 11:03:43 2011
From: Jan.Quets at ua.ac.be (Quets Jan)
Date: Mon, 12 Sep 2011 09:03:43 +0000
Subject: [R-sig-Geo] joining envelope objects for parallel computing.
	Possible?
Message-ID: <F7452FEC9FABCF4493C2DBB2E9DC31CE2C5D783B@xmail33.ad.ua.ac.be>

Hi,

is it possible to join several envelope (spatstat) objects into a single object?

The reason would be saving computation time with parallel computing.

example:

suppose I already have a list of 120 simulated patterns, called sim_pat_list. 

and suppose this is what I want:

ENV_OBJ = envelope(X,fun=pcf,simulate=sim_pat_list)


but suppose I have 12 cores available.

and that I split the list sim_pat_list into 10 lists, each comprising 12 patterns, and calculate herefrom 10 envelope objects:

ENV_OBJ_1 = envelope(X,fun=pcf,simulate=sim_pat_list1)
ENV_OBJ_2 = envelope(X,fun=pcf,simulate=sim_pat_list2)

ENV_OBJ_10 = envelope(X,fun=pcf,simulate=sim_pat_list10)


is it then possible to produce something like this (pseudo-code):

ENV_OBJ = join(ENV_OBJ_1, ENV_OBJ_2, ..., ENV_OBJ_10)

to get the same result?

Thank you,
Jan

From Adrian.Baddeley at csiro.au  Mon Sep 12 12:08:16 2011
From: Adrian.Baddeley at csiro.au (Adrian.Baddeley at csiro.au)
Date: Mon, 12 Sep 2011 18:08:16 +0800
Subject: [R-sig-Geo] joining envelope objects for parallel computing.
 Possible?
In-Reply-To: <mailman.5.1315821602.27141.r-sig-geo@r-project.org>
References: <mailman.5.1315821602.27141.r-sig-geo@r-project.org>
Message-ID: <57DC18C299094D4299F837570C5DF1C54E93BA36EE@EXWA-MBX01.nexus.csiro.au>

Quets Jan <Jan.Quets at ua.ac.be> wrote:

> is it possible to join several envelope (spatstat) objects into a single object?

This is not currently supported.
I will take that as a request for the next version of spatstat.

Adrian Baddeley


From marcelino.delacruz at upm.es  Mon Sep 12 12:11:40 2011
From: marcelino.delacruz at upm.es (Marcelino de la Cruz)
Date: Mon, 12 Sep 2011 12:11:40 +0200
Subject: [R-sig-Geo] joining envelope objects for parallel computing.
 Possible?
In-Reply-To: <F7452FEC9FABCF4493C2DBB2E9DC31CE2C5D783B@xmail33.ad.ua.ac.
 be>
References: <F7452FEC9FABCF4493C2DBB2E9DC31CE2C5D783B@xmail33.ad.ua.ac.be>
Message-ID: <201109121013.p8CAD3q6013022@smtp.upm.es>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110912/9031185f/attachment.pl>

From r.turner at auckland.ac.nz  Mon Sep 12 12:39:47 2011
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Mon, 12 Sep 2011 22:39:47 +1200
Subject: [R-sig-Geo] joining envelope objects for parallel computing.
 Possible?
In-Reply-To: <F7452FEC9FABCF4493C2DBB2E9DC31CE2C5D783B@xmail33.ad.ua.ac.be>
References: <F7452FEC9FABCF4493C2DBB2E9DC31CE2C5D783B@xmail33.ad.ua.ac.be>
Message-ID: <4E6DE173.2030400@auckland.ac.nz>

On 12/09/11 21:03, Quets Jan wrote:
> Hi,
>
> is it possible to join several envelope (spatstat) objects into a single object?

     See fortune("This is R")

     You could do it, I think, at the expense of writing a bit of additional
     code.  Something along the following lines:

     * For each of your calls to envelope, use the argument savefuns=TRUE.
     * From each of the ENV_OBJ_j, extract the "simfuns" attribute.
     * Change the class of each extracted "simfuns" attribute to 
"data.frame"
        (from c("fv","data.frame")), discard the "r" columns, and then cbind
        them all together; make the result into a *matrix* rather than a
        data frame.  Call it, say, "M".
     * apply the appropriate function across the rows of M, to obtain "lo"
        and "hi"; e.g.

             LH <- t(apply(M,1,function(x,m){x <- sort(x);  
c(x[m],x[length(x)-m+1])},m=5))

        The value "m=5" corresponds to setting "nrank=5" in a ``direct'' 
call to
        envelope().  The first column of LH is "lo"; the second is "hi".

     * These vectors, "lo" and "hi" are then the lower and upper bounds
        respectively of the required envelope.

     The foregoing can be wrapped up in a convenient function.
     Exercise for the reader! :-)

     HTH

         cheers,

             Rolf

P. S.  Not clear to me that this is worth doing; the time consuming part 
is the
simulation of the patterns, which you've already got in the 
"sim_pat_list".  Once
you have the patterns, calculating the summary functions is usually very 
fast,
and hence not worth parallelizing. Unless you have an extraordinarily 
complicated
setting.

             R.
> The reason would be saving computation time with parallel computing.
>
> example:
>
> suppose I already have a list of 120 simulated patterns, called sim_pat_list.
>
> and suppose this is what I want:
>
> ENV_OBJ = envelope(X,fun=pcf,simulate=sim_pat_list)
>
>
> but suppose I have 12 cores available.
>
> and that I split the list sim_pat_list into 10 lists, each comprising 12 patterns, and calculate herefrom 10 envelope objects:
>
> ENV_OBJ_1 = envelope(X,fun=pcf,simulate=sim_pat_list1)
> ENV_OBJ_2 = envelope(X,fun=pcf,simulate=sim_pat_list2)
>
> ENV_OBJ_10 = envelope(X,fun=pcf,simulate=sim_pat_list10)
>
>
> is it then possible to produce something like this (pseudo-code):
>
> ENV_OBJ = join(ENV_OBJ_1, ENV_OBJ_2, ..., ENV_OBJ_10)
>
> to get the same result?
>
> Thank you,
> Jan
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Jan.Quets at ua.ac.be  Mon Sep 12 13:59:30 2011
From: Jan.Quets at ua.ac.be (Quets Jan)
Date: Mon, 12 Sep 2011 11:59:30 +0000
Subject: [R-sig-Geo] joining envelope objects for parallel computing.
 Possible?
In-Reply-To: <4E6DE173.2030400@auckland.ac.nz>
References: <F7452FEC9FABCF4493C2DBB2E9DC31CE2C5D783B@xmail33.ad.ua.ac.be>,
	<4E6DE173.2030400@auckland.ac.nz>
Message-ID: <F7452FEC9FABCF4493C2DBB2E9DC31CE2C5D7877@xmail33.ad.ua.ac.be>

Thanks for the receiven ideas,

@Rolf:

the sim_pat_list I already managed to parallelize,

and indeed calculating summary functions is generally faster,
but in my case still takes up about 20% (or 2 hours) of the total time (about 10 hours) so far. 

However, I must say that most of the time is spend with the 

alltypes() function (for bivariate point patterns) and not so much with the envelope() function.


I'm hoping the received feedback is also applicable for alltypes(),

I will try,

Jan   




________________________________________
Van: Rolf Turner [r.turner at auckland.ac.nz]
Verzonden: maandag 12 september 2011 12:39
Aan: Quets Jan
CC: r-sig-geo at r-project.org
Onderwerp: Re: [R-sig-Geo] joining envelope objects for parallel computing. Possible?

On 12/09/11 21:03, Quets Jan wrote:
> Hi,
>
> is it possible to join several envelope (spatstat) objects into a single object?

     See fortune("This is R")

     You could do it, I think, at the expense of writing a bit of additional
     code.  Something along the following lines:

     * For each of your calls to envelope, use the argument savefuns=TRUE.
     * From each of the ENV_OBJ_j, extract the "simfuns" attribute.
     * Change the class of each extracted "simfuns" attribute to
"data.frame"
        (from c("fv","data.frame")), discard the "r" columns, and then cbind
        them all together; make the result into a *matrix* rather than a
        data frame.  Call it, say, "M".
     * apply the appropriate function across the rows of M, to obtain "lo"
        and "hi"; e.g.

             LH <- t(apply(M,1,function(x,m){x <- sort(x);
c(x[m],x[length(x)-m+1])},m=5))

        The value "m=5" corresponds to setting "nrank=5" in a ``direct''
call to
        envelope().  The first column of LH is "lo"; the second is "hi".

     * These vectors, "lo" and "hi" are then the lower and upper bounds
        respectively of the required envelope.

     The foregoing can be wrapped up in a convenient function.
     Exercise for the reader! :-)

     HTH

         cheers,

             Rolf

P. S.  Not clear to me that this is worth doing; the time consuming part
is the
simulation of the patterns, which you've already got in the
"sim_pat_list".  Once
you have the patterns, calculating the summary functions is usually very
fast,
and hence not worth parallelizing. Unless you have an extraordinarily
complicated
setting.

             R.
> The reason would be saving computation time with parallel computing.
>
> example:
>
> suppose I already have a list of 120 simulated patterns, called sim_pat_list.
>
> and suppose this is what I want:
>
> ENV_OBJ = envelope(X,fun=pcf,simulate=sim_pat_list)
>
>
> but suppose I have 12 cores available.
>
> and that I split the list sim_pat_list into 10 lists, each comprising 12 patterns, and calculate herefrom 10 envelope objects:
>
> ENV_OBJ_1 = envelope(X,fun=pcf,simulate=sim_pat_list1)
> ENV_OBJ_2 = envelope(X,fun=pcf,simulate=sim_pat_list2)
>
> ENV_OBJ_10 = envelope(X,fun=pcf,simulate=sim_pat_list10)
>
>
> is it then possible to produce something like this (pseudo-code):
>
> ENV_OBJ = join(ENV_OBJ_1, ENV_OBJ_2, ..., ENV_OBJ_10)
>
> to get the same result?
>
> Thank you,
> Jan
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From marcelino.delacruz at upm.es  Mon Sep 12 14:18:22 2011
From: marcelino.delacruz at upm.es (Marcelino de la Cruz)
Date: Mon, 12 Sep 2011 14:18:22 +0200
Subject: [R-sig-Geo] joining envelope objects for parallel computing.
 Possible?
In-Reply-To: <F7452FEC9FABCF4493C2DBB2E9DC31CE2C5D7877@xmail33.ad.ua.ac.
 be>
References: <F7452FEC9FABCF4493C2DBB2E9DC31CE2C5D783B@xmail33.ad.ua.ac.be>
	<4E6DE173.2030400@auckland.ac.nz>
	<F7452FEC9FABCF4493C2DBB2E9DC31CE2C5D7877@xmail33.ad.ua.ac.be>
Message-ID: <201109121219.p8CCJi24025519@smtp.upm.es>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110912/f9bcc611/attachment.pl>

From a.mosnier at gmail.com  Mon Sep 12 17:41:37 2011
From: a.mosnier at gmail.com (Arnaud Mosnier)
Date: Mon, 12 Sep 2011 11:41:37 -0400
Subject: [R-sig-Geo] Split function ?
Message-ID: <CANkFkEeO7Xt3vT3tBvP0_OmxQjXvWkHBJG=qG_zb0BhjXJG3nA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110912/a5d48e33/attachment.pl>

From joelrisso at gmail.com  Tue Sep 13 06:32:18 2011
From: joelrisso at gmail.com (Joel Risso)
Date: Tue, 13 Sep 2011 01:32:18 -0300
Subject: [R-sig-Geo] Convert some value to NaN (GeoTiff)
Message-ID: <CABz4_ftz3ZEiML8k-QCk3e8dfh0Yws3xLeyU632t8AiZLBenRw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110913/396e5bb6/attachment.pl>

From Changying.Shao at fish.wa.gov.au  Tue Sep 13 07:32:15 2011
From: Changying.Shao at fish.wa.gov.au (Changying Shao)
Date: Tue, 13 Sep 2011 05:32:15 +0000
Subject: [R-sig-Geo]  Date in Poisson GLM?
In-Reply-To: <CANkFkEeO7Xt3vT3tBvP0_OmxQjXvWkHBJG=qG_zb0BhjXJG3nA@mail.gmail.com>
Message-ID: <E5900715EAC7D841898ADFD712708DFA1323F7@parrotfish12.fish.wa.gov.au>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110913/ba92d368/attachment.pl>

From Pilar.Tugores at ba.ieo.es  Tue Sep 13 10:59:30 2011
From: Pilar.Tugores at ba.ieo.es (Pilar Tugores Ferra)
Date: Tue, 13 Sep 2011 10:59:30 +0200
Subject: [R-sig-Geo] Doubt gstat fitting
Message-ID: <0838E01493845742A4D4039EA34EB1C1E116A5@ieopalma2.ba.ieo.es>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110913/148110b5/attachment.pl>

From educheyne at avia-gis.be  Tue Sep 13 11:10:28 2011
From: educheyne at avia-gis.be (Els Ducheyne)
Date: Tue, 13 Sep 2011 11:10:28 +0200
Subject: [R-sig-Geo] spplot for raster not drawn
Message-ID: <37732663-3C44-4B8B-8B7C-B5E1FB166AA7@avia-gis.be>

dear list
I want to display a time series of data using either spplot or levelplot to verify consistency in the raw images prior to processing (visual quality check)
to do this I am use spplot (or levelplot). This works up to 16 images, however if I want to see more I have to split the inputfiles and put them in  a loop. When the loop is executed, I can see the quartz window but the content is not shown. 
Does anyone have an idea how to solve this ?
See below for information on OS and versions + code

Thanks for help
Els


require(raster) #raster package = 1.9-5
require(rasterVis) #rasterVis = 0.10-4
setwd(outputdir)
#get all the inputdata
par(ask=T)
inputlist <- list.files(pattern="LSTDay")
datadisplay <- seq(1,length(inputlist),16)
datadisplay <- c(datadisplay,length(inputlist))
n <- length(datadisplay)-1
for (i in 1:n){
	input <- inputlist[datadisplay[i]:datadisplay[i+1]-1]
	images <- stack(inputlist)
	NAvalue(images)<-0
	#spplot(images,col.regions=terrain.colors(80)) # quartz is shown but remains empty
	levelplot(images,col.regions=terrain.colors(80)) # quartz is shown but remains empty
	hist(images,xlim=c(220*50,340*50),n=20) #histograms are displayed in quartz
}


$platform
[1] "i386-apple-darwin9.8.0"

$arch
[1] "i386"

$os
[1] "darwin9.8.0"

$system
[1] "i386, darwin9.8.0"

$status
[1] ""

$major
[1] "2"

$minor
[1] "13.1"

$year
[1] "2011"

$month
[1] "07"

$day
[1] "08"

$`svn rev`
[1] "56322"

$language
[1] "R"

$version.string
[1] "R version 2.13.1 (2011-07-08)"

From paul.hiemstra at knmi.nl  Tue Sep 13 11:18:46 2011
From: paul.hiemstra at knmi.nl (Paul Hiemstra)
Date: Tue, 13 Sep 2011 09:18:46 +0000
Subject: [R-sig-Geo] spplot for raster not drawn
In-Reply-To: <37732663-3C44-4B8B-8B7C-B5E1FB166AA7@avia-gis.be>
References: <37732663-3C44-4B8B-8B7C-B5E1FB166AA7@avia-gis.be>
Message-ID: <4E6F1FF6.9010203@knmi.nl>

 Use print on your levelplot command. This is in the R FAQ (7.22).

Paul

On 09/13/2011 09:10 AM, Els Ducheyne wrote:
> dear list
> I want to display a time series of data using either spplot or levelplot to verify consistency in the raw images prior to processing (visual quality check)
> to do this I am use spplot (or levelplot). This works up to 16 images, however if I want to see more I have to split the inputfiles and put them in  a loop. When the loop is executed, I can see the quartz window but the content is not shown. 
> Does anyone have an idea how to solve this ?
> See below for information on OS and versions + code
>
> Thanks for help
> Els
>
>
> require(raster) #raster package = 1.9-5
> require(rasterVis) #rasterVis = 0.10-4
> setwd(outputdir)
> #get all the inputdata
> par(ask=T)
> inputlist <- list.files(pattern="LSTDay")
> datadisplay <- seq(1,length(inputlist),16)
> datadisplay <- c(datadisplay,length(inputlist))
> n <- length(datadisplay)-1
> for (i in 1:n){
> 	input <- inputlist[datadisplay[i]:datadisplay[i+1]-1]
> 	images <- stack(inputlist)
> 	NAvalue(images)<-0
> 	#spplot(images,col.regions=terrain.colors(80)) # quartz is shown but remains empty
> 	levelplot(images,col.regions=terrain.colors(80)) # quartz is shown but remains empty
> 	hist(images,xlim=c(220*50,340*50),n=20) #histograms are displayed in quartz
> }
>
>
> $platform
> [1] "i386-apple-darwin9.8.0"
>
> $arch
> [1] "i386"
>
> $os
> [1] "darwin9.8.0"
>
> $system
> [1] "i386, darwin9.8.0"
>
> $status
> [1] ""
>
> $major
> [1] "2"
>
> $minor
> [1] "13.1"
>
> $year
> [1] "2011"
>
> $month
> [1] "07"
>
> $day
> [1] "08"
>
> $`svn rev`
> [1] "56322"
>
> $language
> [1] "R"
>
> $version.string
> [1] "R version 2.13.1 (2011-07-08)"
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


-- 
Paul Hiemstra, Ph.D.
Global Climate Division
Royal Netherlands Meteorological Institute (KNMI)
Wilhelminalaan 10 | 3732 GK | De Bilt | Kamer B 3.39
P.O. Box 201 | 3730 AE | De Bilt
tel: +31 30 2206 494

http://intamap.geo.uu.nl/~paul
http://nl.linkedin.com/pub/paul-hiemstra/20/30b/770


From educheyne at avia-gis.be  Tue Sep 13 11:22:22 2011
From: educheyne at avia-gis.be (Els Ducheyne)
Date: Tue, 13 Sep 2011 11:22:22 +0200
Subject: [R-sig-Geo] spplot for raster not drawn
In-Reply-To: <4E6F1FF6.9010203@knmi.nl>
References: <37732663-3C44-4B8B-8B7C-B5E1FB166AA7@avia-gis.be>
	<4E6F1FF6.9010203@knmi.nl>
Message-ID: <ACC552FF-FA5B-427C-9C2B-1F37CBB82B03@avia-gis.be>

Dear Paul
thanks for your help
Els
On 13 Sep 2011, at 11:18, Paul Hiemstra wrote:

> Use print on your levelplot command. This is in the R FAQ (7.22).
> 
> Paul
> 
> On 09/13/2011 09:10 AM, Els Ducheyne wrote:
>> dear list
>> I want to display a time series of data using either spplot or levelplot to verify consistency in the raw images prior to processing (visual quality check)
>> to do this I am use spplot (or levelplot). This works up to 16 images, however if I want to see more I have to split the inputfiles and put them in  a loop. When the loop is executed, I can see the quartz window but the content is not shown. 
>> Does anyone have an idea how to solve this ?
>> See below for information on OS and versions + code
>> 
>> Thanks for help
>> Els
>> 
>> 
>> require(raster) #raster package = 1.9-5
>> require(rasterVis) #rasterVis = 0.10-4
>> setwd(outputdir)
>> #get all the inputdata
>> par(ask=T)
>> inputlist <- list.files(pattern="LSTDay")
>> datadisplay <- seq(1,length(inputlist),16)
>> datadisplay <- c(datadisplay,length(inputlist))
>> n <- length(datadisplay)-1
>> for (i in 1:n){
>> 	input <- inputlist[datadisplay[i]:datadisplay[i+1]-1]
>> 	images <- stack(inputlist)
>> 	NAvalue(images)<-0
>> 	#spplot(images,col.regions=terrain.colors(80)) # quartz is shown but remains empty
>> 	levelplot(images,col.regions=terrain.colors(80)) # quartz is shown but remains empty
>> 	hist(images,xlim=c(220*50,340*50),n=20) #histograms are displayed in quartz
>> }
>> 
>> 
>> $platform
>> [1] "i386-apple-darwin9.8.0"
>> 
>> $arch
>> [1] "i386"
>> 
>> $os
>> [1] "darwin9.8.0"
>> 
>> $system
>> [1] "i386, darwin9.8.0"
>> 
>> $status
>> [1] ""
>> 
>> $major
>> [1] "2"
>> 
>> $minor
>> [1] "13.1"
>> 
>> $year
>> [1] "2011"
>> 
>> $month
>> [1] "07"
>> 
>> $day
>> [1] "08"
>> 
>> $`svn rev`
>> [1] "56322"
>> 
>> $language
>> [1] "R"
>> 
>> $version.string
>> [1] "R version 2.13.1 (2011-07-08)"
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 
> -- 
> Paul Hiemstra, Ph.D.
> Global Climate Division
> Royal Netherlands Meteorological Institute (KNMI)
> Wilhelminalaan 10 | 3732 GK | De Bilt | Kamer B 3.39
> P.O. Box 201 | 3730 AE | De Bilt
> tel: +31 30 2206 494
> 
> http://intamap.geo.uu.nl/~paul
> http://nl.linkedin.com/pub/paul-hiemstra/20/30b/770
> 


From alfreale74 at gmail.com  Tue Sep 13 11:51:49 2011
From: alfreale74 at gmail.com (alfreale)
Date: Tue, 13 Sep 2011 02:51:49 -0700 (PDT)
Subject: [R-sig-Geo] subs and the name of column
In-Reply-To: <1311043884878-6597311.post@n2.nabble.com>
References: <CA+GC7G4vg-65_AAhLr=zq3MwF6j4F-0TmEGqPVSFHhzPkdF6oA@mail.gmail.com>
	<1311043884878-6597311.post@n2.nabble.com>
Message-ID: <1315907509726-6786840.post@n2.nabble.com>

Hi,

I've tried with the names of the column but don't work:

> data_6SV_cluster
  cluster   intercept coefficient
1       1 -0.04436168    1.286019
2       2 -0.04415990    1.283883
3       3 -0.04414168    1.286019
4       4 -0.04375406    1.280874
5       5 -0.04400495    1.281942
6       6 -0.04390901    1.282816
> as.matrix(raster_cluster)
     [,1] [,2] [,3]
[1,]    1    2    3
[2,]    4    5    6
> colnames(data_6SV_cluster)
[1] "cluster"     "intercept"   "coefficient"
> subs(raster_cluster,data_6SV_cluster,which="coefficient")
Error in `[.data.frame`(y, , c(by, which)) : undefined columns selected
> subs(raster_cluster,data_6SV_cluster,which=3)
class       : RasterLayer 
dimensions  : 2, 3, 6  (nrow, ncol, ncell)
resolution  : 0.2678571, 0.2678571  (x, y)
extent      : 99.48661, 100.2902, 2.191965, 2.727679  (xmin, xmax, ymin,
ymax)
coord. ref. : +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs
+towgs84=0,0,0 
values      : in memory
min value   : 1.280874 
max value   : 1.286019 


Thanks,

Alfredo


--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/subs-and-the-name-of-column-tp6594997p6786840.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From m.fairbrother at bristol.ac.uk  Tue Sep 13 12:33:22 2011
From: m.fairbrother at bristol.ac.uk (Malcolm Fairbrother)
Date: Tue, 13 Sep 2011 11:33:22 +0100
Subject: [R-sig-Geo] import a jpg/etc. map into R?
Message-ID: <B1E10DB0-58C4-4D24-BBE7-9668423E8FD1@bristol.ac.uk>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110913/3c3c2158/attachment.pl>

From marcelino.delacruz at upm.es  Tue Sep 13 12:44:04 2011
From: marcelino.delacruz at upm.es (Marcelino de la Cruz)
Date: Tue, 13 Sep 2011 12:44:04 +0200
Subject: [R-sig-Geo] import a jpg/etc. map into R?
In-Reply-To: <B1E10DB0-58C4-4D24-BBE7-9668423E8FD1@bristol.ac.uk>
References: <B1E10DB0-58C4-4D24-BBE7-9668423E8FD1@bristol.ac.uk>
Message-ID: <201109131045.p8DAjTWA003904@smtp.upm.es>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110913/47d20619/attachment.pl>

From alexander.arpaci at boku.ac.at  Tue Sep 13 12:58:11 2011
From: alexander.arpaci at boku.ac.at (Alexander Arpaci)
Date: Tue, 13 Sep 2011 12:58:11 +0200
Subject: [R-sig-Geo] Antw: Re:  import a jpg/etc. map into R?
Message-ID: <4E6F536302000003000232FB@gwia1.boku.ac.at>

When I used to do something like this I used the georeferencing
funtionalities of ArcGis
You could try to fix the old spanish map with lat and long over a actual
map referencing to cities, rivers or ...

just a thought
hth
alex


MSc. Alexander Arpaci
Assistant researcher

Department of Forest - and Soil Sciences
Institute of Silviculture
Tel. +43-1-47654-4081
e-mail: alexander.arpaci at boku.ac.at
www.wabo.boku.ac.at 
>>> Marcelino de la Cruz  13.09.11 12.47 Uhr >>>
Hi Malcolm,

digitize package may be  a first try

http://finzi.psych.upenn.edu/R/library/digitize/html/00Index.html

HTH,

Marcelino


At 12:33 13/09/2011, Malcolm Fairbrother wrote:
>Content-Type: text/plain
>Content-Disposition: inline
>Content-length: 1508
>
>Dear all,
>
>The answer may well be 'no', but does anyone 
>know of a straightforward way to import into R a 
>map in the form of a simple jpeg (or bmp, gif, etc.) image file?
>
>I'm thinking of a situation where you have something like this:
>
>http://www.learnnc.org/lp/media/uploads/2007/09/1492spain.jpg
>
>or
>
>http://www.spainthenandnow.com/userimages/Spain%20General%20Map%20Wikimedia.png
>
>Latitude and longitude lines are given in the 
>image, and they should be usable for identifying 
>the geographical location of any given pixel, 
>but the projection of the map is not immediately 
>apparent, and the map is not in a vector format 
>where lines or polygons can be easily 
>identified. What I'd like to do is read in this 
>kind of file, have R find the edges (identified 
>somehow by differences in pixel colours I 
>guess), and convert the areas defined by those 
>edges into a SpatialPolygons object, with lat/long coordinates.
>
>There may well be no easy way to do this (or not 
>even a difficult way), but I thought I'd check 
>if anyone has any ideas. I prefer to use R, but 
>if some other (preferably open source) software 
>could help me, I'd be interested to know. Even 
>suggestions like "IF you could get it into X 
>format, THEN you could*" might be useful. I'm 
>not a GIS person, unfortunately. On the other 
>hand, I am pretty handy with R, and a regular 
>user of several of the maps/spatial/raster packages.
>
>Any help would be much appreciated.
>
>- Malcolm
>
>
>         [[alternative HTML version deleted]]
>
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo

____________________________________

Marcelino de la Cruz Rot
Depto. Biologia Vegetal
EUIT Agricola
Universidad Politecnica de Madrid

tel: 34 + 913365435
____________________________________  
    [[alternative HTML version deleted]]


From oscar.perpinan at upm.es  Tue Sep 13 13:01:30 2011
From: oscar.perpinan at upm.es (Oscar =?UTF-8?B?UGVycGnDsWFu?= Lamigueiro)
Date: Tue, 13 Sep 2011 13:01:30 +0200
Subject: [R-sig-Geo] spplot for raster not drawn
In-Reply-To: <4E6F1FF6.9010203@knmi.nl>
References: <37732663-3C44-4B8B-8B7C-B5E1FB166AA7@avia-gis.be>
	<4E6F1FF6.9010203@knmi.nl>
Message-ID: <20110913130130.30acee7c@OPL-EUITI>

Hi,

Another approach is to use the layout argument of levelplot. 

As an example, I use the data from Cressie and Wikle, following the
superb Edzer Pebesma's notes in demo/CressieWikle.R in the 
spacetime package.

Best, 

Oscar.

library(raster)
library(rasterVis)
library(zoo)

url <- "ftp://ftp.wiley.com/public/sci_tech_med/spatio_temporal_data/"

sst.dat = read.table(paste(url, "SST011970_032003.dat", sep=''), header
	= FALSE) 
sst.ll = read.table(paste(url, "SSTlonlat.dat", sep=''),
	header = FALSE)

sp <- SpatialPointsDataFrame(sst.ll, sst.dat)
gridded(sp) <- TRUE
proj4string(sp) = "+proj=longlat +datum=WGS84"
s <- brick(sp)

idx <- seq(as.Date('1970-01-01'), as.Date('2003-03-01'), by='month')
idx <- as.yearmon(idx)
s <- setZ(s, idx)
layerNames(s) <- as.character(idx)

##One year per page with layout=c(3,4)
trellis.device('pdf', file='cressie_level.pdf')
levelplot(s, layout=c(3, 4))
dev.off()

## layout inside histogram works correctly 
## only with rasterVis 0.10-5 (at R-Forge) 
trellis.device('pdf', file='cressie_hist.pdf')
histogram(s, layout=c(3, 4))  
dev.off()



-------------------
Oscar Perpi??n Lamigueiro
Dpto. Ingenier?a El?ctrica
EUITI-UPM

http://procomun.wordpress.com

-----------------------------------------
> Use print on your levelplot command. This is in the R FAQ (7.22).
>
>Paul
>
>On 09/13/2011 09:10 AM, Els Ducheyne wrote:
>> dear list
>> I want to display a time series of data using either spplot or
>> levelplot to verify consistency in the raw images prior to
>> processing (visual quality check) to do this I am use spplot (or
>> levelplot). This works up to 16 images, however if I want to see
>> more I have to split the inputfiles and put them in  a loop. When
>> the loop is executed, I can see the quartz window but the content is
>> not shown. Does anyone have an idea how to solve this ? See below
>> for information on OS and versions + code
>>
>> Thanks for help
>> Els
>>
>>
>> require(raster) #raster package = 1.9-5
>> require(rasterVis) #rasterVis = 0.10-4
>> setwd(outputdir)
>> #get all the inputdata
>> par(ask=T)
>> inputlist <- list.files(pattern="LSTDay")
>> datadisplay <- seq(1,length(inputlist),16)
>> datadisplay <- c(datadisplay,length(inputlist))
>> n <- length(datadisplay)-1
>> for (i in 1:n){
>> 	input <- inputlist[datadisplay[i]:datadisplay[i+1]-1]
>> 	images <- stack(inputlist)
>> 	NAvalue(images)<-0
>> 	#spplot(images,col.regions=terrain.colors(80)) # quartz is
>> shown but remains empty
>> levelplot(images,col.regions=terrain.colors(80)) # quartz is shown
>> but remains empty hist(images,xlim=c(220*50,340*50),n=20)
>> #histograms are displayed in quartz }
>>
>>
>> $platform
>> [1] "i386-apple-darwin9.8.0"
>>
>> $arch
>> [1] "i386"
>>
>> $os
>> [1] "darwin9.8.0"
>>
>> $system
>> [1] "i386, darwin9.8.0"
>>
>> $status
>> [1] ""
>>
>> $major
>> [1] "2"
>>
>> $minor
>> [1] "13.1"
>>
>> $year
>> [1] "2011"
>>
>> $month
>> [1] "07"
>>
>> $day
>> [1] "08"
>>
>> $`svn rev`
>> [1] "56322"
>>
>> $language
>> [1] "R"
>>
>> $version.string
>> [1] "R version 2.13.1 (2011-07-08)"
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>-- 
>Paul Hiemstra, Ph.D.
>Global Climate Division
>Royal Netherlands Meteorological Institute (KNMI)
>Wilhelminalaan 10 | 3732 GK | De Bilt | Kamer B 3.39
>P.O. Box 201 | 3730 AE | De Bilt
>tel: +31 30 2206 494
>
>http://intamap.geo.uu.nl/~paul
>http://nl.linkedin.com/pub/paul-hiemstra/20/30b/770


From educheyne at avia-gis.be  Tue Sep 13 13:08:42 2011
From: educheyne at avia-gis.be (Els Ducheyne)
Date: Tue, 13 Sep 2011 13:08:42 +0200
Subject: [R-sig-Geo] spplot for raster not drawn
In-Reply-To: <20110913130130.30acee7c@OPL-EUITI>
References: <37732663-3C44-4B8B-8B7C-B5E1FB166AA7@avia-gis.be>
	<4E6F1FF6.9010203@knmi.nl> <20110913130130.30acee7c@OPL-EUITI>
Message-ID: <122DF60F-772B-4A78-A088-5A2CCF88A41C@avia-gis.be>

dear Oscar
thanks, very helpful

Best

On 13 Sep 2011, at 13:01, Oscar Perpi?an Lamigueiro wrote:

> Hi,
> 
> Another approach is to use the layout argument of levelplot. 
> 
> As an example, I use the data from Cressie and Wikle, following the
> superb Edzer Pebesma's notes in demo/CressieWikle.R in the 
> spacetime package.
> 
> Best, 
> 
> Oscar.
> 
> library(raster)
> library(rasterVis)
> library(zoo)
> 
> url <- "ftp://ftp.wiley.com/public/sci_tech_med/spatio_temporal_data/"
> 
> sst.dat = read.table(paste(url, "SST011970_032003.dat", sep=''), header
> 	= FALSE) 
> sst.ll = read.table(paste(url, "SSTlonlat.dat", sep=''),
> 	header = FALSE)
> 
> sp <- SpatialPointsDataFrame(sst.ll, sst.dat)
> gridded(sp) <- TRUE
> proj4string(sp) = "+proj=longlat +datum=WGS84"
> s <- brick(sp)
> 
> idx <- seq(as.Date('1970-01-01'), as.Date('2003-03-01'), by='month')
> idx <- as.yearmon(idx)
> s <- setZ(s, idx)
> layerNames(s) <- as.character(idx)
> 
> ##One year per page with layout=c(3,4)
> trellis.device('pdf', file='cressie_level.pdf')
> levelplot(s, layout=c(3, 4))
> dev.off()
> 
> ## layout inside histogram works correctly 
> ## only with rasterVis 0.10-5 (at R-Forge) 
> trellis.device('pdf', file='cressie_hist.pdf')
> histogram(s, layout=c(3, 4))  
> dev.off()
> 
> 
> 
> -------------------
> Oscar Perpi??n Lamigueiro
> Dpto. Ingenier?a El?ctrica
> EUITI-UPM
> 
> http://procomun.wordpress.com
> 
> -----------------------------------------
>> Use print on your levelplot command. This is in the R FAQ (7.22).
>> 
>> Paul
>> 
>> On 09/13/2011 09:10 AM, Els Ducheyne wrote:
>>> dear list
>>> I want to display a time series of data using either spplot or
>>> levelplot to verify consistency in the raw images prior to
>>> processing (visual quality check) to do this I am use spplot (or
>>> levelplot). This works up to 16 images, however if I want to see
>>> more I have to split the inputfiles and put them in  a loop. When
>>> the loop is executed, I can see the quartz window but the content is
>>> not shown. Does anyone have an idea how to solve this ? See below
>>> for information on OS and versions + code
>>> 
>>> Thanks for help
>>> Els
>>> 
>>> 
>>> require(raster) #raster package = 1.9-5
>>> require(rasterVis) #rasterVis = 0.10-4
>>> setwd(outputdir)
>>> #get all the inputdata
>>> par(ask=T)
>>> inputlist <- list.files(pattern="LSTDay")
>>> datadisplay <- seq(1,length(inputlist),16)
>>> datadisplay <- c(datadisplay,length(inputlist))
>>> n <- length(datadisplay)-1
>>> for (i in 1:n){
>>> 	input <- inputlist[datadisplay[i]:datadisplay[i+1]-1]
>>> 	images <- stack(inputlist)
>>> 	NAvalue(images)<-0
>>> 	#spplot(images,col.regions=terrain.colors(80)) # quartz is
>>> shown but remains empty
>>> levelplot(images,col.regions=terrain.colors(80)) # quartz is shown
>>> but remains empty hist(images,xlim=c(220*50,340*50),n=20)
>>> #histograms are displayed in quartz }
>>> 
>>> 
>>> $platform
>>> [1] "i386-apple-darwin9.8.0"
>>> 
>>> $arch
>>> [1] "i386"
>>> 
>>> $os
>>> [1] "darwin9.8.0"
>>> 
>>> $system
>>> [1] "i386, darwin9.8.0"
>>> 
>>> $status
>>> [1] ""
>>> 
>>> $major
>>> [1] "2"
>>> 
>>> $minor
>>> [1] "13.1"
>>> 
>>> $year
>>> [1] "2011"
>>> 
>>> $month
>>> [1] "07"
>>> 
>>> $day
>>> [1] "08"
>>> 
>>> $`svn rev`
>>> [1] "56322"
>>> 
>>> $language
>>> [1] "R"
>>> 
>>> $version.string
>>> [1] "R version 2.13.1 (2011-07-08)"
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
>> 
>> -- 
>> Paul Hiemstra, Ph.D.
>> Global Climate Division
>> Royal Netherlands Meteorological Institute (KNMI)
>> Wilhelminalaan 10 | 3732 GK | De Bilt | Kamer B 3.39
>> P.O. Box 201 | 3730 AE | De Bilt
>> tel: +31 30 2206 494
>> 
>> http://intamap.geo.uu.nl/~paul
>> http://nl.linkedin.com/pub/paul-hiemstra/20/30b/770


From edzer.pebesma at uni-muenster.de  Tue Sep 13 14:20:39 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 13 Sep 2011 14:20:39 +0200
Subject: [R-sig-Geo] Doubt gstat fitting
In-Reply-To: <0838E01493845742A4D4039EA34EB1C1E116A5@ieopalma2.ba.ieo.es>
References: <0838E01493845742A4D4039EA34EB1C1E116A5@ieopalma2.ba.ieo.es>
Message-ID: <4E6F4A97.6030101@uni-muenster.de>



On 09/13/2011 10:59 AM, Pilar Tugores Ferra wrote:
> Dear list,
> 
> I am using fit.variogram funcion in gstat package, trying several least square fitting methods (method 1,2, 6 and 7) and at the same time I am using the "fit range option".
> 
> I was wondering if the mentioned weighted least square methods are still being applied?
> 
> Regarding fitting range the help of the function says:Because the help funcition says:
> 
> "This function uses the internal gstat (C) code, which interates over (a) a direct (least squares) fit of the partial sills and (b) an iterated search, using gradients, for the optimal range value(s), until convergence of after a combined step ((a) and (b)) is reached."
> 
> Does "direct (least squares)" mean that the function uses OLS or applies the corresponding fitting method (1,2,6 or 7)?
> 
It means "direct (ordinary or weighted least squares)"

> I appologise if it is a problem of not understanding well the language however I would appreciate someone that can clarify this.
> 
No problems; your question helped improving the documentation.

> Thanks in advance,
> 
>  
> 
> Pilar
> 
>  
> 
>  
> 
> M? Pilar Tugores Ferr?
> 
> Instituto Espa?ol de Oceanograf?a
> 
> Centro Oceanogr?fico de Baleares
> 
> Muelle de Poniente s/n
> 
> 07015 Palma de Mallorca
> 
> Baleares, Espa?a
> 
> Telf.: (34) 971 133759
> 
>  
> 
> 
> 	[[alternative HTML version deleted]]
> 
> 
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From luca.candeloro at gmail.com  Tue Sep 13 16:57:20 2011
From: luca.candeloro at gmail.com (luca candeloro)
Date: Tue, 13 Sep 2011 16:57:20 +0200
Subject: [R-sig-Geo] Spatial rainfall or precipitation data
Message-ID: <CAHF6Ynks8ampdwSiNVNyOw8NcgU3aW9RmYjjE3VvK=f6Rr2wkg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110913/262ab97d/attachment.pl>

From mlennert at club.worldonline.be  Tue Sep 13 17:12:26 2011
From: mlennert at club.worldonline.be (Moritz Lennert)
Date: Tue, 13 Sep 2011 17:12:26 +0200
Subject: [R-sig-Geo] extracting simple list of adjacent neighbours
In-Reply-To: <alpine.LRH.2.00.1109062134470.28240@reclus.nhh.no>
References: <4E65DFBE.4080607@club.worldonline.be>
	<alpine.LRH.2.00.1109062134470.28240@reclus.nhh.no>
Message-ID: <4E6F72DA.1070503@club.worldonline.be>

On 06/09/11 21:41, Roger Bivand wrote:
> On Tue, 6 Sep 2011, Moritz Lennert wrote:
>
>> Hello,
>>
>> I have a very simple problem, which I know will have a simple
>> solution, but I just can't get my head wrapped around it.
>>
>> I have a shapefile with regions, including an attribut containing a
>> regional id.
>>
>> I would like to extract a simple neighbourhood file, with
>> neighbourhood defined by simple adjacency with symmetry of
>> relationship in both directions.
>>
>> Ideally, I would like to get something like this:
>>
>> id_region_1 id_neighbour_1
>> id_region_1 id_neighbour_2
>> id_region_1 id_neighbour_3
>> id_region_2 id_neighbour_1
>> id_region_2 id_neighbour_2
>> id_region_3 id_neighbour_1
>> etc
>>
>> What I've done so far:
>>
>> originalmap<-readShapePoly("/path/to/shapefile.shp")
>> nb<-poly2nb(originalmap, row.names=originalmap$idcolumn)
>
> Roughly:
>
> lw <- nb2listw(nb, style="B")
> sn <- listw2sn(lw)
>
> then the first two columns of the "spatial.neighbour" object sn (used in
> the S-PLUS SpatialStats module) are what you need. They can also be
> exported for use in Matlab.
>

This does give me the right format, but I don't get the ids in 
originalmap$idcolumn but rather the internal ids of the polygons.

I've tried using the IDvar parameter in readShapePoly 
(IDvar="idcolumn"), but the result in sn is still the same.

How do I get the sn result to contain the ids from the column I would 
like to use ?

Moritz


From Roger.Bivand at nhh.no  Tue Sep 13 18:39:41 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 13 Sep 2011 18:39:41 +0200 (CEST)
Subject: [R-sig-Geo] extracting simple list of adjacent neighbours
In-Reply-To: <4E6F72DA.1070503@club.worldonline.be>
References: <4E65DFBE.4080607@club.worldonline.be>
	<alpine.LRH.2.00.1109062134470.28240@reclus.nhh.no>
	<4E6F72DA.1070503@club.worldonline.be>
Message-ID: <alpine.LRH.2.00.1109131838080.11824@reclus.nhh.no>

On Tue, 13 Sep 2011, Moritz Lennert wrote:

> On 06/09/11 21:41, Roger Bivand wrote:
>> On Tue, 6 Sep 2011, Moritz Lennert wrote:
>> 
>>> Hello,
>>> 
>>> I have a very simple problem, which I know will have a simple
>>> solution, but I just can't get my head wrapped around it.
>>> 
>>> I have a shapefile with regions, including an attribut containing a
>>> regional id.
>>> 
>>> I would like to extract a simple neighbourhood file, with
>>> neighbourhood defined by simple adjacency with symmetry of
>>> relationship in both directions.
>>> 
>>> Ideally, I would like to get something like this:
>>> 
>>> id_region_1 id_neighbour_1
>>> id_region_1 id_neighbour_2
>>> id_region_1 id_neighbour_3
>>> id_region_2 id_neighbour_1
>>> id_region_2 id_neighbour_2
>>> id_region_3 id_neighbour_1
>>> etc
>>> 
>>> What I've done so far:
>>> 
>>> originalmap<-readShapePoly("/path/to/shapefile.shp")
>>> nb<-poly2nb(originalmap, row.names=originalmap$idcolumn)
>> 
>> Roughly:
>> 
>> lw <- nb2listw(nb, style="B")
>> sn <- listw2sn(lw)
>> 
>> then the first two columns of the "spatial.neighbour" object sn (used in
>> the S-PLUS SpatialStats module) are what you need. They can also be
>> exported for use in Matlab.
>> 
>
> This does give me the right format, but I don't get the ids in 
> originalmap$idcolumn but rather the internal ids of the polygons.

example(columbus)
nb <- poly2nb(columbus, row.names=as.character(columbus$NEIGNO))
lw <- nb2listw(nb, style="B")
sn <- listw2sn(lw)
head(sn)
sn1 <- cbind(attr(sn, "region.id")[sn$from], attr(sn,
   "region.id")[sn$to])
head(sn1)

using the region.id attribute.

Hope this helps,

Roger


>
> I've tried using the IDvar parameter in readShapePoly (IDvar="idcolumn"), but 
> the result in sn is still the same.
>
> How do I get the sn result to contain the ids from the column I would like to 
> use ?
>
> Moritz
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From b.rowlingson at lancaster.ac.uk  Tue Sep 13 19:09:33 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Tue, 13 Sep 2011 18:09:33 +0100
Subject: [R-sig-Geo] import a jpg/etc. map into R?
In-Reply-To: <B1E10DB0-58C4-4D24-BBE7-9668423E8FD1@bristol.ac.uk>
References: <B1E10DB0-58C4-4D24-BBE7-9668423E8FD1@bristol.ac.uk>
Message-ID: <CANVKczMEjipyRqfxexZTZfTkCCDrdrOAX2bjtaZJ=-zwnq4H5g@mail.gmail.com>

On Tue, Sep 13, 2011 at 11:33 AM, Malcolm Fairbrother
<m.fairbrother at bristol.ac.uk> wrote:
> Dear all,
>
> The answer may well be 'no', but does anyone know of a straightforward way to import into R a map in the form of a simple jpeg (or bmp, gif, etc.) image file?

 Straightforward? No!


> . What I'd like to do is read in this kind of file, have R find the edges (identified somehow by differences in pixel colours I guess), and convert the areas defined by those edges into a SpatialPolygons object, with lat/long coordinates.

 Edge-finding is hard - the 1492 map has rivers and text and things to
trap you. You'd have to mask the colours and then do some clever
erosion thing that might take out all the black. Still leaves you with
a raster image though, which you then have to vectorise...

> There may well be no easy way to do this (or not even a difficult way), but I thought I'd check if anyone has any ideas. I prefer to use R, but if some other (preferably open source) software could help me, I'd be interested to know. Even suggestions like "IF you could get it into X format, THEN you could?" might be useful. I'm not a GIS person, unfortunately. On the other hand, I am pretty handy with R, and a regular user of several of the maps/spatial/raster packages.

 I've just used Quantum GIS (open-source GIS package) to warp the
image and register it to a lat-long map data file.

 QGIS has a georeferencer plugin - you load the image and then click
on the points with known lat-long (you can use your graticule
intersections, or well-known features). Then tell it to warp and
assign coordinates.

 Again this gives you a georeferenced _raster_ which might be no good
to you, but at least then you can put known geographic points on top
of it.

 If you really want a vector shapefile of fairly simple boundaries, it
might be quicker to digitise it using QGIS - you can georeference the
raster and click over it to create the polygons. However it would be
very very useful to know the original projection - for the 1492 map my
money is on some kind of Lambert conical..

Barry


From b.rowlingson at lancaster.ac.uk  Tue Sep 13 19:11:46 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Tue, 13 Sep 2011 18:11:46 +0100
Subject: [R-sig-Geo] Spatial rainfall or precipitation data
In-Reply-To: <CAHF6Ynks8ampdwSiNVNyOw8NcgU3aW9RmYjjE3VvK=f6Rr2wkg@mail.gmail.com>
References: <CAHF6Ynks8ampdwSiNVNyOw8NcgU3aW9RmYjjE3VvK=f6Rr2wkg@mail.gmail.com>
Message-ID: <CANVKczP42eBYWfjsH2=g=rO9CaassjMZLA85hyV=QBaT5DVg9w@mail.gmail.com>

On Tue, Sep 13, 2011 at 3:57 PM, luca candeloro
<luca.candeloro at gmail.com> wrote:
> Hi everybody,
> I'm looking for satellite data about rainfall or precipitation...
> I think *
> ftp://disc2.nascom.nasa.gov/data/s4pa/TRMM_L3/TRMM_3B42_daily/2010/001/3B42_daily.2010.01.02.6.bin
> * could be what I'm looking for (as it's accessible via ftp, is 0.25?
> spatial resolution and daily temporal resolution), but I can't get correct
> values from this binary file (I read the documentation about data structure,
> it speaks about two-byte integer, but I can't understand how to get values).
>
> Does anyone know how to read this kind of file into R or an alternative way
> of having spatial data about precipitation?

 you could try the IRI Data Library:

http://iridl.ldeo.columbia.edu/

 the interface is a bit clunky but persevere. There's definitely
rainfall data in there over space and time, but it does concentrate on
Africa and tropical areas for backing up disease research.

Barry

-- 
blog: http://geospaced.blogspot.com/
web: http://www.maths.lancs.ac.uk/~rowlings
web: http://www.rowlingson.com/
twitter: http://twitter.com/geospacedman
pics: http://www.flickr.com/photos/spacedman


From landis at isciences.com  Tue Sep 13 19:43:42 2011
From: landis at isciences.com (Matthew Landis)
Date: Tue, 13 Sep 2011 13:43:42 -0400
Subject: [R-sig-Geo] Spatial rainfall or precipitation data
In-Reply-To: <CAHF6Ynks8ampdwSiNVNyOw8NcgU3aW9RmYjjE3VvK=f6Rr2wkg@mail.gmail.com>
References: <CAHF6Ynks8ampdwSiNVNyOw8NcgU3aW9RmYjjE3VvK=f6Rr2wkg@mail.gmail.com>
Message-ID: <4E6F964E.9070500@isciences.com>



On 9/13/2011 10:57 AM, luca candeloro wrote:
> Hi everybody,
> I'm looking for satellite data about rainfall or precipitation...
> I think *
> ftp://disc2.nascom.nasa.gov/data/s4pa/TRMM_L3/TRMM_3B42_daily/2010/001/3B42_daily.2010.01.02.6.bin
> * could be what I'm looking for (as it's accessible via ftp, is 0.25?
> spatial resolution and daily temporal resolution), but I can't get correct
> values from this binary file (I read the documentation about data structure,
> it speaks about two-byte integer, but I can't understand how to get values).
Luca, I haven't used the TRMM binary data specifically, but I've read in 
similar files into R.  It's a little tricky to go from binary data to 
something you can visualize, e.g. with the raster package.  I found that 
there was a fair bit of trial and error.

# This gives a vector of values
trmm.data <- readBin(file(trmm.data.file, open = 'rb'), size = 2, 
endian='little')

# If it looks like nonsense, you might try setting endian to 'swap' or 
'big',  or changing the 'size'

# assign to a raster layer
# The array might have to be transposed to work right
trmm.array <- array(trmm.data, dim = c(1440, 400))

trmm.raster <- raster(trmm.array, xmn = -180, xmx = 180, ymn = -50, ymx 
= 50,
     crs = '+proj=longlat +datum=WGS84 +ellps=WGS84')

plot(trmm.raster)
# If image doesn't look right, you might look into the rotate() and 
flip() functions in the raster package.

Good luck.

M

-- 
~~~~~~~~~~~~~~~~~~~~~~~~~~
Matthew Landis, Ph.D.
Research Scientist
ISciences, LLC
61 Main St. Suite 200
Burlington VT 05401
802.864.2999
~~~~~~~~~~~~~~~~~~~~~~~~~~


From greenberg at ucdavis.edu  Tue Sep 13 22:42:27 2011
From: greenberg at ucdavis.edu (Jonathan Greenberg)
Date: Tue, 13 Sep 2011 13:42:27 -0700
Subject: [R-sig-Geo] rbind problems with SpatialPolygonsDataFrame
Message-ID: <CABG0rftKX0wk8bWra2C5TgAPWiRvJNwJtpaLGWmfjOZeBFqr8w@mail.gmail.com>

R-sig-geo'ers:

I apologize that I can't provide the input data, but maybe the info
below can illuminate the problem.  Basically, I'm trying to rbind two
SpatialPolygonDataFrames together, but I'm getting a strange error:

'no method or default for coercing "logical" to "SpatialPolygons"'

Does rbind only work on SpatialPolygons (e.g. should I rbind the
SpatialPolygons and the data.frame separately, then piece them back
together afterwards?)

Note the "replacement" call was because I couldn't figure out how to
do.call(rbind) and pass along the "makeUniqueIDs=TRUE"

> i=2
> boundary_vectors=rbind(boundary_vectors,boundary_vectors_unmerged[[i]],makeUniqueIDs=TRUE)
Error in as(x, "SpatialPolygons") :
  no method or default for coercing "logical" to "SpatialPolygons"
> class(boundary_vectors)
[1] "SpatialPolygonsDataFrame"
attr(,"package")
[1] "sp"
> class(boundary_vectors_unmerged[[i]])
[1] "SpatialPolygonsDataFrame"
attr(,"package")
[1] "sp"

This was a single step from a larger looping I used in lieu of do.call:

> class(boundary_vectors_unmerged)
	for(i in (1:length(boundary_vectors_unmerged)))
	{
		print(i)
		if(i==1)
		{
			boundary_vectors=boundary_vectors_unmerged[[i]]
		} else
		{
			boundary_vectors=rbind(boundary_vectors,boundary_vectors_unmerged[[i]],makeUniqueIDs=TRUE)
		}
	}


--j

-- 
Jonathan A. Greenberg, PhD
Assistant Project Scientist
Center for Spatial Technologies and Remote Sensing (CSTARS)
Department of Land, Air and Water Resources
University of California, Davis
One Shields Avenue
Davis, CA 95616
Phone: 415-763-5476
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307


From r.hijmans at gmail.com  Wed Sep 14 01:55:20 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 13 Sep 2011 16:55:20 -0700
Subject: [R-sig-Geo] subs and the name of column
In-Reply-To: <1315907509726-6786840.post@n2.nabble.com>
References: <CA+GC7G4vg-65_AAhLr=zq3MwF6j4F-0TmEGqPVSFHhzPkdF6oA@mail.gmail.com>
	<1311043884878-6597311.post@n2.nabble.com>
	<1315907509726-6786840.post@n2.nabble.com>
Message-ID: <CANtt_hy9CYkoDYkw4YNKLM04wXyegy_95Qv8KxNWZ1=JpU+7Dw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110913/54701661/attachment.pl>

From adamhsparks at gmail.com  Wed Sep 14 02:17:07 2011
From: adamhsparks at gmail.com (Adam Sparks)
Date: Wed, 14 Sep 2011 08:17:07 +0800
Subject: [R-sig-Geo] rbind problems with SpatialPolygonsDataFrame
In-Reply-To: <CABG0rftKX0wk8bWra2C5TgAPWiRvJNwJtpaLGWmfjOZeBFqr8w@mail.gmail.com>
References: <CABG0rftKX0wk8bWra2C5TgAPWiRvJNwJtpaLGWmfjOZeBFqr8w@mail.gmail.com>
Message-ID: <CAJmQPwFuCf6e0UdqJ+v6NiFLh3RDTJv0Os_pkk+Qz=NFNgfUtA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110914/7fcfa790/attachment.pl>

From r.hijmans at gmail.com  Wed Sep 14 02:35:32 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 13 Sep 2011 17:35:32 -0700
Subject: [R-sig-Geo] Spatial rainfall or precipitation data
In-Reply-To: <4E6F964E.9070500@isciences.com>
References: <CAHF6Ynks8ampdwSiNVNyOw8NcgU3aW9RmYjjE3VvK=f6Rr2wkg@mail.gmail.com>
	<4E6F964E.9070500@isciences.com>
Message-ID: <CANtt_hzEPht4FOdmP+zNX0z=wTJH5V2Y0oP=g-VbXFzJOwbUxw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110913/5ece92b0/attachment.pl>

From greenberg at ucdavis.edu  Wed Sep 14 03:33:29 2011
From: greenberg at ucdavis.edu (Jonathan Greenberg)
Date: Tue, 13 Sep 2011 18:33:29 -0700
Subject: [R-sig-Geo] rbind problems with SpatialPolygonsDataFrame
In-Reply-To: <CAJmQPwFuCf6e0UdqJ+v6NiFLh3RDTJv0Os_pkk+Qz=NFNgfUtA@mail.gmail.com>
References: <CABG0rftKX0wk8bWra2C5TgAPWiRvJNwJtpaLGWmfjOZeBFqr8w@mail.gmail.com>
	<CAJmQPwFuCf6e0UdqJ+v6NiFLh3RDTJv0Os_pkk+Qz=NFNgfUtA@mail.gmail.com>
Message-ID: <CABG0rfsvJn33k3BXAo41OpY18dCNwFBYF9rOx0YPLmRDWotJyg@mail.gmail.com>

I tried that, but is there an equivalent of makeUniqueIDs=TRUE for
that command?  I get this error when running spRbind:

Error in spRbind(as(obj, "SpatialPolygons"), as(x, "SpatialPolygons")) :
  non-unique polygon IDs

--j

On Tue, Sep 13, 2011 at 5:17 PM, Adam Sparks <adamhsparks at gmail.com> wrote:
> Have you tried spRbind?
>
> On Wed, Sep 14, 2011 at 4:42 AM, Jonathan Greenberg
> <greenberg at ucdavis.edu>wrote:
>
>> R-sig-geo'ers:
>>
>> I apologize that I can't provide the input data, but maybe the info
>> below can illuminate the problem. ?Basically, I'm trying to rbind two
>> SpatialPolygonDataFrames together, but I'm getting a strange error:
>>
>> 'no method or default for coercing "logical" to "SpatialPolygons"'
>>
>> Does rbind only work on SpatialPolygons (e.g. should I rbind the
>> SpatialPolygons and the data.frame separately, then piece them back
>> together afterwards?)
>>
>> Note the "replacement" call was because I couldn't figure out how to
>> do.call(rbind) and pass along the "makeUniqueIDs=TRUE"
>>
>> > i=2
>> >
>> boundary_vectors=rbind(boundary_vectors,boundary_vectors_unmerged[[i]],makeUniqueIDs=TRUE)
>> Error in as(x, "SpatialPolygons") :
>> ?no method or default for coercing "logical" to "SpatialPolygons"
>> > class(boundary_vectors)
>> [1] "SpatialPolygonsDataFrame"
>> attr(,"package")
>> [1] "sp"
>> > class(boundary_vectors_unmerged[[i]])
>> [1] "SpatialPolygonsDataFrame"
>> attr(,"package")
>> [1] "sp"
>>
>> This was a single step from a larger looping I used in lieu of do.call:
>>
>> > class(boundary_vectors_unmerged)
>> ? ? ? ?for(i in (1:length(boundary_vectors_unmerged)))
>> ? ? ? ?{
>> ? ? ? ? ? ? ? ?print(i)
>> ? ? ? ? ? ? ? ?if(i==1)
>> ? ? ? ? ? ? ? ?{
>> ? ? ? ? ? ? ? ? ? ? ? ?boundary_vectors=boundary_vectors_unmerged[[i]]
>> ? ? ? ? ? ? ? ?} else
>> ? ? ? ? ? ? ? ?{
>>
>> ?boundary_vectors=rbind(boundary_vectors,boundary_vectors_unmerged[[i]],makeUniqueIDs=TRUE)
>> ? ? ? ? ? ? ? ?}
>> ? ? ? ?}
>>
>>
>> --j
>>
>> --
>> Jonathan A. Greenberg, PhD
>> Assistant Project Scientist
>> Center for Spatial Technologies and Remote Sensing (CSTARS)
>> Department of Land, Air and Water Resources
>> University of California, Davis
>> One Shields Avenue
>> Davis, CA 95616
>> Phone: 415-763-5476
>> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
>
> --
> best,
>
> Adam Sparks
> Post-Doctoral Fellow
> IRRI
> DAPO Box 7777
> Metro, Manila
> Los Ba?os, Laguna, Philippines
>
> ? ? ? ?[[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>



-- 
Jonathan A. Greenberg, PhD
Assistant Project Scientist
Center for Spatial Technologies and Remote Sensing (CSTARS)
Department of Land, Air and Water Resources
University of California, Davis
One Shields Avenue
Davis, CA 95616
Phone: 415-763-5476
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307


From tom.gottfried at tum.de  Wed Sep 14 08:26:55 2011
From: tom.gottfried at tum.de (Tom Gottfried)
Date: Wed, 14 Sep 2011 08:26:55 +0200
Subject: [R-sig-Geo] rbind problems with SpatialPolygonsDataFrame
In-Reply-To: <CABG0rfsvJn33k3BXAo41OpY18dCNwFBYF9rOx0YPLmRDWotJyg@mail.gmail.com>
References: <CABG0rftKX0wk8bWra2C5TgAPWiRvJNwJtpaLGWmfjOZeBFqr8w@mail.gmail.com>	<CAJmQPwFuCf6e0UdqJ+v6NiFLh3RDTJv0Os_pkk+Qz=NFNgfUtA@mail.gmail.com>
	<CABG0rfsvJn33k3BXAo41OpY18dCNwFBYF9rOx0YPLmRDWotJyg@mail.gmail.com>
Message-ID: <4E70492F.7060802@tum.de>

see the "Note" section in ?rbind.SpatialPolygonsDataFrame! Though this 
does not seem to explain the first error you mentioned. Here a 
reproducable example would be very helpful to trace the error.

Tom

Am 14.09.2011 03:33, schrieb Jonathan Greenberg:
> I tried that, but is there an equivalent of makeUniqueIDs=TRUE for
> that command?  I get this error when running spRbind:
>
> Error in spRbind(as(obj, "SpatialPolygons"), as(x, "SpatialPolygons")) :
>    non-unique polygon IDs
>
> --j
>
> On Tue, Sep 13, 2011 at 5:17 PM, Adam Sparks<adamhsparks at gmail.com>  wrote:
>> Have you tried spRbind?
>>
>> On Wed, Sep 14, 2011 at 4:42 AM, Jonathan Greenberg
>> <greenberg at ucdavis.edu>wrote:
>>
>>> R-sig-geo'ers:
>>>
>>> I apologize that I can't provide the input data, but maybe the info
>>> below can illuminate the problem.  Basically, I'm trying to rbind two
>>> SpatialPolygonDataFrames together, but I'm getting a strange error:
>>>
>>> 'no method or default for coercing "logical" to "SpatialPolygons"'
>>>
>>> Does rbind only work on SpatialPolygons (e.g. should I rbind the
>>> SpatialPolygons and the data.frame separately, then piece them back
>>> together afterwards?)
>>>
>>> Note the "replacement" call was because I couldn't figure out how to
>>> do.call(rbind) and pass along the "makeUniqueIDs=TRUE"
>>>
>>>> i=2
>>>>
>>> boundary_vectors=rbind(boundary_vectors,boundary_vectors_unmerged[[i]],makeUniqueIDs=TRUE)
>>> Error in as(x, "SpatialPolygons") :
>>>   no method or default for coercing "logical" to "SpatialPolygons"
>>>> class(boundary_vectors)
>>> [1] "SpatialPolygonsDataFrame"
>>> attr(,"package")
>>> [1] "sp"
>>>> class(boundary_vectors_unmerged[[i]])
>>> [1] "SpatialPolygonsDataFrame"
>>> attr(,"package")
>>> [1] "sp"
>>>
>>> This was a single step from a larger looping I used in lieu of do.call:
>>>
>>>> class(boundary_vectors_unmerged)
>>>         for(i in (1:length(boundary_vectors_unmerged)))
>>>         {
>>>                 print(i)
>>>                 if(i==1)
>>>                 {
>>>                         boundary_vectors=boundary_vectors_unmerged[[i]]
>>>                 } else
>>>                 {
>>>
>>>   boundary_vectors=rbind(boundary_vectors,boundary_vectors_unmerged[[i]],makeUniqueIDs=TRUE)
>>>                 }
>>>         }
>>>
>>>
>>> --j
>>>
>>> --
>>> Jonathan A. Greenberg, PhD
>>> Assistant Project Scientist
>>> Center for Spatial Technologies and Remote Sensing (CSTARS)
>>> Department of Land, Air and Water Resources
>>> University of California, Davis
>>> One Shields Avenue
>>> Davis, CA 95616
>>> Phone: 415-763-5476
>>> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>>
>>
>> --
>> best,
>>
>> Adam Sparks
>> Post-Doctoral Fellow
>> IRRI
>> DAPO Box 7777
>> Metro, Manila
>> Los Ba?os, Laguna, Philippines
>>
>>         [[alternative HTML version deleted]]
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>
>
>

-- 
Technische Universit?t M?nchen
Department f?r Pflanzenwissenschaften
Lehrstuhl f?r Gr?nlandlehre
Alte Akademie 12
85350 Freising / Germany
Phone: ++49 (0)8161 715324
Fax:   ++49 (0)8161 713243
email: tom.gottfried at wzw.tum.de
http://www.wzw.tum.de/gruenland


From Roger.Bivand at nhh.no  Wed Sep 14 08:53:11 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 14 Sep 2011 08:53:11 +0200
Subject: [R-sig-Geo] rbind problems with SpatialPolygonsDataFrame
In-Reply-To: <CABG0rfsvJn33k3BXAo41OpY18dCNwFBYF9rOx0YPLmRDWotJyg@mail.gmail.com>
References: <CABG0rftKX0wk8bWra2C5TgAPWiRvJNwJtpaLGWmfjOZeBFqr8w@mail.gmail.com>
	<CAJmQPwFuCf6e0UdqJ+v6NiFLh3RDTJv0Os_pkk+Qz=NFNgfUtA@mail.gmail.com>
	<CABG0rfsvJn33k3BXAo41OpY18dCNwFBYF9rOx0YPLmRDWotJyg@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1109140846340.15023@reclus.nhh.no>

On Tue, 13 Sep 2011, Jonathan Greenberg wrote:

> I tried that, but is there an equivalent of makeUniqueIDs=TRUE for
> that command?  I get this error when running spRbind:
>
> Error in spRbind(as(obj, "SpatialPolygons"), as(x, "SpatialPolygons")) :
>  non-unique polygon IDs

There is no equivalent by design. The IDs are what are used to match the 
geometries with the rows of the attribute data (if any), so cannot be 
arbitrary. The user should assign suitable valyes first, it isn't hard, 
just imposes necessary discipline.

In your case I would never extend the list of Polygons objects as you do - 
I would always first count the total number of Polygons objects in the 
list of SpatialPolygons* objects, create a list of the correct length, 
create and assign unique IDs to the input list components, assign to the 
new list, and only then build the output SpatialPolygons* object. This 
avoids the wasteful reallocation of memory each time round the loop.

Hope this clarifies,

Roger

>
> --j
>
> On Tue, Sep 13, 2011 at 5:17 PM, Adam Sparks <adamhsparks at gmail.com> wrote:
>> Have you tried spRbind?
>>
>> On Wed, Sep 14, 2011 at 4:42 AM, Jonathan Greenberg
>> <greenberg at ucdavis.edu>wrote:
>>
>>> R-sig-geo'ers:
>>>
>>> I apologize that I can't provide the input data, but maybe the info
>>> below can illuminate the problem. ?Basically, I'm trying to rbind two
>>> SpatialPolygonDataFrames together, but I'm getting a strange error:
>>>
>>> 'no method or default for coercing "logical" to "SpatialPolygons"'
>>>
>>> Does rbind only work on SpatialPolygons (e.g. should I rbind the
>>> SpatialPolygons and the data.frame separately, then piece them back
>>> together afterwards?)
>>>
>>> Note the "replacement" call was because I couldn't figure out how to
>>> do.call(rbind) and pass along the "makeUniqueIDs=TRUE"
>>>
>>>> i=2
>>>>
>>> boundary_vectors=rbind(boundary_vectors,boundary_vectors_unmerged[[i]],makeUniqueIDs=TRUE)
>>> Error in as(x, "SpatialPolygons") :
>>> ?no method or default for coercing "logical" to "SpatialPolygons"
>>>> class(boundary_vectors)
>>> [1] "SpatialPolygonsDataFrame"
>>> attr(,"package")
>>> [1] "sp"
>>>> class(boundary_vectors_unmerged[[i]])
>>> [1] "SpatialPolygonsDataFrame"
>>> attr(,"package")
>>> [1] "sp"
>>>
>>> This was a single step from a larger looping I used in lieu of do.call:
>>>
>>>> class(boundary_vectors_unmerged)
>>> ? ? ? ?for(i in (1:length(boundary_vectors_unmerged)))
>>> ? ? ? ?{
>>> ? ? ? ? ? ? ? ?print(i)
>>> ? ? ? ? ? ? ? ?if(i==1)
>>> ? ? ? ? ? ? ? ?{
>>> ? ? ? ? ? ? ? ? ? ? ? ?boundary_vectors=boundary_vectors_unmerged[[i]]
>>> ? ? ? ? ? ? ? ?} else
>>> ? ? ? ? ? ? ? ?{
>>>
>>> ?boundary_vectors=rbind(boundary_vectors,boundary_vectors_unmerged[[i]],makeUniqueIDs=TRUE)
>>> ? ? ? ? ? ? ? ?}
>>> ? ? ? ?}
>>>
>>>
>>> --j
>>>
>>> --
>>> Jonathan A. Greenberg, PhD
>>> Assistant Project Scientist
>>> Center for Spatial Technologies and Remote Sensing (CSTARS)
>>> Department of Land, Air and Water Resources
>>> University of California, Davis
>>> One Shields Avenue
>>> Davis, CA 95616
>>> Phone: 415-763-5476
>>> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>>
>>
>> --
>> best,
>>
>> Adam Sparks
>> Post-Doctoral Fellow
>> IRRI
>> DAPO Box 7777
>> Metro, Manila
>> Los Ba?os, Laguna, Philippines
>>
>> ? ? ? ?[[alternative HTML version deleted]]
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>
>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From mathieu.rajerison at gmail.com  Wed Sep 14 09:27:08 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Wed, 14 Sep 2011 09:27:08 +0200
Subject: [R-sig-Geo] Intervisibility raster,
	equivalent of GRASS r.los under R ?
Message-ID: <CAGfc75kF5CQGBAcRrSRbrGcYMfSsOr_3h4on1kU3iDKGtn14_A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110914/49e07fb9/attachment.pl>

From mathieu.rajerison at gmail.com  Wed Sep 14 09:30:34 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Wed, 14 Sep 2011 09:30:34 +0200
Subject: [R-sig-Geo] Intervisibility raster, equivalent of r.los under R?
Message-ID: <CAGfc75nnKDxDTRsgdF1=NuO_b1J_FSmR09Rr+-i9E+eVCVapqA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110914/ad7af337/attachment.pl>

From luca.candeloro at gmail.com  Wed Sep 14 11:10:09 2011
From: luca.candeloro at gmail.com (luca candeloro)
Date: Wed, 14 Sep 2011 11:10:09 +0200
Subject: [R-sig-Geo] Spatial rainfall or precipitation data
In-Reply-To: <CANtt_hzEPht4FOdmP+zNX0z=wTJH5V2Y0oP=g-VbXFzJOwbUxw@mail.gmail.com>
References: <CAHF6Ynks8ampdwSiNVNyOw8NcgU3aW9RmYjjE3VvK=f6Rr2wkg@mail.gmail.com>
	<4E6F964E.9070500@isciences.com>
	<CANtt_hzEPht4FOdmP+zNX0z=wTJH5V2Y0oP=g-VbXFzJOwbUxw@mail.gmail.com>
Message-ID: <CAHF6Ynm1ihywK65XtChFoBnp8pHmgLxHXd78YVLOEe5zQntOgQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110914/d34fb9f2/attachment.pl>

From mlennert at club.worldonline.be  Wed Sep 14 13:40:50 2011
From: mlennert at club.worldonline.be (Moritz Lennert)
Date: Wed, 14 Sep 2011 13:40:50 +0200
Subject: [R-sig-Geo] extracting simple list of adjacent neighbours
In-Reply-To: <alpine.LRH.2.00.1109131838080.11824@reclus.nhh.no>
References: <4E65DFBE.4080607@club.worldonline.be>
	<alpine.LRH.2.00.1109062134470.28240@reclus.nhh.no>
	<4E6F72DA.1070503@club.worldonline.be>
	<alpine.LRH.2.00.1109131838080.11824@reclus.nhh.no>
Message-ID: <4E7092C2.3090701@club.worldonline.be>

On 13/09/11 18:39, Roger Bivand wrote:
> On Tue, 13 Sep 2011, Moritz Lennert wrote:
>
>> On 06/09/11 21:41, Roger Bivand wrote:
>>> On Tue, 6 Sep 2011, Moritz Lennert wrote:
>>>
>>>> Hello,
>>>>
>>>> I have a very simple problem, which I know will have a simple
>>>> solution, but I just can't get my head wrapped around it.
>>>>
>>>> I have a shapefile with regions, including an attribut containing a
>>>> regional id.
>>>>
>>>> I would like to extract a simple neighbourhood file, with
>>>> neighbourhood defined by simple adjacency with symmetry of
>>>> relationship in both directions.
>>>>
>>>> Ideally, I would like to get something like this:
>>>>
>>>> id_region_1 id_neighbour_1
>>>> id_region_1 id_neighbour_2
>>>> id_region_1 id_neighbour_3
>>>> id_region_2 id_neighbour_1
>>>> id_region_2 id_neighbour_2
>>>> id_region_3 id_neighbour_1
>>>> etc
>>>>
>>>> What I've done so far:
>>>>
>>>> originalmap<-readShapePoly("/path/to/shapefile.shp")
>>>> nb<-poly2nb(originalmap, row.names=originalmap$idcolumn)
>>>
>>> Roughly:
>>>
>>> lw <- nb2listw(nb, style="B")
>>> sn <- listw2sn(lw)
>>>
>>> then the first two columns of the "spatial.neighbour" object sn (used in
>>> the S-PLUS SpatialStats module) are what you need. They can also be
>>> exported for use in Matlab.
>>>
>>
>> This does give me the right format, but I don't get the ids in
>> originalmap$idcolumn but rather the internal ids of the polygons.
>
> example(columbus)
> nb <- poly2nb(columbus, row.names=as.character(columbus$NEIGNO))
> lw <- nb2listw(nb, style="B")
> sn <- listw2sn(lw)
> head(sn)
> sn1 <- cbind(attr(sn, "region.id")[sn$from], attr(sn,
> "region.id")[sn$to])
> head(sn1)
>
> using the region.id attribute.
>
> Hope this helps,

Yep, this gives me exactly what I was looking for. And I learned 
something new: never used attr() before. Is there no other way to access 
the region.id info in sn ?

BTW: Is there any documentation about which attributes are available in 
these objects other than running attributes() ?

Thanks in any case !

Moritz


From Roger.Bivand at nhh.no  Wed Sep 14 13:47:38 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 14 Sep 2011 13:47:38 +0200 (CEST)
Subject: [R-sig-Geo] extracting simple list of adjacent neighbours
In-Reply-To: <4E7092C2.3090701@club.worldonline.be>
References: <4E65DFBE.4080607@club.worldonline.be>
	<alpine.LRH.2.00.1109062134470.28240@reclus.nhh.no>
	<4E6F72DA.1070503@club.worldonline.be>
	<alpine.LRH.2.00.1109131838080.11824@reclus.nhh.no>
	<4E7092C2.3090701@club.worldonline.be>
Message-ID: <alpine.LRH.2.00.1109141345520.15023@reclus.nhh.no>

On Wed, 14 Sep 2011, Moritz Lennert wrote:

> On 13/09/11 18:39, Roger Bivand wrote:
>> On Tue, 13 Sep 2011, Moritz Lennert wrote:
>> 
>>> On 06/09/11 21:41, Roger Bivand wrote:
>>>> On Tue, 6 Sep 2011, Moritz Lennert wrote:
>>>> 
>>>>> Hello,
>>>>> 
>>>>> I have a very simple problem, which I know will have a simple
>>>>> solution, but I just can't get my head wrapped around it.
>>>>> 
>>>>> I have a shapefile with regions, including an attribut containing a
>>>>> regional id.
>>>>> 
>>>>> I would like to extract a simple neighbourhood file, with
>>>>> neighbourhood defined by simple adjacency with symmetry of
>>>>> relationship in both directions.
>>>>> 
>>>>> Ideally, I would like to get something like this:
>>>>> 
>>>>> id_region_1 id_neighbour_1
>>>>> id_region_1 id_neighbour_2
>>>>> id_region_1 id_neighbour_3
>>>>> id_region_2 id_neighbour_1
>>>>> id_region_2 id_neighbour_2
>>>>> id_region_3 id_neighbour_1
>>>>> etc
>>>>> 
>>>>> What I've done so far:
>>>>> 
>>>>> originalmap<-readShapePoly("/path/to/shapefile.shp")
>>>>> nb<-poly2nb(originalmap, row.names=originalmap$idcolumn)
>>>> 
>>>> Roughly:
>>>> 
>>>> lw <- nb2listw(nb, style="B")
>>>> sn <- listw2sn(lw)
>>>> 
>>>> then the first two columns of the "spatial.neighbour" object sn (used in
>>>> the S-PLUS SpatialStats module) are what you need. They can also be
>>>> exported for use in Matlab.
>>>> 
>>> 
>>> This does give me the right format, but I don't get the ids in
>>> originalmap$idcolumn but rather the internal ids of the polygons.
>> 
>> example(columbus)
>> nb <- poly2nb(columbus, row.names=as.character(columbus$NEIGNO))
>> lw <- nb2listw(nb, style="B")
>> sn <- listw2sn(lw)
>> head(sn)
>> sn1 <- cbind(attr(sn, "region.id")[sn$from], attr(sn,
>> "region.id")[sn$to])
>> head(sn1)
>> 
>> using the region.id attribute.
>> 
>> Hope this helps,
>
> Yep, this gives me exactly what I was looking for. And I learned something 
> new: never used attr() before. Is there no other way to access the region.id 
> info in sn ?

No.

>
> BTW: Is there any documentation about which attributes are available in these 
> objects other than running attributes() ?
>

It isn't in the help page; most often attributes are only used internally. 
You can also run str() on an object to see whether any attributes are 
present, and if so, what they seem to be.

Roger

> Thanks in any case !
>
> Moritz
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From mathieu.rajerison at gmail.com  Wed Sep 14 14:00:08 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Wed, 14 Sep 2011 14:00:08 +0200
Subject: [R-sig-Geo] Intervisibility raster, equivalent of r.los under R?
In-Reply-To: <CAP8THHWDs6RFWTutKn86G6xeupp3Ob22fVMEZpAdmcx7ML5cag@mail.gmail.com>
References: <CAGfc75nnKDxDTRsgdF1=NuO_b1J_FSmR09Rr+-i9E+eVCVapqA@mail.gmail.com>
	<CAP8THHWDs6RFWTutKn86G6xeupp3Ob22fVMEZpAdmcx7ML5cag@mail.gmail.com>
Message-ID: <CAGfc75=0DbBvScUo5z=+EYBK=UVVnMOzM4nC+X=4=4FrhbA2aA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110914/afe50747/attachment.pl>

From sara.kleyer at uni-bamberg.de  Wed Sep 14 15:03:51 2011
From: sara.kleyer at uni-bamberg.de (Sara Kleyer)
Date: Wed, 14 Sep 2011 15:03:51 +0200
Subject: [R-sig-Geo] geoR: krigeing,
	predict on other coordinates with a parametric trend
Message-ID: <4E70A637.8010802@uni-bamberg.de>

Dear list,

there are two datasets: the data "geo" is a geodata-set including, 
"data", covariates and coordinates. The second dataset "fehlcord" is a 
dataset including 2 columns for the coordinates and additional columns 
for covariates.

I want to use kriging.conv to estimate on the "geo"-dataset and predict 
on the locations of the "fehlcord" dataset. Additionally, I want to use 
the covariates for a parametric trend.
This is the syntax I use:
#definition of the trend, I am interested in:
trend1<-trend.spatial("1st", geo,  
add=~covariate$bauland+covariate$baulandsq+covariate$ostw+covariate$tour+covariate$alq)
#estimate the model
neu<-likfit(geo, coords=geo$coords, data=geo$data, 
ini.cov.pars=c(50,9),trend=trend )
kri.set<-krige.control(type.krige="ok", trend.d=~trend1, 
trend.l=~trend1, obj.model=neu)
#predict on the other dataset
schatz<-krige.conv(geo, locations=fehlcord, krige=kri.set)

R returns, that there is a mistake because:
"in krige.conv(geo, locations = fehlcord, krige = kri.set) :
   locations and trend.l have incompatible sizes"

and in addition:
"In .check.locations(locations) :
   locations provided with a matrix or data-frame with more than 2 
columns. Only the first two columns used as coordinates"

I also tried to define "trend.l" by the dataset "fehlcord" but it did 
not work, too.

How can I predict on new coordinates and use a parametric trend on the 
covariates?

Thanks a lot for your help!

Sara


From paulojus at c3sl.ufpr.br  Wed Sep 14 15:24:13 2011
From: paulojus at c3sl.ufpr.br (Paulo Justiniano Ribeiro Jr)
Date: Wed, 14 Sep 2011 10:24:13 -0300 (BRT)
Subject: [R-sig-Geo] geoR: krigeing,
 predict on other coordinates with a parametric trend
In-Reply-To: <4E70A637.8010802@uni-bamberg.de>
References: <4E70A637.8010802@uni-bamberg.de>
Message-ID: <alpine.DEB.2.00.1109141014130.7011@macalan.c3sl.ufpr.br>

Dear Sara

1. I guess you mean krige.conv() and not kriging.conv()
2. you should be able to simplify the following call if $covariate is an 
element of the geodata (geo) 
> trend1<-trend.spatial("1st", geo,
    add=~bauland+baulandsq+ostw+tour+alq)

3. The problem you are encotering is in the use of trend.d and trend.l
In the former you provido covariate values measured **at data locations**
and for the later **at prediction** locations 
When you define a trend you are including covariates in the model.
In order to run predictions from the firtted model you need to have the 
covariate values at the coorinates of the prediction locations.

In other words, trend.l is the same trend you used in likfit() and have 
dimesion of the data
trend.l is another obhect with the variables as trend.l wowever with 
dimension of the prediction locations (argument locations)

On Wed, 14 Sep 2011, Sara Kleyer wrote:

> Dear list,
>
> there are two datasets: the data "geo" is a geodata-set including, "data", 
> covariates and coordinates. The second dataset "fehlcord" is a dataset 
> including 2 columns for the coordinates and additional columns for 
> covariates.
>
> I want to use kriging.conv to estimate on the "geo"-dataset and predict on 
> the locations of the "fehlcord" dataset. Additionally, I want to use the 
> covariates for a parametric trend.
> This is the syntax I use:
> #definition of the trend, I am interested in:
> trend1<-trend.spatial("1st", geo, 
> add=~covariate$bauland+covariate$baulandsq+covariate$ostw+covariate$tour+covariate$alq)
> #estimate the model
> neu<-likfit(geo, coords=geo$coords, data=geo$data, 
> ini.cov.pars=c(50,9),trend=trend )
> kri.set<-krige.control(type.krige="ok", trend.d=~trend1, trend.l=~trend1, 
> obj.model=neu)
> #predict on the other dataset
> schatz<-krige.conv(geo, locations=fehlcord, krige=kri.set)
>
> R returns, that there is a mistake because:
> "in krige.conv(geo, locations = fehlcord, krige = kri.set) :
>  locations and trend.l have incompatible sizes"
>
> and in addition:
> "In .check.locations(locations) :
>  locations provided with a matrix or data-frame with more than 2 columns. 
> Only the first two columns used as coordinates"
>
> I also tried to define "trend.l" by the dataset "fehlcord" but it did not 
> work, too.
>
> How can I predict on new coordinates and use a parametric trend on the 
> covariates?
>
> Thanks a lot for your help!
>
> Sara
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From carstennh at aol.com  Wed Sep 14 15:35:43 2011
From: carstennh at aol.com (Carsten Neumann)
Date: Wed, 14 Sep 2011 15:35:43 +0200
Subject: [R-sig-Geo] Convert some value to NaN (GeoTiff)
In-Reply-To: <CABz4_ftz3ZEiML8k-QCk3e8dfh0Yws3xLeyU632t8AiZLBenRw@mail.gmail.com>
References: <CABz4_ftz3ZEiML8k-QCk3e8dfh0Yws3xLeyU632t8AiZLBenRw@mail.gmail.com>
Message-ID: <4E70ADAF.3050509@aol.com>

  Am 13.09.2011 06:32, schrieb Joel Risso:
> Dear All,
> I am new to spatial stats in R.
> I would be grateful if someone could help me in a script to convert some
> pixels' values (e.g. NoData, 0, etc.)  to NaN in a Geotiff input.
> Thank you,
> Joel
>
Dear Joel,

there is a quit simple way using raster package.

read GTiff:                a<-raster('H:\\example.tif')
setting NA values:   NAvalue(a)<-0 (here you define which value within 
your image should become a no data value)

or if you want a character string called "NaN" you can do:

d<-which (getValues(a) == 0)
a[d]<-"NaN"

I hope this helps.

Best regards

Carsten


From burtonshank at gmail.com  Wed Sep 14 16:11:31 2011
From: burtonshank at gmail.com (Burton Shank)
Date: Wed, 14 Sep 2011 07:11:31 -0700
Subject: [R-sig-Geo] Read HDF files
Message-ID: <CAE22u=ppVh8a5u+XaR=ovm3n0PT3bH7a95_AggjuVibKG-2rKw@mail.gmail.com>

Hi Arnaud,

I've been using a great java script written by David Stube that
converts HDF4 formats to netCDF which can then be easily read by
the standard R packages.

He recently made this software (modis_hdf2nc.jar) available for download at:

http://asascience.com/software/downloads/

Though the file name suggests it's for MODIS data, it has worked
seamlessly for me with a variety of file sources.

Easiest way to batch process files with this is to put a copy of the
file in the working directory and call the it from R like:

system(paste("java -jar hdf2nc.jar ", FILENAME, sep=""))

Hope this helps.

Burton Shank


From afischbach at usgs.gov  Wed Sep 14 23:36:13 2011
From: afischbach at usgs.gov (Anthony Fischbach)
Date: Wed, 14 Sep 2011 14:36:13 -0700 (PDT)
Subject: [R-sig-Geo] Coerce spatialPolygons to spatialLines
Message-ID: <1316036172985-6794570.post@n2.nabble.com>

I am producing plots of spatialPolygons over a spatialPixelDataFrame
and wish to convert the spatialPolygons object to a spatialLines object
as a work around of two plotting problems.

Problem 1: Donut holes in the polygons are plotting as white, 
rather than as a null color that would allow the spatialPixelDataFrame
object's colors to show through.

Problem 2: I wish to set the polygon outline color so that it better
contrasts with the color ramp of the spatialPixelDataFrame object plot.


-----
Tony Fischbach, Wildlife Biologist
Walrus Research Program
Alaska Science Center
U.S. Geological Survey
4210 University Drive
Anchorage, AK 99508-4650

AFischbach at usgs.gov
http://alaska.usgs.gov/science/biology/walrus
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Coerce-spatialPolygons-to-spatialLines-tp6794570p6794570.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From benweinstein2010 at gmail.com  Thu Sep 15 01:17:08 2011
From: benweinstein2010 at gmail.com (Ben Weinstein)
Date: Wed, 14 Sep 2011 19:17:08 -0400
Subject: [R-sig-Geo] complex functions using aggregate
Message-ID: <CAC28k7Rn18ay8PT3Dnb-t60pNOZPuFsRE83XRrDK6wHSaJ4DHg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110914/590d831e/attachment.pl>

From r.hijmans at gmail.com  Thu Sep 15 03:31:19 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 14 Sep 2011 18:31:19 -0700
Subject: [R-sig-Geo] complex functions using aggregate
In-Reply-To: <CAC28k7Rn18ay8PT3Dnb-t60pNOZPuFsRE83XRrDK6wHSaJ4DHg@mail.gmail.com>
References: <CAC28k7Rn18ay8PT3Dnb-t60pNOZPuFsRE83XRrDK6wHSaJ4DHg@mail.gmail.com>
Message-ID: <CANtt_hxZCWxxBAY+=9NqpGYJP9+87P9tUQX4itsqH7edbJkhkA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110914/1b889375/attachment.pl>

From r.hijmans at gmail.com  Thu Sep 15 03:35:40 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 14 Sep 2011 18:35:40 -0700
Subject: [R-sig-Geo] Coerce spatialPolygons to spatialLines
In-Reply-To: <CANtt_hxqfoq+MfrKipG2CjwL5Bodgsq+VO9Qu-TZo2wgi86Ygg@mail.gmail.com>
References: <1316036172985-6794570.post@n2.nabble.com>
	<CANtt_hxqfoq+MfrKipG2CjwL5Bodgsq+VO9Qu-TZo2wgi86Ygg@mail.gmail.com>
Message-ID: <CANtt_hzktQ3Ay4s9QYGjWQ5QDHzZbyeJYdscPuKrKXFyPzhYMg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110914/48fbf759/attachment.pl>

From j.leonpatino at uq.edu.au  Thu Sep 15 09:40:21 2011
From: j.leonpatino at uq.edu.au (Javier Leon Patino)
Date: Thu, 15 Sep 2011 17:40:21 +1000
Subject: [R-sig-Geo] singular model fit
Message-ID: <D8457815528063439E5066EE2475CF1C0A4B7EC37C@UQEXMB04.soe.uq.edu.au>

Dear list,

I am aware there are many post dealing with singular model variogram fits but I have not been able to fix my problem even after re-scaling the coordinates and variables.

I am using fit.variogram(gstat) on the file 'trans.csv' (attached) and have tried several values for the range, sill and nugget and different models. The following gives me an ok variogram (from visual plot) but still a 'singular model' warning.

library(sp)
library(gstat)
points <- read.csv("trans.csv")
coordinates(points)=~x+y
depth.ivgm <- vgm(model='Gau',range=1000, psill=var(points$ln_depth))
depth.vgm <- fit.variogram(variogram(ln_depth~x+y, points), model=depth.ivgm)

Any ideas on why I am getting a singular fit? Is it the small number of samples used?

Cheers,

Javier

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110915/9085bb28/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: trans.csv
Type: application/octet-stream
Size: 3458 bytes
Desc: trans.csv
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110915/9085bb28/attachment.obj>

From Thierry.ONKELINX at inbo.be  Thu Sep 15 10:06:04 2011
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Thu, 15 Sep 2011 08:06:04 +0000
Subject: [R-sig-Geo] singular model fit
In-Reply-To: <D8457815528063439E5066EE2475CF1C0A4B7EC37C@UQEXMB04.soe.uq.edu.au>
References: <D8457815528063439E5066EE2475CF1C0A4B7EC37C@UQEXMB04.soe.uq.edu.au>
Message-ID: <AA818EAD2576BC488B4F623941DA74273B7C8D55@inbomail.inbo.be>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110915/781ae884/attachment.pl>

From tom.gottfried at tum.de  Thu Sep 15 10:15:47 2011
From: tom.gottfried at tum.de (Tom Gottfried)
Date: Thu, 15 Sep 2011 10:15:47 +0200
Subject: [R-sig-Geo] singular model fit
In-Reply-To: <D8457815528063439E5066EE2475CF1C0A4B7EC37C@UQEXMB04.soe.uq.edu.au>
References: <D8457815528063439E5066EE2475CF1C0A4B7EC37C@UQEXMB04.soe.uq.edu.au>
Message-ID: <4E71B433.60403@tum.de>

Hi Javier,

Am 15.09.2011 09:40, schrieb Javier Leon Patino:
> Dear list,
>
> I am aware there are many post dealing with singular model variogram fits but I have not been able
> to fix my problem even after re-scaling the coordinates and variables.
>
> I am using fit.variogram(gstat) on the file ?trans.csv? (attached) and have tried several values for
> the range, sill and nugget and different models. The following gives me an ok variogram (from visual
> plot) but still a ?singular model? warning.
>
> library(sp)
>
> library(gstat)
>
> points <- read.csv("trans.csv")
>
> coordinates(points)=~x+y
>
> depth.ivgm <- vgm(model='Gau',range=1000, psill=var(points$ln_depth))

you use the variance of ln_depth as an estimate for the sill here. Thus, I suspect you want the 
variogram of ln_depth.

> depth.vgm <- fit.variogram(variogram(ln_depth~x+y, points), model=depth.ivgm)

What you calculate here with variogram() is a residual variogram of ln_depth from a first order 
trendsurface over your coordinates. Might that be the cause?

Tom

>
> Any ideas on why I am getting a singular fit? Is it the small number of samples used?
>
> Cheers,
>
> Javier
>
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Technische Universit?t M?nchen
Department f?r Pflanzenwissenschaften
Lehrstuhl f?r Gr?nlandlehre
Alte Akademie 12
85350 Freising / Germany
Phone: ++49 (0)8161 715324
Fax:   ++49 (0)8161 713243
email: tom.gottfried at wzw.tum.de
http://www.wzw.tum.de/gruenland


From paul.hiemstra at knmi.nl  Thu Sep 15 11:02:14 2011
From: paul.hiemstra at knmi.nl (Paul Hiemstra)
Date: Thu, 15 Sep 2011 09:02:14 +0000
Subject: [R-sig-Geo] complex functions using aggregate
In-Reply-To: <CANtt_hxZCWxxBAY+=9NqpGYJP9+87P9tUQX4itsqH7edbJkhkA@mail.gmail.com>
References: <CAC28k7Rn18ay8PT3Dnb-t60pNOZPuFsRE83XRrDK6wHSaJ4DHg@mail.gmail.com>
	<CANtt_hxZCWxxBAY+=9NqpGYJP9+87P9tUQX4itsqH7edbJkhkA@mail.gmail.com>
Message-ID: <4E71BF16.70202@knmi.nl>

 ...purely a cosmetic extension on roberts code, in stead of:

agg<-aggregate(Elevp$Elevation,by=list(Elevp$From,Elevp$To), fun)

I like to use:

agg<-with(Elevp, aggregate(Elevation,by=list(From,To), fun))

Paul



On 09/15/2011 01:31 AM, Robert J. Hijmans wrote:
> Ben, perhaps this will do it:
>
> fun <- function(x) { sum(abs(x[-length(x)] - x[-1])) }
>
> agg<-aggregate(Elevp$Elevation,by=list(Elevp$From,Elevp$To), fun)
>
> Robert
>
>
> On Wed, Sep 14, 2011 at 4:17 PM, Ben Weinstein
> <benweinstein2010 at gmail.com>wrote:
>
>> Hi all
>>
>> I have a series of elevation transects between a list of pairwise
>> locations.
>> This is not specifically a spatial question, but since it is a common
>> spatial task, i hope its okay.
>>
>> head(Elevp)
>> Elevation ComboID From  To
>> 1  3408.080       1  262 138
>> 2  3264.469       1  262 138
>> 3  2904.685       1  262 138
>> 4  2752.840       1  262 138
>> 5  3408.080       2  262 129
>> 6  3217.581       2  262 129
>>
>> In the small section above, the first 'transect' has four points, and goes
>> from site 262 to site 138. I'm trying to find a way to get the total
>> elevation change over each transect. An abstract example is shown below.
>>
>>> h
>> [1]  10   5  40  30 100  60
>>> g<-numeric()
>>> for(x in 1:(length(h)-1))
>> + g[x]<-((abs(h[x+1]-h[x])))
>>> g
>> [1]  5 35 10 70 40
>>> sum(g)
>> [1] 160
>>
>> to perform this over the entire database (1000's of comparisons)
>>
>> agg<-aggregate(Elevp$Elevation,by=list(Elevp$From,Elevp$To),function(x)
>>
>> how do i supply the former function, as a product that fits this setup?
>> Does a cumulative difference function exist? I'm not sure what to call it
>> to
>> begin searching.
>>
>> I appreciate the help.
>>
>> Ben Weinstein
>> Ecology and Evolution
>> Stony Brook University
>>
>>        [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


-- 
Paul Hiemstra, Ph.D.
Global Climate Division
Royal Netherlands Meteorological Institute (KNMI)
Wilhelminalaan 10 | 3732 GK | De Bilt | Kamer B 3.39
P.O. Box 201 | 3730 AE | De Bilt
tel: +31 30 2206 494

http://intamap.geo.uu.nl/~paul
http://nl.linkedin.com/pub/paul-hiemstra/20/30b/770


From momadou at yahoo.fr  Thu Sep 15 13:22:28 2011
From: momadou at yahoo.fr (Komine)
Date: Thu, 15 Sep 2011 04:22:28 -0700 (PDT)
Subject: [R-sig-Geo] To extract coordinates and NDVI value for each pixel
In-Reply-To: <CAGfc75m=NPZn1Bfo+hjAvu0hOSYDrY6Hw3sV15Oq_32wB_sCew@mail.gmail.com>
References: <1314625427986-6737676.post@n2.nabble.com>
	<CAGfc75m=NPZn1Bfo+hjAvu0hOSYDrY6Hw3sV15Oq_32wB_sCew@mail.gmail.com>
Message-ID: <1316085748950-6796445.post@n2.nabble.com>

Hi
I want to continue a subject that I have not followed due to a trip.
I arrive to obtain the coordinates and the pixel values of my image using
the code proposed by Robert Hijmans. I have 5168101 rows whose some rows
appear on the R console. Thus I receive this  message:
> [getOption ("max.print") is reached - 1268847 lines omitted]]

How can I save the entire matrix to a file (. txt)?
Thank you in advance

Komine

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/To-extract-coordinates-and-NDVI-value-for-each-pixel-tp6737676p6796445.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From gianni.lavaredo at gmail.com  Thu Sep 15 15:02:27 2011
From: gianni.lavaredo at gmail.com (gianni lavaredo)
Date: Thu, 15 Sep 2011 15:02:27 +0200
Subject: [R-sig-Geo] select in a data.frame row with the same value
Message-ID: <CAJ6JbR8Oh154A55AQmy9eP9vx=LjiUHByCOTf5FNH9TcdRbUTA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110915/208bafc5/attachment.pl>

From roman.lustrik at gmail.com  Thu Sep 15 15:10:46 2011
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Thu, 15 Sep 2011 15:10:46 +0200
Subject: [R-sig-Geo] select in a data.frame row with the same value
In-Reply-To: <CAJ6JbR8Oh154A55AQmy9eP9vx=LjiUHByCOTf5FNH9TcdRbUTA@mail.gmail.com>
References: <CAJ6JbR8Oh154A55AQmy9eP9vx=LjiUHByCOTf5FNH9TcdRbUTA@mail.gmail.com>
Message-ID: <CAHT1vpjFiYyBCgzNHo2vD6GW=RK7Z0+jZxd8cnbZncSw5YOL_A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110915/86d0efa2/attachment.pl>

From alobolistas at gmail.com  Thu Sep 15 15:17:30 2011
From: alobolistas at gmail.com (Agustin Lobo)
Date: Thu, 15 Sep 2011 15:17:30 +0200
Subject: [R-sig-Geo] Suggestion: spsample with "stratified" design:
	prescribing nb of points
Message-ID: <CAG4NReLANQi137MP-DwP84bxCPJeqx9Pym2j+4XoVz+wJk8BdQ@mail.gmail.com>

Hi!

I think that the stratified option of spsample() would be more useful
if n could be a vector with the nb of points to
distribute within each polygon. The user could predefine this vector
based on the area of the polygons and other considerations. Any hope
this could be added in future versions?

Thanks

Agus


From mathieu.rajerison at gmail.com  Thu Sep 15 15:54:08 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Thu, 15 Sep 2011 15:54:08 +0200
Subject: [R-sig-Geo] To extract coordinates and NDVI value for each pixel
In-Reply-To: <1316085748950-6796445.post@n2.nabble.com>
References: <1314625427986-6737676.post@n2.nabble.com>
	<CAGfc75m=NPZn1Bfo+hjAvu0hOSYDrY6Hw3sV15Oq_32wB_sCew@mail.gmail.com>
	<1316085748950-6796445.post@n2.nabble.com>
Message-ID: <CAGfc75kV2w-=q4EKyK7onfBYP6E0TrtgtANcXKq_T6qCj-Vw8g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110915/644758e6/attachment.pl>

From roman.lustrik at gmail.com  Thu Sep 15 19:38:33 2011
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Thu, 15 Sep 2011 19:38:33 +0200
Subject: [R-sig-Geo] select in a data.frame row with the same value
In-Reply-To: <CAJ6JbR_HbUVOpQEw5oeUZKJy3E3cfwa1bdMffrEmyWL4DwKzvA@mail.gmail.com>
References: <CAJ6JbR8Oh154A55AQmy9eP9vx=LjiUHByCOTf5FNH9TcdRbUTA@mail.gmail.com>
	<CAHT1vpjFiYyBCgzNHo2vD6GW=RK7Z0+jZxd8cnbZncSw5YOL_A@mail.gmail.com>
	<CAJ6JbR_HbUVOpQEw5oeUZKJy3E3cfwa1bdMffrEmyWL4DwKzvA@mail.gmail.com>
Message-ID: <CAHT1vpiRXyA-5GgOPYHm-dO+a0A0-4Ee7GO1VJ5MyLj-i676Lw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110915/42f94756/attachment.pl>

From momadou at yahoo.fr  Thu Sep 15 20:05:11 2011
From: momadou at yahoo.fr (Komine)
Date: Thu, 15 Sep 2011 11:05:11 -0700 (PDT)
Subject: [R-sig-Geo] To extract coordinates and NDVI value for each pixel
In-Reply-To: <CAGfc75kV2w-=q4EKyK7onfBYP6E0TrtgtANcXKq_T6qCj-Vw8g@mail.gmail.com>
References: <1314625427986-6737676.post@n2.nabble.com>
	<CAGfc75m=NPZn1Bfo+hjAvu0hOSYDrY6Hw3sV15Oq_32wB_sCew@mail.gmail.com>
	<1316085748950-6796445.post@n2.nabble.com>
	<CAGfc75kV2w-=q4EKyK7onfBYP6E0TrtgtANcXKq_T6qCj-Vw8g@mail.gmail.com>
Message-ID: <1316109911788-6797943.post@n2.nabble.com>

Hi,
Thank you Mathieu for your answer. I tried with write.matrix (MASS) but the
result don't change. I have not all the matrix. I want that all the matrix
appears on the 
console or to save it in a file (.txt). If I try a small Matrix for example
(Mat1[1:5,]) the result is correct but If I use the true size of my matrix
(Mat[1:5168101,] I have not all the matrix 
How can I save the entire matrix to a file (. txt)? 

I used this code:
>library(raster)
>adresse<-"C:\\Users\\Documents\\DISC D\\\Images282"
>a <- raster(adresse)  
>CentreRaster <- rasterToPoints(a)
>PixelColonne <- as.data.frame(CentreRaster)
>PixelColonne <- cbind(PixelColonne,coordonnee =
paste(PixelColonne[,1],PixelColonne[,2],sep=" "))
>colnames(PixelColonne) <-
c("Longitude","Latitude","ValeurPixel","Coordonnees")
>return(PixelColonne)
>}
>Mat1 <- RasterToColonne(adresse) 
>Mat1[1:5168101,] 
>library(MASS)
>write.matrix(Mat1, file = "", sep = " ")

Thank you in advance 
Komine 


--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/To-extract-coordinates-and-NDVI-value-for-each-pixel-tp6737676p6797943.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From martin21skifond at gmail.com  Thu Sep 15 20:37:21 2011
From: martin21skifond at gmail.com (Martin Lavoie)
Date: Thu, 15 Sep 2011 15:37:21 -0300
Subject: [R-sig-Geo] classes available with "R"
Message-ID: <CAHeNMp4FAta0S+7+BZbo--MmM2EFRjxhYnfxBaJYS+jvXiQa7Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110915/bdce2c56/attachment.pl>

From rflterra at yahoo.com.br  Thu Sep 15 22:00:43 2011
From: rflterra at yahoo.com.br (Rafael Terra)
Date: Thu, 15 Sep 2011 13:00:43 -0700 (PDT)
Subject: [R-sig-Geo] Spatial Hausman Test for Maximum Likelihood estimated
	models
Message-ID: <1316116843.21278.YahooMailNeo@web161911.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110915/a0d31406/attachment.pl>

From tgriffin at uaex.edu  Thu Sep 15 22:53:18 2011
From: tgriffin at uaex.edu (Terry Griffin)
Date: Thu, 15 Sep 2011 15:53:18 -0500 (CDT)
Subject: [R-sig-Geo] Spatial Hausman Test for Maximum Likelihood
	estimated	models
In-Reply-To: <1316116843.21278.YahooMailNeo@web161911.mail.bf1.yahoo.com>
Message-ID: <379fe056-1c3d-49fc-a61d-cb209da05e73@zmail.uaex.edu>



----- Original Message -----
> From: "Rafael Terra" <rflterra at yahoo.com.br>
> To: r-sig-geo at r-project.org
> Sent: Thursday, September 15, 2011 3:00:43 PM
> Subject: [R-sig-Geo] Spatial Hausman Test for Maximum Likelihood estimated	models
> 
> Dear R users,
> 
> 
> I have a Panel data and I've just estimated spatial fixed and random
> effects models by Maximum likelihood using splm library. Having the
> estimates for both models,? now I must decide which one is better.
> I've looked around and I found a Spatial Hausman Test implemented
> under the name of sphtest in R. But I'm not sure you can use? it for
> Maximum likelihood estimated models. Does anyone knows hoe to
> perform this test for ML estimated models? I tried

I am not familiar with the splm library but think if you are attempting to "decide which one is better" then AIC would be the metric of choice

The spatial Hausman test is used to determine if there is significant differences between coefficients from the two models, not necessarily which model is 'best'

> 
> sarre10307<- spml(formula=basic, data=panel0307,
> index=c("GEOCODIG_M","ano"), listw=nlist0307, model ="random",?
> effect =c("individual"),? lag=TRUE, method="eigen",
> spatial.error="none")
> sarfe10307<- spml(formula=basic, data=panel0307,
> index=c("GEOCODIG_M","ano"), listw=nlist0307, model ="within",?
> effect =c("individual"),? lag=TRUE, method="eigen",
> spatial.error="none")
> 
> and then
> test2<-sphtest(sarre10307, sarfe10307)
> Error in if (x$ef.sph == x2$ef.sph) stop("Effects should be
> different") :
> ? argument is of length zero
> 
> My dataset is reasonably large, so I apologize for not making the
> data available so you can reproduce the problem. If? necessary I can
> reduce my dataset and post it.
> 
> Thank you so much!
> Rafael Terra
> PhD Candidate in Economics - Sao Paulo School of Economics
> Sao Paulo, Brazil
> email: rflterra at yahoo.com.br
> 
> 	[[alternative HTML version deleted]]
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From rflterra at yahoo.com.br  Fri Sep 16 02:19:32 2011
From: rflterra at yahoo.com.br (Rafael Terra)
Date: Thu, 15 Sep 2011 17:19:32 -0700 (PDT)
Subject: [R-sig-Geo] Spatial Hausman Test for Maximum Likelihood
	estimated models
In-Reply-To: <1316120549.65492.YahooMailNeo@web161918.mail.bf1.yahoo.com>
References: <1316116843.21278.YahooMailNeo@web161911.mail.bf1.yahoo.com>
	<379fe056-1c3d-49fc-a61d-cb209da05e73@zmail.uaex.edu>
	<1316120549.65492.YahooMailNeo@web161918.mail.bf1.yahoo.com>
Message-ID: <1316132372.18123.YahooMailNeo@web161917.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110915/9d567744/attachment.pl>

From greenberg at ucdavis.edu  Fri Sep 16 03:17:50 2011
From: greenberg at ucdavis.edu (Jonathan Greenberg)
Date: Thu, 15 Sep 2011 18:17:50 -0700
Subject: [R-sig-Geo] Plotting direction vectors from an aspect map
Message-ID: <CABG0rfttM3V7sGhLk4kdo7AxkT3JWK45MZRGhn2PK6Y3QEq_zA@mail.gmail.com>

R-sig-geo'ers:

Given an aspect raster (GDAL-readable), is there a way to plot the
aspect image using arrows representing each cell's direction?  I'm
assuming I have to convert the raster to a set of points -- are there
arrow symbols and, if so, can you rotate them based on some parameter?

Thanks!

--j

-- 
Jonathan A. Greenberg, PhD
Assistant Project Scientist
Center for Spatial Technologies and Remote Sensing (CSTARS)
Department of Land, Air and Water Resources
University of California, Davis
One Shields Avenue
Davis, CA 95616
Phone: 415-763-5476
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307


From dylan.beaudette at gmail.com  Fri Sep 16 04:22:02 2011
From: dylan.beaudette at gmail.com (Dylan Beaudette)
Date: Thu, 15 Sep 2011 19:22:02 -0700
Subject: [R-sig-Geo] Plotting direction vectors from an aspect map
In-Reply-To: <CABG0rfttM3V7sGhLk4kdo7AxkT3JWK45MZRGhn2PK6Y3QEq_zA@mail.gmail.com>
References: <CABG0rfttM3V7sGhLk4kdo7AxkT3JWK45MZRGhn2PK6Y3QEq_zA@mail.gmail.com>
Message-ID: <CAOGWcHLA8-oB6sJHTpVLxczqo_9=3pV9AMJsLJEC5txZ49OBpg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110915/d5516e18/attachment.pl>

From robin50488 at hotmail.com  Fri Sep 16 04:40:49 2011
From: robin50488 at hotmail.com (=?big5?B?s68gpcOwtg==?=)
Date: Fri, 16 Sep 2011 02:40:49 +0000
Subject: [R-sig-Geo] problem for installing "rgdal" package in r
In-Reply-To: <CAJOp35k_Fa_fEH=U2FenvHE5jS7vSMWvB7rpqwtv6VtXah48-g@mail.gmail.com>
References: <SNT123-W582B9DD86DDCC93F363E0E861C0@phx.gbl>,
	<CAJOp35k_Fa_fEH=U2FenvHE5jS7vSMWvB7rpqwtv6VtXah48-g@mail.gmail.com>
Message-ID: <SNT123-W2530EAE01396460AEE7B7186060@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110916/8aa73094/attachment.pl>

From r.hijmans at gmail.com  Fri Sep 16 05:06:54 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 15 Sep 2011 20:06:54 -0700
Subject: [R-sig-Geo] Plotting direction vectors from an aspect map
In-Reply-To: <CABG0rfttM3V7sGhLk4kdo7AxkT3JWK45MZRGhn2PK6Y3QEq_zA@mail.gmail.com>
References: <CABG0rfttM3V7sGhLk4kdo7AxkT3JWK45MZRGhn2PK6Y3QEq_zA@mail.gmail.com>
Message-ID: <CANtt_hwg7c-M7-u0hPxqG-6SpEsD4CA+X8bWRN7y4n9dAypdcA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110915/ec12b5bc/attachment.pl>

From j.leonpatino at uq.edu.au  Fri Sep 16 08:45:27 2011
From: j.leonpatino at uq.edu.au (Javier Leon Patino)
Date: Fri, 16 Sep 2011 16:45:27 +1000
Subject: [R-sig-Geo] singular model fit
References: <D8457815528063439E5066EE2475CF1C0A4B7EC37C@UQEXMB04.soe.uq.edu.au>
	<4E71B199.5080705@uni-muenster.de>   
Message-ID: <D8457815528063439E5066EE2475CF1C0A4B7EC3C8@UQEXMB04.soe.uq.edu.au>

Thanks for answering. 

I have added points at shorter distances to my dataset. Now I can observe a hole effect in the variogram (periodicity due to elevation coming from 1 mountain I suppose). I can fit a variogram on residuals from a linear regression nicely and even fit a gaussian variogram in ln_depth. However, if I try to fit other models the sofware wont converge. 

How can I get around this issue? Does it make sense to limit the range or psill? I can send the new dataset if requested... 

Thanks for your help.

Javier    


From bart at njn.nl  Fri Sep 16 12:08:15 2011
From: bart at njn.nl (bart)
Date: Fri, 16 Sep 2011 12:08:15 +0200
Subject: [R-sig-Geo] Plotting direction vectors from an aspect map
In-Reply-To: <CAOGWcHLA8-oB6sJHTpVLxczqo_9=3pV9AMJsLJEC5txZ49OBpg@mail.gmail.com>
References: <CABG0rfttM3V7sGhLk4kdo7AxkT3JWK45MZRGhn2PK6Y3QEq_zA@mail.gmail.com>
	<CAOGWcHLA8-oB6sJHTpVLxczqo_9=3pV9AMJsLJEC5txZ49OBpg@mail.gmail.com>
Message-ID: <4E73200F.1020404@njn.nl>

For doing this within R also have a look at ggplot2, with a simple sin 
and cos one could use geom_segment

http://had.co.nz/ggplot2/geom_segment.html

Bart

On 09/16/2011 04:22 AM, Dylan Beaudette wrote:
> This comes to mind:
>
> http://casoilresource.lawr.ucdavis.edu/drupal/node/989
>
> Note shameless self promotion.
>
> Dylan
> On Sep 15, 2011 6:19 PM, "Jonathan Greenberg"<greenberg at ucdavis.edu>  wrote:
>> R-sig-geo'ers:
>>
>> Given an aspect raster (GDAL-readable), is there a way to plot the
>> aspect image using arrows representing each cell's direction? I'm
>> assuming I have to convert the raster to a set of points -- are there
>> arrow symbols and, if so, can you rotate them based on some parameter?
>>
>> Thanks!
>>
>> --j
>>
>> --
>> Jonathan A. Greenberg, PhD
>> Assistant Project Scientist
>> Center for Spatial Technologies and Remote Sensing (CSTARS)
>> Department of Land, Air and Water Resources
>> University of California, Davis
>> One Shields Avenue
>> Davis, CA 95616
>> Phone: 415-763-5476
>> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From carson.farmer at gmail.com  Fri Sep 16 12:48:51 2011
From: carson.farmer at gmail.com (Carson Farmer)
Date: Fri, 16 Sep 2011 11:48:51 +0100
Subject: [R-sig-Geo] Plotting direction vectors from an aspect map
In-Reply-To: <CABG0rfttM3V7sGhLk4kdo7AxkT3JWK45MZRGhn2PK6Y3QEq_zA@mail.gmail.com>
References: <CABG0rfttM3V7sGhLk4kdo7AxkT3JWK45MZRGhn2PK6Y3QEq_zA@mail.gmail.com>
Message-ID: <CADB6tZvdaSquiW387k0D=mPBdQCyBipV3cdLwyRoQDF4djHteA@mail.gmail.com>

I've done something similar for my own work (based on polygon
centroids, but the idea is the same). The following (messy) code
should do what you want using base graphics. The inputs are the
coordinates of your cell centers, the angles of your arrows, and then
a few additional parameters which control size and shape etc.

Hope it can be of some use?

Carson

point.arrows <- function (coords, angles, size = 0.08, arrow = FALSE,
                          length=0.05, point = FALSE, point.col=NULL, ...)
{
    is.xy <- (is.list(coords) && all(c("x", "y") %in% names(coords)))
    xy <- if (is.xy) {
        coords
    }
    else xy.coords(coords[,1], coords[,2])
    x <- xy$x
    y <- xy$y
    n <- length(x)

    if (point) points(x, y, col=point.col, ...)
    ppin <- par("pin")
    pusr <- par("usr")

    if (length(size) == n)
        sizes <- size/max(size)
    else
        sizes <- size[1]

    xr <- sizes * abs(pusr[2L] - pusr[1L])/ppin[1L]
    yr <- sizes * abs(pusr[4L] - pusr[3L])/ppin[2L]
    z <- numeric()
    deg <- angles
    if (arrow)
        arrows(x, y, x + xr * sin(deg), y + yr * cos(deg), length, ...)
    else
        segments(x, y, x + xr * sin(deg), y + yr * cos(deg), ...)
}

On Fri, Sep 16, 2011 at 2:17 AM, Jonathan Greenberg
<greenberg at ucdavis.edu> wrote:
> R-sig-geo'ers:
>
> Given an aspect raster (GDAL-readable), is there a way to plot the
> aspect image using arrows representing each cell's direction? ?I'm
> assuming I have to convert the raster to a set of points -- are there
> arrow symbols and, if so, can you rotate them based on some parameter?
>
> Thanks!
>
> --j
>
> --
> Jonathan A. Greenberg, PhD
> Assistant Project Scientist
> Center for Spatial Technologies and Remote Sensing (CSTARS)
> Department of Land, Air and Water Resources
> University of California, Davis
> One Shields Avenue
> Davis, CA 95616
> Phone: 415-763-5476
> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Carson J. Q. Farmer
ISSP Doctoral Fellow
National Centre for Geocomputation
National University of Ireland, Maynooth,
http://www.carsonfarmer.com/


From mathieu.rajerison at gmail.com  Fri Sep 16 14:11:00 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Fri, 16 Sep 2011 14:11:00 +0200
Subject: [R-sig-Geo] [raster] a railroad,
	a raster with a different value on each side of it
Message-ID: <CAGfc75maof=tSH594hOg+GtJVzYvWiVv1j4ntZ-6zhPbotEruA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110916/c17821ce/attachment.pl>

From godina at dal.ca  Fri Sep 16 16:42:45 2011
From: godina at dal.ca (GodinA)
Date: Fri, 16 Sep 2011 07:42:45 -0700 (PDT)
Subject: [R-sig-Geo] Converting spatialPointsDataFrame into ppp
In-Reply-To: <200805080909.m4899Tmh013420@smtp.upm.es>
References: <4822BD6E.8000906@ija.csic.es>
	<200805080909.m4899Tmh013420@smtp.upm.es>
Message-ID: <1316184165450-6801137.post@n2.nabble.com>

Dear all,

I am new to spatial and point process analysis (as well as R), however most
of my Ph.D. will rely heavily on these tools *sighs :) I am starting a new
chapter where I intend to model elasmobranch i.e., shark and skate catch in
the Northwest Atlantic Canadian waters using point process modeling. I am
interested in investigating the spatial, temporal, and space?time clustering
of catch events conditioned upon the distribution of fishing locations. 

I have been following the R-sig-geo mails and found many great reading
suggestions, which were very helpful! Thank you. I would like to do some
exploratory data analysis on a small subset of my database i.e., solely
shark catch for the year 2009 (546 observations), but I am running (not
surprisingly) into errors and warnings!

Would be grateful to anyone's help!
I am trying to convert my SpatialPointsDataFrame into a ppp. Right now, I
would just like to make a ppp with "catch" as a mark (this is the catch size
in kg).

> class(SHK09)
[1] "SpatialPointsDataFrame"
attr(,"package")
[1] "sp"

#SHK09 looks as follow
> head(as.data.frame(SHK09))
  year month day tripID setID gear NAFO     x      y kept discard fmonth
fgear
1 2009     8  17    345    16    5   22 55.41 -58.46    0     227    Aug   
GN
2 2009     2   1      3     2    1   23 52.36 -51.24    0     450    Feb   
OT
3 2009     7  28    296     4    5    9 68.37 -59.34    0     250    Jul   
GN
4 2009     9   5    339    29    5    9 68.27 -59.53    0      10    Sep   
GN
5 2009     8  28    316    44    5    9 68.38 -64.36    0    1400    Aug   
GN
6 2009     9   1    316    49    5    9 69.26 -64.50    0     200    Sep   
GN
      fNAFO        t.spp.name t.spp.category         elasmo.name
elasmo.category
1        2H GREENLAND HALIBUT              0 SHARKS,DOGFISH (NS)              
1
2        2J GREENLAND HALIBUT              0     SHARK,GREENLAND              
1
3 BaffinIsd GREENLAND HALIBUT              0     SHARK,GREENLAND              
1
4 BaffinIsd GREENLAND HALIBUT              0     SHARK,GREENLAND              
1
5 BaffinIsd GREENLAND HALIBUT              0     SHARK,GREENLAND              
1
6 BaffinIsd GREENLAND HALIBUT              0     SHARK,GREENLAND              
1
  catch logcatch
1   227 5.429346
2   450 6.111467
3   250 5.525453
4    10 2.397895
5  1400 7.244942
6   200 5.303305

#I tried to do the following as suggested by prior email, however, I get
this following error message
>coordinates(SHK09) = ~x+y
Error in `coordinates<-`(`*tmp*`, value = ~x + y) : 
  setting coordinates cannot be done on Spatial objects, where they have
already been set

#so decided to proceed as follow
>catch <- as(SHK09["catch"], "ppp")
Error in as(SHK09["catch"], "ppp") : 
  no method or default for coercing "SpatialPointsDataFrame" to "ppp"

Ideas?
Thank you very much in advance!

~~Aurelie

Aurelie Cosandey-Godin
Ph.D. Candidate, Department of Biology, Dalhousie University
Industrial Graduate Fellow, WWF-Canada
Email: godina at dal.ca | Web: wormlab.biology.dal.ca
-----------------------------------------------------------------------------------------------------
Want to learn more about sharks in Atlantic Canada? Visit ShARCC!
www.atlanticsharks.org





--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Converting-spatialPointsDataFrame-into-ppp-tp2764866p6801137.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Roger.Bivand at nhh.no  Fri Sep 16 17:30:47 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 16 Sep 2011 17:30:47 +0200 (CEST)
Subject: [R-sig-Geo] Converting spatialPointsDataFrame into ppp
In-Reply-To: <1316184165450-6801137.post@n2.nabble.com>
References: <4822BD6E.8000906@ija.csic.es>
	<200805080909.m4899Tmh013420@smtp.upm.es>
	<1316184165450-6801137.post@n2.nabble.com>
Message-ID: <alpine.LRH.2.00.1109161724550.27774@reclus.nhh.no>

On Fri, 16 Sep 2011, GodinA wrote:

> Dear all,
>
> I am new to spatial and point process analysis (as well as R), however most
> of my Ph.D. will rely heavily on these tools *sighs :) I am starting a new
> chapter where I intend to model elasmobranch i.e., shark and skate catch in
> the Northwest Atlantic Canadian waters using point process modeling. I am
> interested in investigating the spatial, temporal, and space?time clustering
> of catch events conditioned upon the distribution of fishing locations. 
>
> I have been following the R-sig-geo mails and found many great reading
> suggestions, which were very helpful! Thank you. I would like to do some
> exploratory data analysis on a small subset of my database i.e., solely
> shark catch for the year 2009 (546 observations), but I am running (not
> surprisingly) into errors and warnings!
>
> Would be grateful to anyone's help!
> I am trying to convert my SpatialPointsDataFrame into a ppp. Right now, I
> would just like to make a ppp with "catch" as a mark (this is the catch size
> in kg).
>
>> class(SHK09)
> [1] "SpatialPointsDataFrame"
> attr(,"package")
> [1] "sp"
>
> #SHK09 looks as follow
>> head(as.data.frame(SHK09))
>  year month day tripID setID gear NAFO     x      y kept discard fmonth
> fgear
> 1 2009     8  17    345    16    5   22 55.41 -58.46    0     227    Aug 
> GN
> 2 2009     2   1      3     2    1   23 52.36 -51.24    0     450    Feb 
> OT
> 3 2009     7  28    296     4    5    9 68.37 -59.34    0     250    Jul 
> GN
> 4 2009     9   5    339    29    5    9 68.27 -59.53    0      10    Sep 
> GN
> 5 2009     8  28    316    44    5    9 68.38 -64.36    0    1400    Aug 
> GN
> 6 2009     9   1    316    49    5    9 69.26 -64.50    0     200    Sep 
> GN
>      fNAFO        t.spp.name t.spp.category         elasmo.name
> elasmo.category
> 1        2H GREENLAND HALIBUT              0 SHARKS,DOGFISH (NS) 
> 1
> 2        2J GREENLAND HALIBUT              0     SHARK,GREENLAND 
> 1
> 3 BaffinIsd GREENLAND HALIBUT              0     SHARK,GREENLAND 
> 1
> 4 BaffinIsd GREENLAND HALIBUT              0     SHARK,GREENLAND 
> 1
> 5 BaffinIsd GREENLAND HALIBUT              0     SHARK,GREENLAND 
> 1
> 6 BaffinIsd GREENLAND HALIBUT              0     SHARK,GREENLAND 
> 1
>  catch logcatch
> 1   227 5.429346
> 2   450 6.111467
> 3   250 5.525453
> 4    10 2.397895
> 5  1400 7.244942
> 6   200 5.303305
>
> #I tried to do the following as suggested by prior email, however, I get
> this following error message
>> coordinates(SHK09) = ~x+y
> Error in `coordinates<-`(`*tmp*`, value = ~x + y) :
>  setting coordinates cannot be done on Spatial objects, where they have
> already been set

Well, that is what you would expect.

>
> #so decided to proceed as follow
>> catch <- as(SHK09["catch"], "ppp")
> Error in as(SHK09["catch"], "ppp") :
>  no method or default for coercing "SpatialPointsDataFrame" to "ppp"
>

Did you look at the vignette for the spatstat package about handling 
shapefiles? You would note that you need the maptools package, which also 
contains the as() coercion functions. They are there, rather than in sp or 
spatstat, to try to avoid unwanted dependencies between packages.

However, I doubt whether your data are a marked point process - the catch 
positions were decided by someone, not, say, the fish? Have you thought of 
trying the bubble() function in sp?

Roger

> Ideas?
> Thank you very much in advance!
>
> ~~Aurelie
>
> Aurelie Cosandey-Godin
> Ph.D. Candidate, Department of Biology, Dalhousie University
> Industrial Graduate Fellow, WWF-Canada
> Email: godina at dal.ca | Web: wormlab.biology.dal.ca
> -----------------------------------------------------------------------------------------------------
> Want to learn more about sharks in Atlantic Canada? Visit ShARCC!
> www.atlanticsharks.org
>
>
>
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Converting-spatialPointsDataFrame-into-ppp-tp2764866p6801137.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From b.rowlingson at lancaster.ac.uk  Fri Sep 16 17:51:13 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Fri, 16 Sep 2011 16:51:13 +0100
Subject: [R-sig-Geo] [raster] a railroad,
 a raster with a different value on each side of it
In-Reply-To: <CAGfc75maof=tSH594hOg+GtJVzYvWiVv1j4ntZ-6zhPbotEruA@mail.gmail.com>
References: <CAGfc75maof=tSH594hOg+GtJVzYvWiVv1j4ntZ-6zhPbotEruA@mail.gmail.com>
Message-ID: <CANVKczPmTriOTGEcwsgtiBPN2_jun_yr6-6wUagR=GyK5_k5Gg@mail.gmail.com>

If your railroad is just a single line feature running approx N-S then:

 Create a box polygon for your study area, make sure the railroad just
crosses it at N and S edges

 Use rgeos functions overlaying the RR line with the box polygon to
create the E and W polygons

 Job done?

On Fri, Sep 16, 2011 at 1:11 PM, Mathieu Rajerison
<mathieu.rajerison at gmail.com> wrote:
> Hi List,
>
>
> I've got a railroad shapefile and a corine land cover raster.
>
> I'd like to perform a land cover comparative analysis between the west side
> of the railroad and the right side.
>
> To do that, I tried first to have a raster with values=1 when on the east
> and 0 when on the west.
> But my calculation is very slow.
>
> Maybe anyone has a better idea on how to accomplish that?
>
> Here is the code, for the moment:
>
> #* *I create a raster of the same extent and resolution as the corine land
> cover raster
>> track.r <- raster(extent(clc.ov))
>> res(track.r) <- res(clc.ov)
>
> # I rasterize it
>> track.r <- rasterize(track, track.r)
>
> # I extract the row-col pairs of cells with value 1
>> rowCol <- rowColFromCell(track.r, which(track.r[]==1))
>
> # I give the value 1 to each cell which col number is > to that of the
> rasterized line cell and of same row
>> for (i in seq(1,length(rowCol))) {
> ?track.r[rowCol[i,1], rowCol[i,2]:ncols] <- 1
> }
> # too slow.....
>
>
> Any help would be greatly appreciated,
>
> Mathieu
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
blog: http://geospaced.blogspot.com/
web: http://www.maths.lancs.ac.uk/~rowlings
web: http://www.rowlingson.com/
twitter: http://twitter.com/geospacedman
pics: http://www.flickr.com/photos/spacedman


From b.rowlingson at lancaster.ac.uk  Fri Sep 16 18:59:32 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Fri, 16 Sep 2011 17:59:32 +0100
Subject: [R-sig-Geo] [raster] a railroad,
 a raster with a different value on each side of it
In-Reply-To: <CANVKczPmTriOTGEcwsgtiBPN2_jun_yr6-6wUagR=GyK5_k5Gg@mail.gmail.com>
References: <CAGfc75maof=tSH594hOg+GtJVzYvWiVv1j4ntZ-6zhPbotEruA@mail.gmail.com>
	<CANVKczPmTriOTGEcwsgtiBPN2_jun_yr6-6wUagR=GyK5_k5Gg@mail.gmail.com>
Message-ID: <CANVKczNy+9WCDveZwxhPF2ybug1mySeVxdj192tv5Sga9jo4eg@mail.gmail.com>

On Fri, Sep 16, 2011 at 4:51 PM, Barry Rowlingson
<b.rowlingson at lancaster.ac.uk> wrote:
> If your railroad is just a single line feature running approx N-S then:
>
> ?Create a box polygon for your study area, make sure the railroad just
> crosses it at N and S edges
>
> ?Use rgeos functions overlaying the RR line with the box polygon to
> create the E and W polygons

 Actually you dont even need rgeos...

 If your RR goes from the S edge of a rectangular study region to the
N edge, and is a single line, then your W and E polygons are then:

bottom left corner, intersection point of RR with S edge, RR points,
intersection point of RR with N edge, top left corner

bottom right corner, intersection point of RR with S edge, RR points,
intersection point of RR with N edge, top right corner

 - in other words you just trace along the bounding rectangle and the
RR. Get the RR coords from the SpatialLines* object and you're pretty
much set to make polygons out of it. Once you have the polygons you
can overlay them on rasters. Should be pretty quick.

Barry


From pbeck at whrc.org  Fri Sep 16 19:01:10 2011
From: pbeck at whrc.org (Pieter Beck)
Date: Fri, 16 Sep 2011 13:01:10 -0400
Subject: [R-sig-Geo] projectRaster, MAJORITY method, rather than ngb?
Message-ID: <002001cc7492$3bfd6050$b3f820f0$@org>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110916/34aeb3ea/attachment.pl>

From Greg.Snow at imail.org  Fri Sep 16 19:21:48 2011
From: Greg.Snow at imail.org (Greg Snow)
Date: Fri, 16 Sep 2011 11:21:48 -0600
Subject: [R-sig-Geo] Plotting direction vectors from an aspect map
In-Reply-To: <CABG0rfttM3V7sGhLk4kdo7AxkT3JWK45MZRGhn2PK6Y3QEq_zA@mail.gmail.com>
References: <CABG0rfttM3V7sGhLk4kdo7AxkT3JWK45MZRGhn2PK6Y3QEq_zA@mail.gmail.com>
Message-ID: <B37C0A15B8FB3C468B5BC7EBC7DA14CC63537DE7D7@LP-EXMBVS10.CO.IHC.COM>

For adding arrows, look at the my.symbols and ms.arrows functions in the TeachingDemos package.

-- 
Gregory (Greg) L. Snow Ph.D.
Statistical Data Center
Intermountain Healthcare
greg.snow at imail.org
801.408.8111


> -----Original Message-----
> From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-
> project.org] On Behalf Of Jonathan Greenberg
> Sent: Thursday, September 15, 2011 7:18 PM
> To: r-sig-geo
> Subject: [R-sig-Geo] Plotting direction vectors from an aspect map
> 
> R-sig-geo'ers:
> 
> Given an aspect raster (GDAL-readable), is there a way to plot the
> aspect image using arrows representing each cell's direction?  I'm
> assuming I have to convert the raster to a set of points -- are there
> arrow symbols and, if so, can you rotate them based on some parameter?
> 
> Thanks!
> 
> --j
> 
> --
> Jonathan A. Greenberg, PhD
> Assistant Project Scientist
> Center for Spatial Technologies and Remote Sensing (CSTARS)
> Department of Land, Air and Water Resources
> University of California, Davis
> One Shields Avenue
> Davis, CA 95616
> Phone: 415-763-5476
> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From tim.appelhans at gmail.com  Fri Sep 16 19:43:20 2011
From: tim.appelhans at gmail.com (Tim Appelhans)
Date: Fri, 16 Sep 2011 19:43:20 +0200
Subject: [R-sig-Geo] Plotting direction vectors from an aspect map
In-Reply-To: <B37C0A15B8FB3C468B5BC7EBC7DA14CC63537DE7D7@LP-EXMBVS10.CO.IHC.COM>
References: <CABG0rfttM3V7sGhLk4kdo7AxkT3JWK45MZRGhn2PK6Y3QEq_zA@mail.gmail.com>
	<B37C0A15B8FB3C468B5BC7EBC7DA14CC63537DE7D7@LP-EXMBVS10.CO.IHC.COM>
Message-ID: <4E738AB8.1020108@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110916/e0613c30/attachment.pl>

From a.mosnier at gmail.com  Fri Sep 16 21:58:47 2011
From: a.mosnier at gmail.com (Arnaud Mosnier)
Date: Fri, 16 Sep 2011 15:58:47 -0400
Subject: [R-sig-Geo] Jenks classification for raster representation
Message-ID: <CANkFkEcOyanYBMW=nZ6udkVZzkYeUe0YUsU3C5Ez6Q0ZiUwa4Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110916/3c6be007/attachment.pl>

From jacobvanetten at yahoo.com  Fri Sep 16 22:32:43 2011
From: jacobvanetten at yahoo.com (Jacob van Etten)
Date: Fri, 16 Sep 2011 21:32:43 +0100 (BST)
Subject: [R-sig-Geo] projectRaster, MAJORITY method, rather than ngb?
In-Reply-To: <002001cc7492$3bfd6050$b3f820f0$@org>
References: <002001cc7492$3bfd6050$b3f820f0$@org>
Message-ID: <1316205163.7702.YahooMailNeo@web29703.mail.ird.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110916/9ebe32ec/attachment.pl>

From jacobvanetten at yahoo.com  Fri Sep 16 22:38:19 2011
From: jacobvanetten at yahoo.com (Jacob van Etten)
Date: Fri, 16 Sep 2011 21:38:19 +0100
Subject: [R-sig-Geo] [raster] a railroad,
	a raster with a different value on each side of it
In-Reply-To: <CANVKczPmTriOTGEcwsgtiBPN2_jun_yr6-6wUagR=GyK5_k5Gg@mail.gmail.com>
References: <CAGfc75maof=tSH594hOg+GtJVzYvWiVv1j4ntZ-6zhPbotEruA@mail.gmail.com>
	<CANVKczPmTriOTGEcwsgtiBPN2_jun_yr6-6wUagR=GyK5_k5Gg@mail.gmail.com>
Message-ID: <1316205499.19045.YahooMailNeo@web29712.mail.ird.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110916/58c61355/attachment.pl>

From jgrn at illinois.edu  Fri Sep 16 23:29:43 2011
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Fri, 16 Sep 2011 14:29:43 -0700
Subject: [R-sig-Geo] GIS Lecturer position at the University of Illinois at
	Urbana-Champaign
Message-ID: <CABG0rftrsfgXGoTBPSNtAtTYvWp7VoKdwm07pcsFokfyhCKU9Q@mail.gmail.com>

[Colleagues: Please forward this to any interested parties. Thanks!]

The Department of Geography in the School of Earth, Society and
Environment at the University of Illinois at Urbana-Champaign is
looking for a Lecturer to fill a key teaching position in our
Geographic Information Science curriculum. We seek a dynamic, highly
motivated individual who will contribute substantively to the growth
and development of our GIS programs at the undergraduate and graduate
levels. Primary responsibilities will include teaching classroom-based
and online courses in GIS at introductory and advanced levels and
developing and teaching new online courses for an undergraduate GIS
certificate program. The opportunity to teach non-GIS courses also
exists based on the Lecturer's expertise. Experience with curriculum
development and current GIS technologies will be an asset.

This position requires a PhD degree in Geography or a closely related
field: Applicants with a demonstrated track record of high quality
college- or university-level teaching experience, including online
instruction, are favored. Excellent communication skills and a strong
desire to create new and innovative course materials will enhance an
application.

This position is a 9-month full-time academic appointment (non-tenure
track). Salary is competitive and based on experience. The desired
start date is January 1, 2012, but the timing is negotiable. The
appointment will initially be for three years, reviewable each year,
and renewable thereafter contingent on funding and strong performance
reviews.

To apply, create your candidate profile through
http://jobs.illinois.edu and upload your application materials: a
letter of application, including a concise statement of curriculum
development and teaching experience; CV (including phone number);
contact information for three professional references; and teaching
evaluations, if available. Referees will be contacted electronically
upon submission of the application. In order to ensure full
consideration, applications must be received by October 15, 2011. The
department highly recommends that complete applications be submitted
early to ensure that letter of recommendation writers have enough time
to submit their letters by the letter of reference deadline of October
22, 2011. Only electronic applications will be accepted. Applicants
may be interviewed before the closing date; however, no hiring
decision will be made until after that date.

Please contact Susan Etter, etter1 at illinois.edu or 217-333-1880 if you
have questions.

Illinois is an Affirmative Action /Equal Opportunity Employer and
welcomes individuals with diverse backgrounds, experiences, and ideas
who embrace and value diversity and inclusivity.
(www.inclusiveillinois.illinois.edu)


From r.hijmans at gmail.com  Sat Sep 17 00:10:08 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Fri, 16 Sep 2011 15:10:08 -0700
Subject: [R-sig-Geo] projectRaster, MAJORITY method, rather than ngb?
In-Reply-To: <1316205163.7702.YahooMailNeo@web29703.mail.ird.yahoo.com>
References: <002001cc7492$3bfd6050$b3f820f0$@org>
	<1316205163.7702.YahooMailNeo@web29703.mail.ird.yahoo.com>
Message-ID: <CANtt_hz+zrVGTn1F5=M9X7PUmNduzS0+a3knE+Th8-0N=gExfg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110916/e4ad4315/attachment.pl>

From jgrn at illinois.edu  Sat Sep 17 03:21:00 2011
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Fri, 16 Sep 2011 18:21:00 -0700
Subject: [R-sig-Geo] Sending raster:::aggregate a function with multiple
	parameters?
Message-ID: <CABG0rfuKequSKxK9XTQG6kZkptG+Z9=zuoyA=s2fSmtoib5Wmg@mail.gmail.com>

R-sig-geo'ers:

I wanted to run aggregate on a *degree* based azimuth image, with a
"circ.mean" resampling.  Since you can't just average degrees and get
the right answer (e.g. the arithmetic mean of 359 degrees and 1
degrees is 180, but the "true" mean direction is 0), I adapted the
circ.mean function in CircStats to be used with aggregate.  My
question is, I'd like to be able to pass a "unit" argument to the
function, but I'm not sure how to do this.  Here's the code:

require(raster)
require(CircStats)
# require(STARStools)
# (Swap in some DEM for the following call, or download STARStools 0.4
or later from r-forge):
tahoe_lidar_bareearth <-
raster(system.file("external/tahoe_lidar_bareearth.tif",
package="STARStools"))
azimuth_raster <-
slopeAspect(tahoe_lidar_bareearth,out=c('aspect'),unit='degrees')

# Here is the adapted circ.mean function that adds na.rm and a "unit" field:

circ.mean.na.rm = function(x,unit="radians",na.rm=TRUE)
{	
	if(unit=="degrees")
	{
		x=rad(x)
	}
	
	if(na.rm)
	{
		x_mean=circ.mean(na.omit(x))
	} else
	{
		x_mean=circ.mean(x)
	}
	
	if(unit=="degrees")
	{
		x_mean=deg(x_mean)
	}
	return(x_mean)
}

# How do I now pass a unit argument to aggregate?
azimuth_raster_agg=aggregate(x=azimuth_raster,fact=fact,fun=circ.mean.na.rm)
# This call returns the wrong value, because I haven't passed "unit"
to circ.mean.na.rm() -- how do I do this from within aggregate?

--j


From rflterra at yahoo.com.br  Sun Sep 18 01:16:51 2011
From: rflterra at yahoo.com.br (Rafael Terra)
Date: Sat, 17 Sep 2011 16:16:51 -0700 (PDT)
Subject: [R-sig-Geo] write estimates to Excel
Message-ID: <1316301411.99438.YahooMailNeo@web161920.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110917/d676af5a/attachment.pl>

From tarabridwell at gmail.com  Sun Sep 18 01:48:35 2011
From: tarabridwell at gmail.com (Tara Bridwell)
Date: Sat, 17 Sep 2011 16:48:35 -0700
Subject: [R-sig-Geo] Adding values to a raster
Message-ID: <CAELQJc3Zy-+N-gpY=CnkU25gMGiBCtfPEuVMieEa8GfOzYfzSA@mail.gmail.com>

I have a dataset that consists of point coordinates and values
associated with the points.? I want to be able to grid the values, and
then do calulations using the values using the various raster
functions.? I am, however, finding this difficult to do.? I have tried
a number of functions including rasterize, SpatialGridDataFrame, and
SpatialGridDataFrame but I think I am missing a bit of the theory
behind this that I can't seem to piece together. I have the Applied
Spatial Data Analysis (Bivand) but couldn't seem to find an
appropriate section.? Here is an example data set:

require(raster)

r <- raster(ncol=10, nrow=10)

r[]=1:ncell(r)

x <- c(-45, 30, 20, -10, 50, -7)

y <- c(-25, -148, 46, 23, 0, -69)

value <- c(1, 2, 3, 4, 5, 6)

coord.plus.value <- cbind(x, y, value)

coord.plus.value_sp <- SpatialPoints(coord.plus.value)

>From here I want to plot 'value' using the raster 'r'.

Suggests on how to do this, as well as thoughts on the basic theory I
seem to be missing (or where in the Bivand book I should be reading
that I have missed) would be appreciated.

Thank you,

Tara Bridwell


From godina at dal.ca  Sun Sep 18 02:16:13 2011
From: godina at dal.ca (GodinA)
Date: Sat, 17 Sep 2011 17:16:13 -0700 (PDT)
Subject: [R-sig-Geo] Converting spatialPointsDataFrame into ppp
In-Reply-To: <alpine.LRH.2.00.1109161724550.27774@reclus.nhh.no>
References: <4822BD6E.8000906@ija.csic.es>
	<200805080909.m4899Tmh013420@smtp.upm.es>
	<1316184165450-6801137.post@n2.nabble.com>
	<alpine.LRH.2.00.1109161724550.27774@reclus.nhh.no>
Message-ID: <1316304973728-6804881.post@n2.nabble.com>

Thank you very much for this quick reply Dr. Bivand.
I am taking good notes of your suggestions.

I'm a little concern about your comments that my data are not a marked point
process and would like to verify with you a few points. You are correct that
my points - the catch positions are essentially fishermen decisions.
However, I am using at-sea observer data, which are (technically) random
sampling of a subset of all fishing effort (usually between 5-15
percent/year, although it varies between years, fisheries, and regions). As
a starting point, I would like to reproduce what Gardner et al. (2008) have
done. [Gardner B, Sullivan PJ, Morreale SJ, Epperly SP. Spatial and temporal
statistical analysis of bycatch data: patterns of sea turtle bycatch in the
North Atlantic. Canadian Journal of Fisheries and Aquatic Sciences.
2008;65(11):2461-2470. Available from:
http://www.nrcresearchpress.com/doi/abs/10.1139/F08-152]. 
However, my data are somewhat more complex since I am dealing with different
fishing gears (over 15 types) over the spend of 15 years (1995-2010). I
would like to go beyond describing the space-time clustering of catch events
and try to model these events to oceanographical variables, such as
temperature and ocean-color derived chlorophyll concentration.

I would be grateful for any of your thoughts, comments, and/or suggestions. 
Thank you very much for your time,

Best,
~~Aurelie




-----
Aurelie Cosandey-Godin
Ph.D. Candidate, Department of Biology
Industrial Graduate Fellow, WWF-Canada

Dalhousie University | Biology Dept. |Halifax, NS, Canada 
Email: godina at dal.ca | Web: wormlab.biology.dal.ca
--------------------------------------------------------------------------
Want to learn more about sharks in Atlantic Canada? Visit ShARCC! www.atlanticsharks.org
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Converting-spatialPointsDataFrame-into-ppp-tp2764866p6804881.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From r.hijmans at gmail.com  Sun Sep 18 02:36:04 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sat, 17 Sep 2011 17:36:04 -0700
Subject: [R-sig-Geo] Adding values to a raster
In-Reply-To: <CAELQJc3Zy-+N-gpY=CnkU25gMGiBCtfPEuVMieEa8GfOzYfzSA@mail.gmail.com>
References: <CAELQJc3Zy-+N-gpY=CnkU25gMGiBCtfPEuVMieEa8GfOzYfzSA@mail.gmail.com>
Message-ID: <CANtt_hwEUHvXAq0349iRYuLmc3TCR7tDVWMty8cZ6u3Ejadfkg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110917/3a112ba2/attachment.pl>

From r.hijmans at gmail.com  Sun Sep 18 02:42:39 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sat, 17 Sep 2011 17:42:39 -0700
Subject: [R-sig-Geo] Jenks classification for raster representation
In-Reply-To: <CANkFkEcOyanYBMW=nZ6udkVZzkYeUe0YUsU3C5Ez6Q0ZiUwa4Q@mail.gmail.com>
References: <CANkFkEcOyanYBMW=nZ6udkVZzkYeUe0YUsU3C5Ez6Q0ZiUwa4Q@mail.gmail.com>
Message-ID: <CANtt_hz-+3U2rkf5eScTYFn-2Hc4XuE5z_r2Em+HM9V-S_8tdg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110917/64be4071/attachment.pl>

From aortizbobea at arec.umd.edu  Sun Sep 18 03:10:13 2011
From: aortizbobea at arec.umd.edu (Ariel Ortiz-Bobea)
Date: Sat, 17 Sep 2011 18:10:13 -0700 (PDT)
Subject: [R-sig-Geo] How to efficiently clip large grids/raster with
	polygons?
Message-ID: <1316308213575-6804923.post@n2.nabble.com>

Hello everyone,

I've been exploring ways to "clip a grid/raster with a polygon/shape file"
in R but what I have seen so far seems more suited for relatively fine grids
and large polygons (e.g. many grids fall within each polygon). 

I'm confronted with a relatively coarse data grid for the US (0.3 deg ~ 32
km) and would like to clip these grids using county boundaries and calculate
mean values for each polygon/county. Basically, many counties will fall "in
between" several grids and so, ideally, I need to calculate a weighted mean
for each polygon by weighting each grid value by the fraction of the polygon
it is covering.

I found a way to do this with the "extract" function in the raster package
using the "weight" option (see example below and ?extract), but it takes
about 60 minutes for one grid/raster layer for all US counties (~ 1
second/county/layer). My problem is that I need to do this for about 30
years * 365 days * 8 daily snapshots = 87,600 layers / variable. Enough to
keep me 8+ years waiting for each variable, and I have about 25 variables to
process...

Do you know a (hopefully way) more efficient way to do this? Thank you in
advance for any guidance!

Ariel

PS: I'm running on a 2.66 GHz core 2 duo iMac / 8 GB RAM / Mac OS X 10.7
(Lion) / R 2.12.2

FILES:
-------
shape file: http://terpconnect.umd.edu/~ortiz/R/US48_rr-fixed.grb (~500KB)
GRIB grid file: http://terpconnect.umd.edu/~ortiz/R/US48_rr-fixed.grb
(~12MB)

CODE:
-------
#used libraries
library(rgdal) 
library(raster)

#setting up data
grid <- readGDAL("US48_rr-fixed.grb")
proj <- CRS(proj4string(fixed))
countyshape0	<- readShapePoly("co99_d00.shp", proj4string =
CRS("+proj=longlat"))
countyshape 	<- spTransform(countyshape0, proj) 
removestate	<- countyshape$STATE %in% c("02","15","72") # leave out Alaska,
Hawai and Puerto Rico
countyshape48	<- countyshape[!removestate,]
rasteredgrid <-raster(grid, 3) # chooses one layer

#visual glimpse:
image(rasteredgrid)
plot(countyshape48, add=TRUE)

#cookie cutting/raster clipping
timer <- proc.time() 	# start the clock
test <- extract(flxraster, countyshape48, weights=TRUE, fun=mean) 
proc.time() - timer 	# stop the clock

-----
Ariel Ortiz-Bobea
PhD Candidate in Agricultural & Resource Economics
University of Maryland - College Park
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/How-to-efficiently-clip-large-grids-raster-with-polygons-tp6804923p6804923.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From tarabridwell at gmail.com  Sun Sep 18 03:11:03 2011
From: tarabridwell at gmail.com (Tara Bridwell)
Date: Sat, 17 Sep 2011 18:11:03 -0700
Subject: [R-sig-Geo] Jenks classification for raster representation
In-Reply-To: <CANtt_hz-+3U2rkf5eScTYFn-2Hc4XuE5z_r2Em+HM9V-S_8tdg@mail.gmail.com>
References: <CANkFkEcOyanYBMW=nZ6udkVZzkYeUe0YUsU3C5Ez6Q0ZiUwa4Q@mail.gmail.com>
	<CANtt_hz-+3U2rkf5eScTYFn-2Hc4XuE5z_r2Em+HM9V-S_8tdg@mail.gmail.com>
Message-ID: <CAELQJc3Bsv5u4meVfQgFiD8EVM-Fq+PZ4ABbmzxXRJQfr-=D3Q@mail.gmail.com>

Thank you Robert.  That worked perfectly.  I had been missing the
proper structure in using the rasterize function.

Tara

On Sat, Sep 17, 2011 at 5:42 PM, Robert J. Hijmans <r.hijmans at gmail.com> wrote:
> Arnaud,
>
> You can (directly) do the same with Raster* objects what Roger did with sp
> objects:
>
> library(raster)
> t<-raster(ncol = 10, nrow = 10)
> t[1:2,] <- seq(1,10,1)
> t[3:5,1:5] <- seq(1,5,1)
> t[6:8,6:10] <- ?seq(6,10,1)
> t[9:10,] <- seq(1,10,1)
> plot(t)
>
> library(classInt)
> zClass <- classIntervals(values(t), n=5,style="jenks")
>
> # image
> image(t, breaks=zClass$brks, col=colorRampPalette(c("red", "yellow"))(5) )
>
> # or spplot
> spplot(t, "values", at=zClass$brks, col.regions=colorRampPalette(c("red",
> "yellow"))(5))
>
> # or plot, after an adjustment to zClass that won't be needed in the future
> (versions > 1.9-13)
> zClass$brks[1] <- zClass$brks[1] - 1
> plot(t, breaks=zClass$brks, col=colorRampPalette(c("red", "yellow"))(5) )
>
>
> # The ?only additional consideration is that classIntervals will fail, or be
> very slow, for very large rasters.
> # To avoid that, you can take a sample:
>
> zClass <- classIntervals(na.omit(sampleRegular(t, 100000)),
> n=5,style="jenks")
> zClass$brks[1] <- zClass$brks[1] - 1
>
> plot(t, breaks=zClass$brks, col=colorRampPalette(c("red", "yellow"))(5))
>
>
> Robert
>
>
> On Fri, Sep 16, 2011 at 12:58 PM, Arnaud Mosnier <a.mosnier at gmail.com>wrote:
>
>> Dear list,
>>
>> In order to allow others benefiting from my errors, see below a
>> presentation
>> of a problem and it's solution by Roger Bivand (Thanks !).
>>
>> ######################################
>>
>> I want to use natural breaks (jenks) method to find class intervals into
>> raster's values in order to plot it with an adapted color range.
>> I know that the package "classInt" allows to do exactly what I want but I
>> do
>> not achieve to use it correctly.
>>
>> Here is a small script that represent my case
>>
>> # here a raster with some NAs
>>
>> library(raster)
>> t<-raster(ncol = 10, nrow = 10)
>> t[1:2,] <- seq(1,10,1)
>> t[3:5,1:5] <- seq(1,5,1)
>> t[6:8,6:10] <- ?seq(6,10,1)
>> t[9:10,] <- seq(1,10,1)
>> plot(t)
>>
>> # Then I tried to use classIntervals and findColours function
>>
>> library(classInt)
>> zClass <- classIntervals(as.data.frame(t)[!is.na(as.data.frame(t))], n=5,
>> style="jenks") ?# I have to remove NAs
>> plot(t, col = findColours(zClass, pal = c("red", "yellow"))) # I do not
>> understand the result both in the plot and in the legend !
>>
>> I would be pleased if you can give me tips about this.
>>
>> ########################################
>>
>> I do not think that the plot method for RasterLayer objects lets you pass a
>> vector of breaks, nor does the image.plot from fields that maybe is the
>> source of the legend. If you do things simply, it works:
>>
>> tSG <- as(t, "SpatialGridDataFrame")
>> spplot(tSG, "values", at=zClass$brks,
>> ?col.regions=colorRampPalette(
>> c("red", "yellow"))(5))
>>
>> or
>>
>> image(tSG, "values", breaks=zClass$brks,
>> ?col=colorRampPalette(c("red", "yellow"))(5))
>>
>> or using graphics::image
>>
>> image(as.image.SpatialGridDataFrame(tSG), breaks=zClass$brks,
>> ?col=colorRampPalette(c("red", "yellow"))(5))
>>
>> I'm a bit unsure about whether the itervals are closed which way.
>>
>> It's up to the raster developers to answer.
>>
>> Roger
>>
>> --
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>> ? ? ? ?[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From r.hijmans at gmail.com  Sun Sep 18 03:19:45 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sat, 17 Sep 2011 18:19:45 -0700
Subject: [R-sig-Geo] [raster] a railroad,
 a raster with a different value on each side of it
In-Reply-To: <1316205499.19045.YahooMailNeo@web29712.mail.ird.yahoo.com>
References: <CAGfc75maof=tSH594hOg+GtJVzYvWiVv1j4ntZ-6zhPbotEruA@mail.gmail.com>
	<CANVKczPmTriOTGEcwsgtiBPN2_jun_yr6-6wUagR=GyK5_k5Gg@mail.gmail.com>
	<1316205499.19045.YahooMailNeo@web29712.mail.ird.yahoo.com>
Message-ID: <CANtt_hwm6L_eS0Hm+b1bYKrjLogiSrEEddR1jf7Qy4SHY5HaPA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110917/357636d7/attachment.pl>

From r.hijmans at gmail.com  Sun Sep 18 04:32:26 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sat, 17 Sep 2011 19:32:26 -0700
Subject: [R-sig-Geo] How to efficiently clip large grids/raster with
	polygons?
In-Reply-To: <1316308213575-6804923.post@n2.nabble.com>
References: <1316308213575-6804923.post@n2.nabble.com>
Message-ID: <CANtt_hz-XYQciu395eU0VUpgPgBKrnxwTC_NsoYZr+1GaZd2Jg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110917/845bb65b/attachment.pl>

From Roger.Bivand at nhh.no  Sun Sep 18 11:06:21 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sun, 18 Sep 2011 11:06:21 +0200 (CEST)
Subject: [R-sig-Geo] Converting spatialPointsDataFrame into ppp
In-Reply-To: <1316304973728-6804881.post@n2.nabble.com>
References: <4822BD6E.8000906@ija.csic.es>
	<200805080909.m4899Tmh013420@smtp.upm.es>
	<1316184165450-6801137.post@n2.nabble.com>
	<alpine.LRH.2.00.1109161724550.27774@reclus.nhh.no>
	<1316304973728-6804881.post@n2.nabble.com>
Message-ID: <alpine.LRH.2.00.1109181049220.1807@reclus.nhh.no>

On Sat, 17 Sep 2011, GodinA wrote:

> Thank you very much for this quick reply Dr. Bivand.
> I am taking good notes of your suggestions.
>
> I'm a little concern about your comments that my data are not a marked point
> process and would like to verify with you a few points. You are correct that
> my points - the catch positions are essentially fishermen decisions.

Are you studying the spatial decisions of the fishermen, that is, is it 
the clustering of catch data in space that is your main concern? You say 
that you have a sample - in general point patterns should be complete, not 
samples, because the sampling process could obscure the underlying spatial 
process.

> However, I am using at-sea observer data, which are (technically) random
> sampling of a subset of all fishing effort (usually between 5-15
> percent/year, although it varies between years, fisheries, and regions). As
> a starting point, I would like to reproduce what Gardner et al. (2008) have
> done. [Gardner B, Sullivan PJ, Morreale SJ, Epperly SP. Spatial and temporal
> statistical analysis of bycatch data: patterns of sea turtle bycatch in the
> North Atlantic. Canadian Journal of Fisheries and Aquatic Sciences.
> 2008;65(11):2461-2470. Available from:
> http://www.nrcresearchpress.com/doi/abs/10.1139/F08-152].

Only for subscribing institutions, I think. The fact that something has 
been published doesn't necessarily make it sensible (I don't have access 
to this case, speaking generally; from the abstract they seem to be 
looking at bycatch spatial patterns using point pattern analysis, the 
abstract doesn't say if they had access to all bycatch data).

> However, my data are somewhat more complex since I am dealing with different
> fishing gears (over 15 types) over the spend of 15 years (1995-2010). I
> would like to go beyond describing the space-time clustering of catch events
> and try to model these events to oceanographical variables, such as
> temperature and ocean-color derived chlorophyll concentration.

This implies inhomogeneity in the spatial process induced by the 
space-time-varying covariates, so is rather ambitious in a point process 
setting. It feels much more like a GLMM or GAMM, not least because the 
paper you cite deals with bycatch (so clustering is arguably not caused by 
the decisions of the fishermen), and you are dealing with catch, which is 
caused by the decisions, and you only have a sample.

I'm not a fisheries person, it just struck me that it didn't seem obvious 
that a marked point process was a helpful representation of your problem. 
I'm sure others on this list have comments and ideas.

Hope this helps,

Roger

>
> I would be grateful for any of your thoughts, comments, and/or suggestions.
> Thank you very much for your time,
>
> Best,
> ~~Aurelie
>
>
>
>
> -----
> Aurelie Cosandey-Godin
> Ph.D. Candidate, Department of Biology
> Industrial Graduate Fellow, WWF-Canada
>
> Dalhousie University | Biology Dept. |Halifax, NS, Canada
> Email: godina at dal.ca | Web: wormlab.biology.dal.ca
> --------------------------------------------------------------------------
> Want to learn more about sharks in Atlantic Canada? Visit ShARCC! www.atlanticsharks.org
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Converting-spatialPointsDataFrame-into-ppp-tp2764866p6804881.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From godina at dal.ca  Sun Sep 18 13:36:36 2011
From: godina at dal.ca (GodinA)
Date: Sun, 18 Sep 2011 04:36:36 -0700 (PDT)
Subject: [R-sig-Geo] Bycatch event as ppp?
In-Reply-To: <alpine.LRH.2.00.1109181049220.1807@reclus.nhh.no>
References: <4822BD6E.8000906@ija.csic.es>
	<200805080909.m4899Tmh013420@smtp.upm.es>
	<1316184165450-6801137.post@n2.nabble.com>
	<alpine.LRH.2.00.1109161724550.27774@reclus.nhh.no>
	<1316304973728-6804881.post@n2.nabble.com>
	<alpine.LRH.2.00.1109181049220.1807@reclus.nhh.no>
Message-ID: <1316345796187-6805571.post@n2.nabble.com>

My mistake, I avoided using the word 'bycatch' to not get into the
definition, but I am actually looking at bycatch events, in other words,
where the presence or absence of nontarget species i.e., shark/skate in the
catch is recorded as a single point for a specific fishing location.
Following Gardner et al. (2008), I would like to test the null hypothesis
that marks (shark/skate captures) are distributed randomly within the non-
random spatial distribution of events (fishing locations). They used a
permutation test, whereby under a series of simulations, the marks were
randomly assigned to event locations (i.e., permuted) to create a series of
distributions that represent complete spatial randomness conditioned upon
the location of the fishing events. I just verified if Gardner et al. (2008)
had all points or 100 percent at-sea observer data, but they didn't (between
3-5%), with the exception of 2 years (100%). In a sense this is their
complete set of point process. However what will be described/model will
undeniably be only what has been observed and potentially far from
describing overall clusters of bycatch events within fishing locations.

Anyone who worked or have experience with fishery data on this mail list is
welcome to join the discussion. 

I am looking for advices on how I (or if I should pursue the idea) can model
bycatch data with point process. Essentially, I know that fishing locations
are not randomly located in space, but I would like to take a similar
approach then Gardner et al. (2008) and compare the known bycatch capture
locations with a simulated set of bycatch captures, which are randomly
located within the known fishing locations. I am using at-sea observer data
(best data available), which often is only 5-15% of all fishing locations,
but this varies over the years, fishery, and regions. I have 15 years of
data (1995-2010).
It doesn't seem that obvious that I can model bycatch event with point
process. I would love to hear people experience, comments, advices, and/or
ideas.

Thank you very much for your time,
Cheers,
~~Aurelie

Gardner B, Sullivan PJ, Morreale SJ, Epperly SP. Spatial and temporal
statistical analysis of bycatch data: patterns of sea turtle bycatch in the
North Atlantic. Canadian Journal of Fisheries and Aquatic Sciences
2008;65(11):2461-2470. Available from:
http://www.nrcresearchpress.com/doi/abs/10.1139/F08-152


-----
Aurelie Cosandey-Godin
Ph.D. Candidate, Department of Biology
Industrial Graduate Fellow, WWF-Canada

Dalhousie University | Biology Dept. |Halifax, NS, Canada 
Email: godina at dal.ca | Web: wormlab.biology.dal.ca
--------------------------------------------------------------------------
Want to learn more about sharks in Atlantic Canada? Visit ShARCC! www.atlanticsharks.org
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Converting-spatialPointsDataFrame-into-ppp-tp2764866p6805571.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From oscar.perpinan at upm.es  Sun Sep 18 18:02:02 2011
From: oscar.perpinan at upm.es (Oscar =?UTF-8?B?UGVycGnDsWFu?= Lamigueiro)
Date: Sun, 18 Sep 2011 18:02:02 +0200
Subject: [R-sig-Geo] Plotting direction vectors from an aspect map
In-Reply-To: <4E738AB8.1020108@gmail.com>
References: <CABG0rfttM3V7sGhLk4kdo7AxkT3JWK45MZRGhn2PK6Y3QEq_zA@mail.gmail.com>
	<B37C0A15B8FB3C468B5BC7EBC7DA14CC63537DE7D7@LP-EXMBVS10.CO.IHC.COM>
	<4E738AB8.1020108@gmail.com>
Message-ID: <20110918180202.5068c8e2@upm.es>

Hi,

I have uploaded a first draft of a vectorplot function in rasterVis. It
is available here:
https://r-forge.r-project.org/scm/viewvc.php/drafts/vectorplot.R?view=markup&root=rastervis.
It uses the raster::slopeAspect function to calculate the slope/aspect
from a raster object. 

For example:

library(raster)
library(rasterVis)

df <- expand.grid(x=seq(-2, 2, .1), y=seq(-2, 2, .1))
df$z <- with(df, (3*x^2 + y)*exp(-x^2-y^2))
r1 <- rasterFromXYZ(df)
df$z <- with(df, x*exp(-x^2-y^2))
r2 <- rasterFromXYZ(df)
df$z <- with(df, y*exp(-x^2-y^2))
r3 <- rasterFromXYZ(df)

projection(r1) <- projection(r2) <- projection(r3) <-
CRS("+proj=longlat +datum=WGS84")

vectorplot(r1, par.settings=RdBuTheme)
vectorplot(r2, par.settings=RdBuTheme)
vectorplot(r3, par.settings=RdBuTheme)

I will include it in the rasterVis package after some tests.

Best,

Oscar.

-------------
Oscar Perpi??n Lamigueiro
Dpto. de Ingenier?a El?ctrica
EUITI-UPM

http://procomun.wordpress.com
> >> >  -----Original Message-----
> >> >  From:r-sig-geo-bounces at r-project.org
> >> > [mailto:r-sig-geo-bounces at r- project.org] On Behalf Of Jonathan
> >> > Greenberg Sent: Thursday, September 15, 2011 7:18 PM
> >> >  To: r-sig-geo
> >> >  Subject: [R-sig-Geo] Plotting direction vectors from an aspect
> >> > map 
> >> >  R-sig-geo'ers:
> >> >  
> >> >  Given an aspect raster (GDAL-readable), is there a way to plot
> >> > the aspect image using arrows representing each cell's
> >> > direction?  I'm assuming I have to convert the raster to a set
> >> > of points -- are there arrow symbols and, if so, can you rotate
> >> > them based on some parameter? 
> >> >  Thanks!
> >> >  
> >> >  --j
> >> >  
> >> >  --
> >> >  Jonathan A. Greenberg, PhD
> >> >  Assistant Project Scientist
> >> >  Center for Spatial Technologies and Remote Sensing (CSTARS)
> >> >  Department of Land, Air and Water Resources
> >> >  University of California, Davis
> >> >  One Shields Avenue
> >> >  Davis, CA 95616
> >> >  Phone: 415-763-5476
> >> >  AIM: jgrn307, MSN:jgrn307 at hotmail.com, Gchat: jgrn307
> >> >  
> >> >  _______________________________________________
> >> >  R-sig-Geo mailing list
> >> >  R-sig-Geo at r-project.org
> >> >  https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 


From aortizbobea at arec.umd.edu  Sun Sep 18 20:35:14 2011
From: aortizbobea at arec.umd.edu (Ariel Ortiz-Bobea)
Date: Sun, 18 Sep 2011 11:35:14 -0700 (PDT)
Subject: [R-sig-Geo] How to efficiently clip large grids/raster with
	polygons?
In-Reply-To: <CANtt_hz-XYQciu395eU0VUpgPgBKrnxwTC_NsoYZr+1GaZd2Jg@mail.gmail.com>
References: <1316308213575-6804923.post@n2.nabble.com>
	<CANtt_hz-XYQciu395eU0VUpgPgBKrnxwTC_NsoYZr+1GaZd2Jg@mail.gmail.com>
Message-ID: <1316370914927-6806329.post@n2.nabble.com>

Thanks Robert,

It works great. It took the same time to clip the RasterStack than the
single RasterLayer. I read your "Introduction to the ?raster? package
(version 1.9-11)" and I found very useful too to understand the different
objects. Thanks for developing this resource!

I wonder about a way to combine several variables (23) and time periods
(~90,000) to efficiently do the polygon clipping on a large
RasterBrick/Stacks. I feel that I need to choose between:

1- performing the clipping on 23 RasterStacks (one for each variable, e.g.
temperature) in which each band corresponds to a time period (90,000 of
them) 

2- performing the clipping on 90,000 RasterStacks (one for each time period,
e.g. 1980/1/1 09:00) in which each band corresponds to a variable (23 of
them).

... and option 1 would be expectedly faster. But, is there a way to combine
both options to do the clipping "ALL at once" of all the time periods and
variables? I read about the "setZ" function for time-tagging layers and the
ability to perform functions for each raster cell over time... but I'm not
sure I can make use of it in this context (stacking 2 time-period layers
doubles my band number... basically, I feel it does not lead to an
additional dimension in the structure of the object).

Any thoughts would be greatly appreciated!

Regards,

Ariel



-----
Ariel Ortiz-Bobea
PhD Candidate in Agricultural & Resource Economics
University of Maryland - College Park
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/How-to-efficiently-clip-large-grids-raster-with-polygons-tp6804923p6806329.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From r.hijmans at gmail.com  Mon Sep 19 05:11:55 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sun, 18 Sep 2011 20:11:55 -0700
Subject: [R-sig-Geo] How to efficiently clip large grids/raster with
	polygons?
In-Reply-To: <1316370914927-6806329.post@n2.nabble.com>
References: <1316308213575-6804923.post@n2.nabble.com>
	<CANtt_hz-XYQciu395eU0VUpgPgBKrnxwTC_NsoYZr+1GaZd2Jg@mail.gmail.com>
	<1316370914927-6806329.post@n2.nabble.com>
Message-ID: <CANtt_hyc+3sdzmVP0jkM5pjnaxW_p7+ikK9YjgJjpbVHotjhzA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110918/8a0d90e5/attachment.pl>

From r.hijmans at gmail.com  Mon Sep 19 05:28:06 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sun, 18 Sep 2011 20:28:06 -0700
Subject: [R-sig-Geo] Sending raster:::aggregate a function with multiple
	parameters?
In-Reply-To: <CABG0rfuKequSKxK9XTQG6kZkptG+Z9=zuoyA=s2fSmtoib5Wmg@mail.gmail.com>
References: <CABG0rfuKequSKxK9XTQG6kZkptG+Z9=zuoyA=s2fSmtoib5Wmg@mail.gmail.com>
Message-ID: <CANtt_hxt+j-VJSF-RHz6_s2dATawn_d2VggTW=M0RJ8jt=NW=g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110918/5bb030fa/attachment.pl>

From paul.hiemstra at knmi.nl  Mon Sep 19 10:49:58 2011
From: paul.hiemstra at knmi.nl (Paul Hiemstra)
Date: Mon, 19 Sep 2011 08:49:58 +0000
Subject: [R-sig-Geo] write estimates to Excel
In-Reply-To: <1316301411.99438.YahooMailNeo@web161920.mail.bf1.yahoo.com>
References: <1316301411.99438.YahooMailNeo@web161920.mail.bf1.yahoo.com>
Message-ID: <4E770236.1030707@knmi.nl>

 On 09/17/2011 11:16 PM, Rafael Terra wrote:
> Dear R users,
>
> Does anyone knows if there is some function to write panel data estimates to an excel file? I know it is possible to write in LaTex form, but at least for now I have to save the results in a spreadsheet.
> Thanks
> Rafael Terra
> PhD candidate in Economics - Sao Paulo School of Economics (FGV)
> email:rflterra at yahoo.com.br
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Hi,

Saving the file as a comma separated file (csv) should be fine for
reading in Excel. See the write.csv function.

good luck,
Paul

-- 
Paul Hiemstra, Ph.D.
Global Climate Division
Royal Netherlands Meteorological Institute (KNMI)
Wilhelminalaan 10 | 3732 GK | De Bilt | Kamer B 3.39
P.O. Box 201 | 3730 AE | De Bilt
tel: +31 30 2206 494

http://intamap.geo.uu.nl/~paul
http://nl.linkedin.com/pub/paul-hiemstra/20/30b/770


From bibiko at eva.mpg.de  Mon Sep 19 11:07:48 2011
From: bibiko at eva.mpg.de (=?iso-8859-1?Q?Hans-J=F6rg_Bibiko?=)
Date: Mon, 19 Sep 2011 11:07:48 +0200
Subject: [R-sig-Geo] write estimates to Excel
In-Reply-To: <4E770236.1030707@knmi.nl>
References: <1316301411.99438.YahooMailNeo@web161920.mail.bf1.yahoo.com>
	<4E770236.1030707@knmi.nl>
Message-ID: <3D57CE21-103B-4520-AF9D-F3EB3FE2D34C@eva.mpg.de>


On 19 Sep 2011, at 10:49, Paul Hiemstra wrote:

> On 09/17/2011 11:16 PM, Rafael Terra wrote:
>> Does anyone knows if there is some function to write panel data estimates to an excel file? I know it is possible to write in LaTex form, but at least for now I have to save the results in a spreadsheet.

> Saving the file as a comma separated file (csv) should be fine for
> reading in Excel. See the write.csv function.

An other option is to open your desired object in the "R Data Editor", select the part you want to use in Excel, and then either drag&drop the selection to an Excel sheet or press ?C to copy the data into the clipboard (right-click into the selection gives the context menu for more).

Cheers,
--Hans

From dieter.mayr at boku.ac.at  Mon Sep 19 12:11:50 2011
From: dieter.mayr at boku.ac.at (didimayr)
Date: Mon, 19 Sep 2011 03:11:50 -0700 (PDT)
Subject: [R-sig-Geo] converting grid objects to spatial polygon objects
 and export as shapefile
In-Reply-To: <1265418490545-4523475.post@n2.nabble.com>
References: <8CC4755FF335DDD-29E4-A52E@webmail-d100.sysops.aol.com>
	<alpine.LRH.2.00.0912100952060.3176@reclus.nhh.no>
	<1265329344875-4517330.post@n2.nabble.com>
	<1265418490545-4523475.post@n2.nabble.com>
Message-ID: <1316427110217-6807877.post@n2.nabble.com>

Dear all,

I am trying to do the same as above in: ?converting grid objects to spatial
polygon objects and export as shapefile , Dec 10, 2009; 3:17am? with my own
data, however I do not come to any useful result. My aim is to get a
shapefile with polygons with an additional column including the overlayed
raster data. Maybe someone has an idea or some hints:
I have a shapefile converted into a SpatialPolygonsDataFrame (?R1000m?) and
a asc-rasterfile converted into a SpatialPointsDataFrame(?raster_data?)

  overlay_1 <- overlay(raster_data, R1000m)

result: overlay_1 is an integer, similar to ?o? in the above example, but
includes NAs, because the grid-(point) layer is greater than the Polygons.
Having a look at the SpatialPointsdataframe shows that the column with the
interesting information is called: ?PNSA1145.asc?. Thus I try:
  
  R1000m$new <- aggregate(raster_data$PNSA1145.asc, list(overlay_1), mean)$
PNSA1145.asc

This doesn?t show me any error, but nothing changed within R1000m.

possible Problems: 
# rastergrid have lower resolution than Polygons -> should I use
disaggregate?
# is the overlay correct applied? Does it make sense like:  overlay(R1000m,
raster_data)? Should I use "extract"? 
# raster_data and R1000m do not overlay on each point: small parts of R1000m
are not overlayed.


I am extremly thankful for any ideas and information you could give me.
Kind regards
Dieter Mayr





--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/converting-grid-objects-to-spatial-polygon-objects-and-export-as-shapefile-tp4143331p6807877.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From tom.gottfried at tum.de  Mon Sep 19 13:16:52 2011
From: tom.gottfried at tum.de (Tom Gottfried)
Date: Mon, 19 Sep 2011 13:16:52 +0200
Subject: [R-sig-Geo] converting grid objects to spatial polygon objects
 and export as shapefile
In-Reply-To: <1316427110217-6807877.post@n2.nabble.com>
References: <8CC4755FF335DDD-29E4-A52E@webmail-d100.sysops.aol.com>	<alpine.LRH.2.00.0912100952060.3176@reclus.nhh.no>	<1265329344875-4517330.post@n2.nabble.com>	<1265418490545-4523475.post@n2.nabble.com>
	<1316427110217-6807877.post@n2.nabble.com>
Message-ID: <4E7724A4.2050001@tum.de>

Hi,

use

over(R1000m, raster_data)

wich should give you the desired result. overlay() is deprecated.

Regards,
Tom

Am 19.09.2011 12:11, schrieb didimayr:
> Dear all,
>
> I am trying to do the same as above in: ?converting grid objects to spatial
> polygon objects and export as shapefile , Dec 10, 2009; 3:17am? with my own
> data, however I do not come to any useful result. My aim is to get a
> shapefile with polygons with an additional column including the overlayed
> raster data. Maybe someone has an idea or some hints:
> I have a shapefile converted into a SpatialPolygonsDataFrame (?R1000m?) and
> a asc-rasterfile converted into a SpatialPointsDataFrame(?raster_data?)
>
>    overlay_1<- overlay(raster_data, R1000m)
>
> result: overlay_1 is an integer, similar to ?o? in the above example, but
> includes NAs, because the grid-(point) layer is greater than the Polygons.
> Having a look at the SpatialPointsdataframe shows that the column with the
> interesting information is called: ?PNSA1145.asc?. Thus I try:
>
>    R1000m$new<- aggregate(raster_data$PNSA1145.asc, list(overlay_1), mean)$
> PNSA1145.asc
>
> This doesn?t show me any error, but nothing changed within R1000m.
>
> possible Problems:
> # rastergrid have lower resolution than Polygons ->  should I use
> disaggregate?
> # is the overlay correct applied? Does it make sense like:  overlay(R1000m,
> raster_data)? Should I use "extract"?
> # raster_data and R1000m do not overlay on each point: small parts of R1000m
> are not overlayed.
>
>
> I am extremly thankful for any ideas and information you could give me.
> Kind regards
> Dieter Mayr
>
>
>
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/converting-grid-objects-to-spatial-polygon-objects-and-export-as-shapefile-tp4143331p6807877.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Technische Universit?t M?nchen
Department f?r Pflanzenwissenschaften
Lehrstuhl f?r Gr?nlandlehre
Alte Akademie 12
85350 Freising / Germany
Phone: ++49 (0)8161 715324
Fax:   ++49 (0)8161 713243
email: tom.gottfried at wzw.tum.de
http://www.wzw.tum.de/gruenland


From mathieu.rajerison at gmail.com  Mon Sep 19 13:32:11 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Mon, 19 Sep 2011 13:32:11 +0200
Subject: [R-sig-Geo] [raster] a railroad,
 a raster with a different value on each side of it
In-Reply-To: <CANtt_hwm6L_eS0Hm+b1bYKrjLogiSrEEddR1jf7Qy4SHY5HaPA@mail.gmail.com>
References: <CAGfc75maof=tSH594hOg+GtJVzYvWiVv1j4ntZ-6zhPbotEruA@mail.gmail.com>
	<CANVKczPmTriOTGEcwsgtiBPN2_jun_yr6-6wUagR=GyK5_k5Gg@mail.gmail.com>
	<1316205499.19045.YahooMailNeo@web29712.mail.ird.yahoo.com>
	<CANtt_hwm6L_eS0Hm+b1bYKrjLogiSrEEddR1jf7Qy4SHY5HaPA@mail.gmail.com>
Message-ID: <CAGfc75=nnN2CQ5HKfqaW7mMAyxw_ozqtEazHOsBK5zffNedKxQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110919/aa8ab7b1/attachment.pl>

From jstruve at ufl.edu  Mon Sep 19 23:13:27 2011
From: jstruve at ufl.edu (Struve,Juliane)
Date: Mon, 19 Sep 2011 21:13:27 +0000
Subject: [R-sig-Geo] Combining different rasters
Message-ID: <BFCE57D0BE7CBB42A581347DE375AF9A021656@UFEXCH-MBXN02.ad.ufl.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110919/42b4d24b/attachment.pl>

From moshersteven at gmail.com  Mon Sep 19 23:19:36 2011
From: moshersteven at gmail.com (steven mosher)
Date: Mon, 19 Sep 2011 14:19:36 -0700
Subject: [R-sig-Geo] Combining different rasters
In-Reply-To: <BFCE57D0BE7CBB42A581347DE375AF9A021656@UFEXCH-MBXN02.ad.ufl.edu>
References: <BFCE57D0BE7CBB42A581347DE375AF9A021656@UFEXCH-MBXN02.ad.ufl.edu>
Message-ID: <CAFFLneTxvzHU13N8V_uMQbzFZ91agRjbP=+TdZWJ=B-ibAWJrg@mail.gmail.com>

 Hi Dr. Struve,

 could you print out the characteristics of your rasters.

 Just type the name of the raster at the console and cut and paste the
output  in a mail.
 I think your first step is probably going to be getting them in the
same resolution..
 Then match up the extents by cropping the larger one..  But if you
show the details It will probably help folks give you a more direct
answer..

On Mon, Sep 19, 2011 at 2:13 PM, Struve,Juliane <jstruve at ufl.edu> wrote:
>
> Dear list,
>
> I have two rasters ?with different origins, resolutions and extents. Raster 2 covers a sub-area of raster 1, which has a larger resolution and larger extent than raster 2. How can I change raster 2 so that every cell in raster 2 corresponds to another cell in raster 1 ? I have looked at different functions like mosaic() and overlay() but those functions do not seem to be applicable.
>
> Thank you very much for any suggestions.
>
> Juliane
>
>
>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From r.hijmans at gmail.com  Tue Sep 20 01:01:26 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 19 Sep 2011 16:01:26 -0700
Subject: [R-sig-Geo] Combining different rasters
In-Reply-To: <CAFFLneTxvzHU13N8V_uMQbzFZ91agRjbP=+TdZWJ=B-ibAWJrg@mail.gmail.com>
References: <BFCE57D0BE7CBB42A581347DE375AF9A021656@UFEXCH-MBXN02.ad.ufl.edu>
	<CAFFLneTxvzHU13N8V_uMQbzFZ91agRjbP=+TdZWJ=B-ibAWJrg@mail.gmail.com>
Message-ID: <CANtt_hzw8_iGYAC81_MWcYM4p=6zjcBPUB85hyow6FwczsEFPg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110919/5624f1e6/attachment.pl>

From moshersteven at gmail.com  Tue Sep 20 01:10:09 2011
From: moshersteven at gmail.com (steven mosher)
Date: Mon, 19 Sep 2011 16:10:09 -0700
Subject: [R-sig-Geo] Combining different rasters
In-Reply-To: <CANtt_hzw8_iGYAC81_MWcYM4p=6zjcBPUB85hyow6FwczsEFPg@mail.gmail.com>
References: <BFCE57D0BE7CBB42A581347DE375AF9A021656@UFEXCH-MBXN02.ad.ufl.edu>
	<CAFFLneTxvzHU13N8V_uMQbzFZ91agRjbP=+TdZWJ=B-ibAWJrg@mail.gmail.com>
	<CANtt_hzw8_iGYAC81_MWcYM4p=6zjcBPUB85hyow6FwczsEFPg@mail.gmail.com>
Message-ID: <CAFFLneRXiqQut7L2vwN7dP6BrZPqZvnH7ud+V+6rNc6XXY8ejA@mail.gmail.com>

 Thanks robert.. I have a similar problem  with two rasters where one
has a .01 degree
resolution and the other is 30 arc second (.008333)  both with
different extents..and I was puzzling over that just as Juliane
posted.. synchronicity..

have a great day

On Mon, Sep 19, 2011 at 4:01 PM, Robert J. Hijmans <r.hijmans at gmail.com> wrote:
> Or better still, provide a self contained example as below:
>
> r1 <- raster(ncol=25, nrow=25, xmn=-50, xmx=50, ymn=-50, ymx=50)
> r2 <- raster(ncol=25, nrow=25, xmn=-3.5, xmx=20, ymn=-3.5, ymx=20)
> r1[] ?<- 1:ncell(r1)
> r2[] ?<- 1:ncell(r2)
> plot(r1)
> plot(rasterToPolygons(r2), add=T)
>
> # one approach
> x <- resample(r1, r2, method='bilinear')
>
> # what you asked for:
> # first aggregate to apprixmately the same resolution
> y <- aggregate(r2, floor(res(r1) / res(r2)), fun=mean)
> # then resample
> z <- resample(y, r1, method='bilinear')
> plot(r1)
> plot(rasterToPolygons(z), add=T)
>
>
>
> On Mon, Sep 19, 2011 at 2:19 PM, steven mosher <moshersteven at gmail.com>
> wrote:
>>
>> ?Hi Dr. Struve,
>>
>> ?could you print out the characteristics of your rasters.
>>
>> ?Just type the name of the raster at the console and cut and paste the
>> output ?in a mail.
>> ?I think your first step is probably going to be getting them in the
>> same resolution..
>> ?Then match up the extents by cropping the larger one.. ?But if you
>> show the details It will probably help folks give you a more direct
>> answer..
>>
>> On Mon, Sep 19, 2011 at 2:13 PM, Struve,Juliane <jstruve at ufl.edu> wrote:
>> >
>> > Dear list,
>> >
>> > I have two rasters ?with different origins, resolutions and extents.
>> > Raster 2 covers a sub-area of raster 1, which has a larger resolution and
>> > larger extent than raster 2. How can I change raster 2 so that every cell in
>> > raster 2 corresponds to another cell in raster 1 ? I have looked at
>> > different functions like mosaic() and overlay() but those functions do not
>> > seem to be applicable.
>> >
>> > Thank you very much for any suggestions.
>> >
>> > Juliane
>> >
>> >
>> >
>> >
>> > ? ? ? ?[[alternative HTML version deleted]]
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at r-project.org
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


From aslantas at metu.edu.tr  Tue Sep 20 11:15:01 2011
From: aslantas at metu.edu.tr (=?iso-8859-9?Q?P=FDnar_Aslantas_Bostan?=)
Date: Tue, 20 Sep 2011 12:15:01 +0300
Subject: [R-sig-Geo] about ST kriging
Message-ID: <001101cc7775$c6f92f00$54eb8d00$@edu.tr>

Dear all,

I am working about space-time kriging. Before I asked again about ST kriging
but now the problem is 
different and I could not overcome it!

During kriging operation I got this error:

> pred = krigeST(prec~1, w, STS(grid,time,index), v)
Error in chol.default(A$Sm, LINPACK = TRUE) : 
  non-positive definite matrix in 'chol'

I explained the data set below:

# prec is annual precipitation measured from 257 meteorological stations

# w is STSDF object
> summary(w)
Object of class STSDF
[[Spatial:]]
Object of class SpatialPoints
Coordinates:
         min     max
Xnew  140556 1730472
Ynew 4309064 4971309
Is projected: NA 
proj4string : [NA]
Number of points: 257
[[Temporal:]]
     Index                      object at time  
 Min.   :1970-01-01 12:00:00   Min.   : 1.0  
 1st Qu.:1979-07-03 00:00:00   1st Qu.:10.5  
 Median :1989-01-01 12:00:00   Median :20.0  
 Mean   :1989-01-01 02:46:09   Mean   :20.0  
 3rd Qu.:1998-07-03 00:00:00   3rd Qu.:29.5  
 Max.   :2008-01-01 12:00:00   Max.   :39.0  
[[Data attributes:]]
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  114.5   413.7   533.6   633.0   735.6  3332.0 

# I used grid to obtain predictions over it. It has 25 km spatial resolution

# time is temporal entity of study. It contains 39 annual observation.

# index is required for STSDF, and I used this code to create index.
> index <- cbind(as.integer(as.factor(data$Station)),
as.integer(as.factor(data$Year)))

# v is space-time variogram

How can I solve the problem?
Thank you in advance!


Pinar Aslantas Bostan
Research Assistant
Department of Geodetic and
Geographic Information Technologies (GGIT) Middle East Technical University
06531 Ankara/TURKEY
aslantas at metu.edu.tr


From jstruve at ufl.edu  Tue Sep 20 14:59:22 2011
From: jstruve at ufl.edu (Struve,Juliane)
Date: Tue, 20 Sep 2011 12:59:22 +0000
Subject: [R-sig-Geo] Combining different rasters
In-Reply-To: <CANtt_hzw8_iGYAC81_MWcYM4p=6zjcBPUB85hyow6FwczsEFPg@mail.gmail.com>
References: <BFCE57D0BE7CBB42A581347DE375AF9A021656@UFEXCH-MBXN02.ad.ufl.edu>
	<CAFFLneTxvzHU13N8V_uMQbzFZ91agRjbP=+TdZWJ=B-ibAWJrg@mail.gmail.com>
	<CANtt_hzw8_iGYAC81_MWcYM4p=6zjcBPUB85hyow6FwczsEFPg@mail.gmail.com>
Message-ID: <BFCE57D0BE7CBB42A581347DE375AF9A0216DE@UFEXCH-MBXN02.ad.ufl.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110920/d50c1270/attachment.pl>

From sandeep.coepcivil at gmail.com  Tue Sep 20 14:59:55 2011
From: sandeep.coepcivil at gmail.com (srp868)
Date: Tue, 20 Sep 2011 05:59:55 -0700 (PDT)
Subject: [R-sig-Geo] Spatial Interpolation Cross Validation
Message-ID: <1316523594879-6812194.post@n2.nabble.com>

Hello 


I believe there have been a couple of posts on this topic, but let me add
this one.

I need a way to perform leave out one cross validation on a bunch of data.

I believe Automap is the way to go forward for Kriging and i am using it .


Could someone suggest me a way to do the same with splines that may 

use any existing spline package for R.

Thanks 

Sandeep Patil

Dept of Geography

Texas A & M University, College Station

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Spatial-Interpolation-Cross-Validation-tp6812194p6812194.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From marcoswfreitas at gmail.com  Tue Sep 20 16:57:07 2011
From: marcoswfreitas at gmail.com (Marcos Freitas)
Date: Tue, 20 Sep 2011 11:57:07 -0300
Subject: [R-sig-Geo] Hat matrix in ggwr models with adaptative kernel
Message-ID: <CAEcaNUoSR36ZpxxvV+gK_2SvZ_MYMCH-a0msynt-ReFMnuSZyA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110920/8dfa3c27/attachment.pl>

From marcoswfreitas at gmail.com  Tue Sep 20 17:20:24 2011
From: marcoswfreitas at gmail.com (Marcos Freitas)
Date: Tue, 20 Sep 2011 12:20:24 -0300
Subject: [R-sig-Geo] Fwd: Hat matrix in ggwr models with adaptative kernel
References: <CAEcaNUoSR36ZpxxvV+gK_2SvZ_MYMCH-a0msynt-ReFMnuSZyA@mail.gmail.com>
Message-ID: <1A37D9AA-9EAD-483D-A0F6-6A6B22AB8AA5@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110920/341685e9/attachment.pl>

From Roger.Bivand at nhh.no  Tue Sep 20 18:14:08 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 20 Sep 2011 18:14:08 +0200 (CEST)
Subject: [R-sig-Geo] Fwd: Hat matrix in ggwr models with adaptative
 kernel
In-Reply-To: <1A37D9AA-9EAD-483D-A0F6-6A6B22AB8AA5@gmail.com>
References: <CAEcaNUoSR36ZpxxvV+gK_2SvZ_MYMCH-a0msynt-ReFMnuSZyA@mail.gmail.com>
	<1A37D9AA-9EAD-483D-A0F6-6A6B22AB8AA5@gmail.com>
Message-ID: <alpine.LRH.2.00.1109201808040.16891@reclus.nhh.no>

On Tue, 20 Sep 2011, Marcos Freitas wrote:

>
>>
>> Hi to all,
>>
>> I have some questions about the ggwr logistic GWR function of spgwr 
>> package. I'm trying to get the hat matrix to calculate the AIC for a 
>> comparison of different models, but I get a message that the option 
>> "hat matrix=TRUE" is disabled in ggwr. How can I get the effective 
>> number of parameters as GWR book (pg.55) for a logistic model based on 
>> an adaptative gaussian kernel to make this calculation? Is not possible 
>> to use AIC instead of CV as the criteria for adaptative selection 
>> (ggwr.sel function)?
>>
>> Beyond this questions I have a few others on ggwr function.
>>
>>
>> Is this model considered experimental? How can I get more information 
>> about the implemented algorithm? It will change soon?
>>

The spgwr package began as an attempt to document what GWR3 does. We found 
numerous discrepancies, including multiple definitions of AIC, and the 
unnecessary use of an approximation in the df calculations for the linear 
model case. The glm case is highly experimental, and given strong doubts 
about GWR as an approach, is there only for exploring data, not as a 
statistical model. No hat matrix will be attempted by me, and if anyone 
contributes one, I'll include it requiring the user to set an argument 
agreeing to the sentence: "I am aware that GWR has not been shown to be an 
adequate method beyond exploratory data analysis".

>> I`m using pgirmess package spatial correlograms of Moran`s I to check 
>> for autocorrelation of residuals of global logistic and logistic gwr 
>> models (response residuals). It`s correct or does it have another 
>> approach to check spatial autocorrelation issues on global and local 
>> logistic regression models?
>>

This is a different question.

Roger

>>
>> My code is below and the measure to compare between models that I`m 
>> using is C (area under curve) in Hmisc package. Thanks in advance for 
>> all comments and suggestions.
>>
>>
>> Marcos Freitas
>
> PhD Student INPE-Brasil
>>
>>
>>
>>
>> library(spdep)
>> library(spgwr)
>>
>> library(Hmisc)
>>
>> fit = readShapePoints("C://Documents and Settings/Marcos Freitas/Meus documentos/Doutorado/Area_Lages_trabalho/TESE_ESDA_LAGES/LOGISTICA/samples_floresta_01.shp", proj4string=CRS("+proj=utm +zone=-22 +datum=WGS84"), verbose = FALSE, repair=FALSE)
>>
>> head(fit)
>>
>> bw = ggwr.sel(DEP_VAR ~ declividad + rug_norm + dist_riv + PTH_AR_MN + PTH_AR_SD + NP + LPI + MESH + GEOM_DC1, data=fit, coords=cbind(dados$Eastings, dados$Northings), adapt=TRUE, gweight=gwr.Gauss, family=binomial(link="logit"), verbose=TRUE, longlat=NULL, RMSE=FALSE, tol=.Machine$double.eps^0.25)
>>
>> gwr.deg = ggwr(DEP_VAR ~ declividad + rug_norm + dist_riv + PTH_AR_MN + PTH_AR_SD + NP + LPI + MESH + GEOM_DC1, data=fit, coords=cbind(fit$POINT_X, fit$POINT_Y), gweight=gwr.Gauss, adapt=bw, family=binomial(link="logit"), longlat=NULL, type=c("response"))
>>
>> write.table (gwr.deg$SDF, file=paste("C://Documents and Settings/Marcos Freitas/Meusdocumentos/Doutorado/Area_Lages_trabalho/TESE_ESDA_LAGES/LOGISTICA/lgwr_floresta_fit_reduzido", ".txt", sep=""))
>>
>> pred_prob = fit$DEP_VAR - gwr.deg$SDF$response_resids
>>
>> auc = somers2(pred_prob, fit$DEP_VAR, weights=NULL, normwt=FALSE, na.rm=TRUE)
>>
>>
>>
>>
>>
>>
>>
>>
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From marcoswfreitas at gmail.com  Tue Sep 20 21:37:43 2011
From: marcoswfreitas at gmail.com (Marcos Freitas)
Date: Tue, 20 Sep 2011 16:37:43 -0300
Subject: [R-sig-Geo] Fwd: Hat matrix in ggwr models with adaptative
	kernel
In-Reply-To: <alpine.LRH.2.00.1109201808040.16891@reclus.nhh.no>
References: <CAEcaNUoSR36ZpxxvV+gK_2SvZ_MYMCH-a0msynt-ReFMnuSZyA@mail.gmail.com>
	<1A37D9AA-9EAD-483D-A0F6-6A6B22AB8AA5@gmail.com>
	<alpine.LRH.2.00.1109201808040.16891@reclus.nhh.no>
Message-ID: <CAEcaNUpj6Gx6u2SKOa96bzVK9B0YumajL0kySqG_p7nsxxTYTg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110920/d7d25e46/attachment.pl>

From Roger.Bivand at nhh.no  Tue Sep 20 21:56:39 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 20 Sep 2011 21:56:39 +0200 (CEST)
Subject: [R-sig-Geo] Fwd: Hat matrix in ggwr models with adaptative
 kernel
In-Reply-To: <CAEcaNUpj6Gx6u2SKOa96bzVK9B0YumajL0kySqG_p7nsxxTYTg@mail.gmail.com>
References: <CAEcaNUoSR36ZpxxvV+gK_2SvZ_MYMCH-a0msynt-ReFMnuSZyA@mail.gmail.com>
	<1A37D9AA-9EAD-483D-A0F6-6A6B22AB8AA5@gmail.com>
	<alpine.LRH.2.00.1109201808040.16891@reclus.nhh.no>
	<CAEcaNUpj6Gx6u2SKOa96bzVK9B0YumajL0kySqG_p7nsxxTYTg@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1109202146150.16891@reclus.nhh.no>

On Tue, 20 Sep 2011, Marcos Freitas wrote:

> Hi Prof. Bivand,
>
> Thanks for the explanation of the problems founded in the implementation of
> GWR in R. My objective is to use logistic GWR in the generation of land use
> classes probabilities maps in my PhD thesis, an exploratory use as well. The
> objective of having a hat matrix for me is to compute AIC`s to perform a
> comparison of models with different included independent variables. So, I`ll
> be delighted if you or other colleagues would provide me some references
> about those statistical issues on GWR and where I can found more information
> about the spgwr implementation of ggwr function. Certainly, I`ll be asked
> about those issues if I don`t clearly understand and explain such
> implementation. Thanks in advance.

Hi Marcos,

The GWR literature consists of papers "boosting" (promoting) the method, 
and quite a lot of unanswered criticism, notably starting with Wheeler & 
Tiefelsdorf (2005). That problem is that any collinearity in the data set 
may very well be amplified in local settings, that the geographical 
weights strengthen any collinearity present. There are other issues too, 
such as it being difficult to reconstruct what GWR3 does with respect to 
the GWR book - local R2 is an example, where gwr() tries to follow what 
may be a forthcoming GWR4.

I don't think it has been shown that GWR is a reliable modelling tool, it 
works as an exploratory tool to point up possible misspecification.

Hope this helps,

Roger

>
> Best regards,
>
> Marcos Freitas
>
> 2011/9/20 Roger Bivand <Roger.Bivand at nhh.no>
>
>> On Tue, 20 Sep 2011, Marcos Freitas wrote:
>>
>>
>>>
>>>> Hi to all,
>>>>
>>>> I have some questions about the ggwr logistic GWR function of spgwr
>>>> package. I'm trying to get the hat matrix to calculate the AIC for a
>>>> comparison of different models, but I get a message that the option "hat
>>>> matrix=TRUE" is disabled in ggwr. How can I get the effective number of
>>>> parameters as GWR book (pg.55) for a logistic model based on an adaptative
>>>> gaussian kernel to make this calculation? Is not possible to use AIC instead
>>>> of CV as the criteria for adaptative selection (ggwr.sel function)?
>>>>
>>>> Beyond this questions I have a few others on ggwr function.
>>>>
>>>>
>>>> Is this model considered experimental? How can I get more information
>>>> about the implemented algorithm? It will change soon?
>>>>
>>>>
>> The spgwr package began as an attempt to document what GWR3 does. We found
>> numerous discrepancies, including multiple definitions of AIC, and the
>> unnecessary use of an approximation in the df calculations for the linear
>> model case. The glm case is highly experimental, and given strong doubts
>> about GWR as an approach, is there only for exploring data, not as a
>> statistical model. No hat matrix will be attempted by me, and if anyone
>> contributes one, I'll include it requiring the user to set an argument
>> agreeing to the sentence: "I am aware that GWR has not been shown to be an
>> adequate method beyond exploratory data analysis".
>>
>>
>>  I`m using pgirmess package spatial correlograms of Moran`s I to check for
>>>> autocorrelation of residuals of global logistic and logistic gwr models
>>>> (response residuals). It`s correct or does it have another approach to check
>>>> spatial autocorrelation issues on global and local logistic regression
>>>> models?
>>>>
>>>>
>> This is a different question.
>>
>> Roger
>>
>>
>>>> My code is below and the measure to compare between models that I`m using
>>>> is C (area under curve) in Hmisc package. Thanks in advance for all comments
>>>> and suggestions.
>>>>
>>>>
>>>> Marcos Freitas
>>>>
>>>
>>> PhD Student INPE-Brasil
>>>
>>>>
>>>>
>>>>
>>>>
>>>> library(spdep)
>>>> library(spgwr)
>>>>
>>>> library(Hmisc)
>>>>
>>>> fit = readShapePoints("C://Documents and Settings/Marcos Freitas/Meus
>>>> documentos/Doutorado/Area_**Lages_trabalho/TESE_ESDA_**
>>>> LAGES/LOGISTICA/samples_**floresta_01.shp", proj4string=CRS("+proj=utm
>>>> +zone=-22 +datum=WGS84"), verbose = FALSE, repair=FALSE)
>>>>
>>>> head(fit)
>>>>
>>>> bw = ggwr.sel(DEP_VAR ~ declividad + rug_norm + dist_riv + PTH_AR_MN +
>>>> PTH_AR_SD + NP + LPI + MESH + GEOM_DC1, data=fit,
>>>> coords=cbind(dados$Eastings, dados$Northings), adapt=TRUE,
>>>> gweight=gwr.Gauss, family=binomial(link="logit"), verbose=TRUE,
>>>> longlat=NULL, RMSE=FALSE, tol=.Machine$double.eps^0.25)
>>>>
>>>> gwr.deg = ggwr(DEP_VAR ~ declividad + rug_norm + dist_riv + PTH_AR_MN +
>>>> PTH_AR_SD + NP + LPI + MESH + GEOM_DC1, data=fit, coords=cbind(fit$POINT_X,
>>>> fit$POINT_Y), gweight=gwr.Gauss, adapt=bw, family=binomial(link="logit"),
>>>> longlat=NULL, type=c("response"))
>>>>
>>>> write.table (gwr.deg$SDF, file=paste("C://Documents and Settings/Marcos
>>>> Freitas/Meusdocumentos/**Doutorado/Area_Lages_trabalho/**
>>>> TESE_ESDA_LAGES/LOGISTICA/**lgwr_floresta_fit_reduzido", ".txt",
>>>> sep=""))
>>>>
>>>> pred_prob = fit$DEP_VAR - gwr.deg$SDF$response_resids
>>>>
>>>> auc = somers2(pred_prob, fit$DEP_VAR, weights=NULL, normwt=FALSE,
>>>> na.rm=TRUE)
>>>>
>>>>
>>>>
>>>>
>>>>
>>>>
>>>>
>>>>
>>>>
>>>
>>>        [[alternative HTML version deleted]]
>>>
>>> ______________________________**_________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/**listinfo/r-sig-geo<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>>>
>>>
>> --
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From mfalconer at bsc-eoc.org  Tue Sep 20 23:43:06 2011
From: mfalconer at bsc-eoc.org (Myles Falconer)
Date: Tue, 20 Sep 2011 17:43:06 -0400
Subject: [R-sig-Geo] kernel density estimation - scaling factor problem?
In-Reply-To: <D828AF18F9CABA4AADDA9D0F9808ED76A702F91273@bsc2008.bsc-eoc.org>
References: <D828AF18F9CABA4AADDA9D0F9808ED76A702F91273@bsc2008.bsc-eoc.org>
Message-ID: <D828AF18F9CABA4AADDA9D0F9808ED76A702F91274@bsc2008.bsc-eoc.org>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110920/c1534f70/attachment.pl>

From r.turner at auckland.ac.nz  Wed Sep 21 01:43:02 2011
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Wed, 21 Sep 2011 11:43:02 +1200
Subject: [R-sig-Geo] kernel density estimation - scaling factor problem?
In-Reply-To: <D828AF18F9CABA4AADDA9D0F9808ED76A702F91274@bsc2008.bsc-eoc.org>
References: <D828AF18F9CABA4AADDA9D0F9808ED76A702F91273@bsc2008.bsc-eoc.org>
	<D828AF18F9CABA4AADDA9D0F9808ED76A702F91274@bsc2008.bsc-eoc.org>
Message-ID: <4E792506.1080704@auckland.ac.nz>


(1) You make an awfully complicated issue of the calculations.
Why not just:

require(spatstat)
W <- owin(c(0,10),c(0,10))
X <- ppp(x=c(2,7,4,5,8,8,1,3,3,9),
                y=c(6,5,1,1,4,5,7,1,9,8),
                marks=c(10,7,5,9,12,14,8,11,7,10),
                window=W)
ddd <- density(X,sigma=1.4,weights=marks(X),edge=FALSE)

Doing range(ddd$v) gives

[1] 0.008501562 2.454624379

so the highest density is about 2.45.

(2) Why do you say that 2.4 is too small?  You have a total of 93
apples over 100 square metres, giving a mean density of 0.93.
So 2.4 as a maximum density seems commensurate with this.

(3) The integral of ddd is a bit on the small side; 77.01386.  This
seems to be due to your peculiar insistence on no edge correction.

(4) Your value of sigma may be a tad large; if we let density() choose
sigma for itself we get 1.25.

(5) Doing

     eee <- density(X,weights=marks(X),diggle=TRUE)

yields an integral of exactly 93 and a maximal density of about 3.128.

Does that make you happier?

     cheers,

         Rolf Turner

On 21/09/11 09:43, Myles Falconer wrote:
> Hi all,
>
> I'm a little new to R, so any help is appreciated.
>
> I'm having a problem interpreting the output from my kernel density plot. The density numbers seem smaller than I would expect based on my observed data.
>
> Here's an example dataset. Let's pretend I counted apples on apple trees in an orchard. Let's say the units are in metres.
>
> library(maptools)
> library(gstat)
>
> #make observation window
> x1<-seq(0,10, by=1)
> y1<-seq(0,10, by=1)
> df<-data.frame(x=rep(x1, each=length(y1)),y=rep(y1, length(x1)), z=1)
> gridded(df)<-~x+y
> df<-as(df, "SpatialGridDataFrame")
> dfowin<-as(df,"owin")
>
> #make a dataset to fit in the owin.
> rx<-c(2,7,4,5,8,8,1,3,3,9)
> ry<-c(6,5,1,1,4,5,7,1,9,8)
> apples<-c(10,7,5,9,12,14,8,11,7,10)
> rdf<-data.frame(x=rx,y=ry,apples=count)
> coordinates(rdf)<-~x+y
>
> #as.ppp
> rdf1<-as(rdf["count"],"ppp")
> rdf2<-ppp(x=rdf1$x,y=rdf1$y,marks=rdf1$marks,window=dfowin)
> plot(rdf2)
>
> plot(density(rdf2, sigma=1.4, weights=rdf2$marks, edge=FALSE))
>
>
>
> So the highest density in the orchard is only 2.4 apples per metre... that doesn't seem right... Does it?
>
>
>
> ___________________________________________
>
> Myles Falconer, Ontario Region Project Biologist,
> Bird Studies Canada,
> 115 Front St., P.O. Box 160,
> Port Rowan, ON
> N0E 1M0 Canada
> Email: mfalconer at birdscanada.org
> Ph: 1-888-448-2473 ext. 165
> Local Ph: 519-586-3531 ext. 165
>
> BSC website: http://www.bsc-eoc.org/


From paul.hiemstra at knmi.nl  Wed Sep 21 09:24:16 2011
From: paul.hiemstra at knmi.nl (Paul Hiemstra)
Date: Wed, 21 Sep 2011 07:24:16 +0000
Subject: [R-sig-Geo] classes available with "R"
In-Reply-To: <CAHeNMp4FAta0S+7+BZbo--MmM2EFRjxhYnfxBaJYS+jvXiQa7Q@mail.gmail.com>
References: <CAHeNMp4FAta0S+7+BZbo--MmM2EFRjxhYnfxBaJYS+jvXiQa7Q@mail.gmail.com>
Message-ID: <4E799120.3090607@knmi.nl>

 On 09/15/2011 06:37 PM, Martin Lavoie wrote:
> Hi All,
> I would like to know if there will a class on spatial statistics or
> spatial-temporal statistics this semester or next spring in Canada or in the
> USA?
> thank you
> martin
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Take a look at:

http://spatial-analyst.net/wiki/index.php?title=Training_in_R

Tomislav Hengl often organises training courses on spatial statistics.
They are, however, often in Europe. But as you are willing to travel all
across the North-Americas, a trip to Europe might also be worthwhile...

good luck,
Paul

-- 
Paul Hiemstra, Ph.D.
Global Climate Division
Royal Netherlands Meteorological Institute (KNMI)
Wilhelminalaan 10 | 3732 GK | De Bilt | Kamer B 3.39
P.O. Box 201 | 3730 AE | De Bilt
tel: +31 30 2206 494

http://intamap.geo.uu.nl/~paul
http://nl.linkedin.com/pub/paul-hiemstra/20/30b/770


From paul.hiemstra at knmi.nl  Wed Sep 21 09:50:40 2011
From: paul.hiemstra at knmi.nl (Paul Hiemstra)
Date: Wed, 21 Sep 2011 07:50:40 +0000
Subject: [R-sig-Geo] Spatial Interpolation Cross Validation
In-Reply-To: <1316523594879-6812194.post@n2.nabble.com>
References: <1316523594879-6812194.post@n2.nabble.com>
Message-ID: <4E799750.2000901@knmi.nl>

 On 09/20/2011 12:59 PM, srp868 wrote:
> Hello 
>
>
> I believe there have been a couple of posts on this topic, but let me add
> this one.
>
> I need a way to perform leave out one cross validation on a bunch of data.
>
> I believe Automap is the way to go forward for Kriging and i am using it .
>
>
> Could someone suggest me a way to do the same with splines that may 
>
> use any existing spline package for R.
>
> Thanks 
>
> Sandeep Patil
>
> Dept of Geography
>
> Texas A & M University, College Station
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Spatial-Interpolation-Cross-Validation-tp6812194p6812194.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Hi Sandeep,

For a project I wrote a few functions which smooths cross validation
across spatial packages, e.g. using Tps (thin plate splines) from the
fields package together with automap. See:

https://stat.ethz.ch/pipermail/r-sig-geo/2010-December/010363.html

I sent you the scripts off-list, which includes example code.

good luck,
Paul

-- 
Paul Hiemstra, Ph.D.
Global Climate Division
Royal Netherlands Meteorological Institute (KNMI)
Wilhelminalaan 10 | 3732 GK | De Bilt | Kamer B 3.39
P.O. Box 201 | 3730 AE | De Bilt
tel: +31 30 2206 494

http://intamap.geo.uu.nl/~paul
http://nl.linkedin.com/pub/paul-hiemstra/20/30b/770


From edzer.pebesma at uni-muenster.de  Wed Sep 21 14:45:57 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 21 Sep 2011 14:45:57 +0200
Subject: [R-sig-Geo] about ST kriging
In-Reply-To: <001101cc7775$c6f92f00$54eb8d00$@edu.tr>
References: <001101cc7775$c6f92f00$54eb8d00$@edu.tr>
Message-ID: <4E79DC85.7050808@uni-muenster.de>

Hi Pinar,

it is not clear which variogram model you pass, or how your data are
laid out in space and time.

Possible causes for a non-positive definite covariance matrix include:

- a variogram model with (nearly) perfect correlation
- duplicate observations (observations having identical location AND time)
- an invalid variogram model

A small, reproducible example (data + script) would help identify the
problem.

Best regards,
--
Edzer

On 09/20/2011 11:15 AM, P?nar Aslantas Bostan wrote:
> Dear all,
> 
> I am working about space-time kriging. Before I asked again about ST kriging
> but now the problem is 
> different and I could not overcome it!
> 
> During kriging operation I got this error:
> 
>> pred = krigeST(prec~1, w, STS(grid,time,index), v)
> Error in chol.default(A$Sm, LINPACK = TRUE) : 
>   non-positive definite matrix in 'chol'
> 
> I explained the data set below:
> 
> # prec is annual precipitation measured from 257 meteorological stations
> 
> # w is STSDF object
>> summary(w)
> Object of class STSDF
> [[Spatial:]]
> Object of class SpatialPoints
> Coordinates:
>          min     max
> Xnew  140556 1730472
> Ynew 4309064 4971309
> Is projected: NA 
> proj4string : [NA]
> Number of points: 257
> [[Temporal:]]
>      Index                      object at time  
>  Min.   :1970-01-01 12:00:00   Min.   : 1.0  
>  1st Qu.:1979-07-03 00:00:00   1st Qu.:10.5  
>  Median :1989-01-01 12:00:00   Median :20.0  
>  Mean   :1989-01-01 02:46:09   Mean   :20.0  
>  3rd Qu.:1998-07-03 00:00:00   3rd Qu.:29.5  
>  Max.   :2008-01-01 12:00:00   Max.   :39.0  
> [[Data attributes:]]
>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
>   114.5   413.7   533.6   633.0   735.6  3332.0 
> 
> # I used grid to obtain predictions over it. It has 25 km spatial resolution
> 
> # time is temporal entity of study. It contains 39 annual observation.
> 
> # index is required for STSDF, and I used this code to create index.
>> index <- cbind(as.integer(as.factor(data$Station)),
> as.integer(as.factor(data$Year)))
> 
> # v is space-time variogram
> 
> How can I solve the problem?
> Thank you in advance!
> 
> 
> Pinar Aslantas Bostan
> Research Assistant
> Department of Geodetic and
> Geographic Information Technologies (GGIT) Middle East Technical University
> 06531 Ankara/TURKEY
> aslantas at metu.edu.tr
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From gianni.lavaredo at gmail.com  Wed Sep 21 16:18:35 2011
From: gianni.lavaredo at gmail.com (gianni lavaredo)
Date: Wed, 21 Sep 2011 16:18:35 +0200
Subject: [R-sig-Geo] help to change charactwer name in a row of data.frame
Message-ID: <CAJ6JbR8KVQ6nnfSG2vZ7a0sAHS-ODe6dU3SdLxxumn-Kz5KzHg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110921/3aa316c2/attachment.pl>

From piero.campa at gmail.com  Wed Sep 21 16:39:46 2011
From: piero.campa at gmail.com (Piero Campalani)
Date: Wed, 21 Sep 2011 16:39:46 +0200
Subject: [R-sig-Geo] help to change charactwer name in a row of
	data.frame
In-Reply-To: <CAJ6JbR8KVQ6nnfSG2vZ7a0sAHS-ODe6dU3SdLxxumn-Kz5KzHg@mail.gmail.com>
References: <CAJ6JbR8KVQ6nnfSG2vZ7a0sAHS-ODe6dU3SdLxxumn-Kz5KzHg@mail.gmail.com>
Message-ID: <CAMp9JaMSKtmDAN-wePAKF9Upe1LLVQS1sFNDY_9rMDq-0z6neA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110921/143ff6f8/attachment.pl>

From ndjido at gmail.com  Wed Sep 21 17:05:37 2011
From: ndjido at gmail.com (Ndjido Ardo BAR)
Date: Wed, 21 Sep 2011 17:05:37 +0200
Subject: [R-sig-Geo] help to change charactwer name in a row of
	data.frame
In-Reply-To: <CAJ6JbR8KVQ6nnfSG2vZ7a0sAHS-ODe6dU3SdLxxumn-Kz5KzHg@mail.gmail.com>
References: <CAJ6JbR8KVQ6nnfSG2vZ7a0sAHS-ODe6dU3SdLxxumn-Kz5KzHg@mail.gmail.com>
Message-ID: <CAL3quv_pPWgvzyOQKV7udKBh-tO8yhsCWykDHUE3GK+oWdBzbA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110921/587b74dc/attachment.pl>

From tarabridwell at gmail.com  Wed Sep 21 19:13:51 2011
From: tarabridwell at gmail.com (Tara Bridwell)
Date: Wed, 21 Sep 2011 10:13:51 -0700
Subject: [R-sig-Geo] Determining unique values in a raster
Message-ID: <CAELQJc2smq7wd+APO4=E+Uk1cmBRw6i80CJW_hadMoWxUXx-BQ@mail.gmail.com>

I am trying to determine the unique values within a raster, but am
having trouble.  Here is some sample base data:

require(raster)
r <- raster(ncol=10, nrow=10)
r[]=1:ncell(r)

x <- c(-45, -45, -45, 30, 30, 20, -10, 50, -7)
y <- c(-25, -25, -25, 148, -148, 46, 23, 0, -69)
value <- c(1, 2, 3, 1, 2, 3, 1, 1, 1)
coord.plus.value <- cbind(x, y)
coord.plus.value_sp <- SpatialPoints(coord.plus.value)

>From here I want to find the number of unique values in each cell of
the raster (i.e. 'richness').  To get around the need for an
na.rm=TRUE need for these functions, the documentation for rasterize
suggests:

Note that the function must take an na.rm argument, either explicitly
or through 'dots'. This means that fun=lenght fails, but
fun=function(x,...)lenght(x) works (but ignores the na.rm argument. To
use the na.rm argument you can use a function like this
fun=function(x,na.rm){if (na.rm) length(na.omit(x)) else (length(x)},
or use a function that removes NA values in all cases, like this
function to compute the number of unique values "richness":
fun=function(x, ...){length(unique(na.omit(x)))}.
When I try this for my code:
raster_ct<- rasterize(coord.plus.value_sp, r, fun=function(value)
{length(unique(na.omit(value)))})

I still get the following error:
Error in FUN(X[[1L]], ...) : unused argument(s) (na.rm = TRUE)

Does anyone have any thoughts on why this is happening?  I have tried
defining the function outside of the rasterize code but then I end up
with the same value in all cells.

Thank you,
Tara Bridwell


From r.hijmans at gmail.com  Wed Sep 21 19:49:19 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 21 Sep 2011 10:49:19 -0700
Subject: [R-sig-Geo] Determining unique values in a raster
In-Reply-To: <CAELQJc2smq7wd+APO4=E+Uk1cmBRw6i80CJW_hadMoWxUXx-BQ@mail.gmail.com>
References: <CAELQJc2smq7wd+APO4=E+Uk1cmBRw6i80CJW_hadMoWxUXx-BQ@mail.gmail.com>
Message-ID: <CANtt_hxrsJ8kCKE3dyEWMkZt_MQR=E0Wic1pEzCh3kvT32_zQg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110921/fb01691f/attachment.pl>

From sandeep.coepcivil at gmail.com  Thu Sep 22 01:31:05 2011
From: sandeep.coepcivil at gmail.com (Sandeep Patil)
Date: Wed, 21 Sep 2011 18:31:05 -0500
Subject: [R-sig-Geo] Read statement in R advanced
Message-ID: <CAHnA5RUoFJQ4aubrqrGcUX0F3=1sBEF46jLf4X8GBO+aoHDR9A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110921/7fae7a00/attachment.pl>

From HodgessE at uhd.edu  Thu Sep 22 02:14:14 2011
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Wed, 21 Sep 2011 19:14:14 -0500
Subject: [R-sig-Geo] small data set for an example
Message-ID: <586A4828D7AAA04CA9B258C50A28DA206DBC9B@BALI.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110921/cb935d00/attachment.pl>

From rshepard at appl-ecosys.com  Thu Sep 22 02:19:33 2011
From: rshepard at appl-ecosys.com (Rich Shepard)
Date: Wed, 21 Sep 2011 17:19:33 -0700 (PDT)
Subject: [R-sig-Geo] small data set for an example
In-Reply-To: <586A4828D7AAA04CA9B258C50A28DA206DBC9B@BALI.uhd.campus>
References: <586A4828D7AAA04CA9B258C50A28DA206DBC9B@BALI.uhd.campus>
Message-ID: <alpine.LNX.2.00.1109211717370.15303@salmo.appl-ecosys.com>

On Wed, 21 Sep 2011, Hodgess, Erin wrote:

> Does anyone have a small "real" data set with the longitude and latitude,
> along with a couple of data values per location that they would be willing
> to share, please?

Erin,

   If you look at <http://cran.r-project.org/web/views/Spatial.html> you'll
find a compendium of packages for various spatial statistical analyses. Most
packages come with data sets. You'll definitely find something to your
liking there.

Rich


From mdsumner at gmail.com  Thu Sep 22 02:20:02 2011
From: mdsumner at gmail.com (Michael Sumner)
Date: Thu, 22 Sep 2011 10:20:02 +1000
Subject: [R-sig-Geo] small data set for an example
In-Reply-To: <586A4828D7AAA04CA9B258C50A28DA206DBC9B@BALI.uhd.campus>
References: <586A4828D7AAA04CA9B258C50A28DA206DBC9B@BALI.uhd.campus>
Message-ID: <CAAcGz9-kMn9G-7OM6GY1M4AjajVKunGJW4k2b8xQBz10sO0dsg@mail.gmail.com>

Try the quakes data in package datasets:

data(quakes)

head(quakes)
     lat   long depth mag stations
1 -20.42 181.62   562 4.8       41
2 -20.62 181.03   650 4.2       15
3 -26.00 184.10    42 5.4       43
4 -17.97 181.66   626 4.1       19
5 -20.42 181.96   649 4.0       11
6 -19.68 184.31   195 4.0       12


Cheers, Mike.

On Thu, Sep 22, 2011 at 10:14 AM, Hodgess, Erin <HodgessE at uhd.edu> wrote:
> Dear R Sig Geo People:
>
> Does anyone have a small "real" data set with the longitude and latitude, along with a couple of data values per location that they would be willing to share, please?
>
>
>
> I'm using simulated data but thought it would be nice to try with a regular set.
>
> Thanks,
> Erin
>
> Erin M. Hodgess, PhD
> Associate Professor
> Department of Computer and Mathematical Sciences
> University of Houston - Downtown
> mailto: hodgesse at uhd.edu
>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Michael Sumner
Institute for Marine and Antarctic Studies, University of Tasmania
Hobart, Australia
e-mail: mdsumner at gmail.com


From tarabridwell at gmail.com  Thu Sep 22 02:44:51 2011
From: tarabridwell at gmail.com (Tara Bridwell)
Date: Wed, 21 Sep 2011 17:44:51 -0700
Subject: [R-sig-Geo] Determining unique values in a raster
In-Reply-To: <CANtt_hxrsJ8kCKE3dyEWMkZt_MQR=E0Wic1pEzCh3kvT32_zQg@mail.gmail.com>
References: <CAELQJc2smq7wd+APO4=E+Uk1cmBRw6i80CJW_hadMoWxUXx-BQ@mail.gmail.com>
	<CANtt_hxrsJ8kCKE3dyEWMkZt_MQR=E0Wic1pEzCh3kvT32_zQg@mail.gmail.com>
Message-ID: <CAELQJc31s+i3p5Tpb+yk8CoQeqaatk7VOcSHNVkRgmQSMmwh=Q@mail.gmail.com>

That was it - works perfectly now.  Thank you Robert.

Tara

On Wed, Sep 21, 2011 at 10:49 AM, Robert J. Hijmans <r.hijmans at gmail.com> wrote:
> Tara,
> raster_ct<- rasterize(coord.plus.value_sp, r,
> fun=function(value)?{length(unique(na.omit(value)))})
> This is wrong on two accounts. You do not use the "..." argument and you do
> not pass the vector "value" to rasterize (instead, you redefine it inside
> "fun")
> It should be:
> library(raster)
> r <- raster(ncol=10, nrow=10)
> x <- c(-45, -45, -45, 30, 30, 20, -10, 50, -7)
> y <- c(-25, -25, -25, 148, -148, 46, 23, 0, -69)
> xy <- cbind(x,y)
> species <- c(1, 2, 3, 1, 2, 3, 1, 1, 1)
> x1 <- rasterize(xy, r, field=species, fun=function(x,
> ...){length(unique(na.omit(x))) })
> # as you do not have NA values you can also do this
> x2 <- rasterize(xy, r, species, fun=function(x, ...){length(unique(x)) } )
>
> Best, Robert
> On Wed, Sep 21, 2011 at 10:13 AM, Tara Bridwell <tarabridwell at gmail.com>
> wrote:
>>
>> I am trying to determine the unique values within a raster, but am
>> having trouble. ?Here is some sample base data:
>>
>> require(raster)
>> r <- raster(ncol=10, nrow=10)
>> r[]=1:ncell(r)
>>
>> x <- c(-45, -45, -45, 30, 30, 20, -10, 50, -7)
>> y <- c(-25, -25, -25, 148, -148, 46, 23, 0, -69)
>> value <- c(1, 2, 3, 1, 2, 3, 1, 1, 1)
>> coord.plus.value <- cbind(x, y)
>> coord.plus.value_sp <- SpatialPoints(coord.plus.value)
>>
>> >From here I want to find the number of unique values in each cell of
>> the raster (i.e. 'richness'). ?To get around the need for an
>> na.rm=TRUE need for these functions, the documentation for rasterize
>> suggests:
>>
>> Note that the function must take an na.rm argument, either explicitly
>> or through 'dots'. This means that fun=lenght fails, but
>> fun=function(x,...)lenght(x) works (but ignores the na.rm argument. To
>> use the na.rm argument you can use a function like this
>> fun=function(x,na.rm){if (na.rm) length(na.omit(x)) else (length(x)},
>> or use a function that removes NA values in all cases, like this
>> function to compute the number of unique values "richness":
>> fun=function(x, ...){length(unique(na.omit(x)))}.
>> When I try this for my code:
>> raster_ct<- rasterize(coord.plus.value_sp, r, fun=function(value)
>> {length(unique(na.omit(value)))})
>>
>> I still get the following error:
>> Error in FUN(X[[1L]], ...) : unused argument(s) (na.rm = TRUE)
>>
>> Does anyone have any thoughts on why this is happening? ?I have tried
>> defining the function outside of the rasterize code but then I end up
>> with the same value in all cells.
>>
>> Thank you,
>> Tara Bridwell
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


From zbynek.janoska at centrum.cz  Thu Sep 22 08:18:55 2011
From: zbynek.janoska at centrum.cz (zbynek.janoska at centrum.cz)
Date: Wed, 21 Sep 2011 23:18:55 -0700 (PDT)
Subject: [R-sig-Geo] localG {spdep} - critical values for Gi* statistics
Message-ID: <1316672335499-6819053.post@n2.nabble.com>

Hello,
I am wondering, if it is posiible to obtain critical values for Gi
statistics calculated by localG {spdep} function.

In manual there is (quoting): The critical values of the statistic under
assumptions given in the references for the 95th percentile are for n=1:
1.645, n=50: 3.083, n=100: 3.289, n=1000: 3.886.

However, I have n=77, right in the middle between values given, and also I
wonder, whether critical values for Gi* and Gi are the same? I suppose they
are, since the difference is only in spatial weights, is it not?
Consequently, another percentile than 95th could be useful.

Thank You,
Zbynek

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/localG-spdep-critical-values-for-Gi-statistics-tp6819053p6819053.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From roman.lustrik at gmail.com  Thu Sep 22 08:26:48 2011
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Thu, 22 Sep 2011 08:26:48 +0200
Subject: [R-sig-Geo] Read statement in R advanced
In-Reply-To: <CAHnA5RUoFJQ4aubrqrGcUX0F3=1sBEF46jLf4X8GBO+aoHDR9A@mail.gmail.com>
References: <CAHnA5RUoFJQ4aubrqrGcUX0F3=1sBEF46jLf4X8GBO+aoHDR9A@mail.gmail.com>
Message-ID: <CAHT1vpjv3f286RtBGPDJG=-9_6eoDYWmh7FeTSh9QZjoXnF6YQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110922/dfcd8c22/attachment.pl>

From Roger.Bivand at nhh.no  Thu Sep 22 08:54:47 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 22 Sep 2011 08:54:47 +0200 (CEST)
Subject: [R-sig-Geo] localG {spdep} - critical values for Gi* statistics
In-Reply-To: <1316672335499-6819053.post@n2.nabble.com>
References: <1316672335499-6819053.post@n2.nabble.com>
Message-ID: <alpine.LRH.2.00.1109220844040.24494@reclus.nhh.no>

On Wed, 21 Sep 2011, zbynek.janoska at centrum.cz wrote:

> Hello,
> I am wondering, if it is posiible to obtain critical values for Gi
> statistics calculated by localG {spdep} function.
>
> In manual there is (quoting): The critical values of the statistic under
> assumptions given in the references for the 95th percentile are for n=1:
> 1.645, n=50: 3.083, n=100: 3.289, n=1000: 3.886.
>
> However, I have n=77, right in the middle between values given, and also I
> wonder, whether critical values for Gi* and Gi are the same? I suppose they
> are, since the difference is only in spatial weights, is it not?
> Consequently, another percentile than 95th could be useful.

The help page does point to the references, so they are where you should 
go. I'm not aware of anything else in the literature, but see:

Tonglin Zhang, Limiting distribution of the G statistics, Statistics and 
Probability Letters 78 (2008) 1656?1661

In any case, the p-values you are looking for will need Bonferroni or 
other adjustment, and as Zhang notes, when there are few neighbours, the 
assumption of normality will probably fail. The local Moran's I case is 
known in more detail, see Tiefelsdorf (2000) and papers citing his 
monograph.

Hope this helps,

Roger

>
> Thank You,
> Zbynek
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/localG-spdep-critical-values-for-Gi-statistics-tp6819053p6819053.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From paul.hiemstra at knmi.nl  Thu Sep 22 08:54:26 2011
From: paul.hiemstra at knmi.nl (Paul Hiemstra)
Date: Thu, 22 Sep 2011 06:54:26 +0000
Subject: [R-sig-Geo] Read statement in R advanced
In-Reply-To: <CAHnA5RUoFJQ4aubrqrGcUX0F3=1sBEF46jLf4X8GBO+aoHDR9A@mail.gmail.com>
References: <CAHnA5RUoFJQ4aubrqrGcUX0F3=1sBEF46jLf4X8GBO+aoHDR9A@mail.gmail.com>
Message-ID: <4E7ADBA2.3010403@knmi.nl>

 On 09/21/2011 11:31 PM, Sandeep Patil wrote:
> Hello everybody
>
> I have an excel file with 412 rows and about 15 variables , i need to
> perform the same suite of processes on the variables
> one after the other( these are long processes taking a lot of time)
>
> I have encoded missing data for each column as "NA" and the spatial data for
> each of the variable
>
> separately as X1, Y1, X2, Y2  so that there is 1-1 correspondence between
> coordinates and variables each time i use it.
>
> However when i read it into R it gives me an error saying that the number of
> rows and spatial data points.
>
> I want to assign the spatial points to *coordinates(file)=~Xi+Yi*  command
> and can anyone tell me is there
>
> anyway to tell R about missing data in each case. Any advice appreciated.
>
> Thank you
>
>

...provding us with a small piece of code that reproduces your problem
would be of great help here.

regards,
Paul

-- 
Paul Hiemstra, Ph.D.
Global Climate Division
Royal Netherlands Meteorological Institute (KNMI)
Wilhelminalaan 10 | 3732 GK | De Bilt | Kamer B 3.39
P.O. Box 201 | 3730 AE | De Bilt
tel: +31 30 2206 494

http://intamap.geo.uu.nl/~paul
http://nl.linkedin.com/pub/paul-hiemstra/20/30b/770


From paul.hiemstra at knmi.nl  Thu Sep 22 09:04:59 2011
From: paul.hiemstra at knmi.nl (Paul Hiemstra)
Date: Thu, 22 Sep 2011 07:04:59 +0000
Subject: [R-sig-Geo] help to change charactwer name in a row
	of	data.frame
In-Reply-To: <CAL3quv_pPWgvzyOQKV7udKBh-tO8yhsCWykDHUE3GK+oWdBzbA@mail.gmail.com>
References: <CAJ6JbR8KVQ6nnfSG2vZ7a0sAHS-ODe6dU3SdLxxumn-Kz5KzHg@mail.gmail.com>
	<CAL3quv_pPWgvzyOQKV7udKBh-tO8yhsCWykDHUE3GK+oWdBzbA@mail.gmail.com>
Message-ID: <4E7ADE1B.4020505@knmi.nl>

 On 09/21/2011 03:05 PM, Ndjido Ardo BAR wrote:
> Dear Gianni,
>
> you can also convert your x-column to be a character and then assign any
> value to the line you will, just as follows
>
> df <- data.frame(x=c("a","b","c"),y=c(1,2,3))
>
> df$x<-as.character(df$x)
>
> df[which(df$x=="b"),'x']<-"b%"       # notice the whith() statement can be
> replace by any number of line, as you may know

The which statement is superfluous, the vector (df$x == "b") is sufficient.

cheers,
Paul

>  df
>    x y
> 1  a 1
> 2 b% 2
> 3  c 3
>
>
> Cheers,
> Ardo.
>
>
> On Wed, Sep 21, 2011 at 4:18 PM, gianni lavaredo
> <gianni.lavaredo at gmail.com>wrote:
>
>> Dear Reaserchers,
>>
>> sorry for desturb you, but i tryed several solution but without results. I
>> have a data.frame (it's an example to explain)
>>
>> df <- data.frame(x=c("a","b","c"),y=c(1,2,3))
>>
>>> df
>>  x y
>> 1 a 1
>> 2 b 2
>> 3 c 3
>>
>>
>> and i wish to change same paramters in the column "x" as the following
>> result
>>
>>> df
>>  x y
>> 1 a 1
>> 2 b% 2
>> 3 c 3
>>
>>
>> thanks in advance. Normally to result easy stuff we spent a afternoon when
>> you need to send the result in the night
>>
>> Gianni
>>
>>        [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


-- 
Paul Hiemstra, Ph.D.
Global Climate Division
Royal Netherlands Meteorological Institute (KNMI)
Wilhelminalaan 10 | 3732 GK | De Bilt | Kamer B 3.39
P.O. Box 201 | 3730 AE | De Bilt
tel: +31 30 2206 494

http://intamap.geo.uu.nl/~paul
http://nl.linkedin.com/pub/paul-hiemstra/20/30b/770


From inaki.sagarzazu at nuffield.ox.ac.uk  Thu Sep 22 09:36:13 2011
From: inaki.sagarzazu at nuffield.ox.ac.uk (Inaki Sagarzazu)
Date: Thu, 22 Sep 2011 08:36:13 +0100
Subject: [R-sig-Geo] FW: GWAR - R
In-Reply-To: <alpine.LRH.2.00.1109220049160.22767@reclus.nhh.no>
References: <9538CBE90C88F94B82B565BA67BA6E8F2493F49432@EXMBX06.ad.oak.ox.ac.uk>,
	<alpine.LRH.2.00.1109220049160.22767@reclus.nhh.no>
Message-ID: <9538CBE90C88F94B82B565BA67BA6E8F2493F49449@EXMBX06.ad.oak.ox.ac.uk>


Hi,

I am trying to use gwr in R but I'm having problems because some of my polygons have missing values (NA) for the variables of interest. Do you have any suggestions on how to solve this?

thanks

---------------------------------------------------------------------------------------------------------------
I?aki Sagarzazu, PhD
Research Officer
Nuffield College
University of Oxford
OX1 1NF Oxford
United Kingdom

Office: 44 (0) 1 865 614990
Inaki.Sagarzazu at nuffield.ox.ac.uk
http://www.inaki-sagarzazu.com


From mathieu.rajerison at gmail.com  Thu Sep 22 11:29:30 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Thu, 22 Sep 2011 11:29:30 +0200
Subject: [R-sig-Geo] [spatstat] problem with a psp Line Segment Pattern when
 plotting and pointsOnlines performing
Message-ID: <CAGfc75nCg0PHnLrdDUd28WCRLTnax8Zr_r4pNkrme6+mv9Lp_A@mail.gmail.com>

Hi,

I Have a problem with a psp object.

I can't plot it, neither perform a pointsOnLines calculation on it.

---
Here is what I obtain with my different operations:
> track <- readOGR("voie.shp", "voie")
OGR data source with driver: ESRI Shapefile
Source: "voie.shp", layer: "voie"
with 1 features and 14 fields
Feature type: wkbLineString with 2 dimensions

> track.psp <- as(track, "psp")
Message d'avis :
In as.psp.SpatialLinesDataFrame(from) : 13 columns of data frame discarded

> plot(track.psp)
Erreur dans image.default(c(893999.767449278, 895777.422954333), c(Inf, -Inf
:
'x' and 'y' values must be finite and non-missing

#plot(track) is OK

> pts <- pointsOnLines(track.psp, eps=50)
Erreur dans ppp(x = x, y = y, window = win) :
all coordinate values are NA or NaN
---

Any help would be appreciated.

The related SpatialLinesDataFrame track object is attached to this mail if
you'd like to have a look..

Thanks!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110922/f5a904b5/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: track.RData
Type: application/octet-stream
Size: 2925 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110922/f5a904b5/attachment.obj>

From ospa43 at bangor.ac.uk  Thu Sep 22 11:49:25 2011
From: ospa43 at bangor.ac.uk (Whiteley,Holly)
Date: Thu, 22 Sep 2011 10:49:25 +0100
Subject: [R-sig-Geo] Calculate the surface of polygons within gridcells
 with gIntersection
Message-ID: <4E7B04A5.9050102@bangor.ac.uk>

Dear list,
I was wondering if someone could help me with polygon-polygon spatial 
queries?

Similar to the below request in a previous thread, I have a 
SpatialPolygonDataFrame for an environmental factor (seabed sediment), 
and a gridded SpatialPolygonDataFrame. I am attempting to calculate the 
area of the different seabed sediment types within each cell of the 
polygon grid. I then hope to identify the dominant sediment type in 
terms of area for each cell and write it to a new dataframe against the 
IDs of the cells in the polygon grid.

I started adapting the script that Roger Bivand provided in the below 
message (I hope I have understood correctly), but when I run this line:

 > for (i in seq(along=vec)) vec[[i]] <- try(gIntersection(sediment[i,], 
grid[int[,i],], byid=TRUE))

I get this error message, which I don't understand:

Error in if (is.numeric(i) && i < 0) { :
   missing value where TRUE/FALSE needed

I'd really appreciate any help you could offer me for getting round this 
issue.

Many thanks for your time,
Holly

-----------------------------------
Original message
-----------------------------------

Re: [R-sig-Geo] Calculate the surface of polygons within gridcells with 
gIntersection
Roger Bivand
Wed, 29 Jun 2011 06:43:29 -0700

On Wed, 29 Jun 2011, Eelke Folmer wrote:

Hi all,

I have a polygon shapefile with a column in the attribute table denoting 
class (in my case "habitat"). I construct a gridded 
SpatialPolygonsDataFrame. For each gridcell I'd like to be able to 
obtain the surface of each of the classes from the polygon shapefile 
resulting in something like this:

cell    classA  classB  classC
1       10      25      31
2       53      23      0
3       13      25      ..
4 .. .. .. I tried by means of gIntersection (rgeos) to make a new 
geometry but I run into difficulties (see below for a reproducable 
example). If I were to obtain a new geometry I would probably be able to 
match the grid with the area (perhaps looping through the classes?). I'd 
suspect that this is a relatively common operation and I wonder if there 
is a more direct way (within R).

Example:
require(raster)
require(rgeos)

ext = extent(c(0, 10, 0, 10))
grd     <- raster(ext, nrows=10, ncols=10, crs=NA )
grd.pol <- rasterToPolygons(grd, fun=NULL, n=4, na.rm=TRUE, digits=12)

grd2     <- raster(ext-1.5, nrows=5, ncols=5, crs=NA )
grd.pol2 <- rasterToPolygons(grd2, fun=NULL, n=4, na.rm=TRUE, digits=12)

plot(grd.pol)
plot(grd.pol2, add=T, lty=2)

int <- gIntersection(grd.pol2, grd.pol, byid=T)

Error in RGEOSBinTopoFunc(spgeom1, spgeom2, byid, id, 
"rgeos_intersection") : Geometry collections may not contain other 
geometry collections


With byid=TRUE, you may end up with rgeos trying to re-assemble things 
in a different way than you intended. With reference to an earlier 
thread this month, if you do:

int <- gIntersects(grd.pol2, grd.pol, byid=TRUE)
vec <- vector(mode="list", length=dim(int)[2])
for (i in seq(along=vec)) vec[[i]] <- try(gIntersection(grd.pol2[i,], 
grd.pol[int[,i],], byid=TRUE))
out <- do.call("rbind", vec)
rn <- row.names(out)
nrn <- do.call("rbind", strsplit(rn, " "))
df <- data.frame(pol2=nrn[,1], pol=nrn[,2], area=sapply(slot(out,
   "polygons"), slot, "area"))
plot(grd.pol, border="red")
plot(grd.pol2, border="green", add=TRUE)
plot(out, col="#00FFFF64", add=TRUE, border="transparent")
text(coordinates(grd.pol), labels=row.names(grd.pol), cex=0.5)
head(df)

you can see that you are now getting a Polygons object for each 
intersection, which you should be able to tally.

Using a predicate first (and it is also possible to use STRtrees) also 
saves time, but we wanted to get the standard facilities of rgeos 
working before optimising, so the optimisation should be done by hand.

Hope this helps,

Roger


I have tried with various other geometries (polygon shapefiles) and run 
into the same problem. I have also searched the the mailing list for a 
hint how to carry on but with no luck.

Thanks for a powerful library anyway!

Eelke

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From mdsumner at gmail.com  Thu Sep 22 12:05:19 2011
From: mdsumner at gmail.com (Michael Sumner)
Date: Thu, 22 Sep 2011 20:05:19 +1000
Subject: [R-sig-Geo] [spatstat] problem with a psp Line Segment Pattern
 when plotting and pointsOnlines performing
In-Reply-To: <CAGfc75nCg0PHnLrdDUd28WCRLTnax8Zr_r4pNkrme6+mv9Lp_A@mail.gmail.com>
References: <CAGfc75nCg0PHnLrdDUd28WCRLTnax8Zr_r4pNkrme6+mv9Lp_A@mail.gmail.com>
Message-ID: <CAAcGz9-0_poTGjjtHPJAwmMiCJzje1867w+ZCyEjUg-mAA9LLw@mail.gmail.com>

The problem is that the first attribute on the track object, "ID" is
NA - and when plot.psp is trying to draw a legend it has nothing to
base the image "ribbon" on.

This should avoid the error:

plot(track.psp, ribbon = FALSE)

Try subsetting the attributes in the coercion to psp, choose which
column you want from names(track) but note that with only one row the
ribbon legend will never be very interesting:

track.psp <- as(track[,"PREC_PLANI"], "psp")

plot(track.psp)

Finally, do include sessionInfo() as requested - you have not let us
know that you require packages sp, rgdal, maptools, and spatstat - and
all of that is very important when determining what is going on.

Cheers, Mike.

On Thu, Sep 22, 2011 at 7:29 PM, Mathieu Rajerison
<mathieu.rajerison at gmail.com> wrote:
> Hi,
>
> I Have a problem with a psp object.
>
> I can't plot it, neither perform a pointsOnLines calculation on it.
>
> ---
> Here is what I obtain with my different operations:
>> track <- readOGR("voie.shp", "voie")
> OGR data source with driver: ESRI Shapefile
> Source: "voie.shp", layer: "voie"
> with 1 features and 14 fields
> Feature type: wkbLineString with 2 dimensions
>
>> track.psp <- as(track, "psp")
> Message d'avis :
> In as.psp.SpatialLinesDataFrame(from) : 13 columns of data frame discarded
>
>> plot(track.psp)
> Erreur dans image.default(c(893999.767449278, 895777.422954333), c(Inf, -Inf
> :
> 'x' and 'y' values must be finite and non-missing
>
> #plot(track) is OK
>
>> pts <- pointsOnLines(track.psp, eps=50)
> Erreur dans ppp(x = x, y = y, window = win) :
> all coordinate values are NA or NaN
> ---
>
> Any help would be appreciated.
>
> The related SpatialLinesDataFrame track object is attached to this mail if
> you'd like to have a look..
>
> Thanks!
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>



-- 
Michael Sumner
Institute for Marine and Antarctic Studies, University of Tasmania
Hobart, Australia
e-mail: mdsumner at gmail.com
-------------- next part --------------
A non-text attachment was scrubbed...
Name: track.RData
Type: application/octet-stream
Size: 2925 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110922/05f2471b/attachment.obj>

From b.rowlingson at lancaster.ac.uk  Thu Sep 22 12:05:54 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Thu, 22 Sep 2011 11:05:54 +0100
Subject: [R-sig-Geo] small data set for an example
In-Reply-To: <586A4828D7AAA04CA9B258C50A28DA206DBC9B@BALI.uhd.campus>
References: <Acx4vI/FGv3VKykrTrWGxLRLHndWpw==>
	<586A4828D7AAA04CA9B258C50A28DA206DBC9B@BALI.uhd.campus>
Message-ID: <CANVKczNAnAbU58k4KsVB18JTPL3JdeNnxLZEVFAiXSg9oXYkMA@mail.gmail.com>

On Thu, Sep 22, 2011 at 1:14 AM, Hodgess, Erin <HodgessE at uhd.edu> wrote:
> Dear R Sig Geo People:
>
> Does anyone have a small "real" data set with the longitude and latitude, along with a couple of data values per location that they would be willing to share, please?
>
>
>
> I'm using simulated data but thought it would be nice to try with a regular set.

 If you want something that's literally up-to-the-minute then try the
USGS real-time earthquake data, available in CSV format so you can
just read.csv-it directly. Various ones listed here:

http://earthquake.usgs.gov/earthquakes/catalogs/

 > require(sp)
 > url="http://earthquake.usgs.gov/earthquakes/catalogs/eqs1day-M1.txt"
 > q=read.csv(url)
 > coordinates(q)=~Lon+Lat
 > plot(q)

you get the depth and magnitude of the quake, as well as the "NST" but
I don't know what that is...

Barry


From e.o.folmer at gmail.com  Thu Sep 22 12:31:15 2011
From: e.o.folmer at gmail.com (Eelke Folmer)
Date: Thu, 22 Sep 2011 12:31:15 +0200
Subject: [R-sig-Geo] Calculate the surface of polygons within gridcells
 with gIntersection
In-Reply-To: <4E7B04A5.9050102@bangor.ac.uk>
References: <4E7B04A5.9050102@bangor.ac.uk>
Message-ID: <4E7B0E73.1070603@gmail.com>

Hi Holly,
Could you provide some insight into your int object. Does it happen for 
all i?
My first guess is that your matrix 'int' might not be what you expect; 
try: grid[int[,i],] and see whether it is a geometry.
Eelke


Op 8:59 PM, Whiteley,Holly schreef:
> Dear list,
> I was wondering if someone could help me with polygon-polygon spatial
> queries?
>
> Similar to the below request in a previous thread, I have a
> SpatialPolygonDataFrame for an environmental factor (seabed sediment),
> and a gridded SpatialPolygonDataFrame. I am attempting to calculate the
> area of the different seabed sediment types within each cell of the
> polygon grid. I then hope to identify the dominant sediment type in
> terms of area for each cell and write it to a new dataframe against the
> IDs of the cells in the polygon grid.
>
> I started adapting the script that Roger Bivand provided in the below
> message (I hope I have understood correctly), but when I run this line:
>
>  > for (i in seq(along=vec)) vec[[i]] <- try(gIntersection(sediment[i,],
> grid[int[,i],], byid=TRUE))
>
> I get this error message, which I don't understand:
>
> Error in if (is.numeric(i) && i < 0) { :
> missing value where TRUE/FALSE needed
>
> I'd really appreciate any help you could offer me for getting round this
> issue.
>
> Many thanks for your time,
> Holly
>
> -----------------------------------
> Original message
> -----------------------------------
>
> Re: [R-sig-Geo] Calculate the surface of polygons within gridcells with
> gIntersection
> Roger Bivand
> Wed, 29 Jun 2011 06:43:29 -0700
>
> On Wed, 29 Jun 2011, Eelke Folmer wrote:
>
> Hi all,
>
> I have a polygon shapefile with a column in the attribute table denoting
> class (in my case "habitat"). I construct a gridded
> SpatialPolygonsDataFrame. For each gridcell I'd like to be able to
> obtain the surface of each of the classes from the polygon shapefile
> resulting in something like this:
>
> cell classA classB classC
> 1 10 25 31
> 2 53 23 0
> 3 13 25 ..
> 4 .. .. .. I tried by means of gIntersection (rgeos) to make a new
> geometry but I run into difficulties (see below for a reproducable
> example). If I were to obtain a new geometry I would probably be able to
> match the grid with the area (perhaps looping through the classes?). I'd
> suspect that this is a relatively common operation and I wonder if there
> is a more direct way (within R).
>
> Example:
> require(raster)
> require(rgeos)
>
> ext = extent(c(0, 10, 0, 10))
> grd <- raster(ext, nrows=10, ncols=10, crs=NA )
> grd.pol <- rasterToPolygons(grd, fun=NULL, n=4, na.rm=TRUE, digits=12)
>
> grd2 <- raster(ext-1.5, nrows=5, ncols=5, crs=NA )
> grd.pol2 <- rasterToPolygons(grd2, fun=NULL, n=4, na.rm=TRUE, digits=12)
>
> plot(grd.pol)
> plot(grd.pol2, add=T, lty=2)
>
> int <- gIntersection(grd.pol2, grd.pol, byid=T)
>
> Error in RGEOSBinTopoFunc(spgeom1, spgeom2, byid, id,
> "rgeos_intersection") : Geometry collections may not contain other
> geometry collections
>
>
> With byid=TRUE, you may end up with rgeos trying to re-assemble things
> in a different way than you intended. With reference to an earlier
> thread this month, if you do:
>
> int <- gIntersects(grd.pol2, grd.pol, byid=TRUE)
> vec <- vector(mode="list", length=dim(int)[2])
> for (i in seq(along=vec)) vec[[i]] <- try(gIntersection(grd.pol2[i,],
> grd.pol[int[,i],], byid=TRUE))
> out <- do.call("rbind", vec)
> rn <- row.names(out)
> nrn <- do.call("rbind", strsplit(rn, " "))
> df <- data.frame(pol2=nrn[,1], pol=nrn[,2], area=sapply(slot(out,
> "polygons"), slot, "area"))
> plot(grd.pol, border="red")
> plot(grd.pol2, border="green", add=TRUE)
> plot(out, col="#00FFFF64", add=TRUE, border="transparent")
> text(coordinates(grd.pol), labels=row.names(grd.pol), cex=0.5)
> head(df)
>
> you can see that you are now getting a Polygons object for each
> intersection, which you should be able to tally.
>
> Using a predicate first (and it is also possible to use STRtrees) also
> saves time, but we wanted to get the standard facilities of rgeos
> working before optimising, so the optimisation should be done by hand.
>
> Hope this helps,
>
> Roger
>
>
> I have tried with various other geometries (polygon shapefiles) and run
> into the same problem. I have also searched the the mailing list for a
> hint how to carry on but with no luck.
>
> Thanks for a powerful library anyway!
>
> Eelke
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


From mathieu.rajerison at gmail.com  Thu Sep 22 13:00:03 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Thu, 22 Sep 2011 13:00:03 +0200
Subject: [R-sig-Geo] [spatstat] problem with a psp Line Segment Pattern
 when plotting and pointsOnlines performing
In-Reply-To: <CAAcGz9-0_poTGjjtHPJAwmMiCJzje1867w+ZCyEjUg-mAA9LLw@mail.gmail.com>
References: <CAGfc75nCg0PHnLrdDUd28WCRLTnax8Zr_r4pNkrme6+mv9Lp_A@mail.gmail.com>
	<CAAcGz9-0_poTGjjtHPJAwmMiCJzje1867w+ZCyEjUg-mAA9LLw@mail.gmail.com>
Message-ID: <CAGfc75=R3YpT6=vb+eCEQ5CoYiA5oGfohnjcK-PwZVZBF=R4Wg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110922/e7094a63/attachment.pl>

From aslantas at metu.edu.tr  Thu Sep 22 13:38:28 2011
From: aslantas at metu.edu.tr (=?utf-8?Q?P=C4=B1nar_Aslantas_Bostan?=)
Date: Thu, 22 Sep 2011 14:38:28 +0300
Subject: [R-sig-Geo] about ST kriging
In-Reply-To: <4E79DC85.7050808@uni-muenster.de>
References: <001101cc7775$c6f92f00$54eb8d00$@edu.tr>
	<4E79DC85.7050808@uni-muenster.de>
Message-ID: <001f01cc791c$262cfef0$7286fcd0$@edu.tr>

Hi Edzer,

Thank you very much for your mail. I found two records have identical location, but it is not my fault because I checked the original source data and it is erroneous. 

Now I have another problem; R gives another error message:
Error: cannot allocate vector of size 95.4 Mb

My computer includes 32-bit Windows and  3,5 GB RAM. I am not sure if I install 64-bit Windows, then the problem is solved? Or maybe I should minimize the data. Do you have any idea about it?

Best wishes,
Pinar

-----Original Message-----
From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Edzer Pebesma
Sent: Wednesday, September 21, 2011 3:46 PM
To: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] about ST kriging

Hi Pinar,

it is not clear which variogram model you pass, or how your data are
laid out in space and time.

Possible causes for a non-positive definite covariance matrix include:

- a variogram model with (nearly) perfect correlation
- duplicate observations (observations having identical location AND time)
- an invalid variogram model

A small, reproducible example (data + script) would help identify the
problem.

Best regards,
--
Edzer

On 09/20/2011 11:15 AM, P?nar Aslantas Bostan wrote:
> Dear all,
> 
> I am working about space-time kriging. Before I asked again about ST kriging
> but now the problem is 
> different and I could not overcome it!
> 
> During kriging operation I got this error:
> 
>> pred = krigeST(prec~1, w, STS(grid,time,index), v)
> Error in chol.default(A$Sm, LINPACK = TRUE) : 
>   non-positive definite matrix in 'chol'
> 
> I explained the data set below:
> 
> # prec is annual precipitation measured from 257 meteorological stations
> 
> # w is STSDF object
>> summary(w)
> Object of class STSDF
> [[Spatial:]]
> Object of class SpatialPoints
> Coordinates:
>          min     max
> Xnew  140556 1730472
> Ynew 4309064 4971309
> Is projected: NA 
> proj4string : [NA]
> Number of points: 257
> [[Temporal:]]
>      Index                      object at time  
>  Min.   :1970-01-01 12:00:00   Min.   : 1.0  
>  1st Qu.:1979-07-03 00:00:00   1st Qu.:10.5  
>  Median :1989-01-01 12:00:00   Median :20.0  
>  Mean   :1989-01-01 02:46:09   Mean   :20.0  
>  3rd Qu.:1998-07-03 00:00:00   3rd Qu.:29.5  
>  Max.   :2008-01-01 12:00:00   Max.   :39.0  
> [[Data attributes:]]
>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
>   114.5   413.7   533.6   633.0   735.6  3332.0 
> 
> # I used grid to obtain predictions over it. It has 25 km spatial resolution
> 
> # time is temporal entity of study. It contains 39 annual observation.
> 
> # index is required for STSDF, and I used this code to create index.
>> index <- cbind(as.integer(as.factor(data$Station)),
> as.integer(as.factor(data$Year)))
> 
> # v is space-time variogram
> 
> How can I solve the problem?
> Thank you in advance!
> 
> 
> Pinar Aslantas Bostan
> Research Assistant
> Department of Geodetic and
> Geographic Information Technologies (GGIT) Middle East Technical University
> 06531 Ankara/TURKEY
> aslantas at metu.edu.tr
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From kvormoor at uni-bonn.de  Thu Sep 22 13:45:44 2011
From: kvormoor at uni-bonn.de (Klaus Vormoor)
Date: Thu, 22 Sep 2011 04:45:44 -0700 (PDT)
Subject: [R-sig-Geo] downscaling grid data; alternative for interp()?
Message-ID: <1316691944938-6819843.post@n2.nabble.com>

Hi,

I am struggling with this quite a while already, and I haven't found a good
solution so far.
I want to disaggregate precipitation data. For this I have a grid with daily
precipitation in 1x1 km resolution, and additionally 24 grids with 10x10 km
resolution giving percentage charge of hourly precipitation for the same day
as factors (range 0 to 1). The first grid is in UTM coordinates and the
other 24 are in longlat coordinates. Now, I want to transfer the factors
from the 10x10 km grids to grids of the same size as the 1x1 km daily
precipitation grid. What I have done so far is: 

1. Generate SpatialPoints with the longlat coordinates for the 10x10 km grid
(comming as netCDF).
2. Convert longlat coordinates to UTM coordinates (spTransform), adding the
data values to a SpatialPointDataFrame
3. Interpolate data from the converted SpatialPpointDataFrame to a grid of
the same size and extention as my 1x1 km grid by using the function interp()
from the akima package.  

However, instead of interpolating I'd rather like to use a kind of nearest
neigbour classification because I want to avoid "smoothing" of my factors.
Furthermore, interp() is relatively time consuming. Since I have to repeat
this procedure for many days, it would be nice to have a quicker
alternative. Does anyone have an idea?

Any hint is much appreciated.

Klaus  



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/downscaling-grid-data-alternative-for-interp-tp6819843p6819843.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From edzer.pebesma at uni-muenster.de  Thu Sep 22 13:47:24 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 22 Sep 2011 13:47:24 +0200
Subject: [R-sig-Geo] about ST kriging
In-Reply-To: <001f01cc791c$262cfef0$7286fcd0$@edu.tr>
References: <001101cc7775$c6f92f00$54eb8d00$@edu.tr>
	<4E79DC85.7050808@uni-muenster.de>
	<001f01cc791c$262cfef0$7286fcd0$@edu.tr>
Message-ID: <4E7B204C.30001@uni-muenster.de>

Pinar, what are the dimensions (space and time) of your data, i.e. what
does dim(w) return?

Have you tried kriging with a (spatial and/or temporal) subset?

On 09/22/2011 01:38 PM, P?nar Aslantas Bostan wrote:
> Hi Edzer,
> 
> Thank you very much for your mail. I found two records have identical location, but it is not my fault because I checked the original source data and it is erroneous. 
> 
> Now I have another problem; R gives another error message:
> Error: cannot allocate vector of size 95.4 Mb
> 
> My computer includes 32-bit Windows and  3,5 GB RAM. I am not sure if I install 64-bit Windows, then the problem is solved? Or maybe I should minimize the data. Do you have any idea about it?
> 
> Best wishes,
> Pinar
> 
> -----Original Message-----
> From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Edzer Pebesma
> Sent: Wednesday, September 21, 2011 3:46 PM
> To: r-sig-geo at r-project.org
> Subject: Re: [R-sig-Geo] about ST kriging
> 
> Hi Pinar,
> 
> it is not clear which variogram model you pass, or how your data are
> laid out in space and time.
> 
> Possible causes for a non-positive definite covariance matrix include:
> 
> - a variogram model with (nearly) perfect correlation
> - duplicate observations (observations having identical location AND time)
> - an invalid variogram model
> 
> A small, reproducible example (data + script) would help identify the
> problem.
> 
> Best regards,
> --
> Edzer
> 
> On 09/20/2011 11:15 AM, P?nar Aslantas Bostan wrote:
>> Dear all,
>>
>> I am working about space-time kriging. Before I asked again about ST kriging
>> but now the problem is 
>> different and I could not overcome it!
>>
>> During kriging operation I got this error:
>>
>>> pred = krigeST(prec~1, w, STS(grid,time,index), v)
>> Error in chol.default(A$Sm, LINPACK = TRUE) : 
>>   non-positive definite matrix in 'chol'
>>
>> I explained the data set below:
>>
>> # prec is annual precipitation measured from 257 meteorological stations
>>
>> # w is STSDF object
>>> summary(w)
>> Object of class STSDF
>> [[Spatial:]]
>> Object of class SpatialPoints
>> Coordinates:
>>          min     max
>> Xnew  140556 1730472
>> Ynew 4309064 4971309
>> Is projected: NA 
>> proj4string : [NA]
>> Number of points: 257
>> [[Temporal:]]
>>      Index                      object at time  
>>  Min.   :1970-01-01 12:00:00   Min.   : 1.0  
>>  1st Qu.:1979-07-03 00:00:00   1st Qu.:10.5  
>>  Median :1989-01-01 12:00:00   Median :20.0  
>>  Mean   :1989-01-01 02:46:09   Mean   :20.0  
>>  3rd Qu.:1998-07-03 00:00:00   3rd Qu.:29.5  
>>  Max.   :2008-01-01 12:00:00   Max.   :39.0  
>> [[Data attributes:]]
>>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
>>   114.5   413.7   533.6   633.0   735.6  3332.0 
>>
>> # I used grid to obtain predictions over it. It has 25 km spatial resolution
>>
>> # time is temporal entity of study. It contains 39 annual observation.
>>
>> # index is required for STSDF, and I used this code to create index.
>>> index <- cbind(as.integer(as.factor(data$Station)),
>> as.integer(as.factor(data$Year)))
>>
>> # v is space-time variogram
>>
>> How can I solve the problem?
>> Thank you in advance!
>>
>>
>> Pinar Aslantas Bostan
>> Research Assistant
>> Department of Geodetic and
>> Geographic Information Technologies (GGIT) Middle East Technical University
>> 06531 Ankara/TURKEY
>> aslantas at metu.edu.tr
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From paul.hiemstra at knmi.nl  Thu Sep 22 13:49:35 2011
From: paul.hiemstra at knmi.nl (Paul Hiemstra)
Date: Thu, 22 Sep 2011 11:49:35 +0000
Subject: [R-sig-Geo] downscaling grid data; alternative for interp()?
In-Reply-To: <1316691944938-6819843.post@n2.nabble.com>
References: <1316691944938-6819843.post@n2.nabble.com>
Message-ID: <4E7B20CF.6020605@knmi.nl>

 Hi,

A trick to get Nearest Neighbor (NN) is to use idw() from the gstat
package with setting the nmax parameter to 1. This limits the amount of
points used for the inverse distance weighted average to one, leading to
NN. I'm not sure if this is much faster than interp, but you can take a
look.

regards,
Paul

On 09/22/2011 11:45 AM, Klaus Vormoor wrote:
> Hi,
>
> I am struggling with this quite a while already, and I haven't found a good
> solution so far.
> I want to disaggregate precipitation data. For this I have a grid with daily
> precipitation in 1x1 km resolution, and additionally 24 grids with 10x10 km
> resolution giving percentage charge of hourly precipitation for the same day
> as factors (range 0 to 1). The first grid is in UTM coordinates and the
> other 24 are in longlat coordinates. Now, I want to transfer the factors
> from the 10x10 km grids to grids of the same size as the 1x1 km daily
> precipitation grid. What I have done so far is: 
>
> 1. Generate SpatialPoints with the longlat coordinates for the 10x10 km grid
> (comming as netCDF).
> 2. Convert longlat coordinates to UTM coordinates (spTransform), adding the
> data values to a SpatialPointDataFrame
> 3. Interpolate data from the converted SpatialPpointDataFrame to a grid of
> the same size and extention as my 1x1 km grid by using the function interp()
> from the akima package.  
>
> However, instead of interpolating I'd rather like to use a kind of nearest
> neigbour classification because I want to avoid "smoothing" of my factors.
> Furthermore, interp() is relatively time consuming. Since I have to repeat
> this procedure for many days, it would be nice to have a quicker
> alternative. Does anyone have an idea?
>
> Any hint is much appreciated.
>
> Klaus  
>
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/downscaling-grid-data-alternative-for-interp-tp6819843p6819843.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


-- 
Paul Hiemstra, Ph.D.
Global Climate Division
Royal Netherlands Meteorological Institute (KNMI)
Wilhelminalaan 10 | 3732 GK | De Bilt | Kamer B 3.39
P.O. Box 201 | 3730 AE | De Bilt
tel: +31 30 2206 494

http://intamap.geo.uu.nl/~paul
http://nl.linkedin.com/pub/paul-hiemstra/20/30b/770


From mdsumner at gmail.com  Thu Sep 22 14:11:17 2011
From: mdsumner at gmail.com (Michael Sumner)
Date: Thu, 22 Sep 2011 22:11:17 +1000
Subject: [R-sig-Geo] [spatstat] problem with a psp Line Segment Pattern
 when plotting and pointsOnlines performing
In-Reply-To: <CAGfc75=R3YpT6=vb+eCEQ5CoYiA5oGfohnjcK-PwZVZBF=R4Wg@mail.gmail.com>
References: <CAGfc75nCg0PHnLrdDUd28WCRLTnax8Zr_r4pNkrme6+mv9Lp_A@mail.gmail.com>
	<CAAcGz9-0_poTGjjtHPJAwmMiCJzje1867w+ZCyEjUg-mAA9LLw@mail.gmail.com>
	<CAGfc75=R3YpT6=vb+eCEQ5CoYiA5oGfohnjcK-PwZVZBF=R4Wg@mail.gmail.com>
Message-ID: <CAAcGz98vxa4BOC-t-p8pw8fY_LyM3SrxsnRLw=um-roVtckeGQ@mail.gmail.com>

It seems it is because one of your line segments is of length zero,
using your attachment:

load("track.RData")
library(spatstat)
which(!lengths.psp(track.psp) > 0)
[1] 17

Dropping the offender:

noZeroLengths <- track.psp[lengths.psp(track.psp) > 0]

(pts <- pointsOnLines(noZeroLengths, eps=50))
 planar point pattern: 1134 points
window: rectangle = [865841.7, 888666.8] x [6265115, 6300668] units

You might want to investigate why you have a zero length line segment
in your original shapefile, there's a lot of options for what you
might do in R but where you catch it depends on your main goals I
guess.

I think there are some good suggestions here for catching these cases
in spatstat and sp, but I haven't looked closely enough yet to say
anything helpful.

Cheers, Mike.

On Thu, Sep 22, 2011 at 9:00 PM, Mathieu Rajerison
<mathieu.rajerison at gmail.com> wrote:
> Thanks for the answer!
>
> I coerced my SpatialLinesDataFrame object to a psp object using a non-NA
> column.
>
> Plotting is OK but pointsOnLines still fails:
>
>> track.psp <- as(track[, 2], "psp")
>> plot(track.psp)
>> pts<-pointsOnLines(track.psp, eps=50)
> Erreur dans ppp(x = x, y = y, window = win) :
> all coordinate values are NA or NaN
>
> What's wrong?
>
> 2011/9/22 Michael Sumner <mdsumner at gmail.com>
>
>> The problem is that the first attribute on the track object, "ID" is
>> NA - and when plot.psp is trying to draw a legend it has nothing to
>> base the image "ribbon" on.
>>
>> This should avoid the error:
>>
>> plot(track.psp, ribbon = FALSE)
>>
>> Try subsetting the attributes in the coercion to psp, choose which
>> column you want from names(track) but note that with only one row the
>> ribbon legend will never be very interesting:
>>
>> track.psp <- as(track[,"PREC_PLANI"], "psp")
>>
>> plot(track.psp)
>>
>> Finally, do include sessionInfo() as requested - you have not let us
>> know that you require packages sp, rgdal, maptools, and spatstat - and
>> all of that is very important when determining what is going on.
>>
>> Cheers, Mike.
>>
>> On Thu, Sep 22, 2011 at 7:29 PM, Mathieu Rajerison
>> <mathieu.rajerison at gmail.com> wrote:
>> > Hi,
>> >
>> > I Have a problem with a psp object.
>> >
>> > I can't plot it, neither perform a pointsOnLines calculation on it.
>> >
>> > ---
>> > Here is what I obtain with my different operations:
>> >> track <- readOGR("voie.shp", "voie")
>> > OGR data source with driver: ESRI Shapefile
>> > Source: "voie.shp", layer: "voie"
>> > with 1 features and 14 fields
>> > Feature type: wkbLineString with 2 dimensions
>> >
>> >> track.psp <- as(track, "psp")
>> > Message d'avis :
>> > In as.psp.SpatialLinesDataFrame(from) : 13 columns of data frame
>> discarded
>> >
>> >> plot(track.psp)
>> > Erreur dans image.default(c(893999.767449278, 895777.422954333), c(Inf,
>> -Inf
>> > :
>> > 'x' and 'y' values must be finite and non-missing
>> >
>> > #plot(track) is OK
>> >
>> >> pts <- pointsOnLines(track.psp, eps=50)
>> > Erreur dans ppp(x = x, y = y, window = win) :
>> > all coordinate values are NA or NaN
>> > ---
>> >
>> > Any help would be appreciated.
>> >
>> > The related SpatialLinesDataFrame track object is attached to this mail
>> if
>> > you'd like to have a look..
>> >
>> > Thanks!
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at r-project.org
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >
>> >
>>
>>
>>
>> --
>> Michael Sumner
>> Institute for Marine and Antarctic Studies, University of Tasmania
>> Hobart, Australia
>> e-mail: mdsumner at gmail.com
>>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Michael Sumner
Institute for Marine and Antarctic Studies, University of Tasmania
Hobart, Australia
e-mail: mdsumner at gmail.com


From mathieu.rajerison at gmail.com  Thu Sep 22 14:18:24 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Thu, 22 Sep 2011 14:18:24 +0200
Subject: [R-sig-Geo] [spatstat] problem with a psp Line Segment Pattern
 when plotting and pointsOnlines performing
In-Reply-To: <CAAcGz98vxa4BOC-t-p8pw8fY_LyM3SrxsnRLw=um-roVtckeGQ@mail.gmail.com>
References: <CAGfc75nCg0PHnLrdDUd28WCRLTnax8Zr_r4pNkrme6+mv9Lp_A@mail.gmail.com>
	<CAAcGz9-0_poTGjjtHPJAwmMiCJzje1867w+ZCyEjUg-mAA9LLw@mail.gmail.com>
	<CAGfc75=R3YpT6=vb+eCEQ5CoYiA5oGfohnjcK-PwZVZBF=R4Wg@mail.gmail.com>
	<CAAcGz98vxa4BOC-t-p8pw8fY_LyM3SrxsnRLw=um-roVtckeGQ@mail.gmail.com>
Message-ID: <CAGfc75=D_cp7v4umgJ7ca6VZC7Ue_td_2KDes4CKO1tZkCMSeQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110922/d733294d/attachment.pl>

From aslantas at metu.edu.tr  Thu Sep 22 14:39:08 2011
From: aslantas at metu.edu.tr (=?utf-8?Q?P=C4=B1nar_Aslantas_Bostan?=)
Date: Thu, 22 Sep 2011 15:39:08 +0300
Subject: [R-sig-Geo] about ST kriging
In-Reply-To: <4E7B204C.30001@uni-muenster.de>
References: <001101cc7775$c6f92f00$54eb8d00$@edu.tr>
	<4E79DC85.7050808@uni-muenster.de>
	<001f01cc791c$262cfef0$7286fcd0$@edu.tr>
	<4E7B204C.30001@uni-muenster.de>
Message-ID: <002001cc7924$9fb5d820$df218860$@edu.tr>

Edzer, I have 256 meteorological station and 39 year value.

> dim(w)
[1] 256  39   1

Before I tried only spatial kriging and I did not get memory.size error. Just a moment ago, I used another computer (64-bit Windows and 6 GB RAM), again I got the same error. 

-----Original Message-----
From: Edzer Pebesma [mailto:edzer.pebesma at uni-muenster.de] 
Sent: Thursday, September 22, 2011 2:47 PM
To: P?nar Aslantas Bostan
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] about ST kriging

Pinar, what are the dimensions (space and time) of your data, i.e. what
does dim(w) return?

Have you tried kriging with a (spatial and/or temporal) subset?

On 09/22/2011 01:38 PM, P?nar Aslantas Bostan wrote:
> Hi Edzer,
> 
> Thank you very much for your mail. I found two records have identical location, but it is not my fault because I checked the original source data and it is erroneous. 
> 
> Now I have another problem; R gives another error message:
> Error: cannot allocate vector of size 95.4 Mb
> 
> My computer includes 32-bit Windows and  3,5 GB RAM. I am not sure if I install 64-bit Windows, then the problem is solved? Or maybe I should minimize the data. Do you have any idea about it?
> 
> Best wishes,
> Pinar
> 
> -----Original Message-----
> From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Edzer Pebesma
> Sent: Wednesday, September 21, 2011 3:46 PM
> To: r-sig-geo at r-project.org
> Subject: Re: [R-sig-Geo] about ST kriging
> 
> Hi Pinar,
> 
> it is not clear which variogram model you pass, or how your data are
> laid out in space and time.
> 
> Possible causes for a non-positive definite covariance matrix include:
> 
> - a variogram model with (nearly) perfect correlation
> - duplicate observations (observations having identical location AND time)
> - an invalid variogram model
> 
> A small, reproducible example (data + script) would help identify the
> problem.
> 
> Best regards,
> --
> Edzer
> 
> On 09/20/2011 11:15 AM, P?nar Aslantas Bostan wrote:
>> Dear all,
>>
>> I am working about space-time kriging. Before I asked again about ST kriging
>> but now the problem is 
>> different and I could not overcome it!
>>
>> During kriging operation I got this error:
>>
>>> pred = krigeST(prec~1, w, STS(grid,time,index), v)
>> Error in chol.default(A$Sm, LINPACK = TRUE) : 
>>   non-positive definite matrix in 'chol'
>>
>> I explained the data set below:
>>
>> # prec is annual precipitation measured from 257 meteorological stations
>>
>> # w is STSDF object
>>> summary(w)
>> Object of class STSDF
>> [[Spatial:]]
>> Object of class SpatialPoints
>> Coordinates:
>>          min     max
>> Xnew  140556 1730472
>> Ynew 4309064 4971309
>> Is projected: NA 
>> proj4string : [NA]
>> Number of points: 257
>> [[Temporal:]]
>>      Index                      object at time  
>>  Min.   :1970-01-01 12:00:00   Min.   : 1.0  
>>  1st Qu.:1979-07-03 00:00:00   1st Qu.:10.5  
>>  Median :1989-01-01 12:00:00   Median :20.0  
>>  Mean   :1989-01-01 02:46:09   Mean   :20.0  
>>  3rd Qu.:1998-07-03 00:00:00   3rd Qu.:29.5  
>>  Max.   :2008-01-01 12:00:00   Max.   :39.0  
>> [[Data attributes:]]
>>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
>>   114.5   413.7   533.6   633.0   735.6  3332.0 
>>
>> # I used grid to obtain predictions over it. It has 25 km spatial resolution
>>
>> # time is temporal entity of study. It contains 39 annual observation.
>>
>> # index is required for STSDF, and I used this code to create index.
>>> index <- cbind(as.integer(as.factor(data$Station)),
>> as.integer(as.factor(data$Year)))
>>
>> # v is space-time variogram
>>
>> How can I solve the problem?
>> Thank you in advance!
>>
>>
>> Pinar Aslantas Bostan
>> Research Assistant
>> Department of Geodetic and
>> Geographic Information Technologies (GGIT) Middle East Technical University
>> 06531 Ankara/TURKEY
>> aslantas at metu.edu.tr
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From piero.campa at gmail.com  Thu Sep 22 15:04:08 2011
From: piero.campa at gmail.com (piero campa)
Date: Thu, 22 Sep 2011 06:04:08 -0700 (PDT)
Subject: [R-sig-Geo] symbols in spplot
In-Reply-To: <498AB34D.4090408@buwa.nl>
References: <49896C30.1070903@buwa.nl>
	<alpine.LRH.2.00.0902041138140.1343@reclus.nhh.no>
	<498AB34D.4090408@buwa.nl>
Message-ID: <1316696648825-6820092.post@n2.nabble.com>

Dear all,
I would like to share a function that, as suggested by Roger, displays
arrows as SpatialLinesDataFrame objects that can be plotted with the spplot
command.

Little reproducible example:
> # Setup
> data(meuse)
> data(meuse.grid)
> attach(meuse)
> coordinates(meuse) <- ~x+y
> coordinates(meuse.grid) <- ~x+y
> proj4string(meuse) <- CRS("+init=epsg:28992")
> proj4string(meuse.grid) <- CRS("+init=epsg:28992")
> gridded(meuse.grid) <- TRUE
> # Create Arrows and plot
> myArrows <- spatial_arrows(zinc, copper, coordinates(meuse),
> proj4string(meuse), max.length=300, min.length=50, do.sqrt=FALSE)
> spplot(meuse.grid, zcol="dist", sp.layout=list("sp.lines", myArrows),
> main="Arrows Example with spplot", scales=list(draw=TRUE))

I upload the funcion and a the picture yielded by this example:
http://r-sig-geo.2731867.n2.nabble.com/file/n6820092/spatial_arrows.R
spatial_arrows.R 
http://r-sig-geo.2731867.n2.nabble.com/file/n6820092/meuse.arrows.png
meuse.arrows.png 

Hope this helps.
Cheers,
Piero


--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/symbols-in-spplot-tp2766289p6820092.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Greg.Snow at imail.org  Thu Sep 22 16:56:24 2011
From: Greg.Snow at imail.org (Greg Snow)
Date: Thu, 22 Sep 2011 08:56:24 -0600
Subject: [R-sig-Geo] small data set for an example
In-Reply-To: <586A4828D7AAA04CA9B258C50A28DA206DBC9B@BALI.uhd.campus>
References: <586A4828D7AAA04CA9B258C50A28DA206DBC9B@BALI.uhd.campus>
Message-ID: <B37C0A15B8FB3C468B5BC7EBC7DA14CC635391A78A@LP-EXMBVS10.CO.IHC.COM>

In the TeachingDemos package there are 3 datasets 'ccc', 'h2h', and 'towork' which are real, not overly large (but you can decide if they are small or not) which contain lat, long, and other variables.  

-- 
Gregory (Greg) L. Snow Ph.D.
Statistical Data Center
Intermountain Healthcare
greg.snow at imail.org
801.408.8111


> -----Original Message-----
> From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-
> project.org] On Behalf Of Hodgess, Erin
> Sent: Wednesday, September 21, 2011 6:14 PM
> To: r-sig-geo at r-project.org
> Subject: [R-sig-Geo] small data set for an example
> 
> Dear R Sig Geo People:
> 
> Does anyone have a small "real" data set with the longitude and
> latitude, along with a couple of data values per location that they
> would be willing to share, please?
> 
> 
> 
> I'm using simulated data but thought it would be nice to try with a
> regular set.
> 
> Thanks,
> Erin
> 
> Erin M. Hodgess, PhD
> Associate Professor
> Department of Computer and Mathematical Sciences
> University of Houston - Downtown
> mailto: hodgesse at uhd.edu
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From juantomas.sayago at gmail.com  Thu Sep 22 17:32:37 2011
From: juantomas.sayago at gmail.com (juantomas.sayago at gmail.com)
Date: Thu, 22 Sep 2011 15:32:37 +0000
Subject: [R-sig-Geo] small data set for an example
In-Reply-To: <B37C0A15B8FB3C468B5BC7EBC7DA14CC635391A78A@LP-EXMBVS10.CO.IHC.COM>
References: <586A4828D7AAA04CA9B258C50A28DA206DBC9B@BALI.uhd.campus><B37C0A15B8FB3C468B5BC7EBC7DA14CC635391A78A@LP-EXMBVS10.CO.IHC.COM>
Message-ID: <1304091493-1316705555-cardhu_decombobulator_blackberry.rim.net-1776108493-@b28.c26.bise6.blackberry>

Sorry for cross posting 
You can check also the asdarbook website or the cran of different packages they have really nice data. Juan
Sent on the Sprint? Now Network from my BlackBerry?

-----Original Message-----
From: Greg Snow <Greg.Snow at imail.org>
Sender: r-sig-geo-bounces at r-project.orgDate: Thu, 22 Sep 2011 08:56:24 
To: Hodgess, Erin<HodgessE at uhd.edu>; r-sig-geo at r-project.org<r-sig-geo at r-project.org>
Subject: Re: [R-sig-Geo] small data set for an example

In the TeachingDemos package there are 3 datasets 'ccc', 'h2h', and 'towork' which are real, not overly large (but you can decide if they are small or not) which contain lat, long, and other variables.  

-- 
Gregory (Greg) L. Snow Ph.D.
Statistical Data Center
Intermountain Healthcare
greg.snow at imail.org
801.408.8111


> -----Original Message-----
> From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-
> project.org] On Behalf Of Hodgess, Erin
> Sent: Wednesday, September 21, 2011 6:14 PM
> To: r-sig-geo at r-project.org
> Subject: [R-sig-Geo] small data set for an example
> 
> Dear R Sig Geo People:
> 
> Does anyone have a small "real" data set with the longitude and
> latitude, along with a couple of data values per location that they
> would be willing to share, please?
> 
> 
> 
> I'm using simulated data but thought it would be nice to try with a
> regular set.
> 
> Thanks,
> Erin
> 
> Erin M. Hodgess, PhD
> Associate Professor
> Department of Computer and Mathematical Sciences
> University of Houston - Downtown
> mailto: hodgesse at uhd.edu
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

From rflterra at yahoo.com.br  Thu Sep 22 19:17:31 2011
From: rflterra at yahoo.com.br (Rafael Terra)
Date: Thu, 22 Sep 2011 10:17:31 -0700 (PDT)
Subject: [R-sig-Geo] Spatial Error Model for panel data- large spatial
	weight matrix problem
Message-ID: <1316711851.29848.YahooMailNeo@web161907.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110922/fba33feb/attachment.pl>

From hi_ono2001 at ybb.ne.jp  Fri Sep 23 03:16:19 2011
From: hi_ono2001 at ybb.ne.jp (hi_ono2001 at ybb.ne.jp)
Date: Fri, 23 Sep 2011 10:16:19 +0900 (JST)
Subject: [R-sig-Geo] Availability of MacOS X binary for rgeos
Message-ID: <879611.9512.qm@web200018.mail.kks.yahoo.co.jp>

Hello.

  Does anyone know this?

  Thanks in advance.



From sandeep.coepcivil at gmail.com  Fri Sep 23 05:11:20 2011
From: sandeep.coepcivil at gmail.com (Sandeep Patil)
Date: Thu, 22 Sep 2011 22:11:20 -0500
Subject: [R-sig-Geo] Distance from coast
Message-ID: <CAHnA5RWLPX5+b4HgHPX7nduKJwtiP=HMegipzSCuNsj-XLrGTQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110922/5708637a/attachment.pl>

From mdsumner at gmail.com  Fri Sep 23 06:29:07 2011
From: mdsumner at gmail.com (Michael Sumner)
Date: Fri, 23 Sep 2011 14:29:07 +1000
Subject: [R-sig-Geo] Distance from coast
In-Reply-To: <CAHnA5RWLPX5+b4HgHPX7nduKJwtiP=HMegipzSCuNsj-XLrGTQ@mail.gmail.com>
References: <CAHnA5RWLPX5+b4HgHPX7nduKJwtiP=HMegipzSCuNsj-XLrGTQ@mail.gmail.com>
Message-ID: <CAAcGz9-HYR4ESeqqU-obifjRkF6kYm2Rk_-XAJ62=ZjbcouGiQ@mail.gmail.com>

Here's a really simple example using the default low res longlat
coastline in the maps package. It should work for any coastal dataset
that can extract the raw coordinates from, though there's no attempts
at efficiency. spDistsN1 is really fast and works well for this
though, be careful to use longlat argument correctly.

library(sp)

library(maps)

## single point for a simple test
pts <- matrix(c(-88, 36), ncol = 2)

## simple map data
mp <- map("usa", plot = FALSE)

## convert coords to matrix and dump NA
xy.coast <- cbind(mp$x, mp$y)[!is.na(mp$x), ]


## container for all the nearest points matching the input
closest.points <- matrix(0, ncol = 2, nrow = nrow(pts))

for (i in 1:nrow(pts)) {
   closest.points[i, 1:2] <- xy.coast[which.min(spDistsN1(xy.coast,
pts, longlat = TRUE)), ]
}

map(mp)
points(pts)
points(closest.points)

Cheers, Mike.
On Fri, Sep 23, 2011 at 1:11 PM, Sandeep Patil
<sandeep.coepcivil at gmail.com> wrote:
> Hello does anyone know of any R -script or function which will give the
> value of nearest distance from coast of a point
> in USA.
>
> I have a number of latitude and longitude values spread evenly across USA
> and i want to find the nearest distance from coast for
>
> each of these points. If not a function can anyone suggest me a strong
> library for geographical data manipulation.
>
> Thanks a lot
>
> Sandeep
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Michael Sumner
Institute for Marine and Antarctic Studies, University of Tasmania
Hobart, Australia
e-mail: mdsumner at gmail.com


From lists at remoteinformation.com.au  Fri Sep 23 07:16:09 2011
From: lists at remoteinformation.com.au (Ben Madin)
Date: Fri, 23 Sep 2011 13:16:09 +0800
Subject: [R-sig-Geo] Availability of MacOS X binary for rgeos
In-Reply-To: <879611.9512.qm@web200018.mail.kks.yahoo.co.jp>
References: <879611.9512.qm@web200018.mail.kks.yahoo.co.jp>
Message-ID: <87E29284-2788-4A99-9514-E4C03A29A43A@remoteinformation.com.au>

If you install the geos available from 

http://www.kyngchaos.com/software/frameworks

the rgeos from source code works OK as long as you direct the lib and include to the right places. You may want proj4 as well. Check the dependencies, I think you will need the UNIX Image IO frameworks as well

cheers

Ben


On 23/09/2011, at 9:16 AM, hi_ono2001 at ybb.ne.jp wrote:

> Hello.
> 
>  Does anyone know this?
> 
>  Thanks in advance.
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Roger.Bivand at nhh.no  Fri Sep 23 08:09:45 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 23 Sep 2011 08:09:45 +0200 (CEST)
Subject: [R-sig-Geo] Availability of MacOS X binary for rgeos
In-Reply-To: <879611.9512.qm@web200018.mail.kks.yahoo.co.jp>
References: <879611.9512.qm@web200018.mail.kks.yahoo.co.jp>
Message-ID: <alpine.LRH.2.00.1109230708410.29200@reclus.nhh.no>

On Fri, 23 Sep 2011, hi_ono2001 at ybb.ne.jp wrote:

> Hello.
>
>  Does anyone know this?

As the package page on CRAN

http://cran.r-project.org/web/packages/rgdal/index.html

says:

rgdal binaries for OSX are available from the CRAN (extras) repository

which you access by setting:

setRepositories(ind=1:2)
install.packages("rgdal")

These are built with the same basic set of drivers as the CRAN Windows 
binaries, and only support Intel architectures.

There is advice on installing rgdal on OSX using Kyngchaos frameworks on:

http://www.r-bloggers.com/installing-rgdal-on-mac-os-x-2/

and on the rgdal CRAN page under system requirements; Kyngchaos also has 
binary package builds using the frameworks; this has some experience too:

http://stackoverflow.com/questions/7168345/problems-installing-rgeos-and-rgdal-on-mac-os-x-lion

See also:

https://stat.ethz.ch/pipermail/r-sig-geo/2011-May/011629.html

for answers to a similar question on this list.

Hope this helps,

Roger


>
>  Thanks in advance.
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From M.U.Kemp at uva.nl  Fri Sep 23 09:54:14 2011
From: M.U.Kemp at uva.nl (Kemp, Michael)
Date: Fri, 23 Sep 2011 07:54:14 +0000
Subject: [R-sig-Geo] Distance from coast
In-Reply-To: <CAHnA5RWLPX5+b4HgHPX7nduKJwtiP=HMegipzSCuNsj-XLrGTQ@mail.gmail.com>
References: <CAHnA5RWLPX5+b4HgHPX7nduKJwtiP=HMegipzSCuNsj-XLrGTQ@mail.gmail.com>
Message-ID: <41DD650D5B3A4247AD9F423FDE9378FAA46A@snelders.uva.nl>

Hello Sandeep,

Tom Hengl has some world maps on his spatial-analyst website, one of which is a 'distance-to-the-coast' map.  He also has some example script for how to handle these maps.

See...
http://spatial-analyst.net/wiki/index.php?title=Global_datasets

Regards,
Michael


-----Original Message-----
From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Sandeep Patil
Sent: Friday, September 23, 2011 5:11 AM
To: r-sig-geo at r-project.org
Subject: [R-sig-Geo] Distance from coast

Hello does anyone know of any R -script or function which will give the
value of nearest distance from coast of a point
in USA.

I have a number of latitude and longitude values spread evenly across USA
and i want to find the nearest distance from coast for

each of these points. If not a function can anyone suggest me a strong
library for geographical data manipulation.

Thanks a lot

Sandeep

	[[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From frippe12573 at hotmail.com  Fri Sep 23 10:01:04 2011
From: frippe12573 at hotmail.com (Eugenio Trumpy)
Date: Fri, 23 Sep 2011 08:01:04 +0000
Subject: [R-sig-Geo] SpatialGridDataFrame
Message-ID: <DUB108-W63E31ABF5A3FA78AEA5201E50F0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110923/b0408f85/attachment.pl>

From hengl at spatial-analyst.net  Fri Sep 23 10:21:18 2011
From: hengl at spatial-analyst.net (Tomislav Hengl)
Date: Fri, 23 Sep 2011 10:21:18 +0200
Subject: [R-sig-Geo] Distance from coast
In-Reply-To: <41DD650D5B3A4247AD9F423FDE9378FAA46A@snelders.uva.nl>
References: <CAHnA5RWLPX5+b4HgHPX7nduKJwtiP=HMegipzSCuNsj-XLrGTQ@mail.gmail.com>
	<41DD650D5B3A4247AD9F423FDE9378FAA46A@snelders.uva.nl>
Message-ID: <b8d63bdc052c207ec6e5df113d724527.squirrel@spatial-analyst.net>


Sandeep,

You probably want to use:

http://commons.wikimedia.org/wiki/File:Dist2con.png

*I had some problems automatic the processing with R+SAGA (will try to
update the maps/scripts soon), but this is probably what you are looking
for.

The geotifs are at:

http://spatial-analyst.net/worldmaps/

*we are in process of migrating to www.worldgrids.org which will include
both data and the geo-services.

cheers,

T. Hengl
http://www.wewur.wur.nl/popups/vcard.aspx?id=HENGL001

> Hello Sandeep,
>
> Tom Hengl has some world maps on his spatial-analyst website, one of which
> is a 'distance-to-the-coast' map.  He also has some example script for how
> to handle these maps.
>
> See...
> http://spatial-analyst.net/wiki/index.php?title=Global_datasets
>
> Regards,
> Michael
>
>
> -----Original Message-----
> From: r-sig-geo-bounces at r-project.org
> [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Sandeep Patil
> Sent: Friday, September 23, 2011 5:11 AM
> To: r-sig-geo at r-project.org
> Subject: [R-sig-Geo] Distance from coast
>
> Hello does anyone know of any R -script or function which will give the
> value of nearest distance from coast of a point
> in USA.
>
> I have a number of latitude and longitude values spread evenly across USA
> and i want to find the nearest distance from coast for
>
> each of these points. If not a function can anyone suggest me a strong
> library for geographical data manipulation.
>
> Thanks a lot
>
> Sandeep
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From luca.candeloro at gmail.com  Fri Sep 23 10:38:23 2011
From: luca.candeloro at gmail.com (luca candeloro)
Date: Fri, 23 Sep 2011 10:38:23 +0200
Subject: [R-sig-Geo] Distance from coast
In-Reply-To: <CAHnA5RWLPX5+b4HgHPX7nduKJwtiP=HMegipzSCuNsj-XLrGTQ@mail.gmail.com>
References: <CAHnA5RWLPX5+b4HgHPX7nduKJwtiP=HMegipzSCuNsj-XLrGTQ@mail.gmail.com>
Message-ID: <CAHF6Ynm9WDCviCzhKADz2g+KRaVs31Vs9W+M1eK-2OTaNUO=zw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110923/a40ade2f/attachment.pl>

From mathieu.rajerison at gmail.com  Fri Sep 23 17:08:27 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Fri, 23 Sep 2011 17:08:27 +0200
Subject: [R-sig-Geo] Lacunarity and urban image classification
Message-ID: <CAGfc75=Y59mdAKjB73Q4j7Hj48L=RSEeOejEr-tmL2367ARfyw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110923/9b25aeea/attachment.pl>

From Adrian.Baddeley at csiro.au  Sat Sep 24 04:09:19 2011
From: Adrian.Baddeley at csiro.au (Adrian.Baddeley at csiro.au)
Date: Sat, 24 Sep 2011 10:09:19 +0800
Subject: [R-sig-Geo] [R-sig-geo] bugs in plotting line segments
Message-ID: <57DC18C299094D4299F837570C5DF1C54E967EFCB5@EXWA-MBX01.nexus.csiro.au>

Mathieu Rajerison and Michael Sumner reported two bugs arising when a pattern of line segments is plotted.
Mike traced the bugs to spatstat:::plot.psp and spatstat:::pointsOnLines. Errors occurred if a mark value was NA or if a segment had zero length. 

These bugs have been fixed in the latest release of spatstat, 1.23-5, released yesterday. 

Special thanks to Mike for troubleshooting.

Adrian Baddeley

From Roger.Bivand at nhh.no  Sat Sep 24 09:27:27 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 24 Sep 2011 09:27:27 +0200 (CEST)
Subject: [R-sig-Geo] FW: GWAR - R
In-Reply-To: <9538CBE90C88F94B82B565BA67BA6E8F2493F49449@EXMBX06.ad.oak.ox.ac.uk>
References: <9538CBE90C88F94B82B565BA67BA6E8F2493F49432@EXMBX06.ad.oak.ox.ac.uk>,
	<alpine.LRH.2.00.1109220049160.22767@reclus.nhh.no>
	<9538CBE90C88F94B82B565BA67BA6E8F2493F49449@EXMBX06.ad.oak.ox.ac.uk>
Message-ID: <alpine.LRH.2.00.1109240926190.813@reclus.nhh.no>

On Thu, 22 Sep 2011, Inaki Sagarzazu wrote:

>
> Hi,
>
> I am trying to use gwr in R but I'm having problems because some of my 
> polygons have missing values (NA) for the variables of interest. Do you 
> have any suggestions on how to solve this?

If data is missing in the response or covariates, all bets are off. You
could drop those observations, or incomplete variables. You could try to 
impute the values, but then standard results would not hold downstream.

Roger

>
> thanks
>
> ---------------------------------------------------------------------------------------------------------------
> I?aki Sagarzazu, PhD
> Research Officer
> Nuffield College
> University of Oxford
> OX1 1NF Oxford
> United Kingdom
>
> Office: 44 (0) 1 865 614990
> Inaki.Sagarzazu at nuffield.ox.ac.uk
> http://www.inaki-sagarzazu.com
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From alobolistas at gmail.com  Sat Sep 24 11:48:58 2011
From: alobolistas at gmail.com (Agustin Lobo)
Date: Sat, 24 Sep 2011 11:48:58 +0200
Subject: [R-sig-Geo] raster::predict: more than one single output
Message-ID: <CAG4NReL0mYD2nJX6JQV=TF0n1vK5s3MjU2M1hLKHXYvwRZ2QWw@mail.gmail.com>

I'm using raster::predict using predict.lda():

> srndpc20000lda <- lda(srndpcclasses[,1:5],srndpcclasses[,37])
> PCAtoMedian_6yrsclass20000 <- predict(object=PCAtoMedian_6yrs,model=srndpc20000lda)
> PCAtoMedian_6yrsclass20000
class       : RasterLayer
dimensions  : 1289, 1289, 1661521  (nrow, ncol, ncell)
resolution  : 0.008928571, 0.008928571  (x, y)
extent      : 30.99554, 42.50446, 1.495536, 13.00446  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0
values      : in memory
min value   : 1
max value   : 4

But I would also need the rest of the output provided by
predict.lda(), in particular a layer with the posterior
probabilities to mask out those pixels which do not have a high
probability for any of the classes.
>From the help page of MASS::predict.lda():

Value
 a list with components

class   The MAP classification (a factor)
posterior   posterior probabilities for the classes
x   the scores of test cases on up to dimen discriminant variables

As far as I  understand, only "class" is returned by raster::predict.
Am I wrong and there is actually a way to get the posteriors?
Otherwise, could that be added in the future?

Thanks

Agus


From r.hijmans at gmail.com  Sat Sep 24 17:23:33 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sat, 24 Sep 2011 08:23:33 -0700
Subject: [R-sig-Geo] raster::predict: more than one single output
In-Reply-To: <CAG4NReL0mYD2nJX6JQV=TF0n1vK5s3MjU2M1hLKHXYvwRZ2QWw@mail.gmail.com>
References: <CAG4NReL0mYD2nJX6JQV=TF0n1vK5s3MjU2M1hLKHXYvwRZ2QWw@mail.gmail.com>
Message-ID: <CANtt_hywYVDhBAnMjVJweO-qn=fiatRHN6XtkFvuwKCuL-Kw=A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110924/98b8e472/attachment.pl>

From inaki.sagarzazu at nuffield.ox.ac.uk  Sun Sep 25 12:10:25 2011
From: inaki.sagarzazu at nuffield.ox.ac.uk (Inaki Sagarzazu)
Date: Sun, 25 Sep 2011 11:10:25 +0100
Subject: [R-sig-Geo] FW: GWAR - R
In-Reply-To: <alpine.LRH.2.00.1109240926190.813@reclus.nhh.no>
References: <9538CBE90C88F94B82B565BA67BA6E8F2493F49432@EXMBX06.ad.oak.ox.ac.uk>
	<alpine.LRH.2.00.1109220049160.22767@reclus.nhh.no>
	<9538CBE90C88F94B82B565BA67BA6E8F2493F49449@EXMBX06.ad.oak.ox.ac.uk>
	<alpine.LRH.2.00.1109240926190.813@reclus.nhh.no>
Message-ID: <C3878620-A3D9-4703-B474-627657EDEA4B@nuffield.ox.ac.uk>

Hi Roger

Thanks for your response. I am not sure why there can't be polygons with missing info. Is it something with the model or the estimation? 

Also, How can I drop the NA's from a shape file in R? I've tried but can't seem to be able to do it.

Thanks

Inaki

On 24 Sep 2011, at 08:27, "Roger Bivand" <Roger.Bivand at nhh.no> wrote:

> On Thu, 22 Sep 2011, Inaki Sagarzazu wrote:
> 
>> 
>> Hi,
>> 
>> I am trying to use gwr in R but I'm having problems because some of my 
>> polygons have missing values (NA) for the variables of interest. Do you 
>> have any suggestions on how to solve this?
> 
> If data is missing in the response or covariates, all bets are off. You
> could drop those observations, or incomplete variables. You could try to 
> impute the values, but then standard results would not hold downstream.
> 
> Roger
> 
>> 
>> thanks
>> 
>> ---------------------------------------------------------------------------------------------------------------
>> I?aki Sagarzazu, PhD
>> Research Officer
>> Nuffield College
>> University of Oxford
>> OX1 1NF Oxford
>> United Kingdom
>> 
>> Office: 44 (0) 1 865 614990
>> Inaki.Sagarzazu at nuffield.ox.ac.uk
>> http://www.inaki-sagarzazu.com
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
> 
> -- 
> Roger Bivand
> Department of Economics, NHH Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no

From Roger.Bivand at nhh.no  Sun Sep 25 12:37:46 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sun, 25 Sep 2011 12:37:46 +0200 (CEST)
Subject: [R-sig-Geo] FW: GWAR - R
In-Reply-To: <C3878620-A3D9-4703-B474-627657EDEA4B@nuffield.ox.ac.uk>
References: <9538CBE90C88F94B82B565BA67BA6E8F2493F49432@EXMBX06.ad.oak.ox.ac.uk>
	<alpine.LRH.2.00.1109220049160.22767@reclus.nhh.no>
	<9538CBE90C88F94B82B565BA67BA6E8F2493F49449@EXMBX06.ad.oak.ox.ac.uk>
	<alpine.LRH.2.00.1109240926190.813@reclus.nhh.no>
	<C3878620-A3D9-4703-B474-627657EDEA4B@nuffield.ox.ac.uk>
Message-ID: <alpine.LRH.2.00.1109251231300.4587@reclus.nhh.no>

On Sun, 25 Sep 2011, Inaki Sagarzazu wrote:

> Hi Roger
>
> Thanks for your response. I am not sure why there can't be polygons with 
> missing info. Is it something with the model or the estimation?

You cannot fit a linear model with missing info either, those cases get 
dropped.

>
> Also, How can I drop the NA's from a shape file in R? I've tried but 
> can't seem to be able to do it.
>

Assuming that the data only contain variables that are relevant for the 
model, create a logical vector and subset in the usual way:

cc <- complete.cases(as(myshp, "data.frame"))
myshp_cc <- myshp[cc,]

If there are other unused variables with NAs that may lead you to drop 
more observations than necessary, create a new object with only the 
relevant columns first:

names(myshp0)
myshp <- myshp0[, c(1,3,5,7)]

if c(1,3,5,7) are the variables you want - you can use names in a vector 
too.

Hope this helps,

Roger

> Thanks
>
> Inaki
>
> On 24 Sep 2011, at 08:27, "Roger Bivand" <Roger.Bivand at nhh.no> wrote:
>
>> On Thu, 22 Sep 2011, Inaki Sagarzazu wrote:
>>
>>>
>>> Hi,
>>>
>>> I am trying to use gwr in R but I'm having problems because some of my
>>> polygons have missing values (NA) for the variables of interest. Do you
>>> have any suggestions on how to solve this?
>>
>> If data is missing in the response or covariates, all bets are off. You
>> could drop those observations, or incomplete variables. You could try to
>> impute the values, but then standard results would not hold downstream.
>>
>> Roger
>>
>>>
>>> thanks
>>>
>>> ---------------------------------------------------------------------------------------------------------------
>>> I?aki Sagarzazu, PhD
>>> Research Officer
>>> Nuffield College
>>> University of Oxford
>>> OX1 1NF Oxford
>>> United Kingdom
>>>
>>> Office: 44 (0) 1 865 614990
>>> Inaki.Sagarzazu at nuffield.ox.ac.uk
>>> http://www.inaki-sagarzazu.com
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>> --
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From inaki.sagarzazu at nuffield.ox.ac.uk  Sun Sep 25 12:40:31 2011
From: inaki.sagarzazu at nuffield.ox.ac.uk (Inaki Sagarzazu)
Date: Sun, 25 Sep 2011 11:40:31 +0100
Subject: [R-sig-Geo] FW: GWAR - R
In-Reply-To: <alpine.LRH.2.00.1109251231300.4587@reclus.nhh.no>
References: <9538CBE90C88F94B82B565BA67BA6E8F2493F49432@EXMBX06.ad.oak.ox.ac.uk>
	<alpine.LRH.2.00.1109220049160.22767@reclus.nhh.no>
	<9538CBE90C88F94B82B565BA67BA6E8F2493F49449@EXMBX06.ad.oak.ox.ac.uk>
	<alpine.LRH.2.00.1109240926190.813@reclus.nhh.no>
	<C3878620-A3D9-4703-B474-627657EDEA4B@nuffield.ox.ac.uk>
	<alpine.LRH.2.00.1109251231300.4587@reclus.nhh.no>
Message-ID: <EF77F167-FA61-42F6-BFAA-AE81691EBBA4@nuffield.ox.ac.uk>

Great thanks.

I understand you can't it a linear model with missing info, but you can stillmake valid predictions. I thought from your previous email that this wasn't the case with gwr, thus my question.

Thanks

Inaki

On 25 Sep 2011, at 11:37, "Roger Bivand" <Roger.Bivand at nhh.no> wrote:

> On Sun, 25 Sep 2011, Inaki Sagarzazu wrote:
> 
>> Hi Roger
>> 
>> Thanks for your response. I am not sure why there can't be polygons with 
>> missing info. Is it something with the model or the estimation?
> 
> You cannot fit a linear model with missing info either, those cases get 
> dropped.
> 
>> 
>> Also, How can I drop the NA's from a shape file in R? I've tried but 
>> can't seem to be able to do it.
>> 
> 
> Assuming that the data only contain variables that are relevant for the 
> model, create a logical vector and subset in the usual way:
> 
> cc <- complete.cases(as(myshp, "data.frame"))
> myshp_cc <- myshp[cc,]
> 
> If there are other unused variables with NAs that may lead you to drop 
> more observations than necessary, create a new object with only the 
> relevant columns first:
> 
> names(myshp0)
> myshp <- myshp0[, c(1,3,5,7)]
> 
> if c(1,3,5,7) are the variables you want - you can use names in a vector 
> too.
> 
> Hope this helps,
> 
> Roger
> 
>> Thanks
>> 
>> Inaki
>> 
>> On 24 Sep 2011, at 08:27, "Roger Bivand" <Roger.Bivand at nhh.no> wrote:
>> 
>>> On Thu, 22 Sep 2011, Inaki Sagarzazu wrote:
>>> 
>>>> 
>>>> Hi,
>>>> 
>>>> I am trying to use gwr in R but I'm having problems because some of my
>>>> polygons have missing values (NA) for the variables of interest. Do you
>>>> have any suggestions on how to solve this?
>>> 
>>> If data is missing in the response or covariates, all bets are off. You
>>> could drop those observations, or incomplete variables. You could try to
>>> impute the values, but then standard results would not hold downstream.
>>> 
>>> Roger
>>> 
>>>> 
>>>> thanks
>>>> 
>>>> ---------------------------------------------------------------------------------------------------------------
>>>> I?aki Sagarzazu, PhD
>>>> Research Officer
>>>> Nuffield College
>>>> University of Oxford
>>>> OX1 1NF Oxford
>>>> United Kingdom
>>>> 
>>>> Office: 44 (0) 1 865 614990
>>>> Inaki.Sagarzazu at nuffield.ox.ac.uk
>>>> http://www.inaki-sagarzazu.com
>>>> 
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>> 
>>> 
>>> --
>>> Roger Bivand
>>> Department of Economics, NHH Norwegian School of Economics,
>>> Helleveien 30, N-5045 Bergen, Norway.
>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>> e-mail: Roger.Bivand at nhh.no
>> 
> 
> -- 
> Roger Bivand
> Department of Economics, NHH Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no

From leslaura at gmail.com  Mon Sep 26 06:11:28 2011
From: leslaura at gmail.com (Laura S)
Date: Sun, 25 Sep 2011 21:11:28 -0700
Subject: [R-sig-Geo] Memory size issue and setting bounding box when
 conducting Kest on multiple tree species
Message-ID: <CAHLsRKkYVL_L=LL1VVRj==HUbUSxXkay_sCtc-wdFxE+nJ3XyQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110925/c74834c4/attachment.pl>

From leslaura at gmail.com  Mon Sep 26 06:57:00 2011
From: leslaura at gmail.com (Laura S)
Date: Sun, 25 Sep 2011 21:57:00 -0700
Subject: [R-sig-Geo] Calculating spatial autocorrelation (Moran's I) when
 have zero-inflated data?
Message-ID: <CAHLsRKmAtAgBGrO=9o-+3gd_BCDMPGvTGfhPmJDgE_xK1wH1jQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110925/a66d3552/attachment.pl>

From mathieu.rajerison at gmail.com  Mon Sep 26 09:35:22 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Mon, 26 Sep 2011 09:35:22 +0200
Subject: [R-sig-Geo] [R-sig-geo] bugs in plotting line segments
In-Reply-To: <57DC18C299094D4299F837570C5DF1C54E967EFCB5@EXWA-MBX01.nexus.csiro.au>
References: <57DC18C299094D4299F837570C5DF1C54E967EFCB5@EXWA-MBX01.nexus.csiro.au>
Message-ID: <CAGfc75=qqRK9cN6prNKV69MkrG6Z=PLe+iY387P+GpyDJnrzcA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110926/9d735117/attachment.pl>

From christian.levers at geo.hu-berlin.de  Mon Sep 26 09:41:08 2011
From: christian.levers at geo.hu-berlin.de (Christian Levers)
Date: Mon, 26 Sep 2011 09:41:08 +0200
Subject: [R-sig-Geo] Calculating spatial autocorrelation (Moran's I)
 when have zero-inflated data?
In-Reply-To: <CAHLsRKmAtAgBGrO=9o-+3gd_BCDMPGvTGfhPmJDgE_xK1wH1jQ@mail.gmail.com>
References: <CAHLsRKmAtAgBGrO=9o-+3gd_BCDMPGvTGfhPmJDgE_xK1wH1jQ@mail.gmail.com>
Message-ID: <4E802C94.7010402@geo.hu-berlin.de>

As far as I know that would be the Join Counts statistics.

--> 
http://www.spatialanalysisonline.com/output/html/SpatialAutocorrelation.html

Cheers, Christian

Am 26.09.2011 06:57, schrieb Laura S:
> Dear all:
>
> I was wondering if you have suggestions on how to analyze the spatial
> autocorrelation of tree abundance in a grid of contiguous quadrats given
> that the data set follows a zero inflated distribution, i.e., in many
> quadrats the abundance of a species is zero.
>
> Thank you for your time and consideration,
> Laura
>
> ***<http://www.sciencedirect.com/science/article/pii/S0304380009000271#aff2>
> *


-- 
MSc Geogr. Christian Levers
Research Assistant | PhD Student

Geomatics Lab | Geography Department | Humboldt-Universitaet zu Berlin

eMail:  christian.levers at geo.hu-berlin.de
phone:  +49 (0) 30 2093 9341
fax:    +49 (0) 30 2093 6848
mail:   Unter den Linden 6 | 10099 Berlin | Germany
web:    www.hu-geomatics.de


From raffaele.morelli at gmail.com  Mon Sep 26 11:16:51 2011
From: raffaele.morelli at gmail.com (Raffaele Morelli)
Date: Mon, 26 Sep 2011 11:16:51 +0200
Subject: [R-sig-Geo] readShapePoints issue
Message-ID: <CAD4guxO846vvhQQ+PvkLNudMD+265NT6eUwDX8dG6H1Bjw0Gbg@mail.gmail.com>

Hi,

I am working with R and using pgsql2shp to export shape files from pg. The
shapes are created by pgsql2shp but when I try to import them in a R
enviromnent I get this error

Error in res[i, ] <- Map$Shapes[[i]]$verts : replacement has length zero

So, I can load the shape files in Qgis but not in R. Moreover, if I load one of
those files in Qgis and then export it again... this file is correctly
loaded by R.

I really can't guess what's wrong. Any idea?

Regards
Raffaele

--
L'unica speranza di catarsi, ammesso che ne esista una, resta affidata
all'istinto di ribellione, alla rivolta non isterilita in progetti,
alla protesta violenta e viscerale.


From Roger.Bivand at nhh.no  Mon Sep 26 11:22:10 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 26 Sep 2011 11:22:10 +0200 (CEST)
Subject: [R-sig-Geo] readShapePoints issue
In-Reply-To: <CAD4guxO846vvhQQ+PvkLNudMD+265NT6eUwDX8dG6H1Bjw0Gbg@mail.gmail.com>
References: <CAD4guxO846vvhQQ+PvkLNudMD+265NT6eUwDX8dG6H1Bjw0Gbg@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1109261119010.8513@reclus.nhh.no>

On Mon, 26 Sep 2011, Raffaele Morelli wrote:

> Hi,
>
> I am working with R and using pgsql2shp to export shape files from pg. The
> shapes are created by pgsql2shp but when I try to import them in a R
> enviromnent I get this error
>
> Error in res[i, ] <- Map$Shapes[[i]]$verts : replacement has length zero
>
> So, I can load the shape files in Qgis but not in R. Moreover, if I load one of
> those files in Qgis and then export it again... this file is correctly
> loaded by R.
>
> I really can't guess what's wrong. Any idea?

Use readOGR() in rgdal, not readShapeSpatial() in maptools. You are also 
generating objects with no coordinates, so the real issue is upstream, in 
PostGIS or the intermediate utility. Why not build your own PostGIS driver 
for OGR, and read directly with readOGR():

http://wiki.intamap.org/index.php/PostGIS

Hope this clarifies,

Roger

>
> Regards
> Raffaele
>
> --
> L'unica speranza di catarsi, ammesso che ne esista una, resta affidata
> all'istinto di ribellione, alla rivolta non isterilita in progetti,
> alla protesta violenta e viscerale.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From alobolistas at gmail.com  Mon Sep 26 12:04:26 2011
From: alobolistas at gmail.com (Agustin Lobo)
Date: Mon, 26 Sep 2011 12:04:26 +0200
Subject: [R-sig-Geo] raster::predict: more than one single output
In-Reply-To: <CANtt_hywYVDhBAnMjVJweO-qn=fiatRHN6XtkFvuwKCuL-Kw=A@mail.gmail.com>
References: <CAG4NReL0mYD2nJX6JQV=TF0n1vK5s3MjU2M1hLKHXYvwRZ2QWw@mail.gmail.com>
	<CANtt_hywYVDhBAnMjVJweO-qn=fiatRHN6XtkFvuwKCuL-Kw=A@mail.gmail.com>
Message-ID: <CAG4NRe+TZtSq89h=an=TXswWRjxER4AkeqkgRQyAeGBSD17YGw@mail.gmail.com>

Thanks. The help page is a bit confusing on this:
"index    Integer. To select the column if predict.'model' returns a
matrix with multiple columns"

in this case, predict.lm() does not return a matrix but a list, which
2nd and 3rd components are
matrix objects. Hence the confusion: I assumed only the first
component was returned.

Agus

2011/9/24 Robert J. Hijmans <r.hijmans at gmail.com>:
> Hi Agus,
>
> You can use the index argument for that (but I admit that the function
> should detect this automatically). If you expect two numbers for each cell,
> you can do
>
> predict(object=PCAtoMedian_6yrs,model=srndpc20000lda, index=1:2)
>
> Robert
>
> On Sat, Sep 24, 2011 at 2:48 AM, Agustin Lobo <alobolistas at gmail.com> wrote:
>
>> I'm using raster::predict using predict.lda():
>>
>> > srndpc20000lda <- lda(srndpcclasses[,1:5],srndpcclasses[,37])
>> > PCAtoMedian_6yrsclass20000 <-
>> predict(object=PCAtoMedian_6yrs,model=srndpc20000lda)
>> > PCAtoMedian_6yrsclass20000
>> class ? ? ? : RasterLayer
>> dimensions ?: 1289, 1289, 1661521 ?(nrow, ncol, ncell)
>> resolution ?: 0.008928571, 0.008928571 ?(x, y)
>> extent ? ? ?: 30.99554, 42.50446, 1.495536, 13.00446 ?(xmin, xmax, ymin,
>> ymax)
>> coord. ref. : +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs
>> +towgs84=0,0,0
>> values ? ? ?: in memory
>> min value ? : 1
>> max value ? : 4
>>
>> But I would also need the rest of the output provided by
>> predict.lda(), in particular a layer with the posterior
>> probabilities to mask out those pixels which do not have a high
>> probability for any of the classes.
>> From the help page of MASS::predict.lda():
>>
>> Value
>> ?a list with components
>>
>> class ? The MAP classification (a factor)
>> posterior ? posterior probabilities for the classes
>> x ? the scores of test cases on up to dimen discriminant variables
>>
>> As far as I ?understand, only "class" is returned by raster::predict.
>> Am I wrong and there is actually a way to get the posteriors?
>> Otherwise, could that be added in the future?
>>
>> Thanks
>>
>> Agus
>>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From s.meyer at lmu.de  Mon Sep 26 12:38:51 2011
From: s.meyer at lmu.de (Swen Meyer)
Date: Mon, 26 Sep 2011 12:38:51 +0200
Subject: [R-sig-Geo] Leave one out cross validation in a Generalized linear
	Model?
Message-ID: <4E80563B.8050705@lmu.de>


Dear All,
I got the following problem. I use the GLM below to do Regression Kriging:

#MLR backward Co-Variables(P1 -P10)
fit1 <- lm((CLAY)~  PC1 + PC2 +PC3 +PC4 +PC5 +PC6 +PC7 +PC8+PC9 +PC10   
, boden.ov[sel,] )
#GLM
m.glm <- glm(formula(step), boden.ov[sel,], family=gaussian)
summary(m.glm)
p.glm <- predict(m.glm, newdata=boden.grid, type="link", se.fit=TRUE)
om.glm <- as(boden.grid["band1"], "SpatialPointsDataFrame")
om.glm$var1.pred <- p.glm$fit
om.glm$var1.var <- p.glm$se.fit
om.glm$svar <- p.glm$se.fit^2/(m.glm$null.deviance/m.glm$df.null)
gridded(om.glm) <- TRUE
fullgrid(om.glm) <- TRUE

##Regression Kriging with GLM
vario.res <- autofitVariogram((CLAY)~om.glm, boden.ov[sel,], model = 
c("Sph"))
plot(variogram((CLAY)~om.glm, boden.ov[sel,]), vario.res$var_model)
om.rk <- krige((CLAY)~om.glm,boden.ov, boden.grid,    vario.res$var_model)
om.rk$om.pred <- (om.rk$var1.pred)

#Leave one out Cross Validation Regression Kriging
rk.cv <- krige.cv((CLAY)~om.glm,boden.ov,   vario.res$var_model, 
verbose=TRUE)
rk.RMSE <- 
sqrt(mean((rk.cv$var1.pred-rk.cv$observed)^2)/length(rk.cv$var1.pred))
rk.RMSE

I would like to calculate a leave one out cross validation like I did it 
for the Regrssion Kriging, but only for upper GLM-part. Is there a way 
of package to calculate the CV only for the GLM part?

kordinary_m.glm.cv <- krige.cv(m.glm  , loc = boden.ov)

Does anyone have an idea?

Thank you in advance,
Swen

-- 
--------------------------------------------------------------
Dipl. - Geogr. Swen Meyer
Department of Geography
Physical Geography and Environmental Modeling Ludwig-Maximilian University of Munich

Luisenstrasse 37
80333 Munich/Germany
fon: +49 (0)89 2180-6648
fax: +49 (0)89 2180-6675
email: s.meyer at lmu.de
web: www.geographie.uni-muenchen.de


From eljhonjhon at hotmail.com  Mon Sep 26 14:19:15 2011
From: eljhonjhon at hotmail.com (John Ortiz)
Date: Mon, 26 Sep 2011 14:19:15 +0200
Subject: [R-sig-Geo] space - time (geological time scale)
Message-ID: <SNT135-W6CB04B017FC339C34E742C6F30@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110926/a64dfee9/attachment.pl>

From raffaele.morelli at gmail.com  Mon Sep 26 15:20:28 2011
From: raffaele.morelli at gmail.com (Raffaele Morelli)
Date: Mon, 26 Sep 2011 15:20:28 +0200
Subject: [R-sig-Geo] readShapePoints issue
In-Reply-To: <alpine.LRH.2.00.1109261119010.8513@reclus.nhh.no>
References: <CAD4guxO846vvhQQ+PvkLNudMD+265NT6eUwDX8dG6H1Bjw0Gbg@mail.gmail.com>
	<alpine.LRH.2.00.1109261119010.8513@reclus.nhh.no>
Message-ID: <CAD4guxPQ5bd+Fp94tQit_=YD-D7M8=GWb71NV+dhpPkTroCCJQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110926/5d8c2269/attachment.pl>

From edzer.pebesma at uni-muenster.de  Mon Sep 26 15:22:32 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 26 Sep 2011 15:22:32 +0200
Subject: [R-sig-Geo] space - time (geological time scale)
In-Reply-To: <SNT135-W6CB04B017FC339C34E742C6F30@phx.gbl>
References: <SNT135-W6CB04B017FC339C34E742C6F30@phx.gbl>
Message-ID: <4E807C98.5080304@uni-muenster.de>



On 09/26/2011 02:19 PM, John Ortiz wrote:
>
> Dear all,
>
> I have a large dataset of fossil record of pollen. I'm interested in
> study of the relation spatial and temporal of this dataset.
>
> For each record I have four variables: location (X,Y), age and abundance.
>
> I'm exploring the new packages "space-time". Because I want to
> interpolate the abundance of a particular specie with krigeST function.
>
> My question is related with the time format. because to set a ST-class
> object, the time must to be an object of class xts, and
> the time in my dataset is not representing with calendar dates, my data
> set is in the geological time scale (Million of years ago, "Ma")
>
> Something like that:
>
> age_Ma <- c(14.52, 17.21, 23.12, 15,6) ## dates in million of years ago
>
> Any advice "trick" how transform a vector like this in an xts object?

I can only think of a trick, and not a really nice one. Convert your 
times such that they can be represented as integers, and then convert to 
one of the allowed time classes, and later on back to numeric. If you 
don't "round", (e.g. to Ka), you'll loose digits when transforming back:

 > as.numeric(as.yearqtr(1:10+.1))
  [1]  1  2  3  4  5  6  7  8  9 10
 > as.numeric(as.yearmon(1:10+.1))
  [1]  1.083333  2.083333  3.083333  4.083333  5.083333  6.083333  7.083333
  [8]  8.083333  9.083333 10.083333
# not so suitable:
 > as.numeric(as.POSIXct(1:10+.1,origin="1-1-1"))
  [1] -62135600399 -62135600398 -62135600397 -62135600396 -62135600395
  [6] -62135600394 -62135600393 -62135600392 -62135600391 -62135600390

Hth,


>
> Regards,
>
> John

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From rshepard at appl-ecosys.com  Mon Sep 26 15:34:44 2011
From: rshepard at appl-ecosys.com (Rich Shepard)
Date: Mon, 26 Sep 2011 06:34:44 -0700 (PDT)
Subject: [R-sig-Geo] Calculating spatial autocorrelation (Moran's I)
 when have zero-inflated data?
In-Reply-To: <CAHLsRKmAtAgBGrO=9o-+3gd_BCDMPGvTGfhPmJDgE_xK1wH1jQ@mail.gmail.com>
References: <CAHLsRKmAtAgBGrO=9o-+3gd_BCDMPGvTGfhPmJDgE_xK1wH1jQ@mail.gmail.com>
Message-ID: <alpine.LNX.2.00.1109260632440.11017@salmo.appl-ecosys.com>

On Sun, 25 Sep 2011, Laura S wrote:

> I was wondering if you have suggestions on how to analyze the spatial
> autocorrelation of tree abundance in a grid of contiguous quadrats given
> that the data set follows a zero inflated distribution, i.e., in many
> quadrats the abundance of a species is zero.

Laura,

   Read Section 8.4 (and the rest of their book while you're at it) in
"Applied Spatial Data Analysis with R" by Roger S. Bivant, Edzer J. Pebesma,
and Virgilio Gomez-Rubio.

Rich


From chadefaux at gmail.com  Mon Sep 26 17:37:58 2011
From: chadefaux at gmail.com (Thomas Chadefaux)
Date: Mon, 26 Sep 2011 17:37:58 +0200
Subject: [R-sig-Geo] gdistance -- How to combine transition Layers?
Message-ID: <CA+CJDg9E3-qxYAMP1iR5bFsB=F8FrRYruQi+ZkY0jTR7X+5UfQ@mail.gmail.com>

Dear all,

This is my first post here, so I thank you in advance for your help.

My goal is to calculate the cost of traveling (friction) between two
geographical points, given underlying "friction" rasters.

Suppose for example that my data is composed of two rasters, one
binary for roads (a given cell has a road or not), and another,
continuous, for, say, altitude. Using the "gdistance" package, one can
calculate a transition function between cells. The resulting
transitionLayers can be combined by addition or multiplication (see
http://cran.r-project.org/web/packages/gdistance/vignettes/gdistance-vignette.pdf).

However, what I would need is to combine them using some kind of max
function. In other words, the transition to use would be roads if
there is one, otherwise by foot (in which case the altitude transition
layer should be used). Here is a working example that shows where I
get stuck:


require(raster)
require(gdistance)

#Create sample rasters
roads <- raster(nrows=10, ncols=10)
altitude <- raster(nrows=10, ncols=10)
roads <- setValues(roads, round(runif(10*10)) )  ; plot(roads)
altitude <- setValues(altitude, runif(10*10))        ; plot(altitude)

#Define transition layers
tr.roads <- transition(roads, transitionFunction=function(x)
x[1]*x[2]*60, 8)  #  driving at 60km/h is possible iff both cells are
roads (is this correct)?
tr.alt <- transition(altitude, transitionFunction=function(x)
x[1]-x[2], 8, symm=F)  #just a sample function.

#Now how to combine them by choosing the "fastest" transportation method?
tr.stacked <- max(tr.roads, tr.alt)  #does not work

Thank you very much in advance.
Thomas


From jacobvanetten at yahoo.com  Mon Sep 26 21:34:07 2011
From: jacobvanetten at yahoo.com (Jacob van Etten)
Date: Mon, 26 Sep 2011 20:34:07 +0100 (BST)
Subject: [R-sig-Geo] gdistance -- How to combine transition Layers?
In-Reply-To: <CA+CJDg9E3-qxYAMP1iR5bFsB=F8FrRYruQi+ZkY0jTR7X+5UfQ@mail.gmail.com>
References: <CA+CJDg9E3-qxYAMP1iR5bFsB=F8FrRYruQi+ZkY0jTR7X+5UfQ@mail.gmail.com>
Message-ID: <1317065647.76209.YahooMailNeo@web29706.mail.ird.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110926/3b5f2fae/attachment.pl>

From p.w.van.horssen at buwa.nl  Tue Sep 27 10:35:22 2011
From: p.w.van.horssen at buwa.nl (Peter van Horssen)
Date: Tue, 27 Sep 2011 10:35:22 +0200
Subject: [R-sig-Geo] space - time SpatialPixels dataframe
Message-ID: <4E818ACA.5060705@buwa.nl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110927/a95dd42a/attachment.pl>

From chadefaux at gmail.com  Tue Sep 27 11:12:34 2011
From: chadefaux at gmail.com (Thomas Chadefaux)
Date: Tue, 27 Sep 2011 11:12:34 +0200
Subject: [R-sig-Geo] gdistance -- How to combine transition Layers?
In-Reply-To: <1317065647.76209.YahooMailNeo@web29706.mail.ird.yahoo.com>
References: <CA+CJDg9E3-qxYAMP1iR5bFsB=F8FrRYruQi+ZkY0jTR7X+5UfQ@mail.gmail.com>
	<1317065647.76209.YahooMailNeo@web29706.mail.ird.yahoo.com>
Message-ID: <CA+CJDg-EPz=ajPJb6Hj=8HnhHGEadFVr_FHDuMtHFQAxkmOPKQ@mail.gmail.com>

Great, thank you very much for your solution, Jacob. While I was
waiting, I tried fiddling around with the following, but nothing
really good came out of it. Your solution works well.

#failed solution:
tr.max <- tr.roads
tr.alt.num <- as.numeric(tr.alt[1:nrow(tr.roads),1:ncol(tr.roads)])
tr.roads.num <- as.numeric(tr.roads[1:nrow(tr.roads),1:ncol(tr.roads)])
max.speed <-  pmax(tr.alt.num, tr.roads.num)
max.speed <- as.integer(max.speed)   ## needs to be integer or next
step won't work
tr.max at transitionMatrix@p <- max.speed

Thanks again,
Thomas

On Mon, Sep 26, 2011 at 9:34 PM, Jacob van Etten
<jacobvanetten at yahoo.com> wrote:
> Hi Thomas,
>
> Currently, max() is not implemented in gdistance, because it is not
> implemented in Matrix.
>
> But there are ways to work around these limitations.
>
> See the example below, based on your self contained example.
>
> Meanwhile, I will think about a more elegant and permanent solution.
>
> Jacob.
>
> ###################
>
> require(raster)
> require(gdistance)
>
> #Create sample rasters
> roads <- raster(nrows=10, ncols=10)
> altitude <- raster(nrows=10, ncols=10)
> roads <- setValues(roads, round(runif(10*10)) )? ; plot(roads)
> altitude <- setValues(altitude, runif(10*10))??????? ; plot(altitude)
>
> #Define transition layers
> tr.roads <- transition(roads, transitionFunction=function(x) x[1]*x[2]*60,
> 8)? #? driving at 60km/h is possible iff both cells are roads (is this
> correct)?
> #Yes, this is a sensible approach.
> tr.alt <- transition(altitude, transitionFunction=function(x)
> abs(x[1]-x[2]), 8, symm=F)? #just a sample function.
> #Take a look a the vignette for a more realistic (but not state-of-the-art)
> approach.
>
> #Now how to combine them by choosing the "fastest" transportation method?
> tr.stacked <- max(tr.roads, tr.alt)? #does not work
>
> #Alternative approach using indexing
> adjacencyFromTransition <- function(transition) #Probably a function I need
> to include in the package
> {
> ?? ?transitionMatr <- as(transition,"sparseMatrix")
> ?? ?transition.dgT <- as(transitionMatr,"dgTMatrix")
> ?? ?adjacency <- cbind(transition.dgT at i+1,transition.dgT at j+1)
> ?? ?return(adjacency)
> }
>
> adj <- adjacencyFromTransition(tr.roads)
>
> #Now use the index together with pmax to do what you want
> tr.alt[adj] <- pmax(tr.roads[adj], tr.alt[adj])
>
> ###############
>
> ________________________________
> From: Thomas Chadefaux <chadefaux at gmail.com>
> To: r-sig-geo at r-project.org
> Sent: Monday, 26 September 2011, 17:37
> Subject: [R-sig-Geo] gdistance -- How to combine transition Layers?
>
> Dear all,
>
> This is my first post here, so I thank you in advance for your help.
>
> My goal is to calculate the cost of traveling (friction) between two
> geographical points, given underlying "friction" rasters.
>
> Suppose for example that my data is composed of two rasters, one
> binary for roads (a given cell has a road or not), and another,
> continuous, for, say, altitude. Using the "gdistance" package, one can
> calculate a transition function between cells. The resulting
> transitionLayers can be combined by addition or multiplication (see
> http://cran.r-project.org/web/packages/gdistance/vignettes/gdistance-vignette.pdf).
>
> However, what I would need is to combine them using some kind of max
> function. In other words, the transition to use would be roads if
> there is one, otherwise by foot (in which case the altitude transition
> layer should be used). Here is a working example that shows where I
> get stuck:
>
>
> require(raster)
> require(gdistance)
>
> #Create sample rasters
> roads <- raster(nrows=10, ncols=10)
> altitude <- raster(nrows=10, ncols=10)
> roads <- setValues(roads, round(runif(10*10)) )? ; plot(roads)
> altitude <- setValues(altitude, runif(10*10))? ? ? ? ; plot(altitude)
>
> #Define transition layers
> tr.roads <- transition(roads, transitionFunction=function(x)
> x[1]*x[2]*60, 8)? #? driving at 60km/h is possible iff both cells are
> roads (is this correct)?
> tr.alt <- transition(altitude, transitionFunction=function(x)
> x[1]-x[2], 8, symm=F)? #just a sample function.
>
> #Now how to combine them by choosing the "fastest" transportation method?
> tr.stacked <- max(tr.roads, tr.alt)? #does not work
>
> Thank you very much in advance.
> Thomas
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>


From paul.hiemstra at knmi.nl  Tue Sep 27 13:30:23 2011
From: paul.hiemstra at knmi.nl (Paul Hiemstra)
Date: Tue, 27 Sep 2011 11:30:23 +0000
Subject: [R-sig-Geo] SpatialGridDataFrame
In-Reply-To: <DUB108-W63E31ABF5A3FA78AEA5201E50F0@phx.gbl>
References: <DUB108-W63E31ABF5A3FA78AEA5201E50F0@phx.gbl>
Message-ID: <4E81B3CF.9020008@knmi.nl>

 Hi,

The problem is that your coordinates are not exactly on a grid. The very
low suggested threshold indicates that this is only a marginal
deviation, probably due to rounding of the coordinates. Try using the
points2grid function directly, see ?points2grid. Specifically, take a
look at the tolerance argument of points2grid.

Paul

On 09/23/2011 08:01 AM, Eugenio Trumpy wrote:
> Hi to all,
> i'm new of the list, and i have a poor experience unfortunatly in geostatistic.
> I'm working with grass and R in a linux debian pc.
> I'm using grass 6.4.1 with R 2.13.1.
> I have loaded spgrass6, gstat, lattice libraries to create some interpolated map
> by kriging method.
> I created the map with universal kriging, and now i'm tryng to write this map in
> grass with:
>
>> writeRAST6(UK_avampaese,"UK_avampaese",zcol="var1.pred")
> but i have this error message:
>
> Errore: gridded(dataset) is not TRUE
>
> I cheked the dataset typology, UK_avampaese is a SpatialPointDataFrame,
> and writeRAST6 needs SpatialGridDataFrame.
>
> Which is the procedure to convert the a SpatialPointDataFrame to SpatialGridDataFrame?
> Is possible to make this changeover?
>
> I also tried:
>> gridded(UK_avampaese)=T
> but i received this message:
>
> suggested tolerance minimum: 4.61319e-08 
> Errore in points2grid(points, tolerance, round) : 
>   dimension 2 : coordinate intervals are not constant
> Inoltre: Warning message:
> In points2grid(points, tolerance, round) :
>   grid has empty column/rows in dimension 1
>
> I would like to specify that the prediction grid used as newdata,
> is a SpatialPointDataFrame coming from grass point vector data,
> who have an irregular boundary and 5 km spaced.
>
> Any hits are very appreced,
> bast regards
>
> Eugenio 
>  		 	   		  
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


-- 
Paul Hiemstra, Ph.D.
Global Climate Division
Royal Netherlands Meteorological Institute (KNMI)
Wilhelminalaan 10 | 3732 GK | De Bilt | Kamer B 3.39
P.O. Box 201 | 3730 AE | De Bilt
tel: +31 30 2206 494

http://intamap.geo.uu.nl/~paul
http://nl.linkedin.com/pub/paul-hiemstra/20/30b/770


From edzer.pebesma at uni-muenster.de  Tue Sep 27 13:55:35 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 27 Sep 2011 13:55:35 +0200
Subject: [R-sig-Geo] space - time SpatialPixels dataframe
In-Reply-To: <4E818ACA.5060705@buwa.nl>
References: <4E818ACA.5060705@buwa.nl>
Message-ID: <4E81B9B7.6050005@uni-muenster.de>



On 09/27/2011 10:35 AM, Peter van Horssen wrote:
> Hi all,
>
> I have an irregular (space-time) dataset with counts per 'gridcell'
>
>  > data2.pts.sum[1:10,]
> coordinates datum sum
> 1 (-9375, 480625) 2010-11-29 1
> 2 (5375, 530375) 2011-01-28 1
> 3 (21875, 529375) 2010-11-29 1
> 4 (25625, 396875) 2010-02-10 1
> 5 (26375, 396875) 2010-02-10 9
> 6 (26625, 418125) 2011-05-12 1
> 7 (28125, 419875) 2006-02-16 1
> 8 (28375, 524125) 2011-01-28 1
> 9 (28875, 418375) 2005-02-10 3
> 10 (29375, 409125) 2010-04-22 5
>
> What I like to end up with is a _full grid_ STFDF.
>
> I have created a spatialpixelsdataframe and then applying
> fullgrid(spdf)<-TRUE but this creates, obviously, 'NAS' in dates and data.
>
> The question is how to proceed.
> Creating (manually) a file with all spatial locations and all dates
> (19257 x 75) and
> then matching data to it ? Or is there a smarter solution?
> (e.g is it somehow possible to use fullgrid on a STIDF/STFDF? )

Hi Peter,

right now, ST* classes do not have a fullgrid method, but I will think 
about it. Anyway, they would be another way of coercion, as in

as(x, "STFDF")

which is how the vignette tells you how to do it.

For constructing STFDF objects, you can use constructor functions 
STIDF(), STSDF() and STFDF(), or alternatively stConstruct(); all have 
documentation, and examples in the vignette.

Bests,

>
>
> greetings Peter
>
> --
> ================================
> Peter van Horssen
> Bureau Waardenburg bv
> Adviseurs voor ecologie&  milieu
> Postbus 365
> 4100 AJ Culemborg
> Tel: 0345-512710
> Fax: 0345-519849
> e-mail:p.w.van.horssen at buwa.nl
> ================================
>
> ---------------------------- DISCLAIMER --------------------------
> De informatie verzonden met dit e-mail bericht is uitsluitend bestemd voor de geadresseerde. Openbaarmaking, vermenigvuldiging, verspreiding en/of verstrekking aan derden is niet toegestaan. Gebruik van deze informatie door anderen dan de geadresseerde is verboden. U wordt verzocht bij onjuiste adressering de afzender direct te informeren door het bericht te retourneren.
>
> P  denk aan het milieu voordat u dit bericht print
>

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From buitenwerf at em.uni-frankfurt.de  Tue Sep 27 15:32:32 2011
From: buitenwerf at em.uni-frankfurt.de (Robert Buitenwerf)
Date: Tue, 27 Sep 2011 15:32:32 +0200
Subject: [R-sig-Geo] Mask() in raster package only returns RasterLayers not
 RasterStack or RasterBrick
Message-ID: <4E81D070.7000605@em.uni-frankfurt.de>

Dear members,

I am very happily using the raster package but here is a problem I can't 
solve.

When I use the mask function on  a RasterBrick or RasterStack:

raster_mask <- mask( raster_stack, SpatialPolygonDataFrame)

raster returns a RasterLayer and gives me a warning:

"In .rasterFromRasterFile(grdfile, band = band, objecttype) : size of 
values file does not match the number of cells (given the data type)"

When I use mask on a single layer from a brick or stack (e.g. mask( 
RasterStack[1], SpatialPolygon*) ) it returns a correctly masked 
rasterlayer.

I am trying to mask with a SpatialPolygonDataFrame, read in with 
readShapePoly of the maptools package.
R version 2.13.0 (2011-04-13)
Platform: x86_64-pc-mingw32/x64 (64-bit)


I am sure I missed something simple and I hope someone would point it 
out to me.

Thanks,
Robert


From brenning at uwaterloo.ca  Tue Sep 27 15:33:37 2011
From: brenning at uwaterloo.ca (Alexander Brenning)
Date: Tue, 27 Sep 2011 09:33:37 -0400
Subject: [R-sig-Geo] Leave one out cross validation in a Generalized linear
 Model?
In-Reply-To: <mailman.13.1317117604.15511.r-sig-geo@r-project.org>
References: <mailman.13.1317117604.15511.r-sig-geo@r-project.org>
Message-ID: <4E81D0B1.6030801@uwaterloo.ca>

Hi Swen,
try 'errorest' in package 'ipred'. Leave-one-out cross-validation of the 
'lm' is pretty straightforward with this function. For LOO-CV of 
regression kriging (i.e. combined prediction of regression and kriging 
method) you would have to write small wrapper functions to be passed to 
'errorest' via the 'model' and 'predict' arguments - see the Examples 
section of the errorest help.
Best,
   Alex


> Date: Mon, 26 Sep 2011 12:38:51 +0200
> From: Swen Meyer<s.meyer at lmu.de>
> To: R-sig-Geo at r-project.org
> Subject: [R-sig-Geo] Leave one out cross validation in a Generalized
> 	linear	Model?
> Message-ID:<4E80563B.8050705 at lmu.de>
> Content-Type: text/plain; charset=ISO-8859-15; format=flowed
>
>
> Dear All,
> I got the following problem. I use the GLM below to do Regression Kriging:
>
> #MLR backward Co-Variables(P1 -P10)
> fit1<- lm((CLAY)~  PC1 + PC2 +PC3 +PC4 +PC5 +PC6 +PC7 +PC8+PC9 +PC10
> , boden.ov[sel,] )
> #GLM
> m.glm<- glm(formula(step), boden.ov[sel,], family=gaussian)
> summary(m.glm)
> p.glm<- predict(m.glm, newdata=boden.grid, type="link", se.fit=TRUE)
> om.glm<- as(boden.grid["band1"], "SpatialPointsDataFrame")
> om.glm$var1.pred<- p.glm$fit
> om.glm$var1.var<- p.glm$se.fit
> om.glm$svar<- p.glm$se.fit^2/(m.glm$null.deviance/m.glm$df.null)
> gridded(om.glm)<- TRUE
> fullgrid(om.glm)<- TRUE
>
> ##Regression Kriging with GLM
> vario.res<- autofitVariogram((CLAY)~om.glm, boden.ov[sel,], model =
> c("Sph"))
> plot(variogram((CLAY)~om.glm, boden.ov[sel,]), vario.res$var_model)
> om.rk<- krige((CLAY)~om.glm,boden.ov, boden.grid,    vario.res$var_model)
> om.rk$om.pred<- (om.rk$var1.pred)
>
> #Leave one out Cross Validation Regression Kriging
> rk.cv<- krige.cv((CLAY)~om.glm,boden.ov,   vario.res$var_model,
> verbose=TRUE)
> rk.RMSE<-
> sqrt(mean((rk.cv$var1.pred-rk.cv$observed)^2)/length(rk.cv$var1.pred))
> rk.RMSE
>
> I would like to calculate a leave one out cross validation like I did it
> for the Regrssion Kriging, but only for upper GLM-part. Is there a way
> of package to calculate the CV only for the GLM part?
>
> kordinary_m.glm.cv<- krige.cv(m.glm  , loc = boden.ov)
>
> Does anyone have an idea?
>
> Thank you in advance,
> Swen
>

-- 
Alexander Brenning
brenning at uwaterloo.ca - T +1-519-888-4567 ext 35783
Department of Geography and Environmental Management
University of Waterloo
200 University Ave. W - Waterloo, ON - Canada N2L 3G1
http://www.environment.uwaterloo.ca/geography/faculty/brenning/


From lyolya at gmail.com  Tue Sep 27 17:35:56 2011
From: lyolya at gmail.com (Lyolya)
Date: Tue, 27 Sep 2011 17:35:56 +0200
Subject: [R-sig-Geo] A krige.conv() question :: variance
Message-ID: <CA+1Vxx21tTQTqqkTKqpK4e4KU5na2R0SWOq-FdWpz2XuYv4T9Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110927/49c506b5/attachment.pl>

From r.hijmans at gmail.com  Tue Sep 27 22:15:00 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 27 Sep 2011 13:15:00 -0700
Subject: [R-sig-Geo] Mask() in raster package only returns RasterLayers
 not RasterStack or RasterBrick
In-Reply-To: <4E81D070.7000605@em.uni-frankfurt.de>
References: <4E81D070.7000605@em.uni-frankfurt.de>
Message-ID: <CANtt_hyU-Y70sywfzBXMKtC3_4fW=WCMg8gjWEPeE2nQMhx0bw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110927/de0e9e07/attachment.pl>

From mfalconer at bsc-eoc.org  Tue Sep 27 23:57:55 2011
From: mfalconer at bsc-eoc.org (Myles Falconer)
Date: Tue, 27 Sep 2011 17:57:55 -0400
Subject: [R-sig-Geo] rotate sp.objects in spplot?
Message-ID: <D828AF18F9CABA4AADDA9D0F9808ED76AF19227C64@bsc2008.bsc-eoc.org>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110927/d71259ea/attachment.pl>

From Roger.Bivand at nhh.no  Wed Sep 28 09:41:30 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 28 Sep 2011 09:41:30 +0200 (CEST)
Subject: [R-sig-Geo] rotate sp.objects in spplot?
In-Reply-To: <D828AF18F9CABA4AADDA9D0F9808ED76AF19227C64@bsc2008.bsc-eoc.org>
References: <D828AF18F9CABA4AADDA9D0F9808ED76AF19227C64@bsc2008.bsc-eoc.org>
Message-ID: <alpine.LRH.2.00.1109280937250.19455@reclus.nhh.no>

On Tue, 27 Sep 2011, Myles Falconer wrote:

> Hi everyone,
>
> Just wondering if anyone knows how to rotate objects in spplot. Using 
> the script below, let's say I wanted to rotate the north arrow by 12 
> degrees... any ideas? Thanks!

library(maptools)
?elide

So:

arrow = list("SpatialPolygonsRescale", elide(layout.north.arrow(),
   rotate=12), offset = c(178750,332500), scale = 400)

looks about OK. Do you know that your data have non-North Northings (I 
guess you do!), the presumption in "Spatial" objects is that North is 
aligned with the vertical axis?

Roger

>
>
> library(sp)
> library(lattice) # required for trellis.par.set():
> trellis.par.set(sp.theme()) # sets color ramp to bpy.colors()
>
> data(meuse)
> coordinates(meuse)=~x+y
>
> scale = list("SpatialPolygonsRescale", layout.scale.bar(),
>        offset = c(178600,332990), scale = 500, fill=c("transparent","black"))
> text1 = list("sp.text", c(178600,333090), "0")
> text2 = list("sp.text", c(179100,333090), "500 m")
> arrow = list("SpatialPolygonsRescale", layout.north.arrow(),
>        offset = c(178750,332500), scale = 400)
> ## points plot with scale bar, scale bar text, north arrow and title:
> spplot(meuse, "zinc", do.log=T,
>        key.space=list(x=0.1,y=0.93,corner=c(0,1)),
>        sp.layout=list(scale,text1,text2,arrow),
>        main = "Zinc (top soil)")
>
>
> ___________________________________________
>
> Myles Falconer, Ontario Region Project Biologist,
> Bird Studies Canada,
> 115 Front St., P.O. Box 160,
> Port Rowan, ON
> N0E 1M0 Canada
> Email: mfalconer at birdscanada.org
> Ph: 1-888-448-2473 ext. 165
> Local Ph: 519-586-3531 ext. 165
>
> BSC website: http://www.bsc-eoc.org/
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From mfalconer at bsc-eoc.org  Wed Sep 28 16:28:04 2011
From: mfalconer at bsc-eoc.org (Myles Falconer)
Date: Wed, 28 Sep 2011 10:28:04 -0400
Subject: [R-sig-Geo] rotate sp.objects in spplot?
In-Reply-To: <alpine.LRH.2.00.1109280937250.19455@reclus.nhh.no>
References: <D828AF18F9CABA4AADDA9D0F9808ED76AF19227C64@bsc2008.bsc-eoc.org>
	<alpine.LRH.2.00.1109280937250.19455@reclus.nhh.no>
Message-ID: <D828AF18F9CABA4AADDA9D0F9808ED76AF19227C69@bsc2008.bsc-eoc.org>

Thanks very much Roger!

Is it possible to also rotate sp.text with elide?

Myles

-----Original Message-----
From: Roger Bivand [mailto:Roger.Bivand at nhh.no]
Sent: September-28-11 3:42 AM
To: Myles Falconer
Cc: 'r-sig-geo at r-project.org'
Subject: Re: [R-sig-Geo] rotate sp.objects in spplot?

On Tue, 27 Sep 2011, Myles Falconer wrote:

> Hi everyone,
>
> Just wondering if anyone knows how to rotate objects in spplot. Using
> the script below, let's say I wanted to rotate the north arrow by 12
> degrees... any ideas? Thanks!

library(maptools)
?elide

So:

arrow = list("SpatialPolygonsRescale", elide(layout.north.arrow(),
   rotate=12), offset = c(178750,332500), scale = 400)

looks about OK. Do you know that your data have non-North Northings (I
guess you do!), the presumption in "Spatial" objects is that North is
aligned with the vertical axis?

Roger

>
>
> library(sp)
> library(lattice) # required for trellis.par.set():
> trellis.par.set(sp.theme()) # sets color ramp to bpy.colors()
>
> data(meuse)
> coordinates(meuse)=~x+y
>
> scale = list("SpatialPolygonsRescale", layout.scale.bar(),
>        offset = c(178600,332990), scale = 500, fill=c("transparent","black"))
> text1 = list("sp.text", c(178600,333090), "0")
> text2 = list("sp.text", c(179100,333090), "500 m")
> arrow = list("SpatialPolygonsRescale", layout.north.arrow(),
>        offset = c(178750,332500), scale = 400)
> ## points plot with scale bar, scale bar text, north arrow and title:
> spplot(meuse, "zinc", do.log=T,
>        key.space=list(x=0.1,y=0.93,corner=c(0,1)),
>        sp.layout=list(scale,text1,text2,arrow),
>        main = "Zinc (top soil)")
>
>
> ___________________________________________
>
> Myles Falconer, Ontario Region Project Biologist,
> Bird Studies Canada,
> 115 Front St., P.O. Box 160,
> Port Rowan, ON
> N0E 1M0 Canada
> Email: mfalconer at birdscanada.org
> Ph: 1-888-448-2473 ext. 165
> Local Ph: 519-586-3531 ext. 165
>
> BSC website: http://www.bsc-eoc.org/
>

--
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Wed Sep 28 19:43:58 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 28 Sep 2011 19:43:58 +0200 (CEST)
Subject: [R-sig-Geo] rotate sp.objects in spplot?
In-Reply-To: <D828AF18F9CABA4AADDA9D0F9808ED76AF19227C69@bsc2008.bsc-eoc.org>
References: <D828AF18F9CABA4AADDA9D0F9808ED76AF19227C64@bsc2008.bsc-eoc.org>
	<alpine.LRH.2.00.1109280937250.19455@reclus.nhh.no>
	<D828AF18F9CABA4AADDA9D0F9808ED76AF19227C69@bsc2008.bsc-eoc.org>
Message-ID: <alpine.LRH.2.00.1109281934540.20887@reclus.nhh.no>

On Wed, 28 Sep 2011, Myles Falconer wrote:

> Thanks very much Roger!
>
> Is it possible to also rotate sp.text with elide?

No, but you could check the rotation parameters for the underlying 
graphics method, which seem to be srt=:

text1 = list("sp.text", c(178600,333090), "0", srt=-12)

Roger

>
> Myles
>
> -----Original Message-----
> From: Roger Bivand [mailto:Roger.Bivand at nhh.no]
> Sent: September-28-11 3:42 AM
> To: Myles Falconer
> Cc: 'r-sig-geo at r-project.org'
> Subject: Re: [R-sig-Geo] rotate sp.objects in spplot?
>
> On Tue, 27 Sep 2011, Myles Falconer wrote:
>
>> Hi everyone,
>>
>> Just wondering if anyone knows how to rotate objects in spplot. Using
>> the script below, let's say I wanted to rotate the north arrow by 12
>> degrees... any ideas? Thanks!
>
> library(maptools)
> ?elide
>
> So:
>
> arrow = list("SpatialPolygonsRescale", elide(layout.north.arrow(),
>   rotate=12), offset = c(178750,332500), scale = 400)
>
> looks about OK. Do you know that your data have non-North Northings (I
> guess you do!), the presumption in "Spatial" objects is that North is
> aligned with the vertical axis?
>
> Roger
>
>>
>>
>> library(sp)
>> library(lattice) # required for trellis.par.set():
>> trellis.par.set(sp.theme()) # sets color ramp to bpy.colors()
>>
>> data(meuse)
>> coordinates(meuse)=~x+y
>>
>> scale = list("SpatialPolygonsRescale", layout.scale.bar(),
>>        offset = c(178600,332990), scale = 500, fill=c("transparent","black"))
>> text1 = list("sp.text", c(178600,333090), "0")
>> text2 = list("sp.text", c(179100,333090), "500 m")
>> arrow = list("SpatialPolygonsRescale", layout.north.arrow(),
>>        offset = c(178750,332500), scale = 400)
>> ## points plot with scale bar, scale bar text, north arrow and title:
>> spplot(meuse, "zinc", do.log=T,
>>        key.space=list(x=0.1,y=0.93,corner=c(0,1)),
>>        sp.layout=list(scale,text1,text2,arrow),
>>        main = "Zinc (top soil)")
>>
>>
>> ___________________________________________
>>
>> Myles Falconer, Ontario Region Project Biologist,
>> Bird Studies Canada,
>> 115 Front St., P.O. Box 160,
>> Port Rowan, ON
>> N0E 1M0 Canada
>> Email: mfalconer at birdscanada.org
>> Ph: 1-888-448-2473 ext. 165
>> Local Ph: 519-586-3531 ext. 165
>>
>> BSC website: http://www.bsc-eoc.org/
>>
>
> --
> Roger Bivand
> Department of Economics, NHH Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From paulojus at c3sl.ufpr.br  Wed Sep 28 21:40:15 2011
From: paulojus at c3sl.ufpr.br (Paulo Justiniano Ribeiro Jr)
Date: Wed, 28 Sep 2011 16:40:15 -0300 (BRT)
Subject: [R-sig-Geo] A krige.conv() question :: variance
In-Reply-To: <CA+1Vxx21tTQTqqkTKqpK4e4KU5na2R0SWOq-FdWpz2XuYv4T9Q@mail.gmail.com>
References: <CA+1Vxx21tTQTqqkTKqpK4e4KU5na2R0SWOq-FdWpz2XuYv4T9Q@mail.gmail.com>
Message-ID: <alpine.DEB.2.00.1109281637420.1340@macalan.c3sl.ufpr.br>

Dear Olga

Using the notation in Diggle and Ribeiro (2007)
the kriging predictor ($predict)
and the associates variance are summaries of the (estimated) predictive 
distribution, and therefore provide estimates of E[S|Y] and Var[S|Y]



Paulo Justiniano Ribeiro Jr
LEG (Laboratorio de Estatistica e Geoinformacao)
Universidade Federal do Parana
Caixa Postal 19.081
CEP 81.531-990
Curitiba, PR  -  Brasil
Tel: (+55) 41 3361 3573
VOIP: (+55) (41) (3361 3600) 1053 1066
Fax: (+55) 41 3361 3141
e-mail: paulojus AT  ufpr  br
http://www.leg.ufpr.br/~paulojus

On Tue, 27 Sep 2011, Lyolya wrote:

> Dear list,
>
> I've been using the krige.conv() function, and I'm a little lost as
> interpreting the output results. Does the component $krige.var stand for the
> krigIng variance (or kriging error) or for the variance of the kriging
> predictor (or the mean squared error)?
>
> Thank you very much in advance for any reply or a hint.
>
> -- 
> Best regards,
> Olga Ivina.
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From r.turner at auckland.ac.nz  Wed Sep 28 23:08:49 2011
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Thu, 29 Sep 2011 10:08:49 +1300
Subject: [R-sig-Geo] Memory size issue and setting bounding box when
 conducting Kest on multiple tree species
In-Reply-To: <CAHLsRKkYVL_L=LL1VVRj==HUbUSxXkay_sCtc-wdFxE+nJ3XyQ@mail.gmail.com>
References: <CAHLsRKkYVL_L=LL1VVRj==HUbUSxXkay_sCtc-wdFxE+nJ3XyQ@mail.gmail.com>
Message-ID: <4E838CE1.8000203@auckland.ac.nz>

On 26/09/11 17:11, Laura S wrote:
> Dear all:
>
> (1) When I try to run Kest(data.ppp, correction=isotropic, nlarge=Inf...) I
> get the following error:
> Error: cannot allocate vector of size 463.4 Mb
> How do you normally overcome this issue? I have a SpatialPointsDataFrame
> that I converted into a ppp, so there are multiple tree species (points)
> being analyzed using Kest.

Well,  basically if a data set is too big, it's too big.  There are 
limitations.
Computers, even today, do not have infinite capacity.

One idea might be to try subdividing your point pattern into a number
of smaller patterns.  I.e. subdivide your window into a grid of rectangles,
clip the pattern to each of the rectangles, and analyze each resulting
pattern separately.  Ideally there should be a basic consistency between
the results of the ``sub-analyses''.  If such consistency is lacking, then
``interesting'' issues are raised about what the overall pattern is trying
to tell you.
> (2) How you recommend I set the bounding box, so that it is the same for all
> species? It is important that the spatial pattern of each tree species be
> analyzed in the same sampling window.

I don't really understand this question.  Your pattern should be equipped
with a window (and the window should consist of the region in which
points were *looked for*.  See Adrian Baddeley's workshop notes,
http://www.csiro.au/resources/Spatial-Point-Patterns-in-R.html,
section 2.4, page 15).

Generally speaking it is better to have all species in a single pattern
with the species indicated by the *marks* component of the "ppp"
object, rather than having each species in a separate pattern.

     cheers,

         Rolf Turner


From jgrn at illinois.edu  Thu Sep 29 04:20:11 2011
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Wed, 28 Sep 2011 19:20:11 -0700
Subject: [R-sig-Geo] Flow accumulation in R?
Message-ID: <CABG0rftYBqw6_mdiYMJzM61JOqjz4N87vaswfMg9V4qqiNi3aw@mail.gmail.com>

R-sig-geo'ers:

I was wondering if anyone had implemented flow accumulation in R (e.g.
http://www.cs.duke.edu/geo*/terraflow/)?

--j

-- 
Jonathan A. Greenberg, PhD
Assistant Professor
Department of Geography
University of Illinois at Urbana-Champaign
607 South Mathews Avenue, MC 150
Urbana, IL 61801
Phone: 415-763-5476
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
http://www.geog.illinois.edu/people/JonathanGreenberg.html


From sandeep.coepcivil at gmail.com  Thu Sep 29 06:07:07 2011
From: sandeep.coepcivil at gmail.com (Sandeep Patil)
Date: Wed, 28 Sep 2011 23:07:07 -0500
Subject: [R-sig-Geo] AUTOMAP Installation
Message-ID: <CAHnA5RWr+cHaUeWaAUOG6eo2DRCTy3bLbhXp5a0oMsbe6mMFng@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110928/30f89aa8/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Thu Sep 29 08:54:46 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Thu, 29 Sep 2011 07:54:46 +0100
Subject: [R-sig-Geo] AUTOMAP Installation
In-Reply-To: <CAHnA5RWr+cHaUeWaAUOG6eo2DRCTy3bLbhXp5a0oMsbe6mMFng@mail.gmail.com>
References: <CAHnA5RWr+cHaUeWaAUOG6eo2DRCTy3bLbhXp5a0oMsbe6mMFng@mail.gmail.com>
Message-ID: <CANVKczOL=A0Dx5bUi6jNc3JEA=HxooFBxSxuabzhRTDRRn_5Qw@mail.gmail.com>

On Thu, Sep 29, 2011 at 5:07 AM, Sandeep Patil
<sandeep.coepcivil at gmail.com> wrote:
> This Question is specifically about the cross validation package developed
> by Paul Hiemstra.
>
> I am unable to install it on R version 2.12 running on a Linux machine , has
> anyone tried a
>
> similar installation?

 Can you post your error message? Or tell us why you are unable?


From r.m.krug at gmail.com  Thu Sep 29 09:50:23 2011
From: r.m.krug at gmail.com (Rainer M Krug)
Date: Thu, 29 Sep 2011 09:50:23 +0200
Subject: [R-sig-Geo] Flow accumulation in R?
In-Reply-To: <CABG0rftYBqw6_mdiYMJzM61JOqjz4N87vaswfMg9V4qqiNi3aw@mail.gmail.com>
References: <CABG0rftYBqw6_mdiYMJzM61JOqjz4N87vaswfMg9V4qqiNi3aw@mail.gmail.com>
Message-ID: <CAGhLh6EY3_ho38igAfv_FJQ1Cus0_yy7GTBK9ivtk2ENJ9V_vQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110929/aa63d17b/attachment.pl>

From s.meyer at lmu.de  Thu Sep 29 10:48:44 2011
From: s.meyer at lmu.de (Swen Meyer)
Date: Thu, 29 Sep 2011 10:48:44 +0200
Subject: [R-sig-Geo] Leave one out cross validation in a Generalized
 linear Model?
In-Reply-To: <4E81D0B1.6030801@uwaterloo.ca>
References: <mailman.13.1317117604.15511.r-sig-geo@r-project.org>
	<4E81D0B1.6030801@uwaterloo.ca>
Message-ID: <4E8430EC.6040205@lmu.de>

Hi Alex,
thanks for the tip. You are writing about the " Leave-one-out 
cross-validation of the 'lm', but I need it for a GLM. I can do the CV 
for the lm with gstat using the krige.cv function (see below), but I 
don`t know how to use the CV for the GLM part. I also tried the 
"errorest" function in the "Ipred" package.  But I wasn`t able to put 
the GLM in there in the right way and I can`t find anything about GLM in 
the manual?
Any Idea?
Thats how I do the CV for the LM and below ther is the GLM tjhat I?m 
susing for the Regression Kriging:
###################
##Linear Regression##
#######LM##########

fit1 <- lm((log1p(SAND))~PC1 + PC2 + PC3 + PC4 + PC5  + PC7 + PC8 + PC9 
+ PC10 + PC11 + PC12 + PC13 + PC14 + PC15 + PC16 + PC17 + PC18 +PC19 , 
boden.ov[sel,] )
step1 <- stepAIC(fit1, direction="backward")
step1$anova # display results
reg <- formula(step1)

#####loocv for the LM
kordinary_reg.cv <- krige.cv(reg  , loc = boden.ov)

###############################
####GLM model (package (GLM))##
###############################
summary(lm(formula(step1), boden.ov[sel,]))
m.glm <- glm(formula(step1), boden.ov[sel,], family=gaussian(log))
summary(m.glm)
p.glm <- predict(m.glm, newdata=boden.grid, type="link", se.fit=TRUE)
om.glm <- as(boden.grid["band1"], "SpatialPointsDataFrame")
om.glm$var1.pred <- p.glm$fit
om.glm$var1.var <- p.glm$se.fit
om.glm$svar <- p.glm$se.fit^2/(m.glm$null.deviance/m.glm$df.null)
gridded(om.glm) <- TRUE
fullgrid(om.glm) <- TRUE
Best,
Swen

Am 27.09.2011 15:33, schrieb Alexander Brenning:
> Hi Swen,
> try 'errorest' in package 'ipred'. Leave-one-out cross-validation of 
> the 'lm' is pretty straightforward with this function. For LOO-CV of 
> regression kriging (i.e. combined prediction of regression and kriging 
> method) you would have to write small wrapper functions to be passed 
> to 'errorest' via the 'model' and 'predict' arguments - see the 
> Examples section of the errorest help.
> Best,
>   Alex
>
>
>
> -- 
> --------------------------------------------------------------
> Dipl. - Geogr. Swen Meyer
> Department of Geography
> Physical Geography and Environmental Modeling Ludwig-Maximilian University of Munich
>
> Luisenstrasse 37
> 80333 Munich/Germany
> fon: +49 (0)89 2180-6648
> fax: +49 (0)89 2180-6675
> email: s.meyer at lmu.de
> web: www.geographie.uni-muenchen.de
>


From p.vanbreugel at gmail.com  Thu Sep 29 13:26:36 2011
From: p.vanbreugel at gmail.com (Paulo van Breugel)
Date: Thu, 29 Sep 2011 13:26:36 +0200
Subject: [R-sig-Geo] Problems importing GRASS vector data with other then
 default layer 1
Message-ID: <4E8455EC.4080607@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110929/4c255080/attachment.pl>

From ashton at msu.edu  Thu Sep 29 14:19:19 2011
From: ashton at msu.edu (Ashton Shortridge)
Date: Thu, 29 Sep 2011 08:19:19 -0400
Subject: [R-sig-Geo] Flow accumulation in R?
In-Reply-To: <CABG0rftYBqw6_mdiYMJzM61JOqjz4N87vaswfMg9V4qqiNi3aw@mail.gmail.com>
References: <CABG0rftYBqw6_mdiYMJzM61JOqjz4N87vaswfMg9V4qqiNi3aw@mail.gmail.com>
Message-ID: <201109290819.20123.ashton@msu.edu>

On 09/28/11, Jonathan Greenberg, wrote:
> R-sig-geo'ers:
> 
> I was wondering if anyone had implemented flow accumulation in R (e.g.
> http://www.cs.duke.edu/geo*/terraflow/)?
> 
> --j

Hi Jonathan,

I couldn't say if it has been implemented in R for sure, but several surface 
flow variations are implemented in the GRASS GIS, and GRASS can be connected to 
R, if that is helpful. Check out r.watershed and r.terraflow in GRASS.

Yours,

Ashton



-----
Ashton Shortridge
Associate Professor			ashton at msu.edu
Dept of Geography			http://www.msu.edu/~ashton
235 Geography Building		ph (517) 432-3561
Michigan State University		fx (517) 432-1671


From ashton at msu.edu  Thu Sep 29 14:19:19 2011
From: ashton at msu.edu (Ashton Shortridge)
Date: Thu, 29 Sep 2011 08:19:19 -0400
Subject: [R-sig-Geo] Flow accumulation in R?
In-Reply-To: <CABG0rftYBqw6_mdiYMJzM61JOqjz4N87vaswfMg9V4qqiNi3aw@mail.gmail.com>
References: <CABG0rftYBqw6_mdiYMJzM61JOqjz4N87vaswfMg9V4qqiNi3aw@mail.gmail.com>
Message-ID: <201109290819.20123.ashton@msu.edu>

On 09/28/11, Jonathan Greenberg, wrote:
> R-sig-geo'ers:
> 
> I was wondering if anyone had implemented flow accumulation in R (e.g.
> http://www.cs.duke.edu/geo*/terraflow/)?
> 
> --j

Hi Jonathan,

I couldn't say if it has been implemented in R for sure, but several surface 
flow variations are implemented in the GRASS GIS, and GRASS can be connected to 
R, if that is helpful. Check out r.watershed and r.terraflow in GRASS.

Yours,

Ashton



-----
Ashton Shortridge
Associate Professor			ashton at msu.edu
Dept of Geography			http://www.msu.edu/~ashton
235 Geography Building		ph (517) 432-3561
Michigan State University		fx (517) 432-1671


From jgarcia at ija.csic.es  Thu Sep 29 14:59:24 2011
From: jgarcia at ija.csic.es (jgarcia at ija.csic.es)
Date: Thu, 29 Sep 2011 14:59:24 +0200
Subject: [R-sig-Geo] Flow accumulation in R?
In-Reply-To: <201109290819.20123.ashton@msu.edu>
References: <CABG0rftYBqw6_mdiYMJzM61JOqjz4N87vaswfMg9V4qqiNi3aw@mail.gmail.com>
	<201109290819.20123.ashton@msu.edu>
Message-ID: <1523.155.54.207.175.1317301164.squirrel@paleo.ija.csic.es>

Hi Jonathan,
I think the function topidx (in library topmodel) is what you are after.
It returns two rasters; look at the second one.
Best wishes,
Javier
---

> On 09/28/11, Jonathan Greenberg, wrote:
>> R-sig-geo'ers:
>>
>> I was wondering if anyone had implemented flow accumulation in R (e.g.
>> http://www.cs.duke.edu/geo*/terraflow/)?
>>
>> --j
>
> Hi Jonathan,
>
> I couldn't say if it has been implemented in R for sure, but several
> surface
> flow variations are implemented in the GRASS GIS, and GRASS can be
> connected to
> R, if that is helpful. Check out r.watershed and r.terraflow in GRASS.
>
> Yours,
>
> Ashton
>
>
>
> -----
> Ashton Shortridge
> Associate Professor			ashton at msu.edu
> Dept of Geography			http://www.msu.edu/~ashton
> 235 Geography Building		ph (517) 432-3561
> Michigan State University		fx (517) 432-1671
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From mauricio.zambrano at jrc.ec.europa.eu  Thu Sep 29 15:39:54 2011
From: mauricio.zambrano at jrc.ec.europa.eu (Mauricio Zambrano-Bigiarini)
Date: Thu, 29 Sep 2011 15:39:54 +0200
Subject: [R-sig-Geo] AUTOMAP Installation
In-Reply-To: <CAHnA5RWr+cHaUeWaAUOG6eo2DRCTy3bLbhXp5a0oMsbe6mMFng@mail.gmail.com>
References: <CAHnA5RWr+cHaUeWaAUOG6eo2DRCTy3bLbhXp5a0oMsbe6mMFng@mail.gmail.com>
Message-ID: <4E84752A.7090604@jrc.ec.europa.eu>

Sandeep Patil wrote:
> This Question is specifically about the cross validation package developed
> by Paul Hiemstra.
> 
> I am unable to install it on R version 2.12 running on a Linux machine , has
> anyone tried a
> 
> similar installation?


I had automap installed on a GNU/Linux machine (Ubuntu 10.X, not sure 
about the version) under R 2.12.X, without any problem.

Now, in a Red Hat Enterprise Linux 5 machine I have automap_1.0-11 
installed for R 2.13.1 also without any trouble, as you can see in the 
following lines extracted from my sessionInfo():


$ sessionInfo()
R version 2.13.1 (2011-07-08)
Platform: i386-redhat-linux-gnu (32-bit)


other attached packages:
[1] automap_1.0-11  gstat_1.0-4     spacetime_0.5-5 xts_0.8-2
[5] zoo_1.7-4       sp_0.9-88

loaded via a namespace (and not attached):
[1] grid_2.13.1     lattice_0.19-33

As Barry mentioned, could put more information about your problem ?


> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

Mauricio

-- 
=======================================================
FLOODS Action
Land Management and Natural Hazards Unit
Institute for Environment and Sustainability (IES)
European Commission, Joint Research Centre (JRC)
webinfo    : http://floods.jrc.ec.europa.eu/
=======================================================
DISCLAIMER:\ "The views expressed are purely those of th...{{dropped:11}}


From sandeep.coepcivil at gmail.com  Thu Sep 29 16:02:04 2011
From: sandeep.coepcivil at gmail.com (Sandeep Patil)
Date: Thu, 29 Sep 2011 09:02:04 -0500
Subject: [R-sig-Geo] AUTOMAP Installation
In-Reply-To: <4E84752A.7090604@jrc.ec.europa.eu>
References: <CAHnA5RWr+cHaUeWaAUOG6eo2DRCTy3bLbhXp5a0oMsbe6mMFng@mail.gmail.com>
	<4E84752A.7090604@jrc.ec.europa.eu>
Message-ID: <CAHnA5RU7LHOmXjpZWEmvzTFF9PVsZvmJUvRQFGodHoREiYPMNg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110929/315ed8b5/attachment.pl>

From lucie at geodagroup.com  Thu Sep 29 16:49:16 2011
From: lucie at geodagroup.com (Lucie Anselin)
Date: Thu, 29 Sep 2011 07:49:16 -0700
Subject: [R-sig-Geo] Spatial Analysis Short Course by Luc Anselin Dec 5-7,
	2011
Message-ID: <CALk6o7N+RUYHMj=HvdsXHwp3bzeFecZzGGYcgbgS-R0Bz+vdBQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110929/060e0924/attachment.pl>

From Jennifer.Crees at ioz.ac.uk  Thu Sep 29 19:30:28 2011
From: Jennifer.Crees at ioz.ac.uk (Jennifer Crees)
Date: Thu, 29 Sep 2011 18:30:28 +0100
Subject: [R-sig-Geo] Boundaries for kernel density estimation
Message-ID: <41E1ED29E5E8E34BBDD8B82CFA1A9D040BEB033F@ZSL26.zsl.org>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110929/8055c486/attachment.pl>

From jgrn at illinois.edu  Thu Sep 29 20:50:10 2011
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Thu, 29 Sep 2011 11:50:10 -0700
Subject: [R-sig-Geo] Flow accumulation in R?
In-Reply-To: <alpine.LNX.2.00.1109290600230.16851@salmo.appl-ecosys.com>
References: <CABG0rftYBqw6_mdiYMJzM61JOqjz4N87vaswfMg9V4qqiNi3aw@mail.gmail.com>
	<alpine.LNX.2.00.1109290600230.16851@salmo.appl-ecosys.com>
Message-ID: <CABG0rfs1mUUH-nOo1-S0osFdxc134XGTpHOhCNuW3a5+XXyY2w@mail.gmail.com>

Thanks for the responses -- one of the issues with the GRASS
implementation of terraflow is that there is not, to my knowledge,
parallel support for the code -- the C++ version, I suppose, we can
try to compile, although it seems to be fairly out of date.  I figured
with the quickly increasing capabilities in spatial programming beyond
just spatial statistics in R (e.g. via raster, rgdal, maptools), as
well as other people developing parallel interfaces for R (e.g.
snowfall, Rmpi), R may do well as a scalable system for doing large
scale image processing/GIS analyses.  Certainly, other programs have
not scaled well (ArcMap and GRASS to name a few).

topidx looked interesting but I can tell that it won't scale -- it
requires the image be in memory as a matrix, so any reasonably large
DEM won't work.

Sounds like this may require some programming!

--j



On Thu, Sep 29, 2011 at 6:02 AM, Rich Shepard <rshepard at appl-ecosys.com> wrote:
> On Wed, 28 Sep 2011, Jonathan Greenberg wrote:
>
>> I was wondering if anyone had implemented flow accumulation in R (e.g.
>> http://www.cs.duke.edu/geo*/terraflow/)?
>
> Jon,
>
> ?I use r.terraflow (and other hydrological modules) within GRASS
> <http://grass.osgeo.org/>. Terrain and hydrologic modeling is best done, in
> my opinion, in GRASS and leave the spatial statistics to R. There is an
> interface between the two that allows us users to take advantage of both.
>
> Rich
>
> --
> Richard B. Shepard, Ph.D. ? ? ? ? ?| ? Integrity - Credibility - Innovation
> Applied Ecosystem Services, Inc. ? | ? ?Helping Ensure Our Clients' Futures
> <http://www.appl-ecosys.com> ? ? Voice: 503-667-4517 ? ? ?Fax: 503-667-8863
>



-- 
Jonathan A. Greenberg, PhD
Assistant Professor
Department of Geography
University of Illinois at Urbana-Champaign
607 South Mathews Avenue, MC 150
Urbana, IL 61801
Phone: 415-763-5476
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
http://www.geog.illinois.edu/people/JonathanGreenberg.html


From juantomas.sayago at gmail.com  Thu Sep 29 21:00:40 2011
From: juantomas.sayago at gmail.com (Juan Tomas Sayago)
Date: Thu, 29 Sep 2011 15:00:40 -0400
Subject: [R-sig-Geo] Street distance
Message-ID: <CAEOXpNCXuOzmV__RPeKUVJeqjO9gWE_0szzfOKVYDk+Auk+iYQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110929/6d2640b3/attachment.pl>

From juantomas.sayago at gmail.com  Thu Sep 29 21:00:40 2011
From: juantomas.sayago at gmail.com (Juan Tomas Sayago)
Date: Thu, 29 Sep 2011 15:00:40 -0400
Subject: [R-sig-Geo] Street distance
Message-ID: <CAEOXpNCXuOzmV__RPeKUVJeqjO9gWE_0szzfOKVYDk+Auk+iYQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110929/6d2640b3/attachment-0001.pl>

From jeremy.raw at dot.gov  Thu Sep 29 21:09:22 2011
From: jeremy.raw at dot.gov (jeremy.raw at dot.gov)
Date: Thu, 29 Sep 2011 15:09:22 -0400
Subject: [R-sig-Geo] Street distance
In-Reply-To: <CAEOXpNCXuOzmV__RPeKUVJeqjO9gWE_0szzfOKVYDk+Auk+iYQ@mail.gmail.com>
References: <CAEOXpNCXuOzmV__RPeKUVJeqjO9gWE_0szzfOKVYDk+Auk+iYQ@mail.gmail.com>
Message-ID: <B3C9A56C0E6FBF48A7D3ED79E9A7A9C0053924C2@OSTMAIL03VS3.ad.dot.gov>

There is a thread in the R-Sig-Geo list archive under the subject "Highway distance matrix" dating to July and August 2011 that discusses a variety of R-related tools to compute those distances.

Jeremy Raw, P.E.
FHWA Office of Planning
jeremy.raw at dot.gov
(202) 366-0986


-----Original Message-----
From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Juan Tomas Sayago
Sent: Thursday, September 29, 2011 3:01 PM
To: r-sig-geo at stat.math.ethz.ch; r-sig-geo at r-project.org
Subject: [R-sig-Geo] Street distance

Hi all,
I want to calculate street distance between cities, I have the points shapefile, and the street shapefile, anyone know of some application to do it.
Thanks
Juan

--
Juan Tom?s Sayago G?mez
Graduate Research Assistant
West Virginia University
886 Chestnut Ridge Road, Room 520
P.O. Box 6825
Morgantown, WV 26506-6825

	[[alternative HTML version deleted]]


From jeremy.raw at dot.gov  Thu Sep 29 21:09:22 2011
From: jeremy.raw at dot.gov (jeremy.raw at dot.gov)
Date: Thu, 29 Sep 2011 15:09:22 -0400
Subject: [R-sig-Geo] Street distance
In-Reply-To: <CAEOXpNCXuOzmV__RPeKUVJeqjO9gWE_0szzfOKVYDk+Auk+iYQ@mail.gmail.com>
References: <CAEOXpNCXuOzmV__RPeKUVJeqjO9gWE_0szzfOKVYDk+Auk+iYQ@mail.gmail.com>
Message-ID: <B3C9A56C0E6FBF48A7D3ED79E9A7A9C0053924C2@OSTMAIL03VS3.ad.dot.gov>

There is a thread in the R-Sig-Geo list archive under the subject "Highway distance matrix" dating to July and August 2011 that discusses a variety of R-related tools to compute those distances.

Jeremy Raw, P.E.
FHWA Office of Planning
jeremy.raw at dot.gov
(202) 366-0986


-----Original Message-----
From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Juan Tomas Sayago
Sent: Thursday, September 29, 2011 3:01 PM
To: r-sig-geo at stat.math.ethz.ch; r-sig-geo at r-project.org
Subject: [R-sig-Geo] Street distance

Hi all,
I want to calculate street distance between cities, I have the points shapefile, and the street shapefile, anyone know of some application to do it.
Thanks
Juan

--
Juan Tom?s Sayago G?mez
Graduate Research Assistant
West Virginia University
886 Chestnut Ridge Road, Room 520
P.O. Box 6825
Morgantown, WV 26506-6825

	[[alternative HTML version deleted]]


From sas0025 at auburn.edu  Thu Sep 29 22:33:21 2011
From: sas0025 at auburn.edu (Stephen Sefick)
Date: Thu, 29 Sep 2011 15:33:21 -0500
Subject: [R-sig-Geo] Flow accumulation in R?
In-Reply-To: <CABG0rfs1mUUH-nOo1-S0osFdxc134XGTpHOhCNuW3a5+XXyY2w@mail.gmail.com>
References: <CABG0rftYBqw6_mdiYMJzM61JOqjz4N87vaswfMg9V4qqiNi3aw@mail.gmail.com>
	<alpine.LNX.2.00.1109290600230.16851@salmo.appl-ecosys.com>
	<CABG0rfs1mUUH-nOo1-S0osFdxc134XGTpHOhCNuW3a5+XXyY2w@mail.gmail.com>
Message-ID: <4E84D611.9090902@auburn.edu>

I would be very interested in your work of getting flow accumulation 
working in R.  I might be able to help (with my limited skills).

Stephen

On Thu 29 Sep 2011 01:50:10 PM CDT, Jonathan Greenberg wrote:
> Thanks for the responses -- one of the issues with the GRASS
> implementation of terraflow is that there is not, to my knowledge,
> parallel support for the code -- the C++ version, I suppose, we can
> try to compile, although it seems to be fairly out of date.  I figured
> with the quickly increasing capabilities in spatial programming beyond
> just spatial statistics in R (e.g. via raster, rgdal, maptools), as
> well as other people developing parallel interfaces for R (e.g.
> snowfall, Rmpi), R may do well as a scalable system for doing large
> scale image processing/GIS analyses.  Certainly, other programs have
> not scaled well (ArcMap and GRASS to name a few).
>
> topidx looked interesting but I can tell that it won't scale -- it
> requires the image be in memory as a matrix, so any reasonably large
> DEM won't work.
>
> Sounds like this may require some programming!
>
> --j
>
>
>
> On Thu, Sep 29, 2011 at 6:02 AM, Rich Shepard<rshepard at appl-ecosys.com>  wrote:
>> On Wed, 28 Sep 2011, Jonathan Greenberg wrote:
>>
>>> I was wondering if anyone had implemented flow accumulation in R (e.g.
>>> http://www.cs.duke.edu/geo*/terraflow/)?
>>
>> Jon,
>>
>>   I use r.terraflow (and other hydrological modules) within GRASS
>> <http://grass.osgeo.org/>. Terrain and hydrologic modeling is best done, in
>> my opinion, in GRASS and leave the spatial statistics to R. There is an
>> interface between the two that allows us users to take advantage of both.
>>
>> Rich
>>
>> --
>> Richard B. Shepard, Ph.D.          |   Integrity - Credibility - Innovation
>> Applied Ecosystem Services, Inc.   |    Helping Ensure Our Clients' Futures
>> <http://www.appl-ecosys.com>       Voice: 503-667-4517      Fax: 503-667-8863
>>
>
>
>


From r.turner at auckland.ac.nz  Thu Sep 29 22:44:39 2011
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Fri, 30 Sep 2011 09:44:39 +1300
Subject: [R-sig-Geo] Boundaries for kernel density estimation
In-Reply-To: <41E1ED29E5E8E34BBDD8B82CFA1A9D040BEB033F@ZSL26.zsl.org>
References: <41E1ED29E5E8E34BBDD8B82CFA1A9D040BEB033F@ZSL26.zsl.org>
Message-ID: <4E84D8B7.9050404@auckland.ac.nz>

On 30/09/11 06:30, Jennifer Crees wrote:
> Hi,
>
>
>
> I am carrying out kernel estimation on some species point data. However,
> the data are on a continental scale (many of the points hug the southern
> coastline of Europe) so that the analysis is including marine areas when
> the window is constructed around the point themselves. Is it possible to
> specify a boundary so that only the sampled terrestrial area will be
> included? Or perhaps it would be easier to look at local intensity?

If your boundary were all coastal, you could get what you want by
setting edge=FALSE in your call to density() --- I *think*!!!

However if some parts of your window boundary are coastline and
some parts are not, it looks tricky to me.  One idea might be to do
one intensity estimate with edge=FALSE, another with edge=TRUE,
and then somehow do a weighted average of the two with weights
determined by distance from coastline.  Points near the coastline
would get a high weight assigned to the edge=FALSE estimate and
a low weight to the edge=TRUE estimate.  And vice-versa.

Won't be too easy to implement, and it might be a load of dingos'
kidneys anyway --- it's just an idea off the top of my head.

I've cc-ed this message to Adrian Baddeley who may have a more
sound suggestion.  Here's hoping.

     cheers,

         Rolf Turner


From mdsumner at gmail.com  Fri Sep 30 01:17:53 2011
From: mdsumner at gmail.com (Michael Sumner)
Date: Fri, 30 Sep 2011 09:17:53 +1000
Subject: [R-sig-Geo] Boundaries for kernel density estimation
In-Reply-To: <4E84D8B7.9050404@auckland.ac.nz>
References: <41E1ED29E5E8E34BBDD8B82CFA1A9D040BEB033F@ZSL26.zsl.org>
	<4E84D8B7.9050404@auckland.ac.nz>
Message-ID: <CAAcGz98xbJ7MkP3fHupw-=Hnm4OODBvs19-_C8+X5KM3VYsKzw@mail.gmail.com>

The soap-film smoothing of Simon Wood might be of interest:

http://www.maths.bath.ac.uk/~sw283/simon/papers/soap.pdf

I thought this was in the package mgcv, but I cannot find it. I'm sure
it is available as an R package somewhere.

Cheers, Mike.


On Fri, Sep 30, 2011 at 6:44 AM, Rolf Turner <r.turner at auckland.ac.nz> wrote:
> On 30/09/11 06:30, Jennifer Crees wrote:
>>
>> Hi,
>>
>>
>>
>> I am carrying out kernel estimation on some species point data. However,
>> the data are on a continental scale (many of the points hug the southern
>> coastline of Europe) so that the analysis is including marine areas when
>> the window is constructed around the point themselves. Is it possible to
>> specify a boundary so that only the sampled terrestrial area will be
>> included? Or perhaps it would be easier to look at local intensity?
>
> If your boundary were all coastal, you could get what you want by
> setting edge=FALSE in your call to density() --- I *think*!!!
>
> However if some parts of your window boundary are coastline and
> some parts are not, it looks tricky to me. ?One idea might be to do
> one intensity estimate with edge=FALSE, another with edge=TRUE,
> and then somehow do a weighted average of the two with weights
> determined by distance from coastline. ?Points near the coastline
> would get a high weight assigned to the edge=FALSE estimate and
> a low weight to the edge=TRUE estimate. ?And vice-versa.
>
> Won't be too easy to implement, and it might be a load of dingos'
> kidneys anyway --- it's just an idea off the top of my head.
>
> I've cc-ed this message to Adrian Baddeley who may have a more
> sound suggestion. ?Here's hoping.
>
> ? ?cheers,
>
> ? ? ? ?Rolf Turner
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Michael Sumner
Institute for Marine and Antarctic Studies, University of Tasmania
Hobart, Australia
e-mail: mdsumner at gmail.com


From mdsumner at gmail.com  Fri Sep 30 01:19:57 2011
From: mdsumner at gmail.com (Michael Sumner)
Date: Fri, 30 Sep 2011 09:19:57 +1000
Subject: [R-sig-Geo] Boundaries for kernel density estimation
In-Reply-To: <CAAcGz98xbJ7MkP3fHupw-=Hnm4OODBvs19-_C8+X5KM3VYsKzw@mail.gmail.com>
References: <41E1ED29E5E8E34BBDD8B82CFA1A9D040BEB033F@ZSL26.zsl.org>
	<4E84D8B7.9050404@auckland.ac.nz>
	<CAAcGz98xbJ7MkP3fHupw-=Hnm4OODBvs19-_C8+X5KM3VYsKzw@mail.gmail.com>
Message-ID: <CAAcGz9-Vy6VqrbJEBNdsmWuYjd48U4Zr3qoiLsDUWqnRTcweEw@mail.gmail.com>

Here is the soap package:

http://www.maths.bath.ac.uk/~sw283/simon/software.html



On Fri, Sep 30, 2011 at 9:17 AM, Michael Sumner <mdsumner at gmail.com> wrote:
> The soap-film smoothing of Simon Wood might be of interest:
>
> http://www.maths.bath.ac.uk/~sw283/simon/papers/soap.pdf
>
> I thought this was in the package mgcv, but I cannot find it. I'm sure
> it is available as an R package somewhere.
>
> Cheers, Mike.
>
>
> On Fri, Sep 30, 2011 at 6:44 AM, Rolf Turner <r.turner at auckland.ac.nz> wrote:
>> On 30/09/11 06:30, Jennifer Crees wrote:
>>>
>>> Hi,
>>>
>>>
>>>
>>> I am carrying out kernel estimation on some species point data. However,
>>> the data are on a continental scale (many of the points hug the southern
>>> coastline of Europe) so that the analysis is including marine areas when
>>> the window is constructed around the point themselves. Is it possible to
>>> specify a boundary so that only the sampled terrestrial area will be
>>> included? Or perhaps it would be easier to look at local intensity?
>>
>> If your boundary were all coastal, you could get what you want by
>> setting edge=FALSE in your call to density() --- I *think*!!!
>>
>> However if some parts of your window boundary are coastline and
>> some parts are not, it looks tricky to me. ?One idea might be to do
>> one intensity estimate with edge=FALSE, another with edge=TRUE,
>> and then somehow do a weighted average of the two with weights
>> determined by distance from coastline. ?Points near the coastline
>> would get a high weight assigned to the edge=FALSE estimate and
>> a low weight to the edge=TRUE estimate. ?And vice-versa.
>>
>> Won't be too easy to implement, and it might be a load of dingos'
>> kidneys anyway --- it's just an idea off the top of my head.
>>
>> I've cc-ed this message to Adrian Baddeley who may have a more
>> sound suggestion. ?Here's hoping.
>>
>> ? ?cheers,
>>
>> ? ? ? ?Rolf Turner
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
>
> --
> Michael Sumner
> Institute for Marine and Antarctic Studies, University of Tasmania
> Hobart, Australia
> e-mail: mdsumner at gmail.com
>



-- 
Michael Sumner
Institute for Marine and Antarctic Studies, University of Tasmania
Hobart, Australia
e-mail: mdsumner at gmail.com


From francesco.pirotti at unipd.it  Fri Sep 30 09:17:25 2011
From: francesco.pirotti at unipd.it (francesco.pirotti at unipd.it)
Date: Fri, 30 Sep 2011 09:17:25 +0200
Subject: [R-sig-Geo] Flow accumulation in R?
In-Reply-To: <4E84D611.9090902@auburn.edu>
References: <CABG0rftYBqw6_mdiYMJzM61JOqjz4N87vaswfMg9V4qqiNi3aw@mail.gmail.com>
	<alpine.LNX.2.00.1109290600230.16851@salmo.appl-ecosys.com>
	<CABG0rfs1mUUH-nOo1-S0osFdxc134XGTpHOhCNuW3a5+XXyY2w@mail.gmail.com>
	<4E84D611.9090902@auburn.edu>
Message-ID: <078767300136049b82684002143445f8.squirrel@webmail.unipd.it>

>From my experience, GRASS also has another module which does a very good
job (at least from my limited experience) at calculating flow accumulation
for each cell: r.watershed. Some time ago I successfully adapted the GRASS
code to my own c++ code; I used GDAL raster library to read a raster DTM
and used the r.watershed code to run the accumulation analysis on the
matrix with height values.
Cheers,
Francesco Pirotti
CIRGEO - University of Padova - Italy

> I would be very interested in your work of getting flow accumulation
> working in R.  I might be able to help (with my limited skills).
>
> Stephen
>
> On Thu 29 Sep 2011 01:50:10 PM CDT, Jonathan Greenberg wrote:
>> Thanks for the responses -- one of the issues with the GRASS
>> implementation of terraflow is that there is not, to my knowledge,
>> parallel support for the code -- the C++ version, I suppose, we can
>> try to compile, although it seems to be fairly out of date.  I figured
>> with the quickly increasing capabilities in spatial programming beyond
>> just spatial statistics in R (e.g. via raster, rgdal, maptools), as
>> well as other people developing parallel interfaces for R (e.g.
>> snowfall, Rmpi), R may do well as a scalable system for doing large
>> scale image processing/GIS analyses.  Certainly, other programs have
>> not scaled well (ArcMap and GRASS to name a few).
>>
>> topidx looked interesting but I can tell that it won't scale -- it
>> requires the image be in memory as a matrix, so any reasonably large
>> DEM won't work.
>>
>> Sounds like this may require some programming!
>>
>> --j
>>
>>
>>
>> On Thu, Sep 29, 2011 at 6:02 AM, Rich Shepard<rshepard at appl-ecosys.com>
>> wrote:
>>> On Wed, 28 Sep 2011, Jonathan Greenberg wrote:
>>>
>>>> I was wondering if anyone had implemented flow accumulation in R (e.g.
>>>> http://www.cs.duke.edu/geo*/terraflow/)?
>>>
>>> Jon,
>>>
>>>   I use r.terraflow (and other hydrological modules) within GRASS
>>> <http://grass.osgeo.org/>. Terrain and hydrologic modeling is best
>>> done, in
>>> my opinion, in GRASS and leave the spatial statistics to R. There is an
>>> interface between the two that allows us users to take advantage of
>>> both.
>>>
>>> Rich
>>>
>>> --
>>> Richard B. Shepard, Ph.D.          |   Integrity - Credibility -
>>> Innovation
>>> Applied Ecosystem Services, Inc.   |    Helping Ensure Our Clients'
>>> Futures
>>> <http://www.appl-ecosys.com>       Voice: 503-667-4517      Fax:
>>> 503-667-8863
>>>
>>
>>
>>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


From mathieu.rajerison at gmail.com  Fri Sep 30 10:10:35 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Fri, 30 Sep 2011 10:10:35 +0200
Subject: [R-sig-Geo] Flow accumulation in R?
In-Reply-To: <078767300136049b82684002143445f8.squirrel@webmail.unipd.it>
References: <CABG0rftYBqw6_mdiYMJzM61JOqjz4N87vaswfMg9V4qqiNi3aw@mail.gmail.com>
	<alpine.LNX.2.00.1109290600230.16851@salmo.appl-ecosys.com>
	<CABG0rfs1mUUH-nOo1-S0osFdxc134XGTpHOhCNuW3a5+XXyY2w@mail.gmail.com>
	<4E84D611.9090902@auburn.edu>
	<078767300136049b82684002143445f8.squirrel@webmail.unipd.it>
Message-ID: <CAGfc75nmeRrkTTaimJgp5oS4Zdrmwcv25=7TkSvxfuN3ab2BRw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110930/6c449d1a/attachment.pl>

From sylvain.maillard at gmail.com  Fri Sep 30 10:15:31 2011
From: sylvain.maillard at gmail.com (Sylvain Maillard)
Date: Fri, 30 Sep 2011 10:15:31 +0200
Subject: [R-sig-Geo] Flow accumulation in R?
In-Reply-To: <CABG0rfs1mUUH-nOo1-S0osFdxc134XGTpHOhCNuW3a5+XXyY2w@mail.gmail.com>
References: <CABG0rftYBqw6_mdiYMJzM61JOqjz4N87vaswfMg9V4qqiNi3aw@mail.gmail.com>
	<alpine.LNX.2.00.1109290600230.16851@salmo.appl-ecosys.com>
	<CABG0rfs1mUUH-nOo1-S0osFdxc134XGTpHOhCNuW3a5+XXyY2w@mail.gmail.com>
Message-ID: <CADjEob23t0eKQfPbGMWNwZ+=oroXHqpu8Lbz+Pt9KCxjrfwsPw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110930/1968380e/attachment.pl>

From r.m.krug at gmail.com  Fri Sep 30 10:18:15 2011
From: r.m.krug at gmail.com (Rainer M Krug)
Date: Fri, 30 Sep 2011 10:18:15 +0200
Subject: [R-sig-Geo] Flow accumulation in R?
In-Reply-To: <CABG0rfs1mUUH-nOo1-S0osFdxc134XGTpHOhCNuW3a5+XXyY2w@mail.gmail.com>
References: <CABG0rftYBqw6_mdiYMJzM61JOqjz4N87vaswfMg9V4qqiNi3aw@mail.gmail.com>
	<alpine.LNX.2.00.1109290600230.16851@salmo.appl-ecosys.com>
	<CABG0rfs1mUUH-nOo1-S0osFdxc134XGTpHOhCNuW3a5+XXyY2w@mail.gmail.com>
Message-ID: <CAGhLh6H1AvwKn_-LcPjm0Mp0AzLZTnFd+tJzOLr6JWshdPe8qg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110930/94a46002/attachment.pl>

From mathieu.rajerison at gmail.com  Fri Sep 30 11:21:24 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Fri, 30 Sep 2011 11:21:24 +0200
Subject: [R-sig-Geo] Ideas on qualifying urban shapes: linear / circular /
	star
Message-ID: <CAGfc75=eKJL1TSKbeRwWA4Wqe8myjwEJP4G7P=pH8oRTo+xPeQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110930/80340245/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Fri Sep 30 13:06:36 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Fri, 30 Sep 2011 12:06:36 +0100
Subject: [R-sig-Geo] Ideas on qualifying urban shapes: linear / circular
	/ star
In-Reply-To: <CAGfc75=eKJL1TSKbeRwWA4Wqe8myjwEJP4G7P=pH8oRTo+xPeQ@mail.gmail.com>
References: <CAGfc75=eKJL1TSKbeRwWA4Wqe8myjwEJP4G7P=pH8oRTo+xPeQ@mail.gmail.com>
Message-ID: <CANVKczPuxi3Q5hWC55rKPC_7b4vh22rZUqWQKaZJQEOcXXULYA@mail.gmail.com>

On Fri, Sep 30, 2011 at 10:21 AM, Mathieu Rajerison
<mathieu.rajerison at gmail.com> wrote:
> Hello list,
>
>
> I have determined major urban areas.
>
> This is just a post to get ideas from R-users on how to qualify urban
> shapes.
>
> The data can either be binary raster (urban/ not urban), either vector.
>
> 1) Some urban areas follow linear infrastructures, thus are linear
> 2) Some other diverge equally from a central heart, and are circular.
> 3) Some are a mix and are like stars.
>
> The idea would be to get an index that give for each area, the probability
> of belonging to each of these three classes. Like a 3-column data frame
>
> I wondered if packages already existed, or statistical methods for this
> purpose. Notably, I think that topographic derivatives derived from
> smoothed/unsmoothed binary data like aspect, could be used to qualify these
> shapes (?)
>
> Thanks for any idea or exchange on the subject!

 Sounds like shape analysis or morphometrics. There's package:shape
that might help. Sometimes these techniques depend on landmarks though
(like the locations of eyes, noses, and ears on faces) and probably
won't be any use on vector or raster datasets.

http://en.wikipedia.org/wiki/Morphometrics

Barry


From sarah.goslee at gmail.com  Fri Sep 30 13:22:36 2011
From: sarah.goslee at gmail.com (Sarah Goslee)
Date: Fri, 30 Sep 2011 07:22:36 -0400
Subject: [R-sig-Geo] Ideas on qualifying urban shapes: linear / circular
	/ star
In-Reply-To: <CAGfc75=eKJL1TSKbeRwWA4Wqe8myjwEJP4G7P=pH8oRTo+xPeQ@mail.gmail.com>
References: <CAGfc75=eKJL1TSKbeRwWA4Wqe8myjwEJP4G7P=pH8oRTo+xPeQ@mail.gmail.com>
Message-ID: <CAM_vjumF_YVa0ZRzRMO-e5gZ7PAyBV1j6_C1yUEi6zhWN8MtTw@mail.gmail.com>

Hi,

On Fri, Sep 30, 2011 at 5:21 AM, Mathieu Rajerison
<mathieu.rajerison at gmail.com> wrote:
> Hello list,
>
>
> I have determined major urban areas.
>
> This is just a post to get ideas from R-users on how to qualify urban
> shapes.
>
> The data can either be binary raster (urban/ not urban), either vector.
>
> 1) Some urban areas follow linear infrastructures, thus are linear
> 2) Some other diverge equally from a central heart, and are circular.
> 3) Some are a mix and are like stars.

That sounds like the kind of task that patch metrics such as perimeter/area
ratio and fractal dimension were created for. Take a look at the copious
Fragstats literature. I don't know if any have been implemented in R, but
wouldn't be surprised.

Sarah

> The idea would be to get an index that give for each area, the probability
> of belonging to each of these three classes. Like a 3-column data frame
>
> I wondered if packages already existed, or statistical methods for this
> purpose. Notably, I think that topographic derivatives derived from
> smoothed/unsmoothed binary data like aspect, could be used to qualify these
> shapes (?)
>
> Thanks for any idea or exchange on the subject!
>


-- 
Sarah Goslee
http://www.functionaldiversity.org


From rshepard at appl-ecosys.com  Fri Sep 30 14:33:47 2011
From: rshepard at appl-ecosys.com (Rich Shepard)
Date: Fri, 30 Sep 2011 05:33:47 -0700
Subject: [R-sig-Geo] Flow accumulation in R?
In-Reply-To: <CAGhLh6H1AvwKn_-LcPjm0Mp0AzLZTnFd+tJzOLr6JWshdPe8qg@mail.gmail.com>
References: <CABG0rftYBqw6_mdiYMJzM61JOqjz4N87vaswfMg9V4qqiNi3aw@mail.gmail.com>
	<alpine.LNX.2.00.1109290600230.16851@salmo.appl-ecosys.com>
	<CABG0rfs1mUUH-nOo1-S0osFdxc134XGTpHOhCNuW3a5+XXyY2w@mail.gmail.com>
	<CAGhLh6H1AvwKn_-LcPjm0Mp0AzLZTnFd+tJzOLr6JWshdPe8qg@mail.gmail.com>
Message-ID: <alpine.LNX.2.00.1109300531300.7431@salmo.appl-ecosys.com>

On Fri, 30 Sep 2011, Rainer M Krug wrote:

> If you would like to process large maps, I would definitely go the GRASS
> route, and adopt the C code, so that it utilises multiple cores.

   The GRASS modules are being modified to work with openmp to allow parallel
processing when appropriate. I don't recall which modules currently take
advantage of the library (I run 6.5svn), but I always configure the builds
'--with-openmp'.

Rich


From mathieu.rajerison at gmail.com  Fri Sep 30 15:24:12 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Fri, 30 Sep 2011 15:24:12 +0200
Subject: [R-sig-Geo] Ideas on qualifying urban shapes: linear / circular
	/ star
In-Reply-To: <CAM_vjumF_YVa0ZRzRMO-e5gZ7PAyBV1j6_C1yUEi6zhWN8MtTw@mail.gmail.com>
References: <CAGfc75=eKJL1TSKbeRwWA4Wqe8myjwEJP4G7P=pH8oRTo+xPeQ@mail.gmail.com>
	<CAM_vjumF_YVa0ZRzRMO-e5gZ7PAyBV1j6_C1yUEi6zhWN8MtTw@mail.gmail.com>
Message-ID: <CAGfc75nO_NemUkJv+GnnNHstn11CoBAbGbXb17SyBTeub72VLQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110930/1c5b763a/attachment.pl>

From anupam.anand at gmail.com  Fri Sep 30 17:25:53 2011
From: anupam.anand at gmail.com (geoquest)
Date: Fri, 30 Sep 2011 08:25:53 -0700 (PDT)
Subject: [R-sig-Geo] spgwr with snow and spgwr_multiR
Message-ID: <1317396353583-6848217.post@n2.nabble.com>

I am looking for spgwr integration with snow. I have come across some
literature where Prof Bivand's implementation has been mentioned but haven't
seen the script.
Also can someone please tell me where can i find the package spgwr_multiR.
thanks

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/spgwr-with-snow-and-spgwr-multiR-tp6848217p6848217.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From sarah.goslee at gmail.com  Fri Sep 30 18:28:11 2011
From: sarah.goslee at gmail.com (Sarah Goslee)
Date: Fri, 30 Sep 2011 12:28:11 -0400
Subject: [R-sig-Geo] Ideas on qualifying urban shapes: linear / circular
	/ star
In-Reply-To: <CAGfc75nO_NemUkJv+GnnNHstn11CoBAbGbXb17SyBTeub72VLQ@mail.gmail.com>
References: <CAGfc75=eKJL1TSKbeRwWA4Wqe8myjwEJP4G7P=pH8oRTo+xPeQ@mail.gmail.com>
	<CAM_vjumF_YVa0ZRzRMO-e5gZ7PAyBV1j6_C1yUEi6zhWN8MtTw@mail.gmail.com>
	<CAGfc75nO_NemUkJv+GnnNHstn11CoBAbGbXb17SyBTeub72VLQ@mail.gmail.com>
Message-ID: <CAM_vjunxrxcpKkooB-bziu2zROK20LGAxtD9bXumxO_OvRnR4g@mail.gmail.com>

Mathieu,

On Fri, Sep 30, 2011 at 9:24 AM, Mathieu Rajerison
<mathieu.rajerison at gmail.com> wrote:
> Hi,
>
>
> Maybe you're right: perimeter/ratio could be sufficient...
>
> Fractal dimension and lacunarity are good indicators for urban areas. Do you
> know any R package, tool to quantify these?

I've always just used Fragstats, as I already suggested, but you might look into
SDMtools:
http://cran.r-project.org/web/packages/SDMTools/
http://mo-seph.com/node/302

Sarah

> I have found an ImageJ plugin called Fraclac.
>
> There is another one called r.lacunarity included in spatialtools
> http://www.clusterville.org/spatialtools/index.html
> r.lacunarity is interesting compared to ImageJ::Fraclac because it uses a
> moving window and generates a raster.
>
> I launched a post about lacunarity and fractal dimension on R but didn't
> have any answer.
>
>
> So, if anyone manages to use r.lacunarity or knows other tools than Fraclac,
> I'd be happy!
>
>
> For those interested , here is some literature on fractal dimension applied
> to analysis or aerial images or cities:
> http://www.public.asu.edu/~smyint/publications/CEUS-Lacunarity-Myint-Lam.pdf
> http://cybergeo.revues.org/8902
> http://www.isprs.org/proceedings/XXXVII/congress/3b_pdf/80.pdf
> http://www.fatih.edu.tr/~mcadams/geo352/fractal.pdf
>
>
> 2011/9/30 Sarah Goslee <sarah.goslee at gmail.com>
>>
>> Hi,
>>
>> On Fri, Sep 30, 2011 at 5:21 AM, Mathieu Rajerison
>> <mathieu.rajerison at gmail.com> wrote:
>> > Hello list,
>> >
>> >
>> > I have determined major urban areas.
>> >
>> > This is just a post to get ideas from R-users on how to qualify urban
>> > shapes.
>> >
>> > The data can either be binary raster (urban/ not urban), either vector.
>> >
>> > 1) Some urban areas follow linear infrastructures, thus are linear
>> > 2) Some other diverge equally from a central heart, and are circular.
>> > 3) Some are a mix and are like stars.
>>
>> That sounds like the kind of task that patch metrics such as
>> perimeter/area
>> ratio and fractal dimension were created for. Take a look at the copious
>> Fragstats literature. I don't know if any have been implemented in R, but
>> wouldn't be surprised.
>>
>> Sarah
>>
>> > The idea would be to get an index that give for each area, the
>> > probability
>> > of belonging to each of these three classes. Like a 3-column data frame
>> >
>> > I wondered if packages already existed, or statistical methods for this
>> > purpose. Notably, I think that topographic derivatives derived from
>> > smoothed/unsmoothed binary data like aspect, could be used to qualify
>> > these
>> > shapes (?)
>> >
>> > Thanks for any idea or exchange on the subject!
>> >
>>
>>

-- 
Sarah Goslee
http://www.functionaldiversity.org


From eboyd3 at tigers.lsu.edu  Fri Sep 30 18:41:57 2011
From: eboyd3 at tigers.lsu.edu (Ezra Boyd)
Date: Fri, 30 Sep 2011 11:41:57 -0500
Subject: [R-sig-Geo] Working with GRIB2 files
Message-ID: <CAPo57m-9sxOZHFP_cA2zh4rZuD15B5oX7zr8grWi6e+5ej-_7w@mail.gmail.com>

Hello,

I am trying to use the Real Time Ocean Forecasting System
(http://polar.ncep.noaa.gov/ofs/download.shtml?) archival data which
is in the GRIB2 format using a hybrid model-based coordinate system.
The data can be downloaded from here:
http://data.nodc.noaa.gov/opendap/ncep/rtofs/contents.html

Has anyone had any experience using GRIB2 in R?  If so, please let me
know how it worked out.  In particular, I need to get forecast data
into a format where I can overlay a shapefile, but the wqgrib2 program
won't work because hybrid coordinate system.

Thanks,
Ezra


From landis at isciences.com  Fri Sep 30 19:21:33 2011
From: landis at isciences.com (Matthew Landis)
Date: Fri, 30 Sep 2011 13:21:33 -0400
Subject: [R-sig-Geo] Working with GRIB2 files
In-Reply-To: <CAPo57m-9sxOZHFP_cA2zh4rZuD15B5oX7zr8grWi6e+5ej-_7w@mail.gmail.com>
References: <CAPo57m-9sxOZHFP_cA2zh4rZuD15B5oX7zr8grWi6e+5ej-_7w@mail.gmail.com>
Message-ID: <4E85FA9D.2000802@isciences.com>

Ezra,

I've been messing around with GRIB2 myself, but as of July,  I hadn't 
had any luck finding ways to do it in R.  I ended up using NCL (NCAR 
command language) to convert the Grib2's to NetCDF, which various R 
packages can handle (notably raster).  I did figure out how to pass 
arguments from R to the NCL script (through Bash), which was a major 
achievement for me.   This only works on Linux though, as I haven't 
worked it out for the Cygwin version of NCL.

I would *love* to hear about ways of dealing with GRIB2 natively in R.  
Barring that, I'm happy to share NCL code.

Matt

On 9/30/2011 12:41 PM, Ezra Boyd wrote:
> Hello,
>
> I am trying to use the Real Time Ocean Forecasting System
> (http://polar.ncep.noaa.gov/ofs/download.shtml?) archival data which
> is in the GRIB2 format using a hybrid model-based coordinate system.
> The data can be downloaded from here:
> http://data.nodc.noaa.gov/opendap/ncep/rtofs/contents.html
>
> Has anyone had any experience using GRIB2 in R?  If so, please let me
> know how it worked out.  In particular, I need to get forecast data
> into a format where I can overlay a shapefile, but the wqgrib2 program
> won't work because hybrid coordinate system.
>
> Thanks,
> Ezra

-- 
~~~~~~~~~~~~~~~~~~~~~~~~~~
Matthew Landis, Ph.D.
Research Scientist
ISciences, LLC
61 Main St. Suite 200
Burlington VT 05401
802.864.2999
~~~~~~~~~~~~~~~~~~~~~~~~~~


From Roger.Bivand at nhh.no  Fri Sep 30 20:11:56 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 30 Sep 2011 20:11:56 +0200 (CEST)
Subject: [R-sig-Geo] spgwr with snow and spgwr_multiR
In-Reply-To: <1317396353583-6848217.post@n2.nabble.com>
References: <1317396353583-6848217.post@n2.nabble.com>
Message-ID: <alpine.LRH.2.00.1109302007250.30281@reclus.nhh.no>

On Fri, 30 Sep 2011, geoquest wrote:

> I am looking for spgwr integration with snow. I have come across some
> literature where Prof Bivand's implementation has been mentioned but haven't
> seen the script.

?gwr

and see the details of the cl= argument, which should be a snow cluster, 
noting the conditions.

Roger

> Also can someone please tell me where can i find the package spgwr_multiR.
> thanks
>

PS. Contact the authors of the paper refering to spgwr_multiR for access 
if available.


> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/spgwr-with-snow-and-spgwr-multiR-tp6848217p6848217.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


