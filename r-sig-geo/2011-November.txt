From HodgessE at uhd.edu  Tue Nov  1 07:33:08 2011
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Tue, 1 Nov 2011 01:33:08 -0500
Subject: [R-sig-Geo] R equivalent of join between two data frames
Message-ID: <586A4828D7AAA04CA9B258C50A28DA200BF5896F@BALI.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111101/c53e22de/attachment.pl>

From dan.putler at sauder.ubc.ca  Tue Nov  1 07:59:56 2011
From: dan.putler at sauder.ubc.ca (Dan Putler)
Date: Mon, 31 Oct 2011 23:59:56 -0700
Subject: [R-sig-Geo] R equivalent of join between two data frames
In-Reply-To: <586A4828D7AAA04CA9B258C50A28DA200BF5896F@BALI.uhd.campus>
References: <586A4828D7AAA04CA9B258C50A28DA200BF5896F@BALI.uhd.campus>
Message-ID: <4EAF98EC.9060104@sauder.ubc.ca>

Hi Erin,

Is the "merge" function appropriate? If you are joining a non-spatial 
data frame to a spatial data frame object (e.g., a 
SpatialPointsDataFrame) it should work.

Dan

On 10/31/2011 11:33 PM, Hodgess, Erin wrote:
> Dear R Sig Geo People:
>
> Is there an equivalent of "join" from ArcGIS 10 in R, please?
>
> I've been experimenting with "match" but the results between the two are not the same.
>
> thanks,
> Sincerely,
> Erin
>
>
> Erin M. Hodgess, PhD
> Associate Professor
> Department of Computer and Mathematical Sciences
> University of Houston - Downtown
> mailto: hodgesse at uhd.edu
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From HodgessE at uhd.edu  Tue Nov  1 08:03:15 2011
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Tue, 1 Nov 2011 02:03:15 -0500
Subject: [R-sig-Geo] R equivalent of join between two data frames
References: <586A4828D7AAA04CA9B258C50A28DA200BF5896F@BALI.uhd.campus>
	<4EAF98EC.9060104@sauder.ubc.ca>
Message-ID: <586A4828D7AAA04CA9B258C50A28DA200BF58970@BALI.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111101/057bf5f9/attachment.pl>

From fmarkham at gmail.com  Tue Nov  1 08:09:38 2011
From: fmarkham at gmail.com (Francis Markham)
Date: Tue, 1 Nov 2011 18:09:38 +1100
Subject: [R-sig-Geo] R equivalent of join between two data frames
In-Reply-To: <586A4828D7AAA04CA9B258C50A28DA200BF58970@BALI.uhd.campus>
References: <586A4828D7AAA04CA9B258C50A28DA200BF5896F@BALI.uhd.campus>
	<4EAF98EC.9060104@sauder.ubc.ca>
	<586A4828D7AAA04CA9B258C50A28DA200BF58970@BALI.uhd.campus>
Message-ID: <CACsciEh5JSnKbKEz8=gaQiEVbFeZHNokKzR=JAHfGQ3PUJGoWw@mail.gmail.com>

Erin,

I believe you can. See the help for merge, in particular the all.x and
all.y parameters.

Cheers,

F. Markham

On 1 November 2011 18:03, Hodgess, Erin <HodgessE at uhd.edu> wrote:
> Hi!
>
> I'd like to remove the non-matching rows, if possible. ?I don't think you can do that with merge.
>
> Thanks,
> Erin
>
>
> Erin M. Hodgess, PhD
> Associate Professor
> Department of Computer and Mathematical Sciences
> University of Houston - Downtown
> mailto: hodgesse at uhd.edu
>
>
>
> -----Original Message-----
> From: r-sig-geo-bounces at r-project.org on behalf of Dan Putler
> Sent: Tue 11/1/2011 1:59 AM
> To: r-sig-geo at r-project.org
> Subject: Re: [R-sig-Geo] R equivalent of join between two data frames
>
> Hi Erin,
>
> Is the "merge" function appropriate? If you are joining a non-spatial
> data frame to a spatial data frame object (e.g., a
> SpatialPointsDataFrame) it should work.
>
> Dan
>
> On 10/31/2011 11:33 PM, Hodgess, Erin wrote:
>> Dear R Sig Geo People:
>>
>> Is there an equivalent of "join" from ArcGIS 10 in R, please?
>>
>> I've been experimenting with "match" but the results between the two are not the same.
>>
>> thanks,
>> Sincerely,
>> Erin
>>
>>
>> Erin M. Hodgess, PhD
>> Associate Professor
>> Department of Computer and Mathematical Sciences
>> University of Houston - Downtown
>> mailto: hodgesse at uhd.edu
>>
>>
>> ? ? ? [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From HodgessE at uhd.edu  Tue Nov  1 08:13:17 2011
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Tue, 1 Nov 2011 02:13:17 -0500
Subject: [R-sig-Geo] R equivalent of join between two data frames
References: <586A4828D7AAA04CA9B258C50A28DA200BF5896F@BALI.uhd.campus>
	<4EAF98EC.9060104@sauder.ubc.ca>
	<586A4828D7AAA04CA9B258C50A28DA200BF58970@BALI.uhd.campus>
	<CACsciEh5JSnKbKEz8=gaQiEVbFeZHNokKzR=JAHfGQ3PUJGoWw@mail.gmail.com>
Message-ID: <586A4828D7AAA04CA9B258C50A28DA200BF58971@BALI.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111101/4cb6a5d6/attachment.pl>

From senator at ecotoxicology.de  Tue Nov  1 12:13:39 2011
From: senator at ecotoxicology.de (=?iso-8859-1?Q?Ralf_Sch=E4fer?=)
Date: Tue, 1 Nov 2011 12:13:39 +0100
Subject: [R-sig-Geo] R equivalent of join between two data frames
Message-ID: <8C2A5B22-9B4F-4F69-AA44-02C83B681FB7@ecotoxicology.de>

Hi Erin,

as pointed out you can query a left inner join with all.x=T and a right inner join with all.y=T, incomparable is probaly to distinguish an inner and outer join, though I have not found the specifications in the merge functions.

Apart from that you can use SQL statements in R directly - here is a nice example:
http://gettinggeneticsdone.blogspot.com/2010/05/use-sql-queries-to-manipulate-data.html

Best regards
Ralf

------------------------------------------------------------

Prof. Dr. rer. nat. Ralf Bernhard Sch?fer
Juniorprofessor for Quantitative Landscape Ecology
Environmental Scientist (M.Sc.)
Institute for Environmental Sciences
University Koblenz-Landau
Fortstrasse 7
76829 Landau
Germany
Mail: schaefer-ralf at uni-landau.de
Phone: ++49 (0) 6341 280-31536
Web: http://tinyurl.com/6dnpxna


From alobolistas at gmail.com  Tue Nov  1 13:38:11 2011
From: alobolistas at gmail.com (Agustin Lobo)
Date: Tue, 1 Nov 2011 13:38:11 +0100
Subject: [R-sig-Geo] R equivalent of join between two data frames
In-Reply-To: <8C2A5B22-9B4F-4F69-AA44-02C83B681FB7@ecotoxicology.de>
References: <8C2A5B22-9B4F-4F69-AA44-02C83B681FB7@ecotoxicology.de>
Message-ID: <CAG4NReLNNE=SJO7oGSiGCOjxsfre+NxOfNg4YHqrxJwsajJw5Q@mail.gmail.com>

I have had problems using merge() for a similar purpose (see [1])
and I use this function to join a data frame to an existing Spatial
Polygons or Points Data frame.
Extending this to 2 SPDF should be easy:
I wish these type of commands existed in official sp

"mijoin" <- function(SPDF1,tabla,by.x,by.y)
{
#Joins tabla to the dataframe of SPDF1
#beeing SPDF1 an Spatial Points (or Polygons) Data Frame
tabladata = SPDF1 at data
x = tabladata[[by.x]]
y = tabla[[by.y]]
tabla2 <- tabla[match(x, y),]
tabladata3 = cbind(tabladata,tabla2)
row.names(tabladata3)=row.names(SPDF1 at data)
SPDF2 = SPDF1
SPDF2 at data = tabladata3
SPDF2
}

Agus

[1] The problem I found using merge()
(files can be downloaded from [2] and [3])

require(rgdal)
require(foreign)
fireLC =
readOGR(dsn="/media/Iomega_HDD/JACO/ExFireBorneo",layer="WFA_Borneo_1997_1998_LC",stringsAsFactors=F)
plot(fireLC)
str(fireLC,max.level=2)
fireLCdata = fireLC at data
fireLCdata[1:10,]
names(fireLCdata)[1]="LC"

legendLC =
read.csv("/media/Iomega_HDD/JACOB/ExFireBorneo/ExFireBorneoDATA/legend_SEA2007LC.txt",header=T,sep=",")
legendLC

Now a merging with merge()

x = merge(fireLCdata,legendLC,by.x="LC",by.y="LC",sort=F,all.x=T)

but note that despite sort=F the ordering has changed:
x[1:10,]
fireLCdata[1:10,]

fixing the ordering:
x = x[order(x$ID),]
x[1:10,]
fireLC at data = fireLCdata

If the ordering had not been fixed, the spatial links in fireLC would
have been changed and fireLC at data = fireLCdata would be wrong

[2] https://sites.google.com/site/filestemp2/home/fireLC.rda
[3] https://sites.google.com/site/filestemp2/home/legendLC.rda

2011/11/1 Ralf Sch?fer <senator at ecotoxicology.de>:
> Hi Erin,
>
> as pointed out you can query a left inner join with all.x=T and a right inner join with all.y=T, incomparable is probaly to distinguish an inner and outer join, though I have not found the specifications in the merge functions.
>
> Apart from that you can use SQL statements in R directly - here is a nice example:
> http://gettinggeneticsdone.blogspot.com/2010/05/use-sql-queries-to-manipulate-data.html
>
> Best regards
> Ralf
>
> ------------------------------------------------------------
>
> Prof. Dr. rer. nat. Ralf Bernhard Sch?fer
> Juniorprofessor for Quantitative Landscape Ecology
> Environmental Scientist (M.Sc.)
> Institute for Environmental Sciences
> University Koblenz-Landau
> Fortstrasse 7
> 76829 Landau
> Germany
> Mail: schaefer-ralf at uni-landau.de
> Phone: ++49 (0) 6341 280-31536
> Web: http://tinyurl.com/6dnpxna
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From s.meyer at lmu.de  Tue Nov  1 14:00:45 2011
From: s.meyer at lmu.de (Swen Meyer)
Date: Tue, 01 Nov 2011 14:00:45 +0100
Subject: [R-sig-Geo] Impoting multiple asci grids into R? Working now!
In-Reply-To: <CANtt_hzOruo0W78c3GN30OhorqrppiKFtOqhFK0XF389o8GbRA@mail.gmail.com>
References: <1319721239.98231.YahooMailClassic@web161421.mail.bf1.yahoo.com>
	<4EA974DF.7070607@lmu.de> <4EAAA4F2.70806@aol.com>
	<4EAD252F.9020202@spatial-analyst.net>
	<CANtt_hzV4z4OuqAWTfiy56fcBcMGSopM6k=ON5sP2DdO5MxjSA@mail.gmail.com>
	<4EAE633D.3030408@uni-muenster.de> <4EAE7DCB.4040900@lmu.de>
	<4EAEC67C.9090606@lmu.de>
	<CANtt_hwGb_o1CKHUedSvLJ5SqFjqZ52rasC5vZX0YeWhm8NdTQ@mail.gmail.com>
	<CANtt_hzOruo0W78c3GN30OhorqrppiKFtOqhFK0XF389o8GbRA@mail.gmail.com>
Message-ID: <4EAFED7D.9000900@lmu.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111101/ad906582/attachment.pl>

From juantomas.sayago at gmail.com  Tue Nov  1 14:47:18 2011
From: juantomas.sayago at gmail.com (Juan Tomas Sayago)
Date: Tue, 1 Nov 2011 09:47:18 -0400
Subject: [R-sig-Geo] R equivalent of join between two data frames
In-Reply-To: <586A4828D7AAA04CA9B258C50A28DA200BF5896F@BALI.uhd.campus>
References: <586A4828D7AAA04CA9B258C50A28DA200BF5896F@BALI.uhd.campus>
Message-ID: <CAEOXpNDKR9QMAAgKdpNVQnjHuTidpHWfa+GEm1thL9dmX4GfAg@mail.gmail.com>

Dear Erin I use this one that I found on raymond florax's website for
spatial econometrics.
It works great with points as well as with polygons.
PS: I will attach the R file if you need I can send you the files he used
to you on another email.
Hope it helps you
Juan Tom?s
# import your shapefile using readShapePoly
shape <- readShapePoly("columbus.shp",IDvar="POLYID")

# read-in the table containing the data the you want to add to your
shapefile
  # make sure that the table contains a column with a unique identifier
corresponding to IDvar
tab <- read.table("join_example.txt",header=TRUE)

# creates a vector of all polygon IDs
  #note that it is the "character" version of POLYID (in this example)
shpID <- sapply(slot(shape,"polygons"),function(x) slot(x,"ID"))

# make the ID variable from the data table into class "character"
tabID <- as.character(tab$ID)

# match the two unique identifiers
  # match() needs both its arguments to be of the same class. Here:
"character"

  #### if you want to keep all polygons
    tab <- tab[match(shpID,tabID),]
      # matches both IDs and replaces nomatch values by NA
    rownames(tab) <- shpID
    shape.mod <- spCbind(shape,tab)

  #### if you want to delete polygons with no matching data in the table
    #tab <- tab[shpID%in%tabID,]
    #shape.mod <- shape.mod[shpID%in%tabID,]
      # matches and removes the non-matching locations from the table and
the original shapefile
    #shape.mod <- spCbind(shape.mod,tab)



On Tue, Nov 1, 2011 at 2:33 AM, Hodgess, Erin <HodgessE at uhd.edu> wrote:

> Dear R Sig Geo People:
>
> Is there an equivalent of "join" from ArcGIS 10 in R, please?
>
> I've been experimenting with "match" but the results between the two are
> not the same.
>
> thanks,
> Sincerely,
> Erin
>
>
> Erin M. Hodgess, PhD
> Associate Professor
> Department of Computer and Mathematical Sciences
> University of Houston - Downtown
> mailto: hodgesse at uhd.edu
>
>
>        [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Juan Tom?s Sayago G?mez
Graduate Research Assistant
West Virginia University
886 Chestnut Ridge Road, Room 520
P.O. Box 6825
Morgantown, WV 26506-6825
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111101/f87c005d/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: add_data.r
Type: application/octet-stream
Size: 2937 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111101/f87c005d/attachment.obj>

From niamir at gmail.com  Tue Nov  1 16:36:52 2011
From: niamir at gmail.com (Aidin Niamir)
Date: Tue, 1 Nov 2011 16:36:52 +0100
Subject: [R-sig-Geo] problem with raster calculation
Message-ID: <CAC+VNxqWyBcZGLGDr5K6MHV9xymE4HaO9SPPvDypfN35w8tMEA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111101/badaebfa/attachment.pl>

From niamir at gmail.com  Tue Nov  1 16:40:16 2011
From: niamir at gmail.com (Aidin Niamir)
Date: Tue, 1 Nov 2011 16:40:16 +0100
Subject: [R-sig-Geo] Problem with raster calculation
Message-ID: <CAC+VNxrROj_mwdZSmgZUXKhVte5DkuDNP8j3a0fnHQKO2S9FYQ@mail.gmail.com>

Dear all

I am experiencing a strange problem when calculating in the raster package.
Let me explain it with a simple example;

> a <- c(1,1,1,0,0,0,2,2,2)
> a <- matrix(a,3,3,byrow=T)
> a <- raster(a)
> a []
[1] 1 1 1 0 0 0 2 2 2
> b <- 10 - a
> b []
[1] ?-9 ?-9 ?-9 -10 -10 -10 ?-8 ?-8 ?-8

As you can see, the obtained values are not correct. I cannot see why
this should be.
Can anybody help?

Aidin Niamir


From lau.chikit11 at gmail.com  Tue Nov  1 16:59:15 2011
From: lau.chikit11 at gmail.com (Chi Kit Lau)
Date: Tue, 1 Nov 2011 15:59:15 +0000
Subject: [R-sig-Geo] map resolution
Message-ID: <CANh8j9cCENMurMtPDOPacz4ihQWEhWU0N9kLBYzVdx4DmWSofQ@mail.gmail.com>

Dear list,

sorry for the beginner's question. How do I work out the maximum
achievable resolution when rasterizing a vector map on a scale
1:10000? In other words what is the resolution of a map with a scale
1:10000?

thank you,

Chi Kit


From roman.lustrik at gmail.com  Tue Nov  1 16:59:29 2011
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Tue, 1 Nov 2011 16:59:29 +0100
Subject: [R-sig-Geo] Problem with raster calculation
In-Reply-To: <CAC+VNxrROj_mwdZSmgZUXKhVte5DkuDNP8j3a0fnHQKO2S9FYQ@mail.gmail.com>
References: <CAC+VNxrROj_mwdZSmgZUXKhVte5DkuDNP8j3a0fnHQKO2S9FYQ@mail.gmail.com>
Message-ID: <CAHT1vphDp=pqONa0TW9YqiYUoeCUH+X+2abu+5XRnHBL+TDUKw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111101/964199cf/attachment.pl>

From chris at csfowler.com  Tue Nov  1 17:39:45 2011
From: chris at csfowler.com (Chris Fowler)
Date: Tue, 1 Nov 2011 09:39:45 -0700
Subject: [R-sig-Geo] US Census 2000 and 2010
Message-ID: <CAFK3DV88pSXgrJV9gjqwp3ak0u3Kvtw2ZX3Y1ndieexGc-bEDg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111101/af092b31/attachment.pl>

From christian.oberst at gmail.com  Tue Nov  1 19:38:26 2011
From: christian.oberst at gmail.com (Christian A.Oberst)
Date: Tue, 1 Nov 2011 18:38:26 +0000
Subject: [R-sig-Geo] heteroskedasticity corrections for lagsarlm() in
	spdep
References: <4EA15369.1030605@geog.uni-heidelberg.de>
	<alpine.LRH.2.00.1110211727460.11393@reclus.nhh.no>
	<4EA1A445.2040107@geog.uni-heidelberg.de>
	<alpine.LRH.2.00.1110212204330.12215@reclus.nhh.no>
Message-ID: <loom.20111101T192723-385@post.gmane.org>

I tested the procedure from Marco and it worked fine under the recent spdep 
update (05-40). 

But are there any heteroskedastic corrections for the other spatial models 
(Spatial lag, SAC or Spatial Durbin) estimated with ML-estimations (lagsarlm, 
errorsarlm, sacsarlm)? I know that there is the sphet package (use sphet_1.1-0), 
but in this are as far as I see only GMM procedures included.

I am grateful for any suggestions

---
Christian A. Oberst
Doctoral Student
Vit?ria, ES
Brazil


From aortizbobea at arec.umd.edu  Wed Nov  2 00:46:19 2011
From: aortizbobea at arec.umd.edu (Ariel Ortiz-Bobea)
Date: Tue, 1 Nov 2011 16:46:19 -0700 (PDT)
Subject: [R-sig-Geo] How to quickly add many raster layers to a thick
	RasterStack?
Message-ID: <1320191179382-6953662.post@n2.nabble.com>

Hello everyone,

I have about 90,000 individual grid files in GRIB format I'm importing and
converting to raster format in R.

Some of the calculations I need to do (clipping with polygons... thanks
Robert J. Hijmans for valuable advice on this!) are best performed on many
raster layers at once, e.g. over a RasterStack.

I have tried "stack()" and "addLayer()" commands. "stack" seems to read all
objects in the command line slowing the process down more than
proportionately to object size (see code below) which I suppose explains how
"addLayer" came about. However, the time it takes "addLayer" to add an
additional layer is roughly proportional to the size of the RasterStack it
is being added to... so when I have very "thick" stacks/bricks adding an
extra layer takes some time.

Would there be an alternative way to combine many multi-band raster layers
more quickly (in R or outside of R) from many individual files and still
manage to keep things orderly, i.e. being able to identify specific layers
afterwards?

Any thoughts would be greatly appreciated.

Ariel

#---------------
# setup
	library(raster) 
	r <- raster(ncol=139, nrow=97) 
	r[] <- 1:ncell(r)
		
	# stack command
	s1<-r
	t1<- c()
	while (nlayers(s1)<=200) {
		print(nlayers(s1))
		timer1 <- system.time( {	
			s1 <- stack(s1,r) 
			})
			t1 <- rbind(t1,timer1[3] )
		}
	
	# addLayer command
	s2<-r
	t2<- c()
	while (nlayers(s2)<=200) {
		print(nlayers(s2))
		timer2 <- system.time( {	
			s2 <- addLayer(s2,r) 
			})
			t2 <- rbind(t2,timer2[3] )
		}
		
	# visualize
	plot(1:200,t1, type="l", xlab="# of layers in object", ylab="time for
adding extra layer (s)")
	lines(1:200,t2,col="blue")
	
	plot(1:200,t2, type="l", col="blue", xlab="# of layers in object",
ylab="time for adding extra layer (s)")
	


-----
Ariel Ortiz-Bobea
PhD Candidate in Agricultural & Resource Economics
University of Maryland - College Park
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/How-to-quickly-add-many-raster-layers-to-a-thick-RasterStack-tp6953662p6953662.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From virgilio.gomez at uclm.es  Wed Nov  2 13:01:29 2011
From: virgilio.gomez at uclm.es (Virgilio =?ISO-8859-1?Q?G=F3mez-Rubio?=)
Date: Wed, 02 Nov 2011 13:01:29 +0100
Subject: [R-sig-Geo] US Census 2000 and 2010
In-Reply-To: <CAFK3DV88pSXgrJV9gjqwp3ak0u3Kvtw2ZX3Y1ndieexGc-bEDg@mail.gmail.com>
References: <CAFK3DV88pSXgrJV9gjqwp3ak0u3Kvtw2ZX3Y1ndieexGc-bEDg@mail.gmail.com>
Message-ID: <1320235289.3059.9.camel@virgil-HP-Compaq-8000-Elite-USDT-PC>

Dear Chris,

> that includes all the data, but what I would really like are some pointers
> to scripts that will get just the data I need straight from the Census and
> read it in so I can use it. I am interested in both the SF3 variables and
> the Tiger/Line files.

In addition to all the documentation in the USCensus2000 packages, you
may find this talk by Zack Alquemist at useR!2010 interesting:

http://www.r-project.org/conferences/useR-2010/slides/Almquist.pdf


The whole suite of USCensus packages is discussed therein and he points
to some future directions. I'd say that these packages could be a
starting point to develop code to get the data from the 2011 Census...

> 2)Has anyone worked with aligning census geographies at a fine scale (e.g.
> matching 2000 Census blocks to 2010 block groups). Obviously there is a lot
> of change at a fine scale and I was wondering if anyone had worked with the
> Census Crosswalks to try and bash out a workable set of spatial units for
> cross census comparison?

I do not think that this a simple issue with a simple answer... If you
have misaligned regions you will have to make a decision about how you
aggregate/split. There is a discussion about this in the book by
Banerjee et al. (on hierarchical modelling and analysis for spatial
data).

> These are both big jobs and will likely be the focus of my work for some
> time, but if anyone has some pointers at the outset, I would love to not
> reinvent the wheel.

You may want to look at the literature on small area estimation. Look
for the paper Muggly et al (2000, "Fully Model-Based Approaches for
Spatially Misalign") and then you can look for posterior papers that
cite that paper.

Hope this helps,

Virgilio


From lists at remoteinformation.com.au  Wed Nov  2 15:08:22 2011
From: lists at remoteinformation.com.au (Ben Madin)
Date: Wed, 2 Nov 2011 22:08:22 +0800
Subject: [R-sig-Geo] map resolution
In-Reply-To: <CANh8j9cCENMurMtPDOPacz4ihQWEhWU0N9kLBYzVdx4DmWSofQ@mail.gmail.com>
References: <CANh8j9cCENMurMtPDOPacz4ihQWEhWU0N9kLBYzVdx4DmWSofQ@mail.gmail.com>
Message-ID: <3D291A74-5DA3-497C-AF57-DED571353467@remoteinformation.com.au>

Mate,

"Resolution - the degree of detail visible in a photographic or television image."

I think you need to have a quick google of "resolution", and also look up DPI. Resolution is a decision you have to make depending on the  type of analysis and/or output you are chasing, and the degree of precision you want. 

The only answer I can think of to your current question is that resolution is not necessarily related to scale.

hope that helps a little bit.

Ben



On 01/11/2011, at 11:59 PM, Chi Kit Lau wrote:

> Dear list,
> 
> sorry for the beginner's question. How do I work out the maximum
> achievable resolution when rasterizing a vector map on a scale
> 1:10000? In other words what is the resolution of a map with a scale
> 1:10000?
> 
> thank you,
> 
> Chi Kit
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From naimi at itc.nl  Wed Nov  2 16:50:27 2011
From: naimi at itc.nl (Babak Naimi)
Date: Wed, 2 Nov 2011 16:50:27 +0100
Subject: [R-sig-Geo] problem with raster calculation
In-Reply-To: <mailman.11.1320231604.17676.r-sig-geo@r-project.org>
References: <mailman.11.1320231604.17676.r-sig-geo@r-project.org>
Message-ID: <021F462EDC7F2B42A7038E9F9D47826121181FC4B8@itcnt27.itc.nl>

Dear Aidin,

I tested your example with the latest version of raster package on R 2.12.2 (windows), got the same problem! But on R 2.13.0 (linux), and R 2.13.2 and 2.14 (windows), it works fine!

Best regards,
Babak


-----Original Message-----
Date: Tue, 1 Nov 2011 16:36:52 +0100
From: Aidin Niamir <niamir at gmail.com>
To: r-sig-geo at r-project.org
Subject: [R-sig-Geo] problem with raster calculation
Message-ID:
	<CAC+VNxqWyBcZGLGDr5K6MHV9xymE4HaO9SPPvDypfN35w8tMEA at mail.gmail.com>
Content-Type: text/plain

Dear all

I am experiencing a strange problem when calculating in the raster package.
Let me explain it with a simple expample;

> a <- c(1,1,1,0,0,0,2,2,2)
> a <- matrix(a,3,3,byrow=T)
> a <- raster(a)
> a []
[1] 1 1 1 0 0 0 2 2 2
> b <- 10 - a
> b []
[1]  -9  -9  -9 -10 -10 -10  -8  -8  -8

As you can see, the obtained values are not correct. I cannot see why this
should be.
Can anybody help?

Aidin

	[[alternative HTML version deleted]]


From srabin at princeton.edu  Wed Nov  2 17:12:04 2011
From: srabin at princeton.edu (Sam Rabin)
Date: Wed, 2 Nov 2011 12:12:04 -0400
Subject: [R-sig-Geo] Shapes rearranged upon write
Message-ID: <FEA6ED39-C660-4198-A4A1-F6ED4C84BAC6@princeton.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111102/6a99333a/attachment.pl>

From lyndon.estes at gmail.com  Wed Nov  2 17:27:39 2011
From: lyndon.estes at gmail.com (Lyndon Estes)
Date: Wed, 2 Nov 2011 12:27:39 -0400
Subject: [R-sig-Geo] Shapes rearranged upon write
In-Reply-To: <FEA6ED39-C660-4198-A4A1-F6ED4C84BAC6@princeton.edu>
References: <FEA6ED39-C660-4198-A4A1-F6ED4C84BAC6@princeton.edu>
Message-ID: <CALuVVaaG4wyjWGtK-uQvrb-SiTNzrixzKpDXAekqzYeo07SXoA@mail.gmail.com>

Hi Sam,

I wrote the following function a while ago to account for this problem
of dataframe row reordering relative to the polygon IDs:

joinAttributeTable <- function(x, y, xcol, ycol) {
# Merges data frame to SpatialPolygonsDataFrame, keeping the correct
order. Code from suggestions at:
# https://stat.ethz.ch/pipermail/r-sig-geo/2008-January/003064.html
# Args:
#   x: SpatialPolygonsDataFrame
#   y: Name of data.frame to merge
#   xcol: Merge column name
#   ycol: Merge column name
# Returns: Shapefile with merged attribute table

  x$sort_id <- 1:nrow(as(x, "data.frame"))  # Column containing
original row order for later sorting
	
  x.dat <- as(x, "data.frame")  # Create new data.frame object
  x.dat2 <- merge(x.dat, y, by.x = xcol, by.y = ycol)  # Merge
  x.dat2.ord <- x.dat2[order(x.dat2$sort_id), ]  # Reorder back to original
	x2 <- x[x$sort_id %in% x.dat2$sort_id, ]  # Make new set of polygons,
dropping those which aren't in merge
  x2.dat <- as(x2, "data.frame")  # Make updated x2 into a data.frame
	row.names(x.dat2.ord) <- row.names(x2.dat)  # Reassign row.names from
original data.frame
  x2 at data <- x.dat2.ord  # Assign to shapefile the new data.frame
  return(x2)
}

I haven't used this in a while, so I hope it still works.  I think
others could suggest a more efficient, existing method for dealing
with this as well.

Cheers, Lyndon


On Wed, Nov 2, 2011 at 12:12 PM, Sam Rabin <srabin at princeton.edu> wrote:
> Hello!
>
> I have a shapefile (.shp) containing the Landsat grid coverage of South America. I also have 97 other shapefiles, each of which covers one of the Landsat grid cells (the 97 being a subset of the cells in the first shapefile). I managed to get R (via maptools) to perform a calculation on each of the 97 and put the results in a data frame. Among other things, this data frame contains a column for grid cell ID that matches up with a column in the Landsat grid shapefile. I used merge() to combine these and then saved a new shapefile, following the instructions at http://help.nceas.ucsb.edu/R:_Spatial#Append_a_second_set_of_attributes_to_a_spatial_data_file.27s_attribute_table. Here is the code I used:
>
> ? ? ? ?require(maptools)
> ? ? ? ?landsat1 = readShapePoly("landsat_grid")
> ? ? ? ? ?# Make a backup
> ? ? ? ? ?landsat_orig = landsat1
> ? ? ? ?landsat_2_spdf = merge(landsat1 at data,newcalc,by.x="PR",by.y="pr2",all.x=TRUE,sort=FALSE)
> ? ? ? ?landsat1 at data = landsat_2_spdf
> ? ? ? ?writeSpatialShape(landsat1, "methodA")
>
> Looking at the new data with
>
> ? ? ? ?View(landsat1 at data),
>
> it seemed like everything went great. The ID's matched up perfectly, and I checked some of the calculated figures and they matched, too. The polygons from landsat_grid.shp that were not included in the 97 were assigned NA for the column with the calculated figures, appropriately.
>
> Unfortunately, when I imported the new shapefile to my GIS program, all the tiles were rearranged. screenshot_expectedcoverage (http://tinyurl.com/3nbm3q7 ) shows fine-scale data for what I was expecting (Amazonia; imagine a polygon drawn around all the data there), and screenshot_methodA (http://tinyurl.com/3htvlga) shows what I got. (Only the 97 polygons are shown.)
>
> I tried changing sort to TRUE in the fourth line (and the output shapefile name to "methodB"), but the tiles are still messed up, just differently ? see screenshot_methodB (http://tinyurl.com/3h95vr3).
>
> In both shape files, the attribute tables look fine, but the tiles are just totally rearranged. They're not all scattered over the world, either. In screenshot_rearrangement (which shows all tiles, not just the 97) (http://tinyurl.com/6xfabvm), you can see that they cover South America perfectly ? they all line up with the polygons from landsat_grid.shp (not shown).
>
> What do I need to do to fix this?
>
> Thanks very much in advance.
>
>
>
> Sam Rabin
> ? ? Graduate student
> ? ? ? ? Princeton University
> ? ? ? ? Ecology & Evolutionary Biology
>
>
>
>
>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


From srabin at Princeton.EDU  Wed Nov  2 19:08:23 2011
From: srabin at Princeton.EDU (Sam Rabin)
Date: Wed, 2 Nov 2011 14:08:23 -0400
Subject: [R-sig-Geo] Shapes rearranged upon write
In-Reply-To: <CALuVVaaG4wyjWGtK-uQvrb-SiTNzrixzKpDXAekqzYeo07SXoA@mail.gmail.com>
References: <FEA6ED39-C660-4198-A4A1-F6ED4C84BAC6@princeton.edu>
	<CALuVVaaG4wyjWGtK-uQvrb-SiTNzrixzKpDXAekqzYeo07SXoA@mail.gmail.com>
Message-ID: <67E1EE0C-CAFC-450B-B969-C186B7019991@Princeton.EDU>

Lyndon ? 

I couldn't figure out how to get x2 out of the function and into my workspace so I could save it as a shapefile. I instead converted your code into a script to run it, and it works like a charm. Thanks very much!

	Sam



On Nov 2, 2011, at 12:27 PM, Lyndon Estes wrote:

> Hi Sam,
> 
> I wrote the following function a while ago to account for this problem
> of dataframe row reordering relative to the polygon IDs:
> 
> joinAttributeTable <- function(x, y, xcol, ycol) {
> # Merges data frame to SpatialPolygonsDataFrame, keeping the correct
> order. Code from suggestions at:
> # https://stat.ethz.ch/pipermail/r-sig-geo/2008-January/003064.html
> # Args:
> #   x: SpatialPolygonsDataFrame
> #   y: Name of data.frame to merge
> #   xcol: Merge column name
> #   ycol: Merge column name
> # Returns: Shapefile with merged attribute table
> 
>  x$sort_id <- 1:nrow(as(x, "data.frame"))  # Column containing
> original row order for later sorting
> 	
>  x.dat <- as(x, "data.frame")  # Create new data.frame object
>  x.dat2 <- merge(x.dat, y, by.x = xcol, by.y = ycol)  # Merge
>  x.dat2.ord <- x.dat2[order(x.dat2$sort_id), ]  # Reorder back to original
> 	x2 <- x[x$sort_id %in% x.dat2$sort_id, ]  # Make new set of polygons,
> dropping those which aren't in merge
>  x2.dat <- as(x2, "data.frame")  # Make updated x2 into a data.frame
> 	row.names(x.dat2.ord) <- row.names(x2.dat)  # Reassign row.names from
> original data.frame
>  x2 at data <- x.dat2.ord  # Assign to shapefile the new data.frame
>  return(x2)
> }
> 
> I haven't used this in a while, so I hope it still works.  I think
> others could suggest a more efficient, existing method for dealing
> with this as well.
> 
> Cheers, Lyndon
> 
> 
> On Wed, Nov 2, 2011 at 12:12 PM, Sam Rabin <srabin at princeton.edu> wrote:
>> Hello!
>> 
>> I have a shapefile (.shp) containing the Landsat grid coverage of South America. I also have 97 other shapefiles, each of which covers one of the Landsat grid cells (the 97 being a subset of the cells in the first shapefile). I managed to get R (via maptools) to perform a calculation on each of the 97 and put the results in a data frame. Among other things, this data frame contains a column for grid cell ID that matches up with a column in the Landsat grid shapefile. I used merge() to combine these and then saved a new shapefile, following the instructions at http://help.nceas.ucsb.edu/R:_Spatial#Append_a_second_set_of_attributes_to_a_spatial_data_file.27s_attribute_table. Here is the code I used:
>> 
>>        require(maptools)
>>        landsat1 = readShapePoly("landsat_grid")
>>          # Make a backup
>>          landsat_orig = landsat1
>>        landsat_2_spdf = merge(landsat1 at data,newcalc,by.x="PR",by.y="pr2",all.x=TRUE,sort=FALSE)
>>        landsat1 at data = landsat_2_spdf
>>        writeSpatialShape(landsat1, "methodA")
>> 
>> Looking at the new data with
>> 
>>        View(landsat1 at data),
>> 
>> it seemed like everything went great. The ID's matched up perfectly, and I checked some of the calculated figures and they matched, too. The polygons from landsat_grid.shp that were not included in the 97 were assigned NA for the column with the calculated figures, appropriately.
>> 
>> Unfortunately, when I imported the new shapefile to my GIS program, all the tiles were rearranged. screenshot_expectedcoverage (http://tinyurl.com/3nbm3q7 ) shows fine-scale data for what I was expecting (Amazonia; imagine a polygon drawn around all the data there), and screenshot_methodA (http://tinyurl.com/3htvlga) shows what I got. (Only the 97 polygons are shown.)
>> 
>> I tried changing sort to TRUE in the fourth line (and the output shapefile name to "methodB"), but the tiles are still messed up, just differently ? see screenshot_methodB (http://tinyurl.com/3h95vr3).
>> 
>> In both shape files, the attribute tables look fine, but the tiles are just totally rearranged. They're not all scattered over the world, either. In screenshot_rearrangement (which shows all tiles, not just the 97) (http://tinyurl.com/6xfabvm), you can see that they cover South America perfectly ? they all line up with the polygons from landsat_grid.shp (not shown).
>> 
>> What do I need to do to fix this?
>> 
>> Thanks very much in advance.
>> 
>> 
>> 
>> Sam Rabin
>>     Graduate student
>>         Princeton University
>>         Ecology & Evolutionary Biology
>> 
>> 
>> 
>> 
>> 
>> 
>>        [[alternative HTML version deleted]]
>> 
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
>> 


From lyndon.estes at gmail.com  Wed Nov  2 19:57:36 2011
From: lyndon.estes at gmail.com (Lyndon Estes)
Date: Wed, 2 Nov 2011 14:57:36 -0400
Subject: [R-sig-Geo] Shapes rearranged upon write
In-Reply-To: <67E1EE0C-CAFC-450B-B969-C186B7019991@Princeton.EDU>
References: <FEA6ED39-C660-4198-A4A1-F6ED4C84BAC6@princeton.edu>
	<CALuVVaaG4wyjWGtK-uQvrb-SiTNzrixzKpDXAekqzYeo07SXoA@mail.gmail.com>
	<67E1EE0C-CAFC-450B-B969-C186B7019991@Princeton.EDU>
Message-ID: <CALuVVaY4V100+jUafPresRF=zrN3KuLc9jYDFz1H0NysZzF6iA@mail.gmail.com>

Hi Sam,

x2 should be available as whatever name you assigned to it, e.g. as
your.object in the following:

your.object <- joinAttributeTable(polyshape, dframe, xcolname, ycolname)

Anyway, glad it at least still work for the reordering issue.

Cheers, Lyndon



On Wed, Nov 2, 2011 at 2:08 PM, Sam Rabin <srabin at princeton.edu> wrote:
> Lyndon ?
>
> I couldn't figure out how to get x2 out of the function and into my workspace so I could save it as a shapefile. I instead converted your code into a script to run it, and it works like a charm. Thanks very much!
>
> ? ? ? ?Sam
>
>
>
> On Nov 2, 2011, at 12:27 PM, Lyndon Estes wrote:
>
>> Hi Sam,
>>
>> I wrote the following function a while ago to account for this problem
>> of dataframe row reordering relative to the polygon IDs:
>>
>> joinAttributeTable <- function(x, y, xcol, ycol) {
>> # Merges data frame to SpatialPolygonsDataFrame, keeping the correct
>> order. Code from suggestions at:
>> # https://stat.ethz.ch/pipermail/r-sig-geo/2008-January/003064.html
>> # Args:
>> # ? x: SpatialPolygonsDataFrame
>> # ? y: Name of data.frame to merge
>> # ? xcol: Merge column name
>> # ? ycol: Merge column name
>> # Returns: Shapefile with merged attribute table
>>
>> ?x$sort_id <- 1:nrow(as(x, "data.frame")) ?# Column containing
>> original row order for later sorting
>>
>> ?x.dat <- as(x, "data.frame") ?# Create new data.frame object
>> ?x.dat2 <- merge(x.dat, y, by.x = xcol, by.y = ycol) ?# Merge
>> ?x.dat2.ord <- x.dat2[order(x.dat2$sort_id), ] ?# Reorder back to original
>> ? ? ? x2 <- x[x$sort_id %in% x.dat2$sort_id, ] ?# Make new set of polygons,
>> dropping those which aren't in merge
>> ?x2.dat <- as(x2, "data.frame") ?# Make updated x2 into a data.frame
>> ? ? ? row.names(x.dat2.ord) <- row.names(x2.dat) ?# Reassign row.names from
>> original data.frame
>> ?x2 at data <- x.dat2.ord ?# Assign to shapefile the new data.frame
>> ?return(x2)
>> }
>>
>> I haven't used this in a while, so I hope it still works. ?I think
>> others could suggest a more efficient, existing method for dealing
>> with this as well.
>>
>> Cheers, Lyndon
>>
>>
>> On Wed, Nov 2, 2011 at 12:12 PM, Sam Rabin <srabin at princeton.edu> wrote:
>>> Hello!
>>>
>>> I have a shapefile (.shp) containing the Landsat grid coverage of South America. I also have 97 other shapefiles, each of which covers one of the Landsat grid cells (the 97 being a subset of the cells in the first shapefile). I managed to get R (via maptools) to perform a calculation on each of the 97 and put the results in a data frame. Among other things, this data frame contains a column for grid cell ID that matches up with a column in the Landsat grid shapefile. I used merge() to combine these and then saved a new shapefile, following the instructions at http://help.nceas.ucsb.edu/R:_Spatial#Append_a_second_set_of_attributes_to_a_spatial_data_file.27s_attribute_table. Here is the code I used:
>>>
>>> ? ? ? ?require(maptools)
>>> ? ? ? ?landsat1 = readShapePoly("landsat_grid")
>>> ? ? ? ? ?# Make a backup
>>> ? ? ? ? ?landsat_orig = landsat1
>>> ? ? ? ?landsat_2_spdf = merge(landsat1 at data,newcalc,by.x="PR",by.y="pr2",all.x=TRUE,sort=FALSE)
>>> ? ? ? ?landsat1 at data = landsat_2_spdf
>>> ? ? ? ?writeSpatialShape(landsat1, "methodA")
>>>
>>> Looking at the new data with
>>>
>>> ? ? ? ?View(landsat1 at data),
>>>
>>> it seemed like everything went great. The ID's matched up perfectly, and I checked some of the calculated figures and they matched, too. The polygons from landsat_grid.shp that were not included in the 97 were assigned NA for the column with the calculated figures, appropriately.
>>>
>>> Unfortunately, when I imported the new shapefile to my GIS program, all the tiles were rearranged. screenshot_expectedcoverage (http://tinyurl.com/3nbm3q7 ) shows fine-scale data for what I was expecting (Amazonia; imagine a polygon drawn around all the data there), and screenshot_methodA (http://tinyurl.com/3htvlga) shows what I got. (Only the 97 polygons are shown.)
>>>
>>> I tried changing sort to TRUE in the fourth line (and the output shapefile name to "methodB"), but the tiles are still messed up, just differently ? see screenshot_methodB (http://tinyurl.com/3h95vr3).
>>>
>>> In both shape files, the attribute tables look fine, but the tiles are just totally rearranged. They're not all scattered over the world, either. In screenshot_rearrangement (which shows all tiles, not just the 97) (http://tinyurl.com/6xfabvm), you can see that they cover South America perfectly ? they all line up with the polygons from landsat_grid.shp (not shown).
>>>
>>> What do I need to do to fix this?
>>>
>>> Thanks very much in advance.
>>>
>>>
>>>
>>> Sam Rabin
>>> ? ? Graduate student
>>> ? ? ? ? Princeton University
>>> ? ? ? ? Ecology & Evolutionary Biology
>>>
>>>
>>>
>>>
>>>
>>>
>>> ? ? ? ?[[alternative HTML version deleted]]
>>>
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>
>


From thi_veloso at yahoo.com.br  Thu Nov  3 12:28:32 2011
From: thi_veloso at yahoo.com.br (Thiago Veloso)
Date: Thu, 3 Nov 2011 04:28:32 -0700 (PDT)
Subject: [R-sig-Geo] ModisDownload
In-Reply-To: <021F462EDC7F2B42A7038E9F9D4782612118100044@itcnt27.itc.nl>
Message-ID: <1320319712.13141.YahooMailClassic@web161406.mail.bf1.yahoo.com>

  Dear Babak,

  Thank you for the tip. I have updated both my curl library and your script (including the modifications suggested by Matteo), and now everything works flawlessly. Images are downloaded automagically!

  Next, I will be testing the MRT integration.

  Best wishes,

  Thiago.

--- On Fri, 28/10/11, Babak Naimi <naimi at itc.nl> wrote:

> From: Babak Naimi <naimi at itc.nl>
> Subject: RE: [R-sig-Geo] ModisDownload
> To: "'Thiago Veloso'" <thi_veloso at yahoo.com.br>, "'r-sig-geo at r-project.org'" <r-sig-geo at r-project.org>
> Cc: "'Matteo Mattiuzzi'" <matteo.mattiuzzi at boku.ac.at>
> Date: Friday, 28 October, 2011, 22:36
> Dear Thiago,
> 
> I checked your command, and it works fine. As Steve said,
> your RCurl might be old. However, I changed that line based
> on Matteo's suggestion,? to avoid the server connection
> error, and new version is uploaded on the website.
> 
> Best wishes,
> Babak
> 
> -----Original Message-----
> From: Thiago Veloso [mailto:thi_veloso at yahoo.com.br]
> 
> Sent: Friday, October 28, 2011 2:43 PM
> To: 'r-sig-geo at r-project.org';
> Babak Naimi
> Subject: Re: [R-sig-Geo] ModisDownload
> 
> ? Dear Barak,
> 
> ? If you are also accepting suggestions about errors,
> please let me share my experience with your script. I have
> received an error which appears to be related to a argument
> of package RCurl. Below, please take a look at my attempt to
> use your script:
> 
> > setwd("/Users/thiago/Downloads/MODIS/images/")
> >
> source("/Users/thiago/Downloads/MODIS/ModisDownload.R")
> > GPP <- "ftp://e4ftl01.cr.usgs.gov/MODIS_Composites/MOLT/MOD17A2.005/"
> > MRT <- "/Applications/MRT/bin/"
> > library(RCurl)
> Loading required package: bitops
> > library(raster)
> Loading required package: sp
> raster version 1.9-32 (24-October-2011)
> >
> ModisDownload(FTP=GPP,h=c(10,14),v=c(7,14),dates=c("2010.01.01","2010.12.31"),mosaic=F,proj=F)
> Error in download.file(url = paste(FTP, "/", dirs[i], "/",
> ModisName,? : 
> ? cannot open URL 'ftp://e4ftl01.cr.usgs.gov/MODIS_Composites/MOLT/MOD17A2.005//2010.01.01/-rw-r--r--?
> 1 90? 395831 Feb? 4? 2010
> MOD17A2.A2010001.h10v07.005.2010035143552.hdf'
> In addition: Warning message:
> In mapCurlOptNames(names(.els), asNames = TRUE) :
> ? Unrecognized CURL options: ftplistonly
> 
> ? Looking at the script, this line seems to be the
> source of the error:
> 
> ? getlist <- strsplit(getURL(paste(FTP,"/",dirs[i],
> "/", sep=""), .opts=curlOptions(ftplistonly=TRUE)),
> "\r*\n")[[1]]
> 
> ? And checking the arguments of curlOptions,
> "ftplistonly" doesn't appear to be available:
> 
> ? > listCurlOptions()
> ? [1] "autoreferer"? ? ? ? ?
> ? ? ? "buffersize"? ? ? ?
> ? ? ? ???"cainfo"? ?
> ? ? ? ? ? ? ?
> ???"capath"? ? ? ? ?
> ? ? ? ? ? 
> ? [5] "closepolicy"? ? ? ? ?
> ? ? ? "connect.only"? ? ?
> ? ? ?
> ???"connecttimeout"? ? ?
> ? ? ???"connecttimeout.ms"?
> ? ? ???
> ? [9] "conv.from.network.function"
> "conv.from.utf8.function"? ?
> "conv.to.network.function"???"cookie"?
> ? ? ? ? ? ? ? ?
> ? 
>  [13] "cookiefile"? ? ? ? ? ?
> ? ???"cookiejar"? ? ?
> ? ? ? ? ? ? "cookielist"?
> ? ? ? ? ? ?
> ???"cookiesession"? ? ? ?
> ? ???
>  [17] "crlf"? ? ? ? ? ?
> ? ? ? ?
> ???"customrequest"? ? ? ?
> ? ? ? "debugdata"? ? ? ?
> ? ? ? ? ? "debugfunction"?
> ? ? ? ? ???
>  [21] "dns.cache.timeout"? ? ? ? ?
> "dns.use.global.cache"? ?
> ???"egdsocket"? ? ? ?
> ? ? ? ? ? "encoding"? ?
> ? ? ? ? ? ? ? 
>  [25] "errorbuffer"? ? ? ? ?
> ? ? ? "failonerror"? ? ?
> ? ? ? ? ? "file"? ?
> ? ? ? ? ? ? ? ?
> ???"filetime"? ? ? ?
> ? ? ? ? ? 
>  [29] "followlocation"? ? ? ? ?
> ???"forbid.reuse"? ? ? ?
> ? ? ???"fresh.connect"? ?
> ? ? ? ? ? "ftp.account"?
> ? ? ? ? ? ???
>  [33] "ftp.alternative.to.user"? ?
> "ftp.create.missing.dirs"? ?
> "ftp.filemethod"? ? ? ? ?
> ???"ftp.response.timeout"? ? ?
> 
>  [37] "ftp.skip.pasv.ip"? ? ? ?
> ???"ftp.ssl.ccc"? ? ? ?
> ? ? ? ? "ftp.use.eprt"? ?
> ? ? ? ?
> ???"ftp.use.epsv"? ? ? ?
> ? ? ? 
>  [41] "ftpport"? ? ? ? ? ?
> ? ? ? ? "ftpsslauth"? ? ?
> ? ? ? ? ???"header"?
> ? ? ? ? ? ? ? ?
> ???"headerdata"? ? ? ?
> ? ? ? ? 
>  [45] "headerfunction"? ? ? ? ?
> ???"http.content.decoding"? ?
> ? "http.transfer.decoding"?
> ???"http.version"? ? ? ?
> ? ? ? 
>  [49] "http200aliases"? ? ? ? ?
> ???"httpauth"? ? ? ?
> ? ? ? ?
> ???"httpget"? ? ? ?
> ? ? ? ? ? ? "httpheader"?
> ? ? ? ? ? ? ? 
>  [53] "httppost"? ? ? ? ? ?
> ? ? ???"httpproxytunnel"?
> ? ? ? ? ?
> "ignore.content.length"? ? ? "infile"?
> ? ? ? ? ? ? ? ?
> ? 
>  [57] "infilesize"? ? ? ? ? ?
> ? ???"infilesize.large"? ?
> ? ? ???"interface"? ?
> ? ? ? ? ? ? ?
> "ioctldata"? ? ? ? ? ? ?
> ???
>  [61] "ioctlfunction"? ? ? ? ?
> ? ? "ipresolve"? ? ? ? ?
> ? ? ? ? "localport"? ? ?
> ? ? ? ? ? ?
> "localportrange"? ? ? ? ? ? 
>  [65] "low.speed.limit"? ? ? ? ?
> ? "low.speed.time"? ? ? ? ?
> ???"max.recv.speed.large"? ?
> ???"max.send.speed.large"? ? ?
> 
>  [69] "maxconnects"? ? ? ? ?
> ? ? ? "maxfilesize"? ? ?
> ? ? ? ? ? "maxfilesize.large"?
> ? ? ? ? "maxredirs"? ? ?
> ? ? ? ? ???
>  [73] "netrc"? ? ? ? ? ?
> ? ? ? ? ? "netrc.file"? ?
> ? ? ? ? ?
> ???"nobody"? ? ? ? ?
> ? ? ? ?
> ???"noprogress"? ? ? ?
> ? ? ? ? 
>  [77] "nosignal"? ? ? ? ? ?
> ? ? ???"port"? ? ?
> ? ? ? ? ? ? ?
> ???"post"? ? ? ? ?
> ? ? ? ? ?
> ???"postfields"? ? ? ?
> ? ? ? ? 
>  [81] "postfieldsize"? ? ? ? ?
> ? ? "postfieldsize.large"? ? ?
> ? "postquote"? ? ? ? ? ?
> ? ? ? "prequote"? ? ? ?
> ? ? ? ? ? 
>  [85] "private"? ? ? ? ? ?
> ? ? ? ? "progressdata"? ?
> ? ? ? ?
> ???"progressfunction"? ? ?
> ? ???"proxy"? ? ? ?
> ? ? ? ? ? ???
>  [89] "proxyauth"? ? ? ? ? ?
> ? ? ? "proxyport"? ? ? ?
> ? ? ? ? ? "proxytype"? ?
> ? ? ? ? ? ? ?
> "proxyuserpwd"? ? ? ? ? ?
> ? 
>  [93] "put"? ? ? ? ? ? ?
> ? ? ? ? ? "quote"? ?
> ? ? ? ? ? ? ? ?
> ? "random.file"? ? ? ? ?
> ? ? ? "range"? ? ? ?
> ? ? ? ? ? ???
>  [97] "readdata"? ? ? ? ? ?
> ? ? ???"readfunction"? ?
> ? ? ? ?
> ???"referer"? ? ? ?
> ? ? ? ? ? ?
> "resume.from"? ? ? ? ? ?
> ???
> [101] "resume.from.large"? ? ? ? ?
> "share"? ? ? ? ? ? ?
> ? ? ? ? "sockoptdata"? ?
> ? ? ? ? ? ?
> "sockoptfunction"? ? ? ?
> ???
> [105] "ssh.auth.types"? ? ? ? ?
> ???"ssh.private.keyfile"? ? ?
> ? "ssh.public.keyfile"? ? ?
> ???"ssl.cipher.list"? ? ?
> ? ???
> [109] "ssl.ctx.data"? ? ? ? ?
> ? ???"ssl.ctx.function"? ?
> ? ? ???"ssl.sessionid.cache"?
> ? ? ? "ssl.verifyhost"? ? ?
> ? ? ? 
> [113] "ssl.verifypeer"? ? ? ? ?
> ???"sslcert"? ? ? ?
> ? ? ? ? ? ?
> "sslcerttype"? ? ? ? ? ?
> ? ? "sslengine"? ? ? ? ?
> ? ? ???
> [117] "sslengine.default"? ? ? ? ?
> "sslkey"? ? ? ? ? ? ?
> ? ? ???"sslkeytype"? ?
> ? ? ? ? ?
> ???"sslversion"? ? ? ?
> ? ? ? ? 
> [121] "stderr"? ? ? ? ? ?
> ? ? ? ???"tcp.nodelay"?
> ? ? ? ? ? ? ?
> "telnetoptions"? ? ? ? ? ?
> ? "timecondition"? ? ? ? ?
> ???
> [125] "timeout"? ? ? ? ? ?
> ? ? ? ? "timeout.ms"? ? ?
> ? ? ? ?
> ???"timevalue"? ? ? ?
> ? ? ? ? ? "transfertext"?
> ? ? ? ? ? ? 
> [129] "unrestricted.auth"? ? ? ? ?
> "upload"? ? ? ? ? ? ?
> ? ? ???"url"? ? ?
> ? ? ? ? ? ? ? ?
> ? "useragent"? ? ? ? ? ?
> ? ???
> [133] "userpwd"? ? ? ? ? ?
> ? ? ? ? "verbose"? ? ?
> ? ? ? ? ? ? ?
> "writedata"? ? ? ? ? ? ?
> ? ? "writefunction"? ? ? ?
> ? ???
> [137] "writeheader"? ? ? ? ?
> ? ? ? "writeinfo"? ? ? ?
> ? ? ? ???
> 
> ? As usual, output of sessionInfo:
> 
> > sessionInfo()
> R version 2.13.2 (2011-09-30)
> Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)
> 
> locale:
> [1] en_US.UTF-8/en_US.UTF-8/C/C/en_US.UTF-8/en_US.UTF-8
> 
> attached base packages:
> [1] stats? ???graphics? grDevices
> utils? ???datasets?
> methods???base? ???
> 
> other attached packages:
> [1] raster_1.9-32? sp_0.9-91? ? ?
> RCurl_1.6-10???bitops_1.0-4.1
> 
> loaded via a namespace (and not attached):
> [1] grid_2.13.2? ???lattice_0.19-33
> 
> ? Any tips?
> 
> ? Thank you and best wishes,
> 
> ? Thiago.? 
> 
> --- On Mon, 24/10/11, Babak Naimi <naimi at itc.nl>
> wrote:
> 
> > From: Babak Naimi <naimi at itc.nl>
> > Subject: [R-sig-Geo] ModisDownload
> > To: "'r-sig-geo at r-project.org'"
> <r-sig-geo at r-project.org>
> > Date: Monday, 24 October, 2011, 13:06
> > Dear list,
> > 
> > This might be interesting for you. I implemented an R
> > function to automate download, mosaic, and projecting
> of
> > MODIS images. In the following link you will find the
> > instruction and details on how to use this function:
> > http://r-gis.net/?q=ModisDownload

> > 
> > Thanks Tom Hengel, as his script on http://spatial-analyst.net made the main core of the
> > ModisDownload function.
> > 
> > Best regards,
> > 
> > Babak Naimi
> > PhD Candidate, Natural Resources Department,
> > Faculty of Geo-Information Science and Earth
> Observations
> > (ITC), University of Twente, 
> > P.O. Box 217, 7500 AE Enschede, The Netherlands
> > Tel: +31 53 4874212
> > 
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo

> > 
>


From tom.gottfried at tum.de  Thu Nov  3 16:22:12 2011
From: tom.gottfried at tum.de (Tom Gottfried)
Date: Thu, 3 Nov 2011 16:22:12 +0100
Subject: [R-sig-Geo] plot variogram cloud with free scales
Message-ID: <4EB2B1A4.8080005@tum.de>

Dear listers,

trying to plot a variogram cloud of a multivariable variogram with

library(gstat)
data(meuse)
coordinates(meuse) <- ~x+y
g <- gstat(NULL, "zinc", zinc~1, meuse)
g <- gstat(g, "lead", lead~1, meuse)
plot(variogram(g, cloud=TRUE), scales=list(y=list(relation="free")))

I get distinct y-axes for every panel but all with the same range instead of adjusted to the data. 
Is it possible to get the y-axes adjusted to the data in each panel? Like in this plot:

plot(variogram(g), scales=list(y=list(relation="free")))

Thanks!
Tom
-- 
Technische Universit?t M?nchen
Department f?r Pflanzenwissenschaften
Lehrstuhl f?r Gr?nlandlehre
Alte Akademie 12
85350 Freising / Germany
Phone: ++49 (0)8161 715324
Fax:   ++49 (0)8161 713243
email: tom.gottfried at wzw.tum.de
http://www.wzw.tum.de/gruenland


From a.ghisla at gmail.com  Fri Nov  4 19:36:11 2011
From: a.ghisla at gmail.com (Anne Ghisla)
Date: Fri, 4 Nov 2011 19:36:11 +0100
Subject: [R-sig-Geo] Quick poll -- favorite GIS textbook?
In-Reply-To: <CADkZ+_WHDPJhnyp2S7vwfFkrRZ4xq3Xh+UQfMZ2_w5OZnOQSHw@mail.gmail.com>
References: <CABG0rfuc2yaw4cJ6h6skcstAyuLNDs+gUicG05iHLC2E684m0A@mail.gmail.com>
	<CADkZ+_WHDPJhnyp2S7vwfFkrRZ4xq3Xh+UQfMZ2_w5OZnOQSHw@mail.gmail.com>
Message-ID: <20111104193611.1c783df0@galadriel.localdomain>

On Tue, 11 Oct 2011 17:13:35 -0400
Steve Friedman <friedman.steve at gmail.com> wrote:

> While open source gis is appealing most jobs still require
> introductory employees to use arcgis products. I'd stay away from
> anything else if you want your students to thank you latter.

Sorry if I step in a bit late.

Well, if students are taught the concepts and are given open source
GIS to practice, they will be able to use any other GIS. The advantage
is that they won't need to buy licenses or worse have illegal copies
to complete the tutorials.

I also agree with Rich's opinions. 

The decision of teaching closed source GIS comes often by the will to
prepare people to work. And workplaces simply adopt what people have
learned at school, and/or ask for people able to use the software they
bought some time in the past and are reluctant to abandon... 
One of the ways to break this circle - and reward competent technicians - is to be
truly software independent.

My 2c,
Anne

> Steve
> On Oct 11, 2011 4:33 PM, "Jonathan Greenberg" <jgrn at illinois.edu>
> wrote:
> 
> > R-sig-geo'ers:
> >
> > I wanted to take a quick poll -- what is your favorite introductory
> > GIS textbook?  I'm evaluating texts for a basic GIS course I'll be
> > teaching next year, and I wanted to get some feedback from the
> > open-source community.  Thanks!
> >
> > --j
> >
> > --
> > Jonathan A. Greenberg, PhD
> > Assistant Professor
> > Department of Geography
> > University of Illinois at Urbana-Champaign
> > 607 South Mathews Avenue, MC 150
> > Urbana, IL 61801
> > Phone: 415-763-5476
> > AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype:
> > jgrn3007 http://www.geog.illinois.edu/people/JonathanGreenberg.html
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
http://gis.cri.fmach.it/ghisla/
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 836 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111104/8bfcc379/attachment.bin>

From godina at dal.ca  Sun Nov  6 14:11:37 2011
From: godina at dal.ca (Aurelie C.Godin)
Date: Sun, 6 Nov 2011 05:11:37 -0800 (PST)
Subject: [R-sig-Geo] PBSMapping - addBubbles - changing colors
Message-ID: <1320585097262-6967324.post@n2.nabble.com>

Dear all,

I'm working with library(PBSmapping) and would like to change my addBubbles
colors (symbol.fg & symbol.bg) to the default vector grey color to a vector
of oranges/yellow (like:
http://www.oga-lab.net/RGM2/func.php?rd_id=PBSmapping:addBubbles). 
However, it doesn't look like I can use the rgb package since I am working
on R version 2.13.2.

>package ?rgb? is not available (for R version 2.13.2)

Is there a way that I can go around this?
Thank you very much!



-----
Aurelie Cosandey-Godin
Ph.D. Student, Department of Biology, Dalhousie University
Industrial Graduate Fellow, WWF-Canada
Email: godina at dal.ca | Web: wormlab.biology.dal.ca

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/PBSMapping-addBubbles-changing-colors-tp6967324p6967324.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From dusa.adrian at gmail.com  Sun Nov  6 15:29:30 2011
From: dusa.adrian at gmail.com (Adrian Dusa)
Date: Sun, 6 Nov 2011 16:29:30 +0200
Subject: [R-sig-Geo] region border
Message-ID: <CAJ=0CtC_1sV7hh+LeDAgUfFhYmCc2DvXTwVbObd7mWypK=8Jaw@mail.gmail.com>

Dear list,

I have a shapefile with a list of counties (Romania), and would like
to create borders for larger regions (for multiple counties).
I tried searching for some hints, but with no avail.

Could anybody please point me to the right direction?
Hints, examples, etc. would be welcomed.

Thanks in advance,
Adrian

-- 
Adrian Dusa
Romanian Social Data Archive
1, Schitu Magureanu Bd.
050025 Bucharest sector 5
Romania
Tel.:+40 21 3126618 \
? ? ? ?+40 21 3120210 / int.101
Fax: +40 21 3158391


From Roger.Bivand at nhh.no  Sun Nov  6 15:35:54 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sun, 6 Nov 2011 15:35:54 +0100
Subject: [R-sig-Geo] region border
In-Reply-To: <CAJ=0CtC_1sV7hh+LeDAgUfFhYmCc2DvXTwVbObd7mWypK=8Jaw@mail.gmail.com>
References: <CAJ=0CtC_1sV7hh+LeDAgUfFhYmCc2DvXTwVbObd7mWypK=8Jaw@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1111061535140.23162@reclus.nhh.no>

On Sun, 6 Nov 2011, Adrian Dusa wrote:

> Dear list,
>
> I have a shapefile with a list of counties (Romania), and would like
> to create borders for larger regions (for multiple counties).
> I tried searching for some hints, but with no avail.
>
> Could anybody please point me to the right direction?
> Hints, examples, etc. would be welcomed.

?unionSpatialPolygons in maptools, examples in help file.

Roger

>
> Thanks in advance,
> Adrian
>
> -- 
> Adrian Dusa
> Romanian Social Data Archive
> 1, Schitu Magureanu Bd.
> 050025 Bucharest sector 5
> Romania
> Tel.:+40 21 3126618 \
> ? ? ? ?+40 21 3120210 / int.101
> Fax: +40 21 3158391
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From dusa.adrian at gmail.com  Sun Nov  6 15:37:03 2011
From: dusa.adrian at gmail.com (Adrian Dusa)
Date: Sun, 6 Nov 2011 16:37:03 +0200
Subject: [R-sig-Geo] region border
In-Reply-To: <alpine.LRH.2.00.1111061535140.23162@reclus.nhh.no>
References: <CAJ=0CtC_1sV7hh+LeDAgUfFhYmCc2DvXTwVbObd7mWypK=8Jaw@mail.gmail.com>
	<alpine.LRH.2.00.1111061535140.23162@reclus.nhh.no>
Message-ID: <CAJ=0CtDOsZ-33sTADzKsQ+TNiTT5BiGHtfSDKPEGegWrL9FMSg@mail.gmail.com>

On Sun, Nov 6, 2011 at 16:35, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> On Sun, 6 Nov 2011, Adrian Dusa wrote:
>
>> Dear list,
>>
>> I have a shapefile with a list of counties (Romania), and would like
>> to create borders for larger regions (for multiple counties).
>> I tried searching for some hints, but with no avail.
>>
>> Could anybody please point me to the right direction?
>> Hints, examples, etc. would be welcomed.
>
> ?unionSpatialPolygons in maptools, examples in help file.

How very excellent, thanks!
Adrian


-- 
Adrian Dusa
Romanian Social Data Archive
1, Schitu Magureanu Bd.
050025 Bucharest sector 5
Romania
Tel.:+40 21 3126618 \
? ? ? ?+40 21 3120210 / int.101
Fax: +40 21 3158391


From dusa.adrian at gmail.com  Sun Nov  6 17:00:05 2011
From: dusa.adrian at gmail.com (Adrian Dusa)
Date: Sun, 6 Nov 2011 18:00:05 +0200
Subject: [R-sig-Geo] shapefiles to/from svg converters
Message-ID: <CAJ=0CtDhaY=5XY8ssMHEAQyXbVkR4aY0huSxmiOss_shHsg4Wg@mail.gmail.com>

Dear list,

I work on a code to create some maps on a webpage using Javascript and
SVG (which is now fairly well supported by most major browsers).
There are some tools to convert shapefiles to SVG (e.g.
http://www.webmapper.net/svg/create/), and I wanted to ask:
- is there an R code to create SVG from shapefiles?
- would it be possible to revert the process, in order to obtain a
shapefile from an SVG file?

Thanks again,
Adrian

-- 
Adrian Dusa
Romanian Social Data Archive
1, Schitu Magureanu Bd.
050025 Bucharest sector 5
Romania
Tel.:+40 21 3126618 \
? ? ? ?+40 21 3120210 / int.101
Fax: +40 21 3158391


From e.jahanshiri at gmail.com  Sun Nov  6 18:31:46 2011
From: e.jahanshiri at gmail.com (Ebrahim Jahanshiri)
Date: Mon, 7 Nov 2011 01:31:46 +0800
Subject: [R-sig-Geo] Contour plot using classIntervals()
Message-ID: <CANCB45tDxzHev8isRVLRb=YHgHRpZX4vcaLELJVA0FXCWDgzTA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111107/c4bfa93b/attachment.pl>

From Roger.Bivand at nhh.no  Sun Nov  6 21:26:33 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sun, 6 Nov 2011 21:26:33 +0100 (CET)
Subject: [R-sig-Geo] Contour plot using classIntervals()
In-Reply-To: <CANCB45tDxzHev8isRVLRb=YHgHRpZX4vcaLELJVA0FXCWDgzTA@mail.gmail.com>
References: <CANCB45tDxzHev8isRVLRb=YHgHRpZX4vcaLELJVA0FXCWDgzTA@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1111062121380.24046@reclus.nhh.no>

On Mon, 7 Nov 2011, Ebrahim Jahanshiri wrote:

> I used classInt, classIntervals() to create a classified map of different
> levels. How can I use the same "classIntervals" levels to make a contour or
> filled contour map? and possibly be able to overlay on top of the previous
> plot:
>
> library(RColorBrewer) # creates nice color schemes
> library(classInt)     # finds class intervals for continuous variables
> plotvar <- k$Z
> nclr <- 4
> plotclr <- brewer.pal(nclr,"BuPu")
> class <- classIntervals(plotvar, nclr, style="quantile")
> colcode <- findColours(class, plotclr)
> plot(k)
> plot(k, col=colcode, add=T)
>

Look at the contents of your class object - str(class) - the list 
component you need is called brks, as you see in the Value: section of the 
help page. So class$brks contains the break points found, and may be 
passed to contour() and filled.contour() as levels= (untried).

Roger

>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From r.hijmans at gmail.com  Mon Nov  7 08:04:08 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sun, 6 Nov 2011 23:04:08 -0800
Subject: [R-sig-Geo] How to quickly add many raster layers to a thick
	RasterStack?
In-Reply-To: <1320191179382-6953662.post@n2.nabble.com>
References: <1320191179382-6953662.post@n2.nabble.com>
Message-ID: <CANtt_hzXqmLs-2qeX0Q-ghg1132=2ZxdEgN0SJKUkjjFEUHMug@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111106/3a005ea7/attachment.pl>

From matteo.mattiuzzi at boku.ac.at  Mon Nov  7 11:28:49 2011
From: matteo.mattiuzzi at boku.ac.at (Matteo Mattiuzzi)
Date: Mon, 07 Nov 2011 11:28:49 +0100
Subject: [R-sig-Geo] Area weighted stratified point sampling
Message-ID: <4EB7C0F102000027000111AB@gwia2.boku.ac.at>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111107/27386d53/attachment.pl>

From bmack at uni-bonn.de  Mon Nov  7 17:52:57 2011
From: bmack at uni-bonn.de (Benjamin Mack)
Date: Mon, 07 Nov 2011 17:52:57 +0100
Subject: [R-sig-Geo] create a raster with values from
	SpatialPolygonsDataFrame
Message-ID: <4EB80CE9.7030908@uni-bonn.de>

Hello list,
I would like to create a new raster with values from a 
SpatialPolygonsDataFrame. It works with the code below, however it is 
really slow. I would appreciate any suggestions which could speed up the 
code!
Thanks in advance!
Ben

Code:
"r" is the raster file
"ref" is the SpatialPolygonsDataFrame with one column named "lc" with 
integer values.
to write the values from the polygons to the raster I do the following:

   u.IDs <- unique(ref at data$lc) # unique lc(land cover) values/IDs
   for (ii in 1:length(u.IDs)) {
       temp <- ref[ref at data$lc==u.IDs[ii],] # create a new 
SpatialPolygonsDataFrame for a specific lc-ID
       ra[temp] <- u.IDs[ii] # write the values to the raster  }


From r.hijmans at gmail.com  Mon Nov  7 18:11:23 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 7 Nov 2011 09:11:23 -0800
Subject: [R-sig-Geo] How to quickly add many raster layers to a thick
	RasterStack?
In-Reply-To: <CANtt_hzXqmLs-2qeX0Q-ghg1132=2ZxdEgN0SJKUkjjFEUHMug@mail.gmail.com>
References: <1320191179382-6953662.post@n2.nabble.com>
	<CANtt_hzXqmLs-2qeX0Q-ghg1132=2ZxdEgN0SJKUkjjFEUHMug@mail.gmail.com>
Message-ID: <CANtt_hzPbLxnL5Z-ao2dsVeKnaju_Y8gz+UgFGL5pic03zuwTg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111107/5903ee0a/attachment.pl>

From r.hijmans at gmail.com  Mon Nov  7 18:17:18 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 7 Nov 2011 09:17:18 -0800
Subject: [R-sig-Geo] create a raster with values from
	SpatialPolygonsDataFrame
In-Reply-To: <4EB80CE9.7030908@uni-bonn.de>
References: <4EB80CE9.7030908@uni-bonn.de>
Message-ID: <CANtt_hwO2ONdfykX9G5qLyuUQBDZSR2mf1AjH-q6kcm3pL7HrA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111107/fe25eaca/attachment.pl>

From pgalpern at gmail.com  Mon Nov  7 18:35:51 2011
From: pgalpern at gmail.com (pgalpern)
Date: Mon, 07 Nov 2011 11:35:51 -0600
Subject: [R-sig-Geo] Inner edge() sometimes outside using raster package
Message-ID: <4EB816F7.6040902@gmail.com>

Hello!

Perhaps I am doing something wrong, here, but in the following case the 
edge() function in the raster package appears to find an edge that is 
two cells wide when I don't think it should.

There are three objects on the raster, each is a 9 cell square.  One of 
these squares is one cell away from the border of the raster.  It is on 
this square that the error occurs.

library(raster)
download.file("http://nricaribou.cc.umanitoba.ca/R/edgeissue.asc", 
"~/edgeissue.asc")
edgeIssue <- raster("~/edgeissue.asc")
findEdge <- edge(edgeIssue, type="inner")
plot(findEdge)

which((findEdge==1 & is.na(edgeIssue))[])
## Gives cell numbers: 12037 12038 12039
## These are outside any of the squares on the raster edgeIssue

Any thoughts would be appreciated.

Thanks,
Paul

-- 
Paul Galpern, PhD Candidate
Natural Resources Institute
70 Dysart Road
University of Manitoba
Winnipeg, Manitoba, Canada R3T 2M6
http://borealscape.ca


From edmundthhar at gmail.com  Mon Nov  7 18:56:04 2011
From: edmundthhar at gmail.com (Edmund Har)
Date: Mon, 7 Nov 2011 17:56:04 +0000
Subject: [R-sig-Geo] error while loading 'gstat' on R on Mac
Message-ID: <41841D2A-38B7-479F-B146-F34124A7A9B8@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111107/af5d5619/attachment.pl>

From r.hijmans at gmail.com  Mon Nov  7 19:02:19 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 7 Nov 2011 10:02:19 -0800
Subject: [R-sig-Geo] Inner edge() sometimes outside using raster package
In-Reply-To: <4EB816F7.6040902@gmail.com>
References: <4EB816F7.6040902@gmail.com>
Message-ID: <CANtt_hyyF5K=acm-M0C8ytam_O22K6XWHaE90Dvs2WbexJX7bA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111107/ca660d84/attachment.pl>

From gianni.lavaredo at gmail.com  Mon Nov  7 19:37:03 2011
From: gianni.lavaredo at gmail.com (gianni lavaredo)
Date: Mon, 7 Nov 2011 19:37:03 +0100
Subject: [R-sig-Geo] A question to setting RandomForest for regression way
Message-ID: <CAJ6JbR_VSU=8PK0ro7iyiWyfwtHbmhVTHaZS+CRmRN=wvrHSHw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111107/4c70ed53/attachment.pl>

From herreria at eco.uji.es  Mon Nov  7 23:13:15 2011
From: herreria at eco.uji.es (Maria Jesus Herrerias)
Date: Mon, 7 Nov 2011 23:13:15 +0100
Subject: [R-sig-Geo] draw a map
Message-ID: <CAPvcma3Mqimug_VJzk-CEvsaVcnPTaLj_VQqsC9N6W4hnj1sSg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111107/a52a4770/attachment.pl>

From gnireaht at googlemail.com  Tue Nov  8 08:03:54 2011
From: gnireaht at googlemail.com (Tim Haering)
Date: Tue, 08 Nov 2011 08:03:54 +0100
Subject: [R-sig-Geo] logical operation on raster stack
Message-ID: <4EB8D45A.2000105@googlemail.com>

Dear list members,

has somebody experience in analysing raster* objects with logical functions?
Consider following example:
# define a logical function
bi <- function(x){ which(x==1) + 1 != which(x==2) & which(x==1) - 1 != 
which(x==2) }
# generate some example data
t1 <- c(8, 5, 7, 1, 4, 3, 2, 6, 9)
t2 <- c(9, 6, 7, 4, 5, 3, 1, 2, 8)
# function works correct
bi(t1)
bi(t2)

I would like to use this function on a raster stack, but don't know how. 
Can someone please help me?
# example data
r1 <- raster(nrows=10, ncols=10)
values(r1) <- rbinom(100, size = 5, prob=0.5)
r2 <- r1+1
r3 <- r1+2
r <- stack(r1, r2, r3)

# the calc function doesn't work
mycalc <- calc(r, fun=bi)

Thanks a lot.

TIM


From bmack at uni-bonn.de  Tue Nov  8 08:43:22 2011
From: bmack at uni-bonn.de (Benjamin Mack)
Date: Tue, 08 Nov 2011 08:43:22 +0100
Subject: [R-sig-Geo] create a raster with values from
	SpatialPolygonsDataFrame
In-Reply-To: <CANtt_hwO2ONdfykX9G5qLyuUQBDZSR2mf1AjH-q6kcm3pL7HrA@mail.gmail.com>
References: <4EB80CE9.7030908@uni-bonn.de>
	<CANtt_hwO2ONdfykX9G5qLyuUQBDZSR2mf1AjH-q6kcm3pL7HrA@mail.gmail.com>
Message-ID: <4EB8DD9A.6010302@uni-bonn.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111108/fced0058/attachment.pl>

From educheyne at avia-gis.be  Tue Nov  8 09:18:28 2011
From: educheyne at avia-gis.be (Els Ducheyne)
Date: Tue, 8 Nov 2011 09:18:28 +0100
Subject: [R-sig-Geo] NAvalues on a raster stack
Message-ID: <8ADFD63B-9AB2-41A3-91B9-6EAC24EC7402@avia-gis.be>

Dear list
I have been working with raster stack for a while. Until now I have not experienced any problems with NAvalues on stacks. However, yesterday I was stacking 6 layers in a stack. 4 of these seemed to contain background values only with a value of -0.3.
I have tried to set the NAvalue on the stack as follows
NAvalues(ndvi.stack) <-  -0.3

but when using summarise(ndvi.stack,na.rm=T) I still get the -0.3 values.
The main problem is that I am calculating monthly means after this step as follows
monthly.mean <- calc(ndvi.stack,fun=mean,na.rm=T) and that because of the fact that the NA value is not accepted i get wrong outputs.

is the NAvalue not accepted because the entire image is -0.3? or is there another reason?

i am using the Raster package version 1.9-5 
Thanks for any suggestions
Best regards
Els


From carstennh at aol.com  Tue Nov  8 13:14:55 2011
From: carstennh at aol.com (Carsten Neumann)
Date: Tue, 08 Nov 2011 13:14:55 +0100
Subject: [R-sig-Geo] NAvalues on a raster stack
In-Reply-To: <8ADFD63B-9AB2-41A3-91B9-6EAC24EC7402@avia-gis.be>
References: <8ADFD63B-9AB2-41A3-91B9-6EAC24EC7402@avia-gis.be>
Message-ID: <4EB91D3F.7030600@aol.com>

  Am 08.11.2011 09:18, schrieb Els Ducheyne:
> Dear list
> I have been working with raster stack for a while. Until now I have not experienced any problems with NAvalues on stacks. However, yesterday I was stacking 6 layers in a stack. 4 of these seemed to contain background values only with a value of -0.3.
> I have tried to set the NAvalue on the stack as follows
> NAvalues(ndvi.stack)<-  -0.3
>
> but when using summarise(ndvi.stack,na.rm=T) I still get the -0.3 values.
> The main problem is that I am calculating monthly means after this step as follows
> monthly.mean<- calc(ndvi.stack,fun=mean,na.rm=T) and that because of the fact that the NA value is not accepted i get wrong outputs.
>
> is the NAvalue not accepted because the entire image is -0.3? or is there another reason?
>
> i am using the Raster package version 1.9-5
> Thanks for any suggestions
> Best regards
> Els
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
Dear Els,

did you keep your dataset 'ndvi.stack' as read from disk? The function 
Navalues can only change values when reading your rasterStack object 
from disk. If you have your values in memory nothing will change 
applying your function.

Maybe this could help?

Best regards

Carsten

-- 

Carsten Neumann
Telegrafenberg, A 17 01.13
14473 Potsdam
-------------------------------------------------------
Helmholtz Centre Potsdam
GFZ German Research Centre for Geosciences
Department 1 - Section 1.4 - Remote Sensing
-------------------------------------------------------
Tel.: +49 (0) 331 288 1766
e-mail: carstenn at gfz-potsdam.de


From lyndon.estes at gmail.com  Tue Nov  8 15:23:12 2011
From: lyndon.estes at gmail.com (Lyndon Estes)
Date: Tue, 8 Nov 2011 09:23:12 -0500
Subject: [R-sig-Geo] draw a map
In-Reply-To: <CAPvcma3Mqimug_VJzk-CEvsaVcnPTaLj_VQqsC9N6W4hnj1sSg@mail.gmail.com>
References: <CAPvcma3Mqimug_VJzk-CEvsaVcnPTaLj_VQqsC9N6W4hnj1sSg@mail.gmail.com>
Message-ID: <CALuVVaadZtYqoH1bDf4jNXTfKbprwtULqKgVewc6-UoECLk8-w@mail.gmail.com>

Hi Maria,

Please see my inserts below.

> ---
> The script is as following:
>
> install.packages("sp")
> library(sp)
>
> #load the map #
> mapchina<- url("http://www.gadm.org/data/rda/CHN_adm1.RData")
>
> load(mapchina)
> mapchina=gadm
>
> gadm$NAME_1 ? #shows the name of the Chinese regions
>
> #create the vector of data that we want to draw in the Chinese map,. Notice
> that follow the same order that NAME_1 #
>
> valor=c(99.09,70.62,0,49.13,42.13,40.53,46.10,40.36,0,71.87,38.71,
> 82.36,69.76,62.68,76.17,70.43,47.96,42.34,49.65,44.42,0,41.19,66.42,
> 61.04,76.75,82.75,44.69,75.37,20.53,21.25,38.10,89.74)
>
> var1<-data.frame(valor)
>
> # add the vector of data into the map

# There was no mapa object, so maybe you had it already created it, and
# forgot to include it
mapa <- mapchina

> mapa at data=data.frame(var1)
>
> #plot the map
> spplot(mapa,c("var1"))  # Wrong variable name

# You want this instead, since the column header for the dataframe you
# joined to maps is "valor", not "var1"
spplot(mapa,"valor")  # This plots for me


Cheers, Lyndon


From herreria at eco.uji.es  Tue Nov  8 15:43:26 2011
From: herreria at eco.uji.es (Maria Jesus Herrerias)
Date: Tue, 8 Nov 2011 15:43:26 +0100
Subject: [R-sig-Geo] draw a map
Message-ID: <CAPvcma1vyp2m=sdz_z=YhfgrBXKvmO3=xMLyxGGwq8uJGhs37g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111108/33350a53/attachment.pl>

From rhunne at mac.com  Tue Nov  8 16:10:03 2011
From: rhunne at mac.com (Robin W Hunnewell)
Date: Tue, 08 Nov 2011 15:10:03 +0000 (GMT)
Subject: [R-sig-Geo] Error message after updating spatstat
Message-ID: <8b5d6c0b-34df-cc9e-cc5b-c533cca89699@me.com>

Hi,
This is probably not the place to ask this, but I recently updated my version of spatstat, and now have the following problem.

I downloaded the latest release of {spatstat}, version 1.24-1. All seems fine. However now, when I do ?>help() to look up a certain function in the spatstat library, I get an error message - which only happens when looking up a spatstat function:

Error in fetch(key) : internal error -3 in R_decompress1


I am running R 2.13.1 on a Mac. My session info below. 
Can anyone help me with what I should do here? 

Thanks in advance,
Robin


> sessionInfo()
R version 2.13.1 (2011-07-08)
Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)

locale:
[1] en_US.UTF-8/en_USUTF-8/C/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] gpclib_1.5-1    rgdal_0.6-33    maptools_0.8-10 lattice_0.19-33 foreign_0.8-45  spatstat_1.24-1
[7] deldir_0.0-15   mgcv_1.7-6      sp_0.9-91      

loaded via a namespace (and not attached):
[1] grid_2.13.1        Matrix_0.999375-50 nlme_3.1-102       tools_213.1 

------------------------------------------
Robin Hunnewell
Department of Biology
University of New Brunswick
Fredericton, NB  Canada 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111108/c449395f/attachment.html>

From r.hijmans at gmail.com  Tue Nov  8 18:06:24 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 8 Nov 2011 09:06:24 -0800
Subject: [R-sig-Geo] logical operation on raster stack
In-Reply-To: <4EB8D45A.2000105@googlemail.com>
References: <4EB8D45A.2000105@googlemail.com>
Message-ID: <CANtt_hyAu8DcpNs0YGcF1f88u5CPEoZGN=M4X-zzqwq6+BXMUw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111108/b22e4493/attachment.pl>

From r.hijmans at gmail.com  Tue Nov  8 18:15:22 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 8 Nov 2011 09:15:22 -0800
Subject: [R-sig-Geo] draw a map
In-Reply-To: <CAPvcma1vyp2m=sdz_z=YhfgrBXKvmO3=xMLyxGGwq8uJGhs37g@mail.gmail.com>
References: <CAPvcma1vyp2m=sdz_z=YhfgrBXKvmO3=xMLyxGGwq8uJGhs37g@mail.gmail.com>
Message-ID: <CANtt_hyxr37W50JmZS-_9DUiKM5Powt1XBHFOpvyC5WVw3i3Ag@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111108/421b14ae/attachment.pl>

From r.hijmans at gmail.com  Tue Nov  8 18:20:03 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 8 Nov 2011 09:20:03 -0800
Subject: [R-sig-Geo] NAvalues on a raster stack
In-Reply-To: <4EB91D3F.7030600@aol.com>
References: <8ADFD63B-9AB2-41A3-91B9-6EAC24EC7402@avia-gis.be>
	<4EB91D3F.7030600@aol.com>
Message-ID: <CANtt_hyVeYS1WMysfBby=6SbYqTy=ovgA1fQafqGtHbFeBH0ZA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111108/50973cf9/attachment.pl>

From srabin at Princeton.EDU  Tue Nov  8 18:24:08 2011
From: srabin at Princeton.EDU (Sam Rabin)
Date: Tue, 8 Nov 2011 12:24:08 -0500
Subject: [R-sig-Geo] Calculating perimeter
Message-ID: <DE9AA728-42E4-49CD-95FE-7E343312E391@Princeton.EDU>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111108/547300a6/attachment.pl>

From r.hijmans at gmail.com  Tue Nov  8 18:32:20 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 8 Nov 2011 09:32:20 -0800
Subject: [R-sig-Geo] Calculating perimeter
In-Reply-To: <DE9AA728-42E4-49CD-95FE-7E343312E391@Princeton.EDU>
References: <DE9AA728-42E4-49CD-95FE-7E343312E391@Princeton.EDU>
Message-ID: <CANtt_hze-PTJaoOePdSPpSL9O_TL6QFYSDkLybPZdvMowmOxKA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111108/e4c86713/attachment.pl>

From herreria at eco.uji.es  Tue Nov  8 18:30:43 2011
From: herreria at eco.uji.es (Maria Jesus Herrerias)
Date: Tue, 8 Nov 2011 18:30:43 +0100
Subject: [R-sig-Geo] draw map
Message-ID: <CAPvcma3GN6EjEa91oVeOhHUCR9PqE0a4JBfVsA2isVDks3uLmg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111108/45ae25d5/attachment.pl>

From Roger.Bivand at nhh.no  Tue Nov  8 18:35:33 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 8 Nov 2011 18:35:33 +0100 (CET)
Subject: [R-sig-Geo] Calculating perimeter
In-Reply-To: <DE9AA728-42E4-49CD-95FE-7E343312E391@Princeton.EDU>
References: <DE9AA728-42E4-49CD-95FE-7E343312E391@Princeton.EDU>
Message-ID: <alpine.LRH.2.00.1111081830540.32630@reclus.nhh.no>

On Tue, 8 Nov 2011, Sam Rabin wrote:

> Hello all. I feel like this is a very easy thing that I have made difficult, but such is learning. I am trying to calculate the perimeter of every polygon in a shapefile, and I am running into all kinds of problems. I have looked into PBSmapping's calcLength, but I get the following error:
>
>> data = readShapePoly("shapefile.shp")
>> data.polydata = as.PolyData(data at data)
>> calcLength(data.polydata)
> Error in calcLength(data.polydata) : Invalid PolySet 'polys'.
> Unexpected class (PolyData).
>
> I'm running Mac OS X 10.7 and cannot seem to get rgeos or rgdal to load, 
> which is compounding the difficulty. I was wondering if somebody might 
> fix my code above, or point me towards a package that can do this 
> easily.

setRepositories(ind=1:2)
install.packages(c("rgdal", "rgeos"))

unless 10.7 raises issues. You also need to disambiguate what you mean by 
polygons in a shapefile - do you mean Polygons objects - which may contain 
multiple external and internal rings, or Polygon objects, which are single 
rings (may be external or internal)? You also need to establish whether 
your coordinates are projected (planar) or not. The easiest way may be to 
use a topological GIS, like GRASS - see ?vect2neigh() in spgrass6.

Roger

>
> Thanks very much!
>
> Sam Rabin
>     Graduate student
>         Princeton University
>         Ecology & Evolutionary Biology
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From jmbarriosg at gmail.com  Tue Nov  8 20:12:03 2011
From: jmbarriosg at gmail.com (=?ISO-8859-1?Q?Jos=E9_Miguel_Barrios?=)
Date: Tue, 8 Nov 2011 20:12:03 +0100
Subject: [R-sig-Geo] Calculating perimeter
In-Reply-To: <alpine.LRH.2.00.1111081830540.32630@reclus.nhh.no>
References: <DE9AA728-42E4-49CD-95FE-7E343312E391@Princeton.EDU>
	<alpine.LRH.2.00.1111081830540.32630@reclus.nhh.no>
Message-ID: <CAKAdxrV9fm9dS2d5LFxf9YRxOrXf9_Lwo7WLTAVNCyyrw+XOTA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111108/08010f2e/attachment.pl>

From educheyne at avia-gis.be  Tue Nov  8 23:02:43 2011
From: educheyne at avia-gis.be (Els Ducheyne)
Date: Tue, 8 Nov 2011 23:02:43 +0100
Subject: [R-sig-Geo] NAvalues on a raster stack
In-Reply-To: <CANtt_hyVeYS1WMysfBby=6SbYqTy=ovgA1fQafqGtHbFeBH0ZA@mail.gmail.com>
References: <8ADFD63B-9AB2-41A3-91B9-6EAC24EC7402@avia-gis.be>
	<4EB91D3F.7030600@aol.com>
	<CANtt_hyVeYS1WMysfBby=6SbYqTy=ovgA1fQafqGtHbFeBH0ZA@mail.gmail.com>
Message-ID: <E4B1B52F-FE22-4212-99BE-4271C294621E@avia-gis.be>

Dear Carsten and Robert
thanks for your help, I have now used reclass to do the job and this works perfectly
I will also check out subs and keeping the dataset as read
Els
On 8 Nov 2011, at 18:20, Robert J. Hijmans wrote:

> Els, 
> To add to what Carsten says: in that case you can use 'reclass' or 'subs'  or (at least in current versions) replacement:  ndvi.stack[ndvi.stack == -0.3] <- NA
> Robert
> 
> 
> On Tue, Nov 8, 2011 at 4:14 AM, Carsten Neumann <carstennh at aol.com> wrote:
>  Am 08.11.2011 09:18, schrieb Els Ducheyne:
> 
> Dear list
> I have been working with raster stack for a while. Until now I have not experienced any problems with NAvalues on stacks. However, yesterday I was stacking 6 layers in a stack. 4 of these seemed to contain background values only with a value of -0.3.
> I have tried to set the NAvalue on the stack as follows
> NAvalues(ndvi.stack)<-  -0.3
> 
> but when using summarise(ndvi.stack,na.rm=T) I still get the -0.3 values.
> The main problem is that I am calculating monthly means after this step as follows
> monthly.mean<- calc(ndvi.stack,fun=mean,na.rm=T) and that because of the fact that the NA value is not accepted i get wrong outputs.
> 
> is the NAvalue not accepted because the entire image is -0.3? or is there another reason?
> 
> i am using the Raster package version 1.9-5
> Thanks for any suggestions
> Best regards
> Els
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> Dear Els,
> 
> did you keep your dataset 'ndvi.stack' as read from disk? The function Navalues can only change values when reading your rasterStack object from disk. If you have your values in memory nothing will change applying your function.
> 
> Maybe this could help?
> 
> Best regards
> 
> Carsten
> 
> -- 
> 
> Carsten Neumann
> Telegrafenberg, A 17 01.13
> 14473 Potsdam
> -------------------------------------------------------
> Helmholtz Centre Potsdam
> GFZ German Research Centre for Geosciences
> Department 1 - Section 1.4 - Remote Sensing
> -------------------------------------------------------
> Tel.: +49 (0) 331 288 1766
> e-mail: carstenn at gfz-potsdam.de
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 


From r.turner at auckland.ac.nz  Tue Nov  8 23:19:20 2011
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Wed, 09 Nov 2011 11:19:20 +1300
Subject: [R-sig-Geo] Error message after updating spatstat
In-Reply-To: <8b5d6c0b-34df-cc9e-cc5b-c533cca89699@me.com>
References: <8b5d6c0b-34df-cc9e-cc5b-c533cca89699@me.com>
Message-ID: <4EB9AAE8.9010608@auckland.ac.nz>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111109/9b491fdd/attachment.pl>

From afischbach at usgs.gov  Wed Nov  9 01:56:42 2011
From: afischbach at usgs.gov (Anthony Fischbach)
Date: Tue, 8 Nov 2011 16:56:42 -0800 (PST)
Subject: [R-sig-Geo] SAS to R translation help wanted
Message-ID: <1320800202435-6976543.post@n2.nabble.com>

Satellite data collection has revolutionized our understanding of animal
movmement.  
Many relocations obtained by satellite data collection suffer large
inaccuracies and must be filtered.
Carla Freitas has contributed an algorithm for filtering such tracking data
(http://cran.r-project.org/web/packages/argosfilter/).  For years we have
used on an alternative algorithm written in SAS
(http://alaska.usgs.gov/science/biology/spatial/douglas.html).  To better
serve the wildlife tracking community, we wish to translate this Douglas
algorithm from SAS and offer it as a function in the 'argosfilter' R
package.

For this translation effort we wish to contract help.  
Interested parties, please contact me directly.

-----
Tony Fischbach, Wildlife Biologist
Walrus Research Program
Alaska Science Center
U.S. Geological Survey
4210 University Drive
Anchorage, AK 99508-4650

AFischbach at usgs.gov
http://alaska.usgs.gov/science/biology/walrus
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/SAS-to-R-translation-help-wanted-tp6976543p6976543.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From j.leonpatino at uq.edu.au  Wed Nov  9 09:07:06 2011
From: j.leonpatino at uq.edu.au (Javier Leon Patino)
Date: Wed, 9 Nov 2011 18:07:06 +1000
Subject: [R-sig-Geo] kriging and second order trend
Message-ID: <D8457815528063439E5066EE2475CF1C0A4D7DAA9D@UQEXMB04.soe.uq.edu.au>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111109/0bb545da/attachment.pl>

From mdsumner at gmail.com  Wed Nov  9 11:14:49 2011
From: mdsumner at gmail.com (Michael Sumner)
Date: Wed, 9 Nov 2011 00:14:49 -1000
Subject: [R-sig-Geo] SAS to R translation help wanted
In-Reply-To: <1320800202435-6976543.post@n2.nabble.com>
References: <1320800202435-6976543.post@n2.nabble.com>
Message-ID: <CAAcGz99p_geexscm=EQXVz-wCAw9D7qMPqNkXOOeHE5WH4anSQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111109/4b3a0db0/attachment.pl>

From raffaele.morelli at gmail.com  Wed Nov  9 11:37:15 2011
From: raffaele.morelli at gmail.com (Raffaele Morelli)
Date: Wed, 9 Nov 2011 11:37:15 +0100
Subject: [R-sig-Geo] bbox
Message-ID: <CAD4guxPzX9K8e+-+aq7Suc_k4Mtua4joJ4LxxjfiK7hy5MzoPw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111109/95484fff/attachment.pl>

From ksafi at orn.mpg.de  Wed Nov  9 11:38:37 2011
From: ksafi at orn.mpg.de (Kamran Safi)
Date: Wed, 09 Nov 2011 11:38:37 +0100
Subject: [R-sig-Geo] SAS to R translation help wanted
In-Reply-To: <CAAcGz99p_geexscm=EQXVz-wCAw9D7qMPqNkXOOeHE5WH4anSQ@mail.gmail.com>
References: <1320800202435-6976543.post@n2.nabble.com>
	<CAAcGz99p_geexscm=EQXVz-wCAw9D7qMPqNkXOOeHE5WH4anSQ@mail.gmail.com>
Message-ID: <4EBA582D.8000403@orn.mpg.de>

Hi Anthony,

if I am not mistaken, David already started to translate his filter into 
R. At least I know that he wanted to do so. If you really are keen, we 
could give it a try. On the other hand the filter was implemented in 
www.movebank.org
Theoretically, you can upload your data to movebank, filter it according 
to David's filter rules and get it back into R. The advantage being that 
your data is also standardised making it easier for you to recycle your 
code and you have a central repository of your data. Also you can feed 
the diag files to the data base.

We are currently thinking of ways to link movebank with R, so this might 
be even the better option. Let me know what you think or what would be 
most helpful to wildlife trackers.

Best,

Kami



Am 09.11.2011 11:14, schrieb Michael Sumner:
> These filters are easy to implement and are available in contributed R
> packages, but they are not very good. When you say "satellite"do you mean
> Argos or GPS?
>
> Argos recently updated their proprietary algorithms to give better
> estimates but it it is still a rather black box.To me the issue is about
> whether location accuracy of point samples or inference from derived
> metrics of location are more important.
>
>
> Both are very complicated and subject to active research.
>
> I can help you implement these filters but am very loathe to if it it is
> not for comparison-only purposes.
>
> The adehabitat family of packages has very modern methods of deriving
> metrics from track data.
>
> Cheers, Mike
>
>
> On Tuesday, November 8, 2011, Anthony Fischbach<afischbach at usgs.gov>  wrote:
>> Satellite data collection has revolutionized our understanding of animal
>> movmement.
>> Many relocations obtained by satellite data collection suffer large
>> inaccuracies and must be filtered.
>> Carla Freitas has contributed an algorithm for filtering such tracking
> data
>> (http://cran.r-project.org/web/packages/argosfilter/).  For years we have
>> used on an alternative algorithm written in SAS
>> (http://alaska.usgs.gov/science/biology/spatial/douglas.html).  To better
>> serve the wildlife tracking community, we wish to translate this Douglas
>> algorithm from SAS and offer it as a function in the 'argosfilter' R
>> package.
>>
>> For this translation effort we wish to contract help.
>> Interested parties, please contact me directly.
>>
>> -----
>> Tony Fischbach, Wildlife Biologist
>> Walrus Research Program
>> Alaska Science Center
>> U.S. Geological Survey
>> 4210 University Drive
>> Anchorage, AK 99508-4650
>>
>> AFischbach at usgs.gov
>> http://alaska.usgs.gov/science/biology/walrus
>> --
>> View this message in context:
> http://r-sig-geo.2731867.n2.nabble.com/SAS-to-R-translation-help-wanted-tp6976543p6976543.html
>> Sent from the R-sig-geo mailing list archive at Nabble.com.
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: ksafi.vcf
Type: text/x-vcard
Size: 149 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111109/7527d77d/attachment.vcf>

From tom.gottfried at tum.de  Wed Nov  9 11:52:45 2011
From: tom.gottfried at tum.de (Tom Gottfried)
Date: Wed, 9 Nov 2011 11:52:45 +0100
Subject: [R-sig-Geo] bbox
In-Reply-To: <CAD4guxPzX9K8e+-+aq7Suc_k4Mtua4joJ4LxxjfiK7hy5MzoPw@mail.gmail.com>
References: <CAD4guxPzX9K8e+-+aq7Suc_k4Mtua4joJ4LxxjfiK7hy5MzoPw@mail.gmail.com>
Message-ID: <4EBA5B7D.9090008@tum.de>

assuming your geometry column is 'the_geom': while querying

SELECT ... FROM ... WHERE the_geom @ ST_geomfromtext(...);

with ST_geomfromtext() you can set up your "custom bbox".
But of course you can load everything into R and then use subset() if your data are in a data.frame 
or use over() with e.g. a SpatialPointsDataFrame and a polygon representing your 30x30Km...

Once you have a specific question and some code showing what you actually already tried somebody 
will be able to give you a specific answer.

regards,
Tom

Am 09.11.2011 11:37, schrieb Raffaele Morelli:
> Hi,
>
> once a Postgis layer X is retrieved, how can I juggle with subsets of X?
>
> eg. I am working with bubble plots on a EU dataset but I want to do test it
> only using a 30x30Km in the nearby of Rome and I have no attribute data but
> the value I use for the bubbles. Should I use "subset"? Can I set a kinda
> of custom bbox?
>
> regards
> -r
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Technische Universit?t M?nchen
Department f?r Pflanzenwissenschaften
Lehrstuhl f?r Gr?nlandlehre
Alte Akademie 12
85350 Freising / Germany
Phone: ++49 (0)8161 715324
Fax:   ++49 (0)8161 713243
email: tom.gottfried at wzw.tum.de
http://www.wzw.tum.de/gruenland


From alobolistas at gmail.com  Wed Nov  9 14:35:09 2011
From: alobolistas at gmail.com (Agustin Lobo)
Date: Wed, 9 Nov 2011 14:35:09 +0100
Subject: [R-sig-Geo] prj file and towgs84 parameters
Message-ID: <CAG4NReJfTmffqu_Yf8oNtTBU_OztRsMeK4NrcSckLvkwRWdOug@mail.gmail.com>

I have two shapefile layers with identical prj file, but when I open
the first one
in QGIS Properties/General I see "EPSG:23031 - ED50 / UTM zone 31N"
defined as
+proj=utm +zone=31 +ellps=intl +towgs84=-87,-98,-121,0,0,0,0 +units=m +no_defs
(which is what I want)
while when I open the second one it indicates
"USER:100012 -  * Generated CRS (+proj=utm +zone=31 +ellps=intl
+units=m +no_defs)"
Where in the shapefile set is this information kept? I thought all CRS info was
included in the prj file.

I make the second layer in R and write it with writeOGR from an Sp Pol
DF which projection is correct (I think):
 > wpflPR201110_700SPDF at proj4string
CRS arguments:
 +proj=utm +zone=31 +ellps=intl +units=m +no_defs +towgs84=-87,-98,-121


Agus


From sandra.werb at googlemail.com  Wed Nov  9 14:55:10 2011
From: sandra.werb at googlemail.com (leni)
Date: Wed, 9 Nov 2011 05:55:10 -0800 (PST)
Subject: [R-sig-Geo] Export raster data as *.grd file format in ArcMap
Message-ID: <1320846910788-6978040.post@n2.nabble.com>

Hi, 

I want to with raster data generated from a 3D pointcloud in R with the
package "raster". But I have problems exporting my raster dataset from
ArcMap. By "export data"/GRID I get a file with an *.aux extension. What I
need is *.grd.


Can anybody help me out?

Cheers, 
Leni

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Export-raster-data-as-grd-file-format-in-ArcMap-tp6978040p6978040.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From mathieu.rajerison at gmail.com  Wed Nov  9 15:39:45 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Wed, 9 Nov 2011 15:39:45 +0100
Subject: [R-sig-Geo] [raster] substraction between two rasterLayers: error
	Readbin
Message-ID: <CAGfc75kZRtCohVgfJgg_6=NiTJW7_z8SSpDDr1Xq=sF2HJoqTw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111109/6f5cf421/attachment.pl>

From srabin at Princeton.EDU  Wed Nov  9 17:41:05 2011
From: srabin at Princeton.EDU (Sam Rabin)
Date: Wed, 9 Nov 2011 11:41:05 -0500
Subject: [R-sig-Geo] Calculating perimeter
In-Reply-To: <alpine.LRH.2.00.1111081830540.32630@reclus.nhh.no>
References: <DE9AA728-42E4-49CD-95FE-7E343312E391@Princeton.EDU>
	<alpine.LRH.2.00.1111081830540.32630@reclus.nhh.no>
Message-ID: <1DB5D69F-9ECA-4F7C-A7B9-C63A92AFEA10@Princeton.EDU>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111109/66849549/attachment.pl>

From carstennh at aol.com  Wed Nov  9 17:46:18 2011
From: carstennh at aol.com (Carsten Neumann)
Date: Wed, 09 Nov 2011 17:46:18 +0100
Subject: [R-sig-Geo] [raster] substraction between two rasterLayers:
 error Readbin
In-Reply-To: <CAGfc75kZRtCohVgfJgg_6=NiTJW7_z8SSpDDr1Xq=sF2HJoqTw@mail.gmail.com>
References: <CAGfc75kZRtCohVgfJgg_6=NiTJW7_z8SSpDDr1Xq=sF2HJoqTw@mail.gmail.com>
Message-ID: <4EBAAE5A.1030901@aol.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111109/0e483bcb/attachment.pl>

From moshersteven at gmail.com  Wed Nov  9 17:56:41 2011
From: moshersteven at gmail.com (steven mosher)
Date: Wed, 9 Nov 2011 08:56:41 -0800
Subject: [R-sig-Geo] problem with raster calculation
In-Reply-To: <CAC+VNxqWyBcZGLGDr5K6MHV9xymE4HaO9SPPvDypfN35w8tMEA@mail.gmail.com>
References: <CAC+VNxqWyBcZGLGDr5K6MHV9xymE4HaO9SPPvDypfN35w8tMEA@mail.gmail.com>
Message-ID: <CAFFLneRP-2YfGUyiEwKLK1P97OuWMcoiLoWZqRkR-qiuq3J1Zw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111109/5d5a6c6a/attachment.pl>

From r.hijmans at gmail.com  Wed Nov  9 18:37:37 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 9 Nov 2011 09:37:37 -0800
Subject: [R-sig-Geo] [raster] substraction between two rasterLayers:
	error Readbin
In-Reply-To: <CAGfc75kZRtCohVgfJgg_6=NiTJW7_z8SSpDDr1Xq=sF2HJoqTw@mail.gmail.com>
References: <CAGfc75kZRtCohVgfJgg_6=NiTJW7_z8SSpDDr1Xq=sF2HJoqTw@mail.gmail.com>
Message-ID: <CANtt_hxmuBM1Z3nhLJi1B=6J==nxQYMKyYsTTm2a1hgZTBFJmA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111109/94812a9b/attachment.pl>

From r.hijmans at gmail.com  Wed Nov  9 18:41:34 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 9 Nov 2011 09:41:34 -0800
Subject: [R-sig-Geo] [raster] substraction between two rasterLayers:
	error Readbin
In-Reply-To: <4EBAAE5A.1030901@aol.com>
References: <CAGfc75kZRtCohVgfJgg_6=NiTJW7_z8SSpDDr1Xq=sF2HJoqTw@mail.gmail.com>
	<4EBAAE5A.1030901@aol.com>
Message-ID: <CANtt_hyp8T8g9r_QX_dPJaJaovK916czOk6VP0UdJVZG-cp_EA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111109/29763c9e/attachment.pl>

From r.hijmans at gmail.com  Wed Nov  9 18:46:42 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 9 Nov 2011 09:46:42 -0800
Subject: [R-sig-Geo] Export raster data as *.grd file format in ArcMap
In-Reply-To: <1320846910788-6978040.post@n2.nabble.com>
References: <1320846910788-6978040.post@n2.nabble.com>
Message-ID: <CANtt_hwB5zC9dy6wPvz-b-dQahSkvEgqW1WVGYw+DgmyfjuQpQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111109/3e5dfba4/attachment.pl>

From pgalpern at gmail.com  Wed Nov  9 21:19:30 2011
From: pgalpern at gmail.com (pgalpern)
Date: Wed, 09 Nov 2011 14:19:30 -0600
Subject: [R-sig-Geo] Stack,
 brick (or other data object) to query large amounts of raster data
Message-ID: <4EBAE052.5010208@gmail.com>

Hello!

   Trying to decide the best way to store a large amount of data in a 
function I am writing using the raster package.

   The goal is speed.  I need to flexibly and efficiently handles cases 
where 10 to 5000 copies of a raster are required.  The raster that 
requires replication would typically vary in size from 400 to 4000 
pixels in each dimension.

   Fortunately I do not need to perform operations on these rasters, but 
need only to sequentially query values from them (this appears to be the 
rate limiting step).  What would be the most efficient data structure to 
handle this?

   The stack appears to work much faster than a brick in limited 
trials.  Would it be more efficient to use another data structure 
altogether (data is not sparse).  Obviously in many cases this is going 
to require disk swapping.  Any ideas?

Thanks,
Paul

-- 
Paul Galpern, PhD Candidate
Natural Resources Institute
70 Dysart Road
University of Manitoba
Winnipeg, Manitoba, Canada R3T 2M6
http://borealscape.ca


From M.Boer at uws.edu.au  Thu Nov 10 08:12:29 2011
From: M.Boer at uws.edu.au (Matthias Boer)
Date: Thu, 10 Nov 2011 07:12:29 +0000
Subject: [R-sig-Geo] plotting raster* objects: controlling the display scale
Message-ID: <C9FBB6D3ADA39747AC19D5036B08851918A9ED2E@HAYES.AD.UWS.EDU.AU>

Hi

I am plotting series of raster* objects with 'plot'. The raster* objects are change maps with variable scales. 
I want to plot them all with the same scale centred on zero such that it's easy to see where there is a positive or negative response. 
I am using zlim=c(display_min,display_max) to set the display scale but 'plot' seem to ignore these zlim settings when e.g. display_min is smaller than the minimum value in the raster* object, or display_max is larger than the maximum value in the raster. 'Image' does keep the specified zlim values.

# For example:
> fqr050pet110.dif
class       : RasterLayer 
dimensions  : 674, 818, 551332  (nrow, ncol, ncell)
resolution  : 0.05, 0.05  (x, y)
extent      : 112.825, 153.725, -43.725, -10.025  (xmin, xmax, ymin, ymax)
coord. ref. : NA 
values      : in memory
min value   : -0.02103391 
max value   : 0.03608033

# If I then use 'plot' with display interval from -0.1 to +0.1
plot(fqr050pet110.dif,col = rev(terrain.colors(100)),zlim=c(-0.1,0.1)) 

# the raster is plotted with the actual raster min and max value as the display interval.
# The same settings with 'image' does use the specified zlim. 

Is it possible to force 'plot' to scale the display according to the specified zlim?

Thanks for your time.

Matthias

----------------------------------------


Dr Matthias M Boer
Hawkesbury Institute for the Environment
University of Western Sydney

P: +61-(0)2-4570-1373 (direct)
P: +61-(0)2-4570-1941 (admin)
E: m.boer at uws.edu.au

Postal address: 
Locked Bag 1797, Penrith South DC 
NSW 1797 AUSTRALIA


From mathieu.rajerison at gmail.com  Thu Nov 10 08:38:26 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Thu, 10 Nov 2011 08:38:26 +0100
Subject: [R-sig-Geo] [raster] substraction between two rasterLayers:
	error Readbin
In-Reply-To: <CANtt_hyp8T8g9r_QX_dPJaJaovK916czOk6VP0UdJVZG-cp_EA@mail.gmail.com>
References: <CAGfc75kZRtCohVgfJgg_6=NiTJW7_z8SSpDDr1Xq=sF2HJoqTw@mail.gmail.com>
	<4EBAAE5A.1030901@aol.com>
	<CANtt_hyp8T8g9r_QX_dPJaJaovK916czOk6VP0UdJVZG-cp_EA@mail.gmail.com>
Message-ID: <CAGfc75=zbaKQiDpSQxh4_hPZSV3dRD6iz9YMKpFsZUsySg3OQQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111110/dd126121/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Thu Nov 10 13:59:50 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Thu, 10 Nov 2011 12:59:50 +0000
Subject: [R-sig-Geo] plotting raster* objects: controlling the display
	scale
In-Reply-To: <C9FBB6D3ADA39747AC19D5036B08851918A9ED2E@HAYES.AD.UWS.EDU.AU>
References: <AcyfeBs81YY0Z1gKRSKFqd1BbfnlIw==>
	<C9FBB6D3ADA39747AC19D5036B08851918A9ED2E@HAYES.AD.UWS.EDU.AU>
Message-ID: <CANVKczM1YpNbbocP-CWYM=2HOWas-M4cUFN+y6=CiagiTM86vw@mail.gmail.com>

> Is it possible to force 'plot' to scale the display according to the specified zlim?

 I've just had a fairly deep look at the code and (pending response
from the master himself) I don't think you can.

 I assume the reason you want to do it is to get the nice legend? The
code for that is in raster:::.imageplot, and it gets the range
directly from the raster, bypassing any zlim arguments (which are
ignored by plot, as you notice). You can get round that ignoring by
going straight to .imageplot:

 f1=raster(matrix(runif(100),10,10))    # range (0,1)
 f2=raster(matrix(1+runif(100),10,10)) # range(1,2)
 par(mfrow=c(1,2))
 raster:::.imageplot(1:10,1:10,t(as.matrix(f1)),zlim=c(0,2))
 raster:::.imageplot(1:10,1:10,t(as.matrix(f2)),zlim=c(0,2))

that does the plots in the right colours for a zlim of 0,2, but the
legends are wrong, and at that point you may as well just use image:

 image(f1,zlim=c(0,2))
 image(f2,zlim=c(0,2))

 and then do a legend by a bit of bodging with .imageplot:

raster:::.imageplot(1:2,1:2,c(0,2),zlim=c(0,2),legend.only=TRUE)

some tweaking needed to get it in the right position....

This is all horrible hackery. The real answer will, I don't doubt,
follow shortly...

Barry


From jan.blanke at gmx.de  Thu Nov 10 16:37:38 2011
From: jan.blanke at gmx.de (Jan Hendrik Blanke)
Date: Thu, 10 Nov 2011 16:37:38 +0100
Subject: [R-sig-Geo] gdistance, least cost path in R
Message-ID: <20111110153738.268120@gmx.net>

Hello together,

I would like to conduct a least cost path analysis in R that would deliver the same results than GRASS GIS (r.cost followed by r.drain) or ArcGIS (Cost Distance followed by Cost Path, both Spatial Analyst). For that purpose, I created a raster with  cost values ranging from 1 to 8; the starting and stop points are from the class SpatialPointsDataFrame.

I used the package gdistance now to calculate the path with the least costs from source to destination but could not manage to get the same results than GRASS GIS and ArcGIS. Gdistance uses a transition layer instead of an accumulative cost grid. For the latter one an iterative process is used that begins with the source cells. The transition layer instead is calculated by a transition function that calculates transition values from grid values (e.g. mean).

I guess the problem lies in the creation of the transition layer with transitionFunction. I am not sure which function I would need to use. In addition, I am wondering how the transition layer could be similar to the accumulative cost grid as the transition layer does not calculate the values starting from a source cell.

I would really appreciate if you could give me any hints on how to achieve the same results in R. Thank you very much for your efforts.

Kind regards,

Jan 
--


From rossiter at itc.nl  Thu Nov 10 17:01:14 2011
From: rossiter at itc.nl (D G Rossiter)
Date: Thu, 10 Nov 2011 17:01:14 +0100
Subject: [R-sig-Geo] Course announcement: Geostatistics & Open-source
	statistical computing
Message-ID: <C9EC1FDF-27EB-4424-ABF7-0EC15BB5C662@itc.nl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111110/0ae702bb/attachment.pl>

From jacobvanetten at yahoo.com  Thu Nov 10 18:12:06 2011
From: jacobvanetten at yahoo.com (Jacob van Etten)
Date: Thu, 10 Nov 2011 17:12:06 +0000 (GMT)
Subject: [R-sig-Geo] gdistance, least cost path in R
In-Reply-To: <20111110153738.268120@gmx.net>
References: <20111110153738.268120@gmx.net>
Message-ID: <1320945126.30693.YahooMailNeo@web29707.mail.ird.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111110/5ad1316f/attachment.pl>

From aortizbobea at arec.umd.edu  Thu Nov 10 19:28:00 2011
From: aortizbobea at arec.umd.edu (Ariel Ortiz-Bobea)
Date: Thu, 10 Nov 2011 10:28:00 -0800 (PST)
Subject: [R-sig-Geo] How to quickly add many raster layers to a thick
	RasterStack?
In-Reply-To: <CANtt_hzPbLxnL5Z-ao2dsVeKnaju_Y8gz+UgFGL5pic03zuwTg@mail.gmail.com>
References: <1320191179382-6953662.post@n2.nabble.com>
	<CANtt_hzXqmLs-2qeX0Q-ghg1132=2ZxdEgN0SJKUkjjFEUHMug@mail.gmail.com>
	<CANtt_hzPbLxnL5Z-ao2dsVeKnaju_Y8gz+UgFGL5pic03zuwTg@mail.gmail.com>
Message-ID: <E7C57FAA7891B94DBA265B591642DE25D16026CFA7@mail.arec.umd.edu>

Thanks Robert,

This works fairly well and the direct access is much faster. I just need to manually specify the extent and projection.

Each file has several bands and I should specify which band I'll be importing (otherwise I only import the first band) this way:

r <- raster(f[1], band=2) # for example

Thanks!

AOB

---
Ariel Ortiz-Bobea
PhD Candidate, Agricultural & Resource Economics
University of Maryland - College Park
________________________________________
From: Robert Hijmans [via R-sig-geo] [ml-node+s2731867n6971221h77 at n2.nabble.com]
Sent: Monday, November 07, 2011 12:14 PM
To: Ariel Ortiz Bobea
Subject: Re: How to quickly add many raster layers to a thick RasterStack?

correction, it should be:

s at layers <- sapply(f, function(x) { r at file@name=x; r } )

On Sun, Nov 6, 2011 at 11:04 PM, Robert J. Hijmans <[hidden email]</user/SendEmail.jtp?type=node&node=6971221&i=0>>wrote:

> Ariel,
>
> Whether you do stack or addLayer, each file needs to be inspected by gdal
> to get its georeference etc.
> You can shortcut the process if you already know this, because all you
> files have the same parameters. For example with a (do not try this at
> home, all kinds of things can go wrong, but it might work in this case)
> hack like this:
>
> f <- list.files()
> r <- raster(f[1])
> s <- stack(r)
> s at layers <- sapply(f, function(x) { r at file@name=f; r } )
>
> Also, you may want to group your data in files that have multiple layers,
> e.g. GTiff or ncdf. That would make it faster to create Raster* objects
> from these files, and data access should also be much faster; although I am
> not sure what the optimal number of layers would be (90000 may be too many
> layers per file for optimal data access; but you might try ncdf for that).
>
> ss = writeRaster(s, 'test.nc')
>
> Robert
>
>
>
> On Tue, Nov 1, 2011 at 4:46 PM, Ariel Ortiz-Bobea <
> [hidden email]</user/SendEmail.jtp?type=node&node=6971221&i=1>> wrote:
>
>> Hello everyone,
>>
>> I have about 90,000 individual grid files in GRIB format I'm importing and
>> converting to raster format in R.
>>
>> Some of the calculations I need to do (clipping with polygons... thanks
>> Robert J. Hijmans for valuable advice on this!) are best performed on many
>> raster layers at once, e.g. over a RasterStack.
>>
>> I have tried "stack()" and "addLayer()" commands. "stack" seems to read
>> all
>> objects in the command line slowing the process down more than
>> proportionately to object size (see code below) which I suppose explains
>> how
>> "addLayer" came about. However, the time it takes "addLayer" to add an
>> additional layer is roughly proportional to the size of the RasterStack it
>> is being added to... so when I have very "thick" stacks/bricks adding an
>> extra layer takes some time.
>>
>> Would there be an alternative way to combine many multi-band raster layers
>> more quickly (in R or outside of R) from many individual files and still
>> manage to keep things orderly, i.e. being able to identify specific layers
>> afterwards?
>>
>> Any thoughts would be greatly appreciated.
>>
>> Ariel
>>
>> #---------------
>> # setup
>>        library(raster)
>>        r <- raster(ncol=139, nrow=97)
>>        r[] <- 1:ncell(r)
>>
>>        # stack command
>>        s1<-r
>>        t1<- c()
>>        while (nlayers(s1)<=200) {
>>                print(nlayers(s1))
>>                timer1 <- system.time( {
>>                        s1 <- stack(s1,r)
>>                        })
>>                        t1 <- rbind(t1,timer1[3] )
>>                }
>>
>>        # addLayer command
>>        s2<-r
>>        t2<- c()
>>        while (nlayers(s2)<=200) {
>>                print(nlayers(s2))
>>                timer2 <- system.time( {
>>                        s2 <- addLayer(s2,r)
>>                        })
>>                        t2 <- rbind(t2,timer2[3] )
>>                }
>>
>>        # visualize
>>        plot(1:200,t1, type="l", xlab="# of layers in object", ylab="time
>> for
>> adding extra layer (s)")
>>        lines(1:200,t2,col="blue")
>>
>>        plot(1:200,t2, type="l", col="blue", xlab="# of layers in object",
>> ylab="time for adding extra layer (s)")
>>
>>
>>
>> -----
>> Ariel Ortiz-Bobea
>> PhD Candidate in Agricultural & Resource Economics
>> University of Maryland - College Park
>> --
>> View this message in context:
>> http://r-sig-geo.2731867.n2.nabble.com/How-to-quickly-add-many-raster-layers-to-a-thick-RasterStack-tp6953662p6953662.html
>> Sent from the R-sig-geo mailing list archive at Nabble.com.
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> [hidden email]</user/SendEmail.jtp?type=node&node=6971221&i=2>
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>

        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
[hidden email]</user/SendEmail.jtp?type=node&node=6971221&i=3>
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


________________________________
If you reply to this email, your message will be added to the discussion below:
http://r-sig-geo.2731867.n2.nabble.com/How-to-quickly-add-many-raster-layers-to-a-thick-RasterStack-tp6953662p6971221.html
To unsubscribe from How to quickly add many raster layers to a thick RasterStack?, click here<http://r-sig-geo.2731867.n2.nabble.com/template/NamlServlet.jtp?macro=unsubscribe_by_code&node=6953662&code=YW9ydGl6Ym9iZWFAYXJlYy51bWQuZWR1fDY5NTM2NjJ8LTYxMzExNzA2NQ==>.


-----
Ariel Ortiz-Bobea
PhD Candidate in Agricultural & Resource Economics
University of Maryland - College Park
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/How-to-quickly-add-many-raster-layers-to-a-thick-RasterStack-tp6953662p6982713.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From edzer.pebesma at uni-muenster.de  Fri Nov 11 08:59:31 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 11 Nov 2011 08:59:31 +0100
Subject: [R-sig-Geo] sim kriging
In-Reply-To: <D8457815528063439E5066EE2475CF1C0A4D7DAB31@UQEXMB04.soe.uq.edu.au>
References: <D8457815528063439E5066EE2475CF1C0A4D7DAB31@UQEXMB04.soe.uq.edu.au>
Message-ID: <4EBCD5E3.7030507@uni-muenster.de>

On 11/11/2011 02:25 AM, Javier Leon Patino wrote:

> 1. I would like to remove a quadratic trend from my elevation dataset before ordinary kriging. Maybe using surf.ls?
> 
> Would the following work (Z is elevation in file ahd)?:
> 
> depth.ok <- krige(ahd~Z, shp, mask, depth.vgm)

this would do universal kriging (external kriging, regression kriging)
with a first order linear trend in Z. It means that the trend is not
removed as such, but is modelled as a first order linear function in Z,
and that depth.vgm should be the variogram of residuals wrt this function.

depth.ok2 = krige(ahd~Z+I(Z^2), shp, mask, depth.vgm)

would do this wrt to a second order (quadratic) trend, but depth.vgm
should again be the variogram of residuals from such a model.

specifying such models in calls to variogram() indeed gives you the
variogram of residuals (computed, by default, using OLS).

> 
> 
> 
> 2. How do I write simulation kriging to ascii? I am using:
>  
> depth.ok <- krige(ahd~1, shp, mask, depth.vgm, nsim=2, nmax=10)
> for (i in 1:length(depth.ok)) {
> 	write.asciigrid(depth.ok[i], c(paste("DEMair",as.character(i),".asc",sep="")))
>  }
> 

length(depth.ok) gives you the number of grid cells depth.ok has, use
ncol(depth.ok) to obtain the number of "layers", or attribute variables,
it has.

> Ascii grids seem fine but I get the following error:
> 
>> Error in gridded(x) : 
>>
>> error in evaluating the argument 'obj' in selecting a method for 
>> function 'gridded': Error in `[.data.frame`(x at data, , i, drop = FALSE) 
>> :
>>
>> undefined columns selected
> 
> 
> Thank you very much for your help. These two issues have stopped my work for more than a week now!
> 
> Cheers,
> 
> Javier
> 
> 
> Dr Javier Leon
> Post-doctoral Research Fellow
> 
> Global Change Institute/
> Centre for Spatial Environmental Research (CSER)
>  
> The University of Queensland
> Gehrmann Laboratories (60) 
> The University of Queensland 
> St Lucia QLD 4072 Australia
> Ph: (+61 7) 3346 7074   
> Fax: (+61 7) 3346 3299
> email: j.leonpatino at uq.edu.au
> http://www.gpem.uq.edu.au/javier-leon-patino
> 
> 
> 


-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From hengl at spatial-analyst.net  Fri Nov 11 10:29:43 2011
From: hengl at spatial-analyst.net (Tomislav Hengl)
Date: Fri, 11 Nov 2011 10:29:43 +0100
Subject: [R-sig-Geo] Course announcement: Geostatistics & Open-source
 statistical computing
In-Reply-To: <C9EC1FDF-27EB-4424-ABF7-0EC15BB5C662@itc.nl>
References: <C9EC1FDF-27EB-4424-ABF7-0EC15BB5C662@itc.nl>
Message-ID: <4EBCEB07.1050509@spatial-analyst.net>


Hi David,

If this can be of any help, at GEOSTAT we started recording/broadcasting 
all lectures (this was an excellent idea of Ralf Sch?fer and his team at 
Landau). We used the software called Team Viewer 
(http://www.teamviewer.com/en/download/tv6.aspx). The result was pretty 
good:

http://www.archive.org/search.php?query=GEOSTAT%20Landau

*as far as I remember, we did not even buy any license. You only need 1 
extra PC, a web-cam and a wireless mic. This is really a minor 
investment all together.

At the next GEOSTAT summer school we will try even harder to provide 
high quality broadcast (and public access of course).

(and thanks for preparing all those materials - I did already hear many 
good stories about your course).

cheers,

T. Hengl
http://www.wewur.wur.nl/popups/vcard.aspx?id=HENGL001

On 10-11-2011 17:01, D G Rossiter wrote:
> Announcement:
>
> For the 6th consecutive year I am offering a 6-week distance
> education course "Geostatistics&  Open-source statistical computing"
> at the Faculty of Geo-Information Science and Earth Observation
> (commonly known as ITC) of the University of Twente, Netherlands,
> from 23-Jan-2012. This is a 5 ECTS certificate course, aimed at
> postgraduate students and working professionals who wish to apply
> spatial statistics and geostatistical computing in research and
> consulting projects, who can dedicate half of their time over the six
> weeks to the course. All exercises are in R, mainly using gstat for
> the geostatistics. All the course material is freely available for
> your inspection and use at
> http://www.itc.nl/personal/rossiter/teach/degeostats.html -- some of
> this will be updated/expanded for the 2012 course. If you want the
> answers to the end-of-lesson tests, if you want personal guidance, if
> you want to participate in discussions on the bulletin board, or if
> you want to do a supervised i! ndividual project, you must sign up
> (and pay for) for the course. Registration deadline is 02-Dec-2011,
> payment deadline beginning of course. Thanks for looking, it may be
> just what you or one of your students/colleagues would enjoy.
>
>
> D. G. Rossiter
>
> Senior University Lecturer
>
> University of Twente, Faculty ITC
>
> Hengelosestraat 99
>
> PO Box 217, 7500 AE Enschede, the Netherlands (NL)
>
> mailto:rossiter at itc.nl<mailto:rossiter at itc.nl>,  Internet:
> http://www.itc.nl/personal/rossiter
>
>
>
>
> ________________________________ Faculty of Geo-Information Science
> and Earth Observation (ITC) University of Twente Chamber of Commerce:
> 501305360000
>
> E-mail disclaimer The information in this e-mail, including any
> attachments, is intended for the addressee only. If you are not the
> intended recipient, you are hereby notified that any disclosure,
> copying, distribution or action in relation to the content of this
> information is strictly prohibited. If you have received this e-mail
> by mistake, please delete the message and any attachment and inform
> the sender by return e-mail. ITC accepts no liability for any error
> or omission in the message content or for damage of any kind that may
> arise as a result of e-mail transmission.
>
> [[alternative HTML version deleted]]
>
> _______________________________________________ R-sig-Geo mailing
> list R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From hengl at spatial-analyst.net  Fri Nov 11 10:29:43 2011
From: hengl at spatial-analyst.net (Tomislav Hengl)
Date: Fri, 11 Nov 2011 10:29:43 +0100
Subject: [R-sig-Geo] Course announcement: Geostatistics & Open-source
 statistical computing
In-Reply-To: <C9EC1FDF-27EB-4424-ABF7-0EC15BB5C662@itc.nl>
References: <C9EC1FDF-27EB-4424-ABF7-0EC15BB5C662@itc.nl>
Message-ID: <4EBCEB07.1050509@spatial-analyst.net>


Hi David,

If this can be of any help, at GEOSTAT we started recording/broadcasting 
all lectures (this was an excellent idea of Ralf Sch?fer and his team at 
Landau). We used the software called Team Viewer 
(http://www.teamviewer.com/en/download/tv6.aspx). The result was pretty 
good:

http://www.archive.org/search.php?query=GEOSTAT%20Landau

*as far as I remember, we did not even buy any license. You only need 1 
extra PC, a web-cam and a wireless mic. This is really a minor 
investment all together.

At the next GEOSTAT summer school we will try even harder to provide 
high quality broadcast (and public access of course).

(and thanks for preparing all those materials - I did already hear many 
good stories about your course).

cheers,

T. Hengl
http://www.wewur.wur.nl/popups/vcard.aspx?id=HENGL001

On 10-11-2011 17:01, D G Rossiter wrote:
> Announcement:
>
> For the 6th consecutive year I am offering a 6-week distance
> education course "Geostatistics&  Open-source statistical computing"
> at the Faculty of Geo-Information Science and Earth Observation
> (commonly known as ITC) of the University of Twente, Netherlands,
> from 23-Jan-2012. This is a 5 ECTS certificate course, aimed at
> postgraduate students and working professionals who wish to apply
> spatial statistics and geostatistical computing in research and
> consulting projects, who can dedicate half of their time over the six
> weeks to the course. All exercises are in R, mainly using gstat for
> the geostatistics. All the course material is freely available for
> your inspection and use at
> http://www.itc.nl/personal/rossiter/teach/degeostats.html -- some of
> this will be updated/expanded for the 2012 course. If you want the
> answers to the end-of-lesson tests, if you want personal guidance, if
> you want to participate in discussions on the bulletin board, or if
> you want to do a supervised i! ndividual project, you must sign up
> (and pay for) for the course. Registration deadline is 02-Dec-2011,
> payment deadline beginning of course. Thanks for looking, it may be
> just what you or one of your students/colleagues would enjoy.
>
>
> D. G. Rossiter
>
> Senior University Lecturer
>
> University of Twente, Faculty ITC
>
> Hengelosestraat 99
>
> PO Box 217, 7500 AE Enschede, the Netherlands (NL)
>
> mailto:rossiter at itc.nl<mailto:rossiter at itc.nl>,  Internet:
> http://www.itc.nl/personal/rossiter
>
>
>
>
> ________________________________ Faculty of Geo-Information Science
> and Earth Observation (ITC) University of Twente Chamber of Commerce:
> 501305360000
>
> E-mail disclaimer The information in this e-mail, including any
> attachments, is intended for the addressee only. If you are not the
> intended recipient, you are hereby notified that any disclosure,
> copying, distribution or action in relation to the content of this
> information is strictly prohibited. If you have received this e-mail
> by mistake, please delete the message and any attachment and inform
> the sender by return e-mail. ITC accepts no liability for any error
> or omission in the message content or for damage of any kind that may
> arise as a result of e-mail transmission.
>
> [[alternative HTML version deleted]]
>
> _______________________________________________ R-sig-Geo mailing
> list R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From rossiter at itc.nl  Fri Nov 11 14:03:18 2011
From: rossiter at itc.nl (D G Rossiter)
Date: Fri, 11 Nov 2011 14:03:18 +0100
Subject: [R-sig-Geo] Course announcement: Geostatistics & Open-source
	statistical computing
In-Reply-To: <mailman.11.1321009203.5196.r-sig-geo@r-project.org>
References: <mailman.11.1321009203.5196.r-sig-geo@r-project.org>
Message-ID: <0F338326-14CD-4A8F-930A-F0B39C9EF481@itc.nl>

Tom,

Thanks for the information.

I guess there are different learning styles. I do not enjoy watching video lectures so I don't inflict them on the students in my distance education course that I am publicizing here (http://www.itc.nl/personal/rossiter/teach/degeostats.html). I don't even watch "professional" lectures such as TED. In my course I do have short motivational videos of about 3 minutes per lesson (8 of these) just so people can feel they know me, but then everything is by slides that they study at their own pace, with self-study questions every few slides (with answers hyperlinked in the PDF -- prepared with PDFLaTeX and package hypperef, of course) to check that they are on the right track. For me, distance education is by its nature asychronic, which is nice for people who have different speeds or techniques of learning/reviewing. That's why the course puts so much emphasis on the R exercises.

Maybe it's because I don't like the sound of my own voice nor the looks of my own face... "on the internet, no one knows you're a dog" as the New Yorker cartoon had it.


David Rossiter
http://www.itc.nl/personal/rossiter

On 11 Nov2011, at 12:00, r-sig-geo-request at r-project.org wrote:

> Date: Fri, 11 Nov 2011 10:29:43 +0100
> From: Tomislav Hengl <hengl at spatial-analyst.net>
> To: "r-sig-geo at stat.math.ethz.ch" <r-sig-geo at stat.math.ethz.ch>
> Cc: r-sig-geo at r-project.org
> Subject: Re: [R-sig-Geo] Course announcement: Geostatistics &
>        Open-source statistical computing
> Message-ID: <4EBCEB07.1050509 at spatial-analyst.net>
> Content-Type: text/plain; charset="UTF-8"; format=flowed
>
>
> Hi David,
>
> If this can be of any help, at GEOSTAT we started recording/broadcasting
> all lectures (this was an excellent idea of Ralf Sch?fer and his team at
> Landau). We used the software called Team Viewer
> (http://www.teamviewer.com/en/download/tv6.aspx). The result was pretty
> good:
>
> http://www.archive.org/search.php?query=GEOSTAT%20Landau
>
> *as far as I remember, we did not even buy any license. You only need 1
> extra PC, a web-cam and a wireless mic. This is really a minor
> investment all together.
>
> At the next GEOSTAT summer school we will try even harder to provide
> high quality broadcast (and public access of course).
>
> (and thanks for preparing all those materials - I did already hear many
> good stories about your course).
>
> cheers,
>
> T. Hengl
> http://www.wewur.wur.nl/popups/vcard.aspx?id=HENGL001






Faculty of Geo-Information Science and Earth Observation (ITC)
University of Twente
Chamber of Commerce: 501305360000

E-mail disclaimer
The information in this e-mail, including any attachments, is intended for the addressee only. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution or action in relation to the content of this information is strictly prohibited. If you have received this e-mail by mistake, please delete the message and any attachment and inform the sender by return e-mail. ITC accepts no liability for any error or omission in the message content or for damage of any kind that may arise as a result of e-mail transmission.


From corrie.curtice at duke.edu  Fri Nov 11 21:54:09 2011
From: corrie.curtice at duke.edu (Corrie Curtice)
Date: Fri, 11 Nov 2011 15:54:09 -0500
Subject: [R-sig-Geo] write/readOGR issue with date / time strings
Message-ID: <CAE2F5A1.C926%corrie.curtice@duke.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111111/336366a7/attachment.pl>

From Roger.Bivand at nhh.no  Fri Nov 11 23:31:23 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 11 Nov 2011 23:31:23 +0100 (CET)
Subject: [R-sig-Geo] write/readOGR issue with date / time strings
In-Reply-To: <CAE2F5A1.C926%corrie.curtice@duke.edu>
References: <CAE2F5A1.C926%corrie.curtice@duke.edu>
Message-ID: <alpine.LRH.2.00.1111112326200.17758@reclus.nhh.no>

On Fri, 11 Nov 2011, Corrie Curtice wrote:

> Hello,
>
> Apologies if this has already been addressed somewhere, I did a brief search
> of archives but didn't find quite this issue.

Which versions of what are you using? You should provide the output of 
sessionInfo(), the messages given when rgdal loads, and details of how you 
installed rgdal. In addition, a use case would be helpful, but only when 
we know what version you are using. In current rgdal, data frame columns 
of class POSIXt are converted to character strings before writing with 
writeOGR().

Roger

>
> I'm writing out an ESRI shapefile.  My spdf has a date/time field.  Looks
> like this:
>
>> head(spdfUTM at data)
>           krillGMTtime          Lat          Lon
> 1   2010-05-12 12:34:21 -64.67655969 -62.15040195
> 21  2010-05-12 12:35:12  -64.6771229  -62.1519511
> 38  2010-05-12 12:36:02 -64.67775863 -62.15340614
> 57  2010-05-12 12:36:53 -64.67838269 -62.15494829
> 78  2010-05-12 12:37:43 -64.67901497 -62.15647203
> 100 2010-05-12 12:38:37 -64.67973667 -62.15773224
>
> All three fields are reported to be "factors" by str.  writeOGR appears
> happy:
>
>> writeOGR(spdfUTM,dd,layer="krillPoints-UTM",driver="ESRI
> Shapefile",verbose=TRUE,overwrite=TRUE)
> $object_type
> [1] "SpatialPointsDataFrame"
> $output_dsn
> [1] "/users/corriecurtice/documents/Data_2010/Shapefiles/"
> $output_layer
> [1] "krillPoints-UTM"
> $output_diver
> [1] "ESRI Shapefile"
> $output_n
> [1] 11179
> $output_nfields
> [1] 3
> $output_fields
> [1] "krillGMTtime" "Lat"          "Lon"
> $output_fclasses
> [1] 4 4 4
> $dataset_options
> NULL
> $layer_options
> NULL
> Warning message:
> In writeOGR(spdfUTM, dd, layer = "krillPoints-UTM", driver = "ESRI
> Shapefile",  :
>  existing layer removed
>
> When I read it right back in again, the date/time field is NAs.  This is
> also true if I load the shapefile into ArcMap.
>
>> foo <- readOGR(dd,layer="krillPoints-UTM",verbose=TRUE)
> OGR data source with driver: ESRI Shapefile
> Source: "/users/corriecurtice/documents/Data_2010/Shapefiles/", layer:
> "krillPoints-UTM"
> with 11179 features and 3 fields
> Feature type: wkbPoint with 2 dimensions
>
>> head(foo at data)
>  krillGMTti          Lat          Lon
> 1       <NA> -64.67655969 -62.15040195
> 2       <NA>  -64.6771229  -62.1519511
> 3       <NA> -64.67775863 -62.15340614
> 4       <NA> -64.67838269 -62.15494829
> 5       <NA> -64.67901497 -62.15647203
> 6       <NA> -64.67973667 -62.15773224
>
> Thoughts? Am I missing something obvious?
>
> I can break it up into separate date and time fields, but since the field is
> simply a factor anyways I'm not sure how that would help.
>
> Cheers,
>
> Corrie
>
> ---
> Corrie Curtice
> Research Analyst
> Marine Geospatial Ecology Lab
> Nicholas School of the Environment, Duke University
> http://mgel.env.duke.edu
> em: corrie.curtice at duke.edu
> ph: 252-504-7538
>
>
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From corrie.curtice at duke.edu  Sat Nov 12 00:16:27 2011
From: corrie.curtice at duke.edu (Corrie Curtice)
Date: Fri, 11 Nov 2011 18:16:27 -0500
Subject: [R-sig-Geo] write/readOGR issue with date / time strings
In-Reply-To: <alpine.LRH.2.00.1111112326200.17758@reclus.nhh.no>
Message-ID: <CAE3163D.C92A%corrie.curtice@duke.edu>


> sessionInfo()
R version 2.13.1 (2011-07-08)
Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)

locale:
[1] C/en_US.UTF-8/C/C/C/C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] rgdal_0.7-1 sp_0.9-84

loaded via a namespace (and not attached):
[1] grid_2.13.1     lattice_0.19-30 tools_2.13.1

I installed rgdal and PROJ4 as follows:

setRepositories(ind=1:2)
install.packages("rgdal")
install.packages("PROJ.4")



Thanks,

Corrie



On 11/11/11 5:31 PM, "Roger Bivand" <Roger.Bivand at nhh.no> wrote:

>On Fri, 11 Nov 2011, Corrie Curtice wrote:
>
>> Hello,
>>
>> Apologies if this has already been addressed somewhere, I did a brief
>>search
>> of archives but didn't find quite this issue.
>
>Which versions of what are you using? You should provide the output of
>sessionInfo(), the messages given when rgdal loads, and details of how
>you 
>installed rgdal. In addition, a use case would be helpful, but only when
>we know what version you are using. In current rgdal, data frame columns
>of class POSIXt are converted to character strings before writing with
>writeOGR().
>
>Roger
>
>>
>> I'm writing out an ESRI shapefile.  My spdf has a date/time field.
>>Looks
>> like this:
>>
>>> head(spdfUTM at data)
>>           krillGMTtime          Lat          Lon
>> 1   2010-05-12 12:34:21 -64.67655969 -62.15040195
>> 21  2010-05-12 12:35:12  -64.6771229  -62.1519511
>> 38  2010-05-12 12:36:02 -64.67775863 -62.15340614
>> 57  2010-05-12 12:36:53 -64.67838269 -62.15494829
>> 78  2010-05-12 12:37:43 -64.67901497 -62.15647203
>> 100 2010-05-12 12:38:37 -64.67973667 -62.15773224
>>
>> All three fields are reported to be "factors" by str.  writeOGR appears
>> happy:
>>
>>> writeOGR(spdfUTM,dd,layer="krillPoints-UTM",driver="ESRI
>> Shapefile",verbose=TRUE,overwrite=TRUE)
>> $object_type
>> [1] "SpatialPointsDataFrame"
>> $output_dsn
>> [1] "/users/corriecurtice/documents/Data_2010/Shapefiles/"
>> $output_layer
>> [1] "krillPoints-UTM"
>> $output_diver
>> [1] "ESRI Shapefile"
>> $output_n
>> [1] 11179
>> $output_nfields
>> [1] 3
>> $output_fields
>> [1] "krillGMTtime" "Lat"          "Lon"
>> $output_fclasses
>> [1] 4 4 4
>> $dataset_options
>> NULL
>> $layer_options
>> NULL
>> Warning message:
>> In writeOGR(spdfUTM, dd, layer = "krillPoints-UTM", driver = "ESRI
>> Shapefile",  :
>>  existing layer removed
>>
>> When I read it right back in again, the date/time field is NAs.  This is
>> also true if I load the shapefile into ArcMap.
>>
>>> foo <- readOGR(dd,layer="krillPoints-UTM",verbose=TRUE)
>> OGR data source with driver: ESRI Shapefile
>> Source: "/users/corriecurtice/documents/Data_2010/Shapefiles/", layer:
>> "krillPoints-UTM"
>> with 11179 features and 3 fields
>> Feature type: wkbPoint with 2 dimensions
>>
>>> head(foo at data)
>>  krillGMTti          Lat          Lon
>> 1       <NA> -64.67655969 -62.15040195
>> 2       <NA>  -64.6771229  -62.1519511
>> 3       <NA> -64.67775863 -62.15340614
>> 4       <NA> -64.67838269 -62.15494829
>> 5       <NA> -64.67901497 -62.15647203
>> 6       <NA> -64.67973667 -62.15773224
>>
>> Thoughts? Am I missing something obvious?
>>
>> I can break it up into separate date and time fields, but since the
>>field is
>> simply a factor anyways I'm not sure how that would help.
>>
>> Cheers,
>>
>> Corrie
>>
>> ---
>> Corrie Curtice
>> Research Analyst
>> Marine Geospatial Ecology Lab
>> Nicholas School of the Environment, Duke University
>> http://mgel.env.duke.edu
>> em: corrie.curtice at duke.edu
>> ph: 252-504-7538
>>
>>
>>
>>
>>     [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>-- 
>Roger Bivand
>Department of Economics, NHH Norwegian School of Economics,
>Helleveien 30, N-5045 Bergen, Norway.
>voice: +47 55 95 93 55; fax +47 55 95 95 43
>e-mail: Roger.Bivand at nhh.no
>


From tech_dev at wildintellect.com  Sat Nov 12 01:04:13 2011
From: tech_dev at wildintellect.com (Alex Mandel)
Date: Fri, 11 Nov 2011 16:04:13 -0800
Subject: [R-sig-Geo] write/readOGR issue with date / time strings
In-Reply-To: <CAE3163D.C92A%corrie.curtice@duke.edu>
References: <CAE3163D.C92A%corrie.curtice@duke.edu>
Message-ID: <4EBDB7FD.3000904@wildintellect.com>

Shapefiles, specifically dbf tables, do not support Date/Time fields -
well at least date & time in the same field. You must set your column as
Posix type or Character before export to ensure the values are written
as a text column in the dbf file.

Enjoy,
Alex

On 11/11/2011 03:16 PM, Corrie Curtice wrote:
> 
>> sessionInfo()
> R version 2.13.1 (2011-07-08)
> Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)
> 
> locale:
> [1] C/en_US.UTF-8/C/C/C/C
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> 
> other attached packages:
> [1] rgdal_0.7-1 sp_0.9-84
> 
> loaded via a namespace (and not attached):
> [1] grid_2.13.1     lattice_0.19-30 tools_2.13.1
> 
> I installed rgdal and PROJ4 as follows:
> 
> setRepositories(ind=1:2)
> install.packages("rgdal")
> install.packages("PROJ.4")
> 
> 
> 
> Thanks,
> 
> Corrie
> 
> 
> 
> On 11/11/11 5:31 PM, "Roger Bivand" <Roger.Bivand at nhh.no> wrote:
> 
>> On Fri, 11 Nov 2011, Corrie Curtice wrote:
>>
>>> Hello,
>>>
>>> Apologies if this has already been addressed somewhere, I did a brief
>>> search
>>> of archives but didn't find quite this issue.
>>
>> Which versions of what are you using? You should provide the output of
>> sessionInfo(), the messages given when rgdal loads, and details of how
>> you 
>> installed rgdal. In addition, a use case would be helpful, but only when
>> we know what version you are using. In current rgdal, data frame columns
>> of class POSIXt are converted to character strings before writing with
>> writeOGR().
>>
>> Roger
>>
>>>
>>> I'm writing out an ESRI shapefile.  My spdf has a date/time field.
>>> Looks
>>> like this:
>>>
>>>> head(spdfUTM at data)
>>>           krillGMTtime          Lat          Lon
>>> 1   2010-05-12 12:34:21 -64.67655969 -62.15040195
>>> 21  2010-05-12 12:35:12  -64.6771229  -62.1519511
>>> 38  2010-05-12 12:36:02 -64.67775863 -62.15340614
>>> 57  2010-05-12 12:36:53 -64.67838269 -62.15494829
>>> 78  2010-05-12 12:37:43 -64.67901497 -62.15647203
>>> 100 2010-05-12 12:38:37 -64.67973667 -62.15773224
>>>
>>> All three fields are reported to be "factors" by str.  writeOGR appears
>>> happy:
>>>
>>>> writeOGR(spdfUTM,dd,layer="krillPoints-UTM",driver="ESRI
>>> Shapefile",verbose=TRUE,overwrite=TRUE)
>>> $object_type
>>> [1] "SpatialPointsDataFrame"
>>> $output_dsn
>>> [1] "/users/corriecurtice/documents/Data_2010/Shapefiles/"
>>> $output_layer
>>> [1] "krillPoints-UTM"
>>> $output_diver
>>> [1] "ESRI Shapefile"
>>> $output_n
>>> [1] 11179
>>> $output_nfields
>>> [1] 3
>>> $output_fields
>>> [1] "krillGMTtime" "Lat"          "Lon"
>>> $output_fclasses
>>> [1] 4 4 4
>>> $dataset_options
>>> NULL
>>> $layer_options
>>> NULL
>>> Warning message:
>>> In writeOGR(spdfUTM, dd, layer = "krillPoints-UTM", driver = "ESRI
>>> Shapefile",  :
>>>  existing layer removed
>>>
>>> When I read it right back in again, the date/time field is NAs.  This is
>>> also true if I load the shapefile into ArcMap.
>>>
>>>> foo <- readOGR(dd,layer="krillPoints-UTM",verbose=TRUE)
>>> OGR data source with driver: ESRI Shapefile
>>> Source: "/users/corriecurtice/documents/Data_2010/Shapefiles/", layer:
>>> "krillPoints-UTM"
>>> with 11179 features and 3 fields
>>> Feature type: wkbPoint with 2 dimensions
>>>
>>>> head(foo at data)
>>>  krillGMTti          Lat          Lon
>>> 1       <NA> -64.67655969 -62.15040195
>>> 2       <NA>  -64.6771229  -62.1519511
>>> 3       <NA> -64.67775863 -62.15340614
>>> 4       <NA> -64.67838269 -62.15494829
>>> 5       <NA> -64.67901497 -62.15647203
>>> 6       <NA> -64.67973667 -62.15773224
>>>
>>> Thoughts? Am I missing something obvious?
>>>
>>> I can break it up into separate date and time fields, but since the
>>> field is
>>> simply a factor anyways I'm not sure how that would help.
>>>
>>> Cheers,
>>>
>>> Corrie
>>>
>>> ---
>>> Corrie Curtice
>>> Research Analyst
>>> Marine Geospatial Ecology Lab
>>> Nicholas School of the Environment, Duke University
>>> http://mgel.env.duke.edu
>>> em: corrie.curtice at duke.edu
>>> ph: 252-504-7538
>>>
>>>
>>>
>>>
>>>     [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>> -- 
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From HodgessE at uhd.edu  Sat Nov 12 06:43:30 2011
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Fri, 11 Nov 2011 23:43:30 -0600
Subject: [R-sig-Geo] install.views
Message-ID: <586A4828D7AAA04CA9B258C50A28DA200BF58A12@BALI.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111111/7cc49b01/attachment.pl>

From forrest at ufl.edu  Sat Nov 12 07:39:54 2011
From: forrest at ufl.edu (Forrest Stevens)
Date: Sat, 12 Nov 2011 01:39:54 -0500
Subject: [R-sig-Geo] install.views
In-Reply-To: <586A4828D7AAA04CA9B258C50A28DA200BF58A12@BALI.uhd.campus>
References: <586A4828D7AAA04CA9B258C50A28DA200BF58A12@BALI.uhd.campus>
Message-ID: <CAEBQMM=71WZUc7icE8Y_Db9w-OjnzK2m8z8aWs8aHGKTprabOw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111112/1a831e49/attachment.pl>

From Roger.Bivand at nhh.no  Sat Nov 12 21:17:11 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 12 Nov 2011 21:17:11 +0100 (CET)
Subject: [R-sig-Geo] write/readOGR issue with date / time strings
In-Reply-To: <CAE3163D.C92A%corrie.curtice@duke.edu>
References: <CAE3163D.C92A%corrie.curtice@duke.edu>
Message-ID: <alpine.LRH.2.00.1111122101160.21238@reclus.nhh.no>

On Fri, 11 Nov 2011, Corrie Curtice wrote:

>
>> sessionInfo()
> R version 2.13.1 (2011-07-08)
> Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)
>
> locale:
> [1] C/en_US.UTF-8/C/C/C/C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] rgdal_0.7-1 sp_0.9-84

OK, you have the most recent release.

>
> loaded via a namespace (and not attached):
> [1] grid_2.13.1     lattice_0.19-30 tools_2.13.1
>
> I installed rgdal and PROJ4 as follows:
>
> setRepositories(ind=1:2)
> install.packages("rgdal")
> install.packages("PROJ.4")
>

Quoting the loading messages would help, to confirm the version of the 
underlying GDAL binary. The PROJ.4 package is not required or used by 
rgdal. My rgdal version on Fedora reports:

> library(rgdal)
Loading required package: sp
Geospatial Data Abstraction Library extensions to R successfully loaded
Loaded GDAL runtime: GDAL 1.8.1, released 2011/06/04
Path to GDAL shared files: /usr/local/share/gdal
Loaded PROJ.4 runtime: Rel. 4.7.1, 23 September 2009, [PJ_VERSION: 470]
Path to PROJ.4 shared files: (autodetected)

>
>

I do not see the problem in the R-forge development version, and cannot 
reproduce the problem. This now works in (unreleased) 0.7-4:

library(rgdal)
dsn <- system.file("vectors", package = "rgdal")[1]
   kiritimati_primary_roads <- readOGR(dsn=dsn, 
layer="kiritimati_primary_roads")
summary(kiritimati_primary_roads)
kiritimati_primary_roads$dt <- as.POSIXct("2011-11-11 11:11:11")+(60*0:34)
summary(kiritimati_primary_roads)
td <- tempdir()
writeOGR(kiritimati_primary_roads, td, "kiri1", driver="ESRI Shapefile")
kiri1 <- readOGR(td, "kiri1")
summary(kiri1)
kiri1$dt <- as.POSIXct(as.character(kiri1$dt))
summary(kiri1)

This failed in 0.7-1 because the POSIXct column is not recognized as also 
POSIXt; this is corrected in 0.7-4. However, this was not the original 
problem. Had you reported the output of:

sapply(spdfUTM at data, class)
sapply(spdfUTM at data, storage.mode)

we would have known how krillGMTtime was stored - it does not seem to have 
been detected as a column requiring conversion to character string, or as 
a column that should trigger an error. In general, as Alex wrote, all date 
time columns should be converted to character and converted back on 
reading back from the shapefile. OGR drivers treat field types 
differently, so writeOGR has to take a conservative view of possibilities.

Hope this clarifies,

Roger

> Thanks,
>
> Corrie
>
>
>
> On 11/11/11 5:31 PM, "Roger Bivand" <Roger.Bivand at nhh.no> wrote:
>
>> On Fri, 11 Nov 2011, Corrie Curtice wrote:
>>
>>> Hello,
>>>
>>> Apologies if this has already been addressed somewhere, I did a brief
>>> search
>>> of archives but didn't find quite this issue.
>>
>> Which versions of what are you using? You should provide the output of
>> sessionInfo(), the messages given when rgdal loads, and details of how
>> you
>> installed rgdal. In addition, a use case would be helpful, but only when
>> we know what version you are using. In current rgdal, data frame columns
>> of class POSIXt are converted to character strings before writing with
>> writeOGR().
>>
>> Roger
>>
>>>
>>> I'm writing out an ESRI shapefile.  My spdf has a date/time field.
>>> Looks
>>> like this:
>>>
>>>> head(spdfUTM at data)
>>>           krillGMTtime          Lat          Lon
>>> 1   2010-05-12 12:34:21 -64.67655969 -62.15040195
>>> 21  2010-05-12 12:35:12  -64.6771229  -62.1519511
>>> 38  2010-05-12 12:36:02 -64.67775863 -62.15340614
>>> 57  2010-05-12 12:36:53 -64.67838269 -62.15494829
>>> 78  2010-05-12 12:37:43 -64.67901497 -62.15647203
>>> 100 2010-05-12 12:38:37 -64.67973667 -62.15773224
>>>
>>> All three fields are reported to be "factors" by str.  writeOGR appears
>>> happy:
>>>
>>>> writeOGR(spdfUTM,dd,layer="krillPoints-UTM",driver="ESRI
>>> Shapefile",verbose=TRUE,overwrite=TRUE)
>>> $object_type
>>> [1] "SpatialPointsDataFrame"
>>> $output_dsn
>>> [1] "/users/corriecurtice/documents/Data_2010/Shapefiles/"
>>> $output_layer
>>> [1] "krillPoints-UTM"
>>> $output_diver
>>> [1] "ESRI Shapefile"
>>> $output_n
>>> [1] 11179
>>> $output_nfields
>>> [1] 3
>>> $output_fields
>>> [1] "krillGMTtime" "Lat"          "Lon"
>>> $output_fclasses
>>> [1] 4 4 4
>>> $dataset_options
>>> NULL
>>> $layer_options
>>> NULL
>>> Warning message:
>>> In writeOGR(spdfUTM, dd, layer = "krillPoints-UTM", driver = "ESRI
>>> Shapefile",  :
>>>  existing layer removed
>>>
>>> When I read it right back in again, the date/time field is NAs.  This is
>>> also true if I load the shapefile into ArcMap.
>>>
>>>> foo <- readOGR(dd,layer="krillPoints-UTM",verbose=TRUE)
>>> OGR data source with driver: ESRI Shapefile
>>> Source: "/users/corriecurtice/documents/Data_2010/Shapefiles/", layer:
>>> "krillPoints-UTM"
>>> with 11179 features and 3 fields
>>> Feature type: wkbPoint with 2 dimensions
>>>
>>>> head(foo at data)
>>>  krillGMTti          Lat          Lon
>>> 1       <NA> -64.67655969 -62.15040195
>>> 2       <NA>  -64.6771229  -62.1519511
>>> 3       <NA> -64.67775863 -62.15340614
>>> 4       <NA> -64.67838269 -62.15494829
>>> 5       <NA> -64.67901497 -62.15647203
>>> 6       <NA> -64.67973667 -62.15773224
>>>
>>> Thoughts? Am I missing something obvious?
>>>
>>> I can break it up into separate date and time fields, but since the
>>> field is
>>> simply a factor anyways I'm not sure how that would help.
>>>
>>> Cheers,
>>>
>>> Corrie
>>>
>>> ---
>>> Corrie Curtice
>>> Research Analyst
>>> Marine Geospatial Ecology Lab
>>> Nicholas School of the Environment, Duke University
>>> http://mgel.env.duke.edu
>>> em: corrie.curtice at duke.edu
>>> ph: 252-504-7538
>>>
>>>
>>>
>>>
>>>     [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>> --
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From senator at ecotoxicology.de  Sun Nov 13 20:40:23 2011
From: senator at ecotoxicology.de (=?iso-8859-1?Q?Ralf_Sch=E4fer?=)
Date: Sun, 13 Nov 2011 20:40:23 +0100
Subject: [R-sig-Geo] accessing polygons in SpatialPolygonDataFrame
Message-ID: <11A9738F-866D-4FBE-9CDE-F5D5E317E79F@ecotoxicology.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111113/c11fe489/attachment.pl>

From edzer.pebesma at uni-muenster.de  Sun Nov 13 21:15:33 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sun, 13 Nov 2011 21:15:33 +0100
Subject: [R-sig-Geo] accessing polygons in SpatialPolygonDataFrame
In-Reply-To: <11A9738F-866D-4FBE-9CDE-F5D5E317E79F@ecotoxicology.de>
References: <11A9738F-866D-4FBE-9CDE-F5D5E317E79F@ecotoxicology.de>
Message-ID: <4EC02565.4090203@uni-muenster.de>

Ralf, you could try

getData("GADM", country="ESP", level=1)-> sp_gadm
plot(sp_gadm[-c(13,14),])

On 11/13/2011 08:40 PM, Ralf Sch?fer wrote:
> Dear list members
> 
> I would like to access polygons from a SpatialPolygonDataFrame in order to subset them based on the area
> 
> setwd("~/Desktop/")
> require(raster) 
> getData("GADM", country="ESP", level=0)-> sp_gadm
> str(sp_gadm at polygons) # I can see the single polygons, but I have trouble to access them.
> 
> What I would like to do is to delete all Polygons except for the first one to have only the mainland of Spain.
> 
> Perhaps there is also an easier way - but the dataframe of the object has only one row, hence I can not subset the dataframe:
> sp_gadm at data
> 
> Any help appreciated
> Best regards
> Ralf
> 
> ------------------------------------------------------------
> Prof. Dr. rer. nat. Ralf Bernhard Sch?fer
> Juniorprofessor for Quantitative Landscape Ecology
> Environmental Scientist (M.Sc.)
> Institute for Environmental Sciences
> University Koblenz-Landau
> Fortstrasse 7
> 76829 Landau
> Germany
> Mail: schaefer-ralf at uni-landau.de
> Phone: ++49 (0) 6341 280-31536
> Web: http://tinyurl.com/6dnpxna
> 
> 
> 	[[alternative HTML version deleted]]
> 
> 
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From r.hijmans at gmail.com  Sun Nov 13 22:55:00 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sun, 13 Nov 2011 13:55:00 -0800
Subject: [R-sig-Geo] accessing polygons in SpatialPolygonDataFrame
In-Reply-To: <4EC02565.4090203@uni-muenster.de>
References: <11A9738F-866D-4FBE-9CDE-F5D5E317E79F@ecotoxicology.de>
	<4EC02565.4090203@uni-muenster.de>
Message-ID: <CANtt_hyZ8snysUkbOUaS65ujLcz6RmSLGAKhpqajTjg6wrSPcQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111113/e7581ae3/attachment.pl>

From albin.blaschka at standortsanalyse.net  Mon Nov 14 09:03:08 2011
From: albin.blaschka at standortsanalyse.net (Albin Blaschka)
Date: Mon, 14 Nov 2011 09:03:08 +0100
Subject: [R-sig-Geo] readOGR, PostGIS - problem with schemas
Message-ID: <4EC0CB3C.1000607@standortsanalyse.net>


Dear List,

if I try to open a postgis-layer via readOGR and the layer/table is in a 
schema (layer = myschema.mytable), I get an error stating that the layer 
can not be found - but the layer *is* there.

mylayer <-
readOGR(dsn="PG:host=127.0.0.1 user=username dbname=mydb password=secret 
port=5432", layer = "myschema.mylayer", verbose = TRUE)

if I take a layer in the "public" schema and put in the parameter 
"layer" just the tablename (layer = mylayer), it works, if I say "layer 
= public.mylayer", the layer is not found, too

If I try outside of R on the commandline the ogr* - commands 
(ogrinfo...), everything works as expected, for example

 > ogrinfo "PG:host=127.0.0.1 user=username dbname=mydb password=secret 
port=5432" "myschema.mylayer"

INFO: Open of `PG:host=127.0.0.1 user=username dbname=mydb 
password=secret port=5432' using driver `PostgreSQL' successful.

Layer name: myschema.mylayer
[...snip...]

So, the problem lies within the schema.table - notation... Is that a 
known limitation, or did I miss something?

Session Info: (I am on Ubuntu 11.10 "Onereiric")

R version 2.14.0 (2011-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)

locale:
  [1] LC_CTYPE=de_AT.UTF-8       LC_NUMERIC=C 
LC_TIME=de_AT.UTF-8        LC_COLLATE=de_AT.UTF-8
  [5] LC_MONETARY=de_AT.UTF-8    LC_MESSAGES=de_AT.UTF-8    LC_PAPER=C 
                LC_NAME=C
  [9] LC_ADDRESS=C               LC_TELEPHONE=C 
LC_MEASUREMENT=de_AT.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
  [1] rgdal_0.7-3        RPostgreSQL_0.2-0  DBI_0.2-5 
RColorBrewer_1.0-5 maptools_0.7-38    lattice_0.20-0
  [7] sp_0.9-81          foreign_0.8-46     spatstat_1.24-2 
deldir_0.0-16      mgcv_1.7-10

loaded via a namespace (and not attached):
[1] grid_2.14.0  Matrix_1.0-1 nlme_3.1-102 tools_2.14.0

Thank you,
Albin


-- 
| Albin Blaschka, Mag.rer.nat.
| Etrichstrasse 26, A-5020 Salzburg
| * www.albinblaschka.info * www.thinkanimal.info *
| - It's hard to live in the mountains, hard but not hopeless!


From lists at remoteinformation.com.au  Mon Nov 14 13:50:46 2011
From: lists at remoteinformation.com.au (Ben Madin)
Date: Mon, 14 Nov 2011 20:50:46 +0800
Subject: [R-sig-Geo] readOGR, PostGIS - problem with schemas
In-Reply-To: <4EC0CB3C.1000607@standortsanalyse.net>
References: <4EC0CB3C.1000607@standortsanalyse.net>
Message-ID: <A4207D4B-CA60-4F31-A37E-1CF0507CF552@remoteinformation.com.au>

Albin,

I too have encountered this problem, and there was a bit of a discussion on this list a little over twelve months ago (search for "error in readogr")

The bottom line in my case was to do with the layers (and the correct schemas) not being properly recorded in the geometry columns table. I think I might have truncated and run populate_geometry_columns() a couple of times to overcome this. 

I think it was also important that the schema you want is in the database search_path... this might have to be done before the populate_geometry_columns function is run.

cheers (good luck, the frustration nearly killed me but I was very generously helped by this list.)

Ben








On 14/11/2011, at 4:03 PM, Albin Blaschka wrote:

> 
> Dear List,
> 
> if I try to open a postgis-layer via readOGR and the layer/table is in a schema (layer = myschema.mytable), I get an error stating that the layer can not be found - but the layer *is* there.
> 
> mylayer <-
> readOGR(dsn="PG:host=127.0.0.1 user=username dbname=mydb password=secret port=5432", layer = "myschema.mylayer", verbose = TRUE)
> 
> if I take a layer in the "public" schema and put in the parameter "layer" just the tablename (layer = mylayer), it works, if I say "layer = public.mylayer", the layer is not found, too
> 
> If I try outside of R on the commandline the ogr* - commands (ogrinfo...), everything works as expected, for example
> 
> > ogrinfo "PG:host=127.0.0.1 user=username dbname=mydb password=secret port=5432" "myschema.mylayer"
> 
> INFO: Open of `PG:host=127.0.0.1 user=username dbname=mydb password=secret port=5432' using driver `PostgreSQL' successful.
> 
> Layer name: myschema.mylayer
> [...snip...]
> 
> So, the problem lies within the schema.table - notation... Is that a known limitation, or did I miss something?
> 
> Session Info: (I am on Ubuntu 11.10 "Onereiric")
> 
> R version 2.14.0 (2011-10-31)
> Platform: x86_64-pc-linux-gnu (64-bit)
> 
> locale:
> [1] LC_CTYPE=de_AT.UTF-8       LC_NUMERIC=C LC_TIME=de_AT.UTF-8        LC_COLLATE=de_AT.UTF-8
> [5] LC_MONETARY=de_AT.UTF-8    LC_MESSAGES=de_AT.UTF-8    LC_PAPER=C                LC_NAME=C
> [9] LC_ADDRESS=C               LC_TELEPHONE=C LC_MEASUREMENT=de_AT.UTF-8 LC_IDENTIFICATION=C
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> 
> other attached packages:
> [1] rgdal_0.7-3        RPostgreSQL_0.2-0  DBI_0.2-5 RColorBrewer_1.0-5 maptools_0.7-38    lattice_0.20-0
> [7] sp_0.9-81          foreign_0.8-46     spatstat_1.24-2 deldir_0.0-16      mgcv_1.7-10
> 
> loaded via a namespace (and not attached):
> [1] grid_2.14.0  Matrix_1.0-1 nlme_3.1-102 tools_2.14.0
> 
> Thank you,
> Albin
> 
> 
> -- 
> | Albin Blaschka, Mag.rer.nat.
> | Etrichstrasse 26, A-5020 Salzburg
> | * www.albinblaschka.info * www.thinkanimal.info *
> | - It's hard to live in the mountains, hard but not hopeless!
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From sandra.werb at googlemail.com  Mon Nov 14 14:33:01 2011
From: sandra.werb at googlemail.com (leni)
Date: Mon, 14 Nov 2011 05:33:01 -0800 (PST)
Subject: [R-sig-Geo] Export raster data as *.grd file format in ArcMap
In-Reply-To: <CANtt_hwB5zC9dy6wPvz-b-dQahSkvEgqW1WVGYw+DgmyfjuQpQ@mail.gmail.com>
References: <1320846910788-6978040.post@n2.nabble.com>
	<CANtt_hwB5zC9dy6wPvz-b-dQahSkvEgqW1WVGYw+DgmyfjuQpQ@mail.gmail.com>
Message-ID: <1321277581313-6992473.post@n2.nabble.com>

Thanks Robert, 

you solved my problem. I didn't know that I can treat the database as a file
to read the data.

Leni


Robert Hijmans wrote:
> 
> Leni,
> 
> If you have raster data in Arc and export as GRID it will create a
> database
> (folder, including a parallel folder called info) that you can treat like
> a
> file and open in R. Alternatively you can export to tif, img (erdas) and
> other formats (avoid ascii) that raster can read (most of them via rgdal)
> but you cannot export to "grd". If your Arc data are points, then export
> to
> a shapefile and read with e.g. readOGR (rgdal).
> 
> Robert
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo@
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 


--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Export-raster-data-as-grd-file-format-in-ArcMap-tp6978040p6992473.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From macqueen1 at llnl.gov  Mon Nov 14 17:10:32 2011
From: macqueen1 at llnl.gov (MacQueen, Don)
Date: Mon, 14 Nov 2011 08:10:32 -0800
Subject: [R-sig-Geo] write/readOGR issue with date / time strings
In-Reply-To: <CAE2F5A1.C926%corrie.curtice@duke.edu>
Message-ID: <CAE67991.7BE04%macqueen1@llnl.gov>

You don't truly have a date/time field, even though it looks like it. You
have a factor. 

So the first thing I would try is to convert the date/time field from
factor to character using format() or as.character() before writing the
shapefile. (That is, do the conversion myself rather than relying on
writeOGR's internal conversion; see the help page for writeOGR).

I'm a little bothered by the fact that Lat and Lon are factors; they
shouldn't be. This suggests that somewhere in your data is at least one
row where lat or long is not a valid number. But writeOGR doesn't use
these particular Lat and Lon columns to write coordinates to the
shapefile, so maybe it doesn't matter.

-Don

-- 
Don MacQueen

Lawrence Livermore National Laboratory
7000 East Ave., L-627
Livermore, CA 94550
925-423-1062





On 11/11/11 12:54 PM, "Corrie Curtice" <corrie.curtice at duke.edu> wrote:

>Hello, 
>
>Apologies if this has already been addressed somewhere, I did a brief
>search
>of archives but didn't find quite this issue.
>
>I'm writing out an ESRI shapefile.  My spdf has a date/time field.  Looks
>like this:
>
>> head(spdfUTM at data)
>           krillGMTtime          Lat          Lon
>1   2010-05-12 12:34:21 -64.67655969 -62.15040195
>21  2010-05-12 12:35:12  -64.6771229  -62.1519511
>38  2010-05-12 12:36:02 -64.67775863 -62.15340614
>57  2010-05-12 12:36:53 -64.67838269 -62.15494829
>78  2010-05-12 12:37:43 -64.67901497 -62.15647203
>100 2010-05-12 12:38:37 -64.67973667 -62.15773224
> 
>All three fields are reported to be "factors" by str.  writeOGR appears
>happy:
>
>> writeOGR(spdfUTM,dd,layer="krillPoints-UTM",driver="ESRI
>Shapefile",verbose=TRUE,overwrite=TRUE)
>$object_type
>[1] "SpatialPointsDataFrame"
>$output_dsn
>[1] "/users/corriecurtice/documents/Data_2010/Shapefiles/"
>$output_layer
>[1] "krillPoints-UTM"
>$output_diver
>[1] "ESRI Shapefile"
>$output_n
>[1] 11179
>$output_nfields
>[1] 3
>$output_fields
>[1] "krillGMTtime" "Lat"          "Lon"
>$output_fclasses
>[1] 4 4 4
>$dataset_options
>NULL
>$layer_options
>NULL
>Warning message:
>In writeOGR(spdfUTM, dd, layer = "krillPoints-UTM", driver = "ESRI
>Shapefile",  :
>  existing layer removed
>
>When I read it right back in again, the date/time field is NAs.  This is
>also true if I load the shapefile into ArcMap.
>
>> foo <- readOGR(dd,layer="krillPoints-UTM",verbose=TRUE)
>OGR data source with driver: ESRI Shapefile
>Source: "/users/corriecurtice/documents/Data_2010/Shapefiles/", layer:
>"krillPoints-UTM"
>with 11179 features and 3 fields
>Feature type: wkbPoint with 2 dimensions
>
>> head(foo at data)
>  krillGMTti          Lat          Lon
>1       <NA> -64.67655969 -62.15040195
>2       <NA>  -64.6771229  -62.1519511
>3       <NA> -64.67775863 -62.15340614
>4       <NA> -64.67838269 -62.15494829
>5       <NA> -64.67901497 -62.15647203
>6       <NA> -64.67973667 -62.15773224
>
>Thoughts? Am I missing something obvious?
>
>I can break it up into separate date and time fields, but since the field
>is
>simply a factor anyways I'm not sure how that would help.
>
>Cheers,
>
>Corrie
>
>---
>Corrie Curtice
>Research Analyst
>Marine Geospatial Ecology Lab
>Nicholas School of the Environment, Duke University
>http://mgel.env.duke.edu
>em: corrie.curtice at duke.edu
>ph: 252-504-7538
>
>
>
>
>	[[alternative HTML version deleted]]
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From albin.blaschka at standortsanalyse.net  Tue Nov 15 08:23:21 2011
From: albin.blaschka at standortsanalyse.net (Albin Blaschka)
Date: Tue, 15 Nov 2011 08:23:21 +0100
Subject: [R-sig-Geo] readOGR, PostGIS - problem with schemas
In-Reply-To: <A4207D4B-CA60-4F31-A37E-1CF0507CF552@remoteinformation.com.au>
References: <4EC0CB3C.1000607@standortsanalyse.net>
	<A4207D4B-CA60-4F31-A37E-1CF0507CF552@remoteinformation.com.au>
Message-ID: <4EC21369.1070107@standortsanalyse.net>


Am 14.11.2011 13:50, schrieb Ben Madin:
> Albin,
>
> I too have encountered this problem, and there was a bit of a discussion on this list a little over twelve months ago (search for "error in readogr")
> The bottom line in my case was to do with the layers (and the correct schemas) not being properly recorded in the geometry columns table. I think I might have truncated and run populate_geometry_columns() a couple of times to overcome this.
> I think it was also important that the schema you want is in the database search_path... this might have to be done before the populate_geometry_columns function is run.
> cheers (good luck, the frustration nearly killed me but I was very generously helped by this list.)
>
> Ben

Hello Ben, hello list!

a truncate on the table geometry_columns followed by a select 
Populate_Geometry_columns() did the trick - readOGR now works as 
expected! Thank you very much!

kind regards,
Albin


-- 
| Albin Blaschka, Mag.rer.nat.
| Etrichstrasse 26, A-5020 Salzburg
| * www.albinblaschka.info * www.thinkanimal.info *
| - It's hard to live in the mountains, hard but not hopeless!


From mathieu.rajerison at gmail.com  Tue Nov 15 16:25:23 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Tue, 15 Nov 2011 16:25:23 +0100
Subject: [R-sig-Geo] Coercing spatstat::psp to sp:SpatialLines
Message-ID: <CAGfc75=-puQMdwAS-AWnZ84mLezikhZANZj+dDsPazj77qXStQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111115/439dcc8d/attachment.pl>

From Roger.Bivand at nhh.no  Tue Nov 15 18:15:30 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 15 Nov 2011 18:15:30 +0100
Subject: [R-sig-Geo] Coercing spatstat::psp to sp:SpatialLines
In-Reply-To: <CAGfc75=-puQMdwAS-AWnZ84mLezikhZANZj+dDsPazj77qXStQ@mail.gmail.com>
References: <CAGfc75=-puQMdwAS-AWnZ84mLezikhZANZj+dDsPazj77qXStQ@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1111151814000.1890@reclus.nhh.no>

On Tue, 15 Nov 2011, Mathieu Rajerison wrote:

> Hi,
>
>
> I've generated random segment patterns with spatstat::rpoisline so as to
> plot differences of profile lines between two different digital elevation
> models.
>
> Now, I want to use raster::extract function to get the raster values on
> both rasters for each segment but for this, I have to coerce a psp to a
> SpatialLines object but I don't know how to do the coercion. (SpatialLines
> to psp is OK).
> as(psp, "SpatialLines") doesn't seem to work.

The coercion functions in maptools, contributed by Adrian Baddeley, go 
from SpatialLines to psp, not the reverse. You need to create the set of 
coercion methods to go the other way - contributions welcome!

Roger

>
>
> Any help would be appreciated,
>
> Mathieu
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From corrie.curtice at duke.edu  Tue Nov 15 18:49:18 2011
From: corrie.curtice at duke.edu (Corrie Curtice)
Date: Tue, 15 Nov 2011 12:49:18 -0500
Subject: [R-sig-Geo] write/readOGR issue with date / time strings
In-Reply-To: <alpine.LRH.2.00.1111122101160.21238@reclus.nhh.no>
Message-ID: <CAE6D7D7.CC8D%corrie.curtice@duke.edu>

Hi Roger,

Thanks for your patience. This one is confusing to me as I've done exactly
(well, I think exactly) the same steps in the past and it has worked fine.
 The only difference is (a) I'm using Rstudio which made me (b) update my
rgdal library version.  I've always converted date/time fields using
as.character or format().  Answers to your questions embedded below...


On 11/12/11 3:17 PM, "Roger Bivand" <Roger.Bivand at nhh.no> wrote:


>On Fri, 11 Nov 2011, Corrie Curtice wrote:
>
>>
>>> sessionInfo()
>> R version 2.13.1 (2011-07-08)
>> Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)
>>
>> locale:
>> [1] C/en_US.UTF-8/C/C/C/C
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> other attached packages:
>> [1] rgdal_0.7-1 sp_0.9-84
>
>OK, you have the most recent release.
>
>>
>> loaded via a namespace (and not attached):
>> [1] grid_2.13.1     lattice_0.19-30 tools_2.13.1
>>
>> I installed rgdal and PROJ4 as follows:
>>
>> setRepositories(ind=1:2)
>> install.packages("rgdal")
>> install.packages("PROJ.4")
>>
>
>Quoting the loading messages would help, to confirm the version of the
>underlying GDAL binary. The PROJ.4 package is not required or used by
>rgdal. My rgdal version on Fedora reports:
>
>> library(rgdal)
>Loading required package: sp
>Geospatial Data Abstraction Library extensions to R successfully loaded
>Loaded GDAL runtime: GDAL 1.8.1, released 2011/06/04
>Path to GDAL shared files: /usr/local/share/gdal
>Loaded PROJ.4 runtime: Rel. 4.7.1, 23 September 2009, [PJ_VERSION: 470]
>Path to PROJ.4 shared files: (autodetected)
>

Here's the output from loading rgdal:

> library(rgdal)
Geospatial Data Abstraction Library extensions to R successfully loaded
Loaded GDAL runtime: GDAL 1.8.0, released 2011/01/12
Path to GDAL shared files:
/Users/corriecurtice/Library/R/2.13/library/rgdal/gdal
Loaded PROJ.4 runtime: Rel. 4.7.1, 23 September 2009, [PJ_VERSION: 470]
Path to PROJ.4 shared files:
/Users/corriecurtice/Library/R/2.13/library/rgdal/proj
> 

So there's a slightly newer GDAL release (1.8.1).  I'm in the process of
trying to get that installed but not having a lot of luck.  I downloaded
and installed gdal v1.8.1-1 leopard (and dependencies). I assume I need to
re-compile the rgdal package so it sees this new version but I get an
error when trying to do that:

corrie-curtices-macbook-pro:Downloads corriecurtice$ !R
R CMD INSTALL 
--configure-args='--with-gdal-config=/Library/Frameworks/GDAL.framework/Pro
grams/gdal-config 
--with-proj-include=/Library/Frameworks/PROJ.framework/Headers
--with-proj-lib=/Library/Frameworks/PROJ.framework/unix/lib'
rgdal_0.7-4.tar.gz 
* installing to library ?/Users/corriecurtice/Library/R/2.13/library?
* installing *source* package ?rgdal? ...
gdal-config: /Library/Frameworks/GDAL.framework/Programs/gdal-config
checking for gcc... gcc-4.2 -arch i386 -std=gnu99
checking whether the C compiler works... no
configure: error: in
`/private/var/folders/jD/jDD8BZCHHLC-VOQmq7vTGk+++TI/-Tmp-/RtmpTlKhSZ/R.INS
TALL253fc47f/rgdal':
configure: error: C compiler cannot create executables
See `config.log' for more details
ERROR: configuration failed for package ?rgdal?
* removing ?/Users/corriecurtice/Library/R/2.13/library/rgdal?
* restoring previous ?/Users/corriecurtice/Library/R/2.13/library/rgdal?


I can't find the config.log file, the tmp directory referenced is empty
and it's not in my cwd.

>>
>>
>
>I do not see the problem in the R-forge development version, and cannot
>reproduce the problem. This now works in (unreleased) 0.7-4:
>
>library(rgdal)
>dsn <- system.file("vectors", package = "rgdal")[1]
>   kiritimati_primary_roads <- readOGR(dsn=dsn,
>layer="kiritimati_primary_roads")
>summary(kiritimati_primary_roads)
>kiritimati_primary_roads$dt <- as.POSIXct("2011-11-11 11:11:11")+(60*0:34)
>summary(kiritimati_primary_roads)
>td <- tempdir()
>writeOGR(kiritimati_primary_roads, td, "kiri1", driver="ESRI Shapefile")
>kiri1 <- readOGR(td, "kiri1")
>summary(kiri1)
>kiri1$dt <- as.POSIXct(as.character(kiri1$dt))
>summary(kiri1)
>
>This failed in 0.7-1 because the POSIXct column is not recognized as also
>POSIXt; this is corrected in 0.7-4. However, this was not the original
>problem. Had you reported the output of:
>
>sapply(spdfUTM at data, class)
>sapply(spdfUTM at data, storage.mode)
>
>we would have known how krillGMTtime was stored - it does not seem to
>have 
>been detected as a column requiring conversion to character string, or as
>a column that should trigger an error. In general, as Alex wrote, all
>date 
>time columns should be converted to character and converted back on
>reading back from the shapefile. OGR drivers treat field types
>differently, so writeOGR has to take a conservative view of possibilities.

Here's the output from the sapply:


> sapply(spdfUTM at data, class)
krillGMTtime          Lat          Lon
    "factor"     "factor"     "factor"
> sapply(spdfUTM at data, storage.mode)
krillGMTtime          Lat          Lon
   "integer"    "integer"    "integer"


To answer Don's question, yes I have bad LAT/LON rows when I first read
them in but they are all 999. I discard them before making my spatial
points data frame, which does in fact use those two columns for the
coordinates. I have another similar dataset where the date/time field
storage.mode is reported as "character" and not "integer", and has the
same issue.  


Thanks for the help.

Corrie


>Hope this clarifies,
>
>Roger
>
>> Thanks,
>>
>> Corrie
>>
>>
>>
>> On 11/11/11 5:31 PM, "Roger Bivand" <Roger.Bivand at nhh.no> wrote:
>>
>>> On Fri, 11 Nov 2011, Corrie Curtice wrote:
>>>
>>>> Hello,
>>>>
>>>> Apologies if this has already been addressed somewhere, I did a brief
>>>> search
>>>> of archives but didn't find quite this issue.
>>>
>>> Which versions of what are you using? You should provide the output of
>>> sessionInfo(), the messages given when rgdal loads, and details of how
>>> you
>>> installed rgdal. In addition, a use case would be helpful, but only
>>>when
>>> we know what version you are using. In current rgdal, data frame
>>>columns
>>> of class POSIXt are converted to character strings before writing with
>>> writeOGR().
>>>
>>> Roger
>>>
>>>>
>>>> I'm writing out an ESRI shapefile.  My spdf has a date/time field.
>>>> Looks
>>>> like this:
>>>>
>>>>> head(spdfUTM at data)
>>>>           krillGMTtime          Lat          Lon
>>>> 1   2010-05-12 12:34:21 -64.67655969 -62.15040195
>>>> 21  2010-05-12 12:35:12  -64.6771229  -62.1519511
>>>> 38  2010-05-12 12:36:02 -64.67775863 -62.15340614
>>>> 57  2010-05-12 12:36:53 -64.67838269 -62.15494829
>>>> 78  2010-05-12 12:37:43 -64.67901497 -62.15647203
>>>> 100 2010-05-12 12:38:37 -64.67973667 -62.15773224
>>>>
>>>> All three fields are reported to be "factors" by str.  writeOGR
>>>>appears
>>>> happy:
>>>>
>>>>> writeOGR(spdfUTM,dd,layer="krillPoints-UTM",driver="ESRI
>>>> Shapefile",verbose=TRUE,overwrite=TRUE)
>>>> $object_type
>>>> [1] "SpatialPointsDataFrame"
>>>> $output_dsn
>>>> [1] "/users/corriecurtice/documents/Data_2010/Shapefiles/"
>>>> $output_layer
>>>> [1] "krillPoints-UTM"
>>>> $output_diver
>>>> [1] "ESRI Shapefile"
>>>> $output_n
>>>> [1] 11179
>>>> $output_nfields
>>>> [1] 3
>>>> $output_fields
>>>> [1] "krillGMTtime" "Lat"          "Lon"
>>>> $output_fclasses
>>>> [1] 4 4 4
>>>> $dataset_options
>>>> NULL
>>>> $layer_options
>>>> NULL
>>>> Warning message:
>>>> In writeOGR(spdfUTM, dd, layer = "krillPoints-UTM", driver = "ESRI
>>>> Shapefile",  :
>>>>  existing layer removed
>>>>
>>>> When I read it right back in again, the date/time field is NAs.  This
>>>>is
>>>> also true if I load the shapefile into ArcMap.
>>>>
>>>>> foo <- readOGR(dd,layer="krillPoints-UTM",verbose=TRUE)
>>>> OGR data source with driver: ESRI Shapefile
>>>> Source: "/users/corriecurtice/documents/Data_2010/Shapefiles/", layer:
>>>> "krillPoints-UTM"
>>>> with 11179 features and 3 fields
>>>> Feature type: wkbPoint with 2 dimensions
>>>>
>>>>> head(foo at data)
>>>>  krillGMTti          Lat          Lon
>>>> 1       <NA> -64.67655969 -62.15040195
>>>> 2       <NA>  -64.6771229  -62.1519511
>>>> 3       <NA> -64.67775863 -62.15340614
>>>> 4       <NA> -64.67838269 -62.15494829
>>>> 5       <NA> -64.67901497 -62.15647203
>>>> 6       <NA> -64.67973667 -62.15773224
>>>>
>>>> Thoughts? Am I missing something obvious?
>>>>
>>>> I can break it up into separate date and time fields, but since the
>>>> field is
>>>> simply a factor anyways I'm not sure how that would help.
>>>>
>>>> Cheers,
>>>>
>>>> Corrie
>>>>
>>>> ---
>>>> Corrie Curtice
>>>> Research Analyst
>>>> Marine Geospatial Ecology Lab
>>>> Nicholas School of the Environment, Duke University
>>>> http://mgel.env.duke.edu
>>>> em: corrie.curtice at duke.edu
>>>> ph: 252-504-7538
>>>>
>>>>
>>>>
>>>>
>>>>     [[alternative HTML version deleted]]
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>
>>> --
>>> Roger Bivand
>>> Department of Economics, NHH Norwegian School of Economics,
>>> Helleveien 30, N-5045 Bergen, Norway.
>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>> e-mail: Roger.Bivand at nhh.no
>>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>-- 
>Roger Bivand
>Department of Economics, NHH Norwegian School of Economics,
>Helleveien 30, N-5045 Bergen, Norway.
>voice: +47 55 95 93 55; fax +47 55 95 95 43
>e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Tue Nov 15 19:37:30 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 15 Nov 2011 19:37:30 +0100 (CET)
Subject: [R-sig-Geo] write/readOGR issue with date / time strings
In-Reply-To: <CAE6D7D7.CC8D%corrie.curtice@duke.edu>
References: <CAE6D7D7.CC8D%corrie.curtice@duke.edu>
Message-ID: <alpine.LRH.2.00.1111151934090.1890@reclus.nhh.no>

On Tue, 15 Nov 2011, Corrie Curtice wrote:

> Hi Roger,
>
> Thanks for your patience. This one is confusing to me as I've done exactly
> (well, I think exactly) the same steps in the past and it has worked fine.
> The only difference is (a) I'm using Rstudio which made me (b) update my
> rgdal library version.  I've always converted date/time fields using
> as.character or format().  Answers to your questions embedded below...
>

Nothing has changed that should cause this misbehaviour. Can you save() 
the spatial points data frame and put it on a link for me to pick up to 
try to reproduce your problem on a different platform? The GDAL release 
isn't the issue, I think. Did you say how the data was read into R?

Roger

>
> On 11/12/11 3:17 PM, "Roger Bivand" <Roger.Bivand at nhh.no> wrote:
>
>
>> On Fri, 11 Nov 2011, Corrie Curtice wrote:
>>
>>>
>>>> sessionInfo()
>>> R version 2.13.1 (2011-07-08)
>>> Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)
>>>
>>> locale:
>>> [1] C/en_US.UTF-8/C/C/C/C
>>>
>>> attached base packages:
>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>
>>> other attached packages:
>>> [1] rgdal_0.7-1 sp_0.9-84
>>
>> OK, you have the most recent release.
>>
>>>
>>> loaded via a namespace (and not attached):
>>> [1] grid_2.13.1     lattice_0.19-30 tools_2.13.1
>>>
>>> I installed rgdal and PROJ4 as follows:
>>>
>>> setRepositories(ind=1:2)
>>> install.packages("rgdal")
>>> install.packages("PROJ.4")
>>>
>>
>> Quoting the loading messages would help, to confirm the version of the
>> underlying GDAL binary. The PROJ.4 package is not required or used by
>> rgdal. My rgdal version on Fedora reports:
>>
>>> library(rgdal)
>> Loading required package: sp
>> Geospatial Data Abstraction Library extensions to R successfully loaded
>> Loaded GDAL runtime: GDAL 1.8.1, released 2011/06/04
>> Path to GDAL shared files: /usr/local/share/gdal
>> Loaded PROJ.4 runtime: Rel. 4.7.1, 23 September 2009, [PJ_VERSION: 470]
>> Path to PROJ.4 shared files: (autodetected)
>>
>
> Here's the output from loading rgdal:
>
>> library(rgdal)
> Geospatial Data Abstraction Library extensions to R successfully loaded
> Loaded GDAL runtime: GDAL 1.8.0, released 2011/01/12
> Path to GDAL shared files:
> /Users/corriecurtice/Library/R/2.13/library/rgdal/gdal
> Loaded PROJ.4 runtime: Rel. 4.7.1, 23 September 2009, [PJ_VERSION: 470]
> Path to PROJ.4 shared files:
> /Users/corriecurtice/Library/R/2.13/library/rgdal/proj
>>
>
> So there's a slightly newer GDAL release (1.8.1).  I'm in the process of
> trying to get that installed but not having a lot of luck.  I downloaded
> and installed gdal v1.8.1-1 leopard (and dependencies). I assume I need to
> re-compile the rgdal package so it sees this new version but I get an
> error when trying to do that:
>
> corrie-curtices-macbook-pro:Downloads corriecurtice$ !R
> R CMD INSTALL
> --configure-args='--with-gdal-config=/Library/Frameworks/GDAL.framework/Pro
> grams/gdal-config
> --with-proj-include=/Library/Frameworks/PROJ.framework/Headers
> --with-proj-lib=/Library/Frameworks/PROJ.framework/unix/lib'
> rgdal_0.7-4.tar.gz
> * installing to library ?/Users/corriecurtice/Library/R/2.13/library?
> * installing *source* package ?rgdal? ...
> gdal-config: /Library/Frameworks/GDAL.framework/Programs/gdal-config
> checking for gcc... gcc-4.2 -arch i386 -std=gnu99
> checking whether the C compiler works... no
> configure: error: in
> `/private/var/folders/jD/jDD8BZCHHLC-VOQmq7vTGk+++TI/-Tmp-/RtmpTlKhSZ/R.INS
> TALL253fc47f/rgdal':
> configure: error: C compiler cannot create executables
> See `config.log' for more details
> ERROR: configuration failed for package ?rgdal?
> * removing ?/Users/corriecurtice/Library/R/2.13/library/rgdal?
> * restoring previous ?/Users/corriecurtice/Library/R/2.13/library/rgdal?
>
>
> I can't find the config.log file, the tmp directory referenced is empty
> and it's not in my cwd.
>
>>>
>>>
>>
>> I do not see the problem in the R-forge development version, and cannot
>> reproduce the problem. This now works in (unreleased) 0.7-4:
>>
>> library(rgdal)
>> dsn <- system.file("vectors", package = "rgdal")[1]
>>   kiritimati_primary_roads <- readOGR(dsn=dsn,
>> layer="kiritimati_primary_roads")
>> summary(kiritimati_primary_roads)
>> kiritimati_primary_roads$dt <- as.POSIXct("2011-11-11 11:11:11")+(60*0:34)
>> summary(kiritimati_primary_roads)
>> td <- tempdir()
>> writeOGR(kiritimati_primary_roads, td, "kiri1", driver="ESRI Shapefile")
>> kiri1 <- readOGR(td, "kiri1")
>> summary(kiri1)
>> kiri1$dt <- as.POSIXct(as.character(kiri1$dt))
>> summary(kiri1)
>>
>> This failed in 0.7-1 because the POSIXct column is not recognized as also
>> POSIXt; this is corrected in 0.7-4. However, this was not the original
>> problem. Had you reported the output of:
>>
>> sapply(spdfUTM at data, class)
>> sapply(spdfUTM at data, storage.mode)
>>
>> we would have known how krillGMTtime was stored - it does not seem to
>> have
>> been detected as a column requiring conversion to character string, or as
>> a column that should trigger an error. In general, as Alex wrote, all
>> date
>> time columns should be converted to character and converted back on
>> reading back from the shapefile. OGR drivers treat field types
>> differently, so writeOGR has to take a conservative view of possibilities.
>
> Here's the output from the sapply:
>
>
>> sapply(spdfUTM at data, class)
> krillGMTtime          Lat          Lon
>    "factor"     "factor"     "factor"
>> sapply(spdfUTM at data, storage.mode)
> krillGMTtime          Lat          Lon
>   "integer"    "integer"    "integer"
>
>
> To answer Don's question, yes I have bad LAT/LON rows when I first read
> them in but they are all 999. I discard them before making my spatial
> points data frame, which does in fact use those two columns for the
> coordinates. I have another similar dataset where the date/time field
> storage.mode is reported as "character" and not "integer", and has the
> same issue.
>
>
> Thanks for the help.
>
> Corrie
>
>
>> Hope this clarifies,
>>
>> Roger
>>
>>> Thanks,
>>>
>>> Corrie
>>>
>>>
>>>
>>> On 11/11/11 5:31 PM, "Roger Bivand" <Roger.Bivand at nhh.no> wrote:
>>>
>>>> On Fri, 11 Nov 2011, Corrie Curtice wrote:
>>>>
>>>>> Hello,
>>>>>
>>>>> Apologies if this has already been addressed somewhere, I did a brief
>>>>> search
>>>>> of archives but didn't find quite this issue.
>>>>
>>>> Which versions of what are you using? You should provide the output of
>>>> sessionInfo(), the messages given when rgdal loads, and details of how
>>>> you
>>>> installed rgdal. In addition, a use case would be helpful, but only
>>>> when
>>>> we know what version you are using. In current rgdal, data frame
>>>> columns
>>>> of class POSIXt are converted to character strings before writing with
>>>> writeOGR().
>>>>
>>>> Roger
>>>>
>>>>>
>>>>> I'm writing out an ESRI shapefile.  My spdf has a date/time field.
>>>>> Looks
>>>>> like this:
>>>>>
>>>>>> head(spdfUTM at data)
>>>>>           krillGMTtime          Lat          Lon
>>>>> 1   2010-05-12 12:34:21 -64.67655969 -62.15040195
>>>>> 21  2010-05-12 12:35:12  -64.6771229  -62.1519511
>>>>> 38  2010-05-12 12:36:02 -64.67775863 -62.15340614
>>>>> 57  2010-05-12 12:36:53 -64.67838269 -62.15494829
>>>>> 78  2010-05-12 12:37:43 -64.67901497 -62.15647203
>>>>> 100 2010-05-12 12:38:37 -64.67973667 -62.15773224
>>>>>
>>>>> All three fields are reported to be "factors" by str.  writeOGR
>>>>> appears
>>>>> happy:
>>>>>
>>>>>> writeOGR(spdfUTM,dd,layer="krillPoints-UTM",driver="ESRI
>>>>> Shapefile",verbose=TRUE,overwrite=TRUE)
>>>>> $object_type
>>>>> [1] "SpatialPointsDataFrame"
>>>>> $output_dsn
>>>>> [1] "/users/corriecurtice/documents/Data_2010/Shapefiles/"
>>>>> $output_layer
>>>>> [1] "krillPoints-UTM"
>>>>> $output_diver
>>>>> [1] "ESRI Shapefile"
>>>>> $output_n
>>>>> [1] 11179
>>>>> $output_nfields
>>>>> [1] 3
>>>>> $output_fields
>>>>> [1] "krillGMTtime" "Lat"          "Lon"
>>>>> $output_fclasses
>>>>> [1] 4 4 4
>>>>> $dataset_options
>>>>> NULL
>>>>> $layer_options
>>>>> NULL
>>>>> Warning message:
>>>>> In writeOGR(spdfUTM, dd, layer = "krillPoints-UTM", driver = "ESRI
>>>>> Shapefile",  :
>>>>>  existing layer removed
>>>>>
>>>>> When I read it right back in again, the date/time field is NAs.  This
>>>>> is
>>>>> also true if I load the shapefile into ArcMap.
>>>>>
>>>>>> foo <- readOGR(dd,layer="krillPoints-UTM",verbose=TRUE)
>>>>> OGR data source with driver: ESRI Shapefile
>>>>> Source: "/users/corriecurtice/documents/Data_2010/Shapefiles/", layer:
>>>>> "krillPoints-UTM"
>>>>> with 11179 features and 3 fields
>>>>> Feature type: wkbPoint with 2 dimensions
>>>>>
>>>>>> head(foo at data)
>>>>>  krillGMTti          Lat          Lon
>>>>> 1       <NA> -64.67655969 -62.15040195
>>>>> 2       <NA>  -64.6771229  -62.1519511
>>>>> 3       <NA> -64.67775863 -62.15340614
>>>>> 4       <NA> -64.67838269 -62.15494829
>>>>> 5       <NA> -64.67901497 -62.15647203
>>>>> 6       <NA> -64.67973667 -62.15773224
>>>>>
>>>>> Thoughts? Am I missing something obvious?
>>>>>
>>>>> I can break it up into separate date and time fields, but since the
>>>>> field is
>>>>> simply a factor anyways I'm not sure how that would help.
>>>>>
>>>>> Cheers,
>>>>>
>>>>> Corrie
>>>>>
>>>>> ---
>>>>> Corrie Curtice
>>>>> Research Analyst
>>>>> Marine Geospatial Ecology Lab
>>>>> Nicholas School of the Environment, Duke University
>>>>> http://mgel.env.duke.edu
>>>>> em: corrie.curtice at duke.edu
>>>>> ph: 252-504-7538
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>     [[alternative HTML version deleted]]
>>>>>
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>
>>>>
>>>> --
>>>> Roger Bivand
>>>> Department of Economics, NHH Norwegian School of Economics,
>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>>> e-mail: Roger.Bivand at nhh.no
>>>>
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>> --
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From juantomas.sayago at gmail.com  Tue Nov 15 20:59:29 2011
From: juantomas.sayago at gmail.com (Juan Tomas Sayago)
Date: Tue, 15 Nov 2011 14:59:29 -0500
Subject: [R-sig-Geo] Reverse Geocode
Message-ID: <CAEOXpNASx1bOkfhXx3+WYWQKX3hrSoSUJXGuFptQMHYnbDCcPQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111115/9bce4e51/attachment.pl>

From gianni.lavaredo at gmail.com  Wed Nov 16 01:23:51 2011
From: gianni.lavaredo at gmail.com (gianni lavaredo)
Date: Wed, 16 Nov 2011 01:23:51 +0100
Subject: [R-sig-Geo] problem to tunning RandomForest, an unexpected result
Message-ID: <CAJ6JbR_Ogy=2o4xLxtOmax1FOskNkp=RGcg72ms+JGq74xnLcw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111116/e603785a/attachment.pl>

From alexandresantosbr at yahoo.com.br  Wed Nov 16 02:07:46 2011
From: alexandresantosbr at yahoo.com.br (ASANTOS)
Date: Tue, 15 Nov 2011 23:07:46 -0200
Subject: [R-sig-Geo] Inverse distance weighted with binomial data set
Message-ID: <4EC30CE2.80204@yahoo.com.br>

Dear colleges,

          There are any limitation for used the inverse distance 
weighted (IDW) for presence-absence data set, when the objective is 
create a map similar with indicator kriging (IK) approach? I don't no if 
is a trivial question but the idea is comparing both approaches.

Thanks,

-- 
Alexandre DOS SANTOS
Engenheiro Florestal, Msc.
Laborat?rio de Entomologia Florestal
Departamento de Entomologia
Universidade Federal de Lavras
Caixa Postal 3037
37200-000 - Lavras - Minas Gerais - Brasil
Tel: +55 35 92230304


From pgalpern at gmail.com  Wed Nov 16 04:30:53 2011
From: pgalpern at gmail.com (pgalpern)
Date: Tue, 15 Nov 2011 21:30:53 -0600
Subject: [R-sig-Geo] Introductory tutorials posted: using the raster package
 for landscape ecology
Message-ID: <4EC32E6D.7010206@gmail.com>

Hello!

Some readers of the list may be interested in a series of tutorials I 
have developed for an graduate student audience.  These are introductory 
in nature, and assume no prior knowledge of R.  They are intended to 
build skill at using R, particularly the raster package, for 
applications in landscape ecology.

The three tutorials as well as supporting landscape and ecological data 
are posted in PDF at http://nricaribou.cc.umanitoba.ca/R/

An abbreviated table of contents:

Workshop 1:  Getting R to work for you

Workshop 2:  Spatial analysis - Introduction
   GIS data formats
   Building a landscape raster
   Calculating landscape metrics

Workshop 3:  Spatial analysis - Applications
   Exploring a real landscape
   Using point locations to produce landscape variables
       Extraction using buffered points
       Minimum distance from a point to a class

Best,
Paul

-- 
Paul Galpern, PhD Candidate
Natural Resources Institute
70 Dysart Road
University of Manitoba
Winnipeg, Manitoba, Canada R3T 2M6
http://borealscape.ca


From swpt07 at gmail.com  Wed Nov 16 04:32:00 2011
From: swpt07 at gmail.com (steven wilson)
Date: Wed, 16 Nov 2011 00:32:00 -0300
Subject: [R-sig-Geo] intersection of two SpatialPolygonsDataFrame
Message-ID: <CAFxOHssuWPkRm5GAR-yVNyPqP+ghvwJWgD2DkNY8rO5uzk=aYQ@mail.gmail.com>

Dear all;

I have been working within R for performing the GIS-like operations
with shapefiles. My goal is to overlay two spatial polygon data frames
so I can add info from one of them to the other. I've tried severals
option such as converting one of them to a spatial polygon object
(without the associated info) in order to use the 'over' function from
the maptools library. I have also tried the PBSmapping library and the
aggregate function from maptools without success so far. Is there any
way to perform this type of operation in R like in ArcGIS? I would
appreciate any hint.

Thanks in advance

SW


From mathieu.rajerison at gmail.com  Wed Nov 16 07:47:13 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Wed, 16 Nov 2011 07:47:13 +0100
Subject: [R-sig-Geo] Coercing spatstat::psp to sp:SpatialLines
In-Reply-To: <alpine.LRH.2.00.1111151814000.1890@reclus.nhh.no>
References: <CAGfc75=-puQMdwAS-AWnZ84mLezikhZANZj+dDsPazj77qXStQ@mail.gmail.com>
	<alpine.LRH.2.00.1111151814000.1890@reclus.nhh.no>
Message-ID: <CAGfc75=V5_gyEK1LcivBgMM=xeeA0BWwzfMi3Qwn6sWJD23S_Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111116/4b82bd8f/attachment.pl>

From mathieu.rajerison at gmail.com  Wed Nov 16 07:50:17 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Wed, 16 Nov 2011 07:50:17 +0100
Subject: [R-sig-Geo] Introductory tutorials posted: using the raster
 package for landscape ecology
In-Reply-To: <4EC32E6D.7010206@gmail.com>
References: <4EC32E6D.7010206@gmail.com>
Message-ID: <CAGfc75k96a_GS22oEZCY=RrtUGX17DhQ3hdOFbrjbGJ5OyK71A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111116/68ca61ca/attachment.pl>

From mathieu.rajerison at gmail.com  Wed Nov 16 08:49:13 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Wed, 16 Nov 2011 08:49:13 +0100
Subject: [R-sig-Geo] Coercing spatstat::psp to sp:SpatialLines
In-Reply-To: <CAGfc75=V5_gyEK1LcivBgMM=xeeA0BWwzfMi3Qwn6sWJD23S_Q@mail.gmail.com>
References: <CAGfc75=-puQMdwAS-AWnZ84mLezikhZANZj+dDsPazj77qXStQ@mail.gmail.com>
	<alpine.LRH.2.00.1111151814000.1890@reclus.nhh.no>
	<CAGfc75=V5_gyEK1LcivBgMM=xeeA0BWwzfMi3Qwn6sWJD23S_Q@mail.gmail.com>
Message-ID: <CAGfc75mv4so81qnmpwrXufidtvcDTi01y8Nqi-q3q1RHihvytA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111116/baf83350/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Wed Nov 16 09:30:17 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed, 16 Nov 2011 08:30:17 +0000
Subject: [R-sig-Geo] intersection of two SpatialPolygonsDataFrame
In-Reply-To: <CAFxOHssuWPkRm5GAR-yVNyPqP+ghvwJWgD2DkNY8rO5uzk=aYQ@mail.gmail.com>
References: <CAFxOHssuWPkRm5GAR-yVNyPqP+ghvwJWgD2DkNY8rO5uzk=aYQ@mail.gmail.com>
Message-ID: <CANVKczPR7ZnxkXiPTEq9pAavZUR9RtEWHDXz0U7RwtDE63FYRA@mail.gmail.com>

On Wed, Nov 16, 2011 at 3:32 AM, steven wilson <swpt07 at gmail.com> wrote:
> Dear all;
>
> I have been working within R for performing the GIS-like operations
> with shapefiles. My goal is to overlay two spatial polygon data frames
> so I can add info from one of them to the other. I've tried severals
> option such as converting one of them to a spatial polygon object
> (without the associated info) in order to use the 'over' function from
> the maptools library. I have also tried the PBSmapping library and the
> aggregate function from maptools without success so far. Is there any
> way to perform this type of operation in R like in ArcGIS? I would
> appreciate any hint.

 Have you tried the rgeos package? It has (probably) all the spatial
overlay, buffering, merge/union/diff etc operations that you might
ever need!

 What, more precisely, is your problem? I can only guess that you've
got two spatial polygons data frames which have the same geometry but
different attributes, but the polygons are in a different order and
there's no ID variable to link them?

 If the geometries aren't the same then the operation is a bit
trickier since you have to deal with overlaps, and then decide how the
attributes from each layer end up in the result...

Barry


From d.nuest at 52north.org  Wed Nov 16 10:15:10 2011
From: d.nuest at 52north.org (=?windows-1252?Q?Daniel_N=FCst?=)
Date: Wed, 16 Nov 2011 10:15:10 +0100
Subject: [R-sig-Geo] Reverse Geocode
In-Reply-To: <CAEOXpNASx1bOkfhXx3+WYWQKX3hrSoSUJXGuFptQMHYnbDCcPQ@mail.gmail.com>
References: <CAEOXpNASx1bOkfhXx3+WYWQKX3hrSoSUJXGuFptQMHYnbDCcPQ@mail.gmail.com>
Message-ID: <4EC37F1E.10706@52north.org>

Am 15.11.2011 20:59, schrieb Juan Tomas Sayago:
> Does someone knows how to set up the google api to reverse geocode?

I don't really see how this is R related, but a Google search results in

http://gmaps-samples.googlecode.com/svn/trunk/geocoder/reverse.html

HTH,
Daniel


-- 
Daniel N?st
52? North Initiative for Geospatial Open Source Software GmbH
Martin-Luther-King-Weg 24
48155 M?nster, Germany
E-Mail: d.nuest at 52north.org
Fon: +49-(0)-251?396371-36
Fax: +49-(0)-251?396371-11
http://52north.org/
General Managers: Dr. Albert Remke, Dr. Andreas Wytzisk
Local Court Muenster HRB 10849


From paulojus at c3sl.ufpr.br  Wed Nov 16 11:21:22 2011
From: paulojus at c3sl.ufpr.br (Paulo Justiniano Ribeiro Jr)
Date: Wed, 16 Nov 2011 08:21:22 -0200 (BRST)
Subject: [R-sig-Geo] Inverse distance weighted with binomial data set
In-Reply-To: <4EC30CE2.80204@yahoo.com.br>
References: <4EC30CE2.80204@yahoo.com.br>
Message-ID: <alpine.DEB.2.00.1111160817590.10976@macalan.c3sl.ufpr.br>

Alexandre

idw in this context will produce values in [0,1]
and therefore comparable "estimates".
idw is an algorithm which can produce exploratory analysis
however not a model so
the issues will be the same with idw for continuos
values such as: sensibility with data configuration (specially with 
clustered data), prediction errors, allowing for covariates etc.

Paulo Justiniano Ribeiro Jr
LEG (Laboratorio de Estatistica e Geoinformacao)
Universidade Federal do Parana
Caixa Postal 19.081
CEP 81.531-990
Curitiba, PR  -  Brasil
Tel: (+55) 41 3361 3573
VOIP: (+55) (41) (3361 3600) 1053 1066
Fax: (+55) 41 3361 3141
e-mail: paulojus AT  ufpr  br
http://www.leg.ufpr.br/~paulojus

On Tue, 15 Nov 2011, ASANTOS wrote:

> Dear colleges,
>
>         There are any limitation for used the inverse distance weighted 
> (IDW) for presence-absence data set, when the objective is create a map 
> similar with indicator kriging (IK) approach? I don't no if is a trivial 
> question but the idea is comparing both approaches.
>
> Thanks,
>
> -- 
> Alexandre DOS SANTOS
> Engenheiro Florestal, Msc.
> Laborat?rio de Entomologia Florestal
> Departamento de Entomologia
> Universidade Federal de Lavras
> Caixa Postal 3037
> 37200-000 - Lavras - Minas Gerais - Brasil
> Tel: +55 35 92230304
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

From juantomas.sayago at gmail.com  Wed Nov 16 12:57:17 2011
From: juantomas.sayago at gmail.com (Juan Tomas Sayago)
Date: Wed, 16 Nov 2011 06:57:17 -0500
Subject: [R-sig-Geo] Reverse Geocode
In-Reply-To: <4EC37F1E.10706@52north.org>
References: <CAEOXpNASx1bOkfhXx3+WYWQKX3hrSoSUJXGuFptQMHYnbDCcPQ@mail.gmail.com>
	<4EC37F1E.10706@52north.org>
Message-ID: <CAEOXpNDz3zv=oM4h-VrPNbdenocLB1Pt+=t_a+11RwoD6axw-g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111116/30320962/attachment.pl>

From herreria at eco.uji.es  Wed Nov 16 14:03:48 2011
From: herreria at eco.uji.es (Maria Jesus Herrerias)
Date: Wed, 16 Nov 2011 14:03:48 +0100
Subject: [R-sig-Geo] intervals in a map
Message-ID: <CAPvcma3CKaQ9P5grn+KeDtojfhY0i6pHGtdmXBOEr=-2qOzwgQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111116/b24ea503/attachment.pl>

From Roger.Bivand at nhh.no  Wed Nov 16 14:33:56 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 16 Nov 2011 14:33:56 +0100 (CET)
Subject: [R-sig-Geo] write/readOGR issue with date / time strings
In-Reply-To: <alpine.LRH.2.00.1111151934090.1890@reclus.nhh.no>
References: <CAE6D7D7.CC8D%corrie.curtice@duke.edu>
	<alpine.LRH.2.00.1111151934090.1890@reclus.nhh.no>
Message-ID: <alpine.LRH.2.00.1111161430580.16541@reclus.nhh.no>

On Tue, 15 Nov 2011, Roger Bivand wrote:

> On Tue, 15 Nov 2011, Corrie Curtice wrote:
>
>> Hi Roger,
>> 
>> Thanks for your patience. This one is confusing to me as I've done exactly
>> (well, I think exactly) the same steps in the past and it has worked fine.
>> The only difference is (a) I'm using Rstudio which made me (b) update my
>> rgdal library version.  I've always converted date/time fields using
>> as.character or format().  Answers to your questions embedded below...
>> 
>
> Nothing has changed that should cause this misbehaviour. Can you save() the 
> spatial points data frame and put it on a link for me to pick up to try to 
> reproduce your problem on a different platform? The GDAL release isn't the 
> issue, I think. Did you say how the data was read into R?
>

The issue was that in columns/fields with names over 10 characters, the 
values were not written (in OGR for the ESRI Shapefile driver). The 
work-around - use short field names of 10 characters or fewer. A fresh 
rgdal with a fix which arbitrarily abbreviates names has been submitted to 
CRAN.

Roger

> Roger
>
>> 
>> On 11/12/11 3:17 PM, "Roger Bivand" <Roger.Bivand at nhh.no> wrote:
>> 
>> 
>>> On Fri, 11 Nov 2011, Corrie Curtice wrote:
>>> 
>>>> 
>>>>> sessionInfo()
>>>> R version 2.13.1 (2011-07-08)
>>>> Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)
>>>> 
>>>> locale:
>>>> [1] C/en_US.UTF-8/C/C/C/C
>>>> 
>>>> attached base packages:
>>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>> 
>>>> other attached packages:
>>>> [1] rgdal_0.7-1 sp_0.9-84
>>> 
>>> OK, you have the most recent release.
>>> 
>>>> 
>>>> loaded via a namespace (and not attached):
>>>> [1] grid_2.13.1     lattice_0.19-30 tools_2.13.1
>>>> 
>>>> I installed rgdal and PROJ4 as follows:
>>>> 
>>>> setRepositories(ind=1:2)
>>>> install.packages("rgdal")
>>>> install.packages("PROJ.4")
>>>> 
>>> 
>>> Quoting the loading messages would help, to confirm the version of the
>>> underlying GDAL binary. The PROJ.4 package is not required or used by
>>> rgdal. My rgdal version on Fedora reports:
>>> 
>>>> library(rgdal)
>>> Loading required package: sp
>>> Geospatial Data Abstraction Library extensions to R successfully loaded
>>> Loaded GDAL runtime: GDAL 1.8.1, released 2011/06/04
>>> Path to GDAL shared files: /usr/local/share/gdal
>>> Loaded PROJ.4 runtime: Rel. 4.7.1, 23 September 2009, [PJ_VERSION: 470]
>>> Path to PROJ.4 shared files: (autodetected)
>>> 
>> 
>> Here's the output from loading rgdal:
>> 
>>> library(rgdal)
>> Geospatial Data Abstraction Library extensions to R successfully loaded
>> Loaded GDAL runtime: GDAL 1.8.0, released 2011/01/12
>> Path to GDAL shared files:
>> /Users/corriecurtice/Library/R/2.13/library/rgdal/gdal
>> Loaded PROJ.4 runtime: Rel. 4.7.1, 23 September 2009, [PJ_VERSION: 470]
>> Path to PROJ.4 shared files:
>> /Users/corriecurtice/Library/R/2.13/library/rgdal/proj
>>> 
>> 
>> So there's a slightly newer GDAL release (1.8.1).  I'm in the process of
>> trying to get that installed but not having a lot of luck.  I downloaded
>> and installed gdal v1.8.1-1 leopard (and dependencies). I assume I need to
>> re-compile the rgdal package so it sees this new version but I get an
>> error when trying to do that:
>> 
>> corrie-curtices-macbook-pro:Downloads corriecurtice$ !R
>> R CMD INSTALL
>> --configure-args='--with-gdal-config=/Library/Frameworks/GDAL.framework/Pro
>> grams/gdal-config
>> --with-proj-include=/Library/Frameworks/PROJ.framework/Headers
>> --with-proj-lib=/Library/Frameworks/PROJ.framework/unix/lib'
>> rgdal_0.7-4.tar.gz
>> * installing to library ?/Users/corriecurtice/Library/R/2.13/library?
>> * installing *source* package ?rgdal? ...
>> gdal-config: /Library/Frameworks/GDAL.framework/Programs/gdal-config
>> checking for gcc... gcc-4.2 -arch i386 -std=gnu99
>> checking whether the C compiler works... no
>> configure: error: in
>> `/private/var/folders/jD/jDD8BZCHHLC-VOQmq7vTGk+++TI/-Tmp-/RtmpTlKhSZ/R.INS
>> TALL253fc47f/rgdal':
>> configure: error: C compiler cannot create executables
>> See `config.log' for more details
>> ERROR: configuration failed for package ?rgdal?
>> * removing ?/Users/corriecurtice/Library/R/2.13/library/rgdal?
>> * restoring previous ?/Users/corriecurtice/Library/R/2.13/library/rgdal?
>> 
>> 
>> I can't find the config.log file, the tmp directory referenced is empty
>> and it's not in my cwd.
>> 
>>>> 
>>>> 
>>> 
>>> I do not see the problem in the R-forge development version, and cannot
>>> reproduce the problem. This now works in (unreleased) 0.7-4:
>>> 
>>> library(rgdal)
>>> dsn <- system.file("vectors", package = "rgdal")[1]
>>>   kiritimati_primary_roads <- readOGR(dsn=dsn,
>>> layer="kiritimati_primary_roads")
>>> summary(kiritimati_primary_roads)
>>> kiritimati_primary_roads$dt <- as.POSIXct("2011-11-11 11:11:11")+(60*0:34)
>>> summary(kiritimati_primary_roads)
>>> td <- tempdir()
>>> writeOGR(kiritimati_primary_roads, td, "kiri1", driver="ESRI Shapefile")
>>> kiri1 <- readOGR(td, "kiri1")
>>> summary(kiri1)
>>> kiri1$dt <- as.POSIXct(as.character(kiri1$dt))
>>> summary(kiri1)
>>> 
>>> This failed in 0.7-1 because the POSIXct column is not recognized as also
>>> POSIXt; this is corrected in 0.7-4. However, this was not the original
>>> problem. Had you reported the output of:
>>> 
>>> sapply(spdfUTM at data, class)
>>> sapply(spdfUTM at data, storage.mode)
>>> 
>>> we would have known how krillGMTtime was stored - it does not seem to
>>> have
>>> been detected as a column requiring conversion to character string, or as
>>> a column that should trigger an error. In general, as Alex wrote, all
>>> date
>>> time columns should be converted to character and converted back on
>>> reading back from the shapefile. OGR drivers treat field types
>>> differently, so writeOGR has to take a conservative view of possibilities.
>> 
>> Here's the output from the sapply:
>> 
>> 
>>> sapply(spdfUTM at data, class)
>> krillGMTtime          Lat          Lon
>>    "factor"     "factor"     "factor"
>>> sapply(spdfUTM at data, storage.mode)
>> krillGMTtime          Lat          Lon
>>   "integer"    "integer"    "integer"
>> 
>> 
>> To answer Don's question, yes I have bad LAT/LON rows when I first read
>> them in but they are all 999. I discard them before making my spatial
>> points data frame, which does in fact use those two columns for the
>> coordinates. I have another similar dataset where the date/time field
>> storage.mode is reported as "character" and not "integer", and has the
>> same issue.
>> 
>> 
>> Thanks for the help.
>> 
>> Corrie
>> 
>> 
>>> Hope this clarifies,
>>> 
>>> Roger
>>> 
>>>> Thanks,
>>>> 
>>>> Corrie
>>>> 
>>>> 
>>>> 
>>>> On 11/11/11 5:31 PM, "Roger Bivand" <Roger.Bivand at nhh.no> wrote:
>>>> 
>>>>> On Fri, 11 Nov 2011, Corrie Curtice wrote:
>>>>> 
>>>>>> Hello,
>>>>>> 
>>>>>> Apologies if this has already been addressed somewhere, I did a brief
>>>>>> search
>>>>>> of archives but didn't find quite this issue.
>>>>> 
>>>>> Which versions of what are you using? You should provide the output of
>>>>> sessionInfo(), the messages given when rgdal loads, and details of how
>>>>> you
>>>>> installed rgdal. In addition, a use case would be helpful, but only
>>>>> when
>>>>> we know what version you are using. In current rgdal, data frame
>>>>> columns
>>>>> of class POSIXt are converted to character strings before writing with
>>>>> writeOGR().
>>>>> 
>>>>> Roger
>>>>> 
>>>>>> 
>>>>>> I'm writing out an ESRI shapefile.  My spdf has a date/time field.
>>>>>> Looks
>>>>>> like this:
>>>>>> 
>>>>>>> head(spdfUTM at data)
>>>>>>           krillGMTtime          Lat          Lon
>>>>>> 1   2010-05-12 12:34:21 -64.67655969 -62.15040195
>>>>>> 21  2010-05-12 12:35:12  -64.6771229  -62.1519511
>>>>>> 38  2010-05-12 12:36:02 -64.67775863 -62.15340614
>>>>>> 57  2010-05-12 12:36:53 -64.67838269 -62.15494829
>>>>>> 78  2010-05-12 12:37:43 -64.67901497 -62.15647203
>>>>>> 100 2010-05-12 12:38:37 -64.67973667 -62.15773224
>>>>>> 
>>>>>> All three fields are reported to be "factors" by str.  writeOGR
>>>>>> appears
>>>>>> happy:
>>>>>> 
>>>>>>> writeOGR(spdfUTM,dd,layer="krillPoints-UTM",driver="ESRI
>>>>>> Shapefile",verbose=TRUE,overwrite=TRUE)
>>>>>> $object_type
>>>>>> [1] "SpatialPointsDataFrame"
>>>>>> $output_dsn
>>>>>> [1] "/users/corriecurtice/documents/Data_2010/Shapefiles/"
>>>>>> $output_layer
>>>>>> [1] "krillPoints-UTM"
>>>>>> $output_diver
>>>>>> [1] "ESRI Shapefile"
>>>>>> $output_n
>>>>>> [1] 11179
>>>>>> $output_nfields
>>>>>> [1] 3
>>>>>> $output_fields
>>>>>> [1] "krillGMTtime" "Lat"          "Lon"
>>>>>> $output_fclasses
>>>>>> [1] 4 4 4
>>>>>> $dataset_options
>>>>>> NULL
>>>>>> $layer_options
>>>>>> NULL
>>>>>> Warning message:
>>>>>> In writeOGR(spdfUTM, dd, layer = "krillPoints-UTM", driver = "ESRI
>>>>>> Shapefile",  :
>>>>>>  existing layer removed
>>>>>> 
>>>>>> When I read it right back in again, the date/time field is NAs.  This
>>>>>> is
>>>>>> also true if I load the shapefile into ArcMap.
>>>>>> 
>>>>>>> foo <- readOGR(dd,layer="krillPoints-UTM",verbose=TRUE)
>>>>>> OGR data source with driver: ESRI Shapefile
>>>>>> Source: "/users/corriecurtice/documents/Data_2010/Shapefiles/", layer:
>>>>>> "krillPoints-UTM"
>>>>>> with 11179 features and 3 fields
>>>>>> Feature type: wkbPoint with 2 dimensions
>>>>>> 
>>>>>>> head(foo at data)
>>>>>>  krillGMTti          Lat          Lon
>>>>>> 1       <NA> -64.67655969 -62.15040195
>>>>>> 2       <NA>  -64.6771229  -62.1519511
>>>>>> 3       <NA> -64.67775863 -62.15340614
>>>>>> 4       <NA> -64.67838269 -62.15494829
>>>>>> 5       <NA> -64.67901497 -62.15647203
>>>>>> 6       <NA> -64.67973667 -62.15773224
>>>>>> 
>>>>>> Thoughts? Am I missing something obvious?
>>>>>> 
>>>>>> I can break it up into separate date and time fields, but since the
>>>>>> field is
>>>>>> simply a factor anyways I'm not sure how that would help.
>>>>>> 
>>>>>> Cheers,
>>>>>> 
>>>>>> Corrie
>>>>>> 
>>>>>> ---
>>>>>> Corrie Curtice
>>>>>> Research Analyst
>>>>>> Marine Geospatial Ecology Lab
>>>>>> Nicholas School of the Environment, Duke University
>>>>>> http://mgel.env.duke.edu
>>>>>> em: corrie.curtice at duke.edu
>>>>>> ph: 252-504-7538
>>>>>> 
>>>>>> 
>>>>>> 
>>>>>>
>>>>>>     [[alternative HTML version deleted]]
>>>>>> 
>>>>>> _______________________________________________
>>>>>> R-sig-Geo mailing list
>>>>>> R-sig-Geo at r-project.org
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>> 
>>>>> 
>>>>> --
>>>>> Roger Bivand
>>>>> Department of Economics, NHH Norwegian School of Economics,
>>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>>>> e-mail: Roger.Bivand at nhh.no
>>>>> 
>>>> 
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>> 
>>> 
>>> --
>>> Roger Bivand
>>> Department of Economics, NHH Norwegian School of Economics,
>>> Helleveien 30, N-5045 Bergen, Norway.
>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>> e-mail: Roger.Bivand at nhh.no
>> 
>> 
>> 
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From pgalpern at gmail.com  Wed Nov 16 15:16:35 2011
From: pgalpern at gmail.com (Paul Galpern)
Date: Wed, 16 Nov 2011 08:16:35 -0600
Subject: [R-sig-Geo] Introductory tutorials posted: using the raster
 package for landscape ecology
In-Reply-To: <CAGfc75k96a_GS22oEZCY=RrtUGX17DhQ3hdOFbrjbGJ5OyK71A@mail.gmail.com>
References: <4EC32E6D.7010206@gmail.com>
	<CAGfc75k96a_GS22oEZCY=RrtUGX17DhQ3hdOFbrjbGJ5OyK71A@mail.gmail.com>
Message-ID: <4EC3C5C3.6050106@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111116/36379972/attachment.pl>

From acmonmany at gmail.com  Wed Nov 16 16:08:55 2011
From: acmonmany at gmail.com (carolina monmany)
Date: Wed, 16 Nov 2011 11:08:55 -0400
Subject: [R-sig-Geo] units is semivariograms in GeoR
Message-ID: <CANEaUWsPD9DqogXTzUVcNa9pqpH=+Eu7syViCnG5eN8Fm5TMew@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111116/95772f8b/attachment.pl>

From paul.hiemstra at knmi.nl  Wed Nov 16 16:17:18 2011
From: paul.hiemstra at knmi.nl (Paul Hiemstra)
Date: Wed, 16 Nov 2011 15:17:18 +0000
Subject: [R-sig-Geo] units is semivariograms in GeoR
In-Reply-To: <CANEaUWsPD9DqogXTzUVcNa9pqpH=+Eu7syViCnG5eN8Fm5TMew@mail.gmail.com>
References: <CANEaUWsPD9DqogXTzUVcNa9pqpH=+Eu7syViCnG5eN8Fm5TMew@mail.gmail.com>
Message-ID: <4EC3D3FE.7080102@knmi.nl>

Hi,

This is mail is a bit on the short side :), so please try and be more
complete next time. I think what you want to know is what the units are
in a semi-variogram. For the y-axis, they are the unit of the variable
of interest squared. So if the variable is m/s, than the semi-variogram
has units (m/s)^2. For the x-axis they are most probably the distance
unit in which the coordinate system of your data set is, e.g. kilometer.

hope this helps,
Paul

On 11/16/2011 03:08 PM, carolina monmany wrote:

-- 
Paul Hiemstra, Ph.D.
Global Climate Division
Royal Netherlands Meteorological Institute (KNMI)
Wilhelminalaan 10 | 3732 GK | De Bilt | Kamer B 3.39
P.O. Box 201 | 3730 AE | De Bilt
tel: +31 30 2206 494

http://intamap.geo.uu.nl/~paul
http://nl.linkedin.com/pub/paul-hiemstra/20/30b/770


From mathieu.rajerison at gmail.com  Wed Nov 16 16:26:19 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Wed, 16 Nov 2011 16:26:19 +0100
Subject: [R-sig-Geo] Introductory tutorials posted: using the raster
 package for landscape ecology
In-Reply-To: <4EC3C5C3.6050106@gmail.com>
References: <4EC32E6D.7010206@gmail.com>
	<CAGfc75k96a_GS22oEZCY=RrtUGX17DhQ3hdOFbrjbGJ5OyK71A@mail.gmail.com>
	<4EC3C5C3.6050106@gmail.com>
Message-ID: <CAGfc75nsYEyFp-PB8YaaA_WLzfgF-4fvjvu5Bv-HszuJda39Sw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111116/5b96bbc7/attachment.pl>

From acmonmany at gmail.com  Wed Nov 16 16:42:51 2011
From: acmonmany at gmail.com (carolina monmany)
Date: Wed, 16 Nov 2011 11:42:51 -0400
Subject: [R-sig-Geo] units is semivariograms in GeoR
In-Reply-To: <4EC3D3FE.7080102@knmi.nl>
References: <CANEaUWsPD9DqogXTzUVcNa9pqpH=+Eu7syViCnG5eN8Fm5TMew@mail.gmail.com>
	<4EC3D3FE.7080102@knmi.nl>
Message-ID: <CANEaUWuV3aB7unL3P=Ka6vzEfuQqQCWzy9=d_4_bAWPOqdd+og@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111116/9095d7cc/attachment.pl>

From Jan.Quets at ua.ac.be  Wed Nov 16 18:25:41 2011
From: Jan.Quets at ua.ac.be (Quets Jan)
Date: Wed, 16 Nov 2011 17:25:41 +0000
Subject: [R-sig-Geo] compilepcf
Message-ID: <F7452FEC9FABCF4493C2DBB2E9DC31CE558F5EFD@xmail32.ad.ua.ac.be>

suppose v is a point pattern; 

D  = pairdist(v)
f1 = pcf(v)

and

f2 = (compilepcf(D,r=f1$r))/(2*pi*f1$r)

How to make pcf and compilepcf do the same job (or how to make f1$obs and f2$est equal)? f1$obs and f2$est do not only differ by a constant value, so scaling either f1$obs or f2$est with a constant, cannot make these vectors equal.


PS: The purpose is to use compilepcf with another distance matrix, but first I want to check if it works by generating the pcf with compilepcf, and comparing this result with pcf(v)$obs (should be more or less equal)

kind regards,
Jan
________________________________________
Van: Adrian.Baddeley at csiro.au [Adrian.Baddeley at csiro.au]
Verzonden: maandag 29 augustus 2011 6:01
Aan: r-sig-geo at r-project.org
CC: Quets Jan; Adrian.Baddeley at csiro.au; r.turner at auckland.ac.nz
Onderwerp: [R-sig-geo] can a (modified) pairdist() output be used as a basis for calculating a pcf

Jan Quets <Jan.Quets at ua.ac.be> heeft geschreven:

> suppose that I want to change the pcf function in such a way that it
> doesn't 'use' the distribution of point-to-point distances,
> but instead 'uses' the distribution of edge-to-edge distances.
>  [ ... ]
> is it possible in spatstat to [... ] calculate the (modified)-pcf
> in an easy way by use of some specific spatstat functions?

      Yes.
        As a temporary measure, you could use the (currently undocumented)
      function 'compilepcf'.
        You need something like the following invocation:

           f <- compilepcf(D, r=handle.r.b.args(window=W))

      where D is the pairwise distance matrix, and W is the window containing the
      data. The result is an 'fv' class object. You may have to rescale it
      using eval.fv.

      Of course you'll need to think carefully about what this calculation means,
      in order to decide how to rescale it, etc.

      For the usual pair correlation function, you would have to subsequently
      divide f(r) by 2 * pi * r. This normalisation is not carried out by 'compilepcf'.

      This will not work in spatstat 2 where we will have a different mechanism that
      is faster.

> to calculate a square matrix of edge-to-edge distances (E2E):
> for (i in 1:100){
> for (j in 1:100){
>  sumradii[i,j] = vmrad$marks[i] + vmrad$marks[j]
> }
> }
> E2E = pairdist(vmrad) - sumradii

      You can do this faster using

        sumradii <- outer(marks(vmrad), marks(vmrad), "+")

      You will also need to reset the diagonal of 'E2E' to infinity so that it
      is not used:

         diag(E2E) <- Inf

Adrian Baddeley


From moshersteven at gmail.com  Wed Nov 16 19:50:07 2011
From: moshersteven at gmail.com (steven mosher)
Date: Wed, 16 Nov 2011 10:50:07 -0800
Subject: [R-sig-Geo] Introductory tutorials posted: using the raster
 package for landscape ecology
In-Reply-To: <4EC32E6D.7010206@gmail.com>
References: <4EC32E6D.7010206@gmail.com>
Message-ID: <CAFFLneQdSsZO-16gT0R2iDHsbWOxfnjyCn9fYemhYoYYUSGtpw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111116/54fbcc69/attachment.pl>

From r.turner at auckland.ac.nz  Thu Nov 17 02:51:37 2011
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Thu, 17 Nov 2011 14:51:37 +1300
Subject: [R-sig-Geo] Coercing spatstat::psp to sp:SpatialLines
In-Reply-To: <CAGfc75mv4so81qnmpwrXufidtvcDTi01y8Nqi-q3q1RHihvytA@mail.gmail.com>
References: <CAGfc75=-puQMdwAS-AWnZ84mLezikhZANZj+dDsPazj77qXStQ@mail.gmail.com>	<alpine.LRH.2.00.1111151814000.1890@reclus.nhh.no>	<CAGfc75=V5_gyEK1LcivBgMM=xeeA0BWwzfMi3Qwn6sWJD23S_Q@mail.gmail.com>
	<CAGfc75mv4so81qnmpwrXufidtvcDTi01y8Nqi-q3q1RHihvytA@mail.gmail.com>
Message-ID: <4EC468A9.8040400@auckland.ac.nz>

On 16/11/11 20:49, Mathieu Rajerison wrote:
> Finally, I got a SpatialLines from a psp object (here named aix.psp)
>
> Here's how I got it:
>
> coords<- aix.psp$ends
> nc<- nrow(coords)
> out<- vector(mode="list", length=nc)
>
> for (i in seq(along=out)) {
>    lLine<-Line(cbind(c(coords[i,1], coords[i,3]), c(coords[i,2],
> coords[i,4])))
>    out[[i]]<- Lines(list(lLine), ID=i)
> }
>
> aix.lines<- SpatialLines(out)
>
> I don't find my solution very elegant. I wondered if a simpler code could
> be written using lapply function.
>
> For that purpose, I did:
> liste<-lapply(coords, function(x) Line(cbind(c(x[1], x[3]), c(x[2], x[4]))))
> but I don't know how to create a list of this one, with an incrementating
> ID, which is required for constructing a Lines object as
> Lines(list(LineList), ID=i)
> It's more a general R problem than an R-sig-geo one but if anyone here has
> the issue, I would be thankful.

I hacked your code a bit and came up with the following:

# Generic function for S3 method:
as.SpatialLines <- function(from) {
UseMethod("as.SpatialLines")
}

# Method for class "psp".
as.SpatialLines.psp <- function (from) {
foo <- function(i,x){
     y <- matrix(unlist(x[i,]),2,2,byrow=TRUE)
     Lines(list(Line(y)),ID=i)
}
coords <- from$ends
SpatialLines(lapply(1:nrow(coords),foo,x=coords))
}

After sourcing in these two functions, try:

check <- as.SpatialLines(aix.psp)

and then compare:

all.equal(check,aix.lines) # Should get TRUE!!!

I *thought* that after having defined as.SpatialLines.psp() as above I would
be able to do:

     check <- as(aix.psp,"SpatialLines")

but that gave me the error

Error in as(aix.psp, "SpatialLines") :
   no method or default for coercing "psp" to "SpatialLines"

even though I had just written such a method!  There must be some extra
S4 classes and methods magic required here, that I don't know about.

Roger?

(I never touch S4 classes and methods with a sterilised barge-pole!)

     cheers,

         Rolf


From lists at remoteinformation.com.au  Thu Nov 17 03:27:38 2011
From: lists at remoteinformation.com.au (Ben Madin)
Date: Thu, 17 Nov 2011 10:27:38 +0800
Subject: [R-sig-Geo] units is semivariograms in GeoR
In-Reply-To: <CANEaUWuV3aB7unL3P=Ka6vzEfuQqQCWzy9=d_4_bAWPOqdd+og@mail.gmail.com>
References: <CANEaUWsPD9DqogXTzUVcNa9pqpH=+Eu7syViCnG5eN8Fm5TMew@mail.gmail.com>
	<4EC3D3FE.7080102@knmi.nl>
	<CANEaUWuV3aB7unL3P=Ka6vzEfuQqQCWzy9=d_4_bAWPOqdd+og@mail.gmail.com>
Message-ID: <B2841709-1631-4B60-9481-EE3C34543734@remoteinformation.com.au>

You will need to transform (re-project) your data into a suitable coordinate system - use the sptransform() function in the rgdal package, or look at p 64 in the ASDAR book.

depending on where you data is and how large an area it covers will influence your choice of coordinate reference system, but you might get away with a UTM grid 19 North for Puerto Rico - have a look here :

http://spatialreference.org/ref/epsg/32619/

cheers

Ben


On 16/11/2011, at 11:42 PM, carolina monmany wrote:

> Sorry. My problem is that I want the units in the x axis to be in meters
> but they are in degrees. How can I make R read the projected coordinate
> system, which is in meters, and not the geographic one?
> 
> Thanks!
> 
> 2011/11/16 Paul Hiemstra <paul.hiemstra at knmi.nl>
> 
>> Hi,
>> 
>> This is mail is a bit on the short side :), so please try and be more
>> complete next time. I think what you want to know is what the units are
>> in a semi-variogram. For the y-axis, they are the unit of the variable
>> of interest squared. So if the variable is m/s, than the semi-variogram
>> has units (m/s)^2. For the x-axis they are most probably the distance
>> unit in which the coordinate system of your data set is, e.g. kilometer.
>> 
>> hope this helps,
>> Paul
>> 
>> On 11/16/2011 03:08 PM, carolina monmany wrote:
>> 
>> --
>> Paul Hiemstra, Ph.D.
>> Global Climate Division
>> Royal Netherlands Meteorological Institute (KNMI)
>> Wilhelminalaan 10 | 3732 GK | De Bilt | Kamer B 3.39
>> P.O. Box 201 | 3730 AE | De Bilt
>> tel: +31 30 2206 494
>> 
>> http://intamap.geo.uu.nl/~paul
>> http://nl.linkedin.com/pub/paul-hiemstra/20/30b/770
>> 
>> 
> 
> 
> -- 
> ---------------------------
> A. CAROLINA MONMANY
> Universidad de Puerto Rico
> Departamento de Biologia - CN 235
> POBOX 23360
> San Juan, Puerto Rico 00931-3360
> Tel: +1 787 764 0000 x2847
> Fax: +1 787 764 2610
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Adrian.Baddeley at csiro.au  Thu Nov 17 04:32:28 2011
From: Adrian.Baddeley at csiro.au (Adrian.Baddeley at csiro.au)
Date: Thu, 17 Nov 2011 11:32:28 +0800
Subject: [R-sig-Geo] Coercing spatstat::psp to sp:SpatialLines
Message-ID: <57DC18C299094D4299F837570C5DF1C54EA3D7CC19@EXWA-MBX01.nexus.csiro.au>


Mathieu Rajerison <mathieu.rajerison at gmail.com> asks how to convert an object of class 'psp' in spatstat to an object of class SpatialLines in sp. 

Here is a function to do that. (It requires 'spatstat'.)


as.SpatialLines.psp <- local({

     ends2line <- function(x) Line(matrix(x, ncol=2, byrow=TRUE))
     munch <- function(z) { Lines(ends2line(as.numeric(z[1:4])), ID=z[5]) }
  
     convert <- function(x) {
        ends <- as.data.frame(x)[,1:4]
        ends[,5] <- row.names(ends)
        y <- apply(ends, 1, munch)
        SpatialLines(y)
     }
     convert
})


====

Prof Adrian Baddeley (UWA/CSIRO)
CSIRO Mathematics, Informatics & Statistics
Leeuwin Centre, 65 Brockway Road, Floreat WA 6014, Australia
Tel: 08 9333 6177 | Fax: 08 9333 6121 | Mob: 0410 447 821
Skype: adrian.baddeley


From Adrian.Baddeley at csiro.au  Thu Nov 17 05:10:55 2011
From: Adrian.Baddeley at csiro.au (Adrian.Baddeley at csiro.au)
Date: Thu, 17 Nov 2011 12:10:55 +0800
Subject: [R-sig-Geo] compilepcf
In-Reply-To: <F7452FEC9FABCF4493C2DBB2E9DC31CE558F5EFD@xmail32.ad.ua.ac.be>
References: <F7452FEC9FABCF4493C2DBB2E9DC31CE558F5EFD@xmail32.ad.ua.ac.be>
Message-ID: <57DC18C299094D4299F837570C5DF1C54EA3D7CC1A@EXWA-MBX01.nexus.csiro.au>


Jan Quets <Jan.Quets at ua.ac.be> heeft gevraagd:

   > How to make pcf and compilepcf do the same job 

This is a query about the package 'spatstat'.

It is a query about an _undocumented, internal_ feature of 'spatstat'. There are no guarantees that this feature will continue.

compilepcf() has an argument 'denom' which is the denominator for the pair correlation estimator. Under normal circumstances with a 2D point pattern, 'denom' should be an estimate of lambda^2 * A where lambda is the point process intensity and A is the area of the window containing the data. So take denom = npoints(X)^2/area.owin(as.owin(X)).

compilepcf() has an argument 'weights' which contains the edge correction weights for the pairwise distances. To get agreement between pcf.ppp() and compilepcf() you would also have to insert the same edge correction weights. In pcf.ppp() these are computed by the (undocumented!) functions edge.Trans and edge.Ripley. So set weights=edge.Trans(X) for example. 

compilepcf() has arguments "..." which are passed to density.default to control the smoothing. In pcf.ppp() the smoothing parameter is (by default) selected by Stoyan's rule of thumb but can be overridden by the argument 'bw'. To get agreement between pcf.ppp() and compilepcf() you would have to specify the same value of 'bw' to both.

compilepcf() uses the Gaussian smoothing kernel by default, while pcf.ppp() uses the Epanechnikov kernel by default. So you'd have to specify kernel="gaussian" in the call to pcf.ppp.

Finally you need to set 'endcorrect=FALSE' in compilepcf() because .... never mind.

Example:

bw <- bw.stoyan(redwood)
f1 <- pcf(redwood, kernel="gaussian", bw=bw)
r <- with(f1, r)
denom <- npoints(redwood)^2/area.owin(as.owin(redwood))
f2 <- compilepcf(D, r=r, 
                 denom=denom, weights=edge.Trans(redwood), bw=bw, 
                 endcorrect=FALSE)
f2 <- with(f2, ./(2 * pi * r))
plot(f1, trans ~ r)
plot(f2, add=TRUE)



============
Prof Adrian Baddeley (UWA/CSIRO)
CSIRO Mathematics, Informatics & Statistics
Leeuwin Centre, 65 Brockway Road, Floreat WA 6014, Australia
Tel: 08 9333 6177 | Fax: 08 9333 6121 | Mob: 0410 447 821
Skype: adrian.baddeley


From Roger.Bivand at nhh.no  Thu Nov 17 10:05:52 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 17 Nov 2011 10:05:52 +0100
Subject: [R-sig-Geo] Coercing spatstat::psp to sp:SpatialLines
In-Reply-To: <57DC18C299094D4299F837570C5DF1C54EA3D7CC19@EXWA-MBX01.nexus.csiro.au>
References: <57DC18C299094D4299F837570C5DF1C54EA3D7CC19@EXWA-MBX01.nexus.csiro.au>
Message-ID: <alpine.LRH.2.00.1111171002210.25216@reclus.nhh.no>

Thanks to contributions by Adrian Baddeley, Rolf Turner and Mathieu 
Rajerison, an S4 coercion method as(<psp-object>, "SpatialLines") and 
function as.SpatialLines.psp() are committed to R-forge SVN in the 
maptools project, and will be included in the next release of the 
maptools package.

Roger

On Thu, 17 Nov 2011, Adrian.Baddeley at csiro.au wrote:

>
> Mathieu Rajerison <mathieu.rajerison at gmail.com> asks how to convert an object of class 'psp' in spatstat to an object of class SpatialLines in sp.
>
> Here is a function to do that. (It requires 'spatstat'.)
>
>
> as.SpatialLines.psp <- local({
>
>     ends2line <- function(x) Line(matrix(x, ncol=2, byrow=TRUE))
>     munch <- function(z) { Lines(ends2line(as.numeric(z[1:4])), ID=z[5]) }
>
>     convert <- function(x) {
>        ends <- as.data.frame(x)[,1:4]
>        ends[,5] <- row.names(ends)
>        y <- apply(ends, 1, munch)
>        SpatialLines(y)
>     }
>     convert
> })
>
>
> ====
>
> Prof Adrian Baddeley (UWA/CSIRO)
> CSIRO Mathematics, Informatics & Statistics
> Leeuwin Centre, 65 Brockway Road, Floreat WA 6014, Australia
> Tel: 08 9333 6177 | Fax: 08 9333 6121 | Mob: 0410 447 821
> Skype: adrian.baddeley
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From matteo.mattiuzzi at boku.ac.at  Thu Nov 17 11:18:29 2011
From: matteo.mattiuzzi at boku.ac.at (Matteo Mattiuzzi)
Date: Thu, 17 Nov 2011 11:18:29 +0100
Subject: [R-sig-Geo] Tiling a raster
Message-ID: <4EC4ED85020000270001154E@gwia2.boku.ac.at>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111117/57d72e5b/attachment.pl>

From mathieu.rajerison at gmail.com  Thu Nov 17 13:19:25 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Thu, 17 Nov 2011 13:19:25 +0100
Subject: [R-sig-Geo] Coercing spatstat::psp to sp:SpatialLines
In-Reply-To: <CAGfc75=uiZKUw3efXnz4VmDUMs+KKfHQyWD47=emGuS07c0f3Q@mail.gmail.com>
References: <57DC18C299094D4299F837570C5DF1C54EA3D7CC19@EXWA-MBX01.nexus.csiro.au>
	<alpine.LRH.2.00.1111171002210.25216@reclus.nhh.no>
	<CAGfc75=uiZKUw3efXnz4VmDUMs+KKfHQyWD47=emGuS07c0f3Q@mail.gmail.com>
Message-ID: <CAGfc75nxwiGNLwirn5tDXby_4b=ReWRARmnOkBWuzwrhSg9g-g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111117/3a19b861/attachment.pl>

From aortizbobea at arec.umd.edu  Thu Nov 17 23:43:41 2011
From: aortizbobea at arec.umd.edu (Ariel Ortiz-Bobea)
Date: Thu, 17 Nov 2011 14:43:41 -0800 (PST)
Subject: [R-sig-Geo] inconsistencies between readGDAL and other software
 (GrADS) when reading GRIB1 files
Message-ID: <1321569821699-7006160.post@n2.nabble.com>

Hi,

I've been importing GRIB1 files into R through the readGDAL command in the
GDAL package.

However, the GRIB1 files are multi-band and during the import process I
"lose" the variable names and get generic names: band1, band2, etc. 

I have tried to circumvent this by using other software (GrADS) to obtain
summary statistics for each variable (of which I know the names) and then
compare these to summary statistics of each variable/band in R. Matching
summary statistics would allow me to get back the real names. 

However, there are discrepancies between summary statistics. More precisely,
there are differences between minimums, means and maximums between both
approaches AND these differences are not of the same magnitude (ruling out a
homogenous shift in values).

Moreover, GrADS gives temperatures in Kelvin and readGDAL seems to be
transforming them to Celsius BUT the difference between minimum, maximum and
means is not consistently 273.15 as one would expect. For instance, for soil
temperature the difference is 271.441 (for the mean), 270.514 (for the max)
and 273.149 (for the min), but for Dew point it is 269.436 (for the mean),
272.58 (for the max) and 273.349 (for the min). So it is not even consistent
across different temperature variables.

I wonder if this has to do with how GrADS or readGDAL read these GRIB1 files
(or the way I'm importing this)... would there be any hidden processing
going on that would explain this? Would using netCDF format files rather
than GRIB1 help in any way? Any suggestions or comments on how to import
this data in a manner in a proper way?

Thanks a lot in advance for any guidance on this,

Ariel

Here is my example file:
http://dl.dropbox.com/u/45311184/US48_merged_AWIP32.1985120100.RS.flx (in
GRIB1 format)

R code:
-------
# import
   flx<-  readGDAL("1985/US48_merged_AWIP32.1985120100.RS.flx")
# fix missing values (imported as 9999)
   for (n in 1:10 ){
      is.na(flx[[n]]) <- flx[[n]] > 9000
   }
# print summary statistics for each variable/band
   for (n in 1:10 ){
      print(summary(flx[[n]])[c(4,6,1)])
   }

GrADS:
--------
code: http://dl.dropbox.com/u/45311184/gradscode.txt
files to be included in the same folder with the .flx file 
http://dl.dropbox.com/u/45311184/US48_merged_AWIP32.1985120100.RS.flx.ctl
http://dl.dropbox.com/u/45311184/US48_merged_AWIP32.1985120100.RS.flx.idx


-----
Ariel Ortiz-Bobea
PhD Candidate in Agricultural & Resource Economics
University of Maryland - College Park
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/inconsistencies-between-readGDAL-and-other-software-GrADS-when-reading-GRIB1-files-tp7006160p7006160.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From metras.raphaelle at choisyclub.org  Fri Nov 18 08:32:49 2011
From: metras.raphaelle at choisyclub.org (=?iso-8859-1?Q?rapha=EBlle_m=E9tras?=)
Date: Fri, 18 Nov 2011 08:32:49 +0100 (CET)
Subject: [R-sig-Geo] Spatial frailty model
Message-ID: <59879.188.223.124.210.1321601569.squirrel@wwws.choisyclub.org>

Hello,

I'm trying to find the function to code a spatial frailty model with R. I
have been searching for a while, but I have not been very successful so
far.

I did not find from survival (frailty) or geoR packages. Sorry if my
question sounds a little bit too naive.

Thank you very much,

Regards,

Raph


From albin.blaschka at standortsanalyse.net  Fri Nov 18 09:13:54 2011
From: albin.blaschka at standortsanalyse.net (Albin Blaschka)
Date: Fri, 18 Nov 2011 09:13:54 +0100
Subject: [R-sig-Geo] Legend in density plot
Message-ID: <4EC613C2.30408@standortsanalyse.net>



Dear list!

I have GPS data for three seasons of roaming livestock and to get an 
idea which areas the animals occupied and the differences between the 
seasons, I am plotting density plots for each season like this:

posi <- readOGR(dsn = "PG:host=127.0.0.1 user=user dbname=mydb 
password=secret, layer = "mylayer")

pposi <- ppp(posi at coords[,1], 
posi at coords[,2],xrange=c(posi at bbox[1,1],posi at bbox[1,2]), 
yrange=c(posi at bbox[2,1],posi at bbox[2,2]))

densi <- density(pposi, bw = "nrd0", adjust = 0.1, kernel = 
c("epanechnikov"), edge = TRUE, diggle=TRUE)

plot(densi, col = mypalette)

so far, so good:

BUT as there where differences between the years, the legend which is 
plotted on the left of each map shows different values/ has different 
ranges, which is bad for a comparision, so my question is:

How can I change the range and the ticks in the legend of a density map?

I hope I made my point clear - Thank you in advance!

regards,
Albin

-- 
| Albin Blaschka, Mag.rer.nat.
| Etrichstrasse 26, A-5020 Salzburg
| * www.albinblaschka.info * www.thinkanimal.info *
| - It's hard to live in the mountains, hard but not hopeless!


From Roger.Bivand at nhh.no  Fri Nov 18 12:34:38 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 18 Nov 2011 12:34:38 +0100 (CET)
Subject: [R-sig-Geo] inconsistencies between readGDAL and other software
 (GrADS) when reading GRIB1 files
In-Reply-To: <1321569821699-7006160.post@n2.nabble.com>
References: <1321569821699-7006160.post@n2.nabble.com>
Message-ID: <alpine.LRH.2.00.1111181217360.647@reclus.nhh.no>

On Thu, 17 Nov 2011, Ariel Ortiz-Bobea wrote:

> Hi,
>
> I've been importing GRIB1 files into R through the readGDAL command in the
> GDAL package.

The readGDAL() function in the rgdal package uses GDAL and its drivers, so 
see:

http://www.gdal.org/frmt_grib.html

for details. Note also:

https://stat.ethz.ch/pipermail/r-sig-geo/2011-January/010760.html
http://grass.osgeo.org/wiki/GRIB

for a bug in the GDAL driver and a workaround, and other GRIB threads on 
this list.

>
> However, the GRIB1 files are multi-band and during the import process I
> "lose" the variable names and get generic names: band1, band2, etc.
>

As far as I can see, band names are not supported in GDAL in:

http://www.gdal.org/classGDALDataset.html

or

http://www.gdal.org/classGDALRasterBand.html

but may be in http://www.gdal.org/classGDALRasterAttributeTable.html.

Could you please try running:

GDALinfo("mygrib.grb", returnRAT=TRUE)

to see if you get the band names?

Roger

> I have tried to circumvent this by using other software (GrADS) to obtain
> summary statistics for each variable (of which I know the names) and then
> compare these to summary statistics of each variable/band in R. Matching
> summary statistics would allow me to get back the real names.
>
> However, there are discrepancies between summary statistics. More precisely,
> there are differences between minimums, means and maximums between both
> approaches AND these differences are not of the same magnitude (ruling out a
> homogenous shift in values).
>
> Moreover, GrADS gives temperatures in Kelvin and readGDAL seems to be
> transforming them to Celsius BUT the difference between minimum, maximum and
> means is not consistently 273.15 as one would expect. For instance, for soil
> temperature the difference is 271.441 (for the mean), 270.514 (for the max)
> and 273.149 (for the min), but for Dew point it is 269.436 (for the mean),
> 272.58 (for the max) and 273.349 (for the min). So it is not even consistent
> across different temperature variables.
>
> I wonder if this has to do with how GrADS or readGDAL read these GRIB1 files
> (or the way I'm importing this)... would there be any hidden processing
> going on that would explain this? Would using netCDF format files rather
> than GRIB1 help in any way? Any suggestions or comments on how to import
> this data in a manner in a proper way?
>
> Thanks a lot in advance for any guidance on this,
>
> Ariel
>
> Here is my example file:
> http://dl.dropbox.com/u/45311184/US48_merged_AWIP32.1985120100.RS.flx (in
> GRIB1 format)
>
> R code:
> -------
> # import
>   flx<-  readGDAL("1985/US48_merged_AWIP32.1985120100.RS.flx")
> # fix missing values (imported as 9999)
>   for (n in 1:10 ){
>      is.na(flx[[n]]) <- flx[[n]] > 9000
>   }
> # print summary statistics for each variable/band
>   for (n in 1:10 ){
>      print(summary(flx[[n]])[c(4,6,1)])
>   }
>
> GrADS:
> --------
> code: http://dl.dropbox.com/u/45311184/gradscode.txt
> files to be included in the same folder with the .flx file
> http://dl.dropbox.com/u/45311184/US48_merged_AWIP32.1985120100.RS.flx.ctl
> http://dl.dropbox.com/u/45311184/US48_merged_AWIP32.1985120100.RS.flx.idx
>
>
> -----
> Ariel Ortiz-Bobea
> PhD Candidate in Agricultural & Resource Economics
> University of Maryland - College Park
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/inconsistencies-between-readGDAL-and-other-software-GrADS-when-reading-GRIB1-files-tp7006160p7006160.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From eric.boeker at gmail.com  Fri Nov 18 13:44:37 2011
From: eric.boeker at gmail.com (Eric Boeker)
Date: Fri, 18 Nov 2011 14:44:37 +0200
Subject: [R-sig-Geo] ANOVA (two way) and Friedman Test
Message-ID: <CAK9Do3+nLCAHBN6pnnAL+BO1kP4ET0cOOVpUFCtJgU=nTB2MGw@mail.gmail.com>

Dear list members,


I have a set of soil samples tested for one Element taken at 3 different
depths (respectively at depth A, B and C) on a transect.
I want to determine whether the results for the different layers (depths)
are comparable.
>From the literature I found that 2 tests can to be employed:

1) An extension of ANOVA that accounts for a blocking effect (different
samples taken at same position) = ANOVA (two way)
2) Non parametric equivalent of ANOVA with blocking the Friedman test

In both case, I got stuck. In the case of Friedman (
http://stat.ethz.ch/R-manual/R-patched/library/stats/html/friedman.test.html)
the example is given with a matrix and so far I was only dealing with
data.frame. I didnt figure out how to transform my data into a matrix or if
the data frame can be used directly.
With the two way ANOVA
(http://cran.r-project.org/web/packages/car/car.pdf(p.11)), I did not
managed to figure out which argument to use for the
linear model (lm).

If someone is interested to give me a hand find attached the surveys data
at different depth.


-- 
Mit freundlichen Gr??en / Kind regards / Meilleures Salutations


Eric B?ker

Project Manager
Eiseb Prospecting and Mining (Pty)Ltd
Gobabis, Namibia
<eric at eiseb.com>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111118/bc666683/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: soil.csv
Type: text/csv
Size: 2268 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111118/bc666683/attachment.bin>

From nknox at UFL.EDU  Fri Nov 18 15:59:41 2011
From: nknox at UFL.EDU (Knox, Nicky)
Date: Fri, 18 Nov 2011 14:59:41 +0000
Subject: [R-sig-Geo] intervals in a map
Message-ID: <457A4559B3717A4D93B9898EAC9A2DD5224D5B40@UFEXCH-MBXN02.ad.ufl.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111118/49cf41a7/attachment.pl>

From narayani at ku.edu  Fri Nov 18 16:33:33 2011
From: narayani at ku.edu (Narayani Barve)
Date: Fri, 18 Nov 2011 09:33:33 -0600
Subject: [R-sig-Geo] Error in raster command.
Message-ID: <CAE=+0-KeC5pBCJnjA-rK4Us4YWnQF7G59RmoOebQ3nW3Ko7oEA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111118/8c8f6b16/attachment.pl>

From acmonmany at gmail.com  Fri Nov 18 17:09:09 2011
From: acmonmany at gmail.com (carolina monmany)
Date: Fri, 18 Nov 2011 12:09:09 -0400
Subject: [R-sig-Geo] units is semivariograms in GeoR
In-Reply-To: <B2841709-1631-4B60-9481-EE3C34543734@remoteinformation.com.au>
References: <CANEaUWsPD9DqogXTzUVcNa9pqpH=+Eu7syViCnG5eN8Fm5TMew@mail.gmail.com>
	<4EC3D3FE.7080102@knmi.nl>
	<CANEaUWuV3aB7unL3P=Ka6vzEfuQqQCWzy9=d_4_bAWPOqdd+og@mail.gmail.com>
	<B2841709-1631-4B60-9481-EE3C34543734@remoteinformation.com.au>
Message-ID: <CANEaUWs8fa2+u9yqnKWdBY0ZP=0+m4=6Dj+im-sGVhaoSb3O-Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111118/8824f8ed/attachment.pl>

From janverbesselt at gmail.com  Fri Nov 18 17:15:30 2011
From: janverbesselt at gmail.com (Jan Verbesselt)
Date: Fri, 18 Nov 2011 17:15:30 +0100
Subject: [R-sig-Geo] Error in raster command.
In-Reply-To: <CAE=+0-KeC5pBCJnjA-rK4Us4YWnQF7G59RmoOebQ3nW3Ko7oEA@mail.gmail.com>
References: <CAE=+0-KeC5pBCJnjA-rK4Us4YWnQF7G59RmoOebQ3nW3Ko7oEA@mail.gmail.com>
Message-ID: <52D22519-B6D1-4AF7-A709-7083B17C5999@gmail.com>

Hi Narayani,

Please provide a reproducible example and sessionInfo(). It is very difficult to help you without any more details.
I think the problem is just that you need to check if the path to your ASCII file is correctly define in your R script.

> sessionInfo()


Regards,
Jan


On 18/11/2011, at 4:33 PM, Narayani Barve wrote:

> Hi All,
> 
> I am using raster package and was trying to read the ASCII file and I am
> getting error as "Error in .rasterFromASCIIFile(x) : object 'xn' not
> found". I am unable to understand why this error is coming. I try to open
> the same ASCII file  in Arcgis and there is no problem.
> 
> Can anyone guide me what could be the problem ?
> 
> Thanks in advance,
> Narayani Barve
> 
> -- 
> Narayani Barve
> PhD Candidate,
> Ecology and Evolutionary Biology,
> University of Kansas, KS 66044
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Roger.Bivand at nhh.no  Fri Nov 18 17:16:32 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 18 Nov 2011 17:16:32 +0100 (CET)
Subject: [R-sig-Geo] units is semivariograms in GeoR
In-Reply-To: <CANEaUWs8fa2+u9yqnKWdBY0ZP=0+m4=6Dj+im-sGVhaoSb3O-Q@mail.gmail.com>
References: <CANEaUWsPD9DqogXTzUVcNa9pqpH=+Eu7syViCnG5eN8Fm5TMew@mail.gmail.com>
	<4EC3D3FE.7080102@knmi.nl>
	<CANEaUWuV3aB7unL3P=Ka6vzEfuQqQCWzy9=d_4_bAWPOqdd+og@mail.gmail.com>
	<B2841709-1631-4B60-9481-EE3C34543734@remoteinformation.com.au>
	<CANEaUWs8fa2+u9yqnKWdBY0ZP=0+m4=6Dj+im-sGVhaoSb3O-Q@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1111181713490.647@reclus.nhh.no>

On Fri, 18 Nov 2011, carolina monmany wrote:

> Hi,
>
> As suggested, I am transforming my data from Sapper Hill 1943 /
> UTM_Zone_20S to WGS84  /UTM_Zone_20S to run variograms of my plots that

Your input data is almost certainly not what you think. It does seem to be 
in geographical coordinates. See:

http://spatialreference.org/ref/epsg/4292/

and perhaps use:

CRS("+proj=longlat +ellps=intl +towgs84=-355,21,72,0,0,0,0 +no_defs")

or

CRS("+init=epsg:4292")

instead. Your target is probably:

CRS("+init=epsg:29220")

Roger

> have the x axis in meters.  I get the following error message and I need
> some hint of what is going on. The SpatialPointsDataFrame has 6816
> points. Thanks.
>
>> tuc1pro3.50.utm <- spTransform(tuc1pro3.50frm, CRS("+proj=utm +zone=20
> +south +ellps=WGS84 +datum=WGS84 +units=m"))
>
> non finite transformation detected:
>        x         y
> -65.29769 -26.39063       Inf       Inf
> Error in spTransform(xSP, CRSobj) : failure in points 1
> In addition: Warning message:
> In spTransform(xSP, CRSobj) : 6816 projected point(s) not finite
>
>
>
> 2011/11/16 Ben Madin <lists at remoteinformation.com.au>
>
>> You will need to transform (re-project) your data into a suitable
>> coordinate system - use the sptransform() function in the rgdal package, or
>> look at p 64 in the ASDAR book.
>>
>> depending on where you data is and how large an area it covers will
>> influence your choice of coordinate reference system, but you might get
>> away with a UTM grid 19 North for Puerto Rico - have a look here :
>>
>> http://spatialreference.org/ref/epsg/32619/
>>
>> cheers
>>
>> Ben
>>
>>
>> On 16/11/2011, at 11:42 PM, carolina monmany wrote:
>>
>>> Sorry. My problem is that I want the units in the x axis to be in meters
>>> but they are in degrees. How can I make R read the projected coordinate
>>> system, which is in meters, and not the geographic one?
>>>
>>> Thanks!
>>>
>>> 2011/11/16 Paul Hiemstra <paul.hiemstra at knmi.nl>
>>>
>>>> Hi,
>>>>
>>>> This is mail is a bit on the short side :), so please try and be more
>>>> complete next time. I think what you want to know is what the units are
>>>> in a semi-variogram. For the y-axis, they are the unit of the variable
>>>> of interest squared. So if the variable is m/s, than the semi-variogram
>>>> has units (m/s)^2. For the x-axis they are most probably the distance
>>>> unit in which the coordinate system of your data set is, e.g. kilometer.
>>>>
>>>> hope this helps,
>>>> Paul
>>>>
>>>> On 11/16/2011 03:08 PM, carolina monmany wrote:
>>>>
>>>> --
>>>> Paul Hiemstra, Ph.D.
>>>> Global Climate Division
>>>> Royal Netherlands Meteorological Institute (KNMI)
>>>> Wilhelminalaan 10 | 3732 GK | De Bilt | Kamer B 3.39
>>>> P.O. Box 201 | 3730 AE | De Bilt
>>>> tel: +31 30 2206 494
>>>>
>>>> http://intamap.geo.uu.nl/~paul
>>>> http://nl.linkedin.com/pub/paul-hiemstra/20/30b/770
>>>>
>>>>
>>>
>>>
>>> --
>>> ---------------------------
>>> A. CAROLINA MONMANY
>>> Universidad de Puerto Rico
>>> Departamento de Biologia - CN 235
>>> POBOX 23360
>>> San Juan, Puerto Rico 00931-3360
>>> Tel: +1 787 764 0000 x2847
>>> Fax: +1 787 764 2610
>>>
>>>       [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From narayani at ku.edu  Fri Nov 18 18:01:06 2011
From: narayani at ku.edu (Narayani Barve)
Date: Fri, 18 Nov 2011 11:01:06 -0600
Subject: [R-sig-Geo] Error in raster command.
In-Reply-To: <52D22519-B6D1-4AF7-A709-7083B17C5999@gmail.com>
References: <CAE=+0-KeC5pBCJnjA-rK4Us4YWnQF7G59RmoOebQ3nW3Ko7oEA@mail.gmail.com>
	<52D22519-B6D1-4AF7-A709-7083B17C5999@gmail.com>
Message-ID: <CAE=+0-KfoPgU1sXNX76iiss4hhW2zAxjzA7bGiUTH=ZFMCttoQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111118/a46e0212/attachment.pl>

From bmack at uni-bonn.de  Fri Nov 18 18:19:53 2011
From: bmack at uni-bonn.de (Benjamin Mack)
Date: Fri, 18 Nov 2011 18:19:53 +0100
Subject: [R-sig-Geo] problems extracting raster values from x,y positions
Message-ID: <4EC693B9.7010509@uni-bonn.de>

Hello all,
I'm getting crazy with a really basic problem but can't figure out what 
I am doing wrong. I found a way (see below) to solve the problem but it 
is everything but not elegant.
I have an raster img with 72 layers which I read from an envi file.

 > img <- stack(fname)

Now I want to extract some pixel values using an SpatialPointsDataFrame 
img_vals <- extract(img, ref)
The problem is, that the output tells my that the values in the 72 bands 
are all equal - which is not true!

 > img_vals
  [1,]         0.034341563           0.034341563 ...
  [2,]         0.014481238           0.014481238 ...
  [...,]

To show you the strange behaviour look at the following.

Trying to do the following (which I suppose to be somehow equal than 
using extract but with the pixel row/col -locations) I get the same 
problem (equal values in all bands):

 >img[1,1]
[1,]         0.008778242           0.008778242  ...

BUT when I do it in a different way I get the truth (controlled in ENVI) 
with differnet values in each layer.

 > getValues(img at layers[[1]])[1]
[1] 0.008778242
 > getValues(img at layers[[2]])[1]
[1] 0.006187854
 > getValues(img at layers[[3]])[1]
[1] 0.01333527

Has anybody an idea what is wrong here and how I have to use the extract 
command correctly? Any suggestions are highly appreciated!

Thanks in advance!

---------------------------------------------------
My (ugly) workaround:

img <- stack(fname)
ci <- rasterize(ref,img,'ID')
ind_sampling <- which(is.na(getValues(ci))==F)

vals <- c()
for (ii in 1:dim(img)[3]) {
   vals <- rbind(vals, getValues(img at layers[[ii]])[ind_sampling]) }


From r.hijmans at gmail.com  Fri Nov 18 19:17:08 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Fri, 18 Nov 2011 10:17:08 -0800
Subject: [R-sig-Geo] problems extracting raster values from x,
	y positions
In-Reply-To: <4EC693B9.7010509@uni-bonn.de>
References: <4EC693B9.7010509@uni-bonn.de>
Message-ID: <CANtt_hy4-=qj3nPsGCU77CatTNHgSUjOW6_YP7P1H4q1Wt=M8g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111118/7873b399/attachment.pl>

From afischbach at usgs.gov  Fri Nov 18 19:21:43 2011
From: afischbach at usgs.gov (Anthony Fischbach)
Date: Fri, 18 Nov 2011 10:21:43 -0800 (PST)
Subject: [R-sig-Geo] Error in raster command.
In-Reply-To: <CAE=+0-KeC5pBCJnjA-rK4Us4YWnQF7G59RmoOebQ3nW3Ko7oEA@mail.gmail.com>
References: <CAE=+0-KeC5pBCJnjA-rK4Us4YWnQF7G59RmoOebQ3nW3Ko7oEA@mail.gmail.com>
Message-ID: <1321640503910-7009267.post@n2.nabble.com>

please post a minimal script so that we may better understand your problem.

-----
Tony Fischbach, Wildlife Biologist
Walrus Research Program
Alaska Science Center
U.S. Geological Survey
4210 University Drive
Anchorage, AK 99508-4650

AFischbach at usgs.gov
http://alaska.usgs.gov/science/biology/walrus
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Error-in-raster-command-tp7008647p7009267.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From priyantha518 at gmail.com  Fri Nov 18 21:03:56 2011
From: priyantha518 at gmail.com (priyantha jayakody)
Date: Fri, 18 Nov 2011 14:03:56 -0600
Subject: [R-sig-Geo] make a grid from data frame
Message-ID: <CAKCzxmRvGXsCSBLuFZpe98Ja+L_Q703KVOdOtK1Ehbm82RbpxA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111118/b6be3c71/attachment.pl>

From sturgeon09 at gmail.com  Fri Nov 18 21:21:40 2011
From: sturgeon09 at gmail.com (Samuel Turgeon)
Date: Fri, 18 Nov 2011 15:21:40 -0500
Subject: [R-sig-Geo] make a grid from data frame
In-Reply-To: <CAKCzxmRvGXsCSBLuFZpe98Ja+L_Q703KVOdOtK1Ehbm82RbpxA@mail.gmail.com>
References: <CAKCzxmRvGXsCSBLuFZpe98Ja+L_Q703KVOdOtK1Ehbm82RbpxA@mail.gmail.com>
Message-ID: <CAH3FZ07pur5P8n_0aNZodOKVjuoCMoke-H=V-zrE+QiPOdCy+w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111118/0874a789/attachment.pl>

From aortizbobea at arec.umd.edu  Fri Nov 18 21:29:05 2011
From: aortizbobea at arec.umd.edu (Ariel Ortiz-Bobea)
Date: Fri, 18 Nov 2011 12:29:05 -0800 (PST)
Subject: [R-sig-Geo] inconsistencies between readGDAL and other software
 (GrADS) when reading GRIB1 files
In-Reply-To: <alpine.LRH.2.00.1111181217360.647@reclus.nhh.no>
References: <1321569821699-7006160.post@n2.nabble.com>
	<alpine.LRH.2.00.1111181217360.647@reclus.nhh.no>
Message-ID: <E7C57FAA7891B94DBA265B591642DE25D16026CFC0@mail.arec.umd.edu>

Thanks for the references Roger,

The "shift bug" had escaped me! Now the overlay between polygons and grids fits better visually.

On the other hand, GDALinfo("mygrib.grb", returnRAT=TRUE) returns empty names for all bands and a warning for each of them: "statistics not supported by this driver".

I found a workaround strategy converting a reference GRIB file to netCDF format (using the ncl_convert2nc software) and then reading it with the "ncdf" package. This way I could obtain the metada (abbreviations, long names, units) and compare the summary statistics with those of the unnamed bands from RGDAL. The summary statistics match, so I was able to obtain the names this way....So I'm guessing that it is GrADS who's doing some extrapolations/processing, at least in my case, explaining the discrepancies. 

It is worth noting that readGDAL transforms temperatures in Kelvin to Celsius when reading GRIB1 files...all other units in my case remain untouched.

One other thing is that the "rgdal" and "ncdf" packages in R, as well as GrADS for that matter, return bands in different orders. So you really have to go through this matching process to guess variable names/identities when reading GRIB1 files with many bands using RGDAL (version 1.8.0, released 2011/01/12)

Thanks again,

Ariel OB

________________________________________
From: Roger Bivand [via R-sig-geo] [ml-node+s2731867n7007977h13 at n2.nabble.com]
Sent: Friday, November 18, 2011 6:56 AM
To: Ariel Ortiz Bobea
Subject: Re: inconsistencies between readGDAL and other software (GrADS) when reading GRIB1 files

On Thu, 17 Nov 2011, Ariel Ortiz-Bobea wrote:

> Hi,
>
> I've been importing GRIB1 files into R through the readGDAL command in the
> GDAL package.

The readGDAL() function in the rgdal package uses GDAL and its drivers, so
see:

http://www.gdal.org/frmt_grib.html

for details. Note also:

https://stat.ethz.ch/pipermail/r-sig-geo/2011-January/010760.html
http://grass.osgeo.org/wiki/GRIB

for a bug in the GDAL driver and a workaround, and other GRIB threads on
this list.

>
> However, the GRIB1 files are multi-band and during the import process I
> "lose" the variable names and get generic names: band1, band2, etc.
>

As far as I can see, band names are not supported in GDAL in:

http://www.gdal.org/classGDALDataset.html

or

http://www.gdal.org/classGDALRasterBand.html

but may be in http://www.gdal.org/classGDALRasterAttributeTable.html.

Could you please try running:

GDALinfo("mygrib.grb", returnRAT=TRUE)

to see if you get the band names?

Roger

> I have tried to circumvent this by using other software (GrADS) to obtain
> summary statistics for each variable (of which I know the names) and then
> compare these to summary statistics of each variable/band in R. Matching
> summary statistics would allow me to get back the real names.
>
> However, there are discrepancies between summary statistics. More precisely,
> there are differences between minimums, means and maximums between both
> approaches AND these differences are not of the same magnitude (ruling out a
> homogenous shift in values).
>
> Moreover, GrADS gives temperatures in Kelvin and readGDAL seems to be
> transforming them to Celsius BUT the difference between minimum, maximum and
> means is not consistently 273.15 as one would expect. For instance, for soil
> temperature the difference is 271.441 (for the mean), 270.514 (for the max)
> and 273.149 (for the min), but for Dew point it is 269.436 (for the mean),
> 272.58 (for the max) and 273.349 (for the min). So it is not even consistent
> across different temperature variables.
>
> I wonder if this has to do with how GrADS or readGDAL read these GRIB1 files
> (or the way I'm importing this)... would there be any hidden processing
> going on that would explain this? Would using netCDF format files rather
> than GRIB1 help in any way? Any suggestions or comments on how to import
> this data in a manner in a proper way?
>
> Thanks a lot in advance for any guidance on this,
>
> Ariel
>
> Here is my example file:
> http://dl.dropbox.com/u/45311184/US48_merged_AWIP32.1985120100.RS.flx (in
> GRIB1 format)
>
> R code:
> -------
> # import
>   flx<-  readGDAL("1985/US48_merged_AWIP32.1985120100.RS.flx")
> # fix missing values (imported as 9999)
>   for (n in 1:10 ){
>      is.na(flx[[n]]) <- flx[[n]] > 9000
>   }
> # print summary statistics for each variable/band
>   for (n in 1:10 ){
>      print(summary(flx[[n]])[c(4,6,1)])
>   }
>
> GrADS:
> --------
> code: http://dl.dropbox.com/u/45311184/gradscode.txt
> files to be included in the same folder with the .flx file
> http://dl.dropbox.com/u/45311184/US48_merged_AWIP32.1985120100.RS.flx.ctl
> http://dl.dropbox.com/u/45311184/US48_merged_AWIP32.1985120100.RS.flx.idx
>
>
> -----
> Ariel Ortiz-Bobea
> PhD Candidate in Agricultural & Resource Economics
> University of Maryland - College Park
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/inconsistencies-between-readGDAL-and-other-software-GrADS-when-reading-GRIB1-files-tp7006160p7006160.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> [hidden email]</user/SendEmail.jtp?type=node&node=7007977&i=0>
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

--
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: [hidden email]</user/SendEmail.jtp?type=node&node=7007977&i=1>

_______________________________________________
R-sig-Geo mailing list
[hidden email]</user/SendEmail.jtp?type=node&node=7007977&i=2>
https://stat.ethz.ch/mailman/listinfo/r-sig-geo
Roger Bivand
Economic Geography Section
Department of Economics
Norwegian School of Economics and Business Administration
Helleveien 30
N-5045 Bergen, Norway


________________________________
If you reply to this email, your message will be added to the discussion below:
http://r-sig-geo.2731867.n2.nabble.com/inconsistencies-between-readGDAL-and-other-software-GrADS-when-reading-GRIB1-files-tp7006160p7007977.html
To unsubscribe from inconsistencies between readGDAL and other software (GrADS) when reading GRIB1 files, click here<http://r-sig-geo.2731867.n2.nabble.com/template/NamlServlet.jtp?macro=unsubscribe_by_code&node=7006160&code=YW9ydGl6Ym9iZWFAYXJlYy51bWQuZWR1fDcwMDYxNjB8LTYxMzExNzA2NQ==>.
NAML<http://r-sig-geo.2731867.n2.nabble.com/template/NamlServlet.jtp?macro=macro_viewer&id=instant_html%21nabble%3Aemail.naml&base=nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.view.web.template.InstantMailNamespace&breadcrumbs=instant+emails%21nabble%3Aemail.naml-instant_emails%21nabble%3Aemail.naml-send_instant_email%21nabble%3Aemail.naml>


-----
Ariel Ortiz-Bobea
PhD Candidate in Agricultural & Resource Economics
University of Maryland - College Park
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/inconsistencies-between-readGDAL-and-other-software-GrADS-when-reading-GRIB1-files-tp7006160p7009592.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From edzer.pebesma at uni-muenster.de  Fri Nov 18 21:40:53 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 18 Nov 2011 21:40:53 +0100
Subject: [R-sig-Geo] make a grid from data frame
In-Reply-To: <CAKCzxmRvGXsCSBLuFZpe98Ja+L_Q703KVOdOtK1Ehbm82RbpxA@mail.gmail.com>
References: <CAKCzxmRvGXsCSBLuFZpe98Ja+L_Q703KVOdOtK1Ehbm82RbpxA@mail.gmail.com>
Message-ID: <4EC6C2D5.3020205@uni-muenster.de>

PJ, in which format do you currently have your attributes?

On 11/18/2011 09:03 PM, priyantha jayakody wrote:
> hi
> Is any one know how to make a grid from a data frame. As a example "meuse"
> data in "gstat" has meuse.grid which include all the variable (not only X
> and Y). I tried my data with "makegrid" function in SP pacakge but it gives
> X and Y only
> any suggestion would be great
> i just want a grid file with all attributes
> 
> thanks
> PJ
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From Roger.Bivand at nhh.no  Fri Nov 18 22:50:23 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 18 Nov 2011 22:50:23 +0100 (CET)
Subject: [R-sig-Geo] inconsistencies between readGDAL and other software
 (GrADS) when reading GRIB1 files
In-Reply-To: <E7C57FAA7891B94DBA265B591642DE25D16026CFC0@mail.arec.umd.edu>
References: <1321569821699-7006160.post@n2.nabble.com>
	<alpine.LRH.2.00.1111181217360.647@reclus.nhh.no>
	<E7C57FAA7891B94DBA265B591642DE25D16026CFC0@mail.arec.umd.edu>
Message-ID: <alpine.LRH.2.00.1111182242370.647@reclus.nhh.no>

On Fri, 18 Nov 2011, Ariel Ortiz-Bobea wrote:

> Thanks for the references Roger,
>
> The "shift bug" had escaped me! Now the overlay between polygons and 
> grids fits better visually.
>
> On the other hand, GDALinfo("mygrib.grb", returnRAT=TRUE) returns empty 
> names for all bands and a warning for each of them: "statistics not 
> supported by this driver".

Which means that there is no way the GDAL driver can report the band 
names.

>
> I found a workaround strategy converting a reference GRIB file to netCDF 
> format (using the ncl_convert2nc software) and then reading it with the 
> "ncdf" package. This way I could obtain the metada (abbreviations, long 
> names, units) and compare the summary statistics with those of the 
> unnamed bands from RGDAL. The summary statistics match, so I was able to 
> obtain the names this way....So I'm guessing that it is GrADS who's 
> doing some extrapolations/processing, at least in my case, explaining 
> the discrepancies.
>
> It is worth noting that readGDAL transforms temperatures in Kelvin to 
> Celsius when reading GRIB1 files...all other units in my case remain 
> untouched.
>
> One other thing is that the "rgdal" and "ncdf" packages in R, as well as 
> GrADS for that matter, return bands in different orders. So you really 
> have to go through this matching process to guess variable 
> names/identities when reading GRIB1 files with many bands using RGDAL 
> (version 1.8.0, released 2011/01/12)

As I said, you are mixing up GDAL and rgdal. GDAL is 1.8.0, not rgdal. 
readGDAL() does nothing to the data values in the bands, they are read by 
the GDAL GRIB driver, and passed through from there. I doubt whether the 
GDAL driver attempts to understand what the bands are, since it does not 
access their metadata.

I assume that other software does that, or possibly mixes up signed and 
unsigned bytes if the temperatures are integers. GDAL simply allows us to 
handle well over a hundred different raster formats, many of which are 
poorly documented and used in varying ways by different organisations, 
thus increasing the confusion.

Roger

>
> Thanks again,
>
> Ariel OB
>
> ________________________________________
> From: Roger Bivand [via R-sig-geo] [ml-node+s2731867n7007977h13 at n2.nabble.com]
> Sent: Friday, November 18, 2011 6:56 AM
> To: Ariel Ortiz Bobea
> Subject: Re: inconsistencies between readGDAL and other software (GrADS) when reading GRIB1 files
>
> On Thu, 17 Nov 2011, Ariel Ortiz-Bobea wrote:
>
>> Hi,
>>
>> I've been importing GRIB1 files into R through the readGDAL command in the
>> GDAL package.
>
> The readGDAL() function in the rgdal package uses GDAL and its drivers, so
> see:
>
> http://www.gdal.org/frmt_grib.html
>
> for details. Note also:
>
> https://stat.ethz.ch/pipermail/r-sig-geo/2011-January/010760.html
> http://grass.osgeo.org/wiki/GRIB
>
> for a bug in the GDAL driver and a workaround, and other GRIB threads on
> this list.
>
>>
>> However, the GRIB1 files are multi-band and during the import process I
>> "lose" the variable names and get generic names: band1, band2, etc.
>>
>
> As far as I can see, band names are not supported in GDAL in:
>
> http://www.gdal.org/classGDALDataset.html
>
> or
>
> http://www.gdal.org/classGDALRasterBand.html
>
> but may be in http://www.gdal.org/classGDALRasterAttributeTable.html.
>
> Could you please try running:
>
> GDALinfo("mygrib.grb", returnRAT=TRUE)
>
> to see if you get the band names?
>
> Roger
>
>> I have tried to circumvent this by using other software (GrADS) to obtain
>> summary statistics for each variable (of which I know the names) and then
>> compare these to summary statistics of each variable/band in R. Matching
>> summary statistics would allow me to get back the real names.
>>
>> However, there are discrepancies between summary statistics. More precisely,
>> there are differences between minimums, means and maximums between both
>> approaches AND these differences are not of the same magnitude (ruling out a
>> homogenous shift in values).
>>
>> Moreover, GrADS gives temperatures in Kelvin and readGDAL seems to be
>> transforming them to Celsius BUT the difference between minimum, maximum and
>> means is not consistently 273.15 as one would expect. For instance, for soil
>> temperature the difference is 271.441 (for the mean), 270.514 (for the max)
>> and 273.149 (for the min), but for Dew point it is 269.436 (for the mean),
>> 272.58 (for the max) and 273.349 (for the min). So it is not even consistent
>> across different temperature variables.
>>
>> I wonder if this has to do with how GrADS or readGDAL read these GRIB1 files
>> (or the way I'm importing this)... would there be any hidden processing
>> going on that would explain this? Would using netCDF format files rather
>> than GRIB1 help in any way? Any suggestions or comments on how to import
>> this data in a manner in a proper way?
>>
>> Thanks a lot in advance for any guidance on this,
>>
>> Ariel
>>
>> Here is my example file:
>> http://dl.dropbox.com/u/45311184/US48_merged_AWIP32.1985120100.RS.flx (in
>> GRIB1 format)
>>
>> R code:
>> -------
>> # import
>>   flx<-  readGDAL("1985/US48_merged_AWIP32.1985120100.RS.flx")
>> # fix missing values (imported as 9999)
>>   for (n in 1:10 ){
>>      is.na(flx[[n]]) <- flx[[n]] > 9000
>>   }
>> # print summary statistics for each variable/band
>>   for (n in 1:10 ){
>>      print(summary(flx[[n]])[c(4,6,1)])
>>   }
>>
>> GrADS:
>> --------
>> code: http://dl.dropbox.com/u/45311184/gradscode.txt
>> files to be included in the same folder with the .flx file
>> http://dl.dropbox.com/u/45311184/US48_merged_AWIP32.1985120100.RS.flx.ctl
>> http://dl.dropbox.com/u/45311184/US48_merged_AWIP32.1985120100.RS.flx.idx
>>
>>
>> -----
>> Ariel Ortiz-Bobea
>> PhD Candidate in Agricultural & Resource Economics
>> University of Maryland - College Park
>> --
>> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/inconsistencies-between-readGDAL-and-other-software-GrADS-when-reading-GRIB1-files-tp7006160p7006160.html
>> Sent from the R-sig-geo mailing list archive at Nabble.com.
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> [hidden email]</user/SendEmail.jtp?type=node&node=7007977&i=0>
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> --
> Roger Bivand
> Department of Economics, NHH Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: [hidden email]</user/SendEmail.jtp?type=node&node=7007977&i=1>
>
> _______________________________________________
> R-sig-Geo mailing list
> [hidden email]</user/SendEmail.jtp?type=node&node=7007977&i=2>
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> Roger Bivand
> Economic Geography Section
> Department of Economics
> Norwegian School of Economics and Business Administration
> Helleveien 30
> N-5045 Bergen, Norway
>
>
> ________________________________
> If you reply to this email, your message will be added to the discussion below:
> http://r-sig-geo.2731867.n2.nabble.com/inconsistencies-between-readGDAL-and-other-software-GrADS-when-reading-GRIB1-files-tp7006160p7007977.html
> To unsubscribe from inconsistencies between readGDAL and other software (GrADS) when reading GRIB1 files, click here<http://r-sig-geo.2731867.n2.nabble.com/template/NamlServlet.jtp?macro=unsubscribe_by_code&node=7006160&code=YW9ydGl6Ym9iZWFAYXJlYy51bWQuZWR1fDcwMDYxNjB8LTYxMzExNzA2NQ==>.
> NAML<http://r-sig-geo.2731867.n2.nabble.com/template/NamlServlet.jtp?macro=macro_viewer&id=instant_html%21nabble%3Aemail.naml&base=nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.view.web.template.InstantMailNamespace&breadcrumbs=instant+emails%21nabble%3Aemail.naml-instant_emails%21nabble%3Aemail.naml-send_instant_email%21nabble%3Aemail.naml>
>
>
> -----
> Ariel Ortiz-Bobea
> PhD Candidate in Agricultural & Resource Economics
> University of Maryland - College Park
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/inconsistencies-between-readGDAL-and-other-software-GrADS-when-reading-GRIB1-files-tp7006160p7009592.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From r.turner at auckland.ac.nz  Sat Nov 19 00:43:49 2011
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Sat, 19 Nov 2011 12:43:49 +1300
Subject: [R-sig-Geo] Legend in density plot
In-Reply-To: <4EC613C2.30408@standortsanalyse.net>
References: <4EC613C2.30408@standortsanalyse.net>
Message-ID: <4EC6EDB5.6010805@auckland.ac.nz>

On 18/11/11 21:13, Albin Blaschka wrote:
>
>
> Dear list!
>
> I have GPS data for three seasons of roaming livestock and to get an 
> idea which areas the animals occupied and the differences between the 
> seasons, I am plotting density plots for each season like this:
>
> posi <- readOGR(dsn = "PG:host=127.0.0.1 user=user dbname=mydb 
> password=secret, layer = "mylayer")
>
> pposi <- ppp(posi at coords[,1], 
> posi at coords[,2],xrange=c(posi at bbox[1,1],posi at bbox[1,2]), 
> yrange=c(posi at bbox[2,1],posi at bbox[2,2]))
>
> densi <- density(pposi, bw = "nrd0", adjust = 0.1, kernel = 
> c("epanechnikov"), edge = TRUE, diggle=TRUE)
>
> plot(densi, col = mypalette)
>
> so far, so good:
>
> BUT as there where differences between the years, the legend which is 
> plotted on the left of each map shows different values/ has different 
> ranges, which is bad for a comparision, so my question is:
>
> How can I change the range and the ticks in the legend of a density map?
>
> I hope I made my point clear - Thank you in advance!

I ***think*** when you say ``legend'' you mean the ***ribbon*** that 
appears at
the right hand side of an "im" plot.  And I ***think*** you want this 
ribbon to cover
the same range of values for each plot.

This is easily done --- choose the range of values that you want to use, 
and invoke
the argument "zlim".

Here's a toy example:

X <- im(matrix(runif(10000),100,100))
Y <- im(matrix(runif(10000,0.5,1.5),100,100))
plot(X) # No adjustment --- the two images look pretty much the same;
plot(Y) # you can't see the difference in the ranges of values.

plot(X,zlim=c(0,1.5))
plot(Y,zlim=c(0,1.5)) # Now the difference is obvious.

I hope I have interpreted your question correctly.  If not, please let me
know, with clarifications.

     cheers,

         Rolf Turner


From Adrian.Baddeley at csiro.au  Sat Nov 19 03:13:31 2011
From: Adrian.Baddeley at csiro.au (Adrian.Baddeley at csiro.au)
Date: Sat, 19 Nov 2011 10:13:31 +0800
Subject: [R-sig-Geo] Legend in density plot
In-Reply-To: <4EC6EDB5.6010805@auckland.ac.nz>
References: <4EC613C2.30408@standortsanalyse.net>,
	<4EC6EDB5.6010805@auckland.ac.nz>
Message-ID: <57DC18C299094D4299F837570C5DF1C54EAD707793@EXWA-MBX01.nexus.csiro.au>

On 18/11/11 21:13, Albin Blaschka wrote:

> I have GPS data for three seasons of roaming livestock and to get an
> idea which areas the animals occupied and the differences between the
> seasons, I am plotting density plots for each season like this:
>
> posi <- readOGR(dsn = "PG:host=127.0.0.1 user=user dbname=mydb
> password=secret, layer = "mylayer")
>
> pposi <- ppp(posi at coords[,1],
> posi at coords[,2],xrange=c(posi at bbox[1,1],posi at bbox[1,2]),
> yrange=c(posi at bbox[2,1],posi at bbox[2,2]))
>
> densi <- density(pposi, bw = "nrd0", adjust = 0.1, kernel =
> c("epanechnikov"), edge = TRUE, diggle=TRUE)
>
> plot(densi, col = mypalette)
>
> so far, so good:
>
> BUT as there where differences between the years, the legend which is
> plotted on the left of each map shows different values/ has different
> ranges, which is bad for a comparision, so my question is:
>
> How can I change the range and the ticks in the legend of a density map?

This is a question about the 'spatstat' package.

Firstly, if you want the density maps to be strictly comparable between successive years, you should use the same smoothing bandwidth. In the code above, the bandwidth is selected automatically by the rule "nrd0". That means the bandwidth values are data-dependent and will be different in different years. You need to select a particular bandwidth value and stick to that. 

Incidentally you've used "nrd0"  which is a bandwidth selection procedure for non-spatial data. The standard methods for bandwidth selection in spatial point processes are Diggle's cross-validation method (implemented as bw.diggle) and Stoyan's rule of thumb (implemented as bw.stoyan). See the help file for density.ppp. 

Note that, because 'pposi' is an object of class "ppp", when you call density(pposi) the function that is executed is density.ppp so you should look at help(density.ppp) rather than help(density).

If X1, X2, X3, ... are the point patterns for the successive years, then I would recommend something like
        sigma <- bw.diggle(X1)
        D1 <- density(X1, sigma)
        D2 <- density(X2, sigma)
       .....

The result of density.ppp is an object of class "im". So when you plot it, you are using the plot method for "im" objects, plot.im. The help file for plot.im contains a very detailed explanation of how to control the colours and annotations. To use the same colour map for several images, you can either specify the argument 'zlim', or you can create an object of class "colourmap" specifying the colour map explicitly, and specify this as the argument "col".

Adrian Baddeley


From HodgessE at uhd.edu  Sat Nov 19 05:18:51 2011
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Fri, 18 Nov 2011 22:18:51 -0600
Subject: [R-sig-Geo] local moran
Message-ID: <586A4828D7AAA04CA9B258C50A28DA200BF58A7B@BALI.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111118/2e0f409a/attachment.pl>

From HodgessE at uhd.edu  Sat Nov 19 05:24:30 2011
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Fri, 18 Nov 2011 22:24:30 -0600
Subject: [R-sig-Geo] local moran: please ignore
References: <586A4828D7AAA04CA9B258C50A28DA200BF58A7B@BALI.uhd.campus>
Message-ID: <586A4828D7AAA04CA9B258C50A28DA200BF58A7C@BALI.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111118/9e1b3d8f/attachment.pl>

From alexandresantosbr at yahoo.com.br  Sat Nov 19 15:38:33 2011
From: alexandresantosbr at yahoo.com.br (ASANTOS)
Date: Sat, 19 Nov 2011 12:38:33 -0200
Subject: [R-sig-Geo] Problem with overlay in sp package
Message-ID: <4EC7BF69.9020802@yahoo.com.br>

Dear colleges,

         I need a help for selecting a grid inside the area with the 
overlay() function, the idea is create a regular grid for all the area 
and before select only the grid inside the sub area, my script for this are:

require(splancs)
require(sp)
#Create random points
x <- runif(n=500,min=0, max=20)
y <- runif(n=500,min=0, max=20)
xy<-cbind(x,y)
plot(x=x,y=y,axes=F, xlab="", ylab="",
      xlim=c(-1,20),ylim=c(0,21))
pt0 <- c(0.5,0.5)##First point of grid
##Create sub area
limx<-c(2.5,2.5,18,18,2.5)
limy<-c(2.5,18,18,2.5,2.5)
lim=cbind(limx,limy)
lim<-as.matrix(lim)
##Convert in spatial objects of sp package
#Random points
pontos <- SpatialPoints(cbind(x,y))
pontos<- SpatialPoints(list(x,y))
pontos<- SpatialPoints(data.frame(x,y))
#Create the grid
grid0= GridTopology(c(0.5,0.5), c(1,1), c(20,20))
grid<-SpatialGrid(grid = grid0)
##Sub area
limite=SpatialPolygons(list(Polygons(list(Polygon(lim)),"lim")))
##For view
plot(limite)#Sub area
points(pontos)#Random points
points(grid,col='red')#Grid
clip<-overlay(grid,limite)##Select the grid inside the sub area
sel.grid <-grid[!is.na(clip),]##Removing Na's that represents the grid 
outside the sub area

But in this point I have a problem, there are any solution or other 
approach for my problem,
Thanks,

-- 
Alexandre DOS SANTOS
Engenheiro Florestal, Msc.
Laborat?rio de Entomologia Florestal
Departamento de Entomologia
Universidade Federal de Lavras
Caixa Postal 3037
37200-000 - Lavras - Minas Gerais - Brasil
Tel: +55 35 92230304


From edzer.pebesma at uni-muenster.de  Sat Nov 19 15:47:16 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sat, 19 Nov 2011 15:47:16 +0100
Subject: [R-sig-Geo] Problem with overlay in sp package
In-Reply-To: <4EC7BF69.9020802@yahoo.com.br>
References: <4EC7BF69.9020802@yahoo.com.br>
Message-ID: <4EC7C174.6090906@uni-muenster.de>

Please try, at the end of your script:

fullgrid(grid)=FALSE
sel.grid <-grid[!is.na(clip),]
points(sel.grid, col='blue', pch=3)


On 11/19/2011 03:38 PM, ASANTOS wrote:
> Dear colleges,
> 
>         I need a help for selecting a grid inside the area with the
> overlay() function, the idea is create a regular grid for all the area
> and before select only the grid inside the sub area, my script for this
> are:
> 
> require(splancs)
> require(sp)
> #Create random points
> x <- runif(n=500,min=0, max=20)
> y <- runif(n=500,min=0, max=20)
> xy<-cbind(x,y)
> plot(x=x,y=y,axes=F, xlab="", ylab="",
>      xlim=c(-1,20),ylim=c(0,21))
> pt0 <- c(0.5,0.5)##First point of grid
> ##Create sub area
> limx<-c(2.5,2.5,18,18,2.5)
> limy<-c(2.5,18,18,2.5,2.5)
> lim=cbind(limx,limy)
> lim<-as.matrix(lim)
> ##Convert in spatial objects of sp package
> #Random points
> pontos <- SpatialPoints(cbind(x,y))
> pontos<- SpatialPoints(list(x,y))
> pontos<- SpatialPoints(data.frame(x,y))
> #Create the grid
> grid0= GridTopology(c(0.5,0.5), c(1,1), c(20,20))
> grid<-SpatialGrid(grid = grid0)
> ##Sub area
> limite=SpatialPolygons(list(Polygons(list(Polygon(lim)),"lim")))
> ##For view
> plot(limite)#Sub area
> points(pontos)#Random points
> points(grid,col='red')#Grid
> clip<-overlay(grid,limite)##Select the grid inside the sub area
> sel.grid <-grid[!is.na(clip),]##Removing Na's that represents the grid
> outside the sub area
> 
> But in this point I have a problem, there are any solution or other
> approach for my problem,
> Thanks,
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From alexandresantosbr at yahoo.com.br  Sat Nov 19 16:03:05 2011
From: alexandresantosbr at yahoo.com.br (ASANTOS)
Date: Sat, 19 Nov 2011 13:03:05 -0200
Subject: [R-sig-Geo] Extract values in spsample()
Message-ID: <4EC7C529.7090607@yahoo.com.br>

Dear colleges,

     I need to create a object wit the coordinates of a grid and the values in the point sampled, using the meuse.grid example:

## regular sampling over a grid
library(sp)
data(meuse.grid)
gridded(meuse.grid) = ~x+y
image(meuse.grid["dist"])
points(spsample(meuse.grid,n=1000,type="regular"), pch=3, cex=.4)

but here I don't how I can find the value in the image associated with the grid, there are any suggestion?
Thanks,


-- 
Alexandre DOS SANTOS
Engenheiro Florestal, Msc.
Laborat?rio de Entomologia Florestal
Departamento de Entomologia
Universidade Federal de Lavras
Caixa Postal 3037
37200-000 - Lavras - Minas Gerais - Brasil
Tel: +55 35 92230304


From edzer.pebesma at uni-muenster.de  Sat Nov 19 20:56:25 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sat, 19 Nov 2011 20:56:25 +0100
Subject: [R-sig-Geo] Extract values in spsample()
In-Reply-To: <4EC7C529.7090607@yahoo.com.br>
References: <4EC7C529.7090607@yahoo.com.br>
Message-ID: <4EC809E9.4070105@uni-muenster.de>



On 11/19/2011 04:03 PM, ASANTOS wrote:
> Dear colleges,
> 
>     I need to create a object wit the coordinates of a grid and the
> values in the point sampled, using the meuse.grid example:
> 
> ## regular sampling over a grid
> library(sp)
> data(meuse.grid)
> gridded(meuse.grid) = ~x+y
> image(meuse.grid["dist"])
> points(spsample(meuse.grid,n=1000,type="regular"), pch=3, cex=.4)
> 
> but here I don't how I can find the value in the image associated with
> the grid, there are any suggestion?

> pts = spsample(meuse.grid,n=1000,type="regular")
> over(pts, meuse.grid)[1:10,]
   part.a part.b      dist soil ffreq
1       0      1 0.0000000    1     1
2       0      1 0.0000000    1     1
3       0      1 0.0054321    1     1
4       0      1 0.0000000    1     1
5       0      1 0.0000000    1     2
6       0      1 0.0000000    1     2
7       0      1 0.0000000    1     1
8       0      1 0.0264645    1     1
9       0      1 0.0537778    1     1
10      0      1 0.0593610    1     1
> dim(over(pts, meuse.grid))
[1] 1012    5
> class(over(pts, meuse.grid))
[1] "data.frame"

see also http://cran.r-project.org/web/packages/sp/vignettes/over.pdf

Hth,
-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From HodgessE at uhd.edu  Sun Nov 20 00:20:45 2011
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Sat, 19 Nov 2011 17:20:45 -0600
Subject: [R-sig-Geo] local moran again
Message-ID: <586A4828D7AAA04CA9B258C50A28DA200BF58A83@BALI.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111119/30d12d67/attachment.pl>

From gianni.lavaredo at gmail.com  Sun Nov 20 02:06:53 2011
From: gianni.lavaredo at gmail.com (gianni lavaredo)
Date: Sun, 20 Nov 2011 02:06:53 +0100
Subject: [R-sig-Geo] triangular irregular network (TIN) interpolation in R,
	maybe in raster
Message-ID: <CAJ6JbR-2OexAumehLU9=j6Z10qpbro5fzNn9goqDGx=m1wqtaw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111120/8f6d5600/attachment.pl>

From juantomas.sayago at gmail.com  Sun Nov 20 02:19:33 2011
From: juantomas.sayago at gmail.com (Juan Tomas Sayago)
Date: Sat, 19 Nov 2011 20:19:33 -0500
Subject: [R-sig-Geo] intervals in a map
In-Reply-To: <CAPvcma3CKaQ9P5grn+KeDtojfhY0i6pHGtdmXBOEr=-2qOzwgQ@mail.gmail.com>
References: <CAPvcma3CKaQ9P5grn+KeDtojfhY0i6pHGtdmXBOEr=-2qOzwgQ@mail.gmail.com>
Message-ID: <CAEOXpNDeg-_fwKuVfn133qC+36xqKkyooNRVbSXo97YjYj0jeA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111119/8f31d675/attachment.pl>

From albin.blaschka at standortsanalyse.net  Sun Nov 20 10:26:16 2011
From: albin.blaschka at standortsanalyse.net (Albin Blaschka)
Date: Sun, 20 Nov 2011 10:26:16 +0100
Subject: [R-sig-Geo] Legend in density plot
In-Reply-To: <57DC18C299094D4299F837570C5DF1C54EAD707793@EXWA-MBX01.nexus.csiro.au>
References: <4EC613C2.30408@standortsanalyse.net>,
	<4EC6EDB5.6010805@auckland.ac.nz>
	<57DC18C299094D4299F837570C5DF1C54EAD707793@EXWA-MBX01.nexus.csiro.au>
Message-ID: <4EC8C7B8.9020509@standortsanalyse.net>



Adrian, Rolf & list,

Thank you very much - Rolf, yes you are right that was exactly what I 
wanted (zlim for the im - plot...)!
And Adrian: I am working through your workshop notes on spatstat - thank 
you for your input!

kind regards,
Albin

Am 2011-11-19 03:13, schrieb Adrian.Baddeley at csiro.au:
> On 18/11/11 21:13, Albin Blaschka wrote:
>
>> I have GPS data for three seasons of roaming livestock and to get an
>> idea which areas the animals occupied and the differences between the
>> seasons, I am plotting density plots for each season like this:
>>
>> posi<- readOGR(dsn = "PG:host=127.0.0.1 user=user dbname=mydb
>> password=secret, layer = "mylayer")
>>
>> pposi<- ppp(posi at coords[,1],
>> posi at coords[,2],xrange=c(posi at bbox[1,1],posi at bbox[1,2]),
>> yrange=c(posi at bbox[2,1],posi at bbox[2,2]))
>>
>> densi<- density(pposi, bw = "nrd0", adjust = 0.1, kernel =
>> c("epanechnikov"), edge = TRUE, diggle=TRUE)
>>
>> plot(densi, col = mypalette)
>>
>> so far, so good:
>>
>> BUT as there where differences between the years, the legend which is
>> plotted on the left of each map shows different values/ has different
>> ranges, which is bad for a comparision, so my question is:
>>
>> How can I change the range and the ticks in the legend of a density map?
>
> This is a question about the 'spatstat' package.
>
> Firstly, if you want the density maps to be strictly comparable between successive years, you should use the same smoothing bandwidth. In the code above, the bandwidth is selected automatically by the rule "nrd0". That means the bandwidth values are data-dependent and will be different in different years. You need to select a particular bandwidth value and stick to that.
>
> Incidentally you've used "nrd0"  which is a bandwidth selection procedure for non-spatial data. The standard methods for bandwidth selection in spatial point processes are Diggle's cross-validation method (implemented as bw.diggle) and Stoyan's rule of thumb (implemented as bw.stoyan). See the help file for density.ppp.
>
> Note that, because 'pposi' is an object of class "ppp", when you call density(pposi) the function that is executed is density.ppp so you should look at help(density.ppp) rather than help(density).
>
> If X1, X2, X3, ... are the point patterns for the successive years, then I would recommend something like
>          sigma<- bw.diggle(X1)
>          D1<- density(X1, sigma)
>          D2<- density(X2, sigma)
>         .....
>
> The result of density.ppp is an object of class "im". So when you plot it, you are using the plot method for "im" objects, plot.im. The help file for plot.im contains a very detailed explanation of how to control the colours and annotations. To use the same colour map for several images, you can either specify the argument 'zlim', or you can create an object of class "colourmap" specifying the colour map explicitly, and specify this as the argument "col".
>
> Adrian Baddeley
>
>



-- 
| Albin Blaschka, Mag.rer.nat.
| Etrichstrasse 26, A-5020 Salzburg
| * www.albinblaschka.info * www.thinkanimal.info *
| - It's hard to live in the mountains, hard but not hopeless!


From gianni.lavaredo at gmail.com  Sun Nov 20 16:30:14 2011
From: gianni.lavaredo at gmail.com (gianni lavaredo)
Date: Sun, 20 Nov 2011 16:30:14 +0100
Subject: [R-sig-Geo] DEM interpolation with Delaunay triangulation
Message-ID: <CAJ6JbR_J2GtJs=pj318X_pi=M=nX7PO+iNuWQc0bD_dj45DsaA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111120/19bc8f3a/attachment.pl>

From r.turner at auckland.ac.nz  Sun Nov 20 23:02:54 2011
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Mon, 21 Nov 2011 11:02:54 +1300
Subject: [R-sig-Geo] DEM interpolation with Delaunay triangulation
In-Reply-To: <CAJ6JbR_J2GtJs=pj318X_pi=M=nX7PO+iNuWQc0bD_dj45DsaA@mail.gmail.com>
References: <CAJ6JbR_J2GtJs=pj318X_pi=M=nX7PO+iNuWQc0bD_dj45DsaA@mail.gmail.com>
Message-ID: <4EC9790E.2020007@auckland.ac.nz>

On 21/11/11 04:30, gianni lavaredo wrote:
> Dear Researchers,
>
> I am looking a package o method to interpolate a point data.frame (x,y,z)
> with Delaunay triangulation  (Trianguled interpoaltion network) and create
> a polygons data,frame o a raster. I know there are several fuction in
> library RSAGA, spatstat (with "deldir"), library geometry.

I have no idea what you're on about.  If you could make your question
clearer and more specific I might be able to make some suggestions
as to how you could use spatstat/deldir.

An explicit simple (toy) example might help.

     cheers,

         Rolf Turner


From HodgessE at uhd.edu  Sun Nov 20 23:28:29 2011
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Sun, 20 Nov 2011 16:28:29 -0600
Subject: [R-sig-Geo] ArcGIS question
Message-ID: <586A4828D7AAA04CA9B258C50A28DA200BF58A93@BALI.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111120/e7a97f1e/attachment.pl>

From alberto.gc8 at gmail.com  Mon Nov 21 03:04:52 2011
From: alberto.gc8 at gmail.com (Alberto Gallano)
Date: Sun, 20 Nov 2011 21:04:52 -0500
Subject: [R-sig-Geo] Create distance 'neighborhood' (zone of indifference)
 when clustering binary data
Message-ID: <CAO+b4j9oRxiYHt8zQq+CKw-JuVmmON3Rz0hoqAA93kMn05Eywg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111120/7d3912fe/attachment.pl>

From lyndon.estes at gmail.com  Mon Nov 21 04:38:17 2011
From: lyndon.estes at gmail.com (Lyndon Estes)
Date: Sun, 20 Nov 2011 22:38:17 -0500
Subject: [R-sig-Geo] Problem creating raster brick
Message-ID: <CALuVVaZMPz3bLe-c+wRHukY5vpOP5ORDGsWzpoqV2a-q-MT-sA@mail.gmail.com>

Dear List,

I am having trouble creating a brick out of a raster stack with 9
grids of 2.5 mb each.  My goal in creating the brick is to hopefully
speed up calculation of quantiles for each grid location, which runs
very slowly as follows:

q.10 <- calc(stack1, function(x) quantile(x, 0.1))

I was hoping this would be faster (and I will appreciate any advice on
speeding this up)

q.10 <- calc(brick1, function(x) quantile(x, 0.1))

But I can't get to it, and I am not sure why.

For instance, I have no problem bricking these dummy rasters, which
are a bit bigger than my own data.

library(raster)
library(rgdal)

r.list <- lapply(1:9, function(x) {
  r <- raster(nrow = 800, ncol = 800)
  r[] <- rnorm(ncell(r))
  r <- writeRaster(r, filename = paste("test", x, ".tif", sep = ""),
overwrite = T)  # Using geotiffs
  return(r)
})
r.stack <- stack(lapply(1:9, function(x) r.list[[x]]))
r.brick <- brick(r.stack)  # Works fine, takes about 30 seconds - 1 minute

# However, when I try the same basic thing with my own rasters,
# my system goes into a hang with and R seems to chew up all
# remaining memory (~2.5 GB).

# Here's an example using one of my rasters
link <- "http://www.princeton.edu/~lestes/mri.A2.yld.a.r.tif"
download.file(url = link, destfile = "r.tif", method = "wget")
r2 <- raster("r.tif")
r.list2 <- c(r2, lapply(1:8, function(x) {
  rst <- writeRaster(r2, filename = paste("r.", x + 1, ".tif", sep = ""))
}))  # Duplicate the raster 8 times and make a list out of 9
r2.s <- stack(lapply(1:9, function(x) r.list2[[x]]))  # Stack them
r2.brick <- brick(r2.s)  # This hangs the system

I am not sure why this is happening, but maybe it has to do with the
file itself (assuming I am not coding something incorrectly).  Might
it have to do with the NA values in it?

I will appreciate any pointers on fixing this and on the quantile
calculation method.

Thanks in advance.  My sessionInfo follows the signoff.

Cheers, Lyndon

R version 2.14.0 (2011-10-31)
Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)

locale:
[1] C/en_US.UTF-8/C/C/C/C

attached base packages:
[1] splines   stats     graphics  grDevices utils     datasets
methods   base

other attached packages:
 [1] raster_1.9-33    doBy_4.4.2       MASS_7.3-16      snow_0.3-7
  lme4_0.999375-42 Matrix_1.0-1     lattice_0.20-0   multcomp_1.2-8
 [9] mvtnorm_0.9-9991 R2HTML_2.2       survival_2.36-10 rgdal_0.7-1
  sp_0.9-91

loaded via a namespace (and not attached):
[1] grid_2.14.0   nlme_3.1-102  stats4_2.14.0 tools_2.14.0


From tom.gottfried at tum.de  Mon Nov 21 08:28:31 2011
From: tom.gottfried at tum.de (Tom Gottfried)
Date: Mon, 21 Nov 2011 08:28:31 +0100
Subject: [R-sig-Geo] ArcGIS question
In-Reply-To: <586A4828D7AAA04CA9B258C50A28DA200BF58A93@BALI.uhd.campus>
References: <586A4828D7AAA04CA9B258C50A28DA200BF58A93@BALI.uhd.campus>
Message-ID: <4EC9FD9F.5010208@tum.de>

Erin,

here a collection of posts about R/ArcGIS. Does not seem very straight 
forward to get to know what ArcGIS does. It seems to be not only closed 
source...

https://stat.ethz.ch/pipermail/r-sig-geo/2008-September/004152.html

https://stat.ethz.ch/pipermail/r-sig-geo/2010-April/008038.html

https://stat.ethz.ch/pipermail/r-sig-geo/2008-September/004151.html

https://stat.ethz.ch/pipermail/r-sig-geo/2008-September/004155.html

https://stat.ethz.ch/pipermail/r-sig-geo/2008-September/004163.html

https://stat.ethz.ch/pipermail/r-sig-geo/2008-July/003833.html

regards,
Tom

Am 20.11.2011 23:28, schrieb Hodgess, Erin:
> Dear R Sig Geo People:
>
> I am trying to do a comparison with a data set between ArcGIS Version 10 and r, please.
>
> What is the default set of weights that ArcGIS uses in the global Moran test, please?
>
> thanks,
> Erin
>
>
> Erin M. Hodgess, PhD
> Associate Professor
> Department of Computer and Mathematical Sciences
> University of Houston - Downtown
> mailto: hodgesse at uhd.edu
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Technische Universit?t M?nchen
Department f?r Pflanzenwissenschaften
Lehrstuhl f?r Gr?nlandlehre
Alte Akademie 12
85350 Freising / Germany
Phone: ++49 (0)8161 715324
Fax:   ++49 (0)8161 713243
email: tom.gottfried at wzw.tum.de
http://www.wzw.tum.de/gruenland


From Roger.Bivand at nhh.no  Mon Nov 21 09:29:23 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 21 Nov 2011 09:29:23 +0100 (CET)
Subject: [R-sig-Geo] Create distance 'neighborhood' (zone of
 indifference) when clustering binary data
In-Reply-To: <CAO+b4j9oRxiYHt8zQq+CKw-JuVmmON3Rz0hoqAA93kMn05Eywg@mail.gmail.com>
References: <CAO+b4j9oRxiYHt8zQq+CKw-JuVmmON3Rz0hoqAA93kMn05Eywg@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1111210925140.12797@reclus.nhh.no>

On Sun, 20 Nov 2011, Alberto Gallano wrote:

> Hi, i'm trying to do join count analysis on binary data, but i'd like to
> create neighborhood's of 'indifference' of 100 meters around each spacial
> point.
>
> I've been using dnearneigh to create a neighbor list and knearneigh to
> calculate the maximum of the nearest neighbor distances for the upper bound
> argument to dnearneigh (so that no observations become islands).
>
> My question is, how do I create neighborhoods based on distance? Should I
> just input a number into the upper bound argument of dnearneigh, without
> first using knearneigh? If so, what number would correspond to 100 meters
> (Euclidean)? (btw, the coordinates are already projected).

If you mean that you define neighbours as points j within 100m of point i, 
then:

datnb <- dnearneigh(coords, 0, 100)

will do this if your coordinates are measured in metres. This doesn't work 
for your example, because the closest points are almost 1200m apart, so no 
point has any neighbours for this definition. However, your mentioning 
neighborhoods of 'indifference' makes me uncertain that this is what you 
mean. Do you mean placing a buffer around each point before finding 
neighbours?

Roger

>
> Here is a small subsample of my data and analysis. Thanks,
>
> Alberto
>
>
>
> # ==========================
> # data
> dat <- structure(list(present = c(0L, 0L, 0L, 1L, 0L, 0L, 0L, 0L, 0L,
> 0L, 0L, 0L, 1L, 0L, 0L, 0L, 1L, 1L, 0L, 1L), x = c(332940L, 316301L,
> 312714L, 306008L, 312248L, 329276L, 329663L, 341535L, 314761L,
> 332898L, 332957L, 328332L, 312462L, 330063L, 317808L, 336216L,
> 333763L, 315049L, 333855L, 324406L), y = c(4305226L, 4303010L,
> 4316685L, 4309006L, 4319255L, 4311208L, 4316837L, 4306055L, 4301051L,
> 4300625L, 4330342L, 4303420L, 4308292L, 4307181L, 4292904L, 4304336L,
> 4313750L, 4297998L, 4314941L, 4315051L)), .Names = c("present",
> "x", "y"), class = "data.frame", row.names = c(1L, 2L, 3L, 4L, 5L, 6L,
> 7L, 8L, 9L, 10L, 11L, 12L, 13L, 14L, 15L, 16L, 17L, 18L, 19L, 20L))
>
>
> library(spdep)
> coords <- cbind(dat$x, dat$y)
> k1 <- knn2nb(knearneigh(coords))
> maxD <- max(unlist(nbdists(k1, coords))) # upper bound distance btw
> neighbors
> datnb <- dnearneigh(coords, 0, maxD)
> summary(datnb)
> print(is.symmetric.nb(datnb))
>
> datlistw <- nb2listw(datnb, glist=NULL, style="B", zero.policy=TRUE)
>
> # join count
> joincount.test(as.factor(dat$present), datlistw, zero.policy=TRUE,
>    alternative="greater", spChk=NULL, adjust.n=TRUE)
> # =========================
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From mathieu.rajerison at gmail.com  Mon Nov 21 10:32:30 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Mon, 21 Nov 2011 10:32:30 +0100
Subject: [R-sig-Geo] local moran
In-Reply-To: <586A4828D7AAA04CA9B258C50A28DA200BF58A7B@BALI.uhd.campus>
References: <AcymclfadLTzCeCiQXe3nIWCStPzDQ==>
	<586A4828D7AAA04CA9B258C50A28DA200BF58A7B@BALI.uhd.campus>
Message-ID: <CAGfc75n93H=Ac19E0YEhUy=f2-HTq+NC=_t2XDZsmTWz3qtiWA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111121/a7fc3cd2/attachment.pl>

From mathieu.rajerison at gmail.com  Mon Nov 21 10:33:39 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Mon, 21 Nov 2011 10:33:39 +0100
Subject: [R-sig-Geo] local moran again
In-Reply-To: <586A4828D7AAA04CA9B258C50A28DA200BF58A83@BALI.uhd.campus>
References: <AcynEdz3gLODpJphThaBXzjdmCjykA==>
	<586A4828D7AAA04CA9B258C50A28DA200BF58A83@BALI.uhd.campus>
Message-ID: <CAGfc75m3bbhavCBJaTAtpo-tSbJ6HNkm-Kmq++zzt=xbXTMv1Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111121/72950625/attachment.pl>

From leroy.boris at gmail.com  Mon Nov 21 12:08:35 2011
From: leroy.boris at gmail.com (Boris Leroy)
Date: Mon, 21 Nov 2011 12:08:35 +0100
Subject: [R-sig-Geo] Issue with argument zlim() when plotting rasters
Message-ID: <CAFu_poHWUUkgbF2wbf8Xn2yhLWS+QBMtcyQHzbZ6uEV9ss7ShQ@mail.gmail.com>

Hi all,

I am trying to plot different rasters (same extent, different
resolutions), with the same color scale.

I have read the different threads aiming at specifying a single color
scale for different rasters and the simplest one seem to specify
zlim() when plotting.
I tried with the example I found in the help page of plot {raster}.

r <- raster(nrows=10, ncols=10)
r <- setValues(r, 1:ncell(r))
r[] <- runif(ncell(r))
r2 <- r/2
brks <- seq(0, 1, by=0.1)
nb <- length(brks)-1
par(mfrow=c(1,2))
plot(r, breaks=brks, col=rev(terrain.colors(nb)), lab.breaks=brks, zlim=c(0,1))
plot(r2, breaks=brks, col=rev(terrain.colors(nb)), lab.breaks=brks,
zlim=c(0,1))

It does not work as I expected: the scales are different between graphs.
The first graph has a scale from 0 to 1, and the second one has a
scale from 0 to 0.5. I expected to get a scale from 0 to 1 on both
graphs.
Is this a bug?  Or am I missing something?

Many thanks,

Boris


--
Boris Leroy,
PhD Student,
Equipe Biodiversit? et Gestion des Territoires,
Service du Patrimoine Naturel, MNHN
UMR 7204 CERSP, MNHN
Universit? de Rennes 1
Campus de Beaulieu, B?t. 25, 1er ?tage
35042 Rennes cedex

+33 (0) 2 23 23 58 99
+33 (0) 6 66 02 13 27


From s.meyer at lmu.de  Mon Nov 21 12:24:32 2011
From: s.meyer at lmu.de (Swen Meyer)
Date: Mon, 21 Nov 2011 12:24:32 +0100
Subject: [R-sig-Geo] Fwd: Re: Problem creating raster brick (Lyndon Estes)
In-Reply-To: <4ECA3374.5070500@iggf.geo.uni-muenchen.de>
References: <4ECA3374.5070500@iggf.geo.uni-muenchen.de>
Message-ID: <4ECA34F0.7030905@lmu.de>

Dear Lydon,
I also had some trouble with stacking Layers in the  Raster package. Try 
to use a 32 bit version of R. Sounds weired but in my case the stacking 
with the Raster package was much faster using the Raster Package on a 32 
bit - R Version. This is what Robert Hijmans once wrote me when I had 
some trouble with the Raster Stacking:
"
Thanks that is very good to know. raster checks if the data can all be 
processed in memory, and if so, does that (up to a point), for better 
speed. There is a limit set by maxmemory. See

showOptions()

Perhaps setting maxmemory to a lower value

e.g.,

setOptions(maxmemory=1e+08)"

Hope this will help you.
Greetings,
Swen


From lyndon.estes at gmail.com  Mon Nov 21 17:40:54 2011
From: lyndon.estes at gmail.com (Lyndon Estes)
Date: Mon, 21 Nov 2011 11:40:54 -0500
Subject: [R-sig-Geo] Fwd: Re: Problem creating raster brick (Lyndon
	Estes)
In-Reply-To: <4ECA34F0.7030905@lmu.de>
References: <4ECA3374.5070500@iggf.geo.uni-muenchen.de>
	<4ECA34F0.7030905@lmu.de>
Message-ID: <CALuVVaYVe2zr5vpoVJQ=bqOD9smdDgKmtV9VKXdChB6VbDWd3A@mail.gmail.com>

Hi Swen,

Thanks for the suggestion. That brings to mind an earlier problem I
had with a different functions substituting values on large rasters,
and I got around it by writing the following lines into the code:

  if(raster:::.toDisk() != TRUE) {
     setOptions(todisk = TRUE)
     cat("We don't want memory problems--forcing write to disk.\n")
  }

So I will see if that works in this case.  However, I am still curious
why the problem is occurring with my particular grid files, but not
with the dummy rasters I made, which are in fact somewhat larger.
Also, the combined size of the 9 grids is < 30 mb, which was well
below my available memory (~about 500 mb free).

In the meantime, I am continuing with stacks and checking whether a
forced write or lower memory limits will help.

Thanks again,

Lyndon



On Mon, Nov 21, 2011 at 6:24 AM, Swen Meyer <s.meyer at lmu.de> wrote:
> Dear Lydon,
> I also had some trouble with stacking Layers in the ?Raster package. Try to
> use a 32 bit version of R. Sounds weired but in my case the stacking with
> the Raster package was much faster using the Raster Package on a 32 bit - R
> Version. This is what Robert Hijmans once wrote me when I had some trouble
> with the Raster Stacking:
> "
> Thanks that is very good to know. raster checks if the data can all be
> processed in memory, and if so, does that (up to a point), for better speed.
> There is a limit set by maxmemory. See
>
> showOptions()
>
> Perhaps setting maxmemory to a lower value
>
> e.g.,
>
> setOptions(maxmemory=1e+08)"
>
> Hope this will help you.
> Greetings,
> Swen
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From alexandresantosbr at yahoo.com.br  Mon Nov 21 20:47:36 2011
From: alexandresantosbr at yahoo.com.br (ASANTOS)
Date: Mon, 21 Nov 2011 17:47:36 -0200
Subject: [R-sig-Geo] Extract values with over()
Message-ID: <4ECAAAD8.8030606@yahoo.com.br>

Dear colleges,

      I try to extract values with over () function , but not working 
with my script, when I make:

require(sp)
#Create random points
x <- runif(n=500,min=0, max=20)
y <- runif(n=500,min=0, max=20)
xy<-cbind(x,y)
plot(x=x,y=y,axes=F, xlab="", ylab="",
      xlim=c(-1,20),ylim=c(0,21))
pt0 <- c(0.5,0.5)##First point of grid
##Create subarea
limx<-c(2.5,2.5,18,18,2.5)
limy<-c(2.5,18,18,2.5,2.5)
lim=cbind(limx,limy)
lim<-as.matrix(lim)
##Convert in spatial objects of sp package
#Random points
pontos <- SpatialPoints(cbind(x,y))
pontos<- SpatialPoints(list(x,y))
pontos<- SpatialPoints(data.frame(x,y))
#Create the grid
grid0= GridTopology(c(0.5,0.5), c(1,1), c(20,20))
grid<-SpatialGrid(grid = grid0)
##Subarea
limite=SpatialPolygons(list(Polygons(list(Polygon(lim)),"lim")))
##For view
plot(limite)#Subarea
points(pontos,col='red')#Random points
fullgrid(grid)=FALSE
clip<-overlay(grid,limite)##Select the grid inside the subarea
sel.grid <-grid[!is.na(clip),]##Removings Na's that represents the grid 
outside the subarea
points(sel.grid,col='blue')# New Grid
over(pontos,sel.grid)

was expected that the over() give the frequency of points inside each 
parcel, but I don't know what is the problem,
any suggestion,
Thanks

-- 
Alexandre DOS SANTOS
Engenheiro Florestal, Msc.
Laborat?rio de Entomologia Florestal
Departamento de Entomologia
Universidade Federal de Lavras
Caixa Postal 3037
37200-000 - Lavras - Minas Gerais - Brasil
Tel: +55 35 92230304


From edzer.pebesma at uni-muenster.de  Mon Nov 21 21:07:15 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 21 Nov 2011 21:07:15 +0100
Subject: [R-sig-Geo] Extract values with over()
In-Reply-To: <4ECAAAD8.8030606@yahoo.com.br>
References: <4ECAAAD8.8030606@yahoo.com.br>
Message-ID: <4ECAAF73.5070607@uni-muenster.de>



On 11/21/2011 08:47 PM, ASANTOS wrote:
> Dear colleges,
> 
>      I try to extract values with over () function , but not working
> with my script, when I make:
> 

it only extracts values when there are values to extract, please read
the documentation.

> 
> was expected that the over() give the frequency of points inside each
> parcel

I wonder where you got this expectation from. If the documentation gave
you this expectation, please let me know.

table() can compute frequencies from indices.
-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From paulojus at c3sl.ufpr.br  Mon Nov 21 21:24:01 2011
From: paulojus at c3sl.ufpr.br (Paulo Justiniano Ribeiro Jr)
Date: Mon, 21 Nov 2011 18:24:01 -0200 (BRST)
Subject: [R-sig-Geo] Extract values with over()
In-Reply-To: <4ECAAF73.5070607@uni-muenster.de>
References: <4ECAAAD8.8030606@yahoo.com.br> <4ECAAF73.5070607@uni-muenster.de>
Message-ID: <alpine.DEB.2.00.1111211823130.11087@macalan.c3sl.ufpr.br>

Dear Edzer and Alexandre

wouldn't the following work as requested?

fullgrid(grid) <- FALSE
class(grid)  ## SpatialPixels

ap3 <- as.SpatialPolygons.SpatialPixels(grid)
table(over(pontos, ap3))



Paulo Justiniano Ribeiro Jr
LEG (Laboratorio de Estatistica e Geoinformacao)
Universidade Federal do Parana
Caixa Postal 19.081
CEP 81.531-990
Curitiba, PR  -  Brasil
Tel: (+55) 41 3361 3573
VOIP: (+55) (41) (3361 3600) 1053 1066
Fax: (+55) 41 3361 3141
e-mail: paulojus AT  ufpr  br
http://www.leg.ufpr.br/~paulojus

On Mon, 21 Nov 2011, Edzer Pebesma wrote:

>
>
> On 11/21/2011 08:47 PM, ASANTOS wrote:
>> Dear colleges,
>>
>>      I try to extract values with over () function , but not working
>> with my script, when I make:
>>
>
> it only extracts values when there are values to extract, please read
> the documentation.
>
>>
>> was expected that the over() give the frequency of points inside each
>> parcel
>
> I wonder where you got this expectation from. If the documentation gave
> you this expectation, please let me know.
>
> table() can compute frequencies from indices.
> -- 
> Edzer Pebesma
> Institute for Geoinformatics (ifgi), University of M?nster
> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
> 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
> http://www.52north.org/geostatistics      e.pebesma at wwu.de
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

From amorenos1 at ucentral.edu.co  Mon Nov 21 22:12:08 2011
From: amorenos1 at ucentral.edu.co (Angelo Moreno)
Date: Mon, 21 Nov 2011 13:12:08 -0800 (PST)
Subject: [R-sig-Geo] Nested Logit Model Problem
Message-ID: <1321909928239-7017994.post@n2.nabble.com>

Hi, I have a data frame imported from .txt format, it's so similar to the
data
("TravelMode", package = "AER")
I`m working with de "mlogit" package, when I execute the example code for
the TravelMode data, it functions so good, but when I use it for my data, it
doesn't run, why?, maybe for the format, or what could be happening?
Thanks

P.S: Code for TravelMode data
nl <- mlogit(choice ~ vcost + wait | income, TravelMode, shape = "long",
                  alt.var = "mode", print.level = 0, method = "bfgs",
                  nests = list(public = c("train", "bus"), other =
c("air","car")),
                  tol = 1)

My data and code is the same,only I change the names of variables.

This is my code and ERROR:

nl <- mlogit(Utility~Income+ Prices  |Distance_km , uno,shape="long", 
+ alt.var = "Teather",print.level = 0, method = "bfgs",
+ nests = list(places = c("Americas", "CentroMayor", "Tunal")),tol = 1)

Error en solve.default(crossprod(attr(x, "gradi")[, !fixed])) : 
  sistema es computacionalmente singular: n?mero de condici?n rec?proco =
1.00568e-28

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Nested-Logit-Model-Problem-tp7017994p7017994.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From amorenos1 at ucentral.edu.co  Mon Nov 21 22:12:12 2011
From: amorenos1 at ucentral.edu.co (Angelo Moreno)
Date: Mon, 21 Nov 2011 13:12:12 -0800 (PST)
Subject: [R-sig-Geo] Nested Logit Model Problem
Message-ID: <1321909932773-7017998.post@n2.nabble.com>

Hi, I have a data frame imported from .txt format, it's so similar to the
data
("TravelMode", package = "AER")
I`m working with de "mlogit" package, when I execute the example code for
the TravelMode data, it functions so good, but when I use it for my data, it
doesn't run, why?, maybe for the format, or what could be happening?
Thanks

P.S: Code for TravelMode data
nl <- mlogit(choice ~ vcost + wait | income, TravelMode, shape = "long",
                  alt.var = "mode", print.level = 0, method = "bfgs",
                  nests = list(public = c("train", "bus"), other =
c("air","car")),
                  tol = 1)

My data and code is the same,only I change the names of variables.

This is my code and ERROR:

nl <- mlogit(Utility~Income+ Prices  |Distance_km , uno,shape="long", 
+ alt.var = "Teather",print.level = 0, method = "bfgs",
+ nests = list(places = c("Americas", "CentroMayor", "Tunal")),tol = 1)

Error en solve.default(crossprod(attr(x, "gradi")[, !fixed])) : 
  sistema es computacionalmente singular: n?mero de condici?n rec?proco =
1.00568e-28

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Nested-Logit-Model-Problem-tp7017998p7017998.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From juantomas.sayago at gmail.com  Mon Nov 21 22:22:51 2011
From: juantomas.sayago at gmail.com (Juan Tomas Sayago)
Date: Mon, 21 Nov 2011 16:22:51 -0500
Subject: [R-sig-Geo] Nested Logit Model Problem
In-Reply-To: <1321909932773-7017998.post@n2.nabble.com>
References: <1321909932773-7017998.post@n2.nabble.com>
Message-ID: <CAEOXpNDvGfBTcmhXk9opiCSaRcz8Pk5F0QM3iek2gmpznZ61Eg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111121/7399c01a/attachment.pl>

From c.anwesha at gmail.com  Tue Nov 22 07:06:13 2011
From: c.anwesha at gmail.com (Anwesha Chakrabarti)
Date: Tue, 22 Nov 2011 00:06:13 -0600
Subject: [R-sig-Geo] help needed on spfeml function
Message-ID: <CAGSNayFS4qV=51ZzeeT8=4r=Vryn_b4Npe_LcUv-UcobyRc2_g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111122/339a01be/attachment.pl>

From arthur.wiedmer_rsiggeo at m4x.org  Tue Nov 22 12:50:46 2011
From: arthur.wiedmer_rsiggeo at m4x.org (Arthur Wiedmer)
Date: Tue, 22 Nov 2011 03:50:46 -0800
Subject: [R-sig-Geo] Issue with argument zlim() when plotting rasters
	(Boris Leroy)
Message-ID: <CAJH6oFwQx8vji1R_fRyi4Rt+4yj=YUHH6HSt-O7ZcFvEgom1ZQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111122/a012fb1d/attachment.pl>

From freddy.vate01 at gmail.com  Tue Nov 22 14:22:37 2011
From: freddy.vate01 at gmail.com (=?UTF-8?Q?Freddy_L=C3=B3pez?=)
Date: Tue, 22 Nov 2011 08:52:37 -0430
Subject: [R-sig-Geo] Nested Logit Model Problem
In-Reply-To: <1321909928239-7017994.post@n2.nabble.com>
References: <1321909928239-7017994.post@n2.nabble.com>
Message-ID: <CALCOUqukJQKr01x99N9GPFABTuKg9==ms0h+2yVxtpmK_npCsA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111122/4358b973/attachment.pl>

From edzer.pebesma at uni-muenster.de  Tue Nov 22 14:36:12 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 22 Nov 2011 14:36:12 +0100
Subject: [R-sig-Geo] Extract values with over()
In-Reply-To: <alpine.DEB.2.00.1111211823130.11087@macalan.c3sl.ufpr.br>
References: <4ECAAAD8.8030606@yahoo.com.br> <4ECAAF73.5070607@uni-muenster.de>
	<alpine.DEB.2.00.1111211823130.11087@macalan.c3sl.ufpr.br>
Message-ID: <4ECBA54C.2020803@uni-muenster.de>



On 11/21/2011 09:24 PM, Paulo Justiniano Ribeiro Jr wrote:
> Dear Edzer and Alexandre
> 
> wouldn't the following work as requested?
> 
> fullgrid(grid) <- FALSE
> class(grid)  ## SpatialPixels
> 
> ap3 <- as.SpatialPolygons.SpatialPixels(grid)
> table(over(pontos, ap3))

Paulo, that is a step in the right direction, as

> table(over(pontos, ap3))[1:5]

1 2 3 4 5
2 1 3 1 2

gives frequencies for each cell, but this would also be obtained by the
grid itself:

> table(over(pontos, grid))[1:5]

1 2 3 4 5
2 1 3 1 2

However, as

> length(table(over(pontos, grid)))
[1] 298
> length(grid)
[1] 400

shows we have empty grid cells. but this gives gaps (implicit 0 values)
for empty cells in grid. The simpler alternative is to do the over with
returnList=TRUE, which returns ALL points in each (grid cell, now
polygon) in ap3:

>  over(ap3, pontos, returnList=TRUE)[1:5]
[[1]]
[1] 416 459

[[2]]
[1] 385

[[3]]
[1]  17 132 351

[[4]]
[1] 387

[[5]]
[1] 311 322

taking the length of each vector gives the frequencies (INCLUDING the
zero frequencies that table does NOT give you):

n = sapply(over(ap3, pontos, returnList=TRUE), length)
x = SpatialPixelsDataFrame(grid, data.frame(n=n))
spplot(x, sp.layout=list("sp.points", pontos), at=0:6-.5)

Without doubt, there are other ways of doing this, for instance with
package raster.

Thanks for helping. It seems to be hard to make complex things simple,
and I'd be happy to hear suggestions for making this even simpler.

> 
> 
> 
> Paulo Justiniano Ribeiro Jr
> LEG (Laboratorio de Estatistica e Geoinformacao)
> Universidade Federal do Parana
> Caixa Postal 19.081
> CEP 81.531-990
> Curitiba, PR  -  Brasil
> Tel: (+55) 41 3361 3573
> VOIP: (+55) (41) (3361 3600) 1053 1066
> Fax: (+55) 41 3361 3141
> e-mail: paulojus AT  ufpr  br
> http://www.leg.ufpr.br/~paulojus
> 
> On Mon, 21 Nov 2011, Edzer Pebesma wrote:
> 
>>
>>
>> On 11/21/2011 08:47 PM, ASANTOS wrote:
>>> Dear colleges,
>>>
>>>      I try to extract values with over () function , but not working
>>> with my script, when I make:
>>>
>>
>> it only extracts values when there are values to extract, please read
>> the documentation.
>>
>>>
>>> was expected that the over() give the frequency of points inside each
>>> parcel
>>
>> I wonder where you got this expectation from. If the documentation gave
>> you this expectation, please let me know.
>>
>> table() can compute frequencies from indices.
>> -- 
>> Edzer Pebesma
>> Institute for Geoinformatics (ifgi), University of M?nster
>> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
>> 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
>> http://www.52north.org/geostatistics      e.pebesma at wwu.de
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From alain.reymond at wsl.ch  Tue Nov 22 14:56:31 2011
From: alain.reymond at wsl.ch (alain.reymond at wsl.ch)
Date: Tue, 22 Nov 2011 14:56:31 +0100
Subject: [R-sig-Geo] Same color scale
Message-ID: <OFB4CC40D3.343C125E-ONC1257950.004C95D6-C1257950.004C95E0@wsl.ch>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111122/8e249585/attachment.pl>

From leroy.boris at gmail.com  Tue Nov 22 15:11:37 2011
From: leroy.boris at gmail.com (Boris Leroy)
Date: Tue, 22 Nov 2011 15:11:37 +0100
Subject: [R-sig-Geo] Issue with argument zlim() when plotting rasters
Message-ID: <CAFu_poGdgqX7nk_j=shMzLNLUc=WcGwOerF=WeGgoPc=byozSw@mail.gmail.com>

>> Hi all,
>>
>> I am trying to plot different rasters (same extent, different
>> resolutions), with the same color scale.
>>
>> I have read the different threads aiming at specifying a single color
>> scale for different rasters and the simplest one seem to specify
>> zlim() when plotting.
>> I tried with the example I found in the help page of plot {raster}.
>>
>> r <- raster(nrows=10, ncols=10)
>> r <- setValues(r, 1:ncell(r))
>> r[] <- runif(ncell(r))
>> r2 <- r/2
>> brks <- seq(0, 1, by=0.1)
>> nb <- length(brks)-1
>> par(mfrow=c(1,2))
>> plot(r, breaks=brks, col=rev(terrain.colors(nb)), lab.breaks=brks,
>> zlim=c(0,1))
>> plot(r2, breaks=brks, col=rev(terrain.colors(nb)), lab.breaks=brks,
>> zlim=c(0,1))
>>
>> It does not work as I expected: the scales are different between graphs.
>> The first graph has a scale from 0 to 1, and the second one has a
>> scale from 0 to 0.5. I expected to get a scale from 0 to 1 on both
>> graphs.
>> Is this a bug?  Or am I missing something?
>>
>> Many thanks,
>>
>> Boris
>>
>>
>Hi Boris,
>
>During my musings I found this :
>http://stackoverflow.com/questions/4316692/how-can-i-create-raster-plots-with-the-same-colour-scale-in-r
>
>This looks strangely similar to your problem...
>
>I hope this helps.
>
>Best,
>Arthur


Hi Arthur,

thank you for your answer.
Unfortunately I had also found this thread, but the solution proposed
doesn't work either.
The solution proposed in stackoverflow was to define the scale through
the breaks argument, which was already defined in my previous example.

It is strange because breaks and zlim() seemed to work for a lot of
people as I could see in several threads, but not here, or not
anymore.
Even the example given in the help of ?raster::plot does not seem to work.


Maybe my sessionInfo() could help:

R version 2.14.0 (2011-10-31)
Platform: i386-pc-mingw32/i386 (32-bit)

locale:
[1] LC_COLLATE=French_France.1252  LC_CTYPE=French_France.1252
LC_MONETARY=French_France.1252
[4] LC_NUMERIC=C                   LC_TIME=French_France.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] raster_1.9-44 sp_0.9-91

loaded via a namespace (and not attached):
[1] grid_2.14.0    lattice_0.20-0 tools_2.14.0

Thanks for your help,

Boris


From mathieu.rajerison at gmail.com  Tue Nov 22 16:22:59 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Tue, 22 Nov 2011 16:22:59 +0100
Subject: [R-sig-Geo] spatstat - affine a window - enlarging (with same
	center)
Message-ID: <CAGfc75mgj6x93Fch6XTWw3h2tKRzBFmXfC2UhKrwp1d5ML_Lug@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111122/32fb454b/attachment.pl>

From marcelino.delacruz at upm.es  Tue Nov 22 19:27:11 2011
From: marcelino.delacruz at upm.es (marcelino.delacruz at upm.es)
Date: Tue, 22 Nov 2011 19:27:11 +0100
Subject: [R-sig-Geo] spatstat - affine a window - enlarging (with same
	center)
In-Reply-To: <CAGfc75mgj6x93Fch6XTWw3h2tKRzBFmXfC2UhKrwp1d5ML_Lug@mail.gmail.com>
Message-ID: <DbIrxXUH.1321986431.2581190.marcelino.delacruz@upm.es>

Hi  Mathieu,

Maybe Adrian or Rolf would give a more informated answer, but in the mean
time,  my opinion is that you should compute the centroid of the affined
window and apply a "counter"-shift equivalent to the  shift that
experiments the affined window.

Here's my example with the letterR window (I don't have the
metropolitan France map at hand)

data (letterR)

ratio <- 2 # example "ratio"

letterRa <- affine(letterR, mat=matrix(c(ratio,0,0,ratio), ncol=2))

# centroids of the original and affined windows
cLR <- centroid.owin(letterR)
cLRa <- centroid.owin(letterRa)

# this is the "counter"-shift
LRshift <- c(cLR[[1]]-cLRa[[1]], cLR[[2]]-cLRa[[2]])

# shift the affined window
letterRas<-shift(letterRa, vec=LRshift)

# see the results
plot(letterRas)
plot(letterR, add=T)
points(centroid.owin(letterR))
points(centroid.owin(letterRas), cex=2)

HTH,

Marcelino




Con fecha 22/11/2011, "Mathieu Rajerison" <mathieu.rajerison at gmail.com>
escribi?:

>Hi List,
>
>
>I'd like to visually compare two spatial objects of France contour
>
>I have the population in France, the population in the 10 first major
>cities and I want to enlarge France by a ratio defined by pop(10 major
>cities)/pop(france), sort of a world cartogramwith the transformation of
>one country.
>
>But I have problems using shear transformation.
>
>Here is the code for the moment:
>
>fr <- readOGR(".", "FRANCE_METRO")
>fr.win <- as(fr, "owin")
>
>pop.fr <- 65447374
>townpops <- sum(pop$population)
>ratio <- townpops / pop.fr
>
>## here is my problem...
>fr.aff <- affine(fr.win,  mat=matrix(c(ratio,0,0,ratio), ncol=2));
>
>Any help would be greatly appreciated
>
>
>Mathieu
>
>	[[alternative HTML version deleted]]
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From hadley at rice.edu  Tue Nov 22 19:29:50 2011
From: hadley at rice.edu (Hadley Wickham)
Date: Tue, 22 Nov 2011 12:29:50 -0600
Subject: [R-sig-Geo] Same color scale
In-Reply-To: <OFB4CC40D3.343C125E-ONC1257950.004C95D6-C1257950.004C95E0@wsl.ch>
References: <OFB4CC40D3.343C125E-ONC1257950.004C95D6-C1257950.004C95E0@wsl.ch>
Message-ID: <CABdHhvEmunnErOeC4H9-xomg4dcZffJQmHQSTtocgTufYgsqqA@mail.gmail.com>

> - I also used the ggplot, but again, there is a min-color and a max-color for the min and max values (i.e. blue-red). If one ggplot has more sequence than the other one, in both case they will have the blue and red as min and max color but then not the same number of color between those 2. And If I do not set a max-color (or any min and max color) it does not work either.

Just set the limits - e.g. scale_fill_continuous(limits = c(0, 1))

Hadley


-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From oscar.perpinan at upm.es  Tue Nov 22 23:59:42 2011
From: oscar.perpinan at upm.es (Oscar =?UTF-8?B?UGVycGnDsWFu?= Lamigueiro)
Date: Tue, 22 Nov 2011 23:59:42 +0100
Subject: [R-sig-Geo] Same color scale
In-Reply-To: <OFB4CC40D3.343C125E-ONC1257950.004C95D6-C1257950.004C95E0@wsl.ch>
References: <OFB4CC40D3.343C125E-ONC1257950.004C95D6-C1257950.004C95E0@wsl.ch>
Message-ID: <20111122235942.74ce7dfc@upm.es>

Hi,

Perhaps the levelplot method from rasterVis is useful to solve this
problem. 

library(rasterVis)

f <- system.file("external/test.grd", package="raster")
r <- raster(f)

s <- stack(r, r-maxValue(r))

levelplot(s, par.settings=RdBuTheme)

If you need separate pages for each map you can use:

trellis.device(pdf, file='test.pdf')
levelplot(s, par.settings=RdBuTheme, layout=c(1, 1))
dev.off()

Best,

Oscar.


El Tue, 22 Nov 2011 14:56:31 +0100
alain.reymond at wsl.ch escribi?:
> Dear all,
> I want to compare 2 raster data map where probability values between
> 0 and 1 are not the same (different mix-max values). For this I want
> to apply to both map the same color scale (i.e. 0-0.1 red, 0.1-0.2
> blue etc.) in an automatic way without doing it individually for each
> map.
> 
> I have tried many ways :
> - reclassifying the probability. But here the problem is if one class
> do not exist the color will shift and I cannot assign a particular
> color to a particular class to avoid this.
> 
> - rewriting the breaks limits (sequence from 0 to 1 by 0.1) and using
> the RampPalette but it did not work either because of the max-value
> of the data (they are not the same and not in the same sequence) and
> one color will be add in the rampPalette to fill in the difference.
> It looks like as in the rampPalette there is like a defined min-color
> and max-color and it will add as many as needed between those 2.
> Therefore I wrote by hand some color for the sequence and it worked
> but I had to delet colors to adapt to the max number of really
> existing sequence. Hence, if I want to do this for a lot of files I
> can't make it that way.
> 
> - I also used the ggplot, but again, there is a min-color and a
> max-color for the min and max values (i.e. blue-red). If one ggplot
> has more sequence than the other one, in both case they will have the
> blue and red as min and max color but then not the same number of
> color between those 2. And If I do not set a max-color (or any min
> and max color) it does not work either.
> 
> I already thank you if you have any solution to my problem that could
> be used "easily" without having to write specific color for each map.
> Best,
> 
> Alain
> 
> 
> 
> 
> =
> 	[[alternative HTML version deleted]]


From r.turner at auckland.ac.nz  Wed Nov 23 04:52:58 2011
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Wed, 23 Nov 2011 16:52:58 +1300
Subject: [R-sig-Geo] spatstat - affine a window - enlarging (with same
 center)
In-Reply-To: <DbIrxXUH.1321986431.2581190.marcelino.delacruz@upm.es>
References: <DbIrxXUH.1321986431.2581190.marcelino.delacruz@upm.es>
Message-ID: <4ECC6E1A.2020508@auckland.ac.nz>


Marcelino is clearly far cleverer than I, since I was at first unable
to figure out what the problem was that Mathieu was complaining
of.  As far as I can understand things, Marcelino's solution is correct.

I can suggest a slight simplification of the commands:

U <- shift(letterR,origin="centroid")
W <- affine(U,mat=2*diag(2),vec=unlist(centroid.owin(letterR)))

To check out that this appears as desired do:

plot(W,main="")
plot(letterR,add=TRUE,border="red")

     cheers,

             Rolf

On 23/11/11 07:27, marcelino.delacruz at upm.es wrote:
> Hi  Mathieu,
>
> Maybe Adrian or Rolf would give a more informated answer, but in the mean
> time,  my opinion is that you should compute the centroid of the affined
> window and apply a "counter"-shift equivalent to the  shift that
> experiments the affined window.
>
> Here's my example with the letterR window (I don't have the
> metropolitan France map at hand)
>
> data (letterR)
>
> ratio<- 2 # example "ratio"
>
> letterRa<- affine(letterR, mat=matrix(c(ratio,0,0,ratio), ncol=2))
>
> # centroids of the original and affined windows
> cLR<- centroid.owin(letterR)
> cLRa<- centroid.owin(letterRa)
>
> # this is the "counter"-shift
> LRshift<- c(cLR[[1]]-cLRa[[1]], cLR[[2]]-cLRa[[2]])
>
> # shift the affined window
> letterRas<-shift(letterRa, vec=LRshift)
>
> # see the results
> plot(letterRas)
> plot(letterR, add=T)
> points(centroid.owin(letterR))
> points(centroid.owin(letterRas), cex=2)
>
> HTH,
>
> Marcelino
>
>
>
>
> Con fecha 22/11/2011, "Mathieu Rajerison"<mathieu.rajerison at gmail.com>
> escribi?:
>
>> Hi List,
>>
>>
>> I'd like to visually compare two spatial objects of France contour
>>
>> I have the population in France, the population in the 10 first major
>> cities and I want to enlarge France by a ratio defined by pop(10 major
>> cities)/pop(france), sort of a world cartogramwith the transformation of
>> one country.
>>
>> But I have problems using shear transformation.
>>
>> Here is the code for the moment:
>>
>> fr<- readOGR(".", "FRANCE_METRO")
>> fr.win<- as(fr, "owin")
>>
>> pop.fr<- 65447374
>> townpops<- sum(pop$population)
>> ratio<- townpops / pop.fr
>>
>> ## here is my problem...
>> fr.aff<- affine(fr.win,  mat=matrix(c(ratio,0,0,ratio), ncol=2));
>>
>> Any help would be greatly appreciated
>>
>>
>> Mathieu
>>
>> 	[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From edzer.pebesma at uni-muenster.de  Wed Nov 23 09:36:06 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 23 Nov 2011 09:36:06 +0100
Subject: [R-sig-Geo] DEM interpolation with Delaunay triangulation
In-Reply-To: <4EC9790E.2020007@auckland.ac.nz>
References: <CAJ6JbR_J2GtJs=pj318X_pi=M=nX7PO+iNuWQc0bD_dj45DsaA@mail.gmail.com>
	<4EC9790E.2020007@auckland.ac.nz>
Message-ID: <4ECCB076.9010805@uni-muenster.de>



On 11/20/2011 11:02 PM, Rolf Turner wrote:
> On 21/11/11 04:30, gianni lavaredo wrote:
>> Dear Researchers,
>>
>> I am looking a package o method to interpolate a point data.frame (x,y,z)
>> with Delaunay triangulation  (Trianguled interpoaltion network) and
>> create
>> a polygons data,frame o a raster. I know there are several fuction in
>> library RSAGA, spatstat (with "deldir"), library geometry.
> 
> I have no idea what you're on about.  If you could make your question
> clearer and more specific I might be able to make some suggestions
> as to how you could use spatstat/deldir.
> 
> An explicit simple (toy) example might help.

I have wondered this myself too -- the issue is the so-called TIN,
triangular interpolation network. Say, we have (field) observations
(x,y,z), we form a delanay triangulation on all (x,y) pairs, and we want
to obtain the prediction of z for an arbitrary (x0,y0) pair, based on
the linear trend surface fit through the three (x1,y1), (x2,y2), (x3,y3)
points that form the triangle in which (x0,y0) falls.

You could do, of course, a linear trend surface using three nearest
neighbours, e.g. by

require(gstat)
loadMeuse()
x = krige(log(zinc)~x+y, meuse, meuse.grid, nmax=3)
spplot(x[1],col.regions=bpy.colors(),
	sp.layout=list("sp.points", meuse))


but that takes the three nearest observations, which don't need to be
the three points in the triangle (and often, they are not, because
meuse.grid contains points outside the convex hull of the meuse
observation locations).

> 
>     cheers,
> 
>         Rolf Turner
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From pinaud at cebc.cnrs.fr  Wed Nov 23 12:22:58 2011
From: pinaud at cebc.cnrs.fr (Pinaud David)
Date: Wed, 23 Nov 2011 12:22:58 +0100
Subject: [R-sig-Geo] Problem with tripGrid when some segments lie outside
	the study area
Message-ID: <4ECCD792.2060306@cebc.cnrs.fr>

Dear all,

I'm calculating time spent per cell over a grid (study area) with the 
package "trip", for satellite-tracked seabirds.
Some birds bred outside the area of interest (Kerguelen Plateau, to 
design marine protected areas), so their trips didn't lie entirely in 
the grid. In this case, it seems that time is added in some cells that 
are not visited by the bird (tipically in the border of the grid).
This problem seems coming from pixellate(), and because I need to set 
spatstat.options(checksegments=F)...

Any solution?

Many thanks
David

Here a reproducible exemple:

library(trip)
Le chargement a n?cessit? le package : sp
Le chargement a n?cessit? le package : spatstat
Le chargement a n?cessit? le package : mgcv
This is mgcv 1.7-6. For overview type 'help("mgcv-package")'.
Le chargement a n?cessit? le package : deldir
deldir 0.0-15

Please note: The process for determining duplicated points
has changed from that used in version 0.0-9 (and previously).

spatstat 1.23-4
Type ?help(spatstat)? for an overview of spatstat
?latest.news()? for news on latest version
?licence.polygons()? for licence information on polygon calculations

spatstat.options(checksegments=F) # to allow segment outside the window

# a trip with some parts outside the study area :
d <- data.frame(x = 1:10, y = c(1, 1.5, 2, 4, 5, 5.5, 8, 8, 6, 10), tms 
= Sys.time() + seq(10,100, 10), id = rep(1, 10))
coordinates(d) <- ~x+y
tr <- trip(d, c("tms", "id"))

# the sutdy area :
gridaa <- expand.grid(Long=seq(-0.5, 10.5, by=1), Lat=seq(3.5, 6.5, by=1))
coordinates(gridaa) <- ~ Long + Lat
gridded(gridaa) <- T
fullgrid(gridaa) <- T
gt <- getGridTopology(gridaa)

# time spent per cell
tgrid <- tripGrid(tr, grid = gt)

image(tgrid, axes=T)
points(coordinates(tr), t="l", col="blue")
points(gridaa, pch="+")
text(x= midpoints.psp(as.psp(tr)), col="green", pos=3, labels=1:9)

sessionInfo()
R version 2.13.1 (2011-07-08)
Platform: i386-pc-mingw32/i386 (32-bit)

locale:
[1] LC_COLLATE=French_France.1252 LC_CTYPE=French_France.1252
[3] LC_MONETARY=French_France.1252 LC_NUMERIC=C
[5] LC_TIME=French_France.1252

attached base packages:
[1] stats graphics grDevices utils datasets methods base

other attached packages:
[1] trip_1.1-10 spatstat_1.23-4 deldir_0.0-15 mgcv_1.7-6
[5] sp_0.9-88

loaded via a namespace (and not attached):
[1] grid_2.13.1 lattice_0.19-30 Matrix_0.9996875-3 nlme_3.1-101

-- 
***************************************************
Dr. David PINAUD
Ing?nieur de Recherche "Analyses spatiales"

Centre d'Etudes Biologiques de Chiz? - CNRS UPR1934
79360 Villiers-en-Bois, France
poste 485
Tel: +33 (0)5.49.09.35.58
Fax: +33 (0)5.49.09.65.26
http://www.cebc.cnrs.fr/

***************************************************




__________ Information from ESET Mail Security, version of virus signature database 6653 (20111123) __________

The message was checked by ESET Mail Security.
http://www.eset.com

-------------- next part --------------
A non-text attachment was scrubbed...
Name: pinaud.vcf
Type: text/x-vcard
Size: 324 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111123/823d71f1/attachment.vcf>

From nnagle at utk.edu  Wed Nov 23 14:15:32 2011
From: nnagle at utk.edu (Nagle, Nicholas)
Date: Wed, 23 Nov 2011 13:15:32 +0000
Subject: [R-sig-Geo]  DEM interpolation with Delaunay triangulation
In-Reply-To: <mailman.11.1322046002.27325.r-sig-geo@r-project.org>
References: <mailman.11.1322046002.27325.r-sig-geo@r-project.org>
Message-ID: <280A2D96-7CE2-4FD0-8F89-2C59E3CCC590@utk.edu>

For the first part of your question, interpolation:  I've never used it, but the 'tripack' package seems to do most of what you want.  There is a function tri.find() that returns the three points of the TIN.  From there, a linear interpolation shouldn't be too difficult.

For the second part, regarding the raster to polygons: I'm not sure exactly what you want, and I don't see how this task is related to the first part (a TIN isn't a raster), but assuming you have a raster.... there is a function rasterToPolygons() in the raster package that does this.  It is really really slow though.  It takes hours to do what can be done in 15 seconds in ArcGIS or GRASS.  

For using GRASS, in pseudo R-code, the workflow looks something like this

library(spgrass6)
initGRASS("/Applications/GRASS-6.4.app/Contents/MacOS/",home=tempdir(),override=TRUE) #For a Mac, obviously
writeRAST6(your.raster,'yourRaster',useGDAL=TRUE,overwrite=TRUE,flags='o')
execGRASS('r.to.vect',parameters=list(input='yourRaster',output='yourVect',feature='area'),flags=c('overwrite'))
execGRASS('v.clean', ...) # You'll have to experiment with this....
poly <- readVECT6('yourVect',layer='1')

I've had problems before with self-intersecting polygons when the polygon data come back to R, so the method isn't bulletproof.  Maybe someone else will have advice.

If any of this works, let us now!

Nicholas


> ------------------------------
> 
> Message: 11
> Date: Wed, 23 Nov 2011 09:36:06 +0100
> From: Edzer Pebesma <edzer.pebesma at uni-muenster.de>
> To: r-sig-geo at r-project.org
> Subject: Re: [R-sig-Geo] DEM interpolation with Delaunay triangulation
> Message-ID: <4ECCB076.9010805 at uni-muenster.de>
> Content-Type: text/plain; charset=ISO-8859-1
> 
> 
> 
> On 11/20/2011 11:02 PM, Rolf Turner wrote:
>> On 21/11/11 04:30, gianni lavaredo wrote:
>>> Dear Researchers,
>>> 
>>> I am looking a package o method to interpolate a point data.frame (x,y,z)
>>> with Delaunay triangulation  (Trianguled interpoaltion network) and
>>> create
>>> a polygons data,frame o a raster. I know there are several fuction in
>>> library RSAGA, spatstat (with "deldir"), library geometry.
>> 
>> I have no idea what you're on about.  If you could make your question
>> clearer and more specific I might be able to make some suggestions
>> as to how you could use spatstat/deldir.
>> 
>> An explicit simple (toy) example might help.
> 
> I have wondered this myself too -- the issue is the so-called TIN,
> triangular interpolation network. Say, we have (field) observations
> (x,y,z), we form a delanay triangulation on all (x,y) pairs, and we want
> to obtain the prediction of z for an arbitrary (x0,y0) pair, based on
> the linear trend surface fit through the three (x1,y1), (x2,y2), (x3,y3)
> points that form the triangle in which (x0,y0) falls.
> 
> You could do, of course, a linear trend surface using three nearest
> neighbours, e.g. by
> 
> require(gstat)
> loadMeuse()
> x = krige(log(zinc)~x+y, meuse, meuse.grid, nmax=3)
> spplot(x[1],col.regions=bpy.colors(),
> 	sp.layout=list("sp.points", meuse))
> 
> 
> but that takes the three nearest observations, which don't need to be
> the three points in the triangle (and often, they are not, because
> meuse.grid contains points outside the convex hull of the meuse
> observation locations).
> 
>> 
>>    cheers,
>> 
>>        Rolf Turner
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> -- 
> Edzer Pebesma
> Institute for Geoinformatics (ifgi), University of M?nster
> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
> 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
> http://www.52north.org/geostatistics      e.pebesma at wwu.de
> 
> 
> 
> ------------------------------
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 
> End of R-sig-Geo Digest, Vol 99, Issue 22
> *****************************************
> 


From marcelino.delacruz at upm.es  Wed Nov 23 14:19:44 2011
From: marcelino.delacruz at upm.es (marcelino.delacruz at upm.es)
Date: Wed, 23 Nov 2011 14:19:44 +0100
Subject: [R-sig-Geo] DEM interpolation with Delaunay triangulation
In-Reply-To: <4ECCB076.9010805@uni-muenster.de>
Message-ID: <kzVFRHuj.1322054384.4103870.marcelino.delacruz@upm.es>

Well, I think that this function (all with spatstat tools) could do the
job.

I included a weigthed linear interpolation but this could be easily
modified to fit other models.

It only takes as arguments a marked point pattern (xyz) and the number of
points in x and y dimensions to build the "arbitrary" x0 y0 points


tin <- function(X, nx, ny){
      require(spatstat)
      lltes<-delaunay(X)
      gri <-  gridcentres(X$window, nx=nx, ny=ny)
      gri.ppp <- ppp(gri$x,gri$y, window=X$window,
                           marks=rep(1,length(gri$x)))
        cat("\n","number of triangles =",
length(lltes[[3]]),"\n\n")
       for(i in 1:length(lltes[[3]])){
	     progressreport(i, length(lltes[[3]]))

	      #grid points within the triangulation
	     xoyo <- unmark(gri.ppp[lltes[[3]][[i]]])

	     # original points defining the triangle
	     xyz <- X[lltes[[3]][[i]]]
	       # z values of the three points
	       z<-xyz$marks

	     #distance from grid points to vertices
	      cdis <- crossdist(xoyo,xyz)

	      # weighted linear interpolation within triangle
	      grim <- apply(cdis, 1, function(f) sum(f*z)/sum(f))

	     #assign interpolated values
	       gri.ppp[lltes[[3]][[i]]]$marks <- grim
        }
   return(gri.ppp)
}


# See how does it work:

data(longleaf)
plot(longleaf)

cosa <- tin(longleaf, nx=100, ny=100)

plot(cosa)

image(x=1:100,y=1:100, z=t(matrix(cosa$marks, 100,100, byrow=T)))



Cheers, Marcelino



Con fecha 23/11/2011, "Edzer Pebesma" <edzer.pebesma at uni-muenster.de>
escribi?:

>
>
>On 11/20/2011 11:02 PM, Rolf Turner wrote:
>> On 21/11/11 04:30, gianni lavaredo wrote:
>>> Dear Researchers,
>>>
>>> I am looking a package o method to interpolate a point data.frame (x,y,z)
>>> with Delaunay triangulation  (Trianguled interpoaltion network) and
>>> create
>>> a polygons data,frame o a raster. I know there are several fuction in
>>> library RSAGA, spatstat (with "deldir"), library geometry.
>> 
>> I have no idea what you're on about.  If you could make your question
>> clearer and more specific I might be able to make some suggestions
>> as to how you could use spatstat/deldir.
>> 
>> An explicit simple (toy) example might help.
>
>I have wondered this myself too -- the issue is the so-called TIN,
>triangular interpolation network. Say, we have (field) observations
>(x,y,z), we form a delanay triangulation on all (x,y) pairs, and we want
>to obtain the prediction of z for an arbitrary (x0,y0) pair, based on
>the linear trend surface fit through the three (x1,y1), (x2,y2), (x3,y3)
>points that form the triangle in which (x0,y0) falls.
>
>You could do, of course, a linear trend surface using three nearest
>neighbours, e.g. by
>
>require(gstat)
>loadMeuse()
>x = krige(log(zinc)~x+y, meuse, meuse.grid, nmax=3)
>spplot(x[1],col.regions=bpy.colors(),
>	sp.layout=list("sp.points", meuse))
>
>
>but that takes the three nearest observations, which don't need to be
>the three points in the triangle (and often, they are not, because
>meuse.grid contains points outside the convex hull of the meuse
>observation locations).
>
>> 
>>     cheers,
>> 
>>         Rolf Turner
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>-- 
>Edzer Pebesma
>Institute for Geoinformatics (ifgi), University of M?nster
>Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
>8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
>http://www.52north.org/geostatistics      e.pebesma at wwu.de
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From manuel.schneider at art.admin.ch  Wed Nov 23 15:21:39 2011
From: manuel.schneider at art.admin.ch (Manuel Schneider)
Date: Wed, 23 Nov 2011 14:21:39 +0000
Subject: [R-sig-Geo] Same color scale
References: <OFB4CC40D3.343C125E-ONC1257950.004C95D6-C1257950.004C95E0@wsl.ch>
Message-ID: <loom.20111123T151507-812@post.gmane.org>

 <alain.reymond <at> wsl.ch> writes:
> 
> Dear all,
> I want to compare 2 raster data map where probability values between 0 and 1
are not the same (different
> mix-max values).
> For this I want to apply to both map the same color scale (i.e. 0-0.1 red,
0.1-0.2 blue etc.) in an automatic
> way without doing it individually for each map.

Dear Alain

not entirely sure whether I really understand your question, but maybe
hsv(prob,1,1) or hsv(round(prob,1),1,1) or rainbow(10)[ceiling(prob*10)] could
also do the job when using image() to plot

Abw


From Jan.Quets at ua.ac.be  Wed Nov 23 16:46:49 2011
From: Jan.Quets at ua.ac.be (Quets Jan)
Date: Wed, 23 Nov 2011 15:46:49 +0000
Subject: [R-sig-Geo] compilepcf VS pcfcross
Message-ID: <F7452FEC9FABCF4493C2DBB2E9DC31CE558F7BE7@xmail32.ad.ua.ac.be>

Can compilepcf() be used as an alternative to pcfcross()?

I know already (from this list) that the pcf function of a point pattern X can also be calculated with compilepcf()  [when using pairdist(X) among other arguments as an input for compilepcf()].

Is it thus possible to use (for instance compilepcf) to calculate pcfcross of a multi-(two)-type point pattern? e.g. by using a matrix analogue to pairdist(X) as an input?

The reason is that I want to subtract disc radii from interpoint-distances (the points are centers of discs) of the point (or disc) pattern.

Thank you,
Jan
________________________________________
Van: Adrian.Baddeley at csiro.au [Adrian.Baddeley at csiro.au]
Verzonden: donderdag 17 november 2011 5:10
Aan: Quets Jan; r-sig-geo at r-project.org
CC: r.turner at auckland.ac.nz; Adrian.Baddeley at csiro.au
Onderwerp: RE: compilepcf

Jan Quets <Jan.Quets at ua.ac.be> heeft gevraagd:

   > How to make pcf and compilepcf do the same job

This is a query about the package 'spatstat'.

It is a query about an _undocumented, internal_ feature of 'spatstat'. There are no guarantees that this feature will continue.

compilepcf() has an argument 'denom' which is the denominator for the pair correlation estimator. Under normal circumstances with a 2D point pattern, 'denom' should be an estimate of lambda^2 * A where lambda is the point process intensity and A is the area of the window containing the data. So take denom = npoints(X)^2/area.owin(as.owin(X)).

compilepcf() has an argument 'weights' which contains the edge correction weights for the pairwise distances. To get agreement between pcf.ppp() and compilepcf() you would also have to insert the same edge correction weights. In pcf.ppp() these are computed by the (undocumented!) functions edge.Trans and edge.Ripley. So set weights=edge.Trans(X) for example.

compilepcf() has arguments "..." which are passed to density.default to control the smoothing. In pcf.ppp() the smoothing parameter is (by default) selected by Stoyan's rule of thumb but can be overridden by the argument 'bw'. To get agreement between pcf.ppp() and compilepcf() you would have to specify the same value of 'bw' to both.

compilepcf() uses the Gaussian smoothing kernel by default, while pcf.ppp() uses the Epanechnikov kernel by default. So you'd have to specify kernel="gaussian" in the call to pcf.ppp.

Finally you need to set 'endcorrect=FALSE' in compilepcf() because .... never mind.

Example:

bw <- bw.stoyan(redwood)
f1 <- pcf(redwood, kernel="gaussian", bw=bw)
r <- with(f1, r)
denom <- npoints(redwood)^2/area.owin(as.owin(redwood))
f2 <- compilepcf(D, r=r,
                 denom=denom, weights=edge.Trans(redwood), bw=bw,
                 endcorrect=FALSE)
f2 <- with(f2, ./(2 * pi * r))
plot(f1, trans ~ r)
plot(f2, add=TRUE)



============
Prof Adrian Baddeley (UWA/CSIRO)
CSIRO Mathematics, Informatics & Statistics
Leeuwin Centre, 65 Brockway Road, Floreat WA 6014, Australia
Tel: 08 9333 6177 | Fax: 08 9333 6121 | Mob: 0410 447 821
Skype: adrian.baddeley


From alberto.gc8 at gmail.com  Wed Nov 23 18:11:32 2011
From: alberto.gc8 at gmail.com (Alberto Gallano)
Date: Wed, 23 Nov 2011 12:11:32 -0500
Subject: [R-sig-Geo] Create distance 'neighborhood' (zone of
 indifference) when clustering binary data
In-Reply-To: <alpine.LRH.2.00.1111210925140.12797@reclus.nhh.no>
References: <CAO+b4j9oRxiYHt8zQq+CKw-JuVmmON3Rz0hoqAA93kMn05Eywg@mail.gmail.com>
	<alpine.LRH.2.00.1111210925140.12797@reclus.nhh.no>
Message-ID: <CAO+b4j88hSDcxmwjpZnchpFwpOjmgJ+QFktySdzYkQJUuXVd0g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111123/3ad7a774/attachment.pl>

From Roger.Bivand at nhh.no  Wed Nov 23 18:33:41 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 23 Nov 2011 18:33:41 +0100 (CET)
Subject: [R-sig-Geo] Create distance 'neighborhood' (zone of
 indifference) when clustering binary data
In-Reply-To: <CAO+b4j88hSDcxmwjpZnchpFwpOjmgJ+QFktySdzYkQJUuXVd0g@mail.gmail.com>
References: <CAO+b4j9oRxiYHt8zQq+CKw-JuVmmON3Rz0hoqAA93kMn05Eywg@mail.gmail.com>
	<alpine.LRH.2.00.1111210925140.12797@reclus.nhh.no>
	<CAO+b4j88hSDcxmwjpZnchpFwpOjmgJ+QFktySdzYkQJUuXVd0g@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1111231814300.23067@reclus.nhh.no>

On Wed, 23 Nov 2011, Alberto Gallano wrote:

> Hi Roger,
>
> thanks for your reply. The data I posted is only a subset of my real data,
> in which there are some points less than 100 meters apart.
>
> To clarify what I want:
>
> 1) I would like to create neighbourhoods of 100 meters within which all
> points are neighbors. I think my code will do that with the real dataset if
> I set the upper bounds of dnearneigh to 100.
>
> 2) I want points outside of this 100 meter neighborhood to still be
> neighbors, *but* with decreasing weight by distance. I believe this is
> referred to as inverse distance weighting. I may want to accentuate this by
> using squared inverse distance weighting.
>
> The question is how can I accomplish task 2? Here is my attempt:

Try going out to a sparse matrix with both, then back again:

library(spdep)
set.seed(1)
coords <- matrix(runif(1000, 0, 2000), ncol=2)
nb1 <- dnearneigh(coords, 0, 100)
nb1
k1 <- knn2nb(knearneigh(coords, k=1))
maxD <- max(unlist(nbdists(k1, coords)))
nb2 <- dnearneigh(coords, 100, maxD)
set.ZeroPolicyOption(TRUE)
lw1 <- nb2listw(nb1, style="B")
mat1 <- as(as_dgRMatrix_listw(lw1), "CsparseMatrix")
dnb2 <- nbdists(nb2, coords)
idw2 <- lapply(dnb2, function(x) 1/(x-100))
# to avoid an abrupt drop, I suggest subracting 100m
all(unlist(sapply(idw2, function(x) is.finite(x))))
lw2 <- nb2listw(nb2, glist=idw2, style="B")
mat2 <- as(as_dgRMatrix_listw(lw2), "CsparseMatrix")
mat12 <- mat1 + mat2
image(mat1)
image(mat2)
image(mat12)
summary(rowSums(mat12))
summary(colSums(mat12))
lw12 <- mat2listw(mat12, style="B")
lw12
table(card(lw12$neighbours))

Hope this helps,

Roger

>
> coords <- cbind(dat$x, dat$y)
> k1 <- knn2nb(knearneigh(coords))
> maxD <- max(unlist(nbdists(k1, coords)))
> datnb <- dnearneigh(coords, 0, maxD)
>
> # general weights - inverse distance squared
> dlist <- nbdists(datnb, coords)
> idlist <- lapply(dlist, function(x) (1/x)^2)
>
> datlistw.id2 <- nb2listw(datnb, glist=idlist, style="B", zero.policy=TRUE)
>
> joincount.test(as.factor(dat$present), datlistw.id2, zero.policy=TRUE,
>  alternative="greater", spChk=NULL, adjust.n=TRUE)
>
>
> Does this make sense? It seems so to me. (There is a warning given, but I
> think that is because my example has so few points).
>
> thank you,
>
> Alberto
>
>
>
> On Mon, Nov 21, 2011 at 3:29 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> On Sun, 20 Nov 2011, Alberto Gallano wrote:
>>
>>  Hi, i'm trying to do join count analysis on binary data, but i'd like to
>>> create neighborhood's of 'indifference' of 100 meters around each spacial
>>> point.
>>>
>>> I've been using dnearneigh to create a neighbor list and knearneigh to
>>> calculate the maximum of the nearest neighbor distances for the upper
>>> bound
>>> argument to dnearneigh (so that no observations become islands).
>>>
>>> My question is, how do I create neighborhoods based on distance? Should I
>>> just input a number into the upper bound argument of dnearneigh, without
>>> first using knearneigh? If so, what number would correspond to 100 meters
>>> (Euclidean)? (btw, the coordinates are already projected).
>>>
>>
>> If you mean that you define neighbours as points j within 100m of point i,
>> then:
>>
>> datnb <- dnearneigh(coords, 0, 100)
>>
>> will do this if your coordinates are measured in metres. This doesn't work
>> for your example, because the closest points are almost 1200m apart, so no
>> point has any neighbours for this definition. However, your mentioning
>> neighborhoods of 'indifference' makes me uncertain that this is what you
>> mean. Do you mean placing a buffer around each point before finding
>> neighbours?
>>
>> Roger
>>
>>
>>> Here is a small subsample of my data and analysis. Thanks,
>>>
>>> Alberto
>>>
>>>
>>>
>>> # ==========================
>>> # data
>>> dat <- structure(list(present = c(0L, 0L, 0L, 1L, 0L, 0L, 0L, 0L, 0L,
>>> 0L, 0L, 0L, 1L, 0L, 0L, 0L, 1L, 1L, 0L, 1L), x = c(332940L, 316301L,
>>> 312714L, 306008L, 312248L, 329276L, 329663L, 341535L, 314761L,
>>> 332898L, 332957L, 328332L, 312462L, 330063L, 317808L, 336216L,
>>> 333763L, 315049L, 333855L, 324406L), y = c(4305226L, 4303010L,
>>> 4316685L, 4309006L, 4319255L, 4311208L, 4316837L, 4306055L, 4301051L,
>>> 4300625L, 4330342L, 4303420L, 4308292L, 4307181L, 4292904L, 4304336L,
>>> 4313750L, 4297998L, 4314941L, 4315051L)), .Names = c("present",
>>> "x", "y"), class = "data.frame", row.names = c(1L, 2L, 3L, 4L, 5L, 6L,
>>> 7L, 8L, 9L, 10L, 11L, 12L, 13L, 14L, 15L, 16L, 17L, 18L, 19L, 20L))
>>>
>>>
>>> library(spdep)
>>> coords <- cbind(dat$x, dat$y)
>>> k1 <- knn2nb(knearneigh(coords))
>>> maxD <- max(unlist(nbdists(k1, coords))) # upper bound distance btw
>>> neighbors
>>> datnb <- dnearneigh(coords, 0, maxD)
>>> summary(datnb)
>>> print(is.symmetric.nb(datnb))
>>>
>>> datlistw <- nb2listw(datnb, glist=NULL, style="B", zero.policy=TRUE)
>>>
>>> # join count
>>> joincount.test(as.factor(dat$**present), datlistw, zero.policy=TRUE,
>>>   alternative="greater", spChk=NULL, adjust.n=TRUE)
>>> # =========================
>>>
>>>        [[alternative HTML version deleted]]
>>>
>>> ______________________________**_________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/**listinfo/r-sig-geo<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>>>
>>>
>> --
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Wed Nov 23 18:55:15 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 23 Nov 2011 18:55:15 +0100 (CET)
Subject: [R-sig-Geo] Create distance 'neighborhood' (zone of
 indifference) when clustering binary data
In-Reply-To: <alpine.LRH.2.00.1111231814300.23067@reclus.nhh.no>
References: <CAO+b4j9oRxiYHt8zQq+CKw-JuVmmON3Rz0hoqAA93kMn05Eywg@mail.gmail.com>
	<alpine.LRH.2.00.1111210925140.12797@reclus.nhh.no>
	<CAO+b4j88hSDcxmwjpZnchpFwpOjmgJ+QFktySdzYkQJUuXVd0g@mail.gmail.com>
	<alpine.LRH.2.00.1111231814300.23067@reclus.nhh.no>
Message-ID: <alpine.LRH.2.00.1111231843410.23067@reclus.nhh.no>

On Wed, 23 Nov 2011, Roger Bivand wrote:

> On Wed, 23 Nov 2011, Alberto Gallano wrote:
>
>> Hi Roger,
>> 
>> thanks for your reply. The data I posted is only a subset of my real data,
>> in which there are some points less than 100 meters apart.
>> 
>> To clarify what I want:
>> 
>> 1) I would like to create neighbourhoods of 100 meters within which all
>> points are neighbors. I think my code will do that with the real dataset if
>> I set the upper bounds of dnearneigh to 100.
>> 
>> 2) I want points outside of this 100 meter neighborhood to still be
>> neighbors, *but* with decreasing weight by distance. I believe this is
>> referred to as inverse distance weighting. I may want to accentuate this by
>> using squared inverse distance weighting.
>> 
>> The question is how can I accomplish task 2? Here is my attempt:
>
> Try going out to a sparse matrix with both, then back again:
>
> library(spdep)
> set.seed(1)
> coords <- matrix(runif(1000, 0, 2000), ncol=2)
> nb1 <- dnearneigh(coords, 0, 100)
> nb1
> k1 <- knn2nb(knearneigh(coords, k=1))
> maxD <- max(unlist(nbdists(k1, coords)))
> nb2 <- dnearneigh(coords, 100, maxD)
> set.ZeroPolicyOption(TRUE)
> lw1 <- nb2listw(nb1, style="B")
> mat1 <- as(as_dgRMatrix_listw(lw1), "CsparseMatrix")
> dnb2 <- nbdists(nb2, coords)
> idw2 <- lapply(dnb2, function(x) 1/(x-100))
> # to avoid an abrupt drop, I suggest subracting 100m

This wasn't a good idea, as points with (x-100) < 1 end up with weights > 
1. It would need trapping to reduce them to 1:

idw2 <- lapply(dnb2, function(x) {x100 <- x-100; x100 <- ifelse (x100 < 1, 
1, x100); 1/x100})

Roger

> all(unlist(sapply(idw2, function(x) is.finite(x))))
> lw2 <- nb2listw(nb2, glist=idw2, style="B")
> mat2 <- as(as_dgRMatrix_listw(lw2), "CsparseMatrix")
> mat12 <- mat1 + mat2
> image(mat1)
> image(mat2)
> image(mat12)
> summary(rowSums(mat12))
> summary(colSums(mat12))
> lw12 <- mat2listw(mat12, style="B")
> lw12
> table(card(lw12$neighbours))
>
> Hope this helps,
>
> Roger
>
>> 
>> coords <- cbind(dat$x, dat$y)
>> k1 <- knn2nb(knearneigh(coords))
>> maxD <- max(unlist(nbdists(k1, coords)))
>> datnb <- dnearneigh(coords, 0, maxD)
>> 
>> # general weights - inverse distance squared
>> dlist <- nbdists(datnb, coords)
>> idlist <- lapply(dlist, function(x) (1/x)^2)
>> 
>> datlistw.id2 <- nb2listw(datnb, glist=idlist, style="B", zero.policy=TRUE)
>> 
>> joincount.test(as.factor(dat$present), datlistw.id2, zero.policy=TRUE,
>>  alternative="greater", spChk=NULL, adjust.n=TRUE)
>> 
>> 
>> Does this make sense? It seems so to me. (There is a warning given, but I
>> think that is because my example has so few points).
>> 
>> thank you,
>> 
>> Alberto
>> 
>> 
>> 
>> On Mon, Nov 21, 2011 at 3:29 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>> 
>>> On Sun, 20 Nov 2011, Alberto Gallano wrote:
>>>
>>>  Hi, i'm trying to do join count analysis on binary data, but i'd like to
>>>> create neighborhood's of 'indifference' of 100 meters around each spacial
>>>> point.
>>>> 
>>>> I've been using dnearneigh to create a neighbor list and knearneigh to
>>>> calculate the maximum of the nearest neighbor distances for the upper
>>>> bound
>>>> argument to dnearneigh (so that no observations become islands).
>>>> 
>>>> My question is, how do I create neighborhoods based on distance? Should I
>>>> just input a number into the upper bound argument of dnearneigh, without
>>>> first using knearneigh? If so, what number would correspond to 100 meters
>>>> (Euclidean)? (btw, the coordinates are already projected).
>>>> 
>>> 
>>> If you mean that you define neighbours as points j within 100m of point i,
>>> then:
>>> 
>>> datnb <- dnearneigh(coords, 0, 100)
>>> 
>>> will do this if your coordinates are measured in metres. This doesn't work
>>> for your example, because the closest points are almost 1200m apart, so no
>>> point has any neighbours for this definition. However, your mentioning
>>> neighborhoods of 'indifference' makes me uncertain that this is what you
>>> mean. Do you mean placing a buffer around each point before finding
>>> neighbours?
>>> 
>>> Roger
>>> 
>>> 
>>>> Here is a small subsample of my data and analysis. Thanks,
>>>> 
>>>> Alberto
>>>> 
>>>> 
>>>> 
>>>> # ==========================
>>>> # data
>>>> dat <- structure(list(present = c(0L, 0L, 0L, 1L, 0L, 0L, 0L, 0L, 0L,
>>>> 0L, 0L, 0L, 1L, 0L, 0L, 0L, 1L, 1L, 0L, 1L), x = c(332940L, 316301L,
>>>> 312714L, 306008L, 312248L, 329276L, 329663L, 341535L, 314761L,
>>>> 332898L, 332957L, 328332L, 312462L, 330063L, 317808L, 336216L,
>>>> 333763L, 315049L, 333855L, 324406L), y = c(4305226L, 4303010L,
>>>> 4316685L, 4309006L, 4319255L, 4311208L, 4316837L, 4306055L, 4301051L,
>>>> 4300625L, 4330342L, 4303420L, 4308292L, 4307181L, 4292904L, 4304336L,
>>>> 4313750L, 4297998L, 4314941L, 4315051L)), .Names = c("present",
>>>> "x", "y"), class = "data.frame", row.names = c(1L, 2L, 3L, 4L, 5L, 6L,
>>>> 7L, 8L, 9L, 10L, 11L, 12L, 13L, 14L, 15L, 16L, 17L, 18L, 19L, 20L))
>>>> 
>>>> 
>>>> library(spdep)
>>>> coords <- cbind(dat$x, dat$y)
>>>> k1 <- knn2nb(knearneigh(coords))
>>>> maxD <- max(unlist(nbdists(k1, coords))) # upper bound distance btw
>>>> neighbors
>>>> datnb <- dnearneigh(coords, 0, maxD)
>>>> summary(datnb)
>>>> print(is.symmetric.nb(datnb))
>>>> 
>>>> datlistw <- nb2listw(datnb, glist=NULL, style="B", zero.policy=TRUE)
>>>> 
>>>> # join count
>>>> joincount.test(as.factor(dat$**present), datlistw, zero.policy=TRUE,
>>>>   alternative="greater", spChk=NULL, adjust.n=TRUE)
>>>> # =========================
>>>>
>>>>        [[alternative HTML version deleted]]
>>>> 
>>>> ______________________________**_________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/**listinfo/r-sig-geo<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>>>> 
>>>> 
>>> --
>>> Roger Bivand
>>> Department of Economics, NHH Norwegian School of Economics,
>>> Helleveien 30, N-5045 Bergen, Norway.
>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>> e-mail: Roger.Bivand at nhh.no
>>> 
>>> 
>> 
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Steve.VanWilgenburg at EC.GC.CA  Wed Nov 23 21:28:15 2011
From: Steve.VanWilgenburg at EC.GC.CA (VanWilgenburg,Steve [Sas])
Date: Wed, 23 Nov 2011 14:28:15 -0600
Subject: [R-sig-Geo] Finding a way to select upper portion of cumulative
	probabilities in a map of probability estimates
Message-ID: <CD2F38948B6D7E4EBADDFB7273B2A69002011899@sr-sas-exch1.prairie.int.ec.gc.ca>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111123/d0ebe7b7/attachment.pl>

From mdsumner at gmail.com  Wed Nov 23 22:01:59 2011
From: mdsumner at gmail.com (Michael Sumner)
Date: Thu, 24 Nov 2011 08:01:59 +1100
Subject: [R-sig-Geo] Problem with tripGrid when some segments lie
 outside the study area
In-Reply-To: <4ECCD792.2060306@cebc.cnrs.fr>
References: <4ECCD792.2060306@cebc.cnrs.fr>
Message-ID: <CAAcGz99edzxsMgPLtm1AyQJGPYQYhdBfs6UFTq0Xn2ivCYJMEw@mail.gmail.com>

I'm not totally sure what you are asking here since as you say and as
reported by pixellate.psp (from within tripGrid) your tracks do not
all lie entirely within the grid.

 tgrid <- tripGrid(tr, grid = gt)
Error: 7 segments do not lie entirely inside the window.

You either need to expand the grid to encompass the data or trim the
data to lie within the grid - this is not done automatically.

It's also not documented in much detail so if that is the source of
confusion I apologise.

An easy way to make a grid is to use ?makeGridTopology, which will
choose defaults based on a lot of varying input data. You can
initialize the extents by doing

 makeGridTopology(tr)

and you can control the exact options with arguments for cells.dim and so on.

Cheers, Mike.


On Wed, Nov 23, 2011 at 10:22 PM, Pinaud David <pinaud at cebc.cnrs.fr> wrote:
> Dear all,
>
> I'm calculating time spent per cell over a grid (study area) with the
> package "trip", for satellite-tracked seabirds.
> Some birds bred outside the area of interest (Kerguelen Plateau, to design
> marine protected areas), so their trips didn't lie entirely in the grid. In
> this case, it seems that time is added in some cells that are not visited by
> the bird (tipically in the border of the grid).
> This problem seems coming from pixellate(), and because I need to set
> spatstat.options(checksegments=F)...
>
> Any solution?
>
> Many thanks
> David
>
> Here a reproducible exemple:
>
> library(trip)
> Le chargement a n?cessit? le package : sp
> Le chargement a n?cessit? le package : spatstat
> Le chargement a n?cessit? le package : mgcv
> This is mgcv 1.7-6. For overview type 'help("mgcv-package")'.
> Le chargement a n?cessit? le package : deldir
> deldir 0.0-15
>
> Please note: The process for determining duplicated points
> has changed from that used in version 0.0-9 (and previously).
>
> spatstat 1.23-4
> Type ?help(spatstat)? for an overview of spatstat
> ?latest.news()? for news on latest version
> ?licence.polygons()? for licence information on polygon calculations
>
> spatstat.options(checksegments=F) # to allow segment outside the window
>
> # a trip with some parts outside the study area :
> d <- data.frame(x = 1:10, y = c(1, 1.5, 2, 4, 5, 5.5, 8, 8, 6, 10), tms =
> Sys.time() + seq(10,100, 10), id = rep(1, 10))
> coordinates(d) <- ~x+y
> tr <- trip(d, c("tms", "id"))
>
> # the sutdy area :
> gridaa <- expand.grid(Long=seq(-0.5, 10.5, by=1), Lat=seq(3.5, 6.5, by=1))
> coordinates(gridaa) <- ~ Long + Lat
> gridded(gridaa) <- T
> fullgrid(gridaa) <- T
> gt <- getGridTopology(gridaa)
>
> # time spent per cell
> tgrid <- tripGrid(tr, grid = gt)
>
> image(tgrid, axes=T)
> points(coordinates(tr), t="l", col="blue")
> points(gridaa, pch="+")
> text(x= midpoints.psp(as.psp(tr)), col="green", pos=3, labels=1:9)
>
> sessionInfo()
> R version 2.13.1 (2011-07-08)
> Platform: i386-pc-mingw32/i386 (32-bit)
>
> locale:
> [1] LC_COLLATE=French_France.1252 LC_CTYPE=French_France.1252
> [3] LC_MONETARY=French_France.1252 LC_NUMERIC=C
> [5] LC_TIME=French_France.1252
>
> attached base packages:
> [1] stats graphics grDevices utils datasets methods base
>
> other attached packages:
> [1] trip_1.1-10 spatstat_1.23-4 deldir_0.0-15 mgcv_1.7-6
> [5] sp_0.9-88
>
> loaded via a namespace (and not attached):
> [1] grid_2.13.1 lattice_0.19-30 Matrix_0.9996875-3 nlme_3.1-101
>
> --
> ***************************************************
> Dr. David PINAUD
> Ing?nieur de Recherche "Analyses spatiales"
>
> Centre d'Etudes Biologiques de Chiz? - CNRS UPR1934
> 79360 Villiers-en-Bois, France
> poste 485
> Tel: +33 (0)5.49.09.35.58
> Fax: +33 (0)5.49.09.65.26
> http://www.cebc.cnrs.fr/
>
> ***************************************************
>
>
>
>
> __________ Information from ESET Mail Security, version of virus signature
> database 6653 (20111123) __________
>
> The message was checked by ESET Mail Security.
> http://www.eset.com
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>



-- 
Michael Sumner
Institute for Marine and Antarctic Studies, University of Tasmania
Hobart, Australia
e-mail: mdsumner at gmail.com


From mdsumner at gmail.com  Wed Nov 23 22:26:21 2011
From: mdsumner at gmail.com (Michael Sumner)
Date: Thu, 24 Nov 2011 08:26:21 +1100
Subject: [R-sig-Geo] Problem with tripGrid when some segments lie
 outside the study area
In-Reply-To: <CAAcGz99edzxsMgPLtm1AyQJGPYQYhdBfs6UFTq0Xn2ivCYJMEw@mail.gmail.com>
References: <4ECCD792.2060306@cebc.cnrs.fr>
	<CAAcGz99edzxsMgPLtm1AyQJGPYQYhdBfs6UFTq0Xn2ivCYJMEw@mail.gmail.com>
Message-ID: <CAAcGz989ML+Rj075GL2L94zYVL5AyADQ_Oab2fVoe33-9SzL3A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111124/847ab7f9/attachment.pl>

From chris at csfowler.com  Wed Nov 23 23:50:02 2011
From: chris at csfowler.com (Chris Fowler)
Date: Wed, 23 Nov 2011 14:50:02 -0800
Subject: [R-sig-Geo] Help overlaying raster on GoogleMaps
Message-ID: <CAFK3DV-=rNe05UtUV4Oga_MEQhgR7pE21nMidB=+nxZ08Xy94Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111123/ed51ef45/attachment.pl>

From r.hijmans at gmail.com  Thu Nov 24 00:18:11 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 23 Nov 2011 15:18:11 -0800
Subject: [R-sig-Geo] Help overlaying raster on GoogleMaps
In-Reply-To: <CAFK3DV-=rNe05UtUV4Oga_MEQhgR7pE21nMidB=+nxZ08Xy94Q@mail.gmail.com>
References: <CAFK3DV-=rNe05UtUV4Oga_MEQhgR7pE21nMidB=+nxZ08Xy94Q@mail.gmail.com>
Message-ID: <CANtt_hwuy0i=VooafWKkwEUnv6_twV=tsh+hHMn=UFXV+og4tQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111123/899818c1/attachment.pl>

From r.hijmans at gmail.com  Thu Nov 24 01:30:11 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 23 Nov 2011 16:30:11 -0800
Subject: [R-sig-Geo] Extract values with over()
In-Reply-To: <4ECBA54C.2020803@uni-muenster.de>
References: <4ECAAAD8.8030606@yahoo.com.br> <4ECAAF73.5070607@uni-muenster.de>
	<alpine.DEB.2.00.1111211823130.11087@macalan.c3sl.ufpr.br>
	<4ECBA54C.2020803@uni-muenster.de>
Message-ID: <CANtt_hwjqwe8tZ2Z6CNmGPvh5iavVM5nbdERJ1OCVXXhbhgDJw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111123/fa2468ed/attachment.pl>

From r.hijmans at gmail.com  Thu Nov 24 01:38:56 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 23 Nov 2011 16:38:56 -0800
Subject: [R-sig-Geo] Fwd: Re: Problem creating raster brick (Lyndon
	Estes)
In-Reply-To: <CALuVVaYVe2zr5vpoVJQ=bqOD9smdDgKmtV9VKXdChB6VbDWd3A@mail.gmail.com>
References: <4ECA3374.5070500@iggf.geo.uni-muenchen.de>
	<4ECA34F0.7030905@lmu.de>
	<CALuVVaYVe2zr5vpoVJQ=bqOD9smdDgKmtV9VKXdChB6VbDWd3A@mail.gmail.com>
Message-ID: <CANtt_hw+P69D6czZK58bKc2B5UBD_5on3KMeSthOj1H=XKEZbg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111123/e5372cf9/attachment.pl>

From r.hijmans at gmail.com  Thu Nov 24 01:45:20 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 23 Nov 2011 16:45:20 -0800
Subject: [R-sig-Geo] Issue with argument zlim() when plotting rasters
In-Reply-To: <CAFu_poGdgqX7nk_j=shMzLNLUc=WcGwOerF=WeGgoPc=byozSw@mail.gmail.com>
References: <CAFu_poGdgqX7nk_j=shMzLNLUc=WcGwOerF=WeGgoPc=byozSw@mail.gmail.com>
Message-ID: <CANtt_hxQUS8J5U5_C2uN_eJM8j-+FmKmFW7orXfnnX2MyLmNeg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111123/6a365a1f/attachment.pl>

From r.hijmans at gmail.com  Thu Nov 24 01:58:21 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 23 Nov 2011 16:58:21 -0800
Subject: [R-sig-Geo] Finding a way to select upper portion of cumulative
 probabilities in a map of probability estimates
In-Reply-To: <CD2F38948B6D7E4EBADDFB7273B2A69002011899@sr-sas-exch1.prairie.int.ec.gc.ca>
References: <CD2F38948B6D7E4EBADDFB7273B2A69002011899@sr-sas-exch1.prairie.int.ec.gc.ca>
Message-ID: <CANtt_hxJ15GW=s1d1tYVdamdzL4rVt_Eau0f12_P30swASmvxA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111123/3a03fbb9/attachment.pl>

From gianni.lavaredo at gmail.com  Thu Nov 24 01:59:39 2011
From: gianni.lavaredo at gmail.com (gianni lavaredo)
Date: Thu, 24 Nov 2011 01:59:39 +0100
Subject: [R-sig-Geo] Raster Library - problem to save ascii file with NAvalue
Message-ID: <CAJ6JbR8XmRumk+T9pifiophDMCQQee=eBfEgzrQeyBp+ykJpfw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111124/c3adea91/attachment.pl>

From r.hijmans at gmail.com  Thu Nov 24 02:22:16 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 23 Nov 2011 17:22:16 -0800
Subject: [R-sig-Geo] Raster Library - problem to save ascii file with
	NAvalue
In-Reply-To: <CAJ6JbR8XmRumk+T9pifiophDMCQQee=eBfEgzrQeyBp+ykJpfw@mail.gmail.com>
References: <CAJ6JbR8XmRumk+T9pifiophDMCQQee=eBfEgzrQeyBp+ykJpfw@mail.gmail.com>
Message-ID: <CANtt_hw6gcf4ejG-7pU2dq9uw1O6jvHh=yLg8DMrscb0=ZMQdw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111123/76e3e3d8/attachment.pl>

From gianni.lavaredo at gmail.com  Thu Nov 24 02:59:19 2011
From: gianni.lavaredo at gmail.com (gianni lavaredo)
Date: Thu, 24 Nov 2011 02:59:19 +0100
Subject: [R-sig-Geo] Raster Library - problem to save ascii file with
	NAvalue
In-Reply-To: <CANtt_hw6gcf4ejG-7pU2dq9uw1O6jvHh=yLg8DMrscb0=ZMQdw@mail.gmail.com>
References: <CAJ6JbR8XmRumk+T9pifiophDMCQQee=eBfEgzrQeyBp+ykJpfw@mail.gmail.com>
	<CANtt_hw6gcf4ejG-7pU2dq9uw1O6jvHh=yLg8DMrscb0=ZMQdw@mail.gmail.com>
Message-ID: <CAJ6JbR-dFsY4DA5y-0XVHb0HX1w7aiaXtgdRBksghLVPgyQdaQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111124/63b5acdc/attachment.pl>

From r.hijmans at gmail.com  Thu Nov 24 03:34:26 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 23 Nov 2011 18:34:26 -0800
Subject: [R-sig-Geo] Raster Library - problem to save ascii file with
	NAvalue
In-Reply-To: <CAJ6JbR-dFsY4DA5y-0XVHb0HX1w7aiaXtgdRBksghLVPgyQdaQ@mail.gmail.com>
References: <CAJ6JbR8XmRumk+T9pifiophDMCQQee=eBfEgzrQeyBp+ykJpfw@mail.gmail.com>
	<CANtt_hw6gcf4ejG-7pU2dq9uw1O6jvHh=yLg8DMrscb0=ZMQdw@mail.gmail.com>
	<CAJ6JbR-dFsY4DA5y-0XVHb0HX1w7aiaXtgdRBksghLVPgyQdaQ@mail.gmail.com>
Message-ID: <CANtt_hz3K762iRaCss9wiFBigG00ZkwKUcdsYaHsWA1hs1rFjQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111123/641c4ca1/attachment.pl>

From pinaud at cebc.cnrs.fr  Thu Nov 24 09:38:33 2011
From: pinaud at cebc.cnrs.fr (Pinaud David)
Date: Thu, 24 Nov 2011 09:38:33 +0100
Subject: [R-sig-Geo] Problem with tripGrid when some segments lie
 outside the study area
In-Reply-To: <CAAcGz989ML+Rj075GL2L94zYVL5AyADQ_Oab2fVoe33-9SzL3A@mail.gmail.com>
References: <4ECCD792.2060306@cebc.cnrs.fr>
	<CAAcGz99edzxsMgPLtm1AyQJGPYQYhdBfs6UFTq0Xn2ivCYJMEw@mail.gmail.com>
	<CAAcGz989ML+Rj075GL2L94zYVL5AyADQ_Oab2fVoe33-9SzL3A@mail.gmail.com>
Message-ID: <4ECE0289.3050400@cebc.cnrs.fr>

Hi Michael,
Yes, this error occured before, that's why I set firstly 
spatstat.options(checksegments=F) to avoid that. But in this case 
(checksegments=F), it seems that pixellate.psp() behaves "strangely" and 
adds time in cells that are not visited by the bird, in the border of 
the grid (see the plot with my example)
I think about this alternative solution (calculation on a larger grid), 
but we faced to memory (or running time) problems. We need to do that 
for >800 trips, on a 40000 cells grid... So I was thinking about 
clipping first the trip according to the grid limits, then running 
tripGrid(), but this problem (with pixellate.psp()?) occured.
Do you have an idea how we can do that?

Otherwise, your package is very usefull!

Many thanks

David

Le 23/11/2011 22:26, Michael Sumner a ?crit :
> I should have added that probably the best way to trim the result is 
> to just trim the grid built on the full data, then there is no messy 
> problem with line intersections or spatial vs time based subsetting. 
> That is I think closest to your request.
>
> (This kind of "time spent" estimate is also very simplistic and 
> dependent on the cell size chosen and assumptions about "straight 
> line" movement. That is another thing the doc should say more clearly 
> I think.)
>
> Cheers, Mike (author of trip)
>
>
>
> On Thursday, November 24, 2011, Michael Sumner <mdsumner at gmail.com 
> <mailto:mdsumner at gmail.com>> wrote:
> > I'm not totally sure what you are asking here since as you say and as
> > reported by pixellate.psp (from within tripGrid) your tracks do not
> > all lie entirely within the grid.
> >
> >  tgrid <- tripGrid(tr, grid = gt)
> > Error: 7 segments do not lie entirely inside the window.
> >
> > You either need to expand the grid to encompass the data or trim the
> > data to lie within the grid - this is not done automatically.
> >
> > It's also not documented in much detail so if that is the source of
> > confusion I apologise.
> >
> > An easy way to make a grid is to use ?makeGridTopology, which will
> > choose defaults based on a lot of varying input data. You can
> > initialize the extents by doing
> >
> >  makeGridTopology(tr)
> >
> > and you can control the exact options with arguments for cells.dim 
> and so on.
> >
> > Cheers, Mike.
> >
> >
> > On Wed, Nov 23, 2011 at 10:22 PM, Pinaud David <pinaud at cebc.cnrs.fr 
> <mailto:pinaud at cebc.cnrs.fr>> wrote:
> >> Dear all,
> >>
> >> I'm calculating time spent per cell over a grid (study area) with the
> >> package "trip", for satellite-tracked seabirds.
> >> Some birds bred outside the area of interest (Kerguelen Plateau, to 
> design
> >> marine protected areas), so their trips didn't lie entirely in the 
> grid. In
> >> this case, it seems that time is added in some cells that are not 
> visited by
> >> the bird (tipically in the border of the grid).
> >> This problem seems coming from pixellate(), and because I need to set
> >> spatstat.options(checksegments=F)...
> >>
> >> Any solution?
> >>
> >> Many thanks
> >> David
> >>
> >> Here a reproducible exemple:
> >>
> >> library(trip)
> >> Le chargement a n?cessit? le package : sp
> >> Le chargement a n?cessit? le package : spatstat
> >> Le chargement a n?cessit? le package : mgcv
> >> This is mgcv 1.7-6. For overview type 'help("mgcv-package")'.
> >> Le chargement a n?cessit? le package : deldir
> >> deldir 0.0-15
> >>
> >> Please note: The process for determining duplicated points
> >> has changed from that used in version 0.0-9 (and previously).
> >>
> >> spatstat 1.23-4
> >> Type ?help(spatstat)? for an overview of spatstat
> >> ?latest.news()? for news on latest version
> >> ?licence.polygons()? for licence information on polygon calculations
> >>
> >> spatstat.options(checksegments=F) # to allow segment outside the window
> >>
> >> # a trip with some parts outside the study area :
> >> d <- data.frame(x = 1:10, y = c(1, 1.5, 2, 4, 5, 5.5, 8, 8, 6, 10), 
> tms =
> >> Sys.time() + seq(10,100, 10), id = rep(1, 10))
> >> coordinates(d) <- ~x+y
> >> tr <- trip(d, c("tms", "id"))
> >>
> >> # the sutdy area :
> >> gridaa <- expand.grid(Long=seq(-0.5, 10.5, by=1), Lat=seq(3.5, 6.5, 
> by=1))
> >> coordinates(gridaa) <- ~ Long + Lat
> >> gridded(gridaa) <- T
> >> fullgrid(gridaa) <- T
> >> gt <- getGridTopology(gridaa)
> >>
> >> # time spent per cell
> >> tgrid <- tripGrid(tr, grid = gt)
> >>
> >> image(tgrid, axes=T)
> >> points(coordinates(tr), t="l", col="blue")
> >> points(gridaa, pch="+")
> >> text(x= midpoints.psp(as.psp(tr)), col="green", pos=3, labels=1:9)
> >>
> >> sessionInfo()
> >> R version 2.13.1 (2011-07-08)
> >> Platform: i386-pc-mingw32/i386 (32-bit)
> >>
> >> locale:
> >> [1] LC_COLLATE=French_France.1252 LC_CTYPE=French_France.1252
> >> [3] LC_MONETARY=French_France.1252 LC_NUMERIC=C
> >> [5] LC_TIME=French_France.1252
> >>
> >> attached base packages:
> >> [1] stats graphics grDevices utils datasets methods base
> >>
> >> other attached packages:
> >> [1] trip_1.1-10 spatstat_1.23-4 deldir_0.0-15 mgcv_1.7-6
> >> [5] sp_0.9-88
> >>
> >> loaded via a namespace (and not attached):
> >> [1] grid_2.13.1 lattice_0.19-30 Matrix_0.9996875-3 nlme_3.1-101
> >>
> >> --
> >> ***************************************************
> >> Dr. David PINAUD
> >> Ing?nieur de Recherche "Analyses spatiales"
> >>
> >> Centre d'Etudes Biologiques de Chiz? - CNRS UPR1934
> >> 79360 Villiers-en-Bois, France
> >> poste 485
> >> Tel: +33 (0)5.49.09.35.58
> >> Fax: +33 (0)5.49.09.65.26
> >> http://www.cebc.cnrs.fr/
> >>
> >> ***************************************************
> >>
> >>
> >>
> >>
> >> __________ Information from ESET Mail Security, version of virus 
> signature
> >> database 6653 (20111123) __________
> >>
> >> The message was checked by ESET Mail Security.
> >> http://www.eset.com
> >>
> >>
> >> _______________________________________________
> >> R-sig-Geo mailing list
> >> R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>
> >>
> >
> >
> >
> > --
> > Michael Sumner
> > Institute for Marine and Antarctic Studies, University of Tasmania
> > Hobart, Australia
> > e-mail: mdsumner at gmail.com <mailto:mdsumner at gmail.com>
> >
>
> -- 
> Michael Sumner
> Institute for Marine and Antarctic Studies, University of Tasmania
> Hobart, Australia
> e-mail: mdsumner at gmail.com <mailto:mdsumner at gmail.com>

-- 
***************************************************
Dr. David PINAUD
Ing?nieur de Recherche "Analyses spatiales"

Centre d'Etudes Biologiques de Chiz? - CNRS UPR1934
79360 Villiers-en-Bois, France
poste 485
Tel: +33 (0)5.49.09.35.58
Fax: +33 (0)5.49.09.65.26
http://www.cebc.cnrs.fr/

***************************************************




__________ Information from ESET Mail Security, version of virus signature database 6654 (20111123) __________

The message was checked by ESET Mail Security.
http://www.eset.com

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111124/19b5b341/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: pinaud.vcf
Type: text/x-vcard
Size: 335 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111124/19b5b341/attachment.vcf>

From mdsumner at gmail.com  Thu Nov 24 12:55:01 2011
From: mdsumner at gmail.com (Michael Sumner)
Date: Thu, 24 Nov 2011 22:55:01 +1100
Subject: [R-sig-Geo] Problem with tripGrid when some segments lie
 outside the study area
In-Reply-To: <4ECE0289.3050400@cebc.cnrs.fr>
References: <4ECCD792.2060306@cebc.cnrs.fr>
	<CAAcGz99edzxsMgPLtm1AyQJGPYQYhdBfs6UFTq0Xn2ivCYJMEw@mail.gmail.com>
	<CAAcGz989ML+Rj075GL2L94zYVL5AyADQ_Oab2fVoe33-9SzL3A@mail.gmail.com>
	<4ECE0289.3050400@cebc.cnrs.fr>
Message-ID: <CAAcGz99hmGvWhu75PNx4Y7G6czxicz0jpVgGZ-9QzTcp3=fTCw@mail.gmail.com>

I see, I don't know then. That's not the way tripGrid is intended to
be used so I will consider preventing that option from being set to
FALSE for this usage.

I've not explored why pixellate.psp does that in this case, but at any
rate it is strictly about spatstat and not trip.

Thanks for the heads up, I will explore preventing use of tripGrid
when spatstat.options(checksegments = FALSE).

Cheers, Mike.

On Thu, Nov 24, 2011 at 7:38 PM, Pinaud David <pinaud at cebc.cnrs.fr> wrote:
> Hi Michael,
> Yes, this error occured before, that's why I set firstly
> spatstat.options(checksegments=F) to avoid that. But in this case
> (checksegments=F), it seems that pixellate.psp() behaves "strangely" and
> adds time in cells that are not visited by the bird, in the border of the
> grid (see the plot with my example)
> I think about this alternative solution (calculation on a larger grid), but
> we faced to memory (or running time) problems. We need to do that for >800
> trips, on a 40000 cells grid... So I was thinking about clipping first the
> trip according to the grid limits, then running tripGrid(), but this problem
> (with pixellate.psp()?) occured.
> Do you have an idea how we can do that?
>
> Otherwise, your package is very usefull!
>
> Many thanks
>
> David
>
> Le 23/11/2011 22:26, Michael Sumner a ?crit?:
>
> I should have added that probably the best way to trim the result is to just
> trim the grid built on the full data, then there is no messy problem with
> line intersections or spatial vs time based subsetting. That is I think
> closest to your request.
>
> (This kind of "time spent" estimate is also very simplistic and dependent on
> the cell size chosen and assumptions about "straight line" movement. That is
> another thing the doc should say more clearly I think.)
>
> Cheers, Mike (author of trip)
>
>
>
> On Thursday, November 24, 2011, Michael Sumner <mdsumner at gmail.com> wrote:
>> I'm not totally sure what you are asking here since as you say and as
>> reported by pixellate.psp (from within tripGrid) your tracks do not
>> all lie entirely within the grid.
>>
>> ?tgrid <- tripGrid(tr, grid = gt)
>> Error: 7 segments do not lie entirely inside the window.
>>
>> You either need to expand the grid to encompass the data or trim the
>> data to lie within the grid - this is not done automatically.
>>
>> It's also not documented in much detail so if that is the source of
>> confusion I apologise.
>>
>> An easy way to make a grid is to use ?makeGridTopology, which will
>> choose defaults based on a lot of varying input data. You can
>> initialize the extents by doing
>>
>> ?makeGridTopology(tr)
>>
>> and you can control the exact options with arguments for cells.dim and so
>> on.
>>
>> Cheers, Mike.
>>
>>
>> On Wed, Nov 23, 2011 at 10:22 PM, Pinaud David <pinaud at cebc.cnrs.fr>
>> wrote:
>>> Dear all,
>>>
>>> I'm calculating time spent per cell over a grid (study area) with the
>>> package "trip", for satellite-tracked seabirds.
>>> Some birds bred outside the area of interest (Kerguelen Plateau, to
>>> design
>>> marine protected areas), so their trips didn't lie entirely in the grid.
>>> In
>>> this case, it seems that time is added in some cells that are not visited
>>> by
>>> the bird (tipically in the border of the grid).
>>> This problem seems coming from pixellate(), and because I need to set
>>> spatstat.options(checksegments=F)...
>>>
>>> Any solution?
>>>
>>> Many thanks
>>> David
>>>
>>> Here a reproducible exemple:
>>>
>>> library(trip)
>>> Le chargement a n?cessit? le package : sp
>>> Le chargement a n?cessit? le package : spatstat
>>> Le chargement a n?cessit? le package : mgcv
>>> This is mgcv 1.7-6. For overview type 'help("mgcv-package")'.
>>> Le chargement a n?cessit? le package : deldir
>>> deldir 0.0-15
>>>
>>> Please note: The process for determining duplicated points
>>> has changed from that used in version 0.0-9 (and previously).
>>>
>>> spatstat 1.23-4
>>> Type ?help(spatstat)? for an overview of spatstat
>>> ?latest.news()? for news on latest version
>>> ?licence.polygons()? for licence information on polygon calculations
>>>
>>> spatstat.options(checksegments=F) # to allow segment outside the window
>>>
>>> # a trip with some parts outside the study area :
>>> d <- data.frame(x = 1:10, y = c(1, 1.5, 2, 4, 5, 5.5, 8, 8, 6, 10), tms =
>>> Sys.time() + seq(10,100, 10), id = rep(1, 10))
>>> coordinates(d) <- ~x+y
>>> tr <- trip(d, c("tms", "id"))
>>>
>>> # the sutdy area :
>>> gridaa <- expand.grid(Long=seq(-0.5, 10.5, by=1), Lat=seq(3.5, 6.5,
>>> by=1))
>>> coordinates(gridaa) <- ~ Long + Lat
>>> gridded(gridaa) <- T
>>> fullgrid(gridaa) <- T
>>> gt <- getGridTopology(gridaa)
>>>
>>> # time spent per cell
>>> tgrid <- tripGrid(tr, grid = gt)
>>>
>>> image(tgrid, axes=T)
>>> points(coordinates(tr), t="l", col="blue")
>>> points(gridaa, pch="+")
>>> text(x= midpoints.psp(as.psp(tr)), col="green", pos=3, labels=1:9)
>>>
>>> sessionInfo()
>>> R version 2.13.1 (2011-07-08)
>>> Platform: i386-pc-mingw32/i386 (32-bit)
>>>
>>> locale:
>>> [1] LC_COLLATE=French_France.1252 LC_CTYPE=French_France.1252
>>> [3] LC_MONETARY=French_France.1252 LC_NUMERIC=C
>>> [5] LC_TIME=French_France.1252
>>>
>>> attached base packages:
>>> [1] stats graphics grDevices utils datasets methods base
>>>
>>> other attached packages:
>>> [1] trip_1.1-10 spatstat_1.23-4 deldir_0.0-15 mgcv_1.7-6
>>> [5] sp_0.9-88
>>>
>>> loaded via a namespace (and not attached):
>>> [1] grid_2.13.1 lattice_0.19-30 Matrix_0.9996875-3 nlme_3.1-101
>>>
>>> --
>>> ***************************************************
>>> Dr. David PINAUD
>>> Ing?nieur de Recherche "Analyses spatiales"
>>>
>>> Centre d'Etudes Biologiques de Chiz? - CNRS UPR1934
>>> 79360 Villiers-en-Bois, France
>>> poste 485
>>> Tel: +33 (0)5.49.09.35.58
>>> Fax: +33 (0)5.49.09.65.26
>>> http://www.cebc.cnrs.fr/
>>>
>>> ***************************************************
>>>
>>>
>>>
>>>
>>> __________ Information from ESET Mail Security, version of virus
>>> signature
>>> database 6653 (20111123) __________
>>>
>>> The message was checked by ESET Mail Security.
>>> http://www.eset.com
>>>
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>>
>>
>>
>> --
>> Michael Sumner
>> Institute for Marine and Antarctic Studies, University of Tasmania
>> Hobart, Australia
>> e-mail: mdsumner at gmail.com
>>
>
> --
> Michael Sumner
> Institute for Marine and Antarctic Studies, University of Tasmania
> Hobart, Australia
> e-mail: mdsumner at gmail.com
>
> --
> ***************************************************
> Dr. David PINAUD
> Ing?nieur de Recherche "Analyses spatiales"
>
> Centre d'Etudes Biologiques de Chiz? - CNRS UPR1934
> 79360 Villiers-en-Bois, France
> poste 485
> Tel: +33 (0)5.49.09.35.58
> Fax: +33 (0)5.49.09.65.26
> http://www.cebc.cnrs.fr/
>
> ***************************************************
>
> __________ Information from ESET Mail Security, version of virus signature
> database 6654 (20111123) __________
>
> The message was checked by ESET Mail Security.
> http://www.eset.com
>



-- 
Michael Sumner
Institute for Marine and Antarctic Studies, University of Tasmania
Hobart, Australia
e-mail: mdsumner at gmail.com


From marcelino.delacruz at upm.es  Thu Nov 24 14:27:48 2011
From: marcelino.delacruz at upm.es (marcelino.delacruz at upm.es)
Date: Thu, 24 Nov 2011 14:27:48 +0100
Subject: [R-sig-Geo] DEM interpolation with Delaunay triangulation
In-Reply-To: <kzVFRHuj.1322054384.4103870.marcelino.delacruz@upm.es>
Message-ID: <Gmoaxbst.1322141268.3242350.marcelino.delacruz@upm.es>

Hi all,

Thanks to Rolf's suggestion I have incorporated the arguments x and y to
let the user select the precise set of points where to interpolate.

I have also corrected the formula (now is a  inverse distance weighted
interpolation) and have incorporated also the "power parameter" p as
an argument.

Cheers,

MArcelino






tin <- function(X, nx, ny,x=NULL, y=NULL,p=1){
     require(spatstat)
     lltes<-delaunay(X)

       if(is.null(x)){
            gri <-  gridcentres(X$window, nx=nx, ny=ny)
            gri.ppp <- ppp(gri$x,gri$y, window=X$window,
                                 marks=rep(0,length(gri$x)))
	}
	if(!is.null(x)){
	    gri.ppp<- ppp(x=x, y=y, window=X$window,
	                         marks=rep(0, length(x)))
        }

       cat("\n","number of triangles =",
length(lltes[[3]]),"\n\n")
      for(i in 1:length(lltes[[3]])){
            progressreport(i, length(lltes[[3]]))

             #grid points within the triangulation
            xoyo <- unmark(gri.ppp[lltes[[3]][[i]]])

            # original points defining the triangle
            xyz <- X[lltes[[3]][[i]]]
              # z values of the three points
              z<-xyz$marks

            #distance from grid points to vertices
             cdis <- crossdist(xoyo,xyz)

             # inverse distance weighted interpolation within triangle
             grim <- apply(cdis, 1, function(f) sum((1/f^p)*z)/sum(1/f^p))

            #assign interpolated values
              gri.ppp[lltes[[3]][[i]]]$marks <- grim
       }
  return(gri.ppp)
}


>
># See how does it work:
>
>data(longleaf)
>plot(longleaf)
>
>cosa <- tin(longleaf, nx=100, ny=100)
>
>cosa2 <- tin(longleaf, x=1:100, y=1:100)


>plot(cosa)

>plot(cosa2)


>
>image(x=1:100,y=1:100, z=t(matrix(cosa$marks, 100,100, byrow=T)))
>
>
>
>Cheers, Marcelino
>
>
>>> On 21/11/11 04:30, gianni lavaredo wrote:
>>>> Dear Researchers,
>>>>
>>>> I am looking a package o method to interpolate a point data.frame (x,y,z)
>>>> with Delaunay triangulation  (Trianguled interpoaltion network) and
>>>> create
>>>> a polygons data,frame o a raster. I know there are several fuction in
>>>> library RSAGA, spatstat (with "deldir"), library geometry.


From mathieu.rajerison at gmail.com  Thu Nov 24 15:49:14 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Thu, 24 Nov 2011 15:49:14 +0100
Subject: [R-sig-Geo] spatstat - affine a window - enlarging (with same
	center)
In-Reply-To: <4ECC6E1A.2020508@auckland.ac.nz>
References: <DbIrxXUH.1321986431.2581190.marcelino.delacruz@upm.es>
	<4ECC6E1A.2020508@auckland.ac.nz>
Message-ID: <CAGfc75=L1qPispNSx7XUgFPui0FypzA10F+MTFF2wCNqgp_2Ww@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111124/fbf8b229/attachment.pl>

From edzer.pebesma at uni-muenster.de  Thu Nov 24 16:13:21 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 24 Nov 2011 16:13:21 +0100
Subject: [R-sig-Geo] DEM interpolation with Delaunay triangulation
In-Reply-To: <Gmoaxbst.1322141268.3242350.marcelino.delacruz@upm.es>
References: <Gmoaxbst.1322141268.3242350.marcelino.delacruz@upm.es>
Message-ID: <4ECE5F11.5050302@uni-muenster.de>

In that case, you might want to reconsider the name of this function, as
TIN is something different from inverse distance weighted; if you are on
an edge of the triangle, you need to get the straight line interpolation
from the two z values on that edge, the third needs to get zero weight...

On 11/24/2011 02:27 PM, marcelino.delacruz at upm.es wrote:
> Hi all,
> 
> Thanks to Rolf's suggestion I have incorporated the arguments x and y to
> let the user select the precise set of points where to interpolate.
> 
> I have also corrected the formula (now is a  inverse distance weighted
> interpolation) and have incorporated also the "power parameter" p as
> an argument.
> 
> Cheers,
> 
> MArcelino
> 
> 
> 
> 
> 
> 
> tin <- function(X, nx, ny,x=NULL, y=NULL,p=1){
>      require(spatstat)
>      lltes<-delaunay(X)
> 
>        if(is.null(x)){
>             gri <-  gridcentres(X$window, nx=nx, ny=ny)
>             gri.ppp <- ppp(gri$x,gri$y, window=X$window,
>                                  marks=rep(0,length(gri$x)))
> 	}
> 	if(!is.null(x)){
> 	    gri.ppp<- ppp(x=x, y=y, window=X$window,
> 	                         marks=rep(0, length(x)))
>         }
> 
>        cat("\n","number of triangles =",
> length(lltes[[3]]),"\n\n")
>       for(i in 1:length(lltes[[3]])){
>             progressreport(i, length(lltes[[3]]))
> 
>              #grid points within the triangulation
>             xoyo <- unmark(gri.ppp[lltes[[3]][[i]]])
> 
>             # original points defining the triangle
>             xyz <- X[lltes[[3]][[i]]]
>               # z values of the three points
>               z<-xyz$marks
> 
>             #distance from grid points to vertices
>              cdis <- crossdist(xoyo,xyz)
> 
>              # inverse distance weighted interpolation within triangle
>              grim <- apply(cdis, 1, function(f) sum((1/f^p)*z)/sum(1/f^p))
> 
>             #assign interpolated values
>               gri.ppp[lltes[[3]][[i]]]$marks <- grim
>        }
>   return(gri.ppp)
> }
> 
> 
>>
>> # See how does it work:
>>
>> data(longleaf)
>> plot(longleaf)
>>
>> cosa <- tin(longleaf, nx=100, ny=100)
>>
>> cosa2 <- tin(longleaf, x=1:100, y=1:100)
> 
> 
>> plot(cosa)
> 
>> plot(cosa2)
> 
> 
>>
>> image(x=1:100,y=1:100, z=t(matrix(cosa$marks, 100,100, byrow=T)))
>>
>>
>>
>> Cheers, Marcelino
>>
>>
>>>> On 21/11/11 04:30, gianni lavaredo wrote:
>>>>> Dear Researchers,
>>>>>
>>>>> I am looking a package o method to interpolate a point data.frame (x,y,z)
>>>>> with Delaunay triangulation  (Trianguled interpoaltion network) and
>>>>> create
>>>>> a polygons data,frame o a raster. I know there are several fuction in
>>>>> library RSAGA, spatstat (with "deldir"), library geometry.
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From chamb244 at msu.edu  Thu Nov 24 17:39:37 2011
From: chamb244 at msu.edu (Jordan Chamberlin)
Date: Thu, 24 Nov 2011 11:39:37 -0500
Subject: [R-sig-Geo] combine function in R?
Message-ID: <4ECE7349.8000500@msu.edu>

Hello list,

Is there something like a combine function in R? I'm thinking of the 
COMBINE function in the old ArcInfo (which gives a grid of unique 
cell-wise combinations of integer values in a set of input grids). There 
must be something like that already written for R, but I'm new to this, 
so I'm grateful for pointers in the right direction.

Jordan


From r.hijmans at gmail.com  Thu Nov 24 20:26:58 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 24 Nov 2011 11:26:58 -0800
Subject: [R-sig-Geo] combine function in R?
In-Reply-To: <4ECE7349.8000500@msu.edu>
References: <4ECE7349.8000500@msu.edu>
Message-ID: <CANtt_hz-C_LH+k_D0MKAUj=kEFfQCcOfA2yo7RnGLsE+qw8tpg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111124/e971a020/attachment.pl>

From r.hijmans at gmail.com  Thu Nov 24 20:37:55 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 24 Nov 2011 11:37:55 -0800
Subject: [R-sig-Geo] Finding a way to select upper portion of cumulative
 probabilities in a map of probability estimates
In-Reply-To: <CD2F38948B6D7E4EBADDFB7273B2A690020118A3@sr-sas-exch1.prairie.int.ec.gc.ca>
References: <CD2F38948B6D7E4EBADDFB7273B2A69002011899@sr-sas-exch1.prairie.int.ec.gc.ca>
	<CANtt_hxJ15GW=s1d1tYVdamdzL4rVt_Eau0f12_P30swASmvxA@mail.gmail.com>
	<CD2F38948B6D7E4EBADDFB7273B2A690020118A1@sr-sas-exch1.prairie.int.ec.gc.ca>
	<CD2F38948B6D7E4EBADDFB7273B2A690020118A3@sr-sas-exch1.prairie.int.ec.gc.ca>
Message-ID: <CANtt_hy-dmFnKxod7E0_=gRj0CbwtQK8vJgRNyqE9kp1c951yQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111124/78b0fd71/attachment.pl>

From paulojus at c3sl.ufpr.br  Thu Nov 24 23:02:43 2011
From: paulojus at c3sl.ufpr.br (Paulo Justiniano Ribeiro Jr)
Date: Thu, 24 Nov 2011 20:02:43 -0200 (BRST)
Subject: [R-sig-Geo] Extract values with over()
In-Reply-To: <4ECBA54C.2020803@uni-muenster.de>
References: <4ECAAAD8.8030606@yahoo.com.br> <4ECAAF73.5070607@uni-muenster.de>
	<alpine.DEB.2.00.1111211823130.11087@macalan.c3sl.ufpr.br>
	<4ECBA54C.2020803@uni-muenster.de>
Message-ID: <alpine.DEB.2.00.1111242001200.2818@macalan.c3sl.ufpr.br>

Edzer
thanks for pointing this

My complete solution goes a bit different without using returnList
and taking advantege of the named vector returned by over()

##
require(sp)
set.seed(12)
xy <- cbind(runif(n=500,min=0, max=20),
             runif(n=500,min=0, max=20))
## points
pontos <- SpatialPoints(xy)
## grid of "quadrats"
## i. as SpatialGrid
grid <- SpatialGrid(grid = GridTopology(c(0.5,0.5), c(1,1), c(20,20)))
## ii. as SpatialPixels
gridPix <- grid
fullgrid(gridPix) <- FALSE
## iii. as SpatialPolygons
gridPol <- as.SpatialPolygons.SpatialPixels(gridPix)

PtGr <- table(over(pontos, grid));length(PtGr)
POS <- as.numeric(names(PtGr))

N <- numeric(length(grid))
N[POS] <- PtGr
N

plot(gridPol)
plot(pontos, add=T, pch=19, cex=0.5)
plot(grid, pch=as.character(N), add=T, cex=0.6, col=2)



Paulo Justiniano Ribeiro Jr
LEG (Laboratorio de Estatistica e Geoinformacao)
Universidade Federal do Parana
Caixa Postal 19.081
CEP 81.531-990
Curitiba, PR  -  Brasil
Tel: (+55) 41 3361 3573
VOIP: (+55) (41) (3361 3600) 1053 1066
Fax: (+55) 41 3361 3141
e-mail: paulojus AT  ufpr  br
http://www.leg.ufpr.br/~paulojus

On Tue, 22 Nov 2011, Edzer Pebesma wrote:

>
>
> On 11/21/2011 09:24 PM, Paulo Justiniano Ribeiro Jr wrote:
>> Dear Edzer and Alexandre
>>
>> wouldn't the following work as requested?
>>
>> fullgrid(grid) <- FALSE
>> class(grid)  ## SpatialPixels
>>
>> ap3 <- as.SpatialPolygons.SpatialPixels(grid)
>> table(over(pontos, ap3))
>
> Paulo, that is a step in the right direction, as
>
>> table(over(pontos, ap3))[1:5]
>
> 1 2 3 4 5
> 2 1 3 1 2
>
> gives frequencies for each cell, but this would also be obtained by the
> grid itself:
>
>> table(over(pontos, grid))[1:5]
>
> 1 2 3 4 5
> 2 1 3 1 2
>
> However, as
>
>> length(table(over(pontos, grid)))
> [1] 298
>> length(grid)
> [1] 400
>
> shows we have empty grid cells. but this gives gaps (implicit 0 values)
> for empty cells in grid. The simpler alternative is to do the over with
> returnList=TRUE, which returns ALL points in each (grid cell, now
> polygon) in ap3:
>
>>  over(ap3, pontos, returnList=TRUE)[1:5]
> [[1]]
> [1] 416 459
>
> [[2]]
> [1] 385
>
> [[3]]
> [1]  17 132 351
>
> [[4]]
> [1] 387
>
> [[5]]
> [1] 311 322
>
> taking the length of each vector gives the frequencies (INCLUDING the
> zero frequencies that table does NOT give you):
>
> n = sapply(over(ap3, pontos, returnList=TRUE), length)
> x = SpatialPixelsDataFrame(grid, data.frame(n=n))
> spplot(x, sp.layout=list("sp.points", pontos), at=0:6-.5)
>
> Without doubt, there are other ways of doing this, for instance with
> package raster.
>
> Thanks for helping. It seems to be hard to make complex things simple,
> and I'd be happy to hear suggestions for making this even simpler.
>
>>
>>
>>
>> Paulo Justiniano Ribeiro Jr
>> LEG (Laboratorio de Estatistica e Geoinformacao)
>> Universidade Federal do Parana
>> Caixa Postal 19.081
>> CEP 81.531-990
>> Curitiba, PR  -  Brasil
>> Tel: (+55) 41 3361 3573
>> VOIP: (+55) (41) (3361 3600) 1053 1066
>> Fax: (+55) 41 3361 3141
>> e-mail: paulojus AT  ufpr  br
>> http://www.leg.ufpr.br/~paulojus
>>
>> On Mon, 21 Nov 2011, Edzer Pebesma wrote:
>>
>>>
>>>
>>> On 11/21/2011 08:47 PM, ASANTOS wrote:
>>>> Dear colleges,
>>>>
>>>>      I try to extract values with over () function , but not working
>>>> with my script, when I make:
>>>>
>>>
>>> it only extracts values when there are values to extract, please read
>>> the documentation.
>>>
>>>>
>>>> was expected that the over() give the frequency of points inside each
>>>> parcel
>>>
>>> I wonder where you got this expectation from. If the documentation gave
>>> you this expectation, please let me know.
>>>
>>> table() can compute frequencies from indices.
>>> --
>>> Edzer Pebesma
>>> Institute for Geoinformatics (ifgi), University of M?nster
>>> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
>>> 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
>>> http://www.52north.org/geostatistics      e.pebesma at wwu.de
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>
> -- 
> Edzer Pebesma
> Institute for Geoinformatics (ifgi), University of M?nster
> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
> 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
> http://www.52north.org/geostatistics      e.pebesma at wwu.de
>

From marcelino.delacruz at upm.es  Thu Nov 24 23:29:17 2011
From: marcelino.delacruz at upm.es (marcelino.delacruz at upm.es)
Date: Thu, 24 Nov 2011 23:29:17 +0100
Subject: [R-sig-Geo] DEM interpolation with Delaunay triangulation
In-Reply-To: <4ECE5F11.5050302@uni-muenster.de>
Message-ID: <tNKWtZ1H.1322173757.6624440.marcelino.delacruz@upm.es>

Thank you for your suggestions Edzer.

I have rewritten the function (that now fits a linear trend on x and y),
and have reconsidered a more appropriate name.
I include a more ilustrative example with the Meuse data.

Cheers,

Marcelino


maybetin <- function(X, nx, ny, x=NULL, y=NULL, na.v=0){
     require(spatstat)
     lltes<-delaunay(X)

       if(is.null(x)){
            gri <-  gridcentres(X$window, nx=nx, ny=ny)
            gri.ppp <- ppp(gri$x,gri$y, window=X$window,
                                 marks=rep(na.v,length(gri$x)))
	}
	if(!is.null(x)){
	    gri.ppp<- ppp(x=x, y=y, window=X$window,
	                         marks=rep(na.v, length(x)))
        }

       cat("\n","number of triangles =",
length(lltes[[3]]),"\n\n")
      for(i in 1:length(lltes[[3]])){
            progressreport(i, length(lltes[[3]]))

             #grid points within the triangulation
            xoyo <- unmark(gri.ppp[lltes[[3]][[i]]])

            # original points defining the triangle
            xyz <- X[lltes[[3]][[i]]]
              # z values of the three points
              z<-xyz$marks
              mtrend <-with(xyz, lm(marks~x+y))

              grim <- predict(mtrend,
	             newdata=data.frame(x = xoyo$x, y=xoyo$y))

            #assign interpolated values
              gri.ppp[lltes[[3]][[i]]]$marks <- grim
       }
  return(gri.ppp)
}



# A very brute force TIN (maybe) of the log(zinc) data of meuse

require(gstat)
loadMeuse()
require(spatstat)
spatstat.options(gpclib=TRUE)

#data pre-processing
  library(maptools) # for the "as" method
  meuse.ppp <- as(meuse,"ppp")
  meusegrid.ppp <- as(meuse.grid,"ppp")

  #readjust the window for not missing points of meusegrid
   meuse.ppp$window <- meusegrid.ppp$window

  # use only log(zinc) as mark
      meuse.ppp$marks <-log( meuse at data$zinc)

#compute (maybe) TIN
  xgrid <-maybetin(meuse.ppp,x=meusegrid.ppp$x,y=meusegrid.ppp$y)

#A very brute force kind of representation
   meuse.grid at data$tin<-xgrid$marks

   spplot(meuse.grid["tin"],col.regions=bpy.colors(),
          sp.layout=list("sp.points", meuse))

   meuse.grid at data$tine<-exp(xgrid$marks)
   spplot(meuse.grid["tine"],col.regions=bpy.colors(),
      sp.layout=list("sp.points", meuse))









Con fecha 24/11/2011, "Edzer Pebesma" <edzer.pebesma at uni-muenster.de>
escribi?:

>In that case, you might want to reconsider the name of this function, as
>TIN is something different from inverse distance weighted; if you are on
>an edge of the triangle, you need to get the straight line interpolation
>from the two z values on that edge, the third needs to get zero weight...
>
>On 11/24/2011 02:27 PM, marcelino.delacruz at upm.es wrote:
>> Hi all,
>> 
>> Thanks to Rolf's suggestion I have incorporated the arguments x and y to
>> let the user select the precise set of points where to interpolate.
>> 
>> I have also corrected the formula (now is a  inverse distance weighted
>> interpolation) and have incorporated also the "power parameter" p as
>> an argument.
>> 
>> Cheers,
>> 
>> MArcelino
>> 
>> 
>> 
>> 
>> 
>> 
>> tin <- function(X, nx, ny,x=NULL, y=NULL,p=1){
>>      require(spatstat)
>>      lltes<-delaunay(X)
>> 
>>        if(is.null(x)){
>>             gri <-  gridcentres(X$window, nx=nx, ny=ny)
>>             gri.ppp <- ppp(gri$x,gri$y, window=X$window,
>>                                  marks=rep(0,length(gri$x)))
>> 	}
>> 	if(!is.null(x)){
>> 	    gri.ppp<- ppp(x=x, y=y, window=X$window,
>> 	                         marks=rep(0, length(x)))
>>         }
>> 
>>        cat("\n","number of triangles =",
>> length(lltes[[3]]),"\n\n")
>>       for(i in 1:length(lltes[[3]])){
>>             progressreport(i, length(lltes[[3]]))
>> 
>>              #grid points within the triangulation
>>             xoyo <- unmark(gri.ppp[lltes[[3]][[i]]])
>> 
>>             # original points defining the triangle
>>             xyz <- X[lltes[[3]][[i]]]
>>               # z values of the three points
>>               z<-xyz$marks
>> 
>>             #distance from grid points to vertices
>>              cdis <- crossdist(xoyo,xyz)
>> 
>>              # inverse distance weighted interpolation within triangle
>>              grim <- apply(cdis, 1, function(f) sum((1/f^p)*z)/sum(1/f^p))
>> 
>>             #assign interpolated values
>>               gri.ppp[lltes[[3]][[i]]]$marks <- grim
>>        }
>>   return(gri.ppp)
>> }
>> 
>> 
>>>
>>> # See how does it work:
>>>
>>> data(longleaf)
>>> plot(longleaf)
>>>
>>> cosa <- tin(longleaf, nx=100, ny=100)
>>>
>>> cosa2 <- tin(longleaf, x=1:100, y=1:100)
>> 
>> 
>>> plot(cosa)
>> 
>>> plot(cosa2)
>> 
>> 
>>>
>>> image(x=1:100,y=1:100, z=t(matrix(cosa$marks, 100,100, byrow=T)))
>>>
>>>
>>>
>>> Cheers, Marcelino
>>>
>>>
>>>>> On 21/11/11 04:30, gianni lavaredo wrote:
>>>>>> Dear Researchers,
>>>>>>
>>>>>> I am looking a package o method to interpolate a point data.frame (x,y,z)
>>>>>> with Delaunay triangulation  (Trianguled interpoaltion network) and
>>>>>> create
>>>>>> a polygons data,frame o a raster. I know there are several fuction in
>>>>>> library RSAGA, spatstat (with "deldir"), library geometry.
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>-- 
>Edzer Pebesma
>Institute for Geoinformatics (ifgi), University of M?nster
>Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
>8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
>http://www.52north.org/geostatistics      e.pebesma at wwu.de
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From r.hijmans at gmail.com  Fri Nov 25 01:24:38 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 24 Nov 2011 16:24:38 -0800
Subject: [R-sig-Geo] Finding a way to select upper portion of cumulative
 probabilities in a map of probability estimates
In-Reply-To: <CD2F38948B6D7E4EBADDFB7273B2A690020118A4@sr-sas-exch1.prairie.int.ec.gc.ca>
References: <CANtt_hy-dmFnKxod7E0_=gRj0CbwtQK8vJgRNyqE9kp1c951yQ@mail.gmail.com>
	<CD2F38948B6D7E4EBADDFB7273B2A690020118A4@sr-sas-exch1.prairie.int.ec.gc.ca>
Message-ID: <CANtt_hyXobQ7nHzvF0-0PzvdSJs6W+UqjrBF_Cd_rzLhiJy4Fg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111124/ac114124/attachment.pl>

From pep.bioalerts at gmail.com  Fri Nov 25 14:03:50 2011
From: pep.bioalerts at gmail.com (PepET)
Date: Fri, 25 Nov 2011 05:03:50 -0800 (PST)
Subject: [R-sig-Geo] setting breaks in colorramps
Message-ID: <1322226230756-7031046.post@n2.nabble.com>

Dear subscribes,

I have been looking but could not find the exact answer for my question,
which may seem really from a newbie....

I have several rasters and I want to plot them using a color gradient / ramp
going from red to grey untill 0 and from grey to green from 0 onwards.

I have managed to create a ramp:

#piba is a raster

myramp<-colorRampPalette( c("red", "white","green"), space="rgb",
breaks=c(cellStats (piba,min),0,cellStats (piba,max)))

but the problem there is that I want negative cells to go from red to white
and positive cells from white to green. Using this ramp I do not enshure
that. I also used breaks option in the plot, but then the display is a
single color.

Any help? THANK YOU!

Pep






--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/setting-breaks-in-colorramps-tp7031046p7031046.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From tim.appelhans at gmail.com  Fri Nov 25 14:08:42 2011
From: tim.appelhans at gmail.com (Tim Appelhans)
Date: Fri, 25 Nov 2011 14:08:42 +0100
Subject: [R-sig-Geo] setting breaks in colorramps
In-Reply-To: <1322226230756-7031046.post@n2.nabble.com>
References: <1322226230756-7031046.post@n2.nabble.com>
Message-ID: <4ECF935A.8090400@gmail.com>

Dear Pep,
see
http://www.r-bloggers.com/define-intermediate-color-steps-for-colorramppalette/
Maybe that is what you're after.

Regards,
Tim

On 25/11/2011 14:03, PepET wrote:
> Dear subscribes,
>
> I have been looking but could not find the exact answer for my question,
> which may seem really from a newbie....
>
> I have several rasters and I want to plot them using a color gradient / ramp
> going from red to grey untill 0 and from grey to green from 0 onwards.
>
> I have managed to create a ramp:
>
> #piba is a raster
>
> myramp<-colorRampPalette( c("red", "white","green"), space="rgb",
> breaks=c(cellStats (piba,min),0,cellStats (piba,max)))
>
> but the problem there is that I want negative cells to go from red to white
> and positive cells from white to green. Using this ramp I do not enshure
> that. I also used breaks option in the plot, but then the display is a
> single color.
>
> Any help? THANK YOU!
>
> Pep
>
>
>
>
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/setting-breaks-in-colorramps-tp7031046p7031046.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
#####################################
Tim Appelhans
Department of Geography
Environmental Computer Sciences
Philipps Universit?t Marburg
Deutschhausstra?e 12
35032 Marburg (Paketpost: 35037 Marburg)
Germany

Tel +49 (0) 6421 28-25957


From pep.bioalerts at gmail.com  Fri Nov 25 14:35:57 2011
From: pep.bioalerts at gmail.com (PepET)
Date: Fri, 25 Nov 2011 05:35:57 -0800 (PST)
Subject: [R-sig-Geo] setting breaks in colorramps
In-Reply-To: <4ECF935A.8090400@gmail.com>
References: <1322226230756-7031046.post@n2.nabble.com>
	<4ECF935A.8090400@gmail.com>
Message-ID: <1322228157016-7031127.post@n2.nabble.com>

Hey Tim,

Thank you for you advice...it is indeed an interesting funciton, however, it
set the steps between colors, but does not allow to assign a certain color
with a certain value in your raster....or maybe I am just not
understanding... 

#This is a wrapper function for colorRampPalette. It allows for the
#definition of the number of intermediate colors between the main colors.
#Using this option one can stretch out colors that should predominate
#the palette spectrum. Additional arguments of colorRampPalette can also
#be added regarding the type and bias of the subsequent interpolation.

Thank you anyways!

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/setting-breaks-in-colorramps-tp7031046p7031127.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From javiernori at gmail.com  Fri Nov 25 15:45:46 2011
From: javiernori at gmail.com (Javier Nori)
Date: Fri, 25 Nov 2011 11:45:46 -0300
Subject: [R-sig-Geo] Problem to generate an object of class
	SpatialPixelDataFrame
Message-ID: <CAKogw4wWJLB_ay8O0xus5n68brdJn5vgGHrJMsmn2Lab_gbszQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111125/f75638a2/attachment.pl>

From tom.gottfried at tum.de  Fri Nov 25 15:49:45 2011
From: tom.gottfried at tum.de (Tom Gottfried)
Date: Fri, 25 Nov 2011 15:49:45 +0100
Subject: [R-sig-Geo] Problem to generate an object of
	class	SpatialPixelDataFrame
In-Reply-To: <CAKogw4wWJLB_ay8O0xus5n68brdJn5vgGHrJMsmn2Lab_gbszQ@mail.gmail.com>
References: <CAKogw4wWJLB_ay8O0xus5n68brdJn5vgGHrJMsmn2Lab_gbszQ@mail.gmail.com>
Message-ID: <4ECFAB09.50905@tum.de>

Sounds as if you should have a look at the docs of package rgdal.

Tom

Am 25.11.2011 15:45, schrieb Javier Nori:
> Dear All!
> I am a beginner in the use of R, I am having problems in creating an object
> of class SpatialPixelsDataFrame (as the object puech$maps from adehabitatMA
> package) with the climatic variables of South America (rasters asc or bil).
> I need this "format" to implement some analisys of the adehabitatHS and MA
> packages to my data!
>
> I would be very gratefull if you would help me.
>
> Thank you very much in advance!
>
> Javier.
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Technische Universit?t M?nchen
Department f?r Pflanzenwissenschaften
Lehrstuhl f?r Gr?nlandlehre
Alte Akademie 12
85350 Freising / Germany
Phone: ++49 (0)8161 715324
Fax:   ++49 (0)8161 713243
email: tom.gottfried at wzw.tum.de
http://www.wzw.tum.de/gruenland


From tsaubusse at gmail.com  Fri Nov 25 16:27:19 2011
From: tsaubusse at gmail.com (thibault saubusse)
Date: Fri, 25 Nov 2011 16:27:19 +0100
Subject: [R-sig-Geo] Kinhom edge corrections factor
Message-ID: <CAO53jettEbRkXw6P=pbi9Li4iN5zqBHKdyVv7qHKfD4wFhwzZA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111125/168390e1/attachment.pl>

From melita at cirus.dhz.hr  Fri Nov 25 16:52:57 2011
From: melita at cirus.dhz.hr (Melita Percec Tadic)
Date: Fri, 25 Nov 2011 16:52:57 +0100
Subject: [R-sig-Geo] rsaga, radiation, rsaga.pisr
Message-ID: <6.2.1.2.2.20111125163122.081c4ac0@cirus.dhz.hr>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111125/2faacf51/attachment.html>

From b.rowlingson at lancaster.ac.uk  Fri Nov 25 18:47:23 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Fri, 25 Nov 2011 17:47:23 +0000
Subject: [R-sig-Geo] setting breaks in colorramps
In-Reply-To: <1322228157016-7031127.post@n2.nabble.com>
References: <1322226230756-7031046.post@n2.nabble.com>
	<4ECF935A.8090400@gmail.com>
	<1322228157016-7031127.post@n2.nabble.com>
Message-ID: <CANVKczNBf6cuZkPYWgG=5iJAJP-8XFDw6twaym5Ox2tyCT+hRg@mail.gmail.com>

On Fri, Nov 25, 2011 at 1:35 PM, PepET <pep.bioalerts at gmail.com> wrote:
> Hey Tim,
>
> Thank you for you advice...it is indeed an interesting funciton, however, it
> set the steps between colors, but does not allow to assign a certain color
> with a certain value in your raster....or maybe I am just not
> understanding...

 Its a common problem in R - the standard way of colouring things
isn't a mapping of values to colours, but a mapping of values to
indexes in a palette. Getting that palette index to be the right
colour is tricky.

 I had a go at making something that would help with my colourschemes
package (on R-forge) which lets you define function closures that map
values to colours given some scheme. So for example you can do:

tramp = multiRamp(rbind(c(-2000,0),c(0,1000),c(1000,9000)),
+       list(c("black","blue"),c("green","brown"),c("gray70","gray70"))
+       )

Then that gives you 'tramp' - a function that will map any value to
the colour in the ramps specified. So:

> tramp(-2000)
[1] "#000000FF"  # black
> tramp(500)
[1] "#539515FF"  # between green and brown

And then if you are doing several plots with different vectors and
want to make sure they use the sample colour scheme, you do:

plot(x1,y1, col = tramp(v1))

plot(x2,y2, col=tramp(v2))

- wherever v1 or v2 is 500 the point will be the same greeny-brown
colour. Guaranteed.

BUT there's not an easy way to hook this kind of behaviour into image
and raster plots... The kludge I've used to image an n*m matrix, V,
say, is to create a matrix of integers 1:(n*m) called IV, and then a
vector of colours tramp(V) (which will be length n*m). Then do
image(IV,col=IV). A bit wasteful but gets the job done. More info in
the vignette for colourschemes.

Barry


From jgrn at illinois.edu  Sun Nov 27 22:07:21 2011
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Sun, 27 Nov 2011 13:07:21 -0800
Subject: [R-sig-Geo] Modifying the coordinates of a Spatial* object
Message-ID: <CABG0rftxKQyKGuBes8+FZkD4cTM2QUJAou0v5_dS-CJz_S=W=A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111127/fe7aa7a6/attachment.pl>

From edzer.pebesma at uni-muenster.de  Sun Nov 27 22:46:03 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sun, 27 Nov 2011 22:46:03 +0100
Subject: [R-sig-Geo] Modifying the coordinates of a Spatial* object
In-Reply-To: <CABG0rftxKQyKGuBes8+FZkD4cTM2QUJAou0v5_dS-CJz_S=W=A@mail.gmail.com>
References: <CABG0rftxKQyKGuBes8+FZkD4cTM2QUJAou0v5_dS-CJz_S=W=A@mail.gmail.com>
Message-ID: <4ED2AF9B.60002@uni-muenster.de>

You can't replace them, indeed. But you can do:

Spatial = as(Spatial, "data.frame")
coordinates(Spatial) = ~ newx + newy

On 11/27/2011 10:07 PM, Jonathan Greenberg wrote:
> R-sig-geo'ers:
> 
> I assume this is probably something really obvious I'm missing, but how do
> I replace existing coordinates of a Spatial* object with new ones?
>  coordinates(myspatial) = ~newx+newy is giving me an error like:
> 
>> class(Spatial)
> 
> [1] "SpatialPointsDataFrame"
> 
> attr(,"package")
> 
> [1] "sp"
> 
>> coordinates(Spatial)=~(mean(new_bbox[1,]))+(mean(new_bbox[2,]))
> 
> Error in `coordinates<-`(`*tmp*`, value = ~(mean(new_bbox[1, ])) +
> (mean(new_bbox[2,  :
> 
>   setting coordinates cannot be done on Spatial objects, where they have
> already been set
> 
> 
> --j
> 
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From alberto.gc8 at gmail.com  Sun Nov 27 23:04:47 2011
From: alberto.gc8 at gmail.com (Alberto Gallano)
Date: Sun, 27 Nov 2011 17:04:47 -0500
Subject: [R-sig-Geo] Create distance 'neighborhood' (zone of
 indifference) when clustering binary data
In-Reply-To: <alpine.LRH.2.00.1111231843410.23067@reclus.nhh.no>
References: <CAO+b4j9oRxiYHt8zQq+CKw-JuVmmON3Rz0hoqAA93kMn05Eywg@mail.gmail.com>
	<alpine.LRH.2.00.1111210925140.12797@reclus.nhh.no>
	<CAO+b4j88hSDcxmwjpZnchpFwpOjmgJ+QFktySdzYkQJUuXVd0g@mail.gmail.com>
	<alpine.LRH.2.00.1111231814300.23067@reclus.nhh.no>
	<alpine.LRH.2.00.1111231843410.23067@reclus.nhh.no>
Message-ID: <CAO+b4j9rCUHNREJX_EbP=t8LSc5Lc72naFKsjFyHj8D_D0Za9w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111127/48fef7a9/attachment.pl>

From rhunne at mac.com  Mon Nov 28 05:30:33 2011
From: rhunne at mac.com (Robin W Hunnewell)
Date: Mon, 28 Nov 2011 04:30:33 +0000 (GMT)
Subject: [R-sig-Geo] Marked PPA, 'rlabel' function in spatstat
Message-ID: <6d6e57f3-3239-cc69-883c-9f7d16498b26@me.com>

Dear all,

I'd like to evaluate a null hypo of 'conditional independence' on a marked point pattern dataset. In scenario of?random labelling: given the point locations, marks attached to points are conditionally independent and identically distributed. Marks?can be randomly reshuffled among the full set of available points making up the overall pattern.?

To test this, I want to use the 'rlabel' function in spatstat -- which performs a resampling operation, allowing you to?hold the point locations fixed and shuffle the marks, e.g., by?randomly permuting them among all points in the pattern.?

In 'Analyzing Spatial Pt Patterns in R' (2010) there's an example of how to set up a test statistic for this, but for the life of me can't seem to reproduce it.?

The ASPP in R example suggests a nice way to do it by evaluating the difference btw 'JDot' and 'Jest' as follows;
# cook up a little function to evaluate Ji?(r) ? J(r):

> Jdif <- function(X, ..., i) {
+ Jidot <- Jdot(X, ..., i = i)?
+ J <- Jest(X, ...)?
+ dif <- eval.fv(Jidot - J) return(dif)
+}

> E <- envelope(amacrine, Jdif, nsim = 39, i = "on", simulate = expression(rlabel(amacrine)))


I tried to modify this to 'Kdot' and 'Kest' for my own multitype point pattern and run the test using 'envelope' as above,

> kdid <- function(X,..., i) {+ Kidot <- Kdot(X,..., i=i) + K <- Kest(X,...) + dif <- eval.fv(Kidot-K) + return(dif)}

# but when I do 'envelope',
> E <- envelope(B10size, kdid, nsim=39, i="mega", simulate = expression(rlabel(B10size)))

# get following error,
Error in get(x, envir = ee) : object 'Kidot' not found


Have I just goofed the syntax and missed something basic about how to functions??
Thanks if anyone can help out as to where I'm going wrong?

Robin

------------------------------------------
Robin Hunnewell
University of New Brunswick
Fredericton, NB  
Canada 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111128/c2ed5e68/attachment.html>

From Roger.Bivand at nhh.no  Mon Nov 28 06:19:49 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 28 Nov 2011 06:19:49 +0100 (CET)
Subject: [R-sig-Geo] Create distance 'neighborhood' (zone of
 indifference) when clustering binary data
In-Reply-To: <CAO+b4j9rCUHNREJX_EbP=t8LSc5Lc72naFKsjFyHj8D_D0Za9w@mail.gmail.com>
References: <CAO+b4j9oRxiYHt8zQq+CKw-JuVmmON3Rz0hoqAA93kMn05Eywg@mail.gmail.com>
	<alpine.LRH.2.00.1111210925140.12797@reclus.nhh.no>
	<CAO+b4j88hSDcxmwjpZnchpFwpOjmgJ+QFktySdzYkQJUuXVd0g@mail.gmail.com>
	<alpine.LRH.2.00.1111231814300.23067@reclus.nhh.no>
	<alpine.LRH.2.00.1111231843410.23067@reclus.nhh.no>
	<CAO+b4j9rCUHNREJX_EbP=t8LSc5Lc72naFKsjFyHj8D_D0Za9w@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1111280615460.8982@reclus.nhh.no>

On Sun, 27 Nov 2011, Alberto Gallano wrote:

> Hi Roger,
>
> thanks so much for your suggestion. I am running the code on a large
> dataset and have been reading up on "sparse matrices", however, I haven't
> come across anything in the R or GIS literature that explains in simple
> terms how "going out to a sparse matrix with both, then back again" is
> achieving the goals I set.

Please do read the code. There is an aggregate method for nb objects in 
spdep, but no aggregate method for listw objects. Consequently, to 
aggregate them, I converted each to a sparse matrix format, added, and 
then converted back to listw format. My mistake was to think that trimming 
the >100m neighbours back to 0 would work - it didn't always do so. Again, 
read the code very carefully, this isn't about words, it's about the 
representation of objects in code.

>
> Could you please point me to a reference that has employed a similar
> approach, or perhaps explain yourself how doing this creates a region
> outside of the 'core' neighborhood in which points gradually have less
> influence with distance? Thanks.
>

No, no idea, your problem.

Roger

> Alberto
>
>
> On Wed, Nov 23, 2011 at 12:55 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> On Wed, 23 Nov 2011, Roger Bivand wrote:
>>
>>  On Wed, 23 Nov 2011, Alberto Gallano wrote:
>>>
>>>  Hi Roger,
>>>>
>>>> thanks for your reply. The data I posted is only a subset of my real
>>>> data,
>>>> in which there are some points less than 100 meters apart.
>>>>
>>>> To clarify what I want:
>>>>
>>>> 1) I would like to create neighbourhoods of 100 meters within which all
>>>> points are neighbors. I think my code will do that with the real dataset
>>>> if
>>>> I set the upper bounds of dnearneigh to 100.
>>>>
>>>> 2) I want points outside of this 100 meter neighborhood to still be
>>>> neighbors, *but* with decreasing weight by distance. I believe this is
>>>> referred to as inverse distance weighting. I may want to accentuate this
>>>> by
>>>> using squared inverse distance weighting.
>>>>
>>>> The question is how can I accomplish task 2? Here is my attempt:
>>>>
>>>
>>> Try going out to a sparse matrix with both, then back again:
>>>
>>> library(spdep)
>>> set.seed(1)
>>> coords <- matrix(runif(1000, 0, 2000), ncol=2)
>>> nb1 <- dnearneigh(coords, 0, 100)
>>> nb1
>>> k1 <- knn2nb(knearneigh(coords, k=1))
>>> maxD <- max(unlist(nbdists(k1, coords)))
>>> nb2 <- dnearneigh(coords, 100, maxD)
>>> set.ZeroPolicyOption(TRUE)
>>> lw1 <- nb2listw(nb1, style="B")
>>> mat1 <- as(as_dgRMatrix_listw(lw1), "CsparseMatrix")
>>> dnb2 <- nbdists(nb2, coords)
>>> idw2 <- lapply(dnb2, function(x) 1/(x-100))
>>> # to avoid an abrupt drop, I suggest subracting 100m
>>>
>>
>> This wasn't a good idea, as points with (x-100) < 1 end up with weights >
>> 1. It would need trapping to reduce them to 1:
>>
>> idw2 <- lapply(dnb2, function(x) {x100 <- x-100; x100 <- ifelse (x100 < 1,
>> 1, x100); 1/x100})
>>
>> Roger
>>
>>
>>  all(unlist(sapply(idw2, function(x) is.finite(x))))
>>> lw2 <- nb2listw(nb2, glist=idw2, style="B")
>>> mat2 <- as(as_dgRMatrix_listw(lw2), "CsparseMatrix")
>>> mat12 <- mat1 + mat2
>>> image(mat1)
>>> image(mat2)
>>> image(mat12)
>>> summary(rowSums(mat12))
>>> summary(colSums(mat12))
>>> lw12 <- mat2listw(mat12, style="B")
>>> lw12
>>> table(card(lw12$neighbours))
>>>
>>> Hope this helps,
>>>
>>> Roger
>>>
>>>
>>>> coords <- cbind(dat$x, dat$y)
>>>> k1 <- knn2nb(knearneigh(coords))
>>>> maxD <- max(unlist(nbdists(k1, coords)))
>>>> datnb <- dnearneigh(coords, 0, maxD)
>>>>
>>>> # general weights - inverse distance squared
>>>> dlist <- nbdists(datnb, coords)
>>>> idlist <- lapply(dlist, function(x) (1/x)^2)
>>>>
>>>> datlistw.id2 <- nb2listw(datnb, glist=idlist, style="B",
>>>> zero.policy=TRUE)
>>>>
>>>> joincount.test(as.factor(dat$**present), datlistw.id2, zero.policy=TRUE,
>>>>  alternative="greater", spChk=NULL, adjust.n=TRUE)
>>>>
>>>>
>>>> Does this make sense? It seems so to me. (There is a warning given, but I
>>>> think that is because my example has so few points).
>>>>
>>>> thank you,
>>>>
>>>> Alberto
>>>>
>>>>
>>>>
>>>> On Mon, Nov 21, 2011 at 3:29 AM, Roger Bivand <Roger.Bivand at nhh.no>
>>>> wrote:
>>>>
>>>>  On Sun, 20 Nov 2011, Alberto Gallano wrote:
>>>>>
>>>>>  Hi, i'm trying to do join count analysis on binary data, but i'd like
>>>>> to
>>>>>
>>>>>> create neighborhood's of 'indifference' of 100 meters around each
>>>>>> spacial
>>>>>> point.
>>>>>>
>>>>>> I've been using dnearneigh to create a neighbor list and knearneigh to
>>>>>> calculate the maximum of the nearest neighbor distances for the upper
>>>>>> bound
>>>>>> argument to dnearneigh (so that no observations become islands).
>>>>>>
>>>>>> My question is, how do I create neighborhoods based on distance?
>>>>>> Should I
>>>>>> just input a number into the upper bound argument of dnearneigh,
>>>>>> without
>>>>>> first using knearneigh? If so, what number would correspond to 100
>>>>>> meters
>>>>>> (Euclidean)? (btw, the coordinates are already projected).
>>>>>>
>>>>>>
>>>>> If you mean that you define neighbours as points j within 100m of point
>>>>> i,
>>>>> then:
>>>>>
>>>>> datnb <- dnearneigh(coords, 0, 100)
>>>>>
>>>>> will do this if your coordinates are measured in metres. This doesn't
>>>>> work
>>>>> for your example, because the closest points are almost 1200m apart, so
>>>>> no
>>>>> point has any neighbours for this definition. However, your mentioning
>>>>> neighborhoods of 'indifference' makes me uncertain that this is what you
>>>>> mean. Do you mean placing a buffer around each point before finding
>>>>> neighbours?
>>>>>
>>>>> Roger
>>>>>
>>>>>
>>>>>  Here is a small subsample of my data and analysis. Thanks,
>>>>>>
>>>>>> Alberto
>>>>>>
>>>>>>
>>>>>>
>>>>>> # ==========================
>>>>>> # data
>>>>>> dat <- structure(list(present = c(0L, 0L, 0L, 1L, 0L, 0L, 0L, 0L, 0L,
>>>>>> 0L, 0L, 0L, 1L, 0L, 0L, 0L, 1L, 1L, 0L, 1L), x = c(332940L, 316301L,
>>>>>> 312714L, 306008L, 312248L, 329276L, 329663L, 341535L, 314761L,
>>>>>> 332898L, 332957L, 328332L, 312462L, 330063L, 317808L, 336216L,
>>>>>> 333763L, 315049L, 333855L, 324406L), y = c(4305226L, 4303010L,
>>>>>> 4316685L, 4309006L, 4319255L, 4311208L, 4316837L, 4306055L, 4301051L,
>>>>>> 4300625L, 4330342L, 4303420L, 4308292L, 4307181L, 4292904L, 4304336L,
>>>>>> 4313750L, 4297998L, 4314941L, 4315051L)), .Names = c("present",
>>>>>> "x", "y"), class = "data.frame", row.names = c(1L, 2L, 3L, 4L, 5L, 6L,
>>>>>> 7L, 8L, 9L, 10L, 11L, 12L, 13L, 14L, 15L, 16L, 17L, 18L, 19L, 20L))
>>>>>>
>>>>>>
>>>>>> library(spdep)
>>>>>> coords <- cbind(dat$x, dat$y)
>>>>>> k1 <- knn2nb(knearneigh(coords))
>>>>>> maxD <- max(unlist(nbdists(k1, coords))) # upper bound distance btw
>>>>>> neighbors
>>>>>> datnb <- dnearneigh(coords, 0, maxD)
>>>>>> summary(datnb)
>>>>>> print(is.symmetric.nb(datnb))
>>>>>>
>>>>>> datlistw <- nb2listw(datnb, glist=NULL, style="B", zero.policy=TRUE)
>>>>>>
>>>>>> # join count
>>>>>> joincount.test(as.factor(dat$****present), datlistw, zero.policy=TRUE,
>>>>>>  alternative="greater", spChk=NULL, adjust.n=TRUE)
>>>>>> # =========================
>>>>>>
>>>>>>       [[alternative HTML version deleted]]
>>>>>>
>>>>>> ______________________________****_________________
>>>>>> R-sig-Geo mailing list
>>>>>> R-sig-Geo at r-project.org
>>>>>> https://stat.ethz.ch/mailman/****listinfo/r-sig-geo<https://stat.ethz.ch/mailman/**listinfo/r-sig-geo>
>>>>>> <https://**stat.ethz.ch/mailman/listinfo/**r-sig-geo<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>>>>>>>
>>>>>>
>>>>>>
>>>>>>  --
>>>>> Roger Bivand
>>>>> Department of Economics, NHH Norwegian School of Economics,
>>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>>>> e-mail: Roger.Bivand at nhh.no
>>>>>
>>>>>
>>>>>
>>>>
>>>
>>>
>> --
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From r.turner at auckland.ac.nz  Mon Nov 28 09:16:52 2011
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Mon, 28 Nov 2011 21:16:52 +1300
Subject: [R-sig-Geo] Marked PPA, 'rlabel' function in spatstat
In-Reply-To: <6d6e57f3-3239-cc69-883c-9f7d16498b26@me.com>
References: <6d6e57f3-3239-cc69-883c-9f7d16498b26@me.com>
Message-ID: <4ED34374.5090301@auckland.ac.nz>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111128/e86b513d/attachment.pl>

From marcelino.delacruz at upm.es  Mon Nov 28 09:26:47 2011
From: marcelino.delacruz at upm.es (Marcelino de la Cruz)
Date: Mon, 28 Nov 2011 09:26:47 +0100
Subject: [R-sig-Geo] Marked PPA, 'rlabel' function in spatstat
In-Reply-To: <6d6e57f3-3239-cc69-883c-9f7d16498b26@me.com>
References: <6d6e57f3-3239-cc69-883c-9f7d16498b26@me.com>
Message-ID: <201111280826.pAS8QaUQ031708@smtp.upm.es>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111128/b183d671/attachment.pl>

From pinaud at cebc.cnrs.fr  Mon Nov 28 10:17:24 2011
From: pinaud at cebc.cnrs.fr (Pinaud David)
Date: Mon, 28 Nov 2011 10:17:24 +0100
Subject: [R-sig-Geo] Behaviour of pixellate.psp() when
	spatstat.options(checksegments=F)
Message-ID: <4ED351A4.6070902@cebc.cnrs.fr>

Dear all,
I want to convert a line segment (trajectory of an animal) to a pixel 
image (a study area), using pixellate.psp() in spatstat package.
For some reasons, some animals moved outside the study area, so I set 
spatstat.options(checksegments=F).
It seems that pixellate.psp() adds values in cells that are not visited 
by the animal, in the border of the grid (see the plot with given example)
I was thinking about alternative solutions (like calculation on a larger 
grid including all the spatial range of the trip), but we faced to 
memory (or running time) problems. We need to do that for >800 trips, on 
a 40000 cells grid... Another way would be to use clip.psp() firt, but I 
need to keep extra information about each segment (eg. ID, time).

Here a reproducible example:
library(spatstat)
spatstat.options(checksegments=F) # to allow segment outside the window
      # the sutdy area :
grida <- owin(c(-0.5, 10.5), c(3.5, 6.5), mask=matrix(TRUE, 
length(seq(3.5, 6.5, by=1)),length(seq(-0.5, 10.5, by=1))),  
xy=list(x=seq(-0.5, 10.5, by=1), y=seq(3.5, 6.5, by=1)))
     # the segment :
d <- psp(x0 = 1:9, x1 = 2:10, y0 = c(1, 1.5, 2, 4, 5, 5.5, 8, 8, 6), y1 
= c(1.5, 2, 4, 5, 5.5, 8, 8, 6, 10), window=grida)
     # segment length per cell
pixd <- pixellate.psp(d, W=grida)
     # plotting, some pixels with value>0 but without segment
plot.im(pixd)
plot(d, add=T)

  sessionInfo()
R version 2.13.1 (2011-07-08)
Platform: i386-pc-mingw32/i386 (32-bit)

locale:
[1] LC_COLLATE=French_France.1252  LC_CTYPE=French_France.1252
[3] LC_MONETARY=French_France.1252 LC_NUMERIC=C
[5] LC_TIME=French_France.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] trip_1.1-10     sp_0.9-88       spatstat_1.23-4 deldir_0.0-15
[5] mgcv_1.7-6

loaded via a namespace (and not attached):
[1] grid_2.13.1        lattice_0.19-30    Matrix_0.9996875-3 nlme_3.1-101
[5] tools_2.13.1

So, how to pixellate a psp object when some points fall outside the owin 
without using clip.psp?

Many thanks

David


-- 
***************************************************
Dr. David PINAUD
Ing?nieur de Recherche "Analyses spatiales"

Centre d'Etudes Biologiques de Chiz? - CNRS UPR1934
79360 Villiers-en-Bois, France
poste 485
Tel: +33 (0)5.49.09.35.58
Fax: +33 (0)5.49.09.65.26
http://www.cebc.cnrs.fr/

***************************************************




__________ Information from ESET Mail Security, version of virus signature database 6664 (20111127) __________

The message was checked by ESET Mail Security.
http://www.eset.com

-------------- next part --------------
A non-text attachment was scrubbed...
Name: pinaud.vcf
Type: text/x-vcard
Size: 324 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111128/1fb4d616/attachment.vcf>

From mdsumner at gmail.com  Mon Nov 28 10:57:26 2011
From: mdsumner at gmail.com (Michael Sumner)
Date: Mon, 28 Nov 2011 20:57:26 +1100
Subject: [R-sig-Geo] Behaviour of pixellate.psp() when
	spatstat.options(checksegments=F)
In-Reply-To: <4ED351A4.6070902@cebc.cnrs.fr>
References: <4ED351A4.6070902@cebc.cnrs.fr>
Message-ID: <CAAcGz9_cMKOcgHQX=fYQghLvdPS_KKY9FfhfqJtbL2jQ6XvU_g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111128/4f14710c/attachment.pl>

From brenning at uwaterloo.ca  Mon Nov 28 19:48:02 2011
From: brenning at uwaterloo.ca (Alexander Brenning)
Date: Mon, 28 Nov 2011 13:48:02 -0500
Subject: [R-sig-Geo] rsaga, radiation, rsaga.pisr
In-Reply-To: <mailman.9.1322305203.4004.r-sig-geo@r-project.org>
References: <mailman.9.1322305203.4004.r-sig-geo@r-project.org>
Message-ID: <4ED3D762.5040508@uwaterloo.ca>

Dear Melita,

I will try to answer your questions, but you will likely get better 
feedback from the SAGA pros if you post them to the SAGA user forum on 
sourceforge, see
http://sourceforge.net/projects/saga-gis/support

> Dear saga and rsaga users and developers (Olaf, Alex, Victor..)<br><br>
> I ran a small piece of  code, testing the rsaga.pisr function for
> calculation of potential solar radiation.<br><br>
> <ul>
> <li>Question is: if I calculate the rsaga.pisr for April 1th till April
> 4th, day by day, sum those and compare it with the rsaga.pisr calculated
> for the range of days April 1-4th, there is an unexpected difference
> ranging from (4.821417, 6.996113)kWh/m2. Can you help me to fix or
> explain this?

Solar radiation was likely only calculated until April 3rd. I haven't 
tried this out with rsaga.pisr, but some time ago in an earlier version 
I found this in rsaga.solar.radiation, i.e. a different SAGA modules 
that takes similar arguments:

> In SAGA 2.0.2, solar radiation sums calculated for a range of days, say days=c(a,b) actually calculate radiation only for days a,...,b-1 (in steps of day.step - I used day.step=1 in this example). The setting a=b however gives the same result as b=a+1, and indeed b=a+2 gives twice the radiation sums and potential sunshine duration that a=b and b=a+1 both give.

This might explain your problem, but if you want to be sure you'd better 
examine this in more detail by looking at different time spans, 
especially one versus two days (does radiation increase by a factor of 2?)

> <li>Second question is a technical one: when the R script calls
> rsaga.pisr I can not have the SAGA gui opened since it crashes down. Is
> that expected?

no it isn't, and I haven't experienced this problem with SAGA 2.0.7 on 
Windows.

> <li>Considering the latitude=user defined, why do we need it since the
> latitude grid is defined?

not all the arguments are mandatory. you would specify either latitude 
or in.latitude.grid

> <li>And finally, there is a comment concerning the units in the
> rsaga.pisr when you chose kJ/m2. If I'm not mistaken, the resulting grid
> is actually in MJ/m2.

sorry I cannot confirm this, but it should be possible to determine that 
by comparing average hourly PISR with the solar constant times 1 hour, 
which will be higher but of the same order of magnitude as PISR if in 
the same units. If that doesn't help, please follow up in the SAGA GIS 
forums to find out if that's an error and issue a bug report if necessary.

I hope this helps
   Alex


> </ul>The R script and input grids are provided in
> <a href="http://radar.dhz.hr/~melita" eudora="autourl">
> http://radar.dhz.hr/~melita<br><br>
> <br>
> </a>Thank you for the help and a nice tools that we can all use and
> benefit from it.<br><br>
> Regards,<br><br>
> Melita Percec Tadic<br><br>



Date: Fri, 25 Nov 2011 16:52:57 +0100
From: Melita Percec Tadic <melita at cirus.dhz.hr>
To: r-sig-geo at r-project.org
Subject: [R-sig-Geo] rsaga, radiation, rsaga.pisr
Message-ID: <6.2.1.2.2.20111125163122.081c4ac0 at cirus.dhz.hr>
Content-Type: text/plain; charset="us-ascii"

An HTML attachment was scrubbed...
URL: 
<https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111125/2faacf51/attachment-0001.html>


-- 
Alexander Brenning
brenning at uwaterloo.ca - T +1-519-888-4567 ext 35783
Department of Geography and Environmental Management
University of Waterloo
200 University Ave. W - Waterloo, ON - Canada N2L 3G1
http://www.environment.uwaterloo.ca/geography/faculty/brenning/


From jjcabrera20 at yahoo.com.mx  Mon Nov 28 20:08:17 2011
From: jjcabrera20 at yahoo.com.mx (Jorge Cabrera)
Date: Mon, 28 Nov 2011 11:08:17 -0800 (PST)
Subject: [R-sig-Geo] Implementation of algorithms
Message-ID: <1322507297.7986.YahooMailNeo@web160619.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111128/456bce58/attachment.pl>

From ashton at msu.edu  Mon Nov 28 20:52:46 2011
From: ashton at msu.edu (Ashton Shortridge)
Date: Mon, 28 Nov 2011 14:52:46 -0500
Subject: [R-sig-Geo] Implementation of algorithms
In-Reply-To: <1322507297.7986.YahooMailNeo@web160619.mail.bf1.yahoo.com>
References: <1322507297.7986.YahooMailNeo@web160619.mail.bf1.yahoo.com>
Message-ID: <201111281452.46994.ashton@msu.edu>

Dear Jorge,

there are a lot of ways to do this. In straight R, here's a function designed 
to work on a matrix of elevation values that I have used for many years. It is 
very similar to the code you provide:

# This function calculates slope for a matrix using the Horn (1981) 
# method, as reported by Burrough & McDonnell (1998). Slope is not 
# calculated for the outermost rows and columns of the input matrix. 
# Parameters: z is an input matrix of elevations, and spacing is 
# the distance in ground units between cell centers.
# Returns a matrix of slope, in percent. 
#        written by Ashton Shortridge, 3-30-2001, 3/2004, 3/2008, 11/2009
# References:
# Burrough, P. A., McDonnell, R. A. (1998) Principles of GIS. Oxford Press: 
Oxford. 
# Horn, B. K. P. (1981) Hill shading and the reflectance map. Proc. IEEE 69(1): 
14-47.

calc.slope <- function (z, spacing)
{
   # Takes a matrix z of elevations. Returns a matrix of slope, in percent.
   rows <- dim(z)[1] - 2
   cols <- dim(z)[2] - 2
   slope.mat <- matrix(nrow=rows+2, ncol=cols+2)
   for(i in 2:rows) {
      for(j in 2:cols) {
         dzdx <- (z[i+1,j+1] + 2*z[i+1,j] + z[i+1,j-1]) - (z[i-1,j+1] + 
2*z[i-1,j] + z[i-1,j-1])
         dzdy <- (z[i+1,j+1] + 2*z[i,j+1] + z[i-1,j+1]) - (z[i+1,j-1] + 
2*z[i,j-1] + z[i-1,j-1])
         dzdx <- dzdx/(8*spacing)
         dzdy <- dzdy/(8*spacing)
         slope.mat[i,j] <- sqrt(dzdx^2 + dzdy^2) * 100
      }
   }
   return(slope.mat)
}



On 11/28/11, Jorge Cabrera, wrote:
> Hello everyone in the forum
> For introducing myself I would say I have a basic knowledge of R.
> Now I am intended to implement a flood algorithm using R. I have some
> MatLab experience doing these, and as an example to explain more or less
> what I want, I have a m code to calculate the slope from a Digital
> elevation model:
> 
> 
> slope=zeros(row,col);
> for i=2:row-1
>     for j=2:col-1
>        dzdx=(raster(i,j+1)-raster(i,j-1))/(2*res);
>        dzdy=(raster(i+1,j)-raster(i-1,j))/(2*res);
>        slope(i,j)=sqrt(dzdx^2+dzdy^2);
>     end
> end;
> 
> The question is to know how to do the similar procedure on R.
> All suggestions are welcome Thanks
> 
> All best,
> 
> Jorge
> PD:I am using R on windows system 64 bits
> 
> 	[[alternative HTML version deleted]]


-----
Ashton Shortridge
Associate Professor			ashton at msu.edu
Dept of Geography			http://www.msu.edu/~ashton
235 Geography Building		ph (517) 432-3561
Michigan State University		fx (517) 432-1671


From jonathan at mazamascience.com  Mon Nov 28 21:20:31 2011
From: jonathan at mazamascience.com (Jonathan Callahan)
Date: Mon, 28 Nov 2011 12:20:31 -0800
Subject: [R-sig-Geo] spplot not using exact xlim and ylim boundaries
Message-ID: <CAPjNR=Rz_4FCv++=KV_N==X17ERWsqQe8WVJUzNm6+upK2jwbQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111128/d65bbd2c/attachment.pl>

From edzer.pebesma at uni-muenster.de  Mon Nov 28 21:52:09 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 28 Nov 2011 21:52:09 +0100
Subject: [R-sig-Geo] spplot not using exact xlim and ylim boundaries
In-Reply-To: <CAPjNR=Rz_4FCv++=KV_N==X17ERWsqQe8WVJUzNm6+upK2jwbQ@mail.gmail.com>
References: <CAPjNR=Rz_4FCv++=KV_N==X17ERWsqQe8WVJUzNm6+upK2jwbQ@mail.gmail.com>
Message-ID: <4ED3F479.60209@uni-muenster.de>

It seems that your question has nothing to do with spplot (which is a
method in package sp), as you are using plot(). If the problem is
similar to this:

> plot(1:10,xlim=c(0,11),ylim=c(0,11))
> par()$usr
[1] -0.44 11.44 -0.44 11.44

then it doesn't have to do anything with plotting map data, and r-help
might be the more suitable list to ask. The following might help:

> plot(1:10,xlim=c(0,11),ylim=c(0,11),xaxs="i", yaxs="i")
> par()$usr
[1]  0 11  0 11

Best regards,

On 11/28/2011 09:20 PM, Jonathan Callahan wrote:
> I am plotting spatial data on transparent backgrounds for overlay on top of
> a GoogleMaps interface but they aren't *exactly* right.
> 
> I have set the size of GoogleMaps and my image to 640X640 and I receive
> bounds information on the current region from the GoogleMaps javascript API.
> 
> The problem is that the image generated by spplot does not strictly adhere
> to the xlim and ylim parameters I am passing in.
> 
> As an example, here is some debugging of a plot of watershed basins
> 
>   print(paste("map_west = ",w,", map_east =",e,", map_south = ",s,",
> map_north = ",n))
>   xlim = c(w,e)
>   ylim = c(s,n)
>   plot(basin,xlim=xlim,ylim=ylim,border=col_basin,lwd=lwd_basin)
>   print(paste("usr_west = ",format(par()$usr[1],digits=7,nsmall=4),",
> usr_east =",format(par()$usr[2],digits=7,nsmall=4),
>               ", usr_south = ",format(par()$usr[3],digits=6,nsmall=4),",
> usr_north = ",format(par()$usr[4],digits=6,nsmall=4)))
> 
> And here is the resulting text output:
> 
> [1] "map_west =  -124.4348 , map_east = -123.6252 , map_south =  43.8856 ,
> map_north =  44.4652"
> [1] "usr_west =  -124.4672 , usr_east = -123.5928 , usr_south =  43.8618 ,
> usr_north =  44.4890"
> 
> 
> Things are close but not *exactly* right. Is there anything I can do to
> force spplot to stick to the boundaries I have passed in?
> 
> I am using R 2.13.1 and sp 0.9-85.
> 
> Thanks in advance.
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From jonathan at mazamascience.com  Mon Nov 28 22:39:54 2011
From: jonathan at mazamascience.com (Jonathan Callahan)
Date: Mon, 28 Nov 2011 13:39:54 -0800
Subject: [R-sig-Geo] spplot not using exact xlim and ylim boundaries
In-Reply-To: <4ED3F479.60209@uni-muenster.de>
References: <CAPjNR=Rz_4FCv++=KV_N==X17ERWsqQe8WVJUzNm6+upK2jwbQ@mail.gmail.com>
	<4ED3F479.60209@uni-muenster.de>
Message-ID: <CAPjNR=ROdZ-xSm0yr+sLwoDyLsstYZLg+H-TfP+h9AbfCHww6w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111128/96db059f/attachment.pl>

From chris at csfowler.com  Tue Nov 29 01:54:55 2011
From: chris at csfowler.com (Chris Fowler)
Date: Mon, 28 Nov 2011 16:54:55 -0800
Subject: [R-sig-Geo] Overlaying rasters in spplot
Message-ID: <CAFK3DV-tBPhzr+049R8w=bzmc5RojSCST4NXqKEXbU8=3gOSAg@mail.gmail.com>

I am still having trouble with some raster overlays.
My trouble now is a result of my not really understanding how layers
and sp.layout work in the spplot function

I go through a whole mess of steps to get two rasters of identical
extent and dimension (One is a google map tile, the other my own data)
Plotting them using the default plot() method within raster, however
doesn't allow me to have the color palette and breaks I want, so at
the suggestion of one of the threads on this list I have converted my
raster objects to SpatialGridDataFrame objects.

I can plot these objects and get exactly what I want using the following code:
  layer1<-spplot(raster1,"values",at=brks1,col.regions=pal1,colorkey=FALSE)
  layer1
  layer2<-spplot(raster2, "values", at=brks2,col.regions=pal2)
  layer2

from reading the documentation on spplot() from sp package I should be
able to use the sp.layout attribute to map the second of these layers
with a transparency of say .5, but I have not been able to get there.

I am hoping that this is enough of a syntax question that the experts
here can help without a full worked example--my apologies if this is
not the case.

Thanks in advance,

Chris

Christopher S. Fowler PhD.
206.920.1686
http://csfowler.com


From yiyiwang.ut at gmail.com  Tue Nov 29 02:01:11 2011
From: yiyiwang.ut at gmail.com (Aquarius)
Date: Mon, 28 Nov 2011 17:01:11 -0800 (PST)
Subject: [R-sig-Geo] Failure to call GeoBUGS's car.normal() function from R
Message-ID: <1322528471714-7041139.post@n2.nabble.com>

Dear Users,

I am trying to do a spatial Poisson-gamma model. I intend to read my data
into R & then call OpenBugs/GeoBUGS/WinBugs to implement the car.normal
function. 

Here is a copy for my codes:
# in R:
# do Poisson-gamma spatial models using CAR
# y= number of employments x=distance to cbd

library(spdep)
library(rjags)

#Read data
taz = read.csv("file path", header=TRUE)
y=taz[,9] # number of employment
distcbd=taz[,10] # dist2cbd

# compute adjacency matrix and adj, N, sumNumNeigh required by car.normal
function in GeoBUGS
shape <- readShapePoly("file path", IDvar="FID2")
shape_nb <- poly2nb(shape)

N= length(shape_nb)
num=sapply(shape_nb,length)
adj=unlist(shape_nb)
sumNumNeigh=length(unlist(shape_nb))


# create initial values
tau.b = 0.5
tau.h = 0.2
alpha=0
beta=0

# setup and compile the jags model. I used jags to call OpenBUGS from R.

# to do adaptation	for. Adaptation is a way to get better samples, you don't
# have to do this but it'll help speed convergence in some cases.
jags <- jags.model("model1.txt", 
	data=list("O"=y, "N"=N, "distcbd"=distcbd, "num"=num,
"adj"=adj,"sumNumNeigh"=sumNumNeigh),
  init=list("tau.b"=tau.b, "tau.h"=tau.h, "alpha"=alpha, "beta"=beta), 
	n.chains=1,
	n.adapt=0) 

# Burn-in. 
update(jags, 500)

# Draw samples and store them.
samples <- coda.samples(jags, c('alpha', 'beta'), 2000)  # only store alpha
& beta

#### this is how the model1.txt look like (so this is OpenBUGS codes)
model {
for (i in 1 : N) {
# Likelihood
O[i] ~ dpois(mu[i])
log(mu[i]) <- alpha + beta * distcbd[i] + b[i] + h[i]
RR[i] <- exp(alpha + beta * distcbd[i] + b[i] + h[i]) # Area-specific
relative risk (for maps)
# Exchangeable prior on unstructured random effects
h[i] ~ dnorm(0, tau.h)
}
# CAR prior distribution for spatial random effects:
b[1:N] ~ car.normal(adj[], weights[], num[], tau.b)
for(k in 1:sumNumNeigh) {
weights[k] <- 1
}
# Other priors:
alpha ~ dflat()
beta ~ dnorm(0.0, 1.0E-5)
tau.b ~ dgamma(0.5, 0.0005)
sigma.b <- sqrt(1 / tau.b)
tau.h ~ dgamma(0.5, 0.0005)
sigma.h <- sqrt(1 / tau.h)
}



However, I got an error message "RUNTIME ERROR:Compilation error on line
16.Unknown distribution: dflat
". When I changed the flat prior (dflat) into a uniform prior
(dunif(-1000,1000)). I got another error message "RUNTIME ERROR:Compilation
error on line 11.Unknown distribution: car.normal."

I've been banging my head against the wall trying to solve this mistery but
to no avail. Does anyone can help me out? I appreciate very much for your
time and expertise!

Another more salient point I've been confused about is which package should
I use to do such a spatial model? WinBUGS or OpenBUGS? It seems that GeoBUGS
is built in both of them & I installed both WInBUGS 14 (& then upgrade to
1.4.3) and OpenBUGS version 3.2.1 rev 781. My R is 2.13.2. Is there anything
in particular I should do with the WInBUGS or OpenBUGS, whichever one I
should use, when running my codes in R? I just opened WinBUGS/OpenBUGS when
running the codes in R....

Thanks so much!

All the best,
Yiyi

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Failure-to-call-GeoBUGS-s-car-normal-function-from-R-tp7041139p7041139.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From lyndon.estes at gmail.com  Tue Nov 29 04:22:32 2011
From: lyndon.estes at gmail.com (Lyndon Estes)
Date: Mon, 28 Nov 2011 22:22:32 -0500
Subject: [R-sig-Geo] Fwd: Re: Problem creating raster brick (Lyndon
	Estes)
In-Reply-To: <CANtt_hw+P69D6czZK58bKc2B5UBD_5on3KMeSthOj1H=XKEZbg@mail.gmail.com>
References: <4ECA3374.5070500@iggf.geo.uni-muenchen.de>
	<4ECA34F0.7030905@lmu.de>
	<CALuVVaYVe2zr5vpoVJQ=bqOD9smdDgKmtV9VKXdChB6VbDWd3A@mail.gmail.com>
	<CANtt_hw+P69D6czZK58bKc2B5UBD_5on3KMeSthOj1H=XKEZbg@mail.gmail.com>
Message-ID: <CALuVVaazELQnqaXFkePfQD4rP09DHTBkxEnA36jBtEy64XJnwQ@mail.gmail.com>

Hi Robert,

Thanks for the response.  I will continue to keep forcing a write to
disk to prevent this from occurring.

Based on this post, and another earlier in the year, I looked a bit
more into other methods for calculating available RAM, at least for
Linux and Mac systems.  I understand from some of the posts I have
seen that this is a fairly tricky subject, but something like the
following might give available memory (in mb) on a linux system:

system("free -t -m | awk 'FNR == 5 {print $4}'", intern = T)

On a mac, I believe the "alloc" command might do the trick, but for
some reason my system (10.5.8) doesn't have it so I couldn't test
that.  Another way might be to access the summary from top, e.g.

as.numeric(sub("M", "", system("top -l 1 | awk 'FNR == 6 {print
$10}'", intern = T)  # 40M))

But I am not at all sure that that particular number is the right one
to use as an indicator of available memory (looks very conservative).

Anyway, looking into the code for canProcessInMemory, I see that you
already have similar solutions worked in but commented out, so I guess
these solutions might not be desirable.


Cheers, and thanks again, Lyndon






On Wed, Nov 23, 2011 at 7:38 PM, Robert J. Hijmans <r.hijmans at gmail.com> wrote:
> Lyndon,
> The reason might be that the large rasters trigger raster to processing by
> chunk (writing to disk) whereas the smaller file is considered small enough
> for processing in RAM. That may not be the case, and the OS may start
> swapping memory (using disk as RAM) which is slow. If this happens, you can
> change the option? setOptions("maxmemory=a value")?, or to be on the very
> safe side use, as you indicated, todisk=TRUE.?I wish I knew if a better way
> to find out how much RAM is available on the different operating systems.
> Robert
>
>
> On Mon, Nov 21, 2011 at 8:40 AM, Lyndon Estes <lyndon.estes at gmail.com>
> wrote:
>>
>> Hi Swen,
>>
>> Thanks for the suggestion. That brings to mind an earlier problem I
>> had with a different functions substituting values on large rasters,
>> and I got around it by writing the following lines into the code:
>>
>> ?if(raster:::.toDisk() != TRUE) {
>> ? ? setOptions(todisk = TRUE)
>> ? ? cat("We don't want memory problems--forcing write to disk.\n")
>> ?}
>>
>> So I will see if that works in this case. ?However, I am still curious
>> why the problem is occurring with my particular grid files, but not
>> with the dummy rasters I made, which are in fact somewhat larger.
>> Also, the combined size of the 9 grids is < 30 mb, which was well
>> below my available memory (~about 500 mb free).
>>
>> In the meantime, I am continuing with stacks and checking whether a
>> forced write or lower memory limits will help.
>>
>> Thanks again,
>>
>> Lyndon
>>
>>
>>
>> On Mon, Nov 21, 2011 at 6:24 AM, Swen Meyer <s.meyer at lmu.de> wrote:
>> > Dear Lydon,
>> > I also had some trouble with stacking Layers in the ?Raster package. Try
>> > to
>> > use a 32 bit version of R. Sounds weired but in my case the stacking
>> > with
>> > the Raster package was much faster using the Raster Package on a 32 bit
>> > - R
>> > Version. This is what Robert Hijmans once wrote me when I had some
>> > trouble
>> > with the Raster Stacking:
>> > "
>> > Thanks that is very good to know. raster checks if the data can all be
>> > processed in memory, and if so, does that (up to a point), for better
>> > speed.
>> > There is a limit set by maxmemory. See
>> >
>> > showOptions()
>> >
>> > Perhaps setting maxmemory to a lower value
>> >
>> > e.g.,
>> >
>> > setOptions(maxmemory=1e+08)"
>> >
>> > Hope this will help you.
>> > Greetings,
>> > Swen
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at r-project.org
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


From jeanbaptiste.paroissien at gmail.com  Tue Nov 29 08:06:03 2011
From: jeanbaptiste.paroissien at gmail.com (Jean-Baptiste)
Date: Mon, 28 Nov 2011 23:06:03 -0800 (PST)
Subject: [R-sig-Geo] error with gmeta6()
Message-ID: <1322550363359-7041894.post@n2.nabble.com>

Hi listers,

I've started spgrass6() with no problems but then get an error with gmeta6()
:

error in system (syscmd, intern = intern, ignore.stderr = ignore.stderr,  : 
  argument(s) inutilis?(s) (ignore.stdout = Sys_ignore.stdout)

I'm using R  2.11.1 on ubuntu maverik and just made
install.packages("spgrass6")
I tried the solution proposed by Markus 
http://osgeo-org.1803224.n2.nabble.com/Fwd-Re-R-sig-Geo-Errror-with-gmeta6-td3610348.html
here  but without good results.

Any idea on how to fix this problem?
Thanks,

Jean-Baptiste

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/error-with-gmeta6-tp7041894p7041894.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From jeanbaptiste.paroissien at gmail.com  Tue Nov 29 08:47:24 2011
From: jeanbaptiste.paroissien at gmail.com (Jean-Baptiste)
Date: Mon, 28 Nov 2011 23:47:24 -0800 (PST)
Subject: [R-sig-Geo] error with gmeta6()
In-Reply-To: <1322550363359-7041894.post@n2.nabble.com>
References: <1322550363359-7041894.post@n2.nabble.com>
Message-ID: <1322552844821-7041964.post@n2.nabble.com>

Finally, a simple update of R (2.11.1 to 2.14.0) solve the problem

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/error-with-gmeta6-tp7041894p7041964.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From oscar.perpinan at upm.es  Tue Nov 29 09:34:14 2011
From: oscar.perpinan at upm.es (Oscar =?UTF-8?B?UGVycGnDsWFu?= Lamigueiro)
Date: Tue, 29 Nov 2011 09:34:14 +0100
Subject: [R-sig-Geo] Overlaying rasters in spplot
In-Reply-To: <CAFK3DV-tBPhzr+049R8w=bzmc5RojSCST4NXqKEXbU8=3gOSAg@mail.gmail.com>
References: <CAFK3DV-tBPhzr+049R8w=bzmc5RojSCST4NXqKEXbU8=3gOSAg@mail.gmail.com>
Message-ID: <20111129093414.69401bf5@OPL-EUITI>

Hello,

You could try the overlaying mechanism of latticeExtra with
alpha.regions as an argument for spplot:

library(latticeExtra)

layer1<-spplot(raster1,"values",
               at=brks1,col.regions=pal1,colorkey=FALSE)
layer2<-spplot(raster2, "values", at=brks2,col.regions=pal2,
               alpha.regions=0.5) 
layer1 + layer2

Best,

Oscar.
-------------------
Oscar Perpi??n Lamigueiro
Dpto. Ingenier?a El?ctrica
EUITI-UPM

http://procomun.wordpress.com

-----------------------------------------
>I am still having trouble with some raster overlays.
>My trouble now is a result of my not really understanding how layers
>and sp.layout work in the spplot function
>
>I go through a whole mess of steps to get two rasters of identical
>extent and dimension (One is a google map tile, the other my own data)
>Plotting them using the default plot() method within raster, however
>doesn't allow me to have the color palette and breaks I want, so at
>the suggestion of one of the threads on this list I have converted my
>raster objects to SpatialGridDataFrame objects.
>
>I can plot these objects and get exactly what I want using the
>following code:
>  layer1<-spplot(raster1,"values",at=brks1,col.regions=pal1,colorkey=FALSE)
>  layer1
>  layer2<-spplot(raster2, "values", at=brks2,col.regions=pal2)
>  layer2
>
>from reading the documentation on spplot() from sp package I should be
>able to use the sp.layout attribute to map the second of these layers
>with a transparency of say .5, but I have not been able to get there.
>
>I am hoping that this is enough of a syntax question that the experts
>here can help without a full worked example--my apologies if this is
>not the case.
>
>Thanks in advance,
>
>Chris
>
>Christopher S. Fowler PhD.
>206.920.1686
>http://csfowler.com


From edzer.pebesma at uni-muenster.de  Tue Nov 29 09:39:41 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 29 Nov 2011 09:39:41 +0100
Subject: [R-sig-Geo] Overlaying rasters in spplot
In-Reply-To: <CAFK3DV-tBPhzr+049R8w=bzmc5RojSCST4NXqKEXbU8=3gOSAg@mail.gmail.com>
References: <CAFK3DV-tBPhzr+049R8w=bzmc5RojSCST4NXqKEXbU8=3gOSAg@mail.gmail.com>
Message-ID: <4ED49A4D.3040708@uni-muenster.de>



On 11/29/2011 01:54 AM, Chris Fowler wrote:
> I am still having trouble with some raster overlays.
> My trouble now is a result of my not really understanding how layers
> and sp.layout work in the spplot function
> 
> I go through a whole mess of steps to get two rasters of identical
> extent and dimension (One is a google map tile, the other my own data)
> Plotting them using the default plot() method within raster, however
> doesn't allow me to have the color palette and breaks I want, so at
> the suggestion of one of the threads on this list I have converted my
> raster objects to SpatialGridDataFrame objects.
> 
> I can plot these objects and get exactly what I want using the following code:
>   layer1<-spplot(raster1,"values",at=brks1,col.regions=pal1,colorkey=FALSE)
>   layer1
>   layer2<-spplot(raster2, "values", at=brks2,col.regions=pal2)
>   layer2
> 
> from reading the documentation on spplot() from sp package I should be
> able to use the sp.layout attribute to map the second of these layers
> with a transparency of say .5, but I have not been able to get there.
> 

The spplot docomentation mentions which objects it can plot; objects of
type "trellis" (which layer1 and layer2 will be) are not among them.

> I am hoping that this is enough of a syntax question that the experts
> here can help without a full worked example--my apologies if this is
> not the case.
> 
> Thanks in advance,
> 
> Chris
> 
> Christopher S. Fowler PhD.
> 206.920.1686
> http://csfowler.com
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From luca.candeloro at gmail.com  Tue Nov 29 12:38:56 2011
From: luca.candeloro at gmail.com (luca candeloro)
Date: Tue, 29 Nov 2011 12:38:56 +0100
Subject: [R-sig-Geo] Colors in package plotGoogleMaps
Message-ID: <CAHF6YnmOwYCqt=i7XtGECW-EVAwt2B=BHQWeBWYg72nBLEzhrQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111129/fbe9306f/attachment.pl>

From nnagle at utk.edu  Tue Nov 29 13:52:29 2011
From: nnagle at utk.edu (Nagle, Nicholas)
Date: Tue, 29 Nov 2011 12:52:29 +0000
Subject: [R-sig-Geo] Overlaying rasters in spplot
In-Reply-To: <mailman.11.1322564404.6725.r-sig-geo@r-project.org>
References: <mailman.11.1322564404.6725.r-sig-geo@r-project.org>
Message-ID: <8DED50F3-C61D-48A1-AA09-64131ECE20B1@utk.edu>

Hi Chris -

I don't know how to do what you want with spplot, but I've done it with ggplot.  Overlays and colors are more intuitive to me in ggplot.  Maybe this will help?

I recently had to plot data from the NLCD.  It has a colortable in the metadata, and people are used to seeing the data with exactly those colors.  Here's how I did it in ggplot.

# This was a copy and past of the color table from the metadata.  I wrapped it in cat and saved it to a file.
cat("
      0     0.00000000000  0.00000000000  0.00000000000
      11    0.27843137255  0.41960784314  0.62745098039
      12    0.81960784314  0.86666666667  0.97647058824
      21    0.86666666667  0.78823529412  0.78823529412
      22    0.84705882353  0.57647058824  0.50980392157
      23    0.92941176471  0.00000000000  0.00000000000
      24    0.66666666667  0.00000000000  0.00000000000
      31    0.69803921569  0.67843137255  0.63921568628
      41    0.40784313726  0.66666666667  0.38823529412
      42    0.10980392157  0.38823529412  0.18823529412
      43    0.70980392157  0.78823529412  0.55686274510
      51    0.64705882353  0.54901960784  0.18823529412
      52    0.80000000000  0.72941176471  0.48627450980
      71    0.88627450980  0.88627450980  0.75686274510
      72    0.78823529412  0.78823529412  0.46666666667
      73    0.60000000000  0.75686274510  0.27843137255
      74    0.46666666667  0.67843137255  0.57647058824
      81    0.85882352941  0.84705882353  0.23921568628
      82    0.66666666667  0.43921568628  0.15686274510
      90    0.72941176471  0.84705882353  0.91764705882
      95    0.43921568628  0.63921568628  0.72941176471", file='Anderson.colors.tab')
color.table <- read.table('Anderson.colors.tab')
names(color.table) <- c('Value','R','G','B')
row.names(color.table) <- color.table$Value
colors <- hex(RGB(color.table$R,color.table$G,color.table$B))
colors <- data.frame(colors,row.names=row.names(color.table))

# In my case, grid3 was a SpatialPixelsDataFrame object
grid.gdf <- data.frame(cbind(coordinates(grid3),value=(grid3$value)))
grid.gdf$value <- factor(grid.gdf$value,levels=row.names(color.table))
gplt <- ggplot()+geom_tile(aes(x=x,y=y,fill=value),data=grid.gdf)+scale_fill_manual(values=colors$colors)+coord_equal()

 

It's easy to set the alpha transparency level in ggplot.  If you don't have categorical data like this, but continuous data, I usually still use ggplot, but I turn the continuous values into a categorical variable, and then assign colors using the RColorBrewer package.


Good Luck,
Nicholas

Department of Geography
University of Tennessee



Date: Mon, 28 Nov 2011 16:54:55 -0800
From: Chris Fowler <chris at csfowler.com>
To: r-sig-geo at r-project.org
Subject: [R-sig-Geo] Overlaying rasters in spplot
Message-ID:
	<CAFK3DV-tBPhzr+049R8w=bzmc5RojSCST4NXqKEXbU8=3gOSAg at mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1

I am still having trouble with some raster overlays.
My trouble now is a result of my not really understanding how layers
and sp.layout work in the spplot function

I go through a whole mess of steps to get two rasters of identical
extent and dimension (One is a google map tile, the other my own data)
Plotting them using the default plot() method within raster, however
doesn't allow me to have the color palette and breaks I want, so at
the suggestion of one of the threads on this list I have converted my
raster objects to SpatialGridDataFrame objects.

I can plot these objects and get exactly what I want using the following code:
 layer1<-spplot(raster1,"values",at=brks1,col.regions=pal1,colorkey=FALSE)
 layer1
 layer2<-spplot(raster2, "values", at=brks2,col.regions=pal2)
 layer2

from reading the documentation on spplot() from sp package I should be
able to use the sp.layout attribute to map the second of these layers
with a transparency of say .5, but I have not been able to get there.

I am hoping that this is enough of a syntax question that the experts
here can help without a full worked example--my apologies if this is
not the case.

Thanks in advance,

Chris

Christopher S. Fowler PhD.
206.920.1686
http://csfowler.com
On Nov 29, 2011, at 6:00 AM, <r-sig-geo-request at r-project.org>
 wrote:

> Date: Mon, 28 Nov 2011 16:54:55 -0800
> From: Chris Fowler <chris at csfowler.com>
> To: r-sig-geo at r-project.org
> Subject: [R-sig-Geo] Overlaying rasters in spplot
> Message-ID:
> 	<CAFK3DV-tBPhzr+049R8w=bzmc5RojSCST4NXqKEXbU8=3gOSAg at mail.gmail.com>
> Content-Type: text/plain; charset=ISO-8859-1
> 
> I am still having trouble with some raster overlays.
> My trouble now is a result of my not really understanding how layers
> and sp.layout work in the spplot function
> 
> I go through a whole mess of steps to get two rasters of identical
> extent and dimension (One is a google map tile, the other my own data)
> Plotting them using the default plot() method within raster, however
> doesn't allow me to have the color palette and breaks I want, so at
> the suggestion of one of the threads on this list I have converted my
> raster objects to SpatialGridDataFrame objects.
> 
> I can plot these objects and get exactly what I want using the following code:
>  layer1<-spplot(raster1,"values",at=brks1,col.regions=pal1,colorkey=FALSE)
>  layer1
>  layer2<-spplot(raster2, "values", at=brks2,col.regions=pal2)
>  layer2
> 
> from reading the documentation on spplot() from sp package I should be
> able to use the sp.layout attribute to map the second of these layers
> with a transparency of say .5, but I have not been able to get there.
> 
> I am hoping that this is enough of a syntax question that the experts
> here can help without a full worked example--my apologies if this is
> not the case.
> 
> Thanks in advance,
> 
> Chris
> 
> Christopher S. Fowler PhD.
> 206.920.1686
> http://csfowler.com


From melita at cirus.dhz.hr  Tue Nov 29 14:22:10 2011
From: melita at cirus.dhz.hr (Melita Percec Tadic)
Date: Tue, 29 Nov 2011 14:22:10 +0100
Subject: [R-sig-Geo] rsaga, radiation, rsaga.pisr
In-Reply-To: <4ED3D762.5040508@uwaterloo.ca>
References: <mailman.9.1322305203.4004.r-sig-geo@r-project.org>
	<4ED3D762.5040508@uwaterloo.ca>
Message-ID: <6.2.1.2.2.20111129084603.02e58670@cirus.dhz.hr>

Dear Alex,

thank you for the answers and suggestions. I checked what you suggested 
(the saga forum also) and the only thing left is how to avoid the latitude 
definition in case when in.latitude.grid is specified.


At 19:48 28.11.2011, Alexander Brenning wrote:
>Dear Melita,
>
>I will try to answer your questions, but you will likely get better 
>feedback from the SAGA pros if you post them to the SAGA user forum on 
>sourceforge, see
>http://sourceforge.net/projects/saga-gis/support
>
>>Dear saga and rsaga users and developers (Olaf, Alex, Victor..)<br><br>
>>I ran a small piece of  code, testing the rsaga.pisr function for
>>calculation of potential solar radiation.<br><br>
>><ul>
>><li>Question is: if I calculate the rsaga.pisr for April 1th till April
>>4th, day by day, sum those and compare it with the rsaga.pisr calculated
>>for the range of days April 1-4th, there is an unexpected difference
>>ranging from (4.821417, 6.996113)kWh/m2. Can you help me to fix or
>>explain this?
>
>Solar radiation was likely only calculated until April 3rd. I haven't 
>tried this out with rsaga.pisr, but some time ago in an earlier version I 
>found this in rsaga.solar.radiation, i.e. a different SAGA modules that 
>takes similar arguments:
>
>>In SAGA 2.0.2, solar radiation sums calculated for a range of days, say 
>>days=c(a,b) actually calculate radiation only for days a,...,b-1 (in 
>>steps of day.step - I used day.step=1 in this example). The setting a=b 
>>however gives the same result as b=a+1, and indeed b=a+2 gives twice the 
>>radiation sums and potential sunshine duration that a=b and b=a+1 both give.
>
>This might explain your problem, but if you want to be sure you'd better 
>examine this in more detail by looking at different time spans, especially 
>one versus two days (does radiation increase by a factor of 2?)

Thanks for the confirmation. That is what I also assumed.
But it seams it does not include the first but the last day of the range of 
days in the calculation. I checked the calculation for the April 1st and 
April 2nd individually. Insolation for the range of days 1-2 April equals 
to pisr for the April 2nd. The difference of those grids are 0 everywhere.

And actually it writes in the R session:
initialising gradient...
day 92(91-92), local time 05:00
day 92(91-92), local time 08:00
day 92(91-92), local time 11:00
day 92(91-92), local time 14:00
day 92(91-92), local time 17:00
day 92(91-92), local time 20:00
day 92(91-92), local time 23:00

and that is April 2nd.

It is not so perfect if I compare several (4) days. Most of the cells have 
0 difference but some diff. are larger. But not so large that I couldn't 
work with that.


>><li>Second question is a technical one: when the R script calls
>>rsaga.pisr I can not have the SAGA gui opened since it crashes down. Is
>>that expected?
>
>no it isn't, and I haven't experienced this problem with SAGA 2.0.7 on 
>Windows.

I also run SAGA 2.0.7 on Windows.
It seems the problem was with the available working memory. I ran the 
example on a large grid. When I made a smaller selection, it didn't crash 
any more.

Thanks again.


>><li>Considering the latitude=user defined, why do we need it since the
>>latitude grid is defined?
>
>not all the arguments are mandatory. you would specify either latitude or 
>in.latitude.grid

I tried the command with in.latitude.grid specified and
1. without  latitude in the command. I got an error:
Error in latitude >= -90 : 'latitude' is missing

2. vith latitude=NULL
but than also latitude grid was neglected

3. I have no idea what else to try. I will put latitude=45 instead.

So this seems the only unsolved question. Not bad at all! Thanks.


>><li>And finally, there is a comment concerning the units in the
>>rsaga.pisr when you chose kJ/m2. If I'm not mistaken, the resulting grid
>>is actually in MJ/m2.
>
>sorry I cannot confirm this, but it should be possible to determine that 
>by comparing average hourly PISR with the solar constant times 1 hour, 
>which will be higher but of the same order of magnitude as PISR if in the 
>same units. If that doesn't help, please follow up in the SAGA GIS forums 
>to find out if that's an error and issue a bug report if necessary.

I can explain this.
If pisr is calculated with the option: unit=c("kJ/m2") it is exactly 3.6 
times larger compared to one calculated with the option: unit=c("kWh/m2")
but:
kW h = [h=3600s] = 3600 kWs = [W = J/s] = 3600 kJ = 3.6 MJ

So calculation is OK, only for the calculated grid the units should be: 
"units=MJ/m2".

Smaller example is on http://radar.dhz.hr/~melita/

Kind regards,
Melita.


>I hope this helps
>   Alex
>
>
>></ul>The R script and input grids are provided in
>><a href="http://radar.dhz.hr/~melita" eudora="autourl">
>>http://radar.dhz.hr/~melita<br><br>
>><br>
>></a>Thank you for the help and a nice tools that we can all use and
>>benefit from it.<br><br>
>>Regards,<br><br>
>>Melita Percec Tadic<br><br>
>
>
>
>Date: Fri, 25 Nov 2011 16:52:57 +0100
>From: Melita Percec Tadic <melita at cirus.dhz.hr>
>To: r-sig-geo at r-project.org
>Subject: [R-sig-Geo] rsaga, radiation, rsaga.pisr
>Message-ID: <6.2.1.2.2.20111125163122.081c4ac0 at cirus.dhz.hr>
>Content-Type: text/plain; charset="us-ascii"
>
>An HTML attachment was scrubbed...
>URL: 
><https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111125/2faacf51/attachment-0001.html>
>
>
>--
>Alexander Brenning
>brenning at uwaterloo.ca - T +1-519-888-4567 ext 35783
>Department of Geography and Environmental Management
>University of Waterloo
>200 University Ave. W - Waterloo, ON - Canada N2L 3G1
>http://www.environment.uwaterloo.ca/geography/faculty/brenning/
>
>__________ NOD32 6667 (20111128) Information __________
>
>This message was checked by NOD32 antivirus system.
>http://www.eset.com
>


From t-schmidt at mail.tu-berlin.de  Tue Nov 29 16:07:51 2011
From: t-schmidt at mail.tu-berlin.de (Schmidt, Tobias)
Date: Tue, 29 Nov 2011 15:07:51 +0000
Subject: [R-sig-Geo] Linear interpolation with approxNA
Message-ID: <3E0FDF7FC2F0754B962112CDE7DCC46A4354D4@EX-MB03.tubit.win.tu-berlin.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111129/1e48411b/attachment.pl>

From mathieu.rajerison at gmail.com  Tue Nov 29 16:09:24 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Tue, 29 Nov 2011 16:09:24 +0100
Subject: [R-sig-Geo] Best method to compare a Reference DTM with a denoised
	GDEM ASTER V2
Message-ID: <CAGfc75=BaeyjrzEfbicEMrToAiaYHpx4umH874gqmNkni_DPoA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111129/4c4ecdc3/attachment.pl>

From kili at grf.bg.ac.rs  Tue Nov 29 16:37:06 2011
From: kili at grf.bg.ac.rs (Milan Kilibarda)
Date: Tue, 29 Nov 2011 16:37:06 +0100
Subject: [R-sig-Geo] Colors in package plotGoogleMaps
In-Reply-To: <CAHF6YnmOwYCqt=i7XtGECW-EVAwt2B=BHQWeBWYg72nBLEzhrQ@mail.gmail.com>
References: <CAHF6YnmOwYCqt=i7XtGECW-EVAwt2B=BHQWeBWYg72nBLEzhrQ@mail.gmail.com>
Message-ID: <c2229e1f9eb5015fe39a3495077685a0.squirrel@mail.grf.bg.ac.rs>

Dear Luca,

It is not difficult to set colors by attributes. According to your example.

plotGoogleMaps(nc,zcol="NWBIR74",filename='MyMap.htm',mapTypeId='TERRAIN',colPalette=rainbow(5))

It sets colors by argument NWBIR74 . It makes 5 categories of argument
NWBIR74 and gives colors from rainbow palette. It is better to use
palettes from RColorBrewer package.

If you want to set border color just add strokeColor="red" e.g.:

plotGoogleMaps(nc,zcol="NWBIR74",filename='MyMap.htm',mapTypeId='TERRAIN',colPalette=rainbow(5),strokeColor="red")

If you want to create new argument in form of factor you then just need to
set colPallete colors which has the same number of colors as levels of
your categories (factor argument).

I hope it helps.

Milan

> Hi everybody,
> I'm trying to use colPalette and/or strokeColor arguments in the function
> plotGoogleMaps to have different colors for values in the data.frame
> columns.
> I can't get the correct map, and always get a warning message.
> I tried the following (reproducible) code:
>
> library(maptools)
> library(rgdal)
> library(plotGoogleMaps)
>
> nc <- readShapePoly(system.file("shapes/sids.shp",
> package="maptools")[1], proj4string=CRS("+proj=longlat +datum=NAD27"))
>
> #First I tried colouring polygons and border differently...
> nc1=nc
> nc1 at data=data.frame(City_Name=nc at data$NAME,NWBIR74=nc at data
> $NWBIR74,BIR74=nc at data$BIR74)
> nc1Fill=rep("green",length(nc1 at data$City_Name))
> nc1Bord=nc1Fill
> nc1Fill[nc1 at data$NWBIR74>300]="red"
> nc1Bord[nc1 at data$BIR74>2000]="yellow"
> nc1Bord[nc1 at data$BIR74>10000]="red"
>
> MaiMap<-
> plotGoogleMaps(nc1,filename='MyMap.htm',mapTypeId='TERRAIN',colPalette=nc1Fill,strokeColor=nc1Bord)
> #here I get the following warning message:
> #In `levels<-`(`*tmp*`, value = c("green", "green", "green", "green",  :
> #  duplicated levels will not be allowed in factors anymore
>
> #borders are all green
>
>
> #Than I tried with 2 layers, as here:
> nc1=nc
> nc1 at data=data.frame(City_Name=nc at data$NAME,NWBIR74=nc at data$NWBIR74)
> nc1Fill=rep("green",length(nc1 at data$City_Name))
> nc1Fill[nc1 at data$NWBIR74>300]="red"
> nc2=nc
> nc2 at data=data.frame(City_Name=nc at data$NAME,BIR74=nc at data$BIR74)
> nc2Fill=rep("green",length(nc2 at data$City_Name))
> nc2Fill[nc2 at data$BIR74>2000]="yellow"
> nc2Fill[nc2 at data$BIR74>10000]="red"
>
> MaiMap1<- plotGoogleMaps(nc1,mapTypeId='TERRAIN',colPalette=nc1Fill,
> add=TRUE)
> MaiMap2<-
> plotGoogleMaps(nc2,filename='MyMap.htm',colPalette=nc2Fill,previousMap=MaiMap1)
> #here I get the same error , but map colors are wrong.
>
> Any suggestion?
> Thanks,
> Luca.
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


Milan Kilibarda

University of Belgrade,
Faculty of Civil Engineering,
Department of Geodesy and Geoinformatics,
Address: Bulevar kralja Aleksandra 73
   11000 Belgrade, Serbia,
Mail:kili at grf.bg.ac.rs

tel:+381 11 3218516


From r.hijmans at gmail.com  Tue Nov 29 18:52:02 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 29 Nov 2011 09:52:02 -0800
Subject: [R-sig-Geo] Best method to compare a Reference DTM with a
 denoised GDEM ASTER V2
In-Reply-To: <CAGfc75=BaeyjrzEfbicEMrToAiaYHpx4umH874gqmNkni_DPoA@mail.gmail.com>
References: <CAGfc75=BaeyjrzEfbicEMrToAiaYHpx4umH874gqmNkni_DPoA@mail.gmail.com>
Message-ID: <CANtt_hw4=59qy6HaDYP2DXtF5_mHH=6dvSEyKQb3dqwLMOZY-g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111129/bc08efaf/attachment.pl>

From Greg.Snow at imail.org  Tue Nov 29 19:15:10 2011
From: Greg.Snow at imail.org (Greg Snow)
Date: Tue, 29 Nov 2011 11:15:10 -0700
Subject: [R-sig-Geo] Overlaying rasters in spplot
In-Reply-To: <CAFK3DV-tBPhzr+049R8w=bzmc5RojSCST4NXqKEXbU8=3gOSAg@mail.gmail.com>
References: <CAFK3DV-tBPhzr+049R8w=bzmc5RojSCST4NXqKEXbU8=3gOSAg@mail.gmail.com>
Message-ID: <B37C0A15B8FB3C468B5BC7EBC7DA14CC635748480C@LP-EXMBVS10.CO.IHC.COM>

This is not an answer to the spplot question, but if your main goal is to plot your own data on top of google map tiles, then you may want to consider using the RgoogleMaps package which does exactly that.

-- 
Gregory (Greg) L. Snow Ph.D.
Statistical Data Center
Intermountain Healthcare
greg.snow at imail.org
801.408.8111


> -----Original Message-----
> From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-
> project.org] On Behalf Of Chris Fowler
> Sent: Monday, November 28, 2011 5:55 PM
> To: r-sig-geo at r-project.org
> Subject: [R-sig-Geo] Overlaying rasters in spplot
> 
> I am still having trouble with some raster overlays.
> My trouble now is a result of my not really understanding how layers
> and sp.layout work in the spplot function
> 
> I go through a whole mess of steps to get two rasters of identical
> extent and dimension (One is a google map tile, the other my own data)
> Plotting them using the default plot() method within raster, however
> doesn't allow me to have the color palette and breaks I want, so at
> the suggestion of one of the threads on this list I have converted my
> raster objects to SpatialGridDataFrame objects.
> 
> I can plot these objects and get exactly what I want using the
> following code:
>   layer1<-
> spplot(raster1,"values",at=brks1,col.regions=pal1,colorkey=FALSE)
>   layer1
>   layer2<-spplot(raster2, "values", at=brks2,col.regions=pal2)
>   layer2
> 
> from reading the documentation on spplot() from sp package I should be
> able to use the sp.layout attribute to map the second of these layers
> with a transparency of say .5, but I have not been able to get there.
> 
> I am hoping that this is enough of a syntax question that the experts
> here can help without a full worked example--my apologies if this is
> not the case.
> 
> Thanks in advance,
> 
> Chris
> 
> Christopher S. Fowler PhD.
> 206.920.1686
> http://csfowler.com
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From mollymdavies at gmail.com  Tue Nov 29 20:55:48 2011
From: mollymdavies at gmail.com (Molly Davies)
Date: Tue, 29 Nov 2011 11:55:48 -0800
Subject: [R-sig-Geo] can't get gstat to work with R 2.14.0 on Mac
Message-ID: <0A8C95E4-9E38-4304-AC82-75BE1E8C33B7@gmail.com>

Hello,

I am unable to get gstat to load using R version 2.14.0 (2011-10-31) on platform x86_64-apple-darwin9.8.0/x86_64 (64 bit). The package was working before I updated my R version.

When I tried to load gstat before i had updated it, I got the following error message. (I include this in case there are clues that might indicate the source of my problem).
> library(gstat)
Loading required package: spacetime
Loading required package: xts
Error in dyn.load(file, DLLpath = DLLpath, ...) : 
  unable to load shared object '/Library/Frameworks/R.framework/Versions/2.14/Resources/library/gstat/libs/x86_64/gstat.so':
  dlopen(/Library/Frameworks/R.framework/Versions/2.14/Resources/library/gstat/libs/x86_64/gstat.so, 6): Library not loaded: @rpath/R.framework/Versions/2.13/Resources/lib/libR.dylib
  Referenced from: /Library/Frameworks/R.framework/Versions/2.14/Resources/library/gstat/libs/x86_64/gstat.so
  Reason: image not found
In addition: Warning messages:
1: replacing previous import ?is.projected? when loading ?spacetime? 
2: replacing previous import ?proj4string? when loading ?spacetime? 
3: replacing previous import ?proj4string<-? when loading ?spacetime? 
Error: package/namespace load failed for ?gstat?

I assumed this meant I needed to update/reinstall gstat, which I did from the GUI. 

> install.packages("gstat")
trying URL 'http://cran.cnr.Berkeley.edu/bin/macosx/leopard/contrib/2.14/gstat_1.0-10.tgz'
Content type 'application/x-gzip' length 2888795 bytes (2.8 Mb)
opened URL
==================================================
downloaded 2.8 Mb


The downloaded packages are in
	/var/folders/wB/wB-s9onCFfSt45x+FPq9rE+++TI/-Tmp-//Rtmpyy3Pnp/downloaded_packages

Then when I tried to load the library again, I got the following:

> library(gstat)
Error in get(Info[i, 1], envir = env) : 
  internal error -3 in R_decompress1
Error: package/namespace load failed for ?gstat?

I've never seen this error before. 
Following the suggestions from a message on R-sig-ME regarding the library lme4a:
https://stat.ethz.ch/pipermail/r-sig-mixed-models/2011q3/006399.html
(I think it's irrelevant here, but I have Xcode installed.)

1. I tried installing the package from R-forge (maybe this would be better?)
> install.packages("gstat",repos="http://r-forge.r-project.org")
Warning message:
In getDependencies(pkgs, dependencies, available, lib) :
  package ?gstat? is not available (for R version 2.14.0)

2. I downloaded the "gstat" packages directly from CRAN and installed from the command line:

Molly$ R CMD INSTALL /Users/Molly/Downloads/gstat_1.0-10.tgz
* installing to library ?/Library/Frameworks/R.framework/Versions/2.14/Resources/library?
* installing *binary* package ?gstat? ...

* DONE (gstat)

Still no luck. Does anyone have any advice for me as far as how to proceed? I apologize in advance if my problem has already been addressed and I failed to find it in the list archives. If this is the case, I would very much appreciate it if someone could send me a link.

Thanks for your time,

Molly Davies


From kili at grf.bg.ac.rs  Tue Nov 29 21:44:03 2011
From: kili at grf.bg.ac.rs (Milan Kilibarda)
Date: Tue, 29 Nov 2011 21:44:03 +0100
Subject: [R-sig-Geo] Colors in package plotGoogleMaps
In-Reply-To: <CAHF6Yn=458jt5eFBdpaqBSE2LtXxzAf6GusCV78Dn-dL1tWq-w@mail.gmail.com>
References: <CAHF6YnmOwYCqt=i7XtGECW-EVAwt2B=BHQWeBWYg72nBLEzhrQ@mail.gmail.com>
	<c2229e1f9eb5015fe39a3495077685a0.squirrel@mail.grf.bg.ac.rs>
	<CAHF6Yn=458jt5eFBdpaqBSE2LtXxzAf6GusCV78Dn-dL1tWq-w@mail.gmail.com>
Message-ID: <410c34f93be7052ab8426bc9e6036a86.squirrel@mail.grf.bg.ac.rs>

Hi,

Just make categorical(factor) variable (V1) according to your threshold
and give  as new attribute (column) in dataframe, then set in
plotGoogleMaps colPalette=c(#FFFFFF,#000000) (2 colors), it is important
to set zcol="your factor variable" (V1).

For borders I didn't make it that easy like with polygon, I'll do it new
version soon, probably.

You can solve it like this. Make on the same way V2 as it described for
polygon fill. Than make string from V2
strokeColor=as.character(factor(V2,labels=c("color1","col2") ) colors
should be in hex notation (#FF0000 instead "red")

On the end your command should be something like this

plotGoogleMaps(nc,zcol="V1",colPalette=c(c1,c2 in hex
notation),strokeColor=as.character(factor(V2,labels=c("color1","col2") ))
)

And it should work, I hope :) .

Best regards,
Milan

> Hi Milan,
> thank for your reply to my  question.
> I think I wasn't clear saying what my problem is...
> I'd like to use 2  threshold (say T1 and T2) and to variables (say V1 and
> V2) and to have on the sampe map:
> polygons with color1 if V1 >T1, else color2;
> borders with color3 if V2>T2, else color4.
>
> I hope it's possible to do,
> thanks.
> Luca
>
>
>
> 2011/11/29 Milan Kilibarda <kili at grf.bg.ac.rs>
>
>> Dear Luca,
>>
>> It is not difficult to set colors by attributes. According to your
>> example.
>>
>>
>> plotGoogleMaps(nc,zcol="NWBIR74",filename='MyMap.htm',mapTypeId='TERRAIN',colPalette=rainbow(5))
>>
>> It sets colors by argument NWBIR74 . It makes 5 categories of argument
>> NWBIR74 and gives colors from rainbow palette. It is better to use
>> palettes from RColorBrewer package.
>>
>> If you want to set border color just add strokeColor="red" e.g.:
>>
>>
>> plotGoogleMaps(nc,zcol="NWBIR74",filename='MyMap.htm',mapTypeId='TERRAIN',colPalette=rainbow(5),strokeColor="red")
>>
>> If you want to create new argument in form of factor you then just need
>> to
>> set colPallete colors which has the same number of colors as levels of
>> your categories (factor argument).
>>
>> I hope it helps.
>>
>> Milan
>>
>> > Hi everybody,
>> > I'm trying to use colPalette and/or strokeColor arguments in the
>> function
>> > plotGoogleMaps to have different colors for values in the data.frame
>> > columns.
>> > I can't get the correct map, and always get a warning message.
>> > I tried the following (reproducible) code:
>> >
>> > library(maptools)
>> > library(rgdal)
>> > library(plotGoogleMaps)
>> >
>> > nc <- readShapePoly(system.file("shapes/sids.shp",
>> > package="maptools")[1], proj4string=CRS("+proj=longlat +datum=NAD27"))
>> >
>> > #First I tried colouring polygons and border differently...
>> > nc1=nc
>> > nc1 at data=data.frame(City_Name=nc at data$NAME,NWBIR74=nc at data
>> > $NWBIR74,BIR74=nc at data$BIR74)
>> > nc1Fill=rep("green",length(nc1 at data$City_Name))
>> > nc1Bord=nc1Fill
>> > nc1Fill[nc1 at data$NWBIR74>300]="red"
>> > nc1Bord[nc1 at data$BIR74>2000]="yellow"
>> > nc1Bord[nc1 at data$BIR74>10000]="red"
>> >
>> > MaiMap<-
>> >
>> plotGoogleMaps(nc1,filename='MyMap.htm',mapTypeId='TERRAIN',colPalette=nc1Fill,strokeColor=nc1Bord)
>> > #here I get the following warning message:
>> > #In `levels<-`(`*tmp*`, value = c("green", "green", "green", "green",
>> :
>> > #  duplicated levels will not be allowed in factors anymore
>> >
>> > #borders are all green
>> >
>> >
>> > #Than I tried with 2 layers, as here:
>> > nc1=nc
>> > nc1 at data=data.frame(City_Name=nc at data$NAME,NWBIR74=nc at data$NWBIR74)
>> > nc1Fill=rep("green",length(nc1 at data$City_Name))
>> > nc1Fill[nc1 at data$NWBIR74>300]="red"
>> > nc2=nc
>> > nc2 at data=data.frame(City_Name=nc at data$NAME,BIR74=nc at data$BIR74)
>> > nc2Fill=rep("green",length(nc2 at data$City_Name))
>> > nc2Fill[nc2 at data$BIR74>2000]="yellow"
>> > nc2Fill[nc2 at data$BIR74>10000]="red"
>> >
>> > MaiMap1<- plotGoogleMaps(nc1,mapTypeId='TERRAIN',colPalette=nc1Fill,
>> > add=TRUE)
>> > MaiMap2<-
>> >
>> plotGoogleMaps(nc2,filename='MyMap.htm',colPalette=nc2Fill,previousMap=MaiMap1)
>> > #here I get the same error , but map colors are wrong.
>> >
>> > Any suggestion?
>> > Thanks,
>> > Luca.
>> >
>> >       [[alternative HTML version deleted]]
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at r-project.org
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >
>>
>>
>> Milan Kilibarda
>>
>> University of Belgrade,
>> Faculty of Civil Engineering,
>> Department of Geodesy and Geoinformatics,
>> Address: Bulevar kralja Aleksandra 73
>>   11000 Belgrade, Serbia,
>> Mail:kili at grf.bg.ac.rs
>>
>> tel:+381 11 3218516
>>
>>
>>
>


Milan Kilibarda

University of Belgrade,
Faculty of Civil Engineering,
Department of Geodesy and Geoinformatics,
Address: Bulevar kralja Aleksandra 73
   11000 Belgrade, Serbia,
Mail:kili at grf.bg.ac.rs

tel:+381 11 3218516


From sam.rabin at gmail.com  Tue Nov 29 21:46:48 2011
From: sam.rabin at gmail.com (Sam Rabin)
Date: Tue, 29 Nov 2011 15:46:48 -0500
Subject: [R-sig-Geo] Problem with writeSpatialShape
Message-ID: <C8C7E3AB-1D88-4A92-9CE3-92CB29B9BFB6@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111129/17b1fd2c/attachment.pl>

From Roger.Bivand at nhh.no  Tue Nov 29 21:52:47 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 29 Nov 2011 21:52:47 +0100 (CET)
Subject: [R-sig-Geo] Problem with writeSpatialShape
In-Reply-To: <C8C7E3AB-1D88-4A92-9CE3-92CB29B9BFB6@gmail.com>
References: <C8C7E3AB-1D88-4A92-9CE3-92CB29B9BFB6@gmail.com>
Message-ID: <alpine.LRH.2.00.1111292149100.4651@reclus.nhh.no>

On Tue, 29 Nov 2011, Sam Rabin wrote:

> Hello all. I'm trying to write a new shapefile and am running into a weird issue. After I import the new shapefile into QGIS, I can see all the polygons in the attribute table, but none of them show up on the map no matter how I play with the projections.
>
> Here is some code that isolates the problem:
> library("maptools")
> spdf_1 <- readShapePoly("original.shp")
> spdf_2 <- readShapePoly("original.shp", proj4string=CRS(as.character("+proj=utm +zone=19 +south +datum=WGS84 +units=m +no_defs")))
> writeSpatialShape(spdf_1, "output_1")
> writeSpatialShape(spdf_2, "output_2")
>
> As you can see, I tried readShapePoly with and without CRS information, 
> but both output files exhibit the same problem. I've used 
> writeSpatialShape successfully in the past, and I don't know what I'm 
> doing differently here.

The functions in maptools neither read nor write *.prj files, only *.shp, 
*.shx, and *.dbf (they use shapelib, which doesn't know about 
projections). Setting the CRS makes no difference. Did you use writeOGR() 
in rgdal before - the rgdal functions both read and write projection 
information?

Hope this helps,

Roger

>
> Thanks in advance for your help.
>
> Sam Rabin
>     Graduate student
>         Princeton University
>         Ecology & Evolutionary Biology
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From edzer.pebesma at uni-muenster.de  Tue Nov 29 23:07:00 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 29 Nov 2011 23:07:00 +0100
Subject: [R-sig-Geo] can't get gstat to work with R 2.14.0 on Mac
In-Reply-To: <0A8C95E4-9E38-4304-AC82-75BE1E8C33B7@gmail.com>
References: <0A8C95E4-9E38-4304-AC82-75BE1E8C33B7@gmail.com>
Message-ID: <4ED55784.3090707@uni-muenster.de>

Hi, earlier today I ran into the same kind of error (which I had never
seen before either), on a Linux x86_64:

>> library(gstat) # actually, I loaded spdep
> Error in get(Info[i, 1], envir = env) :
>   internal error -3 in R_decompress1
> Error: package/namespace load failed for ?gstat?

what helped was re-installing all the packages it depended upon. So, I
would try to reinstall sp, spacetime and zoo, then reinstall gstat.

Let me know if this helps.
--
Edzer

On 11/29/2011 08:55 PM, Molly Davies wrote:
> Hello,
> 
> I am unable to get gstat to load using R version 2.14.0 (2011-10-31) on platform x86_64-apple-darwin9.8.0/x86_64 (64 bit). The package was working before I updated my R version.
> 
> When I tried to load gstat before i had updated it, I got the following error message. (I include this in case there are clues that might indicate the source of my problem).
>> library(gstat)
> Loading required package: spacetime
> Loading required package: xts
> Error in dyn.load(file, DLLpath = DLLpath, ...) : 
>   unable to load shared object '/Library/Frameworks/R.framework/Versions/2.14/Resources/library/gstat/libs/x86_64/gstat.so':
>   dlopen(/Library/Frameworks/R.framework/Versions/2.14/Resources/library/gstat/libs/x86_64/gstat.so, 6): Library not loaded: @rpath/R.framework/Versions/2.13/Resources/lib/libR.dylib
>   Referenced from: /Library/Frameworks/R.framework/Versions/2.14/Resources/library/gstat/libs/x86_64/gstat.so
>   Reason: image not found
> In addition: Warning messages:
> 1: replacing previous import ?is.projected? when loading ?spacetime? 
> 2: replacing previous import ?proj4string? when loading ?spacetime? 
> 3: replacing previous import ?proj4string<-? when loading ?spacetime? 
> Error: package/namespace load failed for ?gstat?
> 
> I assumed this meant I needed to update/reinstall gstat, which I did from the GUI. 
> 
>> install.packages("gstat")
> trying URL 'http://cran.cnr.Berkeley.edu/bin/macosx/leopard/contrib/2.14/gstat_1.0-10.tgz'
> Content type 'application/x-gzip' length 2888795 bytes (2.8 Mb)
> opened URL
> ==================================================
> downloaded 2.8 Mb
> 
> 
> The downloaded packages are in
> 	/var/folders/wB/wB-s9onCFfSt45x+FPq9rE+++TI/-Tmp-//Rtmpyy3Pnp/downloaded_packages
> 
> Then when I tried to load the library again, I got the following:
> 
>> library(gstat)
> Error in get(Info[i, 1], envir = env) : 
>   internal error -3 in R_decompress1
> Error: package/namespace load failed for ?gstat?
> 
> I've never seen this error before. 
> Following the suggestions from a message on R-sig-ME regarding the library lme4a:
> https://stat.ethz.ch/pipermail/r-sig-mixed-models/2011q3/006399.html
> (I think it's irrelevant here, but I have Xcode installed.)
> 
> 1. I tried installing the package from R-forge (maybe this would be better?)
>> install.packages("gstat",repos="http://r-forge.r-project.org")
> Warning message:
> In getDependencies(pkgs, dependencies, available, lib) :
>   package ?gstat? is not available (for R version 2.14.0)
> 
> 2. I downloaded the "gstat" packages directly from CRAN and installed from the command line:
> 
> Molly$ R CMD INSTALL /Users/Molly/Downloads/gstat_1.0-10.tgz
> * installing to library ?/Library/Frameworks/R.framework/Versions/2.14/Resources/library?
> * installing *binary* package ?gstat? ...
> 
> * DONE (gstat)
> 
> Still no luck. Does anyone have any advice for me as far as how to proceed? I apologize in advance if my problem has already been addressed and I failed to find it in the list archives. If this is the case, I would very much appreciate it if someone could send me a link.
> 
> Thanks for your time,
> 
> Molly Davies
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From janverbesselt at gmail.com  Tue Nov 29 23:55:15 2011
From: janverbesselt at gmail.com (Jan Verbesselt)
Date: Tue, 29 Nov 2011 23:55:15 +0100
Subject: [R-sig-Geo] can't get gstat to work with R 2.14.0 on Mac
In-Reply-To: <0A8C95E4-9E38-4304-AC82-75BE1E8C33B7@gmail.com>
References: <0A8C95E4-9E38-4304-AC82-75BE1E8C33B7@gmail.com>
Message-ID: <1851B55C-57D4-4F5E-807B-443EDA4D3B46@gmail.com>

Also make sure you have the latest R.app 2.14.0 for Mac because there was an issue when installing packages from the R.app (in case you where using this). Please see:
http://www.mail-archive.com/r-sig-mac at r-project.org/msg00840.html


On 29/11/2011, at 8:55 PM, Molly Davies wrote:

> Hello,
> 
> I am unable to get gstat to load using R version 2.14.0 (2011-10-31) on platform x86_64-apple-darwin9.8.0/x86_64 (64 bit). The package was working before I updated my R version.
> 
> When I tried to load gstat before i had updated it, I got the following error message. (I include this in case there are clues that might indicate the source of my problem).
>> library(gstat)
> Loading required package: spacetime
> Loading required package: xts
> Error in dyn.load(file, DLLpath = DLLpath, ...) : 
>  unable to load shared object '/Library/Frameworks/R.framework/Versions/2.14/Resources/library/gstat/libs/x86_64/gstat.so':
>  dlopen(/Library/Frameworks/R.framework/Versions/2.14/Resources/library/gstat/libs/x86_64/gstat.so, 6): Library not loaded: @rpath/R.framework/Versions/2.13/Resources/lib/libR.dylib
>  Referenced from: /Library/Frameworks/R.framework/Versions/2.14/Resources/library/gstat/libs/x86_64/gstat.so
>  Reason: image not found
> In addition: Warning messages:
> 1: replacing previous import ?is.projected? when loading ?spacetime? 
> 2: replacing previous import ?proj4string? when loading ?spacetime? 
> 3: replacing previous import ?proj4string<-? when loading ?spacetime? 
> Error: package/namespace load failed for ?gstat?
> 
> I assumed this meant I needed to update/reinstall gstat, which I did from the GUI. 
> 
>> install.packages("gstat")
> trying URL 'http://cran.cnr.Berkeley.edu/bin/macosx/leopard/contrib/2.14/gstat_1.0-10.tgz'
> Content type 'application/x-gzip' length 2888795 bytes (2.8 Mb)
> opened URL
> ==================================================
> downloaded 2.8 Mb
> 
> 
> The downloaded packages are in
> 	/var/folders/wB/wB-s9onCFfSt45x+FPq9rE+++TI/-Tmp-//Rtmpyy3Pnp/downloaded_packages
> 
> Then when I tried to load the library again, I got the following:
> 
>> library(gstat)
> Error in get(Info[i, 1], envir = env) : 
>  internal error -3 in R_decompress1
> Error: package/namespace load failed for ?gstat?
> 
> I've never seen this error before. 
> Following the suggestions from a message on R-sig-ME regarding the library lme4a:
> https://stat.ethz.ch/pipermail/r-sig-mixed-models/2011q3/006399.html
> (I think it's irrelevant here, but I have Xcode installed.)
> 
> 1. I tried installing the package from R-forge (maybe this would be better?)
>> install.packages("gstat",repos="http://r-forge.r-project.org")
> Warning message:
> In getDependencies(pkgs, dependencies, available, lib) :
>  package ?gstat? is not available (for R version 2.14.0)
> 
> 2. I downloaded the "gstat" packages directly from CRAN and installed from the command line:
> 
> Molly$ R CMD INSTALL /Users/Molly/Downloads/gstat_1.0-10.tgz
> * installing to library ?/Library/Frameworks/R.framework/Versions/2.14/Resources/library?
> * installing *binary* package ?gstat? ...
> 
> * DONE (gstat)
> 
> Still no luck. Does anyone have any advice for me as far as how to proceed? I apologize in advance if my problem has already been addressed and I failed to find it in the list archives. If this is the case, I would very much appreciate it if someone could send me a link.
> 
> Thanks for your time,
> 
> Molly Davies
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From mathieu.rajerison at gmail.com  Wed Nov 30 09:26:12 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Wed, 30 Nov 2011 09:26:12 +0100
Subject: [R-sig-Geo] Best method to compare a Reference DTM with a
 denoised GDEM ASTER V2
In-Reply-To: <CANtt_hw4=59qy6HaDYP2DXtF5_mHH=6dvSEyKQb3dqwLMOZY-g@mail.gmail.com>
References: <CAGfc75=BaeyjrzEfbicEMrToAiaYHpx4umH874gqmNkni_DPoA@mail.gmail.com>
	<CANtt_hw4=59qy6HaDYP2DXtF5_mHH=6dvSEyKQb3dqwLMOZY-g@mail.gmail.com>
Message-ID: <CAGfc75myQt+3JL0iKr_GfoGyjJuN5Z9s1sMCPnBFYeFCZa+o3Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111130/b1319bad/attachment.pl>

From chamb244 at msu.edu  Wed Nov 30 13:47:43 2011
From: chamb244 at msu.edu (Jordan Chamberlin)
Date: Wed, 30 Nov 2011 07:47:43 -0500
Subject: [R-sig-Geo] combine function in R?
In-Reply-To: <CANtt_hz-C_LH+k_D0MKAUj=kEFfQCcOfA2yo7RnGLsE+qw8tpg@mail.gmail.com>
References: <4ECE7349.8000500@msu.edu>
	<CANtt_hz-C_LH+k_D0MKAUj=kEFfQCcOfA2yo7RnGLsE+qw8tpg@mail.gmail.com>
Message-ID: <4ED625EF.303@msu.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20111130/15971495/attachment.pl>

From mollymdavies at gmail.com  Wed Nov 30 19:58:16 2011
From: mollymdavies at gmail.com (Molly Davies)
Date: Wed, 30 Nov 2011 10:58:16 -0800
Subject: [R-sig-Geo] can't get gstat to work with R 2.14.0 on Mac
In-Reply-To: <1851B55C-57D4-4F5E-807B-443EDA4D3B46@gmail.com>
References: <0A8C95E4-9E38-4304-AC82-75BE1E8C33B7@gmail.com>
	<1851B55C-57D4-4F5E-807B-443EDA4D3B46@gmail.com>
Message-ID: <1E72FA04-FACD-4D61-A50C-36DA469347E3@gmail.com>

Thanks, this worked!
-Molly
On Nov 29, 2011, at 2:55 PM, Jan Verbesselt wrote:

> Also make sure you have the latest R.app 2.14.0 for Mac because there was an issue when installing packages from the R.app (in case you where using this). Please see:
> http://www.mail-archive.com/r-sig-mac at r-project.org/msg00840.html
> 
> 
> On 29/11/2011, at 8:55 PM, Molly Davies wrote:
> 
>> Hello,
>> 
>> I am unable to get gstat to load using R version 2.14.0 (2011-10-31) on platform x86_64-apple-darwin9.8.0/x86_64 (64 bit). The package was working before I updated my R version.
>> 
>> When I tried to load gstat before i had updated it, I got the following error message. (I include this in case there are clues that might indicate the source of my problem).
>>> library(gstat)
>> Loading required package: spacetime
>> Loading required package: xts
>> Error in dyn.load(file, DLLpath = DLLpath, ...) : 
>> unable to load shared object '/Library/Frameworks/R.framework/Versions/2.14/Resources/library/gstat/libs/x86_64/gstat.so':
>> dlopen(/Library/Frameworks/R.framework/Versions/2.14/Resources/library/gstat/libs/x86_64/gstat.so, 6): Library not loaded: @rpath/R.framework/Versions/2.13/Resources/lib/libR.dylib
>> Referenced from: /Library/Frameworks/R.framework/Versions/2.14/Resources/library/gstat/libs/x86_64/gstat.so
>> Reason: image not found
>> In addition: Warning messages:
>> 1: replacing previous import ?is.projected? when loading ?spacetime? 
>> 2: replacing previous import ?proj4string? when loading ?spacetime? 
>> 3: replacing previous import ?proj4string<-? when loading ?spacetime? 
>> Error: package/namespace load failed for ?gstat?
>> 
>> I assumed this meant I needed to update/reinstall gstat, which I did from the GUI. 
>> 
>>> install.packages("gstat")
>> trying URL 'http://cran.cnr.Berkeley.edu/bin/macosx/leopard/contrib/2.14/gstat_1.0-10.tgz'
>> Content type 'application/x-gzip' length 2888795 bytes (2.8 Mb)
>> opened URL
>> ==================================================
>> downloaded 2.8 Mb
>> 
>> 
>> The downloaded packages are in
>> 	/var/folders/wB/wB-s9onCFfSt45x+FPq9rE+++TI/-Tmp-//Rtmpyy3Pnp/downloaded_packages
>> 
>> Then when I tried to load the library again, I got the following:
>> 
>>> library(gstat)
>> Error in get(Info[i, 1], envir = env) : 
>> internal error -3 in R_decompress1
>> Error: package/namespace load failed for ?gstat?
>> 
>> I've never seen this error before. 
>> Following the suggestions from a message on R-sig-ME regarding the library lme4a:
>> https://stat.ethz.ch/pipermail/r-sig-mixed-models/2011q3/006399.html
>> (I think it's irrelevant here, but I have Xcode installed.)
>> 
>> 1. I tried installing the package from R-forge (maybe this would be better?)
>>> install.packages("gstat",repos="http://r-forge.r-project.org")
>> Warning message:
>> In getDependencies(pkgs, dependencies, available, lib) :
>> package ?gstat? is not available (for R version 2.14.0)
>> 
>> 2. I downloaded the "gstat" packages directly from CRAN and installed from the command line:
>> 
>> Molly$ R CMD INSTALL /Users/Molly/Downloads/gstat_1.0-10.tgz
>> * installing to library ?/Library/Frameworks/R.framework/Versions/2.14/Resources/library?
>> * installing *binary* package ?gstat? ...
>> 
>> * DONE (gstat)
>> 
>> Still no luck. Does anyone have any advice for me as far as how to proceed? I apologize in advance if my problem has already been addressed and I failed to find it in the list archives. If this is the case, I would very much appreciate it if someone could send me a link.
>> 
>> Thanks for your time,
>> 
>> Molly Davies
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 


