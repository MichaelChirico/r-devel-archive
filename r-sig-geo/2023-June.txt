From btupper @end|ng |rom b|ge|ow@org  Thu Jun  1 00:16:29 2023
From: btupper @end|ng |rom b|ge|ow@org (Ben Tupper)
Date: Wed, 31 May 2023 18:16:29 -0400
Subject: [R-sig-Geo] Mapping census tracts with leaflet(): "sf layer has
 inconsistent datum" error
In-Reply-To: <010001887367c22b-cfdf7f66-7212-4fe4-8dd5-001439a110f8-000000@email.amazonses.com>
References: <5a45b608-91b2-3aaf-5d39-d50c6b57c136@zembower.org>
 <010001887367c22b-cfdf7f66-7212-4fe4-8dd5-001439a110f8-000000@email.amazonses.com>
Message-ID: <CALrbzg2xo26AgcasG3qHS2JzKE6oti9Pmd+-v-fR=VG7f9sKTQ@mail.gmail.com>

Hi,

This is a great place to ask - and nice reproducible code!

You have a two issues as far as I can see.  First it seems you have dropped
the "4" in "WGS84".  And second you want to transform rw_pop, not the
output of leaflet().  The following works for me.

## Start
library(tidyverse)
library(tidycensus)
library(leaflet)
library(sf)

rw_blocks <- c(3000, 3001, 3002, 3005, 3006, 3007, 3008, 3009, 3010, 3011)

rw_pop <- get_decennial(
  geography = "block",
  variables = "P1_001N",
  year = 2020,
  state = "MD",
  county = "Baltimore city",
  geometry = TRUE
) %>%
  filter(substr(GEOID, 6, 11) == "271101" &
           substr(GEOID, 12, 15) %in% rw_blocks
  ) ## %>% st_transform('+proj=longlat +datum=WGS8')

(rw_pop_map <- rw_pop %>%
    st_transform('+proj=longlat +datum=WGS84') %>%
    leaflet() %>%
    fitBounds(-76.616, 39.352, -76.610, 39.346) %>%
    addTiles() %>%
    addPolygons()
)
## End

On Wed, May 31, 2023 at 4:03?PM Kevin Zembower via R-sig-Geo <
r-sig-geo at r-project.org> wrote:

> Hello, all. Newbie to sf, tidycensus and the tidyverse here.
>
> First off, is this the appropriate list to ask this question? If not,
> let me know and I'll go away.
>
> I'm trying to map census blocks for my neighborhood to a base map. I'm
> using tidycensus to get the geometry of the census blocks, and leaflet
> to map them to the OSM base maps. Mostly, this is going really well, and
> I'm very pleased with the speed of development (I just started this
> morning) and results.
>
> However, I get this error:
>
>   Warning message:
> sf layer has inconsistent datum (+proj=longlat +datum=NAD83 +no_defs).
> Need '+proj=longlat +datum=WGS84'
>
> I think I need to use st_transform, but can't get it to work.
>
> Here's a reproducible example, with some commented out lines of what
> I've tried:
>
> ## Reproducible example:
> library(tidyverse)
> library(tidycensus)
> library(leaflet)
> library(sf)
>
> rw_blocks <- c(3000, 3001, 3002, 3005, 3006, 3007, 3008, 3009, 3010, 3011)
>
> rw_pop <- get_decennial(
>      geography = "block",
>      variables = "P1_001N",
>      year = 2020,
>      state = "MD",
>      county = "Baltimore city",
>      geometry = TRUE
> ) %>%
>      filter(substr(GEOID, 6, 11) == "271101" &
>             substr(GEOID, 12, 15) %in% rw_blocks
>             ) ## %>% st_transform('+proj=longlat +datum=WGS8')
>
> (rw_pop_map <- rw_pop %>%
>      leaflet() %>%
>       ## st_transform('+proj=longlat +datum=WGS8') %>%
>      fitBounds(-76.616, 39.352, -76.610, 39.346) %>%
>      addTiles() %>%
>      addPolygons()
>      )
> ## Error occurs when executing above block
>
> Can anyone offer me a hint as to how to resolve this error?
>
> Thanks so much for any advice and guidance.
>
> -Kevin
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From je|une@ @end|ng |rom gm@||@com  Thu Jun  1 17:16:42 2023
From: je|une@ @end|ng |rom gm@||@com (Jose Funes)
Date: Thu, 1 Jun 2023 11:16:42 -0400
Subject: [R-sig-Geo] 
 Estimate impacts from a spgm - spatial panel regression model
In-Reply-To: <CAG1eJiEUY6iOUW+y1QoqHo=b6d7YKbkuKevfTsGFHhyC180koQ@mail.gmail.com>
References: <mailman.29258.5.1684663202.15457.r-sig-geo@r-project.org>
 <CAG1eJiH2SX9jirFUXk=uojs_bDV30QhESqD3rcDegXO8M5g0TQ@mail.gmail.com>
 <CAL3ufUJsuWNeXfXTUEdohGK7Gedc2my3honrHa8Dm0BNPqgr7g@mail.gmail.com>
 <OSWP279MB04711AFE395E04A33466CE14EE479@OSWP279MB0471.NORP279.PROD.OUTLOOK.COM>
 <CAG1eJiG8s=m11_aLB3StHT2aGzbbsvKEOGnOTJZ6dfALqZ6Tug@mail.gmail.com>
 <CAG1eJiEUY6iOUW+y1QoqHo=b6d7YKbkuKevfTsGFHhyC180koQ@mail.gmail.com>
Message-ID: <CAG1eJiHFGsSDujg3ysB4gGJV+nC0hrHfG4PPV=ixoOWyJq8iKw@mail.gmail.com>

I loaded the spatiareg library and the function spatial weights matrix
powers traces (trMatc) worked. Still, the impact function gives me an error
message.

On Sat, May 27, 2023 at 11:37?AM Jose Funes <jefunes at gmail.com> wrote:

> Thanks, Professor Bivand and Josiah. The previous code had the variable
> time mistyped instead of time1. The code below corrects that. See below,
> basic info and code:
>
> # Rstudio version and PC info
>
> platform       x86_64-w64-mingw32
> arch           x86_64
> os             mingw32
> system         x86_64, mingw32
> status
> major          4
> minor          1.2
> year           2021
> month          11
> day            01
> svn rev        81115
> language       R
> version.string R version 4.1.2 (2021-11-01)
>
>
>
> ####### code #####
>
> # Load necessary libraries
> library(tigris)
> library(splm)
> library(spdep)
> library(Matrix)
> library(plm)
>
>
> # Load necessary libraries
> library(tigris)
> library(splm)
> library(spdep)
> library(Matrix)
> library(plm)
>
> # census tracts
> dc_tracts_2018 <- tracts(state="DC",cb=TRUE, year=2018)
> dc_tracts_2018$row.id <- 1:179
>
> # Spatial matrix
> coords <- coordinates(dc_tracts_2018)
> DC.knn_7 <- knearneigh(coords, k=7)
> DC7_nb <- knn2nb(DC.knn_7)
> DCknn_7 <- nb2listw(DC7_nb, style="W")
>
> # reproducible example
> set.seed(123)
> df2010 <- data.frame(
>   y = rnorm(179),
>   x = rnorm(179, mean=2),
>   x2 = rnorm(179, mean = 3),
>   year=2010,
>   row.id = 1:179
> )
>
> df2015 <- data.frame(
>   y = rnorm(179),
>   x = rnorm(179, mean=2.5),
>   x2 = rnorm(179, mean = 3),
>   year=2015,
>   row.id = 1:179
> )
>
> df2020 <- data.frame(
>   y = rnorm(179),
>   x = rnorm(179, mean=1.5),
>   x2 = rnorm(179, mean = 3.5),
>   year=2020,
>   row.id = 1:179
> )
>
>
> # drop geom
> st_geometry(dc_tracts_2018) <- NULL
>
> #list of data frame
> df <- list(df2010,df2015,df2020)
>
> for (i in seq_along(df)) {
>   df[[i]] <- merge(df[[i]], dc_tracts_2018, by = "row.id")
>
> }
>
> df2010 <- df[1]
> df2015 <- df[2]
> df2020 <- df[3]
>
> # merging
> panel_dc_2010_2020 <- rbind(df2010[[1]], df2015[[1]], df2020[[1]])
>
> #### setting lag variables
> panel_dc_2010_2020.pd<-pdata.frame(panel_dc_2010_2020,
> index=c("GEOID","year"))
>
> # lag variables
> panel_dc_2010_2020.pd$lag_x <- slag(panel_dc_2010_2020.pd$x,listw=DCknn_7)
> panel_dc_2010_2020.pd$lag_x2 <-
> slag(panel_dc_2010_2020.pd$x2,listw=DCknn_7)
>
> ## impacts
> time1 <- length(unique(panel_dc_2010_2020$year))
> s.lwtracts <- kronecker(Diagonal(time1), listw2dgCMatrix(DCknn_7))
> trMatc <- trW(s.lwtracts, type = "mult")
>
> Error in trW(s.lwtracts, type = "mult") : could not find function "trW"
>
> # durbing
> model_fix_durbin <- spgm(y ~ x + x2 +lag_x + lag_x2,
> data=panel_dc_2010_2020.pd, listw = DCknn_7, model = "within",lag =
> TRUE,spatial.error = FALSE,moments="fullweights",method="ec2sls")
>
> # estimating impacts
> impacts(model_fix_durbin,tr=trMatc, R=200)
>
> Error in impacts(model_fix_durbin, tr = a, R = 200) :
>   could not find function "impacts"
>
>
> On Sat, May 27, 2023 at 10:58?AM Jose Funes <jefunes at gmail.com> wrote:
>
>> Thanks Professor Bivand and Josiah. See below, basic info and code:
>>
>> # Rstudio version and PC info
>>
>> platform       x86_64-w64-mingw32
>> arch           x86_64
>> os             mingw32
>> system         x86_64, mingw32
>> status
>> major          4
>> minor          1.2
>> year           2021
>> month          11
>> day            01
>> svn rev        81115
>> language       R
>> version.string R version 4.1.2 (2021-11-01)
>>
>>
>>
>> ####### code #####
>>
>> # Load necessary libraries
>> library(tigris)
>> library(splm)
>> library(spdep)
>> library(Matrix)
>> library(plm)
>>
>> # census tracts
>> dc_tracts_2018 <- tracts(state="DC",cb=TRUE, year=2018)
>> dc_tracts_2018$row.id <- 1:179
>>
>> # Spatial matrix
>> coords <- coordinates(dc_tracts_2018)
>> DC.knn_7 <- knearneigh(coords, k=7)
>> DC7_nb <- knn2nb(DC.knn_7)
>> DCknn_7 <- nb2listw(DC7_nb, style="W")
>>
>> # reproducible example
>> set.seed(123)
>> df2010 <- data.frame(
>>   y = rnorm(179),
>>   x = rnorm(179, mean=2),
>>   x2 = rnorm(179, mean = 3),
>>   year=2010,
>>   row.id = 1:179
>> )
>>
>> df2015 <- data.frame(
>>   y = rnorm(179),
>>   x = rnorm(179, mean=2.5),
>>   x2 = rnorm(179, mean = 3),
>>   year=2015,
>>   row.id = 1:179
>> )
>>
>> df2020 <- data.frame(
>>   y = rnorm(179),
>>   x = rnorm(179, mean=1.5),
>>   x2 = rnorm(179, mean = 3.5),
>>   year=2020,
>>   row.id = 1:179
>> )
>>
>>
>> # drop geom
>> st_geometry(dc_tracts_2018) <- NULL
>>
>> #list of data frame
>> df <- list(df2010,df2015,df2020)
>>
>> for (i in seq_along(df)) {
>>   df[[i]] <- merge(df[[i]], dc_tracts_2018, by = "row.id")
>>
>> }
>>
>> df2010 <- df[1]
>> df2015 <- df[2]
>> df2020 <- df[3]
>>
>> # merging
>> panel_dc_2010_2020 <- rbind(df2010[[1]], df2015[[1]], df2020[[1]])
>>
>> #### setting lag variables
>> panel_dc_2010_2020.pd<-pdata.frame(panel_dc_2010_2020, index=c("GEOID","year"))
>>
>> # lag variables
>> panel_dc_2010_2020.pd$lag_x <- slag(panel_dc_2010_2020.pd$x,listw=DCknn_7)
>> panel_dc_2010_2020.pd$lag_x2 <- slag(panel_dc_2010_2020.pd$x2,listw=DCknn_7)
>>
>> ## impacts
>> time1 <- length(unique(panel_dc_2010_2020$year))
>> s.lwtracts <- kronecker(Diagonal(time), listw2dgCMatrix(DCknn_7))
>> trMatc <- trW(s.lwtracts, type = "mult")
>>
>> Error in trW(s.lwtracts, type = "mult") : could not find function "trW"
>>
>> # durbin
>> model_fix_durbin <- spgm(y ~ x + x2 +lag_x + lag_x2,
>> data=panel_dc_2010_2020.pd, listw = DCknn_7, model = "within",lag =
>> TRUE,spatial.error = FALSE,moments="fullweights",method="ec2sls")
>>
>> # estimating impacts
>> impacts(model_fix_durbin,tr=trMatc, R=200)
>>
>> Error in impacts(model_fix_durbin, tr = a, R = 200) :
>>   could not find function "impacts"
>>
>>
>>
>>
>> On Fri, May 26, 2023 at 2:34?PM Roger Bivand <Roger.Bivand at nhh.no> wrote:
>>
>>> I think the example is using the splm package to fit a GMM model. It is
>>> now some years since spdep was split, with model fitting functions and
>>> methods moving to spatialreg. The latter has also been updated several
>>> times since then, so knowledge of versions of R and packages is essential,
>>> in addition to a reproducible example. Specifically,
>>> https://github.com/r-spatial/spatialreg/pull/16 changed impacts methods
>>> for sphet GMM, and other changes in impacts methods may have occurred:
>>> https://github.com/r-spatial/spatialreg/commits/main/R/impacts.R gives
>>> full details. Provide a fully reproducible example, best with built-in
>>> data, or raise an issue if you can see how any changes have impacted splm
>>> in ways that the splm maintainer did not anticipate.
>>>
>>> Hope this clarifies,
>>>
>>> Roger
>>>
>>> --
>>> Roger Bivand
>>> Emeritus Professor
>>> Norwegian School of Economics
>>> Postboks 3490 Ytre Sandviken, 5045 Bergen, Norway
>>> Roger.Bivand at nhh.no
>>>
>>> ________________________________________
>>> From: R-sig-Geo <r-sig-geo-bounces at r-project.org> on behalf of Josiah
>>> Parry <josiah.parry at gmail.com>
>>> Sent: 26 May 2023 20:14
>>> To: Jose Funes
>>> Cc: r-sig-geo at r-project.org
>>> Subject: Re: [R-sig-Geo]  Estimate impacts from a spgm - spatial panel
>>> regression model
>>>
>>> Jose have you built the model that you want impacts for using the
>>> spatialreg package? Additionally, it would be great if you provided a
>>> reproducible example for folks to try and replicate the behavior you are
>>> experiencing.
>>>
>>> On Fri, May 26, 2023 at 12:26?PM Jose Funes <jefunes at gmail.com> wrote:
>>>
>>> > Hi,
>>> > I would like to estimate the impacts of a spatial lag model output. It
>>> used
>>> > to work, but it does not work anymore. I used to work fine with the
>>> impacts
>>> > function in the spdep package, but it seems the function does not work
>>> any
>>> > longer. The second option was to load the spatialreg library and use
>>> the
>>> > impacts function, but I get an error message "object type not
>>> recognized".
>>> > Please advise.
>>> >
>>> > Jose Funes
>>> > Economic geographer
>>> > DC Office of Planning
>>> > 1100 4th Street SW, 20024
>>> >
>>> >         [[alternative HTML version deleted]]
>>> >
>>> > _______________________________________________
>>> > R-sig-Geo mailing list
>>> > R-sig-Geo at r-project.org
>>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> >
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>

	[[alternative HTML version deleted]]


From kev|n @end|ng |rom zembower@org  Thu Jun  1 21:16:51 2023
From: kev|n @end|ng |rom zembower@org (=?UTF-8?Q?Kevin_Zembower?=)
Date: Thu, 1 Jun 2023 19:16:51 +0000
Subject: [R-sig-Geo] Mapping census tracts with leaflet(): "sf layer has
 inconsistent datum" error
In-Reply-To: <CALrbzg2xo26AgcasG3qHS2JzKE6oti9Pmd+-v-fR=VG7f9sKTQ@mail.gmail.com>
References: <5a45b608-91b2-3aaf-5d39-d50c6b57c136@zembower.org> 
 <010001887367c22b-cfdf7f66-7212-4fe4-8dd5-001439a110f8-000000@email.amazonses.com>
 <CALrbzg2xo26AgcasG3qHS2JzKE6oti9Pmd+-v-fR=VG7f9sKTQ@mail.gmail.com> 
 <eb7c2040-10f0-ba4f-dc0a-b2dae6ac9a27@zembower.org>
Message-ID: <0100018878642e50-353938f9-4439-42ba-bd37-7c96aee1ed18-000000@email.amazonses.com>

Ben and Olivier, thank you so much for your help, and the additional 
resources you provided. You helped me not only fix my problem, but also 
to understand what caused it.

Thanks, again.

-Kevin

On 5/31/23 18:16, Ben Tupper wrote:
> Hi,
> 
> This is a great place to ask - and nice reproducible code!
> 
> You have a two issues as far as I can see.? First it seems you have 
> dropped the "4" in "WGS84".? And second you want to transform rw_pop, 
> not the output of leaflet().? The following works for me.
> 
> ## Start
> library(tidyverse)
> library(tidycensus)
> library(leaflet)
> library(sf)
> 
> rw_blocks <- c(3000, 3001, 3002, 3005, 3006, 3007, 3008, 3009, 3010, 3011)
> 
> rw_pop <- get_decennial(
>  ? geography = "block",
>  ? variables = "P1_001N",
>  ? year = 2020,
>  ? state = "MD",
>  ? county = "Baltimore city",
>  ? geometry = TRUE
> ) %>%
>  ? filter(substr(GEOID, 6, 11) == "271101" &
>  ? ? ? ? ? ?substr(GEOID, 12, 15) %in% rw_blocks
>  ? ) ## %>% st_transform('+proj=longlat +datum=WGS8')
> 
> (rw_pop_map <- rw_pop %>%
>  ? ? st_transform('+proj=longlat +datum=WGS84') %>%
>  ? ? leaflet() %>%
>  ? ? fitBounds(-76.616, 39.352, -76.610, 39.346) %>%
>  ? ? addTiles() %>%
>  ? ? addPolygons()
> )
> ## End
> 
> On Wed, May 31, 2023 at 4:03?PM Kevin Zembower via R-sig-Geo 
> <r-sig-geo at r-project.org <mailto:r-sig-geo at r-project.org>> wrote:
> 
>     Hello, all. Newbie to sf, tidycensus and the tidyverse here.
> 
>     First off, is this the appropriate list to ask this question? If not,
>     let me know and I'll go away.
> 
>     I'm trying to map census blocks for my neighborhood to a base map. I'm
>     using tidycensus to get the geometry of the census blocks, and leaflet
>     to map them to the OSM base maps. Mostly, this is going really well,
>     and
>     I'm very pleased with the speed of development (I just started this
>     morning) and results.
> 
>     However, I get this error:
> 
>      ? Warning message:
>     sf layer has inconsistent datum (+proj=longlat +datum=NAD83 +no_defs).
>     Need '+proj=longlat +datum=WGS84'
> 
>     I think I need to use st_transform, but can't get it to work.
> 
>     Here's a reproducible example, with some commented out lines of what
>     I've tried:
> 
>     ## Reproducible example:
>     library(tidyverse)
>     library(tidycensus)
>     library(leaflet)
>     library(sf)
> 
>     rw_blocks <- c(3000, 3001, 3002, 3005, 3006, 3007, 3008, 3009, 3010,
>     3011)
> 
>     rw_pop <- get_decennial(
>      ? ? ?geography = "block",
>      ? ? ?variables = "P1_001N",
>      ? ? ?year = 2020,
>      ? ? ?state = "MD",
>      ? ? ?county = "Baltimore city",
>      ? ? ?geometry = TRUE
>     ) %>%
>      ? ? ?filter(substr(GEOID, 6, 11) == "271101" &
>      ? ? ? ? ? ? substr(GEOID, 12, 15) %in% rw_blocks
>      ? ? ? ? ? ? ) ## %>% st_transform('+proj=longlat +datum=WGS8')
> 
>     (rw_pop_map <- rw_pop %>%
>      ? ? ?leaflet() %>%
>      ? ? ? ## st_transform('+proj=longlat +datum=WGS8') %>%
>      ? ? ?fitBounds(-76.616, 39.352, -76.610, 39.346) %>%
>      ? ? ?addTiles() %>%
>      ? ? ?addPolygons()
>      ? ? ?)
>     ## Error occurs when executing above block
> 
>     Can anyone offer me a hint as to how to resolve this error?
> 
>     Thanks so much for any advice and guidance.
> 
>     -Kevin
> 
>     _______________________________________________
>     R-sig-Geo mailing list
>     R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>     https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
> 



From kev|n @end|ng |rom zembower@org  Thu Jun  1 21:29:05 2023
From: kev|n @end|ng |rom zembower@org (=?UTF-8?Q?Kevin_Zembower?=)
Date: Thu, 1 Jun 2023 19:29:05 +0000
Subject: [R-sig-Geo] Adding a text-only label to a leaflet map?
References: <7f11954b-8267-020a-e78b-d81480b5f201@zembower.org>
Message-ID: <01000188786f61c0-6d87c708-6876-440c-b852-b5a581d738c5-000000@email.amazonses.com>

Hello, all,

With Ben and Olivier's help, I was able to plot my neighborhood's census 
blocks and tracts on an OSM base map, with leaflet, without warnings.

My next problem is labeling the polygons I've plotted. Here's an example 
of what I've tried so far:

## Reproducible example
library(tidycensus)
library(tidyverse)
library(sf)
library(tigris)
options(tigris_use_cache = TRUE)
library(leaflet)
library(leafem)

rw_tracts <- tracts(state = "MD",
                     county = "Baltimore city",
                     year = "2020") %>%
     filter(TRACTCE == "271101") %>%
     st_transform('+proj=longlat +datum=WGS84')

lopot = labelOptions(noHide = TRUE,
                      direction = 'top',
                      textOnly = TRUE)

rw_tracts %>%
     leaflet() %>%
     addTiles() %>%
     addPolygons(color = "#00E600") %>%
     ## addAwesomeMarkers(lng = -76.62, lat = 39.352,
     ##                   label = "2711.01",
     ##                   labelOptions(
     ##                       noHide = TRUE,
     ##                       direction = 'top',
     ##                       textOnly = TRUE,
     ##                       opacity = 1,
     ##                       textsize = "60px",
     ##                       style = list(
     ##                           "color" = "#FFFFFF", ## "#00E600",
     ##                           "font-weight" = "bold")
     ##                   ),
     ##                   options = markerOptions(
     ##                       ## interactive = FALSE,
     ##                       ## clickable = FALSE,
     ##                       ## draggable = FALSE,
     ##                       ## keyboard = FALSE,
     ##                   ),
     ## ) %>%
     addStaticLabels(
         lng = -76.63, lat = 39.36,
         label = "2711.01",
         style = list("color" = "#009900",
                      "font-weight" = "bold",
                      "font-size" = "60px")
     ) %>%
     addLabelOnlyMarkers(
         label = "2711.01",
         lng = -76.613, lat = 39.348,
         labelOptions(noHide = TRUE,
                      direction = 'top',
                      textOnly = TRUE,
                      opacity = 1,
                      textsize = "60px",
                      style = list("color" = "#FFFFFF", ## "#00E600",
                                   "font-weight" = "bold")
                      )
     )

So far, the addStaticLabels() example comes closest to what I want. 
However, I need to move the label to a different location, and it 
doesn't seem to respond to the lng and lat options (but doesn't throw an 
error, either). Also, I'm concerned that the leafem package comes with a 
warning that it's based on deprecated packages.

addAwesomeMarkers() put the marker when I wanted it, and my label 
appeared when I clicked or moused over it, but I just want a static label.

addLabelOnlyMarker() seems designed for my use-case, but I can't get 
anything to appear. Not sure what I'm doing wrong there.

Finally, all these methods seem like a lot of work. Am I overlooking 
something simple? I just need static text, that I can control the 
location, size and color of. Is this the way to do it?

Thanks, again, for your advice and guidance.

-Kevin


From kev|n @end|ng |rom zembower@org  Mon Jun  5 17:21:55 2023
From: kev|n @end|ng |rom zembower@org (=?UTF-8?Q?Kevin_Zembower?=)
Date: Mon, 5 Jun 2023 15:21:55 +0000
Subject: [R-sig-Geo] Adding Census polygons to OSM map?
References: <a0f13434-6d1d-a4ae-7663-f69203b7e272@zembower.org>
Message-ID: <010001888c268720-0632e469-6323-4ad8-a295-900a39dbb740-000000@email.amazonses.com>

Hello, again,

I've given up my work with leaflet, trying to map my neighborhood with 
US Census boundaries. Even though it was quick and easy to add the 
Census boundaries to the map, I couldn't create the labels I wanted (see 
https://stat.ethz.ch/pipermail/r-sig-geo/2023-June/029284.html). Also, 
it seems like leaflet added a lot of overhead that I didn't need, such 
as interactive maps. I just need a color printed 2D map for my use.

I'm now trying to work with tigris and OpenStreetMap, but I can't draw 
the US Census boundaries on the OSM map. Here's what I have so far:

==================================================
## Experiment, using sf:
library(tidyverse)
library(tigris)
options(tigris_use_cache = TRUE)
library(sf)
library(OpenStreetMap)
## library(sp)
## library(ggplot2)

lat_max <- 39.3525 #Distance from 39.35 to 39.34 = 0.691mi
long_max <- -76.617 #Distance from -76.61 to -76.62 = 0.5343 mi
lat_min <- 39.3455
long_min <- -76.6095
nw <- c(lat_max, long_max)
se <- c(lat_min, long_min)

rw_map <- openmap(nw, se,
                   type = "osm",
                   mergeTiles = TRUE) %>%
     openproj() %>%
     OpenStreetMap::autoplot.OpenStreetMap() +
     xlab("long") + ylab("lat")

rw_map

rw_tract <- tracts(state = "MD",
                     county = "Baltimore city",
                     year = "2020") %>%
     filter(NAME == "2711.01")
     ## openproj()
     ## st_transform('+proj=longlat +datum=WGS84')
     ## spTransform('osm')

OpenStreetMap::autoplot.OpenStreetMap(rw_tract, add = TRUE)
==================================================

The commented out sections show some of the things I've tried so far. 
I'd like to be able to draw the rw_tract geometry data on the rw_map 
image. What I'd like is a 'addPolygon()' function in OpenStreetMap, like 
I found in leaflet.

Can anyone offer me any suggestions or advice for accomplishing my task? 
Thanks so much.

-Kevin


From vero@ndreo @end|ng |rom gm@||@com  Tue Jun  6 15:53:38 2023
From: vero@ndreo @end|ng |rom gm@||@com (Veronica Andreo)
Date: Tue, 6 Jun 2023 10:53:38 -0300
Subject: [R-sig-Geo] rgrass7 to be removed by Oct 2023,
 consider moving to rgrass instead
Message-ID: <CAAMki4HRZvXOwE5NQBM-CvGwDoxj4oWYzkVSg-qzxrLm=-PL=w@mail.gmail.com>

Dear GRASS and R users,

[ the text below was contributed by Roger Bivand and it is published online
at: https://grass.osgeo.org/news/2023_06_05_retirement_of_rgrass7/ ]

The R package rgrass7 interfacing R and GRASS GIS will be removed from
active availability on the Comprehensive R Archive Network (CRAN) during
October 2023; it will be archived on CRAN. This is because the successor
rgrass package has been available since mid-2022, and because the rgdal
package on which rgrass7 depends for exchanging files between R and GRASS
GIS will also be archived in October 2023, as described in R-spatial
evolution project [0] reports [1].

The main change between rgrass7 and rgrass is that terra is used in place
of rgdal for file transfer between R and GRASS. rgrass7 functions have been
marked asdeprecated for almost a year now, and maintainers of packages
using rgrass7 have been notified. Please also refer to
https://rsbivand.github.io/foss4g_2022/modernizing_220822.html for more
details.

A special thanks to Roger for your commitment and contributions!!

Vero

[0]
https://www.r-consortium.org/all-projects/awarded-projects/2021-group-2#Preparing%20CRAN%20for%20the%20Retirement%20of%20rgdal,%20rgeos%20and%20maptools
[1] https://r-spatial.org/r/2023/05/15/evolution4.html

-- 
Dra. Ver?nica Andreo
Investigadora Asistente de CONICET
Instituto Gulich (CONAE - UNC)
Centro Espacial Te?filo Tabanera (CETT)
Falda del Ca?ete - C?rdoba, Argentina
+54 3547 400000 int. 1153
https://veroandreo.gitlab.io/

	[[alternative HTML version deleted]]


From Roger@B|v@nd @end|ng |rom nhh@no  Tue Jun  6 19:19:25 2023
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Tue, 6 Jun 2023 17:19:25 +0000
Subject: [R-sig-Geo] rgrass7 to be removed by Oct 2023,
 consider moving to rgrass instead
Message-ID: <SV0P279MB04758E754F99D7F804E72D77EE52A@SV0P279MB0475.NORP279.PROD.OUTLOOK.COM>

Dear GRASS and R users,

[ the text below was contributed by Roger Bivand and it is published online at: https://grass.osgeo.org/news/2023_06_05_retirement_of_rgrass7/ ]

The R package rgrass7 interfacing R and GRASS GIS will be removed from active availability on the Comprehensive R Archive Network (CRAN) during October 2023; it will be archived on CRAN. This is because the successor rgrass package has been available since mid-2022, and because the rgdal package on which rgrass7 depends for exchanging files between R and GRASS GIS will also be archived in October 2023, as described in R-spatial evolution project [0] reports [1].

The main change between rgrass7 and rgrass is that terra is used in place of rgdal for file transfer between R and GRASS. rgrass7 functions have been marked asdeprecated for almost a year now, and maintainers of packages using rgrass7 have been notified. Please also refer to https://rsbivand.github.io/foss4g_2022/modernizing_220822.html for more details.

Roger

[0] https://www.r-consortium.org/all-projects/awarded-projects/2021-group-2#Preparing%20CRAN%20for%20the%20Retirement%20of%20rgdal,%20rgeos%20and%20maptools
[1] https://r-spatial.org/r/2023/05/15/evolution4.html

--
Roger Bivand
Emeritus Professor
Norwegian School of Economics
Postboks 3490 Ytre Sandviken, 5045 Bergen, Norway
Roger.Bivand at nhh.no

From t|m@how@rd @end|ng |rom dec@ny@gov  Wed Jun  7 16:57:00 2023
From: t|m@how@rd @end|ng |rom dec@ny@gov (Howard, Tim G (DEC))
Date: Wed, 7 Jun 2023 14:57:00 +0000
Subject: [R-sig-Geo] Adding Census polygons to OSM map?
In-Reply-To: <010001888c268720-0632e469-6323-4ad8-a295-900a39dbb740-000000@email.amazonses.com>
References: <a0f13434-6d1d-a4ae-7663-f69203b7e272@zembower.org>
 <010001888c268720-0632e469-6323-4ad8-a295-900a39dbb740-000000@email.amazonses.com>
Message-ID: <SA1PR09MB779221560C63CA8B1B56B7A0A853A@SA1PR09MB7792.namprd09.prod.outlook.com>

Kevin,
the tmap? package might be what you are looking for.

https://cran.r-project.org/web/packages/tmap/vignettes/tmap-getstarted.html

https://cran.r-project.org/web/packages/tmap/index.html


Cheers,
Tim

From: R-sig-Geo <r-sig-geo-bounces at r-project.org> on behalf of Kevin Zembower via R-sig-Geo <r-sig-geo at r-project.org>
Sent: Monday, June 5, 2023 11:21 AM
To: r-sig-geo at r-project.org <r-sig-geo at r-project.org>
Subject: [R-sig-Geo] Adding Census polygons to OSM map?

ATTENTION: This email came from an external source. Do not open attachments or click on links from unknown senders or unexpected emails.


Hello, again,

I've given up my work with leaflet, trying to map my neighborhood with
US Census boundaries. Even though it was quick and easy to add the
Census boundaries to the map, I couldn't create the labels I wanted (see
https://stat.ethz.ch/pipermail/r-sig-geo/2023-June/029284.html). Also,
it seems like leaflet added a lot of overhead that I didn't need, such
as interactive maps. I just need a color printed 2D map for my use.

I'm now trying to work with tigris and OpenStreetMap, but I can't draw
the US Census boundaries on the OSM map. Here's what I have so far:

==================================================
## Experiment, using sf:
library(tidyverse)
library(tigris)
options(tigris_use_cache = TRUE)
library(sf)
library(OpenStreetMap)
## library(sp)
## library(ggplot2)

lat_max <- 39.3525 #Distance from 39.35 to 39.34 = 0.691mi
long_max <- -76.617 #Distance from -76.61 to -76.62 = 0.5343 mi
lat_min <- 39.3455
long_min <- -76.6095
nw <- c(lat_max, long_max)
se <- c(lat_min, long_min)

rw_map <- openmap(nw, se,
                   type = "osm",
                   mergeTiles = TRUE) %>%
     openproj() %>%
     OpenStreetMap::autoplot.OpenStreetMap() +
     xlab("long") + ylab("lat")

rw_map

rw_tract <- tracts(state = "MD",
                     county = "Baltimore city",
                     year = "2020") %>%
     filter(NAME == "2711.01")
     ## openproj()
     ## st_transform('+proj=longlat +datum=WGS84')
     ## spTransform('osm')

OpenStreetMap::autoplot.OpenStreetMap(rw_tract, add = TRUE)
==================================================

The commented out sections show some of the things I've tried so far.
I'd like to be able to draw the rw_tract geometry data on the rw_map
image. What I'd like is a 'addPolygon()' function in OpenStreetMap, like
I found in leaflet.

Can anyone offer me any suggestions or advice for accomplishing my task?
Thanks so much.

-Kevin

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

From kev|n @end|ng |rom zembower@org  Wed Jun  7 23:59:03 2023
From: kev|n @end|ng |rom zembower@org (=?UTF-8?Q?Kevin_Zembower?=)
Date: Wed, 7 Jun 2023 21:59:03 +0000
Subject: [R-sig-Geo] Adding Census polygons to OSM map?
In-Reply-To: <SA1PR09MB779221560C63CA8B1B56B7A0A853A@SA1PR09MB7792.namprd09.prod.outlook.com>
References: <a0f13434-6d1d-a4ae-7663-f69203b7e272@zembower.org> 
 <010001888c268720-0632e469-6323-4ad8-a295-900a39dbb740-000000@email.amazonses.com>
 <SA1PR09MB779221560C63CA8B1B56B7A0A853A@SA1PR09MB7792.namprd09.prod.outlook.com>
 <69686fb5-81da-5ac2-651b-88cea3b19fb3@zembower.org>
Message-ID: <0100018897ded49a-88ee8c14-aece-42c6-a7b5-5dc1516b26b0-000000@email.amazonses.com>

Tim, thank you very much. Yes, tmap seems to be moving in the right 
direction for me. This is what I can do with it so far:
=====================================
## Trying with tmap:
library(tidyverse)
library(sf)
library(tmap)
library(terra)
library(spData)
library(spDataLarge)
library(tigris)
options(tigris_use_cache = TRUE)
library(OpenStreetMap)

## Get an Open Street Map:
rw_map <- openmap(nw, se,
                   type = "osm",
                   mergeTiles = TRUE) %>%
     openproj(projection = "+proj=longlat +ellps=WGS84 +datum=WGS84 
+no_defs")

## Get an example census map:
rw_tract <- tracts(state = "MD",
                    county = "Baltimore city",
                    year = "2020") %>%
     filter(NAME == "2711.01")

ttm()

## Quick Tmap; also works:
qtm(rw_tract)

## Also works. _polygons combines _fill and _borders:
tm_shape(rw_tract) +
     tm_polygons()

## Works:
tm_shape(rw_tract) +
     tm_polygons(alpha = 0.2, col = "green") +
     tm_scale_bar() +
     tm_layout(title = "Radnor-Winston Neighborhood") +
     tm_basemap(server = "OpenStreetMap")

=======================================

So, in that last example, I can plot the basemap from Open Street Maps 
with the Census tract on top of it. However, from what I've learned so 
far (just about 4 hours of study), tm_basemap() only works with 
interactive maps that are 'viewed' (in a browser as HTML) rather than 
plotted (printed). I don't understand why I can't just get the 
appearance I want without all the unwanted interactivity features.

To take it a step further, I don't understand why I can't just plot both 
the basemap and the census tract with something like plot() (from 
ggplot) and sf.

Thanks, again, Tim, for your suggestion. I think it's moving me in the 
right direction.

-Kevin

On 6/7/23 10:57, Howard, Tim G (DEC) wrote:
> Kevin,
> the tmap? package might be what you are looking for.
> 
> https://cran.r-project.org/web/packages/tmap/vignettes/tmap-getstarted.html
> 
> https://cran.r-project.org/web/packages/tmap/index.html
> 
> 
> Cheers,
> Tim
> 
> From: R-sig-Geo <r-sig-geo-bounces at r-project.org> on behalf of Kevin Zembower via R-sig-Geo <r-sig-geo at r-project.org>
> Sent: Monday, June 5, 2023 11:21 AM
> To: r-sig-geo at r-project.org <r-sig-geo at r-project.org>
> Subject: [R-sig-Geo] Adding Census polygons to OSM map?
> 
> ATTENTION: This email came from an external source. Do not open attachments or click on links from unknown senders or unexpected emails.
> 
> 
> Hello, again,
> 
> I've given up my work with leaflet, trying to map my neighborhood with
> US Census boundaries. Even though it was quick and easy to add the
> Census boundaries to the map, I couldn't create the labels I wanted (see
> https://stat.ethz.ch/pipermail/r-sig-geo/2023-June/029284.html). Also,
> it seems like leaflet added a lot of overhead that I didn't need, such
> as interactive maps. I just need a color printed 2D map for my use.
> 
> I'm now trying to work with tigris and OpenStreetMap, but I can't draw
> the US Census boundaries on the OSM map. Here's what I have so far:
> 
> ==================================================
> ## Experiment, using sf:
> library(tidyverse)
> library(tigris)
> options(tigris_use_cache = TRUE)
> library(sf)
> library(OpenStreetMap)
> ## library(sp)
> ## library(ggplot2)
> 
> lat_max <- 39.3525 #Distance from 39.35 to 39.34 = 0.691mi
> long_max <- -76.617 #Distance from -76.61 to -76.62 = 0.5343 mi
> lat_min <- 39.3455
> long_min <- -76.6095
> nw <- c(lat_max, long_max)
> se <- c(lat_min, long_min)
> 
> rw_map <- openmap(nw, se,
>                     type = "osm",
>                     mergeTiles = TRUE) %>%
>       openproj() %>%
>       OpenStreetMap::autoplot.OpenStreetMap() +
>       xlab("long") + ylab("lat")
> 
> rw_map
> 
> rw_tract <- tracts(state = "MD",
>                       county = "Baltimore city",
>                       year = "2020") %>%
>       filter(NAME == "2711.01")
>       ## openproj()
>       ## st_transform('+proj=longlat +datum=WGS84')
>       ## spTransform('osm')
> 
> OpenStreetMap::autoplot.OpenStreetMap(rw_tract, add = TRUE)
> ==================================================
> 
> The commented out sections show some of the things I've tried so far.
> I'd like to be able to draw the rw_tract geometry data on the rw_map
> image. What I'd like is a 'addPolygon()' function in OpenStreetMap, like
> I found in leaflet.
> 
> Can anyone offer me any suggestions or advice for accomplishing my task?
> Thanks so much.
> 
> -Kevin
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From t|m@how@rd @end|ng |rom dec@ny@gov  Thu Jun  8 14:53:26 2023
From: t|m@how@rd @end|ng |rom dec@ny@gov (Howard, Tim G (DEC))
Date: Thu, 8 Jun 2023 12:53:26 +0000
Subject: [R-sig-Geo] Adding Census polygons to OSM map?
In-Reply-To: <0100018897ded49a-88ee8c14-aece-42c6-a7b5-5dc1516b26b0-000000@email.amazonses.com>
References: <a0f13434-6d1d-a4ae-7663-f69203b7e272@zembower.org>
 <010001888c268720-0632e469-6323-4ad8-a295-900a39dbb740-000000@email.amazonses.com>
 <SA1PR09MB779221560C63CA8B1B56B7A0A853A@SA1PR09MB7792.namprd09.prod.outlook.com>
 <69686fb5-81da-5ac2-651b-88cea3b19fb3@zembower.org>
 <0100018897ded49a-88ee8c14-aece-42c6-a7b5-5dc1516b26b0-000000@email.amazonses.com>
Message-ID: <SA1PR09MB7792F505B00FFA2E2E84BD5EA850A@SA1PR09MB7792.namprd09.prod.outlook.com>

Kevin, 
To get the basemap in plot mode you need to download the tiles using read_osm. This works for me, I 
Simplified a bit:

library(sf)
library(tmap)
library(tigris)
options(tigris_use_cache = TRUE)
library(tmaptools)

## Get an example census map:
rw_tract <- tracts(state = "MD",
                   county = "Baltimore city",
                   year = "2020") 
rw_tract <- rw_tract[rw_tract$NAME == "2711.01",]

# for some reason had to re-jigger the box a bit.
# also note your longitudes were backwards. 
lat_max <- 39.36 
long_min <- -76.63
lat_min <- 39.34 
long_max <- -76.60 

bbox <- bb(c(xmin=long_min, ymin=lat_min, xmax=long_max, ymax=lat_max))

basem <- read_osm(bbox)

tmap_mode("plot")

myMap <- tm_shape(basem) +
  tm_rgb() +
  tm_shape(rw_tract) +
  tm_polygons(alpha = 0.2, col = "green") + 
  tm_scale_bar() +
  tm_layout(title = "Radnor-Winston Neighborhood")

# check it out
myMap
# save it. 
tmap_save(myMap, "c:/temp/myMapOut.jpg")


Hope that helps. 
Tim






> -----Original Message-----
> From: Kevin Zembower <kevin at zembower.org>
> Sent: Wednesday, June 7, 2023 5:59 PM
> To: Howard, Tim G (DEC) <tim.howard at dec.ny.gov>; r-sig-geo at r-
> project.org
> Subject: Re: Adding Census polygons to OSM map?
> 
> ATTENTION: This email came from an external source. Do not open
> attachments or click on links from unknown senders or unexpected emails.
> 
> 
> Tim, thank you very much. Yes, tmap seems to be moving in the right
> direction for me. This is what I can do with it so far:
> =====================================
> ## Trying with tmap:
> library(tidyverse)
> library(sf)
> library(tmap)
> library(terra)
> library(spData)
> library(spDataLarge)
> library(tigris)
> options(tigris_use_cache = TRUE)
> library(OpenStreetMap)
> 
> ## Get an Open Street Map:
> rw_map <- openmap(nw, se,
>                    type = "osm",
>                    mergeTiles = TRUE) %>%
>      openproj(projection = "+proj=longlat +ellps=WGS84 +datum=WGS84
> +no_defs")
> 
> ## Get an example census map:
> rw_tract <- tracts(state = "MD",
>                     county = "Baltimore city",
>                     year = "2020") %>%
>      filter(NAME == "2711.01")
> 
> ttm()
> 
> ## Quick Tmap; also works:
> qtm(rw_tract)
> 
> ## Also works. _polygons combines _fill and _borders:
> tm_shape(rw_tract) +
>      tm_polygons()
> 
> ## Works:
> tm_shape(rw_tract) +
>      tm_polygons(alpha = 0.2, col = "green") +
>      tm_scale_bar() +
>      tm_layout(title = "Radnor-Winston Neighborhood") +
>      tm_basemap(server = "OpenStreetMap")
> 
> =======================================
> 
> So, in that last example, I can plot the basemap from Open Street Maps with
> the Census tract on top of it. However, from what I've learned so far (just
> about 4 hours of study), tm_basemap() only works with interactive maps
> that are 'viewed' (in a browser as HTML) rather than plotted (printed). I don't
> understand why I can't just get the appearance I want without all the
> unwanted interactivity features.
> 
> To take it a step further, I don't understand why I can't just plot both the
> basemap and the census tract with something like plot() (from
> ggplot) and sf.
> 
> Thanks, again, Tim, for your suggestion. I think it's moving me in the right
> direction.
> 
> -Kevin
> 
> On 6/7/23 10:57, Howard, Tim G (DEC) wrote:
> > Kevin,
> > the tmap? package might be what you are looking for.
> >
> > https://gcc02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fcran
> > .r-project.org%2Fweb%2Fpackages%2Ftmap%2Fvignettes%2Ftmap-
> getstarted.h
> >
> tml&data=05%7C01%7Ctim.howard%40dec.ny.gov%7C4d3f99e6eeff4493a3a
> 108db6
> >
> 7a26858%7Cf46cb8ea79004d108ceb80e8c1c81ee7%7C0%7C0%7C63821771946
> 393381
> >
> 9%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzI
> iLCJBTiI6
> >
> Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=MY4b3C%2Bqm7w
> ycxiX%2F3ww5
> > zMLltw59fmCgQTAeSxGu60%3D&reserved=0
> >
> > https://gcc02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fcran
> > .r-
> project.org%2Fweb%2Fpackages%2Ftmap%2Findex.html&data=05%7C01%7
> Ctim
> >
> .howard%40dec.ny.gov%7C4d3f99e6eeff4493a3a108db67a26858%7Cf46cb8e
> a7900
> >
> 4d108ceb80e8c1c81ee7%7C0%7C0%7C638217719463933819%7CUnknown%7
> CTWFpbGZs
> >
> b3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn
> 0%3D
> >
> %7C3000%7C%7C%7C&sdata=R61uJO4g0WW1GLh47uXGCB%2FX6%2B9grO4
> WYue3XxkfdQ0
> > %3D&reserved=0
> >
> >
> > Cheers,
> > Tim
> >
> > From: R-sig-Geo <r-sig-geo-bounces at r-project.org> on behalf of Kevin
> > Zembower via R-sig-Geo <r-sig-geo at r-project.org>
> > Sent: Monday, June 5, 2023 11:21 AM
> > To: r-sig-geo at r-project.org <r-sig-geo at r-project.org>
> > Subject: [R-sig-Geo] Adding Census polygons to OSM map?
> >
> > ATTENTION: This email came from an external source. Do not open
> attachments or click on links from unknown senders or unexpected emails.
> >
> >
> > Hello, again,
> >
> > I've given up my work with leaflet, trying to map my neighborhood with
> > US Census boundaries. Even though it was quick and easy to add the
> > Census boundaries to the map, I couldn't create the labels I wanted
> > (see
> > https://gcc02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat
> > .ethz.ch%2Fpipermail%2Fr-sig-geo%2F2023-
> June%2F029284.html&data=05%7C01%7Ctim.howard%40dec.ny.gov%7C4d3f
> 99e6eeff4493a3a108db67a26858%7Cf46cb8ea79004d108ceb80e8c1c81ee7%7
> C0%7C0%7C638217719464245369%7CUnknown%7CTWFpbGZsb3d8eyJWIjoi
> MC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C300
> 0%7C%7C%7C&sdata=pQUYMZs%2FRsLeotKUB0XduKCkpq6Ir0Vq3VPsAZ8eT
> Yk%3D&reserved=0). Also, it seems like leaflet added a lot of overhead that I
> didn't need, such as interactive maps. I just need a color printed 2D map for
> my use.
> >
> > I'm now trying to work with tigris and OpenStreetMap, but I can't draw
> > the US Census boundaries on the OSM map. Here's what I have so far:
> >
> > ==================================================
> > ## Experiment, using sf:
> > library(tidyverse)
> > library(tigris)
> > options(tigris_use_cache = TRUE)
> > library(sf)
> > library(OpenStreetMap)
> > ## library(sp)
> > ## library(ggplot2)
> >
> > lat_max <- 39.3525 #Distance from 39.35 to 39.34 = 0.691mi long_max <-
> > -76.617 #Distance from -76.61 to -76.62 = 0.5343 mi lat_min <- 39.3455
> > long_min <- -76.6095 nw <- c(lat_max, long_max) se <- c(lat_min,
> > long_min)
> >
> > rw_map <- openmap(nw, se,
> >                     type = "osm",
> >                     mergeTiles = TRUE) %>%
> >       openproj() %>%
> >       OpenStreetMap::autoplot.OpenStreetMap() +
> >       xlab("long") + ylab("lat")
> >
> > rw_map
> >
> > rw_tract <- tracts(state = "MD",
> >                       county = "Baltimore city",
> >                       year = "2020") %>%
> >       filter(NAME == "2711.01")
> >       ## openproj()
> >       ## st_transform('+proj=longlat +datum=WGS84')
> >       ## spTransform('osm')
> >
> > OpenStreetMap::autoplot.OpenStreetMap(rw_tract, add = TRUE)
> > ==================================================
> >
> > The commented out sections show some of the things I've tried so far.
> > I'd like to be able to draw the rw_tract geometry data on the rw_map
> > image. What I'd like is a 'addPolygon()' function in OpenStreetMap,
> > like I found in leaflet.
> >
> > Can anyone offer me any suggestions or advice for accomplishing my task?
> > Thanks so much.
> >
> > -Kevin
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://gcc02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat
> > .ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-
> geo&data=05%7C01%7Ctim.howard%40
> >
> dec.ny.gov%7C4d3f99e6eeff4493a3a108db67a26858%7Cf46cb8ea79004d108c
> eb80
> >
> e8c1c81ee7%7C0%7C0%7C638217719464245369%7CUnknown%7CTWFpbGZs
> b3d8eyJWIj
> >
> oiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3
> 000%7C
> >
> %7C%7C&sdata=RVBbcRMpZINzm0yoMZuwfisK575l3hiQzYSAUiG9U4E%3D&r
> eserved=0


From t|m@how@rd @end|ng |rom dec@ny@gov  Thu Jun  8 15:07:03 2023
From: t|m@how@rd @end|ng |rom dec@ny@gov (Howard, Tim G (DEC))
Date: Thu, 8 Jun 2023 13:07:03 +0000
Subject: [R-sig-Geo] Adding Census polygons to OSM map?
In-Reply-To: <SA1PR09MB7792F505B00FFA2E2E84BD5EA850A@SA1PR09MB7792.namprd09.prod.outlook.com>
References: <a0f13434-6d1d-a4ae-7663-f69203b7e272@zembower.org>
 <010001888c268720-0632e469-6323-4ad8-a295-900a39dbb740-000000@email.amazonses.com>
 <SA1PR09MB779221560C63CA8B1B56B7A0A853A@SA1PR09MB7792.namprd09.prod.outlook.com>
 <69686fb5-81da-5ac2-651b-88cea3b19fb3@zembower.org>
 <0100018897ded49a-88ee8c14-aece-42c6-a7b5-5dc1516b26b0-000000@email.amazonses.com>
 <SA1PR09MB7792F505B00FFA2E2E84BD5EA850A@SA1PR09MB7792.namprd09.prod.outlook.com>
Message-ID: <SA1PR09MB7792FC9FB55D621C40C4D5FBA850A@SA1PR09MB7792.namprd09.prod.outlook.com>

And I just realized an easier way to get a bounding box for the basemap is to use the spatial information
you already have in the polygon:

basem <- read_osm(bb(rw_tract, ext = 1.5))

The 'ext' option allows you to expand a certain amount beyond the neighborhood polygon.
You can modify it to your liking.  And skip the lat/lon shenanigans.

Cheers,
Tim

> -----Original Message-----
> From: R-sig-Geo <r-sig-geo-bounces at r-project.org> On Behalf Of Howard,
> Tim G (DEC) via R-sig-Geo
> Sent: Thursday, June 8, 2023 8:53 AM
> To: Kevin Zembower <kevin at zembower.org>; r-sig-geo at r-project.org
> Subject: Re: [R-sig-Geo] Adding Census polygons to OSM map?
>
> ATTENTION: This email came from an external source. Do not open
> attachments or click on links from unknown senders or unexpected emails.
>
>
> Kevin,
> To get the basemap in plot mode you need to download the tiles using
> read_osm. This works for me, I Simplified a bit:
>
> library(sf)
> library(tmap)
> library(tigris)
> options(tigris_use_cache = TRUE)
> library(tmaptools)
>
> ## Get an example census map:
> rw_tract <- tracts(state = "MD",
>                    county = "Baltimore city",
>                    year = "2020")
> rw_tract <- rw_tract[rw_tract$NAME == "2711.01",]
>
> # for some reason had to re-jigger the box a bit.
> # also note your longitudes were backwards.
> lat_max <- 39.36
> long_min <- -76.63
> lat_min <- 39.34
> long_max <- -76.60
>
> bbox <- bb(c(xmin=long_min, ymin=lat_min, xmax=long_max,
> ymax=lat_max))
>
> basem <- read_osm(bbox)
>
> tmap_mode("plot")
>
> myMap <- tm_shape(basem) +
>   tm_rgb() +
>   tm_shape(rw_tract) +
>   tm_polygons(alpha = 0.2, col = "green") +
>   tm_scale_bar() +
>   tm_layout(title = "Radnor-Winston Neighborhood")
>
> # check it out
> myMap
> # save it.
> tmap_save(myMap, "c:/temp/myMapOut.jpg")
>
>
> Hope that helps.
> Tim
>
>
>
>
>
>
> > -----Original Message-----
> > From: Kevin Zembower <kevin at zembower.org>
> > Sent: Wednesday, June 7, 2023 5:59 PM
> > To: Howard, Tim G (DEC) <tim.howard at dec.ny.gov>; r-sig-geo at r-
> > project.org
> > Subject: Re: Adding Census polygons to OSM map?
> >
> > ATTENTION: This email came from an external source. Do not open
> > attachments or click on links from unknown senders or unexpected emails.
> >
> >
> > Tim, thank you very much. Yes, tmap seems to be moving in the right
> > direction for me. This is what I can do with it so far:
> > =====================================
> > ## Trying with tmap:
> > library(tidyverse)
> > library(sf)
> > library(tmap)
> > library(terra)
> > library(spData)
> > library(spDataLarge)
> > library(tigris)
> > options(tigris_use_cache = TRUE)
> > library(OpenStreetMap)
> >
> > ## Get an Open Street Map:
> > rw_map <- openmap(nw, se,
> >                    type = "osm",
> >                    mergeTiles = TRUE) %>%
> >      openproj(projection = "+proj=longlat +ellps=WGS84 +datum=WGS84
> > +no_defs")
> >
> > ## Get an example census map:
> > rw_tract <- tracts(state = "MD",
> >                     county = "Baltimore city",
> >                     year = "2020") %>%
> >      filter(NAME == "2711.01")
> >
> > ttm()
> >
> > ## Quick Tmap; also works:
> > qtm(rw_tract)
> >
> > ## Also works. _polygons combines _fill and _borders:
> > tm_shape(rw_tract) +
> >      tm_polygons()
> >
> > ## Works:
> > tm_shape(rw_tract) +
> >      tm_polygons(alpha = 0.2, col = "green") +
> >      tm_scale_bar() +
> >      tm_layout(title = "Radnor-Winston Neighborhood") +
> >      tm_basemap(server = "OpenStreetMap")
> >
> > =======================================
> >
> > So, in that last example, I can plot the basemap from Open Street Maps
> > with the Census tract on top of it. However, from what I've learned so
> > far (just about 4 hours of study), tm_basemap() only works with
> > interactive maps that are 'viewed' (in a browser as HTML) rather than
> > plotted (printed). I don't understand why I can't just get the
> > appearance I want without all the unwanted interactivity features.
> >
> > To take it a step further, I don't understand why I can't just plot
> > both the basemap and the census tract with something like plot() (from
> > ggplot) and sf.
> >
> > Thanks, again, Tim, for your suggestion. I think it's moving me in the
> > right direction.
> >
> > -Kevin
> >
> > On 6/7/23 10:57, Howard, Tim G (DEC) wrote:
> > > Kevin,
> > > the tmap? package might be what you are looking for.
> > >
> > > https://cr/
> > >
> an%2F&data=05%7C01%7Ctim.howard%40dec.ny.gov%7Cbe436282b0844b9c
> a99a0
> > >
> 8db681f6989%7Cf46cb8ea79004d108ceb80e8c1c81ee7%7C0%7C0%7C6382182
> 5635
> > >
> 1940428%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV
> 2luMzIi
> > >
> LCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=X4Cm12TD
> 2iIH498
> > > sJlRMPzOFz7IX9XuVdhGX8%2FO0Lv4%3D&reserved=0
> > > .r-project.org%2Fweb%2Fpackages%2Ftmap%2Fvignettes%2Ftmap-
> > getstarted.h
> > >
> >
> tml&data=05%7C01%7Ctim.howard%40dec.ny.gov%7C4d3f99e6eeff4493a3a
> > 108db6
> > >
> >
> 7a26858%7Cf46cb8ea79004d108ceb80e8c1c81ee7%7C0%7C0%7C63821771946
> > 393381
> > >
> >
> 9%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzI
> > iLCJBTiI6
> > >
> >
> Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=MY4b3C%2Bqm7w
> > ycxiX%2F3ww5
> > > zMLltw59fmCgQTAeSxGu60%3D&reserved=0
> > >
> > > https://cr/
> > >
> an%2F&data=05%7C01%7Ctim.howard%40dec.ny.gov%7Cbe436282b0844b9c
> a99a0
> > >
> 8db681f6989%7Cf46cb8ea79004d108ceb80e8c1c81ee7%7C0%7C0%7C6382182
> 5635
> > >
> 1940428%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV
> 2luMzIi
> > >
> LCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=X4Cm12TD
> 2iIH498
> > > sJlRMPzOFz7IX9XuVdhGX8%2FO0Lv4%3D&reserved=0
> > > .r-
> >
> project.org%2Fweb%2Fpackages%2Ftmap%2Findex.html&data=05%7C01%7
> > Ctim
> > >
> >
> .howard%40dec.ny.gov%7C4d3f99e6eeff4493a3a108db67a26858%7Cf46cb8e
> > a7900
> > >
> >
> 4d108ceb80e8c1c81ee7%7C0%7C0%7C638217719463933819%7CUnknown%7
> > CTWFpbGZs
> > >
> >
> b3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn
> > 0%3D
> > >
> >
> %7C3000%7C%7C%7C&sdata=R61uJO4g0WW1GLh47uXGCB%2FX6%2B9grO4
> > WYue3XxkfdQ0
> > > %3D&reserved=0
> > >
> > >
> > > Cheers,
> > > Tim
> > >
> > > From: R-sig-Geo <r-sig-geo-bounces at r-project.org> on behalf of Kevin
> > > Zembower via R-sig-Geo <r-sig-geo at r-project.org>
> > > Sent: Monday, June 5, 2023 11:21 AM
> > > To: r-sig-geo at r-project.org <r-sig-geo at r-project.org>
> > > Subject: [R-sig-Geo] Adding Census polygons to OSM map?
> > >
> > > ATTENTION: This email came from an external source. Do not open
> > attachments or click on links from unknown senders or unexpected emails.
> > >
> > >
> > > Hello, again,
> > >
> > > I've given up my work with leaflet, trying to map my neighborhood
> > > with US Census boundaries. Even though it was quick and easy to add
> > > the Census boundaries to the map, I couldn't create the labels I
> > > wanted (see
> > > https://st/
> > >
> at%2F&data=05%7C01%7Ctim.howard%40dec.ny.gov%7Cbe436282b0844b9c
> a99a0
> > >
> 8db681f6989%7Cf46cb8ea79004d108ceb80e8c1c81ee7%7C0%7C0%7C6382182
> 5635
> > >
> 1940428%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV
> 2luMzIi
> > >
> LCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=QJgBzdN0a
> pmJ61x
> > > gwFp8pY3WQLOSTjt2YVdJGX681q0%3D&reserved=0
> > > .ethz.ch%2Fpipermail%2Fr-sig-geo%2F2023-
> >
> June%2F029284.html&data=05%7C01%7Ctim.howard%40dec.ny.gov%7C4d3f
> >
> 99e6eeff4493a3a108db67a26858%7Cf46cb8ea79004d108ceb80e8c1c81ee7%7
> >
> C0%7C0%7C638217719464245369%7CUnknown%7CTWFpbGZsb3d8eyJWIjoi
> >
> MC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C300
> >
> 0%7C%7C%7C&sdata=pQUYMZs%2FRsLeotKUB0XduKCkpq6Ir0Vq3VPsAZ8eT
> > Yk%3D&reserved=0). Also, it seems like leaflet added a lot of overhead
> > that I didn't need, such as interactive maps. I just need a color
> > printed 2D map for my use.
> > >
> > > I'm now trying to work with tigris and OpenStreetMap, but I can't
> > > draw the US Census boundaries on the OSM map. Here's what I have so
> far:
> > >
> > > ==================================================
> > > ## Experiment, using sf:
> > > library(tidyverse)
> > > library(tigris)
> > > options(tigris_use_cache = TRUE)
> > > library(sf)
> > > library(OpenStreetMap)
> > > ## library(sp)
> > > ## library(ggplot2)
> > >
> > > lat_max <- 39.3525 #Distance from 39.35 to 39.34 = 0.691mi long_max
> > > <-
> > > -76.617 #Distance from -76.61 to -76.62 = 0.5343 mi lat_min <-
> > > 39.3455 long_min <- -76.6095 nw <- c(lat_max, long_max) se <-
> > > c(lat_min,
> > > long_min)
> > >
> > > rw_map <- openmap(nw, se,
> > >                     type = "osm",
> > >                     mergeTiles = TRUE) %>%
> > >       openproj() %>%
> > >       OpenStreetMap::autoplot.OpenStreetMap() +
> > >       xlab("long") + ylab("lat")
> > >
> > > rw_map
> > >
> > > rw_tract <- tracts(state = "MD",
> > >                       county = "Baltimore city",
> > >                       year = "2020") %>%
> > >       filter(NAME == "2711.01")
> > >       ## openproj()
> > >       ## st_transform('+proj=longlat +datum=WGS84')
> > >       ## spTransform('osm')
> > >
> > > OpenStreetMap::autoplot.OpenStreetMap(rw_tract, add = TRUE)
> > > ==================================================
> > >
> > > The commented out sections show some of the things I've tried so far.
> > > I'd like to be able to draw the rw_tract geometry data on the rw_map
> > > image. What I'd like is a 'addPolygon()' function in OpenStreetMap,
> > > like I found in leaflet.
> > >
> > > Can anyone offer me any suggestions or advice for accomplishing my
> task?
> > > Thanks so much.
> > >
> > > -Kevin
> > >
> > > _______________________________________________
> > > R-sig-Geo mailing list
> > > R-sig-Geo at r-project.org
> > > https://st/
> > >
> at%2F&data=05%7C01%7Ctim.howard%40dec.ny.gov%7Cbe436282b0844b9c
> a99a0
> > >
> 8db681f6989%7Cf46cb8ea79004d108ceb80e8c1c81ee7%7C0%7C0%7C6382182
> 5635
> > >
> 1940428%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV
> 2luMzIi
> > >
> LCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=QJgBzdN0a
> pmJ61x
> > > gwFp8pY3WQLOSTjt2YVdJGX681q0%3D&reserved=0
> > > .ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-
> > geo&data=05%7C01%7Ctim.howard%40
> > >
> >
> dec.ny.gov%7C4d3f99e6eeff4493a3a108db67a26858%7Cf46cb8ea79004d108c
> > eb80
> > >
> >
> e8c1c81ee7%7C0%7C0%7C638217719464245369%7CUnknown%7CTWFpbGZs
> > b3d8eyJWIj
> > >
> >
> oiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3
> > 000%7C
> > >
> >
> %7C%7C&sdata=RVBbcRMpZINzm0yoMZuwfisK575l3hiQzYSAUiG9U4E%3D&r
> > eserved=0
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.e/
> thz.ch%2Fmailman%2Flistinfo%2Fr-sig-
> geo&data=05%7C01%7Ctim.howard%40dec.ny.gov%7Cbe436282b0844b9ca9
> 9a08db681f6989%7Cf46cb8ea79004d108ceb80e8c1c81ee7%7C0%7C0%7C6382
> 18256351940428%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiL
> CJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sd
> ata=%2FAyGIrey3G6HOOv3rWGC02L7LJCJ5NSaDnhqEvq8C2I%3D&reserved=
> 0

From kev|n @end|ng |rom zembower@org  Thu Jun  8 17:17:17 2023
From: kev|n @end|ng |rom zembower@org (=?UTF-8?Q?Kevin_Zembower?=)
Date: Thu, 8 Jun 2023 15:17:17 +0000
Subject: [R-sig-Geo] Adding Census polygons to OSM map?
In-Reply-To: <SA1PR09MB7792FC9FB55D621C40C4D5FBA850A@SA1PR09MB7792.namprd09.prod.outlook.com>
References: <a0f13434-6d1d-a4ae-7663-f69203b7e272@zembower.org> 
 <010001888c268720-0632e469-6323-4ad8-a295-900a39dbb740-000000@email.amazonses.com>
 <SA1PR09MB779221560C63CA8B1B56B7A0A853A@SA1PR09MB7792.namprd09.prod.outlook.com>
 <69686fb5-81da-5ac2-651b-88cea3b19fb3@zembower.org> 
 <0100018897ded49a-88ee8c14-aece-42c6-a7b5-5dc1516b26b0-000000@email.amazonses.com>
 <SA1PR09MB7792F505B00FFA2E2E84BD5EA850A@SA1PR09MB7792.namprd09.prod.outlook.com>
 <SA1PR09MB7792FC9FB55D621C40C4D5FBA850A@SA1PR09MB7792.namprd09.prod.outlook.com>
 <31e04bd2-8507-7213-67d7-4911e9fecaa4@zembower.org>
Message-ID: <010001889b955e01-0d0ed565-ea59-4917-8a5b-24e57011819d-000000@email.amazonses.com>

Wow, Tim, that is just exactly what I was looking for. I wasn't aware of 
the tmaptools package at all, but even if I knew of it, I doubt that I 
could have put the pieces together to solve my problem.

Thanks so much for your efforts to help solve my problem. I really 
appreciate you sharing your knowledge and experience.

-Kevin

On 6/8/23 09:07, Howard, Tim G (DEC) wrote:
> And I just realized an easier way to get a bounding box for the basemap is to use the spatial information
> you already have in the polygon:
> 
> basem <- read_osm(bb(rw_tract, ext = 1.5))
> 
> The 'ext' option allows you to expand a certain amount beyond the neighborhood polygon.
> You can modify it to your liking.  And skip the lat/lon shenanigans.
> 
> Cheers,
> Tim
> 
>> -----Original Message-----
>> From: R-sig-Geo <r-sig-geo-bounces at r-project.org> On Behalf Of Howard,
>> Tim G (DEC) via R-sig-Geo
>> Sent: Thursday, June 8, 2023 8:53 AM
>> To: Kevin Zembower <kevin at zembower.org>; r-sig-geo at r-project.org
>> Subject: Re: [R-sig-Geo] Adding Census polygons to OSM map?
>>
>> ATTENTION: This email came from an external source. Do not open
>> attachments or click on links from unknown senders or unexpected emails.
>>
>>
>> Kevin,
>> To get the basemap in plot mode you need to download the tiles using
>> read_osm. This works for me, I Simplified a bit:
>>
>> library(sf)
>> library(tmap)
>> library(tigris)
>> options(tigris_use_cache = TRUE)
>> library(tmaptools)
>>
>> ## Get an example census map:
>> rw_tract <- tracts(state = "MD",
>>                     county = "Baltimore city",
>>                     year = "2020")
>> rw_tract <- rw_tract[rw_tract$NAME == "2711.01",]
>>
>> # for some reason had to re-jigger the box a bit.
>> # also note your longitudes were backwards.
>> lat_max <- 39.36
>> long_min <- -76.63
>> lat_min <- 39.34
>> long_max <- -76.60
>>
>> bbox <- bb(c(xmin=long_min, ymin=lat_min, xmax=long_max,
>> ymax=lat_max))
>>
>> basem <- read_osm(bbox)
>>
>> tmap_mode("plot")
>>
>> myMap <- tm_shape(basem) +
>>    tm_rgb() +
>>    tm_shape(rw_tract) +
>>    tm_polygons(alpha = 0.2, col = "green") +
>>    tm_scale_bar() +
>>    tm_layout(title = "Radnor-Winston Neighborhood")
>>
>> # check it out
>> myMap
>> # save it.
>> tmap_save(myMap, "c:/temp/myMapOut.jpg")
>>
>>
>> Hope that helps.
>> Tim
>>
>>
>>
>>
>>
>>
>>> -----Original Message-----
>>> From: Kevin Zembower <kevin at zembower.org>
>>> Sent: Wednesday, June 7, 2023 5:59 PM
>>> To: Howard, Tim G (DEC) <tim.howard at dec.ny.gov>; r-sig-geo at r-
>>> project.org
>>> Subject: Re: Adding Census polygons to OSM map?
>>>
>>> ATTENTION: This email came from an external source. Do not open
>>> attachments or click on links from unknown senders or unexpected emails.
>>>
>>>
>>> Tim, thank you very much. Yes, tmap seems to be moving in the right
>>> direction for me. This is what I can do with it so far:
>>> =====================================
>>> ## Trying with tmap:
>>> library(tidyverse)
>>> library(sf)
>>> library(tmap)
>>> library(terra)
>>> library(spData)
>>> library(spDataLarge)
>>> library(tigris)
>>> options(tigris_use_cache = TRUE)
>>> library(OpenStreetMap)
>>>
>>> ## Get an Open Street Map:
>>> rw_map <- openmap(nw, se,
>>>                     type = "osm",
>>>                     mergeTiles = TRUE) %>%
>>>       openproj(projection = "+proj=longlat +ellps=WGS84 +datum=WGS84
>>> +no_defs")
>>>
>>> ## Get an example census map:
>>> rw_tract <- tracts(state = "MD",
>>>                      county = "Baltimore city",
>>>                      year = "2020") %>%
>>>       filter(NAME == "2711.01")
>>>
>>> ttm()
>>>
>>> ## Quick Tmap; also works:
>>> qtm(rw_tract)
>>>
>>> ## Also works. _polygons combines _fill and _borders:
>>> tm_shape(rw_tract) +
>>>       tm_polygons()
>>>
>>> ## Works:
>>> tm_shape(rw_tract) +
>>>       tm_polygons(alpha = 0.2, col = "green") +
>>>       tm_scale_bar() +
>>>       tm_layout(title = "Radnor-Winston Neighborhood") +
>>>       tm_basemap(server = "OpenStreetMap")
>>>
>>> =======================================
>>>
>>> So, in that last example, I can plot the basemap from Open Street Maps
>>> with the Census tract on top of it. However, from what I've learned so
>>> far (just about 4 hours of study), tm_basemap() only works with
>>> interactive maps that are 'viewed' (in a browser as HTML) rather than
>>> plotted (printed). I don't understand why I can't just get the
>>> appearance I want without all the unwanted interactivity features.
>>>
>>> To take it a step further, I don't understand why I can't just plot
>>> both the basemap and the census tract with something like plot() (from
>>> ggplot) and sf.
>>>
>>> Thanks, again, Tim, for your suggestion. I think it's moving me in the
>>> right direction.
>>>
>>> -Kevin
>>>
>>> On 6/7/23 10:57, Howard, Tim G (DEC) wrote:
>>>> Kevin,
>>>> the tmap? package might be what you are looking for.
>>>>
>>>> https://cr/
>>>>
>> an%2F&data=05%7C01%7Ctim.howard%40dec.ny.gov%7Cbe436282b0844b9c
>> a99a0
>>>>
>> 8db681f6989%7Cf46cb8ea79004d108ceb80e8c1c81ee7%7C0%7C0%7C6382182
>> 5635
>>>>
>> 1940428%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV
>> 2luMzIi
>>>>
>> LCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=X4Cm12TD
>> 2iIH498
>>>> sJlRMPzOFz7IX9XuVdhGX8%2FO0Lv4%3D&reserved=0
>>>> .r-project.org%2Fweb%2Fpackages%2Ftmap%2Fvignettes%2Ftmap-
>>> getstarted.h
>>>>
>>>
>> tml&data=05%7C01%7Ctim.howard%40dec.ny.gov%7C4d3f99e6eeff4493a3a
>>> 108db6
>>>>
>>>
>> 7a26858%7Cf46cb8ea79004d108ceb80e8c1c81ee7%7C0%7C0%7C63821771946
>>> 393381
>>>>
>>>
>> 9%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzI
>>> iLCJBTiI6
>>>>
>>>
>> Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=MY4b3C%2Bqm7w
>>> ycxiX%2F3ww5
>>>> zMLltw59fmCgQTAeSxGu60%3D&reserved=0
>>>>
>>>> https://cr/
>>>>
>> an%2F&data=05%7C01%7Ctim.howard%40dec.ny.gov%7Cbe436282b0844b9c
>> a99a0
>>>>
>> 8db681f6989%7Cf46cb8ea79004d108ceb80e8c1c81ee7%7C0%7C0%7C6382182
>> 5635
>>>>
>> 1940428%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV
>> 2luMzIi
>>>>
>> LCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=X4Cm12TD
>> 2iIH498
>>>> sJlRMPzOFz7IX9XuVdhGX8%2FO0Lv4%3D&reserved=0
>>>> .r-
>>>
>> project.org%2Fweb%2Fpackages%2Ftmap%2Findex.html&data=05%7C01%7
>>> Ctim
>>>>
>>>
>> .howard%40dec.ny.gov%7C4d3f99e6eeff4493a3a108db67a26858%7Cf46cb8e
>>> a7900
>>>>
>>>
>> 4d108ceb80e8c1c81ee7%7C0%7C0%7C638217719463933819%7CUnknown%7
>>> CTWFpbGZs
>>>>
>>>
>> b3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn
>>> 0%3D
>>>>
>>>
>> %7C3000%7C%7C%7C&sdata=R61uJO4g0WW1GLh47uXGCB%2FX6%2B9grO4
>>> WYue3XxkfdQ0
>>>> %3D&reserved=0
>>>>
>>>>
>>>> Cheers,
>>>> Tim
>>>>
>>>> From: R-sig-Geo <r-sig-geo-bounces at r-project.org> on behalf of Kevin
>>>> Zembower via R-sig-Geo <r-sig-geo at r-project.org>
>>>> Sent: Monday, June 5, 2023 11:21 AM
>>>> To: r-sig-geo at r-project.org <r-sig-geo at r-project.org>
>>>> Subject: [R-sig-Geo] Adding Census polygons to OSM map?
>>>>
>>>> ATTENTION: This email came from an external source. Do not open
>>> attachments or click on links from unknown senders or unexpected emails.
>>>>
>>>>
>>>> Hello, again,
>>>>
>>>> I've given up my work with leaflet, trying to map my neighborhood
>>>> with US Census boundaries. Even though it was quick and easy to add
>>>> the Census boundaries to the map, I couldn't create the labels I
>>>> wanted (see
>>>> https://st/
>>>>
>> at%2F&data=05%7C01%7Ctim.howard%40dec.ny.gov%7Cbe436282b0844b9c
>> a99a0
>>>>
>> 8db681f6989%7Cf46cb8ea79004d108ceb80e8c1c81ee7%7C0%7C0%7C6382182
>> 5635
>>>>
>> 1940428%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV
>> 2luMzIi
>>>>
>> LCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=QJgBzdN0a
>> pmJ61x
>>>> gwFp8pY3WQLOSTjt2YVdJGX681q0%3D&reserved=0
>>>> .ethz.ch%2Fpipermail%2Fr-sig-geo%2F2023-
>>>
>> June%2F029284.html&data=05%7C01%7Ctim.howard%40dec.ny.gov%7C4d3f
>>>
>> 99e6eeff4493a3a108db67a26858%7Cf46cb8ea79004d108ceb80e8c1c81ee7%7
>>>
>> C0%7C0%7C638217719464245369%7CUnknown%7CTWFpbGZsb3d8eyJWIjoi
>>>
>> MC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C300
>>>
>> 0%7C%7C%7C&sdata=pQUYMZs%2FRsLeotKUB0XduKCkpq6Ir0Vq3VPsAZ8eT
>>> Yk%3D&reserved=0). Also, it seems like leaflet added a lot of overhead
>>> that I didn't need, such as interactive maps. I just need a color
>>> printed 2D map for my use.
>>>>
>>>> I'm now trying to work with tigris and OpenStreetMap, but I can't
>>>> draw the US Census boundaries on the OSM map. Here's what I have so
>> far:
>>>>
>>>> ==================================================
>>>> ## Experiment, using sf:
>>>> library(tidyverse)
>>>> library(tigris)
>>>> options(tigris_use_cache = TRUE)
>>>> library(sf)
>>>> library(OpenStreetMap)
>>>> ## library(sp)
>>>> ## library(ggplot2)
>>>>
>>>> lat_max <- 39.3525 #Distance from 39.35 to 39.34 = 0.691mi long_max
>>>> <-
>>>> -76.617 #Distance from -76.61 to -76.62 = 0.5343 mi lat_min <-
>>>> 39.3455 long_min <- -76.6095 nw <- c(lat_max, long_max) se <-
>>>> c(lat_min,
>>>> long_min)
>>>>
>>>> rw_map <- openmap(nw, se,
>>>>                      type = "osm",
>>>>                      mergeTiles = TRUE) %>%
>>>>        openproj() %>%
>>>>        OpenStreetMap::autoplot.OpenStreetMap() +
>>>>        xlab("long") + ylab("lat")
>>>>
>>>> rw_map
>>>>
>>>> rw_tract <- tracts(state = "MD",
>>>>                        county = "Baltimore city",
>>>>                        year = "2020") %>%
>>>>        filter(NAME == "2711.01")
>>>>        ## openproj()
>>>>        ## st_transform('+proj=longlat +datum=WGS84')
>>>>        ## spTransform('osm')
>>>>
>>>> OpenStreetMap::autoplot.OpenStreetMap(rw_tract, add = TRUE)
>>>> ==================================================
>>>>
>>>> The commented out sections show some of the things I've tried so far.
>>>> I'd like to be able to draw the rw_tract geometry data on the rw_map
>>>> image. What I'd like is a 'addPolygon()' function in OpenStreetMap,
>>>> like I found in leaflet.
>>>>
>>>> Can anyone offer me any suggestions or advice for accomplishing my
>> task?
>>>> Thanks so much.
>>>>
>>>> -Kevin
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://st/
>>>>
>> at%2F&data=05%7C01%7Ctim.howard%40dec.ny.gov%7Cbe436282b0844b9c
>> a99a0
>>>>
>> 8db681f6989%7Cf46cb8ea79004d108ceb80e8c1c81ee7%7C0%7C0%7C6382182
>> 5635
>>>>
>> 1940428%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV
>> 2luMzIi
>>>>
>> LCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=QJgBzdN0a
>> pmJ61x
>>>> gwFp8pY3WQLOSTjt2YVdJGX681q0%3D&reserved=0
>>>> .ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-
>>> geo&data=05%7C01%7Ctim.howard%40
>>>>
>>>
>> dec.ny.gov%7C4d3f99e6eeff4493a3a108db67a26858%7Cf46cb8ea79004d108c
>>> eb80
>>>>
>>>
>> e8c1c81ee7%7C0%7C0%7C638217719464245369%7CUnknown%7CTWFpbGZs
>>> b3d8eyJWIj
>>>>
>>>
>> oiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3
>>> 000%7C
>>>>
>>>
>> %7C%7C&sdata=RVBbcRMpZINzm0yoMZuwfisK575l3hiQzYSAUiG9U4E%3D&r
>>> eserved=0
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.e/
>> thz.ch%2Fmailman%2Flistinfo%2Fr-sig-
>> geo&data=05%7C01%7Ctim.howard%40dec.ny.gov%7Cbe436282b0844b9ca9
>> 9a08db681f6989%7Cf46cb8ea79004d108ceb80e8c1c81ee7%7C0%7C0%7C6382
>> 18256351940428%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiL
>> CJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sd
>> ata=%2FAyGIrey3G6HOOv3rWGC02L7LJCJ5NSaDnhqEvq8C2I%3D&reserved=
>> 0



From je|une@ @end|ng |rom gm@||@com  Sat Jun 10 18:28:18 2023
From: je|une@ @end|ng |rom gm@||@com (Jose Funes)
Date: Sat, 10 Jun 2023 12:28:18 -0400
Subject: [R-sig-Geo] 
 Estimate impacts from a spgm - spatial panel regression model
In-Reply-To: <CAG1eJiHFGsSDujg3ysB4gGJV+nC0hrHfG4PPV=ixoOWyJq8iKw@mail.gmail.com>
References: <mailman.29258.5.1684663202.15457.r-sig-geo@r-project.org>
 <CAG1eJiH2SX9jirFUXk=uojs_bDV30QhESqD3rcDegXO8M5g0TQ@mail.gmail.com>
 <CAL3ufUJsuWNeXfXTUEdohGK7Gedc2my3honrHa8Dm0BNPqgr7g@mail.gmail.com>
 <OSWP279MB04711AFE395E04A33466CE14EE479@OSWP279MB0471.NORP279.PROD.OUTLOOK.COM>
 <CAG1eJiG8s=m11_aLB3StHT2aGzbbsvKEOGnOTJZ6dfALqZ6Tug@mail.gmail.com>
 <CAG1eJiEUY6iOUW+y1QoqHo=b6d7YKbkuKevfTsGFHhyC180koQ@mail.gmail.com>
 <CAG1eJiHFGsSDujg3ysB4gGJV+nC0hrHfG4PPV=ixoOWyJq8iKw@mail.gmail.com>
Message-ID: <CAG1eJiGYxVfurYut-0EwOQdbRVWCUx96Jrw0Rf=9BvV2s81Jzw@mail.gmail.com>

Hi,
I would like to know if there is an alternative package to the splm package
for carrying out spatial panel analysis. I am still having problems with
the splm package, as I posted a few days ago.
Thank you in advance.
Jose


>>
>> # Rstudio version and PC info
>>
>> platform       x86_64-w64-mingw32
>> arch           x86_64
>> os             mingw32
>> system         x86_64, mingw32
>> status
>> major          4
>> minor          1.2
>> year           2021
>> month          11
>> day            01
>> svn rev        81115
>> language       R
>> version.string R version 4.1.2 (2021-11-01)
>>
>>
>>
>> ####### code #####
>>
>> # Load necessary libraries
>> library(tigris)
>> library(splm)
>> library(spdep)
>> library(Matrix)
>> library(plm)
>>
>>
>> # Load necessary libraries
>> library(tigris)
>> library(splm)
>> library(spdep)
>> library(Matrix)
>> library(plm)
>>
>        library(spatialreg)

>
>> # census tracts
>> dc_tracts_2018 <- tracts(state="DC",cb=TRUE, year=2018)
>> dc_tracts_2018$row.id <- 1:179
>>
>> # Spatial matrix
>> coords <- coordinates(dc_tracts_2018)
>> DC.knn_7 <- knearneigh(coords, k=7)
>> DC7_nb <- knn2nb(DC.knn_7)
>> DCknn_7 <- nb2listw(DC7_nb, style="W")
>>
>> # reproducible example
>> set.seed(123)
>> df2010 <- data.frame(
>>   y = rnorm(179),
>>   x = rnorm(179, mean=2),
>>   x2 = rnorm(179, mean = 3),
>>   year=2010,
>>   row.id = 1:179
>> )
>>
>> df2015 <- data.frame(
>>   y = rnorm(179),
>>   x = rnorm(179, mean=2.5),
>>   x2 = rnorm(179, mean = 3),
>>   year=2015,
>>   row.id = 1:179
>> )
>>
>> df2020 <- data.frame(
>>   y = rnorm(179),
>>   x = rnorm(179, mean=1.5),
>>   x2 = rnorm(179, mean = 3.5),
>>   year=2020,
>>   row.id = 1:179
>> )
>>
>>
>> # drop geom
>> st_geometry(dc_tracts_2018) <- NULL
>>
>> #list of data frame
>> df <- list(df2010,df2015,df2020)
>>
>> for (i in seq_along(df)) {
>>   df[[i]] <- merge(df[[i]], dc_tracts_2018, by = "row.id")
>>
>> }
>>
>> df2010 <- df[1]
>> df2015 <- df[2]
>> df2020 <- df[3]
>>
>> # merging
>> panel_dc_2010_2020 <- rbind(df2010[[1]], df2015[[1]], df2020[[1]])
>>
>> #### setting lag variables
>> panel_dc_2010_2020.pd<-pdata.frame(panel_dc_2010_2020,
>> index=c("GEOID","year"))
>>
>> # lag variables
>> panel_dc_2010_2020.pd$lag_x <- slag(panel_dc_2010_2020.pd$x,listw=DCknn_7)
>> panel_dc_2010_2020.pd$lag_x2 <-
>> slag(panel_dc_2010_2020.pd$x2,listw=DCknn_7)
>>
>> ## impacts
>> time1 <- length(unique(panel_dc_2010_2020$year))
>> s.lwtracts <- kronecker(Diagonal(time1), listw2dgCMatrix(DCknn_7))
>> trMatc <- trW(s.lwtracts, type = "mult")
>>
>> Error in trW(s.lwtracts, type = "mult") : could not find function "trW"
>>
>> # durbing
>> model_fix_durbin <- spgm(y ~ x + x2 +lag_x + lag_x2,
>> data=panel_dc_2010_2020.pd, listw = DCknn_7, model = "within",lag =
>> TRUE,spatial.error = FALSE,moments="fullweights",method="ec2sls")
>>
>> # estimating impacts
>> impacts(model_fix_durbin,tr=trMatc, R=200)
>>
>> Error in impacts(model_fix_durbin, tr = a, R = 200) :
>>   could not find function "impacts"
>>
>>

	[[alternative HTML version deleted]]


From kev|n @end|ng |rom zembower@org  Sat Jun 10 21:27:25 2023
From: kev|n @end|ng |rom zembower@org (=?UTF-8?Q?Kevin_Zembower?=)
Date: Sat, 10 Jun 2023 19:27:25 +0000
Subject: [R-sig-Geo] Mapping my own polygon?
References: <46c87340-0e6b-43e8-1d6f-e6d0a1cd1101@zembower.org>
Message-ID: <01000188a6c71590-54f49b21-3fad-4658-9669-606fe865079d-000000@email.amazonses.com>

In my continuing work on reporting on US Census data for my 
neighborhood, I'd like to draw a map of the boundaries of it. I was 
successful in creating and printing an OSM basemap, with the US Census 
blocks that make up my neighborhood on it.

Now, I'd like to create my own polygon, of the boundaries of my 
neighborhood, because the census blocks don't line up exactly with the 
neighborhood boundaries. I need help creating a polygon that I can 
submit to read_osm() that will correctly return an OSM map of my area.

Here's what I've tried so far:
## Reproducible simple example:
library(tidyverse)
library(sf)

rw <- data.frame( ## Simplified neighborhood rectangle
     Longitude = c(-8528150, -8528500, -8528500, -8528150),
     Latitude  = c( 4771475,  4771475,  4771880,  4771880)
)

rw ## Returns (as expected):

 > rw
   Longitude Latitude
1  -8528150  4771475
2  -8528500  4771475
3  -8528500  4771880
4  -8528150  4771880
 >

rw %>%
     st_as_sf(coords = c("Longitude", "Latitude"), dim = "XY") %>%
     st_set_crs(6487) %>% ## CRS 6487 is NAD83 (2011) Maryland in meters
     st_transform(crs = 4269) ## CRS 4269 is NAD83

## Returns:

Simple feature collection with 4 features and 0 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 171.777 ymin: 24.65904 xmax: 171.7818 ymax: 24.66314
Geodetic CRS:  NAD83
                    geometry
1 POINT (171.7818 24.66192)
2 POINT (171.7806 24.65904)
3  POINT (171.777 24.66026)
4 POINT (171.7781 24.66314)
 >

I expected the POINTS to look like:
1 POINT (-76.61246 39.35010)

Can anyone suggest what I'm doing wrong? Thanks so much in advance. I've 
worked on it all day today, without making much progress.

-Kevin


From md@umner @end|ng |rom gm@||@com  Sun Jun 11 10:04:41 2023
From: md@umner @end|ng |rom gm@||@com (Michael Sumner)
Date: Sun, 11 Jun 2023 18:04:41 +1000
Subject: [R-sig-Geo] Mapping my own polygon?
In-Reply-To: <01000188a6c71590-54f49b21-3fad-4658-9669-606fe865079d-000000@email.amazonses.com>
References: <46c87340-0e6b-43e8-1d6f-e6d0a1cd1101@zembower.org>
 <01000188a6c71590-54f49b21-3fad-4658-9669-606fe865079d-000000@email.amazonses.com>
Message-ID: <CAAcGz98Y51HeRxRa6M+OAO7kQxLbMqJ8TnQLKkwLowEVWxR3=g@mail.gmail.com>

I took a guess that your coordinates are not in EPSG:6487 but in global
Mercator (EPSG:3857) which seems to give a reasonable region from online
image servers.

https://gist.github.com/mdsumner/e6997c2f4a54c743e078aca8401537a0

If that looks ok?     Then, simply replace 6487 with 3857 in your code, but
also please take care to track down where your neighbourhood coordinates
for the x,y range came from.  3857 is the infamous global google mercator,
and that might be what you're using or simply close to it, you should make
sure you know. :)

I'm using in-dev code in the example, it's not because I want you to use
that or advise you to - it's just to keep a record of what I did. I
experimented with the code and scale to guess at what might be the problem.

If the pic in my gist is not on the right track I'm happy to follow up,
best of luck!

HTH, Mike



On Sun, Jun 11, 2023 at 5:27?AM Kevin Zembower via R-sig-Geo <
r-sig-geo at r-project.org> wrote:

> In my continuing work on reporting on US Census data for my
> neighborhood, I'd like to draw a map of the boundaries of it. I was
> successful in creating and printing an OSM basemap, with the US Census
> blocks that make up my neighborhood on it.
>
> Now, I'd like to create my own polygon, of the boundaries of my
> neighborhood, because the census blocks don't line up exactly with the
> neighborhood boundaries. I need help creating a polygon that I can
> submit to read_osm() that will correctly return an OSM map of my area.
>
> Here's what I've tried so far:
> ## Reproducible simple example:
> library(tidyverse)
> library(sf)
>
> rw <- data.frame( ## Simplified neighborhood rectangle
>      Longitude = c(-8528150, -8528500, -8528500, -8528150),
>      Latitude  = c( 4771475,  4771475,  4771880,  4771880)
> )
>
> rw ## Returns (as expected):
>
>  > rw
>    Longitude Latitude
> 1  -8528150  4771475
> 2  -8528500  4771475
> 3  -8528500  4771880
> 4  -8528150  4771880
>  >
>
> rw %>%
>      st_as_sf(coords = c("Longitude", "Latitude"), dim = "XY") %>%
>      st_set_crs(6487) %>% ## CRS 6487 is NAD83 (2011) Maryland in meters
>      st_transform(crs = 4269) ## CRS 4269 is NAD83
>
> ## Returns:
>
> Simple feature collection with 4 features and 0 fields
> Geometry type: POINT
> Dimension:     XY
> Bounding box:  xmin: 171.777 ymin: 24.65904 xmax: 171.7818 ymax: 24.66314
> Geodetic CRS:  NAD83
>                     geometry
> 1 POINT (171.7818 24.66192)
> 2 POINT (171.7806 24.65904)
> 3  POINT (171.777 24.66026)
> 4 POINT (171.7781 24.66314)
>  >
>
> I expected the POINTS to look like:
> 1 POINT (-76.61246 39.35010)
>
> Can anyone suggest what I'm doing wrong? Thanks so much in advance. I've
> worked on it all day today, without making much progress.
>
> -Kevin
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


-- 
Michael Sumner
Software and Database Engineer
Australian Antarctic Division
Hobart, Australia
e-mail: mdsumner at gmail.com

	[[alternative HTML version deleted]]


From kev|n @end|ng |rom zembower@org  Sun Jun 11 16:58:57 2023
From: kev|n @end|ng |rom zembower@org (=?UTF-8?Q?Kevin_Zembower?=)
Date: Sun, 11 Jun 2023 14:58:57 +0000
Subject: [R-sig-Geo] Mapping my own polygon?
In-Reply-To: <CAAcGz98Y51HeRxRa6M+OAO7kQxLbMqJ8TnQLKkwLowEVWxR3=g@mail.gmail.com>
References: <46c87340-0e6b-43e8-1d6f-e6d0a1cd1101@zembower.org> 
 <01000188a6c71590-54f49b21-3fad-4658-9669-606fe865079d-000000@email.amazonses.com>
 <CAAcGz98Y51HeRxRa6M+OAO7kQxLbMqJ8TnQLKkwLowEVWxR3=g@mail.gmail.com> 
 <1f34bc2b-7b61-bed7-6f6e-0ad573838956@zembower.org>
Message-ID: <01000188aaf7aa19-dc7e97a6-905e-42e4-8013-c830c3888bc8-000000@email.amazonses.com>

Hi, Mike, thanks for answering me from across the world!

I created my polygon of my neighborhood the old fashion way: by printing 
a map with a grid in meters, and using a pair of navigational dividers 
to pick off the x and y coordinates of the borders of my neighborhood. 
You can see a map of my neighborhood, drawn by someone else, at 
https://www.radnorwinston.org/, if you're curious.

Here's code to generate a map of this area, one with degrees lat/long, 
and the one I used, with a grid of meters:

===========================================
## This gives degrees lat long:
library(tidyverse)
library(tigris)
options(tigris_use_cache = TRUE)
library(sf)
library(OpenStreetMap)

lat_max <- 39.3525
long_max <- -76.617
lat_min <- 39.3455
long_min <- -76.6095
nw <- c(lat_max, long_max)
se <- c(lat_min, long_min)

rw_map <- openmap(nw, se,
                   type = "osm",
                   mergeTiles = TRUE) %>%
     openproj() %>%
     OpenStreetMap::autoplot.OpenStreetMap() +
     xlab("long") + ylab("lat")

rw_map

## This gives map with grid in meters:
library(tidyverse)
library(tidycensus)
library(sf)
library(tmap)
library(tigris)
options(tigris_use_cache = TRUE)
library(tmaptools)

rw_block_list <- c("3000", "3001", "3002", "3005", "3006", "3007",
                    "3008", "3009", "3010", "3011", "3012")

## Get the RW blocks from the census:
rw_blocks <- blocks(state = "MD",
                     county = "Baltimore city",
                     year = "2020") %>%
     filter(substr(GEOID20, 6, 11) == "271101" &
            substr(GEOID20, 12, 15) %in% rw_block_list)

## Create a map of just the RW blocks:
rw_base_blocks <- read_osm(bb(rw_blocks, ext = 1.3))

tmap_mode("plot")

(RW_block_map <- tm_shape(rw_base_blocks) +
      tm_rgb() +
      tm_shape(rw_blocks) +
      tm_fill("MAP_COLORS", alpha = 0.2, palette = "Accent", n = 10) +
      tm_borders() +
      tm_scale_bar() +
      tm_grid() + tm_xlab("Long") + tm_ylab("Lat") +
      tm_layout(title = "Radnor-Winston Neighborhood")
)
===================================================

You're right, that I did pick my example "1 POINT (-76.61246 39.35010)" 
just by picking a random point in my neighborhood, using Google Maps.

In the second example that gives the grid in meters, I just assumed that 
this was CRS 6487, due to it being Maryland and in meters. Was this a 
bad assumption? How can I tell what the CRS of the return of the call to 
"read_osm(bb(rw_blocks, ext = 1.3))" is? When I display it, it says:

  > rw_base_blocks
stars object with 3 dimensions and 1 attribute
attribute(s), summary of first 1e+05 cells:
    Min. 1st Qu. Median    Mean 3rd Qu. Max.
X     0     217    224 219.915     238  255
dimension(s):
      from  to   offset    delta                   refsys 
values x/y
x       1 663 -8528854  1.19942 WGS 84 / Pseudo-Mercator 
NULL [x]
y       1 907  4772338 -1.19981 WGS 84 / Pseudo-Mercator 
NULL [y]
band    1   3       NA       NA                       NA red  , green, 
blue
 >

Thanks, again, for your work to help me. Thanks also for introducing me 
to Github Gist, which I had never heard of before. I'm going to go to 
that page next and see if I can put this response in there.

Take care.

-Kevin

On 6/11/23 04:04, Michael Sumner wrote:
> I took a guess that your coordinates are not in EPSG:6487 but in global 
> Mercator (EPSG:3857) which seems to give a reasonable region from online 
> image servers.
> 
> https://gist.github.com/mdsumner/e6997c2f4a54c743e078aca8401537a0 
> <https://gist.github.com/mdsumner/e6997c2f4a54c743e078aca8401537a0>
> 
> If that looks ok?? ? ?Then, simply replace 6487 with 3857 in your code, 
> but also please take care to track down where your neighbourhood 
> coordinates for the x,y range came from.? 3857 is the infamous global 
> google mercator, and that might be what you're using or simply close to 
> it, you should make sure you know. :)
> 
> I'm using in-dev code in the example, it's not because I want you to 
> use? that or advise you to - it's just to keep a record of what I did. I 
> experimented with the code and scale to guess at what might be the problem.
> 
> If the pic in my gist is not on the right track I'm happy to follow up, 
> best of luck!
> 
> HTH, Mike
> 
> 
> 
> On Sun, Jun 11, 2023 at 5:27?AM Kevin Zembower via R-sig-Geo 
> <r-sig-geo at r-project.org <mailto:r-sig-geo at r-project.org>> wrote:
> 
>     In my continuing work on reporting on US Census data for my
>     neighborhood, I'd like to draw a map of the boundaries of it. I was
>     successful in creating and printing an OSM basemap, with the US Census
>     blocks that make up my neighborhood on it.
> 
>     Now, I'd like to create my own polygon, of the boundaries of my
>     neighborhood, because the census blocks don't line up exactly with the
>     neighborhood boundaries. I need help creating a polygon that I can
>     submit to read_osm() that will correctly return an OSM map of my area.
> 
>     Here's what I've tried so far:
>     ## Reproducible simple example:
>     library(tidyverse)
>     library(sf)
> 
>     rw <- data.frame( ## Simplified neighborhood rectangle
>      ? ? ?Longitude = c(-8528150, -8528500, -8528500, -8528150),
>      ? ? ?Latitude? = c( 4771475,? 4771475,? 4771880,? 4771880)
>     )
> 
>     rw ## Returns (as expected):
> 
>      ?> rw
>      ? ?Longitude Latitude
>     1? -8528150? 4771475
>     2? -8528500? 4771475
>     3? -8528500? 4771880
>     4? -8528150? 4771880
>      ?>
> 
>     rw %>%
>      ? ? ?st_as_sf(coords = c("Longitude", "Latitude"), dim = "XY") %>%
>      ? ? ?st_set_crs(6487) %>% ## CRS 6487 is NAD83 (2011) Maryland in
>     meters
>      ? ? ?st_transform(crs = 4269) ## CRS 4269 is NAD83
> 
>     ## Returns:
> 
>     Simple feature collection with 4 features and 0 fields
>     Geometry type: POINT
>     Dimension:? ? ?XY
>     Bounding box:? xmin: 171.777 ymin: 24.65904 xmax: 171.7818 ymax:
>     24.66314
>     Geodetic CRS:? NAD83
>      ? ? ? ? ? ? ? ? ? ? geometry
>     1 POINT (171.7818 24.66192)
>     2 POINT (171.7806 24.65904)
>     3? POINT (171.777 24.66026)
>     4 POINT (171.7781 24.66314)
>      ?>
> 
>     I expected the POINTS to look like:
>     1 POINT (-76.61246 39.35010)
> 
>     Can anyone suggest what I'm doing wrong? Thanks so much in advance.
>     I've
>     worked on it all day today, without making much progress.
> 
>     -Kevin
> 
>     _______________________________________________
>     R-sig-Geo mailing list
>     R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>     https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
> 
> 
> 
> -- 
> Michael Sumner
> Software and Database Engineer
> Australian Antarctic Division
> Hobart, Australia
> e-mail: mdsumner at gmail.com <mailto:mdsumner at gmail.com>



From r@|@@pere|r@@br @end|ng |rom gm@||@com  Mon Jun 12 03:32:11 2023
From: r@|@@pere|r@@br @end|ng |rom gm@||@com (Rafael H. M. Pereira)
Date: Sun, 11 Jun 2023 22:32:11 -0300
Subject: [R-sig-Geo] Calculating distance matrix with spatial link distance
Message-ID: <CAA42DG=MKd=kS1mvtsqy4F349x5ZDrbkx4x+eVfFz9THRSZ2JA@mail.gmail.com>

Hi all,

I'm trying to calculate a distance matrix considering spatial link
distances, rather than simple Euclidean distances. Is there a package /
function to do this already? I couldn't find any cooked solution.

I've started drafting an approach to the problem using sfdep, but I'm
stuck. I've posted a reprex on SO in case anyone in the list would like to
take a look.
https://stackoverflow.com/questions/76453159/calculating-a-distance-matrix-based-on-spatial-link-distances-aka-neighbor-dist

Any help would be much appreciated.

best wishes,

Rafeal H M Pereira

	[[alternative HTML version deleted]]


From md@umner @end|ng |rom gm@||@com  Tue Jun 13 03:47:07 2023
From: md@umner @end|ng |rom gm@||@com (Michael Sumner)
Date: Tue, 13 Jun 2023 11:47:07 +1000
Subject: [R-sig-Geo] Mapping my own polygon?
In-Reply-To: <01000188aaf7aa19-dc7e97a6-905e-42e4-8013-c830c3888bc8-000000@email.amazonses.com>
References: <46c87340-0e6b-43e8-1d6f-e6d0a1cd1101@zembower.org>
 <01000188a6c71590-54f49b21-3fad-4658-9669-606fe865079d-000000@email.amazonses.com>
 <1f34bc2b-7b61-bed7-6f6e-0ad573838956@zembower.org>
 <CAAcGz98Y51HeRxRa6M+OAO7kQxLbMqJ8TnQLKkwLowEVWxR3=g@mail.gmail.com>
 <01000188aaf7aa19-dc7e97a6-905e-42e4-8013-c830c3888bc8-000000@email.amazonses.com>
Message-ID: <CAAcGz9_qMjDdUbQmhEVaC6HjyFNMuag7YEUvwzbhrXZ0-2oiBQ@mail.gmail.com>

The  OpenStreetMap package is using PseudoMercator (quite common for image
tile servers) which is EPSG:3857. Using your long/lat min max the numbers
give the right neighbourhood, perhaps a transcribe error in the original
'rw' data frame numbers for Y?

https://gist.github.com/mdsumner/e6997c2f4a54c743e078aca8401537a0?permalink_comment_id=4597644#gistcomment-4597644






On Mon, Jun 12, 2023 at 12:58?AM Kevin Zembower <kevin at zembower.org> wrote:

> Hi, Mike, thanks for answering me from across the world!
>
> I created my polygon of my neighborhood the old fashion way: by printing
> a map with a grid in meters, and using a pair of navigational dividers
> to pick off the x and y coordinates of the borders of my neighborhood.
> You can see a map of my neighborhood, drawn by someone else, at
> https://www.radnorwinston.org/, if you're curious.
>
> Here's code to generate a map of this area, one with degrees lat/long,
> and the one I used, with a grid of meters:
>
> ===========================================
> ## This gives degrees lat long:
> library(tidyverse)
> library(tigris)
> options(tigris_use_cache = TRUE)
> library(sf)
> library(OpenStreetMap)
>
> lat_max <- 39.3525
> long_max <- -76.617
> lat_min <- 39.3455
> long_min <- -76.6095
> nw <- c(lat_max, long_max)
> se <- c(lat_min, long_min)
>
> rw_map <- openmap(nw, se,
>                    type = "osm",
>                    mergeTiles = TRUE) %>%
>      openproj() %>%
>      OpenStreetMap::autoplot.OpenStreetMap() +
>      xlab("long") + ylab("lat")
>
> rw_map
>
> ## This gives map with grid in meters:
> library(tidyverse)
> library(tidycensus)
> library(sf)
> library(tmap)
> library(tigris)
> options(tigris_use_cache = TRUE)
> library(tmaptools)
>
> rw_block_list <- c("3000", "3001", "3002", "3005", "3006", "3007",
>                     "3008", "3009", "3010", "3011", "3012")
>
> ## Get the RW blocks from the census:
> rw_blocks <- blocks(state = "MD",
>                      county = "Baltimore city",
>                      year = "2020") %>%
>      filter(substr(GEOID20, 6, 11) == "271101" &
>             substr(GEOID20, 12, 15) %in% rw_block_list)
>
> ## Create a map of just the RW blocks:
> rw_base_blocks <- read_osm(bb(rw_blocks, ext = 1.3))
>
> tmap_mode("plot")
>
> (RW_block_map <- tm_shape(rw_base_blocks) +
>       tm_rgb() +
>       tm_shape(rw_blocks) +
>       tm_fill("MAP_COLORS", alpha = 0.2, palette = "Accent", n = 10) +
>       tm_borders() +
>       tm_scale_bar() +
>       tm_grid() + tm_xlab("Long") + tm_ylab("Lat") +
>       tm_layout(title = "Radnor-Winston Neighborhood")
> )
> ===================================================
>
> You're right, that I did pick my example "1 POINT (-76.61246 39.35010)"
> just by picking a random point in my neighborhood, using Google Maps.
>
> In the second example that gives the grid in meters, I just assumed that
> this was CRS 6487, due to it being Maryland and in meters. Was this a
> bad assumption? How can I tell what the CRS of the return of the call to
> "read_osm(bb(rw_blocks, ext = 1.3))" is? When I display it, it says:
>
>   > rw_base_blocks
> stars object with 3 dimensions and 1 attribute
> attribute(s), summary of first 1e+05 cells:
>     Min. 1st Qu. Median    Mean 3rd Qu. Max.
> X     0     217    224 219.915     238  255
> dimension(s):
>       from  to   offset    delta                   refsys
> values x/y
> x       1 663 -8528854  1.19942 WGS 84 / Pseudo-Mercator
> NULL [x]
> y       1 907  4772338 -1.19981 WGS 84 / Pseudo-Mercator
> NULL [y]
> band    1   3       NA       NA                       NA red  , green,
> blue
>  >
>
> Thanks, again, for your work to help me. Thanks also for introducing me
> to Github Gist, which I had never heard of before. I'm going to go to
> that page next and see if I can put this response in there.
>
> Take care.
>
> -Kevin
>
> On 6/11/23 04:04, Michael Sumner wrote:
> > I took a guess that your coordinates are not in EPSG:6487 but in global
> > Mercator (EPSG:3857) which seems to give a reasonable region from online
> > image servers.
> >
> > https://gist.github.com/mdsumner/e6997c2f4a54c743e078aca8401537a0
> > <https://gist.github.com/mdsumner/e6997c2f4a54c743e078aca8401537a0>
> >
> > If that looks ok?     Then, simply replace 6487 with 3857 in your code,
> > but also please take care to track down where your neighbourhood
> > coordinates for the x,y range came from.  3857 is the infamous global
> > google mercator, and that might be what you're using or simply close to
> > it, you should make sure you know. :)
> >
> > I'm using in-dev code in the example, it's not because I want you to
> > use  that or advise you to - it's just to keep a record of what I did. I
> > experimented with the code and scale to guess at what might be the
> problem.
> >
> > If the pic in my gist is not on the right track I'm happy to follow up,
> > best of luck!
> >
> > HTH, Mike
> >
> >
> >
> > On Sun, Jun 11, 2023 at 5:27?AM Kevin Zembower via R-sig-Geo
> > <r-sig-geo at r-project.org <mailto:r-sig-geo at r-project.org>> wrote:
> >
> >     In my continuing work on reporting on US Census data for my
> >     neighborhood, I'd like to draw a map of the boundaries of it. I was
> >     successful in creating and printing an OSM basemap, with the US
> Census
> >     blocks that make up my neighborhood on it.
> >
> >     Now, I'd like to create my own polygon, of the boundaries of my
> >     neighborhood, because the census blocks don't line up exactly with
> the
> >     neighborhood boundaries. I need help creating a polygon that I can
> >     submit to read_osm() that will correctly return an OSM map of my
> area.
> >
> >     Here's what I've tried so far:
> >     ## Reproducible simple example:
> >     library(tidyverse)
> >     library(sf)
> >
> >     rw <- data.frame( ## Simplified neighborhood rectangle
> >           Longitude = c(-8528150, -8528500, -8528500, -8528150),
> >           Latitude  = c( 4771475,  4771475,  4771880,  4771880)
> >     )
> >
> >     rw ## Returns (as expected):
> >
> >       > rw
> >         Longitude Latitude
> >     1  -8528150  4771475
> >     2  -8528500  4771475
> >     3  -8528500  4771880
> >     4  -8528150  4771880
> >       >
> >
> >     rw %>%
> >           st_as_sf(coords = c("Longitude", "Latitude"), dim = "XY") %>%
> >           st_set_crs(6487) %>% ## CRS 6487 is NAD83 (2011) Maryland in
> >     meters
> >           st_transform(crs = 4269) ## CRS 4269 is NAD83
> >
> >     ## Returns:
> >
> >     Simple feature collection with 4 features and 0 fields
> >     Geometry type: POINT
> >     Dimension:     XY
> >     Bounding box:  xmin: 171.777 ymin: 24.65904 xmax: 171.7818 ymax:
> >     24.66314
> >     Geodetic CRS:  NAD83
> >                          geometry
> >     1 POINT (171.7818 24.66192)
> >     2 POINT (171.7806 24.65904)
> >     3  POINT (171.777 24.66026)
> >     4 POINT (171.7781 24.66314)
> >       >
> >
> >     I expected the POINTS to look like:
> >     1 POINT (-76.61246 39.35010)
> >
> >     Can anyone suggest what I'm doing wrong? Thanks so much in advance.
> >     I've
> >     worked on it all day today, without making much progress.
> >
> >     -Kevin
> >
> >     _______________________________________________
> >     R-sig-Geo mailing list
> >     R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
> >     https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >     <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
> >
> >
> >
> > --
> > Michael Sumner
> > Software and Database Engineer
> > Australian Antarctic Division
> > Hobart, Australia
> > e-mail: mdsumner at gmail.com <mailto:mdsumner at gmail.com>
>
>

-- 
Michael Sumner
Software and Database Engineer
Australian Antarctic Division
Hobart, Australia
e-mail: mdsumner at gmail.com

	[[alternative HTML version deleted]]


From kev|n @end|ng |rom zembower@org  Tue Jun 13 16:40:21 2023
From: kev|n @end|ng |rom zembower@org (=?UTF-8?Q?Kevin_Zembower?=)
Date: Tue, 13 Jun 2023 14:40:21 +0000
Subject: [R-sig-Geo] Mapping my own polygon?
In-Reply-To: <CAAcGz9_qMjDdUbQmhEVaC6HjyFNMuag7YEUvwzbhrXZ0-2oiBQ@mail.gmail.com>
References: <46c87340-0e6b-43e8-1d6f-e6d0a1cd1101@zembower.org> 
 <01000188a6c71590-54f49b21-3fad-4658-9669-606fe865079d-000000@email.amazonses.com>
 <1f34bc2b-7b61-bed7-6f6e-0ad573838956@zembower.org> 
 <CAAcGz98Y51HeRxRa6M+OAO7kQxLbMqJ8TnQLKkwLowEVWxR3=g@mail.gmail.com> 
 <01000188aaf7aa19-dc7e97a6-905e-42e4-8013-c830c3888bc8-000000@email.amazonses.com>
 <CAAcGz9_qMjDdUbQmhEVaC6HjyFNMuag7YEUvwzbhrXZ0-2oiBQ@mail.gmail.com> 
 <caa6546f-2935-57c5-8bad-0d563134be75@zembower.org>
Message-ID: <01000188b5335af6-a4e30994-08e6-4609-9414-ea8bd3e3cc7d-000000@email.amazonses.com>

Mike, thanks, again, for all your help. You got me started down the 
correct path.

Here's what's finally working for me:
========================================
library(tidyverse)
library(tidycensus)
library(sf)
library(tmap)
library(tigris)
options(tigris_use_cache = TRUE)
library(tmaptools)

rw_block_list <- c("3000", "3001", "3002", "3005", "3006", "3007",
                    "3008", "3009", "3010", "3011", "3012")

## Get the RW blocks from the census:
rw_blocks <- blocks(state = "MD",
                     county = "Baltimore city",
                     year = "2020") %>%
     filter(substr(GEOID20, 6, 11) == "271101" &
            substr(GEOID20, 12, 15) %in% rw_block_list)

## Create a map of just the RW blocks:
rw_base_blocks <- read_osm(bb(rw_blocks, ext = 1.3))

tmap_mode("plot")

## Line below gives map in meters
(RW_block_map <- tm_shape(rw_base_blocks, projection = 6487) +
## Line below gives map in degrees
## (RW_block_map <- tm_shape(rw_base_blocks, projection = 6487) +
      tm_rgb() +
      tm_shape(rw_blocks) +
      tm_fill("MAP_COLORS", alpha = 0.2, palette = "Accent") +
      tm_borders() +
      tm_scale_bar() +
      ## tm_grid() + tm_xlab("Long") + tm_ylab("Lat") +
      tm_grid() +
      tm_layout(title = "Radnor-Winston Neighborhood")
)

tmap_save(RW_block_map, "rw_map.png")
=======================================

Based on the map in meters, I can pick off the coordinates of a polygon 
in my neighborhood, and convert it to the correct location in degrees:

===========================================
## Test polygon:
base_x <- 433000
base_y <- 186000
rw_neigh_pg_m <- data.frame(
     matrix(
         c(300, 900,
           500, 900,
           500, 700,
           300, 700
         ),
         ncol = 2, byrow = TRUE)
) %>% + matrix(c(rep(base_x, nrow(.)), rep(base_y, nrow(.))),
                nrow = nrow(.)) %>%
sf::st_as_sf(coords = c(1,2), dim = "XY") %>%
summarize(geometry = st_combine(geometry)) %>%
st_cast("POLYGON") %>%
st_set_crs(6487)

## Convert to degrees:
(rw_neigh_pg_d <- rw_neigh_pg_m %>%
     st_transform(4326)
)
=============================================

Thanks, again, for all your help. I would have spent many additional 
hours on randomly trying things without your guidance.

-Kevin

On 6/12/23 21:47, Michael Sumner wrote:
> The OpenStreetMap package is using PseudoMercator (quite common for 
> image tile servers) which is EPSG:3857. Using your long/lat min max the 
> numbers give the right neighbourhood, perhaps a transcribe error in the 
> original 'rw' data frame numbers for Y?
> 
> https://gist.github.com/mdsumner/e6997c2f4a54c743e078aca8401537a0?permalink_comment_id=4597644#gistcomment-4597644 <https://gist.github.com/mdsumner/e6997c2f4a54c743e078aca8401537a0?permalink_comment_id=4597644#gistcomment-4597644>
> 
> 
> 
> 
> 
> On Mon, Jun 12, 2023 at 12:58?AM Kevin Zembower <kevin at zembower.org 
> <mailto:kevin at zembower.org>> wrote:
> 
>     Hi, Mike, thanks for answering me from across the world!
> 
>     I created my polygon of my neighborhood the old fashion way: by
>     printing
>     a map with a grid in meters, and using a pair of navigational dividers
>     to pick off the x and y coordinates of the borders of my neighborhood.
>     You can see a map of my neighborhood, drawn by someone else, at
>     https://www.radnorwinston.org/ <https://www.radnorwinston.org/>, if
>     you're curious.
> 
>     Here's code to generate a map of this area, one with degrees lat/long,
>     and the one I used, with a grid of meters:
> 
>     ===========================================
>     ## This gives degrees lat long:
>     library(tidyverse)
>     library(tigris)
>     options(tigris_use_cache = TRUE)
>     library(sf)
>     library(OpenStreetMap)
> 
>     lat_max <- 39.3525
>     long_max <- -76.617
>     lat_min <- 39.3455
>     long_min <- -76.6095
>     nw <- c(lat_max, long_max)
>     se <- c(lat_min, long_min)
> 
>     rw_map <- openmap(nw, se,
>      ? ? ? ? ? ? ? ? ? ?type = "osm",
>      ? ? ? ? ? ? ? ? ? ?mergeTiles = TRUE) %>%
>      ? ? ?openproj() %>%
>      ? ? ?OpenStreetMap::autoplot.OpenStreetMap() +
>      ? ? ?xlab("long") + ylab("lat")
> 
>     rw_map
> 
>     ## This gives map with grid in meters:
>     library(tidyverse)
>     library(tidycensus)
>     library(sf)
>     library(tmap)
>     library(tigris)
>     options(tigris_use_cache = TRUE)
>     library(tmaptools)
> 
>     rw_block_list <- c("3000", "3001", "3002", "3005", "3006", "3007",
>      ? ? ? ? ? ? ? ? ? ? "3008", "3009", "3010", "3011", "3012")
> 
>     ## Get the RW blocks from the census:
>     rw_blocks <- blocks(state = "MD",
>      ? ? ? ? ? ? ? ? ? ? ?county = "Baltimore city",
>      ? ? ? ? ? ? ? ? ? ? ?year = "2020") %>%
>      ? ? ?filter(substr(GEOID20, 6, 11) == "271101" &
>      ? ? ? ? ? ? substr(GEOID20, 12, 15) %in% rw_block_list)
> 
>     ## Create a map of just the RW blocks:
>     rw_base_blocks <- read_osm(bb(rw_blocks, ext = 1.3))
> 
>     tmap_mode("plot")
> 
>     (RW_block_map <- tm_shape(rw_base_blocks) +
>      ? ? ? tm_rgb() +
>      ? ? ? tm_shape(rw_blocks) +
>      ? ? ? tm_fill("MAP_COLORS", alpha = 0.2, palette = "Accent", n = 10) +
>      ? ? ? tm_borders() +
>      ? ? ? tm_scale_bar() +
>      ? ? ? tm_grid() + tm_xlab("Long") + tm_ylab("Lat") +
>      ? ? ? tm_layout(title = "Radnor-Winston Neighborhood")
>     )
>     ===================================================
> 
>     You're right, that I did pick my example "1 POINT (-76.61246 39.35010)"
>     just by picking a random point in my neighborhood, using Google Maps.
> 
>     In the second example that gives the grid in meters, I just assumed
>     that
>     this was CRS 6487, due to it being Maryland and in meters. Was this a
>     bad assumption? How can I tell what the CRS of the return of the
>     call to
>     "read_osm(bb(rw_blocks, ext = 1.3))" is? When I display it, it says:
> 
>      ? > rw_base_blocks
>     stars object with 3 dimensions and 1 attribute
>     attribute(s), summary of first 1e+05 cells:
>      ? ? Min. 1st Qu. Median? ? Mean 3rd Qu. Max.
>     X? ? ?0? ? ?217? ? 224 219.915? ? ?238? 255
>     dimension(s):
>      ? ? ? from? to? ?offset? ? delta? ? ? ? ? ? ? ? ? ?refsys
>     values x/y
>     x? ? ? ?1 663 -8528854? 1.19942 WGS 84 / Pseudo-Mercator
>     NULL [x]
>     y? ? ? ?1 907? 4772338 -1.19981 WGS 84 / Pseudo-Mercator
>     NULL [y]
>     band? ? 1? ?3? ? ? ?NA? ? ? ?NA? ? ? ? ? ? ? ? ? ? ? ?NA red? , green,
>     blue
>      ?>
> 
>     Thanks, again, for your work to help me. Thanks also for introducing me
>     to Github Gist, which I had never heard of before. I'm going to go to
>     that page next and see if I can put this response in there.
> 
>     Take care.
> 
>     -Kevin
> 
>     On 6/11/23 04:04, Michael Sumner wrote:
>      > I took a guess that your coordinates are not in EPSG:6487 but in
>     global
>      > Mercator (EPSG:3857) which seems to give a reasonable region from
>     online
>      > image servers.
>      >
>      > https://gist.github.com/mdsumner/e6997c2f4a54c743e078aca8401537a0
>     <https://gist.github.com/mdsumner/e6997c2f4a54c743e078aca8401537a0>
>      >
>     <https://gist.github.com/mdsumner/e6997c2f4a54c743e078aca8401537a0
>     <https://gist.github.com/mdsumner/e6997c2f4a54c743e078aca8401537a0>>
>      >
>      > If that looks ok?? ? ?Then, simply replace 6487 with 3857 in your
>     code,
>      > but also please take care to track down where your neighbourhood
>      > coordinates for the x,y range came from.? 3857 is the infamous
>     global
>      > google mercator, and that might be what you're using or simply
>     close to
>      > it, you should make sure you know. :)
>      >
>      > I'm using in-dev code in the example, it's not because I want you to
>      > use? that or advise you to - it's just to keep a record of what I
>     did. I
>      > experimented with the code and scale to guess at what might be
>     the problem.
>      >
>      > If the pic in my gist is not on the right track I'm happy to
>     follow up,
>      > best of luck!
>      >
>      > HTH, Mike
>      >
>      >
>      >
>      > On Sun, Jun 11, 2023 at 5:27?AM Kevin Zembower via R-sig-Geo
>      > <r-sig-geo at r-project.org <mailto:r-sig-geo at r-project.org>
>     <mailto:r-sig-geo at r-project.org <mailto:r-sig-geo at r-project.org>>>
>     wrote:
>      >
>      >? ? ?In my continuing work on reporting on US Census data for my
>      >? ? ?neighborhood, I'd like to draw a map of the boundaries of it.
>     I was
>      >? ? ?successful in creating and printing an OSM basemap, with the
>     US Census
>      >? ? ?blocks that make up my neighborhood on it.
>      >
>      >? ? ?Now, I'd like to create my own polygon, of the boundaries of my
>      >? ? ?neighborhood, because the census blocks don't line up exactly
>     with the
>      >? ? ?neighborhood boundaries. I need help creating a polygon that
>     I can
>      >? ? ?submit to read_osm() that will correctly return an OSM map of
>     my area.
>      >
>      >? ? ?Here's what I've tried so far:
>      >? ? ?## Reproducible simple example:
>      >? ? ?library(tidyverse)
>      >? ? ?library(sf)
>      >
>      >? ? ?rw <- data.frame( ## Simplified neighborhood rectangle
>      >? ? ? ? ? ?Longitude = c(-8528150, -8528500, -8528500, -8528150),
>      >? ? ? ? ? ?Latitude? = c( 4771475,? 4771475,? 4771880,? 4771880)
>      >? ? ?)
>      >
>      >? ? ?rw ## Returns (as expected):
>      >
>      >? ? ? ?> rw
>      >? ? ? ? ?Longitude Latitude
>      >? ? ?1? -8528150? 4771475
>      >? ? ?2? -8528500? 4771475
>      >? ? ?3? -8528500? 4771880
>      >? ? ?4? -8528150? 4771880
>      >? ? ? ?>
>      >
>      >? ? ?rw %>%
>      >? ? ? ? ? ?st_as_sf(coords = c("Longitude", "Latitude"), dim =
>     "XY") %>%
>      >? ? ? ? ? ?st_set_crs(6487) %>% ## CRS 6487 is NAD83 (2011)
>     Maryland in
>      >? ? ?meters
>      >? ? ? ? ? ?st_transform(crs = 4269) ## CRS 4269 is NAD83
>      >
>      >? ? ?## Returns:
>      >
>      >? ? ?Simple feature collection with 4 features and 0 fields
>      >? ? ?Geometry type: POINT
>      >? ? ?Dimension:? ? ?XY
>      >? ? ?Bounding box:? xmin: 171.777 ymin: 24.65904 xmax: 171.7818 ymax:
>      >? ? ?24.66314
>      >? ? ?Geodetic CRS:? NAD83
>      >? ? ? ? ? ? ? ? ? ? ? ? ? geometry
>      >? ? ?1 POINT (171.7818 24.66192)
>      >? ? ?2 POINT (171.7806 24.65904)
>      >? ? ?3? POINT (171.777 24.66026)
>      >? ? ?4 POINT (171.7781 24.66314)
>      >? ? ? ?>
>      >
>      >? ? ?I expected the POINTS to look like:
>      >? ? ?1 POINT (-76.61246 39.35010)
>      >
>      >? ? ?Can anyone suggest what I'm doing wrong? Thanks so much in
>     advance.
>      >? ? ?I've
>      >? ? ?worked on it all day today, without making much progress.
>      >
>      >? ? ?-Kevin
>      >
>      >? ? ?_______________________________________________
>      >? ? ?R-sig-Geo mailing list
>      > R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>     <mailto:R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>>
>      > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>      >? ? ?<https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>     <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>>
>      >
>      >
>      >
>      > --
>      > Michael Sumner
>      > Software and Database Engineer
>      > Australian Antarctic Division
>      > Hobart, Australia
>      > e-mail: mdsumner at gmail.com <mailto:mdsumner at gmail.com>
>     <mailto:mdsumner at gmail.com <mailto:mdsumner at gmail.com>>
> 
> 
> 
> -- 
> Michael Sumner
> Software and Database Engineer
> Australian Antarctic Division
> Hobart, Australia
> e-mail: mdsumner at gmail.com <mailto:mdsumner at gmail.com>



From Roger@B|v@nd @end|ng |rom nhh@no  Sat Jun 24 16:55:02 2023
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Sat, 24 Jun 2023 14:55:02 +0000
Subject: [R-sig-Geo] sp 2.0-0 released
Message-ID: <SV0P279MB04753D3B76EEA0395726377AEE20A@SV0P279MB0475.NORP279.PROD.OUTLOOK.COM>

A new version of the sp package, 2.0-0, has been published on CRAN. This new version defaults to using the sf package rather than the rgdal package, and deprecates use  of the rgeos package. These changes are described in https://r-spatial.org/r/2023/05/15/evolution4.html, and lead up to the planned archiving of the retiring packages: maptools, rgdal and rgeos in October 2023. This version issues invasive start-up messages in order to alert users to impending changes; maintainers of affected packages have already been warned.

--
Roger Bivand
Emeritus Professor
Norwegian School of Economics
Postboks 3490 Ytre Sandviken, 5045 Bergen, Norway
Roger.Bivand at nhh.no

From g||berto@c@m@r@ @end|ng |rom |npe@br  Sat Jun 24 23:22:00 2023
From: g||berto@c@m@r@ @end|ng |rom |npe@br (Gilberto Camara)
Date: Sat, 24 Jun 2023 18:22:00 -0300
Subject: [R-sig-Geo] Issues with spatial package "sits" on CRAN
Message-ID: <30B33D2A-CD4D-4A35-9612-01B3DF232B17@inpe.br>

Dear all

I am the maintainer of the ?sits? package on CRAN. I found an odd status message regarding ?sits? check results on flavors "r-devel-linux-x86_64-debian-clang? and "r-devel-linux-x86_64-debian-gcc?, as follows: 
===============
Version: 1.4.1
Check: package dependencies
Result: ERROR
    Package required but not available: ?terra?
    
    Packages suggested but not available for checking:
     'exactextractr', 'leafem', 'leaflet', 'supercells', ?tmap'
============

No such error is reported for ?sits? in the other flavors. As an aside, the check report for package ?terra? also reports errors in the same flavors. Any hints on what actions can be done from my side to fix the problem will be most welcome.

Best
Gilberto
============================
Prof Dr Gilberto Camara
Senior Researcher
National Institute for Space Research (INPE), Brazil
https://gilbertocamara.org/
=============================


From jo@|@h@p@rry @end|ng |rom gm@||@com  Sun Jun 25 00:11:04 2023
From: jo@|@h@p@rry @end|ng |rom gm@||@com (Josiah Parry)
Date: Sat, 24 Jun 2023 18:11:04 -0400
Subject: [R-sig-Geo] Issues with spatial package "sits" on CRAN
In-Reply-To: <30B33D2A-CD4D-4A35-9612-01B3DF232B17@inpe.br>
References: <30B33D2A-CD4D-4A35-9612-01B3DF232B17@inpe.br>
Message-ID: <CAL3ufULENyWSSJHnb9WyQDCnfjAisdr-Nb6Zr3WQbuXRbCO7WQ@mail.gmail.com>

This looks like a result of the R CMD Check hard that I think is a
newer-ish check from CRAN. I?ve encountered this before. I encountered it
from using a function in an example that used a suggested package. Since
the package is suggested it?s not available in the hard check. Only
imported packages are available in the hard check.

That may or may not be the case here. But might be worth exploring.

On Sat, Jun 24, 2023 at 17:22 Gilberto Camara <gilberto.camara at inpe.br>
wrote:

> Dear all
>
> I am the maintainer of the ?sits? package on CRAN. I found an odd status
> message regarding ?sits? check results on flavors
> "r-devel-linux-x86_64-debian-clang? and "r-devel-linux-x86_64-debian-gcc?,
> as follows:
> ===============
> Version: 1.4.1
> Check: package dependencies
> Result: ERROR
>     Package required but not available: ?terra?
>
>     Packages suggested but not available for checking:
>      'exactextractr', 'leafem', 'leaflet', 'supercells', ?tmap'
> ============
>
> No such error is reported for ?sits? in the other flavors. As an aside,
> the check report for package ?terra? also reports errors in the same
> flavors. Any hints on what actions can be done from my side to fix the
> problem will be most welcome.
>
> Best
> Gilberto
> ============================
> Prof Dr Gilberto Camara
> Senior Researcher
> National Institute for Space Research (INPE), Brazil
> https://gilbertocamara.org/
> =============================
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From Roger@B|v@nd @end|ng |rom nhh@no  Sun Jun 25 00:15:46 2023
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Sat, 24 Jun 2023 22:15:46 +0000
Subject: [R-sig-Geo] Issues with spatial package "sits" on CRAN
In-Reply-To: <30B33D2A-CD4D-4A35-9612-01B3DF232B17@inpe.br>
References: <30B33D2A-CD4D-4A35-9612-01B3DF232B17@inpe.br>
Message-ID: <SV0P279MB0475E4B889AF9670207711C2EE20A@SV0P279MB0475.NORP279.PROD.OUTLOOK.COM>

Briefly, backtrack through the lists of dependencies of those packages to find probably the intersection, that is some package that has been failing checks. I'll try to look on Tuesday.

Roger

---
Roger Bivand
Emeritus Professor
Department of Economics
Norwegian School of Economics, Bergen, Norway

________________________________
Fra: R-sig-Geo <r-sig-geo-bounces at r-project.org> p? vegne av Gilberto Camara <gilberto.camara at inpe.br>
Sendt: l?rdag, juni 24, 2023 11:22:42 p.m.
Til: r-sig-geo at r-project.org <r-sig-geo at r-project.org>
Emne: [R-sig-Geo] Issues with spatial package "sits" on CRAN

Dear all

I am the maintainer of the ?sits? package on CRAN. I found an odd status message regarding ?sits? check results on flavors "r-devel-linux-x86_64-debian-clang? and "r-devel-linux-x86_64-debian-gcc?, as follows:
===============
Version: 1.4.1
Check: package dependencies
Result: ERROR
    Package required but not available: ?terra?

    Packages suggested but not available for checking:
     'exactextractr', 'leafem', 'leaflet', 'supercells', ?tmap'
============

No such error is reported for ?sits? in the other flavors. As an aside, the check report for package ?terra? also reports errors in the same flavors. Any hints on what actions can be done from my side to fix the problem will be most welcome.

Best
Gilberto
============================
Prof Dr Gilberto Camara
Senior Researcher
National Institute for Space Research (INPE), Brazil
https://eur02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgilbertocamara.org%2F&data=05%7C01%7CRoger.Bivand%40nhh.no%7Cc9faf8eb262e46671dce08db74f923c7%7C33a15b2f849941998d56f20b5aa91af2%7C0%7C0%7C638232385619944987%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=wpNxOEWyIkxKFL2Jzcnf6NazwJMZyryr7gx2%2BgLD264%3D&reserved=0<https://gilbertocamara.org/>
=============================

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://eur02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-geo&data=05%7C01%7CRoger.Bivand%40nhh.no%7Cc9faf8eb262e46671dce08db74f923c7%7C33a15b2f849941998d56f20b5aa91af2%7C0%7C0%7C638232385619944987%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=kYOy5aN0zJdtl1WBemLbe569fan5HdJJ77Q%2BnlwdvGo%3D&reserved=0<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>


	[[alternative HTML version deleted]]


From g||berto@c@m@r@ @end|ng |rom |npe@br  Sun Jun 25 00:16:30 2023
From: g||berto@c@m@r@ @end|ng |rom |npe@br (Gilberto Camara)
Date: Sat, 24 Jun 2023 19:16:30 -0300
Subject: [R-sig-Geo] Issues with spatial package "sits" on CRAN
In-Reply-To: <SV0P279MB0475E4B889AF9670207711C2EE20A@SV0P279MB0475.NORP279.PROD.OUTLOOK.COM>
References: <30B33D2A-CD4D-4A35-9612-01B3DF232B17@inpe.br>
 <SV0P279MB0475E4B889AF9670207711C2EE20A@SV0P279MB0475.NORP279.PROD.OUTLOOK.COM>
Message-ID: <62AE9BC8-6359-4FC4-A335-F23F8F540391@inpe.br>

Thanks, Roger!
============================
Prof Dr Gilberto Camara
Senior Researcher
National Institute for Space Research (INPE), Brazil
https://gilbertocamara.org/
=============================




> On 24 Jun 2023, at 19:15, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> 
> Briefly, backtrack through the lists of dependencies of those packages to find probably the intersection, that is some package that has been failing checks. I'll try to look on Tuesday.
> 
> Roger
> 
> ---
> Roger Bivand
> Emeritus Professor
> Department of Economics
> Norwegian School of Economics, Bergen, Norway
> 
> Fra: R-sig-Geo <r-sig-geo-bounces at r-project.org> p? vegne av Gilberto Camara <gilberto.camara at inpe.br>
> Sendt: l?rdag, juni 24, 2023 11:22:42 p.m.
> Til: r-sig-geo at r-project.org <r-sig-geo at r-project.org>
> Emne: [R-sig-Geo] Issues with spatial package "sits" on CRAN
> 
> Dear all
> 
> I am the maintainer of the ?sits? package on CRAN. I found an odd status message regarding ?sits? check results on flavors "r-devel-linux-x86_64-debian-clang? and "r-devel-linux-x86_64-debian-gcc?, as follows: 
> ===============
> Version: 1.4.1
> Check: package dependencies
> Result: ERROR
>     Package required but not available: ?terra?
>     
>     Packages suggested but not available for checking:
>      'exactextractr', 'leafem', 'leaflet', 'supercells', ?tmap'
> ============
> 
> No such error is reported for ?sits? in the other flavors. As an aside, the check report for package ?terra? also reports errors in the same flavors. Any hints on what actions can be done from my side to fix the problem will be most welcome.
> 
> Best
> Gilberto
> ============================
> Prof Dr Gilberto Camara
> Senior Researcher
> National Institute for Space Research (INPE), Brazil
> https://eur02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgilbertocamara.org%2F&data=05%7C01%7CRoger.Bivand%40nhh.no%7Cc9faf8eb262e46671dce08db74f923c7%7C33a15b2f849941998d56f20b5aa91af2%7C0%7C0%7C638232385619944987%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=wpNxOEWyIkxKFL2Jzcnf6NazwJMZyryr7gx2%2BgLD264%3D&reserved=0
> =============================
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://eur02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-geo&data=05%7C01%7CRoger.Bivand%40nhh.no%7Cc9faf8eb262e46671dce08db74f923c7%7C33a15b2f849941998d56f20b5aa91af2%7C0%7C0%7C638232385619944987%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=kYOy5aN0zJdtl1WBemLbe569fan5HdJJ77Q%2BnlwdvGo%3D&reserved=0
> 


From g||berto@c@m@r@ @end|ng |rom |npe@br  Sun Jun 25 00:21:34 2023
From: g||berto@c@m@r@ @end|ng |rom |npe@br (Gilberto Camara)
Date: Sat, 24 Jun 2023 19:21:34 -0300
Subject: [R-sig-Geo] Issues with spatial package "sits" on CRAN
In-Reply-To: <62AE9BC8-6359-4FC4-A335-F23F8F540391@inpe.br>
References: <30B33D2A-CD4D-4A35-9612-01B3DF232B17@inpe.br>
 <SV0P279MB0475E4B889AF9670207711C2EE20A@SV0P279MB0475.NORP279.PROD.OUTLOOK.COM>
 <62AE9BC8-6359-4FC4-A335-F23F8F540391@inpe.br>
Message-ID: <6129FD3E-E468-4217-BE3B-32E796F20AF3@inpe.br>

Roger, 

Following your advice, I found out that ?terra-1.7-37 is failing on "r-devel-linux-x86_64-debian-clang?. It turns out that the CRAN version of ?terra? is now 1.7-39. So, it might be that Rob has fixed the problem, and the issue is that CRAN is checking an old version. 

Best
Gilberto
============================
Prof Dr Gilberto Camara
Senior Researcher
National Institute for Space Research (INPE), Brazil
https://gilbertocamara.org/
=============================




> On 24 Jun 2023, at 19:16, Gilberto Camara <gilberto.camara at inpe.br> wrote:
> 
> Thanks, Roger!
> ============================
> Prof Dr Gilberto Camara
> Senior Researcher
> National Institute for Space Research (INPE), Brazil
> https://gilbertocamara.org/
> =============================
> 
> 
> 
> 
>> On 24 Jun 2023, at 19:15, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>> 
>> Briefly, backtrack through the lists of dependencies of those packages to find probably the intersection, that is some package that has been failing checks. I'll try to look on Tuesday.
>> 
>> Roger
>> 
>> ---
>> Roger Bivand
>> Emeritus Professor
>> Department of Economics
>> Norwegian School of Economics, Bergen, Norway
>> 
>> Fra: R-sig-Geo <r-sig-geo-bounces at r-project.org> p? vegne av Gilberto Camara <gilberto.camara at inpe.br>
>> Sendt: l?rdag, juni 24, 2023 11:22:42 p.m.
>> Til: r-sig-geo at r-project.org <r-sig-geo at r-project.org>
>> Emne: [R-sig-Geo] Issues with spatial package "sits" on CRAN
>> 
>> Dear all
>> 
>> I am the maintainer of the ?sits? package on CRAN. I found an odd status message regarding ?sits? check results on flavors "r-devel-linux-x86_64-debian-clang? and "r-devel-linux-x86_64-debian-gcc?, as follows: 
>> ===============
>> Version: 1.4.1
>> Check: package dependencies
>> Result: ERROR
>>    Package required but not available: ?terra?
>> 
>>    Packages suggested but not available for checking:
>>     'exactextractr', 'leafem', 'leaflet', 'supercells', ?tmap'
>> ============
>> 
>> No such error is reported for ?sits? in the other flavors. As an aside, the check report for package ?terra? also reports errors in the same flavors. Any hints on what actions can be done from my side to fix the problem will be most welcome.
>> 
>> Best
>> Gilberto
>> ============================
>> Prof Dr Gilberto Camara
>> Senior Researcher
>> National Institute for Space Research (INPE), Brazil
>> https://eur02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgilbertocamara.org%2F&data=05%7C01%7CRoger.Bivand%40nhh.no%7Cc9faf8eb262e46671dce08db74f923c7%7C33a15b2f849941998d56f20b5aa91af2%7C0%7C0%7C638232385619944987%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=wpNxOEWyIkxKFL2Jzcnf6NazwJMZyryr7gx2%2BgLD264%3D&reserved=0
>> =============================
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://eur02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-geo&data=05%7C01%7CRoger.Bivand%40nhh.no%7Cc9faf8eb262e46671dce08db74f923c7%7C33a15b2f849941998d56f20b5aa91af2%7C0%7C0%7C638232385619944987%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=kYOy5aN0zJdtl1WBemLbe569fan5HdJJ77Q%2BnlwdvGo%3D&reserved=0
>> 
> 


From g||berto@c@m@r@ @end|ng |rom |npe@br  Sun Jun 25 15:48:43 2023
From: g||berto@c@m@r@ @end|ng |rom |npe@br (Gilberto Camara)
Date: Sun, 25 Jun 2023 10:48:43 -0300
Subject: [R-sig-Geo] Issues with spatial package "sits" on CRAN
Message-ID: <861DB9E2-20C3-4A0D-B17E-D408961DE0B8@inpe.br>

Dear all,

As a follow-up to Roger?s message, I have been tracking CRAN checks on package ?terra?. Turns out that flavours "r-devel-linux-x86_64-debian-clang? and "r-devel-linux-x86_64-debian-gcc? were reporting errors when checking an earlier version of ?terra? (1.7-37). As of today, "r-devel-linux-x86_64-debian-gcc? has checked the latest version (1.7-39) without errors. 

So, Roger was right: there was a cascade effect because "r-devel-linux-x86_64-debian-cland? was checking the previous version of ?terra?. The problem is likely to fix itself in the next days, when it is likely that "r-devel-linux-x86_64-debian-clang? will switch to version 1.7-37.

That said, spare a thought from CRAN developers. Their work is extraordinary. 

Best 
Gilberto
============================
Prof Dr Gilberto Camara
Senior Researcher
National Institute for Space Research (INPE), Brazil
https://gilbertocamara.org/
=============================


