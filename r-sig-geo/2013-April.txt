From apbc2 at cam.ac.uk  Mon Apr  1 16:13:59 2013
From: apbc2 at cam.ac.uk (A.P.B. Carneiro)
Date: 01 Apr 2013 15:13:59 +0100
Subject: [R-sig-Geo] question
In-Reply-To: <mailman.7.1348912803.12587.r-sig-geo@r-project.org>
References: <mailman.7.1348912803.12587.r-sig-geo@r-project.org>
Message-ID: <Prayer.1.3.5.1304011513590.24747@hermes-1.csi.cam.ac.uk>

Dear all,

I am trying to calculate an area from a picture. I think I can use Spatial 
Analyst but I am not sure how to do it.

I have a picture from the wing of a bird, and from there, I want to 
calculate the area of a white patch. The picture is with a scale bar.

Is there a way to do that? There is not spatial information on the picture.

Thanks in advance,

Ana


On Sep 29 2012, r-sig-geo-request at r-project.org wrote:

>Send R-sig-Geo mailing list submissions to
>	r-sig-geo at r-project.org
>
>To subscribe or unsubscribe via the World Wide Web, visit
>	https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>or, via email, send a message with subject or body 'help' to
>	r-sig-geo-request at r-project.org
>
>You can reach the person managing the list at
>	r-sig-geo-owner at r-project.org
>
>When replying, please edit your Subject line so it is more specific
>than "Re: Contents of R-sig-Geo digest..."
>
>
>Today's Topics:
>
>   1. Re: plotting holes of esri shape files (Edzer Pebesma)
>   2. Re: basic question about plotKML (Struve,Juliane)
>   3. Re: basic question about plotKML (Edzer Pebesma)
>   4. Re: basic question about plotKML (Struve,Juliane)
>   5. Re: Create a raster brick from a netcdf using all levels
>      (Robert J. Hijmans)
>   6. Re: NaN / NA values in SpatialPixelDataFrame conversion
>      (Robert J. Hijmans)
>   7. Re: Error when trying to extract values for points in a
>      SpatialPointsDataFrame (Robert J. Hijmans)
>
>
>----------------------------------------------------------------------
>
>Message: 1
>Date: Fri, 28 Sep 2012 13:18:18 +0200
>From: Edzer Pebesma <edzer.pebesma at uni-muenster.de>
>To: "r-sig-geo at r-project.org" <r-sig-geo at r-project.org>
>Subject: Re: [R-sig-Geo] plotting holes of esri shape files
>Message-ID: <5065877A.5090805 at uni-muenster.de>
>Content-Type: text/plain; charset=ISO-8859-1
>
>Stefan,
>
>with the help of
>
>http://www.stat.auckland.ac.nz/~paul/R/Paths/MurrellPaths.pdf
>
>I corrected this in spplot. To run it, you'd need to compile from source
>on svn, or source this in your R session:
>
>  
> https://r-forge.r-project.org/scm/viewvc.php/*checkout*/pkg/sp/R/spplot.R?root=rspatial
>
>or wait for the next release on CRAN (due soon, I hope).
>
>spplot now also supports holes in polygons when the polygons are the
>main object to plot, contain holes, and something in the background
>should shine through.
>
>Building on the example in
>https://stat.ethz.ch/pipermail/r-sig-geo/2012-September/016116.html
>
>p1 = spplot(mask, col.regions='lightgrey',
>    sp.layout = list("sp.grid", as(dem_ascii, "SpatialGridDataFrame"),
>    col = bpy.colors(), first = TRUE), main = "spplot of mask")
>p2 = spplot(dem_ascii, col.regions=bpy.colors(), main = "spplot of dem",
>    sp.layout = list("sp.polygons", mask, fill = 'lightgray', first =
>FALSE))
>png('spplot.png', 600, 600)
>print(p1, split = c(1,1,1,2), more = TRUE)
>print(p2, split = c(1,2,1,2))
>dev.off()
>
>gives http://ifgi.uni-muenster.de/~epebe_01/spplot.png as output. Mind
>the legends.
>
>With best regards,
>
>On 09/20/2012 10:32 AM, sluedtke wrote:
>> Dear friends, 
>> 
>> 
>> am trying to overlay a polygon data set as a SpatialPolygonDateFrame to
>> an existing plot. The data set has a hole in the middle, and I do not
>> want to have any filling in there. If a check the shape in a GIS,
>> everything looks fine, but using the following commands to do the plot,
>> the hole is filled. 
>> 
>> That is the code I am using, the data is attached. Thanks in advance!
>> 
>> Stefan
>> 
>> 
>> 
>>  
>>  
>> ################################################################################################
>> 
>> library(sp)
>> library(rgdal)
>> library(raster)
>> library(latticeExtra)
>> 
>> 
>>  
>>  
>> ############################################################################################### 
>> #read the DEM from the ASCII format
>> 
>> dem_ascii=raster(readGDAL("./zerafshan_mod_dem.asc"))
>> 
>> 
>>  
>>  
>> ############################################################################################### 
>> # read additional data for printing mask=readOGR("./", "mask_zerafshan")
>> 
>>  
>>  
>> ###############################################################################################
>> 
>> #plot this stuff
>> plot_dem=spplot(dem_ascii, col.regions=terrain.colors(400),
>> colorkey=list(width=1, space="right"))+
>> layer(sp.polygons(mask,fill="lightgray"))
>> 
>> print(plot_dem) 
>> ################################################################################################
>> 
>> 
>> 
>> mask_zerafshan.dbf (110 bytes) 
>> <http://r-sig-geo.2731867.n2.nabble.com/attachment/7580992/0/mask_zerafshan.dbf> 
>> mask_zerafshan.prj (143 bytes) 
>> <http://r-sig-geo.2731867.n2.nabble.com/attachment/7580992/1/mask_zerafshan.prj> 
>> mask_zerafshan.shp (173K) 
>> <http://r-sig-geo.2731867.n2.nabble.com/attachment/7580992/2/mask_zerafshan.shp> 
>> mask_zerafshan.shx (150 bytes) 
>> <http://r-sig-geo.2731867.n2.nabble.com/attachment/7580992/3/mask_zerafshan.shx> 
>> zerafshan_mod_dem.asc (1M) 
>> <http://r-sig-geo.2731867.n2.nabble.com/attachment/7580992/4/zerafshan_mod_dem.asc>
>> 
>> 
>> 
>> 
>> -- View this message in context: 
>> http://r-sig-geo.2731867.n2.nabble.com/plotting-holes-of-esri-shape-files-tp7580992.html 
>> Sent from the R-sig-geo mailing list archive at Nabble.com.
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
>
>

-- 

PhD student
Evolutionary Ecology Group
Department of Zoology
University of Cambridge


From d.orme at imperial.ac.uk  Mon Apr  1 20:14:22 2013
From: d.orme at imperial.ac.uk (Orme, David)
Date: Mon, 1 Apr 2013 18:14:22 +0000
Subject: [R-sig-Geo] question
In-Reply-To: <Prayer.1.3.5.1304011513590.24747@hermes-1.csi.cam.ac.uk>
References: <mailman.7.1348912803.12587.r-sig-geo@r-project.org>
	<Prayer.1.3.5.1304011513590.24747@hermes-1.csi.cam.ac.uk>
Message-ID: <495E3A8F73863D4A8BCFD8969C18B3784B24627A@icexch-m6.ic.ac.uk>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130401/b5c2ee80/attachment.pl>

From Rainer at krugs.de  Tue Apr  2 11:09:40 2013
From: Rainer at krugs.de (Rainer M. Krug)
Date: Tue, 2 Apr 2013 11:09:40 +0200
Subject: [R-sig-Geo] BUG in set.pluginOption() in spGRASS6
In-Reply-To: <alpine.LRH.2.03.1303301843150.28684@reclus.nhh.no> (Roger
	Bivand's message of "Sat, 30 Mar 2013 18:43:53 +0100")
References: <CAGhLh6GV6_vbPqDG2A4GGi9j1SKf__ces4TgOGQYLV6vL5HbNA@mail.gmail.com>
	<alpine.LRH.2.03.1303301843150.28684@reclus.nhh.no>
Message-ID: <87r4itnvsb.fsf@krugs.de>

Roger Bivand <Roger.Bivand at nhh.no> writes:

> On Fri, 29 Mar 2013, Rainer M Krug wrote:
>
>> Hi
>>
>> using spgrass6_0.7-15 on Ubuntu, there is an error in the function
>> set.pluginOption() as it always raises an error "logical argument required".
>>
>> The Check
>>
>> if (!is.logical(value) || !is.null(value)) stop("logical argument required")
>>
>> always returns TRUE and therefore always raises the error.
>
> Please try the recent commit to R-forge, spgrass6 module, rspatial
> project.

Hi Roger

just installed the one from R-forge and it is working for TRUE and FALSE
- but it is not possible to set it to NULL - is this by design?

As I want tu use FALSE, I am fiine with as it is, but it would be
consistent with the possible values for "plugin" if one could set NULL
as well.

Thanks,

Rainer

>
> Roger
>
>>
>> Cheers,
>>
>> Rainer
>>
>>
>>

-- 
Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation Biology, UCT), Dipl. Phys. (Germany)

Centre of Excellence for Invasion Biology
Stellenbosch University
South Africa

Tel :       +33 - (0)9 53 10 27 44
Cell:       +33 - (0)6 85 62 59 98
Fax :       +33 - (0)9 58 10 27 44

Fax (D):    +49 - (0)3 21 21 25 22 44

email:      Rainer at krugs.de

Skype:      RMkrug


From Roger.Bivand at nhh.no  Tue Apr  2 13:58:34 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 2 Apr 2013 13:58:34 +0200
Subject: [R-sig-Geo] BUG in set.pluginOption() in spGRASS6
In-Reply-To: <87r4itnvsb.fsf@krugs.de>
References: <CAGhLh6GV6_vbPqDG2A4GGi9j1SKf__ces4TgOGQYLV6vL5HbNA@mail.gmail.com>
	<alpine.LRH.2.03.1303301843150.28684@reclus.nhh.no>
	<87r4itnvsb.fsf@krugs.de>
Message-ID: <alpine.LRH.2.03.1304021357300.18590@reclus.nhh.no>

On Tue, 2 Apr 2013, Rainer M. Krug wrote:

> Roger Bivand <Roger.Bivand at nhh.no> writes:
>
>> On Fri, 29 Mar 2013, Rainer M Krug wrote:
>>
>>> Hi
>>>
>>> using spgrass6_0.7-15 on Ubuntu, there is an error in the function
>>> set.pluginOption() as it always raises an error "logical argument required".
>>>
>>> The Check
>>>
>>> if (!is.logical(value) || !is.null(value)) stop("logical argument required")
>>>
>>> always returns TRUE and therefore always raises the error.
>>
>> Please try the recent commit to R-forge, spgrass6 module, rspatial
>> project.
>
> Hi Roger
>
> just installed the one from R-forge and it is working for TRUE and FALSE
> - but it is not possible to set it to NULL - is this by design?

I've reverted to permit NULL as well as TRUE and FALSE as it is the 
default value (use plugin if available) in revision 1371.

Roger

>
> As I want tu use FALSE, I am fiine with as it is, but it would be
> consistent with the possible values for "plugin" if one could set NULL
> as well.
>
> Thanks,
>
> Rainer
>
>>
>> Roger
>>
>>>
>>> Cheers,
>>>
>>> Rainer
>>>
>>>
>>>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Rainer at krugs.de  Tue Apr  2 14:53:36 2013
From: Rainer at krugs.de (Rainer M. Krug)
Date: Tue, 2 Apr 2013 14:53:36 +0200
Subject: [R-sig-Geo] BUG in set.pluginOption() in spGRASS6
In-Reply-To: <alpine.LRH.2.03.1304021357300.18590@reclus.nhh.no> (Roger
	Bivand's message of "Tue, 2 Apr 2013 13:58:34 +0200")
References: <CAGhLh6GV6_vbPqDG2A4GGi9j1SKf__ces4TgOGQYLV6vL5HbNA@mail.gmail.com>
	<alpine.LRH.2.03.1303301843150.28684@reclus.nhh.no>
	<87r4itnvsb.fsf@krugs.de>
	<alpine.LRH.2.03.1304021357300.18590@reclus.nhh.no>
Message-ID: <87txnpm6un.fsf@krugs.de>

Roger Bivand <Roger.Bivand at nhh.no> writes:

> On Tue, 2 Apr 2013, Rainer M. Krug wrote:
>
>> Roger Bivand <Roger.Bivand at nhh.no> writes:
>>
>>> On Fri, 29 Mar 2013, Rainer M Krug wrote:
>>>
>>>> Hi
>>>>
>>>> using spgrass6_0.7-15 on Ubuntu, there is an error in the function
>>>> set.pluginOption() as it always raises an error "logical argument required".
>>>>
>>>> The Check
>>>>
>>>> if (!is.logical(value) || !is.null(value)) stop("logical argument required")
>>>>
>>>> always returns TRUE and therefore always raises the error.
>>>
>>> Please try the recent commit to R-forge, spgrass6 module, rspatial
>>> project.
>>
>> Hi Roger
>>
>> just installed the one from R-forge and it is working for TRUE and FALSE
>> - but it is not possible to set it to NULL - is this by design?
>
> I've reverted to permit NULL as well as TRUE and FALSE as it is the
> default value (use plugin if available) in revision 1371.

Thanks - is working as expected.

Rainer

>
> Roger
>
>>
>> As I want tu use FALSE, I am fiine with as it is, but it would be
>> consistent with the possible values for "plugin" if one could set NULL
>> as well.
>>
>> Thanks,
>>
>> Rainer
>>
>>>
>>> Roger
>>>
>>>>
>>>> Cheers,
>>>>
>>>> Rainer
>>>>
>>>>
>>>>
>>
>>

-- 
Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation Biology, UCT), Dipl. Phys. (Germany)

Centre of Excellence for Invasion Biology
Stellenbosch University
South Africa

Tel :       +33 - (0)9 53 10 27 44
Cell:       +33 - (0)6 85 62 59 98
Fax :       +33 - (0)9 58 10 27 44

Fax (D):    +49 - (0)3 21 21 25 22 44

email:      Rainer at krugs.de

Skype:      RMkrug


From Andrew.Duff at dfw.wa.gov  Tue Apr  2 19:08:17 2013
From: Andrew.Duff at dfw.wa.gov (Duff, Andrew A (DFW))
Date: Tue, 2 Apr 2013 17:08:17 +0000
Subject: [R-sig-Geo] plot.circular - color by attribute?
Message-ID: <F69351571CBC1942904F278D3B8FFB1707172EBF@WAXMXOLYMB026.WAX.wa.lcl>

Hi List - I am looking for a way to color a circular plot of aspect values by attribute using the circular package.  What I have below is the circular plot for all of the data which is pretty strait forward but I would like to make a legend and color the points by animal ID to look for patterns.  Does anybody have any suggestions?

[cid:image001.png at 01CE2F89.FF053740]

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130402/aa7e9fb9/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 8070 bytes
Desc: image001.png
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130402/aa7e9fb9/attachment.png>

From cbbaniya at gmail.com  Wed Apr  3 03:50:57 2013
From: cbbaniya at gmail.com (Chitra Baniya)
Date: Wed, 3 Apr 2013 07:35:57 +0545
Subject: [R-sig-Geo] normal distribution and probability
Message-ID: <1E0C1632-1C9E-46FD-9FA8-9AC93BA2294F@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130403/1606cf86/attachment.pl>

From salbeke at uwyo.edu  Wed Apr  3 04:21:09 2013
From: salbeke at uwyo.edu (Shannon E. Albeke)
Date: Wed, 3 Apr 2013 02:21:09 +0000
Subject: [R-sig-Geo] rgdal and MSSQL Server geometries
Message-ID: <D83D818A246DF942BC711856FA4F2ECF8E961C@ponyexpress-m8.uwyo.edu>

Dear r-geo list, 
I am potentially struggling with some syntax and thought that maybe someone has solved a similar issue. I am trying to use 'rgdal' package and the readOGR function to read in a data table from a MS SQL Server 2012 instance. In the table I have a column of type 'geometry'. In this example the data are simply polygons describing Local Hulls for individual animals. I would like read in the these polygons using readOGR just like I would if I were to read in an ESRI Shapefile. However, when I run the following line of code I get the error for ogrInfo function:

#/////////////////////
poly<- readOGR(dsn='MSSQL:server=CPU\\CPU_SQL2012EXP;database=Deer;uid=myUser;trusted_connection=true', layer='CollarPoly')

Error in ogrInfo(dsn = dsn, layer = layer, encoding = encoding, use_iconv = use_iconv) : 
  Cannot open file
#////////////////////

I have looked and it appears that I have the correct ogrDrivers
ogrDrivers()
25   MSSQLSpatial  TRUE

I feel that what I am trying to accomplish is possible, and after searching through quite a few gdal resources, I'm just at a loss and am hoping that someone can let me know of a good/simple solution. I do know that I can connect to the same database using RODBC and obtain the data table, but the returned object is not a SpatialPolygonsDataFrame nor has the spatial information readily available (i.e. the shape and coordinate system). I greatly appreciate your time and assistance.

Cheers,
Shannon

sessionInfo()
R version 2.15.2 (2012-10-26)
Platform: x86_64-w64-mingw32/x64 (64-bit)

locale:
[1] LC_COLLATE=English_United States.1252 
[2] LC_CTYPE=English_United States.1252   
[3] LC_MONETARY=English_United States.1252
[4] LC_NUMERIC=C                          
[5] LC_TIME=English_United States.1252    

attached base packages:
[1] grid      stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
 [1] PBSmapping_2.65.40 maptools_0.8-21    lattice_0.20-10   
 [4] foreign_0.8-51     gpclib_1.5-1       adehabitatHR_0.4.4
 [7] adehabitatLT_0.3.7 CircStats_0.2-4    boot_1.3-7        
[10] MASS_7.3-22        adehabitatMA_0.3.4 ade4_1.5-1        
[13] deldir_0.0-21      rgeos_0.2-11       RODBC_1.3-6       
[16] rgdal_0.8-01       raster_2.0-41      sp_1.0-5          

loaded via a namespace (and not attached):
[1] tools_2.15.2


From mathieu.rajerison at gmail.com  Wed Apr  3 10:07:35 2013
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Wed, 3 Apr 2013 10:07:35 +0200
Subject: [R-sig-Geo] raster::distance, "raster has a longitude/latitude CRS,
 but coordinates do not match that"
Message-ID: <CAGfc75kGdtAD5HPaoUiwUnzQtn4Db_t9cEJUJ8Ojko0quTrnTw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130403/218543a9/attachment.pl>

From kridox at ymail.com  Wed Apr  3 10:34:09 2013
From: kridox at ymail.com (Pascal Oettli)
Date: Wed, 03 Apr 2013 17:34:09 +0900
Subject: [R-sig-Geo] raster::distance,
 "raster has a longitude/latitude CRS, but coordinates do not match that"
In-Reply-To: <CAGfc75kGdtAD5HPaoUiwUnzQtn4Db_t9cEJUJ8Ojko0quTrnTw@mail.gmail.com>
References: <CAGfc75kGdtAD5HPaoUiwUnzQtn4Db_t9cEJUJ8Ojko0quTrnTw@mail.gmail.com>
Message-ID: <515BE981.6000902@ymail.com>

Hello,

When I run your script, I get warnings, not errors. And the raster file 
"dist" is created.

Regards,
Pascal


On 04/03/2013 05:07 PM, Mathieu Rajerison wrote:
> Hi,
>
> I've got a vector layer of the world that I took from Natural Earth.
>
> I tried to get a distance raster from the coastline. With a raster
> resolution of 10, no problem, I get the distance raster. But if I decrease
> the resolution to 5, I get the error:
>
> "1: In .couldBeLonLat(x) :
>    raster has a longitude/latitude CRS, but coordinates do not match that
> 2: In raster:::.couldBeLonLat(x) :
>    raster has a longitude/latitude CRS, but coordinates do not match that"
>
>
> Here is the code:
>
> library(rgdal)
> library(raster)
>
> world <- readOGR("F:/DATAS/NATURAL
> EARTH/ne_110m_admin_0_countries_lakes/ne_110m_admin_0_countries_lakes.shp",
> "ne_110m_admin_0_countries_lakes")
>
> r <- raster(extent(world)); res(r) <- 5; proj4string(r) <-
> CRS("+init=EPSG:4326")
> world.r <- rasterize(world, r)
> dist <- distance(world.r)
>
>
> Here is my session info:
>
>> sessionInfo()
> R version 2.15.1 (2012-06-22)
> Platform: i386-pc-mingw32/i386 (32-bit)
>
> locale:
> [1] LC_COLLATE=French_France.1252  LC_CTYPE=French_France.1252
>   LC_MONETARY=French_France.1252
> [4] LC_NUMERIC=C                   LC_TIME=French_France.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] raster_2.0-12 rgdal_0.7-18  sp_0.9-99
>
> loaded via a namespace (and not attached):
> [1] grid_2.15.1    lattice_0.20-6 tools_2.15.1
>
>
> Thanks for any help,
>
> Mathieu
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From r.hijmans at gmail.com  Wed Apr  3 17:38:01 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 3 Apr 2013 08:38:01 -0700
Subject: [R-sig-Geo] raster::distance,
 "raster has a longitude/latitude CRS, but coordinates do not match that"
In-Reply-To: <CAGfc75kGdtAD5HPaoUiwUnzQtn4Db_t9cEJUJ8Ojko0quTrnTw@mail.gmail.com>
References: <CAGfc75kGdtAD5HPaoUiwUnzQtn4Db_t9cEJUJ8Ojko0quTrnTw@mail.gmail.com>
Message-ID: <CANtt_hyfO-kHACVqeWCYL=DpZUFp83o-G3m8-X5VCweufbmXeA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130403/3dfbe1a1/attachment.pl>

From berman.jesse at gmail.com  Thu Apr  4 00:22:30 2013
From: berman.jesse at gmail.com (Jesse Berman)
Date: Wed, 3 Apr 2013 15:22:30 -0700 (PDT)
Subject: [R-sig-Geo] Maptools package
Message-ID: <1365027750874-7583198.post@n2.nabble.com>

Hi all,

I've loaded the new version of R 3.0.0 and it seems the package 'maptools'
is not available on the mirrors.  It's not urgent, but I'm curious if anyone
knows when it might become available?  Thanks.

Regards,
Jesse



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Maptools-package-tp7583198.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Roger.Bivand at nhh.no  Thu Apr  4 08:15:42 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 4 Apr 2013 08:15:42 +0200
Subject: [R-sig-Geo] Maptools package
In-Reply-To: <1365027750874-7583198.post@n2.nabble.com>
References: <1365027750874-7583198.post@n2.nabble.com>
Message-ID: <alpine.LRH.2.03.1304040807210.30117@reclus.nhh.no>

On Thu, 4 Apr 2013, Jesse Berman wrote:

> Hi all,
>
> I've loaded the new version of R 3.0.0 and it seems the package 'maptools'
> is not available on the mirrors.  It's not urgent, but I'm curious if anyone
> knows when it might become available?  Thanks.

This only applies to OSX for 3.0.0, 2.15.* appear still to be supported. 
The issue seems to be the absence of rgeos, which is suggested by 
maptools. There are also issues for OSX wrt. rgdal. This suggests that OSX 
users should stay on 2.15.* until things calm down. I released new sp, 
rgeos, and rgdal to suit an OSX transition from gcc to clang a few days 
ago, so probably OSX will catch up in a number of days.

Hope this clarifies,

Roger

>
> Regards,
> Jesse
>
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Maptools-package-tp7583198.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From genoveva.gonzalez-mirelis at imr.no  Thu Apr  4 13:22:53 2013
From: genoveva.gonzalez-mirelis at imr.no (Gonzalez-Mirelis Genoveva)
Date: Thu, 4 Apr 2013 11:22:53 +0000
Subject: [R-sig-Geo] seemingly unresolved problem with predict() in package
	raster
Message-ID: <0DBECC7FEDC4614290837899A2C4B013018E15@EXMBX2.imr.no>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130404/9f2a113a/attachment.pl>

From hein.bouwmeester at wur.nl  Thu Apr  4 13:48:02 2013
From: hein.bouwmeester at wur.nl (Bouwmeester, Hein)
Date: Thu, 4 Apr 2013 11:48:02 +0000
Subject: [R-sig-Geo] predict function of regressors in the raster package
Message-ID: <A2A457C4532D144AB15B64E1423BC1A417BB47@SCOMP0935.wurnet.nl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130404/5696f036/attachment.pl>

From hnstedu at 163.com  Thu Apr  4 14:11:04 2013
From: hnstedu at 163.com (hnstedu)
Date: Thu, 4 Apr 2013 20:11:04 +0800 (CST)
Subject: [R-sig-Geo] collect latitude/longitude of various countries
Message-ID: <1a4f59aa.1c1d1.13dd4f514c5.Coremail.hnstedu@163.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130404/cb4fda97/attachment.pl>

From Craig.Mundy at utas.edu.au  Thu Apr  4 15:51:58 2013
From: Craig.Mundy at utas.edu.au (cmundy)
Date: Thu, 4 Apr 2013 06:51:58 -0700 (PDT)
Subject: [R-sig-Geo] rgdal and MSSQL Server geometries
In-Reply-To: <D83D818A246DF942BC711856FA4F2ECF8E961C@ponyexpress-m8.uwyo.edu>
References: <D83D818A246DF942BC711856FA4F2ECF8E961C@ponyexpress-m8.uwyo.edu>
Message-ID: <1365083518571-7583203.post@n2.nabble.com>

Hi Shannon,

The following syntax has worked for me for the past year.

projstring <- CRS('+init=epsg:28355')

##Establish the dsn
# Note: use the odbc tool in Windows to create a dsn for your SQL Server
database beforehand
myMSSQLdsn <-
c("MSSQL:server=mysqlservername;database=mydatabase;trusted_connection=yes")

#Confirm connection is working
ogrListLayers(myMSSQLdsn)

#Reading sp object classes from SQL SERVER
lyr <- c("mssqlserverTablename")
spdf <-readOGR(dsn=myMSSQLdsn, layer=lyr,p4s=CRSargs(projstring))


#Writing sp object classes to SQL SERVER
lyrout= c("NewMSSQLSpatialTableName")
writeOGR(spdfname, dsn=myMSSQLdsn, layer=lyrout, driver="MSSQLSpatial",
layer_options=c("SRID=28355"))


If you haven't created a dsn, this could be a big part of your problem.

Craig



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/rgdal-and-MSSQL-Server-geometries-tp7583193p7583203.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Craig.Mundy at utas.edu.au  Thu Apr  4 16:00:08 2013
From: Craig.Mundy at utas.edu.au (cmundy)
Date: Thu, 4 Apr 2013 07:00:08 -0700 (PDT)
Subject: [R-sig-Geo] Help converting matlab raster to R raster brick
Message-ID: <1365084008796-7583204.post@n2.nabble.com>

Hi All,

I have been provided with a .mat file containing a time series of Sea
Surface Temperature data (50 x 42 cells with 92 time layers). It was a
"Struct" object in Matlab. I can happily import the file in to R using
R.matlab, creating a list as follows. My question is how then to convert
this to a raster brick?

Thanks

Craig

> library(R.matlab)
> test <- readMat("CraigMundy.mat")
> str(test)
List of 2
 $ data :List of 9
  ..$ : num [1, 1:92] 734138 734139 734140 734141 734142 ...
  ..$ : num [1:50, 1:42, 1:92] 14.4 14.5 15.2 15.3 14.8 ...
  ..$ : num [1:50, 1] -44.3 -44.3 -44.3 -44.2 -44.2 ...
  ..$ : num [1, 1:42] 147 147 147 147 147 ...
  ..$ : num [1, 1] 101
  ..$ : chr [1, 1] " SST: 3 Day Composite"
  ..$ : num [1, 1] 0
  ..$ : num [1, 1] 34.5
  ..$ : num [1, 1] 0.44
  ..- attr(*, "dim")= int [1:3] 9 1 1
  ..- attr(*, "dimnames")=List of 3
  .. ..$ : chr [1:9] "Time" "Values" "Lat" "Long" ...
  .. ..$ : NULL
  .. ..$ : NULL
 $ times: chr [1:92, 1] "31-Dec-2009" "01-Jan-2010" "02-Jan-2010"
"03-Jan-2010" ...
 - attr(*, "header")=List of 3
  ..$ description: chr "MATLAB 5.0 MAT-file, Platform: PCWIN64, Created on:
Thu Apr 04 11:29:53 2013                                                "
  ..$ version    : chr "5"
  ..$ endian     : chr "little"



> version
               _                           
platform       x86_64-w64-mingw32          
arch           x86_64                      
os             mingw32                     
system         x86_64, mingw32             
status                                     
major          3                           
minor          0.0                         
year           2013                        
month          04                          
day            03                          
svn rev        62481                       
language       R                           
version.string R version 3.0.0 (2013-04-03)
nickname       Masked Marvel



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Help-converting-matlab-raster-to-R-raster-brick-tp7583204.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From berman.jesse at gmail.com  Thu Apr  4 16:42:35 2013
From: berman.jesse at gmail.com (Jesse Berman)
Date: Thu, 4 Apr 2013 07:42:35 -0700 (PDT)
Subject: [R-sig-Geo] predict function of regressors in the raster package
In-Reply-To: <A2A457C4532D144AB15B64E1423BC1A417BB47@SCOMP0935.wurnet.nl>
References: <A2A457C4532D144AB15B64E1423BC1A417BB47@SCOMP0935.wurnet.nl>
Message-ID: <1365086555579-7583205.post@n2.nabble.com>

Hi Hein,

I'm not sure if this will help, but one thing to check is that your
prediction grid has covariate data for each of the 40,000 cells.  If a large
number of cells have 'NA' as data values, then sometimes the prediction will
not work.  Offhandedly, it strikes me that ycoord may be limited to only
your t0 locations.

Jesse



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/predict-function-of-regressors-in-the-raster-package-tp7583201p7583205.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From r.hijmans at gmail.com  Thu Apr  4 16:47:12 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 4 Apr 2013 07:47:12 -0700
Subject: [R-sig-Geo] predict function of regressors in the raster package
In-Reply-To: <1365086555579-7583205.post@n2.nabble.com>
References: <A2A457C4532D144AB15B64E1423BC1A417BB47@SCOMP0935.wurnet.nl>
	<1365086555579-7583205.post@n2.nabble.com>
Message-ID: <CANtt_hzNadkF76SrVCxBqaZFm5sb+tKGc9D8yO60rs57PmJadQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130404/74ad3126/attachment.pl>

From r.hijmans at gmail.com  Thu Apr  4 17:52:50 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 4 Apr 2013 08:52:50 -0700
Subject: [R-sig-Geo] seemingly unresolved problem with predict() in
 package raster
In-Reply-To: <0DBECC7FEDC4614290837899A2C4B013018E15@EXMBX2.imr.no>
References: <0DBECC7FEDC4614290837899A2C4B013018E15@EXMBX2.imr.no>
Message-ID: <CANtt_hxgVi1wzZ9mt8rkS47Wjt6v8oPXcnWX9Ekz81UhfEoXjw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130404/a03e87bc/attachment.pl>

From salbeke at uwyo.edu  Thu Apr  4 18:20:39 2013
From: salbeke at uwyo.edu (Shannon E. Albeke)
Date: Thu, 4 Apr 2013 16:20:39 +0000
Subject: [R-sig-Geo] rgdal and MSSQL Server geometries
In-Reply-To: <1365083518571-7583203.post@n2.nabble.com>
References: <D83D818A246DF942BC711856FA4F2ECF8E961C@ponyexpress-m8.uwyo.edu>
	<1365083518571-7583203.post@n2.nabble.com>
Message-ID: <D83D818A246DF942BC711856FA4F2ECF8EA650@ponyexpress-m8.uwyo.edu>

Craig, thanks for the idea. I did create a DSN using ODBC as well as using an explicit string connection. Both give me the same result of: 'Cannot open data source'

Thus, I am thoroughly confused because I can connect to the SQL Server via all of my other methods (RODBC) and software with no issues. I am wondering if there is something with rgdal that is having a miscommunication with the proper drivers. If so, I really do not know how to solve the issue. Hopefully some other ideas will surface from the r-sig-geo list that can provide additional troubleshooting that I can try. 

Cheers,
Shannon

-----Original Message-----
From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of cmundy
Sent: Thursday, April 04, 2013 7:52 AM
To: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] rgdal and MSSQL Server geometries

Hi Shannon,

The following syntax has worked for me for the past year.

projstring <- CRS('+init=epsg:28355')

##Establish the dsn
# Note: use the odbc tool in Windows to create a dsn for your SQL Server database beforehand myMSSQLdsn <-
c("MSSQL:server=mysqlservername;database=mydatabase;trusted_connection=yes")

#Confirm connection is working
ogrListLayers(myMSSQLdsn)

#Reading sp object classes from SQL SERVER lyr <- c("mssqlserverTablename") spdf <-readOGR(dsn=myMSSQLdsn, layer=lyr,p4s=CRSargs(projstring))


#Writing sp object classes to SQL SERVER lyrout= c("NewMSSQLSpatialTableName") writeOGR(spdfname, dsn=myMSSQLdsn, layer=lyrout, driver="MSSQLSpatial",
layer_options=c("SRID=28355"))


If you haven't created a dsn, this could be a big part of your problem.

Craig



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/rgdal-and-MSSQL-Server-geometries-tp7583193p7583203.html
Sent from the R-sig-geo mailing list archive at Nabble.com.

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Craig.Mundy at utas.edu.au  Thu Apr  4 22:02:34 2013
From: Craig.Mundy at utas.edu.au (cmundy)
Date: Thu, 4 Apr 2013 13:02:34 -0700 (PDT)
Subject: [R-sig-Geo] rgdal and MSSQL Server geometries
In-Reply-To: <D83D818A246DF942BC711856FA4F2ECF8EA650@ponyexpress-m8.uwyo.edu>
References: <D83D818A246DF942BC711856FA4F2ECF8E961C@ponyexpress-m8.uwyo.edu>
	<1365083518571-7583203.post@n2.nabble.com>
	<D83D818A246DF942BC711856FA4F2ECF8EA650@ponyexpress-m8.uwyo.edu>
Message-ID: <1365105754260-7583209.post@n2.nabble.com>

Hi Shannon,

The other requirement to read tables from MS SQL Server is that details of
the table with geometry columns must be registered in a table called
geometry_columns in your database. If your database doesn't have this table,
do the following;

1)  write a small point or polygon object back to SQL Server using writeOGR. 
2) This process will create two additional tables, the geometry_columns
table and a spatial_ref_sys table.
3) open the geometry_columns table in SQL Server, and create a new record
with the details of the table you want to read into R, following the pattern
of the record created by the write process.
4) try reading the table again

I'm out of the office for a day or so, but happy to help work this out. I
use rgdal to exchange spatial data between  R and SQL Server on a weekly
basis, so can at least confirm that it works very nicely.

Craig



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/rgdal-and-MSSQL-Server-geometries-tp7583193p7583209.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From mdsumner at gmail.com  Thu Apr  4 23:35:17 2013
From: mdsumner at gmail.com (Michael Sumner)
Date: Thu, 4 Apr 2013 16:35:17 -0500
Subject: [R-sig-Geo] Help converting matlab raster to R raster brick
In-Reply-To: <1365084008796-7583204.post@n2.nabble.com>
References: <1365084008796-7583204.post@n2.nabble.com>
Message-ID: <CAAcGz9_tfDSg6e-nCZAUiT_V_rjshPaJUSWsxnjMXJ6KLd90ZQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130404/55ccd21b/attachment.pl>

From Tom_Roche at pobox.com  Fri Apr  5 06:21:32 2013
From: Tom_Roche at pobox.com (Tom Roche)
Date: Fri, 05 Apr 2013 00:21:32 -0400
Subject: [R-sig-Geo] [raster] conserving dimensions when regridding a 4D
	Brick or Stack
Message-ID: <87y5cxehf7.fsf@pobox.com>


summary: When regridding a 4D Brick (e.g., the netCDF data variable
Fraction_of_Emissions(TSTEP, LAY, ROW, COL) in 

> netcdf GFED-3.1_2008_N2O_3hourly_fractions {
> dimensions:
>   TSTEP = 12 ;
>   LAY = 8 ;
>   ROW = 360 ;
>   COL = 720 ;
> variables:
>   float Fraction_of_Emissions(TSTEP, LAY, ROW, COL) ;
>     Fraction_of_Emissions:units = "unitless" ;
>     Fraction_of_Emissions:long_name = "3hourly fraction of monthly N2O emission" ;
>     Fraction_of_Emissions:_FillValue = 9.96921e+36f ;
>   int TSTEP(TSTEP) ;
>     TSTEP:long_name = "index of month in 2008" ;
>     TSTEP:units = "month" ;
>   int LAY(LAY) ;
>     LAY:units = "4-digit hour" ;
>     LAY:long_name = "time of day starting 3-hour-long period" ;
>   float ROW(ROW) ;
>     ROW:units = "degrees_north" ;
>     ROW:long_name = "latitude" ;
>   float COL(COL) ;
>     COL:units = "degrees_east" ;
>     COL:long_name = "longitude" ;

) I want to keep all 4 dimensions in the output. But I am only able to
write 3D output, since I lose dimension=LAY:

> netcdf GFED-3.1_2008_N2O_3hourly_fractions_regrid {
> dimensions:
>   COL = 459 ;
>   ROW = 299 ;
>   TSTEP = UNLIMITED ; // (12 currently)
> variables:
>   double COL(COL) ;
>     COL:units = "meter" ;
>     COL:long_name = "COL" ;
>   double ROW(ROW) ;
>     ROW:units = "meter" ;
>     ROW:long_name = "ROW" ;
>   int TSTEP(TSTEP) ;
>     TSTEP:units = "month" ;
>     TSTEP:long_name = "TSTEP" ;
>   float Fraction_of_Emissions(TSTEP, ROW, COL) ;
>     Fraction_of_Emissions:units = "unitless" ;
>     Fraction_of_Emissions:_FillValue = -3.4e+38 ;
>     Fraction_of_Emissions:missing_value = -3.4e+38 ;
>     Fraction_of_Emissions:long_name = "3hourly fraction of monthly N2O emission" ;
>     Fraction_of_Emissions:projection = "+proj=lcc +lat_1=33 +lat_2=45 +lat_0=40 +lon_0=-97 +a=6370000 +b=6370000" ;
>     Fraction_of_Emissions:projection_format = "PROJ.4" ;

) Can one

+ create a 4D RasterBrick or RasterStack
+ instruct projectRaster

so as to get 4D regridded output? Or must one

- create 3D RasterLayer's (i.e., one per LAY) from the 4D Brick
- regrid each 3D Layer
- reassemble the 4D Brick

? or Something Completely Different?

details:

As part of

https://bitbucket.org/tlroche/gfed-3.1_global_to_aqmeii-na

I need to regrid all 4 dimensions of the data variable
Fraction_of_Emissions(TSTEP, LAY, ROW, COL) in a netCDF file:

> netcdf GFED-3.1_2008_N2O_3hourly_fractions {
> dimensions:
>   TSTEP = 12 ;
>   LAY = 8 ;
>   ROW = 360 ;
>   COL = 720 ;
> variables:
>   float Fraction_of_Emissions(TSTEP, LAY, ROW, COL) ;
>     Fraction_of_Emissions:units = "unitless" ;
>     Fraction_of_Emissions:long_name = "3hourly fraction of monthly N2O emission" ;
>     Fraction_of_Emissions:_FillValue = 9.96921e+36f ;
>   int TSTEP(TSTEP) ;
>     TSTEP:long_name = "index of month in 2008" ;
>     TSTEP:units = "month" ;
>   int LAY(LAY) ;
>     LAY:units = "4-digit hour" ;
>     LAY:long_name = "time of day starting 3-hour-long period" ;
>   float ROW(ROW) ;
>     ROW:units = "degrees_north" ;
>     ROW:long_name = "latitude" ;
>   float COL(COL) ;
>     COL:units = "degrees_east" ;
>     COL:long_name = "longitude" ;

In
https://bitbucket.org/tlroche/gfed-3.1_global_to_aqmeii-na/src/6a214b2076dee1ce4cae5ee44779642b33481d81/vis_regrid_vis.r?at=master
I load the data like (substituting and reformatting for mail)

hour3ly.in.raster <- raster::brick(
  'GFED-3.1_2008_N2O_3hourly_fractions.nc', 
  varname='Fraction_of_Emissions')
hour3ly.in.raster at crs <- global.crs
hour3ly.in.raster
# class       : RasterBrick 
# dimensions  : 360, 720, 259200, 12  (nrow, ncol, ncell, nlayers)
# resolution  : 0.5, 0.5  (x, y)
# extent      : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)
# coord. ref. : +proj=longlat +ellps=WGS84 
# data source : .../GFED-3.1_2008_N2O_3hourly_fractions.nc 
# names       : X1, X2, X3, X4, X5, X6, X7, X8, X9, X10, X11, X12 
# month       : 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12 
# varname     : Fraction_of_Emissions 
# level       : 1 

and then regrid with

hour3ly.out.raster <-
  raster::projectRaster(
    from=hour3ly.in.raster, to=template.raster, crs=out.crs,
    method='bilinear', overwrite=TRUE, format='CDF',
    # args from writeRaster
    varname=hour3ly_out_datavar_name, 
    varunit=hour3ly_out_datavar_units,
    longname=hour3ly_out_datavar_long_name,
    xname=hour3ly_out_x_var_name,
    yname=hour3ly_out_y_var_name,
    zname=hour3ly_out_z_var_name,
    zunit=hour3ly_out_z_var_units,
    filename=hour3ly_out_fp)
hour3ly.out.raster
# class       : RasterBrick 
# dimensions  : 299, 459, 137241, 12  (nrow, ncol, ncell, nlayers)
# resolution  : 12000, 12000  (x, y)
# extent      : -2556000, 2952000, -1728000, 1860000  (xmin, xmax, ymin, ymax)
# coord. ref. : +proj=lcc +lat_1=33 +lat_2=45 +lat_0=40 +lon_0=-97 +a=6370000 +b=6370000 
# data source : /tmp/gfed-3.1_global_to_aqmeii-na/GFED-3.1_2008_N2O_3hourly_fractions_regrid.nc 
# names       : X1, X2, X3, X4, X5, X6, X7, X8, X9, X10, X11, X12 
# month       : 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12 
# varname     : Fraction_of_Emissions 

The output appears to horizontally-regrid correctly, but loses needed
dimension=LAY:

# netcdf GFED-3.1_2008_N2O_3hourly_fractions_regrid {
# dimensions:
#   COL = 459 ;
#   ROW = 299 ;
#   TSTEP = UNLIMITED ; // (12 currently)
# variables:
#   double COL(COL) ;
#     COL:units = "meter" ;
#     COL:long_name = "COL" ;
#   double ROW(ROW) ;
#     ROW:units = "meter" ;
#     ROW:long_name = "ROW" ;
#   int TSTEP(TSTEP) ;
#     TSTEP:units = "month" ;
#     TSTEP:long_name = "TSTEP" ;
#   float Fraction_of_Emissions(TSTEP, ROW, COL) ;

note the input (above) is
    float Fraction_of_Emissions(TSTEP, LAY, ROW, COL) ;

#     Fraction_of_Emissions:units = "unitless" ;
#     Fraction_of_Emissions:_FillValue = -3.4e+38 ;
#     Fraction_of_Emissions:missing_value = -3.4e+38 ;
#     Fraction_of_Emissions:long_name = "3hourly fraction of monthly N2O emission" ;
#     Fraction_of_Emissions:projection = "+proj=lcc +lat_1=33 +lat_2=45 +lat_0=40 +lon_0=-97 +a=6370000 +b=6370000" ;
#     Fraction_of_Emissions:projection_format = "PROJ.4" ;

Based on the latest version of 

http://cran.r-project.org/web/packages/raster/raster.pdf

and on

https://stat.ethz.ch/pipermail/r-sig-geo/2012-September/016175.html

I thought use of the parameters `level` or `lvar` might allow me to
usefully tell `raster` of my desire to get dimension=LAY in the input
to, and the output from, the regridding process. However my attempts
to date have failed :-( Given that in

Fraction_of_Emissions(TSTEP, LAY, ROW, COL)

the horizontal dimensions are in positions=[2,3] in the dimension
array, and guessing at parameter values from the above documents
(which IMHO could be clearer regarding the semantics of `level` and
`lvar`, but perhaps I am missing something), I tried

hour3ly.in.raster <- raster::brick(
  hour3ly_in_fp, varname=hour3ly_in_datavar_name, level=0, lvar=1)

drawing the warning

> Warning message:
> In .rasterObjectFromCDF(x, type = objecttype, band = band, ...) :
>   "level" set to 1 (there are 720 levels)

so I instead tried

hour3ly.in.raster <- raster::brick(
  hour3ly_in_fp, varname=hour3ly_in_datavar_name, level=1, lvar=0)
hour3ly.in.raster at crs <- global.crs
hour3ly.out.raster <-
  raster::projectRaster(
    from=hour3ly.in.raster, to=template.raster, crs=out.crs,
    method='bilinear', overwrite=TRUE, format='CDF',
    # args from writeRaster
    varname=hour3ly_out_datavar_name, 
    varunit=hour3ly_out_datavar_units,
    longname=hour3ly_out_datavar_long_name,
    xname=hour3ly_out_x_var_name,
    yname=hour3ly_out_y_var_name,
    zname=hour3ly_out_z_var_name,
    zunit=hour3ly_out_z_var_units,
    filename=hour3ly_out_fp)

This proceeded without error or warning, but the output from 

system(sprintf('ncdump -h %s', hour3ly_out_fp))

remains unchanged; i.e., still no dimension=LAY in the output file.
Similarly I tried

hour3ly.in.raster <- raster::brick(
  hour3ly_in_fp, varname=hour3ly_in_datavar_name, level=2, lvar=3)

hour3ly.in.raster <- raster::brick(
  hour3ly_in_fp, varname=hour3ly_in_datavar_name, level=3, lvar=2)

and got the same results. What am I doing wrong?

TIA, Tom Roche <Tom_Roche at pobox.com> <Roche.Tom at epa.gov>


From genoveva.gonzalez-mirelis at imr.no  Fri Apr  5 09:05:18 2013
From: genoveva.gonzalez-mirelis at imr.no (Gonzalez-Mirelis Genoveva)
Date: Fri, 5 Apr 2013 07:05:18 +0000
Subject: [R-sig-Geo] seemingly unresolved problem with predict() in
 package raster
In-Reply-To: <CANtt_hxgVi1wzZ9mt8rkS47Wjt6v8oPXcnWX9Ekz81UhfEoXjw@mail.gmail.com>
References: <0DBECC7FEDC4614290837899A2C4B013018E15@EXMBX2.imr.no>
	<CANtt_hxgVi1wzZ9mt8rkS47Wjt6v8oPXcnWX9Ekz81UhfEoXjw@mail.gmail.com>
Message-ID: <0DBECC7FEDC4614290837899A2C4B013018EA8@EXMBX2.imr.no>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130405/623a8a22/attachment.pl>

From milan.kili11 at gmail.com  Fri Apr  5 10:48:00 2013
From: milan.kili11 at gmail.com (Milan Kilibarda)
Date: Fri, 5 Apr 2013 10:48:00 +0200
Subject: [R-sig-Geo] New version of plotGoogleMaps ( now plot STDIF and
	STFDF data)
Message-ID: <CAPSaU-_RMFfw_0+=-gTFrbKH6CU-LFtako7q_TzeXbqAPz=ONg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130405/61296d70/attachment.pl>

From encharbel at gmail.com  Fri Apr  5 10:57:18 2013
From: encharbel at gmail.com (Charbel Eliane)
Date: Fri, 5 Apr 2013 11:57:18 +0300
Subject: [R-sig-Geo] help-problem with attribute table
Message-ID: <CA+XydTT8yW7YygVU1aNVP7o7pWr6CdSv_6DjWQy0cAiHPParkg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130405/1898f97e/attachment.pl>

From omphalodes.verna at yahoo.com  Fri Apr  5 13:24:17 2013
From: omphalodes.verna at yahoo.com (Omphalodes Verna)
Date: Fri, 5 Apr 2013 04:24:17 -0700 (PDT)
Subject: [R-sig-Geo] vertical profile of raster DEM along road (package
	raster)
In-Reply-To: <514B64E80200002700018F6B@gwia2.boku.ac.at>
References: <514B64E80200002700018F6B@gwia2.boku.ac.at>
Message-ID: <1365161057.54302.YahooMailNeo@web164905.mail.bf1.yahoo.com>

Dear Matteo!
?
Thanks
for suggestion. I tried your code, but it seems that it is not working. Please
see my code and in attached files are files.
?
library(sp)
library(raster)
library(rgdal)
?
?
rasGround ?<-
raster("rasGroundCrop.tif", crs = "+proj=tmerc +lat_0=0
+lon_0=15 +k=0.9999 +x_0=500000 +y_0=-5000000 +ellps=bessel
+towgs84=653.0,-212.0,449.0 +units=m +no_defs")
Road34 <- readOGR(".",
"Profil",
p4s = "+proj=tmerc +lat_0=0 +lon_0=15 +k=0.9999
+x_0=500000 +y_0=-5000000 +ellps=bessel +towgs84=653.0,-212.0,449.0 +units=m
+no_defs")
?
?
plot(rasGround)
plot(Road34, add = TRUE, col = "black",
lwd = 3)
plot(extract(rasGround, Road34)[[1]], type =
"l") #Not works
?
Maybe this could be a solution but
I?lose direction:
?
pointsXY <- rasterToPoints(rasGround)
rasX <- rasGround
rasY <- rasGround
rasX[] <- pointsXY[, 1]
rasY[] <- pointsXY[, 2]
?
rasXYZ <- stack(rasGround, rasX, rasY)
segment <- extract(rasXYZ, Road34)[[1]]
IDX <- order(segment[, 2], segment[, 3])
segment <- segment[IDX, ]
plot(segment[,1], type = "l")

Thanks, OV
?



----- Original Message -----
From: Matteo Mattiuzzi <matteo.mattiuzzi at boku.ac.at>
To: r-sig-geo at r-project.org; omphalodes.verna at yahoo.com
Cc: 
Sent: Thursday, March 21, 2013 7:52 PM
Subject: Re: [R-sig-Geo] vertical profile of raster DEM along road (package raster)

Dear Omphalodes,


library(raster)
library(sp)
set.seed(2)
data(volcano)
r <- raster(volcano)
plot(r)
l1 = cbind(c(seq(0,1 , by = 0.1)), runif(11, 0, 1))
S1 = Lines(list(Line(l1)), ID = "a")
lines(S1, asp = 1, col = "red")


S1<-SpatialLines(list(S1)) # I'm not practic in sp, but this at least works!
extract(r,S1)



Matteo

>>> Omphalodes Verna? 03/21/13 6:06 PM >>>
Dear list.

I am asking for advice for getting verticale profile of DEM along line object. I konw, it is easy for one straight line (distance and extract functions) also with using a combination of GRASS and R ( http://casoilresource.lawr.ucdavis.edu/drupal/node/375 ). Is in R possible to do this.

Thanks to all. OV

Here is a sample code:

library(raster)
library(sp)
set.seed(2)
data(volcano)
r <- raster(volcano)
plot(r)
l1 = cbind(c(seq(0,1 , by = 0.1)), runif(11, 0, 1))
S1 = Lines(list(Line(l1)), ID = "a")
lines(S1, asp = 1, col = "red")

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo
-------------- next part --------------
A non-text attachment was scrubbed...
Name: rasGroundCrop.zip
Type: application/x-zip-compressed
Size: 8694 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130405/fbe5245f/attachment.bin>

From matteo.mattiuzzi at boku.ac.at  Fri Apr  5 14:24:51 2013
From: matteo.mattiuzzi at boku.ac.at (Matteo Mattiuzzi)
Date: Fri, 05 Apr 2013 14:24:51 +0200
Subject: [R-sig-Geo] vertical profile of raster DEM along road (package
 raster)
Message-ID: <515EDEB30200002700019245@gwia2.boku.ac.at>

Hi, my doubt is that extract does not sort the values according to the SpatialLine direction but sorts it somehow on its extraction order. I think it is a bug or at least a not ideal behavior in extract() on spatial lines.
I think Robert can clarify this?


library(raster)
# raster example in extract:


 r <- raster(ncol=36, nrow=18)
 r[] <- 1:ncell(r)
 cds1 <- rbind(c(-50,0), c(0,60), c(40,5), c(15,-45), c(-10,-25))
 cds2 <- rbind(c(80,20), c(140,60), c(160,0), c(140,-55))
 lines <- SpatialLines(list(Lines(list(Line(cds1)), "1"), Lines(list(Line(cds2)), "2") ))[1] # only 1 line!


plot(r)
lines(lines)     
x11() 
plot(extract(r, lines)[[1]]) # following the line the values should be sorted differently.
 



#
rasGround  <- raster("rasGroundCrop.tif", crs = "+proj=tmerc +lat_0=0 +lon_0=15 +k=0.9999 +x_0=500000 +y_0=-5000000 +ellps=bessel +towgs84=653.0,-212.0,449.0 +units=m +no_defs")
Road34 <- shapefile("Profil")
projection(Road34) <- projection(rasGround)



plot(rasGround)
plot(Road34, add = TRUE, col = "black", lwd = 3)
plot(extract(rasGround, Road34)[[1]], type = "l") 



Matteo

>>> Omphalodes Verna  04/05/13 1:24 PM >>>
Dear Matteo!
 
Thanks
for suggestion. I tried your code, but it seems that it is not working. Please
see my code and in attached files are files.
 
library(sp)
library(raster)
library(rgdal)
 
 
rasGround  <-
raster("rasGroundCrop.tif", crs = "+proj=tmerc +lat_0=0
+lon_0=15 +k=0.9999 +x_0=500000 +y_0=-5000000 +ellps=bessel
+towgs84=653.0,-212.0,449.0 +units=m +no_defs")
Road34 <- readOGR(".",
"Profil",
p4s = "+proj=tmerc +lat_0=0 +lon_0=15 +k=0.9999
+x_0=500000 +y_0=-5000000 +ellps=bessel +towgs84=653.0,-212.0,449.0 +units=m
+no_defs")
 
 
plot(rasGround)
plot(Road34, add = TRUE, col = "black",
lwd = 3)
plot(extract(rasGround, Road34)[[1]], type =
"l") #Not works
 
Maybe this could be a solution but
I lose direction:
 
pointsXY <- rasterToPoints(rasGround)
rasX <- rasGround
rasY <- rasGround
rasX[] <- pointsXY[, 1]
rasY[] <- pointsXY[, 2]
 
rasXYZ <- stack(rasGround, rasX, rasY)
segment <- extract(rasXYZ, Road34)[[1]]
IDX <- order(segment[, 2], segment[, 3])
segment <- segment[IDX, ]
plot(segment[,1], type = "l")

Thanks, OV
 



----- Original Message -----
From: Matteo Mattiuzzi 
To: r-sig-geo at r-project.org; omphalodes.verna at yahoo.com
Cc: 
Sent: Thursday, March 21, 2013 7:52 PM
Subject: Re: [R-sig-Geo] vertical profile of raster DEM along road (package raster)

Dear Omphalodes,


library(raster)
library(sp)
set.seed(2)
data(volcano)
r <- raster(volcano)
plot(r)
l1 = cbind(c(seq(0,1 , by = 0.1)), runif(11, 0, 1))
S1 = Lines(list(Line(l1)), ID = "a")
lines(S1, asp = 1, col = "red")


S1<-SpatialLines(list(S1)) # I'm not practic in sp, but this at least works!
extract(r,S1)



Matteo

>>> Omphalodes Verna  03/21/13 6:06 PM >>>
Dear list.

I am asking for advice for getting verticale profile of DEM along line object. I konw, it is easy for one straight line (distance and extract functions) also with using a combination of GRASS and R ( http://casoilresource.lawr.ucdavis.edu/drupal/node/375 ). Is in R possible to do this.

Thanks to all. OV

Here is a sample code:

library(raster)
library(sp)
set.seed(2)
data(volcano)
r <- raster(volcano)
plot(r)
l1 = cbind(c(seq(0,1 , by = 0.1)), runif(11, 0, 1))
S1 = Lines(list(Line(l1)), ID = "a")
lines(S1, asp = 1, col = "red")

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From samanmonfared1 at gmail.com  Fri Apr  5 14:33:38 2013
From: samanmonfared1 at gmail.com (Saman Monfared)
Date: Fri, 5 Apr 2013 17:03:38 +0430
Subject: [R-sig-Geo] error in STSDF class
Message-ID: <CAOytA4av3Szf8ydBWFF_wyYcPyJDywa+Mn54ZTTFO0BzfMhNUg@mail.gmail.com>

HI,
I am trying to construct a STSDF class for st data for 17 locations
and 376 times.
what is mean of (Error: order(time, t) == t is not all TRUE)
my code is:

data<-read.table("stfars.cancer.txt",header=TRUE)
cancer.loc<-read.table("cancer.loc.txt",header=TRUE)
stations<-cancer.loc[c(-1,-3,-5,-8,-16,-19,-22),]
sp<-cbind(stations$x,stations$y)
row.names(sp) = paste("point", 1:nrow(sp), sep="")
library(sp)
sp = SpatialPoints(sp)
time = ISOdate(data$year,data$mounth,data$day)
values =rnorm(length(sp)*length(time))
IDs = paste("ID",1:length(values), sep = "_")
mydata = data.frame(values = signif(values, 3), ID=IDs)
library(spacetime)
stfdf = STSDF(sp,time, data = mydata)


order(time, t) == t is not all TRUE

Thanks.--
Saman Monfared
Msc, Department of Statistics, Shiraz University,
Shiraz 71454, Iran
Email: Samanmonfared1 at gmail.com

Tel: +98 917 5305167


From mauricio.zambrano at jrc.ec.europa.eu  Fri Apr  5 16:20:38 2013
From: mauricio.zambrano at jrc.ec.europa.eu (Mauricio Zambrano-Bigiarini)
Date: Fri, 05 Apr 2013 16:20:38 +0200
Subject: [R-sig-Geo] R Package for Climatology particular for netCDF file
In-Reply-To: <CAK8gSG--Cwxo1e9nm-RuT7Yw5KxyB7zuA_SUuBALbac3ABsLfQ@mail.gmail.com>
References: <CAK8gSG--Cwxo1e9nm-RuT7Yw5KxyB7zuA_SUuBALbac3ABsLfQ@mail.gmail.com>
Message-ID: <515EDDB6.90008@jrc.ec.europa.eu>

On 26/03/13 18:13, ping yang wrote:
> Dear Dr. Pierce and R specialists,
>
> I am much appreciated your work on ncdf(ncdf4 and RnetCDF) packages,
> however, I am wondering if those package can go further.
>
> Is there a package for calculating climate statistics ,e.g. monthly mean,
> seasonal mean, yearly mean,spatial mean( like gridboxmean in CDO), and
> climatology for multiyear analysis in R or CRAN ? and Is there a plotting
> library for the climate variables particularly for NetCDF.
>
> I found a little trivial when I plan to do statistical based on daily data
> for long history (I do it using some tools but not efficient, everytime I
> need to generate a file and then use ncdf funcitons to read and then plot.
>
> Thanks,
>
> Ping
>
Hi Ping,

Regarding the climate statistics, you may have a look to the hydroTSM 
package, in particular to the functions:

?monthlyfunction
?seasonalfunction
?dm2seasonal

and the vignette in:

http://cran.r-project.org/web/packages/hydroTSM/vignettes/hydroTSM_Vignette.pdf

IHTH,

Kinds,

Mauricio Zambrano-Bigiarini, Ph.D

-- 
=================================================
Water Resources Unit
Institute for Environment and Sustainability (IES)
Joint Research Centre (JRC), European Commission
TP 261, Via Enrico Fermi 2749, 21027 Ispra (VA), IT
webinfo    : http://floods.jrc.ec.europa.eu/
=================================================
DISCLAIMER:\ "The views expressed are purely those of th...{{dropped:9}}


From salbeke at uwyo.edu  Fri Apr  5 22:33:38 2013
From: salbeke at uwyo.edu (Shannon E. Albeke)
Date: Fri, 5 Apr 2013 20:33:38 +0000
Subject: [R-sig-Geo] rgdal and MSSQL Server geometries
In-Reply-To: <1365105754260-7583209.post@n2.nabble.com>
References: <D83D818A246DF942BC711856FA4F2ECF8E961C@ponyexpress-m8.uwyo.edu>
	<1365083518571-7583203.post@n2.nabble.com>
	<D83D818A246DF942BC711856FA4F2ECF8EA650@ponyexpress-m8.uwyo.edu>
	<1365105754260-7583209.post@n2.nabble.com>
Message-ID: <D83D818A246DF942BC711856FA4F2ECF8EB63F@ponyexpress-m8.uwyo.edu>

Craig, that did the trick, I didn't have the correct tables/schema for gdal to refer to. Now I can read into R, from SQL Server, data tables having a geometry data type. Below I describe the two additional tables that one needs to create to allow rgdal the ability to read from your SQL Server instance:

# for this example, we have an SQL Database named DB_Deer. 
# Within DB_Deer, we have a table containing GPS collar relocation points. The table is named 'tblPts'
# Within tblPts we have a column of type 'geometry' that is named 'SQL_Shape' that contains the XY pair of coordinates in Native format
# Create a new table named 'dbo.geometry_columns' and add the Primary Keys using SQL syntax

USE [DB_Deer]
GO

CREATE TABLE [dbo].[geometry_columns](
  [f_table_catalog] varchar(128) NOT NULL, 
  [f_table_schema] varchar(128) NOT NULL,
  [f_table_name] varchar(256) NOT NULL,
  [f_geometry_column] varchar(256) NOT NULL,
  [coord_dimension] int NOT NULL,
  [srid] int NOT NULL,
  [geometry_type] varchar(30) NOT NULL
  CONSTRAINT [PK_geometry_columns] PRIMARY KEY CLUSTERED
([f_table_catalog] ASC, [f_table_schema] ASC, [f_table_name] ASC, [f_geometry_column] ASC)
   )

# Create a new table named 'dbo.spatial_ref_sys' and add the Primary Key  using SQL syntax
USE [DB_Deer]
GO

CREATE TABLE [dbo].[spatial_ref_sys](
  [srid] int NOT NULL, 
  [auth_name] varchar(256) NULL,
  [auth_srid] int NULL,
  [srtext] varchar(2048) NULL,
  [proj4text] varchar(2048) NULL,
  CONSTRAINT [PK_spatial_ref_sys] PRIMARY KEY CLUSTERED
([srid] ASC)
   )


# Edit the 'spatial_ref_sys' table. In this example the points are projected in Albers Equal Area
USE [DB_Deer]
GO

INSERT INTO [dbo].[spatial_ref_sys]
           ([srid], [auth_name], [auth_srid], [srtext], [proj4text])
     VALUES
           (32768
           ,NULL
           ,NULL
           ,'PROJCS["unnamed",GEOGCS["NAD83",DATUM["North_American_Datum_1983",SPHEROID["GRS 1980",6378137,298.257222101,AUTHORITY["EPSG","7019"]],TOWGS84[0,0,0,0,0,0,0],AUTHORITY["EPSG","6269"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9108"]],AUTHORITY["EPSG","4269"]],PROJECTION["Albers_Conic_Equal_Area"],PARAMETER["standard_parallel_1",29.5],PARAMETER["standard_parallel_2",45.5],PARAMETER["latitude_of_center",23],PARAMETER["longitude_of_center",-96],PARAMETER["false_easting",0],PARAMETER["false_northing",0],UNIT["Meter",1]]'
           ,'+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23 +lon_0=-96 +x_0=0 +y_0=0 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs')

# Edit the 'geometry_columns' table. 
USE [DB_Deer]
GO

INSERT INTO [dbo].[geometry_columns]
           ([f_table_catalog], [f_table_schema], [f_table_name], [f_geometry_column], [coord_dimension], [srid], [geometry_type])
     VALUES
           ('DB_Deer', 'dbo', 'tblPts', 'SQL_Shape', 2, 32768, 'POINT')


# With the two tables now describing the feature(s) within your SQL database, read them into R
require(sp)
require(rgdal)

#look to see if layers are visible to gdal
ogrListLayers("MSSQL:server=MyCPU\\MySQLInstance;database=DB_Deer;trusted_connection=yes")

#read in the deer point locations. This should behave very similarly to an ESRI Shapefile as a SpatialPointsDataFrame and bring along the proj4string automatically 
pts<- readOGR(dsn='MSSQL:server= MyCPU\\MySQLInstance;database=DB_Deer;trusted_connection=true', layer='tblPts')
plot(pts)

I greatly appreciate Craig's guidance. The r-sig-geo list serve continues to be a fantastic resource!

Cheers,
Shannon


From Craig.Mundy at utas.edu.au  Fri Apr  5 23:04:58 2013
From: Craig.Mundy at utas.edu.au (cmundy)
Date: Fri, 5 Apr 2013 14:04:58 -0700 (PDT)
Subject: [R-sig-Geo] rgdal and MSSQL Server geometries
In-Reply-To: <1365105754260-7583209.post@n2.nabble.com>
References: <D83D818A246DF942BC711856FA4F2ECF8E961C@ponyexpress-m8.uwyo.edu>
	<1365083518571-7583203.post@n2.nabble.com>
	<D83D818A246DF942BC711856FA4F2ECF8EA650@ponyexpress-m8.uwyo.edu>
	<1365105754260-7583209.post@n2.nabble.com>
Message-ID: <1365195898378-7583220.post@n2.nabble.com>

Hi Shannon,

I can recreate your error message when I set an incorrect dsn. I've pasted
in your line of code to read from SQL Server. Can you replace the single
quote with double quotes and re try as is.
check your server and database name.

readOGR(dsn='MSSQL:server=CPU\\CPU_SQL2012EXP;database=Deer;uid=myUser;trusted_connection=true',
layer='CollarPoly')

>From the line provided, I gather your computer name is CPU and the SQL
server instance is called CPU_SQL2012EXP. Can you confirm these two names
and the database name are correct.

Regards

Craig



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/rgdal-and-MSSQL-Server-geometries-tp7583193p7583220.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From hnstedu at 163.com  Sat Apr  6 13:05:35 2013
From: hnstedu at 163.com (hnstedu)
Date: Sat, 6 Apr 2013 19:05:35 +0800 (CST)
Subject: [R-sig-Geo] extract  latitude/longitude from shapefile
Message-ID: <20d46401.10c4f.13ddf05d966.Coremail.hnstedu@163.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130406/9087edc9/attachment.pl>

From Craig.Mundy at utas.edu.au  Sat Apr  6 14:23:00 2013
From: Craig.Mundy at utas.edu.au (cmundy)
Date: Sat, 6 Apr 2013 05:23:00 -0700 (PDT)
Subject: [R-sig-Geo] Help converting matlab raster to R raster brick
In-Reply-To: <CAAcGz9_tfDSg6e-nCZAUiT_V_rjshPaJUSWsxnjMXJ6KLd90ZQ@mail.gmail.com>
References: <1365084008796-7583204.post@n2.nabble.com>
	<CAAcGz9_tfDSg6e-nCZAUiT_V_rjshPaJUSWsxnjMXJ6KLd90ZQ@mail.gmail.com>
Message-ID: <1365250980019-7583222.post@n2.nabble.com>

Hi Mike,

Needed to flip the y axis to get the orientation right. Levelplot() show
images that look like something I expected to see, and in the right part of
the world - all good.  I will need to check the x,y resolution of the
original matlab file, but it is in the right ballpark.

Thanks for the tip.

> test <- readMat("CraigMundy.mat")
> x <- brick(test$data[[2]], xmn = min(test$data[[4]]), xmx =
> max(test$data[[4]]), ymn = min(test$data[[3]]), ymx = max(test$data[[3]])) 
> x <- flip(x, direction="y")
> res(x)
[1] 0.04100 0.03528
> extent(x)
class       : Extent 
xmin        : 146.599 
xmax        : 148.321 
ymin        : -44.3339 
ymax        : -42.5699 



Michael Sumner-2 wrote
> Hi Craig, see the "array" method for ?brick:
> 
>  brick(x, xmn=0, xmx=1, ymn=0, ymx=1, crs=NA
> 
> So, something like
> 
> x <- brick(test$data[[2], xmn = min(test$data[[5]]), ymx =
> max(test$data[[5]]), ymn = min(test$data[[4]]), ymx = max(test$data[[4]]))
> 
> You might need to mess around to get the x/y ranges right, and figure out
> if you need to transpose or do other reorientations. This assumes the
> lon/lat vectors are regular so you should check that.
> 
> Cheers, Mike
> 
> 
> On Thu, Apr 4, 2013 at 9:00 AM, cmundy &lt;

> Craig.Mundy at .edu

> &gt; wrote:
> 
>> Hi All,
>>
>> I have been provided with a .mat file containing a time series of Sea
>> Surface Temperature data (50 x 42 cells with 92 time layers). It was a
>> "Struct" object in Matlab. I can happily import the file in to R using
>> R.matlab, creating a list as follows. My question is how then to convert
>> this to a raster brick?
>>
>> Thanks
>>
>> Craig
>>
>> > library(R.matlab)
>> > test <- readMat("CraigMundy.mat")
>> > str(test)
>> List of 2
>>  $ data :List of 9
>>   ..$ : num [1, 1:92] 734138 734139 734140 734141 734142 ...
>>   ..$ : num [1:50, 1:42, 1:92] 14.4 14.5 15.2 15.3 14.8 ...
>>   ..$ : num [1:50, 1] -44.3 -44.3 -44.3 -44.2 -44.2 ...
>>   ..$ : num [1, 1:42] 147 147 147 147 147 ...
>>   ..$ : num [1, 1] 101
>>   ..$ : chr [1, 1] " SST: 3 Day Composite"
>>   ..$ : num [1, 1] 0
>>   ..$ : num [1, 1] 34.5
>>   ..$ : num [1, 1] 0.44
>>   ..- attr(*, "dim")= int [1:3] 9 1 1
>>   ..- attr(*, "dimnames")=List of 3
>>   .. ..$ : chr [1:9] "Time" "Values" "Lat" "Long" ...
>>   .. ..$ : NULL
>>   .. ..$ : NULL
>>  $ times: chr [1:92, 1] "31-Dec-2009" "01-Jan-2010" "02-Jan-2010"
>> "03-Jan-2010" ...
>>  - attr(*, "header")=List of 3
>>   ..$ description: chr "MATLAB 5.0 MAT-file, Platform: PCWIN64, Created
>> on:
>> Thu Apr 04 11:29:53 2013                                                "
>>   ..$ version    : chr "5"
>>   ..$ endian     : chr "little"
>>
>>
>>
>> > version
>>                _
>> platform       x86_64-w64-mingw32
>> arch           x86_64
>> os             mingw32
>> system         x86_64, mingw32
>> status
>> major          3
>> minor          0.0
>> year           2013
>> month          04
>> day            03
>> svn rev        62481
>> language       R
>> version.string R version 3.0.0 (2013-04-03)
>> nickname       Masked Marvel
>>
>>
>>
>> --
>> View this message in context:
>> http://r-sig-geo.2731867.n2.nabble.com/Help-converting-matlab-raster-to-R-raster-brick-tp7583204.html
>> Sent from the R-sig-geo mailing list archive at Nabble.com.
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> 

> R-sig-Geo@

>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
> 
> 
> 
> -- 
> Michael Sumner
> Hobart, Australia
> e-mail: 

> mdsumner@

> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list

> R-sig-Geo@

> https://stat.ethz.ch/mailman/listinfo/r-sig-geo





--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Help-converting-matlab-raster-to-R-raster-brick-tp7583204p7583222.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From mdsumner at gmail.com  Sun Apr  7 05:55:01 2013
From: mdsumner at gmail.com (Michael Sumner)
Date: Sat, 6 Apr 2013 20:55:01 -0700
Subject: [R-sig-Geo] extract latitude/longitude from shapefile
In-Reply-To: <20d46401.10c4f.13ddf05d966.Coremail.hnstedu@163.com>
References: <20d46401.10c4f.13ddf05d966.Coremail.hnstedu@163.com>
Message-ID: <CAAcGz98Kh7jgekqNuHQcvq2MDWhz5FeE16w6OWbE7gWjQYfN_Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130406/78949c1d/attachment.pl>

From phytophthorasb at yahoo.com  Sun Apr  7 19:04:09 2013
From: phytophthorasb at yahoo.com (Empty Empty)
Date: Sun, 7 Apr 2013 10:04:09 -0700 (PDT)
Subject: [R-sig-Geo] Memory problems with dnearneigh in spdep
In-Reply-To: <1362941280.23258.YahooMailNeo@web142503.mail.bf1.yahoo.com>
References: <1362941280.23258.YahooMailNeo@web142503.mail.bf1.yahoo.com>
Message-ID: <1365354249.76493.YahooMailNeo@web142505.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130407/4013da2a/attachment.pl>

From Roger.Bivand at nhh.no  Sun Apr  7 21:15:40 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sun, 7 Apr 2013 21:15:40 +0200
Subject: [R-sig-Geo] Memory problems with dnearneigh in spdep
In-Reply-To: <1365354249.76493.YahooMailNeo@web142505.mail.bf1.yahoo.com>
References: <1362941280.23258.YahooMailNeo@web142503.mail.bf1.yahoo.com>
	<1365354249.76493.YahooMailNeo@web142505.mail.bf1.yahoo.com>
Message-ID: <alpine.LRH.2.03.1304072049050.24741@reclus.nhh.no>

I do prefer an affiliation, a real name, and a motivation; a
yahoo or gmail address tells me nothing about what you might be expected
to know. If I (or a list helper) cannot "place" you, it is much harder to
know why you are having problems.

You are also in breach of list rules because you are posting in HTML 
rather than just plain text. Removing the HTML will shorten your posting 
radically.


On Sun, 7 Apr 2013, Empty Empty wrote:

> Hi,
>
> I'm running into memory problems calculating Gi* using dnearneigh and 
> wonder if someone has any suggestions for either my script or another 
> work around.
>
> I have 1km data for Africa. My colleague calculated the appropriate 
> distance band (9333m) using incremental spatial autocorrelation in 
> ArcGIS but she was only able to run a subset of the data or with the 
> data aggregated to 5km due to memory issues (fixed distance, Euclidean). 
> I tried it in both ArcGIS (memory error after 45 hours) and R (Within 2 
> hours it was using more than 245GB on the server and then crashed). This 
> is what I used

Please always include the output of sessionInfo(). Here also include 
summary(r) output.

>
> library(spdep)
>
>
> r<-readOGR(".","r")
>
> coords<-coordinates(r)

This is not needed.

> nb9333<- dnearneigh(coords, 0,9333,longlat = F)

nb9333<- dnearneigh(r, 0, 9333)

would work, and would not override longlat=. I assume in fact that r is in 
longlat, and that you would then mean to use a km threshold of 9.333. If 
I'm right, then the memory usage is being complicated by your including 
all observations as neighbours of each observation.

For a 1km grid, a threshold of 9333m means that each of the about 30M 
gridcells has 100 neighbours (rather strong smoothing). Is the threshold 
sensibly chosen? The neighbour object will be 30M by 100 by 4, 1.21e+10 
(12G); the labels of the neighbour object at least the same; the weights 
24G in addition, so nb9333.listw is about 50G. With a more sensible 
threshold (1.5km?), the sizes of the nb9333.listw weights object become 
more tractable, maybe about 5G.

Is any of the data observed on this grid? For localG* (or localG) to make 
any sense, the variable must be observed at this resolution (satellite 
imagery?) - if interpolated, all bets are off.

Finally, the output involves so many multiple comparisons that no 
statistical inference is possible under normal assumptions - where is the 
3.886 coming from - is this an attempt to adjust for multiple comparisons?

I'm unsure why anyone would do this, as you could use standard filtering 
techniques on imaging data. The raster package also has functions for 
computing the local Moran and Geary measures on RasterLayer objects.

Hope this clarifies,

Roger

> nb9333.listw <- nb2listw(include.self(nb9333), style="B")???
> G9333<-localG(r$GRID_CODE,nb9333.listw)???
>
>
> sig3 <- classIntervals(G9333, n=3, style="fixed",
> ?????????????????????? fixedBreaks=c(min(G9333),-3.886, 3.886, max(G9333)))???? #I dont' think 3.886 is right
> cs<-c('blue','white','red') # blue = below -3, white = intermediate, red = above 3
> sigcol <- findColours(sig3, cs)?
>
> png("r.png")
> plot(r, col=sigcol, axes=TRUE)
> dev.off()
>
> 	[[alternative HTML version deleted]]
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From encharbel at gmail.com  Mon Apr  8 07:38:35 2013
From: encharbel at gmail.com (Charbel Eliane)
Date: Mon, 8 Apr 2013 08:38:35 +0300
Subject: [R-sig-Geo] help- raster overlap
In-Reply-To: <CA+XydTRnvAtYfCBoMbGcoBpfwe3943=4v-Mme0QYmc1bm+uZRg@mail.gmail.com>
References: <CA+XydTRnvAtYfCBoMbGcoBpfwe3943=4v-Mme0QYmc1bm+uZRg@mail.gmail.com>
Message-ID: <CA+XydTTx0+QbgLR=eaHvpNoa9vgKGVF8-Yf1NfCTDA+rbYx08Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130408/c3349bdd/attachment.pl>

From genoveva.gonzalez-mirelis at imr.no  Mon Apr  8 13:44:25 2013
From: genoveva.gonzalez-mirelis at imr.no (Gonzalez-Mirelis Genoveva)
Date: Mon, 8 Apr 2013 11:44:25 +0000
Subject: [R-sig-Geo] help- raster overlap (Charbel Eliane)
In-Reply-To: <mailman.9.1365415203.6364.r-sig-geo@r-project.org>
References: <mailman.9.1365415203.6364.r-sig-geo@r-project.org>
Message-ID: <0DBECC7FEDC4614290837899A2C4B01301908C@EXMBX2.imr.no>

Hi Eliane,
Not sure that it will work, but I would recommend converting your raster layers to .tiff files prior to importing them into R. Then try

aa<-raster('C:/QA_soil/inttotalrain.tif',datatype=INT1U) 

(note the file extension, and data type argument).
Good luck!
Geno

hi list,

i am using R 2.15.3 (64 bit)

i want to stack several raster objects to use for prediction purposes. All
my raster files are integer and has attribute tables and none has NA
values. ( i checked it in arcgis).however when i try to import the raster
to R and check the values in each raster, the only values that i get are
NAs. I hope the example below will clarify more the problem i am facing.
Has anymore encountered a similar problem before? i appreciate any
suggestion. Thanks in advance.

PS: i am able to stack the raster files as well as plot them or compare
them and even predict with it. however with predict i get the message:"
Error in .getRat(ratvalues, ratnames, rattypes) :
  argument "rattypes" is missing, with no default"

example:

> a<-"C:/QA_soil/inttotalrain"
> aa<-raster(a)
> head(aa)
    1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
1  NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA
2  NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA
3  NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA
4  NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA
5  NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA
6  NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA
7  NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA
8  NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA
9  NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA
10 NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA
>
> tail(aa)
      15310 15311 15312 15313 15314 15315 15316 15317 15318 15319 15320
15321
18689    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
 NA
18690    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
 NA
18691    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
 NA
18692    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
 NA
18693    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
 NA
18694    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
 NA
18695    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
 NA
18696    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
 NA
18697    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
 NA
18698    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
 NA
      15322 15323 15324 15325 15326 15327 15328 15329
18689    NA    NA    NA    NA    NA    NA    NA    NA
18690    NA    NA    NA    NA    NA    NA    NA    NA
18691    NA    NA    NA    NA    NA    NA    NA    NA
18692    NA    NA    NA    NA    NA    NA    NA    NA
18693    NA    NA    NA    NA    NA    NA    NA    NA
18694    NA    NA    NA    NA    NA    NA    NA    NA
18695    NA    NA    NA    NA    NA    NA    NA    NA
18696    NA    NA    NA    NA    NA    NA    NA    NA
18697    NA    NA    NA    NA    NA    NA    NA    NA
18698    NA    NA    NA    NA    NA    NA    NA    NA
> > aa
class       : RasterLayer
dimensions  : 18698, 15329, 286621642  (nrow, ncol, ncell)
resolution  : 10, 10  (x, y)
extent      : 685798.3, 839088.3, 3658405, 3845385  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=utm +zone=36 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0
+units=m +no_defs
data source : C:\QA_soil\inttotalrain
names       : inttotalrain
values      : 6, 1467  (min, max)
attributes  :
         ID COUNT
 from:    6   285
 to  : 1467    55


On Tue, Feb 19, 2013 at 3:08 PM, Charbel Eliane <encharbel at gmail.com> wrote:

> Dear list,
>
> I have 2 raster that represent exactly the same area. the 2 raster have
> the same coordinate system and the same resolution but 2 different origins
> and extents. They are both "float". My goal is to perfectly overlap the 2
> rasters, so i can use it for analysis.
> I have tried to use resample in R, to resample one raster using the other
> but the output raster doesn't perfectly overlap with the raster that i used
> to resample to [y in resample (x,y)]. the dim of the resultant resampled
> raster and the y raster are the same except for the number of cells.
>
> I will be grateful for any help.
>
>
>
>
>

	[[alternative HTML version deleted]]



------------------------------

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


End of R-sig-Geo Digest, Vol 116, Issue 7


From samanmonfared1 at gmail.com  Mon Apr  8 20:12:18 2013
From: samanmonfared1 at gmail.com (Saman Monfared)
Date: Mon, 8 Apr 2013 22:42:18 +0430
Subject: [R-sig-Geo] Variogram Paradox
Message-ID: <CAOytA4aa44akuLW6ANt_-E9pV2bVYgAaHOhB4M-N+DGj81SkmQ@mail.gmail.com>

Dear All,
We know that the estimation of covariance parameters is an important
problem for spatial processes because the variogram shows the spatial
variation. In many cases to select the best variogram model some
parametric models considered and some criterions such as mean
prediction error, mean square error, correlation between the observed
and predicted values and correlation between the predicted and the
residual values in cross validation method uses to select the best
variogram model.

Below codes get an example whit two variogram models which are have
very different parameters (sill, range and nugget) but values of
mentioned criterions are approximately equal for them.
Why?
What is the role of variogram?
What is the role of empirical variogram when a variogram function
which is so far away than it can has approximately equaled cross
validation results.

library(gstat)
data(meuse)
coordinates(meuse)<-~x+y
v<-variogram(log(zinc)~1,meuse)
v.f<-fit.variogram(v,vgm(.205,"Mat",700,0.008,kappa=1))
plot(v,v.f)
v.ff<-fit.variogram(v,vgm(.205,"Mat",700,0.008,kappa=1)
,fit.sills =F, fit.ranges =F)
plot(v,v.ff)
k1<-krige.cv(log(zinc)~1,meuse,v.f)
k2<-krige.cv(log(zinc)~1,meuse,v.ff)
mean(k1$residual)
mean(k2$residual)
mean(k1$residual^2)
mean(k2$residual^2)
cor(k1$var1.pred,k1$observed)
cor(k2$var1.pred,k2$observed)
cor(k1$var1.pred,k1$residual)
cor(k2$var1.pred,k2$residual)

Best,
Saman.
-- 
Saman Monfared
Msc, Department of Statistics, Shiraz University,
Shiraz 71454, Iran
Email: Samanmonfared1 at gmail.com

Tel: +98 917 5305167


From brian.kinlan at noaa.gov  Mon Apr  8 21:06:02 2013
From: brian.kinlan at noaa.gov (Brian Kinlan (NOAA Affiliate))
Date: Mon, 08 Apr 2013 15:06:02 -0400
Subject: [R-sig-Geo] Computational Ecologist Job at NOAA in Silver Spring,
 MD -- Marine Wildlife Spatial Modeling in R
Message-ID: <5163151A.2020700@noaa.gov>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130408/a07d55b4/attachment.pl>

From brian.kinlan at noaa.gov  Mon Apr  8 21:23:37 2013
From: brian.kinlan at noaa.gov (Brian Kinlan (NOAA Affiliate))
Date: Mon, 08 Apr 2013 15:23:37 -0400
Subject: [R-sig-Geo] Computational Ecologist Job at NOAA in Silver Spring,
 MD -- Marine Wildlife Spatial Modeling in R
In-Reply-To: <516318A3.3090803@noaa.gov>
References: <516318A3.3090803@noaa.gov>
Message-ID: <51631939.5060202@noaa.gov>

Job ad- Please forward to all relevant departmental listservs and any 
interested colleagues!
-------------
The NOAA National Centers for Coastal Ocean Science is hiring a
Computational Ecologist, a statistical/computational ecologist with
experience fitting advanced spatial models to marine wildlife survey
data (e.g., seabirds and marine mammal transects, fisheries trawl
surveys) in R and other statistical languages. This is a full-time,
long-term stable contract position. We are looking for an expert R
programmer with experience in spatial modeling, especially of marine
wildlife survey transect data (e.g. seabirds, marine mammals). Please
note that this is a contract position, so rather than applying directly
to NOAA the link below directs you to the contracting company
(CSS-Dynamac, Inc.). We are looking to hire someone immediately.

----------------

Computational Ecologist

Contract position with NOAA's National Ocean Service, National Centers
for Coastal Ocean Science, Biogeography Branch (Contract Company:
http://www.css-dynamac.com/)

Apply for this job online at
https://jobs-consolidatedsafety.icims.com/jobs/1486/job

Responsibilities:
A person with experience or academic training in quantitative ecology,
advanced statistical modeling, computational analysis, and scientific
programming in R and Matlab; who also has demonstrated interest and
experience in advanced spatial analysis, is being sought for a full-time
contract position with the National Oceanic and Atmospheric
Administration?s (NOAA) National Centers for Coastal Ocean Science
(NCCOS). NCCOS? Biogeography Branch conducts ecological and
oceanographic studies to map, characterize, assess, and model the
spatial distributions and movements of marine organisms across habitats
throughout the United States and Island Territories. We are seeking an
individual with a broad suite of quantitative, statistical, and
computational skills. A strong background in statistical modeling of
spatial ecological data with some experience in marine sciences is
preferred. The successful candidate will join an experienced scientific
team at the forefront of marine ecological predictive analytics. The
initial assignment for this position will involve developing,
implementing, and running machine-learning models for predictive
spatio-temporal modeling of marine bird and groundfish distributions to
support marine planning processes. Additional potential projects include
predictive modeling of deep sea corals, marine mammals, sea turtles,
marine fish, fishing fleets, and marine ecosystem processes. ?


Core responsibilities
Provide statistical, computational, and analytical support to projects
that use predictive statistical models, in conjunction with large
wildlife survey and oceanographic databases, to provide
spatially-explicit maps and analyses that answer questions of marine
management and conservation relevance.
Design and implement spatial and spatio-temporal statistical models of
marine species? distributions (e.g., seabird and marine mammal
occurrence probability and abundance), marine habitat, and marine
ecosystem properties
Develop and maintain computer code to interface with large oceanographic
and ecological databases and mine these databases to improve predictive
models
Assess model performance and uncertainty in management-relevant scenarios
Assist with writing journal articles/reports and present at scientific
conferences
Offer technical guidance for selection and implementation of different
statistical methods to detect patterns in wildlife surveys.
Explain statistical results as they relate to project goals and
summarize results in the form of tables, figures, journal articles and
technical reports.
Travel to federal and state laboratories and academic institutions as
part of collaborative research projects
Develop, maintain, and grow a codebase for advanced spatial analysis
Apply new developments in statistical modeling to a marine
ecological/wildlife survey context
Implement model selection, assessment, and validation algorithms
Develop, maintain, and grow oceanographic and ecological geo-databases
Build a database of oceanographic and environmental predictor variables
of relevance to marine ecological modeling
Analyze satellite and observational datasets and raw ocean model outputs
to develop derived products that improve predictive models
Automate data acquisition, data mining, model assessment & QA/QC processes

Qualifications:
Essential
Advanced degree (Masters or PhD), or equivalent experience, in
Quantitative Ecology, Applied Statistics, or similarly highly
quantitative field. Ecology, Marine Science and related advanced degrees
also acceptable with demonstrated evidence of a strong quantitative
focus and statistical and computer programming expertise described below
Must be proficient and highly experienced with R and Matlab (3-5+ years
experience with one or both of these languages); a code sample may be
requested to demonstrate proficiency
Experience implementing a variety of spatially-explicit statistical
models in R and/or Matlab, including at least 3 of the following:
machine learning models (e.g., component-wise boosting), geostatistical
models, GLMMs, GAMs, regression trees/forests
Ability to independently identify, analyze and solve complex statistical
and computational problems
Demonstrated written and oral scientific communication skills
Able to work effectively in a dynamic, fast-paced, team-oriented
multi-project environment

Preferred
Experience with spatial analysis of wildlife survey data, especially
marine bird data, in the marine environment
Knowledge of ecology, marine science, oceanography, and/or a related field
Ability to interface with large databases through THREDDS/ERDDAP servers
in R and/or Matlab
Experience working with ocean remote sensing data, numerical ocean model
outputs (e.g., ROMS), and large distributed oceanographic databases
Proficiency with programmable GIS (e.g., Python scripting with ArcGIS or
equivalent); Experience with geostatistics (gstat, ESRI Geostatistical
Analyst, rgeos, GSLIB, or equivalent)
Although not required, we value experience developing hierarchical
Bayesian or Approximate Bayesian models on large spatial datasets
Record of academic publication

Apply for this job online at
https://jobs-consolidatedsafety.icims.com/jobs/1486/job
To discuss the position or for more information contact:
Dr. Brian Kinlan
Marine Spatial Ecologist
NOAA NOS National Centers for Coastal Ocean Science
Brian.Kinlan at NOAA.gov

-- 
*******************************************
Brian P. Kinlan, Ph.D
Marine Spatial Ecologist

NOAA National Ocean Service
Contractor, CSS Inc.
NCCOS-CCMA-Biogeography Branch
1305 East-West Hwy, SSMC-4, N/SCI-1, #9224
Silver Spring, MD 20910-3278

http://ccma.nos.noaa.gov/about/biogeography/
*******************************************

Disclaimer: Any views or opinions expressed in this message are those of
the sender, not NOAA, the United States Government or its agents, or
Consolidated Safety Services, Inc.


From Roger.Bivand at nhh.no  Mon Apr  8 21:30:54 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 8 Apr 2013 21:30:54 +0200
Subject: [R-sig-Geo] Computational Ecologist Job at NOAA in Silver
 Spring, MD -- Marine Wildlife Spatial Modeling in R
In-Reply-To: <51631939.5060202@noaa.gov>
References: <516318A3.3090803@noaa.gov> <51631939.5060202@noaa.gov>
Message-ID: <alpine.LRH.2.03.1304082127000.28123@reclus.nhh.no>

Brian Kinlan has been administratively unsubscribed for twice posting the 
same 17K HTML job advertisement to our list. He should have asked 
permission, and might have been permitted to post a single sentence text 
message with a URL. For an NOAA affiliate to spam a global list with a 
large message generating totally unnecessary emissions of CO2 is gross.

Roger Bivand

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From edzer.pebesma at uni-muenster.de  Mon Apr  8 23:11:27 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 08 Apr 2013 23:11:27 +0200
Subject: [R-sig-Geo] Variogram Paradox
In-Reply-To: <CAOytA4aa44akuLW6ANt_-E9pV2bVYgAaHOhB4M-N+DGj81SkmQ@mail.gmail.com>
References: <CAOytA4aa44akuLW6ANt_-E9pV2bVYgAaHOhB4M-N+DGj81SkmQ@mail.gmail.com>
Message-ID: <5163327F.1070701@uni-muenster.de>



On 04/08/2013 08:12 PM, Saman Monfared wrote:
> Dear All,
> We know that the estimation of covariance parameters is an important
> problem for spatial processes because the variogram shows the spatial
> variation. In many cases to select the best variogram model some
> parametric models considered and some criterions such as mean
> prediction error, mean square error, correlation between the observed
> and predicted values and correlation between the predicted and the
> residual values in cross validation method uses to select the best
> variogram model.
> 
> Below codes get an example whit two variogram models which are have
> very different parameters (sill, range and nugget) but values of
> mentioned criterions are approximately equal for them.
> Why?
> What is the role of variogram?
> What is the role of empirical variogram when a variogram function
> which is so far away than it can has approximately equaled cross
> validation results.
> 
> library(gstat)
> data(meuse)
> coordinates(meuse)<-~x+y
> v<-variogram(log(zinc)~1,meuse)
> v.f<-fit.variogram(v,vgm(.205,"Mat",700,0.008,kappa=1))
> plot(v,v.f)
> v.ff<-fit.variogram(v,vgm(.205,"Mat",700,0.008,kappa=1)
> ,fit.sills =F, fit.ranges =F)
> plot(v,v.ff)
> k1<-krige.cv(log(zinc)~1,meuse,v.f)
> k2<-krige.cv(log(zinc)~1,meuse,v.ff)
> mean(k1$residual)
> mean(k2$residual)
> mean(k1$residual^2)
> mean(k2$residual^2)
> cor(k1$var1.pred,k1$observed)
> cor(k2$var1.pred,k2$observed)
> cor(k1$var1.pred,k1$residual)
> cor(k2$var1.pred,k2$residual)
> 
> Best,
> Saman.

Because the ratio of the two models,

v1 = variogramLine(v.f, 500)
v2 = variogramLine(v.ff, 500)
plot(v1[,1], v1[,2]/v2[,2])

is fairly constant.

If a variogram model gets multiplied by a positive constant, the kriging
predictions will remain identical:

v.fff = v.ff
v.ff$psill = v.ff$psill * 1234 # or any pos. number
k3 <- krige.cv(log(zinc)~1,meuse,v.fff)
summary(k3$var1.pred-k2$var1.pred)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
      0       0       0       0       0       0

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From omphalodes.verna at yahoo.com  Tue Apr  9 07:09:22 2013
From: omphalodes.verna at yahoo.com (Omphalodes Verna)
Date: Mon, 8 Apr 2013 22:09:22 -0700 (PDT)
Subject: [R-sig-Geo] split/divide SpatialLines (sp) into n segments
Message-ID: <1365484162.62235.YahooMailNeo@web164902.mail.bf1.yahoo.com>

Dear list!

I would like to split/divide?SpatialLines into n segments. Is there any function to do this in R? Or does somebody know the solution for that?

Here is example of?SpatialLines?from?the sp vignette:

library(sp)
Sl = SpatialLines(list(Lines(list(Line(cbind(c(1,2,3),c(3,2,2)))), ID="a")))
plot(Sl)
coordinates(Sl)

Thanks to all, OV


From r.hijmans at gmail.com  Tue Apr  9 08:40:46 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 8 Apr 2013 23:40:46 -0700
Subject: [R-sig-Geo] vertical profile of raster DEM along road (package
	raster)
In-Reply-To: <515EDEB30200002700019245@gwia2.boku.ac.at>
References: <515EDEB30200002700019245@gwia2.boku.ac.at>
Message-ID: <CANtt_hx6tWANQzkbM4hp_9sniGdK82x1aHXYnasnm=QkrBN8TQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130408/c3cb20bf/attachment.pl>

From r.hijmans at gmail.com  Tue Apr  9 08:45:14 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 8 Apr 2013 23:45:14 -0700
Subject: [R-sig-Geo] help- raster overlap (Charbel Eliane)
In-Reply-To: <0DBECC7FEDC4614290837899A2C4B01301908C@EXMBX2.imr.no>
References: <mailman.9.1365415203.6364.r-sig-geo@r-project.org>
	<0DBECC7FEDC4614290837899A2C4B01301908C@EXMBX2.imr.no>
Message-ID: <CANtt_hxYNugDcrTVNzd5Pr75oYrD4xyJyWyn_WRAMV0CniyDOA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130408/435bfd4e/attachment.pl>

From r.hijmans at gmail.com  Tue Apr  9 08:48:48 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 8 Apr 2013 23:48:48 -0700
Subject: [R-sig-Geo] seemingly unresolved problem with predict() in
 package raster
In-Reply-To: <0DBECC7FEDC4614290837899A2C4B013018EA8@EXMBX2.imr.no>
References: <0DBECC7FEDC4614290837899A2C4B013018E15@EXMBX2.imr.no>
	<CANtt_hxgVi1wzZ9mt8rkS47Wjt6v8oPXcnWX9Ekz81UhfEoXjw@mail.gmail.com>
	<0DBECC7FEDC4614290837899A2C4B013018EA8@EXMBX2.imr.no>
Message-ID: <CANtt_hyT6rRSO8Owagd-wQA58X9J+as-coFCs+_MSDc8BP80gA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130408/4aa89029/attachment.pl>

From r.hijmans at gmail.com  Tue Apr  9 08:53:52 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 8 Apr 2013 23:53:52 -0700
Subject: [R-sig-Geo] [raster] conserving dimensions when regridding a 4D
 Brick or Stack
In-Reply-To: <87y5cxehf7.fsf@pobox.com>
References: <87y5cxehf7.fsf@pobox.com>
Message-ID: <CANtt_hyh03=avU5+P_i0g4vKMmb3W-O0cPwgfWraXZ+BEbzB9A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130408/b206e81c/attachment.pl>

From omphalodes.verna at yahoo.com  Tue Apr  9 08:56:29 2013
From: omphalodes.verna at yahoo.com (Omphalodes Verna)
Date: Mon, 8 Apr 2013 23:56:29 -0700 (PDT)
Subject: [R-sig-Geo] vertical profile of raster DEM along road (package
	raster)
In-Reply-To: <CANtt_hx6tWANQzkbM4hp_9sniGdK82x1aHXYnasnm=QkrBN8TQ@mail.gmail.com>
References: <515EDEB30200002700019245@gwia2.boku.ac.at>
	<CANtt_hx6tWANQzkbM4hp_9sniGdK82x1aHXYnasnm=QkrBN8TQ@mail.gmail.com>
Message-ID: <1365490589.62714.YahooMailNeo@web164903.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130408/f97156c5/attachment.pl>

From matteo.mattiuzzi at boku.ac.at  Tue Apr  9 09:16:54 2013
From: matteo.mattiuzzi at boku.ac.at (Matteo Mattiuzzi)
Date: Tue, 09 Apr 2013 09:16:54 +0200
Subject: [R-sig-Geo] vertical profile of raster DEM along road (package
 raster)
Message-ID: <5163DC86020000270001932A@gwia2.boku.ac.at>

No not yet, you see the "building" status here:
https://r-forge.r-project.org/R/?group_id=294
It will be ready when status has become "current".
Hard to say when it will be ready but normally it is very fast, occasionally very slow...
(You could also build it from from source, but I think you should wait for R-forge)
Matteo


>>> Omphalodes Verna  04/09/13 8:56 AM >>>
Thank you Robert.

It is already possible to install it?

Thank you, OV




________________________________
 From: Robert J. Hijmans 
To: Matteo Mattiuzzi  
Cc: r-sig-geo ; omphalodes.verna at yahoo.com 
Sent: Tuesday, April 9, 2013 8:40 AM
Subject: Re: [R-sig-Geo] vertical profile of raster DEM along road (package raster)


> extract does not sort the values according to the SpatialLine direction but sorts it somehow on its extraction order. > I think it is a bug or at least a not ideal behavior in extract() on spatial lines.


This is by design because it is simpler (faster) than extracting "along the line". 
I have added an option "along" in version 2.1-23 of raster (now on R-Forge) to get the values in the expected order (along=TRUE). 

Robert



On Fri, Apr 5, 2013 at 5:24 AM, Matteo Mattiuzzi  wrote:

Hi, my doubt is that extract does not sort the values according to the SpatialLine direction but sorts it somehow on its extraction order. I think it is a bug or at least a not ideal behavior in extract() on spatial lines.
>I think Robert can clarify this?
>
>
>library(raster)
># raster example in extract:
>
>
> r <- raster(ncol=36, nrow=18)
> r[] <- 1:ncell(r)
> cds1 <- rbind(c(-50,0), c(0,60), c(40,5), c(15,-45), c(-10,-25))
> cds2 <- rbind(c(80,20), c(140,60), c(160,0), c(140,-55))
> lines <- SpatialLines(list(Lines(list(Line(cds1)), "1"), Lines(list(Line(cds2)), "2") ))[1] # only 1 line!
>
>
>plot(r)
>lines(lines)
>x11()
>plot(extract(r, lines)[[1]]) # following the line the values should be sorted differently.
>
>
>
>
>
>#
>rasGround  <- raster("rasGroundCrop.tif", crs = "+proj=tmerc +lat_0=0 +lon_0=15 +k=0.9999 +x_0=500000 +y_0=-5000000 +ellps=bessel +towgs84=653.0,-212.0,449.0 +units=m +no_defs")
>Road34 <- shapefile("Profil")
>projection(Road34) <- projection(rasGround)
>
>
>
>
>plot(rasGround)
>plot(Road34, add = TRUE, col = "black", lwd = 3)
>plot(extract(rasGround, Road34)[[1]], type = "l")
>
>
>
>Matteo
>
>>>> Omphalodes Verna  04/05/13 1:24 PM >>>
>
>Dear Matteo!
>
>Thanks
>for suggestion. I tried your code, but it seems that it is not working. Please
>see my code and in attached files are files.
>
>library(sp)
>library(raster)
>library(rgdal)
>
>
>rasGround  <-
>raster("rasGroundCrop.tif", crs = "+proj=tmerc +lat_0=0
>+lon_0=15 +k=0.9999 +x_0=500000 +y_0=-5000000 +ellps=bessel
>+towgs84=653.0,-212.0,449.0 +units=m +no_defs")
>Road34 <- readOGR(".",
>"Profil",
>p4s = "+proj=tmerc +lat_0=0 +lon_0=15 +k=0.9999
>+x_0=500000 +y_0=-5000000 +ellps=bessel +towgs84=653.0,-212.0,449.0 +units=m
>+no_defs")
>
>
>plot(rasGround)
>plot(Road34, add = TRUE, col = "black",
>lwd = 3)
>plot(extract(rasGround, Road34)[[1]], type =
>"l") #Not works
>
>Maybe this could be a solution but
>I lose direction:
>
>pointsXY <- rasterToPoints(rasGround)
>rasX <- rasGround
>rasY <- rasGround
>rasX[] <- pointsXY[, 1]
>rasY[] <- pointsXY[, 2]
>
>rasXYZ <- stack(rasGround, rasX, rasY)
>segment <- extract(rasXYZ, Road34)[[1]]
>IDX <- order(segment[, 2], segment[, 3])
>segment <- segment[IDX, ]
>plot(segment[,1], type = "l")
>
>Thanks, OV
>
>
>
>
>----- Original Message -----
>From: Matteo Mattiuzzi
>
>To: r-sig-geo at r-project.org; omphalodes.verna at yahoo.com
>Cc:
>Sent: Thursday, March 21, 2013 7:52 PM
>Subject: Re: [R-sig-Geo] vertical profile of raster DEM along road (package raster)
>
>Dear Omphalodes,
>
>
>library(raster)
>library(sp)
>set.seed(2)
>data(volcano)
>r <- raster(volcano)
>plot(r)
>l1 = cbind(c(seq(0,1 , by = 0.1)), runif(11, 0, 1))
>S1 = Lines(list(Line(l1)), ID = "a")
>lines(S1, asp = 1, col = "red")
>
>
>S1<-SpatialLines(list(S1)) # I'm not practic in sp, but this at least works!
>extract(r,S1)
>
>
>
>Matteo
>
>>>> Omphalodes Verna  03/21/13 6:06 PM >>>
>Dear list.
>
>I am asking for advice for getting verticale profile of DEM along line object. I konw, it is easy for one straight line (distance and extract functions) also with using a combination of GRASS and R ( http://casoilresource.lawr.ucdavis.edu/drupal/node/375 ). Is in R possible to do this.
>
>Thanks to all. OV
>
>Here is a sample code:
>
>library(raster)
>library(sp)
>set.seed(2)
>data(volcano)
>r <- raster(volcano)
>plot(r)
>l1 = cbind(c(seq(0,1 , by = 0.1)), runif(11, 0, 1))
>S1 = Lines(list(Line(l1)), ID = "a")
>lines(S1, asp = 1, col = "red")
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


From edzer.pebesma at uni-muenster.de  Tue Apr  9 09:32:18 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 09 Apr 2013 09:32:18 +0200
Subject: [R-sig-Geo] Variogram Paradox
In-Reply-To: <5163327F.1070701@uni-muenster.de>
References: <CAOytA4aa44akuLW6ANt_-E9pV2bVYgAaHOhB4M-N+DGj81SkmQ@mail.gmail.com>
	<5163327F.1070701@uni-muenster.de>
Message-ID: <5163C402.2090807@uni-muenster.de>



On 04/08/2013 11:11 PM, Edzer Pebesma wrote:
> 
> 
> On 04/08/2013 08:12 PM, Saman Monfared wrote:
>> Dear All,
>> We know that the estimation of covariance parameters is an important
>> problem for spatial processes because the variogram shows the spatial
>> variation. In many cases to select the best variogram model some
>> parametric models considered and some criterions such as mean
>> prediction error, mean square error, correlation between the observed
>> and predicted values and correlation between the predicted and the
>> residual values in cross validation method uses to select the best
>> variogram model.
>>
>> Below codes get an example whit two variogram models which are have
>> very different parameters (sill, range and nugget) but values of
>> mentioned criterions are approximately equal for them.
>> Why?
>> What is the role of variogram?
>> What is the role of empirical variogram when a variogram function
>> which is so far away than it can has approximately equaled cross
>> validation results.
>>
>> library(gstat)
>> data(meuse)
>> coordinates(meuse)<-~x+y
>> v<-variogram(log(zinc)~1,meuse)
>> v.f<-fit.variogram(v,vgm(.205,"Mat",700,0.008,kappa=1))
>> plot(v,v.f)
>> v.ff<-fit.variogram(v,vgm(.205,"Mat",700,0.008,kappa=1)
>> ,fit.sills =F, fit.ranges =F)
>> plot(v,v.ff)
>> k1<-krige.cv(log(zinc)~1,meuse,v.f)
>> k2<-krige.cv(log(zinc)~1,meuse,v.ff)
>> mean(k1$residual)
>> mean(k2$residual)
>> mean(k1$residual^2)
>> mean(k2$residual^2)
>> cor(k1$var1.pred,k1$observed)
>> cor(k2$var1.pred,k2$observed)
>> cor(k1$var1.pred,k1$residual)
>> cor(k2$var1.pred,k2$residual)
>>
>> Best,
>> Saman.
> 
> Because the ratio of the two models,
> 
> v1 = variogramLine(v.f, 500)
> v2 = variogramLine(v.ff, 500)
> plot(v1[,1], v1[,2]/v2[,2])
> 
> is fairly constant.
> 
> If a variogram model gets multiplied by a positive constant, the kriging
> predictions will remain identical:
> 
> v.fff = v.ff
> v.ff$psill = v.ff$psill * 1234 # or any pos. number

I meant, of course:

v.fff$psill <- v.fff$psill * 1234 # or any pos. number
k3 <- krige.cv(log(zinc)~1,meuse,v.fff)

which leads to

> summary(k3$var1.pred-k2$var1.pred)
      Min.    1st Qu.     Median       Mean    3rd Qu.       Max.
-3.020e-14 -9.326e-15  0.000e+00 -1.490e-16  7.994e-15  3.286e-14

i.e., essentially zeros:

> all.equal(k3$var1.pred, k2$var1.pred)
[1] TRUE

> k3 <- krige.cv(log(zinc)~1,meuse,v.fff)
> summary(k3$var1.pred-k2$var1.pred)
>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
>       0       0       0       0       0       0
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From jagaronson at gmail.com  Tue Apr  9 14:49:29 2013
From: jagaronson at gmail.com (JonathanAronson)
Date: Tue, 9 Apr 2013 05:49:29 -0700 (PDT)
Subject: [R-sig-Geo] Help with ENFA in R
Message-ID: <1365511769098-7583243.post@n2.nabble.com>

Hello there
I am really hoping someone out there can help me. I have read the various
forums but havent found information that can help me. 
I am running an ENFA in R for 12 species using 15 environmental variables.
Below is my code and some questions: 


library(ade4)
library(adehabitat)
test<- read.csv("Species_Localities/R.blasii.csv", header=T)
var1<- import.asc("Data/bio_01.asc")
var2<- import.asc("Data/bio_12.asc")
var3<- import.asc("Data/Aridity.asc")
var4<- import.asc("Data/altitude.asc")
var5<- import.asc("Data/unpalatable.asc")
var6<- import.asc("Data/thicket.asc")
var7<- import.asc("Data/succulent.asc")
var8<- import.asc("Data/shrubland.asc")
var9<- import.asc("Data/rainforest.asc")
var10<- import.asc("Data/mosaic.asc")
var11<- import.asc("Data/mopane.asc")
var12<- import.asc("Data/misavanna.asc")
var13<- import.asc("Data/hydro.asc")
var14<- import.asc("Data/fynbos.asc")
var15<- import.asc("Data/desert.asc")
map<- as.kasc(list(bio_01 = var1, bio_12 = var2, Aridity = var3, altitude =
var4, unpalatable = var5, thicket = var6, succulent = var7, shrubland =
var8, rainforest = var9, mosaic = var10, mopane = var11, misavanna = var12,
hydro = var13, fynbos = var14, desert = var15))
enfatest<- data2enfa(map, test)
pc <- dudi.pca(enfatest$tab, scannf = FALSE, nf = 1)
enfatest1 <- enfa(pc, enfatest$pr, scannf = FALSE)
renfa <- randtest(enfatest1, nrepet=999)
list(enfatest1$m)
list(enfatest1$s)
list(enfatest1$co)
hist(enfatest1)
hist(enfatest1, scores = FALSE, type = "l")
image(enfatest1)
list(renfa$expvar)
list(renfa$pvalue)
list(renfa$obs)
scatter(enfatest1)
niche.test(map, test, nrep = 999, o.include = TRUE)

list(enfatest1$m) has given me the global marginality for each species and
those are:

Species            Marginality
R.a 	                  4.8
R.b 	                 12.47
R.ca 	                 19.27
R.cl 	                 15.16
R.da 	                 12.36
R.de 	                 15.31
R.e 	                 12.19
R.f 	                  6.07
R.h 	                  9.65
R.l 	                  9.14
R.si 	                 13.7
R.sw 	                 13.11

I do not know how to get the global tolerance scores. Can you please help me
with that?

I also do not know what the randomisation test for ENFA does. Could you
please explain that?

I am unsure about what list(renfa$expvar), list(renfa$pvalue),
list(renfa$obs) are telling me. I get a p-value of 0.001.

I have tried to test the significance of my results using a Monte Carlo test
but i get this error when I run the code:

Error in niche.test(map, test, nrepet = 999, o.include = TRUE) : 
  should be an object of class SpatialPixelsDataFrame


Please can someone provide some assistance because I have been stuck with
this for months.
Thank you in advance
Jonathan



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Help-with-ENFA-in-R-tp7583243.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From steven.ranney at gmail.com  Tue Apr  9 15:10:48 2013
From: steven.ranney at gmail.com (Steven Ranney)
Date: Tue, 9 Apr 2013 07:10:48 -0600
Subject: [R-sig-Geo] Plotting .shp and over()
Message-ID: <CANDt99qqyyv=_JeZXDLAtT0tFu5iQcQ1ooSNgfOHfkj43JRfgw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130409/9f9eed42/attachment.pl>

From kamallauber at gmx.de  Tue Apr  9 15:26:08 2013
From: kamallauber at gmx.de (kamallauber)
Date: Tue, 9 Apr 2013 06:26:08 -0700 (PDT)
Subject: [R-sig-Geo] Combining shp-Files and csv-Data
Message-ID: <1365513968866-7583245.post@n2.nabble.com>

Hey people,

first of all:I am Using R 2.15.3. 
I have 2 shapefiles (.shp+.dfb+...) and a csv-table. 
Now, one shape(1) is the border of germany and the other is a grid-like
shapefile (2) (not a grid but many little cubes (1x1km). Now I want to have
a grid-like shapefile but only in the boundaries of the first shapefile.
Both of them are spatialpolygondataframes.

The next step would then be, to get the values from the csv-table to the in
the attribute table of the shapefile. The csv has a certain column
'cellnumber' which corresponds to a column in the grid-like shapefile (2). 

I know that this can easily be done with other gis software such as arcgis
but i need to do it with R.
Any help would be much appreciated.

Greets, Matthias



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Combining-shp-Files-and-csv-Data-tp7583245.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From sturgeon09 at gmail.com  Tue Apr  9 15:28:53 2013
From: sturgeon09 at gmail.com (Samuel Turgeon)
Date: Tue, 9 Apr 2013 09:28:53 -0400
Subject: [R-sig-Geo] Plotting .shp and over()
In-Reply-To: <CANDt99qqyyv=_JeZXDLAtT0tFu5iQcQ1ooSNgfOHfkj43JRfgw@mail.gmail.com>
References: <CANDt99qqyyv=_JeZXDLAtT0tFu5iQcQ1ooSNgfOHfkj43JRfgw@mail.gmail.com>
Message-ID: <CAH3FZ07NGDKKx11H7S_n3xDa=n7ngP1vUqgKfdynhNGELY_j2g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130409/95fbace6/attachment.pl>

From roman.lustrik at gmail.com  Tue Apr  9 15:58:15 2013
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Tue, 9 Apr 2013 15:58:15 +0200
Subject: [R-sig-Geo] Combining shp-Files and csv-Data
In-Reply-To: <1365513968866-7583245.post@n2.nabble.com>
References: <1365513968866-7583245.post@n2.nabble.com>
Message-ID: <CAHT1vph3iHw6viF1KS__MOtM4+TPj2TUZ2QbT0jd42YUzsvXVQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130409/2565e144/attachment.pl>

From kamallauber at gmx.de  Tue Apr  9 17:10:51 2013
From: kamallauber at gmx.de (kamallauber)
Date: Tue, 9 Apr 2013 08:10:51 -0700 (PDT)
Subject: [R-sig-Geo] Combining shp-Files and csv-Data
In-Reply-To: <CAHT1vph3iHw6viF1KS__MOtM4+TPj2TUZ2QbT0jd42YUzsvXVQ@mail.gmail.com>
References: <1365513968866-7583245.post@n2.nabble.com>
	<CAHT1vph3iHw6viF1KS__MOtM4+TPj2TUZ2QbT0jd42YUzsvXVQ@mail.gmail.com>
Message-ID: <1365520251312-7583248.post@n2.nabble.com>

First of all thank you for the quick response.

I did read the shapefiles with readOGR and i understand how you would do
that with rgeos, but i have a single shapefile which consists of all these
little "cubes" and i do not understand in which way i can extract some of
these cubes from a single shape file.

Best regards,
Matthias



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Combining-shp-Files-and-csv-Data-tp7583245p7583248.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From steven.ranney at gmail.com  Tue Apr  9 17:41:42 2013
From: steven.ranney at gmail.com (Steven Ranney)
Date: Tue, 9 Apr 2013 09:41:42 -0600
Subject: [R-sig-Geo] Plotting .shp and over()
In-Reply-To: <CAH3FZ07NGDKKx11H7S_n3xDa=n7ngP1vUqgKfdynhNGELY_j2g@mail.gmail.com>
References: <CANDt99qqyyv=_JeZXDLAtT0tFu5iQcQ1ooSNgfOHfkj43JRfgw@mail.gmail.com>
	<CAH3FZ07NGDKKx11H7S_n3xDa=n7ngP1vUqgKfdynhNGELY_j2g@mail.gmail.com>
Message-ID: <CANDt99oS3JhvCR3E-+ESrg2gE95hMqV4hy2EpEKY-LBZNR7=9w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130409/a1fb522b/attachment.pl>

From steven.ranney at gmail.com  Tue Apr  9 17:51:59 2013
From: steven.ranney at gmail.com (Steven Ranney)
Date: Tue, 9 Apr 2013 09:51:59 -0600
Subject: [R-sig-Geo] Plotting .shp and over()
In-Reply-To: <CANDt99oS3JhvCR3E-+ESrg2gE95hMqV4hy2EpEKY-LBZNR7=9w@mail.gmail.com>
References: <CANDt99qqyyv=_JeZXDLAtT0tFu5iQcQ1ooSNgfOHfkj43JRfgw@mail.gmail.com>
	<CAH3FZ07NGDKKx11H7S_n3xDa=n7ngP1vUqgKfdynhNGELY_j2g@mail.gmail.com>
	<CANDt99oS3JhvCR3E-+ESrg2gE95hMqV4hy2EpEKY-LBZNR7=9w@mail.gmail.com>
Message-ID: <CANDt99rMaMZouq=RCW9ji8DNzY=N04_6TV9vfYPjmg0140kpMw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130409/4b21ce46/attachment.pl>

From carstennh at aol.com  Tue Apr  9 17:59:46 2013
From: carstennh at aol.com (Carsten Neumann)
Date: Tue, 09 Apr 2013 17:59:46 +0200
Subject: [R-sig-Geo] problem density function {raster}
Message-ID: <51643AF2.7030001@aol.com>

Hi,

there seems to be a problem with the density function when using it with
an rasterStack object.

d<-density(a1,channel,plot=F)
"Error in nlayers == 1 : comparison (1) is possible only for atomic and
list types"


?density results in:
"Error in httpd("/library/NULL/help/density", NULL, NULL, c(48, 6f, 73, 
: replacement has length zero"


> sessionInfo()
R version 3.0.0 (2013-04-03)
Platform: i386-w64-mingw32/i386 (32-bit)

locale:
[1] LC_COLLATE=German_Germany.1252  LC_CTYPE=German_Germany.1252  
[3] LC_MONETARY=German_Germany.1252 LC_NUMERIC=C                  
[5] LC_TIME=German_Germany.1252   

attached base packages:
[1] grid      stats     graphics  grDevices utils     datasets  methods 
[8] base    

other attached packages:
[1] maptools_0.8-23 lattice_0.20-15 foreign_0.8-53  raster_2.1-16 
[5] rgdal_0.8-6     sp_1.0-8      

loaded via a namespace (and not attached):
[1] tools_3.0.0

In my old Script it works perfectly with the same data. Can anybody help?

Thanks in advance!

Carsten

-- 

Carsten Neumann
Telegrafenberg, A 17 01.13
14473 Potsdam
-------------------------------------------------------
Helmholtz Centre Potsdam
GFZ German Research Centre for Geosciences
Department 1 - Section 1.4 - Remote Sensing
-------------------------------------------------------
Tel.: +49 (0) 331 288 1766
e-mail: carstenn at gfz-potsdam.de


From b.rowlingson at lancaster.ac.uk  Tue Apr  9 18:05:44 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Tue, 9 Apr 2013 17:05:44 +0100
Subject: [R-sig-Geo] Plotting .shp and over()
In-Reply-To: <3521a1db41884b20861bcb6d3b0ae0b5@EX-1-HT0.lancs.local>
References: <CANDt99qqyyv=_JeZXDLAtT0tFu5iQcQ1ooSNgfOHfkj43JRfgw@mail.gmail.com>
	<CAH3FZ07NGDKKx11H7S_n3xDa=n7ngP1vUqgKfdynhNGELY_j2g@mail.gmail.com>
	<3521a1db41884b20861bcb6d3b0ae0b5@EX-1-HT0.lancs.local>
Message-ID: <CANVKczPbzeD7M3d+Kz_o=xYp-N+FZpE6Sxpaj-ZNOnC7zy+E7A@mail.gmail.com>

On Tue, Apr 9, 2013 at 4:41 PM, Steven Ranney <steven.ranney at gmail.com> wrote:

> When I try to spTransform() the proj4string in barabay,
>
> spTransform(barabay, CRS("+proj=latlong +datum=WGS84 +ellps=WGS84
> +towgs84=0,0,0"))
>
> R prints out the object of barabay, including all of the lat/long values
> associated with the polygons.

 R doesn't (or rarely) replaces objects - you need to assign the
result of spTransform to something, eg:

barabayTrans = spTransform(barabay, CRS("..etc..."))

otherwise R just prints the result of spTransform, which is what you saw!

Barry


From basille at ase-research.org  Tue Apr  9 19:23:14 2013
From: basille at ase-research.org (Mathieu Basille)
Date: Tue, 09 Apr 2013 13:23:14 -0400
Subject: [R-sig-Geo] Help with ENFA in R
In-Reply-To: <1365511769098-7583243.post@n2.nabble.com>
References: <1365511769098-7583243.post@n2.nabble.com>
Message-ID: <51644E82.5080703@ase-research.org>

Dear Jonathan,

Here are a few comments:

1) I strongly suggest that you update to 'adehabitatHS', which has 
superseded the good-old 'adehabitat'. See [1]. It will solve your error 
with 'niche.test'.

2) For the tolerance, 'niche.test' will give you both the marginality and 
the tolerance.

3) For the randomization test of the ENFA, please have a look at 
?randtest.enfa, and at ?randtest for more details about the object returned.

4) You don't need to call 'list(...)' to get the values. For example, 
'enfatest1$m' would give you the answer.

5) I would also advise you to check this reference [2] about comparison 
between species niche. The function 'niche' in ade4 is probably what you're 
looking for...

Hope this helps,
Mathieu.


[1] http://cran.r-project.org/web/packages/adehabitatHS/index.html

[2] Doledec, S.; Chessel, D. & Gimaret Carpentier, C. (2000) Niche 
separation in community analysis: A new method. Ecology, 81: 2914-2927 doi 
10.1890/0012-9658(2000)081[2914:NSICAA]2.0.CO;2


Le 04/09/2013 08:49 AM, JonathanAronson a ?crit :
> Hello there
> I am really hoping someone out there can help me. I have read the various
> forums but havent found information that can help me.
> I am running an ENFA in R for 12 species using 15 environmental variables.
> Below is my code and some questions:
>
>
> library(ade4)
> library(adehabitat)
> test<- read.csv("Species_Localities/R.blasii.csv", header=T)
> var1<- import.asc("Data/bio_01.asc")
> var2<- import.asc("Data/bio_12.asc")
> var3<- import.asc("Data/Aridity.asc")
> var4<- import.asc("Data/altitude.asc")
> var5<- import.asc("Data/unpalatable.asc")
> var6<- import.asc("Data/thicket.asc")
> var7<- import.asc("Data/succulent.asc")
> var8<- import.asc("Data/shrubland.asc")
> var9<- import.asc("Data/rainforest.asc")
> var10<- import.asc("Data/mosaic.asc")
> var11<- import.asc("Data/mopane.asc")
> var12<- import.asc("Data/misavanna.asc")
> var13<- import.asc("Data/hydro.asc")
> var14<- import.asc("Data/fynbos.asc")
> var15<- import.asc("Data/desert.asc")
> map<- as.kasc(list(bio_01 = var1, bio_12 = var2, Aridity = var3, altitude =
> var4, unpalatable = var5, thicket = var6, succulent = var7, shrubland =
> var8, rainforest = var9, mosaic = var10, mopane = var11, misavanna = var12,
> hydro = var13, fynbos = var14, desert = var15))
> enfatest<- data2enfa(map, test)
> pc <- dudi.pca(enfatest$tab, scannf = FALSE, nf = 1)
> enfatest1 <- enfa(pc, enfatest$pr, scannf = FALSE)
> renfa <- randtest(enfatest1, nrepet=999)
> list(enfatest1$m)
> list(enfatest1$s)
> list(enfatest1$co)
> hist(enfatest1)
> hist(enfatest1, scores = FALSE, type = "l")
> image(enfatest1)
> list(renfa$expvar)
> list(renfa$pvalue)
> list(renfa$obs)
> scatter(enfatest1)
> niche.test(map, test, nrep = 999, o.include = TRUE)
>
> list(enfatest1$m) has given me the global marginality for each species and
> those are:
>
> Species            Marginality
> R.a 	                  4.8
> R.b 	                 12.47
> R.ca 	                 19.27
> R.cl 	                 15.16
> R.da 	                 12.36
> R.de 	                 15.31
> R.e 	                 12.19
> R.f 	                  6.07
> R.h 	                  9.65
> R.l 	                  9.14
> R.si 	                 13.7
> R.sw 	                 13.11
>
> I do not know how to get the global tolerance scores. Can you please help me
> with that?
>
> I also do not know what the randomisation test for ENFA does. Could you
> please explain that?
>
> I am unsure about what list(renfa$expvar), list(renfa$pvalue),
> list(renfa$obs) are telling me. I get a p-value of 0.001.
>
> I have tried to test the significance of my results using a Monte Carlo test
> but i get this error when I run the code:
>
> Error in niche.test(map, test, nrepet = 999, o.include = TRUE) :
>    should be an object of class SpatialPixelsDataFrame
>
>
> Please can someone provide some assistance because I have been stuck with
> this for months.
> Thank you in advance
> Jonathan
>
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Help-with-ENFA-in-R-tp7583243.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 

~$ whoami
Mathieu Basille, PhD

~$ locate --details
University of Florida \\
Fort Lauderdale Research and Education Center
(+1) 954-577-6314
http://ase-research.org/basille

~$ fortune
? Le tout est de tout dire, et je manque de mots
Et je manque de temps, et je manque d'audace. ?
  -- Paul ?luard


From alobolistas at gmail.com  Tue Apr  9 20:41:50 2013
From: alobolistas at gmail.com (Agustin Lobo)
Date: Tue, 9 Apr 2013 20:41:50 +0200
Subject: [R-sig-Geo] rgdal in MAc OSX with R 3.0
Message-ID: <CAG4NReLBXuUZ=ySsWVvqOPgAu+cDuEbMxbQU=O8qoaykQngM1g@mail.gmail.com>

HI,

After a long time of not having problems with installing rgdal
on Mac OSX using

setRepositories(ind=1:2)
install.packages("rgdal")

(and even perhaps using the gui in RStudio?)

I get now
package ?rgdal? is not available (for R version 3.0.0)

Does anybody know if the package will be built for MAc again or do
we have to on and compile on our own?

Thanks


From Roger.Bivand at nhh.no  Tue Apr  9 20:52:53 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 9 Apr 2013 20:52:53 +0200
Subject: [R-sig-Geo] rgdal in MAc OSX with R 3.0
In-Reply-To: <CAG4NReLBXuUZ=ySsWVvqOPgAu+cDuEbMxbQU=O8qoaykQngM1g@mail.gmail.com>
References: <CAG4NReLBXuUZ=ySsWVvqOPgAu+cDuEbMxbQU=O8qoaykQngM1g@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1304092048030.5969@reclus.nhh.no>

See:

https://stat.ethz.ch/pipermail/r-sig-geo/2013-April/017934.html

for the first posting to ask about rgdal, rgeos, etc. on OSX for R 3.0.0. 
The rgeos package is now available for this platform (the R offering for 
OSX has changed a good deal for R 3.0.*), but rgdal is as yet not 
available.

If you would like to help Simon Urbanek, I'm sure he would be grateful for 
assistance, but there is no guarantee that things will "just work"; "just 
working" means a small number of people doing a lot of work in their own 
time. Simon has already made a major contribution, so for now, patience is 
appropriate, he is aware of the issue.

Roger

On Tue, 9 Apr 2013, Agustin Lobo wrote:

> HI,
>
> After a long time of not having problems with installing rgdal
> on Mac OSX using
>
> setRepositories(ind=1:2)
> install.packages("rgdal")
>
> (and even perhaps using the gui in RStudio?)
>
> I get now
> package ?rgdal? is not available (for R version 3.0.0)
>
> Does anybody know if the package will be built for MAc again or do
> we have to on and compile on our own?
>
> Thanks
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From Tom_Roche at pobox.com  Tue Apr  9 21:27:23 2013
From: Tom_Roche at pobox.com (Tom Roche)
Date: Tue, 09 Apr 2013 15:27:23 -0400
Subject: [R-sig-Geo] [raster] conserving dimensions when regridding a 4D
 Brick or Stack
In-Reply-To: <CANtt_hyh03=avU5+P_i0g4vKMmb3W-O0cPwgfWraXZ+BEbzB9A@mail.gmail.com>
References: <CANtt_hyh03=avU5+P_i0g4vKMmb3W-O0cPwgfWraXZ+BEbzB9A@mail.gmail.com>
	<87y5cxehf7.fsf@pobox.com>
Message-ID: <87zjx733ok.fsf@pobox.com>


https://stat.ethz.ch/pipermail/r-sig-geo/2013-April/017947.html
>> Can one

>> + create a 4D RasterBrick or RasterStack
>> + instruct projectRaster

>> so as to get 4D regridded output? Or must one

>> - create 3D RasterLayer's (i.e., one per LAY) from the 4D Brick
>> - regrid each 3D Layer
>> - reassemble the 4D Brick

https://stat.ethz.ch/pipermail/r-sig-geo/2013-April/017973.html
> A RasterBrick is 3D [only].

also RasterStack, no? It Would Be Nice if the docs made this explicit--
or am I missing something?

> all you can do with the raster package is process the data level by
> level

I guessed:

# regridding, including the 4D 3hourlies
https://bitbucket.org/tlroche/gfed-3.1_global_to_aqmeii-na/src/f5e1fd0d607da8bbfe67bb180aaaa21dcf28e1f2/vis_regrid_vis.r?at=master
# reassembling the 4D 3hourlies
https://bitbucket.org/tlroche/gfed-3.1_global_to_aqmeii-na/src/f5e1fd0d607da8bbfe67bb180aaaa21dcf28e1f2/fix_3hourlies.ncl?at=master


From jagaronson at gmail.com  Tue Apr  9 21:51:33 2013
From: jagaronson at gmail.com (JonathanAronson)
Date: Tue, 9 Apr 2013 12:51:33 -0700 (PDT)
Subject: [R-sig-Geo] Help with ENFA in R
In-Reply-To: <51644E82.5080703@ase-research.org>
References: <1365511769098-7583243.post@n2.nabble.com>
	<51644E82.5080703@ase-research.org>
Message-ID: <1365537093429-7583258.post@n2.nabble.com>

Hi Mathieu

Thank you so much for your quick response. I really appreciate the effort
and thank you for your answers.

I am now using the AdehabitatHS package but still have some questions.

1) I am not sure what (renfa$expvar), (renfa$pvalue) and (renfa$obs) are
actually telling me in the output. I have copied the output below:

(renfa$expvar)
    Std.Obs Expectation    Variance 
  45.557688    7.316997   11.538948 
> (renfa$pvalue)
[1] 0.001
> (renfa$obs)
[1] 162.072

2) because i am using AdehabitatHS do I not need the following line of code
anymore:

map<- as.kasc(list(bio_01 = var1, bio_12 = var2, Aridity = var3, altitude =
var4, unpalatable = var5, thicket = var6, succulent = var7, shrubland =
var8, rainforest = var9, mosaic = var10, mopane = var11, misavanna = var12,
hydro = var13, fynbos = var14, desert = var15))
enfatest<- data2enfa(map, test)

3) I also got two error messages:

> image(enfatest1)
Error in image.default(enfatest1) : 'z' must be a matrix

> niche.test(map, test, nrepet = 999, o.include = FALSE)
Warning messages:
1: In hist.default(x, plot = FALSE, br = xbr, freq = FALSE) :
  argument ?freq? is not made use of
2: In hist.default(y, plot = FALSE, br = ybr, freq = FALSE) :
  argument ?freq? is not made use of

Mathieu, could you please provide some assistance with these questions?
Thank you
Jonathan




--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Help-with-ENFA-in-R-tp7583243p7583258.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From phytophthorasb at yahoo.com  Tue Apr  9 23:56:26 2013
From: phytophthorasb at yahoo.com (Empty Empty)
Date: Tue, 9 Apr 2013 14:56:26 -0700 (PDT)
Subject: [R-sig-Geo] Memory problems with dnearneigh in spdep
In-Reply-To: <alpine.LRH.2.03.1304072049050.24741@reclus.nhh.no>
References: <1362941280.23258.YahooMailNeo@web142503.mail.bf1.yahoo.com>
	<1365354249.76493.YahooMailNeo@web142505.mail.bf1.yahoo.com>
	<alpine.LRH.2.03.1304072049050.24741@reclus.nhh.no>
Message-ID: <1365544586.27248.YahooMailNeo@web142506.mail.bf1.yahoo.com>

Thanks so much, Roger, for your suggestions.
I should have realized it was taking kilometers rather than meters!

My summary(r) is:
Object of class SpatialPointsDataFrame
Coordinates:
??????????????? min????? max
coords.x1 -17.52090 51.40407
coords.x2 -34.82918 37.53746
Is projected: TRUE 
proj4string :
[+proj=aea +lat_1=20 +lat_2=-23 +lat_0=0 +lon_0=25 +x_0=0 +y_0=0 +ellps=WGS84
+datum=WGS84 +units=m +no_defs +towgs84=0,0,0]
Number of points: 36820887
Data attributes:
??? POINTID?????????? GRID_CODE??????? 
?Min.?? :????? 1??? Min.?? :???? 0.00? 
?1st Qu.: 250000??? 1st Qu.:???? 0.28? 
?Median : 500000??? Median :???? 2.57? 
?Mean?? : 500000??? Mean?? :??? 26.43? 
?3rd Qu.: 750000??? 3rd Qu.:??? 10.51? 
?Max.?? : 999999??? Max.?? :103104.70? 
?NA's?? :35820888? 


It seems that there are a lot of NA's. (Everything in the square outside the continent's borders should be an NA, so maybe that's a reasonable number). It seemed right when I plotted it earlier.

I ran it with 9.333 as the distance band (then I was going to try 1.5 next).
nb<- dnearneigh(r, 0, 9.333)

It used a constant amount of memory for the first ~90 minutes and then it increased at a constant rate for the next 20 hours
until it was using virtually all the memory on the server and was stopped.
Because the administrator had to kill my job, I wasn't able to get session info while the session was open. I'm not sure this is at all helpful, but when I re-started R this is the sessionInfo() :
R version 2.15.3 (2013-03-01)
Platform: x86_64-pc-linux-gnu (64-bit)

locale:
?[1] LC_CTYPE=en_US.UTF-8 LC_NUMERIC=C???????? LC_TIME=C??????????? LC_COLLATE=C?????? ?
?[5] LC_MONETARY=C??????? LC_MESSAGES=C??????? LC_PAPER=C?????????? LC_NAME=C????????? ?
?[9] LC_ADDRESS=C???????? LC_TELEPHONE=C?????? LC_MEASUREMENT=C???? LC_IDENTIFICATION=C 

attached base packages:
[1] stats???? graphics? grDevices utils???? datasets? methods?? base??? ?

loaded via a namespace (and not attached):
[1] tools_2.15.3

Thanks,
Juliann


________________________________
 From: Roger Bivand <Roger.Bivand at nhh.no>
To: Empty Empty <phytophthorasb at yahoo.com> 
Cc: "r-sig-geo at r-project.org" <r-sig-geo at r-project.org> 
Sent: Sunday, April 7, 2013 12:15 PM
Subject: Re: [R-sig-Geo] Memory problems with dnearneigh in spdep
 
I do prefer an affiliation, a real name, and a motivation; a
yahoo or gmail address tells me nothing about what you might be expected
to know. If I (or a list helper) cannot "place" you, it is much harder to
know why you are having problems.

You are also in breach of list rules because you are posting in HTML rather than just plain text. Removing the HTML will shorten your posting radically.


On Sun, 7 Apr 2013, Empty Empty wrote:

> Hi,
> 
> I'm running into memory problems calculating Gi* using dnearneigh and wonder if someone has any suggestions for either my script or another work around.
> 
> I have 1km data for Africa. My colleague calculated the appropriate distance band (9333m) using incremental spatial autocorrelation in ArcGIS but she was only able to run a subset of the data or with the data aggregated to 5km due to memory issues (fixed distance, Euclidean). I tried it in both ArcGIS (memory error after 45 hours) and R (Within 2 hours it was using more than 245GB on the server and then crashed). This is what I used

Please always include the output of sessionInfo(). Here also include summary(r) output.

> 
> library(spdep)
> 
> 
> r<-readOGR(".","r")
> 
> coords<-coordinates(r)

This is not needed.

> nb9333<- dnearneigh(coords, 0,9333,longlat = F)

nb9333<- dnearneigh(r, 0, 9333)

would work, and would not override longlat=. I assume in fact that r is in longlat, and that you would then mean to use a km threshold of 9.333. If I'm right, then the memory usage is being complicated by your including all observations as neighbours of each observation.

For a 1km grid, a threshold of 9333m means that each of the about 30M gridcells has 100 neighbours (rather strong smoothing). Is the threshold sensibly chosen? The neighbour object will be 30M by 100 by 4, 1.21e+10 (12G); the labels of the neighbour object at least the same; the weights 24G in addition, so nb9333.listw is about 50G. With a more sensible threshold (1.5km?), the sizes of the nb9333.listw weights object become more tractable, maybe about 5G.

Is any of the data observed on this grid? For localG* (or localG) to make any sense, the variable must be observed at this resolution (satellite imagery?) - if interpolated, all bets are off.

Finally, the output involves so many multiple comparisons that no statistical inference is possible under normal assumptions - where is the 3.886 coming from - is this an attempt to adjust for multiple comparisons?

I'm unsure why anyone would do this, as you could use standard filtering techniques on imaging data. The raster package also has functions for computing the local Moran and Geary measures on RasterLayer objects.

Hope this clarifies,

Roger

> nb9333.listw <- nb2listw(include.self(nb9333), style="B")???
> G9333<-localG(r$GRID_CODE,nb9333.listw)???
> 
> 
> sig3 <- classIntervals(G9333, n=3, style="fixed",
> ?????????????????????? fixedBreaks=c(min(G9333),-3.886, 3.886, max(G9333)))???? #I dont' think 3.886 is right
> cs<-c('blue','white','red') # blue = below -3, white = intermediate, red = above 3
> sigcol <- findColours(sig3, cs)?
> 
> png("r.png")
> plot(r, col=sigcol, axes=TRUE)
> dev.off()
> 
> ??? [[alternative HTML version deleted]]
> 
> 

-- Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From basille at ase-research.org  Wed Apr 10 00:01:48 2013
From: basille at ase-research.org (Mathieu Basille)
Date: Tue, 09 Apr 2013 18:01:48 -0400
Subject: [R-sig-Geo] Help with ENFA in R
In-Reply-To: <1365537093429-7583258.post@n2.nabble.com>
References: <1365511769098-7583243.post@n2.nabble.com>
	<51644E82.5080703@ase-research.org>
	<1365537093429-7583258.post@n2.nabble.com>
Message-ID: <51648FCC.5070809@ase-research.org>

Le 04/09/2013 03:51 PM, JonathanAronson a ?crit :
> Hi Mathieu
>
> Thank you so much for your quick response. I really appreciate the effort
> and thank you for your answers.
>
> I am now using the AdehabitatHS package but still have some questions.
>
> 1) I am not sure what (renfa$expvar), (renfa$pvalue) and (renfa$obs) are
> actually telling me in the output. I have copied the output below:
>
> (renfa$expvar)
>      Std.Obs Expectation    Variance
>    45.557688    7.316997   11.538948

$expvar gives you the expected value from the simulated set 
('Expectation'), i.e. the mean of the simulated values, together with its 
variance. 'Std.Obs' tells you how much the observed value differs from the 
distribution: it is basically the ratio of the difference between the 
observed and the mean of simulated values, over the standard deviation of 
the simulated values. You expect a difference equal to the SD, i.e. a ratio 
'Std.Obs' of 1.

>> (renfa$pvalue)
> [1] 0.001

This is the p-value of the test. See ?randtest for the details of the 
computation.

>> (renfa$obs)
> [1] 162.072

This is the observed value (here the first specialization eigenvalue).

The best way to summarize the results is to simply print the object, by a 
direct call to 'renfa' in your case. Then, use 'plot(renfa)' for a very 
neat graphical display of the test.


> 2) because i am using AdehabitatHS do I not need the following line of code
> anymore:
>
> map<- as.kasc(list(bio_01 = var1, bio_12 = var2, Aridity = var3, altitude =
> var4, unpalatable = var5, thicket = var6, succulent = var7, shrubland =
> var8, rainforest = var9, mosaic = var10, mopane = var11, misavanna = var12,
> hydro = var13, fynbos = var14, desert = var15))
> enfatest<- data2enfa(map, test)

No you don't. adehabitatHS uses 'sp' classes. Please have a look at the 
vignette of both packages for more details:

vignette("intro_sp")
vignette("adehabitatHS")


> 3) I also got two error messages:
>
>> image(enfatest1)
> Error in image.default(enfatest1) : 'z' must be a matrix

This is quite normal... Assuming 'enfatest1' is the result of the ENFA, 
there's no image function for such object... Check the section on the ENFA 
in the above cited vignette.

>> niche.test(map, test, nrepet = 999, o.include = FALSE)
> Warning messages:
> 1: In hist.default(x, plot = FALSE, br = xbr, freq = FALSE) :
>    argument ?freq? is not made use of
> 2: In hist.default(y, plot = FALSE, br = ybr, freq = FALSE) :
>    argument ?freq? is not made use of

Not sure here, but I bet that the problem comes also from the class of 
'map' and/or 'test'. Check the vignette and the example of the function.

Mathieu.


> Mathieu, could you please provide some assistance with these questions?
> Thank you
> Jonathan
>
>
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Help-with-ENFA-in-R-tp7583243p7583258.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 

~$ whoami
Mathieu Basille, PhD

~$ locate --details
University of Florida \\
Fort Lauderdale Research and Education Center
(+1) 954-577-6314
http://ase-research.org/basille

~$ fortune
? Le tout est de tout dire, et je manque de mots
Et je manque de temps, et je manque d'audace. ?
  -- Paul ?luard


From ferra.xu at yahoo.com  Wed Apr 10 04:30:18 2013
From: ferra.xu at yahoo.com (Ferra Xu)
Date: Tue, 9 Apr 2013 19:30:18 -0700 (PDT)
Subject: [R-sig-Geo] Simulating a Gibbs Marked point process
Message-ID: <1365561018.5738.YahooMailNeo@web162202.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130409/5194cdc9/attachment.pl>

From Roger.Bivand at nhh.no  Wed Apr 10 09:10:41 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 10 Apr 2013 09:10:41 +0200
Subject: [R-sig-Geo] Memory problems with dnearneigh in spdep
In-Reply-To: <1365544586.27248.YahooMailNeo@web142506.mail.bf1.yahoo.com>
References: <1362941280.23258.YahooMailNeo@web142503.mail.bf1.yahoo.com>
	<1365354249.76493.YahooMailNeo@web142505.mail.bf1.yahoo.com>
	<alpine.LRH.2.03.1304072049050.24741@reclus.nhh.no>
	<1365544586.27248.YahooMailNeo@web142506.mail.bf1.yahoo.com>
Message-ID: <alpine.LRH.2.03.1304100849590.8232@reclus.nhh.no>

On Tue, 9 Apr 2013, Empty Empty wrote:

> Thanks so much, Roger, for your suggestions.
> I should have realized it was taking kilometers rather than meters!
>
> My summary(r) is:
> Object of class SpatialPointsDataFrame
> Coordinates:
> ??????????????? min????? max
> coords.x1 -17.52090 51.40407
> coords.x2 -34.82918 37.53746
> Is projected: TRUE 
> proj4string :
> [+proj=aea +lat_1=20 +lat_2=-23 +lat_0=0 +lon_0=25 +x_0=0 +y_0=0 +ellps=WGS84
> +datum=WGS84 +units=m +no_defs +towgs84=0,0,0]

Given your object summary, you need to check where your data came from. 
The bounding box is for geographical coordinates, but the declared 
coordinate reference system is projected in units of metres. So your 9.333 
is 9.333m, and no neighbours will be found. The inclusion of NAs in 
gridded data represented as points is unnecessary, and all points not on 
land should be dropped before analysis begins.

I do suggest moving to a raster representation, and using focal methods in 
the raster package to generate the separate components of equation 14.3, 
p. 263-264 in Gettis & Ord (1996). Using focal methods defines the moving 
window as a matrix, here 10x10, moved over the raster and circumventing 
the creation of a weights object - create a new raster layer with \sum{j} 
w_{ij}(d) x_j values. W_i^* will be a constant, as will \bar{x}^*, and 
possibly the other starred terms too.

Hope this helps,

Roger

> Number of points: 36820887
> Data attributes:
> ??? POINTID?????????? GRID_CODE??????? 
> ?Min.?? :????? 1??? Min.?? :???? 0.00? 
> ?1st Qu.: 250000??? 1st Qu.:???? 0.28? 
> ?Median : 500000??? Median :???? 2.57? 
> ?Mean?? : 500000??? Mean?? :??? 26.43? 
> ?3rd Qu.: 750000??? 3rd Qu.:??? 10.51? 
> ?Max.?? : 999999??? Max.?? :103104.70? 
> ?NA's?? :35820888? 
>
>
> It seems that there are a lot of NA's. (Everything in the square outside the continent's borders should be an NA, so maybe that's a reasonable number). It seemed right when I plotted it earlier.
>
> I ran it with 9.333 as the distance band (then I was going to try 1.5 next).
> nb<- dnearneigh(r, 0, 9.333)
>
> It used a constant amount of memory for the first ~90 minutes and then it increased at a constant rate for the next 20 hours
> until it was using virtually all the memory on the server and was stopped.
> Because the administrator had to kill my job, I wasn't able to get session info while the session was open. I'm not sure this is at all helpful, but when I re-started R this is the sessionInfo() :
> R version 2.15.3 (2013-03-01)
> Platform: x86_64-pc-linux-gnu (64-bit)
>
> locale:
> ?[1] LC_CTYPE=en_US.UTF-8 LC_NUMERIC=C???????? LC_TIME=C??????????? LC_COLLATE=C?????? ?
> ?[5] LC_MONETARY=C??????? LC_MESSAGES=C??????? LC_PAPER=C?????????? LC_NAME=C????????? ?
> ?[9] LC_ADDRESS=C???????? LC_TELEPHONE=C?????? LC_MEASUREMENT=C???? LC_IDENTIFICATION=C 
>
> attached base packages:
> [1] stats???? graphics? grDevices utils???? datasets? methods?? base??? ?
>
> loaded via a namespace (and not attached):
> [1] tools_2.15.3
>
> Thanks,
> Juliann
>
>
> ________________________________
> From: Roger Bivand <Roger.Bivand at nhh.no>
> To: Empty Empty <phytophthorasb at yahoo.com> 
> Cc: "r-sig-geo at r-project.org" <r-sig-geo at r-project.org> 
> Sent: Sunday, April 7, 2013 12:15 PM
> Subject: Re: [R-sig-Geo] Memory problems with dnearneigh in spdep
> 
> I do prefer an affiliation, a real name, and a motivation; a
> yahoo or gmail address tells me nothing about what you might be expected
> to know. If I (or a list helper) cannot "place" you, it is much harder to
> know why you are having problems.
>
> You are also in breach of list rules because you are posting in HTML rather than just plain text. Removing the HTML will shorten your posting radically.
>
>
> On Sun, 7 Apr 2013, Empty Empty wrote:
>
>> Hi,
>> 
>> I'm running into memory problems calculating Gi* using dnearneigh and wonder if someone has any suggestions for either my script or another work around.
>> 
>> I have 1km data for Africa. My colleague calculated the appropriate distance band (9333m) using incremental spatial autocorrelation in ArcGIS but she was only able to run a subset of the data or with the data aggregated to 5km due to memory issues (fixed distance, Euclidean). I tried it in both ArcGIS (memory error after 45 hours) and R (Within 2 hours it was using more than 245GB on the server and then crashed). This is what I used
>
> Please always include the output of sessionInfo(). Here also include summary(r) output.
>
>> 
>> library(spdep)
>> 
>> 
>> r<-readOGR(".","r")
>> 
>> coords<-coordinates(r)
>
> This is not needed.
>
>> nb9333<- dnearneigh(coords, 0,9333,longlat = F)
>
> nb9333<- dnearneigh(r, 0, 9333)
>
> would work, and would not override longlat=. I assume in fact that r is in longlat, and that you would then mean to use a km threshold of 9.333. If I'm right, then the memory usage is being complicated by your including all observations as neighbours of each observation.
>
> For a 1km grid, a threshold of 9333m means that each of the about 30M gridcells has 100 neighbours (rather strong smoothing). Is the threshold sensibly chosen? The neighbour object will be 30M by 100 by 4, 1.21e+10 (12G); the labels of the neighbour object at least the same; the weights 24G in addition, so nb9333.listw is about 50G. With a more sensible threshold (1.5km?), the sizes of the nb9333.listw weights object become more tractable, maybe about 5G.
>
> Is any of the data observed on this grid? For localG* (or localG) to make any sense, the variable must be observed at this resolution (satellite imagery?) - if interpolated, all bets are off.
>
> Finally, the output involves so many multiple comparisons that no statistical inference is possible under normal assumptions - where is the 3.886 coming from - is this an attempt to adjust for multiple comparisons?
>
> I'm unsure why anyone would do this, as you could use standard filtering techniques on imaging data. The raster package also has functions for computing the local Moran and Geary measures on RasterLayer objects.
>
> Hope this clarifies,
>
> Roger
>
>> nb9333.listw <- nb2listw(include.self(nb9333), style="B")???
>> G9333<-localG(r$GRID_CODE,nb9333.listw)???
>> 
>> 
>> sig3 <- classIntervals(G9333, n=3, style="fixed",
>> ?????????????????????? fixedBreaks=c(min(G9333),-3.886, 3.886, max(G9333)))???? #I dont' think 3.886 is right
>> cs<-c('blue','white','red') # blue = below -3, white = intermediate, red = above 3
>> sigcol <- findColours(sig3, cs)?
>> 
>> png("r.png")
>> plot(r, col=sigcol, axes=TRUE)
>> dev.off()
>> 
>> ??? [[alternative HTML version deleted]]
>> 
>> 
>
> -- Roger Bivand
> Department of Economics, NHH Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From jagaronson at gmail.com  Wed Apr 10 09:59:04 2013
From: jagaronson at gmail.com (JonathanAronson)
Date: Wed, 10 Apr 2013 00:59:04 -0700 (PDT)
Subject: [R-sig-Geo] Help with ENFA in R
In-Reply-To: <51648FCC.5070809@ase-research.org>
References: <1365511769098-7583243.post@n2.nabble.com>
	<51644E82.5080703@ase-research.org>
	<1365537093429-7583258.post@n2.nabble.com>
	<51648FCC.5070809@ase-research.org>
Message-ID: <1365580744207-7583264.post@n2.nabble.com>

Hi Mathieu

Thank you again. You are really helping  me. Please forgive some of my
questions because I am very knew to R and I have to teach this to myself. 

AdehabitatHS is using a different method to read the raster files. So when I
input this code: var1<- import.asc("Data/bio_01.asc") I get the following
error - Error: could not find function "import.asc". This makes sense to me
because sp classes are used. I have read both the vignettes and used the
example code for the lynx data but I am still struggling to interpret what
the vignettes are saying and to use my own data. The code map <-
lynxjura$map seems to contain all the environmental data. I am not sure how
to use the sp package to get my 15 environmental variables into a similar
dataframe. The same goes for my csv files - do I still need to use read.csv
or should I rather use something like $locs.

Thank you again
Jonathan






--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Help-with-ENFA-in-R-tp7583243p7583264.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From clement.calenge at oncfs.gouv.fr  Wed Apr 10 10:05:28 2013
From: clement.calenge at oncfs.gouv.fr (Clement Calenge)
Date: Wed, 10 Apr 2013 10:05:28 +0200
Subject: [R-sig-Geo] Help with ENFA in R
In-Reply-To: <1365580744207-7583264.post@n2.nabble.com>
References: <1365511769098-7583243.post@n2.nabble.com>
	<51644E82.5080703@ase-research.org>
	<1365537093429-7583258.post@n2.nabble.com>
	<51648FCC.5070809@ase-research.org>
	<1365580744207-7583264.post@n2.nabble.com>
Message-ID: <51651D48.1080103@oncfs.gouv.fr>

Dear Jonathan,

To import the maps, have a look at the function readAsciiGrid from the 
package maptools.
To import the points, read.csv or read.table (use your prefered way to 
import data in R).
Con
HTH,

Cl?ment Calenge.

On 04/10/2013 09:59 AM, JonathanAronson wrote:
> Hi Mathieu
>
> Thank you again. You are really helping  me. Please forgive some of my
> questions because I am very knew to R and I have to teach this to myself.
>
> AdehabitatHS is using a different method to read the raster files. So when I
> input this code: var1<- import.asc("Data/bio_01.asc") I get the following
> error - Error: could not find function "import.asc". This makes sense to me
> because sp classes are used. I have read both the vignettes and used the
> example code for the lynx data but I am still struggling to interpret what
> the vignettes are saying and to use my own data. The code map <-
> lynxjura$map seems to contain all the environmental data. I am not sure how
> to use the sp package to get my 15 environmental variables into a similar
> dataframe. The same goes for my csv files - do I still need to use read.csv
> or should I rather use something like $locs.
>
> Thank you again
> Jonathan
>
>
>
>
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Help-with-ENFA-in-R-tp7583243p7583264.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


-- 
Cl?ment CALENGE
Cellule d'appui ? l'analyse de donn?es
Direction des Etudes et de la Recherche
Office national de la chasse et de la faune sauvage
Saint Benoist - 78610 Auffargis
tel. (33) 01.30.46.54.14


From Roger.Bivand at nhh.no  Wed Apr 10 10:12:38 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 10 Apr 2013 10:12:38 +0200
Subject: [R-sig-Geo] split/divide SpatialLines (sp) into n segments
In-Reply-To: <1365484162.62235.YahooMailNeo@web164902.mail.bf1.yahoo.com>
References: <1365484162.62235.YahooMailNeo@web164902.mail.bf1.yahoo.com>
Message-ID: <alpine.LRH.2.03.1304101005220.8232@reclus.nhh.no>

On Tue, 9 Apr 2013, Omphalodes Verna wrote:

> Dear list!
>
> I would like to split/divide?SpatialLines into n segments. Is there any function to do this in R? Or does somebody know the solution for that?
>
> Here is example of?SpatialLines?from?the sp vignette:
>
> library(sp)
> Sl = SpatialLines(list(Lines(list(Line(cbind(c(1,2,3),c(3,2,2)))), ID="a")))
> plot(Sl)
> coordinates(Sl)

Assuming the line segents are to be Lines objects:

library(sp)
Sl = SpatialLines(list(Lines(list(Line(cbind(c(1,2,3),c(3,2,2)))),
  ID="a")))
cSl <- coordinates(Sl)
cSl
in_nrows <- lapply(cSl, function(x) sapply(x, nrow))
outn <- sapply(in_nrows, function(y) sum(y-1))
res <- vector(mode="list", length=outn)
i <- 1
for (j in seq(along=cSl)) {
   for (k in seq(along=cSl[[j]])) {
     for (l in 1:(nrow(cSl[[j]][[k]])-1)) {
       res[[i]] <- cSl[[j]][[k]][l:(l+1),]
       i <- i + 1
     }
   }
}
res1 <- vector(mode="list", length=outn)
for (i in seq(along=res))
   res1[[i]] <- Lines(list(Line(res[[i]])), as.character(i))
outSL <- SpatialLines(res1)

It would be possible to use *apply functions instead of the loops, but the 
loops may make the operations plainer. To show that we can reconstruct the 
input object (not the same ID, but the geometry is OK):

library(rgeos)
coordinates(gLineMerge(outSL))

Hope this helps,

Roger

>
> Thanks to all, OV
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From samanmonfared1 at gmail.com  Wed Apr 10 10:32:57 2013
From: samanmonfared1 at gmail.com (Saman Monfared)
Date: Wed, 10 Apr 2013 13:02:57 +0430
Subject: [R-sig-Geo] STSDF construct
Message-ID: <CAOytA4Z=-JGmwdYZHV8C9q4XYuvjqkd2H5oxiMBP8Gz8upQPSg@mail.gmail.com>

Hi,
I try to  construct    a  stsdf  st class. But I dont know how.
I attached my data and cod. my data  are cancer rate  incidence.
Best,

Saman.


-- 
Saman Monfared
Msc, Department of Statistics, Shiraz University,
Shiraz 71454, Iran
Email: Samanmonfared1 at gmail.com

Tel: +98 917 5305167
-------------- next part --------------
A non-text attachment was scrubbed...
Name: RRR.rar
Type: application/rar
Size: 3684 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130410/d9844b84/attachment.bin>

From r.turner at auckland.ac.nz  Wed Apr 10 11:13:59 2013
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Wed, 10 Apr 2013 21:13:59 +1200
Subject: [R-sig-Geo] Simulating a Gibbs Marked point process
In-Reply-To: <1365561018.5738.YahooMailNeo@web162202.mail.bf1.yahoo.com>
References: <1365561018.5738.YahooMailNeo@web162202.mail.bf1.yahoo.com>
Message-ID: <51652D57.3000908@auckland.ac.nz>

On 04/10/2013 02:30 PM, Ferra Xu wrote:
> Hi everybody
>
> I want to simulate a pattern of points based on maximization of Gibbs marked point process density function by MCMC methods using R. I already know that rmh function in spatstat will do that, but I couldn't find any good example code for that... I don't know how should I determine the objective function that I want to be maximized in each iteration...
I don't really understand what you want to do.  The rmh() [random 
Metropolis Hastings]
function does not proceed by maximizing the density function of the 
(Gibbs) process.  It
uses a Markov chain (whose "states" are point patterns), the 
Metropolis-Hastings algorithm,
and the *conditional intensity* function of the process, to effect the 
simulation.  The transitions
between states are governed by transition probabilities constructed so 
that the *steady
state* distribution of the Markov chain is the distribution of the 
desired process.  There is
no maximization of anything --- at least not in any obvious way, as far 
as I can see.

What do you mean by "I couldn't find any good example code"?  There are 
many examples
of code *using* the rmh() function in the online help.  If you want to 
see the code of rmh()
--- well, R and all of its contributed packages are open source. 
Download the spatstat source
package and have a look! (Be warned --- the heavy lifting is done in C, 
and the code is pretty
subtle and obscure.  By my standards.)

     cheers,

         Rolf Turner


From b.rowlingson at lancaster.ac.uk  Wed Apr 10 11:48:50 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed, 10 Apr 2013 10:48:50 +0100
Subject: [R-sig-Geo] FOSS4G Conference submissions
Message-ID: <CANVKczMCpFmNWwWov1u-SHbUm9YS3YMAQuVSPqwXQEaR_61ODw@mail.gmail.com>

FOSS4G 2013 (The global open-source geospatial conference) is in the
UK in Nottingham in September, and abstract submissions for
presentations close on Friday.

There was a lot of buzz about R at GISRUK (the UK academic conference)
recently, so it would be great to see plenty of R-geo talks at FOSS4G.

Conference website is here: http://2013.foss4g.org/

Barry

Conflict-of-interest declaration: I'm on the committee!


From jagaronson at gmail.com  Wed Apr 10 12:02:03 2013
From: jagaronson at gmail.com (JonathanAronson)
Date: Wed, 10 Apr 2013 03:02:03 -0700 (PDT)
Subject: [R-sig-Geo] Help with ENFA in R
In-Reply-To: <51651D48.1080103@oncfs.gouv.fr>
References: <1365511769098-7583243.post@n2.nabble.com>
	<51644E82.5080703@ase-research.org>
	<1365537093429-7583258.post@n2.nabble.com>
	<51648FCC.5070809@ase-research.org>
	<1365580744207-7583264.post@n2.nabble.com>
	<51651D48.1080103@oncfs.gouv.fr>
Message-ID: <1365588123956-7583270.post@n2.nabble.com>

Hi Clement

Thank you very much for your input. I have read the maptools information and
seen the examples for readAsciiGrid. I would like to create a
SpatailPixelDataFrame which contains the raster maps of 15 environmental
variables. Therefore, similar to the lynxjura$map SpatailPixelDataFramewhich
contains 4 environmental variables. How did you create the lynxjura$map data
frame - can you please show me step by step? You suggested using the
readAsciiGrid function to import my maps. Is this how I can create the
SpatailPixelDataFrame with the 15 variables I need? I do not understand the
example code to do this (I am new to R): 

x <- readAsciiGrid(system.file("grids/test.ag", package="maptools")[1])
summary(x)
image(x)
xp <- as(x, "SpatialPixelsDataFrame")
abline(h=332000, lwd=3)
xpS <- xp[coordinates(xp)[,2] < 332000,]
summary(xpS)
xS <- as(xpS, "SpatialGridDataFrame")
summary(xS)
tmpfl <- paste(tempdir(), "testS.ag", sep="/")
writeAsciiGrid(xS, tmpfl)
axS <- readAsciiGrid(tmpfl)
opar <- par(mfrow=c(1,2))
image(xS, main="before export")
image(axS, main="after import")
par(opar)
unlink(tmpfl)

Thanks in advance
Jonathan



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Help-with-ENFA-in-R-tp7583243p7583270.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From alexandresantosbr at yahoo.com.br  Wed Apr 10 16:03:45 2013
From: alexandresantosbr at yahoo.com.br (ASANTOS)
Date: Wed, 10 Apr 2013 10:03:45 -0400
Subject: [R-sig-Geo] Extract a pixel values in regular grid on a krigging
	object
Message-ID: <51657141.3040609@yahoo.com.br>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130410/3fe027d5/attachment.pl>

From jagaronson at gmail.com  Wed Apr 10 16:39:38 2013
From: jagaronson at gmail.com (JonathanAronson)
Date: Wed, 10 Apr 2013 07:39:38 -0700 (PDT)
Subject: [R-sig-Geo] Help with ENFA in R
In-Reply-To: <1365588123956-7583270.post@n2.nabble.com>
References: <1365511769098-7583243.post@n2.nabble.com>
	<51644E82.5080703@ase-research.org>
	<1365537093429-7583258.post@n2.nabble.com>
	<51648FCC.5070809@ase-research.org>
	<1365580744207-7583264.post@n2.nabble.com>
	<51651D48.1080103@oncfs.gouv.fr>
	<1365588123956-7583270.post@n2.nabble.com>
Message-ID: <1365604778155-7583272.post@n2.nabble.com>

perhaps I can clarify my question a lit bit further:

With the adehabitat package I used the function as.kasc to create a single
data frame with my 15 variables as Ive shown below:

map<- as.kasc(list(bio_01 = var1, bio_12 = var2, Aridity = var3, altitude =
var4, unpalatable = var5, thicket = var6, succulent = var7, shrubland =
var8, rainforest = var9, mosaic = var10, mopane = var11, misavanna = var12,
hydro = var13, fynbos = var14, desert = var15))

However, in the adehabitatHS, what is the equivalent function to use to
create the data frame which is equivalent to the lynxjura$map spatial pixel
data frame? There is no as.kasc function. I have used the readAsciiGrid
function in Maptools but I can only do that individually for each variable.
How then can I combine these into a single data frame? I have thought of
using the stack() function in the raster package.

I am really stuck here
Thanks to anyone who can help
Jonathan



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Help-with-ENFA-in-R-tp7583243p7583272.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From edzer.pebesma at uni-muenster.de  Wed Apr 10 16:58:15 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 10 Apr 2013 16:58:15 +0200
Subject: [R-sig-Geo] STSDF construct
In-Reply-To: <CAOytA4Z=-JGmwdYZHV8C9q4XYuvjqkd2H5oxiMBP8Gz8upQPSg@mail.gmail.com>
References: <CAOytA4Z=-JGmwdYZHV8C9q4XYuvjqkd2H5oxiMBP8Gz8upQPSg@mail.gmail.com>
Message-ID: <51657E07.9020905@uni-muenster.de>

Saman,

Your time is not ordered, which the error message suggest (but the
documentation not clearly states) so I tried:

o = order(data$time)
x = STSDF(pts,data$time[o], data[o,], ind[o,])

but this results in another error, which indicated that data$time has
duplicate values, which is not supposed to be the case.

I tried then to add x and y to data, but

match(data$location, cancer.loc$locaation)

gives NA values, so not all locations can be matched.

data$x = cancer.loc[m, "x"]
data$y = cancer.loc[m, "y"]

gives you the long table with coordinates (some of them missing, due to
mismatching names);

x = stConstruct(na.omit(data), c("x", "y") ,"time")
x2 = as(x, "STSDF")

Thanks for providing a small reproducible example.

On 04/10/2013 10:32 AM, Saman Monfared wrote:
> Hi,
> I try to  construct    a  stsdf  st class. But I dont know how.
> I attached my data and cod. my data  are cancer rate  incidence.
> Best,
> 
> Saman.
> 
> 
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From basille at ase-research.org  Wed Apr 10 17:57:42 2013
From: basille at ase-research.org (Mathieu Basille)
Date: Wed, 10 Apr 2013 11:57:42 -0400
Subject: [R-sig-Geo] Help with ENFA in R
In-Reply-To: <1365604778155-7583272.post@n2.nabble.com>
References: <1365511769098-7583243.post@n2.nabble.com>
	<51644E82.5080703@ase-research.org>
	<1365537093429-7583258.post@n2.nabble.com>
	<51648FCC.5070809@ase-research.org>
	<1365580744207-7583264.post@n2.nabble.com>
	<51651D48.1080103@oncfs.gouv.fr>
	<1365588123956-7583270.post@n2.nabble.com>
	<1365604778155-7583272.post@n2.nabble.com>
Message-ID: <51658BF6.7010702@ase-research.org>

Jonathan,

Again, this is no more an adehabitat question: the whole idea of the new 
series of packages (including adehabitatHS) is to rely on spatial R classes 
that are available with sp. All adehabitat functions to handle maps (such 
as as.kasc) have thus been removed.

This said, this should help:

library(maptools)
x <- readAsciiGrid(system.file("grids/test.ag", package="maptools")[1])
class(x at data)
head(na.omit(x at data))
x at data <- cbind(x at data, x at data * 2)
head(na.omit(x at data))

As you can see, the data attributes are stored in a data frame. One 
possibility for you is then to import all your variables using 
readAsciiGrid, and then cbind all @data into one (assuming all your rasters 
have the same resolution and extent). There might be other solutions as well...

Lastly, read.csv is fine to import the point data. You'll then need to 
convert the data frame to SpatialPoints using e.g. the function 
'SpatialPoints'.

Mathieu.


Le 04/10/2013 10:39 AM, JonathanAronson a ?crit :
> perhaps I can clarify my question a lit bit further:
>
> With the adehabitat package I used the function as.kasc to create a single
> data frame with my 15 variables as Ive shown below:
>
> map<- as.kasc(list(bio_01 = var1, bio_12 = var2, Aridity = var3, altitude =
> var4, unpalatable = var5, thicket = var6, succulent = var7, shrubland =
> var8, rainforest = var9, mosaic = var10, mopane = var11, misavanna = var12,
> hydro = var13, fynbos = var14, desert = var15))
>
> However, in the adehabitatHS, what is the equivalent function to use to
> create the data frame which is equivalent to the lynxjura$map spatial pixel
> data frame? There is no as.kasc function. I have used the readAsciiGrid
> function in Maptools but I can only do that individually for each variable.
> How then can I combine these into a single data frame? I have thought of
> using the stack() function in the raster package.
>
> I am really stuck here
> Thanks to anyone who can help
> Jonathan
>
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Help-with-ENFA-in-R-tp7583243p7583272.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 

~$ whoami
Mathieu Basille, PhD

~$ locate --details
University of Florida \\
Fort Lauderdale Research and Education Center
(+1) 954-577-6314
http://ase-research.org/basille

~$ fortune
? Le tout est de tout dire, et je manque de mots
Et je manque de temps, et je manque d'audace. ?
  -- Paul ?luard


From milansharma2012 at yahoo.com  Wed Apr 10 21:04:59 2013
From: milansharma2012 at yahoo.com (Milan Sharma)
Date: Wed, 10 Apr 2013 12:04:59 -0700 (PDT)
Subject: [R-sig-Geo] GWR question
Message-ID: <1365620699.64234.YahooMailNeo@web162106.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130410/f4ea5cd7/attachment.pl>

From zacksteel at gmail.com  Wed Apr 10 21:23:01 2013
From: zacksteel at gmail.com (zacksteel)
Date: Wed, 10 Apr 2013 12:23:01 -0700 (PDT)
Subject: [R-sig-Geo] Error running gbm.step in dismo package
In-Reply-To: <4D40A0E4.7080308@amnh.org>
References: <4D40A0E4.7080308@amnh.org>
Message-ID: <1365621781321-7583277.post@n2.nabble.com>

I'm having similar issues with my gbm.step models as Ned described in his
original post, but I see that no one posted a solution. Does anyone have any
thoughts on how to deal with this? I'm especially interested in what the
following error means:

"In cor(y_i, u_i) : the standard deviation is zero"

Thanks



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Error-running-gbm-step-in-dismo-package-tp5964448p7583277.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From ferra.xu at yahoo.com  Thu Apr 11 00:24:44 2013
From: ferra.xu at yahoo.com (Ferra Xu)
Date: Wed, 10 Apr 2013 15:24:44 -0700 (PDT)
Subject: [R-sig-Geo] Gibbs Point Process
Message-ID: <1365632684.94657.YahooMailNeo@web162203.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130410/16c03f9d/attachment.pl>

From Adrian.Baddeley at csiro.au  Thu Apr 11 03:49:14 2013
From: Adrian.Baddeley at csiro.au (Adrian.Baddeley at csiro.au)
Date: Thu, 11 Apr 2013 09:49:14 +0800
Subject: [R-sig-Geo] Simulating a Gibbs Marked point process
In-Reply-To: <51652D57.3000908@auckland.ac.nz>
References: <1365561018.5738.YahooMailNeo@web162202.mail.bf1.yahoo.com>,
	<51652D57.3000908@auckland.ac.nz>
Message-ID: <57DC18C299094D4299F837570C5DF1C501318D79D968@EXWA-MBX01.nexus.csiro.au>

As Rolf says below, the function 'rmh' in spatstat generates *simulated realisations* of a Gibbs point process.
It does not *maximise* the probability density of the Gibbs point process. 

Examples of the use of rmh are provided in the help files for rmh.default and rmh.ppm, and in the workshop notes <www.csiro.au/resources/pf16h.html>

Currently there is no command in spatstat for maximising the Gibbs point process probability density (for example by Simulated Annealing, or Steepest Ascent).

However it is easy to implement a simple form of Simulated Annealing for a specific model. If f(x) is the probability density of the model, then for each 'temperature' T > 0 you have to figure out the parameters of the modified model with probability density f_T(x) proportional to f(x)^(1/T). For example for the  stationary Strauss process with parameters beta and gamma, the modified parameters are beta_T = beta^(1/T) and gamma = gamma^(1/T). Now suppose your annealing schedule is to run at temperature T1 for n1 iterations, then temperature T2 < T1 for n2 iterations, etc. To do the first run, call 'rmh' with the appropriate parameter values for the model, with nrep=n1. Save the resulting point pattern as X1. To do the second run, call 'rmh' again with the new parameter values appropriate to temperature T2, and using the previous state as the initial condition: start=list(x.start=X1). And so on.

An important question is whether this algorithm will converge to a unique solution. There could be many point patterns which are maximal for the probability density. For example if the model is the stationary Strauss process then the limit of the probability density as T -> 0 is the density of a Hard Core process, which has many maximal configurations. If the model is non-stationary, then it may have a unique maximal configuration, but that cannot be assumed in general.

Prof Adrian Baddeley FAA
School of Earth & Environment, University of Western Australia, 35 Stirling Hwy, Crawley WA 6009, Australia
                                            - and -
CSIRO Mathematics, Informatics & Statistics, Leeuwin Centre, 65 Brockway Rd, Floreat WA 6014, Australia
skype adrian.baddeley
________________________________________
From: Rolf Turner [r.turner at auckland.ac.nz]
Sent: Wednesday, 10 April 2013 5:13 PM
To: Ferra Xu
Cc: r-sig-geo at r-project.org; Baddeley, Adrian (CMIS, Floreat)
Subject: Re: [R-sig-Geo] Simulating a Gibbs Marked point process

On 04/10/2013 02:30 PM, Ferra Xu wrote:
> Hi everybody
>
> I want to simulate a pattern of points based on maximization of Gibbs marked point process density function by MCMC methods using R. I already know that rmh function in spatstat will do that, but I couldn't find any good example code for that... I don't know how should I determine the objective function that I want to be maximized in each iteration...
I don't really understand what you want to do.  The rmh() [random
Metropolis Hastings]
function does not proceed by maximizing the density function of the
(Gibbs) process.  It
uses a Markov chain (whose "states" are point patterns), the
Metropolis-Hastings algorithm,
and the *conditional intensity* function of the process, to effect the
simulation.  The transitions
between states are governed by transition probabilities constructed so
that the *steady
state* distribution of the Markov chain is the distribution of the
desired process.  There is
no maximization of anything --- at least not in any obvious way, as far
as I can see.

What do you mean by "I couldn't find any good example code"?  There are
many examples
of code *using* the rmh() function in the online help.  If you want to
see the code of rmh()
--- well, R and all of its contributed packages are open source.
Download the spatstat source
package and have a look! (Be warned --- the heavy lifting is done in C,
and the code is pretty
subtle and obscure.  By my standards.)

     cheers,

         Rolf Turner


From alobolistas at gmail.com  Thu Apr 11 10:37:18 2013
From: alobolistas at gmail.com (Agustin Lobo)
Date: Thu, 11 Apr 2013 10:37:18 +0200
Subject: [R-sig-Geo] rgdal in MAc OSX with R 3.0
In-Reply-To: <alpine.LRH.2.03.1304092048030.5969@reclus.nhh.no>
References: <CAG4NReLBXuUZ=ySsWVvqOPgAu+cDuEbMxbQU=O8qoaykQngM1g@mail.gmail.com>
	<alpine.LRH.2.03.1304092048030.5969@reclus.nhh.no>
Message-ID: <CAG4NReJpcM+OpTz-KkTCYSOqS6aC2H6LDoeTKqk0Y-S+KwWkWA@mail.gmail.com>

No problem, it's normal that a change to 3.0 has some small inconveniences
largely balanced by the advantages of advancing to better versions.
Thanks to Simon for his efforts.

Agus

On Tue, Apr 9, 2013 at 8:52 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> See:
>
> https://stat.ethz.ch/pipermail/r-sig-geo/2013-April/017934.html
>
> for the first posting to ask about rgdal, rgeos, etc. on OSX for R 3.0.0.
> The rgeos package is now available for this platform (the R offering for OSX
> has changed a good deal for R 3.0.*), but rgdal is as yet not available.
>
> If you would like to help Simon Urbanek, I'm sure he would be grateful for
> assistance, but there is no guarantee that things will "just work"; "just
> working" means a small number of people doing a lot of work in their own
> time. Simon has already made a major contribution, so for now, patience is
> appropriate, he is aware of the issue.
>
> Roger
>
>
> On Tue, 9 Apr 2013, Agustin Lobo wrote:
>
>> HI,
>>
>> After a long time of not having problems with installing rgdal
>> on Mac OSX using
>>
>> setRepositories(ind=1:2)
>> install.packages("rgdal")
>>
>> (and even perhaps using the gui in RStudio?)
>>
>> I get now
>> package ?rgdal? is not available (for R version 3.0.0)
>>
>> Does anybody know if the package will be built for MAc again or do
>> we have to on and compile on our own?
>>
>> Thanks
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> --
> Roger Bivand
> Department of Economics, NHH Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From paul.feichtinger at tum.de  Thu Apr 11 16:31:26 2013
From: paul.feichtinger at tum.de (Feichtinger, Paul)
Date: Thu, 11 Apr 2013 14:31:26 +0000
Subject: [R-sig-Geo] nb2blocknb
Message-ID: <CCD7DE7E72D4B341896DB1CE20AEB805373DBC1F@BADWLRZ-SWMBX11.ads.mwn.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130411/b00d30ee/attachment.pl>

From jagaronson at gmail.com  Thu Apr 11 17:30:00 2013
From: jagaronson at gmail.com (JonathanAronson)
Date: Thu, 11 Apr 2013 08:30:00 -0700 (PDT)
Subject: [R-sig-Geo] Help with ENFA in R
In-Reply-To: <51658BF6.7010702@ase-research.org>
References: <1365511769098-7583243.post@n2.nabble.com>
	<51644E82.5080703@ase-research.org>
	<1365537093429-7583258.post@n2.nabble.com>
	<51648FCC.5070809@ase-research.org>
	<1365580744207-7583264.post@n2.nabble.com>
	<51651D48.1080103@oncfs.gouv.fr>
	<1365588123956-7583270.post@n2.nabble.com>
	<1365604778155-7583272.post@n2.nabble.com>
	<51658BF6.7010702@ase-research.org>
Message-ID: <1365694200318-7583282.post@n2.nabble.com>

Hi Mathieu

Thank you greatly, I have been using your advice and it seems to be working.
I used readAsciiGrid to import my 15 variables and then cbind to create the
new data frame. The result is below:

> join <- cbind(x at data, y at data, a at data, b at data, c at data, d at data, e at data,
> f at data, g at data, h at data, i at data, j at data, k at data, l at data, m at data)
> head(na.omit(join))
    bio_01.asc bio_12.asc Aridity.asc altitude.asc unpalatable.asc
thicket.asc
385       9626       5698        6272     7.007191        5.282318   
3.979096
386       9611       5432        5951     7.903753        5.279835   
3.980666
387       9631       5109        5601     5.723457        5.277520   
3.982328
388       9623       4859        5474     6.031349        5.275373   
3.984080
389       9634       4694        5210     3.238761        5.273394   
3.985923
641       9617       5939        6507     7.019991        5.352698   
3.956286
    succulent.asc shrubland.asc rainforest.asc mosaic.asc mopane.asc
misavanna.asc
385      105.5797     1.1239479       9.631459   4.517803   18.87709     
3.094614
386      105.5253     1.1543059       9.638020   4.519337   18.87111     
3.095095
387      105.4725     1.1239479       9.644965   4.521014   18.86544     
3.095683
388      105.4215     1.1007079       9.652295   4.522834   18.86010     
3.096377
389      105.3720     1.0860595       9.660006   4.524796   18.85507     
3.097176
641      106.6615     0.6861283       9.535002   4.500543   19.01172     
3.083889
    hydro.asc fynbos.asc desert.asc
385  6.274230   107.9704   1.218094
386  6.290221   107.9120   1.152849
387  6.306502   107.8552   1.095933
388  6.323067   107.8001   1.051082
389  6.339908   107.7465   1.022137
641  5.968595   109.1287   1.152849

I then loaded my locality data and converted to SpatialPoints as follows:

locs<- read.csv("Species_Localities/R.blasii.csv", header=T)
library(sp)
xy.sp = SpatialPoints(locs)
summary(xy.sp)
class(xy.sp)

I think now the next step in the ENFA but Im getting a little stuck. Im not
sure what "slot" is in the lynxjura example. Id like to prepare the data for
enfa and run the PCA. could you please provide some help with this?

Thank you so so much
Jonathan




--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Help-with-ENFA-in-R-tp7583243p7583282.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From samanmonfared1 at gmail.com  Thu Apr 11 18:45:33 2013
From: samanmonfared1 at gmail.com (Saman Monfared)
Date: Thu, 11 Apr 2013 21:15:33 +0430
Subject: [R-sig-Geo] All st-gamma values are 0
Message-ID: <CAOytA4b4+btUAPeaUv9srZr6vkhx5yeF3oeAt1bE+5fqph0raQ@mail.gmail.com>

Hi,
I try to fit a st variogram for my data.The values of variogram$gamma
in all st lags are 0. I don't no why this occurs!

Data is attached.

my program is:
rm(list=ls())
library(gstat)
library(spacetime)
library(maptools)
library(RColorBrewer)
library(maps)
library(lattice)
data<-read.table("cancer.rate.txt",header=TRUE)
cancer.loc<-read.table("bladder.loc.txt",header=TRUE)
pts<-cbind(cancer.loc$x,cancer.loc$y)
pts = SpatialPoints(pts)
data$time = ISOdate(data$year, data$mounth, data$day)
ind<-as.matrix(cbind(data$indexs,data$indext))
xx = STSDF(pts,data$time,data,ind)
vv<-variogram(Rate~1,xx,width=200000,cutoff=3000000,tlags=1:8)
plot(vv,map=T)
wireframe(gamma~spacelag+timelag,vv,col="red",drape=T,outer =T,
scales=list(arrows=FALSE))
separableModel<-vgmST("separable",space=vgm(.05,"Gau",10000, 0.1),
time =vgm(.02,"Gau", 100, 0),sill=.2,nugget=0)
v.f<-fit.StVariogram(vv,separableModel,method="L-BFGS-B")
v.f
wireframe(model~spacelag+timelag,variogramSurface(v.f,vv),drape=T,
aspect = c(1,1),panel.aspect =1,scales=list(arrows=F))
plot(vv,v.f)
grd<-read.table("farsgrid.txt",header=T)
grd = SpatialPixels(SpatialPoints(cbind(grd$x,grd$y)))
plot(grd)
n =3
library(xts)
tgrd = seq(max(index(xx)+31622400*2),max(index(xx)+3*31622400),length=2)
pred.grd = STF(grd, tgrd)
plot(pred.grd )
cancer.ST = krigeST(Rate~1,xx,pred.grd ,separableModel)
stplot(cancer.ST)





-- 
Saman Monfared
Msc, Department of Statistics, Shiraz University,
Shiraz 71454, Iran
Email: Samanmonfared1 at gmail.com

Tel: +98 917 5305167
-------------- next part --------------
A non-text attachment was scrubbed...
Name: New folder.rar
Type: application/rar
Size: 3133 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130411/9c26b059/attachment.bin>

From d.gutierrez.posada at gmail.com  Thu Apr 11 20:25:55 2013
From: d.gutierrez.posada at gmail.com (=?ISO-8859-1?Q?Diana_Guti=E9rrez?=)
Date: Thu, 11 Apr 2013 20:25:55 +0200
Subject: [R-sig-Geo] Doubt about LMZ.F3GWR.test command in spgwr
Message-ID: <CAHoVOwpBjPc5BxZw1KFVpS0iWZoN2nvDDENjuWXqaDMs3kBUGQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130411/de80a2d1/attachment.pl>

From Roger.Bivand at nhh.no  Thu Apr 11 22:29:12 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 11 Apr 2013 22:29:12 +0200
Subject: [R-sig-Geo] Doubt about LMZ.F3GWR.test command in spgwr
In-Reply-To: <CAHoVOwpBjPc5BxZw1KFVpS0iWZoN2nvDDENjuWXqaDMs3kBUGQ@mail.gmail.com>
References: <CAHoVOwpBjPc5BxZw1KFVpS0iWZoN2nvDDENjuWXqaDMs3kBUGQ@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1304112215280.8480@reclus.nhh.no>

As you should be aware, use of GWR in any circumstances is very insecure, 
and no statistical tests should be trusted. As Paez et al. (2011) 
demonstrate, GWR finds patterned local coefficients in completely random 
data. GWR proponents claim that the local coefficient standard errors are 
then large, but since users happily map and interpret local coefficient 
patterns, the method should be retired until it can definitely be shown to 
perform as advertised.

On Thu, 11 Apr 2013, Diana Guti?rrez wrote:

> Hi.
>
> I'm using GWR method in my research through the spgwr package (by the way,
> thanks to the programmers), and I've already obtained some results; but I
> would like to know why sometimes when I run the LMZ.F3GWR.test command, it
> shows me the following error message:
>
> "Error in  solve.default(t(x) %*% diag(wj) %*% x)
> system is computationally singular: reciprocal condition number =
> 1.81708e-18"
>
> As far as I know, this might be related to the B matrix used in the paper
> by Leung et al (2000), but I don't understand what's happening since I
> obtained the results of the test for certain regressions. I'm using a
> sample of 803 cases and thirteen variables (including the dependent one).
> In the "wrong" regression I use the default gaussian function for the
> weights (fixed kernel) and the AIC for the bandwidth, while I'd got fine
> results for combinations of bi-square function and CV score, and for
> gaussian function and CV score. Does it has to do with choosing the AIC
> (actually, I've tried a bi-square function with AIC, but I couldn't even
> obtain the bandwidth from it)? Does it depends on the value of the
> bandwidth (maybe too small)? or may it be solved in anyway?

As you say, the performance varies depending on the chosen kernel and 
bandwidth - these define the wj vector of weights, so if all very small, 
may erase any variability in the covariances of the x variables. This is 
to be expected, and illustrates how fallible the method can be. The 
functions in this package as far as we know implement the methods 
accurately, so the problem is in the methods not protecting the user from 
arbitrary choices.

Hope this clarifies,

Roger

>
> Thank you beforehand for any comment.
>
> Best regards,
>
> Diana.
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From ross.dwyer at uq.edu.au  Fri Apr 12 06:48:20 2013
From: ross.dwyer at uq.edu.au (Ross Dwyer)
Date: Fri, 12 Apr 2013 04:48:20 +0000
Subject: [R-sig-Geo] New version of plotGoogleMaps ( now plot STDIF
	and	STFDF data)
In-Reply-To: <CAPSaU-_RMFfw_0+=-gTFrbKH6CU-LFtako7q_TzeXbqAPz=ONg@mail.gmail.com>
References: <CAPSaU-_RMFfw_0+=-gTFrbKH6CU-LFtako7q_TzeXbqAPz=ONg@mail.gmail.com>
Message-ID: <84B4751733167E41A8156E63A69C1C3A139379@uqexmdb3.soe.uq.edu.au>

Hi Milan,

The new package looks great. Any plans to generate animations from spacetime objects on a Google platform such as Maps or Earth?

I would love to see something similar to Google's Public Data Explorer/google motion charts become available within an R package (see below links)...

http://www.google.com.au/publicdata/explore?ds=d5bncppjof8f9_&ctype=b&strail=false&nselm=s&met_x=sp_dyn_le00_in&scale_x=lin&ind_x=false&met_y=sp_dyn_tfrt_in&scale_y=lin&ind_y=false&met_s=sp_pop_totl&scale_s=lin&ind_s=false&dimp_c=country:region&ifdim=country&hl=en&dl=en&iconSize=0.5&uniSize=0.035#!ctype=m&strail=false&bcs=d&nselm=s&met_s=sp_pop_totl&scale_s=lin&ind_s=false&dimp_c=country:region&ifdim=country&pit=1302530400000&hl=en_US&dl=en&ind=false

http://www.google.com.au/publicdata/explore?ds=ml9s8a132hlg_&ctype=m&strail=false&nselm=s&met_s=minimum_wage&fdim_s=currency:eur&scale_s=log&ind_s=false&met_c=minimum_wage&fdim_c=currency:eur&idim=country:lu&ifdim=country&pit=1293840000000&hl=en&dl=en&iconSize=0.5&uniSize=0.035&yMax=58.5924685&xMin=-8.2391222&xMax=35.43979471&mapType=t&yMin=35.902422#!ctype=m&strail=false&bcs=d&nselm=s&met_s=minimum_wage&fdim_s=currency:eur&scale_s=log&ind_s=false&idim=country:lu&ifdim=country&hl=en_US&dl=en&ind=false


Cheers, Ross

-----Original Message-----
From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Milan Kilibarda
Sent: Friday, 5 April 2013 6:48 PM
To: r-sig-geo at r-project.org
Subject: [R-sig-Geo] New version of plotGoogleMaps ( now plot STDIF and STFDF data)

Dear all,


I have just uploaded to CRAN a new version plotGoogleMaps.


Significant changes in plotGoogleMaps are listed below:

* Now plotGoogleMaps plot spacetime STDIF and STFDF data;

See example in vignette.

* Some bugs in plotting pie charts over Google Maps are repaired - function segmentGoogleMaps;

* Functions provide data to be plotted in similar way like spplot maps; pieSP, vectorsSP, colors like in plotGoogleMaps (PolyCol) and similar are now in package.

  Example:

# plotGoogleMaps plot

library(plotGoogleMaps)

data(meuse)
coordinates(meuse)<-~x+y # convert to SPDF
proj4string(meuse) <- CRS('+init=epsg:28992')

m<-segmentGoogleMaps(meuse, zcol=c('zinc','dist.m'), mapTypeId='ROADMAP', filename='myMap4.htm', colPalette=c('#E41A1C','#377EB8'), strokeColor='black')

# spplot

pies<-pieSP(meuse,zcol=c('zinc','dist.m'), max.radius=100)

pies$pie2=rep(1:2,155)

spplot(pies, 'pie2', col.regions=c('#E41A1C','#377EB8') )

# plot

cols=PolyCol(pies$pie2,colPalette=c('#E41A1C','#377EB8') )$cols

plot(as(pies,'SpatialPolygons'), col=cols)

#plotKML

library(plotKML)

plotKML(pies, colour='pie2', colour_scale=cols)


All major changes are documented in the vignette.

Happy testing,


Milan Kilibarda

University of Belgrade,
Faculty of Civil Engineering,
Department of Geodesy and Geoinformatics,
Address: Bulevar kralja Aleksandra 73  11000 Belgrade, Serbia,
Mail:  kili at grf.bg.ac.rs

tel:+381 11 3218516

	[[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From milan.kili11 at gmail.com  Fri Apr 12 07:34:15 2013
From: milan.kili11 at gmail.com (Milan Kilibarda)
Date: Fri, 12 Apr 2013 07:34:15 +0200
Subject: [R-sig-Geo] New version of plotGoogleMaps ( now plot STDIF and
 STFDF data)
In-Reply-To: <84B4751733167E41A8156E63A69C1C3A139379@uqexmdb3.soe.uq.edu.au>
References: <CAPSaU-_RMFfw_0+=-gTFrbKH6CU-LFtako7q_TzeXbqAPz=ONg@mail.gmail.com>
	<84B4751733167E41A8156E63A69C1C3A139379@uqexmdb3.soe.uq.edu.au>
Message-ID: <CAPSaU-8XpzJFQ6RqXGMP_owBg++PKFZkbGHR3QTY4K9rvemJVQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130412/1b9abcde/attachment.pl>

From rossahmed at googlemail.com  Fri Apr 12 11:52:39 2013
From: rossahmed at googlemail.com (Ross Ahmed)
Date: Fri, 12 Apr 2013 10:52:39 +0100
Subject: [R-sig-Geo] Error in function (classes, fdef, mtable)
Message-ID: <CD8D97F7.4739%rossahmed@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130412/eee2477e/attachment.pl>

From Roger.Bivand at nhh.no  Fri Apr 12 12:07:18 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 12 Apr 2013 12:07:18 +0200
Subject: [R-sig-Geo] Error in function (classes, fdef, mtable)
In-Reply-To: <CD8D97F7.4739%rossahmed@gmail.com>
References: <CD8D97F7.4739%rossahmed@gmail.com>
Message-ID: <alpine.LRH.2.03.1304121202500.16633@reclus.nhh.no>

On Fri, 12 Apr 2013, Ross Ahmed wrote:

> Hi all
>
> I?m trying to overlay a set of polygons over another set of polygons and
> calculate area of overlap. However, I?m getting the error:
>
> "Error in function (classes, fdef, mtable)  :  unable to find an inherited
> method for function ?is.projected? for signature ?"NULL???
>
> What am I doing wrong here? I realise this is likely to be a question
> regarding the fundamentals of coordinate reference systems, but after hours
> of googling, I cannot find a fix. My code looks like this:
>
>
> library(raster); library(sp); library(maptools); library(plyr);
> library(rgeos); library(rgdal)
>
> # make raster and convert to polygons
> sectors <- raster(ext=extent(8, 9, 12, 13), ncol=5, nrow=5, crs=NA)
> sectorsPoly <- rasterToPolygons(sectors)
> sectorsPoly at data$value <- 1:25
>
> # import shapefiles
> setwd(system.file("shapes", package="maptools"))
> columbus <- readShapeSpatial("columbus.shp")
>
> # assign coordinate system
> proj4string(sectorsPoly) <- CRS("+proj=longlat +datum=WGS84 +ellps=WGS84
> +towgs84=0,0,0")
> proj4string(columbus) <- CRS("+proj=longlat +datum=WGS84 +ellps=WGS84
> +towgs84=0,0,0")
>
> # project
> sectorsPoly <- spTransform(sectorsPoly, CRS("+init=epsg:26392
> +datum=WGS84"))
> columbus <- spTransform(columbus, CRS("+init=epsg:26392 +datum=WGS84"))
>
> # calculate proportion of sectorsPoly that is overlapped by columbus
> llply(1:25, function(x) gArea(gIntersection(sectorsPoly, columbus[x,],
> byid=TRUE), byid=TRUE)/gArea(sectorsPoly[x,]))

You are indexing the wrong object - not columbus but sectorsPoly should 
be indexed 1:25:

llply(1:25, function(x) gArea(gIntersection(sectorsPoly[x,],
   columbus, byid=TRUE), byid=TRUE)/gArea(sectorsPoly[x,]))

works. Thanks for a reproducible example! Note that we do not know the CRS 
of columbus, I think the units are some multiple of miles or km, and that 
it is projected in an unknown projection.

Hope this helps,

Roger

>
>
> Thanks
> Ross
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From encharbel at gmail.com  Fri Apr 12 12:41:18 2013
From: encharbel at gmail.com (Charbel Eliane)
Date: Fri, 12 Apr 2013 13:41:18 +0300
Subject: [R-sig-Geo] help- raster overlap (Charbel Eliane)
In-Reply-To: <CANtt_hxYNugDcrTVNzd5Pr75oYrD4xyJyWyn_WRAMV0CniyDOA@mail.gmail.com>
References: <mailman.9.1365415203.6364.r-sig-geo@r-project.org>
	<0DBECC7FEDC4614290837899A2C4B01301908C@EXMBX2.imr.no>
	<CANtt_hxYNugDcrTVNzd5Pr75oYrD4xyJyWyn_WRAMV0CniyDOA@mail.gmail.com>
Message-ID: <CA+XydTSSJeSkrBhBDePnT4yevgS6OpBVgystTmUnm7jqTYWFSQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130412/9e64a6f9/attachment.pl>

From valentina.lauria at nuigalway.ie  Fri Apr 12 16:06:18 2013
From: valentina.lauria at nuigalway.ie (Lauria, Valentina)
Date: Fri, 12 Apr 2013 14:06:18 +0000
Subject: [R-sig-Geo] produce a map in ARCGIS from a GAM output
Message-ID: <B11DE93D7F439D4BA1E942572BA75030739D36D5@UDSMBX01.uds.nuigalway.ie>


Hi All,

I am trying to create a map in GIS of the habitat prediction of lobster using environmental predictors. I am attaching here a brief example of my script and data.

I am OK for the GAM fitting and evaluation (residuals plot etc) but I am having problems to create a prediction map (raster of my GAM output) in GIS. In particular when I run predict.gam I get a set of values which I guess are the probability of lobster densities in function of my environmental predictors, but I do not know how to geo-reference these points. I know that maybe the raster package can be useful as I have to extrapolate my predictions for a larger area (where we have no data). Any help and suggestion is very much appreciated.

Best Regards,
Valentina

Dr. Valentina Lauria
Postdoctoral researcher
Room 118, Martin Ryan Institute
Department of Earth and Ocean Sciences
National University of Ireland, Galway
Ireland

www.nephrops.eu

________________________________________
From: b.rowlingson at gmail.com [b.rowlingson at gmail.com] on behalf of Barry Rowlingson [b.rowlingson at lancaster.ac.uk]
Sent: 12 April 2013 14:15
To: Lauria, Valentina
Cc: r-help at R-project.org
Subject: Re: [R] produce a map in ARCGIS from a GAM output

On Fri, Apr 12, 2013 at 10:37 AM, Lauria, Valentina
<valentina.lauria at nuigalway.ie> wrote:
> Hi,
>
> I am trying to predict the habitat suitability of lobster with GAMs. I need to produce a map in ArcGis of the predicted densities. I did some search and the function predict.gam seems to do the job.
>
> Is this the right way to do it? when you apply the function you get the predicted values (different from your input data points) but I do not understand what is the procedure with the spatial coordinates, I mean what lat and long have the new points? Can I use the same ones of my observations?

 I suspect you'll get a better response if you:

 a) ask on R-sig-geo, the mailing list for all things R and mappy
 b) try and ask with a reproducible example - it doesn't have to be
your data, but something similar, and small, and that we can run to
get a better idea of your problem. Show us how you are running
predict.gam, at least, and what your data looks like.

To get data from R into ArcGIS you probably want to either use the
raster package to create a grid of values, or the rgdal package to
create a shapefile of point locations and estimates. Exactly how you
get that from your predict.gam results is a bit guesswork until we
know a bit more about how you are running predict.gam....

Barry
-------------- next part --------------
A non-text attachment was scrubbed...
Name: gam_habitat_mapping_inshore.r
Type: application/octet-stream
Size: 1407 bytes
Desc: gam_habitat_mapping_inshore.r
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130412/def09d6a/attachment.obj>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: inshore_mapping.csv
Type: application/vnd.ms-excel
Size: 864 bytes
Desc: inshore_mapping.csv
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130412/def09d6a/attachment.xlb>

From Andrew.Duff at dfw.wa.gov  Fri Apr 12 20:29:13 2013
From: Andrew.Duff at dfw.wa.gov (Duff, Andrew A (DFW))
Date: Fri, 12 Apr 2013 18:29:13 +0000
Subject: [R-sig-Geo] 3D KDE to Triangular Irregular Network
Message-ID: <F69351571CBC1942904F278D3B8FFB170717CCDE@WAXMXOLYMB026.WAX.wa.lcl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130412/4446767d/attachment.pl>

From mdsumner at gmail.com  Fri Apr 12 23:05:36 2013
From: mdsumner at gmail.com (Michael Sumner)
Date: Sat, 13 Apr 2013 07:05:36 +1000
Subject: [R-sig-Geo] 3D KDE to Triangular Irregular Network
In-Reply-To: <F69351571CBC1942904F278D3B8FFB170717CCDE@WAXMXOLYMB026.WAX.wa.lcl>
References: <F69351571CBC1942904F278D3B8FFB170717CCDE@WAXMXOLYMB026.WAX.wa.lcl>
Message-ID: <CAAcGz99rdU=fXPiiiC=9+mPRs4TEVkFwDJbJLrMtPn=zmj33mw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130413/7df4081d/attachment.pl>

From phytophthorasb at yahoo.com  Fri Apr 12 23:29:36 2013
From: phytophthorasb at yahoo.com (Empty Empty)
Date: Fri, 12 Apr 2013 14:29:36 -0700 (PDT)
Subject: [R-sig-Geo] Memory problems with dnearneigh in spdep -- related
	data questions
In-Reply-To: <alpine.LRH.2.03.1304100849590.8232@reclus.nhh.no>
References: <1362941280.23258.YahooMailNeo@web142503.mail.bf1.yahoo.com>
	<1365354249.76493.YahooMailNeo@web142505.mail.bf1.yahoo.com>
	<alpine.LRH.2.03.1304072049050.24741@reclus.nhh.no>
	<1365544586.27248.YahooMailNeo@web142506.mail.bf1.yahoo.com>
	<alpine.LRH.2.03.1304100849590.8232@reclus.nhh.no>
Message-ID: <1365802176.23889.YahooMailNeo@web142506.mail.bf1.yahoo.com>

Thanks again, Roger. I will work on the rasters and learning the focal method for this. 
In the interest of learning for beyond this particular analysis, I'm a bit confused about what I'm seeing in the data summaries and how to understand it. I realize understanding one's data is extremely fundamental, sorry.

The data I was using was from a points file generated in ArcGIS. I have another older Arc-generated points file of the same data that is not projected and proj4string NA, but everything else is the same
When I took an older raster of the data that I have and converted it to points in R (package: raster),
I get the following summary

Object of class SpatialPointsDataFrame
Coordinates:
??????? min????? max
x -17.52090 51.40407
y -34.82918 37.53746
Is projected: NA 
proj4string : [NA]
Number of points: 36820887
Data attributes:
???? Min.?? 1st Qu.??? Median????? Mean?? 3rd Qu.????? Max. 
???? 0.00????? 0.28????? 2.57???? 26.43???? 10.51 103100.00 

So it is the same, except it isn't projected and it doesn't have that entry, NA's. Where the ones that come from ArcGIS have a very high number of NA's (all but 1 million of the points - 35m out of 36m).
Again it's all from a 1k raster.

1) Any ideas why the difference in NA's and if this might be part of my problem? And in general, what would one check for in the data to avoid this problem (if it is a problem)?
2) In the projected data set, it clearly says units=m (inside the proj4string entry), so if I do a distance threshold can I assume it is calculating in meters? If it isn't projected, is the default then lat lon and kilometers? In general, if I'm looking at a summary of data, how do I know in what units it is going to be interpreting a distance threshold (or something similar for any other function)?

Some weeks ago, I successfully ran the G* with dnearneigh on a subset of the data - just Ethiopia (the points file was generated from ArcGIS). The distance threshold I used was 30 (honestly I was just trying to see if it would run, there was no theoretical reason for 30). The output made sense and was similar to what my colleague got in ArcGIS for Ethiopia.

Summary of data: 
Object of class SpatialPointsDataFrame
Coordinates:
??????????????? min???? max
coords.x1 -162966.9 1492490
coords.x2? 377203.2 1642482
Is projected: TRUE 
proj4string :
[+proj=utm +zone=37 +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0]
Number of points: 1335221
Data attributes:
??? OBJECTID????????? POINTID??? GRID_CODE?????? 
?Min.?? :????? 1?? Min.?? :0?? Min.?? :??? 0.00? 
?1st Qu.: 333806?? 1st Qu.:0?? 1st Qu.:??? 5.32? 
?Median : 667611?? Median :0?? Median :?? 15.25? 
?Mean?? : 667611?? Mean?? :0?? Mean?? :?? 59.38? 
?3rd Qu.:1001416?? 3rd Qu.:0?? 3rd Qu.:?? 69.10? 
?Max.?? :1335221?? Max.?? :0?? Max.?? :72526.11? 

3) This data set doesn't have the NA's and it worked. Hmmm. But the units are in meters and I used a distance threshold of 30. For 1km data, shouldn't there have been no neighbors at 30m? Why did this work? or was it calculating kilometers instead?

Thanks for any insight,

Juliann



----- Original Message -----
From: Roger Bivand <Roger.Bivand at nhh.no>
To: Empty Empty <phytophthorasb at yahoo.com>
Cc: "r-sig-geo at r-project.org" <r-sig-geo at r-project.org>
Sent: Wednesday, April 10, 2013 12:10 AM
Subject: Re: [R-sig-Geo] Memory problems with dnearneigh in spdep

On Tue, 9 Apr 2013, Empty Empty wrote:

> Thanks so much, Roger, for your suggestions.
> I should have realized it was taking kilometers rather than meters!
> 
> My summary(r) is:
> Object of class SpatialPointsDataFrame
> Coordinates:
> ??????????????? min????? max
> coords.x1 -17.52090 51.40407
> coords.x2 -34.82918 37.53746
> Is projected: TRUE proj4string :
> [+proj=aea +lat_1=20 +lat_2=-23 +lat_0=0 +lon_0=25 +x_0=0 +y_0=0 +ellps=WGS84
> +datum=WGS84 +units=m +no_defs +towgs84=0,0,0]

Given your object summary, you need to check where your data came from. The bounding box is for geographical coordinates, but the declared coordinate reference system is projected in units of metres. So your 9.333 is 9.333m, and no neighbours will be found. The inclusion of NAs in gridded data represented as points is unnecessary, and all points not on land should be dropped before analysis begins.

I do suggest moving to a raster representation, and using focal methods in the raster package to generate the separate components of equation 14.3, p. 263-264 in Gettis & Ord (1996). Using focal methods defines the moving window as a matrix, here 10x10, moved over the raster and circumventing the creation of a weights object - create a new raster layer with \sum{j} w_{ij}(d) x_j values. W_i^* will be a constant, as will \bar{x}^*, and possibly the other starred terms too.

Hope this helps,

Roger

> Number of points: 36820887
> Data attributes:
> ??? POINTID?????????? GRID_CODE??????? ?Min.?? :????? 1??? Min.?? :???? 0.00? ?1st Qu.: 250000??? 1st Qu.:???? 0.28? ?Median : 500000??? Median :???? 2.57? ?Mean?? : 500000??? Mean?? :??? 26.43? ?3rd Qu.: 750000??? 3rd Qu.:??? 10.51? ?Max.?? : 999999??? Max.?? :103104.70? ?NA's?? :35820888? 
> 
> It seems that there are a lot of NA's. (Everything in the square outside the continent's borders should be an NA, so maybe that's a reasonable number). It seemed right when I plotted it earlier.
> 
> I ran it with 9.333 as the distance band (then I was going to try 1.5 next).
> nb<- dnearneigh(r, 0, 9.333)
> 
> It used a constant amount of memory for the first ~90 minutes and then it increased at a constant rate for the next 20 hours
> until it was using virtually all the memory on the server and was stopped.
> Because the administrator had to kill my job, I wasn't able to get session info while the session was open. I'm not sure this is at all helpful, but when I re-started R this is the sessionInfo() :
> R version 2.15.3 (2013-03-01)
> Platform: x86_64-pc-linux-gnu (64-bit)
> 
> locale:
> ?[1] LC_CTYPE=en_US.UTF-8 LC_NUMERIC=C???????? LC_TIME=C??????????? LC_COLLATE=C?????? ?
> ?[5] LC_MONETARY=C??????? LC_MESSAGES=C??????? LC_PAPER=C?????????? LC_NAME=C????????? ?
> ?[9] LC_ADDRESS=C???????? LC_TELEPHONE=C?????? LC_MEASUREMENT=C???? LC_IDENTIFICATION=C 
> attached base packages:
> [1] stats???? graphics? grDevices utils???? datasets? methods?? base??? ?
> 
> loaded via a namespace (and not attached):
> [1] tools_2.15.3
> 
> Thanks,
> Juliann
> 
> 
> ________________________________
> From: Roger Bivand <Roger.Bivand at nhh.no>
> To: Empty Empty <phytophthorasb at yahoo.com> Cc: "r-sig-geo at r-project.org" <r-sig-geo at r-project.org> Sent: Sunday, April 7, 2013 12:15 PM
> Subject: Re: [R-sig-Geo] Memory problems with dnearneigh in spdep
> 
> I do prefer an affiliation, a real name, and a motivation; a
> yahoo or gmail address tells me nothing about what you might be expected
> to know. If I (or a list helper) cannot "place" you, it is much harder to
> know why you are having problems.
> 
> You are also in breach of list rules because you are posting in HTML rather than just plain text. Removing the HTML will shorten your posting radically.
> 
> 
> On Sun, 7 Apr 2013, Empty Empty wrote:
> 
>> Hi,
>> 
>> I'm running into memory problems calculating Gi* using dnearneigh and wonder if someone has any suggestions for either my script or another work around.
>> 
>> I have 1km data for Africa. My colleague calculated the appropriate distance band (9333m) using incremental spatial autocorrelation in ArcGIS but she was only able to run a subset of the data or with the data aggregated to 5km due to memory issues (fixed distance, Euclidean). I tried it in both ArcGIS (memory error after 45 hours) and R (Within 2 hours it was using more than 245GB on the server and then crashed). This is what I used
> 
> Please always include the output of sessionInfo(). Here also include summary(r) output.
> 
>> 
>> library(spdep)
>> 
>> 
>> r<-readOGR(".","r")
>> 
>> coords<-coordinates(r)
> 
> This is not needed.
> 
>> nb9333<- dnearneigh(coords, 0,9333,longlat = F)
> 
> nb9333<- dnearneigh(r, 0, 9333)
> 
> would work, and would not override longlat=. I assume in fact that r is in longlat, and that you would then mean to use a km threshold of 9.333. If I'm right, then the memory usage is being complicated by your including all observations as neighbours of each observation.
> 
> For a 1km grid, a threshold of 9333m means that each of the about 30M gridcells has 100 neighbours (rather strong smoothing). Is the threshold sensibly chosen? The neighbour object will be 30M by 100 by 4, 1.21e+10 (12G); the labels of the neighbour object at least the same; the weights 24G in addition, so nb9333.listw is about 50G. With a more sensible threshold (1.5km?), the sizes of the nb9333.listw weights object become more tractable, maybe about 5G.
> 
> Is any of the data observed on this grid? For localG* (or localG) to make any sense, the variable must be observed at this resolution (satellite imagery?) - if interpolated, all bets are off.
> 
> Finally, the output involves so many multiple comparisons that no statistical inference is possible under normal assumptions - where is the 3.886 coming from - is this an attempt to adjust for multiple comparisons?
> 
> I'm unsure why anyone would do this, as you could use standard filtering techniques on imaging data. The raster package also has functions for computing the local Moran and Geary measures on RasterLayer objects.
> 
> Hope this clarifies,
> 
> Roger
> 
>> nb9333.listw <- nb2listw(include.self(nb9333), style="B")???
>> G9333<-localG(r$GRID_CODE,nb9333.listw)???
>> 
>> 
>> sig3 <- classIntervals(G9333, n=3, style="fixed",
>> ?????????????????????? fixedBreaks=c(min(G9333),-3.886, 3.886, max(G9333)))???? #I dont' think 3.886 is right
>> cs<-c('blue','white','red') # blue = below -3, white = intermediate, red = above 3
>> sigcol <- findColours(sig3, cs)?
>> 
>> png("r.png")
>> plot(r, col=sigcol, axes=TRUE)
>> dev.off()
>> 
>> ??? [[alternative HTML version deleted]]
>> 
>> 
> 
> -- Roger Bivand
> Department of Economics, NHH Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
> 

-- Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From adamhsparks at gmail.com  Sat Apr 13 04:56:16 2013
From: adamhsparks at gmail.com (Adam Sparks)
Date: Sat, 13 Apr 2013 10:56:16 +0800
Subject: [R-sig-Geo] produce a map in ARCGIS from a GAM output
In-Reply-To: <B11DE93D7F439D4BA1E942572BA75030739D36D5@UDSMBX01.uds.nuigalway.ie>
References: <B11DE93D7F439D4BA1E942572BA75030739D36D5@UDSMBX01.uds.nuigalway.ie>
Message-ID: <CAJmQPwF+cjfyTHLTchJp7YRXoptcYCvgs86+CpBQDMF112KLEg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130413/89b9c333/attachment.pl>

From andrewaduff at gmail.com  Sat Apr 13 07:31:52 2013
From: andrewaduff at gmail.com (Andrew Duff)
Date: Fri, 12 Apr 2013 22:31:52 -0700
Subject: [R-sig-Geo] 3D KDE to Triangular Irregular Network
In-Reply-To: <CAAcGz99rdU=fXPiiiC=9+mPRs4TEVkFwDJbJLrMtPn=zmj33mw@mail.gmail.com>
References: <F69351571CBC1942904F278D3B8FFB170717CCDE@WAXMXOLYMB026.WAX.wa.lcl>
	<CAAcGz99rdU=fXPiiiC=9+mPRs4TEVkFwDJbJLrMtPn=zmj33mw@mail.gmail.com>
Message-ID: <000001ce3808$34dd8670$9e989350$@gmail.com>

Thanks a lot Michael that was very helpful.  It seems like you might be able
to make a TIN from one of the contour levels, say 75% or something.  I'm not
really sure how to get to those isosurface vertex coordinates for a given
contour level.  Is that possible in R.

-----Original Message-----
From: r-sig-geo-bounces at r-project.org
[mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Michael Sumner
Sent: Friday, April 12, 2013 2:06 PM
To: Duff, Andrew A (DFW)
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] 3D KDE to Triangular Irregular Network

A TIN cannot represent that data structure, the plot shows multiple surfaces
that wrap around in 3D. (A TIN cannot do that). The plot is made by
"contouring" (isosurfaces) from a 3D array.

You can represent the array in NetCDF, and maybe your GIS can read that.
Otherwise you could do the same as here but create a 2D raster for every
slice in the 3rd dimension and reconstruct over there.

Bare bones using raster to NetCDF:

library(raster)
r <- brick(UD$estimate, xmn = min(UD$eval.points[[1]]), xmx =
max(UD$eval.points[[1]]),
  ymn = min(UD$eval.points[[2]]), ymx = max(UD$eval.points[[2]]))

## Plot each 3D slice
plot(r)

## write to NetCDF, you need ncdf or ncdf4 package writeRaster(r, "file.nc")

See ?writeRaster for further options to add descriptors to the file, and you
will likely need to worry about the orientation when making the raster
object.



On Sat, Apr 13, 2013 at 4:29 AM, Duff, Andrew A (DFW) <
Andrew.Duff at dfw.wa.gov> wrote:

> I am interested in being able to export the results of a 3 dimensional 
> kernel density estimate from the ks package in R to a format that 
> could be viewed in 3D GIS application such as ESRI's ArcScene or 
> ArcGlobe.  I want to example the use of airspace in relation to 
> terrain features.  A TIN seems to be the most logical geospatial data 
> structure that would support taking the 3D kde output into GIS.  Does 
> anybody have any ideas on how to get from a 3D kde output in ks to a 
> tin.  A self-contained sample of generating the kde is below.
>
> ###sample
> library(ks)
> df <- data.frame("x"=sample(1:200, 10), "y"=sample(1:200, 10), 
> "z"=sample(1:500, 10))
> Hpi1 <- Hpi(x = df)
> UD <- kde(x=df, H=Hpi1)
> plot(UD)
>
> Thanks in advance.
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



--
Michael Sumner
Hobart, Australia
e-mail: mdsumner at gmail.com

	[[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From mdsumner at gmail.com  Sat Apr 13 09:02:44 2013
From: mdsumner at gmail.com (Michael Sumner)
Date: Sat, 13 Apr 2013 17:02:44 +1000
Subject: [R-sig-Geo] 3D KDE to Triangular Irregular Network
In-Reply-To: <000001ce3808$34dd8670$9e989350$@gmail.com>
References: <F69351571CBC1942904F278D3B8FFB170717CCDE@WAXMXOLYMB026.WAX.wa.lcl>
	<CAAcGz99rdU=fXPiiiC=9+mPRs4TEVkFwDJbJLrMtPn=zmj33mw@mail.gmail.com>
	<000001ce3808$34dd8670$9e989350$@gmail.com>
Message-ID: <CAAcGz99uYDNg7gQw_XGXPUkqftYVhDrRUkGOC4gK9vt0RtDxPQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130413/e9559f0c/attachment.pl>

From valentina.lauria at nuigalway.ie  Sat Apr 13 10:38:49 2013
From: valentina.lauria at nuigalway.ie (Lauria, Valentina)
Date: Sat, 13 Apr 2013 08:38:49 +0000
Subject: [R-sig-Geo] produce a map in ARCGIS from a GAM output
In-Reply-To: <CAJmQPwF+cjfyTHLTchJp7YRXoptcYCvgs86+CpBQDMF112KLEg@mail.gmail.com>
References: <B11DE93D7F439D4BA1E942572BA75030739D36D5@UDSMBX01.uds.nuigalway.ie>,
	<CAJmQPwF+cjfyTHLTchJp7YRXoptcYCvgs86+CpBQDMF112KLEg@mail.gmail.com>
Message-ID: <B11DE93D7F439D4BA1E942572BA75030739D4742@UDSMBX01.uds.nuigalway.ie>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130413/68966957/attachment.pl>

From milansharma2012 at yahoo.com  Sat Apr 13 17:06:41 2013
From: milansharma2012 at yahoo.com (Milan Sharma)
Date: Sat, 13 Apr 2013 08:06:41 -0700 (PDT)
Subject: [R-sig-Geo] SAR and car degrees of freedom
Message-ID: <1365865601.72309.YahooMailNeo@web162106.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130413/8f65e368/attachment.pl>

From adamhsparks at gmail.com  Sat Apr 13 18:30:26 2013
From: adamhsparks at gmail.com (Adam Sparks)
Date: Sun, 14 Apr 2013 00:30:26 +0800
Subject: [R-sig-Geo] produce a map in ARCGIS from a GAM output
In-Reply-To: <B11DE93D7F439D4BA1E942572BA75030739D4742@UDSMBX01.uds.nuigalway.ie>
References: <B11DE93D7F439D4BA1E942572BA75030739D36D5@UDSMBX01.uds.nuigalway.ie>
	<CAJmQPwF+cjfyTHLTchJp7YRXoptcYCvgs86+CpBQDMF112KLEg@mail.gmail.com>
	<B11DE93D7F439D4BA1E942572BA75030739D4742@UDSMBX01.uds.nuigalway.ie>
Message-ID: <CAJmQPwHt7ZTFWLfa+4V5i4saBUzuC2AJLF-AKrrJXsyCqbPvow@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130414/2db70f0c/attachment.pl>

From roman.lustrik at gmail.com  Sat Apr 13 19:20:15 2013
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Sat, 13 Apr 2013 19:20:15 +0200
Subject: [R-sig-Geo] trailing slash when writing shapefiles with writeOGR
Message-ID: <CAHT1vpgggTbOZ0EAfcOLKFfRJS74GCpUgG56xJJ0ydJWtXZC1g@mail.gmail.com>

I just noticed that writing to a shape file using a trailing slash in
the directory path doesn't work (with a somewhat non-informative
error):

> writeOGR(obj = pril08c2.poly, dsn = "q:/projekti/gams_eksp/analiza/", layer = "priloznostno_2008_2012_cona2", driver = "ESRI Shapefile")
Error in writeOGR(obj = pril08c2.poly, dsn =
"q:/projekti/gams_eksp/analiza/",  :
  Creation of output file failed

While this does:

> writeOGR(obj = pril08c2.poly, dsn = "q:/projekti/gams_eksp/analiza", layer = "priloznostno_2008_2012_cona2", driver = "ESRI Shapefile")
>

The only difference is the trailing slash in the `dsn` path to the
folder is missing. I hope this will save someone some time - it ate
away most of my Saturday morning.

Cheers,
Roman

-- 
In God we trust, all others bring data.


From mdsumner at gmail.com  Sat Apr 13 23:46:45 2013
From: mdsumner at gmail.com (Michael Sumner)
Date: Sun, 14 Apr 2013 07:46:45 +1000
Subject: [R-sig-Geo] trailing slash when writing shapefiles with writeOGR
In-Reply-To: <CAHT1vpgggTbOZ0EAfcOLKFfRJS74GCpUgG56xJJ0ydJWtXZC1g@mail.gmail.com>
References: <CAHT1vpgggTbOZ0EAfcOLKFfRJS74GCpUgG56xJJ0ydJWtXZC1g@mail.gmail.com>
Message-ID: <CAAcGz9_hjj8kYsUs4gAF9SLV3HuT9TBy5A78ujgmscLpgpwO0Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130414/0aa96b5a/attachment.pl>

From j2kennel at gmail.com  Sun Apr 14 02:11:03 2013
From: j2kennel at gmail.com (Jonathan)
Date: Sat, 13 Apr 2013 17:11:03 -0700 (PDT)
Subject: [R-sig-Geo] Raster package: colFromX behaviour
Message-ID: <1365898263820-7583304.post@n2.nabble.com>

Hello group,

I am trying to get the column from point that exists the interfaces of two
cells and find that the results I'm getting are not consistent.  In the
below example I am getting the higher boundary for the cell for 0.1, 0.2,
and 0.4.  However, I get the lower boundary for 0.3.  

My current solution is to add a very small number to the coordinate if the
value falls on the interface but does anyone know a better workaround?

library(raster)
H <- raster(matrix(sample.int(100), ncol=10))

colFromX(H, 0.1)  # 2
colFromX(H, 0.2)  # 3
colFromX(H, 0.3)  # 3
colFromX(H, 0.4)  # 5

colFromX(H, 0.30000000000000001)  #3
colFromX(H, 0.3000000000000001)   #4

Cheers,
-Jonathan


Session Info 
R version 3.0.0 (2013-04-03)
Platform: x86_64-w64-mingw32/x64 (64-bit)

locale:
[1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United
States.1252   
[3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C                          
[5] LC_TIME=English_United States.1252    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] raster_2.1-16 sp_1.0-8     

loaded via a namespace (and not attached):
[1] grid_3.0.0      lattice_0.20-15 tools_3.0.0   



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Raster-package-colFromX-behaviour-tp7583304.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From endri81 at gmail.com  Sun Apr 14 11:23:04 2013
From: endri81 at gmail.com (endri81)
Date: Sun, 14 Apr 2013 02:23:04 -0700 (PDT)
Subject: [R-sig-Geo] R language GIS moving points
Message-ID: <1365931384426-7583305.post@n2.nabble.com>

Hello group,
Trying to load a map from Google Maps.
Main idea is to show a bus route in R language and to simulate some moving
points on this route representing buses moving from one point to the other.
Any idea which package to use for this and maybe some advices would be very
thankful.
Best Regards



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/R-language-GIS-moving-points-tp7583305.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From roman.lustrik at gmail.com  Sun Apr 14 12:59:32 2013
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Sun, 14 Apr 2013 12:59:32 +0200
Subject: [R-sig-Geo] R language GIS moving points
In-Reply-To: <1365931384426-7583305.post@n2.nabble.com>
References: <1365931384426-7583305.post@n2.nabble.com>
Message-ID: <CAHT1vpivBx0=b_qNoLN6rWkNrHR1XDfJCEtei+WuZwN7zX6RuA@mail.gmail.com>

Your starting point is `sp` which offers methods for everything
spatial. You will probably want `Rgooglemaps`
(http://cran.r-project.org/web/packages/RgoogleMaps/index.html)
package for downloading georeferenced snapshots.

Cheers,
Roman



On Sun, Apr 14, 2013 at 11:23 AM, endri81 <endri81 at gmail.com> wrote:
> Hello group,
> Trying to load a map from Google Maps.
> Main idea is to show a bus route in R language and to simulate some moving
> points on this route representing buses moving from one point to the other.
> Any idea which package to use for this and maybe some advices would be very
> thankful.
> Best Regards
>
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/R-language-GIS-moving-points-tp7583305.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
In God we trust, all others bring data.


From endri81 at gmail.com  Sun Apr 14 13:18:24 2013
From: endri81 at gmail.com (Endri Raco)
Date: Sun, 14 Apr 2013 13:18:24 +0200
Subject: [R-sig-Geo] R language GIS moving points
In-Reply-To: <CAHT1vpivBx0=b_qNoLN6rWkNrHR1XDfJCEtei+WuZwN7zX6RuA@mail.gmail.com>
References: <1365931384426-7583305.post@n2.nabble.com>
	<CAHT1vpivBx0=b_qNoLN6rWkNrHR1XDfJCEtei+WuZwN7zX6RuA@mail.gmail.com>
Message-ID: <CACje6_b9TKcibDWrLpNEG3hdidJFR5=pjBztKKfGCB7dV=TwvQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130414/4d1bc17d/attachment.pl>

From roman.lustrik at gmail.com  Sun Apr 14 13:24:40 2013
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Sun, 14 Apr 2013 13:24:40 +0200
Subject: [R-sig-Geo] R language GIS moving points
In-Reply-To: <CACje6_b9TKcibDWrLpNEG3hdidJFR5=pjBztKKfGCB7dV=TwvQ@mail.gmail.com>
References: <1365931384426-7583305.post@n2.nabble.com>
	<CAHT1vpivBx0=b_qNoLN6rWkNrHR1XDfJCEtei+WuZwN7zX6RuA@mail.gmail.com>
	<CACje6_b9TKcibDWrLpNEG3hdidJFR5=pjBztKKfGCB7dV=TwvQ@mail.gmail.com>
Message-ID: <CAHT1vph0c6MU9ffEZ_=2OZAJ7J34LMo7rbEeNdi-eiAc+_wVcg@mail.gmail.com>

I'm not sure what would be the optimal solution, but my first thought
was `elide` in `maptools` package.

Cheers,
Roman



On Sun, Apr 14, 2013 at 1:18 PM, Endri Raco <endri81 at gmail.com> wrote:
> Thank you Roman,
> Using
> al1 = get_map(location = c(lon, lat),
>               zoom = 6, maptype = 'roadmap')
>  ggmap(al1) + geom_point(data = points,colour="red")+geom_point(data =
> points2,colour="green")
>
> I printed map and points but still thinking about some code to make the
> points move from one coordinate to the other.
> Any ideas?
> Regards
>
>
> On Sun, Apr 14, 2013 at 12:59 PM, Roman Lu?trik <roman.lustrik at gmail.com>
> wrote:
>>
>> Your starting point is `sp` which offers methods for everything
>> spatial. You will probably want `Rgooglemaps`
>> (http://cran.r-project.org/web/packages/RgoogleMaps/index.html)
>> package for downloading georeferenced snapshots.
>>
>> Cheers,
>> Roman
>>
>>
>>
>> On Sun, Apr 14, 2013 at 11:23 AM, endri81 <endri81 at gmail.com> wrote:
>> > Hello group,
>> > Trying to load a map from Google Maps.
>> > Main idea is to show a bus route in R language and to simulate some
>> > moving
>> > points on this route representing buses moving from one point to the
>> > other.
>> > Any idea which package to use for this and maybe some advices would be
>> > very
>> > thankful.
>> > Best Regards
>> >
>> >
>> >
>> > --
>> > View this message in context:
>> > http://r-sig-geo.2731867.n2.nabble.com/R-language-GIS-moving-points-tp7583305.html
>> > Sent from the R-sig-geo mailing list archive at Nabble.com.
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at r-project.org
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>>
>> --
>> In God we trust, all others bring data.
>
>
>
>
> --
> MSc. Endri Ra?o
> _________________________________________________
> Polytechnic University of Tirana
> Faculty of Mathematical Engineering and Physics Engineering
> Department of Mathematical Engineering
> Address:  Sheshi Nene Tereza, Nr. 4, Tirana - ALBANIA
> Mobile: ++ 355 682061988



-- 
In God we trust, all others bring data.


From Roger.Bivand at nhh.no  Sun Apr 14 14:55:07 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sun, 14 Apr 2013 14:55:07 +0200
Subject: [R-sig-Geo] rgdal in MAc OSX with R 3.0
In-Reply-To: <CAG4NReJpcM+OpTz-KkTCYSOqS6aC2H6LDoeTKqk0Y-S+KwWkWA@mail.gmail.com>
References: <CAG4NReLBXuUZ=ySsWVvqOPgAu+cDuEbMxbQU=O8qoaykQngM1g@mail.gmail.com>
	<alpine.LRH.2.03.1304092048030.5969@reclus.nhh.no>
	<CAG4NReJpcM+OpTz-KkTCYSOqS6aC2H6LDoeTKqk0Y-S+KwWkWA@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1304141454070.5370@reclus.nhh.no>

Both rgeos and rgdal are now current for OSX binaries on CRAN.

Roger

On Thu, 11 Apr 2013, Agustin Lobo wrote:

> No problem, it's normal that a change to 3.0 has some small inconveniences
> largely balanced by the advantages of advancing to better versions.
> Thanks to Simon for his efforts.
>
> Agus
>
> On Tue, Apr 9, 2013 at 8:52 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>> See:
>>
>> https://stat.ethz.ch/pipermail/r-sig-geo/2013-April/017934.html
>>
>> for the first posting to ask about rgdal, rgeos, etc. on OSX for R 3.0.0.
>> The rgeos package is now available for this platform (the R offering for OSX
>> has changed a good deal for R 3.0.*), but rgdal is as yet not available.
>>
>> If you would like to help Simon Urbanek, I'm sure he would be grateful for
>> assistance, but there is no guarantee that things will "just work"; "just
>> working" means a small number of people doing a lot of work in their own
>> time. Simon has already made a major contribution, so for now, patience is
>> appropriate, he is aware of the issue.
>>
>> Roger
>>
>>
>> On Tue, 9 Apr 2013, Agustin Lobo wrote:
>>
>>> HI,
>>>
>>> After a long time of not having problems with installing rgdal
>>> on Mac OSX using
>>>
>>> setRepositories(ind=1:2)
>>> install.packages("rgdal")
>>>
>>> (and even perhaps using the gui in RStudio?)
>>>
>>> I get now
>>> package ?rgdal? is not available (for R version 3.0.0)
>>>
>>> Does anybody know if the package will be built for MAc again or do
>>> we have to on and compile on our own?
>>>
>>> Thanks
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>> --
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From oscar.perpinan at gmail.com  Sun Apr 14 16:20:46 2013
From: oscar.perpinan at gmail.com (Oscar =?utf-8?B?UGVycGnDscOhbg==?= Lamigueiro)
Date: Sun, 14 Apr 2013 16:20:46 +0200
Subject: [R-sig-Geo] R language GIS moving points
In-Reply-To: <1365931384426-7583305.post@n2.nabble.com>
References: <1365931384426-7583305.post@n2.nabble.com>
Message-ID: <87wqs5w5vl.fsf@gmail.com>

Hello,

You could try grid.animate from the gridSVG package. Here you will find
an example:

http://www.stat.auckland.ac.nz/~paul/Velvet/gapminderOnePanel.svg.html
(code at
http://www.stat.auckland.ac.nz/~paul/Talks/Genentech2011/gapminderLattice.R)

Best,

Oscar.


endri81 <endri81 at gmail.com> writes:

> Hello group,
> Trying to load a map from Google Maps.
> Main idea is to show a bus route in R language and to simulate some moving
> points on this route representing buses moving from one point to the other.
> Any idea which package to use for this and maybe some advices would be very
> thankful.
> Best Regards
>
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/R-language-GIS-moving-points-tp7583305.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


-- 
Oscar Perpi??n Lamigueiro
Grupo de Sistemas Fotovoltaicos (IES-UPM)
Dpto. Ingenier?a El?ctrica (EUITI-UPM)
URL: http://procomun.wordpress.com
Twitter: @oscarperpinan


From samanmonfared1 at gmail.com  Sun Apr 14 18:10:42 2013
From: samanmonfared1 at gmail.com (Saman Monfared)
Date: Sun, 14 Apr 2013 20:40:42 +0430
Subject: [R-sig-Geo] Variogram Error
Message-ID: <CAOytA4YsCjCdX7UO9i_goitXk8YR2PfQ33fy13HYB2DAEk0uYw@mail.gmail.com>

Hi,
I am trying  to fit a st variogram .The values of variogram$gamma
in all st lags are 0. I don't no why this occurs!

Data is attached.

my program is:
rm(list=ls())
library(gstat)
library(spacetime)
library(maptools)
library(RColorBrewer)
library(maps)
library(lattice)
data<-read.table("cancer.rate.txt",header=TRUE)
cancer.loc<-read.table("bladder.loc.txt",header=TRUE)
pts<-cbind(cancer.loc$x,cancer.loc$y)
pts = SpatialPoints(pts)
data$time = ISOdate(data$year, data$mounth, data$day)
ind<-as.matrix(cbind(data$indexs,data$indext))
xx = STSDF(pts,data$time,data,ind)
vv<-variogram(Rate~1,xx,width=200000,cutoff=3000000,tlags=1:8)
plot(vv,map=T)
wireframe(gamma~spacelag+timelag,vv,col="red",drape=T,outer =T,
scales=list(arrows=FALSE))
separableModel<-vgmST("separable",space=vgm(.05,"Gau",10000, 0.1),
time =vgm(.02,"Gau", 100, 0),sill=.2,nugget=0)
v.f<-fit.StVariogram(vv,separableModel,method="L-BFGS-B")
v.f
wireframe(model~spacelag+timelag,variogramSurface(v.f,vv),drape=T,
aspect = c(1,1),panel.aspect =1,scales=list(arrows=F))
plot(vv,v.f)
grd<-read.table("farsgrid.txt",header=T)
grd = SpatialPixels(SpatialPoints(cbind(grd$x,grd$y)))
plot(grd)
n =3
library(xts)
tgrd = seq(max(index(xx)+31622400*2),max(index(xx)+3*31622400),length=2)
pred.grd = STF(grd, tgrd)
plot(pred.grd )
cancer.ST = krigeST(Rate~1,xx,pred.grd ,separableModel)
stplot(cancer.ST)





-- 
Saman Monfared
Msc, Department of Statistics, Shiraz University,
Shiraz 71454, Iran
Email: Samanmonfared1 at gmail.com

Tel: +98 917 5305167



-- 
Saman Monfared
Msc, Department of Statistics, Shiraz University,
Shiraz 71454, Iran
Email: Samanmonfared1 at gmail.com

Tel: +98 917 5305167


From jeandaniel.sylvain at gmail.com  Mon Apr 15 03:54:08 2013
From: jeandaniel.sylvain at gmail.com (jeandaniel.sylvain)
Date: Sun, 14 Apr 2013 21:54:08 -0400
Subject: [R-sig-Geo] RE : Re:  R language GIS moving points
Message-ID: <ln3lprhk7bqay2o8lfrrs2qk.1365990848640@email.android.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130414/a9482ab7/attachment.pl>

From r.hijmans at gmail.com  Mon Apr 15 05:48:53 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sun, 14 Apr 2013 20:48:53 -0700
Subject: [R-sig-Geo] Raster package: colFromX behaviour
In-Reply-To: <1365898263820-7583304.post@n2.nabble.com>
References: <1365898263820-7583304.post@n2.nabble.com>
Message-ID: <CANtt_hyLpR4=tQ4uYid0zhKYP9Ya9zZ1z2PyzMzLHuOO6S6Wvg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130414/a9d09c88/attachment.pl>

From j2kennel at gmail.com  Mon Apr 15 06:16:51 2013
From: j2kennel at gmail.com (Jonathan)
Date: Sun, 14 Apr 2013 21:16:51 -0700 (PDT)
Subject: [R-sig-Geo] Raster package: colFromX behaviour
In-Reply-To: <CANtt_hyLpR4=tQ4uYid0zhKYP9Ya9zZ1z2PyzMzLHuOO6S6Wvg@mail.gmail.com>
References: <1365898263820-7583304.post@n2.nabble.com>
	<CANtt_hyLpR4=tQ4uYid0zhKYP9Ya9zZ1z2PyzMzLHuOO6S6Wvg@mail.gmail.com>
Message-ID: <1365999411902-7583314.post@n2.nabble.com>

Thank you Robert for your response,

I see it is a floating point issue so I've now come up with a solution
(modified your version slightly) that is functional for my use.  Basically
it rounds the calculated ratio to a certain number of digits and then
truncates the value.  I've attached it in case it is of use to someone.  I
am tracking points across the cells and needed values to be consistently on
one side or the other or else my points can become trapped in a particular
cell when an edge is reached.

colFromX <- function ( object, x, digits=10)	{
	if (inherits(x, 'Spatial')) { 
		x <- x at coords[,1] 
	}
	if (rotated(object)) {
		stop('this function is not supported for rotated rasters')
	}
	colnr <- trunc(round((x - xmin(object)) / xres(object), digits)) + 1
	colnr[ x == xmax(object) ] <- object at ncols
	colnr[ x < xmin(object) | x > xmax(object) ] <- NA
	return(as.vector(colnr))
}

Thank you again,
Jonathan



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Raster-package-colFromX-behaviour-tp7583304p7583314.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From jagaronson at gmail.com  Mon Apr 15 11:39:46 2013
From: jagaronson at gmail.com (JonathanAronson)
Date: Mon, 15 Apr 2013 02:39:46 -0700 (PDT)
Subject: [R-sig-Geo] Help with ENFA in R
In-Reply-To: <1365694200318-7583282.post@n2.nabble.com>
References: <1365511769098-7583243.post@n2.nabble.com>
	<51644E82.5080703@ase-research.org>
	<1365537093429-7583258.post@n2.nabble.com>
	<51648FCC.5070809@ase-research.org>
	<1365580744207-7583264.post@n2.nabble.com>
	<51651D48.1080103@oncfs.gouv.fr>
	<1365588123956-7583270.post@n2.nabble.com>
	<1365604778155-7583272.post@n2.nabble.com>
	<51658BF6.7010702@ase-research.org>
	<1365694200318-7583282.post@n2.nabble.com>
Message-ID: <1366018786679-7583315.post@n2.nabble.com>

Hi there

I have been working on this over the weekend. I have managed to make some
progress.
Now I am trying to run the enfa using this code: enfa(pc, pr, scan=FALSE).

I can define pc using my text file of the locality data for my species using
this code: pc <- dudi.pca(locs, scannf=FALSE). However, now I need to define
pr and Im not sure if that refers to my environmental data. The error I get
is below. How can I create the pr vector?

Error in is.vector(pr) : object 'pr' not found

Any help would be greatly appreaciated

Thanks all
Jonathan



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Help-with-ENFA-in-R-tp7583243p7583315.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From villers.alexandre at gmail.com  Mon Apr 15 12:23:15 2013
From: villers.alexandre at gmail.com (Alexandre Villers)
Date: Mon, 15 Apr 2013 13:23:15 +0300
Subject: [R-sig-Geo] Help with ENFA in R
In-Reply-To: <1366018786679-7583315.post@n2.nabble.com>
References: <1365511769098-7583243.post@n2.nabble.com>
	<51644E82.5080703@ase-research.org>
	<1365537093429-7583258.post@n2.nabble.com>
	<51648FCC.5070809@ase-research.org>
	<1365580744207-7583264.post@n2.nabble.com>
	<51651D48.1080103@oncfs.gouv.fr>
	<1365588123956-7583270.post@n2.nabble.com>
	<1365604778155-7583272.post@n2.nabble.com>
	<51658BF6.7010702@ase-research.org>
	<1365694200318-7583282.post@n2.nabble.com>
	<1366018786679-7583315.post@n2.nabble.com>
Message-ID: <516BD513.4090904@gmail.com>

Hi,

Typing ?enfa (after loading adehabitatHS) and searching through the 
examples that are provided, you should find these lines

## We prepare the data for the ENFA
tab <- slot(map, "data")
pr <- slot(count.points(locs, map), "data")[,1]

Maybe you could start with this, i.e. understanding how the pr object is 
obtained, playing with the example.
And then, if you really don't get it, ask someone on the list to help you.

HTH

Alex


On 15/04/2013 12:39, JonathanAronson wrote:
> Hi there
>
> I have been working on this over the weekend. I have managed to make some
> progress.
> Now I am trying to run the enfa using this code: enfa(pc, pr, scan=FALSE).
>
> I can define pc using my text file of the locality data for my species using
> this code: pc <- dudi.pca(locs, scannf=FALSE). However, now I need to define
> pr and Im not sure if that refers to my environmental data. The error I get
> is below. How can I create the pr vector?
>
> Error in is.vector(pr) : object 'pr' not found
>
> Any help would be greatly appreaciated
>
> Thanks all
> Jonathan
>
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Help-with-ENFA-in-R-tp7583243p7583315.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>

--


From villers.alexandre at gmail.com  Mon Apr 15 12:23:26 2013
From: villers.alexandre at gmail.com (Alexandre Villers)
Date: Mon, 15 Apr 2013 13:23:26 +0300
Subject: [R-sig-Geo] Help with ENFA in R
In-Reply-To: <1366018786679-7583315.post@n2.nabble.com>
References: <1365511769098-7583243.post@n2.nabble.com>
	<51644E82.5080703@ase-research.org>
	<1365537093429-7583258.post@n2.nabble.com>
	<51648FCC.5070809@ase-research.org>
	<1365580744207-7583264.post@n2.nabble.com>
	<51651D48.1080103@oncfs.gouv.fr>
	<1365588123956-7583270.post@n2.nabble.com>
	<1365604778155-7583272.post@n2.nabble.com>
	<51658BF6.7010702@ase-research.org>
	<1365694200318-7583282.post@n2.nabble.com>
	<1366018786679-7583315.post@n2.nabble.com>
Message-ID: <516BD51E.2010204@gmail.com>

Hi,

Typing ?enfa (after loading adehabitatHS) and searching through the 
examples that are provided, you should find these lines

## We prepare the data for the ENFA
tab <- slot(map, "data")
pr <- slot(count.points(locs, map), "data")[,1]

Maybe you could start with this, i.e. understanding how the pr object is 
obtained, playing with the example.
And then, if you really don't get it, ask someone on the list to help you.

HTH

Alex


On 15/04/2013 12:39, JonathanAronson wrote:
> Hi there
>
> I have been working on this over the weekend. I have managed to make some
> progress.
> Now I am trying to run the enfa using this code: enfa(pc, pr, scan=FALSE).
>
> I can define pc using my text file of the locality data for my species using
> this code: pc <- dudi.pca(locs, scannf=FALSE). However, now I need to define
> pr and Im not sure if that refers to my environmental data. The error I get
> is below. How can I create the pr vector?
>
> Error in is.vector(pr) : object 'pr' not found
>
> Any help would be greatly appreaciated
>
> Thanks all
> Jonathan
>
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Help-with-ENFA-in-R-tp7583243p7583315.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>

--


From endri81 at gmail.com  Mon Apr 15 12:26:58 2013
From: endri81 at gmail.com (Endri Raco)
Date: Mon, 15 Apr 2013 12:26:58 +0200
Subject: [R-sig-Geo] Fwd: RE : Re:  R language GIS moving points
In-Reply-To: <CACje6_YadH7mVnj7FpcZLRejVQh=hmejZO+1U71jC4guWDSoOQ@mail.gmail.com>
References: <ln3lprhk7bqay2o8lfrrs2qk.1365990848640@email.android.com>
	<CACje6_YadH7mVnj7FpcZLRejVQh=hmejZO+1U71jC4guWDSoOQ@mail.gmail.com>
Message-ID: <CACje6_bTfPUTNzS+TSTxN+FZC5Y622pd_-B3akY-fB0DLL4v=A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130415/b92455f5/attachment.pl>

From endri81 at gmail.com  Mon Apr 15 12:36:10 2013
From: endri81 at gmail.com (Endri Raco)
Date: Mon, 15 Apr 2013 12:36:10 +0200
Subject: [R-sig-Geo] Multiple datasets with coordinates
Message-ID: <CACje6_Ya3Kq2MBGiU7=GmW=O4FDeCfFAv1HO7dzA96FqGdtjwg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130415/322b76be/attachment.pl>

From kevin.morelle at ulg.ac.be  Mon Apr 15 12:52:11 2013
From: kevin.morelle at ulg.ac.be (kevin.morelle at ulg.ac.be)
Date: Mon, 15 Apr 2013 12:52:11 +0200 (CEST)
Subject: [R-sig-Geo] Multiple datasets with coordinates
In-Reply-To: <CACje6_Ya3Kq2MBGiU7=GmW=O4FDeCfFAv1HO7dzA96FqGdtjwg@mail.gmail.com>
Message-ID: <505321125.2896877.1366023131059.JavaMail.root@serv224.segi.ulg.ac.be>

Hi,
This worked for me but I only tried with ggplot:

1?) add a colum "$type" to your differents dataset to discriminate them
2?) join then your datasets in one dataframe (rbind)
3?) then in ggmap use "fill=type", so as: ggmap(al1) + geom_point(data=points, aes(size = 4, fill=type))

Hope it works,

Kevin

----- Mail original -----
De: "Endri Raco" <endri81 at gmail.com>
?: r-sig-geo at r-project.org
Envoy?: Lundi 15 Avril 2013 12:36:10
Objet: [R-sig-Geo] Multiple datasets with coordinates

Hi group,
Trying to plot with ggplot2 different datasets of coordinats inside the
same chart.

Till now I can plot

ggmap(al1) + geom_point(data=points,colour="red", size = 4)

where points are tables



lon    lat

41.00   19.02


but I need to add other sets of points(tables of coordinates)


lon    lat

41.00   19.02

...     .....
*
*

with other colors in the same chart.Is that possible?

	[[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From endri81 at gmail.com  Mon Apr 15 13:10:28 2013
From: endri81 at gmail.com (Endri Raco)
Date: Mon, 15 Apr 2013 13:10:28 +0200
Subject: [R-sig-Geo] Multiple datasets with coordinates
In-Reply-To: <505321125.2896877.1366023131059.JavaMail.root@serv224.segi.ulg.ac.be>
References: <CACje6_Ya3Kq2MBGiU7=GmW=O4FDeCfFAv1HO7dzA96FqGdtjwg@mail.gmail.com>
	<505321125.2896877.1366023131059.JavaMail.root@serv224.segi.ulg.ac.be>
Message-ID: <CACje6_bE0a4Jc_NvGKFXyKDDEn8q43iWSpnzTkG7YO0VGv+-xA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130415/8d38a444/attachment.pl>

From jagaronson at gmail.com  Mon Apr 15 13:16:01 2013
From: jagaronson at gmail.com (JonathanAronson)
Date: Mon, 15 Apr 2013 04:16:01 -0700 (PDT)
Subject: [R-sig-Geo] Help with ENFA in R
In-Reply-To: <516BD513.4090904@gmail.com>
References: <1365537093429-7583258.post@n2.nabble.com>
	<51648FCC.5070809@ase-research.org>
	<1365580744207-7583264.post@n2.nabble.com>
	<51651D48.1080103@oncfs.gouv.fr>
	<1365588123956-7583270.post@n2.nabble.com>
	<1365604778155-7583272.post@n2.nabble.com>
	<51658BF6.7010702@ase-research.org>
	<1365694200318-7583282.post@n2.nabble.com>
	<1366018786679-7583315.post@n2.nabble.com>
	<516BD513.4090904@gmail.com>
Message-ID: <1366024561215-7583322.post@n2.nabble.com>

Hi Alexandre

I have looked at the examples already and those in SP package too before I
posted my question.
When I run this line of code from the example: pr <- slot(count.points(locs,
join), "data")[,1], I get the following error:

Error in count.points(locs, join) : 
  w should inherit the class SpatialPixels

So I am trying to coerce my object "join" from a spatialgriddataframe to a
spatialpixeldataframe. However, I have used this code to do that which I
found in help examples: test <- as(join, "SpatialPixels")

I get this error:

Error in as(join, "SpatialPixels") : 
  no method or default for coercing ?data.frame? to ?SpatialPixels?

So I cant convert my "join" data frame in the spatial pixels I  need to get
the pr object. Ive tried updating my SP package but it still didnt work
after that. In the SP package vignette it says that, with reference to
SpatialPixels and SpatialGrids: "Objects can be coerced from one
representation to the other" but I get the above mentioned error when I try
do this.

Thanks
Jonathan




--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Help-with-ENFA-in-R-tp7583243p7583322.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From edzer.pebesma at uni-muenster.de  Mon Apr 15 14:31:18 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 15 Apr 2013 14:31:18 +0200
Subject: [R-sig-Geo] Variogram Error
In-Reply-To: <CAOytA4YsCjCdX7UO9i_goitXk8YR2PfQ33fy13HYB2DAEk0uYw@mail.gmail.com>
References: <CAOytA4YsCjCdX7UO9i_goitXk8YR2PfQ33fy13HYB2DAEk0uYw@mail.gmail.com>
Message-ID: <516BF316.5050300@uni-muenster.de>

Saman,

Ben Graeler managed to reproduce the same effect by:

library(gstat)
data(meuse)
coordinates(meuse) <- ~x+y

obj = gstat(NULL, "D1", zinc~1, meuse[1,], set = list(zero_dist = 3))
obj = gstat(obj, "D2", zinc~1, meuse[2,])
variogram(obj, cross = "ONLY", pseudo = T, boundaries=c(0,100))

Essentially, for ST variograms, for each time slice the mean was removed
before computing the (pseudo) cross variogram. This will usually have
little effect, unless you have very few, or as in this (and your) case,
only one observation per time slice.

We changed the code now such that the mean is not removed. Updates are
committed r-forge; the next version on CRAN will include this update.




On 04/14/2013 06:10 PM, Saman Monfared wrote:
> Hi,
> I am trying  to fit a st variogram .The values of variogram$gamma
> in all st lags are 0. I don't no why this occurs!
> 
> Data is attached.
> 
> my program is:
> rm(list=ls())
> library(gstat)
> library(spacetime)
> library(maptools)
> library(RColorBrewer)
> library(maps)
> library(lattice)
> data<-read.table("cancer.rate.txt",header=TRUE)
> cancer.loc<-read.table("bladder.loc.txt",header=TRUE)
> pts<-cbind(cancer.loc$x,cancer.loc$y)
> pts = SpatialPoints(pts)
> data$time = ISOdate(data$year, data$mounth, data$day)
> ind<-as.matrix(cbind(data$indexs,data$indext))
> xx = STSDF(pts,data$time,data,ind)
> vv<-variogram(Rate~1,xx,width=200000,cutoff=3000000,tlags=1:8)
> plot(vv,map=T)
> wireframe(gamma~spacelag+timelag,vv,col="red",drape=T,outer =T,
> scales=list(arrows=FALSE))
> separableModel<-vgmST("separable",space=vgm(.05,"Gau",10000, 0.1),
> time =vgm(.02,"Gau", 100, 0),sill=.2,nugget=0)
> v.f<-fit.StVariogram(vv,separableModel,method="L-BFGS-B")
> v.f
> wireframe(model~spacelag+timelag,variogramSurface(v.f,vv),drape=T,
> aspect = c(1,1),panel.aspect =1,scales=list(arrows=F))
> plot(vv,v.f)
> grd<-read.table("farsgrid.txt",header=T)
> grd = SpatialPixels(SpatialPoints(cbind(grd$x,grd$y)))
> plot(grd)
> n =3
> library(xts)
> tgrd = seq(max(index(xx)+31622400*2),max(index(xx)+3*31622400),length=2)
> pred.grd = STF(grd, tgrd)
> plot(pred.grd )
> cancer.ST = krigeST(Rate~1,xx,pred.grd ,separableModel)
> stplot(cancer.ST)
> 
> 
> 
> 
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From enrico.crema at gmail.com  Mon Apr 15 17:50:00 2013
From: enrico.crema at gmail.com (Enrico R. Crema)
Date: Mon, 15 Apr 2013 16:50:00 +0100
Subject: [R-sig-Geo] variogram based on Jaccard distance
Message-ID: <BCB26936-1006-4366-9354-5E270904A7A9@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130415/ca8e182d/attachment.pl>

From jagaronson at gmail.com  Tue Apr 16 15:59:42 2013
From: jagaronson at gmail.com (JonathanAronson)
Date: Tue, 16 Apr 2013 06:59:42 -0700 (PDT)
Subject: [R-sig-Geo] Help with ENFA in R
In-Reply-To: <1366024561215-7583322.post@n2.nabble.com>
References: <51648FCC.5070809@ase-research.org>
	<1365580744207-7583264.post@n2.nabble.com>
	<51651D48.1080103@oncfs.gouv.fr>
	<1365588123956-7583270.post@n2.nabble.com>
	<1365604778155-7583272.post@n2.nabble.com>
	<51658BF6.7010702@ase-research.org>
	<1365694200318-7583282.post@n2.nabble.com>
	<1366018786679-7583315.post@n2.nabble.com>
	<516BD513.4090904@gmail.com>
	<1366024561215-7583322.post@n2.nabble.com>
Message-ID: <1366120782217-7583325.post@n2.nabble.com>

Hi there
I have managed to preapre my data finally to do the enfa. However, when I
run the test I get an error and warning message shown below:

ENFA <- enfa(pc, pr, scannf = FALSE)
Error in crossprod(Ze, DpZ) : non-conformable arguments
In addition: Warning messages:
1: In x * pr :
  longer object length is not a multiple of shorter object length
2: In x * pr :
  longer object length is not a multiple of shorter object length
3: In x * pr :
  longer object length is not a multiple of shorter object length
4: In x * pr :
  longer object length is not a multiple of shorter object length

Im not sure what this means. I thought there could be a mismatch between my
locality points and the environmental maps but Ive plotted the points and
they are in the correct locations. Has anyone encountered this before and
can you please provide some advice about how to deal with it.

Thank you Clement, Mathieu and Alex for your help thus far!!

Jon



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Help-with-ENFA-in-R-tp7583243p7583325.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Rainer at krugs.de  Tue Apr 16 17:02:14 2013
From: Rainer at krugs.de (Rainer M. Krug)
Date: Tue, 16 Apr 2013 17:02:14 +0200
Subject: [R-sig-Geo] warnings and errors from grass to R via spgrass6
Message-ID: <87zjwybjt5.fsf@krugs.de>

Hi

I am using spgrass6 with grass 7 and can report that it works so far
without problems.

Nevertheless, I have one question, which I already had about grass 6.

I am using execGRASS to execute grass commands as well as an own defined
function r.mapcalc [1].

Now as these are used in a simulation script, I would like to (actually
need to know) when these functions fail. 

Is there a way that errors and warnings in GRASS will be reflected as
errors and warnings in R when tthe grass function is called via execGRASS?

I am using Linux and R 3.0.0

Thanks,

Rainer


Footnotes: 
[1] r.mapcalc is defined as follow:
--8<---------------cut here---------------start------------->8---
 r.mapcalc <- function(
    ...,
    intern = TRUE,
    ignore.stderr = !options("asmDebug")[[1]],
    feedback = TRUE,
    flags = NULL
    ) {
    comm <- paste( "r.mapcalc ", " \"", ..., "\" ", sep="" )
    if (!is.null(flags)) {
      flags <- paste0("--", flags, collapse=" ")
    }
    comm <- paste(comm, flags)
    if (feedback) print(comm)
    system( comm, intern=intern, ignore.stderr=ignore.stderr )
  }
--8<---------------cut here---------------end--------------->8---

  



-- 
Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation Biology, UCT), Dipl. Phys. (Germany)

Centre of Excellence for Invasion Biology
Stellenbosch University
South Africa

Tel :       +33 - (0)9 53 10 27 44
Cell:       +33 - (0)6 85 62 59 98
Fax :       +33 - (0)9 58 10 27 44

Fax (D):    +49 - (0)3 21 21 25 22 44

email:      Rainer at krugs.de

Skype:      RMkrug
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 489 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130416/05444e4c/attachment.bin>

From yamamotogu at gmail.com  Tue Apr 16 17:18:39 2013
From: yamamotogu at gmail.com (xin xin)
Date: Tue, 16 Apr 2013 11:18:39 -0400
Subject: [R-sig-Geo] spatial analysis using health indicator
Message-ID: <CACKkqQfnXBoizJA8pj4FoHx4YJ51YBoS3DHwtkH7+gYC4oMYRA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130416/bc6dd349/attachment.pl>

From Roger.Bivand at nhh.no  Tue Apr 16 18:11:18 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 16 Apr 2013 18:11:18 +0200
Subject: [R-sig-Geo] warnings and errors from grass to R via spgrass6
In-Reply-To: <87zjwybjt5.fsf@krugs.de>
References: <87zjwybjt5.fsf@krugs.de>
Message-ID: <alpine.LRH.2.03.1304161801360.14909@reclus.nhh.no>

On Tue, 16 Apr 2013, Rainer M. Krug wrote:

> Hi
>
> I am using spgrass6 with grass 7 and can report that it works so far
> without problems.
>
> Nevertheless, I have one question, which I already had about grass 6.
>
> I am using execGRASS to execute grass commands as well as an own defined
> function r.mapcalc [1].
>
> Now as these are used in a simulation script, I would like to (actually
> need to know) when these functions fail.

Rainer:

Could you please create a simple test case with some built-in data set and 
initGRASS()? I see from ?system that some cases are addressed, but with 
intern=TRUE.

Roger

>
> Is there a way that errors and warnings in GRASS will be reflected as
> errors and warnings in R when tthe grass function is called via execGRASS?
>
> I am using Linux and R 3.0.0
>
> Thanks,
>
> Rainer
>
>
> Footnotes:
> [1] r.mapcalc is defined as follow:
> --8<---------------cut here---------------start------------->8---
> r.mapcalc <- function(
>    ...,
>    intern = TRUE,
>    ignore.stderr = !options("asmDebug")[[1]],
>    feedback = TRUE,
>    flags = NULL
>    ) {
>    comm <- paste( "r.mapcalc ", " \"", ..., "\" ", sep="" )
>    if (!is.null(flags)) {
>      flags <- paste0("--", flags, collapse=" ")
>    }
>    comm <- paste(comm, flags)
>    if (feedback) print(comm)
>    system( comm, intern=intern, ignore.stderr=ignore.stderr )
>  }
> --8<---------------cut here---------------end--------------->8---
>
>
>
>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From reeder4 at illinois.edu  Tue Apr 16 19:19:28 2013
From: reeder4 at illinois.edu (Reeder, Bryce Wesley)
Date: Tue, 16 Apr 2013 12:19:28 -0500
Subject: [R-sig-Geo] Need Help With Loop
Message-ID: <CAN8mTraG1EK9e=Tg6Q9Vz-ReVhdsdsbAf1tsTcyOktmwrAiAhQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130416/4b47c1f2/attachment.pl>

From Rainer at krugs.de  Wed Apr 17 08:40:20 2013
From: Rainer at krugs.de (Rainer M. Krug)
Date: Wed, 17 Apr 2013 08:40:20 +0200
Subject: [R-sig-Geo] warnings and errors from grass to R via spgrass6GG
In-Reply-To: <alpine.LRH.2.03.1304161801360.14909@reclus.nhh.no> (Roger
	Bivand's message of "Tue, 16 Apr 2013 18:11:18 +0200")
References: <87zjwybjt5.fsf@krugs.de>
	<alpine.LRH.2.03.1304161801360.14909@reclus.nhh.no>
Message-ID: <87vc7lbr8l.fsf@krugs.de>

Roger Bivand <Roger.Bivand at nhh.no> writes:

> On Tue, 16 Apr 2013, Rainer M. Krug wrote:
>
>> Hi
>>
>> I am using spgrass6 with grass 7 and can report that it works so far
>> without problems.
>>
>> Nevertheless, I have one question, which I already had about grass 6.
>>
>> I am using execGRASS to execute grass commands as well as an own defined
>> function r.mapcalc [1].
>>
>> Now as these are used in a simulation script, I would like to (actually
>> need to know) when these functions fail.
>
> Rainer:
>
> Could you please create a simple test case with some built-in data set
> and initGRASS()? I see from ?system that some cases are addressed, but
> with intern=TRUE.

I'll investigate further and will send some examples using the spearhead
dataset.

Thanks,

Rainer

>
> Roger
>
>>
>> Is there a way that errors and warnings in GRASS will be reflected as
>> errors and warnings in R when tthe grass function is called via execGRASS?
>>
>> I am using Linux and R 3.0.0
>>
>> Thanks,
>>
>> Rainer
>>
>>
>> Footnotes:
>> [1] r.mapcalc is defined as follow:
>> --8<---------------cut here---------------start------------->8---
>> r.mapcalc <- function(
>>    ...,
>>    intern = TRUE,
>>    ignore.stderr = !options("asmDebug")[[1]],
>>    feedback = TRUE,
>>    flags = NULL
>>    ) {
>>    comm <- paste( "r.mapcalc ", " \"", ..., "\" ", sep="" )
>>    if (!is.null(flags)) {
>>      flags <- paste0("--", flags, collapse=" ")
>>    }
>>    comm <- paste(comm, flags)
>>    if (feedback) print(comm)
>>    system( comm, intern=intern, ignore.stderr=ignore.stderr )
>>  }
>> --8<---------------cut here---------------end--------------->8---
>>
>>
>>
>>
>>
>>
<#secure method=pgpmime mode=sign>

-- 
Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation Biology, UCT), Dipl. Phys. (Germany)

Centre of Excellence for Invasion Biology
Stellenbosch University
South Africa

Tel :       +33 - (0)9 53 10 27 44
Cell:       +33 - (0)6 85 62 59 98
Fax :       +33 - (0)9 58 10 27 44

Fax (D):    +49 - (0)3 21 21 25 22 44

email:      Rainer at krugs.de

Skype:      RMkrug


From r.turner at auckland.ac.nz  Wed Apr 17 09:44:17 2013
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Wed, 17 Apr 2013 19:44:17 +1200
Subject: [R-sig-Geo] Need Help With Loop
In-Reply-To: <CAN8mTraG1EK9e=Tg6Q9Vz-ReVhdsdsbAf1tsTcyOktmwrAiAhQ@mail.gmail.com>
References: <CAN8mTraG1EK9e=Tg6Q9Vz-ReVhdsdsbAf1tsTcyOktmwrAiAhQ@mail.gmail.com>
Message-ID: <516E52D1.6030802@auckland.ac.nz>



I am not at all sure that I understand your question,   but I *think*
that you do not need to use loops at all.  Let me assume that
you have vectors of point coordinates x and y, a vector of
months associated with the points, sat "m" (which is a *factor* of the
same length as x and y) and an observation window (say W)
within which the points lie.

You can do something like:

# Generate some toy data.
     x <- runif(1000,0,10)
     y <- runif(1000,0,10)
     m <- factor(sample(month.abb,1000,TRUE))
     W <- owin(c(0,10),c(0,10))

# Now do the processing of the data.
     X <- ppp(x,y,window=W,marks=m)
     SX <- split(X)
     foo <- function(x,sigma,k.keep) {
         iii <- density(x,sigma=sigma,diggle=TRUE)
         jjj <- as.owin(iii[eval.im(iii>=k.keep*max(iii)),drop=FALSE])
         convexhull(jjj)
     }
     RSLT <- lapply(SX,foo,sigma=0.5,k.keep=0.5)

Does that get you where you wanted to go?

     cheers,

         Rolf Turner


On 17/04/13 05:19, Reeder, Bryce Wesley wrote:
> Dear List,
>
> This is likely a silly question, but I am just beginning to learn how to
> incorporate loops into my functions.  I have written a function that allows
> me to perform a series of steps that I need to do:
>
> function.x <- function(x, y, window, b.size, k.keep){
>    ppp <- ppp(x, y, window=window)
>    k <- density(ppp, b.size, edge=TRUE, at="pixel", diggle=TRUE,
> window=window)
>    df <- data.frame(k)
>    k.extract <- df[df$value >= (k.keep*max(df$value)), ]
>    extract.ppp <- ppp(k.extract$x, k.extract$y, window=window)
>    shape <- convexhull(extract.ppp)
> }
>
> As of now, I must subset the my data first into months and then run the
> function for each month separately.  I have been trying all morning to
> insert a loop that can subset my data into months for me, run the function,
> and then return the convexhulls as objects that I can save as polygons.


From endri81 at gmail.com  Wed Apr 17 15:06:16 2013
From: endri81 at gmail.com (Endri Raco)
Date: Wed, 17 Apr 2013 15:06:16 +0200
Subject: [R-sig-Geo] Distance converted in koordinates
Message-ID: <CACje6_ZWqg-24s+rgNAzRWCuYGFwTJraXEb4xZ7brxeSe8_g8g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130417/23cac914/attachment.pl>

From monica at uac.pt  Wed Apr 17 15:13:50 2013
From: monica at uac.pt (=?iso-8859-1?Q?M=F3nica_Cordeiro_de_Almeida_e_Silva?=)
Date: Wed, 17 Apr 2013 13:13:50 -0000
Subject: [R-sig-Geo] drawing ellipses to display uncertainty around
	estimates of animal locations
Message-ID: <A9861AB2E33A7D43BB8566F0BEF89DD7012E1D14@PDLEXCH.uac.pt>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130417/0919f36e/attachment.pl>

From lucianolasala at yahoo.com.ar  Wed Apr 17 16:29:34 2013
From: lucianolasala at yahoo.com.ar (Luciano La Sala)
Date: Wed, 17 Apr 2013 11:29:34 -0300
Subject: [R-sig-Geo] How to account for spatial autocorrelation
Message-ID: <008c01ce3b77$fcff9b80$f6fed280$@com.ar>

Dear experts, 

I have a dataset which consists of 450 observations (cattle rising ranches)
from a survey made in two different provinces. Each ranch was classified as
diseases (1) / not diseased (0) based on diagnostic testing for certain
health event made only on some fraction of the cattle from each ranch. 
My independent variables are 1) total heads in ranch, 2) total cattle in
ranch. My data looks like this:

Department    Province     Lat     Long    Total_heads Total_cattle
Disease_status 
Atreuco       La Pampa     -36.97  -63.73         1900          600        0

Atreuco       La Pampa     -37.19  -63.69         2340          200        0

Atreuco       La Pampa     -37.20  -63.45         3200          150        1

BuenosAires   BuenosAires  -37.18  -63.44         1000          230        1

BuenosAires   BuenosAires  -37.08  -64.03         2300           85        0

  
Starting from a fixed-effects, only-intercept logistic model, none of the
independent variables improved the model fit, which leaves me with a null
model as the best fitting one. 

Looking at a semivariogram of the standardized residuals versus distance,
model residuals seem to be autocorrelated. A missing covariate may the
reason behind residual autocorrelation. To prove the existence of residual
autocorrelation, I want to add different covariance structures to the null
model and compare the likelihoods of these models. As far as I know, adding
spatial correlation structures requires using the nlme package, and
the?lme?command needs a grouping variable (which my data lack). Therefore, I
created a?dummy?variable that has the same value for all 450 observations
and specified my mixed-effect null model as follows:  

dummy <- rep(1, 450)
my.data <- cbind(my.data, dummy)

null.model <- lme(fixed = Disease_status ~ 1, data = my.data, random = ~ 1 |
dummy, method = "ML")
summary(null.model)

Linear mixed-effects model fit by maximum likelihood
 Data: Data.new 
       AIC      BIC    logLik
  454.3587 466.6798 -224.1793

Random effects:
 Formula: ~1 | dummy
         (Intercept)  Residual
StdDev: 6.979292e-06 0.3986575

Fixed effects: Estatus_campo ~ 1 
                Value Std.Error  DF  t-value p-value
(Intercept) 0.1982183 0.0188348 448 10.52405       0

Standardized Within-Group Residuals:
       Min         Q1        Med         Q3        Max 
-0.4972145 -0.4972145 -0.4972145 -0.4972145  2.0112046 

Number of Observations: 449
Number of Groups: 1

The above model without a covariance structure would represent the baseline
likelihood, which I hoped to improve with information about the spatial
structure of the data.?When I tried to update my null model to include an
exponential spatial correlation structure and see if the model with spatial
correlation fits better than one without, an error message pops up:

exp.sp <- update(null.model, correlation = corExp(1, form = ~ Long + Lat),
method = "ML")
summary(exp.sp)

Error in getCovariate.corSpatial(object, data = data) : cannot have zero
distances in "corSpatial"

Question: what is the cause behind this error and how can I solve it?

Thank you very much in advance! 

Luciano La Sala 


From mauricioandresvela at gmail.com  Wed Apr 17 17:35:44 2013
From: mauricioandresvela at gmail.com (mauvela)
Date: Wed, 17 Apr 2013 08:35:44 -0700 (PDT)
Subject: [R-sig-Geo] interpolation with missing values
Message-ID: <1366212944386-7583335.post@n2.nabble.com>

I need to interpolate some data  about PM10 for some location (schools). I
have daily data and about 50 stations. I have to interpolate for every day 
but my problems comes with the missing values of many stations in many days.
For example for one day I could have data for 10 stations while for other
day data from 50. When ignoring these missing data and interpolating using
ordinary kriging for each day, the results for each school varies a lot
depending of which stations have available data. For example a school near
one station changes a lot when that station have missing in one day. What
should be the best way to deal with this missing values, is there a method
for imputation that takes into account the temporal and the spatial
variability of the data?

Thank you



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/interpolation-with-missing-values-tp7583335.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From b.rowlingson at lancaster.ac.uk  Wed Apr 17 19:09:38 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed, 17 Apr 2013 18:09:38 +0100
Subject: [R-sig-Geo] interpolation with missing values
In-Reply-To: <d95f8aff143e4820926a4a0543e18f73@EX-1-HT0.lancs.local>
References: <d95f8aff143e4820926a4a0543e18f73@EX-1-HT0.lancs.local>
Message-ID: <CANVKczO0JV1mN-rmAT7kW7JQmov+P+UP1UPPCtchAc7p60Kzpg@mail.gmail.com>

On Wed, Apr 17, 2013 at 4:35 PM, mauvela <mauricioandresvela at gmail.com> wrote:
> I need to interpolate some data  about PM10 for some location (schools). I
> have daily data and about 50 stations. I have to interpolate for every day
> but my problems comes with the missing values of many stations in many days.
> For example for one day I could have data for 10 stations while for other
> day data from 50. When ignoring these missing data and interpolating using
> ordinary kriging for each day, the results for each school varies a lot
> depending of which stations have available data. For example a school near
> one station changes a lot when that station have missing in one day. What
> should be the best way to deal with this missing values, is there a method
> for imputation that takes into account the temporal and the spatial
> variability of the data?

 Off the top of my head, do multiple imputations of the missing values
based on the mean and sd of the values at that site when not missing.
You'll then end up with a number (100, say) of kriged maps. You can
probably then take the mean over those as your map and for the
variance you'll have to combine the kriging variance with the
imputation variance...

 This is probably valid assuming the dropouts are random... Also, it
doesn't take into account any temporal correlation which might get you
a better estimate of your imputed values...

 What you do may also depend on what you are doing with the data. If
its just to produce pretty maps, then you might not need something so
sophisticated. If you are computing the number of days that PM10 in
some location exceeds some threshold, then you may have to give it
some more thought...

Barry


From edzer.pebesma at uni-muenster.de  Wed Apr 17 19:53:05 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 17 Apr 2013 19:53:05 +0200
Subject: [R-sig-Geo] interpolation with missing values
In-Reply-To: <CANVKczO0JV1mN-rmAT7kW7JQmov+P+UP1UPPCtchAc7p60Kzpg@mail.gmail.com>
References: <d95f8aff143e4820926a4a0543e18f73@EX-1-HT0.lancs.local>
	<CANVKczO0JV1mN-rmAT7kW7JQmov+P+UP1UPPCtchAc7p60Kzpg@mail.gmail.com>
Message-ID: <516EE181.6090703@uni-muenster.de>



On 04/17/2013 07:09 PM, Barry Rowlingson wrote:
> On Wed, Apr 17, 2013 at 4:35 PM, mauvela <mauricioandresvela at gmail.com> wrote:
>> I need to interpolate some data  about PM10 for some location (schools). I
>> have daily data and about 50 stations. I have to interpolate for every day
>> but my problems comes with the missing values of many stations in many days.
>> For example for one day I could have data for 10 stations while for other
>> day data from 50. When ignoring these missing data and interpolating using
>> ordinary kriging for each day, the results for each school varies a lot
>> depending of which stations have available data. For example a school near
>> one station changes a lot when that station have missing in one day. What
>> should be the best way to deal with this missing values, is there a method
>> for imputation that takes into account the temporal and the spatial
>> variability of the data?
> 
>  Off the top of my head, do multiple imputations of the missing values
> based on the mean and sd of the values at that site when not missing.
> You'll then end up with a number (100, say) of kriged maps. You can
> probably then take the mean over those as your map and for the
> variance you'll have to combine the kriging variance with the
> imputation variance...
> 
>  This is probably valid assuming the dropouts are random... Also, it
> doesn't take into account any temporal correlation which might get you
> a better estimate of your imputed values...
> 
>  What you do may also depend on what you are doing with the data. If
> its just to produce pretty maps, then you might not need something so
> sophisticated. If you are computing the number of days that PM10 in
> some location exceeds some threshold, then you may have to give it
> some more thought...
> 

Maybe try spatio-temporal interpolation?

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From clint at ecy.wa.gov  Wed Apr 17 20:33:36 2013
From: clint at ecy.wa.gov (Clint Bowman)
Date: Wed, 17 Apr 2013 11:33:36 -0700 (PDT)
Subject: [R-sig-Geo] interpolation with missing values
In-Reply-To: <516EE181.6090703@uni-muenster.de>
References: <d95f8aff143e4820926a4a0543e18f73@EX-1-HT0.lancs.local>
	<CANVKczO0JV1mN-rmAT7kW7JQmov+P+UP1UPPCtchAc7p60Kzpg@mail.gmail.com>
	<516EE181.6090703@uni-muenster.de>
Message-ID: <alpine.LRH.2.03.1304171132090.9972@ecy.wa.gov>

Interesting paper in the June 2013 Atmospheric Environment, "Time-space 
Kriging to address the spatiotemporal misalignment in the large datasets" 
<http://waesearch.kobv.de/uid.do?query=rss_feeds_2403984&ref=feed>

Clint Bowman			INTERNET:	clint at ecy.wa.gov
Air Quality Modeler		INTERNET:	clint at math.utah.edu
Department of Ecology		VOICE:		(360) 407-6815
PO Box 47600			FAX:		(360) 407-7534
Olympia, WA 98504-7600

         USPS:           PO Box 47600, Olympia, WA 98504-7600
         Parcels:        300 Desmond Drive, Lacey, WA 98503-1274

On Wed, 17 Apr 2013, Edzer Pebesma wrote:

>
>
> On 04/17/2013 07:09 PM, Barry Rowlingson wrote:
>> On Wed, Apr 17, 2013 at 4:35 PM, mauvela <mauricioandresvela at gmail.com> wrote:
>>> I need to interpolate some data  about PM10 for some location (schools). I
>>> have daily data and about 50 stations. I have to interpolate for every day
>>> but my problems comes with the missing values of many stations in many days.
>>> For example for one day I could have data for 10 stations while for other
>>> day data from 50. When ignoring these missing data and interpolating using
>>> ordinary kriging for each day, the results for each school varies a lot
>>> depending of which stations have available data. For example a school near
>>> one station changes a lot when that station have missing in one day. What
>>> should be the best way to deal with this missing values, is there a method
>>> for imputation that takes into account the temporal and the spatial
>>> variability of the data?
>>
>>  Off the top of my head, do multiple imputations of the missing values
>> based on the mean and sd of the values at that site when not missing.
>> You'll then end up with a number (100, say) of kriged maps. You can
>> probably then take the mean over those as your map and for the
>> variance you'll have to combine the kriging variance with the
>> imputation variance...
>>
>>  This is probably valid assuming the dropouts are random... Also, it
>> doesn't take into account any temporal correlation which might get you
>> a better estimate of your imputed values...
>>
>>  What you do may also depend on what you are doing with the data. If
>> its just to produce pretty maps, then you might not need something so
>> sophisticated. If you are computing the number of days that PM10 in
>> some location exceeds some threshold, then you may have to give it
>> some more thought...
>>
>
> Maybe try spatio-temporal interpolation?
>
> -- 
> Edzer Pebesma
> Institute for Geoinformatics (ifgi), University of M?nster
> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
> 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
> http://www.52north.org/geostatistics      e.pebesma at wwu.de
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

From ptitle at umich.edu  Wed Apr 17 22:15:41 2013
From: ptitle at umich.edu (Pascal Title)
Date: Wed, 17 Apr 2013 16:15:41 -0400
Subject: [R-sig-Geo] closest points between 2 polygons
Message-ID: <CAPSA=yfdDe5afw9wtyaBGNPE-tQGW-z56TfHAM2Tpp1quNZV=w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130417/0e9da95c/attachment.pl>

From edzer.pebesma at uni-muenster.de  Wed Apr 17 23:44:34 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 17 Apr 2013 23:44:34 +0200
Subject: [R-sig-Geo] closest points between 2 polygons
In-Reply-To: <CAPSA=yfdDe5afw9wtyaBGNPE-tQGW-z56TfHAM2Tpp1quNZV=w@mail.gmail.com>
References: <CAPSA=yfdDe5afw9wtyaBGNPE-tQGW-z56TfHAM2Tpp1quNZV=w@mail.gmail.com>
Message-ID: <516F17C2.8000907@uni-muenster.de>

This may not be the most elegant solution. We seek the nearest points in
the first and tenth polygon of the nc sids data set:

library(maptools)
xx <- readShapePoly(system.file("shapes/sids.shp", package="maptools")[1])
proj4string(xx) = CRS("+proj=longlat +ellps=clrk66")
asPts = function(x) as(as(x, "SpatialLines"), "SpatialPoints")
pol1 = xx[1,]; pol2 = xx[10,]
d = spDists(asPts(pol1), asPts(pol2))
w = which(d == min(d), arr.ind = TRUE)
asPts(pol1)[w[1,1],]
asPts(pol2)[w[1,2],]

# or

coordinates(asPts(pol1)[w[1,1],])
coordinates(asPts(pol2)[w[1,2],])

On 04/17/2013 10:15 PM, Pascal Title wrote:
> I have two polygons and I would like to know the coordinates of the closest
> points, where one is found on each polygon. I know how to get the shortest
> distance between two polygons, with gDistance from the rgeos package, but I
> guess I would like to know the coordinates that this distance is calculated
> from.
> 
> Any ideas?
> 
> thanks!
> -Pascal
> 
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From Bastien.Ferland-Raymond at mrn.gouv.qc.ca  Thu Apr 18 14:39:15 2013
From: Bastien.Ferland-Raymond at mrn.gouv.qc.ca (Bastien.Ferland-Raymond at mrn.gouv.qc.ca)
Date: Thu, 18 Apr 2013 08:39:15 -0400
Subject: [R-sig-Geo] closest points between 2 polygons
In-Reply-To: <mailman.11.1366279204.20899.r-sig-geo@r-project.org>
Message-ID: <161DC602615F6943A19BAEA3DBF2E4B901AE76B75CE2@HARFANG.intranet.mrn.gouv>

Hello,

I don't have a clear solution for your problem, but I'll try to give you ideas to where to look that may help you.  If I understand well your problem, the difficulty comes from the fact that you have two POLYGONS and that you are looking for the COORDINATES.

You could transform your polygons in polylines with something like:

####
polygon2polyline <- function(poly.shape) {                                                          # On donne un object de classe SpatialPolygonsDataFrame
coo <- lapply((slot(poly.shape,"polygons")),function(xx) lapply(xx at Polygons, slot, "coords"))       # Sort les coordonn?es des polygones
IDs <- sapply(slot(poly.shape, "polygons"), slot, "ID")                                             # Sort les IDs des polygons

shape.line <- vector(mode="list",length=length(coo))                                                # boucle qui cr?e la liste de Lines.  Pourrait ?tre chang? par un Lapply si on trouve le moyen de g?rer les IDs
for (i in 1:length(coo)){
shape.line[[i]] <- Lines(lapply(coo[[i]], Line),ID=IDs[i])
}
shape <- SpatialLinesDataFrame(SpatialLines(shape.line,proj4string = CRS(proj4string(poly.shape))), data=poly.shape at data)  # Cr?e la nouvelle shape de lignes
shape                                                                                               # sort un object de classe SpatialLinesDataFrame
}
####

Than, using polylines may help with some functions like:  dist2line() from the geosphere package.  There is also some homemade function that do a similar task available at: http://geotux.tuxfamily.org/index.php/en/geo-blogs/item/296-snapping-points-to-lines-in-r

However, both of those functions require a line and a point...   You have two lines.  Maybe you can modify them?

Another idea, which would not give you the real answer but close and requires tons of computing power so it may not help you much is to use the costDistance() function of gdistance.

1) you transform both your polygons to lines,
2) you select one of the polygon,
3) you rasterize it, finer is better,
4) you calculate the costDistance from this raster,
5) you superpose the second polygons on the costDistance raster,
6) you identify every cell from the raster that touches the line of the second polygon,
7) you identify the cell with the minimum distance.  The coordinates from the second polygon that is the closest to the first polygon is there.
8) inverse the process or use the functions proposed before to identify the closest point from the first polygon.

As I said, it's very complicated for what should be a simple task, however it's the best I can think of right now.

Good luck,

Bastien Ferland-Raymond


From Rainer at krugs.de  Thu Apr 18 15:16:44 2013
From: Rainer at krugs.de (Rainer M. Krug)
Date: Thu, 18 Apr 2013 15:16:44 +0200
Subject: [R-sig-Geo] warnings and errors from grass to R via spgrass6GG
In-Reply-To: <87vc7lbr8l.fsf@krugs.de> (Rainer M. Krug's message of "Wed, 17
	Apr 2013 08:40:20 +0200")
References: <87zjwybjt5.fsf@krugs.de>
	<alpine.LRH.2.03.1304161801360.14909@reclus.nhh.no>
	<87vc7lbr8l.fsf@krugs.de>
Message-ID: <87r4i80yir.fsf@krugs.de>

Rainer at krugs.de (Rainer M. Krug) writes:

> Roger Bivand <Roger.Bivand at nhh.no> writes:
>
>> On Tue, 16 Apr 2013, Rainer M. Krug wrote:
>>
>>> Hi
>>>
>>> I am using spgrass6 with grass 7 and can report that it works so far
>>> without problems.
>>>
>>> Nevertheless, I have one question, which I already had about grass 6.
>>>
>>> I am using execGRASS to execute grass commands as well as an own defined
>>> function r.mapcalc [1].
>>>
>>> Now as these are used in a simulation script, I would like to (actually
>>> need to know) when these functions fail.
>>
>> Rainer:
>>
>> Could you please create a simple test case with some built-in data set
>> and initGRASS()? I see from ?system that some cases are addressed, but
>> with intern=TRUE.
>
> I'll investigate further and will send some examples using the spearhead
> dataset.

Hi Roger

one example is simply the following:

,----
| >  execGRASS(
|         "r.stats",
|         input = "fire_blocksgg",
|         flags = c("C", "n"),
|         intern = TRUE)
| + + + + ERROR: Raster map <fire_blocksgg> not found
| character(0)
| attr(,"status")
| [1] 1
| Warning message:
| running command 'r.stats -C -n input=fire_blocksgg' had status 1 
| > 
`----

here the error on grass side becomes translated into a warning. Changing
intern=FALSE results in no warning.

Lat me know if you would like to have more examples.

Cheers,

Rainer


>
> Thanks,
>
> Rainer
>
>>
>> Roger
>>
>>>
>>> Is there a way that errors and warnings in GRASS will be reflected as
>>> errors and warnings in R when tthe grass function is called via execGRASS?
>>>
>>> I am using Linux and R 3.0.0
>>>
>>> Thanks,
>>>
>>> Rainer
>>>
>>>
>>> Footnotes:
>>> [1] r.mapcalc is defined as follow:
>>> --8<---------------cut here---------------start------------->8---
>>> r.mapcalc <- function(
>>>    ...,
>>>    intern = TRUE,
>>>    ignore.stderr = !options("asmDebug")[[1]],
>>>    feedback = TRUE,
>>>    flags = NULL
>>>    ) {
>>>    comm <- paste( "r.mapcalc ", " \"", ..., "\" ", sep="" )
>>>    if (!is.null(flags)) {
>>>      flags <- paste0("--", flags, collapse=" ")
>>>    }
>>>    comm <- paste(comm, flags)
>>>    if (feedback) print(comm)
>>>    system( comm, intern=intern, ignore.stderr=ignore.stderr )
>>>  }
>>> --8<---------------cut here---------------end--------------->8---
>>>
>>>
>>>
>>>
>>>
>>>
> <#secure method=pgpmime mode=sign>
>
<#secure method=pgpmime mode=sign>

-- 
Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation Biology, UCT), Dipl. Phys. (Germany)

Centre of Excellence for Invasion Biology
Stellenbosch University
South Africa

Tel :       +33 - (0)9 53 10 27 44
Cell:       +33 - (0)6 85 62 59 98
Fax :       +33 - (0)9 58 10 27 44

Fax (D):    +49 - (0)3 21 21 25 22 44

email:      Rainer at krugs.de

Skype:      RMkrug


From arudolph at PIRE.org  Thu Apr 18 15:18:28 2013
From: arudolph at PIRE.org (Abby Rudolph)
Date: Thu, 18 Apr 2013 09:18:28 -0400
Subject: [R-sig-Geo] driving distance between coordinates in minutes and
	miles
Message-ID: <0F5A69EADAE27F44B09561937B83C3A4604E29A449@MDMBX.PIRE.org>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130418/ee63150d/attachment.pl>

From seth at swbigelow.net  Thu Apr 18 18:03:41 2013
From: seth at swbigelow.net (Seth Bigelow)
Date: Thu, 18 Apr 2013 12:03:41 -0400
Subject: [R-sig-Geo] make polygons transparent in plotKML
Message-ID: <000001ce3c4e$4cf5dce0$e6e196a0$@net>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130418/601e9d37/attachment.pl>

From r.hijmans at gmail.com  Thu Apr 18 19:28:26 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 18 Apr 2013 10:28:26 -0700
Subject: [R-sig-Geo] closest points between 2 polygons
In-Reply-To: <161DC602615F6943A19BAEA3DBF2E4B901AE76B75CE2@HARFANG.intranet.mrn.gouv>
References: <mailman.11.1366279204.20899.r-sig-geo@r-project.org>
	<161DC602615F6943A19BAEA3DBF2E4B901AE76B75CE2@HARFANG.intranet.mrn.gouv>
Message-ID: <CANtt_hxzjKPdumPNhh96asFziwfDOHoHQd=Jdjk6DPkXsUBoag@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130418/e8a9b545/attachment.pl>

From endri81 at gmail.com  Thu Apr 18 19:32:55 2013
From: endri81 at gmail.com (Endri Raco)
Date: Thu, 18 Apr 2013 19:32:55 +0200
Subject: [R-sig-Geo] (no subject)
Message-ID: <CACje6_b+McfLnDcmmkKuKMBSfx8zePmQ0Ox06mFSjnf73Q-uzA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130418/6b81d242/attachment.pl>

From endri81 at gmail.com  Thu Apr 18 19:33:52 2013
From: endri81 at gmail.com (Endri Raco)
Date: Thu, 18 Apr 2013 19:33:52 +0200
Subject: [R-sig-Geo] How to calculate the latlng of a point in a certain
 distance away from another?
Message-ID: <CACje6_ZAUHcCS7E2LgTZJSM2Dx6KqP+OskwQh+ttd0S3a0p62A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130418/19987bd3/attachment.pl>

From roman.lustrik at gmail.com  Thu Apr 18 19:45:07 2013
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Thu, 18 Apr 2013 19:45:07 +0200
Subject: [R-sig-Geo] (no subject)
In-Reply-To: <CACje6_b+McfLnDcmmkKuKMBSfx8zePmQ0Ox06mFSjnf73Q-uzA@mail.gmail.com>
References: <CACje6_b+McfLnDcmmkKuKMBSfx8zePmQ0Ox06mFSjnf73Q-uzA@mail.gmail.com>
Message-ID: <CAHT1vpijbvASmW9q1LDXXyy5deCj94KaBE=nH8JF4naB9jPNnw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130418/2ff584f3/attachment.pl>

From endri81 at gmail.com  Thu Apr 18 19:51:45 2013
From: endri81 at gmail.com (Endri Raco)
Date: Thu, 18 Apr 2013 19:51:45 +0200
Subject: [R-sig-Geo] (no subject)
In-Reply-To: <CACje6_bdqryCd6J5Uja9Lc56qc+DrfwZPmQcChbm=aO4+cNM6Q@mail.gmail.com>
References: <CACje6_b+McfLnDcmmkKuKMBSfx8zePmQ0Ox06mFSjnf73Q-uzA@mail.gmail.com>
	<CAHT1vpijbvASmW9q1LDXXyy5deCj94KaBE=nH8JF4naB9jPNnw@mail.gmail.com>
	<CACje6_bdqryCd6J5Uja9Lc56qc+DrfwZPmQcChbm=aO4+cNM6Q@mail.gmail.com>
Message-ID: <CACje6_a6+NFOoOQr0WShEFN6ckP6aRYtBRCJgafeS1A=O_MkUQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130418/977cc278/attachment.pl>

From ashton at msu.edu  Thu Apr 18 20:28:24 2013
From: ashton at msu.edu (Ashton Shortridge)
Date: Thu, 18 Apr 2013 14:28:24 -0400
Subject: [R-sig-Geo] How to calculate the latlng of a point in a certain
	distance away from another?
In-Reply-To: <CACje6_ZAUHcCS7E2LgTZJSM2Dx6KqP+OskwQh+ttd0S3a0p62A@mail.gmail.com>
References: <CACje6_ZAUHcCS7E2LgTZJSM2Dx6KqP+OskwQh+ttd0S3a0p62A@mail.gmail.com>
Message-ID: <201304181428.24757.ashton@msu.edu>

Dear Endri,

do you simply wish to simulate coordinates for these locations? Because, 
assuming you are working on a planar system and those distances are euclidean, 
each of those distances is a radius for an infinite number of locations on a 
circle around your bus stop. 

Code like this might then do what you want:

simCoords <- function(origin, dist) {
    # 'origin' is a 2-element vector (x,y) of the starting coordinate
    # 'dist' is the distance of the offset from this origin to simulate
    
    # simulate an angle in radians
    alpha <- runif(1,-pi,pi)
    
    # Calculate x and y offsets
    yoff <- dist * sin(alpha)
    xoff <- dist * cos(alpha)
    
    # Add offsets to origin, return a vector coordinate
    return (c(origin[1] + xoff, origin[2] + yoff))
}

# Simple function test
simCoords(c(0,0), 10)

# Graphical test of the function
plot(0,0, xlim=c(-15,15), ylim=c(-15,15), main='This had better look like a 
circle!')
for (i in 1:1000) {
    pt <- simCoords(c(0,0), 10)
    points(pt[1], pt[2])
}
    
# Test using your distances
distances <- c(0.00000000,  0.02725136,  1.07634471, 1.15963225,  
1.71421571,  2.54945626, 4.29135102,  4.53532958,  4.58512710,  4.86466833,  
5.24266630,  5.63505465)

exampleCoords <- lapply(distances, simCoords, origin=c(0,0))
plot(0,0, xlim=c(-10,10), ylim=c(-10,10), pch=2, col='blue', cex=2, 
main='Points near a bus stop')
for (p in 1:length(exampleCoords)) {
    points(exampleCoords[p][[1]][1],exampleCoords[p][[1]][2])
}

# A final test: plotting many, many simulations should look like a map of 
nested circles
plot(0,0, xlim=c(-10,10), ylim=c(-10,10), pch=2, col='blue', cex=2, 
main='Points near a bus stop, nsim=200\nThis should look like a bunch of 
nested circles!')
for (i in 1:200) {
    exampleCoords <- lapply(distances, simCoords, origin=c(0,0))
    for (p in 1:length(exampleCoords)) {
        points(exampleCoords[p][[1]][1],exampleCoords[p][[1]][2], cex=0.4)
    }
}


Hope this helps,

Ashton

On 04/18/13, Endri Raco, wrote:
> Hi group,
> I am stacked in a problem like this.
> I have a bus stop with known coordinates.
> I generate in R language distances from this bus stop. Values of these
> distances are like below
> (in km)
> 
> 
> 0.00000000  0.02725136  1.07634471  1.15963225  1.71421571  2.54945626
> 4.29135102  4.53532958  4.58512710  4.86466833  5.24266630  5.63505465
> 
> I need to convert this distances in coordinates in order to reflect
> points in map which are these distances far from starting bus stop.
> 
> 
> 
> Any ideas about this?
> 
> Please help
> 
> Regards
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


-----
Ashton Shortridge
Associate Professor			ashton at msu.edu
Dept of Geography			http://www.msu.edu/~ashton
235 Geography Building		ph (517) 432-3561
Michigan State University		fx (517) 432-1671


From endri81 at gmail.com  Thu Apr 18 20:41:58 2013
From: endri81 at gmail.com (Endri Raco)
Date: Thu, 18 Apr 2013 20:41:58 +0200
Subject: [R-sig-Geo] How to calculate the latlng of a point in a certain
 distance away from another?
In-Reply-To: <201304181428.24757.ashton@msu.edu>
References: <CACje6_ZAUHcCS7E2LgTZJSM2Dx6KqP+OskwQh+ttd0S3a0p62A@mail.gmail.com>
	<201304181428.24757.ashton@msu.edu>
Message-ID: <CACje6_Yz==9=TGuaPhcQgBp7aWvoz4WRjXi6Fr12iPAsRUtMSQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130418/b1964ea4/attachment.pl>

From ashton at msu.edu  Thu Apr 18 21:07:59 2013
From: ashton at msu.edu (Ashton Shortridge)
Date: Thu, 18 Apr 2013 15:07:59 -0400
Subject: [R-sig-Geo] How to calculate the latlng of a point in a certain
	distance away from another?
In-Reply-To: <CACje6_Yz==9=TGuaPhcQgBp7aWvoz4WRjXi6Fr12iPAsRUtMSQ@mail.gmail.com>
References: <CACje6_ZAUHcCS7E2LgTZJSM2Dx6KqP+OskwQh+ttd0S3a0p62A@mail.gmail.com>
	<201304181428.24757.ashton@msu.edu>
	<CACje6_Yz==9=TGuaPhcQgBp7aWvoz4WRjXi6Fr12iPAsRUtMSQ@mail.gmail.com>
Message-ID: <201304181507.59896.ashton@msu.edu>

Hi Endri,

I assumed your distances were in a planar coordinate system. "Distances" in 
decimal degrees don't really make sense, as decimal degrees are a spherical 
system and distances need to be calculated and handled differently.

The results you got with:
simCoords(p,500)
[1] 125.7413 512.6246

got you a location 500 units away (on a cartesian plane) from that initial 
coordinate, but of course it's not a valid location on the earth's surface. 
You could of course simulate a location "1 degree away" and get a coordinate 
that wouldn't look unreasonable, but it wouldn't really be correct.

The second code you included looks pretty jumbled in email. I've attached the 
original script rather than pasting the code inline this time. Maybe that will 
work better. It works fine on my R install, pasted to the command line. Vanilla 
R, no extensions needed.

Ashton

On 04/18/13, Endri Raco, wrote:
> Thanx Ashton,
> 
> Experimenting on a starting point from Google maps
>  p<-c(41.32217,19.802721)
> 
> > simCoords(p,500)[1] 125.7413 512.6246.
> 
> I suppose these are in radians and need to be converted?
> 
> using
> 
> > distances <- c(0.00000000,  0.02725136,  1.07634471, 1.15963225,+        
> >        1.71421571,  2.54945626, 4.29135102,  4.53532958,  4.58512710, 
> > 4.86466833,+                5.24266630,  5.63505465)> > exampleCoords <-
> > lapply(distances, simCoords, origin=c(41.32217,19.802721))>
> > plot(41.32217,19.802721, xlim=c(-10,10), ylim=c(-10,10), pch=2,
> > col='blue', cex=2,+      main='Points near a bus stop')> for (p in
> > 1:length(exampleCoords)) {+    
> > points(exampleCoords[p][[1]][1],exampleCoords[p][[1]][2])+ }
> 
> I still dont get any results.
> 
> What I am doing wrong?
> 
> Please help me understand.
> 
> Regards
> 
> On Thu, Apr 18, 2013 at 8:28 PM, Ashton Shortridge <ashton at msu.edu> 
wrote:
> > Dear Endri,
> > 
> > do you simply wish to simulate coordinates for these locations? Because,
> > assuming you are working on a planar system and those distances are
> > euclidean,
> > each of those distances is a radius for an infinite number of locations
> > on a
> > circle around your bus stop.
> > 
> > Code like this might then do what you want:
> > 
> > simCoords <- function(origin, dist) {
> > 
> >     # 'origin' is a 2-element vector (x,y) of the starting coordinate
> >     # 'dist' is the distance of the offset from this origin to simulate
> >     
> >     # simulate an angle in radians
> >     alpha <- runif(1,-pi,pi)
> >     
> >     # Calculate x and y offsets
> >     yoff <- dist * sin(alpha)
> >     xoff <- dist * cos(alpha)
> >     
> >     # Add offsets to origin, return a vector coordinate
> >     return (c(origin[1] + xoff, origin[2] + yoff))
> > 
> > }
> > 
> > # Simple function test
> > simCoords(c(0,0), 10)
> > 
> > # Graphical test of the function
> > plot(0,0, xlim=c(-15,15), ylim=c(-15,15), main='This had better look like
> > a circle!')
> > for (i in 1:1000) {
> > 
> >     pt <- simCoords(c(0,0), 10)
> >     points(pt[1], pt[2])
> > 
> > }
> > 
> > # Test using your distances
> > distances <- c(0.00000000,  0.02725136,  1.07634471, 1.15963225,
> > 1.71421571,  2.54945626, 4.29135102,  4.53532958,  4.58512710, 
> > 4.86466833, 5.24266630,  5.63505465)
> > 
> > exampleCoords <- lapply(distances, simCoords, origin=c(0,0))
> > plot(0,0, xlim=c(-10,10), ylim=c(-10,10), pch=2, col='blue', cex=2,
> > main='Points near a bus stop')
> > for (p in 1:length(exampleCoords)) {
> > 
> >     points(exampleCoords[p][[1]][1],exampleCoords[p][[1]][2])
> > 
> > }
> > 
> > # A final test: plotting many, many simulations should look like a map of
> > nested circles
> > plot(0,0, xlim=c(-10,10), ylim=c(-10,10), pch=2, col='blue', cex=2,
> > main='Points near a bus stop, nsim=200\nThis should look like a bunch of
> > nested circles!')
> > for (i in 1:200) {
> > 
> >     exampleCoords <- lapply(distances, simCoords, origin=c(0,0))
> >     for (p in 1:length(exampleCoords)) {
> >     
> >         points(exampleCoords[p][[1]][1],exampleCoords[p][[1]][2],
> >         cex=0.4)
> >     
> >     }
> > 
> > }
> > 
> > 
> > Hope this helps,
> > 
> > Ashton
> > 
> > On 04/18/13, Endri Raco, wrote:
> > > Hi group,
> > > I am stacked in a problem like this.
> > > I have a bus stop with known coordinates.
> > > I generate in R language distances from this bus stop. Values of these
> > > distances are like below
> > > (in km)
> > > 
> > > 
> > > 0.00000000  0.02725136  1.07634471  1.15963225  1.71421571  
2.54945626
> > > 4.29135102  4.53532958  4.58512710  4.86466833  5.24266630  
5.63505465
> > > 
> > > I need to convert this distances in coordinates in order to reflect
> > > points in map which are these distances far from starting bus stop.
> > > 
> > > 
> > > 
> > > Any ideas about this?
> > > 
> > > Please help
> > > 
> > > Regards
> > > 
> > >       [[alternative HTML version deleted]]
> > > 
> > > _______________________________________________
> > > R-sig-Geo mailing list
> > > R-sig-Geo at r-project.org
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > 
> > -----
> > Ashton Shortridge
> > Associate Professor                     ashton at msu.edu
> > Dept of Geography                       http://www.msu.edu/~ashton
> > 235 Geography Building          ph (517) 432-3561
> > Michigan State University               fx (517) 432-1671


-----
Ashton Shortridge
Associate Professor			ashton at msu.edu
Dept of Geography			http://www.msu.edu/~ashton
235 Geography Building		ph (517) 432-3561
Michigan State University		fx (517) 432-1671
-------------- next part --------------
# simCoords.R
# Based on a response to the R spatial mailing list, asking
# for help generating coordinates from a vector of distances from an origin.
# written by A. Shortridge, 4/2013

simCoords <- function(origin, dist) {
    # Origin is a 2-element vector (x,y) of the starting coordinate
    # dist is the distance of the offset from this origin to simulate
    
    # simulate an angle in radians
    alpha <- runif(1,-pi,pi)
    
    # Calculate x and y offsets
    yoff <- dist * sin(alpha)
    xoff <- dist * cos(alpha)
    
    # Add offsets to origin, return a vector coordinate
    return (c(origin[1] + xoff, origin[2] + yoff))
}

# Simple function test
simCoords(c(0,0), 10)

# Graphical test of the function
plot(0,0, xlim=c(-15,15), ylim=c(-15,15))
for (i in 1:1000) {
    pt <- simCoords(c(0,0), 10)
    points(pt[1], pt[2])
}

# Test of your distances
distances <- c(0.00000000,  0.02725136,  1.07634471, 1.15963225,  1.71421571,  2.54945626, 4.29135102,  4.53532958,  4.58512710,  4.86466833,  5.24266630,  5.63505465)

exampleCoords <- lapply(distances, simCoords, origin=c(0,0))
plot(0,0, xlim=c(-10,10), ylim=c(-10,10), pch=2, col='blue', cex=2, main='Points near a bus stop')
for (p in 1:length(exampleCoords)) {
    points(exampleCoords[p][[1]][1],exampleCoords[p][[1]][2])
}

# A final test: plotting many, many simulations should look like a map of nested circles
plot(0,0, xlim=c(-10,10), ylim=c(-10,10), pch=2, col='blue', cex=2, main='Points near a bus stop, nsim=200\nThis should look like a bunch of nested circles!')
for (i in 1:200) {
    exampleCoords <- lapply(distances, simCoords, origin=c(0,0))
    for (p in 1:length(exampleCoords)) {
        points(exampleCoords[p][[1]][1],exampleCoords[p][[1]][2], cex=0.4)
    }
}



From macqueen1 at llnl.gov  Thu Apr 18 21:19:24 2013
From: macqueen1 at llnl.gov (MacQueen, Don)
Date: Thu, 18 Apr 2013 19:19:24 +0000
Subject: [R-sig-Geo] make polygons transparent in plotKML
In-Reply-To: <000001ce3c4e$4cf5dce0$e6e196a0$@net>
Message-ID: <5E1B812FAC2C4A49B3D99593B5A521913C88A4@PRDEXMBX-08.the-lab.llnl.gov>

Just a pointer to hopefully get you started:

see ?col2rgb and look at the alpha parameter.

-Don

-- 
Don MacQueen

Lawrence Livermore National Laboratory
7000 East Ave., L-627
Livermore, CA 94550
925-423-1062





On 4/18/13 9:03 AM, "Seth Bigelow" <seth at swbigelow.net> wrote:

>Greetings: 
>
> 
>
>Could anyone advise me how to make transparent polygons in plotKML? I am
>overlaying polygons in a SpatialPolygonsDataFrame object into Google
>Earth -
>Seems I can make the polygons any color (e.g., yellow - see example)
>except
>transparent
>
> 
>
>plotKML(mySPDF, colour_scale ="#FFFF00")
>
> 
>
>Appreciately, Seth Bigelow
>
>
>	[[alternative HTML version deleted]]
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From steven.ranney at gmail.com  Thu Apr 18 22:58:16 2013
From: steven.ranney at gmail.com (Steven Ranney)
Date: Thu, 18 Apr 2013 14:58:16 -0600
Subject: [R-sig-Geo] Create a buffer around a series of Lat-Long pairs
Message-ID: <CANDt99phRgkX598V7Ud7Uo44dcFE3kehXcrN_+a890FyPsodJQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130418/a053b724/attachment.pl>

From r.hijmans at gmail.com  Thu Apr 18 23:08:59 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 18 Apr 2013 14:08:59 -0700
Subject: [R-sig-Geo] Create a buffer around a series of Lat-Long pairs
In-Reply-To: <CANDt99phRgkX598V7Ud7Uo44dcFE3kehXcrN_+a890FyPsodJQ@mail.gmail.com>
References: <CANDt99phRgkX598V7Ud7Uo44dcFE3kehXcrN_+a890FyPsodJQ@mail.gmail.com>
Message-ID: <CANtt_hwt-Ygq=+sNqu5t_YQRTaVS9jHJ759haw2n0bb69Dw5nw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130418/5cb6cb1e/attachment.pl>

From steven.ranney at gmail.com  Thu Apr 18 23:13:56 2013
From: steven.ranney at gmail.com (Steven Ranney)
Date: Thu, 18 Apr 2013 15:13:56 -0600
Subject: [R-sig-Geo] Create a buffer around a series of Lat-Long pairs
In-Reply-To: <CANtt_hwt-Ygq=+sNqu5t_YQRTaVS9jHJ759haw2n0bb69Dw5nw@mail.gmail.com>
References: <CANDt99phRgkX598V7Ud7Uo44dcFE3kehXcrN_+a890FyPsodJQ@mail.gmail.com>
	<CANtt_hwt-Ygq=+sNqu5t_YQRTaVS9jHJ759haw2n0bb69Dw5nw@mail.gmail.com>
Message-ID: <CANDt99q8OCkmZE=jwf3fsx4cGj276yGtRATMCO8PN0czx5UavA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130418/90ffa2b5/attachment.pl>

From juantomas.sayago at gmail.com  Thu Apr 18 23:58:11 2013
From: juantomas.sayago at gmail.com (Juan Tomas Sayago Gomez)
Date: Thu, 18 Apr 2013 17:58:11 -0400
Subject: [R-sig-Geo] closest points between 2 polygons
In-Reply-To: <CANtt_hxzjKPdumPNhh96asFziwfDOHoHQd=Jdjk6DPkXsUBoag@mail.gmail.com>
References: <mailman.11.1366279204.20899.r-sig-geo@r-project.org>
	<161DC602615F6943A19BAEA3DBF2E4B901AE76B75CE2@HARFANG.intranet.mrn.gouv>
	<CANtt_hxzjKPdumPNhh96asFziwfDOHoHQd=Jdjk6DPkXsUBoag@mail.gmail.com>
Message-ID: <CAEOXpNBTqgep+m3sLziYd0ZEtEV_xqNqKv=tZuyH9nKw2ijaFA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130418/3a26bcff/attachment.pl>

From basille at ase-research.org  Fri Apr 19 04:37:39 2013
From: basille at ase-research.org (Mathieu Basille)
Date: Thu, 18 Apr 2013 22:37:39 -0400
Subject: [R-sig-Geo] Help with ENFA in R
In-Reply-To: <1366120782217-7583325.post@n2.nabble.com>
References: <51648FCC.5070809@ase-research.org>
	<1365580744207-7583264.post@n2.nabble.com>
	<51651D48.1080103@oncfs.gouv.fr>
	<1365588123956-7583270.post@n2.nabble.com>
	<1365604778155-7583272.post@n2.nabble.com>
	<51658BF6.7010702@ase-research.org>
	<1365694200318-7583282.post@n2.nabble.com>
	<1366018786679-7583315.post@n2.nabble.com>
	<516BD513.4090904@gmail.com>
	<1366024561215-7583322.post@n2.nabble.com>
	<1366120782217-7583325.post@n2.nabble.com>
Message-ID: <5170ADF3.1070500@ase-research.org>

Jonathan,

I think you are confusing many aspects here...

The ENFA works on two objects:
* a PCA, which provides the environmental data;
* a vector, which provides the utilization distribution.

1) The PCA is build on the "data" slot of a SpatialPixelsDataFrame, which 
stores all environmental rasters. The "data" slot that we use is itself of 
class 'data.frame'.

2) The utilization distribution is based on the presence points and is also 
stored in a SpatialPixelsDataFrame, which gives the number of points per 
pixel. Again, the ENFA only uses the "data" slot of this 
SpatialPixelsDataFrame. Such map can be created with 'count.points' on a 
object of class SpatialPoints or SpatialPointsDataFrame, and also requires 
the former SpatialPixelsDataFrame which stores the environmental attributes 
(this is just to provide a grid for the 'count.points' function).

Please check every object at each step, and provide reproducible examples 
in case you don't manage to get it work. The examples + vignettes of both 
adehabitatHS and sp are in principle sufficient to run an ENFA without any 
problem.

Best of luck,
Mathieu Basille.


Le 04/16/2013 09:59 AM, JonathanAronson a ?crit :
> Hi there
> I have managed to preapre my data finally to do the enfa. However, when I
> run the test I get an error and warning message shown below:
>
> ENFA <- enfa(pc, pr, scannf = FALSE)
> Error in crossprod(Ze, DpZ) : non-conformable arguments
> In addition: Warning messages:
> 1: In x * pr :
>    longer object length is not a multiple of shorter object length
> 2: In x * pr :
>    longer object length is not a multiple of shorter object length
> 3: In x * pr :
>    longer object length is not a multiple of shorter object length
> 4: In x * pr :
>    longer object length is not a multiple of shorter object length
>
> Im not sure what this means. I thought there could be a mismatch between my
> locality points and the environmental maps but Ive plotted the points and
> they are in the correct locations. Has anyone encountered this before and
> can you please provide some advice about how to deal with it.
>
> Thank you Clement, Mathieu and Alex for your help thus far!!
>
> Jon
>
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Help-with-ENFA-in-R-tp7583243p7583325.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 

~$ whoami
Mathieu Basille, PhD

~$ locate --details
University of Florida \\
Fort Lauderdale Research and Education Center
(+1) 954-577-6314
http://ase-research.org/basille

~$ fortune
? Le tout est de tout dire, et je manque de mots
Et je manque de temps, et je manque d'audace. ?
  -- Paul ?luard


From grothered at gmail.com  Fri Apr 19 05:50:41 2013
From: grothered at gmail.com (Gaz D)
Date: Fri, 19 Apr 2013 13:50:41 +1000
Subject: [R-sig-Geo] Crosstab fails on large rasters with block of NA values
Message-ID: <CAB5HBpHDCL2SHoRF24yzOuOW0cNc+A3qzDszUc4YrJb5yqM6RA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130419/bec1f458/attachment.pl>

From daniel.flo at skogoglandskap.no  Fri Apr 19 11:10:01 2013
From: daniel.flo at skogoglandskap.no (=?iso-8859-1?Q?Daniel_Fl=F8?=)
Date: Fri, 19 Apr 2013 09:10:01 +0000
Subject: [R-sig-Geo] Raster overlap?
Message-ID: <C5353251F5B2EB419DBD9D1341E24F3B48C15269@exdb1.ad.skogoglandskap.no>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130419/e80bd383/attachment.pl>

From endri81 at gmail.com  Fri Apr 19 12:31:38 2013
From: endri81 at gmail.com (Endri Raco)
Date: Fri, 19 Apr 2013 12:31:38 +0200
Subject: [R-sig-Geo] How to plot map with overlay points
Message-ID: <CACje6_aHfPd6Qwv_huQDT3P+yWz0=1QSB=HTpOdtRWMSytiM3A@mail.gmail.com>

Hi group.
I have coordinates as in file attached.
Trying to print this as points with different colors I follow the commands:


> al1 = get_map(location = c(41.325997,19.822027), zoom = 10, maptype = 'roadmap')> ggmap(al1) + geom_point(data=points, aes(x=lat, y=lon5,colour = type))

The problem is that with zoom = 10 I get very vague idea of points but
if I try to zoom more than 15 nothing is plotted.

Can you please advice any approach or R package to get out of this situation?

Thx
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130419/9ec1423a/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: points.csv
Type: text/csv
Size: 569 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130419/9ec1423a/attachment.bin>

From j.m.signer at gmail.com  Fri Apr 19 12:51:07 2013
From: j.m.signer at gmail.com (Johannes Signer)
Date: Fri, 19 Apr 2013 12:51:07 +0200
Subject: [R-sig-Geo] How to plot map with overlay points
In-Reply-To: <CACje6_aHfPd6Qwv_huQDT3P+yWz0=1QSB=HTpOdtRWMSytiM3A@mail.gmail.com>
References: <CACje6_aHfPd6Qwv_huQDT3P+yWz0=1QSB=HTpOdtRWMSytiM3A@mail.gmail.com>
Message-ID: <CAC8qavtqX_qhHhr8psiWHjPe_LVOePYZYWktbSOfQWFVHVxV2A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130419/b77e1d9a/attachment.pl>

From seth at swbigelow.net  Fri Apr 19 13:54:45 2013
From: seth at swbigelow.net (Seth Bigelow)
Date: Fri, 19 Apr 2013 07:54:45 -0400
Subject: [R-sig-Geo] make polygons transparent in plotKML
In-Reply-To: <5E1B812FAC2C4A49B3D99593B5A521913C90EC@PRDEXMBX-08.the-lab.llnl.gov>
References: <001501ce3c7b$5f23f8c0$1d6bea40$@net>
	<5E1B812FAC2C4A49B3D99593B5A521913C90EC@PRDEXMBX-08.the-lab.llnl.gov>
Message-ID: <001e01ce3cf4$b0fc3ad0$12f4b070$@net>

I never was able to get the alpha= argument to create transparent polygons
in plotKML, but by carefully following the example in Bivand et al. (2008),
of Scotland's borders (Chap 4.2.1, using OGR drivers in rgdal) I was able to
achieve the desired effect. Thanks for problem-solving with me
-Seth


-----Original Message-----
From: MacQueen, Don [mailto:macqueen1 at llnl.gov] 
Sent: Thursday, April 18, 2013 5:53 PM
To: Seth Bigelow
Subject: Re: [R-sig-Geo] make polygons transparent in plotKML

Hmm. In that case I'd guess it's a package design and usage issue. But I'm
not very familiar with the package, so it is indeed just a guess.

?kml shows an example with alpha=0.75, so maybe we're not intended to call
plotKML directly, but rather through kml().

-Don

--
Don MacQueen

Lawrence Livermore National Laboratory
7000 East Ave., L-627
Livermore, CA 94550
925-423-1062





On 4/18/13 2:26 PM, "Seth Bigelow" <seth at swbigelow.net> wrote:

>Thanks for your assistance, however, I don't seem to be achieving 
>transparency no matter what alpha is...
>
>plotKML(MV[PSW,], colour_scale=rgb(0,0,0, alpha=0))   # Makes black fill
>
>
>--Seth
>
>
>-----Original Message-----
>From: MacQueen, Don [mailto:macqueen1 at llnl.gov]
>Sent: Thursday, April 18, 2013 3:21 PM
>To: Seth Bigelow
>Subject: Re: [R-sig-Geo] make polygons transparent in plotKML
>
>(actually, ?rgb would have been a better pointer)
>
>--
>Don MacQueen
>
>Lawrence Livermore National Laboratory
>7000 East Ave., L-627
>Livermore, CA 94550
>925-423-1062
>
>
>
>
>
>On 4/18/13 9:03 AM, "Seth Bigelow" <seth at swbigelow.net> wrote:
>
>>Greetings: 
>>
>> 
>>
>>Could anyone advise me how to make transparent polygons in plotKML? I 
>>am overlaying polygons in a SpatialPolygonsDataFrame object into 
>>Google Earth - Seems I can make the polygons any color (e.g., yellow - 
>>see
>>example) except transparent
>>
>> 
>>
>>plotKML(mySPDF, colour_scale ="#FFFF00")
>>
>> 
>>
>>Appreciately, Seth Bigelow
>>
>>
>>	[[alternative HTML version deleted]]
>>
>>_______________________________________________
>>R-sig-Geo mailing list
>>R-sig-Geo at r-project.org
>>https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


From endri81 at gmail.com  Fri Apr 19 14:55:03 2013
From: endri81 at gmail.com (Endri Raco)
Date: Fri, 19 Apr 2013 14:55:03 +0200
Subject: [R-sig-Geo] How to plot map with overlay points
In-Reply-To: <CACje6_Y1fUgLjE=4fDL6yF=EvjtUV5YRFnvm3JnQmucqSJD4UA@mail.gmail.com>
References: <CACje6_aHfPd6Qwv_huQDT3P+yWz0=1QSB=HTpOdtRWMSytiM3A@mail.gmail.com>
	<CAC8qavtqX_qhHhr8psiWHjPe_LVOePYZYWktbSOfQWFVHVxV2A@mail.gmail.com>
	<CACje6_Y1fUgLjE=4fDL6yF=EvjtUV5YRFnvm3JnQmucqSJD4UA@mail.gmail.com>
Message-ID: <CACje6_bRzFhB=pcrnjydkN24HJbvFwNoZbuNVwB2Otyej0SMkg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130419/0ab6fee2/attachment.pl>

From etiennebr at gmail.com  Fri Apr 19 17:14:22 2013
From: etiennebr at gmail.com (Etienne B. Racine)
Date: Fri, 19 Apr 2013 11:14:22 -0400
Subject: [R-sig-Geo] Raster overlap?
In-Reply-To: <C5353251F5B2EB419DBD9D1341E24F3B48C15269@exdb1.ad.skogoglandskap.no>
References: <C5353251F5B2EB419DBD9D1341E24F3B48C15269@exdb1.ad.skogoglandskap.no>
Message-ID: <CALjAYt5S0aLb2rDUe19T7f+SHm-D36PHkXkBMVCdWZZbBJs-og@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130419/6c67bc13/attachment.pl>

From janesh.devkota at gmail.com  Fri Apr 19 17:37:08 2013
From: janesh.devkota at gmail.com (Janesh Devkota)
Date: Fri, 19 Apr 2013 10:37:08 -0500
Subject: [R-sig-Geo] How to plot map with overlay points
In-Reply-To: <CACje6_bRzFhB=pcrnjydkN24HJbvFwNoZbuNVwB2Otyej0SMkg@mail.gmail.com>
References: <CACje6_aHfPd6Qwv_huQDT3P+yWz0=1QSB=HTpOdtRWMSytiM3A@mail.gmail.com>
	<CAC8qavtqX_qhHhr8psiWHjPe_LVOePYZYWktbSOfQWFVHVxV2A@mail.gmail.com>
	<CACje6_Y1fUgLjE=4fDL6yF=EvjtUV5YRFnvm3JnQmucqSJD4UA@mail.gmail.com>
	<CACje6_bRzFhB=pcrnjydkN24HJbvFwNoZbuNVwB2Otyej0SMkg@mail.gmail.com>
Message-ID: <CAPTbr1ofi_G3_3=DpZCHfmksP_u0obRP5N4uKTY8tWrAYym=XQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130419/c6f84b88/attachment.pl>

From Kerstin.Kober at jncc.gov.uk  Fri Apr 19 17:58:11 2013
From: Kerstin.Kober at jncc.gov.uk (Kerstin Kober)
Date: Fri, 19 Apr 2013 15:58:11 +0000
Subject: [R-sig-Geo] FW: Extracting p values from a series of wilcoxon tests
 done in a loop
Message-ID: <A11B4DEB20FAD24C983A07A5AE252E5003B56C@Ex2k10Ab.green.jncc.gov.uk>



Hello everybody,

I've got some code which runs wilcoxon tests for each 'year' and 'hotspot_ID' combination from my data. It basically compares the densities each hotspot_Id with the densities in hotspot 0 (one of the hotspot_ID's which means 'everywhere else that is not in a hotspot') - some test data is attached.

It looks like this. It gives me a nice, and very big, word document with all the tests in there.


d<-read.csv("F:\\Offshore_analysis1_(UK_wide_approach)\\Extra_analyses\\test_regularity_without_nim_numbers\\3_data_for_R\\6360_wn.csv<file:///\\Extra_analyses\test_regularity_without_nim_numbers\3_data_for_R\6360_wn.csv>", header=T)



# all tests between 0 and the other groups within each year together

for(i in 1980:2005){

    for(j in 1:34){

        tmp<- d[d$YEAR == i & d$hotspot_ID %in% c(0, j), ]

        print(c(i, j))

        try(print(wilcox.test(DENSITY~factor(hotspot_ID), data= tmp, na.action = na.omit)))

    }

}




Note that many of these did not run as there is not data for every combination of year and hotspot.

I want to be able to quickly extract which combinations ran, and of those, which had a P value less than some threshold, lets say 0.05.

So I'd like to extract some kind of table or ideally a .csv file with 3 columns:
Year, Hotspot_ID, P-value.

My attempts at altering the code to do that are here.


d<-read.csv("F:\\offshore_SPAs\\1_Stage1\\2_analysis_GL1.4\\2_UK_wide\\3_data_for_R.\\220_br.csv", header=T)



# all tests between 0 and the other groups within each year together

  output.2<-matrix( ncol=3, nrow=3000)



for(i in 1980:2005){

    for(j in 1:34){

        tmp<- d[d$YEAR == i & d$hotspot_ID %in% c(0, j), ]

        print(c(i, j))

        try(wt<-(wilcox.test(DENSITY~factor(hotspot_ID), data= tmp, na.action = na.omit)

        )

        output.2$p<-wt$p.value)

      }

}





I've played around quite a bit with the placement of the output bits,
I'm hoping someone can spot either where I'm going wrong with my attempts, or suggest a better way of doing this. I've also played a bit with matrix, and less so with sapply, but don't really know what I'm doing with those.

Any advice greatly appreciated.

Thanks


Kerstin



_____________________________________________________________________
The Joint Nature Conservation Committee (JNCC) is the statutory adviser to Government on UK and international nature conservation, on behalf of the Council for Nature Conservation and the Countryside, Cyfoeth Naturiol Cymru (Natural Resources Wales), Natural England and Scottish Natural Heritage.  Its work contributes to maintaining and enriching biological diversity, conserving geological features and sustaining natural systems.

JNCC SUPPORT CO. Registered in England and Wales, company no. 05380206. Registered office:  Monkstone House, City Road, Peterborough, Cambridgeshire PE1 1JY

If you have a Freedom of Information/Environmental Information request please refer to our website page

This message has been checked for all known viruses by JNCC delivered through the MessageLabs Virus Control Centre.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130419/f16e8950/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: test_data.csv
Type: application/octet-stream
Size: 3494 bytes
Desc: test_data.csv
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130419/f16e8950/attachment.obj>

From 538280 at gmail.com  Sat Apr 20 00:22:10 2013
From: 538280 at gmail.com (Greg Snow)
Date: Fri, 19 Apr 2013 16:22:10 -0600
Subject: [R-sig-Geo] FW: Extracting p values from a series of wilcoxon
 tests done in a loop
In-Reply-To: <A11B4DEB20FAD24C983A07A5AE252E5003B56C@Ex2k10Ab.green.jncc.gov.uk>
References: <A11B4DEB20FAD24C983A07A5AE252E5003B56C@Ex2k10Ab.green.jncc.gov.uk>
Message-ID: <CAFEqCdy-Ze8twyxNv4YaSzrspaTEzMn7D4y+kD9HiLF+kGeCFQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130419/baecaf41/attachment.pl>

From r.hijmans at gmail.com  Sat Apr 20 01:14:02 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Fri, 19 Apr 2013 16:14:02 -0700
Subject: [R-sig-Geo] FW: Extracting p values from a series of wilcoxon
 tests done in a loop
In-Reply-To: <CAFEqCdy-Ze8twyxNv4YaSzrspaTEzMn7D4y+kD9HiLF+kGeCFQ@mail.gmail.com>
References: <A11B4DEB20FAD24C983A07A5AE252E5003B56C@Ex2k10Ab.green.jncc.gov.uk>
	<CAFEqCdy-Ze8twyxNv4YaSzrspaTEzMn7D4y+kD9HiLF+kGeCFQ@mail.gmail.com>
Message-ID: <CANtt_hw-LNFi_xw+242iUNg5i5kdcVJULtpDc_M_NXP8xJBd7w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130419/57770c9b/attachment.pl>

From endri81 at gmail.com  Sat Apr 20 19:27:59 2013
From: endri81 at gmail.com (Endri Raco)
Date: Sat, 20 Apr 2013 19:27:59 +0200
Subject: [R-sig-Geo] Add annotation to points using ggmap
Message-ID: <CACje6_ZjdgQE2tjHDz_cNKcqEwkjteiFxMo+4EZ0mVW2Yo8MAg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130420/4f88bd08/attachment.pl>

From kirill.mueller at ivt.baug.ethz.ch  Sun Apr 21 15:22:36 2013
From: kirill.mueller at ivt.baug.ethz.ch (=?ISO-8859-1?Q?Kirill_M=FCller?=)
Date: Sun, 21 Apr 2013 15:22:36 +0200
Subject: [R-sig-Geo] rgdal: libgdal requirements too restrictive
In-Reply-To: <alpine.LRH.2.03.1304151038320.8250@reclus.nhh.no>
References: <516B07E3.30602@ivt.baug.ethz.ch>
	<alpine.LRH.2.03.1304151038320.8250@reclus.nhh.no>
Message-ID: <5173E81C.6000906@ivt.baug.ethz.ch>

Dear Roger

On 04/15/2013 10:49 AM, Roger Bivand wrote:
> Please rather use R-sig-geo.
Ok.
>
> GDAL 1.6.3 was published 25-Nov-2009; 1.10.1 will be published soon. 
> 1.6.3 is no longer supported or fit for service, I'm afraid. GEOS is 
> currently at 3.3.8, and 3.2.* are not supoorted or fit for service. 
This would mean, in turn, that Debian stable is not "fit for service". 
Can't I run GIS software on Debian at all, without installing stuff from 
source (which might break Debian's otherwise decent package management)?
> In both cases, numerous bugs have been corrected and additional 
> functionality has arrived.
And likewise, three years from now, the current version will look so 
much 2013.
> Your only choice is to install GDAL and GEOS from source, there is no 
> way that rgdal and rgeos developer(s) - me alone - can back-support 
> ancient dependencies. 
It's not about really supporting an ancient version. It's about making 
the R package installable at all under an operating system with, by 
default, rather old software packages. The only change that is required 
on the side of rgdal/rgeos is to lower the dependency. The package 
installs, the tests show no error. Are you aware of any rgdal/rgeos 
functionality which would be broken if run under an older GDAL/GEOS?

I understand that this might raise additional maintenance burden. Can't 
you just say "GEOS >= 3.3.8", or something like that, in the 
DESCRIPTION, and have the configure script print a warning but allow 
installation if 3.2.0 <= GEOS < 3.3.8? Same for rgdal. Anyone really 
coming up with a bug report for an older version could then be asked to 
test it in a current installation, say, in a virtual machine.

I'd like to ask you to reconsider your position. After all, I have 
"fixed" the problem for myself, and I can maintain the tweaked package 
sources for myself. It's just to make life easier for those who have to 
run GIS on Debian...
> In conclusion - install from source. Maybe also write to R-sig-deb, 
> but because this is external to thenm, they won't help. I think that 
> this is a Debian GIS FAQ.
I'd love to hear of any option, other than installing from source, to 
update my Debian to supported versions of the required libraries -- 
without having to update libc and the compiler as well. I have looked, 
but found nothing.

Thank you.


Cheers

Kirill

>
> On Sun, 14 Apr 2013, Kirill M?ller wrote:
>
>> Dear Roger
>>
>> Just like rgeos [1], I cannot install current rgdal on the "most 
>> recent" Debian stable. Switching to "testing" is not an option for us.
>>
>> Debian squeeze comes with libgdal 1.6.3. I have changed the 
>> requirements in the configure script and installed the package on my 
>> system, all tests succeeded. I have attached the patch in case you 
>> want to reduce the requirements for the other Debian users around.
>>
>>
>> Cheers
>>
>> Kirill
>>
>>
>> [1] https://github.com/rundel/rgeos/issues/1
>>
>>
>


From Roger.Bivand at nhh.no  Sun Apr 21 20:31:03 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sun, 21 Apr 2013 20:31:03 +0200
Subject: [R-sig-Geo] rgdal: libgdal requirements too restrictive
In-Reply-To: <5173E81C.6000906@ivt.baug.ethz.ch>
References: <516B07E3.30602@ivt.baug.ethz.ch>
	<alpine.LRH.2.03.1304151038320.8250@reclus.nhh.no>
	<5173E81C.6000906@ivt.baug.ethz.ch>
Message-ID: <alpine.LRH.2.03.1304212006400.29054@reclus.nhh.no>

On Sun, 21 Apr 2013, Kirill M?ller wrote:

> Dear Roger
>
> On 04/15/2013 10:49 AM, Roger Bivand wrote:
>> Please rather use R-sig-geo.
> Ok.
>> 
>> GDAL 1.6.3 was published 25-Nov-2009; 1.10.1 will be published soon. 1.6.3 
>> is no longer supported or fit for service, I'm afraid. GEOS is currently at 
>> 3.3.8, and 3.2.* are not supoorted or fit for service. 
> This would mean, in turn, that Debian stable is not "fit for service". Can't 
> I run GIS software on Debian at all, without installing stuff from source 
> (which might break Debian's otherwise decent package management)?

People do use Debian and Ubuntu, but the real place to go is the group 
apparently responsible for preparing binary packages for these 
distributions. I'm pretty sure that there are no impediments to building 
current GDAL, GEOS, etc. for Debian stable (I use RHEL 5, which is still 
gcc 4.1.2, but always install R, GDAL, GEOS etc. from source):

http://wiki.debian.org/DebianGis

also gives access to a mailing list with archives. You could ask there 
what resources they would need to offer less antiquated packages for 
stable, which is your specific problem - testing and unstable are not up 
to date, but are not bad. The only practical solution is for Debian GIS to 
provide newer binary versions of GDAL and GEOS for Debian stable. 
Installing from source is not a big price to pay for access to software 
that is up to date, if you cannot help Debian GIS to meet your needs.

Since I handle rgdal and rgeos maintenance, I can confirm not only that I 
have no access to Debian/Ubuntu systems, but have frequently had to answer 
questions related to binary packages of GDAL for those systems with 
issues, consistently advising installation from source. Unless you need 
very specific drivers, building from source is not a problem, nor is 
deploying to multiple machines directly (but not via the packaging 
system).

In fact neither GDAL nor GEOS are checked for rgdal/rgeos for multiple 
older versions; releases of the R packages are only checked against the 
current released GDAL and GEOS, occasionally (as now) tracking release 
candidates. However, because we link to (fairly) stable APIs, expressing 
this in the DESCRIPTION file makes no sense, it is handled in the 
configure scripts of the packages, which in some cases branch on C 
preprocessor -D definitions where necessary.

Hope this clarifies,

Roger

>> In both cases, numerous bugs have been corrected and additional 
>> functionality has arrived.
> And likewise, three years from now, the current version will look so much 
> 2013.
>> Your only choice is to install GDAL and GEOS from source, there is no way 
>> that rgdal and rgeos developer(s) - me alone - can back-support ancient 
>> dependencies. 
> It's not about really supporting an ancient version. It's about making the R 
> package installable at all under an operating system with, by default, rather 
> old software packages. The only change that is required on the side of 
> rgdal/rgeos is to lower the dependency. The package installs, the tests show 
> no error. Are you aware of any rgdal/rgeos functionality which would be 
> broken if run under an older GDAL/GEOS?
>
> I understand that this might raise additional maintenance burden. Can't you 
> just say "GEOS >= 3.3.8", or something like that, in the DESCRIPTION, and 
> have the configure script print a warning but allow installation if 3.2.0 <= 
> GEOS < 3.3.8? Same for rgdal. Anyone really coming up with a bug report for 
> an older version could then be asked to test it in a current installation, 
> say, in a virtual machine.
>
> I'd like to ask you to reconsider your position. After all, I have "fixed" 
> the problem for myself, and I can maintain the tweaked package sources for 
> myself. It's just to make life easier for those who have to run GIS on 
> Debian...
>> In conclusion - install from source. Maybe also write to R-sig-deb, but 
>> because this is external to thenm, they won't help. I think that this is a 
>> Debian GIS FAQ.
> I'd love to hear of any option, other than installing from source, to update 
> my Debian to supported versions of the required libraries -- without having 
> to update libc and the compiler as well. I have looked, but found nothing.
>
> Thank you.
>
>
> Cheers
>
> Kirill
>
>> 
>> On Sun, 14 Apr 2013, Kirill M?ller wrote:
>> 
>>> Dear Roger
>>> 
>>> Just like rgeos [1], I cannot install current rgdal on the "most recent" 
>>> Debian stable. Switching to "testing" is not an option for us.
>>> 
>>> Debian squeeze comes with libgdal 1.6.3. I have changed the requirements 
>>> in the configure script and installed the package on my system, all tests 
>>> succeeded. I have attached the patch in case you want to reduce the 
>>> requirements for the other Debian users around.
>>> 
>>> 
>>> Cheers
>>> 
>>> Kirill
>>> 
>>> 
>>> [1] https://github.com/rundel/rgeos/issues/1
>>> 
>>> 
>> 
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From kirill.mueller at ivt.baug.ethz.ch  Sun Apr 21 21:42:54 2013
From: kirill.mueller at ivt.baug.ethz.ch (=?ISO-8859-1?Q?Kirill_M=FCller?=)
Date: Sun, 21 Apr 2013 21:42:54 +0200
Subject: [R-sig-Geo] rgdal: libgdal requirements too restrictive
In-Reply-To: <alpine.LRH.2.03.1304212006400.29054@reclus.nhh.no>
References: <516B07E3.30602@ivt.baug.ethz.ch>
	<alpine.LRH.2.03.1304151038320.8250@reclus.nhh.no>
	<5173E81C.6000906@ivt.baug.ethz.ch>
	<alpine.LRH.2.03.1304212006400.29054@reclus.nhh.no>
Message-ID: <5174413E.8030408@ivt.baug.ethz.ch>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130421/77f99172/attachment.pl>

From zengalaw at 163.com  Mon Apr 22 05:23:17 2013
From: zengalaw at 163.com (=?GBK?B?uq7LycDPutc=?=)
Date: Mon, 22 Apr 2013 11:23:17 +0800 (CST)
Subject: [R-sig-Geo] how to compute R square in splm package
Message-ID: <38be72a2.5822.13e2fc45c47.Coremail.zengalaw@163.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130422/04c3a3e3/attachment.pl>

From Roger.Bivand at nhh.no  Mon Apr 22 10:23:33 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 22 Apr 2013 10:23:33 +0200
Subject: [R-sig-Geo] rgdal: libgdal requirements too restrictive
In-Reply-To: <5174413E.8030408@ivt.baug.ethz.ch>
References: <516B07E3.30602@ivt.baug.ethz.ch>
	<alpine.LRH.2.03.1304151038320.8250@reclus.nhh.no>
	<5173E81C.6000906@ivt.baug.ethz.ch>
	<alpine.LRH.2.03.1304212006400.29054@reclus.nhh.no>
	<5174413E.8030408@ivt.baug.ethz.ch>
Message-ID: <alpine.LRH.2.03.1304221003490.32520@reclus.nhh.no>

On Sun, 21 Apr 2013, Kirill M?ller wrote:

> On 04/21/2013 08:31 PM, Roger Bivand wrote:
>> You could ask there what resources they would need to offer less antiquated 
>> packages for stable, which is your specific problem - testing and unstable 
>> are not up to date, but are not bad. The only practical solution is for 
>> Debian GIS to provide newer binary versions of GDAL and GEOS for Debian 
>> stable.
> If I understand Debian's release process [1] correctly, "stable" is 
> essentially what "testing" was two years ago, and not updated anymore except 
> for security bugs. So, unless I'm wrong on that point, the "stable" packages 
> are not going to be updated until the next major release of Debian. "Debian 
> GIS" doesn't provide packages for six years now, and neither libgdal nor 
> libgeos are available as backports [2] -- new packages compiled using the 
> "stable" toolchain. I cannot install from "testing" because this requires an 
> update of libc -- a bad thing to do in a production environment, I have been 
> told. And I'm not going to install from source, because this could mean that, 
> in the end, I'll have to reinstall everything that depends on those libs from 
> source.

The resource for R on Debian is:

http://cran.r-project.org/bin/linux/debian/

which describes how backporting is handled for R. Those needing 
rgdal/GDAL/etc. or rgeos/GEOS on Debian should sort out who is to do the 
work, and possibly approach R-sig-debian asking for advice. If those 
interested could secure the backporting of GDAL/etc. and GEOS, I think 
that it might be possible to ask the Debian R packages maintainer for 
assistance, but it is those backports that are the hindrance.

>
> While I understand that people write to you first when they see a bug in 
> rgeos/rgdal, I don't think that you can be held responsible for bugs in the 
> libs that those R packages wrap. If you insist on forcing people to use only 
> the most recent libgeos/libgdal, the ./configure script should reflect this. 
> Otherwise I find the dependency to 3.2.2 rather arbitrary.

This is GEOS 3.2.2, and relates to the use of the C API in rgeos:

http://trac.osgeo.org/geos/browser/tags/3.2.3/NEWS

Changes in 3.2.2
- Bug fixes:
   - CAPI: do not leak contexts when using the non-reentrant interface

and other bug fixes since 3.2.0. If you would like to change the condition 
in configure.ac, rebuild configure, and try out R CMD check (checking out 
rgeos from R-forge for convenience), we could relax from 3.2.2 to 3.2.0.

You could try the same approach with rgdal and GDAL 1.6.3 (multiple 
packages), PROJ.4 (multiple packages). Please see the rgdal README, also 
online at:

https://r-forge.r-project.org/scm/viewvc.php/pkg/inst/README?view=markup&revision=409&root=rgdal

This would avoid your having to install the external dependencies from 
source, but I cannot promise that it will be straightforward, as some 
examples may use drivers that entered GDAL/OGR after 1.6.3, and would then 
need to condition on driver availability. Between 1.6.3 and forthcoming 
1.10.0, lots of bugs have been fixed too.

Roger

>
> It's a difficult situation. I can ask the backports people if they can also 
> offer libgdal/libgeos plus whatever dependencies these packages have (PROJ.4, 
> ...). And of course there's always the way of "jailbreaking" rgdal/rgeos by 
> messing with its ./configure script -- implying loss of warranty :-)
>
>
> -Kirill
>
>
> [1] http://www.debian.org/releases/
> [2] http://backports.debian.org/
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From ubuntero.9161 at gmail.com  Mon Apr 22 12:14:40 2013
From: ubuntero.9161 at gmail.com (Ivailo)
Date: Mon, 22 Apr 2013 13:14:40 +0300
Subject: [R-sig-Geo] How to translate coordinates from cylindrical to a
 Lambert Azimuthal Equal Area Projection
Message-ID: <CAAVnHsu6cHv0VLDCzdoSF=Uf0umRTrrVdQw4FM2NCudjBv9TiA@mail.gmail.com>

Dear Listmembers,

I have a 40 000 x 40 000 GeoTIFF file that I need to crop to an area
of interest (perhaps about 1000 x 1000 pixels, 25 x 25 m grid). The
file seems to be in the Lambert Azimuthal Equal Area Projection
(coord. ref. : +proj=laea +lat_0=52 +lon_0=10 +x_0=4321000
+y_0=3210000 +ellps=GRS80 +units=m +no_defs) while I use Google Earth
(using a Cylindrical projection with a WGS84 datum) to navigate and
delineate the extent of the area I'd like to crop from the original
file.

As I don't have much experience working with Raster* objects as
defined in the raster package, I'd like to ask you for help in
"translating" the coordinates I get from Google Earth (i.e., decimal
degrees) to the ones needed to define the extent of interest for the
RasterLayer object I have created by reading the GeoTiff file via
`raster("myfile.tif")`.

Any insight would be much appreciated.

Ivailo
--
UBUNTU: a person is a person through other persons.


From dominic.roye at gmail.com  Mon Apr 22 13:41:11 2013
From: dominic.roye at gmail.com (Dominic Roye)
Date: Mon, 22 Apr 2013 13:41:11 +0200
Subject: [R-sig-Geo] Memory limits in R with shapefiles
Message-ID: <CALvVS-GX82jx2EKPsjDRJF6Zq_x6isL-HJyLgo=3AQU8DexmNQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130422/88ddae6b/attachment.pl>

From thi_veloso at yahoo.com.br  Mon Apr 22 15:00:14 2013
From: thi_veloso at yahoo.com.br (Thiago V. dos Santos)
Date: Mon, 22 Apr 2013 06:00:14 -0700 (PDT)
Subject: [R-sig-Geo] Memory limits in R with shapefiles
In-Reply-To: <CALvVS-GX82jx2EKPsjDRJF6Zq_x6isL-HJyLgo=3AQU8DexmNQ@mail.gmail.com>
References: <CALvVS-GX82jx2EKPsjDRJF6Zq_x6isL-HJyLgo=3AQU8DexmNQ@mail.gmail.com>
Message-ID: <1366635614.67563.YahooMailNeo@web121903.mail.ne1.yahoo.com>

What kind of operation do you need to perform in the shapefiles?

Depending on it, one solution could be calling gdal commands from within R, by using system(). For example:

system('gdalwarp argument1 argument2 argument3 argument4')
?
Greetings,
--
Thiago V. dos Santos
PhD student
Land and Atmospheric Science
University of Minnesota
http://www.laas.umn.edu/CurrentStudents/MeettheStudents/ThiagodosSantos/index.htm
Phone: (612) 323 9898


----- Original Message -----
From: Dominic Roye <dominic.roye at gmail.com>
To: r-sig-geo at r-project.org
Cc: 
Sent: Monday, April 22, 2013 6:41 AM
Subject: [R-sig-Geo] Memory limits in R with shapefiles

Hello everyone,

I have a problem with reading a shape of 300 MB in R. My RAM limits are 8
GB. So, i can?t work with this shape, because it needs more than 8GB. Have
anybody an idea how to handle this kind of cases?

Best regards,

Dominic

??? [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From alessandracarioli at gmail.com  Mon Apr 22 15:52:44 2013
From: alessandracarioli at gmail.com (Alessandra Carioli)
Date: Mon, 22 Apr 2013 15:52:44 +0200
Subject: [R-sig-Geo] Fwd: wrong colour class for sub-map
In-Reply-To: <CAK6730sJuzMk036mRP8nx_DdO4dnyb7vju5=H_6N73fzOfDFgA@mail.gmail.com>
References: <CAK6730sJuzMk036mRP8nx_DdO4dnyb7vju5=H_6N73fzOfDFgA@mail.gmail.com>
Message-ID: <CAK6730t0ePxXE2g2kPBcFQt=+VTMmU9Qa2pDFhKUYjqzJwGBKQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130422/f310800e/attachment.pl>

From viton.1 at osu.edu  Mon Apr 22 19:04:33 2013
From: viton.1 at osu.edu (Philip A. Viton)
Date: Mon, 22 Apr 2013 14:04:33 -0300
Subject: [R-sig-Geo] subsetting a WKT Multilinestring
Message-ID: <201304221808.r3MI8Se0010064@defang10.it.ohio-state.edu>

Consider:

library(rgeos)
mls<-readWKT("MULTILINESTRING((3 4, 10 50, 20 25),(30 30, 70 50, 24 55)
              ,(30 12, 50 5, 65 7))")

mls is, as expected, a SpatialLines object, and
plotting it shows that indeed it has three individual
lines. My question is: is there some way to subset this
object so as to obtain a smaller SpatialLines object?
(say, by excluding the second Line)?

------------------------
Philip A. Viton
City Planning, Ohio State University
275 West Woodruff Avenue, Columbus OH 43210
viton.1 at osu.edu


From edzer.pebesma at uni-muenster.de  Mon Apr 22 20:25:33 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 22 Apr 2013 20:25:33 +0200
Subject: [R-sig-Geo] subsetting a WKT Multilinestring
In-Reply-To: <201304221808.r3MI8Se0010064@defang10.it.ohio-state.edu>
References: <201304221808.r3MI8Se0010064@defang10.it.ohio-state.edu>
Message-ID: <5175809D.1040408@uni-muenster.de>



On 04/22/2013 07:04 PM, Philip A. Viton wrote:
> Consider:
> 
> library(rgeos)
> mls<-readWKT("MULTILINESTRING((3 4, 10 50, 20 25),(30 30, 70 50, 24 55)
>              ,(30 12, 50 5, 65 7))")
> 
> mls is, as expected, a SpatialLines object, and
> plotting it shows that indeed it has three individual
> lines. My question is: is there some way to subset this
> object so as to obtain a smaller SpatialLines object?
> (say, by excluding the second Line)?

They're considered as a single line; try length(mls).

If somebody comes up with a simple function to do this, and a similar
thing for polygons, and we can agree on a name for such a thing
(unfold?) I'm willing to consider it for sp. Or is it already somewhere?

> 
> ------------------------
> Philip A. Viton
> City Planning, Ohio State University
> 275 West Woodruff Avenue, Columbus OH 43210
> viton.1 at osu.edu
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From Roger.Bivand at nhh.no  Mon Apr 22 20:39:32 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 22 Apr 2013 20:39:32 +0200
Subject: [R-sig-Geo] subsetting a WKT Multilinestring
In-Reply-To: <201304221808.r3MI8Se0010064@defang10.it.ohio-state.edu>
References: <201304221808.r3MI8Se0010064@defang10.it.ohio-state.edu>
Message-ID: <alpine.LRH.2.03.1304222024080.32520@reclus.nhh.no>

On Mon, 22 Apr 2013, Philip A. Viton wrote:

> Consider:
>
> library(rgeos)
> mls<-readWKT("MULTILINESTRING((3 4, 10 50, 20 25),(30 30, 70 50, 24 55)
>             ,(30 12, 50 5, 65 7))")

length(mls)
#[1] 1

mls1<-readWKT("GEOMETRYCOLLECTION(LINESTRING(3 4, 10 50, 20 25),
   LINESTRING(30 30, 70 50, 24 55), LINESTRING(30 12, 50 5, 65 7))")
length(mls1)
#[1] 3

may be the incantation you want, then:

length(mls1[-2])
#[1] 2

A MULTILINESTRING is an sp "Lines" object, built of one or more "Line" 
objects. An sp "SpatialLines" object is a GEOMETRYCOLLECTION of 
MULTILINESTRING or LINESTRING objects, where the single LINESTRING objects 
are "promoted" to MULTILINESTRING/Lines status as observed data is 
attached to them, not to LINESTRING/Line objects. If you work with the 
object definitions, you don't have to unpick them afterwards.

Hope this clarifies,

Roger

PS:

unfold might be (I think Barry has said this, I have too somewhere):

crds <- coordinates(mls)
nobjs <- sum(sapply(crds, length))
out <- vector(mode="list", length=nobjs)
i <- 1
for (j in seq(along=crds)) {
   jcrds <- crds[[j]]
   for (k in seq(along=jcrds)) {
     out[[i]] <- Lines(list(Line(jcrds[k])), as.character(i))
     i <- i + 1
   }
}
SLout <- SpatialLines(out)
length(SLout)

In another context it was necessary to check that the coordinate matrices 
had at least two unique coordinates - not done here.

>
> mls is, as expected, a SpatialLines object, and
> plotting it shows that indeed it has three individual
> lines. My question is: is there some way to subset this
> object so as to obtain a smaller SpatialLines object?
> (say, by excluding the second Line)?
>
> ------------------------
> Philip A. Viton
> City Planning, Ohio State University
> 275 West Woodruff Avenue, Columbus OH 43210
> viton.1 at osu.edu
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From r.hijmans at gmail.com  Mon Apr 22 21:12:44 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 22 Apr 2013 12:12:44 -0700
Subject: [R-sig-Geo] moran.plot: sum or mean?
Message-ID: <CANtt_hy1wD02syjBhZvkN8HC-Ei6numSvdmX_kenUxWBaXm7jQ@mail.gmail.com>

I am using package spdep. I have a listw object (lw) and a vector of
values (y) and I want to make a Moran scatterplot (with unadjusted
values):

library(spdep)
m <- matrix(c(0, 1, 1, 0, 0, 0, 1, 0, 1, 0, 1, 1, 1, 1, 0, 1, 0, 1, 0,
0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 1, 1, 1, 0), ncol=6)
lw <- mat2listw(m, style='B')
y <- c(32, 26, 19, 14, 18, 17)
moran.plot(y, lw)

# The values on the vertical axes are the sums of the lagged values
# (as returned by lag(lw, y) ), where I expected the mean (which is
# what the example ?moran.plot example appears to do


# I expected this
x <- cbind(rep(y, each=6), as.vector(m * y))
x <- x[x[,2] > 0, ]
x <- aggregate(x[,2], list(x[,1]), FUN=mean)
colnames(x) <- c('y', 'lagged y')

# and a plot like this
x11()
plot(x)
abline(lm(x[,2] ~ x[,1]), lwd=2)
abline(v=mean(y), lt=2)
abline(h=mean(x[,2]), lt=2)


# What am I missing?

Thanks, Robert


From Roger.Bivand at nhh.no  Mon Apr 22 21:27:22 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 22 Apr 2013 21:27:22 +0200
Subject: [R-sig-Geo] moran.plot: sum or mean?
In-Reply-To: <CANtt_hy1wD02syjBhZvkN8HC-Ei6numSvdmX_kenUxWBaXm7jQ@mail.gmail.com>
References: <CANtt_hy1wD02syjBhZvkN8HC-Ei6numSvdmX_kenUxWBaXm7jQ@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1304222117380.32520@reclus.nhh.no>

On Mon, 22 Apr 2013, Robert J. Hijmans wrote:

> I am using package spdep. I have a listw object (lw) and a vector of
> values (y) and I want to make a Moran scatterplot (with unadjusted
> values):
>
> library(spdep)
> m <- matrix(c(0, 1, 1, 0, 0, 0, 1, 0, 1, 0, 1, 1, 1, 1, 0, 1, 0, 1, 0,
> 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 1, 1, 1, 0), ncol=6)
> lw <- mat2listw(m, style='B')
> y <- c(32, 26, 19, 14, 18, 17)
> moran.plot(y, lw)
>
> # The values on the vertical axes are the sums of the lagged values
> # (as returned by lag(lw, y) ), where I expected the mean (which is
> # what the example ?moran.plot example appears to do
>
>
> # I expected this
> x <- cbind(rep(y, each=6), as.vector(m * y))
> x <- x[x[,2] > 0, ]
> x <- aggregate(x[,2], list(x[,1]), FUN=mean)
> colnames(x) <- c('y', 'lagged y')
>
> # and a plot like this
> x11()
> plot(x)
> abline(lm(x[,2] ~ x[,1]), lwd=2)
> abline(v=mean(y), lt=2)
> abline(h=mean(x[,2]), lt=2)
>
>
> # What am I missing?

Row standardisation of the weights object:

moran.plot(y, mat2listw(m, style='W'))

which authors of the Moran scatterplot literature tend to take for 
granted, see references in ?moran.plot, especially the top of p. 116 in 
Anselin 1996.

Hope this clarifies,

Roger

>
> Thanks, Robert
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From mdsumner at gmail.com  Mon Apr 22 22:59:35 2013
From: mdsumner at gmail.com (Michael Sumner)
Date: Tue, 23 Apr 2013 06:59:35 +1000
Subject: [R-sig-Geo] Memory limits in R with shapefiles
In-Reply-To: <1366635614.67563.YahooMailNeo@web121903.mail.ne1.yahoo.com>
References: <CALvVS-GX82jx2EKPsjDRJF6Zq_x6isL-HJyLgo=3AQU8DexmNQ@mail.gmail.com>
	<1366635614.67563.YahooMailNeo@web121903.mail.ne1.yahoo.com>
Message-ID: <CAAcGz9-XLAJEBZ7sT7f-ngJRbcep9hqOQ-=V3bX0yQA5t5L4RA@mail.gmail.com>

gdalwarp is not for shapefiles

Dominic: at the command line with GDAL installed you can use *ogr2ogr*
to subset and otherwise manipulate shapefiles and that may be your
best route.  http://www.gdal.org/ogr_utilities.html

But, what is the size of the component files? Sometimes it's the .shp
that is huge, other times the .dbf and not necessarily both of them
due to the relative storage required for geometry vs. attributes.

That might give you more options, since you can read (and write) .dbf
files for shapefiles with the foreign package. You can also hand-craft
a VRT file that defines a subset of the geometry and/or attributes,
though that can be tricky to get right.
http://www.gdal.org/ogr/drv_vrt.html

Cheers, Mike.

On Mon, Apr 22, 2013 at 11:00 PM, Thiago V. dos Santos
<thi_veloso at yahoo.com.br> wrote:
> What kind of operation do you need to perform in the shapefiles?
>
> Depending on it, one solution could be calling gdal commands from within R, by using system(). For example:
>
> system('gdalwarp argument1 argument2 argument3 argument4')
>
> Greetings,
> --
> Thiago V. dos Santos
> PhD student
> Land and Atmospheric Science
> University of Minnesota
> http://www.laas.umn.edu/CurrentStudents/MeettheStudents/ThiagodosSantos/index.htm
> Phone: (612) 323 9898
>
>
> ----- Original Message -----
> From: Dominic Roye <dominic.roye at gmail.com>
> To: r-sig-geo at r-project.org
> Cc:
> Sent: Monday, April 22, 2013 6:41 AM
> Subject: [R-sig-Geo] Memory limits in R with shapefiles
>
> Hello everyone,
>
> I have a problem with reading a shape of 300 MB in R. My RAM limits are 8
> GB. So, i can?t work with this shape, because it needs more than 8GB. Have
> anybody an idea how to handle this kind of cases?
>
> Best regards,
>
> Dominic
>
>     [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Michael Sumner
Hobart, Australia
e-mail: mdsumner at gmail.com


From chocold12 at gmail.com  Tue Apr 23 00:24:23 2013
From: chocold12 at gmail.com (lily li)
Date: Mon, 22 Apr 2013 16:24:23 -0600
Subject: [R-sig-Geo] time-series
Message-ID: <CAN5afy-WEP3TAZSa6-G=tBDnGWs60uzQk++L6cGYxM+uZcJfaw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130422/2338329b/attachment.pl>

From ubuntero.9161 at gmail.com  Tue Apr 23 12:17:32 2013
From: ubuntero.9161 at gmail.com (Ivailo)
Date: Tue, 23 Apr 2013 13:17:32 +0300
Subject: [R-sig-Geo] How to translate coordinates from cylindrical to a
 Lambert Azimuthal Equal Area Projection
In-Reply-To: <CAAVnHsu6cHv0VLDCzdoSF=Uf0umRTrrVdQw4FM2NCudjBv9TiA@mail.gmail.com>
References: <CAAVnHsu6cHv0VLDCzdoSF=Uf0umRTrrVdQw4FM2NCudjBv9TiA@mail.gmail.com>
Message-ID: <CAAVnHsvdcOzB5wCYLYobrZznQhxJuUp7nU+LsYBomm5POKkmPA@mail.gmail.com>

On Mon, Apr 22, 2013 at 1:14 PM, Ivailo <ubuntero.9161 at gmail.com> wrote:
>
> Dear Listmembers,
>
> I have a 40 000 x 40 000 GeoTIFF file that I need to crop to an area
> of interest (perhaps about 1000 x 1000 pixels, 25 x 25 m grid). The
> file seems to be in the Lambert Azimuthal Equal Area Projection
> (coord. ref. : +proj=laea +lat_0=52 +lon_0=10 +x_0=4321000
> +y_0=3210000 +ellps=GRS80 +units=m +no_defs) while I use Google Earth
> (using a Cylindrical projection with a WGS84 datum) to navigate and
> delineate the extent of the area I'd like to crop from the original
> file.
>
> As I don't have much experience working with Raster* objects as
> defined in the raster package, I'd like to ask you for help in
> "translating" the coordinates I get from Google Earth (i.e., decimal
> degrees) to the ones needed to define the extent of interest for the
> RasterLayer object I have created by reading the GeoTiff file via
> `raster("myfile.tif")`.

Meanwhile I have found the "World Coordinate Converter" at
http://twcc.free.fr where I can convert single coordinate pairs from
"GPS (WGS84) (deg)" to "ETRS89/ETRS-LAEA". Yet, I would still
appreciate if somebody could provide advice how to do such an
operation on a raster object within R (or even on coordinate pairs
within a data.frame).

Cheers,
Ivailo
--
UBUNTU: a person is a person through other persons.


From b.rowlingson at lancaster.ac.uk  Tue Apr 23 14:30:20 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Tue, 23 Apr 2013 13:30:20 +0100
Subject: [R-sig-Geo] How to translate coordinates from cylindrical to a
 Lambert Azimuthal Equal Area Projection
In-Reply-To: <a48b353d12dd464fa1e3dd6dab94a968@EX-1-HT0.lancs.local>
References: <CAAVnHsu6cHv0VLDCzdoSF=Uf0umRTrrVdQw4FM2NCudjBv9TiA@mail.gmail.com>
	<a48b353d12dd464fa1e3dd6dab94a968@EX-1-HT0.lancs.local>
Message-ID: <CANVKczOUmAD8dyprjVE23qnqgoU=uyJmdRVaaPA9wxY+U0txXg@mail.gmail.com>

On Tue, Apr 23, 2013 at 11:17 AM, Ivailo <ubuntero.9161 at gmail.com> wrote:

> Meanwhile I have found the "World Coordinate Converter" at
> http://twcc.free.fr where I can convert single coordinate pairs from
> "GPS (WGS84) (deg)" to "ETRS89/ETRS-LAEA". Yet, I would still
> appreciate if somebody could provide advice how to do such an
> operation on a raster object within R (or even on coordinate pairs
> within a data.frame).

 The spTransform function in package:rgdal is the thing for you! Also,
read up about epsg codes...

 Note however that a regular grid in one coordinate system might not
be a regular grid in another system - the cells might not even line
up. So, for example, the X coordinate of the bottom left cell which is
the same as the X coordinate of the top left cell in the original
coordinate system might not be the same in the transformed coordinate
system - the projected raster ends up as a trapezium rather than a
rectangle.

 To transform a raster from one CRS to another, use projectRaster in
the raster package, which does the necessary warping to get a regular
grid in the new system. This will involve some interpolation.

 I think your best strategy with your big raster would be to first
crop it so that when projected it will completely cover the extent of
your target area. That makes your raster smaller and more manageable.
Then project that to your target CRS, and you'll get a trapezium
shape. Crop that to your your target area.

Hope that helps.

Barry


From ubuntero.9161 at gmail.com  Tue Apr 23 16:40:01 2013
From: ubuntero.9161 at gmail.com (Ivailo)
Date: Tue, 23 Apr 2013 17:40:01 +0300
Subject: [R-sig-Geo] How to translate coordinates from cylindrical to a
 Lambert Azimuthal Equal Area Projection
In-Reply-To: <CANVKczOUmAD8dyprjVE23qnqgoU=uyJmdRVaaPA9wxY+U0txXg@mail.gmail.com>
References: <CAAVnHsu6cHv0VLDCzdoSF=Uf0umRTrrVdQw4FM2NCudjBv9TiA@mail.gmail.com>
	<a48b353d12dd464fa1e3dd6dab94a968@EX-1-HT0.lancs.local>
	<CANVKczOUmAD8dyprjVE23qnqgoU=uyJmdRVaaPA9wxY+U0txXg@mail.gmail.com>
Message-ID: <CAAVnHstkhbb2hohdTVdXCF8+8Zk-E7coj8i1-WdrSDUj=Xqm9Q@mail.gmail.com>

On Tue, Apr 23, 2013 at 3:30 PM, Barry Rowlingson
<b.rowlingson at lancaster.ac.uk> wrote:
...
>  The spTransform function in package:rgdal is the thing for you! Also,
> read up about epsg codes...

Thanks for the hint! Now I know that I need to transform the raster
object from epsg:3035 to epsg:4326, but I have difficulties to turn
this into practice as the documentation sounds somewhat cryptic to me
and I am not sure how to code the desired transformation in R. Could
you provide some example code that might do the transformation?

>  Note however that a regular grid in one coordinate system might not
> be a regular grid in another system - the cells might not even line
> up. So, for example, the X coordinate of the bottom left cell which is
> the same as the X coordinate of the top left cell in the original
> coordinate system might not be the same in the transformed coordinate
> system - the projected raster ends up as a trapezium rather than a
> rectangle.

That is good to know, but as I just want to use the coordinates for
reference only (i.e. to be able to "navigate" the raster through
Google Earth where I can easily recognize reference points to create
an extent) and not for representation, I think that these issues won't
affect me.

>  To transform a raster from one CRS to another, use projectRaster in
> the raster package, which does the necessary warping to get a regular
> grid in the new system. This will involve some interpolation.

If I understand correctly, projectRaster would work on a RasterLayer
(in contrast to spTransform), but as I couldn't come up with working
code I'd appreciate if you could provide an example using these
functions.

>  I think your best strategy with your big raster would be to first
> crop it so that when projected it will completely cover the extent of
> your target area. That makes your raster smaller and more manageable.
> Then project that to your target CRS, and you'll get a trapezium
> shape. Crop that to your your target area.

This strategy is perfectly fine, but my struggle is exactly with the
first point, i.e. to crop the big raster to something more manageable.
The raster I'm working with contains vegetation feature classes and
thus I cannot easily recognize/determine the points by visually
examining the huge plot, so I hoped to use GE for navigation and
obtaining coordinates for the crop. Namely the latter procedure called
for the option to transform the coordinates to the projection GE uses.

Thanks,
Ivailo
--
UBUNTU: a person is a person through other persons.


From Rainer at krugs.de  Tue Apr 23 17:09:11 2013
From: Rainer at krugs.de (Rainer M. Krug)
Date: Tue, 23 Apr 2013 17:09:11 +0200
Subject: [R-sig-Geo] BUG?  readRAST6() closes sink("all.Rout")
Message-ID: <87ppxlgu7c.fsf@krugs.de>

Hi

I have something strange happening and I do not know if it is a bug.

When I open a sink() and execute readRAST() the sink is closed
afterwards.

This is caused by the call to closeAllConnections() in readRAST6(). I
realise, that this can be avoided by using close_OK=FALSE, but would
there be a less radical way of closing these connections? 

Cheers,

Rainer


-- 
Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation Biology, UCT), Dipl. Phys. (Germany)

Centre of Excellence for Invasion Biology
Stellenbosch University
South Africa

Tel :       +33 - (0)9 53 10 27 44
Cell:       +33 - (0)6 85 62 59 98
Fax :       +33 - (0)9 58 10 27 44

Fax (D):    +49 - (0)3 21 21 25 22 44

email:      Rainer at krugs.de

Skype:      RMkrug
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 489 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130423/ca4cc734/attachment.bin>

From b.rowlingson at lancaster.ac.uk  Tue Apr 23 18:41:31 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Tue, 23 Apr 2013 17:41:31 +0100
Subject: [R-sig-Geo] How to translate coordinates from cylindrical to a
 Lambert Azimuthal Equal Area Projection
In-Reply-To: <8c2888af3d24459f914529388a0fbdf8@EX-0-HT0.lancs.local>
References: <CAAVnHsu6cHv0VLDCzdoSF=Uf0umRTrrVdQw4FM2NCudjBv9TiA@mail.gmail.com>
	<a48b353d12dd464fa1e3dd6dab94a968@EX-1-HT0.lancs.local>
	<CANVKczOUmAD8dyprjVE23qnqgoU=uyJmdRVaaPA9wxY+U0txXg@mail.gmail.com>
	<8c2888af3d24459f914529388a0fbdf8@EX-0-HT0.lancs.local>
Message-ID: <CANVKczMR6G-svNN-bnNuAE-p71oLT=8SFOA1ExPc8na5hBBXMQ@mail.gmail.com>

Okay, maybe all you want to do is work out where your raster projects to?

Here's a raster in epsg:3035 - you have something like this?

 > re
class       : RasterLayer
dimensions  : 10, 10, 100  (nrow, ncol, ncell)
resolution  : 7785.786, 11293.11  (x, y)
extent      : 3577016, 3654874, 3714447, 3827378  (xmin, xmax, ymin, ymax)
coord. ref. : +init=epsg:3035 +proj=laea +lat_0=52 +lon_0=10
+x_0=4321000 +y_0=3210000 +ellps=GRS80 +units=m +no_defs
data source : in memory
names       : layer
values      : 0.001494624, 0.9948669  (min, max)

Now, to see where that is in lat-long, simply do:

 > extent(projectExtent(re,CRS("+init=epsg:4326")))
class       : Extent
xmin        : -2.290917
xmax        : -0.7665775
ymin        : 56.07447
ymax        : 57.08626

(But as I keep banging on, your grid in epsg:3035 won't line up with
lat-long lines in that box)

The other thing you can do is use spTransform to work out where the
four corners of your raster transform to.

This corners function gets the four corner coordinates of a raster:

corners <- function(r){
  e = extent(r)
  x=c(xmin(e),xmin(e),xmax(e),xmax(e))
  y=c(ymin(e),ymax(e),ymin(e),ymax(e))
  SpatialPoints(data.frame(x=x,y=y),proj4string=CRS(projection(r)))
}

and returns a SpatialPoints object in the original coordinate system:

 > corners(re)
SpatialPoints:
           x       y
[1,] 3577016 3714447
[2,] 3577016 3827378
[3,] 3654874 3714447
[4,] 3654874 3827378
Coordinate Reference System (CRS) arguments: +init=epsg:3035 +proj=laea
+lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +units=m
+no_defs

Let's see where these transform to:

 > spTransform(corners(re),CRS("+init=epsg:4326"))
SpatialPoints:
             x        y
[1,] -1.972778 55.97462
[2,] -2.290917 56.97278
[3,] -0.738697 56.08479
[4,] -1.025412 57.08626
Coordinate Reference System (CRS) arguments: +init=epsg:4326
+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0

Useful?

Barry


From ubuntero.9161 at gmail.com  Tue Apr 23 22:45:34 2013
From: ubuntero.9161 at gmail.com (Ivailo)
Date: Tue, 23 Apr 2013 23:45:34 +0300
Subject: [R-sig-Geo] How to translate coordinates from cylindrical to a
 Lambert Azimuthal Equal Area Projection
In-Reply-To: <CANVKczMR6G-svNN-bnNuAE-p71oLT=8SFOA1ExPc8na5hBBXMQ@mail.gmail.com>
References: <CAAVnHsu6cHv0VLDCzdoSF=Uf0umRTrrVdQw4FM2NCudjBv9TiA@mail.gmail.com>
	<a48b353d12dd464fa1e3dd6dab94a968@EX-1-HT0.lancs.local>
	<CANVKczOUmAD8dyprjVE23qnqgoU=uyJmdRVaaPA9wxY+U0txXg@mail.gmail.com>
	<8c2888af3d24459f914529388a0fbdf8@EX-0-HT0.lancs.local>
	<CANVKczMR6G-svNN-bnNuAE-p71oLT=8SFOA1ExPc8na5hBBXMQ@mail.gmail.com>
Message-ID: <CAAVnHstzPFc8tUZ=i9guP-8h0AyhV1Ywtcm4PQR5sWCWkJDxiQ@mail.gmail.com>

On Tue, Apr 23, 2013 at 7:41 PM, Barry Rowlingson
<b.rowlingson at lancaster.ac.uk> wrote:
> Okay, maybe all you want to do is work out where your raster projects to?
...

Huge thanks, Barry! I haven't thought of the problem in this way, but
your approach is definitely more simple and practical than the one I
vaguely imagined ;-)

> (But as I keep banging on, your grid in epsg:3035 won't line up with
> lat-long lines in that box)
>
> The other thing you can do is use spTransform to work out where the
> four corners of your raster transform to.

Yes, having read further to find a way solving my problem I realized
that both grids won't match exactly! Your example demonstrated that
quite succinctly; now I'll be careful while selecting the corners of
the possible extent as planned (in GE)...

> This corners function gets the four corner coordinates of a raster:
>
> corners <- function(r){
>   e = extent(r)
>   x=c(xmin(e),xmin(e),xmax(e),xmax(e))
>   y=c(ymin(e),ymax(e),ymin(e),ymax(e))
>   SpatialPoints(data.frame(x=x,y=y),proj4string=CRS(projection(r)))
> }
>
> and returns a SpatialPoints object in the original coordinate system:
>
>  > corners(re)
> SpatialPoints:
>            x       y
> [1,] 3577016 3714447
> [2,] 3577016 3827378
> [3,] 3654874 3714447
> [4,] 3654874 3827378
> Coordinate Reference System (CRS) arguments: +init=epsg:3035 +proj=laea
> +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +units=m
> +no_defs
>
> Let's see where these transform to:
>
>  > spTransform(corners(re),CRS("+init=epsg:4326"))
> SpatialPoints:
>              x        y
> [1,] -1.972778 55.97462
> [2,] -2.290917 56.97278
> [3,] -0.738697 56.08479
> [4,] -1.025412 57.08626
> Coordinate Reference System (CRS) arguments: +init=epsg:4326
> +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0
>
> Useful?

Super useful, indeed -- thanks again for your great input, Barry!

Cheers,
Ivailo
--
UBUNTU: a person is a person through other persons.


From kmcoulib at gmail.com  Wed Apr 24 01:14:42 2013
From: kmcoulib at gmail.com (kapo coulibaly)
Date: Tue, 23 Apr 2013 19:14:42 -0400
Subject: [R-sig-Geo] command "over" works in windows and not linux
Message-ID: <CANcefXY7qdtjOTdMPmkR7RgW_8tvbF+VgwJQvL4b24A7nfCoDQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130423/32717e4d/attachment.pl>

From edzer.pebesma at uni-muenster.de  Wed Apr 24 08:08:41 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 24 Apr 2013 08:08:41 +0200
Subject: [R-sig-Geo] command "over" works in windows and not linux
In-Reply-To: <CANcefXY7qdtjOTdMPmkR7RgW_8tvbF+VgwJQvL4b24A7nfCoDQ@mail.gmail.com>
References: <CANcefXY7qdtjOTdMPmkR7RgW_8tvbF+VgwJQvL4b24A7nfCoDQ@mail.gmail.com>
Message-ID: <517776E9.5060808@uni-muenster.de>

You don't provide a reproducible example, so we can only guess.

The error message indicates an over() method provided by rgeos was
needed. Was rgeos loaded in both cases?

On 04/24/2013 01:14 AM, kapo coulibaly wrote:
> I'm running the following script:
> 
> # Reading shapefiles
> grd.shp<-openshape()
> reaches.shp<-openshape()
> grd.shp->grd2.shp
> 
> # Creating a subset of the grid around the reaches exttent
> sub.ind<-over(grd.shp,reaches.shp)
> 
> In linux slackware 13.37 x64 running R-2.15.2 I get the error:
> 
> Error in function (classes, fdef, mtable)  :
>   unable to find an inherited method for function "over", for
> signature "SpatialPolygonsDataFrame", "SpatialLinesDataFrame"
> 
> 
> But in windows 7 x64 with R-2.15.1 it works flawlessly
> 
> Thanks
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From roman.lustrik at gmail.com  Wed Apr 24 08:36:40 2013
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Wed, 24 Apr 2013 08:36:40 +0200
Subject: [R-sig-Geo] command "over" works in windows and not linux
In-Reply-To: <CANcefXY7qdtjOTdMPmkR7RgW_8tvbF+VgwJQvL4b24A7nfCoDQ@mail.gmail.com>
References: <CANcefXY7qdtjOTdMPmkR7RgW_8tvbF+VgwJQvL4b24A7nfCoDQ@mail.gmail.com>
Message-ID: <CAHT1vpjjQ2u3fRxGzSCh95PLSOsbbP4eQcN8V88izy_BC-YNnw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130424/4980f954/attachment.pl>

From Roger.Bivand at nhh.no  Wed Apr 24 08:44:20 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 24 Apr 2013 08:44:20 +0200
Subject: [R-sig-Geo] command "over" works in windows and not linux
In-Reply-To: <CANcefXY7qdtjOTdMPmkR7RgW_8tvbF+VgwJQvL4b24A7nfCoDQ@mail.gmail.com>
References: <CANcefXY7qdtjOTdMPmkR7RgW_8tvbF+VgwJQvL4b24A7nfCoDQ@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1304240841130.13070@reclus.nhh.no>

On Wed, 24 Apr 2013, kapo coulibaly wrote:

> I'm running the following script:
>
> # Reading shapefiles
> grd.shp<-openshape()
> reaches.shp<-openshape()
> grd.shp->grd2.shp
>
> # Creating a subset of the grid around the reaches exttent
> sub.ind<-over(grd.shp,reaches.shp)
>
> In linux slackware 13.37 x64 running R-2.15.2 I get the error:
>
> Error in function (classes, fdef, mtable)  :
>  unable to find an inherited method for function "over", for
> signature "SpatialPolygonsDataFrame", "SpatialLinesDataFrame"
>
>
> But in windows 7 x64 with R-2.15.1 it works flawlessly
>
> Thanks
>
> 	[[alternative HTML version deleted]]

NO HTML please!

In addition to the other problems with your posting, careful attention to 
differences in sessionInfo() on the two systems would certainly show that 
package versions, or the loaded packages, differ. It is really worth 
running sessionInfo() in comparative situations like this, as packages do 
behave differently between versions, as well as differently if a 
"suggested" package is available or not.

Roger

>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Wed Apr 24 09:09:03 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 24 Apr 2013 09:09:03 +0200
Subject: [R-sig-Geo] BUG?  readRAST6() closes sink("all.Rout")
In-Reply-To: <87ppxlgu7c.fsf@krugs.de>
References: <87ppxlgu7c.fsf@krugs.de>
Message-ID: <alpine.LRH.2.03.1304240905450.13070@reclus.nhh.no>

On Tue, 23 Apr 2013, Rainer M. Krug wrote:

> Hi
>
> I have something strange happening and I do not know if it is a bug.
>
> When I open a sink() and execute readRAST() the sink is closed
> afterwards.
>
> This is caused by the call to closeAllConnections() in readRAST6(). I
> realise, that this can be avoided by using close_OK=FALSE, but would
> there be a less radical way of closing these connections?

Replaced by counting open connections on entry, and only closing 
connections added to the connection table while running the function, in 
revision 1384. This is not thread-safe (it doesn't cater for something 
else opening connections in R but not in readRAST6), but this should at 
least be less radical than closing them all. The reason for closing is 
that multiple links are opened to GRASS modules, wher the number open 
isn't easy to control.

Roger

>
> Cheers,
>
> Rainer
>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From matteo.mattiuzzi at boku.ac.at  Wed Apr 24 09:52:59 2013
From: matteo.mattiuzzi at boku.ac.at (Matteo Mattiuzzi)
Date: Wed, 24 Apr 2013 09:52:59 +0200
Subject: [R-sig-Geo] rgdal_0.8-8 spTransform
Message-ID: <5177AB7B0200002700019933@gwia2.boku.ac.at>

Dear rgdal Maintainers,
spTransform is not available for standard call. I haven't tested other rgdal functions but the problem has happened with the last update of rgdal (I think today).  
Matteo


> sessionInfo()
R version 2.15.3 (2013-03-01)
Platform: x86_64-pc-linux-gnu (64-bit)


locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=C                 LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       


attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     


other attached packages:
[1] rgdal_0.8-8   rgeos_0.2-16  snow_0.3-12   raster_2.1-25 sp_1.0-9     


loaded via a namespace (and not attached):
[1] grid_2.15.3     lattice_0.20-15 tools_2.15.3   


> spTransform
Error: object 'spTransform' not found


> rgdal:::spTransform
standardGeneric for "spTransform" defined from package "rgdal"


function (x, CRSobj, ...) 
standardGeneric("spTransform")

Methods may be defined for arguments: x, CRSobj
Use  showMethods("spTransform")  for currently available ones.


From Roger.Bivand at nhh.no  Wed Apr 24 10:27:07 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 24 Apr 2013 10:27:07 +0200
Subject: [R-sig-Geo] rgdal_0.8-8 spTransform
In-Reply-To: <5177AB7B0200002700019933@gwia2.boku.ac.at>
References: <5177AB7B0200002700019933@gwia2.boku.ac.at>
Message-ID: <alpine.LRH.2.03.1304241021470.13070@reclus.nhh.no>

On Wed, 24 Apr 2013, Matteo Mattiuzzi wrote:

> Dear rgdal Maintainers, spTransform is not available for standard call. 
> I haven't tested other rgdal functions but the problem has happened with 
> the last update of rgdal (I think today). Matteo

The definition of the spTransform method was moved as of sp 1.0-9 and 
rgdal 0.8-8 from rgdal to sp. I cannot reproduce your problem on R 3.0.0, 
so there may be differences between the methods package in 3.0.0 and 
2.15.3, but I suggest reinstalling sp, then rgdal, in that order to ensure 
that the methods database is refreshed. Did you use update.packages() - 
which sorts rgdal before sp? That shouldn't hurt, as rgdal 0.8-8 depends 
on sp >= 1.0-9, so should not install if the sp version is earlier.

Roger

>
>
>> sessionInfo()
> R version 2.15.3 (2013-03-01)
> Platform: x86_64-pc-linux-gnu (64-bit)
>
>
> locale:
> [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
> [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
> [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
> [7] LC_PAPER=C                 LC_NAME=C
> [9] LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
>
> other attached packages:
> [1] rgdal_0.8-8   rgeos_0.2-16  snow_0.3-12   raster_2.1-25 sp_1.0-9
>
>
> loaded via a namespace (and not attached):
> [1] grid_2.15.3     lattice_0.20-15 tools_2.15.3
>
>
>> spTransform
> Error: object 'spTransform' not found
>
>
>> rgdal:::spTransform
> standardGeneric for "spTransform" defined from package "rgdal"
>
>
> function (x, CRSobj, ...)
> standardGeneric("spTransform")
>
> Methods may be defined for arguments: x, CRSobj
> Use  showMethods("spTransform")  for currently available ones.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From matteo.mattiuzzi at boku.ac.at  Wed Apr 24 10:44:00 2013
From: matteo.mattiuzzi at boku.ac.at (Matteo Mattiuzzi)
Date: Wed, 24 Apr 2013 10:44:00 +0200
Subject: [R-sig-Geo] rgdal_0.8-8 spTransform
Message-ID: <5177B7700200002700019944@gwia2.boku.ac.at>

Dear Roger, 
yes I've used update.packages()
re-installing (without removing first) sp and then rgdal using install.packages("sp") ; install.packages("rgdal") ... solved the problem.
Thanks 
Matteo

>>> Roger Bivand  04/24/13 10:27 AM >>>
On Wed, 24 Apr 2013, Matteo Mattiuzzi wrote:

> Dear rgdal Maintainers, spTransform is not available for standard call. 
> I haven't tested other rgdal functions but the problem has happened with 
> the last update of rgdal (I think today). Matteo

The definition of the spTransform method was moved as of sp 1.0-9 and 
rgdal 0.8-8 from rgdal to sp. I cannot reproduce your problem on R 3.0.0, 
so there may be differences between the methods package in 3.0.0 and 
2.15.3, but I suggest reinstalling sp, then rgdal, in that order to ensure 
that the methods database is refreshed. Did you use update.packages() - 
which sorts rgdal before sp? That shouldn't hurt, as rgdal 0.8-8 depends 
on sp >= 1.0-9, so should not install if the sp version is earlier.

Roger

>
>
>> sessionInfo()
> R version 2.15.3 (2013-03-01)
> Platform: x86_64-pc-linux-gnu (64-bit)
>
>
> locale:
> [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
> [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
> [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
> [7] LC_PAPER=C                 LC_NAME=C
> [9] LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
>
> other attached packages:
> [1] rgdal_0.8-8   rgeos_0.2-16  snow_0.3-12   raster_2.1-25 sp_1.0-9
>
>
> loaded via a namespace (and not attached):
> [1] grid_2.15.3     lattice_0.20-15 tools_2.15.3
>
>
>> spTransform
> Error: object 'spTransform' not found
>
>
>> rgdal:::spTransform
> standardGeneric for "spTransform" defined from package "rgdal"
>
>
> function (x, CRSobj, ...)
> standardGeneric("spTransform")
>
> Methods may be defined for arguments: x, CRSobj
> Use  showMethods("spTransform")  for currently available ones.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Rainer at krugs.de  Wed Apr 24 11:18:46 2013
From: Rainer at krugs.de (Rainer M. Krug)
Date: Wed, 24 Apr 2013 11:18:46 +0200
Subject: [R-sig-Geo] BUG?  readRAST6() closes sink("all.Rout")
In-Reply-To: <alpine.LRH.2.03.1304240905450.13070@reclus.nhh.no> (Roger
	Bivand's message of "Wed, 24 Apr 2013 09:09:03 +0200")
References: <87ppxlgu7c.fsf@krugs.de>
	<alpine.LRH.2.03.1304240905450.13070@reclus.nhh.no>
Message-ID: <87ehe02snd.fsf@krugs.de>

Roger Bivand <Roger.Bivand at nhh.no> writes:

> On Tue, 23 Apr 2013, Rainer M. Krug wrote:
>
>> Hi
>>
>> I have something strange happening and I do not know if it is a bug.
>>
>> When I open a sink() and execute readRAST() the sink is closed
>> afterwards.
>>
>> This is caused by the call to closeAllConnections() in readRAST6(). I
>> realise, that this can be avoided by using close_OK=FALSE, but would
>> there be a less radical way of closing these connections?
>
> Replaced by counting open connections on entry, and only closing
> connections added to the connection table while running the function,
> in revision 1384. 

Thanks - so I can use sink() without getting it closed by
readRAST(...close_OK=TRUE).

> This is not thread-safe (it doesn't cater for
> something else opening connections in R but not in readRAST6), but
> this should at least be less radical than closing them all. The reason
> for closing is that multiple links are opened to GRASS modules, wher
> the number open isn't easy to control.

OK. Thanks for the clarification and the solution,

Thanks a lot,

Rainer

>
> Roger
>
>>
>> Cheers,
>>
>> Rainer
>>
>>
>>


-- 
Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation Biology, UCT), Dipl. Phys. (Germany)

Centre of Excellence for Invasion Biology
Stellenbosch University
South Africa

Tel :       +33 - (0)9 53 10 27 44
Cell:       +33 - (0)6 85 62 59 98
Fax :       +33 - (0)9 58 10 27 44

Fax (D):    +49 - (0)3 21 21 25 22 44

email:      Rainer at krugs.de

Skype:      RMkrug
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 489 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130424/3dc8e799/attachment.bin>

From julian at hafro.is  Wed Apr 24 11:34:59 2013
From: julian at hafro.is (Julian M. Burgos)
Date: Wed, 24 Apr 2013 09:34:59 +0000
Subject: [R-sig-Geo] How to translate coordinates from cylindrical to a
	Lambert Azimuthal Equal Area Projection
In-Reply-To: <CAAVnHsu6cHv0VLDCzdoSF=Uf0umRTrrVdQw4FM2NCudjBv9TiA@mail.gmail.com>
References: <CAAVnHsu6cHv0VLDCzdoSF=Uf0umRTrrVdQw4FM2NCudjBv9TiA@mail.gmail.com>
Message-ID: <xgzk3ns8e64.fsf@hafnfirdingur.hafro.is>

Hi Ivailo,

I would just create a SpatialPoints object with four points defining the
horizontal and vertical extent of your area of interest.  Something like
this:

maximum latitude, mean longitude
minimum latitude, mean longitude
mean latitude, maximum longitude
mean latitude, maximum longitude

Make sure that the projection for these points is ("+proj=longlat
+datum=WGS84").

Then use the spTransform function (rgdal package) to transform these
four points into the Lambert Azimuthal Equal Area projection.  Now you
have your horizontal and vertical ranges. 

Next, use the raster package. Create an Extent object with your
 horizontal and vertical ranges, and use the crop function to change the
 extent of your raster to your area of interest.

Good luck!

Julian

Julian Mariano Burgos, PhD
Hafranns?knastofnunin/Marine Research Institute
Sk?lagata 4, 121 Reykjav?k, Iceland
S?mi/Telephone : +354-5752037
Br?fs?mi/Telefax:  +354-5752001
Netfang/Email: julian at hafro.is

Ivailo writes:

> Dear Listmembers,
>
> I have a 40 000 x 40 000 GeoTIFF file that I need to crop to an area
> of interest (perhaps about 1000 x 1000 pixels, 25 x 25 m grid). The
> file seems to be in the Lambert Azimuthal Equal Area Projection
> (coord. ref. : +proj=laea +lat_0=52 +lon_0=10 +x_0=4321000
> +y_0=3210000 +ellps=GRS80 +units=m +no_defs) while I use Google Earth
> (using a Cylindrical projection with a WGS84 datum) to navigate and
> delineate the extent of the area I'd like to crop from the original
> file.
>
> As I don't have much experience working with Raster* objects as
> defined in the raster package, I'd like to ask you for help in
> "translating" the coordinates I get from Google Earth (i.e., decimal
> degrees) to the ones needed to define the extent of interest for the
> RasterLayer object I have created by reading the GeoTiff file via
> `raster("myfile.tif")`.
>
> Any insight would be much appreciated.
>
> Ivailo
> --
> UBUNTU: a person is a person through other persons.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


--


From ubuntero.9161 at gmail.com  Wed Apr 24 12:36:21 2013
From: ubuntero.9161 at gmail.com (Ivailo)
Date: Wed, 24 Apr 2013 13:36:21 +0300
Subject: [R-sig-Geo] How to translate coordinates from cylindrical to a
 Lambert Azimuthal Equal Area Projection
In-Reply-To: <xgzk3ns8e64.fsf@hafnfirdingur.hafro.is>
References: <CAAVnHsu6cHv0VLDCzdoSF=Uf0umRTrrVdQw4FM2NCudjBv9TiA@mail.gmail.com>
	<xgzk3ns8e64.fsf@hafnfirdingur.hafro.is>
Message-ID: <CAAVnHsvtsbO4CucddvY70+ouDN8gwoGcTwtA4XSAwWQ8=FaUqQ@mail.gmail.com>

On Wed, Apr 24, 2013 at 12:34 PM, Julian M. Burgos <julian at hafro.is> wrote:
> Hi Ivailo,
>
> I would just create a SpatialPoints object with four points defining the
> horizontal and vertical extent of your area of interest.  Something like
> this:
>
> maximum latitude, mean longitude
> minimum latitude, mean longitude
> mean latitude, maximum longitude
> mean latitude, maximum longitude
>
> Make sure that the projection for these points is ("+proj=longlat
> +datum=WGS84").
>
> Then use the spTransform function (rgdal package) to transform these
> four points into the Lambert Azimuthal Equal Area projection.  Now you
> have your horizontal and vertical ranges.
>
> Next, use the raster package. Create an Extent object with your
>  horizontal and vertical ranges, and use the crop function to change the
>  extent of your raster to your area of interest.
>
> Good luck!
>
> Julian

Thank you for the input, Julian! In the previous post Barry worked out
a similar approach to solving the task at hand.

Best,
Ivailo
--
UBUNTU: a person is a person through other persons.


From kmcoulib at gmail.com  Wed Apr 24 14:24:01 2013
From: kmcoulib at gmail.com (kapo coulibaly)
Date: Wed, 24 Apr 2013 08:24:01 -0400
Subject: [R-sig-Geo] command "over" works in windows and not linux
In-Reply-To: <517776E9.5060808@uni-muenster.de>
References: <CANcefXY7qdtjOTdMPmkR7RgW_8tvbF+VgwJQvL4b24A7nfCoDQ@mail.gmail.com>
	<517776E9.5060808@uni-muenster.de>
Message-ID: <CANcefXbVrAH5yjFfBmUkk8-8XzHdY=EFknN3+ADbdcC=ybmPJQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130424/12783cab/attachment.pl>

From tersagokatrien at gmail.com  Wed Apr 24 16:34:34 2013
From: tersagokatrien at gmail.com (KaTe)
Date: Wed, 24 Apr 2013 07:34:34 -0700 (PDT)
Subject: [R-sig-Geo] zApply
Message-ID: <1366814074663-7583405.post@n2.nabble.com>

Dear R-sig-geo, 
I have a problem with the use of zApply on a large Rasterbrick made from a
netcdf file. 
It concerns a file with daily rainfall data for a period of 15 years on a
european scale (see details below)

-------------------------
class       : RasterBrick 
dimensions  : 201, 464, 93264, 6575  (nrow, ncol, ncell, nlayers)
resolution  : 0.25, 0.25  (x, y)
extent      : -40.5, 75.5, 25.25, 75.5  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0 
names       : X1995.01.01, X1995.01.02, X1995.01.03, X1995.01.04,
X1995.01.05, X1995.01.06, X1995.01.07, X1995.01.08, X1995.01.09,
X1995.01.10, X1995.01.11, X1995.01.12, X1995.01.13, X1995.01.14,
X1995.01.15, ... 
Date        : 1995-01-01, 2012-12-31 (min, max)
varname     : rr 
--------------------------

Now, I want to change this brick with daily data into a brick of monthly
means (per year) prior to data extraction. I am quite convinced I should use
zApply for this, but up till now I was not able to use (read: fully
understand) the few examples from the raster manual or this list
successfully. 
I tried the code below, with RR being the raster brick: 

library(zoo)
library(base)
index<- seq(as.Date('1995-01-01'), as.Date('2012-12-31'), by='day')
RR<-setZ(RR,index)
system.time(RRmonths<-zApply(RR,by="month", FUN=mean))

when I try this on a subset of 2 years I only get a single raster file, so
clearly something is wrong. 
Even if this works, I fear this code will give me the monthly averages over
the whole series, while I need mean monthly values per year (using yearmon
gives errors). 

I am new to this field, hope anyone could give me some hints to move
forward. (Or some other approach )
Thanks in advance,
 
Kate
PhD, University of Antwerp







--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/zApply-tp7583405.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From oscar.perpinan at gmail.com  Wed Apr 24 19:27:14 2013
From: oscar.perpinan at gmail.com (Oscar =?utf-8?B?UGVycGnDscOhbg==?= Lamigueiro)
Date: Wed, 24 Apr 2013 19:27:14 +0200
Subject: [R-sig-Geo] zApply
In-Reply-To: <1366814074663-7583405.post@n2.nabble.com>
References: <1366814074663-7583405.post@n2.nabble.com>
Message-ID: <87ppxj3klp.fsf@gmail.com>

Hello Kate,

I have modified your code. Try the code I copy below.

Best,

Oscar.

library(zoo)
## You were using library(base) but I am sure you really want raster :-)
library(raster)

## Data example: substitute it with your brick and time index
r <- raster(ncol=2, nrow=2)
index <- seq(as.Date('2000-01-01'), as.Date('2012-12-31'), by='day')
RR <- brick(lapply(seq_along(index), function(x) setValues(r, rnorm(ncell(r)))))

RR <- setZ(RR,index)
## If you only need monthly averages, first you have to define an
## auxiliary function to extract the month from the time index
month <- function(x)as.numeric(format(x, '%m'))
RRmonth <- zApply(RR, by=month, FUN=mean)
## But if you need monthly averages per year, zoo::as.yearmon is
## your function
RRyearmon <- zApply(RR,by=as.yearmon, FUN=mean)

KaTe <tersagokatrien at gmail.com> writes:

> Dear R-sig-geo, 
> I have a problem with the use of zApply on a large Rasterbrick made from a
> netcdf file. 
> It concerns a file with daily rainfall data for a period of 15 years on a
> european scale (see details below)
>
> -------------------------
> class       : RasterBrick 
> dimensions  : 201, 464, 93264, 6575  (nrow, ncol, ncell, nlayers)
> resolution  : 0.25, 0.25  (x, y)
> extent      : -40.5, 75.5, 25.25, 75.5  (xmin, xmax, ymin, ymax)
> coord. ref. : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0 
> names       : X1995.01.01, X1995.01.02, X1995.01.03, X1995.01.04,
> X1995.01.05, X1995.01.06, X1995.01.07, X1995.01.08, X1995.01.09,
> X1995.01.10, X1995.01.11, X1995.01.12, X1995.01.13, X1995.01.14,
> X1995.01.15, ... 
> Date        : 1995-01-01, 2012-12-31 (min, max)
> varname     : rr 
> --------------------------
>
> Now, I want to change this brick with daily data into a brick of monthly
> means (per year) prior to data extraction. I am quite convinced I should use
> zApply for this, but up till now I was not able to use (read: fully
> understand) the few examples from the raster manual or this list
> successfully. 
> I tried the code below, with RR being the raster brick: 
>
> library(zoo)
> library(base)
> index<- seq(as.Date('1995-01-01'), as.Date('2012-12-31'), by='day')
> RR<-setZ(RR,index)
> system.time(RRmonths<-zApply(RR,by="month", FUN=mean))
>
> when I try this on a subset of 2 years I only get a single raster file, so
> clearly something is wrong. 
> Even if this works, I fear this code will give me the monthly averages over
> the whole series, while I need mean monthly values per year (using yearmon
> gives errors). 
>
> I am new to this field, hope anyone could give me some hints to move
> forward. (Or some other approach )
> Thanks in advance,
>  
> Kate
> PhD, University of Antwerp
>
>
>
>
>
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/zApply-tp7583405.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


-- 
Oscar Perpi??n Lamigueiro
Grupo de Sistemas Fotovoltaicos (IES-UPM)
Dpto. Ingenier?a El?ctrica (EUITI-UPM)
URL: http://procomun.wordpress.com
Twitter: @oscarperpinan


From alessandracarioli at gmail.com  Thu Apr 25 11:56:43 2013
From: alessandracarioli at gmail.com (Alessandra Carioli)
Date: Thu, 25 Apr 2013 11:56:43 +0200
Subject: [R-sig-Geo] library(classInt) problem with mapping multiple maps in
	one maps
Message-ID: <CAK6730sVB9sA_yGo9pwNqp3mz1PxXW_gk8Qa=nzKC_L=Fm_H_w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130425/51045576/attachment.pl>

From kirill.mueller at ivt.baug.ethz.ch  Thu Apr 25 12:20:04 2013
From: kirill.mueller at ivt.baug.ethz.ch (=?ISO-8859-1?Q?Kirill_M=FCller?=)
Date: Thu, 25 Apr 2013 12:20:04 +0200
Subject: [R-sig-Geo] rgdal: libgdal requirements too restrictive
In-Reply-To: <alpine.LRH.2.03.1304221003490.32520@reclus.nhh.no>
References: <516B07E3.30602@ivt.baug.ethz.ch>
	<alpine.LRH.2.03.1304151038320.8250@reclus.nhh.no>
	<5173E81C.6000906@ivt.baug.ethz.ch>
	<alpine.LRH.2.03.1304212006400.29054@reclus.nhh.no>
	<5174413E.8030408@ivt.baug.ethz.ch>
	<alpine.LRH.2.03.1304221003490.32520@reclus.nhh.no>
Message-ID: <51790354.3030505@ivt.baug.ethz.ch>

Dear Roger

On 04/22/2013 10:23 AM, Roger Bivand wrote:
> If you would like to change the condition in configure.ac, rebuild 
> configure, and try out R CMD check (checking out rgeos from R-forge 
> for convenience), we could relax from 3.2.2 to 3.2.0.
>
> You could try the same approach with rgdal and GDAL 1.6.3 (multiple 
> packages)

I can confirm that, on an up-to-date Debian "wheezy" amd64, rgeos passes 
R CMD check if libgeos has version 3.2.0. Likewise, rgdal passes R CMD 
check with libgdal=1.6.3. I have attached patches for your convenience. 
Thank you for your help.


Cheers

Kirill
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0001-reduce-libgeos-requirements-to-3.2.0-for-compatibili.patch
Type: text/x-patch
Size: 1979 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130425/fc7ded02/attachment.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 0001-reduce-libgdal-requirements-to-1.6.3-for-compatibili.patch
Type: text/x-patch
Size: 1960 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130425/fc7ded02/attachment-0001.bin>

From kirill.mueller at ivt.baug.ethz.ch  Thu Apr 25 12:51:49 2013
From: kirill.mueller at ivt.baug.ethz.ch (=?ISO-8859-1?Q?Kirill_M=FCller?=)
Date: Thu, 25 Apr 2013 12:51:49 +0200
Subject: [R-sig-Geo] Nearest neighbor for two spatial datasets
Message-ID: <51790AC5.6040805@ivt.baug.ethz.ch>

Hello

I am looking for a fast implementation for finding, for each object in 
dataset A, the closest object of dataset B. A naive approach using 
gDistance et al. considers each pair AxB, but this can be improved by 
using a spatial index in B.

Is there such an implementation for R?

See also this question on StackOverflow: 
http://stackoverflow.com/questions/15992158/spatial-matching-of-big-datasets


Cheers

Kirill


From Roger.Bivand at nhh.no  Thu Apr 25 14:47:39 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 25 Apr 2013 14:47:39 +0200
Subject: [R-sig-Geo] Nearest neighbor for two spatial datasets
In-Reply-To: <51790AC5.6040805@ivt.baug.ethz.ch>
References: <51790AC5.6040805@ivt.baug.ethz.ch>
Message-ID: <alpine.LRH.2.03.1304251427510.20162@reclus.nhh.no>

On Thu, 25 Apr 2013, Kirill M?ller wrote:

> Hello
>
> I am looking for a fast implementation for finding, for each object in 
> dataset A, the closest object of dataset B. A naive approach using gDistance 
> et al. considers each pair AxB, but this can be improved by using a spatial 
> index in B.
>
> Is there such an implementation for R?

Please see ?gBinarySTRtreeQuery in rgeos, but note that at present the 
query only returns intersecting envelopes (bounding boxes) for sets of 
objects, so is not exactly the kond of tree you are thinking of.

Since you mention gDistance, the geometries are planar, in which case 
querying using RANN for distances between points may hep; RANN is an 
interfacing of ANN (approximate nearest neighbour) for R. RANN builds a 
tree internally then queries on that tree. Better tree handling could be 
implemented in rgeos too if that route would make sense, but STRtreeQuery 
in GEOS is limited to overlapping envelopes:

http://geos.osgeo.org/doxygen/classgeos_1_1index_1_1strtree_1_1STRtree.html

So rgeos STRTrees only tell you if non-point objects have overlapping 
envelopes (only polygons and lines, not much help for distance), RANN kan 
handle large numbers of points, but no polygons or lines. You could look 
at libspatialindex, which hasn't been interfaced to R, to see if it 
permits distance queries rather than overlapping rectangular range 
queries.

Hope this helps,

Roger

>
> See also this question on StackOverflow: 
> http://stackoverflow.com/questions/15992158/spatial-matching-of-big-datasets
>
>
> Cheers
>
> Kirill
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From pharriso at uwaterloo.ca  Thu Apr 25 17:32:00 2013
From: pharriso at uwaterloo.ca (Phil H)
Date: Thu, 25 Apr 2013 08:32:00 -0700 (PDT)
Subject: [R-sig-Geo] complex coastline and adehabitatHR: trouble with
 kerneloverlaphr function after coastline has been clipped out
In-Reply-To: <1354642761294-7581851.post@n2.nabble.com>
References: <1354642761294-7581851.post@n2.nabble.com>
Message-ID: <1366903920324-7583411.post@n2.nabble.com>

Hi,

I am also running into an identical problem- kerneloverlaphr does not seem
to work with my clipped UD...I also get all zeros using the PHR method and
all NaNs using the HR method.

I am really happy with the way the clipping method has worked for my data-
this forum has been super helpful!

did anyone ever find a solution?

Thanks for your time!

Phil H





--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/complex-coastline-and-adehabitatHR-trouble-with-kerneloverlaphr-function-after-coastline-has-been-clt-tp7581851p7583411.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Andrew.Duff at dfw.wa.gov  Thu Apr 25 19:22:45 2013
From: Andrew.Duff at dfw.wa.gov (Duff, Andrew A (DFW))
Date: Thu, 25 Apr 2013 17:22:45 +0000
Subject: [R-sig-Geo] 3d distance to nearest feature over terrain?
Message-ID: <F69351571CBC1942904F278D3B8FFB1707190E96@WAXMXOLYMB026.WAX.wa.lcl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130425/08e1d1d5/attachment.pl>

From mkbartl at gmail.com  Thu Apr 25 22:53:52 2013
From: mkbartl at gmail.com (Megan Bartlett)
Date: Thu, 25 Apr 2013 13:53:52 -0700
Subject: [R-sig-Geo] Sample size and different border correction methods for
 the Lcross.inhom function in spatstat
Message-ID: <CAB2zMEGKWY8J04+-4hw4WBx4+Zz_oaaiDNzV35jwB7b-RGSwuA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130425/9c9868ea/attachment.pl>

From Roger.Bivand at nhh.no  Fri Apr 26 11:38:45 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 26 Apr 2013 11:38:45 +0200
Subject: [R-sig-Geo] rgdal: libgdal requirements too restrictive
In-Reply-To: <51790354.3030505@ivt.baug.ethz.ch>
References: <516B07E3.30602@ivt.baug.ethz.ch>
	<alpine.LRH.2.03.1304151038320.8250@reclus.nhh.no>
	<5173E81C.6000906@ivt.baug.ethz.ch>
	<alpine.LRH.2.03.1304212006400.29054@reclus.nhh.no>
	<5174413E.8030408@ivt.baug.ethz.ch>
	<alpine.LRH.2.03.1304221003490.32520@reclus.nhh.no>
	<51790354.3030505@ivt.baug.ethz.ch>
Message-ID: <alpine.LRH.2.03.1304261137240.4635@reclus.nhh.no>

On Thu, 25 Apr 2013, Kirill M?ller wrote:

> Dear Roger
>
> On 04/22/2013 10:23 AM, Roger Bivand wrote:
>> If you would like to change the condition in configure.ac, rebuild 
>> configure, and try out R CMD check (checking out rgeos from R-forge for 
>> convenience), we could relax from 3.2.2 to 3.2.0.
>> 
>> You could try the same approach with rgdal and GDAL 1.6.3 (multiple 
>> packages)
>
> I can confirm that, on an up-to-date Debian "wheezy" amd64, rgeos passes R 
> CMD check if libgeos has version 3.2.0. Likewise, rgdal passes R CMD check 
> with libgdal=1.6.3. I have attached patches for your convenience. Thank you 
> for your help.

Thanks, patches committed to R-forge for rgeos and rgdal. Please check 
after updating from the repository, and report. If OK, the changes will be 
in the next CRAN releases.

Roger

>
>
> Cheers
>
> Kirill
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From rossahmed at googlemail.com  Fri Apr 26 16:10:57 2013
From: rossahmed at googlemail.com (Ross Ahmed)
Date: Fri, 26 Apr 2013 15:10:57 +0100
Subject: [R-sig-Geo] remove points less than certain distance
Message-ID: <CDA04981.4A46%rossahmed@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130426/486fbba0/attachment.pl>

From macqueen1 at llnl.gov  Fri Apr 26 21:25:46 2013
From: macqueen1 at llnl.gov (MacQueen, Don)
Date: Fri, 26 Apr 2013 19:25:46 +0000
Subject: [R-sig-Geo] writeRaster and RGB vs Gray
Message-ID: <5E1B812FAC2C4A49B3D99593B5A521913D856D@PRDEXMBX-08.the-lab.llnl.gov>

Here's a little example script using functions from the raster package,

r1 <- r2 <- r3 <- raster(ncol=25,nrow=25,
     xmn=0, ymn=0, xmx=1, ymx=1)
r1[] <- round(runif(25^2,0,255))
r2[] <- round(runif(25^2,0,255))
r3[] <- round(runif(25^2,0,255))
s <- stack(r1,r2,r3)

plotRGB(s)

writeRaster(s,'s.tif', format='GTiff', overwrite=TRUE,
            bandorder='BSQ')


When I open the file s.tif in QGIS, it's fine; I see the same image as in
R.

But the Mac platform's default viewer, Preview.app, thinks the file's
color model is "Gray", rather than "RGB", and it does not render properly.
Preview does recognize, for example, a jpeg photo as having an RGB color
model.
(Adobe Reader (for Mac) wouldn't open it at all.)

Is there some better set of arguments to give writeRaster that will
somehow make the file more broadly recognizable as RGB?

-- 
Don MacQueen

Lawrence Livermore National Laboratory
7000 East Ave., L-627
Livermore, CA 94550
925-423-1062


From b.rowlingson at lancaster.ac.uk  Fri Apr 26 21:53:01 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Fri, 26 Apr 2013 20:53:01 +0100
Subject: [R-sig-Geo] writeRaster and RGB vs Gray
In-Reply-To: <ec95d62bff90497c8dfcb97720bb7460@EX-0-HT0.lancs.local>
References: <ec95d62bff90497c8dfcb97720bb7460@EX-0-HT0.lancs.local>
Message-ID: <CANVKczN+g5b3eZLusxth5pS41KSsUfDKJ17cYqVabzuWUOcCCg@mail.gmail.com>

On Fri, Apr 26, 2013 at 8:25 PM, MacQueen, Don <macqueen1 at llnl.gov> wrote:
> Here's a little example script using functions from the raster package,
>
> r1 <- r2 <- r3 <- raster(ncol=25,nrow=25,
>      xmn=0, ymn=0, xmx=1, ymx=1)
> r1[] <- round(runif(25^2,0,255))
> r2[] <- round(runif(25^2,0,255))
> r3[] <- round(runif(25^2,0,255))
> s <- stack(r1,r2,r3)
>
> plotRGB(s)
>
> writeRaster(s,'s.tif', format='GTiff', overwrite=TRUE,
>             bandorder='BSQ')
>
>
> When I open the file s.tif in QGIS, it's fine; I see the same image as in
> R.
>
> But the Mac platform's default viewer, Preview.app, thinks the file's
> color model is "Gray", rather than "RGB", and it does not render properly.
> Preview does recognize, for example, a jpeg photo as having an RGB color
> model.
> (Adobe Reader (for Mac) wouldn't open it at all.)
>
> Is there some better set of arguments to give writeRaster that will
> somehow make the file more broadly recognizable as RGB?

 Hmmm. I think QGIS just makes a guess that any 3-band image is R,G
and B. But there must be some tag in a tiff file that specifies this
explicitly...

  If I create a tif as above, and also create one with gimp, then I
can run 'tiffinfo' on them:

 The R one has "Photometric Interpretation: min-is-black", whereas the
Gimp one has "RGB Color". The problem is now how to change that tag in
the R output tiff!

 This can be done on the command line:

tiffset -s 262 2 s.tif

 where 262 is the id of the photometric interpretation tag and 2 means
'rgb': http://www.awaresystems.be/imaging/tiff/tifftags/photometricinterpretation.html

 but I can't see how to do this in writeRaster...

 ah ha.

writeRaster([all that other stuff], options="PHOTOMETRIC=RGB")

got from the list of gdal driver options: http://www.gdal.org/frmt_gtiff.html

sorted.

Barry


From macqueen1 at llnl.gov  Fri Apr 26 22:15:34 2013
From: macqueen1 at llnl.gov (MacQueen, Don)
Date: Fri, 26 Apr 2013 20:15:34 +0000
Subject: [R-sig-Geo] writeRaster and RGB vs Gray
In-Reply-To: <CANVKczN+g5b3eZLusxth5pS41KSsUfDKJ17cYqVabzuWUOcCCg@mail.gmail.com>
Message-ID: <5E1B812FAC2C4A49B3D99593B5A521913D87BA@PRDEXMBX-08.the-lab.llnl.gov>

Thanks, Barry, this is very helpful.

-Don

-- 
Don MacQueen

Lawrence Livermore National Laboratory
7000 East Ave., L-627
Livermore, CA 94550
925-423-1062





On 4/26/13 12:53 PM, "Barry Rowlingson" <b.rowlingson at lancaster.ac.uk>
wrote:

>On Fri, Apr 26, 2013 at 8:25 PM, MacQueen, Don <macqueen1 at llnl.gov> wrote:
>> Here's a little example script using functions from the raster package,
>>
>> r1 <- r2 <- r3 <- raster(ncol=25,nrow=25,
>>      xmn=0, ymn=0, xmx=1, ymx=1)
>> r1[] <- round(runif(25^2,0,255))
>> r2[] <- round(runif(25^2,0,255))
>> r3[] <- round(runif(25^2,0,255))
>> s <- stack(r1,r2,r3)
>>
>> plotRGB(s)
>>
>> writeRaster(s,'s.tif', format='GTiff', overwrite=TRUE,
>>             bandorder='BSQ')
>>
>>
>> When I open the file s.tif in QGIS, it's fine; I see the same image as
>>in
>> R.
>>
>> But the Mac platform's default viewer, Preview.app, thinks the file's
>> color model is "Gray", rather than "RGB", and it does not render
>>properly.
>> Preview does recognize, for example, a jpeg photo as having an RGB color
>> model.
>> (Adobe Reader (for Mac) wouldn't open it at all.)
>>
>> Is there some better set of arguments to give writeRaster that will
>> somehow make the file more broadly recognizable as RGB?
>
> Hmmm. I think QGIS just makes a guess that any 3-band image is R,G
>and B. But there must be some tag in a tiff file that specifies this
>explicitly...
>
>  If I create a tif as above, and also create one with gimp, then I
>can run 'tiffinfo' on them:
>
> The R one has "Photometric Interpretation: min-is-black", whereas the
>Gimp one has "RGB Color". The problem is now how to change that tag in
>the R output tiff!
>
> This can be done on the command line:
>
>tiffset -s 262 2 s.tif
>
> where 262 is the id of the photometric interpretation tag and 2 means
>'rgb': 
>http://www.awaresystems.be/imaging/tiff/tifftags/photometricinterpretation
>.html
>
> but I can't see how to do this in writeRaster...
>
> ah ha.
>
>writeRaster([all that other stuff], options="PHOTOMETRIC=RGB")
>
>got from the list of gdal driver options:
>http://www.gdal.org/frmt_gtiff.html
>
>sorted.
>
>Barry


From pharriso at uwaterloo.ca  Fri Apr 26 22:27:35 2013
From: pharriso at uwaterloo.ca (Phil H)
Date: Fri, 26 Apr 2013 13:27:35 -0700 (PDT)
Subject: [R-sig-Geo] complex coastline and adehabitatHR: trouble with
 kerneloverlaphr function after coastline has been clipped out
In-Reply-To: <1366903920324-7583411.post@n2.nabble.com>
References: <1354642761294-7581851.post@n2.nabble.com>
	<1366903920324-7583411.post@n2.nabble.com>
Message-ID: <1367008055610-7583419.post@n2.nabble.com>

I notice that the kernal.area function does not seem to work with this
clipped UD.

I suspect that it could be related to the "fake" h values provided by the
code

fullgrid(udspdf) <- FALSE
re <- lapply(1:ncol(udspdf), function(i) {
so <- new("estUD", udspdf[,i])
so at h <- list(h=0, meth="specified") # fake value
so at vol <- FALSE
return(so)
})

as these seem to be the only differences I can find in the between the
clipped and non-clipped data str
see below for an example...........


str(re)
List of 4
 $ Brock:Formal class 'estUD' [package "adehabitatHR"] with 9 slots
  .. ..@ h          :List of 2
  .. .. ..$ h   : num 0
  .. .. ..$ meth: chr "specified"

str(ud)
List of 4
 $ Brock:Formal class 'estUD' [package "adehabitatHR"] with 9 slots
  .. ..@ h          :List of 2
  .. .. ..$ h   : num 212
  .. .. ..$ meth: chr "href"


I am attempting to use the BRB approach following the walrus thread script
http://grokbase.com/t/r/r-sig-geo/116mj7w0wx/walruses-and-adehabitathr-class-estudm-exclusion-of-non-habitat-pixels-and-summary-over-all-animals

however I get just the same issues. where BRBUDnotclipped<- is UD created in
the BRB above (not clipped)
str(BRBUDnotclipped)
$ Brock: :Formal class 'estUD' [package "adehabitatHR"] with 9 slots
  .. ..@ h          :List of 3
  .. .. ..$ values:List of 2
  .. .. .. ..$ hmin: num 100
  .. .. .. ..$ D   :List of 4
  .. .. .. .. ..$ Brock: num 4.26
  .. .. .. .. ..$ Calou: num 1
  .. .. .. .. ..$ Chou : num 1.86
  .. .. .. .. ..$ Jean : num 6.21
  .. .. ..$ interp:'data.frame':        62 obs. of  3 variables:
  .. .. .. ..$ x: num [1:62] 699889 699968 700046 699644 699242 ...
  .. .. .. ..$ y: num [1:62] 3161559 3161550 3161541 3161372 3161202 ...
  .. .. .. ..$ h: num [1:62] 100 612 100 704 704 ...

and where the BRB clipped UD structure again looks like this

str(UDclipped)
List of 4
 $ Brock:Formal class 'estUD' [package "adehabitatHR"] with 9 slots
  .. ..@ h          :List of 2
  .. .. ..$ h   : num 0
  .. .. ..$ meth: chr "specified"


My idea so far has been to try and re-populate the h slot with my BRB.lik
values ie vv2
so far I have tried  

fullgrid(udspdf) <- FALSE
re <- lapply(1:ncol(udspdf), function(i) {
so <- new("estUD", udspdf[,i])
so at h <- list(hmin=100,D=vv2, meth="BRB-specified")
so at vol <- FALSE
return(so)
})

however I dont know how to work with the $interp slot and I cannot seem to
extract the D value only from the vv2 of class "DBRB". And to be honest I am
not really sure I am correctly addressing the root of the problem? Does
anyone have any ideas why this approach doesnt work and why clipped UDs do
not work with kerneloverlap? Could it be related to the getvolumeUD function
which is used in both the kerneloverlaphr function and also in the
kernel.area function? 
sorry to repost on the same topic with no further enlightenment. I guess I
could try exporting the UD to GIS and clipping it and returning it to
adehabitatHR however I imagine this approach would also be tricky and I am
not a huge fan of arcGIS and would much prefer to crack this in R! 

Surely it is not impossible to generate overlap indexes with clipped
datasets? Perhaps I am making some very rookie mistake?

Thanks for your time

Phil H











--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/complex-coastline-and-adehabitatHR-trouble-with-kerneloverlaphr-function-after-coastline-has-been-clt-tp7581851p7583419.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From kirill.mueller at ivt.baug.ethz.ch  Fri Apr 26 22:53:16 2013
From: kirill.mueller at ivt.baug.ethz.ch (=?ISO-8859-1?Q?Kirill_M=FCller?=)
Date: Fri, 26 Apr 2013 22:53:16 +0200
Subject: [R-sig-Geo] rgdal: libgdal requirements too restrictive
In-Reply-To: <alpine.LRH.2.03.1304261137240.4635@reclus.nhh.no>
References: <516B07E3.30602@ivt.baug.ethz.ch>
	<alpine.LRH.2.03.1304151038320.8250@reclus.nhh.no>
	<5173E81C.6000906@ivt.baug.ethz.ch>
	<alpine.LRH.2.03.1304212006400.29054@reclus.nhh.no>
	<5174413E.8030408@ivt.baug.ethz.ch>
	<alpine.LRH.2.03.1304221003490.32520@reclus.nhh.no>
	<51790354.3030505@ivt.baug.ethz.ch>
	<alpine.LRH.2.03.1304261137240.4635@reclus.nhh.no>
Message-ID: <517AE93C.6010704@ivt.baug.ethz.ch>

Dear Roger

On 04/26/2013 11:38 AM, Roger Bivand wrote:
> Thanks, patches committed to R-forge for rgeos and rgdal. Please check 
> after updating from the repository, and report. If OK, the changes 
> will be in the next CRAN releases. 

Thank you. I have pulled the current state from Subversion (r466/r392). 
Both packages still pass R CMD check, only rgdal has an unrelated warning.


Cheers

Kirill


From endri81 at gmail.com  Sat Apr 27 01:57:28 2013
From: endri81 at gmail.com (Endri Raco)
Date: Sat, 27 Apr 2013 01:57:28 +0200
Subject: [R-sig-Geo] Help with ggmap
Message-ID: <CACje6_Zh_P2WDCpJ1mhSS+N+skmkVEY6nrihrY46UdZY_CVNoA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130427/6d5c8960/attachment.pl>

From u1mail2me at gmail.com  Sun Apr 28 13:31:14 2013
From: u1mail2me at gmail.com (=?UTF-8?B?5a2U5pmT5rOJ?=)
Date: Sun, 28 Apr 2013 19:31:14 +0800
Subject: [R-sig-Geo] how interpolate the map to bigger one use raster
Message-ID: <CAAAo1jeb3JEv=AXM-+_NBWL6w0W=ZU7SAqbuwRnh7YOU+WMx-g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130428/7ff80ce0/attachment.pl>

From s6lihert at uni-bonn.de  Sun Apr 28 14:12:25 2013
From: s6lihert at uni-bonn.de (Lionel)
Date: Sun, 28 Apr 2013 14:12:25 +0200
Subject: [R-sig-Geo] how interpolate the map to bigger one use raster
In-Reply-To: <CAAAo1jeb3JEv=AXM-+_NBWL6w0W=ZU7SAqbuwRnh7YOU+WMx-g@mail.gmail.com>
References: <CAAAo1jeb3JEv=AXM-+_NBWL6w0W=ZU7SAqbuwRnh7YOU+WMx-g@mail.gmail.com>
Message-ID: <517D1229.8060905@uni-bonn.de>

Hello,

See the disaggregate function from the package raster.
As for the method you have (to my knowledge) two choices: whether to 
have the smaller pixels take the same value as the bigger ones 
(method=''), or use a bilinear resampling (method='bilinear').

Happy mapping,

Lionel Hertzog

On 28/04/2013 13:31, ??? wrote:
> hi, everyone:
> i am a new guy to raster. i have read some documents for raster, but i
> still don't know how interpolate a map from resolution "0.5 degree" to "5
> minute", can some one tell how to do. if you know which is the best
> interpolate method for population density map, that's even more wonderful.
> thank you!
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From vitale232 at gmail.com  Mon Apr 29 06:23:03 2013
From: vitale232 at gmail.com (Andrew Vitale)
Date: Sun, 28 Apr 2013 21:23:03 -0700
Subject: [R-sig-Geo] Set single raster to NA where values of raster stack
	are NA
Message-ID: <CAFTcopfZjcdqL8hA=FRfDV+=bZOanV8m_YmZgTUC96mSFHovLw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130428/80b5076c/attachment.pl>

From r.hijmans at gmail.com  Mon Apr 29 06:47:13 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sun, 28 Apr 2013 21:47:13 -0700
Subject: [R-sig-Geo] Set single raster to NA where values of raster
 stack are NA
In-Reply-To: <CAFTcopfZjcdqL8hA=FRfDV+=bZOanV8m_YmZgTUC96mSFHovLw@mail.gmail.com>
References: <CAFTcopfZjcdqL8hA=FRfDV+=bZOanV8m_YmZgTUC96mSFHovLw@mail.gmail.com>
Message-ID: <CANtt_hx9g7mJwBzHO7fEg1-=VkbizEnzbyEMgWnumHeP1DRd6Q@mail.gmail.com>

Andrew,

I think that a good approach might be, for your polygons:
p <- rbind(p1, p2, p3, etc, makeUniqueIDs=TRUE)
test <- mask(r4, p, inverse=TRUE)

# but to follow your example:
# solution 1
s2 <- stack(r1, r2, r3, r4)
test.a.cool <- calc(s2, function(x){ m <- apply(x, 1, function(z)
any(is.na(z))); m[m] <- NA; m})

# solution 2
test <- overlay(r4, s, fun=function(x, y){x[apply(y, 1,
function(z)any(is.na(z)))] <- NA; x})

# much simpler, solution 3
ss <- sum(s)
test <- mask(r4, ss)


Best, Robert

On Sun, Apr 28, 2013 at 9:23 PM, Andrew Vitale <vitale232 at gmail.com> wrote:
> I have two 30m x 30m raster files from which I would like to sample random
> points.  Prior to sampling, I would like to remove the clouded areas from
> the images.  I turned to R and Hijman and van Etten's Raster package for
> the task.
>
> Using the drawPoly(sp=TRUE) command, I drew in 18 different polygons.  The
> function did not seem to allow 18 polygons as one sp object, so I drew them
> all separately.  I then gave the polygons a proj4string matching the
> rasters', and set them into a list.  I ran the list through a lapply
> function to convert them to rasters (using rasterize()) with the polygon
> areas set to NA, and the rest of the image set to 1.
>
> My end goal is one raster layer with the 18 areas set to NA, and the rest
> of the extent set to 1.  I have tried stacking the list of rasterized
> polygons, and subsetting it to set a new raster to NA in the same areas.
>  My reproducible code is below.
>
>
>     r1 <- raster(nrow=50, ncol = 50)
>     r1[] <- 1
>     r1[4:10,] <- NA
>     r2 <- raster(nrow=50, ncol = 50)
>     r2[] <- 1
>     r2[9:15,] <- NA
>     r3 <- raster(nrow=50, ncol = 50)
>     r3[] <- 1
>     r3[24:39,] <- NA
>
>     r4 <- raster(nrow=50, ncol = 50)
>     r4[] <- 1
>
>     s <- stack(r1, r2, r3)
>
>     test.a.cool <- calc(s, function(x){r4[is.na(x)==1] <- NA})
>
> For whatever reason, the darn testacool is a blank plot, where I'm aiming
> to have it as a raster with all values except for the NAs in the stack, s,
> equal to 1.  In simple terms, a cloud mask.
>
> Any tips?
>
> Thanks.
>
>
> --
> *Andrew P. Vitale*
> Masters Student
> Department of Geography
> University of Nevada, Reno
>
> vitale232 at gmail.com
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From vitale232 at gmail.com  Mon Apr 29 07:07:50 2013
From: vitale232 at gmail.com (Andrew Vitale)
Date: Sun, 28 Apr 2013 22:07:50 -0700
Subject: [R-sig-Geo] Set single raster to NA where values of raster
 stack are NA
In-Reply-To: <CANtt_hx9g7mJwBzHO7fEg1-=VkbizEnzbyEMgWnumHeP1DRd6Q@mail.gmail.com>
References: <CAFTcopfZjcdqL8hA=FRfDV+=bZOanV8m_YmZgTUC96mSFHovLw@mail.gmail.com>
	<CANtt_hx9g7mJwBzHO7fEg1-=VkbizEnzbyEMgWnumHeP1DRd6Q@mail.gmail.com>
Message-ID: <CAFTcopdqfCk9pqSUWRcbp4PObHcXzpBdJnD_XZB5+g-WTH7VOw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130428/3ff347f1/attachment.pl>

From swagathnavin82 at gmail.com  Mon Apr 29 09:46:10 2013
From: swagathnavin82 at gmail.com (Swagath)
Date: Mon, 29 Apr 2013 09:46:10 +0200
Subject: [R-sig-Geo] reading .grd files
Message-ID: <517E2542.4080902@gmail.com>

Hello all,

I  downloaded a .grd file from 
http://pubs.usgs.gov/of/2005/1413/gisdata/data/NAMrad_U.grd and would 
like to open it in R. Can anyone please tell me how to open .grd type 
files in R. I tried to read with raster, ncdf and also rgdal, but couldnt.

Thanks a lot for your time.

Swagath


From roman.lustrik at gmail.com  Mon Apr 29 09:55:45 2013
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Mon, 29 Apr 2013 09:55:45 +0200
Subject: [R-sig-Geo] reading .grd files
In-Reply-To: <517E2542.4080902@gmail.com>
References: <517E2542.4080902@gmail.com>
Message-ID: <CAHT1vpjx3AyZp1cCx6+Co8Zh3KLbH1xwO95PucuY6OvPCw2GTg@mail.gmail.com>

Have you tried something like this?

Loading required package: sp
> x <- raster()
> x
class       : RasterLayer
dimensions  : 180, 360, 64800  (nrow, ncol, ncell)
resolution  : 1, 1  (x, y)
extent      : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=longlat +datum=WGS84

> x[] <- runif(ncell(x))
> plot(x)
> writeRaster(x, "myfile.grd")
class       : RasterLayer
dimensions  : 180, 360, 64800  (nrow, ncol, ncell)
resolution  : 1, 1  (x, y)
extent      : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=longlat +datum=WGS84
data source : C:\Users\romunov\myfile.grd
names       : layer
values      : 3.938144e-05, 0.9999952  (min, max)

> y <- raster("myfile.grd")
> y
class       : RasterLayer
dimensions  : 180, 360, 64800  (nrow, ncol, ncell)
resolution  : 1, 1  (x, y)
extent      : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=longlat +datum=WGS84
data source : C:\Users\romunov\myfile.grd
names       : layer
values      : 3.938144e-05, 0.9999952  (min, max)


Cheers,
Roman




On Mon, Apr 29, 2013 at 9:46 AM, Swagath <swagathnavin82 at gmail.com> wrote:
>
> Hello all,
>
> I  downloaded a .grd file from http://pubs.usgs.gov/of/2005/1413/gisdata/data/NAMrad_U.grd and would like to open it in R. Can anyone please tell me how to open .grd type files in R. I tried to read with raster, ncdf and also rgdal, but couldnt.
>
> Thanks a lot for your time.
>
> Swagath
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo




--
In God we trust, all others bring data.


From b.rowlingson at lancaster.ac.uk  Mon Apr 29 10:21:06 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Mon, 29 Apr 2013 09:21:06 +0100
Subject: [R-sig-Geo] reading .grd files
In-Reply-To: <3328df310b994c3a8a200a19e0adca26@EX-0-HT0.lancs.local>
References: <3328df310b994c3a8a200a19e0adca26@EX-0-HT0.lancs.local>
Message-ID: <CANVKczPyph2pq6Jig8DHSSWBa-iOsa86kNr0gDAmo1tzGMpRQA@mail.gmail.com>

On Mon, Apr 29, 2013 at 8:46 AM, Swagath <swagathnavin82 at gmail.com> wrote:
> Hello all,
>
> I  downloaded a .grd file from
> http://pubs.usgs.gov/of/2005/1413/gisdata/data/NAMrad_U.grd and would
> like to open it in R. Can anyone please tell me how to open .grd type
> files in R. I tried to read with raster, ncdf and also rgdal, but couldnt.
>
> Thanks a lot for your time.
>

 "I tried ... but couldn't" is not very helpful. What functions did
you try? Did you get an error message? Or the wrong data? Show us!

 I'd try now, but I can't. (Mostly because I should get off to work
and a 9Mb download will make me late).

Barry


From b.rowlingson at lancaster.ac.uk  Mon Apr 29 11:41:27 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Mon, 29 Apr 2013 10:41:27 +0100
Subject: [R-sig-Geo] reading .grd files
In-Reply-To: <3328df310b994c3a8a200a19e0adca26@EX-0-HT0.lancs.local>
References: <3328df310b994c3a8a200a19e0adca26@EX-0-HT0.lancs.local>
Message-ID: <CANVKczN5724NeGCt6utigNO_5pRpdoYfyZyc=RFLcs21fWBJbg@mail.gmail.com>

On Mon, Apr 29, 2013 at 8:46 AM, Swagath <swagathnavin82 at gmail.com> wrote:
> Hello all,
>
> I  downloaded a .grd file from
> http://pubs.usgs.gov/of/2005/1413/gisdata/data/NAMrad_U.grd and would
> like to open it in R. Can anyone please tell me how to open .grd type
> files in R. I tried to read with raster, ncdf and also rgdal, but couldnt.

 A little exploration leads me here:

http://pubs.usgs.gov/of/2005/1413/gisdata/data/readme.txt

which tells me that file is a 'GeoSoft Grid' format file (note - the
.XXX part of a file is no guide of its true content).

And sadly that seems to be a proprietary format that only GeoSoft can
read. There are GDAL drivers for GeoSoft's exchange format (GXF files)
but not these grid files.

You could try GeoSoft's Oasis Montaj Viewer (free download) which
might be able to export them to something else:

http://www.geosoft.com/support/downloads/viewers/oasis-montaj-viewer?dnld=333

Or you could contact the authors and ask them to make their data
available in an open format...

Barry


From tghoward at gw.dec.state.ny.us  Mon Apr 29 13:26:31 2013
From: tghoward at gw.dec.state.ny.us (Tim Howard)
Date: Mon, 29 Apr 2013 07:26:31 -0400
Subject: [R-sig-Geo] remove points less than certain distance
In-Reply-To: <mailman.13.1367056803.31481.r-sig-geo@r-project.org>
References: <mailman.13.1367056803.31481.r-sig-geo@r-project.org>
Message-ID: <517E20A7020000D50006953F@gwsmtp.dec.state.ny.us>

Try the function zerodist or remove.duplicates in sp, with zero set to 0.2
 
Cheers, 
Tim
 

>>>>>>>>>>>
Date: Fri, 26 Apr 2013 15:10:57 +0100
From: Ross Ahmed <rossahmed at googlemail.com>
To: <r-sig-geo at r-project.org>
Subject: [R-sig-Geo] remove points less than certain distance
Message-ID: <CDA04981.4A46%rossahmed at gmail.com>
Content-Type: text/plain

# I have a SpatialPointsDataFrame that contains points, some of which are
<=200m from each other, some of which points are >200m from each other.
x <- c(-1.344, -1.345, -1.346, -1.346,-1.347, -1.328, -1.329, -1.33)
y <- c(rep(54.76558, 3), 54.7610, 54.7611, rep(54.75167, 3))
xy <- data.frame(x,y, values=rnorm(8))
xy <- xy[sample(1:8, 8),]
coordinates(xy) <- c("x", "y")
proj4string(xy) <- CRS("+proj=longlat +ellps=WGS84 +datum=WGS84")
plot(xy)

# find which points are <= 200m
spDists(xy) <= 0.2

# of the points that are <=200m from each other, I need all but one of those
points removed from xy. I should be left with 3 rows in xy. How do I do
this?

Thanks
Ross


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130429/c94ebccc/attachment.html>

From Bastien.Ferland-Raymond at mrn.gouv.qc.ca  Mon Apr 29 13:40:27 2013
From: Bastien.Ferland-Raymond at mrn.gouv.qc.ca (Bastien.Ferland-Raymond at mrn.gouv.qc.ca)
Date: Mon, 29 Apr 2013 07:40:27 -0400
Subject: [R-sig-Geo] remove points less than certain distance
Message-ID: <161DC602615F6943A19BAEA3DBF2E4B901AE76B75D02@HARFANG.intranet.mrn.gouv>

Hello,

I looked at your problem and I can't understand it.  What are your trying to do?  It's not clear.  Are you trying to find the points that are at less than 200m from ALL other points?  Or at 200m of AT LEAST one other point?  You have a distance matrix here, which is n*n, you can difficultly transpose that to your coordinates data frame which is n*2.

Have you thought of using the combination of rgeos::gBuffer() and over()?  Maybe there's something there.

Bastien Ferland-Raymond, M.Sc. Stat., M.Sc. Biol.
Division des orientations et projets sp?ciaux
Direction des inventaires forestiers
Minist?re des Ressources naturelles

# I have a SpatialPointsDataFrame that contains points, some of which are <=200m from each other, some of which points are >200m from each other. x <- c(-1.344, -1.345, -1.346, -1.346,-1.347, -1.328, -1.329, -1.33) y <- c(rep(54.76558, 3), 54.7610, 54.7611, rep(54.75167, 3)) xy <- data.frame(x,y, values=rnorm(8)) xy <- xy[sample(1:8, 8),]
coordinates(xy) <- c("x", "y")
proj4string(xy) <- CRS("+proj=longlat +ellps=WGS84 +datum=WGS84")
plot(xy)

# find which points are <= 200m
spDists(xy) <= 0.2

# of the points that are <=200m from each other, I need all but one of those points removed from xy. I should be left with 3 rows in xy. How do I do this?

Thanks
Ross


From a.mosnier at gmail.com  Mon Apr 29 14:02:06 2013
From: a.mosnier at gmail.com (Arnaud Mosnier)
Date: Mon, 29 Apr 2013 08:02:06 -0400
Subject: [R-sig-Geo] remove points less than certain distance
Message-ID: <CANkFkEfXf-xtoRp0=nLeG1C0yKhe=TG2pXHVJNK+-Dwn1FPCDA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130429/a7341b41/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Mon Apr 29 15:08:07 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Mon, 29 Apr 2013 14:08:07 +0100
Subject: [R-sig-Geo] reading .grd files
In-Reply-To: <678fc8a4e6874958b0828ec3e0b12413@EX-1-HT0.lancs.local>
References: <3328df310b994c3a8a200a19e0adca26@EX-0-HT0.lancs.local>
	<678fc8a4e6874958b0828ec3e0b12413@EX-1-HT0.lancs.local>
Message-ID: <CANVKczNV5OYg-XaFVtn4rt9YLGnSRO0-u5i35bx2-RnJ0vyKVQ@mail.gmail.com>

On Mon, Apr 29, 2013 at 10:41 AM, Rowlingson, Barry
<b.rowlingson at lancaster.ac.uk> wrote:

> You could try GeoSoft's Oasis Montaj Viewer (free download) which
> might be able to export them to something else:
>
> http://www.geosoft.com/support/downloads/viewers/oasis-montaj-viewer?dnld=333

 Just to confirm that I've just downloaded that and converted a grid
and read it into R.

 The download is 100Mb, and it only runs on Windows.

 After some menu hunting I loaded the grid file into Montaj viewer and
converted it to a .flt file, which read into R as a single layer
raster with decimal values the same as the original raster. The option
to save as a TIFF out of Montaj Viewer resulted in an integer raster.

Barry


From viton.1 at osu.edu  Mon Apr 29 14:55:45 2013
From: viton.1 at osu.edu (Philip A. Viton)
Date: Mon, 29 Apr 2013 09:55:45 -0300
Subject: [R-sig-Geo] zero out the dataframe?
Message-ID: <201304291355.r3TDtlAO011584@defang6.it.ohio-state.edu>


Given a Spatial*DataFrame, is there some easy way to delete the
dataframe objects, leaving only the Spatial* part? (I have a
very large spatial dataframe, and I want to do come calculations that
don't involve the data part; and I hope that this could
speed things up). I tried setting the data slot to NULL, but
apparently this isn't allowed.

Thanks!


------------------------
Philip A. Viton
City Planning, Ohio State University
275 West Woodruff Avenue, Columbus OH 43210
viton.1 at osu.edu


From mdsumner at gmail.com  Mon Apr 29 15:57:19 2013
From: mdsumner at gmail.com (Michael Sumner)
Date: Mon, 29 Apr 2013 23:57:19 +1000
Subject: [R-sig-Geo] zero out the dataframe?
In-Reply-To: <201304291355.r3TDtlAO011584@defang6.it.ohio-state.edu>
References: <201304291355.r3TDtlAO011584@defang6.it.ohio-state.edu>
Message-ID: <CAAcGz9_bn0FjOfg2jLj13bfPMh6V-WuSdXEaZ49+5aLGRMeBMg@mail.gmail.com>

as(x, "Spatial*") will do it

On Mon, Apr 29, 2013 at 10:55 PM, Philip A. Viton <viton.1 at osu.edu> wrote:
>
> Given a Spatial*DataFrame, is there some easy way to delete the
> dataframe objects, leaving only the Spatial* part? (I have a
> very large spatial dataframe, and I want to do come calculations that
> don't involve the data part; and I hope that this could
> speed things up). I tried setting the data slot to NULL, but
> apparently this isn't allowed.
>
> Thanks!
>
>
> ------------------------
> Philip A. Viton
> City Planning, Ohio State University
> 275 West Woodruff Avenue, Columbus OH 43210
> viton.1 at osu.edu
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Michael Sumner
Hobart, Australia
e-mail: mdsumner at gmail.com


From edzer.pebesma at uni-muenster.de  Mon Apr 29 16:21:29 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 29 Apr 2013 16:21:29 +0200
Subject: [R-sig-Geo] zero out the dataframe?
In-Reply-To: <CAAcGz9_bn0FjOfg2jLj13bfPMh6V-WuSdXEaZ49+5aLGRMeBMg@mail.gmail.com>
References: <201304291355.r3TDtlAO011584@defang6.it.ohio-state.edu>
	<CAAcGz9_bn0FjOfg2jLj13bfPMh6V-WuSdXEaZ49+5aLGRMeBMg@mail.gmail.com>
Message-ID: <517E81E9.1010903@uni-muenster.de>

You still need to fill out the *. The method

  geometry(object)

does it too, indifferent to what your * is. The generic

  addAttrToGeom(object, dataFrame)

does the reverse, for every *.

On 04/29/2013 03:57 PM, Michael Sumner wrote:
> as(x, "Spatial*") will do it
> 
> On Mon, Apr 29, 2013 at 10:55 PM, Philip A. Viton <viton.1 at osu.edu> wrote:
>>
>> Given a Spatial*DataFrame, is there some easy way to delete the
>> dataframe objects, leaving only the Spatial* part? (I have a
>> very large spatial dataframe, and I want to do come calculations that
>> don't involve the data part; and I hope that this could
>> speed things up). I tried setting the data slot to NULL, but
>> apparently this isn't allowed.
>>
>> Thanks!
>>
>>
>> ------------------------
>> Philip A. Viton
>> City Planning, Ohio State University
>> 275 West Woodruff Avenue, Columbus OH 43210
>> viton.1 at osu.edu
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From ted.rosenbaum at yale.edu  Mon Apr 29 23:26:03 2013
From: ted.rosenbaum at yale.edu (Ted Rosenbaum)
Date: Mon, 29 Apr 2013 17:26:03 -0400
Subject: [R-sig-Geo] Writing to Large Raster File
Message-ID: <CAJgfpijY4hEYCAEuZDvFSKp2XAnCuqCoX9sDZXDZKDxzPrqBtQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130429/27f6d320/attachment.pl>

From matteo.mattiuzzi at boku.ac.at  Tue Apr 30 09:24:56 2013
From: matteo.mattiuzzi at boku.ac.at (Matteo Mattiuzzi)
Date: Tue, 30 Apr 2013 09:24:56 +0200
Subject: [R-sig-Geo] Writing to Large Raster File
Message-ID: <517F8DE80200002700019AC5@gwia2.boku.ac.at>

Dear Ted,


Isn't it simply that?
out <- raster(nrow=20000,ncol=1900)#modisRasterAll
out[] <- 1:ncell(out)


tail(out)




>>> Ted Rosenbaum  04/29/13 11:28 PM >>>
Hi,

I am trying to assign a unique ID number to each tile in a large raster
file.

My code is below:

##Write tile indexed MODIS file
#Prelims
nColVal<-190
outFileName <- 'tmp.grd'

#Set up raster
out <- raster(nrow=20000,ncol=nColVal)#modisRasterAll

##Get number of colums and blocksize
outCol <- ncol(out)
bs <- blockSize(out)

##Write to file
out <- writeStart(out,outFileName,overwrite=TRUE)
for(i in 1:bs$n){
  print(i)
  out <-
writeValues(out,((outCol*(bs$row[i]-1))+1):((bs$row[i]+bs$nrows[i]-1)*outCol),bs$row[i])
}
out <- writeStop(out)

tail(out)

When I run this code with nColVal=190, I get the expected result from
tail(out): a sequence of numbers.  However, when I run this code with
nColVal=1900, I do not and instead get
"37999996 38000000 38000000 38000000" for out[20000,1897:1900].

I would like to get instead "37999997 37999998 37999999 38000000".

Thanks for any assistance,

Ted Rosenbaum
Department of Economics
Yale University

    [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From swagathnavin82 at gmail.com  Tue Apr 30 11:23:00 2013
From: swagathnavin82 at gmail.com (Swagath Navin)
Date: Tue, 30 Apr 2013 11:23:00 +0200
Subject: [R-sig-Geo] reading .grd files
In-Reply-To: <CANVKczNV5OYg-XaFVtn4rt9YLGnSRO0-u5i35bx2-RnJ0vyKVQ@mail.gmail.com>
References: <3328df310b994c3a8a200a19e0adca26@EX-0-HT0.lancs.local>
	<678fc8a4e6874958b0828ec3e0b12413@EX-1-HT0.lancs.local>
	<CANVKczNV5OYg-XaFVtn4rt9YLGnSRO0-u5i35bx2-RnJ0vyKVQ@mail.gmail.com>
Message-ID: <CAK=UC1DC+Nf8zn2HZXYRhbva6msEr9Aker2T+_QCmUsYt=gySw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130430/fa567f25/attachment.pl>

From ted.rosenbaum at yale.edu  Tue Apr 30 15:17:59 2013
From: ted.rosenbaum at yale.edu (Ted Rosenbaum)
Date: Tue, 30 Apr 2013 09:17:59 -0400
Subject: [R-sig-Geo] Writing to Large Raster File
In-Reply-To: <517F8DE80200002700019AC5@gwia2.boku.ac.at>
References: <517F8DE80200002700019AC5@gwia2.boku.ac.at>
Message-ID: <CAJgfpiiO-TL4kzMkzuy-PyBoHfCQ3RYtZ6WZhig2iMWx18EK8w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130430/ad3725c6/attachment.pl>

From matteo.mattiuzzi at boku.ac.at  Tue Apr 30 16:22:25 2013
From: matteo.mattiuzzi at boku.ac.at (Matteo Mattiuzzi)
Date: Tue, 30 Apr 2013 16:22:25 +0200
Subject: [R-sig-Geo] Writing to Large Raster File
Message-ID: <517FEFC10200002700019AF7@gwia2.boku.ac.at>

Ted you are right!


I have tried a few things and I can not explain the behaviour.
@Robert may the example below helps a little further.
I have also tried to write into a tif and an img file but it doesn't change. Also after reloading the file out <- raster("tmp.grd") the problem persists. Starting at row 8831 the values are strange...
[I have also changed the value generation part, as it is little bit clearer to me for reading: cellFromRowCol(out,bs$row[i],1) : cellFromRowCol(out,bs$row[i] + bs$nrow[i] -1 , ncol(out)) ]


R version 2.15.3 (2013-03-01) -- "Security Blanket"
Copyright (C) 2013 The R Foundation for Statistical Computing
ISBN 3-900051-07-0
Platform: x86_64-pc-linux-gnu (64-bit)


R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.


  Natural language support but running in an English locale


R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.


Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.


> library(raster)
Loading required package: sp
> sessionInfo()
R version 2.15.3 (2013-03-01)
Platform: x86_64-pc-linux-gnu (64-bit)


locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=C                 LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       


attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     


other attached packages:
[1] raster_2.1-25 sp_1.0-9     


loaded via a namespace (and not attached):
[1] grid_2.15.3     lattice_0.20-15
> 
> ##Write tile indexed MODIS file
> #Prelims
> nColVal<-1900
> outFileName <- 'tmp.grd'
> 
> #Set up raster
> out <- raster(nrow=20000,ncol=nColVal)#modisRasterAll
> 
> ##Get number of colums and blocksize
> outCol <- ncol(out)
> bs <- blockSize(out)
> 
> ##Write to file
> out <- writeStart(out,outFileName,overwrite=TRUE)
> for(i in 1:bs$n){
+ out <-
+ writeValues(out,cellFromRowCol(out,bs$row[i],1) : cellFromRowCol(out,bs$row[i] + bs$nrow[i] -1 , ncol(out)) ,bs$row[i])
+ }
> out <- writeStop(out)
> 
> out2 <- raster(out)
> out2[]<- 1:ncell(out2)
> 
> res <- out-out2
rgdal: version: 0.8-8, (SVN revision 463)
Geospatial Data Abstraction Library extensions to R successfully loaded
Loaded GDAL runtime: GDAL 1.9.2, released 2012/10/08
Path to GDAL shared files: /usr/share/gdal/1.9
Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
Path to PROJ.4 shared files: (autodetected)
> 
> sum(res[])
[1] 0
> 
> tail(out)
          1881     1882     1883     1884     1885     1886     1887     1888
19991 37982880 37982880 37982884 37982884 37982884 37982888 37982888 37982888
19992 37984780 37984784 37984784 37984784 37984784 37984784 37984788 37984788
19993 37986680 37986680 37986684 37986684 37986684 37986688 37986688 37986688
19994 37988580 37988584 37988584 37988584 37988584 37988584 37988588 37988588
19995 37990480 37990480 37990484 37990484 37990484 37990488 37990488 37990488
19996 37992380 37992384 37992384 37992384 37992384 37992384 37992388 37992388
19997 37994280 37994280 37994284 37994284 37994284 37994288 37994288 37994288
19998 37996180 37996184 37996184 37996184 37996184 37996184 37996188 37996188
19999 37998080 37998080 37998084 37998084 37998084 37998088 37998088 37998088
20000 37999980 37999984 37999984 37999984 37999984 37999984 37999988 37999988
          1889     1890     1891     1892     1893     1894     1895     1896
19991 37982888 37982888 37982892 37982892 37982892 37982896 37982896 37982896
19992 37984788 37984792 37984792 37984792 37984792 37984792 37984796 37984796
19993 37986688 37986688 37986692 37986692 37986692 37986696 37986696 37986696
19994 37988588 37988592 37988592 37988592 37988592 37988592 37988596 37988596
19995 37990488 37990488 37990492 37990492 37990492 37990496 37990496 37990496
19996 37992388 37992392 37992392 37992392 37992392 37992392 37992396 37992396
19997 37994288 37994288 37994292 37994292 37994292 37994296 37994296 37994296
19998 37996188 37996192 37996192 37996192 37996192 37996192 37996196 37996196
19999 37998088 37998088 37998092 37998092 37998092 37998096 37998096 37998096
20000 37999988 37999992 37999992 37999992 37999992 37999992 37999996 37999996
          1897     1898     1899     1900
19991 37982896 37982896 37982900 37982900
19992 37984796 37984800 37984800 37984800
19993 37986696 37986696 37986700 37986700
19994 37988596 37988600 37988600 37988600
19995 37990496 37990496 37990500 37990500
19996 37992396 37992400 37992400 37992400
19997 37994296 37994296 37994300 37994300
19998 37996196 37996200 37996200 37996200
19999 37998096 37998096 37998100 37998100
20000 37999996 38000000 38000000 38000000
> tail(out2)
          1881     1882     1883     1884     1885     1886     1887     1888
19991 37982881 37982882 37982883 37982884 37982885 37982886 37982887 37982888
19992 37984781 37984782 37984783 37984784 37984785 37984786 37984787 37984788
19993 37986681 37986682 37986683 37986684 37986685 37986686 37986687 37986688
19994 37988581 37988582 37988583 37988584 37988585 37988586 37988587 37988588
19995 37990481 37990482 37990483 37990484 37990485 37990486 37990487 37990488
19996 37992381 37992382 37992383 37992384 37992385 37992386 37992387 37992388
19997 37994281 37994282 37994283 37994284 37994285 37994286 37994287 37994288
19998 37996181 37996182 37996183 37996184 37996185 37996186 37996187 37996188
19999 37998081 37998082 37998083 37998084 37998085 37998086 37998087 37998088
20000 37999981 37999982 37999983 37999984 37999985 37999986 37999987 37999988
          1889     1890     1891     1892     1893     1894     1895     1896
19991 37982889 37982890 37982891 37982892 37982893 37982894 37982895 37982896
19992 37984789 37984790 37984791 37984792 37984793 37984794 37984795 37984796
19993 37986689 37986690 37986691 37986692 37986693 37986694 37986695 37986696
19994 37988589 37988590 37988591 37988592 37988593 37988594 37988595 37988596
19995 37990489 37990490 37990491 37990492 37990493 37990494 37990495 37990496
19996 37992389 37992390 37992391 37992392 37992393 37992394 37992395 37992396
19997 37994289 37994290 37994291 37994292 37994293 37994294 37994295 37994296
19998 37996189 37996190 37996191 37996192 37996193 37996194 37996195 37996196
19999 37998089 37998090 37998091 37998092 37998093 37998094 37998095 37998096
20000 37999989 37999990 37999991 37999992 37999993 37999994 37999995 37999996
          1897     1898     1899     1900
19991 37982897 37982898 37982899 37982900
19992 37984797 37984798 37984799 37984800
19993 37986697 37986698 37986699 37986700
19994 37988597 37988598 37988599 37988600
19995 37990497 37990498 37990499 37990500
19996 37992397 37992398 37992399 37992400
19997 37994297 37994298 37994299 37994300
19998 37996197 37996198 37996199 37996200
19999 37998097 37998098 37998099 37998100
20000 37999997 37999998 37999999 38000000
> tail(res)
      1881 1882 1883 1884 1885 1886 1887 1888 1889 1890 1891 1892 1893 1894
19991   -1   -2    1    0   -1    2    1    0   -1   -2    1    0   -1    2
19992   -1    2    1    0   -1   -2    1    0   -1    2    1    0   -1   -2
19993   -1   -2    1    0   -1    2    1    0   -1   -2    1    0   -1    2
19994   -1    2    1    0   -1   -2    1    0   -1    2    1    0   -1   -2
19995   -1   -2    1    0   -1    2    1    0   -1   -2    1    0   -1    2
19996   -1    2    1    0   -1   -2    1    0   -1    2    1    0   -1   -2
19997   -1   -2    1    0   -1    2    1    0   -1   -2    1    0   -1    2
19998   -1    2    1    0   -1   -2    1    0   -1    2    1    0   -1   -2
19999   -1   -2    1    0   -1    2    1    0   -1   -2    1    0   -1    2
20000   -1    2    1    0   -1   -2    1    0   -1    2    1    0   -1   -2
      1895 1896 1897 1898 1899 1900
19991    1    0   -1   -2    1    0
19992    1    0   -1    2    1    0
19993    1    0   -1   -2    1    0
19994    1    0   -1    2    1    0
19995    1    0   -1   -2    1    0
19996    1    0   -1    2    1    0
19997    1    0   -1   -2    1    0
19998    1    0   -1    2    1    0
19999    1    0   -1   -2    1    0
20000    1    0   -1    2    1    0
> 
> res[8831,]
   [1]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  [25]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  [49]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  [73]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
  [97]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
 [121]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
 [145]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
 [169]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
 [193]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
 [217] -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0
 [241] -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0
 [265] -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0
 [289] -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0
 [313] -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0
 [337] -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0
 [361] -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0
 [385] -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0
 [409] -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0
 [433] -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0
 

>>> Ted Rosenbaum  04/30/13 3:18 PM >>>
Dear Matteo,

Thanks for your response.

You approach would work except that my computer can't handle it well since
it loads everything into memory.  That is why I used the more complicated
approach outlined here (
http://cran.r-project.org/web/packages/raster/vignettes/functions.pdf).






On Tue, Apr 30, 2013 at 3:24 AM, Matteo Mattiuzzi <
matteo.mattiuzzi at boku.ac.at> wrote:

> Dear Ted,
>
>
> Isn't it simply that?
> out <- raster(nrow=20000,ncol=1900)#modisRasterAll
> out[] <- 1:ncell(out)
>
>
> tail(out)
>
>
>
>
> >>> Ted Rosenbaum  04/29/13 11:28 PM >>>
> Hi,
>
> I am trying to assign a unique ID number to each tile in a large raster
> file.
>
> My code is below:
>
> ##Write tile indexed MODIS file
> #Prelims
> nColVal<-190
> outFileName <- 'tmp.grd'
>
> #Set up raster
> out <- raster(nrow=20000,ncol=nColVal)#modisRasterAll
>
> ##Get number of colums and blocksize
> outCol <- ncol(out)
> bs <- blockSize(out)
>
> ##Write to file
> out <- writeStart(out,outFileName,overwrite=TRUE)
> for(i in 1:bs$n){
>   print(i)
>   out <-
>
> writeValues(out,((outCol*(bs$row[i]-1))+1):((bs$row[i]+bs$nrows[i]-1)*outCol),bs$row[i])
> }
> out <- writeStop(out)
>
> tail(out)
>
> When I run this code with nColVal=190, I get the expected result from
> tail(out): a sequence of numbers.  However, when I run this code with
> nColVal=1900, I do not and instead get
> "37999996 38000000 38000000 38000000" for out[20000,1897:1900].
>
> I would like to get instead "37999997 37999998 37999999 38000000".
>
> Thanks for any assistance,
>
> Ted Rosenbaum
> Department of Economics
> Yale University
>
>     [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>


From tephilippi at gmail.com  Tue Apr 30 18:26:46 2013
From: tephilippi at gmail.com (Tom Philippi)
Date: Tue, 30 Apr 2013 09:26:46 -0700
Subject: [R-sig-Geo] Writing to Large Raster File
In-Reply-To: <517FEFC10200002700019AF7@gwia2.boku.ac.at>
References: <517FEFC10200002700019AF7@gwia2.boku.ac.at>
Message-ID: <CALyPt8yAogbDcjHqvMjTj4+aGG+Rnwt3dEiS4pCUHWYfxsh_AQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130430/8d1526f6/attachment.pl>

From mlt at gmx.us  Tue Apr 30 18:30:18 2013
From: mlt at gmx.us (Mikhail Titov)
Date: Tue, 30 Apr 2013 11:30:18 -0500
Subject: [R-sig-Geo] How can I plot categorical raster (using levelplot?)
	with a proper legend?
Message-ID: <9q0vc74gew5.fsf@gmx.us>

Hi, all!

I have a raster exported from ArcMap that I'm trying to plot (for now)
with raster/rasterVis. But the problem is that levelplot fails to plot
raster as is. When I deratify it first, it plots, but the legend is
incorrect :( The manual for rasterVis says to use ratify for categorical
data, but calling ratify makes no difference for me.

I feel like I'm missing something... Here is the code I was using.

,----[ loading data ]
| library(raster)
| library(rasterVis)
| library(foreign)
| fname <- "too-big-to-attach.img"
| benefits.rast <- raster(fname)
| rat <- read.dbf(paste(fname, ".vat.dbf", sep=""))
| names(rat)[1] <- "ID"                   # rename Value to ID
| levels(benefits.rast) <- rat
| levels(benefits.rast)
`----

This yields in my case

,----[ levels(benefits.rast) ]
| [[1]]
|   ID Count class
| 1  0  3616     D
| 2  1  2476     R
| 3  2 11584     C
| 4  3   305    NB
| 5  4    60    D-
| 6  5  1912     B
| 7  6    57    SA
| 8  7   151     A
`----

At this point if I call levelplot(benefits.rast), nothing is being
plotted and I get the following error.

,----[ Error from levelplot(benefits.rast) ]
| Error in from:to : result would be too long a vector
| In addition: Warning messages:
| 1: In min(x) : no non-missing arguments to min; returning Inf
| 2: In max(x) : no non-missing arguments to max; returning -Inf
| 3: In min(x) : no non-missing arguments to min; returning Inf
| 4: In max(x) : no non-missing arguments to max; returning -Inf
`----

However the following code does produce a plot but with messed up legend
items. Here is how it looks http://i.troll.ws/55d45652.png . Something
yellowish that looks like a road should be 'R'.

,----[ The following results in a messed up legend ]
| benefits.cat <- deratify(benefits.rast, "class")
| levelplot(benefits.cat)                 # from rasterVis
`----

,----[ The following results in a proper plot but with IDs ]
| benefits.cat <- deratify(benefits.rast, "ID")
| levelplot(benefits.cat)                 # from rasterVis
`----

An here is an experiment with ratify

,----[ try ratify ]
| benefits.cat <- ratify(benefits.rast)
| levelplot(benefits.cat)                 # from rasterVis
`----

That gives me

,----
| Error in .checkLevels(levels(x)[[1]], value) : 
|   the number of columns in the raster attributes (factors) data.frame should be > 1
`----

-- 
Mikhail


From matteo.mattiuzzi at boku.ac.at  Tue Apr 30 18:55:11 2013
From: matteo.mattiuzzi at boku.ac.at (Matteo Mattiuzzi)
Date: Tue, 30 Apr 2013 18:55:11 +0200
Subject: [R-sig-Geo] Writing to Large Raster File
Message-ID: <5180138F0200002700019B0D@gwia2.boku.ac.at>

Hi Tom


In fact there is a difference:
see ?dataType why I do not use 'INT4U'. Probably the reason is that writeStart (see ?writeRaster) uses FLT4S as default and adding values in blocks the function doesn't know that FLT4S is not enough where else with out[] <- 1:ncell(out) it knows! I think that the solution.


> ?dataType
> nColVal<-1900
> outFileName <- 'tmp.grd'
> 
> #Set up raster
> out <- raster(nrow=20000,ncol=nColVal)#modisRasterAll
> 
> ##Get number of colums and blocksize
> outCol <- ncol(out)
> bs <- blockSize(out)
> 
> ##Write to file
> out <- writeStart(out,outFileName,overwrite=TRUE,datatype="FLT8S")
> for(i in 1:bs$n){
+ out <-
+ writeValues(out,cellFromRowCol(out,bs$row[i],1) :
+ cellFromRowCol(out,bs$row[i] + bs$nrow[i] -1 , ncol(out)) ,bs$row[i])
+ }
> out <- writeStop(out)
> 
> out2 <- raster(out)
> out2[]<- 1:ncell(out2)
> 
> res <- out-out2
tail(res)
      1881 1882 1883 1884 1885 1886 1887 1888 1889 1890 1891 1892 1893 1894
19991    0    0    0    0    0    0    0    0    0    0    0    0    0    0
19992    0    0    0    0    0    0    0    0    0    0    0    0    0    0
19993    0    0    0    0    0    0    0    0    0    0    0    0    0    0
19994    0    0    0    0    0    0    0    0    0    0    0    0    0    0
19995    0    0    0    0    0    0    0    0    0    0    0    0    0    0
19996    0    0    0    0    0    0    0    0    0    0    0    0    0    0
19997    0    0    0    0    0    0    0    0    0    0    0    0    0    0
19998    0    0    0    0    0    0    0    0    0    0    0    0    0    0
19999    0    0    0    0    0    0    0    0    0    0    0    0    0    0
20000    0    0    0    0    0    0    0    0    0    0    0    0    0    0
      1895 1896 1897 1898 1899 1900
19991    0    0    0    0    0    0
19992    0    0    0    0    0    0
19993    0    0    0    0    0    0
19994    0    0    0    0    0    0
19995    0    0    0    0    0    0
19996    0    0    0    0    0    0
19997    0    0    0    0    0    0
19998    0    0    0    0    0    0
19999    0    0    0    0    0    0
20000    0    0    0    0    0    0
> tail(out)
          1881     1882     1883     1884     1885     1886     1887     1888
19991 37982881 37982882 37982883 37982884 37982885 37982886 37982887 37982888
19992 37984781 37984782 37984783 37984784 37984785 37984786 37984787 37984788
19993 37986681 37986682 37986683 37986684 37986685 37986686 37986687 37986688
19994 37988581 37988582 37988583 37988584 37988585 37988586 37988587 37988588
19995 37990481 37990482 37990483 37990484 37990485 37990486 37990487 37990488
19996 37992381 37992382 37992383 37992384 37992385 37992386 37992387 37992388
19997 37994281 37994282 37994283 37994284 37994285 37994286 37994287 37994288
19998 37996181 37996182 37996183 37996184 37996185 37996186 37996187 37996188
19999 37998081 37998082 37998083 37998084 37998085 37998086 37998087 37998088
20000 37999981 37999982 37999983 37999984 37999985 37999986 37999987 37999988
          1889     1890     1891     1892     1893     1894     1895     1896
19991 37982889 37982890 37982891 37982892 37982893 37982894 37982895 37982896
19992 37984789 37984790 37984791 37984792 37984793 37984794 37984795 37984796
19993 37986689 37986690 37986691 37986692 37986693 37986694 37986695 37986696
19994 37988589 37988590 37988591 37988592 37988593 37988594 37988595 37988596
19995 37990489 37990490 37990491 37990492 37990493 37990494 37990495 37990496
19996 37992389 37992390 37992391 37992392 37992393 37992394 37992395 37992396
19997 37994289 37994290 37994291 37994292 37994293 37994294 37994295 37994296
19998 37996189 37996190 37996191 37996192 37996193 37996194 37996195 37996196
19999 37998089 37998090 37998091 37998092 37998093 37998094 37998095 37998096
20000 37999989 37999990 37999991 37999992 37999993 37999994 37999995 37999996
          1897     1898     1899     1900
19991 37982897 37982898 37982899 37982900
19992 37984797 37984798 37984799 37984800
19993 37986697 37986698 37986699 37986700
19994 37988597 37988598 37988599 37988600
19995 37990497 37990498 37990499 37990500
19996 37992397 37992398 37992399 37992400
19997 37994297 37994298 37994299 37994300
19998 37996197 37996198 37996199 37996200
19999 37998097 37998098 37998099 37998100
20000 37999997 37999998 37999999 38000000


>>> Tom Philippi  04/30/13 6:27 PM >>>
Ted & Matteo--
Is this perhaps a dataType problem?  I don't recall the specifics of the
significand of FLT4S but it's roughly 8 digits, so 38000000 may exceed it.
 You might try changing the dataType to INT4U to see if the dataType is the
problem.

Tom 2



On Tue, Apr 30, 2013 at 7:22 AM, Matteo Mattiuzzi <
matteo.mattiuzzi at boku.ac.at> wrote:

> Ted you are right!
>
>
> I have tried a few things and I can not explain the behaviour.
> @Robert may the example below helps a little further.
> I have also tried to write into a tif and an img file but it doesn't
> change. Also after reloading the file out <- raster("tmp.grd") the problem
> persists. Starting at row 8831 the values are strange...
> [I have also changed the value generation part, as it is little bit
> clearer to me for reading: cellFromRowCol(out,bs$row[i],1) :
> cellFromRowCol(out,bs$row[i] + bs$nrow[i] -1 , ncol(out)) ]
>
>
> R version 2.15.3 (2013-03-01) -- "Security Blanket"
> Copyright (C) 2013 The R Foundation for Statistical Computing
> ISBN 3-900051-07-0
> Platform: x86_64-pc-linux-gnu (64-bit)
>
>
> R is free software and comes with ABSOLUTELY NO WARRANTY.
> You are welcome to redistribute it under certain conditions.
> Type 'license()' or 'licence()' for distribution details.
>
>
>   Natural language support but running in an English locale
>
>
> R is a collaborative project with many contributors.
> Type 'contributors()' for more information and
> 'citation()' on how to cite R or R packages in publications.
>
>
> Type 'demo()' for some demos, 'help()' for on-line help, or
> 'help.start()' for an HTML browser interface to help.
> Type 'q()' to quit R.
>
>
> > library(raster)
> Loading required package: sp
> > sessionInfo()
> R version 2.15.3 (2013-03-01)
> Platform: x86_64-pc-linux-gnu (64-bit)
>
>
> locale:
>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>  [7] LC_PAPER=C                 LC_NAME=C
>  [9] LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
>
> other attached packages:
> [1] raster_2.1-25 sp_1.0-9
>
>
> loaded via a namespace (and not attached):
> [1] grid_2.15.3     lattice_0.20-15
> >
> > ##Write tile indexed MODIS file
> > #Prelims
> > nColVal<-1900
> > outFileName <- 'tmp.grd'
> >
> > #Set up raster
> > out <- raster(nrow=20000,ncol=nColVal)#modisRasterAll
> >
> > ##Get number of colums and blocksize
> > outCol <- ncol(out)
> > bs <- blockSize(out)
> >
> > ##Write to file
> > out <- writeStart(out,outFileName,overwrite=TRUE)
> > for(i in 1:bs$n){
> + out <-
> + writeValues(out,cellFromRowCol(out,bs$row[i],1) :
> cellFromRowCol(out,bs$row[i] + bs$nrow[i] -1 , ncol(out)) ,bs$row[i])
> + }
> > out <- writeStop(out)
> >
> > out2 <- raster(out)
> > out2[]<- 1:ncell(out2)
> >
> > res <- out-out2
> rgdal: version: 0.8-8, (SVN revision 463)
> Geospatial Data Abstraction Library extensions to R successfully loaded
> Loaded GDAL runtime: GDAL 1.9.2, released 2012/10/08
> Path to GDAL shared files: /usr/share/gdal/1.9
> Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
> Path to PROJ.4 shared files: (autodetected)
> >
> > sum(res[])
> [1] 0
> >
> > tail(out)
>           1881     1882     1883     1884     1885     1886     1887
> 1888
> 19991 37982880 37982880 37982884 37982884 37982884 37982888 37982888
> 37982888
> 19992 37984780 37984784 37984784 37984784 37984784 37984784 37984788
> 37984788
> 19993 37986680 37986680 37986684 37986684 37986684 37986688 37986688
> 37986688
> 19994 37988580 37988584 37988584 37988584 37988584 37988584 37988588
> 37988588
> 19995 37990480 37990480 37990484 37990484 37990484 37990488 37990488
> 37990488
> 19996 37992380 37992384 37992384 37992384 37992384 37992384 37992388
> 37992388
> 19997 37994280 37994280 37994284 37994284 37994284 37994288 37994288
> 37994288
> 19998 37996180 37996184 37996184 37996184 37996184 37996184 37996188
> 37996188
> 19999 37998080 37998080 37998084 37998084 37998084 37998088 37998088
> 37998088
> 20000 37999980 37999984 37999984 37999984 37999984 37999984 37999988
> 37999988
>           1889     1890     1891     1892     1893     1894     1895
> 1896
> 19991 37982888 37982888 37982892 37982892 37982892 37982896 37982896
> 37982896
> 19992 37984788 37984792 37984792 37984792 37984792 37984792 37984796
> 37984796
> 19993 37986688 37986688 37986692 37986692 37986692 37986696 37986696
> 37986696
> 19994 37988588 37988592 37988592 37988592 37988592 37988592 37988596
> 37988596
> 19995 37990488 37990488 37990492 37990492 37990492 37990496 37990496
> 37990496
> 19996 37992388 37992392 37992392 37992392 37992392 37992392 37992396
> 37992396
> 19997 37994288 37994288 37994292 37994292 37994292 37994296 37994296
> 37994296
> 19998 37996188 37996192 37996192 37996192 37996192 37996192 37996196
> 37996196
> 19999 37998088 37998088 37998092 37998092 37998092 37998096 37998096
> 37998096
> 20000 37999988 37999992 37999992 37999992 37999992 37999992 37999996
> 37999996
>           1897     1898     1899     1900
> 19991 37982896 37982896 37982900 37982900
> 19992 37984796 37984800 37984800 37984800
> 19993 37986696 37986696 37986700 37986700
> 19994 37988596 37988600 37988600 37988600
> 19995 37990496 37990496 37990500 37990500
> 19996 37992396 37992400 37992400 37992400
> 19997 37994296 37994296 37994300 37994300
> 19998 37996196 37996200 37996200 37996200
> 19999 37998096 37998096 37998100 37998100
> 20000 37999996 38000000 38000000 38000000
> > tail(out2)
>           1881     1882     1883     1884     1885     1886     1887
> 1888
> 19991 37982881 37982882 37982883 37982884 37982885 37982886 37982887
> 37982888
> 19992 37984781 37984782 37984783 37984784 37984785 37984786 37984787
> 37984788
> 19993 37986681 37986682 37986683 37986684 37986685 37986686 37986687
> 37986688
> 19994 37988581 37988582 37988583 37988584 37988585 37988586 37988587
> 37988588
> 19995 37990481 37990482 37990483 37990484 37990485 37990486 37990487
> 37990488
> 19996 37992381 37992382 37992383 37992384 37992385 37992386 37992387
> 37992388
> 19997 37994281 37994282 37994283 37994284 37994285 37994286 37994287
> 37994288
> 19998 37996181 37996182 37996183 37996184 37996185 37996186 37996187
> 37996188
> 19999 37998081 37998082 37998083 37998084 37998085 37998086 37998087
> 37998088
> 20000 37999981 37999982 37999983 37999984 37999985 37999986 37999987
> 37999988
>           1889     1890     1891     1892     1893     1894     1895
> 1896
> 19991 37982889 37982890 37982891 37982892 37982893 37982894 37982895
> 37982896
> 19992 37984789 37984790 37984791 37984792 37984793 37984794 37984795
> 37984796
> 19993 37986689 37986690 37986691 37986692 37986693 37986694 37986695
> 37986696
> 19994 37988589 37988590 37988591 37988592 37988593 37988594 37988595
> 37988596
> 19995 37990489 37990490 37990491 37990492 37990493 37990494 37990495
> 37990496
> 19996 37992389 37992390 37992391 37992392 37992393 37992394 37992395
> 37992396
> 19997 37994289 37994290 37994291 37994292 37994293 37994294 37994295
> 37994296
> 19998 37996189 37996190 37996191 37996192 37996193 37996194 37996195
> 37996196
> 19999 37998089 37998090 37998091 37998092 37998093 37998094 37998095
> 37998096
> 20000 37999989 37999990 37999991 37999992 37999993 37999994 37999995
> 37999996
>           1897     1898     1899     1900
> 19991 37982897 37982898 37982899 37982900
> 19992 37984797 37984798 37984799 37984800
> 19993 37986697 37986698 37986699 37986700
> 19994 37988597 37988598 37988599 37988600
> 19995 37990497 37990498 37990499 37990500
> 19996 37992397 37992398 37992399 37992400
> 19997 37994297 37994298 37994299 37994300
> 19998 37996197 37996198 37996199 37996200
> 19999 37998097 37998098 37998099 37998100
> 20000 37999997 37999998 37999999 38000000
> > tail(res)
>       1881 1882 1883 1884 1885 1886 1887 1888 1889 1890 1891 1892 1893 1894
> 19991   -1   -2    1    0   -1    2    1    0   -1   -2    1    0   -1    2
> 19992   -1    2    1    0   -1   -2    1    0   -1    2    1    0   -1   -2
> 19993   -1   -2    1    0   -1    2    1    0   -1   -2    1    0   -1    2
> 19994   -1    2    1    0   -1   -2    1    0   -1    2    1    0   -1   -2
> 19995   -1   -2    1    0   -1    2    1    0   -1   -2    1    0   -1    2
> 19996   -1    2    1    0   -1   -2    1    0   -1    2    1    0   -1   -2
> 19997   -1   -2    1    0   -1    2    1    0   -1   -2    1    0   -1    2
> 19998   -1    2    1    0   -1   -2    1    0   -1    2    1    0   -1   -2
> 19999   -1   -2    1    0   -1    2    1    0   -1   -2    1    0   -1    2
> 20000   -1    2    1    0   -1   -2    1    0   -1    2    1    0   -1   -2
>       1895 1896 1897 1898 1899 1900
> 19991    1    0   -1   -2    1    0
> 19992    1    0   -1    2    1    0
> 19993    1    0   -1   -2    1    0
> 19994    1    0   -1    2    1    0
> 19995    1    0   -1   -2    1    0
> 19996    1    0   -1    2    1    0
> 19997    1    0   -1   -2    1    0
> 19998    1    0   -1    2    1    0
> 19999    1    0   -1   -2    1    0
> 20000    1    0   -1    2    1    0
> >
> > res[8831,]
>    [1]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
>  0  0
>   [25]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
>  0  0
>   [49]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
>  0  0
>   [73]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
>  0  0
>   [97]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
>  0  0
>  [121]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
>  0  0
>  [145]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
>  0  0
>  [169]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
>  0  0
>  [193]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
>  0  0
>  [217] -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0
>  1  0
>  [241] -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0
>  1  0
>  [265] -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0
>  1  0
>  [289] -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0
>  1  0
>  [313] -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0
>  1  0
>  [337] -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0
>  1  0
>  [361] -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0
>  1  0
>  [385] -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0
>  1  0
>  [409] -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0
>  1  0
>  [433] -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0
>  1  0
>
>
> >>> Ted Rosenbaum  04/30/13 3:18 PM >>>
> Dear Matteo,
>
> Thanks for your response.
>
> You approach would work except that my computer can't handle it well since
> it loads everything into memory.  That is why I used the more complicated
> approach outlined here (
> http://cran.r-project.org/web/packages/raster/vignettes/functions.pdf).
>
>
>
>
>
>
> On Tue, Apr 30, 2013 at 3:24 AM, Matteo Mattiuzzi <
> matteo.mattiuzzi at boku.ac.at> wrote:
>
> > Dear Ted,
> >
> >
> > Isn't it simply that?
> > out <- raster(nrow=20000,ncol=1900)#modisRasterAll
> > out[] <- 1:ncell(out)
> >
> >
> > tail(out)
> >
> >
> >
> >
> > >>> Ted Rosenbaum  04/29/13 11:28 PM >>>
> > Hi,
> >
> > I am trying to assign a unique ID number to each tile in a large raster
> > file.
> >
> > My code is below:
> >
> > ##Write tile indexed MODIS file
> > #Prelims
> > nColVal<-190
> > outFileName <- 'tmp.grd'
> >
> > #Set up raster
> > out <- raster(nrow=20000,ncol=nColVal)#modisRasterAll
> >
> > ##Get number of colums and blocksize
> > outCol <- ncol(out)
> > bs <- blockSize(out)
> >
> > ##Write to file
> > out <- writeStart(out,outFileName,overwrite=TRUE)
> > for(i in 1:bs$n){
> >   print(i)
> >   out <-
> >
> >
> writeValues(out,((outCol*(bs$row[i]-1))+1):((bs$row[i]+bs$nrows[i]-1)*outCol),bs$row[i])
> > }
> > out <- writeStop(out)
> >
> > tail(out)
> >
> > When I run this code with nColVal=190, I get the expected result from
> > tail(out): a sequence of numbers.  However, when I run this code with
> > nColVal=1900, I do not and instead get
> > "37999996 38000000 38000000 38000000" for out[20000,1897:1900].
> >
> > I would like to get instead "37999997 37999998 37999999 38000000".
> >
> > Thanks for any assistance,
> >
> > Ted Rosenbaum
> > Department of Economics
> > Yale University
> >
> >     [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> >
> >
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From r.hijmans at gmail.com  Tue Apr 30 19:30:31 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 30 Apr 2013 10:30:31 -0700
Subject: [R-sig-Geo] Writing to Large Raster File
In-Reply-To: <5180138F0200002700019B0D@gwia2.boku.ac.at>
References: <5180138F0200002700019B0D@gwia2.boku.ac.at>
Message-ID: <CANtt_hzkP774AmNrDC7sOjbPnAHFw=ViLYyGT9sgzqs5F1J2QA@mail.gmail.com>

This is indeed because of precision loss due to FLT4S. Numbers larger
than 16777216 cannot be recovered to the exact integer from a 4 byte
floating point file. To avoid this I will change the default that
'raster' uses to FLT8S. This will double file sizes if the default is
used.

Ted, you can achieve what you are doing in this way, using the "init"
function, using the "datatype="  argument:

library(raster)
nColVal<-1900
outFileName <- 'tmp3.grd'
out <- raster(nrow=20000,ncol=nColVal)#modisRasterAll

out <- init(out, v='cell', filename=outFileName, datatype='INT4S')

# or    out <- init(out, v='cell', filename=outFileName, datatype='FLT8S')


Robert

On Tue, Apr 30, 2013 at 9:55 AM, Matteo Mattiuzzi
<matteo.mattiuzzi at boku.ac.at> wrote:
> Hi Tom
>
>
> In fact there is a difference:
> see ?dataType why I do not use 'INT4U'. Probably the reason is that writeStart (see ?writeRaster) uses FLT4S as default and adding values in blocks the function doesn't know that FLT4S is not enough where else with out[] <- 1:ncell(out) it knows! I think that the solution.
>
>
>> ?dataType
>> nColVal<-1900
>> outFileName <- 'tmp.grd'
>>
>> #Set up raster
>> out <- raster(nrow=20000,ncol=nColVal)#modisRasterAll
>>
>> ##Get number of colums and blocksize
>> outCol <- ncol(out)
>> bs <- blockSize(out)
>>
>> ##Write to file
>> out <- writeStart(out,outFileName,overwrite=TRUE,datatype="FLT8S")
>> for(i in 1:bs$n){
> + out <-
> + writeValues(out,cellFromRowCol(out,bs$row[i],1) :
> + cellFromRowCol(out,bs$row[i] + bs$nrow[i] -1 , ncol(out)) ,bs$row[i])
> + }
>> out <- writeStop(out)
>>
>> out2 <- raster(out)
>> out2[]<- 1:ncell(out2)
>>
>> res <- out-out2
> tail(res)
>       1881 1882 1883 1884 1885 1886 1887 1888 1889 1890 1891 1892 1893 1894
> 19991    0    0    0    0    0    0    0    0    0    0    0    0    0    0
> 19992    0    0    0    0    0    0    0    0    0    0    0    0    0    0
> 19993    0    0    0    0    0    0    0    0    0    0    0    0    0    0
> 19994    0    0    0    0    0    0    0    0    0    0    0    0    0    0
> 19995    0    0    0    0    0    0    0    0    0    0    0    0    0    0
> 19996    0    0    0    0    0    0    0    0    0    0    0    0    0    0
> 19997    0    0    0    0    0    0    0    0    0    0    0    0    0    0
> 19998    0    0    0    0    0    0    0    0    0    0    0    0    0    0
> 19999    0    0    0    0    0    0    0    0    0    0    0    0    0    0
> 20000    0    0    0    0    0    0    0    0    0    0    0    0    0    0
>       1895 1896 1897 1898 1899 1900
> 19991    0    0    0    0    0    0
> 19992    0    0    0    0    0    0
> 19993    0    0    0    0    0    0
> 19994    0    0    0    0    0    0
> 19995    0    0    0    0    0    0
> 19996    0    0    0    0    0    0
> 19997    0    0    0    0    0    0
> 19998    0    0    0    0    0    0
> 19999    0    0    0    0    0    0
> 20000    0    0    0    0    0    0
>> tail(out)
>           1881     1882     1883     1884     1885     1886     1887     1888
> 19991 37982881 37982882 37982883 37982884 37982885 37982886 37982887 37982888
> 19992 37984781 37984782 37984783 37984784 37984785 37984786 37984787 37984788
> 19993 37986681 37986682 37986683 37986684 37986685 37986686 37986687 37986688
> 19994 37988581 37988582 37988583 37988584 37988585 37988586 37988587 37988588
> 19995 37990481 37990482 37990483 37990484 37990485 37990486 37990487 37990488
> 19996 37992381 37992382 37992383 37992384 37992385 37992386 37992387 37992388
> 19997 37994281 37994282 37994283 37994284 37994285 37994286 37994287 37994288
> 19998 37996181 37996182 37996183 37996184 37996185 37996186 37996187 37996188
> 19999 37998081 37998082 37998083 37998084 37998085 37998086 37998087 37998088
> 20000 37999981 37999982 37999983 37999984 37999985 37999986 37999987 37999988
>           1889     1890     1891     1892     1893     1894     1895     1896
> 19991 37982889 37982890 37982891 37982892 37982893 37982894 37982895 37982896
> 19992 37984789 37984790 37984791 37984792 37984793 37984794 37984795 37984796
> 19993 37986689 37986690 37986691 37986692 37986693 37986694 37986695 37986696
> 19994 37988589 37988590 37988591 37988592 37988593 37988594 37988595 37988596
> 19995 37990489 37990490 37990491 37990492 37990493 37990494 37990495 37990496
> 19996 37992389 37992390 37992391 37992392 37992393 37992394 37992395 37992396
> 19997 37994289 37994290 37994291 37994292 37994293 37994294 37994295 37994296
> 19998 37996189 37996190 37996191 37996192 37996193 37996194 37996195 37996196
> 19999 37998089 37998090 37998091 37998092 37998093 37998094 37998095 37998096
> 20000 37999989 37999990 37999991 37999992 37999993 37999994 37999995 37999996
>           1897     1898     1899     1900
> 19991 37982897 37982898 37982899 37982900
> 19992 37984797 37984798 37984799 37984800
> 19993 37986697 37986698 37986699 37986700
> 19994 37988597 37988598 37988599 37988600
> 19995 37990497 37990498 37990499 37990500
> 19996 37992397 37992398 37992399 37992400
> 19997 37994297 37994298 37994299 37994300
> 19998 37996197 37996198 37996199 37996200
> 19999 37998097 37998098 37998099 37998100
> 20000 37999997 37999998 37999999 38000000
>
>
>>>> Tom Philippi  04/30/13 6:27 PM >>>
> Ted & Matteo--
> Is this perhaps a dataType problem?  I don't recall the specifics of the
> significand of FLT4S but it's roughly 8 digits, so 38000000 may exceed it.
>  You might try changing the dataType to INT4U to see if the dataType is the
> problem.
>
> Tom 2
>
>
>
> On Tue, Apr 30, 2013 at 7:22 AM, Matteo Mattiuzzi <
> matteo.mattiuzzi at boku.ac.at> wrote:
>
>> Ted you are right!
>>
>>
>> I have tried a few things and I can not explain the behaviour.
>> @Robert may the example below helps a little further.
>> I have also tried to write into a tif and an img file but it doesn't
>> change. Also after reloading the file out <- raster("tmp.grd") the problem
>> persists. Starting at row 8831 the values are strange...
>> [I have also changed the value generation part, as it is little bit
>> clearer to me for reading: cellFromRowCol(out,bs$row[i],1) :
>> cellFromRowCol(out,bs$row[i] + bs$nrow[i] -1 , ncol(out)) ]
>>
>>
>> R version 2.15.3 (2013-03-01) -- "Security Blanket"
>> Copyright (C) 2013 The R Foundation for Statistical Computing
>> ISBN 3-900051-07-0
>> Platform: x86_64-pc-linux-gnu (64-bit)
>>
>>
>> R is free software and comes with ABSOLUTELY NO WARRANTY.
>> You are welcome to redistribute it under certain conditions.
>> Type 'license()' or 'licence()' for distribution details.
>>
>>
>>   Natural language support but running in an English locale
>>
>>
>> R is a collaborative project with many contributors.
>> Type 'contributors()' for more information and
>> 'citation()' on how to cite R or R packages in publications.
>>
>>
>> Type 'demo()' for some demos, 'help()' for on-line help, or
>> 'help.start()' for an HTML browser interface to help.
>> Type 'q()' to quit R.
>>
>>
>> > library(raster)
>> Loading required package: sp
>> > sessionInfo()
>> R version 2.15.3 (2013-03-01)
>> Platform: x86_64-pc-linux-gnu (64-bit)
>>
>>
>> locale:
>>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>>  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>>  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>>  [7] LC_PAPER=C                 LC_NAME=C
>>  [9] LC_ADDRESS=C               LC_TELEPHONE=C
>> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>>
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>>
>> other attached packages:
>> [1] raster_2.1-25 sp_1.0-9
>>
>>
>> loaded via a namespace (and not attached):
>> [1] grid_2.15.3     lattice_0.20-15
>> >
>> > ##Write tile indexed MODIS file
>> > #Prelims
>> > nColVal<-1900
>> > outFileName <- 'tmp.grd'
>> >
>> > #Set up raster
>> > out <- raster(nrow=20000,ncol=nColVal)#modisRasterAll
>> >
>> > ##Get number of colums and blocksize
>> > outCol <- ncol(out)
>> > bs <- blockSize(out)
>> >
>> > ##Write to file
>> > out <- writeStart(out,outFileName,overwrite=TRUE)
>> > for(i in 1:bs$n){
>> + out <-
>> + writeValues(out,cellFromRowCol(out,bs$row[i],1) :
>> cellFromRowCol(out,bs$row[i] + bs$nrow[i] -1 , ncol(out)) ,bs$row[i])
>> + }
>> > out <- writeStop(out)
>> >
>> > out2 <- raster(out)
>> > out2[]<- 1:ncell(out2)
>> >
>> > res <- out-out2
>> rgdal: version: 0.8-8, (SVN revision 463)
>> Geospatial Data Abstraction Library extensions to R successfully loaded
>> Loaded GDAL runtime: GDAL 1.9.2, released 2012/10/08
>> Path to GDAL shared files: /usr/share/gdal/1.9
>> Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
>> Path to PROJ.4 shared files: (autodetected)
>> >
>> > sum(res[])
>> [1] 0
>> >
>> > tail(out)
>>           1881     1882     1883     1884     1885     1886     1887
>> 1888
>> 19991 37982880 37982880 37982884 37982884 37982884 37982888 37982888
>> 37982888
>> 19992 37984780 37984784 37984784 37984784 37984784 37984784 37984788
>> 37984788
>> 19993 37986680 37986680 37986684 37986684 37986684 37986688 37986688
>> 37986688
>> 19994 37988580 37988584 37988584 37988584 37988584 37988584 37988588
>> 37988588
>> 19995 37990480 37990480 37990484 37990484 37990484 37990488 37990488
>> 37990488
>> 19996 37992380 37992384 37992384 37992384 37992384 37992384 37992388
>> 37992388
>> 19997 37994280 37994280 37994284 37994284 37994284 37994288 37994288
>> 37994288
>> 19998 37996180 37996184 37996184 37996184 37996184 37996184 37996188
>> 37996188
>> 19999 37998080 37998080 37998084 37998084 37998084 37998088 37998088
>> 37998088
>> 20000 37999980 37999984 37999984 37999984 37999984 37999984 37999988
>> 37999988
>>           1889     1890     1891     1892     1893     1894     1895
>> 1896
>> 19991 37982888 37982888 37982892 37982892 37982892 37982896 37982896
>> 37982896
>> 19992 37984788 37984792 37984792 37984792 37984792 37984792 37984796
>> 37984796
>> 19993 37986688 37986688 37986692 37986692 37986692 37986696 37986696
>> 37986696
>> 19994 37988588 37988592 37988592 37988592 37988592 37988592 37988596
>> 37988596
>> 19995 37990488 37990488 37990492 37990492 37990492 37990496 37990496
>> 37990496
>> 19996 37992388 37992392 37992392 37992392 37992392 37992392 37992396
>> 37992396
>> 19997 37994288 37994288 37994292 37994292 37994292 37994296 37994296
>> 37994296
>> 19998 37996188 37996192 37996192 37996192 37996192 37996192 37996196
>> 37996196
>> 19999 37998088 37998088 37998092 37998092 37998092 37998096 37998096
>> 37998096
>> 20000 37999988 37999992 37999992 37999992 37999992 37999992 37999996
>> 37999996
>>           1897     1898     1899     1900
>> 19991 37982896 37982896 37982900 37982900
>> 19992 37984796 37984800 37984800 37984800
>> 19993 37986696 37986696 37986700 37986700
>> 19994 37988596 37988600 37988600 37988600
>> 19995 37990496 37990496 37990500 37990500
>> 19996 37992396 37992400 37992400 37992400
>> 19997 37994296 37994296 37994300 37994300
>> 19998 37996196 37996200 37996200 37996200
>> 19999 37998096 37998096 37998100 37998100
>> 20000 37999996 38000000 38000000 38000000
>> > tail(out2)
>>           1881     1882     1883     1884     1885     1886     1887
>> 1888
>> 19991 37982881 37982882 37982883 37982884 37982885 37982886 37982887
>> 37982888
>> 19992 37984781 37984782 37984783 37984784 37984785 37984786 37984787
>> 37984788
>> 19993 37986681 37986682 37986683 37986684 37986685 37986686 37986687
>> 37986688
>> 19994 37988581 37988582 37988583 37988584 37988585 37988586 37988587
>> 37988588
>> 19995 37990481 37990482 37990483 37990484 37990485 37990486 37990487
>> 37990488
>> 19996 37992381 37992382 37992383 37992384 37992385 37992386 37992387
>> 37992388
>> 19997 37994281 37994282 37994283 37994284 37994285 37994286 37994287
>> 37994288
>> 19998 37996181 37996182 37996183 37996184 37996185 37996186 37996187
>> 37996188
>> 19999 37998081 37998082 37998083 37998084 37998085 37998086 37998087
>> 37998088
>> 20000 37999981 37999982 37999983 37999984 37999985 37999986 37999987
>> 37999988
>>           1889     1890     1891     1892     1893     1894     1895
>> 1896
>> 19991 37982889 37982890 37982891 37982892 37982893 37982894 37982895
>> 37982896
>> 19992 37984789 37984790 37984791 37984792 37984793 37984794 37984795
>> 37984796
>> 19993 37986689 37986690 37986691 37986692 37986693 37986694 37986695
>> 37986696
>> 19994 37988589 37988590 37988591 37988592 37988593 37988594 37988595
>> 37988596
>> 19995 37990489 37990490 37990491 37990492 37990493 37990494 37990495
>> 37990496
>> 19996 37992389 37992390 37992391 37992392 37992393 37992394 37992395
>> 37992396
>> 19997 37994289 37994290 37994291 37994292 37994293 37994294 37994295
>> 37994296
>> 19998 37996189 37996190 37996191 37996192 37996193 37996194 37996195
>> 37996196
>> 19999 37998089 37998090 37998091 37998092 37998093 37998094 37998095
>> 37998096
>> 20000 37999989 37999990 37999991 37999992 37999993 37999994 37999995
>> 37999996
>>           1897     1898     1899     1900
>> 19991 37982897 37982898 37982899 37982900
>> 19992 37984797 37984798 37984799 37984800
>> 19993 37986697 37986698 37986699 37986700
>> 19994 37988597 37988598 37988599 37988600
>> 19995 37990497 37990498 37990499 37990500
>> 19996 37992397 37992398 37992399 37992400
>> 19997 37994297 37994298 37994299 37994300
>> 19998 37996197 37996198 37996199 37996200
>> 19999 37998097 37998098 37998099 37998100
>> 20000 37999997 37999998 37999999 38000000
>> > tail(res)
>>       1881 1882 1883 1884 1885 1886 1887 1888 1889 1890 1891 1892 1893 1894
>> 19991   -1   -2    1    0   -1    2    1    0   -1   -2    1    0   -1    2
>> 19992   -1    2    1    0   -1   -2    1    0   -1    2    1    0   -1   -2
>> 19993   -1   -2    1    0   -1    2    1    0   -1   -2    1    0   -1    2
>> 19994   -1    2    1    0   -1   -2    1    0   -1    2    1    0   -1   -2
>> 19995   -1   -2    1    0   -1    2    1    0   -1   -2    1    0   -1    2
>> 19996   -1    2    1    0   -1   -2    1    0   -1    2    1    0   -1   -2
>> 19997   -1   -2    1    0   -1    2    1    0   -1   -2    1    0   -1    2
>> 19998   -1    2    1    0   -1   -2    1    0   -1    2    1    0   -1   -2
>> 19999   -1   -2    1    0   -1    2    1    0   -1   -2    1    0   -1    2
>> 20000   -1    2    1    0   -1   -2    1    0   -1    2    1    0   -1   -2
>>       1895 1896 1897 1898 1899 1900
>> 19991    1    0   -1   -2    1    0
>> 19992    1    0   -1    2    1    0
>> 19993    1    0   -1   -2    1    0
>> 19994    1    0   -1    2    1    0
>> 19995    1    0   -1   -2    1    0
>> 19996    1    0   -1    2    1    0
>> 19997    1    0   -1   -2    1    0
>> 19998    1    0   -1    2    1    0
>> 19999    1    0   -1   -2    1    0
>> 20000    1    0   -1    2    1    0
>> >
>> > res[8831,]
>>    [1]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
>>  0  0
>>   [25]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
>>  0  0
>>   [49]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
>>  0  0
>>   [73]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
>>  0  0
>>   [97]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
>>  0  0
>>  [121]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
>>  0  0
>>  [145]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
>>  0  0
>>  [169]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
>>  0  0
>>  [193]  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
>>  0  0
>>  [217] -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0
>>  1  0
>>  [241] -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0
>>  1  0
>>  [265] -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0
>>  1  0
>>  [289] -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0
>>  1  0
>>  [313] -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0
>>  1  0
>>  [337] -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0
>>  1  0
>>  [361] -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0
>>  1  0
>>  [385] -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0
>>  1  0
>>  [409] -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0
>>  1  0
>>  [433] -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0  1  0 -1  0
>>  1  0
>>
>>
>> >>> Ted Rosenbaum  04/30/13 3:18 PM >>>
>> Dear Matteo,
>>
>> Thanks for your response.
>>
>> You approach would work except that my computer can't handle it well since
>> it loads everything into memory.  That is why I used the more complicated
>> approach outlined here (
>> http://cran.r-project.org/web/packages/raster/vignettes/functions.pdf).
>>
>>
>>
>>
>>
>>
>> On Tue, Apr 30, 2013 at 3:24 AM, Matteo Mattiuzzi <
>> matteo.mattiuzzi at boku.ac.at> wrote:
>>
>> > Dear Ted,
>> >
>> >
>> > Isn't it simply that?
>> > out <- raster(nrow=20000,ncol=1900)#modisRasterAll
>> > out[] <- 1:ncell(out)
>> >
>> >
>> > tail(out)
>> >
>> >
>> >
>> >
>> > >>> Ted Rosenbaum  04/29/13 11:28 PM >>>
>> > Hi,
>> >
>> > I am trying to assign a unique ID number to each tile in a large raster
>> > file.
>> >
>> > My code is below:
>> >
>> > ##Write tile indexed MODIS file
>> > #Prelims
>> > nColVal<-190
>> > outFileName <- 'tmp.grd'
>> >
>> > #Set up raster
>> > out <- raster(nrow=20000,ncol=nColVal)#modisRasterAll
>> >
>> > ##Get number of colums and blocksize
>> > outCol <- ncol(out)
>> > bs <- blockSize(out)
>> >
>> > ##Write to file
>> > out <- writeStart(out,outFileName,overwrite=TRUE)
>> > for(i in 1:bs$n){
>> >   print(i)
>> >   out <-
>> >
>> >
>> writeValues(out,((outCol*(bs$row[i]-1))+1):((bs$row[i]+bs$nrows[i]-1)*outCol),bs$row[i])
>> > }
>> > out <- writeStop(out)
>> >
>> > tail(out)
>> >
>> > When I run this code with nColVal=190, I get the expected result from
>> > tail(out): a sequence of numbers.  However, when I run this code with
>> > nColVal=1900, I do not and instead get
>> > "37999996 38000000 38000000 38000000" for out[20000,1897:1900].
>> >
>> > I would like to get instead "37999997 37999998 37999999 38000000".
>> >
>> > Thanks for any assistance,
>> >
>> > Ted Rosenbaum
>> > Department of Economics
>> > Yale University
>> >
>> >     [[alternative HTML version deleted]]
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at r-project.org
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >
>> >
>> >
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>


From edukoski at gmail.com  Tue Apr 30 19:39:46 2013
From: edukoski at gmail.com (Eduardo Bienkowski)
Date: Tue, 30 Apr 2013 17:39:46 +0000 (UTC)
Subject: [R-sig-Geo] =?utf-8?q?Invitaci=C3=B3n_a_conectarse_en_LinkedIn?=
Message-ID: <1765863214.9370212.1367343586227.JavaMail.app@ela4-bed77.prod>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130430/c9e0d89f/attachment.pl>

From ted.rosenbaum at yale.edu  Tue Apr 30 20:03:32 2013
From: ted.rosenbaum at yale.edu (Ted Rosenbaum)
Date: Tue, 30 Apr 2013 14:03:32 -0400
Subject: [R-sig-Geo] Writing to Large Raster File
In-Reply-To: <CANtt_hzkP774AmNrDC7sOjbPnAHFw=ViLYyGT9sgzqs5F1J2QA@mail.gmail.com>
References: <5180138F0200002700019B0D@gwia2.boku.ac.at>
	<CANtt_hzkP774AmNrDC7sOjbPnAHFw=ViLYyGT9sgzqs5F1J2QA@mail.gmail.com>
Message-ID: <CAJgfpii7HJ7uSKr3_iT8SxGO1q5ksdberSiM6TYV1hBLNtMvNQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130430/5988b65e/attachment.pl>

