From e.j.tommo at gmail.com  Sat Nov  1 01:47:55 2008
From: e.j.tommo at gmail.com (Edward Tomlinson)
Date: Sat, 1 Nov 2008 11:47:55 +1100
Subject: [R-sig-Geo] Newbie question: Reclassifying raster (ndvi) using
	fisher method
Message-ID: <285eec980810311747y3cb8d6a7t399b9da2a283d0af@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081101/e5ffd9f5/attachment.pl>

From Agustin.Lobo at ija.csic.es  Sat Nov  1 12:48:32 2008
From: Agustin.Lobo at ija.csic.es (Agustin Lobo)
Date: Sat, 01 Nov 2008 12:48:32 +0100
Subject: [R-sig-Geo] Newbie question: Reclassifying raster (ndvi)
 using	fisher method
Message-ID: <490C4210.5060707@ija.csic.es>

I think that you should avoid importing to R the whole
raster, which is not required for classIntervals(). Just
make an stats table with r.stats -c, export the resulting table (DN,freq 
for each DN)
to R, and then either (i) make an small (subsampled) version
of the object "var" required by classIntervals (statistically,
the intervals will be the same) or
(ii) make an slight modification to the classIntervals code in
which the function would accept the stats table instead of var.

Agus

> Message: 5
> Date: Sat, 1 Nov 2008 11:47:55 +1100
> From: "Edward Tomlinson" <e.j.tommo at gmail.com>
> Subject: [R-sig-Geo] Newbie question: Reclassifying raster (ndvi)
> 	using	fisher method
> To: grass-user at lists.osgeo.org,	"r-sig-geo at stat.math.ethz.ch"
> 	<r-sig-geo at stat.math.ethz.ch>
> Message-ID:
> 	<285eec980810311747y3cb8d6a7t399b9da2a283d0af at mail.gmail.com>
> Content-Type: text/plain
> 
> Hi all,
> 
> I am not sure as to which list this best fits (Grass or R-sig-geo).
> 
> I am trying to reclass a raster map (ndvi) into 5 different zones using the
> fisher method, ultimatley i am trying to reclass as natural breaks.
> 
> The point of this exercise is for precision agriculture. I want to determine
> management zones according to the current crop, so i can use this
> information for inputs for next years crop. Therefore i have no use for a
> range of ndvi values -1 thru 1. I need to split this into a number of zones
> (5 or 7 is good number, unless i can get an algorithm to determine the exact
> number of groups it needs). Each zone then in turn needs to be ground
> truthed (hence need for classifying into 5 or 7 zones).
> 
> My problem at the moment is that the way i am doing it takes a while... I
> would sure love it if anyone has any suggestions to speed up the process...
> Is it possible to do the reclass bit in R and export the raster
> (SpatialDataFrame) back into grass? I have read a post from Roger Bivand on
> how to do the whole classinterval thing (thank you Roger) however i am
> unsure of how then to create a new image from those values. I have looked
> through the sp package breifly but I dont very well understand the R system.
> 
> 
> Current method (this has to be done for each paddock, or paddocks can be
> grouped if they have similar management history).
> 
> create ndvi
> r.mapcalc 'ndvi=1.0*(nir-red)/(nir+red)'
> move ndvi raster to R
> -R-R-R-----------------
> library(spgrass6)
> G <- gmeta6()
> ndvi <- readRAST6(ndvi at mapset)
> library(classInt)
> t1 <- classIntervals(ndvi$ndvi.mapset, n=5, style="fisher")
> print(t1)
> --------------------------------
> create text document for reclass rules, multiply everything by 10,000,000
> (as reclass will round my numbers)
> -----------------------------
> back in grass
> r.mapcalc ndvi_10M = ndvi * 10000000
> r.reclass input=ndvi_10M output=ndvi.reclass rules="rules created in text
> doc" title="title"
> 
> 
> I hope this all makes sense. Thank you for your time and reading through my
> problem. If you have any suggestions i sure would be greatful.
> 
> Kind regards,
> Ed

-- 
Dr. Agustin Lobo
Institut de Ciencies de la Terra "Jaume Almera" (CSIC)
LLuis Sole Sabaris s/n
08028 Barcelona
Spain
Tel. 34 934095410
Fax. 34 934110012
email: Agustin.Lobo at ija.csic.es
http://www.ija.csic.es/gt/obster



From infohunter at gmail.com  Mon Nov  3 08:43:21 2008
From: infohunter at gmail.com (Harry Kim)
Date: Sun, 2 Nov 2008 23:43:21 -0800
Subject: [R-sig-Geo] extracting information from a raster file
Message-ID: <91b8161f0811022343p3099f0f1ydaf936453708a29e@mail.gmail.com>

Dear R-sig-geo users,

    I have a question about extracting information from a raster file
after I read it in using rgdal package, and I would be infinitely
grateful if someone could help me.
    The summary of raster file looks like this:

#summary of raster file
> summary(xxx)
Object of class SpatialGridDataFrame
Coordinates:
   min max
x -180 180
y  -90  90
Is projected: FALSE
proj4string :
[+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0]
Number of points: 2
Grid attributes:
  cellcentre.offset cellsize cells.dim
x           -179.10      1.8       200
y            -89.55      0.9       200
Data attributes:
     Min.   1st Qu.    Median      Mean   3rd Qu.      Max.      NA's
    0.000     0.000     0.000    47.010     3.264 13540.000 26563.000

I would like to write a code that extracts the value of associated
cell given a specific location in latitude and longitude. I've noticed
that xxx at data contains the values as 40000 x 1 matrix. I've wrote the
following code assuming that the values are stored as in C programing
(column wise seperation):


#initiate values
x_inc=xxx at grid@cellsize[1]
y_inc=xxx at grid@cellsize[2]

x_start=xxx at grid@cellcentre.offset[1]
y_start=xxx at grid@cellcentre.offset[2]

x_dim=xxx at grid@cells.dim[1]
y_dim=xxx at grid@cells.dim[2]

#given coordinate
x=26
y=45

#find the index
index=floor((x-x_start)/x_inc)*y_dim + floor( (y-y_start)/y_inc )
xxx at data[index,1]

The result does not seem to match what I should get. Could anybody
explain to me how the data is stored in SpatialGridDataFrame? Your
help would be much much appreciated.

Thank you and have a good night
Harry



From Roger.Bivand at nhh.no  Mon Nov  3 09:18:21 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 3 Nov 2008 09:18:21 +0100 (CET)
Subject: [R-sig-Geo] extracting information from a raster file
In-Reply-To: <91b8161f0811022343p3099f0f1ydaf936453708a29e@mail.gmail.com>
References: <91b8161f0811022343p3099f0f1ydaf936453708a29e@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0811030915010.12616@reclus.nhh.no>

On Sun, 2 Nov 2008, Harry Kim wrote:

> Dear R-sig-geo users,
>
>    I have a question about extracting information from a raster file
> after I read it in using rgdal package, and I would be infinitely
> grateful if someone could help me.

The overlay() method is what you need:

library(sp)
data(meuse.grid)
data(meuse)
coordinates(meuse.grid) <- c("x", "y")
coordinates(meuse) <- c("x", "y")
gridded(meuse.grid) <- TRUE
gatp <- overlay(meuse.grid, as(meuse, "SpatialPoints"))
plot(meuse.grid[gatp,])
plot(meuse, pch=4, col="red", add=TRUE)

overlay() gives the indices you are looking for, so you can either index 
the whole object to get a similar object back, or index the column in your 
object:

xxx$band1[gatp]

Hope this helps,

Roger

>    The summary of raster file looks like this:
>
> #summary of raster file
>> summary(xxx)
> Object of class SpatialGridDataFrame
> Coordinates:
>   min max
> x -180 180
> y  -90  90
> Is projected: FALSE
> proj4string :
> [+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0]
> Number of points: 2
> Grid attributes:
>  cellcentre.offset cellsize cells.dim
> x           -179.10      1.8       200
> y            -89.55      0.9       200
> Data attributes:
>     Min.   1st Qu.    Median      Mean   3rd Qu.      Max.      NA's
>    0.000     0.000     0.000    47.010     3.264 13540.000 26563.000
>
> I would like to write a code that extracts the value of associated
> cell given a specific location in latitude and longitude. I've noticed
> that xxx at data contains the values as 40000 x 1 matrix. I've wrote the
> following code assuming that the values are stored as in C programing
> (column wise seperation):
>
>
> #initiate values
> x_inc=xxx at grid@cellsize[1]
> y_inc=xxx at grid@cellsize[2]
>
> x_start=xxx at grid@cellcentre.offset[1]
> y_start=xxx at grid@cellcentre.offset[2]
>
> x_dim=xxx at grid@cells.dim[1]
> y_dim=xxx at grid@cells.dim[2]
>
> #given coordinate
> x=26
> y=45
>
> #find the index
> index=floor((x-x_start)/x_inc)*y_dim + floor( (y-y_start)/y_inc )
> xxx at data[index,1]
>
> The result does not seem to match what I should get. Could anybody
> explain to me how the data is stored in SpatialGridDataFrame? Your
> help would be much much appreciated.
>
> Thank you and have a good night
> Harry
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From p.hiemstra at geo.uu.nl  Mon Nov  3 09:22:44 2008
From: p.hiemstra at geo.uu.nl (Paul Hiemstra)
Date: Mon, 03 Nov 2008 09:22:44 +0100
Subject: [R-sig-Geo] extracting information from a raster file
In-Reply-To: <91b8161f0811022343p3099f0f1ydaf936453708a29e@mail.gmail.com>
References: <91b8161f0811022343p3099f0f1ydaf936453708a29e@mail.gmail.com>
Message-ID: <490EB4D4.2000807@geo.uu.nl>

Hi Harry,

I think what you want can be achieved using the overlay function 
(package sp). Code example:

sgdf    #SpatialGridDataframe
sp       # SpatialPoints (can also be SpatialPointsDataFrame), put the 
coordinates
           # where you want to know the attributes of the grid in here
overlay(sp, sgdf) # Returns the indices in sgdf that match sp
sgdf[overlay(sp,sgdf),] # Returns the values using those indices

So I think that you don't have to write any code to get what you want :).

cheers,
Paul

Harry Kim wrote:
> Dear R-sig-geo users,
>
>     I have a question about extracting information from a raster file
> after I read it in using rgdal package, and I would be infinitely
> grateful if someone could help me.
>     The summary of raster file looks like this:
>
> #summary of raster file
>   
>> summary(xxx)
>>     
> Object of class SpatialGridDataFrame
> Coordinates:
>    min max
> x -180 180
> y  -90  90
> Is projected: FALSE
> proj4string :
> [+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0]
> Number of points: 2
> Grid attributes:
>   cellcentre.offset cellsize cells.dim
> x           -179.10      1.8       200
> y            -89.55      0.9       200
> Data attributes:
>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max.      NA's
>     0.000     0.000     0.000    47.010     3.264 13540.000 26563.000
>
> I would like to write a code that extracts the value of associated
> cell given a specific location in latitude and longitude. I've noticed
> that xxx at data contains the values as 40000 x 1 matrix. I've wrote the
> following code assuming that the values are stored as in C programing
> (column wise seperation):
>
>
> #initiate values
> x_inc=xxx at grid@cellsize[1]
> y_inc=xxx at grid@cellsize[2]
>
> x_start=xxx at grid@cellcentre.offset[1]
> y_start=xxx at grid@cellcentre.offset[2]
>
> x_dim=xxx at grid@cells.dim[1]
> y_dim=xxx at grid@cells.dim[2]
>
> #given coordinate
> x=26
> y=45
>
> #find the index
> index=floor((x-x_start)/x_inc)*y_dim + floor( (y-y_start)/y_inc )
> xxx at data[index,1]
>
> The result does not seem to match what I should get. Could anybody
> explain to me how the data is stored in SpatialGridDataFrame? Your
> help would be much much appreciated.
>
> Thank you and have a good night
> Harry
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   


-- 
Drs. Paul Hiemstra
Department of Physical Geography
Faculty of Geosciences
University of Utrecht
Heidelberglaan 2
P.O. Box 80.115
3508 TC Utrecht
Phone: 	+31302535773
Fax:	+31302531145
http://intamap.geo.uu.nl/~paul



From edzer.pebesma at uni-muenster.de  Mon Nov  3 09:27:18 2008
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 03 Nov 2008 09:27:18 +0100
Subject: [R-sig-Geo] extracting information from a raster file
In-Reply-To: <91b8161f0811022343p3099f0f1ydaf936453708a29e@mail.gmail.com>
References: <91b8161f0811022343p3099f0f1ydaf936453708a29e@mail.gmail.com>
Message-ID: <490EB5E6.7000400@uni-muenster.de>

We (the developers from sp) tried hard to relieve you from writing such 
code. Please try the following code, which requires you to click on the 
grid map after locator(1):

library(sp)
data(meuse.grid)
coordinates(meuse.grid)=~x+y
gridded(meuse.grid)=TRUE
fullgrid(meuse.grid) = TRUE
image(meuse.grid["dist"])
pt = locator(1)
pt
pt.sp = SpatialPoints(matrix(c(pt[[1]], pt[[2]]), 1, 2))
pt.sp
overlay(meuse.grid, pt.sp)

Besides being equally efficient, this code should remain working even if 
some internal representations of the sp classes were to change.

While looking at your code below, I have the feeling you forget that R 
arrays start with index 1, whereas C arrays start with index 0. You can 
check the sp sources to be 100% certain, but I also believe that the sp 
organization lets vary x first, then y.
--
Edzer

Harry Kim wrote:
> Dear R-sig-geo users,
>
>     I have a question about extracting information from a raster file
> after I read it in using rgdal package, and I would be infinitely
> grateful if someone could help me.
>     The summary of raster file looks like this:
>
> #summary of raster file
>   
>> summary(xxx)
>>     
> Object of class SpatialGridDataFrame
> Coordinates:
>    min max
> x -180 180
> y  -90  90
> Is projected: FALSE
> proj4string :
> [+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0]
> Number of points: 2
> Grid attributes:
>   cellcentre.offset cellsize cells.dim
> x           -179.10      1.8       200
> y            -89.55      0.9       200
> Data attributes:
>      Min.   1st Qu.    Median      Mean   3rd Qu.      Max.      NA's
>     0.000     0.000     0.000    47.010     3.264 13540.000 26563.000
>
> I would like to write a code that extracts the value of associated
> cell given a specific location in latitude and longitude. I've noticed
> that xxx at data contains the values as 40000 x 1 matrix. I've wrote the
> following code assuming that the values are stored as in C programing
> (column wise seperation):
>
>
> #initiate values
> x_inc=xxx at grid@cellsize[1]
> y_inc=xxx at grid@cellsize[2]
>
> x_start=xxx at grid@cellcentre.offset[1]
> y_start=xxx at grid@cellcentre.offset[2]
>
> x_dim=xxx at grid@cells.dim[1]
> y_dim=xxx at grid@cells.dim[2]
>
> #given coordinate
> x=26
> y=45
>
> #find the index
> index=floor((x-x_start)/x_inc)*y_dim + floor( (y-y_start)/y_inc )
> xxx at data[index,1]
>
> The result does not seem to match what I should get. Could anybody
> explain to me how the data is stored in SpatialGridDataFrame? Your
> help would be much much appreciated.
>
> Thank you and have a good night
> Harry
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de/
http://www.springer.com/978-0-387-78170-9 e.pebesma at wwu.de



From Mikael.Carlsson at sgu.se  Mon Nov  3 23:54:02 2008
From: Mikael.Carlsson at sgu.se (Mikael Carlsson)
Date: Mon, 3 Nov 2008 23:54:02 +0100
Subject: [R-sig-Geo] Memory issue
Message-ID: <OFE5AD0B15.1A2880F4-ONC12574F6.007DCC3D-C12574F6.007DCC40@sgu.se>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081103/a1cd4ea2/attachment.html>

From Thierry.ONKELINX at inbo.be  Tue Nov  4 09:35:40 2008
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Tue, 4 Nov 2008 09:35:40 +0100
Subject: [R-sig-Geo] Memory issue
In-Reply-To: <OFE5AD0B15.1A2880F4-ONC12574F6.007DCC3D-C12574F6.007DCC40@sgu.se>
References: <OFE5AD0B15.1A2880F4-ONC12574F6.007DCC3D-C12574F6.007DCC40@sgu.se>
Message-ID: <2E9C414912813E4EB981326983E0A10405B7A0D9@inboexch.inbo.be>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081104/3d15236f/attachment.pl>

From Roger.Bivand at nhh.no  Tue Nov  4 09:49:32 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 4 Nov 2008 09:49:32 +0100 (CET)
Subject: [R-sig-Geo] Memory issue
In-Reply-To: <OFE5AD0B15.1A2880F4-ONC12574F6.007DCC3D-C12574F6.007DCC40@sgu.se>
References: <OFE5AD0B15.1A2880F4-ONC12574F6.007DCC3D-C12574F6.007DCC40@sgu.se>
Message-ID: <Pine.LNX.4.64.0811040940300.15982@reclus.nhh.no>

On Mon, 3 Nov 2008, Mikael Carlsson wrote:

> 
> Hi,
> 
> ?
> 
> First, thanks for all help so far...but I still have some problems.
> Here is the code:
> cumark <- read.table("k:/test/helamarkcu.txt", header=T, sep = ";")

One copy of 3*40K*8 = 1MB

> 
> memory.limit(size = 1897)???
> attach(cumark)
> vew <- as.vector(ew)
> vns <- as.vector(ns)
> vcu <- as.vector(cu)

A second copy

> 
> fcumark <- data.frame(vew, vns, vcu)
>

A third copy (but still of 1MB)

> coordinates(fcumark) <- ~vew+vns?
> 
> L1 <-round((max(vew)- min(vew))/100,0)
> L2 <-round((max(vns)- min(vns))/100,0)
>

So this is a 100m grid? What are L1 and L2? Why not use GridTopology to 
compute this? How many grid cells are you using?

> 
> fcumark.interp.old <- interp.old(vew, vns, vcu,
> ??????????????? xo= seq(min(vew), max(vew), length = L1),
> ??????????????? yo= seq(min(vns), max(vns), length = L2),
> ??????????????? ncp = 0,?
> ??????????????? extrap= FALSE,
> ??????????????? duplicate = "mean",
> ??????????????? dupfun = NULL)
> Then I get this;
> Error: cannot allocate vector of size 351.8 Mb
> 
> When I tested with a smaller file (~2000 rows) I come to the end without
> problems.

With the same L1, L2 (possibly not)? They must be the main problem, no? As 
suggested, you could tile the interpolations and merge them afterwards. 
The main thing is the size of L1*L2.

> 
> Rest of the code..
> 
> fcumark.interp.old.grid <-
> as.SpatialGridDataFrame.im(as.im(fcumark.interp.old))

Lots more copying

> 
> ##? spplot(fcumark.interp.old.grid, col.regions=bpy.colors(),
> sp.layout=list("sp.points", pch="+", fcumark))
> 
> slot(slot(fcumark.interp.old.grid, "grid"), "cellsize") <-
> rep(mean(slot(slot(fcumark.interp.old.grid,
> ?? "grid"), "cellsize")), 2)
>

Messy - use a Grid Topology as input.

Roger

> write.asciigrid(fcumark.interp.old.grid[1], "k:/test/helamarkcu.asc",
> na.value = -9999)
> ## End run
>
> helamarkcu.txt is a plain ascii file, looks like...
> ew;ns;cu
> 1344628;6138662;24.0
> 1340104;6138880;17.0
> 1342246;6138946;21.0
> 1347259;6140911;19.0
> 1339968;6140932;15.0
> 1349906;6140987;21.0
> ...
> ..
> .
> (38155 rows)
> Have anybody a solution? Writing result from interp.old direct to
> disk/file on the "fly"?
> 
> Running R 2.7.2?and WinXP
> 
> Regards,
> Mikael
> 
> 
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From e.j.tommo at gmail.com  Tue Nov  4 22:00:15 2008
From: e.j.tommo at gmail.com (Edward Tomlinson)
Date: Wed, 5 Nov 2008 08:00:15 +1100
Subject: [R-sig-Geo] classIntervals function not finishing
Message-ID: <285eec980811041300n2d0871c3p247292324db6fb0d@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081105/7b8e6798/attachment.pl>

From p.hiemstra at geo.uu.nl  Tue Nov  4 23:18:49 2008
From: p.hiemstra at geo.uu.nl (Paul Hiemstra)
Date: Tue, 04 Nov 2008 23:18:49 +0100
Subject: [R-sig-Geo] classIntervals function not finishing
In-Reply-To: <285eec980811041300n2d0871c3p247292324db6fb0d@mail.gmail.com>
References: <285eec980811041300n2d0871c3p247292324db6fb0d@mail.gmail.com>
Message-ID: <4910CA49.90501@geo.uu.nl>

Hi,

My experience with the fisher method of calculating intervals is that it 
becomes very slow if applied to a larger dataset. Your dataset is much 
much larger than what I have tried to do with style="fisher". So it is 
not strange what you are seeing. You could select a subset of the data 
to make the process somewhat faster, but "fisher" takes a lot of time.

cheers,
Paul

Edward Tomlinson schreef:
> Hi List,
>
> I am having trouble with the classIntervals function. Something seems to be
> going wrong as the function is not returning (in 8hr +).
>
> i am trying to call the function as follows
>
> t1 <- classIntervals(map$map.mapset, n=7, style="fisher")
>
> there are about 2.3 million cells in the image.
>
> The cpu goes to 100% cycle and the function never returns.
>
> I have tried the function with other styles "pretty" and "kmeans" and it
> returns fine.
>
> Is there a way i can verbose output from the function to see if i have done
> something wrong?
>
> THanks,
> Ed
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   


-- 
Drs. Paul Hiemstra
Department of Physical Geography
Faculty of Geosciences
University of Utrecht
Heidelberglaan 2
P.O. Box 80.115
3508 TC Utrecht
Phone:     +31302535773
Fax:    +31302531145
http://intamap.geo.uu.nl/~paul



From alessandro.montaghi at unifi.it  Wed Nov  5 00:52:20 2008
From: alessandro.montaghi at unifi.it (Alessandro)
Date: Tue, 4 Nov 2008 15:52:20 -0800
Subject: [R-sig-Geo] merge 2 txt file
Message-ID: <003401c93ed8$61a3c2b0$24eb4810$@montaghi@unifi.it>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081104/11b51aba/attachment.pl>

From tech_dev at wildintellect.com  Wed Nov  5 03:01:30 2008
From: tech_dev at wildintellect.com (Alex Mandel)
Date: Tue, 04 Nov 2008 18:01:30 -0800
Subject: [R-sig-Geo] merge 2 txt file
In-Reply-To: <003401c93ed8$61a3c2b0$24eb4810$@montaghi@unifi.it>
References: <003401c93ed8$61a3c2b0$24eb4810$@montaghi@unifi.it>
Message-ID: <4910FE7A.1000608@wildintellect.com>

Alessandro wrote:
> Hi all,
> 
>  
> 
> I have two txt file with X,Y,Z column and I need to merge together
> 
>  
> 
> I tried 
> 
> file_all <- merge("file1.txt","file2.txt")
> 
> but I don't sure about the result. Is It this code correct?
> 
> Thanks Ale 
> 
> 

That would merge 2 data frames together. If you want to merge files in R
you need to import the files 1st then merge them.
Something like:

one <- read.csv("file1.txt",sep=",",header=TRUE)
two <- read.csv("file2.txt",sep=",",header=TRUE)
both <- merge(one,two)
write.table(both, file="both.txt"))

See
http://stat.ethz.ch/R-manual/R-patched/library/utils/html/read.table.html
and
http://stat.ethz.ch/R-manual/R-patched/library/utils/html/write.table.html


Alternately there are lots of other ways to do this outside of R
especially if you're on Mac or Linux, like cat.

Alex



From corey.sparks at UTSA.EDU  Wed Nov  5 14:34:30 2008
From: corey.sparks at UTSA.EDU (Corey Sparks)
Date: Wed, 5 Nov 2008 07:34:30 -0600
Subject: [R-sig-Geo] classIntervals function not finishing
Message-ID: <5D0523A1-00DA-49C1-8043-CD6F42BEAE18@utsa.edu>

I too have seen the style="fisher" method take a long time, e.g.  
~30min for only ~3000 polygons.
Corey

Corey Sparks
Assistant Professor
Department of Demography and Organization Studies
College of Public Policy
One UTSA Circle
San Antonio, TX 78239
corey.sparks at utsa.edu



From greenberg at ucdavis.edu  Wed Nov  5 18:18:47 2008
From: greenberg at ucdavis.edu (Jonathan Greenberg)
Date: Wed, 05 Nov 2008 09:18:47 -0800
Subject: [R-sig-Geo] Using RGDAL to "copy" header information...
Message-ID: <4911D577.2050300@ucdavis.edu>

R-geographers...

I'm trying to solve a problem to implement a line-by-line tiled 
processing using RGDAL (read 1 line of an image, process the one line, 
write one line of the image to a binary file).  Everything except for 
the final step I'm able to do using a combination of RGDAL and r-base 
commands.  Below is the basic structure, the input file "elev" can be 
any image file GDAL supports -- the code below just "copies" the image 
one line at a time:

###

library(rgdal)
infile='elev'
outfile_base='testout'
outfile_ext='.bil'
outfile=paste(outfile_base,outfile_ext,sep='')
outcon <- file(outfile, "wb")

infile_info=GDALinfo(infile)
nl=infile_info[[1]]
ns=infile_info[[2]]

for (row in 1:nl) {
    templine <- readGDAL(infile,region.dim=c(1,ns),offset=c(row-1,0))
    writeBin(templine[[1]], outcon,size=4)
}
close(outcon)
# Below doesn't work
# writeGDAL(templine,outfile_base,drivername='EHdr',type="Float32")

###

The issue is this: I need to be able to effectively copy the 
geographic/header information from the input file (the last line almost 
works, but as you can see it sets the line #s to 1, not "ns"), and parse 
it over to the output file (which is some form of a flat binary file -- 
in this case, an Arc Binary Raster, but an ENVI binary output would also 
be good) -- ideally I'd like to be able to modify this header, 
particularly the number type (e.g. if the input file is an integer, and 
I'm writing out a floating point binary, I need that reflected in the 
output header).  I can do this by *manually* creating the output header 
via a series of ascii-writes, but I was wondering if there is a more 
effective way of doing this using RGDAL that might apply generically to 
the header of any binary image file I might write?  Thanks!

--j


-- 

Jonathan A. Greenberg, PhD
Postdoctoral Scholar
Center for Spatial Technologies and Remote Sensing (CSTARS)
University of California, Davis
One Shields Avenue
The Barn, Room 250N
Davis, CA 95616
Cell: 415-794-5043
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307



From ashton at msu.edu  Wed Nov  5 19:14:34 2008
From: ashton at msu.edu (Ashton Shortridge)
Date: Wed, 5 Nov 2008 14:14:34 -0400
Subject: [R-sig-Geo] merge 2 txt file
In-Reply-To: <003401c93ed8$61a3c2b0$24eb4810$@montaghi@unifi.it>
References: <003401c93ed8$61a3c2b0$24eb4810$@montaghi@unifi.it>
Message-ID: <200811051314.35021.ashton@msu.edu>

Hi Ale,

When you say merge, do you mean you want to append one onto the other, or you 
really want to merge elements that have common x and y values?

If it's the first case, then I'd probably read both in with read.table() and 
then rbind them:
dat1 <- read.table("file1.txt")
dat2 <- read.table("file2.txt")
dat3 <- rbind(dat1,dat2)

If it's the second, I can't help much. Did you try it? Did that work? If you 
can't tell (if, say, the text files are really big) then make two small test 
files and try that.

Ashton

On Tuesday 04 November 2008 06:52:20 pm Alessandro wrote:
> Hi all,
>
>
>
> I have two txt file with X,Y,Z column and I need to merge together
>
>
>
> I tried
>
> file_all <- merge("file1.txt","file2.txt")
>
> but I don't sure about the result. Is It this code correct?
>
> Thanks Ale
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Ashton Shortridge
Associate Professor			ashton at msu.edu
Dept of Geography			http://www.msu.edu/~ashton
235 Geography Building		ph (517) 432-3561
Michigan State University		fx (517) 432-1671



From Roger.Bivand at nhh.no  Thu Nov  6 09:10:29 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 6 Nov 2008 09:10:29 +0100 (CET)
Subject: [R-sig-Geo] Using RGDAL to "copy" header information...
In-Reply-To: <4911D577.2050300@ucdavis.edu>
References: <4911D577.2050300@ucdavis.edu>
Message-ID: <Pine.LNX.4.64.0811060855420.8340@reclus.nhh.no>

On Wed, 5 Nov 2008, Jonathan Greenberg wrote:

> R-geographers...
>
> I'm trying to solve a problem to implement a line-by-line tiled processing 
> using RGDAL (read 1 line of an image, process the one line, write one line of 
> the image to a binary file).  Everything except for the final step I'm able 
> to do using a combination of RGDAL and r-base commands.  Below is the basic 
> structure, the input file "elev" can be any image file GDAL supports -- the 
> code below just "copies" the image one line at a time:
>
> ###
>
> library(rgdal)
> infile='elev'
> outfile_base='testout'
> outfile_ext='.bil'
> outfile=paste(outfile_base,outfile_ext,sep='')
> outcon <- file(outfile, "wb")
>
> infile_info=GDALinfo(infile)
> nl=infile_info[[1]]
> ns=infile_info[[2]]
>
> for (row in 1:nl) {
>    templine <- readGDAL(infile,region.dim=c(1,ns),offset=c(row-1,0))
>    writeBin(templine[[1]], outcon,size=4)
> }
> close(outcon)
> #  Below doesn't work
> #  writeGDAL(templine,outfile_base,drivername='EHdr',type="Float32")
>
> ###
>
> The issue is this: I need to be able to effectively copy the 
> geographic/header information from the input file (the last line almost 
> works, but as you can see it sets the line #s to 1, not "ns"), and parse it 
> over to the output file (which is some form of a flat binary file -- in this 
> case, an Arc Binary Raster, but an ENVI binary output would also be good) -- 
> ideally I'd like to be able to modify this header, particularly the number 
> type (e.g. if the input file is an integer, and I'm writing out a floating 
> point binary, I need that reflected in the output header).  I can do this by 
> *manually* creating the output header via a series of ascii-writes, but I was 
> wondering if there is a more effective way of doing this using RGDAL that 
> might apply generically to the header of any binary image file I might write? 
> Thanks!

It is the internals of writeGDAL() and create2GDAL() without the bands:

data(meuse.grid)
gridded(meuse.grid) <- ~x+y

d.drv <- new("GDALDriver", "EHdr")

gp <- gridparameters(meuse.grid)
cellsize <- gp$cellsize
offset <- gp$cellcentre.offset
dims <- gp$cells.dim

nbands <- 1
tds.out <- new("GDALTransientDataset", driver = d.drv, rows = dims[2],
   cols = dims[1], bands = nbands, type = "Float32")

gt <- c(offset[1] - 0.5 * cellsize[1], cellsize[1], 0.0,
   offset[2] + (dims[2] -0.5) * cellsize[2], 0.0, -cellsize[2])
.Call("RGDAL_SetGeoTransform", tds.out, gt, PACKAGE = "rgdal")

list.files(tempdir())

fn <- tempfile()

saveDataset(tds.out, fn)

list.files(tempdir())

GDAL.close(tds.out)

list.files(tempdir())

However, the driver does commit the data file too, so you'd need to run 
the above code to produce the header so as not to overwrite your output 
data. The key thing is to get the input grid parameters right, but you've 
got them anyway. If you want the projection information out too, look in 
create2GDAL for the .Call() you need. Note that passing unchecked 
variables through .Call may crash your session - going through 
GridTopology should make sure that they are stored correctly.

Hope this helps,

Roger


>
> --j
>
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From r.hijmans at gmail.com  Thu Nov  6 14:53:03 2008
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Thu, 6 Nov 2008 21:53:03 +0800
Subject: [R-sig-Geo] Using RGDAL to "copy" header information... (Jonathan
	Greenberg)
Message-ID: <dc22b2570811060553q6797a9bfq85cd0abcd405b29b@mail.gmail.com>

Jonathan

You might be interested in the raster package available from r-forge
(within the Rgis project). You would need to download, build and
install it 'manually'

The below code example reads a line from an input raster, puts the values

library(raster)
infile="d:/input.tif"
outfile="d:/test.grd"
rin <- raster.from.file(infile)
rout <- set.raster(rin, outfile)

for (r in 1:nrow(rin)) {
  rin <- read.row(rin, r)

  rout <- set.values.row(rout, values(rin) + 10, r)
  rout <- write.row(rout)
}



outfile_ext='.bil'
> outfile=paste(outfile_base,outfile_ext,sep='')
> outcon <- file(outfile, "wb")



>
> Message: 2
> Date: Wed, 05 Nov 2008 09:18:47 -0800
> From: Jonathan Greenberg <greenberg at ucdavis.edu>
> Subject: [R-sig-Geo] Using RGDAL to "copy" header information...
> To: gdal-dev at lists.osgeo.org, R-sig-Geo at stat.math.ethz.ch,
>        r-help at r-project.org
> Cc: Solomon Dobrowski <solomon.dobrowski at cfc.umt.edu>
> Message-ID: <4911D577.2050300 at ucdavis.edu>
> Content-Type: text/plain; charset=ISO-8859-1; format=flowed
>
> R-geographers...
>
> I'm trying to solve a problem to implement a line-by-line tiled
> processing using RGDAL (read 1 line of an image, process the one line,
> write one line of the image to a binary file).  Everything except for
> the final step I'm able to do using a combination of RGDAL and r-base
> commands.  Below is the basic structure, the input file "elev" can be
> any image file GDAL supports -- the code below just "copies" the image
> one line at a time:
>
> ###
>
> library(rgdal)
> infile='elev'
> outfile_base='testout'
> outfile_ext='.bil'
> outfile=paste(outfile_base,outfile_ext,sep='')
> outcon <- file(outfile, "wb")
>
> infile_info=GDALinfo(infile)
> nl=infile_info[[1]]
> ns=infile_info[[2]]
>
> for (row in 1:nl) {
>    templine <- readGDAL(infile,region.dim=c(1,ns),offset=c(row-1,0))
>    writeBin(templine[[1]], outcon,size=4)
> }
> close(outcon)
> # Below doesn't work
> # writeGDAL(templine,outfile_base,drivername='EHdr',type="Float32")
>
> ###
>
> The issue is this: I need to be able to effectively copy the
> geographic/header information from the input file (the last line almost
> works, but as you can see it sets the line #s to 1, not "ns"), and parse
> it over to the output file (which is some form of a flat binary file --
> in this case, an Arc Binary Raster, but an ENVI binary output would also
> be good) -- ideally I'd like to be able to modify this header,
> particularly the number type (e.g. if the input file is an integer, and
> I'm writing out a floating point binary, I need that reflected in the
> output header).  I can do this by *manually* creating the output header
> via a series of ascii-writes, but I was wondering if there is a more
> effective way of doing this using RGDAL that might apply generically to
> the header of any binary image file I might write?  Thanks!
>
> --j
>
>
> --
>
> Jonathan A. Greenberg, PhD
> Postdoctoral Scholar
> Center for Spatial Technologies and Remote Sensing (CSTARS)
> University of California, Davis
> One Shields Avenue
> The Barn, Room 250N
> Davis, CA 95616
> Cell: 415-794-5043
> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307
>
>
>



From r.hijmans at gmail.com  Thu Nov  6 14:56:30 2008
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Thu, 6 Nov 2008 21:56:30 +0800
Subject: [R-sig-Geo] Using RGDAL to "copy" header information...
	(Jonathan Greenberg)
In-Reply-To: <dc22b2570811060553q6797a9bfq85cd0abcd405b29b@mail.gmail.com>
References: <dc22b2570811060553q6797a9bfq85cd0abcd405b29b@mail.gmail.com>
Message-ID: <dc22b2570811060556h55a1b915ic15167a17e1766d9@mail.gmail.com>

Sorry, I hit the send button unintentionally

Next try:

> Jonathan
>
> You might be interested in the raster package available from r-forge
> (within the Rgis project). You would need to dwnload, build and
> install it 'manually'
>
> The below code example reads a line from an input raster, puts the values
>
> library(raster)
> infile="d:/input.tif"
> outfile="d:/test.grd"
> rin <- raster.from.file(infile)
> rout <- set.raster(rin, outfile)
>
> for (r in 1:nrow(rin)) {
>  rin <- read.row(rin, r)
>
>  rout <- set.values.row(rout, values(rin) + 10, r)
>  rout <- write.row(rout)
> }
>

The output file is a binary file with a text (ini type) header. It is
fairly trivial to write other, more standard, hdr files, and I will
add that over the coming weeks.
If you do not want to build the package, just have a look at the
raster.write.R file in the code repository. You will able to see how
we do it.

Robert

>
>
>
>
>>
>> Message: 2
>> Date: Wed, 05 Nov 2008 09:18:47 -0800
>> From: Jonathan Greenberg <greenberg at ucdavis.edu>
>> Subject: [R-sig-Geo] Using RGDAL to "copy" header information...
>> To: gdal-dev at lists.osgeo.org, R-sig-Geo at stat.math.ethz.ch,
>>        r-help at r-project.org
>> Cc: Solomon Dobrowski <solomon.dobrowski at cfc.umt.edu>
>> Message-ID: <4911D577.2050300 at ucdavis.edu>
>> Content-Type: text/plain; charset=ISO-8859-1; format=flowed
>>
>> R-geographers...
>>
>> I'm trying to solve a problem to implement a line-by-line tiled
>> processing using RGDAL (read 1 line of an image, process the one line,
>> write one line of the image to a binary file).  Everything except for
>> the final step I'm able to do using a combination of RGDAL and r-base
>> commands.  Below is the basic structure, the input file "elev" can be
>> any image file GDAL supports -- the code below just "copies" the image
>> one line at a time:
>>
>> ###
>>
>> library(rgdal)
>> infile='elev'
>> outfile_base='testout'
>> outfile_ext='.bil'
>> outfile=paste(outfile_base,outfile_ext,sep='')
>> outcon <- file(outfile, "wb")
>>
>> infile_info=GDALinfo(infile)
>> nl=infile_info[[1]]
>> ns=infile_info[[2]]
>>
>> for (row in 1:nl) {
>>    templine <- readGDAL(infile,region.dim=c(1,ns),offset=c(row-1,0))
>>    writeBin(templine[[1]], outcon,size=4)
>> }
>> close(outcon)
>> # Below doesn't work
>> # writeGDAL(templine,outfile_base,drivername='EHdr',type="Float32")
>>
>> ###
>>
>> The issue is this: I need to be able to effectively copy the
>> geographic/header information from the input file (the last line almost
>> works, but as you can see it sets the line #s to 1, not "ns"), and parse
>> it over to the output file (which is some form of a flat binary file --
>> in this case, an Arc Binary Raster, but an ENVI binary output would also
>> be good) -- ideally I'd like to be able to modify this header,
>> particularly the number type (e.g. if the input file is an integer, and
>> I'm writing out a floating point binary, I need that reflected in the
>> output header).  I can do this by *manually* creating the output header
>> via a series of ascii-writes, but I was wondering if there is a more
>> effective way of doing this using RGDAL that might apply generically to
>> the header of any binary image file I might write?  Thanks!
>>
>> --j
>>
>>
>> --
>>
>> Jonathan A. Greenberg, PhD
>> Postdoctoral Scholar
>> Center for Spatial Technologies and Remote Sensing (CSTARS)
>> University of California, Davis
>> One Shields Avenue
>> The Barn, Room 250N
>> Davis, CA 95616
>> Cell: 415-794-5043
>> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307
>>
>>
>>
>



From Andrew.McFadden at maf.govt.nz  Fri Nov  7 00:12:26 2008
From: Andrew.McFadden at maf.govt.nz (Andrew McFadden)
Date: Fri, 7 Nov 2008 12:12:26 +1300
Subject: [R-sig-Geo] How to put a network diagram onto a map
Message-ID: <819062A97D2DF1468F1E1117A699282702028EAC@wdcwmsp58.network.maf.govt.nz>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081107/a970898b/attachment.pl>

From adam.okulicz.kozaryn at gmail.com  Fri Nov  7 00:43:15 2008
From: adam.okulicz.kozaryn at gmail.com (Adam Okulicz-Kozaryn)
Date: Thu, 6 Nov 2008 18:43:15 -0500
Subject: [R-sig-Geo] shared boundary weight matrix
Message-ID: <3c75698d0811061543i3d0b9270u1c242898341ff545@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081106/4d5f5212/attachment.pl>

From adrian at maths.uwa.edu.au  Fri Nov  7 08:16:39 2008
From: adrian at maths.uwa.edu.au (Adrian Baddeley)
Date: Fri, 07 Nov 2008 16:16:39 +0900
Subject: [R-sig-Geo] spatial point patterns - Notes
Message-ID: <4913EB57.1050302@maths.uwa.edu.au>

Hi all

The tutorial/workshop on
     'Analysing spatial point patterns in R'
available at
    <www.csiro.au/resources/pf16h.html>
has now been revised, rewritten and updated for the
current version of spatstat.

Adrian Baddeley



From alessandro.montaghi at unifi.it  Fri Nov  7 21:03:00 2008
From: alessandro.montaghi at unifi.it (Alessandro)
Date: Fri, 7 Nov 2008 12:03:00 -0800
Subject: [R-sig-Geo] R:  merge 2 txt file (PROBLEM OF MEMORY)
In-Reply-To: <200811051314.35021.ashton@msu.edu>
References: <003401c93ed8$61a3c2b0$24eb4810$@montaghi@unifi.it>
	<200811051314.35021.ashton@msu.edu>
Message-ID: <000301c94113$d7773e30$8665ba90$@montaghi@unifi.it>

Hi I 

The problem is this: when i merge ground1 and ground2 in one txt file
(ground) I lost many rows

EX: file ground1.txt, ground2.txt
Format file: X,Y,Z with header row and sep="," 

******************************

> ground1 <- read.delim("ground_Filtered_268000_4149000.txt",
sep=",",header=TRUE)
> ground2 <- read.delim("ground_Filtered_269000_4149000.txt",
sep=",",header=TRUE)
> summary(ground1)
       X                Y                 Z       
 Min.   :267980   Min.   :4148980   Min.   :1399  
 1st Qu.:268256   1st Qu.:4149238   1st Qu.:1505  
 Median :268528   Median :4149490   Median :1587  
 Mean   :268515   Mean   :4149491   Mean   :1595  
 3rd Qu.:268777   3rd Qu.:4149743   3rd Qu.:1683  
 Max.   :269020   Max.   :4150020   Max.   :1823  
> summary(ground2)
       X                Y                 Z       
 Min.   :268980   Min.   :4148980   Min.   :1628  
 1st Qu.:269265   1st Qu.:4149268   1st Qu.:1720  
 Median :269512   Median :4149543   Median :1753  
 Mean   :269509   Mean   :4149521   Mean   :1753  
 3rd Qu.:269753   3rd Qu.:4149768   3rd Qu.:1788  
 Max.   :270020   Max.   :4150020   Max.   :1903  
> str(ground1)
'data.frame':   2356617 obs. of  3 variables:
 $ X: num  268000 268000 268001 268002 268002 ...
 $ Y: num  4149984 4149982 4149983 4149983 4149983 ...
 $ Z: num  1543 1543 1543 1543 1543 ...
> str(ground2)
'data.frame':   3235340 obs. of  3 variables:
 $ X: num  270000 269999 269999 270000 270000 ...
 $ Y: num  4149873 4149873 4149873 4149874 4149876 ...
 $ Z: num  1744 1745 1744 1744 1744 ...
> ground <- merge(ground1,ground2)
> str(ground)
'data.frame':   89819 obs. of  3 variables:
 $ X: num  268980 268980 268980 268980 268980 ...
 $ Y: num  4148981 4149013 4149090 4149097 4149110 ...
 $ Z: num  1628 1640 1668 1670 1673 ...
>

THE result is: ground1 (=2356617) ground2 (=3235340) But the ground is only
89819

I think there is a problem of memory

Ale





-----Messaggio originale-----
Da: Ashton Shortridge [mailto:ashton at msu.edu] 
Inviato: mercoled? 5 novembre 2008 10.15
A: r-sig-geo at stat.math.ethz.ch; Alessandro
Oggetto: Re: [R-sig-Geo] merge 2 txt file

Hi Ale,

When you say merge, do you mean you want to append one onto the other, or
you 
really want to merge elements that have common x and y values?

If it's the first case, then I'd probably read both in with read.table() and

then rbind them:
dat1 <- read.table("file1.txt")
dat2 <- read.table("file2.txt")
dat3 <- rbind(dat1,dat2)

If it's the second, I can't help much. Did you try it? Did that work? If you

can't tell (if, say, the text files are really big) then make two small test

files and try that.

Ashton

On Tuesday 04 November 2008 06:52:20 pm Alessandro wrote:
> Hi all,
>
>
>
> I have two txt file with X,Y,Z column and I need to merge together
>
>
>
> I tried
>
> file_all <- merge("file1.txt","file2.txt")
>
> but I don't sure about the result. Is It this code correct?
>
> Thanks Ale
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Ashton Shortridge
Associate Professor			ashton at msu.edu
Dept of Geography			http://www.msu.edu/~ashton
235 Geography Building		ph (517) 432-3561
Michigan State University		fx (517) 432-1671



From Roger.Bivand at nhh.no  Fri Nov  7 22:17:04 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 7 Nov 2008 22:17:04 +0100 (CET)
Subject: [R-sig-Geo] R:  merge 2 txt file (PROBLEM OF MEMORY)
In-Reply-To: <000301c94113$d7773e30$8665ba90$@montaghi@unifi.it>
References: <003401c93ed8$61a3c2b0$24eb4810$@montaghi@unifi.it>
	<200811051314.35021.ashton@msu.edu>
	<000301c94113$d7773e30$8665ba90$@montaghi@unifi.it>
Message-ID: <Pine.LNX.4.64.0811072209390.14255@reclus.nhh.no>

On Fri, 7 Nov 2008, Alessandro wrote:

> Hi I
>
> The problem is this: when i merge ground1 and ground2 in one txt file
> (ground) I lost many rows
>
> EX: file ground1.txt, ground2.txt
> Format file: X,Y,Z with header row and sep=","
>
> ******************************
>
>> ground1 <- read.delim("ground_Filtered_268000_4149000.txt",
> sep=",",header=TRUE)
>> ground2 <- read.delim("ground_Filtered_269000_4149000.txt",
> sep=",",header=TRUE)
>> summary(ground1)
>       X                Y                 Z
> Min.   :267980   Min.   :4148980   Min.   :1399
> 1st Qu.:268256   1st Qu.:4149238   1st Qu.:1505
> Median :268528   Median :4149490   Median :1587
> Mean   :268515   Mean   :4149491   Mean   :1595
> 3rd Qu.:268777   3rd Qu.:4149743   3rd Qu.:1683
> Max.   :269020   Max.   :4150020   Max.   :1823
>> summary(ground2)
>       X                Y                 Z
> Min.   :268980   Min.   :4148980   Min.   :1628
> 1st Qu.:269265   1st Qu.:4149268   1st Qu.:1720
> Median :269512   Median :4149543   Median :1753
> Mean   :269509   Mean   :4149521   Mean   :1753
> 3rd Qu.:269753   3rd Qu.:4149768   3rd Qu.:1788
> Max.   :270020   Max.   :4150020   Max.   :1903
>> str(ground1)
> 'data.frame':   2356617 obs. of  3 variables:
> $ X: num  268000 268000 268001 268002 268002 ...
> $ Y: num  4149984 4149982 4149983 4149983 4149983 ...
> $ Z: num  1543 1543 1543 1543 1543 ...
>> str(ground2)
> 'data.frame':   3235340 obs. of  3 variables:
> $ X: num  270000 269999 269999 270000 270000 ...
> $ Y: num  4149873 4149873 4149873 4149874 4149876 ...
> $ Z: num  1744 1745 1744 1744 1744 ...
>> ground <- merge(ground1,ground2)
>> str(ground)
> 'data.frame':   89819 obs. of  3 variables:
> $ X: num  268980 268980 268980 268980 268980 ...
> $ Y: num  4148981 4149013 4149090 4149097 4149110 ...
> $ Z: num  1628 1640 1668 1670 1673 ...
>>
>
> THE result is: ground1 (=2356617) ground2 (=3235340) But the ground is only
> 89819
>
> I think there is a problem of memory

No, an evident problerm of not reading and understanding the documentation 
of merge. You have to try it out on small data sets first to understand 
how it works, not because of memory problems, but because they run faster. 
Once you know how to tell merge() what you want to do, it will do it, but 
it cannot guess, and you are not telling it. You have a habit of 
"thinking" too much, and this isn't helping you make progress.

I'm not even sure that you don't mean rbind(), as Ashton pointed out. Try 
to draw a workflow on a sheet of paper, and try out the functions that 
might help one by one on a small data set, so small that you can inspect 
the two input objects and the output object visually. It'll be great when 
you have learned enough to offer advice to repay the efforts of this list 
to help you help yourself.

Have a nice weekend,

Roger

>
> Ale
>
>
>
>
>
> -----Messaggio originale-----
> Da: Ashton Shortridge [mailto:ashton at msu.edu]
> Inviato: mercoled? 5 novembre 2008 10.15
> A: r-sig-geo at stat.math.ethz.ch; Alessandro
> Oggetto: Re: [R-sig-Geo] merge 2 txt file
>
> Hi Ale,
>
> When you say merge, do you mean you want to append one onto the other, or
> you
> really want to merge elements that have common x and y values?
>
> If it's the first case, then I'd probably read both in with read.table() and
>
> then rbind them:
> dat1 <- read.table("file1.txt")
> dat2 <- read.table("file2.txt")
> dat3 <- rbind(dat1,dat2)
>
> If it's the second, I can't help much. Did you try it? Did that work? If you
>
> can't tell (if, say, the text files are really big) then make two small test
>
> files and try that.
>
> Ashton
>
> On Tuesday 04 November 2008 06:52:20 pm Alessandro wrote:
>> Hi all,
>>
>>
>>
>> I have two txt file with X,Y,Z column and I need to merge together
>>
>>
>>
>> I tried
>>
>> file_all <- merge("file1.txt","file2.txt")
>>
>> but I don't sure about the result. Is It this code correct?
>>
>> Thanks Ale
>>
>>
>> 	[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From mwdenslow at yahoo.com  Mon Nov 10 15:23:02 2008
From: mwdenslow at yahoo.com (Michael Denslow)
Date: Mon, 10 Nov 2008 06:23:02 -0800 (PST)
Subject: [R-sig-Geo] help with county map fill type
Message-ID: <36541.47362.qm@web33108.mail.mud.yahoo.com>


Dear List,

I am attempting to generate some county level species distribution maps for a publication. The idea is to show three different categories on one map; one for species A, one for species B and one for a county that has both.
Ideally I think some sort of hatching or pattern would be best. I am afraid that my grey scale example will not show up well in print.
In ?map, it says '... Extra arguments passed to polygon or lines'. However if I use the density or angle arguments, it doesn't work.
I am afraid that I am missing something obvious here, please help.

Thanks
Michael

library(maps)
data(stateMapEnv)

map('county', 'north carolina', 
	boundary = TRUE,
	lty = 1)

map('county', region = c('North Carolina,Watauga'), 
	fill = TRUE, col = 'grey80', add = TRUE)

map('county', region = c('North Carolina,Avery'), 
	fill = TRUE, col = 'grey50', add = TRUE)

map('county', region = c('North Carolina,Ashe'), 
	fill = TRUE, col = 'black', add = TRUE)

## try to use density and angle
map('county', region = c('North Carolina,Wilkes'), 
	density = 20,angle = 90, col = 'black', add = TRUE)


Michael Denslow

I.W. Carpenter Jr. Herbarium [BOON]
Appalachian State University
Boone, North Carolina U.S.A.

-- AND --

Communications Manager
Southeastern Regional Network of Expertise and Collections
sernec.org



From david.maxwell at cefas.co.uk  Mon Nov 10 16:15:02 2008
From: david.maxwell at cefas.co.uk (David Maxwell (Cefas))
Date: Mon, 10 Nov 2008 15:15:02 -0000
Subject: [R-sig-Geo] help with county map fill type
In-Reply-To: <36541.47362.qm@web33108.mail.mud.yahoo.com>
Message-ID: <8F90BAFE30CE2D458953FC0F1709830B5F88A8@LOWEXPRESS.corp.cefas.co.uk>

Michael
adding fill = TRUE  (so that polygon is used) works for me.
David

David Maxwell
Cefas	
Lowestoft Laboratory		
Suffolk				
NR33 OHT			   
UK
 
www.cefas.co.uk


-----Original Message-----
From: r-sig-geo-bounces at stat.math.ethz.ch
[mailto:r-sig-geo-bounces at stat.math.ethz.ch]On Behalf Of Michael Denslow
Sent: 10 November 2008 14:23
To: r-sig-geo at stat.math.ethz.ch
Subject: [R-sig-Geo] help with county map fill type



Dear List,

I am attempting to generate some county level species distribution maps for a publication. The idea is to show three different categories on one map; one for species A, one for species B and one for a county that has both.
Ideally I think some sort of hatching or pattern would be best. I am afraid that my grey scale example will not show up well in print.
In ?map, it says '... Extra arguments passed to polygon or lines'. However if I use the density or angle arguments, it doesn't work.
I am afraid that I am missing something obvious here, please help.

Thanks
Michael

library(maps)
data(stateMapEnv)

map('county', 'north carolina', 
	boundary = TRUE,
	lty = 1)

map('county', region = c('North Carolina,Watauga'), 
	fill = TRUE, col = 'grey80', add = TRUE)

map('county', region = c('North Carolina,Avery'), 
	fill = TRUE, col = 'grey50', add = TRUE)

map('county', region = c('North Carolina,Ashe'), 
	fill = TRUE, col = 'black', add = TRUE)

## try to use density and angle
map('county', region = c('North Carolina,Wilkes'), 
	density = 20,angle = 90, col = 'black', add = TRUE)


Michael Denslow

I.W. Carpenter Jr. Herbarium [BOON]
Appalachian State University
Boone, North Carolina U.S.A.

-- AND --

Communications Manager
Southeastern Regional Network of Expertise and Collections
sernec.org

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


***********************************************************************************
This email and any attachments are intended for the name...{{dropped:10}}



From saldanha.plangeo at gmail.com  Mon Nov 10 19:31:07 2008
From: saldanha.plangeo at gmail.com (Raphael Saldanha)
Date: Mon, 10 Nov 2008 16:31:07 -0200
Subject: [R-sig-Geo] Instrumental Varibles
Message-ID: <c85849370811101031q1ea34c96m3067b00958a0d514@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081110/bfab6153/attachment.pl>

From alessandro.montaghi at unifi.it  Mon Nov 10 20:57:35 2008
From: alessandro.montaghi at unifi.it (Alessandro)
Date: Mon, 10 Nov 2008 11:57:35 -0800
Subject: [R-sig-Geo] Improve memory in Windows Vista
Message-ID: <001801c9436e$9b4a9670$d1dfc350$@montaghi@unifi.it>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081110/d5f7e2fd/attachment.pl>

From p.hiemstra at geo.uu.nl  Mon Nov 10 21:52:00 2008
From: p.hiemstra at geo.uu.nl (Paul Hiemstra)
Date: Mon, 10 Nov 2008 21:52:00 +0100
Subject: [R-sig-Geo] Improve memory in Windows Vista
In-Reply-To: <001801c9436e$9b4a9670$d1dfc350$@montaghi@unifi.it>
References: <001801c9436e$9b4a9670$d1dfc350$@montaghi@unifi.it>
Message-ID: <49189EF0.9080808@geo.uu.nl>

Hi,

What platform are you using, 64 bit? What kind of dataset? What kind of 
operation do you want to perform on the data? Quite a lot has been said 
on memory usage in R on the "normal" R-help list. Googeling for "R-help 
memory limit" gives tons of information on memory issues. There is bound 
to be something there for you.

cheers,
Paul

Alessandro schreef:
> HI Users,
>
>  
>
> I must processing a large data set in R and I wish improve my PC memory. I
> have a Windows Vista with 4 Gb di RAM and Intel centrino 
>
>  
>
> In ordinary modality my memory is this
>
>   
>> memory.size(TRUE)
>>     
>
> [1] 13.4375
>
>   
>> memory.size()
>>     
>
> [1] 11.01423
>
>  
>
> If I use the command line "C:\program files\R\R-2.7.1\bin>Rgui.exe
> --max-mem-size=2048M"
>
>  
>
>   
>> memory.size(TRUE)
>>     
>
> [1] 13.4375
>
>   
>> memory.size()
>>     
>
> [1] 11.01418
>
>   
>> vegetation <- read.delim("vegetation_2674147_2684147.txt",
>>     
> sep=",",header=TRUE)
>
>   
>> coordinates(vegetation) =~X+Y
>>     
>
> Error: cannot allocate vector of size 232.5 Mb
>
>  
>
> Is there a solution of this limitation?
>
>  
>
> ale
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   


-- 
Drs. Paul Hiemstra
Department of Physical Geography
Faculty of Geosciences
University of Utrecht
Heidelberglaan 2
P.O. Box 80.115
3508 TC Utrecht
Phone:     +31302535773
Fax:    +31302531145
http://intamap.geo.uu.nl/~paul



From p.hiemstra at geo.uu.nl  Mon Nov 10 21:56:12 2008
From: p.hiemstra at geo.uu.nl (Paul Hiemstra)
Date: Mon, 10 Nov 2008 21:56:12 +0100
Subject: [R-sig-Geo] Instrumental Varibles
In-Reply-To: <c85849370811101031q1ea34c96m3067b00958a0d514@mail.gmail.com>
References: <c85849370811101031q1ea34c96m3067b00958a0d514@mail.gmail.com>
Message-ID: <49189FEC.6070002@geo.uu.nl>

Raphael Saldanha schreef:
> Hi!
>
> Is there any way to estimate model with instrumental variables in R?
>
> Regards,
>
> Raphael Saldanha
> saldanha.plangeo at gmail.com
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   
Try googeling "R instrumental variables" or "R-help instrumental 
variables". Also check out the CRAN taskviews. In the econometrics Task 
view:

"Instrumental variables regression (two-stage least squares) is provided 
by ivreg()  in AER, another implementation is tsls()  in package sem. "

cheers,
Paul


-- 
Drs. Paul Hiemstra
Department of Physical Geography
Faculty of Geosciences
University of Utrecht
Heidelberglaan 2
P.O. Box 80.115
3508 TC Utrecht
Phone:     +31302535773
Fax:    +31302531145
http://intamap.geo.uu.nl/~paul



From virginia at dpi.inpe.br  Tue Nov 11 14:06:29 2008
From: virginia at dpi.inpe.br (Virginia)
Date: Tue, 11 Nov 2008 11:06:29 -0200
Subject: [R-sig-Geo] using gwr
Message-ID: <49198355.6020808@dpi.inpe.br>

I have some questions:

I got an error. I dont't know why.

Somebody to help me?

Thanks,

   Virginia Ragoni

require(spgwr)
require(foreign)
x <- read.shape("cidade.shp")
plot(x)
mappolys <- Map2poly1(x,as.character(x$att.data$ID9100),raw=FALSE)

mapbbs=Map2bbs(x)
mapcents=get.Pcent(x)
tab= x$att.data

# c?lculo da largura da banda
sjc.bw <- gwr.sel((tab$TX_CRESC~tab$LOGDEN),data=tab,coords=mapcents)

# error -  Erro em spDistsN1(bbox, bbox[2, ], longlat) :
#  NA/NaN/Inf em chamada de fun??o externa (argumento 1)

sp.gauss  <- gwr((tab$PERIDOSO~tab$PERREN20),data=tab,coords=mapcents, 
bandwidth=sjc.bw, hatmatrix=TRUE)



From saldanha.plangeo at gmail.com  Tue Nov 11 14:19:46 2008
From: saldanha.plangeo at gmail.com (Raphael Saldanha)
Date: Tue, 11 Nov 2008 10:19:46 -0300
Subject: [R-sig-Geo] using gwr
In-Reply-To: <49198355.6020808@dpi.inpe.br>
References: <49198355.6020808@dpi.inpe.br>
Message-ID: <c85849370811110519u65a4a9c6u359f88e925b5423a@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081111/51dd23b3/attachment.pl>

From edzer.pebesma at uni-muenster.de  Tue Nov 11 14:47:47 2008
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 11 Nov 2008 14:47:47 +0100
Subject: [R-sig-Geo] using gwr
In-Reply-To: <c85849370811110519u65a4a9c6u359f88e925b5423a@mail.gmail.com>
References: <49198355.6020808@dpi.inpe.br>
	<c85849370811110519u65a4a9c6u359f88e925b5423a@mail.gmail.com>
Message-ID: <49198D03.8@uni-muenster.de>

It is no problem for us to read all this Brazilian (eh, sorry, 
Portugese), but it is hard to reproduce your error without having access 
to your, or similar, data.
--
Edzer

Raphael Saldanha wrote:
> Ol? Virg?nia!
>
> Legal ver brazileiros nessa lista! Vou dar uma olhada no seu problema e lhe
> escrevo.
>
> On Tue, Nov 11, 2008 at 10:06 AM, Virginia <virginia at dpi.inpe.br> wrote:
>
>   
>> I have some questions:
>>
>> I got an error. I dont't know why.
>>
>> Somebody to help me?
>>
>> Thanks,
>>
>>  Virginia Ragoni
>>
>> require(spgwr)
>> require(foreign)
>> x <- read.shape("cidade.shp")
>> plot(x)
>> mappolys <- Map2poly1(x,as.character(x$att.data$ID9100),raw=FALSE)
>>
>> mapbbs=Map2bbs(x)
>> mapcents=get.Pcent(x)
>> tab= x$att.data
>>
>> # c?lculo da largura da banda
>> sjc.bw <- gwr.sel((tab$TX_CRESC~tab$LOGDEN),data=tab,coords=mapcents)
>>
>> # error -  Erro em spDistsN1(bbox, bbox[2, ], longlat) :
>> #  NA/NaN/Inf em chamada de fun??o externa (argumento 1)
>>
>> sp.gauss  <- gwr((tab$PERIDOSO~tab$PERREN20),data=tab,coords=mapcents,
>> bandwidth=sjc.bw, hatmatrix=TRUE)
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>     
>
>
>
>   
> ------------------------------------------------------------------------
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de/
http://www.springer.com/978-0-387-78170-9 e.pebesma at wwu.de



From Roger.Bivand at nhh.no  Tue Nov 11 14:58:13 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 11 Nov 2008 14:58:13 +0100 (CET)
Subject: [R-sig-Geo] using gwr
In-Reply-To: <49198355.6020808@dpi.inpe.br>
References: <49198355.6020808@dpi.inpe.br>
Message-ID: <alpine.LRH.2.00.0811111451370.1043@reclus.nhh.no>

On Tue, 11 Nov 2008, Virginia wrote:

> I have some questions:
> I got an error. I dont't know why.
> Somebody to help me?

Your code template is not helpful. A more recent version below, which will 
probably show that your input data are in error:

>
> Thanks,
>
>  Virginia Ragoni
>
> require(spgwr)
> require(foreign)
> x <- read.shape("cidade.shp")
> plot(x)
> mappolys <- Map2poly1(x,as.character(x$att.data$ID9100),raw=FALSE)
>
> mapbbs=Map2bbs(x)
> mapcents=get.Pcent(x)
> tab= x$att.data
>
> # c?lculo da largura da banda
> sjc.bw <- gwr.sel((tab$TX_CRESC~tab$LOGDEN),data=tab,coords=mapcents)
>

library(maptools)
library(spgwr)
tab <- readShapeSpatial("cidade.shp")
# my guess is that there are non-finite centroids in the earlier version, 
# certainly the distance calculation is failing
sjc.bw <- gwr.sel(TX_CRESC ~ LOGDEN, data=tab)

> # error -  Erro em spDistsN1(bbox, bbox[2, ], longlat) :
> #  NA/NaN/Inf em chamada de fun??o externa (argumento 1)
>

Please always include the output of traceback() after an error, and of
sessionInfo() to show your platform and package versions.

Roger

> sp.gauss  <- gwr((tab$PERIDOSO~tab$PERREN20),data=tab,coords=mapcents, 
> bandwidth=sjc.bw, hatmatrix=TRUE)
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From yud at mail.montclair.edu  Tue Nov 11 15:11:30 2008
From: yud at mail.montclair.edu (Danlin Yu)
Date: Tue, 11 Nov 2008 09:11:30 -0500
Subject: [R-sig-Geo] using gwr
In-Reply-To: <49198D03.8@uni-muenster.de>
References: <49198355.6020808@dpi.inpe.br>
	<c85849370811110519u65a4a9c6u359f88e925b5423a@mail.gmail.com>
	<49198D03.8@uni-muenster.de>
Message-ID: <49199292.4080901@mail.montclair.edu>

I can't read this Brazilian (Portugese :)), but it seems that the 
distance calculation is in error (possibly some coordinates were missing 
causing distance calculation yield NA/NaN/Inf value), which leads to 
distance not being able to calculated.

Like Edzer mentioned, if a sample set of your data is provided, we might 
be able to track the source.

Hope this helps.

Best,
Danlin

Edzer Pebesma wrote:
> It is no problem for us to read all this Brazilian (eh, sorry, 
> Portugese), but it is hard to reproduce your error without having 
> access to your, or similar, data.
> -- 
> Edzer
>
> Raphael Saldanha wrote:
>> Ol? Virg?nia!
>>
>> Legal ver brazileiros nessa lista! Vou dar uma olhada no seu problema 
>> e lhe
>> escrevo.
>>
>> On Tue, Nov 11, 2008 at 10:06 AM, Virginia <virginia at dpi.inpe.br> wrote:
>>
>>  
>>> I have some questions:
>>>
>>> I got an error. I dont't know why.
>>>
>>> Somebody to help me?
>>>
>>> Thanks,
>>>
>>>  Virginia Ragoni
>>>
>>> require(spgwr)
>>> require(foreign)
>>> x <- read.shape("cidade.shp")
>>> plot(x)
>>> mappolys <- Map2poly1(x,as.character(x$att.data$ID9100),raw=FALSE)
>>>
>>> mapbbs=Map2bbs(x)
>>> mapcents=get.Pcent(x)
>>> tab= x$att.data
>>>
>>> # c?lculo da largura da banda
>>> sjc.bw <- gwr.sel((tab$TX_CRESC~tab$LOGDEN),data=tab,coords=mapcents)
>>>
>>> # error -  Erro em spDistsN1(bbox, bbox[2, ], longlat) :
>>> #  NA/NaN/Inf em chamada de fun??o externa (argumento 1)
>>>
>>> sp.gauss  <- gwr((tab$PERIDOSO~tab$PERREN20),data=tab,coords=mapcents,
>>> bandwidth=sjc.bw, hatmatrix=TRUE)
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>     
>>
>>
>>
>>   
>> ------------------------------------------------------------------------
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>   
>

-- 
___________________________________________
Danlin Yu, Ph.D.
Assistant Professor
Department of Earth & Environmental Studies
Montclair State University
Montclair, NJ, 07043
Tel: 973-655-4313
Fax: 973-655-4072
email: yud at mail.montclair.edu
webpage: csam.montclair.edu/~yu



From murray.richardson at utoronto.ca  Wed Nov 12 22:09:35 2008
From: murray.richardson at utoronto.ca (Murray Richardson)
Date: Wed, 12 Nov 2008 16:09:35 -0500
Subject: [R-sig-Geo] merge sliver polygons
In-Reply-To: <Pine.LNX.4.64.0809052111280.7609@reclus.nhh.no>
References: <48A2E556.3040305@utoronto.ca>
	<Pine.LNX.4.64.0808131613530.20340@reclus.nhh.no>
	<48C16113.5050204@utoronto.ca>
	<Pine.LNX.4.64.0809051932350.7609@reclus.nhh.no>
	<48C17F42.3060201@utoronto.ca>
	<Pine.LNX.4.64.0809052111280.7609@reclus.nhh.no>
Message-ID: <491B460F.3030103@utoronto.ca>

Dear Roger or others,

You may recall this thread in which you helped me work out a region 
merging routine for dealing with sliver polygons, or to simplify the 
polygons resulting from an image analysis routine.

Based on your advice, I worked out an iterative routine that merges 
adjacent polygons based on the highest degree of similarity.  It repeats 
until all merges are complete to satisfy a similarity threshold (i.e. no 
more adjacent polygons whose attributes of interest are within a certain 
similarity tolerance.

I realized however that I am having problems with polygon  holes - a 
problem you seemed to have foreshadowed towards the beginning of this 
thread.  The problem occurs when I call unionSpatialPolygons and it 
appears that the hole polygons are automatically merged with the 
adjacent polygons.   If I understand correctly, a polygon that contains 
a polygon hole will have a slot dedicated to the polygon hole, with 
identical attributes to the non-hole polygon?  Then when 
unionSpatialPolygons is called they will be merged (at least in my case, 
since the attributes are the same?).  Perhaps you could confirm whether 
this is correct, and if so, can you suggest a way around it?  
Essentially, I do not want polygon holes to be included in the merging 
process.

Thanks in advance!

Murray


Roger Bivand wrote:
> On Fri, 5 Sep 2008, Murray Richardson wrote:
>
>> Thanks Roger,
>>
>> I have singletons with areas.  I think the slivers will be quite 
>> obvious based on their areas relative to the rest of the polygon 
>> areas.  I could even compute some perimeter to area index I supposed 
>> since they tend to be long a skinny.
>>
>> So, my main uncertainty is still just how to work with the neighbour 
>> list to merge the sliver polygons with the LARGEST non-sliver polygon 
>> they share an edge with. i.e. to generate the new ids to use in 
>> unionSpatialPolygons.   I can't seem to find a good example of how to 
>> use the nb object in such a way.
>
> OK, so the Polygons are all singletons. This isn't tried:
>
> is_a_sliver <- AREAS < very_small
> library(spdep)
> nb <- poly2nb(your_SPDF)
> # check length(is_a_sliver) against length(nb)
> crd <- card(nb)
> IDs <- sapply(slot(your_SPDF, "polygons"), function(x) slot(x, "ID"))
> for (i in seq(along=nb)) {
>   if (is_a_sliver[i] && crd[i] > 0) {
>     nbi <- nb[[i]]
>     max_area <- nbi[which.max(AREAS[nbi])]
>     IDs[i] <- IDs[max_area]
>   }
> }
>
> then use IDs in unionSpatialPolygons()
>
> I repeat, untried, but something like this should work.
>
> Roger
>
> PS. If you have the perimeter, you could try it as a sanity check if 
> area alone give spurious results.
>
>>
>> cheers
>>
>> Murray
>>
>>
>> Roger Bivand wrote:
>>>  On Fri, 5 Sep 2008, Murray Richardson wrote:
>>>
>>> >  Hi Roger
>>> > >  I'm just getting around to trying this out. I must say, I'm not 
>>> clear on >  how to work with the neighbour list object to accomplish 
>>> this. >  Specifically, how would I identify the largest neighbours 
>>> of the sliver >  candidates?
>>> > >  Furthermore, do I first subset the polygons according to the 
>>> area >  threshold, and then construct the neighbour list for only 
>>> these >  candidate slivers?  I'm not clear on how to identify 
>>> neighbours for a >  subset of polygons.
>>>
>>>  My idea (IIRC!) was to look at a distribution of the areas of the 
>>> Polygon
>>>  objects in the dataset. A good deal will depend on whether the 
>>> slivers are
>>>  represented as separate Polygons objects (note the _s_), or whether 
>>> they
>>>  are Polygon objects belonging to Polygons objects. So nimbleness 
>>> will be
>>>  needed!
>>>
>>>  library(maptools)
>>>  xx <- readShapeSpatial(system.file("shapes/sids.shp",
>>>  package="maptools")[1],
>>>        IDvar="FIPSNO", proj4string=CRS("+proj=longlat +ellps=clrk66"))
>>>  pls <- slot(xx, "polygons")
>>>  AREAS <- sapply(pls, function(x) sapply(slot(x, "Polygons"), 
>>> function(y)
>>>        slot(y, "area")))
>>>  summary(sapply(AREAS, length))
>>>  summary(unlist(AREAS))
>>>
>>>  is not a very good example, because the "areas" are planar in 
>>> non-planar
>>>  coordinates, but I hope you see the point. If you have a clear 
>>> break in
>>>  the distribution, you can find out which they are, and where they 
>>> are. If
>>>  all the Polygons objects (the ones in the "polygons" slot of your
>>>  SpatialPolygons object, pls) are singletons, things get much easier,
>>>  because the merging will be between Polygons objects, provided 
>>> directly in
>>>  maptools.
>>>
>>>  This should be a start - once you have singleton Polygons objects with
>>>  areas as attributes, we can continue.
>>>
>>>  Hope this helps,
>>>
>>>  Roger
>>>
>>> > >  Sorry to bother you with this again.  It will be very useful if 
>>> it works >  as I would also like to use it for region merging based 
>>> on other >  attributes.
>>> > >  Still waiting on that book...!
>>>
>>>  PS. Edzer, Virgilio and I did see the only copy in Europe in 
>>> Dortmund at
>>>  useR! three weeks ago. It turns out that it was printed in the US, 
>>> and is
>>>  at or awaited at the publisher's warehouse for dispatch. Things 
>>> seem to
>>>  take time in the "real" world!
>>>
>>> > >  Murray
>>> > > > >  Roger Bivand wrote:
>>> > >   On Wed, 13 Aug 2008, Murray Richardson wrote:
>>> > > > > >   Hello again r.sig.geo list,
>>> > > > >   Thanks Roger, for help on my previous question regarding > 
>>> > iterating >   through a shapefile.
>>> > > > >   I'm sure once I receive my copy of  "Applied Spatial Data 
>>> > >  Analysis with >  R" I will find answers to simple questions 
>>> like this > >  on my own, but in >  the meantime....
>>> > > > >   Is it possible to merge sliver polygons that fall below a 
>>> > >  certain >  threshold area with adjacent neighbours (e.g. 
>>> perhaps using > >  >  unionSpatialPolygons but without aggregating 
>>> any  polygons?).  If a > >  >  sliver shares edges with more than 
>>> one polygon, it doesn't really > >  matter >  which one it merges 
>>> with, but if I had to choose a rule I > >  would have it >  merge 
>>> with the largest one.
>>> > > > >   Not such a simple question ...
>>> > > > >  Both the Polygon and Polygons objects in the 
>>> SpatialPolygons object > >  have
>>> > >   "area" slots, with different roles. The Polygon objects have a 
>>> > >   correct
>>> > >   naive area in the geometry of the coordinates taken as planar. 
>>> The
>>> > >   Polygons objects use the "gross" area of Polygon objects 
>>> belonging to
>>> > >   them, but "only" to provide the plot order (plot from largest 
>>> to > >  smallest
>>> > >   to avoid over-painting).
>>> > > > >   If you "trust" the area slot of the Polygons objects 
>>> (beware of hole
>>> > >   Polygon objects), you can first find your candidate slivers by 
>>> > >  retrieving
>>> > >   the areas by:
>>> > > > >   Polygons_areas <- sapply(slot(SPobj, "polygons"),
>>> > >     function(x) slot(x, "area"))
>>> > > > >  and set a cutoff. Then use poly2nb(SPobj, queen=FALSE) in 
>>> spdep to > >  find
>>> > >  the neighbours (rook criterion). Next use the output object to 
>>> > >  identify
>>> > >   the largest neighbours of the sliver candidates, and build a "new
>>> > >   Polygons" ID vector. Finally, use unionSpatialPolygons(). I'm 
>>> > >  assuming you
>>> > >   wouldn't have asked if there was useful data in the slivers!
>>> > > > >   Hope this helps,
>>> > > > >   Roger
>>> > > > > > >   Thanks in advance,
>>> > > > >   Murray Richardson
>>> > > >
>>>>>> _______________________________________________
>>> > > >   R-sig-Geo mailing list
>>> > > >   R-sig-Geo at stat.math.ethz.ch
>>> > > >   https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> > > > > >
>>
>



From patrick.giraudoux at univ-fcomte.fr  Thu Nov 13 08:27:41 2008
From: patrick.giraudoux at univ-fcomte.fr (Patrick Giraudoux)
Date: Thu, 13 Nov 2008 08:27:41 +0100
Subject: [R-sig-Geo] read GRASS6 from outside
Message-ID: <491BD6ED.6080102@univ-fcomte.fr>

Dear listers,

I am using GRASS6 embedded within QGIS under Windows for teaching 
purpose. This prevents reading GRASS objects from R within GRASS (R 
cannot be launched within GRASS in this configuration).

I was wondering if it would be possible to read GRASS objects (vector, 
raster layers, region values, etc.) in R (eg to sp objects) from outside 
GRASS, with functions analogous to those  provided with spgrass6.

Any idea welcome.



From alessandro.montaghi at unifi.it  Thu Nov 13 09:19:44 2008
From: alessandro.montaghi at unifi.it (alessandro.montaghi at unifi.it)
Date: Thu, 13 Nov 2008 09:19:44 +0100
Subject: [R-sig-Geo] problem with merge grids in R+SAGA
Message-ID: <20081113091944.gnyidkri4z2o80c0@webmail.sf-csiaf.unifi.it>

Hi All

when I use this function with R and SAGA:

rsaga.get.usage("grid_tools", 3)
rsaga.geoprocessor(lib="grid_tools", module=3,  
param=list(GRIDS="DSM1.sgrd,DSM2.sgrd,DSM3.sgrd",GRID_TARGET="DSM.sgrd",TYPE=7, INTERPOL=2,  
OVERLAP=0))

I have this problem

SAGA CMD 2.0.3
library path:   C:\Windows/modules
library name:   grid_tools
module name :   Merging
author      :   (c) 2003 by O.Conrad

Load grid: DSM1.sgrd,DSM2.sgrd,DSM3.sgrd...

failed

error: Grid file could not be opened.

error: input file [DSM1.sgrd,DSM2.sgrd,DSM3.sgrd]

error: empty input list [GRIDS]

error: executing module [Merging]


I don't understand very well where is the problem of the code.

thanks for help

Ale



From Roger.Bivand at nhh.no  Thu Nov 13 10:04:19 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 13 Nov 2008 10:04:19 +0100 (CET)
Subject: [R-sig-Geo] read GRASS6 from outside
In-Reply-To: <491BD6ED.6080102@univ-fcomte.fr>
References: <491BD6ED.6080102@univ-fcomte.fr>
Message-ID: <alpine.LRH.2.00.0811130926520.7766@reclus.nhh.no>

On Thu, 13 Nov 2008, Patrick Giraudoux wrote:

> Dear listers,
>
> I am using GRASS6 embedded within QGIS under Windows for teaching purpose. 
> This prevents reading GRASS objects from R within GRASS (R cannot be launched 
> within GRASS in this configuration).

Patrick,

Could you explain why not? I can launch it, and I know others can, at 
least by:

Plugins -> GRASS -> Open GRASS Tools -> shell

and typing the full path to Rgui.exe at the shell prompt, for me:

$ "C:/Program Files/R/R-2.8.0/bin/Rgui.exe"

You may need to set the path to R_LIBS in user environment variables, or 
to add it to the command line in the GRASS shell prompt, or use 
.libPaths() within R, but beyond that, things should work, including file 
transfer etc.

The startup message in the current release does say "GRASS not running" 
because QGIS does not set the GRASS_VERSION or LOCATION_NAME environment 
variables, but does set GISRC - I'll try to fix that.

Doing getwd() in R will show that R is in the QGIS MSYS home directory for 
the user. This of course places R "on top" in standard spgrass6 fashion, 
but QGIS can be used at the same time. Work is progressing to embed R 
within QGIS, see:

http://www.ftools.ca/manageR.html

but until this is up and easily installable, going through the GRASS shell 
seems to work. Note that when you do system() from R, QGIS expects all 
executables to have the .exe extension added:

system("g.list rast") # fails
system("g.list.exe rast") # succeeds

Hope this helps,

Roger

PS. Note that the QGIS MSYS GRASS shell does history, so it logs the 
command to start R, which you retrieve with the up arrow in the usual way 
- the only editing needed is when you upgrade R.

>
> I was wondering if it would be possible to read GRASS objects (vector, raster 
> layers, region values, etc.) in R (eg to sp objects) from outside GRASS, with 
> functions analogous to those  provided with spgrass6.

PPS. In desperation, use v.(in/out).ogr and r.(in/out).gdal matched with 
read(GDAL/OGR) and write(GDAL/OGR) in rgdal, but watch which directory 
they land in.

>
> Any idea welcome.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From T.Hengl at uva.nl  Thu Nov 13 11:00:49 2008
From: T.Hengl at uva.nl (Tomislav Hengl)
Date: Thu, 13 Nov 2008 11:00:49 +0100
Subject: [R-sig-Geo] problem with merge grids in R+SAGA
In-Reply-To: <20081113091944.gnyidkri4z2o80c0@webmail.sf-csiaf.unifi.it>
References: <20081113091944.gnyidkri4z2o80c0@webmail.sf-csiaf.unifi.it>
Message-ID: <3FB50D1042B64338B1D5F0E6D9D06A32@pcibed193>


Alessandro,

You need to separate the put the list of input grids as a character vector e.g.:

GRIDS=c("DSM1.sgrd,DSM2.sgrd,DSM3.sgrd")


See also:
http://spatial-analyst.net/wiki/index.php?title=Software#SAGA_GIS

Maybe you should also study this posting guide:
http://spatial-analyst.net/wiki/index.php?title=Scripting_in_R 



-----Original Message-----
From: r-sig-geo-bounces at stat.math.ethz.ch [mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of
alessandro.montaghi at unifi.it
Sent: Thursday, November 13, 2008 9:20 AM
To: r-sig-geo at stat.math.ethz.ch
Subject: [R-sig-Geo] problem with merge grids in R+SAGA
Importance: High

Hi All

when I use this function with R and SAGA:

rsaga.get.usage("grid_tools", 3)
rsaga.geoprocessor(lib="grid_tools", module=3,  
param=list(GRIDS="DSM1.sgrd,DSM2.sgrd,DSM3.sgrd",GRID_TARGET="DSM.sgrd",TYPE=7, INTERPOL=2,  
OVERLAP=0))

I have this problem

SAGA CMD 2.0.3
library path:   C:\Windows/modules
library name:   grid_tools
module name :   Merging
author      :   (c) 2003 by O.Conrad

Load grid: DSM1.sgrd,DSM2.sgrd,DSM3.sgrd...

failed

error: Grid file could not be opened.

error: input file [DSM1.sgrd,DSM2.sgrd,DSM3.sgrd]

error: empty input list [GRIDS]

error: executing module [Merging]


I don't understand very well where is the problem of the code.

thanks for help

Ale

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch
https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From brenning at uwaterloo.ca  Thu Nov 13 13:54:29 2008
From: brenning at uwaterloo.ca (Alexander Brenning)
Date: Thu, 13 Nov 2008 07:54:29 -0500
Subject: [R-sig-Geo] problem with merge grids in R+SAGA
In-Reply-To: <3FB50D1042B64338B1D5F0E6D9D06A32@pcibed193>
References: <20081113091944.gnyidkri4z2o80c0@webmail.sf-csiaf.unifi.it>
	<3FB50D1042B64338B1D5F0E6D9D06A32@pcibed193>
Message-ID: <491C2385.8010809@uwaterloo.ca>


Tomislav Hengl wrote:
> Alessandro,
> 
> You need to separate the put the list of input grids as a character vector e.g.:
> 
> GRIDS=c("DSM1.sgrd,DSM2.sgrd,DSM3.sgrd")

...not when calling the rsaga.geoprocessor, if I recall correctly. The 
high-level wrapper functions would accept a vector, but the 
rsaga.geoprocessor would expect this:

GRIDS = "DSM1.sgrd;DSM2.sgrd;DSM3.sgrd"

Cheers
  Alex


> 
> 
> See also:
> http://spatial-analyst.net/wiki/index.php?title=Software#SAGA_GIS
> 
> Maybe you should also study this posting guide:
> http://spatial-analyst.net/wiki/index.php?title=Scripting_in_R 
> 
> 
> 
> -----Original Message-----
> From: r-sig-geo-bounces at stat.math.ethz.ch [mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of
> alessandro.montaghi at unifi.it
> Sent: Thursday, November 13, 2008 9:20 AM
> To: r-sig-geo at stat.math.ethz.ch
> Subject: [R-sig-Geo] problem with merge grids in R+SAGA
> Importance: High
> 
> Hi All
> 
> when I use this function with R and SAGA:
> 
> rsaga.get.usage("grid_tools", 3)
> rsaga.geoprocessor(lib="grid_tools", module=3,  
> param=list(GRIDS="DSM1.sgrd,DSM2.sgrd,DSM3.sgrd",GRID_TARGET="DSM.sgrd",TYPE=7, INTERPOL=2,  
> OVERLAP=0))
> 
> I have this problem
> 
> SAGA CMD 2.0.3
> library path:   C:\Windows/modules
> library name:   grid_tools
> module name :   Merging
> author      :   (c) 2003 by O.Conrad
> 
> Load grid: DSM1.sgrd,DSM2.sgrd,DSM3.sgrd...
> 
> failed
> 
> error: Grid file could not be opened.
> 
> error: input file [DSM1.sgrd,DSM2.sgrd,DSM3.sgrd]
> 
> error: empty input list [GRIDS]
> 
> error: executing module [Merging]
> 
> 
> I don't understand very well where is the problem of the code.
> 
> thanks for help
> 
> Ale
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 

-- 
Alexander Brenning
brenning at uwaterloo.ca - T +1-519-888-4567 ext 35783
Department of Geography and Environmental Management
University of Waterloo
200 University Ave. W - Waterloo, ON - Canada N2L 3G1
http://www.fes.uwaterloo.ca/geography/faculty/brenning/



From patrick.giraudoux at univ-fcomte.fr  Thu Nov 13 14:22:57 2008
From: patrick.giraudoux at univ-fcomte.fr (Patrick Giraudoux)
Date: Thu, 13 Nov 2008 14:22:57 +0100
Subject: [R-sig-Geo] read GRASS6 from outside
In-Reply-To: <alpine.LRH.2.00.0811130926520.7766@reclus.nhh.no>
References: <491BD6ED.6080102@univ-fcomte.fr>
	<alpine.LRH.2.00.0811130926520.7766@reclus.nhh.no>
Message-ID: <491C2A31.2060701@univ-fcomte.fr>

Roger Bivand a ?crit :
> On Thu, 13 Nov 2008, Patrick Giraudoux wrote:
>
>> Dear listers,
>>
>> I am using GRASS6 embedded within QGIS under Windows for teaching 
>> purpose. This prevents reading GRASS objects from R within GRASS (R 
>> cannot be launched within GRASS in this configuration).
>
> Patrick,
>
> Could you explain why not? I can launch it, and I know others can, at 
> least by:
>
> Plugins -> GRASS -> Open GRASS Tools -> shell
>
> and typing the full path to Rgui.exe at the shell prompt, for me:
>
> $ "C:/Program Files/R/R-2.8.0/bin/Rgui.exe"
>
> You may need to set the path to R_LIBS in user environment variables, 
> or to add it to the command line in the GRASS shell prompt, or use 
> .libPaths() within R, but beyond that, things should work, including 
> file transfer etc.
>
> The startup message in the current release does say "GRASS not 
> running" because QGIS does not set the GRASS_VERSION or LOCATION_NAME 
> environment variables, but does set GISRC - I'll try to fix that.
>
> Doing getwd() in R will show that R is in the QGIS MSYS home directory 
> for the user. This of course places R "on top" in standard spgrass6 
> fashion, but QGIS can be used at the same time. Work is progressing to 
> embed R within QGIS, see:
>
> http://www.ftools.ca/manageR.html
>
> but until this is up and easily installable, going through the GRASS 
> shell seems to work. Note that when you do system() from R, QGIS 
> expects all executables to have the .exe extension added:
>
> system("g.list rast") # fails
> system("g.list.exe rast") # succeeds
>
> Hope this helps,
>
> Roger
>
> PS. Note that the QGIS MSYS GRASS shell does history, so it logs the 
> command to start R, which you retrieve with the up arrow in the usual 
> way - the only editing needed is when you upgrade R.
>
>>
>> I was wondering if it would be possible to read GRASS objects 
>> (vector, raster layers, region values, etc.) in R (eg to sp objects) 
>> from outside GRASS, with functions analogous to those  provided with 
>> spgrass6.
>
> PPS. In desperation, use v.(in/out).ogr and r.(in/out).gdal matched 
> with read(GDAL/OGR) and write(GDAL/OGR) in rgdal, but watch which 
> directory they land in.
>
>>
>> Any idea welcome.
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
Roger,

Ashes on my head ! I was convinced (means perfectly stuborn here)  that 
GRASS within QGIS was closed to any call to external programmes. Which 
is obviously wrong ! So I did not even try... Real apologize to have 
lost your time for writing a response.

Cheers,

Patrick



From Roger.Bivand at nhh.no  Thu Nov 13 15:40:05 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 13 Nov 2008 15:40:05 +0100 (CET)
Subject: [R-sig-Geo] read GRASS6 from outside
In-Reply-To: <491C2A31.2060701@univ-fcomte.fr>
References: <491BD6ED.6080102@univ-fcomte.fr>
	<alpine.LRH.2.00.0811130926520.7766@reclus.nhh.no>
	<491C2A31.2060701@univ-fcomte.fr>
Message-ID: <alpine.LRH.2.00.0811131530170.7766@reclus.nhh.no>

On Thu, 13 Nov 2008, Patrick Giraudoux wrote:

> Roger Bivand a ?crit :
>> On Thu, 13 Nov 2008, Patrick Giraudoux wrote:
>> 
>>> Dear listers,
>>> 
>>> I am using GRASS6 embedded within QGIS under Windows for teaching purpose. 
>>> This prevents reading GRASS objects from R within GRASS (R cannot be 
>>> launched within GRASS in this configuration).
>> 
>> Patrick,
>> 
>> Could you explain why not? I can launch it, and I know others can, at least 
>> by:
>> 
>> Plugins -> GRASS -> Open GRASS Tools -> shell
>> 
>> and typing the full path to Rgui.exe at the shell prompt, for me:
>> 
>> $ "C:/Program Files/R/R-2.8.0/bin/Rgui.exe"
>> 
>> You may need to set the path to R_LIBS in user environment variables, or to 
>> add it to the command line in the GRASS shell prompt, or use .libPaths() 
>> within R, but beyond that, things should work, including file transfer etc.
>> 
>> The startup message in the current release does say "GRASS not running" 
>> because QGIS does not set the GRASS_VERSION or LOCATION_NAME environment 
>> variables, but does set GISRC - I'll try to fix that.

This should be fixed in the version of the package just submitted to CRAN. 
It is worth noting, however, that it hasn't been tested on GRASS < 6.3, 
but works - giving the correct GRASS version and LOCATION - on Linux (of 
course!), Windows Cygwin, Windows native GRASS, and QGIS 0.11 GRASS 
plugin.

The Windows native GRASS also needs the full path to Rgui.exe entered into 
the lower panel of the Output - GIS.m window, followed by -> Run. If there 
are any GRASS or QGIS developers online - might it be possible to put R on 
a button with the full path string somewhere in an editable option?

Roger

>> 
>> Doing getwd() in R will show that R is in the QGIS MSYS home directory for 
>> the user. This of course places R "on top" in standard spgrass6 fashion, 
>> but QGIS can be used at the same time. Work is progressing to embed R 
>> within QGIS, see:
>> 
>> http://www.ftools.ca/manageR.html
>> 
>> but until this is up and easily installable, going through the GRASS shell 
>> seems to work. Note that when you do system() from R, QGIS expects all 
>> executables to have the .exe extension added:
>> 
>> system("g.list rast") # fails
>> system("g.list.exe rast") # succeeds
>> 
>> Hope this helps,
>> 
>> Roger
>> 
>> PS. Note that the QGIS MSYS GRASS shell does history, so it logs the 
>> command to start R, which you retrieve with the up arrow in the usual way - 
>> the only editing needed is when you upgrade R.
>> 
>>> 
>>> I was wondering if it would be possible to read GRASS objects (vector, 
>>> raster layers, region values, etc.) in R (eg to sp objects) from outside 
>>> GRASS, with functions analogous to those  provided with spgrass6.
>> 
>> PPS. In desperation, use v.(in/out).ogr and r.(in/out).gdal matched with 
>> read(GDAL/OGR) and write(GDAL/OGR) in rgdal, but watch which directory they 
>> land in.
>> 
>>> 
>>> Any idea welcome.
>>> 
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> 
>> 
> Roger,
>
> Ashes on my head ! I was convinced (means perfectly stuborn here)  that GRASS 
> within QGIS was closed to any call to external programmes. Which is obviously 
> wrong ! So I did not even try... Real apologize to have lost your time for 
> writing a response.
>
> Cheers,
>
> Patrick
>
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From tech_dev at wildintellect.com  Thu Nov 13 22:15:57 2008
From: tech_dev at wildintellect.com (Alex Mandel)
Date: Thu, 13 Nov 2008 13:15:57 -0800
Subject: [R-sig-Geo] read GRASS6 from outside
In-Reply-To: <alpine.LRH.2.00.0811131530170.7766@reclus.nhh.no>
References: <491BD6ED.6080102@univ-fcomte.fr>	<alpine.LRH.2.00.0811130926520.7766@reclus.nhh.no>	<491C2A31.2060701@univ-fcomte.fr>
	<alpine.LRH.2.00.0811131530170.7766@reclus.nhh.no>
Message-ID: <491C990D.608@wildintellect.com>

Roger Bivand wrote:
> On Thu, 13 Nov 2008, Patrick Giraudoux wrote:
> 
>> Roger Bivand a ?crit :
>>> On Thu, 13 Nov 2008, Patrick Giraudoux wrote:
>>>
>>>> Dear listers,
>>>>
>>>> I am using GRASS6 embedded within QGIS under Windows for teaching
>>>> purpose. This prevents reading GRASS objects from R within GRASS (R
>>>> cannot be launched within GRASS in this configuration).
>>>
>>> Patrick,
>>>
>>> Could you explain why not? I can launch it, and I know others can, at
>>> least by:
>>>
>>> Plugins -> GRASS -> Open GRASS Tools -> shell
>>>
>>> and typing the full path to Rgui.exe at the shell prompt, for me:
>>>
>>> $ "C:/Program Files/R/R-2.8.0/bin/Rgui.exe"
>>>
>>> You may need to set the path to R_LIBS in user environment variables,
>>> or to add it to the command line in the GRASS shell prompt, or use
>>> .libPaths() within R, but beyond that, things should work, including
>>> file transfer etc.
>>>
>>> The startup message in the current release does say "GRASS not
>>> running" because QGIS does not set the GRASS_VERSION or LOCATION_NAME
>>> environment variables, but does set GISRC - I'll try to fix that.
> 
> This should be fixed in the version of the package just submitted to
> CRAN. It is worth noting, however, that it hasn't been tested on GRASS <
> 6.3, but works - giving the correct GRASS version and LOCATION - on
> Linux (of course!), Windows Cygwin, Windows native GRASS, and QGIS 0.11
> GRASS plugin.
> 
> The Windows native GRASS also needs the full path to Rgui.exe entered
> into the lower panel of the Output - GIS.m window, followed by -> Run.
> If there are any GRASS or QGIS developers online - might it be possible
> to put R on a button with the full path string somewhere in an editable
> option?
> 
> Roger
> 

I filed the request with the QGIS team since I'm active over there.
Thanks for working out the details.

Alex



From A.Oke at bom.gov.au  Fri Nov 14 05:46:41 2008
From: A.Oke at bom.gov.au (Alison Oke)
Date: Fri, 14 Nov 2008 15:46:41 +1100
Subject: [R-sig-Geo] Manually defining the regression model in universal
	kriging [SEC=UNCLASSIFIED]
Message-ID: <E2A409BABC575E458D4D8A88A9D317E71B5AFD@officeho2.bom.gov.au>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081114/8c24066a/attachment.pl>

From edzer.pebesma at uni-muenster.de  Fri Nov 14 08:14:58 2008
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 14 Nov 2008 08:14:58 +0100
Subject: [R-sig-Geo] Manually defining the regression model in universal
 kriging [SEC=UNCLASSIFIED]
In-Reply-To: <E2A409BABC575E458D4D8A88A9D317E71B5AFD@officeho2.bom.gov.au>
References: <E2A409BABC575E458D4D8A88A9D317E71B5AFD@officeho2.bom.gov.au>
Message-ID: <491D2572.5090708@uni-muenster.de>

Alison,

there's two ways for this:

1. provide krige() with regression coordinates, by

ObsSat.rk <- krige(Obs_rain~sat_rain, ObsSat_UTM, SatDat_UTM,
ObsSat.rvgm, beta = c(a,b))

with a and b your "manual" intercept and slope, or

2. by kriging manually computed residuals and adding them to the 
manually computed regression surface.

Probably, 1. is simplest; the results are identical if under 2. you 
specify beta = 0.0, thereby forcing simple kriging over ordinary 
kriging. Some might prefer 2. with ordinary kriging, e.g. to allow for a 
locally adapting mean, but you didn't use local kriging in the first place.
--
Edzer

Alison Oke wrote:
> Hello list,
>
> I am trying to use universal kriging (gstat, R) to create a gridded
> daily rainfall surface. I have rain gauge data and satellite grid data
> and have applied the following script successfully. I would now like to
> manually define the regression model that defines the relationship
> between the gauge and satellite at the collocated points so I can apply
> the same model to a series of days. Is it possible to manually define
> the regression equation and have it applied within the krige function? 
>
>  
>
> Datasets
>
> ObsSat_UTM = collocated gauge and satellite data.
>
> SatDat_UTM = Satellite grid. 
>
>  
>
> # Define the regression model to define relationships between dependent
> (gauge) and independent (sat) variables at collocated points. 
>
> ObsSat.lm <-lm(formula = Obs_rain~sat_rain, ObsSat_UTM)
>
>  
>
> #Variogram of residuals of regression between obs and sat data a gauge
> sites
>
> ObsSat.rev <- variogram(Obs_rain~sat_rain, ObsSat_UTM)
>
> ObsSat.rvgm <- fit.variogram(ObsSat.rev, vgm(20,"Exp", 50,0))
>
>  
>
> #predict onto the Sat grid
>
> ObsSat.rk <- krige(Obs_rain~sat_rain, ObsSat_UTM, SatDat_UTM,
> ObsSat.rvgm)
>
>  
>
> If this question has already been answered I apologise. I have had
> trouble finding any examples of how to include this into my script.
>
> Thanks very much 
>
> Alison Oke
>
>  
>
> Hydrologist
>
> Water Division
>
> Bureau of Meteorology
>
> GPO Box 1289
>
> Melbourne, VIC 3001
>
>  
>
> Phone:  +61 (0) 3 8638 8212
>
> Fax:      +61 (0) 3 8638 8200
>
> E-mail:   a.oke at bom.gov.au
>
>  
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de/
http://www.springer.com/978-0-387-78170-9 e.pebesma at wwu.de



From alex.deckmyn at oma.be  Fri Nov 14 10:19:09 2008
From: alex.deckmyn at oma.be (Alex Deckmyn)
Date: Fri, 14 Nov 2008 10:19:09 +0100
Subject: [R-sig-Geo] updated worldHires available
Message-ID: <491D428D.1030203@oma.be>

Hi,

I have made an updated version of worldHires in the mapdata package. I 
have inserted additional lines and polygons for all new countries from 
former Yugoslavia, USSR and Czechoslovakia.

The new polylines are mostly from the UNEP/GRID dataset and in one 
instance from GSHHS.

Is there any interest in making this dataset available? I believe UNEP 
places no restrictions on the data, and GSHHS is GPL'd.

regards,
Alex

-- 
Dr. Alex Deckmyn                   e-mail: alex.deckmyn at oma.be
Royal Meteorological Institute     http://www.meteo.be
Ringlaan 3, 1180 Ukkel, Belgium    tel. (32)(2)3730646



From tord.snall at ekol.slu.se  Fri Nov 14 12:14:19 2008
From: tord.snall at ekol.slu.se (=?ISO-8859-1?Q?Tord_Sn=E4ll?=)
Date: Fri, 14 Nov 2008 12:14:19 +0100
Subject: [R-sig-Geo] pretty in spplot()
Message-ID: <491D5D8B.4010507@ekol.slu.se>

Dear all,
I would like legend cut-offs that are prettier that just executing
spplot(SpatialPolygonsDataFrame(karta, 
as.data.frame(resdf[,c("TempEst.t","TempEst.tM1")])))

I try
spplot(SpatialPolygonsDataFrame(karta, 
as.data.frame(resdf[,c("TempEst.t","TempEst.tM1")])),at=pretty())
, though without sucess.

Could someone give a clue on how to do it?

Thanks!

/Tord



From Thierry.ONKELINX at inbo.be  Fri Nov 14 12:25:09 2008
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Fri, 14 Nov 2008 12:25:09 +0100
Subject: [R-sig-Geo] pretty in spplot()
In-Reply-To: <491D5D8B.4010507@ekol.slu.se>
References: <491D5D8B.4010507@ekol.slu.se>
Message-ID: <2E9C414912813E4EB981326983E0A10405C255EF@inboexch.inbo.be>

Dear Tord,

You need to supply the datavalues to the pretty function. An untested example as your example was not reproducible with a (dummy) dataset.

PrettyBreaks <- pretty(as.vector(resdf[,c("TempEst.t","TempEst.tM1")]))
spplot(SpatialPolygonsDataFrame(karta, as.data.frame(resdf[,c("TempEst.t","TempEst.tM1")])),at=PrettyBreaks)

HTH,

Thierry

----------------------------------------------------------------------------
ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Research Institute for Nature and Forest
Cel biometrie, methodologie en kwaliteitszorg / Section biometrics, methodology and quality assurance
Gaverstraat 4
9500 Geraardsbergen
Belgium 
tel. + 32 54/436 185
Thierry.Onkelinx at inbo.be 
www.inbo.be 

To call in the statistician after the experiment is done may be no more than asking him to perform a post-mortem examination: he may be able to say what the experiment died of.
~ Sir Ronald Aylmer Fisher

The plural of anecdote is not data.
~ Roger Brinner

The combination of some data and an aching desire for an answer does not ensure that a reasonable answer can be extracted from a given body of data.
~ John Tukey

-----Oorspronkelijk bericht-----
Van: r-sig-geo-bounces at stat.math.ethz.ch [mailto:r-sig-geo-bounces at stat.math.ethz.ch] Namens Tord Sn?ll
Verzonden: vrijdag 14 november 2008 12:14
Aan: r-sig-geo at stat.math.ethz.ch
Onderwerp: [R-sig-Geo] pretty in spplot()

Dear all,
I would like legend cut-offs that are prettier that just executing
spplot(SpatialPolygonsDataFrame(karta, 
as.data.frame(resdf[,c("TempEst.t","TempEst.tM1")])))

I try
spplot(SpatialPolygonsDataFrame(karta, 
as.data.frame(resdf[,c("TempEst.t","TempEst.tM1")])),at=pretty())
, though without sucess.

Could someone give a clue on how to do it?

Thanks!

/Tord

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Dit bericht en eventuele bijlagen geven enkel de visie van de schrijver weer 
en binden het INBO onder geen enkel beding, zolang dit bericht niet bevestigd is
door een geldig ondertekend document. The views expressed in  this message 
and any annex are purely those of the writer and may not be regarded as stating 
an official position of INBO, as long as the message is not confirmed by a duly 
signed document.



From edzer.pebesma at uni-muenster.de  Fri Nov 14 12:23:23 2008
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 14 Nov 2008 12:23:23 +0100
Subject: [R-sig-Geo] pretty in spplot()
In-Reply-To: <491D5D8B.4010507@ekol.slu.se>
References: <491D5D8B.4010507@ekol.slu.se>
Message-ID: <491D5FAB.7000509@uni-muenster.de>

 > pretty()
Error in pretty() : argument "x" is missing, with no default

How about reading the documentation of pretty?
--
Edzer

Tord Sn?ll wrote:
> Dear all,
> I would like legend cut-offs that are prettier that just executing
> spplot(SpatialPolygonsDataFrame(karta, 
> as.data.frame(resdf[,c("TempEst.t","TempEst.tM1")])))
>
> I try
> spplot(SpatialPolygonsDataFrame(karta, 
> as.data.frame(resdf[,c("TempEst.t","TempEst.tM1")])),at=pretty())
> , though without sucess.
>
> Could someone give a clue on how to do it?
>
> Thanks!
>
> /Tord
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de/
http://www.springer.com/978-0-387-78170-9 e.pebesma at wwu.de



From tord.snall at ekol.slu.se  Fri Nov 14 13:38:34 2008
From: tord.snall at ekol.slu.se (=?ISO-8859-1?Q?Tord_Sn=E4ll?=)
Date: Fri, 14 Nov 2008 13:38:34 +0100
Subject: [R-sig-Geo] pretty in spplot()
In-Reply-To: <2E9C414912813E4EB981326983E0A10405C255EF@inboexch.inbo.be>
References: <491D5D8B.4010507@ekol.slu.se>
	<2E9C414912813E4EB981326983E0A10405C255EF@inboexch.inbo.be>
Message-ID: <491D714A.3060201@ekol.slu.se>

Dear Thierry,
Thanks very much. This was helpful. The code work with some changes.

Tord

ONKELINX, Thierry wrote:
> Dear Tord,
>
> You need to supply the datavalues to the pretty function. An untested example as your example was not reproducible with a (dummy) dataset.
>
> PrettyBreaks <- pretty(as.vector(resdf[,c("TempEst.t","TempEst.tM1")]))
> spplot(SpatialPolygonsDataFrame(karta, as.data.frame(resdf[,c("TempEst.t","TempEst.tM1")])),at=PrettyBreaks)
>
> HTH,
>
> Thierry
>
> ----------------------------------------------------------------------------
> ir. Thierry Onkelinx
> Instituut voor natuur- en bosonderzoek / Research Institute for Nature and Forest
> Cel biometrie, methodologie en kwaliteitszorg / Section biometrics, methodology and quality assurance
> Gaverstraat 4
> 9500 Geraardsbergen
> Belgium 
> tel. + 32 54/436 185
> Thierry.Onkelinx at inbo.be 
> www.inbo.be 
>
> To call in the statistician after the experiment is done may be no more than asking him to perform a post-mortem examination: he may be able to say what the experiment died of.
> ~ Sir Ronald Aylmer Fisher
>
> The plural of anecdote is not data.
> ~ Roger Brinner
>
> The combination of some data and an aching desire for an answer does not ensure that a reasonable answer can be extracted from a given body of data.
> ~ John Tukey
>
> -----Oorspronkelijk bericht-----
> Van: r-sig-geo-bounces at stat.math.ethz.ch [mailto:r-sig-geo-bounces at stat.math.ethz.ch] Namens Tord Sn?ll
> Verzonden: vrijdag 14 november 2008 12:14
> Aan: r-sig-geo at stat.math.ethz.ch
> Onderwerp: [R-sig-Geo] pretty in spplot()
>
> Dear all,
> I would like legend cut-offs that are prettier that just executing
> spplot(SpatialPolygonsDataFrame(karta, 
> as.data.frame(resdf[,c("TempEst.t","TempEst.tM1")])))
>
> I try
> spplot(SpatialPolygonsDataFrame(karta, 
> as.data.frame(resdf[,c("TempEst.t","TempEst.tM1")])),at=pretty())
> , though without sucess.
>
> Could someone give a clue on how to do it?
>
> Thanks!
>
> /Tord
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> Dit bericht en eventuele bijlagen geven enkel de visie van de schrijver weer 
> en binden het INBO onder geen enkel beding, zolang dit bericht niet bevestigd is
> door een geldig ondertekend document. The views expressed in  this message 
> and any annex are purely those of the writer and may not be regarded as stating 
> an official position of INBO, as long as the message is not confirmed by a duly 
> signed document.
>



From alessandro.montaghi at unifi.it  Fri Nov 14 20:00:39 2008
From: alessandro.montaghi at unifi.it (Alessandro)
Date: Fri, 14 Nov 2008 11:00:39 -0800
Subject: [R-sig-Geo] Bug report in Merged module di R+SAGA
Message-ID: <000001c9468b$4a2c1050$de8430f0$@montaghi@unifi.it>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081114/b3ade0c3/attachment.pl>

From patrick.giraudoux at univ-fcomte.fr  Sun Nov 16 14:32:15 2008
From: patrick.giraudoux at univ-fcomte.fr (Patrick Giraudoux)
Date: Sun, 16 Nov 2008 14:32:15 +0100
Subject: [R-sig-Geo] upload waypoint data to Garmin GPS
In-Reply-To: <mailman.9.1226746802.29467.r-sig-geo@stat.math.ethz.ch>
References: <mailman.9.1226746802.29467.r-sig-geo@stat.math.ethz.ch>
Message-ID: <492020DF.4050304@univ-fcomte.fr>

Dear listers,

I am writing a R function to upload waypoints to a GPS Garmin Etrex 
with  gpsbabel. This works quite well reading from a text file as following:

df<-"mytabfile.txt"
system(paste("gpsbabel -w -i tabsep -f ",df," -o garmin -F com5:",sep=""))

However, I would prefer to upload from a data.frame within R rather than 
reading a tab delimited text file on the disk.

Any idea about how to specify it in the command line (should be trivial, 
but I cannot figure it out) ?

Thanks in advance,

Patrick


-------------- next part --------------
A non-text attachment was scrubbed...
Name: patrick_giraudoux.vcf
Type: text/x-vcard
Size: 399 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081116/99a0d43c/attachment.vcf>

From T.Hengl at uva.nl  Mon Nov 17 12:09:58 2008
From: T.Hengl at uva.nl (Tomislav Hengl)
Date: Mon, 17 Nov 2008 12:09:58 +0100
Subject: [R-sig-Geo] Bug report in Merged module di R+SAGA
In-Reply-To: <000001c9468b$4a2c1050$de8430f0$@montaghi@unifi.it>
References: <000001c9468b$4a2c1050$de8430f0$@montaghi@unifi.it>
Message-ID: <2CA55D30D36E4046B023C0150DC19F6F@pcibed193>


Hi Alessandro,

Please do submit such and similar bugs to Olaf Conrad (the main developer of SAGA). For your
information, the C++ code of SAGA (SAGA 2.0.2 API - Python Interface) is available from
http://sourceforge.net/projects/saga-gis/ 

which means that you could obtain the code and fix the bug yourself.

You could also try using the ILWIS MapGlue command e.g.

> ILWIS <- "C:\\Progra~1\\N52\\SetupIlwis\\IlwisClient.exe -C"
> shell(cmd=paste(ILWIS, "GRID_AB.mpr = MapGlue(GRID_A, GRID_B, replace)"), wait=F)
> shell(cmd=paste(ILWIS, "open GRID_AB.mpr -noask"), wait=F)

This is very flexible as it allows you to take unlimited (?) number of maps and resample them to a
new common grid (something like the mosaicing tool in Erdas Imagine). See also:
http://spatial-analyst.net/ILWIS/htm/ilwisapp/glue_raster_maps_functionality.htm  


(I guess that merging of maps is also possible in the GRASS GIS?)

In any case, welcome to world of the open source software!

Tom Hengl
http://spatial-analyst.net/wiki/index.php?title=Software 




-----Original Message-----
From: r-sig-geo-bounces at stat.math.ethz.ch [mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of
Alessandro
Sent: Friday, November 14, 2008 8:01 PM
To: r-sig-geo at stat.math.ethz.ch
Subject: [R-sig-Geo] Bug report in Merged module di R+SAGA

Hi All,

 

There is a bug in the SAGA merged module in R.

 

I tried it with SAGA 2.0.3 from within R, with different grids, and It's ran
forever. This must be a bug in the Merged module, specifically in the
command line version of SAGA (saga_cmd). It's been a problem in some other
problems too that the saga_cmd binding crashed but the saga_gui version of
the same modules worked.

 

Today I report this bug in Sourcefourge project web site for SAGA.

 

Ale

 

 


	[[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch
https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From jnylen+rgeo at gmail.com  Mon Nov 17 17:42:57 2008
From: jnylen+rgeo at gmail.com (James Nylen)
Date: Mon, 17 Nov 2008 10:42:57 -0600
Subject: [R-sig-Geo] upload waypoint data to Garmin GPS
In-Reply-To: <492020DF.4050304@univ-fcomte.fr>
References: <mailman.9.1226746802.29467.r-sig-geo@stat.math.ethz.ch>
	<492020DF.4050304@univ-fcomte.fr>
Message-ID: <205a4c310811170842i95c5174qb9f32fa14c43c5ad@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081117/f1f91c90/attachment.pl>

From patrick.giraudoux at univ-fcomte.fr  Mon Nov 17 17:57:36 2008
From: patrick.giraudoux at univ-fcomte.fr (Patrick Giraudoux)
Date: Mon, 17 Nov 2008 17:57:36 +0100
Subject: [R-sig-Geo] upload waypoint data to Garmin GPS
In-Reply-To: <205a4c310811170842i95c5174qb9f32fa14c43c5ad@mail.gmail.com>
References: <mailman.9.1226746802.29467.r-sig-geo@stat.math.ethz.ch>	
	<492020DF.4050304@univ-fcomte.fr>
	<205a4c310811170842i95c5174qb9f32fa14c43c5ad@mail.gmail.com>
Message-ID: <4921A280.4090803@univ-fcomte.fr>

James Nylen a ?crit :
> The easiest thing to do is probably to write the data.frame to a 
> tab-delimited text file using write.table and then read in the written 
> file like you have done above.  See ?write.table - as I recall there 
> are plenty of options that will allow you to specify the separator, 
> whether or not to write headings, etc.
>  
> -James
This is exactly what I did yesterday (see script below - the function 
uploadEtrex is now at the working stage in a package pgirbirc at 
http://pagesperso-orange.fr/giraudoux/ or 
http://pagesperso-orange.fr/giraudoux/#pgirbric)

However when I think about it, my question was a bit silly: it was 
something as how to send a r-object to a connexion that a batch script 
could read at the operating system level without writing a file on 
disk... I guess there is no solution and the easiest way, indeed, is to 
write a text file and make it read from the shell (which is what the 
current fonction does...).

Thanks anyway for your input,

Patrick


uploadEtrex <- function (df, wcom = 4)
{
    dff <- as.data.frame(matrix(NA, nrow = nrow(df), ncol = 9))
    dff[, c(2, 8, 9)] <- df[, c(1, 3, 2)]
    write.table(dff, "dff", col.names = FALSE, sep = "\t", quote = FALSE)
    if (Sys.info()["sysname"] != "Windows") {
        system(paste("gpsbabel -w -i tabsep -f dff -o garmin -F 
/dev/ttyUSB0",
            sep = ""))
    }
    else {
        system(paste("gpsbabel -w -i tabsep -f dff -o garmin -F com",
            wcom, ":", sep = ""))
    }
}

>
>
>  
> On 11/16/08, *Patrick Giraudoux* <patrick.giraudoux at univ-fcomte.fr 
> <mailto:patrick.giraudoux at univ-fcomte.fr>> wrote:
>
>     Dear listers,
>
>     I am writing a R function to upload waypoints to a GPS Garmin
>     Etrex with  gpsbabel. This works quite well reading from a text
>     file as following:
>
>     df<-"mytabfile.txt"
>     system(paste("gpsbabel -w -i tabsep -f ",df," -o garmin -F
>     com5:",sep=""))
>
>     However, I would prefer to upload from a data.frame within R
>     rather than reading a tab delimited text file on the disk.
>
>     Any idea about how to specify it in the command line (should be
>     trivial, but I cannot figure it out) ?
>
>     Thanks in advance,
>
>     Patrick
>
>
>
>     _______________________________________________
>     R-sig-Geo mailing list
>     R-sig-Geo at stat.math.ethz.ch <mailto:R-sig-Geo at stat.math.ethz.ch>
>     https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081117/bee6c0fd/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: patrick_giraudoux.vcf
Type: text/x-vcard
Size: 399 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081117/bee6c0fd/attachment.vcf>

From saldanha.plangeo at gmail.com  Mon Nov 17 22:52:24 2008
From: saldanha.plangeo at gmail.com (Raphael Saldanha)
Date: Mon, 17 Nov 2008 19:52:24 -0200
Subject: [R-sig-Geo] Models
Message-ID: <c85849370811171352i2f3949b6m5804723f835aec41@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081117/1024e463/attachment.pl>

From Roger.Bivand at nhh.no  Mon Nov 17 23:36:19 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 17 Nov 2008 23:36:19 +0100 (CET)
Subject: [R-sig-Geo] Models
In-Reply-To: <c85849370811171352i2f3949b6m5804723f835aec41@mail.gmail.com>
References: <c85849370811171352i2f3949b6m5804723f835aec41@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.0811172332470.28284@reclus.nhh.no>

On Mon, 17 Nov 2008, Raphael Saldanha wrote:

> Hi!
>
> Running some models, I'm having, pratically, the same results with the
> models *spautolm(TX07 ~ X35A39 + TXPIB05, data=mg, family="SAR",
> listw=rook_Ww)* and *errorsarlm(TX07 ~ X35A39 + TXPIB05, data=mg,
> listw=rook_Ww)*. And looking the help don't helpe a lot... so, what are the
> basically differences between spautolm with SAR and errorsarlm, and what
> conclusions can I reach with similar results?

spautolm() is a re-implementation of errorsarlm(), adding support for 
weights and for CAR and SMA. So the "similarity" of results is by design, 
they are doing exactly the same thing, but written in a more general way 
in spautolm(). There are differences in the summary methods, so the model 
output looks a bit different, but only in appearance and internal 
structure, not in the methods being implemented.

Hope this helps,

Roger

>
>> summary(mg_sar)
>
> Call: spautolm(formula = TX07 ~ X35A39 + TXPIB05, data = mg, listw =
> rook_Ww,     family = "SAR")
>
> Residuals:
>     Min       1Q   Median       3Q      Max
> -17.4249  -3.2110  -1.3689   1.7380  47.3231
>
> Coefficients:
>             Estimate Std. Error z value Pr(>|z|)
> (Intercept) -2.668712   2.999516 -0.8897 0.373619
> X35A39       1.332412   0.417628  3.1904 0.001421
> TXPIB05     -0.055142   0.024987 -2.2068 0.027326
>
> Lambda: 0.70216 LR test value: 348.09 p-value: < 2.22e-16
>
> Log likelihood: -2859.839
> ML residual variance (sigma squared): 42.561, (sigma: 6.5239)
> Number of observations: 853
> Number of parameters estimated: 5
> AIC: 5729.7
>
> ############
>
>> summary(mg_errorsar)
>
> Call:errorsarlm(formula = TX07 ~ X35A39 + TXPIB05, data = mg, listw =
> rook_Ww)
>
> Residuals:
>     Min       1Q   Median       3Q      Max
> -17.4249  -3.2110  -1.3689   1.7380  47.3231
>
> Type: error
> Coefficients: (asymptotic standard errors)
>             Estimate Std. Error z value Pr(>|z|)
> (Intercept) -2.668712   2.999516 -0.8897 0.373619
> X35A39       1.332412   0.417628  3.1904 0.001421
> TXPIB05     -0.055142   0.024987 -2.2068 0.027326
>
> Lambda: 0.70216 LR test value: 348.09 p-value: < 2.22e-16
> Asymptotic standard error: 0.030286 z-value: 23.185 p-value: < 2.22e-16
> Wald statistic: 537.52 p-value: < 2.22e-16
>
> Log likelihood: -2859.839 for error model
> ML residual variance (sigma squared): 42.561, (sigma: 6.5239)
> Number of observations: 853
> Number of parameters estimated: 5
> AIC: 5729.7, (AIC for lm: 6075.8)
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From saldanha.plangeo at gmail.com  Tue Nov 18 00:51:13 2008
From: saldanha.plangeo at gmail.com (Raphael Saldanha)
Date: Mon, 17 Nov 2008 21:51:13 -0200
Subject: [R-sig-Geo] Models
In-Reply-To: <alpine.LRH.2.00.0811172332470.28284@reclus.nhh.no>
References: <c85849370811171352i2f3949b6m5804723f835aec41@mail.gmail.com>
	<alpine.LRH.2.00.0811172332470.28284@reclus.nhh.no>
Message-ID: <c85849370811171551w6ab1d5e1y91710f34242186b@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081117/7f759ab2/attachment.pl>

From hkreft at ucsd.edu  Tue Nov 18 09:38:05 2008
From: hkreft at ucsd.edu (Holger Kreft)
Date: Tue, 18 Nov 2008 00:38:05 -0800
Subject: [R-sig-Geo] ramping four color in xy space
Message-ID: <49227EED.2080304@ucsd.edu>

Hi,

I have run a metaMDS(vegan) on ecological community data and have a nice 
plot in xy space.
What I want to do next is to assign a unique color to each point in the 
plot and then look at how these communities map out in geographic space.
So, each corner of the plot has a color (let's say green, blue, red and 
yellow). I guess I have to ramp the colors for the space inbetween.
The right plot here illustrate how the palette should look like: 
http://www.flickr.com/photos/erniebooth/183647844/

Does anyone have experience in ramping four colours in 2-D? I looked at 
a lot of packages, but they are all not doing what I want.

Any hint / help is greatly appreciated!

Thanks,

Holger



From T.Hengl at uva.nl  Tue Nov 18 09:55:46 2008
From: T.Hengl at uva.nl (Tomislav Hengl)
Date: Tue, 18 Nov 2008 09:55:46 +0100
Subject: [R-sig-Geo] ramping four color in xy space
In-Reply-To: <49227EED.2080304@ucsd.edu>
References: <49227EED.2080304@ucsd.edu>
Message-ID: <AF2E678FF9484ACDAA5CF491DCDFD750@pcibed193>


Dear Holger,

This is a small script that uses [colorspace] library to run calculations with colors (some methods
are limited to 256 colors only):

http://spatial-analyst.net/scripts/whitening.R

If you assign R,G,B values spatially and then interpolate them (they have to be in the 0-1 range),
then it is relatively easy to produce an RGB image.

cheers,

Tom Hengl
http://spatial-analyst.net/wiki/index.php?title=Uncertainty_visualization 


PS: maybe you should also consider color mixing:

Hengl T., Walvoort D.J.J., Brown A. 2004. A double continuous approach to visualisation and analysis
of categorical maps. Int. Jou. of Geographical Information Science, 18(2): 183-202.
http://dx.doi.org/10.1080/13658810310001620924 


-----Original Message-----
From: r-sig-geo-bounces at stat.math.ethz.ch [mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of
Holger Kreft
Sent: Tuesday, November 18, 2008 9:38 AM
To: R-sig-Geo at stat.math.ethz.ch
Subject: [R-sig-Geo] ramping four color in xy space

Hi,

I have run a metaMDS(vegan) on ecological community data and have a nice 
plot in xy space.
What I want to do next is to assign a unique color to each point in the 
plot and then look at how these communities map out in geographic space.
So, each corner of the plot has a color (let's say green, blue, red and 
yellow). I guess I have to ramp the colors for the space inbetween.
The right plot here illustrate how the palette should look like: 
http://www.flickr.com/photos/erniebooth/183647844/

Does anyone have experience in ramping four colours in 2-D? I looked at 
a lot of packages, but they are all not doing what I want.

Any hint / help is greatly appreciated!

Thanks,

Holger

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch
https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From saldanha.plangeo at gmail.com  Wed Nov 19 00:57:19 2008
From: saldanha.plangeo at gmail.com (Raphael Saldanha)
Date: Tue, 18 Nov 2008 21:57:19 -0200
Subject: [R-sig-Geo] Spatial and temporal analysis
Message-ID: <c85849370811181557g591937cbub9dca9e40d90a25d@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081118/ddb9b932/attachment.pl>

From Scott.Waichler at pnl.gov  Wed Nov 19 07:10:57 2008
From: Scott.Waichler at pnl.gov (Waichler, Scott R)
Date: Tue, 18 Nov 2008 22:10:57 -0800
Subject: [R-sig-Geo] Classify x, y, z points based on upper-boundary surfaces
Message-ID: <12A8FC4D0563D1468AD23AAAED861A3E0BB626@EMAIL02.pnl.gov>

Hi,

I have surfaces in ascii grid format that represent the elevation of the
upper boundary of material types.  I have multiple ascii grid files, one
for each surface.  The ascii grid files have the same x, y origin and
discretization, but the elevations are continuous variables.  I would
like to create a 3D grid of material type, assigning a type for each x,
y, z location I define.  The correct type depends on where the point
fits in the "sandwich."  So it's a kind of overlay problem.

library(sp)

# Create some ascii grid files
asciigridfn <- c("surf1", "surf2", "surf3")
surfaces <- character(3)
surfaces[1] <- "ncols         4
nrows         3
xllcorner     0
yllcorner     0
cellsize      1
NODATA_value  -999
9.56  9.52  9.11  9.74
9.91 10.00  9.61  9.46
9.13  9.59  9.93  9.55
"
surfaces[2] <- "ncols         4
nrows         3
xllcorner     0
yllcorner     0
cellsize      1
NODATA_value  -999
6.81 6.06 6.42 6.41
6.93 -999 6.84 6.55
6.98 6.15 6.43 6.66
"
surfaces[3] <- "ncols         4
nrows         3
xllcorner     0
yllcorner     0
cellsize      1
NODATA_value  -999
3.82 3.83 3.92 3.28
3.74 3.28 3.26 3.42
3.88 3.69 3.34 3.91
"

# I write temporary files because I couldn't get textConnection() to
work here.
g <- list()
for(i in 1:3) {
  # Write the file
  cat(file=asciigridfn[i], surfaces[i])

  # Read it with read.asciigrid()
  g[[i]] <- read.asciigrid(asciigridfn[i])
}
unlink(asciigridfn)  # delete the files

# Define x, y, z coordinates for points to classify as type 1, 2, 3 or
NA.
# I seek a method to do the classification at each point (results
below).  
# Is there a way with sp?  It's a 3D overlay with some kind of melding
of list g.
# I can only think of a column-by-column analysis with findInterval().  
# My 2-D grids of surfaces have ~1e7 cells.
p1 <- c(0.5, 0.5, 3.5) # type 3
p2 <- c(0.5, 0.5, 3.9) # type 2
p3 <- c(1.5, 1.5, 11)  # type is NA; point located above highest surface
p4 <- c(1.5, 1.5, 4)   # type 1 (no type 2 at this x,y location)
p5 <- c(1.5, 1.5, 3)   # type 3

Thanks,
Scott Waichler
Pacific Northwest National Laboratory
scott.waichler at pnl.gov



From hkreft at ucsd.edu  Wed Nov 19 08:33:06 2008
From: hkreft at ucsd.edu (Holger Kreft)
Date: Tue, 18 Nov 2008 23:33:06 -0800
Subject: [R-sig-Geo] ramping four color in xy space
In-Reply-To: <AF2E678FF9484ACDAA5CF491DCDFD750@pcibed193>
References: <49227EED.2080304@ucsd.edu>
	<AF2E678FF9484ACDAA5CF491DCDFD750@pcibed193>
Message-ID: <4923C132.9080003@ucsd.edu>

Dear Tom,

Thanks a lot for your swift reply. While your script wasn't exactly 
doing what I wanted, it brought me on the right track. Here is the code 
that I finally used.
Probably not super elegant, but it does the job and I thought it be 
useful for others.

Cheers,

Holger

--

my.data<-seq(0,1,.01)

my.class<-classIntervals(my.data,n=100,style="equal")
my.pal.1<-findColours(my.class,c("yellow","red"))
my.pal.2<-findColours(my.class,c("green","blue"))

plot(rep(0,101),my.data,pch=19,col=my.pal.1, cex=1, xlim=c(0,1),ylim=c(0,1))
points(rep(1,101),my.data,pch=19,col=my.pal.2, cex=1)

#------------------------------------
# loop: use left and right vertical
# color ramp & interpolate horizontally
#------------------------------------

col.matrix<-matrix(nrow = 101, ncol = 101, NA)

for(i in 1:101){
my.col<-c(paste(my.pal.1[i]),paste(my.pal.2[i])) # choose colors
col.matrix[102-i,]<-findColours(my.class,my.col)
}

#------------------------------------
# plot full grid
#------------------------------------

plot(rep(0,101),my.data,pch=19,col=my.pal.1, cex=0.5, 
xlim=c(0,1),ylim=c(0,1))

for(i in 1:101){
col.temp<-col.matrix[i-1,]
points(my.data,rep((i-1)/100,101),pch=19,col=col.temp, cex=1)
}




Tomislav Hengl schrieb:
> Dear Holger,
>
> This is a small script that uses [colorspace] library to run calculations with colors (some methods
> are limited to 256 colors only):
>
> http://spatial-analyst.net/scripts/whitening.R
>
> If you assign R,G,B values spatially and then interpolate them (they have to be in the 0-1 range),
> then it is relatively easy to produce an RGB image.
>
> cheers,
>
> Tom Hengl
> http://spatial-analyst.net/wiki/index.php?title=Uncertainty_visualization 
>
>
> PS: maybe you should also consider color mixing:
>
> Hengl T., Walvoort D.J.J., Brown A. 2004. A double continuous approach to visualisation and analysis
> of categorical maps. Int. Jou. of Geographical Information Science, 18(2): 183-202.
> http://dx.doi.org/10.1080/13658810310001620924 
>
>
> -----Original Message-----
> From: r-sig-geo-bounces at stat.math.ethz.ch [mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of
> Holger Kreft
> Sent: Tuesday, November 18, 2008 9:38 AM
> To: R-sig-Geo at stat.math.ethz.ch
> Subject: [R-sig-Geo] ramping four color in xy space
>
> Hi,
>
> I have run a metaMDS(vegan) on ecological community data and have a nice 
> plot in xy space.
> What I want to do next is to assign a unique color to each point in the 
> plot and then look at how these communities map out in geographic space.
> So, each corner of the plot has a color (let's say green, blue, red and 
> yellow). I guess I have to ramp the colors for the space inbetween.
> The right plot here illustrate how the palette should look like: 
> http://www.flickr.com/photos/erniebooth/183647844/
>
> Does anyone have experience in ramping four colours in 2-D? I looked at 
> a lot of packages, but they are all not doing what I want.
>
> Any hint / help is greatly appreciated!
>
> Thanks,
>
> Holger
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>   


-- 
****************************************************************
Dr. Holger Kreft
Phone:  ++1-858-5346659
Email:  hkreft at ucsd.edu
www.uni-bonn.de/~uzsxeg
 
Ecology Behavior & Evolution Section
Division of Biological Sciences
University of California, San Diego
9500 Gilman Drive, MC 0116
La Jolla, CA 92093-0116, USA
http://www-biology.ucsd.edu/labs/jetz/



From Wayne.W.Jones at shell.com  Wed Nov 19 09:07:53 2008
From: Wayne.W.Jones at shell.com (Wayne.W.Jones at shell.com)
Date: Wed, 19 Nov 2008 09:07:53 +0100
Subject: [R-sig-Geo] Spatial and temporal analysis
In-Reply-To: <c85849370811181557g591937cbub9dca9e40d90a25d@mail.gmail.com>
Message-ID: <8E3590214E4380489D2F8BF129B939F329D3DE@amsdc1-s-03371.europe.shell.com>


Hi there, 


I can recomend the following text 

Hierarchical Modeling and Analysis for Spatial Data by Gelfland et al. 

Also there is a course being run in Southampton next year: 

http://www.s3ri.soton.ac.uk/courses/hierarchicalmodelling/

Regards

Wayne



-----Original Message-----
From: r-sig-geo-bounces at stat.math.ethz.ch
[mailto:r-sig-geo-bounces at stat.math.ethz.ch]On Behalf Of Raphael
Saldanha
Sent: 18 November 2008 23:57
To: r-sig-geo at stat.math.ethz.ch
Subject: [R-sig-Geo] Spatial and temporal analysis


Hi!
I'm looking for some introductory bibliography about modelling spatial and
temporal series for areal data. Recommendations?

-- 
King regards,

Raphael Saldanha
saldanha.plangeo at gmail.com

	[[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch
https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From marcelino.delacruz at upm.es  Wed Nov 19 11:57:37 2008
From: marcelino.delacruz at upm.es (Marcelino de la Cruz)
Date: Wed, 19 Nov 2008 11:57:37 +0100
Subject: [R-sig-Geo] ramping four color in xy space
In-Reply-To: <4923C132.9080003@ucsd.edu>
References: <49227EED.2080304@ucsd.edu>
	<AF2E678FF9484ACDAA5CF491DCDFD750@pcibed193>
	<4923C132.9080003@ucsd.edu>
Message-ID: <200811191057.mAJAvVlo014358@edison.ccupm.upm.es>

Nice plot!

It could be even more similar to  the one in 
http://www.flickr.com/photos/erniebooth/183647844/ 
if you substitute pch=15 for pch =19

Cheers,

Marcelino


At 08:33 19/11/2008, Holger Kreft wrote:
>Dear Tom,
>
>Thanks a lot for your swift reply. While your 
>script wasn't exactly doing what I wanted, it 
>brought me on the right track. Here is the code that I finally used.
>Probably not super elegant, but it does the job 
>and I thought it be useful for others.
>
>Cheers,
>
>Holger
>
>--
>
>my.data<-seq(0,1,.01)
>
>my.class<-classIntervals(my.data,n=100,style="equal")
>my.pal.1<-findColours(my.class,c("yellow","red"))
>my.pal.2<-findColours(my.class,c("green","blue"))
>
>plot(rep(0,101),my.data,pch=19,col=my.pal.1, cex=1, xlim=c(0,1),ylim=c(0,1))
>points(rep(1,101),my.data,pch=19,col=my.pal.2, cex=1)
>
>#------------------------------------
># loop: use left and right vertical
># color ramp & interpolate horizontally
>#------------------------------------
>
>col.matrix<-matrix(nrow = 101, ncol = 101, NA)
>
>for(i in 1:101){
>my.col<-c(paste(my.pal.1[i]),paste(my.pal.2[i])) # choose colors
>col.matrix[102-i,]<-findColours(my.class,my.col)
>}
>
>#------------------------------------
># plot full grid
>#------------------------------------
>
>plot(rep(0,101),my.data,pch=19,col=my.pal.1, cex=0.5, xlim=c(0,1),ylim=c(0,1))
>
>for(i in 1:101){
>col.temp<-col.matrix[i-1,]
>points(my.data,rep((i-1)/100,101),pch=19,col=col.temp, cex=1)
>}
>
>
>
>
>Tomislav Hengl schrieb:
>>Dear Holger,
>>
>>This is a small script that uses [colorspace] 
>>library to run calculations with colors (some methods
>>are limited to 256 colors only):
>>
>>http://spatial-analyst.net/scripts/whitening.R
>>
>>If you assign R,G,B values spatially and then 
>>interpolate them (they have to be in the 0-1 range),
>>then it is relatively easy to produce an RGB image.
>>
>>cheers,
>>
>>Tom Hengl
>>http://spatial-analyst.net/wiki/index.php?title=Uncertainty_visualization
>>
>>PS: maybe you should also consider color mixing:
>>
>>Hengl T., Walvoort D.J.J., Brown A. 2004. A 
>>double continuous approach to visualisation and analysis
>>of categorical maps. Int. Jou. of Geographical 
>>Information Science, 18(2): 183-202.
>>http://dx.doi.org/10.1080/13658810310001620924
>>
>>-----Original Message-----
>>From: r-sig-geo-bounces at stat.math.ethz.ch 
>>[mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of
>>Holger Kreft
>>Sent: Tuesday, November 18, 2008 9:38 AM
>>To: R-sig-Geo at stat.math.ethz.ch
>>Subject: [R-sig-Geo] ramping four color in xy space
>>
>>Hi,
>>
>>I have run a metaMDS(vegan) on ecological 
>>community data and have a nice plot in xy space.
>>What I want to do next is to assign a unique 
>>color to each point in the plot and then look 
>>at how these communities map out in geographic space.
>>So, each corner of the plot has a color (let's 
>>say green, blue, red and yellow). I guess I 
>>have to ramp the colors for the space inbetween.
>>The right plot here illustrate how the palette 
>>should look like: http://www.flickr.com/photos/erniebooth/183647844/
>>
>>Does anyone have experience in ramping four 
>>colours in 2-D? I looked at a lot of packages, 
>>but they are all not doing what I want.
>>
>>Any hint / help is greatly appreciated!
>>
>>Thanks,
>>
>>Holger
>>
>>_______________________________________________
>>R-sig-Geo mailing list
>>R-sig-Geo at stat.math.ethz.ch
>>https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>_______________________________________________
>>R-sig-Geo mailing list
>>R-sig-Geo at stat.math.ethz.ch
>>https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>
>
>--
>****************************************************************
>Dr. Holger Kreft
>Phone:  ++1-858-5346659
>Email:  hkreft at ucsd.edu
>www.uni-bonn.de/~uzsxeg
>Ecology Behavior & Evolution Section
>Division of Biological Sciences
>University of California, San Diego
>9500 Gilman Drive, MC 0116
>La Jolla, CA 92093-0116, USA
>http://www-biology.ucsd.edu/labs/jetz/
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at stat.math.ethz.ch
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>---------------------------------------------------------------------------------------------------
>Texto a?adido por Panda IS 2008:
>
>Este mensaje NO ha sido clasificado como SPAM. 
>Si se trata de un mensaje de correo no 
>solicitado (SPAM), haz clic en el siguiente 
>v?nculo para reclasificarlo: 
>http://localhost:6083/Panda?ID=pav_2562&SPAM=true&path=C:\Documents%20and%20Settings\mcr\Configuraci?n%20local\Datos%20de%20programa\Panda%20Software\AntiSpam
>---------------------------------------------------------------------------------------------------

________________________________

Marcelino de la Cruz Rot

Departamento de  Biolog?a Vegetal
E.U.T.I. Agr?cola
Universidad Polit?cnica de Madrid
28040-Madrid
Tel.: 91 336 54 35
Fax: 91 336 56 56
marcelino.delacruz at upm.es



From jean-paul.kibambe at uclouvain.be  Wed Nov 19 16:39:01 2008
From: jean-paul.kibambe at uclouvain.be (Jean-Paul Kibambe Lubamba)
Date: Wed, 19 Nov 2008 16:39:01 +0100 (CET)
Subject: [R-sig-Geo] Correlation between GWR local coefficient estimates
Message-ID: <3a3242bd79cf99fffad08b921e549895.squirrel@mmp.sipr-dc.ucl.ac.be>

Dear All,

After running a GWR model, I have my local coefficient estimates and I
would like to test if there is any correlation between the local
coefficients. So, it will be great if I could map the pattern of local
coefficient correlations or make a histogram of it.

Anyone could help me ?

Thanks in advance,


Jean-Paul



From alessandro.montaghi at unifi.it  Wed Nov 19 20:33:46 2008
From: alessandro.montaghi at unifi.it (Alessandro)
Date: Wed, 19 Nov 2008 11:33:46 -0800
Subject: [R-sig-Geo] calculate geometric mean of mass of points
Message-ID: <001801c94a7d$beb06b10$3c114130$@montaghi@unifi.it>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081119/4ccc9799/attachment.pl>

From ashton at msu.edu  Wed Nov 19 21:04:02 2008
From: ashton at msu.edu (Ashton Shortridge)
Date: Wed, 19 Nov 2008 15:04:02 -0500
Subject: [R-sig-Geo] calculate geometric mean of mass of points
In-Reply-To: <001801c94a7d$beb06b10$3c114130$@montaghi@unifi.it>
References: <001801c94a7d$beb06b10$3c114130$@montaghi@unifi.it>
Message-ID: <200811191504.02643.ashton@msu.edu>

On Wednesday 19 November 2008 02:33:46 pm Alessandro wrote:
> I have a points shape and I wish to calculate the geometric centre of this
> points shape and create a new points with R. But It's over my knowledge. Is
> there suggestions?

This seems straightforward, even if it is not implemented in a package. 
Wikipedia has some basic info on the geometric mean:
http://en.wikipedia.org/wiki/Geometric_mean

All you seem to have to do is read the shapefile in, grab the x's and y's in 
two vector (called, say, x and y) and then:
totalX <- 1
for(i in x) {totalX <- totalX * i}
totalY <- 1
for(i in y) {totalY <- totalY * i}

geomnX <- totalX^(1/length(x))
geomnY <- totalY^(1/length(y))

You could then make an sp object out of this pair and export it as a 
shapefile, if you wished.

There is probably something slick you could do with lapply or something to 
avoid the for loops in the code above, but I'm doing this off the top of my 
head.

Also note that if any of your coordinate values are zero then the mean will be 
zero and may not represent a centered value very well. Also note that 
negative coordinate values are problematic. This solution assumes that all 
your coordinates are positive.

Yours,

Ashton

On Wednesday 19 November 2008 02:33:46 pm Alessandro wrote:
> Hi all,
>
>
>
> I have a points shape and I wish to calculate the geometric centre of this
> points shape and create a new points with R. But It's over my knowledge. Is
> there suggestions?
>
>
>
> Thanks
>
>
>
> Ale



From debeaudette at ucdavis.edu  Wed Nov 19 21:22:51 2008
From: debeaudette at ucdavis.edu (Dylan Beaudette)
Date: Wed, 19 Nov 2008 12:22:51 -0800
Subject: [R-sig-Geo] calculate geometric mean of mass of points
In-Reply-To: <200811191504.02643.ashton@msu.edu>
References: <001801c94a7d$beb06b10$3c114130$@montaghi@unifi.it>
	<200811191504.02643.ashton@msu.edu>
Message-ID: <200811191222.51058.dylan.beaudette@gmail.com>

On Wednesday 19 November 2008, Ashton Shortridge wrote:
> On Wednesday 19 November 2008 02:33:46 pm Alessandro wrote:
> > I have a points shape and I wish to calculate the geometric centre of
> > this points shape and create a new points with R. But It's over my
> > knowledge. Is there suggestions?
>
> This seems straightforward, even if it is not implemented in a package.
> Wikipedia has some basic info on the geometric mean:
> http://en.wikipedia.org/wiki/Geometric_mean
>
> All you seem to have to do is read the shapefile in, grab the x's and y's
> in two vector (called, say, x and y) and then:
> totalX <- 1
> for(i in x) {totalX <- totalX * i}
> totalY <- 1
> for(i in y) {totalY <- totalY * i}
>
> geomnX <- totalX^(1/length(x))
> geomnY <- totalY^(1/length(y))
>
> You could then make an sp object out of this pair and export it as a
> shapefile, if you wished.
>
> There is probably something slick you could do with lapply or something to
> avoid the for loops in the code above, but I'm doing this off the top of my
> head.
>
> Also note that if any of your coordinate values are zero then the mean will
> be zero and may not represent a centered value very well. Also note that
> negative coordinate values are problematic. This solution assumes that all
> your coordinates are positive.
>
> Yours,
>
> Ashton

Here is another solution, based on the definition of the geometric mean 
w/respect to logarithms. 

geom-mean = e^{ 1/n * sum{ln x} }


# only works for positive coordinates !!
x <- runif(n=100, min=1, max=100) ; y <- runif(n=100, min=1, max=100)

# plot points
plot(x,y)

# plot the arithmetic mean point
points(mean(x), mean(y), pch=16, col='red')

# plot the geometric mean point
points(exp(mean(log(x))), exp(mean(log(y))), pch=16, col='blue')

Dylan


-- 
Dylan Beaudette
Soil Resource Laboratory
http://casoilresource.lawr.ucdavis.edu/
University of California at Davis
530.754.7341



From b.rowlingson at lancaster.ac.uk  Wed Nov 19 22:05:59 2008
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed, 19 Nov 2008 21:05:59 +0000
Subject: [R-sig-Geo] calculate geometric mean of mass of points
In-Reply-To: <200811191222.51058.dylan.beaudette@gmail.com>
References: <200811191504.02643.ashton@msu.edu>
	<200811191222.51058.dylan.beaudette@gmail.com>
Message-ID: <d8ad40b50811191305y2d5e4ca3ob01db44171da1044@mail.gmail.com>

2008/11/19 Dylan Beaudette <debeaudette at ucdavis.edu>:
> On Wednesday 19 November 2008, Ashton Shortridge wrote:
>> On Wednesday 19 November 2008 02:33:46 pm Alessandro wrote:
>> > I have a points shape and I wish to calculate the geometric centre of
>> > this points shape and create a new points with R. But It's over my
>> > knowledge. Is there suggestions?
>>
>> This seems straightforward, even if it is not implemented in a package.
>> Wikipedia has some basic info on the geometric mean:
>> http://en.wikipedia.org/wiki/Geometric_mean
>>
>> All you seem to have to do is read the shapefile in, grab the x's and y's
>> in two vector (called, say, x and y) and then:
>> totalX <- 1
>> for(i in x) {totalX <- totalX * i}
>> totalY <- 1
>> for(i in y) {totalY <- totalY * i}
>>
>> geomnX <- totalX^(1/length(x))
>> geomnY <- totalY^(1/length(y))
>>
>> You could then make an sp object out of this pair and export it as a
>> shapefile, if you wished.
>>
>> There is probably something slick you could do with lapply or something to
>> avoid the for loops in the code above, but I'm doing this off the top of my
>> head.
>>
>> Also note that if any of your coordinate values are zero then the mean will
>> be zero and may not represent a centered value very well. Also note that
>> negative coordinate values are problematic. This solution assumes that all
>> your coordinates are positive.
>>

 I have a feeling the original poster really wants to compute the
_centroid_, not the geometric mean of the coordinates. The phrase
"geometric centre of this points shape" sounds more like the centroid
than the geometric mean of the coordinate values.

 The centroid is the 'centre of mass' of a polygon - the point where a
cardboard cutout of the polygon would balance.

 The maptools package has a function for computing the centroids of
polygons - install that and try help.search("centroid").

 Otherwise it's quite easy to compute yourself, google for algorithms.
Note it is NOT just the mean of the coordinates!

Barry



From giohappy at gmail.com  Wed Nov 19 22:13:39 2008
From: giohappy at gmail.com (G. Allegri)
Date: Wed, 19 Nov 2008 22:13:39 +0100
Subject: [R-sig-Geo] calculate geometric mean of mass of points
In-Reply-To: <d8ad40b50811191305y2d5e4ca3ob01db44171da1044@mail.gmail.com>
References: <200811191504.02643.ashton@msu.edu>
	<200811191222.51058.dylan.beaudette@gmail.com>
	<d8ad40b50811191305y2d5e4ca3ob01db44171da1044@mail.gmail.com>
Message-ID: <e12429640811191313w34cf80c3n90501fdf3ff5a003@mail.gmail.com>

>  The maptools package has a function for computing the centroids of
> polygons - install that and try help.search("centroid").

x <- read.shape(system.file("shapes/sids.shp", package="maptools")
mycentroid <- get.Pcent(x)



From alessandro.montaghi at unifi.it  Wed Nov 19 22:40:06 2008
From: alessandro.montaghi at unifi.it (Alessandro)
Date: Wed, 19 Nov 2008 13:40:06 -0800
Subject: [R-sig-Geo] problem with loop formula in my analysis
Message-ID: <003d01c94a8f$64768f00$2d63ad00$@montaghi@unifi.it>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081119/790f3374/attachment.pl>

From giohappy at gmail.com  Wed Nov 19 23:03:14 2008
From: giohappy at gmail.com (G. Allegri)
Date: Wed, 19 Nov 2008 23:03:14 +0100
Subject: [R-sig-Geo] problem with loop formula in my analysis
In-Reply-To: <-7140641123266741595@unknownmsgid>
References: <-7140641123266741595@unknownmsgid>
Message-ID: <e12429640811191403p2b6659dak80517fd69379fa5b@mail.gmail.com>

Alessandro,
I suggest to read some startup tutorials before asking in ML.
Anyway you can do this:

 for(i in 1:500){
cp <- paste(sep="","centre_plot",i)
coordinates(cp) =~X+Y
proj4string(cp) <- CRS("+init=epsg:26911")
writeOGR(cp["Z"], paste(sep="",cp,".shp"), cp,driver="ESRI Shapefile")
}



2008/11/19 Alessandro <alessandro.montaghi at unifi.it>:
> Hi All,
>
> I read a lot about loop formula but this morning I tried to applied the loop
> for the following formulas
>
> I know it's easy for an expertise, but sorry I am working with R in this
> mounts and I change completely my GIS philosophy.
>
>
>
> Thanks for help
>
>
>
> give a coordinates attribution
>
>
>
> coordinates(centre_plot1) =~X+Y
>
> coordinates(centre_plot2) =~X+Y
>
> coordinates(centre_plot3) =~X+Y
>
> coordinates(centre_plot4) =~X+Y
>
> ......................
>
> .....................
>
> (I HAVE 500 plot)
>
>
>
> proj4string(centre_plot1) <- CRS("+init=epsg:26911")
>
> proj4string(centre_plot2) <- CRS("+init=epsg:26911")
>
> proj4string(centre_plot3) <- CRS("+init=epsg:26911")
>
> proj4string(centre_plot4) <- CRS("+init=epsg:26911")
>
>
>
> writeOGR(centre_plot1 ["Z"], " centre_plot1.shp", " centre_plot1",
> driver="ESRI Shapefile")
>
> writeOGR(centre_plot2 ["Z"], " centre_plot2.shp", " centre_plot2",
> driver="ESRI Shapefile")
>
> writeOGR(centre_plot3 ["Z"], " centre_plot3.shp", " centre_plot3",
> driver="ESRI Shapefile")
>
> writeOGR(centre_plot4 ["Z"], " centre_plot4.shp", " centre_plot4",
> driver="ESRI Shapefile")
>
>
>
> Ale
>
>
>        [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



From giohappy at gmail.com  Wed Nov 19 23:14:15 2008
From: giohappy at gmail.com (G. Allegri)
Date: Wed, 19 Nov 2008 23:14:15 +0100
Subject: [R-sig-Geo] problem with loop formula in my analysis
In-Reply-To: <e12429640811191403p2b6659dak80517fd69379fa5b@mail.gmail.com>
References: <-7140641123266741595@unknownmsgid>
	<e12429640811191403p2b6659dak80517fd69379fa5b@mail.gmail.com>
Message-ID: <e12429640811191414y6a9997f4u4c20258f7eac0a94@mail.gmail.com>

A correction.
cp["Z"] should be get(cp)[z], to evaluate the string to a variable name...

2008/11/19 G. Allegri <giohappy at gmail.com>:
> Alessandro,
> I suggest to read some startup tutorials before asking in ML.
> Anyway you can do this:
>
>  for(i in 1:500){
> cp <- paste(sep="","centre_plot",i)
> coordinates(cp) =~X+Y
> proj4string(cp) <- CRS("+init=epsg:26911")
> writeOGR(cp["Z"], paste(sep="",cp,".shp"), cp,driver="ESRI Shapefile")
> }
>
>
>
> 2008/11/19 Alessandro <alessandro.montaghi at unifi.it>:
>> Hi All,
>>
>> I read a lot about loop formula but this morning I tried to applied the loop
>> for the following formulas
>>
>> I know it's easy for an expertise, but sorry I am working with R in this
>> mounts and I change completely my GIS philosophy.
>>
>>
>>
>> Thanks for help
>>
>>
>>
>> give a coordinates attribution
>>
>>
>>
>> coordinates(centre_plot1) =~X+Y
>>
>> coordinates(centre_plot2) =~X+Y
>>
>> coordinates(centre_plot3) =~X+Y
>>
>> coordinates(centre_plot4) =~X+Y
>>
>> ......................
>>
>> .....................
>>
>> (I HAVE 500 plot)
>>
>>
>>
>> proj4string(centre_plot1) <- CRS("+init=epsg:26911")
>>
>> proj4string(centre_plot2) <- CRS("+init=epsg:26911")
>>
>> proj4string(centre_plot3) <- CRS("+init=epsg:26911")
>>
>> proj4string(centre_plot4) <- CRS("+init=epsg:26911")
>>
>>
>>
>> writeOGR(centre_plot1 ["Z"], " centre_plot1.shp", " centre_plot1",
>> driver="ESRI Shapefile")
>>
>> writeOGR(centre_plot2 ["Z"], " centre_plot2.shp", " centre_plot2",
>> driver="ESRI Shapefile")
>>
>> writeOGR(centre_plot3 ["Z"], " centre_plot3.shp", " centre_plot3",
>> driver="ESRI Shapefile")
>>
>> writeOGR(centre_plot4 ["Z"], " centre_plot4.shp", " centre_plot4",
>> driver="ESRI Shapefile")
>>
>>
>>
>> Ale
>>
>>
>>        [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>



From Kamran.Safi at ioz.ac.uk  Wed Nov 19 23:35:06 2008
From: Kamran.Safi at ioz.ac.uk (Kamran Safi)
Date: Wed, 19 Nov 2008 22:35:06 -0000
Subject: [R-sig-Geo] problem with loop formula in my analysis
References: <-7140641123266741595@unknownmsgid><e12429640811191403p2b6659dak80517fd69379fa5b@mail.gmail.com>
	<e12429640811191414y6a9997f4u4c20258f7eac0a94@mail.gmail.com>
Message-ID: <41E1ED29E5E8E34BBDD8B82CFA1A9D0405F985AA@zsl26>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081119/96b8ef5a/attachment.pl>

From haering at lwf.uni-muenchen.de  Thu Nov 20 11:23:53 2008
From: haering at lwf.uni-muenchen.de (=?ISO-8859-1?Q?Tim_H=E4ring?=)
Date: Thu, 20 Nov 2008 11:23:53 +0100
Subject: [R-sig-Geo] Spatial Join Point and Polygon
Message-ID: <492548C9.2060.81C427@haering.lwf.uni-muenchen.de>

Hi geolist,

I am trying to add attribute values of a polygon layer to an overlying point layer. But I didn`t 
find a way to do this so far. I tried for example the pick.from.shapefile command in the 
RSAGA package, but I wasn`t successful.
Any ideas?

Thanks a lot
TIM

-- 
Dipl.-Geogr. Tim H?ring
Sachgebiet Standort und Bodenschutz (SG 2.1)
Bayerische Landesanstalt f?r Wald und Forstwirtschaft
Am Hochanger 11
D-85354 Freising

E-Mail: haering at lwf.uni-muenchen.de
http://www.lwf.bayern.de



From virginia at dpi.inpe.br  Thu Nov 20 11:28:15 2008
From: virginia at dpi.inpe.br (Virginia)
Date: Thu, 20 Nov 2008 08:28:15 -0200
Subject: [R-sig-Geo] using gwr
In-Reply-To: <49198355.6020808@dpi.inpe.br>
References: <49198355.6020808@dpi.inpe.br>
Message-ID: <49253BBF.2050907@dpi.inpe.br>

Hi list,

I would like to know if R does kernel smooth with borders restriction.

Virginia



From Mikael.Carlsson at sgu.se  Thu Nov 20 13:20:43 2008
From: Mikael.Carlsson at sgu.se (Mikael Carlsson)
Date: Thu, 20 Nov 2008 13:20:43 +0100
Subject: [R-sig-Geo] Missing library
Message-ID: <OFFB69A247.C882F4D3-ONC1257507.0042C357-C1257507.0043D5FF@sgu.se>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081120/c720d079/attachment.pl>

From Roger.Bivand at nhh.no  Thu Nov 20 13:29:50 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 20 Nov 2008 13:29:50 +0100 (CET)
Subject: [R-sig-Geo] using gwr
In-Reply-To: <49253BBF.2050907@dpi.inpe.br>
References: <49198355.6020808@dpi.inpe.br> <49253BBF.2050907@dpi.inpe.br>
Message-ID: <alpine.LRH.2.00.0811201322070.20142@reclus.nhh.no>

On Thu, 20 Nov 2008, Virginia wrote:

> Hi list,
>
> I would like to know if R does kernel smooth with borders restriction.

Please use the list as described in the posting guide for all R lists:

http://www.r-project.org/posting-guide.html

You have asked a new question, but have not started a new thread, so the 
subject of your question is not connected with the question, but continues 
the thread you started 10 days ago. New questions should start a new 
thread, which means writing a fresh message, not replying to an existing 
message. Changing the subject does not help either.

Your question seems to be about point pattern analysis. Please see the 
spatial task view on CRAN - you will see that there is some information 
there that may help. When you have consulted that information, start a new 
thread if you still need help, with a clear description of your problem.

Hope this helps

Roger

>
> Virginia
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Roger.Bivand at nhh.no  Thu Nov 20 13:35:50 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 20 Nov 2008 13:35:50 +0100 (CET)
Subject: [R-sig-Geo] Missing library
In-Reply-To: <OFFB69A247.C882F4D3-ONC1257507.0042C357-C1257507.0043D5FF@sgu.se>
References: <OFFB69A247.C882F4D3-ONC1257507.0042C357-C1257507.0043D5FF@sgu.se>
Message-ID: <alpine.LRH.2.00.0811201330570.20142@reclus.nhh.no>

On Thu, 20 Nov 2008, Mikael Carlsson wrote:

> Hello!
>
> I'm running R2.8.0 , Solaris and a Sparc machine
>
> Get the following error, and don't know what to do...

The problem is in loading spatstat. Can you load spatstat manually:

library(spatstat)

When that works, the coercion should work too. I expect that spatstat 
isn't installed adequately (built against an older version of some 
library, probably the g++ runtime library from googling on the missing 
function).

Roger

>
> Regards,
> Mikael
> - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
> - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
> - - - - - - - - - - - - - - - - - - - - - -
> library(akima)
> library(maptools)
> library(sp)
>
> cumark <- read.table("sydnorr5000.txt", header=T, sep = ";")
> attach(cumark)
> vew <- as.vector(ew)
> vns <- as.vector(ns)
> vcu <- as.vector(cu)
>
> fcumark <- data.frame(vew, vns, vcu)
>
> coordinates(fcumark) <- ~vew+vns
>
> L1 <-round((max(vew)- min(vew))/100,0)
> L2 <-round((max(vns)- min(vns))/100,0)
>
>
> fcumark.interp.old <- interp.old(vew, vns, vcu,
>                xo= seq(min(vew), max(vew), length = L1),
>                yo= seq(min(vns), max(vns), length = L2),
>                ncp = 0,
>                extrap= FALSE,
>                duplicate = "mean",
>                dupfun = NULL)
>
> fcumark.interp.old.grid <-
> as.SpatialGridDataFrame.im(as.im(fcumark.interp.old))
>
> Loading required package: deldir
> deldir 0.0-7
> Error in dyn.load(file, DLLpath = DLLpath, ...) :
>  unable to load shared library
> '/usr/local/R-2.8.0/lib/R/library/spatstat/libs/spatstat.so':
>  ld.so.1: R: fatal: relocation error: file
> /usr/local/R-2.8.0/lib/R/library/spatstat/libs/spatstat.so: symbol
> __gxx_personality_v0: referenced symbol not found
> Error in as.SpatialGridDataFrame.im(as.im(fcumark.interp.old)) :
>  could not find function "as.im"
>
> (program stop!)
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Mikael.Carlsson at sgu.se  Thu Nov 20 13:42:54 2008
From: Mikael.Carlsson at sgu.se (Mikael Carlsson)
Date: Thu, 20 Nov 2008 13:42:54 +0100
Subject: [R-sig-Geo] Ang. Re:  Missing library
In-Reply-To: <alpine.LRH.2.00.0811201330570.20142@reclus.nhh.no>
Message-ID: <OFB13E5F9C.450801AA-ONC1257507.00455EBE-C1257507.0045DDBE@sgu.se>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081120/1c3ba956/attachment.pl>

From Roger.Bivand at nhh.no  Thu Nov 20 14:17:48 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 20 Nov 2008 14:17:48 +0100 (CET)
Subject: [R-sig-Geo] Ang. Re:  Missing library
In-Reply-To: <OFB13E5F9C.450801AA-ONC1257507.00455EBE-C1257507.0045DDBE@sgu.se>
References: <OFB13E5F9C.450801AA-ONC1257507.00455EBE-C1257507.0045DDBE@sgu.se>
Message-ID: <alpine.LRH.2.00.0811201416300.20142@reclus.nhh.no>

On Thu, 20 Nov 2008, Mikael Carlsson wrote:

> Couldn't load using library(spatstat)
> got this error:
>> library(spatstat)
> Error in dyn.load(file, DLLpath = DLLpath, ...) :
>  unable to load shared library
> '/usr/local/R-2.8.0/lib/R/library/spatstat/libs/spatstat.so':
>  ld.so.1: R: fatal: relocation error: file
> /usr/local/R-2.8.0/lib/R/library/spatstat/libs/spatstat.so: symbol
> __gxx_personality_v0: referenced symbol not found

As I wrote earlier, resolve this problem first. I suggest reinstalling 
spatstat on your current system - you have most likely updated the g++ 
libraries since spatstat was installed.

Roger

> Error in library(spatstat) : .First.lib failed for 'spatstat'
>>
>
> Regards,
> /M
>
>
>
> Roger Bivand <Roger.Bivand at nhh.no>
> 2008-11-20 13:33
> S?nd svar till
> Roger.Bivand at nhh.no
>
>
> Till
> Mikael Carlsson <Mikael.Carlsson at sgu.se>
> Kopia
> r-sig-geo at stat.math.ethz.ch
> ?rende
> Re: [R-sig-Geo] Missing library
>
>
>
>
>
>
> On Thu, 20 Nov 2008, Mikael Carlsson wrote:
>
>> Hello!
>>
>> I'm running R2.8.0 , Solaris and a Sparc machine
>>
>> Get the following error, and don't know what to do...
>
> The problem is in loading spatstat. Can you load spatstat manually:
>
> library(spatstat)
>
> When that works, the coercion should work too. I expect that spatstat
> isn't installed adequately (built against an older version of some
> library, probably the g++ runtime library from googling on the missing
> function).
>
> Roger
>
>>
>> Regards,
>> Mikael
>> - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
> -
>> - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
> -
>> - - - - - - - - - - - - - - - - - - - - - -
>> library(akima)
>> library(maptools)
>> library(sp)
>>
>> cumark <- read.table("sydnorr5000.txt", header=T, sep = ";")
>> attach(cumark)
>> vew <- as.vector(ew)
>> vns <- as.vector(ns)
>> vcu <- as.vector(cu)
>>
>> fcumark <- data.frame(vew, vns, vcu)
>>
>> coordinates(fcumark) <- ~vew+vns
>>
>> L1 <-round((max(vew)- min(vew))/100,0)
>> L2 <-round((max(vns)- min(vns))/100,0)
>>
>>
>> fcumark.interp.old <- interp.old(vew, vns, vcu,
>>                xo= seq(min(vew), max(vew), length = L1),
>>                yo= seq(min(vns), max(vns), length = L2),
>>                ncp = 0,
>>                extrap= FALSE,
>>                duplicate = "mean",
>>                dupfun = NULL)
>>
>> fcumark.interp.old.grid <-
>> as.SpatialGridDataFrame.im(as.im(fcumark.interp.old))
>>
>> Loading required package: deldir
>> deldir 0.0-7
>> Error in dyn.load(file, DLLpath = DLLpath, ...) :
>>  unable to load shared library
>> '/usr/local/R-2.8.0/lib/R/library/spatstat/libs/spatstat.so':
>>  ld.so.1: R: fatal: relocation error: file
>> /usr/local/R-2.8.0/lib/R/library/spatstat/libs/spatstat.so: symbol
>> __gxx_personality_v0: referenced symbol not found
>> Error in as.SpatialGridDataFrame.im(as.im(fcumark.interp.old)) :
>>  could not find function "as.im"
>>
>> (program stop!)
>>
>>                [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From aloboaleu at gmail.com  Thu Nov 20 14:48:16 2008
From: aloboaleu at gmail.com (Agustin Lobo)
Date: Thu, 20 Nov 2008 14:48:16 +0100
Subject: [R-sig-Geo] shp (produced with QGIS) into R: missing first field?
Message-ID: <49256AA0.50107@gmail.com>

When I inspect the table of a shp in QGIS I can see a field
"id" with unique values for each row (polygon), but
once I import it into R, that first field is not there:

 > metrop1spdf <- readOGR("/media/IOMEGA 
HDD/Mario/BCNmetrop/GEODATA_BCN/Shape_final2c", layer="SHAPE_FINAL2C")
OGR data source with driver: ESRI Shapefile
Source: "/media/IOMEGA HDD/Mario/BCNmetrop/GEODATA_BCN/Shape_final2c", 
layer: "SHAPE_FINAL2C"
with  3272  rows and  49  columns
 > save.image()
 > str(metrop1spdf,2)
Formal class 'SpatialPolygonsDataFrame' [package "sp"] with 5 slots
   ..@ data       :'data.frame':	3272 obs. of  49 variables:
   ..@ polygons   :List of 3272
   ..@ plotOrder  : int [1:3272] 703 1501 140 1467 1416 1336 82 2127 
2796 1387 ...
   ..@ bbox       : num [1:2, 1:2] 421333 4576848 438994 4593850
   .. ..- attr(*, "dimnames")=List of 2
   ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slots
 > str(metrop1spdf at data)
'data.frame':	3272 obs. of  49 variables:
  $ FID_inters: int  0 0 1 1 2 3 4 5 6 7 ...
  $ FID_UC    : int  0 0 0 0 0 0 0 0 0 0 ...
  $ ID_GRAFIC : int  1 1 1 1 1 1 1 1 1 1 ...
  $ N_VERTEXS : int  5770 5770 5770 5770 5770 5770 5770 5770 5770 5770 ...
  $ PERIMETRE : num  191741 191741 191741 191741 191741 ...
  $ PERIMETREE: num  191807 191807 191807 191807 191807 ...
  $ AREA      : num  4444 276 5364 790 3935 ...
etc

As I want to operate with that table in R (which implies merging with 
other DF) and produce
a new SPDF and export to shp, I worry for not having that field.
Or is it somehow implied in R? I'm surprised by the fact
that the first value in the id field in QGIS is 0 and not 1. I
think that such an id in R would start by 1, am I wrong?

Agus

-- 
Dr. Agustin Lobo
Institut de Ciencies de la Terra "Jaume Almera" (CSIC)
LLuis Sole Sabaris s/n
08028 Barcelona
Spain
Tel. 34 934095410
Fax. 34 934110012
email: Agustin.Lobo at ija.csic.es
http://www.ija.csic.es/gt/obster



From webmaster at xen.net  Sat Nov 22 09:53:46 2008
From: webmaster at xen.net ([Ricardo Rodriguez] Your XEN ICT Team)
Date: Sat, 22 Nov 2008 09:53:46 +0100
Subject: [R-sig-Geo] examples
Message-ID: <4927C89A.60204@xen.net>

Hi all!

I am just trying to show how R could be also an powerful tool in the
sig-geo arena.

Please, could anybody be so kind as to pointing to me to any nice free
example out there? I've been some 3-D rendered surfaces here and there, 
but I don't know where, if possible, could I find their data and code. 
Thanks for your help!

All the best,

Ricardo

-- 
Ricardo Rodr?guez
Your XEN ICT Team



From hi_ono2001 at ybb.ne.jp  Sat Nov 22 10:10:37 2008
From: hi_ono2001 at ybb.ne.jp (Hisaji ONO)
Date: Sat, 22 Nov 2008 18:10:37 +0900 (JST)
Subject: [R-sig-Geo] WMS, WFS, WCS an WPS for R
Message-ID: <20081122091037.96631.qmail@web10714.mail.bbt.yahoo.co.jp>

Hello.

 There are lots of services of OGC(Open Geospatial
Consortium:http://www.opengeospatial.org/)'s standard
based Geo-Web ervices incluing WMS(Web Map Service),
WFS(Web Feature Service), WCS(Web Coverage Service) and
WPS(Web Processing Service) all over the world.

 Does anyone try to use these services from R?



 Regards



From b.rowlingson at lancaster.ac.uk  Sat Nov 22 10:35:32 2008
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Sat, 22 Nov 2008 09:35:32 +0000
Subject: [R-sig-Geo] WMS, WFS, WCS an WPS for R
In-Reply-To: <20081122091037.96631.qmail@web10714.mail.bbt.yahoo.co.jp>
References: <20081122091037.96631.qmail@web10714.mail.bbt.yahoo.co.jp>
Message-ID: <d8ad40b50811220135p6a32a0e3p658d78541db074b8@mail.gmail.com>

2008/11/22 Hisaji ONO <hi_ono2001 at ybb.ne.jp>:
> Hello.
>
>  There are lots of services of OGC(Open Geospatial
> Consortium:http://www.opengeospatial.org/)'s standard
> based Geo-Web ervices incluing WMS(Web Map Service),
> WFS(Web Feature Service), WCS(Web Coverage Service) and
> WPS(Web Processing Service) all over the world.
>
>  Does anyone try to use these services from R?

 Any access to WMS and WFS would probably be best done using GDAL and
OGR via the rgdal package.... Let's see...

 GDAL has a WMS driver, but it seems you do have to create a 'local
service description' file. www.gdal.org seems down at the moment, so
here's a google cache link:

http://216.239.59.132/search?q=cache:21OOLtr9yj0J:www.gdal.org/frmt_wms.html+gdal+wms&hl=en&ct=clnk&cd=1&gl=uk

 For WFS, there's some recent discussion on the gdal-dev list:

http://www.nabble.com/OGR-WFS-driver-td20485363.html

 so it might be coming soon. Can you wait?

 To do WFS from scratch in R is probably going to need XML parsing,
and then it'll probably also need OGR too unless you want to hand-code
understanding the returned GML...

Barry



From OleF.Christensen at agrsci.dk  Sat Nov 22 11:24:36 2008
From: OleF.Christensen at agrsci.dk (Ole Fredslund Christensen)
Date: Sat, 22 Nov 2008 11:24:36 +0100
Subject: [R-sig-Geo] fit.lmc in gstat - fit same range
Message-ID: <EA09C4B2B0F16E44B8F3311629493C0D02D76D98@DJFPOST01.djf.agrsci.dk>



Dear experts

I'm in the middle of giving a course on geostatistics and GIS (I am doing the geostatistics part, 
someone else the GIS part). We are using Webster and Oliver as text book.

I am considering to make a small exercise related to Multivariate geostatistics and cokriging.
In Webster and Oliver they present the linear model of coregionalisation 
such that 
1) it is a sum of components
2) for component the covariances and crosscovarainces share same correlation function,
but have different scalars associated to them (these scalar are chosen consistently to make 
up a covariance matrix) I can understand why this construction is a valid one 
(and I hope to able to explain it to the students)


In gstat I can do the following :

data(meuse)

pdf(file="meuse.pdf")
meuse.g <- gstat(id = "zn", formula = log(zinc) ~ 1, loc = ~x + y, data = meuse)
meuse.g <- gstat(meuse.g, "cu", log(copper) ~ 1, ~x + y, meuse)
meuse.g <- gstat(meuse.g, "cd", log(cadmium) ~ 1, ~x + y, meuse)
meuse.g <- gstat(meuse.g, "pb", log(lead) ~ 1, ~x + y, meuse)

data(meuse)

pdf(file="meuse.pdf")
meuse.g <- gstat(id = "zn", formula = log(zinc) ~ 1, loc = ~x + y, data = meuse)
meuse.g <- gstat(meuse.g, "cu", log(copper) ~ 1, ~x + y, meuse)
meuse.g <- gstat(meuse.g, "cd", log(cadmium) ~ 1, ~x + y, meuse)
meuse.g <- gstat(meuse.g, "pb", log(lead) ~ 1, ~x + y, meuse)


meuse.g2 <- gstat(meuse.g, model = vgm(1, "Sph", 900,1), fill.all = T)
meuse.fit2 <- fit.lmc(x, meuse.g2)
meuse.fit2

variograms:
         model      psill range
zn[1]      Nug 0.05838220     0
zn[2]      Sph 0.57717809   900
cu[1]      Nug 0.06127586     0
cu[2]      Sph 0.24767761   900
cd[1]      Nug 0.48904863     0
cd[2]      Sph 1.22387180   900
pb[1]      Nug 0.05924609     0
pb[2]      Sph 0.47945611   900
zn.cu[1]   Nug 0.04630670     0
zn.cu[2]   Sph 0.35863043   900
zn.cd[1]   Nug 0.12881136     0
zn.cd[2]   Sph 0.78603818   900
cu.cd[1]   Nug 0.12206442     0
cu.cd[2]   Sph 0.49782101   900
zn.pb[1]   Nug 0.05197207     0
zn.pb[2]   Sph 0.51367619   900
cu.pb[1]   Nug 0.03932104     0
cu.pb[2]   Sph 0.30882315   900
cd.pb[1]   Nug 0.10175399     0
cd.pb[2]   Sph 0.68735760   900
~x + y


## same range, but it not fit.

meuse.fit3 <- fit.lmc(x, meuse.g2, fit.ranges =TRUE)
mesure.fit3

variograms:
         model      psill     range
zn[1]      Nug 0.06390664    0.0000
zn[2]      Sph 0.59513904  965.6013
cu[1]      Nug 0.05466579    0.0000
cu[2]      Sph 0.23630293  773.4431
cd[1]      Nug 0.51350775    0.0000
cd[2]      Sph 1.32830734 1063.0889
pb[1]      Nug 0.07325686    0.0000
pb[2]      Sph 0.56031923 1193.4988
zn.cu[1]   Nug 0.04619022    0.0000
zn.cu[2]   Sph 0.35832564  898.0459
zn.cd[1]   Nug 0.14318935    0.0000
zn.cd[2]   Sph 0.84453467 1044.6003
cu.cd[1]   Nug 0.12402376    0.0000
cu.cd[2]   Sph 0.50344066  924.9874
zn.pb[1]   Nug 0.06218012    0.0000
zn.pb[2]   Sph 0.55728401 1062.1928
cu.pb[1]   Nug 0.04216347    0.0000
cu.pb[2]   Sph 0.31801824  962.8714
cd.pb[1]   Nug 0.11849857    0.0000
cd.pb[2]   Sph 0.76933704 1117.9877


fit different ranges !!!
(and I have difficulties to understand why this construction neccessarily is valid, 
and clearly would have problems explaining it to students).

What I really would like to be able to do is to fit the range also, but restrict it to be the same for
all varoigrams and crossvariograms
(requring a simultaneous fitting of variograms and cross-variograms, I guess).

I can see a solution,  where I chose 5 different fixed ranges and make a visual inspection of this
for each of them, but I worry about draging students through an exercise where they inspect a number of 
different variograms and for each of these have to consider five fitted variograms

Anyone aware of a more elegant solution to this problem ?


Ole Christensen



From enrico.guastaldi at gmail.com  Sat Nov 22 12:59:51 2008
From: enrico.guastaldi at gmail.com (Enrico Guastaldi)
Date: Sat, 22 Nov 2008 12:59:51 +0100
Subject: [R-sig-Geo]  calculating integral for spectral signatures
Message-ID: <7ce8d7d30811220359n755d2e22k488ca33c10a6d509@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081122/1548fd90/attachment.pl>

From Roger.Bivand at nhh.no  Sat Nov 22 13:42:39 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 22 Nov 2008 13:42:39 +0100 (CET)
Subject: [R-sig-Geo] posting on behalf of Kevin, Yen
Message-ID: <alpine.LRH.2.00.0811221337310.7189@reclus.nhh.no>

I'm posting this on behalf Kevin, Yen - the same text was trapped 
yesterday as spam, so this is also a technical issue, and the reason for 
helping in this way:
-----------------------
Hi, lists,

I am reading meterials about GWR, but there are some problems puzzling me 
very much:

If there are N observations at N locations g(g1,????gn),the dependent and 
independent variables are Y(y1,...yn) and X(x1,...xn). The formula for the 
regression is Y=X*Beta, where Beta is the function of location g.

My questions are as follows:
   1.How many groups should be grouped for regressing? N groups for the N 
locations or M groups (M is a arbitrary number less than N)?
   2.When the parameter beta(gi) at location gi is estimated, weight Wi is 
used. So how is W used? Are the neighboring k(with in the bandwidth h) 
observations used for calculation?
   3.Beta is the function of location. Is Beta same as W or expressed as a 
function including W like Beta=W*f(g)?

Many thanks and best wishes

Kevin,Yen
LIESMARS,Wuhan University,China

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From Roger.Bivand at nhh.no  Sat Nov 22 14:01:16 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 22 Nov 2008 14:01:16 +0100 (CET)
Subject: [R-sig-Geo] WMS, WFS, WCS an WPS for R
In-Reply-To: <d8ad40b50811220135p6a32a0e3p658d78541db074b8@mail.gmail.com>
References: <20081122091037.96631.qmail@web10714.mail.bbt.yahoo.co.jp>
	<d8ad40b50811220135p6a32a0e3p658d78541db074b8@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.0811221357040.7189@reclus.nhh.no>

On Sat, 22 Nov 2008, Barry Rowlingson wrote:

> 2008/11/22 Hisaji ONO <hi_ono2001 at ybb.ne.jp>:
>> Hello.
>>
>>  There are lots of services of OGC(Open Geospatial
>> Consortium:http://www.opengeospatial.org/)'s standard
>> based Geo-Web ervices incluing WMS(Web Map Service),
>> WFS(Web Feature Service), WCS(Web Coverage Service) and
>> WPS(Web Processing Service) all over the world.
>>
>>  Does anyone try to use these services from R?
>
> Any access to WMS and WFS would probably be best done using GDAL and
> OGR via the rgdal package.... Let's see...
>
> GDAL has a WMS driver, but it seems you do have to create a 'local
> service description' file. www.gdal.org seems down at the moment, so
> here's a google cache link:
>
> http://216.239.59.132/search?q=cache:21OOLtr9yj0J:www.gdal.org/frmt_wms.html+gdal+wms&hl=en&ct=clnk&cd=1&gl=uk
>
> For WFS, there's some recent discussion on the gdal-dev list:
>
> http://www.nabble.com/OGR-WFS-driver-td20485363.html
>
> so it might be coming soon. Can you wait?
>
> To do WFS from scratch in R is probably going to need XML parsing,
> and then it'll probably also need OGR too unless you want to hand-code
> understanding the returned GML...

Yes, so OGR needs to be built against the Xerces libraries. I agree that 
WMS and WFS are best handled by using work that is already going on in the 
OSGeo community. An example of R in a a WPS setting is:

Katharina Henneb?hl, Edzer Pebesma:
Providing R functionality through the OGC Web Processing Service

given at useR! 2008 in Dortmund in August - there is an abstract on the 
conference website. I think that their trial site may be ready before 
long, together with the underlying software.

Roger

>
> Barry
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From edzer.pebesma at uni-muenster.de  Sun Nov 23 12:34:09 2008
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sun, 23 Nov 2008 12:34:09 +0100
Subject: [R-sig-Geo] fit.lmc in gstat - fit same range
In-Reply-To: <EA09C4B2B0F16E44B8F3311629493C0D02D76D98@DJFPOST01.djf.agrsci.dk>
References: <EA09C4B2B0F16E44B8F3311629493C0D02D76D98@DJFPOST01.djf.agrsci.dk>
Message-ID: <49293FB1.3080202@uni-muenster.de>

Hi Ole,

You're completely right -- it is hard to explain why the model you get 
when fitting different ranges is useful. If you had tried to use it in a 
kriging context, you would have seen the following:

 > predict(meuse.fit3, meuse[1,])
Warning: No Intrinsic Correlation or Linear Model of Coregionalization found
Reason: ranges differ
Warning: [add `set nocheck = 1;' to the command file to ignore the 
following error]

Error in predict.gstat(meuse.fit3, meuse[1, ]) :
  gstat: value not allowed for: variograms do not satisfy a legal model

Only few on this list will know that you can override this error by:
 > meuse.fit3$set=list(nocheck=1)
 > predict(meuse.fit3, meuse[1,])
Warning: No Intrinsic Correlation or Linear Model of Coregionalization found
Reason: ranges differ
Now checking for Cauchy-Schwartz inequalities:
variogram(var0,var1) passed Cauchy-Schwartz
variogram(var0,var2) passed Cauchy-Schwartz
variogram(var1,var2) passed Cauchy-Schwartz
variogram(var0,var3) passed Cauchy-Schwartz
variogram(var1,var3) passed Cauchy-Schwartz
variogram(var2,var3) passed Cauchy-Schwartz
[using ordinary cokriging]
       x      y  zn.pred       zn.var  cu.pred       cu.var  cd.pred
1 181072 333611 6.929517 1.004906e-26 4.442651 1.665335e-16 2.459589
        cd.var  pb.pred       pb.var    cov.zn.cu    cov.zn.cd    cov.cu.cd
1 8.881784e-16 5.700444 1.110223e-16 1.110223e-16 4.440892e-16 3.330669e-16
     cov.zn.pb    cov.cu.pb    cov.cd.pb
1 1.110223e-16 5.551115e-17 1.110223e-15

which may be useful to some. IIRC, I left this option in because some 
people at some stage advocated to use cokriging of indicators for 
several thresholds of a single continuous variable, where the LMC makes 
less sense because extremes show smaller correlation distance--all this 
is definitely not in the Webster & Oliver book.

The reason why fit.lmc was not cleanly implemented the way you would 
like is that it uses consecutive calls to fits for individual 
variograms, and if necessary corrects for positive definiteness of 
sills/nuggets. This setup doesn't make fitting of a common sill easy. 
Nobody has volunteered to do it better so far.

A larger worry I have now is that the gstat code allows you to predict 
values on a sphere with all the regular variogram models that are not 
positive on the sphere--without this kind of error/warning.
--
Edzer

Ole Fredslund Christensen wrote:
> Dear experts
>
> I'm in the middle of giving a course on geostatistics and GIS (I am doing the geostatistics part, 
> someone else the GIS part). We are using Webster and Oliver as text book.
>
> I am considering to make a small exercise related to Multivariate geostatistics and cokriging.
> In Webster and Oliver they present the linear model of coregionalisation 
> such that 
> 1) it is a sum of components
> 2) for component the covariances and crosscovarainces share same correlation function,
> but have different scalars associated to them (these scalar are chosen consistently to make 
> up a covariance matrix) I can understand why this construction is a valid one 
> (and I hope to able to explain it to the students)
>
>
> In gstat I can do the following :
>
> data(meuse)
>
> pdf(file="meuse.pdf")
> meuse.g <- gstat(id = "zn", formula = log(zinc) ~ 1, loc = ~x + y, data = meuse)
> meuse.g <- gstat(meuse.g, "cu", log(copper) ~ 1, ~x + y, meuse)
> meuse.g <- gstat(meuse.g, "cd", log(cadmium) ~ 1, ~x + y, meuse)
> meuse.g <- gstat(meuse.g, "pb", log(lead) ~ 1, ~x + y, meuse)
>
> data(meuse)
>
> pdf(file="meuse.pdf")
> meuse.g <- gstat(id = "zn", formula = log(zinc) ~ 1, loc = ~x + y, data = meuse)
> meuse.g <- gstat(meuse.g, "cu", log(copper) ~ 1, ~x + y, meuse)
> meuse.g <- gstat(meuse.g, "cd", log(cadmium) ~ 1, ~x + y, meuse)
> meuse.g <- gstat(meuse.g, "pb", log(lead) ~ 1, ~x + y, meuse)
>
>
> meuse.g2 <- gstat(meuse.g, model = vgm(1, "Sph", 900,1), fill.all = T)
>   
you forgot:
x = variogram(meuse.g)
> meuse.fit2 <- fit.lmc(x, meuse.g2)
> meuse.fit2
>
> variograms:
>          model      psill range
> zn[1]      Nug 0.05838220     0
> zn[2]      Sph 0.57717809   900
> cu[1]      Nug 0.06127586     0
> cu[2]      Sph 0.24767761   900
> cd[1]      Nug 0.48904863     0
> cd[2]      Sph 1.22387180   900
> pb[1]      Nug 0.05924609     0
> pb[2]      Sph 0.47945611   900
> zn.cu[1]   Nug 0.04630670     0
> zn.cu[2]   Sph 0.35863043   900
> zn.cd[1]   Nug 0.12881136     0
> zn.cd[2]   Sph 0.78603818   900
> cu.cd[1]   Nug 0.12206442     0
> cu.cd[2]   Sph 0.49782101   900
> zn.pb[1]   Nug 0.05197207     0
> zn.pb[2]   Sph 0.51367619   900
> cu.pb[1]   Nug 0.03932104     0
> cu.pb[2]   Sph 0.30882315   900
> cd.pb[1]   Nug 0.10175399     0
> cd.pb[2]   Sph 0.68735760   900
> ~x + y
>
>
> ## same range, but it not fit.
>
> meuse.fit3 <- fit.lmc(x, meuse.g2, fit.ranges =TRUE)
> mesure.fit3
>
> variograms:
>          model      psill     range
> zn[1]      Nug 0.06390664    0.0000
> zn[2]      Sph 0.59513904  965.6013
> cu[1]      Nug 0.05466579    0.0000
> cu[2]      Sph 0.23630293  773.4431
> cd[1]      Nug 0.51350775    0.0000
> cd[2]      Sph 1.32830734 1063.0889
> pb[1]      Nug 0.07325686    0.0000
> pb[2]      Sph 0.56031923 1193.4988
> zn.cu[1]   Nug 0.04619022    0.0000
> zn.cu[2]   Sph 0.35832564  898.0459
> zn.cd[1]   Nug 0.14318935    0.0000
> zn.cd[2]   Sph 0.84453467 1044.6003
> cu.cd[1]   Nug 0.12402376    0.0000
> cu.cd[2]   Sph 0.50344066  924.9874
> zn.pb[1]   Nug 0.06218012    0.0000
> zn.pb[2]   Sph 0.55728401 1062.1928
> cu.pb[1]   Nug 0.04216347    0.0000
> cu.pb[2]   Sph 0.31801824  962.8714
> cd.pb[1]   Nug 0.11849857    0.0000
> cd.pb[2]   Sph 0.76933704 1117.9877
>
>
> fit different ranges !!!
> (and I have difficulties to understand why this construction neccessarily is valid, 
> and clearly would have problems explaining it to students).
>
> What I really would like to be able to do is to fit the range also, but restrict it to be the same for
> all varoigrams and crossvariograms
> (requring a simultaneous fitting of variograms and cross-variograms, I guess).
>
> I can see a solution,  where I chose 5 different fixed ranges and make a visual inspection of this
> for each of them, but I worry about draging students through an exercise where they inspect a number of 
> different variograms and for each of these have to consider five fitted variograms
>
> Anyone aware of a more elegant solution to this problem ?
>
>
> Ole Christensen
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de/
http://www.springer.com/978-0-387-78170-9 e.pebesma at wwu.de



From edzer.pebesma at uni-muenster.de  Sun Nov 23 20:41:04 2008
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sun, 23 Nov 2008 20:41:04 +0100
Subject: [R-sig-Geo] WMS, WFS, WCS an WPS for R
In-Reply-To: <alpine.LRH.2.00.0811221357040.7189@reclus.nhh.no>
References: <20081122091037.96631.qmail@web10714.mail.bbt.yahoo.co.jp>	<d8ad40b50811220135p6a32a0e3p658d78541db074b8@mail.gmail.com>
	<alpine.LRH.2.00.0811221357040.7189@reclus.nhh.no>
Message-ID: <4929B1D0.8040906@uni-muenster.de>

Interesting question!

Of course, all these are services, and R is not typically a service or a 
client, but rather an environment to do statistical computing. Reading 
and writing can, as mentioned, be done to some extent through OGR (WFS, 
e.g. by writing gml) and GDAL (WCS, reading). Note that gml has many 
versions, and the more recent ones are typically monsters of complexity; 
OSGEO seems to support mainly older versions or subsets for specific 
application areas. WMS is more something of an output, useful for those 
who want to see the map rather than have the data.

We're currently working in the intamap project (http://www.intamap.org) 
to provide R interpolation facilities through a web processing standard, 
which basically means GIS (or any other) processing through an OGC 
complient web service (WPS, as opposed to e.g. SOAP). Here, R does the 
back end work, and the WPS front-end takes care of input (an O&M, 
observations and measurements document, xml) and output (gml for 
geometry, UncertML for probability distributions). If someone is 
interested in testing this, please let me know.

Other OGC services to check out are those in the SWE area: SOS, SPS, 
SAS, this list is growing faster than an adult can learn remembering 
abbreviations.
--
Edzer


Roger Bivand wrote:
> On Sat, 22 Nov 2008, Barry Rowlingson wrote:
>
>> 2008/11/22 Hisaji ONO <hi_ono2001 at ybb.ne.jp>:
>>> Hello.
>>>
>>>  There are lots of services of OGC(Open Geospatial
>>> Consortium:http://www.opengeospatial.org/)'s standard
>>> based Geo-Web ervices incluing WMS(Web Map Service),
>>> WFS(Web Feature Service), WCS(Web Coverage Service) and
>>> WPS(Web Processing Service) all over the world.
>>>
>>>  Does anyone try to use these services from R?
>>
>> Any access to WMS and WFS would probably be best done using GDAL and
>> OGR via the rgdal package.... Let's see...
>>
>> GDAL has a WMS driver, but it seems you do have to create a 'local
>> service description' file. www.gdal.org seems down at the moment, so
>> here's a google cache link:
>>
>> http://216.239.59.132/search?q=cache:21OOLtr9yj0J:www.gdal.org/frmt_wms.html+gdal+wms&hl=en&ct=clnk&cd=1&gl=uk 
>>
>>
>> For WFS, there's some recent discussion on the gdal-dev list:
>>
>> http://www.nabble.com/OGR-WFS-driver-td20485363.html
>>
>> so it might be coming soon. Can you wait?
>>
>> To do WFS from scratch in R is probably going to need XML parsing,
>> and then it'll probably also need OGR too unless you want to hand-code
>> understanding the returned GML...
>
> Yes, so OGR needs to be built against the Xerces libraries. I agree 
> that WMS and WFS are best handled by using work that is already going 
> on in the OSGeo community. An example of R in a a WPS setting is:
>
> Katharina Henneb?hl, Edzer Pebesma:
> Providing R functionality through the OGC Web Processing Service
>
> given at useR! 2008 in Dortmund in August - there is an abstract on 
> the conference website. I think that their trial site may be ready 
> before long, together with the underlying software.
>
> Roger
>
>>
>> Barry
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> ------------------------------------------------------------------------
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de/
http://www.springer.com/978-0-387-78170-9 e.pebesma at wwu.de



From koen.hufkens at ua.ac.be  Sun Nov 23 21:21:19 2008
From: koen.hufkens at ua.ac.be (Hufkens Koen)
Date: Sun, 23 Nov 2008 21:21:19 +0100
Subject: [R-sig-Geo] R GRASS bindings Mac OSX
Message-ID: <832A948B92E5754D9062CCF62F9ED892045CC2@xmail01.ad.ua.ac.be>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081123/e09636c7/attachment.pl>

From p.hiemstra at geo.uu.nl  Sun Nov 23 23:58:31 2008
From: p.hiemstra at geo.uu.nl (Paul Hiemstra)
Date: Sun, 23 Nov 2008 23:58:31 +0100
Subject: [R-sig-Geo] examples
In-Reply-To: <4927C89A.60204@xen.net>
References: <4927C89A.60204@xen.net>
Message-ID: <4929E017.9060702@geo.uu.nl>

[Ricardo Rodriguez] Your XEN ICT Team schreef:
> Hi all!
>
> I am just trying to show how R could be also an powerful tool in the
> sig-geo arena.
>
> Please, could anybody be so kind as to pointing to me to any nice free
> example out there? I've been some 3-D rendered surfaces here and 
> there, but I don't know where, if possible, could I find their data 
> and code. Thanks for your help!
>
> All the best,
>
> Ricardo
>
Hi Ricardo,

The sig-geo arena is quite a broad field, so it would help if you could 
be more specific. Most packages include datasets that are used in the 
example for that package. For the gstat package for example the meuse 
dataset is included and the example code is listed in the documentation 
of for example krige(). So install some packages (see for example the 
Spatial Taskview for R) and try the demo command to see what they can do.

cheers,
Paul

-- 
Drs. Paul Hiemstra
Department of Physical Geography
Faculty of Geosciences
University of Utrecht
Heidelberglaan 2
P.O. Box 80.115
3508 TC Utrecht
Phone:     +31302535773
Fax:    +31302531145
http://intamap.geo.uu.nl/~paul



From macq at llnl.gov  Mon Nov 24 04:28:49 2008
From: macq at llnl.gov (Don MacQueen)
Date: Sun, 23 Nov 2008 19:28:49 -0800
Subject: [R-sig-Geo] R GRASS bindings Mac OSX
In-Reply-To: <832A948B92E5754D9062CCF62F9ED892045CC2@xmail01.ad.ua.ac.be>
References: <832A948B92E5754D9062CCF62F9ED892045CC2@xmail01.ad.ua.ac.be>
Message-ID: <p06240800c54fcd413d6e@[192.168.11.7]>

Well, it's easy to find the rgdal package, it's on CRAN. However, as 
noted there, rgdal is not available from CRAN in binary form for OS 
X, so you have to build it from source. In order to do that you first 
need to install gdal and proj. CRAN is pretty clear on these 
dependencies. It even says where to get gdal and proj from. (I 
recently installed these for R 2.8.0 on 10.5.5, and it was very 
straightforward)

spgrass6 I can't help you with, other than to note that according to 
CRAN, its only dependency is rgdal, so it should go easily once you 
have rgdal. But I haven't done so myself.

If you need to learn how to build packages from source on OS X, and 
they are packages that have C source code (as these do) then you'll 
need to visit the R for Mac OS X FAQ, also reachable through CRAN.

-Don


At 9:21 PM +0100 11/23/08, Hufkens Koen wrote:
>Hi list,
>
>I'm trying to find the packages rgdal and spgrass6 (and all 
>dependencies) for R 2.8 and GRASS 6.3 for Mac OSX 10.5.x. I haven't 
>been lucky so far as non of them are listed in the repositories. Are 
>these functions not supported as I got them running like a charm on 
>linux and a lot of my scripts depend on GRASS R interaction.
>
>Any input would be welcome...
>
>Kind regards,
>Koen
>
>	[[alternative HTML version deleted]]
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at stat.math.ethz.ch
>https:// stat.ethz.ch/mailman/listinfo/r-sig-geo


-- 
---------------------------------
Don MacQueen
Lawrence Livermore National Laboratory
Livermore, CA, USA
925-423-1062
macq at llnl.gov



From r.hijmans at gmail.com  Mon Nov 24 05:50:36 2008
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Mon, 24 Nov 2008 12:50:36 +0800
Subject: [R-sig-Geo]  calculating integral for spectral signatures
Message-ID: <dc22b2570811232050o48a039afw7d122bda33c1e463@mail.gmail.com>

Enrico,

I think something like this should work for your purpose:

x <- c(1,2,3,5,7,12,13)
y <- c(1,2,9,11,7,20,10)

y1 <- y[-length(y)]
y2 <- y[-1]
dy <- y2 - y1
dx <- x[-1] - x[-length(x)]
dxy <- dx * (y1 + 0.5 * dy)
integral <- sum(dxy)

Robert

> Today's Topics:
>
>   1.  calculating integral for spectral signatures (Enrico Guastaldi)
>   2. posting on behalf of Kevin, Yen (Roger Bivand)
>   3. Re: WMS, WFS, WCS an WPS for R (Roger Bivand)
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Sat, 22 Nov 2008 12:59:51 +0100
> From: "Enrico Guastaldi" <enrico.guastaldi at gmail.com>
> Subject: [R-sig-Geo]  calculating integral for spectral signatures
> To: r-sig-geo at stat.math.ethz.ch
> Message-ID:
>        <7ce8d7d30811220359n755d2e22k488ca33c10a6d509 at mail.gmail.com>
> Content-Type: text/plain
>
> Dear list members,
> Does anyone know how to calculate in R integral of bivariate distribution of
> discrete points suche as the following
> x       y
> 1       1
> 2       2
> 3       9
> 5       11
> 7       7
> 12      20
> 13      10
> But I've thousands of x,y points with x always increasing: I'm talking about
> spectral signature.
> I think I need some function that "constructs" (not interpolates) a polyline
> from these x,y points and then calculate the underlying area, because I've
> to compare several distributions.
>
> Could anyone help me?
>
> Thanks
>
> --
> Enrico Guastaldi
> Centro di GeoTecnologie dell'Universit? degli Studi Siena,
> Via Vetri Vecchi, 34
> 52027 - San Giovanni Valdarno (AR)
> Italy
>
> Tel.   +39 349 4025017
> Fax.   +39 055 9119439
> url:   www.geotecnologie.unisi.it
>
> Io uso Linux!
> user #466775 counter.li.org
>
>
> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> Please try to avoid to send me .dwg, .doc, .xls, .ppt files.
> I prefer free formats.
> http://en.wikipedia.org/wiki/Open_format
>
> Please consider the environment before printing this e-mail
> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
>
>        [[alternative HTML version deleted]]
>
>
>
> ------------------------------
>
> Message: 2
> Date: Sat, 22 Nov 2008 13:42:39 +0100 (CET)
> From: Roger Bivand <Roger.Bivand at nhh.no>
> Subject: [R-sig-Geo] posting on behalf of Kevin, Yen
> To: r-sig-geo at stat.math.ethz.ch
> Message-ID: <alpine.LRH.2.00.0811221337310.7189 at reclus.nhh.no>
> Content-Type: text/plain; charset="iso-8859-15"; Format="flowed"
>
> I'm posting this on behalf Kevin, Yen - the same text was trapped
> yesterday as spam, so this is also a technical issue, and the reason for
> helping in this way:
> -----------------------
> Hi, lists,
>
> I am reading meterials about GWR, but there are some problems puzzling me
> very much:
>
> If there are N observations at N locations g(g1,????gn),the dependent and
> independent variables are Y(y1,...yn) and X(x1,...xn). The formula for the
> regression is Y=X*Beta, where Beta is the function of location g.
>
> My questions are as follows:
>   1.How many groups should be grouped for regressing? N groups for the N
> locations or M groups (M is a arbitrary number less than N)?
>   2.When the parameter beta(gi) at location gi is estimated, weight Wi is
> used. So how is W used? Are the neighboring k(with in the bandwidth h)
> observations used for calculation?
>   3.Beta is the function of location. Is Beta same as W or expressed as a
> function including W like Beta=W*f(g)?
>
> Many thanks and best wishes
>
> Kevin,Yen
> LIESMARS,Wuhan University,China
>
> --
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
> ------------------------------
>
> Message: 3
> Date: Sat, 22 Nov 2008 14:01:16 +0100 (CET)
> From: Roger Bivand <Roger.Bivand at nhh.no>
> Subject: Re: [R-sig-Geo] WMS, WFS, WCS an WPS for R
> To: Barry Rowlingson <b.rowlingson at lancaster.ac.uk>
> Cc: r-sig-geo at stat.math.ethz.ch
> Message-ID: <alpine.LRH.2.00.0811221357040.7189 at reclus.nhh.no>
> Content-Type: text/plain; charset="iso-8859-15"; Format="flowed"
>
> On Sat, 22 Nov 2008, Barry Rowlingson wrote:
>
>> 2008/11/22 Hisaji ONO <hi_ono2001 at ybb.ne.jp>:
>>> Hello.
>>>
>>>  There are lots of services of OGC(Open Geospatial
>>> Consortium:http://www.opengeospatial.org/)'s standard
>>> based Geo-Web ervices incluing WMS(Web Map Service),
>>> WFS(Web Feature Service), WCS(Web Coverage Service) and
>>> WPS(Web Processing Service) all over the world.
>>>
>>>  Does anyone try to use these services from R?
>>
>> Any access to WMS and WFS would probably be best done using GDAL and
>> OGR via the rgdal package.... Let's see...
>>
>> GDAL has a WMS driver, but it seems you do have to create a 'local
>> service description' file. www.gdal.org seems down at the moment, so
>> here's a google cache link:
>>
>> http://216.239.59.132/search?q=cache:21OOLtr9yj0J:www.gdal.org/frmt_wms.html+gdal+wms&hl=en&ct=clnk&cd=1&gl=uk
>>
>> For WFS, there's some recent discussion on the gdal-dev list:
>>
>> http://www.nabble.com/OGR-WFS-driver-td20485363.html
>>
>> so it might be coming soon. Can you wait?
>>
>> To do WFS from scratch in R is probably going to need XML parsing,
>> and then it'll probably also need OGR too unless you want to hand-code
>> understanding the returned GML...
>
> Yes, so OGR needs to be built against the Xerces libraries. I agree that
> WMS and WFS are best handled by using work that is already going on in the
> OSGeo community. An example of R in a a WPS setting is:
>
> Katharina Henneb?hl, Edzer Pebesma:
> Providing R functionality through the OGC Web Processing Service
>
> given at useR! 2008 in Dortmund in August - there is an abstract on the
> conference website. I think that their trial site may be ready before
> long, together with the underlying software.
>
> Roger
>
>>
>> Barry
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> --
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
> ------------------------------
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
> End of R-sig-Geo Digest, Vol 63, Issue 20
> *****************************************
>



From Wayne.W.Jones at shell.com  Mon Nov 24 09:06:57 2008
From: Wayne.W.Jones at shell.com (Wayne.W.Jones at shell.com)
Date: Mon, 24 Nov 2008 09:06:57 +0100
Subject: [R-sig-Geo] examples
In-Reply-To: <4927C89A.60204@xen.net>
Message-ID: <8E3590214E4380489D2F8BF129B939F329D400@amsdc1-s-03371.europe.shell.com>


Have a look at the CRAN task view for spatial statistics. 
This gives a very good overview of what pakages are available for spatial statistics.

See: 
http://cran.r-project.org/web/views/Spatial.html

Regards

Wayne


-----Original Message-----
From: r-sig-geo-bounces at stat.math.ethz.ch
[mailto:r-sig-geo-bounces at stat.math.ethz.ch]On Behalf Of [Ricardo
Rodriguez] Your XEN ICT Team
Sent: 22 November 2008 08:54
To: r-sig-geo at stat.math.ethz.ch
Subject: [R-sig-Geo] examples


Hi all!

I am just trying to show how R could be also an powerful tool in the
sig-geo arena.

Please, could anybody be so kind as to pointing to me to any nice free
example out there? I've been some 3-D rendered surfaces here and there, 
but I don't know where, if possible, could I find their data and code. 
Thanks for your help!

All the best,

Ricardo

-- 
Ricardo Rodr?guez
Your XEN ICT Team

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch
https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From jorge.de-jesus at jrc.it  Mon Nov 24 11:42:05 2008
From: jorge.de-jesus at jrc.it (Jorge de Jesus)
Date: Mon, 24 Nov 2008 11:42:05 +0100
Subject: [R-sig-Geo] WMS, WFS, WCS an WPS for R
In-Reply-To: <4929B1D0.8040906@uni-muenster.de>
References: <20081122091037.96631.qmail@web10714.mail.bbt.yahoo.co.jp>	<d8ad40b50811220135p6a32a0e3p658d78541db074b8@mail.gmail.com>	<alpine.LRH.2.00.0811221357040.7189@reclus.nhh.no>
	<4929B1D0.8040906@uni-muenster.de>
Message-ID: <492A84FD.7020906@jrc.it>

Hi

Everything concerning the OGC standards and R are covered in the last
posts.  It is possible to assemble specific WxS/WPS requests and deal
with the response from the servers, using the RCurl package. Also the
r-cran-xml package should have any problems parsing the returned results

Using Rcurl, means more work and more technical skills that using some
client specific for one of the WxS/WPS services.
Best
Jorge


Edzer Pebesma wrote:
> Interesting question!
>
> Of course, all these are services, and R is not typically a service or
> a client, but rather an environment to do statistical computing.
> Reading and writing can, as mentioned, be done to some extent through
> OGR (WFS, e.g. by writing gml) and GDAL (WCS, reading). Note that gml
> has many versions, and the more recent ones are typically monsters of
> complexity; OSGEO seems to support mainly older versions or subsets
> for specific application areas. WMS is more something of an output,
> useful for those who want to see the map rather than have the data.
>
> We're currently working in the intamap project
> (http://www.intamap.org) to provide R interpolation facilities through
> a web processing standard, which basically means GIS (or any other)
> processing through an OGC complient web service (WPS, as opposed to
> e.g. SOAP). Here, R does the back end work, and the WPS front-end
> takes care of input (an O&M, observations and measurements document,
> xml) and output (gml for geometry, UncertML for probability
> distributions). If someone is interested in testing this, please let
> me know.
>
> Other OGC services to check out are those in the SWE area: SOS, SPS,
> SAS, this list is growing faster than an adult can learn remembering
> abbreviations.
> -- 
> Edzer
>
>
> Roger Bivand wrote:
>> On Sat, 22 Nov 2008, Barry Rowlingson wrote:
>>
>>> 2008/11/22 Hisaji ONO <hi_ono2001 at ybb.ne.jp>:
>>>> Hello.
>>>>
>>>>  There are lots of services of OGC(Open Geospatial
>>>> Consortium:http://www.opengeospatial.org/)'s standard
>>>> based Geo-Web ervices incluing WMS(Web Map Service),
>>>> WFS(Web Feature Service), WCS(Web Coverage Service) and
>>>> WPS(Web Processing Service) all over the world.
>>>>
>>>>  Does anyone try to use these services from R?
>>>
>>> Any access to WMS and WFS would probably be best done using GDAL and
>>> OGR via the rgdal package.... Let's see...
>>>
>>> GDAL has a WMS driver, but it seems you do have to create a 'local
>>> service description' file. www.gdal.org seems down at the moment, so
>>> here's a google cache link:
>>>
>>> http://216.239.59.132/search?q=cache:21OOLtr9yj0J:www.gdal.org/frmt_wms.html+gdal+wms&hl=en&ct=clnk&cd=1&gl=uk
>>>
>>>
>>> For WFS, there's some recent discussion on the gdal-dev list:
>>>
>>> http://www.nabble.com/OGR-WFS-driver-td20485363.html
>>>
>>> so it might be coming soon. Can you wait?
>>>
>>> To do WFS from scratch in R is probably going to need XML parsing,
>>> and then it'll probably also need OGR too unless you want to hand-code
>>> understanding the returned GML...
>>
>> Yes, so OGR needs to be built against the Xerces libraries. I agree
>> that WMS and WFS are best handled by using work that is already going
>> on in the OSGeo community. An example of R in a a WPS setting is:
>>
>> Katharina Henneb?hl, Edzer Pebesma:
>> Providing R functionality through the OGC Web Processing Service
>>
>> given at useR! 2008 in Dortmund in August - there is an abstract on
>> the conference website. I think that their trial site may be ready
>> before long, together with the underlying software.
>>
>> Roger
>>
>>>
>>> Barry
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>> ------------------------------------------------------------------------
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>   
>


-- 
Ph.D. Jorge Samuel Mendes de Jesus

European Commission (EC)
Joint Research Centre Directorate (DG JRC)
Institute for Environment and Sustainability (IES)
TP 441, Via Fermi 1
21020 Ispra (VA)
Italy

Phone: +39 0332 78 3536
Fax:   +39 0332 78 5466

http://rem.jrc.ec.europa.eu

"The views expressed are purely those of the writer and may not in any circumstances be regarded as stating an official position of the European Commission"



From enrico.guastaldi at gmail.com  Mon Nov 24 15:48:11 2008
From: enrico.guastaldi at gmail.com (Enrico Guastaldi)
Date: Mon, 24 Nov 2008 15:48:11 +0100
Subject: [R-sig-Geo] calculating integral for spectral signatures
In-Reply-To: <dc22b2570811232050o48a039afw7d122bda33c1e463@mail.gmail.com>
References: <dc22b2570811232050o48a039afw7d122bda33c1e463@mail.gmail.com>
Message-ID: <7ce8d7d30811240648x6e4453c4re4b266752399baa2@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081124/fda4e023/attachment.pl>

From knussear at mac.com  Mon Nov 24 18:39:12 2008
From: knussear at mac.com (Ken Nussear)
Date: Mon, 24 Nov 2008 09:39:12 -0800
Subject: [R-sig-Geo] R GRASS bindings Mac OS
Message-ID: <7BCD35A8-5F39-4E46-8AD8-DFFAF4BFAD75@mac.com>

you can find rgdal here

http://www.kyngchaos.com/wiki/doku.php?id=software:frameworks

Once that is installed you should be able to use spgrass6 without  
problems. I've been using it on my mac for quite some time.

Ken



From Roger.Bivand at nhh.no  Mon Nov 24 18:54:26 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 24 Nov 2008 18:54:26 +0100 (CET)
Subject: [R-sig-Geo] R GRASS bindings Mac OS
In-Reply-To: <7BCD35A8-5F39-4E46-8AD8-DFFAF4BFAD75@mac.com>
References: <7BCD35A8-5F39-4E46-8AD8-DFFAF4BFAD75@mac.com>
Message-ID: <alpine.LRH.2.00.0811241845280.22346@reclus.nhh.no>

On Mon, 24 Nov 2008, Ken Nussear wrote:

> you can find rgdal here
>
> http://www.kyngchaos.com/wiki/doku.php?id=software:frameworks
>
> Once that is installed you should be able to use spgrass6 without problems. 
> I've been using it on my mac for quite some time.

Right. This is almost certyainly the easiest way, but may constrain your R 
version anmd rgdal version to the latest one built.

Other details are given on the Rgeo website:

http://www.sal.uiuc.edu/tools/tools-sum/rgeo/rgeo-detail/map-packages-on-cran

This is about to be moved to a new location, but will continue to be 
reached through http://www.r-project.org/Rgeo. If others would like to add 
their experience to the spatial themes in the R wiki, that would be great. 
Friendly suggestions to Simon Urbanek to try to get rgdal built for OSX 
would also be welcome - I don't have day-to-day access to an OSX system 
that I can hack on (i.e. mess up GDAL), so working out how to do this is 
rather for someone who does, and who could feed Simon with proj4 and GDAL 
binaries for target binary platforms. Here Windows is easier to handle, 
because only 32-bit Windows on Intel needs to be accommodated, and 
operating system version is not a problem.

Roger

>
> Ken
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From izareis at dpi.inpe.br  Tue Nov 25 13:56:13 2008
From: izareis at dpi.inpe.br (izareis at dpi.inpe.br)
Date: Tue, 25 Nov 2008 10:56:13 -0200
Subject: [R-sig-Geo] North arrow, scale bar, legend
Message-ID: <20081125105613.9yivwxeh3r4coosc@agenda.dpi.inpe.br>

Hi,

I did a kernel map using Script R:

image (kernel2d  
(casos.spp,contorno.poa,h0=7000,nx=250,ny=250),add=TRUE,col=terrain.colors  
(20))

And I need to put in this map legend, north arrow and scale bar.

I tried some scripts but I fail to do.
Thanks



From mwdenslow at yahoo.com  Tue Nov 25 17:10:30 2008
From: mwdenslow at yahoo.com (Michael Denslow)
Date: Tue, 25 Nov 2008 08:10:30 -0800 (PST)
Subject: [R-sig-Geo] Geonames elevation help
Message-ID: <181403.16051.qm@web33103.mail.mud.yahoo.com>

Dear List,

I am hoping that someone can help me with the GNsrtm3 function in the Geonames package. I am trying to get elevation values for more than one lat,long stored in a data frame. I am not sure if this function can process more than one request since it is a web query. But since R seems to be able to do anything, I figured I was missing something.

I am an R novice so any help would be most appreciated. Here is a shortened example of what I am trying to do.

library(geonames)

long <- c(-81.66,-82.66)
lat <- c(36.21,37.21)
df <- data.frame(lat,long)
GNsrtm3(df$lat,df$long)

# the result below is only for the first set of coordinates
  srtm3    lng   lat
1   990 -81.66 36.21

I also tried using apply, but it also only seemed to work for the first set of coordinates.

Thanks in advance,
Michael


Michael Denslow

I.W. Carpenter Jr. Herbarium [BOON]
Appalachian State University
Boone, North Carolina U.S.A.

-- AND --

Communications Manager
Southeastern Regional Network of Expertise and Collections
sernec.org



From b.rowlingson at lancaster.ac.uk  Tue Nov 25 17:40:11 2008
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Tue, 25 Nov 2008 16:40:11 +0000
Subject: [R-sig-Geo] Geonames elevation help
In-Reply-To: <181403.16051.qm@web33103.mail.mud.yahoo.com>
References: <181403.16051.qm@web33103.mail.mud.yahoo.com>
Message-ID: <d8ad40b50811250840g2fbbc34cifcb41d2df8beb4ba@mail.gmail.com>

2008/11/25 Michael Denslow <mwdenslow at yahoo.com>:

> I am hoping that someone can help me with the GNsrtm3 function in the Geonames package. I am trying to get elevation values for more than one lat,long stored in a data frame. I am not sure if this function can process more than one request since it is a web query. But since R seems to be able to do anything, I figured I was missing something.
>
> I am an R novice so any help would be most appreciated. Here is a shortened example of what I am trying to do.
>
> library(geonames)
>
> long <- c(-81.66,-82.66)
> lat <- c(36.21,37.21)
> df <- data.frame(lat,long)
> GNsrtm3(df$lat,df$long)
>
> # the result below is only for the first set of coordinates
>  srtm3    lng   lat
> 1   990 -81.66 36.21
>
> I also tried using apply, but it also only seemed to work for the first set of coordinates.
>
> Thanks in advance,
> Michael
>
>

 Maybe you were using apply wrong.

 With your df, you can do:

 > df$srtm3=apply(df,1,function(l){GNsrtm3(l[1],l[2])$srtm3})
 > df
     lat   long srtm3
 1 36.21 -81.66   990
 2 37.21 -82.66   500

 apply() passes the row of the dataframe as a vector to the function,
so I just get the first and last element and call GNsrtm3, and strip
off just the result.

 Oh, make sure I've got the lat-long the right way round.

Barry



From T.Hengl at uva.nl  Tue Nov 25 18:05:46 2008
From: T.Hengl at uva.nl (Tomislav Hengl)
Date: Tue, 25 Nov 2008 18:05:46 +0100
Subject: [R-sig-Geo] Geonames elevation help
In-Reply-To: <d8ad40b50811250840g2fbbc34cifcb41d2df8beb4ba@mail.gmail.com>
References: <181403.16051.qm@web33103.mail.mud.yahoo.com>
	<d8ad40b50811250840g2fbbc34cifcb41d2df8beb4ba@mail.gmail.com>
Message-ID: <55B5B5916CEC4F94B51D62FBEE899AE5@pcibed193>


You could also loop e.g. (this way you have a bit more control):

> long <- c(-81.66,-82.66)
> lat <- c(36.21,37.21)
> df <- data.frame(lat,long)
> df$srtm <- rep(NA, length(df$lat))
> for(i in 1:length(df$srtm)){
+   df$srtm[i] <- GNsrtm3(df$lat[i],df$long[i])$srtm3
+ }
> df
    lat   long srtm
1 36.21 -81.66  990
2 37.21 -82.66  500

But Barry's solution is more straight forward.


Tom Hengl


-----Original Message-----
From: r-sig-geo-bounces at stat.math.ethz.ch [mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of
Barry Rowlingson
Sent: Tuesday, November 25, 2008 5:40 PM
To: r-sig-geo at stat.math.ethz.ch
Subject: Re: [R-sig-Geo] Geonames elevation help

2008/11/25 Michael Denslow <mwdenslow at yahoo.com>:

> I am hoping that someone can help me with the GNsrtm3 function in the Geonames package. I am
trying to get elevation values for more than one lat,long stored in a data frame. I am not sure if
this function can process more than one request since it is a web query. But since R seems to be
able to do anything, I figured I was missing something.
>
> I am an R novice so any help would be most appreciated. Here is a shortened example of what I am
trying to do.
>
> library(geonames)
>
> long <- c(-81.66,-82.66)
> lat <- c(36.21,37.21)
> df <- data.frame(lat,long)
> GNsrtm3(df$lat,df$long)
>
> # the result below is only for the first set of coordinates
>  srtm3    lng   lat
> 1   990 -81.66 36.21
>
> I also tried using apply, but it also only seemed to work for the first set of coordinates.
>
> Thanks in advance,
> Michael
>
>

 Maybe you were using apply wrong.

 With your df, you can do:

 > df$srtm3=apply(df,1,function(l){GNsrtm3(l[1],l[2])$srtm3})
 > df
     lat   long srtm3
 1 36.21 -81.66   990
 2 37.21 -82.66   500

 apply() passes the row of the dataframe as a vector to the function,
so I just get the first and last element and call GNsrtm3, and strip
off just the result.

 Oh, make sure I've got the lat-long the right way round.

Barry

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch
https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From edzer.pebesma at uni-muenster.de  Tue Nov 25 20:01:29 2008
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 25 Nov 2008 20:01:29 +0100
Subject: [R-sig-Geo] North arrow, scale bar, legend
In-Reply-To: <20081125105613.9yivwxeh3r4coosc@agenda.dpi.inpe.br>
References: <20081125105613.9yivwxeh3r4coosc@agenda.dpi.inpe.br>
Message-ID: <492C4B89.9040202@uni-muenster.de>

The r-spatial web site http://r-spatial.sourceforge.net/ has a graph
gallery; I think it only works for spplot which takes data in sp
classes. You could us it by coercing your objects to it as

library(maptools)
as(casos.spp, "SpatialPointsDataFrame")

might work.
--
Edzer

izareis at dpi.inpe.br wrote:
> Hi,
>
> I did a kernel map using Script R:
>
> image (kernel2d 
> (casos.spp,contorno.poa,h0=7000,nx=250,ny=250),add=TRUE,col=terrain.colors 
> (20))
>
> And I need to put in this map legend, north arrow and scale bar.
>
> I tried some scripts but I fail to do.
> Thanks
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de/
http://www.springer.com/978-0-387-78170-9 e.pebesma at wwu.de



From Roger.Bivand at nhh.no  Tue Nov 25 20:19:49 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 25 Nov 2008 20:19:49 +0100 (CET)
Subject: [R-sig-Geo] North arrow, scale bar, legend
In-Reply-To: <492C4B89.9040202@uni-muenster.de>
References: <20081125105613.9yivwxeh3r4coosc@agenda.dpi.inpe.br>
	<492C4B89.9040202@uni-muenster.de>
Message-ID: <alpine.LRH.2.00.0811252013210.4829@reclus.nhh.no>

On Tue, 25 Nov 2008, Edzer Pebesma wrote:

> The r-spatial web site http://r-spatial.sourceforge.net/ has a graph
> gallery; I think it only works for spplot which takes data in sp
> classes. You could us it by coercing your objects to it as
>
> library(maptools)
> as(casos.spp, "SpatialPointsDataFrame")

Or the wrapper spkernel2d, in the splancs package. Give it a GridTopology 
to get a vector back to make a SpatialGridDataFrame. See the example on 
the help page.

Roger

>
> might work.
> --
> Edzer
>
> izareis at dpi.inpe.br wrote:
>> Hi,
>> 
>> I did a kernel map using Script R:
>> 
>> image (kernel2d 
>> (casos.spp,contorno.poa,h0=7000,nx=250,ny=250),add=TRUE,col=terrain.colors 
>> (20))
>> 
>> And I need to put in this map legend, north arrow and scale bar.
>> 
>> I tried some scripts but I fail to do.
>> Thanks
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Scott.Waichler at pnl.gov  Wed Nov 26 01:23:43 2008
From: Scott.Waichler at pnl.gov (Waichler, Scott R)
Date: Tue, 25 Nov 2008 16:23:43 -0800
Subject: [R-sig-Geo] Error in execution of lattice code
Message-ID: <12A8FC4D0563D1468AD23AAAED861A3E0BB642@EMAIL02.pnl.gov>

The following code runs fine on Linux, but not on my Mac.  The error
message is given below, after the levelplot() call.  I was able to run
lattice functions previously on the Mac without any problems.  The only
change I'm aware of is that my Mac was recently worked on by a system
administrator to implement some system and security changes.  I don't
know how that would be related to this problem.  I searched R-help and
found a similar problem that wasn't answered.

> sessionInfo()
R version 2.8.0 (2008-10-20)
powerpc-apple-darwin8.11.1

locale:
C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

loaded via a namespace (and not attached):
[1] tools_2.8.0

library(lattice)
# code from help(levelplot)
x <- seq(pi/4, 5 * pi, length = 100)
y <- seq(pi/4, 5 * pi, length = 100)
r <- as.vector(sqrt(outer(x^2, y^2, "+")))
grid <- expand.grid(x=x, y=y)
grid$z <- cos(r^2) * exp(-r/(pi^3))
png(file = "junk.png", width=8.5, height=11, units="in", res=75,
pointsize=12)  # letter
levelplot(z~x*y, grid, cuts = 50, scales=list(log="e"), xlab="",
         ylab="", main="Weird Function", sub="with log scales",
         colorkey = FALSE, region = TRUE)

Error in grid.Call("L_textBounds", as.graphicsAnnot(x$label), x$x, x$y,
:
  Polygon edge not found
In addition: Warning message:
In grid.Call("L_textBounds", as.graphicsAnnot(x$label), x$x, x$y,  :
  no font could be found for family "Arial"

dev.off()

Thanks for any help you can provide,

Scott Waichler
Pacific Northwest National Laboratory
scott.waichler at pnl.gov



From edzer.pebesma at uni-muenster.de  Wed Nov 26 08:52:13 2008
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 26 Nov 2008 08:52:13 +0100
Subject: [R-sig-Geo] Error in execution of lattice code
In-Reply-To: <12A8FC4D0563D1468AD23AAAED861A3E0BB642@EMAIL02.pnl.gov>
References: <12A8FC4D0563D1468AD23AAAED861A3E0BB642@EMAIL02.pnl.gov>
Message-ID: <492D002D.4080007@uni-muenster.de>

It seems that the R graphics system cannot find the font mentioned. 
Maybe try r-sig-mac for this question?
--
Edzer

Waichler, Scott R wrote:
> The following code runs fine on Linux, but not on my Mac.  The error
> message is given below, after the levelplot() call.  I was able to run
> lattice functions previously on the Mac without any problems.  The only
> change I'm aware of is that my Mac was recently worked on by a system
> administrator to implement some system and security changes.  I don't
> know how that would be related to this problem.  I searched R-help and
> found a similar problem that wasn't answered.
>
>   
>> sessionInfo()
>>     
> R version 2.8.0 (2008-10-20)
> powerpc-apple-darwin8.11.1
>
> locale:
> C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> loaded via a namespace (and not attached):
> [1] tools_2.8.0
>
> library(lattice)
> # code from help(levelplot)
> x <- seq(pi/4, 5 * pi, length = 100)
> y <- seq(pi/4, 5 * pi, length = 100)
> r <- as.vector(sqrt(outer(x^2, y^2, "+")))
> grid <- expand.grid(x=x, y=y)
> grid$z <- cos(r^2) * exp(-r/(pi^3))
> png(file = "junk.png", width=8.5, height=11, units="in", res=75,
> pointsize=12)  # letter
> levelplot(z~x*y, grid, cuts = 50, scales=list(log="e"), xlab="",
>          ylab="", main="Weird Function", sub="with log scales",
>          colorkey = FALSE, region = TRUE)
>
> Error in grid.Call("L_textBounds", as.graphicsAnnot(x$label), x$x, x$y,
> :
>   Polygon edge not found
> In addition: Warning message:
> In grid.Call("L_textBounds", as.graphicsAnnot(x$label), x$x, x$y,  :
>   no font could be found for family "Arial"
>
> dev.off()
>
> Thanks for any help you can provide,
>
> Scott Waichler
> Pacific Northwest National Laboratory
> scott.waichler at pnl.gov
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de/
http://www.springer.com/978-0-387-78170-9 e.pebesma at wwu.de



From hi_ono2001 at ybb.ne.jp  Thu Nov 27 02:45:20 2008
From: hi_ono2001 at ybb.ne.jp (Hisaji ONO)
Date: Thu, 27 Nov 2008 10:45:20 +0900 (JST)
Subject: [R-sig-Geo] WMS, WFS, WCS an WPS for R
In-Reply-To: <492A84FD.7020906@jrc.it>
Message-ID: <20081127014520.51669.qmail@web10702.mail.bbt.yahoo.co.jp>

Thank you for useful info.

 For "RCurl", though not for OGC's web services, there
were some example for geocoding in following URL(sorry in
Japanese only.)

http://www.okada.jp.org/RWiki/?R%A4%C7%A5%B8%A5%AA%A5%B3%A1%BC%A5%C7%A5%A3%A5%F3%A5%B0

 Regards.



From sharmaiirs at gmail.com  Thu Nov 27 09:50:33 2008
From: sharmaiirs at gmail.com (Pritam Sharma)
Date: Thu, 27 Nov 2008 14:20:33 +0530
Subject: [R-sig-Geo] Regression Kriging
Message-ID: <99d943ec0811270050q50eb39d2yf88e05fd33e7c2ee@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081127/692d255a/attachment.pl>

From T.Hengl at uva.nl  Thu Nov 27 10:11:27 2008
From: T.Hengl at uva.nl (Tomislav Hengl)
Date: Thu, 27 Nov 2008 10:11:27 +0100
Subject: [R-sig-Geo] Regression Kriging
In-Reply-To: <99d943ec0811270050q50eb39d2yf88e05fd33e7c2ee@mail.gmail.com>
References: <99d943ec0811270050q50eb39d2yf88e05fd33e7c2ee@mail.gmail.com>
Message-ID: <B245CA1104014FE0BCC55CA48219C100@pcibed193>


Dear Pritam,

Please forward us the R code, and, if possible, upload your data to some ftp server.

The coordinate system string of the maps imported to R can be set using:

> data(meuse)
> coordinates(meuse) <- ~x+y
> proj4string(meuse) <- CRS("+init=epsg:28992")

A list of epsg code is available via http://epsg-registry.org 

FYI: ILWIS GIS can be also controlled from R (see
http://spatial-analyst.net/wiki/index.php?title=Software#ILWIS_GIS), regression-kriging/universal
kriging you can run from a variety of software
(http://spatial-analyst.net/wiki/index.php?title=Regression-kriging_guide).

Personally, I would go for a combination of R+SAGA (e.g.
http://geomorphometry.org/view_scripts.asp?id=24) to generate maps of large areas.

First try all these combinations and then get back to us once you have a concrete problem with the
code (note that this is an R mailing list, and not an ILWIS mailing list).

I am sure we will find a solution to your problem.


Tom Hengl
http://spatial-analyst.net 


-----Original Message-----
From: r-sig-geo-bounces at stat.math.ethz.ch [mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of
Pritam Sharma
Sent: Thursday, November 27, 2008 9:51 AM
To: r-sig-geo at stat.math.ethz.ch
Subject: [R-sig-Geo] Regression Kriging

Hello Sir/Madam


This is Pritam Chand, working as Technical Associate in Forest Survey of
India, Dehrdaun. I have some doubts regarding regression kriging. Actually I
am trying to make final regression kriging predicted map and using R and
ILWIS software. I am able to reach steps upto variogram analysis of
residuals but in last command for regression kriging it is giving error that
the predictor variables are in different coordinate systems........ it might
be because of using ILWIS...... as it is its basic problem.... I am using 8
predictor variable maps......and with the help of these predicting soil
organic carbon......All the steps are running except the final one command
of regression kriging......

Please help me regarding this query or kindly send me some link or email
from where I get help regrading this query. If possible then plz send me
sample code for this problem so I can get idea and go forward with my
objectives.

With regards,

Pritam Chand Sharma,
FSI, Dheradun,
India



-- 
The Earth was not given to us by our parents. It was loaned to us by our
children.

	[[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch
https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From T.Hengl at uva.nl  Fri Nov 28 09:58:20 2008
From: T.Hengl at uva.nl (Tomislav Hengl)
Date: Fri, 28 Nov 2008 09:58:20 +0100
Subject: [R-sig-Geo] FW: 1st Call for Papers: Geomorphometry 2009,
	29 August - 2nd September, Zurich, Switzerland
Message-ID: <CD60C30EE4064CA0A832575D2A77BD99@pcibed193>


Apologies for cross postings! 
?
FIRST CALL FOR PAPERS


Geomorphometry 2009
29 August - 2 September 2009
Zurich, Switzerland
http://2009.GEOMORPHOMETRY.ORG  
?
e-mail: 2009 at geomorphometry.org 
?
PROGRAM CHAIRS
Ross Purves?????? University of Zurich
Stephan Gruber??? University of Zurich
Tomislav Hengl??? University of Amsterdam
?
KEY DATES
Workshop proposals due??????????????????? ????? 14 January 2009
Extended abstracts due??????????????????? ????? 1 March 2009
Notification of acceptance??????????????? ????? 1 April 2009
Final camera-ready digital manuscripts due????? 1 May 2009
Author registration deadline? ????? ??????????? 15 May 2009
Early registration deadline?? ????????????????? 15 May 2009
?
Geomorphometry 2009 Workshops ????? ??????????? 29 August & 30 August 2009 
Geomorphometry 2009???????????????? ????? ????? 31 August - 2 September 2009
?
AIMS AND SCOPE??? 
The aim of Geomorphometry 2009 is to bring together researchers to present and discuss developments
in the field of quantitative modelling and analysis of elevation data. Geomorphometry is the science
of quantitative land-surface analysis and description at diverse spatial scales. It draws upon
mathematical, statistical and image-processing techniques and interfaces with many disciplines
including hydrology, geology, computational geometry, geomorphology, remote sensing, geographic
information science and geography. The conference aims to attract leading researchers in
geomorphometry presenting methodological advances in the field and to provide young researchers with
an opportunity to present new results.
?
The Geomorphometry 2009 conference will continue a series initiated by the Terrain Analysis and
Digital Terrain Modelling conference hosted by Nanjing Normal University in November 2006.
?
Possible topics include, but are not limited to:
?
- Extraction of land-surface parameters from DEMs
- Implications of novel data sources 
- Identification and classification of land-surface objects
- Uncertainty in geomorphometry
- Semantics of land-surface description?? 
- Visualisation in geomorphometry?? 
- Implications of scale and resolution
- Flow and hydrological modelling using DEMs
- Efficient methods for application to large data sets
- Novel applications of geomorphometry
- Planetary geomorphometry
?
We specifically aim at papers with new methodological insights and thus papers which simply describe
the application of GIS are discouraged.
?
CONFERENCE PROGRAMME??? 
The conference programme will be based around a single track of papers, all of which will be subject
to review in the form of extended abstracts by members of the programme committee. Criteria for
paper acceptance will include relevance to the conference, novelty, scientific significance,
relation to previous work in the domain and the quality of presentation. The proceedings will be
made available both digitally and as printed working materials to attendees at the time of the
conference and archived online. A special issue of a journal, to which authors will be invited to
submit full papers after the conference is also planned.
?
WORKSHOPS
Geomorphometry will host up to three workshops, each with 15-30 attendees on the 29th and 30th
August. We invite applications to host a workshop on a theme related to the main conference.
Workshops should primarily take the form of either tutorials in a particular method or technique, or
provide the opportunity for detailed discussion of upcoming topics. They should not simply be
mini-conferences. If you are interested in organising a workshop, please mail
2009 at geomorphometry.org with WORKSHOP as the subject line, as well as a 1-page description of the
workshop with the following headings: intended aims and scope, intended audience, outline workshop
programme and technical requirements.? 
?
SUBMISSIONS
Prospective authors will be invited to submit extended abstracts of up to 2000 words by the above
deadline through the EasyChair system. Formatting instructions and detailed information on using the
submission system will be available in due course. Extended abstracts must be original works by the
authors, not be currently under review in the same form by another outlet and not submitted
elsewhere prior to the notification date.
?
SCIENTIFIC COMMITTEE
Alexander Brenning????? University of Waterloo, Canada
Ian Evans???????? ????? Durham University, UK
Peter Fisher??????????? University of Leicester, UK
John Gallant??????????? CSIRO, Australia
Paul Gessler??????????? University of Idaho, USA
Stephan Gruber????????? University of Zurich, Switzerland
Tomislav Hengl????????? University of Amsterdam, Netherlands
Oliver Korup??????????? WSL, Switzerland
Helena Mitasova???????? North Carolina State University, USA
Scott Peckham?????????? Rivix, USA
Hannes Reuter?????????? Joint Research Centre, Italy
Robert Weibel?????????? University of Zurich, Switzerland
John Wilson?????? ????? University of Southern California, USA
Jo Wood???????????????? City University, UK
Ralph Straumann???????? University of Zurich, Switzerland
Ross Purves?????? ????  University of Zurich, Switzerland
Qiming Zhou?????????    Hong Kong Baptist University, Hong Kong



From jloehrke at umassd.edu  Fri Nov 28 17:44:01 2008
From: jloehrke at umassd.edu (Jon Loehrke)
Date: Fri, 28 Nov 2008 11:44:01 -0500
Subject: [R-sig-Geo] in or out of polygon efficiency question
Message-ID: <5F85F2E8-1F2D-4E88-861B-AE2E6CE10C7F@umassd.edu>

Greetings,

I would like to assign spatial points in a large dataset to an area  
defined by complex polygon's.  These are 'statistical reference' areas  
and are helpful in indexing my data.  Currently I have 40,000 spatial  
observations (lats and longs) and 42 named polygons.

I've found a way to do this with a for loop and using inout from  
splancs.  This is however quite slow and I am curious if anyone would  
know of a way to speed this up.

Thank you very much for your help and ideas!

############
library(splancs)

group<-list(one=data.frame(x=c(-69,-69,-70,-70,-69),  
y=c(39.8333,39,39,39.8333,39.8333)),
			two=data.frame(x=c(-68.8333,-66.6667,-66.6667,-69,-69,-68.8333),  
y=c(39.8333,39.8333,39,39,39.8333,39.8333)),
			 
three 
= 
data 
.frame 
(x=c(-65.75,-65.74,-65.6667,-65.6667,66.6667,66.6667,66.6667,-65.75),  
y=c(40.5,40.5,40.5,39,39,39.8333,40.5,40.5)))

set.seed(50)

dat<-data.frame(x=runif(100,-70,-65), y=runif(100,39,41), area=NA)

for(i in 1:length(dat$x)){
	if(is.na(dat$x[i]) | is.na(dat$y[i])) {dat$area[i]<-NA} else  
{if(inout(cbind(dat$x[i],dat$y[i]),group$one)){dat$area[i]<-1}}
	if(is.na(dat$x[i]) | is.na(dat$y[i])) {dat$area[i]<-NA} else  
{if(inout(cbind(dat$x[i],dat$y[i]),group$two)){dat$area[i]<-2}}
	if(is.na(dat$x[i]) | is.na(dat$y[i])) {dat$area[i]<-NA} else  
{if(inout(cbind(dat$x[i],dat$y[i]),group$three)){dat$area[i]<-3}}
}

dat$area

# [1] NA NA NA NA  2 NA NA NA NA  1 NA  2  2  1  2 NA NA NA NA NA NA   
1 NA NA NA
#[26] NA  2  2  2  2  2  2 NA NA  2  2 NA NA  2 NA NA NA  2  1  1 NA   
3 NA NA NA
#[51]  3 NA  2 NA NA NA NA  2 NA  2  2  2 NA NA NA NA NA  1 NA  3 NA  
NA  2  1  3
#[76]  1  2 NA NA NA NA  1 NA NA NA NA NA NA NA  2 NA NA NA NA NA  2   
1 NA NA NA
######################


Jon Loehrke
Graduate Research Assistant
Department of Fisheries Oceanography
School for Marine Science and Technology
University of Massachusetts
200 Mill Road, Suite 325
Fairhaven, MA 02719
jloehrke at umassd.edu

sessionInfo()
R version 2.8.0 Patched (2008-11-24 r47017)
i386-apple-darwin9.5.0

locale:
en_US.UTF-8/en_US.UTF-8/C/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] splancs_2.01-24 sp_0.9-28

loaded via a namespace (and not attached):
[1] grid_2.8.0      lattice_0.17-17



From Roger.Bivand at nhh.no  Fri Nov 28 20:37:00 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 28 Nov 2008 20:37:00 +0100 (CET)
Subject: [R-sig-Geo] in or out of polygon efficiency question
In-Reply-To: <5F85F2E8-1F2D-4E88-861B-AE2E6CE10C7F@umassd.edu>
References: <5F85F2E8-1F2D-4E88-861B-AE2E6CE10C7F@umassd.edu>
Message-ID: <alpine.LRH.2.00.0811282013570.19230@reclus.nhh.no>

On Fri, 28 Nov 2008, Jon Loehrke wrote:

> Greetings,
>
> I would like to assign spatial points in a large dataset to an area defined 
> by complex polygon's.  These are 'statistical reference' areas and are 
> helpful in indexing my data.  Currently I have 40,000 spatial observations 
> (lats and longs) and 42 named polygons.
>
> I've found a way to do this with a for loop and using inout from splancs. 
> This is however quite slow and I am curious if anyone would know of a way to 
> speed this up.

Use the overlay method in the sp package - the polygons must be a 
SpatialPolygons object, the points a SpatialPoints (or their *DataFrame 
subclasses). Both are easy to read in using readOGR in rgdal. Using your 
data:

coordinates(dat) <- c("x", "y")
group1 <- lapply(seq(along=group), function(x)
   Polygons(list(Polygon(as.matrix(group[[x]]))), ID=x))
group2 <- SpatialPolygons(group1)
o <- overlay(group2, dat)
plot(dat)
plot(group2, add=TRUE, border="green")
points(dat, col=o)
dat$area <- o
summary(dat)

If you want the names in group as the IDs, use lapply(names(group), ... 
then:

IDs <- sapply(slot(group2, "polygons"), function(x) slot(x, "ID"))
dat$area <- factor(IDs[o])
summary(dat)

For 40K points in dat, this ran in less than half a second for me, but for 
irregular polygons would take somewhat longer, because there is much more 
computational geometry to do.

Hope this helps,

Roger



>
> Thank you very much for your help and ideas!
>
> ############
> library(splancs)
>
> group<-list(one=data.frame(x=c(-69,-69,-70,-70,-69), 
> y=c(39.8333,39,39,39.8333,39.8333)),
> 			two=data.frame(x=c(-68.8333,-66.6667,-66.6667,-69,-69,-68.8333), 
> y=c(39.8333,39.8333,39,39,39.8333,39.8333)),
> 			three=data.frame(x=c(-65.75,-65.74,-65.6667,-65.6667,66.6667,66.6667,66.6667,-65.75), 
> y=c(40.5,40.5,40.5,39,39,39.8333,40.5,40.5)))
>
> set.seed(50)
>
> dat<-data.frame(x=runif(100,-70,-65), y=runif(100,39,41), area=NA)
>
> for(i in 1:length(dat$x)){
> 	if(is.na(dat$x[i]) | is.na(dat$y[i])) {dat$area[i]<-NA} else 
> {if(inout(cbind(dat$x[i],dat$y[i]),group$one)){dat$area[i]<-1}}
> 	if(is.na(dat$x[i]) | is.na(dat$y[i])) {dat$area[i]<-NA} else 
> {if(inout(cbind(dat$x[i],dat$y[i]),group$two)){dat$area[i]<-2}}
> 	if(is.na(dat$x[i]) | is.na(dat$y[i])) {dat$area[i]<-NA} else 
> {if(inout(cbind(dat$x[i],dat$y[i]),group$three)){dat$area[i]<-3}}
> }
>
> dat$area
>
> # [1] NA NA NA NA  2 NA NA NA NA  1 NA  2  2  1  2 NA NA NA NA NA NA  1 NA NA 
> NA
> #[26] NA  2  2  2  2  2  2 NA NA  2  2 NA NA  2 NA NA NA  2  1  1 NA  3 NA NA 
> NA
> #[51]  3 NA  2 NA NA NA NA  2 NA  2  2  2 NA NA NA NA NA  1 NA  3 NA NA  2  1 
> 3
> #[76]  1  2 NA NA NA NA  1 NA NA NA NA NA NA NA  2 NA NA NA NA NA  2  1 NA NA 
> NA
> ######################
>
>
> Jon Loehrke
> Graduate Research Assistant
> Department of Fisheries Oceanography
> School for Marine Science and Technology
> University of Massachusetts
> 200 Mill Road, Suite 325
> Fairhaven, MA 02719
> jloehrke at umassd.edu
>
> sessionInfo()
> R version 2.8.0 Patched (2008-11-24 r47017)
> i386-apple-darwin9.5.0
>
> locale:
> en_US.UTF-8/en_US.UTF-8/C/C/en_US.UTF-8/en_US.UTF-8
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] splancs_2.01-24 sp_0.9-28
>
> loaded via a namespace (and not attached):
> [1] grid_2.8.0      lattice_0.17-17
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



