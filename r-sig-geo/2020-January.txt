From m@rk|z@555-94 @end|ng |rom m@||@ru  Wed Jan  8 09:41:20 2020
From: m@rk|z@555-94 @end|ng |rom m@||@ru (=?UTF-8?B?QW5hc3Rhc2lhIFNlbWVub3Zh?=)
Date: Wed, 08 Jan 2020 11:41:20 +0300
Subject: [R-sig-Geo] =?utf-8?q?Grouping_neighbouring_polygons_to_get_an_e?=
 =?utf-8?q?qual_distribution_of_residents?=
Message-ID: <1578472880.138322125@f534.i.mail.ru>


?
Hello everyone,
?
I'm working with a large spatial polygon data frame downloaded from? https://biogeo.ucdavis.edu/data/gadm3.6/Rsp/gadm36_DEU_4_sp.rds ?. A have added two columns to the dataset with number of people and number of shops in each district. Now I have to group the polygons?so that the 200 resulting areas contain an approximately equal number of people and shops or at least only people. It should be just a new column with an ID of the ?new? area (from 1 to 200), which matches every polygon (district). Like this:
?
?
CC_4 ? ? ? ? ? ? ? ??New_area
84255001002 1
84255001004 2
84255002017 78
84255002020 1
?
Unfortunately, I have no idea how to implement this. Are there any appropariate?functions??Could You please help me?
?
Thank You very much in advance.
Best regards,
Anastasia
	[[alternative HTML version deleted]]


From Roger@B|v@nd @end|ng |rom nhh@no  Wed Jan  8 10:38:44 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Wed, 8 Jan 2020 10:38:44 +0100
Subject: [R-sig-Geo] Grouping neighbouring polygons to get an equal
 distribution of residents
In-Reply-To: <1578472880.138322125@f534.i.mail.ru>
References: <1578472880.138322125@f534.i.mail.ru>
Message-ID: <alpine.LFD.2.21.2001081027350.1553246@reclus.nhh.no>

On Wed, 8 Jan 2020, Anastasia Semenova wrote:

>
> ?
> Hello everyone,
> ?I'm working with a large spatial polygon data frame downloaded from 
> https://biogeo.ucdavis.edu/data/gadm3.6/Rsp/gadm36_DEU_4_sp.rds . A have 
> added two columns to the dataset with number of people and number of 
> shops in each district. Now I have to group the polygons so that the 200 
> resulting areas contain an approximately equal number of people and 
> shops or at least only people. It should be just a new column with an ID 
> of the ?new? area (from 1 to 200), which matches every polygon 
> (district). Like this:
> ?
> ?
> CC_4 ? ? ? ? ? ? ? ??New_area
> 84255001002 1
> 84255001004 2
> 84255002017 78
> 84255002020 1
> ?Unfortunately, I have no idea how to implement this. Are there any 
> appropariate functions? Could You please help me?

This is a version of the regionalisation problem (search Openshaw 
regionalisation). A recent contribution, skater, is included in the spdep 
package, but differs from your task because it by default chooses a 
partition that minimises within-group variability for contiguous polygons. 
See the skater help page for references: 
https://r-spatial.github.io/spdep/reference/skater.html

The problem is not unlike voter redistricting, see the archived BARD 
package and its references: 
https://cran.r-project.org/src/contrib/Archive/BARD/
https://www.jstatsoft.org/article/view/v042i04
(look for work citing the JSS article): 
https://scholar.google.com/scholar?oi=bibs&hl=en&cites=3803462190546196364,883721913332052071&as_sdt=5

The underlying problem has no easy solution (NP-complete I think). Many 
statistical agencies use scaled square grid cells to handle this, bigger 
cells in less dense areas, rather than polygons. Post/zip-codes are often 
as good as you get off-the-shelf.

Hope this helps,

Roger

> ?
> Thank You very much in advance.
> Best regards,
> Anastasia
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From z|@207 @end|ng |rom gm@||@com  Wed Jan  8 17:42:57 2020
From: z|@207 @end|ng |rom gm@||@com (Zia Ahmed)
Date: Wed, 8 Jan 2020 11:42:57 -0500
Subject: [R-sig-Geo] R-tutorial: Geospatial Data Science with R
In-Reply-To: <alpine.LFD.2.21.2001081027350.1553246@reclus.nhh.no>
References: <1578472880.138322125@f534.i.mail.ru>
 <alpine.LFD.2.21.2001081027350.1553246@reclus.nhh.no>
Message-ID: <CAKqUiGm+eVv5gSm5L=X_9fXDmRZBe22WVL+VQORP3QdGpkN53w@mail.gmail.com>

Dear All,


Best


*Zia Ahmed, PhD*

Research Associate Professor (Data & Visualization)

RENEW (Research and Education in eNergy, Environment and Water) Institute
<http://www.buffalo.edu/renew.html>

University at Buffalo <http://www.buffalo.edu/>



Tutorial consist following topics:



*1. Spatial Data Processing
<https://zia207.github.io/geospatial-r-github.io/about.html>*

   - Reading and Writing Spatial Data
   <https://zia207.github.io/geospatial-r-github.io/read-write-spatial-data.html>
      - Vector data
      - Raster data
   - Map Projection and Coordinate Reference Systems
   <https://zia207.github.io/geospatial-r-github.io/map-projection-coordinate-reference-systems.html>
      - Geographic coordinate system (GCS)
      - Projected coordinate system
      - Coordinate Reference System in R
   - Geoprocessing of Vector data
   <https://zia207.github.io/geospatial-r-github.io/geoprocessing-vector-data.html>
      - Clipping
      - Union
      - Dissolve
      - Intersect
      - Erase
      - Convex Hull
      - Buffer
   - Working with Spatial Point Data
   <https://zia207.github.io/geospatial-r-github.io/working-with-spatial-point-data.html>
      - Create a Spatial Point Data Frame
      - Extract Environmental Covariates to SPDF
      - Create a Prediction Grid
      - Exploratory Data Analysis
      - Plot Data on Web Map
   - Working with Spatial Polygon Data
   <https://zia207.github.io/geospatial-r-github.io/working-with-spatial-polygon.html>
      - Data Processing
      - Visualization
      - Animation of Time Series Data
   - Working with Raster Data
   <https://zia207.github.io/geospatial-r-github.io/working-with-raster-data.html>
      - Basic Raster Operation
      - Clipping
      - Reclassification
      - Focal Statistics
      - Raster Algebra
      - Aggregation
      - Resample
      - Mosaic
      - Convert Raster to Point Data
      - Convert Point Data to Raster
      - Raster Stack and Raster Brick
      - Digital Terrain Modeling
         - Slope
         - Aspect
         - Hillshade
         - Terrain Ruggedness Index
         - Topographic Position Index
         - Roughness
         - Curvature
         - Flow Direction
      - netCDF Data Processing
   <https://zia207.github.io/geospatial-r-github.io/netCDF-data-processing.html>



*2. Spatial Statistics
<https://zia207.github.io/geospatial-r-github.io/spatial-statistics.html>*

   - Spatial Autocorrelation
   <https://zia207.github.io/geospatial-r-github.io/spatial-autocorrelation.html>
      - Moran?s I
      - Geary?s C
      - Getis?s Gi
   - Point Pattern Analysis
   <https://zia207.github.io/geospatial-r-github.io/point-pattern-analysis.html>
   - Geographically Weighted Mmodels
   <https://zia207.github.io/geospatial-r-github.io/geographically-weighted-models.html>
      - Geographically Weighted Summary Statistics
      <https://zia207.github.io/geospatial-r-github.io/geographically-weighted-summary-statistics.html>
      - Geographically Weighted Principal Components Analysis
      <https://zia207.github.io/geospatial-r-github.io/geographically-weighted-principal-components-analysis.html>
      - Geographically Weighted Regression
      <https://zia207.github.io/geospatial-r-github.io/geographically-weighted-regression.html>
         - Geographically Weighted OLS Regression
         <https://zia207.github.io/geospatial-r-github.io/geographically-weighted-ols-regression.html>
         - Geographically Weighted Poisson Regression
         <https://zia207.github.io/geospatial-r-github.io/geographically-weighted-poisson-regression.html>
         - Global and local (Geographically Weighted) Random Forest
         <https://zia207.github.io/geospatial-r-github.io/geographically-wighted-random-forest.html>



*3. Spatial Interpolation
<https://zia207.github.io/geospatial-r-github.io/spatial-interpolation.html>*



?         Spatial Interpolation
<https://zia207.github.io/geospatial-r-github.io/spatial-interpolation.html>

o    Deterministic Methods for Spatial Interpolation
<https://zia207.github.io/geospatial-r-github.io/deterministic-methods-for-spatial-interpolation.html>

?  Polynomial Trend Surface

?  Proximity Analysis-Thiessen Polygons

?  Nearest Neighbor Interpolation

?  Inverse Distance Weighted

?  Thin Plate Spline

o    Geostatistical Methods for Spatial Interpolation
<https://zia207.github.io/geospatial-r-github.io/geostatistical-methods-for-spatial-interpolation.html>

?  Semivariogram Modeling
<https://zia207.github.io/geospatial-r-github.io/semivariogram-modeling.html>

?  Kriging <https://zia207.github.io/geospatial-r-github.io/kriging.html>

?  Ordinary Kriging
<https://zia207.github.io/geospatial-r-github.io/ordinary-kriging.html>

?  Universal Kriging
<https://zia207.github.io/geospatial-r-github.io/universal-kriging.html>

?  Co-Kriging
<https://zia207.github.io/geospatial-r-github.io/cokriging.html>

?  Regression kriging
<https://zia207.github.io/geospatial-r-github.io/regression-kriging.html>

?  Generalized Linear Model

?  Random Forest

?  Meta Ensemble Machine Learning

?  Indicator kriging
<https://zia207.github.io/geospatial-r-github.io/indicator-kriging.html>

?         Assessing the Quality of Spatial Predictions
<https://zia207.github.io/geospatial-r-github.io/assessing-quality-spatial-predictions.html>

o    Cross-validation
<https://zia207.github.io/geospatial-r-github.io/cross-validation.html>

o    Validation with an Independent Dataset
<https://zia207.github.io/geospatial-r-github.io/validation-independent-dataset.html>

o    Conditional Simulation for Spatial Uncertainty
<https://zia207.github.io/geospatial-r-github.io/conditional-simulation-spatial-uncertainty.html>



*4. Remote Sensing Data Processing and Analysis
<https://zia207.github.io/geospatial-r-github.io/about-c.html>*

?
Remote Sensing Basic
<https://zia207.github.io/geospatial-r-github.io/reomte-sensing-basic.html>

?         Landsat 8 Image Processing & Visualization
<https://zia207.github.io/geospatial-r-github.io/landsat-8-image-processing.html>

o    RGB image comparison

o    Pan Sharpening or Image Fusion

o    Radiometric Calibration and Atmospheric Correction

?         Spectral Indices
<https://zia207.github.io/geospatial-r-github.io/spectral-indices.html>

o    Normalized Difference Vegetation Index

o    Soil Adjusted Vegetation Index (SAVI)

o    Modified soil Adjusted Vegetation Index (MSAVI)

o    Enhanced Vegetation Index (EVI)

o    Two-bands Enhanced Vegetation (EVI2)

o    Normalized Difference Water Index (NDWI)

?         Green Ground Cover from UAV Images
<https://zia207.github.io/geospatial-r-github.io/uav-ground-cover.html>

?         Texture Analysis
<https://zia207.github.io/geospatial-r-github.io/texture-analysis.html>

?         Image Classification
<https://zia207.github.io/geospatial-r-github.io/image-classification.html>

o    Ground Truth Data Processing
<https://zia207.github.io/geospatial-r-github.io/ground-truth-data-processing.html>

o    Unsupervised Classification
<https://zia207.github.io/geospatial-r-github.io/unsupervised-classification.html>

?  Supervised Classification
<https://zia207.github.io/geospatial-r-github.io/supervised-classification.html>

?      Random Forest
<https://zia207.github.io/geospatial-r-github.io/random-forest.html>

?      Support Vector Machine
<https://zia207.github.io/geospatial-r-github.io/support-vector-machine.html>

?      Na?ve Bayes
<https://zia207.github.io/geospatial-r-github.io/naive-bayes.html>

?      eXBoost
<https://zia207.github.io/geospatial-r-github.io/exboost.html>

?      Deep Learning-H2O
<https://zia207.github.io/geospatial-r-github.io/deep-learning-h2o.html>

?      Stack-Ensemble-H20
<https://zia207.github.io/geospatial-r-github.io/stack-ensemble-h2o.html>

?      Deep Learning Keras-TensorFlow
<https://zia207.github.io/geospatial-r-github.io/deep-learning-keras-tensorflow.html>

	[[alternative HTML version deleted]]


From z|@207 @end|ng |rom gm@||@com  Wed Jan  8 18:06:37 2020
From: z|@207 @end|ng |rom gm@||@com (Zia Ahmed)
Date: Wed, 8 Jan 2020 12:06:37 -0500
Subject: [R-sig-Geo] R-Tutorial: Geospatial Data Science in R (Resent)
Message-ID: <CAKqUiGmPV=q_6ht=5Zt2FatSo5gcicOAuK8w3KhafoEpgWawfQ@mail.gmail.com>

Hi All,

I have published an online tutorial related to spatial-data analysis with R
(https://zia207.github.io/geospatial-r-github.io/). Nothing is new here, I
have just organized several R-code and data that I have used in my several
publications. Most of the codes were written with the help of postings in
several online blogs: such as R-sig-Geo
<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>, Stack Overflow
<https://stackoverflow.com/>, and R bloggers
<https://www.r-bloggers.com/update-can-we-predict-flu-outcome-with-machine-learning-in-r/>
and on-line tutorials such as Spatial Data Science
<https://rspatial.org/index.html> and Geostatistics & Open-source
statistical computing
<http://www.css.cornell.edu/faculty/dgr2/teach/degeostats.html>.  I think
It would help someone we have no prior knowledge of GIS, remote sensing or
any other area of geoinformatics, but have some experience in R-coding. The
data used in this tutorial also available for download.



I appreciate any feedback for improving this tutorial.



I appreciate any feedback for improving this tutorial.



Best



Zia Ahmed

University at Buffalo



Tutorial consist following topics:



*1. **Spatial Data Processing*
<https://zia207.github.io/geospatial-r-github.io/about.html>

   - Reading and Writing Spatial Data
   <https://zia207.github.io/geospatial-r-github.io/read-write-spatial-data.html>
      - Vector data
      - Raster data
   - Map Projection and Coordinate Reference Systems
   <https://zia207.github.io/geospatial-r-github.io/map-projection-coordinate-reference-systems.html>
      - Geographic coordinate system (GCS)
      - Projected coordinate system
      - Coordinate Reference System in R
   - Geoprocessing of Vector data
   <https://zia207.github.io/geospatial-r-github.io/geoprocessing-vector-data.html>
      - Clipping
      - Union
      - Dissolve
      - Intersect
      - Erase
      - Convex Hull
      - Buffer
   - Working with Spatial Point Data
   <https://zia207.github.io/geospatial-r-github.io/working-with-spatial-point-data.html>
      - Create a Spatial Point Data Frame
      - Extract Environmental Covariates to SPDF
      - Create a Prediction Grid
      - Exploratory Data Analysis
      - Plot Data on Web Map
   - Working with Spatial Polygon Data
   <https://zia207.github.io/geospatial-r-github.io/working-with-spatial-polygon.html>
      - Data Processing
      - Visualization
      - Animation of Time Series Data
   - Working with Raster Data
   <https://zia207.github.io/geospatial-r-github.io/working-with-raster-data.html>
      - Basic Raster Operation
      - Clipping
      - Reclassification
      - Focal Statistics
      - Raster Algebra
      - Aggregation
      - Resample
      - Mosaic
      - Convert Raster to Point Data
      - Convert Point Data to Raster
      - Raster Stack and Raster Brick
      - Digital Terrain Modeling
         - Slope
         - Aspect
         - Hillshade
         - Terrain Ruggedness Index
         - Topographic Position Index
         - Roughness
         - Curvature
         - Flow Direction
      - netCDF Data Processing
   <https://zia207.github.io/geospatial-r-github.io/netCDF-data-processing.html>



*2. **Spatial Statistics*
<https://zia207.github.io/geospatial-r-github.io/spatial-statistics.html>

   - Spatial Autocorrelation
   <https://zia207.github.io/geospatial-r-github.io/spatial-autocorrelation.html>
      - Moran?s I
      - Geary?s C
      - Getis?s Gi
   - Point Pattern Analysis
   <https://zia207.github.io/geospatial-r-github.io/point-pattern-analysis.html>
   - Geographically Weighted Mmodels
   <https://zia207.github.io/geospatial-r-github.io/geographically-weighted-models.html>
      - Geographically Weighted Summary Statistics
      <https://zia207.github.io/geospatial-r-github.io/geographically-weighted-summary-statistics.html>
      - Geographically Weighted Principal Components Analysis
      <https://zia207.github.io/geospatial-r-github.io/geographically-weighted-principal-components-analysis.html>
      - Geographically Weighted Regression
      <https://zia207.github.io/geospatial-r-github.io/geographically-weighted-regression.html>
         - Geographically Weighted OLS Regression
         <https://zia207.github.io/geospatial-r-github.io/geographically-weighted-ols-regression.html>
         - Geographically Weighted Poisson Regression
         <https://zia207.github.io/geospatial-r-github.io/geographically-weighted-poisson-regression.html>
         - Global and local (Geographically Weighted) Random Forest
         <https://zia207.github.io/geospatial-r-github.io/geographically-wighted-random-forest.html>



*3. **Spatial Interpolation*
<https://zia207.github.io/geospatial-r-github.io/spatial-interpolation.html>



?         Spatial Interpolation
<https://zia207.github.io/geospatial-r-github.io/spatial-interpolation.html>

o    Deterministic Methods for Spatial Interpolation
<https://zia207.github.io/geospatial-r-github.io/deterministic-methods-for-spatial-interpolation.html>

?  Polynomial Trend Surface

?  Proximity Analysis-Thiessen Polygons

?  Nearest Neighbor Interpolation

?  Inverse Distance Weighted

?  Thin Plate Spline

o    Geostatistical Methods for Spatial Interpolation
<https://zia207.github.io/geospatial-r-github.io/geostatistical-methods-for-spatial-interpolation.html>

?  Semivariogram Modeling
<https://zia207.github.io/geospatial-r-github.io/semivariogram-modeling.html>

?  Kriging <https://zia207.github.io/geospatial-r-github.io/kriging.html>

?  Ordinary Kriging
<https://zia207.github.io/geospatial-r-github.io/ordinary-kriging.html>

?  Universal Kriging
<https://zia207.github.io/geospatial-r-github.io/universal-kriging.html>

?  Co-Kriging
<https://zia207.github.io/geospatial-r-github.io/cokriging.html>

?  Regression kriging
<https://zia207.github.io/geospatial-r-github.io/regression-kriging.html>

?  Generalized Linear Model

?  Random Forest

?  Meta Ensemble Machine Learning

?  Indicator kriging
<https://zia207.github.io/geospatial-r-github.io/indicator-kriging.html>

?         Assessing the Quality of Spatial Predictions
<https://zia207.github.io/geospatial-r-github.io/assessing-quality-spatial-predictions.html>

o    Cross-validation
<https://zia207.github.io/geospatial-r-github.io/cross-validation.html>

o    Validation with an Independent Dataset
<https://zia207.github.io/geospatial-r-github.io/validation-independent-dataset.html>

o    Conditional Simulation for Spatial Uncertainty
<https://zia207.github.io/geospatial-r-github.io/conditional-simulation-spatial-uncertainty.html>



*4. **Remote Sensing Data Processing and Analysis*
<https://zia207.github.io/geospatial-r-github.io/about-c.html>

?
Remote Sensing Basic
<https://zia207.github.io/geospatial-r-github.io/reomte-sensing-basic.html>

?         Landsat 8 Image Processing & Visualization
<https://zia207.github.io/geospatial-r-github.io/landsat-8-image-processing.html>

o    RGB image comparison

o    Pan Sharpening or Image Fusion

o    Radiometric Calibration and Atmospheric Correction

?         Spectral Indices
<https://zia207.github.io/geospatial-r-github.io/spectral-indices.html>

o    Normalized Difference Vegetation Index

o    Soil Adjusted Vegetation Index (SAVI)

o    Modified soil Adjusted Vegetation Index (MSAVI)

o    Enhanced Vegetation Index (EVI)

o    Two-bands Enhanced Vegetation (EVI2)

o    Normalized Difference Water Index (NDWI)

?         Green Ground Cover from UAV Images
<https://zia207.github.io/geospatial-r-github.io/uav-ground-cover.html>

?         Texture Analysis
<https://zia207.github.io/geospatial-r-github.io/texture-analysis.html>

?         Image Classification
<https://zia207.github.io/geospatial-r-github.io/image-classification.html>

o    Ground Truth Data Processing
<https://zia207.github.io/geospatial-r-github.io/ground-truth-data-processing.html>

o    Unsupervised Classification
<https://zia207.github.io/geospatial-r-github.io/unsupervised-classification.html>

o    Supervised Classification
<https://zia207.github.io/geospatial-r-github.io/supervised-classification.html>

?  Random Forest
<https://zia207.github.io/geospatial-r-github.io/random-forest.html>

?  Support Vector Machine
<https://zia207.github.io/geospatial-r-github.io/support-vector-machine.html>

?  Na?ve Bayes
<https://zia207.github.io/geospatial-r-github.io/naive-bayes.html>

?  eXBoost <https://zia207.github.io/geospatial-r-github.io/exboost.html>

?  Deep Learning-H2O
<https://zia207.github.io/geospatial-r-github.io/deep-learning-h2o.html>

?  Stack-Ensemble-H20
<https://zia207.github.io/geospatial-r-github.io/stack-ensemble-h2o.html>

?  Deep Learning Keras-TensorFlow
<https://zia207.github.io/geospatial-r-github.io/deep-learning-keras-tensorflow.html>

	[[alternative HTML version deleted]]


From @|ex@ndre@@nto@br @end|ng |rom y@hoo@com@br  Thu Jan  9 15:35:19 2020
From: @|ex@ndre@@nto@br @end|ng |rom y@hoo@com@br (ASANTOS)
Date: Thu, 9 Jan 2020 10:35:19 -0400
Subject: [R-sig-Geo] Comparing distance among point pattern events
In-Reply-To: <CAM_vjukvthJGT8XBBNOPnaCYVWbk+bZCNdXrdP2ztt94CjJ00w@mail.gmail.com>
References: <14602263-48a5-46a4-26db-096fa3626473.ref@yahoo.com.br>
 <14602263-48a5-46a4-26db-096fa3626473@yahoo.com.br>
 <CAM_vjukvthJGT8XBBNOPnaCYVWbk+bZCNdXrdP2ztt94CjJ00w@mail.gmail.com>
Message-ID: <23d44e3c-7f03-2aae-aefe-dbddb3878f09@yahoo.com.br>

Dear R-Sig-Geo Members,

I have the three hypothetical point process situation (A, B and C) and my question is: What point distribution (B or C) is more close to A?

For this problem, I make a simple example:

library(spatstat)
set.seed(2023)
A <- rpoispp(30) ## First event
B <- rpoispp(30) ## Second event
C <- rThomas(10,0.02,5) ## Third event with Thomas cluster process
plot(A, pch=16)
plot(B, col="red", add=T)
plot(C, col="blue", add=T)

First, I takesthe distances between pairs of events:

ABd<-crossdist(A, B)
ACd<-crossdist(A, C)

mean(ABd)
# 0.4846027
mean(ACd)
# 0.5848766



# test the hypothesis that ABd is equal to ACd courtesy of Sarah Goslee

nperm <- 999

permout <- data.frame(ABd = rep(NA, nperm), ACd = rep(NA, nperm))

# create framework for a random assignment of B and C to the existing points

BC <- superimpose(B, C)
B.len <- npoints(B)
C.len <- npoints(C)
B.sampvect <- c(rep(TRUE, B.len), rep(FALSE, C.len))

set.seed(2023)
for(i in seq_len(nperm)) {
 ??? B.sampvect <- sample(B.sampvect)
 ??? B.perm <- BC[B.sampvect]
 ??? C.perm <- BC[!B.sampvect]

 ??? permout[i, ] <- c(mean(crossdist(A, B.perm)), mean(crossdist(A, C.perm)))
}


boxplot(permout$ABd - permout$ACd)
points(1, mean(ABd) - mean(ACd), col="red")

table(abs(mean(ABd) - mean(ACd)) >= abs(permout$ABd - permout$ACd))
#TRUE
# 999

sum(abs(mean(ABd) - mean(ACd)) >= abs(permout$ABd - permout$ACd)) / nperm
# [1] 1


The difference between ACd and ABd is distinguishable from that obtained by a random resampling of B and C.
Then B (0.4846027) is more close to A, that C (0.5848766).


But, now I comparing the distance to mean nearest neighbour and minimum distance between each pair of types:

marks(A)<-as.factor("A")
marks(B)<-as.factor("B")
marks(C)<-as.factor("C")

# distance to nearest neighbour A to B
nnda <- nncross(A,B, by=marks(A,B))

# mean nearest neighbour distances
mean(nnda[,1])
#[1] 0.09847543

# distance to nearest neighbour A to C
nndb <- nncross(A,C, by=marks(A,C))

# mean nearest neighbour distances
mean(nndb[,1])
#[1] 0.151127

# test again the hypothesis that ABd is equal to ACd

nperm <- 999

permout <- data.frame(ABd = rep(NA, nperm), ACd = rep(NA, nperm))

# create framework for a random assignment of B and C to the existing points

BC <- superimpose(B, C)
B.len <- npoints(B)
C.len <- npoints(C)
B.sampvect <- c(rep(TRUE, B.len), rep(FALSE, C.len))

set.seed(2023)
for(i in seq_len(nperm)) {
     B.sampvect <- sample(B.sampvect)
     B.perm <- BC[B.sampvect]
     C.perm <- BC[!B.sampvect]
     ab<-nncross(A, B.perm)
     ac<-nncross(A, C.perm)

     permout[i, ] <- c(mean(ab[,1]), mean(ac[,1]))
}


boxplot(permout$ABd - permout$ACd)
points(1, mean(nnda[,1]) - mean(nndb[,1]), col="red")

table(abs(mean(nnda[,1]) - mean(nndb[,1])) >= abs(permout$ABd - permout$ACd))
#FALSE  TRUE
#   91   908

sum(abs(mean(nnda[,1]) - mean(nndb[,1])) >= abs(permout$ABd - permout$ACd)) / nperm
#[1] 0.9089089


Now, the same conclusion or the mean nearest neighbour distances of A to B (0.10887343) is smaller than A to C (0.151127),
but is not so clear for me, what is the better approach if a comparing crossdist() and nndist () results for a good answer to my question?

Any conceptual tips?

Thanks in advance,

-- 
Alexandre dos Santos
Geotechnologies and Spatial Statistics applied to Forest Entomology
Instituto Federal de Mato Grosso (IFMT) - Campus Caceres
Caixa Postal 244 (PO Box)
Avenida dos Ramires, s/n - Distrito Industrial
Caceres - MT - CEP 78.200-000 (ZIP code)
Phone: (+55) 65 99686-6970 / (+55) 65 3221-2674
Lattes CV: http://lattes.cnpq.br/1360403201088680
OrcID: orcid.org/0000-0001-8232-6722
ResearchGate: www.researchgate.net/profile/Alexandre_Santos10
Publons: https://publons.com/researcher/3085587/alexandre-dos-santos/
--

Em 22/11/2019 10:09, Sarah Goslee escreveu:
> Hi,
>
> Great question, and clear example.
>
> The first problem:
> ACd<-pairdist(A) instead of ACd <- pairdist(AC)
>
> BUT
>
> pairdist() is the wrong function: that calculates the mean distance
> between ALL points, A to A and C to C as well as A to C.
>
> You need crossdist() instead.
>
> The most flexible approach is to roll your own permutation test. That
> will work even if B and C are different sizes, etc. If you specify the
> problem more exactly, there are probably parametric tests, but I like
> permutation tests.
>
>
> library(spatstat)
> set.seed(2019)
> A <- rpoispp(100) ## First event
> B <- rpoispp(50) ## Second event
> C <- rpoispp(50) ## Third event
> plot(A, pch=16)
> plot(B, col="red", add=T)
> plot(C, col="blue", add=T)
>
> ABd<-crossdist(A, B)
> ACd<-crossdist(A, C)
>
> mean(ABd)
> # 0.5168865
> mean(ACd)
> # 0.5070118
>
>
> # test the hypothesis that ABd is equal to ACd
>
> nperm <- 999
>
> permout <- data.frame(ABd = rep(NA, nperm), ACd = rep(NA, nperm))
>
> # create framework for a random assignment of B and C to the existing points
>
> BC <- superimpose(B, C)
> B.len <- npoints(B)
> C.len <- npoints(C)
> B.sampvect <- c(rep(TRUE, B.len), rep(FALSE, C.len))
>
> set.seed(2019)
> for(i in seq_len(nperm)) {
>      B.sampvect <- sample(B.sampvect)
>      B.perm <- BC[B.sampvect]
>      C.perm <- BC[!B.sampvect]
>
>      permout[i, ] <- c(mean(crossdist(A, B.perm)), mean(crossdist(A, C.perm)))
> }
>
>
> boxplot(permout$ABd - permout$ACd)
> points(1, mean(ABd) - mean(ACd), col="red")
>
> table(abs(mean(ABd) - mean(ACd)) >= abs(permout$ABd - permout$ACd))
> # FALSE  TRUE
> #  573   426
>
> sum(abs(mean(ABd) - mean(ACd)) >= abs(permout$ABd - permout$ACd)) / nperm
> # 0.4264264
>
> The difference between ACd and ABd is indistinguishable from that
> obtained by a random resampling of B and C.
>
>
> Sarah
>
> On Fri, Nov 22, 2019 at 8:26 AM ASANTOS via R-sig-Geo
> <r-sig-geo at r-project.org> wrote:
>> Dear R-Sig-Geo Members,
>>
>> I have the hypothetical point process situation:
>>
>> library(spatstat)
>> set.seed(2019)
>> A <- rpoispp(100) ## First event
>> B <- rpoispp(50) ## Second event
>> C <- rpoispp(50) ## Third event
>> plot(A, pch=16)
>> plot(B, col="red", add=T)
>> plot(C, col="blue", add=T)
>>
>> I've like to know an adequate spatial approach for comparing if on
>> average the event B or C is more close to A. For this, I try to make:
>>
>> AB<-superimpose(A,B)
>> ABd<-pairdist(AB)
>> AC<-superimpose(A,C)
>> ACd<-pairdist(A)
>> mean(ABd)
>> #[1] 0.5112954
>> mean(ACd)
>> #[1] 0.5035042
>>
>> With this naive approach, I concluded that event C is more close of A
>> that B. This sounds enough for a final conclusion or more robust
>> analysis is possible?
>>
>> Thanks in advance,
>>
>> Alexandre
>>

	[[alternative HTML version deleted]]


From @|ex@ndre@@nto@br @end|ng |rom y@hoo@com@br  Thu Jan  9 15:35:19 2020
From: @|ex@ndre@@nto@br @end|ng |rom y@hoo@com@br (ASANTOS)
Date: Thu, 9 Jan 2020 10:35:19 -0400
Subject: [R-sig-Geo] Comparing distance among point pattern events
In-Reply-To: <CAM_vjukvthJGT8XBBNOPnaCYVWbk+bZCNdXrdP2ztt94CjJ00w@mail.gmail.com>
References: <14602263-48a5-46a4-26db-096fa3626473.ref@yahoo.com.br>
 <14602263-48a5-46a4-26db-096fa3626473@yahoo.com.br>
 <CAM_vjukvthJGT8XBBNOPnaCYVWbk+bZCNdXrdP2ztt94CjJ00w@mail.gmail.com>
Message-ID: <23d44e3c-7f03-2aae-aefe-dbddb3878f09@yahoo.com.br>

Dear R-Sig-Geo Members,

I have the three hypothetical point process situation (A, B and C) and my question is: What point distribution (B or C) is more close to A?

For this problem, I make a simple example:

library(spatstat)
set.seed(2023)
A <- rpoispp(30) ## First event
B <- rpoispp(30) ## Second event
C <- rThomas(10,0.02,5) ## Third event with Thomas cluster process
plot(A, pch=16)
plot(B, col="red", add=T)
plot(C, col="blue", add=T)

First, I takesthe distances between pairs of events:

ABd<-crossdist(A, B)
ACd<-crossdist(A, C)

mean(ABd)
# 0.4846027
mean(ACd)
# 0.5848766



# test the hypothesis that ABd is equal to ACd courtesy of Sarah Goslee

nperm <- 999

permout <- data.frame(ABd = rep(NA, nperm), ACd = rep(NA, nperm))

# create framework for a random assignment of B and C to the existing points

BC <- superimpose(B, C)
B.len <- npoints(B)
C.len <- npoints(C)
B.sampvect <- c(rep(TRUE, B.len), rep(FALSE, C.len))

set.seed(2023)
for(i in seq_len(nperm)) {
 ??? B.sampvect <- sample(B.sampvect)
 ??? B.perm <- BC[B.sampvect]
 ??? C.perm <- BC[!B.sampvect]

 ??? permout[i, ] <- c(mean(crossdist(A, B.perm)), mean(crossdist(A, C.perm)))
}


boxplot(permout$ABd - permout$ACd)
points(1, mean(ABd) - mean(ACd), col="red")

table(abs(mean(ABd) - mean(ACd)) >= abs(permout$ABd - permout$ACd))
#TRUE
# 999

sum(abs(mean(ABd) - mean(ACd)) >= abs(permout$ABd - permout$ACd)) / nperm
# [1] 1


The difference between ACd and ABd is distinguishable from that obtained by a random resampling of B and C.
Then B (0.4846027) is more close to A, that C (0.5848766).


But, now I comparing the distance to mean nearest neighbour and minimum distance between each pair of types:

marks(A)<-as.factor("A")
marks(B)<-as.factor("B")
marks(C)<-as.factor("C")

# distance to nearest neighbour A to B
nnda <- nncross(A,B, by=marks(A,B))

# mean nearest neighbour distances
mean(nnda[,1])
#[1] 0.09847543

# distance to nearest neighbour A to C
nndb <- nncross(A,C, by=marks(A,C))

# mean nearest neighbour distances
mean(nndb[,1])
#[1] 0.151127

# test again the hypothesis that ABd is equal to ACd

nperm <- 999

permout <- data.frame(ABd = rep(NA, nperm), ACd = rep(NA, nperm))

# create framework for a random assignment of B and C to the existing points

BC <- superimpose(B, C)
B.len <- npoints(B)
C.len <- npoints(C)
B.sampvect <- c(rep(TRUE, B.len), rep(FALSE, C.len))

set.seed(2023)
for(i in seq_len(nperm)) {
     B.sampvect <- sample(B.sampvect)
     B.perm <- BC[B.sampvect]
     C.perm <- BC[!B.sampvect]
     ab<-nncross(A, B.perm)
     ac<-nncross(A, C.perm)

     permout[i, ] <- c(mean(ab[,1]), mean(ac[,1]))
}


boxplot(permout$ABd - permout$ACd)
points(1, mean(nnda[,1]) - mean(nndb[,1]), col="red")

table(abs(mean(nnda[,1]) - mean(nndb[,1])) >= abs(permout$ABd - permout$ACd))
#FALSE  TRUE
#   91   908

sum(abs(mean(nnda[,1]) - mean(nndb[,1])) >= abs(permout$ABd - permout$ACd)) / nperm
#[1] 0.9089089


Now, the same conclusion or the mean nearest neighbour distances of A to B (0.10887343) is smaller than A to C (0.151127),
but is not so clear for me, what is the better approach if a comparing crossdist() and nndist () results for a good answer to my question?

Any conceptual tips?

Thanks in advance,

-- 
Alexandre dos Santos
Geotechnologies and Spatial Statistics applied to Forest Entomology
Instituto Federal de Mato Grosso (IFMT) - Campus Caceres
Caixa Postal 244 (PO Box)
Avenida dos Ramires, s/n - Distrito Industrial
Caceres - MT - CEP 78.200-000 (ZIP code)
Phone: (+55) 65 99686-6970 / (+55) 65 3221-2674
Lattes CV: http://lattes.cnpq.br/1360403201088680
OrcID: orcid.org/0000-0001-8232-6722
ResearchGate: www.researchgate.net/profile/Alexandre_Santos10
Publons: https://publons.com/researcher/3085587/alexandre-dos-santos/
--

Em 22/11/2019 10:09, Sarah Goslee escreveu:
> Hi,
>
> Great question, and clear example.
>
> The first problem:
> ACd<-pairdist(A) instead of ACd <- pairdist(AC)
>
> BUT
>
> pairdist() is the wrong function: that calculates the mean distance
> between ALL points, A to A and C to C as well as A to C.
>
> You need crossdist() instead.
>
> The most flexible approach is to roll your own permutation test. That
> will work even if B and C are different sizes, etc. If you specify the
> problem more exactly, there are probably parametric tests, but I like
> permutation tests.
>
>
> library(spatstat)
> set.seed(2019)
> A <- rpoispp(100) ## First event
> B <- rpoispp(50) ## Second event
> C <- rpoispp(50) ## Third event
> plot(A, pch=16)
> plot(B, col="red", add=T)
> plot(C, col="blue", add=T)
>
> ABd<-crossdist(A, B)
> ACd<-crossdist(A, C)
>
> mean(ABd)
> # 0.5168865
> mean(ACd)
> # 0.5070118
>
>
> # test the hypothesis that ABd is equal to ACd
>
> nperm <- 999
>
> permout <- data.frame(ABd = rep(NA, nperm), ACd = rep(NA, nperm))
>
> # create framework for a random assignment of B and C to the existing points
>
> BC <- superimpose(B, C)
> B.len <- npoints(B)
> C.len <- npoints(C)
> B.sampvect <- c(rep(TRUE, B.len), rep(FALSE, C.len))
>
> set.seed(2019)
> for(i in seq_len(nperm)) {
>      B.sampvect <- sample(B.sampvect)
>      B.perm <- BC[B.sampvect]
>      C.perm <- BC[!B.sampvect]
>
>      permout[i, ] <- c(mean(crossdist(A, B.perm)), mean(crossdist(A, C.perm)))
> }
>
>
> boxplot(permout$ABd - permout$ACd)
> points(1, mean(ABd) - mean(ACd), col="red")
>
> table(abs(mean(ABd) - mean(ACd)) >= abs(permout$ABd - permout$ACd))
> # FALSE  TRUE
> #  573   426
>
> sum(abs(mean(ABd) - mean(ACd)) >= abs(permout$ABd - permout$ACd)) / nperm
> # 0.4264264
>
> The difference between ACd and ABd is indistinguishable from that
> obtained by a random resampling of B and C.
>
>
> Sarah
>
> On Fri, Nov 22, 2019 at 8:26 AM ASANTOS via R-sig-Geo
> <r-sig-geo at r-project.org> wrote:
>> Dear R-Sig-Geo Members,
>>
>> I have the hypothetical point process situation:
>>
>> library(spatstat)
>> set.seed(2019)
>> A <- rpoispp(100) ## First event
>> B <- rpoispp(50) ## Second event
>> C <- rpoispp(50) ## Third event
>> plot(A, pch=16)
>> plot(B, col="red", add=T)
>> plot(C, col="blue", add=T)
>>
>> I've like to know an adequate spatial approach for comparing if on
>> average the event B or C is more close to A. For this, I try to make:
>>
>> AB<-superimpose(A,B)
>> ABd<-pairdist(AB)
>> AC<-superimpose(A,C)
>> ACd<-pairdist(A)
>> mean(ABd)
>> #[1] 0.5112954
>> mean(ACd)
>> #[1] 0.5035042
>>
>> With this naive approach, I concluded that event C is more close of A
>> that B. This sounds enough for a final conclusion or more robust
>> analysis is possible?
>>
>> Thanks in advance,
>>
>> Alexandre
>>

	[[alternative HTML version deleted]]


From b@k@ry|@ty @end|ng |rom gm@||@com  Thu Jan  9 17:41:11 2020
From: b@k@ry|@ty @end|ng |rom gm@||@com (Bakary Faty)
Date: Thu, 9 Jan 2020 16:41:11 +0000
Subject: [R-sig-Geo] Help
Message-ID: <CA+2FMU7qAjEgyPkF4FJZ1XqG_sFs5=5VfZugF0t3VSFFGdHOzg@mail.gmail.com>

Dear,

I'm writing to express my wish to join R-sig-geo list users.
I was doing a search on the net to know how to build an isohyet map and I
came across this R code.
However, I stumbled upon a problem from the line :
grd <- expand.grid(x=seq(minx, maxx, by=pixel), y=seq(miny, maxy,
by=pixel)),
I get the following error message:
default method not implemented for type 'S4'. I want to know how resolve
this error.

Also, I would like to ask you only at the line level:
minx <- rain_data_UTM at bbox[1,1]
maxx <- rain_data_UTM at bbox[1,2]
miny <- rain_data_UTM at bbox[2,1]
maxy <- rain_data_UTM at bbox[2,2],
if I should limit myself to "rain_data_UTM" or write completely:
rain_data_UTM at bbox[,].
 By the way, this is the pointfile I reconstructed.
You can find it attached to the mail.

Thanks in advance

Best regards



Bakary

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20200109/d9f74a20/attachment.html>

-------------- next part --------------
A non-text attachment was scrubbed...
Name: pointfile.csv
Type: application/vnd.ms-excel
Size: 241 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20200109/d9f74a20/attachment.xlb>

From btupper @end|ng |rom b|ge|ow@org  Thu Jan  9 18:47:27 2020
From: btupper @end|ng |rom b|ge|ow@org (Ben Tupper)
Date: Thu, 9 Jan 2020 12:47:27 -0500
Subject: [R-sig-Geo] Help
In-Reply-To: <CA+2FMU7qAjEgyPkF4FJZ1XqG_sFs5=5VfZugF0t3VSFFGdHOzg@mail.gmail.com>
References: <CA+2FMU7qAjEgyPkF4FJZ1XqG_sFs5=5VfZugF0t3VSFFGdHOzg@mail.gmail.com>
Message-ID: <CALrbzg2QJqn2YaGX0g8-X4GE2YfQgffEH9LUJVo6=N1oErmFzA@mail.gmail.com>

Welcome to r-sig-geo!

I don't think that you haven't provided us enough information so that we
can help.  On the other hand, does the example below using expand.grid help?

minx <- 20
maxx <- 25
miny <- 31
maxy <- 36
pixel <- 1
grd <- expand.grid(x = seq(minx, maxx, by=pixel), y = seq(miny, maxy,
by=pixel))

Ben

On Thu, Jan 9, 2020 at 11:41 AM Bakary Faty <bakaryfaty at gmail.com> wrote:

>
> Dear,
>
> I'm writing to express my wish to join R-sig-geo list users.
> I was doing a search on the net to know how to build an isohyet map and I
> came across this R code.
> However, I stumbled upon a problem from the line :
> grd <- expand.grid(x=seq(minx, maxx, by=pixel), y=seq(miny, maxy,
> by=pixel)),
> I get the following error message:
> default method not implemented for type 'S4'. I want to know how resolve
> this error.
>
> Also, I would like to ask you only at the line level:
> minx <- rain_data_UTM at bbox[1,1]
> maxx <- rain_data_UTM at bbox[1,2]
> miny <- rain_data_UTM at bbox[2,1]
> maxy <- rain_data_UTM at bbox[2,2],
> if I should limit myself to "rain_data_UTM" or write completely:
> rain_data_UTM at bbox[,].
>  By the way, this is the pointfile I reconstructed.
> You can find it attached to the mail.
>
> Thanks in advance
>
> Best regards
>
>
>
> Bakary
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


-- 
Ben Tupper
Bigelow Laboratory for Ocean Science
West Boothbay Harbor, Maine
http://www.bigelow.org/
https://eco.bigelow.org

	[[alternative HTML version deleted]]


From b@k@ry|@ty @end|ng |rom gm@||@com  Thu Jan  9 20:02:07 2020
From: b@k@ry|@ty @end|ng |rom gm@||@com (Bakary Faty)
Date: Thu, 9 Jan 2020 19:02:07 +0000
Subject: [R-sig-Geo] Help
In-Reply-To: <CA+2FMU5Sjh55m9S9iDd_MTcLbwFTGkAe1mgBp=0QGp7=J77VYg@mail.gmail.com>
References: <CA+2FMU7qAjEgyPkF4FJZ1XqG_sFs5=5VfZugF0t3VSFFGdHOzg@mail.gmail.com>
 <CALrbzg2QJqn2YaGX0g8-X4GE2YfQgffEH9LUJVo6=N1oErmFzA@mail.gmail.com>
 <CA+2FMU5Sjh55m9S9iDd_MTcLbwFTGkAe1mgBp=0QGp7=J77VYg@mail.gmail.com>
Message-ID: <CA+2FMU7oCx5eQ2asYCeByWm_OOmM20ZQme21PjEBQQBYV8=zXw@mail.gmail.com>

Thank you for appreciated reply,

I explane you exactly what I want to do with this R code attached.
I want to adapt this code to my data to build an isohyet map.
But i have some difficulties to adapt it to my case.
I will be very happy when you will help my to adapt this R code (attached)
to my case.
You can find attached the you R code and my data file.
Best regards

Le jeu. 9 janv. 2020 ? 18:41, Bakary Faty <bakaryfaty at gmail.com> a ?crit :

> Thank you for appreciated reply,
>
> I explane you exactly what I want to do with this R code attached.
> I want to adapt this code to my data to build an isohyet map.
> But i have some difficulties to adapt it to my case.
> I will be very happy when you will help my to adapt this R code (attached)
> to my case.
> You can find attached the you R code, my data file and my sahefile of
> watershed.
>
> Best regards
>
>
> Le jeu. 9 janv. 2020 ? 17:47, Ben Tupper <btupper at bigelow.org> a ?crit :
>
>> Welcome to r-sig-geo!
>>
>> I don't think that you haven't provided us enough information so that we
>> can help.  On the other hand, does the example below using expand.grid help?
>>
>> minx <- 20
>> maxx <- 25
>> miny <- 31
>> maxy <- 36
>> pixel <- 1
>> grd <- expand.grid(x = seq(minx, maxx, by=pixel), y = seq(miny, maxy,
>> by=pixel))
>>
>> Ben
>>
>> On Thu, Jan 9, 2020 at 11:41 AM Bakary Faty <bakaryfaty at gmail.com> wrote:
>>
>>>
>>> Dear,
>>>
>>> I'm writing to express my wish to join R-sig-geo list users.
>>> I was doing a search on the net to know how to build an isohyet map and
>>> I came across this R code.
>>> However, I stumbled upon a problem from the line :
>>> grd <- expand.grid(x=seq(minx, maxx, by=pixel), y=seq(miny, maxy,
>>> by=pixel)),
>>> I get the following error message:
>>> default method not implemented for type 'S4'. I want to know how resolve
>>> this error.
>>>
>>> Also, I would like to ask you only at the line level:
>>> minx <- rain_data_UTM at bbox[1,1]
>>> maxx <- rain_data_UTM at bbox[1,2]
>>> miny <- rain_data_UTM at bbox[2,1]
>>> maxy <- rain_data_UTM at bbox[2,2],
>>> if I should limit myself to "rain_data_UTM" or write completely:
>>> rain_data_UTM at bbox[,].
>>>  By the way, this is the pointfile I reconstructed.
>>> You can find it attached to the mail.
>>>
>>> Thanks in advance
>>>
>>> Best regards
>>>
>>>
>>>
>>> Bakary
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>>
>> --
>> Ben Tupper
>> Bigelow Laboratory for Ocean Science
>> West Boothbay Harbor, Maine
>> http://www.bigelow.org/
>> https://eco.bigelow.org
>>
>>
>
> --
>
>
>
> Bakary
>


-- 



Bakary

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20200109/c66442bc/attachment.html>

-------------- next part --------------
A non-text attachment was scrubbed...
Name: DATAFILE_FOR_ISOHYET.csv
Type: application/vnd.ms-excel
Size: 1240 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20200109/c66442bc/attachment.xlb>

-------------- next part --------------
A non-text attachment was scrubbed...
Name: R_code_for_rainfall_isohyet_map.R
Type: application/octet-stream
Size: 1596 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20200109/c66442bc/attachment.obj>

From btupper @end|ng |rom b|ge|ow@org  Thu Jan  9 20:05:22 2020
From: btupper @end|ng |rom b|ge|ow@org (Ben Tupper)
Date: Thu, 9 Jan 2020 14:05:22 -0500
Subject: [R-sig-Geo] Help
In-Reply-To: <CA+2FMU5Sjh55m9S9iDd_MTcLbwFTGkAe1mgBp=0QGp7=J77VYg@mail.gmail.com>
References: <CA+2FMU7qAjEgyPkF4FJZ1XqG_sFs5=5VfZugF0t3VSFFGdHOzg@mail.gmail.com>
 <CALrbzg2QJqn2YaGX0g8-X4GE2YfQgffEH9LUJVo6=N1oErmFzA@mail.gmail.com>
 <CA+2FMU5Sjh55m9S9iDd_MTcLbwFTGkAe1mgBp=0QGp7=J77VYg@mail.gmail.com>
Message-ID: <CALrbzg3L=v+h1mSmrJFZYfG3ixMAqR28FHGwJfisQr2+N-hXZQ@mail.gmail.com>

Your assignments that look like...

minx <-  rain_data_UTM at bbox[1,1]

are not valid R statements - and that will cause an error.  Instead,
obtain a matrix of the bounding box using the bbox() function.  Then
extract your coordinates from that. I think you want...

bb <- bbox(rain_data_UTM)
minx <- bb[1,1]
maxx <- bb[1,2]
miny <- bb[2,1]
maxy <- bb[2,2]

If you haven't seen this, https://www.rspatial.org/ , it is well worth your
time.  There are a lot of other great resources about using spatial data in
R.  Try searching the Rseek.org. Like this
https://rseek.org/?q=spatial+tutorials  It is a gold mine.


On Thu, Jan 9, 2020 at 1:42 PM Bakary Faty <bakaryfaty at gmail.com> wrote:

> Thank you for appreciated reply,
>
> I explane you exactly what I want to do with this R code attached.
> I want to adapt this code to my data to build an isohyet map.
> But i have some difficulties to adapt it to my case.
> I will be very happy when you will help my to adapt this R code (attached)
> to my case.
> You can find attached the you R code, my data file and my sahefile of
> watershed.
>
> Best regards
>
>
> Le jeu. 9 janv. 2020 ? 17:47, Ben Tupper <btupper at bigelow.org> a ?crit :
>
>> Welcome to r-sig-geo!
>>
>> I don't think that you haven't provided us enough information so that we
>> can help.  On the other hand, does the example below using expand.grid help?
>>
>> minx <- 20
>> maxx <- 25
>> miny <- 31
>> maxy <- 36
>> pixel <- 1
>> grd <- expand.grid(x = seq(minx, maxx, by=pixel), y = seq(miny, maxy,
>> by=pixel))
>>
>> Ben
>>
>> On Thu, Jan 9, 2020 at 11:41 AM Bakary Faty <bakaryfaty at gmail.com> wrote:
>>
>>>
>>> Dear,
>>>
>>> I'm writing to express my wish to join R-sig-geo list users.
>>> I was doing a search on the net to know how to build an isohyet map and
>>> I came across this R code.
>>> However, I stumbled upon a problem from the line :
>>> grd <- expand.grid(x=seq(minx, maxx, by=pixel), y=seq(miny, maxy,
>>> by=pixel)),
>>> I get the following error message:
>>> default method not implemented for type 'S4'. I want to know how resolve
>>> this error.
>>>
>>> Also, I would like to ask you only at the line level:
>>> minx <- rain_data_UTM at bbox[1,1]
>>> maxx <- rain_data_UTM at bbox[1,2]
>>> miny <- rain_data_UTM at bbox[2,1]
>>> maxy <- rain_data_UTM at bbox[2,2],
>>> if I should limit myself to "rain_data_UTM" or write completely:
>>> rain_data_UTM at bbox[,].
>>>  By the way, this is the pointfile I reconstructed.
>>> You can find it attached to the mail.
>>>
>>> Thanks in advance
>>>
>>> Best regards
>>>
>>>
>>>
>>> Bakary
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>>
>> --
>> Ben Tupper
>> Bigelow Laboratory for Ocean Science
>> West Boothbay Harbor, Maine
>> http://www.bigelow.org/
>> https://eco.bigelow.org
>>
>>
>
> --
>
>
>
> Bakary
>


-- 
Ben Tupper
Bigelow Laboratory for Ocean Science
West Boothbay Harbor, Maine
http://www.bigelow.org/
https://eco.bigelow.org

	[[alternative HTML version deleted]]


From b@k@ry|@ty @end|ng |rom gm@||@com  Thu Jan  9 20:13:48 2020
From: b@k@ry|@ty @end|ng |rom gm@||@com (Bakary Faty)
Date: Thu, 9 Jan 2020 19:13:48 +0000
Subject: [R-sig-Geo] Help
In-Reply-To: <CALrbzg3L=v+h1mSmrJFZYfG3ixMAqR28FHGwJfisQr2+N-hXZQ@mail.gmail.com>
References: <CA+2FMU7qAjEgyPkF4FJZ1XqG_sFs5=5VfZugF0t3VSFFGdHOzg@mail.gmail.com>
 <CALrbzg2QJqn2YaGX0g8-X4GE2YfQgffEH9LUJVo6=N1oErmFzA@mail.gmail.com>
 <CA+2FMU5Sjh55m9S9iDd_MTcLbwFTGkAe1mgBp=0QGp7=J77VYg@mail.gmail.com>
 <CALrbzg3L=v+h1mSmrJFZYfG3ixMAqR28FHGwJfisQr2+N-hXZQ@mail.gmail.com>
Message-ID: <CA+2FMU7P-wP0N+z0M3f+sA1NQmUtX5pa5NE6pg3f4wnJTSgWOw@mail.gmail.com>

Thanks very much angain,
 I'll check them out.

Best regards

Le jeu. 9 janv. 2020 ? 19:05, Ben Tupper <btupper at bigelow.org> a ?crit :

> Your assignments that look like...
>
> minx <-  rain_data_UTM at bbox[1,1]
>
> are not valid R statements - and that will cause an error.  Instead,
> obtain a matrix of the bounding box using the bbox() function.  Then
> extract your coordinates from that. I think you want...
>
> bb <- bbox(rain_data_UTM)
> minx <- bb[1,1]
> maxx <- bb[1,2]
> miny <- bb[2,1]
> maxy <- bb[2,2]
>
> If you haven't seen this, https://www.rspatial.org/ , it is well worth
> your time.  There are a lot of other great resources about using spatial
> data in R.  Try searching the Rseek.org. Like this
> https://rseek.org/?q=spatial+tutorials  It is a gold mine.
>
>
> On Thu, Jan 9, 2020 at 1:42 PM Bakary Faty <bakaryfaty at gmail.com> wrote:
>
>> Thank you for appreciated reply,
>>
>> I explane you exactly what I want to do with this R code attached.
>> I want to adapt this code to my data to build an isohyet map.
>> But i have some difficulties to adapt it to my case.
>> I will be very happy when you will help my to adapt this R code (attached)
>> to my case.
>> You can find attached the you R code, my data file and my sahefile of
>> watershed.
>>
>> Best regards
>>
>>
>> Le jeu. 9 janv. 2020 ? 17:47, Ben Tupper <btupper at bigelow.org> a ?crit :
>>
>>> Welcome to r-sig-geo!
>>>
>>> I don't think that you haven't provided us enough information so that we
>>> can help.  On the other hand, does the example below using expand.grid help?
>>>
>>> minx <- 20
>>> maxx <- 25
>>> miny <- 31
>>> maxy <- 36
>>> pixel <- 1
>>> grd <- expand.grid(x = seq(minx, maxx, by=pixel), y = seq(miny, maxy,
>>> by=pixel))
>>>
>>> Ben
>>>
>>> On Thu, Jan 9, 2020 at 11:41 AM Bakary Faty <bakaryfaty at gmail.com>
>>> wrote:
>>>
>>>>
>>>> Dear,
>>>>
>>>> I'm writing to express my wish to join R-sig-geo list users.
>>>> I was doing a search on the net to know how to build an isohyet map and
>>>> I came across this R code.
>>>> However, I stumbled upon a problem from the line :
>>>> grd <- expand.grid(x=seq(minx, maxx, by=pixel), y=seq(miny, maxy,
>>>> by=pixel)),
>>>> I get the following error message:
>>>> default method not implemented for type 'S4'. I want to know how
>>>> resolve this error.
>>>>
>>>> Also, I would like to ask you only at the line level:
>>>> minx <- rain_data_UTM at bbox[1,1]
>>>> maxx <- rain_data_UTM at bbox[1,2]
>>>> miny <- rain_data_UTM at bbox[2,1]
>>>> maxy <- rain_data_UTM at bbox[2,2],
>>>> if I should limit myself to "rain_data_UTM" or write completely:
>>>> rain_data_UTM at bbox[,].
>>>>  By the way, this is the pointfile I reconstructed.
>>>> You can find it attached to the mail.
>>>>
>>>> Thanks in advance
>>>>
>>>> Best regards
>>>>
>>>>
>>>>
>>>> Bakary
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>
>>>
>>> --
>>> Ben Tupper
>>> Bigelow Laboratory for Ocean Science
>>> West Boothbay Harbor, Maine
>>> http://www.bigelow.org/
>>> https://eco.bigelow.org
>>>
>>>
>>
>> --
>>
>>
>>
>> Bakary
>>
>
>
> --
> Ben Tupper
> Bigelow Laboratory for Ocean Science
> West Boothbay Harbor, Maine
> http://www.bigelow.org/
> https://eco.bigelow.org
>
>

-- 



Bakary

	[[alternative HTML version deleted]]


From Roger@B|v@nd @end|ng |rom nhh@no  Thu Jan  9 20:20:10 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Thu, 9 Jan 2020 20:20:10 +0100
Subject: [R-sig-Geo] Help
In-Reply-To: <CALrbzg3L=v+h1mSmrJFZYfG3ixMAqR28FHGwJfisQr2+N-hXZQ@mail.gmail.com>
References: <CA+2FMU7qAjEgyPkF4FJZ1XqG_sFs5=5VfZugF0t3VSFFGdHOzg@mail.gmail.com>
 <CALrbzg2QJqn2YaGX0g8-X4GE2YfQgffEH9LUJVo6=N1oErmFzA@mail.gmail.com>
 <CA+2FMU5Sjh55m9S9iDd_MTcLbwFTGkAe1mgBp=0QGp7=J77VYg@mail.gmail.com>
 <CALrbzg3L=v+h1mSmrJFZYfG3ixMAqR28FHGwJfisQr2+N-hXZQ@mail.gmail.com>
Message-ID: <alpine.LFD.2.21.2001092013590.3482043@reclus.nhh.no>

On Thu, 9 Jan 2020, Ben Tupper wrote:

> Your assignments that look like...
>
> minx <-  rain_data_UTM at bbox[1,1]
>
> are not valid R statements - and that will cause an error.

I think that this might be the mail or some other system replacing 
commercial at by at. Better syntax might be:

minx <-  slot(rain_data_UTM, "bbox")[1,1]

if this was the real intention, as slot() is the preferred script-level S4 
slot accessor, although one finds lots of untidy examples using 
commercial at in blogs and elsewhere on the net. However, your version is 
obviously much easier to read:

> Instead,
> obtain a matrix of the bounding box using the bbox() function.  Then
> extract your coordinates from that. I think you want...
>
> bb <- bbox(rain_data_UTM)
> minx <- bb[1,1]
> maxx <- bb[1,2]
> miny <- bb[2,1]
> maxy <- bb[2,2]

And yes, this is very good advice!

Roger

>
> If you haven't seen this, https://www.rspatial.org/ , it is well worth your
> time.  There are a lot of other great resources about using spatial data in
> R.  Try searching the Rseek.org. Like this
> https://rseek.org/?q=spatial+tutorials  It is a gold mine.
>
>
> On Thu, Jan 9, 2020 at 1:42 PM Bakary Faty <bakaryfaty at gmail.com> wrote:
>
>> Thank you for appreciated reply,
>>
>> I explane you exactly what I want to do with this R code attached.
>> I want to adapt this code to my data to build an isohyet map.
>> But i have some difficulties to adapt it to my case.
>> I will be very happy when you will help my to adapt this R code (attached)
>> to my case.
>> You can find attached the you R code, my data file and my sahefile of
>> watershed.
>>
>> Best regards
>>
>>
>> Le jeu. 9 janv. 2020 ? 17:47, Ben Tupper <btupper at bigelow.org> a ?crit :
>>
>>> Welcome to r-sig-geo!
>>>
>>> I don't think that you haven't provided us enough information so that we
>>> can help.  On the other hand, does the example below using expand.grid help?
>>>
>>> minx <- 20
>>> maxx <- 25
>>> miny <- 31
>>> maxy <- 36
>>> pixel <- 1
>>> grd <- expand.grid(x = seq(minx, maxx, by=pixel), y = seq(miny, maxy,
>>> by=pixel))
>>>
>>> Ben
>>>
>>> On Thu, Jan 9, 2020 at 11:41 AM Bakary Faty <bakaryfaty at gmail.com> wrote:
>>>
>>>>
>>>> Dear,
>>>>
>>>> I'm writing to express my wish to join R-sig-geo list users.
>>>> I was doing a search on the net to know how to build an isohyet map and
>>>> I came across this R code.
>>>> However, I stumbled upon a problem from the line :
>>>> grd <- expand.grid(x=seq(minx, maxx, by=pixel), y=seq(miny, maxy,
>>>> by=pixel)),
>>>> I get the following error message:
>>>> default method not implemented for type 'S4'. I want to know how resolve
>>>> this error.
>>>>
>>>> Also, I would like to ask you only at the line level:
>>>> minx <- rain_data_UTM at bbox[1,1]
>>>> maxx <- rain_data_UTM at bbox[1,2]
>>>> miny <- rain_data_UTM at bbox[2,1]
>>>> maxy <- rain_data_UTM at bbox[2,2],
>>>> if I should limit myself to "rain_data_UTM" or write completely:
>>>> rain_data_UTM at bbox[,].
>>>>  By the way, this is the pointfile I reconstructed.
>>>> You can find it attached to the mail.
>>>>
>>>> Thanks in advance
>>>>
>>>> Best regards
>>>>
>>>>
>>>>
>>>> Bakary
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>
>>>
>>> --
>>> Ben Tupper
>>> Bigelow Laboratory for Ocean Science
>>> West Boothbay Harbor, Maine
>>> http://www.bigelow.org/
>>> https://eco.bigelow.org
>>>
>>>
>>
>> --
>>
>>
>>
>> Bakary
>>
>
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From t@v|b@r @end|ng |rom gm@||@com  Fri Jan 10 10:41:44 2020
From: t@v|b@r @end|ng |rom gm@||@com (Micha Silver)
Date: Fri, 10 Jan 2020 11:41:44 +0200
Subject: [R-sig-Geo] Help
In-Reply-To: <CA+2FMU7oCx5eQ2asYCeByWm_OOmM20ZQme21PjEBQQBYV8=zXw@mail.gmail.com>
References: <CA+2FMU7qAjEgyPkF4FJZ1XqG_sFs5=5VfZugF0t3VSFFGdHOzg@mail.gmail.com>
 <CALrbzg2QJqn2YaGX0g8-X4GE2YfQgffEH9LUJVo6=N1oErmFzA@mail.gmail.com>
 <CA+2FMU5Sjh55m9S9iDd_MTcLbwFTGkAe1mgBp=0QGp7=J77VYg@mail.gmail.com>
 <CA+2FMU7oCx5eQ2asYCeByWm_OOmM20ZQme21PjEBQQBYV8=zXw@mail.gmail.com>
Message-ID: <dce36243-94bd-290f-8b71-da4d02741df9@gmail.com>


On 09/01/2020 21:02, Bakary Faty wrote:
> Thank you for appreciated reply,
>
> I explane you exactly what I want to do with this R code attached.
> I want to adapt this code to my data to build an isohyet map.
> But i have some difficulties to adapt it to my case.
> I will be very happy when you will help my to adapt this R code (attached)
> to my case.
> You can find attached the you R code and my data file.
> Best regards
>


I made two small changes in your code, and it works fine:

 ?* First I used the suggestion (earlier in this thread) to create your
 ?? grid.
 ?* Then, you had an error in your call to autoKrige.
 ?* After getting that right, I created isohyetal lines with 
rasterToContour

Here's my version


library(automap)
library(raster)
library(rgdal)

## READ INPUT FILE
rain_data <- read.csv(file="DATAFILE_FOR_ISOHYET.csv")

point_coords <- rain_data[c("Lon","Lat")]
coordinates(rain_data) <- point_coords
p4str <- CRS("+init=epsg:4326")
proj4string(rain_data) <- p4str

## CONVERTION TO UTM
p4str_UTM <- CRS("+init=epsg:32633")
rain_data_UTM <- spTransform(rain_data, p4str_UTM)


bb <- bbox(rain_data_UTM)
minx <- bb[1,1]
maxx <- bb[1,2]
miny <- bb[2,1]
maxy <- bb[2,2]

## EACH PIXEL WILL BE 1000 METERS
pixel <- 1000
grd <- expand.grid(x=seq(minx, maxx, by=pixel), y=seq(miny, maxy, 
by=pixel))
coordinates(grd) <- ~x+y
gridded(grd) <- TRUE
proj4string(grd) <- p4str_UTM


## KRIGING, USING AUTOKRIGE WHICH CREATES A BEST GUESS VARIOGRAM
# OK_rain <- autoKrige(Rainfall_value ~ 1, rain_data_UTM, grd)
# There is no variable "Rainfall_value" in your data,
# It is called RAIN_DATA
OK_rain = autoKrige(formula = RAIN_DATA ~1,
 ??????????????????? input_data = rain_data_UTM,
 ??????????????????? new_data = grd)

## TRASFORM TO RASTER
rain_rast <- raster(OK_rain$krige_output)

summary(rain_rast)


# Minimumn is 540, max is 1735
# So create isohyetal lines about every 100 mm and plot

isohyets = rasterToContour(rain_rast, nlevels = 12)
plot(rain_rast)
lines(isohyets, add = TRUE)


> Le?jeu. 9 janv. 2020 ??18:41, Bakary Faty <bakaryfaty at gmail.com 
> <mailto:bakaryfaty at gmail.com>> a ?crit?:
>
>     Thank you for appreciated reply,
>
>     I explane you exactly what I want to do with this R code attached.
>     I want to adapt this code to my data to build an isohyet map.
>     But i have some difficulties to adapt it to my case.
>     I will be very happy when you will help my to adapt this R code
>     (attached)
>     to my case.
>     You can find attached the you R code, my data file and my sahefile
>     of watershed.
>
>     Best regards
>
>
>     Le?jeu. 9 janv. 2020 ??17:47, Ben Tupper <btupper at bigelow.org
>     <mailto:btupper at bigelow.org>> a ?crit?:
>
>         Welcome to r-sig-geo!
>
>         I don't think that you haven't provided us enough?information
>         so that we can help.? On the other hand, does the example
>         below using expand.grid help?
>
>         minx <- 20
>         maxx <- 25
>         miny <- 31
>         maxy <- 36
>         pixel <- 1
>         grd <- expand.grid(x = seq(minx, maxx, by=pixel), y =
>         seq(miny, maxy, by=pixel))
>
>         Ben
>
>         On Thu, Jan 9, 2020 at 11:41 AM Bakary Faty
>         <bakaryfaty at gmail.com <mailto:bakaryfaty at gmail.com>> wrote:
>
>
>             Dear,
>
>             I'm writing to express my wish to join R-sig-geo list users.
>             I was doing a search on the net to know how to build an
>             isohyet map and I came across this R code.
>             However, I stumbled upon a problem from the line :
>             grd <- expand.grid(x=seq(minx, maxx, by=pixel),
>             y=seq(miny, maxy, by=pixel)),
>             I get the following error message:
>             default method not implemented for type 'S4'. I want to
>             know how resolve this error.
>
>             Also, I would like to ask you only at the line level:
>             minx <- rain_data_UTM at bbox[1,1]
>             maxx <- rain_data_UTM at bbox[1,2]
>             miny <- rain_data_UTM at bbox[2,1]
>             maxy <- rain_data_UTM at bbox[2,2],
>             if I should limit myself to "rain_data_UTM" or write
>             completely:
>             rain_data_UTM at bbox[,].
>             ?By the way, this is the pointfile I reconstructed.
>             You can find it attached to the mail.
>
>             Thanks in advance
>
>             Best regards
>
>
>
>             Bakary
>             _______________________________________________
>             R-sig-Geo mailing list
>             R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>             https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>
>         -- 
>         Ben Tupper
>         Bigelow Laboratory for Ocean Science
>         West Boothbay Harbor, Maine
>         http://www.bigelow.org/
>         https://eco.bigelow.org
>
>
>
>     -- 
>
>
>
>     Bakary
>
>
>
> -- 
>
>
>
> Bakary
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Micha Silver
Ben Gurion Univ.
Sde Boker, Remote Sensing Lab
cell: +972-523-665918
https://orcid.org/0000-0002-1128-1325


From b@k@ry|@ty @end|ng |rom gm@||@com  Fri Jan 10 10:49:27 2020
From: b@k@ry|@ty @end|ng |rom gm@||@com (Bakary Faty)
Date: Fri, 10 Jan 2020 09:49:27 +0000
Subject: [R-sig-Geo] Help
In-Reply-To: <dce36243-94bd-290f-8b71-da4d02741df9@gmail.com>
References: <CA+2FMU7qAjEgyPkF4FJZ1XqG_sFs5=5VfZugF0t3VSFFGdHOzg@mail.gmail.com>
 <CALrbzg2QJqn2YaGX0g8-X4GE2YfQgffEH9LUJVo6=N1oErmFzA@mail.gmail.com>
 <CA+2FMU5Sjh55m9S9iDd_MTcLbwFTGkAe1mgBp=0QGp7=J77VYg@mail.gmail.com>
 <CA+2FMU7oCx5eQ2asYCeByWm_OOmM20ZQme21PjEBQQBYV8=zXw@mail.gmail.com>
 <dce36243-94bd-290f-8b71-da4d02741df9@gmail.com>
Message-ID: <CA+2FMU4VK7uhEB4bZyyoFAOyydgk0D32JmOuh278S2ViVO_Cgg@mail.gmail.com>

Thank you very much for help,
The code works fine but when I add the shapefile of my watershed
I can not plot it.

Le ven. 10 janv. 2020 ? 09:41, Micha Silver <tsvibar at gmail.com> a ?crit :

>
> On 09/01/2020 21:02, Bakary Faty wrote:
> > Thank you for appreciated reply,
> >
> > I explane you exactly what I want to do with this R code attached.
> > I want to adapt this code to my data to build an isohyet map.
> > But i have some difficulties to adapt it to my case.
> > I will be very happy when you will help my to adapt this R code
> (attached)
> > to my case.
> > You can find attached the you R code and my data file.
> > Best regards
> >
>
>
> I made two small changes in your code, and it works fine:
>
>   * First I used the suggestion (earlier in this thread) to create your
>     grid.
>   * Then, you had an error in your call to autoKrige.
>   * After getting that right, I created isohyetal lines with
> rasterToContour
>
> Here's my version
>
>
> library(automap)
> library(raster)
> library(rgdal)
>
> ## READ INPUT FILE
> rain_data <- read.csv(file="DATAFILE_FOR_ISOHYET.csv")
>
> point_coords <- rain_data[c("Lon","Lat")]
> coordinates(rain_data) <- point_coords
> p4str <- CRS("+init=epsg:4326")
> proj4string(rain_data) <- p4str
>
> ## CONVERTION TO UTM
> p4str_UTM <- CRS("+init=epsg:32633")
> rain_data_UTM <- spTransform(rain_data, p4str_UTM)
>
>
> bb <- bbox(rain_data_UTM)
> minx <- bb[1,1]
> maxx <- bb[1,2]
> miny <- bb[2,1]
> maxy <- bb[2,2]
>
> ## EACH PIXEL WILL BE 1000 METERS
> pixel <- 1000
> grd <- expand.grid(x=seq(minx, maxx, by=pixel), y=seq(miny, maxy,
> by=pixel))
> coordinates(grd) <- ~x+y
> gridded(grd) <- TRUE
> proj4string(grd) <- p4str_UTM
>
>
> ## KRIGING, USING AUTOKRIGE WHICH CREATES A BEST GUESS VARIOGRAM
> # OK_rain <- autoKrige(Rainfall_value ~ 1, rain_data_UTM, grd)
> # There is no variable "Rainfall_value" in your data,
> # It is called RAIN_DATA
> OK_rain = autoKrige(formula = RAIN_DATA ~1,
>                      input_data = rain_data_UTM,
>                      new_data = grd)
>
> ## TRASFORM TO RASTER
> rain_rast <- raster(OK_rain$krige_output)
>
> summary(rain_rast)
>
>
> # Minimumn is 540, max is 1735
> # So create isohyetal lines about every 100 mm and plot
>
> isohyets = rasterToContour(rain_rast, nlevels = 12)
> plot(rain_rast)
> lines(isohyets, add = TRUE)
>
>
> > Le jeu. 9 janv. 2020 ? 18:41, Bakary Faty <bakaryfaty at gmail.com
> > <mailto:bakaryfaty at gmail.com>> a ?crit :
> >
> >     Thank you for appreciated reply,
> >
> >     I explane you exactly what I want to do with this R code attached.
> >     I want to adapt this code to my data to build an isohyet map.
> >     But i have some difficulties to adapt it to my case.
> >     I will be very happy when you will help my to adapt this R code
> >     (attached)
> >     to my case.
> >     You can find attached the you R code, my data file and my sahefile
> >     of watershed.
> >
> >     Best regards
> >
> >
> >     Le jeu. 9 janv. 2020 ? 17:47, Ben Tupper <btupper at bigelow.org
> >     <mailto:btupper at bigelow.org>> a ?crit :
> >
> >         Welcome to r-sig-geo!
> >
> >         I don't think that you haven't provided us enough information
> >         so that we can help.  On the other hand, does the example
> >         below using expand.grid help?
> >
> >         minx <- 20
> >         maxx <- 25
> >         miny <- 31
> >         maxy <- 36
> >         pixel <- 1
> >         grd <- expand.grid(x = seq(minx, maxx, by=pixel), y =
> >         seq(miny, maxy, by=pixel))
> >
> >         Ben
> >
> >         On Thu, Jan 9, 2020 at 11:41 AM Bakary Faty
> >         <bakaryfaty at gmail.com <mailto:bakaryfaty at gmail.com>> wrote:
> >
> >
> >             Dear,
> >
> >             I'm writing to express my wish to join R-sig-geo list users.
> >             I was doing a search on the net to know how to build an
> >             isohyet map and I came across this R code.
> >             However, I stumbled upon a problem from the line :
> >             grd <- expand.grid(x=seq(minx, maxx, by=pixel),
> >             y=seq(miny, maxy, by=pixel)),
> >             I get the following error message:
> >             default method not implemented for type 'S4'. I want to
> >             know how resolve this error.
> >
> >             Also, I would like to ask you only at the line level:
> >             minx <- rain_data_UTM at bbox[1,1]
> >             maxx <- rain_data_UTM at bbox[1,2]
> >             miny <- rain_data_UTM at bbox[2,1]
> >             maxy <- rain_data_UTM at bbox[2,2],
> >             if I should limit myself to "rain_data_UTM" or write
> >             completely:
> >             rain_data_UTM at bbox[,].
> >              By the way, this is the pointfile I reconstructed.
> >             You can find it attached to the mail.
> >
> >             Thanks in advance
> >
> >             Best regards
> >
> >
> >
> >             Bakary
> >             _______________________________________________
> >             R-sig-Geo mailing list
> >             R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
> >             https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> >
> >
> >         --
> >         Ben Tupper
> >         Bigelow Laboratory for Ocean Science
> >         West Boothbay Harbor, Maine
> >         http://www.bigelow.org/
> >         https://eco.bigelow.org
> >
> >
> >
> >     --
> >
> >
> >
> >     Bakary
> >
> >
> >
> > --
> >
> >
> >
> > Bakary
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> --
> Micha Silver
> Ben Gurion Univ.
> Sde Boker, Remote Sensing Lab
> cell: +972-523-665918
> https://orcid.org/0000-0002-1128-1325
>
>

-- 



Bakary

	[[alternative HTML version deleted]]


From er|nm@hodge@@ @end|ng |rom gm@||@com  Sun Jan 12 02:39:21 2020
From: er|nm@hodge@@ @end|ng |rom gm@||@com (Erin Hodgess)
Date: Sat, 11 Jan 2020 18:39:21 -0700
Subject: [R-sig-Geo] setting spatial units to miles in variogramST
Message-ID: <CACxE24keuz64GjuGWnicd-D964UCEut2tX2=n2QD_BFrsD87xw@mail.gmail.com>

Hello!

In the variogramST function, I set "tunits=mins".  Is there a way to change
from km to miles, please?

Thanks,
Erin


Erin Hodgess, PhD
mailto: erinm.hodgess at gmail.com

	[[alternative HTML version deleted]]


From t@v|b@r @end|ng |rom gm@||@com  Mon Jan 13 08:24:46 2020
From: t@v|b@r @end|ng |rom gm@||@com (Micha Silver)
Date: Mon, 13 Jan 2020 09:24:46 +0200
Subject: [R-sig-Geo] Help
In-Reply-To: <CA+2FMU7dDNPjdjYo-3o=OtTnXYHEe4fns+rXHRyVE=CDvsv2WQ@mail.gmail.com>
References: <CA+2FMU7qAjEgyPkF4FJZ1XqG_sFs5=5VfZugF0t3VSFFGdHOzg@mail.gmail.com>
 <CALrbzg2QJqn2YaGX0g8-X4GE2YfQgffEH9LUJVo6=N1oErmFzA@mail.gmail.com>
 <CA+2FMU5Sjh55m9S9iDd_MTcLbwFTGkAe1mgBp=0QGp7=J77VYg@mail.gmail.com>
 <CA+2FMU7oCx5eQ2asYCeByWm_OOmM20ZQme21PjEBQQBYV8=zXw@mail.gmail.com>
 <dce36243-94bd-290f-8b71-da4d02741df9@gmail.com>
 <CA+2FMU7dDNPjdjYo-3o=OtTnXYHEe4fns+rXHRyVE=CDvsv2WQ@mail.gmail.com>
Message-ID: <19430527-3cd7-bca4-4c79-7d06da172aa2@gmail.com>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20200113/520eab44/attachment.html>

-------------- next part --------------
A non-text attachment was scrubbed...
Name: do_R_code_for_isohyet_map[R-sig-Geo].R
Type: text/x-r-source
Size: 1381 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20200113/520eab44/attachment.bin>

From b@k@ry|@ty @end|ng |rom gm@||@com  Mon Jan 13 10:39:07 2020
From: b@k@ry|@ty @end|ng |rom gm@||@com (Bakary Faty)
Date: Mon, 13 Jan 2020 09:39:07 +0000
Subject: [R-sig-Geo] Help
In-Reply-To: <19430527-3cd7-bca4-4c79-7d06da172aa2@gmail.com>
References: <CA+2FMU7qAjEgyPkF4FJZ1XqG_sFs5=5VfZugF0t3VSFFGdHOzg@mail.gmail.com>
 <CALrbzg2QJqn2YaGX0g8-X4GE2YfQgffEH9LUJVo6=N1oErmFzA@mail.gmail.com>
 <CA+2FMU5Sjh55m9S9iDd_MTcLbwFTGkAe1mgBp=0QGp7=J77VYg@mail.gmail.com>
 <CA+2FMU7oCx5eQ2asYCeByWm_OOmM20ZQme21PjEBQQBYV8=zXw@mail.gmail.com>
 <dce36243-94bd-290f-8b71-da4d02741df9@gmail.com>
 <CA+2FMU7dDNPjdjYo-3o=OtTnXYHEe4fns+rXHRyVE=CDvsv2WQ@mail.gmail.com>
 <19430527-3cd7-bca4-4c79-7d06da172aa2@gmail.com>
Message-ID: <CA+2FMU7q8ZyaHsEiMe8_a9s97g1v5VXVUi4SdaiUw1heFAHGKA@mail.gmail.com>

Dear Silver,

Thank for your help.

I think there had been a mix-up in the Coordinate Rference System. When I
plot this shapefile I get
it in the UTM Coordinate.
Le Senegal is in Zone 28 North. The watershed on what I work is shared by
trois Countries (Senegal, Gambie and Guinea).
But in the choose of UTM 33 in my script is an error.
Thank very much.

Best regards


Le lun. 13 janv. 2020 ? 07:22, Micha Silver <tsvibar at gmail.com> a ?crit :

> Hello Bakary:
>
> Please keep questions on the list, so that others can benefit from the
> conversation.
>
>
> I see that the Basins shapefile you sent is declared to be in Long/Lat
> WGS84 Coordinate Reference System, however the coordinates (the X-Y
> locations) look like it is already projected to UTM 33. Is it possible
> there is some mixup in the Coordinate Reference System of the Basins
> shapefile?
>
> (That would explain why the basins layer does not appear on your plot)
>
>
> Furthermore, I think that you are working in Senegal/Gambia (from the
> coordinates in the DATAFILE). If so, why did you choose to project to UTM
> 33 in your script? Isn't Senegal in UTM zone 28?
>
>
> Attached is the corrected script (changed to UTM28). The corrected basin
> shapefile is sent privately. (too big for the list)
>
>
> Regards, Micha
>
>
>
>
> On 12/01/2020 21:29, Bakary Faty wrote:
>
> Dear Micha Silver
>
> I'm writing you this email following your contribution on my isohyet map
> code, in 'r-sig-geo'.
>
> I really appreciated your help which helped me a lot. I can draw the
> isohyets but I can't draw the contour of my study basin.
>
> You can see where the problem is in the code to make a change again?
>
> You will find the files of the watershed and my code R attached.
>
> Thank you very much by advance
>
>
> Best regards
>
> Le ven. 10 janv. 2020 ? 09:41, Micha Silver <tsvibar at gmail.com> a ?crit :
>
>>
>> On 09/01/2020 21:02, Bakary Faty wrote:
>> > Thank you for appreciated reply,
>> >
>> > I explane you exactly what I want to do with this R code attached.
>> > I want to adapt this code to my data to build an isohyet map.
>> > But i have some difficulties to adapt it to my case.
>> > I will be very happy when you will help my to adapt this R code
>> (attached)
>> > to my case.
>> > You can find attached the you R code and my data file.
>> > Best regards
>> >
>>
>>
>> I made two small changes in your code, and it works fine:
>>
>>   * First I used the suggestion (earlier in this thread) to create your
>>     grid.
>>   * Then, you had an error in your call to autoKrige.
>>   * After getting that right, I created isohyetal lines with
>> rasterToContour
>>
>> Here's my version
>>
>>
>> library(automap)
>> library(raster)
>> library(rgdal)
>>
>> ## READ INPUT FILE
>> rain_data <- read.csv(file="DATAFILE_FOR_ISOHYET.csv")
>>
>> point_coords <- rain_data[c("Lon","Lat")]
>> coordinates(rain_data) <- point_coords
>> p4str <- CRS("+init=epsg:4326")
>> proj4string(rain_data) <- p4str
>>
>> ## CONVERTION TO UTM
>> p4str_UTM <- CRS("+init=epsg:32633")
>> rain_data_UTM <- spTransform(rain_data, p4str_UTM)
>>
>>
>> bb <- bbox(rain_data_UTM)
>> minx <- bb[1,1]
>> maxx <- bb[1,2]
>> miny <- bb[2,1]
>> maxy <- bb[2,2]
>>
>> ## EACH PIXEL WILL BE 1000 METERS
>> pixel <- 1000
>> grd <- expand.grid(x=seq(minx, maxx, by=pixel), y=seq(miny, maxy,
>> by=pixel))
>> coordinates(grd) <- ~x+y
>> gridded(grd) <- TRUE
>> proj4string(grd) <- p4str_UTM
>>
>>
>> ## KRIGING, USING AUTOKRIGE WHICH CREATES A BEST GUESS VARIOGRAM
>> # OK_rain <- autoKrige(Rainfall_value ~ 1, rain_data_UTM, grd)
>> # There is no variable "Rainfall_value" in your data,
>> # It is called RAIN_DATA
>> OK_rain = autoKrige(formula = RAIN_DATA ~1,
>>                      input_data = rain_data_UTM,
>>                      new_data = grd)
>>
>> ## TRASFORM TO RASTER
>> rain_rast <- raster(OK_rain$krige_output)
>>
>> summary(rain_rast)
>>
>>
>> # Minimumn is 540, max is 1735
>> # So create isohyetal lines about every 100 mm and plot
>>
>> isohyets = rasterToContour(rain_rast, nlevels = 12)
>> plot(rain_rast)
>> lines(isohyets, add = TRUE)
>>
>>
>> > Le jeu. 9 janv. 2020 ? 18:41, Bakary Faty <bakaryfaty at gmail.com
>> > <mailto:bakaryfaty at gmail.com>> a ?crit :
>> >
>> >     Thank you for appreciated reply,
>> >
>> >     I explane you exactly what I want to do with this R code attached.
>> >     I want to adapt this code to my data to build an isohyet map.
>> >     But i have some difficulties to adapt it to my case.
>> >     I will be very happy when you will help my to adapt this R code
>> >     (attached)
>> >     to my case.
>> >     You can find attached the you R code, my data file and my sahefile
>> >     of watershed.
>> >
>> >     Best regards
>> >
>> >
>> >     Le jeu. 9 janv. 2020 ? 17:47, Ben Tupper <btupper at bigelow.org
>> >     <mailto:btupper at bigelow.org>> a ?crit :
>> >
>> >         Welcome to r-sig-geo!
>> >
>> >         I don't think that you haven't provided us enough information
>> >         so that we can help.  On the other hand, does the example
>> >         below using expand.grid help?
>> >
>> >         minx <- 20
>> >         maxx <- 25
>> >         miny <- 31
>> >         maxy <- 36
>> >         pixel <- 1
>> >         grd <- expand.grid(x = seq(minx, maxx, by=pixel), y =
>> >         seq(miny, maxy, by=pixel))
>> >
>> >         Ben
>> >
>> >         On Thu, Jan 9, 2020 at 11:41 AM Bakary Faty
>> >         <bakaryfaty at gmail.com <mailto:bakaryfaty at gmail.com>> wrote:
>> >
>> >
>> >             Dear,
>> >
>> >             I'm writing to express my wish to join R-sig-geo list users.
>> >             I was doing a search on the net to know how to build an
>> >             isohyet map and I came across this R code.
>> >             However, I stumbled upon a problem from the line :
>> >             grd <- expand.grid(x=seq(minx, maxx, by=pixel),
>> >             y=seq(miny, maxy, by=pixel)),
>> >             I get the following error message:
>> >             default method not implemented for type 'S4'. I want to
>> >             know how resolve this error.
>> >
>> >             Also, I would like to ask you only at the line level:
>> >             minx <- rain_data_UTM at bbox[1,1]
>> >             maxx <- rain_data_UTM at bbox[1,2]
>> >             miny <- rain_data_UTM at bbox[2,1]
>> >             maxy <- rain_data_UTM at bbox[2,2],
>> >             if I should limit myself to "rain_data_UTM" or write
>> >             completely:
>> >             rain_data_UTM at bbox[,].
>> >              By the way, this is the pointfile I reconstructed.
>> >             You can find it attached to the mail.
>> >
>> >             Thanks in advance
>> >
>> >             Best regards
>> >
>> >
>> >
>> >             Bakary
>> >             _______________________________________________
>> >             R-sig-Geo mailing list
>> >             R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>> >             https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >
>> >
>> >
>> >         --
>> >         Ben Tupper
>> >         Bigelow Laboratory for Ocean Science
>> >         West Boothbay Harbor, Maine
>> >         http://www.bigelow.org/
>> >         https://eco.bigelow.org
>> >
>> >
>> >
>> >     --
>> >
>> >
>> >
>> >     Bakary
>> >
>> >
>> >
>> > --
>> >
>> >
>> >
>> > Bakary
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at r-project.org
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> --
>> Micha Silver
>> Ben Gurion Univ.
>> Sde Boker, Remote Sensing Lab
>> cell: +972-523-665918
>> https://orcid.org/0000-0002-1128-1325
>>
>>
>
> --
>
>
>
> Bakary
>
> --
> Micha Silver
> Ben Gurion Univ
> Sde Boker, Remote Sensing Lab
> +972-523-665918
>
>

-- 



Bakary

	[[alternative HTML version deleted]]


From b@gr@e|er @end|ng |rom 52north@org  Mon Jan 13 11:14:02 2020
From: b@gr@e|er @end|ng |rom 52north@org (=?UTF-8?Q?Dr=2e_Benedikt_Gr=c3=a4ler?=)
Date: Mon, 13 Jan 2020 11:14:02 +0100
Subject: [R-sig-Geo] setting spatial units to miles in variogramST
In-Reply-To: <CACxE24keuz64GjuGWnicd-D964UCEut2tX2=n2QD_BFrsD87xw@mail.gmail.com>
References: <CACxE24keuz64GjuGWnicd-D964UCEut2tX2=n2QD_BFrsD87xw@mail.gmail.com>
Message-ID: <a05ca47a-1d03-2702-eeb1-8768f0f1550f@52north.org>

Dear Erin,

the spatial unit is determined by the CRS of the sp slot of the STIDF 
object that you provide to variogramST; details are e.g. in ?spDists.

HTH,

  Ben


On 12.01.20 02:39, Erin Hodgess wrote:
> Hello!
> 
> In the variogramST function, I set "tunits=mins".  Is there a way to change
> from km to miles, please?
> 
> Thanks,
> Erin
> 
> 
> Erin Hodgess, PhD
> mailto: erinm.hodgess at gmail.com
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Dr. Benedikt Gr?ler
52?North Initiative for Geospatial Open Source Software GmbH
Martin-Luther-King-Weg 24
48155 Muenster, Germany

E-Mail: b.graeler at 52north.org
Fon: +49-(0)-251/396371-39
Fax: +49-(0)-251/396371-11

http://52north.org/
Twitter: @FiveTwoN

General Managers:
Prof. Dr. Albert Remke, Prof. Dr. Andreas Wytzisk-Arens
Local Court Muenster HRB 10849


From er|nm@hodge@@ @end|ng |rom gm@||@com  Mon Jan 13 16:33:36 2020
From: er|nm@hodge@@ @end|ng |rom gm@||@com (Erin Hodgess)
Date: Mon, 13 Jan 2020 08:33:36 -0700
Subject: [R-sig-Geo] setting spatial units to miles in variogramST
In-Reply-To: <a05ca47a-1d03-2702-eeb1-8768f0f1550f@52north.org>
References: <CACxE24keuz64GjuGWnicd-D964UCEut2tX2=n2QD_BFrsD87xw@mail.gmail.com>
 <a05ca47a-1d03-2702-eeb1-8768f0f1550f@52north.org>
Message-ID: <CACxE24=rFPHEVFGUZGchErM-ft4HAFnMsV5VuyE8-tNAB13Fhg@mail.gmail.com>

That?s perfect.

Thanks,
Erin


On Mon, Jan 13, 2020 at 3:14 AM Dr. Benedikt Gr?ler <b.graeler at 52north.org>
wrote:

> Dear Erin,
>
> the spatial unit is determined by the CRS of the sp slot of the STIDF
> object that you provide to variogramST; details are e.g. in ?spDists.
>
> HTH,
>
>   Ben
>
>
> On 12.01.20 02:39, Erin Hodgess wrote:
> > Hello!
> >
> > In the variogramST function, I set "tunits=mins".  Is there a way to
> change
> > from km to miles, please?
> >
> > Thanks,
> > Erin
> >
> >
> > Erin Hodgess, PhD
> > mailto: erinm.hodgess at gmail.com
> >
> >       [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
> --
> Dr. Benedikt Gr?ler
> 52?North Initiative for Geospatial Open Source Software GmbH
> Martin-Luther-King-Weg 24
> 48155 Muenster, Germany
>
> E-Mail: b.graeler at 52north.org
> Fon: +49-(0)-251/396371-39
> Fax: +49-(0)-251/396371-11
>
> http://52north.org/
> Twitter: @FiveTwoN
>
> General Managers:
> Prof. Dr. Albert Remke, Prof. Dr. Andreas Wytzisk-Arens
> Local Court Muenster HRB 10849
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
-- 
Erin Hodgess, PhD
mailto: erinm.hodgess at gmail.com

	[[alternative HTML version deleted]]


From @bdou|@ye@@r @end|ng |rom gm@||@com  Tue Jan 14 15:24:04 2020
From: @bdou|@ye@@r @end|ng |rom gm@||@com (Abdoulaye Sarr)
Date: Tue, 14 Jan 2020 14:24:04 +0000
Subject: [R-sig-Geo] write to netcdf
Message-ID: <CAN=6O0KJ-v45reRGSpRL=kTmDKeezPKON-YzA8S4nUR7yrU=Mg@mail.gmail.com>

I have a datasets with below profile I want to write/export to netcdf :

.@ dates      : Date[1:2], format: "2019-03-15" "2019-07-30"
  ..@ data       :List of 2
  .. ..$ 2019-03-15:'data.frame': 47005 obs. of  11 variables:
  .. .. ..$ MeanTemperature     : num [1:47005] NA NA NA NA NA NA NA NA NA
NA ...
  .. .. ..$ MinTemperature      : num [1:47005] NA NA NA NA NA NA NA NA NA
NA ...
  .. .. ..$ MaxTemperature      : num [1:47005] NA NA NA NA NA NA NA NA NA
NA ...
  .. .. ..$ Precipitation       : num [1:47005] 0 0 0 0 0 0 0 0 0 0 ...

  .. ..$ 2019-07-30:'data.frame': 47005 obs. of  11 variables:
  .. .. ..$ MeanTemperature     : num [1:47005] NA NA NA NA NA NA NA NA NA
NA ...
  .. .. ..$ MinTemperature      : num [1:47005] NA NA NA NA NA NA NA NA NA
NA ...
  .. .. ..$ MaxTemperature      : num [1:47005] NA NA NA NA NA NA NA NA NA
NA ...
  .. .. ..$ Precipitation       : num [1:47005] NA NA NA NA NA NA NA NA NA
NA ...

  ..@ grid       :Formal class 'GridTopology' [package "sp"] with 3 slots
  .. .. ..@ cellcentre.offset: Named num [1:2] 289868 1432838
  .. .. .. ..- attr(*, "names")= chr [1:2] "s1" "s2"
  .. .. ..@ cellsize         : num [1:2] 902 922
  .. .. ..@ cells.dim        : int [1:2] 395 119
  ..@ bbox       : num [1:2, 1:2] 289417 1432377 645707 1542095
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : chr [1:2] "s1" "s2"
  .. .. ..$ : chr [1:2] "min" "max"
  ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slot
  .. .. ..@ projargs: chr "+init=epsg:32628 +proj=utm +zone=28 +datum=WGS84
+units=m +no_defs +ellps=WGS84 +towgs84=0,0,0"

Any hint on this much appreciated.

AS

	[[alternative HTML version deleted]]


From btupper @end|ng |rom b|ge|ow@org  Thu Jan 16 17:50:24 2020
From: btupper @end|ng |rom b|ge|ow@org (Ben Tupper)
Date: Thu, 16 Jan 2020 11:50:24 -0500
Subject: [R-sig-Geo] indexing multi-layer rasters
Message-ID: <CALrbzg2p_6ts7ZHWbQb=Mja7DQGB=qFdGkLM3iFZsC7kw27Tqw@mail.gmail.com>

Hi,

I usually avoid using logical indexes with multilayer rasters (stacks
and bricks), but I have never understood why indexing ala `[[` with
logicals isn't supported.  Below is an example that shows how it
doesn't work like the typical indexing with logicals.  I'm not asking
to have logical indices considered (although it would be handy), but
instead I really just want to understand why it is the way it is.  I
scanned over the introductory vignette (https://rspatial.org/raster)
and issues (https://github.com/rspatial/raster/issues) but found
nothing there.

Thanks and cheers,
Ben

### START
library(raster)

logo <- raster::brick(system.file("external/rlogo.grd", package="raster"))

# red-red-red
logo[[c(TRUE, TRUE, TRUE)]]
# class      : RasterStack
# dimensions : 77, 101, 7777, 3  (nrow, ncol, ncell, nlayers)
# resolution : 1, 1  (x, y)
# extent     : 0, 101, 0, 77  (xmin, xmax, ymin, ymax)
# crs        : +proj=merc +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0
# names      : red.1, red.2, red.3
# min values :     0,     0,     0
# max values :   255,   255,   255

# red-red
logo[[c(TRUE, TRUE)]]
# class      : RasterStack
# dimensions : 77, 101, 7777, 2  (nrow, ncol, ncell, nlayers)
# resolution : 1, 1  (x, y)
# extent     : 0, 101, 0, 77  (xmin, xmax, ymin, ymax)
# crs        : +proj=merc +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0
# names      : red.1, red.2
# min values :     0,     0
# max values :   255,   255

# red
logo[[c(TRUE)]]
# class      : RasterLayer
# band       : 1  (of  3  bands)
# dimensions : 77, 101, 7777  (nrow, ncol, ncell)
# resolution : 1, 1  (x, y)
# extent     : 0, 101, 0, 77  (xmin, xmax, ymin, ymax)
# crs        : +proj=merc +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0
# source     : /usr/lib64/R/library/raster/external/rlogo.grd
# names      : red
# values     : 0, 255  (min, max)

logo[[c(TRUE, FALSE, TRUE)]]
#Error in .local(x, ...) : not a valid subset


#sessionInfo()
# R version 3.5.1 (2018-07-02)
# Platform: x86_64-redhat-linux-gnu (64-bit)
# Running under: CentOS Linux 7 (Core)
#
# Matrix products: default
# BLAS/LAPACK: /usr/lib64/R/lib/libRblas.so
#
# locale:
#   [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
# [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
LC_PAPER=en_US.UTF-8       LC_NAME=C
# [9] LC_ADDRESS=C               LC_TELEPHONE=C
LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
#
# attached base packages:
#   [1] stats     graphics  grDevices utils     datasets  methods   base
#
# other attached packages:
#   [1] raster_3.0-7 sp_1.3-2
#
# loaded via a namespace (and not attached):
#   [1] compiler_3.5.1   rgdal_1.4-8      tools_3.5.1      yaml_2.2.0
     Rcpp_1.0.3       codetools_0.2-15
# [7] grid_3.5.1       lattice_0.20-35

### END




-- 
Ben Tupper
Bigelow Laboratory for Ocean Science
West Boothbay Harbor, Maine
http://www.bigelow.org/
https://eco.bigelow.org


From b|@|ev||@t @end|ng |rom gm@||@com  Thu Jan 16 18:53:32 2020
From: b|@|ev||@t @end|ng |rom gm@||@com (=?UTF-8?Q?Bede-Fazekas_=c3=81kos?=)
Date: Thu, 16 Jan 2020 18:53:32 +0100
Subject: [R-sig-Geo] indexing multi-layer rasters
In-Reply-To: <CALrbzg2p_6ts7ZHWbQb=Mja7DQGB=qFdGkLM3iFZsC7kw27Tqw@mail.gmail.com>
References: <CALrbzg2p_6ts7ZHWbQb=Mja7DQGB=qFdGkLM3iFZsC7kw27Tqw@mail.gmail.com>
Message-ID: <f464470f-5fdf-bba6-22a8-e34bf5442ee2-5677@gmail.com>


Dear Ben,
Although I cannot answer your question on why logical subsetting was not 
implemented in package raster, there is a very easy workaround:
logo[[(1:nlayers(logo))[c(TRUE, TRUE, TRUE)]]]
logo[[(1:nlayers(logo))[c(TRUE, FALSE, TRUE)]]]

Also note that in case of lists '[[' does recursive indexing, and this 
type of logical indexing you are asking about works only with '['.
HTH,
?kos Bede-Fazekas
Hungarian Academy of Sciences

2020.01.16. 17:50 keltez?ssel, Ben Tupper ?rta:
> Hi,
>
> I usually avoid using logical indexes with multilayer rasters (stacks
> and bricks), but I have never understood why indexing ala `[[` with
> logicals isn't supported.  Below is an example that shows how it
> doesn't work like the typical indexing with logicals.  I'm not asking
> to have logical indices considered (although it would be handy), but
> instead I really just want to understand why it is the way it is.  I
> scanned over the introductory vignette (https://rspatial.org/raster)
> and issues (https://github.com/rspatial/raster/issues) but found
> nothing there.
>
> Thanks and cheers,
> Ben
>
> ### START
> library(raster)
>
> logo <- raster::brick(system.file("external/rlogo.grd", package="raster"))
>
> # red-red-red
> logo[[c(TRUE, TRUE, TRUE)]]
> # class      : RasterStack
> # dimensions : 77, 101, 7777, 3  (nrow, ncol, ncell, nlayers)
> # resolution : 1, 1  (x, y)
> # extent     : 0, 101, 0, 77  (xmin, xmax, ymin, ymax)
> # crs        : +proj=merc +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0
> # names      : red.1, red.2, red.3
> # min values :     0,     0,     0
> # max values :   255,   255,   255
>
> # red-red
> logo[[c(TRUE, TRUE)]]
> # class      : RasterStack
> # dimensions : 77, 101, 7777, 2  (nrow, ncol, ncell, nlayers)
> # resolution : 1, 1  (x, y)
> # extent     : 0, 101, 0, 77  (xmin, xmax, ymin, ymax)
> # crs        : +proj=merc +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0
> # names      : red.1, red.2
> # min values :     0,     0
> # max values :   255,   255
>
> # red
> logo[[c(TRUE)]]
> # class      : RasterLayer
> # band       : 1  (of  3  bands)
> # dimensions : 77, 101, 7777  (nrow, ncol, ncell)
> # resolution : 1, 1  (x, y)
> # extent     : 0, 101, 0, 77  (xmin, xmax, ymin, ymax)
> # crs        : +proj=merc +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0
> # source     : /usr/lib64/R/library/raster/external/rlogo.grd
> # names      : red
> # values     : 0, 255  (min, max)
>
> logo[[c(TRUE, FALSE, TRUE)]]
> #Error in .local(x, ...) : not a valid subset
>
>
> #sessionInfo()
> # R version 3.5.1 (2018-07-02)
> # Platform: x86_64-redhat-linux-gnu (64-bit)
> # Running under: CentOS Linux 7 (Core)
> #
> # Matrix products: default
> # BLAS/LAPACK: /usr/lib64/R/lib/libRblas.so
> #
> # locale:
> #   [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
> LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
> # [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
> LC_PAPER=en_US.UTF-8       LC_NAME=C
> # [9] LC_ADDRESS=C               LC_TELEPHONE=C
> LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
> #
> # attached base packages:
> #   [1] stats     graphics  grDevices utils     datasets  methods   base
> #
> # other attached packages:
> #   [1] raster_3.0-7 sp_1.3-2
> #
> # loaded via a namespace (and not attached):
> #   [1] compiler_3.5.1   rgdal_1.4-8      tools_3.5.1      yaml_2.2.0
>       Rcpp_1.0.3       codetools_0.2-15
> # [7] grid_3.5.1       lattice_0.20-35
>
> ### END
>
>
>
>


From v|j@y|u||@ @end|ng |rom gm@||@com  Fri Jan 17 16:12:50 2020
From: v|j@y|u||@ @end|ng |rom gm@||@com (Vijay Lulla)
Date: Fri, 17 Jan 2020 10:12:50 -0500
Subject: [R-sig-Geo] indexing multi-layer rasters
In-Reply-To: <f464470f-5fdf-bba6-22a8-e34bf5442ee2-5677@gmail.com>
References: <CALrbzg2p_6ts7ZHWbQb=Mja7DQGB=qFdGkLM3iFZsC7kw27Tqw@mail.gmail.com>
 <f464470f-5fdf-bba6-22a8-e34bf5442ee2-5677@gmail.com>
Message-ID: <CAKkiGbuw2w_3Ad+J2Ri0+5focYHNQt0kkETZ0vo+EOvk4p_8cw@mail.gmail.com>

Hmmm... maybe the below might be easier to remember (at least it is for me)
then:

logo[[which(c(TRUE, TRUE, TRUE))]]
logo[[which(c(TRUE, FALSE, TRUE))]]

Thanks Akos!

On Fri, Jan 17, 2020 at 7:38 AM Bede-Fazekas ?kos <bfalevlist at gmail.com>
wrote:

>
> Dear Ben,
> Although I cannot answer your question on why logical subsetting was not
> implemented in package raster, there is a very easy workaround:
> logo[[(1:nlayers(logo))[c(TRUE, TRUE, TRUE)]]]
> logo[[(1:nlayers(logo))[c(TRUE, FALSE, TRUE)]]]
>
> Also note that in case of lists '[[' does recursive indexing, and this
> type of logical indexing you are asking about works only with '['.
> HTH,
> ?kos Bede-Fazekas
> Hungarian Academy of Sciences
>
> 2020.01.16. 17:50 keltez?ssel, Ben Tupper ?rta:
> > Hi,
> >
> > I usually avoid using logical indexes with multilayer rasters (stacks
> > and bricks), but I have never understood why indexing ala `[[` with
> > logicals isn't supported.  Below is an example that shows how it
> > doesn't work like the typical indexing with logicals.  I'm not asking
> > to have logical indices considered (although it would be handy), but
> > instead I really just want to understand why it is the way it is.  I
> > scanned over the introductory vignette (https://rspatial.org/raster)
> > and issues (https://github.com/rspatial/raster/issues) but found
> > nothing there.
> >
> > Thanks and cheers,
> > Ben
> >
> > ### START
> > library(raster)
> >
> > logo <- raster::brick(system.file("external/rlogo.grd",
> package="raster"))
> >
> > # red-red-red
> > logo[[c(TRUE, TRUE, TRUE)]]
> > # class      : RasterStack
> > # dimensions : 77, 101, 7777, 3  (nrow, ncol, ncell, nlayers)
> > # resolution : 1, 1  (x, y)
> > # extent     : 0, 101, 0, 77  (xmin, xmax, ymin, ymax)
> > # crs        : +proj=merc +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0
> > # names      : red.1, red.2, red.3
> > # min values :     0,     0,     0
> > # max values :   255,   255,   255
> >
> > # red-red
> > logo[[c(TRUE, TRUE)]]
> > # class      : RasterStack
> > # dimensions : 77, 101, 7777, 2  (nrow, ncol, ncell, nlayers)
> > # resolution : 1, 1  (x, y)
> > # extent     : 0, 101, 0, 77  (xmin, xmax, ymin, ymax)
> > # crs        : +proj=merc +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0
> > # names      : red.1, red.2
> > # min values :     0,     0
> > # max values :   255,   255
> >
> > # red
> > logo[[c(TRUE)]]
> > # class      : RasterLayer
> > # band       : 1  (of  3  bands)
> > # dimensions : 77, 101, 7777  (nrow, ncol, ncell)
> > # resolution : 1, 1  (x, y)
> > # extent     : 0, 101, 0, 77  (xmin, xmax, ymin, ymax)
> > # crs        : +proj=merc +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0
> > # source     : /usr/lib64/R/library/raster/external/rlogo.grd
> > # names      : red
> > # values     : 0, 255  (min, max)
> >
> > logo[[c(TRUE, FALSE, TRUE)]]
> > #Error in .local(x, ...) : not a valid subset
> >
> >
> > #sessionInfo()
> > # R version 3.5.1 (2018-07-02)
> > # Platform: x86_64-redhat-linux-gnu (64-bit)
> > # Running under: CentOS Linux 7 (Core)
> > #
> > # Matrix products: default
> > # BLAS/LAPACK: /usr/lib64/R/lib/libRblas.so
> > #
> > # locale:
> > #   [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
> > LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
> > # [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
> > LC_PAPER=en_US.UTF-8       LC_NAME=C
> > # [9] LC_ADDRESS=C               LC_TELEPHONE=C
> > LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
> > #
> > # attached base packages:
> > #   [1] stats     graphics  grDevices utils     datasets  methods   base
> > #
> > # other attached packages:
> > #   [1] raster_3.0-7 sp_1.3-2
> > #
> > # loaded via a namespace (and not attached):
> > #   [1] compiler_3.5.1   rgdal_1.4-8      tools_3.5.1      yaml_2.2.0
> >       Rcpp_1.0.3       codetools_0.2-15
> > # [7] grid_3.5.1       lattice_0.20-35
> >
> > ### END
> >
> >
> >
> >
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


-- 
Vijay Lulla

Assistant Professor,
Dept. of Geography, IUPUI
425 University Blvd, CA-207C.
Indianapolis, IN-46202
vlulla at iupui.edu
ORCID: https://orcid.org/0000-0002-0823-2522
Online: http://vijaylulla.com | https://github.com/vlulla

	[[alternative HTML version deleted]]


From btupper @end|ng |rom b|ge|ow@org  Fri Jan 17 17:07:58 2020
From: btupper @end|ng |rom b|ge|ow@org (Ben Tupper)
Date: Fri, 17 Jan 2020 11:07:58 -0500
Subject: [R-sig-Geo] indexing multi-layer rasters
In-Reply-To: <37a03142-2bfd-97af-0616-cbed8aad3508@gmail.com>
References: <CALrbzg2p_6ts7ZHWbQb=Mja7DQGB=qFdGkLM3iFZsC7kw27Tqw@mail.gmail.com>
 <f464470f-5fdf-bba6-22a8-e34bf5442ee2-5677@gmail.com>
 <CALrbzg3AJYFRv+17rPAfSbUfXA5y60etEs1q6frewHZL7oTTcw@mail.gmail.com>
 <37a03142-2bfd-97af-0616-cbed8aad3508@gmail.com>
Message-ID: <CALrbzg0FMP8QktGJch5TuKzdi1ohE=WjaOeB+5tPnsjt0k6U_w@mail.gmail.com>

Ahhhh, the lightbulb just went off!  That makes perfect sense.

Thanks!
Ben

On Fri, Jan 17, 2020 at 10:45 AM Bede-Fazekas ?kos <bfalevlist at gmail.com> wrote:
>
> Hello Ben,
>
> I think you are absolutely right about "raster's implementation of `[[`
> is different than base R". But I don't agree on your interpretation on
> the logical indexing of rasters ('first logical index is used'). It is
> not the first one. The logical vector is coerced to integer, and c(TRUE,
> TRUE, TRUE) is treated as c(1, 1, 1), while c(TRUE, FALSE, TRUE) is
> treated as c(1, 0, 1). This is why it cause a 'not a valid subset' error
> (there is no sense of searching for the 0th layer of the RasterStack).
> If the first logical index was used, c(TRUE, TRUE, TRUE) and c(TRUE,
> FALSE, TRUE) would give exactly the same result, i.e a RasterLayer
> created from the first layer of the RasterStack.
>
> Have a nice weekend,
> ?kos
>
>
> 2020.01.17. 15:40 keltez?ssel, Ben Tupper ?rta:
> > Hi,
> >
> > Thanks for this.  I think the root of my muddle is the mish-mash model
> > of a raster that I have in my head.  Depending upon what is most
> > convenient, I sometimes view a raster as a multi-dimensional array and
> > at other times as a list of single layer matrices.   If we step back
> > from logical indexing and use integers it is easier to identify
> > raster's slight variation on base R recursive indexing.  The example
> > below uses integer indices on a list and on a raster.
> >
> > Back to logical indexing, in a way it makes perfect sense as just the
> > first logical index is used; just as if() does.  But what is different
> > is that it uses that first logical index for each element in the index
> > vector.  That's why logo[[c(TRUE, TRUE, TRUE)]] yields red.1, red.2
> > and red.3.
> >
> > Thanks again and cheers,
> > Ben
> >
> >
> > library(raster)
> > x <- list(red = "R", green = "G", blue = "B")
> > logo <- raster::brick(system.file("external/rlogo.grd", package="raster"))
> >
> > # `[` index a list, get a list back (with NULL for not found)
> > x[c(1,3)]
> > # $red
> > # [1] "R"
> > #
> > # $green
> > # [1] "G"
> >
> > # `[` index a raster, get a matrix back (or vector for single layer)
> > logo[c(1,3)]
> > #      red green blue
> > # [1,] 255   255  255
> > # [2,] 255   255  255
> >
> > # `[[` recursive index of a list fails
> > x[[c(1,3)]]
> > # Error in x[[c(1, 3)]] : subscript out of bounds
> >
> > # `[[` index of a raster yields raster
> > # so raster's implementation of `[[` is different than base R
> > logo[[c(1,3)]]
> > # class      : RasterStack
> > # dimensions : 77, 101, 7777, 2  (nrow, ncol, ncell, nlayers)
> > # resolution : 1, 1  (x, y)
> > # extent     : 0, 101, 0, 77  (xmin, xmax, ymin, ymax)
> > # crs        : +proj=merc +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0
> > # names      : red, blue
> > # min values :   0,    0
> > # max values : 255,  255
> >
> > On Fri, Jan 17, 2020 at 7:38 AM Bede-Fazekas ?kos <bfalevlist at gmail.com> wrote:
> >>
> >> Dear Ben,
> >> Although I cannot answer your question on why logical subsetting was not
> >> implemented in package raster, there is a very easy workaround:
> >> logo[[(1:nlayers(logo))[c(TRUE, TRUE, TRUE)]]]
> >> logo[[(1:nlayers(logo))[c(TRUE, FALSE, TRUE)]]]
> >>
> >> Also note that in case of lists '[[' does recursive indexing, and this
> >> type of logical indexing you are asking about works only with '['.
> >> HTH,
> >> ?kos Bede-Fazekas
> >> Hungarian Academy of Sciences
> >>
> >> 2020.01.16. 17:50 keltez?ssel, Ben Tupper ?rta:
> >>> Hi,
> >>>
> >>> I usually avoid using logical indexes with multilayer rasters (stacks
> >>> and bricks), but I have never understood why indexing ala `[[` with
> >>> logicals isn't supported.  Below is an example that shows how it
> >>> doesn't work like the typical indexing with logicals.  I'm not asking
> >>> to have logical indices considered (although it would be handy), but
> >>> instead I really just want to understand why it is the way it is.  I
> >>> scanned over the introductory vignette (https://rspatial.org/raster)
> >>> and issues (https://github.com/rspatial/raster/issues) but found
> >>> nothing there.
> >>>
> >>> Thanks and cheers,
> >>> Ben
> >>>
> >>> ### START
> >>> library(raster)
> >>>
> >>> logo <- raster::brick(system.file("external/rlogo.grd", package="raster"))
> >>>
> >>> # red-red-red
> >>> logo[[c(TRUE, TRUE, TRUE)]]
> >>> # class      : RasterStack
> >>> # dimensions : 77, 101, 7777, 3  (nrow, ncol, ncell, nlayers)
> >>> # resolution : 1, 1  (x, y)
> >>> # extent     : 0, 101, 0, 77  (xmin, xmax, ymin, ymax)
> >>> # crs        : +proj=merc +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0
> >>> # names      : red.1, red.2, red.3
> >>> # min values :     0,     0,     0
> >>> # max values :   255,   255,   255
> >>>
> >>> # red-red
> >>> logo[[c(TRUE, TRUE)]]
> >>> # class      : RasterStack
> >>> # dimensions : 77, 101, 7777, 2  (nrow, ncol, ncell, nlayers)
> >>> # resolution : 1, 1  (x, y)
> >>> # extent     : 0, 101, 0, 77  (xmin, xmax, ymin, ymax)
> >>> # crs        : +proj=merc +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0
> >>> # names      : red.1, red.2
> >>> # min values :     0,     0
> >>> # max values :   255,   255
> >>>
> >>> # red
> >>> logo[[c(TRUE)]]
> >>> # class      : RasterLayer
> >>> # band       : 1  (of  3  bands)
> >>> # dimensions : 77, 101, 7777  (nrow, ncol, ncell)
> >>> # resolution : 1, 1  (x, y)
> >>> # extent     : 0, 101, 0, 77  (xmin, xmax, ymin, ymax)
> >>> # crs        : +proj=merc +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0
> >>> # source     : /usr/lib64/R/library/raster/external/rlogo.grd
> >>> # names      : red
> >>> # values     : 0, 255  (min, max)
> >>>
> >>> logo[[c(TRUE, FALSE, TRUE)]]
> >>> #Error in .local(x, ...) : not a valid subset
> >>>
> >>>
> >>> #sessionInfo()
> >>> # R version 3.5.1 (2018-07-02)
> >>> # Platform: x86_64-redhat-linux-gnu (64-bit)
> >>> # Running under: CentOS Linux 7 (Core)
> >>> #
> >>> # Matrix products: default
> >>> # BLAS/LAPACK: /usr/lib64/R/lib/libRblas.so
> >>> #
> >>> # locale:
> >>> #   [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
> >>> LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
> >>> # [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
> >>> LC_PAPER=en_US.UTF-8       LC_NAME=C
> >>> # [9] LC_ADDRESS=C               LC_TELEPHONE=C
> >>> LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
> >>> #
> >>> # attached base packages:
> >>> #   [1] stats     graphics  grDevices utils     datasets  methods   base
> >>> #
> >>> # other attached packages:
> >>> #   [1] raster_3.0-7 sp_1.3-2
> >>> #
> >>> # loaded via a namespace (and not attached):
> >>> #   [1] compiler_3.5.1   rgdal_1.4-8      tools_3.5.1      yaml_2.2.0
> >>>        Rcpp_1.0.3       codetools_0.2-15
> >>> # [7] grid_3.5.1       lattice_0.20-35
> >>>
> >>> ### END
> >>>
> >>>
> >>>
> >>>
> >> _______________________________________________
> >> R-sig-Geo mailing list
> >> R-sig-Geo at r-project.org
> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> >
>


-- 
Ben Tupper
Bigelow Laboratory for Ocean Science
West Boothbay Harbor, Maine
http://www.bigelow.org/
https://eco.bigelow.org


From @@r@h@go@|ee @end|ng |rom gm@||@com  Fri Jan 17 19:32:51 2020
From: @@r@h@go@|ee @end|ng |rom gm@||@com (Sarah Goslee)
Date: Fri, 17 Jan 2020 13:32:51 -0500
Subject: [R-sig-Geo] write to netcdf
In-Reply-To: <CAN=6O0KJ-v45reRGSpRL=kTmDKeezPKON-YzA8S4nUR7yrU=Mg@mail.gmail.com>
References: <CAN=6O0KJ-v45reRGSpRL=kTmDKeezPKON-YzA8S4nUR7yrU=Mg@mail.gmail.com>
Message-ID: <CAM_vju=hDHFb_+UceEtMEqC0TMxE2izPYc0eU22V0vnqYXP6tg@mail.gmail.com>

Hi,

Have you tried, for example, the methods in the RNetCDF package described here?
https://boris.unibe.ch/47220/7/Michna_Woods.pdf

You are likely to get more useful (and faster) responses if you tell
us what you've tried, and what specifically didn't work.

Sarah

On Tue, Jan 14, 2020 at 9:23 AM Abdoulaye Sarr <abdoulayesar at gmail.com> wrote:
>
> I have a datasets with below profile I want to write/export to netcdf :
>
> .@ dates      : Date[1:2], format: "2019-03-15" "2019-07-30"
>   ..@ data       :List of 2
>   .. ..$ 2019-03-15:'data.frame': 47005 obs. of  11 variables:
>   .. .. ..$ MeanTemperature     : num [1:47005] NA NA NA NA NA NA NA NA NA
> NA ...
>   .. .. ..$ MinTemperature      : num [1:47005] NA NA NA NA NA NA NA NA NA
> NA ...
>   .. .. ..$ MaxTemperature      : num [1:47005] NA NA NA NA NA NA NA NA NA
> NA ...
>   .. .. ..$ Precipitation       : num [1:47005] 0 0 0 0 0 0 0 0 0 0 ...
>
>   .. ..$ 2019-07-30:'data.frame': 47005 obs. of  11 variables:
>   .. .. ..$ MeanTemperature     : num [1:47005] NA NA NA NA NA NA NA NA NA
> NA ...
>   .. .. ..$ MinTemperature      : num [1:47005] NA NA NA NA NA NA NA NA NA
> NA ...
>   .. .. ..$ MaxTemperature      : num [1:47005] NA NA NA NA NA NA NA NA NA
> NA ...
>   .. .. ..$ Precipitation       : num [1:47005] NA NA NA NA NA NA NA NA NA
> NA ...
>
>   ..@ grid       :Formal class 'GridTopology' [package "sp"] with 3 slots
>   .. .. ..@ cellcentre.offset: Named num [1:2] 289868 1432838
>   .. .. .. ..- attr(*, "names")= chr [1:2] "s1" "s2"
>   .. .. ..@ cellsize         : num [1:2] 902 922
>   .. .. ..@ cells.dim        : int [1:2] 395 119
>   ..@ bbox       : num [1:2, 1:2] 289417 1432377 645707 1542095
>   .. ..- attr(*, "dimnames")=List of 2
>   .. .. ..$ : chr [1:2] "s1" "s2"
>   .. .. ..$ : chr [1:2] "min" "max"
>   ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slot
>   .. .. ..@ projargs: chr "+init=epsg:32628 +proj=utm +zone=28 +datum=WGS84
> +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0"
>
> Any hint on this much appreciated.
>
> AS

-- 
Sarah Goslee (she/her)
http://www.numberwright.com


From r@turner @end|ng |rom @uck|@nd@@c@nz  Mon Jan 20 10:40:18 2020
From: r@turner @end|ng |rom @uck|@nd@@c@nz (Rolf Turner)
Date: Mon, 20 Jan 2020 22:40:18 +1300
Subject: [R-sig-Geo] Testing --- please ignore.
Message-ID: <6e4a7f13-3dae-9258-3eb5-aabe7086b304@auckland.ac.nz>


Sorry for the noise. I'm just trying to test a message filter on my mailer.

cheers,

Rolf Turner

-- 
Honorary Research Fellow
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276


From D@n@Ke||ey @end|ng |rom D@|@C@  Tue Jan 21 15:45:30 2020
From: D@n@Ke||ey @end|ng |rom D@|@C@ (Daniel Kelley)
Date: Tue, 21 Jan 2020 14:45:30 +0000
Subject: [R-sig-Geo] how to find projections supported by sf::st_crs()?
Message-ID: <163F12F3-79B8-495F-88B0-3011575B3008@dal.ca>

I am pondering the use of `sf::sf_project()` for map-projection calculations within the `oce` package. My impression is that `sf::st_crs()` ought to be used to process projection strings, instead of handing strings directly to `sf::sf_project()`.  (I think the idea is that this will lead to the addition of extra information about the ellipse model, etc., and perhaps do some checks for errors in the string.)

However, my tests show that `sf::st_crs()` balks at some projections, such as `wintri`, as shown in the code snippets given near the end of this email.  (Those snippets also show that `sf::sf_project()` handles the wintri projection, as does `rgdal::project()`, so the warning does not mean that `sf` will refuse to do the projection.)

This leads me to three questions, that I'm hoping others can shed light on.

1. Am I right in thinking that I ought to use `sf::sf_crs()` to "clean up" my projection specifications?

2. Is there a way to find the list of projections that `sf::sf_crs()` accepts without producing `NA` results and warnings?

3. Should I avoid using projections that `sf::sf_crs()` warns about?

I apologize if I ought to have gathered the results from my reading.  I could be looking in the wrong places.

Thanks in advance for any advice!  -- Dan.

```R
> library(sf)
Linking to GEOS 3.8.0, GDAL 2.4.2, PROJ 6.2.1

> sf::sf_project("+proj=lonlat", "+proj=wintri", cbind(0,0))
     [,1] [,2]
[1,]    0    0

> sf::st_crs("+proj=wintri")
Coordinate Reference System: NA
Warning message:
In CPL_crs_from_proj4string(x) :
  GDAL cannot import PROJ.4 string `+proj=wintri': returning missing CRS
```

Dan E. Kelley [he/him/his 314ppm]
Dalhousie University


From edzer@pebe@m@ @end|ng |rom un|-muen@ter@de  Tue Jan 21 16:54:35 2020
From: edzer@pebe@m@ @end|ng |rom un|-muen@ter@de (Edzer Pebesma)
Date: Tue, 21 Jan 2020 16:54:35 +0100
Subject: [R-sig-Geo] how to find projections supported by sf::st_crs()?
In-Reply-To: <163F12F3-79B8-495F-88B0-3011575B3008@dal.ca>
References: <163F12F3-79B8-495F-88B0-3011575B3008@dal.ca>
Message-ID: <2acb999c-0b25-6866-5d4f-3f543c5e4a05@uni-muenster.de>

Please note that anything I am going to write concerns current sf (on
CRAN), and that things will change pretty strongly in a month or so,
driven by GDAL 3.x and PROJ 6.2.x releases.

st_crs() takes a proj4string or an EPSG number, and tries to resolve
this using GDAL. Although it uses PROJ, GDAL is more strict than PROJ in
accepting proj4strings, and as you noted +wintri is not accepted.

sf_project() was written exactly for the reason that it communicates to
PROJ without going through GDAL, and hence is more flexible; all
proj4strings PROJ accepts are fine as input, but those that are not
accepted by GDAL can only be passed as character strings for the reason
mentioned above.

Hth,

On 1/21/20 3:45 PM, Daniel Kelley wrote:
> I am pondering the use of `sf::sf_project()` for map-projection calculations within the `oce` package. My impression is that `sf::st_crs()` ought to be used to process projection strings, instead of handing strings directly to `sf::sf_project()`.  (I think the idea is that this will lead to the addition of extra information about the ellipse model, etc., and perhaps do some checks for errors in the string.)
> 
> However, my tests show that `sf::st_crs()` balks at some projections, such as `wintri`, as shown in the code snippets given near the end of this email.  (Those snippets also show that `sf::sf_project()` handles the wintri projection, as does `rgdal::project()`, so the warning does not mean that `sf` will refuse to do the projection.)
> 
> This leads me to three questions, that I'm hoping others can shed light on.
> 
> 1. Am I right in thinking that I ought to use `sf::sf_crs()` to "clean up" my projection specifications?
> 
> 2. Is there a way to find the list of projections that `sf::sf_crs()` accepts without producing `NA` results and warnings?
> 
> 3. Should I avoid using projections that `sf::sf_crs()` warns about?
> 
> I apologize if I ought to have gathered the results from my reading.  I could be looking in the wrong places.
> 
> Thanks in advance for any advice!  -- Dan.
> 
> ```R
>> library(sf)
> Linking to GEOS 3.8.0, GDAL 2.4.2, PROJ 6.2.1
> 
>> sf::sf_project("+proj=lonlat", "+proj=wintri", cbind(0,0))
>      [,1] [,2]
> [1,]    0    0
> 
>> sf::st_crs("+proj=wintri")
> Coordinate Reference System: NA
> Warning message:
> In CPL_crs_from_proj4string(x) :
>   GDAL cannot import PROJ.4 string `+proj=wintri': returning missing CRS
> ```
> 
> Dan E. Kelley [he/him/his 314ppm]
> Dalhousie University
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48151 Muenster, Germany
Phone: +49 251 8333081

-------------- next part --------------
A non-text attachment was scrubbed...
Name: pEpkey.asc
Type: application/pgp-keys
Size: 3110 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20200121/319b0e69/attachment.bin>

From g|u@eppe@@m@tu||| @end|ng |rom gm@||@com  Mon Jan 27 21:28:05 2020
From: g|u@eppe@@m@tu||| @end|ng |rom gm@||@com (Giuseppe Amatulli)
Date: Mon, 27 Jan 2020 15:28:05 -0500
Subject: [R-sig-Geo] Fwd: Summer School "Geocomputation"
In-Reply-To: <CAKoiDHJqV4aCa2mW4G27HBj-Paq8chYd3=Rh3r7Mi4rKq1txHQ@mail.gmail.com>
References: <CAKoiDHLoWs0ZHGBwD+sREN-6-_dFZPzeULyCp_DN2eCuQhzw-Q@mail.gmail.com>
 <CAKoiDHLfVKEez2ehWfNASYUQpX=nYwWWWTwdcxm713kT1-JspA@mail.gmail.com>
 <CAKoiDHLKvS3MMb1_3CFJJKu=0BZQ7NNw4yJfLHpwYUw=YAgTFA@mail.gmail.com>
 <CAKoiDHJqV4aCa2mW4G27HBj-Paq8chYd3=Rh3r7Mi4rKq1txHQ@mail.gmail.com>
Message-ID: <CAKoiDH+LjhpG3sNMZyRz02YTpJJE1YGJ1khpUbh5xOWQ-K8Wmw@mail.gmail.com>

Dear colleagues,

In view of enlarging the computation skills in the geographic domain, as
every year, we are running the International Summer School "
*Geocomputation using free and Open Source Software*" organized by Spatial
Ecology (www.spatial-ecology.net) held at the University of Basilicata, in
the magnificent town Matera
<https://www.google.com/maps/place/75100+Matera,+Province+of+Matera,+Italy/@40.6646012,16.5651092,13z/data=!3m1!4b1!4m5!3m4!1s0x13477ee2482b152b:0x8f6a4ae10da9360!8m2!3d40.666379!4d16.6043199>
, Italy.

This is a wonderful opportunity for PhD students and Post-Doc to achieve
computation skills process and be able to work in Linux supercomputer in a
clever way.

Please forward this opportunity to your network.

Sincerely, Giuseppe Amatulli


*Geocomputation using free and Open Source Software** (1st-5th June 2020)*

A 5 days intense experience opening new horizons on the use of the vast
potentials of *Linux* environment and the command line approach for
*geo-data* massive processing using Bash, AWK, Python, GRASS, QGIS,
GDAL/OGR, R, PKTOOLS. We will guide newcomers and experienced GIS&RS users
who have never used a command line terminal to a stage which will allow
them to understand and apply very advanced open source data processing
routines. Our focus is to enhance a self-learning approach and
programming-languages integration. This allows participants to keep on
progressing and improving their skills in a continuously evolving
technological environment.

More information and registration:

www.spatial-ecology.net
www.facebook.com/spatialecology > see events
twitter: @BigDataEcology

Best regards
Spatial Ecology ? Team

-- 
Giuseppe Amatulli, Ph.D.

Research scientist at
Yale School of Forestry & Environmental Studies
Yale Center for Research Computing
New Haven, 06511
Teaching: http://spatial-ecology.net
Work:  https://environment.yale.edu/profile/giuseppe-amatulli/


-- 
Giuseppe Amatulli, Ph.D.

Research scientist at
Yale School of Forestry & Environmental Studies
Yale Center for Research Computing
New Haven, 06511
Teaching: http://spatial-ecology.net
Work:  https://environment.yale.edu/profile/giuseppe-amatulli/


-- 
Giuseppe Amatulli, Ph.D.

Research scientist at
Yale School of Forestry & Environmental Studies
Yale Center for Research Computing
New Haven, 06511
Teaching: http://spatial-ecology.net
Work:  https://environment.yale.edu/profile/giuseppe-amatulli/


-- 
Giuseppe Amatulli, Ph.D.

Research scientist at
Yale School of Forestry & Environmental Studies
Yale Center for Research Computing
New Haven, 06511
Teaching: http://spatial-ecology.net
Work:  https://environment.yale.edu/profile/giuseppe-amatulli/


-- 
Giuseppe Amatulli, Ph.D.

Research scientist at
Yale School of Forestry & Environmental Studies
Yale Center for Research Computing
New Haven, 06511
Teaching: http://spatial-ecology.net
Work:  https://environment.yale.edu/profile/giuseppe-amatulli/

	[[alternative HTML version deleted]]


From Arn@ud@DeGroo| @end|ng |rom @p@cebe|@be  Tue Jan 28 16:46:45 2020
From: Arn@ud@DeGroo| @end|ng |rom @p@cebe|@be (Arnaud De Groof)
Date: Tue, 28 Jan 2020 15:46:45 +0000
Subject: [R-sig-Geo] Error in the installation of rgdal on the docker
 osgeo/gdal:ubuntu-small
Message-ID: <1580226405250.15862@spacebel.be>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20200128/bd046f19/attachment.html>

From Roger@B|v@nd @end|ng |rom nhh@no  Tue Jan 28 20:47:32 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Tue, 28 Jan 2020 19:47:32 +0000
Subject: [R-sig-Geo] Error in the installation of rgdal on the docker
 osgeo/gdal:ubuntu-small
In-Reply-To: <1580226405250.15862@spacebel.be>
References: <1580226405250.15862@spacebel.be>
Message-ID: <4286e11c4a7147f88bb5578e87de1722@nhh.no>

Thanks for this. The configure script does not check that sqlite is available, and should do that. For now, make sqlite available in the image (PROJ needs it from PROJ 6). Did you know that you are pulling GDAL 3.1.0, which has not been released or checked with R packages (not the problem here)? If the problem with the configure failure gets resolved, you'll need to install from rgdal from R-Forge, no more patch releases for 1.4.*. If you want to experiment with WKT2 CRS, also grab sp from my github master.

Roger

--
Roger Bivand
Norwegian School of Economics
Helleveien 30, 5045 Bergen, Norway
Roger.Bivand at nhh.no


________________________________________
Fra: R-sig-Geo <r-sig-geo-bounces at r-project.org> p? vegne av Arnaud De Groof <Arnaud.DeGroof at spacebel.be>
Sendt: tirsdag 28. januar 2020 16.46
Til: r-sig-geo at r-project.org
Emne: [R-sig-Geo] Error in the installation of rgdal on the docker osgeo/gdal:ubuntu-small

Hi,


I am trying to install the rgdal package on a docker image based on osgeo/gdal:ubuntu-small (latest) but I encounter the following issue:



> install.packages('rgdal', repos='http://cran.rstudio.com', configure.args = c('--with-gdal-config=/usr/bin/gdal-config','--with-gdal-share=/usr/share/gdal', '--with-proj-include=/usr/include', '--with-proj-lib=/usr/share/proj'))
Installing package into '/usr/local/lib/R/site-library'
(as 'lib' is unspecified)
also installing the dependency 'sp'

trying URL 'http://cran.rstudio.com/src/contrib/sp_1.3-2.tar.gz'
Content type 'application/x-gzip' length 1132347 bytes (1.1 MB)
==================================================
downloaded 1.1 MB

trying URL 'http://cran.rstudio.com/src/contrib/rgdal_1.4-8.tar.gz'
Content type 'application/x-gzip' length 1698902 bytes (1.6 MB)
==================================================
downloaded 1.6 MB

* installing *source* package 'sp' ...
** package 'sp' successfully unpacked and MD5 sums checked
** using staged installation
** libs
gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG     -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c Rcentroid.c -o Rcentroid.o
gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG     -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c gcdist.c -o gcdist.o
gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG     -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c init.c -o init.o
gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG     -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c pip.c -o pip.o
gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG     -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c pip2.c -o pip2.o
gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG     -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c sp_xports.c -o sp_xports.o
gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG     -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c surfaceArea.c -o surfaceArea.o
gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG     -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c zerodist.c -o zerodist.o
gcc -std=gnu99 -shared -L/usr/lib/R/lib -Wl,-Bsymbolic-functions -Wl,-z,relro -o sp.so Rcentroid.o gcdist.o init.o pip.o pip2.o sp_xports.o surfaceArea.o zerodist.o -L/usr/lib/R/lib -lR
installing to /usr/local/lib/R/site-library/00LOCK-sp/00new/sp/libs
** R
** data
** demo
** inst
** byte-compile and prepare package for lazy loading
** help
*** installing help indices
** building package indices
** installing vignettes
** testing if installed package can be loaded from temporary location
** checking absolute paths in shared objects and dynamic libraries
** testing if installed package can be loaded from final location
** testing if installed package keeps a record of temporary installation path
* DONE (sp)
* installing *source* package 'rgdal' ...
** package 'rgdal' successfully unpacked and MD5 sums checked
** using staged installation
configure: R_HOME: /usr/lib/R
configure: CC: gcc -std=gnu99
configure: CXX: g++ -std=gnu++11
configure: C++11 support available
configure: rgdal: 1.4-7
checking for /usr/bin/svnversion... no
configure: svn revision: 845
checking for gdal-config... /usr/bin/gdal-config
checking gdal-config usability... yes
configure: GDAL: 3.1.0
checking GDAL version >= 1.11.4... yes
checking GDAL version <= 2.5 or >= 3.0... yes
checking gdal: linking with --libs only... yes
checking GDAL: gdal-config data directory readable... yes
checking GDAL: /usr/share/gdal/pcs.csv readable... no
configure: pkg-config proj exists, will use it
configure: PROJ version: 6.3.0
configure: Support for PROJ >= 6.0.0 not yet available, deprecated API defined
configure: proj CPP flags: -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H -I/usr/local/include
configure: PROJ LIBS: -L/usr/local/lib -lproj
checking PROJ header API:... proj_api.h
checking proj_api.h presence and usability... yes
checking PROJ version agreement... yes
checking PROJ version >= 4.8.0... yes
/usr/bin/ld: cannot find -lsqlite3
collect2: error: ld returned 1 exit status
./configure: line 2437: ./proj_conf_test2: No such file or directory
checking PROJ: proj.db found and readable... yes
configure: Package CPP flags:  -I/usr/include -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H
configure: Package LIBS:  -L/usr/lib -lgdal -L/usr/local/lib -lproj
configure: creating ./config.status
config.status: creating src/Makevars
** libs
g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H -I"/usr/local/lib/R/site-library/sp/include"   -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c OGR_write.cpp -o OGR_write.o
g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H -I"/usr/local/lib/R/site-library/sp/include"   -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c gdal-bindings.cpp -o gdal-bindings.o
gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG -I/usr/include -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H -I"/usr/local/lib/R/site-library/sp/include"   -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c init.c -o init.o
gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG -I/usr/include -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H -I"/usr/local/lib/R/site-library/sp/include"   -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c inverser.c -o inverser.o
gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG -I/usr/include -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H -I"/usr/local/lib/R/site-library/sp/include"   -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c local_stubs.c -o local_stubs.o
g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H -I"/usr/local/lib/R/site-library/sp/include"   -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c ogr_geom.cpp -o ogr_geom.o
gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG -I/usr/include -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H -I"/usr/local/lib/R/site-library/sp/include"   -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c ogr_polygons.c -o ogr_polygons.o
g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H -I"/usr/local/lib/R/site-library/sp/include"   -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c ogr_proj.cpp -o ogr_proj.o
g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H -I"/usr/local/lib/R/site-library/sp/include"   -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c ogrdrivers.cpp -o ogrdrivers.o
g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H -I"/usr/local/lib/R/site-library/sp/include"   -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c ogrsource.cpp -o ogrsource.o
g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H -I"/usr/local/lib/R/site-library/sp/include"   -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c proj_info6.cpp -o proj_info6.o
g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H -I"/usr/local/lib/R/site-library/sp/include"   -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c projectit.cpp -o projectit.o
g++ -std=gnu++11 -shared -L/usr/lib/R/lib -Wl,-Bsymbolic-functions -Wl,-z,relro -o rgdal.so OGR_write.o gdal-bindings.o init.o inverser.o local_stubs.o ogr_geom.o ogr_polygons.o ogr_proj.o ogrdrivers.o ogrsource.o proj_info6.o projectit.o -L/usr/lib -lgdal -L/usr/local/lib -lproj -L/usr/lib/R/lib -lR
installing to /usr/local/lib/R/site-library/00LOCK-rgdal/00new/rgdal/libs
** R
** data
** inst
** byte-compile and prepare package for lazy loading
** help
*** installing help indices
** building package indices
** installing vignettes
** testing if installed package can be loaded from temporary location
Error: package or namespace load failed for 'rgdal' in dyn.load(file, DLLpath = DLLpath, ...):
 unable to load shared object '/usr/local/lib/R/site-library/00LOCK-rgdal/00new/rgdal/libs/rgdal.so':
  /usr/local/lib/R/site-library/00LOCK-rgdal/00new/rgdal/libs/rgdal.so: undefined symbol: proj_list_operations
Error: loading failed
Execution halted
ERROR: loading failed
* removing '/usr/local/lib/R/site-library/rgdal'

The downloaded source packages are in
        '/tmp/RtmpeD6Lq2/downloaded_packages'
Warning message:
In install.packages("rgdal", repos = "http://cran.rstudio.com",  :
  installation of package 'rgdal' had non-zero exit status



Here the dockerfile:


FROM osgeo/gdal:ubuntu-small-latest

ENV DEBIAN_FRONTEND=noninteractive

#######################
### Install
RUN apt-get update && apt-get install -y\
 zip\
 bc\
 curl\
 lsb-release\
 libfreetype6\
 #r-base\
 default-jre\
 pkg-config\
 wget\
 git\
 libproj-dev\
 proj-data\
 proj-bin\
 libcurl4-openssl-dev\
 python-pip && \
 pip install pip==9.0.1 && \
 pip install\
 numpy==1.14.1 \
 Jinja2 \
 geojson \
 requests \
 rasterstats \
 pandas \
 pyshp \
 Pillow \
 scipy

RUN apt install -y apt-transport-https software-properties-common
RUN gpg --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys E298A3A825C0D65DFD57CBB651716619E084DAB9
RUN gpg -a --export E298A3A825C0D65DFD57CBB651716619E084DAB9 | apt-key add -
RUN add-apt-repository 'deb https://cloud.r-project.org/bin/linux/ubuntu bionic-cran35/' && \
    apt-get update

RUN apt install -y r-base r-base-core r-recommended

RUN R --version

ENV GDAL_DATA /usr/share/gdal/
ENV PROJ_LIB /usr/share/proj/

RUN R -e "install.packages('rgdal', repos='http://cran.rstudio.com', configure.args = c('--with-gdal-config=/usr/bin/gdal-config','--with-gdal-share=/usr/share/gdal', '--with-proj-include=/usr/include', '--with-proj-lib=/usr/share/proj'))"


Thanks,

Arnaud


------------------------------------------------------------------------------

E-MAIL DISCLAIMER

The present message may contain confidential and/or legally privileged information. If you are not the intended addressee and in case of a transmission error, please notify the sender immediately and destroy this E-mail. Disclosure, reproduction or distribution of this document and its possible attachments is strictly forbidden.

SPACEBEL denies all liability for incomplete, improper, inaccurate, intercepted, (partly) destroyed, lost and/or belated transmission of the current information given that unencrypted electronic transmission cannot currently be guaranteed to be secure or error free.
Upon request or in conformity with formal, contractual agreements, an originally signed hard copy will be sent to you to confirm the information contained in this E-mail.

SPACEBEL denies all liability where E-mail is used for private use.

SPACEBEL cannot be held responsible for possible viruses that might corrupt this message and/or your computer system.
-------------------------------------------------------------------------------


From h@mmn|ck @end|ng |rom gm@||@com  Wed Jan 29 05:22:00 2020
From: h@mmn|ck @end|ng |rom gm@||@com (Nick Hamm)
Date: Wed, 29 Jan 2020 15:22:00 +1100
Subject: [R-sig-Geo] gstat / Linear model of coregionalization
Message-ID: <CALSqE8F9FwforoaP-2_sLW-bc2v_Fa4NQj3j34QmtTMC1EpAPw@mail.gmail.com>

Dear all
Is anybody using gstat for computing cross-variograms and fitting cross
variogram models?  I have implemented this in a similar manner to the
example code given in the gstat vignette (Section 10).

I would like to extract the coefficients (i.g., the  b_{ij}^l of the linear
model of coregionalization as given in Equation 4.37 of Goovaearts (1997)
book (page 110).

\gamma_{ij} (h) = \sum_{l=0}^L b_{ij}^l g_l(h) \forall i, j

[image: image.png]



Is this possible?

kind regards

Nick

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20200129/309df670/attachment.html>

-------------- next part --------------
A non-text attachment was scrubbed...
Name: image.png
Type: image/png
Size: 1807 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20200129/309df670/attachment.png>

From Roger@B|v@nd @end|ng |rom nhh@no  Wed Jan 29 12:00:27 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Wed, 29 Jan 2020 12:00:27 +0100
Subject: [R-sig-Geo] Error in the installation of rgdal on the docker
 osgeo/gdal:ubuntu-small
In-Reply-To: <4286e11c4a7147f88bb5578e87de1722@nhh.no>
References: <1580226405250.15862@spacebel.be>
 <4286e11c4a7147f88bb5578e87de1722@nhh.no>
Message-ID: <alpine.LFD.2.21.2001291158090.842912@reclus.nhh.no>

On Tue, 28 Jan 2020, Roger Bivand wrote:

> Thanks for this. The configure script does not check that sqlite is 
> available, and should do that. For now, make sqlite available in the 
> image (PROJ needs it from PROJ 6). Did you know that you are pulling 
> GDAL 3.1.0, which has not been released or checked with R packages (not 
> the problem here)? If the problem with the configure failure gets 
> resolved, you'll need to install from rgdal from R-Forge, no more patch 
> releases for 1.4.*. If you want to experiment with WKT2 CRS, also grab 
> sp from my github master.

Please try revision 926 from https://r-forge.r-project.org/R/?group_id=884 
once it refreshes (and if the build succeeds); this includes a 
non-failing test for sqlite3. Once you report back, I can also modify it 
to hard-fail.

Roger

>
> Roger
>
> --
> Roger Bivand
> Norwegian School of Economics
> Helleveien 30, 5045 Bergen, Norway
> Roger.Bivand at nhh.no
>
>
> ________________________________________
> Fra: R-sig-Geo <r-sig-geo-bounces at r-project.org> p? vegne av Arnaud De Groof <Arnaud.DeGroof at spacebel.be>
> Sendt: tirsdag 28. januar 2020 16.46
> Til: r-sig-geo at r-project.org
> Emne: [R-sig-Geo] Error in the installation of rgdal on the docker osgeo/gdal:ubuntu-small
>
> Hi,
>
>
> I am trying to install the rgdal package on a docker image based on osgeo/gdal:ubuntu-small (latest) but I encounter the following issue:
>
>
>
>> install.packages('rgdal', repos='http://cran.rstudio.com', configure.args = c('--with-gdal-config=/usr/bin/gdal-config','--with-gdal-share=/usr/share/gdal', '--with-proj-include=/usr/include', '--with-proj-lib=/usr/share/proj'))
> Installing package into '/usr/local/lib/R/site-library'
> (as 'lib' is unspecified)
> also installing the dependency 'sp'
>
> trying URL 'http://cran.rstudio.com/src/contrib/sp_1.3-2.tar.gz'
> Content type 'application/x-gzip' length 1132347 bytes (1.1 MB)
> ==================================================
> downloaded 1.1 MB
>
> trying URL 'http://cran.rstudio.com/src/contrib/rgdal_1.4-8.tar.gz'
> Content type 'application/x-gzip' length 1698902 bytes (1.6 MB)
> ==================================================
> downloaded 1.6 MB
>
> * installing *source* package 'sp' ...
> ** package 'sp' successfully unpacked and MD5 sums checked
> ** using staged installation
> ** libs
> gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG     -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c Rcentroid.c -o Rcentroid.o
> gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG     -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c gcdist.c -o gcdist.o
> gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG     -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c init.c -o init.o
> gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG     -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c pip.c -o pip.o
> gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG     -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c pip2.c -o pip2.o
> gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG     -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c sp_xports.c -o sp_xports.o
> gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG     -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c surfaceArea.c -o surfaceArea.o
> gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG     -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c zerodist.c -o zerodist.o
> gcc -std=gnu99 -shared -L/usr/lib/R/lib -Wl,-Bsymbolic-functions -Wl,-z,relro -o sp.so Rcentroid.o gcdist.o init.o pip.o pip2.o sp_xports.o surfaceArea.o zerodist.o -L/usr/lib/R/lib -lR
> installing to /usr/local/lib/R/site-library/00LOCK-sp/00new/sp/libs
> ** R
> ** data
> ** demo
> ** inst
> ** byte-compile and prepare package for lazy loading
> ** help
> *** installing help indices
> ** building package indices
> ** installing vignettes
> ** testing if installed package can be loaded from temporary location
> ** checking absolute paths in shared objects and dynamic libraries
> ** testing if installed package can be loaded from final location
> ** testing if installed package keeps a record of temporary installation path
> * DONE (sp)
> * installing *source* package 'rgdal' ...
> ** package 'rgdal' successfully unpacked and MD5 sums checked
> ** using staged installation
> configure: R_HOME: /usr/lib/R
> configure: CC: gcc -std=gnu99
> configure: CXX: g++ -std=gnu++11
> configure: C++11 support available
> configure: rgdal: 1.4-7
> checking for /usr/bin/svnversion... no
> configure: svn revision: 845
> checking for gdal-config... /usr/bin/gdal-config
> checking gdal-config usability... yes
> configure: GDAL: 3.1.0
> checking GDAL version >= 1.11.4... yes
> checking GDAL version <= 2.5 or >= 3.0... yes
> checking gdal: linking with --libs only... yes
> checking GDAL: gdal-config data directory readable... yes
> checking GDAL: /usr/share/gdal/pcs.csv readable... no
> configure: pkg-config proj exists, will use it
> configure: PROJ version: 6.3.0
> configure: Support for PROJ >= 6.0.0 not yet available, deprecated API defined
> configure: proj CPP flags: -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H -I/usr/local/include
> configure: PROJ LIBS: -L/usr/local/lib -lproj
> checking PROJ header API:... proj_api.h
> checking proj_api.h presence and usability... yes
> checking PROJ version agreement... yes
> checking PROJ version >= 4.8.0... yes
> /usr/bin/ld: cannot find -lsqlite3
> collect2: error: ld returned 1 exit status
> ./configure: line 2437: ./proj_conf_test2: No such file or directory
> checking PROJ: proj.db found and readable... yes
> configure: Package CPP flags:  -I/usr/include -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H
> configure: Package LIBS:  -L/usr/lib -lgdal -L/usr/local/lib -lproj
> configure: creating ./config.status
> config.status: creating src/Makevars
> ** libs
> g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H -I"/usr/local/lib/R/site-library/sp/include"   -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c OGR_write.cpp -o OGR_write.o
> g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H -I"/usr/local/lib/R/site-library/sp/include"   -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c gdal-bindings.cpp -o gdal-bindings.o
> gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG -I/usr/include -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H -I"/usr/local/lib/R/site-library/sp/include"   -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c init.c -o init.o
> gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG -I/usr/include -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H -I"/usr/local/lib/R/site-library/sp/include"   -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c inverser.c -o inverser.o
> gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG -I/usr/include -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H -I"/usr/local/lib/R/site-library/sp/include"   -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c local_stubs.c -o local_stubs.o
> g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H -I"/usr/local/lib/R/site-library/sp/include"   -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c ogr_geom.cpp -o ogr_geom.o
> gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG -I/usr/include -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H -I"/usr/local/lib/R/site-library/sp/include"   -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c ogr_polygons.c -o ogr_polygons.o
> g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H -I"/usr/local/lib/R/site-library/sp/include"   -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c ogr_proj.cpp -o ogr_proj.o
> g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H -I"/usr/local/lib/R/site-library/sp/include"   -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c ogrdrivers.cpp -o ogrdrivers.o
> g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H -I"/usr/local/lib/R/site-library/sp/include"   -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c ogrsource.cpp -o ogrsource.o
> g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H -I"/usr/local/lib/R/site-library/sp/include"   -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c proj_info6.cpp -o proj_info6.o
> g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H -I"/usr/local/lib/R/site-library/sp/include"   -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c projectit.cpp -o projectit.o
> g++ -std=gnu++11 -shared -L/usr/lib/R/lib -Wl,-Bsymbolic-functions -Wl,-z,relro -o rgdal.so OGR_write.o gdal-bindings.o init.o inverser.o local_stubs.o ogr_geom.o ogr_polygons.o ogr_proj.o ogrdrivers.o ogrsource.o proj_info6.o projectit.o -L/usr/lib -lgdal -L/usr/local/lib -lproj -L/usr/lib/R/lib -lR
> installing to /usr/local/lib/R/site-library/00LOCK-rgdal/00new/rgdal/libs
> ** R
> ** data
> ** inst
> ** byte-compile and prepare package for lazy loading
> ** help
> *** installing help indices
> ** building package indices
> ** installing vignettes
> ** testing if installed package can be loaded from temporary location
> Error: package or namespace load failed for 'rgdal' in dyn.load(file, DLLpath = DLLpath, ...):
> unable to load shared object '/usr/local/lib/R/site-library/00LOCK-rgdal/00new/rgdal/libs/rgdal.so':
>  /usr/local/lib/R/site-library/00LOCK-rgdal/00new/rgdal/libs/rgdal.so: undefined symbol: proj_list_operations
> Error: loading failed
> Execution halted
> ERROR: loading failed
> * removing '/usr/local/lib/R/site-library/rgdal'
>
> The downloaded source packages are in
>        '/tmp/RtmpeD6Lq2/downloaded_packages'
> Warning message:
> In install.packages("rgdal", repos = "http://cran.rstudio.com",  :
>  installation of package 'rgdal' had non-zero exit status
>
>
>
> Here the dockerfile:
>
>
> FROM osgeo/gdal:ubuntu-small-latest
>
> ENV DEBIAN_FRONTEND=noninteractive
>
> #######################
> ### Install
> RUN apt-get update && apt-get install -y\
> zip\
> bc\
> curl\
> lsb-release\
> libfreetype6\
> #r-base\
> default-jre\
> pkg-config\
> wget\
> git\
> libproj-dev\
> proj-data\
> proj-bin\
> libcurl4-openssl-dev\
> python-pip && \
> pip install pip==9.0.1 && \
> pip install\
> numpy==1.14.1 \
> Jinja2 \
> geojson \
> requests \
> rasterstats \
> pandas \
> pyshp \
> Pillow \
> scipy
>
> RUN apt install -y apt-transport-https software-properties-common
> RUN gpg --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys E298A3A825C0D65DFD57CBB651716619E084DAB9
> RUN gpg -a --export E298A3A825C0D65DFD57CBB651716619E084DAB9 | apt-key add -
> RUN add-apt-repository 'deb https://cloud.r-project.org/bin/linux/ubuntu bionic-cran35/' && \
>    apt-get update
>
> RUN apt install -y r-base r-base-core r-recommended
>
> RUN R --version
>
> ENV GDAL_DATA /usr/share/gdal/
> ENV PROJ_LIB /usr/share/proj/
>
> RUN R -e "install.packages('rgdal', repos='http://cran.rstudio.com', configure.args = c('--with-gdal-config=/usr/bin/gdal-config','--with-gdal-share=/usr/share/gdal', '--with-proj-include=/usr/include', '--with-proj-lib=/usr/share/proj'))"
>
>
> Thanks,
>
> Arnaud
>
>
> ------------------------------------------------------------------------------
>
> E-MAIL DISCLAIMER
>
> The present message may contain confidential and/or legally privileged information. If you are not the intended addressee and in case of a transmission error, please notify the sender immediately and destroy this E-mail. Disclosure, reproduction or distribution of this document and its possible attachments is strictly forbidden.
>
> SPACEBEL denies all liability for incomplete, improper, inaccurate, intercepted, (partly) destroyed, lost and/or belated transmission of the current information given that unencrypted electronic transmission cannot currently be guaranteed to be secure or error free.
> Upon request or in conformity with formal, contractual agreements, an originally signed hard copy will be sent to you to confirm the information contained in this E-mail.
>
> SPACEBEL denies all liability where E-mail is used for private use.
>
> SPACEBEL cannot be held responsible for possible viruses that might corrupt this message and/or your computer system.
> -------------------------------------------------------------------------------
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From m@nue|@r|be|ro @end|ng |rom tecn|co@u||@bo@@pt  Wed Jan 29 12:25:40 2020
From: m@nue|@r|be|ro @end|ng |rom tecn|co@u||@bo@@pt (Manuel Ribeiro)
Date: Wed, 29 Jan 2020 11:25:40 -0000
Subject: [R-sig-Geo] gstat / Linear model of coregionalization
In-Reply-To: <CALSqE8F9FwforoaP-2_sLW-bc2v_Fa4NQj3j34QmtTMC1EpAPw@mail.gmail.com>
References: <CALSqE8F9FwforoaP-2_sLW-bc2v_Fa4NQj3j34QmtTMC1EpAPw@mail.gmail.com>
Message-ID: <016801d5d696$d672e4b0$8358ae10$@tecnico.ulisboa.pt>

Hello Nick,

 

Once you have your lmc fitted, call the object $psill.

For example, if your lmc object is called g.fit with variables v , z call:

 

g.fit$model$v$psill[1] to get coefficient of v for 1st structure of the nested model.

g.fit$model$z$psill[1] to get coefficient of z for 1st structure of the nested model.

 

g.fit$model$v$psill[2] to get coefficient of v for 2nd structure of the nested model.

g.fit$model$z$psill[2] to get coefficient of z for 2nd structure of the nested model.

 

For cross-variogram, please see the list of g.fit$model to see the name of the object storing v*z cross-variogram model coefficients.

 

I hope this helps. There are other ways of doing this, anyway this one should work.

Regards,

Manuel

 

 

Manuel Lu?s Castro Ribeiro

 

CERENA- Centro de Recursos Naturais e Ambiente


Instituto Superior T?cnico
Av. Rovisco Pais  

1049-001 Lisboa 

Portugal


Phone:  +351 21 841 74 41

Mobile: +351 92 442 80 07

 

Web:  <http://www.cerena.pt/> www.cerena.pt

 

 

 

From: R-sig-Geo <r-sig-geo-bounces at r-project.org> On Behalf Of Nick Hamm
Sent: quarta-feira, 29 de janeiro de 2020 04:22
To: r-sig-geo <r-sig-geo at stat.math.ethz.ch>; r-sig-geo at r-project.org
Subject: [R-sig-Geo] gstat / Linear model of coregionalization

 

Dear all

Is anybody using gstat for computing cross-variograms and fitting cross variogram models?  I have implemented this in a similar manner to the example code given in the gstat vignette (Section 10).

 

I would like to extract the coefficients (i.g., the  b_{ij}^l of the linear model of coregionalization as given in Equation 4.37 of Goovaearts (1997) book (page 110).  

 

\gamma_{ij} (h) = \sum_{l=0}^L b_{ij}^l g_l(h) \forall i, j  

 



 

 

Is this possible?

 

kind regards

 

Nick

 

 


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20200129/7212e7aa/attachment.html>

-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 1807 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20200129/7212e7aa/attachment.png>

From Arn@ud@DeGroo| @end|ng |rom @p@cebe|@be  Wed Jan 29 16:02:15 2020
From: Arn@ud@DeGroo| @end|ng |rom @p@cebe|@be (Arnaud De Groof)
Date: Wed, 29 Jan 2020 15:02:15 +0000
Subject: [R-sig-Geo] Error in the installation of rgdal on the docker
 osgeo/gdal:ubuntu-small
In-Reply-To: <alpine.LFD.2.21.2001291158090.842912@reclus.nhh.no>
References: <1580226405250.15862@spacebel.be>
 <4286e11c4a7147f88bb5578e87de1722@nhh.no>,
 <alpine.LFD.2.21.2001291158090.842912@reclus.nhh.no>
Message-ID: <1580310135762.12234@spacebel.be>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20200129/b2e0e5f5/attachment.html>

From Roger@B|v@nd @end|ng |rom nhh@no  Wed Jan 29 16:06:23 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Wed, 29 Jan 2020 15:06:23 +0000
Subject: [R-sig-Geo] Error in the installation of rgdal on the docker
 osgeo/gdal:ubuntu-small
In-Reply-To: <1580310135762.12234@spacebel.be>
References: <1580226405250.15862@spacebel.be>
 <4286e11c4a7147f88bb5578e87de1722@nhh.no>,
 <alpine.LFD.2.21.2001291158090.842912@reclus.nhh.no>,
 <1580310135762.12234@spacebel.be>
Message-ID: <BY5PR02MB660925B954E122E90DE58F80A3050@BY5PR02MB6609.namprd02.prod.outlook.com>

For sp, install from CRAN, or for the development version, remotes::install_github("rsbivand/sp").

Roger

Roger Bivand
Norwegian School of Economics
Bergen, Norway
________________________________
From: Arnaud De Groof <Arnaud.DeGroof at spacebel.be>
Sent: Wednesday, January 29, 2020 4:02:15 PM
To: r-sig-geo at r-project.org <r-sig-geo at r-project.org>; Roger.Bivand at nhh.no <Roger.Bivand at nhh.no>
Subject: RE: [R-sig-Geo] Error in the installation of rgdal on the docker osgeo/gdal:ubuntu-small


Thanks Roger,

I have modified the Dockerfile aiming to integrate sqlite3, libsqlite3-dev and rgdal from R-Forge:

RUN R -e "install.packages('rgdal', repos='http://R-Forge.R-project.org', configure.args = c('--with-gdal-config=/usr/bin/gdal-config','--with-gdal-share=/usr/share/gdal', '--with-proj-include=/usr/include', '--with-proj-lib=/usr/share/proj', '--with-proj-share=/usr/local/share/proj'))"

Unfortunately, this package have a dependency to 'sp'.

> install.packages('rgdal', repos='http://R-Forge.R-project.org', configure.args = c('--with-gdal-config=/usr/bin/gdal-config','--with-gdal-share=/usr/share/gdal', '--with-proj-include=/usr/include', '--with-proj-lib=/usr/share/proj', '--with-proj-share=/usr/local/share/proj'))
Installing package into '/usr/local/lib/R/site-library'
(as 'lib' is unspecified)
Warning: dependency 'sp' is not available
trying URL 'http://R-Forge.R-project.org/src/contrib/rgdal_1.5-3.tar.gz';
Content type 'application/x-gzip' length 1774321 bytes (1.7 MB)
==================================================
downloaded 1.7 MB

ERROR: dependency 'sp' is not available for package 'rgdal'
* removing '/usr/local/lib/R/site-library/rgdal'

The downloaded source packages are in
        '/tmp/Rtmp0aIlx7/downloaded_packages'
Warning message:
In install.packages("rgdal", repos = "http://R-Forge.R-project.org",  :
  installation of package 'rgdal' had non-zero exit status

So, I added the package 'sp' :

RUN R -e "install.packages('sp', repos='http://R-Forge.R-project.org')";

But this package seems not available for the version of R 3.6.2:

install.packages('sp', repos='http://R-Forge.R-project.org')
Installing package into '/usr/local/lib/R/site-library'
(as 'lib' is unspecified)
Warning message:
package 'sp' is not available (for R version 3.6.2)

Solution : downgrade R?

Thanks,

Arnaud


________________________________________
De : Roger Bivand <Roger.Bivand at nhh.no>
Envoy? : mercredi 29 janvier 2020 12:00
? : Arnaud De Groof; r-sig-geo at r-project.org
Objet : Re: [R-sig-Geo] Error in the installation of rgdal on the docker osgeo/gdal:ubuntu-small

On Tue, 28 Jan 2020, Roger Bivand wrote:

> Thanks for this. The configure script does not check that sqlite is
> available, and should do that. For now, make sqlite available in the
> image (PROJ needs it from PROJ 6). Did you know that you are pulling
> GDAL 3.1.0, which has not been released or checked with R packages (not
> the problem here)? If the problem with the configure failure gets
> resolved, you'll need to install from rgdal from R-Forge, no more patch
> releases for 1.4.*. If you want to experiment with WKT2 CRS, also grab
> sp from my github master.

Please try revision 926 from https://clicktime.symantec.com/3DbwF33HwMJWTWsivoeyZxQ6H2?u=https%3A%2F%2Fr-forge.r-project.org%2FR%2F%3Fgroup_id%3D884
once it refreshes (and if the build succeeds); this includes a
non-failing test for sqlite3. Once you report back, I can also modify it
to hard-fail.

Roger

>
> Roger
>
> --
> Roger Bivand
> Norwegian School of Economics
> Helleveien 30, 5045 Bergen, Norway
> Roger.Bivand at nhh.no
>
>
> ________________________________________
> Fra: R-sig-Geo <r-sig-geo-bounces at r-project.org> p? vegne av Arnaud De Groof <Arnaud.DeGroof at spacebel.be>
> Sendt: tirsdag 28. januar 2020 16.46
> Til: r-sig-geo at r-project.org
> Emne: [R-sig-Geo] Error in the installation of rgdal on the docker osgeo/gdal:ubuntu-small
>
> Hi,
>
>
> I am trying to install the rgdal package on a docker image based on osgeo/gdal:ubuntu-small (latest) but I encounter the following issue:
>
>
>
>> install.packages('rgdal', repos='https://clicktime.symantec.com/3GfSmsMNhbeBczexqVoajwb6H2?u=http%3A%2F%2Fcran.rstudio.com', configure.args = c('--with-gdal-config=/usr/bin/gdal-config','--with-gdal-share=/usr/share/gdal', '--with-proj-include=/usr/include', '--with-proj-lib=/usr/share/proj'))
> Installing package into '/usr/local/lib/R/site-library'
> (as 'lib' is unspecified)
> also installing the dependency 'sp'
>
> trying URL 'https://clicktime.symantec.com/3MN754oA1SfJBHTyzTfokXH6H2?u=http%3A%2F%2Fcran.rstudio.com%2Fsrc%2Fcontrib%2Fsp_1.3-2.tar.gz';
> Content type 'application/x-gzip' length 1132347 bytes (1.1 MB)
> ==================================================
> downloaded 1.1 MB
>
> trying URL 'https://clicktime.symantec.com/3Er9t6ENqj3etwpXLVu7jiT6H2?u=http%3A%2F%2Fcran.rstudio.com%2Fsrc%2Fcontrib%2Frgdal_1.4-8.tar.gz';
> Content type 'application/x-gzip' length 1698902 bytes (1.6 MB)
> ==================================================
> downloaded 1.6 MB
>
> * installing *source* package 'sp' ...
> ** package 'sp' successfully unpacked and MD5 sums checked
> ** using staged installation
> ** libs
> gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG     -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c Rcentroid.c -o Rcentroid.o
> gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG     -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c gcdist.c -o gcdist.o
> gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG     -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c init.c -o init.o
> gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG     -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c pip.c -o pip.o
> gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG     -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c pip2.c -o pip2.o
> gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG     -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c sp_xports.c -o sp_xports.o
> gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG     -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c surfaceArea.c -o surfaceArea.o
> gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG     -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c zerodist.c -o zerodist.o
> gcc -std=gnu99 -shared -L/usr/lib/R/lib -Wl,-Bsymbolic-functions -Wl,-z,relro -o sp.so Rcentroid.o gcdist.o init.o pip.o pip2.o sp_xports.o surfaceArea.o zerodist.o -L/usr/lib/R/lib -lR
> installing to /usr/local/lib/R/site-library/00LOCK-sp/00new/sp/libs
> ** R
> ** data
> ** demo
> ** inst
> ** byte-compile and prepare package for lazy loading
> ** help
> *** installing help indices
> ** building package indices
> ** installing vignettes
> ** testing if installed package can be loaded from temporary location
> ** checking absolute paths in shared objects and dynamic libraries
> ** testing if installed package can be loaded from final location
> ** testing if installed package keeps a record of temporary installation path
> * DONE (sp)
> * installing *source* package 'rgdal' ...
> ** package 'rgdal' successfully unpacked and MD5 sums checked
> ** using staged installation
> configure: R_HOME: /usr/lib/R
> configure: CC: gcc -std=gnu99
> configure: CXX: g++ -std=gnu++11
> configure: C++11 support available
> configure: rgdal: 1.4-7
> checking for /usr/bin/svnversion... no
> configure: svn revision: 845
> checking for gdal-config... /usr/bin/gdal-config
> checking gdal-config usability... yes
> configure: GDAL: 3.1.0
> checking GDAL version >= 1.11.4... yes
> checking GDAL version <= 2.5 or >= 3.0... yes
> checking gdal: linking with --libs only... yes
> checking GDAL: gdal-config data directory readable... yes
> checking GDAL: /usr/share/gdal/pcs.csv readable... no
> configure: pkg-config proj exists, will use it
> configure: PROJ version: 6.3.0
> configure: Support for PROJ >= 6.0.0 not yet available, deprecated API defined
> configure: proj CPP flags: -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H -I/usr/local/include
> configure: PROJ LIBS: -L/usr/local/lib -lproj
> checking PROJ header API:... proj_api.h
> checking proj_api.h presence and usability... yes
> checking PROJ version agreement... yes
> checking PROJ version >= 4.8.0... yes
> /usr/bin/ld: cannot find -lsqlite3
> collect2: error: ld returned 1 exit status
> ./configure: line 2437: ./proj_conf_test2: No such file or directory
> checking PROJ: proj.db found and readable... yes
> configure: Package CPP flags:  -I/usr/include -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H
> configure: Package LIBS:  -L/usr/lib -lgdal -L/usr/local/lib -lproj
> configure: creating ./config.status
> config.status: creating src/Makevars
> ** libs
> g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H -I"/usr/local/lib/R/site-library/sp/include"   -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c OGR_write.cpp -o OGR_write.o
> g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H -I"/usr/local/lib/R/site-library/sp/include"   -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c gdal-bindings.cpp -o gdal-bindings.o
> gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG -I/usr/include -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H -I"/usr/local/lib/R/site-library/sp/include"   -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c init.c -o init.o
> gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG -I/usr/include -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H -I"/usr/local/lib/R/site-library/sp/include"   -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c inverser.c -o inverser.o
> gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG -I/usr/include -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H -I"/usr/local/lib/R/site-library/sp/include"   -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c local_stubs.c -o local_stubs.o
> g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H -I"/usr/local/lib/R/site-library/sp/include"   -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c ogr_geom.cpp -o ogr_geom.o
> gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG -I/usr/include -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H -I"/usr/local/lib/R/site-library/sp/include"   -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c ogr_polygons.c -o ogr_polygons.o
> g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H -I"/usr/local/lib/R/site-library/sp/include"   -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c ogr_proj.cpp -o ogr_proj.o
> g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H -I"/usr/local/lib/R/site-library/sp/include"   -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c ogrdrivers.cpp -o ogrdrivers.o
> g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H -I"/usr/local/lib/R/site-library/sp/include"   -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c ogrsource.cpp -o ogrsource.o
> g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H -I"/usr/local/lib/R/site-library/sp/include"   -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c proj_info6.cpp -o proj_info6.o
> g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H -I"/usr/local/lib/R/site-library/sp/include"   -fpic  -g -O2 -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=. -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c projectit.cpp -o projectit.o
> g++ -std=gnu++11 -shared -L/usr/lib/R/lib -Wl,-Bsymbolic-functions -Wl,-z,relro -o rgdal.so OGR_write.o gdal-bindings.o init.o inverser.o local_stubs.o ogr_geom.o ogr_polygons.o ogr_proj.o ogrdrivers.o ogrsource.o proj_info6.o projectit.o -L/usr/lib -lgdal -L/usr/local/lib -lproj -L/usr/lib/R/lib -lR
> installing to /usr/local/lib/R/site-library/00LOCK-rgdal/00new/rgdal/libs
> ** R
> ** data
> ** inst
> ** byte-compile and prepare package for lazy loading
> ** help
> *** installing help indices
> ** building package indices
> ** installing vignettes
> ** testing if installed package can be loaded from temporary location
> Error: package or namespace load failed for 'rgdal' in dyn.load(file, DLLpath = DLLpath, ...):
> unable to load shared object '/usr/local/lib/R/site-library/00LOCK-rgdal/00new/rgdal/libs/rgdal.so':
>  /usr/local/lib/R/site-library/00LOCK-rgdal/00new/rgdal/libs/rgdal.so: undefined symbol: proj_list_operations
> Error: loading failed
> Execution halted
> ERROR: loading failed
> * removing '/usr/local/lib/R/site-library/rgdal'
>
> The downloaded source packages are in
>        '/tmp/RtmpeD6Lq2/downloaded_packages'
> Warning message:
> In install.packages("rgdal", repos = "https://clicktime.symantec.com/3GfSmsMNhbeBczexqVoajwb6H2?u=http%3A%2F%2Fcran.rstudio.com",  :
>  installation of package 'rgdal' had non-zero exit status
>
>
>
> Here the dockerfile:
>
>
> FROM osgeo/gdal:ubuntu-small-latest
>
> ENV DEBIAN_FRONTEND=noninteractive
>
> #######################
> ### Install
> RUN apt-get update && apt-get install -y\
> zip\
> bc\
> curl\
> lsb-release\
> libfreetype6\
> #r-base\
> default-jre\
> pkg-config\
> wget\
> git\
> libproj-dev\
> proj-data\
> proj-bin\
> libcurl4-openssl-dev\
> python-pip && \
> pip install pip==9.0.1 && \
> pip install\
> numpy==1.14.1 \
> Jinja2 \
> geojson \
> requests \
> rasterstats \
> pandas \
> pyshp \
> Pillow \
> scipy
>
> RUN apt install -y apt-transport-https software-properties-common
> RUN gpg --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys E298A3A825C0D65DFD57CBB651716619E084DAB9
> RUN gpg -a --export E298A3A825C0D65DFD57CBB651716619E084DAB9 | apt-key add -
> RUN add-apt-repository 'deb https://clicktime.symantec.com/3Ka35BLL2A238jXqRigSBNG6H2?u=https%3A%2F%2Fcloud.r-project.org%2Fbin%2Flinux%2Fubuntu bionic-cran35/' && \
>    apt-get update
>
> RUN apt install -y r-base r-base-core r-recommended
>
> RUN R --version
>
> ENV GDAL_DATA /usr/share/gdal/
> ENV PROJ_LIB /usr/share/proj/
>
> RUN R -e "install.packages('rgdal', repos='https://clicktime.symantec.com/3GfSmsMNhbeBczexqVoajwb6H2?u=http%3A%2F%2Fcran.rstudio.com', configure.args = c('--with-gdal-config=/usr/bin/gdal-config','--with-gdal-share=/usr/share/gdal', '--with-proj-include=/usr/include', '--with-proj-lib=/usr/share/proj'))"
>
>
> Thanks,
>
> Arnaud
>
>
> ------------------------------------------------------------------------------
>
> E-MAIL DISCLAIMER
>
> The present message may contain confidential and/or legally privileged information. If you are not the intended addressee and in case of a transmission error, please notify the sender immediately and destroy this E-mail. Disclosure, reproduction or distribution of this document and its possible attachments is strictly forbidden.
>
> SPACEBEL denies all liability for incomplete, improper, inaccurate, intercepted, (partly) destroyed, lost and/or belated transmission of the current information given that unencrypted electronic transmission cannot currently be guaranteed to be secure or error free.
> Upon request or in conformity with formal, contractual agreements, an originally signed hard copy will be sent to you to confirm the information contained in this E-mail.
>
> SPACEBEL denies all liability where E-mail is used for private use.
>
> SPACEBEL cannot be held responsible for possible viruses that might corrupt this message and/or your computer system.
> -------------------------------------------------------------------------------
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://clicktime.symantec.com/3EKFV2BJNqorZxbnuyiWfU6H2?u=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-geo
>

--
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://clicktime.symantec.com/3ZX1xpwrVfpy8rFktz4yCp6H2?u=https%3A%2F%2Forcid.org%2F0000-0003-2392-6140
https://clicktime.symantec.com/3B7fRQK9gSRQ3cKDJfFaY646H2?u=https%3A%2F%2Fscholar.google.no%2Fcitations%3Fuser%3DAWeghB0AAAAJ%26hl%3Den

------------------------------------------------------------------------------

E-MAIL DISCLAIMER

The present message may contain confidential and/or legally privileged information. If you are not the intended addressee and in case of a transmission error, please notify the sender immediately and destroy this E-mail. Disclosure, reproduction or distribution of this document and its possible attachments is strictly forbidden.

SPACEBEL denies all liability for incomplete, improper, inaccurate, intercepted, (partly) destroyed, lost and/or belated transmission of the current information given that unencrypted electronic transmission cannot currently be guaranteed to be secure or error free.
Upon request or in conformity with formal, contractual agreements, an originally signed hard copy will be sent to you to confirm the information contained in this E-mail.

SPACEBEL denies all liability where E-mail is used for private use.

SPACEBEL cannot be held responsible for possible viruses that might corrupt this message and/or your computer system.
-------------------------------------------------------------------------------

	[[alternative HTML version deleted]]


From Arn@ud@DeGroo| @end|ng |rom @p@cebe|@be  Wed Jan 29 17:11:11 2020
From: Arn@ud@DeGroo| @end|ng |rom @p@cebe|@be (Arnaud De Groof)
Date: Wed, 29 Jan 2020 16:11:11 +0000
Subject: [R-sig-Geo] Error in the installation of rgdal on the docker
 osgeo/gdal:ubuntu-small
In-Reply-To: <1580313507869.77207@spacebel.be>
References: <1580226405250.15862@spacebel.be>
 <4286e11c4a7147f88bb5578e87de1722@nhh.no>,
 <alpine.LFD.2.21.2001291158090.842912@reclus.nhh.no>,
 <1580310135762.12234@spacebel.be>,
 <BY5PR02MB660925B954E122E90DE58F80A3050@BY5PR02MB6609.namprd02.prod.outlook.com>,
 <1580313507869.77207@spacebel.be>
Message-ID: <1580314271946.34812@spacebel.be>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20200129/75f2bee5/attachment.html>

From Roger@B|v@nd @end|ng |rom nhh@no  Wed Jan 29 17:35:11 2020
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Wed, 29 Jan 2020 17:35:11 +0100
Subject: [R-sig-Geo] Error in the installation of rgdal on the docker
 osgeo/gdal:ubuntu-small
In-Reply-To: <1580314271946.34812@spacebel.be>
References: <1580226405250.15862@spacebel.be>
 <4286e11c4a7147f88bb5578e87de1722@nhh.no>,
 <alpine.LFD.2.21.2001291158090.842912@reclus.nhh.no>,
 <1580310135762.12234@spacebel.be>,
 <BY5PR02MB660925B954E122E90DE58F80A3050@BY5PR02MB6609.namprd02.prod.outlook.com>,
 <1580313507869.77207@spacebel.be> <1580314271946.34812@spacebel.be>
Message-ID: <alpine.LFD.2.21.2001291712230.855447@reclus.nhh.no>

Please post plain text only.

I am not going to waste time installing the docker image on a desktop 
machine in my office when I'm not there. You can easily check out the SVN 
source of the package, debug your system, and contribute your patch back.

You have not motivated your need to install in this way, nor have I seen 
any contributions to the development marathon of adapting sp/rgdal or sf 
to PROJ6/GDAL3: 
https://www.youtube.com/watch?v=Rgn4Ns2UgAg&list=PLXUoTpMa_9s10NVk4dBQljNOaOXAOhcE0&index=4&t=0s

Your implicit affiliation is with a company, you can helpfully debug this 
and contribute back - you do not seem to be reading around this problem, 
but push it back to me as maintainer regardless. It is your problem on 
your odddish configuration. I look forward to receiving patches for the 
SVN repo.

If you think that:

'--with-proj-lib=/usr/local/share/proj'

looks odd (it does, '--with-proj-lib=/usr/local/lib' is much more likely, 
and if you register proj.pc with pkg-config, you  don't need to use those 
configure arguments), you are the best person to try alternatives.

Further, the error message now looks like multiple installed versions of 
the proj shared object: https://github.com/r-spatial/sf/issues/844.

For an alternative docker image, see 
https://github.com/r-spatial/discuss/issues/28#issuecomment-551241421 - 
correct GDAL and PROJ versions to current.

On Wed, 29 Jan 2020, Arnaud De Groof wrote:

> 
> 
> ?There is alway an error with the installation of rgdal. Is it linked to an
> issue in the definition of the arguments
> ('with-proj-lib','with-proj-share',..)?
> 
> ??install.packages('rgdal', repos='http://R-Forge.R-project.org',
> configure.args = c('--with-gdal-config=/usr/bin/gdal-config',
> '--with-proj-include=/usr/local/include',
> '--with-proj-lib=/usr/local/share/proj',
> '--with-proj-share=/usr/local/share/proj'))
> Installing package into '/usr/local/lib/R/site-library'
> (as 'lib' is unspecified)
> trying URL 'http://R-Forge.R-project.org/src/contrib/rgdal_1.5-3.tar.gz'
> Content type 'application/x-gzip' length 1774321 bytes (1.7 MB)
> ==================================================
> downloaded 1.7 MB
> 
> * installing *source* package 'rgdal' ...
> ** using staged installation
> configure: R_HOME: /usr/lib/R
> configure: CC: gcc -std=gnu99
> configure: CXX: g++ -std=gnu++11
> configure: C++11 support available
> configure: rgdal: 1.5-3
> checking for /usr/bin/svnversion... no
> cat: inst/SVN_VERSION: No such file or directory
> configure: svn revision:?
> configure: gdal-config set to /usr/bin/gdal-config
> checking gdal-config exists... yes
> checking gdal-config executable... yes
> checking gdal-config usability... yes
> configure: GDAL: 3.1.0
> checking GDAL version >= 1.11.4... yes
> checking GDAL version <= 2.5 or >= 3.0... yes
> checking gdal: linking with --libs only... yes
> checking GDAL: gdal-config data directory readable... yes
> checking GDAL: /usr/share/gdal/stateplane.csv readable... yes
> configure: pkg-config proj exists, will use it
> configure: PROJ version: 6.3.0
> configure: Support for PROJ >= 6.0.0 not yet available, deprecated API
> defined
> configure: proj CPP flags: -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H
> -I/usr/local/include?
> configure: PROJ LIBS: -L/usr/local/share/proj?
> checking PROJ header API:... proj_api.h
> checking proj_api.h presence and usability... yes
> checking PROJ version agreement... yes
> checking Using GDAL < 3 with PROJ >= 6... no
> checking PROJ version >= 4.8.0... yes
> configure: PROJ_LIB: /usr/local/share/proj
> checking for gcc... gcc -std=gnu99
> checking whether the C compiler works... yes
> checking for C compiler default output file name... a.out
> checking for suffix of executables...?
> checking whether we are cross compiling... no
> checking for suffix of object files... o
> checking whether we are using the GNU C compiler... yes
> checking whether gcc -std=gnu99 accepts -g... yes
> checking for gcc -std=gnu99 option to accept ISO C89... none needed
> checking how to run the C preprocessor... gcc -std=gnu99 -E
> checking for grep that handles long lines and -e... /bin/grep
> checking for egrep... /bin/grep -E
> checking for ANSI C header files... yes
> checking for sys/types.h... yes
> checking for sys/stat.h... yes
> checking for stdlib.h... yes
> checking for string.h... yes
> checking for memory.h... yes
> checking for strings.h... yes
> checking for inttypes.h... yes
> checking for stdint.h... yes
> checking for unistd.h... yes
> checking sqlite3.h usability... yes
> checking sqlite3.h presence... yes
> checking for sqlite3.h... yes
> checking for sqlite3_libversion in -lsqlite3... yes
> checking PROJ: proj.db found and readable... yes
> configure: Package CPP flags:? -I/usr/include -I/usr/local/include
> -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H
> configure: Package LIBS:? -L/usr/lib -lgdal -L/usr/local/share/proj -lproj
> -lsqlite3
> configure: creating ./config.status
> config.status: creating src/Makevars
> ** libs
> g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include
> -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H
> -I"/usr/local/lib/R/site-library/sp/include"? ?-fpic? -g -O2
> -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=.
> -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time
> -D_FORTIFY_SOURCE=2 -g? -c OGR_write.cpp -o OGR_write.o
> g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include
> -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H
> -I"/usr/local/lib/R/site-library/sp/include"? ?-fpic? -g -O2
> -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=.
> -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time
> -D_FORTIFY_SOURCE=2 -g? -c gdal-bindings.cpp -o gdal-bindings.o
> gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG -I/usr/include
> -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H
> -I"/usr/local/lib/R/site-library/sp/include"? ?-fpic? -g -O2
> -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=.
> -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time
> -D_FORTIFY_SOURCE=2 -g? -c init.c -o init.o
> gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG -I/usr/include
> -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H
> -I"/usr/local/lib/R/site-library/sp/include"? ?-fpic? -g -O2
> -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=.
> -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time
> -D_FORTIFY_SOURCE=2 -g? -c inverser.c -o inverser.o
> gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG -I/usr/include
> -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H
> -I"/usr/local/lib/R/site-library/sp/include"? ?-fpic? -g -O2
> -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=.
> -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time
> -D_FORTIFY_SOURCE=2 -g? -c local_stubs.c -o local_stubs.o
> g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include
> -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H
> -I"/usr/local/lib/R/site-library/sp/include"? ?-fpic? -g -O2
> -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=.
> -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time
> -D_FORTIFY_SOURCE=2 -g? -c ogr_geom.cpp -o ogr_geom.o
> gcc -std=gnu99 -I"/usr/share/R/include" -DNDEBUG -I/usr/include
> -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H
> -I"/usr/local/lib/R/site-library/sp/include"? ?-fpic? -g -O2
> -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=.
> -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time
> -D_FORTIFY_SOURCE=2 -g? -c ogr_polygons.c -o ogr_polygons.o
> g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include
> -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H
> -I"/usr/local/lib/R/site-library/sp/include"? ?-fpic? -g -O2
> -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=.
> -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time
> -D_FORTIFY_SOURCE=2 -g? -c ogr_proj.cpp -o ogr_proj.o
> g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include
> -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H
> -I"/usr/local/lib/R/site-library/sp/include"? ?-fpic? -g -O2
> -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=.
> -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time
> -D_FORTIFY_SOURCE=2 -g? -c ogrdrivers.cpp -o ogrdrivers.o
> g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include
> -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H
> -I"/usr/local/lib/R/site-library/sp/include"? ?-fpic? -g -O2
> -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=.
> -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time
> -D_FORTIFY_SOURCE=2 -g? -c ogrsource.cpp -o ogrsource.o
> g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include
> -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H
> -I"/usr/local/lib/R/site-library/sp/include"? ?-fpic? -g -O2
> -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=.
> -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time
> -D_FORTIFY_SOURCE=2 -g? -c proj_info6.cpp -o proj_info6.o
> g++ -std=gnu++11 -I"/usr/share/R/include" -DNDEBUG -I/usr/include
> -I/usr/local/include -DACCEPT_USE_OF_DEPRECATED_PROJ_API_H
> -I"/usr/local/lib/R/site-library/sp/include"? ?-fpic? -g -O2
> -fdebug-prefix-map=/build/r-base-t3diwe/r-base-3.6.2=.
> -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time
> -D_FORTIFY_SOURCE=2 -g? -c projectit.cpp -o projectit.o
> g++ -std=gnu++11 -shared -L/usr/lib/R/lib -Wl,-Bsymbolic-functions
> -Wl,-z,relro -o rgdal.so OGR_write.o gdal-bindings.o init.o inverser.o
> local_stubs.o ogr_geom.o ogr_polygons.o ogr_proj.o ogrdrivers.o ogrsource.o
> proj_info6.o projectit.o -L/usr/lib -lgdal -L/usr/local/share/proj -lproj
> -lsqlite3 -L/usr/lib/R/lib -lR
> installing to /usr/local/lib/R/site-library/00LOCK-rgdal/00new/rgdal/libs
> ** R
> ** data
> ** inst
> ** byte-compile and prepare package for lazy loading
> ** help
> *** installing help indices
> ** building package indices
> ** installing vignettes
> ** testing if installed package can be loaded from temporary location
> Error: package or namespace load failed for 'rgdal' in dyn.load(file,
> DLLpath = DLLpath, ...):
> ?unable to load shared object
> '/usr/local/lib/R/site-library/00LOCK-rgdal/00new/rgdal/libs/rgdal.so':
> ? /usr/local/lib/R/site-library/00LOCK-rgdal/00new/rgdal/libs/rgdal.so:
> undefined symbol: proj_create
> Error: loading failed
> Execution halted
> ERROR: loading failed
> * removing '/usr/local/lib/R/site-library/rgdal'
> >?
> >?
> 
> The downloaded source packages are in
> ? ? ? ? '/tmp/Rtmpvt7qpB/downloaded_packages'
> Warning message:
> In install.packages("rgdal", repos = "http://R-Forge.R-project.org",? :
> ? installation of package 'rgdal' had non-zero exit status
> 
> 
> 
> 
> ____________________________________________________________________________
> De : Roger Bivand <Roger.Bivand at nhh.no>
> Envoy? : mercredi 29 janvier 2020 16:06
> ? : r-sig-geo at r-project.org; Arnaud De Groof
> Objet : Re: [R-sig-Geo] Error in the installation of rgdal on the docker
> osgeo/gdal:ubuntu-small ?
> For sp, install from CRAN, or for the development version,
> remotes::install_github("rsbivand/sp").
> 
> Roger
> 
> Roger Bivand
> Norwegian School of Economics
> Bergen, Norway
> 
> ____________________________________________________________________________
> From: Arnaud De Groof <Arnaud.DeGroof at spacebel.be>
> Sent: Wednesday, January 29, 2020 4:02:15 PM
> To: r-sig-geo at r-project.org <r-sig-geo at r-project.org>; Roger.Bivand at nhh.no
> <Roger.Bivand at nhh.no>
> Subject: RE: [R-sig-Geo] Error in the installation of rgdal on the docker
> osgeo/gdal:ubuntu-small ?
> 
> Thanks Roger,
> 
> I have modified the Dockerfile aiming?to integrate sqlite3, libsqlite3-dev
> and rgdal from R-Forge:
> 
> RUN R -e "install.packages('rgdal', repos='http://R-Forge.R-project.org',
> configure.args =c('--with-gdal-config=/usr/bin/gdal-config','--with-gdal-share=/usr/share/g
> dal', '--with-proj-include=/usr/include',
> '--with-proj-lib=/usr/share/proj',
> '--with-proj-share=/usr/local/share/proj'))"
> 
> Unfortunately, this package have a dependency to 'sp'.
> 
> > install.packages('rgdal', repos='http://R-Forge.R-project.org',
> configure.args =c('--with-gdal-config=/usr/bin/gdal-config','--with-gdal-share=/usr/share/g
> dal', '--with-proj-include=/usr/include',
> '--with-proj-lib=/usr/share/proj',
> '--with-proj-share=/usr/local/share/proj'))
> Installing package into '/usr/local/lib/R/site-library'
> (as 'lib' is unspecified)
> Warning: dependency 'sp' is not available
> trying URL 'http://R-Forge.R-project.org/src/contrib/rgdal_1.5-3.tar.gz';
> Content type 'application/x-gzip' length 1774321 bytes (1.7 MB)
> ==================================================
> downloaded 1.7 MB
> 
> ERROR: dependency 'sp' is not available for package 'rgdal'
> * removing '/usr/local/lib/R/site-library/rgdal'
> 
> The downloaded source packages are in
> ??????? '/tmp/Rtmp0aIlx7/downloaded_packages'
> Warning message:
> In install.packages("rgdal", repos = "http://R-Forge.R-project.org",? :
> ? installation of package 'rgdal' had non-zero exit status
> 
> So, I added the package 'sp' :
> 
> RUN R -e "install.packages('sp', repos='http://R-Forge.R-project.org')";
> 
> But this package seems not available for the version of R 3.6.2:
> 
> install.packages('sp', repos='http://R-Forge.R-project.org')
> Installing package into '/usr/local/lib/R/site-library'
> (as 'lib' is unspecified)
> Warning message:
> package 'sp' is not available (for R version 3.6.2)?
> Solution : downgrade R?
> 
> Thanks,
> 
> Arnaud
> 
> 
> ---------------------------------------------------------------------------
> ---
> 
> E-MAIL DISCLAIMER
> 
> The present message may contain confidential and/or legally privileged
> information. If you are not the intended addressee and in case of a
> transmission error, please notify the sender immediately and destroy this
> E-mail. Disclosure, reproduction or distribution of this document and its
> possible attachments is strictly forbidden.
> 
> SPACEBEL denies all liability for incomplete, improper, inaccurate,
> intercepted, (partly) destroyed, lost and/or belated transmission of the
> current information given that unencrypted electronic transmission cannot
> currently be guaranteed to be secure or error free.
> Upon request or in conformity with formal, contractual agreements, an
> originally signed hard copy will be sent to you to confirm the information
> contained in this E-mail.
> 
> SPACEBEL denies all liability where E-mail is used for private use.
> 
> SPACEBEL cannot be held responsible for possible viruses that might corrupt
> this message and/or your computer system.
> ---------------------------------------------------------------------------
> ----
> 
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

