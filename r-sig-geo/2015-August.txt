From Drew.Mueller at colostate.edu  Sat Aug  1 09:26:43 2015
From: Drew.Mueller at colostate.edu (Mueller,Drew)
Date: Sat, 1 Aug 2015 07:26:43 +0000
Subject: [R-sig-Geo] Discrete choice spatial durbin or spatial general model
Message-ID: <742E2B6B-7940-4840-B934-461940CF01F1@colostate.edu>

I would like to know if it is possible to estimate either the spatial durbin or general spatial model within spdep or sphet (or another package) for discrete choice dependent variables.  I have attempted to pass

family = binomial(link = "probit") 

to spdep, hoping that spdep uses the glm()function and accepts "..." arguments, but get an "unused argument" error.  If it is not possible in spdep, is there another package that is able to estimate a model with both autocorrelation and heteroskedasticity for binomial or multinomial discrete responses?  I have successfully estimated the SAR and SEM using packages McSpatial and spatialprobit, but wanted to know if it is currently possible to estimate a model that includes both types of spatial effects for discrete responses.   I suspect that both spatial effects are present in my transportation mode-built environment model.

Thanks for your help,
Drew

From erich.subs at neuwirth.priv.at  Sat Aug  1 09:42:14 2015
From: erich.subs at neuwirth.priv.at (Erich Subscriptions)
Date: Sat, 1 Aug 2015 09:42:14 +0200
Subject: [R-sig-Geo] leaflet problem
Message-ID: <90B51B03-550E-40C4-9B61-48B5BA332792@neuwirth.priv.at>


I am creating clickable maps with leaflet and experiencing a problem.

The documentation seems not to indicate how to specify an urlTemplate for multiple urls
I want to use
http://maps{s}.wien.gv.at/basemap/bmapgrau/normal/google3857/{z}/{y}/{x}.png <http://maps{s}.wien.gv.at/basemap/bmapgrau/normal/google3857/{z}/{y}/{x}.png>
with the possible values for {s}
'','1','2','3','4'

How do I specify this?
	[[alternative HTML version deleted]]


From Roger.Bivand at nhh.no  Sat Aug  1 09:56:58 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 1 Aug 2015 09:56:58 +0200
Subject: [R-sig-Geo] Discrete choice spatial durbin or spatial general
 model
In-Reply-To: <742E2B6B-7940-4840-B934-461940CF01F1@colostate.edu>
References: <742E2B6B-7940-4840-B934-461940CF01F1@colostate.edu>
Message-ID: <alpine.LFD.2.20.1508010946550.7130@reclus.nhh.no>

On Sat, 1 Aug 2015, Mueller,Drew wrote:

> I would like to know if it is possible to estimate either the spatial 
> durbin or general spatial model within spdep or sphet (or another 
> package) for discrete choice dependent variables.  I have attempted to 
> pass
>
> family = binomial(link = "probit")
>
> to spdep, hoping that spdep uses the glm()function and accepts "..." 
> arguments, but get an "unused argument" error.

Since there is nothing in the documentation or code to suggest anything of 
the sort, "hope" is wildly speculative and without foundation. The 
literature on spatial probit estimation has been reviewed in two recent 
articles - have you read them? One is:

http://journal.r-project.org/archive/2013-1/wilhelm-matos.pdf

another in Journal of Regional Science.

> If it is not possible in 
> spdep, is there another package that is able to estimate a model with 
> both autocorrelation and heteroskedasticity for binomial or multinomial 
> discrete responses?  I have successfully estimated the SAR and SEM using 
> packages McSpatial and spatialprobit, but wanted to know if it is 
> currently possible to estimate a model that includes both types of 
> spatial effects for discrete responses.  I suspect that both spatial 
> effects are present in my transportation mode-built environment model.

Multinomial response is not available anyhere AFAIK. McSpatial and 
spatialprobit are feasible for single parameter models, as is the use of 
the slm latent model in INLA. Durbin models are not a problem, as the WX 
can be created using create_WX() in spdep. Double parameter models are 
problematic everywhere, even though they are occasionally used, as the 
significance of a second spatial parameter (error and lag) usually 
indicates problems with entitation. This is when the spatial footprints of 
the processes for the variables differ from the units of observation.

Hope this helps,

Roger

>
> Thanks for your help,
> Drew
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From bob at rudis.net  Sat Aug  1 14:35:47 2015
From: bob at rudis.net (boB Rudis)
Date: Sat, 1 Aug 2015 08:35:47 -0400
Subject: [R-sig-Geo] leaflet problem
In-Reply-To: <90B51B03-550E-40C4-9B61-48B5BA332792@neuwirth.priv.at>
References: <90B51B03-550E-40C4-9B61-48B5BA332792@neuwirth.priv.at>
Message-ID: <CAJ4QxaPNvZcZ9oyxaf+3wNvTKsmu3GUE581jRD-L9N=DDjRJrA@mail.gmail.com>

The documentation for addTiles has this:

    addTiles(map,
             urlTemplate = "http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",
             attribution = NULL,
             layerId = NULL,
             group = NULL,
             options = tileOptions())

By default, when one does:

    wien <- "http://maps{s}.wien.gv.at/basemap/bmapgrau/normal/google3857/{z}/{y}/{x}.png"
    leaflet() %>% addTiles(wien)

the underlying leaflet code is issuing calls for tiles like this:

    http://mapsa.wien.gv.at/basemap/bmapgrau/normal/google3857/1/0/0.png

(so, "mapsa" vs "maps1", "mapsb" vs "maps2", etc).

You can specify a different format for the subdomains, but when I do:

    leaflet() %>% addTiles(wien, options=tileOptions(subdomains="1234"))

leaflet does use the numerical subdomain option (i.e. i see calls for
URLs like this):

    http://maps1.wien.gv.at/basemap/bmapgrau/normal/google3857/1/0/0.png

but I get 404's for those tiles (I may not be authorized though).

-Bob


On Sat, Aug 1, 2015 at 3:42 AM, Erich Subscriptions
<erich.subs at neuwirth.priv.at> wrote:
>
> I am creating clickable maps with leaflet and experiencing a problem.
>
> The documentation seems not to indicate how to specify an urlTemplate for multiple urls
> I want to use
> http://maps{s}.wien.gv.at/basemap/bmapgrau/normal/google3857/{z}/{y}/{x}.png <http://maps{s}.wien.gv.at/basemap/bmapgrau/normal/google3857/{z}/{y}/{x}.png>
> with the possible values for {s}
> '','1','2','3','4'
>
> How do I specify this?
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Roger.Bivand at nhh.no  Sun Aug  2 21:13:21 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sun, 2 Aug 2015 21:13:21 +0200
Subject: [R-sig-Geo] Link to [MetaCRS] Common SQLite-based dictionaries for
	SRS
Message-ID: <alpine.LFD.2.20.1508022055560.17417@reclus.nhh.no>

A heads up with regard to a discussion taking place on some lists, started 
on the low-volume MetaCRS list, and reposted elsewhere by Even Roualt:

http://lists.maptools.org/pipermail/proj/2015-August/007196.html

It strikes me that the response by Huw James is very well founded, and 
that the data model for a future common dictionary for coordinate 
reference systems should permit the optional use of historical CRS. This 
is an enduring problem with EPSG codes, which can change with each 
release, so making reproducible research harder (especially as the EPSG 
CSV files in PROJ.4 and GDAL, and versions in the GeoTiff software, do not 
report their versions). I would invite ideas now, to assist in guiding 
MetaCRS towards a robust and time-aware dictionary structure with self 
declaring versioning.

There is a further question of the proposed use of SQLite as the backend, 
as R does not have built-in DB drivers, but has an RSQLite package on 
which future CRS handling might have to depend

Roger

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From pierluigi.derosa at gmail.com  Mon Aug  3 09:41:11 2015
From: pierluigi.derosa at gmail.com (pierluigi de rosa)
Date: Mon, 3 Aug 2015 09:41:11 +0200
Subject: [R-sig-Geo] spplot grid data - scale colours customizing
Message-ID: <CAAgsrZgy2b_GPVNoGFBZvP3McoYDZxDGveaviUYkOL1JWHQNLw@mail.gmail.com>

Dear All,

I'm trying to understand how spplot work with colour managing with gridded
data.

I have na Object of class SpatialGridDataFrame
Coordinates:
      min     max
x 2267600 2325600
y 4693800 4826200
Is projected: TRUE
proj4string :

with 12 data for column attribute

I'm able to plot the SpatialGridDataFrame with:

spplot(fogli_Sup_Pioggia,as.table=TRUE, col.regions = cm.colors(100) ,
key.space = "right")

but I want to select where change in colour appears and not leave spplot to
do it by it self.
I tried passing cuts option in this way:

spplot(fogli_Sup_Pioggia,as.table=TRUE, col.regions = cm.colors(100) ,
cuts=c(1,2.5,3),key.space = "right")

It seems working but now the colour is not graduated any more but.
How can I have a graduated palette again?
Thanks

-- 
Ing. Pierluigi De Rosa (PhD)
cel: 3497558268 / fax: 075 7823038
skype: pierluigi.derosa

	[[alternative HTML version deleted]]


From holtermann at hwwi.org  Mon Aug  3 11:29:14 2015
From: holtermann at hwwi.org (Linus Holtermann)
Date: Mon, 3 Aug 2015 09:29:14 +0000
Subject: [R-sig-Geo] Discrete choice spatial durbin or spatial general
	model
In-Reply-To: <742E2B6B-7940-4840-B934-461940CF01F1@colostate.edu>
References: <742E2B6B-7940-4840-B934-461940CF01F1@colostate.edu>
Message-ID: <79c115f2585147e5b8390586bca709e6@winhexbeeu15.win.mail>

Hi,

the package "spatial probit" should be a quite good solution for your problem. It uses Bayesian Inference (MCMC) for SAR and SEM Probit models. The technical details are described in LeSage/Pace (2009) in chapter 10.


Linus Holtermann
Hamburgisches WeltWirtschaftsInstitut gemeinn?tzige GmbH (HWWI)
Heimhuder Stra?e 71
20148 Hamburg
Tel +49-(0)40-340576-336
Fax+49-(0)40-340576-776
Internet: www.hwwi.org
Email: holtermann at hwwi.org
?
Amtsgericht Hamburg HRB 94303
Gesch?ftsf?hrer: Prof. Dr. Henning V?pel
Prokura: Dipl. Kauffrau Alexis Malchin
Umsatzsteuer-ID: DE 241849425

-----Urspr?ngliche Nachricht-----
Von: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] Im Auftrag von Mueller,Drew
Gesendet: Samstag, 1. August 2015 09:27
An: r-sig-geo at r-project.org
Betreff: [R-sig-Geo] Discrete choice spatial durbin or spatial general model

I would like to know if it is possible to estimate either the spatial durbin or general spatial model within spdep or sphet (or another package) for discrete choice dependent variables.  I have attempted to pass

family = binomial(link = "probit") 

to spdep, hoping that spdep uses the glm()function and accepts "..." arguments, but get an "unused argument" error.  If it is not possible in spdep, is there another package that is able to estimate a model with both autocorrelation and heteroskedasticity for binomial or multinomial discrete responses?  I have successfully estimated the SAR and SEM using packages McSpatial and spatialprobit, but wanted to know if it is currently possible to estimate a model that includes both types of spatial effects for discrete responses.   I suspect that both spatial effects are present in my transportation mode-built environment model.

Thanks for your help,
Drew
_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From asookun at gmail.com  Sun Aug  2 11:03:12 2015
From: asookun at gmail.com (Anand Sookun)
Date: Sun, 2 Aug 2015 13:03:12 +0400
Subject: [R-sig-Geo] help: krigged map do not show colours
Message-ID: <CAM7+9Ev+fxq1b-LAr71YQgU2qqznR7BE3E2KW=NZ8iQ4O5v0DA@mail.gmail.com>

Hi

I have kriged my data but the map shows uniform colours - no gradual
contour colour plot on map

code: print(spplot(k40, "var1.pred", asp=1,
col.regions=bpy.colors(64),main="OK prediction, log-ppm Zn"))

thnaks for any help

Anand Sookun
-- 
-------------------------------------------------------
*Anand Sookun (**MPhil. **PhD Candidate, University of Mauritius)*
*Director cum Freelance Consultant*
*Soft Sustainable Services (Mauritius)*
*Research and Consultancy*

Website: http://sustain-ability.webs.com/


https://www.linkedin.com/profile/view?id=161468467&trk=nav_responsive_tab_profile_pic

	[[alternative HTML version deleted]]


From roman.lustrik at gmail.com  Mon Aug  3 14:09:03 2015
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Mon, 3 Aug 2015 14:09:03 +0200
Subject: [R-sig-Geo] help: krigged map do not show colours
In-Reply-To: <CAM7+9Ev+fxq1b-LAr71YQgU2qqznR7BE3E2KW=NZ8iQ4O5v0DA@mail.gmail.com>
References: <CAM7+9Ev+fxq1b-LAr71YQgU2qqznR7BE3E2KW=NZ8iQ4O5v0DA@mail.gmail.com>
Message-ID: <CAHT1vpiwYQJfwyoLzKT23Y0ivzRV4RdqD3qA7eQQbb-kbWO_0Q@mail.gmail.com>

What is the variability of the plotted variable?

Cheers,
Roman

On Sun, Aug 2, 2015 at 11:03 AM, Anand Sookun <asookun at gmail.com> wrote:

> Hi
>
> I have kriged my data but the map shows uniform colours - no gradual
> contour colour plot on map
>
> code: print(spplot(k40, "var1.pred", asp=1,
> col.regions=bpy.colors(64),main="OK prediction, log-ppm Zn"))
>
> thnaks for any help
>
> Anand Sookun
> --
> -------------------------------------------------------
> *Anand Sookun (**MPhil. **PhD Candidate, University of Mauritius)*
> *Director cum Freelance Consultant*
> *Soft Sustainable Services (Mauritius)*
> *Research and Consultancy*
>
> Website: http://sustain-ability.webs.com/
>
>
>
> https://www.linkedin.com/profile/view?id=161468467&trk=nav_responsive_tab_profile_pic
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
In God we trust, all others bring data.

	[[alternative HTML version deleted]]


From Scott.Waichler at pnnl.gov  Mon Aug  3 16:34:10 2015
From: Scott.Waichler at pnnl.gov (Waichler, Scott R)
Date: Mon, 3 Aug 2015 14:34:10 +0000
Subject: [R-sig-Geo] Problem installing rgeos
In-Reply-To: <CAASFQpTnRRbN=XbaitBP3xCZxYhhm=VGBoH+xzKQaBeLxFbazw@mail.gmail.com>
References: <074C83DAD4825242A20B2D83FDBCB8881A059BD0@EX10MBOX03.pnnl.gov>
	<CAASFQpTnRRbN=XbaitBP3xCZxYhhm=VGBoH+xzKQaBeLxFbazw@mail.gmail.com>
Message-ID: <074C83DAD4825242A20B2D83FDBCB8881A059ED6@EX10MBOX03.pnnl.gov>

Thanks for the suggestions, but I think what I need is help tracking down what the exact error is in the compilation.  Let me try again with the part of the output describing the error:

> install.packages("rgeos", dependencies = F, repos = "http://cran.fhcrc.org/")
. . .
checking for C compiler default output file name... a.out
checking for suffix of executables...
checking whether we are cross compiling... configure: error: in `/tmp/RtmpUjYUle/R.INSTALL41c15690b9e1/rgeos':
configure: error: cannot run C compiled programs.
If you meant to cross compile, use `--host'.
See `config.log' for more details
ERROR: configuration failed for package 'rgeos'
* removing '/files3/R/R-3.2.1_install/lib64/R/library/rgeos'

It says I should refer to config.log for more details.  The only config.log file I can find in the directory tree is the one for geos, which I installed a couple of years ago, and did not give me problems with previous installations of rgeos under earlier releases of R.  In case there is a clue, here is the output in that config.log around the cross compile message:

configure:3682: result: 
configure:3704: checking whether we are cross compiling
configure:3712: gcc -o conftest    conftest.c  >&5
configure:3716: $? = 0
configure:3723: ./conftest

Is there a config.log for the attempted rgeos installation?  Where would I find it?

> You're build is failing pretty early in the configuration process which
> suggests you are missing some tools in your development
> environment.? The latest geos was found. Was that a binary or built from
> source?? If from source you have the necessary tools in your dev
> environment and it may merely be a function of dropping the depends in
> you install.packages call....

Rgeos was built from source.

Thanks,
Scott Waichler
PNNL

From englishchristophera at gmail.com  Mon Aug  3 19:33:55 2015
From: englishchristophera at gmail.com (chris english)
Date: Mon, 3 Aug 2015 13:33:55 -0400
Subject: [R-sig-Geo] Problem installing rgeos
In-Reply-To: <074C83DAD4825242A20B2D83FDBCB8881A059ED6@EX10MBOX03.pnnl.gov>
References: <074C83DAD4825242A20B2D83FDBCB8881A059BD0@EX10MBOX03.pnnl.gov>
	<CAASFQpTnRRbN=XbaitBP3xCZxYhhm=VGBoH+xzKQaBeLxFbazw@mail.gmail.com>
	<074C83DAD4825242A20B2D83FDBCB8881A059ED6@EX10MBOX03.pnnl.gov>
Message-ID: <CAASFQpQqr8dtL6pg38dzjvou03MeWrdmWZRNGEZH=1-6KgCRVw@mail.gmail.com>

Scott,

Keeping in mind that I'm not any sort of rgeos maintainer, but looking at
the config dialog, it appears to me that in the event of a failed build,
the config log wouldn't make it to:

ERROR: configuration failed for package 'rgeos'
* removing '/files3/R/R-3.2.1_install/lib64/R/library/rgeos'

as those files weren't written. Fair enough.
But, we do have that:
configure: error: in `/tmp/RtmpUjYUle/R.INSTALL41c15690b9e1/rgeos'

report line in there which is sufficiently specific/unique to suggest that
if one were to name something
as generic as config.log it wouldn't overwrite or get otherwise confused
with another config.log. So I'd clamber down that directory tree and see if
a config.log existed there somewhere. If there isn't some automatic
mechanism to remove from~/tmp, then it might likely be there...

Like yourself, I am at many times a head scratching user whose ah-ha
moments, if and when they come, are defined by having less hair and having
shed tears of frustration. Before I resort of posting to the list under the
"do thy homework" ethic.

So this is the best I can propose at the instance as mine was a successful
build.  I'll try a build again in a short while to actually just check if,
in the event of a clean build both the ~/tmp and ~/files3 are written as
I've been having some disk space problems and haven't  given much thought
to deleting ~/tmp items.

As to your last point, I was asking if the geos, not rgeos was build from
source as it relates to availability of geos headers rather than rgeos.

Hopefully more qualified rgeos will chime in and set us both right.
Chris




On Mon, Aug 3, 2015 at 10:34 AM, Waichler, Scott R <Scott.Waichler at pnnl.gov>
wrote:

> Thanks for the suggestions, but I think what I need is help tracking down
> what the exact error is in the compilation.  Let me try again with the part
> of the output describing the error:
>
> > install.packages("rgeos", dependencies = F, repos = "
> http://cran.fhcrc.org/")
> . . .
> checking for C compiler default output file name... a.out
> checking for suffix of executables...
> checking whether we are cross compiling... configure: error: in
> `/tmp/RtmpUjYUle/R.INSTALL41c15690b9e1/rgeos':
> configure: error: cannot run C compiled programs.
> If you meant to cross compile, use `--host'.
> See `config.log' for more details
> ERROR: configuration failed for package 'rgeos'
> * removing '/files3/R/R-3.2.1_install/lib64/R/library/rgeos'
>
> It says I should refer to config.log for more details.  The only
> config.log file I can find in the directory tree is the one for geos, which
> I installed a couple of years ago, and did not give me problems with
> previous installations of rgeos under earlier releases of R.  In case there
> is a clue, here is the output in that config.log around the cross compile
> message:
>
> configure:3682: result:
> configure:3704: checking whether we are cross compiling
> configure:3712: gcc -o conftest    conftest.c  >&5
> configure:3716: $? = 0
> configure:3723: ./conftest
>
> Is there a config.log for the attempted rgeos installation?  Where would I
> find it?
>
> > You're build is failing pretty early in the configuration process which
> > suggests you are missing some tools in your development
> > environment.  The latest geos was found. Was that a binary or built from
> > source?  If from source you have the necessary tools in your dev
> > environment and it may merely be a function of dropping the depends in
> > you install.packages call....
>
> Rgeos was built from source.
>
> Thanks,
> Scott Waichler
> PNNL
>

	[[alternative HTML version deleted]]


From erich.subs at neuwirth.priv.at  Mon Aug  3 19:43:47 2015
From: erich.subs at neuwirth.priv.at (Erich Subscriptions)
Date: Mon, 3 Aug 2015 19:43:47 +0200
Subject: [R-sig-Geo] leaflet problem
In-Reply-To: <CAJ4QxaPNvZcZ9oyxaf+3wNvTKsmu3GUE581jRD-L9N=DDjRJrA@mail.gmail.com>
References: <90B51B03-550E-40C4-9B61-48B5BA332792@neuwirth.priv.at>
	<CAJ4QxaPNvZcZ9oyxaf+3wNvTKsmu3GUE581jRD-L9N=DDjRJrA@mail.gmail.com>
Message-ID: <DB13873F-0022-4950-ABC5-3E94EB6FA77D@neuwirth.priv.at>

wien <- "http://maps1.wien.gv.at/basemap/bmapgrau/normal/google3857/{z}/{y}/{x}.png"
and 
addTiles(wien)

works,
but

wien <- "http://maps{s}.wien.gv.at/basemap/bmapgrau/normal/google3857/{z}/{y}/{x}.png"
and 
addTiles(wien,tileOptions(subdomain=?1234?))

does not work


From bob at rudis.net  Mon Aug  3 20:27:17 2015
From: bob at rudis.net (boB Rudis)
Date: Mon, 3 Aug 2015 14:27:17 -0400
Subject: [R-sig-Geo] leaflet problem
In-Reply-To: <DB13873F-0022-4950-ABC5-3E94EB6FA77D@neuwirth.priv.at>
References: <90B51B03-550E-40C4-9B61-48B5BA332792@neuwirth.priv.at>
	<CAJ4QxaPNvZcZ9oyxaf+3wNvTKsmu3GUE581jRD-L9N=DDjRJrA@mail.gmail.com>
	<DB13873F-0022-4950-ABC5-3E94EB6FA77D@neuwirth.priv.at>
Message-ID: <CAJ4QxaNx7_8yo+9ZnHQsLfFByHUWCtQ28qYsKbR5BO5L92ysbw@mail.gmail.com>

It looks like you or someone else has filed an issue
https://github.com/rstudio/leaflet/issues/157 for it, and that's
probably the best place for it to get resolved (also the one that
works for you does not for me, so it may be a geo-ip restriction on my
end)

On Mon, Aug 3, 2015 at 1:43 PM, Erich Subscriptions
<erich.subs at neuwirth.priv.at> wrote:
> wien <- "http://maps1.wien.gv.at/basemap/bmapgrau/normal/google3857/{z}/{y}/{x}.png"
> and
> addTiles(wien)
>
> works,
> but
>
> wien <- "http://maps{s}.wien.gv.at/basemap/bmapgrau/normal/google3857/{z}/{y}/{x}.png"
> and
> addTiles(wien,tileOptions(subdomain=?1234?))
>
> does not work
>


From erich.subs at neuwirth.priv.at  Mon Aug  3 20:40:47 2015
From: erich.subs at neuwirth.priv.at (Erich Subscriptions)
Date: Mon, 3 Aug 2015 20:40:47 +0200
Subject: [R-sig-Geo] leaflet problem
In-Reply-To: <CAJ4QxaNx7_8yo+9ZnHQsLfFByHUWCtQ28qYsKbR5BO5L92ysbw@mail.gmail.com>
References: <90B51B03-550E-40C4-9B61-48B5BA332792@neuwirth.priv.at>
	<CAJ4QxaPNvZcZ9oyxaf+3wNvTKsmu3GUE581jRD-L9N=DDjRJrA@mail.gmail.com>
	<DB13873F-0022-4950-ABC5-3E94EB6FA77D@neuwirth.priv.at>
	<CAJ4QxaNx7_8yo+9ZnHQsLfFByHUWCtQ28qYsKbR5BO5L92ysbw@mail.gmail.com>
Message-ID: <A62ACABF-F7AA-45AB-A296-63FA3DB641E2@neuwirth.priv.at>

I thnk I expeerienx the same issue as you do,

could you try
wien <- "http://maps1.wien.gv.at/basemap/bmapgrau/normal/google3857/{z}/{y}/{x}.png?

without spicing the subdomains?


I filed this issue at github.


> On 03 Aug 2015, at 20:27, boB Rudis <bob at rudis.net> wrote:
> 
> It looks like you or someone else has filed an issue
> https://github.com/rstudio/leaflet/issues/157 for it, and that's
> probably the best place for it to get resolved (also the one that
> works for you does not for me, so it may be a geo-ip restriction on my
> end)
> 
> On Mon, Aug 3, 2015 at 1:43 PM, Erich Subscriptions
> <erich.subs at neuwirth.priv.at> wrote:
>> wien <- "http://maps1.wien.gv.at/basemap/bmapgrau/normal/google3857/{z}/{y}/{x}.png"
>> and
>> addTiles(wien)
>> 
>> works,
>> but
>> 
>> wien <- "http://maps{s}.wien.gv.at/basemap/bmapgrau/normal/google3857/{z}/{y}/{x}.png"
>> and
>> addTiles(wien,tileOptions(subdomain=?1234?))
>> 
>> does not work
>> 


From adamhsparks at gmail.com  Tue Aug  4 07:09:37 2015
From: adamhsparks at gmail.com (Adam Sparks)
Date: Tue, 4 Aug 2015 13:09:37 +0800
Subject: [R-sig-Geo] plotKML - set color according to category
In-Reply-To: <55B8ED65.8080701@grauwekiekendief.nl>
References: <55B8ED65.8080701@grauwekiekendief.nl>
Message-ID: <CAJmQPwH2COTA0Te+9eSYxOgSub9zznhWZoQhTwftonruSK8fJQ@mail.gmail.com>

Dear Almut,
I've done this with raster data, but not points as you are describing. If
you convert to a factor and then cut the data, it is possible to create a
KML as you are describing. Towards the end of a script that I put together
for the Manila R User Group there's some code that may help.

https://github.com/adamhsparks/Philippine_R_User_Group/tree/master



On Wed, Jul 29, 2015 at 11:12 PM, Almut Schlaich - Werkgroep Grauwe
Kiekendief <almut.schlaich at grauwekiekendief.nl> wrote:

> Dear Dr. Hengl,
>
> First of all, I would like to thank you and your colleagues for the great
> package plotKML that I really enjoy using.
> This was indeed a missing link to visualize data, in our case tracking
> data, in Google Earth to easily explore them visually.
>
> I would like to ask you a question about the possibilities to color the
> points according to a variable.
> In my data table I have a column with classification category "phase"
> (e.g. migration, stopover, breeding, wintering etc.).
> Using e.g.: kml_layer(data,colour=phase,colour_scale=worldgrids_pal[[4]]),
> I get tracks nicely colored depending on category.
>
> But the difficulty arises when one bird has less levels of the category
> than another (e.g. one bird making no stopover).
> In this case the same colors are used, but for different values of the
> category, just in the order of first appearance.
> To easily compare tracks between individuals I would like to color the
> same category always in the same color. I tried to
> define the colors for each category and give the column with a color value
> per point to the kml_layer function, but this
> didn't work. Is it possible to determine the color of each point?
>
> At the moment I just use the combination of kml_open, kml_layer and
> kml_close to produce the output.
> Unfortuntely, the much more beautiful and handy plotKML for Space-time
> Trajectory Data Frames doesn't work for the
> tracks since they have too many points. Could you tell me what is the
> limit for this? And might it be possible for more
> points in near future?
>
> Thank you in advance for your help!
>
> Kind regards,
> Almut Schlaich
>
> --
> Almut Schlaich
>
> Werkgroep Grauwe Kiekendief
> telefoon: +31(0)650459766
> e-mail: almut.schlaich at grauwekiekendief.nl
> postadres: Postbus 46, 9679 ZG Scheemda
> www.grauwekiekendief.nl
> twitter: @grauwekiek
> facebook:
> www.facebook.com/pages/Werkgroep-Grauwe-Kiekendief/190585087622000
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
--
Adam Sparks
Plant Disease Management Specialist
IRRI
DAPO Box 7777, Metro Manila, Philippines
ph: +63(2) 580-5600 ext 2753

@adamhsparks <https://twitter.com/adamhsparks>

	[[alternative HTML version deleted]]


From jbjares at gmail.com  Tue Aug  4 08:30:17 2015
From: jbjares at gmail.com (=?UTF-8?Q?Jo=C3=A3o_Bosco_Jares?=)
Date: Tue, 4 Aug 2015 07:30:17 +0100
Subject: [R-sig-Geo] (no subject)
Message-ID: <CAO=PHYUk95-2Eah46JtgWgNbhikb0_FnCrSNsdCHYXQprAZoCQ@mail.gmail.com>

Hi all,
I'm looking for a solution to filter the data inside the GIS files. I mean,
I'm not looking for low-level geographical data, but the data necessary to
compute RDF cubes. For instance, in Census 2011 NUTS3_generalised20m files
exist some data to define country profiles who I can use to make my cubes,
but I need a way to query it, and then put it together with other relevant
data.
My environment is Java, and I'm planning use R just to show the graphics.
So, the question is: How can r-sig help me achieve this requirement?

All advices, as well as any ideas are very welcome.

Cheers.
--
Jo?o Bosco Jares
<http://ie.linkedin.com/in/jbjares>

	[[alternative HTML version deleted]]


From asookun at gmail.com  Mon Aug  3 17:30:52 2015
From: asookun at gmail.com (Anand Sookun)
Date: Mon, 3 Aug 2015 19:30:52 +0400
Subject: [R-sig-Geo] help: krigged map do not show colours
In-Reply-To: <CAHT1vpiwYQJfwyoLzKT23Y0ivzRV4RdqD3qA7eQQbb-kbWO_0Q@mail.gmail.com>
References: <CAM7+9Ev+fxq1b-LAr71YQgU2qqznR7BE3E2KW=NZ8iQ4O5v0DA@mail.gmail.com>
	<CAHT1vpiwYQJfwyoLzKT23Y0ivzRV4RdqD3qA7eQQbb-kbWO_0Q@mail.gmail.com>
Message-ID: <CAM7+9EukEdNVEaM35cagYP0wTCbjxFWcXNhGsTK-0MxnHvCUaA@mail.gmail.com>

Hi

Thank you Roman for your kind response.

The data is as attached which is part of the whole dataset.

My other problem is that im not able to create an appropriate prediction
grid with some data included.

The codes which failed to show colour ramps are

map <- krige(logcarbseq ~ 1, locations = carbon_seq, newdata = map,model =
vmf)
str(map)
print(spplot(map, "var1.pred", asp=1, col.regions=bpy.colors(64),main="OK
prediction, carbon"))
print(spplot(map, "var1.var",col.regions=cm.colors(64),asp=1, main="OK
prediction variance, carbon"))

I look forward to hopefully get some solutions.

Thanks again and warm regards

Anand

On Mon, Aug 3, 2015 at 4:09 PM, Roman Lu?trik <roman.lustrik at gmail.com>
wrote:

> What is the variability of the plotted variable?
>
> Cheers,
> Roman
>
> On Sun, Aug 2, 2015 at 11:03 AM, Anand Sookun <asookun at gmail.com> wrote:
>
>> Hi
>>
>> I have kriged my data but the map shows uniform colours - no gradual
>> contour colour plot on map
>>
>> code: print(spplot(k40, "var1.pred", asp=1,
>> col.regions=bpy.colors(64),main="OK prediction, log-ppm Zn"))
>>
>> thnaks for any help
>>
>> Anand Sookun
>> --
>> -------------------------------------------------------
>> *Anand Sookun (**MPhil. **PhD Candidate, University of Mauritius)*
>> *Director cum Freelance Consultant*
>> *Soft Sustainable Services (Mauritius)*
>> *Research and Consultancy*
>>
>> Website: http://sustain-ability.webs.com/
>>
>>
>>
>> https://www.linkedin.com/profile/view?id=161468467&trk=nav_responsive_tab_profile_pic
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
>
> --
> In God we trust, all others bring data.
>



-- 
-------------------------------------------------------
*Anand Sookun (**MPhil. **PhD Candidate, University of Mauritius)*
*Director cum Freelance Consultant*
*Soft Sustainable Services (Mauritius)*
*Research and Consultancy*

Website: http://sustain-ability.webs.com/


https://www.linkedin.com/profile/view?id=161468467&trk=nav_responsive_tab_profile_pic
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150803/24f4823e/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: EXAMPLE DATA.csv
Type: text/csv
Size: 615 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150803/24f4823e/attachment.bin>

From almut.schlaich at grauwekiekendief.nl  Tue Aug  4 10:36:42 2015
From: almut.schlaich at grauwekiekendief.nl (Almut Schlaich - Werkgroep Grauwe Kiekendief)
Date: Tue, 04 Aug 2015 10:36:42 +0200
Subject: [R-sig-Geo] plotKML - set color according to category
In-Reply-To: <CAJmQPwH2COTA0Te+9eSYxOgSub9zznhWZoQhTwftonruSK8fJQ@mail.gmail.com>
References: <55B8ED65.8080701@grauwekiekendief.nl>
	<CAJmQPwH2COTA0Te+9eSYxOgSub9zznhWZoQhTwftonruSK8fJQ@mail.gmail.com>
Message-ID: <55C0799A.7010609@grauwekiekendief.nl>

Dear Adam,

Thank you for your response!
I run your script on the raster data and I think the requirements are 
the same. For my point data set I already have a colomn with a factorial 
variable (in this case the phases of the annual cylce) and the points 
are colored according to them.

But imagine you would make maps of your raster data of two different 
countries, where the second one has different categories from the other 
(e.g. the second country could have values [13,14], 
(14,15],(15,16],(16,17] instead of [14,15],(15,16],(16,17],(17,18) for 
the Philippines). Then the plotKML would use the same four colors for 
these two maps, even though the values are not the same.

Could you now also define that e.g. [13,14] is white, (14,15) light 
yellow and so on and use the same color for the same value in the 
different plots?

Thanks again and kind regards,
Almut

Am 8/4/2015 um 7:09 AM schrieb Adam Sparks:
> Dear Almut,
> I've done this with raster data, but not points as you are describing. 
> If you convert to a factor and then cut the data, it is possible to 
> create a KML as you are describing. Towards the end of a script that I 
> put together for the Manila R User Group there's some code that may help.
>
> https://github.com/adamhsparks/Philippine_R_User_Group/tree/master
>
>
>
> On Wed, Jul 29, 2015 at 11:12 PM, Almut Schlaich - Werkgroep Grauwe 
> Kiekendief <almut.schlaich at grauwekiekendief.nl 
> <mailto:almut.schlaich at grauwekiekendief.nl>> wrote:
>
>     Dear Dr. Hengl,
>
>     First of all, I would like to thank you and your colleagues for
>     the great package plotKML that I really enjoy using.
>     This was indeed a missing link to visualize data, in our case
>     tracking data, in Google Earth to easily explore them visually.
>
>     I would like to ask you a question about the possibilities to
>     color the points according to a variable.
>     In my data table I have a column with classification category
>     "phase" (e.g. migration, stopover, breeding, wintering etc.).
>     Using e.g.:
>     kml_layer(data,colour=phase,colour_scale=worldgrids_pal[[4]]), I
>     get tracks nicely colored depending on category.
>
>     But the difficulty arises when one bird has less levels of the
>     category than another (e.g. one bird making no stopover).
>     In this case the same colors are used, but for different values of
>     the category, just in the order of first appearance.
>     To easily compare tracks between individuals I would like to color
>     the same category always in the same color. I tried to
>     define the colors for each category and give the column with a
>     color value per point to the kml_layer function, but this
>     didn't work. Is it possible to determine the color of each point?
>
>     At the moment I just use the combination of kml_open, kml_layer
>     and kml_close to produce the output.
>     Unfortuntely, the much more beautiful and handy plotKML for
>     Space-time Trajectory Data Frames doesn't work for the
>     tracks since they have too many points. Could you tell me what is
>     the limit for this? And might it be possible for more
>     points in near future?
>
>     Thank you in advance for your help!
>
>     Kind regards,
>     Almut Schlaich
>
>     -- 
>     Almut Schlaich
>
>     Werkgroep Grauwe Kiekendief
>     telefoon: +31(0)650459766
>     e-mail: almut.schlaich at grauwekiekendief.nl
>     <mailto:almut.schlaich at grauwekiekendief.nl>
>     postadres: Postbus 46, 9679 ZG Scheemda
>     www.grauwekiekendief.nl <http://www.grauwekiekendief.nl>
>     twitter: @grauwekiek
>     facebook:
>     www.facebook.com/pages/Werkgroep-Grauwe-Kiekendief/190585087622000
>     <http://www.facebook.com/pages/Werkgroep-Grauwe-Kiekendief/190585087622000>
>
>     _______________________________________________
>     R-sig-Geo mailing list
>     R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>     https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>
>
> -- 
> --
> Adam Sparks
> Plant Disease Management Specialist
> IRRI
> DAPO Box 7777, Metro Manila, Philippines
> ph: +63(2) 580-5600 ext 2753
>
> @adamhsparks <https://twitter.com/adamhsparks>

-- 
Almut Schlaich

Werkgroep Grauwe Kiekendief
telefoon: +31(0)650459766
e-mail: almut.schlaich at grauwekiekendief.nl
postadres: Postbus 46, 9679 ZG Scheemda
www.grauwekiekendief.nl
twitter: @grauwekiek
facebook: www.facebook.com/pages/Werkgroep-Grauwe-Kiekendief/190585087622000


	[[alternative HTML version deleted]]


From frtog at vestas.com  Tue Aug  4 11:37:53 2015
From: frtog at vestas.com (=?iso-8859-1?Q?Frede_Aakmann_T=F8gersen?=)
Date: Tue, 4 Aug 2015 09:37:53 +0000
Subject: [R-sig-Geo] plotKML - set color according to category
In-Reply-To: <55C0799A.7010609@grauwekiekendief.nl>
References: <55B8ED65.8080701@grauwekiekendief.nl>
	<CAJmQPwH2COTA0Te+9eSYxOgSub9zznhWZoQhTwftonruSK8fJQ@mail.gmail.com>
	<55C0799A.7010609@grauwekiekendief.nl>
Message-ID: <HE1PR04MB127617FC6566E2ED20093CDFDB760@HE1PR04MB1276.eurprd04.prod.outlook.com>

Dear Almut

You're no getting many responses to your question because you don't give information enough for us to see where the presumed plotting error is.

I think you're not telling the whole truth. You're saying

   "In my data table I have a column with classification category
   'phase' (e.g. migration, stopover, breeding, wintering etc.)."

If that is the case then all birds have the same number of factor levels or categories! You cannot have a column where subsets of the records have different numbers of levels. Let me demonstrate that by a small example.

## create tw data frames
dat.1 <- data.frame(x = 1:12, y = rnorm(12), A = gl(3, 4, labels = c("low", "middle", "high")))
dat.2 <- data.frame(x = 1:12, y = 2 + rnorm(12), A = gl(2, 6, labels = c("small", "big")))

## combine those row wise
alldat <- rbind(dat.1, dat.2)

## print number of levels and the labels
nlevels(alldat$A)
levels(alldat$A)

## plot data with a legend
plot(y ~ x, data = alldat, pch = 19, col = alldat$A, cex = 2, ylim = c(-2, 5))
legend("top", legend = levels(alldat$A), col = 1:nlevels(alldat$A), lty = 1, lwd = 10, ncol = 5)

## subset data according to a subset of the A factor
subdat <- subset(alldat, A %in% c("low", "big"))

## only "low" and "big" records
print(subdat)

## but still we have the same nummber and labels as in alldat
nlevels(subdat$A)
levels(subdat$A)

## and plotting will still have the same definition of factor A as in alldat
plot(y ~ x, data = subdat, pch = 19, col = subdat$A, cex = 2, ylim = c(-2, 5))
legend("top", legend = levels(subdat$A), col = 1:nlevels(subdat$A), lty = 1, lwd = 10, ncol = 5)

So why do you have different levels for different birds? Did you originally get your data seperated for each bird and then later combined those is some way that was impropriate when having some columns with factors?

Or did you not combine data frames but in fact you looped over a number of data frames with different definition of the factor 'phase'. That would certainly explain your problem with different number of categories.

Nobody can really help you before you provide an R coded small reproducible example that shows us the problem that you have (see e.g. http://www.r-bloggers.com/three-tips-for-posting-good-questions-to-r-help-and-stack-overflow).



Yours sincerely / Med venlig hilsen

Frede Aakmann T?gersen
Specialist, M.Sc., Ph.D.
Plant Performance & Modeling

Technology & Service Solutions
T +45 9730 5135
M +45 2547 6050
frtog at vestas.com
http://www.vestas.com

Company reg. name: Vestas Wind Systems A/S
This e-mail is subject to our e-mail disclaimer statement.
Please refer to www.vestas.com/legal/notice
If you have received this e-mail in error please contact the sender. 



-----Original Message-----
From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Almut Schlaich - Werkgroep Grauwe Kiekendief
Sent: 4. august 2015 10:37
To: Adam Sparks
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] plotKML - set color according to category

Dear Adam,

Thank you for your response!
I run your script on the raster data and I think the requirements are 
the same. For my point data set I already have a colomn with a factorial 
variable (in this case the phases of the annual cylce) and the points 
are colored according to them.

But imagine you would make maps of your raster data of two different 
countries, where the second one has different categories from the other 
(e.g. the second country could have values [13,14], 
(14,15],(15,16],(16,17] instead of [14,15],(15,16],(16,17],(17,18) for 
the Philippines). Then the plotKML would use the same four colors for 
these two maps, even though the values are not the same.

Could you now also define that e.g. [13,14] is white, (14,15) light 
yellow and so on and use the same color for the same value in the 
different plots?

Thanks again and kind regards,
Almut

Am 8/4/2015 um 7:09 AM schrieb Adam Sparks:
> Dear Almut,
> I've done this with raster data, but not points as you are describing. 
> If you convert to a factor and then cut the data, it is possible to 
> create a KML as you are describing. Towards the end of a script that I 
> put together for the Manila R User Group there's some code that may help.
>
> https://github.com/adamhsparks/Philippine_R_User_Group/tree/master
>
>
>
> On Wed, Jul 29, 2015 at 11:12 PM, Almut Schlaich - Werkgroep Grauwe 
> Kiekendief <almut.schlaich at grauwekiekendief.nl 
> <mailto:almut.schlaich at grauwekiekendief.nl>> wrote:
>
>     Dear Dr. Hengl,
>
>     First of all, I would like to thank you and your colleagues for
>     the great package plotKML that I really enjoy using.
>     This was indeed a missing link to visualize data, in our case
>     tracking data, in Google Earth to easily explore them visually.
>
>     I would like to ask you a question about the possibilities to
>     color the points according to a variable.
>     In my data table I have a column with classification category
>     "phase" (e.g. migration, stopover, breeding, wintering etc.).
>     Using e.g.:
>     kml_layer(data,colour=phase,colour_scale=worldgrids_pal[[4]]), I
>     get tracks nicely colored depending on category.
>
>     But the difficulty arises when one bird has less levels of the
>     category than another (e.g. one bird making no stopover).
>     In this case the same colors are used, but for different values of
>     the category, just in the order of first appearance.
>     To easily compare tracks between individuals I would like to color
>     the same category always in the same color. I tried to
>     define the colors for each category and give the column with a
>     color value per point to the kml_layer function, but this
>     didn't work. Is it possible to determine the color of each point?
>
>     At the moment I just use the combination of kml_open, kml_layer
>     and kml_close to produce the output.
>     Unfortuntely, the much more beautiful and handy plotKML for
>     Space-time Trajectory Data Frames doesn't work for the
>     tracks since they have too many points. Could you tell me what is
>     the limit for this? And might it be possible for more
>     points in near future?
>
>     Thank you in advance for your help!
>
>     Kind regards,
>     Almut Schlaich
>
>     -- 
>     Almut Schlaich
>
>     Werkgroep Grauwe Kiekendief
>     telefoon: +31(0)650459766
>     e-mail: almut.schlaich at grauwekiekendief.nl
>     <mailto:almut.schlaich at grauwekiekendief.nl>
>     postadres: Postbus 46, 9679 ZG Scheemda
>     www.grauwekiekendief.nl <http://www.grauwekiekendief.nl>
>     twitter: @grauwekiek
>     facebook:
>     www.facebook.com/pages/Werkgroep-Grauwe-Kiekendief/190585087622000
>     <http://www.facebook.com/pages/Werkgroep-Grauwe-Kiekendief/190585087622000>
>
>     _______________________________________________
>     R-sig-Geo mailing list
>     R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>     https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>
>
> -- 
> --
> Adam Sparks
> Plant Disease Management Specialist
> IRRI
> DAPO Box 7777, Metro Manila, Philippines
> ph: +63(2) 580-5600 ext 2753
>
> @adamhsparks <https://twitter.com/adamhsparks>

-- 
Almut Schlaich

Werkgroep Grauwe Kiekendief
telefoon: +31(0)650459766
e-mail: almut.schlaich at grauwekiekendief.nl
postadres: Postbus 46, 9679 ZG Scheemda
www.grauwekiekendief.nl
twitter: @grauwekiek
facebook: www.facebook.com/pages/Werkgroep-Grauwe-Kiekendief/190585087622000


	[[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From englishchristophera at gmail.com  Tue Aug  4 13:44:42 2015
From: englishchristophera at gmail.com (chris english)
Date: Tue, 4 Aug 2015 07:44:42 -0400
Subject: [R-sig-Geo] Problem installing rgeos
In-Reply-To: <074C83DAD4825242A20B2D83FDBCB8881A059ED6@EX10MBOX03.pnnl.gov>
References: <074C83DAD4825242A20B2D83FDBCB8881A059BD0@EX10MBOX03.pnnl.gov>
	<CAASFQpTnRRbN=XbaitBP3xCZxYhhm=VGBoH+xzKQaBeLxFbazw@mail.gmail.com>
	<074C83DAD4825242A20B2D83FDBCB8881A059ED6@EX10MBOX03.pnnl.gov>
Message-ID: <CAASFQpQAJ8ZgLzH_9jtMwiGAQK8GjKGB4mMsfyNbEH_rEnazCw@mail.gmail.com>

Scott:

I found this discussion that chokes at the same point as yours on:
http://unix.stackexchange.com/questions/50151/getting-newer-version-of-geos-than-what-is-available-in-debian-repositories

I don't know that it will be applicable. Why don't you post your
sessionInfo() as this may be useful to others in the future.  Which version
of GEOS do you have installed?

HTH
Chris

On Mon, Aug 3, 2015 at 10:34 AM, Waichler, Scott R <Scott.Waichler at pnnl.gov>
wrote:

> Thanks for the suggestions, but I think what I need is help tracking down
> what the exact error is in the compilation.  Let me try again with the part
> of the output describing the error:
>
> > install.packages("rgeos", dependencies = F, repos = "
> http://cran.fhcrc.org/")
> . . .
> checking for C compiler default output file name... a.out
> checking for suffix of executables...
> checking whether we are cross compiling... configure: error: in
> `/tmp/RtmpUjYUle/R.INSTALL41c15690b9e1/rgeos':
> configure: error: cannot run C compiled programs.
> If you meant to cross compile, use `--host'.
> See `config.log' for more details
> ERROR: configuration failed for package 'rgeos'
> * removing '/files3/R/R-3.2.1_install/lib64/R/library/rgeos'
>
> It says I should refer to config.log for more details.  The only
> config.log file I can find in the directory tree is the one for geos, which
> I installed a couple of years ago, and did not give me problems with
> previous installations of rgeos under earlier releases of R.  In case there
> is a clue, here is the output in that config.log around the cross compile
> message:
>
> configure:3682: result:
> configure:3704: checking whether we are cross compiling
> configure:3712: gcc -o conftest    conftest.c  >&5
> configure:3716: $? = 0
> configure:3723: ./conftest
>
> Is there a config.log for the attempted rgeos installation?  Where would I
> find it?
>
> > You're build is failing pretty early in the configuration process which
> > suggests you are missing some tools in your development
> > environment.  The latest geos was found. Was that a binary or built from
> > source?  If from source you have the necessary tools in your dev
> > environment and it may merely be a function of dropping the depends in
> > you install.packages call....
>
> Rgeos was built from source.
>
> Thanks,
> Scott Waichler
> PNNL
>

	[[alternative HTML version deleted]]


From Roger.Bivand at nhh.no  Tue Aug  4 15:25:06 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 4 Aug 2015 15:25:06 +0200
Subject: [R-sig-Geo] Problem installing rgeos
In-Reply-To: <CAASFQpQAJ8ZgLzH_9jtMwiGAQK8GjKGB4mMsfyNbEH_rEnazCw@mail.gmail.com>
References: <074C83DAD4825242A20B2D83FDBCB8881A059BD0@EX10MBOX03.pnnl.gov>
	<CAASFQpTnRRbN=XbaitBP3xCZxYhhm=VGBoH+xzKQaBeLxFbazw@mail.gmail.com>
	<074C83DAD4825242A20B2D83FDBCB8881A059ED6@EX10MBOX03.pnnl.gov>
	<CAASFQpQAJ8ZgLzH_9jtMwiGAQK8GjKGB4mMsfyNbEH_rEnazCw@mail.gmail.com>
Message-ID: <alpine.LFD.2.20.1508041517050.30406@reclus.nhh.no>

On Tue, 4 Aug 2015, chris english wrote:

> Scott:
>
> I found this discussion that chokes at the same point as yours on:
> http://unix.stackexchange.com/questions/50151/getting-newer-version-of-geos-than-what-is-available-in-debian-repositories
>
> I don't know that it will be applicable. Why don't you post your
> sessionInfo() as this may be useful to others in the future.  Which version
> of GEOS do you have installed?

The problem is almost certainly that the platform build train (compilers 
and libraries) which underlie all the other programs have been updated, as 
Chris has suggested (and we still do not know the OS version or output of 
sessionInfo()). This is neither a GEOS nor an rgeos problem. Most likely 
the C and C++ libraries have changed, leading to a need to re-install an 
unknown number of downstream components.

I suggest checking that you can install Rcpp from source (to test the 
build train). If there are problems, you should correct these first, by 
bringing your build train into reasonable order.

If you can, re-install GEOS from source (to freshen up its dependencies on 
the C and C++ libraries) and only when GEOS passes make check itself 
(ourside R), proceed to install rgeos. If you download the R source 
tarball of rgeos, and run R CMD check on it, you will get a full test of 
its state.?Following R CMD INSTALL, this should then work.

Roger

>
> HTH
> Chris
>
> On Mon, Aug 3, 2015 at 10:34 AM, Waichler, Scott R <Scott.Waichler at pnnl.gov>
> wrote:
>
>> Thanks for the suggestions, but I think what I need is help tracking down
>> what the exact error is in the compilation.  Let me try again with the part
>> of the output describing the error:
>>
>>> install.packages("rgeos", dependencies = F, repos = "
>> http://cran.fhcrc.org/")
>> . . .
>> checking for C compiler default output file name... a.out
>> checking for suffix of executables...
>> checking whether we are cross compiling... configure: error: in
>> `/tmp/RtmpUjYUle/R.INSTALL41c15690b9e1/rgeos':
>> configure: error: cannot run C compiled programs.
>> If you meant to cross compile, use `--host'.
>> See `config.log' for more details
>> ERROR: configuration failed for package 'rgeos'
>> * removing '/files3/R/R-3.2.1_install/lib64/R/library/rgeos'
>>
>> It says I should refer to config.log for more details.  The only
>> config.log file I can find in the directory tree is the one for geos, which
>> I installed a couple of years ago, and did not give me problems with
>> previous installations of rgeos under earlier releases of R.  In case there
>> is a clue, here is the output in that config.log around the cross compile
>> message:
>>
>> configure:3682: result:
>> configure:3704: checking whether we are cross compiling
>> configure:3712: gcc -o conftest    conftest.c  >&5
>> configure:3716: $? = 0
>> configure:3723: ./conftest
>>
>> Is there a config.log for the attempted rgeos installation?  Where would I
>> find it?
>>
>>> You're build is failing pretty early in the configuration process which
>>> suggests you are missing some tools in your development
>>> environment.  The latest geos was found. Was that a binary or built from
>>> source?  If from source you have the necessary tools in your dev
>>> environment and it may merely be a function of dropping the depends in
>>> you install.packages call....
>>
>> Rgeos was built from source.
>>
>> Thanks,
>> Scott Waichler
>> PNNL
>>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no

From asookun at gmail.com  Tue Aug  4 15:33:39 2015
From: asookun at gmail.com (Anand Sookun)
Date: Tue, 4 Aug 2015 17:33:39 +0400
Subject: [R-sig-Geo] help: krigged map do not show colours
In-Reply-To: <55C0B635.1010307@jrc.ec.europa.eu>
References: <CAM7+9Ev+fxq1b-LAr71YQgU2qqznR7BE3E2KW=NZ8iQ4O5v0DA@mail.gmail.com>
	<CAHT1vpiwYQJfwyoLzKT23Y0ivzRV4RdqD3qA7eQQbb-kbWO_0Q@mail.gmail.com>
	<CAM7+9EukEdNVEaM35cagYP0wTCbjxFWcXNhGsTK-0MxnHvCUaA@mail.gmail.com>
	<55C08841.6020403@jrc.ec.europa.eu>
	<CAM7+9EsbqjfbNHVfpduba7vxc4DUbKqq-xy82xD+hUXpd3fgmg@mail.gmail.com>
	<55C0B635.1010307@jrc.ec.europa.eu>
Message-ID: <CAM7+9EvAhGcMat4V-KwcsWYNwrMJ5dkGGds9qstDyFdDPz0mtQ@mail.gmail.com>

DearJon

Thnaks. I will try that soon.

Cheers

Anand

On Tue, Aug 4, 2015 at 4:55 PM, Jon Skoien <jon.skoien at jrc.ec.europa.eu>
wrote:

> Anand,
>
> I could not open your .grd file in R, I think the .gri file is missing.
> However, looking at it in a text editor, and comparing with your R-script,
> it seems something went wrong with your projections. Your .csv-file has
> LatLong coordinates, but you are setting the projection to "+proj=utm
> +zone=40 +south +datum=WGS84 +units=m +no_defs +ellps=WGS84
> +towgs84=0,0,0", the same as you seem to have in your prediction raster.
> But you need to reproject your observations in this case.
>
> # First set the right projection:
> proj4string(carbon_seq) <- CRS("+init=epsg4326") # epsg-code for latlong
> # Then transform
> carbon_seq = spTransform(carbon_seq, CRS("+proj=utm +zone=40 +south
> +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0"))
>
> If you do this, your prediction grid should overlap your observations, and
> the colors should reflect your color ramp. What you essentially did before
> was to make a prediction thousands of km away from your observations, and
> then all values will be the same.
>
> Best wishes,
> Jon
>
>
> On 8/4/2015 12:48 PM, Anand Sookun wrote:
>
>> Dear Jon and Roman
>>
>> Thanks for the reply.
>>
>> Im attaching the code.
>>
>> You may be right that the variogram may be problematic but it fitted
>> well visually.
>>
>> I think also that the prediction grid was not well created. I wiould be
>> grateful to have to hints.code how to create a useful grid and also for
>> the spplot or other alternatives
>>
>> I can send more info if required.
>>
>> Cheers
>>
>> Anand
>>
>> On Tue, Aug 4, 2015 at 1:39 PM, Jon Skoien <jon.skoien at jrc.ec.europa.eu
>> <mailto:jon.skoien at jrc.ec.europa.eu>> wrote:
>>
>>     Hi,
>>
>>     You have attached some data, but we still dont know exactly what you
>>     do with the data (do you use the logarithm, how many bins, did you
>>     project the data set...?). However, having had a quick look using
>>     the LatLong coordinates (not really recommended), I can see that the
>>     variogram from this data set is not particularly well defined, and
>>     it could well be that you fitted a model with pure nugget effect. In
>>     that case you will get the same prediction everywhere and no color
>>     differences.
>>
>>     Have a look at
>>      > summary(map)
>>     and particularly the summary of var1.pred.
>>     You could also plot the variogram of the data together with your
>>     model, vmf, and see how they fit.
>>
>>     I am not sure what you mean by not being able to create a prediction
>>     grid with data included. Do you mean that you want a grid which
>>     exactly overlays some of the data points? Matching one point should
>>     not be difficult, 2 and 3 should be possible, but you might get some
>>     problems with precision (FAQ 7.31).
>>
>>     Best wishes,
>>     Jon
>>
>>
>>
>>
>>     On 8/3/2015 5:30 PM, Anand Sookun wrote:
>>
>>>     Hi
>>>
>>>     Thank you Roman for your kind response.
>>>
>>>     The data is as attached which is part of the whole dataset.
>>>
>>>     My other problem is that im not able to create an appropriate
>>>     prediction grid with some data included.
>>>
>>>     The codes which failed to show colour ramps are
>>>
>>>     map <- krige(logcarbseq ~ 1, locations = carbon_seq, newdata =
>>>     map,model = vmf)
>>>     str(map)
>>>     print(spplot(map, "var1.pred", asp=1,
>>>     col.regions=bpy.colors(64),main="OK prediction, carbon"))
>>>     print(spplot(map, "var1.var",col.regions=cm.colors(64),asp=1,
>>>     main="OK prediction variance, carbon"))
>>>
>>>     I look forward to hopefully get some solutions.
>>>
>>>     Thanks again and warm regards
>>>
>>>     Anand
>>>
>>>     On Mon, Aug 3, 2015 at 4:09 PM, Roman Lu?trik
>>>     <roman.lustrik at gmail.com <mailto:roman.lustrik at gmail.com>> wrote:
>>>
>>>         What is the variability of the plotted variable?
>>>
>>>         Cheers,
>>>         Roman
>>>
>>>         On Sun, Aug 2, 2015 at 11:03 AM, Anand Sookun
>>>         <<mailto:asookun at gmail.com>asookun at gmail.com
>>>         <mailto:asookun at gmail.com>> wrote:
>>>
>>>             Hi
>>>
>>>             I have kriged my data but the map shows uniform colours -
>>>             no gradual
>>>             contour colour plot on map
>>>
>>>             code: print(spplot(k40, "var1.pred", asp=1,
>>>             col.regions=bpy.colors(64),main="OK prediction, log-ppm Zn"))
>>>
>>>             thnaks for any help
>>>
>>>             Anand Sookun
>>>             --
>>>             -------------------------------------------------------
>>>             *Anand Sookun (**MPhil. **PhD Candidate, University of
>>>             Mauritius)*
>>>             *Director cum Freelance Consultant*
>>>             *Soft Sustainable Services (Mauritius)*
>>>             *Research and Consultancy*
>>>
>>>             Website: http://sustain-ability.webs.com/
>>>
>>>
>>>
>>> https://www.linkedin.com/profile/view?id=161468467&trk=nav_responsive_tab_profile_pic
>>>
>>>                     [[alternative HTML version deleted]]
>>>
>>>             _______________________________________________
>>>             R-sig-Geo mailing list
>>>             R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>>>             https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>>>
>>>
>>>         --
>>>         In God we trust, all others bring data.
>>>
>>>
>>>
>>>
>>>     --
>>>     -------------------------------------------------------
>>>     /*Anand Sookun (*//*MPhil. *//*PhD Candidate, University of
>>>     Mauritius)*/
>>>     /*Director cum Freelance Consultant*/
>>>     /*Soft Sustainable Services (Mauritius)*/
>>>     /*Research and Consultancy*/
>>>
>>>     Website:
>>>     <http://sustain-ability.webs.com/>http://sustain-ability.webs.com/
>>>
>>>
>>>     <
>>> https://www.linkedin.com/profile/view?id=161468467&trk=nav_responsive_tab_profile_pic
>>> >
>>> https://www.linkedin.com/profile/view?id=161468467&trk=nav_responsive_tab_profile_pic
>>>
>>>
>>>
>>>     _______________________________________________
>>>     R-sig-Geo mailing list
>>>     R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>>>     https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>>     --
>>     Jon Olav Sk?ien
>>     Joint Research Centre - European Commission
>>     Institute for Environment and Sustainability (IES)
>>     Climate Risk Management Unit
>>
>>     Via Fermi 2749, TP 100-01,  I-21027 Ispra (VA), ITALY
>>
>>     jon.skoien at jrc.ec.europa.eu <mailto:jon.skoien at jrc.ec.europa.eu>
>>     Tel:+39 0332 789205 <tel:%2B39%200332%20789205>
>>
>>     Disclaimer: Views expressed in this email are those of the individual
>> and do not necessarily represent official views of the European Commission.
>>
>>
>>
>>
>> --
>> -------------------------------------------------------
>> /*Anand Sookun (*//*MPhil. *//*PhD Candidate, University of Mauritius)*/
>> /*Director cum Freelance Consultant*/
>> /*Soft Sustainable Services (Mauritius)*/
>> /*Research and Consultancy*/
>>
>> Website: http://sustain-ability.webs.com/
>>
>>
>>
>> https://www.linkedin.com/profile/view?id=161468467&trk=nav_responsive_tab_profile_pic
>>
>>
> --
> Jon Olav Sk?ien
> Joint Research Centre - European Commission
> Institute for Environment and Sustainability (IES)
> Climate Risk Management Unit
>
> Via Fermi 2749, TP 100-01,  I-21027 Ispra (VA), ITALY
>
> jon.skoien at jrc.ec.europa.eu
> Tel:  +39 0332 789205
>
> Disclaimer: Views expressed in this email are those of the individual and
> do not necessarily represent official views of the European Commission.
>



-- 
-------------------------------------------------------
*Anand Sookun (**MPhil. **PhD Candidate, University of Mauritius)*
*Director cum Freelance Consultant*
*Soft Sustainable Services (Mauritius)*
*Research and Consultancy*

Website: http://sustain-ability.webs.com/


https://www.linkedin.com/profile/view?id=161468467&trk=nav_responsive_tab_profile_pic

	[[alternative HTML version deleted]]


From almut.schlaich at grauwekiekendief.nl  Tue Aug  4 15:36:35 2015
From: almut.schlaich at grauwekiekendief.nl (Almut Schlaich - Werkgroep Grauwe Kiekendief)
Date: Tue, 04 Aug 2015 15:36:35 +0200
Subject: [R-sig-Geo] plotKML - set color according to category
In-Reply-To: <HE1PR04MB127617FC6566E2ED20093CDFDB760@HE1PR04MB1276.eurprd04.prod.outlook.com>
References: <55B8ED65.8080701@grauwekiekendief.nl>	<CAJmQPwH2COTA0Te+9eSYxOgSub9zznhWZoQhTwftonruSK8fJQ@mail.gmail.com>
	<55C0799A.7010609@grauwekiekendief.nl>
	<HE1PR04MB127617FC6566E2ED20093CDFDB760@HE1PR04MB1276.eurprd04.prod.outlook.com>
Message-ID: <55C0BFE3.2070603@grauwekiekendief.nl>

Dear Frede,

Thank you very much for your great suggestions and the valuable tips.
Please excuse that my question was not totally clear, it was my first 
time ever to ask something to a list... I'll try to be clearer next time!

Your example brougth me the solution of the problem. It is not what I 
was looking for but I understood how the levels are working.
You were right in suspecting that I had a seperate data frame for each 
individual and therefore it could happen that there were different
numbers of levels.
I now made first one loop to download all individuals after each other 
and put the data together in one big data frame.
Then, in a second loop, I subset again for each bird and make the kml 
with colors according to the levels (which are now the same for all).

The result is great! It is now easy to check if the annotation is right 
and to compare between individuals.

Thank you very much for your help!

Kind regards, Almut


Am 8/4/2015 um 11:37 AM schrieb Frede Aakmann T?gersen:
> Dear Almut
>
> You're no getting many responses to your question because you don't give information enough for us to see where the presumed plotting error is.
>
> I think you're not telling the whole truth. You're saying
>
>     "In my data table I have a column with classification category
>     'phase' (e.g. migration, stopover, breeding, wintering etc.)."
>
> If that is the case then all birds have the same number of factor levels or categories! You cannot have a column where subsets of the records have different numbers of levels. Let me demonstrate that by a small example.
>
> ## create tw data frames
> dat.1 <- data.frame(x = 1:12, y = rnorm(12), A = gl(3, 4, labels = c("low", "middle", "high")))
> dat.2 <- data.frame(x = 1:12, y = 2 + rnorm(12), A = gl(2, 6, labels = c("small", "big")))
>
> ## combine those row wise
> alldat <- rbind(dat.1, dat.2)
>
> ## print number of levels and the labels
> nlevels(alldat$A)
> levels(alldat$A)
>
> ## plot data with a legend
> plot(y ~ x, data = alldat, pch = 19, col = alldat$A, cex = 2, ylim = c(-2, 5))
> legend("top", legend = levels(alldat$A), col = 1:nlevels(alldat$A), lty = 1, lwd = 10, ncol = 5)
>
> ## subset data according to a subset of the A factor
> subdat <- subset(alldat, A %in% c("low", "big"))
>
> ## only "low" and "big" records
> print(subdat)
>
> ## but still we have the same nummber and labels as in alldat
> nlevels(subdat$A)
> levels(subdat$A)
>
> ## and plotting will still have the same definition of factor A as in alldat
> plot(y ~ x, data = subdat, pch = 19, col = subdat$A, cex = 2, ylim = c(-2, 5))
> legend("top", legend = levels(subdat$A), col = 1:nlevels(subdat$A), lty = 1, lwd = 10, ncol = 5)
>
> So why do you have different levels for different birds? Did you originally get your data seperated for each bird and then later combined those is some way that was impropriate when having some columns with factors?
>
> Or did you not combine data frames but in fact you looped over a number of data frames with different definition of the factor 'phase'. That would certainly explain your problem with different number of categories.
>
> Nobody can really help you before you provide an R coded small reproducible example that shows us the problem that you have (see e.g. http://www.r-bloggers.com/three-tips-for-posting-good-questions-to-r-help-and-stack-overflow).
>
>
>
> Yours sincerely / Med venlig hilsen
>
> Frede Aakmann T?gersen
> Specialist, M.Sc., Ph.D.
> Plant Performance & Modeling
>
> Technology & Service Solutions
> T +45 9730 5135
> M +45 2547 6050
> frtog at vestas.com
> http://www.vestas.com
>
> Company reg. name: Vestas Wind Systems A/S
> This e-mail is subject to our e-mail disclaimer statement.
> Please refer to www.vestas.com/legal/notice
> If you have received this e-mail in error please contact the sender.
>
>
>
> -----Original Message-----
> From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Almut Schlaich - Werkgroep Grauwe Kiekendief
> Sent: 4. august 2015 10:37
> To: Adam Sparks
> Cc: r-sig-geo at r-project.org
> Subject: Re: [R-sig-Geo] plotKML - set color according to category
>
> Dear Adam,
>
> Thank you for your response!
> I run your script on the raster data and I think the requirements are
> the same. For my point data set I already have a colomn with a factorial
> variable (in this case the phases of the annual cylce) and the points
> are colored according to them.
>
> But imagine you would make maps of your raster data of two different
> countries, where the second one has different categories from the other
> (e.g. the second country could have values [13,14],
> (14,15],(15,16],(16,17] instead of [14,15],(15,16],(16,17],(17,18) for
> the Philippines). Then the plotKML would use the same four colors for
> these two maps, even though the values are not the same.
>
> Could you now also define that e.g. [13,14] is white, (14,15) light
> yellow and so on and use the same color for the same value in the
> different plots?
>
> Thanks again and kind regards,
> Almut
>
> Am 8/4/2015 um 7:09 AM schrieb Adam Sparks:
>> Dear Almut,
>> I've done this with raster data, but not points as you are describing.
>> If you convert to a factor and then cut the data, it is possible to
>> create a KML as you are describing. Towards the end of a script that I
>> put together for the Manila R User Group there's some code that may help.
>>
>> https://github.com/adamhsparks/Philippine_R_User_Group/tree/master
>>
>>
>>
>> On Wed, Jul 29, 2015 at 11:12 PM, Almut Schlaich - Werkgroep Grauwe
>> Kiekendief <almut.schlaich at grauwekiekendief.nl
>> <mailto:almut.schlaich at grauwekiekendief.nl>> wrote:
>>
>>      Dear Dr. Hengl,
>>
>>      First of all, I would like to thank you and your colleagues for
>>      the great package plotKML that I really enjoy using.
>>      This was indeed a missing link to visualize data, in our case
>>      tracking data, in Google Earth to easily explore them visually.
>>
>>      I would like to ask you a question about the possibilities to
>>      color the points according to a variable.
>>      In my data table I have a column with classification category
>>      "phase" (e.g. migration, stopover, breeding, wintering etc.).
>>      Using e.g.:
>>      kml_layer(data,colour=phase,colour_scale=worldgrids_pal[[4]]), I
>>      get tracks nicely colored depending on category.
>>
>>      But the difficulty arises when one bird has less levels of the
>>      category than another (e.g. one bird making no stopover).
>>      In this case the same colors are used, but for different values of
>>      the category, just in the order of first appearance.
>>      To easily compare tracks between individuals I would like to color
>>      the same category always in the same color. I tried to
>>      define the colors for each category and give the column with a
>>      color value per point to the kml_layer function, but this
>>      didn't work. Is it possible to determine the color of each point?
>>
>>      At the moment I just use the combination of kml_open, kml_layer
>>      and kml_close to produce the output.
>>      Unfortuntely, the much more beautiful and handy plotKML for
>>      Space-time Trajectory Data Frames doesn't work for the
>>      tracks since they have too many points. Could you tell me what is
>>      the limit for this? And might it be possible for more
>>      points in near future?
>>
>>      Thank you in advance for your help!
>>
>>      Kind regards,
>>      Almut Schlaich
>>
>>      --
>>      Almut Schlaich
>>
>>      Werkgroep Grauwe Kiekendief
>>      telefoon: +31(0)650459766
>>      e-mail: almut.schlaich at grauwekiekendief.nl
>>      <mailto:almut.schlaich at grauwekiekendief.nl>
>>      postadres: Postbus 46, 9679 ZG Scheemda
>>      www.grauwekiekendief.nl <http://www.grauwekiekendief.nl>
>>      twitter: @grauwekiek
>>      facebook:
>>      www.facebook.com/pages/Werkgroep-Grauwe-Kiekendief/190585087622000
>>      <http://www.facebook.com/pages/Werkgroep-Grauwe-Kiekendief/190585087622000>
>>
>>      _______________________________________________
>>      R-sig-Geo mailing list
>>      R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>>      https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>>
>>
>> -- 
>> --
>> Adam Sparks
>> Plant Disease Management Specialist
>> IRRI
>> DAPO Box 7777, Metro Manila, Philippines
>> ph: +63(2) 580-5600 ext 2753
>>
>> @adamhsparks <https://twitter.com/adamhsparks>

-- 
Almut Schlaich

Werkgroep Grauwe Kiekendief
telefoon: +31(0)650459766
e-mail: almut.schlaich at grauwekiekendief.nl
postadres: Postbus 46, 9679 ZG Scheemda
www.grauwekiekendief.nl
twitter: @grauwekiek
facebook: www.facebook.com/pages/Werkgroep-Grauwe-Kiekendief/190585087622000


From Drew.Mueller at colostate.edu  Tue Aug  4 17:14:52 2015
From: Drew.Mueller at colostate.edu (Mueller,Drew)
Date: Tue, 4 Aug 2015 15:14:52 +0000
Subject: [R-sig-Geo] question about nb2listw row standardization
Message-ID: <5CB53817-FA73-4024-A18B-FB511D7E1E4D@colostate.edu>

I was hoping for a clarification on the row standardization of nb2listw.  I have implemented a nb list based on distance, and a function

dlist <- nbdists(col.gal.nb, coords)
dlist <- lapply(dlist, function(x) 1/x)

my question is, if I call

Wa <- nb2listw(x, glist = dlist, style = "W")
Wb <- nb2listw(x, glist = dlist, stlye = "B")

is Wa then row standardized based on inverse distance or does the glist override this and I get actual undstandardized inverse distance weights?  Also, would Wb actually be binary, or does the glist argument override this to make the weights 1/x instead of 1's and 0's?  If my goal is to maintain the actual inverse distance weight without standardization (for better economic interpretation), does Wb give me an unstandardized W, or do I need to call a different function to avoid row standardization?  If my goal IS to row standardize a weights matrix with weights based on inverse distance, then is Wa the correct function call?  Mainly I was having trouble interpreting the help file for nb2listw as to whether style = "B"  always creates 1's and 0's regardless of what glist is set to.  Thanks

Drew

	[[alternative HTML version deleted]]


From Roger.Bivand at nhh.no  Tue Aug  4 21:53:00 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 4 Aug 2015 21:53:00 +0200
Subject: [R-sig-Geo] question about nb2listw row standardization
In-Reply-To: <5CB53817-FA73-4024-A18B-FB511D7E1E4D@colostate.edu>
References: <5CB53817-FA73-4024-A18B-FB511D7E1E4D@colostate.edu>
Message-ID: <alpine.LFD.2.20.1508042144420.8335@reclus.nhh.no>

On Tue, 4 Aug 2015, Mueller,Drew wrote:

> I was hoping for a clarification on the row standardization of nb2listw. 
> I have implemented a nb list based on distance, and a function
>
> dlist <- nbdists(col.gal.nb, coords)
> dlist <- lapply(dlist, function(x) 1/x)
>
> my question is, if I call
>
> Wa <- nb2listw(x, glist = dlist, style = "W")
> Wb <- nb2listw(x, glist = dlist, stlye = "B")
>
> is Wa then row standardized based on inverse distance or does the glist 
> override this and I get actual undstandardized inverse distance weights? 
> Also, would Wb actually be binary, or does the glist argument override 
> this to make the weights 1/x instead of 1's and 0's?  If my goal is to 
> maintain the actual inverse distance weight without standardization (for 
> better economic interpretation), does Wb give me an unstandardized W, or 
> do I need to call a different function to avoid row standardization? 
> If my goal IS to row standardize a weights matrix with weights based on 
> inverse distance, then is Wa the correct function call?  Mainly I was 
> having trouble interpreting the help file for nb2listw as to whether 
> style = "B"  always creates 1's and 0's regardless of what glist is set 
> to.  Thanks

Please do check:

library(spdep)
example(columbus)
coords <- coordinates(columbus)
dlist <- nbdists(col.gal.nb, coords)
dlist <- lapply(dlist, function(x) 1/x)
Wa <- nb2listw(col.gal.nb, glist = dlist, style = "W")
Wb <- nb2listw(col.gal.nb, glist = dlist, style = "B")
summary(sapply(Wa$weights, sum))
summary(sapply(Wb$weights, sum))

"W" row standardises the general weights, "B" passes through general 
weights. IDW are perverse, and without - contrary to your assertion - 
economic meaning, because the scaling depends closely on the metric of 
the coordinates:

summary(unlist(dlist))

are all < 1.

Roger

>
> Drew
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From jon.skoien at jrc.ec.europa.eu  Tue Aug  4 14:55:17 2015
From: jon.skoien at jrc.ec.europa.eu (Jon Skoien)
Date: Tue, 04 Aug 2015 14:55:17 +0200
Subject: [R-sig-Geo] help: krigged map do not show colours
In-Reply-To: <CAM7+9EsbqjfbNHVfpduba7vxc4DUbKqq-xy82xD+hUXpd3fgmg@mail.gmail.com>
References: <CAM7+9Ev+fxq1b-LAr71YQgU2qqznR7BE3E2KW=NZ8iQ4O5v0DA@mail.gmail.com>
	<CAHT1vpiwYQJfwyoLzKT23Y0ivzRV4RdqD3qA7eQQbb-kbWO_0Q@mail.gmail.com>
	<CAM7+9EukEdNVEaM35cagYP0wTCbjxFWcXNhGsTK-0MxnHvCUaA@mail.gmail.com>
	<55C08841.6020403@jrc.ec.europa.eu>
	<CAM7+9EsbqjfbNHVfpduba7vxc4DUbKqq-xy82xD+hUXpd3fgmg@mail.gmail.com>
Message-ID: <55C0B635.1010307@jrc.ec.europa.eu>

Anand,

I could not open your .grd file in R, I think the .gri file is missing.
However, looking at it in a text editor, and comparing with your 
R-script, it seems something went wrong with your projections. Your 
.csv-file has LatLong coordinates, but you are setting the projection to 
"+proj=utm +zone=40 +south +datum=WGS84 +units=m +no_defs +ellps=WGS84 
+towgs84=0,0,0", the same as you seem to have in your prediction raster. 
But you need to reproject your observations in this case.

# First set the right projection:
proj4string(carbon_seq) <- CRS("+init=epsg4326") # epsg-code for latlong
# Then transform
carbon_seq = spTransform(carbon_seq, CRS("+proj=utm +zone=40 +south 
+datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0"))

If you do this, your prediction grid should overlap your observations, 
and the colors should reflect your color ramp. What you essentially did 
before was to make a prediction thousands of km away from your 
observations, and then all values will be the same.

Best wishes,
Jon


On 8/4/2015 12:48 PM, Anand Sookun wrote:
> Dear Jon and Roman
>
> Thanks for the reply.
>
> Im attaching the code.
>
> You may be right that the variogram may be problematic but it fitted
> well visually.
>
> I think also that the prediction grid was not well created. I wiould be
> grateful to have to hints.code how to create a useful grid and also for
> the spplot or other alternatives
>
> I can send more info if required.
>
> Cheers
>
> Anand
>
> On Tue, Aug 4, 2015 at 1:39 PM, Jon Skoien <jon.skoien at jrc.ec.europa.eu
> <mailto:jon.skoien at jrc.ec.europa.eu>> wrote:
>
>     Hi,
>
>     You have attached some data, but we still dont know exactly what you
>     do with the data (do you use the logarithm, how many bins, did you
>     project the data set...?). However, having had a quick look using
>     the LatLong coordinates (not really recommended), I can see that the
>     variogram from this data set is not particularly well defined, and
>     it could well be that you fitted a model with pure nugget effect. In
>     that case you will get the same prediction everywhere and no color
>     differences.
>
>     Have a look at
>      > summary(map)
>     and particularly the summary of var1.pred.
>     You could also plot the variogram of the data together with your
>     model, vmf, and see how they fit.
>
>     I am not sure what you mean by not being able to create a prediction
>     grid with data included. Do you mean that you want a grid which
>     exactly overlays some of the data points? Matching one point should
>     not be difficult, 2 and 3 should be possible, but you might get some
>     problems with precision (FAQ 7.31).
>
>     Best wishes,
>     Jon
>
>
>
>
>     On 8/3/2015 5:30 PM, Anand Sookun wrote:
>>     Hi
>>
>>     Thank you Roman for your kind response.
>>
>>     The data is as attached which is part of the whole dataset.
>>
>>     My other problem is that im not able to create an appropriate
>>     prediction grid with some data included.
>>
>>     The codes which failed to show colour ramps are
>>
>>     map <- krige(logcarbseq ~ 1, locations = carbon_seq, newdata =
>>     map,model = vmf)
>>     str(map)
>>     print(spplot(map, "var1.pred", asp=1,
>>     col.regions=bpy.colors(64),main="OK prediction, carbon"))
>>     print(spplot(map, "var1.var",col.regions=cm.colors(64),asp=1,
>>     main="OK prediction variance, carbon"))
>>
>>     I look forward to hopefully get some solutions.
>>
>>     Thanks again and warm regards
>>
>>     Anand
>>
>>     On Mon, Aug 3, 2015 at 4:09 PM, Roman Lu?trik
>>     <roman.lustrik at gmail.com <mailto:roman.lustrik at gmail.com>> wrote:
>>
>>         What is the variability of the plotted variable?
>>
>>         Cheers,
>>         Roman
>>
>>         On Sun, Aug 2, 2015 at 11:03 AM, Anand Sookun
>>         <<mailto:asookun at gmail.com>asookun at gmail.com
>>         <mailto:asookun at gmail.com>> wrote:
>>
>>             Hi
>>
>>             I have kriged my data but the map shows uniform colours -
>>             no gradual
>>             contour colour plot on map
>>
>>             code: print(spplot(k40, "var1.pred", asp=1,
>>             col.regions=bpy.colors(64),main="OK prediction, log-ppm Zn"))
>>
>>             thnaks for any help
>>
>>             Anand Sookun
>>             --
>>             -------------------------------------------------------
>>             *Anand Sookun (**MPhil. **PhD Candidate, University of
>>             Mauritius)*
>>             *Director cum Freelance Consultant*
>>             *Soft Sustainable Services (Mauritius)*
>>             *Research and Consultancy*
>>
>>             Website: http://sustain-ability.webs.com/
>>
>>
>>             https://www.linkedin.com/profile/view?id=161468467&trk=nav_responsive_tab_profile_pic
>>
>>                     [[alternative HTML version deleted]]
>>
>>             _______________________________________________
>>             R-sig-Geo mailing list
>>             R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>>             https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>>
>>
>>         --
>>         In God we trust, all others bring data.
>>
>>
>>
>>
>>     --
>>     -------------------------------------------------------
>>     /*Anand Sookun (*//*MPhil. *//*PhD Candidate, University of
>>     Mauritius)*/
>>     /*Director cum Freelance Consultant*/
>>     /*Soft Sustainable Services (Mauritius)*/
>>     /*Research and Consultancy*/
>>
>>     Website:
>>     <http://sustain-ability.webs.com/>http://sustain-ability.webs.com/
>>
>>
>>     <https://www.linkedin.com/profile/view?id=161468467&trk=nav_responsive_tab_profile_pic>https://www.linkedin.com/profile/view?id=161468467&trk=nav_responsive_tab_profile_pic
>>
>>
>>
>>     _______________________________________________
>>     R-sig-Geo mailing list
>>     R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>>     https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>     --
>     Jon Olav Sk?ien
>     Joint Research Centre - European Commission
>     Institute for Environment and Sustainability (IES)
>     Climate Risk Management Unit
>
>     Via Fermi 2749, TP 100-01,  I-21027 Ispra (VA), ITALY
>
>     jon.skoien at jrc.ec.europa.eu <mailto:jon.skoien at jrc.ec.europa.eu>
>     Tel:+39 0332 789205 <tel:%2B39%200332%20789205>
>
>     Disclaimer: Views expressed in this email are those of the individual and do not necessarily represent official views of the European Commission.
>
>
>
>
> --
> -------------------------------------------------------
> /*Anand Sookun (*//*MPhil. *//*PhD Candidate, University of Mauritius)*/
> /*Director cum Freelance Consultant*/
> /*Soft Sustainable Services (Mauritius)*/
> /*Research and Consultancy*/
>
> Website: http://sustain-ability.webs.com/
>
>
> https://www.linkedin.com/profile/view?id=161468467&trk=nav_responsive_tab_profile_pic
>

-- 
Jon Olav Sk?ien
Joint Research Centre - European Commission
Institute for Environment and Sustainability (IES)
Climate Risk Management Unit

Via Fermi 2749, TP 100-01,  I-21027 Ispra (VA), ITALY

jon.skoien at jrc.ec.europa.eu
Tel:  +39 0332 789205

Disclaimer: Views expressed in this email are those of the individual 
and do not necessarily represent official views of the European Commission.


From roman.lustrik at gmail.com  Tue Aug  4 11:06:40 2015
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Tue, 4 Aug 2015 11:06:40 +0200
Subject: [R-sig-Geo] help: krigged map do not show colours
In-Reply-To: <CAM7+9EukEdNVEaM35cagYP0wTCbjxFWcXNhGsTK-0MxnHvCUaA@mail.gmail.com>
References: <CAM7+9Ev+fxq1b-LAr71YQgU2qqznR7BE3E2KW=NZ8iQ4O5v0DA@mail.gmail.com>
	<CAHT1vpiwYQJfwyoLzKT23Y0ivzRV4RdqD3qA7eQQbb-kbWO_0Q@mail.gmail.com>
	<CAM7+9EukEdNVEaM35cagYP0wTCbjxFWcXNhGsTK-0MxnHvCUaA@mail.gmail.com>
Message-ID: <CAHT1vpjkjK0_k0nb9ny9BY2CY17UJFgd0OgQ=n1uSQR=FOyLZA@mail.gmail.com>

Unfortunately we don't have access to all the variables you use in `krige`
call. Consider making a reproducible example.

Cheers,
Roman


On Mon, Aug 3, 2015 at 5:30 PM, Anand Sookun <asookun at gmail.com> wrote:

> Hi
>
> Thank you Roman for your kind response.
>
> The data is as attached which is part of the whole dataset.
>
> My other problem is that im not able to create an appropriate prediction
> grid with some data included.
>
> The codes which failed to show colour ramps are
>
> map <- krige(logcarbseq ~ 1, locations = carbon_seq, newdata = map,model =
> vmf)
> str(map)
> print(spplot(map, "var1.pred", asp=1, col.regions=bpy.colors(64),main="OK
> prediction, carbon"))
> print(spplot(map, "var1.var",col.regions=cm.colors(64),asp=1, main="OK
> prediction variance, carbon"))
>
> I look forward to hopefully get some solutions.
>
> Thanks again and warm regards
>
> Anand
>
> On Mon, Aug 3, 2015 at 4:09 PM, Roman Lu?trik <roman.lustrik at gmail.com>
> wrote:
>
>> What is the variability of the plotted variable?
>>
>> Cheers,
>> Roman
>>
>> On Sun, Aug 2, 2015 at 11:03 AM, Anand Sookun <asookun at gmail.com> wrote:
>>
>>> Hi
>>>
>>> I have kriged my data but the map shows uniform colours - no gradual
>>> contour colour plot on map
>>>
>>> code: print(spplot(k40, "var1.pred", asp=1,
>>> col.regions=bpy.colors(64),main="OK prediction, log-ppm Zn"))
>>>
>>> thnaks for any help
>>>
>>> Anand Sookun
>>> --
>>> -------------------------------------------------------
>>> *Anand Sookun (**MPhil. **PhD Candidate, University of Mauritius)*
>>> *Director cum Freelance Consultant*
>>> *Soft Sustainable Services (Mauritius)*
>>> *Research and Consultancy*
>>>
>>> Website: http://sustain-ability.webs.com/
>>>
>>>
>>>
>>> https://www.linkedin.com/profile/view?id=161468467&trk=nav_responsive_tab_profile_pic
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>>
>>
>> --
>> In God we trust, all others bring data.
>>
>
>
>
> --
> -------------------------------------------------------
> *Anand Sookun (**MPhil. **PhD Candidate, University of Mauritius)*
> *Director cum Freelance Consultant*
> *Soft Sustainable Services (Mauritius)*
> *Research and Consultancy*
>
> Website: http://sustain-ability.webs.com/
>
>
>
> https://www.linkedin.com/profile/view?id=161468467&trk=nav_responsive_tab_profile_pic
>
>


-- 
In God we trust, all others bring data.

	[[alternative HTML version deleted]]


From jon.skoien at jrc.ec.europa.eu  Tue Aug  4 11:39:13 2015
From: jon.skoien at jrc.ec.europa.eu (Jon Skoien)
Date: Tue, 04 Aug 2015 11:39:13 +0200
Subject: [R-sig-Geo] help: krigged map do not show colours
In-Reply-To: <CAM7+9EukEdNVEaM35cagYP0wTCbjxFWcXNhGsTK-0MxnHvCUaA@mail.gmail.com>
References: <CAM7+9Ev+fxq1b-LAr71YQgU2qqznR7BE3E2KW=NZ8iQ4O5v0DA@mail.gmail.com>
	<CAHT1vpiwYQJfwyoLzKT23Y0ivzRV4RdqD3qA7eQQbb-kbWO_0Q@mail.gmail.com>
	<CAM7+9EukEdNVEaM35cagYP0wTCbjxFWcXNhGsTK-0MxnHvCUaA@mail.gmail.com>
Message-ID: <55C08841.6020403@jrc.ec.europa.eu>

Hi,

You have attached some data, but we still dont know exactly what you do 
with the data (do you use the logarithm, how many bins, did you project 
the data set...?). However, having had a quick look using the LatLong 
coordinates (not really recommended), I can see that the variogram from 
this data set is not particularly well defined, and it could well be 
that you fitted a model with pure nugget effect. In that case you will 
get the same prediction everywhere and no color differences.

Have a look at
 > summary(map)
and particularly the summary of var1.pred.
You could also plot the variogram of the data together with your model, 
vmf, and see how they fit.

I am not sure what you mean by not being able to create a prediction 
grid with data included. Do you mean that you want a grid which exactly 
overlays some of the data points? Matching one point should not be 
difficult, 2 and 3 should be possible, but you might get some problems 
with precision (FAQ 7.31).

Best wishes,
Jon



On 8/3/2015 5:30 PM, Anand Sookun wrote:
> Hi
>
> Thank you Roman for your kind response.
>
> The data is as attached which is part of the whole dataset.
>
> My other problem is that im not able to create an appropriate 
> prediction grid with some data included.
>
> The codes which failed to show colour ramps are
>
> map <- krige(logcarbseq ~ 1, locations = carbon_seq, newdata = 
> map,model = vmf)
> str(map)
> print(spplot(map, "var1.pred", asp=1, 
> col.regions=bpy.colors(64),main="OK prediction, carbon"))
> print(spplot(map, "var1.var",col.regions=cm.colors(64),asp=1, main="OK 
> prediction variance, carbon"))
>
> I look forward to hopefully get some solutions.
>
> Thanks again and warm regards
>
> Anand
>
> On Mon, Aug 3, 2015 at 4:09 PM, Roman Lu?trik <roman.lustrik at gmail.com 
> <mailto:roman.lustrik at gmail.com>> wrote:
>
>     What is the variability of the plotted variable?
>
>     Cheers,
>     Roman
>
>     On Sun, Aug 2, 2015 at 11:03 AM, Anand Sookun <asookun at gmail.com
>     <mailto:asookun at gmail.com>> wrote:
>
>         Hi
>
>         I have kriged my data but the map shows uniform colours - no
>         gradual
>         contour colour plot on map
>
>         code: print(spplot(k40, "var1.pred", asp=1,
>         col.regions=bpy.colors(64),main="OK prediction, log-ppm Zn"))
>
>         thnaks for any help
>
>         Anand Sookun
>         --
>         -------------------------------------------------------
>         *Anand Sookun (**MPhil. **PhD Candidate, University of Mauritius)*
>         *Director cum Freelance Consultant*
>         *Soft Sustainable Services (Mauritius)*
>         *Research and Consultancy*
>
>         Website: http://sustain-ability.webs.com/
>
>
>         https://www.linkedin.com/profile/view?id=161468467&trk=nav_responsive_tab_profile_pic
>
>                 [[alternative HTML version deleted]]
>
>         _______________________________________________
>         R-sig-Geo mailing list
>         R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>         https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>
>
>     -- 
>     In God we trust, all others bring data.
>
>
>
>
> -- 
> -------------------------------------------------------
> /*Anand Sookun (*//*MPhil. *//*PhD Candidate, University of Mauritius)*/
> /*Director cum Freelance Consultant*/
> /*Soft Sustainable Services (Mauritius)*/
> /*Research and Consultancy*/
>
> Website: http://sustain-ability.webs.com/
>
>
> https://www.linkedin.com/profile/view?id=161468467&trk=nav_responsive_tab_profile_pic
>
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Jon Olav Sk?ien
Joint Research Centre - European Commission
Institute for Environment and Sustainability (IES)
Climate Risk Management Unit

Via Fermi 2749, TP 100-01,  I-21027 Ispra (VA), ITALY

jon.skoien at jrc.ec.europa.eu
Tel:  +39 0332 789205

Disclaimer: Views expressed in this email are those of the individual and do not necessarily represent official views of the European Commission.


	[[alternative HTML version deleted]]


From asookun at gmail.com  Tue Aug  4 12:48:41 2015
From: asookun at gmail.com (Anand Sookun)
Date: Tue, 4 Aug 2015 14:48:41 +0400
Subject: [R-sig-Geo] help: krigged map do not show colours
In-Reply-To: <55C08841.6020403@jrc.ec.europa.eu>
References: <CAM7+9Ev+fxq1b-LAr71YQgU2qqznR7BE3E2KW=NZ8iQ4O5v0DA@mail.gmail.com>
	<CAHT1vpiwYQJfwyoLzKT23Y0ivzRV4RdqD3qA7eQQbb-kbWO_0Q@mail.gmail.com>
	<CAM7+9EukEdNVEaM35cagYP0wTCbjxFWcXNhGsTK-0MxnHvCUaA@mail.gmail.com>
	<55C08841.6020403@jrc.ec.europa.eu>
Message-ID: <CAM7+9EsbqjfbNHVfpduba7vxc4DUbKqq-xy82xD+hUXpd3fgmg@mail.gmail.com>

Dear Jon and Roman

Thanks for the reply.

Im attaching the code.

You may be right that the variogram may be problematic but it fitted well
visually.

I think also that the prediction grid was not well created. I wiould be
grateful to have to hints.code how to create a useful grid and also for the
spplot or other alternatives

I can send more info if required.

Cheers

Anand

On Tue, Aug 4, 2015 at 1:39 PM, Jon Skoien <jon.skoien at jrc.ec.europa.eu>
wrote:

> Hi,
>
> You have attached some data, but we still dont know exactly what you do
> with the data (do you use the logarithm, how many bins, did you project the
> data set...?). However, having had a quick look using the LatLong
> coordinates (not really recommended), I can see that the variogram from
> this data set is not particularly well defined, and it could well be that
> you fitted a model with pure nugget effect. In that case you will get the
> same prediction everywhere and no color differences.
>
> Have a look at
> > summary(map)
> and particularly the summary of var1.pred.
> You could also plot the variogram of the data together with your model,
> vmf, and see how they fit.
>
> I am not sure what you mean by not being able to create a prediction grid
> with data included. Do you mean that you want a grid which exactly overlays
> some of the data points? Matching one point should not be difficult, 2 and
> 3 should be possible, but you might get some problems with precision (FAQ
> 7.31).
>
> Best wishes,
> Jon
>
>
>
>
> On 8/3/2015 5:30 PM, Anand Sookun wrote:
>
> Hi
>
> Thank you Roman for your kind response.
>
> The data is as attached which is part of the whole dataset.
>
> My other problem is that im not able to create an appropriate prediction
> grid with some data included.
>
> The codes which failed to show colour ramps are
>
> map <- krige(logcarbseq ~ 1, locations = carbon_seq, newdata = map,model =
> vmf)
> str(map)
> print(spplot(map, "var1.pred", asp=1, col.regions=bpy.colors(64),main="OK
> prediction, carbon"))
> print(spplot(map, "var1.var",col.regions=cm.colors(64),asp=1, main="OK
> prediction variance, carbon"))
>
> I look forward to hopefully get some solutions.
>
> Thanks again and warm regards
>
> Anand
>
> On Mon, Aug 3, 2015 at 4:09 PM, Roman Lu?trik <roman.lustrik at gmail.com>
> wrote:
>
>> What is the variability of the plotted variable?
>>
>> Cheers,
>> Roman
>>
>> On Sun, Aug 2, 2015 at 11:03 AM, Anand Sookun < <asookun at gmail.com>
>> asookun at gmail.com> wrote:
>>
>>> Hi
>>>
>>> I have kriged my data but the map shows uniform colours - no gradual
>>> contour colour plot on map
>>>
>>> code: print(spplot(k40, "var1.pred", asp=1,
>>> col.regions=bpy.colors(64),main="OK prediction, log-ppm Zn"))
>>>
>>> thnaks for any help
>>>
>>> Anand Sookun
>>> --
>>> -------------------------------------------------------
>>> *Anand Sookun (**MPhil. **PhD Candidate, University of Mauritius)*
>>> *Director cum Freelance Consultant*
>>> *Soft Sustainable Services (Mauritius)*
>>> *Research and Consultancy*
>>>
>>> Website: http://sustain-ability.webs.com/
>>>
>>>
>>>
>>> https://www.linkedin.com/profile/view?id=161468467&trk=nav_responsive_tab_profile_pic
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>>
>>
>> --
>> In God we trust, all others bring data.
>>
>
>
>
> --
> -------------------------------------------------------
> *Anand Sookun (**MPhil. **PhD Candidate, University of Mauritius)*
> *Director cum Freelance Consultant*
> *Soft Sustainable Services (Mauritius)*
> *Research and Consultancy*
>
> Website:  <http://sustain-ability.webs.com/>
> http://sustain-ability.webs.com/
>
>
>
> <https://www.linkedin.com/profile/view?id=161468467&trk=nav_responsive_tab_profile_pic>
> https://www.linkedin.com/profile/view?id=161468467&trk=nav_responsive_tab_profile_pic
>
>
>
> _______________________________________________
> R-sig-Geo mailing listR-sig-Geo at r-project.orghttps://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
> --
> Jon Olav Sk?ien
> Joint Research Centre - European Commission
> Institute for Environment and Sustainability (IES)
> Climate Risk Management Unit
>
> Via Fermi 2749, TP 100-01,  I-21027 Ispra (VA), ITALY
> jon.skoien at jrc.ec.europa.eu
> Tel:  +39 0332 789205
>
> Disclaimer: Views expressed in this email are those of the individual and do not necessarily represent official views of the European Commission.
>
>


-- 
-------------------------------------------------------
*Anand Sookun (**MPhil. **PhD Candidate, University of Mauritius)*
*Director cum Freelance Consultant*
*Soft Sustainable Services (Mauritius)*
*Research and Consultancy*

Website: http://sustain-ability.webs.com/


https://www.linkedin.com/profile/view?id=161468467&trk=nav_responsive_tab_profile_pic
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150804/dd6486be/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: To sig geoAug2015.R
Type: application/octet-stream
Size: 1783 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150804/dd6486be/attachment.obj>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: vca_raster.grd
Type: application/octet-stream
Size: 545 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150804/dd6486be/attachment-0001.obj>

From mauriziomarchi85 at gmail.com  Wed Aug  5 15:56:23 2015
From: mauriziomarchi85 at gmail.com (Maurizio Marchi)
Date: Wed, 5 Aug 2015 15:56:23 +0200
Subject: [R-sig-Geo] From spatial points to "spatial pictures"
Message-ID: <CANJhsN11rcxES=+6+ZnpMghkdStNF+uXeua9ZqU0fESQWHoTEQ@mail.gmail.com>

Hi everybody,
I'm maurizio Marchi and I'm working as a post-doc at the Forestry Research
Centre of Arezzo (Italy) and I have a question concerning spatial points
management.
During my research activities I have to collect data about the crown
projection on the ground of trees. The aim is to "measure" the crown area
and to draw a sort of picture on GIS software (QGIS in my case) to analyze
the area and the perimeter of the crowns compared to the "free area" of a
plot (generally a circular plot) to have an idea of how much photosynthetic
radiation is able to reach the soil. My working steps are:
1) During the survey on the field each crown of each tree is initially
"drawn" collecting 8 points that have to be connected to become a spatial
polygon:

###---example of table to be processed
TREE   POINT   X   Y
    1            1       x    y
    1            2       x    y
    1            3       x    y
    1            4       x    y
    1            5       x    y
    1            6       x    y
    1            7       x    y
    1            8       x    y
    2            1       x    y
    2            2       x    y
    2            3       x    y
    2            4       x    y
    2            5       x    y
    2            6       x    y
    2            7       x    y
    2            8       x    y
[......................................]
    N            8       x    y

2) the points,sorted by Tree become the vertices of the polygons

3) The polygons have to be processed to obtain a smoothed polygons,
circumscribing the polygonal crowns (e.g.
http://grasswiki.osgeo.org/wiki/V.generalize_tutorial)

I generally do it on QGIS and GRASS but is there something more appropriate
on R to do this? for example with rgdal or sp package?

Many thanks


-- 
Maurizio Marchi
Calenzano (FI) - Italy
ID Skype: maurizioxyz
Ubuntu 14.04 LTS
linux user 552742

	[[alternative HTML version deleted]]


From asookun at gmail.com  Wed Aug  5 16:09:47 2015
From: asookun at gmail.com (Anand Sookun)
Date: Wed, 5 Aug 2015 18:09:47 +0400
Subject: [R-sig-Geo] help: krigged map do not show colours
In-Reply-To: <55C1C46C.5010906@jrc.ec.europa.eu>
References: <CAM7+9Ev+fxq1b-LAr71YQgU2qqznR7BE3E2KW=NZ8iQ4O5v0DA@mail.gmail.com>
	<CAHT1vpiwYQJfwyoLzKT23Y0ivzRV4RdqD3qA7eQQbb-kbWO_0Q@mail.gmail.com>
	<CAM7+9EukEdNVEaM35cagYP0wTCbjxFWcXNhGsTK-0MxnHvCUaA@mail.gmail.com>
	<55C08841.6020403@jrc.ec.europa.eu>
	<CAM7+9EsbqjfbNHVfpduba7vxc4DUbKqq-xy82xD+hUXpd3fgmg@mail.gmail.com>
	<55C0B635.1010307@jrc.ec.europa.eu>
	<CAM7+9EvWDYYuL8zWvbJngufawxYdKQdrZDFPs2KoiqcntGM77Q@mail.gmail.com>
	<55C1BCE3.9040001@jrc.ec.europa.eu>
	<CAM7+9EthTE+yr=PUTW1XGB5DzY+vsSzReO5gy3JdGJdsTU5niQ@mail.gmail.com>
	<55C1C46C.5010906@jrc.ec.europa.eu>
Message-ID: <CAM7+9Evf4t-c+TcZonPXrGG5Sk6B0Gu=6bDyijNgqRJcimU7=Q@mail.gmail.com>

Dear Jon

I have to thank you so much for solving this issue. I did't notice that
there was a projection and grid problem.

I hope I would be able to move forward with my analysis with R and perhaps
still need your kind and much appreciated help.

Cheers

Anand

On Wed, Aug 5, 2015 at 12:08 PM, Jon Skoien <jon.skoien at jrc.ec.europa.eu>
wrote:

> Good.
> For the next function, I think you are trying to use an sp-function
> (gridded) on a raster object. You can convert between these, but not
> necessarily use the same functions. Use
> spgrid = rasterToPoints(YourRaster, spatial = TRUE)
> gridded(spgrid) = TRUE
> if you want to convert your raster layer to a spatial object.
>
> Best wishes,
> Jon
>
>
>
> On 8/5/2015 10:00 AM, Anand Sookun wrote:
>
> Dear John
>
> Thanks again.
> this time it worked but the variogram is not plotting well and some other
> problems croped.
> Error in (function (classes, fdef, mtable)  :
>   unable to find an inherited method for function ?gridded? for signature
> ?"RasterLayer"
>
> I will try by looking closely at the scripts and be back to you soon
>
> Best Wishes
>
> Anand
>
> On Wed, Aug 5, 2015 at 11:36 AM, Jon Skoien <jon.skoien at jrc.ec.europa.eu>
> wrote:
>
>> Dear Anand
>>
>> On 8/5/2015 9:03 AM, Anand Sookun wrote:
>>
>> Dear John
>>
>> Greetings
>>
>> I really appreciate your help. Itried what you proposed but got stuck
>> with the following:
>>
>> > proj4string(carbon_seq) <- CRS("+init=epsg 4326") # epsg-code for
>> latlong
>> Error in CRS("+init=epsg 4326") : no colon in init= string
>>
>> Sorry, there is a : missing, should be
>> CRS("+init=epsg:4326")
>>
>> See if it works better!
>> Jon
>>
>>
>> Also I TRIED AGAIN
>> > proj4string(carbon_seq) <- CRS("+init=epsg4326") # epsg-code for latlong
>> Error in (function (classes, fdef, mtable)  :
>>   unable to find an inherited method for function ?proj4string<-? for
>> signature ?"data.frame", "CRS"
>>
>> I tried with rgdal but got the same eror
>> > require(rgdal)
>> Loading required package: rgdal
>> rgdal: version: 0.8-16, (SVN revision 498)
>> Geospatial Data Abstraction Library extensions to R successfully loaded
>> Loaded GDAL runtime: GDAL 1.10.1, released 2013/08/26
>> Path to GDAL shared files:
>> C:/Users/Anand/Documents/R/win-library/3.0/rgdal/gdal
>> GDAL does not use iconv for recoding strings.
>> Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
>> Path to PROJ.4 shared files:
>> C:/Users/Anand/Documents/R/win-library/3.0/rgdal/proj
>>
>>
>> im attacing the gri file.
>>
>> Thanks for your time.
>>
>> CHEERS
>>
>> ANAND
>>
>> On Tue, Aug 4, 2015 at 4:55 PM, Jon Skoien <
>> <jon.skoien at jrc.ec.europa.eu>jon.skoien at jrc.ec.europa.eu> wrote:
>>
>>> Anand,
>>>
>>> I could not open your .grd file in R, I think the .gri file is missing.
>>> However, looking at it in a text editor, and comparing with your
>>> R-script, it seems something went wrong with your projections. Your
>>> .csv-file has LatLong coordinates, but you are setting the projection to
>>> "+proj=utm +zone=40 +south +datum=WGS84 +units=m +no_defs +ellps=WGS84
>>> +towgs84=0,0,0", the same as you seem to have in your prediction raster.
>>> But you need to reproject your observations in this case.
>>>
>>> # First set the right projection:
>>> proj4string(carbon_seq) <- CRS("+init=epsg4326") # epsg-code for latlong
>>> # Then transform
>>> carbon_seq = spTransform(carbon_seq, CRS("+proj=utm +zone=40 +south
>>> +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0"))
>>>
>>> If you do this, your prediction grid should overlap your observations,
>>> and the colors should reflect your color ramp. What you essentially did
>>> before was to make a prediction thousands of km away from your
>>> observations, and then all values will be the same.
>>>
>>> Best wishes,
>>> Jon
>>>
>>>
>>> On 8/4/2015 12:48 PM, Anand Sookun wrote:
>>>
>>>> Dear Jon and Roman
>>>>
>>>> Thanks for the reply.
>>>>
>>>> Im attaching the code.
>>>>
>>>> You may be right that the variogram may be problematic but it fitted
>>>> well visually.
>>>>
>>>> I think also that the prediction grid was not well created. I wiould be
>>>> grateful to have to hints.code how to create a useful grid and also for
>>>> the spplot or other alternatives
>>>>
>>>> I can send more info if required.
>>>>
>>>> Cheers
>>>>
>>>> Anand
>>>>
>>>> On Tue, Aug 4, 2015 at 1:39 PM, Jon Skoien <jon.skoien at jrc.ec.europa.eu
>>>> <mailto:jon.skoien at jrc.ec.europa.eu>> wrote:
>>>>
>>>>     Hi,
>>>>
>>>>     You have attached some data, but we still dont know exactly what you
>>>>     do with the data (do you use the logarithm, how many bins, did you
>>>>     project the data set...?). However, having had a quick look using
>>>>     the LatLong coordinates (not really recommended), I can see that the
>>>>     variogram from this data set is not particularly well defined, and
>>>>     it could well be that you fitted a model with pure nugget effect. In
>>>>     that case you will get the same prediction everywhere and no color
>>>>     differences.
>>>>
>>>>     Have a look at
>>>>      > summary(map)
>>>>     and particularly the summary of var1.pred.
>>>>     You could also plot the variogram of the data together with your
>>>>     model, vmf, and see how they fit.
>>>>
>>>>     I am not sure what you mean by not being able to create a prediction
>>>>     grid with data included. Do you mean that you want a grid which
>>>>     exactly overlays some of the data points? Matching one point should
>>>>     not be difficult, 2 and 3 should be possible, but you might get some
>>>>     problems with precision (FAQ 7.31).
>>>>
>>>>     Best wishes,
>>>>     Jon
>>>>
>>>>
>>>>
>>>>
>>>>     On 8/3/2015 5:30 PM, Anand Sookun wrote:
>>>>
>>>>>     Hi
>>>>>
>>>>>     Thank you Roman for your kind response.
>>>>>
>>>>>     The data is as attached which is part of the whole dataset.
>>>>>
>>>>>     My other problem is that im not able to create an appropriate
>>>>>     prediction grid with some data included.
>>>>>
>>>>>     The codes which failed to show colour ramps are
>>>>>
>>>>>     map <- krige(logcarbseq ~ 1, locations = carbon_seq, newdata =
>>>>>     map,model = vmf)
>>>>>     str(map)
>>>>>     print(spplot(map, "var1.pred", asp=1,
>>>>>     col.regions=bpy.colors(64),main="OK prediction, carbon"))
>>>>>     print(spplot(map, "var1.var",col.regions=cm.colors(64),asp=1,
>>>>>     main="OK prediction variance, carbon"))
>>>>>
>>>>>     I look forward to hopefully get some solutions.
>>>>>
>>>>>     Thanks again and warm regards
>>>>>
>>>>>     Anand
>>>>>
>>>>>     On Mon, Aug 3, 2015 at 4:09 PM, Roman Lu?trik
>>>>>     <roman.lustrik at gmail.com <mailto:roman.lustrik at gmail.com>> wrote:
>>>>>
>>>>>         What is the variability of the plotted variable?
>>>>>
>>>>>         Cheers,
>>>>>         Roman
>>>>>
>>>>>         On Sun, Aug 2, 2015 at 11:03 AM, Anand Sookun
>>>>>         <<mailto: <asookun at gmail.com>asookun at gmail.com>
>>>>> <asookun at gmail.com>asookun at gmail.com
>>>>>         <mailto: <asookun at gmail.com>asookun at gmail.com>> wrote:
>>>>>
>>>>>             Hi
>>>>>
>>>>>             I have kriged my data but the map shows uniform colours -
>>>>>             no gradual
>>>>>             contour colour plot on map
>>>>>
>>>>>             code: print(spplot(k40, "var1.pred", asp=1,
>>>>>             col.regions=bpy.colors(64),main="OK prediction, log-ppm
>>>>> Zn"))
>>>>>
>>>>>             thnaks for any help
>>>>>
>>>>>             Anand Sookun
>>>>>             --
>>>>>             -------------------------------------------------------
>>>>>             *Anand Sookun (**MPhil. **PhD Candidate, University of
>>>>>             Mauritius)*
>>>>>             *Director cum Freelance Consultant*
>>>>>             *Soft Sustainable Services (Mauritius)*
>>>>>             *Research and Consultancy*
>>>>>
>>>>>             Website: <http://sustain-ability.webs.com/>
>>>>> http://sustain-ability.webs.com/
>>>>>
>>>>>
>>>>>
>>>>> https://www.linkedin.com/profile/view?id=161468467&trk=nav_responsive_tab_profile_pic
>>>>>
>>>>>                     [[alternative HTML version deleted]]
>>>>>
>>>>>             _______________________________________________
>>>>>             R-sig-Geo mailing list
>>>>>             <R-sig-Geo at r-project.org>R-sig-Geo at r-project.org <mailto:
>>>>> R-sig-Geo at r-project.org>
>>>>>             https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>         --
>>>>>         In God we trust, all others bring data.
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>     --
>>>>>     -------------------------------------------------------
>>>>>     /*Anand Sookun (*//*MPhil. *//*PhD Candidate, University of
>>>>>     Mauritius)*/
>>>>>     /*Director cum Freelance Consultant*/
>>>>>     /*Soft Sustainable Services (Mauritius)*/
>>>>>     /*Research and Consultancy*/
>>>>>
>>>>>     Website:
>>>>>     <http://sustain-ability.webs.com/>
>>>>> <http://sustain-ability.webs.com/>http://sustain-ability.webs.com/
>>>>>
>>>>>
>>>>>     <
>>>>> https://www.linkedin.com/profile/view?id=161468467&trk=nav_responsive_tab_profile_pic
>>>>> >
>>>>> <https://www.linkedin.com/profile/view?id=161468467&trk=nav_responsive_tab_profile_pic>
>>>>> https://www.linkedin.com/profile/view?id=161468467&trk=nav_responsive_tab_profile_pic
>>>>>
>>>>>
>>>>>
>>>>>     _______________________________________________
>>>>>     R-sig-Geo mailing list
>>>>>     R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>>>>>     https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>
>>>>
>>>>     --
>>>>     Jon Olav Sk?ien
>>>>     Joint Research Centre - European Commission
>>>>     Institute for Environment and Sustainability (IES)
>>>>     Climate Risk Management Unit
>>>>
>>>>     Via Fermi 2749, TP 100-01,  I-21027 Ispra (VA), ITALY
>>>>
>>>>     jon.skoien at jrc.ec.europa.eu <mailto:jon.skoien at jrc.ec.europa.eu>
>>>>     Tel:+39 0332 789205 <%2B39%200332%20789205>
>>>> <tel:%2B39%200332%20789205> <%2B39%200332%20789205>
>>>>
>>>>     Disclaimer: Views expressed in this email are those of the
>>>> individual and do not necessarily represent official views of the European
>>>> Commission.
>>>>
>>>>
>>>>
>>>>
>>>> --
>>>> -------------------------------------------------------
>>>> /*Anand Sookun (*//*MPhil. *//*PhD Candidate, University of Mauritius)*/
>>>> /*Director cum Freelance Consultant*/
>>>> /*Soft Sustainable Services (Mauritius)*/
>>>> /*Research and Consultancy*/
>>>>
>>>> Website: http://sustain-ability.webs.com/
>>>>
>>>>
>>>>
>>>> https://www.linkedin.com/profile/view?id=161468467&trk=nav_responsive_tab_profile_pic
>>>>
>>>>
>>> --
>>> Jon Olav Sk?ien
>>> Joint Research Centre - European Commission
>>> Institute for Environment and Sustainability (IES)
>>> Climate Risk Management Unit
>>>
>>> Via Fermi 2749, TP 100-01,  I-21027 Ispra (VA), ITALY
>>>
>>> jon.skoien at jrc.ec.europa.eu
>>> Tel:  +39 0332 789205 <%2B39%200332%20789205>
>>>
>>> Disclaimer: Views expressed in this email are those of the individual
>>> and do not necessarily represent official views of the European Commission.
>>>
>>
>>
>>
>> --
>> -------------------------------------------------------
>> *Anand Sookun (**MPhil. **PhD Candidate, University of Mauritius)*
>> *Director cum Freelance Consultant*
>> *Soft Sustainable Services (Mauritius)*
>> *Research and Consultancy*
>>
>> Website:  <http://sustain-ability.webs.com/>
>> http://sustain-ability.webs.com/
>>
>>
>>
>> https://www.linkedin.com/profile/view?id=161468467&trk=nav_responsive_tab_profile_pic
>>
>>
>> --
>> Jon Olav Sk?ien
>> Joint Research Centre - European Commission
>> Institute for Environment and Sustainability (IES)
>> Climate Risk Management Unit
>>
>> Via Fermi 2749, TP 100-01,  I-21027 Ispra (VA), ITALY
>> jon.skoien at jrc.ec.europa.eu
>> Tel:  +39 0332 789205
>>
>> Disclaimer: Views expressed in this email are those of the individual and do not necessarily represent official views of the European Commission.
>>
>>
>
>
> --
> -------------------------------------------------------
> *Anand Sookun (**MPhil. **PhD Candidate, University of Mauritius)*
> *Director cum Freelance Consultant*
> *Soft Sustainable Services (Mauritius)*
> *Research and Consultancy*
>
> Website:  <http://sustain-ability.webs.com/>
> http://sustain-ability.webs.com/
>
>
>
> <https://www.linkedin.com/profile/view?id=161468467&trk=nav_responsive_tab_profile_pic>
> https://www.linkedin.com/profile/view?id=161468467&trk=nav_responsive_tab_profile_pic
>
>
> --
> Jon Olav Sk?ien
> Joint Research Centre - European Commission
> Institute for Environment and Sustainability (IES)
> Climate Risk Management Unit
>
> Via Fermi 2749, TP 100-01,  I-21027 Ispra (VA), ITALY
> jon.skoien at jrc.ec.europa.eu
> Tel:  +39 0332 789205
>
> Disclaimer: Views expressed in this email are those of the individual and do not necessarily represent official views of the European Commission.
>
>


-- 
-------------------------------------------------------
*Anand Sookun (**MPhil. **PhD Candidate, University of Mauritius)*
*Director cum Freelance Consultant*
*Soft Sustainable Services (Mauritius)*
*Research and Consultancy*

Website: http://sustain-ability.webs.com/


https://www.linkedin.com/profile/view?id=161468467&trk=nav_responsive_tab_profile_pic

	[[alternative HTML version deleted]]


From bob at rudis.net  Wed Aug  5 16:18:02 2015
From: bob at rudis.net (boB Rudis)
Date: Wed, 5 Aug 2015 10:18:02 -0400
Subject: [R-sig-Geo] From spatial points to "spatial pictures"
In-Reply-To: <CANJhsN11rcxES=+6+ZnpMghkdStNF+uXeua9ZqU0fESQWHoTEQ@mail.gmail.com>
References: <CANJhsN11rcxES=+6+ZnpMghkdStNF+uXeua9ZqU0fESQWHoTEQ@mail.gmail.com>
Message-ID: <CAJ4QxaNGZGTSQM1ZuXvvOqsDX=SD5G26oJqRA54QzPNr6WYFxQ@mail.gmail.com>

Can you provide a (small) real set of data (with real values for x & y)?

On Wed, Aug 5, 2015 at 9:56 AM, Maurizio Marchi
<mauriziomarchi85 at gmail.com> wrote:
> photosynthetic
> radiation


From bob at rudis.net  Wed Aug  5 17:33:28 2015
From: bob at rudis.net (boB Rudis)
Date: Wed, 5 Aug 2015 11:33:28 -0400
Subject: [R-sig-Geo] From spatial points to "spatial pictures"
In-Reply-To: <CANJhsN11rcxES=+6+ZnpMghkdStNF+uXeua9ZqU0fESQWHoTEQ@mail.gmail.com>
References: <CANJhsN11rcxES=+6+ZnpMghkdStNF+uXeua9ZqU0fESQWHoTEQ@mail.gmail.com>
Message-ID: <CAJ4QxaNkuHJGkKCOPT8YBnVj7LdxZUBHCr+fjzoABNa6xJGh_Q@mail.gmail.com>

Maurizio provided his data set offline. The code + data + sample plots
are in this gist:
https://gist.github.com/hrbrmstr/e29cf9138e480db9e67d

The data is just as he described it, so it's really just a matter of
creating some polygons from the the points spline interpolation:

    library(ggplot2)
    library(ggthemes)
    library(sp)

    #' Make smooth polys from points
    #'
    #' From: http://gis.stackexchange.com/a/24929/29544
    #'
    #' @param xy n x 2 matrix with n >= k
    #' @param k # of vertices to expand points to
    #' @param ... other args passed to \code{spline()}
    spline.poly <- function(xy, vertices, k=3, ...) {

      # Wrap k vertices around each end.
      n <- dim(xy)[1]
      if (k >= 1) {
        data <- rbind(xy[(n-k+1):n,], xy, xy[1:k, ])
      } else {
        data <- xy
      }

      # Spline the x and y coordinates.
      data.spline <- spline(1:(n+2*k), data[,1], n=vertices, ...)
      x <- data.spline$x
      x1 <- data.spline$y
      x2 <- spline(1:(n+2*k), data[,2], n=vertices, ...)$y

      # Retain only the middle part.
      cbind(x1, x2)[k < x & x <= n+k, ]
    }

    # read in the data
    trees <- read.csv("CrownsExample.csv")

    # sort data by tree & point
    trees <- trees[with(trees, order(TREE, POINT)),]

    # plot just points colored by tree to make sure points look ok
    ggplot(trees, aes(x=X, y=Y, color=factor(TREE))) + coord_equal() +
geom_point()

    # small function to avoid anonymous fnction in `by` make a polygon
from our points
    make_tree_poly <- function(tree) {
      tree_pts <- spline.poly(as.matrix(tree[, c("X", "Y")]), 100)
      Polygons(list(Polygon(tree_pts)), ID=unique(tree$TREE))
    }

    # for each tree, make a set of smoothed polygons then make the whole thing
    # a SpatialPolygonsDataFrame so more spatial ops can be done on it (or more
    # data stored with it)
    tree_polys <- SpatialPolygonsDataFrame(
      SpatialPolygons(unclass(by(trees, trees$TREE, make_tree_poly)),
                      proj4string=CRS("+proj=utm +zone=32 +ellps=GRS80
+units=m +no_defs ")),
      data.frame(id=unique(trees$TREE), row.names=unique(trees$TREE)))

    # plot the new polygon tree crowns colored by tree
    tree_map <- fortify(tree_polys)
    ggplot() +
      geom_map(data=tree_map, map=tree_map,
               aes(x=long, y=lat, fill=id, map_id=id, color=id)) +
      geom_point(data=trees, aes(x=X, y=Y)) + # original points just
to show it's accurate
      coord_equal() +
      theme_map()

On Wed, Aug 5, 2015 at 9:56 AM, Maurizio Marchi
<mauriziomarchi85 at gmail.com> wrote:
> Hi everybody,
> I'm maurizio Marchi and I'm working as a post-doc at the Forestry Research
> Centre of Arezzo (Italy) and I have a question concerning spatial points
> management.
> During my research activities I have to collect data about the crown
> projection on the ground of trees. The aim is to "measure" the crown area
> and to draw a sort of picture on GIS software (QGIS in my case) to analyze
> the area and the perimeter of the crowns compared to the "free area" of a
> plot (generally a circular plot) to have an idea of how much photosynthetic
> radiation is able to reach the soil. My working steps are:
> 1) During the survey on the field each crown of each tree is initially
> "drawn" collecting 8 points that have to be connected to become a spatial
> polygon:
>
> ###---example of table to be processed
> TREE   POINT   X   Y
>     1            1       x    y
>     1            2       x    y
>     1            3       x    y
>     1            4       x    y
>     1            5       x    y
>     1            6       x    y
>     1            7       x    y
>     1            8       x    y
>     2            1       x    y
>     2            2       x    y
>     2            3       x    y
>     2            4       x    y
>     2            5       x    y
>     2            6       x    y
>     2            7       x    y
>     2            8       x    y
> [......................................]
>     N            8       x    y
>
> 2) the points,sorted by Tree become the vertices of the polygons
>
> 3) The polygons have to be processed to obtain a smoothed polygons,
> circumscribing the polygonal crowns (e.g.
> http://grasswiki.osgeo.org/wiki/V.generalize_tutorial)
>
> I generally do it on QGIS and GRASS but is there something more appropriate
> on R to do this? for example with rgdal or sp package?
>
> Many thanks
>
>
> --
> Maurizio Marchi
> Calenzano (FI) - Italy
> ID Skype: maurizioxyz
> Ubuntu 14.04 LTS
> linux user 552742
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Scott.Waichler at pnnl.gov  Thu Aug  6 16:14:23 2015
From: Scott.Waichler at pnnl.gov (Waichler, Scott R)
Date: Thu, 6 Aug 2015 14:14:23 +0000
Subject: [R-sig-Geo] Problem installing rgeos
In-Reply-To: <alpine.LFD.2.20.1508041517050.30406@reclus.nhh.no>
References: <074C83DAD4825242A20B2D83FDBCB8881A059BD0@EX10MBOX03.pnnl.gov>
	<CAASFQpTnRRbN=XbaitBP3xCZxYhhm=VGBoH+xzKQaBeLxFbazw@mail.gmail.com>
	<074C83DAD4825242A20B2D83FDBCB8881A059ED6@EX10MBOX03.pnnl.gov>
	<CAASFQpQAJ8ZgLzH_9jtMwiGAQK8GjKGB4mMsfyNbEH_rEnazCw@mail.gmail.com>
	<alpine.LFD.2.20.1508041517050.30406@reclus.nhh.no>
Message-ID: <074C83DAD4825242A20B2D83FDBCB8881A05A2C6@EX10MBOX03.pnnl.gov>

Here is my OS and sessionInfo() output.  I will follow Roger's advice below and report back.

Red Hat Enterprise Linux Client release 5.11 (Tikanga)

> sessionInfo()
R version 3.2.1 (2015-06-18)
Platform: x86_64-unknown-linux-gnu (64-bit)

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
 [9] LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] lmomco_2.1.4 FAdist_2.1

loaded via a namespace (and not attached):
[1] tools_3.2.1

--Scott

> > I don't know that it will be applicable. Why don't you post your
> > sessionInfo() as this may be useful to others in the future.  Which
> > version of GEOS do you have installed?
> 
> The problem is almost certainly that the platform build train (compilers and
> libraries) which underlie all the other programs have been updated, as Chris
> has suggested (and we still do not know the OS version or output of
> sessionInfo()). This is neither a GEOS nor an rgeos problem. Most likely the
> C and C++ libraries have changed, leading to a need to re-install an unknown
> number of downstream components.
> 
> I suggest checking that you can install Rcpp from source (to test the build
> train). If there are problems, you should correct these first, by bringing your
> build train into reasonable order.
> 
> If you can, re-install GEOS from source (to freshen up its dependencies on
> the C and C++ libraries) and only when GEOS passes make check itself
> (ourside R), proceed to install rgeos. If you download the R source tarball of
> rgeos, and run R CMD check on it, you will get a full test of its
> state.?Following R CMD INSTALL, this should then work.
> 
> Roger
> 
> >
> > HTH
> > Chris
> >
> > On Mon, Aug 3, 2015 at 10:34 AM, Waichler, Scott R
> > <Scott.Waichler at pnnl.gov>
> > wrote:
> >
> >> Thanks for the suggestions, but I think what I need is help tracking
> >> down what the exact error is in the compilation.  Let me try again
> >> with the part of the output describing the error:
> >>
> >>> install.packages("rgeos", dependencies = F, repos = "
> >> http://cran.fhcrc.org/")
> >> . . .
> >> checking for C compiler default output file name... a.out checking
> >> for suffix of executables...
> >> checking whether we are cross compiling... configure: error: in
> >> `/tmp/RtmpUjYUle/R.INSTALL41c15690b9e1/rgeos':
> >> configure: error: cannot run C compiled programs.
> >> If you meant to cross compile, use `--host'.
> >> See `config.log' for more details
> >> ERROR: configuration failed for package 'rgeos'
> >> * removing '/files3/R/R-3.2.1_install/lib64/R/library/rgeos'
> >>
> >> It says I should refer to config.log for more details.  The only
> >> config.log file I can find in the directory tree is the one for geos,
> >> which I installed a couple of years ago, and did not give me problems
> >> with previous installations of rgeos under earlier releases of R.  In
> >> case there is a clue, here is the output in that config.log around
> >> the cross compile
> >> message:
> >>
> >> configure:3682: result:
> >> configure:3704: checking whether we are cross compiling
> >> configure:3712: gcc -o conftest    conftest.c  >&5
> >> configure:3716: $? = 0
> >> configure:3723: ./conftest
> >>
> >> Is there a config.log for the attempted rgeos installation?  Where
> >> would I find it?
> >>
> >>> You're build is failing pretty early in the configuration process
> >>> which suggests you are missing some tools in your development
> >>> environment.  The latest geos was found. Was that a binary or built
> >>> from source?  If from source you have the necessary tools in your
> >>> dev environment and it may merely be a function of dropping the
> >>> depends in you install.packages call....
> >>
> >> Rgeos was built from source.
> >>
> >> Thanks,
> >> Scott Waichler
> >> PNNL
> >>
> >
> > 	[[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> 
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics, Helleveien 30,
> N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 91 00
> e-mail: Roger.Bivand at nhh.no


From Scott.Waichler at pnnl.gov  Thu Aug  6 19:57:29 2015
From: Scott.Waichler at pnnl.gov (Waichler, Scott R)
Date: Thu, 6 Aug 2015 17:57:29 +0000
Subject: [R-sig-Geo] Problem installing rgeos
In-Reply-To: <alpine.LFD.2.20.1508041517050.30406@reclus.nhh.no>
References: <074C83DAD4825242A20B2D83FDBCB8881A059BD0@EX10MBOX03.pnnl.gov>
	<CAASFQpTnRRbN=XbaitBP3xCZxYhhm=VGBoH+xzKQaBeLxFbazw@mail.gmail.com>
	<074C83DAD4825242A20B2D83FDBCB8881A059ED6@EX10MBOX03.pnnl.gov>
	<CAASFQpQAJ8ZgLzH_9jtMwiGAQK8GjKGB4mMsfyNbEH_rEnazCw@mail.gmail.com>
	<alpine.LFD.2.20.1508041517050.30406@reclus.nhh.no>
Message-ID: <074C83DAD4825242A20B2D83FDBCB8881A05A30A@EX10MBOX03.pnnl.gov>

Problems solved.

First, on my system I reinstalled and ran ldconfig for the following software:  geos-2.4.2, proj-4.9.1 and gdal-2.0.0.  Within R I reinstalled Rcpp from source.  
Along the way I had to address other problems.  I deleted an empty directory called gdalplugins, and created a file /etc/ld.so.conf.d/gdal.conf with the line "/usr/local/lib" in it.  I could finally install rgdal with 

> install.packages("rgdal", dependencies = F, repos = "http://cran.fhcrc.org/", configure.args=c(rgdal='--with-gdal-lib=/usr/local/lib'))

and after that, I was also able to install rgeos.  I'm not implying that rgeos depends on rgdal, but the command 

R CMD check rgeos_0.3-11.tar.gz

brought up dependency errors that forced me to go back and get rgdal working first.  I may be forgetting some key steps that made this all work, if so, my apologies.  I hope I don't have to do it again!

--Scott

> The problem is almost certainly that the platform build train (compilers and
> libraries) which underlie all the other programs have been updated, as Chris
> has suggested (and we still do not know the OS version or output of
> sessionInfo()). This is neither a GEOS nor an rgeos problem. Most likely the
> C and C++ libraries have changed, leading to a need to re-install an unknown
> number of downstream components.
> 
> I suggest checking that you can install Rcpp from source (to test the build
> train). If there are problems, you should correct these first, by bringing your
> build train into reasonable order.
> 
> If you can, re-install GEOS from source (to freshen up its dependencies on
> the C and C++ libraries) and only when GEOS passes make check itself
> (ourside R), proceed to install rgeos. If you download the R source tarball of
> rgeos, and run R CMD check on it, you will get a full test of its
> state.?Following R CMD INSTALL, this should then work.
> 
> Roger
> 
> >
> > HTH
> > Chris
> >
> > On Mon, Aug 3, 2015 at 10:34 AM, Waichler, Scott R
> > <Scott.Waichler at pnnl.gov>
> > wrote:
> >
> >> Thanks for the suggestions, but I think what I need is help tracking
> >> down what the exact error is in the compilation.  Let me try again
> >> with the part of the output describing the error:
> >>
> >>> install.packages("rgeos", dependencies = F, repos = "
> >> http://cran.fhcrc.org/")
> >> . . .
> >> checking for C compiler default output file name... a.out checking
> >> for suffix of executables...
> >> checking whether we are cross compiling... configure: error: in
> >> `/tmp/RtmpUjYUle/R.INSTALL41c15690b9e1/rgeos':
> >> configure: error: cannot run C compiled programs.
> >> If you meant to cross compile, use `--host'.
> >> See `config.log' for more details
> >> ERROR: configuration failed for package 'rgeos'
> >> * removing '/files3/R/R-3.2.1_install/lib64/R/library/rgeos'
> >>
> >> It says I should refer to config.log for more details.  The only
> >> config.log file I can find in the directory tree is the one for geos,
> >> which I installed a couple of years ago, and did not give me problems
> >> with previous installations of rgeos under earlier releases of R.  In
> >> case there is a clue, here is the output in that config.log around
> >> the cross compile
> >> message:
> >>
> >> configure:3682: result:
> >> configure:3704: checking whether we are cross compiling
> >> configure:3712: gcc -o conftest    conftest.c  >&5
> >> configure:3716: $? = 0
> >> configure:3723: ./conftest
> >>
> >> Is there a config.log for the attempted rgeos installation?  Where
> >> would I find it?
> >>
> >>> You're build is failing pretty early in the configuration process
> >>> which suggests you are missing some tools in your development
> >>> environment.  The latest geos was found. Was that a binary or built
> >>> from source?  If from source you have the necessary tools in your
> >>> dev environment and it may merely be a function of dropping the
> >>> depends in you install.packages call....
> >>
> >> Rgeos was built from source.
> >>
> >> Thanks,
> >> Scott Waichler
> >> PNNL
> >>
> >
> > 	[[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> 
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics, Helleveien 30,
> N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 91 00
> e-mail: Roger.Bivand at nhh.no


From HAROLD at il.ibm.com  Thu Aug  6 21:43:16 2015
From: HAROLD at il.ibm.com (Harold-Jeffrey Ship)
Date: Thu, 6 Aug 2015 22:43:16 +0300
Subject: [R-sig-Geo] looking for data from ASDAR
Message-ID: <OF60503C11.0DBCCE05-ONC2257E99.006C1914-C2257E99.006C54AA@il.ibm.com>

Hi

I'm looking for data from Applied Spatial Data Analysis with R. In 
particular, I'm trying to run the examples in Chapter 7, on point 
processes and I'm looking for the asthma data. I am hoping to run try out 
the whole chapter. Is this data still available somewhere?

regards
Harold


Harold Ship - Software Engineering Research for Visual Analytics 

Phone: 972-4-828-1028 | Fax: 972-4-829-6116 | Mobile: 972-54-621-8120
E-mail: harold at il.ibm.com | Web:
http://researcher.watson.ibm.com/researcher/view.php?person=il-HAROLD
Haifa University Site, Mount Carmel, Haifa, 31905, Israel 


	[[alternative HTML version deleted]]


From SWalbridge at esri.com  Thu Aug  6 21:47:13 2015
From: SWalbridge at esri.com (Shaun Walbridge)
Date: Thu, 6 Aug 2015 19:47:13 +0000
Subject: [R-sig-Geo] looking for data from ASDAR
In-Reply-To: <OF60503C11.0DBCCE05-ONC2257E99.006C1914-C2257E99.006C54AA@il.ibm.com>
References: <OF60503C11.0DBCCE05-ONC2257E99.006C1914-C2257E99.006C54AA@il.ibm.com>
Message-ID: <D1E931A1.300A5%swalbridge@esri.com>

The website [1] has a zip archive, that looks to contain both the
data and code used:
  http://www.asdar-book.org/bundles2ed/sppa_bundle.zip

1.  http://www.asdar-book.org/data2ed.php?chapter=6

-- 
Shaun Walbridge
GIS Developer





On 8/6/15, 3:43 PM, "R-sig-Geo on behalf of Harold-Jeffrey Ship"
<r-sig-geo-bounces at r-project.org on behalf of HAROLD at il.ibm.com> wrote:

>Hi
>
>I'm looking for data from Applied Spatial Data Analysis with R. In
>particular, I'm trying to run the examples in Chapter 7, on point
>processes and I'm looking for the asthma data. I am hoping to run try out
>the whole chapter. Is this data still available somewhere?
>
>regards
>Harold
>
>
>Harold Ship - Software Engineering Research for Visual Analytics
>
>Phone: 972-4-828-1028 | Fax: 972-4-829-6116 | Mobile: 972-54-621-8120
>E-mail: harold at il.ibm.com | Web:
>http://researcher.watson.ibm.com/researcher/view.php?person=il-HAROLD
>Haifa University Site, Mount Carmel, Haifa, 31905, Israel
>
>
>	[[alternative HTML version deleted]]
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From af.ramirez.mejia at gmail.com  Fri Aug  7 00:35:05 2015
From: af.ramirez.mejia at gmail.com (Andres Felipe Ramirez Mejia)
Date: Thu, 6 Aug 2015 17:35:05 -0500
Subject: [R-sig-Geo] getKMLcoordinates - subscript out of bounds
Message-ID: <CAH+qOY=Sv8cWSxSHo0ycYuAHo5aD4yTnDOU8y_4MsvWLs22s7Q@mail.gmail.com>

 Dear all,

I've been working on a script to read KML file coordinates using
getKMLcoordinates from "maptools" package.

The tool reads the <coordinates> section of the KML/XML file.

file="example.kml"
kml=getKMLcoordinates(file, ignoreAltitude=TRUE)

I'm getting a "subscript out of bounds" error:

Error in m[, 1:2] : subscript out of bounds

The KML files have the <coordinates> section correctly arranged,  in
addition I'm getting warning messages

1: In readLines(kmlfile, encoding = "UTF-8") : invalid input found on input
connection 'file'
2: In readLines(kmlfile, encoding = "UTF-8") : incomplete final line found
on 'file'

I can't figure out what is the problem.

Felipe Ram?rez
GIS analyst and developer

	[[alternative HTML version deleted]]


From Roger.Bivand at nhh.no  Fri Aug  7 02:07:58 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 7 Aug 2015 02:07:58 +0200
Subject: [R-sig-Geo] getKMLcoordinates - subscript out of bounds
In-Reply-To: <CAH+qOY=Sv8cWSxSHo0ycYuAHo5aD4yTnDOU8y_4MsvWLs22s7Q@mail.gmail.com>
References: <CAH+qOY=Sv8cWSxSHo0ycYuAHo5aD4yTnDOU8y_4MsvWLs22s7Q@mail.gmail.com>
Message-ID: <alpine.LFD.2.20.1508070202410.16424@reclus.nhh.no>

On Fri, 7 Aug 2015, Andres Felipe Ramirez Mejia wrote:

> Dear all,
>
> I've been working on a script to read KML file coordinates using
> getKMLcoordinates from "maptools" package.

The function exists purely for historical reasons and should not be used 
if your rgdal package installation (so the underlying GDAL/OGR 
libraries) has the KML or libkml driver.

If anyone is still using it, let me know, otherwise it will be deprecated 
shortly and then made defunct.

Please do not post HTML mail.

Roger

>
> The tool reads the <coordinates> section of the KML/XML file.
>
> file="example.kml"
> kml=getKMLcoordinates(file, ignoreAltitude=TRUE)
>
> I'm getting a "subscript out of bounds" error:
>
> Error in m[, 1:2] : subscript out of bounds
>
> The KML files have the <coordinates> section correctly arranged,  in
> addition I'm getting warning messages
>
> 1: In readLines(kmlfile, encoding = "UTF-8") : invalid input found on input
> connection 'file'
> 2: In readLines(kmlfile, encoding = "UTF-8") : incomplete final line found
> on 'file'
>
> I can't figure out what is the problem.
>
> Felipe Ram?rez
> GIS analyst and developer
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no

From HAROLD at il.ibm.com  Fri Aug  7 05:09:08 2015
From: HAROLD at il.ibm.com (Harold-Jeffrey Ship)
Date: Fri, 7 Aug 2015 06:09:08 +0300
Subject: [R-sig-Geo] looking for data from ASDAR
In-Reply-To: <D1E931A1.300A5%swalbridge@esri.com>
References: <OF60503C11.0DBCCE05-ONC2257E99.006C1914-C2257E99.006C54AA@il.ibm.com>
	<D1E931A1.300A5%swalbridge@esri.com>
Message-ID: <OFE5EBF571.D60F0D1E-ONC2257E9A.001142A8-C2257E9A.001150D8@il.ibm.com>

Thanks!

regards
Harold


Shaun Walbridge <SWalbridge at esri.com> wrote on 08/06/2015 10:47:13 PM:

> 
> The website [1] has a zip archive, that looks to contain both the
> data and code used:
>   http://www.asdar-book.org/bundles2ed/sppa_bundle.zip
> 
> 1.  http://www.asdar-book.org/data2ed.php?chapter=6
> 
> -- 
> Shaun Walbridge
> GIS Developer
> 
> 

	[[alternative HTML version deleted]]


From mdsumner at gmail.com  Fri Aug  7 05:10:08 2015
From: mdsumner at gmail.com (Michael Sumner)
Date: Fri, 07 Aug 2015 03:10:08 +0000
Subject: [R-sig-Geo] densify geometries
Message-ID: <CAAcGz9-PhGi61megdHa-c_m8RyYRESNNQJn-0S7mTAeDRTUXUg@mail.gmail.com>

Hello, is there any existing function in the Spatial family in R to
"densify geometries"?

I'd like to be able specify the insertion of redundant vertices for all
individual segments within a Line* or Polygon*. I've done a bit myself but
wondering if this already exists somewhere.  This is a pretty standard task
for reprojection in traditional GIS. Ultimately I would implement a
"minimum distance" option as well, just wondering if this is already out
there somewhere.

I know there are partial pieces of this, for instance in
raster::rasterToPolygons and rgeos::gDistance - are there others? - but I
want more control.

Cheers, Mike.

	[[alternative HTML version deleted]]


From englishchristophera at gmail.com  Fri Aug  7 07:23:14 2015
From: englishchristophera at gmail.com (chris english)
Date: Fri, 7 Aug 2015 01:23:14 -0400
Subject: [R-sig-Geo] densify geometries
In-Reply-To: <CAAcGz9-PhGi61megdHa-c_m8RyYRESNNQJn-0S7mTAeDRTUXUg@mail.gmail.com>
References: <CAAcGz9-PhGi61megdHa-c_m8RyYRESNNQJn-0S7mTAeDRTUXUg@mail.gmail.com>
Message-ID: <CAASFQpSHD-jMdCV1tmhSeJwgvL6b7WyFL1C-3aH1_tMhR2+jpw@mail.gmail.com>

Mike,

I use rgeos::gBuffer for polygons akin to what you're seeking. Looking at
the implementation of the
quadsegs argument might aid you.  Don't know what to suggest for lines
though I'm thinking the
aggregation process in Trajectories might be of use.  I realize that
aggregation suggests reducing
rather than densifying but there many be an opportunity to inject arbitrary
'between' points to densify
to lines.
HTH. Chris

On Thu, Aug 6, 2015 at 11:10 PM, Michael Sumner <mdsumner at gmail.com> wrote:

> Hello, is there any existing function in the Spatial family in R to
> "densify geometries"?
>
> I'd like to be able specify the insertion of redundant vertices for all
> individual segments within a Line* or Polygon*. I've done a bit myself but
> wondering if this already exists somewhere.  This is a pretty standard task
> for reprojection in traditional GIS. Ultimately I would implement a
> "minimum distance" option as well, just wondering if this is already out
> there somewhere.
>
> I know there are partial pieces of this, for instance in
> raster::rasterToPolygons and rgeos::gDistance - are there others? - but I
> want more control.
>
> Cheers, Mike.
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From adeela.uaf at gmail.com  Fri Aug  7 11:31:49 2015
From: adeela.uaf at gmail.com (adeela uaf)
Date: Fri, 7 Aug 2015 14:31:49 +0500
Subject: [R-sig-Geo] Fwd: wave variogram
In-Reply-To: <CABGg3O5_wcm0u7YrhWLAJ3RrsyYHT5+LNYcD9hs1Rv95qqjiWQ@mail.gmail.com>
References: <CABGg3O5_wcm0u7YrhWLAJ3RrsyYHT5+LNYcD9hs1Rv95qqjiWQ@mail.gmail.com>
Message-ID: <CABGg3O7p++P3JBXcDwfiEcxewAiE5BbPQT9VAswb0eMS8EBSGw@mail.gmail.com>

Hi all,
I want to do spectral analysis on the attached data set on Cd15( cadmium
taken from 15 cm soil depth) I use the following commands to check
anisotropy and it seems that there is no anisotropy. But, I am much
confused about how to fit wave variogram model for my data set so that I
can use it for interpolation. There is no much literature available on
periodic variogram and further analysis.
library(sp)
library(gstat)
coordinates(mt)<-~XCORD+YCORD
variogram(Cd15~XCORD+YCORD,mt, alpha=c(0,45,90,135))
plot(variogram(Cd15~XCORD+YCORD,mt, alpha=c(0,45,90,135)),type="b")

Please suggest any solution for this.
Regards
Adeela
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150807/82fe16b8/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: mt.csv
Type: text/csv
Size: 1304 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150807/82fe16b8/attachment.bin>

From mdsumner at gmail.com  Fri Aug  7 15:30:38 2015
From: mdsumner at gmail.com (Michael Sumner)
Date: Fri, 07 Aug 2015 13:30:38 +0000
Subject: [R-sig-Geo] densify geometries
In-Reply-To: <CAASFQpSHD-jMdCV1tmhSeJwgvL6b7WyFL1C-3aH1_tMhR2+jpw@mail.gmail.com>
References: <CAAcGz9-PhGi61megdHa-c_m8RyYRESNNQJn-0S7mTAeDRTUXUg@mail.gmail.com>
	<CAASFQpSHD-jMdCV1tmhSeJwgvL6b7WyFL1C-3aH1_tMhR2+jpw@mail.gmail.com>
Message-ID: <CAAcGz9_uztE2kXHhz_5JnLmLBSiC_LjFA+qb48yTyVRqJ_qosw@mail.gmail.com>

This is a nice idea with gBuffer, but testing on a simple case shows you
need explicit curvature to get any extra verts.

library(rgeos)
library(raster) ## just for the "cheat's" polygon creator
 x <- as(extent(0, 1, 0, 1), "SpatialPolygons")
plot(as(as(gBuffer(x, width = 0.1, quadsegs = 55), "SpatialLines"),
"SpatialPoints"))


I want the extra vertices for curvature that's in the space traversed, not
defined by the segment.

Ultimately we need it to be driven by the right curve (great circle,
loxodrome, etc.) so geosphere is a good start - but still the simplest case
of inserting explicitly seems like an obvious gap here (pardon the pun),
even for GEOS?

Cheers, Mike.


On Fri, 7 Aug 2015 at 15:23 chris english <englishchristophera at gmail.com>
wrote:

> Mike,
>
> I use rgeos::gBuffer for polygons akin to what you're seeking. Looking at
> the implementation of the
> quadsegs argument might aid you.  Don't know what to suggest for lines
> though I'm thinking the
> aggregation process in Trajectories might be of use.  I realize that
> aggregation suggests reducing
> rather than densifying but there many be an opportunity to inject
> arbitrary 'between' points to densify
> to lines.
> HTH. Chris
>
> On Thu, Aug 6, 2015 at 11:10 PM, Michael Sumner <mdsumner at gmail.com>
> wrote:
>
>> Hello, is there any existing function in the Spatial family in R to
>> "densify geometries"?
>>
>> I'd like to be able specify the insertion of redundant vertices for all
>> individual segments within a Line* or Polygon*. I've done a bit myself but
>> wondering if this already exists somewhere.  This is a pretty standard
>> task
>> for reprojection in traditional GIS. Ultimately I would implement a
>> "minimum distance" option as well, just wondering if this is already out
>> there somewhere.
>>
>> I know there are partial pieces of this, for instance in
>> raster::rasterToPolygons and rgeos::gDistance - are there others? - but I
>> want more control.
>>
>> Cheers, Mike.
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>

	[[alternative HTML version deleted]]


From nevil.amos at gmail.com  Mon Aug 10 09:51:22 2015
From: nevil.amos at gmail.com (nevil amos)
Date: Mon, 10 Aug 2015 17:51:22 +1000
Subject: [R-sig-Geo] Union/Overlay single spatialPolygonsDataFrame
 containing overlapping polygonsto create polygons with all unique
 combinations of attributes
Message-ID: <CAN9eD7=yLbKWoGbFBussKt9rKYNENnqf_fsa-S+85TcmV2S8aA@mail.gmail.com>

I am attempting to combine overlapping polygons in a
single spatialPolygonsDataFrame so that the output is a set of polygons
such that where there is no overlap one polygon, of the non-intersecting
area will be formed, and retain the attributes of the original polygon.
 where polygons intersect  new polygons, of the intersecting area only will
be formed, one with the attributes of each of the original polygons
intersecting in that area.

The example includes a single overlap, the real data may contain many tens
or hundreds of intersecting polygons, from among tens of thousands of
polygons.

the step that I cannot work out is "myUnion"  it is aiming to achieve the
equivalent of a self- union in ESRI geoprocessing.

I realize that I can achieve a similar result with raster but would prefer
to stay with polygons for this process.

many thanks in advance

Nevil Amos

Trivial example:
library(rgeos)
library(maptools)
library (tidyr)
library(plyr)
rm(list = ls())
par(mfrow=c(2,2))
cols=c("red", "black", "blue", "yellow")
cols<-adjustcolor(cols,alpha.f=.5)

p2<-
SpatialPolygons(list(Polygons(list(Polygon(cbind(c(1,4,4,1,1),c(1,1,4,4,1)),hole
= F)), 1 ),

 Polygons(list(Polygon(cbind(c(3,5,5,3,3),c(3,3,5,5,3)),hole = F)), 2)))

ID<-c(1,2)
YEAR<-c(1999,2002)
Type<-c(1,2)
mydf2<-data.frame(ID,YEAR,Type)
mySPDF2<-SpatialPolygonsDataFrame(p2,mydf2)
mySPDF2$Area<-gArea(mySPDF2, byid=TRUE)
print("mySPDF2 at data")
print(mySPDF2 at data)
plot(mySPDF2,axes=T,col=cols)
mtext("mySPDF2",cex=2)
mtext(paste("colors =","red", "yellow", "blue", "green,"), outer = TRUE,
cex = 1.5)
#this is the step that does not give the desired result. It has the same
two polygons ( areas 9 and 4) as the input, no intersection and clipping of
the polygons occurs   I am trying to acheive the equivalent of a "self
union in ESRI ARCGIS.  The result I would like be four polygons: two "L
shaped plygons formed from the non- intersecting parts of the input
polygons (Areas 8 and 3 respecively), and two square polygons ( coincident
both of Area = )  I manually create my desired output in the next section
to illustrate what I would like to achieve
myUnion<-unionSpatialPolygons(mySPDF2,IDs=mySPDF2$ID)
print("myUnion Areas:")
print (gArea(myUnion, byid=TRUE))
plot(myUnion,col=cols,axes=T)
mtext("myUnion",cex=2)
#Create example of desired output of "union" operation
p4<-SpatialPolygons(list(Polygons(list(Polygon(cbind(c(1,4,4,3,3,1,1),c(1,1,3,3,4,4,1)),hole
= F)), 1),

 Polygons(list(Polygon(cbind(c(4,4,5,5,3,3,4),c(4,3,3,5,5,4,4)),hole = F)),
2),

 Polygons(list(Polygon(cbind(c(3,4,4,3,3),c(3,3,4,4,3)),hole = F)), 3),

 Polygons(list(Polygon(cbind(c(3,4,4,3,3),c(3,3,4,4,3)),hole = F)), 4)))
ID<-c(1,2,3,4)
YEAR<-c(1999,2002,1999,2002)
Type<-c(1,2,1,2)
mydf4<- data.frame(ID,YEAR,Type)
mySPDF4<-SpatialPolygonsDataFrame(p4,mydf4)


centroids<-coordinates(mySPDF4)
mySPDF4$X_Centroid<-centroids[,1]
mySPDF4$Y_Centroid<-centroids[,2]
mySPDF4$MergeID<-paste(mySPDF4$X_Centroid,mySPDF4$Y_Centroid)
mySPDF4$MergeID<-unclass(as.factor(mySPDF4$MergeID))
mySPDF4$Area<-gArea(mySPDF4, byid=TRUE)
print("mySPDF4 at data")
print(mySPDF4 at data)
plot(mySPDF4, col=cols,axes=T)
mtext("mySPDF4",cex=2)
# the ultimate aim is to get a Flat ( ie non-overlapping polygons)  with
attributes that can then be joined back wide form table of to the YEAR and
Type of mySPDF4

#Flatten on "MergeID"
myUnion2<-unionSpatialPolygons(mySPDF4,IDs=mySPDF4$MergeID)
myDF<-as.data.frame(mySPDF4)
myDF<-arrange(myDF,MergeID,desc(YEAR))

#add sequnce number for subsequent conversion to wide form
for( row in 1:nrow(myDF)){
  thisVal = myDF$MergeID[row]
  if (row ==1) Seq = 1 else {if (thisVal==lastVal) Seq =Seq+1 else Seq =1}
  myDF$Sequence[row]<-Seq
  lastVal=thisVal
}
#make YEAR and Type into wide form
yearDF<-spread(myDF[,c("MergeID","Sequence",'YEAR')],Sequence,YEAR)
names(yearDF)<-c("ID","YEAR1","YEAR2")
typeDF<-spread(myDF[,c("MergeID","Sequence",'Type')],Sequence,Type)
names(typeDF)<-c("ID","Type1","Type2")
flatDF<-join(yearDF,typeDF)
rownames(flatDF)<-flatDF[,"ID"]
#append data frame to myUnion2 spatialpolygons
myUnion2<-SpatialPolygonsDataFrame(myUnion2,flatDF)
plot(myUnion2,col=cols,axes=T)
mtext("myUnion2",cex=2)
myUnion2$Area<-gArea(myUnion2, byid=TRUE)
print("myUnion2 at data")
print(myUnion2 at data)

	[[alternative HTML version deleted]]


From thierry.onkelinx at inbo.be  Mon Aug 10 10:03:54 2015
From: thierry.onkelinx at inbo.be (Thierry Onkelinx)
Date: Mon, 10 Aug 2015 10:03:54 +0200
Subject: [R-sig-Geo] Modeling areal data with lots of holes, islands
In-Reply-To: <CAMTWOzqnEnME4d53GL=onr6XT3wFEVPhstrnA1+NaVwGGmva4w@mail.gmail.com>
References: <CAMTWOzqnEnME4d53GL=onr6XT3wFEVPhstrnA1+NaVwGGmva4w@mail.gmail.com>
Message-ID: <CAJuCY5wjBP8tExjtfn6hAoZhDPFfyTOj=g4Sg3Qq6HA2zWttyw@mail.gmail.com>

Dear Tim,

I assume that you know the location of all counties. Then you could make a
graph of the counties based on the neighbours of each county. Use that
graph in INLA to estimate the random effect of county. It can handle the
counties without data. Let's say that you have a simple graph: A - B - C -
D - E. The correlation between two neighbours in rho. If C has no data,
then INLA will estimate it's effect so that the correlation between B-C and
C-D is rho. As a result, the correlation between B-D will be rho ^ 2.

Best regards,

ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Research Institute for Nature and
Forest
team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
Kliniekstraat 25
1070 Anderlecht
Belgium

To call in the statistician after the experiment is done may be no more
than asking him to perform a post-mortem examination: he may be able to say
what the experiment died of. ~ Sir Ronald Aylmer Fisher
The plural of anecdote is not data. ~ Roger Brinner
The combination of some data and an aching desire for an answer does not
ensure that a reasonable answer can be extracted from a given body of data.
~ John Tukey

2015-07-22 21:10 GMT+02:00 Tim Meehan <tmeeha at gmail.com>:

> Hi All,
>
> I am using R to model data with repeated measures and strong spatial
> autocorrelation in OLS residuals.  Response and independent variables are
> summarized at the county level (2300 counties across contiguous US, each
> measured once during each of four years).
>
> There are lots of challenges with this data. First, the response is a
> proportion, so I am looking at modeling methods that can accommodate a
> beta-distribution (otherwise I'll logit-transform the response, or ignore
> the issue since residual distributions don't look too bad).  Second, the 4
> repeated measures per county sort of calls for either the ability to have
> random intercepts or the ability to incorporate a temporal correlation
> structure.  Third, the strong spatial patterning of residuals should
> probably be dealt with some how.  The modeling tools I am considering
> include mgcv::gam, mgcv::gamm, gamm4::gamm4, INLA::inla, spTimer::spTGibbs,
> etc.
>
> In order to choose the right tool, I need to decide on a way to specify the
> spatial relationships.  This is areal data, so it seems most common and
> correct to describe spatial relationships with graphs and employ
> neighborhood-oriented modeling approaches (e.g., CAR models).  But this
> data set is unusual in that I don't have data for all counties in the
> contiguous US (roughly 2300 out of 3100).  There are a lot of holes and
> islands in the map.  Conceptually, assigning neighbors seems odd when there
> are big gaps between counties, especially when I suspect that the spatial
> pattern in the data is due to continuous spatial processes.
>
> I would prefer to model these data using a geostatistical approach, using
> county centroids.  I know this is not ideal.  I have tried both approaches
> and they both yield similar fixed effect estimates for independent
> variables of interest. But the geostatistical approach produce better
> fitting models, eliminating nearly all residual autocorrelation.
>
> So, finally, the question.  Is it reasonable to model these areal data
> using a geostatistical approach given (1) there are lots of holes and
> islands in the areal data, (2) I suspect the spatial patterning to be due
> to continuous spatial processes, not adjacency of administrative
> boundaries, (3) there are roughly 2300 counties in the analysis, where
> variation in county size and shape is small compared to the continental
> analysis extent, (4) a geostatistical model does a better job of removing
> residual autocorrelation, and (5) I better understand the geostatistical
> ways of specifying spatial relationships?  What are the practical
> consequences of using geostatistical methods for areal data?  Are they
> greater than the consequences of using odd neighborhood specifications?
>
> Thanks for any advice you can offer.
>
> Best,
>
> Tim
>
> P.S. Sorry if this is the wrong venue for this question.  Please let me
> know if there is a better place to send it.
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From jalopcar at gmail.com  Mon Aug 10 15:27:05 2015
From: jalopcar at gmail.com (Jaime Lopez Carvajal)
Date: Mon, 10 Aug 2015 09:27:05 -0400
Subject: [R-sig-Geo] getosm.RData
Message-ID: <CANsMHoNBOTjnJB7tREvH2VVuBWb8vKDRchF-6Gpd-Pq5g67rZA@mail.gmail.com>

Hi all,

I am following the exercises from book "Spatial Data Analysis with R"

but I can not find this file in my system or internet...
how can I resolve this issue?

load("getosm.RData")
Error in readChar(con, 5L, useBytes = TRUE) : cannot open the connection
In addition: Warning message:
In readChar(con, 5L, useBytes = TRUE) :
  cannot open compressed file 'getosm.RData', probable reason 'No such file
or directory'


Thanks in advance, Jaime




-- 

*Jaime Lopez Carvajal*

	[[alternative HTML version deleted]]


From Roger.Bivand at nhh.no  Mon Aug 10 15:31:44 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 10 Aug 2015 15:31:44 +0200
Subject: [R-sig-Geo] getosm.RData
In-Reply-To: <CANsMHoNBOTjnJB7tREvH2VVuBWb8vKDRchF-6Gpd-Pq5g67rZA@mail.gmail.com>
References: <CANsMHoNBOTjnJB7tREvH2VVuBWb8vKDRchF-6Gpd-Pq5g67rZA@mail.gmail.com>
Message-ID: <alpine.LFD.2.20.1508101530580.3111@reclus.nhh.no>

On Mon, 10 Aug 2015, Jaime Lopez Carvajal wrote:

> Hi all,
>
> I am following the exercises from book "Spatial Data Analysis with R"
>
> but I can not find this file in my system or internet...
> how can I resolve this issue?

Download:

http://www.asdar-book.org/bundles2ed/die_bundle.zip

as is explained on the book website and in the book.

Roger

>
> load("getosm.RData")
> Error in readChar(con, 5L, useBytes = TRUE) : cannot open the connection
> In addition: Warning message:
> In readChar(con, 5L, useBytes = TRUE) :
>  cannot open compressed file 'getosm.RData', probable reason 'No such file
> or directory'
>
>
> Thanks in advance, Jaime
>
>
>
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From edzer.pebesma at uni-muenster.de  Mon Aug 10 18:21:18 2015
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 10 Aug 2015 18:21:18 +0200
Subject: [R-sig-Geo] spplot grid data - scale colours customizing
In-Reply-To: <CAAgsrZgy2b_GPVNoGFBZvP3McoYDZxDGveaviUYkOL1JWHQNLw@mail.gmail.com>
References: <CAAgsrZgy2b_GPVNoGFBZvP3McoYDZxDGveaviUYkOL1JWHQNLw@mail.gmail.com>
Message-ID: <55C8CF7E.3000301@uni-muenster.de>



On 08/03/2015 09:41 AM, pierluigi de rosa wrote:
> Dear All,
> 
> I'm trying to understand how spplot work with colour managing with gridded
> data.
> 
> I have na Object of class SpatialGridDataFrame
> Coordinates:
>       min     max
> x 2267600 2325600
> y 4693800 4826200
> Is projected: TRUE
> proj4string :
> 
> with 12 data for column attribute
> 
> I'm able to plot the SpatialGridDataFrame with:
> 
> spplot(fogli_Sup_Pioggia,as.table=TRUE, col.regions = cm.colors(100) ,
> key.space = "right")
> 
> but I want to select where change in colour appears and not leave spplot to
> do it by it self.
> I tried passing cuts option in this way:
> 
> spplot(fogli_Sup_Pioggia,as.table=TRUE, col.regions = cm.colors(100) ,
> cuts=c(1,2.5,3),key.space = "right")
> 
> It seems working but now the colour is not graduated any more but.
> How can I have a graduated palette again?
> Thanks
> 

this gave you a warning, which you didn't report.

Use cuts=5 to get 5 classes; use at=c(1,2.5,3) to get colour changes at
these values. And do read ?spplot.

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi),  University of M?nster,
Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
Journal of Statistical Software:   http://www.jstatsoft.org/
Computers & Geosciences:   http://elsevier.com/locate/cageo/
Spatial Statistics Society http://www.spatialstatistics.info

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150810/13bde4e9/attachment.bin>

From tbelote at tws.org  Mon Aug 10 19:56:03 2015
From: tbelote at tws.org (Travis Belote)
Date: Mon, 10 Aug 2015 17:56:03 +0000
Subject: [R-sig-Geo] using 'mask' versus 'crop' in raster
Message-ID: <a4af42f5436849dcbde92fd03147933c@twsexch12k13.tws.org>

Hi all,

I am trying to extract a raster layer of data to a specific region defined by a shapefile. In Arc I would do this using "extract by mask" and have had some luck using "mask" in the raster package. I am able to consistently use "crop" to limit the extent of the raster data, but I cannot consistently use "mask." The projections of the raster and shapefile are the same. The raster represents data for all of North America (called "ens" below) and I am trying to extract just the data from the contiguous United States (shapefile called "conus" below).

Here is the line of code and the Error message.



conusensMASK <- mask(ens, conus)
Error in mask(ens, conus) : unused argument (conus)

I was having trouble with this a few weeks ago. I updated all my packages and that seemed to take care of the issue for a day when "mask" worked beautifully. Again, "crop" works fine. But, I am again receiving the error from "mask".

Thank you for any suggestions or advice.
Sincerely,
Travis


R. Travis Belote, PhD
Research Ecologist
The Wilderness Society
Bozeman, MT 59715
406.581.3808


	[[alternative HTML version deleted]]


From strimas at zoology.ubc.ca  Mon Aug 10 20:48:02 2015
From: strimas at zoology.ubc.ca (Matt Strimas-Mackey)
Date: Mon, 10 Aug 2015 11:48:02 -0700
Subject: [R-sig-Geo] using 'mask' versus 'crop' in raster
In-Reply-To: <a4af42f5436849dcbde92fd03147933c@twsexch12k13.tws.org>
References: <a4af42f5436849dcbde92fd03147933c@twsexch12k13.tws.org>
Message-ID: <CAHb9yCCoxwL5nr9nRrrko2uFq02+0CPMc_BbwU-r12t_=PQmOw@mail.gmail.com>

Seems like you may have some other function called mask either defined by
you or in another package loaded after raster. A couple things you could
check:
-just type "mask" (without quotes) in the console. The first line should
say something like:
standardGeneric for "mask" defined from package "raster"
-try raster::mask(ens, conus) to directly access mask in the raster package
-Install and load the pryr package and run "pryr::where(mask)" (again,
without quotes) to see which environment mask is located in

On Mon, Aug 10, 2015 at 10:56 AM, Travis Belote <tbelote at tws.org> wrote:

> Hi all,
>
> I am trying to extract a raster layer of data to a specific region defined
> by a shapefile. In Arc I would do this using "extract by mask" and have had
> some luck using "mask" in the raster package. I am able to consistently use
> "crop" to limit the extent of the raster data, but I cannot consistently
> use "mask." The projections of the raster and shapefile are the same. The
> raster represents data for all of North America (called "ens" below) and I
> am trying to extract just the data from the contiguous United States
> (shapefile called "conus" below).
>
> Here is the line of code and the Error message.
>
>
>
> conusensMASK <- mask(ens, conus)
> Error in mask(ens, conus) : unused argument (conus)
>
> I was having trouble with this a few weeks ago. I updated all my packages
> and that seemed to take care of the issue for a day when "mask" worked
> beautifully. Again, "crop" works fine. But, I am again receiving the error
> from "mask".
>
> Thank you for any suggestions or advice.
> Sincerely,
> Travis
>
>
> R. Travis Belote, PhD
> Research Ecologist
> The Wilderness Society
> Bozeman, MT 59715
> 406.581.3808
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From tbelote at tws.org  Mon Aug 10 21:00:39 2015
From: tbelote at tws.org (Travis Belote)
Date: Mon, 10 Aug 2015 19:00:39 +0000
Subject: [R-sig-Geo] using 'mask' versus 'crop' in raster
In-Reply-To: <CAHb9yCCoxwL5nr9nRrrko2uFq02+0CPMc_BbwU-r12t_=PQmOw@mail.gmail.com>
References: <a4af42f5436849dcbde92fd03147933c@twsexch12k13.tws.org>
	<CAHb9yCCoxwL5nr9nRrrko2uFq02+0CPMc_BbwU-r12t_=PQmOw@mail.gmail.com>
Message-ID: <895635f5c4e84ce18a723700307a9909@twsexch12k13.tws.org>

That appears to be the problem. Thank you for your time responding! I?m still relatively new to R? or at least I?m still learning some of these basic ways of trouble-shooting issues. I greatly appreciate your help!

FYI I had Hmisc loaded, which was causing the problem. I will know to check this next time.

Thanks so much again!
Travis

R. Travis Belote, PhD
Research Ecologist
The Wilderness Society
Bozeman, MT 59715
406.581.3808

From: Matt Strimas-Mackey [mailto:strimas at zoology.ubc.ca]
Sent: Monday, August 10, 2015 12:48 PM
To: Travis Belote
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] using 'mask' versus 'crop' in raster

Seems like you may have some other function called mask either defined by you or in another package loaded after raster. A couple things you could check:
-just type "mask" (without quotes) in the console. The first line should say something like:
standardGeneric for "mask" defined from package "raster"
-try raster::mask(ens, conus) to directly access mask in the raster package
-Install and load the pryr package and run "pryr::where(mask)" (again, without quotes) to see which environment mask is located in

On Mon, Aug 10, 2015 at 10:56 AM, Travis Belote <tbelote at tws.org<mailto:tbelote at tws.org>> wrote:
Hi all,

I am trying to extract a raster layer of data to a specific region defined by a shapefile. In Arc I would do this using "extract by mask" and have had some luck using "mask" in the raster package. I am able to consistently use "crop" to limit the extent of the raster data, but I cannot consistently use "mask." The projections of the raster and shapefile are the same. The raster represents data for all of North America (called "ens" below) and I am trying to extract just the data from the contiguous United States (shapefile called "conus" below).

Here is the line of code and the Error message.



conusensMASK <- mask(ens, conus)
Error in mask(ens, conus) : unused argument (conus)

I was having trouble with this a few weeks ago. I updated all my packages and that seemed to take care of the issue for a day when "mask" worked beautifully. Again, "crop" works fine. But, I am again receiving the error from "mask".

Thank you for any suggestions or advice.
Sincerely,
Travis


R. Travis Belote, PhD
Research Ecologist
The Wilderness Society
Bozeman, MT 59715
406.581.3808<tel:406.581.3808>


        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


	[[alternative HTML version deleted]]


From adeela.uaf at gmail.com  Tue Aug 11 09:10:40 2015
From: adeela.uaf at gmail.com (adeela uaf)
Date: Tue, 11 Aug 2015 12:10:40 +0500
Subject: [R-sig-Geo] Spatial stationarity
Message-ID: <CABGg3O5_pWYmubog8k=K9-R-pPxXUfF-tA2BjUuuabEKX+YnrA@mail.gmail.com>

Hi,
I asked a question here about how we can check spatial stationarity in R
for a data having latitude and longitude of the meausred reponse.
Suggestions given were based on graphical outputs. These are based on
subjective approaches. My question is still how we can check about stong
stationarity, weak stationarity, anisotropy test and somewhat about
intrinsic random function in R for spatial data(having lat, long and
response).
My second question is that if I have the sample data from 48 locations of a
town and I don't have the new data to place for prediction, Is there anyway
to simulate the new data for prediction from the available sample data.

I will be very thankfull for any suggestions and guideline on both questions

Regards,
Adeela
University of Agriculture, Faisalabad

	[[alternative HTML version deleted]]


From bernd.vogelgesang at gmx.de  Tue Aug 11 11:30:35 2015
From: bernd.vogelgesang at gmx.de (Bernd Vogelgesang)
Date: Tue, 11 Aug 2015 11:30:35 +0200
Subject: [R-sig-Geo] Union/Overlay single spatialPolygonsDataFrame
 containing overlapping polygonsto create polygons with all unique
 combinations of attributes
In-Reply-To: <CAN9eD7=yLbKWoGbFBussKt9rKYNENnqf_fsa-S+85TcmV2S8aA@mail.gmail.com>
References: <CAN9eD7=yLbKWoGbFBussKt9rKYNENnqf_fsa-S+85TcmV2S8aA@mail.gmail.com>
Message-ID: <op.x26509awl2i25i@bernd-terra-pc>

Hi,

I don't know if that is of any help, but right at the moment I am building  
a model in QGIS which should achieve sth similar:
I have overlapping polygons with minute values per square meter, which I  
self-intersect, calculate the new area and then dissolve the intersecting  
parts while summing up the minute values.
Though this seems to me like a quite common task in GIS, its really hard  
to implement somehow.


The self-intersection in my model is done through v.clean break from  
GRASS. This "cuts" all polygons with the borders of all other overlapping  
polygons.
The dissolve is done with a gdal function which looks like this:
ogr2ogr output input -dialect sqlite -sql "SELECT  
ST_Union(geometry),dissolve_field, SUM(sum_field) AS sum_diss GROUP BY  
dissolve_field"

I haven't tested any of your code, so this is just a hint in case you  
can't find any native possibilities. The grass function might be quite  
easy to implement, but I have no idea about the dissolve from gdal.

Good luck
Bernd

Am 10.08.2015, 09:51 Uhr, schrieb nevil amos <nevil.amos at gmail.com>:

> I am attempting to combine overlapping polygons in a
> single spatialPolygonsDataFrame so that the output is a set of polygons
> such that where there is no overlap one polygon, of the non-intersecting
> area will be formed, and retain the attributes of the original polygon.
>  where polygons intersect  new polygons, of the intersecting area only  
> will
> be formed, one with the attributes of each of the original polygons
> intersecting in that area.
>
> The example includes a single overlap, the real data may contain many  
> tens
> or hundreds of intersecting polygons, from among tens of thousands of
> polygons.
>
> the step that I cannot work out is "myUnion"  it is aiming to achieve the
> equivalent of a self- union in ESRI geoprocessing.
>
> I realize that I can achieve a similar result with raster but would  
> prefer
> to stay with polygons for this process.
>
> many thanks in advance
>
> Nevil Amos
>
> Trivial example:
> library(rgeos)
> library(maptools)
> library (tidyr)
> library(plyr)
> rm(list = ls())
> par(mfrow=c(2,2))
> cols=c("red", "black", "blue", "yellow")
> cols<-adjustcolor(cols,alpha.f=.5)
>
> p2<-
> SpatialPolygons(list(Polygons(list(Polygon(cbind(c(1,4,4,1,1),c(1,1,4,4,1)),hole
> = F)), 1 ),
>
>  Polygons(list(Polygon(cbind(c(3,5,5,3,3),c(3,3,5,5,3)),hole = F)), 2)))
>
> ID<-c(1,2)
> YEAR<-c(1999,2002)
> Type<-c(1,2)
> mydf2<-data.frame(ID,YEAR,Type)
> mySPDF2<-SpatialPolygonsDataFrame(p2,mydf2)
> mySPDF2$Area<-gArea(mySPDF2, byid=TRUE)
> print("mySPDF2 at data")
> print(mySPDF2 at data)
> plot(mySPDF2,axes=T,col=cols)
> mtext("mySPDF2",cex=2)
> mtext(paste("colors =","red", "yellow", "blue", "green,"), outer = TRUE,
> cex = 1.5)
> #this is the step that does not give the desired result. It has the same
> two polygons ( areas 9 and 4) as the input, no intersection and clipping  
> of
> the polygons occurs   I am trying to acheive the equivalent of a "self
> union in ESRI ARCGIS.  The result I would like be four polygons: two "L
> shaped plygons formed from the non- intersecting parts of the input
> polygons (Areas 8 and 3 respecively), and two square polygons (  
> coincident
> both of Area = )  I manually create my desired output in the next section
> to illustrate what I would like to achieve
> myUnion<-unionSpatialPolygons(mySPDF2,IDs=mySPDF2$ID)
> print("myUnion Areas:")
> print (gArea(myUnion, byid=TRUE))
> plot(myUnion,col=cols,axes=T)
> mtext("myUnion",cex=2)
> #Create example of desired output of "union" operation
> p4<-SpatialPolygons(list(Polygons(list(Polygon(cbind(c(1,4,4,3,3,1,1),c(1,1,3,3,4,4,1)),hole
> = F)), 1),
>
>  Polygons(list(Polygon(cbind(c(4,4,5,5,3,3,4),c(4,3,3,5,5,4,4)),hole =  
> F)),
> 2),
>
>  Polygons(list(Polygon(cbind(c(3,4,4,3,3),c(3,3,4,4,3)),hole = F)), 3),
>
>  Polygons(list(Polygon(cbind(c(3,4,4,3,3),c(3,3,4,4,3)),hole = F)), 4)))
> ID<-c(1,2,3,4)
> YEAR<-c(1999,2002,1999,2002)
> Type<-c(1,2,1,2)
> mydf4<- data.frame(ID,YEAR,Type)
> mySPDF4<-SpatialPolygonsDataFrame(p4,mydf4)
>
>
> centroids<-coordinates(mySPDF4)
> mySPDF4$X_Centroid<-centroids[,1]
> mySPDF4$Y_Centroid<-centroids[,2]
> mySPDF4$MergeID<-paste(mySPDF4$X_Centroid,mySPDF4$Y_Centroid)
> mySPDF4$MergeID<-unclass(as.factor(mySPDF4$MergeID))
> mySPDF4$Area<-gArea(mySPDF4, byid=TRUE)
> print("mySPDF4 at data")
> print(mySPDF4 at data)
> plot(mySPDF4, col=cols,axes=T)
> mtext("mySPDF4",cex=2)
> # the ultimate aim is to get a Flat ( ie non-overlapping polygons)  with
> attributes that can then be joined back wide form table of to the YEAR  
> and
> Type of mySPDF4
>
> #Flatten on "MergeID"
> myUnion2<-unionSpatialPolygons(mySPDF4,IDs=mySPDF4$MergeID)
> myDF<-as.data.frame(mySPDF4)
> myDF<-arrange(myDF,MergeID,desc(YEAR))
>
> #add sequnce number for subsequent conversion to wide form
> for( row in 1:nrow(myDF)){
>   thisVal = myDF$MergeID[row]
>   if (row ==1) Seq = 1 else {if (thisVal==lastVal) Seq =Seq+1 else Seq  
> =1}
>   myDF$Sequence[row]<-Seq
>   lastVal=thisVal
> }
> #make YEAR and Type into wide form
> yearDF<-spread(myDF[,c("MergeID","Sequence",'YEAR')],Sequence,YEAR)
> names(yearDF)<-c("ID","YEAR1","YEAR2")
> typeDF<-spread(myDF[,c("MergeID","Sequence",'Type')],Sequence,Type)
> names(typeDF)<-c("ID","Type1","Type2")
> flatDF<-join(yearDF,typeDF)
> rownames(flatDF)<-flatDF[,"ID"]
> #append data frame to myUnion2 spatialpolygons
> myUnion2<-SpatialPolygonsDataFrame(myUnion2,flatDF)
> plot(myUnion2,col=cols,axes=T)
> mtext("myUnion2",cex=2)
> myUnion2$Area<-gArea(myUnion2, byid=TRUE)
> print("myUnion2 at data")
> print(myUnion2 at data)
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


-- 
Bernd Vogelgesang
Siedlerstra?e 2
91083 Baiersdorf/Igelsdorf
Tel: 09133-825374


From mdsumner at gmail.com  Tue Aug 11 16:58:20 2015
From: mdsumner at gmail.com (Michael Sumner)
Date: Tue, 11 Aug 2015 14:58:20 +0000
Subject: [R-sig-Geo] Union/Overlay single spatialPolygonsDataFrame
 containing overlapping polygonsto create polygons with all unique
 combinations of attributes
In-Reply-To: <CAN9eD7=yLbKWoGbFBussKt9rKYNENnqf_fsa-S+85TcmV2S8aA@mail.gmail.com>
References: <CAN9eD7=yLbKWoGbFBussKt9rKYNENnqf_fsa-S+85TcmV2S8aA@mail.gmail.com>
Message-ID: <CAAcGz98hRsbdARo9nJ8rGGDvXx2QvLdkxD0qK89jP56oi3HGfg@mail.gmail.com>

On Mon, 10 Aug 2015 at 17:52 nevil amos <nevil.amos at gmail.com> wrote:

> I am attempting to combine overlapping polygons in a
> single spatialPolygonsDataFrame so that the output is a set of polygons
> such that where there is no overlap one polygon, of the non-intersecting
> area will be formed, and retain the attributes of the original polygon.
>  where polygons intersect  new polygons, of the intersecting area only will
> be formed, one with the attributes of each of the original polygons
> intersecting in that area.
>
> The example includes a single overlap, the real data may contain many tens
> or hundreds of intersecting polygons, from among tens of thousands of
> polygons.
>
> the step that I cannot work out is "myUnion"  it is aiming to achieve the
> equivalent of a self- union in ESRI geoprocessing.
>
> I realize that I can achieve a similar result with raster but would prefer
> to stay with polygons for this process.
>
>

Is raster::cover closer to what you want?

library(raster)

plot(mySPDF2)
 plot(cover(mySPDF2[1,], mySPDF2[,2]), add = TRUE, col = rgb(c(0, 1), c(0,
0), c(1, 0), c(0.5)))
 plot(mySPDF2)
 plot(cover(mySPDF2[2,], mySPDF2[1,]), add = TRUE, col = rgb(c(0, 0), c(0,
1), c(1, 0), c(0.5)))

You'll still need to take the non-overlapping piece from the complement
overlay. I don't know if there's an easier way.
See ?"raster-package" for a complete overview.

HTH, Mike.


many thanks in advance
>
> Nevil Amos
>
> Trivial example:
> library(rgeos)
> library(maptools)
> library (tidyr)
> library(plyr)
> rm(list = ls())
> par(mfrow=c(2,2))
> cols=c("red", "black", "blue", "yellow")
> cols<-adjustcolor(cols,alpha.f=.5)
>
> p2<-
>
> SpatialPolygons(list(Polygons(list(Polygon(cbind(c(1,4,4,1,1),c(1,1,4,4,1)),hole
> = F)), 1 ),
>
>  Polygons(list(Polygon(cbind(c(3,5,5,3,3),c(3,3,5,5,3)),hole = F)), 2)))
>
> ID<-c(1,2)
> YEAR<-c(1999,2002)
> Type<-c(1,2)
> mydf2<-data.frame(ID,YEAR,Type)
> mySPDF2<-SpatialPolygonsDataFrame(p2,mydf2)
> mySPDF2$Area<-gArea(mySPDF2, byid=TRUE)
> print("mySPDF2 at data")
> print(mySPDF2 at data)
> plot(mySPDF2,axes=T,col=cols)
> mtext("mySPDF2",cex=2)
> mtext(paste("colors =","red", "yellow", "blue", "green,"), outer = TRUE,
> cex = 1.5)
> #this is the step that does not give the desired result. It has the same
> two polygons ( areas 9 and 4) as the input, no intersection and clipping of
> the polygons occurs   I am trying to acheive the equivalent of a "self
> union in ESRI ARCGIS.  The result I would like be four polygons: two "L
> shaped plygons formed from the non- intersecting parts of the input
> polygons (Areas 8 and 3 respecively), and two square polygons ( coincident
> both of Area = )  I manually create my desired output in the next section
> to illustrate what I would like to achieve
> myUnion<-unionSpatialPolygons(mySPDF2,IDs=mySPDF2$ID)
> print("myUnion Areas:")
> print (gArea(myUnion, byid=TRUE))
> plot(myUnion,col=cols,axes=T)
> mtext("myUnion",cex=2)
> #Create example of desired output of "union" operation
>
> p4<-SpatialPolygons(list(Polygons(list(Polygon(cbind(c(1,4,4,3,3,1,1),c(1,1,3,3,4,4,1)),hole
> = F)), 1),
>
>  Polygons(list(Polygon(cbind(c(4,4,5,5,3,3,4),c(4,3,3,5,5,4,4)),hole = F)),
> 2),
>
>  Polygons(list(Polygon(cbind(c(3,4,4,3,3),c(3,3,4,4,3)),hole = F)), 3),
>
>  Polygons(list(Polygon(cbind(c(3,4,4,3,3),c(3,3,4,4,3)),hole = F)), 4)))
> ID<-c(1,2,3,4)
> YEAR<-c(1999,2002,1999,2002)
> Type<-c(1,2,1,2)
> mydf4<- data.frame(ID,YEAR,Type)
> mySPDF4<-SpatialPolygonsDataFrame(p4,mydf4)
>
>
> centroids<-coordinates(mySPDF4)
> mySPDF4$X_Centroid<-centroids[,1]
> mySPDF4$Y_Centroid<-centroids[,2]
> mySPDF4$MergeID<-paste(mySPDF4$X_Centroid,mySPDF4$Y_Centroid)
> mySPDF4$MergeID<-unclass(as.factor(mySPDF4$MergeID))
> mySPDF4$Area<-gArea(mySPDF4, byid=TRUE)
> print("mySPDF4 at data")
> print(mySPDF4 at data)
> plot(mySPDF4, col=cols,axes=T)
> mtext("mySPDF4",cex=2)
> # the ultimate aim is to get a Flat ( ie non-overlapping polygons)  with
> attributes that can then be joined back wide form table of to the YEAR and
> Type of mySPDF4
>
> #Flatten on "MergeID"
> myUnion2<-unionSpatialPolygons(mySPDF4,IDs=mySPDF4$MergeID)
> myDF<-as.data.frame(mySPDF4)
> myDF<-arrange(myDF,MergeID,desc(YEAR))
>
> #add sequnce number for subsequent conversion to wide form
> for( row in 1:nrow(myDF)){
>   thisVal = myDF$MergeID[row]
>   if (row ==1) Seq = 1 else {if (thisVal==lastVal) Seq =Seq+1 else Seq =1}
>   myDF$Sequence[row]<-Seq
>   lastVal=thisVal
> }
> #make YEAR and Type into wide form
> yearDF<-spread(myDF[,c("MergeID","Sequence",'YEAR')],Sequence,YEAR)
> names(yearDF)<-c("ID","YEAR1","YEAR2")
> typeDF<-spread(myDF[,c("MergeID","Sequence",'Type')],Sequence,Type)
> names(typeDF)<-c("ID","Type1","Type2")
> flatDF<-join(yearDF,typeDF)
> rownames(flatDF)<-flatDF[,"ID"]
> #append data frame to myUnion2 spatialpolygons
> myUnion2<-SpatialPolygonsDataFrame(myUnion2,flatDF)
> plot(myUnion2,col=cols,axes=T)
> mtext("myUnion2",cex=2)
> myUnion2$Area<-gArea(myUnion2, byid=TRUE)
> print("myUnion2 at data")
> print(myUnion2 at data)
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From tmeeha at gmail.com  Tue Aug 11 17:46:38 2015
From: tmeeha at gmail.com (Tim Meehan)
Date: Tue, 11 Aug 2015 09:46:38 -0600
Subject: [R-sig-Geo] Spatial stationarity
In-Reply-To: <CABGg3O5_pWYmubog8k=K9-R-pPxXUfF-tA2BjUuuabEKX+YnrA@mail.gmail.com>
References: <CABGg3O5_pWYmubog8k=K9-R-pPxXUfF-tA2BjUuuabEKX+YnrA@mail.gmail.com>
Message-ID: <CAMTWOzpL1rjtGRSCVt7vNaUVK9XQDYHc8+JDZTPEF_DOxV5GTQ@mail.gmail.com>

Hi Adeela,

The GWmodel package has geographically weighted regression (GWR) routines
that return statistical tests for stationarity.

Best,
Tim

On Tue, Aug 11, 2015 at 1:10 AM, adeela uaf <adeela.uaf at gmail.com> wrote:

> Hi,
> I asked a question here about how we can check spatial stationarity in R
> for a data having latitude and longitude of the meausred reponse.
> Suggestions given were based on graphical outputs. These are based on
> subjective approaches. My question is still how we can check about stong
> stationarity, weak stationarity, anisotropy test and somewhat about
> intrinsic random function in R for spatial data(having lat, long and
> response).
> My second question is that if I have the sample data from 48 locations of a
> town and I don't have the new data to place for prediction, Is there anyway
> to simulate the new data for prediction from the available sample data.
>
> I will be very thankfull for any suggestions and guideline on both
> questions
>
> Regards,
> Adeela
> University of Agriculture, Faisalabad
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From r.hijmans at gmail.com  Wed Aug 12 03:02:16 2015
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 11 Aug 2015 18:02:16 -0700
Subject: [R-sig-Geo] Union/Overlay single spatialPolygonsDataFrame
 containing overlapping polygonsto create polygons with all unique
 combinations of attributes
In-Reply-To: <CAAcGz98hRsbdARo9nJ8rGGDvXx2QvLdkxD0qK89jP56oi3HGfg@mail.gmail.com>
References: <CAN9eD7=yLbKWoGbFBussKt9rKYNENnqf_fsa-S+85TcmV2S8aA@mail.gmail.com>
	<CAAcGz98hRsbdARo9nJ8rGGDvXx2QvLdkxD0qK89jP56oi3HGfg@mail.gmail.com>
Message-ID: <CANtt_hxeS6_ExX77YrW6q8=pNuYcTH3duD4gPWEy=xSOrNDFEg@mail.gmail.com>

I would think raster::union(polygons) should get you there.
Robert

On Tue, Aug 11, 2015 at 7:58 AM, Michael Sumner <mdsumner at gmail.com> wrote:
> On Mon, 10 Aug 2015 at 17:52 nevil amos <nevil.amos at gmail.com> wrote:
>
>> I am attempting to combine overlapping polygons in a
>> single spatialPolygonsDataFrame so that the output is a set of polygons
>> such that where there is no overlap one polygon, of the non-intersecting
>> area will be formed, and retain the attributes of the original polygon.
>>  where polygons intersect  new polygons, of the intersecting area only will
>> be formed, one with the attributes of each of the original polygons
>> intersecting in that area.
>>
>> The example includes a single overlap, the real data may contain many tens
>> or hundreds of intersecting polygons, from among tens of thousands of
>> polygons.
>>
>> the step that I cannot work out is "myUnion"  it is aiming to achieve the
>> equivalent of a self- union in ESRI geoprocessing.
>>
>> I realize that I can achieve a similar result with raster but would prefer
>> to stay with polygons for this process.
>>
>>
>
> Is raster::cover closer to what you want?
>
> library(raster)
>
> plot(mySPDF2)
>  plot(cover(mySPDF2[1,], mySPDF2[,2]), add = TRUE, col = rgb(c(0, 1), c(0,
> 0), c(1, 0), c(0.5)))
>  plot(mySPDF2)
>  plot(cover(mySPDF2[2,], mySPDF2[1,]), add = TRUE, col = rgb(c(0, 0), c(0,
> 1), c(1, 0), c(0.5)))
>
> You'll still need to take the non-overlapping piece from the complement
> overlay. I don't know if there's an easier way.
> See ?"raster-package" for a complete overview.
>
> HTH, Mike.
>
>
> many thanks in advance
>>
>> Nevil Amos
>>
>> Trivial example:
>> library(rgeos)
>> library(maptools)
>> library (tidyr)
>> library(plyr)
>> rm(list = ls())
>> par(mfrow=c(2,2))
>> cols=c("red", "black", "blue", "yellow")
>> cols<-adjustcolor(cols,alpha.f=.5)
>>
>> p2<-
>>
>> SpatialPolygons(list(Polygons(list(Polygon(cbind(c(1,4,4,1,1),c(1,1,4,4,1)),hole
>> = F)), 1 ),
>>
>>  Polygons(list(Polygon(cbind(c(3,5,5,3,3),c(3,3,5,5,3)),hole = F)), 2)))
>>
>> ID<-c(1,2)
>> YEAR<-c(1999,2002)
>> Type<-c(1,2)
>> mydf2<-data.frame(ID,YEAR,Type)
>> mySPDF2<-SpatialPolygonsDataFrame(p2,mydf2)
>> mySPDF2$Area<-gArea(mySPDF2, byid=TRUE)
>> print("mySPDF2 at data")
>> print(mySPDF2 at data)
>> plot(mySPDF2,axes=T,col=cols)
>> mtext("mySPDF2",cex=2)
>> mtext(paste("colors =","red", "yellow", "blue", "green,"), outer = TRUE,
>> cex = 1.5)
>> #this is the step that does not give the desired result. It has the same
>> two polygons ( areas 9 and 4) as the input, no intersection and clipping of
>> the polygons occurs   I am trying to acheive the equivalent of a "self
>> union in ESRI ARCGIS.  The result I would like be four polygons: two "L
>> shaped plygons formed from the non- intersecting parts of the input
>> polygons (Areas 8 and 3 respecively), and two square polygons ( coincident
>> both of Area = )  I manually create my desired output in the next section
>> to illustrate what I would like to achieve
>> myUnion<-unionSpatialPolygons(mySPDF2,IDs=mySPDF2$ID)
>> print("myUnion Areas:")
>> print (gArea(myUnion, byid=TRUE))
>> plot(myUnion,col=cols,axes=T)
>> mtext("myUnion",cex=2)
>> #Create example of desired output of "union" operation
>>
>> p4<-SpatialPolygons(list(Polygons(list(Polygon(cbind(c(1,4,4,3,3,1,1),c(1,1,3,3,4,4,1)),hole
>> = F)), 1),
>>
>>  Polygons(list(Polygon(cbind(c(4,4,5,5,3,3,4),c(4,3,3,5,5,4,4)),hole = F)),
>> 2),
>>
>>  Polygons(list(Polygon(cbind(c(3,4,4,3,3),c(3,3,4,4,3)),hole = F)), 3),
>>
>>  Polygons(list(Polygon(cbind(c(3,4,4,3,3),c(3,3,4,4,3)),hole = F)), 4)))
>> ID<-c(1,2,3,4)
>> YEAR<-c(1999,2002,1999,2002)
>> Type<-c(1,2,1,2)
>> mydf4<- data.frame(ID,YEAR,Type)
>> mySPDF4<-SpatialPolygonsDataFrame(p4,mydf4)
>>
>>
>> centroids<-coordinates(mySPDF4)
>> mySPDF4$X_Centroid<-centroids[,1]
>> mySPDF4$Y_Centroid<-centroids[,2]
>> mySPDF4$MergeID<-paste(mySPDF4$X_Centroid,mySPDF4$Y_Centroid)
>> mySPDF4$MergeID<-unclass(as.factor(mySPDF4$MergeID))
>> mySPDF4$Area<-gArea(mySPDF4, byid=TRUE)
>> print("mySPDF4 at data")
>> print(mySPDF4 at data)
>> plot(mySPDF4, col=cols,axes=T)
>> mtext("mySPDF4",cex=2)
>> # the ultimate aim is to get a Flat ( ie non-overlapping polygons)  with
>> attributes that can then be joined back wide form table of to the YEAR and
>> Type of mySPDF4
>>
>> #Flatten on "MergeID"
>> myUnion2<-unionSpatialPolygons(mySPDF4,IDs=mySPDF4$MergeID)
>> myDF<-as.data.frame(mySPDF4)
>> myDF<-arrange(myDF,MergeID,desc(YEAR))
>>
>> #add sequnce number for subsequent conversion to wide form
>> for( row in 1:nrow(myDF)){
>>   thisVal = myDF$MergeID[row]
>>   if (row ==1) Seq = 1 else {if (thisVal==lastVal) Seq =Seq+1 else Seq =1}
>>   myDF$Sequence[row]<-Seq
>>   lastVal=thisVal
>> }
>> #make YEAR and Type into wide form
>> yearDF<-spread(myDF[,c("MergeID","Sequence",'YEAR')],Sequence,YEAR)
>> names(yearDF)<-c("ID","YEAR1","YEAR2")
>> typeDF<-spread(myDF[,c("MergeID","Sequence",'Type')],Sequence,Type)
>> names(typeDF)<-c("ID","Type1","Type2")
>> flatDF<-join(yearDF,typeDF)
>> rownames(flatDF)<-flatDF[,"ID"]
>> #append data frame to myUnion2 spatialpolygons
>> myUnion2<-SpatialPolygonsDataFrame(myUnion2,flatDF)
>> plot(myUnion2,col=cols,axes=T)
>> mtext("myUnion2",cex=2)
>> myUnion2$Area<-gArea(myUnion2, byid=TRUE)
>> print("myUnion2 at data")
>> print(myUnion2 at data)
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From r.hijmans at gmail.com  Wed Aug 12 03:05:41 2015
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 11 Aug 2015 18:05:41 -0700
Subject: [R-sig-Geo] densify geometries
In-Reply-To: <CAAcGz9_uztE2kXHhz_5JnLmLBSiC_LjFA+qb48yTyVRqJ_qosw@mail.gmail.com>
References: <CAAcGz9-PhGi61megdHa-c_m8RyYRESNNQJn-0S7mTAeDRTUXUg@mail.gmail.com>
	<CAASFQpSHD-jMdCV1tmhSeJwgvL6b7WyFL1C-3aH1_tMhR2+jpw@mail.gmail.com>
	<CAAcGz9_uztE2kXHhz_5JnLmLBSiC_LjFA+qb48yTyVRqJ_qosw@mail.gmail.com>
Message-ID: <CANtt_hyzWNjYsD3MRzCSrJ77wkVGebProJsEJoFbqQuFEqm6sQ@mail.gmail.com>

geosphere functions makeLine and makePoly do this, but only for
lon/lat, not for planar coordinates.
Robert

On Fri, Aug 7, 2015 at 6:30 AM, Michael Sumner <mdsumner at gmail.com> wrote:
> This is a nice idea with gBuffer, but testing on a simple case shows you
> need explicit curvature to get any extra verts.
>
> library(rgeos)
> library(raster) ## just for the "cheat's" polygon creator
>  x <- as(extent(0, 1, 0, 1), "SpatialPolygons")
> plot(as(as(gBuffer(x, width = 0.1, quadsegs = 55), "SpatialLines"),
> "SpatialPoints"))
>
>
> I want the extra vertices for curvature that's in the space traversed, not
> defined by the segment.
>
> Ultimately we need it to be driven by the right curve (great circle,
> loxodrome, etc.) so geosphere is a good start - but still the simplest case
> of inserting explicitly seems like an obvious gap here (pardon the pun),
> even for GEOS?
>
> Cheers, Mike.
>
>
> On Fri, 7 Aug 2015 at 15:23 chris english <englishchristophera at gmail.com>
> wrote:
>
>> Mike,
>>
>> I use rgeos::gBuffer for polygons akin to what you're seeking. Looking at
>> the implementation of the
>> quadsegs argument might aid you.  Don't know what to suggest for lines
>> though I'm thinking the
>> aggregation process in Trajectories might be of use.  I realize that
>> aggregation suggests reducing
>> rather than densifying but there many be an opportunity to inject
>> arbitrary 'between' points to densify
>> to lines.
>> HTH. Chris
>>
>> On Thu, Aug 6, 2015 at 11:10 PM, Michael Sumner <mdsumner at gmail.com>
>> wrote:
>>
>>> Hello, is there any existing function in the Spatial family in R to
>>> "densify geometries"?
>>>
>>> I'd like to be able specify the insertion of redundant vertices for all
>>> individual segments within a Line* or Polygon*. I've done a bit myself but
>>> wondering if this already exists somewhere.  This is a pretty standard
>>> task
>>> for reprojection in traditional GIS. Ultimately I would implement a
>>> "minimum distance" option as well, just wondering if this is already out
>>> there somewhere.
>>>
>>> I know there are partial pieces of this, for instance in
>>> raster::rasterToPolygons and rgeos::gDistance - are there others? - but I
>>> want more control.
>>>
>>> Cheers, Mike.
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From nevil.amos at gmail.com  Wed Aug 12 05:14:16 2015
From: nevil.amos at gmail.com (nevil amos)
Date: Wed, 12 Aug 2015 13:14:16 +1000
Subject: [R-sig-Geo] Union/Overlay single spatialPolygonsDataFrame
 containing overlapping polygonsto create polygons with all unique
 combinations of attributes
In-Reply-To: <CANtt_hxeS6_ExX77YrW6q8=pNuYcTH3duD4gPWEy=xSOrNDFEg@mail.gmail.com>
References: <CAN9eD7=yLbKWoGbFBussKt9rKYNENnqf_fsa-S+85TcmV2S8aA@mail.gmail.com>
	<CAAcGz98hRsbdARo9nJ8rGGDvXx2QvLdkxD0qK89jP56oi3HGfg@mail.gmail.com>
	<CANtt_hxeS6_ExX77YrW6q8=pNuYcTH3duD4gPWEy=xSOrNDFEg@mail.gmail.com>
Message-ID: <CAN9eD7kprr2x-KXPORO1cpJQgs87PonDC4YgrHSUsRwukoMb3A@mail.gmail.com>

Thanks for the suggestions.

unfortunately raster::union does not get the desired result,

First it requires two, and only two spatialPolygons objects as inputs. - I
think the function I need must either have a single input containing all
the polygons, or one input for each polygon to work in more complex cases
with many polygons with more than tow overlapping polygons

Second in my example it does indeed produce four polygons, however these
comprise the two original square polygons and two polygons from the
overlapping areas:

#what union::(SPDF2,SPDF2) acheives

par(mfrow=c(2,4))
myUnion<-raster::union(mySPDF2,mySPDF2)
myUnion$Area<-gArea(myUnion, byid=TRUE)
for (i in 1:4){
  plot(myUnion[i,],col=cols[i],axes=T,xlim=c(0,5),ylim=c(0,5))
}
print(myUnion at data)
print("Areas myUnion:")
print(gArea(myUnion, byid=TRUE))


#what is required:

p4<-SpatialPolygons(list(Polygons(list(Polygon(cbind(c(1,4,4,3,3,1,1),c(1,1,3,3,4,4,1)),hole
= F)), "1_ "),

 Polygons(list(Polygon(cbind(c(3,4,4,3,3),c(3,3,4,4,3)),hole = F)), "1_2"),

 Polygons(list(Polygon(cbind(c(3,4,4,3,3),c(3,3,4,4,3)),hole = F)), "2_1"),

 Polygons(list(Polygon(cbind(c(4,4,5,5,3,3,4),c(4,3,3,5,5,4,4)),hole = F)),
"2_")))
for (i in 1:4){
  plot(p4[i,],col=cols[i],axes=T,xlim=c(0,5),ylim=c(0,5))
}
print("Areas p4:")
print(gArea(p4, byid=TRUE))


On Wed, Aug 12, 2015 at 11:02 AM, Robert J. Hijmans <r.hijmans at gmail.com>
wrote:

> I would think raster::union(polygons) should get you there.
> Robert
>
> On Tue, Aug 11, 2015 at 7:58 AM, Michael Sumner <mdsumner at gmail.com>
> wrote:
> > On Mon, 10 Aug 2015 at 17:52 nevil amos <nevil.amos at gmail.com> wrote:
> >
> >> I am attempting to combine overlapping polygons in a
> >> single spatialPolygonsDataFrame so that the output is a set of polygons
> >> such that where there is no overlap one polygon, of the non-intersecting
> >> area will be formed, and retain the attributes of the original polygon.
> >>  where polygons intersect  new polygons, of the intersecting area only
> will
> >> be formed, one with the attributes of each of the original polygons
> >> intersecting in that area.
> >>
> >> The example includes a single overlap, the real data may contain many
> tens
> >> or hundreds of intersecting polygons, from among tens of thousands of
> >> polygons.
> >>
> >> the step that I cannot work out is "myUnion"  it is aiming to achieve
> the
> >> equivalent of a self- union in ESRI geoprocessing.
> >>
> >> I realize that I can achieve a similar result with raster but would
> prefer
> >> to stay with polygons for this process.
> >>
> >>
> >
> > Is raster::cover closer to what you want?
> >
> > library(raster)
> >
> > plot(mySPDF2)
> >  plot(cover(mySPDF2[1,], mySPDF2[,2]), add = TRUE, col = rgb(c(0, 1),
> c(0,
> > 0), c(1, 0), c(0.5)))
> >  plot(mySPDF2)
> >  plot(cover(mySPDF2[2,], mySPDF2[1,]), add = TRUE, col = rgb(c(0, 0),
> c(0,
> > 1), c(1, 0), c(0.5)))
> >
> > You'll still need to take the non-overlapping piece from the complement
> > overlay. I don't know if there's an easier way.
> > See ?"raster-package" for a complete overview.
> >
> > HTH, Mike.
> >
> >
> > many thanks in advance
> >>
> >> Nevil Amos
> >>
> >> Trivial example:
> >> library(rgeos)
> >> library(maptools)
> >> library (tidyr)
> >> library(plyr)
> >> rm(list = ls())
> >> par(mfrow=c(2,2))
> >> cols=c("red", "black", "blue", "yellow")
> >> cols<-adjustcolor(cols,alpha.f=.5)
> >>
> >> p2<-
> >>
> >>
> SpatialPolygons(list(Polygons(list(Polygon(cbind(c(1,4,4,1,1),c(1,1,4,4,1)),hole
> >> = F)), 1 ),
> >>
> >>  Polygons(list(Polygon(cbind(c(3,5,5,3,3),c(3,3,5,5,3)),hole = F)), 2)))
> >>
> >> ID<-c(1,2)
> >> YEAR<-c(1999,2002)
> >> Type<-c(1,2)
> >> mydf2<-data.frame(ID,YEAR,Type)
> >> mySPDF2<-SpatialPolygonsDataFrame(p2,mydf2)
> >> mySPDF2$Area<-gArea(mySPDF2, byid=TRUE)
> >> print("mySPDF2 at data")
> >> print(mySPDF2 at data)
> >> plot(mySPDF2,axes=T,col=cols)
> >> mtext("mySPDF2",cex=2)
> >> mtext(paste("colors =","red", "yellow", "blue", "green,"), outer = TRUE,
> >> cex = 1.5)
> >> #this is the step that does not give the desired result. It has the same
> >> two polygons ( areas 9 and 4) as the input, no intersection and
> clipping of
> >> the polygons occurs   I am trying to acheive the equivalent of a "self
> >> union in ESRI ARCGIS.  The result I would like be four polygons: two "L
> >> shaped plygons formed from the non- intersecting parts of the input
> >> polygons (Areas 8 and 3 respecively), and two square polygons (
> coincident
> >> both of Area = )  I manually create my desired output in the next
> section
> >> to illustrate what I would like to achieve
> >> myUnion<-unionSpatialPolygons(mySPDF2,IDs=mySPDF2$ID)
> >> print("myUnion Areas:")
> >> print (gArea(myUnion, byid=TRUE))
> >> plot(myUnion,col=cols,axes=T)
> >> mtext("myUnion",cex=2)
> >> #Create example of desired output of "union" operation
> >>
> >>
> p4<-SpatialPolygons(list(Polygons(list(Polygon(cbind(c(1,4,4,3,3,1,1),c(1,1,3,3,4,4,1)),hole
> >> = F)), 1),
> >>
> >>  Polygons(list(Polygon(cbind(c(4,4,5,5,3,3,4),c(4,3,3,5,5,4,4)),hole =
> F)),
> >> 2),
> >>
> >>  Polygons(list(Polygon(cbind(c(3,4,4,3,3),c(3,3,4,4,3)),hole = F)), 3),
> >>
> >>  Polygons(list(Polygon(cbind(c(3,4,4,3,3),c(3,3,4,4,3)),hole = F)), 4)))
> >> ID<-c(1,2,3,4)
> >> YEAR<-c(1999,2002,1999,2002)
> >> Type<-c(1,2,1,2)
> >> mydf4<- data.frame(ID,YEAR,Type)
> >> mySPDF4<-SpatialPolygonsDataFrame(p4,mydf4)
> >>
> >>
> >> centroids<-coordinates(mySPDF4)
> >> mySPDF4$X_Centroid<-centroids[,1]
> >> mySPDF4$Y_Centroid<-centroids[,2]
> >> mySPDF4$MergeID<-paste(mySPDF4$X_Centroid,mySPDF4$Y_Centroid)
> >> mySPDF4$MergeID<-unclass(as.factor(mySPDF4$MergeID))
> >> mySPDF4$Area<-gArea(mySPDF4, byid=TRUE)
> >> print("mySPDF4 at data")
> >> print(mySPDF4 at data)
> >> plot(mySPDF4, col=cols,axes=T)
> >> mtext("mySPDF4",cex=2)
> >> # the ultimate aim is to get a Flat ( ie non-overlapping polygons)  with
> >> attributes that can then be joined back wide form table of to the YEAR
> and
> >> Type of mySPDF4
> >>
> >> #Flatten on "MergeID"
> >> myUnion2<-unionSpatialPolygons(mySPDF4,IDs=mySPDF4$MergeID)
> >> myDF<-as.data.frame(mySPDF4)
> >> myDF<-arrange(myDF,MergeID,desc(YEAR))
> >>
> >> #add sequnce number for subsequent conversion to wide form
> >> for( row in 1:nrow(myDF)){
> >>   thisVal = myDF$MergeID[row]
> >>   if (row ==1) Seq = 1 else {if (thisVal==lastVal) Seq =Seq+1 else Seq
> =1}
> >>   myDF$Sequence[row]<-Seq
> >>   lastVal=thisVal
> >> }
> >> #make YEAR and Type into wide form
> >> yearDF<-spread(myDF[,c("MergeID","Sequence",'YEAR')],Sequence,YEAR)
> >> names(yearDF)<-c("ID","YEAR1","YEAR2")
> >> typeDF<-spread(myDF[,c("MergeID","Sequence",'Type')],Sequence,Type)
> >> names(typeDF)<-c("ID","Type1","Type2")
> >> flatDF<-join(yearDF,typeDF)
> >> rownames(flatDF)<-flatDF[,"ID"]
> >> #append data frame to myUnion2 spatialpolygons
> >> myUnion2<-SpatialPolygonsDataFrame(myUnion2,flatDF)
> >> plot(myUnion2,col=cols,axes=T)
> >> mtext("myUnion2",cex=2)
> >> myUnion2$Area<-gArea(myUnion2, byid=TRUE)
> >> print("myUnion2 at data")
> >> print(myUnion2 at data)
> >>
> >>         [[alternative HTML version deleted]]
> >>
> >> _______________________________________________
> >> R-sig-Geo mailing list
> >> R-sig-Geo at r-project.org
> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>
> >
> >         [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From r.hijmans at gmail.com  Wed Aug 12 19:06:35 2015
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 12 Aug 2015 10:06:35 -0700
Subject: [R-sig-Geo] Union/Overlay single spatialPolygonsDataFrame
 containing overlapping polygonsto create polygons with all unique
 combinations of attributes
In-Reply-To: <CAN9eD7kprr2x-KXPORO1cpJQgs87PonDC4YgrHSUsRwukoMb3A@mail.gmail.com>
References: <CAN9eD7=yLbKWoGbFBussKt9rKYNENnqf_fsa-S+85TcmV2S8aA@mail.gmail.com>
	<CAAcGz98hRsbdARo9nJ8rGGDvXx2QvLdkxD0qK89jP56oi3HGfg@mail.gmail.com>
	<CANtt_hxeS6_ExX77YrW6q8=pNuYcTH3duD4gPWEy=xSOrNDFEg@mail.gmail.com>
	<CAN9eD7kprr2x-KXPORO1cpJQgs87PonDC4YgrHSUsRwukoMb3A@mail.gmail.com>
Message-ID: <CANtt_hxeF7Azcq4KkhdEkqF_J+97K=KMGPUdD=cmf99qN7cgdA@mail.gmail.com>

Nevil,

raster::union does not _require_ two SpatialPolygons*, it also works
with one. See ?raster::union,  this is the (valid) case where 'y' is
missing.

> library(raster)
> u <- union(p4)
> data.frame(u)
  ID.1 ID.2 ID.3 ID.4 count
1    1    0    0    0     1
2    0    1    1    0     2
3    0    0    0    1     1

> u
class       : SpatialPolygonsDataFrame
features    : 3
extent      : 1, 5, 1, 5  (xmin, xmax, ymin, ymax)
coord. ref. : NA
variables   : 5
names       : ID.1, ID.2, ID.3, ID.4, count
min values  :    0,    0,    0,    0,     1
max values  :    1,    1,    1,    1,     2

> plot(u, col=rainbow(3))


Robert

On Tue, Aug 11, 2015 at 8:14 PM, nevil amos <nevil.amos at gmail.com> wrote:
> Thanks for the suggestions.
>
> unfortunately raster::union does not get the desired result,
>
> First it requires two, and only two spatialPolygons objects as inputs. - I
> think the function I need must either have a single input containing all the
> polygons, or one input for each polygon to work in more complex cases with
> many polygons with more than tow overlapping polygons
>
> Second in my example it does indeed produce four polygons, however these
> comprise the two original square polygons and two polygons from the
> overlapping areas:
>
> #what union::(SPDF2,SPDF2) acheives
>
> par(mfrow=c(2,4))
> myUnion<-raster::union(mySPDF2,mySPDF2)
> myUnion$Area<-gArea(myUnion, byid=TRUE)
> for (i in 1:4){
>   plot(myUnion[i,],col=cols[i],axes=T,xlim=c(0,5),ylim=c(0,5))
> }
> print(myUnion at data)
> print("Areas myUnion:")
> print(gArea(myUnion, byid=TRUE))
>
>
> #what is required:
>
> p4<-SpatialPolygons(list(Polygons(list(Polygon(cbind(c(1,4,4,3,3,1,1),c(1,1,3,3,4,4,1)),hole
> = F)), "1_ "),
>
> Polygons(list(Polygon(cbind(c(3,4,4,3,3),c(3,3,4,4,3)),hole = F)), "1_2"),
>
> Polygons(list(Polygon(cbind(c(3,4,4,3,3),c(3,3,4,4,3)),hole = F)), "2_1"),
>
> Polygons(list(Polygon(cbind(c(4,4,5,5,3,3,4),c(4,3,3,5,5,4,4)),hole = F)),
> "2_")))
> for (i in 1:4){
>   plot(p4[i,],col=cols[i],axes=T,xlim=c(0,5),ylim=c(0,5))
> }
> print("Areas p4:")
> print(gArea(p4, byid=TRUE))
>
>
> On Wed, Aug 12, 2015 at 11:02 AM, Robert J. Hijmans <r.hijmans at gmail.com>
> wrote:
>>
>> I would think raster::union(polygons) should get you there.
>> Robert
>>
>> On Tue, Aug 11, 2015 at 7:58 AM, Michael Sumner <mdsumner at gmail.com>
>> wrote:
>> > On Mon, 10 Aug 2015 at 17:52 nevil amos <nevil.amos at gmail.com> wrote:
>> >
>> >> I am attempting to combine overlapping polygons in a
>> >> single spatialPolygonsDataFrame so that the output is a set of polygons
>> >> such that where there is no overlap one polygon, of the
>> >> non-intersecting
>> >> area will be formed, and retain the attributes of the original polygon.
>> >>  where polygons intersect  new polygons, of the intersecting area only
>> >> will
>> >> be formed, one with the attributes of each of the original polygons
>> >> intersecting in that area.
>> >>
>> >> The example includes a single overlap, the real data may contain many
>> >> tens
>> >> or hundreds of intersecting polygons, from among tens of thousands of
>> >> polygons.
>> >>
>> >> the step that I cannot work out is "myUnion"  it is aiming to achieve
>> >> the
>> >> equivalent of a self- union in ESRI geoprocessing.
>> >>
>> >> I realize that I can achieve a similar result with raster but would
>> >> prefer
>> >> to stay with polygons for this process.
>> >>
>> >>
>> >
>> > Is raster::cover closer to what you want?
>> >
>> > library(raster)
>> >
>> > plot(mySPDF2)
>> >  plot(cover(mySPDF2[1,], mySPDF2[,2]), add = TRUE, col = rgb(c(0, 1),
>> > c(0,
>> > 0), c(1, 0), c(0.5)))
>> >  plot(mySPDF2)
>> >  plot(cover(mySPDF2[2,], mySPDF2[1,]), add = TRUE, col = rgb(c(0, 0),
>> > c(0,
>> > 1), c(1, 0), c(0.5)))
>> >
>> > You'll still need to take the non-overlapping piece from the complement
>> > overlay. I don't know if there's an easier way.
>> > See ?"raster-package" for a complete overview.
>> >
>> > HTH, Mike.
>> >
>> >
>> > many thanks in advance
>> >>
>> >> Nevil Amos
>> >>
>> >> Trivial example:
>> >> library(rgeos)
>> >> library(maptools)
>> >> library (tidyr)
>> >> library(plyr)
>> >> rm(list = ls())
>> >> par(mfrow=c(2,2))
>> >> cols=c("red", "black", "blue", "yellow")
>> >> cols<-adjustcolor(cols,alpha.f=.5)
>> >>
>> >> p2<-
>> >>
>> >>
>> >> SpatialPolygons(list(Polygons(list(Polygon(cbind(c(1,4,4,1,1),c(1,1,4,4,1)),hole
>> >> = F)), 1 ),
>> >>
>> >>  Polygons(list(Polygon(cbind(c(3,5,5,3,3),c(3,3,5,5,3)),hole = F)),
>> >> 2)))
>> >>
>> >> ID<-c(1,2)
>> >> YEAR<-c(1999,2002)
>> >> Type<-c(1,2)
>> >> mydf2<-data.frame(ID,YEAR,Type)
>> >> mySPDF2<-SpatialPolygonsDataFrame(p2,mydf2)
>> >> mySPDF2$Area<-gArea(mySPDF2, byid=TRUE)
>> >> print("mySPDF2 at data")
>> >> print(mySPDF2 at data)
>> >> plot(mySPDF2,axes=T,col=cols)
>> >> mtext("mySPDF2",cex=2)
>> >> mtext(paste("colors =","red", "yellow", "blue", "green,"), outer =
>> >> TRUE,
>> >> cex = 1.5)
>> >> #this is the step that does not give the desired result. It has the
>> >> same
>> >> two polygons ( areas 9 and 4) as the input, no intersection and
>> >> clipping of
>> >> the polygons occurs   I am trying to acheive the equivalent of a "self
>> >> union in ESRI ARCGIS.  The result I would like be four polygons: two "L
>> >> shaped plygons formed from the non- intersecting parts of the input
>> >> polygons (Areas 8 and 3 respecively), and two square polygons (
>> >> coincident
>> >> both of Area = )  I manually create my desired output in the next
>> >> section
>> >> to illustrate what I would like to achieve
>> >> myUnion<-unionSpatialPolygons(mySPDF2,IDs=mySPDF2$ID)
>> >> print("myUnion Areas:")
>> >> print (gArea(myUnion, byid=TRUE))
>> >> plot(myUnion,col=cols,axes=T)
>> >> mtext("myUnion",cex=2)
>> >> #Create example of desired output of "union" operation
>> >>
>> >>
>> >> p4<-SpatialPolygons(list(Polygons(list(Polygon(cbind(c(1,4,4,3,3,1,1),c(1,1,3,3,4,4,1)),hole
>> >> = F)), 1),
>> >>
>> >>  Polygons(list(Polygon(cbind(c(4,4,5,5,3,3,4),c(4,3,3,5,5,4,4)),hole =
>> >> F)),
>> >> 2),
>> >>
>> >>  Polygons(list(Polygon(cbind(c(3,4,4,3,3),c(3,3,4,4,3)),hole = F)), 3),
>> >>
>> >>  Polygons(list(Polygon(cbind(c(3,4,4,3,3),c(3,3,4,4,3)),hole = F)),
>> >> 4)))
>> >> ID<-c(1,2,3,4)
>> >> YEAR<-c(1999,2002,1999,2002)
>> >> Type<-c(1,2,1,2)
>> >> mydf4<- data.frame(ID,YEAR,Type)
>> >> mySPDF4<-SpatialPolygonsDataFrame(p4,mydf4)
>> >>
>> >>
>> >> centroids<-coordinates(mySPDF4)
>> >> mySPDF4$X_Centroid<-centroids[,1]
>> >> mySPDF4$Y_Centroid<-centroids[,2]
>> >> mySPDF4$MergeID<-paste(mySPDF4$X_Centroid,mySPDF4$Y_Centroid)
>> >> mySPDF4$MergeID<-unclass(as.factor(mySPDF4$MergeID))
>> >> mySPDF4$Area<-gArea(mySPDF4, byid=TRUE)
>> >> print("mySPDF4 at data")
>> >> print(mySPDF4 at data)
>> >> plot(mySPDF4, col=cols,axes=T)
>> >> mtext("mySPDF4",cex=2)
>> >> # the ultimate aim is to get a Flat ( ie non-overlapping polygons)
>> >> with
>> >> attributes that can then be joined back wide form table of to the YEAR
>> >> and
>> >> Type of mySPDF4
>> >>
>> >> #Flatten on "MergeID"
>> >> myUnion2<-unionSpatialPolygons(mySPDF4,IDs=mySPDF4$MergeID)
>> >> myDF<-as.data.frame(mySPDF4)
>> >> myDF<-arrange(myDF,MergeID,desc(YEAR))
>> >>
>> >> #add sequnce number for subsequent conversion to wide form
>> >> for( row in 1:nrow(myDF)){
>> >>   thisVal = myDF$MergeID[row]
>> >>   if (row ==1) Seq = 1 else {if (thisVal==lastVal) Seq =Seq+1 else Seq
>> >> =1}
>> >>   myDF$Sequence[row]<-Seq
>> >>   lastVal=thisVal
>> >> }
>> >> #make YEAR and Type into wide form
>> >> yearDF<-spread(myDF[,c("MergeID","Sequence",'YEAR')],Sequence,YEAR)
>> >> names(yearDF)<-c("ID","YEAR1","YEAR2")
>> >> typeDF<-spread(myDF[,c("MergeID","Sequence",'Type')],Sequence,Type)
>> >> names(typeDF)<-c("ID","Type1","Type2")
>> >> flatDF<-join(yearDF,typeDF)
>> >> rownames(flatDF)<-flatDF[,"ID"]
>> >> #append data frame to myUnion2 spatialpolygons
>> >> myUnion2<-SpatialPolygonsDataFrame(myUnion2,flatDF)
>> >> plot(myUnion2,col=cols,axes=T)
>> >> mtext("myUnion2",cex=2)
>> >> myUnion2$Area<-gArea(myUnion2, byid=TRUE)
>> >> print("myUnion2 at data")
>> >> print(myUnion2 at data)
>> >>
>> >>         [[alternative HTML version deleted]]
>> >>
>> >> _______________________________________________
>> >> R-sig-Geo mailing list
>> >> R-sig-Geo at r-project.org
>> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >>
>> >
>> >         [[alternative HTML version deleted]]
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at r-project.org
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


From thomas.a.stanley at nasa.gov  Wed Aug 12 19:44:36 2015
From: thomas.a.stanley at nasa.gov (Stanley, Thomas A. (GSFC-617.0)[USRA])
Date: Wed, 12 Aug 2015 17:44:36 +0000
Subject: [R-sig-Geo] is raster terrain accurate for WGS84 tiles?
Message-ID: <3F398AE4DC9EC749A5431CA9C851718D05C0D06C@NDMSMBX403.ndc.nasa.gov>

At https://rpubs.com/ajlyons/rspatialdata, a presentation shows the raster package's terrain function used directly on an unprojected raster near the Equator. I'd love to skip the steps of projecting and unprojecting my DEM tiles (eg http://www.viewfinderpanoramas.org/dem3/M11.zip), but I'm not sure the function is intended to be used in WGS 84 for all locations. The output values certainly look good. Can I correctly calculate slope without projecting my tiles, or is that wishful thinking?

-Thomas

	[[alternative HTML version deleted]]


From r.hijmans at gmail.com  Wed Aug 12 20:40:35 2015
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 12 Aug 2015 11:40:35 -0700
Subject: [R-sig-Geo] is raster terrain accurate for WGS84 tiles?
In-Reply-To: <3F398AE4DC9EC749A5431CA9C851718D05C0D06C@NDMSMBX403.ndc.nasa.gov>
References: <3F398AE4DC9EC749A5431CA9C851718D05C0D06C@NDMSMBX403.ndc.nasa.gov>
Message-ID: <CANtt_hwGZBZr2o7EgYNTghxu12pcYJ_2kdpkDQT3hr-fgL_8ug@mail.gmail.com>

Thomas,
I do not think it is wishful thinking. Au contraire, I think it is how
it should be done. That is, if you start with a longitude/latitude
raster with elevation values, and want slopes (or similar) also in
that coordinate reference system, then this should be the way to go,
as you skip two transformations, each of which would lead to data
quality loss.
Robert

((for the record, the question is about computing slopes from raster
data with a longitude/latitude (angular) coordinate reference system
---- the datum 'WGS 84'  is not relevant, as projected data also use
that datum))


On Wed, Aug 12, 2015 at 10:44 AM, Stanley, Thomas A.
(GSFC-617.0)[USRA] <thomas.a.stanley at nasa.gov> wrote:
> At https://rpubs.com/ajlyons/rspatialdata, a presentation shows the raster package's terrain function used directly on an unprojected raster near the Equator. I'd love to skip the steps of projecting and unprojecting my DEM tiles (eg http://www.viewfinderpanoramas.org/dem3/M11.zip), but I'm not sure the function is intended to be used in WGS 84 for all locations. The output values certainly look good. Can I correctly calculate slope without projecting my tiles, or is that wishful thinking?
>
> -Thomas
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From nevil.amos at gmail.com  Thu Aug 13 05:23:05 2015
From: nevil.amos at gmail.com (nevil amos)
Date: Thu, 13 Aug 2015 13:23:05 +1000
Subject: [R-sig-Geo] Union/Overlay single spatialPolygonsDataFrame
 containing overlapping polygonsto create polygons with all unique
 combinations of attributes
In-Reply-To: <CANtt_hxeF7Azcq4KkhdEkqF_J+97K=KMGPUdD=cmf99qN7cgdA@mail.gmail.com>
References: <CAN9eD7=yLbKWoGbFBussKt9rKYNENnqf_fsa-S+85TcmV2S8aA@mail.gmail.com>
	<CAAcGz98hRsbdARo9nJ8rGGDvXx2QvLdkxD0qK89jP56oi3HGfg@mail.gmail.com>
	<CANtt_hxeS6_ExX77YrW6q8=pNuYcTH3duD4gPWEy=xSOrNDFEg@mail.gmail.com>
	<CAN9eD7kprr2x-KXPORO1cpJQgs87PonDC4YgrHSUsRwukoMb3A@mail.gmail.com>
	<CANtt_hxeF7Azcq4KkhdEkqF_J+97K=KMGPUdD=cmf99qN7cgdA@mail.gmail.com>
Message-ID: <CAN9eD7mxEskOT85dBSXo7eRj-_LgQS2FvgPjcd-nrnJXkSS1cg@mail.gmail.com>

Thanks Robert,
I was getting an error when I ran it, and no mention of the case in the
help.
I then realised that my raster package was not up to date.
I have now updated and it works fine.



On Thu, Aug 13, 2015 at 3:06 AM, Robert J. Hijmans <r.hijmans at gmail.com>
wrote:

> Nevil,
>
> raster::union does not _require_ two SpatialPolygons*, it also works
> with one. See ?raster::union,  this is the (valid) case where 'y' is
> missing.
>
> > library(raster)
> > u <- union(p4)
> > data.frame(u)
>   ID.1 ID.2 ID.3 ID.4 count
> 1    1    0    0    0     1
> 2    0    1    1    0     2
> 3    0    0    0    1     1
>
> > u
> class       : SpatialPolygonsDataFrame
> features    : 3
> extent      : 1, 5, 1, 5  (xmin, xmax, ymin, ymax)
> coord. ref. : NA
> variables   : 5
> names       : ID.1, ID.2, ID.3, ID.4, count
> min values  :    0,    0,    0,    0,     1
> max values  :    1,    1,    1,    1,     2
>
> > plot(u, col=rainbow(3))
>
>
> Robert
>
> On Tue, Aug 11, 2015 at 8:14 PM, nevil amos <nevil.amos at gmail.com> wrote:
> > Thanks for the suggestions.
> >
> > unfortunately raster::union does not get the desired result,
> >
> > First it requires two, and only two spatialPolygons objects as inputs. -
> I
> > think the function I need must either have a single input containing all
> the
> > polygons, or one input for each polygon to work in more complex cases
> with
> > many polygons with more than tow overlapping polygons
> >
> > Second in my example it does indeed produce four polygons, however these
> > comprise the two original square polygons and two polygons from the
> > overlapping areas:
> >
> > #what union::(SPDF2,SPDF2) acheives
> >
> > par(mfrow=c(2,4))
> > myUnion<-raster::union(mySPDF2,mySPDF2)
> > myUnion$Area<-gArea(myUnion, byid=TRUE)
> > for (i in 1:4){
> >   plot(myUnion[i,],col=cols[i],axes=T,xlim=c(0,5),ylim=c(0,5))
> > }
> > print(myUnion at data)
> > print("Areas myUnion:")
> > print(gArea(myUnion, byid=TRUE))
> >
> >
> > #what is required:
> >
> >
> p4<-SpatialPolygons(list(Polygons(list(Polygon(cbind(c(1,4,4,3,3,1,1),c(1,1,3,3,4,4,1)),hole
> > = F)), "1_ "),
> >
> > Polygons(list(Polygon(cbind(c(3,4,4,3,3),c(3,3,4,4,3)),hole = F)),
> "1_2"),
> >
> > Polygons(list(Polygon(cbind(c(3,4,4,3,3),c(3,3,4,4,3)),hole = F)),
> "2_1"),
> >
> > Polygons(list(Polygon(cbind(c(4,4,5,5,3,3,4),c(4,3,3,5,5,4,4)),hole =
> F)),
> > "2_")))
> > for (i in 1:4){
> >   plot(p4[i,],col=cols[i],axes=T,xlim=c(0,5),ylim=c(0,5))
> > }
> > print("Areas p4:")
> > print(gArea(p4, byid=TRUE))
> >
> >
> > On Wed, Aug 12, 2015 at 11:02 AM, Robert J. Hijmans <r.hijmans at gmail.com
> >
> > wrote:
> >>
> >> I would think raster::union(polygons) should get you there.
> >> Robert
> >>
> >> On Tue, Aug 11, 2015 at 7:58 AM, Michael Sumner <mdsumner at gmail.com>
> >> wrote:
> >> > On Mon, 10 Aug 2015 at 17:52 nevil amos <nevil.amos at gmail.com> wrote:
> >> >
> >> >> I am attempting to combine overlapping polygons in a
> >> >> single spatialPolygonsDataFrame so that the output is a set of
> polygons
> >> >> such that where there is no overlap one polygon, of the
> >> >> non-intersecting
> >> >> area will be formed, and retain the attributes of the original
> polygon.
> >> >>  where polygons intersect  new polygons, of the intersecting area
> only
> >> >> will
> >> >> be formed, one with the attributes of each of the original polygons
> >> >> intersecting in that area.
> >> >>
> >> >> The example includes a single overlap, the real data may contain many
> >> >> tens
> >> >> or hundreds of intersecting polygons, from among tens of thousands of
> >> >> polygons.
> >> >>
> >> >> the step that I cannot work out is "myUnion"  it is aiming to achieve
> >> >> the
> >> >> equivalent of a self- union in ESRI geoprocessing.
> >> >>
> >> >> I realize that I can achieve a similar result with raster but would
> >> >> prefer
> >> >> to stay with polygons for this process.
> >> >>
> >> >>
> >> >
> >> > Is raster::cover closer to what you want?
> >> >
> >> > library(raster)
> >> >
> >> > plot(mySPDF2)
> >> >  plot(cover(mySPDF2[1,], mySPDF2[,2]), add = TRUE, col = rgb(c(0, 1),
> >> > c(0,
> >> > 0), c(1, 0), c(0.5)))
> >> >  plot(mySPDF2)
> >> >  plot(cover(mySPDF2[2,], mySPDF2[1,]), add = TRUE, col = rgb(c(0, 0),
> >> > c(0,
> >> > 1), c(1, 0), c(0.5)))
> >> >
> >> > You'll still need to take the non-overlapping piece from the
> complement
> >> > overlay. I don't know if there's an easier way.
> >> > See ?"raster-package" for a complete overview.
> >> >
> >> > HTH, Mike.
> >> >
> >> >
> >> > many thanks in advance
> >> >>
> >> >> Nevil Amos
> >> >>
> >> >> Trivial example:
> >> >> library(rgeos)
> >> >> library(maptools)
> >> >> library (tidyr)
> >> >> library(plyr)
> >> >> rm(list = ls())
> >> >> par(mfrow=c(2,2))
> >> >> cols=c("red", "black", "blue", "yellow")
> >> >> cols<-adjustcolor(cols,alpha.f=.5)
> >> >>
> >> >> p2<-
> >> >>
> >> >>
> >> >>
> SpatialPolygons(list(Polygons(list(Polygon(cbind(c(1,4,4,1,1),c(1,1,4,4,1)),hole
> >> >> = F)), 1 ),
> >> >>
> >> >>  Polygons(list(Polygon(cbind(c(3,5,5,3,3),c(3,3,5,5,3)),hole = F)),
> >> >> 2)))
> >> >>
> >> >> ID<-c(1,2)
> >> >> YEAR<-c(1999,2002)
> >> >> Type<-c(1,2)
> >> >> mydf2<-data.frame(ID,YEAR,Type)
> >> >> mySPDF2<-SpatialPolygonsDataFrame(p2,mydf2)
> >> >> mySPDF2$Area<-gArea(mySPDF2, byid=TRUE)
> >> >> print("mySPDF2 at data")
> >> >> print(mySPDF2 at data)
> >> >> plot(mySPDF2,axes=T,col=cols)
> >> >> mtext("mySPDF2",cex=2)
> >> >> mtext(paste("colors =","red", "yellow", "blue", "green,"), outer =
> >> >> TRUE,
> >> >> cex = 1.5)
> >> >> #this is the step that does not give the desired result. It has the
> >> >> same
> >> >> two polygons ( areas 9 and 4) as the input, no intersection and
> >> >> clipping of
> >> >> the polygons occurs   I am trying to acheive the equivalent of a
> "self
> >> >> union in ESRI ARCGIS.  The result I would like be four polygons: two
> "L
> >> >> shaped plygons formed from the non- intersecting parts of the input
> >> >> polygons (Areas 8 and 3 respecively), and two square polygons (
> >> >> coincident
> >> >> both of Area = )  I manually create my desired output in the next
> >> >> section
> >> >> to illustrate what I would like to achieve
> >> >> myUnion<-unionSpatialPolygons(mySPDF2,IDs=mySPDF2$ID)
> >> >> print("myUnion Areas:")
> >> >> print (gArea(myUnion, byid=TRUE))
> >> >> plot(myUnion,col=cols,axes=T)
> >> >> mtext("myUnion",cex=2)
> >> >> #Create example of desired output of "union" operation
> >> >>
> >> >>
> >> >>
> p4<-SpatialPolygons(list(Polygons(list(Polygon(cbind(c(1,4,4,3,3,1,1),c(1,1,3,3,4,4,1)),hole
> >> >> = F)), 1),
> >> >>
> >> >>  Polygons(list(Polygon(cbind(c(4,4,5,5,3,3,4),c(4,3,3,5,5,4,4)),hole
> =
> >> >> F)),
> >> >> 2),
> >> >>
> >> >>  Polygons(list(Polygon(cbind(c(3,4,4,3,3),c(3,3,4,4,3)),hole = F)),
> 3),
> >> >>
> >> >>  Polygons(list(Polygon(cbind(c(3,4,4,3,3),c(3,3,4,4,3)),hole = F)),
> >> >> 4)))
> >> >> ID<-c(1,2,3,4)
> >> >> YEAR<-c(1999,2002,1999,2002)
> >> >> Type<-c(1,2,1,2)
> >> >> mydf4<- data.frame(ID,YEAR,Type)
> >> >> mySPDF4<-SpatialPolygonsDataFrame(p4,mydf4)
> >> >>
> >> >>
> >> >> centroids<-coordinates(mySPDF4)
> >> >> mySPDF4$X_Centroid<-centroids[,1]
> >> >> mySPDF4$Y_Centroid<-centroids[,2]
> >> >> mySPDF4$MergeID<-paste(mySPDF4$X_Centroid,mySPDF4$Y_Centroid)
> >> >> mySPDF4$MergeID<-unclass(as.factor(mySPDF4$MergeID))
> >> >> mySPDF4$Area<-gArea(mySPDF4, byid=TRUE)
> >> >> print("mySPDF4 at data")
> >> >> print(mySPDF4 at data)
> >> >> plot(mySPDF4, col=cols,axes=T)
> >> >> mtext("mySPDF4",cex=2)
> >> >> # the ultimate aim is to get a Flat ( ie non-overlapping polygons)
> >> >> with
> >> >> attributes that can then be joined back wide form table of to the
> YEAR
> >> >> and
> >> >> Type of mySPDF4
> >> >>
> >> >> #Flatten on "MergeID"
> >> >> myUnion2<-unionSpatialPolygons(mySPDF4,IDs=mySPDF4$MergeID)
> >> >> myDF<-as.data.frame(mySPDF4)
> >> >> myDF<-arrange(myDF,MergeID,desc(YEAR))
> >> >>
> >> >> #add sequnce number for subsequent conversion to wide form
> >> >> for( row in 1:nrow(myDF)){
> >> >>   thisVal = myDF$MergeID[row]
> >> >>   if (row ==1) Seq = 1 else {if (thisVal==lastVal) Seq =Seq+1 else
> Seq
> >> >> =1}
> >> >>   myDF$Sequence[row]<-Seq
> >> >>   lastVal=thisVal
> >> >> }
> >> >> #make YEAR and Type into wide form
> >> >> yearDF<-spread(myDF[,c("MergeID","Sequence",'YEAR')],Sequence,YEAR)
> >> >> names(yearDF)<-c("ID","YEAR1","YEAR2")
> >> >> typeDF<-spread(myDF[,c("MergeID","Sequence",'Type')],Sequence,Type)
> >> >> names(typeDF)<-c("ID","Type1","Type2")
> >> >> flatDF<-join(yearDF,typeDF)
> >> >> rownames(flatDF)<-flatDF[,"ID"]
> >> >> #append data frame to myUnion2 spatialpolygons
> >> >> myUnion2<-SpatialPolygonsDataFrame(myUnion2,flatDF)
> >> >> plot(myUnion2,col=cols,axes=T)
> >> >> mtext("myUnion2",cex=2)
> >> >> myUnion2$Area<-gArea(myUnion2, byid=TRUE)
> >> >> print("myUnion2 at data")
> >> >> print(myUnion2 at data)
> >> >>
> >> >>         [[alternative HTML version deleted]]
> >> >>
> >> >> _______________________________________________
> >> >> R-sig-Geo mailing list
> >> >> R-sig-Geo at r-project.org
> >> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >> >>
> >> >
> >> >         [[alternative HTML version deleted]]
> >> >
> >> > _______________________________________________
> >> > R-sig-Geo mailing list
> >> > R-sig-Geo at r-project.org
> >> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> >
>

	[[alternative HTML version deleted]]


From alperd.web at gmail.com  Sun Aug 16 20:56:03 2015
From: alperd.web at gmail.com (=?UTF-8?Q?Alper_Din=C3=A7er?=)
Date: Sun, 16 Aug 2015 21:56:03 +0300
Subject: [R-sig-Geo] Raster Export as PNG
Message-ID: <CAAtjZP_Hg-8xuqTy3CcpOB4UzxRq6XKDyhOUVh5vRYoSpAoLDg@mail.gmail.com>

Hi,

I'm very new to R and I'm trying to achieve something which may be easy but
I couldn't find any solutions for a week.

I read a GeoTiff file with Raster library and then crop with mask it with
shape file. Then I want to save it as a PNG file to show it on Google Maps
JS API, but it doesn't work due to inner margins when using plot().

This the code I'm working on :
---------Code----------------------------

xidw <- raster("output_6.tiff")

crs(xidw) <- "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"

xidw.sub <- crop(xidw, extent(state))
xidw.sub <- mask(xidw.sub, state)

yidw <- projectRaster(xidw.sub, crs='+proj=merc +a=6378137 +b=6378137
+lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null
+no_defs')

png(filename="output.png", width=800, height=500, bg="transparent")
plot(yidw, axes = F, box = F, legend = F)
dev.off();

---------Code----------------------------

Is there anything that I can get the PNG file with full extent of of my
cropped and masked raster?

Thanks.

Best wishes.

A

	[[alternative HTML version deleted]]


From mdsumner at gmail.com  Mon Aug 17 01:59:16 2015
From: mdsumner at gmail.com (Michael Sumner)
Date: Sun, 16 Aug 2015 23:59:16 +0000
Subject: [R-sig-Geo] Raster Export as PNG
In-Reply-To: <CAAtjZP_Hg-8xuqTy3CcpOB4UzxRq6XKDyhOUVh5vRYoSpAoLDg@mail.gmail.com>
References: <CAAtjZP_Hg-8xuqTy3CcpOB4UzxRq6XKDyhOUVh5vRYoSpAoLDg@mail.gmail.com>
Message-ID: <CAAcGz9-82nO3nGsimZB9iz=Q9wa9nuwCRD41pf0XiLMdYUZ6xw@mail.gmail.com>

I would use rgdal::writeGDAL to create the png, rather than drawing to the
png device.

What you need to do depends on how to display your data, since you'll
either have to modify the raster to replace its data with colour values
(either as a palette or greyscale or rgb). I routinely convert raster data
via a colour map, and I think you could get close to your plot with

scl <- function(x) (x - min(na.omit(x)))/diff(range(na.omit(x)))
cols <- rev(terrain.colors(256)[scl(values(yidw))])
img <- setValues(brick(yidw, yidw, yidw), cbind(cols, cols, cols))

rgdal::writeGDAL(as(img, "SpatialGridDataFrame"), "outputRGB.png",
drivername = "PNG", type = "Byte")

That is untested though, it aims to replace your single band raster with a
RGB version with the colours all expanded out. You can see what the image
file will look like with plotRGB(img).

It's possibly wasteful to build a full RGB if the dynamic range does not
require it, but  the details of your specific data matter here.

Cheers, Mike.



On Mon, 17 Aug 2015 at 04:56 Alper Din?er <alperd.web at gmail.com> wrote:

> Hi,
>
> I'm very new to R and I'm trying to achieve something which may be easy but
> I couldn't find any solutions for a week.
>
> I read a GeoTiff file with Raster library and then crop with mask it with
> shape file. Then I want to save it as a PNG file to show it on Google Maps
> JS API, but it doesn't work due to inner margins when using plot().
>
> This the code I'm working on :
> ---------Code----------------------------
>
> xidw <- raster("output_6.tiff")
>
> crs(xidw) <- "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"
>
> xidw.sub <- crop(xidw, extent(state))
> xidw.sub <- mask(xidw.sub, state)
>
> yidw <- projectRaster(xidw.sub, crs='+proj=merc +a=6378137 +b=6378137
> +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null
> +no_defs')
>
> png(filename="output.png", width=800, height=500, bg="transparent")
> plot(yidw, axes = F, box = F, legend = F)
> dev.off();
>
> ---------Code----------------------------
>
> Is there anything that I can get the PNG file with full extent of of my
> cropped and masked raster?
>
> Thanks.
>
> Best wishes.
>
> A
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From mdsumner at gmail.com  Mon Aug 17 02:00:12 2015
From: mdsumner at gmail.com (Michael Sumner)
Date: Mon, 17 Aug 2015 00:00:12 +0000
Subject: [R-sig-Geo] Raster Export as PNG
In-Reply-To: <CAAcGz9-82nO3nGsimZB9iz=Q9wa9nuwCRD41pf0XiLMdYUZ6xw@mail.gmail.com>
References: <CAAtjZP_Hg-8xuqTy3CcpOB4UzxRq6XKDyhOUVh5vRYoSpAoLDg@mail.gmail.com>
	<CAAcGz9-82nO3nGsimZB9iz=Q9wa9nuwCRD41pf0XiLMdYUZ6xw@mail.gmail.com>
Message-ID: <CAAcGz9-ERDMXjo0RMJ9RqFPUAFZjMp=x5nCv2Tg3=TeYPga8NA@mail.gmail.com>

I made a mistake of course, it should be

cols <- rev(terrain.colors(256)[scl(values(yidw)) * 255 + 1])



On Mon, 17 Aug 2015 at 10:03 Michael Sumner <mdsumner at gmail.com> wrote:

> I would use rgdal::writeGDAL to create the png, rather than drawing to the
> png device.
>
> What you need to do depends on how to display your data, since you'll
> either have to modify the raster to replace its data with colour values
> (either as a palette or greyscale or rgb). I routinely convert raster data
> via a colour map, and I think you could get close to your plot with
>
> scl <- function(x) (x - min(na.omit(x)))/diff(range(na.omit(x)))
> cols <- rev(terrain.colors(256)[scl(values(yidw))])
> img <- setValues(brick(yidw, yidw, yidw), cbind(cols, cols, cols))
>
> rgdal::writeGDAL(as(img, "SpatialGridDataFrame"), "outputRGB.png",
> drivername = "PNG", type = "Byte")
>
> That is untested though, it aims to replace your single band raster with a
> RGB version with the colours all expanded out. You can see what the image
> file will look like with plotRGB(img).
>
> It's possibly wasteful to build a full RGB if the dynamic range does not
> require it, but  the details of your specific data matter here.
>
> Cheers, Mike.
>
>
>
> On Mon, 17 Aug 2015 at 04:56 Alper Din?er <alperd.web at gmail.com> wrote:
>
>> Hi,
>>
>> I'm very new to R and I'm trying to achieve something which may be easy
>> but
>> I couldn't find any solutions for a week.
>>
>> I read a GeoTiff file with Raster library and then crop with mask it with
>> shape file. Then I want to save it as a PNG file to show it on Google Maps
>> JS API, but it doesn't work due to inner margins when using plot().
>>
>> This the code I'm working on :
>> ---------Code----------------------------
>>
>> xidw <- raster("output_6.tiff")
>>
>> crs(xidw) <- "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"
>>
>> xidw.sub <- crop(xidw, extent(state))
>> xidw.sub <- mask(xidw.sub, state)
>>
>> yidw <- projectRaster(xidw.sub, crs='+proj=merc +a=6378137 +b=6378137
>> +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null
>> +no_defs')
>>
>> png(filename="output.png", width=800, height=500, bg="transparent")
>> plot(yidw, axes = F, box = F, legend = F)
>> dev.off();
>>
>> ---------Code----------------------------
>>
>> Is there anything that I can get the PNG file with full extent of of my
>> cropped and masked raster?
>>
>> Thanks.
>>
>> Best wishes.
>>
>> A
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>

	[[alternative HTML version deleted]]


From Alexander.Herr at csiro.au  Mon Aug 17 03:22:58 2015
From: Alexander.Herr at csiro.au (Alexander.Herr at csiro.au)
Date: Mon, 17 Aug 2015 01:22:58 +0000
Subject: [R-sig-Geo] plotKML transparency and legend
Message-ID: <DE9431576890DA46BC57EA03BC10449B9BF3E073@exmbx06-cdc.nexus.csiro.au>

Hi List,

I am unable to get the transparency (alpha) and the legend (colour_scale, or colour) to work using kml. Attached my working example, which attempts to build kml outputs for individual raster values.

library(plotKML)
library(sp)
library(raster)
require(grDevices)
demo(meuse, echo=FALSE)
raster(meuse.grid['soil'])->r


#set up colors
jet.colors <-
  colorRampPalette(c("#00007F", "blue", "#007FFF", "cyan",
                    "#7FFF7F", "yellow", "#FF7F00", "red", "#7F0000"))

col1=jet.colors(r at data@max)

#setup data extraction from raster and filenaming
fun1<-function(x){x[x != i]<-NA; return(x)}
spa4under<-function(x){gsub('([[:punct:]])|\\s+','_',x)}

# go for extraction
as.data.frame(levels(r))->rat
rat$col1<-col1

for (i in rat[,1])
{
 print(paste0("ID: ",i))
  calc(r, fun=fun1)->r1
   ratify(r1)->r2
    as.data.frame(levels(r2))->ratx
     ratx$level<-factor(paste0("x",rat[i,2]))
      print(paste0(ratx$level))
      levels(r2)<-ratx

      nam1<-paste0(spa4under(rat[i,2]))
       plotKML(r2,raster_name=paste0("p_",nam1,".png"), folder.name = paste0("p_",nam1), filename=paste0("p_",nam1,".png") ,colour_scale=col1[i], alpha=0.75)
       kml(r2,raster_name=paste0('k_',nam1,".png"), folder.name = paste0('k_',nam1,".png"), file=paste0('k_',nam1,'.kml') ,colour='level',colour_scale=col1[i], alpha=0.75)
        kml(r2,raster_name=paste0('kx_',nam1,".png"), folder.name = paste0('kx_',nam1,".png"), file=paste0('kx_',nam1,'.kml') ,colour_scale=col1[i], alpha=0.75)
        system(paste0("open ",file=paste0('k_',nam1,'.kml'))) 
       system(paste0("open ",file=paste0('kx_',nam1,'.kml')))
}

Any suggestions on where I am going wrong?

Thanks
Herry


---

From uzzal at gist.ac.kr  Mon Aug 17 09:43:17 2015
From: uzzal at gist.ac.kr (Uzzal)
Date: Mon, 17 Aug 2015 16:43:17 +0900 (KST)
Subject: [R-sig-Geo] How to plot multiple semi-variogram from a single
	dataset efficiently in R?
Message-ID: <507663865.1439797397739.JavaMail.root@eunhasu>

Actually I asked this same question to some other forum but unfortunate I didn't get the appropriate response. But I am kind of struck with this problem. I am giving the link of my problem previously posted in other forum: (really sorry for that)
http://stackoverflow.com/questions/31762461/how-to-plot-multiple-semi-variogram-from-a-single-dataset-efficiently-in-r?noredirect=1#comment51767989_31762461

I want variogram time wise. For example, thevariogram  for 1.00 am  of 1 march to 7 march in one plot. That means 7 variograms in one plot. in such a way there will be 23 plot contains (23*7) variogram. Thanks in advance.

Orpheus



Uzzal Kumar Dash
Master's studentAir Quality &amp; Climate Modeling Laboratory (AqCliMB)School of Environmental Science and Engineering (SESE)Gwangju Institute of Science and Technology (GIST)123 Cheomdan-gwagiro, Buk-gu, Gwangju 500-712
Republic of Korea
web: http://aqclimb.gist.ac.kr/

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150817/4ee127b6/attachment.html>

From antonio.bubbico at gmail.com  Mon Aug 17 11:44:55 2015
From: antonio.bubbico at gmail.com (Antonio Bubbico)
Date: Mon, 17 Aug 2015 11:44:55 +0200
Subject: [R-sig-Geo] Counting regions in the Moran Plot Quadrants
Message-ID: <CABW+3tDCU1-kvh4oiMP93AGSpHa1kdvLQAEXGYs3gOUHE0CW9A@mail.gmail.com>

Hello All,

I am using the moran.plot{spedp} to make a moran plot for a number of
regions.

I would like to count the region in each quadrant of the plot.

Have you any idea how can I make it?

Regards.

-- 
*Dr Antonio Bubbico*
Postdoctoral Researcher




*School of Agriculture and Food ScienceUniversity College DublinBelfield,
Dublin 4Ireland*

Tel: +353899528966
e-mail: a <marija.banovic at ucd.ie>ntonio.bubbico at gmail.com
Room: 1.27

	[[alternative HTML version deleted]]


From tim.appelhans at gmail.com  Mon Aug 17 11:49:00 2015
From: tim.appelhans at gmail.com (Tim Appelhans)
Date: Mon, 17 Aug 2015 11:49:00 +0200
Subject: [R-sig-Geo] How to plot multiple semi-variogram from a single
 dataset efficiently in R?
In-Reply-To: <507663865.1439797397739.JavaMail.root@eunhasu>
References: <507663865.1439797397739.JavaMail.root@eunhasu>
Message-ID: <55D1AE0C.9080202@gmail.com>

Orpheus,
here's one option to get what you want.
The problem with fitting that many variograms is that if you want to 
specify each variogram individually (i.e. nugget, range, model etc.), 
there is no way to automate this with loops or thelike.
You can, however, use library(automap) to automatically fit a variogram 
to your data. Then a possible solution could look like this:


### in order to use latticeCombineGrid() you need to use ##################
### library(devtools) to install library(Rsenal) ##########################
# install.packages(devtools)
# library(devtools)
# install_github("environmentalinformatics-marburg/Rsenal")
###########################################################################

library(sp)
library(gstat)
library(rgdal)
library(automap)
library(Rsenal)

seoul311 <- read.csv("Downloads/seoul1to7.csv")
seoul311 <- na.omit(seoul311)

### first we split seoul311 by time into a list rather than subsetting 
manually
seoul311_splt <- split(seoul311, seoul311$time)

### now we loop (using lapply()) over each seoul311_splt entry and 
calculate
### variogram using autofitVariogram and return the variogram plot
vars <- lapply(seq(seoul311_splt), function(i) {

   dat <- seoul311_splt[[i]]
   coordinates(dat) <- ~LON+LAT
   proj4string(dat) <- "+proj=longlat +datum=WGS84"
   dat <- spTransform(dat, CRS("+proj=utm +north +zone=52 +datum=WGS84"))

   variogram <- autofitVariogram(PM10 ~ 1, dat)

   plt <- plot(variogram, plotit = FALSE, asp = 1)

   ### in case you do not want to fix xlim and ylim to be identical
   ### for each plot just comment out the following line or change
   ### values as you see fit
   plt <- update(plt, xlim = c(-1000, 45000), ylim = c(0, 1000))

   return(plt)
})

### now we actually have 23 * 7 variogram plots which we will combine
### into 23 hourly plots using latticeCombineGrid()
hrs <- substr(names(seoul311_splt), 9, 10)

plts_hrs <- lapply(seq(unique(hrs)), function(j) {

   indx <- hrs %in% unique(hrs)[j]
   hr_plt <- vars[indx]

   return(latticeCombineGrid(hr_plt, layout = c(3, 3)))

})

### plot for hour 1
plts_hrs[[1]]

### plot for hour 23
plts_hrs[[23]]

### ...


HTH

Best,
Tim


On 17.08.2015 09:43, Uzzal wrote:
> Actually I asked this same question to some other forum but 
> unfortunate I didn't get the appropriate response. But I am kind of 
> struck with this problem. I am giving the link of my problem 
> previously posted in other forum: (really sorry for that)
> http://stackoverflow.com/questions/31762461/how-to-plot-multiple-semi-variogram-from-a-single-dataset-efficiently-in-r?noredirect=1#comment51767989_31762461
>
> I want variogram time wise. For example, thevariogram for 1.00 am of 1 
> march to 7 march in one plot. That means 7 variograms in one plot. in 
> such a way there will be 23 plot contains (23*7) variogram. Thanks in 
> adv! ance.
>
> Orpheus
>
>
>
> Uzzal Kumar Dash
> Master's student
> Air Quality & Climate Modeling Laboratory (AqCliMB)
> School of Environmental Science and Engineering (SESE)
> Gwangju Institute of Science and Technology (GIST)
> 123 Cheomdan-gwagiro, Buk-gu, Gwangju 500-712
> Republic of Korea
>
> web: http://aqclimb.gist.ac.kr/
>
>
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
#####################################
Tim Appelhans
Department of Geography
Environmental Informatics
Philipps Universit?t Marburg
Deutschhausstra?e 12
35032 Marburg (Paketpost: 35037 Marburg)
Germany

Tel +49 (0) 6421 28-25957

http://environmentalinformatics-marburg.de/


	[[alternative HTML version deleted]]


From kittlein at mdp.edu.ar  Mon Aug 17 11:43:27 2015
From: kittlein at mdp.edu.ar (Marcelo Kittlein)
Date: Mon, 17 Aug 2015 09:43:27 +0000
Subject: [R-sig-Geo] georeferencing image from scratch
In-Reply-To: <55CC7C41.1090306@mdp.edu.ar>
References: <55CC7C41.1090306@mdp.edu.ar>
Message-ID: <55D1ACBF.3090507@mdp.edu.ar>


Hi all

I want to change a MSS landsat image which has bad georeferencing.

I have a grid of points with correct georeferences and want to use them 
to reproject the image to a correct reference system.

Is there some way to this in R using "raster" or other package?

in idrisi I used to resample the image using a correspondence file 
(.cor) with xold yold xnew ynew values.

I wonder if there is something similar I can do in R? Thanks in advance

Marcelo Kittlein


From loic.dutrieux at wur.nl  Mon Aug 17 16:34:16 2015
From: loic.dutrieux at wur.nl (=?windows-1252?Q?Lo=EFc_Dutrieux?=)
Date: Mon, 17 Aug 2015 16:34:16 +0200
Subject: [R-sig-Geo] georeferencing image from scratch
In-Reply-To: <55D1ACBF.3090507@mdp.edu.ar>
References: <55CC7C41.1090306@mdp.edu.ar> <55D1ACBF.3090507@mdp.edu.ar>
Message-ID: <55D1F0E8.9090204@wur.nl>

Hi Marcelo,

I don't see anything in raster or rgdal that would do that directly. 
However, this can be done I believe using gdal_translate / gdal_edit 
(for adding the GCPs to the dataset) + gdalwarp (for warping). Both 
gdal_translate and gdalwarp utilities have wrappers in the gdalUtils 
package.

Cheers,
Lo?c Dutrieux

On 08/17/2015 11:43 AM, Marcelo Kittlein wrote:
>
> Hi all
>
> I want to change a MSS landsat image which has bad georeferencing.
>
> I have a grid of points with correct georeferences and want to use them
> to reproject the image to a correct reference system.
>
> Is there some way to this in R using "raster" or other package?
>
> in idrisi I used to resample the image using a correspondence file
> (.cor) with xold yold xnew ynew values.
>
> I wonder if there is something similar I can do in R? Thanks in advance
>
> Marcelo Kittlein
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Dominik.Schneider at colorado.edu  Mon Aug 17 16:51:00 2015
From: Dominik.Schneider at colorado.edu (Dominik Schneider)
Date: Mon, 17 Aug 2015 08:51:00 -0600
Subject: [R-sig-Geo] georeferencing image from scratch
In-Reply-To: <55D1F0E8.9090204@wur.nl>
References: <55CC7C41.1090306@mdp.edu.ar> <55D1ACBF.3090507@mdp.edu.ar>
	<55D1F0E8.9090204@wur.nl>
Message-ID: <CAHYDKLYLLE-TMBpAHQO57tEbvYV2TxbRK-pFqg31i88j0yKN4g@mail.gmail.com>

Marcelo,
did you try alignExtent() in the raster package?


Dominik Schneider
o 303.735.6296 | c 518.956.3978


On Mon, Aug 17, 2015 at 8:34 AM, Lo?c Dutrieux <loic.dutrieux at wur.nl> wrote:

> Hi Marcelo,
>
> I don't see anything in raster or rgdal that would do that directly.
> However, this can be done I believe using gdal_translate / gdal_edit (for
> adding the GCPs to the dataset) + gdalwarp (for warping). Both
> gdal_translate and gdalwarp utilities have wrappers in the gdalUtils
> package.
>
> Cheers,
> Lo?c Dutrieux
>
>
> On 08/17/2015 11:43 AM, Marcelo Kittlein wrote:
>
>>
>> Hi all
>>
>> I want to change a MSS landsat image which has bad georeferencing.
>>
>> I have a grid of points with correct georeferences and want to use them
>> to reproject the image to a correct reference system.
>>
>> Is there some way to this in R using "raster" or other package?
>>
>> in idrisi I used to resample the image using a correspondence file
>> (.cor) with xold yold xnew ynew values.
>>
>> I wonder if there is something similar I can do in R? Thanks in advance
>>
>> Marcelo Kittlein
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From metastate at gmail.com  Tue Aug 18 04:12:41 2015
From: metastate at gmail.com (Metastate Metastate)
Date: Mon, 17 Aug 2015 21:12:41 -0500
Subject: [R-sig-Geo] Spatialpolygonsdataframe
Message-ID: <CAKpbK+cbMjZfjZ+Db6MbmhVuG40oxC0CfUhsH_jNQifnD3h+XQ@mail.gmail.com>

Hi all,

I am starting to learn spatial analysis using R. Do anyone know if the
attribute data in a spatialpolygonsdataframe can contain multiple
observations within the same polygon? To be specific, I have a
spatialpolygonsdataframe that contain USA county polygons and the relevant
attribute data contains the relevant state,county and FIPs.  And I also
have another data-frame that contains weather features by year by county
(For example there are yearly average temperature for each county) . How
can I join the spatialpolygondataframe with the weather data so that the
resulted attribute table in the joint spatialpolygonsdataframe can contain
*multiple-year* weather features within each county?

Thank you very much for any kindly help.

Meta

	[[alternative HTML version deleted]]


From loic.dutrieux at wur.nl  Tue Aug 18 10:31:20 2015
From: loic.dutrieux at wur.nl (=?windows-1252?Q?Lo=EFc_Dutrieux?=)
Date: Tue, 18 Aug 2015 10:31:20 +0200
Subject: [R-sig-Geo] Spatialpolygonsdataframe
In-Reply-To: <CAKpbK+cbMjZfjZ+Db6MbmhVuG40oxC0CfUhsH_jNQifnD3h+XQ@mail.gmail.com>
References: <CAKpbK+cbMjZfjZ+Db6MbmhVuG40oxC0CfUhsH_jNQifnD3h+XQ@mail.gmail.com>
Message-ID: <55D2ED58.1020203@wur.nl>

Hi,

Have a look at merge in the sp package.
?sp::merge

Cheers,
Lo?c

On 08/18/2015 04:12 AM, Metastate Metastate wrote:
> Hi all,
>
> I am starting to learn spatial analysis using R. Do anyone know if the
> attribute data in a spatialpolygonsdataframe can contain multiple
> observations within the same polygon? To be specific, I have a
> spatialpolygonsdataframe that contain USA county polygons and the relevant
> attribute data contains the relevant state,county and FIPs.  And I also
> have another data-frame that contains weather features by year by county
> (For example there are yearly average temperature for each county) . How
> can I join the spatialpolygondataframe with the weather data so that the
> resulted attribute table in the joint spatialpolygonsdataframe can contain
> *multiple-year* weather features within each county?
>
> Thank you very much for any kindly help.
>
> Meta
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From kittlein at mdp.edu.ar  Tue Aug 18 12:21:35 2015
From: kittlein at mdp.edu.ar (Marcelo Kittlein)
Date: Tue, 18 Aug 2015 10:21:35 +0000
Subject: [R-sig-Geo] georeferencing image from scratch
In-Reply-To: <CAHYDKLYLLE-TMBpAHQO57tEbvYV2TxbRK-pFqg31i88j0yKN4g@mail.gmail.com>
References: <55CC7C41.1090306@mdp.edu.ar> <55D1ACBF.3090507@mdp.edu.ar>
	<55D1F0E8.9090204@wur.nl>
	<CAHYDKLYLLE-TMBpAHQO57tEbvYV2TxbRK-pFqg31i88j0yKN4g@mail.gmail.com>
Message-ID: <55D3072F.5040408@mdp.edu.ar>

Thank both of you Dominik and Lo?c

alignExtent() did the job after regressing the wright points vs bad 
points and predicting a new correct extent. After setting the new 
extent, the points match correctly known features of the image.

I would give a try to gdalwarp to add GCPs to the dataset.


On 17/08/15 14:51, Dominik Schneider wrote:
> Marcelo,
> did you try alignExtent() in the raster package?
>
>
> Dominik Schneider
> o 303.735.6296 | c 518.956.3978
>
>
> On Mon, Aug 17, 2015 at 8:34 AM, Lo?c Dutrieux <loic.dutrieux at wur.nl> wrote:
>
>> Hi Marcelo,
>>
>> I don't see anything in raster or rgdal that would do that directly.
>> However, this can be done I believe using gdal_translate / gdal_edit (for
>> adding the GCPs to the dataset) + gdalwarp (for warping). Both
>> gdal_translate and gdalwarp utilities have wrappers in the gdalUtils
>> package.
>>
>> Cheers,
>> Lo?c Dutrieux
>>
>>
>> On 08/17/2015 11:43 AM, Marcelo Kittlein wrote:
>>
>>> Hi all
>>>
>>> I want to change a MSS landsat image which has bad georeferencing.
>>>
>>> I have a grid of points with correct georeferences and want to use them
>>> to reproject the image to a correct reference system.
>>>
>>> Is there some way to this in R using "raster" or other package?
>>>
>>> in idrisi I used to resample the image using a correspondence file
>>> (.cor) with xold yold xnew ynew values.
>>>
>>> I wonder if there is something similar I can do in R? Thanks in advance
>>>
>>> Marcelo Kittlein
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From metastate at gmail.com  Wed Aug 19 02:57:53 2015
From: metastate at gmail.com (Metastate Metastate)
Date: Tue, 18 Aug 2015 19:57:53 -0500
Subject: [R-sig-Geo] Spatialpolygonsdataframe
In-Reply-To: <CAKpbK+cPrKXL8FVKODHCOweUFiPtsnNGVKhCjtiNrZhqXzSKKA@mail.gmail.com>
References: <CAKpbK+cbMjZfjZ+Db6MbmhVuG40oxC0CfUhsH_jNQifnD3h+XQ@mail.gmail.com>
	<55D2ED58.1020203@wur.nl>
	<CAKpbK+cPrKXL8FVKODHCOweUFiPtsnNGVKhCjtiNrZhqXzSKKA@mail.gmail.com>
Message-ID: <CAKpbK+fyBox-WBF9DsAPwNOffPVPdhSNQZhHhht59JcAu1QuMg@mail.gmail.com>

Hi

I tried to use sp merge to join the spatialpolygonddataframe (xx) and an
dataframe (yy4), which have 2 observations for each spatial ID. But it did
not allow with an error message as below:
 Error in .local(x, y, ...) :  'y' has multiple records for one or more
'by.y' key(s)

I also tried the mapmerge in eeptools but failed.

Any suggestion? Thank you very much.

Meta


library("eeptools")
library("sp")
xx <- maptools::readShapePoly(system.file("shapes/sids.shp",
package="maptools")[1], IDvar="FIPSNO")
yy<-as(xx,"data.frame")
yy$newvar<-sample(0:100,nrow(yy),replace=TRUE)
yy<-subset(yy,select=c("FIPS","newvar"))
yy3<-yy
yy3$newvar<-10*yy3$newvar
yy4<-data.frame(rbind(yy,yy3))
newpoly<-merge(xx,yy4,sort=FALSE, by.x="FIPS",
                  by.y="FIPS" ,all.y=TRUE)


On Tue, Aug 18, 2015 at 7:31 PM, Metastate Metastate <metastate at gmail.com>
wrote:

> Cool. Let me take a look. Thank you very much, Lo?c.
>
> Meta
>
>
>
> On Tue, Aug 18, 2015 at 3:31 AM, Lo?c Dutrieux <loic.dutrieux at wur.nl>
> wrote:
>
>> Hi,
>>
>> Have a look at merge in the sp package.
>> ?sp::merge
>>
>> Cheers,
>> Lo?c
>>
>> On 08/18/2015 04:12 AM, Metastate Metastate wrote:
>>
>>> Hi all,
>>>
>>> I am starting to learn spatial analysis using R. Do anyone know if the
>>> attribute data in a spatialpolygonsdataframe can contain multiple
>>> observations within the same polygon? To be specific, I have a
>>> spatialpolygonsdataframe that contain USA county polygons and the
>>> relevant
>>> attribute data contains the relevant state,county and FIPs.  And I also
>>> have another data-frame that contains weather features by year by county
>>> (For example there are yearly average temperature for each county) . How
>>> can I join the spatialpolygondataframe with the weather data so that the
>>> resulted attribute table in the joint spatialpolygonsdataframe can
>>> contain
>>> *multiple-year* weather features within each county?
>>>
>>> Thank you very much for any kindly help.
>>>
>>> Meta
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>

	[[alternative HTML version deleted]]


From patrick.giraudoux at univ-fcomte.fr  Wed Aug 19 09:53:14 2015
From: patrick.giraudoux at univ-fcomte.fr (Patrick Giraudoux)
Date: Wed, 19 Aug 2015 09:53:14 +0200
Subject: [R-sig-Geo] GPX and writeOGR
In-Reply-To: <mailman.11.1439892003.13784.r-sig-geo@r-project.org>
References: <mailman.11.1439892003.13784.r-sig-geo@r-project.org>
Message-ID: <55D435EA.1060403@univ-fcomte.fr>

Dear listers,

I am struggling with writeOGR (package rgdal) to make it write a gpx 
file. Among other trials, I am stuck with this (dbposWGS84 is a 
SpatialPointsDataFrame with three attribute fields):

writeOGR(dbposWGS84,"dbposWGS84","waypoints","GPX") Error in 
writeOGR(dbposWGS84, "dbposWGS84", "waypoints", "GPX") : Creating Name 
field failed


Any idea about what is going wrong ?

Patrick



	[[alternative HTML version deleted]]


From Roger.Bivand at nhh.no  Wed Aug 19 10:32:41 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 19 Aug 2015 10:32:41 +0200
Subject: [R-sig-Geo] GPX and writeOGR
In-Reply-To: <55D435EA.1060403@univ-fcomte.fr>
References: <mailman.11.1439892003.13784.r-sig-geo@r-project.org>
	<55D435EA.1060403@univ-fcomte.fr>
Message-ID: <alpine.LFD.2.20.1508191032001.26379@reclus.nhh.no>

On Wed, 19 Aug 2015, Patrick Giraudoux wrote:

> Dear listers,
>
> I am struggling with writeOGR (package rgdal) to make it write a gpx
> file. Among other trials, I am stuck with this (dbposWGS84 is a
> SpatialPointsDataFrame with three attribute fields):
>
> writeOGR(dbposWGS84,"dbposWGS84","waypoints","GPX") Error in
> writeOGR(dbposWGS84, "dbposWGS84", "waypoints", "GPX") : Creating Name
> field failed
>
>
> Any idea about what is going wrong ?

You need the dataset_options="GPX_USE_EXTENSIONS=YES" argument, see:

http://www.gdal.org/drv_gpx.html

Roger

>
> Patrick
>
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Wed Aug 19 10:55:04 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 19 Aug 2015 10:55:04 +0200
Subject: [R-sig-Geo] Spatialpolygonsdataframe
In-Reply-To: <CAKpbK+fyBox-WBF9DsAPwNOffPVPdhSNQZhHhht59JcAu1QuMg@mail.gmail.com>
References: <CAKpbK+cbMjZfjZ+Db6MbmhVuG40oxC0CfUhsH_jNQifnD3h+XQ@mail.gmail.com>
	<55D2ED58.1020203@wur.nl>
	<CAKpbK+cPrKXL8FVKODHCOweUFiPtsnNGVKhCjtiNrZhqXzSKKA@mail.gmail.com>
	<CAKpbK+fyBox-WBF9DsAPwNOffPVPdhSNQZhHhht59JcAu1QuMg@mail.gmail.com>
Message-ID: <alpine.LFD.2.20.1508191049380.26379@reclus.nhh.no>

On Wed, 19 Aug 2015, Metastate Metastate wrote:

> Hi
>
> I tried to use sp merge to join the spatialpolygonddataframe (xx) and an
> dataframe (yy4), which have 2 observations for each spatial ID. But it did
> not allow with an error message as below:
> Error in .local(x, y, ...) :  'y' has multiple records for one or more
> 'by.y' key(s)
>
> I also tried the mapmerge in eeptools but failed.
>
> Any suggestion? Thank you very much.
>
> Meta
>

Thanks for a reproducible example. Don't use merge() unless you know 
already that the objects are conformable:

>
> library("eeptools")
> library("sp")
> xx <- maptools::readShapePoly(system.file("shapes/sids.shp",
> package="maptools")[1], IDvar="FIPSNO")
> yy<-as(xx,"data.frame")
> yy$newvar<-sample(0:100,nrow(yy),replace=TRUE)
> yy<-subset(yy,select=c("FIPS","newvar"))
> yy3<-yy
> yy3$newvar<-10*yy3$newvar
> yy4<-data.frame(rbind(yy,yy3))
> newpoly<-merge(xx,yy4,sort=FALSE, by.x="FIPS",
>                  by.y="FIPS" ,all.y=TRUE)

Look at str(yy4) and dim(xx) - they are not conformable. Add a "time" 
variable and use reshape() to get to a conformable object:

yy4$time <- c(rep(1, 100), rep(2, 100))
yy4a <- reshape(yy4, direction="wide", idvar="FIPS", timevar="time")

str(yy4a)

and combine:

library(maptools)
xxx <- spCbind(xx, yy4a)
summary(xxx)
spplot(xxx, c("newvar.1", "newvar.2"))

Note that the SIDS dataset is already in thw "wide" format with data from 
1974 and 1979 as columns. Read up on the long and wide formats, and maybe 
look at the documentation of the spacetime package.

Roger

>
>
> On Tue, Aug 18, 2015 at 7:31 PM, Metastate Metastate <metastate at gmail.com>
> wrote:
>
>> Cool. Let me take a look. Thank you very much, Lo?c.
>>
>> Meta
>>
>>
>>
>> On Tue, Aug 18, 2015 at 3:31 AM, Lo?c Dutrieux <loic.dutrieux at wur.nl>
>> wrote:
>>
>>> Hi,
>>>
>>> Have a look at merge in the sp package.
>>> ?sp::merge
>>>
>>> Cheers,
>>> Lo?c
>>>
>>> On 08/18/2015 04:12 AM, Metastate Metastate wrote:
>>>
>>>> Hi all,
>>>>
>>>> I am starting to learn spatial analysis using R. Do anyone know if the
>>>> attribute data in a spatialpolygonsdataframe can contain multiple
>>>> observations within the same polygon? To be specific, I have a
>>>> spatialpolygonsdataframe that contain USA county polygons and the
>>>> relevant
>>>> attribute data contains the relevant state,county and FIPs.  And I also
>>>> have another data-frame that contains weather features by year by county
>>>> (For example there are yearly average temperature for each county) . How
>>>> can I join the spatialpolygondataframe with the weather data so that the
>>>> resulted attribute table in the joint spatialpolygonsdataframe can
>>>> contain
>>>> *multiple-year* weather features within each county?
>>>>
>>>> Thank you very much for any kindly help.
>>>>
>>>> Meta
>>>>
>>>>         [[alternative HTML version deleted]]
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no

From vasiles at uidaho.edu  Wed Aug 19 19:43:27 2015
From: vasiles at uidaho.edu (Suchar, Vasile (vasiles@uidaho.edu))
Date: Wed, 19 Aug 2015 17:43:27 +0000
Subject: [R-sig-Geo] Use pre-calculated population weighted road-distance
 matrix in spdep package
Message-ID: <CY1PR0401MB1260617AE1BF36609DE1722AC9670@CY1PR0401MB1260.namprd04.prod.outlook.com>

Hi,
While I am "old" in statistics and R, I just started with spatial data and I have a few problems.
At this time, I am trying to evaluate the spatial autocorrelation of "counts" over a series of "counties". For simplicity I created a simple example mimicking the real data which is more extensive. The counts may be also transformed, if necessary. See example bellow.
I created a population-weighted road-distance matrix between counties. I made a weight matrix 1/dij (a row-standardized matrix can also be created) and run a Moran's I test for spatial autocorrelation using function Moran.I in package "ape".
But I would really like to use these population-weighted road distances to explore the wide range of spatial weights and spatial autoccorelation tests offered by "spdep" package. The spatial weights (listw) in "spdep" results from neighbor list objects (nb), created from grid cells, graph structures, etc.
Do you have any idea how to use my distance matrix in spdep, or have any suggestions about other packages that will allow the use of customized "distance" matrices?
By the way, this is my first R post too, so hopefully is appropriate...
Thank you.

Example:

# number of cases in each county
counts=data.frame(c("a","b", "c", "d"), c(1:4))
colnames(counts)=c("county", "counts")
counts

##   county counts
## 1      a      1
## 2      b      2
## 3      c      3
## 4      d      4

# distance matrix between counties
dist=matrix(c(1:16), nrow=4, ncol=4)
diag(dist)=0
colnames(dist)=counts$county
rownames(dist)=counts$county
dist

##   a b  c  d
## a 0 5  9 13
## b 2 0 10 14
## c 3 7  0 15
## d 4 8 12  0

# I can create a weight matrix or a row standardized
dist.w=1/dist
diag(dist.w)=0

# Moran's I calculation
library(ape)

Moran.I(counts$counts, dist.w)

## $observed
## [1] -0.312481
##
## $expected
## [1] -0.3333333
##
## $sd
## [1] 0.1451662
##
## $p.value
## [1] 0.8857809



Sincerely,



Alex



Vasile-Alexandru Suchar

University of Idaho

Email: vasiles at uidaho.edu<mailto:vasiles at uidaho.edu>

	[[alternative HTML version deleted]]


From metastate at gmail.com  Thu Aug 20 04:13:57 2015
From: metastate at gmail.com (Metastate Metastate)
Date: Wed, 19 Aug 2015 21:13:57 -0500
Subject: [R-sig-Geo] Spatialpolygonsdataframe
In-Reply-To: <alpine.LFD.2.20.1508191049380.26379@reclus.nhh.no>
References: <CAKpbK+cbMjZfjZ+Db6MbmhVuG40oxC0CfUhsH_jNQifnD3h+XQ@mail.gmail.com>
	<55D2ED58.1020203@wur.nl>
	<CAKpbK+cPrKXL8FVKODHCOweUFiPtsnNGVKhCjtiNrZhqXzSKKA@mail.gmail.com>
	<CAKpbK+fyBox-WBF9DsAPwNOffPVPdhSNQZhHhht59JcAu1QuMg@mail.gmail.com>
	<alpine.LFD.2.20.1508191049380.26379@reclus.nhh.no>
Message-ID: <CAKpbK+fidRUaLnojSEzqNjv3nKekz4iy67SZj+UqMb+Ub0LZag@mail.gmail.com>

Thank you very much, Roger. It is very helpful.

Meta

On Wed, Aug 19, 2015 at 3:55 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:

> On Wed, 19 Aug 2015, Metastate Metastate wrote:
>
> Hi
>>
>> I tried to use sp merge to join the spatialpolygonddataframe (xx) and an
>> dataframe (yy4), which have 2 observations for each spatial ID. But it did
>> not allow with an error message as below:
>> Error in .local(x, y, ...) :  'y' has multiple records for one or more
>> 'by.y' key(s)
>>
>> I also tried the mapmerge in eeptools but failed.
>>
>> Any suggestion? Thank you very much.
>>
>> Meta
>>
>>
> Thanks for a reproducible example. Don't use merge() unless you know
> already that the objects are conformable:
>
>
>> library("eeptools")
>> library("sp")
>> xx <- maptools::readShapePoly(system.file("shapes/sids.shp",
>> package="maptools")[1], IDvar="FIPSNO")
>> yy<-as(xx,"data.frame")
>> yy$newvar<-sample(0:100,nrow(yy),replace=TRUE)
>> yy<-subset(yy,select=c("FIPS","newvar"))
>> yy3<-yy
>> yy3$newvar<-10*yy3$newvar
>> yy4<-data.frame(rbind(yy,yy3))
>> newpoly<-merge(xx,yy4,sort=FALSE, by.x="FIPS",
>>                  by.y="FIPS" ,all.y=TRUE)
>>
>
> Look at str(yy4) and dim(xx) - they are not conformable. Add a "time"
> variable and use reshape() to get to a conformable object:
>
> yy4$time <- c(rep(1, 100), rep(2, 100))
> yy4a <- reshape(yy4, direction="wide", idvar="FIPS", timevar="time")
>
> str(yy4a)
>
> and combine:
>
> library(maptools)
> xxx <- spCbind(xx, yy4a)
> summary(xxx)
> spplot(xxx, c("newvar.1", "newvar.2"))
>
> Note that the SIDS dataset is already in thw "wide" format with data from
> 1974 and 1979 as columns. Read up on the long and wide formats, and maybe
> look at the documentation of the spacetime package.
>
> Roger
>
>
>
>>
>> On Tue, Aug 18, 2015 at 7:31 PM, Metastate Metastate <metastate at gmail.com
>> >
>> wrote:
>>
>> Cool. Let me take a look. Thank you very much, Lo?c.
>>>
>>> Meta
>>>
>>>
>>>
>>> On Tue, Aug 18, 2015 at 3:31 AM, Lo?c Dutrieux <loic.dutrieux at wur.nl>
>>> wrote:
>>>
>>> Hi,
>>>>
>>>> Have a look at merge in the sp package.
>>>> ?sp::merge
>>>>
>>>> Cheers,
>>>> Lo?c
>>>>
>>>> On 08/18/2015 04:12 AM, Metastate Metastate wrote:
>>>>
>>>> Hi all,
>>>>>
>>>>> I am starting to learn spatial analysis using R. Do anyone know if the
>>>>> attribute data in a spatialpolygonsdataframe can contain multiple
>>>>> observations within the same polygon? To be specific, I have a
>>>>> spatialpolygonsdataframe that contain USA county polygons and the
>>>>> relevant
>>>>> attribute data contains the relevant state,county and FIPs.  And I also
>>>>> have another data-frame that contains weather features by year by
>>>>> county
>>>>> (For example there are yearly average temperature for each county) .
>>>>> How
>>>>> can I join the spatialpolygondataframe with the weather data so that
>>>>> the
>>>>> resulted attribute table in the joint spatialpolygonsdataframe can
>>>>> contain
>>>>> *multiple-year* weather features within each county?
>>>>>
>>>>> Thank you very much for any kindly help.
>>>>>
>>>>> Meta
>>>>>
>>>>>         [[alternative HTML version deleted]]
>>>>>
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>
>>>>>
>>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>>
>>>
>>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 91 00
> e-mail: Roger.Bivand at nhh.no
>

	[[alternative HTML version deleted]]


From selebatsom at yahoo.co.uk  Thu Aug 20 07:07:16 2015
From: selebatsom at yahoo.co.uk (moses selebatso)
Date: Thu, 20 Aug 2015 05:07:16 +0000 (UTC)
Subject: [R-sig-Geo] estimating a commom smoothing factor
Message-ID: <1508905159.7924206.1440047236976.JavaMail.yahoo@mail.yahoo.com>

Hello
I have been trying to estimate Kernel?Home ranges and one of the requirements for the script is?a?smoothing factor.?I was hoping to use the LSCV for h. I cannot get the right figure that will be used in all the movement data I have. It looks like I need to estimated for each animal monitored. How can I get a common figure? I have 30 data sets and creating 30 LSCV by continuous trial seems not the clever way of doing it. Please help.
Thank you,
Moses SELEBATSO (+267) 318 5219 (H) (+267) 716 393 70 (C) ?(+267) 738 393 70 (C
	[[alternative HTML version deleted]]


From almut.schlaich at grauwekiekendief.nl  Thu Aug 20 09:34:55 2015
From: almut.schlaich at grauwekiekendief.nl (Almut Schlaich - Werkgroep Grauwe Kiekendief)
Date: Thu, 20 Aug 2015 09:34:55 +0200
Subject: [R-sig-Geo] estimating a commom smoothing factor
In-Reply-To: <1508905159.7924206.1440047236976.JavaMail.yahoo@mail.yahoo.com>
References: <1508905159.7924206.1440047236976.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <55D5831F.7040303@grauwekiekendief.nl>

Dear Moses,

There is a very nice new package to calculate home ranges: rhr

It is described in the paper of Signer and Balkenhol: Reproducible home 
ranges (/rhr/): A new, user-friendly R package for analyses of wildlife 
telemetry data
|http://onlinelibrary.wiley.com/doi/10.1002/wsb.539/abstract?deniedAccessCustomisedMessage=&userIsAuthenticated=true
|
An easy example how to use the package to calculate kernel home ranges 
could be found here:|http://jmsigner.github.io/rhrman/cliHRE.html
|You can choose to use the LSCV estimate of h in the command (|rhrHlscv).
|
The home range needs to be estimated for each individual (only if you 
would like to look at the area used by your population you could 
calculate one single home range).
Maybe you could do this in a loop, subsetting the data for one 
individual and calculate the home range.

Best wishes,
Almut

Am 8/20/2015 um 7:07 AM schrieb moses selebatso:
> Hello
> I have been trying to estimate Kernel Home ranges and one of the requirements for the script is a smoothing factor. I was hoping to use the LSCV for h. I cannot get the right figure that will be used in all the movement data I have. It looks like I need to estimated for each animal monitored. How can I get a common figure? I have 30 data sets and creating 30 LSCV by continuous trial seems not the clever way of doing it. Please help.
> Thank you,
> Moses SELEBATSO (+267) 318 5219 (H) (+267) 716 393 70 (C)  (+267) 738 393 70 (C
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Almut Schlaich

Werkgroep Grauwe Kiekendief
telefoon: +31(0)650459766
e-mail: almut.schlaich at grauwekiekendief.nl
postadres: Postbus 46, 9679 ZG Scheemda
www.grauwekiekendief.nl
twitter: @grauwekiek
facebook: www.facebook.com/pages/Werkgroep-Grauwe-Kiekendief/190585087622000


	[[alternative HTML version deleted]]


From robertomhorn at gmail.com  Thu Aug 20 16:13:51 2015
From: robertomhorn at gmail.com (Roberto Horn)
Date: Thu, 20 Aug 2015 11:13:51 -0300
Subject: [R-sig-Geo] Global Precipitation Measurement data download
Message-ID: <CAG42j+OkB+SAJ8PzHqZExQrkq8Ws+9AkTXa40RdO9W-YWtjujA@mail.gmail.com>

Hello


I am looking for a package on R that can download data from Global
Precipitation Measurement automatically. An example is what runGdal()
or runMrt() from package MODIS do.

There is is a package for TRMM data download: hddtools   function TRMM()

There is any package that can download data from GPM?


Thank you.


From prabhu142003 at gmail.com  Thu Aug 20 21:49:19 2015
From: prabhu142003 at gmail.com (prabhu)
Date: Thu, 20 Aug 2015 14:49:19 -0500
Subject: [R-sig-Geo] Need help in creating a grid
Message-ID: <CAEs_ZqxjRyX+4bnk=cEA83pUhuy3k8HEUPLGweTwXKT9qPSyWA@mail.gmail.com>

I have to create a grid to view the heatmap of my data on a geo location.

I am stuck with using some libraries that are used to create such grid.
Anyone here to help please ?

	[[alternative HTML version deleted]]


From mdsumner at gmail.com  Thu Aug 20 23:39:07 2015
From: mdsumner at gmail.com (Michael Sumner)
Date: Fri, 21 Aug 2015 07:39:07 +1000
Subject: [R-sig-Geo] Global Precipitation Measurement data download
In-Reply-To: <CAG42j+OkB+SAJ8PzHqZExQrkq8Ws+9AkTXa40RdO9W-YWtjujA@mail.gmail.com>
References: <CAG42j+OkB+SAJ8PzHqZExQrkq8Ws+9AkTXa40RdO9W-YWtjujA@mail.gmail.com>
Message-ID: <CAAcGz9_Zrp02E1UQyaba3E_5CXXP+-vH4-jmHovZ1EQkeOf_dg@mail.gmail.com>

On Friday, August 21, 2015, Roberto Horn <robertomhorn at gmail.com> wrote:
> Hello
>
>
> I am looking for a package on R that can download data from Global
> Precipitation Measurement automatically

We have some tools to do this, can you point to explicit sources and
example files? I could try out adding this to our collection and report
back.

Cheers, Mike

. An example is what runGdal()
> or runMrt() from package MODIS do.
>
> There is is a package for TRMM data download: hddtools   function TRMM()
>
> There is any package that can download data from GPM?
>
>
> Thank you.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Michael Sumner
Software and Database Engineer
Australian Antarctic Division
Hobart, Australia
e-mail: mdsumner at gmail.com

	[[alternative HTML version deleted]]


From tea3rd at gmail.com  Fri Aug 21 01:07:28 2015
From: tea3rd at gmail.com (Thomas Adams)
Date: Thu, 20 Aug 2015 18:07:28 -0500
Subject: [R-sig-Geo] Global Precipitation Measurement data download
In-Reply-To: <CAAcGz9_Zrp02E1UQyaba3E_5CXXP+-vH4-jmHovZ1EQkeOf_dg@mail.gmail.com>
References: <CAG42j+OkB+SAJ8PzHqZExQrkq8Ws+9AkTXa40RdO9W-YWtjujA@mail.gmail.com>
	<CAAcGz9_Zrp02E1UQyaba3E_5CXXP+-vH4-jmHovZ1EQkeOf_dg@mail.gmail.com>
Message-ID: <CAGxgkWhYO_M6x_fBbTdB6rJfJu+PHBGHpMu2tUd5+BNPZL2EAg@mail.gmail.com>

Mike,

This would be really helpful to me as well!

Thank you,
Tom

On Thu, Aug 20, 2015 at 4:39 PM, Michael Sumner <mdsumner at gmail.com> wrote:

> On Friday, August 21, 2015, Roberto Horn <robertomhorn at gmail.com> wrote:
> > Hello
> >
> >
> > I am looking for a package on R that can download data from Global
> > Precipitation Measurement automatically
>
> We have some tools to do this, can you point to explicit sources and
> example files? I could try out adding this to our collection and report
> back.
>
> Cheers, Mike
>
> . An example is what runGdal()
> > or runMrt() from package MODIS do.
> >
> > There is is a package for TRMM data download: hddtools   function TRMM()
> >
> > There is any package that can download data from GPM?
> >
> >
> > Thank you.
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
> --
> Michael Sumner
> Software and Database Engineer
> Australian Antarctic Division
> Hobart, Australia
> e-mail: mdsumner at gmail.com
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From mdsumner at gmail.com  Fri Aug 21 02:26:28 2015
From: mdsumner at gmail.com (Michael Sumner)
Date: Fri, 21 Aug 2015 00:26:28 +0000
Subject: [R-sig-Geo] Global Precipitation Measurement data download
In-Reply-To: <CAGxgkWhYO_M6x_fBbTdB6rJfJu+PHBGHpMu2tUd5+BNPZL2EAg@mail.gmail.com>
References: <CAG42j+OkB+SAJ8PzHqZExQrkq8Ws+9AkTXa40RdO9W-YWtjujA@mail.gmail.com>
	<CAAcGz9_Zrp02E1UQyaba3E_5CXXP+-vH4-jmHovZ1EQkeOf_dg@mail.gmail.com>
	<CAGxgkWhYO_M6x_fBbTdB6rJfJu+PHBGHpMu2tUd5+BNPZL2EAg@mail.gmail.com>
Message-ID: <CAAcGz9_qGLa5wz3_1sEDqq9Kk6z89da3aHY3c57vT+MFu6C+yA@mail.gmail.com>

On Fri, 21 Aug 2015 at 09:07 Thomas Adams <tea3rd at gmail.com> wrote:

> Mike,
>
> This would be really helpful to me as well!
>
>
It is the gaping hole in all this work we are doing.

Please specify a source and some actual examples of files you want for me
to try.

Within limits, we can configure a new source into our synchronization tools
and they essentially mirror a file set from some source, using wget, curl,
or some custom wrapper (NASA ocean colour is an example). It's not really
ready for public consumption but it's working well for us and it's easy
enough to set up.

Cheers, Mike.



> Thank you,
> Tom
>
> On Thu, Aug 20, 2015 at 4:39 PM, Michael Sumner <mdsumner at gmail.com>
> wrote:
>
>> On Friday, August 21, 2015, Roberto Horn <robertomhorn at gmail.com> wrote:
>> > Hello
>> >
>> >
>> > I am looking for a package on R that can download data from Global
>> > Precipitation Measurement automatically
>>
>> We have some tools to do this, can you point to explicit sources and
>> example files? I could try out adding this to our collection and report
>> back.
>>
>> Cheers, Mike
>>
>> . An example is what runGdal()
>> > or runMrt() from package MODIS do.
>> >
>> > There is is a package for TRMM data download: hddtools   function TRMM()
>> >
>> > There is any package that can download data from GPM?
>> >
>> >
>> > Thank you.
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at r-project.org
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >
>>
>> --
>> Michael Sumner
>> Software and Database Engineer
>> Australian Antarctic Division
>> Hobart, Australia
>> e-mail: mdsumner at gmail.com
>>
>>         [[alternative HTML version deleted]]
>>
>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>

	[[alternative HTML version deleted]]


From uzzal at gist.ac.kr  Fri Aug 21 03:12:16 2015
From: uzzal at gist.ac.kr (Uzzal)
Date: Fri, 21 Aug 2015 10:12:16 +0900 (KST)
Subject: [R-sig-Geo] Got error in plotting variogram using gstat and automap
	in R
Message-ID: <89350816.1440119536791.JavaMail.root@eunhasu>

I have a csv file (Please download from here ) names seoul_3month.csv, contains hourly pm10 concentration data from 25th april to 31th april 2012. I intended to plot every hour variogram using gstat and automap package in R.  I worte this code below but I got some errorerror says:  Error in vgm_list[[which.min(SSerr_list)]] : 
  attempt to select less than one element
In addition: There were 25 warnings (use warnings() to see them)
Called from: top level 
 library(sp)
library(gstat)
library(rgdal)
library(automap)seoul_3monthseq(seoul_every_hour) vars Previously I did the same work for 1 march to 7 march 2012, by the same coad below but I plotted all the variogram successfully. you can see my previous same code here in the anser part of the following link .

But for this present data set I got the error. Could anybody please tell me what is error about? Is there any problem in my data set? Thanks in advance.

Uzzal  


Uzzal Kumar Dash
Master's studentAir Quality &amp; Climate Modeling Laboratory (AqCliMB)School of Environmental Science and Engineering (SESE)Gwangju Institute of Science and Technology (GIST)123 Cheomdan-gwagiro, Buk-gu, Gwangju 500-712
Republic of Korea
web: http://aqclimb.gist.ac.kr/

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150821/1f7f1e24/attachment.html>

From frtog at vestas.com  Fri Aug 21 07:12:10 2015
From: frtog at vestas.com (=?iso-8859-1?Q?Frede_Aakmann_T=F8gersen?=)
Date: Fri, 21 Aug 2015 05:12:10 +0000
Subject: [R-sig-Geo] Need help in creating a grid
In-Reply-To: <CAEs_ZqxjRyX+4bnk=cEA83pUhuy3k8HEUPLGweTwXKT9qPSyWA@mail.gmail.com>
References: <CAEs_ZqxjRyX+4bnk=cEA83pUhuy3k8HEUPLGweTwXKT9qPSyWA@mail.gmail.com>
Message-ID: <HE1PR04MB12766E7C1E879B7AFCC8D434DB650@HE1PR04MB1276.eurprd04.prod.outlook.com>

Yes, some one on this list may be able to help you but not before you show the list what you have been doing so far and where you get stucked.

Yours sincerely / Med venlig hilsen

Frede Aakmann T?gersen
Specialist, M.Sc., Ph.D.
Plant Performance & Modeling

Technology & Service Solutions
T +45 9730 5135
M +45 2547 6050
frtog at vestas.com
http://www.vestas.com

Company reg. name: Vestas Wind Systems A/S
This e-mail is subject to our e-mail disclaimer statement.
Please refer to www.vestas.com/legal/notice
If you have received this e-mail in error please contact the sender. 



-----Original Message-----
From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of prabhu
Sent: 20. august 2015 21:49
To: r-sig-geo at r-project.org
Subject: [R-sig-Geo] Need help in creating a grid

I have to create a grid to view the heatmap of my data on a geo location.

I am stuck with using some libraries that are used to create such grid.
Anyone here to help please ?

	[[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From frtog at vestas.com  Fri Aug 21 08:10:30 2015
From: frtog at vestas.com (=?iso-8859-1?Q?Frede_Aakmann_T=F8gersen?=)
Date: Fri, 21 Aug 2015 06:10:30 +0000
Subject: [R-sig-Geo] Global Precipitation Measurement data download
In-Reply-To: <CAAcGz9_qGLa5wz3_1sEDqq9Kk6z89da3aHY3c57vT+MFu6C+yA@mail.gmail.com>
References: <CAG42j+OkB+SAJ8PzHqZExQrkq8Ws+9AkTXa40RdO9W-YWtjujA@mail.gmail.com>
	<CAAcGz9_Zrp02E1UQyaba3E_5CXXP+-vH4-jmHovZ1EQkeOf_dg@mail.gmail.com>
	<CAGxgkWhYO_M6x_fBbTdB6rJfJu+PHBGHpMu2tUd5+BNPZL2EAg@mail.gmail.com>
	<CAAcGz9_qGLa5wz3_1sEDqq9Kk6z89da3aHY3c57vT+MFu6C+yA@mail.gmail.com>
Message-ID: <HE1PR04MB12762AEE1084B74AC3815063DB650@HE1PR04MB1276.eurprd04.prod.outlook.com>

Hi Michael

>From this site 

http://pmm.nasa.gov/data-access/downloads/gpm

it seems that the file formats are in NETDCF, HDF5, or GIS TIFF + worldfile.

I have downloaded (needs registration)  the HDF5 and GTIFF and you can access those here:

Hfd5: https://dl.dropboxusercontent.com/u/2799795/3B-HHR-E.MS.MRG.3IMERG.20150801-S000000-E002959.0000.V03E.RT-H5
Tif: https://dl.dropboxusercontent.com/u/2799795/3B-HHR-E.MS.MRG.3IMERG.20150812-S220000-E222959.1320.V03E.1day.tif
Tfw: https://dl.dropboxusercontent.com/u/2799795/3B-HHR-E.MS.MRG.3IMERG.20150812-S220000-E222959.1320.V03E.1day.tif 

The NETCDF requires specification of time period and lower left and upper right coordinates of a region. No web service seems to exist to do that. Also I failed to specify valid time period and region and gave up on this one.

The hdf5 file was downloaded from:

ftp://jsimpson.pps.eosdis.nasa.gov/NRTPUB/imerg/early/201508/3B-HHR-E.MS.MRG.3IMERG.20150801-S000000-E002959.0000.V03E.RT-H5 

Some other ftp servers can be found on 

http://pmm.nasa.gov/data-access/data-sources#midador 

Some mirrors seems to exist as mentioned on the homepage above:

http://www.opendap.org/ (supports THREDDS and SOAP and have API for jave and C++)
http://pmm-dev.pps.eosdis.nasa.gov/data-access/data-sources#midador  (
http://pmm.nasa.gov/data-access/data-sources#TOVAS 

Hope this helps.

Yours sincerely / Med venlig hilsen

Frede Aakmann T?gersen
Specialist, M.Sc., Ph.D.
Plant Performance & Modeling

Technology & Service Solutions
T +45 9730 5135
M +45 2547 6050
frtog at vestas.com
http://www.vestas.com

Company reg. name: Vestas Wind Systems A/S
This e-mail is subject to our e-mail disclaimer statement.
Please refer to www.vestas.com/legal/notice
If you have received this e-mail in error please contact the sender. 



-----Original Message-----
From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Michael Sumner
Sent: 21. august 2015 02:26
To: Thomas Adams
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] Global Precipitation Measurement data download

On Fri, 21 Aug 2015 at 09:07 Thomas Adams <tea3rd at gmail.com> wrote:

> Mike,
>
> This would be really helpful to me as well!
>
>
It is the gaping hole in all this work we are doing.

Please specify a source and some actual examples of files you want for me
to try.

Within limits, we can configure a new source into our synchronization tools
and they essentially mirror a file set from some source, using wget, curl,
or some custom wrapper (NASA ocean colour is an example). It's not really
ready for public consumption but it's working well for us and it's easy
enough to set up.

Cheers, Mike.



> Thank you,
> Tom
>
> On Thu, Aug 20, 2015 at 4:39 PM, Michael Sumner <mdsumner at gmail.com>
> wrote:
>
>> On Friday, August 21, 2015, Roberto Horn <robertomhorn at gmail.com> wrote:
>> > Hello
>> >
>> >
>> > I am looking for a package on R that can download data from Global
>> > Precipitation Measurement automatically
>>
>> We have some tools to do this, can you point to explicit sources and
>> example files? I could try out adding this to our collection and report
>> back.
>>
>> Cheers, Mike
>>
>> . An example is what runGdal()
>> > or runMrt() from package MODIS do.
>> >
>> > There is is a package for TRMM data download: hddtools   function TRMM()
>> >
>> > There is any package that can download data from GPM?
>> >
>> >
>> > Thank you.
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at r-project.org
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >
>>
>> --
>> Michael Sumner
>> Software and Database Engineer
>> Australian Antarctic Division
>> Hobart, Australia
>> e-mail: mdsumner at gmail.com
>>
>>         [[alternative HTML version deleted]]
>>
>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>

	[[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From rajcheruk at gmail.com  Fri Aug 21 12:03:59 2015
From: rajcheruk at gmail.com (Rajabhushanam. C)
Date: Fri, 21 Aug 2015 15:33:59 +0530
Subject: [R-sig-Geo] How to use coKriging with LANDSAT ETM Imagery
Message-ID: <CANSnM0tTN5-KeWEJf7rR7dkcSrD6Z-1crsJYVL00d946B6TSsg@mail.gmail.com>

Hi,

I am using a Landsat ETM Scene imagery for calculating the Linear
Corregionalization Method in CoKriging.  (gstat).

Specifically, there is one raster band imagery and then using readGDAL and
gstat function calls, I am making a gstat object that is input to the
Variogram call. Now, while I use *fit.lmc()*, I get an error message
*"gstatVariogram
var1 not present"*. I have done some preliminary findings, and there are no
pertinent messages in this message board that have Raster as an input to
cokriging.

Really appreciate if anybody can point me some relevant code or pseudo code
to perform cokriging with Landsat one band imagery.

Thank You
C. Rajabhushanam.

	[[alternative HTML version deleted]]


From edzer.pebesma at uni-muenster.de  Fri Aug 21 15:28:54 2015
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 21 Aug 2015 15:28:54 +0200
Subject: [R-sig-Geo] How to use coKriging with LANDSAT ETM Imagery
In-Reply-To: <CANSnM0tTN5-KeWEJf7rR7dkcSrD6Z-1crsJYVL00d946B6TSsg@mail.gmail.com>
References: <CANSnM0tTN5-KeWEJf7rR7dkcSrD6Z-1crsJYVL00d946B6TSsg@mail.gmail.com>
Message-ID: <55D72796.5070302@uni-muenster.de>

With the amount of detail you give (no script) I can only guess.

In case you try to feed the gstat routines a Raster or RasterStack
object, it doesn't work. In that case you should first convert it; say
if your raster is called x, pass it to gstat() as

as(x, "SpatialPointsDataFrame").




On 08/21/2015 12:03 PM, Rajabhushanam. C wrote:
> Hi,
> 
> I am using a Landsat ETM Scene imagery for calculating the Linear
> Corregionalization Method in CoKriging.  (gstat).
> 
> Specifically, there is one raster band imagery and then using readGDAL and
> gstat function calls, I am making a gstat object that is input to the
> Variogram call. Now, while I use *fit.lmc()*, I get an error message
> *"gstatVariogram
> var1 not present"*. I have done some preliminary findings, and there are no
> pertinent messages in this message board that have Raster as an input to
> cokriging.
> 
> Really appreciate if anybody can point me some relevant code or pseudo code
> to perform cokriging with Landsat one band imagery.
> 
> Thank You
> C. Rajabhushanam.
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi),  University of M?nster,
Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
Journal of Statistical Software:   http://www.jstatsoft.org/
Computers & Geosciences:   http://elsevier.com/locate/cageo/
Spatial Statistics Society http://www.spatialstatistics.info

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150821/d96a52db/attachment.bin>

From dawn.williams.10 at ucl.ac.uk  Fri Aug 21 16:46:08 2015
From: dawn.williams.10 at ucl.ac.uk (Williams, Dawn)
Date: Fri, 21 Aug 2015 14:46:08 +0000
Subject: [R-sig-Geo] Cross validation of ST Kriging
Message-ID: <DB4PR01MB074940951D1B43483AF2911A89650@DB4PR01MB0749.eurprd01.prod.exchangelabs.com>

I would like to conduct cross validation on ST kriging performed with different ST variograms. I understand,  that it is not yet possible to conduct cross validation on ST Kriging  but that one should assume an extremely local temporal neighbourhood and perform cross validation on spatial interpolation. My question is how do I reflect the various space-time covariance structures in doing this if the krige.cv function will only accept a vgm? How do I input the other parameters of the ST covariance models in creating the vgm for comparison?


Thank you in advance.


Best Regards,

Dawn Williams

	[[alternative HTML version deleted]]


From robertomhorn at gmail.com  Sat Aug 22 04:26:55 2015
From: robertomhorn at gmail.com (Roberto Horn)
Date: Fri, 21 Aug 2015 23:26:55 -0300
Subject: [R-sig-Geo] Global Precipitation Measurement data download
In-Reply-To: <HE1PR04MB12762AEE1084B74AC3815063DB650@HE1PR04MB1276.eurprd04.prod.outlook.com>
References: <CAG42j+OkB+SAJ8PzHqZExQrkq8Ws+9AkTXa40RdO9W-YWtjujA@mail.gmail.com>
	<CAAcGz9_Zrp02E1UQyaba3E_5CXXP+-vH4-jmHovZ1EQkeOf_dg@mail.gmail.com>
	<CAGxgkWhYO_M6x_fBbTdB6rJfJu+PHBGHpMu2tUd5+BNPZL2EAg@mail.gmail.com>
	<CAAcGz9_qGLa5wz3_1sEDqq9Kk6z89da3aHY3c57vT+MFu6C+yA@mail.gmail.com>
	<HE1PR04MB12762AEE1084B74AC3815063DB650@HE1PR04MB1276.eurprd04.prod.outlook.com>
Message-ID: <CAG42j+MHD=n7V7mqekzJKV4yiZ9eQsqaw2ugDM8gRR8G3qWgag@mail.gmail.com>

Hello Michael.

I'm really new to TRMM and GPM data types and analysis. I'm going to
have to do some study before I can answer you properly.
If Frede answers were not enough, let me know and I will gather some
more information.

I though that could have a package and I did not know. If you could
make a function that will be very helpful!


Cheers


From mdsumner at gmail.com  Sat Aug 22 05:49:40 2015
From: mdsumner at gmail.com (Michael Sumner)
Date: Sat, 22 Aug 2015 03:49:40 +0000
Subject: [R-sig-Geo] Global Precipitation Measurement data download
In-Reply-To: <CAG42j+MHD=n7V7mqekzJKV4yiZ9eQsqaw2ugDM8gRR8G3qWgag@mail.gmail.com>
References: <CAG42j+OkB+SAJ8PzHqZExQrkq8Ws+9AkTXa40RdO9W-YWtjujA@mail.gmail.com>
	<CAAcGz9_Zrp02E1UQyaba3E_5CXXP+-vH4-jmHovZ1EQkeOf_dg@mail.gmail.com>
	<CAGxgkWhYO_M6x_fBbTdB6rJfJu+PHBGHpMu2tUd5+BNPZL2EAg@mail.gmail.com>
	<CAAcGz9_qGLa5wz3_1sEDqq9Kk6z89da3aHY3c57vT+MFu6C+yA@mail.gmail.com>
	<HE1PR04MB12762AEE1084B74AC3815063DB650@HE1PR04MB1276.eurprd04.prod.outlook.com>
	<CAG42j+MHD=n7V7mqekzJKV4yiZ9eQsqaw2ugDM8gRR8G3qWgag@mail.gmail.com>
Message-ID: <CAAcGz9_dtmgU5WtMm70GLh=pVsH61wKMKVYHqx4_Cr8pMAkPyQ@mail.gmail.com>

On Sat, 22 Aug 2015 at 12:26 Roberto Horn <robertomhorn at gmail.com> wrote:

> Hello Michael.
>
> I'm really new to TRMM and GPM data types and analysis. I'm going to
> have to do some study before I can answer you properly.
> If Frede answers were not enough, let me know and I will gather some
> more information.
>
>
What would be helpful would be to know which of the format/s you can open
on your system/s.

Via raster/rgdal:
GeoTIFF will  work everywhere, but this can make life harder for matlab
users (if you care for them and they share your collection)
HDF5 will only work on Linux (unless you can build rgdal with HDF5 for
Windows)

via raster/ncdf/ncdf4:
NetCDF will work anywhere, unless it is NetCDF version 4 - then it will
only work on Linux - on windows you can build the ncdf or ncdf4 package
yourself or use David Pierce's outdated build.

Out of this I would go for GeoTIFF, or for NetCDF if it's pre version 4 -
 as I need it for Linux and Windows users and I can't get all the systems
up to speed.

It's fairly straightforward, we register a collection with raadsync which
keeps it up to date and then write a wrapper in raadtools:

https://github.com/AustralianAntarcticDivision/raadtools

Neither of these packages is very polished and the set up is not documented
properly, but a nice documented example of application to a new data set is
something I try to find time for. I'll try to get to this soon.

Cheers, Mike.

I though that could have a package and I did not know. If you could
> make a function that will be very helpful!
>
>
> Cheers
>

	[[alternative HTML version deleted]]


From marceivissa at gmail.com  Mon Aug 24 10:43:07 2015
From: marceivissa at gmail.com (=?UTF-8?Q?Marc_Mar=C3=AD_Dell=27Olmo?=)
Date: Mon, 24 Aug 2015 10:43:07 +0200
Subject: [R-sig-Geo] =?utf-8?q?problem_with_accents_and_Catalan_characters?=
	=?utf-8?q?_=28for_ex=2E_=C3=A7=29_using_geocode_function_=28ggmap?=
	=?utf-8?q?=29?=
Message-ID: <CAAZSCQ5wFyWBxHLXaLqbArw90EgjZFAMs=BU9xexfsnJqcxDrw@mail.gmail.com>

Dear all,

I'm trying to geocode addresses (of Catalonia) with accents and
Catalan characters (as for example "?").  I'm using the "geocode"
function (package ggmap), but I obtain some Google "INVALID_REQUEST"
when the addresses have these characters. For example:

> geocode("Carrer Vene?uela, 10, 08019 Barcelona, Spain")
Information from URL :
http://maps.googleapis.com/maps/api/geocode/json?address=Carrer+Vene%E7uela,+10,+08019+Barcelona,+Spain&sensor=false
  lon lat
1  NA  NA
Warning message:
geocode failed with status INVALID_REQUEST, location =
"Carrer+Vene?uela,+10,+08019+Barcelona,+Spain"


> geocode("Carrer Mec?nica, 12, 08038 Barcelona, Spain")
Information from URL :
http://maps.googleapis.com/maps/api/geocode/json?address=Carrer+Mec%E0nica,+12,+08038+Barcelona,+Spain&sensor=false
  lon lat
1  NA  NA
Warning message:
geocode failed with status INVALID_REQUEST, location =
"Carrer+Mec?nica,+12,+08038+Barcelona,+Spain"

However, I can find these addresses directly on Google maps.

https://www.google.es/maps/place/Carrer+de+Vene%C3%A7uela,+10,+08019+Barcelona/@41.40873,2.2057253,17z/data=!3m1!4b1!4m2!3m1!1s0x12a4a347b9b9bb8d:0x41b696acd7b26e37

https://www.google.es/maps/place/Carrer+de+la+Mec%C3%A0nica,+12,+08038+Barcelona/@41.3591918,2.1379927,17z/data=!3m1!4b1!4m2!3m1!1s0x12a498a25156dc8b:0xc9ccfd74e54c503f


I think that there is a problem enconding the URL. I hope anyone can
help me! Thank you very much!


Marc


From SWalbridge at esri.com  Mon Aug 24 16:49:13 2015
From: SWalbridge at esri.com (Shaun Walbridge)
Date: Mon, 24 Aug 2015 14:49:13 +0000
Subject: [R-sig-Geo]
 =?utf-8?q?problem_with_accents_and_Catalan_characters?=
 =?utf-8?q?_=28for_ex=2E_=C3=A7=29_using_geocode_function_=28ggmap=29?=
In-Reply-To: <CAAZSCQ5wFyWBxHLXaLqbArw90EgjZFAMs=BU9xexfsnJqcxDrw@mail.gmail.com>
References: <CAAZSCQ5wFyWBxHLXaLqbArw90EgjZFAMs=BU9xexfsnJqcxDrw@mail.gmail.com>
Message-ID: <D200A5D2.32A7C%swalbridge@esri.com>

Try forcing the character encoding to UTF-8:

  geocode(enc2utf8("Carrer Vene?uela, 10, 08019 Barcelona, Spain"))


Note that at version 2.5, you also need to specify source="google".

P.S. Please don't cross-post your question to multiple lists and
the package author - it's poor form and results in a duplication
of effort.

-- 
Shaun Walbridge
GIS Developer





On 8/24/15, 4:43 AM, "R-sig-Geo on behalf of Marc Mar? Dell'Olmo"
<r-sig-geo-bounces at r-project.org on behalf of marceivissa at gmail.com> wrote:

>Dear all,
>
>I'm trying to geocode addresses (of Catalonia) with accents and
>Catalan characters (as for example "?").  I'm using the "geocode"
>function (package ggmap), but I obtain some Google "INVALID_REQUEST"
>when the addresses have these characters. For example:
>
>> geocode("Carrer Vene?uela, 10, 08019 Barcelona, Spain")
>Information from URL :
>http://maps.googleapis.com/maps/api/geocode/json?address=Carrer+Vene%E7uel
>a,+10,+08019+Barcelona,+Spain&sensor=false
>  lon lat
>1  NA  NA
>Warning message:
>geocode failed with status INVALID_REQUEST, location =
>"Carrer+Vene?uela,+10,+08019+Barcelona,+Spain"
>
>
>> geocode("Carrer Mec?nica, 12, 08038 Barcelona, Spain")
>Information from URL :
>http://maps.googleapis.com/maps/api/geocode/json?address=Carrer+Mec%E0nica
>,+12,+08038+Barcelona,+Spain&sensor=false
>  lon lat
>1  NA  NA
>Warning message:
>geocode failed with status INVALID_REQUEST, location =
>"Carrer+Mec?nica,+12,+08038+Barcelona,+Spain"
>
>However, I can find these addresses directly on Google maps.
>
>https://www.google.es/maps/place/Carrer+de+Vene%C3%A7uela,+10,+08019+Barce
>lona/@41.40873,2.2057253,17z/data=!3m1!4b1!4m2!3m1!1s0x12a4a347b9b9bb8d:0x
>41b696acd7b26e37
>
>https://www.google.es/maps/place/Carrer+de+la+Mec%C3%A0nica,+12,+08038+Bar
>celona/@41.3591918,2.1379927,17z/data=!3m1!4b1!4m2!3m1!1s0x12a498a25156dc8
>b:0xc9ccfd74e54c503f
>
>
>I think that there is a problem enconding the URL. I hope anyone can
>help me! Thank you very much!
>
>
>Marc
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From johnwasige at gmail.com  Mon Aug 24 17:59:04 2015
From: johnwasige at gmail.com (John Wasige)
Date: Mon, 24 Aug 2015 17:59:04 +0200
Subject: [R-sig-Geo] =?utf-8?q?Error_with_gdal_command_=E2=80=8B?=
Message-ID: <CAJgdCD41H_HexFarnbSpMRb5XqgCHunxxTRazZaxONvXAvFLYg@mail.gmail.com>

?Dear all,

I am using gdal command ?to re-project and mosaic of band 1 subset of
MOD11A1 using the command:

gdalwarp -t_srs "+proj=longlat +datum=WGS84 +no_defs" -multi
'+file_out1+' '+file_out2


I get the following error:

ERROR 4:
`HDF4_EOS:EOS_GRID:"MOD11A1.A2005001.h19v09.005.2007347213452.hdf":MODIS_Grid_Daily_1km_LST:LST_Day_1km'
does not exist in the file system,
and is not recognised as a supported dataset name.

?Could someone know the problem here?

Thanks for your help

John?

	[[alternative HTML version deleted]]


From robertomhorn at gmail.com  Mon Aug 24 18:43:22 2015
From: robertomhorn at gmail.com (Roberto Horn)
Date: Mon, 24 Aug 2015 13:43:22 -0300
Subject: [R-sig-Geo] Global Precipitation Measurement data download
In-Reply-To: <CAAcGz9_dtmgU5WtMm70GLh=pVsH61wKMKVYHqx4_Cr8pMAkPyQ@mail.gmail.com>
References: <CAG42j+OkB+SAJ8PzHqZExQrkq8Ws+9AkTXa40RdO9W-YWtjujA@mail.gmail.com>
	<CAAcGz9_Zrp02E1UQyaba3E_5CXXP+-vH4-jmHovZ1EQkeOf_dg@mail.gmail.com>
	<CAGxgkWhYO_M6x_fBbTdB6rJfJu+PHBGHpMu2tUd5+BNPZL2EAg@mail.gmail.com>
	<CAAcGz9_qGLa5wz3_1sEDqq9Kk6z89da3aHY3c57vT+MFu6C+yA@mail.gmail.com>
	<HE1PR04MB12762AEE1084B74AC3815063DB650@HE1PR04MB1276.eurprd04.prod.outlook.com>
	<CAG42j+MHD=n7V7mqekzJKV4yiZ9eQsqaw2ugDM8gRR8G3qWgag@mail.gmail.com>
	<CAAcGz9_dtmgU5WtMm70GLh=pVsH61wKMKVYHqx4_Cr8pMAkPyQ@mail.gmail.com>
Message-ID: <CAG42j+O6NJ9P5Ypxnx2=Yp=NHTFp0YUeOMAEd94R-btHseY1Ww@mail.gmail.com>

Hello Mike


The best for our work would a data accessible via raster/rgdal GeoTIFF
format. We use Windows OS.

We are used to MODIS package and the format that it works. It is the
GeoTIFF format.


Thank you.


From jpolo at mail.usf.edu  Mon Aug 24 23:25:03 2015
From: jpolo at mail.usf.edu (john polo)
Date: Mon, 24 Aug 2015 16:25:03 -0500
Subject: [R-sig-Geo] merge rasters with different origins
Message-ID: <55DB8BAF.7080509@mail.usf.edu>

List,
I have 3 elevation rasters that I want to merge into one raster. Ras1 is 
north-most, ras2 is in center, and ras3 is south-most.

 > ras1
class       : RasterLayer
dimensions  : 1488, 1227, 1825776  (nrow, ncol, ncell)
resolution  : 9.495279, 9.495279  (x, y)
extent      : 295923.3, 307574, 3930569, 3944698  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=utm +zone=15 +datum=NAD83 +units=m +no_defs 
+ellps=GRS80 +towgs84=0,0,0
data source : elevation\ned10m35095e2.tif
names       : ned10m35095e2
values      : 139.683, 271.0386  (min, max)

 > ras2
class       : RasterLayer
dimensions  : 1490, 1226, 1826740  (nrow, ncol, ncell)
resolution  : 9.488669, 9.488669  (x, y)
extent      : 296240.2, 307873.3, 3944427, 3958565  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=utm +zone=15 +datum=NAD83 +units=m +no_defs 
+ellps=GRS80 +towgs84=0,0,0
data source : elevation\ned10m35095f2.tif
names       : ned10m35095f2
values      : 146.5723, 287.688  (min, max)

 > ras3
class       : RasterLayer
dimensions  : 1491, 1225, 1826475  (nrow, ncol, ncell)
resolution  : 9.482029, 9.482029  (x, y)
extent      : 296558, 308173.5, 3958295, 3972432  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=utm +zone=15 +datum=NAD83 +units=m +no_defs 
+ellps=GRS80 +towgs84=0,0,0
data source : elevation\ned10m35095g2.tif
names       : ned10m35095g2
values      : 145.3133, 330.6396  (min, max)

I tried merging the files in steps, while not knowing what a reasonable 
value for tolerance should be, such as:
rasb <- merge(ras2, ras3, tolerance = .5)
Warning message:
In vv[is.na(vv)] <- getValues(x[[i]])[is.na(vv)] :
   number of items to replace is not a multiple of replacement length
 > rasc <- merge(ras1, rasb, tolerance = .5)
Warning message:
In vv[is.na(vv)] <- getValues(x[[i]])[is.na(vv)] :
   number of items to replace is not a multiple of replacement length

And when I plot the rasc, the two files merged in the 1st step look 
fine, but the 3rd raster looks seriously warped. I tried using the 
original files in different combinations, but the 3rd raster remains 
warped in the plot. I've also tried merging all three at the same time 
with same result for the plot.

I understand that this probably has something to do with a different 
origin for each file. I tried setting tolerance as high as 15, but that 
didn't seem to change the result.

 > origin(ras1)
[1]  2.920684 -1.739802
 > origin(ras2)
[1]  3.936303 -2.994262
 > origin(ras3)
[1] -1.914666  2.977150

What steps are necessary for this merge to work?

As a related question, those origin values are not what I would expect; 
I would expect the values to be something relevant to UTM values in 
south central U.S., thousands (of meters). Are those values "canvas" 
values?

Here is my session info:

R version 3.2.1 (2015-06-18)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 7 x64 (build 7601) Service Pack 1

cheers,
john polo


From metastate at gmail.com  Tue Aug 25 05:04:44 2015
From: metastate at gmail.com (Metastate Metastate)
Date: Mon, 24 Aug 2015 22:04:44 -0500
Subject: [R-sig-Geo] Impute missing value using k nearest neighbour
Message-ID: <CAKpbK+dFi+HpxmD5ifQZYtpzWK1+5gvfUiyCEJVa4PnK2vyx_A@mail.gmail.com>

Hi,

I have a data set with location ID (FIPS), latitude and longitude of the
location, V1 to v3 that are some features for relevant location. The
dataset have more than 3000 locations.  Please see the attached file for a
small sample. In the sample file, you can see there are some missing values
for V2 and V3 at FIPS of 26089. Does anyone know any r package that can
impute the missing values based on k nearest neighbor using the distance
matrix calculated from latitude and longitude?

Really appreciation for your kindly help or suggestion.

Meta
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150824/449c7e8c/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: example.csv
Type: text/csv
Size: 487 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150824/449c7e8c/attachment.bin>

From frtog at vestas.com  Tue Aug 25 06:55:48 2015
From: frtog at vestas.com (=?utf-8?B?RnJlZGUgQWFrbWFubiBUw7hnZXJzZW4=?=)
Date: Tue, 25 Aug 2015 04:55:48 +0000
Subject: [R-sig-Geo] Impute missing value using k nearest neighbour
In-Reply-To: <CAKpbK+dFi+HpxmD5ifQZYtpzWK1+5gvfUiyCEJVa4PnK2vyx_A@mail.gmail.com>
References: <CAKpbK+dFi+HpxmD5ifQZYtpzWK1+5gvfUiyCEJVa4PnK2vyx_A@mail.gmail.com>
Message-ID: <AM3PR04MB1265978822E1D89A27280284DB610@AM3PR04MB1265.eurprd04.prod.outlook.com>

Hi

One method is from DMwR  package (https://cran.r-project.org/web/packages/DMwR/DMwR.pdf) :

knnImputation

Fill in NA values with the values of the nearest neighbours

Description

Function that fills in all NA values using the k Nearest Neighbours of each case with NA values.
By default it uses the values of the neighbours and obtains an weighted (by the distance to the case)
average of their values to fill in the unknows.  If meth=?median? it uses the median/most frequent
value, instead.

Usage
knnImputation(data, k = 10, scale = T, meth = "weighAvg", distData = NULL)

Yours sincerely / Med venlig hilsen

Frede Aakmann T?gersen
Specialist, M.Sc., Ph.D.
Plant Performance & Modeling

Technology & Service Solutions
T +45 9730 5135
M +45 2547 6050
frtog at vestas.com<mailto:frtog at vestas.com>
http://www.vestas.com<http://www.vestas.com/>

Company reg. name: Vestas Wind Systems A/S
This e-mail is subject to our e-mail disclaimer statement.
Please refer to www.vestas.com/legal/notice<http://www.vestas.com/legal/notice>
If you have received this e-mail in error please contact the sender.


From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Metastate Metastate
Sent: 25. august 2015 05:05
To: r-sig-geo at r-project.org
Subject: [R-sig-Geo] Impute missing value using k nearest neighbour

Hi,

I have a data set with location ID (FIPS), latitude and longitude of the location, V1 to v3 that are some features for relevant location. The dataset have more than 3000 locations.  Please see the attached file for a small sample. In the sample file, you can see there are some missing values for V2 and V3 at FIPS of 26089. Does anyone know any r package that can impute the missing values based on k nearest neighbor using the distance matrix calculated from latitude and longitude?

Really appreciation for your kindly help or suggestion.

Meta


	[[alternative HTML version deleted]]


From uzzal at gist.ac.kr  Tue Aug 25 07:55:54 2015
From: uzzal at gist.ac.kr (Uzzal)
Date: Tue, 25 Aug 2015 14:55:54 +0900 (KST)
Subject: [R-sig-Geo] How to extract a table of range,
	psill and nugget from multiple plotted variogram in R
Message-ID: <1459231100.1440482154658.JavaMail.root@eunhasu>

Hello, I have a csv file named "seoul_3month" contains hourly pm10 concentration for around 105 sites collected for 3 months. Please download from here.  By using this dataset, I have plotted variogram for every hour of 3 months (total 2208 variogram) using automap package in R. From every variogram, I can see that the range, sill and nugget value is written on the variogram plot. But I want to extract all the psill,range and nugget value in a table for every individual variogram (hour). Is it possible in R?  [Actually, in future I want to make some graph using those range, sill and nugget to compare the changes]. I wrote the following code to plot 2208 variogram : library(sp)
library(gstat)
library(rgdal)
library(automap)
seoul_3month
seoul_3month_hour vars
  return(plot)
})
vars[[1]]..
vars[[2208]]  If you have any further query please let me know. Thanks in advance. Orpheus
 




-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150825/0d79a297/attachment.html>

From clusk at waikato.ac.nz  Tue Aug 25 12:23:21 2015
From: clusk at waikato.ac.nz (Christopher Lusk)
Date: Tue, 25 Aug 2015 22:23:21 +1200
Subject: [R-sig-Geo] problem plotting elevational map of New Zealand
Message-ID: <CABqyKttbRbAtO1BvFiRZ3mTLmpO=xVhQgdxnS62Pd+Tu=RVpsg@mail.gmail.com>

Hi - I've been making elevational maps of several countries, but for some
reason the code won't work for New Zealand:

library(raster)
x <- getData('alt', country = "NZ")
plot(x)
colfunc <- colorRampPalette(c("black", "white"))
plot(x,col=(colfunc(50)), cex.axis=1, las=1)
title(xlab = "Longitude (degrees E)", ylab="Latitude (degrees S)")

This makes perfectly good maps of plenty of countries (e.g. Australia,
Spain, France) but when I write "country = "NZ"  " on line 2, here's what
happens:

> x <- getData('alt', country = "NZ")
trying URL 'http://biogeo.ucdavis.edu/data/diva/msk_alt/NZL_msk_alt.zip'
Content type 'application/zip' length 649397 bytes (634 Kb)
opened URL
downloaded 634 Kb

returning a list of RasterLayer objects
> plot(x)
Error in xy.coords(x, y, xlabel, ylabel, log) :
  'x' is a list, but does not have components 'x' and 'y'
> colfunc <- colorRampPalette(c("black", "white"))
> plot(x,col=(colfunc(50)), cex.axis=1, las=1)
Error in xy.coords(x, y, xlabel, ylabel, log) :
  'x' is a list, but does not have components 'x' and 'y'
> title(xlab = "Longitude (degrees E)", ylab="Latitude (degrees S)")

I'd really appreciate advice on how to fix this, or other approaches that
might work for NZ. As you can see above, R found the data, but didn't make
the map.

thanks

Chris

-- 
Dr. Chris Lusk
Environmental Research Institute
The University of Waikato
Private Bag 3105, Hamilton
New Zealand / Aotearoa
http://sci.waikato.ac.nz/sites/clusk/
Ph 64 7 838 4205
~  ~  ~  ~  ~  ~  ~

	[[alternative HTML version deleted]]


From johnbaums at gmail.com  Tue Aug 25 12:32:25 2015
From: johnbaums at gmail.com (John Baumgartner)
Date: Tue, 25 Aug 2015 20:32:25 +1000
Subject: [R-sig-Geo] problem plotting elevational map of New Zealand
In-Reply-To: <CABqyKttbRbAtO1BvFiRZ3mTLmpO=xVhQgdxnS62Pd+Tu=RVpsg@mail.gmail.com>
References: <CABqyKttbRbAtO1BvFiRZ3mTLmpO=xVhQgdxnS62Pd+Tu=RVpsg@mail.gmail.com>
Message-ID: <CACpmSOvD33K9nDkciDFvzKMHU7wAV-jOgPpVQmrXrjHRoD7x8A@mail.gmail.com>

Take a look at str(x, 1). I'm not sure why, but two raster layers are
downloaded. Try plot(x[[1]]).

On Tue, Aug 25, 2015 at 8:23 PM, Christopher Lusk <clusk at waikato.ac.nz>
wrote:

> Hi - I've been making elevational maps of several countries, but for some
> reason the code won't work for New Zealand:
>
> library(raster)
> x <- getData('alt', country = "NZ")
> plot(x)
> colfunc <- colorRampPalette(c("black", "white"))
> plot(x,col=(colfunc(50)), cex.axis=1, las=1)
> title(xlab = "Longitude (degrees E)", ylab="Latitude (degrees S)")
>
> This makes perfectly good maps of plenty of countries (e.g. Australia,
> Spain, France) but when I write "country = "NZ"  " on line 2, here's what
> happens:
>
> > x <- getData('alt', country = "NZ")
> trying URL 'http://biogeo.ucdavis.edu/data/diva/msk_alt/NZL_msk_alt.zip'
> Content type 'application/zip' length 649397 bytes (634 Kb)
> opened URL
> downloaded 634 Kb
>
> returning a list of RasterLayer objects
> > plot(x)
> Error in xy.coords(x, y, xlabel, ylabel, log) :
>   'x' is a list, but does not have components 'x' and 'y'
> > colfunc <- colorRampPalette(c("black", "white"))
> > plot(x,col=(colfunc(50)), cex.axis=1, las=1)
> Error in xy.coords(x, y, xlabel, ylabel, log) :
>   'x' is a list, but does not have components 'x' and 'y'
> > title(xlab = "Longitude (degrees E)", ylab="Latitude (degrees S)")
>
> I'd really appreciate advice on how to fix this, or other approaches that
> might work for NZ. As you can see above, R found the data, but didn't make
> the map.
>
> thanks
>
> Chris
>
> --
> Dr. Chris Lusk
> Environmental Research Institute
> The University of Waikato
> Private Bag 3105, Hamilton
> New Zealand / Aotearoa
> http://sci.waikato.ac.nz/sites/clusk/
> Ph 64 7 838 4205
> ~  ~  ~  ~  ~  ~  ~
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From tim.appelhans at gmail.com  Tue Aug 25 12:32:27 2015
From: tim.appelhans at gmail.com (Tim Appelhans)
Date: Tue, 25 Aug 2015 12:32:27 +0200
Subject: [R-sig-Geo] problem plotting elevational map of New Zealand
In-Reply-To: <CABqyKttbRbAtO1BvFiRZ3mTLmpO=xVhQgdxnS62Pd+Tu=RVpsg@mail.gmail.com>
References: <CABqyKttbRbAtO1BvFiRZ3mTLmpO=xVhQgdxnS62Pd+Tu=RVpsg@mail.gmail.com>
Message-ID: <55DC443B.7010207@gmail.com>

Chris,
the downloaded data is a list of two entries. First entry is for 
'main-land' NZ, second for Chatham Islands.

So, plot(x[[1]],  col=(colfunc(50)), cex.axis=1, las=1)

should work as expected for main-land NZ.

Best
Tim


On 25.08.2015 12:23, Christopher Lusk wrote:
> Hi - I've been making elevational maps of several countries, but for some
> reason the code won't work for New Zealand:
>
> library(raster)
> x <- getData('alt', country = "NZ")
> plot(x)
> colfunc <- colorRampPalette(c("black", "white"))
> plot(x,col=(colfunc(50)), cex.axis=1, las=1)
> title(xlab = "Longitude (degrees E)", ylab="Latitude (degrees S)")
>
> This makes perfectly good maps of plenty of countries (e.g. Australia,
> Spain, France) but when I write "country = "NZ"  " on line 2, here's what
> happens:
>
>> x <- getData('alt', country = "NZ")
> trying URL 'http://biogeo.ucdavis.edu/data/diva/msk_alt/NZL_msk_alt.zip'
> Content type 'application/zip' length 649397 bytes (634 Kb)
> opened URL
> downloaded 634 Kb
>
> returning a list of RasterLayer objects
>> plot(x)
> Error in xy.coords(x, y, xlabel, ylabel, log) :
>    'x' is a list, but does not have components 'x' and 'y'
>> colfunc <- colorRampPalette(c("black", "white"))
>> plot(x,col=(colfunc(50)), cex.axis=1, las=1)
> Error in xy.coords(x, y, xlabel, ylabel, log) :
>    'x' is a list, but does not have components 'x' and 'y'
>> title(xlab = "Longitude (degrees E)", ylab="Latitude (degrees S)")
> I'd really appreciate advice on how to fix this, or other approaches that
> might work for NZ. As you can see above, R found the data, but didn't make
> the map.
>
> thanks
>
> Chris
>

-- 
#####################################
Tim Appelhans
Department of Geography
Environmental Informatics
Philipps Universit?t Marburg
Deutschhausstra?e 12
35032 Marburg (Paketpost: 35037 Marburg)
Germany

Tel +49 (0) 6421 28-25957

http://environmentalinformatics-marburg.de/


From manuel.schneider at art.admin.ch  Tue Aug 25 13:45:11 2015
From: manuel.schneider at art.admin.ch (Manuel Schneider)
Date: Tue, 25 Aug 2015 11:45:11 +0000
Subject: [R-sig-Geo] Need help in creating a grid
References: <CAEs_ZqxjRyX+4bnk=cEA83pUhuy3k8HEUPLGweTwXKT9qPSyWA@mail.gmail.com>
	<HE1PR04MB12766E7C1E879B7AFCC8D434DB650@HE1PR04MB1276.eurprd04.prod.outlook.com>
Message-ID: <loom.20150825T134231-786@post.gmane.org>

See SpatialGridDataFrame in package sp


From bernd.vogelgesang at gmx.de  Tue Aug 25 16:24:08 2015
From: bernd.vogelgesang at gmx.de (Bernd Vogelgesang)
Date: Tue, 25 Aug 2015 16:24:08 +0200
Subject: [R-sig-Geo] Need help in creating a grid
In-Reply-To: <CAEs_ZqxjRyX+4bnk=cEA83pUhuy3k8HEUPLGweTwXKT9qPSyWA@mail.gmail.com>
References: <CAEs_ZqxjRyX+4bnk=cEA83pUhuy3k8HEUPLGweTwXKT9qPSyWA@mail.gmail.com>
Message-ID: <op.x3xgyipfl2i25i@bernd-terra-pc>

Hi,
just found that some days ago. No Idea if that is what you meant or need.

bb <- bbox(spdf)
cs <- c(0.1,0.1)  # cell size
cc <- bb[, 1] + (cs/2)  # cell offset
cd <- ceiling(diff(t(bb))/cs)  # number of cells per direction
grd <- GridTopology(cellcentre.offset=cc, cellsize=cs, cells.dim=cd)
sp_grd <- SpatialGridDataFrame(grd,
                            data=data.frame(id=1:prod(cd)))


from: http://gis.stackexchange.com/a/153958/8202

Cheers
Bernd


Am 20.08.2015, 21:49 Uhr, schrieb prabhu <prabhu142003 at gmail.com>:

> I have to create a grid to view the heatmap of my data on a geo location.
>
> I am stuck with using some libraries that are used to create such grid.
> Anyone here to help please ?
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


-- 
Bernd Vogelgesang
Siedlerstra?e 2
91083 Baiersdorf/Igelsdorf
Tel: 09133-825374


From denn2duk at yahoo.com  Tue Aug 25 17:26:45 2015
From: denn2duk at yahoo.com (Denys Dukhovnov)
Date: Tue, 25 Aug 2015 15:26:45 +0000 (UTC)
Subject: [R-sig-Geo] Help needed with extraction of raster statistics by
	polygons
Message-ID: <1167514622.277661.1440516405600.JavaMail.yahoo@mail.yahoo.com>

Hello all! 

I need to spatially calculate 30-meter grid raster mean over US Census blocks in North East region (approx. 1.9 mln street blocks/polygons). I came up with the script that runs in parallel, but it still takes days to complete, even when the i7 CPU is used up to the max. My question: is there any other way to improve the processing speed given the set-up below (I included the backbone of the script to save space). I am new to R, so any help will be much appreciated. Thanks a lot!

Regards,
Denys
____________________________

library(sp)
library(rgdal)
library(raster)
library(foreach)
library(spatial.tools)

Grid30m <- raster("raster.tif")????# loading main raster into R
NEfips <- c(09, 10, 11, ....)?????? # list of state FIPS codes, whose street block polygons are to be processed
ShapePath <- "T:\\..."???? ????? ?? # path to block shapefiles 

sfQuickInit(cpus=8)?????????????? ? # setting up and registering parallel processing back-end

for (x in NEfips)???? {
??? State <- paste("block_", x , sep="")
? ? Blocks <- readOGR(dsn=ShapePath, layer=State[1], stringsAsFactors=F)??? # loading the block polygons
? ? BlocksReproject <- spTransform(Blocks, crs(Grid30m))
??? 
? ? GridMean <- foreach (i=1:length(BlocksReproject$GEOID10), .combine='c', .packages="raster") %dopar% {??????? # Parallel processing loop for extracting mean raster value per street block polygon
?? ? ? ? ? extract(Grid30m, BlocksReproject[i], fun=mean)
??? }
? ? write.table(...)??? # Generating output containing the mean raster statistics for each block polygon.
}

	[[alternative HTML version deleted]]


From Dominik.Schneider at colorado.edu  Tue Aug 25 17:35:22 2015
From: Dominik.Schneider at colorado.edu (Dominik Schneider)
Date: Tue, 25 Aug 2015 09:35:22 -0600
Subject: [R-sig-Geo] Help needed with extraction of raster statistics by
	polygons
In-Reply-To: <1167514622.277661.1440516405600.JavaMail.yahoo@mail.yahoo.com>
References: <1167514622.277661.1440516405600.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <CAHYDKLb0kgWWx3AcNzExOOFiyV=rdtouF=vc-cxw+hh_TqJH9Q@mail.gmail.com>

Denys,
The GIS functions in R have great utility, but speed is an issue; extract()
in particular. So, if you make a 30m raster equivalent to the Grid30m but
with the cell numbers as the values, you can use extract just once to
determine which cells are to be extracted with each polygon. Then use
regular indexing to find the mean for the raster cells covered by each
polygon. This should be much faster.
Dominik

Dominik Schneider
o 303.735.6296 | c 518.956.3978


On Tue, Aug 25, 2015 at 9:26 AM, Denys Dukhovnov via R-sig-Geo <
r-sig-geo at r-project.org> wrote:

> Hello all!
>
> I need to spatially calculate 30-meter grid raster mean over US Census
> blocks in North East region (approx. 1.9 mln street blocks/polygons). I
> came up with the script that runs in parallel, but it still takes days to
> complete, even when the i7 CPU is used up to the max. My question: is there
> any other way to improve the processing speed given the set-up below (I
> included the backbone of the script to save space). I am new to R, so any
> help will be much appreciated. Thanks a lot!
>
> Regards,
> Denys
> ____________________________
>
> library(sp)
> library(rgdal)
> library(raster)
> library(foreach)
> library(spatial.tools)
>
> Grid30m <- raster("raster.tif")    # loading main raster into R
> NEfips <- c(09, 10, 11, ....)       # list of state FIPS codes, whose
> street block polygons are to be processed
> ShapePath <- "T:\\..."              # path to block shapefiles
>
> sfQuickInit(cpus=8)                 # setting up and registering parallel
> processing back-end
>
> for (x in NEfips)     {
>     State <- paste("block_", x , sep="")
>     Blocks <- readOGR(dsn=ShapePath, layer=State[1],
> stringsAsFactors=F)    # loading the block polygons
>     BlocksReproject <- spTransform(Blocks, crs(Grid30m))
>
>     GridMean <- foreach (i=1:length(BlocksReproject$GEOID10),
> .combine='c', .packages="raster") %dopar% {        # Parallel processing
> loop for extracting mean raster value per street block polygon
>            extract(Grid30m, BlocksReproject[i], fun=mean)
>     }
>     write.table(...)    # Generating output containing the mean raster
> statistics for each block polygon.
> }
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From qiuhuanihao at gmail.com  Tue Aug 25 19:26:14 2015
From: qiuhuanihao at gmail.com (Qiuhua Ma)
Date: Tue, 25 Aug 2015 11:26:14 -0600
Subject: [R-sig-Geo] Kelejian-robinson Test Command?
Message-ID: <CACc7PKqdwtHGonemPzHj1T6d9678x6GxkSdRgf8u6cmubPT46Q@mail.gmail.com>

Hi,

I run Moran's I test and LM test for spatial autocorrelation. However I
cannot find the command for KR test. Is this command availabel in R?

thanks,

Chelsea

	[[alternative HTML version deleted]]


From tim.appelhans at gmail.com  Wed Aug 26 09:41:28 2015
From: tim.appelhans at gmail.com (Tim Appelhans)
Date: Wed, 26 Aug 2015 09:41:28 +0200
Subject: [R-sig-Geo] How to plot multiple semi-variogram from a single
 dataset efficiently in R?
In-Reply-To: <601589596.1440569180004.JavaMail.root@eunhasu>
References: <601589596.1440569180004.JavaMail.root@eunhasu>
Message-ID: <55DD6DA8.5040904@gmail.com>

Uzzal,
it should show exactly that in the top left corner of each variogram. It 
does on my computer.

Also, I include R-si-geo again as other people might have similar problems.

Cheers
Tim

On 26.08.2015 08:06, Uzzal wrote:
> I am extreamly sorry for my previous mail. Now its working.I forgot to 
> loaded "latticeExtra" package.
>
> The plots I got ,it all have individual names . But every plot has 7 
> variogram.is it possible to naming each variogram in each plot also 
> like "20120301","20120302",..........."201203007"?
>
> Uzzal
>
>     --- Original Message ---
>     *From : * "Tim Appelhans"<tim.appelhans at gmail.com>
>     *To : * "Uzzal"<uzzal at gist.ac.kr>
>     *Date : * 2015/08/26 Wednesday AM 1:14:25
>     *Subject : * Re: [R-sig-Geo] How to plot multiple semi-variogram
>     from a single dataset efficiently in R?
>
>     How's this:
>
>     ### in order to use latticeCombineGrid() you need to use
>     ##################
>     ### library(devtools) to install library(Rsenal)
>     ##########################
>     # install.packages(devtools)
>     # library(devtools)
>     # install_github("environmentalinformatics-marburg/Rsenal")
>     ###########################################################################
>
>     library(sp)
>     library(gstat)
>     library(rgdal)
>     library(automap)
>     library(Rsenal)
>     library(latticeExtra)
>
>     seoul311 <- read.csv("Downloads/seoul1to7.csv")
>     seoul311 <- na.omit(seoul311)
>
>     ### first we split seoul311 by time into a list rather than
>     subsetting manually
>     seoul311_splt <- split(seoul311, seoul311$time)
>
>     ### now we loop (using lapply()) over each seoul311_splt entry and
>     calculate
>     ### variogram using autofitVariogram and return the variogram plot
>     vars <- lapply(seq(seoul311_splt), function(i) {
>
>       dat <- seoul311_splt[[i]]
>       coordinates(dat) <- ~LON+LAT
>       proj4string(dat) <- "+proj=longlat +datum=WGS84"
>       dat <- spTransform(dat, CRS("+proj=utm +north +zone=52
>     +datum=WGS84"))
>
>       variogram <- autofitVariogram(PM10 ~ 1, dat)
>
>       plt <- plot(variogram, plotit = FALSE, asp = 1)
>
>       ### in case you do not want to fix xlim and ylim to be identical
>       ### for each plot just comment out the following line or change
>       ### values as you see fit
>       plt <- update(plt, xlim = c(-1000, 45000), ylim = c(0, 1000))
>
>       return(plt)
>     })
>
>     ### now we actually have 23 * 7 variogram plots which we will combine
>     ### into 23 hourly plots using latticeCombineGrid()
>     hrs <- substr(names(seoul311_splt), 9, 10)
>     dates <- unique(substr(names(seoul311_splt), 1, 8))
>     hrs_unique <- unique(substr(names(seoul311_splt), 9, 10))
>
>     plts_hrs <- lapply(seq(unique(hrs)), function(j) {
>
>       indx <- hrs %in% unique(hrs)[j]
>       hr_plt <- vars[indx]
>
>       fin_plt <- latticeCombineGrid(hr_plt, layout = c(3, 3)) +
>         layer(panel.text(x = 1000, y = 900, adj = c(0, 1),
>                          labels = dates[panel.number()]))
>
>       fin_plt <- update(fin_plt, main = paste("Variogram for hour",
>     hrs_unique[j]))
>
>       return(fin_plt)
>
>     })
>
>     ### save each plot as .png
>     ### NOTE: latttice plots need to be print()ed!!!
>     for (i in seq(hrs_unique)) {
>       png(paste0("plot_hr_", hrs_unique[i], ".png"),
>           width = 25, height = 25, units = "cm", res = 300)
>       print(plts_hrs[[i]])
>       dev.off()
>     }
>
>
>     Is this what you need?
>
>     Best
>     Tim
>
>     On 25.08.2015 06:19, Uzzal wrote:
>>
>>     Hello Tim, How about your last weekend? By the way, you told me
>>     to make you remember about my last problem. Good day.
>>
>>     Uzzal
>>
>>         --- Original Message ---
>>         *From : * "Tim Appelhans"<tim.appelhans at gmail.com>
>>         *To : * "Uzzal"<uzzal at gist.ac.kr>
>>         *Date : * 2015/08/19 Wednesday PM 7:21:54
>>         *Subject : * Re: [R-sig-Geo] How to plot multiple
>>         semi-variogram from a single dataset efficiently in R?
>>
>>         Uzzal,
>>         this is surely possible. I will be on holidays until next
>>         week so will not get back to you before then.
>>         If you haven't heard from me by the end of next week, please
>>         send me a reminder email as I will most likely have gotten
>>         crried away with other things.
>>
>>         Cheers
>>         Tim
>>
>>         On 18.08.2015 19:03, Uzzal wrote:
>>>
>>>         Dear Tim, Thank you so much for your quick response. It
>>>         helped me a lot. I can't resist myself to ask you my another
>>>         query related to this. I don't know, If you mind then please
>>>         tell me, I will ask in another email:
>>>
>>>         My another query:
>>>         According to your coad,
>>>
>>>
>>>             plts_hrs[[1]]
>>>             .
>>>             .
>>>             plts_hrs[[23]]   give me the 23 plots individually with
>>>         same title. If I want those 23 plots _with different
>>>         title(also individual name of variogram in a plot)_
>>>
>>>          by a single loop and those plots will be automatically
>>>         saved in a folder, Is it possible in R?
>>>
>>>         For example, First plot title would be "Variogram for 1.00 a.m
>>>
>>>         And the 7 variograms title in the first plot would be like 1
>>>         march , 2.00 march....7 march.
>>>
>>>         Actually I am new in R and weak in loop operation.
>>>
>>>         I tried to do it with dev.off () command. But I didn't get
>>>         success.
>>>         Could you please help me? Thanks a lot again.
>>>
>>>         Orpheus
>>>
>>>             --- Original Message ---
>>>             *From : * "Tim Appelhans"<tim.appelhans at gmail.com>
>>>             *To : * r-sig-geo at r-project.org
>>>             *Cc : * uzzal at gist.ac.kr
>>>             *Date : * 2015/08/17 Monday PM 6:49:00
>>>             *Subject : * Re: [R-sig-Geo] How to plot multiple
>>>             semi-variogram from a single dataset efficiently in R?
>>>
>>>             Orpheus,
>>>             here's one option to get what you want.
>>>             The problem with fitting that many variograms is that if
>>>             you want to specify each variogram individually (i.e.
>>>             nugget, range, model etc.), there is no way to automate
>>>             this with loops or thelike.
>>>             You can, however, use library(automap) to automatically
>>>             fit a variogram to your data. Then a possible solution
>>>             could look like this:
>>>
>>>
>>>             ### in order to use latticeCombineGrid() you need to use
>>>             ##################
>>>             ### library(devtools) to install library(Rsenal)
>>>             ##########################
>>>             # install.packages(devtools)
>>>             # library(devtools)
>>>             # install_github("environmentalinformatics-marburg/Rsenal")
>>>             ###########################################################################
>>>
>>>             library(sp)
>>>             library(gstat)
>>>             library(rgdal)
>>>             library(automap)
>>>             library(Rsenal)
>>>
>>>             seoul311 <- read.csv("Downloads/seoul1to7.csv")
>>>             seoul311 <- na.omit(seoul311)
>>>
>>>             ### first we split seoul311 by time into a list rather
>>>             than subsetting manually
>>>             seoul311_splt <- split(seoul311, seoul311$time)
>>>
>>>             ### now we loop (using lapply()) over each seoul311_splt
>>>             entry and calculate
>>>             ### variogram using autofitVariogram and return the
>>>             variogram plot
>>>             vars <- lapply(seq(seoul311_splt), function(i) {
>>>
>>>               dat <- seoul311_splt[[i]]
>>>               coordinates(dat) <- ~LON+LAT
>>>               proj4string(dat) <- "+proj=longlat +datum=WGS84"
>>>               dat <- spTransform(dat, CRS("+proj=utm +north +zone=52
>>>             +datum=WGS84"))
>>>
>>>               variogram <- autofitVariogram(PM10 ~ 1, dat)
>>>
>>>               plt <- plot(variogram, plotit = FALSE, asp = 1)
>>>
>>>               ### in case you do not want to fix xlim and ylim to be
>>>             identical
>>>               ### for each plot just comment out the following line
>>>             or change
>>>               ### values as you see fit
>>>               plt <- update(plt, xlim = c(-1000, 45000), ylim = c(0,
>>>             1000))
>>>
>>>               return(plt)
>>>             })
>>>
>>>             ### now we actually have 23 * 7 variogram plots which we
>>>             will combine
>>>             ### into 23 hourly plots using latticeCombineGrid()
>>>             hrs <- substr(names(seoul311_splt), 9, 10)
>>>
>>>             plts_hrs <- lapply(seq(unique(hrs)), function(j) {
>>>
>>>               indx <- hrs %in% unique(hrs)[j]
>>>               hr_plt <- vars[indx]
>>>
>>>             return(latticeCombineGrid(hr_plt, layout = c(3, 3)))
>>>
>>>             })
>>>
>>>             ### plot for hour 1
>>>             plts_hrs[[1]]
>>>
>>>             ### plot for hour 23
>>>             plts_hrs[[23]]
>>>
>>>             ### ...
>>>
>>>
>>>             HTH
>>>
>>>             Best,
>>>             Tim
>>>
>>>
>>>             On 17.08.2015 09:43, Uzzal wrote:
>>>>             Actually I asked this same question to some other forum
>>>>             but unfortunate I didn't get the appropriate response.
>>>>             But I am kind of struck with this problem. I am giving
>>>>             the link of my problem previously posted in other
>>>>             forum: (really sorry for that)
>>>>             http://stackoverflow.com/questions/31762461/how-to-plot-multiple-semi-variogram-from-a-single-dataset-efficiently-in-r?noredirect=1#comment51767989_31762461
>>>>
>>>>             I want variogram time wise. For example, thevariogram
>>>>             for 1.00 am of 1 march to 7 march in one plot. That
>>>>             means 7 variograms in one plot. in such a way there
>>>>             will be 23 plot contains (23*7) variogram. Thanks in
>>>>             adv! ance.
>>>>
>>>>             Orpheus
>>>>
>>>>
>>>>
>>>>             Uzzal Kumar Dash
>>>>             Master's student
>>>>             Air Quality & Climate Modeling Laboratory (AqCliMB)
>>>>             School of Environmental Science and Engineering (SESE)
>>>>             Gwangju Institute of Science and Technology (GIST)
>>>>             123 Cheomdan-gwagiro, Buk-gu, Gwangju 500-712
>>>>             Republic of Korea
>>>>
>>>>             web: http://aqclimb.gist.ac.kr/
>>>>
>>>>
>>>>
>>>>
>>>>             _______________________________________________
>>>>             R-sig-Geo mailing list
>>>>             R-sig-Geo at r-project.org
>>>>             https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>             -- 
>>>             #####################################
>>>             Tim Appelhans
>>>             Department of Geography
>>>             Environmental Informatics
>>>             Philipps Universit?t Marburg
>>>             Deutschhausstra?e 12
>>>             35032 Marburg (Paketpost: 35037 Marburg)
>>>             Germany
>>>
>>>             Tel +49 (0) 6421 28-25957
>>>
>>>             http://environmentalinformatics-marburg.de/
>>>
>>>
>>>
>>>
>>>         Uzzal Kumar Dash
>>>         Master's student
>>>         Air Quality & Climate Modeling Laboratory (AqCliMB)
>>>         School of Environmental Science and Engineering (SESE)
>>>         Gwangju Institute of Science and Technology (GIST)
>>>         123 Cheomdan-gwagiro, Buk-gu, Gwangju 500-712
>>>         Republic of Korea
>>>
>>>         web: http://aqclimb.gist.ac.kr/
>>>
>>>
>>
>>         -- 
>>         #####################################
>>         Tim Appelhans
>>         Department of Geography
>>         Environmental Informatics
>>         Philipps Universit?t Marburg
>>         Deutschhausstra?e 12
>>         35032 Marburg (Paketpost: 35037 Marburg)
>>         Germany
>>
>>         Tel +49 (0) 6421 28-25957
>>
>>         http://environmentalinformatics-marburg.de/
>>
>>
>>
>>
>>     Uzzal Kumar Dash
>>     Master's student
>>     Air Quality & Climate Modeling Laboratory (AqCliMB)
>>     School of Environmental Science and Engineering (SESE)
>>     Gwangju Institute of Science and Technology (GIST)
>>     123 Cheomdan-gwagiro, Buk-gu, Gwangju 500-712
>>     Republic of Korea
>>
>>     web: http://aqclimb.gist.ac.kr/
>>
>>
>
>     -- 
>     #####################################
>     Tim Appelhans
>     Department of Geography
>     Environmental Informatics
>     Philipps Universit?t Marburg
>     Deutschhausstra?e 12
>     35032 Marburg (Paketpost: 35037 Marburg)
>     Germany
>
>     Tel +49 (0) 6421 28-25957
>
>     http://environmentalinformatics-marburg.de/
>
>
>
>
>
>

-- 
#####################################
Tim Appelhans
Department of Geography
Environmental Informatics
Philipps Universit?t Marburg
Deutschhausstra?e 12
35032 Marburg (Paketpost: 35037 Marburg)
Germany

Tel +49 (0) 6421 28-25957

http://environmentalinformatics-marburg.de/


	[[alternative HTML version deleted]]


From tim.appelhans at gmail.com  Wed Aug 26 10:22:39 2015
From: tim.appelhans at gmail.com (Tim Appelhans)
Date: Wed, 26 Aug 2015 10:22:39 +0200
Subject: [R-sig-Geo] How to plot multiple semi-variogram from a single
 dataset efficiently in R?
In-Reply-To: <1215228888.1440576731742.JavaMail.root@eunhasu>
References: <1215228888.1440576731742.JavaMail.root@eunhasu>
Message-ID: <55DD774F.10906@gmail.com>

Uzzal,
first of all, please always reply to the list as well. As I said, other 
people might have similar problems and will thus be able to find a 
soultion in the mail archives.

If you run the code I gave you, you will see that it works.

The relevant bit is

layer(panel.text(x = 1000, y = 900, adj = c(0, 1),
                      labels = dates[panel.number()]))

where the text gets plotted at x = 1000 and y = 900. In your case, y = 
900 is beyond the limits of the y-scale.

Replacing the above with this should fix it:

layer(grid.text(x = unit(0.1, "npc"),
                     y = unit(0.9, "npc"),
                     just = c("left", "top"),
                     label = dates[panel.number()]))

This will use normalised x and y scales ranging from 0 to 1 no matter 
what the absolute units are.

HTH
Tim

On 26.08.2015 10:12, Uzzal wrote:
>
> Oh really! But I got plot like this(Attached)!
>
> Uzzal
>
>     --- Original Message ---
>     *From : * "Tim Appelhans"<tim.appelhans at gmail.com>
>     *To : * "Uzzal"<uzzal at gist.ac.kr>,
>     "r-sig-geo"<r-sig-geo at r-project.org>
>     *Date : * 2015/08/26 Wednesday PM 4:41:28
>     *Subject : * Re: [R-sig-Geo] How to plot multiple semi-variogram
>     from a single dataset efficiently in R?
>
>     Uzzal,
>     it should show exactly that in the top left corner of each
>     variogram. It does on my computer.
>
>     Also, I include R-si-geo again as other people might have similar
>     problems.
>
>     Cheers
>     Tim
>
>     On 26.08.2015 08:06, Uzzal wrote:
>>     I am extreamly sorry for my previous mail. Now its working.I
>>     forgot to loaded "latticeExtra" package.
>>
>>     The plots I got ,it all have individual names . But every plot
>>     has 7 variogram.is it possible to naming each variogram in each
>>     plot also like "20120301","20120302",..........."201203007"?
>>
>>     Uzzal
>>
>>         --- Original Message ---
>>         *From : * "Tim Appelhans"<tim.appelhans at gmail.com>
>>         *To : * "Uzzal"<uzzal at gist.ac.kr>
>>         *Date : * 2015/08/26 Wednesday AM 1:14:25
>>         *Subject : * Re: [R-sig-Geo] How to plot multiple
>>         semi-variogram from a single dataset efficiently in R?
>>
>>         How's this:
>>
>>         ### in order to use latticeCombineGrid() you need to use
>>         ##################
>>         ### library(devtools) to install library(Rsenal)
>>         ##########################
>>         # install.packages(devtools)
>>         # library(devtools)
>>         # install_github("environmentalinformatics-marburg/Rsenal")
>>         ###########################################################################
>>
>>         library(sp)
>>         library(gstat)
>>         library(rgdal)
>>         library(automap)
>>         library(Rsenal)
>>         library(latticeExtra)
>>
>>         seoul311 <- read.csv("Downloads/seoul1to7.csv")
>>         seoul311 <- na.omit(seoul311)
>>
>>         ### first we split seoul311 by time into a list rather than
>>         subsetting manually
>>         seoul311_splt <- split(seoul311, seoul311$time)
>>
>>         ### now we loop (using lapply()) over each seoul311_splt
>>         entry and calculate
>>         ### variogram using autofitVariogram and return the variogram
>>         plot
>>         vars <- lapply(seq(seoul311_splt), function(i) {
>>
>>           dat <- seoul311_splt[[i]]
>>           coordinates(dat) <- ~LON+LAT
>>           proj4string(dat) <- "+proj=longlat +datum=WGS84"
>>           dat <- spTransform(dat, CRS("+proj=utm +north +zone=52
>>         +datum=WGS84"))
>>
>>           variogram <- autofitVariogram(PM10 ~ 1, dat)
>>
>>           plt <- plot(variogram, plotit = FALSE, asp = 1)
>>
>>           ### in case you do not want to fix xlim and ylim to be
>>         identical
>>           ### for each plot just comment out the following line or change
>>           ### values as you see fit
>>           plt <- update(plt, xlim = c(-1000, 45000), ylim = c(0, 1000))
>>
>>           return(plt)
>>         })
>>
>>         ### now we actually have 23 * 7 variogram plots which we will
>>         combine
>>         ### into 23 hourly plots using latticeCombineGrid()
>>         hrs <- substr(names(seoul311_splt), 9, 10)
>>         dates <- unique(substr(names(seoul311_splt), 1, 8))
>>         hrs_unique <- unique(substr(names(seoul311_splt), 9, 10))
>>
>>         plts_hrs <- lapply(seq(unique(hrs)), function(j) {
>>
>>           indx <- hrs %in% unique(hrs)[j]
>>           hr_plt <- vars[indx]
>>
>>           fin_plt <- latticeCombineGrid(hr_plt, layout = c(3, 3)) +
>>             layer(panel.text(x = 1000, y = 900, adj = c(0, 1),
>>                              labels = dates[panel.number()]))
>>
>>           fin_plt <- update(fin_plt, main = paste("Variogram for
>>         hour", hrs_unique[j]))
>>
>>           return(fin_plt)
>>
>>         })
>>
>>         ### save each plot as .png
>>         ### NOTE: latttice plots need to be print()ed!!!
>>         for (i in seq(hrs_unique)) {
>>           png(paste0("plot_hr_", hrs_unique[i], ".png"),
>>               width = 25, height = 25, units = "cm", res = 300)
>>           print(plts_hrs[[i]])
>>           dev.off()
>>         }
>>
>>
>>         Is this what you need?
>>
>>         Best
>>         Tim
>>
>>         On 25.08.2015 06:19, Uzzal wrote:
>>>
>>>         Hello Tim, How about your last weekend? By the way, you told
>>>         me to make you remember about my last problem. Good day.
>>>
>>>         Uzzal
>>>
>>>             --- Original Message ---
>>>             *From : * "Tim Appelhans"<tim.appelhans at gmail.com>
>>>             *To : * "Uzzal"<uzzal at gist.ac.kr>
>>>             *Date : * 2015/08/19 Wednesday PM 7:21:54
>>>             *Subject : * Re: [R-sig-Geo] How to plot multiple
>>>             semi-variogram from a single dataset efficiently in R?
>>>
>>>             Uzzal,
>>>             this is surely possible. I will be on holidays until
>>>             next week so will not get back to you before then.
>>>             If you haven't heard from me by the end of next week,
>>>             please send me a reminder email as I will most likely
>>>             have gotten crried away with other things.
>>>
>>>             Cheers
>>>             Tim
>>>
>>>             On 18.08.2015 19:03, Uzzal wrote:
>>>>
>>>>             Dear Tim, Thank you so much for your quick response. It
>>>>             helped me a lot. I can't resist myself to ask you my
>>>>             another query related to this. I don't know, If you
>>>>             mind then please tell me, I will ask in another email:
>>>>
>>>>             My another query:
>>>>             According to your coad,
>>>>
>>>>
>>>>                 plts_hrs[[1]]
>>>>                 .
>>>>                 .
>>>>                 plts_hrs[[23]] give me the 23 plots individually
>>>>             with same title. If I want those 23 plots _with
>>>>             different title(also individual name of variogram in a
>>>>             plot)_
>>>>
>>>>              by a single loop and those plots will be automatically
>>>>             saved in a folder, Is it possible in R?
>>>>
>>>>             For example, First plot title would be "Variogram for
>>>>             1.00 a.m
>>>>
>>>>             And the 7 variograms title in the first plot would be
>>>>             like 1 march , 2.00 march....7 march.
>>>>
>>>>             Actually I am new in R and weak in loop operation.
>>>>
>>>>             I tried to do it with dev.off () command. But I didn't
>>>>             get success.
>>>>             Could you please help me? Thanks a lot again.
>>>>
>>>>             Orpheus
>>>>
>>>>                 --- Original Message ---
>>>>                 *From : * "Tim Appelhans"<tim.appelhans at gmail.com>
>>>>                 *To : * r-sig-geo at r-project.org
>>>>                 *Cc : * uzzal at gist.ac.kr
>>>>                 *Date : * 2015/08/17 Monday PM 6:49:00
>>>>                 *Subject : * Re: [R-sig-Geo] How to plot multiple
>>>>                 semi-variogram from a single dataset efficiently in R?
>>>>
>>>>                 Orpheus,
>>>>                 here's one option to get what you want.
>>>>                 The problem with fitting that many variograms is
>>>>                 that if you want to specify each variogram
>>>>                 individually (i.e. nugget, range, model etc.),
>>>>                 there is no way to automate this with loops or
>>>>                 thelike.
>>>>                 You can, however, use library(automap) to
>>>>                 automatically fit a variogram to your data. Then a
>>>>                 possible solution could look like this:
>>>>
>>>>
>>>>                 ### in order to use latticeCombineGrid() you need
>>>>                 to use ##################
>>>>                 ### library(devtools) to install library(Rsenal)
>>>>                 ##########################
>>>>                 # install.packages(devtools)
>>>>                 # library(devtools)
>>>>                 #
>>>>                 install_github("environmentalinformatics-marburg/Rsenal")
>>>>                 ###########################################################################
>>>>
>>>>                 library(sp)
>>>>                 library(gstat)
>>>>                 library(rgdal)
>>>>                 library(automap)
>>>>                 library(Rsenal)
>>>>
>>>>                 seoul311 <- read.csv("Downloads/seoul1to7.csv")
>>>>                 seoul311 <- na.omit(seoul311)
>>>>
>>>>                 ### first we split seoul311 by time into a list
>>>>                 rather than subsetting manually
>>>>                 seoul311_splt <- split(seoul311, seoul311$time)
>>>>
>>>>                 ### now we loop (using lapply()) over each
>>>>                 seoul311_splt entry and calculate
>>>>                 ### variogram using autofitVariogram and return the
>>>>                 variogram plot
>>>>                 vars <- lapply(seq(seoul311_splt), function(i) {
>>>>
>>>>                   dat <- seoul311_splt[[i]]
>>>>                 coordinates(dat) <- ~LON+LAT
>>>>                 proj4string(dat) <- "+proj=longlat +datum=WGS84"
>>>>                   dat <- spTransform(dat, CRS("+proj=utm +north
>>>>                 +zone=52 +datum=WGS84"))
>>>>
>>>>                   variogram <- autofitVariogram(PM10 ~ 1, dat)
>>>>
>>>>                   plt <- plot(variogram, plotit = FALSE, asp = 1)
>>>>
>>>>                   ### in case you do not want to fix xlim and ylim
>>>>                 to be identical
>>>>                   ### for each plot just comment out the following
>>>>                 line or change
>>>>                   ### values as you see fit
>>>>                   plt <- update(plt, xlim = c(-1000, 45000), ylim =
>>>>                 c(0, 1000))
>>>>
>>>>                   return(plt)
>>>>                 })
>>>>
>>>>                 ### now we actually have 23 * 7 variogram plots
>>>>                 which we will combine
>>>>                 ### into 23 hourly plots using latticeCombineGrid()
>>>>                 hrs <- substr(names(seoul311_splt), 9, 10)
>>>>
>>>>                 plts_hrs <- lapply(seq(unique(hrs)), function(j) {
>>>>
>>>>                   indx <- hrs %in% unique(hrs)[j]
>>>>                   hr_plt <- vars[indx]
>>>>
>>>>                 return(latticeCombineGrid(hr_plt, layout = c(3, 3)))
>>>>
>>>>                 })
>>>>
>>>>                 ### plot for hour 1
>>>>                 plts_hrs[[1]]
>>>>
>>>>                 ### plot for hour 23
>>>>                 plts_hrs[[23]]
>>>>
>>>>                 ### ...
>>>>
>>>>
>>>>                 HTH
>>>>
>>>>                 Best,
>>>>                 Tim
>>>>
>>>>
>>>>                 On 17.08.2015 09:43, Uzzal wrote:
>>>>>                 Actually I asked this same question to some other
>>>>>                 forum but unfortunate I didn't get the appropriate
>>>>>                 response. But I am kind of struck with this
>>>>>                 problem. I am giving the link of my problem
>>>>>                 previously posted in other forum: (really sorry
>>>>>                 for that)
>>>>>                 http://stackoverflow.com/questions/31762461/how-to-plot-multiple-semi-variogram-from-a-single-dataset-efficiently-in-r?noredirect=1#comment51767989_31762461
>>>>>
>>>>>                 I want variogram time wise. For example,
>>>>>                 thevariogram for 1.00 am of 1 march to 7 march in
>>>>>                 one plot. That means 7 variograms in one plot. in
>>>>>                 such a way there will be 23 plot contains (23*7)
>>>>>                 variogram. Thanks in adv! ance.
>>>>>
>>>>>                 Orpheus
>>>>>
>>>>>
>>>>>
>>>>>                 Uzzal Kumar Dash
>>>>>                 Master's student
>>>>>                 Air Quality & Climate Modeling Laboratory (AqCliMB)
>>>>>                 School of Environmental Science and Engineering (SESE)
>>>>>                 Gwangju Institute of Science and Technology (GIST)
>>>>>                 123 Cheomdan-gwagiro, Buk-gu, Gwangju 500-712
>>>>>                 Republic of Korea
>>>>>
>>>>>                 web: http://aqclimb.gist.ac.kr/
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>                 _______________________________________________
>>>>>                 R-sig-Geo mailing list
>>>>>                 R-sig-Geo at r-project.org
>>>>>                 https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>>                 -- 
>>>>                 #####################################
>>>>                 Tim Appelhans
>>>>                 Department of Geography
>>>>                 Environmental Informatics
>>>>                 Philipps Universit?t Marburg
>>>>                 Deutschhausstra?e 12
>>>>                 35032 Marburg (Paketpost: 35037 Marburg)
>>>>                 Germany
>>>>
>>>>                 Tel +49 (0) 6421 28-25957
>>>>
>>>>                 http://environmentalinformatics-marburg.de/
>>>>
>>>>
>>>>
>>>>
>>>>             Uzzal Kumar Dash
>>>>             Master's student
>>>>             Air Quality & Climate Modeling Laboratory (AqCliMB)
>>>>             School of Environmental Science and Engineering (SESE)
>>>>             Gwangju Institute of Science and Technology (GIST)
>>>>             123 Cheomdan-gwagiro, Buk-gu, Gwangju 500-712
>>>>             Republic of Korea
>>>>
>>>>             web: http://aqclimb.gist.ac.kr/
>>>>
>>>>
>>>
>>>             -- 
>>>             #####################################
>>>             Tim Appelhans
>>>             Department of Geography
>>>             Environmental Informatics
>>>             Philipps Universit?t Marburg
>>>             Deutschhausstra?e 12
>>>             35032 Marburg (Paketpost: 35037 Marburg)
>>>             Germany
>>>
>>>             Tel +49 (0) 6421 28-25957
>>>
>>>             http://environmentalinformatics-marburg.de/
>>>
>>>
>>>
>>>
>>>         Uzzal Kumar Dash
>>>         Master's student
>>>         Air Quality & Climate Modeling Laboratory (AqCliMB)
>>>         School of Environmental Science and Engineering (SESE)
>>>         Gwangju Institute of Science and Technology (GIST)
>>>         123 Cheomdan-gwagiro, Buk-gu, Gwangju 500-712
>>>         Republic of Korea
>>>
>>>         web: http://aqclimb.gist.ac.kr/
>>>
>>>
>>
>>         -- 
>>         #####################################
>>         Tim Appelhans
>>         Department of Geography
>>         Environmental Informatics
>>         Philipps Universit?t Marburg
>>         Deutschhausstra?e 12
>>         35032 Marburg (Paketpost: 35037 Marburg)
>>         Germany
>>
>>         Tel +49 (0) 6421 28-25957
>>
>>         http://environmentalinformatics-marburg.de/
>>
>>
>>
>>
>>
>>
>
>     -- 
>     #####################################
>     Tim Appelhans
>     Department of Geography
>     Environmental Informatics
>     Philipps Universit?t Marburg
>     Deutschhausstra?e 12
>     35032 Marburg (Paketpost: 35037 Marburg)
>     Germany
>
>     Tel +49 (0) 6421 28-25957
>
>     http://environmentalinformatics-marburg.de/
>
>
>
>
>
>

-- 
#####################################
Tim Appelhans
Department of Geography
Environmental Informatics
Philipps Universit?t Marburg
Deutschhausstra?e 12
35032 Marburg (Paketpost: 35037 Marburg)
Germany

Tel +49 (0) 6421 28-25957

http://environmentalinformatics-marburg.de/


	[[alternative HTML version deleted]]


From Roger.Bivand at nhh.no  Wed Aug 26 18:24:19 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 26 Aug 2015 18:24:19 +0200
Subject: [R-sig-Geo] Kelejian-robinson Test Command?
In-Reply-To: <CACc7PKqdwtHGonemPzHj1T6d9678x6GxkSdRgf8u6cmubPT46Q@mail.gmail.com>
References: <CACc7PKqdwtHGonemPzHj1T6d9678x6GxkSdRgf8u6cmubPT46Q@mail.gmail.com>
Message-ID: <alpine.LFD.2.20.1508261823270.24048@reclus.nhh.no>

On Tue, 25 Aug 2015, Qiuhua Ma wrote:

> Hi,
>
> I run Moran's I test and LM test for spatial autocorrelation. However I
> cannot find the command for KR test. Is this command availabel in R?

No, but it shouldn't be difficult to construct if needed for historical 
purposes, contributions welcome.

Roger

>
> thanks,
>
> Chelsea
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From Beaulieu.Jake at epa.gov  Wed Aug 26 19:17:42 2015
From: Beaulieu.Jake at epa.gov (Beaulieu, Jake)
Date: Wed, 26 Aug 2015 17:17:42 +0000
Subject: [R-sig-Geo] Stackoverflow:
 how-to-adjust-the-size-of-the-points-when-using-plotkml-in-r
Message-ID: <DM2PR09MB0352A3FF9BFDC21732662A5EF3600@DM2PR09MB0352.namprd09.prod.outlook.com>

Hello,

Please follow this link to a plotKML question posted to Stackoverlfow.  I am not the original poster, but have the same question.  The suggested solution does not work.

http://stackoverflow.com/questions/30066342/how-to-adjust-the-size-of-the-points-when-using-plotkml-in-r


Thanks!

Jake J Beaulieu, PhD
United States Environmental Protection Agency
Office of Research and Development
National Risk Management Research Laboratory
Water Supply and Water Resources Division
Urban Waters Management Branch
26 W MLK Dr.
MS 698
Cincinnati, OH 45268
Phone: 513-569-7842


	[[alternative HTML version deleted]]


From timjp at unimelb.edu.au  Thu Aug 27 02:45:17 2015
From: timjp at unimelb.edu.au (Tim Peterson)
Date: Thu, 27 Aug 2015 10:45:17 +1000
Subject: [R-sig-Geo] GStat 'predict.c' parallel estimation
Message-ID: <55DE5D9D.40106@unimelb.edu.au>



Hi all,

I'm considering editing the GStat kriging file 'predict.c' (while loop 
at line 151-165) for parallel estimation. I require parallel estimation 
for both kriging and indicator simulation and will be applying it to a 
region of ~30 million grid cells, which will be repeated for 300 time 
points.

I appreciate that snow can be used for parallel kriging 
(https://r-forge.r-project.org/scm/viewvc.php/pkg/demo/snow.R?view=markup&revision=89&root=gstat) 
but, because of my computation burden, I require parallel calculation 
using Xeon Phi cards - hence I think the changes should be in 
'predict.c'. Also, in looking at the GStat C-code I suspect that the 
global variables in 'glvars.c' may complicate the parallel calculations. 
So anyway, before I embark upon this task (most likely using openMP), 
I'd be grateful if anyone could share tips or thoughts (and my edits 
will be freely shared.)

Also, some may be questioning the parallel estimation of each 
simulation. Considering that I'm estimating ~30 million cells, and will 
only be using ~70 cores per simulation, I am happy to accept the 
deficiency that recently estimated cells will not be used in the 
estimation of nearby cells within a concurrent parallel cycle. However, 
the estimates do need to be accessible to latter parallel cycles.

Lastly, my backup option is to use openMP to parallelise the GSLib 
Fortran subroutines 'cokb3d.for' and 'sisim.for' (ie outside of R). This 
is mainly because the subroutines are fairly standalone and don't use 
pointers - and hence possibly less problematic to make parallel.

Many thanks,

Tim

----------------------
Dr. Tim Peterson

The Department of Infrastructure Engineering
The University of Melbourne, 3010 Australia
T: +61 3 8344 9950, M: +61 0438 385 937

Dept. profile : 
http://www.ie.unimelb.edu.au/people/staff.php?person_ID=141135
Research Gate : https://www.researchgate.net/profile/Tim_Peterson7
Google Scholar: 
http://scholar.google.com.au/citations?user=kkYJLF4AAAAJ&hl=en&oi=ao


From timjp at unimelb.edu.au  Thu Aug 27 02:48:51 2015
From: timjp at unimelb.edu.au (Tim Peterson)
Date: Thu, 27 Aug 2015 10:48:51 +1000
Subject: [R-sig-Geo] Factorial kriging in GStat - tips for implementation?
Message-ID: <55DE5E73.1020007@unimelb.edu.au>

Hi all,

I'm looking to undertake factorial colocated cokriging with GStat but 
factorial kriging does not appear to be an available option in GStat (eg 
help.search("factorial kriging") ). There was a post in 2007 requesting 
this feature (http://marc.info/?l=r-sig-geo&m=119810046000747) and a 
proposed approach in 2000 
(https://www.mail-archive.com/gstat-info at geog.uu.nl/msg00045.html) but 
no updates since. As far as I can tell, the required changes would be to 
'gls.c' lines 412-423, specifically the call to GCV0 for calculating C0 
(right-hand side of the kriging matrix) should be edited so that only 
the covariance for the required factor is calculated.

Anyway, before I consider adding this feature to GStat, I'd be grateful 
if anyone could share tips or thoughts. Lastly, any changes I make will 
(of course) be freely shared.

Many thanks,

Tim

----------------------
Dr. Tim Peterson

The Department of Infrastructure Engineering
The University of Melbourne, 3010 Australia
T: +61 3 8344 9950, M: +61 0438 385 937

Dept. profile : 
http://www.ie.unimelb.edu.au/people/staff.php?person_ID=141135
Research Gate : https://www.researchgate.net/profile/Tim_Peterson7
Google Scholar: 
http://scholar.google.com.au/citations?user=kkYJLF4AAAAJ&hl=en&oi=ao


From edzer.pebesma at uni-muenster.de  Thu Aug 27 08:38:53 2015
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 27 Aug 2015 08:38:53 +0200
Subject: [R-sig-Geo] Factorial kriging in GStat - tips for
	implementation?
In-Reply-To: <55DE5E73.1020007@unimelb.edu.au>
References: <55DE5E73.1020007@unimelb.edu.au>
Message-ID: <55DEB07D.9030306@uni-muenster.de>



On 08/27/2015 02:48 AM, Tim Peterson wrote:
> Hi all,
> 
> I'm looking to undertake factorial colocated cokriging with GStat but
> factorial kriging does not appear to be an available option in GStat (eg
> help.search("factorial kriging") ). There was a post in 2007 requesting
> this feature (http://marc.info/?l=r-sig-geo&m=119810046000747) and a
> proposed approach in 2000
> (https://www.mail-archive.com/gstat-info at geog.uu.nl/msg00045.html) but
> no updates since. As far as I can tell, the required changes would be to
> 'gls.c' lines 412-423, specifically the call to GCV0 for calculating C0
> (right-hand side of the kriging matrix) should be edited so that only
> the covariance for the required factor is calculated.

Not being an expert in factorial kriging, I also think that this is what
is needed. A challenge may be to make the implementation simple and
clean, both from the perspective of the user as well as from the code
maintainer.

If the only goal is to suppress the nugget effect, as the poster in your
first link mentions, try replacing a "Nug" variogram model with an "Err"
variogram model.

> 
> Anyway, before I consider adding this feature to GStat, I'd be grateful
> if anyone could share tips or thoughts. Lastly, any changes I make will
> (of course) be freely shared.
> 
> Many thanks,
> 
> Tim
> 
> ----------------------
> Dr. Tim Peterson
> 
> The Department of Infrastructure Engineering
> The University of Melbourne, 3010 Australia
> T: +61 3 8344 9950, M: +61 0438 385 937
> 
> Dept. profile :
> http://www.ie.unimelb.edu.au/people/staff.php?person_ID=141135
> Research Gate : https://www.researchgate.net/profile/Tim_Peterson7
> Google Scholar:
> http://scholar.google.com.au/citations?user=kkYJLF4AAAAJ&hl=en&oi=ao
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi),  University of M?nster,
Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
Journal of Statistical Software:   http://www.jstatsoft.org/
Computers & Geosciences:   http://elsevier.com/locate/cageo/
Spatial Statistics Society http://www.spatialstatistics.info

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150827/e61b62c3/attachment.bin>

From edzer.pebesma at uni-muenster.de  Thu Aug 27 08:55:54 2015
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 27 Aug 2015 08:55:54 +0200
Subject: [R-sig-Geo] GStat 'predict.c' parallel estimation
In-Reply-To: <55DE5D9D.40106@unimelb.edu.au>
References: <55DE5D9D.40106@unimelb.edu.au>
Message-ID: <55DEB47A.3020901@uni-muenster.de>



On 08/27/2015 02:45 AM, Tim Peterson wrote:
> 
> 
> Hi all,
> 
> I'm considering editing the GStat kriging file 'predict.c' (while loop
> at line 151-165) for parallel estimation. I require parallel estimation
> for both kriging and indicator simulation and will be applying it to a
> region of ~30 million grid cells, which will be repeated for 300 time
> points.
> 
> I appreciate that snow can be used for parallel kriging
> (https://r-forge.r-project.org/scm/viewvc.php/pkg/demo/snow.R?view=markup&revision=89&root=gstat)
> but, because of my computation burden, I require parallel calculation
> using Xeon Phi cards - hence I think the changes should be in
> 'predict.c'. Also, in looking at the GStat C-code I suspect that the
> global variables in 'glvars.c' may complicate the parallel calculations.
> So anyway, before I embark upon this task (most likely using openMP),
> I'd be grateful if anyone could share tips or thoughts (and my edits
> will be freely shared.)

I've always thought of these global variables as being constant during
program execution. R being non-thread safe, I'm not sure how well R
combines with embedded C code that uses threads.

> 
> Also, some may be questioning the parallel estimation of each
> simulation. Considering that I'm estimating ~30 million cells, and will
> only be using ~70 cores per simulation, I am happy to accept the
> deficiency that recently estimated cells will not be used in the
> estimation of nearby cells within a concurrent parallel cycle. However,
> the estimates do need to be accessible to latter parallel cycles.

I can see that a shared memory approach could mess up the set of
previously simulated values ("msim" in msim.c), and that filling in
locally could be done in independent threads; yet, what do you do at the
boundaries of these regions?

As an alternative to this approach (and the one you sketch below) you
could think about a circulant embedding algorithm that uses a parallel
version of the fft; see fields:sim.rf and the routines in package
RandomFields.

> 
> Lastly, my backup option is to use openMP to parallelise the GSLib
> Fortran subroutines 'cokb3d.for' and 'sisim.for' (ie outside of R). This
> is mainly because the subroutines are fairly standalone and don't use
> pointers - and hence possibly less problematic to make parallel.
> 
> Many thanks,
> 
> Tim
> 
> ----------------------
> Dr. Tim Peterson
> 
> The Department of Infrastructure Engineering
> The University of Melbourne, 3010 Australia
> T: +61 3 8344 9950, M: +61 0438 385 937
> 
> Dept. profile :
> http://www.ie.unimelb.edu.au/people/staff.php?person_ID=141135
> Research Gate : https://www.researchgate.net/profile/Tim_Peterson7
> Google Scholar:
> http://scholar.google.com.au/citations?user=kkYJLF4AAAAJ&hl=en&oi=ao
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi),  University of M?nster,
Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
Journal of Statistical Software:   http://www.jstatsoft.org/
Computers & Geosciences:   http://elsevier.com/locate/cageo/
Spatial Statistics Society http://www.spatialstatistics.info

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150827/54a4ea40/attachment.bin>

From tim.appelhans at gmail.com  Thu Aug 27 12:49:11 2015
From: tim.appelhans at gmail.com (Tim Appelhans)
Date: Thu, 27 Aug 2015 12:49:11 +0200
Subject: [R-sig-Geo] How to plot multiple semi-variogram from a single
 dataset efficiently in R?
In-Reply-To: <118669656.1440671142939.JavaMail.root@eunhasu>
References: <118669656.1440671142939.JavaMail.root@eunhasu>
Message-ID: <55DEEB27.3040505@gmail.com>

Uzzal,
I see that in your lapply() call you create an object called 'plot'. 
This is bad practice as 'plot' is reserved for a function call in base R 
and may get you in trouble in certain circumstances. That is why in the 
code I gave you (and in the code that follows) this object is called 
'plt' rather than plot.

The following will create a variogram for every hour of each day, label 
them according to YYYY-mm-dd HH:MM:SS (standard POSIX datetime format) 
and save each as a file following a naming convetion of 
'plot_YYYYmmddHH.png' to avoid spaces in the file names.

library(sp)
library(gstat)
library(rgdal)
library(automap)
library(latticeExtra)

seoul311 <- read.csv("Downloads/seoul1to7.csv")
seoul311 <- na.omit(seoul311)

### first we split seoul311 by time into a list rather than subsetting 
manually
seoul311_splt <- split(seoul311, seoul311$time)

a<-as.POSIXct(names(seoul311_splt), format="%Y%m%d%H")
a

vars <- lapply(seq(seoul311_splt), function(i) {

   dat <- seoul311_splt[[i]]
   coordinates(dat) <- ~LON+LAT
   proj4string(dat) <- "+proj=longlat +datum=WGS84"
   dat <- spTransform(dat, CRS("+proj=utm +north +zone=52 +datum=WGS84"))

   variogram <- autofitVariogram(PM10 ~ 1, dat)

   plt <- plot(variogram, plotit = FALSE, asp = 1)
   plt <- update(plt, main = paste("Variogram for", as.character(a[i])))

   return(plt)
})

for (i in seq(names(seoul311_splt))) {
   png(paste0("plot_", names(seoul311_splt)[i], ".png"),
       width = 25, height = 25, units = "cm", res = 300)
   print(vars[[i]])
   dev.off()
}


HTH
Tim

On 27.08.2015 12:25, Uzzal wrote:
>
> Dear Tim, after getting lots of help from you, I was trying to 
> plot all variogram in different plot with different name (1 variogram 
> per plot). I was trying to naming those variogram like "variogram for 
> 20120301 01:00", "variogram for 20120301 02:00".......etc. 
> I improvised your code in the following way (below) but didn't get 
> success! Is it possible to plot different variogram in different plot 
> with different name  and save it in a single loop?  Thanks a lot for 
> your valuable time.
>
> a<-as.POSIXct(names(seoul311_split), format="%Y%m%d%H")
> a
> hours<-substr(a,1,16)
> hours
>
> vars<-lapply(seq(seoul311_split), function(i)
> {
>   dat<-seoul311_split[[i]]
>   coordinates(dat)<-~LON+LAT
>   proj4string(dat) <- "+proj=longlat +datum=WGS84"
>   dat <- spTransform(dat, CRS("+proj=utm +north +zone=52 +datum=WGS84"))
>   variogram<-autofitVariogram(log(PM10)~1,dat, model="Sph")
>   plot<- plot(variogram,plotit=FALSE, asp=1,
>               main= paste("Semivariogram for", hours[i]))
>
>   return(plot)
> })
>
> Uzzal
>
>     --- Original Message ---
>     *From : * "Uzzal"<uzzal at gist.ac.kr>
>     *To : * "Tim Appelhans"<tim.appelhans at gmail.com>,
>     "r-sig-geo"<r-sig-geo at r-project.org>
>     *Date : * 2015/08/27 Thursday AM 1:44:12
>     *Subject : * Re: Re: [R-sig-Geo] How to plot multiple
>     semi-variogram from a single dataset efficiently in R?
>
>     Thank you vary much. Now its totally working!
>
>     Uzzal
>
>         --- Original Message ---
>         *From : * "Tim Appelhans"<tim.appelhans at gmail.com>
>         *To : * "Uzzal"<uzzal at gist.ac.kr>,
>         "r-sig-geo"<r-sig-geo at r-project.org>
>         *Date : * 2015/08/26 Wednesday PM 5:22:39
>         *Subject : * Re: [R-sig-Geo] How to plot multiple
>         semi-variogram from a single dataset efficiently in R?
>
>         Uzzal,
>         first of all, please always reply to the list as well. As I
>         said, other people might have similar problems and will thus
>         be able to find a soultion in the mail archives.
>
>         If you run the code I gave you, you will see that it works.
>
>         The relevant bit is
>
>         layer(panel.text(x = 1000, y = 900, adj = c(0, 1),
>                              labels = dates[panel.number()]))
>
>         where the text gets plotted at x = 1000 and y = 900. In your
>         case, y = 900 is beyond the limits of the y-scale.
>
>         Replacing the above with this should fix it:
>
>         layer(grid.text(x = unit(0.1, "npc"),
>                             y = unit(0.9, "npc"),
>                             just = c("left", "top"),
>                             label = dates[panel.number()]))
>
>         This will use normalised x and y scales ranging from 0 to 1 no
>         matter what the absolute units are.
>
>         HTH
>         Tim
>
>         On 26.08.2015 10:12, Uzzal wrote:
>>
>>         Oh really! But I got plot like this(Attached)!
>>
>>         Uzzal
>>
>>             --- Original Message ---
>>             *From : * "Tim Appelhans"<tim.appelhans at gmail.com>
>>             *To : * "Uzzal"<uzzal at gist.ac.kr>,
>>             "r-sig-geo"<r-sig-geo at r-project.org>
>>             *Date : * 2015/08/26 Wednesday PM 4:41:28
>>             *Subject : * Re: [R-sig-Geo] How to plot multiple
>>             semi-variogram from a single dataset efficiently in R?
>>
>>             Uzzal,
>>             it should show exactly that in the top left corner of
>>             each variogram. It does on my computer.
>>
>>             Also, I include R-si-geo again as other people might have
>>             similar problems.
>>
>>             Cheers
>>             Tim
>>
>>             On 26.08.2015 08:06, Uzzal wrote:
>>>             I am extreamly sorry for my previous mail. Now its
>>>             working.I forgot to loaded "latticeExtra" package.
>>>
>>>             The plots I got ,it all have individual names . But
>>>             every plot has 7 variogram.is it possible to naming each
>>>             variogram in each plot also like
>>>             "20120301","20120302",..........."201203007"?
>>>
>>>             Uzzal
>>>
>>>                 --- Original Message ---
>>>                 *From : * "Tim Appelhans"<tim.appelhans at gmail.com>
>>>                 *To : * "Uzzal"<uzzal at gist.ac.kr>
>>>                 *Date : * 2015/08/26 Wednesday AM 1:14:25
>>>                 *Subject : * Re: [R-sig-Geo] How to plot multiple
>>>                 semi-variogram from a single dataset efficiently in R?
>>>
>>>                 How's this:
>>>
>>>                 ### in order to use latticeCombineGrid() you need to
>>>                 use ##################
>>>                 ### library(devtools) to install library(Rsenal)
>>>                 ##########################
>>>                 # install.packages(devtools)
>>>                 # library(devtools)
>>>                 #
>>>                 install_github("environmentalinformatics-marburg/Rsenal")
>>>                 ###########################################################################
>>>
>>>                 library(sp)
>>>                 library(gstat)
>>>                 library(rgdal)
>>>                 library(automap)
>>>                 library(Rsenal)
>>>                 library(latticeExtra)
>>>
>>>                 seoul311 <- read.csv("Downloads/seoul1to7.csv")
>>>                 seoul311 <- na.omit(seoul311)
>>>
>>>                 ### first we split seoul311 by time into a list
>>>                 rather than subsetting manually
>>>                 seoul311_splt <- split(seoul311, seoul311$time)
>>>
>>>                 ### now we loop (using lapply()) over each
>>>                 seoul311_splt entry and calculate
>>>                 ### variogram using autofitVariogram and return the
>>>                 variogram plot
>>>                 vars <- lapply(seq(seoul311_splt), function(i) {
>>>
>>>                   dat <- seoul311_splt[[i]]
>>>                   coordinates(dat) <- ~LON+LAT
>>>                   proj4string(dat) <- "+proj=longlat +datum=WGS84"
>>>                   dat <- spTransform(dat, CRS("+proj=utm +north
>>>                 +zone=52 +datum=WGS84"))
>>>
>>>                   variogram <- autofitVariogram(PM10 ~ 1, dat)
>>>
>>>                   plt <- plot(variogram, plotit = FALSE, asp = 1)
>>>
>>>                   ### in case you do not want to fix xlim and ylim
>>>                 to be identical
>>>                   ### for each plot just comment out the following
>>>                 line or change
>>>                   ### values as you see fit
>>>                   plt <- update(plt, xlim = c(-1000, 45000), ylim =
>>>                 c(0, 1000))
>>>
>>>                   return(plt)
>>>                 })
>>>
>>>                 ### now we actually have 23 * 7 variogram plots
>>>                 which we will combine
>>>                 ### into 23 hourly plots using latticeCombineGrid()
>>>                 hrs <- substr(names(seoul311_splt), 9, 10)
>>>                 dates <- unique(substr(names(seoul311_splt), 1, 8))
>>>                 hrs_unique <- unique(substr(names(seoul311_splt), 9,
>>>                 10))
>>>
>>>                 plts_hrs <- lapply(seq(unique(hrs)), function(j) {
>>>
>>>                   indx <- hrs %in% unique(hrs)[j]
>>>                   hr_plt <- vars[indx]
>>>
>>>                   fin_plt <- latticeCombineGrid(hr_plt, layout =
>>>                 c(3, 3)) +
>>>                     layer(panel.text(x = 1000, y = 900, adj = c(0, 1),
>>>                 labels = dates[panel.number()]))
>>>
>>>                   fin_plt <- update(fin_plt, main = paste("Variogram
>>>                 for hour", hrs_unique[j]))
>>>
>>>                   return(fin_plt)
>>>
>>>                 })
>>>
>>>                 ### save each plot as .png
>>>                 ### NOTE: latttice plots need to be print()ed!!!
>>>                 for (i in seq(hrs_unique)) {
>>>                 png(paste0("plot_hr_", hrs_unique[i], ".png"),
>>>                       width = 25, height = 25, units = "cm", res = 300)
>>>                   print(plts_hrs[[i]])
>>>                   dev.off()
>>>                 }
>>>
>>>
>>>                 Is this what you need?
>>>
>>>                 Best
>>>                 Tim
>>>
>>>                 On 25.08.2015 06:19, Uzzal wrote:
>>>>
>>>>                 Hello Tim, How about your last weekend? By the way,
>>>>                 you told me to make you remember about my last
>>>>                 problem. Good day.
>>>>
>>>>                 Uzzal
>>>>
>>>>                     --- Original Message ---
>>>>                     *From : * "Tim Appelhans"<tim.appelhans at gmail.com>
>>>>                     *To : * "Uzzal"<uzzal at gist.ac.kr>
>>>>                     *Date : * 2015/08/19 Wednesday PM 7:21:54
>>>>                     *Subject : * Re: [R-sig-Geo] How to plot
>>>>                     multiple semi-variogram from a single dataset
>>>>                     efficiently in R?
>>>>
>>>>                     Uzzal,
>>>>                     this is surely possible. I will be on holidays
>>>>                     until next week so will not get back to you
>>>>                     before then.
>>>>                     If you haven't heard from me by the end of next
>>>>                     week, please send me a reminder email as I will
>>>>                     most likely have gotten crried away with other
>>>>                     things.
>>>>
>>>>                     Cheers
>>>>                     Tim
>>>>
>>>>                     On 18.08.2015 19:03, Uzzal wrote:
>>>>>
>>>>>                     Dear Tim, Thank you so much for your quick
>>>>>                     response. It helped me a lot. I can't resist
>>>>>                     myself to ask you my another query related to
>>>>>                     this. I don't know, If you mind then please
>>>>>                     tell me, I will ask in another email:
>>>>>
>>>>>                     My another query:
>>>>>                     According to your coad,
>>>>>
>>>>>
>>>>>                     plts_hrs[[1]]
>>>>>                         .
>>>>>                         .
>>>>>                     plts_hrs[[23]] give me the 23 plots
>>>>>                     individually with same title. If I want those
>>>>>                     23 plots _with different title(also individual
>>>>>                     name of variogram in a plot)_
>>>>>
>>>>>                      by a single loop and those plots will be
>>>>>                     automatically saved in a folder, Is it
>>>>>                     possible in R?
>>>>>
>>>>>                     For example, First plot title would be
>>>>>                     "Variogram for 1.00 a.m
>>>>>
>>>>>                     And the 7 variograms title in the first plot
>>>>>                     would be like 1 march , 2.00 march....7 march.
>>>>>
>>>>>                     Actually I am new in R and weak in loop operation.
>>>>>
>>>>>                     I tried to do it with dev.off () command. But
>>>>>                     I didn't get success.
>>>>>                     Could you please help me? Thanks a lot again.
>>>>>
>>>>>                     Orpheus
>>>>>
>>>>>                         --- Original Message ---
>>>>>                         *From : * "Tim
>>>>>                         Appelhans"<tim.appelhans at gmail.com>
>>>>>                         *To : * r-sig-geo at r-project.org
>>>>>                         *Cc : * uzzal at gist.ac.kr
>>>>>                         *Date : * 2015/08/17 Monday PM 6:49:00
>>>>>                         *Subject : * Re: [R-sig-Geo] How to plot
>>>>>                         multiple semi-variogram from a single
>>>>>                         dataset efficiently in R?
>>>>>
>>>>>                         Orpheus,
>>>>>                         here's one option to get what you want.
>>>>>                         The problem with fitting that many
>>>>>                         variograms is that if you want to specify
>>>>>                         each variogram individually (i.e. nugget,
>>>>>                         range, model etc.), there is no way to
>>>>>                         automate this with loops or thelike.
>>>>>                         You can, however, use library(automap) to
>>>>>                         automatically fit a variogram to your
>>>>>                         data. Then a possible solution could look
>>>>>                         like this:
>>>>>
>>>>>
>>>>>                         ### in order to use latticeCombineGrid()
>>>>>                         you need to use ##################
>>>>>                         ### library(devtools) to install
>>>>>                         library(Rsenal) ##########################
>>>>>                         # install.packages(devtools)
>>>>>                         # library(devtools)
>>>>>                         #
>>>>>                         install_github("environmentalinformatics-marburg/Rsenal")
>>>>>                         ###########################################################################
>>>>>
>>>>>                         library(sp)
>>>>>                         library(gstat)
>>>>>                         library(rgdal)
>>>>>                         library(automap)
>>>>>                         library(Rsenal)
>>>>>
>>>>>                         seoul311 <-
>>>>>                         read.csv("Downloads/seoul1to7.csv")
>>>>>                         seoul311 <- na.omit(seoul311)
>>>>>
>>>>>                         ### first we split seoul311 by time into a
>>>>>                         list rather than subsetting manually
>>>>>                         seoul311_splt <- split(seoul311,
>>>>>                         seoul311$time)
>>>>>
>>>>>                         ### now we loop (using lapply()) over each
>>>>>                         seoul311_splt entry and calculate
>>>>>                         ### variogram using autofitVariogram and
>>>>>                         return the variogram plot
>>>>>                         vars <- lapply(seq(seoul311_splt),
>>>>>                         function(i) {
>>>>>
>>>>>                           dat <- seoul311_splt[[i]]
>>>>>                         coordinates(dat) <- ~LON+LAT
>>>>>                         proj4string(dat) <- "+proj=longlat
>>>>>                         +datum=WGS84"
>>>>>                           dat <- spTransform(dat, CRS("+proj=utm
>>>>>                         +north +zone=52 +datum=WGS84"))
>>>>>
>>>>>                           variogram <- autofitVariogram(PM10 ~ 1, dat)
>>>>>
>>>>>                           plt <- plot(variogram, plotit = FALSE,
>>>>>                         asp = 1)
>>>>>
>>>>>                           ### in case you do not want to fix xlim
>>>>>                         and ylim to be identical
>>>>>                           ### for each plot just comment out the
>>>>>                         following line or change
>>>>>                           ### values as you see fit
>>>>>                           plt <- update(plt, xlim = c(-1000,
>>>>>                         45000), ylim = c(0, 1000))
>>>>>
>>>>>                           return(plt)
>>>>>                         })
>>>>>
>>>>>                         ### now we actually have 23 * 7 variogram
>>>>>                         plots which we will combine
>>>>>                         ### into 23 hourly plots using
>>>>>                         latticeCombineGrid()
>>>>>                         hrs <- substr(names(seoul311_splt), 9, 10)
>>>>>
>>>>>                         plts_hrs <- lapply(seq(unique(hrs)),
>>>>>                         function(j) {
>>>>>
>>>>>                           indx <- hrs %in% unique(hrs)[j]
>>>>>                           hr_plt <- vars[indx]
>>>>>
>>>>>                         return(latticeCombineGrid(hr_plt, layout =
>>>>>                         c(3, 3)))
>>>>>
>>>>>                         })
>>>>>
>>>>>                         ### plot for hour 1
>>>>>                         plts_hrs[[1]]
>>>>>
>>>>>                         ### plot for hour 23
>>>>>                         plts_hrs[[23]]
>>>>>
>>>>>                         ### ...
>>>>>
>>>>>
>>>>>                         HTH
>>>>>
>>>>>                         Best,
>>>>>                         Tim
>>>>>
>>>>>
>>>>>                         On 17.08.2015 09:43, Uzzal wrote:
>>>>>>                         Actually I asked this same question to
>>>>>>                         some other forum but unfortunate I didn't
>>>>>>                         get the appropriate response. But I am
>>>>>>                         kind of struck with this problem. I am
>>>>>>                         giving the link of my problem previously
>>>>>>                         posted in other forum: (really sorry for
>>>>>>                         that)
>>>>>>                         http://stackoverflow.com/questions/31762461/how-to-plot-multiple-semi-variogram-from-a-single-dataset-efficiently-in-r?noredirect=1#comment51767989_31762461
>>>>>>
>>>>>>                         I want variogram time wise. For example,
>>>>>>                         thevariogram for 1.00 am of 1 march to 7
>>>>>>                         march in one plot. That means 7
>>>>>>                         variograms in one plot. in such a way
>>>>>>                         there will be 23 plot contains (23*7)
>>>>>>                         variogram. Thanks in adv! ance.
>>>>>>
>>>>>>                         Orpheus
>>>>>>
>>>>>>
>>>>>>
>>>>>>                         Uzzal Kumar Dash
>>>>>>                         Master's student
>>>>>>                         Air Quality & Climate Modeling Laboratory
>>>>>>                         (AqCliMB)
>>>>>>                         School of Environmental Science and
>>>>>>                         Engineering (SESE)
>>>>>>                         Gwangju Institute of Science and
>>>>>>                         Technology (GIST)
>>>>>>                         123 Cheomdan-gwagiro, Buk-gu, Gwangju 500-712
>>>>>>                         Republic of Korea
>>>>>>
>>>>>>                         web: http://aqclimb.gist.ac.kr/
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>                         _______________________________________________
>>>>>>                         R-sig-Geo mailing list
>>>>>>                         R-sig-Geo at r-project.org
>>>>>>                         https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>
>>>>>                         -- 
>>>>>                         #####################################
>>>>>                         Tim Appelhans
>>>>>                         Department of Geography
>>>>>                         Environmental Informatics
>>>>>                         Philipps Universit?t Marburg
>>>>>                         Deutschhausstra?e 12
>>>>>                         35032 Marburg (Paketpost: 35037 Marburg)
>>>>>                         Germany
>>>>>
>>>>>                         Tel +49 (0) 6421 28-25957
>>>>>
>>>>>                         http://environmentalinformatics-marburg.de/
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>                     Uzzal Kumar Dash
>>>>>                     Master's student
>>>>>                     Air Quality & Climate Modeling Laboratory
>>>>>                     (AqCliMB)
>>>>>                     School of Environmental Science and
>>>>>                     Engineering (SESE)
>>>>>                     Gwangju Institute of Science and Technology (GIST)
>>>>>                     123 Cheomdan-gwagiro, Buk-gu, Gwangju 500-712
>>>>>                     Republic of Korea
>>>>>
>>>>>                     web: http://aqclimb.gist.ac.kr/
>>>>>
>>>>>
>>>>
>>>>                     -- 
>>>>                     #####################################
>>>>                     Tim Appelhans
>>>>                     Department of Geography
>>>>                     Environmental Informatics
>>>>                     Philipps Universit?t Marburg
>>>>                     Deutschhausstra?e 12
>>>>                     35032 Marburg (Paketpost: 35037 Marburg)
>>>>                     Germany
>>>>
>>>>                     Tel +49 (0) 6421 28-25957
>>>>
>>>>                     http://environmentalinformatics-marburg.de/
>>>>
>>>>
>>>>
>>>>
>>>>                 Uzzal Kumar Dash
>>>>                 Master's student
>>>>                 Air Quality & Climate Modeling Laboratory (AqCliMB)
>>>>                 School of Environmental Science and Engineering (SESE)
>>>>                 Gwangju Institute of Science and Technology (GIST)
>>>>                 123 Cheomdan-gwagiro, Buk-gu, Gwangju 500-712
>>>>                 Republic of Korea
>>>>
>>>>                 web: http://aqclimb.gist.ac.kr/
>>>>
>>>>
>>>
>>>                 -- 
>>>                 #####################################
>>>                 Tim Appelhans
>>>                 Department of Geography
>>>                 Environmental Informatics
>>>                 Philipps Universit?t Marburg
>>>                 Deutschhausstra?e 12
>>>                 35032 Marburg (Paketpost: 35037 Marburg)
>>>                 Germany
>>>
>>>                 Tel +49 (0) 6421 28-25957
>>>
>>>                 http://environmentalinformatics-marburg.de/
>>>
>>>
>>>
>>>
>>>
>>>
>>
>>             -- 
>>             #####################################
>>             Tim Appelhans
>>             Department of Geography
>>             Environmental Informatics
>>             Philipps Universit?t Marburg
>>             Deutschhausstra?e 12
>>             35032 Marburg (Paketpost: 35037 Marburg)
>>             Germany
>>
>>             Tel +49 (0) 6421 28-25957
>>
>>             http://environmentalinformatics-marburg.de/
>>
>>
>>
>>
>>
>>
>
>         -- 
>         #####################################
>         Tim Appelhans
>         Department of Geography
>         Environmental Informatics
>         Philipps Universit?t Marburg
>         Deutschhausstra?e 12
>         35032 Marburg (Paketpost: 35037 Marburg)
>         Germany
>
>         Tel +49 (0) 6421 28-25957
>
>         http://environmentalinformatics-marburg.de/
>
>
>
>
>
>
>
>
>
>
>

-- 
#####################################
Tim Appelhans
Department of Geography
Environmental Informatics
Philipps Universit?t Marburg
Deutschhausstra?e 12
35032 Marburg (Paketpost: 35037 Marburg)
Germany

Tel +49 (0) 6421 28-25957

http://environmentalinformatics-marburg.de/


	[[alternative HTML version deleted]]


From uzzal at gist.ac.kr  Thu Aug 27 12:50:38 2015
From: uzzal at gist.ac.kr (Uzzal)
Date: Thu, 27 Aug 2015 19:50:38 +0900 (KST)
Subject: [R-sig-Geo] How to plot multiple semi-variogram from a single
	dataset efficiently in R?
Message-ID: <891055092.1440672638641.JavaMail.root@eunhasu>

Dear Tim, after getting lots of help from you, I was trying to plot all variogram in different plot with different name (1 variogram per plot). I was trying to naming those variogram like "variogram for 20120301 01:00", "variogram for 20120301 02:00".......etc. I improvised your code in the following way (below) but didn't get success! Is it possible to plot different variogram in different plot with different name  and save it in a single loop?  Thanks a lot for your valuable time.

a vars Uzzal 




-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150827/9bf4d5aa/attachment.html>

From michael.koehler at nw-fva.de  Thu Aug 27 14:54:47 2015
From: michael.koehler at nw-fva.de (Michael Koehler)
Date: Thu, 27 Aug 2015 14:54:47 +0200
Subject: [R-sig-Geo] passing levels to predict::raster
Message-ID: <55DF0897.1000403@nw-fva.de>

|Dear List, I want to predict a model a rasterstack that includes 
categorical data. The outcome is all NA. However, converting the same 
rasterstack/brick to a dataframe and pedict the model gives proper 
results. What am I doing wrong  with passing the levels to 
predict::raster? ||Here is an example: 
library(raster)library(rasterVis)library(randomForest)# make a 
rasterset.seed(0)r 
<-raster(nrow=10,ncol=10)r[]<-runif(ncell(r))*10is.factor(r)r 
<-round(r)# make faktorf <-as.factor(r)is.factor(f)# get some none-sense 
levelsx <-levels(f)[[1]]x$code <-paste("A",letters[10:20])x$code2 
<-paste("B",letters[10:20])x$code3 <-letters[10:20]levels(f)<-x 
f<-deratify(f)# make a bricklevels(f)set.seed(2)# get some none-sense 
dataframexx<-data.frame(code=sample(rep(paste("A",letters[10:20]),10)),code2=sample(rep(paste("B",letters[10:20]),10)),code3=rep(letters[10:20],10),y=as.factor(sample(rep(paste(rep(1:5)),22))))# 
fit and predict a random forest with 
itranfor<-randomForest(y~.,data=xx,ntree=100)predict(ranfor)# try to 
predict with a 
rasternames(f)<-c("code","code2","code3")a<-predict(object=f,ranfor,na.omit=T,factors=list(code=levels(xx$code),code2=levels(xx$code2),code3=levels(xx$code3)))plot(a)# 
gives an empty raster# convert the raster to a dataframe and predict 
againx<-as.data.frame(f)names(x)<-c("code","code2","code3")aa<-predict(ranfor,x)plot(aa)# 
works just fine! |
|#R version 3.1.2(2014-10-31)Platform:x86_64-w64-mingw32/x64 (64-bit) |I was asking that also here:
http://stackoverflow.com/questions/31477064/passing-levels-to-predict-randomforest-with-a-raster
But I did not get a response.


-- 
Michael Kohler



	[[alternative HTML version deleted]]


From Andy.Bunn at wwu.edu  Thu Aug 27 20:28:36 2015
From: Andy.Bunn at wwu.edu (Andy Bunn)
Date: Thu, 27 Aug 2015 18:28:36 +0000
Subject: [R-sig-Geo] Warning on projection (.getCRSfromGridMap4) from netcdf
	to brick
Message-ID: <D204A4DF.3E608%andy.bunn@wwu.edu>

Hello. I'm using data out of a netcdf object from here:
http://cida.usgs.gov/thredds/ncss/CA-BCM-2014/historical/dataset.html

The metadata has the projection info as:
#  <coordTransform name="albers_conical_equal_area"
transformType="Projection">
#  <parameter name="grid_mapping_name" value="albers_conical_equal_area"/>
#  <parameter name="latitude_of_projection_origin" value="0.0 "/>
#  <parameter name="longitude_of_central_meridian" value="-120.0 "/>
#  <parameter name="standard_parallel" value="34.0 40.5 "/>
#  <parameter name="false_easting" value="0.0 "/>
#  <parameter name="false_northing" value="-4000.0 "/>
#  <parameter name="units" value="km"/>
#  <parameter name="semi_major_axis" value="6378137.0 "/>
#  <parameter name="inverse_flattening" value="298.257222101 "/>
#  </coordTransform>

I can load the data fine using raster::brick but I'm having a warning
about the projection info that I don't understand:

R> fname <- "csl_cwd_pet_test.nc"
R> petBrick <- brick(fname,varname="HST_Monthly_pet")
Warning message:
In .getCRSfromGridMap4(atts) : cannot process these parts of the CRS:
spatial_ref=PROJCS["unnamed",GEOGCS["NAD83",DATUM["North_American_Datum_198
3",SPHEROID["GRS
1980",6378137,298.257222101,AUTHORITY["EPSG","7019"]],TOWGS84[0,0,0,0,0,0,0
],AUTHORITY["EPSG","6269"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],
UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9108"]],AUTHORITY["EPSG"
,"4269"]],PROJECTION["Albers_Conic_Equal_Area"],PARAMETER["standard_paralle
l_1",34],PARAMETER["standard_parallel_2",40.5],PARAMETER["latitude_of_cente
r",0],PARAMETER["longitude_of_center",-120],PARAMETER["false_easting",0],PA
RAMETER["false_northing",-4000000],UNIT["Meter",1]];
GeoTransform=-374495.83635354 270 0 592636.6658113 0 -270 ;
_CoordinateTransformType=Projection; _CoordinateAxisTypes=GeoX GeoY
R> proj4string(petBrick)
[1] "+proj=aea +x_0=0 +y_0=-4000 +lat_0=0 +lon_0=-120 +a=6378137
+rf=298.257222101 +lat_1=34 +lat_2=40.5"
R>




It looks to me like the projection parameters are FUBAR'd. Should I set
the CRS by hand?

Advice appreciated.

-Andy


From timjp at unimelb.edu.au  Fri Aug 28 05:06:06 2015
From: timjp at unimelb.edu.au (Tim Peterson)
Date: Fri, 28 Aug 2015 13:06:06 +1000
Subject: [R-sig-Geo] Factorial kriging in GStat - tips for
	implementation?
In-Reply-To: <55DEB07D.9030306@uni-muenster.de>
References: <55DE5E73.1020007@unimelb.edu.au>
	<55DEB07D.9030306@uni-muenster.de>
Message-ID: <55DFD01E.8020806@unimelb.edu.au>

Thanks Edzer. Good to hear that I seem to be looking at the correct part 
of the code. And, I agree that the implementation must be simple and the 
code changes clear.  The best approach I can see for this is to add an 
option to the 'set' input for krige() that specifies the variogram 
number that is to be used for the calculation of the right hand C0.

On 27/08/15 16:38, Edzer Pebesma wrote:
> On 08/27/2015 02:48 AM, Tim Peterson wrote:
>> Hi all,
>>
>> I'm looking to undertake factorial colocated cokriging with GStat but
>> factorial kriging does not appear to be an available option in GStat (eg
>> help.search("factorial kriging") ). There was a post in 2007 requesting
>> this feature (http://marc.info/?l=r-sig-geo&m=119810046000747) and a
>> proposed approach in 2000
>> (https://www.mail-archive.com/gstat-info at geog.uu.nl/msg00045.html) but
>> no updates since. As far as I can tell, the required changes would be to
>> 'gls.c' lines 412-423, specifically the call to GCV0 for calculating C0
>> (right-hand side of the kriging matrix) should be edited so that only
>> the covariance for the required factor is calculated.
> Not being an expert in factorial kriging, I also think that this is what
> is needed. A challenge may be to make the implementation simple and
> clean, both from the perspective of the user as well as from the code
> maintainer.
>
> If the only goal is to suppress the nugget effect, as the poster in your
> first link mentions, try replacing a "Nug" variogram model with an "Err"
> variogram model.
Also, I need factorial kriging for estimating only the large scale 
effect (ie the longer range variogram for the primary variable from a 
set of >=2 variograms). This is for the eventual use to undertake 
indicator simulations for a highly non-stationary  (first order) system, 
specifically basin scale water table elevation.
>> Anyway, before I consider adding this feature to GStat, I'd be grateful
>> if anyone could share tips or thoughts. Lastly, any changes I make will
>> (of course) be freely shared.
>>
>> Many thanks,
>>
>> Tim
>>
>> ----------------------
>> Dr. Tim Peterson
>>
>> The Department of Infrastructure Engineering
>> The University of Melbourne, 3010 Australia
>> T: +61 3 8344 9950, M: +61 0438 385 937
>>
>> Dept. profile :
>> http://www.ie.unimelb.edu.au/people/staff.php?person_ID=141135
>> Research Gate :https://www.researchgate.net/profile/Tim_Peterson7
>> Google Scholar:
>> http://scholar.google.com.au/citations?user=kkYJLF4AAAAJ&hl=en&oi=ao
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


	[[alternative HTML version deleted]]


From timjp at unimelb.edu.au  Fri Aug 28 05:15:47 2015
From: timjp at unimelb.edu.au (Tim Peterson)
Date: Fri, 28 Aug 2015 13:15:47 +1000
Subject: [R-sig-Geo] GStat 'predict.c' parallel estimation
In-Reply-To: <55DEB47A.3020901@uni-muenster.de>
References: <55DE5D9D.40106@unimelb.edu.au> <55DEB47A.3020901@uni-muenster.de>
Message-ID: <55DFD263.9070508@unimelb.edu.au>


On 27/08/15 16:55, Edzer Pebesma wrote:
>
> On 08/27/2015 02:45 AM, Tim Peterson wrote:
>>
>> Hi all,
>>
>> I'm considering editing the GStat kriging file 'predict.c' (while loop
>> at line 151-165) for parallel estimation. I require parallel estimation
>> for both kriging and indicator simulation and will be applying it to a
>> region of ~30 million grid cells, which will be repeated for 300 time
>> points.
>>
>> I appreciate that snow can be used for parallel kriging
>> (https://r-forge.r-project.org/scm/viewvc.php/pkg/demo/snow.R?view=markup&revision=89&root=gstat)
>> but, because of my computation burden, I require parallel calculation
>> using Xeon Phi cards - hence I think the changes should be in
>> 'predict.c'. Also, in looking at the GStat C-code I suspect that the
>> global variables in 'glvars.c' may complicate the parallel calculations.
>> So anyway, before I embark upon this task (most likely using openMP),
>> I'd be grateful if anyone could share tips or thoughts (and my edits
>> will be freely shared.)
> I've always thought of these global variables as being constant during
> program execution. R being non-thread safe, I'm not sure how well R
> combines with embedded C code that uses threads.
Thanks again Edzer. That's good to know about the global variables. Re 
the threaded C code working with R, my understanding was that the while 
loop undertaking the estimation is not interacting with R and so can be 
made parallel without (hopefully) influencing R. Does this sound reasonable?
>
>> Also, some may be questioning the parallel estimation of each
>> simulation. Considering that I'm estimating ~30 million cells, and will
>> only be using ~70 cores per simulation, I am happy to accept the
>> deficiency that recently estimated cells will not be used in the
>> estimation of nearby cells within a concurrent parallel cycle. However,
>> the estimates do need to be accessible to latter parallel cycles.
> I can see that a shared memory approach could mess up the set of
> previously simulated values ("msim" in msim.c), and that filling in
> locally could be done in independent threads; yet, what do you do at the
> boundaries of these regions?
To clarify, the best approach I see for simulations is to randomly 
select, say, 10*"number of cores"  grid cells and undertake their 
parallel estimation. These solutions are then added back into the "msim" 
and another 10*"number of cores" grid cells are then selected and 
estimated. This would overcome the boundary effects but would mean that 
the cores may not be running at 100% all of the  time (ie all 10*"number 
of cores" cells would need to finish before the next batch could start)
> As an alternative to this approach (and the one you sketch below) you
> could think about a circulant embedding algorithm that uses a parallel
> version of the fft; see fields:sim.rf and the routines in package
> RandomFields.
Thanks. I didn't know about circulant embedding. However, my problem is 
high non-bi-Gaussian. The extreme values within the system (which is 
water table elevation) are significantly more correlated than 'average' 
values.
>
>> Lastly, my backup option is to use openMP to parallelise the GSLib
>> Fortran subroutines 'cokb3d.for' and 'sisim.for' (ie outside of R). This
>> is mainly because the subroutines are fairly standalone and don't use
>> pointers - and hence possibly less problematic to make parallel.
>>
>> Many thanks,
>>
>> Tim
>>
>> ----------------------
>> Dr. Tim Peterson
>>
>> The Department of Infrastructure Engineering
>> The University of Melbourne, 3010 Australia
>> T: +61 3 8344 9950, M: +61 0438 385 937
>>
>> Dept. profile :
>> http://www.ie.unimelb.edu.au/people/staff.php?person_ID=141135
>> Research Gate : https://www.researchgate.net/profile/Tim_Peterson7
>> Google Scholar:
>> http://scholar.google.com.au/citations?user=kkYJLF4AAAAJ&hl=en&oi=ao
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From edzer.pebesma at uni-muenster.de  Fri Aug 28 09:45:17 2015
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 28 Aug 2015 09:45:17 +0200
Subject: [R-sig-Geo] GStat 'predict.c' parallel estimation
In-Reply-To: <55DFD263.9070508@unimelb.edu.au>
References: <55DE5D9D.40106@unimelb.edu.au> <55DEB47A.3020901@uni-muenster.de>
	<55DFD263.9070508@unimelb.edu.au>
Message-ID: <55E0118D.7050406@uni-muenster.de>



On 08/28/2015 05:15 AM, Tim Peterson wrote:
> 
> On 27/08/15 16:55, Edzer Pebesma wrote:
>>
>> On 08/27/2015 02:45 AM, Tim Peterson wrote:
>>>
>>> Hi all,
>>>
>>> I'm considering editing the GStat kriging file 'predict.c' (while loop
>>> at line 151-165) for parallel estimation. I require parallel estimation
>>> for both kriging and indicator simulation and will be applying it to a
>>> region of ~30 million grid cells, which will be repeated for 300 time
>>> points.
>>>
>>> I appreciate that snow can be used for parallel kriging
>>> (https://r-forge.r-project.org/scm/viewvc.php/pkg/demo/snow.R?view=markup&revision=89&root=gstat)
>>>
>>> but, because of my computation burden, I require parallel calculation
>>> using Xeon Phi cards - hence I think the changes should be in
>>> 'predict.c'. Also, in looking at the GStat C-code I suspect that the
>>> global variables in 'glvars.c' may complicate the parallel calculations.
>>> So anyway, before I embark upon this task (most likely using openMP),
>>> I'd be grateful if anyone could share tips or thoughts (and my edits
>>> will be freely shared.)
>> I've always thought of these global variables as being constant during
>> program execution. R being non-thread safe, I'm not sure how well R
>> combines with embedded C code that uses threads.
> Thanks again Edzer. That's good to know about the global variables. Re
> the threaded C code working with R, my understanding was that the while
> loop undertaking the estimation is not interacting with R and so can be
> made parallel without (hopefully) influencing R. Does this sound
> reasonable?

Be careful: print_progress is called in the iteration over prediction
locations, and calls Rprintf(), not only to print progress, but also to
allow user interrupts; these need to be surpressed (can be done in
runtime, I believe). There are some R_CheckUserInterrupt()s, but not in
the prediction code.

>>
>>> Also, some may be questioning the parallel estimation of each
>>> simulation. Considering that I'm estimating ~30 million cells, and will
>>> only be using ~70 cores per simulation, I am happy to accept the
>>> deficiency that recently estimated cells will not be used in the
>>> estimation of nearby cells within a concurrent parallel cycle. However,
>>> the estimates do need to be accessible to latter parallel cycles.
>> I can see that a shared memory approach could mess up the set of
>> previously simulated values ("msim" in msim.c), and that filling in
>> locally could be done in independent threads; yet, what do you do at the
>> boundaries of these regions?
> To clarify, the best approach I see for simulations is to randomly
> select, say, 10*"number of cores"  grid cells and undertake their
> parallel estimation. These solutions are then added back into the "msim"
> and another 10*"number of cores" grid cells are then selected and
> estimated. This would overcome the boundary effects but would mean that
> the cores may not be running at 100% all of the  time (ie all 10*"number
> of cores" cells would need to finish before the next batch could start)

I think that could work pretty well. Not only adding to msim, also
updating the search tree would have to be done in a single-threaded
synchronization event.

>> As an alternative to this approach (and the one you sketch below) you
>> could think about a circulant embedding algorithm that uses a parallel
>> version of the fft; see fields:sim.rf and the routines in package
>> RandomFields.
> Thanks. I didn't know about circulant embedding. However, my problem is
> high non-bi-Gaussian. The extreme values within the system (which is
> water table elevation) are significantly more correlated than 'average'
> values.
>>
>>> Lastly, my backup option is to use openMP to parallelise the GSLib
>>> Fortran subroutines 'cokb3d.for' and 'sisim.for' (ie outside of R). This
>>> is mainly because the subroutines are fairly standalone and don't use
>>> pointers - and hence possibly less problematic to make parallel.
>>>
>>> Many thanks,
>>>
>>> Tim
>>>
>>> ----------------------
>>> Dr. Tim Peterson
>>>
>>> The Department of Infrastructure Engineering
>>> The University of Melbourne, 3010 Australia
>>> T: +61 3 8344 9950, M: +61 0438 385 937
>>>
>>> Dept. profile :
>>> http://www.ie.unimelb.edu.au/people/staff.php?person_ID=141135
>>> Research Gate : https://www.researchgate.net/profile/Tim_Peterson7
>>> Google Scholar:
>>> http://scholar.google.com.au/citations?user=kkYJLF4AAAAJ&hl=en&oi=ao
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi),  University of M?nster,
Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
Journal of Statistical Software:   http://www.jstatsoft.org/
Computers & Geosciences:   http://elsevier.com/locate/cageo/
Spatial Statistics Society http://www.spatialstatistics.info

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150828/897f0e37/attachment.bin>

From btupper at bigelow.org  Fri Aug 28 16:33:17 2015
From: btupper at bigelow.org (Ben Tupper)
Date: Fri, 28 Aug 2015 10:33:17 -0400
Subject: [R-sig-Geo] sp and latticeExtra: add colorbar for layer drawn
	'under'
Message-ID: <0B67D297-87E4-4177-B4DF-D10355EA31B3@bigelow.org>

Hello,

I have drawn on the following posting to draw a raster 'under' a set of polygons as shown in the image link below.  The data used is available at the third link (about 650KB).

Posting: http://stackoverflow.com/questions/27062768/how-to-plot-additional-raster-with-spplot

Image: https://dl.dropboxusercontent.com/u/8433654/sp-over-plot.png

Example data: https://dl.dropboxusercontent.com/u/8433654/example.RData

Here is a brief description of each variable plotted.

R is a single layer RasterStack of sea surface temperatures
qa is a SpatialPolygonsDataFrame of fisheries management polygons
spdfbb is also a SpatialPolygonsDataFrame that contains a single polygon (created from the extent of qa)

sp::spplot(spdfbb, 
   colorkey = FALSE,
   sp.layout = list(b = list('sp.polygons', qa, col = 'grey', first = FALSE))) + 
   latticeExtra::as.layer(spplot(R), under = TRUE)

Is it possible add a colorbar for the raster, R, as it might appear if I called...

spplot(R)

Session info is below my signature.

Thanks!
Ben

Ben Tupper
Bigelow Laboratory for Ocean Sciences
60 Bigelow Drive, P.O. Box 380
East Boothbay, Maine 04544
http://www.bigelow.org

> sessionInfo()
R version 3.2.2 (2015-08-14)
Platform: x86_64-apple-darwin13.4.0 (64-bit)
Running under: OS X 10.9.5 (Mavericks)

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] latticeExtra_0.6-26 lattice_0.20-33     rgeos_0.3-8         obpgcrawler_0.1     ecocastmap_0.1     
 [6] RColorBrewer_1.1-2  ggplot2_1.0.1       rgdal_0.9-3         spnc_0.1            raster_2.4-15      
[11] sp_1.1-1           

loaded via a namespace (and not attached):
 [1] Rcpp_0.12.0      magrittr_1.5     MASS_7.3-43      munsell_0.4.2    colorspace_1.2-6 R6_2.1.1        
 [7] stringr_1.0.0    httr_1.0.0       plyr_1.8.3       tools_3.2.2      grid_3.2.2       gtable_0.1.2    
[13] digest_0.6.8     reshape2_1.4.1   ncdf4_1.13       curl_0.9.3       stringi_0.5-5    scales_0.2.5    
[19] XML_3.98-1.3     proto_0.3-10 

From tim.appelhans at gmail.com  Fri Aug 28 16:51:44 2015
From: tim.appelhans at gmail.com (Tim Appelhans)
Date: Fri, 28 Aug 2015 16:51:44 +0200
Subject: [R-sig-Geo] sp and latticeExtra: add colorbar for layer drawn
 'under'
In-Reply-To: <0B67D297-87E4-4177-B4DF-D10355EA31B3@bigelow.org>
References: <0B67D297-87E4-4177-B4DF-D10355EA31B3@bigelow.org>
Message-ID: <55E07580.1090707@gmail.com>

Ben,
you could specify the colorkey manually in the spplot call for spdfbb:

sp::spplot(spdfbb,
            colorkey = list(col = bpy.colors(101), width = 1,
                            at = seq(0, 30, length.out = 100),
                            space = "top"),
            sp.layout = list(b = list('sp.polygons', qa, col = 'grey', 
first = FALSE))) +
   latticeExtra::as.layer(spplot(R, at = seq(0, 30, length.out = 100)), 
under = TRUE)


You simply need to make sure to pass the same specs to the spplot call to R.

HTH
Tim

On 28.08.2015 16:33, Ben Tupper wrote:
> Hello,
>
> I have drawn on the following posting to draw a raster 'under' a set of polygons as shown in the image link below.  The data used is available at the third link (about 650KB).
>
> Posting: http://stackoverflow.com/questions/27062768/how-to-plot-additional-raster-with-spplot
>
> Image: https://dl.dropboxusercontent.com/u/8433654/sp-over-plot.png
>
> Example data: https://dl.dropboxusercontent.com/u/8433654/example.RData
>
> Here is a brief description of each variable plotted.
>
> R is a single layer RasterStack of sea surface temperatures
> qa is a SpatialPolygonsDataFrame of fisheries management polygons
> spdfbb is also a SpatialPolygonsDataFrame that contains a single polygon (created from the extent of qa)
>
> sp::spplot(spdfbb,
>     colorkey = FALSE,
>     sp.layout = list(b = list('sp.polygons', qa, col = 'grey', first = FALSE))) +
>     latticeExtra::as.layer(spplot(R), under = TRUE)
>
> Is it possible add a colorbar for the raster, R, as it might appear if I called...
>
> spplot(R)
>
> Session info is below my signature.
>
> Thanks!
> Ben
>
> Ben Tupper
> Bigelow Laboratory for Ocean Sciences
> 60 Bigelow Drive, P.O. Box 380
> East Boothbay, Maine 04544
> http://www.bigelow.org
>
>> sessionInfo()
> R version 3.2.2 (2015-08-14)
> Platform: x86_64-apple-darwin13.4.0 (64-bit)
> Running under: OS X 10.9.5 (Mavericks)
>
> locale:
> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
>   [1] latticeExtra_0.6-26 lattice_0.20-33     rgeos_0.3-8         obpgcrawler_0.1     ecocastmap_0.1
>   [6] RColorBrewer_1.1-2  ggplot2_1.0.1       rgdal_0.9-3         spnc_0.1            raster_2.4-15
> [11] sp_1.1-1
>
> loaded via a namespace (and not attached):
>   [1] Rcpp_0.12.0      magrittr_1.5     MASS_7.3-43      munsell_0.4.2    colorspace_1.2-6 R6_2.1.1
>   [7] stringr_1.0.0    httr_1.0.0       plyr_1.8.3       tools_3.2.2      grid_3.2.2       gtable_0.1.2
> [13] digest_0.6.8     reshape2_1.4.1   ncdf4_1.13       curl_0.9.3       stringi_0.5-5    scales_0.2.5
> [19] XML_3.98-1.3     proto_0.3-10
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
#####################################
Tim Appelhans
Department of Geography
Environmental Informatics
Philipps Universit?t Marburg
Deutschhausstra?e 12
35032 Marburg (Paketpost: 35037 Marburg)
Germany

Tel +49 (0) 6421 28-25957

http://environmentalinformatics-marburg.de/


From qiuhuanihao at gmail.com  Fri Aug 28 19:05:41 2015
From: qiuhuanihao at gmail.com (Qiuhua Ma)
Date: Fri, 28 Aug 2015 11:05:41 -0600
Subject: [R-sig-Geo] criterion for the best fitting model if using GMM?
Message-ID: <CACc7PKoiGmor53vQ1G-TKcdofROdxbom5++NOZXmCS-dZqJbpQ@mail.gmail.com>

Hi,

I have two big datasets:10,000 observations and 40,000.

I tried to use ML so that I can use maximized LL or AIC to decide the best
fitting model! However it took so long and most of the time R was turned
off automatically.

GMM seems like a better option. I searched the literature but cannot find
the criterion for the best fitting model. Any idea?

thanks,

Chelsea

	[[alternative HTML version deleted]]


From btupper at bigelow.org  Sat Aug 29 00:11:22 2015
From: btupper at bigelow.org (Ben Tupper)
Date: Fri, 28 Aug 2015 18:11:22 -0400
Subject: [R-sig-Geo] sp and latticeExtra: add colorbar for layer drawn
	'under'
In-Reply-To: <55E07580.1090707@gmail.com>
References: <0B67D297-87E4-4177-B4DF-D10355EA31B3@bigelow.org>
	<55E07580.1090707@gmail.com>
Message-ID: <5DF0D505-DFC2-4C13-8534-6360B8A47136@bigelow.org>

Hi,

Perfect!  I wouldn't have gotten there in a hundred years.  

Thanks,
Ben

On Aug 28, 2015, at 10:51 AM, Tim Appelhans <tim.appelhans at gmail.com> wrote:

> Ben,
> you could specify the colorkey manually in the spplot call for spdfbb:
> 
> sp::spplot(spdfbb,
>           colorkey = list(col = bpy.colors(101), width = 1,
>                           at = seq(0, 30, length.out = 100),
>                           space = "top"),
>           sp.layout = list(b = list('sp.polygons', qa, col = 'grey', first = FALSE))) +
>  latticeExtra::as.layer(spplot(R, at = seq(0, 30, length.out = 100)), under = TRUE)
> 
> 
> You simply need to make sure to pass the same specs to the spplot call to R.
> 
> HTH
> Tim
> 
> On 28.08.2015 16:33, Ben Tupper wrote:
>> Hello,
>> 
>> I have drawn on the following posting to draw a raster 'under' a set of polygons as shown in the image link below.  The data used is available at the third link (about 650KB).
>> 
>> Posting: http://stackoverflow.com/questions/27062768/how-to-plot-additional-raster-with-spplot
>> 
>> Image: https://dl.dropboxusercontent.com/u/8433654/sp-over-plot.png
>> 
>> Example data: https://dl.dropboxusercontent.com/u/8433654/example.RData
>> 
>> Here is a brief description of each variable plotted.
>> 
>> R is a single layer RasterStack of sea surface temperatures
>> qa is a SpatialPolygonsDataFrame of fisheries management polygons
>> spdfbb is also a SpatialPolygonsDataFrame that contains a single polygon (created from the extent of qa)
>> 
>> sp::spplot(spdfbb,
>>    colorkey = FALSE,
>>    sp.layout = list(b = list('sp.polygons', qa, col = 'grey', first = FALSE))) +
>>    latticeExtra::as.layer(spplot(R), under = TRUE)
>> 
>> Is it possible add a colorbar for the raster, R, as it might appear if I called...
>> 
>> spplot(R)
>> 
>> Session info is below my signature.
>> 
>> Thanks!
>> Ben
>> 
>> Ben Tupper
>> Bigelow Laboratory for Ocean Sciences
>> 60 Bigelow Drive, P.O. Box 380
>> East Boothbay, Maine 04544
>> http://www.bigelow.org
>> 
>>> sessionInfo()
>> R version 3.2.2 (2015-08-14)
>> Platform: x86_64-apple-darwin13.4.0 (64-bit)
>> Running under: OS X 10.9.5 (Mavericks)
>> 
>> locale:
>> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>> 
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>> 
>> other attached packages:
>>  [1] latticeExtra_0.6-26 lattice_0.20-33     rgeos_0.3-8         obpgcrawler_0.1     ecocastmap_0.1
>>  [6] RColorBrewer_1.1-2  ggplot2_1.0.1       rgdal_0.9-3         spnc_0.1            raster_2.4-15
>> [11] sp_1.1-1
>> 
>> loaded via a namespace (and not attached):
>>  [1] Rcpp_0.12.0      magrittr_1.5     MASS_7.3-43      munsell_0.4.2    colorspace_1.2-6 R6_2.1.1
>>  [7] stringr_1.0.0    httr_1.0.0       plyr_1.8.3       tools_3.2.2      grid_3.2.2       gtable_0.1.2
>> [13] digest_0.6.8     reshape2_1.4.1   ncdf4_1.13       curl_0.9.3       stringi_0.5-5    scales_0.2.5
>> [19] XML_3.98-1.3     proto_0.3-10
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> -- 
> #####################################
> Tim Appelhans
> Department of Geography
> Environmental Informatics
> Philipps Universit?t Marburg
> Deutschhausstra?e 12
> 35032 Marburg (Paketpost: 35037 Marburg)
> Germany
> 
> Tel +49 (0) 6421 28-25957
> 
> http://environmentalinformatics-marburg.de/
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



Ben Tupper
Bigelow Laboratory for Ocean Sciences
60 Bigelow Drive, P.O. Box 380
East Boothbay, Maine 04544
http://www.bigelow.org


From btupper at bigelow.org  Sat Aug 29 02:32:47 2015
From: btupper at bigelow.org (Ben Tupper)
Date: Fri, 28 Aug 2015 20:32:47 -0400
Subject: [R-sig-Geo] sp and latticeExtra: add colorbar for layer drawn
	'under'
In-Reply-To: <55E07580.1090707@gmail.com>
References: <0B67D297-87E4-4177-B4DF-D10355EA31B3@bigelow.org>
	<55E07580.1090707@gmail.com>
Message-ID: <1E740328-BE71-4CEB-9BC6-190B3EF4AAF0@bigelow.org>

That works like a charm.

It's sort of non-intuitive that I would use the colorkey argument for the plot of the polygons since color key is documented for levelplot.  In my naive view I would looked to xyplot when plotting polygons. I'm still in the grope and thrash stage with lattice/spplot (and occasionally enjoying it.)

Thanks so much!

Ben

On Aug 28, 2015, at 10:51 AM, Tim Appelhans <tim.appelhans at gmail.com> wrote:

> Ben,
> you could specify the colorkey manually in the spplot call for spdfbb:
> 
> sp::spplot(spdfbb,
>           colorkey = list(col = bpy.colors(101), width = 1,
>                           at = seq(0, 30, length.out = 100),
>                           space = "top"),
>           sp.layout = list(b = list('sp.polygons', qa, col = 'grey', first = FALSE))) +
>  latticeExtra::as.layer(spplot(R, at = seq(0, 30, length.out = 100)), under = TRUE)
> 
> 
> You simply need to make sure to pass the same specs to the spplot call to R.
> 
> HTH
> Tim
> 
> On 28.08.2015 16:33, Ben Tupper wrote:
>> Hello,
>> 
>> I have drawn on the following posting to draw a raster 'under' a set of polygons as shown in the image link below.  The data used is available at the third link (about 650KB).
>> 
>> Posting: http://stackoverflow.com/questions/27062768/how-to-plot-additional-raster-with-spplot
>> 
>> Image: https://dl.dropboxusercontent.com/u/8433654/sp-over-plot.png
>> 
>> Example data: https://dl.dropboxusercontent.com/u/8433654/example.RData
>> 
>> Here is a brief description of each variable plotted.
>> 
>> R is a single layer RasterStack of sea surface temperatures
>> qa is a SpatialPolygonsDataFrame of fisheries management polygons
>> spdfbb is also a SpatialPolygonsDataFrame that contains a single polygon (created from the extent of qa)
>> 
>> sp::spplot(spdfbb,
>>    colorkey = FALSE,
>>    sp.layout = list(b = list('sp.polygons', qa, col = 'grey', first = FALSE))) +
>>    latticeExtra::as.layer(spplot(R), under = TRUE)
>> 
>> Is it possible add a colorbar for the raster, R, as it might appear if I called...
>> 
>> spplot(R)
>> 
>> Session info is below my signature.
>> 
>> Thanks!
>> Ben
>> 
>> Ben Tupper
>> Bigelow Laboratory for Ocean Sciences
>> 60 Bigelow Drive, P.O. Box 380
>> East Boothbay, Maine 04544
>> http://www.bigelow.org
>> 
>>> sessionInfo()
>> R version 3.2.2 (2015-08-14)
>> Platform: x86_64-apple-darwin13.4.0 (64-bit)
>> Running under: OS X 10.9.5 (Mavericks)
>> 
>> locale:
>> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>> 
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>> 
>> other attached packages:
>>  [1] latticeExtra_0.6-26 lattice_0.20-33     rgeos_0.3-8         obpgcrawler_0.1     ecocastmap_0.1
>>  [6] RColorBrewer_1.1-2  ggplot2_1.0.1       rgdal_0.9-3         spnc_0.1            raster_2.4-15
>> [11] sp_1.1-1
>> 
>> loaded via a namespace (and not attached):
>>  [1] Rcpp_0.12.0      magrittr_1.5     MASS_7.3-43      munsell_0.4.2    colorspace_1.2-6 R6_2.1.1
>>  [7] stringr_1.0.0    httr_1.0.0       plyr_1.8.3       tools_3.2.2      grid_3.2.2       gtable_0.1.2
>> [13] digest_0.6.8     reshape2_1.4.1   ncdf4_1.13       curl_0.9.3       stringi_0.5-5    scales_0.2.5
>> [19] XML_3.98-1.3     proto_0.3-10
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> -- 
> #####################################
> Tim Appelhans
> Department of Geography
> Environmental Informatics
> Philipps Universit?t Marburg
> Deutschhausstra?e 12
> 35032 Marburg (Paketpost: 35037 Marburg)
> Germany
> 
> Tel +49 (0) 6421 28-25957
> 
> http://environmentalinformatics-marburg.de/
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



Ben Tupper
Bigelow Laboratory for Ocean Sciences
60 Bigelow Drive, P.O. Box 380
East Boothbay, Maine 04544
http://www.bigelow.org


From tim.appelhans at gmail.com  Sat Aug 29 10:55:12 2015
From: tim.appelhans at gmail.com (Tim Appelhans)
Date: Sat, 29 Aug 2015 10:55:12 +0200
Subject: [R-sig-Geo] sp and latticeExtra: add colorbar for layer drawn
 'under'
In-Reply-To: <1E740328-BE71-4CEB-9BC6-190B3EF4AAF0@bigelow.org>
References: <0B67D297-87E4-4177-B4DF-D10355EA31B3@bigelow.org>
	<55E07580.1090707@gmail.com>
	<1E740328-BE71-4CEB-9BC6-190B3EF4AAF0@bigelow.org>
Message-ID: <55E17370.30509@gmail.com>

Ben,
as a follow up, it also works the other way round, which is more intuative:

pols <- spplot(spdfbb,
                colorkey = FALSE,
                sp.layout = list(b = list('sp.polygons', qa, col = 
'grey', first = FALSE)))

rst <- spplot(R)

combo <- rst + as.layer(pols)
combo

I am not sure why SpatialPolygons* objects get rendered via levelplot.
In general, the crux with lattice/latticeExtra is that all layers 
essentially get amalgamated into one list object and hence the style 
settings for the plot are taken from the first object (rst). So if you 
were to draw pols first, the relevant colorkey specification would be 
taken from pols:

pols2 <- spplot(spdfbb,
                 colorkey = list(col = heat.colors(101), width = 1,
                                 at = seq(0, 30, length.out = 100),
                                 space = "top"),
                 sp.layout = list(b = list('sp.polygons', qa, col = 
'grey', first = FALSE)))

pols2

combo2 <- pols2 + as.layer(rst, under = TRUE) #colorkey now taken from pols2
combo2

combo3 <- rst + pols2 #same as above as colorkey is taken from rst
combo3

Best
Tim




On 29.08.2015 02:32, Ben Tupper wrote:
> That works like a charm.
>
> It's sort of non-intuitive that I would use the colorkey argument for the plot of the polygons since color key is documented for levelplot.  In my naive view I would looked to xyplot when plotting polygons. I'm still in the grope and thrash stage with lattice/spplot (and occasionally enjoying it.)
>
> Thanks so much!
>
> Ben
>
> On Aug 28, 2015, at 10:51 AM, Tim Appelhans <tim.appelhans at gmail.com> wrote:
>
>> Ben,
>> you could specify the colorkey manually in the spplot call for spdfbb:
>>
>> sp::spplot(spdfbb,
>>            colorkey = list(col = bpy.colors(101), width = 1,
>>                            at = seq(0, 30, length.out = 100),
>>                            space = "top"),
>>            sp.layout = list(b = list('sp.polygons', qa, col = 'grey', first = FALSE))) +
>>   latticeExtra::as.layer(spplot(R, at = seq(0, 30, length.out = 100)), under = TRUE)
>>
>>
>> You simply need to make sure to pass the same specs to the spplot call to R.
>>
>> HTH
>> Tim
>>
>> On 28.08.2015 16:33, Ben Tupper wrote:
>>> Hello,
>>>
>>> I have drawn on the following posting to draw a raster 'under' a set of polygons as shown in the image link below.  The data used is available at the third link (about 650KB).
>>>
>>> Posting: http://stackoverflow.com/questions/27062768/how-to-plot-additional-raster-with-spplot
>>>
>>> Image: https://dl.dropboxusercontent.com/u/8433654/sp-over-plot.png
>>>
>>> Example data: https://dl.dropboxusercontent.com/u/8433654/example.RData
>>>
>>> Here is a brief description of each variable plotted.
>>>
>>> R is a single layer RasterStack of sea surface temperatures
>>> qa is a SpatialPolygonsDataFrame of fisheries management polygons
>>> spdfbb is also a SpatialPolygonsDataFrame that contains a single polygon (created from the extent of qa)
>>>
>>> sp::spplot(spdfbb,
>>>     colorkey = FALSE,
>>>     sp.layout = list(b = list('sp.polygons', qa, col = 'grey', first = FALSE))) +
>>>     latticeExtra::as.layer(spplot(R), under = TRUE)
>>>
>>> Is it possible add a colorbar for the raster, R, as it might appear if I called...
>>>
>>> spplot(R)
>>>
>>> Session info is below my signature.
>>>
>>> Thanks!
>>> Ben
>>>
>>> Ben Tupper
>>> Bigelow Laboratory for Ocean Sciences
>>> 60 Bigelow Drive, P.O. Box 380
>>> East Boothbay, Maine 04544
>>> http://www.bigelow.org
>>>
>>>> sessionInfo()
>>> R version 3.2.2 (2015-08-14)
>>> Platform: x86_64-apple-darwin13.4.0 (64-bit)
>>> Running under: OS X 10.9.5 (Mavericks)
>>>
>>> locale:
>>> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>>>
>>> attached base packages:
>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>
>>> other attached packages:
>>>   [1] latticeExtra_0.6-26 lattice_0.20-33     rgeos_0.3-8         obpgcrawler_0.1     ecocastmap_0.1
>>>   [6] RColorBrewer_1.1-2  ggplot2_1.0.1       rgdal_0.9-3         spnc_0.1            raster_2.4-15
>>> [11] sp_1.1-1
>>>
>>> loaded via a namespace (and not attached):
>>>   [1] Rcpp_0.12.0      magrittr_1.5     MASS_7.3-43      munsell_0.4.2    colorspace_1.2-6 R6_2.1.1
>>>   [7] stringr_1.0.0    httr_1.0.0       plyr_1.8.3       tools_3.2.2      grid_3.2.2       gtable_0.1.2
>>> [13] digest_0.6.8     reshape2_1.4.1   ncdf4_1.13       curl_0.9.3       stringi_0.5-5    scales_0.2.5
>>> [19] XML_3.98-1.3     proto_0.3-10
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> -- 
>> #####################################
>> Tim Appelhans
>> Department of Geography
>> Environmental Informatics
>> Philipps Universit?t Marburg
>> Deutschhausstra?e 12
>> 35032 Marburg (Paketpost: 35037 Marburg)
>> Germany
>>
>> Tel +49 (0) 6421 28-25957
>>
>> http://environmentalinformatics-marburg.de/
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
> Ben Tupper
> Bigelow Laboratory for Ocean Sciences
> 60 Bigelow Drive, P.O. Box 380
> East Boothbay, Maine 04544
> http://www.bigelow.org
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
#####################################
Tim Appelhans
Department of Geography
Environmental Informatics
Philipps Universit?t Marburg
Deutschhausstra?e 12
35032 Marburg (Paketpost: 35037 Marburg)
Germany

Tel +49 (0) 6421 28-25957

http://environmentalinformatics-marburg.de/


From metastate at gmail.com  Sat Aug 29 16:35:24 2015
From: metastate at gmail.com (Metastate Metastate)
Date: Sat, 29 Aug 2015 09:35:24 -0500
Subject: [R-sig-Geo] Impute missing value using k nearest neighbour
In-Reply-To: <AM3PR04MB1265978822E1D89A27280284DB610@AM3PR04MB1265.eurprd04.prod.outlook.com>
References: <CAKpbK+dFi+HpxmD5ifQZYtpzWK1+5gvfUiyCEJVa4PnK2vyx_A@mail.gmail.com>
	<AM3PR04MB1265978822E1D89A27280284DB610@AM3PR04MB1265.eurprd04.prod.outlook.com>
Message-ID: <CAKpbK+ciK-6z3iE+5Q02+aeXQLZf0zTuWHwBOsWNKLEWdQ5PoQ@mail.gmail.com>

Thank you very much, Frede.

Meta
On Mon, Aug 24, 2015 at 11:55 PM, Frede Aakmann T?gersen <frtog at vestas.com>
wrote:

> Hi
>
>
>
> One method is from DMwR  package (
> https://cran.r-project.org/web/packages/DMwR/DMwR.pdf) :
>
>
>
> knnImputation
>
>
>
> Fill in NA values with the values of the nearest neighbours
>
>
>
> Description
>
>
>
> Function that fills in all NA values using the k Nearest Neighbours of
> each case with NA values.
>
> By default it uses the values of the neighbours and obtains an weighted
> (by the distance to the case)
>
> average of their values to fill in the unknows.  If meth=?median? it uses
> the median/most frequent
>
> value, instead.
>
>
>
> Usage
>
> knnImputation(data, k = 10, scale = T, meth = "weighAvg", distData = NULL)
>
>
>
> Yours sincerely / Med venlig hilsen
>
>
>
> Frede Aakmann T?gersen
>
> Specialist, M.Sc., Ph.D.
>
> Plant Performance & Modeling
>
>
>
> Technology & Service Solutions
>
> T +45 9730 5135
>
> M +45 2547 6050
>
> frtog at vestas.com
>
> http://www.vestas.com
>
>
>
> Company reg. name: Vestas Wind Systems A/S
>
> This e-mail is subject to our e-mail disclaimer statement.
>
> Please refer to www.vestas.com/legal/notice
>
> If you have received this e-mail in error please contact the sender.
>
>
>
>
>
> *From:* R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] *On Behalf Of *Metastate
> Metastate
> *Sent:* 25. august 2015 05:05
> *To:* r-sig-geo at r-project.org
> *Subject:* [R-sig-Geo] Impute missing value using k nearest neighbour
>
>
>
> Hi,
>
>
>
> I have a data set with location ID (FIPS), latitude and longitude of the
> location, V1 to v3 that are some features for relevant location. The
> dataset have more than 3000 locations.  Please see the attached file for a
> small sample. In the sample file, you can see there are some missing values
> for V2 and V3 at FIPS of 26089. Does anyone know any r package that can
> impute the missing values based on k nearest neighbor using the distance
> matrix calculated from latitude and longitude?
>
>
>
> Really appreciation for your kindly help or suggestion.
>
>
>
> Meta
>
>
>

	[[alternative HTML version deleted]]


From metastate at gmail.com  Sat Aug 29 16:37:56 2015
From: metastate at gmail.com (Metastate Metastate)
Date: Sat, 29 Aug 2015 09:37:56 -0500
Subject: [R-sig-Geo] GWmodel package error
Message-ID: <CAKpbK+c8n=TmtwcY9hHkK5gZ924mhEux-rVO20VQWMfjVcdo4w@mail.gmail.com>

Hi,

I am applying the GWmodel R package on my GWR analysis of the impact of
weather on the county-level crop yield. There are  about 2342 counties in
my analysis. But I got 2 errors for some variables as shown below. Would
you please help me out? Really appreciate for your any kindly help or
suggestion.

(1). Does the error below occur because the max_temperature_above 87F
(max_Tsfc_GT_86F_8) did not have enough unique (heterogeneous) levels? If
so, What is the minimum unique levels an independent variable should has to
avoid such error?



[1] "max_Tsfc_GT_86F_8"

[1] 30: the number of the unique levels of "max_Tsfc_GT_86F_8"

Error in solve.default(t(X * W.i) %*% X) :

  system is computationally singular: reciprocal condition number =
2.04023e-19



There is another similar one:



[1] "min_Tsfc_LT_32F_8"

[1] 6

Error in solve.default(t(X * W.i) %*% X) :

  Lapack routine dgesv: system is exactly singular: U[2,2] = 0



(2). One county in my dataset does not have value of "Qsoil_40_100_7". So,
I guess the error is due to the missing value. Am I right?

[1] "Qsoil_40_100_7"

[1] 1338

Error in cov.wt(matrix(y, ncol = 1), wt = rep(as.numeric(1), dp.n),
method = "ML") :

  length of 'wt' must equal the number of rows in 'x'



Really appreciate!


Meta

	[[alternative HTML version deleted]]


From rajcheruk at gmail.com  Sat Aug 29 22:33:37 2015
From: rajcheruk at gmail.com (Rajabhushanam. C)
Date: Sun, 30 Aug 2015 02:03:37 +0530
Subject: [R-sig-Geo] How to use coKriging with LANDSAT ETM Imagery
Message-ID: <CANSnM0sUxy-nX33mH3G7xBVE6j2+Miq39nDQB0xiQvf7FKO=9g@mail.gmail.com>

Hi,

I am using a Landsat ETM Scene imagery for calculating the Linear
Corregionalization Method in CoKriging.  (gstat).

Can you kindly debug my snippet (See enclosed). Really appreciate your help.


Thanking in advance.


> coKrige1 <- variogram(coKrige2)Error in model.frame.default(terms(formula), as(data, "data.frame"), na.action = na.fail) :
  object is not a matrix


> coKrige.fit <- fit.lmc(coKrige1, coKrige2, vgm(1, "Gau", 350, 1), TRUE, 1.0)Error in fit.lmc(coKrige1, coKrige2, vgm(1, "Gau", 350, 1), TRUE, 1) :
  gstatVariogram var1 not present


> coKrige.predict <- predict(coKrige.fit, rGrid)Error in UseMethod("predict") :
  no applicable method for 'predict' applied to an object of class
"c('variogramModel', 'data.frame')"




On Fri, Aug 21, 2015 at 3:33 PM, Rajabhushanam. C <rajcheruk at gmail.com>
wrote:

> Hi,
>
> I am using a Landsat ETM Scene imagery for calculating the Linear
> Corregionalization Method in CoKriging.  (gstat).
>
> Specifically, there is one raster band imagery and then using readGDAL and
> gstat function calls, I am making a gstat object that is input to the
> Variogram call. Now, while I use *fit.lmc()*, I get an error message *"gstatVariogram
> var1 not present"*. I have done some preliminary findings, and there are
> no pertinent messages in this message board that have Raster as an input to
> cokriging.
>
> Really appreciate if anybody can point me some relevant code or pseudo
> code to perform cokriging with Landsat one band imagery.
>
> Thank You
> C. Rajabhushanam.
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150830/89cb88a4/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Sample1_Band3.tif
Type: image/tiff
Size: 20384 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150830/89cb88a4/attachment.tif>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Image_Fit_coKriging.R
Type: text/x-r-source
Size: 1008 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150830/89cb88a4/attachment.bin>

From edzer.pebesma at uni-muenster.de  Sun Aug 30 12:37:36 2015
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sun, 30 Aug 2015 12:37:36 +0200
Subject: [R-sig-Geo] sp and latticeExtra: add colorbar for layer drawn
 'under'
In-Reply-To: <55E17370.30509@gmail.com>
References: <0B67D297-87E4-4177-B4DF-D10355EA31B3@bigelow.org>
	<55E07580.1090707@gmail.com>
	<1E740328-BE71-4CEB-9BC6-190B3EF4AAF0@bigelow.org>
	<55E17370.30509@gmail.com>
Message-ID: <55E2DCF0.7070400@uni-muenster.de>



On 08/29/2015 10:55 AM, Tim Appelhans wrote:
> 
> I am not sure why SpatialPolygons* objects get rendered via levelplot.

because levelplot has the understanding of plotting something in 2D,
using colours according to the continuous variation of a third variable.
-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi),  University of M?nster,
Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
Journal of Statistical Software:   http://www.jstatsoft.org/
Computers & Geosciences:   http://elsevier.com/locate/cageo/
Spatial Statistics Society http://www.spatialstatistics.info

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150830/de64e03b/attachment.bin>

From tim.appelhans at gmail.com  Sun Aug 30 13:05:17 2015
From: tim.appelhans at gmail.com (Tim Appelhans)
Date: Sun, 30 Aug 2015 13:05:17 +0200
Subject: [R-sig-Geo] mapView: basic interactive viewing of spatial data
 in R
In-Reply-To: <m2k2tpzxbw.fsf@krugs.de>
References: <55B207E2.9030408@gmail.com> <m2k2tpzxbw.fsf@krugs.de>
Message-ID: <55E2E36D.8090408@gmail.com>

Dear list,
after some really good discussions and good feedback at Geostat 2015 
summer school in Lancaster (Many thanks to Tom, Barry, Edzer, Roger and 
all the others for inviting me), I have now ported the mapView code into 
its own package called mapview (mind the small 'v'!)

The package can be found at

https://github.com/environmentalinformatics-marburg/mapview

and can be installed using library(devtools)

devtools::install_github("environmentalinformatics-marburg/mapview")


Any suggestions, bug reports or feature requests should be filed here

https://github.com/environmentalinformatics-marburg/mapview/issues


Cheers
Tim



On 24.07.2015 12:03, Rainer M Krug wrote:
> Tim Appelhans <tim.appelhans at gmail.com> writes:
>
>> Dear list members,
>>
>> I would like to draw your attention to a little 'project' I've been
>> working on over the past few weeks.
>>
>> Using leaflet for R, I have defined some methods for spatial data (e.g.
>> Raster*, Spatial* objects) to quickly visualise them in either the
>> RStudio Viewer pan or the default web browser. The function I created
>> for this is called mapView().
>>
>> Think of it as an interactive version of spplot()/plot() for spatial
>> data (though less versatile). It enables zooming, paning and basic layer
>> queries (i.e. printing of the attributes in the @data slot of Spatial*
>> objects + the x/y location of the feature). For Raster* objects queries
>> are currently not available as leaflet translates the data into RGB
>> values for display. Furthermore, background maps can be defined and
>> multiple different spatial object layers can be overlaid.
>> At the moment mapView() lives in our Rsenal package on github
>> (https://github.com/environmentalinformatics-marburg/Rsenal) but this is
>> likely going to change at some point in the not too distant future. This
>> also depends on whether there is active interest in developping this
>> sort of thing further to provide more than the current admittedly rather
>> limited functionality. This, however, would involve JavaScript coding
>> which I do not have any experience with.
>>
>> A quick (non-interactive) intorduction can be found here:
>>
>> https://metvurst.wordpress.com/
>>
>> The full introductory article including interactive examples is
>> published here:
>>
>> http://environmentalinformatics-marburg.github.io/web-presentations/20150723_mapView.html
>>
>> I hope this may prove useful for some of you.
> This looks like something I was really missing! I was always exporting
> my spatial data into GRASS and viewing it there - but this looks really
> brilliant! This makes out of R a very powerful command line GIS.
>
> I would really like to see this functionality in a separate R package on
> CRAN - even with only its current functionality, it is very useful!
>
> Thanks a lot and keep us posted,
>
> Rainer
>
>> Also, if anyone is keen to get involved in taking this further, please
>> let me know and we will see how to best proceed.
>>
>> Best,
>> Tim

-- 
#####################################
Tim Appelhans
Department of Geography
Environmental Informatics
Philipps Universit?t Marburg
Deutschhausstra?e 12
35032 Marburg (Paketpost: 35037 Marburg)
Germany

Tel +49 (0) 6421 28-25957

http://environmentalinformatics-marburg.de/


From Roger.Bivand at nhh.no  Sun Aug 30 18:32:10 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sun, 30 Aug 2015 18:32:10 +0200
Subject: [R-sig-Geo] criterion for the best fitting model if using GMM?
In-Reply-To: <CACc7PKoiGmor53vQ1G-TKcdofROdxbom5++NOZXmCS-dZqJbpQ@mail.gmail.com>
References: <CACc7PKoiGmor53vQ1G-TKcdofROdxbom5++NOZXmCS-dZqJbpQ@mail.gmail.com>
Message-ID: <alpine.LFD.2.20.1508301819200.24200@reclus.nhh.no>

On Fri, 28 Aug 2015, Qiuhua Ma wrote:

> Hi,
>
> I have two big datasets:10,000 observations and 40,000.
>
> I tried to use ML so that I can use maximized LL or AIC to decide the best
> fitting model! However it took so long and most of the time R was turned
> off automatically.

Please do read the posting instructions, and provide sample code 
illustrating your problem.

Your main problem is not reading the documentation, as you will see that 
you have ignored the method= argument (assuming that your neighbours are 
sparse). Fitting ML models with n=40K with method="Matrix" for symmetric 
weights and method="LU" for asymmetric weights just works for sparse 
weights. If you are using dense neighbours, you should not be surprised 
that things become difficult.

Using AIC is questionable anyway in econometrics, as you should know the 
correct model from theory, or possibly use Bayesian model selection.

Stata spreg ml returns e(ll):

http://econ-server.umd.edu/~Prucha/Papers/SJ_SPREG%282013%29.pdf

>
> GMM seems like a better option. I searched the literature but cannot find
> the criterion for the best fitting model. Any idea?
>

This illustrates why you should indicate the published paper defining the 
LL of such GMM-estimated models:

> library(sem)
> AIC(tsls(Q ~ P + D, ~ D + F + A, data=Kmenta))
Error in UseMethod("logLik") :
   no applicable method for 'logLik' applied to an object of class "tsls"
> logLik(tsls(Q ~ P + D, ~ D + F + A, data=Kmenta))
Error in UseMethod("logLik") :
   no applicable method for 'logLik' applied to an object of class "tsls"

Stata spreg g2sls does not returm a log likelihood.

Please do check the literature before posting speculations.

Roger Bivand

> thanks,
>
> Chelsea
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From sja_sari at yahoo.com  Mon Aug 31 07:20:54 2015
From: sja_sari at yahoo.com (Seyed Jalil Alavi)
Date: Mon, 31 Aug 2015 05:20:54 +0000 (UTC)
Subject: [R-sig-Geo] Nagelkerke value for  OLS model
Message-ID: <1436738067.3176231.1440998454921.JavaMail.yahoo@mail.yahoo.com>

Dear all,
I would like to compare the performance of linear regression model with SAR models. One of the measures that I want to use is R squared.
Prof. Roger Bivand mentioned in r-sig-geo that "There is no direct equivalent to the OLS R-squared, these models?are fitted by maximum likelihood. If you want something like an R-squared, try the Nagelkerke R-bar-squared,?based on the likelihood.?You should then compare this with a Nagelkerke value for?your OLS model".
My question is:
How can I calculate a?Nagelkerke value for OLS in R and compare it with?Nagelkerke value form summary function in SAR Models.
Thank you so much
Cheers,
SJA?
	[[alternative HTML version deleted]]


From sja_sari at yahoo.com  Mon Aug 31 07:33:44 2015
From: sja_sari at yahoo.com (Seyed Jalil Alavi)
Date: Mon, 31 Aug 2015 05:33:44 +0000 (UTC)
Subject: [R-sig-Geo] black and white textures for reclassed map in R
Message-ID: <1807534168.3228728.1440999224075.JavaMail.yahoo@mail.yahoo.com>

Dear all


I am going to map the forest productivity using geostatistical methods?
like kriging, IDW, etc in R. I would like to publish the reclassed maps as black and white with different textures in R. I do not know how to do that. I need 6 textures for example vertical?texture, horizontal texture for each category.

I would be very grateful if anyone can help me to do that in R.

Thank you so much

regards

SJA?

	[[alternative HTML version deleted]]


From Roger.Bivand at nhh.no  Mon Aug 31 11:57:46 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 31 Aug 2015 11:57:46 +0200
Subject: [R-sig-Geo] Nagelkerke value for  OLS model
In-Reply-To: <1436738067.3176231.1440998454921.JavaMail.yahoo@mail.yahoo.com>
References: <1436738067.3176231.1440998454921.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <alpine.LFD.2.20.1508311154480.2867@reclus.nhh.no>

On Mon, 31 Aug 2015, Seyed Jalil Alavi via R-sig-Geo wrote:

> Dear all,
> I would like to compare the performance of linear regression model with SAR models. One of the measures that I want to use is R squared.
> Prof. Roger Bivand mentioned in r-sig-geo that "There is no direct equivalent to the OLS R-squared, these models?are fitted by maximum likelihood. If you want something like an R-squared, try the Nagelkerke R-bar-squared,?based on the likelihood.?You should then compare this with a Nagelkerke value for?your OLS model".
> My question is:
> How can I calculate a?Nagelkerke value for OLS in R and compare it with?Nagelkerke value form summary function in SAR Models.
> Thank you so much

Please do not post HTML, only plain text.

Please do read the documentation - ?summary.sarlm contains this reference:

Nagelkerke NJD (1991) A note on a general definition of the
      coefficient of determination. Biometrika 78: 691-692

Read that, and you'll see that it is simple to calculate, but it is not 
easy to see how to draw inferences from the comparison. The LR test on the 
spatial coefficient is much better studied and should be preferred.

Roger

> Cheers,
> SJA?
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no

From Roger.Bivand at nhh.no  Mon Aug 31 12:06:39 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 31 Aug 2015 12:06:39 +0200
Subject: [R-sig-Geo] black and white textures for reclassed map in R
In-Reply-To: <1807534168.3228728.1440999224075.JavaMail.yahoo@mail.yahoo.com>
References: <1807534168.3228728.1440999224075.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <alpine.LFD.2.20.1508311158140.2867@reclus.nhh.no>

On Mon, 31 Aug 2015, Seyed Jalil Alavi via R-sig-Geo wrote:

> Dear all
>
>
> I am going to map the forest productivity using geostatistical methods? 
> like kriging, IDW, etc in R. I would like to publish the reclassed maps 
> as black and white with different textures in R. I do not know how to do 
> that. I need 6 textures for example vertical?texture, horizontal texture 
> for each category.

Base graphics use hashing as described in ?polygon; so the plot() method 
for SpatialPolygon objects uses them too, see: ?"Spatial-class". See also:

http://rspatial.r-forge.r-project.org/gallery/#fig15.R

for an example with code.

Roger

>
> I would be very grateful if anyone can help me to do that in R.
>
> Thank you so much
>
> regards
>
> SJA?
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no

From edzer.pebesma at uni-muenster.de  Mon Aug 31 13:28:29 2015
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 31 Aug 2015 13:28:29 +0200
Subject: [R-sig-Geo] How to use coKriging with LANDSAT ETM Imagery
In-Reply-To: <CANSnM0sUxy-nX33mH3G7xBVE6j2+Miq39nDQB0xiQvf7FKO=9g@mail.gmail.com>
References: <CANSnM0sUxy-nX33mH3G7xBVE6j2+Miq39nDQB0xiQvf7FKO=9g@mail.gmail.com>
Message-ID: <55E43A5D.6080205@uni-muenster.de>

Please find a working script below. The error message was given because
the variable "value" was not present in new.data; the variable was
called "Sample1_Band3".

It is quite unclear what you try to do: interpolating an image at the
image pixels themselves (which will, by definition, return the original
image), in any case, there is no cokriging going on in this script.



library(raster)
library(sp)
library(rgdal)
library(gstat)
library(rasterVis)
library(lattice)

#sink(file="/home/raj/evolution_research/Geocomputing/coKriging/bands345_run.log")

Image1 <-raster("Sample1_Band3.tif", layer=1, values="TRUE")
Image1

r1 <- readGDAL("Sample1_Band3.tif")
image(r1)

rGrid <- as(r1, "SpatialPixelsDataFrame")
summary(rGrid)

new.data <- as(Image1, "SpatialPointsDataFrame")

coKrige <- gstat(formula=Sample1_Band3 ~ 1, data=new.data, nmax = 10)
# I'm setting nmax to avoid absurd long computation

coKrige2 <- gstat(g=coKrige, model=vgm(1, "Gau", 350, 1), fill.all=TRUE)
list(coKrige2)

coKrige1 <- variogram(coKrige2)

class(coKrige1) <- c("gstatVariogram", "data.frame")
coKrige1$np <- rep(15, nrow(coKrige1))
coKrige1

coKrige.fit <- fit.lmc(coKrige1, coKrige2, vgm(1, "Gau", 350, 1), TRUE, 1.0)
coKrige.fit

plot(coKrige1, model=coKrige.fit$model[[1]])

coKrige.predict <- predict(coKrige.fit, rGrid, nmax = 5, debug.level = -1)
spplot(coKrige.predict[1])

#plot(coKrige.predict)

On 08/29/2015 10:33 PM, Rajabhushanam. C wrote:
> Hi,
> 
> I am using a Landsat ETM Scene imagery for calculating the Linear
> Corregionalization Method in CoKriging.  (gstat).
> 
> Can you kindly debug my snippet (See enclosed). Really appreciate your
> help.
> 
> 
> Thanking in advance.
> 
> 
>> coKrige1 <- variogram(coKrige2) Error in
> model.frame.default(terms(formula), as(data, "data.frame"), na.action =
> na.fail) : object is not a matrix
> 
> 
>> coKrige.fit <- fit.lmc(coKrige1, coKrige2, vgm(1, "Gau", 350, 1), TRUE,
> 1.0) Error in fit.lmc(coKrige1, coKrige2, vgm(1, "Gau", 350, 1), TRUE,
> 1) : gstatVariogram var1 not present
> 
> 
>> coKrige.predict <- predict(coKrige.fit, rGrid) Error in
> UseMethod("predict") : no applicable method for 'predict' applied to an
> object of class "c('variogramModel', 'data.frame')"
> 
> 
> 
> 
> On Fri, Aug 21, 2015 at 3:33 PM, Rajabhushanam. C <rajcheruk at gmail.com
> <mailto:rajcheruk at gmail.com>> wrote:
> 
>     Hi,
> 
>     I am using a Landsat ETM Scene imagery for calculating the Linear
>     Corregionalization Method in CoKriging.  (gstat).
> 
>     Specifically, there is one raster band imagery and then using
>     readGDAL and gstat function calls, I am making a gstat object that
>     is input to the Variogram call. Now, while I use *fit.lmc()*, I get
>     an error message *"gstatVariogram var1 not present"*. I have done
>     some preliminary findings, and there are no pertinent messages in
>     this message board that have Raster as an input to cokriging.
> 
>     Really appreciate if anybody can point me some relevant code or
>     pseudo code to perform cokriging with Landsat one band imagery.
> 
>     Thank You
>     C. Rajabhushanam.
> 
> 
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi),  University of M?nster,
Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
Journal of Statistical Software:   http://www.jstatsoft.org/
Computers & Geosciences:   http://elsevier.com/locate/cageo/
Spatial Statistics Society http://www.spatialstatistics.info

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150831/02e656c9/attachment.bin>

From josetanago at gmail.com  Fri Aug 28 20:32:25 2015
From: josetanago at gmail.com (Jose Tanago)
Date: Fri, 28 Aug 2015 20:32:25 +0200
Subject: [R-sig-Geo] Any R package for focal statistics (moving window)
	within a 3D neighborhood
Message-ID: <CAAY+5UQ44ZHSUqafcFy=r3Y_vBCuAm1hXwfRwe6U4ugucXzS1A@mail.gmail.com>

I am trying to find any R package that can provide me any build-on function
for computing a 3D neighborhood filter or statistics,... (if that already
exists!), or if not, at least any function from a non-spatial R-package
that could be useful to build my function.

Any info about preexisting R packages or any tips how to implement it with
other packages are very very welcome!

The data: 3D point data set (centers of voxels= volumetric pixels) read as
an R data.frame  with 4 columns (x,y,z, and an attribute). Can be big (e.g.
millions rows)

The problem: 1) Evaluate the values of the attribute column for all the
points within a 3D neighborhood from any point (any instance in the
data.frame differing less than  "X" value in X,Y,Z, coordinates). (i.e. A
sort of moving window for a raster but in a 3D neighborhood).

2) Transform the "cell" or 3D point attribute value, if a condition is
fulfilled for any of the 3D neighbors.

Thanks a lot!
Jose Tanago
Lab. of Remote Sensing, Wageningen University

	[[alternative HTML version deleted]]


From josetanago at gmail.com  Mon Aug 31 10:43:03 2015
From: josetanago at gmail.com (Jose Tanago)
Date: Mon, 31 Aug 2015 10:43:03 +0200
Subject: [R-sig-Geo] Looking for an R package for focal statistics (moving
 window) within a 3D neighborhood
Message-ID: <CAAY+5UTyCJ0uEHWh+rOZXvLN1pmT6LLJV2svS+8Pn34im_901w@mail.gmail.com>

I am writing an algorithm in R for 3D point data sets (centers of voxels),
read as an R data.frame  with 4 columns (x,y,z values and an attribute).
They can be big (e.g. millions rows).

I am trying to find any R package that has any function for computing a 3D
neighborhood (filter or statistics,...). If such funtion{package}  already
exists it would be great!, but if not, at least any function from a
non-spatial R-package that could be useful to build an ad-hoc 3D
neighborhood function might work as well.

Does anyone know a preexisting R package that has a neighborhood function?,
or any tips how could be implemented with other packages (customizing or
building from a more generic package)??

The problem that the function would help: Check the values of the attribute
column for all the points within a 3D neighborhood from any point (any
instance in the data.frame differing less than  "a" value in X,Y,Z,
coordinates). (i.e. A sort of moving window for a raster but in a 3D
neighborhood). Then, transform the "cell" or 3D point attribute value, if a
condition is fulfilled for any of the 3D neighbors.

If there is no package with a 3D neighborhood function, I though maybe is
possible to create a custom function that for each instance (point)
evaluates all others points XYZ  in the data.frame and computing a
neighborhood attribute value by selecting only the ones within a distance
in XYZ. But I am not very sure how to make something like this in a
reasonable way, I guess evaluating all other points xyz will take very long
with millions rows.

Thanks a lot for any idea!

Jose Tanago

Lab. of Remote Sensing, Wageningen University

	[[alternative HTML version deleted]]


From mdsumner at gmail.com  Mon Aug 31 14:39:32 2015
From: mdsumner at gmail.com (Michael Sumner)
Date: Mon, 31 Aug 2015 22:39:32 +1000
Subject: [R-sig-Geo] Looking for an R package for focal statistics
 (moving window) within a 3D neighborhood
In-Reply-To: <CAAY+5UTyCJ0uEHWh+rOZXvLN1pmT6LLJV2svS+8Pn34im_901w@mail.gmail.com>
References: <CAAY+5UTyCJ0uEHWh+rOZXvLN1pmT6LLJV2svS+8Pn34im_901w@mail.gmail.com>
Message-ID: <CAAcGz9_OOkZu9g0YfUAbiN2HLajrO3NDCtjS1x3piCjYx0cU=w@mail.gmail.com>

Try nabor package.

Cheers, Mike

On Monday, August 31, 2015, Jose Tanago <josetanago at gmail.com> wrote:
> I am writing an algorithm in R for 3D point data sets (centers of voxels),
> read as an R data.frame  with 4 columns (x,y,z values and an attribute).
> They can be big (e.g. millions rows).
>
> I am trying to find any R package that has any function for computing a 3D
> neighborhood (filter or statistics,...). If such funtion{package}  already
> exists it would be great!, but if not, at least any function from a
> non-spatial R-package that could be useful to build an ad-hoc 3D
> neighborhood function might work as well.
>
> Does anyone know a preexisting R package that has a neighborhood
function?,
> or any tips how could be implemented with other packages (customizing or
> building from a more generic package)??
>
> The problem that the function would help: Check the values of the
attribute
> column for all the points within a 3D neighborhood from any point (any
> instance in the data.frame differing less than  "a" value in X,Y,Z,
> coordinates). (i.e. A sort of moving window for a raster but in a 3D
> neighborhood). Then, transform the "cell" or 3D point attribute value, if
a
> condition is fulfilled for any of the 3D neighbors.
>
> If there is no package with a 3D neighborhood function, I though maybe is
> possible to create a custom function that for each instance (point)
> evaluates all others points XYZ  in the data.frame and computing a
> neighborhood attribute value by selecting only the ones within a distance
> in XYZ. But I am not very sure how to make something like this in a
> reasonable way, I guess evaluating all other points xyz will take very
long
> with millions rows.
>
> Thanks a lot for any idea!
>
> Jose Tanago
>
> Lab. of Remote Sensing, Wageningen University
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Michael Sumner
Software and Database Engineer
Australian Antarctic Division
Hobart, Australia
e-mail: mdsumner at gmail.com

	[[alternative HTML version deleted]]


From uzzal at gist.ac.kr  Mon Aug 31 16:04:55 2015
From: uzzal at gist.ac.kr (Uzzal)
Date: Mon, 31 Aug 2015 23:04:55 +0900 (KST)
Subject: [R-sig-Geo] How to plot multiple variogram with different title in
	loop?
Message-ID: <1713959592.1441029895546.JavaMail.root@eunhasu>

I have a csv file contains hourly PM10 concentration of 1 march to 7 march. Please, download from here. I have already plotted all the hourly variogram (total 161) in a loop by automap package. Here is the coad, this code work properly     library(sp)
    library(gstat)
    library(rgdal)
    library(automap)
    library(latticeExtra)
    
    seoul1to7
    seoul1to7[seoul1to7==0] 
    seoul1to7 
    seoul1to7_split
    seq(seoul1to7_split)
    
    
    
    vars
    {
      dat
      coordinates(dat)
      proj4string(dat) 
      dat 
      variogram
      plot
      
      return(plot)
    })
    vars[[1]]
    vars[[2]] 
Here, I can get the individual plot by `vars[[1]], vars[[2]]...`etc command but all the variogram has a same title. Now, I want to get all the variogram  with different title in a loop. I want my variogram title be like, "Variogram for 2012-03-01 1.00",  "Variogram for 2012-03-01 2.00" .....etc.      a
    a
    hours
    hours I keep my desired different title in `hours` variable like "2012-03-01 01:00", "2012-03-01 02:00", "2012-03-01 03:00" ...etc. How can I plot all the variograms (total 161)  with different title?  Orpheus    
 




-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150831/7944854f/attachment.html>

From paul.lantos at duke.edu  Mon Aug 31 16:53:33 2015
From: paul.lantos at duke.edu (Paul Lantos)
Date: Mon, 31 Aug 2015 14:53:33 +0000
Subject: [R-sig-Geo] polygon neighbor matrix
Message-ID: <SN1PR05MB1920CDD2EDCB6E77A1C9DF11B56B0@SN1PR05MB1920.namprd05.prod.outlook.com>

Hi,

I'm trying to use the cluster analysis program Flexscan, which I gather is similar to Satscan but it computes irregular clusters. This program requires a polygon adjacency matrix (termed a 'matrix definition file'). The example they provide has a row for every polygon, and for each row every neighboring polygon is listed in successive columns. So for instance if row 1 / polygon 1 has 3 neighbors there will be three polygons listed in columns 2-4.

I have tried some techniques like the spatial weights matrix tools in ArcGIS and in Spatstat, but I cannot get the output in this kind of format. Was wondering if there is some obvious way to do this in R.

The documentation for Flexscan is here:

https://sites.google.com/site/flexscansoftware/download_e/FleXScan%20User%20Guide_e31.pdf?attredirects=0&d=1

Thanks for any help,
Paul

_______________________________________
Paul M. Lantos, MD, FIDSA, FAAP, FACP
Departments of Internal Medicine and Pediatrics
  Pediatric Infectious Diseases
  Hospital Medicine Program
Duke University School of Medicine
_______________________________________


	[[alternative HTML version deleted]]


From thierry.onkelinx at inbo.be  Mon Aug 31 17:01:04 2015
From: thierry.onkelinx at inbo.be (Thierry Onkelinx)
Date: Mon, 31 Aug 2015 17:01:04 +0200
Subject: [R-sig-Geo] polygon neighbor matrix
In-Reply-To: <SN1PR05MB1920CDD2EDCB6E77A1C9DF11B56B0@SN1PR05MB1920.namprd05.prod.outlook.com>
References: <SN1PR05MB1920CDD2EDCB6E77A1C9DF11B56B0@SN1PR05MB1920.namprd05.prod.outlook.com>
Message-ID: <CAJuCY5wR538pYBpqKwTkuMzLwSXxGVEbQz6pPCF4ZOpBzZpqfw@mail.gmail.com>

Maybe gTouches() from the rgeos package.
ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Research Institute for Nature
and Forest
team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
Kliniekstraat 25
1070 Anderlecht
Belgium

To call in the statistician after the experiment is done may be no
more than asking him to perform a post-mortem examination: he may be
able to say what the experiment died of. ~ Sir Ronald Aylmer Fisher
The plural of anecdote is not data. ~ Roger Brinner
The combination of some data and an aching desire for an answer does
not ensure that a reasonable answer can be extracted from a given body
of data. ~ John Tukey


2015-08-31 16:53 GMT+02:00 Paul Lantos <paul.lantos at duke.edu>:
> Hi,
>
> I'm trying to use the cluster analysis program Flexscan, which I gather is similar to Satscan but it computes irregular clusters. This program requires a polygon adjacency matrix (termed a 'matrix definition file'). The example they provide has a row for every polygon, and for each row every neighboring polygon is listed in successive columns. So for instance if row 1 / polygon 1 has 3 neighbors there will be three polygons listed in columns 2-4.
>
> I have tried some techniques like the spatial weights matrix tools in ArcGIS and in Spatstat, but I cannot get the output in this kind of format. Was wondering if there is some obvious way to do this in R.
>
> The documentation for Flexscan is here:
>
> https://sites.google.com/site/flexscansoftware/download_e/FleXScan%20User%20Guide_e31.pdf?attredirects=0&d=1
>
> Thanks for any help,
> Paul
>
> _______________________________________
> Paul M. Lantos, MD, FIDSA, FAAP, FACP
> Departments of Internal Medicine and Pediatrics
>   Pediatric Infectious Diseases
>   Hospital Medicine Program
> Duke University School of Medicine
> _______________________________________
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Roger.Bivand at nhh.no  Mon Aug 31 20:19:31 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 31 Aug 2015 20:19:31 +0200
Subject: [R-sig-Geo] polygon neighbor matrix
In-Reply-To: <SN1PR05MB1920CDD2EDCB6E77A1C9DF11B56B0@SN1PR05MB1920.namprd05.prod.outlook.com>
References: <SN1PR05MB1920CDD2EDCB6E77A1C9DF11B56B0@SN1PR05MB1920.namprd05.prod.outlook.com>
Message-ID: <alpine.LFD.2.20.1508312008500.29191@reclus.nhh.no>

On Mon, 31 Aug 2015, Paul Lantos wrote:

> Hi,
>
> I'm trying to use the cluster analysis program Flexscan, which I gather 
> is similar to Satscan but it computes irregular clusters. This program 
> requires a polygon adjacency matrix (termed a 'matrix definition file'). 
> The example they provide has a row for every polygon, and for each row 
> every neighboring polygon is listed in successive columns. So for 
> instance if row 1 / polygon 1 has 3 neighbors there will be three 
> polygons listed in columns 2-4.
>
> I have tried some techniques like the spatial weights matrix tools in 
> ArcGIS and in Spatstat, but I cannot get the output in this kind of 
> format. Was wondering if there is some obvious way to do this in R.
>
> The documentation for Flexscan is here:
>
> https://sites.google.com/site/flexscansoftware/download_e/FleXScan%20User%20Guide_e31.pdf?attredirects=0&d=1

Something like:

library(spdep)
example(nc.sids)
out <- sapply(seq(along=ncCR85_nb), function(i) paste(attr(ncCR85_nb,
   "region.id")[i], paste(attr(ncCR85_nb, "region.id")[ncCR85_nb[[i]]],
   collapse=" ")))
writeLines(out, tf)
file.show(tf)

See also:

vignette("nb")

Roger

>
> Thanks for any help,
> Paul
>
> _______________________________________
> Paul M. Lantos, MD, FIDSA, FAAP, FACP
> Departments of Internal Medicine and Pediatrics
>  Pediatric Infectious Diseases
>  Hospital Medicine Program
> Duke University School of Medicine
> _______________________________________
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From bob at rudis.net  Mon Aug 31 20:24:32 2015
From: bob at rudis.net (boB Rudis)
Date: Mon, 31 Aug 2015 14:24:32 -0400
Subject: [R-sig-Geo] polygon neighbor matrix
In-Reply-To: <alpine.LFD.2.20.1508312008500.29191@reclus.nhh.no>
References: <SN1PR05MB1920CDD2EDCB6E77A1C9DF11B56B0@SN1PR05MB1920.namprd05.prod.outlook.com>
	<alpine.LFD.2.20.1508312008500.29191@reclus.nhh.no>
Message-ID: <CAJ4QxaOmuwcgMUr0eKHD-a-V20noayph3=DQhCZmQFUKWQnMBw@mail.gmail.com>

I second the `gTouches` suggestion. There's a ref here:
http://stackoverflow.com/a/26499134/1457051 but the gist of it is
(this user needed adjacent polygons in ghana):

library(rgeos)
library(rgdal)

# using http://data.biogeo.ucdavis.edu/data/diva/adm/GHA_adm.zip
ghana <- readOGR("GHA_adm", "GHA_adm1")

gTouches(ghana, byid=TRUE)

##       0     1     2     3     4     5     6     7     8     9
## 0 FALSE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE  TRUE
## 1  TRUE FALSE FALSE  TRUE FALSE  TRUE FALSE FALSE  TRUE  TRUE
## 2  TRUE FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE FALSE  TRUE
## 3  TRUE  TRUE  TRUE FALSE  TRUE FALSE FALSE FALSE  TRUE FALSE
## 4 FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE FALSE  TRUE FALSE
## 5 FALSE  TRUE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE FALSE
## 6 FALSE FALSE FALSE FALSE FALSE  TRUE FALSE  TRUE FALSE FALSE
## 7 FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE
## 8 FALSE  TRUE FALSE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE
## 9  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE

On Mon, Aug 31, 2015 at 2:19 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> On Mon, 31 Aug 2015, Paul Lantos wrote:
>
>> Hi,
>>
>> I'm trying to use the cluster analysis program Flexscan, which I gather is
>> similar to Satscan but it computes irregular clusters. This program requires
>> a polygon adjacency matrix (termed a 'matrix definition file'). The example
>> they provide has a row for every polygon, and for each row every neighboring
>> polygon is listed in successive columns. So for instance if row 1 / polygon
>> 1 has 3 neighbors there will be three polygons listed in columns 2-4.
>>
>> I have tried some techniques like the spatial weights matrix tools in
>> ArcGIS and in Spatstat, but I cannot get the output in this kind of format.
>> Was wondering if there is some obvious way to do this in R.
>>
>> The documentation for Flexscan is here:
>>
>>
>> https://sites.google.com/site/flexscansoftware/download_e/FleXScan%20User%20Guide_e31.pdf?attredirects=0&d=1
>
>
> Something like:
>
> library(spdep)
> example(nc.sids)
> out <- sapply(seq(along=ncCR85_nb), function(i) paste(attr(ncCR85_nb,
>   "region.id")[i], paste(attr(ncCR85_nb, "region.id")[ncCR85_nb[[i]]],
>   collapse=" ")))
> writeLines(out, tf)
> file.show(tf)
>
> See also:
>
> vignette("nb")
>
> Roger
>
>>
>> Thanks for any help,
>> Paul
>>
>> _______________________________________
>> Paul M. Lantos, MD, FIDSA, FAAP, FACP
>> Departments of Internal Medicine and Pediatrics
>>  Pediatric Infectious Diseases
>>  Hospital Medicine Program
>> Duke University School of Medicine
>> _______________________________________
>>
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 91 00
> e-mail: Roger.Bivand at nhh.no
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Roger.Bivand at nhh.no  Mon Aug 31 20:29:09 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 31 Aug 2015 20:29:09 +0200
Subject: [R-sig-Geo] polygon neighbor matrix
In-Reply-To: <CAJ4QxaOmuwcgMUr0eKHD-a-V20noayph3=DQhCZmQFUKWQnMBw@mail.gmail.com>
References: <SN1PR05MB1920CDD2EDCB6E77A1C9DF11B56B0@SN1PR05MB1920.namprd05.prod.outlook.com>
	<alpine.LFD.2.20.1508312008500.29191@reclus.nhh.no>
	<CAJ4QxaOmuwcgMUr0eKHD-a-V20noayph3=DQhCZmQFUKWQnMBw@mail.gmail.com>
Message-ID: <alpine.LFD.2.20.1508312025170.29191@reclus.nhh.no>

On Mon, 31 Aug 2015, boB Rudis wrote:

> I second the `gTouches` suggestion. There's a ref here:
> http://stackoverflow.com/a/26499134/1457051 but the gist of it is
> (this user needed adjacent polygons in ghana):

If this answered the question, it would be OK. But it doesn't, as reading 
the link provided to the FlexScan documentation showed (not a matrix, 
but a ragged right-edged text array).

Using gTouches can work, especially if the returnDense=FALSE argument is 
used (ie. don't return a matrix), but can fail if snapping is needed. 
spdep::poly2nb is the preferred route, because it makes snapping possible, 
and because the nb S3 class is much more flexible than matrices.

Roger

>
> library(rgeos)
> library(rgdal)
>
> # using http://data.biogeo.ucdavis.edu/data/diva/adm/GHA_adm.zip
> ghana <- readOGR("GHA_adm", "GHA_adm1")
>
> gTouches(ghana, byid=TRUE)
>
> ##       0     1     2     3     4     5     6     7     8     9
> ## 0 FALSE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE  TRUE
> ## 1  TRUE FALSE FALSE  TRUE FALSE  TRUE FALSE FALSE  TRUE  TRUE
> ## 2  TRUE FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE FALSE  TRUE
> ## 3  TRUE  TRUE  TRUE FALSE  TRUE FALSE FALSE FALSE  TRUE FALSE
> ## 4 FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE FALSE  TRUE FALSE
> ## 5 FALSE  TRUE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE FALSE
> ## 6 FALSE FALSE FALSE FALSE FALSE  TRUE FALSE  TRUE FALSE FALSE
> ## 7 FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE
> ## 8 FALSE  TRUE FALSE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE
> ## 9  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
>
> On Mon, Aug 31, 2015 at 2:19 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>> On Mon, 31 Aug 2015, Paul Lantos wrote:
>>
>>> Hi,
>>>
>>> I'm trying to use the cluster analysis program Flexscan, which I gather is
>>> similar to Satscan but it computes irregular clusters. This program requires
>>> a polygon adjacency matrix (termed a 'matrix definition file'). The example
>>> they provide has a row for every polygon, and for each row every neighboring
>>> polygon is listed in successive columns. So for instance if row 1 / polygon
>>> 1 has 3 neighbors there will be three polygons listed in columns 2-4.
>>>
>>> I have tried some techniques like the spatial weights matrix tools in
>>> ArcGIS and in Spatstat, but I cannot get the output in this kind of format.
>>> Was wondering if there is some obvious way to do this in R.
>>>
>>> The documentation for Flexscan is here:
>>>
>>>
>>> https://sites.google.com/site/flexscansoftware/download_e/FleXScan%20User%20Guide_e31.pdf?attredirects=0&d=1
>>
>>
>> Something like:
>>
>> library(spdep)
>> example(nc.sids)
>> out <- sapply(seq(along=ncCR85_nb), function(i) paste(attr(ncCR85_nb,
>>   "region.id")[i], paste(attr(ncCR85_nb, "region.id")[ncCR85_nb[[i]]],
>>   collapse=" ")))
>> writeLines(out, tf)
>> file.show(tf)
>>
>> See also:
>>
>> vignette("nb")
>>
>> Roger
>>
>>>
>>> Thanks for any help,
>>> Paul
>>>
>>> _______________________________________
>>> Paul M. Lantos, MD, FIDSA, FAAP, FACP
>>> Departments of Internal Medicine and Pediatrics
>>>  Pediatric Infectious Diseases
>>>  Hospital Medicine Program
>>> Duke University School of Medicine
>>> _______________________________________
>>>
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>> --
>> Roger Bivand
>> Department of Economics, Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 91 00
>> e-mail: Roger.Bivand at nhh.no
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From jan.verbesselt at wur.nl  Mon Aug 31 16:30:27 2015
From: jan.verbesselt at wur.nl (Verbesselt, Jan)
Date: Mon, 31 Aug 2015 14:30:27 +0000
Subject: [R-sig-Geo] Looking for an R package for focal statistics
 (moving window) within a 3D neighborhood
In-Reply-To: <CAAY+5UTyCJ0uEHWh+rOZXvLN1pmT6LLJV2svS+8Pn34im_901w@mail.gmail.com>
References: <CAAY+5UTyCJ0uEHWh+rOZXvLN1pmT6LLJV2svS+8Pn34im_901w@mail.gmail.com>
Message-ID: <D20A3180.2BEC3%jan.verbesselt@wur.nl>

Check out GRASS functionality

https://grasswiki.osgeo.org/wiki/LIDAR

which can be very efficient as nicely combined with R via

https://grasswiki.osgeo.org/wiki/R_statistics
 

Cheers,
Jan

---
www.wageningenur.nl/changemonitor




On 31/08/15 10:43, "R-sig-Geo on behalf of Jose Tanago"
<r-sig-geo-bounces at r-project.org on behalf of josetanago at gmail.com> wrote:

>I am writing an algorithm in R for 3D point data sets (centers of voxels),
>read as an R data.frame  with 4 columns (x,y,z values and an attribute).
>They can be big (e.g. millions rows).
>
>I am trying to find any R package that has any function for computing a 3D
>neighborhood (filter or statistics,...). If such funtion{package}  already
>exists it would be great!, but if not, at least any function from a
>non-spatial R-package that could be useful to build an ad-hoc 3D
>neighborhood function might work as well.
>
>Does anyone know a preexisting R package that has a neighborhood
>function?,
>or any tips how could be implemented with other packages (customizing or
>building from a more generic package)??
>
>The problem that the function would help: Check the values of the
>attribute
>column for all the points within a 3D neighborhood from any point (any
>instance in the data.frame differing less than  "a" value in X,Y,Z,
>coordinates). (i.e. A sort of moving window for a raster but in a 3D
>neighborhood). Then, transform the "cell" or 3D point attribute value, if
>a
>condition is fulfilled for any of the 3D neighbors.
>
>If there is no package with a 3D neighborhood function, I though maybe is
>possible to create a custom function that for each instance (point)
>evaluates all others points XYZ  in the data.frame and computing a
>neighborhood attribute value by selecting only the ones within a distance
>in XYZ. But I am not very sure how to make something like this in a
>reasonable way, I guess evaluating all other points xyz will take very
>long
>with millions rows.
>
>Thanks a lot for any idea!
>
>Jose Tanago
>
>Lab. of Remote Sensing, Wageningen University
>
>	[[alternative HTML version deleted]]
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo


