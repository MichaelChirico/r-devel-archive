From jo@|@h@p@rry @end|ng |rom gm@||@com  Sun Feb  4 23:30:38 2024
From: jo@|@h@p@rry @end|ng |rom gm@||@com (Josiah Parry)
Date: Sun, 4 Feb 2024 17:30:38 -0500
Subject: [R-sig-Geo] New maintainer needed {sfdep}
Message-ID: <CAL3ufULh3TtXGo4sgdDtvKxCN8Tzyz9adJhbhDmz5BG_w2e5JQ@mail.gmail.com>

The R package {sfdep} which is a humble attempt at a "tidy" interface to
the mighty {spdep} needs a new maintainer. It is currently scheduled to be
archived on Feb 19th due to some notes
https://cran.r-project.org/web/checks/check_results_sfdep.html.

I am no longer able to maintain the package due to a conflict of interest.
I would greatly appreciate it if someone else would be willing to take over
the package.

If you are interested, please do let me know!

Thank you,

Josiah

	[[alternative HTML version deleted]]


From Roger@B|v@nd @end|ng |rom nhh@no  Mon Feb  5 20:03:08 2024
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Mon, 5 Feb 2024 19:03:08 +0000
Subject: [R-sig-Geo] New maintainer needed {sfdep}
In-Reply-To: <CAL3ufULh3TtXGo4sgdDtvKxCN8Tzyz9adJhbhDmz5BG_w2e5JQ@mail.gmail.com>
References: <CAL3ufULh3TtXGo4sgdDtvKxCN8Tzyz9adJhbhDmz5BG_w2e5JQ@mail.gmail.com>
Message-ID: <SV0P279MB0475795EF6FBD4260B436C48EE472@SV0P279MB0475.NORP279.PROD.OUTLOOK.COM>

I would encourage someone committed to raising their package maintenance skills to take over from Josiah.

I've created a PR https://github.com/JosiahParry/sfdep/pull/43 bringing the github repo into submittable shape, so if Josiah could check my updates and if OK submit, the person taking on maintenance would not have an immediate fire to extinguish - the PR contains check logs for R released and development passing OK now.

So if you (single, plural) feel curious, please give sfdep consideration. Josiah does have plenty of other R-relevant work in his current role, and does have a conflict of interest, as he said.

Roger

--
Roger Bivand
Emeritus Professor
Norwegian School of Economics
Postboks 3490 Ytre Sandviken, 5045 Bergen, Norway
Roger.Bivand at nhh.no

________________________________________
From: R-sig-Geo <r-sig-geo-bounces at r-project.org> on behalf of Josiah Parry <josiah.parry at gmail.com>
Sent: 04 February 2024 23:30
To: r-sig-Geo at r-project.org
Subject: [R-sig-Geo] New maintainer needed {sfdep}

[You don't often get email from josiah.parry at gmail.com. Learn why this is important at https://aka.ms/LearnAboutSenderIdentification ]

The R package {sfdep} which is a humble attempt at a "tidy" interface to
the mighty {spdep} needs a new maintainer. It is currently scheduled to be
archived on Feb 19th due to some notes
https://cran.r-project.org/web/checks/check_results_sfdep.html.

I am no longer able to maintain the package due to a conflict of interest.
I would greatly appreciate it if someone else would be willing to take over
the package.

If you are interested, please do let me know!

Thank you,

Josiah

        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From jo@|@h@p@rry @end|ng |rom gm@||@com  Mon Feb  5 20:54:22 2024
From: jo@|@h@p@rry @end|ng |rom gm@||@com (Josiah Parry)
Date: Mon, 5 Feb 2024 14:54:22 -0500
Subject: [R-sig-Geo] New maintainer needed {sfdep}
In-Reply-To: <SV0P279MB0475795EF6FBD4260B436C48EE472@SV0P279MB0475.NORP279.PROD.OUTLOOK.COM>
References: <CAL3ufULh3TtXGo4sgdDtvKxCN8Tzyz9adJhbhDmz5BG_w2e5JQ@mail.gmail.com>
 <SV0P279MB0475795EF6FBD4260B436C48EE472@SV0P279MB0475.NORP279.PROD.OUTLOOK.COM>
Message-ID: <CAL3ufULDgXAzEyVW20ffU30EX7DAZXfE1UcArkzcS5M9-G8m6g@mail.gmail.com>

Thank you very much Roger! And thank you to the handful of folks who have
reached out.

For further context, I am happy to help out providing guidance and pull
request reviews but I am not able to actively contribute. I won?t leave you
all on your own! ?

On Mon, Feb 5, 2024 at 14:03 Roger Bivand <Roger.Bivand at nhh.no> wrote:

> I would encourage someone committed to raising their package maintenance
> skills to take over from Josiah.
>
> I've created a PR https://github.com/JosiahParry/sfdep/pull/43 bringing
> the github repo into submittable shape, so if Josiah could check my updates
> and if OK submit, the person taking on maintenance would not have an
> immediate fire to extinguish - the PR contains check logs for R released
> and development passing OK now.
>
> So if you (single, plural) feel curious, please give sfdep consideration.
> Josiah does have plenty of other R-relevant work in his current role, and
> does have a conflict of interest, as he said.
>
> Roger
>
> --
> Roger Bivand
> Emeritus Professor
> Norwegian School of Economics
> Postboks 3490 Ytre Sandviken, 5045 Bergen, Norway
> Roger.Bivand at nhh.no
>
> ________________________________________
> From: R-sig-Geo <r-sig-geo-bounces at r-project.org> on behalf of Josiah
> Parry <josiah.parry at gmail.com>
> Sent: 04 February 2024 23:30
> To: r-sig-Geo at r-project.org
> Subject: [R-sig-Geo] New maintainer needed {sfdep}
>
> [You don't often get email from josiah.parry at gmail.com. Learn why this is
> important at https://aka.ms/LearnAboutSenderIdentification ]
>
> The R package {sfdep} which is a humble attempt at a "tidy" interface to
> the mighty {spdep} needs a new maintainer. It is currently scheduled to be
> archived on Feb 19th due to some notes
> https://cran.r-project.org/web/checks/check_results_sfdep.html.
>
> I am no longer able to maintain the package due to a conflict of interest.
> I would greatly appreciate it if someone else would be willing to take over
> the package.
>
> If you are interested, please do let me know!
>
> Thank you,
>
> Josiah
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From ELe@@m@n @end|ng |rom mb@rd@org  Wed Feb  7 01:37:09 2024
From: ELe@@m@n @end|ng |rom mb@rd@org (Eli Lessman)
Date: Wed, 7 Feb 2024 00:37:09 +0000
Subject: [R-sig-Geo] Fire Loss Rate and Blue Sky Playground - RE: R-sig-Geo
 Digest, Vol 245, Issue 6
In-Reply-To: <mailman.29366.3.1706698801.4126.r-sig-geo@r-project.org>
References: <mailman.29366.3.1706698801.4126.r-sig-geo@r-project.org>
Message-ID: <BYAPR10MB32057C50A5222D90858097BED8452@BYAPR10MB3205.namprd10.prod.outlook.com>

Hi,

These may be helpful as well:
https://www.sciencedirect.com/science/article/pii/S2215016123002352
https://tools.airfire.org/playground/v3.5/emissionsinputs.php (this is multiple models in web browser format not R)

Best,

Eli Lessman
Air Quality Planner I
Monterey Bay Air Resources District
831-718-8029





-----Original Message-----
From: R-sig-Geo <r-sig-geo-bounces at r-project.org> On Behalf Of r-sig-geo-request at r-project.org
Sent: Wednesday, January 31, 2024 3:00 AM
To: r-sig-geo at r-project.org
Subject: R-sig-Geo Digest, Vol 245, Issue 6

Send R-sig-Geo mailing list submissions to
	r-sig-geo at r-project.org

To subscribe or unsubscribe via the World Wide Web, visit
	https://stat.ethz.ch/mailman/listinfo/r-sig-geo
or, via email, send a message with subject or body 'help' to
	r-sig-geo-request at r-project.org

You can reach the person managing the list at
	r-sig-geo-owner at r-project.org

When replying, please edit your Subject line so it is more specific than "Re: Contents of R-sig-Geo digest..."


Today's Topics:

   1. Re:  Recommendations for wildfire risk analysis (spatially
      explicit) (=?UTF-8?Q?Manuel_Sp=C3=ADnola?=)

----------------------------------------------------------------------

Message: 1
Date: Tue, 30 Jan 2024 10:45:59 -0600
From: =?UTF-8?Q?Manuel_Sp=C3=ADnola?= <mspinola10 at gmail.com>
To: Dexter Locke <dexter.locke at gmail.com>
Cc: Ben Tupper <btupper at bigelow.org>, r-sig-geo
	<r-sig-geo at r-project.org>
Subject: Re: [R-sig-Geo]  Recommendations for wildfire risk analysis
	(spatially explicit)
Message-ID:
	<CABkCotSdiGH0zWzxCTgbT=wP83QP=YaAY9Nh3UqMVs5fxoJLQg at mail.gmail.com>
Content-Type: text/plain; charset="utf-8"

Thank you very much.

Manuel

El lun, 22 ene 2024 a las 19:13, Dexter Locke (<dexter.locke at gmail.com>)
escribi?:

>
> Possibly helpful:
> https://www.publish.csiro.au/WF/WF21176
> https://www.fs.usda.gov/research/treesearch/67085
>
> -Dexter
>
>
>
>
>
> On Sun, Jan 21, 2024 at 9:36?PM Ben Tupper <btupper at bigelow.org> wrote:
>
>> Hi,
>>
>> Perhaps this might be a good place to start?
>>
>> https://esajournals.onlinelibrary.wiley.com/doi/10.1002/eap.1898  The 
>> authors state that the work was done primarily in R.
>>
>> Cheers,
>> Ben
>>
>>
>> On Sat, Jan 20, 2024 at 9:43?AM Manuel Sp?nola <mspinola10 at gmail.com>
>> wrote:
>> >
>> > Dear list members,
>> >
>> > I am looking for suggestions for R packages or an approach using R 
>> > for wildfire risk analysis.
>> >
>> > Manuel
>> >
>> > --
>> > *Manuel Sp?nola, Ph.D.*
>> > Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre 
>> > Universidad Nacional Apartado 1350-3000 Heredia COSTA RICA 
>> > mspinola at una.cr <mspinola at una.ac.cr> mspinola10 at gmail.com
>> > Tel?fono: (506) 8706 - 4662
>> > Sitio web institucional: ICOMVIS
>> > <http://www.icomvis.una.ac.cr/index.php/manuel>
>> > Sitio web personal: Sitio personal <
>> https://mspinola-sitioweb.netlify.app>
>> > Blog sobre Ciencia de Datos: Blog de Ciencia de Datos 
>> > <https://mspinola-ciencia-de-datos.netlify.app>
>> >
>> >         [[alternative HTML version deleted]]
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at r-project.org
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>

--
*Manuel Sp?nola, Ph.D.*
Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre Universidad Nacional Apartado 1350-3000 Heredia COSTA RICA mspinola at una.cr <mspinola at una.ac.cr> mspinola10 at gmail.com
Tel?fono: (506) 8706 - 4662
Sitio web institucional: ICOMVIS
<http://www.icomvis.una.ac.cr/index.php/manuel>
Sitio web personal: Sitio personal <https://mspinola-sitioweb.netlify.app>
Blog sobre Ciencia de Datos: Blog de Ciencia de Datos <https://mspinola-ciencia-de-datos.netlify.app>

	[[alternative HTML version deleted]]




------------------------------

Subject: Digest Footer

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


------------------------------

End of R-sig-Geo Digest, Vol 245, Issue 6
*****************************************

From xchen @end|ng |rom ||ve@no  Wed Feb  7 17:37:41 2024
From: xchen @end|ng |rom ||ve@no (Xianwen Chen)
Date: Wed, 7 Feb 2024 16:37:41 +0000
Subject: [R-sig-Geo] PhD Position in Housing Market
Message-ID: <DU0P195MB2175BAE04C5519AFEDAED842BB452@DU0P195MB2175.EURP195.PROD.OUTLOOK.COM>

Dear Geo and Jobs lists,

Inland Norway University of Applied Sciences is hiring a fully funded PhD student to work on housing market / policy. Spatial analysis will likely be highly relevant as part of the research activties.

The announcement is at https://www.jobbnorge.no/en/available-jobs/job/257054/phd-research-fellowship-in-housing-market-and-housing-policy.

Please ask questions to the folks listed in the announcement.

PS: I joined the mailing lists to post this email. I'll be off the mailing lists after this. So if you want to email me, email me directly because I won't see new emails on the mailing lists.

Yours sincerely,
Xianwen

	[[alternative HTML version deleted]]


From x|@ngye @end|ng |rom bu||@|o@edu  Mon Feb 19 11:04:49 2024
From: x|@ngye @end|ng |rom bu||@|o@edu (Xiang Ye)
Date: Mon, 19 Feb 2024 10:04:49 +0000
Subject: [R-sig-Geo] How to create inward (shrinking) buffer zones with
 st_buffer()
Message-ID: <SA1PR15MB63976FD364A4C3AD2A58D8A5B0512@SA1PR15MB6397.namprd15.prod.outlook.com>

Dear community,

I am learning some basic geometry operation functions of sf package including st_buffer().

It seems there should be no wonder if I provide a negative value to the dist argument in st_buffer(), I should expect an inward/shrinking buffer zone (I also followed here: https://gis.stackexchange.com/questions/392505/can-i-use-r-to-do-a-buffer-inside-polygons-shrink-polygons-negative-buffer). However, it turn out to be as long as I provide a negative value, the output will be an empty geometry:

library(sf)
library(spDataLarge)
st_geometry(bristol_zones[1, ]) -> a    # a is the exemplary data set

> a
Geometry set for 1 feature
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: -2.534502 ymin: 51.40487 xmax: -2.488435 ymax: 51.43478
Geodetic CRS:  WGS 84
MULTIPOLYGON (((-2.510462 51.42878, -2.507985 5...
> st_buffer(a, 100)
Geometry set for 1 feature
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: -2.536248 ymin: 51.40393 xmax: -2.486907 ymax: 51.43598
Geodetic CRS:  WGS 84
POLYGON ((-2.517834 51.43188, -2.518218 51.4318...
> st_buffer(a, -100)
Geometry set for 1 feature  (with 1 geometry empty)
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
Geodetic CRS:  WGS 84
POLYGON EMPTY

So I would like to know if it is possible to create inward buffer zones with st_buffer()? If st_buffer() is not designed to perform this, what is the best alternative?

Thank you, and have a great start of the week!

$B3pfF(B YE, Xiang
THINKING SPATIALLY<http://www.linkedin.com/in/spatialyexiang>.
Ph.D. in Spatial Statistics

	[[alternative HTML version deleted]]


From b|@|ev||@t @end|ng |rom gm@||@com  Mon Feb 19 11:24:34 2024
From: b|@|ev||@t @end|ng |rom gm@||@com (=?UTF-8?Q?Bede-Fazekas_=C3=81kos?=)
Date: Mon, 19 Feb 2024 11:24:34 +0100
Subject: [R-sig-Geo] How to create inward (shrinking) buffer zones with
 st_buffer()
In-Reply-To: <SA1PR15MB63976FD364A4C3AD2A58D8A5B0512@SA1PR15MB6397.namprd15.prod.outlook.com>
References: <SA1PR15MB63976FD364A4C3AD2A58D8A5B0512@SA1PR15MB6397.namprd15.prod.outlook.com>
Message-ID: <3cd6e972-c466-4178-a044-18c4ecb498b7@gmail.com>

Dear Xiang,

sure it is possible. I suggest using a CRS that is projected, e.g. 3857 
(Web Mercator), or turn off s2 geometry. If you turn off s2, then 
st_buffer() will interpret the dist parameter in degrees. Anyway, if you 
choose a small enough number, then you'll get a non-empty geometry.

 > sf_use_s2(FALSE)
Spherical geometry (s2) switched off
 > st_buffer(a, -100)
dist is assumed to be in decimal degrees (arc_degrees).
Geometry set for 1 feature? (with 1 geometry empty)
Geometry type: POLYGON
Dimension:???? XY
Bounding box:? xmin: NA ymin: NA xmax: NA ymax: NA
Geodetic CRS:? WGS 84
POLYGON EMPTY
Warning message:
In st_buffer.sfc(a, -100) :
 ? st_buffer does not correctly buffer longitude/latitude data
 > st_buffer(a, -0.001)
dist is assumed to be in decimal degrees (arc_degrees).
Geometry set for 1 feature
Geometry type: POLYGON
Dimension:???? XY
Bounding box:? xmin: -2.533411 ymin: 51.40595 xmax: -2.489763 ymax: 51.4315
Geodetic CRS:? WGS 84
POLYGON ((-2.533083 51.41747, -2.528692 51.4204...
Warning message:
In st_buffer.sfc(a, -0.001) :
 ? st_buffer does not correctly buffer longitude/latitude data

(I don't know why s2 can't deal with negative distance if the CRS is 
WGS-84.)

HTH,
?kos
____________
?kos Bede-Fazekas
Centre for Ecological Research, Hungary

2024. 02. 19. 11:04 keltez?ssel, Xiang Ye via R-sig-Geo ?rta:
> Dear community,
>
> I am learning some basic geometry operation functions of sf package including st_buffer().
>
> It seems there should be no wonder if I provide a negative value to the dist argument in st_buffer(), I should expect an inward/shrinking buffer zone (I also followed here: https://gis.stackexchange.com/questions/392505/can-i-use-r-to-do-a-buffer-inside-polygons-shrink-polygons-negative-buffer). However, it turn out to be as long as I provide a negative value, the output will be an empty geometry:
>
> library(sf)
> library(spDataLarge)
> st_geometry(bristol_zones[1, ]) -> a    # a is the exemplary data set
>
>> a
> Geometry set for 1 feature
> Geometry type: MULTIPOLYGON
> Dimension:     XY
> Bounding box:  xmin: -2.534502 ymin: 51.40487 xmax: -2.488435 ymax: 51.43478
> Geodetic CRS:  WGS 84
> MULTIPOLYGON (((-2.510462 51.42878, -2.507985 5...
>> st_buffer(a, 100)
> Geometry set for 1 feature
> Geometry type: POLYGON
> Dimension:     XY
> Bounding box:  xmin: -2.536248 ymin: 51.40393 xmax: -2.486907 ymax: 51.43598
> Geodetic CRS:  WGS 84
> POLYGON ((-2.517834 51.43188, -2.518218 51.4318...
>> st_buffer(a, -100)
> Geometry set for 1 feature  (with 1 geometry empty)
> Geometry type: POLYGON
> Dimension:     XY
> Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
> Geodetic CRS:  WGS 84
> POLYGON EMPTY
>
> So I would like to know if it is possible to create inward buffer zones with st_buffer()? If st_buffer() is not designed to perform this, what is the best alternative?
>
> Thank you, and have a great start of the week!
>
> $B3pfF(B YE, Xiang
> THINKING SPATIALLY<http://www.linkedin.com/in/spatialyexiang>.
> Ph.D. in Spatial Statistics
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


-- 
Ezt az e-mailt ?tvizsg?lta az Avast AntiVirus szoftver.
www.avast.com


From x|@ngye @end|ng |rom bu||@|o@edu  Mon Feb 19 18:00:39 2024
From: x|@ngye @end|ng |rom bu||@|o@edu (Xiang Ye)
Date: Mon, 19 Feb 2024 17:00:39 +0000
Subject: [R-sig-Geo] How to create inward (shrinking) buffer zones with
 st_buffer()
In-Reply-To: <3cd6e972-c466-4178-a044-18c4ecb498b7@gmail.com>
References: <SA1PR15MB63976FD364A4C3AD2A58D8A5B0512@SA1PR15MB6397.namprd15.prod.outlook.com>
 <3cd6e972-c466-4178-a044-18c4ecb498b7@gmail.com>
Message-ID: <SA1PR15MB6397957BE11D32B9DE84BE3AB0512@SA1PR15MB6397.namprd15.prod.outlook.com>

Dear ?kos,

Thank you so much for your quick and detailed reply!
I did not know about Google s2geometry.io library before, but now I noticed its impact on the sf package.

Have a great one!

?? YE, Xiang
THINKING SPATIALLY<http://www.linkedin.com/in/spatialyexiang>.
Ph.D. in Spatial Statistics
________________________________
From: R-sig-Geo <r-sig-geo-bounces at r-project.org> on behalf of Bede-Fazekas ?kos <bfalevlist at gmail.com>
Sent: Monday, February 19, 2024 18:24
To: r-sig-geo at r-project.org <r-sig-geo at r-project.org>
Subject: Re: [R-sig-Geo] How to create inward (shrinking) buffer zones with st_buffer()

[You don't often get email from bfalevlist at gmail.com. Learn why this is important at https://aka.ms/LearnAboutSenderIdentification ]

Dear Xiang,

sure it is possible. I suggest using a CRS that is projected, e.g. 3857
(Web Mercator), or turn off s2 geometry. If you turn off s2, then
st_buffer() will interpret the dist parameter in degrees. Anyway, if you
choose a small enough number, then you'll get a non-empty geometry.

 > sf_use_s2(FALSE)
Spherical geometry (s2) switched off
 > st_buffer(a, -100)
dist is assumed to be in decimal degrees (arc_degrees).
Geometry set for 1 feature  (with 1 geometry empty)
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
Geodetic CRS:  WGS 84
POLYGON EMPTY
Warning message:
In st_buffer.sfc(a, -100) :
   st_buffer does not correctly buffer longitude/latitude data
 > st_buffer(a, -0.001)
dist is assumed to be in decimal degrees (arc_degrees).
Geometry set for 1 feature
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: -2.533411 ymin: 51.40595 xmax: -2.489763 ymax: 51.4315
Geodetic CRS:  WGS 84
POLYGON ((-2.533083 51.41747, -2.528692 51.4204...
Warning message:
In st_buffer.sfc(a, -0.001) :
   st_buffer does not correctly buffer longitude/latitude data

(I don't know why s2 can't deal with negative distance if the CRS is
WGS-84.)

HTH,
?kos
____________
?kos Bede-Fazekas
Centre for Ecological Research, Hungary

2024. 02. 19. 11:04 keltez?ssel, Xiang Ye via R-sig-Geo ?rta:
> Dear community,
>
> I am learning some basic geometry operation functions of sf package including st_buffer().
>
> It seems there should be no wonder if I provide a negative value to the dist argument in st_buffer(), I should expect an inward/shrinking buffer zone (I also followed here: https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgis.stackexchange.com%2Fquestions%2F392505%2Fcan-i-use-r-to-do-a-buffer-inside-polygons-shrink-polygons-negative-buffer&data=05%7C02%7Cxiangye%40buffalo.edu%7C3442c930a8b649158f2a08dc3135888f%7C96464a8af8ed40b199e25f6b50a20250%7C0%7C0%7C638439353229473724%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=O%2FqzCFqVDv2%2FmjZWZTjLgYx73eq%2FxYVMz5yQKUW5jWw%3D&reserved=0)<https://gis.stackexchange.com/questions/392505/can-i-use-r-to-do-a-buffer-inside-polygons-shrink-polygons-negative-buffer>. However, it turn out to be as long as I provide a negative value, the output will be an empty geometry:
>
> library(sf)
> library(spDataLarge)
> st_geometry(bristol_zones[1, ]) -> a    # a is the exemplary data set
>
>> a
> Geometry set for 1 feature
> Geometry type: MULTIPOLYGON
> Dimension:     XY
> Bounding box:  xmin: -2.534502 ymin: 51.40487 xmax: -2.488435 ymax: 51.43478
> Geodetic CRS:  WGS 84
> MULTIPOLYGON (((-2.510462 51.42878, -2.507985 5...
>> st_buffer(a, 100)
> Geometry set for 1 feature
> Geometry type: POLYGON
> Dimension:     XY
> Bounding box:  xmin: -2.536248 ymin: 51.40393 xmax: -2.486907 ymax: 51.43598
> Geodetic CRS:  WGS 84
> POLYGON ((-2.517834 51.43188, -2.518218 51.4318...
>> st_buffer(a, -100)
> Geometry set for 1 feature  (with 1 geometry empty)
> Geometry type: POLYGON
> Dimension:     XY
> Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
> Geodetic CRS:  WGS 84
> POLYGON EMPTY
>
> So I would like to know if it is possible to create inward buffer zones with st_buffer()? If st_buffer() is not designed to perform this, what is the best alternative?
>
> Thank you, and have a great start of the week!
>
> $B3pfF(B YE, Xiang
> THINKING SPATIALLY<https://nam12.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.linkedin.com%2Fin%2Fspatialyexiang&data=05%7C02%7Cxiangye%40buffalo.edu%7C3442c930a8b649158f2a08dc3135888f%7C96464a8af8ed40b199e25f6b50a20250%7C0%7C0%7C638439353229481810%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=LI5uCDlgSC09%2BWqxLiZOTzTQs2dKFZ3wybiWz2Txp8w%3D&reserved=0<http://www.linkedin.com/in/spatialyexiang>>.
> Ph.D. in Spatial Statistics
>
>       [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-geo&data=05%7C02%7Cxiangye%40buffalo.edu%7C3442c930a8b649158f2a08dc3135888f%7C96464a8af8ed40b199e25f6b50a20250%7C0%7C0%7C638439353229485219%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=ZoOpUVvjOBdGRse3srYQwn33b46RCgiic9OKcoEBDys%3D&reserved=0<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>


--
Ezt az e-mailt ?tvizsg?lta az Avast AntiVirus szoftver.
https://nam12.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.avast.com%2F&data=05%7C02%7Cxiangye%40buffalo.edu%7C3442c930a8b649158f2a08dc3135888f%7C96464a8af8ed40b199e25f6b50a20250%7C0%7C0%7C638439353229488426%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=0bOAAX%2FUAXJxbqmgaqgi2CWt9hUpQPXfSx%2FWjufMiR8%3D&reserved=0<http://www.avast.com/>

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-geo&data=05%7C02%7Cxiangye%40buffalo.edu%7C3442c930a8b649158f2a08dc3135888f%7C96464a8af8ed40b199e25f6b50a20250%7C0%7C0%7C638439353229493290%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=X%2FOjP9Oy7Xe%2BwnqpObNLx0ct3R5HXQraeyjlQ2Cl3m0%3D&reserved=0<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>

	[[alternative HTML version deleted]]


From n|ck @end|ng |rom geo@p@t|@|tr@|n|ng@o|ut|on@@co@uk  Thu Feb 22 17:28:28 2024
From: n|ck @end|ng |rom geo@p@t|@|tr@|n|ng@o|ut|on@@co@uk (Nick Bearman)
Date: Thu, 22 Feb 2024 16:28:28 +0000
Subject: [R-sig-Geo] How to create inward (shrinking) buffer zones with
 st_buffer()
In-Reply-To: <SA1PR15MB63976FD364A4C3AD2A58D8A5B0512@SA1PR15MB6397.namprd15.prod.outlook.com>
References: <SA1PR15MB63976FD364A4C3AD2A58D8A5B0512@SA1PR15MB6397.namprd15.prod.outlook.com>
Message-ID: <001eda80-257e-4637-9f71-face82c545b3@geospatialtrainingsolutions.co.uk>

Dear Xiang,

I've not had a chance to try your code, but your example probably won't 
work with the CRS set to WGS84. The buffer will use the units of the 
coordinate system, so degrees, which will be far too large for the 
bristol_zones example.

Assuming bristol_zones are in the UK, you need to reproject to BNG - 27700.

Also I am not sure whether bristol_zones from spDataLarge are in sp or 
sf format.

Once those are addressed - I see no reason why the example in the Stack 
Exchange should work.

Best wishes,
Nick.

On 19/02/2024 10:04, Xiang Ye via R-sig-Geo wrote:
> Dear community,
>
> I am learning some basic geometry operation functions of sf package including st_buffer().
>
> It seems there should be no wonder if I provide a negative value to the dist argument in st_buffer(), I should expect an inward/shrinking buffer zone (I also followed here: https://gis.stackexchange.com/questions/392505/can-i-use-r-to-do-a-buffer-inside-polygons-shrink-polygons-negative-buffer). However, it turn out to be as long as I provide a negative value, the output will be an empty geometry:
>
> library(sf)
> library(spDataLarge)
> st_geometry(bristol_zones[1, ]) -> a    # a is the exemplary data set
>
>> a
> Geometry set for 1 feature
> Geometry type: MULTIPOLYGON
> Dimension:     XY
> Bounding box:  xmin: -2.534502 ymin: 51.40487 xmax: -2.488435 ymax: 51.43478
> Geodetic CRS:  WGS 84
> MULTIPOLYGON (((-2.510462 51.42878, -2.507985 5...
>> st_buffer(a, 100)
> Geometry set for 1 feature
> Geometry type: POLYGON
> Dimension:     XY
> Bounding box:  xmin: -2.536248 ymin: 51.40393 xmax: -2.486907 ymax: 51.43598
> Geodetic CRS:  WGS 84
> POLYGON ((-2.517834 51.43188, -2.518218 51.4318...
>> st_buffer(a, -100)
> Geometry set for 1 feature  (with 1 geometry empty)
> Geometry type: POLYGON
> Dimension:     XY
> Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
> Geodetic CRS:  WGS 84
> POLYGON EMPTY
>
> So I would like to know if it is possible to create inward buffer zones with st_buffer()? If st_buffer() is not designed to perform this, what is the best alternative?
>
> Thank you, and have a great start of the week!
>
> $B3pfF(B YE, Xiang
> THINKING SPATIALLY<http://www.linkedin.com/in/spatialyexiang>.
> Ph.D. in Spatial Statistics
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
-- 
Nick Bearman
+44 (0) 7717745715
nick at geospatialtrainingsolutions.co.uk

Please let me know if I can make any adjustments related to disability or neurodivergence to improve how we interact.

Due to my own life/work balance, you may get emails from me outside of normal working hours. Please do not feel any pressure to respond outside of your own working pattern.


From henry@@p@t|@|@@n@|y@|@ @end|ng |rom gm@||@com  Thu Feb 22 20:50:48 2024
From: henry@@p@t|@|@@n@|y@|@ @end|ng |rom gm@||@com (Nathaniel Henry)
Date: Thu, 22 Feb 2024 11:50:48 -0800
Subject: [R-sig-Geo] Fwd: How to create inward (shrinking) buffer zones with
 st_buffer()
In-Reply-To: <CA+x7ZoshWTgv2s=4PHiT+ADhNtHB8_hahbhwuMyWFFhmeua89A@mail.gmail.com>
References: <SA1PR15MB63976FD364A4C3AD2A58D8A5B0512@SA1PR15MB6397.namprd15.prod.outlook.com>
 <001eda80-257e-4637-9f71-face82c545b3@geospatialtrainingsolutions.co.uk>
 <CA+x7ZoshWTgv2s=4PHiT+ADhNtHB8_hahbhwuMyWFFhmeua89A@mail.gmail.com>
Message-ID: <CA+x7ZotPRkynw8eOVEMPZ1v1c8tDNpVKbNEY8ViyiDU36z+8Cw@mail.gmail.com>

Hi Xiang,

As an alternative, you could just convert the polygon boundaries to lines,
buffer those lines, and remove them from the original polygons. I think
this will work regardless of your CRS/s2 settings, and you don't have to
worry about how the buffer function is handling negative distance
internally.

Example:
bristol_polys <- sf::st_read(
  "
https://martinjc.github.io/UK-GeoJSON/json/eng/wards_by_lad/topo_E06000023.json
",
  crs = 'EPSG:4326'
) |> sf::st_transform(crs = 'EPSG:27700')
# Convert to polylines and buffer
buffered_lines <- sf::st_cast(bristol_polys, to = 'MULTILINESTRING') |>
  sf::st_make_valid() |>
  sf::st_buffer(dist = units::set_units(100, 'm')) |>
  sf::st_union()
# Remove the buffers from the polygons
shrunk_polygons <- sf::st_difference(x = bristol_polys, y = buffered_lines)

Best,
Nat
--
*Nathaniel Henry, DPhil*
Henry Spatial Analysis <https://henryspatialanalysis.com/>
*Cell: +1-341-226-6277*

On Thu, 22 Feb 2024 at 08:28, Nick Bearman <
nick at geospatialtrainingsolutions.co.uk> wrote:

> Dear Xiang,
>
> I've not had a chance to try your code, but your example probably won't
> work with the CRS set to WGS84. The buffer will use the units of the
> coordinate system, so degrees, which will be far too large for the
> bristol_zones example.
>
> Assuming bristol_zones are in the UK, you need to reproject to BNG - 27700.
>
> Also I am not sure whether bristol_zones from spDataLarge are in sp or
> sf format.
>
> Once those are addressed - I see no reason why the example in the Stack
> Exchange should work.
>
> Best wishes,
> Nick.
>
> On 19/02/2024 10:04, Xiang Ye via R-sig-Geo wrote:
> > Dear community,
> >
> > I am learning some basic geometry operation functions of sf package
> including st_buffer().
> >
> > It seems there should be no wonder if I provide a negative value to the
> dist argument in st_buffer(), I should expect an inward/shrinking buffer
> zone (I also followed here:
> https://gis.stackexchange.com/questions/392505/can-i-use-r-to-do-a-buffer-inside-polygons-shrink-polygons-negative-buffer).
> However, it turn out to be as long as I provide a negative value, the
> output will be an empty geometry:
> >
> > library(sf)
> > library(spDataLarge)
> > st_geometry(bristol_zones[1, ]) -> a    # a is the exemplary data set
> >
> >> a
> > Geometry set for 1 feature
> > Geometry type: MULTIPOLYGON
> > Dimension:     XY
> > Bounding box:  xmin: -2.534502 ymin: 51.40487 xmax: -2.488435 ymax:
> 51.43478
> > Geodetic CRS:  WGS 84
> > MULTIPOLYGON (((-2.510462 51.42878, -2.507985 5...
> >> st_buffer(a, 100)
> > Geometry set for 1 feature
> > Geometry type: POLYGON
> > Dimension:     XY
> > Bounding box:  xmin: -2.536248 ymin: 51.40393 xmax: -2.486907 ymax:
> 51.43598
> > Geodetic CRS:  WGS 84
> > POLYGON ((-2.517834 51.43188, -2.518218 51.4318...
> >> st_buffer(a, -100)
> > Geometry set for 1 feature  (with 1 geometry empty)
> > Geometry type: POLYGON
> > Dimension:     XY
> > Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
> > Geodetic CRS:  WGS 84
> > POLYGON EMPTY
> >
> > So I would like to know if it is possible to create inward buffer zones
> with st_buffer()? If st_buffer() is not designed to perform this, what is
> the best alternative?
> >
> > Thank you, and have a great start of the week!
> >
> > ?? YE, Xiang
> > THINKING SPATIALLY<http://www.linkedin.com/in/spatialyexiang>.
> > Ph.D. in Spatial Statistics
> >
> >       [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> --
> Nick Bearman
> +44 (0) 7717745715
> nick at geospatialtrainingsolutions.co.uk
>
> Please let me know if I can make any adjustments related to disability or
> neurodivergence to improve how we interact.
>
> Due to my own life/work balance, you may get emails from me outside of
> normal working hours. Please do not feel any pressure to respond outside of
> your own working pattern.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From x|@ngye @end|ng |rom bu||@|o@edu  Sun Feb 25 17:57:50 2024
From: x|@ngye @end|ng |rom bu||@|o@edu (Xiang Ye)
Date: Sun, 25 Feb 2024 16:57:50 +0000
Subject: [R-sig-Geo] How to create inward (shrinking) buffer zones with
 st_buffer()
In-Reply-To: <001eda80-257e-4637-9f71-face82c545b3@geospatialtrainingsolutions.co.uk>
References: <SA1PR15MB63976FD364A4C3AD2A58D8A5B0512@SA1PR15MB6397.namprd15.prod.outlook.com>
 <001eda80-257e-4637-9f71-face82c545b3@geospatialtrainingsolutions.co.uk>
Message-ID: <SA1PR15MB6397D561BE1C7E9BDB79E824B05B2@SA1PR15MB6397.namprd15.prod.outlook.com>

Dear Nick,

Thank you for your reply! And I agree with several points mentioned in your email, as the geographic coordinate system is not the best CRS to generate a buffer zone. According to the guide from previous replies to my question, I turned off the Google s2 geometry library by setting sf_use_s2(FALSE) then st_buffer() will interpret the dist argument in degrees.

Btw, as suggested by class(bristol_zones), it is an sf object.

Thank you and have a great start of the week!



$B3pfF(B YE, Xiang
THINKING SPATIALLY<http://www.linkedin.com/in/spatialyexiang>.
Ph.D. in Spatial Statistics
________________________________
From: R-sig-Geo <r-sig-geo-bounces at r-project.org> on behalf of Nick Bearman <nick at geospatialtrainingsolutions.co.uk>
Sent: Friday, February 23, 2024 0:28
To: r-sig-geo at r-project.org <r-sig-geo at r-project.org>
Subject: Re: [R-sig-Geo] How to create inward (shrinking) buffer zones with st_buffer()

[You don't often get email from nick at geospatialtrainingsolutions.co.uk. Learn why this is important at https://aka.ms/LearnAboutSenderIdentification ]

Dear Xiang,

I've not had a chance to try your code, but your example probably won't
work with the CRS set to WGS84. The buffer will use the units of the
coordinate system, so degrees, which will be far too large for the
bristol_zones example.

Assuming bristol_zones are in the UK, you need to reproject to BNG - 27700.

Also I am not sure whether bristol_zones from spDataLarge are in sp or
sf format.

Once those are addressed - I see no reason why the example in the Stack
Exchange should work.

Best wishes,
Nick.

On 19/02/2024 10:04, Xiang Ye via R-sig-Geo wrote:
> Dear community,
>
> I am learning some basic geometry operation functions of sf package including st_buffer().
>
> It seems there should be no wonder if I provide a negative value to the dist argument in st_buffer(), I should expect an inward/shrinking buffer zone (I also followed here: https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgis.stackexchange.com%2Fquestions%2F392505%2Fcan-i-use-r-to-do-a-buffer-inside-polygons-shrink-polygons-negative-buffer&data=05%7C02%7Cxiangye%40buffalo.edu%7Cdfd6d699011c443c102808dc33c3555d%7C96464a8af8ed40b199e25f6b50a20250%7C0%7C0%7C638442161268034782%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=qb0R4h1gmWzIeZOaFJkjtdpylR6WprDzQcFGiJJ5rDs%3D&reserved=0)<https://gis.stackexchange.com/questions/392505/can-i-use-r-to-do-a-buffer-inside-polygons-shrink-polygons-negative-buffer>. However, it turn out to be as long as I provide a negative value, the output will be an empty geometry:
>
> library(sf)
> library(spDataLarge)
> st_geometry(bristol_zones[1, ]) -> a    # a is the exemplary data set
>
>> a
> Geometry set for 1 feature
> Geometry type: MULTIPOLYGON
> Dimension:     XY
> Bounding box:  xmin: -2.534502 ymin: 51.40487 xmax: -2.488435 ymax: 51.43478
> Geodetic CRS:  WGS 84
> MULTIPOLYGON (((-2.510462 51.42878, -2.507985 5...
>> st_buffer(a, 100)
> Geometry set for 1 feature
> Geometry type: POLYGON
> Dimension:     XY
> Bounding box:  xmin: -2.536248 ymin: 51.40393 xmax: -2.486907 ymax: 51.43598
> Geodetic CRS:  WGS 84
> POLYGON ((-2.517834 51.43188, -2.518218 51.4318...
>> st_buffer(a, -100)
> Geometry set for 1 feature  (with 1 geometry empty)
> Geometry type: POLYGON
> Dimension:     XY
> Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
> Geodetic CRS:  WGS 84
> POLYGON EMPTY
>
> So I would like to know if it is possible to create inward buffer zones with st_buffer()? If st_buffer() is not designed to perform this, what is the best alternative?
>
> Thank you, and have a great start of the week!
>
> $B3pfF(B YE, Xiang
> THINKING SPATIALLY<https://nam12.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.linkedin.com%2Fin%2Fspatialyexiang&data=05%7C02%7Cxiangye%40buffalo.edu%7Cdfd6d699011c443c102808dc33c3555d%7C96464a8af8ed40b199e25f6b50a20250%7C0%7C0%7C638442161268045734%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=fim9H15Z3SZAoak1FEbs63Ovgosr5nZVwY4MCo0npB4%3D&reserved=0<http://www.linkedin.com/in/spatialyexiang>>.
> Ph.D. in Spatial Statistics
>
>       [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-geo&data=05%7C02%7Cxiangye%40buffalo.edu%7Cdfd6d699011c443c102808dc33c3555d%7C96464a8af8ed40b199e25f6b50a20250%7C0%7C0%7C638442161268051713%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=0EAPpfFBELTd3FWmskvu18QbgNayTdtB%2BbjE4k3WIOw%3D&reserved=0<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>
--
Nick Bearman
+44 (0) 7717745715
nick at geospatialtrainingsolutions.co.uk

Please let me know if I can make any adjustments related to disability or neurodivergence to improve how we interact.

Due to my own life/work balance, you may get emails from me outside of normal working hours. Please do not feel any pressure to respond outside of your own working pattern.

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-geo&data=05%7C02%7Cxiangye%40buffalo.edu%7Cdfd6d699011c443c102808dc33c3555d%7C96464a8af8ed40b199e25f6b50a20250%7C0%7C0%7C638442161268057743%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=GTQvGRcmebqPZIn2QVAVxkdc%2F1MVpzLCHFUfsBYihjs%3D&reserved=0<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>

	[[alternative HTML version deleted]]


From x|@ngye @end|ng |rom bu||@|o@edu  Sun Feb 25 18:02:03 2024
From: x|@ngye @end|ng |rom bu||@|o@edu (Xiang Ye)
Date: Sun, 25 Feb 2024 17:02:03 +0000
Subject: [R-sig-Geo] How to create inward (shrinking) buffer zones with
 st_buffer()
In-Reply-To: <CA+x7ZoshWTgv2s=4PHiT+ADhNtHB8_hahbhwuMyWFFhmeua89A@mail.gmail.com>
References: <SA1PR15MB63976FD364A4C3AD2A58D8A5B0512@SA1PR15MB6397.namprd15.prod.outlook.com>
 <001eda80-257e-4637-9f71-face82c545b3@geospatialtrainingsolutions.co.uk>
 <CA+x7ZoshWTgv2s=4PHiT+ADhNtHB8_hahbhwuMyWFFhmeua89A@mail.gmail.com>
Message-ID: <SA1PR15MB6397FA1B96AD28F8D5E7984BB05B2@SA1PR15MB6397.namprd15.prod.outlook.com>

Dear Nathaniel,

Thank you for suggesting a new (and more advanced) way to tackle this issue. Your solution is obviously with better flexibility. In particular I appreciate your explicit adoption of units::set_units() to remove ambiguity.
Thank you for the help!

?? YE, Xiang
THINKING SPATIALLY<http://www.linkedin.com/in/spatialyexiang>.
Ph.D. in Spatial Statistics
________________________________
From: Nathaniel Henry <henry.spatial.analysis at gmail.com>
Sent: Friday, February 23, 2024 3:46
To: Xiang Ye <xiangye at buffalo.edu>
Cc: r-sig-geo at r-project.org <r-sig-geo at r-project.org>
Subject: Re: [R-sig-Geo] How to create inward (shrinking) buffer zones with st_buffer()

You don't often get email from henry.spatial.analysis at gmail.com. Learn why this is important<https://aka.ms/LearnAboutSenderIdentification>
Hi Xiang,

As an alternative, you could just convert the polygon boundaries to lines, buffer those lines, and remove them from the original polygons. I think this will work regardless of your CRS/s2 settings, and you don't have to worry about how the buffer function is handling negative distance internally.

Example:
bristol_polys <- sf::st_read(
  "https://martinjc.github.io/UK-GeoJSON/json/eng/wards_by_lad/topo_E06000023.json",
  crs = 'EPSG:4326'
) |> sf::st_transform(crs = 'EPSG:27700')
# Convert to polylines and buffer
buffered_lines <- sf::st_cast(bristol_polys, to = 'MULTILINESTRING') |>
  sf::st_make_valid() |>
  sf::st_buffer(dist = units::set_units(100, 'm')) |>
  sf::st_union()
# Remove the buffers from the polygons
shrunk_polygons <- sf::st_difference(x = bristol_polys, y = buffered_lines)

Yields:
[image.png]

Best,
Nat
--
Nathaniel Henry, DPhil
Henry Spatial Analysis<https://henryspatialanalysis.com/>
Cell: +1-341-226-6277

On Thu, 22 Feb 2024 at 08:28, Nick Bearman <nick at geospatialtrainingsolutions.co.uk<mailto:nick at geospatialtrainingsolutions.co.uk>> wrote:
Dear Xiang,

I've not had a chance to try your code, but your example probably won't
work with the CRS set to WGS84. The buffer will use the units of the
coordinate system, so degrees, which will be far too large for the
bristol_zones example.

Assuming bristol_zones are in the UK, you need to reproject to BNG - 27700.

Also I am not sure whether bristol_zones from spDataLarge are in sp or
sf format.

Once those are addressed - I see no reason why the example in the Stack
Exchange should work.

Best wishes,
Nick.

On 19/02/2024 10:04, Xiang Ye via R-sig-Geo wrote:
> Dear community,
>
> I am learning some basic geometry operation functions of sf package including st_buffer().
>
> It seems there should be no wonder if I provide a negative value to the dist argument in st_buffer(), I should expect an inward/shrinking buffer zone (I also followed here: https://gis.stackexchange.com/questions/392505/can-i-use-r-to-do-a-buffer-inside-polygons-shrink-polygons-negative-buffer). However, it turn out to be as long as I provide a negative value, the output will be an empty geometry:
>
> library(sf)
> library(spDataLarge)
> st_geometry(bristol_zones[1, ]) -> a    # a is the exemplary data set
>
>> a
> Geometry set for 1 feature
> Geometry type: MULTIPOLYGON
> Dimension:     XY
> Bounding box:  xmin: -2.534502 ymin: 51.40487 xmax: -2.488435 ymax: 51.43478
> Geodetic CRS:  WGS 84
> MULTIPOLYGON (((-2.510462 51.42878, -2.507985 5...
>> st_buffer(a, 100)
> Geometry set for 1 feature
> Geometry type: POLYGON
> Dimension:     XY
> Bounding box:  xmin: -2.536248 ymin: 51.40393 xmax: -2.486907 ymax: 51.43598
> Geodetic CRS:  WGS 84
> POLYGON ((-2.517834 51.43188, -2.518218 51.4318...
>> st_buffer(a, -100)
> Geometry set for 1 feature  (with 1 geometry empty)
> Geometry type: POLYGON
> Dimension:     XY
> Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
> Geodetic CRS:  WGS 84
> POLYGON EMPTY
>
> So I would like to know if it is possible to create inward buffer zones with st_buffer()? If st_buffer() is not designed to perform this, what is the best alternative?
>
> Thank you, and have a great start of the week!
>
> ?? YE, Xiang
> THINKING SPATIALLY<http://www.linkedin.com/in/spatialyexiang>.
> Ph.D. in Spatial Statistics
>
>       [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
--
Nick Bearman
+44 (0) 7717745715
nick at geospatialtrainingsolutions.co.uk<mailto:nick at geospatialtrainingsolutions.co.uk>

Please let me know if I can make any adjustments related to disability or neurodivergence to improve how we interact.

Due to my own life/work balance, you may get emails from me outside of normal working hours. Please do not feel any pressure to respond outside of your own working pattern.

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20240225/dc5847a2/attachment.html>

-------------- next part --------------
A non-text attachment was scrubbed...
Name: image.png
Type: image/png
Size: 49074 bytes
Desc: image.png
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20240225/dc5847a2/attachment.png>

From jochen@@|brecht @end|ng |rom gm@||@com  Tue Feb 27 01:40:20 2024
From: jochen@@|brecht @end|ng |rom gm@||@com (Jochen Albrecht)
Date: Mon, 26 Feb 2024 19:40:20 -0500
Subject: [R-sig-Geo] Attempt to set index in SET_STRING_ELT
Message-ID: <CAKRQQ2RR92e2+oXac8=KpCDDMhr+f-aYmBN9u+AdhV6BGeRs0w@mail.gmail.com>

I am getting the same kind of error working with stplanr (using function
route_dodgr) as well as osmdata (using function osmdata_sf), which lets me
assume that the latter is the culprit. The error is "attempt to set index
2786142150/2786142150 in SET_STRING_ELT". The index number is a little
different, although in both instances, we are talking about a value in the
2 billion range.
The error message is not terribly illuminating. Does anyone know what is
causing it, and even better, how to work around it?

In the case of the osmdata function, I tried to download a road dataset for
a four-county region in the (SanFran) Bay Area. I have previously
successfully downloaded the OSM road network for a larger extent of the
same geography (albeit directly rather than using the osmdata package).

Dr. Jochen Albrecht, GISP (he/him/his)

Professor for Computational and Theoretical Geography

Department of Geography and Environmental Science
<http://www.geo.hunter.cuny.edu/>

Hunter College CUNY

695 Park Avenue

New York, NY 10065 Just published: GIS and Housing: Principles and Practices
<https://sites.google.com/rojasap.com/gisandhousing/>

	[[alternative HTML version deleted]]


From jo@|@h@p@rry @end|ng |rom gm@||@com  Tue Feb 27 02:02:01 2024
From: jo@|@h@p@rry @end|ng |rom gm@||@com (Josiah Parry)
Date: Mon, 26 Feb 2024 20:02:01 -0500
Subject: [R-sig-Geo] Attempt to set index in SET_STRING_ELT
In-Reply-To: <CAKRQQ2RR92e2+oXac8=KpCDDMhr+f-aYmBN9u+AdhV6BGeRs0w@mail.gmail.com>
References: <CAKRQQ2RR92e2+oXac8=KpCDDMhr+f-aYmBN9u+AdhV6BGeRs0w@mail.gmail.com>
Message-ID: <CAL3ufUKwhLt4u5yqxByRKLVDc_SHAmJF+RT_AEeOE1n=ZU=XYg@mail.gmail.com>

It sounds as if you might be using integers to index some vector. Integers
in R are 32 bit which are limited to a maximum value of 214783647 which is
actually reserved for NA values. Anything larger than that will overflow.

On Mon, Feb 26, 2024 at 19:41 Jochen Albrecht <jochen.albrecht at gmail.com>
wrote:

> I am getting the same kind of error working with stplanr (using function
> route_dodgr) as well as osmdata (using function osmdata_sf), which lets me
> assume that the latter is the culprit. The error is "attempt to set index
> 2786142150/2786142150 in SET_STRING_ELT". The index number is a little
> different, although in both instances, we are talking about a value in the
> 2 billion range.
> The error message is not terribly illuminating. Does anyone know what is
> causing it, and even better, how to work around it?
>
> In the case of the osmdata function, I tried to download a road dataset for
> a four-county region in the (SanFran) Bay Area. I have previously
> successfully downloaded the OSM road network for a larger extent of the
> same geography (albeit directly rather than using the osmdata package).
>
> Dr. Jochen Albrecht, GISP (he/him/his)
>
> Professor for Computational and Theoretical Geography
>
> Department of Geography and Environmental Science
> <http://www.geo.hunter.cuny.edu/>
>
> Hunter College CUNY
>
> 695 Park Avenue
>
> New York, NY 10065 Just published: GIS and Housing: Principles and
> Practices
> <https://sites.google.com/rojasap.com/gisandhousing/>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From Roger@B|v@nd @end|ng |rom nhh@no  Tue Feb 27 10:50:55 2024
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Tue, 27 Feb 2024 09:50:55 +0000
Subject: [R-sig-Geo] Attempt to set index in SET_STRING_ELT
In-Reply-To: <CAL3ufUKwhLt4u5yqxByRKLVDc_SHAmJF+RT_AEeOE1n=ZU=XYg@mail.gmail.com>
References: <CAKRQQ2RR92e2+oXac8=KpCDDMhr+f-aYmBN9u+AdhV6BGeRs0w@mail.gmail.com>
 <CAL3ufUKwhLt4u5yqxByRKLVDc_SHAmJF+RT_AEeOE1n=ZU=XYg@mail.gmail.com>
Message-ID: <SV0P279MB047517C1166E73894EBE681FEE592@SV0P279MB0475.NORP279.PROD.OUTLOOK.COM>

Hi,

in osmdata, osm_id is known to overflow integers, and indeed should always be represented as character: https://github.com/ropensci/osmdata/blob/a37c15268f764e57d4e0b77ee6da5fe4bc9ec3dd/R/get-osmdata-df.R#L75. Why character - would arithmetic on osm_id make sense?

With current osmdata 0.2.5, osmdata_sf() seems to return character osm_id at least for points. If this is another column, probably the same argument applies.

Checking the inputs to the failing function may show something, and traceback() after the error should show the name of the R function calling compiled code in stplanr.

Hope this helps,

Roger

--
Roger Bivand
Emeritus Professor
Norwegian School of Economics
Postboks 3490 Ytre Sandviken, 5045 Bergen, Norway
Roger.Bivand at nhh.no

________________________________________
From: R-sig-Geo <r-sig-geo-bounces at r-project.org> on behalf of Josiah Parry <josiah.parry at gmail.com>
Sent: 27 February 2024 02:02
To: jochen.albrecht at gmail.com
Cc: r-sig-geo
Subject: Re: [R-sig-Geo] Attempt to set index in SET_STRING_ELT

[You don't often get email from josiah.parry at gmail.com. Learn why this is important at https://aka.ms/LearnAboutSenderIdentification ]

It sounds as if you might be using integers to index some vector. Integers
in R are 32 bit which are limited to a maximum value of 214783647 which is
actually reserved for NA values. Anything larger than that will overflow.

On Mon, Feb 26, 2024 at 19:41 Jochen Albrecht <jochen.albrecht at gmail.com>
wrote:

> I am getting the same kind of error working with stplanr (using function
> route_dodgr) as well as osmdata (using function osmdata_sf), which lets me
> assume that the latter is the culprit. The error is "attempt to set index
> 2786142150/2786142150 in SET_STRING_ELT". The index number is a little
> different, although in both instances, we are talking about a value in the
> 2 billion range.
> The error message is not terribly illuminating. Does anyone know what is
> causing it, and even better, how to work around it?
>
> In the case of the osmdata function, I tried to download a road dataset for
> a four-county region in the (SanFran) Bay Area. I have previously
> successfully downloaded the OSM road network for a larger extent of the
> same geography (albeit directly rather than using the osmdata package).
>
> Dr. Jochen Albrecht, GISP (he/him/his)
>
> Professor for Computational and Theoretical Geography
>
> Department of Geography and Environmental Science
> <http://www.geo.hunter.cuny.edu/>
>
> Hunter College CUNY
>
> 695 Park Avenue
>
> New York, NY 10065 Just published: GIS and Housing: Principles and
> Practices
> <https://sites.google.com/rojasap.com/gisandhousing/>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From x|@ngye @end|ng |rom bu||@|o@edu  Wed Feb 28 06:04:53 2024
From: x|@ngye @end|ng |rom bu||@|o@edu (Xiang Ye)
Date: Wed, 28 Feb 2024 05:04:53 +0000
Subject: [R-sig-Geo] Unit of parameters in the expandBB argument
Message-ID: <SA1PR15MB63971EA0F4D11873C4A1965AB0582@SA1PR15MB6397.namprd15.prod.outlook.com>

Dear community,

I recently revisited the expandBB argument in the plot() function for sf objects. It conveys a numeric vector of length 4 to expand the default canvas (in the order of bottom, left, top, right) when drawing an sf object. A quick refresh is here:

https://r.geocompx.org/spatial-class#:~:text=to%20geographic%20data.-,expandBB,-%2C%20for%20example%2C%20can
[https://r.geocompx.org/images/cover.png]<https://r.geocompx.org/spatial-class#:~:text=to%20geographic%20data.-,expandBB,-%2C%20for%20example%2C%20can>
Chapter 2 Geographic data in R | Geocomputation with R<https://r.geocompx.org/spatial-class#:~:text=to%20geographic%20data.-,expandBB,-%2C%20for%20example%2C%20can>
Prerequisites This is the first practical chapter of the book, and therefore it comes with some software requirements. You need access to a computer with a recent version of R installed (R 4.3.2...
r.geocompx.org

I am curious about the unit for the four values of the expandBB argument. In the help document, it only says the values are "fraction values to expand the bounding box with":

https://r-spatial.github.io/sf/reference/plot.html#:~:text=fractional%20values%20to%20expand%20the%20bounding%20box%20with
[https://r-spatial.github.io/sf/logo.png]<https://r-spatial.github.io/sf/reference/plot.html#:~:text=fractional%20values%20to%20expand%20the%20bounding%20box%20with>
plot sf object ?? plot<https://r-spatial.github.io/sf/reference/plot.html#:~:text=fractional%20values%20to%20expand%20the%20bounding%20box%20with>
plot one or more attributes of an sf object on a map Plot sf object
r-spatial.github.io

However, it did not explicitly mention the unit adopted for the values.

My guess:
For the 1st and 3rd values in the argument, the unit is the height of the bounding box of the sf object; therefore a value of 0.2 expands (downward and upward, respectively) the canvas by 20% of the height of the bounding box.
For the 2nd and 4th values in the argument, the unit is the width of the bounding box of the sf object; therefore a value of 0.2 expands (leftward and rightward, respectively) the canvas by 20% of the width of the bounding box.

Is my understanding correct?

Thank you in advance!

??? YE, Xiang
THINKING SPATIALLY<http://www.linkedin.com/in/spatialyexiang>.
Ph.D. in Spatial Statistics

	[[alternative HTML version deleted]]


From edzer@pebe@m@ @end|ng |rom un|-muen@ter@de  Wed Feb 28 10:02:22 2024
From: edzer@pebe@m@ @end|ng |rom un|-muen@ter@de (Edzer Pebesma)
Date: Wed, 28 Feb 2024 10:02:22 +0100
Subject: [R-sig-Geo] Unit of parameters in the expandBB argument
In-Reply-To: <SA1PR15MB63971EA0F4D11873C4A1965AB0582@SA1PR15MB6397.namprd15.prod.outlook.com>
References: <SA1PR15MB63971EA0F4D11873C4A1965AB0582@SA1PR15MB6397.namprd15.prod.outlook.com>
Message-ID: <157407c6-b8a1-4d3d-ae95-02363eb718ff@uni-muenster.de>



On 28/02/2024 06:04, Xiang Ye via R-sig-Geo wrote:
> Dear community,
> 
> I recently revisited the expandBB argument in the plot() function for sf objects. It conveys a numeric vector of length 4 to expand the default canvas (in the order of bottom, left, top, right) when drawing an sf object. A quick refresh is here:
> 
> https://r.geocompx.org/spatial-class#:~:text=to%20geographic%20data.-,expandBB,-%2C%20for%20example%2C%20can
> [https://r.geocompx.org/images/cover.png]<https://r.geocompx.org/spatial-class#:~:text=to%20geographic%20data.-,expandBB,-%2C%20for%20example%2C%20can>
> Chapter 2 Geographic data in R | Geocomputation with R<https://r.geocompx.org/spatial-class#:~:text=to%20geographic%20data.-,expandBB,-%2C%20for%20example%2C%20can>
> Prerequisites This is the first practical chapter of the book, and therefore it comes with some software requirements. You need access to a computer with a recent version of R installed (R 4.3.2...
> r.geocompx.org
> 
> I am curious about the unit for the four values of the expandBB argument. In the help document, it only says the values are "fraction values to expand the bounding box with":
> 
> https://r-spatial.github.io/sf/reference/plot.html#:~:text=fractional%20values%20to%20expand%20the%20bounding%20box%20with
> [https://r-spatial.github.io/sf/logo.png]<https://r-spatial.github.io/sf/reference/plot.html#:~:text=fractional%20values%20to%20expand%20the%20bounding%20box%20with>
> plot sf object ?? plot<https://r-spatial.github.io/sf/reference/plot.html#:~:text=fractional%20values%20to%20expand%20the%20bounding%20box%20with>
> plot one or more attributes of an sf object on a map Plot sf object
> r-spatial.github.io
> 
> However, it did not explicitly mention the unit adopted for the values.
> 
> My guess:
> For the 1st and 3rd values in the argument, the unit is the height of the bounding box of the sf object; therefore a value of 0.2 expands (downward and upward, respectively) the canvas by 20% of the height of the bounding box.
> For the 2nd and 4th values in the argument, the unit is the width of the bounding box of the sf object; therefore a value of 0.2 expands (leftward and rightward, respectively) the canvas by 20% of the width of the bounding box.
> 
> Is my understanding correct?

Yes. It takes 4 values for each of the sides (bottom, left, top, right). 
You can use xlim and ylim to set the plot region in spatial coordinates.

> 
> Thank you in advance!
> 
> ??? YE, Xiang
> THINKING SPATIALLY<http://www.linkedin.com/in/spatialyexiang>.
> Ph.D. in Spatial Statistics
> 
> 	[[alternative HTML version deleted]]
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma (he/him)
Universit?t M?nster, Institute for Geoinformatics
Heisenbergstrasse 2, 48149 M?nster, Germany
Phone: +49 251 8333081


From Roger@B|v@nd @end|ng |rom nhh@no  Wed Feb 28 10:40:28 2024
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Wed, 28 Feb 2024 10:40:28 +0100 (CET)
Subject: [R-sig-Geo] Unit of parameters in the expandBB argument
In-Reply-To: <157407c6-b8a1-4d3d-ae95-02363eb718ff@uni-muenster.de>
References: <SA1PR15MB63971EA0F4D11873C4A1965AB0582@SA1PR15MB6397.namprd15.prod.outlook.com>
 <157407c6-b8a1-4d3d-ae95-02363eb718ff@uni-muenster.de>
Message-ID: <be9a9631-9f3a-ee9e-c58c-5e84cb116bb@reclus2.nhh.no>

On Wed, 28 Feb 2024, Edzer Pebesma wrote:

>
>
> On 28/02/2024 06:04, Xiang Ye via R-sig-Geo wrote:
>>  Dear community,
>>
>>  I recently revisited the expandBB argument in the plot() function for sf
>>  objects. It conveys a numeric vector of length 4 to expand the default
>>  canvas (in the order of bottom, left, top, right) when drawing an sf
>>  object. A quick refresh is here:
>>
>>  https://r.geocompx.org/spatial-class#:~:text=to%20geographic%20data.-,expandBB,-%2C%20for%20example%2C%20can
>>  [https://r.geocompx.org/images/cover.png]<https://r.geocompx.org/spatial-class#:~:text=to%20geographic%20data.-,expandBB,-%2C%20for%20example%2C%20can>
>>  Chapter 2 Geographic data in R | Geocomputation with
>>  R<https://r.geocompx.org/spatial-class#:~:text=to%20geographic%20data.-,expandBB,-%2C%20for%20example%2C%20can>
>>  Prerequisites This is the first practical chapter of the book, and
>>  therefore it comes with some software requirements. You need access to a
>>  computer with a recent version of R installed (R 4.3.2...
>>  r.geocompx.org
>>
>>  I am curious about the unit for the four values of the expandBB argument.
>>  In the help document, it only says the values are "fraction values to
>>  expand the bounding box with":
>>
>>  https://r-spatial.github.io/sf/reference/plot.html#:~:text=fractional%20values%20to%20expand%20the%20bounding%20box%20with
>>  [https://r-spatial.github.io/sf/logo.png]<https://r-spatial.github.io/sf/reference/plot.html#:~:text=fractional%20values%20to%20expand%20the%20bounding%20box%20with>
>>  plot sf object ??
>>  plot<https://r-spatial.github.io/sf/reference/plot.html#:~:text=fractional%20values%20to%20expand%20the%20bounding%20box%20with>
>>  plot one or more attributes of an sf object on a map Plot sf object
>>  r-spatial.github.io
>>
>>  However, it did not explicitly mention the unit adopted for the values.
>>
>>  My guess:
>>  For the 1st and 3rd values in the argument, the unit is the height of the
>>  bounding box of the sf object; therefore a value of 0.2 expands (downward
>>  and upward, respectively) the canvas by 20% of the height of the bounding
>>  box.
>>  For the 2nd and 4th values in the argument, the unit is the width of the
>>  bounding box of the sf object; therefore a value of 0.2 expands (leftward
>>  and rightward, respectively) the canvas by 20% of the width of the
>>  bounding box.
>>
>>  Is my understanding correct?
>
> Yes. It takes 4 values for each of the sides (bottom, left, top, right). You 
> can use xlim and ylim to set the plot region in spatial coordinates.
>

The code is at: 
https://github.com/r-spatial/sf/blob/bd1940f68dd7607b7e9098ccc32c99e273c30a60/R/plot.R#L598-L611

based on the equivalent in sp: 
https://github.com/edzer/sp/blob/e60dedf3ff3d06d9ebd9d38818b072e4475758cf/R/Spatial-methods.R#L211-L226

and added in a commit 8 years ago: 
https://github.com/edzer/sp/commit/d65045951bfebf28fbd5d0ad56bfff3cb48d57a8.

So the units are implicitly those of sp::bbox() and sf::st_bbox().

Roger



>>
>>  Thank you in advance!
>>
>>  ??? YE, Xiang
>>  THINKING
>>  SPATIALLY<http://www.linkedin.com/in/spatialyexiang>.
>>  Ph.D. in Spatial Statistics
>>
>>   [[alternative HTML version deleted]]
>>
>>
>>  _______________________________________________
>>  R-sig-Geo mailing list
>>  R-sig-Geo at r-project.org
>>  https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>

-- 
Roger Bivand
Emeritus Professor
Department of Economics, Norwegian School of Economics,
Postboks 3490 Ytre Sandviken, 5045 Bergen, Norway.
e-mail: Roger.Bivand at nhh.no

From Roger@B|v@nd @end|ng |rom nhh@no  Wed Feb 28 10:57:52 2024
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Wed, 28 Feb 2024 10:57:52 +0100 (CET)
Subject: [R-sig-Geo] Unit of parameters in the expandBB argument
In-Reply-To: <be9a9631-9f3a-ee9e-c58c-5e84cb116bb@reclus2.nhh.no>
References: <SA1PR15MB63971EA0F4D11873C4A1965AB0582@SA1PR15MB6397.namprd15.prod.outlook.com>
 <157407c6-b8a1-4d3d-ae95-02363eb718ff@uni-muenster.de>
 <be9a9631-9f3a-ee9e-c58c-5e84cb116bb@reclus2.nhh.no>
Message-ID: <86d040b3-195a-e48e-8d3f-228153693bf@reclus2.nhh.no>

On Wed, 28 Feb 2024, Roger Bivand wrote:

> On Wed, 28 Feb 2024, Edzer Pebesma wrote:
>
>> 
>>
>>  On 28/02/2024 06:04, Xiang Ye via R-sig-Geo wrote:
>>>   Dear community,
>>>
>>>   I recently revisited the expandBB argument in the plot() function for sf
>>>   objects. It conveys a numeric vector of length 4 to expand the default
>>>   canvas (in the order of bottom, left, top, right) when drawing an sf
>>>   object. A quick refresh is here:
>>>
>>>   https://r.geocompx.org/spatial-class#:~:text=to%20geographic%20data.-,expandBB,-%2C%20for%20example%2C%20can
>>>   [https://r.geocompx.org/images/cover.png]<https://r.geocompx.org/spatial-class#:~:text=to%20geographic%20data.-,expandBB,-%2C%20for%20example%2C%20can>
>>>   Chapter 2 Geographic data in R | Geocomputation with
>>>   R<https://r.geocompx.org/spatial-class#:~:text=to%20geographic%20data.-,expandBB,-%2C%20for%20example%2C%20can>
>>>   Prerequisites This is the first practical chapter of the book, and
>>>   therefore it comes with some software requirements. You need access to a
>>>   computer with a recent version of R installed (R 4.3.2...
>>>   r.geocompx.org
>>>
>>>   I am curious about the unit for the four values of the expandBB
>>>   argument.
>>>   In the help document, it only says the values are "fraction values to
>>>   expand the bounding box with":
>>>
>>>   https://r-spatial.github.io/sf/reference/plot.html#:~:text=fractional%20values%20to%20expand%20the%20bounding%20box%20with
>>>   [https://r-spatial.github.io/sf/logo.png]<https://r-spatial.github.io/sf/reference/plot.html#:~:text=fractional%20values%20to%20expand%20the%20bounding%20box%20with>
>>>   plot sf object ??
>>>   plot<https://r-spatial.github.io/sf/reference/plot.html#:~:text=fractional%20values%20to%20expand%20the%20bounding%20box%20with>
>>>   plot one or more attributes of an sf object on a map Plot sf object
>>>   r-spatial.github.io
>>>
>>>   However, it did not explicitly mention the unit adopted for the values.
>>>
>>>   My guess:
>>>   For the 1st and 3rd values in the argument, the unit is the height of
>>>   the
>>>   bounding box of the sf object; therefore a value of 0.2 expands
>>>   (downward
>>>   and upward, respectively) the canvas by 20% of the height of the
>>>   bounding
>>>   box.
>>>   For the 2nd and 4th values in the argument, the unit is the width of the
>>>   bounding box of the sf object; therefore a value of 0.2 expands
>>>   (leftward
>>>   and rightward, respectively) the canvas by 20% of the width of the
>>>   bounding box.
>>>
>>>   Is my understanding correct?
>>
>>  Yes. It takes 4 values for each of the sides (bottom, left, top, right).
>>  You can use xlim and ylim to set the plot region in spatial coordinates.
>> 
>
> The code is at: 
> https://github.com/r-spatial/sf/blob/bd1940f68dd7607b7e9098ccc32c99e273c30a60/R/plot.R#L598-L611
>
> based on the equivalent in sp: 
> https://github.com/edzer/sp/blob/e60dedf3ff3d06d9ebd9d38818b072e4475758cf/R/Spatial-methods.R#L211-L226
>
> and added in a commit 8 years ago: 
> https://github.com/edzer/sp/commit/d65045951bfebf28fbd5d0ad56bfff3cb48d57a8.
>
> So the units are implicitly those of sp::bbox() and sf::st_bbox().

That is, the *output* units are map units, expandBB are proportions, as 
in:

expBB = function(lim, expand) c(lim[1] - expand[1] * diff(lim), lim[2] + 
expand[2] * diff(lim))

called for example as: xlim <- expBB(bbox[1,], expandBB[c(2,4)]).

Roger

>
> Roger
>
>
>
>>>
>>>   Thank you in advance!
>>>
>>>   ??? YE, Xiang
>>>   THINKING
>>>   SPATIALLY<http://www.linkedin.com/in/spatialyexiang>.
>>>   Ph.D. in Spatial Statistics
>>>
>>>    [[alternative HTML version deleted]]
>>> 
>>>
>>>   _______________________________________________
>>>   R-sig-Geo mailing list
>>>   R-sig-Geo at r-project.org
>>>   https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
>> 
>
>

-- 
Roger Bivand
Emeritus Professor
Department of Economics, Norwegian School of Economics,
Postboks 3490 Ytre Sandviken, 5045 Bergen, Norway.
e-mail: Roger.Bivand at nhh.no

From x|@ngye @end|ng |rom bu||@|o@edu  Thu Feb 29 06:58:56 2024
From: x|@ngye @end|ng |rom bu||@|o@edu (Xiang Ye)
Date: Thu, 29 Feb 2024 05:58:56 +0000
Subject: [R-sig-Geo] Unit of parameters in the expandBB argument
In-Reply-To: <157407c6-b8a1-4d3d-ae95-02363eb718ff@uni-muenster.de>
References: <SA1PR15MB63971EA0F4D11873C4A1965AB0582@SA1PR15MB6397.namprd15.prod.outlook.com>
 <157407c6-b8a1-4d3d-ae95-02363eb718ff@uni-muenster.de>
Message-ID: <SA1PR15MB63977D2004E45477AF1027CFB05F2@SA1PR15MB6397.namprd15.prod.outlook.com>

Thank you, Prof. Pebesma, for confirming my guess!

Have a great day.

?? YE, Xiang
THINKING SPATIALLY<http://www.linkedin.com/in/spatialyexiang>.
Ph.D. in Spatial Statistics
________________________________
From: Edzer Pebesma <edzer.pebesma at uni-muenster.de>
Sent: Wednesday, February 28, 2024 17:02
To: Xiang Ye <xiangye at buffalo.edu>; R Special Interest Group on using Geographical data and Mapping <r-sig-geo at r-project.org>
Subject: Re: [R-sig-Geo] Unit of parameters in the expandBB argument

[You don't often get email from edzer.pebesma at uni-muenster.de. Learn why this is important at https://aka.ms/LearnAboutSenderIdentification ]

On 28/02/2024 06:04, Xiang Ye via R-sig-Geo wrote:
> Dear community,
>
> I recently revisited the expandBB argument in the plot() function for sf objects. It conveys a numeric vector of length 4 to expand the default canvas (in the order of bottom, left, top, right) when drawing an sf object. A quick refresh is here:
>
> https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fr.geocompx.org%2Fspatial-class%23%3A~%3Atext%3Dto%2520geographic%2520data.-%2CexpandBB%2C-%252C%2520for%2520example%252C%2520can&data=05%7C02%7Cxiangye%40buffalo.edu%7Cb5cdaf1352f842a7248f08dc383bfe0a%7C96464a8af8ed40b199e25f6b50a20250%7C0%7C0%7C638447077521200682%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=gd0V68L7p31unY28JZm0TZUjRB9uNHX6OA%2BCnbrWcWk%3D&reserved=0<https://r.geocompx.org/spatial-class#:~:text=to%20geographic%20data.-,expandBB,-%2C%20for%20example%2C%20can>
> [https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fr.geocompx.org%2Fimages%2Fcover.png&data=05%7C02%7Cxiangye%40buffalo.edu%7Cb5cdaf1352f842a7248f08dc383bfe0a%7C96464a8af8ed40b199e25f6b50a20250%7C0%7C0%7C638447077521207402%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=v%2FAr5z6tr4GVgKCVLx3utqwM38cNFmSjX4AoFTMaudY%3D&reserved=0]<https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fr.geocompx.org%2Fspatial-class%23%3A~%3Atext%3Dto%2520geographic%2520data.-%2CexpandBB%2C-%252C%2520for%2520example%252C%2520can&data=05%7C02%7Cxiangye%40buffalo.edu%7Cb5cdaf1352f842a7248f08dc383bfe0a%7C96464a8af8ed40b199e25f6b50a20250%7C0%7C0%7C638447077521210525%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=pO0h5F7SVp%2BHAtfNwpfpxOyX%2F92osjKlsYe558ApIXA%3D&reserved=0<https://r.geocompx.org/images/cover.png>>
> Chapter 2 Geographic data in R | Geocomputation with R<https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fr.geocompx.org%2Fspatial-class%23%3A~%3Atext%3Dto%2520geographic%2520data.-%2CexpandBB%2C-%252C%2520for%2520example%252C%2520can&data=05%7C02%7Cxiangye%40buffalo.edu%7Cb5cdaf1352f842a7248f08dc383bfe0a%7C96464a8af8ed40b199e25f6b50a20250%7C0%7C0%7C638447077521214053%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=3R5elU4T6D5XXq92g36j%2B9kxrUwtky9yMLwxWgttcKU%3D&reserved=0<https://r.geocompx.org/spatial-class#:~:text=to%20geographic%20data.-,expandBB,-%2C%20for%20example%2C%20can>>
> Prerequisites This is the first practical chapter of the book, and therefore it comes with some software requirements. You need access to a computer with a recent version of R installed (R 4.3.2...
> r.geocompx.org
>
> I am curious about the unit for the four values of the expandBB argument. In the help document, it only says the values are "fraction values to expand the bounding box with":
>
> https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fr-spatial.github.io%2Fsf%2Freference%2Fplot.html%23%3A~%3Atext%3Dfractional%2520values%2520to%2520expand%2520the%2520bounding%2520box%2520with&data=05%7C02%7Cxiangye%40buffalo.edu%7Cb5cdaf1352f842a7248f08dc383bfe0a%7C96464a8af8ed40b199e25f6b50a20250%7C0%7C0%7C638447077521217634%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=%2BGoDxw4m4RTDboRGEh0L9FM5bjtLTic1%2FJdFAUL%2F4I8%3D&reserved=0<https://r-spatial.github.io/sf/reference/plot.html#:~:text=fractional%20values%20to%20expand%20the%20bounding%20box%20with>
> [https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fr-spatial.github.io%2Fsf%2Flogo.png&data=05%7C02%7Cxiangye%40buffalo.edu%7Cb5cdaf1352f842a7248f08dc383bfe0a%7C96464a8af8ed40b199e25f6b50a20250%7C0%7C0%7C638447077521221647%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=0bVJZve69U01ahr7GzwghQ3A0pCzVBYLZH0A0YRzXzk%3D&reserved=0]<https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fr-spatial.github.io%2Fsf%2Freference%2Fplot.html%23%3A~%3Atext%3Dfractional%2520values%2520to%2520expand%2520the%2520bounding%2520box%2520with&data=05%7C02%7Cxiangye%40buffalo.edu%7Cb5cdaf1352f842a7248f08dc383bfe0a%7C96464a8af8ed40b199e25f6b50a20250%7C0%7C0%7C638447077521225251%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=1iOiKsbSvEyGaM%2FnA6mia5UtIoj%2FfYlRHwvdZI1PyEA%3D&reserved=0<https://r-spatial.github.io/sf/logo.png>>
> plot sf object ?? plot<https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fr-spatial.github.io%2Fsf%2Freference%2Fplot.html%23%3A~%3Atext%3Dfractional%2520values%2520to%2520expand%2520the%2520bounding%2520box%2520with&data=05%7C02%7Cxiangye%40buffalo.edu%7Cb5cdaf1352f842a7248f08dc383bfe0a%7C96464a8af8ed40b199e25f6b50a20250%7C0%7C0%7C638447077521229054%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=sVWlFm8SBWMb8rP4HFebS9S2iH7C21YoTVfPxYjeUPk%3D&reserved=0<https://r-spatial.github.io/sf/reference/plot.html#:~:text=fractional%20values%20to%20expand%20the%20bounding%20box%20with>>
> plot one or more attributes of an sf object on a map Plot sf object
> r-spatial.github.io
>
> However, it did not explicitly mention the unit adopted for the values.
>
> My guess:
> For the 1st and 3rd values in the argument, the unit is the height of the bounding box of the sf object; therefore a value of 0.2 expands (downward and upward, respectively) the canvas by 20% of the height of the bounding box.
> For the 2nd and 4th values in the argument, the unit is the width of the bounding box of the sf object; therefore a value of 0.2 expands (leftward and rightward, respectively) the canvas by 20% of the width of the bounding box.
>
> Is my understanding correct?

Yes. It takes 4 values for each of the sides (bottom, left, top, right).
You can use xlim and ylim to set the plot region in spatial coordinates.

>
> Thank you in advance!
>
> ??? YE, Xiang
> THINKING SPATIALLY<https://nam12.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.linkedin.com%2Fin%2Fspatialyexiang&data=05%7C02%7Cxiangye%40buffalo.edu%7Cb5cdaf1352f842a7248f08dc383bfe0a%7C96464a8af8ed40b199e25f6b50a20250%7C0%7C0%7C638447077521233419%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=TrtdJuTBUTI8MaBhvgAHM9tebXux4H8miclYlrCOBDk%3D&reserved=0<http://www.linkedin.com/in/spatialyexiang>>.
> Ph.D. in Spatial Statistics
>
>       [[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-geo&data=05%7C02%7Cxiangye%40buffalo.edu%7Cb5cdaf1352f842a7248f08dc383bfe0a%7C96464a8af8ed40b199e25f6b50a20250%7C0%7C0%7C638447077521237401%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=wOnccBlOIOuHjDu8Hwy1f42W7PkOEWChQP8NypjL6Dw%3D&reserved=0<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>

--
Edzer Pebesma (he/him)
Universit?t M?nster, Institute for Geoinformatics
Heisenbergstrasse 2, 48149 M?nster, Germany
Phone: +49 251 8333081

	[[alternative HTML version deleted]]


From x|@ngye @end|ng |rom bu||@|o@edu  Thu Feb 29 07:01:27 2024
From: x|@ngye @end|ng |rom bu||@|o@edu (Xiang Ye)
Date: Thu, 29 Feb 2024 06:01:27 +0000
Subject: [R-sig-Geo] Unit of parameters in the expandBB argument
In-Reply-To: <be9a9631-9f3a-ee9e-c58c-5e84cb116bb@reclus2.nhh.no>
References: <SA1PR15MB63971EA0F4D11873C4A1965AB0582@SA1PR15MB6397.namprd15.prod.outlook.com>
 <157407c6-b8a1-4d3d-ae95-02363eb718ff@uni-muenster.de>
 <be9a9631-9f3a-ee9e-c58c-5e84cb116bb@reclus2.nhh.no>
Message-ID: <SA1PR15MB6397CF1105F72EC697204C28B05F2@SA1PR15MB6397.namprd15.prod.outlook.com>

Thank you, Prof. Bivand, for providing the rich background information!
Now I think I know the full meaning of expandBB argument and how it will be utilized.

Have a nice day!

?? YE, Xiang
THINKING SPATIALLY<http://www.linkedin.com/in/spatialyexiang>.
Ph.D. in Spatial Statistics
________________________________
From: Roger Bivand <Roger.Bivand at nhh.no>
Sent: Wednesday, February 28, 2024 17:40
To: Edzer Pebesma <edzer.pebesma at uni-muenster.de>
Cc: Xiang Ye <xiangye at buffalo.edu>; R Special Interest Group on using Geographical data and Mapping <r-sig-geo at r-project.org>
Subject: Re: [R-sig-Geo] Unit of parameters in the expandBB argument

[You don't often get email from roger.bivand at nhh.no. Learn why this is important at https://aka.ms/LearnAboutSenderIdentification ]

On Wed, 28 Feb 2024, Edzer Pebesma wrote:

>
>
> On 28/02/2024 06:04, Xiang Ye via R-sig-Geo wrote:
>>  Dear community,
>>
>>  I recently revisited the expandBB argument in the plot() function for sf
>>  objects. It conveys a numeric vector of length 4 to expand the default
>>  canvas (in the order of bottom, left, top, right) when drawing an sf
>>  object. A quick refresh is here:
>>
>>  https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fr.geocompx.org%2Fspatial-class%23%3A~%3Atext%3Dto%2520geographic%2520data.-%2CexpandBB%2C-%252C%2520for%2520example%252C%2520can&data=05%7C02%7Cxiangye%40buffalo.edu%7C53345ace32a448abcb5208dc38414ee2%7C96464a8af8ed40b199e25f6b50a20250%7C0%7C0%7C638447100436494240%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=9mPCsXC9OJmIWzCf%2FUUj%2F9kVXB7fScooNV3nnofyyR0%3D&reserved=0<https://r.geocompx.org/spatial-class#:~:text=to%20geographic%20data.-,expandBB,-%2C%20for%20example%2C%20can>
>>  [https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fr.geocompx.org%2Fimages%2Fcover.png&data=05%7C02%7Cxiangye%40buffalo.edu%7C53345ace32a448abcb5208dc38414ee2%7C96464a8af8ed40b199e25f6b50a20250%7C0%7C0%7C638447100436504367%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=BTMXaApFbzOb231GtsPPEedq%2BpiSkpwfTb1LoZXEeC4%3D&reserved=0]<https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fr.geocompx.org%2Fspatial-class%23%3A~%3Atext%3Dto%2520geographic%2520data.-%2CexpandBB%2C-%252C%2520for%2520example%252C%2520can&data=05%7C02%7Cxiangye%40buffalo.edu%7C53345ace32a448abcb5208dc38414ee2%7C96464a8af8ed40b199e25f6b50a20250%7C0%7C0%7C638447100436507620%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=Kb%2FMI9jD9DIwW1rZxqRHGssWsJxjN%2Bf5oDzlcPRpKOE%3D&reserved=0<https://r.geocompx.org/images/cover.png>>
>>  Chapter 2 Geographic data in R | Geocomputation with
>>  R<https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fr.geocompx.org%2Fspatial-class%23%3A~%3Atext%3Dto%2520geographic%2520data.-%2CexpandBB%2C-%252C%2520for%2520example%252C%2520can&data=05%7C02%7Cxiangye%40buffalo.edu%7C53345ace32a448abcb5208dc38414ee2%7C96464a8af8ed40b199e25f6b50a20250%7C0%7C0%7C638447100436511220%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=nM15KyHxbi0c%2BxahVzKS%2F0vAlZhhYjP0Iva907VuBWk%3D&reserved=0<https://r.geocompx.org/spatial-class#:~:text=to%20geographic%20data.-,expandBB,-%2C%20for%20example%2C%20can>>
>>  Prerequisites This is the first practical chapter of the book, and
>>  therefore it comes with some software requirements. You need access to a
>>  computer with a recent version of R installed (R 4.3.2...
>>  r.geocompx.org
>>
>>  I am curious about the unit for the four values of the expandBB argument.
>>  In the help document, it only says the values are "fraction values to
>>  expand the bounding box with":
>>
>>  https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fr-spatial.github.io%2Fsf%2Freference%2Fplot.html%23%3A~%3Atext%3Dfractional%2520values%2520to%2520expand%2520the%2520bounding%2520box%2520with&data=05%7C02%7Cxiangye%40buffalo.edu%7C53345ace32a448abcb5208dc38414ee2%7C96464a8af8ed40b199e25f6b50a20250%7C0%7C0%7C638447100436514796%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=KgfpOFFs7EQXNPLjKLcW3GtOc%2F0r%2FswXb%2Brbif6qGJE%3D&reserved=0<https://r-spatial.github.io/sf/reference/plot.html#:~:text=fractional%20values%20to%20expand%20the%20bounding%20box%20with>
>>  [https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fr-spatial.github.io%2Fsf%2Flogo.png&data=05%7C02%7Cxiangye%40buffalo.edu%7C53345ace32a448abcb5208dc38414ee2%7C96464a8af8ed40b199e25f6b50a20250%7C0%7C0%7C638447100436518817%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=ZsT1c7odJ9FB6qmaqPfVFyZhkO6EsrOHkj15tCvJNM8%3D&reserved=0]<https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fr-spatial.github.io%2Fsf%2Freference%2Fplot.html%23%3A~%3Atext%3Dfractional%2520values%2520to%2520expand%2520the%2520bounding%2520box%2520with&data=05%7C02%7Cxiangye%40buffalo.edu%7C53345ace32a448abcb5208dc38414ee2%7C96464a8af8ed40b199e25f6b50a20250%7C0%7C0%7C638447100436522289%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=L3VssOMWHPbgNUijN5%2FsyRXaWXAuMzmYI9ySa9hviKk%3D&reserved=0<https://r-spatial.github.io/sf/logo.png>>
>>  plot sf object ??
>>  plot<https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fr-spatial.github.io%2Fsf%2Freference%2Fplot.html%23%3A~%3Atext%3Dfractional%2520values%2520to%2520expand%2520the%2520bounding%2520box%2520with&data=05%7C02%7Cxiangye%40buffalo.edu%7C53345ace32a448abcb5208dc38414ee2%7C96464a8af8ed40b199e25f6b50a20250%7C0%7C0%7C638447100436526336%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=IN5OYubYPs%2BmOGD1UUEHGL6r5K5NZjFjlIP9y1AMDOs%3D&reserved=0<https://r-spatial.github.io/sf/reference/plot.html#:~:text=fractional%20values%20to%20expand%20the%20bounding%20box%20with>>
>>  plot one or more attributes of an sf object on a map Plot sf object
>>  r-spatial.github.io
>>
>>  However, it did not explicitly mention the unit adopted for the values.
>>
>>  My guess:
>>  For the 1st and 3rd values in the argument, the unit is the height of the
>>  bounding box of the sf object; therefore a value of 0.2 expands (downward
>>  and upward, respectively) the canvas by 20% of the height of the bounding
>>  box.
>>  For the 2nd and 4th values in the argument, the unit is the width of the
>>  bounding box of the sf object; therefore a value of 0.2 expands (leftward
>>  and rightward, respectively) the canvas by 20% of the width of the
>>  bounding box.
>>
>>  Is my understanding correct?
>
> Yes. It takes 4 values for each of the sides (bottom, left, top, right). You
> can use xlim and ylim to set the plot region in spatial coordinates.
>

The code is at:
https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fr-spatial%2Fsf%2Fblob%2Fbd1940f68dd7607b7e9098ccc32c99e273c30a60%2FR%2Fplot.R%23L598-L611&data=05%7C02%7Cxiangye%40buffalo.edu%7C53345ace32a448abcb5208dc38414ee2%7C96464a8af8ed40b199e25f6b50a20250%7C0%7C0%7C638447100436530190%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=SiwXVVpYV3O%2BCWP%2F4DT98xMFGnmfCLvdUq341GWR4sk%3D&reserved=0<https://github.com/r-spatial/sf/blob/bd1940f68dd7607b7e9098ccc32c99e273c30a60/R/plot.R#L598-L611>

based on the equivalent in sp:
https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fedzer%2Fsp%2Fblob%2Fe60dedf3ff3d06d9ebd9d38818b072e4475758cf%2FR%2FSpatial-methods.R%23L211-L226&data=05%7C02%7Cxiangye%40buffalo.edu%7C53345ace32a448abcb5208dc38414ee2%7C96464a8af8ed40b199e25f6b50a20250%7C0%7C0%7C638447100436533591%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=%2BVuCUgoCaoADfovzTjdHnZYuM4QD5OW85oq7nZ1Z53Y%3D&reserved=0<https://github.com/edzer/sp/blob/e60dedf3ff3d06d9ebd9d38818b072e4475758cf/R/Spatial-methods.R#L211-L226>

and added in a commit 8 years ago:
https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fedzer%2Fsp%2Fcommit%2Fd65045951bfebf28fbd5d0ad56bfff3cb48d57a8&data=05%7C02%7Cxiangye%40buffalo.edu%7C53345ace32a448abcb5208dc38414ee2%7C96464a8af8ed40b199e25f6b50a20250%7C0%7C0%7C638447100436537065%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=7SY%2BG0%2BlcF%2B7vOMyNU46Og94SZkAQFspogFDuzYfWes%3D&reserved=0<https://github.com/edzer/sp/commit/d65045951bfebf28fbd5d0ad56bfff3cb48d57a8>.

So the units are implicitly those of sp::bbox() and sf::st_bbox().

Roger



>>
>>  Thank you in advance!
>>
>>  ??? YE, Xiang
>>  THINKING
>>  SPATIALLY<https://nam12.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.linkedin.com%2Fin%2Fspatialyexiang&data=05%7C02%7Cxiangye%40buffalo.edu%7C53345ace32a448abcb5208dc38414ee2%7C96464a8af8ed40b199e25f6b50a20250%7C0%7C0%7C638447100436540071%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=TL1T70IUgYhJJnLe9f17toJHto%2Fnpp%2BopAGNhtMTsko%3D&reserved=0<http://www.linkedin.com/in/spatialyexiang>>.
>>  Ph.D. in Spatial Statistics
>>
>>   [[alternative HTML version deleted]]
>>
>>
>>  _______________________________________________
>>  R-sig-Geo mailing list
>>  R-sig-Geo at r-project.org
>>  https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-geo&data=05%7C02%7Cxiangye%40buffalo.edu%7C53345ace32a448abcb5208dc38414ee2%7C96464a8af8ed40b199e25f6b50a20250%7C0%7C0%7C638447100436543135%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C0%7C%7C%7C&sdata=YcS%2FqltAQTu%2Bx7xMiZ0%2Bsd3veSQWa39%2Fi5KwKgWyTL0%3D&reserved=0<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>
>

--
Roger Bivand
Emeritus Professor
Department of Economics, Norwegian School of Economics,
Postboks 3490 Ytre Sandviken, 5045 Bergen, Norway.
e-mail: Roger.Bivand at nhh.no

	[[alternative HTML version deleted]]


