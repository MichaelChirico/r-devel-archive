From Roger@B|v@nd @end|ng |rom nhh@no  Tue Oct  1 12:22:40 2019
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Tue, 1 Oct 2019 12:22:40 +0200
Subject: [R-sig-Geo] Producing a conditional adjacency matrix
In-Reply-To: <E4989DEB-985D-48D1-8AAE-BE0C61B1E44D@sant.ox.ac.uk>
References: <E4989DEB-985D-48D1-8AAE-BE0C61B1E44D@sant.ox.ac.uk>
Message-ID: <alpine.LFD.2.21.1910011219150.29030@reclus.nhh.no>

On Mon, 30 Sep 2019, Rhys Dubin wrote:

> Hi all,
>
> I have a question regarding matrices (produced using poy2nb in spdep).
>
> I?m trying to produce an adjacency matrix from a GIS Polygon shapefile 
> with about 500 individual polygons (queen or rook ? it doesn?t really 
> matter for now), but conditional on the value of the parent polygon.
>
> For instance, if a polygon had an arbitrary value of 1, I want to return 
> a list of all neighboring polygons that have a value of 2 or 3 (ie. ? 
> 1). The same would go for a polygon with a value of 2 (ie. return all 
> neighbors with a value of ? 2).
>
> Is there a solution to this issue built into spdep, do I need to use a 
> different package, or is it possible to accomplish this with a 
> subsetting command?

No built-in solution, but to make progress a clear, reproducible example 
is essential, otherwise we're guessing what you want. For example, add a 
doctored variable to the eire or columbus data sets to show your needs. Do 
you want a glist including (1) all neighbours j with a value of x not 
equal to x[i], and excluding (0) all with x[j] == x[i]?

Roger

>
> Thanks!
>
> Rhys
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From rhy@@dub|n @end|ng |rom @@nt@ox@@c@uk  Tue Oct  1 14:12:54 2019
From: rhy@@dub|n @end|ng |rom @@nt@ox@@c@uk (Rhys Dubin)
Date: Tue, 1 Oct 2019 12:12:54 +0000
Subject: [R-sig-Geo] Producing a conditional adjacency matrix
In-Reply-To: <alpine.LFD.2.21.1910011219150.29030@reclus.nhh.no>
References: <E4989DEB-985D-48D1-8AAE-BE0C61B1E44D@sant.ox.ac.uk>
 <alpine.LFD.2.21.1910011219150.29030@reclus.nhh.no>
Message-ID: <2B76DC73-98FB-470B-A851-CB9ED517F5FA@sant.ox.ac.uk>

Hi Roger,

Including a bit more detail below (my apologies if this is just complete gibberish ? first time posting to a forum like this):

First, I add a random ID variable to the columbus dataset indicating the variable I?d like to base my exclusions on in the final neighbor list:
> columbus$ID <- sample(1:3, nrow(columbus), replace=T)

In my case, that produced the following IDs for the first 4 polyids:

POLYID 1: 3
POLYID 2: 2
POLYID 3: 3
POLYID 4: 1

Second, col.ga.nb indicates that each of the previous POLYID?s has the following neighbors

> View(col.gal.nb)

POLYID 1 (w new assigned ID of 3): 2, 3
POLYID 2 (? ? 2): 1, 3, 4
POLYID 3 (? ? 3): 1, 2, 4, 5
POLYID 4 (? ? 1): 2, 3, 5, 8

Third (or brevity?s sake) looking only at POLYID 1 (with new ID = 3):

Its neighbors from col.ga.nb (POLYID 2 and 3) have ID values of 3 and 1 respectively

My end goal would be to produce a new list in which POLYID 1?s only neighbor is POLYID 3 (with an ID of 1). POLYID 2 would be excluded, as its ID value matches its parent. 

The same would be true of each subsequent polygon. 

In essence, the same format you mentioned at the end of your reply: a glist including all neighbors j with a value of x not equal to x[i], and excluding all with x[j] == x[i].

Best,

Rhys


> On Oct 1, 2019, at 1:22 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> 
> On Mon, 30 Sep 2019, Rhys Dubin wrote:
> 
>> Hi all,
>> 
>> I have a question regarding matrices (produced using poy2nb in spdep).
>> 
>> I?m trying to produce an adjacency matrix from a GIS Polygon shapefile with about 500 individual polygons (queen or rook ? it doesn?t really matter for now), but conditional on the value of the parent polygon.
>> 
>> For instance, if a polygon had an arbitrary value of 1, I want to return a list of all neighboring polygons that have a value of 2 or 3 (ie. ? 1). The same would go for a polygon with a value of 2 (ie. return all neighbors with a value of ? 2).
>> 
>> Is there a solution to this issue built into spdep, do I need to use a different package, or is it possible to accomplish this with a subsetting command?
> 
> No built-in solution, but to make progress a clear, reproducible example is essential, otherwise we're guessing what you want. For example, add a doctored variable to the eire or columbus data sets to show your needs. Do you want a glist including (1) all neighbours j with a value of x not equal to x[i], and excluding (0) all with x[j] == x[i]?
> 
> Roger
> 
>> 
>> Thanks!
>> 
>> Rhys
>> 
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> -- 
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> https://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From Roger@B|v@nd @end|ng |rom nhh@no  Tue Oct  1 14:38:14 2019
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Tue, 1 Oct 2019 14:38:14 +0200
Subject: [R-sig-Geo] Producing a conditional adjacency matrix
In-Reply-To: <2B76DC73-98FB-470B-A851-CB9ED517F5FA@sant.ox.ac.uk>
References: <E4989DEB-985D-48D1-8AAE-BE0C61B1E44D@sant.ox.ac.uk>
 <alpine.LFD.2.21.1910011219150.29030@reclus.nhh.no>
 <2B76DC73-98FB-470B-A851-CB9ED517F5FA@sant.ox.ac.uk>
Message-ID: <alpine.LFD.2.21.1910011432480.30409@reclus.nhh.no>

On Tue, 1 Oct 2019, Rhys Dubin wrote:

> Hi Roger,
>
> Including a bit more detail below (my apologies if this is just complete gibberish ? first time posting to a forum like this):
>
> First, I add a random ID variable to the columbus dataset indicating the variable I?d like to base my exclusions on in the final neighbor list:
>> columbus$ID <- sample(1:3, nrow(columbus), replace=T)
>
> In my case, that produced the following IDs for the first 4 polyids:
>
> POLYID 1: 3
> POLYID 2: 2
> POLYID 3: 3
> POLYID 4: 1
>
> Second, col.ga.nb indicates that each of the previous POLYID?s has the following neighbors
>
>> View(col.gal.nb)
>
> POLYID 1 (w new assigned ID of 3): 2, 3
> POLYID 2 (? ? 2): 1, 3, 4
> POLYID 3 (? ? 3): 1, 2, 4, 5
> POLYID 4 (? ? 1): 2, 3, 5, 8
>
> Third (or brevity?s sake) looking only at POLYID 1 (with new ID = 3):
>
> Its neighbors from col.ga.nb (POLYID 2 and 3) have ID values of 3 and 1 respectively
>
> My end goal would be to produce a new list in which POLYID 1?s only neighbor is POLYID 3 (with an ID of 1). POLYID 2 would be excluded, as its ID value matches its parent.

Leave col.gal.nb as it is, and generate a list of general weights:

> library(spdep)
Loading required package: sp
Loading required package: spData
Loading required package: sf
Linking to GEOS 3.7.2, GDAL 3.0.1, PROJ 6.2.0
> data(columbus, package="spData")
> ls()
[1] "bbs"        "col.gal.nb" "columbus"   "coords"     "polys"
> col.gal.nb[[1]]
[1] 2 3
> set.seed(1)
> columbus$ID <- sample(1:3, nrow(columbus), replace=T)
> columbus$ID[1]
[1] 1
> columbus$ID[col.gal.nb[[1]]]
[1] 3 1 # second entry equal
> glist <- lapply(seq(along=col.gal.nb), function(i)
   as.integer(columbus$ID[i] != columbus$ID[col.gal.nb[[i]]]))
> glist[[1]]
[1] 1 0 # second weight zero

From there use nb2listw() to generate weights if that is what you need. 
lapply() is always worth learning - do not use View() on objects that are 
not data.frames or matrices, it either tells nothing or is misleading.

Hope this clarifies,

Roger

>
> The same would be true of each subsequent polygon.
>
> In essence, the same format you mentioned at the end of your reply: a 
> glist including all neighbors j with a value of x not equal to x[i], and 
> excluding all with x[j] == x[i].
>
> Best,
>
> Rhys
>
>
>> On Oct 1, 2019, at 1:22 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>>
>> On Mon, 30 Sep 2019, Rhys Dubin wrote:
>>
>>> Hi all,
>>>
>>> I have a question regarding matrices (produced using poy2nb in spdep).
>>>
>>> I?m trying to produce an adjacency matrix from a GIS Polygon shapefile with about 500 individual polygons (queen or rook ? it doesn?t really matter for now), but conditional on the value of the parent polygon.
>>>
>>> For instance, if a polygon had an arbitrary value of 1, I want to return a list of all neighboring polygons that have a value of 2 or 3 (ie. ? 1). The same would go for a polygon with a value of 2 (ie. return all neighbors with a value of ? 2).
>>>
>>> Is there a solution to this issue built into spdep, do I need to use a different package, or is it possible to accomplish this with a subsetting command?
>>
>> No built-in solution, but to make progress a clear, reproducible example is essential, otherwise we're guessing what you want. For example, add a doctored variable to the eire or columbus data sets to show your needs. Do you want a glist including (1) all neighbours j with a value of x not equal to x[i], and excluding (0) all with x[j] == x[i]?
>>
>> Roger
>>
>>>
>>> Thanks!
>>>
>>> Rhys
>>>
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> --
>> Roger Bivand
>> Department of Economics, Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>> https://orcid.org/0000-0003-2392-6140
>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From b|hem|ng @end|ng |rom @@u@edu  Tue Oct  1 20:20:26 2019
From: b|hem|ng @end|ng |rom @@u@edu (Benjamin Hemingway)
Date: Tue, 1 Oct 2019 11:20:26 -0700
Subject: [R-sig-Geo] variogramCloud to gstatVariogram in gstat
Message-ID: <CAEtjHdJKn_mgFqCY2Zq=pQOsAvOofDAyM5iS9tY6CGGtY+6Lhw@mail.gmail.com>

Hello,

I am computing the variogram from points measured along profiles. I do not
want to compute the variogram from pairs of points belonging to the same
profile. To accomplish this I am iterating through each point and computing
the variogram cloud, keeping only the point pairs that I want. However, I
would like to plot the sample variogram and fit a model to it using only
the point pairs in my final variogramCloud data frame.

Is there an elegant way to convert a variogramCloud data frame to a
gstatVariogram data frame?

Ben

	[[alternative HTML version deleted]]


From edzer@pebe@m@ @end|ng |rom un|-muen@ter@de  Tue Oct  1 21:52:46 2019
From: edzer@pebe@m@ @end|ng |rom un|-muen@ter@de (Edzer Pebesma)
Date: Tue, 1 Oct 2019 21:52:46 +0200
Subject: [R-sig-Geo] variogramCloud to gstatVariogram in gstat
In-Reply-To: <CAEtjHdJKn_mgFqCY2Zq=pQOsAvOofDAyM5iS9tY6CGGtY+6Lhw@mail.gmail.com>
References: <CAEtjHdJKn_mgFqCY2Zq=pQOsAvOofDAyM5iS9tY6CGGtY+6Lhw@mail.gmail.com>
Message-ID: <fc569aae-cf44-d9d4-70d7-df2ae6a6ff69@uni-muenster.de>

Not elegant, but this might work:

x # is your variogramCloud
x$np = 1
class(x) = c("gstatVariogram", "data.frame")

On 10/1/19 8:20 PM, Benjamin Hemingway wrote:
> Hello,
> 
> I am computing the variogram from points measured along profiles. I do not
> want to compute the variogram from pairs of points belonging to the same
> profile. To accomplish this I am iterating through each point and computing
> the variogram cloud, keeping only the point pairs that I want. However, I
> would like to plot the sample variogram and fit a model to it using only
> the point pairs in my final variogramCloud data frame.
> 
> Is there an elegant way to convert a variogramCloud data frame to a
> gstatVariogram data frame?
> 
> Ben
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48151 Muenster, Germany
Phone: +49 251 8333081

-------------- next part --------------
A non-text attachment was scrubbed...
Name: pEpkey.asc
Type: application/pgp-keys
Size: 3110 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20191001/192edb6b/attachment.bin>

From rhy@@dub|n @end|ng |rom @@nt@ox@@c@uk  Wed Oct  2 08:20:56 2019
From: rhy@@dub|n @end|ng |rom @@nt@ox@@c@uk (Rhys Dubin)
Date: Wed, 2 Oct 2019 06:20:56 +0000
Subject: [R-sig-Geo] Producing a conditional adjacency matrix
In-Reply-To: <alpine.LFD.2.21.1910011432480.30409@reclus.nhh.no>
References: <E4989DEB-985D-48D1-8AAE-BE0C61B1E44D@sant.ox.ac.uk>
 <alpine.LFD.2.21.1910011219150.29030@reclus.nhh.no>
 <2B76DC73-98FB-470B-A851-CB9ED517F5FA@sant.ox.ac.uk>
 <alpine.LFD.2.21.1910011432480.30409@reclus.nhh.no>
Message-ID: <7326011F-853E-4653-A50B-2AFAD0ACCC85@sant.ox.ac.uk>

Thank you so much Roger! Works like a charm.

Rhys

On Oct 1, 2019, at 3:38 PM, Roger Bivand <Roger.Bivand at nhh.no<mailto:Roger.Bivand at nhh.no>> wrote:

On Tue, 1 Oct 2019, Rhys Dubin wrote:

Hi Roger,

Including a bit more detail below (my apologies if this is just complete gibberish ? first time posting to a forum like this):

First, I add a random ID variable to the columbus dataset indicating the variable I?d like to base my exclusions on in the final neighbor list:
columbus$ID <- sample(1:3, nrow(columbus), replace=T)

In my case, that produced the following IDs for the first 4 polyids:

POLYID 1: 3
POLYID 2: 2
POLYID 3: 3
POLYID 4: 1

Second, col.ga.nb indicates that each of the previous POLYID?s has the following neighbors

View(col.gal.nb)

POLYID 1 (w new assigned ID of 3): 2, 3
POLYID 2 (? ? 2): 1, 3, 4
POLYID 3 (? ? 3): 1, 2, 4, 5
POLYID 4 (? ? 1): 2, 3, 5, 8

Third (or brevity?s sake) looking only at POLYID 1 (with new ID = 3):

Its neighbors from col.ga.nb (POLYID 2 and 3) have ID values of 3 and 1 respectively

My end goal would be to produce a new list in which POLYID 1?s only neighbor is POLYID 3 (with an ID of 1). POLYID 2 would be excluded, as its ID value matches its parent.

Leave col.gal.nb as it is, and generate a list of general weights:

library(spdep)
Loading required package: sp
Loading required package: spData
Loading required package: sf
Linking to GEOS 3.7.2, GDAL 3.0.1, PROJ 6.2.0
data(columbus, package="spData")
ls()
[1] "bbs"        "col.gal.nb" "columbus"   "coords"     "polys"
col.gal.nb[[1]]
[1] 2 3
set.seed(1)
columbus$ID <- sample(1:3, nrow(columbus), replace=T)
columbus$ID[1]
[1] 1
columbus$ID[col.gal.nb[[1]]]
[1] 3 1 # second entry equal
glist <- lapply(seq(along=col.gal.nb), function(i)
 as.integer(columbus$ID[i] != columbus$ID[col.gal.nb[[i]]]))
glist[[1]]
[1] 1 0 # second weight zero

From there use nb2listw() to generate weights if that is what you need. lapply() is always worth learning - do not use View() on objects that are not data.frames or matrices, it either tells nothing or is misleading.

Hope this clarifies,

Roger


The same would be true of each subsequent polygon.

In essence, the same format you mentioned at the end of your reply: a glist including all neighbors j with a value of x not equal to x[i], and excluding all with x[j] == x[i].

Best,

Rhys


On Oct 1, 2019, at 1:22 PM, Roger Bivand <Roger.Bivand at nhh.no<mailto:Roger.Bivand at nhh.no>> wrote:

On Mon, 30 Sep 2019, Rhys Dubin wrote:

Hi all,

I have a question regarding matrices (produced using poy2nb in spdep).

I?m trying to produce an adjacency matrix from a GIS Polygon shapefile with about 500 individual polygons (queen or rook ? it doesn?t really matter for now), but conditional on the value of the parent polygon.

For instance, if a polygon had an arbitrary value of 1, I want to return a list of all neighboring polygons that have a value of 2 or 3 (ie. ? 1). The same would go for a polygon with a value of 2 (ie. return all neighbors with a value of ? 2).

Is there a solution to this issue built into spdep, do I need to use a different package, or is it possible to accomplish this with a subsetting command?

No built-in solution, but to make progress a clear, reproducible example is essential, otherwise we're guessing what you want. For example, add a doctored variable to the eire or columbus data sets to show your needs. Do you want a glist including (1) all neighbours j with a value of x not equal to x[i], and excluding (0) all with x[j] == x[i]?

Roger


Thanks!

Rhys


_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

--
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no<mailto:Roger.Bivand at nhh.no>
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en



--
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no<mailto:Roger.Bivand at nhh.no>
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


	[[alternative HTML version deleted]]


From d@nturne @end|ng |rom y@hoo@com  Mon Oct  7 21:08:47 2019
From: d@nturne @end|ng |rom y@hoo@com (Daniel Turner)
Date: Mon, 7 Oct 2019 19:08:47 +0000 (UTC)
Subject: [R-sig-Geo] calculation of kriging range, nugget, sill
References: <1129298294.3130929.1570475327650.ref@mail.yahoo.com>
Message-ID: <1129298294.3130929.1570475327650@mail.yahoo.com>

Hello!
Is there a way to see how the range, nugget, and sill for kriging are calculated in the gstat package??
Thanks,
Daniel Turner
	[[alternative HTML version deleted]]


From edzer@pebe@m@ @end|ng |rom un|-muen@ter@de  Mon Oct  7 22:16:37 2019
From: edzer@pebe@m@ @end|ng |rom un|-muen@ter@de (Edzer Pebesma)
Date: Mon, 7 Oct 2019 22:16:37 +0200
Subject: [R-sig-Geo] calculation of kriging range, nugget, sill
In-Reply-To: <1129298294.3130929.1570475327650@mail.yahoo.com>
References: <1129298294.3130929.1570475327650.ref@mail.yahoo.com>
 <1129298294.3130929.1570475327650@mail.yahoo.com>
Message-ID: <15d9ff3e-734d-8507-c308-c5f05cbc6589@uni-muenster.de>

If you can read R and C, yes: https://github.com/r-spatial/gstat

On 10/7/19 9:08 PM, Daniel Turner via R-sig-Geo wrote:
> Hello!
> Is there a way to see how the range, nugget, and sill for kriging are calculated in the gstat package??
> Thanks,
> Daniel Turner
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48151 Muenster, Germany
Phone: +49 251 8333081

-------------- next part --------------
A non-text attachment was scrubbed...
Name: pEpkey.asc
Type: application/pgp-keys
Size: 3110 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20191007/147b87c9/attachment.bin>

From cperk @end|ng |rom terpm@||@umd@edu  Sat Oct 12 21:37:16 2019
From: cperk @end|ng |rom terpm@||@umd@edu (Carrie Perkins)
Date: Sat, 12 Oct 2019 15:37:16 -0400
Subject: [R-sig-Geo] Computing pairwise minimum distance moving only within
 clipped area
Message-ID: <CAPtr_T6ibrToPQ6+Rpc4e=x31TLrdDY38qi5257z+L2eEzTZUg@mail.gmail.com>

Hello!

I am trying to compute pairwise minimum distances within a raster that has
been clipped to an outer boundary using a polygon.

I tried to do this using gDistance (reproducible example below) but am not
sure if it worked. I need to know the pairwise distances between patches
where the path travelled does not exit the clipped boundary (in the example
below, this is the border of Switzerland).

library(maptools)
library(raster)
data(wrld_simpl)
SPDF <- subset(wrld_simpl, NAME=="Switzerland") #polygon map of Switzerland
## Example RasterLayer
r <- raster(nrow=1000, ncol=1000, crs=proj4string(SPDF)) #blank raster

r[] <- 0 #set all cell values in raster to 0

## crop raster to extent of Switzerland polygon, SPDF
r2 <- crop(r, extent(SPDF))

#create patches by setting certain cells in raster to value 1; all other
cells are still 0

r2[8,1] <- 1
r2[9,11] <- 1

plot(r2)

p <- clump(r3) #give each patch of its own unique ID
spplot(p)

p[is.na(p[])] <- 0 #all cells that were previously 0 were set to NA by
clump() so we need to change them back to 0

p.masked <- mask(p,SPDF) #now clip the raster to the border of Switzerland
using SPDF; outside of Switzerland's border cells are now NA

plot(p.masked)


rpoly <- rasterToPolygons(p.masked, dissolve=T) #convert from raster to
polygons; NA cells (outside Switzerland) do not get converted

d <- gDistance(rpoly, byid=T) #calculate minimum pairwise distances between
polygons

library(reshape2)
df <- melt(as.matrix(d), varnames = c("row", "col")) #put pairwise
distances into a dataframe

#add column names
colnames(df) <- c("node_i_ID","node_j_ID","Distance")

df

I cannot tell whether gDistance did what I am trying to do, i.e. calculate
the minimum pairwise distances among patches without leaving the boundary
of Switzerland, or whether the path travelled includes areas outside of
Switzerland. If it is the latter, I could use some help figuring out a way
to keep the path travelled confined to the country boundary. Thanks!

	[[alternative HTML version deleted]]


From tom@heng| @end|ng |rom gm@||@com  Mon Oct 14 11:56:14 2019
From: tom@heng| @end|ng |rom gm@||@com (Tomislav Hengl)
Date: Mon, 14 Oct 2019 11:56:14 +0200
Subject: [R-sig-Geo] Job positions geo-computation and Machine Learning /
 Ensemble Machine Learning / spatio-temporal data modeling
Message-ID: <640f2b8f-f42b-fa0c-4d33-c0a7b4c9703d@gmail.com>


Dear community,

We're hiring three new research positions to work on Open Data Science 
problems. If you enjoy (and are good at) coding in open source (R, 
Python), optimizing computing and producing global (see e.g. 
https://openlandmap.org) and regional data that can help regional and 
international organizations produce better designs and make better 
decisions - we might be a match!

For more info see: https://opengeohub.org/jobs/vacancies

Note application deadline: 24 November 2019.

- "Postdoctoral position: geo-computation & Machine Learning optimization",
https://opengeohub.org/jobs/2019/postdoctoral-position-geo-computation-machine-learning-optimization

- "Researcher: predictive mapping using Ensemble Machine Learning",
https://opengeohub.org/jobs/2019/researcher-predictive-mapping-using-ensemble-machine-learning

- "PhD position: spatio-temporal data modeling and scenario testing 
using web-GIS",
https://opengeohub.org/jobs/2019/phd-position-spatio-temporal-data-modeling-and-scenario-testing-using-web-gis

-- 
T. (Tom) Hengl
Technical support / Vice Chair
OpenGeoHub Foundation
Address: Agro Business Park 10 (unit 1.05), 6708 PW Wageningen, NL
Tel: +31 (0)317 427537
Url: https://opengeohub.org/about
Twitter: https://twitter.com/opengeohub
https://www.youtube.com/c/OpenGeoHubFoundation
skype:tom.hengl?chat
Publications: http://scholar.google.com/citations?user=2oYU7S8AAAAJ


From rub@k @end|ng |rom m@th@@@u@dk  Tue Oct 15 12:01:20 2019
From: rub@k @end|ng |rom m@th@@@u@dk (Ege Rubak)
Date: Tue, 15 Oct 2019 12:01:20 +0200
Subject: [R-sig-Geo] 
 Computing pairwise minimum distance moving only within clipped area
In-Reply-To: <CAPtr_T6ibrToPQ6+Rpc4e=x31TLrdDY38qi5257z+L2eEzTZUg@mail.gmail.com>
References: <CAPtr_T6ibrToPQ6+Rpc4e=x31TLrdDY38qi5257z+L2eEzTZUg@mail.gmail.com>
Message-ID: <35d330b6-5382-2714-9e99-32828383ce2b@math.aau.dk>

 From the documentation of gDistance I would be very suprised if it 
confines paths to be inside the polygon. Try to make a simple example 
"by hand" and check the calculations.

This is a well studied problem in computer science (search for something 
like "shortest path inside polygon"), and different algorithms to solve 
the problem exist, but I don't know if any of them are implemented in R.

A grid based approach which may be the simplest/best solution for you is 
described in this answer on StackOverflow:

https://stackoverflow.com/a/22975521/3341769

Hope this helps,
Ege

On 12/10/2019 21.37, Carrie Perkins wrote:
> Hello!
> 
> I am trying to compute pairwise minimum distances within a raster that has
> been clipped to an outer boundary using a polygon.
> 
> I tried to do this using gDistance (reproducible example below) but am not
> sure if it worked. I need to know the pairwise distances between patches
> where the path travelled does not exit the clipped boundary (in the example
> below, this is the border of Switzerland).
> 
> library(maptools)
> library(raster)
> data(wrld_simpl)
> SPDF <- subset(wrld_simpl, NAME=="Switzerland") #polygon map of Switzerland
> ## Example RasterLayer
> r <- raster(nrow=1000, ncol=1000, crs=proj4string(SPDF)) #blank raster
> 
> r[] <- 0 #set all cell values in raster to 0
> 
> ## crop raster to extent of Switzerland polygon, SPDF
> r2 <- crop(r, extent(SPDF))
> 
> #create patches by setting certain cells in raster to value 1; all other
> cells are still 0
> 
> r2[8,1] <- 1
> r2[9,11] <- 1
> 
> plot(r2)
> 
> p <- clump(r3) #give each patch of its own unique ID
> spplot(p)
> 
> p[is.na(p[])] <- 0 #all cells that were previously 0 were set to NA by
> clump() so we need to change them back to 0
> 
> p.masked <- mask(p,SPDF) #now clip the raster to the border of Switzerland
> using SPDF; outside of Switzerland's border cells are now NA
> 
> plot(p.masked)
> 
> 
> rpoly <- rasterToPolygons(p.masked, dissolve=T) #convert from raster to
> polygons; NA cells (outside Switzerland) do not get converted
> 
> d <- gDistance(rpoly, byid=T) #calculate minimum pairwise distances between
> polygons
> 
> library(reshape2)
> df <- melt(as.matrix(d), varnames = c("row", "col")) #put pairwise
> distances into a dataframe
> 
> #add column names
> colnames(df) <- c("node_i_ID","node_j_ID","Distance")
> 
> df
> 
> I cannot tell whether gDistance did what I am trying to do, i.e. calculate
> the minimum pairwise distances among patches without leaving the boundary
> of Switzerland, or whether the path travelled includes areas outside of
> Switzerland. If it is the latter, I could use some help figuring out a way
> to keep the path travelled confined to the country boundary. Thanks!
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From @rgun@w @end|ng |rom gm@||@com  Tue Oct 15 17:43:23 2019
From: @rgun@w @end|ng |rom gm@||@com (argunaw .)
Date: Tue, 15 Oct 2019 11:43:23 -0400
Subject: [R-sig-Geo] CSV with Geometry Column to SF object
Message-ID: <CAOjYuEbwE1E=e2HOO0f74FtQoaK6N0TzDUf=FU9zx9mY6Zv0gw@mail.gmail.com>

Hello Everyone,

I have a csv file with a postgis "geometry" column. I've been trying to
import it in to R as a SF file, with the goal of exporting it to a postgis
database, but to no avail. I've used the following methods:

1. file <- st_read("name.csv", stringsAsFactors=F, geometry_column=geom)

2. file <- fread("name.csv", headers=True)
    file <- st_as_sf(file)

How can I import a csv with a postgis "geometry" column in to R as a
spatial/SF object?

	[[alternative HTML version deleted]]


From tech_dev @end|ng |rom w||d|nte||ect@com  Tue Oct 15 19:11:24 2019
From: tech_dev @end|ng |rom w||d|nte||ect@com (Alex Mandel)
Date: Tue, 15 Oct 2019 10:11:24 -0700
Subject: [R-sig-Geo] CSV with Geometry Column to SF object
In-Reply-To: <CAOjYuEbwE1E=e2HOO0f74FtQoaK6N0TzDUf=FU9zx9mY6Zv0gw@mail.gmail.com>
References: <CAOjYuEbwE1E=e2HOO0f74FtQoaK6N0TzDUf=FU9zx9mY6Zv0gw@mail.gmail.com>
Message-ID: <ecee49db-d5f0-57ef-de65-78ddfa01e2d2@wildintellect.com>

On 10/15/19 8:43 AM, argunaw . wrote:
> Hello Everyone,
> 
> I have a csv file with a postgis "geometry" column. I've been trying to
> import it in to R as a SF file, with the goal of exporting it to a postgis
> database, but to no avail. I've used the following methods:
> 
> 1. file <- st_read("name.csv", stringsAsFactors=F, geometry_column=geom)
> 
> 2. file <- fread("name.csv", headers=True)
>     file <- st_as_sf(file)
> 
> How can I import a csv with a postgis "geometry" column in to R as a
> spatial/SF object?
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

Can you paste an example somewhere, is it binary data or some kind of
plain text column? Do you know how it was exported from Postgis?

If it's a dump from a postgis database did you try loading the table
directly to postgis with it's own load/import, or sql tools?

Thanks,
Alex


From @rgun@w @end|ng |rom gm@||@com  Tue Oct 15 19:58:30 2019
From: @rgun@w @end|ng |rom gm@||@com (argunaw .)
Date: Tue, 15 Oct 2019 13:58:30 -0400
Subject: [R-sig-Geo] CSV with Geometry Column to SF object
In-Reply-To: <ecee49db-d5f0-57ef-de65-78ddfa01e2d2@wildintellect.com>
References: <CAOjYuEbwE1E=e2HOO0f74FtQoaK6N0TzDUf=FU9zx9mY6Zv0gw@mail.gmail.com>
 <ecee49db-d5f0-57ef-de65-78ddfa01e2d2@wildintellect.com>
Message-ID: <CAOjYuEY=-bEJwDmH2cwTsDA8+LDXQ9CvbPCUG-2yZy61wYaS1g@mail.gmail.com>

I'm not sure how it was exported from postgis- the person who gave me the
file wasn't the one who downloaded it unfortunately.

The file is a line file of roads. The files main columns are road ID
numbers (type integer) and the geometry column (type geometry, long strong
of letters and numbers). Only the IT admins where I am have the postgis
load/import tools in the pgadmin/sql interface. The rest of us can download
from sql and create new tables from other sql databases, but not create a
new table from a csv file.

On Tue, Oct 15, 2019 at 1:11 PM Alex Mandel <tech_dev at wildintellect.com>
wrote:

> On 10/15/19 8:43 AM, argunaw . wrote:
> > Hello Everyone,
> >
> > I have a csv file with a postgis "geometry" column. I've been trying to
> > import it in to R as a SF file, with the goal of exporting it to a
> postgis
> > database, but to no avail. I've used the following methods:
> >
> > 1. file <- st_read("name.csv", stringsAsFactors=F, geometry_column=geom)
> >
> > 2. file <- fread("name.csv", headers=True)
> >     file <- st_as_sf(file)
> >
> > How can I import a csv with a postgis "geometry" column in to R as a
> > spatial/SF object?
> >
> >       [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
> Can you paste an example somewhere, is it binary data or some kind of
> plain text column? Do you know how it was exported from Postgis?
>
> If it's a dump from a postgis database did you try loading the table
> directly to postgis with it's own load/import, or sql tools?
>
> Thanks,
> Alex
>

	[[alternative HTML version deleted]]


From edzer@pebe@m@ @end|ng |rom un|-muen@ter@de  Tue Oct 15 20:16:03 2019
From: edzer@pebe@m@ @end|ng |rom un|-muen@ter@de (Edzer Pebesma)
Date: Tue, 15 Oct 2019 14:16:03 -0400
Subject: [R-sig-Geo] CSV with Geometry Column to SF object
In-Reply-To: <CAOjYuEY=-bEJwDmH2cwTsDA8+LDXQ9CvbPCUG-2yZy61wYaS1g@mail.gmail.com>
References: <CAOjYuEbwE1E=e2HOO0f74FtQoaK6N0TzDUf=FU9zx9mY6Zv0gw@mail.gmail.com>
 <ecee49db-d5f0-57ef-de65-78ddfa01e2d2@wildintellect.com>
 <CAOjYuEY=-bEJwDmH2cwTsDA8+LDXQ9CvbPCUG-2yZy61wYaS1g@mail.gmail.com>
Message-ID: <d6e6d6b1-ca97-9cf6-05a5-c3d0c5ecda79@uni-muenster.de>

You may try something along these lines:

# read data.frame with read.csv; here, we create an example by hand:
df = data.frame(
		a = 1:3, b = 3:1, geom = c("LINESTRING(0 0, 1 1)", "LINESTRING(1 1,2
2)", "LINESTRING(5 5,6 6)")
)

library(sf)
sf = st_sf(df, geom = st_as_sfc(df$geom))
sf


On 10/15/19 1:58 PM, argunaw . wrote:
> I'm not sure how it was exported from postgis- the person who gave me the
> file wasn't the one who downloaded it unfortunately.
> 
> The file is a line file of roads. The files main columns are road ID
> numbers (type integer) and the geometry column (type geometry, long strong
> of letters and numbers). Only the IT admins where I am have the postgis
> load/import tools in the pgadmin/sql interface. The rest of us can download
> from sql and create new tables from other sql databases, but not create a
> new table from a csv file.
> 
> On Tue, Oct 15, 2019 at 1:11 PM Alex Mandel <tech_dev at wildintellect.com>
> wrote:
> 
>> On 10/15/19 8:43 AM, argunaw . wrote:
>>> Hello Everyone,
>>>
>>> I have a csv file with a postgis "geometry" column. I've been trying to
>>> import it in to R as a SF file, with the goal of exporting it to a
>> postgis
>>> database, but to no avail. I've used the following methods:
>>>
>>> 1. file <- st_read("name.csv", stringsAsFactors=F, geometry_column=geom)
>>>
>>> 2. file <- fread("name.csv", headers=True)
>>>     file <- st_as_sf(file)
>>>
>>> How can I import a csv with a postgis "geometry" column in to R as a
>>> spatial/SF object?
>>>
>>>       [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>> Can you paste an example somewhere, is it binary data or some kind of
>> plain text column? Do you know how it was exported from Postgis?
>>
>> If it's a dump from a postgis database did you try loading the table
>> directly to postgis with it's own load/import, or sql tools?
>>
>> Thanks,
>> Alex
>>
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48151 Muenster, Germany
Phone: +49 251 8333081

-------------- next part --------------
A non-text attachment was scrubbed...
Name: pEpkey.asc
Type: application/pgp-keys
Size: 3110 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20191015/0201442e/attachment.bin>

From @rgun@w @end|ng |rom gm@||@com  Tue Oct 15 20:31:08 2019
From: @rgun@w @end|ng |rom gm@||@com (argunaw .)
Date: Tue, 15 Oct 2019 14:31:08 -0400
Subject: [R-sig-Geo] CSV with Geometry Column to SF object
In-Reply-To: <d6e6d6b1-ca97-9cf6-05a5-c3d0c5ecda79@uni-muenster.de>
References: <CAOjYuEbwE1E=e2HOO0f74FtQoaK6N0TzDUf=FU9zx9mY6Zv0gw@mail.gmail.com>
 <ecee49db-d5f0-57ef-de65-78ddfa01e2d2@wildintellect.com>
 <CAOjYuEY=-bEJwDmH2cwTsDA8+LDXQ9CvbPCUG-2yZy61wYaS1g@mail.gmail.com>
 <d6e6d6b1-ca97-9cf6-05a5-c3d0c5ecda79@uni-muenster.de>
Message-ID: <CAOjYuEY0L1+-5E5OvpdqjUcgHYO9Y3XMMYmxDXQO83X68pfE_g@mail.gmail.com>

  When I run this, I get the following error:

*Error in CPL_sfc_from_wkt(x) : OGR error*

When I run it on my data, I get the same error.

On Tue, Oct 15, 2019 at 2:16 PM Edzer Pebesma <edzer.pebesma at uni-muenster.de>
wrote:

> You may try something along these lines:
>
> # read data.frame with read.csv; here, we create an example by hand:
> df = data.frame(
>                 a = 1:3, b = 3:1, geom = c("LINESTRING(0 0, 1 1)",
> "LINESTRING(1 1,2
> 2)", "LINESTRING(5 5,6 6)")
> )
>
> library(sf)
> sf = st_sf(df, geom = st_as_sfc(df$geom))
> sf
>
>
> On 10/15/19 1:58 PM, argunaw . wrote:
> > I'm not sure how it was exported from postgis- the person who gave me the
> > file wasn't the one who downloaded it unfortunately.
> >
> > The file is a line file of roads. The files main columns are road ID
> > numbers (type integer) and the geometry column (type geometry, long
> strong
> > of letters and numbers). Only the IT admins where I am have the postgis
> > load/import tools in the pgadmin/sql interface. The rest of us can
> download
> > from sql and create new tables from other sql databases, but not create a
> > new table from a csv file.
> >
> > On Tue, Oct 15, 2019 at 1:11 PM Alex Mandel <tech_dev at wildintellect.com>
> > wrote:
> >
> >> On 10/15/19 8:43 AM, argunaw . wrote:
> >>> Hello Everyone,
> >>>
> >>> I have a csv file with a postgis "geometry" column. I've been trying to
> >>> import it in to R as a SF file, with the goal of exporting it to a
> >> postgis
> >>> database, but to no avail. I've used the following methods:
> >>>
> >>> 1. file <- st_read("name.csv", stringsAsFactors=F,
> geometry_column=geom)
> >>>
> >>> 2. file <- fread("name.csv", headers=True)
> >>>     file <- st_as_sf(file)
> >>>
> >>> How can I import a csv with a postgis "geometry" column in to R as a
> >>> spatial/SF object?
> >>>
> >>>       [[alternative HTML version deleted]]
> >>>
> >>> _______________________________________________
> >>> R-sig-Geo mailing list
> >>> R-sig-Geo at r-project.org
> >>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>>
> >>
> >> Can you paste an example somewhere, is it binary data or some kind of
> >> plain text column? Do you know how it was exported from Postgis?
> >>
> >> If it's a dump from a postgis database did you try loading the table
> >> directly to postgis with it's own load/import, or sql tools?
> >>
> >> Thanks,
> >> Alex
> >>
> >
> >       [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
> --
> Edzer Pebesma
> Institute for Geoinformatics
> Heisenbergstrasse 2, 48151 Muenster, Germany
> Phone: +49 251 8333081
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From edzer@pebe@m@ @end|ng |rom un|-muen@ter@de  Tue Oct 15 21:30:05 2019
From: edzer@pebe@m@ @end|ng |rom un|-muen@ter@de (Edzer Pebesma)
Date: Tue, 15 Oct 2019 15:30:05 -0400
Subject: [R-sig-Geo] CSV with Geometry Column to SF object
In-Reply-To: <CAOjYuEY0L1+-5E5OvpdqjUcgHYO9Y3XMMYmxDXQO83X68pfE_g@mail.gmail.com>
References: <CAOjYuEbwE1E=e2HOO0f74FtQoaK6N0TzDUf=FU9zx9mY6Zv0gw@mail.gmail.com>
 <ecee49db-d5f0-57ef-de65-78ddfa01e2d2@wildintellect.com>
 <CAOjYuEY=-bEJwDmH2cwTsDA8+LDXQ9CvbPCUG-2yZy61wYaS1g@mail.gmail.com>
 <d6e6d6b1-ca97-9cf6-05a5-c3d0c5ecda79@uni-muenster.de>
 <CAOjYuEY0L1+-5E5OvpdqjUcgHYO9Y3XMMYmxDXQO83X68pfE_g@mail.gmail.com>
Message-ID: <afd84150-c605-aff4-34f5-5ac9b92ef689@uni-muenster.de>

Without sharing a (minimal) reproducible example, it is unlikely that
someone else can help you find out whether this points to a problem in
your data, or in the software.

On 10/15/19 2:31 PM, argunaw . wrote:
> ? When I run this, I get the following?error:
> 
> *Error in CPL_sfc_from_wkt(x) : OGR error*
> 
> When I run it on my data, I get the same error.
> 
> On Tue, Oct 15, 2019 at 2:16 PM Edzer Pebesma
> <edzer.pebesma at uni-muenster.de <mailto:edzer.pebesma at uni-muenster.de>>
> wrote:
> 
>     You may try something along these lines:
> 
>     # read data.frame with read.csv; here, we create an example by hand:
>     df = data.frame(
>     ? ? ? ? ? ? ? ? a = 1:3, b = 3:1, geom = c("LINESTRING(0 0, 1 1)",
>     "LINESTRING(1 1,2
>     2)", "LINESTRING(5 5,6 6)")
>     )
> 
>     library(sf)
>     sf = st_sf(df, geom = st_as_sfc(df$geom))
>     sf
> 
> 
>     On 10/15/19 1:58 PM, argunaw . wrote:
>     > I'm not sure how it was exported from postgis- the person who gave
>     me the
>     > file wasn't the one who downloaded it unfortunately.
>     >
>     > The file is a line file of roads. The files main columns are road ID
>     > numbers (type integer) and the geometry column (type geometry,
>     long strong
>     > of letters and numbers). Only the IT admins where I am have the
>     postgis
>     > load/import tools in the pgadmin/sql interface. The rest of us can
>     download
>     > from sql and create new tables from other sql databases, but not
>     create a
>     > new table from a csv file.
>     >
>     > On Tue, Oct 15, 2019 at 1:11 PM Alex Mandel
>     <tech_dev at wildintellect.com <mailto:tech_dev at wildintellect.com>>
>     > wrote:
>     >
>     >> On 10/15/19 8:43 AM, argunaw . wrote:
>     >>> Hello Everyone,
>     >>>
>     >>> I have a csv file with a postgis "geometry" column. I've been
>     trying to
>     >>> import it in to R as a SF file, with the goal of exporting it to a
>     >> postgis
>     >>> database, but to no avail. I've used the following methods:
>     >>>
>     >>> 1. file <- st_read("name.csv", stringsAsFactors=F,
>     geometry_column=geom)
>     >>>
>     >>> 2. file <- fread("name.csv", headers=True)
>     >>>? ? ?file <- st_as_sf(file)
>     >>>
>     >>> How can I import a csv with a postgis "geometry" column in to R as a
>     >>> spatial/SF object?
>     >>>
>     >>>? ? ? ?[[alternative HTML version deleted]]
>     >>>
>     >>> _______________________________________________
>     >>> R-sig-Geo mailing list
>     >>> R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>     >>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>     >>>
>     >>
>     >> Can you paste an example somewhere, is it binary data or some kind of
>     >> plain text column? Do you know how it was exported from Postgis?
>     >>
>     >> If it's a dump from a postgis database did you try loading the table
>     >> directly to postgis with it's own load/import, or sql tools?
>     >>
>     >> Thanks,
>     >> Alex
>     >>
>     >
>     >? ? ? ?[[alternative HTML version deleted]]
>     >
>     > _______________________________________________
>     > R-sig-Geo mailing list
>     > R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>     > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>     >
> 
>     -- 
>     Edzer Pebesma
>     Institute for Geoinformatics
>     Heisenbergstrasse 2, 48151 Muenster, Germany
>     Phone: +49 251 8333081
>     _______________________________________________
>     R-sig-Geo mailing list
>     R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>     https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48151 Muenster, Germany
Phone: +49 251 8333081

-------------- next part --------------
A non-text attachment was scrubbed...
Name: pEpkey.asc
Type: application/pgp-keys
Size: 3110 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20191015/d3834479/attachment.bin>

From dexter@|ocke @end|ng |rom gm@||@com  Tue Oct 15 21:34:12 2019
From: dexter@|ocke @end|ng |rom gm@||@com (Dexter Locke)
Date: Tue, 15 Oct 2019 15:34:12 -0400
Subject: [R-sig-Geo] CSV with Geometry Column to SF object
In-Reply-To: <afd84150-c605-aff4-34f5-5ac9b92ef689@uni-muenster.de>
References: <CAOjYuEbwE1E=e2HOO0f74FtQoaK6N0TzDUf=FU9zx9mY6Zv0gw@mail.gmail.com>
 <ecee49db-d5f0-57ef-de65-78ddfa01e2d2@wildintellect.com>
 <CAOjYuEY=-bEJwDmH2cwTsDA8+LDXQ9CvbPCUG-2yZy61wYaS1g@mail.gmail.com>
 <d6e6d6b1-ca97-9cf6-05a5-c3d0c5ecda79@uni-muenster.de>
 <CAOjYuEY0L1+-5E5OvpdqjUcgHYO9Y3XMMYmxDXQO83X68pfE_g@mail.gmail.com>
 <afd84150-c605-aff4-34f5-5ac9b92ef689@uni-muenster.de>
Message-ID: <CAA=SVwFkdCM3nfjaV7H6XF-KwiqdokDFNT=dvw2FBgjGmV-kbw@mail.gmail.com>

For what it's worth, Edzer's reproducible example worked just fine for me
and did not throw the error described.

I'm using R version 3.6.0 (2019-04-26) -- "Planting of a Tree" on a Mac.

-Dexter



On Tue, Oct 15, 2019 at 3:30 PM Edzer Pebesma <edzer.pebesma at uni-muenster.de>
wrote:

> Without sharing a (minimal) reproducible example, it is unlikely that
> someone else can help you find out whether this points to a problem in
> your data, or in the software.
>
> On 10/15/19 2:31 PM, argunaw . wrote:
> >   When I run this, I get the following error:
> >
> > *Error in CPL_sfc_from_wkt(x) : OGR error*
> >
> > When I run it on my data, I get the same error.
> >
> > On Tue, Oct 15, 2019 at 2:16 PM Edzer Pebesma
> > <edzer.pebesma at uni-muenster.de <mailto:edzer.pebesma at uni-muenster.de>>
> > wrote:
> >
> >     You may try something along these lines:
> >
> >     # read data.frame with read.csv; here, we create an example by hand:
> >     df = data.frame(
> >                     a = 1:3, b = 3:1, geom = c("LINESTRING(0 0, 1 1)",
> >     "LINESTRING(1 1,2
> >     2)", "LINESTRING(5 5,6 6)")
> >     )
> >
> >     library(sf)
> >     sf = st_sf(df, geom = st_as_sfc(df$geom))
> >     sf
> >
> >
> >     On 10/15/19 1:58 PM, argunaw . wrote:
> >     > I'm not sure how it was exported from postgis- the person who gave
> >     me the
> >     > file wasn't the one who downloaded it unfortunately.
> >     >
> >     > The file is a line file of roads. The files main columns are road
> ID
> >     > numbers (type integer) and the geometry column (type geometry,
> >     long strong
> >     > of letters and numbers). Only the IT admins where I am have the
> >     postgis
> >     > load/import tools in the pgadmin/sql interface. The rest of us can
> >     download
> >     > from sql and create new tables from other sql databases, but not
> >     create a
> >     > new table from a csv file.
> >     >
> >     > On Tue, Oct 15, 2019 at 1:11 PM Alex Mandel
> >     <tech_dev at wildintellect.com <mailto:tech_dev at wildintellect.com>>
> >     > wrote:
> >     >
> >     >> On 10/15/19 8:43 AM, argunaw . wrote:
> >     >>> Hello Everyone,
> >     >>>
> >     >>> I have a csv file with a postgis "geometry" column. I've been
> >     trying to
> >     >>> import it in to R as a SF file, with the goal of exporting it to
> a
> >     >> postgis
> >     >>> database, but to no avail. I've used the following methods:
> >     >>>
> >     >>> 1. file <- st_read("name.csv", stringsAsFactors=F,
> >     geometry_column=geom)
> >     >>>
> >     >>> 2. file <- fread("name.csv", headers=True)
> >     >>>     file <- st_as_sf(file)
> >     >>>
> >     >>> How can I import a csv with a postgis "geometry" column in to R
> as a
> >     >>> spatial/SF object?
> >     >>>
> >     >>>       [[alternative HTML version deleted]]
> >     >>>
> >     >>> _______________________________________________
> >     >>> R-sig-Geo mailing list
> >     >>> R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
> >     >>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >     >>>
> >     >>
> >     >> Can you paste an example somewhere, is it binary data or some
> kind of
> >     >> plain text column? Do you know how it was exported from Postgis?
> >     >>
> >     >> If it's a dump from a postgis database did you try loading the
> table
> >     >> directly to postgis with it's own load/import, or sql tools?
> >     >>
> >     >> Thanks,
> >     >> Alex
> >     >>
> >     >
> >     >       [[alternative HTML version deleted]]
> >     >
> >     > _______________________________________________
> >     > R-sig-Geo mailing list
> >     > R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
> >     > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >     >
> >
> >     --
> >     Edzer Pebesma
> >     Institute for Geoinformatics
> >     Heisenbergstrasse 2, 48151 Muenster, Germany
> >     Phone: +49 251 8333081
> >     _______________________________________________
> >     R-sig-Geo mailing list
> >     R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
> >     https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
> --
> Edzer Pebesma
> Institute for Geoinformatics
> Heisenbergstrasse 2, 48151 Muenster, Germany
> Phone: +49 251 8333081
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From @rgun@w @end|ng |rom gm@||@com  Tue Oct 15 21:35:12 2019
From: @rgun@w @end|ng |rom gm@||@com (argunaw .)
Date: Tue, 15 Oct 2019 15:35:12 -0400
Subject: [R-sig-Geo] CSV with Geometry Column to SF object
In-Reply-To: <afd84150-c605-aff4-34f5-5ac9b92ef689@uni-muenster.de>
References: <CAOjYuEbwE1E=e2HOO0f74FtQoaK6N0TzDUf=FU9zx9mY6Zv0gw@mail.gmail.com>
 <ecee49db-d5f0-57ef-de65-78ddfa01e2d2@wildintellect.com>
 <CAOjYuEY=-bEJwDmH2cwTsDA8+LDXQ9CvbPCUG-2yZy61wYaS1g@mail.gmail.com>
 <d6e6d6b1-ca97-9cf6-05a5-c3d0c5ecda79@uni-muenster.de>
 <CAOjYuEY0L1+-5E5OvpdqjUcgHYO9Y3XMMYmxDXQO83X68pfE_g@mail.gmail.com>
 <afd84150-c605-aff4-34f5-5ac9b92ef689@uni-muenster.de>
Message-ID: <CAOjYuEaUQiXCxWUy=eFEDHGAmp0oG8K+R6m5X7hvxr9ZwvAS9w@mail.gmail.com>

Here is a small sample of the dataset I'm working with- the strings are
really long for geometry, so apologies for the messiness.

df = data.frame(a=1:5,
geom=c("0105000020D70800000100000001020000000C000000003BA049F49B2E4100667C2F07460F410012BC05F09B2E4100303670E4480F410019849E1D9C2E41007A13FB1B4C0F4180AFF579479C2E41005C30996E4E0F41001E3A23509C2E4100D0F0A76A500F41803BD015919C2E41004A1AFBA7540F4180024687D89C2E4100BA8183FD560F418067F48E3D9D2E410064EAE9D4590F4100852B29879D2E41007AD06D445C0F410053C7ADB99D2E4100D614CECE5F0F41006A378D0F9E2E4100E6D2D363620F4180781D0D679E2E41007829482A660F41",

"0105000020D70800000100000001020000000200000080048144E38A2E41001E996E65F20A41805C14EE428B2E41005617618EF50A41",

"0105000020D70800000100000001020000001000000000BCB1D1E4422E4100849F4AD0080B4100488B8FF4422E410068152BB9080B4180EAB54700432E41005C2514B3080B4180AA3AE40C432E410064D20EED080B418070941924432E410040A7A9C8090B41804CCB531B432E4100404D67F30A0B41002BC5321F432E410018CD40860B0B4180A9BACC4D432E4100F28879DF0C0B41001AD40E5C432E4100926C30C40D0B4100D441C34C432E41008CA36CE60E0B41804AC53247432E4100C6690DEF100B4100301C7F5A432E4100D2A6CAFB110B41008ACBB368432E41005C8E4620120B418015BE847C432E4100E00A9720120B4100810557AC432E4100F21844CA110B4100EFBB0ADF432E4100CCA9429A110B410",

"0105000020D708000001000000010200000003000000009875DF60AC2D4100606296BDAC07410037DB98F1AC2D41001C5EFC79AA074180A23112E1AA2D41001E0E5F18A20741",

"0105000020D708000001000000010200000004000000809F59A9A8E02D41009EACC82A130841807FA2D79DE02D410092AB7B64130841007843FF9CE02D41003434DFAE130841805FF302D9E02D41002AC2FE9C180841"))

On Tue, Oct 15, 2019 at 3:30 PM Edzer Pebesma <edzer.pebesma at uni-muenster.de>
wrote:

> Without sharing a (minimal) reproducible example, it is unlikely that
> someone else can help you find out whether this points to a problem in
> your data, or in the software.
>
> On 10/15/19 2:31 PM, argunaw . wrote:
> >   When I run this, I get the following error:
> >
> > *Error in CPL_sfc_from_wkt(x) : OGR error*
> >
> > When I run it on my data, I get the same error.
> >
> > On Tue, Oct 15, 2019 at 2:16 PM Edzer Pebesma
> > <edzer.pebesma at uni-muenster.de <mailto:edzer.pebesma at uni-muenster.de>>
> > wrote:
> >
> >     You may try something along these lines:
> >
> >     # read data.frame with read.csv; here, we create an example by hand:
> >     df = data.frame(
> >                     a = 1:3, b = 3:1, geom = c("LINESTRING(0 0, 1 1)",
> >     "LINESTRING(1 1,2
> >     2)", "LINESTRING(5 5,6 6)")
> >     )
> >
> >     library(sf)
> >     sf = st_sf(df, geom = st_as_sfc(df$geom))
> >     sf
> >
> >
> >     On 10/15/19 1:58 PM, argunaw . wrote:
> >     > I'm not sure how it was exported from postgis- the person who gave
> >     me the
> >     > file wasn't the one who downloaded it unfortunately.
> >     >
> >     > The file is a line file of roads. The files main columns are road
> ID
> >     > numbers (type integer) and the geometry column (type geometry,
> >     long strong
> >     > of letters and numbers). Only the IT admins where I am have the
> >     postgis
> >     > load/import tools in the pgadmin/sql interface. The rest of us can
> >     download
> >     > from sql and create new tables from other sql databases, but not
> >     create a
> >     > new table from a csv file.
> >     >
> >     > On Tue, Oct 15, 2019 at 1:11 PM Alex Mandel
> >     <tech_dev at wildintellect.com <mailto:tech_dev at wildintellect.com>>
> >     > wrote:
> >     >
> >     >> On 10/15/19 8:43 AM, argunaw . wrote:
> >     >>> Hello Everyone,
> >     >>>
> >     >>> I have a csv file with a postgis "geometry" column. I've been
> >     trying to
> >     >>> import it in to R as a SF file, with the goal of exporting it to
> a
> >     >> postgis
> >     >>> database, but to no avail. I've used the following methods:
> >     >>>
> >     >>> 1. file <- st_read("name.csv", stringsAsFactors=F,
> >     geometry_column=geom)
> >     >>>
> >     >>> 2. file <- fread("name.csv", headers=True)
> >     >>>     file <- st_as_sf(file)
> >     >>>
> >     >>> How can I import a csv with a postgis "geometry" column in to R
> as a
> >     >>> spatial/SF object?
> >     >>>
> >     >>>       [[alternative HTML version deleted]]
> >     >>>
> >     >>> _______________________________________________
> >     >>> R-sig-Geo mailing list
> >     >>> R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
> >     >>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >     >>>
> >     >>
> >     >> Can you paste an example somewhere, is it binary data or some
> kind of
> >     >> plain text column? Do you know how it was exported from Postgis?
> >     >>
> >     >> If it's a dump from a postgis database did you try loading the
> table
> >     >> directly to postgis with it's own load/import, or sql tools?
> >     >>
> >     >> Thanks,
> >     >> Alex
> >     >>
> >     >
> >     >       [[alternative HTML version deleted]]
> >     >
> >     > _______________________________________________
> >     > R-sig-Geo mailing list
> >     > R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
> >     > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >     >
> >
> >     --
> >     Edzer Pebesma
> >     Institute for Geoinformatics
> >     Heisenbergstrasse 2, 48151 Muenster, Germany
> >     Phone: +49 251 8333081
> >     _______________________________________________
> >     R-sig-Geo mailing list
> >     R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
> >     https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
> --
> Edzer Pebesma
> Institute for Geoinformatics
> Heisenbergstrasse 2, 48151 Muenster, Germany
> Phone: +49 251 8333081
>

	[[alternative HTML version deleted]]


From b@row||ng@on @end|ng |rom gm@||@com  Tue Oct 15 21:47:34 2019
From: b@row||ng@on @end|ng |rom gm@||@com (Barry Rowlingson)
Date: Tue, 15 Oct 2019 20:47:34 +0100
Subject: [R-sig-Geo] CSV with Geometry Column to SF object
In-Reply-To: <CAOjYuEaUQiXCxWUy=eFEDHGAmp0oG8K+R6m5X7hvxr9ZwvAS9w@mail.gmail.com>
References: <CAOjYuEbwE1E=e2HOO0f74FtQoaK6N0TzDUf=FU9zx9mY6Zv0gw@mail.gmail.com>
 <ecee49db-d5f0-57ef-de65-78ddfa01e2d2@wildintellect.com>
 <CAOjYuEY=-bEJwDmH2cwTsDA8+LDXQ9CvbPCUG-2yZy61wYaS1g@mail.gmail.com>
 <d6e6d6b1-ca97-9cf6-05a5-c3d0c5ecda79@uni-muenster.de>
 <CAOjYuEY0L1+-5E5OvpdqjUcgHYO9Y3XMMYmxDXQO83X68pfE_g@mail.gmail.com>
 <afd84150-c605-aff4-34f5-5ac9b92ef689@uni-muenster.de>
 <CAOjYuEaUQiXCxWUy=eFEDHGAmp0oG8K+R6m5X7hvxr9ZwvAS9w@mail.gmail.com>
Message-ID: <CANVKczOAqxJomDfcThz6m1PMGd1xAv+nG_cqdDnA1XqL_FH44Q@mail.gmail.com>

These strings are hexadecimal WKB geometries. You should be able to turn
them back into geometries:

 > s =
"0105000020D708000001000000010200000003000000009875DF60AC2D4100606296BDAC07410037DB98F1AC2D41001C5EFC79AA074180A23112E1AA2D41001E0E5F18A20741"

by constructing a WKB object:

> wkb = structure(list(s), class = "WKB")

and then:

 > st_as_sfc(wkb)
wkbType: 536870917
Error in CPL_read_wkb(x, EWKB, spatialite) :
  unsupported wkbType dim in switch

but that error looks bad...

ahaha, they are EWKB:

> st_as_sfc(wkb, EWKB=TRUE)
Geometry set for 1 feature
geometry type:  MULTILINESTRING
dimension:      XY
bbox:           xmin: 972144.5 ymin: 193603 xmax: 972408.8 ymax: 193943.7
epsg (SRID):    2263
proj4string:    +proj=lcc +lat_1=41.03333333333333 +lat_2=40.66666666666666
+lat_0=40.16666666666666 +lon_0=-74 +x_0=300000.0000000001 +y_0=0
+ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=us-ft +no_defs
MULTILINESTRING ((972336.4 193943.7, 972408.8 1...


On Tue, Oct 15, 2019 at 8:40 PM argunaw . <argunaw at gmail.com> wrote:

> Here is a small sample of the dataset I'm working with- the strings are
> really long for geometry, so apologies for the messiness.
>
> df = data.frame(a=1:5,
>
> geom=c("0105000020D70800000100000001020000000C000000003BA049F49B2E4100667C2F07460F410012BC05F09B2E4100303670E4480F410019849E1D9C2E41007A13FB1B4C0F4180AFF579479C2E41005C30996E4E0F41001E3A23509C2E4100D0F0A76A500F41803BD015919C2E41004A1AFBA7540F4180024687D89C2E4100BA8183FD560F418067F48E3D9D2E410064EAE9D4590F4100852B29879D2E41007AD06D445C0F410053C7ADB99D2E4100D614CECE5F0F41006A378D0F9E2E4100E6D2D363620F4180781D0D679E2E41007829482A660F41",
>
>
> "0105000020D70800000100000001020000000200000080048144E38A2E41001E996E65F20A41805C14EE428B2E41005617618EF50A41",
>
>
> "0105000020D70800000100000001020000001000000000BCB1D1E4422E4100849F4AD0080B4100488B8FF4422E410068152BB9080B4180EAB54700432E41005C2514B3080B4180AA3AE40C432E410064D20EED080B418070941924432E410040A7A9C8090B41804CCB531B432E4100404D67F30A0B41002BC5321F432E410018CD40860B0B4180A9BACC4D432E4100F28879DF0C0B41001AD40E5C432E4100926C30C40D0B4100D441C34C432E41008CA36CE60E0B41804AC53247432E4100C6690DEF100B4100301C7F5A432E4100D2A6CAFB110B41008ACBB368432E41005C8E4620120B418015BE847C432E4100E00A9720120B4100810557AC432E4100F21844CA110B4100EFBB0ADF432E4100CCA9429A110B410",
>
>
> "0105000020D708000001000000010200000003000000009875DF60AC2D4100606296BDAC07410037DB98F1AC2D41001C5EFC79AA074180A23112E1AA2D41001E0E5F18A20741",
>
>
> "0105000020D708000001000000010200000004000000809F59A9A8E02D41009EACC82A130841807FA2D79DE02D410092AB7B64130841007843FF9CE02D41003434DFAE130841805FF302D9E02D41002AC2FE9C180841"))
>
> On Tue, Oct 15, 2019 at 3:30 PM Edzer Pebesma <
> edzer.pebesma at uni-muenster.de>
> wrote:
>
> > Without sharing a (minimal) reproducible example, it is unlikely that
> > someone else can help you find out whether this points to a problem in
> > your data, or in the software.
> >
> > On 10/15/19 2:31 PM, argunaw . wrote:
> > >   When I run this, I get the following error:
> > >
> > > *Error in CPL_sfc_from_wkt(x) : OGR error*
> > >
> > > When I run it on my data, I get the same error.
> > >
> > > On Tue, Oct 15, 2019 at 2:16 PM Edzer Pebesma
> > > <edzer.pebesma at uni-muenster.de <mailto:edzer.pebesma at uni-muenster.de>>
> > > wrote:
> > >
> > >     You may try something along these lines:
> > >
> > >     # read data.frame with read.csv; here, we create an example by
> hand:
> > >     df = data.frame(
> > >                     a = 1:3, b = 3:1, geom = c("LINESTRING(0 0, 1 1)",
> > >     "LINESTRING(1 1,2
> > >     2)", "LINESTRING(5 5,6 6)")
> > >     )
> > >
> > >     library(sf)
> > >     sf = st_sf(df, geom = st_as_sfc(df$geom))
> > >     sf
> > >
> > >
> > >     On 10/15/19 1:58 PM, argunaw . wrote:
> > >     > I'm not sure how it was exported from postgis- the person who
> gave
> > >     me the
> > >     > file wasn't the one who downloaded it unfortunately.
> > >     >
> > >     > The file is a line file of roads. The files main columns are road
> > ID
> > >     > numbers (type integer) and the geometry column (type geometry,
> > >     long strong
> > >     > of letters and numbers). Only the IT admins where I am have the
> > >     postgis
> > >     > load/import tools in the pgadmin/sql interface. The rest of us
> can
> > >     download
> > >     > from sql and create new tables from other sql databases, but not
> > >     create a
> > >     > new table from a csv file.
> > >     >
> > >     > On Tue, Oct 15, 2019 at 1:11 PM Alex Mandel
> > >     <tech_dev at wildintellect.com <mailto:tech_dev at wildintellect.com>>
> > >     > wrote:
> > >     >
> > >     >> On 10/15/19 8:43 AM, argunaw . wrote:
> > >     >>> Hello Everyone,
> > >     >>>
> > >     >>> I have a csv file with a postgis "geometry" column. I've been
> > >     trying to
> > >     >>> import it in to R as a SF file, with the goal of exporting it
> to
> > a
> > >     >> postgis
> > >     >>> database, but to no avail. I've used the following methods:
> > >     >>>
> > >     >>> 1. file <- st_read("name.csv", stringsAsFactors=F,
> > >     geometry_column=geom)
> > >     >>>
> > >     >>> 2. file <- fread("name.csv", headers=True)
> > >     >>>     file <- st_as_sf(file)
> > >     >>>
> > >     >>> How can I import a csv with a postgis "geometry" column in to R
> > as a
> > >     >>> spatial/SF object?
> > >     >>>
> > >     >>>       [[alternative HTML version deleted]]
> > >     >>>
> > >     >>> _______________________________________________
> > >     >>> R-sig-Geo mailing list
> > >     >>> R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
> > >     >>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > >     >>>
> > >     >>
> > >     >> Can you paste an example somewhere, is it binary data or some
> > kind of
> > >     >> plain text column? Do you know how it was exported from Postgis?
> > >     >>
> > >     >> If it's a dump from a postgis database did you try loading the
> > table
> > >     >> directly to postgis with it's own load/import, or sql tools?
> > >     >>
> > >     >> Thanks,
> > >     >> Alex
> > >     >>
> > >     >
> > >     >       [[alternative HTML version deleted]]
> > >     >
> > >     > _______________________________________________
> > >     > R-sig-Geo mailing list
> > >     > R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
> > >     > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > >     >
> > >
> > >     --
> > >     Edzer Pebesma
> > >     Institute for Geoinformatics
> > >     Heisenbergstrasse 2, 48151 Muenster, Germany
> > >     Phone: +49 251 8333081
> > >     _______________________________________________
> > >     R-sig-Geo mailing list
> > >     R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
> > >     https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > >
> >
> > --
> > Edzer Pebesma
> > Institute for Geoinformatics
> > Heisenbergstrasse 2, 48151 Muenster, Germany
> > Phone: +49 251 8333081
> >
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From b@row||ng@on @end|ng |rom gm@||@com  Wed Oct 16 10:41:08 2019
From: b@row||ng@on @end|ng |rom gm@||@com (Barry Rowlingson)
Date: Wed, 16 Oct 2019 09:41:08 +0100
Subject: [R-sig-Geo] CSV with Geometry Column to SF object
In-Reply-To: <CANVKczOAqxJomDfcThz6m1PMGd1xAv+nG_cqdDnA1XqL_FH44Q@mail.gmail.com>
References: <CAOjYuEbwE1E=e2HOO0f74FtQoaK6N0TzDUf=FU9zx9mY6Zv0gw@mail.gmail.com>
 <ecee49db-d5f0-57ef-de65-78ddfa01e2d2@wildintellect.com>
 <CAOjYuEY=-bEJwDmH2cwTsDA8+LDXQ9CvbPCUG-2yZy61wYaS1g@mail.gmail.com>
 <d6e6d6b1-ca97-9cf6-05a5-c3d0c5ecda79@uni-muenster.de>
 <CAOjYuEY0L1+-5E5OvpdqjUcgHYO9Y3XMMYmxDXQO83X68pfE_g@mail.gmail.com>
 <afd84150-c605-aff4-34f5-5ac9b92ef689@uni-muenster.de>
 <CAOjYuEaUQiXCxWUy=eFEDHGAmp0oG8K+R6m5X7hvxr9ZwvAS9w@mail.gmail.com>
 <CANVKczOAqxJomDfcThz6m1PMGd1xAv+nG_cqdDnA1XqL_FH44Q@mail.gmail.com>
Message-ID: <CANVKczOtC60oQeORANP8VP25ad_zEkEOZYAWq_5dJYeAQHUE1A@mail.gmail.com>

After a night's sleep, here's a full solution for your sample data frame:

1. convert the geometry strings to sf spatial objects:
newGeom = st_as_sfc(structure(as.character(df$geom), class =
"WKB"),EWKB=TRUE)

2. create a new spatial data frame with the new spatial objects as geometry
sdf = st_set_geometry(df, newGeom)

3. (optional) drop the character format column
sdf$geom=NULL

Now you've got a standard `sf` spatial data frame with the converted
geometry. If any of that is wrong I'm sure the real experts here will
correct me.

Barry



On Tue, Oct 15, 2019 at 8:47 PM Barry Rowlingson <b.rowlingson at gmail.com>
wrote:

> These strings are hexadecimal WKB geometries. You should be able to turn
> them back into geometries:
>
>  > s =
> "0105000020D708000001000000010200000003000000009875DF60AC2D4100606296BDAC07410037DB98F1AC2D41001C5EFC79AA074180A23112E1AA2D41001E0E5F18A20741"
>
> by constructing a WKB object:
>
> > wkb = structure(list(s), class = "WKB")
>
> and then:
>
>  > st_as_sfc(wkb)
> wkbType: 536870917
> Error in CPL_read_wkb(x, EWKB, spatialite) :
>   unsupported wkbType dim in switch
>
> but that error looks bad...
>
> ahaha, they are EWKB:
>
> > st_as_sfc(wkb, EWKB=TRUE)
> Geometry set for 1 feature
> geometry type:  MULTILINESTRING
> dimension:      XY
> bbox:           xmin: 972144.5 ymin: 193603 xmax: 972408.8 ymax: 193943.7
> epsg (SRID):    2263
> proj4string:    +proj=lcc +lat_1=41.03333333333333
> +lat_2=40.66666666666666 +lat_0=40.16666666666666 +lon_0=-74
> +x_0=300000.0000000001 +y_0=0 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0
> +units=us-ft +no_defs
> MULTILINESTRING ((972336.4 193943.7, 972408.8 1...
>
>
> On Tue, Oct 15, 2019 at 8:40 PM argunaw . <argunaw at gmail.com> wrote:
>
>> Here is a small sample of the dataset I'm working with- the strings are
>> really long for geometry, so apologies for the messiness.
>>
>> df = data.frame(a=1:5,
>>
>> geom=c("0105000020D70800000100000001020000000C000000003BA049F49B2E4100667C2F07460F410012BC05F09B2E4100303670E4480F410019849E1D9C2E41007A13FB1B4C0F4180AFF579479C2E41005C30996E4E0F41001E3A23509C2E4100D0F0A76A500F41803BD015919C2E41004A1AFBA7540F4180024687D89C2E4100BA8183FD560F418067F48E3D9D2E410064EAE9D4590F4100852B29879D2E41007AD06D445C0F410053C7ADB99D2E4100D614CECE5F0F41006A378D0F9E2E4100E6D2D363620F4180781D0D679E2E41007829482A660F41",
>>
>>
>> "0105000020D70800000100000001020000000200000080048144E38A2E41001E996E65F20A41805C14EE428B2E41005617618EF50A41",
>>
>>
>> "0105000020D70800000100000001020000001000000000BCB1D1E4422E4100849F4AD0080B4100488B8FF4422E410068152BB9080B4180EAB54700432E41005C2514B3080B4180AA3AE40C432E410064D20EED080B418070941924432E410040A7A9C8090B41804CCB531B432E4100404D67F30A0B41002BC5321F432E410018CD40860B0B4180A9BACC4D432E4100F28879DF0C0B41001AD40E5C432E4100926C30C40D0B4100D441C34C432E41008CA36CE60E0B41804AC53247432E4100C6690DEF100B4100301C7F5A432E4100D2A6CAFB110B41008ACBB368432E41005C8E4620120B418015BE847C432E4100E00A9720120B4100810557AC432E4100F21844CA110B4100EFBB0ADF432E4100CCA9429A110B410",
>>
>>
>> "0105000020D708000001000000010200000003000000009875DF60AC2D4100606296BDAC07410037DB98F1AC2D41001C5EFC79AA074180A23112E1AA2D41001E0E5F18A20741",
>>
>>
>> "0105000020D708000001000000010200000004000000809F59A9A8E02D41009EACC82A130841807FA2D79DE02D410092AB7B64130841007843FF9CE02D41003434DFAE130841805FF302D9E02D41002AC2FE9C180841"))
>>
>> On Tue, Oct 15, 2019 at 3:30 PM Edzer Pebesma <
>> edzer.pebesma at uni-muenster.de>
>> wrote:
>>
>> > Without sharing a (minimal) reproducible example, it is unlikely that
>> > someone else can help you find out whether this points to a problem in
>> > your data, or in the software.
>> >
>> > On 10/15/19 2:31 PM, argunaw . wrote:
>> > >   When I run this, I get the following error:
>> > >
>> > > *Error in CPL_sfc_from_wkt(x) : OGR error*
>> > >
>> > > When I run it on my data, I get the same error.
>> > >
>> > > On Tue, Oct 15, 2019 at 2:16 PM Edzer Pebesma
>> > > <edzer.pebesma at uni-muenster.de <mailto:edzer.pebesma at uni-muenster.de
>> >>
>> > > wrote:
>> > >
>> > >     You may try something along these lines:
>> > >
>> > >     # read data.frame with read.csv; here, we create an example by
>> hand:
>> > >     df = data.frame(
>> > >                     a = 1:3, b = 3:1, geom = c("LINESTRING(0 0, 1 1)",
>> > >     "LINESTRING(1 1,2
>> > >     2)", "LINESTRING(5 5,6 6)")
>> > >     )
>> > >
>> > >     library(sf)
>> > >     sf = st_sf(df, geom = st_as_sfc(df$geom))
>> > >     sf
>> > >
>> > >
>> > >     On 10/15/19 1:58 PM, argunaw . wrote:
>> > >     > I'm not sure how it was exported from postgis- the person who
>> gave
>> > >     me the
>> > >     > file wasn't the one who downloaded it unfortunately.
>> > >     >
>> > >     > The file is a line file of roads. The files main columns are
>> road
>> > ID
>> > >     > numbers (type integer) and the geometry column (type geometry,
>> > >     long strong
>> > >     > of letters and numbers). Only the IT admins where I am have the
>> > >     postgis
>> > >     > load/import tools in the pgadmin/sql interface. The rest of us
>> can
>> > >     download
>> > >     > from sql and create new tables from other sql databases, but not
>> > >     create a
>> > >     > new table from a csv file.
>> > >     >
>> > >     > On Tue, Oct 15, 2019 at 1:11 PM Alex Mandel
>> > >     <tech_dev at wildintellect.com <mailto:tech_dev at wildintellect.com>>
>> > >     > wrote:
>> > >     >
>> > >     >> On 10/15/19 8:43 AM, argunaw . wrote:
>> > >     >>> Hello Everyone,
>> > >     >>>
>> > >     >>> I have a csv file with a postgis "geometry" column. I've been
>> > >     trying to
>> > >     >>> import it in to R as a SF file, with the goal of exporting it
>> to
>> > a
>> > >     >> postgis
>> > >     >>> database, but to no avail. I've used the following methods:
>> > >     >>>
>> > >     >>> 1. file <- st_read("name.csv", stringsAsFactors=F,
>> > >     geometry_column=geom)
>> > >     >>>
>> > >     >>> 2. file <- fread("name.csv", headers=True)
>> > >     >>>     file <- st_as_sf(file)
>> > >     >>>
>> > >     >>> How can I import a csv with a postgis "geometry" column in to
>> R
>> > as a
>> > >     >>> spatial/SF object?
>> > >     >>>
>> > >     >>>       [[alternative HTML version deleted]]
>> > >     >>>
>> > >     >>> _______________________________________________
>> > >     >>> R-sig-Geo mailing list
>> > >     >>> R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>> > >     >>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> > >     >>>
>> > >     >>
>> > >     >> Can you paste an example somewhere, is it binary data or some
>> > kind of
>> > >     >> plain text column? Do you know how it was exported from
>> Postgis?
>> > >     >>
>> > >     >> If it's a dump from a postgis database did you try loading the
>> > table
>> > >     >> directly to postgis with it's own load/import, or sql tools?
>> > >     >>
>> > >     >> Thanks,
>> > >     >> Alex
>> > >     >>
>> > >     >
>> > >     >       [[alternative HTML version deleted]]
>> > >     >
>> > >     > _______________________________________________
>> > >     > R-sig-Geo mailing list
>> > >     > R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>> > >     > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> > >     >
>> > >
>> > >     --
>> > >     Edzer Pebesma
>> > >     Institute for Geoinformatics
>> > >     Heisenbergstrasse 2, 48151 Muenster, Germany
>> > >     Phone: +49 251 8333081
>> > >     _______________________________________________
>> > >     R-sig-Geo mailing list
>> > >     R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>> > >     https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> > >
>> >
>> > --
>> > Edzer Pebesma
>> > Institute for Geoinformatics
>> > Heisenbergstrasse 2, 48151 Muenster, Germany
>> > Phone: +49 251 8333081
>> >
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>

	[[alternative HTML version deleted]]


From @rgun@w @end|ng |rom gm@||@com  Wed Oct 16 16:42:37 2019
From: @rgun@w @end|ng |rom gm@||@com (argunaw .)
Date: Wed, 16 Oct 2019 10:42:37 -0400
Subject: [R-sig-Geo] CSV with Geometry Column to SF object
In-Reply-To: <CANVKczOtC60oQeORANP8VP25ad_zEkEOZYAWq_5dJYeAQHUE1A@mail.gmail.com>
References: <CAOjYuEbwE1E=e2HOO0f74FtQoaK6N0TzDUf=FU9zx9mY6Zv0gw@mail.gmail.com>
 <ecee49db-d5f0-57ef-de65-78ddfa01e2d2@wildintellect.com>
 <CAOjYuEY=-bEJwDmH2cwTsDA8+LDXQ9CvbPCUG-2yZy61wYaS1g@mail.gmail.com>
 <d6e6d6b1-ca97-9cf6-05a5-c3d0c5ecda79@uni-muenster.de>
 <CAOjYuEY0L1+-5E5OvpdqjUcgHYO9Y3XMMYmxDXQO83X68pfE_g@mail.gmail.com>
 <afd84150-c605-aff4-34f5-5ac9b92ef689@uni-muenster.de>
 <CAOjYuEaUQiXCxWUy=eFEDHGAmp0oG8K+R6m5X7hvxr9ZwvAS9w@mail.gmail.com>
 <CANVKczOAqxJomDfcThz6m1PMGd1xAv+nG_cqdDnA1XqL_FH44Q@mail.gmail.com>
 <CANVKczOtC60oQeORANP8VP25ad_zEkEOZYAWq_5dJYeAQHUE1A@mail.gmail.com>
Message-ID: <CAOjYuEZk79Qu+UL+4iVrX95B2Au4QcXHfgib5hW=xTVfzpu57A@mail.gmail.com>

This is exactly what I was looking for and answers my question. Thank you
so much!

On Wed, Oct 16, 2019 at 4:41 AM Barry Rowlingson <b.rowlingson at gmail.com>
wrote:

> After a night's sleep, here's a full solution for your sample data frame:
>
> 1. convert the geometry strings to sf spatial objects:
> newGeom = st_as_sfc(structure(as.character(df$geom), class =
> "WKB"),EWKB=TRUE)
>
> 2. create a new spatial data frame with the new spatial objects as geometry
> sdf = st_set_geometry(df, newGeom)
>
> 3. (optional) drop the character format column
> sdf$geom=NULL
>
> Now you've got a standard `sf` spatial data frame with the converted
> geometry. If any of that is wrong I'm sure the real experts here will
> correct me.
>
> Barry
>
>
>
> On Tue, Oct 15, 2019 at 8:47 PM Barry Rowlingson <b.rowlingson at gmail.com>
> wrote:
>
>> These strings are hexadecimal WKB geometries. You should be able to turn
>> them back into geometries:
>>
>>  > s =
>> "0105000020D708000001000000010200000003000000009875DF60AC2D4100606296BDAC07410037DB98F1AC2D41001C5EFC79AA074180A23112E1AA2D41001E0E5F18A20741"
>>
>> by constructing a WKB object:
>>
>> > wkb = structure(list(s), class = "WKB")
>>
>> and then:
>>
>>  > st_as_sfc(wkb)
>> wkbType: 536870917
>> Error in CPL_read_wkb(x, EWKB, spatialite) :
>>   unsupported wkbType dim in switch
>>
>> but that error looks bad...
>>
>> ahaha, they are EWKB:
>>
>> > st_as_sfc(wkb, EWKB=TRUE)
>> Geometry set for 1 feature
>> geometry type:  MULTILINESTRING
>> dimension:      XY
>> bbox:           xmin: 972144.5 ymin: 193603 xmax: 972408.8 ymax: 193943.7
>> epsg (SRID):    2263
>> proj4string:    +proj=lcc +lat_1=41.03333333333333
>> +lat_2=40.66666666666666 +lat_0=40.16666666666666 +lon_0=-74
>> +x_0=300000.0000000001 +y_0=0 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0
>> +units=us-ft +no_defs
>> MULTILINESTRING ((972336.4 193943.7, 972408.8 1...
>>
>>
>> On Tue, Oct 15, 2019 at 8:40 PM argunaw . <argunaw at gmail.com> wrote:
>>
>>> Here is a small sample of the dataset I'm working with- the strings are
>>> really long for geometry, so apologies for the messiness.
>>>
>>> df = data.frame(a=1:5,
>>>
>>> geom=c("0105000020D70800000100000001020000000C000000003BA049F49B2E4100667C2F07460F410012BC05F09B2E4100303670E4480F410019849E1D9C2E41007A13FB1B4C0F4180AFF579479C2E41005C30996E4E0F41001E3A23509C2E4100D0F0A76A500F41803BD015919C2E41004A1AFBA7540F4180024687D89C2E4100BA8183FD560F418067F48E3D9D2E410064EAE9D4590F4100852B29879D2E41007AD06D445C0F410053C7ADB99D2E4100D614CECE5F0F41006A378D0F9E2E4100E6D2D363620F4180781D0D679E2E41007829482A660F41",
>>>
>>>
>>> "0105000020D70800000100000001020000000200000080048144E38A2E41001E996E65F20A41805C14EE428B2E41005617618EF50A41",
>>>
>>>
>>> "0105000020D70800000100000001020000001000000000BCB1D1E4422E4100849F4AD0080B4100488B8FF4422E410068152BB9080B4180EAB54700432E41005C2514B3080B4180AA3AE40C432E410064D20EED080B418070941924432E410040A7A9C8090B41804CCB531B432E4100404D67F30A0B41002BC5321F432E410018CD40860B0B4180A9BACC4D432E4100F28879DF0C0B41001AD40E5C432E4100926C30C40D0B4100D441C34C432E41008CA36CE60E0B41804AC53247432E4100C6690DEF100B4100301C7F5A432E4100D2A6CAFB110B41008ACBB368432E41005C8E4620120B418015BE847C432E4100E00A9720120B4100810557AC432E4100F21844CA110B4100EFBB0ADF432E4100CCA9429A110B410",
>>>
>>>
>>> "0105000020D708000001000000010200000003000000009875DF60AC2D4100606296BDAC07410037DB98F1AC2D41001C5EFC79AA074180A23112E1AA2D41001E0E5F18A20741",
>>>
>>>
>>> "0105000020D708000001000000010200000004000000809F59A9A8E02D41009EACC82A130841807FA2D79DE02D410092AB7B64130841007843FF9CE02D41003434DFAE130841805FF302D9E02D41002AC2FE9C180841"))
>>>
>>> On Tue, Oct 15, 2019 at 3:30 PM Edzer Pebesma <
>>> edzer.pebesma at uni-muenster.de>
>>> wrote:
>>>
>>> > Without sharing a (minimal) reproducible example, it is unlikely that
>>> > someone else can help you find out whether this points to a problem in
>>> > your data, or in the software.
>>> >
>>> > On 10/15/19 2:31 PM, argunaw . wrote:
>>> > >   When I run this, I get the following error:
>>> > >
>>> > > *Error in CPL_sfc_from_wkt(x) : OGR error*
>>> > >
>>> > > When I run it on my data, I get the same error.
>>> > >
>>> > > On Tue, Oct 15, 2019 at 2:16 PM Edzer Pebesma
>>> > > <edzer.pebesma at uni-muenster.de <mailto:edzer.pebesma at uni-muenster.de
>>> >>
>>> > > wrote:
>>> > >
>>> > >     You may try something along these lines:
>>> > >
>>> > >     # read data.frame with read.csv; here, we create an example by
>>> hand:
>>> > >     df = data.frame(
>>> > >                     a = 1:3, b = 3:1, geom = c("LINESTRING(0 0, 1
>>> 1)",
>>> > >     "LINESTRING(1 1,2
>>> > >     2)", "LINESTRING(5 5,6 6)")
>>> > >     )
>>> > >
>>> > >     library(sf)
>>> > >     sf = st_sf(df, geom = st_as_sfc(df$geom))
>>> > >     sf
>>> > >
>>> > >
>>> > >     On 10/15/19 1:58 PM, argunaw . wrote:
>>> > >     > I'm not sure how it was exported from postgis- the person who
>>> gave
>>> > >     me the
>>> > >     > file wasn't the one who downloaded it unfortunately.
>>> > >     >
>>> > >     > The file is a line file of roads. The files main columns are
>>> road
>>> > ID
>>> > >     > numbers (type integer) and the geometry column (type geometry,
>>> > >     long strong
>>> > >     > of letters and numbers). Only the IT admins where I am have the
>>> > >     postgis
>>> > >     > load/import tools in the pgadmin/sql interface. The rest of us
>>> can
>>> > >     download
>>> > >     > from sql and create new tables from other sql databases, but
>>> not
>>> > >     create a
>>> > >     > new table from a csv file.
>>> > >     >
>>> > >     > On Tue, Oct 15, 2019 at 1:11 PM Alex Mandel
>>> > >     <tech_dev at wildintellect.com <mailto:tech_dev at wildintellect.com>>
>>> > >     > wrote:
>>> > >     >
>>> > >     >> On 10/15/19 8:43 AM, argunaw . wrote:
>>> > >     >>> Hello Everyone,
>>> > >     >>>
>>> > >     >>> I have a csv file with a postgis "geometry" column. I've been
>>> > >     trying to
>>> > >     >>> import it in to R as a SF file, with the goal of exporting
>>> it to
>>> > a
>>> > >     >> postgis
>>> > >     >>> database, but to no avail. I've used the following methods:
>>> > >     >>>
>>> > >     >>> 1. file <- st_read("name.csv", stringsAsFactors=F,
>>> > >     geometry_column=geom)
>>> > >     >>>
>>> > >     >>> 2. file <- fread("name.csv", headers=True)
>>> > >     >>>     file <- st_as_sf(file)
>>> > >     >>>
>>> > >     >>> How can I import a csv with a postgis "geometry" column in
>>> to R
>>> > as a
>>> > >     >>> spatial/SF object?
>>> > >     >>>
>>> > >     >>>       [[alternative HTML version deleted]]
>>> > >     >>>
>>> > >     >>> _______________________________________________
>>> > >     >>> R-sig-Geo mailing list
>>> > >     >>> R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>>> > >     >>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> > >     >>>
>>> > >     >>
>>> > >     >> Can you paste an example somewhere, is it binary data or some
>>> > kind of
>>> > >     >> plain text column? Do you know how it was exported from
>>> Postgis?
>>> > >     >>
>>> > >     >> If it's a dump from a postgis database did you try loading the
>>> > table
>>> > >     >> directly to postgis with it's own load/import, or sql tools?
>>> > >     >>
>>> > >     >> Thanks,
>>> > >     >> Alex
>>> > >     >>
>>> > >     >
>>> > >     >       [[alternative HTML version deleted]]
>>> > >     >
>>> > >     > _______________________________________________
>>> > >     > R-sig-Geo mailing list
>>> > >     > R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>>> > >     > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> > >     >
>>> > >
>>> > >     --
>>> > >     Edzer Pebesma
>>> > >     Institute for Geoinformatics
>>> > >     Heisenbergstrasse 2, 48151 Muenster, Germany
>>> > >     Phone: +49 251 8333081
>>> > >     _______________________________________________
>>> > >     R-sig-Geo mailing list
>>> > >     R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>>> > >     https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> > >
>>> >
>>> > --
>>> > Edzer Pebesma
>>> > Institute for Geoinformatics
>>> > Heisenbergstrasse 2, 48151 Muenster, Germany
>>> > Phone: +49 251 8333081
>>> >
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>

	[[alternative HTML version deleted]]


From m@rt@@m@ru||no @end|ng |rom gm@||@com  Thu Oct 17 12:47:58 2019
From: m@rt@@m@ru||no @end|ng |rom gm@||@com (Marta Rufino)
Date: Thu, 17 Oct 2019 11:47:58 +0100
Subject: [R-sig-Geo] dissolve internal borders of polygons using st_union
 and group_by
Message-ID: <CAKSASLD7B-bcMXWyzdEZECrHr_6G+q+Bo1T-K-8VHzfZp0kxPQ@mail.gmail.com>

Hi,

I am trying to dissolve the internal borders of larger polygons (sf object)
by a grouping variable or by proximity (adjacent)
and after looking in the web I found several alternatives, but none is
doing what I wanted.

## Reproducible example:
# World map
require(rnaturalearth); require(sf)
world_map <- rnaturalearth::ne_countries(scale = 'small', returnclass =
c("sf"))

# World countries:
world_map
object.size(world_map)

# 1st alternative: in this case we have the groups by continent, but the
country boundaries are still there, although without label:
(kk <- world_map %>%
  dplyr::group_by(continent) %>%
  summarise())
object.size(kk)
kk %>%
  st_transform(crs = 42310) %>%
  ggplot()+
  geom_sf()

# 2nd alternative : apparently different, but very similar...
(kk1 <- world_map %>%
  dplyr::group_by(continent) %>%
  summarise(st_union(.)))
object.size(kk1)
kk1 %>%
  st_transform(crs = 42310) %>%
  ggplot()+
  geom_sf()

# 3rd alternative
(kk2 <- world_map %>%
  dplyr::group_by(continent) %>%
  summarise(geom = st_union(geometry)))
object.size(kk2)
kk2 %>%
  st_transform(crs = 42310) %>%
  ggplot()+
  geom_sf()

# 4th alternative
(kk3 <- world_map %>%
  dplyr::group_by(continent) %>%
  summarise(geom = st_combine(geometry)))
object.size(kk3)
kk3 %>%
  st_transform(crs = 42310) %>%
  ggplot()+
  geom_sf()


# In all cases the objects produced are actually very similar at a first
glance, bur in fact they differ on the properties (as reflected by their
sizes).
object.size(world_map)
object.size(kk1)
object.size(kk2)
object.size(kk3)
object.size(kk4)

# And more importantly, in no case the borders between countries were
actually dissolved, which was my objective.


So, the question is how can I get the continents with the country borders
dissolved?
Further, could I dissolve all contiguous borders (instead of having a
grouping variable)- I saw this in a couple of posts but the answers were
very complex.

Any help will be greatly appreciated,
Best wishes,
M.



-- 
Marta M. Rufino (auxiliary researcher)

*____________________________________________________*MARE - Marine and
Environmental Sciences Centre
Faculty of Sciences, University of Lisbon
Campo Grande, 1749-016 Lisboa,
Portugal
Tel: + 351 21 750 00 00, extension: 22576

	[[alternative HTML version deleted]]


From Roger@B|v@nd @end|ng |rom nhh@no  Thu Oct 17 13:17:42 2019
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Thu, 17 Oct 2019 13:17:42 +0200
Subject: [R-sig-Geo] 
 dissolve internal borders of polygons using st_union and group_by
In-Reply-To: <CAKSASLD7B-bcMXWyzdEZECrHr_6G+q+Bo1T-K-8VHzfZp0kxPQ@mail.gmail.com>
References: <CAKSASLD7B-bcMXWyzdEZECrHr_6G+q+Bo1T-K-8VHzfZp0kxPQ@mail.gmail.com>
Message-ID: <alpine.LFD.2.21.1910171257480.4851@reclus.nhh.no>

On Thu, 17 Oct 2019, Marta Rufino wrote:

> Hi,
>
> I am trying to dissolve the internal borders of larger polygons (sf object)
> by a grouping variable or by proximity (adjacent)
> and after looking in the web I found several alternatives, but none is
> doing what I wanted.
>
> ## Reproducible example:
> # World map
> require(rnaturalearth); require(sf)
> world_map <- rnaturalearth::ne_countries(scale = 'small', returnclass =
> c("sf"))
>
> # World countries:
> world_map
> object.size(world_map)
>
> # 1st alternative: in this case we have the groups by continent, but the
> country boundaries are still there, although without label:
> (kk <- world_map %>%
>  dplyr::group_by(continent) %>%
>  summarise())
> object.size(kk)
> kk %>%
>  st_transform(crs = 42310) %>%
>  ggplot()+
>  geom_sf()

Please state all versions:

sessionInfo()
sf_extSoftVersion()

With an updated system, most of your code just does not work for me. You 
are looking for sf::aggregate():

kk <- aggregate(world_map, list(world_map$continent), head, n=1)

plot(st_geometry(kk))

shows that although the country boundaries are largely removed, the 
underlying data are not properly aligned, so slivers remain, some on 
continent boundaries, some as holes in land masses.

Contributions welcome to remove the artefacts.

Using tidyverse really occludes analysis here.

Note that EPSG 42310 simply does not exist in PROJ 6, it is retrievable 
from:

kk1 <- st_transform(kk, crs = paste0("+proj=merc +lat_ts=0 +lon_0=0",
  " +k=1.000000 +x_0=0 +y_0=0 +ellps=GRS80 +datum=WGS84 +units=m"))
plot(st_geometry(kk1))

and should never be used for obvious reasons.

kk2 <- st_transform(kk, crs=3857)
plot(st_geometry(kk2))

is not much better (Web Mercator).

Hope this clarifies,

Roger

>
> # 2nd alternative : apparently different, but very similar...
> (kk1 <- world_map %>%
>  dplyr::group_by(continent) %>%
>  summarise(st_union(.)))
> object.size(kk1)
> kk1 %>%
>  st_transform(crs = 42310) %>%
>  ggplot()+
>  geom_sf()
>
> # 3rd alternative
> (kk2 <- world_map %>%
>  dplyr::group_by(continent) %>%
>  summarise(geom = st_union(geometry)))
> object.size(kk2)
> kk2 %>%
>  st_transform(crs = 42310) %>%
>  ggplot()+
>  geom_sf()
>
> # 4th alternative
> (kk3 <- world_map %>%
>  dplyr::group_by(continent) %>%
>  summarise(geom = st_combine(geometry)))
> object.size(kk3)
> kk3 %>%
>  st_transform(crs = 42310) %>%
>  ggplot()+
>  geom_sf()
>
>
> # In all cases the objects produced are actually very similar at a first
> glance, bur in fact they differ on the properties (as reflected by their
> sizes).
> object.size(world_map)
> object.size(kk1)
> object.size(kk2)
> object.size(kk3)
> object.size(kk4)
>
> # And more importantly, in no case the borders between countries were
> actually dissolved, which was my objective.
>
>
> So, the question is how can I get the continents with the country borders
> dissolved?
> Further, could I dissolve all contiguous borders (instead of having a
> grouping variable)- I saw this in a couple of posts but the answers were
> very complex.
>
> Any help will be greatly appreciated,
> Best wishes,
> M.
>
>
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From Roger@B|v@nd @end|ng |rom nhh@no  Thu Oct 17 13:42:20 2019
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Thu, 17 Oct 2019 13:42:20 +0200
Subject: [R-sig-Geo] 
 dissolve internal borders of polygons using st_union and group_by
In-Reply-To: <alpine.LFD.2.21.1910171257480.4851@reclus.nhh.no>
References: <CAKSASLD7B-bcMXWyzdEZECrHr_6G+q+Bo1T-K-8VHzfZp0kxPQ@mail.gmail.com>
 <alpine.LFD.2.21.1910171257480.4851@reclus.nhh.no>
Message-ID: <alpine.LFD.2.21.1910171331100.4851@reclus.nhh.no>

On Thu, 17 Oct 2019, Roger Bivand wrote:

> On Thu, 17 Oct 2019, Marta Rufino wrote:
>
>>  Hi,
>>
>>  I am trying to dissolve the internal borders of larger polygons (sf
>>  object)
>>  by a grouping variable or by proximity (adjacent)
>>  and after looking in the web I found several alternatives, but none is
>>  doing what I wanted.
>>
>>  ## Reproducible example:
>>  # World map
>>  require(rnaturalearth); require(sf)
>>  world_map <- rnaturalearth::ne_countries(scale = 'small', returnclass =
>>  c("sf"))
>>
>>  # World countries:
>>  world_map
>>  object.size(world_map)
>>
>>  # 1st alternative: in this case we have the groups by continent, but the
>>  country boundaries are still there, although without label:
>>  (kk <- world_map %>%
>>   dplyr::group_by(continent) %>%
>>   summarise())
>>  object.size(kk)
>>  kk %>%
>>   st_transform(crs = 42310) %>%
>>   ggplot()+
>>   geom_sf()
>
> Please state all versions:
>
> sessionInfo()
> sf_extSoftVersion()
>
> With an updated system, most of your code just does not work for me. You are 
> looking for sf::aggregate():
>
> kk <- aggregate(world_map, list(world_map$continent), head, n=1)
>
> plot(st_geometry(kk))
>
> shows that although the country boundaries are largely removed, the 
> underlying data are not properly aligned, so slivers remain, some on 
> continent boundaries, some as holes in land masses.
>
> Contributions welcome to remove the artefacts.

But:

library(rgeos)
wm <- as(world_map, "Spatial")
cs <- gUnaryUnion(wm, id=as.character(wm$continent))
cs_sf <- st_as_sf(cs)
cs_sf$continent <- row.names(cs)
cs_sf
object.size(cs_sf)
plot(cs_sf)

gets much closer.

Maybe try st_precision() for some suitable value? The precision model in 
rgeos multiplies all coordinates by 1e+8 and rounds to integer, reducing 
boundary slivers.

Roger

>
> Using tidyverse really occludes analysis here.
>
> Note that EPSG 42310 simply does not exist in PROJ 6, it is retrievable from:
>
> kk1 <- st_transform(kk, crs = paste0("+proj=merc +lat_ts=0 +lon_0=0",
> " +k=1.000000 +x_0=0 +y_0=0 +ellps=GRS80 +datum=WGS84 +units=m"))
> plot(st_geometry(kk1))
>
> and should never be used for obvious reasons.
>
> kk2 <- st_transform(kk, crs=3857)
> plot(st_geometry(kk2))
>
> is not much better (Web Mercator).
>
> Hope this clarifies,
>
> Roger
>
>>
>>  # 2nd alternative : apparently different, but very similar...
>>  (kk1 <- world_map %>%
>>   dplyr::group_by(continent) %>%
>>   summarise(st_union(.)))
>>  object.size(kk1)
>>  kk1 %>%
>>   st_transform(crs = 42310) %>%
>>   ggplot()+
>>   geom_sf()
>>
>>  # 3rd alternative
>>  (kk2 <- world_map %>%
>>   dplyr::group_by(continent) %>%
>>   summarise(geom = st_union(geometry)))
>>  object.size(kk2)
>>  kk2 %>%
>>   st_transform(crs = 42310) %>%
>>   ggplot()+
>>   geom_sf()
>>
>>  # 4th alternative
>>  (kk3 <- world_map %>%
>>   dplyr::group_by(continent) %>%
>>   summarise(geom = st_combine(geometry)))
>>  object.size(kk3)
>>  kk3 %>%
>>   st_transform(crs = 42310) %>%
>>   ggplot()+
>>   geom_sf()
>> 
>>
>>  # In all cases the objects produced are actually very similar at a first
>>  glance, bur in fact they differ on the properties (as reflected by their
>>  sizes).
>>  object.size(world_map)
>>  object.size(kk1)
>>  object.size(kk2)
>>  object.size(kk3)
>>  object.size(kk4)
>>
>>  # And more importantly, in no case the borders between countries were
>>  actually dissolved, which was my objective.
>> 
>>
>>  So, the question is how can I get the continents with the country borders
>>  dissolved?
>>  Further, could I dissolve all contiguous borders (instead of having a
>>  grouping variable)- I saw this in a couple of posts but the answers were
>>  very complex.
>>
>>  Any help will be greatly appreciated,
>>  Best wishes,
>>  M.
>> 
>> 
>> 
>> 
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From m@rt@@m@ru||no @end|ng |rom gm@||@com  Thu Oct 17 15:13:25 2019
From: m@rt@@m@ru||no @end|ng |rom gm@||@com (Marta Rufino)
Date: Thu, 17 Oct 2019 14:13:25 +0100
Subject: [R-sig-Geo] 
 dissolve internal borders of polygons using st_union and group_by
In-Reply-To: <alpine.LFD.2.21.1910171257480.4851@reclus.nhh.no>
References: <CAKSASLD7B-bcMXWyzdEZECrHr_6G+q+Bo1T-K-8VHzfZp0kxPQ@mail.gmail.com>
 <alpine.LFD.2.21.1910171257480.4851@reclus.nhh.no>
Message-ID: <CAKSASLAad5GY7ZCYRLPzU4jbkQ3zeJRxYGDQn_jcFpEMvTsubQ@mail.gmail.com>

Dear Roger,

Thank you very much for your quick and dedicated response.

Please state all versions:
> sessionInfo()
> sf_extSoftVersion()

 See bellow. I though it was a trivial issue, thus sorry for not reporting
it earlier.


> With an updated system, most of your code just does not work for me.

Just updated everything, r included, and it still runs in my machine -
perhaps because I failed to update to proj6 and I am still using proj4 - I
will have to dedicate more time to overcome it. Is there sites that explain
win-dummies installation?


> You
> are looking for sf::aggregate():
> kk <- aggregate(world_map, list(world_map$continent), head, n=1)
> plot(st_geometry(kk))
>

This will be then a fourth option:
# Answer from ROGER:
kk4 <- aggregate(world_map, list(world_map$continent), head, n=1)

object.size(kk4)
kk4 %>%
  ggplot()+
  geom_sf()

The sp_transform was simply to check if it was workable the produced file
(in other cases, the code functioned, but then I could not work with the
files produced) - so ok to remove it or change it.

You example using rgeos is really nice and I am grateful for it, but I
really wanted to understand how to do it overall so I can apply in other
situations I am working with.
I don't understand the difference between all those options, that
apparently are giving the same result, but not so much in fact.

Any further ideas on the subject?

Thank you once again,
Best wishes,
M.


> sessionInfo()
R version 3.6.1 (2019-07-05)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows >= 8 x64 (build 9200)

Matrix products: default

locale:
[1] LC_COLLATE=English_United Kingdom.1252
[2] LC_CTYPE=English_United Kingdom.1252
[3] LC_MONETARY=English_United Kingdom.1252
[4] LC_NUMERIC=C
[5] LC_TIME=English_United Kingdom.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods
[7] base

other attached packages:
 [1] rgeos_0.5-2         ggthemes_4.2.0      ggrepel_0.8.1
 [4] ggplot2_3.2.1       tidyr_1.0.0         scales_1.0.0
 [7] dplyr_0.8.3         reshape2_1.4.3      viridis_0.5.1
[10] viridisLite_0.3.0   units_0.6-5         rnaturalearth_0.1.0
[13] tmap_2.3-1          mapview_2.7.0       plotKML_0.5-9
[16] lubridate_1.7.4     zoo_1.8-6           rasterVis_0.46
[19] latticeExtra_0.6-28 RColorBrewer_1.1-2  lattice_0.20-38
[22] raster_3.0-7        maptools_0.9-8      sf_0.8-0
[25] gstat_2.0-3         rgdal_1.4-6         sp_1.3-1

loaded via a namespace (and not attached):
 [1] colorspace_1.4-1   class_7.3-15       colorRamps_2.3
 [4] leaflet_2.0.2      htmlTable_1.13.2   satellite_1.0.1
 [7] base64enc_0.1-3    dichromat_2.0-0    rstudioapi_0.10
[10] hexbin_1.27.3      fansi_0.4.0        codetools_0.2-16
[13] splines_3.6.1      knitr_1.25         zeallot_0.1.0
[16] Formula_1.2-3      tmaptools_2.0-2    cluster_2.1.0
[19] png_0.1-7          shiny_1.4.0        compiler_3.6.1
[22] backports_1.1.5    assertthat_0.2.1   Matrix_1.2-17
[25] fastmap_1.0.1      lazyeval_0.2.2     cli_1.1.0
[28] later_1.0.0        acepack_1.4.1      htmltools_0.4.0
[31] tools_3.6.1        gtable_0.3.0       glue_1.3.1
[34] Rcpp_1.0.2         vctrs_0.2.0        leafsync_0.1.0
[37] crosstalk_1.0.0    lwgeom_0.1-7       xfun_0.10
[40] stringr_1.4.0      mime_0.7           lifecycle_0.1.0
[43] XML_3.98-1.20      MASS_7.3-51.4      promises_1.1.0
[46] parallel_3.6.1     yaml_2.2.0         gridExtra_2.3
[49] aqp_1.17           rpart_4.1-15       reshape_0.8.8
[52] stringi_1.4.3      plotrix_3.7-6      e1071_1.7-2
[55] checkmate_1.9.4    intervals_0.15.1   rlang_0.4.0
[58] pkgconfig_2.0.3    pixmap_0.4-11      RSAGA_1.3.0
[61] purrr_0.3.2        htmlwidgets_1.5.1  tidyselect_0.2.5
[64] plyr_1.8.4         magrittr_1.5       R6_2.4.0
[67] Hmisc_4.2-0        DBI_1.0.0          pillar_1.4.2
[70] foreign_0.8-72     withr_2.1.2        shapefiles_0.7
[73] xts_0.11-2         survival_2.44-1.1  nnet_7.3-12
[76] tibble_2.1.3       spacetime_1.2-2    crayon_1.3.4
[79] utf8_1.1.4         KernSmooth_2.23-15 grid_3.6.1
[82] data.table_1.12.4  FNN_1.1.3          dismo_1.1-4
[85] digest_0.6.21      classInt_0.4-1     webshot_0.5.1
[88] xtable_1.8-4       httpuv_1.5.2       stats4_3.6.1
[91] munsell_0.5.0
> sf_extSoftVersion()
          GEOS           GDAL         proj.4 GDAL_with_GEOS
       "3.6.1"        "2.2.3"        "4.9.3"         "true"
    USE_PROJ_H
       "false"
>

>
>

	[[alternative HTML version deleted]]


From Roger@B|v@nd @end|ng |rom nhh@no  Thu Oct 17 15:26:36 2019
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Thu, 17 Oct 2019 15:26:36 +0200
Subject: [R-sig-Geo] 
 dissolve internal borders of polygons using st_union and group_by
In-Reply-To: <CAKSASLAad5GY7ZCYRLPzU4jbkQ3zeJRxYGDQn_jcFpEMvTsubQ@mail.gmail.com>
References: <CAKSASLD7B-bcMXWyzdEZECrHr_6G+q+Bo1T-K-8VHzfZp0kxPQ@mail.gmail.com>
 <alpine.LFD.2.21.1910171257480.4851@reclus.nhh.no>
 <CAKSASLAad5GY7ZCYRLPzU4jbkQ3zeJRxYGDQn_jcFpEMvTsubQ@mail.gmail.com>
Message-ID: <alpine.LFD.2.21.1910171523460.4851@reclus.nhh.no>

On Thu, 17 Oct 2019, Marta Rufino wrote:

> Dear Roger,
>
> Thank you very much for your quick and dedicated response.
>
> Please state all versions:
>> sessionInfo()
>> sf_extSoftVersion()
>
> See bellow. I though it was a trivial issue, thus sorry for not reporting
> it earlier.
>
>
>> With an updated system, most of your code just does not work for me.
>
> Just updated everything, r included, and it still runs in my machine -
> perhaps because I failed to update to proj6 and I am still using proj4 - I
> will have to dedicate more time to overcome it. Is there sites that explain
> win-dummies installation?

You don't need to update yet, but modern PROJ will upset many workflows.

>
>
>> You
>> are looking for sf::aggregate():
>> kk <- aggregate(world_map, list(world_map$continent), head, n=1)
>> plot(st_geometry(kk))
>>
>
> This will be then a fourth option:
> # Answer from ROGER:
> kk4 <- aggregate(world_map, list(world_map$continent), head, n=1)
>
> object.size(kk4)
> kk4 %>%
>  ggplot()+
>  geom_sf()
>
> The sp_transform was simply to check if it was workable the produced file
> (in other cases, the code functioned, but then I could not work with the
> files produced) - so ok to remove it or change it.
>
> You example using rgeos is really nice and I am grateful for it, but I
> really wanted to understand how to do it overall so I can apply in other
> situations I am working with.
> I don't understand the difference between all those options, that
> apparently are giving the same result, but not so much in fact.

My attempts to use st_precision() to try to find a precision level 
that removed the artefacts ended in segmentation faults, so the current 
best workaround is as shown to use rgeos, until the correct sf incantation 
is forthcoming.

Roger

>
> Any further ideas on the subject?
>
> Thank you once again,
> Best wishes,
> M.
>
>
>> sessionInfo()
> R version 3.6.1 (2019-07-05)
> Platform: x86_64-w64-mingw32/x64 (64-bit)
> Running under: Windows >= 8 x64 (build 9200)
>
> Matrix products: default
>
> locale:
> [1] LC_COLLATE=English_United Kingdom.1252
> [2] LC_CTYPE=English_United Kingdom.1252
> [3] LC_MONETARY=English_United Kingdom.1252
> [4] LC_NUMERIC=C
> [5] LC_TIME=English_United Kingdom.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods
> [7] base
>
> other attached packages:
> [1] rgeos_0.5-2         ggthemes_4.2.0      ggrepel_0.8.1
> [4] ggplot2_3.2.1       tidyr_1.0.0         scales_1.0.0
> [7] dplyr_0.8.3         reshape2_1.4.3      viridis_0.5.1
> [10] viridisLite_0.3.0   units_0.6-5         rnaturalearth_0.1.0
> [13] tmap_2.3-1          mapview_2.7.0       plotKML_0.5-9
> [16] lubridate_1.7.4     zoo_1.8-6           rasterVis_0.46
> [19] latticeExtra_0.6-28 RColorBrewer_1.1-2  lattice_0.20-38
> [22] raster_3.0-7        maptools_0.9-8      sf_0.8-0
> [25] gstat_2.0-3         rgdal_1.4-6         sp_1.3-1
>
> loaded via a namespace (and not attached):
> [1] colorspace_1.4-1   class_7.3-15       colorRamps_2.3
> [4] leaflet_2.0.2      htmlTable_1.13.2   satellite_1.0.1
> [7] base64enc_0.1-3    dichromat_2.0-0    rstudioapi_0.10
> [10] hexbin_1.27.3      fansi_0.4.0        codetools_0.2-16
> [13] splines_3.6.1      knitr_1.25         zeallot_0.1.0
> [16] Formula_1.2-3      tmaptools_2.0-2    cluster_2.1.0
> [19] png_0.1-7          shiny_1.4.0        compiler_3.6.1
> [22] backports_1.1.5    assertthat_0.2.1   Matrix_1.2-17
> [25] fastmap_1.0.1      lazyeval_0.2.2     cli_1.1.0
> [28] later_1.0.0        acepack_1.4.1      htmltools_0.4.0
> [31] tools_3.6.1        gtable_0.3.0       glue_1.3.1
> [34] Rcpp_1.0.2         vctrs_0.2.0        leafsync_0.1.0
> [37] crosstalk_1.0.0    lwgeom_0.1-7       xfun_0.10
> [40] stringr_1.4.0      mime_0.7           lifecycle_0.1.0
> [43] XML_3.98-1.20      MASS_7.3-51.4      promises_1.1.0
> [46] parallel_3.6.1     yaml_2.2.0         gridExtra_2.3
> [49] aqp_1.17           rpart_4.1-15       reshape_0.8.8
> [52] stringi_1.4.3      plotrix_3.7-6      e1071_1.7-2
> [55] checkmate_1.9.4    intervals_0.15.1   rlang_0.4.0
> [58] pkgconfig_2.0.3    pixmap_0.4-11      RSAGA_1.3.0
> [61] purrr_0.3.2        htmlwidgets_1.5.1  tidyselect_0.2.5
> [64] plyr_1.8.4         magrittr_1.5       R6_2.4.0
> [67] Hmisc_4.2-0        DBI_1.0.0          pillar_1.4.2
> [70] foreign_0.8-72     withr_2.1.2        shapefiles_0.7
> [73] xts_0.11-2         survival_2.44-1.1  nnet_7.3-12
> [76] tibble_2.1.3       spacetime_1.2-2    crayon_1.3.4
> [79] utf8_1.1.4         KernSmooth_2.23-15 grid_3.6.1
> [82] data.table_1.12.4  FNN_1.1.3          dismo_1.1-4
> [85] digest_0.6.21      classInt_0.4-1     webshot_0.5.1
> [88] xtable_1.8-4       httpuv_1.5.2       stats4_3.6.1
> [91] munsell_0.5.0
>> sf_extSoftVersion()
>          GEOS           GDAL         proj.4 GDAL_with_GEOS
>       "3.6.1"        "2.2.3"        "4.9.3"         "true"
>    USE_PROJ_H
>       "false"
>>
>
>>
>>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From b|@w@@@b|p|@b @end|ng |rom gm@||@com  Thu Oct 17 15:45:54 2019
From: b|@w@@@b|p|@b @end|ng |rom gm@||@com (Biplab Biswas)
Date: Thu, 17 Oct 2019 19:15:54 +0530
Subject: [R-sig-Geo] (no subject)
Message-ID: <CAPk+gCMvaeaJbcBfVYWZAfPZo=iupkdxLsEE5iJ_CNyXd20Nyw@mail.gmail.com>



	[[alternative HTML version deleted]]


From md@umner @end|ng |rom gm@||@com  Thu Oct 17 17:21:46 2019
From: md@umner @end|ng |rom gm@||@com (Michael Sumner)
Date: Fri, 18 Oct 2019 02:21:46 +1100
Subject: [R-sig-Geo] 
 dissolve internal borders of polygons using st_union and group_by
In-Reply-To: <alpine.LFD.2.21.1910171523460.4851@reclus.nhh.no>
References: <CAKSASLD7B-bcMXWyzdEZECrHr_6G+q+Bo1T-K-8VHzfZp0kxPQ@mail.gmail.com>
 <alpine.LFD.2.21.1910171257480.4851@reclus.nhh.no>
 <CAKSASLAad5GY7ZCYRLPzU4jbkQ3zeJRxYGDQn_jcFpEMvTsubQ@mail.gmail.com>
 <alpine.LFD.2.21.1910171523460.4851@reclus.nhh.no>
Message-ID: <CAAcGz9_VtDZqcSRYGkRzP_XDJcu5u5P9hpBupEGBvq98pkVQgA@mail.gmail.com>

rnaturalearth is really dirty data, there's no way forward when things are
so bad, only backing up can help.

Do you need the whole world? Where do you need, and what scale? Your
question suggests that finding the right data is the solution rather than
battling with software.

Cheers, Mike



On Fri., 18 Oct. 2019, 00:27 Roger Bivand, <Roger.Bivand at nhh.no> wrote:

> On Thu, 17 Oct 2019, Marta Rufino wrote:
>
> > Dear Roger,
> >
> > Thank you very much for your quick and dedicated response.
> >
> > Please state all versions:
> >> sessionInfo()
> >> sf_extSoftVersion()
> >
> > See bellow. I though it was a trivial issue, thus sorry for not reporting
> > it earlier.
> >
> >
> >> With an updated system, most of your code just does not work for me.
> >
> > Just updated everything, r included, and it still runs in my machine -
> > perhaps because I failed to update to proj6 and I am still using proj4 -
> I
> > will have to dedicate more time to overcome it. Is there sites that
> explain
> > win-dummies installation?
>
> You don't need to update yet, but modern PROJ will upset many workflows.
>
> >
> >
> >> You
> >> are looking for sf::aggregate():
> >> kk <- aggregate(world_map, list(world_map$continent), head, n=1)
> >> plot(st_geometry(kk))
> >>
> >
> > This will be then a fourth option:
> > # Answer from ROGER:
> > kk4 <- aggregate(world_map, list(world_map$continent), head, n=1)
> >
> > object.size(kk4)
> > kk4 %>%
> >  ggplot()+
> >  geom_sf()
> >
> > The sp_transform was simply to check if it was workable the produced file
> > (in other cases, the code functioned, but then I could not work with the
> > files produced) - so ok to remove it or change it.
> >
> > You example using rgeos is really nice and I am grateful for it, but I
> > really wanted to understand how to do it overall so I can apply in other
> > situations I am working with.
> > I don't understand the difference between all those options, that
> > apparently are giving the same result, but not so much in fact.
>
> My attempts to use st_precision() to try to find a precision level
> that removed the artefacts ended in segmentation faults, so the current
> best workaround is as shown to use rgeos, until the correct sf incantation
> is forthcoming.
>
> Roger
>
> >
> > Any further ideas on the subject?
> >
> > Thank you once again,
> > Best wishes,
> > M.
> >
> >
> >> sessionInfo()
> > R version 3.6.1 (2019-07-05)
> > Platform: x86_64-w64-mingw32/x64 (64-bit)
> > Running under: Windows >= 8 x64 (build 9200)
> >
> > Matrix products: default
> >
> > locale:
> > [1] LC_COLLATE=English_United Kingdom.1252
> > [2] LC_CTYPE=English_United Kingdom.1252
> > [3] LC_MONETARY=English_United Kingdom.1252
> > [4] LC_NUMERIC=C
> > [5] LC_TIME=English_United Kingdom.1252
> >
> > attached base packages:
> > [1] stats     graphics  grDevices utils     datasets  methods
> > [7] base
> >
> > other attached packages:
> > [1] rgeos_0.5-2         ggthemes_4.2.0      ggrepel_0.8.1
> > [4] ggplot2_3.2.1       tidyr_1.0.0         scales_1.0.0
> > [7] dplyr_0.8.3         reshape2_1.4.3      viridis_0.5.1
> > [10] viridisLite_0.3.0   units_0.6-5         rnaturalearth_0.1.0
> > [13] tmap_2.3-1          mapview_2.7.0       plotKML_0.5-9
> > [16] lubridate_1.7.4     zoo_1.8-6           rasterVis_0.46
> > [19] latticeExtra_0.6-28 RColorBrewer_1.1-2  lattice_0.20-38
> > [22] raster_3.0-7        maptools_0.9-8      sf_0.8-0
> > [25] gstat_2.0-3         rgdal_1.4-6         sp_1.3-1
> >
> > loaded via a namespace (and not attached):
> > [1] colorspace_1.4-1   class_7.3-15       colorRamps_2.3
> > [4] leaflet_2.0.2      htmlTable_1.13.2   satellite_1.0.1
> > [7] base64enc_0.1-3    dichromat_2.0-0    rstudioapi_0.10
> > [10] hexbin_1.27.3      fansi_0.4.0        codetools_0.2-16
> > [13] splines_3.6.1      knitr_1.25         zeallot_0.1.0
> > [16] Formula_1.2-3      tmaptools_2.0-2    cluster_2.1.0
> > [19] png_0.1-7          shiny_1.4.0        compiler_3.6.1
> > [22] backports_1.1.5    assertthat_0.2.1   Matrix_1.2-17
> > [25] fastmap_1.0.1      lazyeval_0.2.2     cli_1.1.0
> > [28] later_1.0.0        acepack_1.4.1      htmltools_0.4.0
> > [31] tools_3.6.1        gtable_0.3.0       glue_1.3.1
> > [34] Rcpp_1.0.2         vctrs_0.2.0        leafsync_0.1.0
> > [37] crosstalk_1.0.0    lwgeom_0.1-7       xfun_0.10
> > [40] stringr_1.4.0      mime_0.7           lifecycle_0.1.0
> > [43] XML_3.98-1.20      MASS_7.3-51.4      promises_1.1.0
> > [46] parallel_3.6.1     yaml_2.2.0         gridExtra_2.3
> > [49] aqp_1.17           rpart_4.1-15       reshape_0.8.8
> > [52] stringi_1.4.3      plotrix_3.7-6      e1071_1.7-2
> > [55] checkmate_1.9.4    intervals_0.15.1   rlang_0.4.0
> > [58] pkgconfig_2.0.3    pixmap_0.4-11      RSAGA_1.3.0
> > [61] purrr_0.3.2        htmlwidgets_1.5.1  tidyselect_0.2.5
> > [64] plyr_1.8.4         magrittr_1.5       R6_2.4.0
> > [67] Hmisc_4.2-0        DBI_1.0.0          pillar_1.4.2
> > [70] foreign_0.8-72     withr_2.1.2        shapefiles_0.7
> > [73] xts_0.11-2         survival_2.44-1.1  nnet_7.3-12
> > [76] tibble_2.1.3       spacetime_1.2-2    crayon_1.3.4
> > [79] utf8_1.1.4         KernSmooth_2.23-15 grid_3.6.1
> > [82] data.table_1.12.4  FNN_1.1.3          dismo_1.1-4
> > [85] digest_0.6.21      classInt_0.4-1     webshot_0.5.1
> > [88] xtable_1.8-4       httpuv_1.5.2       stats4_3.6.1
> > [91] munsell_0.5.0
> >> sf_extSoftVersion()
> >          GEOS           GDAL         proj.4 GDAL_with_GEOS
> >       "3.6.1"        "2.2.3"        "4.9.3"         "true"
> >    USE_PROJ_H
> >       "false"
> >>
> >
> >>
> >>
> >
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> https://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From b@row||ng@on @end|ng |rom gm@||@com  Thu Oct 17 17:37:20 2019
From: b@row||ng@on @end|ng |rom gm@||@com (Barry Rowlingson)
Date: Thu, 17 Oct 2019 16:37:20 +0100
Subject: [R-sig-Geo] 
 dissolve internal borders of polygons using st_union and group_by
In-Reply-To: <CAAcGz9_VtDZqcSRYGkRzP_XDJcu5u5P9hpBupEGBvq98pkVQgA@mail.gmail.com>
References: <CAKSASLD7B-bcMXWyzdEZECrHr_6G+q+Bo1T-K-8VHzfZp0kxPQ@mail.gmail.com>
 <alpine.LFD.2.21.1910171257480.4851@reclus.nhh.no>
 <CAKSASLAad5GY7ZCYRLPzU4jbkQ3zeJRxYGDQn_jcFpEMvTsubQ@mail.gmail.com>
 <alpine.LFD.2.21.1910171523460.4851@reclus.nhh.no>
 <CAAcGz9_VtDZqcSRYGkRzP_XDJcu5u5P9hpBupEGBvq98pkVQgA@mail.gmail.com>
Message-ID: <CANVKczP1wWcr+b+HEwaOS+Jj8HdNv9PZvrxB35HBa+VchX4pMg@mail.gmail.com>

Buffering the data by a teeny tiny number of fractional degrees is
sufficient to make the edges overlap enough to dissolve properly. Hacky
solution, and results in a world that is 0.00001 degrees more coastline all
round (a negative buffer can correct for this a bit).

kk <- aggregate(st_buffer(world_map,.00000001), list(world_map$continent),
head, n=1)

Barry



On Thu, Oct 17, 2019 at 4:22 PM Michael Sumner <mdsumner at gmail.com> wrote:

> rnaturalearth is really dirty data, there's no way forward when things are
> so bad, only backing up can help.
>
> Do you need the whole world? Where do you need, and what scale? Your
> question suggests that finding the right data is the solution rather than
> battling with software.
>
> Cheers, Mike
>
>
>
> On Fri., 18 Oct. 2019, 00:27 Roger Bivand, <Roger.Bivand at nhh.no> wrote:
>
> > On Thu, 17 Oct 2019, Marta Rufino wrote:
> >
> > > Dear Roger,
> > >
> > > Thank you very much for your quick and dedicated response.
> > >
> > > Please state all versions:
> > >> sessionInfo()
> > >> sf_extSoftVersion()
> > >
> > > See bellow. I though it was a trivial issue, thus sorry for not
> reporting
> > > it earlier.
> > >
> > >
> > >> With an updated system, most of your code just does not work for me.
> > >
> > > Just updated everything, r included, and it still runs in my machine -
> > > perhaps because I failed to update to proj6 and I am still using proj4
> -
> > I
> > > will have to dedicate more time to overcome it. Is there sites that
> > explain
> > > win-dummies installation?
> >
> > You don't need to update yet, but modern PROJ will upset many workflows.
> >
> > >
> > >
> > >> You
> > >> are looking for sf::aggregate():
> > >> kk <- aggregate(world_map, list(world_map$continent), head, n=1)
> > >> plot(st_geometry(kk))
> > >>
> > >
> > > This will be then a fourth option:
> > > # Answer from ROGER:
> > > kk4 <- aggregate(world_map, list(world_map$continent), head, n=1)
> > >
> > > object.size(kk4)
> > > kk4 %>%
> > >  ggplot()+
> > >  geom_sf()
> > >
> > > The sp_transform was simply to check if it was workable the produced
> file
> > > (in other cases, the code functioned, but then I could not work with
> the
> > > files produced) - so ok to remove it or change it.
> > >
> > > You example using rgeos is really nice and I am grateful for it, but I
> > > really wanted to understand how to do it overall so I can apply in
> other
> > > situations I am working with.
> > > I don't understand the difference between all those options, that
> > > apparently are giving the same result, but not so much in fact.
> >
> > My attempts to use st_precision() to try to find a precision level
> > that removed the artefacts ended in segmentation faults, so the current
> > best workaround is as shown to use rgeos, until the correct sf
> incantation
> > is forthcoming.
> >
> > Roger
> >
> > >
> > > Any further ideas on the subject?
> > >
> > > Thank you once again,
> > > Best wishes,
> > > M.
> > >
> > >
> > >> sessionInfo()
> > > R version 3.6.1 (2019-07-05)
> > > Platform: x86_64-w64-mingw32/x64 (64-bit)
> > > Running under: Windows >= 8 x64 (build 9200)
> > >
> > > Matrix products: default
> > >
> > > locale:
> > > [1] LC_COLLATE=English_United Kingdom.1252
> > > [2] LC_CTYPE=English_United Kingdom.1252
> > > [3] LC_MONETARY=English_United Kingdom.1252
> > > [4] LC_NUMERIC=C
> > > [5] LC_TIME=English_United Kingdom.1252
> > >
> > > attached base packages:
> > > [1] stats     graphics  grDevices utils     datasets  methods
> > > [7] base
> > >
> > > other attached packages:
> > > [1] rgeos_0.5-2         ggthemes_4.2.0      ggrepel_0.8.1
> > > [4] ggplot2_3.2.1       tidyr_1.0.0         scales_1.0.0
> > > [7] dplyr_0.8.3         reshape2_1.4.3      viridis_0.5.1
> > > [10] viridisLite_0.3.0   units_0.6-5         rnaturalearth_0.1.0
> > > [13] tmap_2.3-1          mapview_2.7.0       plotKML_0.5-9
> > > [16] lubridate_1.7.4     zoo_1.8-6           rasterVis_0.46
> > > [19] latticeExtra_0.6-28 RColorBrewer_1.1-2  lattice_0.20-38
> > > [22] raster_3.0-7        maptools_0.9-8      sf_0.8-0
> > > [25] gstat_2.0-3         rgdal_1.4-6         sp_1.3-1
> > >
> > > loaded via a namespace (and not attached):
> > > [1] colorspace_1.4-1   class_7.3-15       colorRamps_2.3
> > > [4] leaflet_2.0.2      htmlTable_1.13.2   satellite_1.0.1
> > > [7] base64enc_0.1-3    dichromat_2.0-0    rstudioapi_0.10
> > > [10] hexbin_1.27.3      fansi_0.4.0        codetools_0.2-16
> > > [13] splines_3.6.1      knitr_1.25         zeallot_0.1.0
> > > [16] Formula_1.2-3      tmaptools_2.0-2    cluster_2.1.0
> > > [19] png_0.1-7          shiny_1.4.0        compiler_3.6.1
> > > [22] backports_1.1.5    assertthat_0.2.1   Matrix_1.2-17
> > > [25] fastmap_1.0.1      lazyeval_0.2.2     cli_1.1.0
> > > [28] later_1.0.0        acepack_1.4.1      htmltools_0.4.0
> > > [31] tools_3.6.1        gtable_0.3.0       glue_1.3.1
> > > [34] Rcpp_1.0.2         vctrs_0.2.0        leafsync_0.1.0
> > > [37] crosstalk_1.0.0    lwgeom_0.1-7       xfun_0.10
> > > [40] stringr_1.4.0      mime_0.7           lifecycle_0.1.0
> > > [43] XML_3.98-1.20      MASS_7.3-51.4      promises_1.1.0
> > > [46] parallel_3.6.1     yaml_2.2.0         gridExtra_2.3
> > > [49] aqp_1.17           rpart_4.1-15       reshape_0.8.8
> > > [52] stringi_1.4.3      plotrix_3.7-6      e1071_1.7-2
> > > [55] checkmate_1.9.4    intervals_0.15.1   rlang_0.4.0
> > > [58] pkgconfig_2.0.3    pixmap_0.4-11      RSAGA_1.3.0
> > > [61] purrr_0.3.2        htmlwidgets_1.5.1  tidyselect_0.2.5
> > > [64] plyr_1.8.4         magrittr_1.5       R6_2.4.0
> > > [67] Hmisc_4.2-0        DBI_1.0.0          pillar_1.4.2
> > > [70] foreign_0.8-72     withr_2.1.2        shapefiles_0.7
> > > [73] xts_0.11-2         survival_2.44-1.1  nnet_7.3-12
> > > [76] tibble_2.1.3       spacetime_1.2-2    crayon_1.3.4
> > > [79] utf8_1.1.4         KernSmooth_2.23-15 grid_3.6.1
> > > [82] data.table_1.12.4  FNN_1.1.3          dismo_1.1-4
> > > [85] digest_0.6.21      classInt_0.4-1     webshot_0.5.1
> > > [88] xtable_1.8-4       httpuv_1.5.2       stats4_3.6.1
> > > [91] munsell_0.5.0
> > >> sf_extSoftVersion()
> > >          GEOS           GDAL         proj.4 GDAL_with_GEOS
> > >       "3.6.1"        "2.2.3"        "4.9.3"         "true"
> > >    USE_PROJ_H
> > >       "false"
> > >>
> > >
> > >>
> > >>
> > >
> >
> > --
> > Roger Bivand
> > Department of Economics, Norwegian School of Economics,
> > Helleveien 30, N-5045 Bergen, Norway.
> > voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> > https://orcid.org/0000-0003-2392-6140
> > https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From m@rt@@m@ru||no @end|ng |rom gm@||@com  Thu Oct 17 17:47:47 2019
From: m@rt@@m@ru||no @end|ng |rom gm@||@com (Marta Rufino)
Date: Thu, 17 Oct 2019 16:47:47 +0100
Subject: [R-sig-Geo] 
 dissolve internal borders of polygons using st_union and group_by
In-Reply-To: <CANVKczP1wWcr+b+HEwaOS+Jj8HdNv9PZvrxB35HBa+VchX4pMg@mail.gmail.com>
References: <CAKSASLD7B-bcMXWyzdEZECrHr_6G+q+Bo1T-K-8VHzfZp0kxPQ@mail.gmail.com>
 <alpine.LFD.2.21.1910171257480.4851@reclus.nhh.no>
 <CAKSASLAad5GY7ZCYRLPzU4jbkQ3zeJRxYGDQn_jcFpEMvTsubQ@mail.gmail.com>
 <alpine.LFD.2.21.1910171523460.4851@reclus.nhh.no>
 <CAAcGz9_VtDZqcSRYGkRzP_XDJcu5u5P9hpBupEGBvq98pkVQgA@mail.gmail.com>
 <CANVKczP1wWcr+b+HEwaOS+Jj8HdNv9PZvrxB35HBa+VchX4pMg@mail.gmail.com>
Message-ID: <CAKSASLDERKnJj6C1CJ_5PQyiytSDUrAkdOF6j0VGgFvyuZqrNw@mail.gmail.com>

Thank you very much to all :)

Barry+Roger contributions sorted the problem for the moment, although in my
mind there are still things to be understood.
Mike, yep, thank you for alerting me of rnaturalearth issues- I was not
aware of it. In this case, I am really interested in the process to
apply in other polygons, not in the data *per se*, but will take this into
account in the future.

Once I have the doc produced (distribution of world
estuaries/bays/transition waters), I will post on the list :)

Best wishes,
M.

	[[alternative HTML version deleted]]


From md@umner @end|ng |rom gm@||@com  Thu Oct 17 18:03:10 2019
From: md@umner @end|ng |rom gm@||@com (Michael Sumner)
Date: Fri, 18 Oct 2019 03:03:10 +1100
Subject: [R-sig-Geo] 
 dissolve internal borders of polygons using st_union and group_by
In-Reply-To: <CAKSASLDERKnJj6C1CJ_5PQyiytSDUrAkdOF6j0VGgFvyuZqrNw@mail.gmail.com>
References: <CAKSASLD7B-bcMXWyzdEZECrHr_6G+q+Bo1T-K-8VHzfZp0kxPQ@mail.gmail.com>
 <alpine.LFD.2.21.1910171257480.4851@reclus.nhh.no>
 <CAKSASLAad5GY7ZCYRLPzU4jbkQ3zeJRxYGDQn_jcFpEMvTsubQ@mail.gmail.com>
 <alpine.LFD.2.21.1910171523460.4851@reclus.nhh.no>
 <CAAcGz9_VtDZqcSRYGkRzP_XDJcu5u5P9hpBupEGBvq98pkVQgA@mail.gmail.com>
 <CANVKczP1wWcr+b+HEwaOS+Jj8HdNv9PZvrxB35HBa+VchX4pMg@mail.gmail.com>
 <CAKSASLDERKnJj6C1CJ_5PQyiytSDUrAkdOF6j0VGgFvyuZqrNw@mail.gmail.com>
Message-ID: <CAAcGz9-cCr8Z6wPpc0ogjHqpibyCxBx4sE=hR1ow0_NRwaV7Nw@mail.gmail.com>

Cool, thanks for clarifying ?



On Fri., 18 Oct. 2019, 02:48 Marta Rufino, <marta.m.rufino at gmail.com> wrote:

> Thank you very much to all :)
>
> Barry+Roger contributions sorted the problem for the moment, although in
> my mind there are still things to be understood.
> Mike, yep, thank you for alerting me of rnaturalearth issues- I was not
> aware of it. In this case, I am really interested in the process to
> apply in other polygons, not in the data *per se*, but will take this
> into account in the future.
>
> Once I have the doc produced (distribution of world
> estuaries/bays/transition waters), I will post on the list :)
>
> Best wishes,
> M.
>
>
>

	[[alternative HTML version deleted]]


From @ndy@teucher @end|ng |rom gm@||@com  Thu Oct 17 21:25:45 2019
From: @ndy@teucher @end|ng |rom gm@||@com (Andy Teucher)
Date: Thu, 17 Oct 2019 12:25:45 -0700
Subject: [R-sig-Geo] 
 dissolve internal borders of polygons using st_union and group_by
In-Reply-To: <CAKSASLDERKnJj6C1CJ_5PQyiytSDUrAkdOF6j0VGgFvyuZqrNw@mail.gmail.com>
References: <CAKSASLD7B-bcMXWyzdEZECrHr_6G+q+Bo1T-K-8VHzfZp0kxPQ@mail.gmail.com>
 <alpine.LFD.2.21.1910171257480.4851@reclus.nhh.no>
 <CAKSASLAad5GY7ZCYRLPzU4jbkQ3zeJRxYGDQn_jcFpEMvTsubQ@mail.gmail.com>
 <alpine.LFD.2.21.1910171523460.4851@reclus.nhh.no>
 <CAAcGz9_VtDZqcSRYGkRzP_XDJcu5u5P9hpBupEGBvq98pkVQgA@mail.gmail.com>
 <CANVKczP1wWcr+b+HEwaOS+Jj8HdNv9PZvrxB35HBa+VchX4pMg@mail.gmail.com>
 <CAKSASLDERKnJj6C1CJ_5PQyiytSDUrAkdOF6j0VGgFvyuZqrNw@mail.gmail.com>
Message-ID: <30407218-096F-4C15-AF6A-7C2DD2D57B22@gmail.com>

Another option you have available is ?ms_dissolve()? in the ?rmapshaper' package (full disclosure - I am the author). The javascript library that powers it (maphsaper[1]) builds topology with a small tolerance to repair slivers and gaps, and thus can often fix issues like this:

require(rnaturalearth)
require(sf)
library(rmapshaper)
world_map <- ne_countries(scale = 'small', returnclass = "sf")

# World countries:
world_map
object.size(world_map)

# Dissolve borders within continents with ms_dissolve()
world_dissolved <- ms_dissolve(world_map, field = "continent?)
plot(world_dissolved)

Cheers,
Andy Teucher

[1] mapshaper: https://github.com/mbloch/mapshaper

> On Oct 17, 2019, at 8:47 AM, Marta Rufino <marta.m.rufino at gmail.com> wrote:
> 
> Thank you very much to all :)
> 
> Barry+Roger contributions sorted the problem for the moment, although in my
> mind there are still things to be understood.
> Mike, yep, thank you for alerting me of rnaturalearth issues- I was not
> aware of it. In this case, I am really interested in the process to
> apply in other polygons, not in the data *per se*, but will take this into
> account in the future.
> 
> Once I have the doc produced (distribution of world
> estuaries/bays/transition waters), I will post on the list :)
> 
> Best wishes,
> M.
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From m@rt@@m@ru||no @end|ng |rom gm@||@com  Tue Oct 22 15:07:27 2019
From: m@rt@@m@ru||no @end|ng |rom gm@||@com (Marta Rufino)
Date: Tue, 22 Oct 2019 14:07:27 +0100
Subject: [R-sig-Geo] 
 dissolve internal borders of polygons using st_union and group_by
In-Reply-To: <30407218-096F-4C15-AF6A-7C2DD2D57B22@gmail.com>
References: <CAKSASLD7B-bcMXWyzdEZECrHr_6G+q+Bo1T-K-8VHzfZp0kxPQ@mail.gmail.com>
 <alpine.LFD.2.21.1910171257480.4851@reclus.nhh.no>
 <CAKSASLAad5GY7ZCYRLPzU4jbkQ3zeJRxYGDQn_jcFpEMvTsubQ@mail.gmail.com>
 <alpine.LFD.2.21.1910171523460.4851@reclus.nhh.no>
 <CAAcGz9_VtDZqcSRYGkRzP_XDJcu5u5P9hpBupEGBvq98pkVQgA@mail.gmail.com>
 <CANVKczP1wWcr+b+HEwaOS+Jj8HdNv9PZvrxB35HBa+VchX4pMg@mail.gmail.com>
 <CAKSASLDERKnJj6C1CJ_5PQyiytSDUrAkdOF6j0VGgFvyuZqrNw@mail.gmail.com>
 <30407218-096F-4C15-AF6A-7C2DD2D57B22@gmail.com>
Message-ID: <CAKSASLBjdriLLpESJzZomkteKPBw2yze-QRAQs1TQ-_t+-L6wg@mail.gmail.com>

Hi,

Thank you very much to everybody.
Here it is a summary of all answers obtained (I hope), with the example
objects (one map and one squared set of polygons).

Cheers,
M.

PS: it was done to produce the world distribution of estuaries (
http://rpubs.com/MRufino/541732)

# If using a simple polygon example (
https://cran.r-project.org/web/packages/sf/vignettes/sf3.html):
b0 = st_polygon(list(rbind(c(-1,-1), c(1,-1), c(1,1), c(-1,1), c(-1,-1))))
b1 = b0 + 2
b2 = b0 + c(-0.2, 2)
x = st_sfc(b0, b1, b2)
a0 = b0 * 0.8
a1 = a0 * 0.5 + c(2, 0.7)
a2 = a0 + 1
a3 = b0 * 0.5 + c(2, -0.5)
y = st_sfc(a0,a1,a2,a3)
plot(x, border = 'red')
plot(y, border = 'green', add = TRUE)

world_map <- rbind(st_as_sf(x),st_as_sf(y)) %>% st_set_crs(4326)
world_map$continent <- c(rep("a",4), rep("b",3))
world_map
plot(world_map)

# World map (if using real data):
# world_map <- rnaturalearth::ne_countries(scale = 'small', returnclass =
c("sf"))

# World countries:
world_map
object.size(world_map)

# 1st case: in this case we have the groups by continent, but the country
boundaries are still there, although without label:
(kk <- world_map %>%
  dplyr::group_by(continent) %>%
  summarise())
object.size(kk)
kk %>%
  st_transform(crs = 3857) %>%
  ggplot()+
  geom_sf()

# 2nd case: appeantly different, but very similar...
(kk1 <- world_map %>%
  dplyr::group_by(continent) %>%
  summarise(st_union(.)))
object.size(kk1)
kk1 %>%
  st_transform(crs = 3857) %>%
  ggplot()+
  geom_sf()

# 3rd case (does not work with polygon example)
(kk2 <- world_map %>%
  dplyr::group_by(continent) %>%
  dplyr::summarize(geom = st_union(geometry)))
object.size(kk2)
kk2 %>%
  st_transform(crs = 3857) %>%
  ggplot()+
  geom_sf()

# 4th case  (does not work with polygon example)
(kk3 <- world_map %>%
  dplyr::group_by(continent) %>%
  dplyr::summarize(geom = st_combine(geometry)))
object.size(kk3)
kk3 %>%
  st_transform(crs = 3857) %>%
  ggplot()+
  geom_sf()

# Suggested from Roger Bivand and Barry Rowlingson:
kk4 <- aggregate(st_buffer(world_map, .00000001),
list(world_map$continent), head, n=1)
kk4 %>%
  st_transform(crs = 3857) %>%
  ggplot()+
  geom_sf()


# Suggested by Roger Bivand:
library(rgeos)
wm <- as(world_map, "Spatial")
cs <- gUnaryUnion(wm, id=as.character(wm$continent))
kk5 <- st_as_sf(cs)
kk5$continent <- row.names(cs)
kk5
object.size(kk5)
kk5 %>%
  st_transform(crs = 3857) %>%
  ggplot()+
  geom_sf()

# Suggested by Andy Teucher:
library(rmapshaper)

kk6 <- ms_dissolve(world_map, field = "continent")
kk6 %>%
  st_transform(crs = 3857) %>%
  ggplot()+
  geom_sf()

# In all cases the objects produced are actually very similar at a first
glance, bur in fact they differ on the properties and sizes.
# In no case, the borders between countries were actually dissolved, which
was my objective

object.size(world_map)
object.size(kk)
object.size(kk1)
object.size(kk2)
object.size(kk3)
object.size(kk4)
object.size(kk5)
object.size(kk6)

# Now, the challenge is, what is the difference between all those files
that apperantly are the same?

	[[alternative HTML version deleted]]


From r@i@1290 m@iii@g oii @im@com  Wed Oct 23 17:21:11 2019
From: r@i@1290 m@iii@g oii @im@com (r@i@1290 m@iii@g oii @im@com)
Date: Wed, 23 Oct 2019 15:21:11 +0000 (UTC)
Subject: [R-sig-Geo] Alternate statistical test to linear regression?
References: <611254400.7296170.1571844071098.ref@mail.yahoo.com>
Message-ID: <611254400.7296170.1571844071098@mail.yahoo.com>

Greetings,
I am testing to see if linear relationships exist between my x and y variables. I conducted various diagnoses in R to test for normality of the x variable data by using qqnorm, qqline and histograms that show the distribution of the data. If the data is shown to be normally distributed in either normal quantile plots or in the histograms (i.e. a bell curve-shaped distribution), I would assume normality and apply the linear regression model, using "lm". However, in some cases, my distributions do not satisfy the normality criteria, and so I feel that using the linear regression model, in those cases, would not be appropriate. For that reason, would you be able to suggest an alternate test to the linear regression model in R? Maybe a non-parametric counterpart to it?
Thank you, and any help would be greatly appreciated! ?
	[[alternative HTML version deleted]]


From t@v|b@r @end|ng |rom gm@||@com  Wed Oct 23 17:28:12 2019
From: t@v|b@r @end|ng |rom gm@||@com (Micha Silver)
Date: Wed, 23 Oct 2019 18:28:12 +0300
Subject: [R-sig-Geo] Implementing a rolling window for stars object
Message-ID: <2d1b78aa-534e-c52f-cd28-a2bc0348470c@gmail.com>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20191023/c2e214a6/attachment.html>

-------------- next part --------------
A non-text attachment was scrubbed...
Name: stars_window.R
Type: text/x-r-source
Size: 43719 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20191023/c2e214a6/attachment.bin>

From @ndy@teucher @end|ng |rom gm@||@com  Wed Oct 23 18:30:58 2019
From: @ndy@teucher @end|ng |rom gm@||@com (Andy Teucher)
Date: Wed, 23 Oct 2019 09:30:58 -0700
Subject: [R-sig-Geo] Implementing a rolling window for stars object
In-Reply-To: <2d1b78aa-534e-c52f-cd28-a2bc0348470c@gmail.com>
References: <2d1b78aa-534e-c52f-cd28-a2bc0348470c@gmail.com>
Message-ID: <3BC170D3-2D62-4AB1-BD94-25A71CC76515@gmail.com>

Hi Micha,

I can see two problems immediately with your code:
 1. you are using a double-colon (yr::last_yr) - the double colon is used for looking for an object in a package, so it is looking for object ?yrs? in package ?yr?, which obviously doesn?t make sense. Use a single colon to create a range (like you did with 2:6)
2.  the object ?last_yr? is never defined, so even if you used a single colon to define the range yr:last_yr, it would fail as it would not be able to find object ?last_yr?

Cheers,
Andy Teucher

> On Oct 23, 2019, at 8:28 AM, Micha Silver <tsvibar at gmail.com> wrote:
> 
> I am trying to run a function (mk.test to find MannKendall trends) using st_apply over a "rolling" window for a time series of rasters in a stars object. 
> When I use subscript notation to slice out the window dimension with a looping variable I get an error:
> 
> Error in loadNamespace(name) : there is no package called ?yr?
> Calls: [ ... tryCatch -> tryCatchList -> tryCatchOne -> <Anonymous>
> Execution halted
> 
> However If I replace the subscript with integers it works fine. (see attached)
> What is the correct way to work this out?
> 
> Attached is a reprex with a small subset of my data. (The script starts with a long structure, code is at the end)
> 
> Thanks
>  -- 
> Micha Silver
> Ben Gurion Univ.
> Sde Boker, Remote Sensing Lab
> cell: +972-523-665918
> <stars_window.R>_______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo <https://stat.ethz.ch/mailman/listinfo/r-sig-geo>


	[[alternative HTML version deleted]]


From 538280 @end|ng |rom gm@||@com  Wed Oct 23 18:59:59 2019
From: 538280 @end|ng |rom gm@||@com (Greg Snow)
Date: Wed, 23 Oct 2019 10:59:59 -0600
Subject: [R-sig-Geo] Alternate statistical test to linear regression?
In-Reply-To: <611254400.7296170.1571844071098@mail.yahoo.com>
References: <611254400.7296170.1571844071098.ref@mail.yahoo.com>
 <611254400.7296170.1571844071098@mail.yahoo.com>
Message-ID: <CAFEqCdyU=eTk+T_-4SmH2rNiHMkAaRxFBKX50+noskLZtu=F+Q@mail.gmail.com>

Note that the normality assumptions are about the residuals (or about
y conditional on x), not on the x variable(s) or all of y
(non-conditional).  If x is highly skewed and the residuals are normal
then diagnostics just on y will also show skewness (if there is a
relationship between x and y).

Also, the normality assumptions are about the tests and confidence
intervals, the least squares fit is legitimate (but possibly not the
most interesting fit) whether the residuals are normal or not.  The
Central Limit Theorem also applies in regression, so if the residuals
are non-normal, but you have a large sample size then the tests and
intervals will still be approximately correct (with the quality of the
approximation depending on the degree of non-normality and sample
size).

There are many alternative tools.  There is a task view on CRAN for
Robust Statistical Methods that gives summaries of many packages and
tools for robust regression (and other things as well) which does not
depend on the normality assumptions.


On Wed, Oct 23, 2019 at 9:21 AM rain1290--- via R-sig-Geo
<r-sig-geo at r-project.org> wrote:
>
> Greetings,
> I am testing to see if linear relationships exist between my x and y variables. I conducted various diagnoses in R to test for normality of the x variable data by using qqnorm, qqline and histograms that show the distribution of the data. If the data is shown to be normally distributed in either normal quantile plots or in the histograms (i.e. a bell curve-shaped distribution), I would assume normality and apply the linear regression model, using "lm". However, in some cases, my distributions do not satisfy the normality criteria, and so I feel that using the linear regression model, in those cases, would not be appropriate. For that reason, would you be able to suggest an alternate test to the linear regression model in R? Maybe a non-parametric counterpart to it?
> Thank you, and any help would be greatly appreciated!
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Gregory (Greg) L. Snow Ph.D.
538280 at gmail.com


From t@v|b@r @end|ng |rom gm@||@com  Wed Oct 23 19:20:14 2019
From: t@v|b@r @end|ng |rom gm@||@com (Micha Silver)
Date: Wed, 23 Oct 2019 20:20:14 +0300
Subject: [R-sig-Geo] Implementing a rolling window for stars object
In-Reply-To: <3BC170D3-2D62-4AB1-BD94-25A71CC76515@gmail.com>
References: <2d1b78aa-534e-c52f-cd28-a2bc0348470c@gmail.com>
 <3BC170D3-2D62-4AB1-BD94-25A71CC76515@gmail.com>
Message-ID: <3c55cc5a-4562-b90c-bc4d-9d5093e87761@gmail.com>


On 23/10/2019 19:30, Andy Teucher wrote:
> Hi Micha,
>
> I can see two problems immediately with your code:
> ?1. you are using a double-colon (yr::last_yr) - the double colon is 
> used for looking for an object in a package, so it is looking for 
> object ?yrs? in package ?yr?, which obviously doesn?t make sense. Use 
> a single colon to create a range (like you did with 2:6)
> 2. ?the object ?last_yr? is never defined, so even if you used a 
> single colon to define the range yr:last_yr, it would fail as it would 
> not be able to find object ?last_yr?
>

Thanks,

I fixed those typos (corrected script attached) and I still get this error:


micha at tp480:R$ Rscript stars_window.R
Loading required package: abind
Loading required package: sf
Linking to GEOS 3.7.1, GDAL 2.4.0, PROJ 5.2.0
Error in eval(rlang::expr(x[[i]][!!!args])) : object 'yr' not found
Calls: RunMK -> [ -> [.stars -> structure -> eval -> eval
Execution halted



> Cheers,
> Andy Teucher
>
>> On Oct 23, 2019, at 8:28 AM, Micha Silver <tsvibar at gmail.com 
>> <mailto:tsvibar at gmail.com>> wrote:
>>
>> I am trying to run a function (mk.test to find MannKendall trends) 
>> using st_apply over a "rolling" window for a time series of rasters 
>> in a stars object.
>> When I use subscript notation to slice out the window dimension with 
>> a looping variable I get an error:
>>
>> Error in loadNamespace(name) : there is no package called ?yr?
>> Calls: [ ... tryCatch -> tryCatchList -> tryCatchOne -> <Anonymous>
>> Execution halted
>>
>> However If I replace the subscript with integers it works fine. (see 
>> attached)
>> What is the correct way to work this out?
>>
>> Attached is a reprex with a small subset of my data. (The script 
>> starts with a long structure, code is at the end)
>>
>> Thanks
>>   --
>> Micha Silver
>> Ben Gurion Univ.
>> Sde Boker, Remote Sensing Lab
>> cell: +972-523-665918
>> <stars_window.R>_______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
-- 
Micha Silver
Ben Gurion Univ.
Sde Boker, Remote Sensing Lab
cell: +972-523-665918


-------------- next part --------------
A non-text attachment was scrubbed...
Name: stars_window.R
Type: text/x-r-source
Size: 43807 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20191023/58025c4b/attachment.bin>

From r@i@1290 m@iii@g oii @im@com  Wed Oct 23 19:25:38 2019
From: r@i@1290 m@iii@g oii @im@com (r@i@1290 m@iii@g oii @im@com)
Date: Wed, 23 Oct 2019 17:25:38 +0000 (UTC)
Subject: [R-sig-Geo] Alternate statistical test to linear regression?
In-Reply-To: <CAFEqCdyU=eTk+T_-4SmH2rNiHMkAaRxFBKX50+noskLZtu=F+Q@mail.gmail.com>
References: <611254400.7296170.1571844071098.ref@mail.yahoo.com>
 <611254400.7296170.1571844071098@mail.yahoo.com>
 <CAFEqCdyU=eTk+T_-4SmH2rNiHMkAaRxFBKX50+noskLZtu=F+Q@mail.gmail.com>
Message-ID: <1812647940.7368909.1571851538114@mail.yahoo.com>

Hi Greg and others,
Thank you for your very informative response! I actually made a mistake in my initial message, in that I was actually testing for the y variable, not the x. I will also look into those packages on CRAN, but even if there is some skewness on the y, because my sample size is much larger than 30 (N>30), it might be safe to apply a linear regression analysis, if we can assume linearity??
A useful alternative would be to use correlation coefficients to test the degree of association between the x and y variables; specifically, the Pearson correlation coefficient, since both x and y variables are quantitative. Does that make sense?

Thanks again,

-----Original Message-----
From: Greg Snow <538280 at gmail.com>
To: rain1290 <rain1290 at aim.com>
Cc: r-sig-geo <r-sig-geo at r-project.org>
Sent: Wed, Oct 23, 2019 1:00 pm
Subject: Re: [R-sig-Geo] Alternate statistical test to linear regression?

Note that the normality assumptions are about the residuals (or about
y conditional on x), not on the x variable(s) or all of y
(non-conditional).? If x is highly skewed and the residuals are normal
then diagnostics just on y will also show skewness (if there is a
relationship between x and y).

Also, the normality assumptions are about the tests and confidence
intervals, the least squares fit is legitimate (but possibly not the
most interesting fit) whether the residuals are normal or not.? The
Central Limit Theorem also applies in regression, so if the residuals
are non-normal, but you have a large sample size then the tests and
intervals will still be approximately correct (with the quality of the
approximation depending on the degree of non-normality and sample
size).

There are many alternative tools.? There is a task view on CRAN for
Robust Statistical Methods that gives summaries of many packages and
tools for robust regression (and other things as well) which does not
depend on the normality assumptions.


On Wed, Oct 23, 2019 at 9:21 AM rain1290--- via R-sig-Geo
<r-sig-geo at r-project.org> wrote:
>
> Greetings,
> I am testing to see if linear relationships exist between my x and y variables. I conducted various diagnoses in R to test for normality of the x variable data by using qqnorm, qqline and histograms that show the distribution of the data. If the data is shown to be normally distributed in either normal quantile plots or in the histograms (i.e. a bell curve-shaped distribution), I would assume normality and apply the linear regression model, using "lm". However, in some cases, my distributions do not satisfy the normality criteria, and so I feel that using the linear regression model, in those cases, would not be appropriate. For that reason, would you be able to suggest an alternate test to the linear regression model in R? Maybe a non-parametric counterpart to it?
> Thank you, and any help would be greatly appreciated!
>? ? ? ? [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Gregory (Greg) L. Snow Ph.D.
538280 at gmail.com
	[[alternative HTML version deleted]]


From @ndy@teucher @end|ng |rom gm@||@com  Wed Oct 23 19:42:23 2019
From: @ndy@teucher @end|ng |rom gm@||@com (Andy Teucher)
Date: Wed, 23 Oct 2019 10:42:23 -0700
Subject: [R-sig-Geo] Implementing a rolling window for stars object
In-Reply-To: <3c55cc5a-4562-b90c-bc4d-9d5093e87761@gmail.com>
References: <2d1b78aa-534e-c52f-cd28-a2bc0348470c@gmail.com>
 <3BC170D3-2D62-4AB1-BD94-25A71CC76515@gmail.com>
 <3c55cc5a-4562-b90c-bc4d-9d5093e87761@gmail.com>
Message-ID: <91CE352B-2CD7-47FE-AA96-30A49196823E@gmail.com>

Interesting - there?s some rlang/tidy evaluation trickery going on there that I couldn?t quite figure out (I think it might be searching for yr in the wrong environment), but defining your range as a single variable, and putting that in the square brackets seems to work for me:

rng <- yr:last_yr
stars_window = ci_stars[,,,rng]


> On Oct 23, 2019, at 10:20 AM, Micha Silver <tsvibar at gmail.com> wrote:
> 
> 
> On 23/10/2019 19:30, Andy Teucher wrote:
>> Hi Micha,
>> 
>> I can see two problems immediately with your code:
>>  1. you are using a double-colon (yr::last_yr) - the double colon is used for looking for an object in a package, so it is looking for object ?yrs? in package ?yr?, which obviously doesn?t make sense. Use a single colon to create a range (like you did with 2:6)
>> 2.  the object ?last_yr? is never defined, so even if you used a single colon to define the range yr:last_yr, it would fail as it would not be able to find object ?last_yr?
>> 
> 
> Thanks,
> 
> I fixed those typos (corrected script attached) and I still get this error:
> 
> 
> micha at tp480:R$ Rscript stars_window.R
> Loading required package: abind
> Loading required package: sf
> Linking to GEOS 3.7.1, GDAL 2.4.0, PROJ 5.2.0
> Error in eval(rlang::expr(x[[i]][!!!args])) : object 'yr' not found
> Calls: RunMK -> [ -> [.stars -> structure -> eval -> eval
> Execution halted
> 
> 
> 
>> Cheers,
>> Andy Teucher
>> 
>>> On Oct 23, 2019, at 8:28 AM, Micha Silver <tsvibar at gmail.com <mailto:tsvibar at gmail.com>> wrote:
>>> 
>>> I am trying to run a function (mk.test to find MannKendall trends) using st_apply over a "rolling" window for a time series of rasters in a stars object.
>>> When I use subscript notation to slice out the window dimension with a looping variable I get an error:
>>> 
>>> Error in loadNamespace(name) : there is no package called ?yr?
>>> Calls: [ ... tryCatch -> tryCatchList -> tryCatchOne -> <Anonymous>
>>> Execution halted
>>> 
>>> However If I replace the subscript with integers it works fine. (see attached)
>>> What is the correct way to work this out?
>>> 
>>> Attached is a reprex with a small subset of my data. (The script starts with a long structure, code is at the end)
>>> 
>>> Thanks
>>>  --
>>> Micha Silver
>>> Ben Gurion Univ.
>>> Sde Boker, Remote Sensing Lab
>>> cell: +972-523-665918
>>> <stars_window.R>_______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
> -- 
> Micha Silver
> Ben Gurion Univ.
> Sde Boker, Remote Sensing Lab
> cell: +972-523-665918
> 
> <stars_window.R>


From @ndy@teucher @end|ng |rom gm@||@com  Wed Oct 23 20:22:33 2019
From: @ndy@teucher @end|ng |rom gm@||@com (Andy Teucher)
Date: Wed, 23 Oct 2019 11:22:33 -0700
Subject: [R-sig-Geo] Implementing a rolling window for stars object
In-Reply-To: <91CE352B-2CD7-47FE-AA96-30A49196823E@gmail.com>
References: <2d1b78aa-534e-c52f-cd28-a2bc0348470c@gmail.com>
 <3BC170D3-2D62-4AB1-BD94-25A71CC76515@gmail.com>
 <3c55cc5a-4562-b90c-bc4d-9d5093e87761@gmail.com>
 <91CE352B-2CD7-47FE-AA96-30A49196823E@gmail.com>
Message-ID: <9B30862D-39CD-4A27-84E8-730585B79208@gmail.com>

I?m fairly certain this is a bug in stars; I opened an issue here: https://github.com/r-spatial/stars/issues/223 <https://github.com/r-spatial/stars/issues/223>

Cheers,
Andy Teucher

> On Oct 23, 2019, at 10:42 AM, Andy Teucher <andy.teucher at gmail.com> wrote:
> 
> Interesting - there?s some rlang/tidy evaluation trickery going on there that I couldn?t quite figure out (I think it might be searching for yr in the wrong environment), but defining your range as a single variable, and putting that in the square brackets seems to work for me:
> 
> rng <- yr:last_yr
> stars_window = ci_stars[,,,rng]
> 
> 
>> On Oct 23, 2019, at 10:20 AM, Micha Silver <tsvibar at gmail.com> wrote:
>> 
>> 
>> On 23/10/2019 19:30, Andy Teucher wrote:
>>> Hi Micha,
>>> 
>>> I can see two problems immediately with your code:
>>> 1. you are using a double-colon (yr::last_yr) - the double colon is used for looking for an object in a package, so it is looking for object ?yrs? in package ?yr?, which obviously doesn?t make sense. Use a single colon to create a range (like you did with 2:6)
>>> 2.  the object ?last_yr? is never defined, so even if you used a single colon to define the range yr:last_yr, it would fail as it would not be able to find object ?last_yr?
>>> 
>> 
>> Thanks,
>> 
>> I fixed those typos (corrected script attached) and I still get this error:
>> 
>> 
>> micha at tp480:R$ Rscript stars_window.R
>> Loading required package: abind
>> Loading required package: sf
>> Linking to GEOS 3.7.1, GDAL 2.4.0, PROJ 5.2.0
>> Error in eval(rlang::expr(x[[i]][!!!args])) : object 'yr' not found
>> Calls: RunMK -> [ -> [.stars -> structure -> eval -> eval
>> Execution halted
>> 
>> 
>> 
>>> Cheers,
>>> Andy Teucher
>>> 
>>>> On Oct 23, 2019, at 8:28 AM, Micha Silver <tsvibar at gmail.com <mailto:tsvibar at gmail.com>> wrote:
>>>> 
>>>> I am trying to run a function (mk.test to find MannKendall trends) using st_apply over a "rolling" window for a time series of rasters in a stars object.
>>>> When I use subscript notation to slice out the window dimension with a looping variable I get an error:
>>>> 
>>>> Error in loadNamespace(name) : there is no package called ?yr?
>>>> Calls: [ ... tryCatch -> tryCatchList -> tryCatchOne -> <Anonymous>
>>>> Execution halted
>>>> 
>>>> However If I replace the subscript with integers it works fine. (see attached)
>>>> What is the correct way to work this out?
>>>> 
>>>> Attached is a reprex with a small subset of my data. (The script starts with a long structure, code is at the end)
>>>> 
>>>> Thanks
>>>> --
>>>> Micha Silver
>>>> Ben Gurion Univ.
>>>> Sde Boker, Remote Sensing Lab
>>>> cell: +972-523-665918
>>>> <stars_window.R>_______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> 
>> -- 
>> Micha Silver
>> Ben Gurion Univ.
>> Sde Boker, Remote Sensing Lab
>> cell: +972-523-665918
>> 
>> <stars_window.R>
> 


	[[alternative HTML version deleted]]


From v|j@y|u||@ @end|ng |rom gm@||@com  Wed Oct 23 20:25:51 2019
From: v|j@y|u||@ @end|ng |rom gm@||@com (Vijay Lulla)
Date: Wed, 23 Oct 2019 14:25:51 -0400
Subject: [R-sig-Geo] Implementing a rolling window for stars object
In-Reply-To: <9B30862D-39CD-4A27-84E8-730585B79208@gmail.com>
References: <2d1b78aa-534e-c52f-cd28-a2bc0348470c@gmail.com>
 <3BC170D3-2D62-4AB1-BD94-25A71CC76515@gmail.com>
 <3c55cc5a-4562-b90c-bc4d-9d5093e87761@gmail.com>
 <91CE352B-2CD7-47FE-AA96-30A49196823E@gmail.com>
 <9B30862D-39CD-4A27-84E8-730585B79208@gmail.com>
Message-ID: <CAKkiGbskyU1+qBMf+cWi4n+da+kKMvPwiY7zaYaP88Ee27=G=A@mail.gmail.com>

 Andy, you're spot on!  This is because stars:::`[.stars` is only looking
for variables and not expressions (line 44 in the function!).  Your example
gets around it by creating an object in the environment (parent.frame)
which is then consulted in the `eval`.  Sorry for tmi!
HTH,
Vijay.

On Wed, Oct 23, 2019 at 2:22 PM Andy Teucher <andy.teucher at gmail.com> wrote:

> I?m fairly certain this is a bug in stars; I opened an issue here:
> https://github.com/r-spatial/stars/issues/223 <
> https://github.com/r-spatial/stars/issues/223>
>
> Cheers,
> Andy Teucher
>
> > On Oct 23, 2019, at 10:42 AM, Andy Teucher <andy.teucher at gmail.com>
> wrote:
> >
> > Interesting - there?s some rlang/tidy evaluation trickery going on there
> that I couldn?t quite figure out (I think it might be searching for yr in
> the wrong environment), but defining your range as a single variable, and
> putting that in the square brackets seems to work for me:
> >
> > rng <- yr:last_yr
> > stars_window = ci_stars[,,,rng]
> >
> >
> >> On Oct 23, 2019, at 10:20 AM, Micha Silver <tsvibar at gmail.com> wrote:
> >>
> >>
> >> On 23/10/2019 19:30, Andy Teucher wrote:
> >>> Hi Micha,
> >>>
> >>> I can see two problems immediately with your code:
> >>> 1. you are using a double-colon (yr::last_yr) - the double colon is
> used for looking for an object in a package, so it is looking for object
> ?yrs? in package ?yr?, which obviously doesn?t make sense. Use a single
> colon to create a range (like you did with 2:6)
> >>> 2.  the object ?last_yr? is never defined, so even if you used a
> single colon to define the range yr:last_yr, it would fail as it would not
> be able to find object ?last_yr?
> >>>
> >>
> >> Thanks,
> >>
> >> I fixed those typos (corrected script attached) and I still get this
> error:
> >>
> >>
> >> micha at tp480:R$ Rscript stars_window.R
> >> Loading required package: abind
> >> Loading required package: sf
> >> Linking to GEOS 3.7.1, GDAL 2.4.0, PROJ 5.2.0
> >> Error in eval(rlang::expr(x[[i]][!!!args])) : object 'yr' not found
> >> Calls: RunMK -> [ -> [.stars -> structure -> eval -> eval
> >> Execution halted
> >>
> >>
> >>
> >>> Cheers,
> >>> Andy Teucher
> >>>
> >>>> On Oct 23, 2019, at 8:28 AM, Micha Silver <tsvibar at gmail.com <mailto:
> tsvibar at gmail.com>> wrote:
> >>>>
> >>>> I am trying to run a function (mk.test to find MannKendall trends)
> using st_apply over a "rolling" window for a time series of rasters in a
> stars object.
> >>>> When I use subscript notation to slice out the window dimension with
> a looping variable I get an error:
> >>>>
> >>>> Error in loadNamespace(name) : there is no package called ?yr?
> >>>> Calls: [ ... tryCatch -> tryCatchList -> tryCatchOne -> <Anonymous>
> >>>> Execution halted
> >>>>
> >>>> However If I replace the subscript with integers it works fine. (see
> attached)
> >>>> What is the correct way to work this out?
> >>>>
> >>>> Attached is a reprex with a small subset of my data. (The script
> starts with a long structure, code is at the end)
> >>>>
> >>>> Thanks
> >>>> --
> >>>> Micha Silver
> >>>> Ben Gurion Univ.
> >>>> Sde Boker, Remote Sensing Lab
> >>>> cell: +972-523-665918
> >>>> <stars_window.R>_______________________________________________
> >>>> R-sig-Geo mailing list
> >>>> R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
> >>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>>
> >> --
> >> Micha Silver
> >> Ben Gurion Univ.
> >> Sde Boker, Remote Sensing Lab
> >> cell: +972-523-665918
> >>
> >> <stars_window.R>
> >
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


-- 
Vijay Lulla

Assistant Professor,
Dept. of Geography, IUPUI
425 University Blvd, CA-207C.
Indianapolis, IN-46202
vlulla at iupui.edu
ORCID: https://orcid.org/0000-0002-0823-2522
Webpage: http://vijaylulla.com

	[[alternative HTML version deleted]]


From t@v|b@r @end|ng |rom gm@||@com  Wed Oct 23 21:12:14 2019
From: t@v|b@r @end|ng |rom gm@||@com (Micha Silver)
Date: Wed, 23 Oct 2019 22:12:14 +0300
Subject: [R-sig-Geo] Implementing a rolling window for stars object
In-Reply-To: <CAKkiGbskyU1+qBMf+cWi4n+da+kKMvPwiY7zaYaP88Ee27=G=A@mail.gmail.com>
References: <2d1b78aa-534e-c52f-cd28-a2bc0348470c@gmail.com>
 <3BC170D3-2D62-4AB1-BD94-25A71CC76515@gmail.com>
 <3c55cc5a-4562-b90c-bc4d-9d5093e87761@gmail.com>
 <91CE352B-2CD7-47FE-AA96-30A49196823E@gmail.com>
 <9B30862D-39CD-4A27-84E8-730585B79208@gmail.com>
 <CAKkiGbskyU1+qBMf+cWi4n+da+kKMvPwiY7zaYaP88Ee27=G=A@mail.gmail.com>
Message-ID: <c21da7da-1560-18a3-740b-bf2ccb9a45e6@gmail.com>


Thanks to both of you for identifying the problem so quickly, and 
offering a workaround!


On 23/10/2019 21:25, Vijay Lulla wrote:
> Andy, you're spot on!? This is because stars:::`[.stars` is only 
> looking for variables and not expressions (line 44 in the function!).? 
> Your example gets around it by creating an object in the environment 
> (parent.frame) which is then consulted in the `eval`.? Sorry for tmi!
> HTH,
> Vijay.
>
> On Wed, Oct 23, 2019 at 2:22 PM Andy Teucher <andy.teucher at gmail.com 
> <mailto:andy.teucher at gmail.com>> wrote:
>
>     I?m fairly certain this is a bug in stars; I opened an issue here:
>     https://github.com/r-spatial/stars/issues/223
>     <https://github.com/r-spatial/stars/issues/223>
>
>     Cheers,
>     Andy Teucher
>
>     > On Oct 23, 2019, at 10:42 AM, Andy Teucher
>     <andy.teucher at gmail.com <mailto:andy.teucher at gmail.com>> wrote:
>     >
>     > Interesting - there?s some rlang/tidy evaluation trickery going
>     on there that I couldn?t quite figure out (I think it might be
>     searching for yr in the wrong environment), but defining your
>     range as a single variable, and putting that in the square
>     brackets seems to work for me:
>     >
>     > rng <- yr:last_yr
>     > stars_window = ci_stars[,,,rng]
>     >
>     >
>     >> On Oct 23, 2019, at 10:20 AM, Micha Silver <tsvibar at gmail.com
>     <mailto:tsvibar at gmail.com>> wrote:
>     >>
>     >>
>     >> On 23/10/2019 19:30, Andy Teucher wrote:
>     >>> Hi Micha,
>     >>>
>     >>> I can see two problems immediately with your code:
>     >>> 1. you are using a double-colon (yr::last_yr) - the double
>     colon is used for looking for an object in a package, so it is
>     looking for object ?yrs? in package ?yr?, which obviously doesn?t
>     make sense. Use a single colon to create a range (like you did
>     with 2:6)
>     >>> 2.? the object ?last_yr? is never defined, so even if you used
>     a single colon to define the range yr:last_yr, it would fail as it
>     would not be able to find object ?last_yr?
>     >>>
>     >>
>     >> Thanks,
>     >>
>     >> I fixed those typos (corrected script attached) and I still get
>     this error:
>     >>
>     >>
>     >> micha at tp480:R$ Rscript stars_window.R
>     >> Loading required package: abind
>     >> Loading required package: sf
>     >> Linking to GEOS 3.7.1, GDAL 2.4.0, PROJ 5.2.0
>     >> Error in eval(rlang::expr(x[[i]][!!!args])) : object 'yr' not found
>     >> Calls: RunMK -> [ -> [.stars -> structure -> eval -> eval
>     >> Execution halted
>     >>
>     >>
>     >>
>     >>> Cheers,
>     >>> Andy Teucher
>     >>>
>     >>>> On Oct 23, 2019, at 8:28 AM, Micha Silver <tsvibar at gmail.com
>     <mailto:tsvibar at gmail.com> <mailto:tsvibar at gmail.com
>     <mailto:tsvibar at gmail.com>>> wrote:
>     >>>>
>     >>>> I am trying to run a function (mk.test to find MannKendall
>     trends) using st_apply over a "rolling" window for a time series
>     of rasters in a stars object.
>     >>>> When I use subscript notation to slice out the window
>     dimension with a looping variable I get an error:
>     >>>>
>     >>>> Error in loadNamespace(name) : there is no package called ?yr?
>     >>>> Calls: [ ... tryCatch -> tryCatchList -> tryCatchOne ->
>     <Anonymous>
>     >>>> Execution halted
>     >>>>
>     >>>> However If I replace the subscript with integers it works
>     fine. (see attached)
>     >>>> What is the correct way to work this out?
>     >>>>
>     >>>> Attached is a reprex with a small subset of my data. (The
>     script starts with a long structure, code is at the end)
>     >>>>
>     >>>> Thanks
>     >>>> --
>     >>>> Micha Silver
>     >>>> Ben Gurion Univ.
>     >>>> Sde Boker, Remote Sensing Lab
>     >>>> cell: +972-523-665918
>     >>>> <stars_window.R>_______________________________________________
>     >>>> R-sig-Geo mailing list
>     >>>> R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>     <mailto:R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>>
>     >>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>     >>>
>     >> --
>     >> Micha Silver
>     >> Ben Gurion Univ.
>     >> Sde Boker, Remote Sensing Lab
>     >> cell: +972-523-665918
>     >>
>     >> <stars_window.R>
>     >
>
>
>     ? ? ? ? [[alternative HTML version deleted]]
>
>     _______________________________________________
>     R-sig-Geo mailing list
>     R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>     https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>
> -- 
> Vijay Lulla
>
> Assistant Professor,
> Dept. of Geography, IUPUI
> 425 University Blvd, CA-207C.
> Indianapolis, IN-46202
> vlulla at iupui.edu <mailto:vlulla at iupui.edu>
> ORCID: https://orcid.org/0000-0002-0823-2522
> Webpage: http://vijaylulla.com

-- 
Micha Silver
Ben Gurion Univ.
Sde Boker, Remote Sensing Lab
cell: +972-523-665918


From 538280 @end|ng |rom gm@||@com  Wed Oct 23 21:49:29 2019
From: 538280 @end|ng |rom gm@||@com (Greg Snow)
Date: Wed, 23 Oct 2019 13:49:29 -0600
Subject: [R-sig-Geo] Alternate statistical test to linear regression?
In-Reply-To: <1812647940.7368909.1571851538114@mail.yahoo.com>
References: <611254400.7296170.1571844071098.ref@mail.yahoo.com>
 <611254400.7296170.1571844071098@mail.yahoo.com>
 <CAFEqCdyU=eTk+T_-4SmH2rNiHMkAaRxFBKX50+noskLZtu=F+Q@mail.gmail.com>
 <1812647940.7368909.1571851538114@mail.yahoo.com>
Message-ID: <CAFEqCdwP4JqPpm+-Zzbk-W_CPxJ2Q7Wv8J7h9KaVkWkZHF3tOA@mail.gmail.com>

First, please expunge the "(N>30)" concept from your mind.  This is an
oversimplified rule of thumb used in introductory statistics courses
(I am guilty of doing this in intro stat as well, but I try to
emphasize to my students that it is only a rule of thumb for that
class and the truth is more complex once you are in the real world, so
consult with a statistician).  There is nothing magical about a sample
size of 30, I have seen cases where n=6 is large enough for the CLT
and cases where n=10,000 was not big enough.

If the data is not overly skewed and your sample size is large then
you can just use regression as is and the inference will be
approximately correct (with a really good approximation).  But with
skewness we often prefer the median over the mean and least squares
regression is equivalent to fitting a mean, some of the robust
regression options are equivalent to fitting a median, so they may be
preferable on that count.

Note that Pearson's correlation does not test linearity, it assumes
linearity (and bivariate normality).  Most issues with regression will
be the same for the correlation.

On Wed, Oct 23, 2019 at 11:25 AM <rain1290 at aim.com> wrote:
>
> Hi Greg and others,
>
> Thank you for your very informative response! I actually made a mistake in my initial message, in that I was actually testing for the y variable, not the x. I will also look into those packages on CRAN, but even if there is some skewness on the y, because my sample size is much larger than 30 (N>30), it might be safe to apply a linear regression analysis, if we can assume linearity?
>
> A useful alternative would be to use correlation coefficients to test the degree of association between the x and y variables; specifically, the Pearson correlation coefficient, since both x and y variables are quantitative. Does that make sense?
>
> Thanks again,
>
>
> -----Original Message-----
> From: Greg Snow <538280 at gmail.com>
> To: rain1290 <rain1290 at aim.com>
> Cc: r-sig-geo <r-sig-geo at r-project.org>
> Sent: Wed, Oct 23, 2019 1:00 pm
> Subject: Re: [R-sig-Geo] Alternate statistical test to linear regression?
>
> Note that the normality assumptions are about the residuals (or about
> y conditional on x), not on the x variable(s) or all of y
> (non-conditional).  If x is highly skewed and the residuals are normal
> then diagnostics just on y will also show skewness (if there is a
> relationship between x and y).
>
> Also, the normality assumptions are about the tests and confidence
> intervals, the least squares fit is legitimate (but possibly not the
> most interesting fit) whether the residuals are normal or not.  The
> Central Limit Theorem also applies in regression, so if the residuals
> are non-normal, but you have a large sample size then the tests and
> intervals will still be approximately correct (with the quality of the
> approximation depending on the degree of non-normality and sample
> size).
>
> There are many alternative tools.  There is a task view on CRAN for
> Robust Statistical Methods that gives summaries of many packages and
> tools for robust regression (and other things as well) which does not
> depend on the normality assumptions.
>
>
> On Wed, Oct 23, 2019 at 9:21 AM rain1290--- via R-sig-Geo
> <r-sig-geo at r-project.org> wrote:
> >
> > Greetings,
> > I am testing to see if linear relationships exist between my x and y variables. I conducted various diagnoses in R to test for normality of the x variable data by using qqnorm, qqline and histograms that show the distribution of the data. If the data is shown to be normally distributed in either normal quantile plots or in the histograms (i.e. a bell curve-shaped distribution), I would assume normality and apply the linear regression model, using "lm". However, in some cases, my distributions do not satisfy the normality criteria, and so I feel that using the linear regression model, in those cases, would not be appropriate. For that reason, would you be able to suggest an alternate test to the linear regression model in R? Maybe a non-parametric counterpart to it?
> > Thank you, and any help would be greatly appreciated!
> >        [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>
>
> --
> Gregory (Greg) L. Snow Ph.D.
> 538280 at gmail.com



-- 
Gregory (Greg) L. Snow Ph.D.
538280 at gmail.com


From r@i@1290 m@iii@g oii @im@com  Wed Oct 23 22:52:34 2019
From: r@i@1290 m@iii@g oii @im@com (r@i@1290 m@iii@g oii @im@com)
Date: Wed, 23 Oct 2019 20:52:34 +0000 (UTC)
Subject: [R-sig-Geo] Alternate statistical test to linear regression?
In-Reply-To: <CAFEqCdwP4JqPpm+-Zzbk-W_CPxJ2Q7Wv8J7h9KaVkWkZHF3tOA@mail.gmail.com>
References: <611254400.7296170.1571844071098.ref@mail.yahoo.com>
 <611254400.7296170.1571844071098@mail.yahoo.com>
 <CAFEqCdyU=eTk+T_-4SmH2rNiHMkAaRxFBKX50+noskLZtu=F+Q@mail.gmail.com>
 <1812647940.7368909.1571851538114@mail.yahoo.com>
 <CAFEqCdwP4JqPpm+-Zzbk-W_CPxJ2Q7Wv8J7h9KaVkWkZHF3tOA@mail.gmail.com>
Message-ID: <1946356698.7543642.1571863954312@mail.yahoo.com>

Hi Greg and others,

Thank you for these explanations and clarifications, as they are much appreciated!?
Indeed, I do have some datasets that exhibit some distinct skewness. Simple scatter plots do show at least some linearity between my x and y variables (albeit weak, given the scattered nature of data points), but could this be sufficient to try simple linear regression? Also, if the data is overly skewed, could transforming it (such as logarithmically) justify the use of simple linear regression and/or correlation, if it causes the data to become mildly skewed in distribution? I have large sample sizes for all of my datasets, and the variables are continuous.?
That would pretty much cover all of my questions concerning this!
Thank you, once again, for your time!
-----Original Message-----
From: Greg Snow <538280 at gmail.com>
To: rain1290 <rain1290 at aim.com>
Cc: r-sig-geo <r-sig-geo at r-project.org>
Sent: Wed, Oct 23, 2019 3:49 pm
Subject: Re: [R-sig-Geo] Alternate statistical test to linear regression?

First, please expunge the "(N>30)" concept from your mind.? This is an
oversimplified rule of thumb used in introductory statistics courses
(I am guilty of doing this in intro stat as well, but I try to
emphasize to my students that it is only a rule of thumb for that
class and the truth is more complex once you are in the real world, so
consult with a statistician).? There is nothing magical about a sample
size of 30, I have seen cases where n=6 is large enough for the CLT
and cases where n=10,000 was not big enough.

If the data is not overly skewed and your sample size is large then
you can just use regression as is and the inference will be
approximately correct (with a really good approximation).? But with
skewness we often prefer the median over the mean and least squares
regression is equivalent to fitting a mean, some of the robust
regression options are equivalent to fitting a median, so they may be
preferable on that count.

Note that Pearson's correlation does not test linearity, it assumes
linearity (and bivariate normality).? Most issues with regression will
be the same for the correlation.

On Wed, Oct 23, 2019 at 11:25 AM <rain1290 at aim.com> wrote:
>
> Hi Greg and others,
>
> Thank you for your very informative response! I actually made a mistake in my initial message, in that I was actually testing for the y variable, not the x. I will also look into those packages on CRAN, but even if there is some skewness on the y, because my sample size is much larger than 30 (N>30), it might be safe to apply a linear regression analysis, if we can assume linearity?
>
> A useful alternative would be to use correlation coefficients to test the degree of association between the x and y variables; specifically, the Pearson correlation coefficient, since both x and y variables are quantitative. Does that make sense?
>
> Thanks again,
>
>
> -----Original Message-----
> From: Greg Snow <538280 at gmail.com>
> To: rain1290 <rain1290 at aim.com>
> Cc: r-sig-geo <r-sig-geo at r-project.org>
> Sent: Wed, Oct 23, 2019 1:00 pm
> Subject: Re: [R-sig-Geo] Alternate statistical test to linear regression?
>
> Note that the normality assumptions are about the residuals (or about
> y conditional on x), not on the x variable(s) or all of y
> (non-conditional).? If x is highly skewed and the residuals are normal
> then diagnostics just on y will also show skewness (if there is a
> relationship between x and y).
>
> Also, the normality assumptions are about the tests and confidence
> intervals, the least squares fit is legitimate (but possibly not the
> most interesting fit) whether the residuals are normal or not.? The
> Central Limit Theorem also applies in regression, so if the residuals
> are non-normal, but you have a large sample size then the tests and
> intervals will still be approximately correct (with the quality of the
> approximation depending on the degree of non-normality and sample
> size).
>
> There are many alternative tools.? There is a task view on CRAN for
> Robust Statistical Methods that gives summaries of many packages and
> tools for robust regression (and other things as well) which does not
> depend on the normality assumptions.
>
>
> On Wed, Oct 23, 2019 at 9:21 AM rain1290--- via R-sig-Geo
> <r-sig-geo at r-project.org> wrote:
> >
> > Greetings,
> > I am testing to see if linear relationships exist between my x and y variables. I conducted various diagnoses in R to test for normality of the x variable data by using qqnorm, qqline and histograms that show the distribution of the data. If the data is shown to be normally distributed in either normal quantile plots or in the histograms (i.e. a bell curve-shaped distribution), I would assume normality and apply the linear regression model, using "lm". However, in some cases, my distributions do not satisfy the normality criteria, and so I feel that using the linear regression model, in those cases, would not be appropriate. For that reason, would you be able to suggest an alternate test to the linear regression model in R? Maybe a non-parametric counterpart to it?
> > Thank you, and any help would be greatly appreciated!
> >? ? ? ? [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>
>
> --
> Gregory (Greg) L. Snow Ph.D.
> 538280 at gmail.com



-- 
Gregory (Greg) L. Snow Ph.D.
538280 at gmail.com
	[[alternative HTML version deleted]]


From 538280 @end|ng |rom gm@||@com  Thu Oct 24 20:13:41 2019
From: 538280 @end|ng |rom gm@||@com (Greg Snow)
Date: Thu, 24 Oct 2019 12:13:41 -0600
Subject: [R-sig-Geo] Alternate statistical test to linear regression?
In-Reply-To: <1946356698.7543642.1571863954312@mail.yahoo.com>
References: <611254400.7296170.1571844071098.ref@mail.yahoo.com>
 <611254400.7296170.1571844071098@mail.yahoo.com>
 <CAFEqCdyU=eTk+T_-4SmH2rNiHMkAaRxFBKX50+noskLZtu=F+Q@mail.gmail.com>
 <1812647940.7368909.1571851538114@mail.yahoo.com>
 <CAFEqCdwP4JqPpm+-Zzbk-W_CPxJ2Q7Wv8J7h9KaVkWkZHF3tOA@mail.gmail.com>
 <1946356698.7543642.1571863954312@mail.yahoo.com>
Message-ID: <CAFEqCdxHkWH1haK5YMcpo3LZvBPJO+YmLQgnWTn=Q63NrTdPYQ@mail.gmail.com>

Yes, linear regression is a good place to start.  But I would consider
the robust regressions as well since they answer a different question
from regular linear regression and that question may be more
appropriate for the skewed data.

On Wed, Oct 23, 2019 at 2:52 PM <rain1290 at aim.com> wrote:
>
> Hi Greg and others,
>
> Thank you for these explanations and clarifications, as they are much appreciated!
>
> Indeed, I do have some datasets that exhibit some distinct skewness. Simple scatter plots do show at least some linearity between my x and y variables (albeit weak, given the scattered nature of data points), but could this be sufficient to try simple linear regression? Also, if the data is overly skewed, could transforming it (such as logarithmically) justify the use of simple linear regression and/or correlation, if it causes the data to become mildly skewed in distribution? I have large sample sizes for all of my datasets, and the variables are continuous.
>
> That would pretty much cover all of my questions concerning this!
>
> Thank you, once again, for your time!
>
> -----Original Message-----
> From: Greg Snow <538280 at gmail.com>
> To: rain1290 <rain1290 at aim.com>
> Cc: r-sig-geo <r-sig-geo at r-project.org>
> Sent: Wed, Oct 23, 2019 3:49 pm
> Subject: Re: [R-sig-Geo] Alternate statistical test to linear regression?
>
> First, please expunge the "(N>30)" concept from your mind.  This is an
> oversimplified rule of thumb used in introductory statistics courses
> (I am guilty of doing this in intro stat as well, but I try to
> emphasize to my students that it is only a rule of thumb for that
> class and the truth is more complex once you are in the real world, so
> consult with a statistician).  There is nothing magical about a sample
> size of 30, I have seen cases where n=6 is large enough for the CLT
> and cases where n=10,000 was not big enough.
>
> If the data is not overly skewed and your sample size is large then
> you can just use regression as is and the inference will be
> approximately correct (with a really good approximation).  But with
> skewness we often prefer the median over the mean and least squares
> regression is equivalent to fitting a mean, some of the robust
> regression options are equivalent to fitting a median, so they may be
> preferable on that count.
>
> Note that Pearson's correlation does not test linearity, it assumes
> linearity (and bivariate normality).  Most issues with regression will
> be the same for the correlation.
>
> On Wed, Oct 23, 2019 at 11:25 AM <rain1290 at aim.com> wrote:
> >
> > Hi Greg and others,
> >
> > Thank you for your very informative response! I actually made a mistake in my initial message, in that I was actually testing for the y variable, not the x. I will also look into those packages on CRAN, but even if there is some skewness on the y, because my sample size is much larger than 30 (N>30), it might be safe to apply a linear regression analysis, if we can assume linearity?
> >
> > A useful alternative would be to use correlation coefficients to test the degree of association between the x and y variables; specifically, the Pearson correlation coefficient, since both x and y variables are quantitative. Does that make sense?
> >
> > Thanks again,
> >
> >
> > -----Original Message-----
> > From: Greg Snow <538280 at gmail.com>
> > To: rain1290 <rain1290 at aim.com>
> > Cc: r-sig-geo <r-sig-geo at r-project.org>
> > Sent: Wed, Oct 23, 2019 1:00 pm
> > Subject: Re: [R-sig-Geo] Alternate statistical test to linear regression?
> >
> > Note that the normality assumptions are about the residuals (or about
> > y conditional on x), not on the x variable(s) or all of y
> > (non-conditional).  If x is highly skewed and the residuals are normal
> > then diagnostics just on y will also show skewness (if there is a
> > relationship between x and y).
> >
> > Also, the normality assumptions are about the tests and confidence
> > intervals, the least squares fit is legitimate (but possibly not the
> > most interesting fit) whether the residuals are normal or not.  The
> > Central Limit Theorem also applies in regression, so if the residuals
> > are non-normal, but you have a large sample size then the tests and
> > intervals will still be approximately correct (with the quality of the
> > approximation depending on the degree of non-normality and sample
> > size).
> >
> > There are many alternative tools.  There is a task view on CRAN for
> > Robust Statistical Methods that gives summaries of many packages and
> > tools for robust regression (and other things as well) which does not
> > depend on the normality assumptions.
> >
> >
> > On Wed, Oct 23, 2019 at 9:21 AM rain1290--- via R-sig-Geo
> > <r-sig-geo at r-project.org> wrote:
> > >
> > > Greetings,
> > > I am testing to see if linear relationships exist between my x and y variables. I conducted various diagnoses in R to test for normality of the x variable data by using qqnorm, qqline and histograms that show the distribution of the data. If the data is shown to be normally distributed in either normal quantile plots or in the histograms (i.e. a bell curve-shaped distribution), I would assume normality and apply the linear regression model, using "lm". However, in some cases, my distributions do not satisfy the normality criteria, and so I feel that using the linear regression model, in those cases, would not be appropriate. For that reason, would you be able to suggest an alternate test to the linear regression model in R? Maybe a non-parametric counterpart to it?
> > > Thank you, and any help would be greatly appreciated!
> > >        [[alternative HTML version deleted]]
> > >
> > > _______________________________________________
> > > R-sig-Geo mailing list
> > > R-sig-Geo at r-project.org
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> >
> >
> >
> > --
> > Gregory (Greg) L. Snow Ph.D.
>
> > 538280 at gmail.com
>
>
>
> --
> Gregory (Greg) L. Snow Ph.D.
> 538280 at gmail.com



-- 
Gregory (Greg) L. Snow Ph.D.
538280 at gmail.com


From edzer@pebe@m@ @end|ng |rom un|-muen@ter@de  Fri Oct 25 14:55:28 2019
From: edzer@pebe@m@ @end|ng |rom un|-muen@ter@de (Edzer Pebesma)
Date: Fri, 25 Oct 2019 14:55:28 +0200
Subject: [R-sig-Geo] Implementing a rolling window for stars object
In-Reply-To: <9B30862D-39CD-4A27-84E8-730585B79208@gmail.com>
References: <2d1b78aa-534e-c52f-cd28-a2bc0348470c@gmail.com>
 <3BC170D3-2D62-4AB1-BD94-25A71CC76515@gmail.com>
 <3c55cc5a-4562-b90c-bc4d-9d5093e87761@gmail.com>
 <91CE352B-2CD7-47FE-AA96-30A49196823E@gmail.com>
 <9B30862D-39CD-4A27-84E8-730585B79208@gmail.com>
Message-ID: <f19a1a66-71ae-915c-29ac-1b6067d79652@uni-muenster.de>

Thanks for reporting Micha, and creating a reprex on github Andy; the
problem seems to be fixed, now.

Best regards,

On 10/23/19 2:22 PM, Andy Teucher wrote:
> I?m fairly certain this is a bug in stars; I opened an issue here: https://github.com/r-spatial/stars/issues/223 <https://github.com/r-spatial/stars/issues/223>
> 
> Cheers,
> Andy Teucher
> 
>> On Oct 23, 2019, at 10:42 AM, Andy Teucher <andy.teucher at gmail.com> wrote:
>>
>> Interesting - there?s some rlang/tidy evaluation trickery going on there that I couldn?t quite figure out (I think it might be searching for yr in the wrong environment), but defining your range as a single variable, and putting that in the square brackets seems to work for me:
>>
>> rng <- yr:last_yr
>> stars_window = ci_stars[,,,rng]
>>
>>
>>> On Oct 23, 2019, at 10:20 AM, Micha Silver <tsvibar at gmail.com> wrote:
>>>
>>>
>>> On 23/10/2019 19:30, Andy Teucher wrote:
>>>> Hi Micha,
>>>>
>>>> I can see two problems immediately with your code:
>>>> 1. you are using a double-colon (yr::last_yr) - the double colon is used for looking for an object in a package, so it is looking for object ?yrs? in package ?yr?, which obviously doesn?t make sense. Use a single colon to create a range (like you did with 2:6)
>>>> 2.  the object ?last_yr? is never defined, so even if you used a single colon to define the range yr:last_yr, it would fail as it would not be able to find object ?last_yr?
>>>>
>>>
>>> Thanks,
>>>
>>> I fixed those typos (corrected script attached) and I still get this error:
>>>
>>>
>>> micha at tp480:R$ Rscript stars_window.R
>>> Loading required package: abind
>>> Loading required package: sf
>>> Linking to GEOS 3.7.1, GDAL 2.4.0, PROJ 5.2.0
>>> Error in eval(rlang::expr(x[[i]][!!!args])) : object 'yr' not found
>>> Calls: RunMK -> [ -> [.stars -> structure -> eval -> eval
>>> Execution halted
>>>
>>>
>>>
>>>> Cheers,
>>>> Andy Teucher
>>>>
>>>>> On Oct 23, 2019, at 8:28 AM, Micha Silver <tsvibar at gmail.com <mailto:tsvibar at gmail.com>> wrote:
>>>>>
>>>>> I am trying to run a function (mk.test to find MannKendall trends) using st_apply over a "rolling" window for a time series of rasters in a stars object.
>>>>> When I use subscript notation to slice out the window dimension with a looping variable I get an error:
>>>>>
>>>>> Error in loadNamespace(name) : there is no package called ?yr?
>>>>> Calls: [ ... tryCatch -> tryCatchList -> tryCatchOne -> <Anonymous>
>>>>> Execution halted
>>>>>
>>>>> However If I replace the subscript with integers it works fine. (see attached)
>>>>> What is the correct way to work this out?
>>>>>
>>>>> Attached is a reprex with a small subset of my data. (The script starts with a long structure, code is at the end)
>>>>>
>>>>> Thanks
>>>>> --
>>>>> Micha Silver
>>>>> Ben Gurion Univ.
>>>>> Sde Boker, Remote Sensing Lab
>>>>> cell: +972-523-665918
>>>>> <stars_window.R>_______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>> -- 
>>> Micha Silver
>>> Ben Gurion Univ.
>>> Sde Boker, Remote Sensing Lab
>>> cell: +972-523-665918
>>>
>>> <stars_window.R>
>>
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48151 Muenster, Germany
Phone: +49 251 8333081

-------------- next part --------------
A non-text attachment was scrubbed...
Name: pEpkey.asc
Type: application/pgp-keys
Size: 3110 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20191025/7f933953/attachment.bin>

From hugo@gco@t@ @end|ng |rom gm@||@com  Fri Oct 25 16:06:35 2019
From: hugo@gco@t@ @end|ng |rom gm@||@com (Hugo Costa)
Date: Fri, 25 Oct 2019 15:06:35 +0100
Subject: [R-sig-Geo] WMS map in a multiple map outlook
Message-ID: <CADvFi5qUcuihrqjKhfSfP_kRp7yNQcbewB0i=1nDLYEsrESuDA@mail.gmail.com>

Dear list

I'm interested in plotting multiple maps, in which one of them is WMS. For
example, how can we plot the WMS in the right-down slot produced from the
code below?
Thanks

library(raster)
library(leaflet)
logo <- system.file("pictures/Rlogo.jpg", package="rgdal")[1]
par(mfrow=c(2,2))
plot(raster::brick(logo)[[1]])
plot(raster::brick(logo)[[2]])
plot(raster::brick(logo)[[3]])
# the next map is plotted alone rather than together with the R logo.
leaflet() %>% addTiles() %>% setView(-93.65, 42.0285, zoom = 17)

	[[alternative HTML version deleted]]


From r|c @end|ng |rom em@||@@r|zon@@edu  Fri Oct 25 17:59:35 2019
From: r|c @end|ng |rom em@||@@r|zon@@edu (Anderson, Richard O - (ric))
Date: Fri, 25 Oct 2019 15:59:35 +0000
Subject: [R-sig-Geo] rgdal install problems in a module environment
Message-ID: <1EF9A9AA-06C3-43BB-B172-A7D546576171@email.arizona.edu>

When various applications are split into modules (RHEL/CentOS environment-modules package), such that
  module load R proj gdal
is needed to make those applications and their pkg-config files available, the R
  install.packages(?rgdal?)
fails because it assumes proj and gdal are in the same place, and omits the -L? link option for proj?s library path.

An easy workaround until this is fixed is
  export proj_lib_path=`pkg-config proj --libs | awk '{print $1}'`
before you start R, then ?install.packages(?rgdal?)? works as expected.

The author of the package is working on a real fix, so this workaround may not be needed for long.

Cheers,
Ric
--
Ric Anderson| Systems Administrator [Description: Description: Description: Description: Description: Description: Description: http://redbar.web.arizona.edu/logos/images/thumb_pawprints.gif]
Research And Discovery Tech | HPC Large Systems Support
XSEDE Campus Champion
ric at email.arizona.edu<mailto:Ric at email.arizona.edu>         (V):  +1-520-626-1642
[cid:image005.png at 01D01593.CF7DFA60]



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20191025/bc5c5193/attachment.html>

-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 823 bytes
Desc: image001.png
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20191025/bc5c5193/attachment.png>

-------------- next part --------------
A non-text attachment was scrubbed...
Name: image002.png
Type: image/png
Size: 3497 bytes
Desc: image002.png
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20191025/bc5c5193/attachment-0001.png>

From Roger@B|v@nd @end|ng |rom nhh@no  Fri Oct 25 20:01:53 2019
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Fri, 25 Oct 2019 20:01:53 +0200
Subject: [R-sig-Geo] rgdal install problems in a module environment
In-Reply-To: <1EF9A9AA-06C3-43BB-B172-A7D546576171@email.arizona.edu>
References: <1EF9A9AA-06C3-43BB-B172-A7D546576171@email.arizona.edu>
Message-ID: <alpine.LFD.2.21.1910251959510.5842@reclus.nhh.no>

On Fri, 25 Oct 2019, Anderson, Richard O - (ric) wrote:

> When various applications are split into modules (RHEL/CentOS environment-modules package), such that
>  module load R proj gdal
> is needed to make those applications and their pkg-config files available, the R
>  install.packages(?rgdal?)
> fails because it assumes proj and gdal are in the same place, and omits the -L? link option for proj?s library path.
>
> An easy workaround until this is fixed is
>  export proj_lib_path=`pkg-config proj --libs | awk '{print $1}'`
> before you start R, then ?install.packages(?rgdal?)? works as expected.
>
> The author of the package is working on a real fix, so this workaround 
> may not be needed for long.

Thanks for the report, the fixed configure file is now on R-Forge and the 
package (version > 1.4-6 on CRAN) should be installable using

install.packages("rgdal", repos="http://R-Forge.R-project.org")

(only affects source installs)

Roger

>
> Cheers,
> Ric
> --
> Ric Anderson| Systems Administrator [Description: Description: Description: Description: Description: Description: Description: http://redbar.web.arizona.edu/logos/images/thumb_pawprints.gif]
> Research And Discovery Tech | HPC Large Systems Support
> XSEDE Campus Champion
> ric at email.arizona.edu<mailto:Ric at email.arizona.edu>         (V):  +1-520-626-1642
> [cid:image005.png at 01D01593.CF7DFA60]
>
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From t@v|b@r @end|ng |rom gm@||@com  Sat Oct 26 10:43:17 2019
From: t@v|b@r @end|ng |rom gm@||@com (Micha Silver)
Date: Sat, 26 Oct 2019 11:43:17 +0300
Subject: [R-sig-Geo] Implementing a rolling window for stars object
In-Reply-To: <f19a1a66-71ae-915c-29ac-1b6067d79652@uni-muenster.de>
References: <2d1b78aa-534e-c52f-cd28-a2bc0348470c@gmail.com>
 <3BC170D3-2D62-4AB1-BD94-25A71CC76515@gmail.com>
 <3c55cc5a-4562-b90c-bc4d-9d5093e87761@gmail.com>
 <91CE352B-2CD7-47FE-AA96-30A49196823E@gmail.com>
 <9B30862D-39CD-4A27-84E8-730585B79208@gmail.com>
 <f19a1a66-71ae-915c-29ac-1b6067d79652@uni-muenster.de>
Message-ID: <2c5171ec-9723-2ba8-d113-31df9ab04924@gmail.com>


On 25/10/2019 15:55, Edzer Pebesma wrote:
> Thanks for reporting Micha, and creating a reprex on github Andy; the
> problem seems to be fixed, now.


Great, thanks for the quick response.

I guess reinstalling stars from CRAN should get the fix?


> Best regards,
>
> On 10/23/19 2:22 PM, Andy Teucher wrote:
>> I?m fairly certain this is a bug in stars; I opened an issue here: https://github.com/r-spatial/stars/issues/223 <https://github.com/r-spatial/stars/issues/223>
>>
>> Cheers,
>> Andy Teucher
>>
>>> On Oct 23, 2019, at 10:42 AM, Andy Teucher <andy.teucher at gmail.com> wrote:
>>>
>>> Interesting - there?s some rlang/tidy evaluation trickery going on there that I couldn?t quite figure out (I think it might be searching for yr in the wrong environment), but defining your range as a single variable, and putting that in the square brackets seems to work for me:
>>>
>>> rng <- yr:last_yr
>>> stars_window = ci_stars[,,,rng]
>>>
>>>
>>>> On Oct 23, 2019, at 10:20 AM, Micha Silver <tsvibar at gmail.com> wrote:
>>>>
>>>>
>>>> On 23/10/2019 19:30, Andy Teucher wrote:
>>>>> Hi Micha,
>>>>>
>>>>> I can see two problems immediately with your code:
>>>>> 1. you are using a double-colon (yr::last_yr) - the double colon is used for looking for an object in a package, so it is looking for object ?yrs? in package ?yr?, which obviously doesn?t make sense. Use a single colon to create a range (like you did with 2:6)
>>>>> 2.  the object ?last_yr? is never defined, so even if you used a single colon to define the range yr:last_yr, it would fail as it would not be able to find object ?last_yr?
>>>>>
>>>> Thanks,
>>>>
>>>> I fixed those typos (corrected script attached) and I still get this error:
>>>>
>>>>
>>>> micha at tp480:R$ Rscript stars_window.R
>>>> Loading required package: abind
>>>> Loading required package: sf
>>>> Linking to GEOS 3.7.1, GDAL 2.4.0, PROJ 5.2.0
>>>> Error in eval(rlang::expr(x[[i]][!!!args])) : object 'yr' not found
>>>> Calls: RunMK -> [ -> [.stars -> structure -> eval -> eval
>>>> Execution halted
>>>>
>>>>
>>>>
>>>>> Cheers,
>>>>> Andy Teucher
>>>>>
>>>>>> On Oct 23, 2019, at 8:28 AM, Micha Silver <tsvibar at gmail.com <mailto:tsvibar at gmail.com>> wrote:
>>>>>>
>>>>>> I am trying to run a function (mk.test to find MannKendall trends) using st_apply over a "rolling" window for a time series of rasters in a stars object.
>>>>>> When I use subscript notation to slice out the window dimension with a looping variable I get an error:
>>>>>>
>>>>>> Error in loadNamespace(name) : there is no package called ?yr?
>>>>>> Calls: [ ... tryCatch -> tryCatchList -> tryCatchOne -> <Anonymous>
>>>>>> Execution halted
>>>>>>
>>>>>> However If I replace the subscript with integers it works fine. (see attached)
>>>>>> What is the correct way to work this out?
>>>>>>
>>>>>> Attached is a reprex with a small subset of my data. (The script starts with a long structure, code is at the end)
>>>>>>
>>>>>> Thanks
>>>>>> --
>>>>>> Micha Silver
>>>>>> Ben Gurion Univ.
>>>>>> Sde Boker, Remote Sensing Lab
>>>>>> cell: +972-523-665918
>>>>>> <stars_window.R>_______________________________________________
>>>>>> R-sig-Geo mailing list
>>>>>> R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>> -- 
>>>> Micha Silver
>>>> Ben Gurion Univ.
>>>> Sde Boker, Remote Sensing Lab
>>>> cell: +972-523-665918
>>>>
>>>> <stars_window.R>
>>
>> 	[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Micha Silver
Ben Gurion Univ.
Sde Boker, Remote Sensing Lab
cell: +972-523-665918


From edzer@pebe@m@ @end|ng |rom un|-muen@ter@de  Sat Oct 26 16:53:47 2019
From: edzer@pebe@m@ @end|ng |rom un|-muen@ter@de (Edzer Pebesma)
Date: Sat, 26 Oct 2019 16:53:47 +0200
Subject: [R-sig-Geo] Implementing a rolling window for stars object
In-Reply-To: <2c5171ec-9723-2ba8-d113-31df9ab04924@gmail.com>
References: <2d1b78aa-534e-c52f-cd28-a2bc0348470c@gmail.com>
 <3BC170D3-2D62-4AB1-BD94-25A71CC76515@gmail.com>
 <3c55cc5a-4562-b90c-bc4d-9d5093e87761@gmail.com>
 <91CE352B-2CD7-47FE-AA96-30A49196823E@gmail.com>
 <9B30862D-39CD-4A27-84E8-730585B79208@gmail.com>
 <f19a1a66-71ae-915c-29ac-1b6067d79652@uni-muenster.de>
 <2c5171ec-9723-2ba8-d113-31df9ab04924@gmail.com>
Message-ID: <e6c9d3e8-9e28-bf08-cfe1-040a5b1ee4a4@uni-muenster.de>



On 10/26/19 4:43 AM, Micha Silver wrote:
> 
> On 25/10/2019 15:55, Edzer Pebesma wrote:
>> Thanks for reporting Micha, and creating a reprex on github Andy; the
>> problem seems to be fixed, now.
> 
> 
> Great, thanks for the quick response.
> 
> I guess reinstalling stars from CRAN should get the fix?

Sorry, I meant no: use

remotes::install_github("r-spatial/stars")

> 
> 
>> Best regards,
>>
>> On 10/23/19 2:22 PM, Andy Teucher wrote:
>>> I?m fairly certain this is a bug in stars; I opened an issue here:
>>> https://github.com/r-spatial/stars/issues/223
>>> <https://github.com/r-spatial/stars/issues/223>
>>>
>>> Cheers,
>>> Andy Teucher
>>>
>>>> On Oct 23, 2019, at 10:42 AM, Andy Teucher <andy.teucher at gmail.com>
>>>> wrote:
>>>>
>>>> Interesting - there?s some rlang/tidy evaluation trickery going on
>>>> there that I couldn?t quite figure out (I think it might be
>>>> searching for yr in the wrong environment), but defining your range
>>>> as a single variable, and putting that in the square brackets seems
>>>> to work for me:
>>>>
>>>> rng <- yr:last_yr
>>>> stars_window = ci_stars[,,,rng]
>>>>
>>>>
>>>>> On Oct 23, 2019, at 10:20 AM, Micha Silver <tsvibar at gmail.com> wrote:
>>>>>
>>>>>
>>>>> On 23/10/2019 19:30, Andy Teucher wrote:
>>>>>> Hi Micha,
>>>>>>
>>>>>> I can see two problems immediately with your code:
>>>>>> 1. you are using a double-colon (yr::last_yr) - the double colon
>>>>>> is used for looking for an object in a package, so it is looking
>>>>>> for object ?yrs? in package ?yr?, which obviously doesn?t make
>>>>>> sense. Use a single colon to create a range (like you did with 2:6)
>>>>>> 2.? the object ?last_yr? is never defined, so even if you used a
>>>>>> single colon to define the range yr:last_yr, it would fail as it
>>>>>> would not be able to find object ?last_yr?
>>>>>>
>>>>> Thanks,
>>>>>
>>>>> I fixed those typos (corrected script attached) and I still get
>>>>> this error:
>>>>>
>>>>>
>>>>> micha at tp480:R$ Rscript stars_window.R
>>>>> Loading required package: abind
>>>>> Loading required package: sf
>>>>> Linking to GEOS 3.7.1, GDAL 2.4.0, PROJ 5.2.0
>>>>> Error in eval(rlang::expr(x[[i]][!!!args])) : object 'yr' not found
>>>>> Calls: RunMK -> [ -> [.stars -> structure -> eval -> eval
>>>>> Execution halted
>>>>>
>>>>>
>>>>>
>>>>>> Cheers,
>>>>>> Andy Teucher
>>>>>>
>>>>>>> On Oct 23, 2019, at 8:28 AM, Micha Silver <tsvibar at gmail.com
>>>>>>> <mailto:tsvibar at gmail.com>> wrote:
>>>>>>>
>>>>>>> I am trying to run a function (mk.test to find MannKendall
>>>>>>> trends) using st_apply over a "rolling" window for a time series
>>>>>>> of rasters in a stars object.
>>>>>>> When I use subscript notation to slice out the window dimension
>>>>>>> with a looping variable I get an error:
>>>>>>>
>>>>>>> Error in loadNamespace(name) : there is no package called ?yr?
>>>>>>> Calls: [ ... tryCatch -> tryCatchList -> tryCatchOne -> <Anonymous>
>>>>>>> Execution halted
>>>>>>>
>>>>>>> However If I replace the subscript with integers it works fine.
>>>>>>> (see attached)
>>>>>>> What is the correct way to work this out?
>>>>>>>
>>>>>>> Attached is a reprex with a small subset of my data. (The script
>>>>>>> starts with a long structure, code is at the end)
>>>>>>>
>>>>>>> Thanks
>>>>>>> -- 
>>>>>>> Micha Silver
>>>>>>> Ben Gurion Univ.
>>>>>>> Sde Boker, Remote Sensing Lab
>>>>>>> cell: +972-523-665918
>>>>>>> <stars_window.R>_______________________________________________
>>>>>>> R-sig-Geo mailing list
>>>>>>> R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>> --?
>>>>> Micha Silver
>>>>> Ben Gurion Univ.
>>>>> Sde Boker, Remote Sensing Lab
>>>>> cell: +972-523-665918
>>>>>
>>>>> <stars_window.R>
>>>
>>> ????[[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48151 Muenster, Germany
Phone: +49 251 8333081

-------------- next part --------------
A non-text attachment was scrubbed...
Name: pEpkey.asc
Type: application/pgp-keys
Size: 3110 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20191026/c91218d0/attachment.bin>

From eg@mp@du @end|ng |rom gm@||@com  Sun Oct 27 10:59:53 2019
From: eg@mp@du @end|ng |rom gm@||@com (Enoch Gyamfi Ampadu)
Date: Sun, 27 Oct 2019 11:59:53 +0200
Subject: [R-sig-Geo] Variable importance bar plot
Message-ID: <CAC4+n+wrH6kinnT+aTRH_+oOFKw6uy7R7Oey=mzESPHZ8e8XJg@mail.gmail.com>

Dear List,

I hope this finds you well. Please I have done a Land cover classification
using randomForest. I used selected satellite image bands as input
variables. I have four thematic classes. I obtained the general variable
importance using *varImpPlot (my model) . *Now I want to have bar chart
plot showing each thematic class and the variable importance for each
class. That is, how each band is ranked in predicting a thematic class. I
tried using this function:

*importance = varImp(my model, scale= TRUE)*

*plot (importance. *

However it did not work. I tried to put in *geom= "bar*". And I had error.

Please I will be glad to get some assistance.

Thank you.

Best regards,

Enoch


Enoch Gyamfi - Ampadu

email: egampadu at gmail.com
skype: enoch.ampadu

The highest sense of nobility is self control.

A simple act of kindness creates endless ripple

	[[alternative HTML version deleted]]


From eg@mp@du @end|ng |rom gm@||@com  Sun Oct 27 13:44:31 2019
From: eg@mp@du @end|ng |rom gm@||@com (Enoch Gyamfi Ampadu)
Date: Sun, 27 Oct 2019 14:44:31 +0200
Subject: [R-sig-Geo] Variable importance plot - bar plot
Message-ID: <CAC4+n+z6YkOdC-nSExoLCeG6wST+XKB9V+KRdZcTe3YWRbL6Vg@mail.gmail.com>

Dear List,

I hope this finds you well. Please I have done a Land cover classification
using randomForest. I used selected satellite image bands as input
variables. I have four thematic classes. I obtained the general variable
importance using: varImpPlot (my model) . Now I want to have bar chart plot
showing each thematic class and the variable importance for each class.
That is, how each band is ranked in predicting a thematic class. I tried
using this function:

importance = varImp(my model, scale= TRUE)

plot (importance.

However it did not work. I tried to put in geom= "bar". And I had error.

Please I will be glad to get some assistance.

Thank you.

Best regards,

Enoch


Enoch Gyamfi - Ampadu

email: egampadu at gmail.com
skype: enoch.ampadu

The highest sense of nobility is self control.

A simple act of kindness creates endless ripple

	[[alternative HTML version deleted]]


From pur@n|k@@m|th@ @end|ng |rom gm@||@com  Mon Oct 28 07:31:48 2019
From: pur@n|k@@m|th@ @end|ng |rom gm@||@com (Amitha Puranik)
Date: Mon, 28 Oct 2019 12:01:48 +0530
Subject: [R-sig-Geo] Imputation of missing spatial areal data
Message-ID: <CANcbSEi7jLULzAjPL6s-3d-S7Fx+sQN3ptK4+OC7gs=UTBQ3bA@mail.gmail.com>

Hello everyone,

I would like to know whether it is possible to use the spatial
autoregressive model to impute missing values in aggregate data? If the OLS
model is replaced with SAR model in regression imputation, would it lead to
better estimates for missing values in a spatial data?
Any opinion/ suggestion is appreciated.

Thanks in advance.

Amitha Puranik.

	[[alternative HTML version deleted]]


From Roger@B|v@nd @end|ng |rom nhh@no  Mon Oct 28 11:09:30 2019
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Mon, 28 Oct 2019 11:09:30 +0100
Subject: [R-sig-Geo] Imputation of missing spatial areal data
In-Reply-To: <CANcbSEi7jLULzAjPL6s-3d-S7Fx+sQN3ptK4+OC7gs=UTBQ3bA@mail.gmail.com>
References: <CANcbSEi7jLULzAjPL6s-3d-S7Fx+sQN3ptK4+OC7gs=UTBQ3bA@mail.gmail.com>
Message-ID: <alpine.LFD.2.21.1910281056010.18953@reclus.nhh.no>

On Mon, 28 Oct 2019, Amitha Puranik wrote:

> Hello everyone,
>
> I would like to know whether it is possible to use the spatial 
> autoregressive model to impute missing values in aggregate data? If the 
> OLS model is replaced with SAR model in regression imputation, would it 
> lead to better estimates for missing values in a spatial data? Any 
> opinion/ suggestion is appreciated.

Please see the article referenced in the help page for 
spatialreg::predict.sarlm():

Michel Goulard, Thibault Laurent & Christine Thomas-Agnan, 2017 About 
predictions in spatial autoregressive models: optimal and almost optimal 
strategies, Spatial Economic Analysis Volume 12, Issue 2-3, 304-325

The differences in the spatial error model would be through any 
differences in covariate coefficient values, but if the differences are 
large, the Hausman test for misspecification would fail. Your post nudged 
me to raise an issue on spatialreg about SLX prediction, which very likely 
also makes sense, and to check predictions where Durbin=TRUE more 
generally.

Roger

>
> Thanks in advance.
>
> Amitha Puranik.
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From pur@n|k@@m|th@ @end|ng |rom gm@||@com  Mon Oct 28 11:46:09 2019
From: pur@n|k@@m|th@ @end|ng |rom gm@||@com (Amitha Puranik)
Date: Mon, 28 Oct 2019 16:16:09 +0530
Subject: [R-sig-Geo] Imputation of missing spatial areal data
In-Reply-To: <alpine.LFD.2.21.1910281056010.18953@reclus.nhh.no>
References: <CANcbSEi7jLULzAjPL6s-3d-S7Fx+sQN3ptK4+OC7gs=UTBQ3bA@mail.gmail.com>
 <alpine.LFD.2.21.1910281056010.18953@reclus.nhh.no>
Message-ID: <CANcbSEgDd6Ub4yGH27A_BJS2CWTGioQZ9baWiysuo-D2jGWBuw@mail.gmail.com>

Dear Roger,

Thank you for the quick response. I shall refer the article that you
recommended.

Kind regards,
Amitha Puranik.


On Mon, Oct 28, 2019 at 3:39 PM Roger Bivand <Roger.Bivand at nhh.no> wrote:

> On Mon, 28 Oct 2019, Amitha Puranik wrote:
>
> > Hello everyone,
> >
> > I would like to know whether it is possible to use the spatial
> > autoregressive model to impute missing values in aggregate data? If the
> > OLS model is replaced with SAR model in regression imputation, would it
> > lead to better estimates for missing values in a spatial data? Any
> > opinion/ suggestion is appreciated.
>
> Please see the article referenced in the help page for
> spatialreg::predict.sarlm():
>
> Michel Goulard, Thibault Laurent & Christine Thomas-Agnan, 2017 About
> predictions in spatial autoregressive models: optimal and almost optimal
> strategies, Spatial Economic Analysis Volume 12, Issue 2-3, 304-325
>
> The differences in the spatial error model would be through any
> differences in covariate coefficient values, but if the differences are
> large, the Hausman test for misspecification would fail. Your post nudged
> me to raise an issue on spatialreg about SLX prediction, which very likely
> also makes sense, and to check predictions where Durbin=TRUE more
> generally.
>
> Roger
>
> >
> > Thanks in advance.
> >
> > Amitha Puranik.
> >
> >       [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> https://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>

	[[alternative HTML version deleted]]


From tom@heng| @end|ng |rom gm@||@com  Mon Oct 28 21:34:35 2019
From: tom@heng| @end|ng |rom gm@||@com (Tomislav Hengl)
Date: Mon, 28 Oct 2019 21:34:35 +0100
Subject: [R-sig-Geo] Installation of proj4 v6 on Ubuntu 18.04 Error:
 proj/epsg not found
Message-ID: <931a8bbc-25ca-7304-2333-633df2e4f952@gmail.com>


Dear R-sig-geo,

I am trying to install proj4 v6 on Ubuntu 18.04 bionic. I though I can 
install it simply by following the ubuntugis steps 
(https://mothergeo-py.readthedocs.io/en/latest/development/how-to/gdal-ubuntu-pkg.html) 
but this does not lead to newest version of proj4 v6.

Then I have tried to follow the proj6 steps 
(https://proj.org/install.html#install) which indicate that I should do 
it via the Anaconda installer. After I installed proj4 v6 from conda I get:

$ which proj
/home/tomislav/anaconda2/bin/proj

$  proj -V
Rel. 6.2.0, September 1st, 2019
<proj>:
projection initialization failure
cause: no arguments in initialization list
program abnormally terminated

After that I've added the 'PROJ_LIB = /home/tomislav/anaconda2/bin/proj
' to my .Renviron file and then I get:

install.packages("rgdal")
Installing package into ?/home/tomislav/R/x86_64-pc-linux-gnu-library/3.5?
(as ?lib? is unspecified)
...
checking PROJ.4: epsg found and readable... no
Error: proj/epsg not found
Either install missing proj support files, for example
the proj-nad and proj-epsg RPMs on systems using RPMs,
or if installed but not autodetected, set PROJ_LIB to the
correct path, and if need be use the --with-proj-share=
configure argument.
ERROR: configuration failed for package ?rgdal?
* removing ?/home/tomislav/R/x86_64-pc-linux-gnu-library/3.5/rgdal?
Warning in install.packages :
   installation of package ?rgdal? had non-zero exit status

$gdalinfo --version
GDAL 2.4.0, released 2018/12/14

What am I doing wrong? Which tutorial / documentation do you advise to 
install proj4 v6 and rgdal package on Ubuntu?

thank you (especially you Roger!),

T. Hengl


From edu@rdod|ez @end|ng |rom gmx@com  Mon Oct 28 22:13:54 2019
From: edu@rdod|ez @end|ng |rom gmx@com (Eduardo Diez)
Date: Mon, 28 Oct 2019 18:13:54 -0300
Subject: [R-sig-Geo] Segmentation fault
Message-ID: <CANK5cGw44peBT+2nj=pGgDHm4p8pUUvD3kHL+GdhvY1xJL+m4w@mail.gmail.com>

Hi everyone.
I'm having problems running spatial processes in a domino machine. I
created a new environment with updated spatial packages but I'm unable to
run simple tasks. Below an example and some information:

> library(sf)Linking to GEOS 3.6.2, GDAL 2.4.2, PROJ 4.9.3> sessionInfo()
R version 3.6.1 (2019-07-05)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 18.04.3 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/atlas/libblas.so.3.10.3
LAPACK: /usr/lib/x86_64-linux-gnu/atlas/liblapack.so.3.10.3

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
 [9] LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] sf_0.8-0

loaded via a namespace (and not attached):
 [1] compiler_3.6.1     magrittr_1.5       class_7.3-15       tools_3.6.1
 [5] DBI_1.0.0          units_0.6-5        Rcpp_1.0.2         KernSmooth_2.23-16
 [9] grid_3.6.1         e1071_1.7-2        classInt_0.4-2
> sf_extSoftVersion()
          GEOS           GDAL         proj.4 GDAL_with_GEOS     USE_PROJ_H
       "3.6.2"        "2.4.2"        "4.9.3"         "true"        "false"
> nc = st_read(system.file("shape/nc.shp", package="sf"))
Reading layer `nc' from data source
`/usr/local/lib/R/site-library/sf/shape/nc.shp' using driver `ESRI
Shapefile'
Simple feature collection with 100 features and 14 fields
geometry type:  MULTIPOLYGON
dimension:      XY
bbox:           xmin: -84.32385 ymin: 33.88199 xmax: -75.45698 ymax: 36.58965
epsg (SRID):    4267
proj4string:    +proj=longlat +datum=NAD27 +no_defs
> asd <- st_area(nc[1,]) # area from long/lat


*** caught segfault ***
address (nil), cause 'unknown'
Traceback:
 1: CPL_crs_parameters(x$proj4string)
 2: structure(CPL_crs_parameters(x$proj4string), names =
c("SemiMajor",     "SemiMinor", "InvFlattening", "units_gdal",
"IsVertical",     "WktPretty", "Wkt"))
 3: crs_parameters(crs) 4: st_crs.sfc(st_geometry(x), parameters = TRUE)
 5: st_crs(st_geometry(x), parameters = TRUE)
 6: lwgeom::st_geod_area(x)
 7: st_area.sfc(st_geometry(x, ...))
 8: st_area(st_geometry(x, ...))
 9: st_area.sf(nc[1, ])
10: st_area(nc[1, ])
An irrecoverable exception occurred. R is aborting now ...Segmentation
fault (core dumped)


Thanks in advance

Best,

Edu

	[[alternative HTML version deleted]]


From edzer@pebe@m@ @end|ng |rom un|-muen@ter@de  Mon Oct 28 22:36:10 2019
From: edzer@pebe@m@ @end|ng |rom un|-muen@ter@de (Edzer Pebesma)
Date: Mon, 28 Oct 2019 22:36:10 +0100
Subject: [R-sig-Geo] Installation of proj4 v6 on Ubuntu 18.04 Error:
 proj/epsg not found
In-Reply-To: <931a8bbc-25ca-7304-2333-633df2e4f952@gmail.com>
References: <931a8bbc-25ca-7304-2333-633df2e4f952@gmail.com>
Message-ID: <c5795af9-5eff-6379-ece6-f2f2f163c08f@uni-muenster.de>

Hi Tom,

formerly PROJ.4 is now called PROJ.

Have you also tried the usual ubuntu install suggestions we give to
R/ubuntu users, e.g. on https://github.com/r-spatial/sf ?

They are:

sudo add-apt-repository ppa:ubuntugis/ubuntugis-unstable
sudo apt-get update
sudo apt-get install libudunits2-dev libgdal-dev libgeos-dev libproj-dev

On 10/28/19 4:34 PM, Tomislav Hengl wrote:
> 
> Dear R-sig-geo,
> 
> I am trying to install proj4 v6 on Ubuntu 18.04 bionic. I though I can
> install it simply by following the ubuntugis steps
> (https://mothergeo-py.readthedocs.io/en/latest/development/how-to/gdal-ubuntu-pkg.html)
> but this does not lead to newest version of proj4 v6.
> 
> Then I have tried to follow the proj6 steps
> (https://proj.org/install.html#install) which indicate that I should do
> it via the Anaconda installer. After I installed proj4 v6 from conda I get:
> 
> $ which proj
> /home/tomislav/anaconda2/bin/proj
> 
> $? proj -V
> Rel. 6.2.0, September 1st, 2019
> <proj>:
> projection initialization failure
> cause: no arguments in initialization list
> program abnormally terminated
> 
> After that I've added the 'PROJ_LIB = /home/tomislav/anaconda2/bin/proj
> ' to my .Renviron file and then I get:
> 
> install.packages("rgdal")
> Installing package into ?/home/tomislav/R/x86_64-pc-linux-gnu-library/3.5?
> (as ?lib? is unspecified)
> ...
> checking PROJ.4: epsg found and readable... no
> Error: proj/epsg not found
> Either install missing proj support files, for example
> the proj-nad and proj-epsg RPMs on systems using RPMs,
> or if installed but not autodetected, set PROJ_LIB to the
> correct path, and if need be use the --with-proj-share=
> configure argument.
> ERROR: configuration failed for package ?rgdal?
> * removing ?/home/tomislav/R/x86_64-pc-linux-gnu-library/3.5/rgdal?
> Warning in install.packages :
> ? installation of package ?rgdal? had non-zero exit status
> 
> $gdalinfo --version
> GDAL 2.4.0, released 2018/12/14
> 
> What am I doing wrong? Which tutorial / documentation do you advise to
> install proj4 v6 and rgdal package on Ubuntu?
> 
> thank you (especially you Roger!),
> 
> T. Hengl
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48151 Muenster, Germany
Phone: +49 251 8333081

-------------- next part --------------
A non-text attachment was scrubbed...
Name: pEpkey.asc
Type: application/pgp-keys
Size: 3110 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20191028/e1e82af6/attachment.bin>

From b|rdopter@ @end|ng |rom gm@||@com  Mon Oct 28 22:55:20 2019
From: b|rdopter@ @end|ng |rom gm@||@com (Gwendolyn Bird)
Date: Mon, 28 Oct 2019 15:55:20 -0600
Subject: [R-sig-Geo] Accounting for spatial autocorrelation in structural
 equation model with variables derived from response data
Message-ID: <CAE188NMqyB0F3MtHEoiNUK_73a7T2=B8130=2rhFcHaNaQbw2g@mail.gmail.com>

Hi;

I'm attempting to use variables I extracted from a raster stack
(insect diversity and environmental variables) to construct a SEM
model, but I have a lot of autocorrelation in my data for most of my
variables, but I'm having trouble accounting for it.

I've attempted to do this in two ways, and tried it with my crs as
both WGS84 and laea:

1.make a covariance matrix and incorporate it into the model

I attempted to use the package sesem to construct a covariance matrix
using lag distance bins which is incorporated into the SEM model from
package lavaan. When I followed the tutorial for sesem and ran
'runModels' I got the error message 'sample covariance
 matrix is not positive definite'. I suspect that the way my data is
spatially distributed is causing problems with this?

I also did a super hacky thing where I created a vcv(I hope this is
the right term) matrix and then turned into a phylogenetic tree in
using ape and then incorporated it into my model with phylopath (which
I've been using for other path models), but this seems highly illicit.

2. incorporate  autocovariate values into the model using spdep

I also tried creating auto-covariate values with spdep. I was able to
account for my auto-correlation when my data was in WGS84 but not laea
(because the numbers are so large?)

My questions are;

Is using autocovariate values a good way to account for
autocorrelation data in path models? I feel more comfortable using the
VCV matrices, but people do do this spdep thing.

If I can use the autocovariate values;
should I create a value for each of my variables which I find
autocorrelation for and include the autocovariates in my model as
exogenous variables with an edge going to each of the variables I
created it with
(i.e. variable1 ~ autocovariate1,
variable2 ~ autocovariate2,
variable3 ~ variable2 + autocovariate3,
variable4 ~ variable1 + variable3 + autocovariate4)
or should I only include the variable for the endogenous variable I am
looking for the causality for?
(i.e. variable3 ~ variable2,
variable4 ~ variable1 + variable3 + autocovariate4)

If the autocovariate values are not appropriate for this model, why
does sesem create a matrix which is not positive definite, and how can
I fix that OR is there another way I can integrate VCV matrices in my
path models?

Thank you for reading this novel, and any solutions you might have for me!
Thank you!
Gwendolyn


From r@i@1290 m@iii@g oii @im@com  Tue Oct 29 05:16:39 2019
From: r@i@1290 m@iii@g oii @im@com (r@i@1290 m@iii@g oii @im@com)
Date: Tue, 29 Oct 2019 04:16:39 +0000 (UTC)
Subject: [R-sig-Geo] Plotting median values globally
References: <449745220.2686965.1572322599506.ref@mail.yahoo.com>
Message-ID: <449745220.2686965.1572322599506@mail.yahoo.com>

Hi there,
I am trying to create a global plot with median precipitation values. What I would like to do is isolate the "median" values and plot those values on a global raster map. I already first created a raster stack, called "RCP1pctCO2median", which contains the median values to be plotted. However, what I would like to do is simply plot only those values at Year 61 for each grid cell. There are 138 layers, with each layer representing one year. The idea would be to plot only those values for Year/layer 61 globally (i,e, for each grid cell), but I am unsure how to isolate that specific year/layer??
"RCP1pctCO2median"? has the following attributes:

class       : RasterStack 
dimensions  : 64, 128, 8192, 138  (nrow, ncol, ncell, nlayers)
resolution  : 2.8125, 2.789327  (x, y)
extent      : -181.4062, 178.5938, -89.25846, 89.25846  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0 
names       :    layer.1,    layer.2,    layer.3,    layer.4,    layer.5,    layer.6,    layer.7,    layer.8,    layer.9,   layer.10,   layer.11,   layer.12,   layer.13,   layer.14,   layer.15, ... 
min values  : 0.42964514, 0.43375653, 0.51749371, 0.50838983, 0.45366730, 0.53099146, 0.49757186, 0.45697752, 0.41382199, 0.46082401, 0.45516687, 0.51857087, 0.41005131, 0.45956529, 0.47497867, ... 
max values  :   96.30350,  104.08584,   88.92751,   97.49373,   89.57201,   90.58570,   86.67651,   88.33519,   96.94720,  101.58247,   96.07792,   93.21948,   99.59785,   94.26218,   90.62138, ... 


And this is how I would like to create my global raster map. However, I am not sure how to plot only one value (i.e. the median value, which occurs at Year 61) for each grid cell. This is what I have so far, but all that this does is plot 138 mini plots, and I just want one plot showing the median values (i.e. Year 61):


mapTheme<-rasterTheme(region=rev(brewer.pal(10,"Spectral")))
cutpoints<-c(200,175,150,125,100,75,50,25,0)
levelplot(RCP1pctCO2median,margin=F,at=cutpoints,cuts=11,pretty=TRUE,par.settings=mapTheme, main="Median values")



Any help would be greatly appreciated!
I look forward to your response!?
	[[alternative HTML version deleted]]


From Roger@B|v@nd @end|ng |rom nhh@no  Tue Oct 29 09:54:36 2019
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Tue, 29 Oct 2019 09:54:36 +0100
Subject: [R-sig-Geo] Segmentation fault
In-Reply-To: <CANK5cGw44peBT+2nj=pGgDHm4p8pUUvD3kHL+GdhvY1xJL+m4w@mail.gmail.com>
References: <CANK5cGw44peBT+2nj=pGgDHm4p8pUUvD3kHL+GdhvY1xJL+m4w@mail.gmail.com>
Message-ID: <alpine.LFD.2.21.1910290951220.15781@reclus.nhh.no>

On Mon, 28 Oct 2019, Eduardo Diez wrote:

> Hi everyone.
> I'm having problems running spatial processes in a domino machine. I

Please raise an issue on https://github.com/r-spatial/sf/issues, giving 
much more detail about your installation (domino is unknown to everybody 
but yourself, duckduckgo says: "Domino Machine manufactures blow out 
preventers, stuffing boxes, and API products"). Likely cause - failed 
installation of lwgeom, or multiple installs of external software. Avoid 
posting HTML.

Roger

> created a new environment with updated spatial packages but I'm unable to
> run simple tasks. Below an example and some information:
>
>> library(sf)Linking to GEOS 3.6.2, GDAL 2.4.2, PROJ 4.9.3> sessionInfo()
> R version 3.6.1 (2019-07-05)
> Platform: x86_64-pc-linux-gnu (64-bit)
> Running under: Ubuntu 18.04.3 LTS
>
> Matrix products: default
> BLAS:   /usr/lib/x86_64-linux-gnu/atlas/libblas.so.3.10.3
> LAPACK: /usr/lib/x86_64-linux-gnu/atlas/liblapack.so.3.10.3
>
> locale:
> [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
> [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
> [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
> [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
> [9] LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] sf_0.8-0
>
> loaded via a namespace (and not attached):
> [1] compiler_3.6.1     magrittr_1.5       class_7.3-15       tools_3.6.1
> [5] DBI_1.0.0          units_0.6-5        Rcpp_1.0.2         KernSmooth_2.23-16
> [9] grid_3.6.1         e1071_1.7-2        classInt_0.4-2
>> sf_extSoftVersion()
>          GEOS           GDAL         proj.4 GDAL_with_GEOS     USE_PROJ_H
>       "3.6.2"        "2.4.2"        "4.9.3"         "true"        "false"
>> nc = st_read(system.file("shape/nc.shp", package="sf"))
> Reading layer `nc' from data source
> `/usr/local/lib/R/site-library/sf/shape/nc.shp' using driver `ESRI
> Shapefile'
> Simple feature collection with 100 features and 14 fields
> geometry type:  MULTIPOLYGON
> dimension:      XY
> bbox:           xmin: -84.32385 ymin: 33.88199 xmax: -75.45698 ymax: 36.58965
> epsg (SRID):    4267
> proj4string:    +proj=longlat +datum=NAD27 +no_defs
>> asd <- st_area(nc[1,]) # area from long/lat
>
>
> *** caught segfault ***
> address (nil), cause 'unknown'
> Traceback:
> 1: CPL_crs_parameters(x$proj4string)
> 2: structure(CPL_crs_parameters(x$proj4string), names =
> c("SemiMajor",     "SemiMinor", "InvFlattening", "units_gdal",
> "IsVertical",     "WktPretty", "Wkt"))
> 3: crs_parameters(crs) 4: st_crs.sfc(st_geometry(x), parameters = TRUE)
> 5: st_crs(st_geometry(x), parameters = TRUE)
> 6: lwgeom::st_geod_area(x)
> 7: st_area.sfc(st_geometry(x, ...))
> 8: st_area(st_geometry(x, ...))
> 9: st_area.sf(nc[1, ])
> 10: st_area(nc[1, ])
> An irrecoverable exception occurred. R is aborting now ...Segmentation
> fault (core dumped)
>
>
> Thanks in advance
>
> Best,
>
> Edu
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From tom@heng| @end|ng |rom gm@||@com  Tue Oct 29 12:11:45 2019
From: tom@heng| @end|ng |rom gm@||@com (Tomislav Hengl)
Date: Tue, 29 Oct 2019 12:11:45 +0100
Subject: [R-sig-Geo] Installation of proj4 v6 on Ubuntu 18.04 Error:
 proj/epsg not found
In-Reply-To: <c5795af9-5eff-6379-ece6-f2f2f163c08f@uni-muenster.de>
References: <931a8bbc-25ca-7304-2333-633df2e4f952@gmail.com>
 <c5795af9-5eff-6379-ece6-f2f2f163c08f@uni-muenster.de>
Message-ID: <7643fb84-0b59-340f-a63a-7edb5b99a2d6@gmail.com>


Thanks Edzer,

I removed my gdal (which removes also all QGIS and everything connect 
unfortunately) then I followed your steps and I get (somehow the proj 
version is still 5 and not 6):

 > install.packages("rgdal")
   % Total    % Received % Xferd  Average Speed   Time    Time     Time 
Current
                                  Dload  Upload   Total   Spent    Left 
Speed
100 1631k  100 1631k    0     0   713k      0  0:00:02  0:00:02 --:--:-- 
  713k
* installing *source* package ?rgdal? ...
** package ?rgdal? successfully unpacked and MD5 sums checked
checking for g++... g++
checking whether the C++ compiler works... yes
checking for C++ compiler default output file name... a.out
checking for suffix of executables...
checking whether we are cross compiling... no
checking for suffix of object files... o
checking whether we are using the GNU C++ compiler... yes
checking whether g++ accepts -g... yes
configure: CC: gcc -std=gnu99
configure: CXX: g++
configure: rgdal: 1.3-3
checking for /usr/bin/svnversion... yes
configure: svn revision: 759
checking whether g++ supports C++11 features by default... yes
configure: C++11 support available
checking for gdal-config... /usr/bin/gdal-config
checking gdal-config usability... yes
configure: GDAL: 2.4.2
checking C++11 support for GDAL >= 2.3.0... yes
checking GDAL version >= 1.11.4... yes
checking gdal: linking with --libs only... yes
checking GDAL: /usr/share/gdal/pcs.csv readable... yes
configure: pkg-config proj exists, will use it
configure: PROJ version: 5.2.0
checking proj_api.h presence and usability... no
configure: error: proj_api.h not found in standard or given locations.
ERROR: configuration failed for package ?rgdal?
* removing ?/opt/microsoft/ropen/3.5.1/lib64/R/library/rgdal?
* restoring previous ?/opt/microsoft/ropen/3.5.1/lib64/R/library/rgdal?

The downloaded source packages are in
	?/data/RTMP/Rtmpl5wj21/downloaded_packages?
Updating HTML index of packages in '.Library'
Making 'packages.html' ... done
Warning message:
In install.packages("rgdal") :
   installation of package ?rgdal? had non-zero exit status

what am I doing wrong?


On 10/28/19 10:36 PM, Edzer Pebesma wrote:
> Hi Tom,
> 
> formerly PROJ.4 is now called PROJ.
> 
> Have you also tried the usual ubuntu install suggestions we give to
> R/ubuntu users, e.g. on https://github.com/r-spatial/sf ?
> 
> They are:
> 
> sudo add-apt-repository ppa:ubuntugis/ubuntugis-unstable
> sudo apt-get update
> sudo apt-get install libudunits2-dev libgdal-dev libgeos-dev libproj-dev
> 
> On 10/28/19 4:34 PM, Tomislav Hengl wrote:
>>
>> Dear R-sig-geo,
>>
>> I am trying to install proj4 v6 on Ubuntu 18.04 bionic. I though I can
>> install it simply by following the ubuntugis steps
>> (https://mothergeo-py.readthedocs.io/en/latest/development/how-to/gdal-ubuntu-pkg.html)
>> but this does not lead to newest version of proj4 v6.
>>
>> Then I have tried to follow the proj6 steps
>> (https://proj.org/install.html#install) which indicate that I should do
>> it via the Anaconda installer. After I installed proj4 v6 from conda I get:
>>
>> $ which proj
>> /home/tomislav/anaconda2/bin/proj
>>
>> $? proj -V
>> Rel. 6.2.0, September 1st, 2019
>> <proj>:
>> projection initialization failure
>> cause: no arguments in initialization list
>> program abnormally terminated
>>
>> After that I've added the 'PROJ_LIB = /home/tomislav/anaconda2/bin/proj
>> ' to my .Renviron file and then I get:
>>
>> install.packages("rgdal")
>> Installing package into ?/home/tomislav/R/x86_64-pc-linux-gnu-library/3.5?
>> (as ?lib? is unspecified)
>> ...
>> checking PROJ.4: epsg found and readable... no
>> Error: proj/epsg not found
>> Either install missing proj support files, for example
>> the proj-nad and proj-epsg RPMs on systems using RPMs,
>> or if installed but not autodetected, set PROJ_LIB to the
>> correct path, and if need be use the --with-proj-share=
>> configure argument.
>> ERROR: configuration failed for package ?rgdal?
>> * removing ?/home/tomislav/R/x86_64-pc-linux-gnu-library/3.5/rgdal?
>> Warning in install.packages :
>>  ? installation of package ?rgdal? had non-zero exit status
>>
>> $gdalinfo --version
>> GDAL 2.4.0, released 2018/12/14
>>
>> What am I doing wrong? Which tutorial / documentation do you advise to
>> install proj4 v6 and rgdal package on Ubuntu?
>>
>> thank you (especially you Roger!),
>>
>> T. Hengl
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From edu@rdod|ez @end|ng |rom gmx@com  Tue Oct 29 13:14:35 2019
From: edu@rdod|ez @end|ng |rom gmx@com (Eduardo Diez)
Date: Tue, 29 Oct 2019 09:14:35 -0300
Subject: [R-sig-Geo] Segmentation fault
In-Reply-To: <alpine.LFD.2.21.1910290951220.15781@reclus.nhh.no>
References: <CANK5cGw44peBT+2nj=pGgDHm4p8pUUvD3kHL+GdhvY1xJL+m4w@mail.gmail.com>
 <alpine.LFD.2.21.1910290951220.15781@reclus.nhh.no>
Message-ID: <CANK5cGyFbiLfnTKCdw6NrLnz9Mg1sYfBEdDieKAOcgm8ZvV-HQ@mail.gmail.com>

Roger,
Yes sorry about the confusion. Domino is a company (dominodatalab.com) that
offers a an environment for data science. It's based on docker images. On
one of those images I installed sf and lwgeom. What information should I
get from the image that helps identify the source of the problem?

Thanks,
Best

El mar., 29 oct. 2019 05:54, Roger Bivand <Roger.Bivand at nhh.no> escribi?:

> On Mon, 28 Oct 2019, Eduardo Diez wrote:
>
> > Hi everyone.
> > I'm having problems running spatial processes in a domino machine. I
>
> Please raise an issue on https://github.com/r-spatial/sf/issues, giving
> much more detail about your installation (domino is unknown to everybody
> but yourself, duckduckgo says: "Domino Machine manufactures blow out
> preventers, stuffing boxes, and API products"). Likely cause - failed
> installation of lwgeom, or multiple installs of external software. Avoid
> posting HTML.
>
> Roger
>
> > created a new environment with updated spatial packages but I'm unable to
> > run simple tasks. Below an example and some information:
> >
> >> library(sf)Linking to GEOS 3.6.2, GDAL 2.4.2, PROJ 4.9.3> sessionInfo()
> > R version 3.6.1 (2019-07-05)
> > Platform: x86_64-pc-linux-gnu (64-bit)
> > Running under: Ubuntu 18.04.3 LTS
> >
> > Matrix products: default
> > BLAS:   /usr/lib/x86_64-linux-gnu/atlas/libblas.so.3.10.3
> > LAPACK: /usr/lib/x86_64-linux-gnu/atlas/liblapack.so.3.10.3
> >
> > locale:
> > [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
> > [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
> > [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
> > [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
> > [9] LC_ADDRESS=C               LC_TELEPHONE=C
> > [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
> >
> > attached base packages:
> > [1] stats     graphics  grDevices utils     datasets  methods   base
> >
> > other attached packages:
> > [1] sf_0.8-0
> >
> > loaded via a namespace (and not attached):
> > [1] compiler_3.6.1     magrittr_1.5       class_7.3-15       tools_3.6.1
> > [5] DBI_1.0.0          units_0.6-5        Rcpp_1.0.2
>  KernSmooth_2.23-16
> > [9] grid_3.6.1         e1071_1.7-2        classInt_0.4-2
> >> sf_extSoftVersion()
> >          GEOS           GDAL         proj.4 GDAL_with_GEOS     USE_PROJ_H
> >       "3.6.2"        "2.4.2"        "4.9.3"         "true"        "false"
> >> nc = st_read(system.file("shape/nc.shp", package="sf"))
> > Reading layer `nc' from data source
> > `/usr/local/lib/R/site-library/sf/shape/nc.shp' using driver `ESRI
> > Shapefile'
> > Simple feature collection with 100 features and 14 fields
> > geometry type:  MULTIPOLYGON
> > dimension:      XY
> > bbox:           xmin: -84.32385 ymin: 33.88199 xmax: -75.45698 ymax:
> 36.58965
> > epsg (SRID):    4267
> > proj4string:    +proj=longlat +datum=NAD27 +no_defs
> >> asd <- st_area(nc[1,]) # area from long/lat
> >
> >
> > *** caught segfault ***
> > address (nil), cause 'unknown'
> > Traceback:
> > 1: CPL_crs_parameters(x$proj4string)
> > 2: structure(CPL_crs_parameters(x$proj4string), names =
> > c("SemiMajor",     "SemiMinor", "InvFlattening", "units_gdal",
> > "IsVertical",     "WktPretty", "Wkt"))
> > 3: crs_parameters(crs) 4: st_crs.sfc(st_geometry(x), parameters = TRUE)
> > 5: st_crs(st_geometry(x), parameters = TRUE)
> > 6: lwgeom::st_geod_area(x)
> > 7: st_area.sfc(st_geometry(x, ...))
> > 8: st_area(st_geometry(x, ...))
> > 9: st_area.sf(nc[1, ])
> > 10: st_area(nc[1, ])
> > An irrecoverable exception occurred. R is aborting now ...Segmentation
> > fault (core dumped)
> >
> >
> > Thanks in advance
> >
> > Best,
> >
> > Edu
> >
> >       [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> https://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>

	[[alternative HTML version deleted]]


From Roger@B|v@nd @end|ng |rom nhh@no  Tue Oct 29 13:21:03 2019
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Tue, 29 Oct 2019 13:21:03 +0100
Subject: [R-sig-Geo] Segmentation fault
In-Reply-To: <CANK5cGyFbiLfnTKCdw6NrLnz9Mg1sYfBEdDieKAOcgm8ZvV-HQ@mail.gmail.com>
References: <CANK5cGw44peBT+2nj=pGgDHm4p8pUUvD3kHL+GdhvY1xJL+m4w@mail.gmail.com>
 <alpine.LFD.2.21.1910290951220.15781@reclus.nhh.no>
 <CANK5cGyFbiLfnTKCdw6NrLnz9Mg1sYfBEdDieKAOcgm8ZvV-HQ@mail.gmail.com>
Message-ID: <alpine.LFD.2.21.1910291318410.15781@reclus.nhh.no>

On Tue, 29 Oct 2019, Eduardo Diez wrote:

> Roger,
> Yes sorry about the confusion. Domino is a company (dominodatalab.com) that
> offers a an environment for data science. It's based on docker images. On
> one of those images I installed sf and lwgeom. What information should I
> get from the image that helps identify the source of the problem?

What OS is the docker image running; where do they get the image? Please 
do raise this as an issue, this is not the best channel for this, and 
nobody else uses this image I guess. The problem is most likely that the 
image does not have the necessary underlying external requirements set up 
correctly.

Roger

>
> Thanks,
> Best
>
> El mar., 29 oct. 2019 05:54, Roger Bivand <Roger.Bivand at nhh.no> escribi?:
>
>> On Mon, 28 Oct 2019, Eduardo Diez wrote:
>>
>>> Hi everyone.
>>> I'm having problems running spatial processes in a domino machine. I
>>
>> Please raise an issue on https://github.com/r-spatial/sf/issues, giving
>> much more detail about your installation (domino is unknown to everybody
>> but yourself, duckduckgo says: "Domino Machine manufactures blow out
>> preventers, stuffing boxes, and API products"). Likely cause - failed
>> installation of lwgeom, or multiple installs of external software. Avoid
>> posting HTML.
>>
>> Roger
>>
>>> created a new environment with updated spatial packages but I'm unable to
>>> run simple tasks. Below an example and some information:
>>>
>>>> library(sf)Linking to GEOS 3.6.2, GDAL 2.4.2, PROJ 4.9.3> sessionInfo()
>>> R version 3.6.1 (2019-07-05)
>>> Platform: x86_64-pc-linux-gnu (64-bit)
>>> Running under: Ubuntu 18.04.3 LTS
>>>
>>> Matrix products: default
>>> BLAS:   /usr/lib/x86_64-linux-gnu/atlas/libblas.so.3.10.3
>>> LAPACK: /usr/lib/x86_64-linux-gnu/atlas/liblapack.so.3.10.3
>>>
>>> locale:
>>> [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>>> [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>>> [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>>> [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
>>> [9] LC_ADDRESS=C               LC_TELEPHONE=C
>>> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>>>
>>> attached base packages:
>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>
>>> other attached packages:
>>> [1] sf_0.8-0
>>>
>>> loaded via a namespace (and not attached):
>>> [1] compiler_3.6.1     magrittr_1.5       class_7.3-15       tools_3.6.1
>>> [5] DBI_1.0.0          units_0.6-5        Rcpp_1.0.2
>>  KernSmooth_2.23-16
>>> [9] grid_3.6.1         e1071_1.7-2        classInt_0.4-2
>>>> sf_extSoftVersion()
>>>          GEOS           GDAL         proj.4 GDAL_with_GEOS     USE_PROJ_H
>>>       "3.6.2"        "2.4.2"        "4.9.3"         "true"        "false"
>>>> nc = st_read(system.file("shape/nc.shp", package="sf"))
>>> Reading layer `nc' from data source
>>> `/usr/local/lib/R/site-library/sf/shape/nc.shp' using driver `ESRI
>>> Shapefile'
>>> Simple feature collection with 100 features and 14 fields
>>> geometry type:  MULTIPOLYGON
>>> dimension:      XY
>>> bbox:           xmin: -84.32385 ymin: 33.88199 xmax: -75.45698 ymax:
>> 36.58965
>>> epsg (SRID):    4267
>>> proj4string:    +proj=longlat +datum=NAD27 +no_defs
>>>> asd <- st_area(nc[1,]) # area from long/lat
>>>
>>>
>>> *** caught segfault ***
>>> address (nil), cause 'unknown'
>>> Traceback:
>>> 1: CPL_crs_parameters(x$proj4string)
>>> 2: structure(CPL_crs_parameters(x$proj4string), names =
>>> c("SemiMajor",     "SemiMinor", "InvFlattening", "units_gdal",
>>> "IsVertical",     "WktPretty", "Wkt"))
>>> 3: crs_parameters(crs) 4: st_crs.sfc(st_geometry(x), parameters = TRUE)
>>> 5: st_crs(st_geometry(x), parameters = TRUE)
>>> 6: lwgeom::st_geod_area(x)
>>> 7: st_area.sfc(st_geometry(x, ...))
>>> 8: st_area(st_geometry(x, ...))
>>> 9: st_area.sf(nc[1, ])
>>> 10: st_area(nc[1, ])
>>> An irrecoverable exception occurred. R is aborting now ...Segmentation
>>> fault (core dumped)
>>>
>>>
>>> Thanks in advance
>>>
>>> Best,
>>>
>>> Edu
>>>
>>>       [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>> --
>> Roger Bivand
>> Department of Economics, Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>> https://orcid.org/0000-0003-2392-6140
>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From edzer@pebe@m@ @end|ng |rom un|-muen@ter@de  Tue Oct 29 14:01:00 2019
From: edzer@pebe@m@ @end|ng |rom un|-muen@ter@de (Edzer Pebesma)
Date: Tue, 29 Oct 2019 14:01:00 +0100
Subject: [R-sig-Geo] Installation of proj4 v6 on Ubuntu 18.04 Error:
 proj/epsg not found
In-Reply-To: <7643fb84-0b59-340f-a63a-7edb5b99a2d6@gmail.com>
References: <931a8bbc-25ca-7304-2333-633df2e4f952@gmail.com>
 <c5795af9-5eff-6379-ece6-f2f2f163c08f@uni-muenster.de>
 <7643fb84-0b59-340f-a63a-7edb5b99a2d6@gmail.com>
Message-ID: <3330120b-3bb7-d2bf-9f54-199186107dd7@uni-muenster.de>

Would you mind giving the ouptut of:

pkg-config proj --libs
pkg-config proj --cflags

and also try:

install.packages("rgdal", repos="http://R-Forge.R-project.org")

On 10/29/19 7:11 AM, Tomislav Hengl wrote:
> 
> Thanks Edzer,
> 
> I removed my gdal (which removes also all QGIS and everything connect
> unfortunately) then I followed your steps and I get (somehow the proj
> version is still 5 and not 6):
> 
>> install.packages("rgdal")
> ? % Total??? % Received % Xferd? Average Speed?? Time??? Time???? Time
> Current
> ???????????????????????????????? Dload? Upload?? Total?? Spent??? Left
> Speed
> 100 1631k? 100 1631k??? 0???? 0?? 713k????? 0? 0:00:02? 0:00:02 --:--:--
> ?713k
> * installing *source* package ?rgdal? ...
> ** package ?rgdal? successfully unpacked and MD5 sums checked
> checking for g++... g++
> checking whether the C++ compiler works... yes
> checking for C++ compiler default output file name... a.out
> checking for suffix of executables...
> checking whether we are cross compiling... no
> checking for suffix of object files... o
> checking whether we are using the GNU C++ compiler... yes
> checking whether g++ accepts -g... yes
> configure: CC: gcc -std=gnu99
> configure: CXX: g++
> configure: rgdal: 1.3-3
> checking for /usr/bin/svnversion... yes
> configure: svn revision: 759
> checking whether g++ supports C++11 features by default... yes
> configure: C++11 support available
> checking for gdal-config... /usr/bin/gdal-config
> checking gdal-config usability... yes
> configure: GDAL: 2.4.2
> checking C++11 support for GDAL >= 2.3.0... yes
> checking GDAL version >= 1.11.4... yes
> checking gdal: linking with --libs only... yes
> checking GDAL: /usr/share/gdal/pcs.csv readable... yes
> configure: pkg-config proj exists, will use it
> configure: PROJ version: 5.2.0
> checking proj_api.h presence and usability... no
> configure: error: proj_api.h not found in standard or given locations.
> ERROR: configuration failed for package ?rgdal?
> * removing ?/opt/microsoft/ropen/3.5.1/lib64/R/library/rgdal?
> * restoring previous ?/opt/microsoft/ropen/3.5.1/lib64/R/library/rgdal?
> 
> The downloaded source packages are in
> ?????/data/RTMP/Rtmpl5wj21/downloaded_packages?
> Updating HTML index of packages in '.Library'
> Making 'packages.html' ... done
> Warning message:
> In install.packages("rgdal") :
> ? installation of package ?rgdal? had non-zero exit status
> 
> what am I doing wrong?
> 
> 
> On 10/28/19 10:36 PM, Edzer Pebesma wrote:
>> Hi Tom,
>>
>> formerly PROJ.4 is now called PROJ.
>>
>> Have you also tried the usual ubuntu install suggestions we give to
>> R/ubuntu users, e.g. on https://github.com/r-spatial/sf ?
>>
>> They are:
>>
>> sudo add-apt-repository ppa:ubuntugis/ubuntugis-unstable
>> sudo apt-get update
>> sudo apt-get install libudunits2-dev libgdal-dev libgeos-dev libproj-dev
>>
>> On 10/28/19 4:34 PM, Tomislav Hengl wrote:
>>>
>>> Dear R-sig-geo,
>>>
>>> I am trying to install proj4 v6 on Ubuntu 18.04 bionic. I though I can
>>> install it simply by following the ubuntugis steps
>>> (https://mothergeo-py.readthedocs.io/en/latest/development/how-to/gdal-ubuntu-pkg.html)
>>>
>>> but this does not lead to newest version of proj4 v6.
>>>
>>> Then I have tried to follow the proj6 steps
>>> (https://proj.org/install.html#install) which indicate that I should do
>>> it via the Anaconda installer. After I installed proj4 v6 from conda
>>> I get:
>>>
>>> $ which proj
>>> /home/tomislav/anaconda2/bin/proj
>>>
>>> $? proj -V
>>> Rel. 6.2.0, September 1st, 2019
>>> <proj>:
>>> projection initialization failure
>>> cause: no arguments in initialization list
>>> program abnormally terminated
>>>
>>> After that I've added the 'PROJ_LIB = /home/tomislav/anaconda2/bin/proj
>>> ' to my .Renviron file and then I get:
>>>
>>> install.packages("rgdal")
>>> Installing package into
>>> ?/home/tomislav/R/x86_64-pc-linux-gnu-library/3.5?
>>> (as ?lib? is unspecified)
>>> ...
>>> checking PROJ.4: epsg found and readable... no
>>> Error: proj/epsg not found
>>> Either install missing proj support files, for example
>>> the proj-nad and proj-epsg RPMs on systems using RPMs,
>>> or if installed but not autodetected, set PROJ_LIB to the
>>> correct path, and if need be use the --with-proj-share=
>>> configure argument.
>>> ERROR: configuration failed for package ?rgdal?
>>> * removing ?/home/tomislav/R/x86_64-pc-linux-gnu-library/3.5/rgdal?
>>> Warning in install.packages :
>>> ?? installation of package ?rgdal? had non-zero exit status
>>>
>>> $gdalinfo --version
>>> GDAL 2.4.0, released 2018/12/14
>>>
>>> What am I doing wrong? Which tutorial / documentation do you advise to
>>> install proj4 v6 and rgdal package on Ubuntu?
>>>
>>> thank you (especially you Roger!),
>>>
>>> T. Hengl
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>

-- 
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48151 Muenster, Germany
Phone: +49 251 8333081

-------------- next part --------------
A non-text attachment was scrubbed...
Name: pEpkey.asc
Type: application/pgp-keys
Size: 3110 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20191029/c41f08bf/attachment.bin>

From v|j@y|u||@ @end|ng |rom gm@||@com  Tue Oct 29 14:02:17 2019
From: v|j@y|u||@ @end|ng |rom gm@||@com (Vijay Lulla)
Date: Tue, 29 Oct 2019 09:02:17 -0400
Subject: [R-sig-Geo] Plotting median values globally
In-Reply-To: <449745220.2686965.1572322599506@mail.yahoo.com>
References: <449745220.2686965.1572322599506.ref@mail.yahoo.com>
 <449745220.2686965.1572322599506@mail.yahoo.com>
Message-ID: <CAKkiGbtEV+5FbvCyChKPqTBsRp3eOO4N0U0Q-zA3oKbeTG-i+Q@mail.gmail.com>

Did you try `levelplot(raster(RCP1pctCO2median, 61))`?

On Tue, Oct 29, 2019 at 12:17 AM rain1290--- via R-sig-Geo <
r-sig-geo at r-project.org> wrote:

> Hi there,
> I am trying to create a global plot with median precipitation values. What
> I would like to do is isolate the "median" values and plot those values on
> a global raster map. I already first created a raster stack, called
> "RCP1pctCO2median", which contains the median values to be plotted.
> However, what I would like to do is simply plot only those values at Year
> 61 for each grid cell. There are 138 layers, with each layer representing
> one year. The idea would be to plot only those values for Year/layer 61
> globally (i,e, for each grid cell), but I am unsure how to isolate that
> specific year/layer?
> "RCP1pctCO2median"  has the following attributes:
>
> class       : RasterStack
> dimensions  : 64, 128, 8192, 138  (nrow, ncol, ncell, nlayers)
> resolution  : 2.8125, 2.789327  (x, y)
> extent      : -181.4062, 178.5938, -89.25846, 89.25846  (xmin, xmax, ymin,
> ymax)
> coord. ref. : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0
> names       :    layer.1,    layer.2,    layer.3,    layer.4,    layer.5,
>   layer.6,    layer.7,    layer.8,    layer.9,   layer.10,   layer.11,
>  layer.12,   layer.13,   layer.14,   layer.15, ...
> min values  : 0.42964514, 0.43375653, 0.51749371, 0.50838983, 0.45366730,
> 0.53099146, 0.49757186, 0.45697752, 0.41382199, 0.46082401, 0.45516687,
> 0.51857087, 0.41005131, 0.45956529, 0.47497867, ...
> max values  :   96.30350,  104.08584,   88.92751,   97.49373,   89.57201,
>  90.58570,   86.67651,   88.33519,   96.94720,  101.58247,   96.07792,
>  93.21948,   99.59785,   94.26218,   90.62138, ...
>
>
> And this is how I would like to create my global raster map. However, I am
> not sure how to plot only one value (i.e. the median value, which occurs at
> Year 61) for each grid cell. This is what I have so far, but all that this
> does is plot 138 mini plots, and I just want one plot showing the median
> values (i.e. Year 61):
>
>
> mapTheme<-rasterTheme(region=rev(brewer.pal(10,"Spectral")))
> cutpoints<-c(200,175,150,125,100,75,50,25,0)
> levelplot(RCP1pctCO2median,margin=F,at=cutpoints,cuts=11,pretty=TRUE,par.settings=mapTheme,
> main="Median values")
>
>
>
> Any help would be greatly appreciated!
> I look forward to your response!
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From Roger@B|v@nd @end|ng |rom nhh@no  Tue Oct 29 14:05:26 2019
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Tue, 29 Oct 2019 14:05:26 +0100
Subject: [R-sig-Geo] Installation of proj4 v6 on Ubuntu 18.04 Error:
 proj/epsg not found
In-Reply-To: <3330120b-3bb7-d2bf-9f54-199186107dd7@uni-muenster.de>
References: <931a8bbc-25ca-7304-2333-633df2e4f952@gmail.com>
 <c5795af9-5eff-6379-ece6-f2f2f163c08f@uni-muenster.de>
 <7643fb84-0b59-340f-a63a-7edb5b99a2d6@gmail.com>
 <3330120b-3bb7-d2bf-9f54-199186107dd7@uni-muenster.de>
Message-ID: <alpine.LFD.2.21.1910291404330.15781@reclus.nhh.no>

On Tue, 29 Oct 2019, Edzer Pebesma wrote:

> Would you mind giving the ouptut of:
>
> pkg-config proj --libs
> pkg-config proj --cflags
>
> and also try:
>
> install.packages("rgdal", repos="http://R-Forge.R-project.org")

Preferably not this, not currently stable. Latest CRAN release was stable.

Roger


>
> On 10/29/19 7:11 AM, Tomislav Hengl wrote:
>>
>> Thanks Edzer,
>>
>> I removed my gdal (which removes also all QGIS and everything connect
>> unfortunately) then I followed your steps and I get (somehow the proj
>> version is still 5 and not 6):
>>
>>> install.packages("rgdal")
>> ? % Total??? % Received % Xferd? Average Speed?? Time??? Time???? Time
>> Current
>> ???????????????????????????????? Dload? Upload?? Total?? Spent??? Left
>> Speed
>> 100 1631k? 100 1631k??? 0???? 0?? 713k????? 0? 0:00:02? 0:00:02 --:--:--
>> ?713k
>> * installing *source* package ?rgdal? ...
>> ** package ?rgdal? successfully unpacked and MD5 sums checked
>> checking for g++... g++
>> checking whether the C++ compiler works... yes
>> checking for C++ compiler default output file name... a.out
>> checking for suffix of executables...
>> checking whether we are cross compiling... no
>> checking for suffix of object files... o
>> checking whether we are using the GNU C++ compiler... yes
>> checking whether g++ accepts -g... yes
>> configure: CC: gcc -std=gnu99
>> configure: CXX: g++
>> configure: rgdal: 1.3-3
>> checking for /usr/bin/svnversion... yes
>> configure: svn revision: 759
>> checking whether g++ supports C++11 features by default... yes
>> configure: C++11 support available
>> checking for gdal-config... /usr/bin/gdal-config
>> checking gdal-config usability... yes
>> configure: GDAL: 2.4.2
>> checking C++11 support for GDAL >= 2.3.0... yes
>> checking GDAL version >= 1.11.4... yes
>> checking gdal: linking with --libs only... yes
>> checking GDAL: /usr/share/gdal/pcs.csv readable... yes
>> configure: pkg-config proj exists, will use it
>> configure: PROJ version: 5.2.0
>> checking proj_api.h presence and usability... no
>> configure: error: proj_api.h not found in standard or given locations.
>> ERROR: configuration failed for package ?rgdal?
>> * removing ?/opt/microsoft/ropen/3.5.1/lib64/R/library/rgdal?
>> * restoring previous ?/opt/microsoft/ropen/3.5.1/lib64/R/library/rgdal?
>>
>> The downloaded source packages are in
>> ?????/data/RTMP/Rtmpl5wj21/downloaded_packages?
>> Updating HTML index of packages in '.Library'
>> Making 'packages.html' ... done
>> Warning message:
>> In install.packages("rgdal") :
>> ? installation of package ?rgdal? had non-zero exit status
>>
>> what am I doing wrong?
>>
>>
>> On 10/28/19 10:36 PM, Edzer Pebesma wrote:
>>> Hi Tom,
>>>
>>> formerly PROJ.4 is now called PROJ.
>>>
>>> Have you also tried the usual ubuntu install suggestions we give to
>>> R/ubuntu users, e.g. on https://github.com/r-spatial/sf ?
>>>
>>> They are:
>>>
>>> sudo add-apt-repository ppa:ubuntugis/ubuntugis-unstable
>>> sudo apt-get update
>>> sudo apt-get install libudunits2-dev libgdal-dev libgeos-dev libproj-dev
>>>
>>> On 10/28/19 4:34 PM, Tomislav Hengl wrote:
>>>>
>>>> Dear R-sig-geo,
>>>>
>>>> I am trying to install proj4 v6 on Ubuntu 18.04 bionic. I though I can
>>>> install it simply by following the ubuntugis steps
>>>> (https://mothergeo-py.readthedocs.io/en/latest/development/how-to/gdal-ubuntu-pkg.html)
>>>>
>>>> but this does not lead to newest version of proj4 v6.
>>>>
>>>> Then I have tried to follow the proj6 steps
>>>> (https://proj.org/install.html#install) which indicate that I should do
>>>> it via the Anaconda installer. After I installed proj4 v6 from conda
>>>> I get:
>>>>
>>>> $ which proj
>>>> /home/tomislav/anaconda2/bin/proj
>>>>
>>>> $? proj -V
>>>> Rel. 6.2.0, September 1st, 2019
>>>> <proj>:
>>>> projection initialization failure
>>>> cause: no arguments in initialization list
>>>> program abnormally terminated
>>>>
>>>> After that I've added the 'PROJ_LIB = /home/tomislav/anaconda2/bin/proj
>>>> ' to my .Renviron file and then I get:
>>>>
>>>> install.packages("rgdal")
>>>> Installing package into
>>>> ?/home/tomislav/R/x86_64-pc-linux-gnu-library/3.5?
>>>> (as ?lib? is unspecified)
>>>> ...
>>>> checking PROJ.4: epsg found and readable... no
>>>> Error: proj/epsg not found
>>>> Either install missing proj support files, for example
>>>> the proj-nad and proj-epsg RPMs on systems using RPMs,
>>>> or if installed but not autodetected, set PROJ_LIB to the
>>>> correct path, and if need be use the --with-proj-share=
>>>> configure argument.
>>>> ERROR: configuration failed for package ?rgdal?
>>>> * removing ?/home/tomislav/R/x86_64-pc-linux-gnu-library/3.5/rgdal?
>>>> Warning in install.packages :
>>>> ?? installation of package ?rgdal? had non-zero exit status
>>>>
>>>> $gdalinfo --version
>>>> GDAL 2.4.0, released 2018/12/14
>>>>
>>>> What am I doing wrong? Which tutorial / documentation do you advise to
>>>> install proj4 v6 and rgdal package on Ubuntu?
>>>>
>>>> thank you (especially you Roger!),
>>>>
>>>> T. Hengl
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From @@r@h@go@|ee @end|ng |rom gm@||@com  Tue Oct 29 15:51:48 2019
From: @@r@h@go@|ee @end|ng |rom gm@||@com (Sarah Goslee)
Date: Tue, 29 Oct 2019 10:51:48 -0400
Subject: [R-sig-Geo] Variable importance bar plot
In-Reply-To: <CAC4+n+wrH6kinnT+aTRH_+oOFKw6uy7R7Oey=mzESPHZ8e8XJg@mail.gmail.com>
References: <CAC4+n+wrH6kinnT+aTRH_+oOFKw6uy7R7Oey=mzESPHZ8e8XJg@mail.gmail.com>
Message-ID: <CAM_vju=EXqeFoOM4PTZ6k_L4RreL9gnM1Uaomtxko525=Tmr-g@mail.gmail.com>

It's not entirely clear to me how you expect the values to be
calculated, but you might look at partial dependence plots, for
example as implemented in the pdp package.

Sarah

On Sun, Oct 27, 2019 at 6:00 AM Enoch Gyamfi Ampadu <egampadu at gmail.com> wrote:
>
> Dear List,
>
> I hope this finds you well. Please I have done a Land cover classification
> using randomForest. I used selected satellite image bands as input
> variables. I have four thematic classes. I obtained the general variable
> importance using *varImpPlot (my model) . *Now I want to have bar chart
> plot showing each thematic class and the variable importance for each
> class. That is, how each band is ranked in predicting a thematic class. I
> tried using this function:
>
> *importance = varImp(my model, scale= TRUE)*
>
> *plot (importance. *
>
> However it did not work. I tried to put in *geom= "bar*". And I had error.
>
> Please I will be glad to get some assistance.
>
> Thank you.
>
> Best regards,
>
> Enoch
>


-- 
Sarah Goslee (she/her)
http://www.numberwright.com


From b|@|ev||@t @end|ng |rom gm@||@com  Tue Oct 29 17:17:20 2019
From: b|@|ev||@t @end|ng |rom gm@||@com (=?UTF-8?Q?Bede-Fazekas_=c3=81kos?=)
Date: Tue, 29 Oct 2019 17:17:20 +0100
Subject: [R-sig-Geo] Variable importance bar plot
In-Reply-To: <CAM_vju=EXqeFoOM4PTZ6k_L4RreL9gnM1Uaomtxko525=Tmr-g@mail.gmail.com>
References: <CAC4+n+wrH6kinnT+aTRH_+oOFKw6uy7R7Oey=mzESPHZ8e8XJg@mail.gmail.com>
 <CAM_vju=EXqeFoOM4PTZ6k_L4RreL9gnM1Uaomtxko525=Tmr-g@mail.gmail.com>
Message-ID: <43275cbc-6208-05c9-3b40-fe8fbd276630@gmail.com>

Dear Enoch,

randomForest:varImpPlot() has a parameter called 'class' that is NULL by 
default but can be changed to get the class-specific measure of importance.
'geom= "bar"': do you want to plot the result using ggplot2 instead of 
the base plot produced by varImpPlot()? In this case you should firstly 
assign the invisiby returning result of varImpPlot() (or that of 
importance()) to a variable, and then plot it with ggplot().

HTH,
?kos Bede-Fazekas
Hungarian Academy of Sciences


2019.10.29. 15:51 keltez?ssel, Sarah Goslee ?rta:
> It's not entirely clear to me how you expect the values to be
> calculated, but you might look at partial dependence plots, for
> example as implemented in the pdp package.
>
> Sarah
>
> On Sun, Oct 27, 2019 at 6:00 AM Enoch Gyamfi Ampadu <egampadu at gmail.com> wrote:
>> Dear List,
>>
>> I hope this finds you well. Please I have done a Land cover classification
>> using randomForest. I used selected satellite image bands as input
>> variables. I have four thematic classes. I obtained the general variable
>> importance using *varImpPlot (my model) . *Now I want to have bar chart
>> plot showing each thematic class and the variable importance for each
>> class. That is, how each band is ranked in predicting a thematic class. I
>> tried using this function:
>>
>> *importance = varImp(my model, scale= TRUE)*
>>
>> *plot (importance. *
>>
>> However it did not work. I tried to put in *geom= "bar*". And I had error.
>>
>> Please I will be glad to get some assistance.
>>
>> Thank you.
>>
>> Best regards,
>>
>> Enoch
>>
>


From edu@rdod|ez @end|ng |rom gmx@com  Tue Oct 29 17:35:55 2019
From: edu@rdod|ez @end|ng |rom gmx@com (Eduardo Diez)
Date: Tue, 29 Oct 2019 13:35:55 -0300
Subject: [R-sig-Geo] Segmentation fault
In-Reply-To: <alpine.LFD.2.21.1910291318410.15781@reclus.nhh.no>
References: <CANK5cGw44peBT+2nj=pGgDHm4p8pUUvD3kHL+GdhvY1xJL+m4w@mail.gmail.com>
 <alpine.LFD.2.21.1910290951220.15781@reclus.nhh.no>
 <CANK5cGyFbiLfnTKCdw6NrLnz9Mg1sYfBEdDieKAOcgm8ZvV-HQ@mail.gmail.com>
 <alpine.LFD.2.21.1910291318410.15781@reclus.nhh.no>
Message-ID: <CANK5cGzYWitV+YiRMPa=6NM6cGuPehLNYYTo6oU7YykfGwduKQ@mail.gmail.com>

The OS was part of my initial post:

> sessionInfo()
R version 3.6.1 (2019-07-05)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 18.04.3 LTS


But nevermind, I'll stop posting here.
Thanks

El mar., 29 oct. 2019 09:21, Roger Bivand <Roger.Bivand at nhh.no> escribi?:

> On Tue, 29 Oct 2019, Eduardo Diez wrote:
>
> > Roger,
> > Yes sorry about the confusion. Domino is a company (dominodatalab.com)
> that
> > offers a an environment for data science. It's based on docker images. On
> > one of those images I installed sf and lwgeom. What information should I
> > get from the image that helps identify the source of the problem?
>
> What OS is the docker image running; where do they get the image? Please
> do raise this as an issue, this is not the best channel for this, and
> nobody else uses this image I guess. The problem is most likely that the
> image does not have the necessary underlying external requirements set up
> correctly.
>
> Roger
>
> >
> > Thanks,
> > Best
> >
> > El mar., 29 oct. 2019 05:54, Roger Bivand <Roger.Bivand at nhh.no>
> escribi?:
> >
> >> On Mon, 28 Oct 2019, Eduardo Diez wrote:
> >>
> >>> Hi everyone.
> >>> I'm having problems running spatial processes in a domino machine. I
> >>
> >> Please raise an issue on https://github.com/r-spatial/sf/issues, giving
> >> much more detail about your installation (domino is unknown to everybody
> >> but yourself, duckduckgo says: "Domino Machine manufactures blow out
> >> preventers, stuffing boxes, and API products"). Likely cause - failed
> >> installation of lwgeom, or multiple installs of external software. Avoid
> >> posting HTML.
> >>
> >> Roger
> >>
> >>> created a new environment with updated spatial packages but I'm unable
> to
> >>> run simple tasks. Below an example and some information:
> >>>
> >>>> library(sf)Linking to GEOS 3.6.2, GDAL 2.4.2, PROJ 4.9.3>
> sessionInfo()
> >>> R version 3.6.1 (2019-07-05)
> >>> Platform: x86_64-pc-linux-gnu (64-bit)
> >>> Running under: Ubuntu 18.04.3 LTS
> >>>
> >>> Matrix products: default
> >>> BLAS:   /usr/lib/x86_64-linux-gnu/atlas/libblas.so.3.10.3
> >>> LAPACK: /usr/lib/x86_64-linux-gnu/atlas/liblapack.so.3.10.3
> >>>
> >>> locale:
> >>> [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
> >>> [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
> >>> [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
> >>> [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
> >>> [9] LC_ADDRESS=C               LC_TELEPHONE=C
> >>> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
> >>>
> >>> attached base packages:
> >>> [1] stats     graphics  grDevices utils     datasets  methods   base
> >>>
> >>> other attached packages:
> >>> [1] sf_0.8-0
> >>>
> >>> loaded via a namespace (and not attached):
> >>> [1] compiler_3.6.1     magrittr_1.5       class_7.3-15
>  tools_3.6.1
> >>> [5] DBI_1.0.0          units_0.6-5        Rcpp_1.0.2
> >>  KernSmooth_2.23-16
> >>> [9] grid_3.6.1         e1071_1.7-2        classInt_0.4-2
> >>>> sf_extSoftVersion()
> >>>          GEOS           GDAL         proj.4 GDAL_with_GEOS
>  USE_PROJ_H
> >>>       "3.6.2"        "2.4.2"        "4.9.3"         "true"
> "false"
> >>>> nc = st_read(system.file("shape/nc.shp", package="sf"))
> >>> Reading layer `nc' from data source
> >>> `/usr/local/lib/R/site-library/sf/shape/nc.shp' using driver `ESRI
> >>> Shapefile'
> >>> Simple feature collection with 100 features and 14 fields
> >>> geometry type:  MULTIPOLYGON
> >>> dimension:      XY
> >>> bbox:           xmin: -84.32385 ymin: 33.88199 xmax: -75.45698 ymax:
> >> 36.58965
> >>> epsg (SRID):    4267
> >>> proj4string:    +proj=longlat +datum=NAD27 +no_defs
> >>>> asd <- st_area(nc[1,]) # area from long/lat
> >>>
> >>>
> >>> *** caught segfault ***
> >>> address (nil), cause 'unknown'
> >>> Traceback:
> >>> 1: CPL_crs_parameters(x$proj4string)
> >>> 2: structure(CPL_crs_parameters(x$proj4string), names =
> >>> c("SemiMajor",     "SemiMinor", "InvFlattening", "units_gdal",
> >>> "IsVertical",     "WktPretty", "Wkt"))
> >>> 3: crs_parameters(crs) 4: st_crs.sfc(st_geometry(x), parameters = TRUE)
> >>> 5: st_crs(st_geometry(x), parameters = TRUE)
> >>> 6: lwgeom::st_geod_area(x)
> >>> 7: st_area.sfc(st_geometry(x, ...))
> >>> 8: st_area(st_geometry(x, ...))
> >>> 9: st_area.sf(nc[1, ])
> >>> 10: st_area(nc[1, ])
> >>> An irrecoverable exception occurred. R is aborting now ...Segmentation
> >>> fault (core dumped)
> >>>
> >>>
> >>> Thanks in advance
> >>>
> >>> Best,
> >>>
> >>> Edu
> >>>
> >>>       [[alternative HTML version deleted]]
> >>>
> >>> _______________________________________________
> >>> R-sig-Geo mailing list
> >>> R-sig-Geo at r-project.org
> >>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>>
> >>
> >> --
> >> Roger Bivand
> >> Department of Economics, Norwegian School of Economics,
> >> Helleveien 30, N-5045 Bergen, Norway.
> >> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> >> https://orcid.org/0000-0003-2392-6140
> >> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> >>
> >
> >       [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> https://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

	[[alternative HTML version deleted]]


From r@i@1290 m@iii@g oii @im@com  Tue Oct 29 17:38:40 2019
From: r@i@1290 m@iii@g oii @im@com (r@i@1290 m@iii@g oii @im@com)
Date: Tue, 29 Oct 2019 16:38:40 +0000 (UTC)
Subject: [R-sig-Geo] Plotting median values globally
In-Reply-To: <CAKkiGbtEV+5FbvCyChKPqTBsRp3eOO4N0U0Q-zA3oKbeTG-i+Q@mail.gmail.com>
References: <449745220.2686965.1572322599506.ref@mail.yahoo.com>
 <449745220.2686965.1572322599506@mail.yahoo.com>
 <CAKkiGbtEV+5FbvCyChKPqTBsRp3eOO4N0U0Q-zA3oKbeTG-i+Q@mail.gmail.com>
Message-ID: <57320868.2959568.1572367120127@mail.yahoo.com>

Hi Vijay and others,
Thank you so, so much for this reply!! Yes, this worked, just as you suggested. Just one little detail that I wanted to know - I was trying to change the color range of my plot, like this:
mapTheme<-rasterTheme(region=rev(brewer.pal(10,"Spectral")))
cutpoints<-c(200,175,150,125,100,75,50,25,0)
>levelplot(raster(RCP1pctCO2Median,61, margin=F,at=cutpoints,cuts=11,pretty=TRUE,par.settings=mapTheme, main="Median values"))




But I receive this error:
Error in .local(x, ...) : 
  unused arguments (margin = F, at = cutpoints, cuts = 11, pretty = TRUE, par.settings = mapTheme, main = "Median values")
What could be the reason behind this error?
Thank you, once again!!
~Trav.~
-----Original Message-----
From: Vijay Lulla <vijaylulla at gmail.com>
To: rain1290 <rain1290 at aim.com>
Cc: R-sig-geo Mailing List <r-sig-geo at r-project.org>
Sent: Tue, Oct 29, 2019 9:02 am
Subject: Re: [R-sig-Geo] Plotting median values globally

Did you try `levelplot(raster(RCP1pctCO2median, 61))`?

On Tue, Oct 29, 2019 at 12:17 AM rain1290--- via R-sig-Geo <r-sig-geo at r-project.org> wrote:

Hi there,
I am trying to create a global plot with median precipitation values. What I would like to do is isolate the "median" values and plot those values on a global raster map. I already first created a raster stack, called "RCP1pctCO2median", which contains the median values to be plotted. However, what I would like to do is simply plot only those values at Year 61 for each grid cell. There are 138 layers, with each layer representing one year. The idea would be to plot only those values for Year/layer 61 globally (i,e, for each grid cell), but I am unsure how to isolate that specific year/layer??
"RCP1pctCO2median"? has the following attributes:

class? ? ? ?: RasterStack 
dimensions? : 64, 128, 8192, 138? (nrow, ncol, ncell, nlayers)
resolution? : 2.8125, 2.789327? (x, y)
extent? ? ? : -181.4062, 178.5938, -89.25846, 89.25846? (xmin, xmax, ymin, ymax)
coord. ref. : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0 
names? ? ? ?:? ? layer.1,? ? layer.2,? ? layer.3,? ? layer.4,? ? layer.5,? ? layer.6,? ? layer.7,? ? layer.8,? ? layer.9,? ?layer.10,? ?layer.11,? ?layer.12,? ?layer.13,? ?layer.14,? ?layer.15, ... 
min values? : 0.42964514, 0.43375653, 0.51749371, 0.50838983, 0.45366730, 0.53099146, 0.49757186, 0.45697752, 0.41382199, 0.46082401, 0.45516687, 0.51857087, 0.41005131, 0.45956529, 0.47497867, ... 
max values? :? ?96.30350,? 104.08584,? ?88.92751,? ?97.49373,? ?89.57201,? ?90.58570,? ?86.67651,? ?88.33519,? ?96.94720,? 101.58247,? ?96.07792,? ?93.21948,? ?99.59785,? ?94.26218,? ?90.62138, ... 


And this is how I would like to create my global raster map. However, I am not sure how to plot only one value (i.e. the median value, which occurs at Year 61) for each grid cell. This is what I have so far, but all that this does is plot 138 mini plots, and I just want one plot showing the median values (i.e. Year 61):


mapTheme<-rasterTheme(region=rev(brewer.pal(10,"Spectral")))
cutpoints<-c(200,175,150,125,100,75,50,25,0)
levelplot(RCP1pctCO2median,margin=F,at=cutpoints,cuts=11,pretty=TRUE,par.settings=mapTheme, main="Median values")



Any help would be greatly appreciated!
I look forward to your response!?
? ? ? ? [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo




	[[alternative HTML version deleted]]


From b|@|ev||@t @end|ng |rom gm@||@com  Tue Oct 29 17:49:16 2019
From: b|@|ev||@t @end|ng |rom gm@||@com (=?UTF-8?Q?Bede-Fazekas_=c3=81kos?=)
Date: Tue, 29 Oct 2019 17:49:16 +0100
Subject: [R-sig-Geo] Plotting median values globally
In-Reply-To: <57320868.2959568.1572367120127@mail.yahoo.com>
References: <449745220.2686965.1572322599506.ref@mail.yahoo.com>
 <449745220.2686965.1572322599506@mail.yahoo.com>
 <CAKkiGbtEV+5FbvCyChKPqTBsRp3eOO4N0U0Q-zA3oKbeTG-i+Q@mail.gmail.com>
 <57320868.2959568.1572367120127@mail.yahoo.com>
Message-ID: <06ebf78e-8e6b-7b49-f426-0d435055e260@gmail.com>

Hello,
It is because the wrong place of the closing bracket. This might work, 
since margin, at, cuts etc. are the parameters of levelplot(9 not raster():
levelplot(raster(RCP1pctCO2Median,61), 
margin=F,at=cutpoints,cuts=11,pretty=TRUE,par.settings=mapTheme, 
main="Median values")
HTH,
?kos

2019.10.29. 17:38 keltez?ssel, rain1290--- via R-sig-Geo ?rta:
> Hi Vijay and others,
> Thank you so, so much for this reply!! Yes, this worked, just as you suggested. Just one little detail that I wanted to know - I was trying to change the color range of my plot, like this:
> mapTheme<-rasterTheme(region=rev(brewer.pal(10,"Spectral")))
> cutpoints<-c(200,175,150,125,100,75,50,25,0)
>> levelplot(raster(RCP1pctCO2Median,61, margin=F,at=cutpoints,cuts=11,pretty=TRUE,par.settings=mapTheme, main="Median values"))
>
>
>
> But I receive this error:
> Error in .local(x, ...) :
>    unused arguments (margin = F, at = cutpoints, cuts = 11, pretty = TRUE, par.settings = mapTheme, main = "Median values")
> What could be the reason behind this error?
> Thank you, once again!!
> ~Trav.~
> -----Original Message-----
> From: Vijay Lulla <vijaylulla at gmail.com>
> To: rain1290 <rain1290 at aim.com>
> Cc: R-sig-geo Mailing List <r-sig-geo at r-project.org>
> Sent: Tue, Oct 29, 2019 9:02 am
> Subject: Re: [R-sig-Geo] Plotting median values globally
>
> Did you try `levelplot(raster(RCP1pctCO2median, 61))`?
>
> On Tue, Oct 29, 2019 at 12:17 AM rain1290--- via R-sig-Geo <r-sig-geo at r-project.org> wrote:
>
> Hi there,
> I am trying to create a global plot with median precipitation values. What I would like to do is isolate the "median" values and plot those values on a global raster map. I already first created a raster stack, called "RCP1pctCO2median", which contains the median values to be plotted. However, what I would like to do is simply plot only those values at Year 61 for each grid cell. There are 138 layers, with each layer representing one year. The idea would be to plot only those values for Year/layer 61 globally (i,e, for each grid cell), but I am unsure how to isolate that specific year/layer?
> "RCP1pctCO2median"? has the following attributes:
>
> class? ? ? ?: RasterStack
> dimensions? : 64, 128, 8192, 138? (nrow, ncol, ncell, nlayers)
> resolution? : 2.8125, 2.789327? (x, y)
> extent? ? ? : -181.4062, 178.5938, -89.25846, 89.25846? (xmin, xmax, ymin, ymax)
> coord. ref. : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0
> names? ? ? ?:? ? layer.1,? ? layer.2,? ? layer.3,? ? layer.4,? ? layer.5,? ? layer.6,? ? layer.7,? ? layer.8,? ? layer.9,? ?layer.10,? ?layer.11,? ?layer.12,? ?layer.13,? ?layer.14,? ?layer.15, ...
> min values? : 0.42964514, 0.43375653, 0.51749371, 0.50838983, 0.45366730, 0.53099146, 0.49757186, 0.45697752, 0.41382199, 0.46082401, 0.45516687, 0.51857087, 0.41005131, 0.45956529, 0.47497867, ...
> max values? :? ?96.30350,? 104.08584,? ?88.92751,? ?97.49373,? ?89.57201,? ?90.58570,? ?86.67651,? ?88.33519,? ?96.94720,? 101.58247,? ?96.07792,? ?93.21948,? ?99.59785,? ?94.26218,? ?90.62138, ...
>
>
> And this is how I would like to create my global raster map. However, I am not sure how to plot only one value (i.e. the median value, which occurs at Year 61) for each grid cell. This is what I have so far, but all that this does is plot 138 mini plots, and I just want one plot showing the median values (i.e. Year 61):
>
>
> mapTheme<-rasterTheme(region=rev(brewer.pal(10,"Spectral")))
> cutpoints<-c(200,175,150,125,100,75,50,25,0)
> levelplot(RCP1pctCO2median,margin=F,at=cutpoints,cuts=11,pretty=TRUE,par.settings=mapTheme, main="Median values")
>
>
>
> Any help would be greatly appreciated!
> I look forward to your response!
>  ? ? ? ? [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From tom@heng| @end|ng |rom gm@||@com  Tue Oct 29 17:56:21 2019
From: tom@heng| @end|ng |rom gm@||@com (Tomislav Hengl)
Date: Tue, 29 Oct 2019 17:56:21 +0100
Subject: [R-sig-Geo] Installation of proj4 v6 on Ubuntu 18.04 Error:
 proj/epsg not found
In-Reply-To: <3330120b-3bb7-d2bf-9f54-199186107dd7@uni-muenster.de>
References: <931a8bbc-25ca-7304-2333-633df2e4f952@gmail.com>
 <c5795af9-5eff-6379-ece6-f2f2f163c08f@uni-muenster.de>
 <7643fb84-0b59-340f-a63a-7edb5b99a2d6@gmail.com>
 <3330120b-3bb7-d2bf-9f54-199186107dd7@uni-muenster.de>
Message-ID: <aa437aa3-008f-dfaf-7723-310ed93dcf76@gmail.com>


I get:

$ pkg-config proj --libs
-lproj

$ pkg-config proj --cflags

*empty output


On 10/29/19 2:01 PM, Edzer Pebesma wrote:
> Would you mind giving the ouptut of:
> 
> pkg-config proj --libs
> pkg-config proj --cflags
> 
> and also try:
> 
> install.packages("rgdal", repos="http://R-Forge.R-project.org")
> 
> On 10/29/19 7:11 AM, Tomislav Hengl wrote:
>>
>> Thanks Edzer,
>>
>> I removed my gdal (which removes also all QGIS and everything connect
>> unfortunately) then I followed your steps and I get (somehow the proj
>> version is still 5 and not 6):
>>
>>> install.packages("rgdal")
>>  ? % Total??? % Received % Xferd? Average Speed?? Time??? Time???? Time
>> Current
>>  ???????????????????????????????? Dload? Upload?? Total?? Spent??? Left
>> Speed
>> 100 1631k? 100 1631k??? 0???? 0?? 713k????? 0? 0:00:02? 0:00:02 --:--:--
>>  ?713k
>> * installing *source* package ?rgdal? ...
>> ** package ?rgdal? successfully unpacked and MD5 sums checked
>> checking for g++... g++
>> checking whether the C++ compiler works... yes
>> checking for C++ compiler default output file name... a.out
>> checking for suffix of executables...
>> checking whether we are cross compiling... no
>> checking for suffix of object files... o
>> checking whether we are using the GNU C++ compiler... yes
>> checking whether g++ accepts -g... yes
>> configure: CC: gcc -std=gnu99
>> configure: CXX: g++
>> configure: rgdal: 1.3-3
>> checking for /usr/bin/svnversion... yes
>> configure: svn revision: 759
>> checking whether g++ supports C++11 features by default... yes
>> configure: C++11 support available
>> checking for gdal-config... /usr/bin/gdal-config
>> checking gdal-config usability... yes
>> configure: GDAL: 2.4.2
>> checking C++11 support for GDAL >= 2.3.0... yes
>> checking GDAL version >= 1.11.4... yes
>> checking gdal: linking with --libs only... yes
>> checking GDAL: /usr/share/gdal/pcs.csv readable... yes
>> configure: pkg-config proj exists, will use it
>> configure: PROJ version: 5.2.0
>> checking proj_api.h presence and usability... no
>> configure: error: proj_api.h not found in standard or given locations.
>> ERROR: configuration failed for package ?rgdal?
>> * removing ?/opt/microsoft/ropen/3.5.1/lib64/R/library/rgdal?
>> * restoring previous ?/opt/microsoft/ropen/3.5.1/lib64/R/library/rgdal?
>>
>> The downloaded source packages are in
>>  ?????/data/RTMP/Rtmpl5wj21/downloaded_packages?
>> Updating HTML index of packages in '.Library'
>> Making 'packages.html' ... done
>> Warning message:
>> In install.packages("rgdal") :
>>  ? installation of package ?rgdal? had non-zero exit status
>>
>> what am I doing wrong?
>>
>>
>> On 10/28/19 10:36 PM, Edzer Pebesma wrote:
>>> Hi Tom,
>>>
>>> formerly PROJ.4 is now called PROJ.
>>>
>>> Have you also tried the usual ubuntu install suggestions we give to
>>> R/ubuntu users, e.g. on https://github.com/r-spatial/sf ?
>>>
>>> They are:
>>>
>>> sudo add-apt-repository ppa:ubuntugis/ubuntugis-unstable
>>> sudo apt-get update
>>> sudo apt-get install libudunits2-dev libgdal-dev libgeos-dev libproj-dev
>>>
>>> On 10/28/19 4:34 PM, Tomislav Hengl wrote:
>>>>
>>>> Dear R-sig-geo,
>>>>
>>>> I am trying to install proj4 v6 on Ubuntu 18.04 bionic. I though I can
>>>> install it simply by following the ubuntugis steps
>>>> (https://mothergeo-py.readthedocs.io/en/latest/development/how-to/gdal-ubuntu-pkg.html)
>>>>
>>>> but this does not lead to newest version of proj4 v6.
>>>>
>>>> Then I have tried to follow the proj6 steps
>>>> (https://proj.org/install.html#install) which indicate that I should do
>>>> it via the Anaconda installer. After I installed proj4 v6 from conda
>>>> I get:
>>>>
>>>> $ which proj
>>>> /home/tomislav/anaconda2/bin/proj
>>>>
>>>> $? proj -V
>>>> Rel. 6.2.0, September 1st, 2019
>>>> <proj>:
>>>> projection initialization failure
>>>> cause: no arguments in initialization list
>>>> program abnormally terminated
>>>>
>>>> After that I've added the 'PROJ_LIB = /home/tomislav/anaconda2/bin/proj
>>>> ' to my .Renviron file and then I get:
>>>>
>>>> install.packages("rgdal")
>>>> Installing package into
>>>> ?/home/tomislav/R/x86_64-pc-linux-gnu-library/3.5?
>>>> (as ?lib? is unspecified)
>>>> ...
>>>> checking PROJ.4: epsg found and readable... no
>>>> Error: proj/epsg not found
>>>> Either install missing proj support files, for example
>>>> the proj-nad and proj-epsg RPMs on systems using RPMs,
>>>> or if installed but not autodetected, set PROJ_LIB to the
>>>> correct path, and if need be use the --with-proj-share=
>>>> configure argument.
>>>> ERROR: configuration failed for package ?rgdal?
>>>> * removing ?/home/tomislav/R/x86_64-pc-linux-gnu-library/3.5/rgdal?
>>>> Warning in install.packages :
>>>>  ?? installation of package ?rgdal? had non-zero exit status
>>>>
>>>> $gdalinfo --version
>>>> GDAL 2.4.0, released 2018/12/14
>>>>
>>>> What am I doing wrong? Which tutorial / documentation do you advise to
>>>> install proj4 v6 and rgdal package on Ubuntu?
>>>>
>>>> thank you (especially you Roger!),
>>>>
>>>> T. Hengl
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>


From eg@mp@du @end|ng |rom gm@||@com  Tue Oct 29 18:17:45 2019
From: eg@mp@du @end|ng |rom gm@||@com (Enoch Gyamfi Ampadu)
Date: Tue, 29 Oct 2019 19:17:45 +0200
Subject: [R-sig-Geo] Variable importance bar plot
In-Reply-To: <CAM_vju=EXqeFoOM4PTZ6k_L4RreL9gnM1Uaomtxko525=Tmr-g@mail.gmail.com>
References: <CAC4+n+wrH6kinnT+aTRH_+oOFKw6uy7R7Oey=mzESPHZ8e8XJg@mail.gmail.com>
 <CAM_vju=EXqeFoOM4PTZ6k_L4RreL9gnM1Uaomtxko525=Tmr-g@mail.gmail.com>
Message-ID: <CAC4+n+wmK3ssgCmJii0KmCwYMWW=OgtbrzdcB7jHS2R26vyuqA@mail.gmail.com>

Hi Sarah,

Thank you for getting in touch and providing a suggestion.  I have checked
but that is not what want actually.

 I want to have a vertical bar plot depicting how each variable contrite to
predicting the class. I used 8 bands of landsat image. So let's say if one
of the  land cover class to be Built up, I want to have bar plots in
ranking order of the bands to enable me compare their importance in
predicting the land cover class. I don't know if this explains what I want
better.

Thank you.

Best regards,

Enoch

Enoch Gyamfi - Ampadu

email: egampadu at gmail.com
skype: enoch.ampadu

The highest sense of nobility is self control.

A simple act of kindness creates endless ripple


On Tue, 29 Oct 2019, 16:51 Sarah Goslee, <sarah.goslee at gmail.com> wrote:

> It's not entirely clear to me how you expect the values to be
> calculated, but you might look at partial dependence plots, for
> example as implemented in the pdp package.
>
> Sarah
>
> On Sun, Oct 27, 2019 at 6:00 AM Enoch Gyamfi Ampadu <egampadu at gmail.com>
> wrote:
> >
> > Dear List,
> >
> > I hope this finds you well. Please I have done a Land cover
> classification
> > using randomForest. I used selected satellite image bands as input
> > variables. I have four thematic classes. I obtained the general variable
> > importance using *varImpPlot (my model) . *Now I want to have bar chart
> > plot showing each thematic class and the variable importance for each
> > class. That is, how each band is ranked in predicting a thematic class. I
> > tried using this function:
> >
> > *importance = varImp(my model, scale= TRUE)*
> >
> > *plot (importance. *
> >
> > However it did not work. I tried to put in *geom= "bar*". And I had
> error.
> >
> > Please I will be glad to get some assistance.
> >
> > Thank you.
> >
> > Best regards,
> >
> > Enoch
> >
>
>
> --
> Sarah Goslee (she/her)
> http://www.numberwright.com
>

	[[alternative HTML version deleted]]


From r@i@1290 m@iii@g oii @im@com  Tue Oct 29 19:37:07 2019
From: r@i@1290 m@iii@g oii @im@com (r@i@1290 m@iii@g oii @im@com)
Date: Tue, 29 Oct 2019 18:37:07 +0000 (UTC)
Subject: [R-sig-Geo] Plotting median values globally
In-Reply-To: <06ebf78e-8e6b-7b49-f426-0d435055e260@gmail.com>
References: <449745220.2686965.1572322599506.ref@mail.yahoo.com>
 <449745220.2686965.1572322599506@mail.yahoo.com>
 <CAKkiGbtEV+5FbvCyChKPqTBsRp3eOO4N0U0Q-zA3oKbeTG-i+Q@mail.gmail.com>
 <57320868.2959568.1572367120127@mail.yahoo.com>
 <06ebf78e-8e6b-7b49-f426-0d435055e260@gmail.com>
Message-ID: <170361745.3109064.1572374227766@mail.yahoo.com>

Hi Akos and everyone,?

Thank you so much, as well! Yes, this worked very well - I cannot believe it was just a bracket that was misplaced that caused that!
Many thanks, once again, for your help - it was extremely valuable and, thus, much appreciated!

-----Original Message-----
From: Bede-Fazekas ?kos <bfalevlist at gmail.com>
To: r-sig-geo <r-sig-geo at r-project.org>
Sent: Tue, Oct 29, 2019 12:58 pm
Subject: Re: [R-sig-Geo] Plotting median values globally

Hello,
It is because the wrong place of the closing bracket. This might work, 
since margin, at, cuts etc. are the parameters of levelplot(9 not raster():
levelplot(raster(RCP1pctCO2Median,61), 
margin=F,at=cutpoints,cuts=11,pretty=TRUE,par.settings=mapTheme, 
main="Median values")
HTH,
?kos

2019.10.29. 17:38 keltez?ssel, rain1290--- via R-sig-Geo ?rta:
> Hi Vijay and others,
> Thank you so, so much for this reply!! Yes, this worked, just as you suggested. Just one little detail that I wanted to know - I was trying to change the color range of my plot, like this:
> mapTheme<-rasterTheme(region=rev(brewer.pal(10,"Spectral")))
> cutpoints<-c(200,175,150,125,100,75,50,25,0)
>> levelplot(raster(RCP1pctCO2Median,61, margin=F,at=cutpoints,cuts=11,pretty=TRUE,par.settings=mapTheme, main="Median values"))
>
>
>
> But I receive this error:
> Error in .local(x, ...) :
>? ? unused arguments (margin = F, at = cutpoints, cuts = 11, pretty = TRUE, par.settings = mapTheme, main = "Median values")
> What could be the reason behind this error?
> Thank you, once again!!
> ~Trav.~
> -----Original Message-----
> From: Vijay Lulla <vijaylulla at gmail.com>
> To: rain1290 <rain1290 at aim.com>
> Cc: R-sig-geo Mailing List <r-sig-geo at r-project.org>
> Sent: Tue, Oct 29, 2019 9:02 am
> Subject: Re: [R-sig-Geo] Plotting median values globally
>
> Did you try `levelplot(raster(RCP1pctCO2median, 61))`?
>
> On Tue, Oct 29, 2019 at 12:17 AM rain1290--- via R-sig-Geo <r-sig-geo at r-project.org> wrote:
>
> Hi there,
> I am trying to create a global plot with median precipitation values. What I would like to do is isolate the "median" values and plot those values on a global raster map. I already first created a raster stack, called "RCP1pctCO2median", which contains the median values to be plotted. However, what I would like to do is simply plot only those values at Year 61 for each grid cell. There are 138 layers, with each layer representing one year. The idea would be to plot only those values for Year/layer 61 globally (i,e, for each grid cell), but I am unsure how to isolate that specific year/layer?
> "RCP1pctCO2median"? has the following attributes:
>
> class? ? ? ?: RasterStack
> dimensions? : 64, 128, 8192, 138? (nrow, ncol, ncell, nlayers)
> resolution? : 2.8125, 2.789327? (x, y)
> extent? ? ? : -181.4062, 178.5938, -89.25846, 89.25846? (xmin, xmax, ymin, ymax)
> coord. ref. : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0
> names? ? ? ?:? ? layer.1,? ? layer.2,? ? layer.3,? ? layer.4,? ? layer.5,? ? layer.6,? ? layer.7,? ? layer.8,? ? layer.9,? ?layer.10,? ?layer.11,? ?layer.12,? ?layer.13,? ?layer.14,? ?layer.15, ...
> min values? : 0.42964514, 0.43375653, 0.51749371, 0.50838983, 0.45366730, 0.53099146, 0.49757186, 0.45697752, 0.41382199, 0.46082401, 0.45516687, 0.51857087, 0.41005131, 0.45956529, 0.47497867, ...
> max values? :? ?96.30350,? 104.08584,? ?88.92751,? ?97.49373,? ?89.57201,? ?90.58570,? ?86.67651,? ?88.33519,? ?96.94720,? 101.58247,? ?96.07792,? ?93.21948,? ?99.59785,? ?94.26218,? ?90.62138, ...
>
>
> And this is how I would like to create my global raster map. However, I am not sure how to plot only one value (i.e. the median value, which occurs at Year 61) for each grid cell. This is what I have so far, but all that this does is plot 138 mini plots, and I just want one plot showing the median values (i.e. Year 61):
>
>
> mapTheme<-rasterTheme(region=rev(brewer.pal(10,"Spectral")))
> cutpoints<-c(200,175,150,125,100,75,50,25,0)
> levelplot(RCP1pctCO2median,margin=F,at=cutpoints,cuts=11,pretty=TRUE,par.settings=mapTheme, main="Median values")
>
>
>
> Any help would be greatly appreciated!
> I look forward to your response!
>? ? ? ? ? [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>
>
> ??? [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

	[[alternative HTML version deleted]]


From Roger@B|v@nd @end|ng |rom nhh@no  Tue Oct 29 19:54:47 2019
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Tue, 29 Oct 2019 19:54:47 +0100
Subject: [R-sig-Geo] Segmentation fault
In-Reply-To: <CANK5cGzYWitV+YiRMPa=6NM6cGuPehLNYYTo6oU7YykfGwduKQ@mail.gmail.com>
References: <CANK5cGw44peBT+2nj=pGgDHm4p8pUUvD3kHL+GdhvY1xJL+m4w@mail.gmail.com>
 <alpine.LFD.2.21.1910290951220.15781@reclus.nhh.no>
 <CANK5cGyFbiLfnTKCdw6NrLnz9Mg1sYfBEdDieKAOcgm8ZvV-HQ@mail.gmail.com>
 <alpine.LFD.2.21.1910291318410.15781@reclus.nhh.no>
 <CANK5cGzYWitV+YiRMPa=6NM6cGuPehLNYYTo6oU7YykfGwduKQ@mail.gmail.com>
Message-ID: <alpine.LFD.2.21.1910291953550.333@reclus.nhh.no>

On Tue, 29 Oct 2019, Eduardo Diez wrote:

> The OS was part of my initial post:
>
>> sessionInfo()
> R version 3.6.1 (2019-07-05)
> Platform: x86_64-pc-linux-gnu (64-bit)
> Running under: Ubuntu 18.04.3 LTS
>
>
> But nevermind, I'll stop posting here.

Please do raise the issue; it's the proper place for installation problems 
like this.

Roger

> Thanks
>
> El mar., 29 oct. 2019 09:21, Roger Bivand <Roger.Bivand at nhh.no> escribi?:
>
>> On Tue, 29 Oct 2019, Eduardo Diez wrote:
>>
>>> Roger,
>>> Yes sorry about the confusion. Domino is a company (dominodatalab.com)
>> that
>>> offers a an environment for data science. It's based on docker images. On
>>> one of those images I installed sf and lwgeom. What information should I
>>> get from the image that helps identify the source of the problem?
>>
>> What OS is the docker image running; where do they get the image? Please
>> do raise this as an issue, this is not the best channel for this, and
>> nobody else uses this image I guess. The problem is most likely that the
>> image does not have the necessary underlying external requirements set up
>> correctly.
>>
>> Roger
>>
>>>
>>> Thanks,
>>> Best
>>>
>>> El mar., 29 oct. 2019 05:54, Roger Bivand <Roger.Bivand at nhh.no>
>> escribi?:
>>>
>>>> On Mon, 28 Oct 2019, Eduardo Diez wrote:
>>>>
>>>>> Hi everyone.
>>>>> I'm having problems running spatial processes in a domino machine. I
>>>>
>>>> Please raise an issue on https://github.com/r-spatial/sf/issues, giving
>>>> much more detail about your installation (domino is unknown to everybody
>>>> but yourself, duckduckgo says: "Domino Machine manufactures blow out
>>>> preventers, stuffing boxes, and API products"). Likely cause - failed
>>>> installation of lwgeom, or multiple installs of external software. Avoid
>>>> posting HTML.
>>>>
>>>> Roger
>>>>
>>>>> created a new environment with updated spatial packages but I'm unable
>> to
>>>>> run simple tasks. Below an example and some information:
>>>>>
>>>>>> library(sf)Linking to GEOS 3.6.2, GDAL 2.4.2, PROJ 4.9.3>
>> sessionInfo()
>>>>> R version 3.6.1 (2019-07-05)
>>>>> Platform: x86_64-pc-linux-gnu (64-bit)
>>>>> Running under: Ubuntu 18.04.3 LTS
>>>>>
>>>>> Matrix products: default
>>>>> BLAS:   /usr/lib/x86_64-linux-gnu/atlas/libblas.so.3.10.3
>>>>> LAPACK: /usr/lib/x86_64-linux-gnu/atlas/liblapack.so.3.10.3
>>>>>
>>>>> locale:
>>>>> [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>>>>> [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>>>>> [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>>>>> [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
>>>>> [9] LC_ADDRESS=C               LC_TELEPHONE=C
>>>>> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>>>>>
>>>>> attached base packages:
>>>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>>>
>>>>> other attached packages:
>>>>> [1] sf_0.8-0
>>>>>
>>>>> loaded via a namespace (and not attached):
>>>>> [1] compiler_3.6.1     magrittr_1.5       class_7.3-15
>>  tools_3.6.1
>>>>> [5] DBI_1.0.0          units_0.6-5        Rcpp_1.0.2
>>>>  KernSmooth_2.23-16
>>>>> [9] grid_3.6.1         e1071_1.7-2        classInt_0.4-2
>>>>>> sf_extSoftVersion()
>>>>>          GEOS           GDAL         proj.4 GDAL_with_GEOS
>>  USE_PROJ_H
>>>>>       "3.6.2"        "2.4.2"        "4.9.3"         "true"
>> "false"
>>>>>> nc = st_read(system.file("shape/nc.shp", package="sf"))
>>>>> Reading layer `nc' from data source
>>>>> `/usr/local/lib/R/site-library/sf/shape/nc.shp' using driver `ESRI
>>>>> Shapefile'
>>>>> Simple feature collection with 100 features and 14 fields
>>>>> geometry type:  MULTIPOLYGON
>>>>> dimension:      XY
>>>>> bbox:           xmin: -84.32385 ymin: 33.88199 xmax: -75.45698 ymax:
>>>> 36.58965
>>>>> epsg (SRID):    4267
>>>>> proj4string:    +proj=longlat +datum=NAD27 +no_defs
>>>>>> asd <- st_area(nc[1,]) # area from long/lat
>>>>>
>>>>>
>>>>> *** caught segfault ***
>>>>> address (nil), cause 'unknown'
>>>>> Traceback:
>>>>> 1: CPL_crs_parameters(x$proj4string)
>>>>> 2: structure(CPL_crs_parameters(x$proj4string), names =
>>>>> c("SemiMajor",     "SemiMinor", "InvFlattening", "units_gdal",
>>>>> "IsVertical",     "WktPretty", "Wkt"))
>>>>> 3: crs_parameters(crs) 4: st_crs.sfc(st_geometry(x), parameters = TRUE)
>>>>> 5: st_crs(st_geometry(x), parameters = TRUE)
>>>>> 6: lwgeom::st_geod_area(x)
>>>>> 7: st_area.sfc(st_geometry(x, ...))
>>>>> 8: st_area(st_geometry(x, ...))
>>>>> 9: st_area.sf(nc[1, ])
>>>>> 10: st_area(nc[1, ])
>>>>> An irrecoverable exception occurred. R is aborting now ...Segmentation
>>>>> fault (core dumped)
>>>>>
>>>>>
>>>>> Thanks in advance
>>>>>
>>>>> Best,
>>>>>
>>>>> Edu
>>>>>
>>>>>       [[alternative HTML version deleted]]
>>>>>
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>
>>>>
>>>> --
>>>> Roger Bivand
>>>> Department of Economics, Norwegian School of Economics,
>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>>>> https://orcid.org/0000-0003-2392-6140
>>>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>>>>
>>>
>>>       [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>> --
>> Roger Bivand
>> Department of Economics, Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
>> https://orcid.org/0000-0003-2392-6140
>> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From m|ke|@d|@z@rodr|guez @end|ng |rom hotm@||@com  Wed Oct 30 12:55:23 2019
From: m|ke|@d|@z@rodr|guez @end|ng |rom hotm@||@com (=?iso-8859-1?Q?Mikel_D=EDaz_Rodr=EDguez?=)
Date: Wed, 30 Oct 2019 11:55:23 +0000
Subject: [R-sig-Geo] Error in random labelling using the J function
Message-ID: <DB7PR10MB2012C48A2C044840D5B82990D0600@DB7PR10MB2012.EURPRD10.PROD.OUTLOOK.COM>

Hello everyone,

I'm having problems when I run the random labelling using J Function. I'm trying to know if exists spatial co-dependence between two sets of points.  Below I show you the information of my session, the code that I'm using and the error that appears to me.

> sessionInfo()
R version 3.6.1 (2019-07-05)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 18362)

Matrix products: default

locale:
[1] LC_COLLATE=Spanish_Spain.1252  LC_CTYPE=Spanish_Spain.1252
[3] LC_MONETARY=Spanish_Spain.1252 LC_NUMERIC=C
[5] LC_TIME=Spanish_Spain.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
 [1] MASS_7.3-51.4       dismo_1.1-4         rgdal_1.4-4
 [4] raster_2.9-22       maptools_0.9-5      sp_1.3-1
 [7] spatstat_1.61-0     rpart_4.1-15        nlme_3.1-140
[10] spatstat.data_1.4-0

loaded via a namespace (and not attached):
 [1] Rcpp_1.0.1            codetools_0.2-16      lattice_0.20-38
 [4] deldir_0.1-22         grid_3.6.1            tensor_1.5
 [7] goftest_1.1-1         Matrix_1.2-17         spatstat.utils_1.13-0
[10] splines_3.6.1         tools_3.6.1           foreign_0.8-71
[13] polyclip_1.10-0       abind_1.4-5           compiler_3.6.1
[16] mgcv_1.8-28


To establish the relationship between the two sets of points I need to convert the two objects of type ppp to a multitype. What i have done as follows:

studyarea <- readOGR(dsn="studyarea.shp", layer="studyarea")
spts <- readOGR(dsn="sitesv2.shp", layer="sitesv2")
spts1 <- readOGR(dsn="cen_cla.shp", layer="cen_cla")
sta <- as(studyarea,"owin")
p1 <- ppp(x=spts$utmx, y=spts$utmy, window=sta)
p2 <- ppp(x=spts1$utmx, y=spts1$utmy, window=sta)
pm = ppp(c(p1$x, p2$x),c(p1$y,p2$y), window=sta,
         marks=factor(c(rep("A",p1$n),rep("B",p2$n))))

is.multitype(pm)
plot(pm)


Subsequently I have used the following code to check if there is a spatial co-dependence between i (A) and j (B). Or what is the same, between sitesv2 and cen_cla.

Jdif <- function(X, ..., i) {
  Jidot <- Jdot(X, ..., i = i)
  J <- Jest(X, ...)
  dif <- eval.fv(Jidot - J)
  return(dif)
}
E <- envelope(pm, Jdif, nsim = 39, i = "A", j = "B", simulate = expression(rlabel(pm)))


But when I execute E, it shows me the following error:

 Error: in Fest(X, r) the successive r values must be finely spaced: given spacing = 0.010203; required spacing <=  0.00592


And I don't know how I can solve it... At first I thought that the problem could be in the existence of duplicate points, but I eliminated those points and the error continues to appear. I have also updated the Spatstat package to the latest version (1.61-0) but the problem has not been solved either. Therefore I write to you in case anyone knows where the problem may be and how I can solve it.

Thank you so much.


M. D?az



[https://ipmcdn.avast.com/images/icons/icon-envelope-tick-round-orange-animated-no-repeat-v1.gif]<https://www.avast.com/sig-email?utm_medium=email&utm_source=link&utm_campaign=sig-email&utm_content=webmail>  Libre de virus. www.avast.com<https://www.avast.com/sig-email?utm_medium=email&utm_source=link&utm_campaign=sig-email&utm_content=webmail>

	[[alternative HTML version deleted]]


From |et|c|@c@nton @end|ng |rom hotm@||@com  Thu Oct 31 21:52:00 2019
From: |et|c|@c@nton @end|ng |rom hotm@||@com (=?iso-8859-1?Q?Let=EDcia_Dal=27_Canton?=)
Date: Thu, 31 Oct 2019 20:52:00 +0000
Subject: [R-sig-Geo] About dnearneight and nb2listw function
Message-ID: <SC1PR80MB374301E9C0061DEADC7FAEC5A9630@SC1PR80MB3743.lamprd80.prod.outlook.com>

In my Ph.D. I am comparing Lee and Anselin's methodology for estimating bivariate spatial autocorrelation. Lee's methodology led me to the spdep package. My questions are as follows:

1) The weight matrix W, which is part of the  "nb2listw" function. First, is it possible to view all elements of this matrix? Because I could only visualize the elements whose autocorrelation is not null. That would be enough, but I need to present this matrix and visualize the autocorrelation between all points. That is, knowing what are the coordinates of the points where the autocorrelation is nonzero and also where it is null.

2) In the "dnearneight" function, is it possible to view the matrix of neighbors? Because getting this matrix, would be able to standardize and get the matrix of weights W without using the nb2list function.

Thankfully,

Let?cia Dal' Canton.

Matem?tica.
Mestre em Engenharia Agr?cola.
Doutoranda em Engenharia Agr?cola com linha de pesquisa em Estat?stica Espacial.
Universidade Estadual do Oeste do Paran? - UNIOESTE.

Curr?culo Lattes: http://lattes.cnpq.br/1085422685501012.
Contato: (45) 9 9962-7492.

	[[alternative HTML version deleted]]


