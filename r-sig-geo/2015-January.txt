From katakagi at bu.edu  Thu Jan  1 19:25:40 2015
From: katakagi at bu.edu (Ken)
Date: Fri, 02 Jan 2015 01:25:40 +0700
Subject: [R-sig-Geo] spTransform error: Error in CRS("+init=EPSG:26920") :
 no system list, errno: 2
Message-ID: <54A59124.5090501@bu.edu>

Hi,
I'm trying to use the CRS() function with spTransform() in the "sp" and 
"rgdal" package to reproject some spatial data using Rstudio in Ubuntu 
14.10:

library(sp)
library(rgdal)
somePolygons <- readOGR(file.path(fp), "someShapefile")
somePolygons_reproj <- spTransform(somePolygons, CRS("+init=EPSG:26920"))

the function readOGR() works fine, but I get the following error when I 
try and run spTransform():
Error in spTransform(WBDHU12, CRS("+init=EPSG:4269")) :
error in evaluating the argument 'CRSobj' in selecting a method for 
function 'spTransform': Error in CRS("+init=EPSG:4269") : no system 
list, errno: 2

It may be that rgdal can't locate the epsg file (in usr/share/proj?)  
I've removed and re-installed rgdal, which seems to install fine.  here 
is the output:

* installing *source* package ?rgdal? ...
** package ?rgdal? successfully unpacked and MD5 sums checked
configure: CC: gcc -std=gnu99
configure: CXX: g++
configure: rgdal: 0.9-1
checking for /usr/bin/svnversion... no
configure: svn revision: 518
configure: gdal-config: gdal-config
checking gdal-config usability... yes
configure: GDAL: 1.10.1
checking GDAL version >= 1.6.3... yes
checking GDAL version < 2... yes
checking for gcc... gcc -std=gnu99
checking whether the C compiler works... yes
checking for C compiler default output file name... a.out
checking for suffix of executables...
checking whether we are cross compiling... no
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether gcc -std=gnu99 accepts -g... yes
checking for gcc -std=gnu99 option to accept ISO C89... none needed
checking how to run the C preprocessor... gcc -std=gnu99 -E
checking for grep that handles long lines and -e... /bin/grep
checking for egrep... /bin/grep -E
checking for ANSI C header files... yes
checking for sys/types.h... yes
checking for sys/stat.h... yes
checking for stdlib.h... yes
checking for string.h... yes
checking for memory.h... yes
checking for strings.h... yes
checking for inttypes.h... yes
checking for stdint.h... yes
checking for unistd.h... yes
checking gdal.h usability... yes
checking gdal.h presence... yes
checking for gdal.h... yes
checking gdal: linking with --libs only... yes
checking GDAL: /usr/share/gdal/1.10/pcs.csv readable... yes
checking proj_api.h usability... yes
checking proj_api.h presence... yes
checking for proj_api.h... yes
checking for pj_init_plus in -lproj... yes
configure: PROJ.4 version: 4.8.0
checking PROJ.4: epsg found and readable... yes
checking PROJ.4: conus found and readable... yes
configure: Package CPP flags:  -I/usr/include/gdal
configure: Package LIBS:  -L/usr/lib -lgdal -lproj
configure: creating ./config.status
config.status: creating src/Makevars
** libs
g++ -I/usr/share/R/include -DNDEBUG -I/usr/include/gdal 
-I"/home/ken/R/x86_64-pc-linux-gnu-library/3.1/sp/include"   -fpic -g 
-O2 -fstack-protector --param=ssp-buffer-size=4 -Wformat 
-Werror=format-security -D_FORTIFY_SOURCE=2 -g  -c OGR_write.cpp -o 
OGR_write.o
g++ -I/usr/share/R/include -DNDEBUG -I/usr/include/gdal 
-I"/home/ken/R/x86_64-pc-linux-gnu-library/3.1/sp/include"   -fpic -g 
-O2 -fstack-protector --param=ssp-buffer-size=4 -Wformat 
-Werror=format-security -D_FORTIFY_SOURCE=2 -g  -c gdal-bindings.cpp -o 
gdal-bindings.o
gcc -std=gnu99 -I/usr/share/R/include -DNDEBUG -I/usr/include/gdal 
-I"/home/ken/R/x86_64-pc-linux-gnu-library/3.1/sp/include"   -fpic -g 
-O2 -fstack-protector --param=ssp-buffer-size=4 -Wformat 
-Werror=format-security -D_FORTIFY_SOURCE=2 -g  -c init.c -o init.o
gcc -std=gnu99 -I/usr/share/R/include -DNDEBUG -I/usr/include/gdal 
-I"/home/ken/R/x86_64-pc-linux-gnu-library/3.1/sp/include"   -fpic -g 
-O2 -fstack-protector --param=ssp-buffer-size=4 -Wformat 
-Werror=format-security -D_FORTIFY_SOURCE=2 -g  -c local_stubs.c -o 
local_stubs.o
g++ -I/usr/share/R/include -DNDEBUG -I/usr/include/gdal 
-I"/home/ken/R/x86_64-pc-linux-gnu-library/3.1/sp/include"   -fpic -g 
-O2 -fstack-protector --param=ssp-buffer-size=4 -Wformat 
-Werror=format-security -D_FORTIFY_SOURCE=2 -g  -c ogr_geom.cpp -o 
ogr_geom.o
gcc -std=gnu99 -I/usr/share/R/include -DNDEBUG -I/usr/include/gdal 
-I"/home/ken/R/x86_64-pc-linux-gnu-library/3.1/sp/include"   -fpic -g 
-O2 -fstack-protector --param=ssp-buffer-size=4 -Wformat 
-Werror=format-security -D_FORTIFY_SOURCE=2 -g  -c ogr_polygons.c -o 
ogr_polygons.o
g++ -I/usr/share/R/include -DNDEBUG -I/usr/include/gdal 
-I"/home/ken/R/x86_64-pc-linux-gnu-library/3.1/sp/include"   -fpic -g 
-O2 -fstack-protector --param=ssp-buffer-size=4 -Wformat 
-Werror=format-security -D_FORTIFY_SOURCE=2 -g  -c ogr_proj.cpp -o 
ogr_proj.o
g++ -I/usr/share/R/include -DNDEBUG -I/usr/include/gdal 
-I"/home/ken/R/x86_64-pc-linux-gnu-library/3.1/sp/include"   -fpic -g 
-O2 -fstack-protector --param=ssp-buffer-size=4 -Wformat 
-Werror=format-security -D_FORTIFY_SOURCE=2 -g  -c ogrdrivers.cpp -o 
ogrdrivers.o
g++ -I/usr/share/R/include -DNDEBUG -I/usr/include/gdal 
-I"/home/ken/R/x86_64-pc-linux-gnu-library/3.1/sp/include"   -fpic -g 
-O2 -fstack-protector --param=ssp-buffer-size=4 -Wformat 
-Werror=format-security -D_FORTIFY_SOURCE=2 -g  -c ogrsource.cpp -o 
ogrsource.o
g++ -I/usr/share/R/include -DNDEBUG -I/usr/include/gdal 
-I"/home/ken/R/x86_64-pc-linux-gnu-library/3.1/sp/include"   -fpic -g 
-O2 -fstack-protector --param=ssp-buffer-size=4 -Wformat 
-Werror=format-security -D_FORTIFY_SOURCE=2 -g  -c projectit.cpp -o 
projectit.o
g++ -shared -L/usr/lib/R/lib -Wl,-Bsymbolic-functions -Wl,-z,relro -o 
rgdal.so OGR_write.o gdal-bindings.o init.o local_stubs.o ogr_geom.o 
ogr_polygons.o ogr_proj.o ogrdrivers.o ogrsource.o projectit.o 
-L/usr/lib -lgdal -lproj -L/usr/lib/R/lib -lR


Based on this output, rgdal seems to find the epsg ("checking PROJ.4: 
epsg found and readable... yes") so I'm not sure what might be causing 
this error.  Any help?  Thanks!


From katakagi at bu.edu  Thu Jan  1 20:55:54 2015
From: katakagi at bu.edu (Ken)
Date: Thu, 1 Jan 2015 19:55:54 +0000
Subject: [R-sig-Geo] spTransform error: Error in CRS(
References: <54A59124.5090501@bu.edu>
Message-ID: <loom.20150101T205414-735@post.gmane.org>

Ken <katakagi <at> bu.edu> writes:

> 
> Hi,
> I'm trying to use the CRS() function with spTransform() in the "sp" and 
> "rgdal" package to reproject some spatial data using Rstudio in Ubuntu 
> 14.10:
> 
> library(sp)
> library(rgdal)
> somePolygons <- readOGR(file.path(fp), "someShapefile")
> somePolygons_reproj <- spTransform(somePolygons, CRS("+init=EPSG:26920"))
> 
> the function readOGR() works fine, but I get the following error when I 
> try and run spTransform():
> Error in spTransform(WBDHU12, CRS("+init=EPSG:4269")) :
> error in evaluating the argument 'CRSobj' in selecting a method for 
> function 'spTransform': Error in CRS("+init=EPSG:4269") : no system 
> list, errno: 2
> 


Just realized that capitalizing "EPSG" was the reason that I was getting 
the error:

somePolygons_reproj <- spTransform(somePolygons, CRS("+init=epsg:26920")) 

works fine.


From flaxman at gmail.com  Mon Jan  5 01:22:29 2015
From: flaxman at gmail.com (Seth Flaxman)
Date: Sun, 4 Jan 2015 19:22:29 -0500
Subject: [R-sig-Geo] anyone have the Pacific wind dataset from Cressie and
	Huang [1999]?
Message-ID: <CAPGk9peh29TcRK=VNh717TDMZ3vtFHs0TT+_jr7GmV02DxbC7w@mail.gmail.com>

Hi list.

Does anyone know of a package or other source for the Pacific wind speed
dataset (17x17 sites, every 6 hours, 1992-1993) considered in Cressie and
Huang (1999) and in a few follow-up papers?

http://www.jstor.org/discover/10.2307/2669946?sid=21105561841903&uid=3739256&uid=2&uid=3739808&uid=4

Thanks,
Seth

	[[alternative HTML version deleted]]


From ariel.fuentesdi at usach.cl  Mon Jan  5 04:48:02 2015
From: ariel.fuentesdi at usach.cl (Ariel Fuentesdi)
Date: Mon, 5 Jan 2015 00:48:02 -0300
Subject: [R-sig-Geo] Export subsets of Spatial Points Data Frame to images
Message-ID: <CAD0a9Ki9cx2y944H8MExytE8WkyxCThtrL77Ngc_roGKEY5uCg@mail.gmail.com>

I have a csv file, which I converted it to Spatial Points Data Frame. And I
want to split the spatial data and export each map to a jpg file.


I did the following:

    SB <- read.csv("SB_040914.csv", header=TRUE, sep = ";")
    SB <- SB %>% group_by(Fecha, CodPar, x, y) %>%
summarise(mean(Sube),mean(Evade), mean(Baja))
    SB <- data.frame(SB)
    SB <- SB[complete.cases(SB),]

    coordinates(SB) <- ~ x + y
    proj4string(obj = SB) <- CRS("+init=epsg:32719")

    SB <- split(SB, f = SB$Fecha)

The Split function, shows me the next warnings:

**Warning messages:
1: In min(x) : no non-missing arguments to min; returning Inf
2: In max(x) : no non-missing arguments to max; returning -Inf
3: In min(x) : no non-missing arguments to min; returning Inf
4: In max(x) : no non-missing arguments to max; returning -Inf**

And for trying to export I did this:

    for (i in SB) {
      jpeg(paste(SB[[1]],".jpg",sep=""))
      bubble(SB[[i]], "mean.Evade.", col=c("#00ff0088", "#00ff0088"),
             main = "Evasi?n" )
      dev.off()
    }

**Which shows me the next error:
Error in as.character.default(<S4 object of class
"SpatialPointsDataFrame">) :
  no method for coercing this S4 class to a vector
6 as.character.default(<S4 object of class
structure("SpatialPointsDataFrame", package = "sp")>)
5 as.character(<S4 object of class structure("SpatialPointsDataFrame",
package = "sp")>)
4 paste(SB[[1]], ".jpg", sep = "")
3 gsub("%%", "", s)
2 checkIntFormat(filename)
1 jpeg(paste(SB[[1]], ".jpg", sep = ""))**

	[[alternative HTML version deleted]]


From frtog at vestas.com  Mon Jan  5 08:22:02 2015
From: frtog at vestas.com (=?utf-8?B?RnJlZGUgQWFrbWFubiBUw7hnZXJzZW4=?=)
Date: Mon, 5 Jan 2015 08:22:02 +0100
Subject: [R-sig-Geo] Export subsets of Spatial Points Data Frame to
 images
In-Reply-To: <CAD0a9Ki9cx2y944H8MExytE8WkyxCThtrL77Ngc_roGKEY5uCg@mail.gmail.com>
References: <CAD0a9Ki9cx2y944H8MExytE8WkyxCThtrL77Ngc_roGKEY5uCg@mail.gmail.com>
Message-ID: <B078CDF40DFE4045AF172A8B4F68FC4857CAAC91CB@DKRDSEXC016.vestas.net>

Hi Ariel

Please provide a reproducible example. Now I have to guess what the SB object is because you didn't provide any details about that.

I guess that the group_by() and summarise() are from the dplyr package. 

I guess that when you have imported the csv file you have an object SB containing columns Fecha, CodPar, x, and y.

If so, your calls to the two dplyr functions are not correct. As first argument they need a data object, which is supposed to be of a tbl type like e.g. data frame.

Why didn't you get an error when issuing e.g. group_by(Fecha, CodPar, x, y) instead of group_by(SB, Fecha, CodPar, x, y)?

Yours sincerely / Med venlig hilsen


Frede Aakmann T?gersen
Specialist, M.Sc., Ph.D.
Plant Performance & Modeling

Technology & Service Solutions
T +45 9730 5135
M +45 2547 6050
frtog at vestas.com
http://www.vestas.com

Company reg. name: Vestas Wind Systems A/S
This e-mail is subject to our e-mail disclaimer statement.
Please refer to www.vestas.com/legal/notice
If you have received this e-mail in error please contact the sender. 

> -----Original Message-----
> From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Ariel
> Fuentesdi
> Sent: 5. januar 2015 04:48
> To: r-sig-geo at r-project.org
> Subject: [R-sig-Geo] Export subsets of Spatial Points Data Frame to images
> 
> I have a csv file, which I converted it to Spatial Points Data Frame. And I
> want to split the spatial data and export each map to a jpg file.
> 
> 
> I did the following:
> 
>     SB <- read.csv("SB_040914.csv", header=TRUE, sep = ";")
>     SB <- SB %>% group_by(Fecha, CodPar, x, y) %>%
> summarise(mean(Sube),mean(Evade), mean(Baja))
>     SB <- data.frame(SB)
>     SB <- SB[complete.cases(SB),]
> 
>     coordinates(SB) <- ~ x + y
>     proj4string(obj = SB) <- CRS("+init=epsg:32719")
> 
>     SB <- split(SB, f = SB$Fecha)
> 
> The Split function, shows me the next warnings:
> 
> **Warning messages:
> 1: In min(x) : no non-missing arguments to min; returning Inf
> 2: In max(x) : no non-missing arguments to max; returning -Inf
> 3: In min(x) : no non-missing arguments to min; returning Inf
> 4: In max(x) : no non-missing arguments to max; returning -Inf**
> 
> And for trying to export I did this:
> 
>     for (i in SB) {
>       jpeg(paste(SB[[1]],".jpg",sep=""))
>       bubble(SB[[i]], "mean.Evade.", col=c("#00ff0088", "#00ff0088"),
>              main = "Evasi?n" )
>       dev.off()
>     }
> 
> **Which shows me the next error:
> Error in as.character.default(<S4 object of class
> "SpatialPointsDataFrame">) :
>   no method for coercing this S4 class to a vector
> 6 as.character.default(<S4 object of class
> structure("SpatialPointsDataFrame", package = "sp")>)
> 5 as.character(<S4 object of class structure("SpatialPointsDataFrame",
> package = "sp")>)
> 4 paste(SB[[1]], ".jpg", sep = "")
> 3 gsub("%%", "", s)
> 2 checkIntFormat(filename)
> 1 jpeg(paste(SB[[1]], ".jpg", sep = ""))**
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

From edzer.pebesma at uni-muenster.de  Mon Jan  5 13:00:50 2015
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 05 Jan 2015 13:00:50 +0100
Subject: [R-sig-Geo] rgeos::gDifference
Message-ID: <54AA7CF2.4000400@uni-muenster.de>

When running the following script:

library(sp)
gt = GridTopology(cellcentre.offset = c(0,0), cellsize = c(1,1),
	cells.dim = c(3,3))
sgdf = SpatialGridDataFrame(SpatialGrid(gt),
    data.frame(r = round(runif(9, max = 10), 1)))

gt = GridTopology(cellcentre.offset = c(.25,.25), cellsize = c(1,1),
	cells.dim  = c(1,1))
grd.red = SpatialGrid(gt)

library(rgeos)
sp1 = as(sgdf, "SpatialPolygonsDataFrame")
sp2 = as(grd.red, "SpatialPolygons")

plot(sp1, axes = TRUE)
plot(sp2, border = 'red', add = TRUE)

dif = gDifference(sp2, gUnionCascaded(sp1))
dif = gDifference(sp2, sp1)


the last command gives the following error:

Error in RGEOSBinTopoFunc(spgeom1, spgeom2, byid, id, drop_not_poly,
"rgeos_difference") :
  TopologyException: no outgoing dirEdge found at -0.25 -0.25
Calls: gDifference -> RGEOSBinTopoFunc -> .Call
Execution halted

What does this mean? Why does gUnionCascaded(sp1) not do this?
-- 
Edzer Pebesma,  Co-Editor-in-Chief Computers & Geosciences
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150105/174af282/attachment.bin>

From Roger.Bivand at nhh.no  Mon Jan  5 13:53:07 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 5 Jan 2015 13:53:07 +0100
Subject: [R-sig-Geo] rgeos::gDifference
In-Reply-To: <54AA7CF2.4000400@uni-muenster.de>
References: <54AA7CF2.4000400@uni-muenster.de>
Message-ID: <alpine.LRH.2.03.1501051342310.2351@reclus.nhh.no>

On Mon, 5 Jan 2015, Edzer Pebesma wrote:

> When running the following script:
>
> library(sp)
> gt = GridTopology(cellcentre.offset = c(0,0), cellsize = c(1,1),
> 	cells.dim = c(3,3))
> sgdf = SpatialGridDataFrame(SpatialGrid(gt),
>    data.frame(r = round(runif(9, max = 10), 1)))
>
> gt = GridTopology(cellcentre.offset = c(.25,.25), cellsize = c(1,1),
> 	cells.dim  = c(1,1))
> grd.red = SpatialGrid(gt)
>
> library(rgeos)
> sp1 = as(sgdf, "SpatialPolygonsDataFrame")
> sp2 = as(grd.red, "SpatialPolygons")
>
> plot(sp1, axes = TRUE)
> plot(sp2, border = 'red', add = TRUE)
>
> dif = gDifference(sp2, gUnionCascaded(sp1))
> dif = gDifference(sp2, sp1)
>
>
> the last command gives the following error:
>
> Error in RGEOSBinTopoFunc(spgeom1, spgeom2, byid, id, drop_not_poly,
> "rgeos_difference") :
>  TopologyException: no outgoing dirEdge found at -0.25 -0.25
> Calls: gDifference -> RGEOSBinTopoFunc -> .Call
> Execution halted
>
> What does this mean? Why does gUnionCascaded(sp1) not do this?
>

gUnionCascaded() is deprecated, use gUnaryUnion(). This isn't the problem, 
the argument order is probably the cause:

dif = gDifference(sp1, sp2, byid=c(TRUE, FALSE))
length(dif)

works, preserving the input geometries, as does:

dif = gDifference(gUnaryUnion(sp1), sp2)
length(dif)

if you want to aggregate.

This:

dif = gDifference(sp2, gUnionCascaded(sp1))

gives a NULL result, as sp2 is within sp1, as does:

dif = gDifference(sp2, gUnaryUnion(sp1))

but:

dif = gDifference(sp2, sp1, byid=c(FALSE, TRUE))

preserves the input geometries. If it was clear what you wanted as output 
from the operation, it would be easier to see what is going on.

Best wishes,

Roger

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From edzer.pebesma at uni-muenster.de  Mon Jan  5 14:31:58 2015
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 05 Jan 2015 14:31:58 +0100
Subject: [R-sig-Geo] rgeos::gDifference
In-Reply-To: <alpine.LRH.2.03.1501051342310.2351@reclus.nhh.no>
References: <54AA7CF2.4000400@uni-muenster.de>
	<alpine.LRH.2.03.1501051342310.2351@reclus.nhh.no>
Message-ID: <54AA924E.9010604@uni-muenster.de>



On 01/05/2015 01:53 PM, Roger Bivand wrote:
> On Mon, 5 Jan 2015, Edzer Pebesma wrote:
> 
>> When running the following script:
>>
>> library(sp)
>> gt = GridTopology(cellcentre.offset = c(0,0), cellsize = c(1,1),
>>     cells.dim = c(3,3))
>> sgdf = SpatialGridDataFrame(SpatialGrid(gt),
>>    data.frame(r = round(runif(9, max = 10), 1)))
>>
>> gt = GridTopology(cellcentre.offset = c(.25,.25), cellsize = c(1,1),
>>     cells.dim  = c(1,1))
>> grd.red = SpatialGrid(gt)
>>
>> library(rgeos)
>> sp1 = as(sgdf, "SpatialPolygonsDataFrame")
>> sp2 = as(grd.red, "SpatialPolygons")
>>
>> plot(sp1, axes = TRUE)
>> plot(sp2, border = 'red', add = TRUE)
>>
>> dif = gDifference(sp2, gUnionCascaded(sp1))
>> dif = gDifference(sp2, sp1)
>>
>>
>> the last command gives the following error:
>>
>> Error in RGEOSBinTopoFunc(spgeom1, spgeom2, byid, id, drop_not_poly,
>> "rgeos_difference") :
>>  TopologyException: no outgoing dirEdge found at -0.25 -0.25
>> Calls: gDifference -> RGEOSBinTopoFunc -> .Call
>> Execution halted
>>
>> What does this mean? Why does gUnionCascaded(sp1) not do this?
>>
> 
> gUnionCascaded() is deprecated, use gUnaryUnion(). This isn't the
> problem, the argument order is probably the cause:
> 
> dif = gDifference(sp1, sp2, byid=c(TRUE, FALSE))
> length(dif)
> 
> works, preserving the input geometries, as does:
> 
> dif = gDifference(gUnaryUnion(sp1), sp2)
> length(dif)
> 
> if you want to aggregate.
> 
> This:
> 
> dif = gDifference(sp2, gUnionCascaded(sp1))
> 
> gives a NULL result, as sp2 is within sp1, as does:
> 
> dif = gDifference(sp2, gUnaryUnion(sp1))
> 
> but:
> 
> dif = gDifference(sp2, sp1, byid=c(FALSE, TRUE))
> 
> preserves the input geometries. If it was clear what you wanted as
> output from the operation, it would be easier to see what is going on.

Thanks!

I wanted to know if there was any part of sp2 that is not covered by
sp1, across the entire objects sp2 and sp1. Given the documentation, I
had expected

gDifference(sp2, sp1)

to give me that, and didn't understand the error message. I'm fine to
gUnaryUnion() sp1, but don't understand why.

Best regards,
-- 
Edzer Pebesma,  Co-Editor-in-Chief Computers & Geosciences
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150105/ee32be06/attachment.bin>

From Roger.Bivand at nhh.no  Mon Jan  5 14:43:00 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 5 Jan 2015 14:43:00 +0100
Subject: [R-sig-Geo] rgeos::gDifference
In-Reply-To: <54AA924E.9010604@uni-muenster.de>
References: <54AA7CF2.4000400@uni-muenster.de>
	<alpine.LRH.2.03.1501051342310.2351@reclus.nhh.no>
	<54AA924E.9010604@uni-muenster.de>
Message-ID: <alpine.LRH.2.03.1501051438350.2351@reclus.nhh.no>

On Mon, 5 Jan 2015, Edzer Pebesma wrote:

>
> On 01/05/2015 01:53 PM, Roger Bivand wrote:
>> On Mon, 5 Jan 2015, Edzer Pebesma wrote:
>>
>>> When running the following script:
>>>
>>> library(sp)
>>> gt = GridTopology(cellcentre.offset = c(0,0), cellsize = c(1,1),
>>>     cells.dim = c(3,3))
>>> sgdf = SpatialGridDataFrame(SpatialGrid(gt),
>>>    data.frame(r = round(runif(9, max = 10), 1)))
>>>
>>> gt = GridTopology(cellcentre.offset = c(.25,.25), cellsize = c(1,1),
>>>     cells.dim  = c(1,1))
>>> grd.red = SpatialGrid(gt)
>>>
>>> library(rgeos)
>>> sp1 = as(sgdf, "SpatialPolygonsDataFrame")
>>> sp2 = as(grd.red, "SpatialPolygons")
>>>
>>> plot(sp1, axes = TRUE)
>>> plot(sp2, border = 'red', add = TRUE)
>>>
>>> dif = gDifference(sp2, gUnionCascaded(sp1))
>>> dif = gDifference(sp2, sp1)
>>>
>>>
>>> the last command gives the following error:
>>>
>>> Error in RGEOSBinTopoFunc(spgeom1, spgeom2, byid, id, drop_not_poly,
>>> "rgeos_difference") :
>>>  TopologyException: no outgoing dirEdge found at -0.25 -0.25
>>> Calls: gDifference -> RGEOSBinTopoFunc -> .Call
>>> Execution halted
>>>
>>> What does this mean? Why does gUnionCascaded(sp1) not do this?
>>>
>>
>> gUnionCascaded() is deprecated, use gUnaryUnion(). This isn't the
>> problem, the argument order is probably the cause:
>>
>> dif = gDifference(sp1, sp2, byid=c(TRUE, FALSE))
>> length(dif)
>>
>> works, preserving the input geometries, as does:
>>
>> dif = gDifference(gUnaryUnion(sp1), sp2)
>> length(dif)
>>
>> if you want to aggregate.
>>
>> This:
>>
>> dif = gDifference(sp2, gUnionCascaded(sp1))
>>
>> gives a NULL result, as sp2 is within sp1, as does:
>>
>> dif = gDifference(sp2, gUnaryUnion(sp1))
>>
>> but:
>>
>> dif = gDifference(sp2, sp1, byid=c(FALSE, TRUE))
>>
>> preserves the input geometries. If it was clear what you wanted as
>> output from the operation, it would be easier to see what is going on.
>
> Thanks!
>
> I wanted to know if there was any part of sp2 that is not covered by
> sp1, across the entire objects sp2 and sp1. Given the documentation, I
> had expected
>
> gDifference(sp2, sp1)
>
> to give me that, and didn't understand the error message. I'm fine to
> gUnaryUnion() sp1, but don't understand why.

If you don't need the output of the operation, then:

gWithin(sp2, gUnaryUnion(sp1))

or

gCovers(gUnaryUnion(sp1), sp2)

maybe easier. The logic in GEOS as we have it now is that the predicates 
look at the component geometries, it seems, so gUnaryUnion() clarifies 
the query.

Roger

>
> Best regards,
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From ariel.fuentesdi at usach.cl  Mon Jan  5 16:43:59 2015
From: ariel.fuentesdi at usach.cl (Ariel Fuentesdi)
Date: Mon, 5 Jan 2015 11:43:59 -0400
Subject: [R-sig-Geo] Export subsets of Spatial Points Data Frame to
	images
In-Reply-To: <B078CDF40DFE4045AF172A8B4F68FC4857CAAC91CB@DKRDSEXC016.vestas.net>
References: <CAD0a9Ki9cx2y944H8MExytE8WkyxCThtrL77Ngc_roGKEY5uCg@mail.gmail.com>
	<B078CDF40DFE4045AF172A8B4F68FC4857CAAC91CB@DKRDSEXC016.vestas.net>
Message-ID: <CAD0a9Kjz-QaXansMtQZttBha_r60WzZR6d7UZcSNu9VWMryzKw@mail.gmail.com>

Frede,

This is the reproducible example:

date <- seq(as.Date("2015/1/1"), as.Date("2015/1/5"), "days")
stops <- c("aa", "bb", "cc", "dd", "ee")
F_Up <-  c(1:10)[-seq(from = 4, to = 8, by = 1)]
x <- c(342328.0, 342374.5, 342413.2, 342348.6, 342394.6)
y <-  c(6308284, 6308123, 6307915, 6307903, 6307915)
df <- data.frame(date, stops, F_Up, x, y)


coordinates(df) <- ~ x + y
proj4string(obj = df) <- CRS("+init=epsg:32719")

df2 <- split(df, f = df$date)

for (i in df2) {
  jpeg(paste(df2[[1]],".jpg",sep=""))
  bubble(df[i], "F_Up", col=c("#00ff0088", "#00ff0088"),
         main = "df2" )
  dev.off()
}


2015-01-05 3:22 GMT-04:00 Frede Aakmann T?gersen <frtog at vestas.com>:

> Hi Ariel
>
> Please provide a reproducible example. Now I have to guess what the SB
> object is because you didn't provide any details about that.
>
> I guess that the group_by() and summarise() are from the dplyr package.
>
> I guess that when you have imported the csv file you have an object SB
> containing columns Fecha, CodPar, x, and y.
>
> If so, your calls to the two dplyr functions are not correct. As first
> argument they need a data object, which is supposed to be of a tbl type
> like e.g. data frame.
>
> Why didn't you get an error when issuing e.g. group_by(Fecha, CodPar, x,
> y) instead of group_by(SB, Fecha, CodPar, x, y)?
>
> Yours sincerely / Med venlig hilsen
>
>
> Frede Aakmann T?gersen
> Specialist, M.Sc., Ph.D.
> Plant Performance & Modeling
>
> Technology & Service Solutions
> T +45 9730 5135
> M +45 2547 6050
> frtog at vestas.com
> http://www.vestas.com
>
> Company reg. name: Vestas Wind Systems A/S
> This e-mail is subject to our e-mail disclaimer statement.
> Please refer to www.vestas.com/legal/notice
> If you have received this e-mail in error please contact the sender.
>
> > -----Original Message-----
> > From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of
> Ariel
> > Fuentesdi
> > Sent: 5. januar 2015 04:48
> > To: r-sig-geo at r-project.org
> > Subject: [R-sig-Geo] Export subsets of Spatial Points Data Frame to
> images
> >
> > I have a csv file, which I converted it to Spatial Points Data Frame.
> And I
> > want to split the spatial data and export each map to a jpg file.
> >
> >
> > I did the following:
> >
> >     SB <- read.csv("SB_040914.csv", header=TRUE, sep = ";")
> >     SB <- SB %>% group_by(Fecha, CodPar, x, y) %>%
> > summarise(mean(Sube),mean(Evade), mean(Baja))
> >     SB <- data.frame(SB)
> >     SB <- SB[complete.cases(SB),]
> >
> >     coordinates(SB) <- ~ x + y
> >     proj4string(obj = SB) <- CRS("+init=epsg:32719")
> >
> >     SB <- split(SB, f = SB$Fecha)
> >
> > The Split function, shows me the next warnings:
> >
> > **Warning messages:
> > 1: In min(x) : no non-missing arguments to min; returning Inf
> > 2: In max(x) : no non-missing arguments to max; returning -Inf
> > 3: In min(x) : no non-missing arguments to min; returning Inf
> > 4: In max(x) : no non-missing arguments to max; returning -Inf**
> >
> > And for trying to export I did this:
> >
> >     for (i in SB) {
> >       jpeg(paste(SB[[1]],".jpg",sep=""))
> >       bubble(SB[[i]], "mean.Evade.", col=c("#00ff0088", "#00ff0088"),
> >              main = "Evasi?n" )
> >       dev.off()
> >     }
> >
> > **Which shows me the next error:
> > Error in as.character.default(<S4 object of class
> > "SpatialPointsDataFrame">) :
> >   no method for coercing this S4 class to a vector
> > 6 as.character.default(<S4 object of class
> > structure("SpatialPointsDataFrame", package = "sp")>)
> > 5 as.character(<S4 object of class structure("SpatialPointsDataFrame",
> > package = "sp")>)
> > 4 paste(SB[[1]], ".jpg", sep = "")
> > 3 gsub("%%", "", s)
> > 2 checkIntFormat(filename)
> > 1 jpeg(paste(SB[[1]], ".jpg", sep = ""))**
> >
> >       [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From edzer.pebesma at uni-muenster.de  Mon Jan  5 17:14:58 2015
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 05 Jan 2015 17:14:58 +0100
Subject: [R-sig-Geo] Export subsets of Spatial Points Data Frame to
	images
In-Reply-To: <CAD0a9Kjz-QaXansMtQZttBha_r60WzZR6d7UZcSNu9VWMryzKw@mail.gmail.com>
References: <CAD0a9Ki9cx2y944H8MExytE8WkyxCThtrL77Ngc_roGKEY5uCg@mail.gmail.com>	<B078CDF40DFE4045AF172A8B4F68FC4857CAAC91CB@DKRDSEXC016.vestas.net>
	<CAD0a9Kjz-QaXansMtQZttBha_r60WzZR6d7UZcSNu9VWMryzKw@mail.gmail.com>
Message-ID: <54AAB882.5030201@uni-muenster.de>


On 01/05/2015 04:43 PM, Ariel Fuentesdi wrote:
> Frede,
> 
> This is the reproducible example:
> 
> date <- seq(as.Date("2015/1/1"), as.Date("2015/1/5"), "days")
> stops <- c("aa", "bb", "cc", "dd", "ee")
> F_Up <-  c(1:10)[-seq(from = 4, to = 8, by = 1)]
> x <- c(342328.0, 342374.5, 342413.2, 342348.6, 342394.6)
> y <-  c(6308284, 6308123, 6307915, 6307903, 6307915)
> df <- data.frame(date, stops, F_Up, x, y)
> 
> 
> coordinates(df) <- ~ x + y
> proj4string(obj = df) <- CRS("+init=epsg:32719")
> 
> df2 <- split(df, f = df$date)
> 
> for (i in df2) {

in this loop, i is not an index, but is one of the df2 list elements.

>   jpeg(paste(df2[[1]],".jpg",sep=""))

this does not create valid file names.

>   bubble(df[i], "F_Up", col=c("#00ff0088", "#00ff0088"),
>          main = "df2" )

this does have no effect, because in a loop, bubble needs to be print()ed.

>   dev.off()
> }

The following does something, and may help you further:

for (i in seq(along = df2)) {
  jpeg(paste(names(df2)[i], ".jpg", sep=""))
  print(bubble(df2[[i]], "F_Up", col=c("#00ff0088", "#00ff0088"),
         main = "df2" ))
  dev.off()
}



> 
> 
> 2015-01-05 3:22 GMT-04:00 Frede Aakmann T?gersen <frtog at vestas.com>:
> 
>> Hi Ariel
>>
>> Please provide a reproducible example. Now I have to guess what the SB
>> object is because you didn't provide any details about that.
>>
>> I guess that the group_by() and summarise() are from the dplyr package.
>>
>> I guess that when you have imported the csv file you have an object SB
>> containing columns Fecha, CodPar, x, and y.
>>
>> If so, your calls to the two dplyr functions are not correct. As first
>> argument they need a data object, which is supposed to be of a tbl type
>> like e.g. data frame.
>>
>> Why didn't you get an error when issuing e.g. group_by(Fecha, CodPar, x,
>> y) instead of group_by(SB, Fecha, CodPar, x, y)?
>>
>> Yours sincerely / Med venlig hilsen
>>
>>
>> Frede Aakmann T?gersen
>> Specialist, M.Sc., Ph.D.
>> Plant Performance & Modeling
>>
>> Technology & Service Solutions
>> T +45 9730 5135
>> M +45 2547 6050
>> frtog at vestas.com
>> http://www.vestas.com
>>
>> Company reg. name: Vestas Wind Systems A/S
>> This e-mail is subject to our e-mail disclaimer statement.
>> Please refer to www.vestas.com/legal/notice
>> If you have received this e-mail in error please contact the sender.
>>
>>> -----Original Message-----
>>> From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of
>> Ariel
>>> Fuentesdi
>>> Sent: 5. januar 2015 04:48
>>> To: r-sig-geo at r-project.org
>>> Subject: [R-sig-Geo] Export subsets of Spatial Points Data Frame to
>> images
>>>
>>> I have a csv file, which I converted it to Spatial Points Data Frame.
>> And I
>>> want to split the spatial data and export each map to a jpg file.
>>>
>>>
>>> I did the following:
>>>
>>>     SB <- read.csv("SB_040914.csv", header=TRUE, sep = ";")
>>>     SB <- SB %>% group_by(Fecha, CodPar, x, y) %>%
>>> summarise(mean(Sube),mean(Evade), mean(Baja))
>>>     SB <- data.frame(SB)
>>>     SB <- SB[complete.cases(SB),]
>>>
>>>     coordinates(SB) <- ~ x + y
>>>     proj4string(obj = SB) <- CRS("+init=epsg:32719")
>>>
>>>     SB <- split(SB, f = SB$Fecha)
>>>
>>> The Split function, shows me the next warnings:
>>>
>>> **Warning messages:
>>> 1: In min(x) : no non-missing arguments to min; returning Inf
>>> 2: In max(x) : no non-missing arguments to max; returning -Inf
>>> 3: In min(x) : no non-missing arguments to min; returning Inf
>>> 4: In max(x) : no non-missing arguments to max; returning -Inf**
>>>
>>> And for trying to export I did this:
>>>
>>>     for (i in SB) {
>>>       jpeg(paste(SB[[1]],".jpg",sep=""))
>>>       bubble(SB[[i]], "mean.Evade.", col=c("#00ff0088", "#00ff0088"),
>>>              main = "Evasi?n" )
>>>       dev.off()
>>>     }
>>>
>>> **Which shows me the next error:
>>> Error in as.character.default(<S4 object of class
>>> "SpatialPointsDataFrame">) :
>>>   no method for coercing this S4 class to a vector
>>> 6 as.character.default(<S4 object of class
>>> structure("SpatialPointsDataFrame", package = "sp")>)
>>> 5 as.character(<S4 object of class structure("SpatialPointsDataFrame",
>>> package = "sp")>)
>>> 4 paste(SB[[1]], ".jpg", sep = "")
>>> 3 gsub("%%", "", s)
>>> 2 checkIntFormat(filename)
>>> 1 jpeg(paste(SB[[1]], ".jpg", sep = ""))**
>>>
>>>       [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma,  Co-Editor-in-Chief Computers & Geosciences
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150105/6561400a/attachment.bin>

From frtog at vestas.com  Mon Jan  5 17:53:27 2015
From: frtog at vestas.com (=?utf-8?B?RnJlZGUgQWFrbWFubiBUw7hnZXJzZW4=?=)
Date: Mon, 5 Jan 2015 17:53:27 +0100
Subject: [R-sig-Geo] Export subsets of Spatial Points Data Frame to
 images
In-Reply-To: <CAD0a9Kjz-QaXansMtQZttBha_r60WzZR6d7UZcSNu9VWMryzKw@mail.gmail.com>
References: <CAD0a9Ki9cx2y944H8MExytE8WkyxCThtrL77Ngc_roGKEY5uCg@mail.gmail.com>
	<B078CDF40DFE4045AF172A8B4F68FC4857CAAC91CB@DKRDSEXC016.vestas.net>
	<CAD0a9Kjz-QaXansMtQZttBha_r60WzZR6d7UZcSNu9VWMryzKw@mail.gmail.com>
Message-ID: <B078CDF40DFE4045AF172A8B4F68FC4857CB149E47@DKRDSEXC016.vestas.net>

Hi Ariel

I cannot execute the for loop of your code. Can you execute the code?

Several things are wrong.

After splitting your sp object called on the date you now have df2 as a named list of sp objects with the names being the dates.

Here is your code:

for (i in df2) { ?
? jpeg(paste(df2[[1]],".jpg",sep=""))
? bubble(df[i], "F_Up", col=c("#00ff0088", "#00ff0088"),?
? ? ? ? ?main = "df2" )
? dev.off()
}

You are trying to define a file name using paste() but it does not work:

>
> paste(df2[[1]],".jpg",sep="")
Error in as.character.default(<S4 object of class "SpatialPointsDataFrame">) : 
  no method for coercing this S4 class to a vector
>

Also in the loop you're always extracting the first element of df2. Is that what you want? 

Next you're trying to make a bubble plot but in the loop you're using the sp object df and not df2. Also R will complain over you subsetting an sp object using an sp object.

There are several ways to obtain what you want. I suggest that you loop over the names of the df2 list of sp objects:

> names(df2)
[1] "2015-01-01" "2015-01-02" "2015-01-03" "2015-01-04" "2015-01-05"
>

Since bubble() is based on the lattice package you will need to use print() on the lattice object created when using bubble() when inside a loop.

Now this I have tested and it works for me. 

for (i in names(df2)) {  
  jpeg(paste(i, ".jpg", sep="")) # i is the name of each element in df2
  print(bubble(df2[[i]], "F_Up", col=c("#00ff0088", "#00ff0088"),  main = "df2" )) # subsetting using i
  dev.off()
}


Yours sincerely / Med venlig hilsen


Frede Aakmann T?gersen
Specialist, M.Sc., Ph.D.
Plant Performance & Modeling

Technology & Service Solutions
T +45 9730 5135
M +45 2547 6050
frtog at vestas.com
http://www.vestas.com

Company reg. name: Vestas Wind Systems A/S
This e-mail is subject to our e-mail disclaimer statement.
Please refer to www.vestas.com/legal/notice
If you have received this e-mail in error please contact the sender. 

From: Ariel Fuentesdi [mailto:ariel.fuentesdi at usach.cl] 
Sent: 5. januar 2015 16:44
To: Frede Aakmann T?gersen
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] Export subsets of Spatial Points Data Frame to images

Frede,

This is the reproducible example:

date <- seq(as.Date("2015/1/1"), as.Date("2015/1/5"), "days")
stops <- c("aa", "bb", "cc", "dd", "ee")
F_Up <- ?c(1:10)[-seq(from = 4, to = 8, by = 1)]?
x <- c(342328.0, 342374.5, 342413.2, 342348.6, 342394.6)
y <- ?c(6308284, 6308123, 6307915, 6307903, 6307915)?
df <- data.frame(date, stops, F_Up, x, y)


coordinates(df) <- ~ x + y?
proj4string(obj = df) <- CRS("+init=epsg:32719")

df2 <- split(df, f = df$date)

for (i in df2) { ?
? jpeg(paste(df2[[1]],".jpg",sep=""))
? bubble(df[i], "F_Up", col=c("#00ff0088", "#00ff0088"),?
? ? ? ? ?main = "df2" )
? dev.off()
}


2015-01-05 3:22 GMT-04:00 Frede Aakmann T?gersen <frtog at vestas.com>:
Hi Ariel

Please provide a reproducible example. Now I have to guess what the SB object is because you didn't provide any details about that.

I guess that the group_by() and summarise() are from the dplyr package.

I guess that when you have imported the csv file you have an object SB containing columns Fecha, CodPar, x, and y.

If so, your calls to the two dplyr functions are not correct. As first argument they need a data object, which is supposed to be of a tbl type like e.g. data frame.

Why didn't you get an error when issuing e.g. group_by(Fecha, CodPar, x, y) instead of group_by(SB, Fecha, CodPar, x, y)?

Yours sincerely / Med venlig hilsen


Frede Aakmann T?gersen
Specialist, M.Sc., Ph.D.
Plant Performance & Modeling

Technology & Service Solutions
T +45 9730 5135
M +45 2547 6050
frtog at vestas.com
http://www.vestas.com

Company reg. name: Vestas Wind Systems A/S
This e-mail is subject to our e-mail disclaimer statement.
Please refer to www.vestas.com/legal/notice
If you have received this e-mail in error please contact the sender.

> -----Original Message-----
> From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Ariel
> Fuentesdi
> Sent: 5. januar 2015 04:48
> To: r-sig-geo at r-project.org
> Subject: [R-sig-Geo] Export subsets of Spatial Points Data Frame to images
>
> I have a csv file, which I converted it to Spatial Points Data Frame. And I
> want to split the spatial data and export each map to a jpg file.
>
>
> I did the following:
>
>? ? ?SB <- read.csv("SB_040914.csv", header=TRUE, sep = ";")
>? ? ?SB <- SB %>% group_by(Fecha, CodPar, x, y) %>%
> summarise(mean(Sube),mean(Evade), mean(Baja))
>? ? ?SB <- data.frame(SB)
>? ? ?SB <- SB[complete.cases(SB),]
>
>? ? ?coordinates(SB) <- ~ x + y
>? ? ?proj4string(obj = SB) <- CRS("+init=epsg:32719")
>
>? ? ?SB <- split(SB, f = SB$Fecha)
>
> The Split function, shows me the next warnings:
>
> **Warning messages:
> 1: In min(x) : no non-missing arguments to min; returning Inf
> 2: In max(x) : no non-missing arguments to max; returning -Inf
> 3: In min(x) : no non-missing arguments to min; returning Inf
> 4: In max(x) : no non-missing arguments to max; returning -Inf**
>
> And for trying to export I did this:
>
>? ? ?for (i in SB) {
>? ? ? ?jpeg(paste(SB[[1]],".jpg",sep=""))
>? ? ? ?bubble(SB[[i]], "mean.Evade.", col=c("#00ff0088", "#00ff0088"),
>? ? ? ? ? ? ? main = "Evasi?n" )
>? ? ? ?dev.off()
>? ? ?}
>
> **Which shows me the next error:
> Error in as.character.default(<S4 object of class
> "SpatialPointsDataFrame">) :
>? ?no method for coercing this S4 class to a vector
> 6 as.character.default(<S4 object of class
> structure("SpatialPointsDataFrame", package = "sp")>)
> 5 as.character(<S4 object of class structure("SpatialPointsDataFrame",
> package = "sp")>)
> 4 paste(SB[[1]], ".jpg", sep = "")
> 3 gsub("%%", "", s)
> 2 checkIntFormat(filename)
> 1 jpeg(paste(SB[[1]], ".jpg", sep = ""))**
>
>? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From r.hijmans at gmail.com  Mon Jan  5 20:00:54 2015
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 5 Jan 2015 11:00:54 -0800
Subject: [R-sig-Geo] rgeos::gDifference
In-Reply-To: <alpine.LRH.2.03.1501051438350.2351@reclus.nhh.no>
References: <54AA7CF2.4000400@uni-muenster.de>
	<alpine.LRH.2.03.1501051342310.2351@reclus.nhh.no>
	<54AA924E.9010604@uni-muenster.de>
	<alpine.LRH.2.03.1501051438350.2351@reclus.nhh.no>
Message-ID: <CANtt_hzgs-eyStLtVpOtHbnY2b+dLoiK_5TVFGHSNqi0CXiV4g@mail.gmail.com>

You can also do:

library(raster)
x <- sp1 - sp2
y <- sp2 - sp1

(equivalent to the "erase" function)



On Mon, Jan 5, 2015 at 5:43 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> On Mon, 5 Jan 2015, Edzer Pebesma wrote:
>
>>
>> On 01/05/2015 01:53 PM, Roger Bivand wrote:
>>>
>>> On Mon, 5 Jan 2015, Edzer Pebesma wrote:
>>>
>>>> When running the following script:
>>>>
>>>> library(sp)
>>>> gt = GridTopology(cellcentre.offset = c(0,0), cellsize = c(1,1),
>>>>     cells.dim = c(3,3))
>>>> sgdf = SpatialGridDataFrame(SpatialGrid(gt),
>>>>    data.frame(r = round(runif(9, max = 10), 1)))
>>>>
>>>> gt = GridTopology(cellcentre.offset = c(.25,.25), cellsize = c(1,1),
>>>>     cells.dim  = c(1,1))
>>>> grd.red = SpatialGrid(gt)
>>>>
>>>> library(rgeos)
>>>> sp1 = as(sgdf, "SpatialPolygonsDataFrame")
>>>> sp2 = as(grd.red, "SpatialPolygons")
>>>>
>>>> plot(sp1, axes = TRUE)
>>>> plot(sp2, border = 'red', add = TRUE)
>>>>
>>>> dif = gDifference(sp2, gUnionCascaded(sp1))
>>>> dif = gDifference(sp2, sp1)
>>>>
>>>>
>>>> the last command gives the following error:
>>>>
>>>> Error in RGEOSBinTopoFunc(spgeom1, spgeom2, byid, id, drop_not_poly,
>>>> "rgeos_difference") :
>>>>  TopologyException: no outgoing dirEdge found at -0.25 -0.25
>>>> Calls: gDifference -> RGEOSBinTopoFunc -> .Call
>>>> Execution halted
>>>>
>>>> What does this mean? Why does gUnionCascaded(sp1) not do this?
>>>>
>>>
>>> gUnionCascaded() is deprecated, use gUnaryUnion(). This isn't the
>>> problem, the argument order is probably the cause:
>>>
>>> dif = gDifference(sp1, sp2, byid=c(TRUE, FALSE))
>>> length(dif)
>>>
>>> works, preserving the input geometries, as does:
>>>
>>> dif = gDifference(gUnaryUnion(sp1), sp2)
>>> length(dif)
>>>
>>> if you want to aggregate.
>>>
>>> This:
>>>
>>> dif = gDifference(sp2, gUnionCascaded(sp1))
>>>
>>> gives a NULL result, as sp2 is within sp1, as does:
>>>
>>> dif = gDifference(sp2, gUnaryUnion(sp1))
>>>
>>> but:
>>>
>>> dif = gDifference(sp2, sp1, byid=c(FALSE, TRUE))
>>>
>>> preserves the input geometries. If it was clear what you wanted as
>>> output from the operation, it would be easier to see what is going on.
>>
>>
>> Thanks!
>>
>> I wanted to know if there was any part of sp2 that is not covered by
>> sp1, across the entire objects sp2 and sp1. Given the documentation, I
>> had expected
>>
>> gDifference(sp2, sp1)
>>
>> to give me that, and didn't understand the error message. I'm fine to
>> gUnaryUnion() sp1, but don't understand why.
>
>
> If you don't need the output of the operation, then:
>
> gWithin(sp2, gUnaryUnion(sp1))
>
> or
>
> gCovers(gUnaryUnion(sp1), sp2)
>
> maybe easier. The logic in GEOS as we have it now is that the predicates
> look at the component geometries, it seems, so gUnaryUnion() clarifies the
> query.
>
> Roger
>
>>
>> Best regards,
>>
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 91 00
> e-mail: Roger.Bivand at nhh.no
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From frtog at vestas.com  Tue Jan  6 08:17:35 2015
From: frtog at vestas.com (=?utf-8?B?RnJlZGUgQWFrbWFubiBUw7hnZXJzZW4=?=)
Date: Tue, 6 Jan 2015 08:17:35 +0100
Subject: [R-sig-Geo] Export subsets of Spatial Points Data Frame to
 images
In-Reply-To: <CAD0a9KimfHg5zr_R-yC5LDKqQU3R5J=KxvpMAyef5cATJ4+hbA@mail.gmail.com>
References: <CAD0a9Ki9cx2y944H8MExytE8WkyxCThtrL77Ngc_roGKEY5uCg@mail.gmail.com>
	<B078CDF40DFE4045AF172A8B4F68FC4857CAAC91CB@DKRDSEXC016.vestas.net>
	<CAD0a9Kjz-QaXansMtQZttBha_r60WzZR6d7UZcSNu9VWMryzKw@mail.gmail.com>
	<B078CDF40DFE4045AF172A8B4F68FC4857CB149E47@DKRDSEXC016.vestas.net>
	<CAD0a9KimfHg5zr_R-yC5LDKqQU3R5J=KxvpMAyef5cATJ4+hbA@mail.gmail.com>
Message-ID: <B078CDF40DFE4045AF172A8B4F68FC4857CB149F03@DKRDSEXC016.vestas.net>

Hi Ariel

First, it looks like you?re learning R. The best way to learn R is to solve on your own the problems you encounter. Letting people show how to do your R work doesn?t help you learning R that much.

Second, in the future please include the error message and the trace back from latest error when asking questions on R problems. Then it is much easier for us to answer you. Like this:

> for (i in names(SB2)) {
+   jpeg(paste(i, ".jpg", sep=""))
+   print(bubble(SB2[[i]], "Evade", col=c("#00ff0088", "#00ff0088"), main = "Ev" )) # subsetting using i
+   dev.off()
+ }
Error in jpeg(paste(i, ".jpg", sep = "")) (from #2) : unable to start jpeg() device
In addition: Warning messages:
1: In jpeg(paste(i, ".jpg", sep = "")) :
  unable to open file '01/03/2013.jpg' for writing
2: In jpeg(paste(i, ".jpg", sep = "")) : opening device failed
> traceback()
1: jpeg(paste(i, ".jpg", sep = "")) at #2

In this case the trace back didn?t give additional information but it will in most cases.

This indicate  that there is problems with the file names. You have:

> names(SB2)
[1] "01/03/2013" "04/01/2013" "04/04/2013" "05/04/2013" "05/12/2012"
[6] "06/12/2012" "07/01/2013" "07/12/2012" "08/04/2013" "08/11/2012"
[11] "09/01/2013" "09/04/2013" "10/01/2013" "10/04/2013" "11/01/2013"
[16] "11/02/2013" "11/03/2013" "11/04/2013" "12/03/2013" "12/04/2013"
[21] "12/11/2012" "13/03/2013" "13/11/2012" "14/03/2013" "14/12/2012"
[26] "15/03/2013" "15/04/2013" "16/04/2013" "16/11/2012" "17/04/2013"
[31] "18/12/2012" "19/11/2012" "20/11/2012" "24/12/2012" "25/03/2013"
[36] "26/12/2012" "27/03/2013" "27/12/2012"

So the format of the date is like day/month/year and this is bad for file names since / (slash) is the delimiter character used in paths.

After importing data (notice I added the stringsAsFactors = FALSE argument in order not to convert strings to factors)

SB <- read.csv("c:/users/frtog/Desktop/SB_040914v2.csv", header=TRUE, sep = ";", stringsAsFactors = FALSE)

You can do either

SB$Fecha <- gsub("/", "-", SB$Fecha)

or

SB$Fecha <- as.POSIXct(strptime(SB$Fecha, format = "%d/%m/%Y"))


Next problem is that in the elements of SB2 your data do not have a column named ?Evade? but one named ?mean(Evade)? (coming from the summarise()). However bubble seems to not handle such column names graceful so I suggest that you do:

SB <- SB %>% group_by(Fecha, CodPar, x, y) %>% summarise(meanSube = mean(Sube),
                                                         meanEvade = mean(Evade),
                                                         meanBaja = mean(Baja))

where in summarise() you use the name = value specification on the columns that you want aggregation.

So this works for me:


library(sp)
library(dplyr)

SB <- read.csv("c:/users/frtog/Desktop/SB_040914v2.csv", header=TRUE, sep = ";", stringsAsFactors = FALSE)

## SB$Fecha <- gsub("/", "-", SB$Fecha)
SB$Fecha <- as.POSIXct(strptime(SB$Fecha, format = "%d/%m/%Y"))

SB <- SB %>% group_by(Fecha, CodPar, x, y) %>% summarise(meanSube = mean(Sube),
                                                         meanEvade = mean(Evade),
                                                         meanBaja = mean(Baja))
SB <- SB[complete.cases(SB),]
SB <- as.data.frame(SB)

coordinates(SB) <- ~ x + y
proj4string(obj = SB) <- CRS("+init=epsg:32719")

SB2 <- split(SB, f = SB$Fecha)

for (i in names(SB2)) {
  jpeg(paste(i, ".jpg", sep=""))
  print(bubble(SB2[[i]], "meanEvade", col=c("#00ff0088", "#00ff0088"), main = "Ev" )) # subsetting using i
  dev.off()
}



Yours sincerely / Med venlig hilsen


Frede Aakmann T?gersen
Specialist, M.Sc., Ph.D.
Plant Performance & Modeling

Technology & Service Solutions
T +45 9730 5135
M +45 2547 6050
frtog at vestas.com<mailto:frtog at vestas.com>
http://www.vestas.com<http://www.vestas.com/>

Company reg. name: Vestas Wind Systems A/S
This e-mail is subject to our e-mail disclaimer statement.
Please refer to www.vestas.com/legal/notice<http://www.vestas.com/legal/notice>
If you have received this e-mail in error please contact the sender.

From: Ariel Fuentesdi [mailto:ariel.fuentesdi at usach.cl]
Sent: 5. januar 2015 21:49
To: Frede Aakmann T?gersen
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] Export subsets of Spatial Points Data Frame to images

Thank you for your help, it works perfectly.
Though, in my original data still gives me some problems to export it to jpg files.

The original data is something like I attach to this mail.

I fixed it with the code you sent me, and it remains as:

SB <- read.csv("SB_040914v2.csv", header=TRUE, sep = ";")
SB <- SB %>% group_by(Fecha, CodPar, x, y) %>% summarise(mean(Sube),
                                                         mean(Evade), mean(Baja))
SB <- SB[complete.cases(SB),]
SB <- as.data.frame(SB)


coordinates(SB) <- ~ x + y
proj4string(obj = SB) <- CRS("+init=epsg:32719")

SB2 <- split(SB, f = SB$Fecha)

for (i in names(SB2)) {
  jpeg(paste(i, ".jpg", sep=""))
  print(bubble(SB2[[i]], "Evade", col=c("#00ff0088", "#00ff0088"),
               main = "Ev" )) # subsetting using i
  dev.off()
}

giving me troubles in the loop.

Best regards,

Ariel


2015-01-05 12:53 GMT-04:00 Frede Aakmann T?gersen <frtog at vestas.com<mailto:frtog at vestas.com>>:
Hi Ariel

I cannot execute the for loop of your code. Can you execute the code?

Several things are wrong.

After splitting your sp object called on the date you now have df2 as a named list of sp objects with the names being the dates.

Here is your code:

for (i in df2) {
  jpeg(paste(df2[[1]],".jpg",sep=""))
  bubble(df[i], "F_Up", col=c("#00ff0088", "#00ff0088"),
         main = "df2" )
  dev.off()
}

You are trying to define a file name using paste() but it does not work:

>
> paste(df2[[1]],".jpg",sep="")
Error in as.character.default(<S4 object of class "SpatialPointsDataFrame">) :
  no method for coercing this S4 class to a vector
>

Also in the loop you're always extracting the first element of df2. Is that what you want?

Next you're trying to make a bubble plot but in the loop you're using the sp object df and not df2. Also R will complain over you subsetting an sp object using an sp object.

There are several ways to obtain what you want. I suggest that you loop over the names of the df2 list of sp objects:

> names(df2)
[1] "2015-01-01" "2015-01-02" "2015-01-03" "2015-01-04" "2015-01-05"
>

Since bubble() is based on the lattice package you will need to use print() on the lattice object created when using bubble() when inside a loop.

Now this I have tested and it works for me.

for (i in names(df2)) {
  jpeg(paste(i, ".jpg", sep="")) # i is the name of each element in df2
  print(bubble(df2[[i]], "F_Up", col=c("#00ff0088", "#00ff0088"),  main = "df2" )) # subsetting using i
  dev.off()
}


Yours sincerely / Med venlig hilsen


Frede Aakmann T?gersen
Specialist, M.Sc., Ph.D.
Plant Performance & Modeling

Technology & Service Solutions
T +45 9730 5135<tel:%2B45%209730%205135>
M +45 2547 6050<tel:%2B45%202547%206050>
frtog at vestas.com<mailto:frtog at vestas.com>
http://www.vestas.com

Company reg. name: Vestas Wind Systems A/S
This e-mail is subject to our e-mail disclaimer statement.
Please refer to www.vestas.com/legal/notice<http://www.vestas.com/legal/notice>
If you have received this e-mail in error please contact the sender.

From: Ariel Fuentesdi [mailto:ariel.fuentesdi at usach.cl<mailto:ariel.fuentesdi at usach.cl>]
Sent: 5. januar 2015 16:44
To: Frede Aakmann T?gersen
Cc: r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
Subject: Re: [R-sig-Geo] Export subsets of Spatial Points Data Frame to images

Frede,

This is the reproducible example:

date <- seq(as.Date("2015/1/1"), as.Date("2015/1/5"), "days")
stops <- c("aa", "bb", "cc", "dd", "ee")
F_Up <-  c(1:10)[-seq(from = 4, to = 8, by = 1)]
x <- c(342328.0, 342374.5, 342413.2, 342348.6, 342394.6)
y <-  c(6308284, 6308123, 6307915, 6307903, 6307915)
df <- data.frame(date, stops, F_Up, x, y)


coordinates(df) <- ~ x + y
proj4string(obj = df) <- CRS("+init=epsg:32719")

df2 <- split(df, f = df$date)

for (i in df2) {
  jpeg(paste(df2[[1]],".jpg",sep=""))
  bubble(df[i], "F_Up", col=c("#00ff0088", "#00ff0088"),
         main = "df2" )
  dev.off()
}


2015-01-05 3:22 GMT-04:00 Frede Aakmann T?gersen <frtog at vestas.com<mailto:frtog at vestas.com>>:
Hi Ariel

Please provide a reproducible example. Now I have to guess what the SB object is because you didn't provide any details about that.

I guess that the group_by() and summarise() are from the dplyr package.

I guess that when you have imported the csv file you have an object SB containing columns Fecha, CodPar, x, and y.

If so, your calls to the two dplyr functions are not correct. As first argument they need a data object, which is supposed to be of a tbl type like e.g. data frame.

Why didn't you get an error when issuing e.g. group_by(Fecha, CodPar, x, y) instead of group_by(SB, Fecha, CodPar, x, y)?

Yours sincerely / Med venlig hilsen


Frede Aakmann T?gersen
Specialist, M.Sc., Ph.D.
Plant Performance & Modeling

Technology & Service Solutions
T +45 9730 5135<tel:%2B45%209730%205135>
M +45 2547 6050<tel:%2B45%202547%206050>
frtog at vestas.com<mailto:frtog at vestas.com>
http://www.vestas.com

Company reg. name: Vestas Wind Systems A/S
This e-mail is subject to our e-mail disclaimer statement.
Please refer to www.vestas.com/legal/notice<http://www.vestas.com/legal/notice>
If you have received this e-mail in error please contact the sender.

> -----Original Message-----
> From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org<mailto:r-sig-geo-bounces at r-project.org>] On Behalf Of Ariel
> Fuentesdi
> Sent: 5. januar 2015 04:48
> To: r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
> Subject: [R-sig-Geo] Export subsets of Spatial Points Data Frame to images
>
> I have a csv file, which I converted it to Spatial Points Data Frame. And I
> want to split the spatial data and export each map to a jpg file.
>
>
> I did the following:
>
>     SB <- read.csv("SB_040914.csv", header=TRUE, sep = ";")
>     SB <- SB %>% group_by(Fecha, CodPar, x, y) %>%
> summarise(mean(Sube),mean(Evade), mean(Baja))
>     SB <- data.frame(SB)
>     SB <- SB[complete.cases(SB),]
>
>     coordinates(SB) <- ~ x + y
>     proj4string(obj = SB) <- CRS("+init=epsg:32719")
>
>     SB <- split(SB, f = SB$Fecha)
>
> The Split function, shows me the next warnings:
>
> **Warning messages:
> 1: In min(x) : no non-missing arguments to min; returning Inf
> 2: In max(x) : no non-missing arguments to max; returning -Inf
> 3: In min(x) : no non-missing arguments to min; returning Inf
> 4: In max(x) : no non-missing arguments to max; returning -Inf**
>
> And for trying to export I did this:
>
>     for (i in SB) {
>       jpeg(paste(SB[[1]],".jpg",sep=""))
>       bubble(SB[[i]], "mean.Evade.", col=c("#00ff0088", "#00ff0088"),
>              main = "Evasi?n" )
>       dev.off()
>     }
>
> **Which shows me the next error:
> Error in as.character.default(<S4 object of class
> "SpatialPointsDataFrame">) :
>   no method for coercing this S4 class to a vector
> 6 as.character.default(<S4 object of class
> structure("SpatialPointsDataFrame", package = "sp")>)
> 5 as.character(<S4 object of class structure("SpatialPointsDataFrame",
> package = "sp")>)
> 4 paste(SB[[1]], ".jpg", sep = "")
> 3 gsub("%%", "", s)
> 2 checkIntFormat(filename)
> 1 jpeg(paste(SB[[1]], ".jpg", sep = ""))**
>
>       [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


	[[alternative HTML version deleted]]


From wrober26 at vols.utk.edu  Tue Jan  6 22:52:28 2015
From: wrober26 at vols.utk.edu (Roberts, Blake)
Date: Tue, 6 Jan 2015 21:52:28 +0000
Subject: [R-sig-Geo] GSTAT Co-Kriging: How can i fix a non positive definte
 correlation matrix
Message-ID: <BLUPR02MB083664C2493C69AA277823EF9590@BLUPR02MB083.namprd02.prod.outlook.com>

QUESTION: Can anyone give me advice on how to resolve an error message regarding a non positive definite correlation matrix so that the computed negative cross-variogram can be used to perform co-kriging?

I am performing co-kriging on negatively correlated parameters. 

data = dtrd 

x	y	n.ts	n.ae
3.2	6.4	-0.052514693	0.055104755
6.4	6.4	-0.375234492	-0.861381682
9.6	6.4	1.362810557	-0.23577909
12.8	6.4	-0.333087778	0.134741672
16	6.4	0.699916885	-2.348188189
22.4	6.4	0.605552409	-0.75492334
25.6	6.4	0.406868496	0.329847607
3.2	9.6	-0.529754386	0.251549504
6.4	9.6	-0.416509276	1.094807283
9.6	9.6	-0.450700276	0.988002955
12.8	9.6	-0.732937251	1.344413512
16	9.6	0.377457633	-0.542187169
19.2	9.6	-0.989029229	2.002433474
22.4	9.6	-1.259551904	-0.895859924
25.6	9.6	-0.470220669	0.370809323
3.2	12.8	1.046426438	0.168121785
6.4	12.8	-1.440639861	1.423433672
9.6	12.8	-0.899563555	0.83844681
12.8	12.8	-1.287567164	-0.086478673
16	12.8	-0.816931437	1.156633451
19.2	12.8	-0.782655308	0.299641538
22.4	12.8	0.048342822	-0.763091614
3.2	16	-0.5581308	-0.130509134
6.4	16	-0.217874377	0.815852429
9.6	16	-0.272702769	0.906621066
12.8	16	-0.996064	0.274459785
16	16	-1.97520507	2.017626766
19.2	16	-0.718163458	0.444173367
22.4	16	0.337266312	0.831151021
25.6	16	-0.565668608	0.513114809
3.2	19.2	0.651736313	-0.055114304
6.4	19.2	-0.715751462	0.205488257
9.6	19.2	0.650820529	0.558032798
12.8	19.2	-1.184380204	0.612006591
16	19.2	0.132388601	0.462059331
19.2	19.2	1.08502868	0.399240335
22.4	19.2	-0.85196341	0.113079949
25.6	19.2	0.099887288	-1.922971577
3.2	22.4	-0.233091874	-0.287556625
6.4	22.4	-0.989196908	0.10047403
9.6	22.4	-0.025054063	0.384754057
12.8	22.4	-0.394999955	-1.272051846
16	22.4	0.049839033	-2.568551091
19.2	22.4	1.327518037	-0.974203156
22.4	22.4	-0.421157849	-0.0101211
25.6	22.4	-0.178717505	0.408401438
3.2	25.6	-0.065413063	-0.195765074
6.4	25.6	1.167410569	-1.626236059
9.6	25.6	0.428968564	-1.287922066
12.8	25.6	1.550074254	-1.011990828
16	25.6	2.931334909	-1.872352342
19.2	25.6	4.126464345	-2.254471152
22.4	25.6	0.44561262	-0.709554064
25.6	25.6	0.543591219	1.03999109
3.2	28.8	0.716228164	-0.671315106
6.4	28.8	1.856183532	-1.403466298
9.6	28.8	0.774644882	-0.952601604
12.8	28.8	0.425336383	-0.776073605
16	28.8	0.294908064	-0.00019281
19.2	28.8	2.38260471	-0.778811406
22.4	28.8	-0.315391214	-0.223383771
25.6	28.8	1.136916243	-0.238938091
3.2	32	-0.233091874	-0.520269718
6.4	32	-0.352017426	-0.556041646
9.6	32	-0.933099317	-0.441354858
16	32	-0.865945243	-1.011088256
19.2	32	-0.594339105	-0.399550741
22.4	32	-0.653328511	1.213119402
25.6	32	0.076670222	0.819568017
3.2	35.2	-0.14022361	0.166527242
6.4	35.2	-0.545492977	-0.613535469
9.6	35.2	-0.084386566	-0.423754708
12.8	35.2	2.107283841	-0.891753223
16	35.2	-1.645006796	0.566968259
22.4	35.2	0.512684145	0.515250895
25.6	35.2	0.517794479	-1.144578624
3.2	38.4	-0.359495901	0.191964723
6.4	38.4	0.548288806	-1.011825356
9.6	38.4	-0.597741695	0.046560408
12.8	38.4	-1.003803022	0.319904274
16	38.4	0.060157729	0.824035747
19.2	38.4	0.251793973	0.632946256
22.4	38.4	-1.148625922	1.257360463
25.6	38.4	-0.957779058	0.30201831
3.2	41.6	0.267364885	1.139304073
6.4	41.6	0.171656399	0.623288738
9.6	41.6	-0.912461925	0.820049388
12.8	41.6	-0.645228334	1.041375034
16	41.6	0.83148026	2.914000894
19.2	41.6	-1.187664129	2.756035789
22.4	41.6	-0.467591981	0.467880919
25.6	41.6	-0.121964677	0.878460826
3.2	44.8	-0.158281328	-0.266451488
6.4	44.8	-0.235932095	1.440612621
12.8	44.8	-0.436274739	-0.298237058
16	44.8	-1.136811015	-0.688794913
19.2	44.8	0.87349541	0.449964869
22.4	44.8	-0.661067533	-0.08882536
25.6	44.8	0.301101862	-0.255259598
3.2	48	1.265698729	0.948786211
6.4	48	-0.806040053	0.352201302
9.6	48	1.006815543	1.12999254
12.8	48	-0.0132082	0.581935908
16	48	-1.214201235	1.431842632
19.2	48	-0.323473333	-0.083379843
22.4	48	-0.003250658	-0.248324838
25.6	48	-0.168398809	-0.916859761
3.2	51.2	-0.854793312	-0.231928117
6.4	51.2	0.507014021	-0.49107152
9.6	51.2	3.104090518	-2.654897126
12.8	51.2	-0.193785381	0.067244345
16	51.2	-0.71632415	-1.46047875
19.2	51.2	2.480632323	-0.336852087
22.4	51.2	-0.534663506	-1.093553232
25.6	51.2	-0.124544351	-0.603005465

Using the following code I compute a negative cross-variogram:

dtrd = as.data.frame(dtrd)
# create a grid onto which i will interpolate # first get a range in data x.range <- as.integer(range(dtrd[,1])) y.range <- as.integer(range(dtrd[,2])) # now expand to a grid with desired spacing grid <- expand.grid(x=seq(from=x.range[1], to=x.range[2], by=0.4), y=seq(from=y.range[1], to=y.range[2], by=1.6))
plot(grid)

# Convert to spatial data frame
coordinates(grid) = c("x", "y")
coordinates(dtrd) = c("x", "y")

# Compute cross-variogram
g <- gstat(id = "n.ae", formula = n.ae ~ + 1, data = dtrd, nmax=10) g <- gstat(g, "n.ts", n.ts ~ 1, dtrd, nmax=10)
g1 <- gstat(g, id=c("n.ae", "n.ts"), model = vgm(psill=-0.65, model="Sph", range=15, nugget=-0.05), fill.all = T) v <- variogram(g) g.fit<-fit.lmc(v, g1, correct.diagonal = 1.01)

# Plot cross-variogram with fitted model plot(v[v$id == "n.ae.n.ts",], g.fit$model[[2]], main="Cross-variogram: 
Air Entry and Saturated Water Content", xlab="Lag Distance (mm)", ylab="Semivariance (-)", ylim=c(0,-0.8))

When attempting to use the negative cross-variogram in the co-kriging plan I receive the following error message:

# Perform co-kriging predictions
ck <- predict.gstat(g1, grid)

non-positive definite coefficient matrix in structure 1non-positive definite coefficient matrix in structure 2Warning: No Intrinsic Correlation or Linear Model of Coregionalization found
Reason: coefficient matrix not positive definite
Warning: [add `set nocheck = 1;' to the command file to ignore the following error]

Error in predict.gstat(g1, grid) : 
  gstat: value not allowed for: variograms do not satisfy a legal model

I have successfully produced kriged maps of each of the parameters individually, but do not know exactly how to deal with the negative cross-variogram and resolve the issue of a non positive definite correlation matrix. I think the problem arises from using a negative sill and nugget to model the sample cross-variogram with the fit.lmc function. If I use the same code but make the sill and nugget positive I get the same fit of the model to the sample cross-variogram and a message reading : Intrinsic Correlation found. Good. [using ordinary cokriging], which I initial thought that this was a good sign, but once again I can not resolve the following error message:

# Compute cross-variogram
g <- gstat(id = "n.ae", formula = n.ae ~ + 1, data = dtrd, nmax=10) g <- gstat(g, "n.ts", n.ts ~ 1, dtrd, nmax=10)
g1 <- gstat(g, id=c("n.ae", "n.ts"), model = vgm(psill=0.65, model="Sph", range=15, nugget=0.05), fill.all = T) v <- variogram(g) g.fit<-fit.lmc(v, g1, correct.diagonal = 1.01)

# Perform co-kriging predictions
ck <- predict.gstat(g1, grid)

Intrinsic Correlation found. Good. 
[using ordinary cokriging]

ERROR: "chfactor.c", line 131: singular matrix in function LDLfactor() Error in predict.gstat(g1, grid) : LDLfactor

The gstat manual shows that this problem can be fixed by adding correct.diagonal = 1.01 to the fit.lmc function, but this does not eliminate the error message

I am very confused about all of this and would appreciate any help to fix the non positive correlation matrix so that the negative cross-variogram can be used to perform co-kriging.

Thanks in advance for any help,

Blake Roberts


From frtog at vestas.com  Wed Jan  7 07:31:39 2015
From: frtog at vestas.com (=?iso-8859-1?Q?Frede_Aakmann_T=F8gersen?=)
Date: Wed, 7 Jan 2015 07:31:39 +0100
Subject: [R-sig-Geo] Inverse distance weighting in 3 dimension using gstat
	package
Message-ID: <B078CDF40DFE4045AF172A8B4F68FC4857CB14A330@DKRDSEXC016.vestas.net>

Hi

Anyone got experiences with interpolation in 3 dimensions?

I am doing some inverse distance interpolation in 3 dimensions using the gstat package. The interpolation is based on observation at few locations (here only 2) and this is why I'm using IDW. The 3rd dimension is a scaled version of height above sea level. The parameter A physically increase by increasing height but not following any linear model.   An png file of an IDW interpolation of a parameter, A, to a 25 by 25 meter regular grid can be downloaded from https://www.dropbox.com/s/ilp4npzdhew48i6/Ainterp.png?dl=0. As you can see the interpolated values to a large extent follows the height contours of the region as wanted. But there are anomalies around the mast called "mast_1" in the upper left corner where the parameter A has higher values down-slope than at the top of the hill and further down-slope. Some sort of a ripple or wave effect.

Is this to be expected from IDW interpolation or am I doing something wrong? Your help is much appreciated.

The data can be downloaded from https://www.dropbox.com/s/ia2czqckdbjtla0/mastCFD.csv?dl=0  and https://www.dropbox.com/s/fpqt9745onlw7v0/cfd.csv?dl=0.  

Here is my R code for doing the interpolation.

### R script

library(lattice)
library(gstat)

mastCFD <- read.table("mastCFD.csv", h = TRUE, sep = ";", dec = ".")
cfd <- read.table("cfd.csv", h = TRUE, sep = ";", dec = ".")

mastCFD.gstat <- gstat(id = "A", formula = A ~ 1, locations = ~ x + y + aspZ, data = mastCFD, set = list(idp = 2))
mastCFDscale <- predict(mastCFD.gstat, cfd[,c("x","y", "aspZ")], debug.level = 0)

cfd[,"Ainterp"] <- mastCFDscale$A.pred

png("Ainterp.png", width = 1800, height = 900)

levelplot(Ainterp ~ x*y, data = cfd, aspect = myasp,
          panel = function(x,y,z,subscripts,...){
              panel.levelplot(x,y,z,subscripts,...)
              panel.contourplot(cfd$x, cfd$y, cfd$z, subscripts, region=FALSE,
                                contour=TRUE, at=pretty(cfd$z,10),
                                lwd=.3, labels = list(cex = 1))
              panel.points(mastCFD$x, mastCFD$y, pch=19,col ="black", cex=1.1*1.5,lwd=.3)
              panel.points(mastCFD$x, mastCFD$y, pch=19, col ="red",cex=0.4*1.5)
          }, col.regions = terrain.colors,
          ylab = "Northings (m)", xlab = "Eastings (m)")

dev.off()

Yours sincerely / Med venlig hilsen


Frede Aakmann T?gersen
Specialist, M.Sc., Ph.D.
Plant Performance & Modeling

Technology & Service Solutions
T +45 9730 5135
M +45 2547 6050
frtog at vestas.com
http://www.vestas.com

Company reg. name: Vestas Wind Systems A/S
This e-mail is subject to our e-mail disclaimer statement.
Please refer to www.vestas.com/legal/notice
If you have received this e-mail in error please contact the sender. 


From learoser at gmail.com  Wed Jan  7 07:43:29 2015
From: learoser at gmail.com (Leandro Roser)
Date: Wed, 7 Jan 2015 03:43:29 -0300
Subject: [R-sig-Geo] Problem with moran.mc() in spdep package
Message-ID: <CAJkJCp4Jf_KCo4aDEzaQdaL3GHkBAcFZO=KF+7+uiG6V210fEA@mail.gmail.com>

Hello everyone. I'm new in this group. I will appreciate any
suggestion for solving the following problem.
I am using the package spdep, with the purpose computing bootstraped
values of  Moran's I over a range of geographical distances.  The
weighing matrix for each range was obtained with the package adegenet:

library(adegenet)
library(spdep)


xy<-c(381739,383080,396833,397637,379144,379347,379488,379543,380018,380064,380085,380138,380277,380334,380404,380968,381037,399015,399029,398980,399013,399083,399209,399285,399351,399389,399427,399485,399526,399545,399590,399545,399528,399350,399348,399300,399222,399127,399119,399087,399063,399024,399154,399193,399187,399185,399173,399124,399082,399122,399081,399003,398982,398946,398900,398893,398860,398908,398897,398908,398941,398924,398972,399043,399034,399015,399048,402002,402120,401403,399127,398471,398196,397346,396927,396472,394941,411075,410840,410705,410602,410321,410364,410233,410230,410209,410217,410221,410266,410364,410444,410401,410431,410513,410480,410414,410347,410385,410417,410430,410465,410367,410259,410268,410334,410328,410344,410341,410398,410408,410352,410498,410315,410233,410183,410210,410215,410246,410481,410494,390915,395462,378616,378898,378972,379005,379024,379055,379080,379122,379199,379254,379404,379402,404070,403921,403531,403027,414950,414867,414685,414587,414454,414011,413896,413804,413597,413513,413474,413414,413473,413217,413099,412908,412837,410570,378883,379124,379330,384327,384735,385000,385116,387763,385189,385298,385419,387738,387935,393172,394798,377709,377633,377478,377469,377486,377498,377523,377541,377562,377592,377620,377664,377683,377737,377773,377838,377883,378099,378135,378208,378516,6925207,6923900,6904017,6903938,6899689,6898704,6897820,6897673,6895093,6894715,6894596,6894417,6893664,6893358,6892984,6891698,6891385,6908553,6908485,6908457,6908424,6908510,6908558,6908540,6908537,6908522,6908562,6908557,6908533,6908484,6908587,6908630,6908688,6908649,6908583,6908675,6908720,6908546,6908592,6908651,6908703,6908824,6908684,6908731,6908775,6908831,6908882,6908884,6908907,6908955,6908994,6909005,6908881,6908964,6909071,6909110,6909215,6909170,6909087,6908999,6908918,6909204,6909196,6909165,6909115,6909066,6909028,6918317,6918254,6918655,6919937,6920385,6920528,6921056,6921354,6921611,6922552,6910046,6909714,6909495,6909328,6910006,6910111,6910101,6910064,6909673,6909630,6909439,6909368,6909345,6909339,6909237,6909517,6909536,6909604,6909616,6909791,6909902,6909985,6910059,6910096,6910151,6909876,6910196,6909415,6909504,6909554,6909591,6909603,6909702,6909858,6910075,6910067,6909747,6909774,6909922,6909968,6910150,6909847,6909943,6910899,6906497,6912776,6912329,6911976,6911662,6911381,6911210,6911059,6910730,6910494,6910306,6909713,6909620,6917160,6917244,6917468,6917746,6909363,6909406,6909513,6909567,6909647,6910024,6910181,6910330,6910584,6910708,6910822,6910898,6911012,6911214,6911321,6911614,6911690,6913180,6927706,6927573,6927499,6922144,6921488,6921083,6920895,6916349,6920789,6920632,6920453,6916581,6915727,6903415,6903553,6918153,6917985,6917619,6917449,6917261,6917044,6916877,6916742,6916548,6916181,6915971,6915724,6915572,6915110,6914943,6914747,6914650,6914112,6913978,6913765,6912930)

xy<-matrix(xy,192,2)

VAR<-c(0.39,0.38,0.39,0.28,0.32,0.29,0.46,0.32,0.33,0.29,0.33,0.31,0.35,0.36,0.39,0.48,0.42,0.47,0.34,0.38,0.42,0.42,0.71,0.71,0.57,0.55,0.56,0.6,0.59,0.58,0.65,0.66,0.6,0.58,0.57,0.57,0.56,0.65,0.68,0.69,0.67,0.66,0.63,0.6,0.61,0.63,0.62,0.63,0.64,0.64,0.63,0.61,0.67,0.66,0.68,0.68,0.62,0.65,0.68,0.66,0.66,0.6,0.54,0.58,0.58,0.59,0.58,0.22,0.38,0.38,0.35,0.35,0.26,0.33,0.45,0.44,0.24,0.29,0.37,0.34,0.4,0.47,0.5,0.52,0.51,0.42,0.44,0.6,0.46,0.36,0.32,0.58,0.42,0.27,0.24,0.41,0.3,0.43,0.46,0.48,0.52,0.54,0.34,0.6,0.55,0.63,0.59,0.58,0.41,0.29,0.33,0.5,0.49,0.29,0.32,0.4,0.5,0.56,0.42,0.48,0.27,0.27,0.33,0.32,0.38,0.36,0.37,0.44,0.47,0.33,0.34,0.37,0.34,0.41,0.53,0.47,0.41,0.5,0.35,0.41,0.38,0.42,0.36,0.35,0.35,0.36,0.28,0.26,0.26,0.3,0.32,0.23,0.32,0.45,0.35,0.31,0.48,0.38,0.5,0.42,0.31,0.38,0.42,0.53,0.37,0.44,0.49,0.49,0.48,0.3,0.6,0.29,0.32,0.3,0.33,0.26,0.33,0.43,0.37,0.29,0.27,0.32,0.27,0.32,0.36,0.37,0.32,0.36,0.3,0.39,0.34,0.29)


lista<-chooseCN(xy,type=5,d1=5,d2=50, result.type = "listw",plot.nb = F)
#listw object obtained with adegenet


moran.mc(VAR,lista,999,na.action = na.exclude, zero.policy = T)

# Monte-Carlo simulation of Moran's I

#data:  VAR
#weights: lista
#number of simulations + 1: 1000
#
#*statistic = 1.2597*, observed rank = 1000, p-value = 0.001
#alternative hypothesis: greater


#How can I intepret this result (Moran >1)?  Extracting the values in the
object "lista", I obtained:

print(lista,zero.policy=TRUE)
#n   nn S0 S1  S2
#W 39 1521 39 69 162

#And using these parameters in the function moran():

moran(VAR,lista,39,39, zero.policy =T)
#$I
#[1] *0.2558731*
#
#$K
#[1] 1.911139

#The result of moran() is different of the obtained with moran.mc (and is
not higher than 1). Might be a problem in the moran.mc() function?

Thanks in advance,

  Leandro.







-- 
Lic. Leandro Gabriel Roser
 Laboratorio de Gen?tica
 Dto. de Ecolog?a, Gen?tica y Evoluci?n,
 F.C.E.N., U.B.A.,
 Ciudad Universitaria, PB II, 4to piso,
 Nu?ez, Cdad. Aut?noma de Buenos Aires,
 Argentina.
 tel ++54 +11 4576-3300 (ext 219)
 fax ++54 +11 4576-3384

	[[alternative HTML version deleted]]


From edzer.pebesma at uni-muenster.de  Wed Jan  7 09:08:57 2015
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 07 Jan 2015 09:08:57 +0100
Subject: [R-sig-Geo] GSTAT Co-Kriging: How can i fix a non positive
 definte correlation matrix
In-Reply-To: <BLUPR02MB083664C2493C69AA277823EF9590@BLUPR02MB083.namprd02.prod.outlook.com>
References: <BLUPR02MB083664C2493C69AA277823EF9590@BLUPR02MB083.namprd02.prod.outlook.com>
Message-ID: <54ACE999.8010904@uni-muenster.de>

First: you don't provide us with a reproducible example. I know this is
a bit of work for your case, but it may be worth it. For instance, in
the text below several R commands appear on a single line, which is
syntactically an error.

Second: the error message you get may come from different reasons, one
of them being near-perfect correlation among variables, but you seem to
have prevented this with argument correct.diagonal; have you tried a
slightly larger value? Another cause may be duplicate or near duplicate
observations; sp::zerodist may be useful here.

On 01/06/2015 10:52 PM, Roberts, Blake wrote:
> QUESTION: Can anyone give me advice on how to resolve an error message regarding a non positive definite correlation matrix so that the computed negative cross-variogram can be used to perform co-kriging?
> 
> I am performing co-kriging on negatively correlated parameters. 
> 
> data = dtrd 
> 
> x	y	n.ts	n.ae
> 3.2	6.4	-0.052514693	0.055104755
> 6.4	6.4	-0.375234492	-0.861381682
> 9.6	6.4	1.362810557	-0.23577909
> 12.8	6.4	-0.333087778	0.134741672
> 16	6.4	0.699916885	-2.348188189
> 22.4	6.4	0.605552409	-0.75492334
> 25.6	6.4	0.406868496	0.329847607
> 3.2	9.6	-0.529754386	0.251549504
> 6.4	9.6	-0.416509276	1.094807283
> 9.6	9.6	-0.450700276	0.988002955
> 12.8	9.6	-0.732937251	1.344413512
> 16	9.6	0.377457633	-0.542187169
> 19.2	9.6	-0.989029229	2.002433474
> 22.4	9.6	-1.259551904	-0.895859924
> 25.6	9.6	-0.470220669	0.370809323
> 3.2	12.8	1.046426438	0.168121785
> 6.4	12.8	-1.440639861	1.423433672
> 9.6	12.8	-0.899563555	0.83844681
> 12.8	12.8	-1.287567164	-0.086478673
> 16	12.8	-0.816931437	1.156633451
> 19.2	12.8	-0.782655308	0.299641538
> 22.4	12.8	0.048342822	-0.763091614
> 3.2	16	-0.5581308	-0.130509134
> 6.4	16	-0.217874377	0.815852429
> 9.6	16	-0.272702769	0.906621066
> 12.8	16	-0.996064	0.274459785
> 16	16	-1.97520507	2.017626766
> 19.2	16	-0.718163458	0.444173367
> 22.4	16	0.337266312	0.831151021
> 25.6	16	-0.565668608	0.513114809
> 3.2	19.2	0.651736313	-0.055114304
> 6.4	19.2	-0.715751462	0.205488257
> 9.6	19.2	0.650820529	0.558032798
> 12.8	19.2	-1.184380204	0.612006591
> 16	19.2	0.132388601	0.462059331
> 19.2	19.2	1.08502868	0.399240335
> 22.4	19.2	-0.85196341	0.113079949
> 25.6	19.2	0.099887288	-1.922971577
> 3.2	22.4	-0.233091874	-0.287556625
> 6.4	22.4	-0.989196908	0.10047403
> 9.6	22.4	-0.025054063	0.384754057
> 12.8	22.4	-0.394999955	-1.272051846
> 16	22.4	0.049839033	-2.568551091
> 19.2	22.4	1.327518037	-0.974203156
> 22.4	22.4	-0.421157849	-0.0101211
> 25.6	22.4	-0.178717505	0.408401438
> 3.2	25.6	-0.065413063	-0.195765074
> 6.4	25.6	1.167410569	-1.626236059
> 9.6	25.6	0.428968564	-1.287922066
> 12.8	25.6	1.550074254	-1.011990828
> 16	25.6	2.931334909	-1.872352342
> 19.2	25.6	4.126464345	-2.254471152
> 22.4	25.6	0.44561262	-0.709554064
> 25.6	25.6	0.543591219	1.03999109
> 3.2	28.8	0.716228164	-0.671315106
> 6.4	28.8	1.856183532	-1.403466298
> 9.6	28.8	0.774644882	-0.952601604
> 12.8	28.8	0.425336383	-0.776073605
> 16	28.8	0.294908064	-0.00019281
> 19.2	28.8	2.38260471	-0.778811406
> 22.4	28.8	-0.315391214	-0.223383771
> 25.6	28.8	1.136916243	-0.238938091
> 3.2	32	-0.233091874	-0.520269718
> 6.4	32	-0.352017426	-0.556041646
> 9.6	32	-0.933099317	-0.441354858
> 16	32	-0.865945243	-1.011088256
> 19.2	32	-0.594339105	-0.399550741
> 22.4	32	-0.653328511	1.213119402
> 25.6	32	0.076670222	0.819568017
> 3.2	35.2	-0.14022361	0.166527242
> 6.4	35.2	-0.545492977	-0.613535469
> 9.6	35.2	-0.084386566	-0.423754708
> 12.8	35.2	2.107283841	-0.891753223
> 16	35.2	-1.645006796	0.566968259
> 22.4	35.2	0.512684145	0.515250895
> 25.6	35.2	0.517794479	-1.144578624
> 3.2	38.4	-0.359495901	0.191964723
> 6.4	38.4	0.548288806	-1.011825356
> 9.6	38.4	-0.597741695	0.046560408
> 12.8	38.4	-1.003803022	0.319904274
> 16	38.4	0.060157729	0.824035747
> 19.2	38.4	0.251793973	0.632946256
> 22.4	38.4	-1.148625922	1.257360463
> 25.6	38.4	-0.957779058	0.30201831
> 3.2	41.6	0.267364885	1.139304073
> 6.4	41.6	0.171656399	0.623288738
> 9.6	41.6	-0.912461925	0.820049388
> 12.8	41.6	-0.645228334	1.041375034
> 16	41.6	0.83148026	2.914000894
> 19.2	41.6	-1.187664129	2.756035789
> 22.4	41.6	-0.467591981	0.467880919
> 25.6	41.6	-0.121964677	0.878460826
> 3.2	44.8	-0.158281328	-0.266451488
> 6.4	44.8	-0.235932095	1.440612621
> 12.8	44.8	-0.436274739	-0.298237058
> 16	44.8	-1.136811015	-0.688794913
> 19.2	44.8	0.87349541	0.449964869
> 22.4	44.8	-0.661067533	-0.08882536
> 25.6	44.8	0.301101862	-0.255259598
> 3.2	48	1.265698729	0.948786211
> 6.4	48	-0.806040053	0.352201302
> 9.6	48	1.006815543	1.12999254
> 12.8	48	-0.0132082	0.581935908
> 16	48	-1.214201235	1.431842632
> 19.2	48	-0.323473333	-0.083379843
> 22.4	48	-0.003250658	-0.248324838
> 25.6	48	-0.168398809	-0.916859761
> 3.2	51.2	-0.854793312	-0.231928117
> 6.4	51.2	0.507014021	-0.49107152
> 9.6	51.2	3.104090518	-2.654897126
> 12.8	51.2	-0.193785381	0.067244345
> 16	51.2	-0.71632415	-1.46047875
> 19.2	51.2	2.480632323	-0.336852087
> 22.4	51.2	-0.534663506	-1.093553232
> 25.6	51.2	-0.124544351	-0.603005465
> 
> Using the following code I compute a negative cross-variogram:
> 
> dtrd = as.data.frame(dtrd)
> # create a grid onto which i will interpolate # first get a range in data x.range <- as.integer(range(dtrd[,1])) y.range <- as.integer(range(dtrd[,2])) # now expand to a grid with desired spacing grid <- expand.grid(x=seq(from=x.range[1], to=x.range[2], by=0.4), y=seq(from=y.range[1], to=y.range[2], by=1.6))
> plot(grid)
> 
> # Convert to spatial data frame
> coordinates(grid) = c("x", "y")
> coordinates(dtrd) = c("x", "y")
> 
> # Compute cross-variogram
> g <- gstat(id = "n.ae", formula = n.ae ~ + 1, data = dtrd, nmax=10) g <- gstat(g, "n.ts", n.ts ~ 1, dtrd, nmax=10)
> g1 <- gstat(g, id=c("n.ae", "n.ts"), model = vgm(psill=-0.65, model="Sph", range=15, nugget=-0.05), fill.all = T) v <- variogram(g) g.fit<-fit.lmc(v, g1, correct.diagonal = 1.01)
> 
> # Plot cross-variogram with fitted model plot(v[v$id == "n.ae.n.ts",], g.fit$model[[2]], main="Cross-variogram: 
> Air Entry and Saturated Water Content", xlab="Lag Distance (mm)", ylab="Semivariance (-)", ylim=c(0,-0.8))
> 
> When attempting to use the negative cross-variogram in the co-kriging plan I receive the following error message:
> 
> # Perform co-kriging predictions
> ck <- predict.gstat(g1, grid)
> 
> non-positive definite coefficient matrix in structure 1non-positive definite coefficient matrix in structure 2Warning: No Intrinsic Correlation or Linear Model of Coregionalization found
> Reason: coefficient matrix not positive definite
> Warning: [add `set nocheck = 1;' to the command file to ignore the following error]
> 
> Error in predict.gstat(g1, grid) : 
>   gstat: value not allowed for: variograms do not satisfy a legal model
> 
> I have successfully produced kriged maps of each of the parameters individually, but do not know exactly how to deal with the negative cross-variogram and resolve the issue of a non positive definite correlation matrix. I think the problem arises from using a negative sill and nugget to model the sample cross-variogram with the fit.lmc function. If I use the same code but make the sill and nugget positive I get the same fit of the model to the sample cross-variogram and a message reading : Intrinsic Correlation found. Good. [using ordinary cokriging], which I initial thought that this was a good sign, but once again I can not resolve the following error message:
> 
> # Compute cross-variogram
> g <- gstat(id = "n.ae", formula = n.ae ~ + 1, data = dtrd, nmax=10) g <- gstat(g, "n.ts", n.ts ~ 1, dtrd, nmax=10)
> g1 <- gstat(g, id=c("n.ae", "n.ts"), model = vgm(psill=0.65, model="Sph", range=15, nugget=0.05), fill.all = T) v <- variogram(g) g.fit<-fit.lmc(v, g1, correct.diagonal = 1.01)
> 
> # Perform co-kriging predictions
> ck <- predict.gstat(g1, grid)
> 
> Intrinsic Correlation found. Good. 
> [using ordinary cokriging]
> 
> ERROR: "chfactor.c", line 131: singular matrix in function LDLfactor() Error in predict.gstat(g1, grid) : LDLfactor
> 
> The gstat manual shows that this problem can be fixed by adding correct.diagonal = 1.01 to the fit.lmc function, but this does not eliminate the error message
> 
> I am very confused about all of this and would appreciate any help to fix the non positive correlation matrix so that the negative cross-variogram can be used to perform co-kriging.
> 
> Thanks in advance for any help,
> 
> Blake Roberts
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma,  Co-Editor-in-Chief Computers & Geosciences
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150107/ce8ba836/attachment.bin>

From edzer.pebesma at uni-muenster.de  Wed Jan  7 09:30:46 2015
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 07 Jan 2015 09:30:46 +0100
Subject: [R-sig-Geo] Inverse distance weighting in 3 dimension using
 gstat package
In-Reply-To: <B078CDF40DFE4045AF172A8B4F68FC4857CB14A330@DKRDSEXC016.vestas.net>
References: <B078CDF40DFE4045AF172A8B4F68FC4857CB14A330@DKRDSEXC016.vestas.net>
Message-ID: <54ACEEB6.1070804@uni-muenster.de>

3D interpolation projected on irregular 2D is always somewhat tricky to
comprehend. After looking at the plot, I tried:

> library(sp)
> pts = SpatialPoints(mastCFD[c("x", "y")])
> grd = cfd
> gridded(grd) = ~x+y
> over(pts,grd)
         z   vxymag     aspZ  Ainterp
1 877.9992 11.70016 75491.32 4.700857
2 902.3500 13.44538 77585.03 4.669962
> mastCFD
       x       y      z                           mast     A     aspZ
1 586987 1566348 788.82 MASTBenakanahalli1_78_0m___Ch2 4.766 67823.60
2 591592 1562582 808.44 MASTBenakanahalli2_78_0m___Ch2 4.622 69510.55

and wondered why mastCFD$z is different from the cfd$z values at the
corresponding locations.


On 01/07/2015 07:31 AM, Frede Aakmann T?gersen wrote:
> Hi
> 
> Anyone got experiences with interpolation in 3 dimensions?
> 
> I am doing some inverse distance interpolation in 3 dimensions using the gstat package. The interpolation is based on observation at few locations (here only 2) and this is why I'm using IDW. The 3rd dimension is a scaled version of height above sea level. The parameter A physically increase by increasing height but not following any linear model.   An png file of an IDW interpolation of a parameter, A, to a 25 by 25 meter regular grid can be downloaded from https://www.dropbox.com/s/ilp4npzdhew48i6/Ainterp.png?dl=0. As you can see the interpolated values to a large extent follows the height contours of the region as wanted. But there are anomalies around the mast called "mast_1" in the upper left corner where the parameter A has higher values down-slope than at the top of the hill and further down-slope. Some sort of a ripple or wave effect.
> 
> Is this to be expected from IDW interpolation or am I doing something wrong? Your help is much appreciated.
> 
> The data can be downloaded from https://www.dropbox.com/s/ia2czqckdbjtla0/mastCFD.csv?dl=0  and https://www.dropbox.com/s/fpqt9745onlw7v0/cfd.csv?dl=0.  
> 
> Here is my R code for doing the interpolation.
> 
> ### R script
> 
> library(lattice)
> library(gstat)
> 
> mastCFD <- read.table("mastCFD.csv", h = TRUE, sep = ";", dec = ".")
> cfd <- read.table("cfd.csv", h = TRUE, sep = ";", dec = ".")
> 
> mastCFD.gstat <- gstat(id = "A", formula = A ~ 1, locations = ~ x + y + aspZ, data = mastCFD, set = list(idp = 2))
> mastCFDscale <- predict(mastCFD.gstat, cfd[,c("x","y", "aspZ")], debug.level = 0)
> 
> cfd[,"Ainterp"] <- mastCFDscale$A.pred
> 
> png("Ainterp.png", width = 1800, height = 900)
> 
> levelplot(Ainterp ~ x*y, data = cfd, aspect = myasp,
>           panel = function(x,y,z,subscripts,...){
>               panel.levelplot(x,y,z,subscripts,...)
>               panel.contourplot(cfd$x, cfd$y, cfd$z, subscripts, region=FALSE,
>                                 contour=TRUE, at=pretty(cfd$z,10),
>                                 lwd=.3, labels = list(cex = 1))
>               panel.points(mastCFD$x, mastCFD$y, pch=19,col ="black", cex=1.1*1.5,lwd=.3)
>               panel.points(mastCFD$x, mastCFD$y, pch=19, col ="red",cex=0.4*1.5)
>           }, col.regions = terrain.colors,
>           ylab = "Northings (m)", xlab = "Eastings (m)")
> 
> dev.off()
> 
> Yours sincerely / Med venlig hilsen
> 
> 
> Frede Aakmann T?gersen
> Specialist, M.Sc., Ph.D.
> Plant Performance & Modeling
> 
> Technology & Service Solutions
> T +45 9730 5135
> M +45 2547 6050
> frtog at vestas.com
> http://www.vestas.com
> 
> Company reg. name: Vestas Wind Systems A/S
> This e-mail is subject to our e-mail disclaimer statement.
> Please refer to www.vestas.com/legal/notice
> If you have received this e-mail in error please contact the sender. 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma,  Co-Editor-in-Chief Computers & Geosciences
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150107/489a5c36/attachment.bin>

From Roger.Bivand at nhh.no  Wed Jan  7 09:50:57 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 7 Jan 2015 09:50:57 +0100
Subject: [R-sig-Geo] Problem with moran.mc() in spdep package
In-Reply-To: <CAJkJCp4Jf_KCo4aDEzaQdaL3GHkBAcFZO=KF+7+uiG6V210fEA@mail.gmail.com>
References: <CAJkJCp4Jf_KCo4aDEzaQdaL3GHkBAcFZO=KF+7+uiG6V210fEA@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1501070947030.7467@reclus.nhh.no>

Please provide the xy and VAR objects in a form that permits 
reproduction, for example using dput(), and/or post only plain text. The 
present rendering in most email clients does not permit copy&paste.

Roger

On Wed, 7 Jan 2015, Leandro Roser wrote:

> Hello everyone. I'm new in this group. I will appreciate any
> suggestion for solving the following problem.
> I am using the package spdep, with the purpose computing bootstraped
> values of  Moran's I over a range of geographical distances.  The
> weighing matrix for each range was obtained with the package adegenet:
>
> library(adegenet)
> library(spdep)
>
>
xy<-c(381739,383080,396833,397637,379144,379347,379488,379543,380018,380064,380085,380138,380277,380334,380404,380968,381037,399015,399029,398980,399013,399083,399209,399285,399351,399389,399427,399485,399526,399545,399590,399545,399528,399350,399348,399300,399222,399127,399119,399087,399063,399024,399154,399193,399187,399185,399173,399124,399082,399122,399081,399003,398982,398946,398900,398893,398860,398908,398897,398908,398941,398924,398972,399043,399034,399015,399048,402002,402120,401403,399127,398471,398196,397346,396927,396472,394941,411075,410840,410705,410602,410321,410364,410233,410230,410209,410217,410221,410266,410364,410444,410401,410431,410513,410480,410414,410347,410385,410417,410430,410465,410367,410259,410268,410334,410328,410344,410341,410398,410408,410352,410498,410315,410233,410183,410210,410215,410246,410481,410494,390915,395462,378616,378898,378972,379005,379024,379055,379080,379122,379199,379254,379404,379402,404070,403921,403531,403027,414950,414867,414685,414587,414454,414011,413896,413804,413597,413513,413474,413414,413473,413217,413099,412908,412837,410570,378883,379124,379330,384327,384735,385000,385116,387763,385189,385298,385419,387738,387935,393172,394798,377709,377633,377478,377469,377486,377498,377523,377541,377562,377592,377620,377664,377683,377737,377773,377838,377883,378099,378135,378208,378516,6925207,6923900,6904017,6903938,6899689,6898704,6897820,6897673,6895093,6894715,6894596,6894417,6893664,6893358,6892984,6891698,6891385,6908553,6908485,6908457,6908424,6908510,6908558,6908540,6908537,6908522,6908562,6908557,6908533,6908484,6908587,6908630,6908688,6908649,6908583,6908675,6908720,6908546,6908592,6908651,6908703,6908824,6908684,6908731,6908775,6908831,6908882,6908884,6908907,6908955,6908994,6909005,6908881,6908964,6909071,6909110,6909215,6909170,6909087,6908999,6908918,6909204,6909196,6909165,6909115,6909066,6909028,6918317,6918254,6918655,6919937,6920385,6920528,6921056,6921354,6921611,6922552,6910046,6909714,6909495,6909328,6910006,6910111,6910101,6910064,6909673,6909630,6909439,6909368,6909345,6909339,6909237,6909517,6909536,6909604,6909616,6909791,6909902,6909985,6910059,6910096,6910151,6909876,6910196,6909415,6909504,6909554,6909591,6909603,6909702,6909858,6910075,6910067,6909747,6909774,6909922,6909968,6910150,6909847,6909943,6910899,6906497,6912776,6912329,6911976,6911662,6911381,6911210,6911059,6910730,6910494,6910306,6909713,6909620,6917160,6917244,6917468,6917746,6909363,6909406,6909513,6909567,6909647,6910024,6910181,6910330,6910584,6910708,6910822,6910898,6911012,6911214,6911321,6911614,6911690,6913180,6927706,6927573,6927499,6922144,6921488,6921083,6920895,6916349,6920789,6920632,6920453,6916581,6915727,6903415,6903553,6918153,6917985,6917619,6917449,6917261,6917044,6916877,6916742,6916548,6916181,6915971,6915724,6915572,6915110,6914943,6914747,6914650,6914112,6913978,6913765,6912930)

>
> xy<-matrix(xy,192,2)
>
> VAR<-c(0.39,0.38,0.39,0.28,0.32,0.29,0.46,0.32,0.33,0.29,0.33,0.31,0.35,0.36,0.39,0.48,0.42,0.47,0.34,0.38,0.42,0.42,0.71,0.71,0.57,0.55,0.56,0.6,0.59,0.58,0.65,0.66,0.6,0.58,0.57,0.57,0.56,0.65,0.68,0.69,0.67,0.66,0.63,0.6,0.61,0.63,0.62,0.63,0.64,0.64,0.63,0.61,0.67,0.66,0.68,0.68,0.62,0.65,0.68,0.66,0.66,0.6,0.54,0.58,0.58,0.59,0.58,0.22,0.38,0.38,0.35,0.35,0.26,0.33,0.45,0.44,0.24,0.29,0.37,0.34,0.4,0.47,0.5,0.52,0.51,0.42,0.44,0.6,0.46,0.36,0.32,0.58,0.42,0.27,0.24,0.41,0.3,0.43,0.46,0.48,0.52,0.54,0.34,0.6,0.55,0.63,0.59,0.58,0.41,0.29,0.33,0.5,0.49,0.29,0.32,0.4,0.5,0.56,0.42,0.48,0.27,0.27,0.33,0.32,0.38,0.36,0.37,0.44,0.47,0.33,0.34,0.37,0.34,0.41,0.53,0.47,0.41,0.5,0.35,0.41,0.38,0.42,0.36,0.35,0.35,0.36,0.28,0.26,0.26,0.3,0.32,0.23,0.32,0.45,0.35,0.31,0.48,0.38,0.5,0.42,0.31,0.38,0.42,0.53,0.37,0.44,0.49,0.49,0.48,0.3,0.6,0.29,0.32,0.3,0.33,0.26,0.33,0.43,0.37,0.29,0.27,0.32,0.27,0.32,0.36,0.37,0.32,0.36,0.3,0.39,0.34,0.29)
>
>
> lista<-chooseCN(xy,type=5,d1=5,d2=50, result.type = "listw",plot.nb = F)
> #listw object obtained with adegenet
>
>
> moran.mc(VAR,lista,999,na.action = na.exclude, zero.policy = T)
>
> # Monte-Carlo simulation of Moran's I
>
> #data:  VAR
> #weights: lista
> #number of simulations + 1: 1000
> #
> #*statistic = 1.2597*, observed rank = 1000, p-value = 0.001
> #alternative hypothesis: greater
>
>
> #How can I intepret this result (Moran >1)?  Extracting the values in the
> object "lista", I obtained:
>
> print(lista,zero.policy=TRUE)
> #n   nn S0 S1  S2
> #W 39 1521 39 69 162
>
> #And using these parameters in the function moran():
>
> moran(VAR,lista,39,39, zero.policy =T)
> #$I
> #[1] *0.2558731*
> #
> #$K
> #[1] 1.911139
>
> #The result of moran() is different of the obtained with moran.mc (and is
> not higher than 1). Might be a problem in the moran.mc() function?
>
> Thanks in advance,
>
>  Leandro.
>
>
>
>
>
>
>
> -- 
> Lic. Leandro Gabriel Roser
> Laboratorio de Gen?tica
> Dto. de Ecolog?a, Gen?tica y Evoluci?n,
> F.C.E.N., U.B.A.,
> Ciudad Universitaria, PB II, 4to piso,
> Nu?ez, Cdad. Aut?noma de Buenos Aires,
> Argentina.
> tel ++54 +11 4576-3300 (ext 219)
> fax ++54 +11 4576-3384
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no

From Roger.Bivand at nhh.no  Wed Jan  7 10:29:27 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 7 Jan 2015 10:29:27 +0100
Subject: [R-sig-Geo] Problem with moran.mc() in spdep package
In-Reply-To: <alpine.LRH.2.03.1501070947030.7467@reclus.nhh.no>
References: <CAJkJCp4Jf_KCo4aDEzaQdaL3GHkBAcFZO=KF+7+uiG6V210fEA@mail.gmail.com>
	<alpine.LRH.2.03.1501070947030.7467@reclus.nhh.no>
Message-ID: <alpine.LRH.2.03.1501071001010.7467@reclus.nhh.no>

On Wed, 7 Jan 2015, Roger Bivand wrote:

> Please provide the xy and VAR objects in a form that permits reproduction, 
> for example using dput(), and/or post only plain text. The present rendering 
> in most email clients does not permit copy&paste.
>
> Roger

Oh, well (copying & pasting from the list archive rendering) - comments 
below:

VAR <- c(0.39, 0.38, 0.39, 0.28, 0.32, 0.29, 0.46, 0.32, 0.33, 0.29,
0.33, 0.31, 0.35, 0.36, 0.39, 0.48, 0.42, 0.47, 0.34, 0.38, 0.42,
0.42, 0.71, 0.71, 0.57, 0.55, 0.56, 0.6, 0.59, 0.58, 0.65, 0.66,
0.6, 0.58, 0.57, 0.57, 0.56, 0.65, 0.68, 0.69, 0.67, 0.66, 0.63,
0.6, 0.61, 0.63, 0.62, 0.63, 0.64, 0.64, 0.63, 0.61, 0.67, 0.66,
0.68, 0.68, 0.62, 0.65, 0.68, 0.66, 0.66, 0.6, 0.54, 0.58, 0.58,
0.59, 0.58, 0.22, 0.38, 0.38, 0.35, 0.35, 0.26, 0.33, 0.45, 0.44,
0.24, 0.29, 0.37, 0.34, 0.4, 0.47, 0.5, 0.52, 0.51, 0.42, 0.44,
0.6, 0.46, 0.36, 0.32, 0.58, 0.42, 0.27, 0.24, 0.41, 0.3, 0.43,
0.46, 0.48, 0.52, 0.54, 0.34, 0.6, 0.55, 0.63, 0.59, 0.58, 0.41,
0.29, 0.33, 0.5, 0.49, 0.29, 0.32, 0.4, 0.5, 0.56, 0.42, 0.48,
0.27, 0.27, 0.33, 0.32, 0.38, 0.36, 0.37, 0.44, 0.47, 0.33, 0.34,
0.37, 0.34, 0.41, 0.53, 0.47, 0.41, 0.5, 0.35, 0.41, 0.38, 0.42,
0.36, 0.35, 0.35, 0.36, 0.28, 0.26, 0.26, 0.3, 0.32, 0.23, 0.32,
0.45, 0.35, 0.31, 0.48, 0.38, 0.5, 0.42, 0.31, 0.38, 0.42, 0.53,
0.37, 0.44, 0.49, 0.49, 0.48, 0.3, 0.6, 0.29, 0.32, 0.3, 0.33,
0.26, 0.33, 0.43, 0.37, 0.29, 0.27, 0.32, 0.27, 0.32, 0.36, 0.37,
0.32, 0.36, 0.3, 0.39, 0.34, 0.29)

# the matrix
xy <- structure(c(381739, 383080, 396833, 397637, 379144, 379347,
  379488,
379543, 380018, 380064, 380085, 380138, 380277, 380334, 380404,
380968, 381037, 399015, 399029, 398980, 399013, 399083, 399209,
399285, 399351, 399389, 399427, 399485, 399526, 399545, 399590,
399545, 399528, 399350, 399348, 399300, 399222, 399127, 399119,
399087, 399063, 399024, 399154, 399193, 399187, 399185, 399173,
399124, 399082, 399122, 399081, 399003, 398982, 398946, 398900,
398893, 398860, 398908, 398897, 398908, 398941, 398924, 398972,
399043, 399034, 399015, 399048, 402002, 402120, 401403, 399127,
398471, 398196, 397346, 396927, 396472, 394941, 411075, 410840,
410705, 410602, 410321, 410364, 410233, 410230, 410209, 410217,
410221, 410266, 410364, 410444, 410401, 410431, 410513, 410480,
410414, 410347, 410385, 410417, 410430, 410465, 410367, 410259,
410268, 410334, 410328, 410344, 410341, 410398, 410408, 410352,
410498, 410315, 410233, 410183, 410210, 410215, 410246, 410481,
410494, 390915, 395462, 378616, 378898, 378972, 379005, 379024,
379055, 379080, 379122, 379199, 379254, 379404, 379402, 404070,
403921, 403531, 403027, 414950, 414867, 414685, 414587, 414454,
414011, 413896, 413804, 413597, 413513, 413474, 413414, 413473,
413217, 413099, 412908, 412837, 410570, 378883, 379124, 379330,
384327, 384735, 385000, 385116, 387763, 385189, 385298, 385419,
387738, 387935, 393172, 394798, 377709, 377633, 377478, 377469,
377486, 377498, 377523, 377541, 377562, 377592, 377620, 377664,
377683, 377737, 377773, 377838, 377883, 378099, 378135, 378208,
378516, 6925207, 6923900, 6904017, 6903938, 6899689, 6898704,
6897820, 6897673, 6895093, 6894715, 6894596, 6894417, 6893664,
6893358, 6892984, 6891698, 6891385, 6908553, 6908485, 6908457,
6908424, 6908510, 6908558, 6908540, 6908537, 6908522, 6908562,
6908557, 6908533, 6908484, 6908587, 6908630, 6908688, 6908649,
6908583, 6908675, 6908720, 6908546, 6908592, 6908651, 6908703,
6908824, 6908684, 6908731, 6908775, 6908831, 6908882, 6908884,
6908907, 6908955, 6908994, 6909005, 6908881, 6908964, 6909071,
6909110, 6909215, 6909170, 6909087, 6908999, 6908918, 6909204,
6909196, 6909165, 6909115, 6909066, 6909028, 6918317, 6918254,
6918655, 6919937, 6920385, 6920528, 6921056, 6921354, 6921611,
6922552, 6910046, 6909714, 6909495, 6909328, 6910006, 6910111,
6910101, 6910064, 6909673, 6909630, 6909439, 6909368, 6909345,
6909339, 6909237, 6909517, 6909536, 6909604, 6909616, 6909791,
6909902, 6909985, 6910059, 6910096, 6910151, 6909876, 6910196,
6909415, 6909504, 6909554, 6909591, 6909603, 6909702, 6909858,
6910075, 6910067, 6909747, 6909774, 6909922, 6909968, 6910150,
6909847, 6909943, 6910899, 6906497, 6912776, 6912329, 6911976,
6911662, 6911381, 6911210, 6911059, 6910730, 6910494, 6910306,
6909713, 6909620, 6917160, 6917244, 6917468, 6917746, 6909363,
6909406, 6909513, 6909567, 6909647, 6910024, 6910181, 6910330,
6910584, 6910708, 6910822, 6910898, 6911012, 6911214, 6911321,
6911614, 6911690, 6913180, 6927706, 6927573, 6927499, 6922144,
6921488, 6921083, 6920895, 6916349, 6920789, 6920632, 6920453,
6916581, 6915727, 6903415, 6903553, 6918153, 6917985, 6917619,
6917449, 6917261, 6917044, 6916877, 6916742, 6916548, 6916181,
6915971, 6915724, 6915572, 6915110, 6914943, 6914747, 6914650,
6914112, 6913978, 6913765, 6912930), .Dim = c(192L, 2L))

The underlying problem is the weights object, with n=192:

table(card(lista$neighbours))
#   0   1   2
# 153  32   7

With this number of no-neighbour observations, the measure is pretty 
meaningless. Taking the weights constants:

unlist(spweights.constants(lista, zero.policy=TRUE, adjust.n=TRUE))
#    n   n1   n2   n3   nn   S0   S1   S2
#   39   38   37   36 1521   39   69  162
unlist(spweights.constants(lista, zero.policy=TRUE, adjust.n=FALSE))
#     n    n1    n2    n3    nn    S0    S1    S2
#   192   191   190   189 36864    39    69   162

we see that S0 (sum of weights) is constant, but n changes, so:

moran(VAR, lista, n=192, S0=39, zero.policy=TRUE)$I
# [1] 1.259683
moran(VAR, lista, n=39, S0=39, zero.policy=TRUE)$I
# [1] 0.2558731

as S0 is part of the denominator and n the numerator of the measure. The 
adjustment of n is done to prevent people shooting themselves in the foot 
by specifying improbable weights objects.

It is, however, true that moran.mc() could take the adjust.n= argument; it 
currently takes adjust.n=FALSE by definition, change committed.

Hope this clarifies,

Roger

>
> On Wed, 7 Jan 2015, Leandro Roser wrote:
>
>> Hello everyone. I'm new in this group. I will appreciate any
>> suggestion for solving the following problem.
>> I am using the package spdep, with the purpose computing bootstraped
>> values of  Moran's I over a range of geographical distances.  The
>> weighing matrix for each range was obtained with the package adegenet:
>> 
>> library(adegenet)
>> library(spdep)
>> 
>> 
>
>> 
>> xy<-matrix(xy,192,2)
>> 
>> 
>> 
>> lista<-chooseCN(xy,type=5,d1=5,d2=50, result.type = "listw",plot.nb = F)
>> #listw object obtained with adegenet
>> 
>> 
>> moran.mc(VAR,lista,999,na.action = na.exclude, zero.policy = T)
>> 
>> # Monte-Carlo simulation of Moran's I
>> 
>> #data:  VAR
>> #weights: lista
>> #number of simulations + 1: 1000
>> #
>> #*statistic = 1.2597*, observed rank = 1000, p-value = 0.001
>> #alternative hypothesis: greater
>> 
>> 
>> #How can I intepret this result (Moran >1)?  Extracting the values in the
>> object "lista", I obtained:
>> 
>> print(lista,zero.policy=TRUE)
>> #n   nn S0 S1  S2
>> #W 39 1521 39 69 162
>> 
>> #And using these parameters in the function moran():
>> 
>> moran(VAR,lista,39,39, zero.policy =T)
>> #$I
>> #[1] *0.2558731*
>> #
>> #$K
>> #[1] 1.911139
>> 
>> #The result of moran() is different of the obtained with moran.mc (and is
>> not higher than 1). Might be a problem in the moran.mc() function?
>> 
>> Thanks in advance,
>>
>>  Leandro.
>> 
>> 
>> 
>> 
>> 
>> 
>> 
>> -- 
>> Lic. Leandro Gabriel Roser
>> Laboratorio de Gen?tica
>> Dto. de Ecolog?a, Gen?tica y Evoluci?n,
>> F.C.E.N., U.B.A.,
>> Ciudad Universitaria, PB II, 4to piso,
>> Nu?ez, Cdad. Aut?noma de Buenos Aires,
>> Argentina.
>> tel ++54 +11 4576-3300 (ext 219)
>> fax ++54 +11 4576-3384
>>
>> 	[[alternative HTML version deleted]]
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no

From frtog at vestas.com  Wed Jan  7 11:34:14 2015
From: frtog at vestas.com (=?iso-8859-1?Q?Frede_Aakmann_T=F8gersen?=)
Date: Wed, 7 Jan 2015 11:34:14 +0100
Subject: [R-sig-Geo] Inverse distance weighting in 3 dimension using
 gstat package
In-Reply-To: <54ACEEB6.1070804@uni-muenster.de>
References: <B078CDF40DFE4045AF172A8B4F68FC4857CB14A330@DKRDSEXC016.vestas.net>
	<54ACEEB6.1070804@uni-muenster.de>
Message-ID: <B078CDF40DFE4045AF172A8B4F68FC4857CB14A545@DKRDSEXC016.vestas.net>

Hi Edzer

Thank you very much, your observation was really helpful. So it was an error on my side :-( Nice that new eyes catch such errors so quickly.

The z values in the cfd data frame (data from computational fluid dynamics calculation of wind plow patterns) is height above sea level plus the height of wind turbine tower (here 95 m). The z values in the mastCFD data frame for meterological masts is just height above sea level. So this will cause a dip in the interpolated values at mast positions. The values of aspZ is calculated from the z values. So adjusting the z values in mastCFD to that of z values in cfd solves the problem. See the nice plot at https://www.dropbox.com/s/q30m3edjyhbuugj/Ainterp_more_correct.png?dl=0.  

Again, thanks.

Yours sincerely / Med venlig hilsen


Frede Aakmann T?gersen
Specialist, M.Sc., Ph.D.
Plant Performance & Modeling

Technology & Service Solutions
T +45 9730 5135
M +45 2547 6050
frtog at vestas.com
http://www.vestas.com

Company reg. name: Vestas Wind Systems A/S
This e-mail is subject to our e-mail disclaimer statement.
Please refer to www.vestas.com/legal/notice
If you have received this e-mail in error please contact the sender. 


> -----Original Message-----
> From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of
> Edzer Pebesma
> Sent: 7. januar 2015 09:31
> To: r-sig-geo at r-project.org
> Subject: Re: [R-sig-Geo] Inverse distance weighting in 3 dimension using
> gstat package
> 
> 3D interpolation projected on irregular 2D is always somewhat tricky to
> comprehend. After looking at the plot, I tried:
> 
> > library(sp)
> > pts = SpatialPoints(mastCFD[c("x", "y")])
> > grd = cfd
> > gridded(grd) = ~x+y
> > over(pts,grd)
>          z   vxymag     aspZ  Ainterp
> 1 877.9992 11.70016 75491.32 4.700857
> 2 902.3500 13.44538 77585.03 4.669962
> > mastCFD
>        x       y      z                           mast     A     aspZ
> 1 586987 1566348 788.82 MASTBenakanahalli1_78_0m___Ch2 4.766 67823.60
> 2 591592 1562582 808.44 MASTBenakanahalli2_78_0m___Ch2 4.622 69510.55
> 
> and wondered why mastCFD$z is different from the cfd$z values at the
> corresponding locations.
> 
> 
> On 01/07/2015 07:31 AM, Frede Aakmann T?gersen wrote:
> > Hi
> >
> > Anyone got experiences with interpolation in 3 dimensions?
> >
> > I am doing some inverse distance interpolation in 3 dimensions using the

< snipped text>


From frtog at vestas.com  Wed Jan  7 14:37:26 2015
From: frtog at vestas.com (=?iso-8859-1?Q?Frede_Aakmann_T=F8gersen?=)
Date: Wed, 7 Jan 2015 14:37:26 +0100
Subject: [R-sig-Geo] GSTAT Co-Kriging: How can i fix a non positive
 definte correlation matrix
In-Reply-To: <BLUPR02MB083664C2493C69AA277823EF9590@BLUPR02MB083.namprd02.prod.outlook.com>
References: <BLUPR02MB083664C2493C69AA277823EF9590@BLUPR02MB083.namprd02.prod.outlook.com>
Message-ID: <B078CDF40DFE4045AF172A8B4F68FC4857CB14A6AA@DKRDSEXC016.vestas.net>

Hi Blake

You should do the prediction using the 'g.fit' object instead of the 'g' object.

This works:

See below for a dput'ed version of the data 'dtrd'.

## R script

library(gstat)
library(sp)

## create a grid onto which i will interpolate # first get a range in data
bbox <- slot(dtrd, "bbox")
x.range <- bbox["x", ]
y.range <- bbox["y", ]

## now expand to a grid with desired spacing
grid <- expand.grid(x=seq(from=x.range[1], to=x.range[2], by=0.4), y=seq(from=y.range[1], to=y.range[2], by=1.6))
plot(grid)

# Convert to spatial data frame
coordinates(grid) = c("x", "y")

# Compute cross-variogram
g <- gstat(NULL, id = "n.ae", formula = n.ae ~ + 1, data = dtrd, nmax=10)
g <- gstat(g, "n.ts", n.ts ~ 1, dtrd, nmax=10)
g <- gstat(g, model = vgm(psill=-0.65, model = "Sph", range = 15, nugget = 0.05), fill.all = T)

## fit direct and cross variograms
g.fit <- fit.lmc(v, g, correct.diagonal = 1.01)

## plot direct and cross variograms
plot(variogram(g.fit), model=g.fit$model)

## Perform co-kriging predictions
ck <- predict.gstat(g.fit, grid) # Use g.fit and not g!!!!!!!!!

str(ck)

##
gridded(ck) <- TRUE
spplot(ck, c("n.ae.pred", "n.ts.pred"))

## data
dtrd <- new("SpatialPointsDataFrame"
    , data = structure(list(n.ts = c(-0.052514693, -0.375234492, 1.362810557, 
-0.333087778, 0.699916885, 0.605552409, 0.406868496, -0.529754386, 
-0.416509276, -0.450700276, -0.732937251, 0.377457633, -0.989029229, 
-1.259551904, -0.470220669, 1.046426438, -1.440639861, -0.899563555, 
-1.287567164, -0.816931437, -0.782655308, 0.048342822, -0.5581308, 
-0.217874377, -0.272702769, -0.996064, -1.97520507, -0.718163458, 
0.337266312, -0.565668608, 0.651736313, -0.715751462, 0.650820529, 
-1.184380204, 0.132388601, 1.08502868, -0.85196341, 0.099887288, 
-0.233091874, -0.989196908, -0.025054063, -0.394999955, 0.049839033, 
1.327518037, -0.421157849, -0.178717505, -0.065413063, 1.167410569, 
0.428968564, 1.550074254, 2.931334909, 4.126464345, 0.44561262, 
0.543591219, 0.716228164, 1.856183532, 0.774644882, 0.425336383, 
0.294908064, 2.38260471, -0.315391214, 1.136916243, -0.233091874, 
-0.352017426, -0.933099317, -0.865945243, -0.594339105, -0.653328511, 
0.076670222, -0.14022361, -0.545492977, -0.084386566, 2.107283841, 
-1.645006796, 0.512684145, 0.517794479, -0.359495901, 0.548288806, 
-0.597741695, -1.003803022, 0.060157729, 0.251793973, -1.148625922, 
-0.957779058, 0.267364885, 0.171656399, -0.912461925, -0.645228334, 
0.83148026, -1.187664129, -0.467591981, -0.121964677, -0.158281328, 
-0.235932095, -0.436274739, -1.136811015, 0.87349541, -0.661067533, 
0.301101862, 1.265698729, -0.806040053, 1.006815543, -0.0132082, 
-1.214201235, -0.323473333, -0.003250658, -0.168398809, -0.854793312, 
0.507014021, 3.104090518, -0.193785381, -0.71632415, 2.480632323, 
-0.534663506, -0.124544351), n.ae = c(0.055104755, -0.861381682, 
-0.23577909, 0.134741672, -2.348188189, -0.75492334, 0.329847607, 
0.251549504, 1.094807283, 0.988002955, 1.344413512, -0.542187169, 
2.002433474, -0.895859924, 0.370809323, 0.168121785, 1.423433672, 
0.83844681, -0.086478673, 1.156633451, 0.299641538, -0.763091614, 
-0.130509134, 0.815852429, 0.906621066, 0.274459785, 2.017626766, 
0.444173367, 0.831151021, 0.513114809, -0.055114304, 0.205488257, 
0.558032798, 0.612006591, 0.462059331, 0.399240335, 0.113079949, 
-1.922971577, -0.287556625, 0.10047403, 0.384754057, -1.272051846, 
-2.568551091, -0.974203156, -0.0101211, 0.408401438, -0.195765074, 
-1.626236059, -1.287922066, -1.011990828, -1.872352342, -2.254471152, 
-0.709554064, 1.03999109, -0.671315106, -1.403466298, -0.952601604, 
-0.776073605, -0.00019281, -0.778811406, -0.223383771, -0.238938091, 
-0.520269718, -0.556041646, -0.441354858, -1.011088256, -0.399550741, 
1.213119402, 0.819568017, 0.166527242, -0.613535469, -0.423754708, 
-0.891753223, 0.566968259, 0.515250895, -1.144578624, 0.191964723, 
-1.011825356, 0.046560408, 0.319904274, 0.824035747, 0.632946256, 
1.257360463, 0.30201831, 1.139304073, 0.623288738, 0.820049388, 
1.041375034, 2.914000894, 2.756035789, 0.467880919, 0.878460826, 
-0.266451488, 1.440612621, -0.298237058, -0.688794913, 0.449964869, 
-0.08882536, -0.255259598, 0.948786211, 0.352201302, 1.12999254, 
0.581935908, 1.431842632, -0.083379843, -0.248324838, -0.916859761, 
-0.231928117, -0.49107152, -2.654897126, 0.067244345, -1.46047875, 
-0.336852087, -1.093553232, -0.603005465)), .Names = c("n.ts", 
"n.ae"), class = "data.frame", row.names = c(NA, -115L))
    , coords.nrs = 1:2
    , coords = structure(c(3.2, 6.4, 9.6, 12.8, 16, 22.4, 25.6, 3.2, 6.4, 9.6, 
12.8, 16, 19.2, 22.4, 25.6, 3.2, 6.4, 9.6, 12.8, 16, 19.2, 22.4, 
3.2, 6.4, 9.6, 12.8, 16, 19.2, 22.4, 25.6, 3.2, 6.4, 9.6, 12.8, 
16, 19.2, 22.4, 25.6, 3.2, 6.4, 9.6, 12.8, 16, 19.2, 22.4, 25.6, 
3.2, 6.4, 9.6, 12.8, 16, 19.2, 22.4, 25.6, 3.2, 6.4, 9.6, 12.8, 
16, 19.2, 22.4, 25.6, 3.2, 6.4, 9.6, 16, 19.2, 22.4, 25.6, 3.2, 
6.4, 9.6, 12.8, 16, 22.4, 25.6, 3.2, 6.4, 9.6, 12.8, 16, 19.2, 
22.4, 25.6, 3.2, 6.4, 9.6, 12.8, 16, 19.2, 22.4, 25.6, 3.2, 6.4, 
12.8, 16, 19.2, 22.4, 25.6, 3.2, 6.4, 9.6, 12.8, 16, 19.2, 22.4, 
25.6, 3.2, 6.4, 9.6, 12.8, 16, 19.2, 22.4, 25.6, 6.4, 6.4, 6.4, 
6.4, 6.4, 6.4, 6.4, 9.6, 9.6, 9.6, 9.6, 9.6, 9.6, 9.6, 9.6, 12.8, 
12.8, 12.8, 12.8, 12.8, 12.8, 12.8, 16, 16, 16, 16, 16, 16, 16, 
16, 19.2, 19.2, 19.2, 19.2, 19.2, 19.2, 19.2, 19.2, 22.4, 22.4, 
22.4, 22.4, 22.4, 22.4, 22.4, 22.4, 25.6, 25.6, 25.6, 25.6, 25.6, 
25.6, 25.6, 25.6, 28.8, 28.8, 28.8, 28.8, 28.8, 28.8, 28.8, 28.8, 
32, 32, 32, 32, 32, 32, 32, 35.2, 35.2, 35.2, 35.2, 35.2, 35.2, 
35.2, 38.4, 38.4, 38.4, 38.4, 38.4, 38.4, 38.4, 38.4, 41.6, 41.6, 
41.6, 41.6, 41.6, 41.6, 41.6, 41.6, 44.8, 44.8, 44.8, 44.8, 44.8, 
44.8, 44.8, 48, 48, 48, 48, 48, 48, 48, 48, 51.2, 51.2, 51.2, 
51.2, 51.2, 51.2, 51.2, 51.2), .Dim = c(115L, 2L), .Dimnames = list(
    NULL, c("x", "y")))
    , bbox = structure(c(3.2, 6.4, 25.6, 51.2), .Dim = c(2L, 2L), .Dimnames = list(
    c("x", "y"), c("min", "max")))
    , proj4string = new("CRS"
    , projargs = NA_character_
)
)

Yours sincerely / Med venlig hilsen


Frede Aakmann T?gersen
Specialist, M.Sc., Ph.D.
Plant Performance & Modeling

Technology & Service Solutions
T +45 9730 5135
M +45 2547 6050
frtog at vestas.com
http://www.vestas.com

Company reg. name: Vestas Wind Systems A/S
This e-mail is subject to our e-mail disclaimer statement.
Please refer to www.vestas.com/legal/notice
If you have received this e-mail in error please contact the sender. 


< snipped >


From tim.howard at dec.ny.gov  Thu Jan  8 21:02:26 2015
From: tim.howard at dec.ny.gov (Howard, Tim G (DEC))
Date: Thu, 8 Jan 2015 20:02:26 +0000
Subject: [R-sig-Geo] group adjacent polygons,
	optimize sum of polygon attributes
Message-ID: <BL2PR09MB0516F2C364B1113934E5F78A8470@BL2PR09MB051.namprd09.prod.outlook.com>

All,
Given a tessellated set of polygons, each with an attribute of sample size, I want to aggregate these polygons into groups such that the sum of the sample size values reaches a certain threshold while simultaneously maximizing the number of aggregations (groups).   Also, the polygons in the groups (aggregations) would be adjacent.

This seems like a spatial version of the Bin packing problem (http://en.wikipedia.org/wiki/Bin_packing_problem ) or knapsack problem (http://en.wikipedia.org/wiki/Knapsack_problem ).

I can't find reference to relevant optimization approaches to this at the Spatial Task View (http://cran.r-project.org/web/views/Spatial.html ), but I could be looking for the wrong thing.

The closest discussion I've found was this blog entry:

http://www.r-bloggers.com/spatial-clustering-with-equal-sizes/

This is for a relatively small number of polygons that I want to aggregate (perhaps no more than 200), so a brute force method could potentially work, rather than a true optimization?

Otherwise, I'm not sure where to start. Does anyone have any pointers for what to look for?

Thanks in advance,
Tim

	[[alternative HTML version deleted]]


From alobolistas at gmail.com  Fri Jan  9 12:36:55 2015
From: alobolistas at gmail.com (Agustin Lobo)
Date: Fri, 9 Jan 2015 12:36:55 +0100
Subject: [R-sig-Geo] Selecting variable within nc file in raster() or brick()
Message-ID: <CAG4NReJp-OYpGMzKTw7YpzfmqwqM1XY+iQ3zL2WxW42K-vLb5g@mail.gmail.com>

Hi!

For nc (v3) files having only 1 field variable along time such as
open.ncdf(file.path(ncdir,nom1))
[1] "file /media/alobo/FREECOM
HDD/BIGFILES/IMASCOARSESTOCK/SMOS/_DELSMH001DIBEA.nc has 4
dimensions:"
[1] "time   Size: 257"
[1] "lat   Size: 1100"
[1] "lon   Size: 1600"
[1] "time_strlen   Size: 20"
[1] "------------------------"
[1] "file /media/alobo/FREECOM
HDD/BIGFILES/IMASCOARSESTOCK/SMOS/_DELSMH001DIBEA.nc has 1 variables:"
[1] "float HighRes_Soil_Moisture[lon,lat,time]  Longname:1 km Soil
Moisture Missval:-999"

I can simply use
nc1 <- brick(file.path(ncdir,nom1))

But, what in the case of having several variables in the nc file, i.e.:
open.ncdf(file.path(ncdir,nom5))
[1] "file /media/alobo/FREECOM
HDD/BIGFILES/IMASCOARSESTOCK/SMOS/_NRTSM003D025A_ALL_2013.nc has 4
dimensions:"
[1] "time   Size: 365"
[1] "lat   Size: 44"
[1] "lon   Size: 62"
[1] "time_strlen   Size: 20"
[1] "------------------------"
[1] "file /media/alobo/FREECOM
HDD/BIGFILES/IMASCOARSESTOCK/SMOS/_NRTSM003D025A_ALL_2013.nc has 4
variables:"
[1] "int L2_Points[lon,lat,time]  Longname:Number of Measures Missval:0"
[1] "float SM[lon,lat,time]  Longname:Surface soil moisture Missval:-999"
[1] "float SM_DQX[lon,lat,time]  Longname:Surface soil moisture_dqx
Missval:-999"
[1] "float VARIANCE_SM[lon,lat,time]  Longname:Variance of Surface
soil moisture Missval:-999"

Is there a way to select the desired variable within brick() ?
Or should I use  get.var.ncdf() and then transform to raster?
(the only problem in this case is that I have to rotate etc, while
brick() does it all in the first case)

Thanks

Agus


From mdsumner at gmail.com  Fri Jan  9 12:48:14 2015
From: mdsumner at gmail.com (Michael Sumner)
Date: Fri, 09 Jan 2015 11:48:14 +0000
Subject: [R-sig-Geo] Selecting variable within nc file in raster() or
	brick()
References: <CAG4NReJp-OYpGMzKTw7YpzfmqwqM1XY+iQ3zL2WxW42K-vLb5g@mail.gmail.com>
Message-ID: <CAAcGz99sOy5Xa2BO8k=WqL_VK2pheVC_i8ZZoPESy-ee6Dv8LA@mail.gmail.com>

Use the varname argument to choose a specific variable. Try

brick(file.path(ncdir,nom5))

it will tell you what to do. The level argument provides a similar facility
for slicing from a 4d var, btw.

Cheers, Mike

On Fri, 9 Jan 2015 22:37 Agustin Lobo <alobolistas at gmail.com> wrote:

> Hi!
>
> For nc (v3) files having only 1 field variable along time such as
> open.ncdf(file.path(ncdir,nom1))
> [1] "file /media/alobo/FREECOM
> HDD/BIGFILES/IMASCOARSESTOCK/SMOS/_DELSMH001DIBEA.nc has 4
> dimensions:"
> [1] "time   Size: 257"
> [1] "lat   Size: 1100"
> [1] "lon   Size: 1600"
> [1] "time_strlen   Size: 20"
> [1] "------------------------"
> [1] "file /media/alobo/FREECOM
> HDD/BIGFILES/IMASCOARSESTOCK/SMOS/_DELSMH001DIBEA.nc has 1 variables:"
> [1] "float HighRes_Soil_Moisture[lon,lat,time]  Longname:1 km Soil
> Moisture Missval:-999"
>
> I can simply use
> nc1 <- brick(file.path(ncdir,nom1))
>
> But, what in the case of having several variables in the nc file, i.e.:
> open.ncdf(file.path(ncdir,nom5))
> [1] "file /media/alobo/FREECOM
> HDD/BIGFILES/IMASCOARSESTOCK/SMOS/_NRTSM003D025A_ALL_2013.nc has 4
> dimensions:"
> [1] "time   Size: 365"
> [1] "lat   Size: 44"
> [1] "lon   Size: 62"
> [1] "time_strlen   Size: 20"
> [1] "------------------------"
> [1] "file /media/alobo/FREECOM
> HDD/BIGFILES/IMASCOARSESTOCK/SMOS/_NRTSM003D025A_ALL_2013.nc has 4
> variables:"
> [1] "int L2_Points[lon,lat,time]  Longname:Number of Measures Missval:0"
> [1] "float SM[lon,lat,time]  Longname:Surface soil moisture Missval:-999"
> [1] "float SM_DQX[lon,lat,time]  Longname:Surface soil moisture_dqx
> Missval:-999"
> [1] "float VARIANCE_SM[lon,lat,time]  Longname:Variance of Surface
> soil moisture Missval:-999"
>
> Is there a way to select the desired variable within brick() ?
> Or should I use  get.var.ncdf() and then transform to raster?
> (the only problem in this case is that I have to rotate etc, while
> brick() does it all in the first case)
>
> Thanks
>
> Agus
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From alobolistas at gmail.com  Fri Jan  9 12:49:43 2015
From: alobolistas at gmail.com (Agustin Lobo)
Date: Fri, 9 Jan 2015 12:49:43 +0100
Subject: [R-sig-Geo] raster temporal files
Message-ID: <CAG4NReKwRwbqzOM=Fo5kUnpRfVEkitaO1CHm3Ja6KLDHhDi=Ew@mail.gmail.com>

I'm working with large files and observe that when I remove a raster layer
in R, i.e.
rm(a)

the associated gri and grd files in /tmp/R_raster_alobo still remain.
Is this normal or do I have
a configuration problem? I thought that the temporal files would be deleted
once the corresponding R object was removed.

Thanks

Agus


From mdsumner at gmail.com  Fri Jan  9 13:09:45 2015
From: mdsumner at gmail.com (Michael Sumner)
Date: Fri, 09 Jan 2015 12:09:45 +0000
Subject: [R-sig-Geo] raster temporal files
References: <CAG4NReKwRwbqzOM=Fo5kUnpRfVEkitaO1CHm3Ja6KLDHhDi=Ew@mail.gmail.com>
Message-ID: <CAAcGz98uWH_gfyq6o2NpbgcfXouQPAX=PoYGOftBQoSAxD1ZXQ@mail.gmail.com>

On Fri Jan 09 2015 at 22:49:53 Agustin Lobo <alobolistas at gmail.com> wrote:

> I'm working with large files and observe that when I remove a raster layer
> in R, i.e.
> rm(a)
>
> the associated gri and grd files in /tmp/R_raster_alobo still remain.
> Is this normal or do I have
> a configuration problem? I thought that the temporal files would be deleted
> once the corresponding R object was removed.
>
>
It's documented in ?rasterOptions that

     For example, to change
     the default directory used to save temporary files, add a line
     like this: ?options(rasterTmpDir='c:/temp/')? to that file. All
     temporary raster files in that folder that are older than 24 hrs
     are deleted when the raster package is loaded.

I haven't tested this myself, but clearly that help page is relevant.

Cheers, Mike.



> Thanks
>
> Agus
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From jfloeter at uni-hamburg.de  Fri Jan  9 13:17:28 2015
From: jfloeter at uni-hamburg.de (Jens Floeter)
Date: Fri, 09 Jan 2015 13:17:28 +0100
Subject: [R-sig-Geo] Selecting variable within nc file in raster() or
 brick()
In-Reply-To: <CAG4NReJp-OYpGMzKTw7YpzfmqwqM1XY+iQ3zL2WxW42K-vLb5g@mail.gmail.com>
References: <CAG4NReJp-OYpGMzKTw7YpzfmqwqM1XY+iQ3zL2WxW42K-vLb5g@mail.gmail.com>
Message-ID: <54AFC6D8.7090806@uni-hamburg.de>

Hi Agus,

# i also find it difficult to work with 4D netcdf files and raster 
objects...they seem not be well suited for 4D data...
# you may try a loop to extact the variables (var1, var2,...) at 
different levels

n <- 11
for (i in 1:n) {
   names <- paste("outputname.brick.layer", i, sep=".")
   assign(names, brick("inputname.nc", varname ="var1", lvar = 3, level 
= i) )
}

# ....  and stack them later, eg.

stack.var1.var2 <- stack (outputname.brick.layer.1, 
outputname.brick.layer.2)

Best wishes !
jens


Am 09.01.2015 um 12:36 schrieb Agustin Lobo:
> Hi!
>
> For nc (v3) files having only 1 field variable along time such as
> open.ncdf(file.path(ncdir,nom1))
> [1] "file /media/alobo/FREECOM
> HDD/BIGFILES/IMASCOARSESTOCK/SMOS/_DELSMH001DIBEA.nc has 4
> dimensions:"
> [1] "time   Size: 257"
> [1] "lat   Size: 1100"
> [1] "lon   Size: 1600"
> [1] "time_strlen   Size: 20"
> [1] "------------------------"
> [1] "file /media/alobo/FREECOM
> HDD/BIGFILES/IMASCOARSESTOCK/SMOS/_DELSMH001DIBEA.nc has 1 variables:"
> [1] "float HighRes_Soil_Moisture[lon,lat,time]  Longname:1 km Soil
> Moisture Missval:-999"
>
> I can simply use
> nc1 <- brick(file.path(ncdir,nom1))
>
> But, what in the case of having several variables in the nc file, i.e.:
> open.ncdf(file.path(ncdir,nom5))
> [1] "file /media/alobo/FREECOM
> HDD/BIGFILES/IMASCOARSESTOCK/SMOS/_NRTSM003D025A_ALL_2013.nc has 4
> dimensions:"
> [1] "time   Size: 365"
> [1] "lat   Size: 44"
> [1] "lon   Size: 62"
> [1] "time_strlen   Size: 20"
> [1] "------------------------"
> [1] "file /media/alobo/FREECOM
> HDD/BIGFILES/IMASCOARSESTOCK/SMOS/_NRTSM003D025A_ALL_2013.nc has 4
> variables:"
> [1] "int L2_Points[lon,lat,time]  Longname:Number of Measures Missval:0"
> [1] "float SM[lon,lat,time]  Longname:Surface soil moisture Missval:-999"
> [1] "float SM_DQX[lon,lat,time]  Longname:Surface soil moisture_dqx
> Missval:-999"
> [1] "float VARIANCE_SM[lon,lat,time]  Longname:Variance of Surface
> soil moisture Missval:-999"
>
> Is there a way to select the desired variable within brick() ?
> Or should I use  get.var.ncdf() and then transform to raster?
> (the only problem in this case is that I have to rotate etc, while
> brick() does it all in the first case)
>
> Thanks
>
> Agus
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
*****************************************************
Jens Floeter
Institut f?r Hydrobiologie  & Fischereiwissenschaft
Universit?t Hamburg
Olbersweg 24
22767 Hamburg

Phone +49 (0)40 42838 6622
Fax   +49 (0)40 42838 6618


From alobolistas at gmail.com  Fri Jan  9 13:37:39 2015
From: alobolistas at gmail.com (Agustin Lobo)
Date: Fri, 9 Jan 2015 13:37:39 +0100
Subject: [R-sig-Geo] raster temporal files
In-Reply-To: <CAAcGz98uWH_gfyq6o2NpbgcfXouQPAX=PoYGOftBQoSAxD1ZXQ@mail.gmail.com>
References: <CAG4NReKwRwbqzOM=Fo5kUnpRfVEkitaO1CHm3Ja6KLDHhDi=Ew@mail.gmail.com>
	<CAAcGz98uWH_gfyq6o2NpbgcfXouQPAX=PoYGOftBQoSAxD1ZXQ@mail.gmail.com>
Message-ID: <CAG4NReK=UQ1+bWURf+1UO1PnZt9jyFKBpxMkXhWr4ef1603qTw@mail.gmail.com>

It is relevant, but it is not the problem I'm describing:
I refer to the temporary files that correspond to R raster objects that
have been deleted.
My understanding is that the paragraph you include refers to
raster objects that have not been deleted and are saved between
sessions in the .RData. If you open a new session after the value
tmptime has been exceeded, the actual values for the raster object will
not be there. But this is not the issue I'm referring to now.

What I thought is that deleting a raster object from the workspace implied
deleting the corresponding temporary file from disk. I observe that this
is not the case and would like to know if this is the normal and intentional
behavior.

Agus





On Fri, Jan 9, 2015 at 1:09 PM, Michael Sumner <mdsumner at gmail.com> wrote:
> On Fri Jan 09 2015 at 22:49:53 Agustin Lobo <alobolistas at gmail.com> wrote:
>
>> I'm working with large files and observe that when I remove a raster layer
>> in R, i.e.
>> rm(a)
>>
>> the associated gri and grd files in /tmp/R_raster_alobo still remain.
>> Is this normal or do I have
>> a configuration problem? I thought that the temporal files would be deleted
>> once the corresponding R object was removed.
>>
>>
> It's documented in ?rasterOptions that
>
>      For example, to change
>      the default directory used to save temporary files, add a line
>      like this: ?options(rasterTmpDir='c:/temp/')? to that file. All
>      temporary raster files in that folder that are older than 24 hrs
>      are deleted when the raster package is loaded.
>
> I haven't tested this myself, but clearly that help page is relevant.
>
> Cheers, Mike.
>
>
>
>> Thanks
>>
>> Agus
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From alobolistas at gmail.com  Fri Jan  9 14:09:27 2015
From: alobolistas at gmail.com (Agustin Lobo)
Date: Fri, 9 Jan 2015 14:09:27 +0100
Subject: [R-sig-Geo] Selecting variable within nc file in raster() or
	brick()
In-Reply-To: <CAAcGz99sOy5Xa2BO8k=WqL_VK2pheVC_i8ZZoPESy-ee6Dv8LA@mail.gmail.com>
References: <CAG4NReJp-OYpGMzKTw7YpzfmqwqM1XY+iQ3zL2WxW42K-vLb5g@mail.gmail.com>
	<CAAcGz99sOy5Xa2BO8k=WqL_VK2pheVC_i8ZZoPESy-ee6Dv8LA@mail.gmail.com>
Message-ID: <CAG4NRe+bdmRQb9MgsXcWZN8S7GipR=x8cPL-79CPyT4RpuoxTg@mail.gmail.com>

hmm.. strange, I do not get the same behaviour for this file:

nom5 <- "_NRTSM003D025A_ALL_2013.nc"
info5 <- open.ncdf(file.path(ncdir,nom5))
print(info5)
[1] "file /media/alobo/FREECOM
HDD/BIGFILES/IMASCOARSESTOCK/SMOS/_NRTSM003D025A_ALL_2013.nc has 4
dimensions:"
[1] "time   Size: 365"
[1] "lat   Size: 44"
[1] "lon   Size: 62"
[1] "time_strlen   Size: 20"
[1] "------------------------"
[1] "file /media/alobo/FREECOM
HDD/BIGFILES/IMASCOARSESTOCK/SMOS/_NRTSM003D025A_ALL_2013.nc has 4
variables:"
[1] "int L2_Points[lon,lat,time]  Longname:Number of Measures Missval:0"
[1] "float SM[lon,lat,time]  Longname:Surface soil moisture Missval:-999"
[1] "float SM_DQX[lon,lat,time]  Longname:Surface soil moisture_dqx
Missval:-999"
[1] "float VARIANCE_SM[lon,lat,time]  Longname:Variance of Surface
soil moisture Missval:-999"

nc5 <- brick(file.path(ncdir,nom5), varname="SM")
Error in .rasterObjectFromCDF(x, type = objecttype, band = band, ...) :
  cells are not equally spaced; you should extract values as points

I doubt the message is true (those files are satellite images),
although cannot tell for sure because I've not made the nc file
myself.
Also, the following works and does not complain about the spacing:

nc5 <- get.var.ncdf(info5, "SM", verbose = F)
r5 <- aperm(nc5[,ncol(nc5):1,],c(2,1,3))
r5 <- brick(r5)
plot(r5[[200]])

I can use this as a workaround, but it would be cleaner using brick() directly.

I've put the file here in case somebody would like to check:
https://dl.dropboxusercontent.com/u/3180464/_NRTSM003D025A_ALL_2013.nc

Agus

On Fri, Jan 9, 2015 at 12:48 PM, Michael Sumner <mdsumner at gmail.com> wrote:
> Use the varname argument to choose a specific variable. Try
>
> brick(file.path(ncdir,nom5))
>
> it will tell you what to do. The level argument provides a similar facility
> for slicing from a 4d var, btw.
>
> Cheers, Mike
>
> On Fri, 9 Jan 2015 22:37 Agustin Lobo <alobolistas at gmail.com> wrote:
>
>> Hi!
>>
>> For nc (v3) files having only 1 field variable along time such as
>> open.ncdf(file.path(ncdir,nom1))
>> [1] "file /media/alobo/FREECOM
>> HDD/BIGFILES/IMASCOARSESTOCK/SMOS/_DELSMH001DIBEA.nc has 4
>> dimensions:"
>> [1] "time   Size: 257"
>> [1] "lat   Size: 1100"
>> [1] "lon   Size: 1600"
>> [1] "time_strlen   Size: 20"
>> [1] "------------------------"
>> [1] "file /media/alobo/FREECOM
>> HDD/BIGFILES/IMASCOARSESTOCK/SMOS/_DELSMH001DIBEA.nc has 1 variables:"
>> [1] "float HighRes_Soil_Moisture[lon,lat,time]  Longname:1 km Soil
>> Moisture Missval:-999"
>>
>> I can simply use
>> nc1 <- brick(file.path(ncdir,nom1))
>>
>> But, what in the case of having several variables in the nc file, i.e.:
>> open.ncdf(file.path(ncdir,nom5))
>> [1] "file /media/alobo/FREECOM
>> HDD/BIGFILES/IMASCOARSESTOCK/SMOS/_NRTSM003D025A_ALL_2013.nc has 4
>> dimensions:"
>> [1] "time   Size: 365"
>> [1] "lat   Size: 44"
>> [1] "lon   Size: 62"
>> [1] "time_strlen   Size: 20"
>> [1] "------------------------"
>> [1] "file /media/alobo/FREECOM
>> HDD/BIGFILES/IMASCOARSESTOCK/SMOS/_NRTSM003D025A_ALL_2013.nc has 4
>> variables:"
>> [1] "int L2_Points[lon,lat,time]  Longname:Number of Measures Missval:0"
>> [1] "float SM[lon,lat,time]  Longname:Surface soil moisture Missval:-999"
>> [1] "float SM_DQX[lon,lat,time]  Longname:Surface soil moisture_dqx
>> Missval:-999"
>> [1] "float VARIANCE_SM[lon,lat,time]  Longname:Variance of Surface
>> soil moisture Missval:-999"
>>
>> Is there a way to select the desired variable within brick() ?
>> Or should I use  get.var.ncdf() and then transform to raster?
>> (the only problem in this case is that I have to rotate etc, while
>> brick() does it all in the first case)
>>
>> Thanks
>>
>> Agus
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From mdsumner at gmail.com  Fri Jan  9 14:23:18 2015
From: mdsumner at gmail.com (Michael Sumner)
Date: Fri, 09 Jan 2015 13:23:18 +0000
Subject: [R-sig-Geo] Selecting variable within nc file in raster() or
	brick()
References: <CAG4NReJp-OYpGMzKTw7YpzfmqwqM1XY+iQ3zL2WxW42K-vLb5g@mail.gmail.com>
	<CAAcGz99sOy5Xa2BO8k=WqL_VK2pheVC_i8ZZoPESy-ee6Dv8LA@mail.gmail.com>
	<CAG4NRe+bdmRQb9MgsXcWZN8S7GipR=x8cPL-79CPyT4RpuoxTg@mail.gmail.com>
Message-ID: <CAAcGz9_-uuX+Mc80bch9D_HwJV5KMDj2TZ=ytwi2NdZ2H0PAyg@mail.gmail.com>

There is a hidden argument stopIfNotEqualSpaced to use for ignoring
georeferencing for advanced use. Netcdf does not always translate into a
regular raster cleanly, if at all.

I will have a look if I get a chance.

M

On Sat, 10 Jan 2015 00:09 Agustin Lobo <alobolistas at gmail.com> wrote:

> hmm.. strange, I do not get the same behaviour for this file:
>
> nom5 <- "_NRTSM003D025A_ALL_2013.nc"
> info5 <- open.ncdf(file.path(ncdir,nom5))
> print(info5)
> [1] "file /media/alobo/FREECOM
> HDD/BIGFILES/IMASCOARSESTOCK/SMOS/_NRTSM003D025A_ALL_2013.nc has 4
> dimensions:"
> [1] "time   Size: 365"
> [1] "lat   Size: 44"
> [1] "lon   Size: 62"
> [1] "time_strlen   Size: 20"
> [1] "------------------------"
> [1] "file /media/alobo/FREECOM
> HDD/BIGFILES/IMASCOARSESTOCK/SMOS/_NRTSM003D025A_ALL_2013.nc has 4
> variables:"
> [1] "int L2_Points[lon,lat,time]  Longname:Number of Measures Missval:0"
> [1] "float SM[lon,lat,time]  Longname:Surface soil moisture Missval:-999"
> [1] "float SM_DQX[lon,lat,time]  Longname:Surface soil moisture_dqx
> Missval:-999"
> [1] "float VARIANCE_SM[lon,lat,time]  Longname:Variance of Surface
> soil moisture Missval:-999"
>
> nc5 <- brick(file.path(ncdir,nom5), varname="SM")
> Error in .rasterObjectFromCDF(x, type = objecttype, band = band, ...) :
>   cells are not equally spaced; you should extract values as points
>
> I doubt the message is true (those files are satellite images),
> although cannot tell for sure because I've not made the nc file
> myself.
> Also, the following works and does not complain about the spacing:
>
> nc5 <- get.var.ncdf(info5, "SM", verbose = F)
> r5 <- aperm(nc5[,ncol(nc5):1,],c(2,1,3))
> r5 <- brick(r5)
> plot(r5[[200]])
>
> I can use this as a workaround, but it would be cleaner using brick()
> directly.
>
> I've put the file here in case somebody would like to check:
> https://dl.dropboxusercontent.com/u/3180464/_NRTSM003D025A_ALL_2013.nc
>
> Agus
>
> On Fri, Jan 9, 2015 at 12:48 PM, Michael Sumner <mdsumner at gmail.com>
> wrote:
> > Use the varname argument to choose a specific variable. Try
> >
> > brick(file.path(ncdir,nom5))
> >
> > it will tell you what to do. The level argument provides a similar
> facility
> > for slicing from a 4d var, btw.
> >
> > Cheers, Mike
> >
> > On Fri, 9 Jan 2015 22:37 Agustin Lobo <alobolistas at gmail.com> wrote:
> >
> >> Hi!
> >>
> >> For nc (v3) files having only 1 field variable along time such as
> >> open.ncdf(file.path(ncdir,nom1))
> >> [1] "file /media/alobo/FREECOM
> >> HDD/BIGFILES/IMASCOARSESTOCK/SMOS/_DELSMH001DIBEA.nc has 4
> >> dimensions:"
> >> [1] "time   Size: 257"
> >> [1] "lat   Size: 1100"
> >> [1] "lon   Size: 1600"
> >> [1] "time_strlen   Size: 20"
> >> [1] "------------------------"
> >> [1] "file /media/alobo/FREECOM
> >> HDD/BIGFILES/IMASCOARSESTOCK/SMOS/_DELSMH001DIBEA.nc has 1 variables:"
> >> [1] "float HighRes_Soil_Moisture[lon,lat,time]  Longname:1 km Soil
> >> Moisture Missval:-999"
> >>
> >> I can simply use
> >> nc1 <- brick(file.path(ncdir,nom1))
> >>
> >> But, what in the case of having several variables in the nc file, i.e.:
> >> open.ncdf(file.path(ncdir,nom5))
> >> [1] "file /media/alobo/FREECOM
> >> HDD/BIGFILES/IMASCOARSESTOCK/SMOS/_NRTSM003D025A_ALL_2013.nc has 4
> >> dimensions:"
> >> [1] "time   Size: 365"
> >> [1] "lat   Size: 44"
> >> [1] "lon   Size: 62"
> >> [1] "time_strlen   Size: 20"
> >> [1] "------------------------"
> >> [1] "file /media/alobo/FREECOM
> >> HDD/BIGFILES/IMASCOARSESTOCK/SMOS/_NRTSM003D025A_ALL_2013.nc has 4
> >> variables:"
> >> [1] "int L2_Points[lon,lat,time]  Longname:Number of Measures Missval:0"
> >> [1] "float SM[lon,lat,time]  Longname:Surface soil moisture
> Missval:-999"
> >> [1] "float SM_DQX[lon,lat,time]  Longname:Surface soil moisture_dqx
> >> Missval:-999"
> >> [1] "float VARIANCE_SM[lon,lat,time]  Longname:Variance of Surface
> >> soil moisture Missval:-999"
> >>
> >> Is there a way to select the desired variable within brick() ?
> >> Or should I use  get.var.ncdf() and then transform to raster?
> >> (the only problem in this case is that I have to rotate etc, while
> >> brick() does it all in the first case)
> >>
> >> Thanks
> >>
> >> Agus
> >>
> >> _______________________________________________
> >> R-sig-Geo mailing list
> >> R-sig-Geo at r-project.org
> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>
> >
> >         [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From jgrn at illinois.edu  Fri Jan  9 23:29:00 2015
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Fri, 09 Jan 2015 22:29:00 +0000
Subject: [R-sig-Geo] Map of pixel area?
Message-ID: <CABG0rfsfB-cGAaO=EVbW8dr_TJ+EBWYoK0Tgy5hrJxT6+FQ45Q@mail.gmail.com>

R-sig-geo'ers:

I have an analysis where I need to take a geographic projection map, e.g.:

r1 <- raster()

And calculate, for each pixel, the square kilometers that each individual
pixel covers (since they vary across a geographic projection) -- the idea
is to end up with a map of pixel area.  Can anyone think of a clever way to
do this?  I'll be using this to do some area weighted summaries, but I
can't simply reproject the input map.  Thanks!

--j

	[[alternative HTML version deleted]]


From forrest at ufl.edu  Sat Jan 10 00:11:33 2015
From: forrest at ufl.edu (Forrest Stevens)
Date: Fri, 9 Jan 2015 18:11:33 -0500
Subject: [R-sig-Geo] Map of pixel area?
In-Reply-To: <CABG0rfsfB-cGAaO=EVbW8dr_TJ+EBWYoK0Tgy5hrJxT6+FQ45Q@mail.gmail.com>
References: <CABG0rfsfB-cGAaO=EVbW8dr_TJ+EBWYoK0Tgy5hrJxT6+FQ45Q@mail.gmail.com>
Message-ID: <CAEBQMMmRgeR7EQO5-Xid6-fxt0T5ic6ejiuA_JZ5X5Mpt6t99g@mail.gmail.com>

The easiest way I can think of would be to create an "index" raster
based on your raster of interest, convert it to polygons, project it
to an equal area projection with linear units amenable to you, then
extract the polygon areas and assign them back to your index raster
for weighting.  Perhaps something like this:


r1 <- raster()
r1[] <- 1:ncell(r1)
p1 <- rasterToPolygons(r1)

## Project to cylindrical equal area:
require(rgdal)
p2 <- spTransform(p1, CRS("+proj=cea +lat_0=0 +lon_0=0 +lat_ts=30
+a=6371228.0 +units=m"))

## Extract areas and assign back to raster:
areas <- sapply(slot(p2, "polygons"), slot, "area")
r2 <- r1
plot(r2)


Though, maybe someone else has a better way?

Sincerely,
Forrest
--
Forrest R. Stevens
Ph.D. Candidate, QSE3 IGERT Fellow
Department of Geography
Land Use and Environmental Change Institute
University of Florida
www.clas.ufl.edu/users/forrest


On Fri, Jan 9, 2015 at 5:29 PM, Jonathan Greenberg <jgrn at illinois.edu> wrote:
> R-sig-geo'ers:
>
> I have an analysis where I need to take a geographic projection map, e.g.:
>
> r1 <- raster()
>
> And calculate, for each pixel, the square kilometers that each individual
> pixel covers (since they vary across a geographic projection) -- the idea
> is to end up with a map of pixel area.  Can anyone think of a clever way to
> do this?  I'll be using this to do some area weighted summaries, but I
> can't simply reproject the input map.  Thanks!
>
> --j
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From forrest at ufl.edu  Sat Jan 10 00:15:10 2015
From: forrest at ufl.edu (Forrest Stevens)
Date: Fri, 9 Jan 2015 18:15:10 -0500
Subject: [R-sig-Geo] Map of pixel area?
In-Reply-To: <CAEBQMMmRgeR7EQO5-Xid6-fxt0T5ic6ejiuA_JZ5X5Mpt6t99g@mail.gmail.com>
References: <CABG0rfsfB-cGAaO=EVbW8dr_TJ+EBWYoK0Tgy5hrJxT6+FQ45Q@mail.gmail.com>
	<CAEBQMMmRgeR7EQO5-Xid6-fxt0T5ic6ejiuA_JZ5X5Mpt6t99g@mail.gmail.com>
Message-ID: <CAEBQMMkoK+g-eT6BFPgEHDwSAT2YLn5bDtaMLz17F_eV9jh0tg@mail.gmail.com>

Oops, sorry for the mistake when copying my code in.  Please find the
working code for the areas here:

r1 <- raster()
r1[] <- 1:ncell(r1)
p1 <- rasterToPolygons(r1)

## Project to cylindrical equal area:
require(rgdal)
p2 <- spTransform(p1, CRS("+proj=cea +lat_0=0 +lon_0=0 +lat_ts=30
+a=6371228.0 +units=m"))

## Extract areas and assign back to raster:
areas <- sapply(slot(p2, "polygons"), slot, "area")
r2 <- r1
r2[] <- areas
plot(r2)


Sorry for the confusion!

Sincerely,
Forrest

--
Forrest R. Stevens
Ph.D. Candidate, QSE3 IGERT Fellow
Department of Geography
Land Use and Environmental Change Institute
University of Florida
www.clas.ufl.edu/users/forrest


On Fri, Jan 9, 2015 at 6:11 PM, Forrest Stevens <forrest at ufl.edu> wrote:
> The easiest way I can think of would be to create an "index" raster
> based on your raster of interest, convert it to polygons, project it
> to an equal area projection with linear units amenable to you, then
> extract the polygon areas and assign them back to your index raster
> for weighting.  Perhaps something like this:
>
>
> r1 <- raster()
> r1[] <- 1:ncell(r1)
> p1 <- rasterToPolygons(r1)
>
> ## Project to cylindrical equal area:
> require(rgdal)
> p2 <- spTransform(p1, CRS("+proj=cea +lat_0=0 +lon_0=0 +lat_ts=30
> +a=6371228.0 +units=m"))
>
> ## Extract areas and assign back to raster:
> areas <- sapply(slot(p2, "polygons"), slot, "area")
> r2 <- r1
> plot(r2)
>
>
> Though, maybe someone else has a better way?
>
> Sincerely,
> Forrest
> --
> Forrest R. Stevens
> Ph.D. Candidate, QSE3 IGERT Fellow
> Department of Geography
> Land Use and Environmental Change Institute
> University of Florida
> www.clas.ufl.edu/users/forrest
>
>
> On Fri, Jan 9, 2015 at 5:29 PM, Jonathan Greenberg <jgrn at illinois.edu> wrote:
>> R-sig-geo'ers:
>>
>> I have an analysis where I need to take a geographic projection map, e.g.:
>>
>> r1 <- raster()
>>
>> And calculate, for each pixel, the square kilometers that each individual
>> pixel covers (since they vary across a geographic projection) -- the idea
>> is to end up with a map of pixel area.  Can anyone think of a clever way to
>> do this?  I'll be using this to do some area weighted summaries, but I
>> can't simply reproject the input map.  Thanks!
>>
>> --j
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From mdsumner at gmail.com  Sat Jan 10 00:21:32 2015
From: mdsumner at gmail.com (Michael Sumner)
Date: Fri, 09 Jan 2015 23:21:32 +0000
Subject: [R-sig-Geo] Map of pixel area?
References: <CABG0rfsfB-cGAaO=EVbW8dr_TJ+EBWYoK0Tgy5hrJxT6+FQ45Q@mail.gmail.com>
	<CAEBQMMmRgeR7EQO5-Xid6-fxt0T5ic6ejiuA_JZ5X5Mpt6t99g@mail.gmail.com>
	<CAEBQMMkoK+g-eT6BFPgEHDwSAT2YLn5bDtaMLz17F_eV9jh0tg@mail.gmail.com>
Message-ID: <CAAcGz9-far+-ZJr37JhoPC1zrvXp-SMNuDLQRFnP6XG_wAioCg@mail.gmail.com>

See ?area in raster for the standard approximation method.

Cheers, Mike

On Sat, 10 Jan 2015 10:15 Forrest Stevens <forrest at ufl.edu> wrote:

> Oops, sorry for the mistake when copying my code in.  Please find the
> working code for the areas here:
>
> r1 <- raster()
> r1[] <- 1:ncell(r1)
> p1 <- rasterToPolygons(r1)
>
> ## Project to cylindrical equal area:
> require(rgdal)
> p2 <- spTransform(p1, CRS("+proj=cea +lat_0=0 +lon_0=0 +lat_ts=30
> +a=6371228.0 +units=m"))
>
> ## Extract areas and assign back to raster:
> areas <- sapply(slot(p2, "polygons"), slot, "area")
> r2 <- r1
> r2[] <- areas
> plot(r2)
>
>
> Sorry for the confusion!
>
> Sincerely,
> Forrest
>
> --
> Forrest R. Stevens
> Ph.D. Candidate, QSE3 IGERT Fellow
> Department of Geography
> Land Use and Environmental Change Institute
> University of Florida
> www.clas.ufl.edu/users/forrest
>
>
> On Fri, Jan 9, 2015 at 6:11 PM, Forrest Stevens <forrest at ufl.edu> wrote:
> > The easiest way I can think of would be to create an "index" raster
> > based on your raster of interest, convert it to polygons, project it
> > to an equal area projection with linear units amenable to you, then
> > extract the polygon areas and assign them back to your index raster
> > for weighting.  Perhaps something like this:
> >
> >
> > r1 <- raster()
> > r1[] <- 1:ncell(r1)
> > p1 <- rasterToPolygons(r1)
> >
> > ## Project to cylindrical equal area:
> > require(rgdal)
> > p2 <- spTransform(p1, CRS("+proj=cea +lat_0=0 +lon_0=0 +lat_ts=30
> > +a=6371228.0 +units=m"))
> >
> > ## Extract areas and assign back to raster:
> > areas <- sapply(slot(p2, "polygons"), slot, "area")
> > r2 <- r1
> > plot(r2)
> >
> >
> > Though, maybe someone else has a better way?
> >
> > Sincerely,
> > Forrest
> > --
> > Forrest R. Stevens
> > Ph.D. Candidate, QSE3 IGERT Fellow
> > Department of Geography
> > Land Use and Environmental Change Institute
> > University of Florida
> > www.clas.ufl.edu/users/forrest
> >
> >
> > On Fri, Jan 9, 2015 at 5:29 PM, Jonathan Greenberg <jgrn at illinois.edu>
> wrote:
> >> R-sig-geo'ers:
> >>
> >> I have an analysis where I need to take a geographic projection map,
> e.g.:
> >>
> >> r1 <- raster()
> >>
> >> And calculate, for each pixel, the square kilometers that each
> individual
> >> pixel covers (since they vary across a geographic projection) -- the
> idea
> >> is to end up with a map of pixel area.  Can anyone think of a clever
> way to
> >> do this?  I'll be using this to do some area weighted summaries, but I
> >> can't simply reproject the input map.  Thanks!
> >>
> >> --j
> >>
> >>         [[alternative HTML version deleted]]
> >>
> >> _______________________________________________
> >> R-sig-Geo mailing list
> >> R-sig-Geo at r-project.org
> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From jgrn at illinois.edu  Sat Jan 10 00:42:17 2015
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Fri, 09 Jan 2015 23:42:17 +0000
Subject: [R-sig-Geo] Map of pixel area?
References: <CABG0rfsfB-cGAaO=EVbW8dr_TJ+EBWYoK0Tgy5hrJxT6+FQ45Q@mail.gmail.com>
	<CAEBQMMmRgeR7EQO5-Xid6-fxt0T5ic6ejiuA_JZ5X5Mpt6t99g@mail.gmail.com>
	<CAEBQMMkoK+g-eT6BFPgEHDwSAT2YLn5bDtaMLz17F_eV9jh0tg@mail.gmail.com>
	<CAAcGz9-far+-ZJr37JhoPC1zrvXp-SMNuDLQRFnP6XG_wAioCg@mail.gmail.com>
Message-ID: <CABG0rftRyJwjSnT3DjZ0iDG7WML9-68_4UBGobdOyX8Bfa_Lew@mail.gmail.com>

Thanks all!  I ended up doing more along the lines of what Forrest
recommended (the rectangular assumption, for a global analysis, seemed
inappropriate).  Here's my solution using rasterEngine (spatial.tools) that
converts to square kilometers:

pixel_area_calculator <- function(x,CRS="+proj=moll
+ellps=WGS84",scaling=1/1000000)
{
x <- raster(x)
 pixel_area_function <- function(x,CRS,scaling)
{
x_poly <- rasterToPolygons(x,n=16)
x_tr <- spTransform(x_poly,CRS=CRS(CRS))
x_tr_area <- gArea(x_tr,byid=TRUE)
dim(x_tr_area) <- c(ncol(x),nrow(x),1)
x_tr_area <- x_tr_area*scaling
return(x_tr_area)
}
 pixel_area <-
rasterEngine(x=x,fun=pixel_area_function,debugmode=FALSE,chunksize=1,
chunk_format="raster",args=list(CRS=CRS,scaling=scaling),.packages="rgeos")
return(pixel_area)
}

On Fri Jan 09 2015 at 5:21:34 PM Michael Sumner <mdsumner at gmail.com> wrote:

> See ?area in raster for the standard approximation method.
>
> Cheers, Mike
>
> On Sat, 10 Jan 2015 10:15 Forrest Stevens <forrest at ufl.edu> wrote:
>
>> Oops, sorry for the mistake when copying my code in.  Please find the
>> working code for the areas here:
>>
>> r1 <- raster()
>> r1[] <- 1:ncell(r1)
>> p1 <- rasterToPolygons(r1)
>>
>> ## Project to cylindrical equal area:
>> require(rgdal)
>> p2 <- spTransform(p1, CRS("+proj=cea +lat_0=0 +lon_0=0 +lat_ts=30
>> +a=6371228.0 +units=m"))
>>
>> ## Extract areas and assign back to raster:
>> areas <- sapply(slot(p2, "polygons"), slot, "area")
>> r2 <- r1
>> r2[] <- areas
>> plot(r2)
>>
>>
>> Sorry for the confusion!
>>
>> Sincerely,
>> Forrest
>>
>> --
>> Forrest R. Stevens
>> Ph.D. Candidate, QSE3 IGERT Fellow
>> Department of Geography
>> Land Use and Environmental Change Institute
>> University of Florida
>> www.clas.ufl.edu/users/forrest
>>
>>
>> On Fri, Jan 9, 2015 at 6:11 PM, Forrest Stevens <forrest at ufl.edu> wrote:
>> > The easiest way I can think of would be to create an "index" raster
>> > based on your raster of interest, convert it to polygons, project it
>> > to an equal area projection with linear units amenable to you, then
>> > extract the polygon areas and assign them back to your index raster
>> > for weighting.  Perhaps something like this:
>> >
>> >
>> > r1 <- raster()
>> > r1[] <- 1:ncell(r1)
>> > p1 <- rasterToPolygons(r1)
>> >
>> > ## Project to cylindrical equal area:
>> > require(rgdal)
>> > p2 <- spTransform(p1, CRS("+proj=cea +lat_0=0 +lon_0=0 +lat_ts=30
>> > +a=6371228.0 +units=m"))
>> >
>> > ## Extract areas and assign back to raster:
>> > areas <- sapply(slot(p2, "polygons"), slot, "area")
>> > r2 <- r1
>> > plot(r2)
>> >
>> >
>> > Though, maybe someone else has a better way?
>> >
>> > Sincerely,
>> > Forrest
>> > --
>> > Forrest R. Stevens
>> > Ph.D. Candidate, QSE3 IGERT Fellow
>> > Department of Geography
>> > Land Use and Environmental Change Institute
>> > University of Florida
>> > www.clas.ufl.edu/users/forrest
>> >
>> >
>> > On Fri, Jan 9, 2015 at 5:29 PM, Jonathan Greenberg <jgrn at illinois.edu>
>> wrote:
>> >> R-sig-geo'ers:
>> >>
>> >> I have an analysis where I need to take a geographic projection map,
>> e.g.:
>> >>
>> >> r1 <- raster()
>> >>
>> >> And calculate, for each pixel, the square kilometers that each
>> individual
>> >> pixel covers (since they vary across a geographic projection) -- the
>> idea
>> >> is to end up with a map of pixel area.  Can anyone think of a clever
>> way to
>> >> do this?  I'll be using this to do some area weighted summaries, but I
>> >> can't simply reproject the input map.  Thanks!
>> >>
>> >> --j
>> >>
>> >>         [[alternative HTML version deleted]]
>> >>
>> >> _______________________________________________
>> >> R-sig-Geo mailing list
>> >> R-sig-Geo at r-project.org
>> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>

	[[alternative HTML version deleted]]


From tedpopper at hotmail.com  Sat Jan 10 06:02:45 2015
From: tedpopper at hotmail.com (Ted)
Date: Sat, 10 Jan 2015 16:02:45 +1100
Subject: [R-sig-Geo] Cubic variogram models - in vgm( )? elsewhere?
Message-ID: <COL130-W6D9DE447C233E0B79E1A3B2450@phx.gbl>

Hi all -

Apologies if the answer to this is obvious - it isn't to me so any help appreciated.

I have been asked to match in R some kriging done in Isatis (BTW, this is not part
of any assessment task). The model that was used in Isatis was a cubic one. Specifically,
it is a nested cubic one of the form:
??
? Structure 1: Cubic(60', 80') sill = 220
? Structure 2: Cubic(Inf, 80') sill = 100

That's probably more information than needed for my question. Basically it is clear that?
we are dealing with zonal anisotropy (managed by extreme geometric anisotropy).?

But how do I generate a cubic model in R? I have been using vgm() and although cubic
models are not commonly used I have this challenge placed before me and wonder what
I can do in the absence of an explicit "Cub" model ?:-)

I'm not even sure that this is a reasonable request but any guidance gratefully received.

TP

 		 	   		  

From Roger.Bivand at nhh.no  Sat Jan 10 17:03:18 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 10 Jan 2015 17:03:18 +0100
Subject: [R-sig-Geo] group adjacent polygons,
 optimize sum of polygon attributes
In-Reply-To: <BL2PR09MB0516F2C364B1113934E5F78A8470@BL2PR09MB051.namprd09.prod.outlook.com>
References: <BL2PR09MB0516F2C364B1113934E5F78A8470@BL2PR09MB051.namprd09.prod.outlook.com>
Message-ID: <alpine.LRH.2.03.1501101654530.24754@reclus.nhh.no>

On Thu, 8 Jan 2015, Howard, Tim G (DEC) wrote:

> All,

> Given a tessellated set of polygons, each with an attribute of sample 
> size, I want to aggregate these polygons into groups such that the sum 
> of the sample size values reaches a certain threshold while 
> simultaneously maximizing the number of aggregations (groups).  Also, 
> the polygons in the groups (aggregations) would be adjacent.
>
> This seems like a spatial version of the Bin packing problem 
> (http://en.wikipedia.org/wiki/Bin_packing_problem ) or knapsack problem 
> (http://en.wikipedia.org/wiki/Knapsack_problem ).
>
> I can't find reference to relevant optimization approaches to this at 
> the Spatial Task View (http://cran.r-project.org/web/views/Spatial.html 
> ), but I could be looking for the wrong thing.
>
> The closest discussion I've found was this blog entry:
>
> http://www.r-bloggers.com/spatial-clustering-with-equal-sizes/

Maybe think of this like voter re-districting, and if this applies see:

http://www.jstatsoft.org/v42/i04

and the BARD package (now archived):

http://cran.r-project.org/src/contrib/Archive/BARD/

These apply additional equality criteria to expose Gerrymandering, which 
you may not need. In addition, they often take a fixed number of output 
aggregations, but you are interested in maximising them, so you may need 
to step through these.

Maybe also look at AMOEBA, which is less relevant, I think.

Hope this helps,

Roger

>
> This is for a relatively small number of polygons that I want to 
> aggregate (perhaps no more than 200), so a brute force method could 
> potentially work, rather than a true optimization?
>
> Otherwise, I'm not sure where to start. Does anyone have any pointers 
> for what to look for?
>
> Thanks in advance,
> Tim
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From depewd at gmail.com  Sun Jan 11 19:31:47 2015
From: depewd at gmail.com (David Depew)
Date: Sun, 11 Jan 2015 13:31:47 -0500
Subject: [R-sig-Geo] merging polygons and IDs
Message-ID: <CAHadL2DyDyTUgggStU_UmWdO8+4kbuVUK25EpZVM+fxt1Z8aug@mail.gmail.com>

Dear list,

given a set of polygons created from points with a specified buffer
distance,

library(sp)
library(rgeos)
box <- readWKT("POLYGON((0 0, 0 1000, 1000 1000, 1000 0, 0 0))")
plot(box)
set.seed(1)
pts <- spsample(box, n=40, type="random")
pols <- gBuffer(pts, byid=TRUE, width=50)
plot(pols, add=TRUE)


I'd like to merge polygons where the buffers overlap
i.e.
merg.poly=gUnaryUnion(pols)
plot(merg.poly)

but I'm having difficulty figuring out how to specify that the merged
polygons retain some unique Id. Clearly in the package help, one would
specify this by use of the "id" argument, however since the polygons
started as points, overlapping points do not have the same ID. Suppose one
approach is to define a common ID for overlapping polys before using
gUnaryUnion, but I'm at a loss where to begin with that approach. Any
advice would be greatly appreciated,

Thanks,

	[[alternative HTML version deleted]]


From Roger.Bivand at nhh.no  Sun Jan 11 20:57:38 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sun, 11 Jan 2015 20:57:38 +0100
Subject: [R-sig-Geo] merging polygons and IDs
In-Reply-To: <CAHadL2DyDyTUgggStU_UmWdO8+4kbuVUK25EpZVM+fxt1Z8aug@mail.gmail.com>
References: <CAHadL2DyDyTUgggStU_UmWdO8+4kbuVUK25EpZVM+fxt1Z8aug@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1501112046510.28779@reclus.nhh.no>

On Sun, 11 Jan 2015, David Depew wrote:

> Dear list,
>
> given a set of polygons created from points with a specified buffer
> distance,
>
> library(sp)
> library(rgeos)
> box <- readWKT("POLYGON((0 0, 0 1000, 1000 1000, 1000 0, 0 0))")
> plot(box)
> set.seed(1)
> pts <- spsample(box, n=40, type="random")
> pols <- gBuffer(pts, byid=TRUE, width=50)
> plot(pols, add=TRUE)
>
>
> I'd like to merge polygons where the buffers overlap
> i.e.
> merg.poly=gUnaryUnion(pols)
> plot(merg.poly)
>
> but I'm having difficulty figuring out how to specify that the merged
> polygons retain some unique Id. Clearly in the package help, one would
> specify this by use of the "id" argument, however since the polygons
> started as points, overlapping points do not have the same ID. Suppose one
> approach is to define a common ID for overlapping polys before using
> gUnaryUnion, but I'm at a loss where to begin with that approach. Any
> advice would be greatly appreciated,

Thanks for a self-contained example!

Right, this isn't obvious, as you need to go to a list/graph 
representation of the intersects predicate, which takes us outside rgeos. 
We'll compare this with the equivalent for distance neighbours in spdep:

library(spdep)
dnb <- dnearneigh(pts, 0, 100) # 2*50 buffer
nc <- n.comp.nb(dnb) # find graph components
merg.poly <- gUnaryUnion(pols, nc$comp.id)
plot(merg.poly)

which jumps over the buffered objects. To use the buffered objects, do:

gI <- gIntersects(pols, pols, byid=TRUE, returnDense=FALSE) # list
for (i in seq(along=gI)) {gI[[i]] <- gI[[i]][-(which(gI[[i]] == i))];
  if (length(gI[[i]]) == 0) gI[[i]] <- 0L} # remove i<->i edges
class(gI) <- "nb"
attr(gI, "region.id") <- names(gI)
nc1 <- n.comp.nb(gI)
all.equal(nc, nc1) # same result

So what this is doing is having gIntersects return a list. Since i 
intersects i, we have to drop the i<->i edges, pretend that this is an nb 
object, and use the n.comp.nb() function to find the graph components. 
These two approaches give the same results. There is a new vignette in 
spdep starting to look at representations of neighbours as graph objects:

http://cran.r-project.org/web/packages/spdep/vignettes/nb_igraph.html

Hope this helps,

Roger

>
> Thanks,
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From edzer.pebesma at uni-muenster.de  Sun Jan 11 21:11:13 2015
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sun, 11 Jan 2015 21:11:13 +0100
Subject: [R-sig-Geo] Cubic variogram models - in vgm( )? elsewhere?
In-Reply-To: <COL130-W6D9DE447C233E0B79E1A3B2450@phx.gbl>
References: <COL130-W6D9DE447C233E0B79E1A3B2450@phx.gbl>
Message-ID: <54B2D8E1.6040804@uni-muenster.de>



On 01/10/2015 06:02 AM, Ted wrote:
> Hi all -
> 
> Apologies if the answer to this is obvious - it isn't to me so any help appreciated.
> 
> I have been asked to match in R some kriging done in Isatis (BTW, this is not part
> of any assessment task). The model that was used in Isatis was a cubic one. Specifically,
> it is a nested cubic one of the form:
>   
>   Structure 1: Cubic(60', 80') sill = 220
>   Structure 2: Cubic(Inf, 80') sill = 100
> 
> That's probably more information than needed for my question. Basically it is clear that 
> we are dealing with zonal anisotropy (managed by extreme geometric anisotropy). 
> 
> But how do I generate a cubic model in R? I have been using vgm() and although cubic
> models are not commonly used I have this challenge placed before me and wonder what
> I can do in the absence of an explicit "Cub" model  :-)
> 

As you mentioned vgm(), I'll assume you are looking at package gstat in
R, one of the many packages doing geostatistics in R.

You don't specify what the cubic model is. Is it the same as described here:
http://support.sas.com/documentation/cdl/en/statug/63347/HTML/default/viewer.htm#statug_variogram_a0000000579.htm
?

It would be pretty trivial to implement this model in the code behind
vgm(), but hasn't been done; it's the first time I see this model. You
can of course precompute model values and pass these as model "Tab" to
vgm(), (see ?vgm), or you can write your own cubic model R function and
pass that on to gstat::krige0 (which has more limited capabilities than
gstat::krige).

The meaning of your Structure 1 and 2 listed above requires working
knowledge of Isatis - I would recommend to not assume this, and explain
what is meant by them instead.
-- 
Edzer Pebesma,  Co-Editor-in-Chief Computers & Geosciences
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150111/6f46ca9a/attachment.bin>

From kristin.graves at gmail.com  Sun Jan 11 23:51:12 2015
From: kristin.graves at gmail.com (Kristin Graves)
Date: Sun, 11 Jan 2015 17:51:12 -0500
Subject: [R-sig-Geo] GWmodel model.selection.gwr "Input Are Not Correct"
	Error
Message-ID: <CABQqjO+sbJoWx5i5UXpTuSSAEF8bHRH2kbJ8ihHA0ZinxCm62w@mail.gmail.com>

Hello -

I am an R newbie trying to run the model.selection.gwr function in GWmodel,
and am receiving the following error message:
Error in model.selection.gwr(DeVar = kwh_val, InDeVars = gwr_iv, data =
gwr_spdf,  :
  Input are not correct, please recheck!

The error message doesn't provide much info - can anyone provide any hints
or suggestions?  Thanks in advance!

Here is the statement I am running:
gwr_mod<-model.selection.gwr(DeVar=kwh_val, InDeVars=gwr_iv, data=gwr_spdf,
+                              bw=gwr_bw, approach="AIC", adaptive=TRUE,
kernel="gaussian",
+                              dMat=gwr_distmat, longlat=FALSE)


kwh_val is a column in the gwr_spdf spatial points data frame.
Here is the structure of my independent variable matrix gwr_iv:
> str(gwr_iv)
 num [1:255, 1:5] 18320 41544 22240 51246 100422 ...
 - attr(*, "dimnames")=List of 2
  ..$ : NULL
  ..$ : chr [1:5] "annkwh" "cons_mo_val" "dmd_mo_val" "bldg_area" ...

Here is the structure of the bandwidth gwr_bw, created by the bw.gwr
function
> str(gwr_bw)
 num 37

Here is the structure of the distance matrix gwr_distmat, created by the
gw.dist function
> str(gwr_distmat)
 num [1:255, 1:255] 0 0.05093 0.04972 0.04642 0.00943 ...


Kristin Graves

	[[alternative HTML version deleted]]


From r.hijmans at gmail.com  Mon Jan 12 01:46:12 2015
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sun, 11 Jan 2015 16:46:12 -0800
Subject: [R-sig-Geo] merging polygons and IDs
In-Reply-To: <alpine.LRH.2.03.1501112046510.28779@reclus.nhh.no>
References: <CAHadL2DyDyTUgggStU_UmWdO8+4kbuVUK25EpZVM+fxt1Z8aug@mail.gmail.com>
	<alpine.LRH.2.03.1501112046510.28779@reclus.nhh.no>
Message-ID: <CANtt_hxduT+EXFWekCie=MLkiVEyd01jk0E+beK5pnbNDEAp3Q@mail.gmail.com>

David,

I think you could also do this:

library(raster)
a <- disaggregate(aggregate(pols))
ids <-  over(pts, a)

Now you have the aggregated polygons and for each point you know which
polygon it belongs to. Perhaps continue with something like this:

tab <- table(ids, as.integer(names(ids)))
tab <- t(t(tab) * as.integer(colnames(tab)))
x <- apply(tab, 1, function(i) paste(i[i!=0], collapse='_'))
p <- SpatialPolygonsDataFrame(a, data.frame(points=x))
head(p)

Robert

On Sun, Jan 11, 2015 at 11:57 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> On Sun, 11 Jan 2015, David Depew wrote:
>
>> Dear list,
>>
>> given a set of polygons created from points with a specified buffer
>> distance,
>>
>> library(sp)
>> library(rgeos)
>> box <- readWKT("POLYGON((0 0, 0 1000, 1000 1000, 1000 0, 0 0))")
>> plot(box)
>> set.seed(1)
>> pts <- spsample(box, n=40, type="random")
>> pols <- gBuffer(pts, byid=TRUE, width=50)
>> plot(pols, add=TRUE)
>>
>>
>> I'd like to merge polygons where the buffers overlap
>> i.e.
>> merg.poly=gUnaryUnion(pols)
>> plot(merg.poly)
>>
>> but I'm having difficulty figuring out how to specify that the merged
>> polygons retain some unique Id. Clearly in the package help, one would
>> specify this by use of the "id" argument, however since the polygons
>> started as points, overlapping points do not have the same ID. Suppose one
>> approach is to define a common ID for overlapping polys before using
>> gUnaryUnion, but I'm at a loss where to begin with that approach. Any
>> advice would be greatly appreciated,
>
>
> Thanks for a self-contained example!
>
> Right, this isn't obvious, as you need to go to a list/graph representation
> of the intersects predicate, which takes us outside rgeos. We'll compare
> this with the equivalent for distance neighbours in spdep:
>
> library(spdep)
> dnb <- dnearneigh(pts, 0, 100) # 2*50 buffer
> nc <- n.comp.nb(dnb) # find graph components
> merg.poly <- gUnaryUnion(pols, nc$comp.id)
> plot(merg.poly)
>
> which jumps over the buffered objects. To use the buffered objects, do:
>
> gI <- gIntersects(pols, pols, byid=TRUE, returnDense=FALSE) # list
> for (i in seq(along=gI)) {gI[[i]] <- gI[[i]][-(which(gI[[i]] == i))];
>  if (length(gI[[i]]) == 0) gI[[i]] <- 0L} # remove i<->i edges
> class(gI) <- "nb"
> attr(gI, "region.id") <- names(gI)
> nc1 <- n.comp.nb(gI)
> all.equal(nc, nc1) # same result
>
> So what this is doing is having gIntersects return a list. Since i
> intersects i, we have to drop the i<->i edges, pretend that this is an nb
> object, and use the n.comp.nb() function to find the graph components. These
> two approaches give the same results. There is a new vignette in spdep
> starting to look at representations of neighbours as graph objects:
>
> http://cran.r-project.org/web/packages/spdep/vignettes/nb_igraph.html
>
> Hope this helps,
>
> Roger
>
>>
>> Thanks,
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 91 00
> e-mail: Roger.Bivand at nhh.no
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From depewd at gmail.com  Mon Jan 12 02:36:37 2015
From: depewd at gmail.com (David Depew)
Date: Sun, 11 Jan 2015 20:36:37 -0500
Subject: [R-sig-Geo] merging polygons and IDs
In-Reply-To: <CANtt_hxduT+EXFWekCie=MLkiVEyd01jk0E+beK5pnbNDEAp3Q@mail.gmail.com>
References: <CAHadL2DyDyTUgggStU_UmWdO8+4kbuVUK25EpZVM+fxt1Z8aug@mail.gmail.com>
	<alpine.LRH.2.03.1501112046510.28779@reclus.nhh.no>
	<CANtt_hxduT+EXFWekCie=MLkiVEyd01jk0E+beK5pnbNDEAp3Q@mail.gmail.com>
Message-ID: <CAHadL2A_wFhmsWdz6HLWqNz8bVeXW=XcmSU=rwpNR2nOxKTqDw@mail.gmail.com>

Thank you Roger and Robert for your suggestions.
I was able to use disaggregate (package sp) on the "ID-less" merged
polygons result and get what I needed (although it is considerably less
elegant and more clunky than the examples you provided). Using these as
SpatialPolygons with "over" is now much more straightforward.

Thanks again!

On Sun, Jan 11, 2015 at 7:46 PM, Robert J. Hijmans <r.hijmans at gmail.com>
wrote:

> David,
>
> I think you could also do this:
>
> library(raster)
> a <- disaggregate(aggregate(pols))
> ids <-  over(pts, a)
>
> Now you have the aggregated polygons and for each point you know which
> polygon it belongs to. Perhaps continue with something like this:
>
> tab <- table(ids, as.integer(names(ids)))
> tab <- t(t(tab) * as.integer(colnames(tab)))
> x <- apply(tab, 1, function(i) paste(i[i!=0], collapse='_'))
> p <- SpatialPolygonsDataFrame(a, data.frame(points=x))
> head(p)
>
> Robert
>
> On Sun, Jan 11, 2015 at 11:57 AM, Roger Bivand <Roger.Bivand at nhh.no>
> wrote:
> > On Sun, 11 Jan 2015, David Depew wrote:
> >
> >> Dear list,
> >>
> >> given a set of polygons created from points with a specified buffer
> >> distance,
> >>
> >> library(sp)
> >> library(rgeos)
> >> box <- readWKT("POLYGON((0 0, 0 1000, 1000 1000, 1000 0, 0 0))")
> >> plot(box)
> >> set.seed(1)
> >> pts <- spsample(box, n=40, type="random")
> >> pols <- gBuffer(pts, byid=TRUE, width=50)
> >> plot(pols, add=TRUE)
> >>
> >>
> >> I'd like to merge polygons where the buffers overlap
> >> i.e.
> >> merg.poly=gUnaryUnion(pols)
> >> plot(merg.poly)
> >>
> >> but I'm having difficulty figuring out how to specify that the merged
> >> polygons retain some unique Id. Clearly in the package help, one would
> >> specify this by use of the "id" argument, however since the polygons
> >> started as points, overlapping points do not have the same ID. Suppose
> one
> >> approach is to define a common ID for overlapping polys before using
> >> gUnaryUnion, but I'm at a loss where to begin with that approach. Any
> >> advice would be greatly appreciated,
> >
> >
> > Thanks for a self-contained example!
> >
> > Right, this isn't obvious, as you need to go to a list/graph
> representation
> > of the intersects predicate, which takes us outside rgeos. We'll compare
> > this with the equivalent for distance neighbours in spdep:
> >
> > library(spdep)
> > dnb <- dnearneigh(pts, 0, 100) # 2*50 buffer
> > nc <- n.comp.nb(dnb) # find graph components
> > merg.poly <- gUnaryUnion(pols, nc$comp.id)
> > plot(merg.poly)
> >
> > which jumps over the buffered objects. To use the buffered objects, do:
> >
> > gI <- gIntersects(pols, pols, byid=TRUE, returnDense=FALSE) # list
> > for (i in seq(along=gI)) {gI[[i]] <- gI[[i]][-(which(gI[[i]] == i))];
> >  if (length(gI[[i]]) == 0) gI[[i]] <- 0L} # remove i<->i edges
> > class(gI) <- "nb"
> > attr(gI, "region.id") <- names(gI)
> > nc1 <- n.comp.nb(gI)
> > all.equal(nc, nc1) # same result
> >
> > So what this is doing is having gIntersects return a list. Since i
> > intersects i, we have to drop the i<->i edges, pretend that this is an nb
> > object, and use the n.comp.nb() function to find the graph components.
> These
> > two approaches give the same results. There is a new vignette in spdep
> > starting to look at representations of neighbours as graph objects:
> >
> > http://cran.r-project.org/web/packages/spdep/vignettes/nb_igraph.html
> >
> > Hope this helps,
> >
> > Roger
> >
> >>
> >> Thanks,
> >>
> >>         [[alternative HTML version deleted]]
> >>
> >> _______________________________________________
> >> R-sig-Geo mailing list
> >> R-sig-Geo at r-project.org
> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>
> >
> > --
> > Roger Bivand
> > Department of Economics, Norwegian School of Economics,
> > Helleveien 30, N-5045 Bergen, Norway.
> > voice: +47 55 95 93 55; fax +47 55 95 91 00
> > e-mail: Roger.Bivand at nhh.no
> >
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From alobolistas at gmail.com  Mon Jan 12 10:32:36 2015
From: alobolistas at gmail.com (Agustin Lobo)
Date: Mon, 12 Jan 2015 10:32:36 +0100
Subject: [R-sig-Geo] rasterQuad 4d object
Message-ID: <CAG4NReLS0v9fNfioOAMhpUJCNPLkKjkG7iPUtUboUa3yJnop4A@mail.gmail.com>

Back in Apr 09, 2013; 8:53am
Robert Hijmans wrote:
"A RasterBrick is 3D. There is a 4D object RasterQuad designed to work with
the type of data you have, but I have not implemented any methods for it,
so it is currently of no use.../..."

Has any further development been conducted on this RasterQuad object?

Thanks

Agus


From mdsumner at gmail.com  Mon Jan 12 16:18:43 2015
From: mdsumner at gmail.com (Michael Sumner)
Date: Mon, 12 Jan 2015 15:18:43 +0000
Subject: [R-sig-Geo] rasterQuad 4d object
References: <CAG4NReLS0v9fNfioOAMhpUJCNPLkKjkG7iPUtUboUa3yJnop4A@mail.gmail.com>
Message-ID: <CAAcGz9-Mxir-HuCcUf08gpHc1P2BB+ZaGBUzReonnBemha60ig@mail.gmail.com>

No, not afaik. What is your use case? The ones I know are
Visualization -compelling, but hard to do well

Extraction - i e copying data to points/ lines in 4d, easy but not easy to
pre-can.

It comes down to specifics.

Cheers, Mike

On Mon, 12 Jan 2015 20:39 Agustin Lobo <alobolistas at gmail.com> wrote:

> Back in Apr 09, 2013; 8:53am
> Robert Hijmans wrote:
> "A RasterBrick is 3D. There is a 4D object RasterQuad designed to work with
> the type of data you have, but I have not implemented any methods for it,
> so it is currently of no use.../..."
>
> Has any further development been conducted on this RasterQuad object?
>
> Thanks
>
> Agus
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From gbl1 at hi.is  Mon Jan 12 18:38:27 2015
From: gbl1 at hi.is (Gilles Benjamin Leduc)
Date: Mon, 12 Jan 2015 17:38:27 +0000
Subject: [R-sig-Geo] =?utf-8?q?Build_rgdal_for_Yosemite=3F?=
Message-ID: <2a83-54b40680-8f-132f13c0@219153652>

Hi, 

I try to use rgdal on R with OSX Yosemite. I tried then to reinstall it (I upgraded R recently) 

>> library(rgdal)
> Erreur dans library(rgdal) : aucun package nomm? ?rgdal? n'est trouv?
>> install.packages("rgdal")
> --- SVP s?lectionner un miroir CRAN pour cette session ---
>
>   package ?rgdal? is available as a source package but not as a binary
>
> Message d'avis :
> package ?rgdal? is not available (for R version 3.1.2)

How to build it? or can anyone make it available? 

Best regards 
Benjamin Leduc - PhD student in biology, university of Iceland


From alexandresantosbr at yahoo.com.br  Mon Jan 12 20:41:52 2015
From: alexandresantosbr at yahoo.com.br (ASANTOS)
Date: Mon, 12 Jan 2015 16:41:52 -0300
Subject: [R-sig-Geo] Anova and confidence intervals for kppm models in
	spatstat
Message-ID: <54B42380.1060403@yahoo.com.br>

Dear Members,

              I have two questions, first if there are approaches like 
anova.ppm for comparing a clustered point process models kppm in 
spatstat package (example above)? And second the same question for 
estimate the confidence intervals for kppm model parameters, like 
confint() function?

data(bei)
## Model with elevation
fit1 <- kppm(bei, ~elev, "Thomas", covariates = bei.extra)
fit1
##Null model
fit.null <- kppm(bei, ~1, "Thomas", covariates = bei.extra)
fit.null
#Comparing with ANOVA
anova.ppm(fit1,fit.null, test="Chi")
#but don't have anova.kppm?
##Confidence intervals
confint(fit1)

Thanks,

-- 
======================================================================
Alexandre dos Santos
Prote??o Florestal
IFMT - Instituto Federal de Educa??o, Ci?ncia e Tecnologia de Mato Grosso
Campus C?ceres
Caixa Postal 244
Avenida dos Ramires, s/n
Bairro: Distrito Industrial
C?ceres - MT                      CEP: 78.200-000
Fone: (+55) 65 8132-8112 (TIM)   (+55) 65 9686-6970 (VIVO)

         alexandre.santos at cas.ifmt.edu.br
Lattes: http://lattes.cnpq.br/1360403201088680
======================================================================


---
Este email foi escaneado pelo Avast antiv?rus.
http://www.avast.com


From Roger.Bivand at nhh.no  Mon Jan 12 21:50:50 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 12 Jan 2015 21:50:50 +0100
Subject: [R-sig-Geo] Build rgdal for Yosemite?
In-Reply-To: <2a83-54b40680-8f-132f13c0@219153652>
References: <2a83-54b40680-8f-132f13c0@219153652>
Message-ID: <alpine.LRH.2.03.1501122149530.12304@reclus.nhh.no>

On Mon, 12 Jan 2015, Gilles Benjamin Leduc wrote:

> Hi, 
>
> I try to use rgdal on R with OSX Yosemite. I tried then to reinstall it 
> (I upgraded R recently)

Please follow this thread:

https://stat.ethz.ch/pipermail/r-sig-geo/2014-November/022029.html

and report back to the list on your experiences.

Roger

>
>>> library(rgdal)
>> Erreur dans library(rgdal) : aucun package nomm? ?rgdal? n'est trouv?
>>> install.packages("rgdal")
>> --- SVP s?lectionner un miroir CRAN pour cette session ---
>>
>>   package ?rgdal? is available as a source package but not as a binary
>>
>> Message d'avis :
>> package ?rgdal? is not available (for R version 3.1.2)
>
> How to build it? or can anyone make it available? 
>
> Best regards 
> Benjamin Leduc - PhD student in biology, university of Iceland
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no

From Rainer at krugs.de  Tue Jan 13 09:50:27 2015
From: Rainer at krugs.de (Rainer M Krug)
Date: Tue, 13 Jan 2015 09:50:27 +0100
Subject: [R-sig-Geo] Build rgdal for Yosemite?
In-Reply-To: <2a83-54b40680-8f-132f13c0@219153652> (Gilles Benjamin Leduc's
	message of "Mon, 12 Jan 2015 17:38:27 +0000")
References: <2a83-54b40680-8f-132f13c0@219153652>
Message-ID: <m21tmz12uk.fsf@krugs.de>


"Gilles Benjamin Leduc" <gbl1 at hi.is> writes:

> Hi, 
>
> I try to use rgdal on R with OSX Yosemite. I tried then to reinstall it (I upgraded R recently) 
>
>>> library(rgdal)
>> Erreur dans library(rgdal) : aucun package nomm? ?rgdal? n'est trouv?
>>> install.packages("rgdal")
>> --- SVP s?lectionner un miroir CRAN pour cette session ---
>>
>>   package ?rgdal? is available as a source package but not as a binary
>>
>> Message d'avis :
>> package ?rgdal? is not available (for R version 3.1.2)
>
> How to build it? or can anyone make it available? 


There are quite a few ways of installing rgdal on yosemite and it
depends how you installed gdal (and R?).

I installed gdal (and R) using homebrew [1] and it worked, after
pointing gdal to the installation directory of gdal, without problems.

Cheers,

Rainer

>
> Best regards 
> Benjamin Leduc - PhD student in biology, university of Iceland
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


Footnotes: 
[1]  http://brew.sh/

-- 
Rainer M. Krug
email: Rainer<at>krugs<dot>de
PGP: 0x0F52F982
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 494 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150113/7da709a3/attachment.bin>

From alobolistas at gmail.com  Tue Jan 13 10:18:51 2015
From: alobolistas at gmail.com (Agustin Lobo)
Date: Tue, 13 Jan 2015 10:18:51 +0100
Subject: [R-sig-Geo] rasterQuad 4d object
In-Reply-To: <CAAcGz9-Mxir-HuCcUf08gpHc1P2BB+ZaGBUzReonnBemha60ig@mail.gmail.com>
References: <CAG4NReLS0v9fNfioOAMhpUJCNPLkKjkG7iPUtUboUa3yJnop4A@mail.gmail.com>
	<CAAcGz9-Mxir-HuCcUf08gpHc1P2BB+ZaGBUzReonnBemha60ig@mail.gmail.com>
Message-ID: <CAG4NReJcCLrCqEuY_=0Y4=dws57uU9oW1Fc_MCptatimc0==CQ@mail.gmail.com>

It is a sismic study: a 3d array of velocity of P waves.
I think that calcualting the 3d gradient is possible in R for small 3d arrays,
but even moderate sizes would require an extension of the current raster brick.
There might be specific tools outside R (i.e. in python), but do not
know for sure.
I've seen this package that might help:
http://cran.r-project.org/web/packages/geotopbricks/
Expert opinion on this or any other alternative tool would be appreciated,
Thanks
Agus

On Mon, Jan 12, 2015 at 4:18 PM, Michael Sumner <mdsumner at gmail.com> wrote:
> No, not afaik. What is your use case? The ones I know are
> Visualization -compelling, but hard to do well
>
> Extraction - i e copying data to points/ lines in 4d, easy but not easy to
> pre-can.
>
> It comes down to specifics.
>
> Cheers, Mike
>
> On Mon, 12 Jan 2015 20:39 Agustin Lobo <alobolistas at gmail.com> wrote:
>
>> Back in Apr 09, 2013; 8:53am
>> Robert Hijmans wrote:
>> "A RasterBrick is 3D. There is a 4D object RasterQuad designed to work with
>> the type of data you have, but I have not implemented any methods for it,
>> so it is currently of no use.../..."
>>
>> Has any further development been conducted on this RasterQuad object?
>>
>> Thanks
>>
>> Agus
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From kridox at ymail.com  Tue Jan 13 10:34:24 2015
From: kridox at ymail.com (Pascal Oettli)
Date: Tue, 13 Jan 2015 18:34:24 +0900
Subject: [R-sig-Geo] rasterQuad 4d object
In-Reply-To: <CAAcGz9-Mxir-HuCcUf08gpHc1P2BB+ZaGBUzReonnBemha60ig@mail.gmail.com>
References: <CAG4NReLS0v9fNfioOAMhpUJCNPLkKjkG7iPUtUboUa3yJnop4A@mail.gmail.com>
	<CAAcGz9-Mxir-HuCcUf08gpHc1P2BB+ZaGBUzReonnBemha60ig@mail.gmail.com>
Message-ID: <CAAcyNCzqWpnTdeDKZRz7_HTNeEY-7ZfMooF45=djHq+Os_KLgQ@mail.gmail.com>

It might be interesting to have this class to deal with [longitude x
latitude x level x time]-type NetCDF files. And thus to avoid loops.

Regards,
Pascal

On Tue, Jan 13, 2015 at 12:18 AM, Michael Sumner <mdsumner at gmail.com> wrote:
> No, not afaik. What is your use case? The ones I know are
> Visualization -compelling, but hard to do well
>
> Extraction - i e copying data to points/ lines in 4d, easy but not easy to
> pre-can.
>
> It comes down to specifics.
>
> Cheers, Mike
>
> On Mon, 12 Jan 2015 20:39 Agustin Lobo <alobolistas at gmail.com> wrote:
>
>> Back in Apr 09, 2013; 8:53am
>> Robert Hijmans wrote:
>> "A RasterBrick is 3D. There is a 4D object RasterQuad designed to work with
>> the type of data you have, but I have not implemented any methods for it,
>> so it is currently of no use.../..."
>>
>> Has any further development been conducted on this RasterQuad object?
>>
>> Thanks
>>
>> Agus
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From alobolistas at gmail.com  Tue Jan 13 11:13:53 2015
From: alobolistas at gmail.com (Agustin Lobo)
Date: Tue, 13 Jan 2015 11:13:53 +0100
Subject: [R-sig-Geo] rasterQuad 4d object
In-Reply-To: <CAAcyNCzqWpnTdeDKZRz7_HTNeEY-7ZfMooF45=djHq+Os_KLgQ@mail.gmail.com>
References: <CAG4NReLS0v9fNfioOAMhpUJCNPLkKjkG7iPUtUboUa3yJnop4A@mail.gmail.com>
	<CAAcGz9-Mxir-HuCcUf08gpHc1P2BB+ZaGBUzReonnBemha60ig@mail.gmail.com>
	<CAAcyNCzqWpnTdeDKZRz7_HTNeEY-7ZfMooF45=djHq+Os_KLgQ@mail.gmail.com>
Message-ID: <CAG4NRe+ELG-MBuLachtGEtEwVRGRUKqRsf16WRTU7H2ciLd=mg@mail.gmail.com>

We have levels of increasing complexity:

First, the positioning
1. Location in 2D (x,y)
2. Location in surface 3D (x,y,z), but only 1 z for each x,y pair (the
common case in geography and remote sensing)
3. Location in full 3D (x,y,z), with a vector of z for each (x,y) pair
(the common case in geology, oceanography, some biomedical imaging)

Then the measured variable at each location.
U. Univariate (i.e., veetation index)
M. Multivariate (i.e. reflectance along wavelength)

And finally the time
S. Single observation
R. Repeated observations

Obviously package raster cannot deal with all combinations, the
developers made their options.

For sure raster deals well with
1US
1UR
1MS

The specific case of the 2U of a DEM is dealt with as a 1US

The problem is the rest. In the specific case I have mentioned, I would need
3US

I think Pascal refers to
2UR or 3UR

A lot more complicated...

Agus

On Tue, Jan 13, 2015 at 10:34 AM, Pascal Oettli <kridox at ymail.com> wrote:
> It might be interesting to have this class to deal with [longitude x
> latitude x level x time]-type NetCDF files. And thus to avoid loops.
>
> Regards,
> Pascal
>
> On Tue, Jan 13, 2015 at 12:18 AM, Michael Sumner <mdsumner at gmail.com> wrote:
>> No, not afaik. What is your use case? The ones I know are
>> Visualization -compelling, but hard to do well
>>
>> Extraction - i e copying data to points/ lines in 4d, easy but not easy to
>> pre-can.
>>
>> It comes down to specifics.
>>
>> Cheers, Mike
>>
>> On Mon, 12 Jan 2015 20:39 Agustin Lobo <alobolistas at gmail.com> wrote:
>>
>>> Back in Apr 09, 2013; 8:53am
>>> Robert Hijmans wrote:
>>> "A RasterBrick is 3D. There is a 4D object RasterQuad designed to work with
>>> the type of data you have, but I have not implemented any methods for it,
>>> so it is currently of no use.../..."
>>>
>>> Has any further development been conducted on this RasterQuad object?
>>>
>>> Thanks
>>>
>>> Agus
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From edzer.pebesma at uni-muenster.de  Tue Jan 13 11:30:21 2015
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 13 Jan 2015 11:30:21 +0100
Subject: [R-sig-Geo] rasterQuad 4d object
In-Reply-To: <CAG4NRe+ELG-MBuLachtGEtEwVRGRUKqRsf16WRTU7H2ciLd=mg@mail.gmail.com>
References: <CAG4NReLS0v9fNfioOAMhpUJCNPLkKjkG7iPUtUboUa3yJnop4A@mail.gmail.com>	<CAAcGz9-Mxir-HuCcUf08gpHc1P2BB+ZaGBUzReonnBemha60ig@mail.gmail.com>	<CAAcyNCzqWpnTdeDKZRz7_HTNeEY-7ZfMooF45=djHq+Os_KLgQ@mail.gmail.com>
	<CAG4NRe+ELG-MBuLachtGEtEwVRGRUKqRsf16WRTU7H2ciLd=mg@mail.gmail.com>
Message-ID: <54B4F3BD.8040405@uni-muenster.de>

The data structures in package spacetime can handle 3US and 3MS (STFDF)
and 3[UM]R with STIDF; the limitation is that it puts all data in
memory, and your use case probably has requirements nobody has tried out
before, so appropriate methods are likely to be incomplete or lacking.

On 01/13/2015 11:13 AM, Agustin Lobo wrote:
> We have levels of increasing complexity:
> 
> First, the positioning
> 1. Location in 2D (x,y)
> 2. Location in surface 3D (x,y,z), but only 1 z for each x,y pair (the
> common case in geography and remote sensing)
> 3. Location in full 3D (x,y,z), with a vector of z for each (x,y) pair
> (the common case in geology, oceanography, some biomedical imaging)
> 
> Then the measured variable at each location.
> U. Univariate (i.e., veetation index)
> M. Multivariate (i.e. reflectance along wavelength)
> 
> And finally the time
> S. Single observation
> R. Repeated observations
> 
> Obviously package raster cannot deal with all combinations, the
> developers made their options.
> 
> For sure raster deals well with
> 1US
> 1UR
> 1MS
> 
> The specific case of the 2U of a DEM is dealt with as a 1US
> 
> The problem is the rest. In the specific case I have mentioned, I would need
> 3US
> 
> I think Pascal refers to
> 2UR or 3UR
> 
> A lot more complicated...
> 
> Agus
> 
> On Tue, Jan 13, 2015 at 10:34 AM, Pascal Oettli <kridox at ymail.com> wrote:
>> It might be interesting to have this class to deal with [longitude x
>> latitude x level x time]-type NetCDF files. And thus to avoid loops.
>>
>> Regards,
>> Pascal
>>
>> On Tue, Jan 13, 2015 at 12:18 AM, Michael Sumner <mdsumner at gmail.com> wrote:
>>> No, not afaik. What is your use case? The ones I know are
>>> Visualization -compelling, but hard to do well
>>>
>>> Extraction - i e copying data to points/ lines in 4d, easy but not easy to
>>> pre-can.
>>>
>>> It comes down to specifics.
>>>
>>> Cheers, Mike
>>>
>>> On Mon, 12 Jan 2015 20:39 Agustin Lobo <alobolistas at gmail.com> wrote:
>>>
>>>> Back in Apr 09, 2013; 8:53am
>>>> Robert Hijmans wrote:
>>>> "A RasterBrick is 3D. There is a 4D object RasterQuad designed to work with
>>>> the type of data you have, but I have not implemented any methods for it,
>>>> so it is currently of no use.../..."
>>>>
>>>> Has any further development been conducted on this RasterQuad object?
>>>>
>>>> Thanks
>>>>
>>>> Agus
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma,  Co-Editor-in-Chief Computers & Geosciences
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150113/257edfcc/attachment.bin>

From r.turner at auckland.ac.nz  Tue Jan 13 21:58:10 2015
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Wed, 14 Jan 2015 09:58:10 +1300
Subject: [R-sig-Geo] Anova and confidence intervals for kppm models in
 spatstat
In-Reply-To: <54B42380.1060403@yahoo.com.br>
References: <54B42380.1060403@yahoo.com.br>
Message-ID: <54B586E2.20806@auckland.ac.nz>

On 13/01/15 08:41, ASANTOS wrote:
> Dear Members,
>
>               I have two questions, first if there are approaches like
> anova.ppm for comparing a clustered point process models kppm in
> spatstat package (example above)? And second the same question for
> estimate the confidence intervals for kppm model parameters, like
> confint() function?
>
> data(bei)
> ## Model with elevation
> fit1 <- kppm(bei, ~elev, "Thomas", covariates = bei.extra)
> fit1
> ##Null model
> fit.null <- kppm(bei, ~1, "Thomas", covariates = bei.extra)
> fit.null
> #Comparing with ANOVA
> anova.ppm(fit1,fit.null, test="Chi")
> #but don't have anova.kppm?
> ##Confidence intervals
> confint(fit1)

The short answer is "no".  A somewhat longer answer:  If the method of 
minimum contrast is used, there is no analogue of the log likelihood 
ratio available and consequently no form of "anova" based on the 
likelihood ratio test could possibly be done.  If either of the other 
two methods ("clik2" or "palm") were used then at least conceivably some 
form of anova *could* be done, but this possibility is not yet implemented.

Further theoretical development is needed. Adjustment of the analogue of 
the likelihood ratio is required in order for this statistic to have the 
required chi-squared null distribution, and the theory for this 
adjustment needs to be worked out.  This is on our "to-do list" but 
probably will not happen soon.

The necessary theory underlying the use of anova.ppm() for Gibbs models 
has only recently become available.  See the references given in the 
help for anova.ppm.  Previously anova could only be applied to *Poisson* 
models fitted to point patterns.

Until further development is carried out you will have to get by on 
Monte Carlo methods.

cheers,

Rolf Turner

-- 
Rolf Turner
Technical Editor ANZJS
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276
Home phone: +64-9-480-4619


From dave.gregovich at alaska.gov  Wed Jan 14 02:48:36 2015
From: dave.gregovich at alaska.gov (Gregovich, Dave P (DFG))
Date: Wed, 14 Jan 2015 01:48:36 +0000
Subject: [R-sig-Geo] Error when predicting a randomForest model to a raster
Message-ID: <174524AB15B8E6478D6F927B2131B09B7BB66445@SOAJNUEXMB3.soa.alaska.gov>

Hello,
Thanks kindly aforehand for any help you can lend. I am trying to perform a simple classification of coarse vegetation types. I am getting an error when trying to predict a randomForest model to a raster:
#Error in if (any(is.na(x))) stop("missing values in newdata") :
#  argument is not interpretable as logical

Here is some reproducible code if anyone happens to have the time to give it a shot:
_________________________________________________________________
library(raster)
library(randomForest)

#create random color band rasters and fill with values
a<-b<-d<-raster(nrows=10,ncols=10)
a[]<-sample(0:255,ncell(a))
b[]<-sample(0:255,ncell(a))
d[]<-sample(0:255,ncell(a))
rgb.rast<-stack(a,b,d)
names(rgb.rast)<-c('red','green','blue')


#create mock random forest covariate data
color.offsets<-c(0,20,40)
color.means<-c(40,80,120,160)

color.mat<-sapply(1:length(color.means),function(x){
                                                sapply(1:length(color.offsets),function(y){
                                                                round(rnorm(30,color.means[x]+color.offsets[y],sd=1))
                                                })
                                })
color.frame<-as.data.frame(color.mat)
names(color.frame)<-c('red','green','blue')


#create mock response data
response<-as.factor(rep(1:3,each=30))

#run random forest model
rf.mod<-randomForest(color.frame,response)

#attempt prediction
rf.predict<-predict(rf.mod,rgb.rast)
#error message---
#Error in if (any(is.na(x))) stop("missing values in newdata") :
#  argument is not interpretable as logical
_____________________________________________
> sessionInfo()
R version 3.0.3 (2014-03-06)
Platform: x86_64-w64-mingw32/x64 (64-bit)

locale:
[1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United States.1252    LC_MONETARY=English_United States.1252 LC_NUMERIC=C                           LC_TIME=English_United States.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] randomForest_4.6-10 rgdal_0.9-1         raster_2.2-31       sp_1.0-15

loaded via a namespace (and not attached):
[1] grid_3.0.3      lattice_0.20-27 tools_3.0.3


Thanks a ton folks for any help you can lend!
__________________________________
Dave Gregovich
Research Analyst
Alaska Department of Fish and Game
Wildlife Conservation Division
Douglas, AK 99821
(907) 465-4291
dave.gregovich at alaska.gov
__________________________________


	[[alternative HTML version deleted]]


From r.hijmans at gmail.com  Wed Jan 14 03:09:00 2015
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 13 Jan 2015 18:09:00 -0800
Subject: [R-sig-Geo] Error when predicting a randomForest model to a
	raster
In-Reply-To: <174524AB15B8E6478D6F927B2131B09B7BB66445@SOAJNUEXMB3.soa.alaska.gov>
References: <174524AB15B8E6478D6F927B2131B09B7BB66445@SOAJNUEXMB3.soa.alaska.gov>
Message-ID: <CANtt_hzbjAQ22Kjd9XwHcZVOZZ2cOkvuO_LM42Ap7A4n0W2jiw@mail.gmail.com>

Dave,

The example works if you do

rf.mod <- randomForest(color.frame[, c('red','green','blue')],response)

instead of

rf.mod <- randomForest(color.frame,response)

color.frame has 4 variables, one with column name "NA". Given that you
use names(color.frame) <- c('red','green','blue')  it seems that this
is not intentional

Robert




On Tue, Jan 13, 2015 at 5:48 PM, Gregovich, Dave P (DFG)
<dave.gregovich at alaska.gov> wrote:
> Hello,
> Thanks kindly aforehand for any help you can lend. I am trying to perform a simple classification of coarse vegetation types. I am getting an error when trying to predict a randomForest model to a raster:
> #Error in if (any(is.na(x))) stop("missing values in newdata") :
> #  argument is not interpretable as logical
>
> Here is some reproducible code if anyone happens to have the time to give it a shot:
> _________________________________________________________________
> library(raster)
> library(randomForest)
>
> #create random color band rasters and fill with values
> a<-b<-d<-raster(nrows=10,ncols=10)
> a[]<-sample(0:255,ncell(a))
> b[]<-sample(0:255,ncell(a))
> d[]<-sample(0:255,ncell(a))
> rgb.rast<-stack(a,b,d)
> names(rgb.rast)<-c('red','green','blue')
>
>
> #create mock random forest covariate data
> color.offsets<-c(0,20,40)
> color.means<-c(40,80,120,160)
>
> color.mat<-sapply(1:length(color.means),function(x){
>                                                 sapply(1:length(color.offsets),function(y){
>                                                                 round(rnorm(30,color.means[x]+color.offsets[y],sd=1))
>                                                 })
>                                 })
> color.frame<-as.data.frame(color.mat)
> names(color.frame)<-c('red','green','blue')
>
>
> #create mock response data
> response<-as.factor(rep(1:3,each=30))
>
> #run random forest model
> rf.mod<-randomForest(color.frame,response)
>
> #attempt prediction
> rf.predict<-predict(rf.mod,rgb.rast)
> #error message---
> #Error in if (any(is.na(x))) stop("missing values in newdata") :
> #  argument is not interpretable as logical
> _____________________________________________
>> sessionInfo()
> R version 3.0.3 (2014-03-06)
> Platform: x86_64-w64-mingw32/x64 (64-bit)
>
> locale:
> [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United States.1252    LC_MONETARY=English_United States.1252 LC_NUMERIC=C                           LC_TIME=English_United States.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] randomForest_4.6-10 rgdal_0.9-1         raster_2.2-31       sp_1.0-15
>
> loaded via a namespace (and not attached):
> [1] grid_3.0.3      lattice_0.20-27 tools_3.0.3
>
>
> Thanks a ton folks for any help you can lend!
> __________________________________
> Dave Gregovich
> Research Analyst
> Alaska Department of Fish and Game
> Wildlife Conservation Division
> Douglas, AK 99821
> (907) 465-4291
> dave.gregovich at alaska.gov
> __________________________________
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From r.hijmans at gmail.com  Wed Jan 14 03:10:43 2015
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 13 Jan 2015 18:10:43 -0800
Subject: [R-sig-Geo] Error when predicting a randomForest model to a
	raster
In-Reply-To: <CANtt_hzbjAQ22Kjd9XwHcZVOZZ2cOkvuO_LM42Ap7A4n0W2jiw@mail.gmail.com>
References: <174524AB15B8E6478D6F927B2131B09B7BB66445@SOAJNUEXMB3.soa.alaska.gov>
	<CANtt_hzbjAQ22Kjd9XwHcZVOZZ2cOkvuO_LM42Ap7A4n0W2jiw@mail.gmail.com>
Message-ID: <CANtt_hwyqV40XAtUR018iQ0PjjB9f+GCeFEgB29u8VvRe8Tmkw@mail.gmail.com>

P.S. you also need to do:

rf.predict <- predict(rgb.rast, rf.mod)

Not

rf.predict <- predict(rf.mod, rgb.rast)

Robert

On Tue, Jan 13, 2015 at 6:09 PM, Robert J. Hijmans <r.hijmans at gmail.com> wrote:
> Dave,
>
> The example works if you do
>
> rf.mod <- randomForest(color.frame[, c('red','green','blue')],response)
>
> instead of
>
> rf.mod <- randomForest(color.frame,response)
>
> color.frame has 4 variables, one with column name "NA". Given that you
> use names(color.frame) <- c('red','green','blue')  it seems that this
> is not intentional
>
> Robert
>
>
>
>
> On Tue, Jan 13, 2015 at 5:48 PM, Gregovich, Dave P (DFG)
> <dave.gregovich at alaska.gov> wrote:
>> Hello,
>> Thanks kindly aforehand for any help you can lend. I am trying to perform a simple classification of coarse vegetation types. I am getting an error when trying to predict a randomForest model to a raster:
>> #Error in if (any(is.na(x))) stop("missing values in newdata") :
>> #  argument is not interpretable as logical
>>
>> Here is some reproducible code if anyone happens to have the time to give it a shot:
>> _________________________________________________________________
>> library(raster)
>> library(randomForest)
>>
>> #create random color band rasters and fill with values
>> a<-b<-d<-raster(nrows=10,ncols=10)
>> a[]<-sample(0:255,ncell(a))
>> b[]<-sample(0:255,ncell(a))
>> d[]<-sample(0:255,ncell(a))
>> rgb.rast<-stack(a,b,d)
>> names(rgb.rast)<-c('red','green','blue')
>>
>>
>> #create mock random forest covariate data
>> color.offsets<-c(0,20,40)
>> color.means<-c(40,80,120,160)
>>
>> color.mat<-sapply(1:length(color.means),function(x){
>>                                                 sapply(1:length(color.offsets),function(y){
>>                                                                 round(rnorm(30,color.means[x]+color.offsets[y],sd=1))
>>                                                 })
>>                                 })
>> color.frame<-as.data.frame(color.mat)
>> names(color.frame)<-c('red','green','blue')
>>
>>
>> #create mock response data
>> response<-as.factor(rep(1:3,each=30))
>>
>> #run random forest model
>> rf.mod<-randomForest(color.frame,response)
>>
>> #attempt prediction
>> rf.predict<-predict(rf.mod,rgb.rast)
>> #error message---
>> #Error in if (any(is.na(x))) stop("missing values in newdata") :
>> #  argument is not interpretable as logical
>> _____________________________________________
>>> sessionInfo()
>> R version 3.0.3 (2014-03-06)
>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>>
>> locale:
>> [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United States.1252    LC_MONETARY=English_United States.1252 LC_NUMERIC=C                           LC_TIME=English_United States.1252
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> other attached packages:
>> [1] randomForest_4.6-10 rgdal_0.9-1         raster_2.2-31       sp_1.0-15
>>
>> loaded via a namespace (and not attached):
>> [1] grid_3.0.3      lattice_0.20-27 tools_3.0.3
>>
>>
>> Thanks a ton folks for any help you can lend!
>> __________________________________
>> Dave Gregovich
>> Research Analyst
>> Alaska Department of Fish and Game
>> Wildlife Conservation Division
>> Douglas, AK 99821
>> (907) 465-4291
>> dave.gregovich at alaska.gov
>> __________________________________
>>
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From gbl1 at hi.is  Wed Jan 14 18:34:48 2015
From: gbl1 at hi.is (Gilles Benjamin Leduc)
Date: Wed, 14 Jan 2015 17:34:48 +0000
Subject: [R-sig-Geo] =?utf-8?q?Build_rgdal_for_Yosemite=3F?=
In-Reply-To: <alpine.LRH.2.03.1501122149530.12304@reclus.nhh.no>
Message-ID: <2967-54b6a880-21b-1bb225a@129094270>

Thanks to you, 

The command :
setRepositories(ind = c(1,6)) 
Has allowed to install rgdal. 

Only issue: it has installed an old version (with availlable binaries) whereas there is much more recent sources ? 

Now, I just have to play with projections, and understand how it works. 

Have a nice day

Benjamin  
 
 
On Monday, January 12, 2015 20:50 GMT, Roger Bivand <Roger.Bivand at nhh.no> wrote: 
 
> On Mon, 12 Jan 2015, Gilles Benjamin Leduc wrote:
> 
> > Hi, 
> >
> > I try to use rgdal on R with OSX Yosemite. I tried then to reinstall it 
> > (I upgraded R recently)
> 
> Please follow this thread:
> 
> https://stat.ethz.ch/pipermail/r-sig-geo/2014-November/022029.html
> 
> and report back to the list on your experiences.
> 
> Roger
> 
> >
> >>> library(rgdal)
> >> Erreur dans library(rgdal) : aucun package nomm? ?rgdal? n'est trouv?
> >>> install.packages("rgdal")
> >> --- SVP s?lectionner un miroir CRAN pour cette session ---
> >>
> >>   package ?rgdal? is available as a source package but not as a binary
> >>
> >> Message d'avis :
> >> package ?rgdal? is not available (for R version 3.1.2)
> >
> > How to build it? or can anyone make it available? 
> >
> > Best regards 
> > Benjamin Leduc - PhD student in biology, university of Iceland
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> -- 
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 91 00
> e-mail: Roger.Bivand at nhh.no


From ftonini84 at gmail.com  Wed Jan 14 18:51:47 2015
From: ftonini84 at gmail.com (Francesco Tonini)
Date: Wed, 14 Jan 2015 12:51:47 -0500
Subject: [R-sig-Geo] Issues with R focal (raster package)
In-Reply-To: <54B6AC02.9010800@ncsu.edu>
References: <54B6AC02.9010800@ncsu.edu>
Message-ID: <54B6ACB3.30203@gmail.com>

Dear all,

I was wondering if any of you could help me with the following task 
dealing with the focal() function in the R raster package.

By default, the focal() function will run through each cell of a given 
raster ('background' raster hereafter) and apply a given function to the 
neighboring values as defined by a user-defined moving window. In order 
to optimize and speed up my computation on large rasters/study areas, I 
would like to apply this function (filter) only when the 'background' 
raster has some values (e.g. greater than zero) within the extent 
covered by the 'moving window' and skip all the other focal cells. This 
way, the filter would not spend time computing any focal value where 
there is no need to.

Below a reproducible small example and in-line comments:

|library(raster)

x<-  matrix(1:25,  ncol=5)
x[c(1,2,3,6,7,8,11,12,13)]  <-  0
r<-  raster(x)

#Apply filter to focal cells and return values using a 3x3 moving window...ONLY IF
#ALL values found within the window are > 0. Skip focal cell otherwise.

r3<-  focal(r,  w=matrix(1/9,nrow=3,ncol=3),  FUN=sum)|

How should I change this function to have the desired outcome?


Thank you.
Francesco

	[[alternative HTML version deleted]]


From alobolistas at gmail.com  Thu Jan 15 08:43:37 2015
From: alobolistas at gmail.com (Agustin Lobo)
Date: Thu, 15 Jan 2015 08:43:37 +0100
Subject: [R-sig-Geo] Extract with Large Rasters
In-Reply-To: <CAPKp32sxQBhYRryHStrJahOtbFXa2mem6Ov-LNSgbFPw+yAS7Q@mail.gmail.com>
References: <CAPKp32vcJ+0WVTZL1mA_NeaqPrSfcFCgsk+=w4i87TPUZ4YHOw@mail.gmail.com>
	<CAAcGz9-XnMdAJG+MrnMX2D2r3jHX2vRjom4+Ub4qUdvX7-z-XQ@mail.gmail.com>
	<CANtt_hypODXRs3zgjdQnkWKKsxAXPBWOdqjD0Mbm76qoMXypeA@mail.gmail.com>
	<CAPKp32sxQBhYRryHStrJahOtbFXa2mem6Ov-LNSgbFPw+yAS7Q@mail.gmail.com>
Message-ID: <CAG4NReJvAr21P7zMN1f=voVOuxT_M+c6_Z6tjJL4Ky8414oDFw@mail.gmail.com>

Michael,
was this issue ever fully clarifed?
Thanks
Agus

On Thu, Dec 18, 2014 at 7:54 PM, Michael Treglia <mtreglia at gmail.com> wrote:
> Thanks Mike and Robert,
>
> Avoiding using @ didn't seem to help this problem. Also, I can do the
> extract using the same exact points with different rasters (e.g., Bioclim
> variables or a coarser DEM), so it doesn't seem to be a problem with the
> points [Robert, if you still think they might pose an issue, let me know
> and I'll send them off-list; I've included the specs of the points below
> too though].
>
> I realized I could clip the raster a bit and did so in with gdalwarp
> (outside of R), and the extract worked without issue. I'm still curious to
> figure out why it won't work with the original raster file though and I'm
> all ears for suggestions, in case it can save me or others some trouble in
> the future
>
> Also, the reason I was using the @ was because I am ultimately doing this
> for a stack of rasters, and would like to have all the raster fields added
> to the SpatialPointsDataFrame. Is there a more preferred way to do that? I
> see that if you do a hypothetical
>>pts$field <- extract(stack, pts)
> you get the values from the whole stack, but the columns have the prefix of
> 'field'.  (I realize you can just rename columns after doing the extract)
>
> Here's are the specs of the clipped Raster (for which the extract() works):
> class       : RasterLayer
> dimensions  : 35410, 39925, 1413744250  (nrow, ncol, ncell)
> resolution  : 9.332523, 9.332448  (x, y)
> extent      : 273952, 646553, 3885751, 4216213  (xmin, xmax, ymin, ymax)
> coord. ref. : +proj=utm +zone=15 +datum=WGS84 +units=m +no_defs
> +ellps=WGS84 +towgs84=0,0,0
> data source : D:\GISData\Clipped_10mDEM.tif
> names       : Clipped_10mDEM
>
> Here are the specs of the original (for which the extract() doesn't work):
> class       : RasterLayer
> dimensions  : 59901, 49494, 2964740094  (nrow, ncol, ncell)
> resolution  : 9.332575, 9.332575  (x, y)
> extent      : 222855.6, 684762, 3762092, 4321122  (xmin, xmax, ymin, ymax)
> coord. ref. : +proj=utm +zone=15 +datum=WGS84 +units=m +no_defs
> +ellps=WGS84 +towgs84=0,0,0
> data source : D:\GISData\n35w092_n39_w096_UTM_cubic.tif
> names       : n35w092_n39_w096_UTM_cubic
>
> Here are the Specs of the Points [excluding field names and max/min values]:
> class       : SpatialPointsDataFrame
> features    : 159
> extent      : 300852.6, 611979.9, 3910111, 4196814  (xmin, xmax, ymin, ymax)
> coord. ref. : +proj=utm +zone=15 +datum=WGS84 +units=m +no_defs
> +ellps=WGS84 +towgs84=0,0,0
> variables   : 16
>
> Thanks again!
> Mike T
>
>
>
>
>
> On Wed, Dec 17, 2014 at 2:06 PM, Robert J. Hijmans <r.hijmans at gmail.com>
> wrote:
>>
>> From the traceback
>>
>> 8: .readCellsGDAL(x, uniquecells, layers)
>>
>> it seems to me that the error occurs here:
>>
>> extract(elev, points)
>>
>> and that it has nothing to do with the size of the raster.  I am not
>> sure what causes it.
>> Could you perhaps email me the points?
>>
>> Thanks, Robert
>>
>>
>> On Wed, Dec 17, 2014 at 2:27 AM, Michael Sumner <mdsumner at gmail.com>
>> wrote:
>> > Hello, see response inline.
>> >
>> > On Wed Dec 17 2014 at 10:03:23 Michael Treglia <mtreglia at gmail.com>
>> wrote:
>> >
>> >> Hi All,
>> >>
>> >> I'm working with some pretty huge rasters and trying to extract data to
>> >> SpatialPointsDataFrames, and running into some issues. I'm using the
>> raster
>> >> package for this. (sessionInfo at the end of this e-mail)
>> >>
>> >> Here are the specs of my raster:
>> >>
>> >> class       : RasterLayer
>> >> dimensions  : 59901, 49494, 2964740094  (nrow, ncol, ncell)
>> >> resolution  : 9.332575, 9.332575  (x, y)
>> >> extent      : 222855.6, 684762, 3762092, 4321122  (xmin, xmax, ymin,
>> ymax)
>> >> coord. ref. : +proj=utm +zone=15 +datum=WGS84 +units=m +no_defs
>> >> +ellps=WGS84 +towgs84=0,0,0
>> >> data source :
>> >> D:\GIS\Projects\ETynerensis\GISData\n35w092_n39_w096_UTM_cubic.tif
>> >> names       : n35w092_n39_w096_UTM_cubic
>> >> values      : 0, 837.6777  (min, max)
>> >>
>> >> When I run the following line, with a vector points layer in the same
>> CRS
>> >> as the raster, I get the error below.
>> >> >points at data <- data.frame(points at data, extract(elev, points)
>> >>
>> >>
>> > There's a few problems with your code,  you should never use @ for
>> getting
>> > and setting slots, and besides you can assign to the data with $ in the
>> > usual way (the developers do use @ in internal code to provide high level
>> > methods that behave in defined ways). I would do it like this:
>> >
>> > library(raster)
>> >
>> > ## simulate a raster, not large
>> > r <- raster(volcano, crs = "+proj=laea")
>> >
>> > ## more fake data
>> > pts0 <- xyFromCell(r, sample(ncell(r), 10), sp = TRUE)
>> > pts <- SpatialPointsDataFrame(pts, data.frame(id =
>> > 1:nrow(coordinates(pts0))))
>> >
>> > ## rather than points at data <- etc.
>> > pts$r <- extract(r, pts)
>> >
>> > That might help  if the overall points data is large, but you didn't
>> > include that information. You could use print(points) (with raster
>> loaded)
>> > for a succinct summary. (Also points is a commonly used function so best
>> > avoided as a name).
>> >
>> >
>> > Cheers, Mike.
>> >
>> >
>> >
>> >
>> >> Error in .readCellsGDAL(x, uniquecells, layers) :
>> >>   NAs are not allowed in subscripted assignments
>> >> In addition: Warning message:
>> >> In .readCells(x, cells, 1) : NAs introduced by coercion
>> >>
>> >> > traceback()
>> >> 8: .readCellsGDAL(x, uniquecells, layers)
>> >> 7: .readCells(x, cells, 1)
>> >> 6: .cellValues(object, cells, layer = layer, nl = nl)
>> >> 5: .xyValues(x, coordinates(y), ..., df = df)
>> >> 4: .local(x, y, ...)
>> >> 3: extract(elev, sdata)
>> >> 2: extract(elev, sdata)
>> >> 1: data.frame(sdata at data, extract(elev, sdata))
>> >>
>> >> I had a tough time trouble-shooting from the error, but the raster are
>> huge
>> >> (~2x10^9 cells), so I tried to clip a small portion of it and do the
>> >> extract, and it worked.
>> >>
>> >> Here's the code I used to Crop:
>> >> >bbox <- as(extent(22285.6, 3762091.8, 23285.6, 3862091.8),
>> >> 'SpatialPolygons')
>> >> >y <- crop(elev,bbox)
>> >>
>> >> The data are FLT4S, and as a TIF, take up ~11.5GB. Is this just out of
>> the
>> >> bounds for what is feasible? Or is there some trouble-shooting anybody
>> >> recommends I do? (Or is there a good way to do this as tiles in R?) And
>> if
>> >> there's a way to do this with spatial.tools, I'm open to that, but
>> wasn't
>> >> able to figure it out on my own thus far.
>> >>
>> >> Thanks for any suggestions,
>> >> Mike T
>> >>
>> >> > sessionInfo()
>> >> R version 3.1.2 (2014-10-31)
>> >> Platform: x86_64-w64-mingw32/x64 (64-bit)
>> >>
>> >> locale:
>> >> [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United
>> >> States.1252    LC_MONETARY=English_United States.1252
>> >> [4] LC_NUMERIC=C                           LC_TIME=English_United
>> >> States.1252
>> >>
>> >> attached base packages:
>> >> [1] stats     graphics  grDevices utils     datasets  methods   base
>> >>
>> >> other attached packages:
>> >> [1] raster_2.2-31 rgdal_0.8-16  sp_1.0-15
>> >>
>> >> loaded via a namespace (and not attached):
>> >> [1] grid_3.1.2      lattice_0.20-29 tools_3.1.2
>> >>
>> >>         [[alternative HTML version deleted]]
>> >>
>> >> _______________________________________________
>> >> R-sig-Geo mailing list
>> >> R-sig-Geo at r-project.org
>> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >>
>> >
>> >         [[alternative HTML version deleted]]
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at r-project.org
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From ptitle at umich.edu  Wed Jan 14 20:52:48 2015
From: ptitle at umich.edu (Pascal Title)
Date: Wed, 14 Jan 2015 14:52:48 -0500
Subject: [R-sig-Geo] adding mask to spline raster
Message-ID: <CAPSA=ye_7J7B0iY8Jn8FpE4+Zv=EFXh_uee=EQU6ROQii1jJRQ@mail.gmail.com>

Hi,

I am creating interpolations of global marine diversity via thin plate
splines, using the interpolate() function in the raster package. The
problem I am having is that if I plot the spline interpolation and then
overlay the plot with a continents polygon, it becomes clear that certain
areas are interpolated as having high diversity where they shouldn't due to
the configurations of continents, and the interpolation continuing "under"
the continents.

Is there any way to provide a mask either as a raster or as a spatial
polygon to the interpolate function? If not, can someone suggest a
different R package or method that may be better suited to this situation?

Here, I provide a dummy example. Areas with data on the outside of a ring
lead to the inside of the ring having high interpolated values. But if we
imagine that this was marine diversity, and an inland lake in the center
with no data, then we would want the "ring continent" to influence the
interpolation and "mask" the areas within the continent.


require(raster)

require(fields)

require(rgeos)


#making a box

b1 <- readWKT("POLYGON((200 200,300 200, 300 100, 200 100, 200 200))")

b2 <- readWKT("POLYGON((100 300, 400 300, 400 0, 100 0, 100 300))")

box <- gDifference(b2, b1)


#generate samples

b3 <- gDifference(gBuffer(b2, width=50), b2)

pts <- spsample(b3, 50, type='random')


b4 <- gDifference(gBuffer(b3, width=50), gEnvelope(pts))

pts2 <- spsample(b4, 50, type='random')


#create raster and populate

r <-raster(xmn=-100,xmx=600,ymn=-200,ymx=500,res=c(10,10))

r <- rasterize(gUnion(pts,pts2), r)

cells <- cellFromPolygon(r, b3)[[1]]

cells <- cells[which(!is.na(r[cells]))]

r[cells] <- round(rnorm(length(cells), mean=500, sd=20))


cells <- cellFromPolygon(r, b4)[[1]]

cells <- cells[which(!is.na(r[cells]))]

r[cells] <- round(rnorm(length(cells), mean=50, sd=20))


#generate thin plate spline

xy <- data.frame(xyFromCell(r, 1:ncell(r)))

tps <- Tps(xy, values(r))

fine <- disaggregate(r, 2)

p <- raster(fine)

p <- interpolate(p, tps)


#plot

colors <- colorRampPalette(c('blue','yellow','red'))

plot(p, col=colors(100))

plot(box,add=TRUE, col='black')

plot(r, add=TRUE)



Thanks!
-Pascal


-- 
Pascal Title
PhD candidate | Rabosky Lab
<http://www-personal.umich.edu/~drabosky/Home.html>
Dept of Ecology and Evolutionary Biology
University of Michigan
ptitle at umich.edu

pascaltitle.weebly.com

	[[alternative HTML version deleted]]


From pizarro at ebd.csic.es  Thu Jan 15 11:09:36 2015
From: pizarro at ebd.csic.es (Manuel Pizarro =?utf-8?b?R2F2aWzDoW4=?=)
Date: Thu, 15 Jan 2015 11:09:36 +0100
Subject: [R-sig-Geo] Error installing 'rgdal' on Centos 7
Message-ID: <20150115110936.Horde.fdQ4_fy03bfSZq6QlC8oaw6@webmail.csic.es>


Hello:

I can't install the ' rgdal ' package in R and ' GDAL ' on CentOS 7  
(ELGIS repo added).

Is there any solution?

Thanks

-- 
Manuel Pizarro
EBD-CSIC


From Roger.Bivand at nhh.no  Thu Jan 15 12:29:16 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 15 Jan 2015 12:29:16 +0100
Subject: [R-sig-Geo] Error installing 'rgdal' on Centos 7
In-Reply-To: <20150115110936.Horde.fdQ4_fy03bfSZq6QlC8oaw6@webmail.csic.es>
References: <20150115110936.Horde.fdQ4_fy03bfSZq6QlC8oaw6@webmail.csic.es>
Message-ID: <alpine.LRH.2.03.1501151218170.24971@reclus.nhh.no>

Please do not cross-post. Please do provide sufficient information to help 
diagnose your problem (here the output of the ./configure run during 
installation). Almost certainly you are trying to install from source when 
one or more external dependency is not satisfied. Did you read:

http://cran.r-project.org/bin/linux/redhat/README

and note that R-rgdal is *not* provided as a binary?

Did you read:

http://cran.r-project.org/web/packages/rgdal/index.html

Did you download the source package and read the README file, also on 
R-Forge linked from the CRAN page:

https://r-forge.r-project.org/scm/viewvc.php/pkg/inst/README?view=markup&revision=409&root=rgdal

Roger


On Thu, 15 Jan 2015, Manuel Pizarro Gavil?n wrote:

>
> Hello:
>
> I can't install the ' rgdal ' package in R and ' GDAL ' on CentOS 7 (ELGIS 
> repo added).
>
> Is there any solution?
>
> Thanks
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no

From mtreglia at gmail.com  Thu Jan 15 16:03:40 2015
From: mtreglia at gmail.com (Michael Treglia)
Date: Thu, 15 Jan 2015 09:03:40 -0600
Subject: [R-sig-Geo] Extract with Large Rasters
In-Reply-To: <CAG4NReJvAr21P7zMN1f=voVOuxT_M+c6_Z6tjJL4Ky8414oDFw@mail.gmail.com>
References: <CAPKp32vcJ+0WVTZL1mA_NeaqPrSfcFCgsk+=w4i87TPUZ4YHOw@mail.gmail.com>
	<CAAcGz9-XnMdAJG+MrnMX2D2r3jHX2vRjom4+Ub4qUdvX7-z-XQ@mail.gmail.com>
	<CANtt_hypODXRs3zgjdQnkWKKsxAXPBWOdqjD0Mbm76qoMXypeA@mail.gmail.com>
	<CAPKp32sxQBhYRryHStrJahOtbFXa2mem6Ov-LNSgbFPw+yAS7Q@mail.gmail.com>
	<CAG4NReJvAr21P7zMN1f=voVOuxT_M+c6_Z6tjJL4Ky8414oDFw@mail.gmail.com>
Message-ID: <CAPKp32tdCmfpaqzdQDzM_zNCiENcN+VnEdDZ34YFYcv2tMjHBw@mail.gmail.com>

Hi Agustin,

Nope - since the process that I needed worked after clipping the rasters a
bit, I just did that, though didn't come to an actual solution that enabled
me to use my original, larger rasters referenced in my earlier e-mails.

Cheers,
Mike

On Thu, Jan 15, 2015 at 1:43 AM, Agustin Lobo <alobolistas at gmail.com> wrote:

> Michael,
> was this issue ever fully clarifed?
> Thanks
> Agus
>
> On Thu, Dec 18, 2014 at 7:54 PM, Michael Treglia <mtreglia at gmail.com>
> wrote:
> > Thanks Mike and Robert,
> >
> > Avoiding using @ didn't seem to help this problem. Also, I can do the
> > extract using the same exact points with different rasters (e.g., Bioclim
> > variables or a coarser DEM), so it doesn't seem to be a problem with the
> > points [Robert, if you still think they might pose an issue, let me know
> > and I'll send them off-list; I've included the specs of the points below
> > too though].
> >
> > I realized I could clip the raster a bit and did so in with gdalwarp
> > (outside of R), and the extract worked without issue. I'm still curious
> to
> > figure out why it won't work with the original raster file though and I'm
> > all ears for suggestions, in case it can save me or others some trouble
> in
> > the future
> >
> > Also, the reason I was using the @ was because I am ultimately doing this
> > for a stack of rasters, and would like to have all the raster fields
> added
> > to the SpatialPointsDataFrame. Is there a more preferred way to do that?
> I
> > see that if you do a hypothetical
> >>pts$field <- extract(stack, pts)
> > you get the values from the whole stack, but the columns have the prefix
> of
> > 'field'.  (I realize you can just rename columns after doing the extract)
> >
> > Here's are the specs of the clipped Raster (for which the extract()
> works):
> > class       : RasterLayer
> > dimensions  : 35410, 39925, 1413744250  (nrow, ncol, ncell)
> > resolution  : 9.332523, 9.332448  (x, y)
> > extent      : 273952, 646553, 3885751, 4216213  (xmin, xmax, ymin, ymax)
> > coord. ref. : +proj=utm +zone=15 +datum=WGS84 +units=m +no_defs
> > +ellps=WGS84 +towgs84=0,0,0
> > data source : D:\GISData\Clipped_10mDEM.tif
> > names       : Clipped_10mDEM
> >
> > Here are the specs of the original (for which the extract() doesn't
> work):
> > class       : RasterLayer
> > dimensions  : 59901, 49494, 2964740094  (nrow, ncol, ncell)
> > resolution  : 9.332575, 9.332575  (x, y)
> > extent      : 222855.6, 684762, 3762092, 4321122  (xmin, xmax, ymin,
> ymax)
> > coord. ref. : +proj=utm +zone=15 +datum=WGS84 +units=m +no_defs
> > +ellps=WGS84 +towgs84=0,0,0
> > data source : D:\GISData\n35w092_n39_w096_UTM_cubic.tif
> > names       : n35w092_n39_w096_UTM_cubic
> >
> > Here are the Specs of the Points [excluding field names and max/min
> values]:
> > class       : SpatialPointsDataFrame
> > features    : 159
> > extent      : 300852.6, 611979.9, 3910111, 4196814  (xmin, xmax, ymin,
> ymax)
> > coord. ref. : +proj=utm +zone=15 +datum=WGS84 +units=m +no_defs
> > +ellps=WGS84 +towgs84=0,0,0
> > variables   : 16
> >
> > Thanks again!
> > Mike T
> >
> >
> >
> >
> >
> > On Wed, Dec 17, 2014 at 2:06 PM, Robert J. Hijmans <r.hijmans at gmail.com>
> > wrote:
> >>
> >> From the traceback
> >>
> >> 8: .readCellsGDAL(x, uniquecells, layers)
> >>
> >> it seems to me that the error occurs here:
> >>
> >> extract(elev, points)
> >>
> >> and that it has nothing to do with the size of the raster.  I am not
> >> sure what causes it.
> >> Could you perhaps email me the points?
> >>
> >> Thanks, Robert
> >>
> >>
> >> On Wed, Dec 17, 2014 at 2:27 AM, Michael Sumner <mdsumner at gmail.com>
> >> wrote:
> >> > Hello, see response inline.
> >> >
> >> > On Wed Dec 17 2014 at 10:03:23 Michael Treglia <mtreglia at gmail.com>
> >> wrote:
> >> >
> >> >> Hi All,
> >> >>
> >> >> I'm working with some pretty huge rasters and trying to extract data
> to
> >> >> SpatialPointsDataFrames, and running into some issues. I'm using the
> >> raster
> >> >> package for this. (sessionInfo at the end of this e-mail)
> >> >>
> >> >> Here are the specs of my raster:
> >> >>
> >> >> class       : RasterLayer
> >> >> dimensions  : 59901, 49494, 2964740094  (nrow, ncol, ncell)
> >> >> resolution  : 9.332575, 9.332575  (x, y)
> >> >> extent      : 222855.6, 684762, 3762092, 4321122  (xmin, xmax, ymin,
> >> ymax)
> >> >> coord. ref. : +proj=utm +zone=15 +datum=WGS84 +units=m +no_defs
> >> >> +ellps=WGS84 +towgs84=0,0,0
> >> >> data source :
> >> >> D:\GIS\Projects\ETynerensis\GISData\n35w092_n39_w096_UTM_cubic.tif
> >> >> names       : n35w092_n39_w096_UTM_cubic
> >> >> values      : 0, 837.6777  (min, max)
> >> >>
> >> >> When I run the following line, with a vector points layer in the same
> >> CRS
> >> >> as the raster, I get the error below.
> >> >> >points at data <- data.frame(points at data, extract(elev, points)
> >> >>
> >> >>
> >> > There's a few problems with your code,  you should never use @ for
> >> getting
> >> > and setting slots, and besides you can assign to the data with $ in
> the
> >> > usual way (the developers do use @ in internal code to provide high
> level
> >> > methods that behave in defined ways). I would do it like this:
> >> >
> >> > library(raster)
> >> >
> >> > ## simulate a raster, not large
> >> > r <- raster(volcano, crs = "+proj=laea")
> >> >
> >> > ## more fake data
> >> > pts0 <- xyFromCell(r, sample(ncell(r), 10), sp = TRUE)
> >> > pts <- SpatialPointsDataFrame(pts, data.frame(id =
> >> > 1:nrow(coordinates(pts0))))
> >> >
> >> > ## rather than points at data <- etc.
> >> > pts$r <- extract(r, pts)
> >> >
> >> > That might help  if the overall points data is large, but you didn't
> >> > include that information. You could use print(points) (with raster
> >> loaded)
> >> > for a succinct summary. (Also points is a commonly used function so
> best
> >> > avoided as a name).
> >> >
> >> >
> >> > Cheers, Mike.
> >> >
> >> >
> >> >
> >> >
> >> >> Error in .readCellsGDAL(x, uniquecells, layers) :
> >> >>   NAs are not allowed in subscripted assignments
> >> >> In addition: Warning message:
> >> >> In .readCells(x, cells, 1) : NAs introduced by coercion
> >> >>
> >> >> > traceback()
> >> >> 8: .readCellsGDAL(x, uniquecells, layers)
> >> >> 7: .readCells(x, cells, 1)
> >> >> 6: .cellValues(object, cells, layer = layer, nl = nl)
> >> >> 5: .xyValues(x, coordinates(y), ..., df = df)
> >> >> 4: .local(x, y, ...)
> >> >> 3: extract(elev, sdata)
> >> >> 2: extract(elev, sdata)
> >> >> 1: data.frame(sdata at data, extract(elev, sdata))
> >> >>
> >> >> I had a tough time trouble-shooting from the error, but the raster
> are
> >> huge
> >> >> (~2x10^9 cells), so I tried to clip a small portion of it and do the
> >> >> extract, and it worked.
> >> >>
> >> >> Here's the code I used to Crop:
> >> >> >bbox <- as(extent(22285.6, 3762091.8, 23285.6, 3862091.8),
> >> >> 'SpatialPolygons')
> >> >> >y <- crop(elev,bbox)
> >> >>
> >> >> The data are FLT4S, and as a TIF, take up ~11.5GB. Is this just out
> of
> >> the
> >> >> bounds for what is feasible? Or is there some trouble-shooting
> anybody
> >> >> recommends I do? (Or is there a good way to do this as tiles in R?)
> And
> >> if
> >> >> there's a way to do this with spatial.tools, I'm open to that, but
> >> wasn't
> >> >> able to figure it out on my own thus far.
> >> >>
> >> >> Thanks for any suggestions,
> >> >> Mike T
> >> >>
> >> >> > sessionInfo()
> >> >> R version 3.1.2 (2014-10-31)
> >> >> Platform: x86_64-w64-mingw32/x64 (64-bit)
> >> >>
> >> >> locale:
> >> >> [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United
> >> >> States.1252    LC_MONETARY=English_United States.1252
> >> >> [4] LC_NUMERIC=C                           LC_TIME=English_United
> >> >> States.1252
> >> >>
> >> >> attached base packages:
> >> >> [1] stats     graphics  grDevices utils     datasets  methods   base
> >> >>
> >> >> other attached packages:
> >> >> [1] raster_2.2-31 rgdal_0.8-16  sp_1.0-15
> >> >>
> >> >> loaded via a namespace (and not attached):
> >> >> [1] grid_3.1.2      lattice_0.20-29 tools_3.1.2
> >> >>
> >> >>         [[alternative HTML version deleted]]
> >> >>
> >> >> _______________________________________________
> >> >> R-sig-Geo mailing list
> >> >> R-sig-Geo at r-project.org
> >> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >> >>
> >> >
> >> >         [[alternative HTML version deleted]]
> >> >
> >> > _______________________________________________
> >> > R-sig-Geo mailing list
> >> > R-sig-Geo at r-project.org
> >> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>
> >
> >         [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From r.hijmans at gmail.com  Thu Jan 15 19:21:47 2015
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 15 Jan 2015 10:21:47 -0800
Subject: [R-sig-Geo] adding mask to spline raster
In-Reply-To: <CAPSA=ye_7J7B0iY8Jn8FpE4+Zv=EFXh_uee=EQU6ROQii1jJRQ@mail.gmail.com>
References: <CAPSA=ye_7J7B0iY8Jn8FpE4+Zv=EFXh_uee=EQU6ROQii1jJRQ@mail.gmail.com>
Message-ID: <CANtt_hzmV0OSQqD_7vH0CE30wAsxK=rQ1extPMWB8j0bX59uug@mail.gmail.com>

Hi Pascal,

On Wed, Jan 14, 2015 at 11:52 AM, Pascal Title <ptitle at umich.edu> wrote:
> Hi,
>
> I am creating interpolations of global marine diversity via thin plate
> splines, using the interpolate() function in the raster package. The
> problem I am having is that if I plot the spline interpolation and then
> overlay the plot with a continents polygon, it becomes clear that certain
> areas are interpolated as having high diversity where they shouldn't due to
> the configurations of continents, and the interpolation continuing "under"
> the continents.
>
> Is there any way to provide a mask either as a raster or as a spatial
> polygon to the interpolate function?

No, because you would need to change how you fit your model (Tps), not
how you make predictions with the model (interpolate).

I assume the seeping happens in Central America; you could make two
overlapping separate models: one for the east (Atlantic), and one for
the west (Pacific).

I think there is also some work on using 'soapy' GAMs to interpolate
values "around" islands that might be helpful here.

Robert

>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From pizarro at ebd.csic.es  Fri Jan 16 11:18:28 2015
From: pizarro at ebd.csic.es (Manuel Pizarro =?utf-8?b?R2F2aWzDoW4=?=)
Date: Fri, 16 Jan 2015 11:18:28 +0100
Subject: [R-sig-Geo] [R-sig-Fedora] Error installing 'rgdal' on Centos 7
In-Reply-To: <1421321393.3943.66.camel@iarc.fr>
References: <20150115110936.Horde.fdQ4_fy03bfSZq6QlC8oaw6@webmail.csic.es>
	<1421321393.3943.66.camel@iarc.fr>
Message-ID: <20150116111828.Horde.7sM5uwwtfTDlTcJH3_UJ4A4@webmail.csic.es>

Good morning Martyn.

Thank you for your email.

Some details for the problem.

This is the message of the console in R:


------------------

> install.packages("rgdal")
Installing package into  
?/home/aliendist/R/x86_64-redhat-linux-gnu-library/3.1?
(as ?lib? is unspecified)
probando la URL 'http://cran.rstudio.com/src/contrib/rgdal_0.9-1.tar.gz'
Content type 'application/x-gzip' length 1624496 bytes (1.5 Mb)
URL abierta
==================================================
downloaded 1.5 Mb

* installing *source* package ?rgdal? ...
** package ?rgdal? successfully unpacked and MD5 sums checked
configure: CC: gcc -m64 -std=gnu99
configure: CXX: g++ -m64
configure: rgdal: 0.9-1
checking for /usr/bin/svnversion... yes
configure: svn revision: 518
configure: gdal-config: gdal-config
checking gdal-config usability...
./configure: line 2119: gdal-config: command not found
no
Error: gdal-config not found
The gdal-config script distributed with GDAL could not be found.
If you have not installed the GDAL libraries, you can
download the source from  http://www.gdal.org/
If you have installed the GDAL libraries, then make sure that
gdal-config is in your path. Try typing gdal-config at a
shell prompt and see if it runs. If not, use:
  --configure-args='--with-gdal-config=/usr/local/bin/gdal-config'
with appropriate values for your installation.

ERROR: configuration failed for package ?rgdal?
* removing ?/home/aliendist/R/x86_64-redhat-linux-gnu-library/3.1/rgdal?
Warning in install.packages :
   installation of package ?rgdal? had non-zero exit status

The downloaded source packages are in
	?/tmp/Rtmpeaf9P4/downloaded_packages?
>

-------------------

I tried to install gdal -dev and gdal but it is impossible.

Regards,
Manuel




Martyn Plummer <plummerm at iarc.fr> escribi?:

> You don't say exactly what the problem is, but I can give you some
> general advice.
>
> The first thing to check on any RPM-based system is that you have the
> appropriate development package installed, in this case gdal-devel.
>
> I see that ELGIS does not support CentOS 7, so that might be your
> problem. EPEL 7 does include gdal so you might rely on their package.
>
> If neither of these are helpful then you need to be more specific.
>
> Martyn
>
> On Thu, 2015-01-15 at 11:09 +0100, Manuel Pizarro Gavil?n wrote:
>> Hello:
>>
>> I can't install the ' rgdal ' package in R and ' GDAL ' on CentOS 7
>> (ELGIS repo added).
>>
>> Is there any solution?
>>
>> Thanks
>>
>
> -----------------------------------------------------------------------
> This message and its attachments are strictly confiden...{{dropped:13}}


From pizarro at ebd.csic.es  Fri Jan 16 11:19:41 2015
From: pizarro at ebd.csic.es (Manuel Pizarro =?utf-8?b?R2F2aWzDoW4=?=)
Date: Fri, 16 Jan 2015 11:19:41 +0100
Subject: [R-sig-Geo] Error installing 'rgdal' on Centos 7
In-Reply-To: <alpine.LRH.2.03.1501151218170.24971@reclus.nhh.no>
References: <20150115110936.Horde.fdQ4_fy03bfSZq6QlC8oaw6@webmail.csic.es>
	<alpine.LRH.2.03.1501151218170.24971@reclus.nhh.no>
Message-ID: <20150116111941.Horde.3EihRh5Lku2eIOX65WKU9A8@webmail.csic.es>

Hello Roger:

Thank you for your email.

Some details for the problem.

This is the message of the console in R:


------------------
install.packages("rgdal")
Installing package into  
?/home/aliendist/R/x86_64-redhat-linux-gnu-library/3.1?
(as ?lib? is unspecified)
probando la URL 'http://cran.rstudio.com/src/contrib/rgdal_0.9-1.tar.gz'
Content type 'application/x-gzip' length 1624496 bytes (1.5 Mb)
URL abierta
==================================================
downloaded 1.5 Mb

* installing *source* package ?rgdal? ...
** package ?rgdal? successfully unpacked and MD5 sums checked
configure: CC: gcc -m64 -std=gnu99
configure: CXX: g++ -m64
configure: rgdal: 0.9-1
checking for /usr/bin/svnversion... yes
configure: svn revision: 518
configure: gdal-config: gdal-config
checking gdal-config usability...
./configure: line 2119: gdal-config: command not found
no
Error: gdal-config not found
The gdal-config script distributed with GDAL could not be found.
If you have not installed the GDAL libraries, you can
download the source from  http://www.gdal.org/
If you have installed the GDAL libraries, then make sure that
gdal-config is in your path. Try typing gdal-config at a
shell prompt and see if it runs. If not, use:
  --configure-args='--with-gdal-config=/usr/local/bin/gdal-config'
with appropriate values for your installation.

ERROR: configuration failed for package ?rgdal?
* removing ?/home/aliendist/R/x86_64-redhat-linux-gnu-library/3.1/rgdal?
Warning in install.packages :
   installation of package ?rgdal? had non-zero exit status

The downloaded source packages are in
         ?/tmp/Rtmpeaf9P4/downloaded_packages?
-------------------

I tried to install gdal -dev and gdal but it is impossible.

Regards,
Manuel






Roger Bivand <Roger.Bivand at nhh.no> escribi?:

> Please do not cross-post. Please do provide sufficient information  
> to help diagnose your problem (here the output of the ./configure  
> run during installation). Almost certainly you are trying to install  
> from source when one or more external dependency is not satisfied.  
> Did you read:
>
> http://cran.r-project.org/bin/linux/redhat/README
>
> and note that R-rgdal is *not* provided as a binary?
>
> Did you read:
>
> http://cran.r-project.org/web/packages/rgdal/index.html
>
> Did you download the source package and read the README file, also  
> on R-Forge linked from the CRAN page:
>
> https://r-forge.r-project.org/scm/viewvc.php/pkg/inst/README?view=markup&revision=409&root=rgdal
>
> Roger
>
>
> On Thu, 15 Jan 2015, Manuel Pizarro Gavil?n wrote:
>
>>
>> Hello:
>>
>> I can't install the ' rgdal ' package in R and ' GDAL ' on CentOS 7  
>> (ELGIS repo added).
>>
>> Is there any solution?
>>
>> Thanks
>>
>>
>
> -- 
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 91 00
> e-mail: Roger.Bivand at nhh.no


-- 
Manuel Pizarro
EBD-CSIC


From Thierry.ONKELINX at inbo.be  Fri Jan 16 11:40:08 2015
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Fri, 16 Jan 2015 10:40:08 +0000
Subject: [R-sig-Geo] Error installing 'rgdal' on Centos 7
In-Reply-To: <20150116111941.Horde.3EihRh5Lku2eIOX65WKU9A8@webmail.csic.es>
References: <20150115110936.Horde.fdQ4_fy03bfSZq6QlC8oaw6@webmail.csic.es>
	<alpine.LRH.2.03.1501151218170.24971@reclus.nhh.no>,
	<20150116111941.Horde.3EihRh5Lku2eIOX65WKU9A8@webmail.csic.es>
Message-ID: <AA818EAD2576BC488B4F623941DA742701096F94C3@inbomail.inbo.be>

Dear Manuel,

The underlying problem is that you have problems installing the GDAL library on your system. Without GDAL you cannot install rgdal on Linux OS. You need to provide more information on why it is impossible to install GDAL on your system.

Best regards,

Thierry

ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Research Institute for Nature and Forest
team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
Kliniekstraat 25
1070 Anderlecht
Belgium
+ 32 2 525 02 51
+ 32 54 43 61 85
Thierry.Onkelinx at inbo.be
www.inbo.be
To call in the statistician after the experiment is done may be no more than asking him to perform a post-mortem examination: he may be able to say what the experiment died of. ~ Sir Ronald Aylmer Fisher
The plural of anecdote is not data. ~ Roger Brinner
The combination of some data and an aching desire for an answer does not ensure that a reasonable answer can be extracted from a given body of data. ~ John Tukey

________________________________________
Van: R-sig-Geo [r-sig-geo-bounces at r-project.org] namens Manuel Pizarro Gavil?n [pizarro at ebd.csic.es]
Verzonden: vrijdag 16 januari 2015 11:19
Aan: Roger Bivand
CC: r-sig-geo at r-project.org; r-sig-fedora at r-project.org
Onderwerp: Re: [R-sig-Geo] Error installing 'rgdal' on Centos 7

Hello Roger:

Thank you for your email.

Some details for the problem.

This is the message of the console in R:


------------------
install.packages("rgdal")
Installing package into
?/home/aliendist/R/x86_64-redhat-linux-gnu-library/3.1?
(as ?lib? is unspecified)
probando la URL 'http://cran.rstudio.com/src/contrib/rgdal_0.9-1.tar.gz'
Content type 'application/x-gzip' length 1624496 bytes (1.5 Mb)
URL abierta
==================================================
downloaded 1.5 Mb

* installing *source* package ?rgdal? ...
** package ?rgdal? successfully unpacked and MD5 sums checked
configure: CC: gcc -m64 -std=gnu99
configure: CXX: g++ -m64
configure: rgdal: 0.9-1
checking for /usr/bin/svnversion... yes
configure: svn revision: 518
configure: gdal-config: gdal-config
checking gdal-config usability...
./configure: line 2119: gdal-config: command not found
no
Error: gdal-config not found
The gdal-config script distributed with GDAL could not be found.
If you have not installed the GDAL libraries, you can
download the source from  http://www.gdal.org/
If you have installed the GDAL libraries, then make sure that
gdal-config is in your path. Try typing gdal-config at a
shell prompt and see if it runs. If not, use:
  --configure-args='--with-gdal-config=/usr/local/bin/gdal-config'
with appropriate values for your installation.

ERROR: configuration failed for package ?rgdal?
* removing ?/home/aliendist/R/x86_64-redhat-linux-gnu-library/3.1/rgdal?
Warning in install.packages :
   installation of package ?rgdal? had non-zero exit status

The downloaded source packages are in
         ?/tmp/Rtmpeaf9P4/downloaded_packages?
-------------------

I tried to install gdal -dev and gdal but it is impossible.

Regards,
Manuel






Roger Bivand <Roger.Bivand at nhh.no> escribi?:

> Please do not cross-post. Please do provide sufficient information
> to help diagnose your problem (here the output of the ./configure
> run during installation). Almost certainly you are trying to install
> from source when one or more external dependency is not satisfied.
> Did you read:
>
> http://cran.r-project.org/bin/linux/redhat/README
>
> and note that R-rgdal is *not* provided as a binary?
>
> Did you read:
>
> http://cran.r-project.org/web/packages/rgdal/index.html
>
> Did you download the source package and read the README file, also
> on R-Forge linked from the CRAN page:
>
> https://r-forge.r-project.org/scm/viewvc.php/pkg/inst/README?view=markup&revision=409&root=rgdal
>
> Roger
>
>
> On Thu, 15 Jan 2015, Manuel Pizarro Gavil?n wrote:
>
>>
>> Hello:
>>
>> I can't install the ' rgdal ' package in R and ' GDAL ' on CentOS 7
>> (ELGIS repo added).
>>
>> Is there any solution?
>>
>> Thanks
>>
>>
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 91 00
> e-mail: Roger.Bivand at nhh.no


--
Manuel Pizarro
EBD-CSIC

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo
Disclaimer<https://www.inbo.be/nl/disclaimer-mailberichten-van-het-inbo>


From Roger.Bivand at nhh.no  Fri Jan 16 11:38:57 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 16 Jan 2015 11:38:57 +0100
Subject: [R-sig-Geo] Error installing 'rgdal' on Centos 7
In-Reply-To: <20150116111941.Horde.3EihRh5Lku2eIOX65WKU9A8@webmail.csic.es>
References: <20150115110936.Horde.fdQ4_fy03bfSZq6QlC8oaw6@webmail.csic.es>
	<alpine.LRH.2.03.1501151218170.24971@reclus.nhh.no>
	<20150116111941.Horde.3EihRh5Lku2eIOX65WKU9A8@webmail.csic.es>
Message-ID: <alpine.LRH.2.03.1501161131120.10479@reclus.nhh.no>

On Fri, 16 Jan 2015, Manuel Pizarro Gavil?n wrote:

> Hello Roger:
>
> Thank you for your email.
>
> Some details for the problem.
>
> This is the message of the console in R:
>
>
> ------------------
> install.packages("rgdal")
> Installing package into 
> ?/home/aliendist/R/x86_64-redhat-linux-gnu-library/3.1?
> (as ?lib? is unspecified)
> probando la URL 'http://cran.rstudio.com/src/contrib/rgdal_0.9-1.tar.gz'
> Content type 'application/x-gzip' length 1624496 bytes (1.5 Mb)
> URL abierta
> ==================================================
> downloaded 1.5 Mb
>
> * installing *source* package ?rgdal? ...
> ** package ?rgdal? successfully unpacked and MD5 sums checked
> configure: CC: gcc -m64 -std=gnu99
> configure: CXX: g++ -m64
> configure: rgdal: 0.9-1
> checking for /usr/bin/svnversion... yes
> configure: svn revision: 518
> configure: gdal-config: gdal-config
> checking gdal-config usability...
> ./configure: line 2119: gdal-config: command not found
> no
> Error: gdal-config not found
> The gdal-config script distributed with GDAL could not be found.
> If you have not installed the GDAL libraries, you can
> download the source from  http://www.gdal.org/
> If you have installed the GDAL libraries, then make sure that
> gdal-config is in your path. Try typing gdal-config at a
> shell prompt and see if it runs. If not, use:
> --configure-args='--with-gdal-config=/usr/local/bin/gdal-config'
> with appropriate values for your installation.
>
> ERROR: configuration failed for package ?rgdal?
> * removing ?/home/aliendist/R/x86_64-redhat-linux-gnu-library/3.1/rgdal?
> Warning in install.packages :
> installation of package ?rgdal? had non-zero exit status
>
> The downloaded source packages are in
>       ?/tmp/Rtmpeaf9P4/downloaded_packages?
> -------------------
>
> I tried to install gdal -dev and gdal but it is impossible.

No, it isn't. Install PROJ.4 first then GDAL from source, and everything 
is under your control.

The README file I referred to does list the RPMs needed, but you will do 
better choosing the drivers for GDAL you need yourself, installing their 
dependencies, and building at least PROJ.4 and GDAL from source. Centos 7 
does not yet seem to be well supported anywhere for these, and for 6 the 
versions are typically old or very old.

http://download.osgeo.org/proj/proj-4.8.0.tar.gz
http://download.osgeo.org/proj/proj-datumgrid-1.5.zip

then

http://download.osgeo.org/gdal/1.11.1/gdal-1.11.1.tar.gz

Remember to run ldconfig after installing to make the shared objects 
visible.

Roger

>
> Regards,
> Manuel
>
>
>
>
>
>
> Roger Bivand <Roger.Bivand at nhh.no> escribi?:
>
>> Please do not cross-post. Please do provide sufficient information to help 
>> diagnose your problem (here the output of the ./configure run during 
>> installation). Almost certainly you are trying to install from source when 
>> one or more external dependency is not satisfied. Did you read:
>> 
>> http://cran.r-project.org/bin/linux/redhat/README
>> 
>> and note that R-rgdal is *not* provided as a binary?
>> 
>> Did you read:
>> 
>> http://cran.r-project.org/web/packages/rgdal/index.html
>> 
>> Did you download the source package and read the README file, also on 
>> R-Forge linked from the CRAN page:
>> 
>> https://r-forge.r-project.org/scm/viewvc.php/pkg/inst/README?view=markup&revision=409&root=rgdal
>> 
>> Roger
>> 
>> 
>> On Thu, 15 Jan 2015, Manuel Pizarro Gavil?n wrote:
>> 
>>> 
>>> Hello:
>>> 
>>> I can't install the ' rgdal ' package in R and ' GDAL ' on CentOS 7 (ELGIS 
>>> repo added).
>>> 
>>> Is there any solution?
>>> 
>>> Thanks
>>> 
>>> 
>> 
>> -- 
>> Roger Bivand
>> Department of Economics, Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 91 00
>> e-mail: Roger.Bivand at nhh.no
>
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no

From jonathan at mazamascience.com  Sun Jan 18 03:22:12 2015
From: jonathan at mazamascience.com (Jonathan Callahan)
Date: Sat, 17 Jan 2015 18:22:12 -0800
Subject: [R-sig-Geo] where to store locally generated package data
Message-ID: <CAPjNR=TCYH+vN0=4DYBxtCxojO99dWSfLO2bvo9Wy6FPxw4ZPg@mail.gmail.com>

Our question is at the end after an explanation of what we are doing.

BACKGROUND:

We work a lot with spatial data, often extracting information from a
SpatialPolygonsDataFrame based on a set of site locations. A typical use
might be to find the country, state, timezone or HUC watershed ID
associated with a set of site locations.

We often need to convert shapefiles we find on the web into standardized
local .RData files. The procedure is fairly straightforward, though
different for each shapefile we need to download and convert.

We are just starting to create a package that encapsulates the download and
convert process along with other spatial functionality that we wish to
reuse.

Our plan is to release a package that contains both generic functionality
and single-purpose code for the creation of each individual
SpatialPolygonsDataFrame so that they can have standardized attributes.

The idea is that users would need to create the sometimes quite large
.RData files on their own system with commands like:

install.packages("MazamaSpatialUtils")

installSpatialData('WorldTimezones')
installSpatialData('PoliticalBoundaries',level=1)
installSpatialData('PoliticalBoundaries',country='US',level=2)
installSpatialData('Watersheds',country='US',level=12)

QUESTION:

Where should we store the locally generated .RData files so that they can
be found by the package functions?

Do we use an environment variable?

Is there any standard for this sort of approach to locally generated
package data?


Thanks for any suggestions.

Jonathan Callahan

-- 
Jonathan Callahan, PhD
Mazama Science
206-708-5028
mazamascience.com

	[[alternative HTML version deleted]]


From bluenessop at gmail.com  Wed Jan 21 07:56:17 2015
From: bluenessop at gmail.com (dino)
Date: Tue, 20 Jan 2015 23:56:17 -0700 (MST)
Subject: [R-sig-Geo] modeling variogram
Message-ID: <1421823377888-7587663.post@n2.nabble.com>

Hello, 

I am working on a problem dealing with fitting variogram automatically.I had
used GSlib to generate variogram with my data ,but there is no way in GSlib
to autofit it.I wonder is  it   possible to import  GSlib variogram ouput
file(.out) or other information  to R to fit it 

Best regards, 

Dino



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/modeling-variogram-tp7587663.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From elgabass at gmail.com  Wed Jan 21 17:17:20 2015
From: elgabass at gmail.com (Ahmed El-Gabbas)
Date: Wed, 21 Jan 2015 17:17:20 +0100
Subject: [R-sig-Geo] Equal-area projection
Message-ID: <CAJEGaydNQXjso0nuOwkT7pBHG-dYjO9jH0CWmP=uWoKBg7-Q4Q@mail.gmail.com>

Hello all,

I am quiet confused about what is the best projection type and CRS
parameters I should use that is suitable for my study area. In my work, I
am working at two scales, one at Egypt scale (roughly: Latitude +22?:+32?
and longitude +24?:+37?) and the other is somehow regional (including the
whole Africa, Europe and Western Asia - Latitude -35?:+90? and longitude
-20?:+89?).

At Egypt scale, I used to work with WGS84 projection type (latitude and
longitude are in the form of decimal degrees), as Egypt does not represent
that huge latitudinal gradient; and so the differences in cell areas does
not have much distorsion across latitudinal gradient. Now I am interesting
to work at both scales in a comparable way, using a projection that
maintain an equal representation of cell areas across high latitude
gradient [coordinates stated above].

I've read about some types of equal-area projections and not sure which one
is best one describing my study area. Possible projections I found include:
Lambert azimuthal equal-area projection -- Lambert cylindrical equal-area
projection -- Albers projection -- Mollweide projection -- and others.

I need help in answering:
- which one of these projection types is the most representative of my
study area (at both scales)?
- Also, it is not clear for me how to best determine the right parameters
passed to the CRS line in R; including values of +lat_0, +lon_0, +x_0,
+y_0, etc.
- Is there any function in R that enables me to change the projection type
to an equal-area projection and, at the same step, determine the dimensions
of the new pixels? I need, for example to project the resulted raster into
an equal-area projection with a pixel size of 5Km*5Km. I've tried the
"projectRaster" function of raster package and it seems, as far as I
noticed, there is no argument to determine what is the dimensions of
projected map.

Here is some code for pointing out the study area and for possible
reproducibility in further replies:
    require(raster)
    # Extent for both study scales
    EgyptExtent <- extent(24,37,22,32)
    RegionalExtent <- extent(-20,89,-35,90)

    # Download a world raster map for mean temperature for January
    TMean_Jan = getData('worldclim', var='tmean', res=2.5)[[1]]
    projection(TMean_Jan) <- "+proj=longlat +datum=WGS84 +ellps=WGS84
+towgs84=0,0,0" # WGS84 projection

    #Plotting the global map and showing the study area
    plot(TMean_Jan, axes=F, legend=F, box=F)
    plot(RegionalExtent, add=T, col="blue")
    plot(EgyptExtent, add=T, col="red")

    TMean_Jan_Egy <- crop(TMean_Jan, EgyptExtent)
    TMean_Jan_Regional <- crop(TMean_Jan, RegionalExtent)
    plot(TMean_Jan_Regional, axes=F, legend=F, box=F); plot(TMean_Jan_Egy,
add=T) # All are find on WGS84 projection


Thanks in advance,
Ahmed

	[[alternative HTML version deleted]]


From dupouey at nancy.inra.fr  Wed Jan 21 22:45:53 2015
From: dupouey at nancy.inra.fr (Jean-Luc Dupouey)
Date: Wed, 21 Jan 2015 22:45:53 +0100
Subject: [R-sig-Geo] matching does not work in SpatialPointsDataFrame
Message-ID: <54C01E11.2040306@nancy.inra.fr>

I get an incorrect match between row names of coordinates and data in 
SpatialPointsDataFrame:

 > Mycoord <- data.frame(row.names=letters[1:5], x=rnorm(5), y=rnorm(5))
 >
 > Mycoord
             x          y
a -0.80138451  1.9291882
b -1.58229979 -0.7713053
c -1.28416923  1.3324122
d -0.22558639  0.7320874
e -0.08702876  1.7635046
 >
 > Myattr <- data.frame(row.names=sample(letters[1:5]),var1=rnorm(5))
 >
 > Myattr
         var1
d  1.2935138
c  0.1143173
a -0.2157230
b -1.9424786
e -0.7234636
 >
 > MyptsdataT <- SpatialPointsDataFrame(Mycoord, Myattr, match.ID=TRUE)
 >
 > MyptsdataT
               coordinates       var1
d  (-0.8013845, 1.929188)  1.2935138
c   (-1.5823, -0.7713053)  0.1143173
a   (-1.284169, 1.332412) -0.2157230
b (-0.2255864, 0.7320874) -1.9424786
e (-0.08702876, 1.763505) -0.7234636

Either I made a mistake somewhere (99.99%), either there is a bug (0.01%).

I read carefully and several times the help page for this function, and 
did not find any clue to my problem. It is written: "if (match.ID=)TRUE 
AND coords has rownames (i.e., coerced to a matrix, 
dimnames(coords)[[2]] is not NULL), AND data has row.names (i.e. is a 
data.frame), then the SpatialPointsDataFrame object is formed by 
matching the row names of both components".

It seems to me that my coordinates, data and parameters fulfill these 
requirements (even if these requirements look a bit strange: shouldn't 
it be dimnames(coords)[[1]] which must not be NULL?).

A quick look at the function SpatialPointsDataFrame suggests me that the 
problem is perhaps coming from the line:

if (!is(coords, "SpatialPoints"))  coords = coordinates(coords)

When coords is a dataframe, it returns a matrix with the rownames lost. 
Subsequent matching with data is not longer possible. Should'nt the test 
be reversed: if (is(coords, "SpatialPoints")) coords = coordinates(coords) ?

I am working with recent versions of R (3.1.2 (2014-10-31)) and sp (1.0-17).

Thanks for any help towards the resolution of this problem.

Jean-Luc Dupouey

-- 
INRA
Forest Ecology and Ecophysiology Unit
F-54280 Champenoux
France

mail: dupouey at nancy.inra.fr


From Gema.FAviles at uclm.es  Thu Jan 22 12:00:50 2015
From: Gema.FAviles at uclm.es (GEMA FERNANDEZ-AVILES CALDERON)
Date: Thu, 22 Jan 2015 11:00:50 +0000
Subject: [R-sig-Geo] error in splm()
Message-ID: <1421924453710.44872@uclm.es>

Dear list:


I'm new in spatial panel data. I try to do a simple model but I have the following error in splm library. Please, could you help me?


Best,

Gema



*****************************************************************************
## Read the data
library(splm)
library("spdep")
madrid     #my data: 10 years, 179 municipalities, 38 variables

> str(madrid)
'data.frame':   1790 obs. of  38 variables:
 $ id                      : Factor w/ 179 levels "Acebeda (La)",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ year                    : num  2000 2001 2002 2003 2004 ...
 $ pop                     : num  57 56 53 55 55 60 59 58 57 61 ...
 $ Extensi?n..km2.         : num  22.1 22.1 22.1 22.1 22.1 22.1 22.1 22.1 22.1 22.1 ...
 $ Altit                   : num  1269 1269 1269 1269 1269 ...
 $ DistaMadrid             : num  88 88 88 88 88 88 88 88 88 88 ...
 $ longit                  : num  446704 446704 446704 446704 446704 ...
 $ latit                   : num  4549417 4549417 4549417 4549417 4549417 ...
...
...

?fm <- log(nox) ~  log(EEC_pc) +  log(car_1000_ab)

### W-Matrix
library(maptools)
mmapa= readShapePoly("MadriMunAgrup.shp")
plot(mmapa)
wq.mad <- poly2nb(mmapa, queen=T)  # Queen matrix (binaria)
madww <- nb2listw(wq.mad, style="W", zero.policy=TRUE) # Matriz std

### The model
sararremod <- spml(formula = fm, data = madrid, index = NULL,
  listw = madww, model = "random", lag = TRUE, spatial.error = "b")

?Error en if (e1 == 0) return(spam(0, nrow(e2), ncol(e2))) else { :
  valor ausente donde TRUE/FALSE es necesario




Gema Fern?ndez-Avil?s

Statistics Department
University of Castile-La Mancha at Toledo
http://www.uclm.es/profesorado/gemafaviles/

	[[alternative HTML version deleted]]


From edzer.pebesma at uni-muenster.de  Thu Jan 22 13:29:36 2015
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 22 Jan 2015 13:29:36 +0100
Subject: [R-sig-Geo] matching does not work in SpatialPointsDataFrame
In-Reply-To: <54C01E11.2040306@nancy.inra.fr>
References: <54C01E11.2040306@nancy.inra.fr>
Message-ID: <54C0ED30.1070200@uni-muenster.de>

Well spotted, thanks! I reorganized the logic behind the coordinates()
method for data.frame objects, and this should now be fixed; committed
to r-forge.

On 01/21/2015 10:45 PM, Jean-Luc Dupouey wrote:
> I get an incorrect match between row names of coordinates and data in
> SpatialPointsDataFrame:
> 
>> Mycoord <- data.frame(row.names=letters[1:5], x=rnorm(5), y=rnorm(5))
>>
>> Mycoord
>             x          y
> a -0.80138451  1.9291882
> b -1.58229979 -0.7713053
> c -1.28416923  1.3324122
> d -0.22558639  0.7320874
> e -0.08702876  1.7635046
>>
>> Myattr <- data.frame(row.names=sample(letters[1:5]),var1=rnorm(5))
>>
>> Myattr
>         var1
> d  1.2935138
> c  0.1143173
> a -0.2157230
> b -1.9424786
> e -0.7234636
>>
>> MyptsdataT <- SpatialPointsDataFrame(Mycoord, Myattr, match.ID=TRUE)
>>
>> MyptsdataT
>               coordinates       var1
> d  (-0.8013845, 1.929188)  1.2935138
> c   (-1.5823, -0.7713053)  0.1143173
> a   (-1.284169, 1.332412) -0.2157230
> b (-0.2255864, 0.7320874) -1.9424786
> e (-0.08702876, 1.763505) -0.7234636
> 
> Either I made a mistake somewhere (99.99%), either there is a bug (0.01%).
> 
> I read carefully and several times the help page for this function, and
> did not find any clue to my problem. It is written: "if (match.ID=)TRUE
> AND coords has rownames (i.e., coerced to a matrix,
> dimnames(coords)[[2]] is not NULL), AND data has row.names (i.e. is a
> data.frame), then the SpatialPointsDataFrame object is formed by
> matching the row names of both components".
> 
> It seems to me that my coordinates, data and parameters fulfill these
> requirements (even if these requirements look a bit strange: shouldn't
> it be dimnames(coords)[[1]] which must not be NULL?).
> 
> A quick look at the function SpatialPointsDataFrame suggests me that the
> problem is perhaps coming from the line:
> 
> if (!is(coords, "SpatialPoints"))  coords = coordinates(coords)
> 
> When coords is a dataframe, it returns a matrix with the rownames lost.
> Subsequent matching with data is not longer possible. Should'nt the test
> be reversed: if (is(coords, "SpatialPoints")) coords =
> coordinates(coords) ?
> 
> I am working with recent versions of R (3.1.2 (2014-10-31)) and sp
> (1.0-17).
> 
> Thanks for any help towards the resolution of this problem.
> 
> Jean-Luc Dupouey
> 

-- 
Edzer Pebesma,  Co-Editor-in-Chief Computers & Geosciences
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150122/1c3bec0e/attachment.bin>

From mauriziomarchi85 at gmail.com  Thu Jan 22 14:40:49 2015
From: mauriziomarchi85 at gmail.com (Maurizio Marchi)
Date: Thu, 22 Jan 2015 14:40:49 +0100
Subject: [R-sig-Geo] Raster format and compression
Message-ID: <CANJhsN09OZZCq1mm+Q-dtsrLvP13coLkTyh9Vo2P_BoLsyEXZA@mail.gmail.com>

Hello everybody.
I need help with writeRaster function of raster package. I downloaded
WorldClim rasters with 30 second of spatial resolution and I need to change
the projection from WGS84 to ETR89-LAEA. I used projectRaster function and
everything goes fine but when I write the raster map in .tif format, the
same of the input file, the result is much heavier than the first one
(approximately 200 MB versus 45 MB). Is there a particular option of
writeRaster function that I'm missing? Maybe the possibility to compress
the final raster? And which compression should be used?

Many thanks

-- 
Maurizio Marchi
Calenzano (FI) - Italy
ID Skype: maurizioxyz
Ubuntu 14.04 LTS
linux user 552742

	[[alternative HTML version deleted]]


From loic.dutrieux at wur.nl  Thu Jan 22 15:05:40 2015
From: loic.dutrieux at wur.nl (Dutrieux, Loic)
Date: Thu, 22 Jan 2015 14:05:40 +0000
Subject: [R-sig-Geo] Raster format and compression
In-Reply-To: <CANJhsN09OZZCq1mm+Q-dtsrLvP13coLkTyh9Vo2P_BoLsyEXZA@mail.gmail.com>
References: <CANJhsN09OZZCq1mm+Q-dtsrLvP13coLkTyh9Vo2P_BoLsyEXZA@mail.gmail.com>
Message-ID: <A83620D4CC4762448EFB789FD6E9BBB742C1DB26@SCOMP0937.wurnet.nl>

Hello Maurizio,

Did you use the datatype = argument to specify the type (Signed/Unsigned Integer, float, etc)? If you don't writeRaster() will by default use "FLT8S", and there is a factor 4 difference in space between FLT8S and e.g. INT2S.
See for the list of options and what suits your data in the help of dataType (?dataType).

There are some additional compression options which can be passed to writeRaster() via the option = argument. For GeoTIFF you can find the list of options here -- http://www.gdal.org/frmt_gtiff.html

Cheers,
Lo?c 
________________________________________
From: R-sig-Geo [r-sig-geo-bounces at r-project.org] on behalf of Maurizio Marchi [mauriziomarchi85 at gmail.com]
Sent: Thursday, January 22, 2015 2:40 PM
To: R-mailing list
Subject: [R-sig-Geo] Raster format and compression

Hello everybody.
I need help with writeRaster function of raster package. I downloaded
WorldClim rasters with 30 second of spatial resolution and I need to change
the projection from WGS84 to ETR89-LAEA. I used projectRaster function and
everything goes fine but when I write the raster map in .tif format, the
same of the input file, the result is much heavier than the first one
(approximately 200 MB versus 45 MB). Is there a particular option of
writeRaster function that I'm missing? Maybe the possibility to compress
the final raster? And which compression should be used?

Many thanks

--
Maurizio Marchi
Calenzano (FI) - Italy
ID Skype: maurizioxyz
Ubuntu 14.04 LTS
linux user 552742

        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From mauriziomarchi85 at gmail.com  Thu Jan 22 17:10:04 2015
From: mauriziomarchi85 at gmail.com (Maurizio Marchi)
Date: Thu, 22 Jan 2015 17:10:04 +0100
Subject: [R-sig-Geo] Raster format and compression
In-Reply-To: <A83620D4CC4762448EFB789FD6E9BBB742C1DB26@SCOMP0937.wurnet.nl>
References: <CANJhsN09OZZCq1mm+Q-dtsrLvP13coLkTyh9Vo2P_BoLsyEXZA@mail.gmail.com>
	<A83620D4CC4762448EFB789FD6E9BBB742C1DB26@SCOMP0937.wurnet.nl>
Message-ID: <CANJhsN2a1xf6ph+UDg0UiOYwDfZKavZVrLZ+6KAtCfT46DFmQw@mail.gmail.com>

Hi Loic,
yes, I set the 'datatype' argument to Float64 as the same of my input data.
I tried also dataType on my input map ad is "FLT8S". However I think I'm
beginning to understand the mechanism and I will try to follow your
instruction. For example: FLT8S means "Floating with 8 significant values",
while INT2S is "integer with 2 values"...isn't it?
For the moment I will use the "larger and converted maps" but I would like
to understand better the available options. Many thanks for your
suggestions!

Regards,
Maurizio


-- 
Maurizio Marchi
Calenzano (FI) - Italy
ID Skype: maurizioxyz
Ubuntu 14.04 LTS
linux user 552742

	[[alternative HTML version deleted]]


From mauriziomarchi85 at gmail.com  Thu Jan 22 17:15:34 2015
From: mauriziomarchi85 at gmail.com (Maurizio Marchi)
Date: Thu, 22 Jan 2015 17:15:34 +0100
Subject: [R-sig-Geo] Raster format and compression
In-Reply-To: <A83620D4CC4762448EFB789FD6E9BBB742C1DB26@SCOMP0937.wurnet.nl>
References: <CANJhsN09OZZCq1mm+Q-dtsrLvP13coLkTyh9Vo2P_BoLsyEXZA@mail.gmail.com>
	<A83620D4CC4762448EFB789FD6E9BBB742C1DB26@SCOMP0937.wurnet.nl>
Message-ID: <CANJhsN1WLGMDyvBmzm14JM0qEr2kq0SPLGZz7Q=r9xQRnS9xdg@mail.gmail.com>

Uhg, I sent the wrong message!!! Sorry. I read the help of dataType
function and I understood the problem and the meaning. FLT8S, INT2U etc. do
not have the meaning I thought and wrote.

I apologize for the wrong answer!!



-- 
Maurizio Marchi
Calenzano (FI) - Italy
ID Skype: maurizioxyz
Ubuntu 14.04 LTS
linux user 552742

	[[alternative HTML version deleted]]


From johnwoodill at gmail.com  Thu Jan 22 19:01:30 2015
From: johnwoodill at gmail.com (A. John Woodill)
Date: Thu, 22 Jan 2015 08:01:30 -1000
Subject: [R-sig-Geo] Spacial plotting of appt
Message-ID: <CABr942otKXT461O0mrGhdMTs8-Js_RVp1+NMH9eqGXh=N=35gQ@mail.gmail.com>

Greetings r-sig-geo!

I have a large dataset that contains multiple observations for various fips
codes located in the central portion of the United States.  Within this
data set, I have merged lat/long coordinates to zip codes and have plotted
the results of average precipitation (appt) on a map using ggplot2.  I have
been playing with various ways of plotting to provide the most visually
appealing method for displaying the data in the most telling way.  However,
I'm not sure if I'm using the correct methods and am looking for assistance
in other ways to plot the data.  In particular, I'm looking for a gradient
effect to show where the highest levels of precipitation were.  I
appreciate any help and direction you can provide.

Here is what I'm trying to achieve (although I know it's a raster object) :
http://nrelscience.org/2013/05/30/this-is-how-i-did-it-mapping-in-r-with-ggplot2/

This is a small subset of my dataset and I'm posting a link because the
dput is too large.

Data set : https://www.dropbox.com/s/0evuvrlm49ab9up/PRISM_1895_db.csv?dl=0

Code :

PRISM_1895_db <- read.csv("/.../PRISM_1895_db.csv")

regions<- c("north dakota","south
dakota","nebraska","kansas","oklahoma","texas","minnesota","iowa","missouri","arkansas",
"illinois", "indiana", "wisconsin")

# Using geom_plot

ggplot() +
    geom_polygon(data=subset(map_data("state"), region %in% regions),
aes(x=long, y=lat, group=group)) +
    geom_point(data = PRISM_1895_db, aes(x = longitude, y = latitude, color
= APPT), alpha = .5, size = 5) +
    geom_polygon(data=subset(map_data("state"), region %in% regions),
aes(x=long, y=lat, group=group), color="white", fill=NA)

# Using stat_summary2d for tiles

ggplot() +
  geom_polygon(data=subset(map_data("state"), region %in% regions),
aes(x=long, y=lat, group=group)) +
  stat_summary2d(data=PRISM_1895_db, aes(x = longitude, y = latitude, z =
APPT)) +
  geom_polygon(data=subset(map_data("state"), region %in% regions),
aes(x=long, y=lat, group=group), color="white", fill=NA)

	[[alternative HTML version deleted]]


From bhradsky at student.unimelb.edu.au  Fri Jan 23 07:15:25 2015
From: bhradsky at student.unimelb.edu.au (Bron Hradsky)
Date: Thu, 22 Jan 2015 23:15:25 -0700 (MST)
Subject: [R-sig-Geo] New version of adehabitatLT and adehabitatHR
In-Reply-To: <4DD6B1C7.7080109@oncfs.gouv.fr>
References: <4DB9985D.3040504@oncfs.gouv.fr>
	<1305822595690-6382737.post@n2.nabble.com>
	<4DD6B1C7.7080109@oncfs.gouv.fr>
Message-ID: <1421993725725-7587674.post@n2.nabble.com>

Why does redisltraj (type = "time") in adehabitatLT (version 0.3.16) remove
the last location from each burst when rediscretising?  I noticed this with
my data and also in the example provided in the help file.

I would like to rediscretise within specific bursts and then bind the bursts
back together, so I don't want to lose the final location from each burst. 
Is there some way of preventing this from occurring?

e.g. I have fixes at 30 min intervals with some fixes missing.  For one
burst, the final fix was successful and occurred at  2014-05-17 17:00:00.  I
rediscretise using

> vulpes.added <- redisltraj(vulpes.chop, 1800, type = "time")

which works well in terms of interpolating the missing fixes.  However, the
final fix for the burst is now 2014-05-17 16:30:00

Many thanks,
Bronwyn Hradsky
University of Melbourne



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/New-version-of-adehabitatLT-and-adehabitatHR-tp6313981p7587674.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From ferra.xu at yahoo.com  Fri Jan 23 19:00:59 2015
From: ferra.xu at yahoo.com (Ferra Xu)
Date: Fri, 23 Jan 2015 18:00:59 +0000 (UTC)
Subject: [R-sig-Geo] How to show the color bar legend in R?
Message-ID: <1711816110.184408.1422036059437.JavaMail.yahoo@mail.yahoo.com>

Based on the dataset, I computed a 3D kernel (longitude, latitude, depth) and displayed the magnitude with the sphere radius and time with color as follows. I am wondering how I can show the color bar legend.?

Also I have problem with the scale of the graph. I need to see if the balls touch or overlap each other from the graph but since the scales are not real I cannot recognize it. How can I correct it??

library(ks)?
x <- read.csv("HK1.csv")?
y <- x[,1:3]?
fhat1 <- kde(x=y)?
n <- nrow(x)?
col <- grey((n:1)/n)?
plot(fhat1, xlim=c(0,500), ylim=c(0,250), zlim=c(0, 4.4))?
spheres3d(y, radius=15*(x$magnitude), alpha=1, col= col)?

I tried this code (which didn't work):?

legend_image <- as.raster(matrix(grey((n:1)/n), ncol=1))?
plot(c(0,2),c(0,200),type = 'n', axes = F, xlab = '', ylab = '', main = ?'time scale')?
text(x=1.5, y = seq(0,200,l=5), labels = seq(0,200,l=5))?
rasterImage(legend_image, 0, 0, 1, 1)?

And this one in "plotrix" package:?

testcol<- col?
col.labels<- seq(0,200, l=5)?
color.legend(600, 0, 601,200,col.labels,testcol,gradient="y")?

But it gives me this error:?

Error in rect(xleft, ybottoms, xright, ytops, col = col, lty = 0) :?
plot.new has not been called yet?

Also I used legend() in Graphics library:?

legend("right", legend=seq(0,200,l=20), fill= colfunc(20), title="Time Scale")?

But it gives me the legend in a separate window.?Here is my data:?

?longitude ? ? ? ? latitude ? ? ? ?depth ? ? ? ? ? ? time ? ? ? ? ?magnitude?

422.697323 ?164.19886 ? 2.457419 ? ?8.083796636 ?0.83367586?
423.008236 ?163.32434 ? 0.5551326 ? 37.58477455 ?0.893893903?
204.733908 ?218.36365 ? 1.9397874 ? 37.88324312 ?0.912809449?
203.963056 ?218.4808 ? ?0.3723791 ? 43.21775903 ?0.926406005?
100.727581 ?46.60876 ? ?1.4022341 ? 49.41510519 ?0.782807523?
453.335182 ?244.25521 ? 1.6292517 ? 51.73779175 ?0.903910803?
134.909462 ?210.96333 ? 2.2389119 ? 53.13433521 ?0.896529401?
135.300562 ?212.02055 ? 0.6739541 ? 67.55073745 ?0.748783521?
258.237117 ?134.29735 ? 2.1205291 ? 76.34032587 ?0.735699304?
341.305271 ?149.26953 ? 3.718958 ? ?94.33975483 ?0.849509216?
307.138925 ?59.60571 ? ?0.6311074 ? 106.9636715 ?0.987923188?
307.76875 ? 58.91453 ? ?2.6496741 ? 113.8515307 ?0.802115718?
415.025535 ?217.17398 ? 1.7155688 ? 115.7464603 ?0.875580325?


	[[alternative HTML version deleted]]


From milan.cisty at stuba.sk  Sat Jan 24 20:22:10 2015
From: milan.cisty at stuba.sk (Milan Cisty)
Date: Sat, 24 Jan 2015 20:22:10 +0100
Subject: [R-sig-Geo] gIntersection - Input geom 0 is invalid
Message-ID: <web-48022809@stuba.sk>

Dear list members.
I tried intersection of two SpatialPolygonsDataFrames and I get following
error:
 > podnyDruh=gIntersection(textura, zavlahaJTSK)
Error in RGEOSBinTopoFunc(spgeom1, spgeom2, byid, id, drop_not_poly,
"rgeos_intersection") : 
  TopologyException: Input geom 0 is invalid: Self-intersection at or near
point -536834.52051807998 -1210383.10809479 at -536834.52051807998
-1210383.10809479
I believe, that there is refered error in data (in geom 0), but I would like to
ask if there is not possible some workaround this (I want to do more
intersections). When I made shp files it was possible to accomplish
intersection in ArcGIS, so maybe there is some trick how to accomplish it also
in R. Referred error in geom 0 is not in area of my interest.
I am not sending data because I do not think its necessary, but I can if it
could help.
Thanks,
Milan


From lyndon.estes at gmail.com  Sat Jan 24 21:27:47 2015
From: lyndon.estes at gmail.com (Lyndon Estes)
Date: Sat, 24 Jan 2015 15:27:47 -0500
Subject: [R-sig-Geo] gIntersection - Input geom 0 is invalid
In-Reply-To: <web-48022809@stuba.sk>
References: <web-48022809@stuba.sk>
Message-ID: <CALuVVaasx01X1fj8obCmV1S1kT5=+aUKhMm=Q659XPSO5S-NuQ@mail.gmail.com>

Hi Milan,

Two possible workarounds I have found that can sometimes clear up a
problem with unclean polygons are to first run either:

gBuffer(your_shape, width = 0)

gUnaryUnion (if you don't mind losing the identities of individual polygons)

And then try run the intersection on the output.  It might not work.  The
next option is to use pprepair, which is a standalone program that is
great for repairing polygons.

https://github.com/tudelft3d/pprepair

Hope this helps.

Cheers, Lyndon

On Sat, Jan 24, 2015 at 2:22 PM, Milan Cisty <milan.cisty at stuba.sk> wrote:
> Dear list members.
> I tried intersection of two SpatialPolygonsDataFrames and I get following
> error:
>  > podnyDruh=gIntersection(textura, zavlahaJTSK)
> Error in RGEOSBinTopoFunc(spgeom1, spgeom2, byid, id, drop_not_poly,
> "rgeos_intersection") :
>   TopologyException: Input geom 0 is invalid: Self-intersection at or near
> point -536834.52051807998 -1210383.10809479 at -536834.52051807998
> -1210383.10809479
> I believe, that there is refered error in data (in geom 0), but I would like to
> ask if there is not possible some workaround this (I want to do more
> intersections). When I made shp files it was possible to accomplish
> intersection in ArcGIS, so maybe there is some trick how to accomplish it also
> in R. Referred error in geom 0 is not in area of my interest.
> I am not sending data because I do not think its necessary, but I can if it
> could help.
> Thanks,
> Milan
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From bhradsky at student.unimelb.edu.au  Sun Jan 25 01:43:26 2015
From: bhradsky at student.unimelb.edu.au (Bronwyn Hradsky)
Date: Sun, 25 Jan 2015 11:43:26 +1100
Subject: [R-sig-Geo] Rediscretising trajectories in adehabitatLT
Message-ID: <000601d03837$f0b19130$d214b390$@student.unimelb.edu.au>

Dear list members,

 

Do you know how to prevent redisltraj (type = "time") in adehabitatLT
(version 0.3.16) from removing the last location from each burst when
rediscretising?  I noticed this with my data and also in the example
provided in the help file.

 

I would like to rediscretise within specific bursts and then bind the bursts
back together, so I don't want to lose the final location from each burst. 

Is there some way of preventing this?

 

e.g. I have GPS fixes at 30 min intervals with some fixes missing.  For one
burst, the final fix was successful and occurred at  2014-05-17 17:00:00.  I
rediscretise using

 

> vulpes.added <- redisltraj(vulpes.chop, 1800, type = "time")

 

which works well in terms of interpolating the missing fixes.  However, the
final fix for the burst is now 2014-05-17 16:30:00

 

Many thanks,

Bronwyn 

 


	[[alternative HTML version deleted]]


From annajess at gmx.de  Sun Jan 25 09:17:01 2015
From: annajess at gmx.de (Anna-Marie Corman)
Date: Sun, 25 Jan 2015 09:17:01 +0100
Subject: [R-sig-Geo] fpt function in adehbaitatLT
Message-ID: <54C4A67D.5080104@gmx.de>

Dear list,

does anybody have experiences with the fpt function in the 
adehabitatLT-package? I want to calculate first-passage time for several 
seabird individuals just to divide my foraging trips into commuting and 
real foraging localizations.
Is it possible to run this function for each individual or do I have to 
do it for each trip separately?

Thanks a lot for any comment on that.

Best wishes,
Anna


From bfalevlist at gmail.com  Sun Jan 25 13:49:19 2015
From: bfalevlist at gmail.com (=?iso-8859-2?Q?Bede-Fazekas_=C1kos?=)
Date: Sun, 25 Jan 2015 13:49:19 +0100
Subject: [R-sig-Geo] regression kriging with singular variogram
Message-ID: <002d01d0389d$56d03150$047093f0$@gmail.com>

Dear All,
I have a simple question about regression kriging (gstat:::krige()) and
variogram fitting (gstat:::fit.variogram()), which I have not found exact
answer for (neither in the description of package gstat, nor on the
internet). Does it cause any problem if I do regression kriging with a
fitted variogram (eg. a spherical or exponential type) that is singular (ie.
I got a message 'warning: singular model in variogram fit') but shows a
curve in plot(experimental_variogram, fitted_variogram) that is expected
(ie. it fits nicely to the points and has a shape as drawn in the books)?

A bonus question: is the message 'warning: singular model in variogram fit'
a warning or a simple message? I tried to use
fitted_variogram <- suppressWarnings(fit.variogram(...))
and
fitted_variogram <- suppressMessages(fit.variogram(...))
but none of them hides the message. Please let me know how to hide it.

Thanks in advance,
?kos Bede-Fazekas
Corvinus University of Budapest
Hungary


From milan.cisty at stuba.sk  Sun Jan 25 13:55:02 2015
From: milan.cisty at stuba.sk (Milan Cisty)
Date: Sun, 25 Jan 2015 13:55:02 +0100
Subject: [R-sig-Geo] gIntersection - Input geom 0 is invalid
In-Reply-To: <web-48022809@stuba.sk>
References: <web-48022809@stuba.sk>
Message-ID: <web-48028673@stuba.sk>

Thanks Lyndon, but in my case it did not help. I find simple solution suitable
in my case here:
http://gis.stackexchange.com/questions/93096/how-to-perform-a-true-gis-clip-of-polygons-layer-using-a-polygon-layer-in-r
originally I had:
podnyDruh=gIntersection(textura, zavlahaJTSK)
which produce error, but when I run it this way, it run OK:
podnyDruh=gIntersection(textura, zavlahaJTSK, byid=TRUE)


On Sat, 24 Jan 2015 20:22:10 +0100
 "Milan Cisty" <milan.cisty at stuba.sk> wrote:
>Dear list members.
>I tried intersection of two SpatialPolygonsDataFrames and I get following
>error:
> > podnyDruh=gIntersection(textura, zavlahaJTSK)
>Error in RGEOSBinTopoFunc(spgeom1, spgeom2, byid, id, drop_not_poly,
>"rgeos_intersection") : 
>  TopologyException: Input geom 0 is invalid: Self-intersection at or near
>point -536834.52051807998 -1210383.10809479 at -536834.52051807998
>-1210383.10809479
>I believe, that there is refered error in data (in geom 0), but I would like
>to
>ask if there is not possible some workaround this (I want to do more
>intersections). When I made shp files it was possible to accomplish
>intersection in ArcGIS, so maybe there is some trick how to accomplish it also
>in R. Referred error in geom 0 is not in area of my interest.
>I am not sending data because I do not think its necessary, but I can if it
>could help.
>Thanks,
>Milan


From edzer.pebesma at uni-muenster.de  Mon Jan 26 08:20:45 2015
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 26 Jan 2015 08:20:45 +0100
Subject: [R-sig-Geo] regression kriging with singular variogram
In-Reply-To: <002d01d0389d$56d03150$047093f0$@gmail.com>
References: <002d01d0389d$56d03150$047093f0$@gmail.com>
Message-ID: <54C5EACD.5050802@uni-muenster.de>



On 01/25/2015 01:49 PM, Bede-Fazekas ?kos wrote:
> Dear All,
> I have a simple question about regression kriging (gstat:::krige()) and
> variogram fitting (gstat:::fit.variogram()), which I have not found exact
> answer for (neither in the description of package gstat, nor on the
> internet). Does it cause any problem if I do regression kriging with a
> fitted variogram (eg. a spherical or exponential type) that is singular (ie.
> I got a message 'warning: singular model in variogram fit') but shows a
> curve in plot(experimental_variogram, fitted_variogram) that is expected
> (ie. it fits nicely to the points and has a shape as drawn in the books)?

No; the only problem is that with this message printed, you still need
to look at the variogram and see if it make sense at all, as the fit
method could not find some optimum.

> 
> A bonus question: is the message 'warning: singular model in variogram fit'
> a warning or a simple message? I tried to use
> fitted_variogram <- suppressWarnings(fit.variogram(...))
> and
> fitted_variogram <- suppressMessages(fit.variogram(...))
> but none of them hides the message. Please let me know how to hide it.

You can't, because it uses Rprintf(). I've changed this to use the R
warning mechanism, so in future versions you can.

-- 
Edzer Pebesma,  Co-Editor-in-Chief Computers & Geosciences
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150126/5ab2cbc3/attachment.bin>

From vanessamachault at yahoo.com.br  Mon Jan 26 12:17:31 2015
From: vanessamachault at yahoo.com.br (Vanessa Machault)
Date: Mon, 26 Jan 2015 11:17:31 +0000 (UTC)
Subject: [R-sig-Geo] Raster package - Focal sum in circles
Message-ID: <875921175.544534.1422271051084.JavaMail.yahoo@mail.yahoo.com>

Hi,
I have a question regarding the package "raster" and the function "focal".
I have a raster with 0.5m pixels and I would like to calculate the sum of all pixels in 50m radius circles, with a moving window.I have some NA values and I need to ignore them in the calculation.
Then, I would create a new raster where all the pixels that are not NA would be filled with the sum value.
I tried with "focal" and "focal weight" but nothing comes close to the result.Example :fw <- focalWeight(x, 50, type='circle')
p_focal<-focal(x, w=fw,fun=sum , na.rm=TRUE)
I saw that several way of writing those focal stats may lead to different computation times. Here, as I need to repeat the process for a large number of rasters, computation time may be an issue.
I thank you very much in advance for your help.Regards,Vanessa Machault

	[[alternative HTML version deleted]]


From gduveiller at gmail.com  Mon Jan 26 16:19:49 2015
From: gduveiller at gmail.com (Gregory Duveiller)
Date: Mon, 26 Jan 2015 16:19:49 +0100
Subject: [R-sig-Geo]  Unexpected behaviour of "area" slot in sp Polygons
Message-ID: <CAHntisnC3rL-BxZykhxDdJZjJPSHOeZXZqvySqEaJ4ktjC5XaQ@mail.gmail.com>

Dear All,

I noticed something unusual when trying to get the areas of some polygons I
extracted from a raster.

In the script below, I generate a random raster with 4 classes, which I
then turn to a "SpatialPolygonsDataFrame". I then try to calculate areas
per class in two different ways.

########

require(sp)
require(raster)
require(rgeos)

nrows=100; ncols=100

rdum<-raster(nrows=nrows,ncols=ncols,xmn=0,ymn=0,ymx=100,xmx=100)
rdum[]<-round(runif(nrows*ncols,1,4))

vdum <- rasterToPolygons(rdum,dissolve=T)

# calculate areas
df <- data.frame(cls=1:4)
for(i in 1:4){
  ddd <- sapply(vdum at polygons[[i]]@Polygons, function(x) x at area)
  df$area1[i] <- sum(ddd)
  df$area2[i] <- sum(as.vector(rdum==i))
}
#########

When I try to calculate the area per class from the attributes of the
Polygons, I do not always get the same number as when I simply count the
number of pixels of each class in the raster. In one iteration, for
example, I get the following number in which the areas in the Polygons is
higher by 52 units:

> df
  cls area1 area2
1   1  1670  1670
2   2  3384  3352
3   3  3355  3335
4   4  1643  1643

Is there a reason one would not expect these to be always equal?

Thanks in advance...

Gregory Duveiller

	[[alternative HTML version deleted]]


From ferra.xu at yahoo.com  Mon Jan 26 18:36:44 2015
From: ferra.xu at yahoo.com (Ferra Xu)
Date: Mon, 26 Jan 2015 17:36:44 +0000 (UTC)
Subject: [R-sig-Geo] How to show the color bar legend in R?
In-Reply-To: <1711816110.184408.1422036059437.JavaMail.yahoo@mail.yahoo.com>
References: <1711816110.184408.1422036059437.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <988882151.404638.1422293804666.JavaMail.yahoo@mail.yahoo.com>

I am still struggling with this question. I appreciate any help from you!
 

     On Friday, January 23, 2015 11:00 AM, Ferra Xu <ferra.xu at yahoo.com> wrote:
   

 Based on the dataset, I computed a 3D kernel (longitude, latitude, depth) and displayed the magnitude with the sphere radius and time with color as follows. I am wondering how I can show the color bar legend.?

Also I have problem with the scale of the graph. I need to see if the balls touch or overlap each other from the graph but since the scales are not real I cannot recognize it. How can I correct it??

library(ks)?
x <- read.csv("HK1.csv")?
y <- x[,1:3]?
fhat1 <- kde(x=y)?
n <- nrow(x)?
col <- grey((n:1)/n)?
plot(fhat1, xlim=c(0,500), ylim=c(0,250), zlim=c(0, 4.4))?
spheres3d(y, radius=15*(x$magnitude), alpha=1, col= col)?

I tried this code (which didn't work):?

legend_image <- as.raster(matrix(grey((n:1)/n), ncol=1))?
plot(c(0,2),c(0,200),type = 'n', axes = F, xlab = '', ylab = '', main = ?'time scale')?
text(x=1.5, y = seq(0,200,l=5), labels = seq(0,200,l=5))?
rasterImage(legend_image, 0, 0, 1, 1)?

And this one in "plotrix" package:?

testcol<- col?
col.labels<- seq(0,200, l=5)?
color.legend(600, 0, 601,200,col.labels,testcol,gradient="y")?

But it gives me this error:?

Error in rect(xleft, ybottoms, xright, ytops, col = col, lty = 0) :?
plot.new has not been called yet?

Also I used legend() in Graphics library:?

legend("right", legend=seq(0,200,l=20), fill= colfunc(20), title="Time Scale")?

But it gives me the legend in a separate window.?Here is my data:?

?longitude ? ? ? ? latitude ? ? ? ?depth ? ? ? ? ? ? time ? ? ? ? ?magnitude?

422.697323 ?164.19886 ? 2.457419 ? ?8.083796636 ?0.83367586?
423.008236 ?163.32434 ? 0.5551326 ? 37.58477455 ?0.893893903?
204.733908 ?218.36365 ? 1.9397874 ? 37.88324312 ?0.912809449?
203.963056 ?218.4808 ? ?0.3723791 ? 43.21775903 ?0.926406005?
100.727581 ?46.60876 ? ?1.4022341 ? 49.41510519 ?0.782807523?
453.335182 ?244.25521 ? 1.6292517 ? 51.73779175 ?0.903910803?
134.909462 ?210.96333 ? 2.2389119 ? 53.13433521 ?0.896529401?
135.300562 ?212.02055 ? 0.6739541 ? 67.55073745 ?0.748783521?
258.237117 ?134.29735 ? 2.1205291 ? 76.34032587 ?0.735699304?
341.305271 ?149.26953 ? 3.718958 ? ?94.33975483 ?0.849509216?
307.138925 ?59.60571 ? ?0.6311074 ? 106.9636715 ?0.987923188?
307.76875 ? 58.91453 ? ?2.6496741 ? 113.8515307 ?0.802115718?
415.025535 ?217.17398 ? 1.7155688 ? 115.7464603 ?0.875580325?



   
	[[alternative HTML version deleted]]


From zaholdenfs at gmail.com  Mon Jan 26 19:02:00 2015
From: zaholdenfs at gmail.com (Zack Holden)
Date: Mon, 26 Jan 2015 11:02:00 -0700
Subject: [R-sig-Geo] How to show the color bar legend in R?
In-Reply-To: <988882151.404638.1422293804666.JavaMail.yahoo@mail.yahoo.com>
References: <1711816110.184408.1422036059437.JavaMail.yahoo@mail.yahoo.com>
	<988882151.404638.1422293804666.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <CAGC_mZRY0YWLr55d7VASR84c0gKFbawuqNOCX=SPS7O13GqXZw@mail.gmail.com>

Hi Ferra,
Without reproducible code, it's difficult to help. You might have a look at
image.plot() in the fields library, and image()

I'm not sure if this is exactly what you're looking for, but here is a
quick example of one way to control the image and legend in a plot, using
the layout command. You can create a small panel below your main plot and
then add your legend there with more control.

I hope this is helpful.

###########################################
# example code for image plot of volcano data
require(fields)
require(raster)

dat <- raster(volcano)


zc <- as.matrix(seq(minValue(dat), maxValue(dat), length.out=100))

mycolor1 <- two.colors(n=100, start="darkblue", end="red",
middle="yellow1", alpha=.9)

layout(matrix(c(1,2), 2, 1, byrow = TRUE), heights=c(4,1), widths=c(4) )
layout.show(2)
image(dat, axes=F, col=mycolor1, xlab="", ylab="")

par(mar=c(2,4,.1,2))
image(zc, col=mycolor1, axes=F, xlab="", ylab="" )

axis(1, at=seq(0,1, length.out=5),  labels=round(seq(minValue(dat),
maxValue(dat),length.out=5), digits=0), las=1,  tcl=-.15, padj=-1, cex=1.5)
# every .1 corr
# end code
#############################################



On Mon, Jan 26, 2015 at 10:36 AM, Ferra Xu via R-sig-Geo <
r-sig-geo at r-project.org> wrote:

> I am still struggling with this question. I appreciate any help from you!
>
>
>      On Friday, January 23, 2015 11:00 AM, Ferra Xu <ferra.xu at yahoo.com>
> wrote:
>
>
>  Based on the dataset, I computed a 3D kernel (longitude, latitude, depth)
> and displayed the magnitude with the sphere radius and time with color as
> follows. I am wondering how I can show the color bar legend.
>
> Also I have problem with the scale of the graph. I need to see if the
> balls touch or overlap each other from the graph but since the scales are
> not real I cannot recognize it. How can I correct it?
>
> library(ks)
> x <- read.csv("HK1.csv")
> y <- x[,1:3]
> fhat1 <- kde(x=y)
> n <- nrow(x)
> col <- grey((n:1)/n)
> plot(fhat1, xlim=c(0,500), ylim=c(0,250), zlim=c(0, 4.4))
> spheres3d(y, radius=15*(x$magnitude), alpha=1, col= col)
>
> I tried this code (which didn't work):
>
> legend_image <- as.raster(matrix(grey((n:1)/n), ncol=1))
> plot(c(0,2),c(0,200),type = 'n', axes = F, xlab = '', ylab = '', main =
>  'time scale')
> text(x=1.5, y = seq(0,200,l=5), labels = seq(0,200,l=5))
> rasterImage(legend_image, 0, 0, 1, 1)
>
> And this one in "plotrix" package:
>
> testcol<- col
> col.labels<- seq(0,200, l=5)
> color.legend(600, 0, 601,200,col.labels,testcol,gradient="y")
>
> But it gives me this error:
>
> Error in rect(xleft, ybottoms, xright, ytops, col = col, lty = 0) :
> plot.new has not been called yet
>
> Also I used legend() in Graphics library:
>
> legend("right", legend=seq(0,200,l=20), fill= colfunc(20), title="Time
> Scale")
>
> But it gives me the legend in a separate window. Here is my data:
>
>  longitude         latitude        depth             time
>  magnitude
>
> 422.697323  164.19886   2.457419    8.083796636  0.83367586
> 423.008236  163.32434   0.5551326   37.58477455  0.893893903
> 204.733908  218.36365   1.9397874   37.88324312  0.912809449
> 203.963056  218.4808    0.3723791   43.21775903  0.926406005
> 100.727581  46.60876    1.4022341   49.41510519  0.782807523
> 453.335182  244.25521   1.6292517   51.73779175  0.903910803
> 134.909462  210.96333   2.2389119   53.13433521  0.896529401
> 135.300562  212.02055   0.6739541   67.55073745  0.748783521
> 258.237117  134.29735   2.1205291   76.34032587  0.735699304
> 341.305271  149.26953   3.718958    94.33975483  0.849509216
> 307.138925  59.60571    0.6311074   106.9636715  0.987923188
> 307.76875   58.91453    2.6496741   113.8515307  0.802115718
> 415.025535  217.17398   1.7155688   115.7464603  0.875580325
>
>
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From r.hijmans at gmail.com  Mon Jan 26 19:21:28 2015
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 26 Jan 2015 10:21:28 -0800
Subject: [R-sig-Geo] Unexpected behaviour of "area" slot in sp Polygons
In-Reply-To: <CAHntisnC3rL-BxZykhxDdJZjJPSHOeZXZqvySqEaJ4ktjC5XaQ@mail.gmail.com>
References: <CAHntisnC3rL-BxZykhxDdJZjJPSHOeZXZqvySqEaJ4ktjC5XaQ@mail.gmail.com>
Message-ID: <CANtt_hy4hduEARQxuwiY6sFSz6KRz_ksC=vxf0gvcctTLGJ8Tw@mail.gmail.com>

This is probably because you are not subtracting areas of holes? To
get areas for SpatialPolygons, use:

library(rgeos)
gArea(vdum)

and in this case for the RasterLayer, I would use

freq(rdum)

Robert


On Mon, Jan 26, 2015 at 7:19 AM, Gregory Duveiller <gduveiller at gmail.com> wrote:
> Dear All,
>
> I noticed something unusual when trying to get the areas of some polygons I
> extracted from a raster.
>
> In the script below, I generate a random raster with 4 classes, which I
> then turn to a "SpatialPolygonsDataFrame". I then try to calculate areas
> per class in two different ways.
>
> ########
>
> require(sp)
> require(raster)
> require(rgeos)
>
> nrows=100; ncols=100
>
> rdum<-raster(nrows=nrows,ncols=ncols,xmn=0,ymn=0,ymx=100,xmx=100)
> rdum[]<-round(runif(nrows*ncols,1,4))
>
> vdum <- rasterToPolygons(rdum,dissolve=T)
>
> # calculate areas
> df <- data.frame(cls=1:4)
> for(i in 1:4){
>   ddd <- sapply(vdum at polygons[[i]]@Polygons, function(x) x at area)
>   df$area1[i] <- sum(ddd)
>   df$area2[i] <- sum(as.vector(rdum==i))
> }
> #########
>
> When I try to calculate the area per class from the attributes of the
> Polygons, I do not always get the same number as when I simply count the
> number of pixels of each class in the raster. In one iteration, for
> example, I get the following number in which the areas in the Polygons is
> higher by 52 units:
>
>> df
>   cls area1 area2
> 1   1  1670  1670
> 2   2  3384  3352
> 3   3  3355  3335
> 4   4  1643  1643
>
> Is there a reason one would not expect these to be always equal?
>
> Thanks in advance...
>
> Gregory Duveiller
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From r.hijmans at gmail.com  Mon Jan 26 19:27:28 2015
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 26 Jan 2015 10:27:28 -0800
Subject: [R-sig-Geo] Raster package - Focal sum in circles
In-Reply-To: <875921175.544534.1422271051084.JavaMail.yahoo@mail.yahoo.com>
References: <875921175.544534.1422271051084.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <CANtt_hx5HB4QcAHQ10MUwm1KkfoSwWXTUMkvx6XP6xi-D0cAcg@mail.gmail.com>

Your focal weights sum to 1, such that you get the mean value when
using 'fun=sum'
if you want to sum, you can do

fw <- focalWeight(x, 50, type='circle')
fw[fw>0] <- 1

p_focal<-focal(x, w=fw,fun=sum , na.rm=TRUE)


Robert

On Mon, Jan 26, 2015 at 3:17 AM, Vanessa Machault
<vanessamachault at yahoo.com.br> wrote:
> Hi,
> I have a question regarding the package "raster" and the function "focal".
> I have a raster with 0.5m pixels and I would like to calculate the sum of all pixels in 50m radius circles, with a moving window.I have some NA values and I need to ignore them in the calculation.
> Then, I would create a new raster where all the pixels that are not NA would be filled with the sum value.
> I tried with "focal" and "focal weight" but nothing comes close to the result.Example :fw <- focalWeight(x, 50, type='circle')
> p_focal<-focal(x, w=fw,fun=sum , na.rm=TRUE)
> I saw that several way of writing those focal stats may lead to different computation times. Here, as I need to repeat the process for a large number of rasters, computation time may be an issue.
> I thank you very much in advance for your help.Regards,Vanessa Machault
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Roger.Bivand at nhh.no  Mon Jan 26 19:43:06 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 26 Jan 2015 19:43:06 +0100
Subject: [R-sig-Geo] Unexpected behaviour of "area" slot in sp Polygons
In-Reply-To: <CAHntisnC3rL-BxZykhxDdJZjJPSHOeZXZqvySqEaJ4ktjC5XaQ@mail.gmail.com>
References: <CAHntisnC3rL-BxZykhxDdJZjJPSHOeZXZqvySqEaJ4ktjC5XaQ@mail.gmail.com>
Message-ID: <alpine.LFD.2.11.1501261916220.10539@reclus.nhh.no>

On Mon, 26 Jan 2015, Gregory Duveiller wrote:

> Dear All,
>
> I noticed something unusual when trying to get the areas of some polygons I
> extracted from a raster.
>
> In the script below, I generate a random raster with 4 classes, which I
> then turn to a "SpatialPolygonsDataFrame". I then try to calculate areas
> per class in two different ways.
>
> ########
>
> require(sp)
> require(raster)
> require(rgeos)
>
> nrows=100; ncols=100
>
> rdum<-raster(nrows=nrows,ncols=ncols,xmn=0,ymn=0,ymx=100,xmx=100)

set.seed() # please!

> rdum[]<-round(runif(nrows*ncols,1,4))
>
> vdum <- rasterToPolygons(rdum,dissolve=T)
>
> # calculate areas
> df <- data.frame(cls=1:4)
> for(i in 1:4){
>  ddd <- sapply(vdum at polygons[[i]]@Polygons, function(x) x at area)
>  df$area1[i] <- sum(ddd)
>  df$area2[i] <- sum(as.vector(rdum==i))
> }
> #########
>
> When I try to calculate the area per class from the attributes of the
> Polygons, I do not always get the same number as when I simply count the
> number of pixels of each class in the raster. In one iteration, for
> example, I get the following number in which the areas in the Polygons is
> higher by 52 units:
>
>> df
>  cls area1 area2
> 1   1  1670  1670
> 2   2  3384  3352
> 3   3  3355  3335
> 4   4  1643  1643
>

Without a seed set, this can't be reproduced, but with:

rdum<-raster(nrows=nrows,ncols=ncols,xmn=0,ymn=0,ymx=100,xmx=100)
set.seed(1)
rdum[]<-round(runif(nrows*ncols,1,4))
vdum <- rasterToPolygons(rdum,dissolve=T)
df <- data.frame(cls=1:4)
for(i in 1:4){
   ddd <- sapply(vdum at polygons[[i]]@Polygons, function(x) x at area)
   df$area1[i] <- sum(ddd)
   df$area2[i] <- sum(as.vector(rdum==i))
}
df$area3 <- gArea(vdum, byid=TRUE)

we get

> df
   cls area1 area2 area3
1   1  1692  1692  1692
2   2  3389  3355  3355
3   3  3249  3219  3219
4   4  1734  1734  1734
> sapply(df, sum)
   cls area1 area2 area3
    10 10064 10000 10000

The purpose of the area slot is to order the polygons for plotting from 
largest to smallest, which was needed for colour fills before the graphics 
polygon plotting function knew how to handle holes (so the area is gross 
of holes), and is still needed for hatched filling. It isn't necessarily 
to give the area of a Polygons object, see ?"Polygons-class".

There are holes in vdum:

> table(unlist(sapply(slot(vdum, "polygons"), function(x) sapply(slot(x, 
"Polygons"), slot, "hole"))))

FALSE  TRUE
  4734    28

so this is a probable explanation.

Roger

> Is there a reason one would not expect these to be always equal?
>
> Thanks in advance...
>
> Gregory Duveiller
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From galuardi at mit.edu  Mon Jan 26 21:15:06 2015
From: galuardi at mit.edu (Benjamin.Galuardi)
Date: Mon, 26 Jan 2015 15:15:06 -0500
Subject: [R-sig-Geo] fpt function in adehbaitatLT
In-Reply-To: <54C4A67D.5080104@gmx.de>
References: <54C4A67D.5080104@gmx.de>
Message-ID: <54C6A04A.6000103@mit.edu>

Hi Anna,

I have not used the fpt function per se, but my experience with LTRAJ 
objects is that adehabitat functions are designed to run across all 
individuals in the object list. The fpt example in the package:

data(puechcirc)
i <- fpt(puechcirc, seq(300,1000, length=30))
plot(i, scale = 500, warn = FALSE)

uses an object with 3 individuals.

Cheers,

Ben



On 1/25/2015 3:17 AM, Anna-Marie Corman wrote:
> Dear list,
>
> does anybody have experiences with the fpt function in the 
> adehabitatLT-package? I want to calculate first-passage time for 
> several seabird individuals just to divide my foraging trips into 
> commuting and real foraging localizations.
> Is it possible to run this function for each individual or do I have 
> to do it for each trip separately?
>
> Thanks a lot for any comment on that.
>
> Best wishes,
> Anna
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
==================================================
Benjamin Galuardi
PhD Student
NMFS-Seagrant Population Dynamics Fellow
SMAST, UMass Dartmouth


From ferra.xu at yahoo.com  Mon Jan 26 21:28:15 2015
From: ferra.xu at yahoo.com (Ferra Xu)
Date: Mon, 26 Jan 2015 20:28:15 +0000 (UTC)
Subject: [R-sig-Geo] How to show the color bar legend in R?
In-Reply-To: <CAGC_mZRY0YWLr55d7VASR84c0gKFbawuqNOCX=SPS7O13GqXZw@mail.gmail.com>
References: <CAGC_mZRY0YWLr55d7VASR84c0gKFbawuqNOCX=SPS7O13GqXZw@mail.gmail.com>
Message-ID: <2106167621.481906.1422304095606.JavaMail.yahoo@mail.yahoo.com>

Thank you for your email Zack. When I run the code that you provided, it gives me this error:
Error in if (axes) { : argument is not interpretable as logicalIn addition: Warning message:In if (axes) { :? the condition has length > 1 and only the first element will be used
It seems there is a problem with my R ! 

     On Monday, January 26, 2015 11:02 AM, Zack Holden <zaholdenfs at gmail.com> wrote:
   

 Hi Ferra,Without reproducible code, it's difficult to help. You might have a look at image.plot() in the fields library, and image()
I'm not sure if this is exactly what you're looking for, but here is a quick example of one way to control the image and legend in a plot, using the layout command. You can create a small panel below your main plot and then add your legend there with more control.?
I hope this is helpful.?
############################################ example code for image plot of volcano datarequire(fields)require(raster)
dat <- raster(volcano)

zc <- as.matrix(seq(minValue(dat), maxValue(dat), length.out=100))
mycolor1 <- two.colors(n=100, start="darkblue", end="red", middle="yellow1", alpha=.9)
layout(matrix(c(1,2), 2, 1, byrow = TRUE), heights=c(4,1), widths=c(4) )layout.show(2)image(dat, axes=F, col=mycolor1, xlab="", ylab="")
par(mar=c(2,4,.1,2))image(zc, col=mycolor1, axes=F, xlab="", ylab="" )
axis(1, at=seq(0,1, length.out=5), ?labels=round(seq(minValue(dat), maxValue(dat),length.out=5), digits=0), las=1, ?tcl=-.15, padj=-1, cex=1.5) # every .1 corr# end code#############################################


On Mon, Jan 26, 2015 at 10:36 AM, Ferra Xu via R-sig-Geo <r-sig-geo at r-project.org> wrote:

I am still struggling with this question. I appreciate any help from you!


? ? ?On Friday, January 23, 2015 11:00 AM, Ferra Xu <ferra.xu at yahoo.com> wrote:


?Based on the dataset, I computed a 3D kernel (longitude, latitude, depth) and displayed the magnitude with the sphere radius and time with color as follows. I am wondering how I can show the color bar legend.?

Also I have problem with the scale of the graph. I need to see if the balls touch or overlap each other from the graph but since the scales are not real I cannot recognize it. How can I correct it??

library(ks)?
x <- read.csv("HK1.csv")?
y <- x[,1:3]?
fhat1 <- kde(x=y)?
n <- nrow(x)?
col <- grey((n:1)/n)?
plot(fhat1, xlim=c(0,500), ylim=c(0,250), zlim=c(0, 4.4))?
spheres3d(y, radius=15*(x$magnitude), alpha=1, col= col)?

I tried this code (which didn't work):?

legend_image <- as.raster(matrix(grey((n:1)/n), ncol=1))?
plot(c(0,2),c(0,200),type = 'n', axes = F, xlab = '', ylab = '', main = ?'time scale')?
text(x=1.5, y = seq(0,200,l=5), labels = seq(0,200,l=5))?
rasterImage(legend_image, 0, 0, 1, 1)?

And this one in "plotrix" package:?

testcol<- col?
col.labels<- seq(0,200, l=5)?
color.legend(600, 0, 601,200,col.labels,testcol,gradient="y")?

But it gives me this error:?

Error in rect(xleft, ybottoms, xright, ytops, col = col, lty = 0) :?
plot.new has not been called yet?

Also I used legend() in Graphics library:?

legend("right", legend=seq(0,200,l=20), fill= colfunc(20), title="Time Scale")?

But it gives me the legend in a separate window.?Here is my data:?

?longitude ? ? ? ? latitude ? ? ? ?depth ? ? ? ? ? ? time ? ? ? ? ?magnitude?

422.697323 ?164.19886 ? 2.457419 ? ?8.083796636 ?0.83367586?
423.008236 ?163.32434 ? 0.5551326 ? 37.58477455 ?0.893893903?
204.733908 ?218.36365 ? 1.9397874 ? 37.88324312 ?0.912809449?
203.963056 ?218.4808 ? ?0.3723791 ? 43.21775903 ?0.926406005?
100.727581 ?46.60876 ? ?1.4022341 ? 49.41510519 ?0.782807523?
453.335182 ?244.25521 ? 1.6292517 ? 51.73779175 ?0.903910803?
134.909462 ?210.96333 ? 2.2389119 ? 53.13433521 ?0.896529401?
135.300562 ?212.02055 ? 0.6739541 ? 67.55073745 ?0.748783521?
258.237117 ?134.29735 ? 2.1205291 ? 76.34032587 ?0.735699304?
341.305271 ?149.26953 ? 3.718958 ? ?94.33975483 ?0.849509216?
307.138925 ?59.60571 ? ?0.6311074 ? 106.9636715 ?0.987923188?
307.76875 ? 58.91453 ? ?2.6496741 ? 113.8515307 ?0.802115718?
415.025535 ?217.17398 ? 1.7155688 ? 115.7464603 ?0.875580325?




? ? ? ? [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo




   
	[[alternative HTML version deleted]]


From r.hijmans at gmail.com  Tue Jan 27 02:33:53 2015
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 26 Jan 2015 17:33:53 -0800
Subject: [R-sig-Geo] How to show the color bar legend in R?
In-Reply-To: <2106167621.481906.1422304095606.JavaMail.yahoo@mail.yahoo.com>
References: <CAGC_mZRY0YWLr55d7VASR84c0gKFbawuqNOCX=SPS7O13GqXZw@mail.gmail.com>
	<2106167621.481906.1422304095606.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <CANtt_hx7oMuXsMo3KGnyYOucXp-D-DrCcOirD5pXeTwubMBFSA@mail.gmail.com>

> It seems there is a problem with my R !

It is for a good reason that you are requested to include your

sessionInfo()

information in messages to this list.  But even more important is to
first make sure that you are using the current version of R and the
current versions of all relevant packages.

Robert


On Mon, Jan 26, 2015 at 12:28 PM, Ferra Xu via R-sig-Geo
<r-sig-geo at r-project.org> wrote:
> Thank you for your email Zack. When I run the code that you provided, it gives me this error:
> Error in if (axes) { : argument is not interpretable as logicalIn addition: Warning message:In if (axes) { :  the condition has length > 1 and only the first element will be used
> It seems there is a problem with my R !
>
>      On Monday, January 26, 2015 11:02 AM, Zack Holden <zaholdenfs at gmail.com> wrote:
>
>
>  Hi Ferra,Without reproducible code, it's difficult to help. You might have a look at image.plot() in the fields library, and image()
> I'm not sure if this is exactly what you're looking for, but here is a quick example of one way to control the image and legend in a plot, using the layout command. You can create a small panel below your main plot and then add your legend there with more control.
> I hope this is helpful.
> ############################################ example code for image plot of volcano datarequire(fields)require(raster)
> dat <- raster(volcano)
>
> zc <- as.matrix(seq(minValue(dat), maxValue(dat), length.out=100))
> mycolor1 <- two.colors(n=100, start="darkblue", end="red", middle="yellow1", alpha=.9)
> layout(matrix(c(1,2), 2, 1, byrow = TRUE), heights=c(4,1), widths=c(4) )layout.show(2)image(dat, axes=F, col=mycolor1, xlab="", ylab="")
> par(mar=c(2,4,.1,2))image(zc, col=mycolor1, axes=F, xlab="", ylab="" )
> axis(1, at=seq(0,1, length.out=5),  labels=round(seq(minValue(dat), maxValue(dat),length.out=5), digits=0), las=1,  tcl=-.15, padj=-1, cex=1.5) # every .1 corr# end code#############################################
>
>
> On Mon, Jan 26, 2015 at 10:36 AM, Ferra Xu via R-sig-Geo <r-sig-geo at r-project.org> wrote:
>
> I am still struggling with this question. I appreciate any help from you!
>
>
>      On Friday, January 23, 2015 11:00 AM, Ferra Xu <ferra.xu at yahoo.com> wrote:
>
>
>  Based on the dataset, I computed a 3D kernel (longitude, latitude, depth) and displayed the magnitude with the sphere radius and time with color as follows. I am wondering how I can show the color bar legend.
>
> Also I have problem with the scale of the graph. I need to see if the balls touch or overlap each other from the graph but since the scales are not real I cannot recognize it. How can I correct it?
>
> library(ks)
> x <- read.csv("HK1.csv")
> y <- x[,1:3]
> fhat1 <- kde(x=y)
> n <- nrow(x)
> col <- grey((n:1)/n)
> plot(fhat1, xlim=c(0,500), ylim=c(0,250), zlim=c(0, 4.4))
> spheres3d(y, radius=15*(x$magnitude), alpha=1, col= col)
>
> I tried this code (which didn't work):
>
> legend_image <- as.raster(matrix(grey((n:1)/n), ncol=1))
> plot(c(0,2),c(0,200),type = 'n', axes = F, xlab = '', ylab = '', main =  'time scale')
> text(x=1.5, y = seq(0,200,l=5), labels = seq(0,200,l=5))
> rasterImage(legend_image, 0, 0, 1, 1)
>
> And this one in "plotrix" package:
>
> testcol<- col
> col.labels<- seq(0,200, l=5)
> color.legend(600, 0, 601,200,col.labels,testcol,gradient="y")
>
> But it gives me this error:
>
> Error in rect(xleft, ybottoms, xright, ytops, col = col, lty = 0) :
> plot.new has not been called yet
>
> Also I used legend() in Graphics library:
>
> legend("right", legend=seq(0,200,l=20), fill= colfunc(20), title="Time Scale")
>
> But it gives me the legend in a separate window. Here is my data:
>
>  longitude         latitude        depth             time          magnitude
>
> 422.697323  164.19886   2.457419    8.083796636  0.83367586
> 423.008236  163.32434   0.5551326   37.58477455  0.893893903
> 204.733908  218.36365   1.9397874   37.88324312  0.912809449
> 203.963056  218.4808    0.3723791   43.21775903  0.926406005
> 100.727581  46.60876    1.4022341   49.41510519  0.782807523
> 453.335182  244.25521   1.6292517   51.73779175  0.903910803
> 134.909462  210.96333   2.2389119   53.13433521  0.896529401
> 135.300562  212.02055   0.6739541   67.55073745  0.748783521
> 258.237117  134.29735   2.1205291   76.34032587  0.735699304
> 341.305271  149.26953   3.718958    94.33975483  0.849509216
> 307.138925  59.60571    0.6311074   106.9636715  0.987923188
> 307.76875   58.91453    2.6496741   113.8515307  0.802115718
> 415.025535  217.17398   1.7155688   115.7464603  0.875580325
>
>
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From vanessamachault at yahoo.com.br  Tue Jan 27 10:55:50 2015
From: vanessamachault at yahoo.com.br (Vanessa Machault)
Date: Tue, 27 Jan 2015 09:55:50 +0000 (UTC)
Subject: [R-sig-Geo] Raster package - Focal sum in circles
In-Reply-To: <CANtt_hx5HB4QcAHQ10MUwm1KkfoSwWXTUMkvx6XP6xi-D0cAcg@mail.gmail.com>
References: <CANtt_hx5HB4QcAHQ10MUwm1KkfoSwWXTUMkvx6XP6xi-D0cAcg@mail.gmail.com>
Message-ID: <290637501.1142711.1422352550143.JavaMail.yahoo@mail.yahoo.com>

Thanks a lot Robert it works perfectly well.And the pixels that are NA are correctly omitted.

In addition, I just would like to know if it is possible to restrict the calculation to the pixels that are not NA (kind of masking ?).Indeed, the resulting raster contains all the pixels of the extend. 
But I have a lot of empty pixels on which focal stats do not need to be calculated.This of course is for questions of calculation time...

Thanks a lot in advance.RegardsVanessa.

 

     Le Lundi 26 janvier 2015 19h27, Robert J. Hijmans <r.hijmans at gmail.com> a ?crit :
   

 Your focal weights sum to 1, such that you get the mean value when
using 'fun=sum'
if you want to sum, you can do

fw <- focalWeight(x, 50, type='circle')
fw[fw>0] <- 1

p_focal<-focal(x, w=fw,fun=sum , na.rm=TRUE)


Robert

On Mon, Jan 26, 2015 at 3:17 AM, Vanessa Machault
<vanessamachault at yahoo.com.br> wrote:
> Hi,
> I have a question regarding the package "raster" and the function "focal".
> I have a raster with 0.5m pixels and I would like to calculate the sum of all pixels in 50m radius circles, with a moving window.I have some NA values and I need to ignore them in the calculation.
> Then, I would create a new raster where all the pixels that are not NA would be filled with the sum value.
> I tried with "focal" and "focal weight" but nothing comes close to the result.Example :fw <- focalWeight(x, 50, type='circle')
> p_focal<-focal(x, w=fw,fun=sum , na.rm=TRUE)
> I saw that several way of writing those focal stats may lead to different computation times. Here, as I need to repeat the process for a large number of rasters, computation time may be an issue.
> I thank you very much in advance for your help.Regards,Vanessa Machault
>
>? ? ? ? [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


   
	[[alternative HTML version deleted]]


From thairua at gmail.com  Tue Jan 27 14:50:24 2015
From: thairua at gmail.com (Amos Thairu)
Date: Tue, 27 Jan 2015 16:50:24 +0300
Subject: [R-sig-Geo] Error in reading shape file with readOGR()
Message-ID: <CAM3G_5aPEwk+E8nETa-iB=0xt0OsLOgqLWHSUcMfvp_OvnJWdw@mail.gmail.com>

I am trying to import a shapefile using readOGR below:
> dataProjected <- readOGR(dsn="~/datasets/mapping", layer="locations")

But I am facing the following error:
Error in ogrInfo(dsn = dsn, layer = layer, encoding = encoding, use_iconv =
use_iconv,  :
  Cannot open file

I have successfully loaded the same shapefile using readOGR in my windows
platform but cannot read that same file
using the same command in a linux platform. I guess the problem seems to be
related to having uploaded the
.shp and its associated files from a Windows machine onto the linux
platform.

The directory with the shape file is complete with the associated files as
shown below:
> list.files("~/datasets/mapping")
[1] "locations-c.dta"   "locations-d.dta"   "locations.dbf"
"locations.prj"     "locations.sbn"
[6] "locations.sbx"     "locations.shp"     "locations.shp.xml"
"locations.shx"

I get the following package startup message:
> library(rgdal)
Loading required package: sp
rgdal: version: 0.9-1, (SVN revision 518)
Geospatial Data Abstraction Library extensions to R successfully loaded
Loaded GDAL runtime: GDAL 1.7.3, released 2010/11/10
Path to GDAL shared files: /usr/share/gdal
GDAL does not use iconv for recoding strings.
Loaded PROJ.4 runtime: Rel. 4.7.1, 23 September 2009, [PJ_VERSION: 470]
Path to PROJ.4 shared files: (autodetected)

My session info is as follows:
> sessionInfo()
R version 3.1.2 (2014-10-31)
Platform: x86_64-redhat-linux-gnu (64-bit)

locale:
[1] C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] rgdal_0.9-1 sp_1.0-17

loaded via a namespace (and not attached):
[1] grid_3.1.2      lattice_0.20-29 tools_3.1.2

Does anyone know why this is happening? Any assistance would be greatly
appreciated.

-- 
Regards,
Amos Mbugua.

	[[alternative HTML version deleted]]


From frtog at vestas.com  Tue Jan 27 15:13:36 2015
From: frtog at vestas.com (=?iso-8859-1?Q?Frede_Aakmann_T=F8gersen?=)
Date: Tue, 27 Jan 2015 15:13:36 +0100
Subject: [R-sig-Geo] Error in reading shape file with readOGR()
In-Reply-To: <CAM3G_5aPEwk+E8nETa-iB=0xt0OsLOgqLWHSUcMfvp_OvnJWdw@mail.gmail.com>
References: <CAM3G_5aPEwk+E8nETa-iB=0xt0OsLOgqLWHSUcMfvp_OvnJWdw@mail.gmail.com>
Message-ID: <B078CDF40DFE4045AF172A8B4F68FC4857CB709CCB@DKRDSEXC016.vestas.net>

Hi Amos

Some time ago since I have used readOGR() but I vaguely remember that readOGR() does not expand the ~ as e.g. list.files does. You need to give the full expanded path like something like this:

"/home/my_username/datasets/mapping"

which of course depends on the system setup (I'm guessing you are on a unix-alike system based on the path to gdal installation). Cannot remember if a relative path works.


Yours sincerely / Med venlig hilsen


Frede Aakmann T?gersen
Specialist, M.Sc., Ph.D.
Plant Performance & Modeling

Technology & Service Solutions
T +45 9730 5135
M +45 2547 6050
frtog at vestas.com
http://www.vestas.com

Company reg. name: Vestas Wind Systems A/S
This e-mail is subject to our e-mail disclaimer statement.
Please refer to www.vestas.com/legal/notice
If you have received this e-mail in error please contact the sender. 


> -----Original Message-----
> From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of
> Amos Thairu
> Sent: 27. januar 2015 14:50
> To: r-sig-geo at r-project.org
> Subject: [R-sig-Geo] Error in reading shape file with readOGR()
> 
> I am trying to import a shapefile using readOGR below:
> > dataProjected <- readOGR(dsn="~/datasets/mapping", layer="locations")
> 
> But I am facing the following error:
> Error in ogrInfo(dsn = dsn, layer = layer, encoding = encoding, use_iconv =
> use_iconv,  :
>   Cannot open file
> 
> I have successfully loaded the same shapefile using readOGR in my windows
> platform but cannot read that same file
> using the same command in a linux platform. I guess the problem seems to
> be
> related to having uploaded the
> .shp and its associated files from a Windows machine onto the linux
> platform.
> 
> The directory with the shape file is complete with the associated files as
> shown below:
> > list.files("~/datasets/mapping")
> [1] "locations-c.dta"   "locations-d.dta"   "locations.dbf"
> "locations.prj"     "locations.sbn"
> [6] "locations.sbx"     "locations.shp"     "locations.shp.xml"
> "locations.shx"
> 
> I get the following package startup message:
> > library(rgdal)
> Loading required package: sp
> rgdal: version: 0.9-1, (SVN revision 518)
> Geospatial Data Abstraction Library extensions to R successfully loaded
> Loaded GDAL runtime: GDAL 1.7.3, released 2010/11/10
> Path to GDAL shared files: /usr/share/gdal
> GDAL does not use iconv for recoding strings.
> Loaded PROJ.4 runtime: Rel. 4.7.1, 23 September 2009, [PJ_VERSION: 470]
> Path to PROJ.4 shared files: (autodetected)
> 
> My session info is as follows:
> > sessionInfo()
> R version 3.1.2 (2014-10-31)
> Platform: x86_64-redhat-linux-gnu (64-bit)
> 
> locale:
> [1] C
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> 
> other attached packages:
> [1] rgdal_0.9-1 sp_1.0-17
> 
> loaded via a namespace (and not attached):
> [1] grid_3.1.2      lattice_0.20-29 tools_3.1.2
> 
> Does anyone know why this is happening? Any assistance would be greatly
> appreciated.
> 
> --
> Regards,
> Amos Mbugua.
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From thairua at gmail.com  Tue Jan 27 16:29:43 2015
From: thairua at gmail.com (Amos Thairu)
Date: Tue, 27 Jan 2015 18:29:43 +0300
Subject: [R-sig-Geo] Error in reading shape file with readOGR()
In-Reply-To: <B078CDF40DFE4045AF172A8B4F68FC4857CB709CCB@DKRDSEXC016.vestas.net>
References: <CAM3G_5aPEwk+E8nETa-iB=0xt0OsLOgqLWHSUcMfvp_OvnJWdw@mail.gmail.com>
	<B078CDF40DFE4045AF172A8B4F68FC4857CB709CCB@DKRDSEXC016.vestas.net>
Message-ID: <CAM3G_5YWO6hJZ0QXANM5u1pjer5EifKgpbQVDpg7aHtiFDxczQ@mail.gmail.com>

That works!
It seems that readOGR() does not expand the ~ and thus requires the full
expanded path.
Thanks!

On 27 January 2015 at 17:13, Frede Aakmann T?gersen <frtog at vestas.com>
wrote:

> Hi Amos
>
> Some time ago since I have used readOGR() but I vaguely remember that
> readOGR() does not expand the ~ as e.g. list.files does. You need to give
> the full expanded path like something like this:
>
> "/home/my_username/datasets/mapping"
>
> which of course depends on the system setup (I'm guessing you are on a
> unix-alike system based on the path to gdal installation). Cannot remember
> if a relative path works.
>
>
> Yours sincerely / Med venlig hilsen
>
>
> Frede Aakmann T?gersen
> Specialist, M.Sc., Ph.D.
> Plant Performance & Modeling
>
> Technology & Service Solutions
> T +45 9730 5135
> M +45 2547 6050
> frtog at vestas.com
> http://www.vestas.com
>
> Company reg. name: Vestas Wind Systems A/S
> This e-mail is subject to our e-mail disclaimer statement.
> Please refer to www.vestas.com/legal/notice
> If you have received this e-mail in error please contact the sender.
>
>
> > -----Original Message-----
> > From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of
> > Amos Thairu
> > Sent: 27. januar 2015 14:50
> > To: r-sig-geo at r-project.org
> > Subject: [R-sig-Geo] Error in reading shape file with readOGR()
> >
> > I am trying to import a shapefile using readOGR below:
> > > dataProjected <- readOGR(dsn="~/datasets/mapping", layer="locations")
> >
> > But I am facing the following error:
> > Error in ogrInfo(dsn = dsn, layer = layer, encoding = encoding,
> use_iconv =
> > use_iconv,  :
> >   Cannot open file
> >
> > I have successfully loaded the same shapefile using readOGR in my windows
> > platform but cannot read that same file
> > using the same command in a linux platform. I guess the problem seems to
> > be
> > related to having uploaded the
> > .shp and its associated files from a Windows machine onto the linux
> > platform.
> >
> > The directory with the shape file is complete with the associated files
> as
> > shown below:
> > > list.files("~/datasets/mapping")
> > [1] "locations-c.dta"   "locations-d.dta"   "locations.dbf"
> > "locations.prj"     "locations.sbn"
> > [6] "locations.sbx"     "locations.shp"     "locations.shp.xml"
> > "locations.shx"
> >
> > I get the following package startup message:
> > > library(rgdal)
> > Loading required package: sp
> > rgdal: version: 0.9-1, (SVN revision 518)
> > Geospatial Data Abstraction Library extensions to R successfully loaded
> > Loaded GDAL runtime: GDAL 1.7.3, released 2010/11/10
> > Path to GDAL shared files: /usr/share/gdal
> > GDAL does not use iconv for recoding strings.
> > Loaded PROJ.4 runtime: Rel. 4.7.1, 23 September 2009, [PJ_VERSION: 470]
> > Path to PROJ.4 shared files: (autodetected)
> >
> > My session info is as follows:
> > > sessionInfo()
> > R version 3.1.2 (2014-10-31)
> > Platform: x86_64-redhat-linux-gnu (64-bit)
> >
> > locale:
> > [1] C
> >
> > attached base packages:
> > [1] stats     graphics  grDevices utils     datasets  methods   base
> >
> > other attached packages:
> > [1] rgdal_0.9-1 sp_1.0-17
> >
> > loaded via a namespace (and not attached):
> > [1] grid_3.1.2      lattice_0.20-29 tools_3.1.2
> >
> > Does anyone know why this is happening? Any assistance would be greatly
> > appreciated.
> >
> > --
> > Regards,
> > Amos Mbugua.
> >
> >       [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Regards,
Amos Mbugua.

	[[alternative HTML version deleted]]


From ferra.xu at yahoo.com  Tue Jan 27 17:08:56 2015
From: ferra.xu at yahoo.com (Ferra Xu)
Date: Tue, 27 Jan 2015 16:08:56 +0000 (UTC)
Subject: [R-sig-Geo] How to show the color bar legend in R?
In-Reply-To: <CANtt_hx7oMuXsMo3KGnyYOucXp-D-DrCcOirD5pXeTwubMBFSA@mail.gmail.com>
References: <CANtt_hx7oMuXsMo3KGnyYOucXp-D-DrCcOirD5pXeTwubMBFSA@mail.gmail.com>
Message-ID: <222388731.762476.1422374936521.JavaMail.yahoo@mail.yahoo.com>

These are the information I got:
R version 3.1.2 (2014-10-31)Platform: x86_64-w64-mingw32/x64 (64-bit)
locale:[1] LC_COLLATE=English_United States.1252?[2] LC_CTYPE=English_United States.1252 ??[3] LC_MONETARY=English_United States.1252[4] LC_NUMERIC=C ? ? ? ? ? ? ? ? ? ? ? ? ?[5] LC_TIME=English_United States.1252 ? ?
attached base packages:[1] stats ? ? graphics ?grDevices utils ? ? datasets ?methods ? base ? ??
other attached packages:[1] plotrix_3.5-11 ? ? ks_1.9.3 ? ? ? ? ? rgl_0.95.1201 ? ? ?mvtnorm_1.0-2 ? ??[5] misc3d_0.8-4 ? ? ? KernSmooth_2.23-13
loaded via a namespace (and not attached):[1] tools_3.1.2
 

     On Monday, January 26, 2015 6:33 PM, Robert J. Hijmans <r.hijmans at gmail.com> wrote:
   

 > It seems there is a problem with my R !

It is for a good reason that you are requested to include your

sessionInfo()

information in messages to this list.? But even more important is to
first make sure that you are using the current version of R and the
current versions of all relevant packages.

Robert


On Mon, Jan 26, 2015 at 12:28 PM, Ferra Xu via R-sig-Geo
<r-sig-geo at r-project.org> wrote:
> Thank you for your email Zack. When I run the code that you provided, it gives me this error:
> Error in if (axes) { : argument is not interpretable as logicalIn addition: Warning message:In if (axes) { :? the condition has length > 1 and only the first element will be used
> It seems there is a problem with my R !
>
>? ? ? On Monday, January 26, 2015 11:02 AM, Zack Holden <zaholdenfs at gmail.com> wrote:
>
>
>? Hi Ferra,Without reproducible code, it's difficult to help. You might have a look at image.plot() in the fields library, and image()
> I'm not sure if this is exactly what you're looking for, but here is a quick example of one way to control the image and legend in a plot, using the layout command. You can create a small panel below your main plot and then add your legend there with more control.
> I hope this is helpful.
> ############################################ example code for image plot of volcano datarequire(fields)require(raster)
> dat <- raster(volcano)
>
> zc <- as.matrix(seq(minValue(dat), maxValue(dat), length.out=100))
> mycolor1 <- two.colors(n=100, start="darkblue", end="red", middle="yellow1", alpha=.9)
> layout(matrix(c(1,2), 2, 1, byrow = TRUE), heights=c(4,1), widths=c(4) )layout.show(2)image(dat, axes=F, col=mycolor1, xlab="", ylab="")
> par(mar=c(2,4,.1,2))image(zc, col=mycolor1, axes=F, xlab="", ylab="" )
> axis(1, at=seq(0,1, length.out=5),? labels=round(seq(minValue(dat), maxValue(dat),length.out=5), digits=0), las=1,? tcl=-.15, padj=-1, cex=1.5) # every .1 corr# end code#############################################
>
>
> On Mon, Jan 26, 2015 at 10:36 AM, Ferra Xu via R-sig-Geo <r-sig-geo at r-project.org> wrote:
>
> I am still struggling with this question. I appreciate any help from you!
>
>
>? ? ? On Friday, January 23, 2015 11:00 AM, Ferra Xu <ferra.xu at yahoo.com> wrote:
>
>
>? Based on the dataset, I computed a 3D kernel (longitude, latitude, depth) and displayed the magnitude with the sphere radius and time with color as follows. I am wondering how I can show the color bar legend.
>
> Also I have problem with the scale of the graph. I need to see if the balls touch or overlap each other from the graph but since the scales are not real I cannot recognize it. How can I correct it?
>
> library(ks)
> x <- read.csv("HK1.csv")
> y <- x[,1:3]
> fhat1 <- kde(x=y)
> n <- nrow(x)
> col <- grey((n:1)/n)
> plot(fhat1, xlim=c(0,500), ylim=c(0,250), zlim=c(0, 4.4))
> spheres3d(y, radius=15*(x$magnitude), alpha=1, col= col)
>
> I tried this code (which didn't work):
>
> legend_image <- as.raster(matrix(grey((n:1)/n), ncol=1))
> plot(c(0,2),c(0,200),type = 'n', axes = F, xlab = '', ylab = '', main =? 'time scale')
> text(x=1.5, y = seq(0,200,l=5), labels = seq(0,200,l=5))
> rasterImage(legend_image, 0, 0, 1, 1)
>
> And this one in "plotrix" package:
>
> testcol<- col
> col.labels<- seq(0,200, l=5)
> color.legend(600, 0, 601,200,col.labels,testcol,gradient="y")
>
> But it gives me this error:
>
> Error in rect(xleft, ybottoms, xright, ytops, col = col, lty = 0) :
> plot.new has not been called yet
>
> Also I used legend() in Graphics library:
>
> legend("right", legend=seq(0,200,l=20), fill= colfunc(20), title="Time Scale")
>
> But it gives me the legend in a separate window. Here is my data:
>
>? longitude? ? ? ? latitude? ? ? ? depth? ? ? ? ? ? time? ? ? ? ? magnitude
>
> 422.697323? 164.19886? 2.457419? ? 8.083796636? 0.83367586
> 423.008236? 163.32434? 0.5551326? 37.58477455? 0.893893903
> 204.733908? 218.36365? 1.9397874? 37.88324312? 0.912809449
> 203.963056? 218.4808? ? 0.3723791? 43.21775903? 0.926406005
> 100.727581? 46.60876? ? 1.4022341? 49.41510519? 0.782807523
> 453.335182? 244.25521? 1.6292517? 51.73779175? 0.903910803
> 134.909462? 210.96333? 2.2389119? 53.13433521? 0.896529401
> 135.300562? 212.02055? 0.6739541? 67.55073745? 0.748783521
> 258.237117? 134.29735? 2.1205291? 76.34032587? 0.735699304
> 341.305271? 149.26953? 3.718958? ? 94.33975483? 0.849509216
> 307.138925? 59.60571? ? 0.6311074? 106.9636715? 0.987923188
> 307.76875? 58.91453? ? 2.6496741? 113.8515307? 0.802115718
> 415.025535? 217.17398? 1.7155688? 115.7464603? 0.875580325
>
>
>
>
>? ? ? ? [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>
>
>
>? ? ? ? [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

   
	[[alternative HTML version deleted]]


From Frederic.Pons at cerema.fr  Tue Jan 27 17:39:48 2015
From: Frederic.Pons at cerema.fr (PONS Frederic - CEREMA/DTerMed/DREC/SRILH)
Date: Tue, 27 Jan 2015 17:39:48 +0100
Subject: [R-sig-Geo]  Advice on GRASS version for R
In-Reply-To: <222388731.762476.1422374936521.JavaMail.yahoo@mail.yahoo.com>
References: <CANtt_hx7oMuXsMo3KGnyYOucXp-D-DrCcOirD5pXeTwubMBFSA@mail.gmail.com>
	<222388731.762476.1422374936521.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <54C7BF54.7080506@cerema.fr>

Dear all

We are working to convert some toolbox in matlab grass in R grass with 
the scripts in the processing toolbox of qgis.
Some examples are available here:
http://wikhydro.developpement-durable.gouv.fr/index.php/Utilisation_des_donn%C3%A9es_LIDAR_pour_la_directive_inondation
http://wikhydro.developpement-durable.gouv.fr/index.php/D%C3%A9tection_de_remblai_avec_le_LIDAR

On windows 7, we develop on two version of grass  GRASS 7.0.0RC1 and 
GRASS GIS 7.1.svn

The parameters of the two version are not the same, for example
execGRASS("g.region",parameters=list(*rast*=nomoutput))
or
execGRASS("g.region",parameters=list(*raster*=nomoutput))

but there is a lot of other small changes.

Do you know what is the future standard of GRASS to script for the 
future version.

For Grass, more elements are available on
http://grass.osgeo.org/download/software/ms-windows/

Best regards

*Fr?d?ric Pons *
*Expert hydraulique sur les inondations et al?as c?tiers
**DREC/Service Risques Inondations Littoraux et Hydraulique **- T?l.: 
(33)4 42 24 76 68 *
*Direction Territoriale M?diterran?e
*
Centre d??tudes et d?expertise sur les risques, l?environnement, la 
mobilit? et l?am?nagement
www.cerema.fr <http://www.cerema.fr>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150127/a124e090/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: cerema.png
Type: image/png
Size: 6094 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150127/a124e090/attachment.png>

From senator at ecotoxicology.de  Tue Jan 27 18:07:57 2015
From: senator at ecotoxicology.de (=?utf-8?Q?Ralf_Sch=C3=A4fer?=)
Date: Tue, 27 Jan 2015 18:07:57 +0100
Subject: [R-sig-Geo] International Summer Academy on Spatial Ecotoxicology
	and Ecotoxicological Risk Assessment - Using an Open
	Community Approach
Message-ID: <D2ED9992-9A42-46B0-B577-B51962957561@ecotoxicology.de>

Dear colleagues, 

we will host the "International Summer Academy on Spatial Ecotoxicology and Ecotoxicological Risk Assessment - Using an Open Community Approach" from
September 7 to September 20, 2015

at University Koblenz-Landau, Campus Landau, Germany
http://www.summeracademy-landau.de <http://www.summeracademy-landau.de/>

Given that the Summer academy will use free open source software tools such as R and GRASS GIS, it may be of interest for somebody from this list.

The Summer Academy is funded by the DAAD (German Academic Exchange Service) with financial support by the Federal Foreign Office and offers free participation for participants from developing countries.

Objectives: Developing countries are particularly affected with high contamination, but often have inadequate control mechanisms and insufficient resources for risk assessment. Spatial analysis offers more and more applications and potential within ecological risk assessment. Our ?International Summer Academy on Spatial Ecotoxicology and Ecotoxicological Risk Assessment? gives an overview of ecotoxicological risk assessment with a focus on the use of freely available methods and resources for remote sensing and spatial analysis using GIS.  The course provides young scientists with inexpensive tools that are oriented for use in both developing and developed countries.
Topics: 
- Problem formulation
- Hazard assessment of chemical stressors
- Characterization of effects on One Health
- Pesticide pollution and vulnerability concepts
- Earth-to-space-based observing systems for environmental risk assessment and disaster management
- Use of Open Source spatial analysis tool
- Open community approach in One Health risk mapping
- Creation of global pesticide application maps
- Risk assessment and data availability in developing countries

Further details and registration are available on our website: 
http://www.summeracademy-landau.de <http://www.summeracademy-landau.de/>

Best regards, 
Rebecca Bundschuh and Jun.-Prof. Ralf Sch?fer
For the organizing committee



	[[alternative HTML version deleted]]


From rshepard at appl-ecosys.com  Tue Jan 27 18:21:58 2015
From: rshepard at appl-ecosys.com (Rich Shepard)
Date: Tue, 27 Jan 2015 09:21:58 -0800 (PST)
Subject: [R-sig-Geo] Advice on GRASS version for R
In-Reply-To: <54C7BF54.7080506@cerema.fr>
References: <CANtt_hx7oMuXsMo3KGnyYOucXp-D-DrCcOirD5pXeTwubMBFSA@mail.gmail.com>
	<222388731.762476.1422374936521.JavaMail.yahoo@mail.yahoo.com>
	<54C7BF54.7080506@cerema.fr>
Message-ID: <alpine.LNX.2.11.1501270919530.20436@localhost>

On Tue, 27 Jan 2015, PONS Frederic - CEREMA/DTerMed/DREC/SRILH wrote:

> Do you know what is the future standard of GRASS to script for the future 
> version.

   Ask on the GRASS mail list; you can sign up at http://grass.osgeo.org/.

If there are syntactic differences I would assume that those in the 7.1svn
are the future. I've used GRASS (on linux) since 4.0 and current use 7.1svn
so I've seen many differences over the past couple of decades.

Rich


From ftonini84 at gmail.com  Tue Jan 27 21:31:10 2015
From: ftonini84 at gmail.com (Francesco Tonini)
Date: Tue, 27 Jan 2015 15:31:10 -0500
Subject: [R-sig-Geo] Raster package - Focal sum in circles
In-Reply-To: <290637501.1142711.1422352550143.JavaMail.yahoo@mail.yahoo.com>
References: <CANtt_hx5HB4QcAHQ10MUwm1KkfoSwWXTUMkvx6XP6xi-D0cAcg@mail.gmail.com>
	<290637501.1142711.1422352550143.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <54C7F58E.5010906@gmail.com>

Vanessa,

You are asking something similar to the same problem I am facing. 
Currently focal() cannot "skip" the calculation for empty areas where 
focal stats does not need to be calculated. A workaround would be using 
getValuesFocal(x, ngb=ngb) and then you can skip those rows that have 
all NAs for example.

In my case getValuesFocal() did not speed up the code so I am not sure 
in your case.

Francesco




On 1/27/2015 4:55 AM, Vanessa Machault wrote:
> Thanks a lot Robert it works perfectly well.And the pixels that are NA are correctly omitted.
>
> In addition, I just would like to know if it is possible to restrict the calculation to the pixels that are not NA (kind of masking ?).Indeed, the resulting raster contains all the pixels of the extend.
> But I have a lot of empty pixels on which focal stats do not need to be calculated.This of course is for questions of calculation time...
>
> Thanks a lot in advance.RegardsVanessa.
>
>   
>
>       Le Lundi 26 janvier 2015 19h27, Robert J. Hijmans <r.hijmans at gmail.com> a ?crit :
>     
>
>   Your focal weights sum to 1, such that you get the mean value when
> using 'fun=sum'
> if you want to sum, you can do
>
> fw <- focalWeight(x, 50, type='circle')
> fw[fw>0] <- 1
>
> p_focal<-focal(x, w=fw,fun=sum , na.rm=TRUE)
>
>
> Robert
>
> On Mon, Jan 26, 2015 at 3:17 AM, Vanessa Machault
> <vanessamachault at yahoo.com.br> wrote:
>> Hi,
>> I have a question regarding the package "raster" and the function "focal".
>> I have a raster with 0.5m pixels and I would like to calculate the sum of all pixels in 50m radius circles, with a moving window.I have some NA values and I need to ignore them in the calculation.
>> Then, I would create a new raster where all the pixels that are not NA would be filled with the sum value.
>> I tried with "focal" and "focal weight" but nothing comes close to the result.Example :fw <- focalWeight(x, 50, type='circle')
>> p_focal<-focal(x, w=fw,fun=sum , na.rm=TRUE)
>> I saw that several way of writing those focal stats may lead to different computation times. Here, as I need to repeat the process for a large number of rasters, computation time may be an issue.
>> I thank you very much in advance for your help.Regards,Vanessa Machault
>>
>>          [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>     
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Roger.Bivand at nhh.no  Tue Jan 27 21:48:53 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 27 Jan 2015 21:48:53 +0100
Subject: [R-sig-Geo] Advice on GRASS version for R
In-Reply-To: <alpine.LNX.2.11.1501270919530.20436@localhost>
References: <CANtt_hx7oMuXsMo3KGnyYOucXp-D-DrCcOirD5pXeTwubMBFSA@mail.gmail.com>
	<222388731.762476.1422374936521.JavaMail.yahoo@mail.yahoo.com>
	<54C7BF54.7080506@cerema.fr>
	<alpine.LNX.2.11.1501270919530.20436@localhost>
Message-ID: <alpine.LFD.2.11.1501272134570.7590@reclus.nhh.no>

On Tue, 27 Jan 2015, Rich Shepard wrote:

> On Tue, 27 Jan 2015, PONS Frederic - CEREMA/DTerMed/DREC/SRILH wrote:
>
>>  Do you know what is the future standard of GRASS to script for the future
>>  version.

There is ongoing discussion on the grass-stats list:

http://lists.osgeo.org/mailman/listinfo/grass-stats

The GRASS 7.0 RC1 is where many parameter names have been changed. The 
changes are quite large, so the current R spgrass6 package will only 
handle GRASS 6 up to GRASS 7.0 beta, while the new spgrass7 (in the 
spgrass project on R-Forge) is being matched to changes in GRASS 7.0 RC*.
See:

install.packages("spgrass7", repos="http://R-Forge.R-project.org")

This is thanks to input and work by Rainer Krug and Markus Neteler. RC2 
should be out soon too. spgrass6 will shift to maintenance mode only 
shortly after GRASS 7.0 is released, but will stay available.

The parameter name changes are on:

http://trac.osgeo.org/grass/wiki/Grass7/NewFeatures#Optionschanges

We have not checked against GRASS trunk. I think that your adaptation 
might match the regular 7.* series rather than the development trunk, but 
I agree with Rich that it would be worth asking on the GRASS users or 
developers list.

Roger

>
>  Ask on the GRASS mail list; you can sign up at http://grass.osgeo.org/.
>
> If there are syntactic differences I would assume that those in the 7.1svn
> are the future. I've used GRASS (on linux) since 4.0 and current use 7.1svn
> so I've seen many differences over the past couple of decades.
>
> Rich
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Tue Jan 27 21:57:33 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 27 Jan 2015 21:57:33 +0100
Subject: [R-sig-Geo] Error in reading shape file with readOGR()
In-Reply-To: <CAM3G_5YWO6hJZ0QXANM5u1pjer5EifKgpbQVDpg7aHtiFDxczQ@mail.gmail.com>
References: <CAM3G_5aPEwk+E8nETa-iB=0xt0OsLOgqLWHSUcMfvp_OvnJWdw@mail.gmail.com>
	<B078CDF40DFE4045AF172A8B4F68FC4857CB709CCB@DKRDSEXC016.vestas.net>
	<CAM3G_5YWO6hJZ0QXANM5u1pjer5EifKgpbQVDpg7aHtiFDxczQ@mail.gmail.com>
Message-ID: <alpine.LFD.2.11.1501272149220.7590@reclus.nhh.no>

On Tue, 27 Jan 2015, Amos Thairu wrote:

> That works!
> It seems that readOGR() does not expand the ~ and thus requires the full
> expanded path.

The reason for not expanding is that the dsn= argument takes very 
different string values depending on the driver, but as the driver is 
discovered in OGR itself, we can't say that we know that it is going to be 
a file or directory, for example for PostGIS or WFS.

Hope this clarifies,

Roger

> Thanks!
>
> On 27 January 2015 at 17:13, Frede Aakmann T?gersen <frtog at vestas.com>
> wrote:
>
>> Hi Amos
>>
>> Some time ago since I have used readOGR() but I vaguely remember that
>> readOGR() does not expand the ~ as e.g. list.files does. You need to give
>> the full expanded path like something like this:
>>
>> "/home/my_username/datasets/mapping"
>>
>> which of course depends on the system setup (I'm guessing you are on a
>> unix-alike system based on the path to gdal installation). Cannot remember
>> if a relative path works.
>>
>>
>> Yours sincerely / Med venlig hilsen
>>
>>
>> Frede Aakmann T?gersen
>> Specialist, M.Sc., Ph.D.
>> Plant Performance & Modeling
>>
>> Technology & Service Solutions
>> T +45 9730 5135
>> M +45 2547 6050
>> frtog at vestas.com
>> http://www.vestas.com
>>
>> Company reg. name: Vestas Wind Systems A/S
>> This e-mail is subject to our e-mail disclaimer statement.
>> Please refer to www.vestas.com/legal/notice
>> If you have received this e-mail in error please contact the sender.
>>
>>
>> > -----Original Message-----
>> > From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of
>> > Amos Thairu
>> > Sent: 27. januar 2015 14:50
>> > To: r-sig-geo at r-project.org
>> > Subject: [R-sig-Geo] Error in reading shape file with readOGR()
>> >
>> > I am trying to import a shapefile using readOGR below:
>> > > dataProjected <- readOGR(dsn="~/datasets/mapping", layer="locations")
>> >
>> > But I am facing the following error:
>> > Error in ogrInfo(dsn = dsn, layer = layer, encoding = encoding,
>> use_iconv =
>> > use_iconv,  :
>> >   Cannot open file
>> >
>> > I have successfully loaded the same shapefile using readOGR in my windows
>> > platform but cannot read that same file
>> > using the same command in a linux platform. I guess the problem seems to
>> > be
>> > related to having uploaded the
>> > .shp and its associated files from a Windows machine onto the linux
>> > platform.
>> >
>> > The directory with the shape file is complete with the associated files
>> as
>> > shown below:
>> > > list.files("~/datasets/mapping")
>> > [1] "locations-c.dta"   "locations-d.dta"   "locations.dbf"
>> > "locations.prj"     "locations.sbn"
>> > [6] "locations.sbx"     "locations.shp"     "locations.shp.xml"
>> > "locations.shx"
>> >
>> > I get the following package startup message:
>> > > library(rgdal)
>> > Loading required package: sp
>> > rgdal: version: 0.9-1, (SVN revision 518)
>> > Geospatial Data Abstraction Library extensions to R successfully loaded
>> > Loaded GDAL runtime: GDAL 1.7.3, released 2010/11/10
>> > Path to GDAL shared files: /usr/share/gdal
>> > GDAL does not use iconv for recoding strings.
>> > Loaded PROJ.4 runtime: Rel. 4.7.1, 23 September 2009, [PJ_VERSION: 470]
>> > Path to PROJ.4 shared files: (autodetected)
>> >
>> > My session info is as follows:
>> > > sessionInfo()
>> > R version 3.1.2 (2014-10-31)
>> > Platform: x86_64-redhat-linux-gnu (64-bit)
>> >
>> > locale:
>> > [1] C
>> >
>> > attached base packages:
>> > [1] stats     graphics  grDevices utils     datasets  methods   base
>> >
>> > other attached packages:
>> > [1] rgdal_0.9-1 sp_1.0-17
>> >
>> > loaded via a namespace (and not attached):
>> > [1] grid_3.1.2      lattice_0.20-29 tools_3.1.2
>> >
>> > Does anyone know why this is happening? Any assistance would be greatly
>> > appreciated.
>> >
>> > --
>> > Regards,
>> > Amos Mbugua.
>> >
>> >       [[alternative HTML version deleted]]
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at r-project.org
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
>
> -- 
> Regards,
> Amos Mbugua.
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no

From Frederic.Pons at cerema.fr  Wed Jan 28 08:53:29 2015
From: Frederic.Pons at cerema.fr (PONS Frederic - CEREMA/DTerMed/DREC/SRILH)
Date: Wed, 28 Jan 2015 08:53:29 +0100
Subject: [R-sig-Geo] Advice on GRASS version for R
In-Reply-To: <alpine.LFD.2.11.1501272134570.7590@reclus.nhh.no>
References: <CANtt_hx7oMuXsMo3KGnyYOucXp-D-DrCcOirD5pXeTwubMBFSA@mail.gmail.com>
	<222388731.762476.1422374936521.JavaMail.yahoo@mail.yahoo.com>
	<54C7BF54.7080506@cerema.fr>
	<alpine.LNX.2.11.1501270919530.20436@localhost>
	<alpine.LFD.2.11.1501272134570.7590@reclus.nhh.no>
Message-ID: <54C89579.3000507@cerema.fr>

Thank you for your advice, I send an e-mail to a french grass list.

The best solution seems for me to work with future version

But I cannot install spgrass 7 or spgrass on windows 7 in R version 3.1.2 :

 > install.packages("spgrass7", repos="http://R-Forge.R-project.org")
Avis : impossible d'acc?der ? l'index de l'entrep?t 
http://R-Forge.R-project.org/bin/windows/contrib/3.1
Message d'avis :
package 'spgrass7' is not available (for R version 3.1.2)
 > RSiteSearch("spgrass7")
Une requ?te de recherche a ?t? soumise ? http://search.r-project.org
La page de r?sultats devrait s'ouvrir dans votre navigateur
 > install.packages("spgrass", repos="http://R-Forge.R-project.org")
Avis : impossible d'acc?der ? l'index de l'entrep?t 
http://R-Forge.R-project.org/bin/windows/contrib/3.1
Message d'avis :
package 'spgrass' is not available (for R version 3.1.2)

How to do it?
Thank you
Fr?d?ric

Le 27/01/2015 21:48, "> Roger Bivand (par Internet, d?p?t 
r-sig-geo-bounces at r-project.org)" a ?crit :
> On Tue, 27 Jan 2015, Rich Shepard wrote:
>
>> On Tue, 27 Jan 2015, PONS Frederic - CEREMA/DTerMed/DREC/SRILH wrote:
>>
>>>  Do you know what is the future standard of GRASS to script for the 
>>> future
>>>  version.
>
> There is ongoing discussion on the grass-stats list:
>
> http://lists.osgeo.org/mailman/listinfo/grass-stats
>
> The GRASS 7.0 RC1 is where many parameter names have been changed. The 
> changes are quite large, so the current R spgrass6 package will only 
> handle GRASS 6 up to GRASS 7.0 beta, while the new spgrass7 (in the 
> spgrass project on R-Forge) is being matched to changes in GRASS 7.0 RC*.
> See:
>
> install.packages("spgrass7", repos="http://R-Forge.R-project.org")
>
> This is thanks to input and work by Rainer Krug and Markus Neteler. 
> RC2 should be out soon too. spgrass6 will shift to maintenance mode 
> only shortly after GRASS 7.0 is released, but will stay available.
>
> The parameter name changes are on:
>
> http://trac.osgeo.org/grass/wiki/Grass7/NewFeatures#Optionschanges
>
> We have not checked against GRASS trunk. I think that your adaptation 
> might match the regular 7.* series rather than the development trunk, 
> but I agree with Rich that it would be worth asking on the GRASS users 
> or developers list.
>
> Roger
>
>>
>>  Ask on the GRASS mail list; you can sign up at http://grass.osgeo.org/.
>>
>> If there are syntactic differences I would assume that those in the 
>> 7.1svn
>> are the future. I've used GRASS (on linux) since 4.0 and current use 
>> 7.1svn
>> so I've seen many differences over the past couple of decades.
>>
>> Rich
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>


	[[alternative HTML version deleted]]


From Roger.Bivand at nhh.no  Wed Jan 28 09:15:19 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 28 Jan 2015 09:15:19 +0100
Subject: [R-sig-Geo] Advice on GRASS version for R
In-Reply-To: <54C89579.3000507@cerema.fr>
References: <CANtt_hx7oMuXsMo3KGnyYOucXp-D-DrCcOirD5pXeTwubMBFSA@mail.gmail.com>
	<222388731.762476.1422374936521.JavaMail.yahoo@mail.yahoo.com>
	<54C7BF54.7080506@cerema.fr>
	<alpine.LNX.2.11.1501270919530.20436@localhost>
	<alpine.LFD.2.11.1501272134570.7590@reclus.nhh.no>
	<54C89579.3000507@cerema.fr>
Message-ID: <alpine.LFD.2.11.1501280911300.22697@reclus.nhh.no>

On Wed, 28 Jan 2015, PONS Frederic - CEREMA/DTerMed/DREC/SRILH wrote:

> Thank you for your advice, I send an e-mail to a french grass list.

That is no use. Use grass-stats if you need help with the R-GRASS 
interface, the developers do not read other channels regularly.

>
> The best solution seems for me to work with future version
>

Work with forthcoming (soon to be stable) GRASS 7, not with the 
development version.

> But I cannot install spgrass 7 or spgrass on windows 7 in R version 3.1.2 :

So download:

http://download.r-forge.r-project.org/bin/windows/contrib/latest/spgrass7_0.1-0.zip

and install from local zip file (untried). None of the developers uses 
Windows, so this isn't a priority. Alternatively, install R-tools foe 
Windows and then install the source package.

Roger

>
>>  install.packages("spgrass7", repos="http://R-Forge.R-project.org")
> Avis : impossible d'acc?der ? l'index de l'entrep?t 
> http://R-Forge.R-project.org/bin/windows/contrib/3.1
> Message d'avis :
> package 'spgrass7' is not available (for R version 3.1.2)
>>  RSiteSearch("spgrass7")
> Une requ?te de recherche a ?t? soumise ? http://search.r-project.org
> La page de r?sultats devrait s'ouvrir dans votre navigateur
>>  install.packages("spgrass", repos="http://R-Forge.R-project.org")
> Avis : impossible d'acc?der ? l'index de l'entrep?t 
> http://R-Forge.R-project.org/bin/windows/contrib/3.1
> Message d'avis :
> package 'spgrass' is not available (for R version 3.1.2)
>
> How to do it?
> Thank you
> Fr?d?ric
>
> Le 27/01/2015 21:48, "> Roger Bivand (par Internet, d?p?t 
> r-sig-geo-bounces at r-project.org)" a ?crit :
>>  On Tue, 27 Jan 2015, Rich Shepard wrote:
>> 
>> >  On Tue, 27 Jan 2015, PONS Frederic - CEREMA/DTerMed/DREC/SRILH wrote:
>> > 
>> > >  Do you know what is the future standard of GRASS to script for the 
>> > >  future
>> > >   version.
>>
>>  There is ongoing discussion on the grass-stats list:
>>
>>  http://lists.osgeo.org/mailman/listinfo/grass-stats
>>
>>  The GRASS 7.0 RC1 is where many parameter names have been changed. The
>>  changes are quite large, so the current R spgrass6 package will only
>>  handle GRASS 6 up to GRASS 7.0 beta, while the new spgrass7 (in the
>>  spgrass project on R-Forge) is being matched to changes in GRASS 7.0 RC*.
>>  See:
>>
>>  install.packages("spgrass7", repos="http://R-Forge.R-project.org")
>>
>>  This is thanks to input and work by Rainer Krug and Markus Neteler. RC2
>>  should be out soon too. spgrass6 will shift to maintenance mode only
>>  shortly after GRASS 7.0 is released, but will stay available.
>>
>>  The parameter name changes are on:
>>
>>  http://trac.osgeo.org/grass/wiki/Grass7/NewFeatures#Optionschanges
>>
>>  We have not checked against GRASS trunk. I think that your adaptation
>>  might match the regular 7.* series rather than the development trunk, but
>>  I agree with Rich that it would be worth asking on the GRASS users or
>>  developers list.
>>
>>  Roger
>> 
>> > 
>> >   Ask on the GRASS mail list; you can sign up at http://grass.osgeo.org/.
>> > 
>> >  If there are syntactic differences I would assume that those in the 
>> >  7.1svn
>> >  are the future. I've used GRASS (on linux) since 4.0 and current use 
>> >  7.1svn
>> >  so I've seen many differences over the past couple of decades.
>> > 
>> >  Rich
>> > 
>> >  _______________________________________________
>> >  R-sig-Geo mailing list
>> >  R-sig-Geo at r-project.org
>> >  https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> > 
>> 
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no

From Rainer at krugs.de  Wed Jan 28 10:02:42 2015
From: Rainer at krugs.de (Rainer M Krug)
Date: Wed, 28 Jan 2015 10:02:42 +0100
Subject: [R-sig-Geo] Advice on GRASS version for R
In-Reply-To: <alpine.LFD.2.11.1501280911300.22697@reclus.nhh.no> (Roger
	Bivand's message of "Wed, 28 Jan 2015 09:15:19 +0100")
References: <CANtt_hx7oMuXsMo3KGnyYOucXp-D-DrCcOirD5pXeTwubMBFSA@mail.gmail.com>
	<222388731.762476.1422374936521.JavaMail.yahoo@mail.yahoo.com>
	<54C7BF54.7080506@cerema.fr>
	<alpine.LNX.2.11.1501270919530.20436@localhost>
	<alpine.LFD.2.11.1501272134570.7590@reclus.nhh.no>
	<54C89579.3000507@cerema.fr>
	<alpine.LFD.2.11.1501280911300.22697@reclus.nhh.no>
Message-ID: <m2siev5lcd.fsf@krugs.de>

Roger Bivand <Roger.Bivand at nhh.no> writes:

> On Wed, 28 Jan 2015, PONS Frederic - CEREMA/DTerMed/DREC/SRILH wrote:
>
>> Thank you for your advice, I send an e-mail to a french grass list.
>
> That is no use. Use grass-stats if you need help with the R-GRASS
> interface, the developers do not read other channels regularly.
>
>>
>> The best solution seems for me to work with future version
>>
>
> Work with forthcoming (soon to be stable) GRASS 7, not with the
> development version.
>
>> But I cannot install spgrass 7 or spgrass on windows 7 in R version 3.1.2 :
>
> So download:
>
> http://download.r-forge.r-project.org/bin/windows/contrib/latest/spgrass7_0.1-0.zip
>
> and install from local zip file (untried). None of the developers uses
> Windows, so this isn't a priority. Alternatively, install R-tools foe
> Windows and then install the source package.

I am in the process of setting up a virtual machine (Windows 7, R,
GRASS) to test it out (If I manage to deal with windows ...).

Cheers,

Rainer

>
> Roger
>
>>
>>>  install.packages("spgrass7", repos="http://R-Forge.R-project.org")
>> Avis : impossible d'acc?der ? l'index de l'entrep?t
>> http://R-Forge.R-project.org/bin/windows/contrib/3.1
>> Message d'avis :
>> package 'spgrass7' is not available (for R version 3.1.2)
>>>  RSiteSearch("spgrass7")
>> Une requ?te de recherche a ?t? soumise ? http://search.r-project.org
>> La page de r?sultats devrait s'ouvrir dans votre navigateur
>>>  install.packages("spgrass", repos="http://R-Forge.R-project.org")
>> Avis : impossible d'acc?der ? l'index de l'entrep?t
>> http://R-Forge.R-project.org/bin/windows/contrib/3.1
>> Message d'avis :
>> package 'spgrass' is not available (for R version 3.1.2)
>>
>> How to do it?
>> Thank you
>> Fr?d?ric
>>
>> Le 27/01/2015 21:48, "> Roger Bivand (par Internet, d?p?t
>> r-sig-geo-bounces at r-project.org)" a ?crit :
>>>  On Tue, 27 Jan 2015, Rich Shepard wrote:
>>>
>>> >  On Tue, 27 Jan 2015, PONS Frederic - CEREMA/DTerMed/DREC/SRILH wrote:
>>> > > >  Do you know what is the future standard of GRASS to script
>>> for the > >  future
>>> > >   version.
>>>
>>>  There is ongoing discussion on the grass-stats list:
>>>
>>>  http://lists.osgeo.org/mailman/listinfo/grass-stats
>>>
>>>  The GRASS 7.0 RC1 is where many parameter names have been changed. The
>>>  changes are quite large, so the current R spgrass6 package will only
>>>  handle GRASS 6 up to GRASS 7.0 beta, while the new spgrass7 (in the
>>>  spgrass project on R-Forge) is being matched to changes in GRASS 7.0 RC*.
>>>  See:
>>>
>>>  install.packages("spgrass7", repos="http://R-Forge.R-project.org")
>>>
>>>  This is thanks to input and work by Rainer Krug and Markus Neteler. RC2
>>>  should be out soon too. spgrass6 will shift to maintenance mode only
>>>  shortly after GRASS 7.0 is released, but will stay available.
>>>
>>>  The parameter name changes are on:
>>>
>>>  http://trac.osgeo.org/grass/wiki/Grass7/NewFeatures#Optionschanges
>>>
>>>  We have not checked against GRASS trunk. I think that your adaptation
>>>  might match the regular 7.* series rather than the development trunk, but
>>>  I agree with Rich that it would be worth asking on the GRASS users or
>>>  developers list.
>>>
>>>  Roger
>>>
>>> > >   Ask on the GRASS mail list; you can sign up at
>>> http://grass.osgeo.org/.
>>> > >  If there are syntactic differences I would assume that those
>>> in the >  7.1svn
>>> >  are the future. I've used GRASS (on linux) since 4.0 and current
>>> use >  7.1svn
>>> >  so I've seen many differences over the past couple of decades.
>>> > >  Rich
>>> > >  _______________________________________________
>>> >  R-sig-Geo mailing list
>>> >  R-sig-Geo at r-project.org
>>> >  https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> > 
>>>
>>
>>

-- 
Rainer M. Krug
email: Rainer<at>krugs<dot>de
PGP: 0x0F52F982
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 494 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150128/9442f6b6/attachment.bin>

From vanessamachault at yahoo.com.br  Wed Jan 28 12:23:40 2015
From: vanessamachault at yahoo.com.br (Vanessa Machault)
Date: Wed, 28 Jan 2015 11:23:40 +0000 (UTC)
Subject: [R-sig-Geo] Raster package - Focal sum in circles
In-Reply-To: <54C7F58E.5010906@gmail.com>
References: <54C7F58E.5010906@gmail.com>
Message-ID: <1250163572.1844085.1422444220899.JavaMail.yahoo@mail.yahoo.com>

Hi Francesco and thank you very much for this input.
In consequence, we will have to deal with a long the calculation time...I also try to work with vectors and the function "extract" but it is even longer.
RegardsVanessa.
 

     Le Mardi 27 janvier 2015 21h32, Francesco Tonini <ftonini84 at gmail.com> a ?crit :
   

 Vanessa,

You are asking something similar to the same problem I am facing. 
Currently focal() cannot "skip" the calculation for empty areas where 
focal stats does not need to be calculated. A workaround would be using 
getValuesFocal(x, ngb=ngb) and then you can skip those rows that have 
all NAs for example.

In my case getValuesFocal() did not speed up the code so I am not sure 
in your case.

Francesco




On 1/27/2015 4:55 AM, Vanessa Machault wrote:
> Thanks a lot Robert it works perfectly well.And the pixels that are NA are correctly omitted.
>
> In addition, I just would like to know if it is possible to restrict the calculation to the pixels that are not NA (kind of masking ?).Indeed, the resulting raster contains all the pixels of the extend.
> But I have a lot of empty pixels on which focal stats do not need to be calculated.This of course is for questions of calculation time...
>
> Thanks a lot in advance.RegardsVanessa.
>
>? 
>
>? ? ? Le Lundi 26 janvier 2015 19h27, Robert J. Hijmans <r.hijmans at gmail.com> a ?crit :
>? ? 
>
>? Your focal weights sum to 1, such that you get the mean value when
> using 'fun=sum'
> if you want to sum, you can do
>
> fw <- focalWeight(x, 50, type='circle')
> fw[fw>0] <- 1
>
> p_focal<-focal(x, w=fw,fun=sum , na.rm=TRUE)
>
>
> Robert
>
> On Mon, Jan 26, 2015 at 3:17 AM, Vanessa Machault
> <vanessamachault at yahoo.com.br> wrote:
>> Hi,
>> I have a question regarding the package "raster" and the function "focal".
>> I have a raster with 0.5m pixels and I would like to calculate the sum of all pixels in 50m radius circles, with a moving window.I have some NA values and I need to ignore them in the calculation.
>> Then, I would create a new raster where all the pixels that are not NA would be filled with the sum value.
>> I tried with "focal" and "focal weight" but nothing comes close to the result.Example :fw <- focalWeight(x, 50, type='circle')
>> p_focal<-focal(x, w=fw,fun=sum , na.rm=TRUE)
>> I saw that several way of writing those focal stats may lead to different computation times. Here, as I need to repeat the process for a large number of rasters, computation time may be an issue.
>> I thank you very much in advance for your help.Regards,Vanessa Machault
>>
>>? ? ? ? ? [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>? ? 
> ??? [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


   
	[[alternative HTML version deleted]]


From carolina.lang at ifop.cl  Wed Jan 28 14:38:44 2015
From: carolina.lang at ifop.cl (carolina.lang at ifop.cl)
Date: Wed, 28 Jan 2015 10:38:44 -0300 (CLST)
Subject: [R-sig-Geo] query about geoR package
In-Reply-To: <644224814.5808784.1422451944395.JavaMail.zimbra@ifop.cl>
Message-ID: <2119745079.5810180.1422452324817.JavaMail.zimbra@ifop.cl>

Hello everybody!! 
I just have a question and i hope anyone can help me, if I have a dicotomic variable, presence/absence of some resource: for example distribution of fishes. Can I analyse with geostatistical method this variable in geoR, more specific is has been defined the binomial distribution in this package and allow me to model this kind of data??? 
Cheers, Carolina 



------------------------------------------------------------------------------------------------
Certificaci?n ISO 9001/2008: Sistema de Datos Bio-Pesqueros ( Arica, Iquique, Coquimbo, Valpara?so, San Antonio, Talcahuano y Calbuco, pesquer?as industriales y artesanales)


     


	[[alternative HTML version deleted]]


From carolina.lang at ifop.cl  Wed Jan 28 14:40:07 2015
From: carolina.lang at ifop.cl (carolina.lang at ifop.cl)
Date: Wed, 28 Jan 2015 10:40:07 -0300 (CLST)
Subject: [R-sig-Geo] query on geoR
In-Reply-To: <D2ED9992-9A42-46B0-B577-B51962957561@ecotoxicology.de>
References: <D2ED9992-9A42-46B0-B577-B51962957561@ecotoxicology.de>
Message-ID: <1155521770.5810343.1422452407476.JavaMail.zimbra@ifop.cl>

Hello everybody!!
I just have a question and i hope anyone can help me, if I have a dicotomic variable, presence/absence of some resource: for example distribution of fishes. Can I analyse with geostatistical method this variable in geoR, more specific is has been defined the binomial distribution in this package and allow me to model this kind of data???

Cheers, Carolina

	


------------------------------------------------------------------------------------------------
Certificaci?n ISO 9001/2008: Sistema de Datos Bio-Pesqueros ( Arica, Iquique, Coquimbo, Valpara?so, San Antonio, Talcahuano y Calbuco, pesquer?as industriales y artesanales)


From dicko.ahmadou at gmail.com  Wed Jan 28 16:31:47 2015
From: dicko.ahmadou at gmail.com (Ahmadou Dicko)
Date: Wed, 28 Jan 2015 15:31:47 +0000
Subject: [R-sig-Geo] query on geoR
In-Reply-To: <1155521770.5810343.1422452407476.JavaMail.zimbra@ifop.cl>
References: <D2ED9992-9A42-46B0-B577-B51962957561@ecotoxicology.de>
	<1155521770.5810343.1422452407476.JavaMail.zimbra@ifop.cl>
Message-ID: <CAP8THHUSi9N35WKqixvFzfzr=bR1Ray7S2zf9PmwGuyg8X5yxQ@mail.gmail.com>

You can have a look at the geoRglm package.
The vignette is a good starting point:
http://cran.r-project.org/web/packages/geoRglm/vignettes/geoRglmintro.pdf

Cheers,


On Wed, Jan 28, 2015 at 1:40 PM, <carolina.lang at ifop.cl> wrote:

> Hello everybody!!
> I just have a question and i hope anyone can help me, if I have a
> dicotomic variable, presence/absence of some resource: for example
> distribution of fishes. Can I analyse with geostatistical method this
> variable in geoR, more specific is has been defined the binomial
> distribution in this package and allow me to model this kind of data???
>
> Cheers, Carolina
>
>
>
>
>
> ------------------------------------------------------------------------------------------------
> Certificaci?n ISO 9001/2008: Sistema de Datos Bio-Pesqueros ( Arica,
> Iquique, Coquimbo, Valpara?so, San Antonio, Talcahuano y Calbuco,
> pesquer?as industriales y artesanales)
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


-- 
Ahmadou H. DICKO
statistician economist (Ing?nieur Statisticien ?conomiste)
PhD candidate in Climate change economics
Faculty of economics and managment - Cheikh Anta Diop University
West African Science Service Center on Climate Change and Adaptated Land
Use (WASCAL)
Center for Development Research (ZEF) - University of Bonn
email : ahmadou.dicko at ucad.edu.sn
twitter : @dickoah
github : github/dickoa <https://github.com/dickoa>
tel : +221 33 827 55 16
portable: +221 77 123 81 69

	[[alternative HTML version deleted]]


From ftonini84 at gmail.com  Wed Jan 28 16:37:30 2015
From: ftonini84 at gmail.com (Francesco Tonini)
Date: Wed, 28 Jan 2015 10:37:30 -0500
Subject: [R-sig-Geo] R focal weights from probability density function
In-Reply-To: <CAP8THHUSi9N35WKqixvFzfzr=bR1Ray7S2zf9PmwGuyg8X5yxQ@mail.gmail.com>
References: <D2ED9992-9A42-46B0-B577-B51962957561@ecotoxicology.de>	<1155521770.5810343.1422452407476.JavaMail.zimbra@ifop.cl>
	<CAP8THHUSi9N35WKqixvFzfzr=bR1Ray7S2zf9PmwGuyg8X5yxQ@mail.gmail.com>
Message-ID: <54C9023A.3040704@gmail.com>

Hi everybody,

I am trying to build a spatial grid ("window") containing the weights 
from a pre-defined prob. density function. Currently there is a raster 
package function called|focalWeight()|but the only options are 'circle', 
'Gauss' or 'rectangle'. I would like to create one using, for example, 
the Cauchy distribution. Any suggestions on how to do that?

Thank you,
Francesco

	[[alternative HTML version deleted]]


From ferra.xu at yahoo.com  Wed Jan 28 21:11:15 2015
From: ferra.xu at yahoo.com (Ferra Xu)
Date: Wed, 28 Jan 2015 20:11:15 +0000 (UTC)
Subject: [R-sig-Geo] How to correct the scale of the plot and also location
 of the legend bar in R
Message-ID: <809762057.1233838.1422475875877.JavaMail.yahoo@mail.yahoo.com>

I computed a 3D kernel (longitude, latitude, depth) and displayed the magnitude with the sphere radius and time with color as follows. I have two problems. First one is that it creates the legend in a separate window and the second one is that I have problem with the scale of the graph. I need to see if the balls touch or overlap each other from the graph but since the scales are not correct I cannot recognize it.?
library(ks)
library(rgl)
library (graphics)
library(grDevices)
library(plotrix)


zz <- "longitude   latitude    depth       time          magnitude

422.697323  164.19886   2.457419    8.083796636  0.83367586
423.008236  163.32434   0.5551326   37.58477455  0.893893903
204.733908  218.36365   1.9397874   37.88324312  0.912809449
203.963056  218.4808    0.3723791   43.21775903  0.926406005
100.727581  46.60876    1.4022341   49.41510519  0.782807523
453.335182  244.25521   1.6292517   51.73779175  0.903910803
134.909462  210.96333   2.2389119   53.13433521  0.896529401
135.300562  212.02055   0.6739541   67.55073745  0.748783521
258.237117  134.29735   2.1205291   76.34032587  0.735699304
341.305271  149.26953   3.718958    94.33975483  0.849509216
307.138925  59.60571    0.6311074   106.9636715  0.987923188
307.76875   58.91453    2.6496741   113.8515307  0.802115718
415.025535  217.17398   1.7155688   115.7464603  0.875580325
414.977687  216.73327   1.7107369   115.9776948  0.767143582
311.006135  173.24378   2.7819572   120.8079566  0.925380118
310.116929  174.28122   4.3318722   129.2648401  0.776528535
347.260911  37.34946    3.5155427   136.7851291  0.851787115
351.317624  33.65703    0.5806926   138.7349284  0.909723017
4.471892    59.42068    1.4062959   139.0543783  0.967270976
5.480223    59.72857    2.7326106   139.2114277  0.987787428
199.513023  21.53302    2.5163259   143.5895625  0.864164659
198.718031  23.50163    0.4801849   147.2280466  0.741587333
26.650517   35.2019     0.8246514   150.4876506  0.744788202
25.089379   90.47825    0.8700944   152.1944046  0.777252476
26.307439   88.41552    2.4422487   155.9090026  0.952215177
234.282901  236.11422   1.8115261   155.9658144  0.776284654
235.052948  236.77437   1.9644963   156.6900297  0.944285448
23.048202   98.6261     3.4573048   159.7700912  0.773057491
21.516695   98.05431    2.5029284   160.8202997  0.978779087
213.936324  151.87013   3.1042192   161.0612489  0.80499513
277.887935  197.25753   1.3659279   163.673142   0.758978575
277.239746  197.54001   2.2109361   166.2629868  0.775325157"

x <- read.table(text=zz, header = TRUE)
y <- x[,1:3]
 fhat1 <- kde(x=y)
 n <- nrow(x)
colfunc <- colorRampPalette(c("white", "black"))
plot(fhat1, xlim=c(0,500), ylim=c(0,250), zlim=c(0, 4.4))
spheres3d(y, radius=15*(x$magnitude), alpha=1, col= colfunc(10), pch=19,cex=1.5)


legend_image <- as.raster(matrix(colfunc(10), ncol=1))
plot(c(0,10),c(0,200),type = 'n', axes = F, xlab = '', ylab = '', main = 'time scale')
text(x=1.5, y = seq(0,200,l=5), labels = seq(0,200,l=5))
rasterImage(legend_image, 0, 0, 1, 200)

	[[alternative HTML version deleted]]


From Rainer at krugs.de  Thu Jan 29 12:56:54 2015
From: Rainer at krugs.de (Rainer M Krug)
Date: Thu, 29 Jan 2015 12:56:54 +0100
Subject: [R-sig-Geo] Advice on GRASS version for R
In-Reply-To: <m2siev5lcd.fsf@krugs.de> (Rainer M. Krug's message of "Wed, 28
	Jan 2015 10:02:42 +0100")
References: <CANtt_hx7oMuXsMo3KGnyYOucXp-D-DrCcOirD5pXeTwubMBFSA@mail.gmail.com>
	<222388731.762476.1422374936521.JavaMail.yahoo@mail.yahoo.com>
	<54C7BF54.7080506@cerema.fr>
	<alpine.LNX.2.11.1501270919530.20436@localhost>
	<alpine.LFD.2.11.1501272134570.7590@reclus.nhh.no>
	<54C89579.3000507@cerema.fr>
	<alpine.LFD.2.11.1501280911300.22697@reclus.nhh.no>
	<m2siev5lcd.fsf@krugs.de>
Message-ID: <m2k3054x6h.fsf@krugs.de>

Rainer M Krug <Rainer at krugs.de> writes:

> Roger Bivand <Roger.Bivand at nhh.no> writes:
>
>> On Wed, 28 Jan 2015, PONS Frederic - CEREMA/DTerMed/DREC/SRILH wrote:
>>
>>> Thank you for your advice, I send an e-mail to a french grass list.
>>
>> That is no use. Use grass-stats if you need help with the R-GRASS
>> interface, the developers do not read other channels regularly.
>>
>>>
>>> The best solution seems for me to work with future version
>>>
>>
>> Work with forthcoming (soon to be stable) GRASS 7, not with the
>> development version.
>>
>>> But I cannot install spgrass 7 or spgrass on windows 7 in R version 3.1.2 :
>>
>> So download:
>>
>> http://download.r-forge.r-project.org/bin/windows/contrib/latest/spgrass7_0.1-0.zip
>>
>> and install from local zip file (untried). None of the developers uses
>> Windows, so this isn't a priority. Alternatively, install R-tools foe
>> Windows and then install the source package.
>
> I am in the process of setting up a virtual machine (Windows 7, R,
> GRASS) to test it out (If I manage to deal with windows ...).


Just a follow up: I could install spgrass7 without problems by using

--8<---------------cut here---------------start------------->8---

install.packages("spgrass7", repos="http://R-Forge.R-project.org")

--8<---------------cut here---------------end--------------->8---

Under Windows 7, R version 3.1.2 (2014-10-31)

Cheers,

Rainer

>
> Cheers,
>
> Rainer
>
>>
>> Roger
>>
>>>
>>>>  install.packages("spgrass7", repos="http://R-Forge.R-project.org")
>>> Avis : impossible d'acc?der ? l'index de l'entrep?t
>>> http://R-Forge.R-project.org/bin/windows/contrib/3.1
>>> Message d'avis :
>>> package 'spgrass7' is not available (for R version 3.1.2)
>>>>  RSiteSearch("spgrass7")
>>> Une requ?te de recherche a ?t? soumise ? http://search.r-project.org
>>> La page de r?sultats devrait s'ouvrir dans votre navigateur
>>>>  install.packages("spgrass", repos="http://R-Forge.R-project.org")
>>> Avis : impossible d'acc?der ? l'index de l'entrep?t
>>> http://R-Forge.R-project.org/bin/windows/contrib/3.1
>>> Message d'avis :
>>> package 'spgrass' is not available (for R version 3.1.2)
>>>
>>> How to do it?
>>> Thank you
>>> Fr?d?ric
>>>
>>> Le 27/01/2015 21:48, "> Roger Bivand (par Internet, d?p?t
>>> r-sig-geo-bounces at r-project.org)" a ?crit :
>>>>  On Tue, 27 Jan 2015, Rich Shepard wrote:
>>>>
>>>> >  On Tue, 27 Jan 2015, PONS Frederic - CEREMA/DTerMed/DREC/SRILH wrote:
>>>> > > >  Do you know what is the future standard of GRASS to script
>>>> for the > >  future
>>>> > >   version.
>>>>
>>>>  There is ongoing discussion on the grass-stats list:
>>>>
>>>>  http://lists.osgeo.org/mailman/listinfo/grass-stats
>>>>
>>>>  The GRASS 7.0 RC1 is where many parameter names have been changed. The
>>>>  changes are quite large, so the current R spgrass6 package will only
>>>>  handle GRASS 6 up to GRASS 7.0 beta, while the new spgrass7 (in the
>>>>  spgrass project on R-Forge) is being matched to changes in GRASS 7.0 RC*.
>>>>  See:
>>>>
>>>>  install.packages("spgrass7", repos="http://R-Forge.R-project.org")
>>>>
>>>>  This is thanks to input and work by Rainer Krug and Markus Neteler. RC2
>>>>  should be out soon too. spgrass6 will shift to maintenance mode only
>>>>  shortly after GRASS 7.0 is released, but will stay available.
>>>>
>>>>  The parameter name changes are on:
>>>>
>>>>  http://trac.osgeo.org/grass/wiki/Grass7/NewFeatures#Optionschanges
>>>>
>>>>  We have not checked against GRASS trunk. I think that your adaptation
>>>>  might match the regular 7.* series rather than the development trunk, but
>>>>  I agree with Rich that it would be worth asking on the GRASS users or
>>>>  developers list.
>>>>
>>>>  Roger
>>>>
>>>> > >   Ask on the GRASS mail list; you can sign up at
>>>> http://grass.osgeo.org/.
>>>> > >  If there are syntactic differences I would assume that those
>>>> in the >  7.1svn
>>>> >  are the future. I've used GRASS (on linux) since 4.0 and current
>>>> use >  7.1svn
>>>> >  so I've seen many differences over the past couple of decades.
>>>> > >  Rich
>>>> > >  _______________________________________________
>>>> >  R-sig-Geo mailing list
>>>> >  R-sig-Geo at r-project.org
>>>> >  https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>> > 
>>>>
>>>
>>>

-- 
Rainer M. Krug
email: Rainer<at>krugs<dot>de
PGP: 0x0F52F982
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 494 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150129/aad0de03/attachment.bin>

From esa.ostring at infotripla.fi  Fri Jan 30 07:57:47 2015
From: esa.ostring at infotripla.fi (=?windows-1252?Q?Esa_=D6string?=)
Date: Fri, 30 Jan 2015 08:57:47 +0200
Subject: [R-sig-Geo] Error installing 'rgdal' on Centos 7
In-Reply-To: <20150115110936.Horde.fdQ4_fy03bfSZq6QlC8oaw6@webmail.csic.es>
References: <20150115110936.Horde.fdQ4_fy03bfSZq6QlC8oaw6@webmail.csic.es>
Message-ID: <54CB2B6B.7050508@infotripla.fi>

Hello,

And I'm sorry for the delay in answering.

In CentOS 7, try using "epel" -repo, there is an essential part of tools 
in that repo.

You can find gdal and gdal-devel rpm's there, and they are relatively 
recent versions also.

I'm not sure, but you would probably need/want to install geos-devel and 
proj-epsg also.

----8<----
[root at localhost R]# repoquery -i gdal-devel

Name        : gdal-devel
Version     : 1.11.0
Release     : 2.el7
Architecture: x86_64
Size        : 681767
Packager    : Fedora Project
Group       : Development/Libraries
URL         : http://www.gdal.org
Repository  : epel
Summary     : Development files for the GDAL file format library
Source      : gdal-1.11.0-2.el7.src.rpm
Description :
This package contains development files for GDAL.

[root at localhost R]# repoquery -l gdal-devel | grep config
/usr/bin/gdal-config
/usr/bin/gdal-config-64
/usr/include/gdal/cpl_config-64.h
/usr/include/gdal/cpl_config.h
/usr/include/gdal/cpl_config_extras.h
/usr/lib64/pkgconfig/gdal.pc
/usr/share/man/man1/gdal-config.1.gz
----8<----

br,

Esa ?string, SW Architect / Data scientist
Infotripla Oy, Finland


On 01/15/2015 12:09 PM, Manuel Pizarro Gavil?n wrote:
>
> Hello:
>
> I can't install the ' rgdal ' package in R and ' GDAL ' on CentOS 7 
> (ELGIS repo added).
>
> Is there any solution?
>
> Thanks
>


From mauriziomarchi85 at gmail.com  Fri Jan 30 14:53:47 2015
From: mauriziomarchi85 at gmail.com (Maurizio Marchi)
Date: Fri, 30 Jan 2015 14:53:47 +0100
Subject: [R-sig-Geo] PCA on rasterStack
Message-ID: <CANJhsN15UuxM=tpQgSB4kRnm=ZO1_y_W0MbMnefMJgZUNwMOuw@mail.gmail.com>

Hi everybody,
I need to perform a Principal Component Analysis on some climatic maps (20
layers). I use the "prcomp" function of stats package with the na.omit
option and everithing works fine but I need help concerning data scaling
and centering. I have both temperatures and precipitation maps, so I
decided to scale the data (scale=TRUE) but should I also use the centering
option (center=TRUE)? In my advise, the scaling procedure should also
center my data...the scaling procedure is made subtracting the mean and
dividing for the variance, isn't it?

many thanks,

-- 
Maurizio Marchi
Calenzano (FI) - Italy
ID Skype: maurizioxyz
Ubuntu 14.04 LTS
linux user 552742

	[[alternative HTML version deleted]]


From dupouey at nancy.inra.fr  Sat Jan 31 12:17:44 2015
From: dupouey at nancy.inra.fr (Jean-Luc DUPOUEY)
Date: Sat, 31 Jan 2015 04:17:44 -0700 (MST)
Subject: [R-sig-Geo] transformin multipart shapefile to singlepart
	shapefile
In-Reply-To: <4D36B2D4.4090302@wiwi.hu-berlin.de>
References: <4D356FCA.8080603@wiwi.hu-berlin.de>
	<AANLkTikzyxCOR+6FesCxa3wNPfvqFZnJnZ1=25PkFgxJ@mail.gmail.com>
	<4D36B2D4.4090302@wiwi.hu-berlin.de>
Message-ID: <1422703064617-7587716.post@n2.nabble.com>

I faced the same question recently: how to tranform a multipart polygon layer
into single polygons? Here is a little bit more general function to do that.
It keeps the initial ID of the polygons, adding a sequence number. The
initial plot order and projection information are also kept. 

But pay attention, holes are automatically converted into islands, because
holes cannot be single polygons.

I am interested in improving this function. Thanks in advance,

JL Dupouey

#JL Dupouey INRA-Nancy 2015/01/31

#convert a multipart SpatialPolygons object to a single part SpatialPolygons
object
#plot order: keeps the initial plot order 
#p4s: keeps the initial p4s, if not NA
#ID: keeps the initial ID of the multipart polygons, and add a numeric
increasing index from 1 to n 
# in order of presence of the single polygons wich compose the multipart
polygon, if there is more then one part

multitoone=function(mpart)

{
#vector of number of elementary polygons in each multipart polygon (for
calculation of plot order, and initialization of islands)
nbpoly=sapply(mpart at polygons,function(x){length(x at Polygons)})

#initialize the list of single Polygons to be built
islands=vector("list",sum(nbpoly))
#initialize the vector plot order of single polygons to be built
plotorder=vector("integer",sum(nbpoly))

#index of current single Polygons
k=0

#loop on all Polygons of the object

for (i in 1:length(mpart))
{

#current multiple polygon
pols=mpart at polygons[[i]]@Polygons
ID=mpart at polygons[[i]]@ID

#number of polygons to plot before the current multiple one
prev=sum(nbpoly[mpart at plotOrder<mpart at plotOrder[i]])

#loop on each elementary polygon of the current multiple polygon

for (j in 1:length(pols)) 
 { k=k+1
   IDs=ifelse(length(pols)>1,paste(ID,'-',j,sep=''),ID) 
   islands[[k]] = Polygons(list(pols[[j]]), IDs)
  
plotorder[k]=rank(mpart at polygons[[i]]@plotOrder,ties.method="first")[j]+prev
}
}#end on loop on all Polygons of the object

multitoone = SpatialPolygons(islands,pO=plotorder)
if (!is.na(proj4string(mpart))) proj4string(multitoone)=proj4string(mpart) 

return(multitoone)
}

 



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/transformin-multipart-shapefile-to-singlepart-shapefile-tp5935148p7587716.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


