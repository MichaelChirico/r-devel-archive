From debeaudette at ucdavis.edu  Sun May  1 01:31:11 2011
From: debeaudette at ucdavis.edu (Dylan Beaudette)
Date: Sat, 30 Apr 2011 16:31:11 -0700
Subject: [R-sig-Geo] spsample taking excessive memory
In-Reply-To: <4DBB5CD1.4040609@amnh.org>
References: <4DBB5CD1.4040609@amnh.org>
Message-ID: <201104301631.11115.dylan.beaudette@gmail.com>

On Friday, April 29, 2011, Ned Horning wrote:
> Hi -
> 
> I am trying to select 1000 random samples from each set of ESRI 
> Shapefile polygons with the same attribute value (attName). This has 
> worked well in the past with other shapefiles. The file I'm using now 
> has 69 relatively simple polygons with 9 unique values for the attribute 
> I'm using to group the polygons. When I run spsample it takes several 
> minutes to collect the samples for some of the unique attribute values 
> and it is using well over 12GB of memory. By the time it start 
> collecting samples from the last set of polygons my swap space is nearly 
> exhausted and the spsample process goes on for hours until I kill it. Do 
> these symptoms sound familiar to anyone? Any ideas about what the 
> problem might be? I pasted my code below.
> 
> Thanks in advance for any help.
> 
> Ned

Hi,

Not sure if this is the problem, but it could be that dynamically appending to 
the object 'xy' is causing some of the memory consumption / slowness.

I would suggest iterating over collections of polygons, and saving the results 
to a pre-allocated list object. Then, rbind the elements of the list back 
together at the end.

Cheers,
Dylan


> --
> shapefile <- '/home/nedhorning/AMNH/Galapagos/quickbird_train_4.shp'
> numsamps <- 1000
> attName <- 'type_id'
> 
> vec <- readShapePoly(shapefile)
> #
> # Create vector of unique land cover attribute values
> allAtt <- slot(vec, "data")
> tabAtt <-table(allAtt[[attName]])
> uniqueAtt <-as.numeric(names(tabAtt))
> # Create input data from a Shapefile with training data and the image
> for (x in 1:length(uniqueAtt)) {
>    # Create a vector of all date for attName=x
>    class_data <- vec[vec[[attName]]==uniqueAtt[x],]
>    # Get random points for the class
>    classpts <- spsample(class_data, type="random", n=numsamps)
>    #Append data for all but the first run
>    if (x == 1) {
>      xy <- classpts
>    } else {
>      xy <- rbind(xy, classpts)
>    }
> }
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 


-- 
Dylan E. Beaudette
USDA-NRCS Soil Scientist
California Soil Resource Lab
http://casoilresource.lawr.ucdavis.edu/


From sebastian_brandt at gmx.net  Sun May  1 22:50:05 2011
From: sebastian_brandt at gmx.net (Sebastian Brandt)
Date: Sun, 01 May 2011 22:50:05 +0200
Subject: [R-sig-Geo] Creating listw object from n by n matrix
Message-ID: <20110501205005.307900@gmx.net>

Dear List,

I have n datsets that I would like to test for spatial dependence using the lm.LMtests function. I have computed a n by n row-standardised spatial weights matrix that I have imported into R workspace from a csv.-file.

Running the lm.LMtests function I get an error message that the n by n matrix is not a listw object. How can I convert the matrix into a listw object?

I would be grateful for any help.

Sebastian


From v8extra at gmail.com  Sun May  1 23:28:11 2011
From: v8extra at gmail.com (=?iso-8859-1?Q?S=E9bastien_Durand?=)
Date: Sun, 1 May 2011 17:28:11 -0400
Subject: [R-sig-Geo] Global variance estimation for evaluating resulting
	krigging quality
Message-ID: <ADA8EFEB-B65E-49C9-9654-6B36A5D8325E@gmail.com>

Hello to all,

I have been trying to find the following since quite a while but I guess I was simply using the wrong terms to express myself.

The following shall describe what I am really looking for in R. 

I wish to know if there is an easy way to obtain that value using already preexisting functions. 

Considering the amount of function and package, I have a hard time thinking this has not been done yet!

Even so I have looked I am unable to find the proper function.

So to find the global variance of estimation here is the formula that need to be solved: 
 
1-	Global variance of estimation =  C(v,v) - lambda_v' * C(x,v)
	
	Where;
		C(v,v) is the mean of all covariances between the krigged points (a grid);
		lambda_v is the vector of weights used in the following global krigging:
		
2-		C(x,x) * lambda_v =  C(x,v)
	
	Where 
		C(x,x) is the covariance matrix of the initial points used (the last column and row are appended by 1 and end by a 0) 
			(these answer for the sum of weight constraint which must be equal to 1)
		C(x,v) is a vector of length equal to number of initial point feed to the krigging system, and contains for every initial point the covariance average between  all the krigged points. This vector is appended by the number 1 to all for the sum of weigth =1 constraint.

If any one is able to help me out... I will be a very very greatful
	
S?bastien

From amcrgrodrigues at gmail.com  Mon May  2 12:08:04 2011
From: amcrgrodrigues at gmail.com (=?ISO-8859-1?Q?Ant=F3nio_M=2E_Rodrigues?=)
Date: Mon, 2 May 2011 11:08:04 +0100
Subject: [R-sig-Geo] rgdal installation problem
Message-ID: <BANLkTinco2FNPmPQ8usD8dbXAk7mDNMTCA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110502/876f5460/attachment.pl>

From cfusting at gmail.com  Mon May  2 16:23:41 2011
From: cfusting at gmail.com (Christopher Fusting)
Date: Mon, 2 May 2011 10:23:41 -0400
Subject: [R-sig-Geo] rgdal installation problem
In-Reply-To: <BANLkTinco2FNPmPQ8usD8dbXAk7mDNMTCA@mail.gmail.com>
References: <BANLkTinco2FNPmPQ8usD8dbXAk7mDNMTCA@mail.gmail.com>
Message-ID: <BANLkTimAjh-FFy+qn425ng-bJ8OAbKVUew@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110502/1ba7d629/attachment.pl>

From elaine.kuo.tw at gmail.com  Tue May  3 10:30:43 2011
From: elaine.kuo.tw at gmail.com (elaine kuo)
Date: Tue, 3 May 2011 16:30:43 +0800
Subject: [R-sig-Geo] how to extract the attribute table of shape files using
	R
Message-ID: <BANLkTimjqjkHqmP9rHEtCZmkcmsgohgghg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110503/6aa2f705/attachment.pl>

From daniballari at gmail.com  Tue May  3 11:04:05 2011
From: daniballari at gmail.com (Daniela Ballari)
Date: Tue, 3 May 2011 11:04:05 +0200
Subject: [R-sig-Geo] how to extract the attribute table of shape files
 using R
In-Reply-To: <BANLkTimjqjkHqmP9rHEtCZmkcmsgohgghg@mail.gmail.com>
References: <BANLkTimjqjkHqmP9rHEtCZmkcmsgohgghg@mail.gmail.com>
Message-ID: <BANLkTikzCCaJDSr0jepHQiWUe8td8r5DFQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110503/270a8b00/attachment.pl>

From risemary48 at yahoo.com  Tue May  3 14:00:23 2011
From: risemary48 at yahoo.com (Mary Rise)
Date: Tue, 3 May 2011 05:00:23 -0700 (PDT)
Subject: [R-sig-Geo] where is the problem?
Message-ID: <661113.93433.qm@web120819.mail.ne1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110503/6bb451da/attachment.pl>

From rhunne at mac.com  Tue May  3 19:06:51 2011
From: rhunne at mac.com (Robin W Hunnewell)
Date: Tue, 03 May 2011 17:06:51 +0000 (GMT)
Subject: [R-sig-Geo] rgdal installation problem
Message-ID: <50b06f0c-f886-c137-f3d3-f13b6a642a0c@me.com>

Hi,?

Could you - or any other mac users who've been successful installing rgdal - elaborate how you did it??

I'm trying to install rgdal in my iMac (os X 10.6.7). I have latest Mac R app. version 2.13.0?
I downloaded the?GDAL framework 1.8 and its dependencies from the kyngchaos site -- under the GDAL section of the page:?

http://www.kyngchaos.com/software/frameworks


But not sure the that the installation has put it in the right configuration, path for loading into R.

In R, I installed and loaded library 'sp' ?which rgdal needs..

Then tried to install the GDAL package - I go to the R Package Installer,?select 'Local Binary Package' from the popup, then click 'Install...'.?
I was able to locate and select the rgdal tarball to install and load it for use in R, but?get error message:
1: 'tar' returned non-zero exit code 1 
2: In file.rename(file.path(tmpDir, pkgname), instPath) :
  cannot rename file '/Users/robinhunnewell/Library/R/2.13/library/file3af03e3f/GDAL' to '/Users/robinhunnewell/Library/R/2.13/library/GDAL', reason 'No such file or directory'
3: unable to move temporary installation '/Users/robinhunnewell/Library/R/2.13/library/file3af03e3f/GDAL' to '/Users/robinhunnewell/Library/R/2.13/library/GDAL' 

Is it because GDAL is not in the right place? Thanks v much if anyone can anyone help!
Robin

On 02 May, 2011,at 11:23 AM, Christopher Fusting <cfusting at gmail.com> wrote:

I had a similar problem. The port under the GDAL section of this page
worked for me:

http://www.kyngchaos.com/software/frameworks

_Chris

2011/5/2 Ant?nio M. Rodrigues <amcrgrodrigues at gmail.com>

> Hi,
>
>
> I'm trying to instal library rgdal in my macbook (os X 10.6.7).
>
>
> I have installed the latest R package (R-2.13.0.pkg).
>
>
> I have gdal 1.8 install. Also, I have loaded library sp which rgdal needs.
>
>
> I downloaded rdgal_06-33.tgz and using R Package installer, I located and
> installed the Local Binary Package.
>
>
> When trying to load rgdal ( >library(rgdal)in the R prompt) I get the
> error:
>
>
> -----
>
> Error : onLoad failed in loadNamespace() for 'rgdal', details:
>
> call: fun(..)
>
> error:
>
> GDAL Error 1: dlopen(/Library/Application
> Support/GDAL/1.8/PlugIns/gdal_GRASS.dylib, 1): Library not loaded:
> /Applications/GRASS-6.4.app/Contents/MacOS/lib/libgrass_gis.dylib
>
> Referenced from: /Library/Application
> Support/GDAL/1.8/PlugIns/gdal_GRASSdylib
>
> Reason: image not found
>
>
> Error: package/namespace load failed for 'rgdal'
>
> -----
>
>
> Any help will be much appreciated.
>
> thanks,
>
> Ant?nio
>
> [[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


-- 
Christopher W. Fusting

GIS Consulting
Predictive Modeling
Remote Sensing

Cell:
828-772-0012

[[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110503/5b92c7ac/attachment.html>

From Roger.Bivand at nhh.no  Tue May  3 19:21:54 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 3 May 2011 19:21:54 +0200 (CEST)
Subject: [R-sig-Geo] rgdal installation problem
In-Reply-To: <50b06f0c-f886-c137-f3d3-f13b6a642a0c@me.com>
References: <50b06f0c-f886-c137-f3d3-f13b6a642a0c@me.com>
Message-ID: <alpine.LRH.2.00.1105031915490.29392@reclus.nhh.no>

On Tue, 3 May 2011, Robin W Hunnewell wrote:

> Hi,?
>
> Could you - or any other mac users who've been successful installing rgdal - 
> elaborate how you did it??

Usually, OSX users say setRepositories(ind=1:2) to install from CRAN and 
CRAN extras, where OSX binaries for R 2.13 are provided by Prof. Brian 
Ripley. The direct URL is:

http://www.stats.ox.ac.uk/pub/RWin/bin/macosx/leopard/contrib/2.13/

This has static GDAL and standard drivers. Kyngchaos now also has an R 
2.13 binary, which depends on the frameworks also provided there - it was 
added recently at user request, and provides a larger number of drivers.

Roger

>
> I'm trying to install rgdal in my iMac (os X 10.6.7). I have latest Mac R 
> app. version 2.13.0?
> I downloaded the?GDAL framework 1.8 and its dependencies from the kyngchaos 
> site -- under the GDAL section of the page:?
>
> http://www.kyngchaos.com/software/frameworks
>
>
> But not sure the that the installation has put it in the right configuration, 
> path for loading into R.
>
> In R, I installed and loaded library 'sp' ?which rgdal needs..
>
> Then tried to install the GDAL package - I go to the R Package 
> Installer,?select 'Local Binary Package' from the popup, then click 
> 'Install...'.?
> I was able to locate and select the rgdal tarball to install and load it for 
> use in R, but?get error message:
> 1: 'tar' returned non-zero exit code 1 2: In file.rename(file.path(tmpDir, 
> pkgname), instPath) :
> cannot rename file 
> '/Users/robinhunnewell/Library/R/2.13/library/file3af03e3f/GDAL' to 
> '/Users/robinhunnewell/Library/R/2.13/library/GDAL', reason 'No such file or 
> directory'
> 3: unable to move temporary installation 
> '/Users/robinhunnewell/Library/R/2.13/library/file3af03e3f/GDAL' to 
> '/Users/robinhunnewell/Library/R/2.13/library/GDAL' 
> Is it because GDAL is not in the right place? Thanks v much if anyone can 
> anyone help!
> Robin
>
> On 02 May, 2011,at 11:23 AM, Christopher Fusting <cfusting at gmail.com> wrote:
>
> I had a similar problem. The port under the GDAL section of this page
> worked for me:
>
> http://www.kyngchaos.com/software/frameworks
>
> _Chris
>
> 2011/5/2 Ant???nio M. Rodrigues <amcrgrodrigues at gmail.com>
>
>> Hi,
>> 
>> 
>> I'm trying to instal library rgdal in my macbook (os X 10.6.7).
>> 
>> 
>> I have installed the latest R package (R-2.13.0.pkg).
>> 
>> 
>> I have gdal 1.8 install. Also, I have loaded library sp which rgdal needs.
>> 
>> 
>> I downloaded rdgal_06-33.tgz and using R Package installer, I located and
>> installed the Local Binary Package.
>> 
>> 
>> When trying to load rgdal ( >library(rgdal)in the R prompt) I get the
>> error:
>> 
>> 
>> -----
>> 
>> Error : onLoad failed in loadNamespace() for 'rgdal', details:
>> 
>> call: fun(..)
>> 
>> error:
>> 
>> GDAL Error 1: dlopen(/Library/Application
>> Support/GDAL/1.8/PlugIns/gdal_GRASS.dylib, 1): Library not loaded:
>> /Applications/GRASS-6.4.app/Contents/MacOS/lib/libgrass_gis.dylib
>> 
>> Referenced from: /Library/Application
>> Support/GDAL/1.8/PlugIns/gdal_GRASSdylib
>> 
>> Reason: image not found
>> 
>> 
>> Error: package/namespace load failed for 'rgdal'
>> 
>> -----
>> 
>> 
>> Any help will be much appreciated.
>> 
>> thanks,
>> 
>> Ant???nio
>> 
>> [[alternative HTML version deleted]]
>> 
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
>> 
>
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From cfusting at gmail.com  Tue May  3 19:35:46 2011
From: cfusting at gmail.com (Christopher Fusting)
Date: Tue, 3 May 2011 13:35:46 -0400
Subject: [R-sig-Geo] rgdal installation problem
In-Reply-To: <50b06f0c-f886-c137-f3d3-f13b6a642a0c@me.com>
References: <50b06f0c-f886-c137-f3d3-f13b6a642a0c@me.com>
Message-ID: <BANLkTinSckV3pdmAd3EVKs+YmJS-xmgtgQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110503/3779d6c1/attachment.pl>

From Roger.Bivand at nhh.no  Tue May  3 19:59:52 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 3 May 2011 19:59:52 +0200 (CEST)
Subject: [R-sig-Geo] spsample taking excessive memory
In-Reply-To: <201104301631.11115.dylan.beaudette@gmail.com>
References: <4DBB5CD1.4040609@amnh.org>
	<201104301631.11115.dylan.beaudette@gmail.com>
Message-ID: <alpine.LRH.2.00.1105031953180.29392@reclus.nhh.no>

On Sat, 30 Apr 2011, Dylan Beaudette wrote:

> On Friday, April 29, 2011, Ned Horning wrote:
>> Hi -
>>
>> I am trying to select 1000 random samples from each set of ESRI
>> Shapefile polygons with the same attribute value (attName). This has
>> worked well in the past with other shapefiles. The file I'm using now
>> has 69 relatively simple polygons with 9 unique values for the attribute
>> I'm using to group the polygons. When I run spsample it takes several
>> minutes to collect the samples for some of the unique attribute values
>> and it is using well over 12GB of memory. By the time it start
>> collecting samples from the last set of polygons my swap space is nearly
>> exhausted and the spsample process goes on for hours until I kill it. Do
>> these symptoms sound familiar to anyone? Any ideas about what the
>> problem might be? I pasted my code below.
>>
>> Thanks in advance for any help.
>>
>> Ned
>
> Hi,
>
> Not sure if this is the problem, but it could be that dynamically appending to
> the object 'xy' is causing some of the memory consumption / slowness.
>
> I would suggest iterating over collections of polygons, and saving the results
> to a pre-allocated list object. Then, rbind the elements of the list back
> together at the end.

Hi,

The polygons are very small, spread out over a very large area, so 
spsample tries to generate many points for the bounding box of the object, 
rejecting most of them. As Dylan suggests, you can get a long way by 
stepping only to the polygons you need:

for (x in 1:length(uniqueAtt)) {
   class_data<- vec[vec[[attName]]==uniqueAtt[x],]
   areas <- sapply(slot(class_data, "polygons"), slot, "area")
   nsamps <- ceiling(numsamps*(areas/sum(areas)))
   for (i in 1:dim(class_data)[1]) {
     XY <- spsample(class_data[i,], type="random", n=nsamps[i])
# step Polygons object by Polygons object, dividing the numsamps by area
     if (i == 1) cpts <- XY
     else cpts <- rbind(cpts, XY)
   }
# maybe need to modify the number of points to match numsamps exactly.
   classpts <- cpts
   if (x == 1) {
     xy<- classpts
   } else {
     xy<- rbind(xy, classpts)
   }
}

The spsample() method for SpatialPolygons does really expect them to be 
close to each other, and to fill the object bounding box at least in some 
large part.

Hope this helps,

Roger

>
> Cheers,
> Dylan
>
>
>> --
>> shapefile <- '/home/nedhorning/AMNH/Galapagos/quickbird_train_4.shp'
>> numsamps <- 1000
>> attName <- 'type_id'
>>
>> vec <- readShapePoly(shapefile)
>> #
>> # Create vector of unique land cover attribute values
>> allAtt <- slot(vec, "data")
>> tabAtt <-table(allAtt[[attName]])
>> uniqueAtt <-as.numeric(names(tabAtt))
>> # Create input data from a Shapefile with training data and the image
>> for (x in 1:length(uniqueAtt)) {
>>    # Create a vector of all date for attName=x
>>    class_data <- vec[vec[[attName]]==uniqueAtt[x],]
>>    # Get random points for the class
>>    classpts <- spsample(class_data, type="random", n=numsamps)
>>    #Append data for all but the first run
>>    if (x == 1) {
>>      xy <- classpts
>>    } else {
>>      xy <- rbind(xy, classpts)
>>    }
>> }
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From rhunne at mac.com  Tue May  3 20:15:06 2011
From: rhunne at mac.com (Robin W Hunnewell)
Date: Tue, 03 May 2011 18:15:06 +0000 (GMT)
Subject: [R-sig-Geo] rgdal installation problem
In-Reply-To: <alpine.LRH.2.00.1105031915490.29392@reclus.nhh.no>
Message-ID: <1475ab16-3283-69ee-fd00-8443c3b05f83@me.com>

Thank you. ?sorry if this is basic; had just hoped to find a step-by-step guide for Idiots on how to install GDAL and rgdal on OSX.?

I downloaded?the comprehensive GDAL framework?provided by William Kyngesburye:

http://www.kyngchaos.com/

Help and 'read me' files say to install the GDAL?framework with dependencies first, then an rgdal binary from the same?site.
But I'm not sure how to compile and configure GDAL the right way - so that it gets to the R library and can then be located.
I'm sure it's just a basic step, but?for someone new to this it's a little confusing..
Thanks very much for the URL below, will try to work it through



On 03 May, 2011,at 02:21 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:

On Tue, 3 May 2011, Robin W Hunnewell wrote:

> Hi,?
>
> Could you - or any other mac users who've been successful installing rgdal - 
> elaborate how you did it??

Usually, OSX users say setRepositories(ind=1:2) to install from CRAN and 
CRAN extras, where OSX binaries for R 2.13 are provided by Prof. Brian 
Ripley. The direct URL is:

http://www.stats.ox.ac.uk/pub/RWin/bin/macosx/leopard/contrib/2.13/

This has static GDAL and standard drivers. Kyngchaos now also has an R 
2.13 binary, which depends on the frameworks also provided there - it was 
added recently at user request, and provides a larger number of drivers.

Roger

>
> I'm trying to install rgdal in my iMac (os X 10.6.7). I have latest Mac R 
> app. version 2.13.0?
> I downloaded the?GDAL framework 1.8 and its dependencies from the kyngchaos 
> site -- under the GDAL section of the page:?
>
> http://www.kyngchaos.com/software/frameworks
>
>
> But not sure the that the installation has put it in the right configuration, 
> path for loading into R.
>
> In R, I installed and loaded library 'sp' ?which rgdal needs..
>
> Then tried to install the GDAL package - I go to the R Package 
> Installer,?select 'Local Binary Package' from the popup, then click 
> 'Install...'.?
> I was able to locate and select the rgdal tarball to install and load it for 
> use in R, but?get error message:
> 1: 'tar' returned non-zero exit code 1 2: In file.rename(file.path(tmpDir, 
> pkgname), instPath) :
> cannot rename file 
> '/Users/robinhunnewell/Library/R/2.13/library/file3af03e3f/GDAL' to 
> '/Users/robinhunnewell/Library/R/2.13/library/GDAL', reason 'No such file or 
> directory'
> 3: unable to move temporary installation 
> '/Users/robinhunnewell/Library/R/2.13/library/file3af03e3f/GDAL' to 
> '/Users/robinhunnewell/Library/R/2.13/library/GDAL' 
> Is it because GDAL is not in the right place? Thanks v much if anyone can 
> anyone help!
> Robin
>
> On 02 May, 2011,at 11:23 AM, Christopher Fusting <cfusting at gmail.com> wrote:
>
> I had a similar problem. The port under the GDAL section of this page
> worked for me:
>
> http://www.kyngchaos.com/software/frameworks
>
> _Chris
>
> 2011/5/2 Ant???nio M. Rodrigues <amcrgrodrigues at gmailcom>
>
>> Hi,
>> 
>> 
>> I'm trying to instal library rgdal in my macbook (os X 10.6.7).
>> 
>> 
>> I have installed the latest R package (R-2.13.0.pkg).
>> 
>> 
>> I have gdal 1.8 install. Also, I have loaded library sp which rgdal needs.
>> 
>> 
>> I downloaded rdgal_06-33.tgz and using R Package installer, I located and
>> installed the Local Binary Package.
>> 
>> 
>> When trying to load rgdal ( >library(rgdal)in the R prompt) I get the
>> error:
>> 
>> 
>> -----
>> 
>> Error : onLoad failed in loadNamespace() for 'rgdal', details:
>> 
>> call: fun(..)
>> 
>> error:
>> 
>> GDAL Error 1: dlopen(/Library/Application
>> Support/GDAL/1.8/PlugIns/gdal_GRASS.dylib, 1): Library not loaded:
>> /Applications/GRASS-6.4.app/Contents/MacOS/lib/libgrass_gis.dylib
>> 
>> Referenced from: /Library/Application
>> Support/GDAL/1.8/PlugIns/gdal_GRASSdylib
>> 
>> Reason: image not found
>> 
>> 
>> Error: package/namespace load failed for 'rgdal'
>> 
>> -----
>> 
>> 
>> Any help will be much appreciated.
>> 
>> thanks,
>> 
>> Ant???nio
>> 
>> [[alternative HTML version deleted]]
>> 
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
>> 
>
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110503/909255f4/attachment.html>

From Roger.Bivand at nhh.no  Tue May  3 20:22:52 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 3 May 2011 20:22:52 +0200 (CEST)
Subject: [R-sig-Geo] rgdal installation problem
In-Reply-To: <1475ab16-3283-69ee-fd00-8443c3b05f83@me.com>
References: <1475ab16-3283-69ee-fd00-8443c3b05f83@me.com>
Message-ID: <alpine.LRH.2.00.1105032019330.29392@reclus.nhh.no>

On Tue, 3 May 2011, Robin W Hunnewell wrote:

> Thank you. ?sorry if this is basic; had just hoped to find a step-by-step 
> guide for Idiots on how to install GDAL and rgdal on OSX.?
>
> I downloaded?the comprehensive GDAL framework?provided by William 
> Kyngesburye:
>
> http://www.kyngchaos.com/
>
> Help and 'read me' files say to install the GDAL?framework with dependencies 
> first, then an rgdal binary from the same?site.
> But I'm not sure how to compile and configure GDAL the right way - so that it 
> gets to the R library and can then be located.
> I'm sure it's just a basic step, but?for someone new to this it's a little 
> confusing..
> Thanks very much for the URL below, will try to work it through

If you do not need drivers other than the standard ones (shapefile, 
geotiff, etc.), within R do only:

setRepositories(ind=1:2)
install.packages("rgdal")

Only use Kyngchaos if you need GDAL and the frameworks for other purposes 
other than rgdal, or if you need extra drivers for rgdal not provided as 
standard from CRAN extras.

Please report back if this meets your needs.

Roger

>
>
>
> On 03 May, 2011,at 02:21 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
> On Tue, 3 May 2011, Robin W Hunnewell wrote:
>
>> Hi,?
>>
>> Could you - or any other mac users who've been successful installing rgdal 
> - 
>> elaborate how you did it??
>
> Usually, OSX users say setRepositories(ind=1:2) to install from CRAN and 
> CRAN extras, where OSX binaries for R 2.13 are provided by Prof. Brian 
> Ripley. The direct URL is:
>
> http://www.stats.ox.ac.uk/pub/RWin/bin/macosx/leopard/contrib/2.13/
>
> This has static GDAL and standard drivers. Kyngchaos now also has an R 
> 2.13 binary, which depends on the frameworks also provided there - it was 
> added recently at user request, and provides a larger number of drivers.
>
> Roger
>
>>
>> I'm trying to install rgdal in my iMac (os X 10.6.7). I have latest Mac R 
>> app. version 2.13.0?
>> I downloaded the?GDAL framework 1.8 and its dependencies from the kyngchaos 
>> site -- under the GDAL section of the page:?
>>
>> http://www.kyngchaos.com/software/frameworks
>>
>>
>> But not sure the that the installation has put it in the right 
> configuration, 
>> path for loading into R.
>>
>> In R, I installed and loaded library 'sp' ?which rgdal needs..
>>
>> Then tried to install the GDAL package - I go to the R Package 
>> Installer,?select 'Local Binary Package' from the popup, then click 
>> 'Install...'.?
>> I was able to locate and select the rgdal tarball to install and load it 
> for 
>> use in R, but?get error message:
>> 1: 'tar' returned non-zero exit code 1 2: In file.rename(file.path(tmpDir, 
>> pkgname), instPath) :
>> cannot rename file 
>> '/Users/robinhunnewell/Library/R/2.13/library/file3af03e3f/GDAL' to 
>> '/Users/robinhunnewell/Library/R/2.13/library/GDAL', reason 'No such file 
> or 
>> directory'
>> 3: unable to move temporary installation 
>> '/Users/robinhunnewell/Library/R/2.13/library/file3af03e3f/GDAL' to 
>> '/Users/robinhunnewell/Library/R/2.13/library/GDAL' 
>> Is it because GDAL is not in the right place? Thanks v much if anyone can 
>> anyone help!
>> Robin
>>
>> On 02 May, 2011,at 11:23 AM, Christopher Fusting <cfusting at gmail.com> 
> wrote:
>>
>> I had a similar problem. The port under the GDAL section of this page
>> worked for me:
>>
>> http://www.kyngchaos.com/software/frameworks
>>
>> _Chris
>>
>> 2011/5/2 Ant???nio M. Rodrigues <amcrgrodrigues at gmailcom>
>>
>>> Hi,
>>> 
>>> 
>>> I'm trying to instal library rgdal in my macbook (os X 10.6.7).
>>> 
>>> 
>>> I have installed the latest R package (R-2.13.0.pkg).
>>> 
>>> 
>>> I have gdal 1.8 install. Also, I have loaded library sp which rgdal needs.
>>> 
>>> 
>>> I downloaded rdgal_06-33.tgz and using R Package installer, I located and
>>> installed the Local Binary Package.
>>> 
>>> 
>>> When trying to load rgdal ( >library(rgdal)in the R prompt) I get the
>>> error:
>>> 
>>> 
>>> -----
>>> 
>>> Error : onLoad failed in loadNamespace() for 'rgdal', details:
>>> 
>>> call: fun(..)
>>> 
>>> error:
>>> 
>>> GDAL Error 1: dlopen(/Library/Application
>>> Support/GDAL/1.8/PlugIns/gdal_GRASS.dylib, 1): Library not loaded:
>>> /Applications/GRASS-6.4.app/Contents/MacOS/lib/libgrass_gis.dylib
>>> 
>>> Referenced from: /Library/Application
>>> Support/GDAL/1.8/PlugIns/gdal_GRASSdylib
>>> 
>>> Reason: image not found
>>> 
>>> 
>>> Error: package/namespace load failed for 'rgdal'
>>> 
>>> -----
>>> 
>>> 
>>> Any help will be much appreciated.
>>> 
>>> thanks,
>>> 
>>> Ant???nio
>>> 
>>> [[alternative HTML version deleted]]
>>> 
>>> 
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> 
>>> 
>>
>>
>>
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From amcrgrodrigues at gmail.com  Tue May  3 20:32:00 2011
From: amcrgrodrigues at gmail.com (=?ISO-8859-1?Q?Ant=F3nio_M=2E_Rodrigues?=)
Date: Tue, 3 May 2011 19:32:00 +0100
Subject: [R-sig-Geo] rgdal installation problem
In-Reply-To: <alpine.LRH.2.00.1105032019330.29392@reclus.nhh.no>
References: <1475ab16-3283-69ee-fd00-8443c3b05f83@me.com>
	<alpine.LRH.2.00.1105032019330.29392@reclus.nhh.no>
Message-ID: <BANLkTi=yHNERyNBxdeuvL0XgK-KmH-LkCA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110503/ab6525a4/attachment.pl>

From rhunne at mac.com  Tue May  3 20:45:15 2011
From: rhunne at mac.com (Robin W Hunnewell)
Date: Tue, 03 May 2011 18:45:15 +0000 (GMT)
Subject: [R-sig-Geo] rgdal installation problem
In-Reply-To: <alpine.LRH.2.00.1105032019330.29392@reclus.nhh.no>
Message-ID: <50d583dc-3e4b-e6ea-ce04-d71f22f825f6@me.com>

Yes, thank you Very much! -- that is just what I needed. For my purposes, the standard drivers for rgdal provided from CRAN will more than meet my needs.

So for the record, I did the following:

> setRepositories(ind=1:2)
> install.packages("rgdal")

And then;

> library(rgdal)
Geospatial Data Abstraction Library extensions to R successfully loaded
Loaded GDAL runtime: GDAL 1.8.0, released 2011/01/12
Path to GDAL shared files: /Users/robinhunnewell/Library/R/2.13/library/rgdal/gdal
Loaded PROJ.4 runtime: Rel. 4.7.1, 23 September 2009
Path to PROJ.4 shared files: /Users/robinhunnewell/Library/R/2.13/library/rgdal/proj

All set now.
Thanks so much,?

Robin


On 03 May, 2011,at 03:22 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:

On Tue, 3 May 2011, Robin W Hunnewell wrote:

> Thank you. ?sorry if this is basic; had just hoped to find a step-by-step 
> guide for Idiots on how to install GDAL and rgdal on OSX.?
>
> I downloaded?the comprehensive GDAL framework?provided by William 
> Kyngesburye:
>
> http://www.kyngchaos.com/
>
> Help and 'read me' files say to install the GDAL?framework with dependencies 
> first, then an rgdal binary from the same?site.
> But I'm not sure how to compile and configure GDAL the right way - so that it 
> gets to the R library and can then be located.
> I'm sure it's just a basic step, but?for someone new to this it's a little 
> confusing..
> Thanks very much for the URL below, will try to work it through

If you do not need drivers other than the standard ones (shapefile, 
geotiff, etc.), within R do only:

setRepositories(ind=1:2)
install.packages("rgdal")

Only use Kyngchaos if you need GDAL and the frameworks for other purposes 
other than rgdal, or if you need extra drivers for rgdal not provided as 
standard from CRAN extras.

Please report back if this meets your needs.

Roger

>
>
>
> On 03 May, 2011,at 02:21 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
> On Tue, 3 May 2011, Robin W Hunnewell wrote:
>
>> Hi,?
>>
>> Could you - or any other mac users who've been successful installing rgdal 
> - 
>> elaborate how you did it??
>
> Usually, OSX users say setRepositories(ind=1:2) to install from CRAN and 
> CRAN extras, where OSX binaries for R 2.13 are provided by Prof. Brian 
> Ripley. The direct URL is:
>
> http://www.stats.ox.ac.uk/pub/RWin/bin/macosx/leopard/contrib/2.13/
>
> This has static GDAL and standard drivers. Kyngchaos now also has an R 
> 2.13 binary, which depends on the frameworks also provided there - it was 
> added recently at user request, and provides a larger number of drivers.
>
> Roger
>
>>
>> I'm trying to install rgdal in my iMac (os X 10.6.7). I have latest Mac R 
>> app. version 2.130?
>> I downloaded the?GDAL framework 1.8 and its dependencies from the kyngchaos 
>> site -- under the GDAL section of the page:?
>>
>> http://www.kyngchaos.com/software/frameworks
>>
>>
>> But not sure the that the installation has put it in the right 
> configuration, 
>> path for loading into R.
>>
>> In R, I installed and loaded library 'sp' ?which rgdal needs..
>>
>> Then tried to install the GDAL package - I go to the R Package 
>> Installer,?select 'Local Binary Package' from the popup, then click 
>> 'Install...'.?
>> I was able to locate and select the rgdal tarball to install and load it 
> for 
>> use in R, but?get error message:
>> 1: 'tar' returned non-zero exit code 1 2: In file.rename(file.path(tmpDir, 
>> pkgname), instPath) :
>> cannot rename file 
>> '/Users/robinhunnewell/Library/R/2.13/library/file3af03e3f/GDAL' to 
>> '/Users/robinhunnewell/Library/R/2.13/library/GDAL', reason 'No such file 
> or 
>> directory'
>> 3: unable to move temporary installation 
>> '/Users/robinhunnewell/Library/R/2.13/library/file3af03e3f/GDAL' to 
>> '/Users/robinhunnewell/Library/R/2.13/library/GDAL' 
>> Is it because GDAL is not in the right place? Thanks v much if anyone can 
>> anyone help!
>> Robin
>>
>> On 02 May, 2011,at 11:23 AM, Christopher Fusting <cfusting at gmail.com> 
> wrote:
>>
>> I had a similar problem. The port under the GDAL section of this page
>> worked for me:
>>
>> http://www.kyngchaos.com/software/frameworks
>>
>> _Chris
>>
>> 2011/5/2 Ant???nio M. Rodrigues <amcrgrodrigues at gmailcom>
>>
>>> Hi,
>>> 
>>> 
>>> I'm trying to instal library rgdal in my macbook (os X 10.6.7).
>>> 
>>> 
>>> I have installed the latest R package (R-2.13.0.pkg).
>>> 
>>> 
>>> I have gdal 1.8 install. Also, I have loaded library sp which rgdal needs.
>>> 
>>> 
>>> I downloaded rdgal_06-33.tgz and using R Package installer, I located and
>>> installed the Local Binary Package.
>>> 
>>> 
>>> When trying to load rgdal ( >library(rgdal)in the R prompt) I get the
>>> error:
>>> 
>>> 
>>> -----
>>> 
>>> Error : onLoad failed in loadNamespace() for 'rgdal', details:
>>> 
>>> call: fun(..)
>>> 
>>> error:
>>> 
>>> GDAL Error 1: dlopen(/Library/Application
>>> Support/GDAL/1.8/PlugIns/gdal_GRASS.dylib, 1): Library not loaded:
>>> /Applications/GRASS-6.4app/Contents/MacOS/lib/libgrass_gis.dylib
>>> 
>>> Referenced from: /Library/Application
>>> Support/GDAL/1.8/PlugIns/gdal_GRASSdylib
>>> 
>>> Reason: image not found
>>> 
>>> 
>>> Error: package/namespace load failed for 'rgdal'
>>> 
>>> -----
>>> 
>>> 
>>> Any help will be much appreciated.
>>> 
>>> thanks,
>>> 
>>> Ant???nio
>>> 
>>> [[alternative HTML version deleted]]
>>> 
>>> 
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> 
>>> 
>>
>>
>>
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110503/82b531cc/attachment.html>

From sa.cizmeli at usherbrooke.ca  Wed May  4 00:30:52 2011
From: sa.cizmeli at usherbrooke.ca (scizmeli)
Date: Tue, 3 May 2011 15:30:52 -0700 (PDT)
Subject: [R-sig-Geo] spacetime : adding a fourth (spectral) dimension
In-Reply-To: <4DB92838.4000901@uni-muenster.de>
References: <1303838148993-6306599.post@n2.nabble.com>
	<4DB92838.4000901@uni-muenster.de>
Message-ID: <1304461852988-6329040.post@n2.nabble.com>

I am reflecting on a data structure that will allow us to perform all kinds
of spectral operations we normally do in remote sensing. Due to lack of an
appropriate data structure supporting spatially based spectral data, right
now we have to keep our data in non-georeferenced N-dimensional arrays. As
for extending spacetime, for now, I can think of an ability to:

* store in the same spacetime object both the spectral and the non-spectral
products (a spectral radiance image cube+computed image layers);
* easily subset ranges of wavelengths (hopefully both by wavelength and band
indexes) and be able to easily perform all kinds of space-time operations on
the subsets;
* select pixels and extract full (or partial) spectra
* easily plot different spectral images in lattice panels (with stplot?) for
a given time
* some channels are usually too noisy so we would need ability to flag some
unwanted channels at some pixels
* store spectral data for point and trajectory measurements
* incrementally import high volumes of data without having to load at once
all the data in memory. Size of spectral image times series can be very
large. On-disk storage can be sought with the use of netcdf technology for
extremely large databases.

and ability to easily implements methods like :

* band-ratio (or all kinds of other arithmetic) operations to compute new
image layers.
* computation of things like spectral derivatives, spectral unmixing as well
as classification algorithms that use spatial/spectral information together
etc.
* overlay ground truth data (ship trajectory/ground truth points/polygons)
onto image time series to match image pixels with ground truth data based on
spatial coordinates and time information (ship trajectories will coincide
with satellite images only at some given days)
* easily plot different spectra (graph of measurement wrt wavelenth) for a
given pixel in panels (or in the same graph) for different times (with
stplot?)
* spectrally interpolate images with a high spectral resolution  to estimate
non-existing channels

There will certainly be dimensions other than "spectral" that people from
other disciplines will want to add in a spacetime object. So, to my mind, it
all boils down to the ability of adding custom dimensions into a spacetime
object (with numeric/string attributes addressable as in 
st[pixel,time,wavelength,otherdimension]

If the upcoming versions of the spacetime package can be designed in such a
way, we could start implementing methods  on spacetime objects for our tasks
in hand and the package would very fast become popular.

Are any these ideas feasible?
Servet

PS: I am definitely ready to help if you think this is a good direction to
go. I never created new object/methods myself but I am committed to learn
pretty fast if some initial directions are given.

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/spacetime-adding-a-fourth-spectral-dimension-tp6306599p6329040.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From romanhornung at web.de  Wed May  4 13:33:38 2011
From: romanhornung at web.de (Roman Hornung)
Date: Wed, 4 May 2011 13:33:38 +0200 (CEST)
Subject: [R-sig-Geo] marked poisson process using a quadrature scheme and
 covariates in 'spatstat'
Message-ID: <824601204.44292.1304508818801.JavaMail.fmail@mwmweb062>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110504/0bdcbae1/attachment.html>

From marcelino.delacruz at upm.es  Wed May  4 14:12:27 2011
From: marcelino.delacruz at upm.es (Marcelino de la Cruz)
Date: Wed, 04 May 2011 14:12:27 +0200
Subject: [R-sig-Geo] marked poisson process using a quadrature scheme
 and covariates in 'spatstat'
In-Reply-To: <824601204.44292.1304508818801.JavaMail.fmail@mwmweb062>
References: <824601204.44292.1304508818801.JavaMail.fmail@mwmweb062>
Message-ID: <201105041212.p44CCULM001727@smtp.upm.es>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110504/4b8b2f63/attachment.pl>

From emmanuel.blondel1 at gmail.com  Wed May  4 15:04:16 2011
From: emmanuel.blondel1 at gmail.com (Emmanuel Blondel (compte gmail pro))
Date: Wed, 04 May 2011 15:04:16 +0200
Subject: [R-sig-Geo] HELP! rgdal installing on WINDOWS ... to read PostGIS
 layers in R (as sp object)
Message-ID: <4DC14ED0.7050303@gmail.com>

Dear all,

I write to look for help about conversion in R of a Postgis layer to a 
sp object. I am working in Windows: Platform: i386-pc-mingw32/i386 (32-bit)

*I could read some emails in the web about how reading a PostGIS layer 
with the rgdal readOGR() function.
My understanding is that I need to install rgdal from source, because 
the windows binary does not support OGR PostgreSQL driver. (not included 
in the list when we enter ogrDrivers() ), but the procedure in Windows 
seem hard to follow

*I tested the GDAL ogrinfo in the MS-DOS command, and the PostgreSQL 
driver runs well so I can easily query my databases.
*Most of emails I could see refer to FWTools. Is it mandatory to use 
FWTools to obtain a complete rgdal package (with PostgreSQL ogrDriver)
If my GDAL is funcional is there a way to built the rgdal package with it?

*What are the pre-requirements? Is it also necessary to built R from source?

I thank you in advance for you answers / guidelines to help me 
installing rgdal (with complete ogrDrivers),

Cheers,
Emmanuel


From amcrgrodrigues at gmail.com  Wed May  4 16:12:55 2011
From: amcrgrodrigues at gmail.com (=?ISO-8859-1?Q?Ant=F3nio_M=2E_Rodrigues?=)
Date: Wed, 4 May 2011 15:12:55 +0100
Subject: [R-sig-Geo] problem with csr {splancs}
Message-ID: <BANLkTinWondZ-TteUPLAn9wjjbRKj-coLQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110504/e75a663e/attachment.pl>

From Roger.Bivand at nhh.no  Wed May  4 18:43:17 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 4 May 2011 18:43:17 +0200 (CEST)
Subject: [R-sig-Geo] problem with csr {splancs}
In-Reply-To: <BANLkTinWondZ-TteUPLAn9wjjbRKj-coLQ@mail.gmail.com>
References: <BANLkTinWondZ-TteUPLAn9wjjbRKj-coLQ@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1105041831280.2301@reclus.nhh.no>

On Wed, 4 May 2011, Ant?nio M. Rodrigues wrote:

> Hi,
>
>
> I need to create a number of random points inside a polygon using car
> {splancs}.
>
>
> Let's say I have a SpatialPolygonsDataFrame with only one polygon, and I
> want to throw 100 points inside randomly.
>
>
> If the object is called poly1, I thought this would work:
>
>
>> csr(poly1,100)

?csr perhaps? "poly: A polygon data set", not a SpatialPolygons object. If 
you do:

data(bodmin)
str(bodmin$poly)

you see that splancs, which is effectively unchanged since written almost 
20 years ago, needs a two-column matrix. In your case, if poly1 is a 
SpatialPolygons object with a single Polygons object, which in turn has a 
single member Polygon object, the polygon for splancs would be:

poly1pl <- slot(slot(slot(poly1, "polygons")[[1]], "Polygons")[[1]],
   "coords")

Perhaps we should start planning for a birthday party for splancs, one of 
the real achievements in S/R and spatial statistics!

Roger

>
>
> But I get the error:
>
>
> Error in `[.data.frame`(x at data, i, j, ..., drop = FALSE) :
>
>  undefined columns selected
>
>
> I thought this might have to do with the class, so I did:
>
>
>> teste <- slot(poly1,"polygons")
>
>
> And tried
>
>> csr(teste,100)
>
>
> Now I get:
>
> Error in poly[, 1] : incorrect number of dimensions
>
>
> I apologise if this is a very simple question.
>
> Thanks in advance,
>
> Ant?nio
>
> 	[[alternative HTML version deleted]]
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From jh.eco.cas at gmail.com  Wed May  4 21:07:12 2011
From: jh.eco.cas at gmail.com (Jianhua Huang)
Date: Wed, 4 May 2011 15:07:12 -0400
Subject: [R-sig-Geo] about robustness analysis
Message-ID: <4dc1a3e0.c126e70a.5827.26ec@mx.google.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110504/e4857a9c/attachment.pl>

From nkkroy3 at gmail.com  Thu May  5 00:18:38 2011
From: nkkroy3 at gmail.com (Nikki roy)
Date: Thu, 5 May 2011 00:18:38 +0200
Subject: [R-sig-Geo] rk.krige map
Message-ID: <BANLkTinN6z16hnn=35H3Km3KJaznA1XiDA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110505/334ace8d/attachment.pl>

From r.turner at auckland.ac.nz  Thu May  5 02:08:26 2011
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Thu, 05 May 2011 12:08:26 +1200
Subject: [R-sig-Geo] marked poisson process using a quadrature scheme
 and covariates in 'spatstat'
In-Reply-To: <824601204.44292.1304508818801.JavaMail.fmail@mwmweb062>
References: <824601204.44292.1304508818801.JavaMail.fmail@mwmweb062>
Message-ID: <4DC1EA7A.9090900@auckland.ac.nz>

On 04/05/11 23:33, Roman Hornung wrote:
> Hello everyone,
>
> My data consists of marked points and several covariates, whereby the 
> marks are the time points of the observations. The problem is, that 
> one of the covariates is hard to handle as an image. This covariate 
> represents the type of roads. As there aren't roads at every location 
> of the map, one cannot specify the value of the covariate at any point 
> on a grid, which is necessary to specify an image. To tackle this, I 
> wanted to use a quadrature scheme and use points on the roads as dummy 
> points instead of a data point pattern as the outcome variable. The 
> problem I now encounter is, that I can't give marks to the dummy 
> points, since they are no "real" observations (and omitting the marks 
> gives an error).
> Does somebody know, what to do in such a situation?
>
> Thank you very much in advance! Any tips are appreciated much!

I am somewhat puzzled by what you are trying to do.  Covariates may be 
used to
model the intensity of a point pattern.  The intensity is defined at 
every point of
the domain of definition of the pattern; in practice it must be defined 
at every
point of the observation window.

So in your case the objective would be to specify the intensity 
"lambda(u)" in terms
of your covariates at every point "u" of your observation window.  You 
say that
one of your covariates is ``type of road''.  Obviously if no road passes 
through "u"
then there is no ``type of road'' ***at*** "u".  So how does the 
intensity at u depend
on ``type of road''?  Clarify that idea, and all of your problems will 
disappear.

One idea, which you may be subconsciously entertaining, is that the 
intensity at
"u" depends on the type of the road nearest to u.  Or it might depend on the
types of all roads weighted in some way by the distance of the roads 
from "u".
Get it clear in your mind first how you want to model the intensity.  Then
build your image, or images, in terms of your roads data in a manner 
consistent
with your modelling criteria.

Note that the distmap() and distfun() functions in "spatstat" will allow 
you to determine the
distance from a given point to the nearest road (if the roads are 
represented as "psp"
objects).

     cheers,

             Rolf Turner


From Roger.Bivand at nhh.no  Thu May  5 08:14:50 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 5 May 2011 08:14:50 +0200 (CEST)
Subject: [R-sig-Geo] Creating listw object from n by n matrix
In-Reply-To: <20110501205005.307900@gmx.net>
References: <20110501205005.307900@gmx.net>
Message-ID: <alpine.LRH.2.00.1105050814060.5212@reclus.nhh.no>

On Sun, 1 May 2011, Sebastian Brandt wrote:

> Dear List,
>
> I have n datsets that I would like to test for spatial dependence using 
> the lm.LMtests function. I have computed a n by n row-standardised 
> spatial weights matrix that I have imported into R workspace from a 
> csv.-file.
>
> Running the lm.LMtests function I get an error message that the n by n 
> matrix is not a listw object. How can I convert the matrix into a listw 
> object?

?mat2listw

All of this is described in detail in ASDAR.

Roger

>
> I would be grateful for any help.
>
> Sebastian
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From jh.eco.cas at gmail.com  Thu May  5 09:07:32 2011
From: jh.eco.cas at gmail.com (Jianhua Huang)
Date: Thu, 5 May 2011 03:07:32 -0400
Subject: [R-sig-Geo] About SARAR
Message-ID: <4dc24cb3.515de70a.5c70.372d@mx.google.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110505/0028ca73/attachment.pl>

From mayeul.kauffmann at jrc.ec.europa.eu  Thu May  5 10:11:16 2011
From: mayeul.kauffmann at jrc.ec.europa.eu (Mayeul KAUFFMANN)
Date: Thu, 05 May 2011 10:11:16 +0200
Subject: [R-sig-Geo] generate alpha band and add it to multispectral image
Message-ID: <1304583076.22582.16.camel@ISFLXMK2>

Hi,
I have a 3 bands (RGB) image and want to add to it an alpha band based
on the value of the other bands (the darker, the less transparent).
Input is: ENVI/ENVI .hdr Labelled.
QuantumGIS does not recognize the alpha band (alpha tag is not set).
When the alpha band is selected manually in Arcgis, the image gets
rendered with spaced hachures/zebra lines; trying to export/print the
map fails (it takes ages while using 5% op one core; I ultimately closed
the process).
Here is my R session:

origin<-brick("my_envi_3_bands_file")
class(origin)
str(origin)
nlayers(origin)
grey<-subset(origin,1)+subset(origin,2)+subset(origin,3)
projection(grey)<-projection(origin) #not sure it is usefull
alpha<-grey
#if gray level was between 200 and 255 , assign (linearly) an alpha
between 0 and 255
alpha[grey <200*3] <- 0 # *3 because we have 3 bands
alpha[grey >=200*3] <- round( ((grey[grey >=200*3]-200*3)*255/55) /3) 
origin_with_alpha<-brick(subset(origin,1),subset(origin,2),subset(origin,3), alpha)
writeRaster(x=origin_with_alpha, filename="output_with_alpha.tif",
format="GTiff")
#######
# I also tried the reverse (assign "255-alpha")
alpha[grey <200*3] <- 255 # *3 because we have 3 bands
alpha[grey >=200*3] <- 255-round( ((grey[grey
>=200*3]-200*3)*255/55) /3) 

The band is correctif in R; I have good results if I do this:
plot(alpha)
hist(alpha)
How can I produce an alpha band that will get correctly interpreted by
GIS software?
Thanks for any hint!
Mayeul


-- 
Dr. Mayeul KAUFFMANN, Conflict Specialist
European Commission, Joint Research Centre (JRC)
Institute for the Protection and Security of the Citizen (IPSC)
Global Security and Crisis Management - ISFEREA
Via E. Fermi 2749 - I-21027 Ispra (VA), ITALY
Phone: (+39) 033278 5071
http://isferea.jrc.ec.europa.eu/Staff/Pages/Kauffmann-Mayeul.aspx

(Office: building 26b, 1st floor, room 140. TP: 267)


From amonleong at wanadoo.es  Thu May  5 16:29:58 2011
From: amonleong at wanadoo.es (TM)
Date: Thu, 5 May 2011 16:29:58 +0200
Subject: [R-sig-Geo] Simulation of multinomial classes covariate
In-Reply-To: <4DC1EA7A.9090900@auckland.ac.nz>
References: <824601204.44292.1304508818801.JavaMail.fmail@mwmweb062>
	<4DC1EA7A.9090900@auckland.ac.nz>
Message-ID: <0D2F7A9C7A5C4B4ABC4884F301CCD1D0@ub.edu>

Hello everyone,

I am looking for a R code to simulate an spatial distribution of multinomial 
classes (like colors classes) in a map.

The problem is find a a multivariate distribution of the color classes 
(covariate: map colors) and a continous variable (like rain or ph) to study 
different kriging (cokriging) methodologies to make cross-validation 
predictions in order to test the effect on prediction which helps solve some 
of the data I now encounter.

Does somebody know, what to do in such a situation?
Does somebody know, what to do treat multinomial classes covariate in 
spacetime models using kriging?

I found this (DCluster package), but I am not sure if my way is wrong:

----------------------------------------------------------------------------------------------
 library(DCluster)

 library(boot)
 library(spdep)

 data(nc.sids)

 sids<-data.frame(Observed=nc.sids$SID74)
 sids<-cbind(sids, 
Expected=nc.sids$BIR74*sum(nc.sids$SID74)/sum(nc.sids$BIR74))
 sids<-cbind(sids, Population=nc.sids$BIR74, x=nc.sids$x, y=nc.sids$y)

 #K&N's method over the centroids
 mle<-calculate.mle(sids, model="poisson")
 knresults<-opgam(data=sids, thegrid=sids[,c("x","y")], alpha=.05,
+  iscluster=kn.iscluster, fractpop=.5, R=100, model="multinomial", mle=mle)

 #Plot all centroids and significant ones in red

 plot(sids$x, sids$y, main="Kulldorff and Nagarwalla's method")
 points(knresults$x, knresults$y, col="red", pch=19)
 dev.off()
-----------------------------------------------------------------------------

Thank you very much in advance! Any tips are appreciated much!

     cheers,

             Toni Monle?n
              UB


From edzer.pebesma at uni-muenster.de  Thu May  5 16:50:37 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 05 May 2011 16:50:37 +0200
Subject: [R-sig-Geo] spacetime : adding a fourth (spectral) dimension
In-Reply-To: <1304461852988-6329040.post@n2.nabble.com>
References: <1303838148993-6306599.post@n2.nabble.com>	<4DB92838.4000901@uni-muenster.de>
	<1304461852988-6329040.post@n2.nabble.com>
Message-ID: <4DC2B93D.6060700@uni-muenster.de>



On 05/04/2011 12:30 AM, scizmeli wrote:
> I am reflecting on a data structure that will allow us to perform all kinds
> of spectral operations we normally do in remote sensing. Due to lack of an
> appropriate data structure supporting spatially based spectral data, right
> now we have to keep our data in non-georeferenced N-dimensional arrays. As
> for extending spacetime, for now, I can think of an ability to:
> 
> * store in the same spacetime object both the spectral and the non-spectral
> products (a spectral radiance image cube+computed image layers);

You can do that already.

> * easily subset ranges of wavelengths (hopefully both by wavelength and band
> indexes) and be able to easily perform all kinds of space-time operations on
> the subsets;

you can by number and name, not by wavelength. An issue to consider is
that wavelengths for bands are typically intervals, so selecting a range
of values, say 500-600 nm, is ambiguous about whether to include a band
with range 490-510 yes or no. It would not be that hard to
implement; xts lets you select by time range, e.g. "2006" will select
all observations in that year.

> * select pixels and extract full (or partial) spectra

If you mean pixels in space-time, you can, sort of, do that; some
manipulation may be needed for the result to be understood as a
spectrum, and plotted nicely.

> * easily plot different spectral images in lattice panels (with stplot?) for
> a given time

This would not be too hard.

> * some channels are usually too noisy so we would need ability to flag some
> unwanted channels at some pixels
> * store spectral data for point and trajectory measurements

That is foreseen in the next few months.

> * incrementally import high volumes of data without having to load at once
> all the data in memory. Size of spectral image times series can be very
> large. On-disk storage can be sought with the use of netcdf technology for
> extremely large databases.

This was identified as one of the priorities on the workshop we
organized last March (www.opengeostatistics.org). I'm not sure how
fast such a feature will arrive.

> 
> and ability to easily implements methods like :
> 
> * band-ratio (or all kinds of other arithmetic) operations to compute new
> image layers.
> * computation of things like spectral derivatives, spectral unmixing as well
> as classification algorithms that use spatial/spectral information together
> etc.
> * overlay ground truth data (ship trajectory/ground truth points/polygons)
> onto image time series to match image pixels with ground truth data based on
> spatial coordinates and time information (ship trajectories will coincide
> with satellite images only at some given days)
> * easily plot different spectra (graph of measurement wrt wavelenth) for a
> given pixel in panels (or in the same graph) for different times (with
> stplot?)
> * spectrally interpolate images with a high spectral resolution  to estimate
> non-existing channels
> 
> There will certainly be dimensions other than "spectral" that people from
> other disciplines will want to add in a spacetime object. So, to my mind, it
> all boils down to the ability of adding custom dimensions into a spacetime
> object (with numeric/string attributes addressable as in 
> st[pixel,time,wavelength,otherdimension]
> 
> If the upcoming versions of the spacetime package can be designed in such a
> way, we could start implementing methods  on spacetime objects for our tasks
> in hand and the package would very fast become popular.
> 
> Are any these ideas feasible?

I think so. What is lacking is a large amount of enthousiasm,
use cases, and programming efforts!

> Servet
> 
> PS: I am definitely ready to help if you think this is a good direction to
> go. I never created new object/methods myself but I am committed to learn
> pretty fast if some initial directions are given.

O.K.; then I'd recommmend the book "S programming", or something
similar, to get up to speed, or one of John Chambers' books on
R programming.

Best wihses,

> 
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/spacetime-adding-a-fourth-spectral-dimension-tp6306599p6329040.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From romanhornung at web.de  Thu May  5 17:10:30 2011
From: romanhornung at web.de (Roman Hornung)
Date: Thu, 5 May 2011 17:10:30 +0200 (CEST)
Subject: [R-sig-Geo] marked poisson process using a quadrature scheme
 and covariates in 'spatstat'
Message-ID: <428146610.372700.1304608230072.JavaMail.fmail@mwmweb063>

Thank you both very much!

Some more details on the data: The individual roads are most of the time represented by more than two points. The road data consists of about 800000 points representing around 75000 roads.
I tried to convert it to a linnet-object, but got the error (translated): "error in matrix(FALSE, np, np): too many elements specified", even when I set the memory limit to the maximal possible value (on a 32-bit computer).
So I must probably give up that approach.
I must admit, I wasn't really aware, that the intensity is not defined at locations with no roads passing through. However maybe, it is negligible, that the events can only occur on roads and that there are "gaps" in the prediction, since the network of roads is very dense.
What to you think? All the other covariate are proper spatial covariates, so it would be approriate to use a spatial poisson process.

Marcelino, you wrote:
"By the way, instead of a quadrature? scheme you could also use

rsyst to generate directly a grided ppp with "real"
observations and then mark the points? at will."

Does that mean, it is irrelevant for estimation, which marks points have, that aren't at locations, where
the target variable is observed?
In the latter case, I would be able to use the quadrature scheme nevertheless, with dummy points on the roads and random marks, thereby circumventing the problem of converting the road data to an image.

However I noticed, that ppm doesn't allow continuous marks in the trend formula. Is there any other package that could handle this?
Perhaps I could use the code of the corresponding function of such a package to modify the ppm-function in spatstat. Otherwise, if unavoidable, I would have to discretize the daytime.

Regards
Roman


-----Urspr?ngliche Nachricht-----
Von: "Rolf Turner" <r.turner at auckland.ac.nz>
Gesendet: 05.05.2011 02:08:26
An: "Roman Hornung" <romanhornung at web.de>
Betreff: Re: [R-sig-Geo] marked poisson process using a quadrature scheme and covariates in 'spatstat'

>On 04/05/11 23:33, Roman Hornung wrote:
>> Hello everyone,
>>
>> My data consists of marked points and several covariates, whereby the
>> marks are the time points of the observations. The problem is, that
>> one of the covariates is hard to handle as an image. This covariate
>> represents the type of roads. As there aren't roads at every location
>> of the map, one cannot specify the value of the covariate at any point
>> on a grid, which is necessary to specify an image. To tackle this, I
>> wanted to use a quadrature scheme and use points on the roads as dummy
>> points instead of a data point pattern as the outcome variable. The
>> problem I now encounter is, that I can't give marks to the dummy
>> points, since they are no "real" observations (and omitting the marks
>> gives an error).
>> Does somebody know, what to do in such a situation?
>>
>> Thank you very much in advance! Any tips are appreciated much!
>
>I am somewhat puzzled by what you are trying to do. Covariates may be
>used to
>model the intensity of a point pattern. The intensity is defined at
>every point of
>the domain of definition of the pattern; in practice it must be defined
>at every
>point of the observation window.
>
>So in your case the objective would be to specify the intensity
>"lambda(u)" in terms
>of your covariates at every point "u" of your observation window. You
>say that
>one of your covariates is ``type of road''. Obviously if no road passes
>through "u"
>then there is no ``type of road'' ***at*** "u". So how does the
>intensity at u depend
>on ``type of road''? Clarify that idea, and all of your problems will
>disappear.
>
>One idea, which you may be subconsciously entertaining, is that the
>intensity at
>"u" depends on the type of the road nearest to u. Or it might depend on the
>types of all roads weighted in some way by the distance of the roads
>from "u".
>Get it clear in your mind first how you want to model the intensity. Then
>build your image, or images, in terms of your roads data in a manner
>consistent
>with your modelling criteria.
>
>Note that the distmap() and distfun() functions in "spatstat" will allow
>you to determine the
>distance from a given point to the nearest road (if the roads are
>represented as "psp"
>objects).
>
> cheers,
>
> Rolf Turner


From marcelino.delacruz at upm.es  Thu May  5 20:59:54 2011
From: marcelino.delacruz at upm.es (Marcelino de la Cruz)
Date: Thu, 05 May 2011 20:59:54 +0200
Subject: [R-sig-Geo] marked poisson process using a quadrature scheme
 and covariates in 'spatstat'
In-Reply-To: <428146610.372700.1304608230072.JavaMail.fmail@mwmweb063>
References: <428146610.372700.1304608230072.JavaMail.fmail@mwmweb063>
Message-ID: <201105051859.p45IxxLj012046@smtp.upm.es>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110505/909682a7/attachment.pl>

From Marie-Line.Glaesener at uni.lu  Thu May  5 21:55:17 2011
From: Marie-Line.Glaesener at uni.lu (Marie-Line Glaesener)
Date: Thu, 5 May 2011 19:55:17 +0000
Subject: [R-sig-Geo] Instrumental variable quantile estimation of spatial
 autoregressive models
Message-ID: <99D322B6F7951F468D4788B2CB077C7B0BD10BD2@trip.uni.lux>

Dear all,

I would like to implement a spatial quantile regression using instrumental variable estimation (according to Su and Yang (2007), Instrumental variable quantile estimation of spatial autoregressive models, SMU economics & statistis working paper series, 2007, 05-2007, p.35 ).

I am applying the hedonic pricing method on land transactions in Luxembourg.  My original data set contains 4335 observations.
I'm quite new to R and would like to ask if someone has implemented the method proposed by Su and Yang in R or if anyone could give me a hint on the different codes and steps?
Please find attached a small sample of my data and matrix.
R codes:

library(foreign)
library(lmtest)
library(spdep)
library(quantreg)

data<-read.table("DataSample.txt",header=TRUE, sep="")
attach(data)

matrix<-read.gwt2nb("matrixsample.gwt" ,region.id=no_Trans)
matrix.listw<-nb2listw(matrix)

OLS model
OLS<-lm(lnprice~surface+d2007+LUX+tsect_ci, data=data)
summary(OLS)

SAR model
SAR<-lagsarlm(lnprice~surface+d2007+LUX+tsect_ci, data=data, listw = matrix.listw)
summary(SAR)

I hope that this information is sufficient and will help you to help me :)

Many thanks in advance,

Marie-Line Glaesener

PhD student
Unit? de Recherche IPSE (Identit?s. Politiques, Soci?t?s, Espaces)
Laboratoire de G?ographie et Am?nagement du Territoire

UNIVERSIT? DU LUXEMBOURG
CAMPUS WALFERDANGE
Route de Diekirch / BP 2
L-7201 Walferdange
Luxembourg
www.geo.ipse.uni.lu<http://www.geo.ipse.uni.lu/>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110505/e7955ac4/attachment.html>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: DataSample.txt
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110505/e7955ac4/attachment.txt>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Matrixsample.gwt
Type: application/octet-stream
Size: 171 bytes
Desc: Matrixsample.gwt
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110505/e7955ac4/attachment.obj>

From wangguocheng1986 at gmail.com  Fri May  6 12:56:09 2011
From: wangguocheng1986 at gmail.com (=?GB2312?B?zfW5+rPJ?=)
Date: Fri, 6 May 2011 20:56:09 +1000
Subject: [R-sig-Geo] how to change provincial boundaries and combine two
	regions
Message-ID: <BANLkTikM8LVoYw3fyr7hDRmh_ciT3eGZ_Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110506/e884dc32/attachment.pl>

From wangguocheng1986 at gmail.com  Fri May  6 13:02:54 2011
From: wangguocheng1986 at gmail.com (=?GB2312?B?zfW5+rPJ?=)
Date: Fri, 6 May 2011 21:02:54 +1000
Subject: [R-sig-Geo] How to change regional boundaries and combine two
	regions together
Message-ID: <BANLkTi=pJiGqw+M+R=PYGqg4eXbXG9Cdkg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110506/03367897/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Fri May  6 13:46:30 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Fri, 6 May 2011 12:46:30 +0100
Subject: [R-sig-Geo] how to change provincial boundaries and combine two
	regions
In-Reply-To: <BANLkTikM8LVoYw3fyr7hDRmh_ciT3eGZ_Q@mail.gmail.com>
References: <BANLkTikM8LVoYw3fyr7hDRmh_ciT3eGZ_Q@mail.gmail.com>
Message-ID: <BANLkTi=sCupLFjrBdk2vUKWwk-cKJX_yRQ@mail.gmail.com>

On Fri, May 6, 2011 at 11:56 AM, ??? <wangguocheng1986 at gmail.com> wrote:
> Hi, all
> I recently have a problem about Chinese map drawing. The original code as
> follows:
>
> *library(maps)
> library(mapdata)
> map('china')*
>
> This is a China map with provincial boundaries. First, how to change the
> boundaries into dashed lines? Second, how to combine two regions (like Xin
> Jiang and Tibet) together and create a new bold boundary of this new region
> combined by Xin Jiang and Tibet?

 ?map says:

     ...: Extra arguments passed to ?polygon? or ?lines?.

 and if you read ?lines and ?polygon you'll see that dashed lines can
be drawn using the lty parameter.

map("china",lty=2) will get you dashed lines.

 Your second question is a bit harder. The china data in the mapdata
package seems to not have the region names, and merging regions from
maps package data format might be a bit tricky.

 Try getting China map data in shapefile or RData format from
www.gadm.org - then you can merge areas using some of the functions of
the sp package, or you can do it interactively using a GIS - I
recommend Quantum GIS as a free, open-source package which can do this
kind of editing very easily.

Barry


From research at georgruss.de  Fri May  6 21:17:03 2011
From: research at georgruss.de (Georg =?iso-8859-15?B?UnXf?=)
Date: Fri, 6 May 2011 21:17:03 +0200
Subject: [R-sig-Geo] Spatially constrained hierarchical clustering, any news?
Message-ID: <20110506191702.GC29082@greode>

Hi List,

is there any news regarding a spatially constrained hierarchical
clustering algorithm implementation in R?

I found this post from 2005
http://finzi.psych.upenn.edu/R/Rhelp02a/archive/56819.html
but nothing that really helped. 

I also found the package 'rioja'
http://cran.r-project.org/web/packages/rioja/rioja.pdf which contains some
constrained hierarchical clustering but that's not what I needed. I'd like
something with the interface of 'hclust' (read: dissimilarity matrix) but
which also allows in each step of the clustering to specify somehow which
of the clusters must not be merged.

Before I start digging into the hclust sources, I thought I'd rather ask.

Regards,
Georg.
-- 
Research Assistant
Otto-von-Guericke-Universit?t Magdeburg
research at georgruss.de
http://research.georgruss.de


From wangguocheng1986 at gmail.com  Sat May  7 00:20:03 2011
From: wangguocheng1986 at gmail.com (=?GB2312?B?zfW5+rPJ?=)
Date: Sat, 7 May 2011 08:20:03 +1000
Subject: [R-sig-Geo] how to change provincial boundaries and combine two
	regions
In-Reply-To: <BANLkTi=sCupLFjrBdk2vUKWwk-cKJX_yRQ@mail.gmail.com>
References: <BANLkTikM8LVoYw3fyr7hDRmh_ciT3eGZ_Q@mail.gmail.com>
	<BANLkTi=sCupLFjrBdk2vUKWwk-cKJX_yRQ@mail.gmail.com>
Message-ID: <BANLkTikEmhQd8ju1FFeBzhTnigW4hhhxxg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110507/90e04d5c/attachment.pl>

From jelewis02 at gmail.com  Sun May  8 14:54:43 2011
From: jelewis02 at gmail.com (john lewis)
Date: Sun, 8 May 2011 08:54:43 -0400
Subject: [R-sig-Geo] missing
Message-ID: <BANLkTi=nUfg4AEg7LXGEboJnvmcCc0WWuQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110508/0c414857/attachment.pl>

From alobolistas at gmail.com  Sun May  8 18:50:36 2011
From: alobolistas at gmail.com (Agustin Lobo)
Date: Sun, 8 May 2011 18:50:36 +0200
Subject: [R-sig-Geo] raster or rgdal: problem with geometry of tif + tifw
	file
Message-ID: <BANLkTi=XPdD09whb66wM4nS57b4W6174Yg@mail.gmail.com>

Hi!

I read a tif fle (with a companion tifw file) for which gdalinfo states:

alobo at alobo-laptop:/media/TRANSCEND2/VegcamPro/MATA20090729/Proc2$
gdalinfo SDIM0114.tif
Warning 1: TIFFReadDirectory:Unknown field with tag 37717 (0x9355) encountered
Driver: GTiff/GeoTIFF
Files: SDIM0114.tif
Size is 2640, 1760
Coordinate System is `'
GeoTransform =
  445548.7745816645, -0.109570548549058, 0.216912817625298
  4628418.279379116, 0.216912817625298, 0.109570548549058
Metadata:
  TIFFTAG_SOFTWARE=SIGMA Photo Pro 3.5.2.0000
  TIFFTAG_DATETIME=2010:02:27 15:40:55
  TIFFTAG_XRESOLUTION=180
  TIFFTAG_YRESOLUTION=180
  TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)
Image Structure Metadata:
  INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  (  445548.775, 4628418.279)
Lower Left  (  445930.541, 4628611.124)
Upper Right (  445259.508, 4628990.929)
Lower Right (  445641.275, 4629183.773)
Center      (  445595.025, 4628801.026)


Then I read it in R:
> test= brick("/media/TRANSCEND2/VegcamPro/MATA20090729/TIFFOri/SDIM0114.tif")
> show(test)
class       : RasterBrick
dimensions  : 1760, 2640, 3  (nrow, ncol, nlayers)
resolution  : 0.1095705, 0.1095705  (x, y)
extent      : 445548.8, 445838, 4628418, 4628611  (xmin, xmax, ymin, ymax)
projection  : NA
values      : /media/TRANSCEND2/VegcamPro/MATA20090729/TIFFOri/SDIM0114.tif
min values  : 0 0 0
max values  : 65535 65535 65535

and write it back to disk:

> writeRaster(test,file="test.tif", format="GTiff", overwrite=TRUE,datatype='FLT8S')

But gdalinfo states a different bounding box for the new file:
alobo at alobo-laptop:/media/TRANSCEND2/VegcamPro/MATA20090729/Proc2$
gdalinfo test.tif
Driver: GTiff/GeoTIFF
Files: test.tif
Size is 2640, 1760
Coordinate System is `'
Origin = (445548.774581664009020,4628611.233115110546350)
Pixel Size = (0.109570548549241,-0.109570548548469)
Image Structure Metadata:
  COMPRESSION=LZW
  INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  (  445548.775, 4628611.233)
Lower Left  (  445548.775, 4628418.389)
Upper Right (  445838.041, 4628611.233)
Lower Right (  445838.041, 4628418.389)
Center      (  445693.408, 4628514.811)
.../...

Somehow the geometric properties are modified in R

I've made a single geotif file with gdal_transform (no tifw created)
and read it in R in the same way and get the same result, so the
problem does not come
from using a tifw file as I initially thought.

Perhaps a bug in brick() ?

Thanks

Agus

Files:
http://dl.dropbox.com/u/3180464/SDIM0114.tif
http://dl.dropbox.com/u/3180464/SDIM0114.tifw

> sessionInfo()
R version 2.13.0 (2011-04-13)
Platform: i486-pc-linux-gnu (32-bit)

locale:
 [1] LC_CTYPE=en_US.UTF-8          LC_NUMERIC=C
LC_TIME=en_US.UTF-8
 [4] LC_COLLATE=en_US.UTF-8        LC_MONETARY=en_US.UTF-8
LC_MESSAGES=en_US.UTF-8
 [7] LC_PAPER=en_US.UTF-8          LC_NAME=en_US.UTF-8
LC_ADDRESS=en_US.UTF-8
[10] LC_TELEPHONE=en_US.UTF-8      LC_MEASUREMENT=en_US.UTF-8
LC_IDENTIFICATION=en_US.UTF-8

attached base packages:
[1] grid      stats     graphics  grDevices utils     datasets
methods   base

other attached packages:
[1] gridExtra_0.7 ggplot2_0.8.8 rgdal_0.6-31  raster_1.8-15 sp_0.9-72
   reshape_0.8.3
[7] plyr_1.2.1    proto_0.3-8   rkward_0.5.6

loaded via a namespace (and not attached):
[1] lattice_0.19-26 tools_2.13.0


From r.hijmans at gmail.com  Sun May  8 21:04:56 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sun, 8 May 2011 12:04:56 -0700
Subject: [R-sig-Geo] raster or rgdal: problem with geometry of tif +
	tifw file
In-Reply-To: <BANLkTi=XPdD09whb66wM4nS57b4W6174Yg@mail.gmail.com>
References: <BANLkTi=XPdD09whb66wM4nS57b4W6174Yg@mail.gmail.com>
Message-ID: <BANLkTikN8c=niqF5-WhrHewXHVbmODWkuw@mail.gmail.com>

Hi Agus,

The problem is that you raster is rotated (GeoTransform[3] and [5] are not zero)

GeoTransform =
 445548.7745816645, -0.109570548549058, 0.216912817625298
 4628418.279379116, 0.216912817625298, 0.109570548549058

raster ignored the rotation. I have fixed that (in version 1-8-19) by
throwing an error for such a file.

readGDAL will read the file, but as points (SpatialPointsDataFrame),
which you could interpolate to a non-rotated raster. I do not plan to
support such files in raster, but I might include a function for
memory-safe transformation to a non-rotated file.

Thanks for catching & reporting this,

Robert


On Sun, May 8, 2011 at 9:50 AM, Agustin Lobo <alobolistas at gmail.com> wrote:
> Hi!
>
> I read a tif fle (with a companion tifw file) for which gdalinfo states:
>
> alobo at alobo-laptop:/media/TRANSCEND2/VegcamPro/MATA20090729/Proc2$
> gdalinfo SDIM0114.tif
> Warning 1: TIFFReadDirectory:Unknown field with tag 37717 (0x9355) encountered
> Driver: GTiff/GeoTIFF
> Files: SDIM0114.tif
> Size is 2640, 1760
> Coordinate System is `'
> GeoTransform =
> ?445548.7745816645, -0.109570548549058, 0.216912817625298
> ?4628418.279379116, 0.216912817625298, 0.109570548549058
> Metadata:
> ?TIFFTAG_SOFTWARE=SIGMA Photo Pro 3.5.2.0000
> ?TIFFTAG_DATETIME=2010:02:27 15:40:55
> ?TIFFTAG_XRESOLUTION=180
> ?TIFFTAG_YRESOLUTION=180
> ?TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)
> Image Structure Metadata:
> ?INTERLEAVE=PIXEL
> Corner Coordinates:
> Upper Left ?( ?445548.775, 4628418.279)
> Lower Left ?( ?445930.541, 4628611.124)
> Upper Right ( ?445259.508, 4628990.929)
> Lower Right ( ?445641.275, 4629183.773)
> Center ? ? ?( ?445595.025, 4628801.026)
>
>
> Then I read it in R:
>> test= brick("/media/TRANSCEND2/VegcamPro/MATA20090729/TIFFOri/SDIM0114.tif")
>> show(test)
> class ? ? ? : RasterBrick
> dimensions ?: 1760, 2640, 3 ?(nrow, ncol, nlayers)
> resolution ?: 0.1095705, 0.1095705 ?(x, y)
> extent ? ? ?: 445548.8, 445838, 4628418, 4628611 ?(xmin, xmax, ymin, ymax)
> projection ?: NA
> values ? ? ?: /media/TRANSCEND2/VegcamPro/MATA20090729/TIFFOri/SDIM0114.tif
> min values ?: 0 0 0
> max values ?: 65535 65535 65535
>
> and write it back to disk:
>
>> writeRaster(test,file="test.tif", format="GTiff", overwrite=TRUE,datatype='FLT8S')
>
> But gdalinfo states a different bounding box for the new file:
> alobo at alobo-laptop:/media/TRANSCEND2/VegcamPro/MATA20090729/Proc2$
> gdalinfo test.tif
> Driver: GTiff/GeoTIFF
> Files: test.tif
> Size is 2640, 1760
> Coordinate System is `'
> Origin = (445548.774581664009020,4628611.233115110546350)
> Pixel Size = (0.109570548549241,-0.109570548548469)
> Image Structure Metadata:
> ?COMPRESSION=LZW
> ?INTERLEAVE=PIXEL
> Corner Coordinates:
> Upper Left ?( ?445548.775, 4628611.233)
> Lower Left ?( ?445548.775, 4628418.389)
> Upper Right ( ?445838.041, 4628611.233)
> Lower Right ( ?445838.041, 4628418.389)
> Center ? ? ?( ?445693.408, 4628514.811)
> .../...
>
> Somehow the geometric properties are modified in R
>
> I've made a single geotif file with gdal_transform (no tifw created)
> and read it in R in the same way and get the same result, so the
> problem does not come
> from using a tifw file as I initially thought.
>
> Perhaps a bug in brick() ?
>
> Thanks
>
> Agus
>
> Files:
> http://dl.dropbox.com/u/3180464/SDIM0114.tif
> http://dl.dropbox.com/u/3180464/SDIM0114.tifw
>
>> sessionInfo()
> R version 2.13.0 (2011-04-13)
> Platform: i486-pc-linux-gnu (32-bit)
>
> locale:
> ?[1] LC_CTYPE=en_US.UTF-8 ? ? ? ? ?LC_NUMERIC=C
> LC_TIME=en_US.UTF-8
> ?[4] LC_COLLATE=en_US.UTF-8 ? ? ? ?LC_MONETARY=en_US.UTF-8
> LC_MESSAGES=en_US.UTF-8
> ?[7] LC_PAPER=en_US.UTF-8 ? ? ? ? ?LC_NAME=en_US.UTF-8
> LC_ADDRESS=en_US.UTF-8
> [10] LC_TELEPHONE=en_US.UTF-8 ? ? ?LC_MEASUREMENT=en_US.UTF-8
> LC_IDENTIFICATION=en_US.UTF-8
>
> attached base packages:
> [1] grid ? ? ?stats ? ? graphics ?grDevices utils ? ? datasets
> methods ? base
>
> other attached packages:
> [1] gridExtra_0.7 ggplot2_0.8.8 rgdal_0.6-31 ?raster_1.8-15 sp_0.9-72
> ? reshape_0.8.3
> [7] plyr_1.2.1 ? ?proto_0.3-8 ? rkward_0.5.6
>
> loaded via a namespace (and not attached):
> [1] lattice_0.19-26 tools_2.13.0
>


From michael.denslow at gmail.com  Sun May  8 21:43:07 2011
From: michael.denslow at gmail.com (Michael Denslow)
Date: Sun, 8 May 2011 15:43:07 -0400
Subject: [R-sig-Geo] Help with GeoRSS
Message-ID: <BANLkTim5jQnDvy182pZFjuGhUeoCrYXsmA@mail.gmail.com>

Hello Everyone,

I am trying to read a GeoRSS file using library rgdal and can't seem
to get it to work. I suspect that it is because I am not specifying
the layer = argument correctly (or the dsn). Am I missing something
obvious? I am not clear what goes into this argument for this type of
file.

Some sample code:

library(rgdal)
# says GeoRSS TRUE
ogrDrivers()
getGDALVersionInfo()
# [1] "GDAL 1.8.0, released 2011/01/12"

# ERROR says 'GDAL Error 4: Failed to read GeoJSON data'
ogrInfo(dsn='http://earthquake.usgs.gov/earthquakes/catalogs/eqs7day-M5.xml',
	layer = 'USGS M 5+ Earthquakes')


Additionally, I am not sure why GDAL thinks the file is a GeoJSON. I also tried:

# OGRGeoJSON is apparently the predefined layer name
ogrInfo(dsn='http://earthquake.usgs.gov/earthquakes/catalogs/eqs7day-M5.xml',
	layer = 'OGRGeoJSON')


Thanks in advance for any help you can provide,
Michael

> sessionInfo()
R version 2.12.1 (2010-12-16)
Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)

locale:
[1] en_US.UTF-8/en_US.UTF-8/C/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] rgdal_0.6-33 sp_0.9-80

loaded via a namespace (and not attached):
[1] grid_2.12.1     lattice_0.19-17 tools_2.12.1

-- 
Michael Denslow
Adjunct Instructor
Department of Geography and Planning
P.O. Box 32066
Appalachian State University
Boone, North Carolina 28608
-- AND --
Communications Manager
Southeast Regional Network of Expertise and Collections
sernec.org

36.214177, -81.681480 +/- 3103 meters


From b.rowlingson at lancaster.ac.uk  Mon May  9 00:41:39 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Sun, 8 May 2011 23:41:39 +0100
Subject: [R-sig-Geo] Help with GeoRSS
In-Reply-To: <BANLkTim5jQnDvy182pZFjuGhUeoCrYXsmA@mail.gmail.com>
References: <BANLkTim5jQnDvy182pZFjuGhUeoCrYXsmA@mail.gmail.com>
Message-ID: <BANLkTikjBTW6_Fsrtv602N7gNMvJpLBUnA@mail.gmail.com>

On Sun, May 8, 2011 at 8:43 PM, Michael Denslow
<michael.denslow at gmail.com> wrote:
> Hello Everyone,
>
> I am trying to read a GeoRSS file using library rgdal and can't seem
> to get it to work. I suspect that it is because I am not specifying
> the layer = argument correctly (or the dsn). Am I missing something
> obvious? I am not clear what goes into this argument for this type of
> file.
>
> Some sample code:
>
> library(rgdal)
> # says GeoRSS TRUE
> ogrDrivers()
> getGDALVersionInfo()
> # [1] "GDAL 1.8.0, released 2011/01/12"
>
> # ERROR says 'GDAL Error 4: Failed to read GeoJSON data'
> ogrInfo(dsn='http://earthquake.usgs.gov/earthquakes/catalogs/eqs7day-M5.xml',
> ? ? ? ?layer = 'USGS M 5+ Earthquakes')
>
>
> Additionally, I am not sure why GDAL thinks the file is a GeoJSON. I also tried:
>
> # OGRGeoJSON is apparently the predefined layer name
> ogrInfo(dsn='http://earthquake.usgs.gov/earthquakes/catalogs/eqs7day-M5.xml',
> ? ? ? ?layer = 'OGRGeoJSON')
>

My rgdal doesnt have geoRSS, but my command line ogrinfo says there's
one layer in the file, called 'georss', and if I get that layer info
it seems to work (note I've downloaded the XML file to my working
directory - maybe this fails as a URL...):

$ ogrinfo  eqs7day-M5.xml
Had to open data source read-only.
INFO: Open of `eqs7day-M5.xml'
      using driver `GeoRSS' successful.
1: georss (Point)


$ ogrinfo  eqs7day-M5.xml georss
Had to open data source read-only.
INFO: Open of `eqs7day-M5.xml'
      using driver `GeoRSS' successful.

Layer name: georss
Geometry: Point
Feature Count: 35

[here come the features]


So try layer="georss" in your ogrInfo (and hence readOGR) call...

Barry


From b.rowlingson at lancaster.ac.uk  Mon May  9 00:45:27 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Sun, 8 May 2011 23:45:27 +0100
Subject: [R-sig-Geo] Help with GeoRSS
In-Reply-To: <BANLkTikjBTW6_Fsrtv602N7gNMvJpLBUnA@mail.gmail.com>
References: <BANLkTim5jQnDvy182pZFjuGhUeoCrYXsmA@mail.gmail.com>
	<BANLkTikjBTW6_Fsrtv602N7gNMvJpLBUnA@mail.gmail.com>
Message-ID: <BANLkTimB0Owa-Xr9w0Ax_cJN6w=RACQ4Ag@mail.gmail.com>

On Sun, May 8, 2011 at 11:41 PM, Barry Rowlingson
<b.rowlingson at lancaster.ac.uk> wrote:

> My rgdal doesnt have geoRSS, but my command line ogrinfo says there's
> one layer in the file, called 'georss', and if I get that layer info
> it seems to work (note I've downloaded the XML file to my working
> directory - maybe this fails as a URL...):

 Just tried it with the URL and got similar errors to you. OGR can't
read geoRSS from a URL:

http://www.gdal.org/ogr/drv_georss.html

so it tries geoJSON:

http://www.gdal.org/ogr/drv_geojson.html

 which can take a URL.

Barry


From michael.denslow at gmail.com  Mon May  9 02:57:51 2011
From: michael.denslow at gmail.com (Michael Denslow)
Date: Sun, 8 May 2011 20:57:51 -0400
Subject: [R-sig-Geo] Help with GeoRSS
In-Reply-To: <BANLkTimB0Owa-Xr9w0Ax_cJN6w=RACQ4Ag@mail.gmail.com>
References: <BANLkTim5jQnDvy182pZFjuGhUeoCrYXsmA@mail.gmail.com>
	<BANLkTikjBTW6_Fsrtv602N7gNMvJpLBUnA@mail.gmail.com>
	<BANLkTimB0Owa-Xr9w0Ax_cJN6w=RACQ4Ag@mail.gmail.com>
Message-ID: <BANLkTi=0vsturyT4sB=tkA4C_D8mSQywjw@mail.gmail.com>

On Sun, May 8, 2011 at 6:45 PM, Barry Rowlingson
<b.rowlingson at lancaster.ac.uk> wrote:
> On Sun, May 8, 2011 at 11:41 PM, Barry Rowlingson
> <b.rowlingson at lancaster.ac.uk> wrote:
>
>> My rgdal doesnt have geoRSS, but my command line ogrinfo says there's
>> one layer in the file, called 'georss', and if I get that layer info
>> it seems to work (note I've downloaded the XML file to my working
>> directory - maybe this fails as a URL...):
>
> ?Just tried it with the URL and got similar errors to you. OGR can't
> read geoRSS from a URL:
>
> http://www.gdal.org/ogr/drv_georss.html
>
> so it tries geoJSON:
>
> http://www.gdal.org/ogr/drv_geojson.html
>
> ?which can take a URL.
>
> Barry
>

Thanks Barry,
It does indeed work if I download the file a specify layer = 'georss'.

Michael

P.S. I was thinking that it might be possible to directly read the xml
file using library(XML) but it seems that it has to be saved to a file
this way as well....

library(XML)
library(rgdal)

xmlTest <- xmlTreeParse('http://earthquake.usgs.gov/earthquakes/catalogs/eqs1hour-M1.xml')

# this seems to be the part I need
xmlTest$doc$children$rss
# save the XML
saveXML(xmlTest$doc$children$rss, file='/Users/michael/Desktop/out.xml')
# get info
ogrInfo(dsn='/Users/michael/Desktop/out.xml',layer='georss')


-- 
Michael Denslow
Adjunct Instructor
Department of Geography and Planning
P.O. Box 32066
Appalachian State University
Boone, North Carolina 28608
-- AND --
Communications Manager
Southeast Regional Network of Expertise and Collections
sernec.org

36.214177, -81.681480 +/- 3103 meters


From pascaltitle at gmail.com  Mon May  9 07:18:06 2011
From: pascaltitle at gmail.com (Pascal Title)
Date: Sun, 8 May 2011 22:18:06 -0700
Subject: [R-sig-Geo] polygon buffer
Message-ID: <BANLkTim=ACbZHe36FeB_j7HonBfy1fbAFg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110508/7b1ba396/attachment.pl>

From rundel at gmail.com  Mon May  9 07:46:11 2011
From: rundel at gmail.com (rundel)
Date: Sun, 8 May 2011 22:46:11 -0700 (PDT)
Subject: [R-sig-Geo] polygon buffer
In-Reply-To: <BANLkTim=ACbZHe36FeB_j7HonBfy1fbAFg@mail.gmail.com>
References: <BANLkTim=ACbZHe36FeB_j7HonBfy1fbAFg@mail.gmail.com>
Message-ID: <1304919971503-6343195.post@n2.nabble.com>

You can do this with rgeos and the gBuffer function. The package is available
on cran as a binary for windows or can be installed from source on OSX or
linux if you have the geos library installed.

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/polygon-buffer-tp6343166p6343195.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From amonleong at wanadoo.es  Mon May  9 09:09:36 2011
From: amonleong at wanadoo.es (TM)
Date: Mon, 9 May 2011 09:09:36 +0200
Subject: [R-sig-Geo] multinomial classes color maps
Message-ID: <553A9B3CC9F04DCB85CDD8D4C198C0C8@ub.edu>


Hello everyone,

I am looking for a R code to simulate an spatial distribution of multinomial
classes (like colors classes) in a map.

The problem is find a a multivariate distribution of the color classes
(covariate: color maps) and a continous variable (like rain or PH) to study
different kriging (cokriging) methodologies to make cross-validation
predictions in order to test the effect on prediction which helps solve some
of the data I now encounter.

Does somebody know what to do in such a situation?
Does somebody know what to do to treat multinomial classes covariate in
spacetime models using kriging?

I found this (DCluster package), but I am not sure if my way is wrong:

----------------------------------------------------------------------------------------------
 library(DCluster)

 library(boot)
 library(spdep)

 data(nc.sids)

 sids<-data.frame(Observed=nc.sids$SID74)
 sids<-cbind(sids,
Expected=nc.sids$BIR74*sum(nc.sids$SID74)/sum(nc.sids$BIR74))
 sids<-cbind(sids, Population=nc.sids$BIR74, x=nc.sids$x, y=nc.sids$y)

 #K&N's method over the centroids
 mle<-calculate.mle(sids, model="poisson")
 knresults<-opgam(data=sids, thegrid=sids[,c("x","y")], alpha=.05,
+  iscluster=kn.iscluster, fractpop=.5, R=100, model="multinomial", mle=mle)

 #Plot all centroids and significant ones in red

 plot(sids$x, sids$y, main="Kulldorff and Nagarwalla's method")
 points(knresults$x, knresults$y, col="red", pch=19)
 dev.off()
-----------------------------------------------------------------------------

Thank you very much in advance! Any tips are appreciated much!

     cheers,

             Toni Monle?n
              UB

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From marcelino.delacruz at upm.es  Mon May  9 12:54:31 2011
From: marcelino.delacruz at upm.es (Marcelino de la Cruz)
Date: Mon, 9 May 2011 12:54:31 +0200
Subject: [R-sig-Geo] comparing spatial distribution of two species in a
 same area with different coordinates
In-Reply-To: <BANLkTimEbwjPPTj=d3hj0xwuW5D-onzOng@mail.gmail.com>
References: <BANLkTinxBv1_y3o74Vbcve2tQ2Y382zCnw@mail.gmail.com>
	<BANLkTi=H7QWsDTJ0eEVanLd4ZHTcwqDN6w@mail.gmail.com>
	<201104260858.p3Q8wKk3000642@smtp.upm.es>
	<BANLkTi=v5txnsNs4F90gMyCbjjw6bdKLfQ@mail.gmail.com>
	<201104281044.p3SAiktT021807@smtp.upm.es>
	<BANLkTimEbwjPPTj=d3hj0xwuW5D-onzOng@mail.gmail.com>
Message-ID: <201105091054.p49AsWuk002375@smtp.upm.es>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110509/1f7923e1/attachment.pl>

From alobolistas at gmail.com  Mon May  9 14:51:54 2011
From: alobolistas at gmail.com (Agustin Lobo)
Date: Mon, 9 May 2011 14:51:54 +0200
Subject: [R-sig-Geo] raster or rgdal: problem with geometry of tif +
	tifw file
In-Reply-To: <BANLkTikN8c=niqF5-WhrHewXHVbmODWkuw@mail.gmail.com>
References: <BANLkTi=XPdD09whb66wM4nS57b4W6174Yg@mail.gmail.com>
	<BANLkTikN8c=niqF5-WhrHewXHVbmODWkuw@mail.gmail.com>
Message-ID: <BANLkTikanErskfY6v2prs8JOC92gndrrTA@mail.gmail.com>

Robert,

I think a warning is better than an error. There are many operations
that can be performed
ignoring the rotation, it should be up to the user.

In my case the problem is actually created at writing (writeRaster()),
> writeRaster(round(testcirpred),file="/media/TRANSCEND2/VegcamPro/MATA20090729/Proc2/delme.tif", format="GTiff", overwrite=TRUE,datatype='INT2U')

because the new tif file gets wrong  geometric information that has
priority over the one provided by the tfw file.

I circumvent the problem by using
listgeo -no_norm SDIM0114.tif > original.geo
in a directory where the tfw file is not present. Then I apply this
geometric information to the output from R:
geotifcp -g original.geo delme.tif SDIM0114L1.tif
cp SDIM0114.tfw SDIM0114L1.tfw

more or less as suggested in
http://remotesensing.org/geotiff/faq.html

It would be good being able to just omit the geometric info for the
output tif file in writeRaster(), so the original tfw file would be
directly valid for the output file
to be displayed in QGIS, thus avoiding the need of the fix with
listgeo and geotifcp

Agus

2011/5/8 Robert J. Hijmans <r.hijmans at gmail.com>:
> Hi Agus,
>
> The problem is that you raster is rotated (GeoTransform[3] and [5] are not zero)
>
> GeoTransform =
> ?445548.7745816645, -0.109570548549058, 0.216912817625298
> ?4628418.279379116, 0.216912817625298, 0.109570548549058
>
> raster ignored the rotation. I have fixed that (in version 1-8-19) by
> throwing an error for such a file.
>
> readGDAL will read the file, but as points (SpatialPointsDataFrame),
> which you could interpolate to a non-rotated raster. I do not plan to
> support such files in raster, but I might include a function for
> memory-safe transformation to a non-rotated file.
>
> Thanks for catching & reporting this,
>
> Robert
>
>
> On Sun, May 8, 2011 at 9:50 AM, Agustin Lobo <alobolistas at gmail.com> wrote:
>> Hi!
>>
>> I read a tif fle (with a companion tifw file) for which gdalinfo states:
>>
>> alobo at alobo-laptop:/media/TRANSCEND2/VegcamPro/MATA20090729/Proc2$
>> gdalinfo SDIM0114.tif
>> Warning 1: TIFFReadDirectory:Unknown field with tag 37717 (0x9355) encountered
>> Driver: GTiff/GeoTIFF
>> Files: SDIM0114.tif
>> Size is 2640, 1760
>> Coordinate System is `'
>> GeoTransform =
>> ?445548.7745816645, -0.109570548549058, 0.216912817625298
>> ?4628418.279379116, 0.216912817625298, 0.109570548549058
>> Metadata:
>> ?TIFFTAG_SOFTWARE=SIGMA Photo Pro 3.5.2.0000
>> ?TIFFTAG_DATETIME=2010:02:27 15:40:55
>> ?TIFFTAG_XRESOLUTION=180
>> ?TIFFTAG_YRESOLUTION=180
>> ?TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)
>> Image Structure Metadata:
>> ?INTERLEAVE=PIXEL
>> Corner Coordinates:
>> Upper Left ?( ?445548.775, 4628418.279)
>> Lower Left ?( ?445930.541, 4628611.124)
>> Upper Right ( ?445259.508, 4628990.929)
>> Lower Right ( ?445641.275, 4629183.773)
>> Center ? ? ?( ?445595.025, 4628801.026)
>>
>>
>> Then I read it in R:
>>> test= brick("/media/TRANSCEND2/VegcamPro/MATA20090729/TIFFOri/SDIM0114.tif")
>>> show(test)
>> class ? ? ? : RasterBrick
>> dimensions ?: 1760, 2640, 3 ?(nrow, ncol, nlayers)
>> resolution ?: 0.1095705, 0.1095705 ?(x, y)
>> extent ? ? ?: 445548.8, 445838, 4628418, 4628611 ?(xmin, xmax, ymin, ymax)
>> projection ?: NA
>> values ? ? ?: /media/TRANSCEND2/VegcamPro/MATA20090729/TIFFOri/SDIM0114.tif
>> min values ?: 0 0 0
>> max values ?: 65535 65535 65535
>>
>> and write it back to disk:
>>
>>> writeRaster(test,file="test.tif", format="GTiff", overwrite=TRUE,datatype='FLT8S')
>>
>> But gdalinfo states a different bounding box for the new file:
>> alobo at alobo-laptop:/media/TRANSCEND2/VegcamPro/MATA20090729/Proc2$
>> gdalinfo test.tif
>> Driver: GTiff/GeoTIFF
>> Files: test.tif
>> Size is 2640, 1760
>> Coordinate System is `'
>> Origin = (445548.774581664009020,4628611.233115110546350)
>> Pixel Size = (0.109570548549241,-0.109570548548469)
>> Image Structure Metadata:
>> ?COMPRESSION=LZW
>> ?INTERLEAVE=PIXEL
>> Corner Coordinates:
>> Upper Left ?( ?445548.775, 4628611.233)
>> Lower Left ?( ?445548.775, 4628418.389)
>> Upper Right ( ?445838.041, 4628611.233)
>> Lower Right ( ?445838.041, 4628418.389)
>> Center ? ? ?( ?445693.408, 4628514.811)
>> .../...
>>
>> Somehow the geometric properties are modified in R
>>
>> I've made a single geotif file with gdal_transform (no tifw created)
>> and read it in R in the same way and get the same result, so the
>> problem does not come
>> from using a tifw file as I initially thought.
>>
>> Perhaps a bug in brick() ?
>>
>> Thanks
>>
>> Agus
>>
>> Files:
>> http://dl.dropbox.com/u/3180464/SDIM0114.tif
>> http://dl.dropbox.com/u/3180464/SDIM0114.tifw
>>
>>> sessionInfo()
>> R version 2.13.0 (2011-04-13)
>> Platform: i486-pc-linux-gnu (32-bit)
>>
>> locale:
>> ?[1] LC_CTYPE=en_US.UTF-8 ? ? ? ? ?LC_NUMERIC=C
>> LC_TIME=en_US.UTF-8
>> ?[4] LC_COLLATE=en_US.UTF-8 ? ? ? ?LC_MONETARY=en_US.UTF-8
>> LC_MESSAGES=en_US.UTF-8
>> ?[7] LC_PAPER=en_US.UTF-8 ? ? ? ? ?LC_NAME=en_US.UTF-8
>> LC_ADDRESS=en_US.UTF-8
>> [10] LC_TELEPHONE=en_US.UTF-8 ? ? ?LC_MEASUREMENT=en_US.UTF-8
>> LC_IDENTIFICATION=en_US.UTF-8
>>
>> attached base packages:
>> [1] grid ? ? ?stats ? ? graphics ?grDevices utils ? ? datasets
>> methods ? base
>>
>> other attached packages:
>> [1] gridExtra_0.7 ggplot2_0.8.8 rgdal_0.6-31 ?raster_1.8-15 sp_0.9-72
>> ? reshape_0.8.3
>> [7] plyr_1.2.1 ? ?proto_0.3-8 ? rkward_0.5.6
>>
>> loaded via a namespace (and not attached):
>> [1] lattice_0.19-26 tools_2.13.0
>>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From r.hijmans at gmail.com  Mon May  9 20:17:15 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 9 May 2011 11:17:15 -0700
Subject: [R-sig-Geo] raster or rgdal: problem with geometry of tif +
	tifw file
In-Reply-To: <BANLkTikanErskfY6v2prs8JOC92gndrrTA@mail.gmail.com>
References: <BANLkTi=XPdD09whb66wM4nS57b4W6174Yg@mail.gmail.com>
	<BANLkTikN8c=niqF5-WhrHewXHVbmODWkuw@mail.gmail.com>
	<BANLkTikanErskfY6v2prs8JOC92gndrrTA@mail.gmail.com>
Message-ID: <BANLkTikaaaVeECVJ8yXDridJD+irWpqUbw@mail.gmail.com>

Hi Agus,

Thanks for the suggestions. I'll make it a (stern) warning. I am also
going to store the rotation info add build in some support for such
files.

I believe you can write a "plain tiff" file by using

options="PROFILE=BASELINE"

as in:

x = writeRaster(r, 'file.tif', options="PROFILE=BASELINE")

Robert

On Mon, May 9, 2011 at 5:51 AM, Agustin Lobo <alobolistas at gmail.com> wrote:
> Robert,
>
> I think a warning is better than an error. There are many operations
> that can be performed
> ignoring the rotation, it should be up to the user.
>
> In my case the problem is actually created at writing (writeRaster()),
>> writeRaster(round(testcirpred),file="/media/TRANSCEND2/VegcamPro/MATA20090729/Proc2/delme.tif", format="GTiff", overwrite=TRUE,datatype='INT2U')
>
> because the new tif file gets wrong ?geometric information that has
> priority over the one provided by the tfw file.
>
> I circumvent the problem by using
> listgeo -no_norm SDIM0114.tif > original.geo
> in a directory where the tfw file is not present. Then I apply this
> geometric information to the output from R:
> geotifcp -g original.geo delme.tif SDIM0114L1.tif
> cp SDIM0114.tfw SDIM0114L1.tfw
>
> more or less as suggested in
> http://remotesensing.org/geotiff/faq.html
>
> It would be good being able to just omit the geometric info for the
> output tif file in writeRaster(), so the original tfw file would be
> directly valid for the output file
> to be displayed in QGIS, thus avoiding the need of the fix with
> listgeo and geotifcp
>
> Agus
>
> 2011/5/8 Robert J. Hijmans <r.hijmans at gmail.com>:
>> Hi Agus,
>>
>> The problem is that you raster is rotated (GeoTransform[3] and [5] are not zero)
>>
>> GeoTransform =
>> ?445548.7745816645, -0.109570548549058, 0.216912817625298
>> ?4628418.279379116, 0.216912817625298, 0.109570548549058
>>
>> raster ignored the rotation. I have fixed that (in version 1-8-19) by
>> throwing an error for such a file.
>>
>> readGDAL will read the file, but as points (SpatialPointsDataFrame),
>> which you could interpolate to a non-rotated raster. I do not plan to
>> support such files in raster, but I might include a function for
>> memory-safe transformation to a non-rotated file.
>>
>> Thanks for catching & reporting this,
>>
>> Robert
>>
>>
>> On Sun, May 8, 2011 at 9:50 AM, Agustin Lobo <alobolistas at gmail.com> wrote:
>>> Hi!
>>>
>>> I read a tif fle (with a companion tifw file) for which gdalinfo states:
>>>
>>> alobo at alobo-laptop:/media/TRANSCEND2/VegcamPro/MATA20090729/Proc2$
>>> gdalinfo SDIM0114.tif
>>> Warning 1: TIFFReadDirectory:Unknown field with tag 37717 (0x9355) encountered
>>> Driver: GTiff/GeoTIFF
>>> Files: SDIM0114.tif
>>> Size is 2640, 1760
>>> Coordinate System is `'
>>> GeoTransform =
>>> ?445548.7745816645, -0.109570548549058, 0.216912817625298
>>> ?4628418.279379116, 0.216912817625298, 0.109570548549058
>>> Metadata:
>>> ?TIFFTAG_SOFTWARE=SIGMA Photo Pro 3.5.2.0000
>>> ?TIFFTAG_DATETIME=2010:02:27 15:40:55
>>> ?TIFFTAG_XRESOLUTION=180
>>> ?TIFFTAG_YRESOLUTION=180
>>> ?TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)
>>> Image Structure Metadata:
>>> ?INTERLEAVE=PIXEL
>>> Corner Coordinates:
>>> Upper Left ?( ?445548.775, 4628418.279)
>>> Lower Left ?( ?445930.541, 4628611.124)
>>> Upper Right ( ?445259.508, 4628990.929)
>>> Lower Right ( ?445641.275, 4629183.773)
>>> Center ? ? ?( ?445595.025, 4628801.026)
>>>
>>>
>>> Then I read it in R:
>>>> test= brick("/media/TRANSCEND2/VegcamPro/MATA20090729/TIFFOri/SDIM0114.tif")
>>>> show(test)
>>> class ? ? ? : RasterBrick
>>> dimensions ?: 1760, 2640, 3 ?(nrow, ncol, nlayers)
>>> resolution ?: 0.1095705, 0.1095705 ?(x, y)
>>> extent ? ? ?: 445548.8, 445838, 4628418, 4628611 ?(xmin, xmax, ymin, ymax)
>>> projection ?: NA
>>> values ? ? ?: /media/TRANSCEND2/VegcamPro/MATA20090729/TIFFOri/SDIM0114.tif
>>> min values ?: 0 0 0
>>> max values ?: 65535 65535 65535
>>>
>>> and write it back to disk:
>>>
>>>> writeRaster(test,file="test.tif", format="GTiff", overwrite=TRUE,datatype='FLT8S')
>>>
>>> But gdalinfo states a different bounding box for the new file:
>>> alobo at alobo-laptop:/media/TRANSCEND2/VegcamPro/MATA20090729/Proc2$
>>> gdalinfo test.tif
>>> Driver: GTiff/GeoTIFF
>>> Files: test.tif
>>> Size is 2640, 1760
>>> Coordinate System is `'
>>> Origin = (445548.774581664009020,4628611.233115110546350)
>>> Pixel Size = (0.109570548549241,-0.109570548548469)
>>> Image Structure Metadata:
>>> ?COMPRESSION=LZW
>>> ?INTERLEAVE=PIXEL
>>> Corner Coordinates:
>>> Upper Left ?( ?445548.775, 4628611.233)
>>> Lower Left ?( ?445548.775, 4628418.389)
>>> Upper Right ( ?445838.041, 4628611.233)
>>> Lower Right ( ?445838.041, 4628418.389)
>>> Center ? ? ?( ?445693.408, 4628514.811)
>>> .../...
>>>
>>> Somehow the geometric properties are modified in R
>>>
>>> I've made a single geotif file with gdal_transform (no tifw created)
>>> and read it in R in the same way and get the same result, so the
>>> problem does not come
>>> from using a tifw file as I initially thought.
>>>
>>> Perhaps a bug in brick() ?
>>>
>>> Thanks
>>>
>>> Agus
>>>
>>> Files:
>>> http://dl.dropbox.com/u/3180464/SDIM0114.tif
>>> http://dl.dropbox.com/u/3180464/SDIM0114.tifw
>>>
>>>> sessionInfo()
>>> R version 2.13.0 (2011-04-13)
>>> Platform: i486-pc-linux-gnu (32-bit)
>>>
>>> locale:
>>> ?[1] LC_CTYPE=en_US.UTF-8 ? ? ? ? ?LC_NUMERIC=C
>>> LC_TIME=en_US.UTF-8
>>> ?[4] LC_COLLATE=en_US.UTF-8 ? ? ? ?LC_MONETARY=en_US.UTF-8
>>> LC_MESSAGES=en_US.UTF-8
>>> ?[7] LC_PAPER=en_US.UTF-8 ? ? ? ? ?LC_NAME=en_US.UTF-8
>>> LC_ADDRESS=en_US.UTF-8
>>> [10] LC_TELEPHONE=en_US.UTF-8 ? ? ?LC_MEASUREMENT=en_US.UTF-8
>>> LC_IDENTIFICATION=en_US.UTF-8
>>>
>>> attached base packages:
>>> [1] grid ? ? ?stats ? ? graphics ?grDevices utils ? ? datasets
>>> methods ? base
>>>
>>> other attached packages:
>>> [1] gridExtra_0.7 ggplot2_0.8.8 rgdal_0.6-31 ?raster_1.8-15 sp_0.9-72
>>> ? reshape_0.8.3
>>> [7] plyr_1.2.1 ? ?proto_0.3-8 ? rkward_0.5.6
>>>
>>> loaded via a namespace (and not attached):
>>> [1] lattice_0.19-26 tools_2.13.0
>>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>


From HodgessE at uhd.edu  Tue May 10 13:59:51 2011
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Tue, 10 May 2011 06:59:51 -0500
Subject: [R-sig-Geo] question about writeOGR and kml files
Message-ID: <586A4828D7AAA04CA9B258C50A28DA206DB783@BALI.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110510/4c869ea7/attachment.pl>

From alfreale74 at gmail.com  Tue May 10 16:21:03 2011
From: alfreale74 at gmail.com (Alfredo Alessandrini)
Date: Tue, 10 May 2011 16:21:03 +0200
Subject: [R-sig-Geo] NA raster replace
Message-ID: <BANLkTinHbvesb+GGrODnyj9jQJKkoSVmQg@mail.gmail.com>

Hi,

I've to replace NA value with zero in some raster.

I use the raster package.

Is there a faster method than this:

funNA <- function(x) {x[is.na(x)] <- 0; return(x)}

test <- calc(test,funNA)




Alfredo


From tgriffin at uaex.edu  Tue May 10 16:26:55 2011
From: tgriffin at uaex.edu (Terry Griffin)
Date: Tue, 10 May 2011 09:26:55 -0500 (CDT)
Subject: [R-sig-Geo] NA raster replace
Message-ID: <1159140848.2359884.1305037615101.JavaMail.root@zmail.uaex.edu>



Terry Griffin, PhD
tgriffin at uaex.edu
501.249.6360

-----Original Message-----
From: Alfredo Alessandrini <alfreale74 at gmail.com>
Sent: Tuesday, May 10, 2011 9:23 AM
To: r-sig-geo at r-project.org
Subject: [R-sig-Geo] NA raster replace

Hi,

I've to replace NA value with zero in some raster.

I use the raster package.

Is there a faster method than this:

funNA <- function(x) {x[is.na(x)] <- 0; return(x)}

test <- calc(test,funNA)




Alfredo

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From wilfried.thuiller at ujf-grenoble.fr  Tue May 10 16:30:22 2011
From: wilfried.thuiller at ujf-grenoble.fr (Wilfried Thuiller)
Date: Tue, 10 May 2011 16:30:22 +0200
Subject: [R-sig-Geo] NA raster replace
In-Reply-To: <BANLkTinHbvesb+GGrODnyj9jQJKkoSVmQg@mail.gmail.com>
References: <BANLkTinHbvesb+GGrODnyj9jQJKkoSVmQg@mail.gmail.com>
Message-ID: <E24344BA-B204-4B23-9898-0F86D556FD50@ujf-grenoble.fr>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110510/2bdcb784/attachment.pl>

From gianni.lavaredo at gmail.com  Tue May 10 18:30:01 2011
From: gianni.lavaredo at gmail.com (gianni lavaredo)
Date: Tue, 10 May 2011 18:30:01 +0200
Subject: [R-sig-Geo] help to change value in a Data.frame
Message-ID: <BANLkTinoc=jybFv+Go9zi938d-wu9r6q+g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110510/9415c17f/attachment.pl>

From lestes at princeton.edu  Tue May 10 18:48:09 2011
From: lestes at princeton.edu (Lyndon Estes)
Date: Tue, 10 May 2011 12:48:09 -0400
Subject: [R-sig-Geo] help to change value in a Data.frame
In-Reply-To: <BANLkTinoc=jybFv+Go9zi938d-wu9r6q+g@mail.gmail.com>
References: <BANLkTinoc=jybFv+Go9zi938d-wu9r6q+g@mail.gmail.com>
Message-ID: <BANLkTimVQkBouSRRGGh8tDU_AbgiB1o5wA@mail.gmail.com>

Hi Gianni,

Try this

mydf[mydf$value < 0, "value"] <- 100

or this

mydf[mydf$value %in% c(-4, -5), "value"] <- 100

Cheers, Lyndon


On Tue, May 10, 2011 at 12:30 PM, gianni lavaredo
<gianni.lavaredo at gmail.com> wrote:
> Dear researchers,
>
> sorry I know it's no the right mailist but I have this problem.
>
> mydf <- data.frame(id=c(1,2,3,4,5),value=c(2,3,-5,6,-4))
> ?id value
> 1 ?1 ? ? 2
> 2 ?2 ? ? 3
> 3 ?3 ? ?-5
> 4 ?4 ? ? 6
> 5 ?5 ? ?-4
>
> I wish to select and change the value of negative number
>
> mydf[mydf$value >= -4 & mydf$value <= -5, c(2)] <- 100
>
> to have
>
> ?id value
> 1 ?1 ? ? 2
> 2 ?2 ? ? 3
> 3 ?3 ? ?100
> 4 ?4 ? ? 6
> 5 ?5 ? ?100
>
> but the normal expression doesn't work because they are negative value
>
> thanks in advance
> Gianni
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Lyndon Estes
Research Associate
Woodrow Wilson School
Princeton University
+1-609-258-2392 (o)
+1-609-258-6082 (f)
+1-202-431-0496 (m)
lestes at princeton.edu


From sep at umail.ucsb.edu  Tue May 10 21:27:06 2011
From: sep at umail.ucsb.edu (Sam Prentice)
Date: Tue, 10 May 2011 12:27:06 -0700
Subject: [R-sig-Geo] readRAST6() in {spgrass6}
Message-ID: <003f01cc0f48$3f7a66b0$be6f3410$@umail.ucsb.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110510/f85ddedb/attachment.pl>

From Roger.Bivand at nhh.no  Tue May 10 21:46:00 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 10 May 2011 21:46:00 +0200 (CEST)
Subject: [R-sig-Geo] readRAST6() in {spgrass6}
In-Reply-To: <003f01cc0f48$3f7a66b0$be6f3410$@umail.ucsb.edu>
References: <003f01cc0f48$3f7a66b0$be6f3410$@umail.ucsb.edu>
Message-ID: <alpine.LRH.2.00.1105102137220.9371@reclus.nhh.no>

On Tue, 10 May 2011, Sam Prentice wrote:

> Hi,
>
>
>
> I'm running R 2.12.2 via Tinn-R on Windows Server 2008. I'm using R for
> cluster analysis for terrain classification and I'm getting the following
> error when parsing GRASS data into R:
>
>
>
>> x =
> readRAST6(c("param_elev3","param_crosC_1m","param_longC_1m","param_slope5","
> param_profC","param_miniC_1m","param_maxiC_1m"))
>
> D:/GRASSdata/Sedgwick2/PERMANENT/.tmp/param_elev3 has GDAL driver GTiff
>
> and has 6224 rows and 6242 columns
>

Is the difficulty perhaps associated with the size of these rasters? The 
total size of the object will be over 2GB, are you using 64-bit Windows? 
How much memory do you have (over 16GB?)? Have you considered exporting 
the data manually (or using execGRASS()) from GRASS and using the raster 
package to use the data without necessarily reading it all into R, which 
will try to hold everything in memory unless you choose not to do so?

Could you make the same classification on subsets of your data? If you set 
your GRASS region to say 1000 by 1000, the problem may be resolved, 
because the object size will be much smaller, about 50MB. Older versions 
of r.out.gdal in GRASS, used here for loose coupling, did not respect 
region settings - is your GRASS version current, and the output region as 
chosen?

Hope this helps,

Roger

>
>
> Error in deleteDataset(DS) :
>
>                GDAL Error 1: Deleting
> D:/GRASSdata/Sedgwick2/PERMANENT/.tmp/param_elev3 failed:
>
> Permission denied
>
>
>
> On the surface this looked like an issue with user privileges, since I do
> not have admin-level user privileges on this machine. However, this has been
> corrected - I now have permissions on the .tmp directory listed in the
> error, and I can create, append, and delete any file in that location, but
> the error is still occurring.
>
>
>
> Thoughts?
>
>
>
> Thanks,
>
> Sam
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From pierre.roudier at gmail.com  Wed May 11 00:40:21 2011
From: pierre.roudier at gmail.com (Pierre Roudier)
Date: Wed, 11 May 2011 10:40:21 +1200
Subject: [R-sig-Geo] readRAST6() in {spgrass6}
In-Reply-To: <003f01cc0f48$3f7a66b0$be6f3410$@umail.ucsb.edu>
References: <003f01cc0f48$3f7a66b0$be6f3410$@umail.ucsb.edu>
Message-ID: <BANLkTi=1MTqesqeiyaoAp0kapSJc271JfA@mail.gmail.com>

Could that message have anything to do with the fact that this is a
layer from the PERMANENT mapset?

My two cents,

Pierre

2011/5/11 Sam Prentice <sep at umail.ucsb.edu>:
> Hi,
>
>
>
> I'm running R 2.12.2 via Tinn-R on Windows Server 2008. I'm using R for
> cluster analysis for terrain classification and I'm getting the following
> error when parsing GRASS data into R:
>
>
>
>> x =
> readRAST6(c("param_elev3","param_crosC_1m","param_longC_1m","param_slope5","
> param_profC","param_miniC_1m","param_maxiC_1m"))
>
> D:/GRASSdata/Sedgwick2/PERMANENT/.tmp/param_elev3 has GDAL driver GTiff
>
> and has 6224 rows and 6242 columns
>
>
>
> Error in deleteDataset(DS) :
>
> ? ? ? ? ? ? ? ?GDAL Error 1: Deleting
> D:/GRASSdata/Sedgwick2/PERMANENT/.tmp/param_elev3 failed:
>
> Permission denied
>
>
>
> On the surface this looked like an issue with user privileges, since I do
> not have admin-level user privileges on this machine. However, this has been
> corrected - I now have permissions on the .tmp directory listed in the
> error, and I can create, append, and delete any file in that location, but
> the error is still occurring.
>
>
>
> Thoughts?
>
>
>
> Thanks,
>
> Sam
>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Scientist
Landcare Research, New Zealand


From emmanuel.blondel1 at gmail.com  Wed May 11 09:27:26 2011
From: emmanuel.blondel1 at gmail.com (Emmanuel Blondel)
Date: Wed, 11 May 2011 09:27:26 +0200
Subject: [R-sig-Geo] rgdal - read geoJSON with readOGR
Message-ID: <4DCA3A5E.2030405@gmail.com>

Dear all,

I tried to use the readOGR from package rgdal to read a geoJSON file 
from a Geoserver WFS.
I can get a SpatialPointDataFrame with this code:

url<-"http://localhost:8080/geoserver/wfs?service=WFS&version=1.0.0&request=GetFeature&outputFormat=json&typeName=mylayer"
ogrInfo(dsn=url,layer = 'OGRGeoJSON')
layer<-readOGR(dsn=url,layer = 'OGRGeoJSON')

but my problem is regarding the attributes. I have a numeric (real) 
field that is converted to integer. To see why readOGR had this 
behaviour, I downloaded my geoJSON file to explore the data: It appears 
that the first value for this attribute is 1, so the field is converted 
in integer with readOGR, and all values between 0 and 1 are set to 0.

Is there any way to force numeric attributes to real type?

I thank you in advance,

Cheers,
Emmanuel


From matteo.mattiuzzi at boku.ac.at  Wed May 11 10:35:02 2011
From: matteo.mattiuzzi at boku.ac.at (Matteo Mattiuzzi)
Date: Wed, 11 May 2011 10:35:02 +0200
Subject: [R-sig-Geo] Antw:  NA raster replace
In-Reply-To: <BANLkTinHbvesb+GGrODnyj9jQJKkoSVmQg@mail.gmail.com>
References: <BANLkTinHbvesb+GGrODnyj9jQJKkoSVmQg@mail.gmail.com>
Message-ID: <4DCA6656020000270000E61E@gwia2.boku.ac.at>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110511/c72a58ce/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Wed May 11 10:37:36 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed, 11 May 2011 09:37:36 +0100
Subject: [R-sig-Geo] rgdal - read geoJSON with readOGR
In-Reply-To: <4DCA3A5E.2030405@gmail.com>
References: <4DCA3A5E.2030405@gmail.com>
Message-ID: <BANLkTi=7Bepa7XHUSeRk4Q9eujXObGP+fw@mail.gmail.com>

On Wed, May 11, 2011 at 8:27 AM, Emmanuel Blondel
<emmanuel.blondel1 at gmail.com> wrote:
> Dear all,
>
> I tried to use the readOGR from package rgdal to read a geoJSON file from a
> Geoserver WFS.
> I can get a SpatialPointDataFrame with this code:
>
> url<-"http://localhost:8080/geoserver/wfs?service=WFS&version=1.0.0&request=GetFeature&outputFormat=json&typeName=mylayer"
> ogrInfo(dsn=url,layer = 'OGRGeoJSON')
> layer<-readOGR(dsn=url,layer = 'OGRGeoJSON')
>
> but my problem is regarding the attributes. I have a numeric (real) field
> that is converted to integer. To see why readOGR had this behaviour, I
> downloaded my geoJSON file to explore the data: It appears that the first
> value for this attribute is 1, so the field is converted in integer with
> readOGR, and all values between 0 and 1 are set to 0.
>
> Is there any way to force numeric attributes to real type?

 Some experiments with the command-line ogrinfo tools seem to indicate
that the geoJSON driver in OGR has this behaviour. I can't see this
explicitly in the source code from a brief look, however.

 The JSON spec only has a single 'number' concept (no differentiating
between ints and reals) so I'd argue that the geoJSON driver should
read anything numeric in as 'real'. (RFC 4627).

 If I get five minutes today I'll create some test samples and submit
a bug report to the OGR guys.

 A massively kludgy workaround would be to use readOGR to get the
geometry, and "fromJSON" from the rjson package to get the attributes
(which would need massaging to get into a data frame) - this does
preserve the floating point nature of data even if the first point
doesn't have a decimal point in it! If the geometry is simple enough
(points?) you could do it all with fromJSON fairly easily.

 Final thought: Geoserver WFS should maybe generate geoJSON where real
values always have a decimal point in them (I'm not sure if Geoserver
is creating these from anothe data source or just passing through
already-created files..).

Barry


From Tim.Haering at lwf.bayern.de  Wed May 11 16:09:56 2011
From: Tim.Haering at lwf.bayern.de (=?iso-8859-1?Q?H=E4ring=2C_Tim_=28LWF=29?=)
Date: Wed, 11 May 2011 16:09:56 +0200
Subject: [R-sig-Geo] problem with predict() in raster with GAM
Message-ID: <70FC67C4A585D1489E66225A4E0238BAEF4910@RZS-EXC-CL06.rz-sued.bayern.de>

Dear List,

I want to use the predict() function from the raster-package to apply a GAM to my gridded predictors. Unfortunately I get an error message:

When using a linear model everything works fine:
> mod.lm <- lm(y ~ Slope + Boen_By50m + Hoehe_abs, data=dat_nwt)
> p <- predict(object = r, model = mod.lm, filename='gebiet_1/sturmwurf.img', 
  progress='text', na.rm = FALSE, overwrite = TRUE, format = 'HFA', type='response')
  |======================================================================| 100%

The same, when using a GLM
> mod.glm <- glm(y ~ Slope + Boen_By50m + Hoehe_abs, data=dat_nwt, family=binomial())
> p <- predict(object = r, model = mod.glm, filename='gebiet_1/sturmwurf.img', 
  progress='text', na.rm = FALSE, overwrite = TRUE, format = 'HFA', type='response')
  |======================================================================| 100%

But, when using a GAM I get an Error.
> mod.gam <- gam(y ~ Slope + Boen_By50m + Hoehe_abs, data=dat_nwt, family=binomial())
> p <- predict(object = r, model = mod.gam, filename='gebiet_1/sturmwurf.img', 
  progress='text', na.rm = FALSE, overwrite = TRUE, format = 'HFA', type='response')
  |                                                                      |   0%
  Error in object[-omit, , drop = FALSE] : incorrect number of dimensions

Does anybody know what 'incorrect number of dimensions' means in this context?

Thanks
TIM

***
> sessionInfo()
R version 2.13.0 (2011-04-13)
Platform: i386-pc-mingw32/i386 (32-bit)

locale:
[1] LC_COLLATE=German_Germany.1252  LC_CTYPE=German_Germany.1252   
[3] LC_MONETARY=German_Germany.1252 LC_NUMERIC=C                   
[5] LC_TIME=German_Germany.1252    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] rgdal_0.6-33  raster_1.8-12 sp_0.9-81     mgcv_1.7-6   

loaded via a namespace (and not attached):
[1] grid_2.13.0        lattice_0.19-23    Matrix_0.999375-50 nlme_3.1-100      


---------------- 
Tim H?ring
Bavarian State Institute of Forest Research 
Department of Soil and Climate
Hans-Carl-von-Carlowitz-Platz 1
D-85354 Freising

E-Mail: tim.haering at lwf.bayern.de
http://www.lwf.bayern.de


From r.hijmans at gmail.com  Wed May 11 21:11:17 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 11 May 2011 12:11:17 -0700
Subject: [R-sig-Geo] raster or rgdal: problem with geometry of tif +
	tifw file
In-Reply-To: <BANLkTikaaaVeECVJ8yXDridJD+irWpqUbw@mail.gmail.com>
References: <BANLkTi=XPdD09whb66wM4nS57b4W6174Yg@mail.gmail.com>
	<BANLkTikN8c=niqF5-WhrHewXHVbmODWkuw@mail.gmail.com>
	<BANLkTikanErskfY6v2prs8JOC92gndrrTA@mail.gmail.com>
	<BANLkTikaaaVeECVJ8yXDridJD+irWpqUbw@mail.gmail.com>
Message-ID: <BANLkTiknBOQV5s5QtTnuQV9nc3Fnp6y8Yg@mail.gmail.com>

Hi Agus,

I have added  some support for rotated rasters to the raster package
(>= 1.8-20).

- There is a warning
- Most functions that assume rectangularity, will now fail, with a
clear warning.
- Some of these functions, such as plot, do not need to fail, but need
to be fixed with a few more lines of code. I will do that, little by
little, but let me know if you find an important one.
- If you write results to a new geotiff the rotation parameters should
now be preserved correctly
- A new function "rectify" to get rid of the rotation

library(raster)
beginCluster() # speeds things up tremendously, if you have a multi-core machine
b <- brick('SDIM0114.tif')
br <- rectify(b, progress='window')
plotRGB(br)

Robert


On Mon, May 9, 2011 at 11:17 AM, Robert J. Hijmans <r.hijmans at gmail.com> wrote:
> Hi Agus,
>
> Thanks for the suggestions. I'll make it a (stern) warning. I am also
> going to store the rotation info add build in some support for such
> files.
>
> I believe you can write a "plain tiff" file by using
>
> options="PROFILE=BASELINE"
>
> as in:
>
> x = writeRaster(r, 'file.tif', options="PROFILE=BASELINE")
>
> Robert
>
> On Mon, May 9, 2011 at 5:51 AM, Agustin Lobo <alobolistas at gmail.com> wrote:
>> Robert,
>>
>> I think a warning is better than an error. There are many operations
>> that can be performed
>> ignoring the rotation, it should be up to the user.
>>
>> In my case the problem is actually created at writing (writeRaster()),
>>> writeRaster(round(testcirpred),file="/media/TRANSCEND2/VegcamPro/MATA20090729/Proc2/delme.tif", format="GTiff", overwrite=TRUE,datatype='INT2U')
>>
>> because the new tif file gets wrong ?geometric information that has
>> priority over the one provided by the tfw file.
>>
>> I circumvent the problem by using
>> listgeo -no_norm SDIM0114.tif > original.geo
>> in a directory where the tfw file is not present. Then I apply this
>> geometric information to the output from R:
>> geotifcp -g original.geo delme.tif SDIM0114L1.tif
>> cp SDIM0114.tfw SDIM0114L1.tfw
>>
>> more or less as suggested in
>> http://remotesensing.org/geotiff/faq.html
>>
>> It would be good being able to just omit the geometric info for the
>> output tif file in writeRaster(), so the original tfw file would be
>> directly valid for the output file
>> to be displayed in QGIS, thus avoiding the need of the fix with
>> listgeo and geotifcp
>>
>> Agus
>>
>> 2011/5/8 Robert J. Hijmans <r.hijmans at gmail.com>:
>>> Hi Agus,
>>>
>>> The problem is that you raster is rotated (GeoTransform[3] and [5] are not zero)
>>>
>>> GeoTransform =
>>> ?445548.7745816645, -0.109570548549058, 0.216912817625298
>>> ?4628418.279379116, 0.216912817625298, 0.109570548549058
>>>
>>> raster ignored the rotation. I have fixed that (in version 1-8-19) by
>>> throwing an error for such a file.
>>>
>>> readGDAL will read the file, but as points (SpatialPointsDataFrame),
>>> which you could interpolate to a non-rotated raster. I do not plan to
>>> support such files in raster, but I might include a function for
>>> memory-safe transformation to a non-rotated file.
>>>
>>> Thanks for catching & reporting this,
>>>
>>> Robert
>>>
>>>
>>> On Sun, May 8, 2011 at 9:50 AM, Agustin Lobo <alobolistas at gmail.com> wrote:
>>>> Hi!
>>>>
>>>> I read a tif fle (with a companion tifw file) for which gdalinfo states:
>>>>
>>>> alobo at alobo-laptop:/media/TRANSCEND2/VegcamPro/MATA20090729/Proc2$
>>>> gdalinfo SDIM0114.tif
>>>> Warning 1: TIFFReadDirectory:Unknown field with tag 37717 (0x9355) encountered
>>>> Driver: GTiff/GeoTIFF
>>>> Files: SDIM0114.tif
>>>> Size is 2640, 1760
>>>> Coordinate System is `'
>>>> GeoTransform =
>>>> ?445548.7745816645, -0.109570548549058, 0.216912817625298
>>>> ?4628418.279379116, 0.216912817625298, 0.109570548549058
>>>> Metadata:
>>>> ?TIFFTAG_SOFTWARE=SIGMA Photo Pro 3.5.2.0000
>>>> ?TIFFTAG_DATETIME=2010:02:27 15:40:55
>>>> ?TIFFTAG_XRESOLUTION=180
>>>> ?TIFFTAG_YRESOLUTION=180
>>>> ?TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)
>>>> Image Structure Metadata:
>>>> ?INTERLEAVE=PIXEL
>>>> Corner Coordinates:
>>>> Upper Left ?( ?445548.775, 4628418.279)
>>>> Lower Left ?( ?445930.541, 4628611.124)
>>>> Upper Right ( ?445259.508, 4628990.929)
>>>> Lower Right ( ?445641.275, 4629183.773)
>>>> Center ? ? ?( ?445595.025, 4628801.026)
>>>>
>>>>
>>>> Then I read it in R:
>>>>> test= brick("/media/TRANSCEND2/VegcamPro/MATA20090729/TIFFOri/SDIM0114.tif")
>>>>> show(test)
>>>> class ? ? ? : RasterBrick
>>>> dimensions ?: 1760, 2640, 3 ?(nrow, ncol, nlayers)
>>>> resolution ?: 0.1095705, 0.1095705 ?(x, y)
>>>> extent ? ? ?: 445548.8, 445838, 4628418, 4628611 ?(xmin, xmax, ymin, ymax)
>>>> projection ?: NA
>>>> values ? ? ?: /media/TRANSCEND2/VegcamPro/MATA20090729/TIFFOri/SDIM0114.tif
>>>> min values ?: 0 0 0
>>>> max values ?: 65535 65535 65535
>>>>
>>>> and write it back to disk:
>>>>
>>>>> writeRaster(test,file="test.tif", format="GTiff", overwrite=TRUE,datatype='FLT8S')
>>>>
>>>> But gdalinfo states a different bounding box for the new file:
>>>> alobo at alobo-laptop:/media/TRANSCEND2/VegcamPro/MATA20090729/Proc2$
>>>> gdalinfo test.tif
>>>> Driver: GTiff/GeoTIFF
>>>> Files: test.tif
>>>> Size is 2640, 1760
>>>> Coordinate System is `'
>>>> Origin = (445548.774581664009020,4628611.233115110546350)
>>>> Pixel Size = (0.109570548549241,-0.109570548548469)
>>>> Image Structure Metadata:
>>>> ?COMPRESSION=LZW
>>>> ?INTERLEAVE=PIXEL
>>>> Corner Coordinates:
>>>> Upper Left ?( ?445548.775, 4628611.233)
>>>> Lower Left ?( ?445548.775, 4628418.389)
>>>> Upper Right ( ?445838.041, 4628611.233)
>>>> Lower Right ( ?445838.041, 4628418.389)
>>>> Center ? ? ?( ?445693.408, 4628514.811)
>>>> .../...
>>>>
>>>> Somehow the geometric properties are modified in R
>>>>
>>>> I've made a single geotif file with gdal_transform (no tifw created)
>>>> and read it in R in the same way and get the same result, so the
>>>> problem does not come
>>>> from using a tifw file as I initially thought.
>>>>
>>>> Perhaps a bug in brick() ?
>>>>
>>>> Thanks
>>>>
>>>> Agus
>>>>
>>>> Files:
>>>> http://dl.dropbox.com/u/3180464/SDIM0114.tif
>>>> http://dl.dropbox.com/u/3180464/SDIM0114.tifw
>>>>
>>>>> sessionInfo()
>>>> R version 2.13.0 (2011-04-13)
>>>> Platform: i486-pc-linux-gnu (32-bit)
>>>>
>>>> locale:
>>>> ?[1] LC_CTYPE=en_US.UTF-8 ? ? ? ? ?LC_NUMERIC=C
>>>> LC_TIME=en_US.UTF-8
>>>> ?[4] LC_COLLATE=en_US.UTF-8 ? ? ? ?LC_MONETARY=en_US.UTF-8
>>>> LC_MESSAGES=en_US.UTF-8
>>>> ?[7] LC_PAPER=en_US.UTF-8 ? ? ? ? ?LC_NAME=en_US.UTF-8
>>>> LC_ADDRESS=en_US.UTF-8
>>>> [10] LC_TELEPHONE=en_US.UTF-8 ? ? ?LC_MEASUREMENT=en_US.UTF-8
>>>> LC_IDENTIFICATION=en_US.UTF-8
>>>>
>>>> attached base packages:
>>>> [1] grid ? ? ?stats ? ? graphics ?grDevices utils ? ? datasets
>>>> methods ? base
>>>>
>>>> other attached packages:
>>>> [1] gridExtra_0.7 ggplot2_0.8.8 rgdal_0.6-31 ?raster_1.8-15 sp_0.9-72
>>>> ? reshape_0.8.3
>>>> [7] plyr_1.2.1 ? ?proto_0.3-8 ? rkward_0.5.6
>>>>
>>>> loaded via a namespace (and not attached):
>>>> [1] lattice_0.19-26 tools_2.13.0
>>>>
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>


From matevz.pavlic at gi-zrmk.si  Thu May 12 13:12:59 2011
From: matevz.pavlic at gi-zrmk.si (=?iso-8859-2?Q?Matev=BE_Pavli=E8?=)
Date: Thu, 12 May 2011 13:12:59 +0200
Subject: [R-sig-Geo] density /diversity of points
Message-ID: <AD5CA6183570B54F92AA45CE2619F9B901208819@gi-zrmk.si>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110512/de25574a/attachment.pl>

From marcelino.delacruz at upm.es  Thu May 12 14:02:32 2011
From: marcelino.delacruz at upm.es (Marcelino de la Cruz)
Date: Thu, 12 May 2011 14:02:32 +0200
Subject: [R-sig-Geo] density /diversity of points
In-Reply-To: <AD5CA6183570B54F92AA45CE2619F9B901208819@gi-zrmk.si>
References: <AD5CA6183570B54F92AA45CE2619F9B901208819@gi-zrmk.si>
Message-ID: <4DCBCC58.5080805@upm.es>

On 12/05/2011 13:12, Matev? Pavli? wrote:
> Hi all,
>
>
>
> I have a point data set (SHP) with coordinates and a attribute (i.e. type of point).
>
> These points are scattered around a fairly big area. What i would like to do is to find a sub-area where density of points sombined with the diversity of type is the biggest.
>
> Does anyone have any idea iff this is somehowe possible to do in R? Any idea would be greatly aprpeciated,
>
>    
To your first question:

library(fortunes)
fortune("Yoda")

;-)

More seriously, you could  transform your shp data in a ppp object with 
spatstat. See the vignette in spatstat. Then you can use some functions 
there, for example (with the data set lansing):

library(spatstat)
data(lansing)
plot(lansing)
# get an estimate of point density
lansing.den <- density.ppp(lansing)
plot(lansing.den)

# get an estimate of point diversity (here, for the shake of brevity, at 
the points themselves)
lansing.tab<- marktable(lansing,R=0.05)
diversity <- apply(lansing.tab,1,function(x) sum(x>0))
lansing.div <- setmarks(lansing,diversity)
lansing.div.s <-smooth.ppp(lansing.div)

plot(lansing.div.s)

# select areas with arbitrary high values of  density and diversity
plot(eval.im(lansing.div.s >4.5 & (lansing.den/max(lansing.den))>0.9))


HTH. Cheers,

Marcelino



-- 
_________________________________

Marcelino de la Cruz Rot
Departamento de Biologia Vegetal
E.U.T.I. Agricola
Universidad Politecnica de Madrid
  28040 Madrid
  Tel: 34913365654


From csfowler at uw.edu  Thu May 12 18:57:21 2011
From: csfowler at uw.edu (Christopher S. Fowler)
Date: Thu, 12 May 2011 09:57:21 -0700
Subject: [R-sig-Geo] Help with rounding legend intervals within a function
Message-ID: <BANLkTi=mYHi1QYuUjn+zyNKPdJHZFHTFNw@mail.gmail.com>

I am producing a large number of maps and wanted to build a function
to set the class interval breaks (and round them to three digits)
within my own function. I found a very helpful interchange at:

https://stat.ethz.ch/pipermail/r-sig-geo/2007-July/002350.html

where the mechanics of how to round legend intervals were set out.
With a few modifications I want to implement that code within my
function.
___________________________________________________
library(cluster)
library(maptools)
library(RColorBrewer)
library(classInt)

#the function accepts a shapefile, a vector of values to plot, a
#number indicating the number of categories, and a title
 myMap<-function(shape,plot.val,ncls=5,title="Generic Title"){
 plotvar <- plot.val
 nclr <- ncls
 plotclr <- brewer.pal(nclr, "BuPu")
 class <- classIntervals(plotvar, nclr, style = "quantile")
 brks <- round(class$brks, 3)
 brks[1]<-(floor(min(class$brks)*1000))/1000  #makes sure lower bound
         #is rounded down so it includes lowest value
 brks[length(brks)]<-(ceiling(max(class$brks)*1000))/1000 #makes sure
         #upper bound is rounded up so it includes highest value
 class <- classIntervals(plotvar, nclr, style = "fixed", fixedBreaks = brks)
 colcode <- findColours(class, plotclr)

 par(mar=c(0.5,0.5,0.5,0.5))
 plot(shape, col = colcode)
 legend("topleft", legend=names(attr(colcode, "table")),
  fill=attr(colcode, "palette"), cex = 0.75, bty = "n")
}

#Run the function
xx <- readShapePoly(system.file("shapes/sids.shp", package="maptools")[1],
IDvar="FIPSNO", proj4string=CRS("+proj=longlat +ellps=clrk66"))
plot(xx, border="blue", axes=TRUE, las=1)
names(xx)
dat <- cbind(xx$SID74, xx$NWBIR74, xx$BIR79)
fann <- fanny(dat, 3, maxit = 1000)

myMap(xx,fann$membership[,1],ncls=6)
________________________________________________________

Running the function (on R 2.13) produces the error:
"Error in eval(expr, envir, enclos) : object 'brks' not found"

If I run traceback() I get:

5: eval(expr, envir, enclos)
4: eval(mc$...$fixedBreaks)
3: sort(eval(mc$...$fixedBreaks))
2: classIntervals(plotvar, nclr, style = "fixed", fixedBreaks = brks)
1: myMap(xx, fann$membership[, 1], ncls = 6)

what appears to be happening is that the eval expression is using the
main variable environment (if I run the code outside of the function
it works fine, or if I leave an object named brks in the main variable
environment it will see that variable and the function works).

My question is, how do I create the brks variable within the context of
the function so eval can see it, or how do I get the eval expression
to see the brks variable in my function environment? I am leaning
towards the former since I don't want to have to use a custom version
of the classIntervals function if I don't have to.

Thanks for any assistance

-- 
Christopher S. Fowler PhD.
Center for Studies in Demography and Ecology
University of Washington
http://faculty.washington.edu/csfowler


From r.hijmans at gmail.com  Thu May 12 19:29:56 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 12 May 2011 10:29:56 -0700
Subject: [R-sig-Geo] gam problem
In-Reply-To: <70FC67C4A585D1489E66225A4E0238BAEF4B3A@RZS-EXC-CL06.rz-sued.bayern.de>
References: <BANLkTim3jaWn=Oc1EoxTq9YFHcHYQ3=Egw@mail.gmail.com>
	<70FC67C4A585D1489E66225A4E0238BAEF4B3A@RZS-EXC-CL06.rz-sued.bayern.de>
Message-ID: <BANLkTi=pdAaoqgY-WM0YrW52sYAfRw2Abw@mail.gmail.com>

Thanks Tim,
This happened when using gam & writing to file & na.rm = FALSE (which
in the case of GAM is the same as na.rm=TRUE). The problem was that
gam.predict returns an array where raster::predict expected a matrix
or a vector. This is now fixed (version 1.8-22).
Robert

On Thu, May 12, 2011 at 6:02 AM,  <Tim.Haering at lwf.bayern.de> wrote:
>> Tim,
>>
>> That is a tough one. Can you send me the result of
>>
>> traceback()
>
> Here is the result:
>> mod.gam <- gam(y ~ Slope + Boen_By50m + Hoehe_abs, data=train, family=binomial())
>> p <- predict(object = r, model = mod.gam, filename='gebiet_1/sturmwurf.img',
> ?progress='text', na.rm = FALSE, overwrite = TRUE, format = 'HFA', type='response')
> ?| ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?|
> ?0%Error in object[-omit, , drop = FALSE] : incorrect number of dimensions
>> traceback()
> 7: na.omit.default(v)
> 6: na.omit(v)
> 5: writeValues(predrast, predv, tr$row[i])
> 4: writeValues(predrast, predv, tr$row[i])
> 3: .local(object, ...)
> 2: predict(object = r, model = mod.gam, filename = "gebiet_1/sturmwurf.img",
> ? ? ? progress = "text", na.rm = FALSE, overwrite = TRUE, format = "HFA",
> ? ? ? type = "response")
> 1: predict(object = r, model = mod.gam, filename = "gebiet_1/sturmwurf.img",
> ? ? ? progress = "text", na.rm = FALSE, overwrite = TRUE, format = "HFA",
> ? ? ? type = "response")
>
>
>
> I think I found the error. In my rasterStack NA were present. And since the "na.rm" argument is set to FALSE, predict() fails.
> Attached you find data. Hopefully they can help you to clarify, because though it is working now by setting na.rm=TRUE, it is still curious why predict() is working with lm() or glm() models but not with gam().
>
(...)
>
> Thank you.
>
> All the best,
> TIM
>


From Roger.Bivand at nhh.no  Thu May 12 19:58:30 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 12 May 2011 19:58:30 +0200 (CEST)
Subject: [R-sig-Geo] Help with rounding legend intervals within a
 function
In-Reply-To: <BANLkTi=mYHi1QYuUjn+zyNKPdJHZFHTFNw@mail.gmail.com>
References: <BANLkTi=mYHi1QYuUjn+zyNKPdJHZFHTFNw@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1105121955110.21994@reclus.nhh.no>

On Thu, 12 May 2011, Christopher S. Fowler wrote:

> I am producing a large number of maps and wanted to build a function
> to set the class interval breaks (and round them to three digits)
> within my own function. I found a very helpful interchange at:
>
> https://stat.ethz.ch/pipermail/r-sig-geo/2007-July/002350.html
>
> where the mechanics of how to round legend intervals were set out.
> With a few modifications I want to implement that code within my
> function.
> ___________________________________________________
> library(cluster)
> library(maptools)
> library(RColorBrewer)
> library(classInt)
>
> #the function accepts a shapefile, a vector of values to plot, a
> #number indicating the number of categories, and a title
> myMap<-function(shape,plot.val,ncls=5,title="Generic Title"){
> plotvar <- plot.val
> nclr <- ncls
> plotclr <- brewer.pal(nclr, "BuPu")
> class <- classIntervals(plotvar, nclr, style = "quantile")
> brks <- round(class$brks, 3)
> brks[1]<-(floor(min(class$brks)*1000))/1000  #makes sure lower bound
>         #is rounded down so it includes lowest value
> brks[length(brks)]<-(ceiling(max(class$brks)*1000))/1000 #makes sure
>         #upper bound is rounded up so it includes highest value
> class <- classIntervals(plotvar, nclr, style = "fixed", fixedBreaks = brks)
> colcode <- findColours(class, plotclr)
>
> par(mar=c(0.5,0.5,0.5,0.5))
> plot(shape, col = colcode)
> legend("topleft", legend=names(attr(colcode, "table")),
>  fill=attr(colcode, "palette"), cex = 0.75, bty = "n")
> }
>
> #Run the function
> xx <- readShapePoly(system.file("shapes/sids.shp", package="maptools")[1],
> IDvar="FIPSNO", proj4string=CRS("+proj=longlat +ellps=clrk66"))
> plot(xx, border="blue", axes=TRUE, las=1)
> names(xx)
> dat <- cbind(xx$SID74, xx$NWBIR74, xx$BIR79)
> fann <- fanny(dat, 3, maxit = 1000)
>
> myMap(xx,fann$membership[,1],ncls=6)
> ________________________________________________________
>
> Running the function (on R 2.13) produces the error:
> "Error in eval(expr, envir, enclos) : object 'brks' not found"
>
> If I run traceback() I get:
>
> 5: eval(expr, envir, enclos)
> 4: eval(mc$...$fixedBreaks)
> 3: sort(eval(mc$...$fixedBreaks))
> 2: classIntervals(plotvar, nclr, style = "fixed", fixedBreaks = brks)
> 1: myMap(xx, fann$membership[, 1], ncls = 6)
>
> what appears to be happening is that the eval expression is using the
> main variable environment (if I run the code outside of the function
> it works fine, or if I leave an object named brks in the main variable
> environment it will see that variable and the function works).

Correct diagnosis. I can't see an obvious way of fixing the bug in 
classIntervals() quickly, so for the time being, assign the object to the 
global environment within the function:

...
brks[length(brks)]<-(ceiling(max(class$brks)*1000))/1000 #makes sure
         #upper bound is rounded up so it includes highest value
assign("brks", brks, globalenv())
class <- classIntervals(plotvar, nclr, style="fixed", fixedBreaks=brks)
...

I'll try to fix this later.

Roger


>
> My question is, how do I create the brks variable within the context of
> the function so eval can see it, or how do I get the eval expression
> to see the brks variable in my function environment? I am leaning
> towards the former since I don't want to have to use a custom version
> of the classIntervals function if I don't have to.
>
> Thanks for any assistance
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From laura.poggio at gmail.com  Fri May 13 10:09:03 2011
From: laura.poggio at gmail.com (Laura Poggio)
Date: Fri, 13 May 2011 09:09:03 +0100
Subject: [R-sig-Geo] problems with unconditional simulations (grf) in geoR
 1.6.33-34 and RandomFields 2.0.4x
Message-ID: <BANLkTikh2_ss1WMWswSraO9E4yRqyZEHGA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110513/0a5d3e67/attachment.pl>

From tom.hilinski at colostate.edu  Fri May 13 15:53:30 2011
From: tom.hilinski at colostate.edu (Tom Hilinski)
Date: Fri, 13 May 2011 07:53:30 -0600
Subject: [R-sig-Geo] projectRaster error with netcdf
Message-ID: <4DCD37DA.1020806@colostate.edu>

Having an error in getting library raster to read data from a netcdf
file when reprojecting a raster.
I'd appreciate any workarounds you can suggest.
Here's the debug transcript:

-----
debug at NARR.R#142: r <- projectRaster(r, "+proj=longlat +ellps=WGS84
+datum=WGS84 +no_defs")

Browse[2]> r
class       : RasterLayer
band        : 1
dimensions  : 277, 349, 96673  (nrow, ncol, ncell)
resolution  : 0.8428132, 0.1651133  (x, y)
extent      : -145.5, 148.6418, 0.897945, 46.63433  (xmin, xmax, ymin, ymax)
projection  : +proj=lcc +lat_1=50.0 +lat_2=50.0 +lon_0=-107.0
+lat_0=50.0 +x_0=5632642.22547 +y_0=4612545.65137 +ellps=WGS84
+datum=WGS84 +units=m +no_defs +towgs84=0,0,0
values      : <snip>/soilm.mon.mean.nc
min         : ?
max         : ?

Browse[2]> file.exists( r at file@name )
[1] TRUE

Browse[2]> n
Error in .rasterObjectFromFile(x, band = band, objecttype =
"RasterLayer",  :
  Cannot create a RasterLayer object from this file. (file does not exist)
-----

library versions:
raster_1.8-12 rgdal_0.6-33  sp_0.9-81     ncdf_1.6.5


From r.hijmans at gmail.com  Fri May 13 18:16:43 2011
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Fri, 13 May 2011 09:16:43 -0700 (PDT)
Subject: [R-sig-Geo] projectRaster error with netcdf
In-Reply-To: <4DCD37DA.1020806@colostate.edu>
References: <4DCD37DA.1020806@colostate.edu>
Message-ID: <1305303403346-6359973.post@n2.nabble.com>


The second argument in projectRaster is another Raster* object, not a proj.4
string. 

I expect this problem goes away if you do:

x <- projectRaster(r, crs="+proj=longlat +ellps=WGS84 +datum=WGS84
+no_defs")

Robert

>Having an error in getting library raster to read data from a netcdf 
>file when reprojecting a raster. 
>I'd appreciate any workarounds you can suggest. 
>Here's the debug transcript: 
>
>----- 
>debug at NARR.R#142: r <- projectRaster(r, "+proj=longlat +ellps=WGS84 
>+datum=WGS84 +no_defs")

>Browse[2]> n 
>Error in .rasterObjectFromFile(x, band = band, objecttype = 
>"RasterLayer",  : 
>  Cannot create a RasterLayer object from this file. (file does not exist) 

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/projectRaster-error-with-netcdf-tp6359514p6359973.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From brwin338 at aol.com  Fri May 13 19:51:12 2011
From: brwin338 at aol.com (brwin338)
Date: Fri, 13 May 2011 13:51:12 -0400
Subject: [R-sig-Geo] Packages with projections and inverse projections
Message-ID: <8CDDFAD7B5BF75D-202C-4D76@Webmail-d113.sysops.aol.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110513/3125b53c/attachment.pl>

From Roger.Bivand at nhh.no  Fri May 13 19:56:57 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 13 May 2011 19:56:57 +0200
Subject: [R-sig-Geo] Packages with projections and inverse projections
In-Reply-To: <8CDDFAD7B5BF75D-202C-4D76@Webmail-d113.sysops.aol.com>
References: <8CDDFAD7B5BF75D-202C-4D76@Webmail-d113.sysops.aol.com>
Message-ID: <alpine.LRH.2.00.1105131955000.3693@reclus.nhh.no>

On Fri, 13 May 2011, brwin338 wrote:

http://cran.r-project.org/web/views/Spatial.html

under Reading and writing spatial data

points to rgdal, which provides complete PROJ.4 support for sp objects in 
spTransform() and for matrixes of coordinates in project().

Roger

>
> Good morning, Are there any R packages that have coded the functions 
> involved in projecting long-lats into alternative map projection units 
> AND have also coded the inverse projections from the alternative map 
> projection units into long-lat units?  I have two vectors of coordinates 
> in Lambert Conic Conformal units (along with all the associated LCC 
> projection parameters) that I want to project into long-lat units. I 
> will also want to transform a set of long-lat coordinates back into the 
> LCC units for plotting purposes .  I can code my own functions for this 
> application but I was hoping that someone had already written a set of 
> functions for projections and inverse projections for most of the 
> commonly used projections.
>
> I have not yet figured out if I can use 'mapproj' to obtain my desired 
> results.
>
> A related question:  Is there an R package that could be used to 
> reproject a given shapefile and create and save a new shapefile with the 
> new projection? Thanks Joe
>
>
>
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From HodgessE at uhd.edu  Sat May 14 06:44:21 2011
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Fri, 13 May 2011 23:44:21 -0500
Subject: [R-sig-Geo] creating a shp file from a tiff file
Message-ID: <586A4828D7AAA04CA9B258C50A28DA206DB7AB@BALI.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110513/b42a28d5/attachment.pl>

From elaine.kuo.tw at gmail.com  Sat May 14 15:14:22 2011
From: elaine.kuo.tw at gmail.com (elaine kuo)
Date: Sat, 14 May 2011 21:14:22 +0800
Subject: [R-sig-Geo] get the centroid of multiple grid centroids
Message-ID: <BANLkTi=8t2csZoi8-E6w7wtdcN=Unac9Pg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110514/63273b98/attachment.pl>

From csilva at ipimar.pt  Sat May 14 16:55:22 2011
From: csilva at ipimar.pt (Cristina Silva)
Date: Sat, 14 May 2011 15:55:22 +0100
Subject: [R-sig-Geo] Help with contour plots
Message-ID: <4DCE97DA.9000609@ipimar.pt>

Dear all,

I have a SpatialLinesDataFrame with bathymetric lines, built with:

cl <- 
ContourLines2SLDF(contourLines(as.image.SpatialGridDataFrame(prof.grid2["z"]), 
levels=c(50, 100, 200, 300, 400, 500, 600, 700, 800, 900, 1000, 2000, 
3000, 4000)))

This object has all the bathymetric lines. Is there any way to plot some 
of the lines using this object or do I have to build the SLDF with only 
the lines that I want to plot?

Regards,

Cristina


-- 
------------------------------------------
Cristina Silva
INRB/L-IPIMAR
Unidade de Recursos Marinhos e Sustentabilidade
Av. de Bras?lia, 1449-006 Lisboa
Portugal
Tel.: 351 21 3027096
Fax: 351 21 3015948
csilva at ipimar.pt


From b.rowlingson at lancaster.ac.uk  Sat May 14 18:53:53 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Sat, 14 May 2011 17:53:53 +0100
Subject: [R-sig-Geo] creating a shp file from a tiff file
In-Reply-To: <586A4828D7AAA04CA9B258C50A28DA206DB7AB@BALI.uhd.campus>
References: <586A4828D7AAA04CA9B258C50A28DA206DB7AB@BALI.uhd.campus>
Message-ID: <BANLkTinzwgSivs2r6DrWF=7+9LMzpAd9qg@mail.gmail.com>

On Sat, May 14, 2011 at 5:44 AM, Hodgess, Erin <HodgessE at uhd.edu> wrote:
> Dear R Sig Geo People;
>
> I have a question which I suspect might be very simple, but here it goes: ?I have a tiff file would like to create a shp file.
>
> So far, I have used the readTiff function to create a pixmap. ?But I'm not sure where to go from here.
>
> My goal is to create a shp file to be used in ArcGIS, please.
>
> Thanks for any help.

 Right, you want to convert from a raster grid (tiff) to a vector
format. There's a number of ways this could go down, depending on
exactly what you have and what you are trying to do...

 Firstly, is the tiff showing points, lines, or polygons?

 Does the tiff show the outlines, as if it was a scan of a line map,
or is it solid shading of areas? Are all the values in solid areas
exactly the same, or is it noisy?

  How many bands is it?

 I'm sure there are ways to do many of these things in R (and in
GRASS, definitely) but you need to be a bit clearer about the
transformation you are trying to do!

Barry


From zenlines at gmail.com  Sat May 14 20:05:50 2011
From: zenlines at gmail.com (Brian Oney)
Date: Sat, 14 May 2011 20:05:50 +0200
Subject: [R-sig-Geo] creating a shp file from a tiff file
Message-ID: <4DCEC47E.3020309@gmail.com>

Hi Erin,

depending on what you would like to there are a few functions in the
raster package that  may help. If you have a raster and would just like
the outline of it I would reccommend:

library(spgrass6)
gisDbase<-"D:/GIS_Database/"

sgdf<- readGDAL(fname='raster.tif', p4s="+proj=longlat +datum=WGS84
+ellps=WGS84 +towgs84=0,0,0")

initGRASS("C:/Program_Files_x86/GRASS-64", home=tempdir(),SG=sgdf,
gisDbase=gisDbase,location='loc', mapset='urmapset', override=T)

rasters<- execGRASS("g.mlist", parameters=list(type="rast"),intern=T)

execGRASS("r.to.vect", flags=c("s"), parameters=list(input=rasters,
output=nameit, feature="area"))

execGRASS("v.out.ogr", flags=c("e"), parameters=list(input=nameit,
type="area",
       dsn=shpbase, olayer='vector', format="ESRI_Shapefile"))

I would reccommend getting familiar with GRASS and the spgrass6 package
for (additional) geographic/remote sensing tasks.
With large amounts of data (to process) GRASS performs especially well.

hth,
Brian


On 5/14/2011 12:00 PM, r-sig-geo-request at r-project.org wrote:
>    [R-sig-Geo] creating a shp file from a tiff file


From edzer.pebesma at uni-muenster.de  Sun May 15 19:59:51 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sun, 15 May 2011 19:59:51 +0200
Subject: [R-sig-Geo] Help with contour plots
In-Reply-To: <4DCE97DA.9000609@ipimar.pt>
References: <4DCE97DA.9000609@ipimar.pt>
Message-ID: <4DD01497.7090707@uni-muenster.de>



On 05/14/2011 04:55 PM, Cristina Silva wrote:
> Dear all,
> 
> I have a SpatialLinesDataFrame with bathymetric lines, built with:
> 
> cl <-
> ContourLines2SLDF(contourLines(as.image.SpatialGridDataFrame(prof.grid2["z"]),
> levels=c(50, 100, 200, 300, 400, 500, 600, 700, 800, 900, 1000, 2000,
> 3000, 4000)))
> 
> This object has all the bathymetric lines. Is there any way to plot some
> of the lines using this object or do I have to build the SLDF with only
> the lines that I want to plot?

well, you can do it in a single pass, using selection; try:

plot(cl[1:3])


> 
> Regards,
> 
> Cristina
> 
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From matevz.pavlic at gi-zrmk.si  Sun May 15 20:31:28 2011
From: matevz.pavlic at gi-zrmk.si (=?UTF-8?B?TWF0ZXbFviBQYXZsacSN?=)
Date: Sun, 15 May 2011 20:31:28 +0200
Subject: [R-sig-Geo] density /diversity of points
In-Reply-To: <4DCBCC58.5080805@upm.es>
References: <AD5CA6183570B54F92AA45CE2619F9B901208819@gi-zrmk.si>
	<4DCBCC58.5080805@upm.es>
Message-ID: <AD5CA6183570B54F92AA45CE2619F9B90120892B@gi-zrmk.si>

Hi Marcelino, 

Was out of the office for a while...
Thanks for the help. I think this could work...but can you tell me what this line does?

diversity <- apply(mol.tab,1,function(x) sum(x>0)) 

i cant figure out how diversity is calculated here?

Thanks again for the help, 

matevz

-----Original Message-----
From: Marcelino de la Cruz [mailto:marcelino.delacruz at upm.es] 
Sent: Thursday, May 12, 2011 2:03 PM
To: Matev? Pavli?
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] density /diversity of points

On 12/05/2011 13:12, Matev? Pavli? wrote:
> Hi all,
>
>
>
> I have a point data set (SHP) with coordinates and a attribute (i.e. type of point).
>
> These points are scattered around a fairly big area. What i would like to do is to find a sub-area where density of points sombined with the diversity of type is the biggest.
>
> Does anyone have any idea iff this is somehowe possible to do in R? 
> Any idea would be greatly aprpeciated,
>
>    
To your first question:

library(fortunes)
fortune("Yoda")

;-)

More seriously, you could  transform your shp data in a ppp object with spatstat. See the vignette in spatstat. Then you can use some functions there, for example (with the data set lansing):

library(spatstat)
data(lansing)
plot(lansing)
# get an estimate of point density
lansing.den <- density.ppp(lansing)
plot(lansing.den)

# get an estimate of point diversity (here, for the shake of brevity, at the points themselves)
lansing.tab<- marktable(lansing,R=0.05)
diversity <- apply(lansing.tab,1,function(x) sum(x>0)) lansing.div <- setmarks(lansing,diversity) lansing.div.s <-smooth.ppp(lansing.div)

plot(lansing.div.s)

# select areas with arbitrary high values of  density and diversity plot(eval.im(lansing.div.s >4.5 & (lansing.den/max(lansing.den))>0.9))


HTH. Cheers,

Marcelino



--
_________________________________

Marcelino de la Cruz Rot
Departamento de Biologia Vegetal
E.U.T.I. Agricola
Universidad Politecnica de Madrid
  28040 Madrid
  Tel: 34913365654
  _________________________________

From kji2080 at gmail.com  Mon May 16 04:02:28 2011
From: kji2080 at gmail.com (Jooil Kim)
Date: Mon, 16 May 2011 11:02:28 +0900
Subject: [R-sig-Geo] Contour-filled plotting of sp objects?
Message-ID: <5109F1532CA84E8ABDAA2FF6B518A4FD@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110516/da56bfce/attachment.pl>

From edzer.pebesma at uni-muenster.de  Mon May 16 08:30:33 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 16 May 2011 08:30:33 +0200
Subject: [R-sig-Geo] Contour-filled plotting of sp objects?
In-Reply-To: <5109F1532CA84E8ABDAA2FF6B518A4FD@gmail.com>
References: <5109F1532CA84E8ABDAA2FF6B518A4FD@gmail.com>
Message-ID: <4DD0C489.7020700@uni-muenster.de>



On 05/16/2011 04:02 AM, Jooil Kim wrote:
> spplot(x["dist"], contour=TRUE)

spplot(x["dist"], contour=TRUE, region=FALSE)

takes out the grid values, but I don't know how you can get colours or
contour levels in the plot.

contour(x["dist"], col=bpy.colors(10))

does this, but is based on standard plot, not the spplot/lattice things.

Hth,
-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From tepp at life.ku.dk  Mon May 16 09:24:51 2011
From: tepp at life.ku.dk (Toke Emil Panduro Petersen)
Date: Mon, 16 May 2011 09:24:51 +0200
Subject: [R-sig-Geo] hi everybody
Message-ID: <4DD0ED630200006200041589@gwia2.kvl.dk>

Hi everybody 
Is it possible to correct for the edge effect in your data when using a regression model.
I have to some extent reduce the the effect of the spatial autocorrelation using a standard spatial lag model. 

Cheers Toke Emil 
 


From mathieu.rajerison at gmail.com  Mon May 16 09:41:02 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Mon, 16 May 2011 09:41:02 +0200
Subject: [R-sig-Geo] density /diversity of points
In-Reply-To: <AD5CA6183570B54F92AA45CE2619F9B90120892B@gi-zrmk.si>
References: <AD5CA6183570B54F92AA45CE2619F9B901208819@gi-zrmk.si>
	<4DCBCC58.5080805@upm.es>
	<AD5CA6183570B54F92AA45CE2619F9B90120892B@gi-zrmk.si>
Message-ID: <BANLkTimKya4MHXGQL_LcEpGJkC=_-AvP_g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110516/bed3a31d/attachment.pl>

From mathieu.rajerison at gmail.com  Mon May 16 09:41:31 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Mon, 16 May 2011 09:41:31 +0200
Subject: [R-sig-Geo] get the centroid of multiple grid centroids
In-Reply-To: <BANLkTi=8t2csZoi8-E6w7wtdcN=Unac9Pg@mail.gmail.com>
References: <BANLkTi=8t2csZoi8-E6w7wtdcN=Unac9Pg@mail.gmail.com>
Message-ID: <BANLkTi=Va128dHCRyDBzMHwZ=KwrGB+qug@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110516/1acb1503/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Mon May 16 09:55:11 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Mon, 16 May 2011 08:55:11 +0100
Subject: [R-sig-Geo] get the centroid of multiple grid centroids
In-Reply-To: <BANLkTi=Va128dHCRyDBzMHwZ=KwrGB+qug@mail.gmail.com>
References: <BANLkTi=8t2csZoi8-E6w7wtdcN=Unac9Pg@mail.gmail.com>
	<BANLkTi=Va128dHCRyDBzMHwZ=KwrGB+qug@mail.gmail.com>
Message-ID: <BANLkTikQw+RnvvtufcE-AHuv2PfWTSvEQQ@mail.gmail.com>

On Mon, May 16, 2011 at 8:41 AM, Mathieu Rajerison
<mathieu.rajerison at gmail.com> wrote:
> Hi,
>
> To get the centroids, you just have to type this:
>
> ctds<-coordinates(polygons)
>
> polygons being a SpatialPolygons(DataFrame) object
> and
> ctds being a SpatialPoints(DataFrame) object

 I'm not sure thats exactly what she needs here...

>> I have multiple bird distribution maps in the form of ArcGIS shape files.
>> The distribution maps are composed of grid polygons. (1 grid= 100 km*
>> 100km)

 Which makes me think you have files like 'bird001.shp', and
'bird002.shp' and so on. One for each bird. The shapefile then has a
square polygon for each grid square the bird has visited. Is that
right?

>> Now I want to obtain the centroids of each bird distribution maps.
>> In the first step, I use "Feature to point" ?to retrieve centroid of each
>> grid within the polygons.
>> Then, please kindly advise if any method in R is available to get the
>> centroid of the grid centroid of each polygons.

 The centroid of a set of points of equal weight is simply the
arithmetic mean of the x and y coordinates. (Note this isn't true for
a polygon defined by a set of points). So just import your point
features into R (save as a point shapefile, read in as a
SpatialPointDataFrame, get the coordinates with coordinates(X) as a
two-column matrix, then take the mean of each column.

 If you read in your original grid squares into R as
SpatialPolygonDataFrame, "G" say, then you can do the equivalent to
'Feature to Point' by doing pts=coordinates(G). That will give you the
coordinates of the centre of each grid square.

 The other way of doing this would be to merge all the grid squares in
R to a single feature (a SpatialPolygonDataFrame with one row) and
using coordinates(XX) on that to get a single coordinate. But I think
you'd get the same answer.

 If you want to weight some grid squares more than others, maybe by
the number of visits by the bird, then duplicate the coordinate that
many times in the coordinates matrix and take the means again.

Barry


From marcelino.delacruz at upm.es  Mon May 16 09:59:02 2011
From: marcelino.delacruz at upm.es (marcelino.delacruz at upm.es)
Date: Mon, 16 May 2011 08:59:02 +0100
Subject: [R-sig-Geo] density /diversity of points
In-Reply-To: <AD5CA6183570B54F92AA45CE2619F9B90120892B@gi-zrmk.si>
Message-ID: <zolGN6Pn.1305532742.5958350.marcelino.delacruz@upm.es>

Con fecha 15/5/2011, "Matev? Pavli&#269;" <matevz.pavlic at gi-zrmk.si>
escribi?:

>Hi Marcelino, 
>
>Was out of the office for a while...
>Thanks for the help. I think this could work...but can you tell me what this line does?
>
>diversity <- apply(mol.tab,1,function(x) sum(x>0)) 


mol.tab is a table with the number of occurrences of each type (columns)
in the neighborhood of each point (rows). This line computes for each
row (i.e. for each point) the number of types whose value is ">0"
(i.e. types that are present in the neighborhood). This is a very simple
definition of diversity (i.e. "richness"). From that table you could
also compute Shannon or Simpson diversity indices, if you would prefer
that.


Marcelino

>
>i cant figure out how diversity is calculated here?
>
>Thanks again for the help, 
>
>matevz
>
>-----Original Message-----
>From: Marcelino de la Cruz [mailto:marcelino.delacruz at upm.es] 
>Sent: Thursday, May 12, 2011 2:03 PM
>To: Matev?? Pavli??
>Cc: r-sig-geo at r-project.org
>Subject: Re: [R-sig-Geo] density /diversity of points
>
>On 12/05/2011 13:12, Matev?? Pavli?? wrote:
>> Hi all,
>>
>>
>>
>> I have a point data set (SHP) with coordinates and a attribute (i.e. type of point).
>>
>> These points are scattered around a fairly big area. What i would like to do is to find a sub-area where density of points sombined with the diversity of type is the biggest.
>>
>> Does anyone have any idea iff this is somehowe possible to do in R? 
>> Any idea would be greatly aprpeciated,
>>
>>    
>To your first question:
>
>library(fortunes)
>fortune("Yoda")
>
>;-)
>
>More seriously, you could  transform your shp data in a ppp object with spatstat. See the vignette in spatstat. Then you can use some functions there, for example (with the data set lansing):
>
>library(spatstat)
>data(lansing)
>plot(lansing)
># get an estimate of point density
>lansing.den <- density.ppp(lansing)
>plot(lansing.den)
>
># get an estimate of point diversity (here, for the shake of brevity, at the points themselves)
>lansing.tab<- marktable(lansing,R=0.05)
>diversity <- apply(lansing.tab,1,function(x) sum(x>0)) lansing.div <- setmarks(lansing,diversity) lansing.div.s <-smooth.ppp(lansing.div)
>
>plot(lansing.div.s)
>
># select areas with arbitrary high values of  density and diversity plot(eval.im(lansing.div.s >4.5 & (lansing.den/max(lansing.den))>0.9))
>
>
>HTH. Cheers,
>
>Marcelino
>
>
>
>--
>_________________________________
>
>Marcelino de la Cruz Rot
>Departamento de Biologia Vegetal
>E.U.T.I. Agricola
>Universidad Politecnica de Madrid
>  28040 Madrid
>  Tel: 34913365654
>  _________________________________
>


From matevz.pavlic at gi-zrmk.si  Mon May 16 10:27:25 2011
From: matevz.pavlic at gi-zrmk.si (=?UTF-8?B?TWF0ZXbFviBQYXZsacSN?=)
Date: Mon, 16 May 2011 10:27:25 +0200
Subject: [R-sig-Geo] density /diversity of points
In-Reply-To: <zolGN6Pn.1305532742.5958350.marcelino.delacruz@upm.es>
References: <AD5CA6183570B54F92AA45CE2619F9B90120892B@gi-zrmk.si>
	<zolGN6Pn.1305532742.5958350.marcelino.delacruz@upm.es>
Message-ID: <AD5CA6183570B54F92AA45CE2619F9B9012089B2@gi-zrmk.si>

Hi all, 

I read (just now) about the Simpson idex. This would probably be a good thing to try in my case. Do you have any ideas of how to create a diversity map using Simpson index? 

. I have just a few more questions about the code :

The line below as I understand sets a table for each point with the type of points that are in the near in the radius R=350 units?
mol.tab<- marktable(mol.ppp,R=350)

And this line creates a surface(map) of diversity ? 
lansing.div.s <-smooth.ppp(lansing.div) 

I think this map that is created with smooth.ppp is to rough giving to little detail on the diversity. Would it be possible to use kriging to create diversity map?

Thanks for the help, 

m

-----Original Message-----
From: marcelino.delacruz at upm.es [mailto:marcelino.delacruz at upm.es] 
Sent: Monday, May 16, 2011 9:59 AM
To: Matev? Pavli?
Cc: r-sig-geo at r-project.org
Subject: RE: [R-sig-Geo] density /diversity of points

Con fecha 15/5/2011, "Matev? Pavli&#269;" <matevz.pavlic at gi-zrmk.si>
escribi?:

>Hi Marcelino, 
>
>Was out of the office for a while...
>Thanks for the help. I think this could work...but can you tell me what this line does?
>
>diversity <- apply(mol.tab,1,function(x) sum(x>0)) 


mol.tab is a table with the number of occurrences of each type (columns)
in the neighborhood of each point (rows). This line computes for each
row (i.e. for each point) the number of types whose value is ">0"
(i.e. types that are present in the neighborhood). This is a very simple
definition of diversity (i.e. "richness"). From that table you could
also compute Shannon or Simpson diversity indices, if you would prefer
that.


Marcelino

>
>i cant figure out how diversity is calculated here?
>
>Thanks again for the help, 
>
>matevz
>
>-----Original Message-----
>From: Marcelino de la Cruz [mailto:marcelino.delacruz at upm.es] 
>Sent: Thursday, May 12, 2011 2:03 PM
>To: Matev?? Pavli??
>Cc: r-sig-geo at r-project.org
>Subject: Re: [R-sig-Geo] density /diversity of points
>
>On 12/05/2011 13:12, Matev?? Pavli?? wrote:
>> Hi all,
>>
>>
>>
>> I have a point data set (SHP) with coordinates and a attribute (i.e. type of point).
>>
>> These points are scattered around a fairly big area. What i would like to do is to find a sub-area where density of points sombined with the diversity of type is the biggest.
>>
>> Does anyone have any idea iff this is somehowe possible to do in R? 
>> Any idea would be greatly aprpeciated,
>>
>>    
>To your first question:
>
>library(fortunes)
>fortune("Yoda")
>
>;-)
>
>More seriously, you could  transform your shp data in a ppp object with spatstat. See the vignette in spatstat. Then you can use some functions there, for example (with the data set lansing):
>
>library(spatstat)
>data(lansing)
>plot(lansing)
># get an estimate of point density
>lansing.den <- density.ppp(lansing)
>plot(lansing.den)
>
># get an estimate of point diversity (here, for the shake of brevity, at the points themselves)
>lansing.tab<- marktable(lansing,R=0.05)
>diversity <- apply(lansing.tab,1,function(x) sum(x>0)) lansing.div <- setmarks(lansing,diversity) lansing.div.s <-smooth.ppp(lansing.div)
>
>plot(lansing.div.s)
>
># select areas with arbitrary high values of  density and diversity plot(eval.im(lansing.div.s >4.5 & (lansing.den/max(lansing.den))>0.9))
>
>
>HTH. Cheers,
>
>Marcelino
>
>
>
>--
>_________________________________
>
>Marcelino de la Cruz Rot
>Departamento de Biologia Vegetal
>E.U.T.I. Agricola
>Universidad Politecnica de Madrid
>  28040 Madrid
>  Tel: 34913365654
>  _________________________________
>

From marceivissa at gmail.com  Mon May 16 19:01:44 2011
From: marceivissa at gmail.com (=?ISO-8859-1?Q?Marc_Mar=ED_Dell=27Olmo?=)
Date: Mon, 16 May 2011 19:01:44 +0200
Subject: [R-sig-Geo] edit.nb problem with an island
Message-ID: <BANLkTinr9Z6cKecdDgaPP0MPzw5U2F9asA@mail.gmail.com>

Dear all,

I have a cartography with an island, i.e. a polygon that doesn't share
border with other polygons (CODIGO=3120104012). I would like to
manually assign two areas (CODIGO=3120103024 and CODIGO=3120103014) as
a neighborhood areas of this island with the edit.nb function, and
after that to obtain the neighborhood matrix. I have followed this
syntax and I don't understand why the summary(x.nb2) still shows one
region with no link...

If it helps, you can download the map at:
http://dl.dropbox.com/u/14934021/map.zip


Thank you very much,

Marc

map<-readShapePoly("F:/map/map.shp")
map<-map[order(map$CODIGO),]


x.nb<-poly2nb(map)
summary(x.nb)

#Neighbour list object:
#Number of regions: 122
#Number of nonzero links: 724
#Percentage nonzero weights: 4.864284
#Average number of links: 5.934426
#1 region with no links:
#66
#Link number distribution:

 #0  2  3  4  5  6  7  8  9 10 11 12 14
 #1  1  7 19 22 31 21 12  2  2  2  1  1
#1 least connected region:
#101 with 2 links
#1 most connected region:
#29 with 14 links

nb <- x.nb
which(card(nb) == 0)
attr(nb, "region.id")[which(card(nb) == 0)]


x.nb2 <- edit.nb(x.nb,polys=map)

#> x.nb2 <- edit.nb(x.nb,polys=map)
#Identifying contiguity for deletion ...
#No contiguity between chosen points
#Add contiguity? (y/n) y
#added contiguity between point 53 and 67
#Options: quit[q] refresh[r] continue[c] c
#Identifying contiguity for deletion ...
#No contiguity between chosen points
#Add contiguity? (y/n) y
#added contiguity between point 43 and 67
#Options: quit[q] refresh[r] continue[c] q


summary(x.nb2)

#Neighbour list object:
#Number of regions: 122
#Number of nonzero links: 726
#Percentage nonzero weights: 4.877721
#Average number of links: 5.95082
#1 region with no links:
#66
#Non-symmetric neighbours list
#Link number distribution:

 #0  2  3  4  5  6  7  8  9 10 11 12 14
 #1  1  7 18 22 32 21 12  2  2  2  1  1
#1 least connected region:
#101 with 2 links
#1 most connected region:
#29 with 14 links


From mlt at gmx.us  Mon May 16 20:06:23 2011
From: mlt at gmx.us (Mikhail Titov)
Date: Mon, 16 May 2011 13:06:23 -0500
Subject: [R-sig-Geo] How do I read/work with PolyLineZM with maptools/sp?
Message-ID: <001501cc13f3$f88b2130$e9a16390$@us>

Hi all!

I feel like I?m missing something simple. I can access X & Y coordinates like:

s <- readShapeLines(elev)
head(coordinates(s at lines[[1]]@Lines[[1]]))

I can?t seems to find any information on how to access Z and M values. I can easily access those with `shapefiles` package, but it has a limited support for Point Z when writing a shapefile and it is generally not as structured as `maptools`/`sp`. While having Z value as an attribute for an output point is not an issue for me, I do have PolylineZM as an input and I do need an access to both Z & M.

Thank you for any suggestions,
Mikhail


From edzer.pebesma at uni-muenster.de  Mon May 16 20:14:30 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 16 May 2011 20:14:30 +0200
Subject: [R-sig-Geo] How do I read/work with PolyLineZM with maptools/sp?
In-Reply-To: <001501cc13f3$f88b2130$e9a16390$@us>
References: <001501cc13f3$f88b2130$e9a16390$@us>
Message-ID: <4DD16986.9000508@uni-muenster.de>



On 05/16/2011 08:06 PM, Mikhail Titov wrote:
> Hi all!
> 
> I feel like I?m missing something simple. I can access X & Y coordinates like:
> 
> s <- readShapeLines(elev)
> head(coordinates(s at lines[[1]]@Lines[[1]]))
> 
> I can?t seems to find any information on how to access Z and M values. I can easily access those with `shapefiles` package, but it has a limited support for Point Z when writing a shapefile and it is generally not as structured as `maptools`/`sp`. While having Z value as an attribute for an output point is not an issue for me, I do have PolylineZM as an input and I do need an access to both Z & M.
> 

I would try s$M and s$Z to access M and Z when they are attributes.


> Thank you for any suggestions,
> Mikhail
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From mlt at gmx.us  Mon May 16 20:22:15 2011
From: mlt at gmx.us (Mikhail Titov)
Date: Mon, 16 May 2011 13:22:15 -0500
Subject: [R-sig-Geo] How do I read/work with PolyLineZM with maptools/sp?
In-Reply-To: <4DD16986.9000508@uni-muenster.de>
References: <001501cc13f3$f88b2130$e9a16390$@us>
	<4DD16986.9000508@uni-muenster.de>
Message-ID: <001801cc13f6$2ff6d590$8fe480b0$@us>

> I would try s$M and s$Z to access M and Z when they are attributes.
But what do I do when they are not? It can work for points, but not a line as I can't have attributes for individual points of a line. I would prefer not to do any extra conversions in GIS before using R.

Do I get it right that for now it is better to stick with shapefiles to read PolylineZM?

Mikhail


From edzer.pebesma at uni-muenster.de  Mon May 16 20:28:55 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 16 May 2011 20:28:55 +0200
Subject: [R-sig-Geo] How do I read/work with PolyLineZM with maptools/sp?
In-Reply-To: <001801cc13f6$2ff6d590$8fe480b0$@us>
References: <001501cc13f3$f88b2130$e9a16390$@us>
	<4DD16986.9000508@uni-muenster.de>
	<001801cc13f6$2ff6d590$8fe480b0$@us>
Message-ID: <4DD16CE7.7040507@uni-muenster.de>



On 05/16/2011 08:22 PM, Mikhail Titov wrote:
>> I would try s$M and s$Z to access M and Z when they are attributes.
> But what do I do when they are not? It can work for points, but not a line as I can't have attributes for individual points of a line. I would prefer not to do any extra conversions in GIS before using R.
> 

as(s, "SpatialPointsDataFrame")

> Do I get it right that for now it is better to stick with shapefiles to read PolylineZM?
> 
> Mikhail
> 
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From mlt at gmx.us  Mon May 16 20:51:31 2011
From: mlt at gmx.us (Mikhail Titov)
Date: Mon, 16 May 2011 13:51:31 -0500
Subject: [R-sig-Geo] How do I read/work with PolyLineZM with maptools/sp?
In-Reply-To: <4DD16CE7.7040507@uni-muenster.de>
References: <001501cc13f3$f88b2130$e9a16390$@us>
	<4DD16986.9000508@uni-muenster.de>
	<001801cc13f6$2ff6d590$8fe480b0$@us>
	<4DD16CE7.7040507@uni-muenster.de>
Message-ID: <001b01cc13fa$4624f280$d26ed780$@us>

Edzer:

Thank you for your suggestions, but it doesn't help much. It does not recover either Z or M as attributes or anyhow else.

> p <- as(s, "SpatialPointsDataFrame")
> names(p)
[1] "Id"       "Lines.NR" "Lines.ID" "Line.NR" 
> slotNames(p)
[1] "data"        "coords.nrs"  "coords"      "bbox"        "proj4string"
> head(p at coords)
     coords.x1 coords.x2
[1,]  408794.5   4893921
[2,]  409088.3   4893599
[3,]  409165.2   4893484
[4,]  409434.7   4893214
[5,]  409684.9   4893060
[6,]  409742.6   4893060
> head(p at data)
    Id Lines.NR Lines.ID Line.NR
0    1        1        0       1
0.1  1        1        0       1
0.2  1        1        0       1
0.3  1        1        0       1
0.4  1        1        0       1
0.5  1        1        0       1 
> p$Z
NULL
> p$z
NULL

I double checked that I'm working with correct shapefile that has Z values.

Mikhail


> -----Original Message-----
> From: Edzer Pebesma [mailto:edzer.pebesma at uni-muenster.de]
> Sent: Monday, May 16, 2011 1:29 PM
> To: Mikhail Titov
> Cc: r-sig-geo at r-project.org
> Subject: Re: [R-sig-Geo] How do I read/work with PolyLineZM with
> maptools/sp?
> 
> 
> 
> On 05/16/2011 08:22 PM, Mikhail Titov wrote:
> >> I would try s$M and s$Z to access M and Z when they are attributes.
> > But what do I do when they are not? It can work for points, but not a
> line as I can't have attributes for individual points of a line. I would
> prefer not to do any extra conversions in GIS before using R.
> >
> 
> as(s, "SpatialPointsDataFrame")
> 
> > Do I get it right that for now it is better to stick with shapefiles to
> read PolylineZM?
> >
> > Mikhail
> >
> >
> 
> --
> Edzer Pebesma
> Institute for Geoinformatics (ifgi), University of M?nster
> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
> 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
> http://www.52north.org/geostatistics      e.pebesma at wwu.de


From Roger.Bivand at nhh.no  Mon May 16 20:59:05 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 16 May 2011 20:59:05 +0200 (CEST)
Subject: [R-sig-Geo] How do I read/work with PolyLineZM with maptools/sp?
In-Reply-To: <001b01cc13fa$4624f280$d26ed780$@us>
References: <001501cc13f3$f88b2130$e9a16390$@us>
	<4DD16986.9000508@uni-muenster.de>
	<001801cc13f6$2ff6d590$8fe480b0$@us>
	<4DD16CE7.7040507@uni-muenster.de>
	<001b01cc13fa$4624f280$d26ed780$@us>
Message-ID: <alpine.LRH.2.00.1105162055110.18354@reclus.nhh.no>

On Mon, 16 May 2011, Mikhail Titov wrote:

> Edzer:
>
> Thank you for your suggestions, but it doesn't help much. It does not 
> recover either Z or M as attributes or anyhow else.

The Z is dropped for SpatialPolygons and SpatialLines everywhere. The M is 
not a standard part of the specification - it isn't obvious what it should 
be. You'd need to rewrite the C code in shapelib for maptools or rgdal to 
access these, and create a 4D object. Alternatively, try anything perhaps 
in Python with OGR to dump 3D points with M as an attribute, and a 
grouping factor to point to the feature ID in the DBF file.

Roger

>
>> p <- as(s, "SpatialPointsDataFrame")
>> names(p)
> [1] "Id"       "Lines.NR" "Lines.ID" "Line.NR" 
>> slotNames(p)
> [1] "data"        "coords.nrs"  "coords"      "bbox"        "proj4string"
>> head(p at coords)
>     coords.x1 coords.x2
> [1,]  408794.5   4893921
> [2,]  409088.3   4893599
> [3,]  409165.2   4893484
> [4,]  409434.7   4893214
> [5,]  409684.9   4893060
> [6,]  409742.6   4893060
>> head(p at data)
>    Id Lines.NR Lines.ID Line.NR
> 0    1        1        0       1
> 0.1  1        1        0       1
> 0.2  1        1        0       1
> 0.3  1        1        0       1
> 0.4  1        1        0       1
> 0.5  1        1        0       1 
>> p$Z
> NULL
>> p$z
> NULL
>
> I double checked that I'm working with correct shapefile that has Z values.
>
> Mikhail
>
>
>> -----Original Message-----
>> From: Edzer Pebesma [mailto:edzer.pebesma at uni-muenster.de]
>> Sent: Monday, May 16, 2011 1:29 PM
>> To: Mikhail Titov
>> Cc: r-sig-geo at r-project.org
>> Subject: Re: [R-sig-Geo] How do I read/work with PolyLineZM with
>> maptools/sp?
>> 
>> 
>> 
>> On 05/16/2011 08:22 PM, Mikhail Titov wrote:
>> >> I would try s$M and s$Z to access M and Z when they are attributes.
>> > But what do I do when they are not? It can work for points, but not a
>> line as I can't have attributes for individual points of a line. I would
>> prefer not to do any extra conversions in GIS before using R.
>> >
>> 
>> as(s, "SpatialPointsDataFrame")
>> 
>> > Do I get it right that for now it is better to stick with shapefiles to
>> read PolylineZM?
>> >
>> > Mikhail
>> >
>> >
>> 
>> --
>> Edzer Pebesma
>> Institute for Geoinformatics (ifgi), University of M?nster
>> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
>> 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
>> http://www.52north.org/geostatistics      e.pebesma at wwu.de
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From mlt at gmx.us  Mon May 16 21:43:16 2011
From: mlt at gmx.us (Mikhail Titov)
Date: Mon, 16 May 2011 14:43:16 -0500
Subject: [R-sig-Geo] How do I read/work with PolyLineZM with maptools/sp?
In-Reply-To: <alpine.LRH.2.00.1105162055110.18354@reclus.nhh.no>
References: <001501cc13f3$f88b2130$e9a16390$@us>
	<4DD16986.9000508@uni-muenster.de>
	<001801cc13f6$2ff6d590$8fe480b0$@us>
	<4DD16CE7.7040507@uni-muenster.de>
	<001b01cc13fa$4624f280$d26ed780$@us>
	<alpine.LRH.2.00.1105162055110.18354@reclus.nhh.no>
Message-ID: <002a01cc1401$81589210$8409b630$@us>

Roger:

I see. It is not a 5-minute job. I'll leave my script as is with `shapefiles` package for now as it is working okay. I just have a feeling that shapefiles is getting quite outdated (last published in 2006) and overall trend is towards structured sp and maptools.

Thanks for your help! Perhaps one day ZM support will be available in maptools/sp :-)

P.S. I always thought and used M for route *m*easure data as a distance along the line via `Create Routes` tool in ArcGIS. I don't know how it can be non-standard.

P.P.S. I used `Write Features to Text File` with `Samples` toolbox in ArcGIS. However I want to reduce number of steps overall and I thought I could use shapefiles directly. I would do everything in python with arcgisscripting module, but my script depends on `fda` and monotonic splines in R.

Mikhail


> -----Original Message-----
> From: Roger Bivand [mailto:Roger.Bivand at nhh.no]
> Sent: Monday, May 16, 2011 1:59 PM
> To: Mikhail Titov
> Cc: 'Edzer Pebesma'; r-sig-geo at r-project.org
> Subject: Re: [R-sig-Geo] How do I read/work with PolyLineZM with
> maptools/sp?
> 
> On Mon, 16 May 2011, Mikhail Titov wrote:
> 
> > Edzer:
> >
> > Thank you for your suggestions, but it doesn't help much. It does not
> > recover either Z or M as attributes or anyhow else.
> 
> The Z is dropped for SpatialPolygons and SpatialLines everywhere. The M is
> not a standard part of the specification - it isn't obvious what it should
> be. You'd need to rewrite the C code in shapelib for maptools or rgdal to
> access these, and create a 4D object. Alternatively, try anything perhaps
> in Python with OGR to dump 3D points with M as an attribute, and a
> grouping factor to point to the feature ID in the DBF file.
> 
> Roger
> 
> >
> >> p <- as(s, "SpatialPointsDataFrame")
> >> names(p)
> > [1] "Id"       "Lines.NR" "Lines.ID" "Line.NR"
> >> slotNames(p)
> > [1] "data"        "coords.nrs"  "coords"      "bbox"        "proj4string"
> >> head(p at coords)
> >     coords.x1 coords.x2
> > [1,]  408794.5   4893921
> > [2,]  409088.3   4893599
> > [3,]  409165.2   4893484
> > [4,]  409434.7   4893214
> > [5,]  409684.9   4893060
> > [6,]  409742.6   4893060
> >> head(p at data)
> >    Id Lines.NR Lines.ID Line.NR
> > 0    1        1        0       1
> > 0.1  1        1        0       1
> > 0.2  1        1        0       1
> > 0.3  1        1        0       1
> > 0.4  1        1        0       1
> > 0.5  1        1        0       1
> >> p$Z
> > NULL
> >> p$z
> > NULL
> >
> > I double checked that I'm working with correct shapefile that has Z
> values.
> >
> > Mikhail
> >
> >
> >> -----Original Message-----
> >> From: Edzer Pebesma [mailto:edzer.pebesma at uni-muenster.de]
> >> Sent: Monday, May 16, 2011 1:29 PM
> >> To: Mikhail Titov
> >> Cc: r-sig-geo at r-project.org
> >> Subject: Re: [R-sig-Geo] How do I read/work with PolyLineZM with
> >> maptools/sp?
> >>
> >>
> >>
> >> On 05/16/2011 08:22 PM, Mikhail Titov wrote:
> >> >> I would try s$M and s$Z to access M and Z when they are attributes.
> >> > But what do I do when they are not? It can work for points, but not a
> >> line as I can't have attributes for individual points of a line. I would
> >> prefer not to do any extra conversions in GIS before using R.
> >> >
> >>
> >> as(s, "SpatialPointsDataFrame")
> >>
> >> > Do I get it right that for now it is better to stick with shapefiles
> to
> >> read PolylineZM?
> >> >
> >> > Mikhail
> >> >
> >> >
> >>
> >> --
> >> Edzer Pebesma
> >> Institute for Geoinformatics (ifgi), University of M?nster
> >> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
> >> 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
> >> http://www.52north.org/geostatistics      e.pebesma at wwu.de
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> --
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Mon May 16 23:06:39 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 16 May 2011 23:06:39 +0200 (CEST)
Subject: [R-sig-Geo] How do I read/work with PolyLineZM with maptools/sp?
In-Reply-To: <002a01cc1401$81589210$8409b630$@us>
References: <001501cc13f3$f88b2130$e9a16390$@us>
	<4DD16986.9000508@uni-muenster.de>
	<001801cc13f6$2ff6d590$8fe480b0$@us>
	<4DD16CE7.7040507@uni-muenster.de>
	<001b01cc13fa$4624f280$d26ed780$@us>
	<alpine.LRH.2.00.1105162055110.18354@reclus.nhh.no>
	<002a01cc1401$81589210$8409b630$@us>
Message-ID: <alpine.LRH.2.00.1105162259360.18704@reclus.nhh.no>

On Mon, 16 May 2011, Mikhail Titov wrote:

> Roger:
>
> I see. It is not a 5-minute job. I'll leave my script as is with 
> `shapefiles` package for now as it is working okay. I just have a 
> feeling that shapefiles is getting quite outdated (last published in 
> 2006) and overall trend is towards structured sp and maptools.
>
> Thanks for your help! Perhaps one day ZM support will be available in 
> maptools/sp :-)

OGR says that it will not be returned:

http://www.gdal.org/ogr/drv_shapefile.html

>
> P.S. I always thought and used M for route *m*easure data as a distance 
> along the line via `Create Routes` tool in ArcGIS. I don't know how it 
> can be non-standard.

It always was a kludge. I guess that it could once have been intended to 
hold a precision value, but is not used as such systematically. The 
maptools interface could return it, but there is no structure to put it 
in, as it is data at the point level, not the feature level. It is not in 
accord with OGC SFS, I think. It could be an extra function returning any 
such file as a SpatialPointsDataFrame with Z, M, and FID data fields. The 
FID could then be used to link to the data in the DBF.

Roger

>
> P.P.S. I used `Write Features to Text File` with `Samples` toolbox in 
> ArcGIS. However I want to reduce number of steps overall and I thought I 
> could use shapefiles directly. I would do everything in python with 
> arcgisscripting module, but my script depends on `fda` and monotonic 
> splines in R.
>
> Mikhail
>
>
>> -----Original Message-----
>> From: Roger Bivand [mailto:Roger.Bivand at nhh.no]
>> Sent: Monday, May 16, 2011 1:59 PM
>> To: Mikhail Titov
>> Cc: 'Edzer Pebesma'; r-sig-geo at r-project.org
>> Subject: Re: [R-sig-Geo] How do I read/work with PolyLineZM with
>> maptools/sp?
>>
>> On Mon, 16 May 2011, Mikhail Titov wrote:
>>
>>> Edzer:
>>>
>>> Thank you for your suggestions, but it doesn't help much. It does not
>>> recover either Z or M as attributes or anyhow else.
>>
>> The Z is dropped for SpatialPolygons and SpatialLines everywhere. The M is
>> not a standard part of the specification - it isn't obvious what it should
>> be. You'd need to rewrite the C code in shapelib for maptools or rgdal to
>> access these, and create a 4D object. Alternatively, try anything perhaps
>> in Python with OGR to dump 3D points with M as an attribute, and a
>> grouping factor to point to the feature ID in the DBF file.
>>
>> Roger
>>
>>>
>>>> p <- as(s, "SpatialPointsDataFrame")
>>>> names(p)
>>> [1] "Id"       "Lines.NR" "Lines.ID" "Line.NR"
>>>> slotNames(p)
>>> [1] "data"        "coords.nrs"  "coords"      "bbox"        "proj4string"
>>>> head(p at coords)
>>>     coords.x1 coords.x2
>>> [1,]  408794.5   4893921
>>> [2,]  409088.3   4893599
>>> [3,]  409165.2   4893484
>>> [4,]  409434.7   4893214
>>> [5,]  409684.9   4893060
>>> [6,]  409742.6   4893060
>>>> head(p at data)
>>>    Id Lines.NR Lines.ID Line.NR
>>> 0    1        1        0       1
>>> 0.1  1        1        0       1
>>> 0.2  1        1        0       1
>>> 0.3  1        1        0       1
>>> 0.4  1        1        0       1
>>> 0.5  1        1        0       1
>>>> p$Z
>>> NULL
>>>> p$z
>>> NULL
>>>
>>> I double checked that I'm working with correct shapefile that has Z
>> values.
>>>
>>> Mikhail
>>>
>>>
>>>> -----Original Message-----
>>>> From: Edzer Pebesma [mailto:edzer.pebesma at uni-muenster.de]
>>>> Sent: Monday, May 16, 2011 1:29 PM
>>>> To: Mikhail Titov
>>>> Cc: r-sig-geo at r-project.org
>>>> Subject: Re: [R-sig-Geo] How do I read/work with PolyLineZM with
>>>> maptools/sp?
>>>>
>>>>
>>>>
>>>> On 05/16/2011 08:22 PM, Mikhail Titov wrote:
>>>>>> I would try s$M and s$Z to access M and Z when they are attributes.
>>>>> But what do I do when they are not? It can work for points, but not a
>>>> line as I can't have attributes for individual points of a line. I would
>>>> prefer not to do any extra conversions in GIS before using R.
>>>>>
>>>>
>>>> as(s, "SpatialPointsDataFrame")
>>>>
>>>>> Do I get it right that for now it is better to stick with shapefiles
>> to
>>>> read PolylineZM?
>>>>>
>>>>> Mikhail
>>>>>
>>>>>
>>>>
>>>> --
>>>> Edzer Pebesma
>>>> Institute for Geoinformatics (ifgi), University of M?nster
>>>> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
>>>> 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
>>>> http://www.52north.org/geostatistics      e.pebesma at wwu.de
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> --
>> Roger Bivand
>> Economic Geography Section, Department of Economics, Norwegian School of
>> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From sep at umail.ucsb.edu  Mon May 16 23:25:02 2011
From: sep at umail.ucsb.edu (Sam Prentice)
Date: Mon, 16 May 2011 14:25:02 -0700
Subject: [R-sig-Geo] readRAST6() in {spgrass6}
In-Reply-To: <BANLkTi=1MTqesqeiyaoAp0kapSJc271JfA@mail.gmail.com>
References: <003f01cc0f48$3f7a66b0$be6f3410$@umail.ucsb.edu>
	<BANLkTi=1MTqesqeiyaoAp0kapSJc271JfA@mail.gmail.com>
Message-ID: <007701cc140f$b84227b0$28c67710$@umail.ucsb.edu>

Thanks you for your suggestions. This error is not affected by choice of
mapset, and is not limited by my hardware.

Further info: I'm running 64-bit windows, 16MB memory, w/multiple cores.
GRASS 6.4.1, R 2.12.2. I'm running standalone R using initGRASS() to set
GRASS env parameters. The GRASS files I'm trying to read-in are DEM
derivatives, each ~170MB. The intermediate .tmp file in the error message is
300MB.

It's been suggested that I am "likely trying to import too much data into
R". Assuming non-limiting computer power, what is the upper bound on amount
of data that can be read into R from GRASS? If not a fixed amount, what are
the main conditions that cause it to vary? I did not see this addressed in
the {spgrass6} documentation, so I'm assuming it's a base R limitation, but
maybe not? Quantifying this limitation will help determined how to move
forward (e.g, resampling at smaller scale versus subsetting my DEM
derivatives).

Thanks,
Sam

|-----Original Message-----
|From: Pierre Roudier [mailto:pierre.roudier at gmail.com]
|Sent: Tuesday, May 10, 2011 3:40 PM
|To: Sam Prentice
|Cc: r-sig-geo at r-project.org
|Subject: Re: [R-sig-Geo] readRAST6() in {spgrass6}
|
|Could that message have anything to do with the fact that this is a layer
from
|the PERMANENT mapset?
|
|My two cents,
|
|Pierre
|
|2011/5/11 Sam Prentice <sep at umail.ucsb.edu>:
|> Hi,
|>
|>
|>
|> I'm running R 2.12.2 via Tinn-R on Windows Server 2008. I'm using R
|> for cluster analysis for terrain classification and I'm getting the
|> following error when parsing GRASS data into R:
|>
|>
|>
|>> x =
|>
|readRAST6(c("param_elev3","param_crosC_1m","param_longC_1m","param
|_slope5","
|> param_profC","param_miniC_1m","param_maxiC_1m"))
|>
|> D:/GRASSdata/Sedgwick2/PERMANENT/.tmp/param_elev3 has GDAL driver
|> GTiff
|>
|> and has 6224 rows and 6242 columns
|>
|>
|>
|> Error in deleteDataset(DS) :
|>
|> ? ? ? ? ? ? ? ?GDAL Error 1: Deleting
|> D:/GRASSdata/Sedgwick2/PERMANENT/.tmp/param_elev3 failed:
|>
|> Permission denied
|>
|>
|>
|> On the surface this looked like an issue with user privileges, since I
|> do not have admin-level user privileges on this machine. However, this
|> has been corrected - I now have permissions on the .tmp directory
|> listed in the error, and I can create, append, and delete any file in
|> that location, but the error is still occurring.
|>
|>
|>
|> Thoughts?
|>
|>
|>
|> Thanks,
|>
|> Sam
|>
|>
|> ? ? ? ?[[alternative HTML version deleted]]
|>
|> _______________________________________________
|> R-sig-Geo mailing list
|> R-sig-Geo at r-project.org
|> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
|>
|
|
|
|--
|Scientist
|Landcare Research, New Zealand


From dylan.beaudette at gmail.com  Mon May 16 23:38:39 2011
From: dylan.beaudette at gmail.com (Dylan Beaudette)
Date: Mon, 16 May 2011 14:38:39 -0700
Subject: [R-sig-Geo] readRAST6() in {spgrass6}
In-Reply-To: <007701cc140f$b84227b0$28c67710$@umail.ucsb.edu>
References: <003f01cc0f48$3f7a66b0$be6f3410$@umail.ucsb.edu>
	<BANLkTi=1MTqesqeiyaoAp0kapSJc271JfA@mail.gmail.com>
	<007701cc140f$b84227b0$28c67710$@umail.ucsb.edu>
Message-ID: <BANLkTi=rPeh9nrXh6ZdDbAjzHzzz=DtQgA@mail.gmail.com>

It is hard to know what the upper-limit is on Windows-- as the memory
is usually fragmented by the operating system.

Since you are using GRASS, I would first try a coarsened version of
your terrain-shape rasters via the built-in re-sampling functionality.
While this is not ideal, as it is NN-based, it will give a quick way
to try out methods.

After you have initialized your GRASS connection in R, execute something like:

system('g.region res=10 -ap')

This will align the region along a 10x10 map unit grid. All further
interaction with raster data will be automatically re-sampled to this
grid system.

Dylan

On Mon, May 16, 2011 at 2:25 PM, Sam Prentice <sep at umail.ucsb.edu> wrote:
> Thanks you for your suggestions. This error is not affected by choice of
> mapset, and is not limited by my hardware.
>
> Further info: I'm running 64-bit windows, 16MB memory, w/multiple cores.
> GRASS 6.4.1, R 2.12.2. I'm running standalone R using initGRASS() to set
> GRASS env parameters. The GRASS files I'm trying to read-in are DEM
> derivatives, each ~170MB. The intermediate .tmp file in the error message is
> 300MB.
>
> It's been suggested that I am "likely trying to import too much data into
> R". Assuming non-limiting computer power, what is the upper bound on amount
> of data that can be read into R from GRASS? If not a fixed amount, what are
> the main conditions that cause it to vary? I did not see this addressed in
> the {spgrass6} documentation, so I'm assuming it's a base R limitation, but
> maybe not? Quantifying this limitation will help determined how to move
> forward (e.g, resampling at smaller scale versus subsetting my DEM
> derivatives).
>
> Thanks,
> Sam
>
> |-----Original Message-----
> |From: Pierre Roudier [mailto:pierre.roudier at gmail.com]
> |Sent: Tuesday, May 10, 2011 3:40 PM
> |To: Sam Prentice
> |Cc: r-sig-geo at r-project.org
> |Subject: Re: [R-sig-Geo] readRAST6() in {spgrass6}
> |
> |Could that message have anything to do with the fact that this is a layer
> from
> |the PERMANENT mapset?
> |
> |My two cents,
> |
> |Pierre
> |
> |2011/5/11 Sam Prentice <sep at umail.ucsb.edu>:
> |> Hi,
> |>
> |>
> |>
> |> I'm running R 2.12.2 via Tinn-R on Windows Server 2008. I'm using R
> |> for cluster analysis for terrain classification and I'm getting the
> |> following error when parsing GRASS data into R:
> |>
> |>
> |>
> |>> x =
> |>
> |readRAST6(c("param_elev3","param_crosC_1m","param_longC_1m","param
> |_slope5","
> |> param_profC","param_miniC_1m","param_maxiC_1m"))
> |>
> |> D:/GRASSdata/Sedgwick2/PERMANENT/.tmp/param_elev3 has GDAL driver
> |> GTiff
> |>
> |> and has 6224 rows and 6242 columns
> |>
> |>
> |>
> |> Error in deleteDataset(DS) :
> |>
> |> ? ? ? ? ? ? ? ?GDAL Error 1: Deleting
> |> D:/GRASSdata/Sedgwick2/PERMANENT/.tmp/param_elev3 failed:
> |>
> |> Permission denied
> |>
> |>
> |>
> |> On the surface this looked like an issue with user privileges, since I
> |> do not have admin-level user privileges on this machine. However, this
> |> has been corrected - I now have permissions on the .tmp directory
> |> listed in the error, and I can create, append, and delete any file in
> |> that location, but the error is still occurring.
> |>
> |>
> |>
> |> Thoughts?
> |>
> |>
> |>
> |> Thanks,
> |>
> |> Sam
> |>
> |>
> |> ? ? ? ?[[alternative HTML version deleted]]
> |>
> |> _______________________________________________
> |> R-sig-Geo mailing list
> |> R-sig-Geo at r-project.org
> |> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> |>
> |
> |
> |
> |--
> |Scientist
> |Landcare Research, New Zealand
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From Roger.Bivand at nhh.no  Tue May 17 06:28:07 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 17 May 2011 06:28:07 +0200 (CEST)
Subject: [R-sig-Geo] readRAST6() in {spgrass6}
In-Reply-To: <BANLkTi=rPeh9nrXh6ZdDbAjzHzzz=DtQgA@mail.gmail.com>
References: <003f01cc0f48$3f7a66b0$be6f3410$@umail.ucsb.edu>
	<BANLkTi=1MTqesqeiyaoAp0kapSJc271JfA@mail.gmail.com>
	<007701cc140f$b84227b0$28c67710$@umail.ucsb.edu>
	<BANLkTi=rPeh9nrXh6ZdDbAjzHzzz=DtQgA@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1105170613130.20286@reclus.nhh.no>

On Mon, 16 May 2011, Dylan Beaudette wrote:

> It is hard to know what the upper-limit is on Windows-- as the memory
> is usually fragmented by the operating system.

Correct, the upper limit on other OS is higher in practice.

>
> Since you are using GRASS, I would first try a coarsened version of
> your terrain-shape rasters via the built-in re-sampling functionality.
> While this is not ideal, as it is NN-based, it will give a quick way
> to try out methods.
>
> After you have initialized your GRASS connection in R, execute something like:
>
> system('g.region res=10 -ap')
>
> This will align the region along a 10x10 map unit grid. All further
> interaction with raster data will be automatically re-sampled to this
> grid system.

Right, for some res=, you will get a systematic sample that will let you 
decimate your data. Randomly shifting the window while resampling will 
help you see whether your classification model boundaries change.

As both Dylan and I have said, there is no good reason for calibrating the 
classification model with more data than necessary, even if it were 
possible. The only reason to use very much data would be if discrimination 
between very rare classes is your target, but even then you could stratify 
your sample to get better representation of critical areas.

You seem to be looking for classification signatures, from which you are 
going to predict. Sampling will give you distributions of these 
signatures, which could be used for similation by tile. If you are very 
concerned about the statistical quality of your classification signatures, 
you could go fuzzy, but your main goal is to get to the distributions of 
these signatures, IMO. Once you have them, you can predict. You do not 
need to have GBs of dat in memory to do this adequately.

So one could agree that software (OS, R, whatever) is your limitation, but 
it is only a limitation if you are not able to consider more statistical 
approaches to your apparent problem, which is finding out how to classify 
your input, and then to predict to output.

Roger

>
> Dylan
>
> On Mon, May 16, 2011 at 2:25 PM, Sam Prentice <sep at umail.ucsb.edu> wrote:
>> Thanks you for your suggestions. This error is not affected by choice of
>> mapset, and is not limited by my hardware.
>>
>> Further info: I'm running 64-bit windows, 16MB memory, w/multiple cores.
>> GRASS 6.4.1, R 2.12.2. I'm running standalone R using initGRASS() to set
>> GRASS env parameters. The GRASS files I'm trying to read-in are DEM
>> derivatives, each ~170MB. The intermediate .tmp file in the error message is
>> 300MB.
>>
>> It's been suggested that I am "likely trying to import too much data into
>> R". Assuming non-limiting computer power, what is the upper bound on amount
>> of data that can be read into R from GRASS? If not a fixed amount, what are
>> the main conditions that cause it to vary? I did not see this addressed in
>> the {spgrass6} documentation, so I'm assuming it's a base R limitation, but
>> maybe not? Quantifying this limitation will help determined how to move
>> forward (e.g, resampling at smaller scale versus subsetting my DEM
>> derivatives).
>>
>> Thanks,
>> Sam
>>
>> |-----Original Message-----
>> |From: Pierre Roudier [mailto:pierre.roudier at gmail.com]
>> |Sent: Tuesday, May 10, 2011 3:40 PM
>> |To: Sam Prentice
>> |Cc: r-sig-geo at r-project.org
>> |Subject: Re: [R-sig-Geo] readRAST6() in {spgrass6}
>> |
>> |Could that message have anything to do with the fact that this is a layer
>> from
>> |the PERMANENT mapset?
>> |
>> |My two cents,
>> |
>> |Pierre
>> |
>> |2011/5/11 Sam Prentice <sep at umail.ucsb.edu>:
>> |> Hi,
>> |>
>> |>
>> |>
>> |> I'm running R 2.12.2 via Tinn-R on Windows Server 2008. I'm using R
>> |> for cluster analysis for terrain classification and I'm getting the
>> |> following error when parsing GRASS data into R:
>> |>
>> |>
>> |>
>> |>> x =
>> |>
>> |readRAST6(c("param_elev3","param_crosC_1m","param_longC_1m","param
>> |_slope5","
>> |> param_profC","param_miniC_1m","param_maxiC_1m"))
>> |>
>> |> D:/GRASSdata/Sedgwick2/PERMANENT/.tmp/param_elev3 has GDAL driver
>> |> GTiff
>> |>
>> |> and has 6224 rows and 6242 columns
>> |>
>> |>
>> |>
>> |> Error in deleteDataset(DS) :
>> |>
>> |> ? ? ? ? ? ? ? ?GDAL Error 1: Deleting
>> |> D:/GRASSdata/Sedgwick2/PERMANENT/.tmp/param_elev3 failed:
>> |>
>> |> Permission denied
>> |>
>> |>
>> |>
>> |> On the surface this looked like an issue with user privileges, since I
>> |> do not have admin-level user privileges on this machine. However, this
>> |> has been corrected - I now have permissions on the .tmp directory
>> |> listed in the error, and I can create, append, and delete any file in
>> |> that location, but the error is still occurring.
>> |>
>> |>
>> |>
>> |> Thoughts?
>> |>
>> |>
>> |>
>> |> Thanks,
>> |>
>> |> Sam
>> |>
>> |>
>> |> ? ? ? ?[[alternative HTML version deleted]]
>> |>
>> |> _______________________________________________
>> |> R-sig-Geo mailing list
>> |> R-sig-Geo at r-project.org
>> |> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> |>
>> |
>> |
>> |
>> |--
>> |Scientist
>> |Landcare Research, New Zealand
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From werner at wirtschaft.uni-kassel.de  Tue May 17 09:45:13 2011
From: werner at wirtschaft.uni-kassel.de (Alexander Werner)
Date: Tue, 17 May 2011 09:45:13 +0200
Subject: [R-sig-Geo] edit.nb problem with an island
In-Reply-To: <BANLkTinr9Z6cKecdDgaPP0MPzw5U2F9asA@mail.gmail.com>
References: <BANLkTinr9Z6cKecdDgaPP0MPzw5U2F9asA@mail.gmail.com>
Message-ID: <4DD22789.9020108@wirtschaft.uni-kassel.de>

Dear Marc,

facing a similar problem I choose to correct the NB object manually:

NBDKR439[[350]]= as.integer(sort(c(NBDKR439[[350]],362)))
NBDKR439[[362]]= as.integer(350)

Hope this helps,
Alexander



Am 16.05.2011 19:01, schrieb Marc Mar? Dell'Olmo:
> Dear all,
>
> I have a cartography with an island, i.e. a polygon that doesn't share
> border with other polygons (CODIGO=3120104012). I would like to
> manually assign two areas (CODIGO=3120103024 and CODIGO=3120103014) as
> a neighborhood areas of this island with the edit.nb function, and
> after that to obtain the neighborhood matrix. I have followed this
> syntax and I don't understand why the summary(x.nb2) still shows one
> region with no link...
>
> If it helps, you can download the map at:
> http://dl.dropbox.com/u/14934021/map.zip
>
>
> Thank you very much,
>
> Marc
>
> map<-readShapePoly("F:/map/map.shp")
> map<-map[order(map$CODIGO),]
>
>
> x.nb<-poly2nb(map)
> summary(x.nb)
>
> #Neighbour list object:
> #Number of regions: 122
> #Number of nonzero links: 724
> #Percentage nonzero weights: 4.864284
> #Average number of links: 5.934426
> #1 region with no links:
> #66
> #Link number distribution:
>
>   #0  2  3  4  5  6  7  8  9 10 11 12 14
>   #1  1  7 19 22 31 21 12  2  2  2  1  1
> #1 least connected region:
> #101 with 2 links
> #1 most connected region:
> #29 with 14 links
>
> nb<- x.nb
> which(card(nb) == 0)
> attr(nb, "region.id")[which(card(nb) == 0)]
>
>
> x.nb2<- edit.nb(x.nb,polys=map)
>
> #>  x.nb2<- edit.nb(x.nb,polys=map)
> #Identifying contiguity for deletion ...
> #No contiguity between chosen points
> #Add contiguity? (y/n) y
> #added contiguity between point 53 and 67
> #Options: quit[q] refresh[r] continue[c] c
> #Identifying contiguity for deletion ...
> #No contiguity between chosen points
> #Add contiguity? (y/n) y
> #added contiguity between point 43 and 67
> #Options: quit[q] refresh[r] continue[c] q
>
>
> summary(x.nb2)
>
> #Neighbour list object:
> #Number of regions: 122
> #Number of nonzero links: 726
> #Percentage nonzero weights: 4.877721
> #Average number of links: 5.95082
> #1 region with no links:
> #66
> #Non-symmetric neighbours list
> #Link number distribution:
>
>   #0  2  3  4  5  6  7  8  9 10 11 12 14
>   #1  1  7 18 22 32 21 12  2  2  2  1  1
> #1 least connected region:
> #101 with 2 links
> #1 most connected region:
> #29 with 14 links
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Dipl.-?k. Alexander Werner
_______________________________________________
Universit?t Kassel
Fachbereich Wirtschaftswissenschaften
Fachgebiet Empirische Wirtschaftsforschung
Nora-Platiel-Str. 4
34109 Kassel

Tel.: 0561 / 804 - 3044
werner at wirtschaft.uni-kassel.de
http://cms.uni-kassel.de/unicms/index.php?id=31247


From marceivissa at gmail.com  Tue May 17 10:02:13 2011
From: marceivissa at gmail.com (=?ISO-8859-1?Q?Marc_Mar=ED_Dell=27Olmo?=)
Date: Tue, 17 May 2011 10:02:13 +0200
Subject: [R-sig-Geo] edit.nb problem with an island
In-Reply-To: <4DD22789.9020108@wirtschaft.uni-kassel.de>
References: <BANLkTinr9Z6cKecdDgaPP0MPzw5U2F9asA@mail.gmail.com>
	<4DD22789.9020108@wirtschaft.uni-kassel.de>
Message-ID: <BANLkTim+L5gc1W9pZVi_sUfvXcptfDkQfA@mail.gmail.com>

Dear Alexander,

Following your suggestion I have used this syntax and works perfectly:

x.nb[[67]] = as.integer(sort(c(43,53)))
x.nb[[43]] = as.integer(sort(c(x.nb[[43]],67)))
x.nb[[53]] = as.integer(sort(c(x.nb[[53]],67)))

Thank you very much for your help!

Marc

2011/5/17 Alexander Werner <werner at wirtschaft.uni-kassel.de>:
> Dear Marc,
>
> facing a similar problem I choose to correct the NB object manually:
>
> NBDKR439[[350]]= as.integer(sort(c(NBDKR439[[350]],362)))
> NBDKR439[[362]]= as.integer(350)
>
> Hope this helps,
> Alexander
>
>
>
> Am 16.05.2011 19:01, schrieb Marc Mar? Dell'Olmo:
>>
>> Dear all,
>>
>> I have a cartography with an island, i.e. a polygon that doesn't share
>> border with other polygons (CODIGO=3120104012). I would like to
>> manually assign two areas (CODIGO=3120103024 and CODIGO=3120103014) as
>> a neighborhood areas of this island with the edit.nb function, and
>> after that to obtain the neighborhood matrix. I have followed this
>> syntax and I don't understand why the summary(x.nb2) still shows one
>> region with no link...
>>
>> If it helps, you can download the map at:
>> http://dl.dropbox.com/u/14934021/map.zip
>>
>>
>> Thank you very much,
>>
>> Marc
>>
>> map<-readShapePoly("F:/map/map.shp")
>> map<-map[order(map$CODIGO),]
>>
>>
>> x.nb<-poly2nb(map)
>> summary(x.nb)
>>
>> #Neighbour list object:
>> #Number of regions: 122
>> #Number of nonzero links: 724
>> #Percentage nonzero weights: 4.864284
>> #Average number of links: 5.934426
>> #1 region with no links:
>> #66
>> #Link number distribution:
>>
>> ?#0 ?2 ?3 ?4 ?5 ?6 ?7 ?8 ?9 10 11 12 14
>> ?#1 ?1 ?7 19 22 31 21 12 ?2 ?2 ?2 ?1 ?1
>> #1 least connected region:
>> #101 with 2 links
>> #1 most connected region:
>> #29 with 14 links
>>
>> nb<- x.nb
>> which(card(nb) == 0)
>> attr(nb, "region.id")[which(card(nb) == 0)]
>>
>>
>> x.nb2<- edit.nb(x.nb,polys=map)
>>
>> #> ?x.nb2<- edit.nb(x.nb,polys=map)
>> #Identifying contiguity for deletion ...
>> #No contiguity between chosen points
>> #Add contiguity? (y/n) y
>> #added contiguity between point 53 and 67
>> #Options: quit[q] refresh[r] continue[c] c
>> #Identifying contiguity for deletion ...
>> #No contiguity between chosen points
>> #Add contiguity? (y/n) y
>> #added contiguity between point 43 and 67
>> #Options: quit[q] refresh[r] continue[c] q
>>
>>
>> summary(x.nb2)
>>
>> #Neighbour list object:
>> #Number of regions: 122
>> #Number of nonzero links: 726
>> #Percentage nonzero weights: 4.877721
>> #Average number of links: 5.95082
>> #1 region with no links:
>> #66
>> #Non-symmetric neighbours list
>> #Link number distribution:
>>
>> ?#0 ?2 ?3 ?4 ?5 ?6 ?7 ?8 ?9 10 11 12 14
>> ?#1 ?1 ?7 18 22 32 21 12 ?2 ?2 ?2 ?1 ?1
>> #1 least connected region:
>> #101 with 2 links
>> #1 most connected region:
>> #29 with 14 links
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> --
> Dipl.-?k. Alexander Werner
> _______________________________________________
> Universit?t Kassel
> Fachbereich Wirtschaftswissenschaften
> Fachgebiet Empirische Wirtschaftsforschung
> Nora-Platiel-Str. 4
> 34109 Kassel
>
> Tel.: 0561 / 804 - 3044
> werner at wirtschaft.uni-kassel.de
> http://cms.uni-kassel.de/unicms/index.php?id=31247
> _______________________________________________
>
>


From marcelino.delacruz at upm.es  Tue May 17 11:31:01 2011
From: marcelino.delacruz at upm.es (Marcelino de la Cruz)
Date: Tue, 17 May 2011 11:31:01 +0200
Subject: [R-sig-Geo] density /diversity of points
In-Reply-To: <AD5CA6183570B54F92AA45CE2619F9B9012089B2@gi-zrmk.si>
References: <AD5CA6183570B54F92AA45CE2619F9B90120892B@gi-zrmk.si>
	<zolGN6Pn.1305532742.5958350.marcelino.delacruz@upm.es>
	<AD5CA6183570B54F92AA45CE2619F9B9012089B2@gi-zrmk.si>
Message-ID: <4DD24055.9060706@upm.es>

On 16/05/2011 10:27, Matev? Pavli? wrote:
> Hi all,
>
> I read (just now) about the Simpson idex. This would probably be a good thing to try in my case. Do you have any ideas of how to create a diversity map using Simpson index?
>    
library(vegan)
simpson <- diversity(lansing.tab, "simpson")
lansing.simpson <-  setmarks(lansing,simpson)
lansing.simpson.s <-smooth.ppp(lansing.simpson)
plot(lansing.simpson.s)

> . I have just a few more questions about the code :
>
> The line below as I understand sets a table for each point with the type of points that are in the near in the radius R=350 units?
> mol.tab<- marktable(mol.ppp,R=350)
>    

Yes.
To resolve questions like this about the arguments of the functions, 
please read the help pages, e.g.
help(marktable)

> And this line creates a surface(map) of diversity ?
> lansing.div.s<-smooth.ppp(lansing.div)
Yes again.
help(smooth.ppp); help(density.ppp)
>
>
> I think this map that is created with smooth.ppp is to rough giving to little detail on the diversity. Would it be possible to use kriging to create diversity map?
>    
It depends on what do you think is "too rough". You may control 
the"roughnes" of the map changing the "dimyx" argument (that controls 
the final grid of the smoothed surface). You may be also interested in 
setting the argument "sigma" (that controls the bandwith of the 
smoothing kernel).
Although it is possible to krige the results, I think that in this case 
is preferable to trust the smoothed surface.

Cheers,
Marcelino



> Thanks for the help,
>
> m
>
> -----Original Message-----
> From: marcelino.delacruz at upm.es [mailto:marcelino.delacruz at upm.es]
> Sent: Monday, May 16, 2011 9:59 AM
> To: Matev? Pavli?
> Cc: r-sig-geo at r-project.org
> Subject: RE: [R-sig-Geo] density /diversity of points
>
> Con fecha 15/5/2011, "Matev? Pavli&#269;"<matevz.pavlic at gi-zrmk.si>
> escribi?:
>
>    
>> Hi Marcelino,
>>
>> Was out of the office for a while...
>> Thanks for the help. I think this could work...but can you tell me what this line does?
>>
>> diversity<- apply(mol.tab,1,function(x) sum(x>0))
>>      
>
> mol.tab is a table with the number of occurrences of each type (columns)
> in the neighborhood of each point (rows). This line computes for each
> row (i.e. for each point) the number of types whose value is ">0"
> (i.e. types that are present in the neighborhood). This is a very simple
> definition of diversity (i.e. "richness"). From that table you could
> also compute Shannon or Simpson diversity indices, if you would prefer
> that.
>
>
> Marcelino
>
>    
>> i cant figure out how diversity is calculated here?
>>
>> Thanks again for the help,
>>
>> matevz
>>
>> -----Original Message-----
>> From: Marcelino de la Cruz [mailto:marcelino.delacruz at upm.es]
>> Sent: Thursday, May 12, 2011 2:03 PM
>> To: Matev?? Pavli??
>> Cc: r-sig-geo at r-project.org
>> Subject: Re: [R-sig-Geo] density /diversity of points
>>
>> On 12/05/2011 13:12, Matev?? Pavli?? wrote:
>>      
>>> Hi all,
>>>
>>>
>>>
>>> I have a point data set (SHP) with coordinates and a attribute (i.e. type of point).
>>>
>>> These points are scattered around a fairly big area. What i would like to do is to find a sub-area where density of points sombined with the diversity of type is the biggest.
>>>
>>> Does anyone have any idea iff this is somehowe possible to do in R?
>>> Any idea would be greatly aprpeciated,
>>>
>>>
>>>        
>> To your first question:
>>
>> library(fortunes)
>> fortune("Yoda")
>>
>> ;-)
>>
>> More seriously, you could  transform your shp data in a ppp object with spatstat. See the vignette in spatstat. Then you can use some functions there, for example (with the data set lansing):
>>
>> library(spatstat)
>> data(lansing)
>> plot(lansing)
>> # get an estimate of point density
>> lansing.den<- density.ppp(lansing)
>> plot(lansing.den)
>>
>> # get an estimate of point diversity (here, for the shake of brevity, at the points themselves)
>> lansing.tab<- marktable(lansing,R=0.05)
>> diversity<- apply(lansing.tab,1,function(x) sum(x>0)) lansing.div<- setmarks(lansing,diversity) lansing.div.s<-smooth.ppp(lansing.div)
>>
>> plot(lansing.div.s)
>>
>> # select areas with arbitrary high values of  density and diversity plot(eval.im(lansing.div.s>4.5&  (lansing.den/max(lansing.den))>0.9))
>>
>>
>> HTH. Cheers,
>>
>> Marcelino
>>
>>
>>
>> --
>> _________________________________
>>
>> Marcelino de la Cruz Rot
>> Departamento de Biologia Vegetal
>> E.U.T.I. Agricola
>> Universidad Politecnica de Madrid
>>   28040 Madrid
>>   Tel: 34913365654
>>   _________________________________
>>
>>      


-- 
_________________________________ Marcelino de la Cruz Rot Departamento 
de Biologia Vegetal E.U.T.I. Agricola Universidad Politecnica de Madrid 
28040 Madrid Tel: 34913365654 _________________________________


From mathieu.rajerison at gmail.com  Tue May 17 14:00:56 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Tue, 17 May 2011 14:00:56 +0200
Subject: [R-sig-Geo] density /diversity of points
In-Reply-To: <4DD24055.9060706@upm.es>
References: <AD5CA6183570B54F92AA45CE2619F9B90120892B@gi-zrmk.si>
	<zolGN6Pn.1305532742.5958350.marcelino.delacruz@upm.es>
	<AD5CA6183570B54F92AA45CE2619F9B9012089B2@gi-zrmk.si>
	<4DD24055.9060706@upm.es>
Message-ID: <BANLkTimaGdRop2NV-YzqBu0iKdV8d2awVw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110517/7aaa2de8/attachment.pl>

From marcelino.delacruz at upm.es  Tue May 17 14:27:44 2011
From: marcelino.delacruz at upm.es (Marcelino de la Cruz)
Date: Tue, 17 May 2011 14:27:44 +0200
Subject: [R-sig-Geo] density /diversity of points
In-Reply-To: <BANLkTimaGdRop2NV-YzqBu0iKdV8d2awVw@mail.gmail.com>
References: <AD5CA6183570B54F92AA45CE2619F9B90120892B@gi-zrmk.si>	<zolGN6Pn.1305532742.5958350.marcelino.delacruz@upm.es>	<AD5CA6183570B54F92AA45CE2619F9B9012089B2@gi-zrmk.si>	<4DD24055.9060706@upm.es>
	<BANLkTimaGdRop2NV-YzqBu0iKdV8d2awVw@mail.gmail.com>
Message-ID: <4DD269C0.1000704@upm.es>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110517/a4172c7a/attachment.pl>

From thi_veloso at yahoo.com.br  Tue May 17 14:39:18 2011
From: thi_veloso at yahoo.com.br (Thiago Veloso)
Date: Tue, 17 May 2011 05:39:18 -0700
Subject: [R-sig-Geo] How to overlay two rasters limiting the spatial domain
Message-ID: <428668.89389.qm@web161401.mail.bf1.yahoo.com>

  Dear R colleagues,

  Currently, I am working with the vegetation map published by SAGE (http://www.sage.wisc.edu/download/potveg/global_potveg.html). This map is published in netcdf and I can easily load it into R using the package "raster".

  But I have found another vegetation map (also netcdf, same resolution) which is more realistic to my work region. Thus, what I need to do is overlay the two maps, but using a clip feature (i.e. a shapefile of South America) as a delimiter to this operation, in order to capture the information of the newest map.

  I am trying to use the "overlay" function of raster package, but apparently it isn't possible (or I am missing something) to use a clip feature to restrain the spatial domain of the operation.

  Any tips on how to do this? Below is the code I am using.

  Best wishes,

  Thiago Veloso.

#Loading required packages
library(raster)
library(maptools)

#Loading SAGE vegetation map
vegmap<-raster("C:/temp/vegmap_ibis/data/vegtype.nc")

#Loading new vegetation map
new_vegmap<-raster("C:/temp/vegmap_ibis/data/new_vegtype.nc")

#Loading SA shapefile
south_america<-readShapePoly("C:/temp/vegmap_ibis/shapes/southamerica.shp")

#Replacing the original map with the modified one
result<-overlay(vegmap,new_vegmap,fun=function(x){x}) #this is where I stop - I don't know how to use the shapefile as a clip feature in this function...



From matevz.pavlic at gi-zrmk.si  Tue May 17 16:47:05 2011
From: matevz.pavlic at gi-zrmk.si (=?UTF-8?B?TWF0ZXbFviBQYXZsacSN?=)
Date: Tue, 17 May 2011 16:47:05 +0200
Subject: [R-sig-Geo] density /diversity of points
In-Reply-To: <4DD269C0.1000704@upm.es>
References: <AD5CA6183570B54F92AA45CE2619F9B90120892B@gi-zrmk.si>	<zolGN6Pn.1305532742.5958350.marcelino.delacruz@upm.es>	<AD5CA6183570B54F92AA45CE2619F9B9012089B2@gi-zrmk.si>	<4DD24055.9060706@upm.es><BANLkTimaGdRop2NV-YzqBu0iKdV8d2awVw@mail.gmail.com>
	<4DD269C0.1000704@upm.es>
Message-ID: <AD5CA6183570B54F92AA45CE2619F9B90123F75C@gi-zrmk.si>

Thanks for the help marcelino!


-----Original Message-----
From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Marcelino de la Cruz
Sent: Tuesday, May 17, 2011 2:28 PM
To: Mathieu Rajerison
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] density /diversity of points

On 17/05/2011 14:00, Mathieu Rajerison wrote:
> Many thanks for the code!
>
> What are the units of R in marktable? I didn't find the information in 
> the documentation.
>    
The same units of x and y coordinates in your ppp object.

Cheers,

Marcelino

> 2011/5/17 Marcelino de la Cruz<marcelino.delacruz at upm.es>
>
>    
>> On 16/05/2011 10:27, Matev?? Pavli?? wrote:
>>
>>      
>>> Hi all,
>>>
>>> I read (just now) about the Simpson idex. This would probably be a 
>>> good thing to try in my case. Do you have any ideas of how to create 
>>> a diversity map using Simpson index?
>>>
>>>
>>>        
>> library(vegan)
>> simpson<- diversity(lansing.tab, "simpson")
>> lansing.simpson<-  setmarks(lansing,simpson)
>> lansing.simpson.s<-smooth.ppp(lansing.simpson)
>> plot(lansing.simpson.s)
>>
>>
>>   . I have just a few more questions about the code :
>>      
>>> The line below as I understand sets a table for each point with the 
>>> type of points that are in the near in the radius R=350 units?
>>> mol.tab<- marktable(mol.ppp,R=350)
>>>
>>>
>>>        
>> Yes.
>> To resolve questions like this about the arguments of the functions, 
>> please read the help pages, e.g.
>> help(marktable)
>>
>>
>>   And this line creates a surface(map) of diversity ?
>>      
>>> lansing.div.s<-smooth.ppp(lansing.div)
>>>
>>>        
>> Yes again.
>> help(smooth.ppp); help(density.ppp)
>>
>>
>>      
>>> I think this map that is created with smooth.ppp is to rough giving 
>>> to little detail on the diversity. Would it be possible to use 
>>> kriging to create diversity map?
>>>
>>>
>>>        
>> It depends on what do you think is "too rough". You may control 
>> the"roughnes" of the map changing the "dimyx" argument (that controls 
>> the final grid of the smoothed surface). You may be also interested 
>> in setting the argument "sigma" (that controls the bandwith of the smoothing kernel).
>> Although it is possible to krige the results, I think that in this 
>> case is preferable to trust the smoothed surface.
>>
>> Cheers,
>> Marcelino
>>
>>
>>
>>
>>   Thanks for the help,
>>      
>>> m
>>>
>>> -----Original Message-----
>>> From: marcelino.delacruz at upm.es [mailto:marcelino.delacruz at upm.es]
>>> Sent: Monday, May 16, 2011 9:59 AM
>>> To: Matev?? Pavli??
>>> Cc: r-sig-geo at r-project.org
>>> Subject: RE: [R-sig-Geo] density /diversity of points
>>>
>>> Con fecha 15/5/2011, "Matev?? Pavli&#269;"<matevz.pavlic at gi-zrmk.si>
>>> escribi??:
>>>
>>>
>>>
>>>        
>>>> Hi Marcelino,
>>>>
>>>> Was out of the office for a while...
>>>> Thanks for the help. I think this could work...but can you tell me 
>>>> what this line does?
>>>>
>>>> diversity<- apply(mol.tab,1,function(x) sum(x>0))
>>>>
>>>>
>>>>          
>>> mol.tab is a table with the number of occurrences of each type 
>>> (columns) in the neighborhood of each point (rows). This line 
>>> computes for each row (i.e. for each point) the number of types whose value is ">0"
>>> (i.e. types that are present in the neighborhood). This is a very 
>>> simple definition of diversity (i.e. "richness"). From that table 
>>> you could also compute Shannon or Simpson diversity indices, if you 
>>> would prefer that.
>>>
>>>
>>> Marcelino
>>>
>>>
>>>
>>>        
>>>> i cant figure out how diversity is calculated here?
>>>>
>>>> Thanks again for the help,
>>>>
>>>> matevz
>>>>
>>>> -----Original Message-----
>>>> From: Marcelino de la Cruz [mailto:marcelino.delacruz at upm.es]
>>>> Sent: Thursday, May 12, 2011 2:03 PM
>>>> To: Matev?...?? Pavli?" Cc: r-sig-geo at r-project.org
>>>> Subject: Re: [R-sig-Geo] density /diversity of points
>>>>
>>>> On 12/05/2011 13:12, Matev?...?? Pavli?"  wrote:
>>>>
>>>>
>>>>          
>>>>> Hi all,
>>>>>
>>>>>
>>>>>
>>>>> I have a point data set (SHP) with coordinates and a attribute (i.e.
>>>>> type of point).
>>>>>
>>>>> These points are scattered around a fairly big area. What i would 
>>>>> like to do is to find a sub-area where density of points sombined 
>>>>> with the diversity of type is the biggest.
>>>>>
>>>>> Does anyone have any idea iff this is somehowe possible to do in R?
>>>>> Any idea would be greatly aprpeciated,
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>            
>>>> To your first question:
>>>>
>>>> library(fortunes)
>>>> fortune("Yoda")
>>>>
>>>> ;-)
>>>>
>>>> More seriously, you could  transform your shp data in a ppp object 
>>>> with spatstat. See the vignette in spatstat. Then you can use some 
>>>> functions there, for example (with the data set lansing):
>>>>
>>>> library(spatstat)
>>>> data(lansing)
>>>> plot(lansing)
>>>> # get an estimate of point density
>>>> lansing.den<- density.ppp(lansing)
>>>> plot(lansing.den)
>>>>
>>>> # get an estimate of point diversity (here, for the shake of 
>>>> brevity, at the points themselves)
>>>> lansing.tab<- marktable(lansing,R=0.05)
>>>> diversity<- apply(lansing.tab,1,function(x) sum(x>0)) lansing.div<-
>>>> setmarks(lansing,diversity) lansing.div.s<-smooth.ppp(lansing.div)
>>>>
>>>> plot(lansing.div.s)
>>>>
>>>> # select areas with arbitrary high values of  density and diversity plot(
>>>> eval.im(lansing.div.s>4.5&   (lansing.den/max(lansing.den))>0.9))
>>>>
>>>>
>>>> HTH. Cheers,
>>>>
>>>> Marcelino
>>>>
>>>>
>>>>
>>>> --
>>>> _________________________________
>>>>
>>>> Marcelino de la Cruz Rot
>>>> Departamento de Biologia Vegetal
>>>> E.U.T.I. Agricola
>>>> Universidad Politecnica de Madrid
>>>>   28040 Madrid
>>>>   Tel: 34913365654
>>>>   _________________________________
>>>>
>>>>
>>>>
>>>>          
>>>        
>> --
>> _________________________________ Marcelino de la Cruz Rot 
>> Departamento de Biologia Vegetal E.U.T.I. Agricola Universidad 
>> Politecnica de Madrid 28040 Madrid Tel: 34913365654 
>> _________________________________
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>      
> 	[[alternative HTML version deleted]]
>
>    
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>    


--
_________________________________ Marcelino de la Cruz Rot Departamento de Biologia Vegetal E.U.T.I. Agricola Universidad Politecnica de Madrid
28040 Madrid Tel: 34913365654 _________________________________

	[[alternative HTML version deleted]]


From matevz.pavlic at gi-zrmk.si  Tue May 17 18:39:48 2011
From: matevz.pavlic at gi-zrmk.si (=?UTF-8?B?TWF0ZXbFviBQYXZsacSN?=)
Date: Tue, 17 May 2011 18:39:48 +0200
Subject: [R-sig-Geo] density /diversity of points
In-Reply-To: <AD5CA6183570B54F92AA45CE2619F9B90123F75C@gi-zrmk.si>
References: <AD5CA6183570B54F92AA45CE2619F9B90120892B@gi-zrmk.si>	<zolGN6Pn.1305532742.5958350.marcelino.delacruz@upm.es>	<AD5CA6183570B54F92AA45CE2619F9B9012089B2@gi-zrmk.si>	<4DD24055.9060706@upm.es><BANLkTimaGdRop2NV-YzqBu0iKdV8d2awVw@mail.gmail.com><4DD269C0.1000704@upm.es>
	<AD5CA6183570B54F92AA45CE2619F9B90123F75C@gi-zrmk.si>
Message-ID: <AD5CA6183570B54F92AA45CE2619F9B90123F762@gi-zrmk.si>

Hi again, 

I managed (with your help) to find the areas of my interest. But now i would like to export thist plot (of arbitrary hig values of diversity and density) to a tiff (with projection). 

I used to do that with rgdal library (writeGDAL) but here it is not possible since this the object needs to be SpatialPointsGrid. Is it possible to create Tiff from, ppp object?

Thanks for the help, 

m

-----Original Message-----
From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Matev? Pavli?
Sent: Tuesday, May 17, 2011 4:47 PM
To: marcelino.delacruz at upm.es; Mathieu Rajerison
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] density /diversity of points

Thanks for the help marcelino!


-----Original Message-----
From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Marcelino de la Cruz
Sent: Tuesday, May 17, 2011 2:28 PM
To: Mathieu Rajerison
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] density /diversity of points

On 17/05/2011 14:00, Mathieu Rajerison wrote:
> Many thanks for the code!
>
> What are the units of R in marktable? I didn't find the information in 
> the documentation.
>    
The same units of x and y coordinates in your ppp object.

Cheers,

Marcelino

> 2011/5/17 Marcelino de la Cruz<marcelino.delacruz at upm.es>
>
>    
>> On 16/05/2011 10:27, Matev?? Pavli?? wrote:
>>
>>      
>>> Hi all,
>>>
>>> I read (just now) about the Simpson idex. This would probably be a 
>>> good thing to try in my case. Do you have any ideas of how to create 
>>> a diversity map using Simpson index?
>>>
>>>
>>>        
>> library(vegan)
>> simpson<- diversity(lansing.tab, "simpson")
>> lansing.simpson<-  setmarks(lansing,simpson)
>> lansing.simpson.s<-smooth.ppp(lansing.simpson)
>> plot(lansing.simpson.s)
>>
>>
>>   . I have just a few more questions about the code :
>>      
>>> The line below as I understand sets a table for each point with the 
>>> type of points that are in the near in the radius R=350 units?
>>> mol.tab<- marktable(mol.ppp,R=350)
>>>
>>>
>>>        
>> Yes.
>> To resolve questions like this about the arguments of the functions, 
>> please read the help pages, e.g.
>> help(marktable)
>>
>>
>>   And this line creates a surface(map) of diversity ?
>>      
>>> lansing.div.s<-smooth.ppp(lansing.div)
>>>
>>>        
>> Yes again.
>> help(smooth.ppp); help(density.ppp)
>>
>>
>>      
>>> I think this map that is created with smooth.ppp is to rough giving 
>>> to little detail on the diversity. Would it be possible to use 
>>> kriging to create diversity map?
>>>
>>>
>>>        
>> It depends on what do you think is "too rough". You may control 
>> the"roughnes" of the map changing the "dimyx" argument (that controls 
>> the final grid of the smoothed surface). You may be also interested 
>> in setting the argument "sigma" (that controls the bandwith of the smoothing kernel).
>> Although it is possible to krige the results, I think that in this 
>> case is preferable to trust the smoothed surface.
>>
>> Cheers,
>> Marcelino
>>
>>
>>
>>
>>   Thanks for the help,
>>      
>>> m
>>>
>>> -----Original Message-----
>>> From: marcelino.delacruz at upm.es [mailto:marcelino.delacruz at upm.es]
>>> Sent: Monday, May 16, 2011 9:59 AM
>>> To: Matev?? Pavli??
>>> Cc: r-sig-geo at r-project.org
>>> Subject: RE: [R-sig-Geo] density /diversity of points
>>>
>>> Con fecha 15/5/2011, "Matev?? Pavli&#269;"<matevz.pavlic at gi-zrmk.si>
>>> escribi??:
>>>
>>>
>>>
>>>        
>>>> Hi Marcelino,
>>>>
>>>> Was out of the office for a while...
>>>> Thanks for the help. I think this could work...but can you tell me 
>>>> what this line does?
>>>>
>>>> diversity<- apply(mol.tab,1,function(x) sum(x>0))
>>>>
>>>>
>>>>          
>>> mol.tab is a table with the number of occurrences of each type
>>> (columns) in the neighborhood of each point (rows). This line 
>>> computes for each row (i.e. for each point) the number of types whose value is ">0"
>>> (i.e. types that are present in the neighborhood). This is a very 
>>> simple definition of diversity (i.e. "richness"). From that table 
>>> you could also compute Shannon or Simpson diversity indices, if you 
>>> would prefer that.
>>>
>>>
>>> Marcelino
>>>
>>>
>>>
>>>        
>>>> i cant figure out how diversity is calculated here?
>>>>
>>>> Thanks again for the help,
>>>>
>>>> matevz
>>>>
>>>> -----Original Message-----
>>>> From: Marcelino de la Cruz [mailto:marcelino.delacruz at upm.es]
>>>> Sent: Thursday, May 12, 2011 2:03 PM
>>>> To: Matev?...?? Pavli?" Cc: r-sig-geo at r-project.org
>>>> Subject: Re: [R-sig-Geo] density /diversity of points
>>>>
>>>> On 12/05/2011 13:12, Matev?...?? Pavli?"  wrote:
>>>>
>>>>
>>>>          
>>>>> Hi all,
>>>>>
>>>>>
>>>>>
>>>>> I have a point data set (SHP) with coordinates and a attribute (i.e.
>>>>> type of point).
>>>>>
>>>>> These points are scattered around a fairly big area. What i would 
>>>>> like to do is to find a sub-area where density of points sombined 
>>>>> with the diversity of type is the biggest.
>>>>>
>>>>> Does anyone have any idea iff this is somehowe possible to do in R?
>>>>> Any idea would be greatly aprpeciated,
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>            
>>>> To your first question:
>>>>
>>>> library(fortunes)
>>>> fortune("Yoda")
>>>>
>>>> ;-)
>>>>
>>>> More seriously, you could  transform your shp data in a ppp object 
>>>> with spatstat. See the vignette in spatstat. Then you can use some 
>>>> functions there, for example (with the data set lansing):
>>>>
>>>> library(spatstat)
>>>> data(lansing)
>>>> plot(lansing)
>>>> # get an estimate of point density
>>>> lansing.den<- density.ppp(lansing)
>>>> plot(lansing.den)
>>>>
>>>> # get an estimate of point diversity (here, for the shake of 
>>>> brevity, at the points themselves)
>>>> lansing.tab<- marktable(lansing,R=0.05)
>>>> diversity<- apply(lansing.tab,1,function(x) sum(x>0)) lansing.div<-
>>>> setmarks(lansing,diversity) lansing.div.s<-smooth.ppp(lansing.div)
>>>>
>>>> plot(lansing.div.s)
>>>>
>>>> # select areas with arbitrary high values of  density and diversity plot(
>>>> eval.im(lansing.div.s>4.5&   (lansing.den/max(lansing.den))>0.9))
>>>>
>>>>
>>>> HTH. Cheers,
>>>>
>>>> Marcelino
>>>>
>>>>
>>>>
>>>> --
>>>> _________________________________
>>>>
>>>> Marcelino de la Cruz Rot
>>>> Departamento de Biologia Vegetal
>>>> E.U.T.I. Agricola
>>>> Universidad Politecnica de Madrid
>>>>   28040 Madrid
>>>>   Tel: 34913365654
>>>>   _________________________________
>>>>
>>>>
>>>>
>>>>          
>>>        
>> --
>> _________________________________ Marcelino de la Cruz Rot 
>> Departamento de Biologia Vegetal E.U.T.I. Agricola Universidad 
>> Politecnica de Madrid 28040 Madrid Tel: 34913365654 
>> _________________________________
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>      
> 	[[alternative HTML version deleted]]
>
>    
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>    


--
_________________________________ Marcelino de la Cruz Rot Departamento de Biologia Vegetal E.U.T.I. Agricola Universidad Politecnica de Madrid
28040 Madrid Tel: 34913365654 _________________________________

	[[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

From mathieu.rajerison at gmail.com  Tue May 17 19:05:27 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Tue, 17 May 2011 19:05:27 +0200
Subject: [R-sig-Geo] density /diversity of points
In-Reply-To: <4DD24055.9060706@upm.es>
References: <AD5CA6183570B54F92AA45CE2619F9B90120892B@gi-zrmk.si>
	<zolGN6Pn.1305532742.5958350.marcelino.delacruz@upm.es>
	<AD5CA6183570B54F92AA45CE2619F9B9012089B2@gi-zrmk.si>
	<4DD24055.9060706@upm.es>
Message-ID: <BANLkTinOR1Zb35mmA-xWHakZYP+Wu8HBAw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110517/c84a753d/attachment.pl>

From rhunne at mac.com  Tue May 17 19:21:14 2011
From: rhunne at mac.com (Robin W Hunnewell)
Date: Tue, 17 May 2011 17:21:14 +0000 (GMT)
Subject: [R-sig-Geo] Help w/ transposed matrix indices for "owin" object
	with quadrat.test
Message-ID: <e9f13bf3-dfa9-c8c4-bc5f-b9ac157f84a8@me.com>

Dear R-sig Geo people,
I've run a quadrat.test on a "ppp" object, for which the obs. window "owin" is a convex polygon:

> summary(my.ppp)
Planar point pattern: 660 points
Average intensity 0.461 points per square kilometer ?

Window: polygonal boundary
single connected closed polygon with 41 vertices
enclosing rectangle: [-7420.406, -7373.856]x[5451.656, 5506.241]kilometer
Window area = ?1432.66 square kilometer?
Unit of length: 1 kilometer?


After running the test,
> M <- quadrat.test(my.ppp, nx= 2, ny= 2)?

and then?printing /?plotting M, an object of class "quadrattest" "htest", the returned value is plotted as levels (colored tiles) of a pixel image:

> M?
Chi-squared test of CSR using quadrat counts?
data: my.ppp?
X-squared = 89.6415, df = 3, p-value < 2.2e-16?
Quadrats: 4 tiles (levels of a pixel image)


why the pixellation? ?From what I can gather, it has to do with the row / column matrix indices of my "owin" -- when typing ?str(M), there's a warning in the digest referring to the window: "Transpose matrices to get the standard presentation in R" "Example: image(result$xcol,result$yrow,t(result$d))"?
Here is that section with the warning:

>str(M)

?.. ..$ window:List of 11
??.. .. ..$ type ? ?: chr "mask"
??.. .. ..$ xrange ?: num [1:2] -7420 -7374
??. .. ..$ yrange ?: num [1:2] 5452 5506
??.. .. ..$ dim ? ? : int [1:2] 100 100
??.. .. ..$ xstep ? : num 0.465
??.. .. ..$ ystep ? : num 0.546
??.. .. ..$ warnings: chr [1:3] "Row index corresponds to increasing y coordinate; column to increasing x" "Transpose matrices to get the standard presentation in R" "Example: image(result$xcol,result$yrow,t(result$d))"
??.. .. ..$ xcol ? ?: num [1:100] -7420 -7420 -7419 -7419 -7418 ...
??.. .. ..$ yrow ? ?: num [1:100] 5452 5452 5453 5454 5454 ...
??.. .. ..$ m ? ? ? : logi [1:100, 1:100] FALSE FALSE FALSE FALSE FALSE FALSE ...
??.. .. ..$ units ? :List of 3
??.. .. .. ..$ singular ?: chr "kilometer"
??. .. .. ..$ plural ? ?: chr "kilometer"
??.. .. .. ..$ multiplier: num 1
??.. .. .. ..- attr(*, "class")= chr "units"
??.. . ..- attr(*, "class")= chr "owin"


I understand for "im" objects in {spatstat}, the correspondence between matrix indices mat[i,j] and cartesian coordinates is: rows correspond to the y coordinate, and the columns to the x coordinate.?

But guess I'm just not sure whether and if the row / column index for my "owin" object needs to be transposed, or if this is something to worry about at all.?
I'd created the "owin" by importing it from .shp file (readShapePoly) and then used ?as(W,"owin"). Is it a problem to do it that way?
?
Thanks v much for any clarification, and how to 'fix' if necessary?
Robin

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110517/d69c0b4e/attachment.html>

From sep at umail.ucsb.edu  Tue May 17 20:06:38 2011
From: sep at umail.ucsb.edu (Sam Prentice)
Date: Tue, 17 May 2011 11:06:38 -0700
Subject: [R-sig-Geo] readRAST6() in {spgrass6}
In-Reply-To: <alpine.LRH.2.00.1105170613130.20286@reclus.nhh.no>
References: <003f01cc0f48$3f7a66b0$be6f3410$@umail.ucsb.edu>
	<BANLkTi=1MTqesqeiyaoAp0kapSJc271JfA@mail.gmail.com>
	<007701cc140f$b84227b0$28c67710$@umail.ucsb.edu>
	<BANLkTi=rPeh9nrXh6ZdDbAjzHzzz=DtQgA@mail.gmail.com>
	<alpine.LRH.2.00.1105170613130.20286@reclus.nhh.no>
Message-ID: <005a01cc14bd$2b5ab0c0$82101240$@umail.ucsb.edu>

Thanks for the help. I understand there are more elegant and efficient
approaches to classification, and they are becoming more clear in time, out
of experience and necessity of my research. Such is learning. Nonetheless,
I'm also fairly confident about what I'm trying to achieve in the moment (a
classified landform element map), why (to guide representative soil sampling
of said landform elements), and what my constraints are (impending soil dry
down). I assumed incorrectly that a published approach could be emulated not
with ease, but without a several month time commitment. Please excuse my
naivet? in regards to the tools, and thanks again for your feedback.

Sam 

|-----Original Message-----
|From: Roger Bivand [mailto:Roger.Bivand at nhh.no]
|Sent: Monday, May 16, 2011 9:28 PM
|To: Sam Prentice
|Cc: Dylan Beaudette; r-sig-geo at r-project.org
|Subject: Re: [R-sig-Geo] readRAST6() in {spgrass6}
|
|On Mon, 16 May 2011, Dylan Beaudette wrote:
|
|> It is hard to know what the upper-limit is on Windows-- as the memory
|> is usually fragmented by the operating system.
|
|Correct, the upper limit on other OS is higher in practice.
|
|>
|> Since you are using GRASS, I would first try a coarsened version of
|> your terrain-shape rasters via the built-in re-sampling functionality.
|> While this is not ideal, as it is NN-based, it will give a quick way
|> to try out methods.
|>
|> After you have initialized your GRASS connection in R, execute something
|like:
|>
|> system('g.region res=10 -ap')
|>
|> This will align the region along a 10x10 map unit grid. All further
|> interaction with raster data will be automatically re-sampled to this
|> grid system.
|
|Right, for some res=, you will get a systematic sample that will let you
|decimate your data. Randomly shifting the window while resampling will help
|you see whether your classification model boundaries change.
|
|As both Dylan and I have said, there is no good reason for calibrating the
|classification model with more data than necessary, even if it were
possible.
|The only reason to use very much data would be if discrimination between
|very rare classes is your target, but even then you could stratify your
sample
|to get better representation of critical areas.
|
|You seem to be looking for classification signatures, from which you are
going
|to predict. Sampling will give you distributions of these signatures, which
could
|be used for similation by tile. If you are very concerned about the
statistical
|quality of your classification signatures, you could go fuzzy, but your
main goal
|is to get to the distributions of these signatures, IMO. Once you have
them,
|you can predict. You do not need to have GBs of dat in memory to do this
|adequately.
|
|So one could agree that software (OS, R, whatever) is your limitation, but
it is
|only a limitation if you are not able to consider more statistical
approaches to
|your apparent problem, which is finding out how to classify your input, and
|then to predict to output.
|
|Roger
|
|>
|> Dylan
|>
|> On Mon, May 16, 2011 at 2:25 PM, Sam Prentice <sep at umail.ucsb.edu>
|wrote:
|>> Thanks you for your suggestions. This error is not affected by choice
|>> of mapset, and is not limited by my hardware.
|>>
|>> Further info: I'm running 64-bit windows, 16MB memory, w/multiple cores.
|>> GRASS 6.4.1, R 2.12.2. I'm running standalone R using initGRASS() to
|>> set GRASS env parameters. The GRASS files I'm trying to read-in are
|>> DEM derivatives, each ~170MB. The intermediate .tmp file in the error
|>> message is 300MB.
|>>
|>> It's been suggested that I am "likely trying to import too much data
|>> into R". Assuming non-limiting computer power, what is the upper
|>> bound on amount of data that can be read into R from GRASS? If not a
|>> fixed amount, what are the main conditions that cause it to vary? I
|>> did not see this addressed in the {spgrass6} documentation, so I'm
|>> assuming it's a base R limitation, but maybe not? Quantifying this
|>> limitation will help determined how to move forward (e.g, resampling
|>> at smaller scale versus subsetting my DEM derivatives).
|>>
|>> Thanks,
|>> Sam
|>>
|>> |-----Original Message-----
|>> |From: Pierre Roudier [mailto:pierre.roudier at gmail.com]
|>> |Sent: Tuesday, May 10, 2011 3:40 PM
|>> |To: Sam Prentice
|>> |Cc: r-sig-geo at r-project.org
|>> |Subject: Re: [R-sig-Geo] readRAST6() in {spgrass6}
|>> |
|>> |Could that message have anything to do with the fact that this is a
|>> |layer
|>> from
|>> |the PERMANENT mapset?
|>> |
|>> |My two cents,
|>> |
|>> |Pierre
|>> |
|>> |2011/5/11 Sam Prentice <sep at umail.ucsb.edu>:
|>> |> Hi,
|>> |>
|>> |>
|>> |>
|>> |> I'm running R 2.12.2 via Tinn-R on Windows Server 2008. I'm using
|>> |> R for cluster analysis for terrain classification and I'm getting
|>> |> the following error when parsing GRASS data into R:
|>> |>
|>> |>
|>> |>
|>> |>> x =
|>> |>
|>>
||readRAST6(c("param_elev3","param_crosC_1m","param_longC_1m","para
|m
|>> |_slope5","
|>> |> param_profC","param_miniC_1m","param_maxiC_1m"))
|>> |>
|>> |> D:/GRASSdata/Sedgwick2/PERMANENT/.tmp/param_elev3 has GDAL
|driver
|>> |> GTiff
|>> |>
|>> |> and has 6224 rows and 6242 columns
|>> |>
|>> |>
|>> |>
|>> |> Error in deleteDataset(DS) :
|>> |>
|>> |> ? ? ? ? ? ? ? ?GDAL Error 1: Deleting
|>> |> D:/GRASSdata/Sedgwick2/PERMANENT/.tmp/param_elev3 failed:
|>> |>
|>> |> Permission denied
|>> |>
|>> |>
|>> |>
|>> |> On the surface this looked like an issue with user privileges,
|>> |> since I do not have admin-level user privileges on this machine.
|>> |> However, this has been corrected - I now have permissions on the
|>> |> .tmp directory listed in the error, and I can create, append, and
|>> |> delete any file in that location, but the error is still occurring.
|>> |>
|>> |>
|>> |>
|>> |> Thoughts?
|>> |>
|>> |>
|>> |>
|>> |> Thanks,
|>> |>
|>> |> Sam
|>> |>
|>> |>
|>> |> ? ? ? ?[[alternative HTML version deleted]]
|>> |>
|>> |> _______________________________________________
|>> |> R-sig-Geo mailing list
|>> |> R-sig-Geo at r-project.org
|>> |> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
|>> |>
|>> |
|>> |
|>> |
|>> |--
|>> |Scientist
|>> |Landcare Research, New Zealand
|>>
|>> _______________________________________________
|>> R-sig-Geo mailing list
|>> R-sig-Geo at r-project.org
|>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
|>>
|>
|> _______________________________________________
|> R-sig-Geo mailing list
|> R-sig-Geo at r-project.org
|> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
|>
|
|--
|Roger Bivand
|Economic Geography Section, Department of Economics, Norwegian School of
|Economics and Business Administration, Helleveien 30, N-5045 Bergen,
|Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
|e-mail: Roger.Bivand at nhh.no


From paulojus at c3sl.ufpr.br  Tue May 17 20:27:05 2011
From: paulojus at c3sl.ufpr.br (Paulo Justiniano Ribeiro Jr)
Date: Tue, 17 May 2011 15:27:05 -0300
Subject: [R-sig-Geo] problems with unconditional simulations (grf) in
 geoR 1.6.33-34 and RandomFields 2.0.4x
In-Reply-To: <BANLkTikh2_ss1WMWswSraO9E4yRqyZEHGA@mail.gmail.com>
References: <BANLkTikh2_ss1WMWswSraO9E4yRqyZEHGA@mail.gmail.com>
Message-ID: <alpine.DEB.2.00.1105171526190.5373@macalan.c3local>

Laura

args(grf)
im=grf(n=611*634,grid="reg", nx=611, ny=634, xlims=c(1, 611), ylims=c(1, 
634), nugget=nug, cov.par=c(sill,range), mean=mean)
image(im)


will work for this

PLease update both, geoR and RandomFields

I'm also preparing a fix such that your original call will work as well

best
P.J.


Paulo Justiniano Ribeiro Jr
LEG (Laboratorio de Estatistica e Geoinformacao)
Universidade Federal do Parana
Caixa Postal 19.081
CEP 81.531-990
Curitiba, PR  -  Brasil
Tel: (+55) 41 3361 3573
VOIP: (+55) (41) (3361 3600) 1053 1066
Fax: (+55) 41 3361 3141
e-mail: paulojus AT  ufpr  br
http://www.leg.ufpr.br/~paulojus

On Fri, 13 May 2011, Laura Poggio wrote:

> Dear all,
> I am trying to run gaussian unconditional simulation with spatial structure
> using the grf function of geoR, with the following code:
>
> library(geoR)
> a=c(1:611)
> b=c(1:634)
> gr=expand.grid(a,b)
> im=grf(661*634, grid=gr, nugget=nug, cov.par=c(sill,range), mean=mean)
>
> When using geoR version 1.6.32 (or older) with version 1.3.45 (or older) of
> RandomFields the results present an evident spatial structure. While using
> the same code with version 1.6.33 or 1.6.34 of GeoR and version 2.0.4x of
> RandomFields the resulting pattern is like pure random noise.
> I tried with different values for sill, range, nugget and mean, but the
> results are always without spatial structure. If needed, I can provide more
> information and figures for more visual examples.
>
> Any hints would be greatly appreciated.
>
> Thank you very much in advance
>
> Laura
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From jonathan.s.callahan at gmail.com  Tue May 17 20:48:51 2011
From: jonathan.s.callahan at gmail.com (Jonathan Callahan)
Date: Tue, 17 May 2011 11:48:51 -0700
Subject: [R-sig-Geo] Google Static Map tile as underlay
Message-ID: <BANLkTik6vDDr9fkUxwPzScK_uyxV_T+uEA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110517/c4f8cb58/attachment.pl>

From r.turner at auckland.ac.nz  Tue May 17 22:30:13 2011
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Wed, 18 May 2011 08:30:13 +1200
Subject: [R-sig-Geo] density /diversity of points
In-Reply-To: <BANLkTinOR1Zb35mmA-xWHakZYP+Wu8HBAw@mail.gmail.com>
References: <AD5CA6183570B54F92AA45CE2619F9B90120892B@gi-zrmk.si>	<zolGN6Pn.1305532742.5958350.marcelino.delacruz@upm.es>	<AD5CA6183570B54F92AA45CE2619F9B9012089B2@gi-zrmk.si>	<4DD24055.9060706@upm.es>
	<BANLkTinOR1Zb35mmA-xWHakZYP+Wu8HBAw@mail.gmail.com>
Message-ID: <4DD2DAD5.8080104@auckland.ac.nz>

On 18/05/11 05:05, Mathieu Rajerison wrote:
> I've tried your method to determine the richness of landscapes on my area of
> interest using european corine land cover.
>
> I converted my polygon layer into a SpatialGridDataFrame then into a
> SpatialPointsDataFrame, and finally into a ppp object using one column: the
> type of soil occupation (CLC3_LIB).
>
> But my problem is that marktable gives me zero values, although I should get
> at least a "1" value for one of my columns...
>
> Here is a sample code:
>> ppp[1:5]$marks
> [1] Mer et oc?an
> [2] V?g?tation clairsem?e
> [3] Pelouses et p?turages naturels
> [4] V?g?tation scl?rophylle (y.c. maquis et garrigue)
> [5] V?g?tation scl?rophylle (y.c. maquis et garrigue)
>
>> marktable(ppp[1:10], R=50)
>       mark
> point A?roports Chantiers Cours et voie d'eau
>     1          0         0                   0
>     2          0         0                   0
>     3          0         0                   0
>     4          0         0                   0
>     5          0         0                   0
>     6          0         0                   0
>     7          0         0                   0
>     8          0         0                   0
>     9          0         0                   0
>     10         0         0                   0
>       mark
> point Equipements sportifs et de loisirs
>     1                                   0
>     2                                   0
>     3                                   0
>     4                                   0
>     5                                   0
>     6                                   0
>     7                                   0
>     8                                   0
>     9                                   0
>     10                                  0
>
> I don't see where the problem is..
>
> Any help would be greatly appreciated.

Why do you assert that you should get at least one "1"?  If there are no
points of your pattern within 50 units of any given point, then the table
will indeed consist of nothing but zeros.

If you don't believe that this is the problem then please provide a minimal
***reproducible*** example that we can work with, as the posting guide
requests.

And ***PLEASE*** do not call your point pattern "ppp"; this is the name
of a function and class in the spatstat package.  Using it as the name of
an object is very confusing and potentially a source of errors.  See
fortune("dog").

     cheers,

         Rolf Turner


From greenberg at ucdavis.edu  Wed May 18 01:25:18 2011
From: greenberg at ucdavis.edu (Jonathan Greenberg)
Date: Tue, 17 May 2011 16:25:18 -0700
Subject: [R-sig-Geo] Generate a coordinate (latitude) image?
Message-ID: <BANLkTimaURDuXxMq3_fwgnnkdakvHVy3fQ@mail.gmail.com>

Folks:

Is there any way to take a raster and generate two outputs where
each pixel is the center coordinate of that pixel (e.g. you will have
one x- image and one y-image)?  I'm trying to produce a "latitude map"
for solar calculations.

--j


-- 
Jonathan A. Greenberg, PhD
Assistant Project Scientist
Center for Spatial Technologies and Remote Sensing (CSTARS)
Department of Land, Air and Water Resources
University of California, Davis
One Shields Avenue
Davis, CA 95616
Phone: 415-763-5476
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307


From sep at umail.ucsb.edu  Wed May 18 01:56:11 2011
From: sep at umail.ucsb.edu (Sam Prentice)
Date: Tue, 17 May 2011 16:56:11 -0700
Subject: [R-sig-Geo] readRAST6() in {spgrass6}
In-Reply-To: <alpine.LRH.2.00.1105170613130.20286@reclus.nhh.no>
References: <003f01cc0f48$3f7a66b0$be6f3410$@umail.ucsb.edu>
	<BANLkTi=1MTqesqeiyaoAp0kapSJc271JfA@mail.gmail.com>
	<007701cc140f$b84227b0$28c67710$@umail.ucsb.edu>
	<BANLkTi=rPeh9nrXh6ZdDbAjzHzzz=DtQgA@mail.gmail.com>
	<alpine.LRH.2.00.1105170613130.20286@reclus.nhh.no>
Message-ID: <003301cc14ed$ff63b170$fe2b1450$@umail.ucsb.edu>

Hello,

After resampling down and subsetting my DEM derivatives using g.region, I am
getting the same error. The first input file ("clip1_er1m") is now 550KB,
and the .tmp file in the error is 800KB. Code and output copied below. Am I
correct now in concluding this is not an issue with data size/structure? Any
further thoughts about how to proceed?

Sam

# PREPEND
require(spgrass6)
require(cluster)

# READ IN SPATIAL DATA FROM GRASS IN R SESSION
initGRASS("C:/Program Files (x86)/GRASS 6.4.1", home = tempdir(),
,"D:/GRASSdata", "Sedgwick2", "PERMANENT", override = "TRUE")
gmeta6 = gmeta6()
gisdbase    D:/GRASSdata 
location    Sedgwick2 
mapset      PERMANENT 
rows        500 
columns     402 
north       -3569501 
south       -3570001 
west        -19670403 
east        -19670001 
nsres       1 
ewres       1 
projection  +proj=utm +no_defs +zone=10 +a=6378137 +rf=298.257223563
+towgs84=0.000,0.000,0.000 +to_meter=1

#read in raster files
x =
readRAST6(c("clip1_er1m","clip1_crosC_1m","clip1_longC_1m","clip1_slope5","c
lip1_profC","clip1_miniC_1m","clip1_maxiC_1m"))
D:/GRASSdata/Sedgwick2/PERMANENT/.tmp/clip1_er1m has GDAL driver GTiff 
and has 500 rows and 402 columns

Permission denied
Error in deleteDataset(DS) : 
	GDAL Error 1: Deleting
D:/GRASSdata/Sedgwick2/PERMANENT/.tmp/clip1_er1m failed:
Permission denied



|-----Original Message-----
|From: Roger Bivand [mailto:Roger.Bivand at nhh.no]
|Sent: Monday, May 16, 2011 9:28 PM
|To: Sam Prentice
|Cc: Dylan Beaudette; r-sig-geo at r-project.org
|Subject: Re: [R-sig-Geo] readRAST6() in {spgrass6}
|
|On Mon, 16 May 2011, Dylan Beaudette wrote:
|
|> It is hard to know what the upper-limit is on Windows-- as the memory
|> is usually fragmented by the operating system.
|
|Correct, the upper limit on other OS is higher in practice.
|
|>
|> Since you are using GRASS, I would first try a coarsened version of
|> your terrain-shape rasters via the built-in re-sampling functionality.
|> While this is not ideal, as it is NN-based, it will give a quick way
|> to try out methods.
|>
|> After you have initialized your GRASS connection in R, execute something
|like:
|>
|> system('g.region res=10 -ap')
|>
|> This will align the region along a 10x10 map unit grid. All further
|> interaction with raster data will be automatically re-sampled to this
|> grid system.
|
|Right, for some res=, you will get a systematic sample that will let you
|decimate your data. Randomly shifting the window while resampling will help
|you see whether your classification model boundaries change.
|
|As both Dylan and I have said, there is no good reason for calibrating the
|classification model with more data than necessary, even if it were
possible.
|The only reason to use very much data would be if discrimination between
|very rare classes is your target, but even then you could stratify your
sample
|to get better representation of critical areas.
|
|You seem to be looking for classification signatures, from which you are
going
|to predict. Sampling will give you distributions of these signatures, which
could
|be used for similation by tile. If you are very concerned about the
statistical
|quality of your classification signatures, you could go fuzzy, but your
main goal
|is to get to the distributions of these signatures, IMO. Once you have
them,
|you can predict. You do not need to have GBs of dat in memory to do this
|adequately.
|
|So one could agree that software (OS, R, whatever) is your limitation, but
it is
|only a limitation if you are not able to consider more statistical
approaches to
|your apparent problem, which is finding out how to classify your input, and
|then to predict to output.
|
|Roger
|
|>
|> Dylan
|>
|> On Mon, May 16, 2011 at 2:25 PM, Sam Prentice <sep at umail.ucsb.edu>
|wrote:
|>> Thanks you for your suggestions. This error is not affected by choice
|>> of mapset, and is not limited by my hardware.
|>>
|>> Further info: I'm running 64-bit windows, 16MB memory, w/multiple cores.
|>> GRASS 6.4.1, R 2.12.2. I'm running standalone R using initGRASS() to
|>> set GRASS env parameters. The GRASS files I'm trying to read-in are
|>> DEM derivatives, each ~170MB. The intermediate .tmp file in the error
|>> message is 300MB.
|>>
|>> It's been suggested that I am "likely trying to import too much data
|>> into R". Assuming non-limiting computer power, what is the upper
|>> bound on amount of data that can be read into R from GRASS? If not a
|>> fixed amount, what are the main conditions that cause it to vary? I
|>> did not see this addressed in the {spgrass6} documentation, so I'm
|>> assuming it's a base R limitation, but maybe not? Quantifying this
|>> limitation will help determined how to move forward (e.g, resampling
|>> at smaller scale versus subsetting my DEM derivatives).
|>>
|>> Thanks,
|>> Sam
|>>
|>> |-----Original Message-----
|>> |From: Pierre Roudier [mailto:pierre.roudier at gmail.com]
|>> |Sent: Tuesday, May 10, 2011 3:40 PM
|>> |To: Sam Prentice
|>> |Cc: r-sig-geo at r-project.org
|>> |Subject: Re: [R-sig-Geo] readRAST6() in {spgrass6}
|>> |
|>> |Could that message have anything to do with the fact that this is a
|>> |layer
|>> from
|>> |the PERMANENT mapset?
|>> |
|>> |My two cents,
|>> |
|>> |Pierre
|>> |
|>> |2011/5/11 Sam Prentice <sep at umail.ucsb.edu>:
|>> |> Hi,
|>> |>
|>> |>
|>> |>
|>> |> I'm running R 2.12.2 via Tinn-R on Windows Server 2008. I'm using
|>> |> R for cluster analysis for terrain classification and I'm getting
|>> |> the following error when parsing GRASS data into R:
|>> |>
|>> |>
|>> |>
|>> |>> x =
|>> |>
|>>
||readRAST6(c("param_elev3","param_crosC_1m","param_longC_1m","para
|m
|>> |_slope5","
|>> |> param_profC","param_miniC_1m","param_maxiC_1m"))
|>> |>
|>> |> D:/GRASSdata/Sedgwick2/PERMANENT/.tmp/param_elev3 has GDAL
|driver
|>> |> GTiff
|>> |>
|>> |> and has 6224 rows and 6242 columns
|>> |>
|>> |>
|>> |>
|>> |> Error in deleteDataset(DS) :
|>> |>
|>> |>                GDAL Error 1: Deleting
|>> |> D:/GRASSdata/Sedgwick2/PERMANENT/.tmp/param_elev3 failed:
|>> |>
|>> |> Permission denied
|>> |>
|>> |>
|>> |>
|>> |> On the surface this looked like an issue with user privileges,
|>> |> since I do not have admin-level user privileges on this machine.
|>> |> However, this has been corrected - I now have permissions on the
|>> |> .tmp directory listed in the error, and I can create, append, and
|>> |> delete any file in that location, but the error is still occurring.
|>> |>
|>> |>
|>> |>
|>> |> Thoughts?
|>> |>
|>> |>
|>> |>
|>> |> Thanks,
|>> |>
|>> |> Sam
|>> |>
|>> |>
|>> |>        [[alternative HTML version deleted]]
|>> |>
|>> |> _______________________________________________
|>> |> R-sig-Geo mailing list
|>> |> R-sig-Geo at r-project.org
|>> |> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
|>> |>
|>> |
|>> |
|>> |
|>> |--
|>> |Scientist
|>> |Landcare Research, New Zealand
|>>
|>> _______________________________________________
|>> R-sig-Geo mailing list
|>> R-sig-Geo at r-project.org
|>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
|>>
|>
|> _______________________________________________
|> R-sig-Geo mailing list
|> R-sig-Geo at r-project.org
|> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
|>
|
|--
|Roger Bivand
|Economic Geography Section, Department of Economics, Norwegian School of
|Economics and Business Administration, Helleveien 30, N-5045 Bergen,
|Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
|e-mail: Roger.Bivand at nhh.no


From debeaudette at ucdavis.edu  Wed May 18 06:10:07 2011
From: debeaudette at ucdavis.edu (Dylan Beaudette)
Date: Tue, 17 May 2011 21:10:07 -0700
Subject: [R-sig-Geo] readRAST6() in {spgrass6}
In-Reply-To: <003301cc14ed$ff63b170$fe2b1450$@umail.ucsb.edu>
References: <003f01cc0f48$3f7a66b0$be6f3410$@umail.ucsb.edu>
	<alpine.LRH.2.00.1105170613130.20286@reclus.nhh.no>
	<003301cc14ed$ff63b170$fe2b1450$@umail.ucsb.edu>
Message-ID: <201105172110.07688.dylan.beaudette@gmail.com>

On Tuesday, May 17, 2011, Sam Prentice wrote:
> #read in raster files
> x =
> readRAST6(c("clip1_er1m","clip1_crosC_1m","clip1_longC_1m","clip1_slope5","c
> lip1_profC","clip1_miniC_1m","clip1_maxiC_1m"))
> D:/GRASSdata/Sedgwick2/PERMANENT/.tmp/clip1_er1m has GDAL driver GTiff 
> and has 500 rows and 402 columns
> 


Try something like this and report back:
x <- 
readRAST6(vname=c("clip1_er1m","clip1_crosC_1m","clip1_longC_1m","clip1_slope5","clip1_profC","clip1_miniC_1m","clip1_maxiC_1m"), 
plugin=TRUE, useGDAL=FALSE)

Dylan

-- 
Dylan E. Beaudette
USDA-NRCS Soil Scientist
California Soil Resource Lab
http://casoilresource.lawr.ucdavis.edu/


From r.turner at auckland.ac.nz  Wed May 18 07:27:55 2011
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Wed, 18 May 2011 17:27:55 +1200
Subject: [R-sig-Geo] Help w/ transposed matrix indices for "owin" object
 with quadrat.test
In-Reply-To: <e9f13bf3-dfa9-c8c4-bc5f-b9ac157f84a8@me.com>
References: <e9f13bf3-dfa9-c8c4-bc5f-b9ac157f84a8@me.com>
Message-ID: <4DD358DB.8060807@auckland.ac.nz>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110518/d2804c18/attachment.pl>

From Roger.Bivand at nhh.no  Wed May 18 07:56:08 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 18 May 2011 07:56:08 +0200 (CEST)
Subject: [R-sig-Geo] readRAST6() in {spgrass6}
In-Reply-To: <003301cc14ed$ff63b170$fe2b1450$@umail.ucsb.edu>
References: <003f01cc0f48$3f7a66b0$be6f3410$@umail.ucsb.edu>
	<BANLkTi=1MTqesqeiyaoAp0kapSJc271JfA@mail.gmail.com>
	<007701cc140f$b84227b0$28c67710$@umail.ucsb.edu>
	<BANLkTi=rPeh9nrXh6ZdDbAjzHzzz=DtQgA@mail.gmail.com>
	<alpine.LRH.2.00.1105170613130.20286@reclus.nhh.no>
	<003301cc14ed$ff63b170$fe2b1450$@umail.ucsb.edu>
Message-ID: <alpine.LRH.2.00.1105180724260.24493@reclus.nhh.no>

On Tue, 17 May 2011, Sam Prentice wrote:

> Hello,
>
> After resampling down and subsetting my DEM derivatives using g.region, I am
> getting the same error. The first input file ("clip1_er1m") is now 550KB,
> and the .tmp file in the error is 800KB. Code and output copied below. Am I
> correct now in concluding this is not an issue with data size/structure? Any
> further thoughts about how to proceed?

Fortunately, you have now given some useful information, suggesting that 
you have not understood how to use the interface.

I do not have your location, so cannot check. It appears that your 
workflow is highly non-standard - which you have not made clear 
previously. If you are using spgrass6 to interface R with an existing 
GRASS location - which seems to be the case, you should not use 
initGRASS(), and should not use the PERMANENT mapset. The initGRASS() 
function is for creating one-time, throwaway GRASS locations to use GRASS 
modules from R when no GISDBASE or LOCATION is required. Under Linux, I 
cannot reproduce this problem, in addition you seem to be using a Windows 
server OS, to which I have no access.

Start GRASS under Windows from the MSYS/GRASS icon, selecting the location 
and mapset (not PERMANENT) in the usual way for interactive use. Then 
start R from the MSYS console prompt - perhaps other possibilities exist 
for starting R within GRASS for the Windows native build of 6.4.1. R will 
then be "inside" the GRASS session defined by the GRASS environmental 
variables and the GISRC file. I do not know if you can run non-interactive 
on Windows, it isn't a common situation. If you can start GRASS from a 
Windows console/terminal - interactively, next start R from the GRASS 
prompt - you will need to be very careful to set PATH variables. Windows 
by definition is supposed to be run interactively, as its name suggests.

Finally, this is not the correct list for detailed R/GRASS questions - you 
are asking about things which are very specific. Use this list instead:

http://lists.osgeo.org/mailman/listinfo/grass-stats

Roger

>
> Sam
>
> # PREPEND
> require(spgrass6)
> require(cluster)
>
> # READ IN SPATIAL DATA FROM GRASS IN R SESSION
> initGRASS("C:/Program Files (x86)/GRASS 6.4.1", home = tempdir(),
> ,"D:/GRASSdata", "Sedgwick2", "PERMANENT", override = "TRUE")
> gmeta6 = gmeta6()
> gisdbase    D:/GRASSdata
> location    Sedgwick2
> mapset      PERMANENT
> rows        500
> columns     402
> north       -3569501
> south       -3570001
> west        -19670403
> east        -19670001
> nsres       1
> ewres       1
> projection  +proj=utm +no_defs +zone=10 +a=6378137 +rf=298.257223563
> +towgs84=0.000,0.000,0.000 +to_meter=1
>
> #read in raster files
> x =
> readRAST6(c("clip1_er1m","clip1_crosC_1m","clip1_longC_1m","clip1_slope5","c
> lip1_profC","clip1_miniC_1m","clip1_maxiC_1m"))
> D:/GRASSdata/Sedgwick2/PERMANENT/.tmp/clip1_er1m has GDAL driver GTiff
> and has 500 rows and 402 columns
>
> Permission denied
> Error in deleteDataset(DS) :
> 	GDAL Error 1: Deleting
> D:/GRASSdata/Sedgwick2/PERMANENT/.tmp/clip1_er1m failed:
> Permission denied
>
>
>
> |-----Original Message-----
> |From: Roger Bivand [mailto:Roger.Bivand at nhh.no]
> |Sent: Monday, May 16, 2011 9:28 PM
> |To: Sam Prentice
> |Cc: Dylan Beaudette; r-sig-geo at r-project.org
> |Subject: Re: [R-sig-Geo] readRAST6() in {spgrass6}
> |
> |On Mon, 16 May 2011, Dylan Beaudette wrote:
> |
> |> It is hard to know what the upper-limit is on Windows-- as the memory
> |> is usually fragmented by the operating system.
> |
> |Correct, the upper limit on other OS is higher in practice.
> |
> |>
> |> Since you are using GRASS, I would first try a coarsened version of
> |> your terrain-shape rasters via the built-in re-sampling functionality.
> |> While this is not ideal, as it is NN-based, it will give a quick way
> |> to try out methods.
> |>
> |> After you have initialized your GRASS connection in R, execute something
> |like:
> |>
> |> system('g.region res=10 -ap')
> |>
> |> This will align the region along a 10x10 map unit grid. All further
> |> interaction with raster data will be automatically re-sampled to this
> |> grid system.
> |
> |Right, for some res=, you will get a systematic sample that will let you
> |decimate your data. Randomly shifting the window while resampling will help
> |you see whether your classification model boundaries change.
> |
> |As both Dylan and I have said, there is no good reason for calibrating the
> |classification model with more data than necessary, even if it were
> possible.
> |The only reason to use very much data would be if discrimination between
> |very rare classes is your target, but even then you could stratify your
> sample
> |to get better representation of critical areas.
> |
> |You seem to be looking for classification signatures, from which you are
> going
> |to predict. Sampling will give you distributions of these signatures, which
> could
> |be used for similation by tile. If you are very concerned about the
> statistical
> |quality of your classification signatures, you could go fuzzy, but your
> main goal
> |is to get to the distributions of these signatures, IMO. Once you have
> them,
> |you can predict. You do not need to have GBs of dat in memory to do this
> |adequately.
> |
> |So one could agree that software (OS, R, whatever) is your limitation, but
> it is
> |only a limitation if you are not able to consider more statistical
> approaches to
> |your apparent problem, which is finding out how to classify your input, and
> |then to predict to output.
> |
> |Roger
> |
> |>
> |> Dylan
> |>
> |> On Mon, May 16, 2011 at 2:25 PM, Sam Prentice <sep at umail.ucsb.edu>
> |wrote:
> |>> Thanks you for your suggestions. This error is not affected by choice
> |>> of mapset, and is not limited by my hardware.
> |>>
> |>> Further info: I'm running 64-bit windows, 16MB memory, w/multiple cores.
> |>> GRASS 6.4.1, R 2.12.2. I'm running standalone R using initGRASS() to
> |>> set GRASS env parameters. The GRASS files I'm trying to read-in are
> |>> DEM derivatives, each ~170MB. The intermediate .tmp file in the error
> |>> message is 300MB.
> |>>
> |>> It's been suggested that I am "likely trying to import too much data
> |>> into R". Assuming non-limiting computer power, what is the upper
> |>> bound on amount of data that can be read into R from GRASS? If not a
> |>> fixed amount, what are the main conditions that cause it to vary? I
> |>> did not see this addressed in the {spgrass6} documentation, so I'm
> |>> assuming it's a base R limitation, but maybe not? Quantifying this
> |>> limitation will help determined how to move forward (e.g, resampling
> |>> at smaller scale versus subsetting my DEM derivatives).
> |>>
> |>> Thanks,
> |>> Sam
> |>>
> |>> |-----Original Message-----
> |>> |From: Pierre Roudier [mailto:pierre.roudier at gmail.com]
> |>> |Sent: Tuesday, May 10, 2011 3:40 PM
> |>> |To: Sam Prentice
> |>> |Cc: r-sig-geo at r-project.org
> |>> |Subject: Re: [R-sig-Geo] readRAST6() in {spgrass6}
> |>> |
> |>> |Could that message have anything to do with the fact that this is a
> |>> |layer
> |>> from
> |>> |the PERMANENT mapset?
> |>> |
> |>> |My two cents,
> |>> |
> |>> |Pierre
> |>> |
> |>> |2011/5/11 Sam Prentice <sep at umail.ucsb.edu>:
> |>> |> Hi,
> |>> |>
> |>> |>
> |>> |>
> |>> |> I'm running R 2.12.2 via Tinn-R on Windows Server 2008. I'm using
> |>> |> R for cluster analysis for terrain classification and I'm getting
> |>> |> the following error when parsing GRASS data into R:
> |>> |>
> |>> |>
> |>> |>
> |>> |>> x =
> |>> |>
> |>>
> ||readRAST6(c("param_elev3","param_crosC_1m","param_longC_1m","para
> |m
> |>> |_slope5","
> |>> |> param_profC","param_miniC_1m","param_maxiC_1m"))
> |>> |>
> |>> |> D:/GRASSdata/Sedgwick2/PERMANENT/.tmp/param_elev3 has GDAL
> |driver
> |>> |> GTiff
> |>> |>
> |>> |> and has 6224 rows and 6242 columns
> |>> |>
> |>> |>
> |>> |>
> |>> |> Error in deleteDataset(DS) :
> |>> |>
> |>> |>                GDAL Error 1: Deleting
> |>> |> D:/GRASSdata/Sedgwick2/PERMANENT/.tmp/param_elev3 failed:
> |>> |>
> |>> |> Permission denied
> |>> |>
> |>> |>
> |>> |>
> |>> |> On the surface this looked like an issue with user privileges,
> |>> |> since I do not have admin-level user privileges on this machine.
> |>> |> However, this has been corrected - I now have permissions on the
> |>> |> .tmp directory listed in the error, and I can create, append, and
> |>> |> delete any file in that location, but the error is still occurring.
> |>> |>
> |>> |>
> |>> |>
> |>> |> Thoughts?
> |>> |>
> |>> |>
> |>> |>
> |>> |> Thanks,
> |>> |>
> |>> |> Sam
> |>> |>
> |>> |>
> |>> |>        [[alternative HTML version deleted]]
> |>> |>
> |>> |> _______________________________________________
> |>> |> R-sig-Geo mailing list
> |>> |> R-sig-Geo at r-project.org
> |>> |> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> |>> |>
> |>> |
> |>> |
> |>> |
> |>> |--
> |>> |Scientist
> |>> |Landcare Research, New Zealand
> |>>
> |>> _______________________________________________
> |>> R-sig-Geo mailing list
> |>> R-sig-Geo at r-project.org
> |>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> |>>
> |>
> |> _______________________________________________
> |> R-sig-Geo mailing list
> |> R-sig-Geo at r-project.org
> |> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> |>
> |
> |--
> |Roger Bivand
> |Economic Geography Section, Department of Economics, Norwegian School of
> |Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> |Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> |e-mail: Roger.Bivand at nhh.no
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Wed May 18 07:58:37 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 18 May 2011 07:58:37 +0200 (CEST)
Subject: [R-sig-Geo] readRAST6() in {spgrass6}
In-Reply-To: <201105172110.07688.dylan.beaudette@gmail.com>
References: <003f01cc0f48$3f7a66b0$be6f3410$@umail.ucsb.edu>
	<alpine.LRH.2.00.1105170613130.20286@reclus.nhh.no>
	<003301cc14ed$ff63b170$fe2b1450$@umail.ucsb.edu>
	<201105172110.07688.dylan.beaudette@gmail.com>
Message-ID: <alpine.LRH.2.00.1105180756320.24493@reclus.nhh.no>

On Tue, 17 May 2011, Dylan Beaudette wrote:

> On Tuesday, May 17, 2011, Sam Prentice wrote:
>> #read in raster files
>> x =
>> readRAST6(c("clip1_er1m","clip1_crosC_1m","clip1_longC_1m","clip1_slope5","c
>> lip1_profC","clip1_miniC_1m","clip1_maxiC_1m"))
>> D:/GRASSdata/Sedgwick2/PERMANENT/.tmp/clip1_er1m has GDAL driver GTiff
>> and has 500 rows and 402 columns
>>
>
>
> Try something like this and report back:
> x <-
> readRAST6(vname=c("clip1_er1m","clip1_crosC_1m","clip1_longC_1m","clip1_slope5","clip1_profC","clip1_miniC_1m","clip1_maxiC_1m"),
> plugin=TRUE, useGDAL=FALSE)

Dylan:

Sam will not have a GRASS/GDAL plugin on Windows - it isn't in the 
standard rgdal binary, and Sam will not want to compile from source, I 
think. I believe that the problem is that initGRASS() is not appropriate 
here - see my reply to Sam.

Roger

>
> Dylan
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From mathieu.rajerison at gmail.com  Wed May 18 08:34:13 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Wed, 18 May 2011 08:34:13 +0200
Subject: [R-sig-Geo] density /diversity of points
In-Reply-To: <4DD2DAD5.8080104@auckland.ac.nz>
References: <AD5CA6183570B54F92AA45CE2619F9B90120892B@gi-zrmk.si>
	<zolGN6Pn.1305532742.5958350.marcelino.delacruz@upm.es>
	<AD5CA6183570B54F92AA45CE2619F9B9012089B2@gi-zrmk.si>
	<4DD24055.9060706@upm.es>
	<BANLkTinOR1Zb35mmA-xWHakZYP+Wu8HBAw@mail.gmail.com>
	<4DD2DAD5.8080104@auckland.ac.nz>
Message-ID: <BANLkTimoC6TFoEFxc09CkaKvB_9D_gjiwA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110518/45e88fee/attachment.pl>

From matevz.pavlic at gi-zrmk.si  Wed May 18 09:43:35 2011
From: matevz.pavlic at gi-zrmk.si (=?iso-8859-2?Q?Matev=BE_Pavli=E8?=)
Date: Wed, 18 May 2011 09:43:35 +0200
Subject: [R-sig-Geo] density /diversity of points
In-Reply-To: <BANLkTimoC6TFoEFxc09CkaKvB_9D_gjiwA@mail.gmail.com>
References: <AD5CA6183570B54F92AA45CE2619F9B90120892B@gi-zrmk.si><zolGN6Pn.1305532742.5958350.marcelino.delacruz@upm.es><AD5CA6183570B54F92AA45CE2619F9B9012089B2@gi-zrmk.si><4DD24055.9060706@upm.es><BANLkTinOR1Zb35mmA-xWHakZYP+Wu8HBAw@mail.gmail.com><4DD2DAD5.8080104@auckland.ac.nz>
	<BANLkTimoC6TFoEFxc09CkaKvB_9D_gjiwA@mail.gmail.com>
Message-ID: <AD5CA6183570B54F92AA45CE2619F9B90123F7C9@gi-zrmk.si>

Hi all, 

I can not for the life of me find out how to covert this : 

plot(eval.im(mol.simpson.s >0.3 & (mol.den/max(mol.den))>0.3)) 

into any kind of grid or shape with projection that can be used in some GIS software. Any help is greatly appreciated.

m

-----Original Message-----
From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Mathieu Rajerison
Sent: Wednesday, May 18, 2011 8:34 AM
To: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] density /diversity of points

Yes, you're totally right about the name of the objects :)

So, setting exclude=FALSE is necessary if one wishes to include the point itself in the marktable function and there is no zero values, at least one "1"
clc.tab<-marktable(clc.ppp, R=20, exclude=FALSE)

To get the minimal radius for which a neighbor is found, I simply used nndist function
min(nndist(clc.ppp))

Finally, I decided to set a 2000 units radius and to include the radius starting point clc.tab<-marktable(clc.ppp, R=2000, exclude=FALSE)

I get good results

Thanks everybody for everything!

2011/5/17 Rolf Turner <r.turner at auckland.ac.nz>

> On 18/05/11 05:05, Mathieu Rajerison wrote:
>
>> I've tried your method to determine the richness of landscapes on my 
>> area of interest using european corine land cover.
>>
>> I converted my polygon layer into a SpatialGridDataFrame then into a 
>> SpatialPointsDataFrame, and finally into a ppp object using one column:
>> the
>> type of soil occupation (CLC3_LIB).
>>
>> But my problem is that marktable gives me zero values, although I 
>> should get at least a "1" value for one of my columns...
>>
>> Here is a sample code:
>>
>>> ppp[1:5]$marks
>>>
>> [1] Mer et oc?an
>> [2] V?g?tation clairsem?e
>> [3] Pelouses et p?turages naturels
>> [4] V?g?tation scl?rophylle (y.c. maquis et garrigue) [5] V?g?tation 
>> scl?rophylle (y.c. maquis et garrigue)
>>
>>  marktable(ppp[1:10], R=50)
>>>
>>      mark
>> point A?roports Chantiers Cours et voie d'eau
>>    1          0         0                   0
>>    2          0         0                   0
>>    3          0         0                   0
>>    4          0         0                   0
>>    5          0         0                   0
>>    6          0         0                   0
>>    7          0         0                   0
>>    8          0         0                   0
>>    9          0         0                   0
>>    10         0         0                   0
>>      mark
>> point Equipements sportifs et de loisirs
>>    1                                   0
>>    2                                   0
>>    3                                   0
>>    4                                   0
>>    5                                   0
>>    6                                   0
>>    7                                   0
>>    8                                   0
>>    9                                   0
>>    10                                  0
>>
>> I don't see where the problem is..
>>
>> Any help would be greatly appreciated.
>>
>
> Why do you assert that you should get at least one "1"?  If there are 
> no points of your pattern within 50 units of any given point, then the 
> table will indeed consist of nothing but zeros.
>
> If you don't believe that this is the problem then please provide a 
> minimal
> ***reproducible*** example that we can work with, as the posting guide 
> requests.
>
> And ***PLEASE*** do not call your point pattern "ppp"; this is the 
> name of a function and class in the spatstat package.  Using it as the 
> name of an object is very confusing and potentially a source of 
> errors.  See fortune("dog").
>
>    cheers,
>
>        Rolf Turner
>

	[[alternative HTML version deleted]]


From mathieu.rajerison at gmail.com  Wed May 18 11:08:40 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Wed, 18 May 2011 11:08:40 +0200
Subject: [R-sig-Geo] density /diversity of points
In-Reply-To: <AD5CA6183570B54F92AA45CE2619F9B90123F7C9@gi-zrmk.si>
References: <AD5CA6183570B54F92AA45CE2619F9B90120892B@gi-zrmk.si>
	<zolGN6Pn.1305532742.5958350.marcelino.delacruz@upm.es>
	<AD5CA6183570B54F92AA45CE2619F9B9012089B2@gi-zrmk.si>
	<4DD24055.9060706@upm.es>
	<BANLkTinOR1Zb35mmA-xWHakZYP+Wu8HBAw@mail.gmail.com>
	<4DD2DAD5.8080104@auckland.ac.nz>
	<BANLkTimoC6TFoEFxc09CkaKvB_9D_gjiwA@mail.gmail.com>
	<AD5CA6183570B54F92AA45CE2619F9B90123F7C9@gi-zrmk.si>
Message-ID: <BANLkTinsir+zgcMEwkOxkN64nzdtGh6L1A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110518/5bcd9259/attachment.pl>

From manuel.schneider at art.admin.ch  Wed May 18 13:17:02 2011
From: manuel.schneider at art.admin.ch (Manuel Schneider)
Date: Wed, 18 May 2011 11:17:02 +0000
Subject: [R-sig-Geo] Google Static Map tile as underlay
References: <BANLkTik6vDDr9fkUxwPzScK_uyxV_T+uEA@mail.gmail.com>
Message-ID: <loom.20110518T131404-821@post.gmane.org>

You could try

library(dismo)
library(rgdal)

data(meuse)
coordinates(meuse) <- ~x+y
proj4string(meuse) = CRS("+init=epsg:28992")
gproj <- CRS("+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0
+y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs")
e <- extent(bbox(spTransform(meuse,gproj)))
r = gmap(e, type='terrain',exp=1.2)
plot(r, interpolate=F)
points(spTransform(meuse,gproj),pch=16,col=2)

Hth

Manuel


From manuel.schneider at art.admin.ch  Wed May 18 14:08:37 2011
From: manuel.schneider at art.admin.ch (Manuel Schneider)
Date: Wed, 18 May 2011 12:08:37 +0000
Subject: [R-sig-Geo] Generate a coordinate (latitude) image?
References: <BANLkTimaURDuXxMq3_fwgnnkdakvHVy3fQ@mail.gmail.com>
Message-ID: <loom.20110518T140538-400@post.gmane.org>

Jonathan Greenberg <greenberg <at> ucdavis.edu> writes:

> 
> Folks:
> 
> Is there any way to take a raster and generate two outputs where
> each pixel is the center coordinate of that pixel (e.g. you will have
> one x- image and one y-image)?  I'm trying to produce a "latitude map"
> for solar calculations.
> 
> --j
> 

You could use coordinates(as(obj, "SpatialPixels")) but only for relatively
small rasters. And why not calculate by hand?


From michael.denslow at gmail.com  Wed May 18 14:22:14 2011
From: michael.denslow at gmail.com (Michael Denslow)
Date: Wed, 18 May 2011 08:22:14 -0400
Subject: [R-sig-Geo] Generate a coordinate (latitude) image?
In-Reply-To: <BANLkTimaURDuXxMq3_fwgnnkdakvHVy3fQ@mail.gmail.com>
References: <BANLkTimaURDuXxMq3_fwgnnkdakvHVy3fQ@mail.gmail.com>
Message-ID: <BANLkTimYm7wx3QS7umGcqKWLwAnCrcB_xg@mail.gmail.com>

On Tue, May 17, 2011 at 7:25 PM, Jonathan Greenberg
<greenberg at ucdavis.edu> wrote:
> Folks:
>
> Is there any way to take a raster and generate two outputs where
> each pixel is the center coordinate of that pixel (e.g. you will have
> one x- image and one y-image)? ?I'm trying to produce a "latitude map"
> for solar calculations.
>
> --j
>

If you are using the spgrass6 library you should be able to use the
y() argument in the r.mapcalc command from GRASS. I say should because
I have only done this in GRASS directly not using spgrass6.

Hope this helps,
Michael


>
> --
> Jonathan A. Greenberg, PhD
> Assistant Project Scientist
> Center for Spatial Technologies and Remote Sensing (CSTARS)
> Department of Land, Air and Water Resources
> University of California, Davis
> One Shields Avenue
> Davis, CA 95616
> Phone: 415-763-5476
> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Michael Denslow

I.W. Carpenter Jr. Herbarium [BOON]
Department of Biology
Appalachian State University
Boone, North Carolina U.S.A.
-- AND --
Communications Manager
Southeast Regional Network of Expertise and Collections
sernec.org

36.214177, -81.681480 +/- 3103 meters


From marcelino.delacruz at upm.es  Wed May 18 15:15:31 2011
From: marcelino.delacruz at upm.es (Marcelino de la Cruz)
Date: Wed, 18 May 2011 15:15:31 +0200
Subject: [R-sig-Geo] Generate a coordinate (latitude) image?
In-Reply-To: <BANLkTimaURDuXxMq3_fwgnnkdakvHVy3fQ@mail.gmail.com>
References: <BANLkTimaURDuXxMq3_fwgnnkdakvHVy3fQ@mail.gmail.com>
Message-ID: <4DD3C673.6060704@upm.es>


On 18/05/2011 1:25, Jonathan Greenberg wrote:
> Folks:
>
> Is there any way to take a raster and generate two outputs where
> each pixel is the center coordinate of that pixel (e.g. you will have
> one x- image and one y-image)?  I'm trying to produce a "latitude map"
> for solar calculations.
>
>    
If you mean "each pixel value  is the center coordinate of that pixel" 
you could proceed like this:

# (first, I built a raster for my toy example)
library(maptools)
data(meuse.grid) # only the non-missing valued cells
coordinates(meuse.grid) = c("x", "y") # promote to SpatialPointsDataFrame
gridded(meuse.grid) <- TRUE # promote to SpatialPixelsDataFrame

# now, assign the coordinates as values to each pixel
meuse.grid[["xcoord"]] = coordinates(meuse.grid)[,"x"]
meuse.grid[["ycoord"]] = coordinates(meuse.grid)[,"y"]

image(meuse.grid["xcoord"]) # note the single [
image(meuse.grid["ycoord"])

Cheers,
  Marcelino

> --j
>
>
>    


-- 
_________________________________ Marcelino de la Cruz Rot Departamento 
de Biologia Vegetal E.U.T.I. Agricola Universidad Politecnica de Madrid 
28040 Madrid Tel: 34913365654 _________________________________


From debeaudette at ucdavis.edu  Wed May 18 15:21:55 2011
From: debeaudette at ucdavis.edu (Dylan Beaudette)
Date: Wed, 18 May 2011 06:21:55 -0700
Subject: [R-sig-Geo] readRAST6() in {spgrass6}
In-Reply-To: <alpine.LRH.2.00.1105180756320.24493@reclus.nhh.no>
References: <003f01cc0f48$3f7a66b0$be6f3410$@umail.ucsb.edu>
	<201105172110.07688.dylan.beaudette@gmail.com>
	<alpine.LRH.2.00.1105180756320.24493@reclus.nhh.no>
Message-ID: <201105180621.55702.dylan.beaudette@gmail.com>

On Tuesday, May 17, 2011, Roger Bivand wrote:
> On Tue, 17 May 2011, Dylan Beaudette wrote:
> 
> > On Tuesday, May 17, 2011, Sam Prentice wrote:
> >> #read in raster files
> >> x =
> >> 
readRAST6(c("clip1_er1m","clip1_crosC_1m","clip1_longC_1m","clip1_slope5","c
> >> lip1_profC","clip1_miniC_1m","clip1_maxiC_1m"))
> >> D:/GRASSdata/Sedgwick2/PERMANENT/.tmp/clip1_er1m has GDAL driver GTiff
> >> and has 500 rows and 402 columns
> >>
> >
> >
> > Try something like this and report back:
> > x <-
> > 
readRAST6(vname=c("clip1_er1m","clip1_crosC_1m","clip1_longC_1m","clip1_slope5","clip1_profC","clip1_miniC_1m","clip1_maxiC_1m"),
> > plugin=TRUE, useGDAL=FALSE)
> 
> Dylan:
> 
> Sam will not have a GRASS/GDAL plugin on Windows - it isn't in the 
> standard rgdal binary, and Sam will not want to compile from source, I 
> think. I believe that the problem is that initGRASS() is not appropriate 
> here - see my reply to Sam.
> 
> Roger

Thanks for the clarification Roger. It seems that I may have given some bad 
advice to Same, based on my lack of experience with tying GRASS-R together on 
Windows...

Dylan


> >
> > Dylan
> >
> >
> 
> -- 
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
> 
> 


-- 
Dylan E. Beaudette
USDA-NRCS Soil Scientist
California Soil Resource Lab
http://casoilresource.lawr.ucdavis.edu/


From debeaudette at ucdavis.edu  Wed May 18 15:23:47 2011
From: debeaudette at ucdavis.edu (Dylan Beaudette)
Date: Wed, 18 May 2011 06:23:47 -0700
Subject: [R-sig-Geo] readRAST6() in {spgrass6}
In-Reply-To: <alpine.LRH.2.00.1105180724260.24493@reclus.nhh.no>
References: <003f01cc0f48$3f7a66b0$be6f3410$@umail.ucsb.edu>
	<003301cc14ed$ff63b170$fe2b1450$@umail.ucsb.edu>
	<alpine.LRH.2.00.1105180724260.24493@reclus.nhh.no>
Message-ID: <201105180623.47287.dylan.beaudette@gmail.com>

On Tuesday, May 17, 2011, Roger Bivand wrote:
>The initGRASS() 
> function is for creating one-time, throwaway GRASS locations to use GRASS 
> modules from R when no GISDBASE or LOCATION is required. Under Linux, I 
> cannot reproduce this problem, in addition you seem to be using a Windows 
> server OS, to which I have no access.

This is good to know. I may have given some bad advice based on _not_ 
understanding this concept.

I'll try and cook-up a related example with the raster library that may 
generalize better across platforms.

Dylan

-- 
Dylan E. Beaudette
USDA-NRCS Soil Scientist
California Soil Resource Lab
http://casoilresource.lawr.ucdavis.edu/


From mathieu.rajerison at gmail.com  Wed May 18 17:32:23 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Wed, 18 May 2011 17:32:23 +0200
Subject: [R-sig-Geo] question about writeOGR and kml files
In-Reply-To: <586A4828D7AAA04CA9B258C50A28DA206DB783@BALI.uhd.campus>
References: <AcwPCcTKTuyfEfrCQZiAeKQ01nvcxA==>
	<586A4828D7AAA04CA9B258C50A28DA206DB783@BALI.uhd.campus>
Message-ID: <BANLkTinW1RotiGzAjHAfrrokAJW1CadMrQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110518/60276ed8/attachment.pl>

From r.hijmans at gmail.com  Wed May 18 18:30:53 2011
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Wed, 18 May 2011 09:30:53 -0700 (PDT)
Subject: [R-sig-Geo] How to overlay two rasters limiting the spatial
	domain
In-Reply-To: <428668.89389.qm@web161401.mail.bf1.yahoo.com>
References: <428668.89389.qm@web161401.mail.bf1.yahoo.com>
Message-ID: <1305736253656-6378456.post@n2.nabble.com>


Thiago, 
You can use the 'crop' function. 
Best, Robert


> ?Dear R colleagues,
>
> ?Currently, I am working with the vegetation map published by SAGE
> (http://www.sage.wisc.edu/download/potveg/global_potveg.html). This map is
> published in netcdf and I can easily load it into R using the package
> "raster".
>
> ?But I have found another vegetation map (also netcdf, same resolution)
> which is more realistic to my work region. Thus, what I need to do is
> overlay the two maps, but using a clip feature (i.e. a shapefile of South
> America) as a delimiter to this operation, in order to capture the
> information of the newest map.
>
> ?I am trying to use the "overlay" function of raster package, but
> apparently it isn't possible (or I am missing something) to use a clip
> feature to restrain the spatial domain of the operation.
>
> ?Any tips on how to do this? Below is the code I am using.
>
> ?Best wishes,
>
> ?Thiago Veloso.
>
> #Loading required packages
> library(raster)
> library(maptools)
>
> #Loading SAGE vegetation map
> vegmap<-raster("C:/temp/vegmap_ibis/data/vegtype.nc")
>
> #Loading new vegetation map
> new_vegmap<-raster("C:/temp/vegmap_ibis/data/new_vegtype.nc")
>
> #Loading SA shapefile
> south_america<-readShapePoly("C:/temp/vegmap_ibis/shapes/southamerica.shp")
>
> #Replacing the original map with the modified one
> result<-overlay(vegmap,new_vegmap,fun=function(x){x}) #this is where I
> stop - I don't know how to use the shapefile as a clip feature in this
> function...
>


--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/How-to-overlay-two-rasters-limiting-the-spatial-domain-tp6372927p6378456.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From r.hijmans at gmail.com  Wed May 18 18:36:16 2011
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Wed, 18 May 2011 09:36:16 -0700 (PDT)
Subject: [R-sig-Geo] Generate a coordinate (latitude) image?
In-Reply-To: <BANLkTimaURDuXxMq3_fwgnnkdakvHVy3fQ@mail.gmail.com>
References: <BANLkTimaURDuXxMq3_fwgnnkdakvHVy3fQ@mail.gmail.com>
Message-ID: <1305736576595-6378473.post@n2.nabble.com>

> Folks: 
> 
> Is there any way to take a raster and generate two outputs where 
> each pixel is the center coordinate of that pixel (e.g. you will have 
> one x- image and one y-image)?  I'm trying to produce a "latitude map" 
> for solar calculations. 
>
> --j 


Jonathan, 

If your data are in lon/lat

r <- raster()
x <- init(r, v='x')
y <- init(r, v='y')


Or "by hand", for lon/lat do

lat <- yFromRow(r, 1:nrow(r))

if the raster is not lon/lat

xy <- SpatialPoints(xyFromCell(r, cellFromRowCol(1:nrow(r), 1)))
lat <- coordinates( spTransform(xy, CRS( +proj=longlat +datum=WGS84 )))[,2] 

In cases like this, I stop here. Rather than making a latitude raster with
lots of repeated values, I would work with the lat vector. But you could do
something like this:

x <- t((t(r) * lat))
plot(x)


Best, Robert
 

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Generate-a-coordinate-latitude-image-tp6375697p6378473.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From edzer.pebesma at uni-muenster.de  Thu May 19 17:17:29 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 19 May 2011 17:17:29 +0200
Subject: [R-sig-Geo] Find nearest downstream value of a river network
In-Reply-To: <4DA557D4.7060008@jrc.ec.europa.eu>
References: <4DA557D4.7060008@jrc.ec.europa.eu>
Message-ID: <4DD53489.4090408@uni-muenster.de>

Hi Jon (thanks for reminding off-list!), I haven't looked into finding
the line with an ID, but in general finding the nearest SpatialLines
index (which of course might be ambiguous) might be done by:

library(rgeos)
d = gDistance(nres, nres, byid=TRUE)
diag(d)=1e9
apply(d,2,function(x)which(x==min(x))[1])

Does that get you any further? Or are there more clever solutions?
--
Edzer

On 04/13/2011 09:59 AM, Jon Olav Skoien wrote:
> Hi,
> 
> I have a SpatialLinesDataFrame with predictions on different locations
> of a river network that I would like to plot. However, I have many more
> line segments in the network than I have predictions, so most of the
> data.frame has NA-values. Does anyone know a simple way of finding the
> nearest downstream value for a line segment with an NA-value, so that I
> can get a continuous river network with predictions?
> 
> Below is a simple example of what I want to do, based on a shapefile
> ("nres") that can be downloaded from:
> http://intamap.geo.uu.nl/~jon/sarp/tempaacf/
> 
> nres = readOGR(".","nres")
> nin = nres
> nin$pred[!(nin$OBJECTID %in% c(1015, 1020, 1366, 1369, 4981))] = NA
> 
> "nres" is the SpatialLinesDataFrame that I would like to have as result
> after associating all NA-values to the nearest downstream value. "nin"
> is a simplified version of the SpatialLinesDataFrame that I have after
> predicting, and that I would like to use for creating "nres".  "pred" is
> the prediction column in these SLDFs. The following plot shows the
> results (with colors) and thick black lines for the segments where I
> have predictions.
> 
> spplot(nres, "pred", col.regions = bpy.colors(),
>    panel = function(x,y, ...) {
>     panel.polygonsplot(x,y, ...)
>     sp.lines(nin[!is.na(nin$pred),], col = "black", lwd = 2)
>    })
> 
> So far I have got the result in this plot from an iterative procedure
> using the FROMJCT and TOJCT (from and to junction) IDs of the data.frame:
> 
> ichange = 1
> while (ichange > 0) {
>   ichange = 0
>   for (i in 1:dim(nin)[1]) {
>     if (!is.na(nin$pred[i])) {
>       tt = which(nin$TOJCT == nin$FROMJCT[i])
>       if (length(tt) > 0 && is.na(nin$pred[tt])) {
>         nin$pred[tt] = nin$pred[i]
>         ichange = ichange + 1
>       }
>     }
>   }
> }
> 
> But I think it should be either possible to simplify this (quite slow
> for a large river network), or preferably take advantage of topology of
> SpatialLines objects? Any clues?
> 
> Thanks,
> Jon
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From b.rowlingson at lancaster.ac.uk  Thu May 19 18:06:57 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Thu, 19 May 2011 17:06:57 +0100
Subject: [R-sig-Geo] Find nearest downstream value of a river network
In-Reply-To: <4DD53489.4090408@uni-muenster.de>
References: <4DA557D4.7060008@jrc.ec.europa.eu>
	<4DD53489.4090408@uni-muenster.de>
Message-ID: <BANLkTikvxOTJBExOGZudp35W+fm=t2OZeg@mail.gmail.com>

On Thu, May 19, 2011 at 4:17 PM, Edzer Pebesma
<edzer.pebesma at uni-muenster.de> wrote:

> Does that get you any further? Or are there more clever solutions?

>> So far I have got the result in this plot from an iterative procedure
>> using the FROMJCT and TOJCT (from and to junction) IDs of the data.frame:

 If the FROMJCT and TOJCT numbers define nodes of a graph, and the
presence of a row with FROMJCT=a and TOJCT=b defines an edge from a to
b of the graph, then you could use something like R's igraph package
to build a graph object. Once you've done that it should be easy to
use the graph algorithms in that package to wander down the river
system at your leisure...

 It might get complicated if you are modelling on the Orinoco where it
bifurcates, or a river delta :)

 Will have a play now at the end of the working day while waiting for
the Indian Premier League Cricket to start up again...

Barry


From amorenos1 at ucentral.edu.co  Thu May 19 18:08:41 2011
From: amorenos1 at ucentral.edu.co (Angelo Moreno)
Date: Thu, 19 May 2011 09:08:41 -0700 (PDT)
Subject: [R-sig-Geo] Matrix of  distances (km) between Coordinates
Message-ID: <1305821321442-6382641.post@n2.nabble.com>

Hi, I have a list of corrdinates (latitude, longitude), I need to calculate
the distance between each coordinate, and generate a matrix,  How could I
try to do it? Thanks.

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Matrix-of-distances-km-between-Coordinates-tp6382641p6382641.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From marcelino.delacruz at upm.es  Thu May 19 18:28:27 2011
From: marcelino.delacruz at upm.es (Marcelino de la Cruz)
Date: Thu, 19 May 2011 18:28:27 +0200
Subject: [R-sig-Geo] Matrix of  distances (km) between Coordinates
In-Reply-To: <1305821321442-6382641.post@n2.nabble.com>
References: <1305821321442-6382641.post@n2.nabble.com>
Message-ID: <4DD5452B.1060505@upm.es>

as.matrix(dist(corrdinates))

On 19/05/2011 18:08, Angelo Moreno wrote:
> Hi, I have a list of corrdinates (latitude, longitude), I need to calculate
> the distance between each coordinate, and generate a matrix,  How could I
> try to do it? Thanks.
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Matrix-of-distances-km-between-Coordinates-tp6382641p6382641.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>    


-- 
_________________________________ Marcelino de la Cruz Rot Departamento 
de Biologia Vegetal E.U.T.I. Agricola Universidad Politecnica de Madrid 
28040 Madrid Tel: 34913365654 _________________________________


From joy.stanistreet at noaa.gov  Thu May 19 18:29:55 2011
From: joy.stanistreet at noaa.gov (Joy Stanistreet)
Date: Thu, 19 May 2011 09:29:55 -0700 (PDT)
Subject: [R-sig-Geo] New version of adehabitatLT and adehabitatHR
In-Reply-To: <4DB9985D.3040504@oncfs.gouv.fr>
References: <4DB9985D.3040504@oncfs.gouv.fr>
Message-ID: <1305822595690-6382737.post@n2.nabble.com>

Hello,
I am trying to rediscretize a trajectory with steps of equal duration, and
having trouble with the "redisltraj" function in the updated AdehabitatLT. I
have an irregular trajectory with locations sampled approximately every 60
seconds. I am able to turn this into a regular trajectory with a 60 second
time interval with no problems. However, I would also like to resample the
trajectory at lower resolution, for example 120 second intervals. Whenever I
try to use the redisltraj function with a duration longer than the original
interval, R quits with no warning, or gives the following error, then quits: 

   The instruction at "0x6c72c504" referenced memory at "0xc0240004". The
memory could not be "read."
   Click on OK to terminate the program
   Click on CANCEL to debug the program


I have tried this with several different datasets and get the same result
whenever I try to increase
the duration. This problem doesn't occur using any duration shorter than the
original. Is this a bug in
the redisltraj function that can be corrected, or am I simply misusing it?

Alternatively, I tried to use the "subsample" function on my regular
trajectory with 60 second intervals,
specifying a time lag of 120 seconds. This gives me the following error
every time:

   Error in `[.default`(res, , names(res) %in% which, drop = FALSE) : 
    incorrect number of dimensions

I'm sure there are other ways to do this, but any suggestions or help with
these functions would be greatly appreciated!


--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/New-version-of-adehabitatLT-and-adehabitatHR-tp6313981p6382737.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From b.rowlingson at lancaster.ac.uk  Thu May 19 18:46:02 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Thu, 19 May 2011 17:46:02 +0100
Subject: [R-sig-Geo] Matrix of distances (km) between Coordinates
In-Reply-To: <4DD5452B.1060505@upm.es>
References: <1305821321442-6382641.post@n2.nabble.com>
	<4DD5452B.1060505@upm.es>
Message-ID: <BANLkTi=oCq78=h2pCyH_a=ik1PPCNrQFVw@mail.gmail.com>

2011/5/19 Marcelino de la Cruz <marcelino.delacruz at upm.es>:
> as.matrix(dist(corrdinates))

 For small distances near the equator yes! Don't try this if you are
studying polar bears!

 Try rdist.earth in the 'fields' package, or try transforming to a
euclidean coordinate system using spTransform before using dist.

Barry


From edzer.pebesma at uni-muenster.de  Thu May 19 21:24:44 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 19 May 2011 21:24:44 +0200
Subject: [R-sig-Geo] Matrix of distances (km) between Coordinates
In-Reply-To: <BANLkTi=oCq78=h2pCyH_a=ik1PPCNrQFVw@mail.gmail.com>
References: <1305821321442-6382641.post@n2.nabble.com>	<4DD5452B.1060505@upm.es>
	<BANLkTi=oCq78=h2pCyH_a=ik1PPCNrQFVw@mail.gmail.com>
Message-ID: <4DD56E7C.7010809@uni-muenster.de>

?spDists in package sp, with argument longlat = TRUE.

On 05/19/2011 06:46 PM, Barry Rowlingson wrote:
> 2011/5/19 Marcelino de la Cruz <marcelino.delacruz at upm.es>:
>> as.matrix(dist(corrdinates))
> 
>  For small distances near the equator yes! Don't try this if you are
> studying polar bears!
> 
>  Try rdist.earth in the 'fields' package, or try transforming to a
> euclidean coordinate system using spTransform before using dist.
> 
> Barry
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From frijaf1 at mail2science.com  Fri May 20 11:53:52 2011
From: frijaf1 at mail2science.com (Rija FANIRIANTSOA)
Date: Fri, 20 May 2011 02:53:52 -0700
Subject: [R-sig-Geo] Intersection of polygons and polylines
Message-ID: <9BF541359D7743D0A557629911F1A0FB@mail2world.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110520/e6338c9c/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Fri May 20 12:06:40 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Fri, 20 May 2011 11:06:40 +0100
Subject: [R-sig-Geo] Intersection of polygons and polylines
In-Reply-To: <9BF541359D7743D0A557629911F1A0FB@mail2world.com>
References: <9BF541359D7743D0A557629911F1A0FB@mail2world.com>
Message-ID: <BANLkTinvNEGgMpY0OWnf+Gc0m2yzk=0UrQ@mail.gmail.com>

On Fri, May 20, 2011 at 10:53 AM, Rija FANIRIANTSOA
<frijaf1 at mail2science.com> wrote:
>
> L<-SpatialLines(list(Lines(list(Line(cbind(c(7,6,5,4.2,3,2.8,1),
> c(4,3.5,3,2.8,2.5,1.8,1)))),"l1")))

 > require(rgeos)

 > gIntersects(L,polyg,byid=TRUE)
      l1
p1 FALSE
p2 FALSE
p3  TRUE
p4  TRUE

 - that gives you T/F for intersections of L with the polygons in
polyg. Job almost done!

Barry


From laura.poggio at gmail.com  Fri May 20 12:47:28 2011
From: laura.poggio at gmail.com (Laura Poggio)
Date: Fri, 20 May 2011 11:47:28 +0100
Subject: [R-sig-Geo] problems with unconditional simulations (grf) in
 geoR 1.6.33-34 and RandomFields 2.0.4x
In-Reply-To: <alpine.DEB.2.00.1105171526190.5373@macalan.c3local>
References: <BANLkTikh2_ss1WMWswSraO9E4yRqyZEHGA@mail.gmail.com>
	<alpine.DEB.2.00.1105171526190.5373@macalan.c3local>
Message-ID: <BANLkTimrotJSXu51rarjq95krreXQb1mXQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110520/44025104/attachment.pl>

From calamita_giuseppe at yahoo.it  Fri May 20 15:12:51 2011
From: calamita_giuseppe at yahoo.it (giuseppe calamita)
Date: Fri, 20 May 2011 14:12:51 +0100 (BST)
Subject: [R-sig-Geo] splitting (calibration/validation) data sets
In-Reply-To: <mailman.8.1305885603.23987.r-sig-geo@r-project.org>
References: <mailman.8.1305885603.23987.r-sig-geo@r-project.org>
Message-ID: <417679.33634.qm@web25907.mail.ukl.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110520/906ae35b/attachment.pl>

From lestes at princeton.edu  Fri May 20 19:48:37 2011
From: lestes at princeton.edu (Lyndon Estes)
Date: Fri, 20 May 2011 13:48:37 -0400
Subject: [R-sig-Geo] subs (raster) on large dataset
In-Reply-To: <BANLkTikOEoXXALW0x1s5G+M63Dsrzjq6XA@mail.gmail.com>
References: <BANLkTims5qZE1XBcyrU9Y=tYmzaBC0+UPQ@mail.gmail.com>
	<1302803032937-6273741.post@n2.nabble.com>
	<BANLkTi=kO4NnxJMXWfCRo1es76BHRztLQw@mail.gmail.com>
	<BANLkTikOEoXXALW0x1s5G+M63Dsrzjq6XA@mail.gmail.com>
Message-ID: <BANLkTinXP5AJDW9yHWp7Co_pFGizw=+YqQ@mail.gmail.com>

Hi Robert,

My apologies for an even longer delay this time around.  I have gotten
back to this now and followed your suggestions.  Responses are
interspersed in (shortened) text of previous messages.

> That is *horrible*. I am not sure what is going on here. This is my
> rather empirical test to see if you have enough RAM for a given
> computation (and to work with chunks if not). Although it is somewhat
> inefficient, I have never seen anything crazy like this. I wonder if
> you have insufficient RAM and that virtual RAM is created on-disk as
> the object grows. I may lower the default maxmemory setting because of
> this. You can also set it with setOptions. You can also do
> setOptions(todisk=TRUE) ?before using this function (and set it back
> afterwards, to force the function to use chunks (canProcessInMemory
> will return FALSE before doing the memory consuming test).

I used the setOptions function as you have suggested by embedding it
in my function (full code pasted at the foot of this email):

# Force to write to disk
if(raster:::.toDisk() != TRUE) {
   setOptions(todisk = TRUE)
   cat("We don't want memory problems--forcing write to disk.\n")
}

With this option, my code completed in 33 minutes (with the largest
raster being ~1 GB).  I also reran my code with toDisk = FALSE, and
watched R memory usage via top.  As you suspected, memory was
constantly increasing, both actual and virtual. I believe I had enough
RAM available at the time (~2 GB), so there seems to be some problem
there, but perhaps this is an issue for R-Sig-Mac?

> all raster functions that start with an "." are hidden but are
> accessible via raster:::
> e.g.
> raster:::.maxmemory

Thanks, I guess I should have already known that...

> In some functions that is true, but not in this one. Even if you
> supply a filename, the whole thing will be done in memory if possible,
> and the only at the end will the resulting raster data be written to
> disk. Perhaps it would be safer if it would always work as you
> expected.

It's easy enough for me to write the toDIsk = TRUE option into
functions, so thanks again for this tip.

Lastly, there is one small thing that I noticed while working on this
issue, based on the function that follows.  I noticed that in a case
such as this:

    cat("Substituting...")
    subs(spatialmaster, CSMtable, by = LUfield, which = outfields[i],
subsWithNA = TRUE, filename =
                   out.nm, datatype = type, overwrite = TRUE, progress = "text")

That the progress bar and cat don't play together, in that cat is not
displayed. I am not sure why, but perhaps it is simply being
overwritten in the console by the progress bar?  I opted to turn off
the progress bar in favor of the messages produced by cat in this
case. This isn't something I am terribly concerned with, but I thought
I would mention it in case it is of interest.

Thanks again for all your help.

Cheers, Lyndon



spatCSM <- function(spatialmaster, resamplegrid, res.factor, CSMtable,
LUfield, outfields, outnames, type) {
# Creates spatial output grids from results produced by runCSM
function. Path needs to be set in advance
# Args:
#   spatialmaster: A grid defining the location of each spatial units
#   resamplegrid: An optional grid defining the resolution to which
results should be resampled
#   resamplefactor: Factor by which to aggregate (e.g. 10 times
current pixel size, the default if not
#     specified)
#   CSMtable: The output table of CSM statistics generated by runCSM
#   LUfield: The field in CSMtable containing the spatial unit codes
that match values in spatialmaster grid
#   outfields: A vector of column names in CSMtable for which gridded
outputs are wanted, e.g. yield, CV yield
#   outnames: A vector of names for writing output grids, one for each
specifed grid
#   type: Output datatype for grid, e.g. INT2S
# Returns: R format raster grids, saved to disk, of mean yield and
other optional grids

  library(raster)
  if(missing(spatialmaster) | missing(CSMtable) | missing(LUfield) |
     missing(outfields) | missing(type)) {
     stop("Missing parameter, check function list.")
  }
  if(length(outfields) != length(outnames)) {
     stop("Number of names for output grids does not match number of
specified output grids")
  }

  cat("Running...")

  # Force to write to disk
  if(raster:::.toDisk() != TRUE) {
     setOptions(todisk = TRUE)
     cat("We don't want memory problems--forcing write to disk.\n")
  }

  for(i in 1:length(outfields)) {

    out.nm <- paste(outnames[i], ".grd", sep = "")
    cat("Substituting...")
    subs(spatialmaster, CSMtable, by = LUfield, which = outfields[i],
subsWithNA = TRUE, filename =
                   out.nm, datatype = type, overwrite = TRUE)#,
progress = "text")

    if(!missing(resamplegrid)) {
      cat("Aggregating...")
      if(missing(res.factor)) {
        res.factor <- 10
      }
      subs.g <- raster(out.nm)
      out.nm2 <- paste("agg.", out.nm, sep = "")
      aggregate(subs.g, res.factor, fun = mean, na.rm = TRUE,
                filename = out.nm2, datatype = type, overwrite =
TRUE)#, progress = "text")
      subs.g.agg <- raster(out.nm2)
      out.nm3 <- paste(outnames[i], ".",
as.integer(res(resamplegrid)[1]), ".grd", sep = "")
      cat("Resampling...")
      resample(subs.g.agg, resamplegrid, method = "bilinear", filename
= out.nm3, datatype = type,
               overwrite = TRUE)#, progress = "text")
    }
  }
  cat("Done.")
  setOptions(todisk = FALSE)  # Return to default option allowing
raster processing in memory
}


From clement.calenge at oncfs.gouv.fr  Fri May 20 20:24:07 2011
From: clement.calenge at oncfs.gouv.fr (=?ISO-8859-1?Q?Cl=E9ment_Calenge?=)
Date: Fri, 20 May 2011 20:24:07 +0200
Subject: [R-sig-Geo] New version of adehabitatLT and adehabitatHR
In-Reply-To: <1305822595690-6382737.post@n2.nabble.com>
References: <4DB9985D.3040504@oncfs.gouv.fr>
	<1305822595690-6382737.post@n2.nabble.com>
Message-ID: <4DD6B1C7.7080109@oncfs.gouv.fr>

Hello,


> I am trying to rediscretize a trajectory with steps of equal duration, and
> having trouble with the "redisltraj" function in the updated AdehabitatLT. I
> have an irregular trajectory with locations sampled approximately every 60
> seconds. I am able to turn this into a regular trajectory with a 60 second
> time interval with no problems. However, I would also like to resample the
> trajectory at lower resolution, for example 120 second intervals. Whenever I
> try to use the redisltraj function with a duration longer than the original
> interval, R quits with no warning, or gives the following error, then quits:
>
>     The instruction at "0x6c72c504" referenced memory at "0xc0240004". The
> memory could not be "read."
>     Click on OK to terminate the program
>     Click on CANCEL to debug the program
>
>
> I have tried this with several different datasets and get the same result
> whenever I try to increase
> the duration. This problem doesn't occur using any duration shorter than the
> original. Is this a bug in
> the redisltraj function that can be corrected, or am I simply misusing it?

You are right, there is actually a bug. I have fixed it and uploaded a 
new version of the package to CRAN.
Binary versions will soon be available for downloading.
Thanks for reporting,
Best regards,


Cl?ment Calenge

-- 
Cl?ment CALENGE
Cellule d'appui ? l'analyse de donn?es
Direction des Etudes et de la Recherche
Office national de la chasse et de la faune sauvage
Saint Benoist - 78610 Auffargis
tel. (33) 01.30.46.54.14


From megotte at gmail.com  Sat May 21 00:07:40 2011
From: megotte at gmail.com (Megan Marcotte)
Date: Fri, 20 May 2011 16:07:40 -0600
Subject: [R-sig-Geo] WGS 84 coordinates and the use of Euclidean
 calculations for short distances--is it ever okay?
Message-ID: <BANLkTinYUuFKZN08jEsWh7x4P94aFSL=Aw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110520/860bff7c/attachment.pl>

From hhamidghorbani at gmail.com  Sat May 21 00:11:24 2011
From: hhamidghorbani at gmail.com (Hamid Ghorbani)
Date: Sat, 21 May 2011 02:41:24 +0430
Subject: [R-sig-Geo] test of CSR in 3D
Message-ID: <BANLkTikKSbtWgjDqjh0jmkM3+X_OEjC-fw@mail.gmail.com>

Dear list,
let L be the L function for a point pattern in 3D.
using spatstat I need a plot of \hat{L(r)} - r vs. r along with the
corresponding envelopes for a simulated pattern.

The K function have to be estimated for  r's  in [0,rmax] with "nrval"
equal to let say 1001 (nraval is the number of values of r for which
K3(r) will be estimated).

I use the following codes. using the ccommand env$r shows the rmax and
nrval and  has not taken in to account. Furthermore the y axis is
\hat{L(r)} not \hat{L(r)} - r.

Any correction please. many thanks in advance.

Hamid Gh.
=============
lambda<-470
r0<-73
X<-runifpoint3(lambda, domain = box3(c(150,350),c(150,350),c(300,400)))

env = envelope.pp3(X, fun = K3est,r=seq(0,r0, 1001), nsim = 99,
correction = "iso",transform=expression((3*./(4*pi))^(1/3)))
plot(env)
env$r


From tlumley at uw.edu  Sat May 21 00:21:29 2011
From: tlumley at uw.edu (Thomas Lumley)
Date: Sat, 21 May 2011 10:21:29 +1200
Subject: [R-sig-Geo] WGS 84 coordinates and the use of Euclidean
 calculations for short distances--is it ever okay?
In-Reply-To: <BANLkTinYUuFKZN08jEsWh7x4P94aFSL=Aw@mail.gmail.com>
References: <BANLkTinYUuFKZN08jEsWh7x4P94aFSL=Aw@mail.gmail.com>
Message-ID: <BANLkTi=yFbYe1XAH1PX7uX+05A1Nvp2CGw@mail.gmail.com>

On Sat, May 21, 2011 at 10:07 AM, Megan Marcotte <megotte at gmail.com> wrote:
> Hello All
>
>
> I am new to the list and am hoping to get some advice. ?I am working with
> statisticians who are doing the programming of a new analysis in R where we
> are comparing animal tracks with environmental parameters. I was wondering
> if anyone knows or has an opinion on the following:
>
> 1) ? ? ?a) A rule of thumb or even a hard rule for when you need to start
> using great circle instead of Euclidian calculations for distances? Just a
> bit more information for perspective: depending on the animals tracked the
> distances between fixes could be as small as 20 m or up to 1.5 km. The
> tracks may be up to 20 km of cumulative length.

When you say "Euclidian" it's not clear whether you mean
a/ treating the earth as flat
b/ treating latitude and longitude as a rectangular coordinate system
c/ treating the degree grid as square.

(a) should be fine on this scale, for (b) and (c) it depends on the latitude

> 2) ? ? ?b) Are functions based on Euclidian math okay to use with WGS84
> coordinates if the total distance of the tracks are <20 km, or a max of 0.5
> degrees of latitude (but usually much less, at latitudes of 25 or or -36
> degrees). I know that with latitude the length of a degree of longitude
> changes but at this scale is it a factor? ?Any rules for this?
>

I would have said that it was perfectly ok to treat the earth as flat
and the degree grid as rectangular on this sort of scale and at these
latitudes, but that you can't treat the degree grid as square. That
is, a degree of longitude is about 10% less than a degree of latitude
at 25 degrees and about 20% less at 36 degrees.

   -thomas

-- 
Thomas Lumley
Professor of Biostatistics
University of Auckland


From clint at ecy.wa.gov  Sat May 21 00:39:18 2011
From: clint at ecy.wa.gov (Clint Bowman)
Date: Fri, 20 May 2011 15:39:18 -0700 (PDT)
Subject: [R-sig-Geo] WGS 84 coordinates and the use of Euclidean
 calculations for short distances--is it ever okay?
In-Reply-To: <BANLkTi=yFbYe1XAH1PX7uX+05A1Nvp2CGw@mail.gmail.com>
References: <BANLkTinYUuFKZN08jEsWh7x4P94aFSL=Aw@mail.gmail.com>
	<BANLkTi=yFbYe1XAH1PX7uX+05A1Nvp2CGw@mail.gmail.com>
Message-ID: <alpine.LRH.2.02.1105201537430.6469@aeolus.ecy.wa.gov>

I think I would convert your coordinates to a rectangular one 
(e.g., UTM or a Lambert Conformal) and compute distance 
relationships there.

Clint

-- 
Clint Bowman			INTERNET:	clint at ecy.wa.gov
Air Quality Modeler		INTERNET:	clint at math.utah.edu
Department of Ecology		VOICE:		(360) 407-6815
PO Box 47600			FAX:		(360) 407-7534
Olympia, WA 98504-7600


         USPS:           PO Box 47600, Olympia, WA 98504-7600
         Parcels:        300 Desmond Drive, Lacey, WA 98503-1274


On Sat, 21 May 2011, Thomas Lumley wrote:

> On Sat, May 21, 2011 at 10:07 AM, Megan Marcotte <megotte at gmail.com> wrote:
>> Hello All
>>
>>
>> I am new to the list and am hoping to get some advice. ?I am working with
>> statisticians who are doing the programming of a new analysis in R where we
>> are comparing animal tracks with environmental parameters. I was wondering
>> if anyone knows or has an opinion on the following:
>>
>> 1) ? ? ?a) A rule of thumb or even a hard rule for when you need to start
>> using great circle instead of Euclidian calculations for distances? Just a
>> bit more information for perspective: depending on the animals tracked the
>> distances between fixes could be as small as 20 m or up to 1.5 km. The
>> tracks may be up to 20 km of cumulative length.
>
> When you say "Euclidian" it's not clear whether you mean
> a/ treating the earth as flat
> b/ treating latitude and longitude as a rectangular coordinate system
> c/ treating the degree grid as square.
>
> (a) should be fine on this scale, for (b) and (c) it depends on the latitude
>
>> 2) ? ? ?b) Are functions based on Euclidian math okay to use with WGS84
>> coordinates if the total distance of the tracks are <20 km, or a max of 0.5
>> degrees of latitude (but usually much less, at latitudes of 25 or or -36
>> degrees). I know that with latitude the length of a degree of longitude
>> changes but at this scale is it a factor? ?Any rules for this?
>>
>
> I would have said that it was perfectly ok to treat the earth as flat
> and the degree grid as rectangular on this sort of scale and at these
> latitudes, but that you can't treat the degree grid as square. That
> is, a degree of longitude is about 10% less than a degree of latitude
> at 25 degrees and about 20% less at 36 degrees.
>
>   -thomas
>
>

From r.turner at auckland.ac.nz  Sat May 21 02:51:38 2011
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Sat, 21 May 2011 12:51:38 +1200
Subject: [R-sig-Geo] test of CSR in 3D
In-Reply-To: <BANLkTikKSbtWgjDqjh0jmkM3+X_OEjC-fw@mail.gmail.com>
References: <BANLkTikKSbtWgjDqjh0jmkM3+X_OEjC-fw@mail.gmail.com>
Message-ID: <4DD70C9A.5050600@auckland.ac.nz>

On 21/05/11 10:11, Hamid Ghorbani wrote:
> Dear list,
> let L be the L function for a point pattern in 3D.
> using spatstat I need a plot of \hat{L(r)} - r vs. r along with the
> corresponding envelopes for a simulated pattern.
>
> The K function have to be estimated for  r's  in [0,rmax] with "nrval"
> equal to let say 1001 (nraval is the number of values of r for which
> K3(r) will be estimated).
>
> I use the following codes. using the ccommand env$r shows the rmax and
> nrval and  has not taken in to account. Furthermore the y axis is
> \hat{L(r)} not \hat{L(r)} - r.
>
> Any correction please. many thanks in advance.
>
> Hamid Gh.
> =============
> lambda<-470
> r0<-73
> X<-runifpoint3(lambda, domain = box3(c(150,350),c(150,350),c(300,400)))
>
> env = envelope.pp3(X, fun = K3est,r=seq(0,r0, 1001), nsim = 99,
> correction = "iso",transform=expression((3*./(4*pi))^(1/3)))
> plot(env)
> env$r

The function K3est() does not have an "r" argument.  Note that
the argument "r" to envelope gets passed, as part of the "..."
arguments.

Try

xxx <- K3est(X,rmax=73,nrval=1001)

and look at xxx$r; this might be what you want.

     cheers,

         Rolf Turner


From mdsumner at gmail.com  Sat May 21 05:09:13 2011
From: mdsumner at gmail.com (Michael Sumner)
Date: Sat, 21 May 2011 13:09:13 +1000
Subject: [R-sig-Geo] WGS 84 coordinates and the use of Euclidean
 calculations for short distances--is it ever okay?
In-Reply-To: <alpine.LRH.2.02.1105201537430.6469@aeolus.ecy.wa.gov>
References: <BANLkTinYUuFKZN08jEsWh7x4P94aFSL=Aw@mail.gmail.com>
	<BANLkTi=yFbYe1XAH1PX7uX+05A1Nvp2CGw@mail.gmail.com>
	<alpine.LRH.2.02.1105201537430.6469@aeolus.ecy.wa.gov>
Message-ID: <BANLkTimZRzsC=8C+E+JQhYpKSoJiPF1=6g@mail.gmail.com>

Choosing a projection has its own new set of complications that are
even trickier. If you want to keep it simple and work in Lon lat see
?spDistsN1 in the sp package to calculate distance on the WGS4
ellipsoid.

Mike

On Saturday, May 21, 2011, Clint Bowman <clint at ecy.wa.gov> wrote:
> I think I would convert your coordinates to a rectangular one (e.g., UTM or a Lambert Conformal) and compute distance relationships there.
>
> Clint
>
> --
> Clint Bowman ? ? ? ? ? ? ? ? ? ?INTERNET: ? ? ? clint at ecy.wa.gov
> Air Quality Modeler ? ? ? ? ? ? INTERNET: ? ? ? clint at math.utah.edu
> Department of Ecology ? ? ? ? ? VOICE: ? ? ? ? ?(360) 407-6815
> PO Box 47600 ? ? ? ? ? ? ? ? ? ?FAX: ? ? ? ? ? ?(360) 407-7534
> Olympia, WA 98504-7600
>
>
>  ? ? ? ?USPS: ? ? ? ? ? PO Box 47600, Olympia, WA 98504-7600
>  ? ? ? ?Parcels: ? ? ? ?300 Desmond Drive, Lacey, WA 98503-1274
>
>
> On Sat, 21 May 2011, Thomas Lumley wrote:
>
>
> On Sat, May 21, 2011 at 10:07 AM, Megan Marcotte <megotte at gmail.com> wrote:
>
> Hello All
>
>
> I am new to the list and am hoping to get some advice. ?I am working with
> statisticians who are doing the programming of a new analysis in R where we
> are comparing animal tracks with environmental parameters. I was wondering
> if anyone knows or has an opinion on the following:
>
> 1) ? ? ?a) A rule of thumb or even a hard rule for when you need to start
> using great circle instead of Euclidian calculations for distances? Just a
> bit more information for perspective: depending on the animals tracked the
> distances between fixes could be as small as 20 m or up to 1.5 km. The
> tracks may be up to 20 km of cumulative length.
>
>
> When you say "Euclidian" it's not clear whether you mean
> a/ treating the earth as flat
> b/ treating latitude and longitude as a rectangular coordinate system
> c/ treating the degree grid as square.
>
> (a) should be fine on this scale, for (b) and (c) it depends on the latitude
>
>
> 2) ? ? ?b) Are functions based on Euclidian math okay to use with WGS84
> coordinates if the total distance of the tracks are <20 km, or a max of 0.5
> degrees of latitude (but usually much less, at latitudes of 25 or or -36
> degrees). I know that with latitude the length of a degree of longitude
> changes but at this scale is it a factor? ?Any rules for this?
>
>
>
> I would have said that it was perfectly ok to treat the earth as flat
> and the degree grid as rectangular on this sort of scale and at these
> latitudes, but that you can't treat the degree grid as square. That
> is, a degree of longitude is about 10% less than a degree of latitude
> at 25 degrees and about 20% less at 36 degrees.
>
>  ?-thomas
>
>
>

-- 
Michael Sumner
Institute for Marine and Antarctic Studies, University of Tasmania
Hobart, Australia
e-mail: mdsumner at gmail.com


From juantomas.sayago at gmail.com  Sat May 21 17:39:24 2011
From: juantomas.sayago at gmail.com (Juan Tomas Sayago)
Date: Sat, 21 May 2011 10:39:24 -0500
Subject: [R-sig-Geo] lines maps
Message-ID: <BANLkTik2bDo=GW7+T=BCp0W4+7_wutAuAw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110521/4e066c9e/attachment.pl>

From megotte at gmail.com  Sun May 22 19:03:02 2011
From: megotte at gmail.com (Megan Marcotte)
Date: Sun, 22 May 2011 11:03:02 -0600
Subject: [R-sig-Geo] WGS 84 coordinates and the use of Euclidean
 calculations for short distances--is it ever okay?
In-Reply-To: <BANLkTimZRzsC=8C+E+JQhYpKSoJiPF1=6g@mail.gmail.com>
References: <BANLkTinYUuFKZN08jEsWh7x4P94aFSL=Aw@mail.gmail.com>
	<BANLkTi=yFbYe1XAH1PX7uX+05A1Nvp2CGw@mail.gmail.com>
	<alpine.LRH.2.02.1105201537430.6469@aeolus.ecy.wa.gov>
	<BANLkTimZRzsC=8C+E+JQhYpKSoJiPF1=6g@mail.gmail.com>
Message-ID: <BANLkTikJH1UJaJrGvvhJfYvMpVTxbFonfA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110522/e2e5ed80/attachment.pl>

From pbruyer at agaetis.fr  Mon May 23 12:03:59 2011
From: pbruyer at agaetis.fr (Pierre Bruyer)
Date: Mon, 23 May 2011 12:03:59 +0200
Subject: [R-sig-Geo] Get contour of a map
Message-ID: <DFC20407-2BC2-4FDE-99DA-B203071B6B20@agaetis.fr>

Hello everybody,

I search a function which returns the contour of map with levels like contourLines, but I would like this function return the border of the map too, because the function contourLines cannot consider the corner of the map and it is not adapted to fill polygon after that.

Thanks in advance

Pierre Bruyer

From fpeter17 at gmail.com  Mon May 23 12:29:03 2011
From: fpeter17 at gmail.com (Peter Fehervari)
Date: Mon, 23 May 2011 12:29:03 +0200
Subject: [R-sig-Geo] intersecting ltraj
Message-ID: <4DDA36EF.5050309@gmail.com>

Hi All!

I'm trying to find the intersection of a trajectory of class ltraj with 
pre-defined latitude or longitude coordinates. However, I can't figure 
out the solution. Any ideas, comments would be greatly appreciated.

Cheers,

Peter Feh?rv?ri


From b.rowlingson at lancaster.ac.uk  Mon May 23 13:27:42 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Mon, 23 May 2011 12:27:42 +0100
Subject: [R-sig-Geo] Get contour of a map
In-Reply-To: <DFC20407-2BC2-4FDE-99DA-B203071B6B20@agaetis.fr>
References: <DFC20407-2BC2-4FDE-99DA-B203071B6B20@agaetis.fr>
Message-ID: <BANLkTikZ8XxbiHZ2p3Szr7=mkHH=MAtmhQ@mail.gmail.com>

On Mon, May 23, 2011 at 11:03 AM, Pierre Bruyer <pbruyer at agaetis.fr> wrote:
> Hello everybody,
>
> I search a function which returns the contour of map with levels like contourLines, but I would like this function return the border of the map too, because the function contourLines cannot consider the corner of the map and it is not adapted to fill polygon after that.

 If you just need this information to draw a coloured map with, say,
green between 0 and 100, yellow between 100 and 200, and red between
200 and 300, then just start with your gridded data and use 'image'.
You may need to transform from values to colours, but that's easy.

 If you really want connected polygons (and I can't think why...) ,
then perhaps using rgeos and overlaying the lines with a square
bounding box will work...

Barry


From tom.gottfried at wzw.tum.de  Mon May 23 15:13:15 2011
From: tom.gottfried at wzw.tum.de (Tom Gottfried)
Date: Mon, 23 May 2011 15:13:15 +0200
Subject: [R-sig-Geo] plot order in spplot with sp.layout
Message-ID: <4DDA5D6B.6060602@wzw.tum.de>

Dear list,

when doing the following, the grid is plotted on top of the sp.layout-item:

data(meuse.grid)
coordinates(meuse.grid) <- ~x+y
gridded(meuse.grid) <- TRUE
data(meuse.riv)
meuse.riv <- SpatialPolygons(list(Polygons(list(Polygon(meuse.riv)), 1)))
spplot(meuse.grid, sp.layout=list("sp.polygons", meuse.riv))

?spplot says:
"for grids and polygons sp.layout is drawn afterwards (so the item will not be overdrawn by the grid 
and/or polygon)."

Do I misunderstand the documentation or is this a bug?

Thanks!
Tom
-- 
Technische Universit?t M?nchen
Department f?r Pflanzenwissenschaften
Lehrstuhl f?r Gr?nlandlehre
Alte Akademie 12
85350 Freising / Germany
Phone: ++49 (0)8161 715324
Fax:   ++49 (0)8161 713243
email: tom.gottfried at wzw.tum.de
http://www.wzw.tum.de/gruenland


From edzer.pebesma at uni-muenster.de  Mon May 23 15:25:49 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 23 May 2011 15:25:49 +0200
Subject: [R-sig-Geo] plot order in spplot with sp.layout
In-Reply-To: <4DDA5D6B.6060602@wzw.tum.de>
References: <4DDA5D6B.6060602@wzw.tum.de>
Message-ID: <4DDA605D.8050307@uni-muenster.de>



On 05/23/2011 03:13 PM, Tom Gottfried wrote:
> Dear list,
> 
> when doing the following, the grid is plotted on top of the sp.layout-item:
> 
> data(meuse.grid)
> coordinates(meuse.grid) <- ~x+y
> gridded(meuse.grid) <- TRUE
> data(meuse.riv)
> meuse.riv <- SpatialPolygons(list(Polygons(list(Polygon(meuse.riv)), 1)))
> spplot(meuse.grid, sp.layout=list("sp.polygons", meuse.riv))
> 
> ?spplot says:
> "for grids and polygons sp.layout is drawn afterwards (so the item will
> not be overdrawn by the grid and/or polygon)."
> 
> Do I misunderstand the documentation or is this a bug?

Please try:

spplot(meuse.grid, sp.layout=list("sp.polygons", meuse.riv,
  first = FALSE))

I added this now to the spplot documentation.

> 
> Thanks!
> Tom

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From tom.gottfried at wzw.tum.de  Mon May 23 17:32:16 2011
From: tom.gottfried at wzw.tum.de (Tom Gottfried)
Date: Mon, 23 May 2011 17:32:16 +0200
Subject: [R-sig-Geo] plot order in spplot with sp.layout
In-Reply-To: <4DDA605D.8050307@uni-muenster.de>
References: <4DDA5D6B.6060602@wzw.tum.de> <4DDA605D.8050307@uni-muenster.de>
Message-ID: <4DDA7E00.8090800@wzw.tum.de>

Thanks! This works perfect!
Tom

Am 23.05.2011 15:25, schrieb Edzer Pebesma:
>
>
> On 05/23/2011 03:13 PM, Tom Gottfried wrote:
>> Dear list,
>>
>> when doing the following, the grid is plotted on top of the sp.layout-item:
>>
>> data(meuse.grid)
>> coordinates(meuse.grid)<- ~x+y
>> gridded(meuse.grid)<- TRUE
>> data(meuse.riv)
>> meuse.riv<- SpatialPolygons(list(Polygons(list(Polygon(meuse.riv)), 1)))
>> spplot(meuse.grid, sp.layout=list("sp.polygons", meuse.riv))
>>
>> ?spplot says:
>> "for grids and polygons sp.layout is drawn afterwards (so the item will
>> not be overdrawn by the grid and/or polygon)."
>>
>> Do I misunderstand the documentation or is this a bug?
>
> Please try:
>
> spplot(meuse.grid, sp.layout=list("sp.polygons", meuse.riv,
>    first = FALSE))
>
> I added this now to the spplot documentation.
>
>>
>> Thanks!
>> Tom
>

-- 
Technische Universit?t M?nchen
Department f?r Pflanzenwissenschaften
Lehrstuhl f?r Gr?nlandlehre
Alte Akademie 12
85350 Freising / Germany
Phone: ++49 (0)8161 715324
Fax:   ++49 (0)8161 713243
email: tom.gottfried at wzw.tum.de
http://www.wzw.tum.de/gruenland


From mathieu.rajerison at gmail.com  Mon May 23 18:10:48 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Mon, 23 May 2011 18:10:48 +0200
Subject: [R-sig-Geo] spatstat - voronoi - dirichlet with different windows
Message-ID: <BANLkTinza05M0C9nj6mkSZmE-Ezxk_PReQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110523/e71d048f/attachment.pl>

From afischbach at usgs.gov  Mon May 23 18:24:18 2011
From: afischbach at usgs.gov (afischbach)
Date: Mon, 23 May 2011 09:24:18 -0700 (PDT)
Subject: [R-sig-Geo] Constraining z axis for 2-study period plot of smoothed
	surface
Message-ID: <1306167858228-6395143.post@n2.nabble.com>

Many geographical studies sample across a landscape, create a smoothed
surface from the sampling stations, then repeat the sampling and smoothing
across study periods.

I wish to produce paired plots of two-study periods with sampling station
values plotted over their smoothed surfaces.  In the plot I wish to impose
the same z-axis limits for the paired plots.

I have tried to do this using the image function in the graphics package,
but am running into problems of using the zlim and breaks options with a
spatialPixelDataframe.
(please see attached draft plot and code snippet with error messages below).

Please advise if you have handled this problem before and if you have any
suggestions.

Kind Regards,

Tony Fischbach

code snippet & error messages:
I have tried this using the zlim parameter: 
> image(SpatialDataObj, col=tim.colors(n=64),?zlim=zr) #zr is a vector of
> min and max values 
Warning message: In plot.window(xlim = xlim, ylim = ylim, asp = asp, ...) :
"zlim" is not a graphical parameter
http://r-sig-geo.2731867.n2.nabble.com/file/n6395143/BivalvesNuculanidae.png 

I then approached it using the breaks parameter:
>zmax <- zr[2] #Takes maximum value from the zr vector 
>b<- (0:64)*zmax/64 #specify the breakpoints for the image plot
> image(SpatialDataObj, col=tim.colors(n=64),?breaks=b) 
Warning message: In plot.window(xlim = xlim, ylim = ylim, asp = asp, ...) :
?"breaks" is not a graphical parameter?


-----
Tony Fischbach, Wildlife Biologist
Walrus Research Program
Alaska Science Center
U.S. Geological Survey
4210 University Drive
Anchorage, AK 99508-4650

AFischbach at usgs.gov
http://alaska.usgs.gov/science/biology/walrus
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Constraining-z-axis-for-2-study-period-plot-of-smoothed-surface-tp6395143p6395143.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From edzer.pebesma at uni-muenster.de  Mon May 23 19:46:08 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 23 May 2011 19:46:08 +0200
Subject: [R-sig-Geo] Constraining z axis for 2-study period plot of
 smoothed surface
In-Reply-To: <1306167858228-6395143.post@n2.nabble.com>
References: <1306167858228-6395143.post@n2.nabble.com>
Message-ID: <4DDA9D60.9090709@uni-muenster.de>

Tony, please try:

image(SpatialDataObj, col=tim.colors(n=64), zlim=zr,
   useRasterImage=FALSE)

you can ignore the warning message.

On 05/23/2011 06:24 PM, afischbach wrote:
> Many geographical studies sample across a landscape, create a smoothed
> surface from the sampling stations, then repeat the sampling and smoothing
> across study periods.
> 
> I wish to produce paired plots of two-study periods with sampling station
> values plotted over their smoothed surfaces.  In the plot I wish to impose
> the same z-axis limits for the paired plots.
> 
> I have tried to do this using the image function in the graphics package,
> but am running into problems of using the zlim and breaks options with a
> spatialPixelDataframe.
> (please see attached draft plot and code snippet with error messages below).
> 
> Please advise if you have handled this problem before and if you have any
> suggestions.
> 
> Kind Regards,
> 
> Tony Fischbach
> 
> code snippet & error messages:
> I have tried this using the zlim parameter: 
>> image(SpatialDataObj, col=tim.colors(n=64), zlim=zr) #zr is a vector of
>> min and max values 
> Warning message: In plot.window(xlim = xlim, ylim = ylim, asp = asp, ...) :
> "zlim" is not a graphical parameter
> http://r-sig-geo.2731867.n2.nabble.com/file/n6395143/BivalvesNuculanidae.png 
> 
> I then approached it using the breaks parameter:
>> zmax <- zr[2] #Takes maximum value from the zr vector 
>> b<- (0:64)*zmax/64 #specify the breakpoints for the image plot
>> image(SpatialDataObj, col=tim.colors(n=64), breaks=b) 
> Warning message: In plot.window(xlim = xlim, ylim = ylim, asp = asp, ...) :
>  "breaks" is not a graphical parameter 
> 
> 
> -----
> Tony Fischbach, Wildlife Biologist
> Walrus Research Program
> Alaska Science Center
> U.S. Geological Survey
> 4210 University Drive
> Anchorage, AK 99508-4650
> 
> AFischbach at usgs.gov
> http://alaska.usgs.gov/science/biology/walrus
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Constraining-z-axis-for-2-study-period-plot-of-smoothed-surface-tp6395143p6395143.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From r.turner at auckland.ac.nz  Mon May 23 22:32:05 2011
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Tue, 24 May 2011 08:32:05 +1200
Subject: [R-sig-Geo] spatstat - voronoi - dirichlet with different
	windows
In-Reply-To: <BANLkTinza05M0C9nj6mkSZmE-Ezxk_PReQ@mail.gmail.com>
References: <BANLkTinza05M0C9nj6mkSZmE-Ezxk_PReQ@mail.gmail.com>
Message-ID: <4DDAC445.10905@auckland.ac.nz>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110524/dcb5d46b/attachment.pl>

From elaine.kuo.tw at gmail.com  Tue May 24 04:35:30 2011
From: elaine.kuo.tw at gmail.com (elaine kuo)
Date: Tue, 24 May 2011 10:35:30 +0800
Subject: [R-sig-Geo] package for unmarked point pattern analysis
Message-ID: <BANLkTinXe5qmcHhUPyKEur9nwAMzinfqJw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110524/99005e00/attachment.pl>

From r.turner at auckland.ac.nz  Tue May 24 04:58:59 2011
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Tue, 24 May 2011 14:58:59 +1200
Subject: [R-sig-Geo] package for unmarked point pattern analysis
In-Reply-To: <BANLkTinXe5qmcHhUPyKEur9nwAMzinfqJw@mail.gmail.com>
References: <BANLkTinXe5qmcHhUPyKEur9nwAMzinfqJw@mail.gmail.com>
Message-ID: <4DDB1EF3.8050602@auckland.ac.nz>

On 24/05/11 14:35, elaine kuo wrote:
> Dear List,
>
> I have a shape file consistig of 600 points as the centroids of bird
> distributions in Asia.
> Now I want to learn if specific parts of the points are randomized, clumped,
> or dispersed.
>
> I tried average nearest neighbor tool of ArcGIS.
> One portin of the points are randomized but with p-value higher than 0.05.
> I would like to ask if any other methods in R can provide alternative
> interpretation of the point analysis.

You just ***might*** want to consider using "spatstat" !!!   :-)

See "Point pattern analysis" under the "Spatial" Task View on CRAN
for some other possibilities, including "splancs" and "spatial".

     cheers,

             Rolf Turner


From p.hiemstra at geo.uu.nl  Tue May 24 09:35:58 2011
From: p.hiemstra at geo.uu.nl (Paul Hiemstra)
Date: Tue, 24 May 2011 09:35:58 +0200
Subject: [R-sig-Geo] plot order in spplot with sp.layout
In-Reply-To: <4DDA605D.8050307@uni-muenster.de>
References: <4DDA5D6B.6060602@wzw.tum.de> <4DDA605D.8050307@uni-muenster.de>
Message-ID: <4DDB5FDE.1030408@geo.uu.nl>

Hi,

An alternative approach is to use a custom panel function, which is even 
more flexible that the solution Edzer suggested. To add polygons and 
points to a grid map using a custom panel function:

spplot(grid_object, "layer_to_plot",
     panel = function(...) {
         panel.gridplot(...)
         sp.polygons(polygon_object)
         sp.points(point_object)
     })

see also the R wiki article on spatial data visualization [1].

cheers,
Paul

[1] 
http://rwiki.sciviews.org/doku.php?id=tips:spatial-data:spatial_data_visualization


On 05/23/2011 03:25 PM, Edzer Pebesma wrote:
>
> On 05/23/2011 03:13 PM, Tom Gottfried wrote:
>    
>> Dear list,
>>
>> when doing the following, the grid is plotted on top of the sp.layout-item:
>>
>> data(meuse.grid)
>> coordinates(meuse.grid)<- ~x+y
>> gridded(meuse.grid)<- TRUE
>> data(meuse.riv)
>> meuse.riv<- SpatialPolygons(list(Polygons(list(Polygon(meuse.riv)), 1)))
>> spplot(meuse.grid, sp.layout=list("sp.polygons", meuse.riv))
>>
>> ?spplot says:
>> "for grids and polygons sp.layout is drawn afterwards (so the item will
>> not be overdrawn by the grid and/or polygon)."
>>
>> Do I misunderstand the documentation or is this a bug?
>>      
> Please try:
>
> spplot(meuse.grid, sp.layout=list("sp.polygons", meuse.riv,
>    first = FALSE))
>
> I added this now to the spplot documentation.
>
>    
>> Thanks!
>> Tom
>>      
>    


-- 
Paul Hiemstra, Ph.D.
Department of Physical Geography
Faculty of Geosciences
University of Utrecht
Heidelberglaan 2
P.O. Box 80.115
3508 TC Utrecht
Phone:  +3130 253 5773
http://intamap.geo.uu.nl/~paul
http://nl.linkedin.com/pub/paul-hiemstra/20/30b/770

currently @ KNMI
paul.hiemstra_AT_knmi.nl


From luca.morandini1 at gmail.com  Tue May 24 10:17:04 2011
From: luca.morandini1 at gmail.com (Luca Morandini)
Date: Tue, 24 May 2011 10:17:04 +0200
Subject: [R-sig-Geo] Performance of raster package
Message-ID: <4DDB6980.3050405@gmail.com>

Folks,

I have played a bit with the R "raster" package, and found it has an impressive 
list of features; however, its performance seems to be less than optimal when 
confronted with sizeable rasters (say, a 250MB GeoTIFF): a focal statistics that 
took less than a minute in GRASS, took 7 hours or so in R.

Is there anything I could do to speed it up (I already tried readAll before 
invoking the focal statistic function) ?

Regards,

Luca Morandini
http://www.lucamorandini.it


From oscar.perpinan at upm.es  Tue May 24 11:42:32 2011
From: oscar.perpinan at upm.es (Oscar =?UTF-8?B?UGVycGnDsWFu?= Lamigueiro)
Date: Tue, 24 May 2011 11:42:32 +0200
Subject: [R-sig-Geo] plot order in spplot with sp.layout
In-Reply-To: <4DDB5FDE.1030408@geo.uu.nl>
References: <4DDA5D6B.6060602@wzw.tum.de> <4DDA605D.8050307@uni-muenster.de>
	<4DDB5FDE.1030408@geo.uu.nl>
Message-ID: <20110524114232.18a8be5b@OPL-EUITI>

Hello,

I find useful the layer and layer_ mechanism of latticeExtra:

p <- spplot(meuse.grid)

p + layer(sp.polygons(meuse.riv))

p + layer_(sp.polygons(meuse.riv))

Cheers,

Oscar.

-------------------
Oscar Perpi??n Lamigueiro
Dpto. Ingenier?a El?ctrica
EUITI-UPM

http://procomun.wordpress.com

-----------------------------------------
>Hi,
>
>An alternative approach is to use a custom panel function, which is
>even more flexible that the solution Edzer suggested. To add polygons
>and points to a grid map using a custom panel function:
>
>spplot(grid_object, "layer_to_plot",
>     panel = function(...) {
>         panel.gridplot(...)
>         sp.polygons(polygon_object)
>         sp.points(point_object)
>     })
>
>see also the R wiki article on spatial data visualization [1].
>
>cheers,
>Paul
>
>[1] 
>http://rwiki.sciviews.org/doku.php?id=tips:spatial-data:spatial_data_visualization
>
>


From leroy.boris at gmail.com  Tue May 24 14:09:39 2011
From: leroy.boris at gmail.com (Boris Leroy)
Date: Tue, 24 May 2011 14:09:39 +0200
Subject: [R-sig-Geo] Error with recent versions of raster: no slot named
 "rotated" for this object of class "RasterStack"
Message-ID: <BANLkTik4UdX3QoHyQQb3sOfESDg4CVah9g@mail.gmail.com>

Dear list,

I updated today my raster package and I am getting error messages with
functions that were previously working.

For example, in order to select layers in stacks, I was previously
using double brackets, but it doesn't work anymore:

> testStack
class       : RasterStack
dimensions  : 3600, 9480, 4  (nrow, ncol, nlayers)
resolution  : 0.008333333, 0.008333333  (x, y)
extent      : -14, 65, 30, 60  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0
min values  : 0 0 0 0
max values  : 1 1 1 1

> testStack[[1]]
Erreur dans .local(x, ...) :
  aucun slot de nom "rotated" pour cet objet de la classe "RasterLayer"

Which roughly translates into "no slot named "rotated" for this object
of class "RasterStack""

I can still use the subset function:

> subset(testStack, 1)
class       : RasterLayer
dimensions  : 3600, 9480, 34128000  (nrow, ncol, ncell)
resolution  : 0.008333333, 0.008333333  (x, y)
extent      : -14, 65, 30, 60  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0
values      : in memory
min value   : 0
max value   : 1

However, I have the same error with writeRaster and I was not able to
find a workaround:

> writeRaster(testStack, "./tempStack.grd", overwrite=T)
Erreur dans .local(x, ...) :
  aucun slot de nom "rotated" pour cet objet de la classe "RasterStack"


I suppose this error relates to recent updates for rotated rasters.
Am I doing something wrong or is there an unexpected bug somewhere?

Thanks,

Boris

----
> sessionInfo()
R version 2.13.0 (2011-04-13)
Platform: x86_64-pc-mingw32/x64 (64-bit)

locale:
[1] LC_COLLATE=French_France.1252  LC_CTYPE=French_France.1252
LC_MONETARY=French_France.1252
[4] LC_NUMERIC=C                   LC_TIME=French_France.1252

attached base packages:
[1] grid      splines   stats     graphics  grDevices utils
datasets  methods   base

other attached packages:
 [1] ggplot2_0.8.9      proto_0.3-9.2      reshape_0.8.4
plyr_1.5.2         rgdal_0.6-33       raster_1.8-22
 [7] sp_0.9-81          BIOMOD_1.1-6.9     foreign_0.8-43
gam_1.04.1         randomForest_4.6-2 mda_0.4-2
[13] class_7.3-3        gbm_1.6-3.1        lattice_0.19-23
MASS_7.3-12        Design_2.3-0       Hmisc_3.8-3
[19] survival_2.36-5    rpart_3.1-49       nnet_7.3-1         ade4_1.4-17

loaded via a namespace (and not attached):
[1] cluster_1.13.3 digest_0.4.2   tools_2.13.0

-- 
Boris Leroy,
PhD Student,
Equipe Biodiversit? et Gestion des Territoires,
Mus?um National d'Histoire Naturelle, UMR 7204
Universit? de Rennes 1
Campus de Beaulieu, B?t. 25, 1er ?tage
35042 Rennes cedex

+33 (0) 2 23 23 58 99


From jon.skoien at jrc.ec.europa.eu  Tue May 24 14:54:40 2011
From: jon.skoien at jrc.ec.europa.eu (Jon Olav Skoien)
Date: Tue, 24 May 2011 14:54:40 +0200
Subject: [R-sig-Geo] Find nearest downstream value of a river network
In-Reply-To: <4DD53489.4090408@uni-muenster.de>
References: <4DA557D4.7060008@jrc.ec.europa.eu>
	<4DD53489.4090408@uni-muenster.de>
Message-ID: <4DDBAA90.7020808@jrc.ec.europa.eu>

Hi Edzer,

Thanks for the suggestion! It is a much simpler way of doing it, but 
unfortunately gDistance seems rather slow for larger data sets. For a 
data set with 1200 segments (the full data set has around 8000), it took 
around 4 minutes on my computer, which is considerably more than the 
method I already had. But gDistance might be what I need for something 
else...

Cheers,
Jon

On 19-May-11 17:17, Edzer Pebesma wrote:
> Hi Jon (thanks for reminding off-list!), I haven't looked into finding
> the line with an ID, but in general finding the nearest SpatialLines
> index (which of course might be ambiguous) might be done by:
>
> library(rgeos)
> d = gDistance(nres, nres, byid=TRUE)
> diag(d)=1e9
> apply(d,2,function(x)which(x==min(x))[1])
>
> Does that get you any further? Or are there more clever solutions?
> --
> Edzer
>
> On 04/13/2011 09:59 AM, Jon Olav Skoien wrote:
>> Hi,
>>
>> I have a SpatialLinesDataFrame with predictions on different locations
>> of a river network that I would like to plot. However, I have many more
>> line segments in the network than I have predictions, so most of the
>> data.frame has NA-values. Does anyone know a simple way of finding the
>> nearest downstream value for a line segment with an NA-value, so that I
>> can get a continuous river network with predictions?
>>
>> Below is a simple example of what I want to do, based on a shapefile
>> ("nres") that can be downloaded from:
>> http://intamap.geo.uu.nl/~jon/sarp/tempaacf/
>>
>> nres = readOGR(".","nres")
>> nin = nres
>> nin$pred[!(nin$OBJECTID %in% c(1015, 1020, 1366, 1369, 4981))] = NA
>>
>> "nres" is the SpatialLinesDataFrame that I would like to have as result
>> after associating all NA-values to the nearest downstream value. "nin"
>> is a simplified version of the SpatialLinesDataFrame that I have after
>> predicting, and that I would like to use for creating "nres".  "pred" is
>> the prediction column in these SLDFs. The following plot shows the
>> results (with colors) and thick black lines for the segments where I
>> have predictions.
>>
>> spplot(nres, "pred", col.regions = bpy.colors(),
>>     panel = function(x,y, ...) {
>>      panel.polygonsplot(x,y, ...)
>>      sp.lines(nin[!is.na(nin$pred),], col = "black", lwd = 2)
>>     })
>>
>> So far I have got the result in this plot from an iterative procedure
>> using the FROMJCT and TOJCT (from and to junction) IDs of the data.frame:
>>
>> ichange = 1
>> while (ichange>  0) {
>>    ichange = 0
>>    for (i in 1:dim(nin)[1]) {
>>      if (!is.na(nin$pred[i])) {
>>        tt = which(nin$TOJCT == nin$FROMJCT[i])
>>        if (length(tt)>  0&&  is.na(nin$pred[tt])) {
>>          nin$pred[tt] = nin$pred[i]
>>          ichange = ichange + 1
>>        }
>>      }
>>    }
>> }
>>
>> But I think it should be either possible to simplify this (quite slow
>> for a large river network), or preferably take advantage of topology of
>> SpatialLines objects? Any clues?
>>
>> Thanks,
>> Jon
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From carsten.dormann at ufz.de  Tue May 24 15:06:07 2011
From: carsten.dormann at ufz.de (Carsten Dormann)
Date: Tue, 24 May 2011 15:06:07 +0200
Subject: [R-sig-Geo] polygon wraps around the world after re-projection
Message-ID: <4DDBAD3F.4040104@ufz.de>

Dear fellow R-ists,

I run into problems after re-projecting a world map because one polygon 
now wraps around the world. Is there a way to re-define (or cut in two) 
the offending polygon?


require(maptools)
require(rgdal)
data(wrld_simpl)
wrld2 <- spTransform(wrld_simpl, CRS("+proj=cea +lon_0=Central Meridian 
+lat_ts=Standard Parallel +x_0=False Easting +y_0=False Northing")) # 
change to Lamberth cylindrical equal area projection

plot(wrld2) # notice the horizontal lines in the polar North!
	
I then moved the 0-longitude towards 11.7? in order to put the breaking 
line right between Russia and Alaska.

wrld3 <- spTransform(wrld_simpl, CRS("+proj=cea +lon_0=11.7 
+lat_ts=Standard Parallel +x_0=False Easting +y_0=False

plot(wrld3)

But there still is a little Aleutian island messing up the picture.

Notice that also wrld_simpl_lessIslands in rworldmap does not solve this 
problem: there always is a wrapping polygon somewhere!

I would also happily delete it, but wouldn't know how to find the 
respective polygon within the USA (slot 209) polygons.

Any help most appreciated!

Cheers,

Carsten



-- 
Dr. Carsten F. Dormann
Department of Computational Landscape Ecology
Helmholtz Centre for Environmental Research-UFZ	
(Department Landschafts?kologie)
(Helmholtz Zentrum f?r Umweltforschung - UFZ)
Permoserstr. 15	
04318 Leipzig				
Germany

Tel: ++49(0)341 2351946
Fax: ++49(0)341 2351939
Email: carsten.dormann at ufz.de
internet: http://www.ufz.de/index.php?de=4205

Registered Office/Sitz der Gesellschaft: Leipzig
Commercial Register Number/Registergericht: Amtsgericht Leipzig, 
Handelsregister Nr. B 4703
Chairman of the Supervisory Board/Vorsitzender des Aufsichtsrats: MinR 
Wilfried Kraus
Scientific Managing Director/Wissenschaftlicher Gesch?ftsf?hrer: Prof. 
Dr. Georg Teutsch
Administrative Managing Director/Administrativer Gesch?ftsf?hrer: Dr. 
Andreas Schmidt


From jon.skoien at jrc.ec.europa.eu  Tue May 24 15:21:15 2011
From: jon.skoien at jrc.ec.europa.eu (Jon Olav Skoien)
Date: Tue, 24 May 2011 15:21:15 +0200
Subject: [R-sig-Geo] Find nearest downstream value of a river network
In-Reply-To: <BANLkTikvxOTJBExOGZudp35W+fm=t2OZeg@mail.gmail.com>
References: <4DA557D4.7060008@jrc.ec.europa.eu>
	<4DD53489.4090408@uni-muenster.de>
	<BANLkTikvxOTJBExOGZudp35W+fm=t2OZeg@mail.gmail.com>
Message-ID: <4DDBB0CB.9050103@jrc.ec.europa.eu>

On 19-May-11 18:06, Barry Rowlingson wrote:
>
>   If the FROMJCT and TOJCT numbers define nodes of a graph, and the
> presence of a row with FROMJCT=a and TOJCT=b defines an edge from a to
> b of the graph, then you could use something like R's igraph package
> to build a graph object. Once you've done that it should be easy to
> use the graph algorithms in that package to wander down the river
> system at your leisure...
It was my first look at the igraph package, and I dont think I found the 
optimal set of functions. So far I ended up with the following, although 
I am sure there are better solutions:

rndf = data.frame(FROMJCT = nres$FROMJCT, TOJCT = nres$TOJCT,
                OBJECTIT = nres$OBJECTID, pred = nres$pred)
igr = graph.data.frame(rndf)
igrs = topological.sort(igr, mode = "out")
rndf$to = match(as.character(rndf$TOJCT), V(igr)$name[igrs+1])

while (TRUE) {
   lcon = which(rndf$to == min(rndf$to[is.na(rndf$pred)]))
   if (length(lcon)==0) break()
   while(is.na(rndf$pred[lcon[1]])) lcon = c(neighbors(igr,lcon[1]-1)+1, 
lcon)
   rndf$pred[lcon] = rndf$pred[lcon[1]]
}

The best with this solution is that it is extremely fast compared to my 
first suggestion, about 20-30 times faster for 1200 segments. And it 
also seems to scale better with larger data sets. So I think I will 
either try to simplify this further, or just make a function of the 
lines above.

>   It might get complicated if you are modelling on the Orinoco where it
> bifurcates, or a river delta :)

Complicated or more interesting, depending on how you see it and how 
much time you have ;-)
For the second reason I am happy that the river system I am interested 
in behaves rather "normal"...

Thanks!
Jon


From carstennh at aol.com  Tue May 24 16:32:55 2011
From: carstennh at aol.com (Carsten Neumann)
Date: Tue, 24 May 2011 16:32:55 +0200
Subject: [R-sig-Geo] Performance of raster package
In-Reply-To: <4DDB6980.3050405@gmail.com>
References: <4DDB6980.3050405@gmail.com>
Message-ID: <4DDBC197.60300@aol.com>

  Am 24.05.2011 10:17, schrieb Luca Morandini:
> Folks,
>
> I have played a bit with the R "raster" package, and found it has an 
> impressive list of features; however, its performance seems to be less 
> than optimal when confronted with sizeable rasters (say, a 250MB 
> GeoTIFF): a focal statistics that took less than a minute in GRASS, 
> took 7 hours or so in R.
>
> Is there anything I could do to speed it up (I already tried readAll 
> before invoking the focal statistic function) ?
>
> Regards,
>
> Luca Morandini
> http://www.lucamorandini.it
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
Dear all,

I discovered such performance problems concerning computation time, too. 
Using the function rasterToPolygons() for a 30Mb, 1Byte integer GeoTiff 
took 10 times longer than using a common GIS software. Why is that the 
case? I had to change to other R implementet GIS functionallity like in 
the package RSAGA. When posible reading data into memory will also 
accelerate processing time.

Best regards

Carsten


From r.m.krug at gmail.com  Tue May 24 17:17:36 2011
From: r.m.krug at gmail.com (Rainer M Krug)
Date: Tue, 24 May 2011 17:17:36 +0200
Subject: [R-sig-Geo] Performance of raster package
In-Reply-To: <4DDBC197.60300@aol.com>
References: <4DDB6980.3050405@gmail.com>
	<4DDBC197.60300@aol.com>
Message-ID: <BANLkTiknbnS2T=odj7rH6mYmnNYo4kJeoA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110524/c2d47dad/attachment.pl>

From dylan.beaudette at gmail.com  Tue May 24 19:05:31 2011
From: dylan.beaudette at gmail.com (Dylan Beaudette)
Date: Tue, 24 May 2011 10:05:31 -0700
Subject: [R-sig-Geo] [GRASS-stats] Re:  readRAST6() in {spgrass6}
In-Reply-To: <alpine.LRH.2.00.1105191547010.29187@reclus.nhh.no>
References: <003f01cc0f48$3f7a66b0$be6f3410$@umail.ucsb.edu>
	<BANLkTi=1MTqesqeiyaoAp0kapSJc271JfA@mail.gmail.com>
	<007701cc140f$b84227b0$28c67710$@umail.ucsb.edu>
	<BANLkTi=rPeh9nrXh6ZdDbAjzHzzz=DtQgA@mail.gmail.com>
	<alpine.LRH.2.00.1105170613130.20286@reclus.nhh.no>
	<003301cc14ed$ff63b170$fe2b1450$@umail.ucsb.edu>
	<alpine.LRH.2.00.1105180724260.24493@reclus.nhh.no>
	<BANLkTi=+y8ky5WhFiOV5eiTyt00qjLUbMg@mail.gmail.com>
	<alpine.LRH.2.00.1105191547010.29187@reclus.nhh.no>
Message-ID: <BANLkTi=pqdzaWOuG_+OXctyekN2Xwpb0DA@mail.gmail.com>

Thanks for the clarification Roger. I will be more careful about
handing out advice on functions that I have never used :).

As the author of the original example that started this mess, I would
like to contribute a new example that should generalize to those cases
where readRAST6() isn't an option. These would be cases where GRASS-R
integration is difficult (windows) or in cases where very large files
are involved.

http://casoilresource.lawr.ucdavis.edu/drupal/node/993

This example will require your own data set. Feedback is always welcome.

Cheers,
Dylan

On Thu, May 19, 2011 at 7:04 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> On Thu, 19 May 2011, Rainer M Krug wrote:
>
>> Hi Roger,
>>
>> On Wed, May 18, 2011 at 7:56 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>>>
>>> I do not have your location, so cannot check. It appears that your
>>> workflow
>>> is highly non-standard - which you have not made clear previously. If you
>>> are using spgrass6 to interface R with an existing GRASS location - which
>>> seems to be the case, you should not use initGRASS(), and should not use
>>> the
>>> PERMANENT mapset. The initGRASS() function is for creating one-time,
>>> throwaway GRASS locations to use GRASS modules from R when no GISDBASE or
>>> LOCATION is required.
>>
>> Could you please give some explanation, why the initGRASS() function
>> should *not* be used when accessing an existing location? I use it
>> extensively in my simulations to create a new mapset in a already
>> existing location and I haven't experienced any problems which I would
>> link to that.
>> What kind of problems could occur, or why is this the non-standard
>> usage of initGRASS()? I always assumed, that the idea is that
>> initGRASS() actually replaces the "running R inside GRASS" approach?
>
> The function was introduced to make it possible to use GRASS modules without
> a GRASS GISDBASE/LOCATION file tree, in throwaway mode for non-expert users.
> The advice offered was also for non-expert users: unless you understand
> fully what you are doing, choose between using R within GRASS for existing
> LOCATION file trees, and initGRASS() when you are not using data from
> "inside" GRASS. This advice holds for all users who do not understand the
> possible inconvenience of trashing their .gisrc file.
>
> If, on the other hand, the user takes responsibility for over-riding the
> regular GRASS startup mechanisms, initGRASS() can be used, as you decribe,
> for scripting GRASS. Not every user, however, should consider this
> possibility if all of the consequences are not understood.
>
> The main file at risk is .gisrc, but it is fully possible that the GRASS
> mapset-specific temporary files will not be cleaned up properly, and
> environment variables set by initGRASS() may interfere with GRASS in
> unexpected ways across different OS while the R session has not been
> terminated - I've not established any harmful interactions, but that doesn't
> mean that they are not present on at least some platforms. In principle the
> compute processes should not "leak", but on some OS, odd things happen, so
> being cautious rather than principled seems justified.
>
> In the case that started this thread, the user does not seem to have had a
> clear idea of what was happening, and was copying a script found online
> intended for a different setting and an example data set. He needed to be
> pointed to a more helpful setting, that is: start GRASS (and the GRASS GUI)
> in Windows, start R in GRASS from the MSYS console, and be able to
> manipulate the current GRASS region from the GUI to tile or resample the
> data down to a size that admitted analysis.
>
>>
>> Cheers,
>>
>> Rainer
>>
>>
>>>
>>> --
>>> Roger Bivand
>>> Economic Geography Section, Department of Economics, Norwegian School of
>>> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>>> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>>> e-mail: Roger.Bivand at nhh.no
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>>
>>
>>
>
> --
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
> _______________________________________________
> grass-stats mailing list
> grass-stats at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/grass-stats
>


From r.hijmans at gmail.com  Tue May 24 19:39:58 2011
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Tue, 24 May 2011 10:39:58 -0700 (PDT)
Subject: [R-sig-Geo] Error with recent versions of raster: no slot named
 "rotated" for this object of class "RasterStack"
In-Reply-To: <BANLkTik4UdX3QoHyQQb3sOfESDg4CVah9g@mail.gmail.com>
References: <BANLkTik4UdX3QoHyQQb3sOfESDg4CVah9g@mail.gmail.com>
Message-ID: <1306258798836-6399683.post@n2.nabble.com>

Boris, 
Presumably this happens when you are use saved objects created with the
previous version. I thought I had made the changes such that this problem
would not happen... This is now fixed, I think. A new version of raster will
be going to CRAN today. Thanks for reporting. 
Robert

>I updated today my raster package and I am getting error messages with 
>functions that were previously working. 
>
>For example, in order to select layers in stacks, I was previously 
>using double brackets, but it doesn't work anymore: 
>> testStack[[1]] 
>Erreur dans .local(x, ...) : 
>  aucun slot de nom "rotated" pour cet objet de la classe "RasterLayer" 
>
>Which roughly translates into "no slot named "rotated" for this object 
>of class "RasterStack"" 

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Error-with-recent-versions-of-raster-no-slot-named-rotated-for-this-object-of-class-RasterStack-tp6398283p6399683.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From r.hijmans at gmail.com  Tue May 24 20:00:09 2011
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Tue, 24 May 2011 11:00:09 -0700 (PDT)
Subject: [R-sig-Geo] Performance of raster package
In-Reply-To: <BANLkTiknbnS2T=odj7rH6mYmnNYo4kJeoA@mail.gmail.com>
References: <4DDB6980.3050405@gmail.com> <4DDBC197.60300@aol.com>
	<BANLkTiknbnS2T=odj7rH6mYmnNYo4kJeoA@mail.gmail.com>
Message-ID: <1306260009887-6399759.post@n2.nabble.com>


Thanks for pointing this out. Some functions in 'raster' are indeed
slower/faster than others. Some seem to be reasonably quick. The focal*
functions are slow, and indeed, as Rainer alludes to, good candidates for a
C-implementation of at least the basic cases (e.g. fun=mean). Although I
recently made them a bit more efficient, so it would be good to know which
version of raster you are using. When reporting speed problems, please also
report the number of rows/columns of the object and the exact function
(focal, focalFilter, focalNA?) used. In the case of the focal functions it
could matter a lot which "fun" you used to compute the focal values; as that
might be what further slows things down. rasterToPolygons is also slow; in
part because I did not pay much attention to it. I just made it a bit
quicker (almost twice as fast), but much more could probably be done. That
is, speed is not only a function of R vs. C code, but also of the quality of
the algorithm used. The value of the 'raster' package over "GIS" software is
obviously not speed of execution, but the ease (speed) of use and the
benefit of the integration with everything else in R. 

Robert


>  Am 24.05.2011 10:17, schrieb Luca Morandini: 
> 
>  Folks, 
>> 
>> I have played a bit with the R "raster" package, and found it has an 
>> impressive list of features; however, its performance seems to be less
>> than 
>> optimal when confronted with sizeable rasters (say, a 250MB GeoTIFF): a 
>> focal statistics that took less than a minute in GRASS, took 7 hours or
>> so 
>> in R. 
>> 
>> Is there anything I could do to speed it up (I already tried readAll 
>> before invoking the focal statistic function) ? 
>> 
>> Regards, 
>> 
>> Luca Morandini 
>> http://www.lucamorandini.it
>> 
>> _______________________________________________ 
>> R-sig-Geo mailing list 
>> [hidden email] 
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
> Dear all, 
> 
> I discovered such performance problems concerning computation time, too. 
> Using the function rasterToPolygons() for a 30Mb, 1Byte integer GeoTiff
> took 
> 10 times longer than using a common GIS software. Why is that the case? I 
> had to change to other R implementet GIS functionallity like in the
> package 
> RSAGA. When posible reading data into memory will also accelerate
> processing 
> time. 
>

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Performance-of-raster-package-tp6397653p6399759.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From r.hijmans at gmail.com  Tue May 24 20:19:05 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 24 May 2011 11:19:05 -0700
Subject: [R-sig-Geo] subs (raster) on large dataset
In-Reply-To: <BANLkTinXP5AJDW9yHWp7Co_pFGizw=+YqQ@mail.gmail.com>
References: <BANLkTims5qZE1XBcyrU9Y=tYmzaBC0+UPQ@mail.gmail.com>
	<1302803032937-6273741.post@n2.nabble.com>
	<BANLkTi=kO4NnxJMXWfCRo1es76BHRztLQw@mail.gmail.com>
	<BANLkTikOEoXXALW0x1s5G+M63Dsrzjq6XA@mail.gmail.com>
	<BANLkTinXP5AJDW9yHWp7Co_pFGizw=+YqQ@mail.gmail.com>
Message-ID: <BANLkTin5ZYRynaL9aqhg33SU2ANWq+dMQw@mail.gmail.com>

> With this option, my code completed in 33 minutes (with the largest
> raster being ~1 GB). ?I also reran my code with toDisk = FALSE, and
> watched R memory usage via top. ?As you suspected, memory was
> constantly increasing, both actual and virtual. I believe I had enough
> RAM available at the time (~2 GB), so there seems to be some problem
> there, but perhaps this is an issue for R-Sig-Mac?
Hi Lyndon,

Any suggestion about how to determine the amount of RAM (true RAM,
without going to disk) on a given operating system would be very
useful. My approach is too empirical, and clearly not watertight.

I have lowered the default expectations (options), to avoid this type
of behavior. For better speed those with a lot of RAM can use
setOptions(maxmemory= ) to use larger chunks of data.


> Lastly, there is one small thing that I noticed while working on this
> issue, based on the function that follows. ?I noticed that in a case
> such as this:
>
> ? ?cat("Substituting...")
> ? ?subs(spatialmaster, CSMtable, by = LUfield, which = outfields[i],
> subsWithNA = TRUE, filename =
> ? ? ? ? ? ? ? ? ? out.nm, datatype = type, overwrite = TRUE, progress = "text")
>
> That the progress bar and cat don't play together, in that cat is not
> displayed. I am not sure why, but perhaps it is simply being
> overwritten in the console by the progress bar? ?I opted to turn off
> the progress bar in favor of the messages produced by cat in this
> case. This isn't something I am terribly concerned with, but I thought
> I would mention it in case it is of interest.


In this case you can use progress = "window"

Best, Robert
On Fri, May 20, 2011 at 10:48 AM, Lyndon Estes <lestes at princeton.edu> wrote:
> Hi Robert,
>
> My apologies for an even longer delay this time around. ?I have gotten
> back to this now and followed your suggestions. ?Responses are
> interspersed in (shortened) text of previous messages.
>
>> That is *horrible*. I am not sure what is going on here. This is my
>> rather empirical test to see if you have enough RAM for a given
>> computation (and to work with chunks if not). Although it is somewhat
>> inefficient, I have never seen anything crazy like this. I wonder if
>> you have insufficient RAM and that virtual RAM is created on-disk as
>> the object grows. I may lower the default maxmemory setting because of
>> this. You can also set it with setOptions. You can also do
>> setOptions(todisk=TRUE) ?before using this function (and set it back
>> afterwards, to force the function to use chunks (canProcessInMemory
>> will return FALSE before doing the memory consuming test).
>
> I used the setOptions function as you have suggested by embedding it
> in my function (full code pasted at the foot of this email):
>
> # Force to write to disk
> if(raster:::.toDisk() != TRUE) {
> ? setOptions(todisk = TRUE)
> ? cat("We don't want memory problems--forcing write to disk.\n")
> }
>
> With this option, my code completed in 33 minutes (with the largest
> raster being ~1 GB). ?I also reran my code with toDisk = FALSE, and
> watched R memory usage via top. ?As you suspected, memory was
> constantly increasing, both actual and virtual. I believe I had enough
> RAM available at the time (~2 GB), so there seems to be some problem
> there, but perhaps this is an issue for R-Sig-Mac?
>
>> all raster functions that start with an "." are hidden but are
>> accessible via raster:::
>> e.g.
>> raster:::.maxmemory
>
> Thanks, I guess I should have already known that...
>
>> In some functions that is true, but not in this one. Even if you
>> supply a filename, the whole thing will be done in memory if possible,
>> and the only at the end will the resulting raster data be written to
>> disk. Perhaps it would be safer if it would always work as you
>> expected.
>
> It's easy enough for me to write the toDIsk = TRUE option into
> functions, so thanks again for this tip.
>
> Lastly, there is one small thing that I noticed while working on this
> issue, based on the function that follows. ?I noticed that in a case
> such as this:
>
> ? ?cat("Substituting...")
> ? ?subs(spatialmaster, CSMtable, by = LUfield, which = outfields[i],
> subsWithNA = TRUE, filename =
> ? ? ? ? ? ? ? ? ? out.nm, datatype = type, overwrite = TRUE, progress = "text")
>
> That the progress bar and cat don't play together, in that cat is not
> displayed. I am not sure why, but perhaps it is simply being
> overwritten in the console by the progress bar? ?I opted to turn off
> the progress bar in favor of the messages produced by cat in this
> case. This isn't something I am terribly concerned with, but I thought
> I would mention it in case it is of interest.
>
> Thanks again for all your help.
>
> Cheers, Lyndon
>
>
>
> spatCSM <- function(spatialmaster, resamplegrid, res.factor, CSMtable,
> LUfield, outfields, outnames, type) {
> # Creates spatial output grids from results produced by runCSM
> function. Path needs to be set in advance
> # Args:
> # ? spatialmaster: A grid defining the location of each spatial units
> # ? resamplegrid: An optional grid defining the resolution to which
> results should be resampled
> # ? resamplefactor: Factor by which to aggregate (e.g. 10 times
> current pixel size, the default if not
> # ? ? specified)
> # ? CSMtable: The output table of CSM statistics generated by runCSM
> # ? LUfield: The field in CSMtable containing the spatial unit codes
> that match values in spatialmaster grid
> # ? outfields: A vector of column names in CSMtable for which gridded
> outputs are wanted, e.g. yield, CV yield
> # ? outnames: A vector of names for writing output grids, one for each
> specifed grid
> # ? type: Output datatype for grid, e.g. INT2S
> # Returns: R format raster grids, saved to disk, of mean yield and
> other optional grids
>
> ?library(raster)
> ?if(missing(spatialmaster) | missing(CSMtable) | missing(LUfield) |
> ? ? missing(outfields) | missing(type)) {
> ? ? stop("Missing parameter, check function list.")
> ?}
> ?if(length(outfields) != length(outnames)) {
> ? ? stop("Number of names for output grids does not match number of
> specified output grids")
> ?}
>
> ?cat("Running...")
>
> ?# Force to write to disk
> ?if(raster:::.toDisk() != TRUE) {
> ? ? setOptions(todisk = TRUE)
> ? ? cat("We don't want memory problems--forcing write to disk.\n")
> ?}
>
> ?for(i in 1:length(outfields)) {
>
> ? ?out.nm <- paste(outnames[i], ".grd", sep = "")
> ? ?cat("Substituting...")
> ? ?subs(spatialmaster, CSMtable, by = LUfield, which = outfields[i],
> subsWithNA = TRUE, filename =
> ? ? ? ? ? ? ? ? ? out.nm, datatype = type, overwrite = TRUE)#,
> progress = "text")
>
> ? ?if(!missing(resamplegrid)) {
> ? ? ?cat("Aggregating...")
> ? ? ?if(missing(res.factor)) {
> ? ? ? ?res.factor <- 10
> ? ? ?}
> ? ? ?subs.g <- raster(out.nm)
> ? ? ?out.nm2 <- paste("agg.", out.nm, sep = "")
> ? ? ?aggregate(subs.g, res.factor, fun = mean, na.rm = TRUE,
> ? ? ? ? ? ? ? ?filename = out.nm2, datatype = type, overwrite =
> TRUE)#, progress = "text")
> ? ? ?subs.g.agg <- raster(out.nm2)
> ? ? ?out.nm3 <- paste(outnames[i], ".",
> as.integer(res(resamplegrid)[1]), ".grd", sep = "")
> ? ? ?cat("Resampling...")
> ? ? ?resample(subs.g.agg, resamplegrid, method = "bilinear", filename
> = out.nm3, datatype = type,
> ? ? ? ? ? ? ? overwrite = TRUE)#, progress = "text")
> ? ?}
> ?}
> ?cat("Done.")
> ?setOptions(todisk = FALSE) ?# Return to default option allowing
> raster processing in memory
> }
>


From alexander.arpaci at boku.ac.at  Tue May 24 21:53:21 2011
From: alexander.arpaci at boku.ac.at (Alexander Arpaci)
Date: Tue, 24 May 2011 21:53:21 +0200
Subject: [R-sig-Geo] large datasets processing improving?
Message-ID: <4DDC28D1020000030001FA9D@gwia1.boku.ac.at>

Hi List

maybe not an truly geo like question 
but an R question I want to calculate percentiles which are ranked by comparing daily values percentiles with the overall distribution percentiles
I have data 1700 files with daily values  from 1960 so about 18000 values/days 
I use the following code which does what I want but it takes about 10 -15 minutes per file...
for (i in 1:17886) {
d1$perc[i] <- length(d1$normFMI[d1$normFMI

MSc. Alexander Arpaci
Assistant researcher

Department of Forest - and Soil Sciences
Institute of Silviculture
Tel. +43-1-47654-4081
e-mail: alexander.arpaci at boku.ac.at
www.wabo.boku.ac.at 


From alexander.arpaci at boku.ac.at  Tue May 24 22:04:38 2011
From: alexander.arpaci at boku.ac.at (Alexander Arpaci)
Date: Tue, 24 May 2011 22:04:38 +0200
Subject: [R-sig-Geo] Antw:  large datasets processing improving?
Message-ID: <4DDC2B76020000030001FAA6@gwia1.boku.ac.at>

Hello,
sorry I did not correctly posted my code



for (i in 1:dim(wamod_data)[1]) {
d1$perc[i] <- length(d1$normFMI[d1$normFMI>> "Alexander Arpaci"  24.05.11 21.54 Uhr >>>
Hi List

maybe not an truly geo like question 
but an R question I want to calculate percentiles which are ranked by comparing daily values percentiles with the overall distribution percentiles
I have data 1700 files with daily values  from 1960 so about 18000 values/days 
I use the following code which does what I want but it takes about 10 -15 minutes per file...
for (i in 1:17886) {
d1$perc[i] <- length(d1$normFMI[d1$normFMI

MSc. Alexander Arpaci
Assistant researcher

Department of Forest - and Soil Sciences
Institute of Silviculture
Tel. +43-1-47654-4081
e-mail: alexander.arpaci at boku.ac.at
www.wabo.boku.ac.at 

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


MSc. Alexander Arpaci
Assistant researcher

Department of Forest - and Soil Sciences
Institute of Silviculture
Tel. +43-1-47654-4081
e-mail: alexander.arpaci at boku.ac.at
www.wabo.boku.ac.at 


From Roger.Bivand at nhh.no  Tue May 24 22:21:42 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 24 May 2011 22:21:42 +0200 (CEST)
Subject: [R-sig-Geo] [GRASS-stats] Re:  readRAST6() in {spgrass6}
In-Reply-To: <BANLkTi=pqdzaWOuG_+OXctyekN2Xwpb0DA@mail.gmail.com>
References: <003f01cc0f48$3f7a66b0$be6f3410$@umail.ucsb.edu>
	<BANLkTi=1MTqesqeiyaoAp0kapSJc271JfA@mail.gmail.com>
	<007701cc140f$b84227b0$28c67710$@umail.ucsb.edu>
	<BANLkTi=rPeh9nrXh6ZdDbAjzHzzz=DtQgA@mail.gmail.com>
	<alpine.LRH.2.00.1105170613130.20286@reclus.nhh.no>
	<003301cc14ed$ff63b170$fe2b1450$@umail.ucsb.edu>
	<alpine.LRH.2.00.1105180724260.24493@reclus.nhh.no>
	<BANLkTi=+y8ky5WhFiOV5eiTyt00qjLUbMg@mail.gmail.com>
	<alpine.LRH.2.00.1105191547010.29187@reclus.nhh.no>
	<BANLkTi=pqdzaWOuG_+OXctyekN2Xwpb0DA@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1105242220340.24427@reclus.nhh.no>

On Tue, 24 May 2011, Dylan Beaudette wrote:

> Thanks for the clarification Roger. I will be more careful about
> handing out advice on functions that I have never used :).
>
> As the author of the original example that started this mess, I would
> like to contribute a new example that should generalize to those cases
> where readRAST6() isn't an option. These would be cases where GRASS-R
> integration is difficult (windows) or in cases where very large files
> are involved.
>
> http://casoilresource.lawr.ucdavis.edu/drupal/node/993
>
> This example will require your own data set. Feedback is always welcome.

Hi Dylan,

Yes, this should clear up some misunderstandings! Thanks!

Best wishes,

Roger

PS. Which days are you planning to be in Landau?

>
> Cheers,
> Dylan
>
> On Thu, May 19, 2011 at 7:04 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>> On Thu, 19 May 2011, Rainer M Krug wrote:
>>
>>> Hi Roger,
>>>
>>> On Wed, May 18, 2011 at 7:56 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>>>>
>>>> I do not have your location, so cannot check. It appears that your
>>>> workflow
>>>> is highly non-standard - which you have not made clear previously. If you
>>>> are using spgrass6 to interface R with an existing GRASS location - which
>>>> seems to be the case, you should not use initGRASS(), and should not use
>>>> the
>>>> PERMANENT mapset. The initGRASS() function is for creating one-time,
>>>> throwaway GRASS locations to use GRASS modules from R when no GISDBASE or
>>>> LOCATION is required.
>>>
>>> Could you please give some explanation, why the initGRASS() function
>>> should *not* be used when accessing an existing location? I use it
>>> extensively in my simulations to create a new mapset in a already
>>> existing location and I haven't experienced any problems which I would
>>> link to that.
>>> What kind of problems could occur, or why is this the non-standard
>>> usage of initGRASS()? I always assumed, that the idea is that
>>> initGRASS() actually replaces the "running R inside GRASS" approach?
>>
>> The function was introduced to make it possible to use GRASS modules without
>> a GRASS GISDBASE/LOCATION file tree, in throwaway mode for non-expert users.
>> The advice offered was also for non-expert users: unless you understand
>> fully what you are doing, choose between using R within GRASS for existing
>> LOCATION file trees, and initGRASS() when you are not using data from
>> "inside" GRASS. This advice holds for all users who do not understand the
>> possible inconvenience of trashing their .gisrc file.
>>
>> If, on the other hand, the user takes responsibility for over-riding the
>> regular GRASS startup mechanisms, initGRASS() can be used, as you decribe,
>> for scripting GRASS. Not every user, however, should consider this
>> possibility if all of the consequences are not understood.
>>
>> The main file at risk is .gisrc, but it is fully possible that the GRASS
>> mapset-specific temporary files will not be cleaned up properly, and
>> environment variables set by initGRASS() may interfere with GRASS in
>> unexpected ways across different OS while the R session has not been
>> terminated - I've not established any harmful interactions, but that doesn't
>> mean that they are not present on at least some platforms. In principle the
>> compute processes should not "leak", but on some OS, odd things happen, so
>> being cautious rather than principled seems justified.
>>
>> In the case that started this thread, the user does not seem to have had a
>> clear idea of what was happening, and was copying a script found online
>> intended for a different setting and an example data set. He needed to be
>> pointed to a more helpful setting, that is: start GRASS (and the GRASS GUI)
>> in Windows, start R in GRASS from the MSYS console, and be able to
>> manipulate the current GRASS region from the GUI to tile or resample the
>> data down to a size that admitted analysis.
>>
>>>
>>> Cheers,
>>>
>>> Rainer
>>>
>>>
>>>>
>>>> --
>>>> Roger Bivand
>>>> Economic Geography Section, Department of Economics, Norwegian School of
>>>> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>>>> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>>>> e-mail: Roger.Bivand at nhh.no
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>
>>>
>>>
>>>
>>
>> --
>> Roger Bivand
>> Economic Geography Section, Department of Economics, Norwegian School of
>> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>> _______________________________________________
>> grass-stats mailing list
>> grass-stats at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/grass-stats
>>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From matzke at berkeley.edu  Tue May 24 22:28:06 2011
From: matzke at berkeley.edu (Nick Matzke)
Date: Tue, 24 May 2011 13:28:06 -0700
Subject: [R-sig-Geo] coarsening a grid
Message-ID: <4DDC14D6.1040308@berkeley.edu>

Hi all,

Maybe this is obvious but I can't seem to find anything on it.

I have loaded and displayed a small DEM grid (6 MB) with 
readGDAL.

Is there an easy way to coarsen it or downsample it?

Cheers!
Nick


-- 
====================================================
Nicholas J. Matzke
Ph.D. Candidate, Graduate Student Researcher

Huelsenbeck Lab
Center for Theoretical Evolutionary Genomics
4151 VLSB (Valley Life Sciences Building)
Department of Integrative Biology
University of California, Berkeley

Graduate Student Instructor, IB200B
Principles of Phylogenetics: Ecology and Evolution
http://ib.berkeley.edu/courses/ib200b/
http://phylo.wikidot.com/


Lab websites:
http://ib.berkeley.edu/people/lab_detail.php?lab=54
http://fisher.berkeley.edu/cteg/hlab.html
Dept. personal page: 
http://ib.berkeley.edu/people/students/person_detail.php?person=370
Lab personal page: 
http://fisher.berkeley.edu/cteg/members/matzke.html
Lab phone: 510-643-6299
Dept. fax: 510-643-6264

Cell phone: 510-301-0179
Email: matzke at berkeley.edu

Mailing address:
Department of Integrative Biology
3060 VLSB #3140
Berkeley, CA 94720-3140

-----------------------------------------------------
"[W]hen people thought the earth was flat, they were wrong. 
When people thought the earth was spherical, they were 
wrong. But if you think that thinking the earth is spherical 
is just as wrong as thinking the earth is flat, then your 
view is wronger than both of them put together."

Isaac Asimov (1989). "The Relativity of Wrong." The 
Skeptical Inquirer, 14(1), 35-44. Fall 1989.
http://chem.tufts.edu/AnswersInScience/RelativityofWrong.htm


From Roger.Bivand at nhh.no  Tue May 24 23:02:51 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 24 May 2011 23:02:51 +0200
Subject: [R-sig-Geo] coarsening a grid
In-Reply-To: <4DDC14D6.1040308@berkeley.edu>
References: <4DDC14D6.1040308@berkeley.edu>
Message-ID: <alpine.LRH.2.00.1105242301300.24563@reclus.nhh.no>

On Tue, 24 May 2011, Nick Matzke wrote:

> Hi all,
>
> Maybe this is obvious but I can't seem to find anything on it.
>
> I have loaded and displayed a small DEM grid (6 MB) with readGDAL.
>
> Is there an easy way to coarsen it or downsample it?

You can downsample it when reading in, see the output.dim= argument to 
readGDAL() and its use in the examples there.

Roger

>
> Cheers!
> Nick
>
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From senator at ecotoxicology.de  Wed May 25 05:41:30 2011
From: senator at ecotoxicology.de (=?iso-8859-1?Q?Ralf_Sch=E4fer?=)
Date: Wed, 25 May 2011 05:41:30 +0200
Subject: [R-sig-Geo] rgdal on Mac OS X 10.6.7
In-Reply-To: <mailman.13.1306231203.18016.r-sig-geo@r-project.org>
References: <mailman.13.1306231203.18016.r-sig-geo@r-project.org>
Message-ID: <77407654-7001-4C73-A23E-792D5EE86DB9@ecotoxicology.de>

Dear list,

I tried to install rgdal in R 2.13.0 on Mac OS X 10.6.7 but it keeps failing no matter if I install from source or binary.

I get the following error message:
Error in dyn.load(file, DLLpath = DLLpath, ...) : 
  kann shared object '/Users/ralfs/Library/R/2.13/library/rgdal/libs/x86_64/rgdal.so' nicht laden:
  dlopen(/Users/ralfs/Library/R/2.13/library/rgdal/libs/x86_64/rgdal.so, 6): Symbol not found: _GetPrivateProfileString
  Referenced from: /usr/lib/libiodbc.2.dylib
  Expected in: flat namespace

System info:
R version 2.13.0 Patched (2011-04-14 r55450)
Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)

Any idea how to fix this - is obviously somehow related to the iodbc driver or sth...

Thanks in advance
Ralf


From alobolistas at gmail.com  Wed May 25 08:05:13 2011
From: alobolistas at gmail.com (Agustin Lobo)
Date: Wed, 25 May 2011 08:05:13 +0200
Subject: [R-sig-Geo] raster: creating a layer of NA
Message-ID: <BANLkTinTFFv8dOXYU+ByuJB7MH3-b4chxA@mail.gmail.com>

HI!

I must create a layer with all missing values. I try:
> show(D10N2009)
class       : RasterBrick
dimensions  : 393, 606, 35  (nrow, ncol, nlayers)
resolution  : 0.008928571, 0.008928571  (x, y)
extent      : -2.004464, 3.40625, 40.49554, 44.00446  (xmin, xmax, ymin, ymax)
projection  : +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0
values      : /media/Iomega_HDD/FLUXPYR/VGTFLUXPYR1/D10/FLXP_NDD10_2009.vrt
min values  : 0 0 0 0 0 0 0 0 0 0 ...
max values  : 255 255 255 255 255 255 255 255 255 255 ...

> delme = D10N2009[[1]]*0
> show(delme)
class       : RasterLayer
dimensions  : 393, 606, 238158  (nrow, ncol, ncell)
resolution  : 0.008928571, 0.008928571  (x, y)
extent      : -2.004464, 3.40625, 40.49554, 44.00446  (xmin, xmax, ymin, ymax)
projection  : +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0
values      : in memory
min value   : 0
max value   : 0

But
> delme = D10N2009[[1]]*NA
Error in D10N2009[[1]] * NA : non-numeric argument to binary operator

I also try
> NAvalue(delme) <- 0
but no trace of the NAs:
> show(delme)
class       : RasterLayer
dimensions  : 393, 606, 238158  (nrow, ncol, ncell)
resolution  : 0.008928571, 0.008928571  (x, y)
extent      : -2.004464, 3.40625, 40.49554, 44.00446  (xmin, xmax, ymin, ymax)
projection  : +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0
values      : in memory
min value   : 0
max value   : 0

By now I write with NAflag=0 and read back, but there must be a
cleaner way of generating a layer with all NA values
(it's a missing layer for a particular time)

Thanks!

Agus


From pierre.roudier at gmail.com  Wed May 25 08:25:02 2011
From: pierre.roudier at gmail.com (Pierre Roudier)
Date: Wed, 25 May 2011 18:25:02 +1200
Subject: [R-sig-Geo] raster: creating a layer of NA
In-Reply-To: <BANLkTinTFFv8dOXYU+ByuJB7MH3-b4chxA@mail.gmail.com>
References: <BANLkTinTFFv8dOXYU+ByuJB7MH3-b4chxA@mail.gmail.com>
Message-ID: <BANLkTikroj9r+AbSeiWZiQxBiNWsuBf9_A@mail.gmail.com>

Hi Agustin,

What about this:

# Create a Raster object
logo <- raster(system.file("external/rlogo.grd", package="raster"))
# Use this rastre to create a new, void Raster object
r <- raster(logo)
show(r)

Pierre

2011/5/25 Agustin Lobo <alobolistas at gmail.com>:
> HI!
>
> I must create a layer with all missing values. I try:
>> show(D10N2009)
> class ? ? ? : RasterBrick
> dimensions ?: 393, 606, 35 ?(nrow, ncol, nlayers)
> resolution ?: 0.008928571, 0.008928571 ?(x, y)
> extent ? ? ?: -2.004464, 3.40625, 40.49554, 44.00446 ?(xmin, xmax, ymin, ymax)
> projection ?: +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0
> values ? ? ?: /media/Iomega_HDD/FLUXPYR/VGTFLUXPYR1/D10/FLXP_NDD10_2009.vrt
> min values ?: 0 0 0 0 0 0 0 0 0 0 ...
> max values ?: 255 255 255 255 255 255 255 255 255 255 ...
>
>> delme = D10N2009[[1]]*0
>> show(delme)
> class ? ? ? : RasterLayer
> dimensions ?: 393, 606, 238158 ?(nrow, ncol, ncell)
> resolution ?: 0.008928571, 0.008928571 ?(x, y)
> extent ? ? ?: -2.004464, 3.40625, 40.49554, 44.00446 ?(xmin, xmax, ymin, ymax)
> projection ?: +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0
> values ? ? ?: in memory
> min value ? : 0
> max value ? : 0
>
> But
>> delme = D10N2009[[1]]*NA
> Error in D10N2009[[1]] * NA : non-numeric argument to binary operator
>
> I also try
>> NAvalue(delme) <- 0
> but no trace of the NAs:
>> show(delme)
> class ? ? ? : RasterLayer
> dimensions ?: 393, 606, 238158 ?(nrow, ncol, ncell)
> resolution ?: 0.008928571, 0.008928571 ?(x, y)
> extent ? ? ?: -2.004464, 3.40625, 40.49554, 44.00446 ?(xmin, xmax, ymin, ymax)
> projection ?: +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0
> values ? ? ?: in memory
> min value ? : 0
> max value ? : 0
>
> By now I write with NAflag=0 and read back, but there must be a
> cleaner way of generating a layer with all NA values
> (it's a missing layer for a particular time)
>
> Thanks!
>
> Agus
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Scientist
Landcare Research, New Zealand


From HodgessE at uhd.edu  Wed May 25 07:38:00 2011
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Wed, 25 May 2011 00:38:00 -0500
Subject: [R-sig-Geo] Please ignore previous starma models message
Message-ID: <586A4828D7AAA04CA9B258C50A28DA206DB800@BALI.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110525/aab97cd7/attachment.pl>

From HodgessE at uhd.edu  Wed May 25 07:34:54 2011
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Wed, 25 May 2011 00:34:54 -0500
Subject: [R-sig-Geo] STARMA models
Message-ID: <586A4828D7AAA04CA9B258C50A28DA206DB7FF@BALI.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110525/6f098a23/attachment.pl>

From Roger.Bivand at nhh.no  Wed May 25 07:27:22 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 25 May 2011 07:27:22 +0200 (CEST)
Subject: [R-sig-Geo] rgdal on Mac OS X 10.6.7
In-Reply-To: <77407654-7001-4C73-A23E-792D5EE86DB9@ecotoxicology.de>
References: <mailman.13.1306231203.18016.r-sig-geo@r-project.org>
	<77407654-7001-4C73-A23E-792D5EE86DB9@ecotoxicology.de>
Message-ID: <alpine.LRH.2.00.1105250712480.26115@reclus.nhh.no>

On Wed, 25 May 2011, Ralf Sch?fer wrote:

> Dear list,
>
> I tried to install rgdal in R 2.13.0 on Mac OS X 10.6.7 but it keeps 
> failing no matter if I install from source or binary.

You have not said how you installed rgdal - CRAN extras binary, Kyngchaos 
binary on Kyngchaos frameworks, source install on Kyngchaos frameworks, or 
source on GDAL source build.

The dependency is not from rgdal directly, but rather from GDAL as loaded 
by rgdal.

The standard OSX install is to use the binary package directly, by 
ensuring that the CRAN extras repository is being searched:

setRepositories(ind=1:2)
install.packages("rgdal")

This installs rgdal independently of any GDAL on your platform, just like 
the Windows binary package. Only standard GDAL/OGR drivers are available. 
This is probably not what you did, because any GDAL on your machine and 
rgdal do not interact.

If more drivers are needed, install the Kyngchaos frameworks, then the 
Kyngchaos rgdal binary. The Kyngchaos GDAL build determines the available 
drivers.

Equivalently, but with the full Xcode/R build train installed, you can 
install from source on top of the Kyngchaos frameworks. Source or binary 
installs interact with the Kyngchaos framework GDAL, so the same problem 
should occur in other applications loading GDAL.

Roger

>
> I get the following error message:
> Error in dyn.load(file, DLLpath = DLLpath, ...) :
>  kann shared object '/Users/ralfs/Library/R/2.13/library/rgdal/libs/x86_64/rgdal.so' nicht laden:
>  dlopen(/Users/ralfs/Library/R/2.13/library/rgdal/libs/x86_64/rgdal.so, 6): Symbol not found: _GetPrivateProfileString
>  Referenced from: /usr/lib/libiodbc.2.dylib
>  Expected in: flat namespace
>
> System info:
> R version 2.13.0 Patched (2011-04-14 r55450)
> Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)
>
> Any idea how to fix this - is obviously somehow related to the iodbc driver or sth...
>
> Thanks in advance
> Ralf
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From roman.lustrik at gmail.com  Wed May 25 08:32:34 2011
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Wed, 25 May 2011 08:32:34 +0200
Subject: [R-sig-Geo] raster: creating a layer of NA
In-Reply-To: <BANLkTikroj9r+AbSeiWZiQxBiNWsuBf9_A@mail.gmail.com>
References: <BANLkTinTFFv8dOXYU+ByuJB7MH3-b4chxA@mail.gmail.com>
	<BANLkTikroj9r+AbSeiWZiQxBiNWsuBf9_A@mail.gmail.com>
Message-ID: <BANLkTi=Q_+AgbvuGO0HU5PGGZTkaux1OFg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110525/7e2e181e/attachment.pl>

From geetha.ramaswami at gmail.com  Wed May 25 08:49:17 2011
From: geetha.ramaswami at gmail.com (geetha ramaswami)
Date: Wed, 25 May 2011 12:19:17 +0530
Subject: [R-sig-Geo] Join count analysis in R
Message-ID: <BANLkTi=vwhnPdV3WJWiBtPMhfoNGi8NUXQ@mail.gmail.com>

Hi,

I am trying to do some join count statistical analysis on my data (a
grid of 5000 cells with values 1 or 0) in order to determine whether
there is spatial clustering of pixels. Is there a built-in function
available in any of the spatial stats packages of R (I cannot seem to
locate it, if it is present)?

Geetha


From nicolas.degallier at ird.fr  Wed May 25 09:06:46 2011
From: nicolas.degallier at ird.fr (Nicolas Degallier)
Date: Wed, 25 May 2011 18:06:46 +1100
Subject: [R-sig-Geo] merging several shapefiles into one
Message-ID: <A5115738-A0E9-4224-A02B-1E59D377D5F6@ird.fr>

Hi All,

I have read different shapefiles that are contiguous and that have different column names with the function "readShapePoly".

example :

noumea <- readShapePoly(noumea.file, IDvar = "NOUMEA2_ID", proj4string = crs_rgnc)

and

dumbea <- readShapePoly(dumbea.file, IDvar = "DUMBEA2_", proj4string = crs_rgnc)

Now I would like to create a new shapefile with all the polygones in the "noumea" and "dumbea" spatial polygone data frames.

I tried :
spRbind(noumea, dumbea)

I get this message error :

Error in spRbind(as(obj, "SpatialPolygons"), as(x, "SpatialPolygons")) :
 non-unique polygon IDs

I have tried with the function rbind()
I have tried to set noumea$NOUMEA2_ID and dumbea$DUMBEA2_ with unique values but I still get the same message error as if the function spRbind was not using those two columns as polygons ID...

Does anyone know how I can fix this problem ?

Thanks a lot

Nicolas


Nicolas Degallier

IRD UMR182
Laboratoire d'Oc?anographie et du Climat, Exp?rimentation et Approches Num?riques (LOCEAN)
Tour 45-55, 4e ?t., case 100, 4 place Jussieu
75252  Paris Cedex 5  France
t?l: (33) 01 44 27 51 57
fax: (33) 01 44 27 38 05

E-mail: <Nicolas.Degallier at ird.fr>
pdf reprints:
http://www.locean-ipsl.upmc.fr/~ndelod/production/

Skype:"xuxaxu"


From Roger.Bivand at nhh.no  Wed May 25 09:10:27 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 25 May 2011 09:10:27 +0200 (CEST)
Subject: [R-sig-Geo] Join count analysis in R
In-Reply-To: <BANLkTi=vwhnPdV3WJWiBtPMhfoNGi8NUXQ@mail.gmail.com>
References: <BANLkTi=vwhnPdV3WJWiBtPMhfoNGi8NUXQ@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1105250907330.26411@reclus.nhh.no>

On Wed, 25 May 2011, geetha ramaswami wrote:

> Hi,
>
> I am trying to do some join count statistical analysis on my data (a
> grid of 5000 cells with values 1 or 0) in order to determine whether
> there is spatial clustering of pixels. Is there a built-in function
> available in any of the spatial stats packages of R (I cannot seem to
> locate it, if it is present)?

See joincoint.test() in spdep for the original Cliff/Ord test. You'll need 
to construct a weights object, probably using dnearneigh() and nb2listw() 
in the same package, and ensure that the input data are in vector form in 
the same order as the weights. See also the examples for joincoint.test() 
and joincoint.multi().

Roger

>
> Geetha
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From pierre.roudier at gmail.com  Wed May 25 09:22:49 2011
From: pierre.roudier at gmail.com (Pierre Roudier)
Date: Wed, 25 May 2011 19:22:49 +1200
Subject: [R-sig-Geo] merging several shapefiles into one
In-Reply-To: <A5115738-A0E9-4224-A02B-1E59D377D5F6@ird.fr>
References: <A5115738-A0E9-4224-A02B-1E59D377D5F6@ird.fr>
Message-ID: <BANLkTi=vBJehathXJd=L7X84NX-PRNGObQ@mail.gmail.com>

Hi Nicolas,

I do not have a R session handy, but if I remember correctly, the
function gUnion() in the rgeos package would do what you want.

Hope this helps,

Pierre

2011/5/25 Nicolas Degallier <nicolas.degallier at ird.fr>:
> Hi All,
>
> I have read different shapefiles that are contiguous and that have different column names with the function "readShapePoly".
>
> example :
>
> noumea <- readShapePoly(noumea.file, IDvar = "NOUMEA2_ID", proj4string = crs_rgnc)
>
> and
>
> dumbea <- readShapePoly(dumbea.file, IDvar = "DUMBEA2_", proj4string = crs_rgnc)
>
> Now I would like to create a new shapefile with all the polygones in the "noumea" and "dumbea" spatial polygone data frames.
>
> I tried :
> spRbind(noumea, dumbea)
>
> I get this message error :
>
> Error in spRbind(as(obj, "SpatialPolygons"), as(x, "SpatialPolygons")) :
> ?non-unique polygon IDs
>
> I have tried with the function rbind()
> I have tried to set noumea$NOUMEA2_ID and dumbea$DUMBEA2_ with unique values but I still get the same message error as if the function spRbind was not using those two columns as polygons ID...
>
> Does anyone know how I can fix this problem ?
>
> Thanks a lot
>
> Nicolas
>
>
> Nicolas Degallier
>
> IRD UMR182
> Laboratoire d'Oc?anographie et du Climat, Exp?rimentation et Approches Num?riques (LOCEAN)
> Tour 45-55, 4e ?t., case 100, 4 place Jussieu
> 75252 ?Paris Cedex 5 ?France
> t?l: (33) 01 44 27 51 57
> fax: (33) 01 44 27 38 05
>
> E-mail: <Nicolas.Degallier at ird.fr>
> pdf reprints:
> http://www.locean-ipsl.upmc.fr/~ndelod/production/
>
> Skype:"xuxaxu"
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Scientist
Landcare Research, New Zealand


From geetha.ramaswami at gmail.com  Wed May 25 10:27:49 2011
From: geetha.ramaswami at gmail.com (geetha ramaswami)
Date: Wed, 25 May 2011 13:57:49 +0530
Subject: [R-sig-Geo] Join count analysis in R
In-Reply-To: <alpine.LRH.2.00.1105250907330.26411@reclus.nhh.no>
References: <BANLkTi=vwhnPdV3WJWiBtPMhfoNGi8NUXQ@mail.gmail.com>
	<alpine.LRH.2.00.1105250907330.26411@reclus.nhh.no>
Message-ID: <BANLkTimzhSU46yPfvzaa0s7ivex5hC1xgg@mail.gmail.com>

Thanks!

On Wed, May 25, 2011 at 12:40 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> On Wed, 25 May 2011, geetha ramaswami wrote:
>
>> Hi,
>>
>> I am trying to do some join count statistical analysis on my data (a
>> grid of 5000 cells with values 1 or 0) in order to determine whether
>> there is spatial clustering of pixels. Is there a built-in function
>> available in any of the spatial stats packages of R (I cannot seem to
>> locate it, if it is present)?
>
> See joincoint.test() in spdep for the original Cliff/Ord test. You'll need
> to construct a weights object, probably using dnearneigh() and nb2listw() in
> the same package, and ensure that the input data are in vector form in the
> same order as the weights. See also the examples for joincoint.test() and
> joincoint.multi().
>
> Roger
>
>>
>> Geetha
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> --
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
>


From b.rowlingson at lancaster.ac.uk  Wed May 25 11:13:09 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed, 25 May 2011 10:13:09 +0100
Subject: [R-sig-Geo] merging several shapefiles into one
In-Reply-To: <A5115738-A0E9-4224-A02B-1E59D377D5F6@ird.fr>
References: <A5115738-A0E9-4224-A02B-1E59D377D5F6@ird.fr>
Message-ID: <BANLkTin8WqOUQqMLs89ghtEAjHsfWKBzzQ@mail.gmail.com>

On Wed, May 25, 2011 at 8:06 AM, Nicolas Degallier
<nicolas.degallier at ird.fr> wrote:
> Hi All,
>
> I have read different shapefiles that are contiguous and that have different column names with the function "readShapePoly".
>
> example :
>
> noumea <- readShapePoly(noumea.file, IDvar = "NOUMEA2_ID", proj4string = crs_rgnc)
>
> and
>
> dumbea <- readShapePoly(dumbea.file, IDvar = "DUMBEA2_", proj4string = crs_rgnc)
>
> Now I would like to create a new shapefile with all the polygones in the "noumea" and "dumbea" spatial polygone data frames.
>
> I tried :
> spRbind(noumea, dumbea)
>
> I get this message error :
>
> Error in spRbind(as(obj, "SpatialPolygons"), as(x, "SpatialPolygons")) :
> ?non-unique polygon IDs
>
> I have tried with the function rbind()
> I have tried to set noumea$NOUMEA2_ID and dumbea$DUMBEA2_ with unique values but I still get the same message error as if the function spRbind was not using those two columns as polygons ID...
>
> Does anyone know how I can fix this problem ?

 once you've read in your data using NOUMEA2_ID and DUMBEA2_ as the ID
variables, changing the values in the data frame won''t change the ID
attached to each feature.

 You need to use the "spChFIDs-methods" to create new spatial polygons
data frames with unique IDs between them.

 Here, scot1 is the first 10 features from scot_BNG as read in help(rgdal)

 > scot2=scot1
 > scot12=spRbind(scot1,scot2)
 Error in spRbind(as(obj, "SpatialPolygons"), as(x, "SpatialPolygons")) :
  non-unique polygon IDs

 - that fails because the IDs are the same. So we change scot2 to be
"A" to "J" (which isnt what the IDs are currently...)

 > scot2=spChFIDs(scot2,letters[1:10])
 > scot12=spRbind(scot1,scot2)

and that works.

Barry


From senator at ecotoxicology.de  Wed May 25 11:20:38 2011
From: senator at ecotoxicology.de (=?iso-8859-1?Q?Ralf_Sch=E4fer?=)
Date: Wed, 25 May 2011 11:20:38 +0200
Subject: [R-sig-Geo] rgdal on Mac OS X 10.6.7
In-Reply-To: <alpine.LRH.2.00.1105250712480.26115@reclus.nhh.no>
References: <mailman.13.1306231203.18016.r-sig-geo@r-project.org>
	<77407654-7001-4C73-A23E-792D5EE86DB9@ecotoxicology.de>
	<alpine.LRH.2.00.1105250712480.26115@reclus.nhh.no>
Message-ID: <0758375B-43E1-41BA-A599-1EB9A7D9D910@ecotoxicology.de>

Dear Roger

Am 25.05.2011 um 07:27 schrieb Roger Bivand:

> On Wed, 25 May 2011, Ralf Sch?fer wrote:
> 
>> Dear list,
>> 
>> I tried to install rgdal in R 2.13.0 on Mac OS X 10.6.7 but it keeps failing no matter if I install from source or binary.
> 
> You have not said how you installed rgdal - CRAN extras binary, Kyngchaos binary on Kyngchaos frameworks, source install on Kyngchaos frameworks, or source on GDAL source build.

I installed from Kyngchaos binary and and when this failed from source on the kyngchaos frameworks. I actually updated to the GDAL framework 1.8 from kyngchaos.
However, it works on my Mac Pro in the office - so is obviously an issue with some iodb drivers

> The dependency is not from rgdal directly, but rather from GDAL as loaded by rgdal.
> 
> The standard OSX install is to use the binary package directly, by ensuring that the CRAN extras repository is being searched:
> 
> setRepositories(ind=1:2)
> install.packages("rgdal")

That works - thanks!
Ralf


From lestes at princeton.edu  Wed May 25 12:41:39 2011
From: lestes at princeton.edu (Lyndon Estes)
Date: Wed, 25 May 2011 06:41:39 -0400
Subject: [R-sig-Geo] raster: creating a layer of NA
In-Reply-To: <BANLkTi=Q_+AgbvuGO0HU5PGGZTkaux1OFg@mail.gmail.com>
References: <BANLkTinTFFv8dOXYU+ByuJB7MH3-b4chxA@mail.gmail.com>
	<BANLkTikroj9r+AbSeiWZiQxBiNWsuBf9_A@mail.gmail.com>
	<BANLkTi=Q_+AgbvuGO0HU5PGGZTkaux1OFg@mail.gmail.com>
Message-ID: <BANLkTikR0Pkj3PEfRJBmS-FhUB8AXEfgtQ@mail.gmail.com>

Based on the example by Pierre:

logo <- raster(system.file("external/rlogo.grd", package="raster"))
# Use this rastre to create a new, void Raster object
r <- raster(logo)

> show(r)
class       : RasterLayer
dimensions  : 77, 101, 7777  (nrow, ncol, ncell)
resolution  : 1, 1  (x, y)
extent      : 0, 101, 0, 77  (xmin, xmax, ymin, ymax)
projection  : +proj=merc +ellps=WGS84
values      : none

# Set to NA
r[] <- NA
> show(r)
class       : RasterLayer
dimensions  : 77, 101, 7777  (nrow, ncol, ncell)
resolution  : 1, 1  (x, y)
extent      : 0, 101, 0, 77  (xmin, xmax, ymin, ymax)
projection  : +proj=merc +ellps=WGS84
values      : in memory
min value   : NA
max value   : NA

So this should work for your raster:

D10N2009[] <- NA


Cheers, Lyndon


On Wed, May 25, 2011 at 2:32 AM, Roman Lu?trik <roman.lustrik at gmail.com> wrote:
> I would use setValues on individual layer.
>
> Cheers,
> Roman
>
>
>
> On Wed, May 25, 2011 at 8:25 AM, Pierre Roudier <pierre.roudier at gmail.com>wrote:
>
>> Hi Agustin,
>>
>> What about this:
>>
>> # Create a Raster object
>> logo <- raster(system.file("external/rlogo.grd", package="raster"))
>> # Use this rastre to create a new, void Raster object
>> r <- raster(logo)
>> show(r)
>>
>> Pierre
>>
>> 2011/5/25 Agustin Lobo <alobolistas at gmail.com>:
>> > HI!
>> >
>> > I must create a layer with all missing values. I try:
>> >> show(D10N2009)
>> > class ? ? ? : RasterBrick
>> > dimensions ?: 393, 606, 35 ?(nrow, ncol, nlayers)
>> > resolution ?: 0.008928571, 0.008928571 ?(x, y)
>> > extent ? ? ?: -2.004464, 3.40625, 40.49554, 44.00446 ?(xmin, xmax, ymin,
>> ymax)
>> > projection ?: +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs
>> +towgs84=0,0,0
>> > values ? ? ?:
>> /media/Iomega_HDD/FLUXPYR/VGTFLUXPYR1/D10/FLXP_NDD10_2009.vrt
>> > min values ?: 0 0 0 0 0 0 0 0 0 0 ...
>> > max values ?: 255 255 255 255 255 255 255 255 255 255 ...
>> >
>> >> delme = D10N2009[[1]]*0
>> >> show(delme)
>> > class ? ? ? : RasterLayer
>> > dimensions ?: 393, 606, 238158 ?(nrow, ncol, ncell)
>> > resolution ?: 0.008928571, 0.008928571 ?(x, y)
>> > extent ? ? ?: -2.004464, 3.40625, 40.49554, 44.00446 ?(xmin, xmax, ymin,
>> ymax)
>> > projection ?: +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs
>> +towgs84=0,0,0
>> > values ? ? ?: in memory
>> > min value ? : 0
>> > max value ? : 0
>> >
>> > But
>> >> delme = D10N2009[[1]]*NA
>> > Error in D10N2009[[1]] * NA : non-numeric argument to binary operator
>> >
>> > I also try
>> >> NAvalue(delme) <- 0
>> > but no trace of the NAs:
>> >> show(delme)
>> > class ? ? ? : RasterLayer
>> > dimensions ?: 393, 606, 238158 ?(nrow, ncol, ncell)
>> > resolution ?: 0.008928571, 0.008928571 ?(x, y)
>> > extent ? ? ?: -2.004464, 3.40625, 40.49554, 44.00446 ?(xmin, xmax, ymin,
>> ymax)
>> > projection ?: +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs
>> +towgs84=0,0,0
>> > values ? ? ?: in memory
>> > min value ? : 0
>> > max value ? : 0
>> >
>> > By now I write with NAflag=0 and read back, but there must be a
>> > cleaner way of generating a layer with all NA values
>> > (it's a missing layer for a particular time)
>> >
>> > Thanks!
>> >
>> > Agus
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at r-project.org
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >
>>
>>
>>
>> --
>> Scientist
>> Landcare Research, New Zealand
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
>
> --
> In God we trust, all others bring data.
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Lyndon Estes
Research Associate
Woodrow Wilson School
Princeton University
+1-609-258-2392 (o)
+1-609-258-6082 (f)
+1-202-431-0496 (m)
lestes at princeton.edu


From zua3 at cornell.edu  Wed May 25 14:25:08 2011
From: zua3 at cornell.edu (Zia Ahmed)
Date: Wed, 25 May 2011 08:25:08 -0400
Subject: [R-sig-Geo] merging several shapefiles into one
In-Reply-To: <BANLkTi=vBJehathXJd=L7X84NX-PRNGObQ@mail.gmail.com>
References: <A5115738-A0E9-4224-A02B-1E59D377D5F6@ird.fr>
	<BANLkTi=vBJehathXJd=L7X84NX-PRNGObQ@mail.gmail.com>
Message-ID: <4DDCF524.3070800@cornell.edu>

  I used following code to merge a series of  shape files with similar 
file structure. We can try this, but you need to do some modification of 
the code.
Zia

###############################################################################

# Require packages: rgdal and maptool
#-------------------------------------

library(rgdal)
library(maptools)

# Get list of all shape files from county directories/sptial/
#------------------------------------------------------------

files <- list.files(pattern="soilmu_a_ia.*.shp$", 
recursive=TRUE,full.names=TRUE)
uid<-1

# Get polygons from first file (_001)
#-------------------------------------

poly.data<- readOGR(files[1],gsub("^.*/(.*).shp$", "\\1", files[1]))
n <- length(slot(poly.data, "polygons"))
poly.data <- spChFIDs(poly.data, as.character(uid:(uid+n-1)))
uid <- uid + n

# mapunit polygoan: combin remaining  polygons with first polygoan
#-----------------------------------------------------------------

for (i in 2:length(files)) {
     temp.data <- readOGR(files[i], gsub("^.*/(.*).shp$", "\\1",files[i]))
     n <- length(slot(temp.data, "polygons"))
     temp.data <- spChFIDs(temp.data, as.character(uid:(uid+n-1)))
     uid <- uid + n
     poly.data <- spRbind(poly.data,temp.data)
}

names(poly.data)
proj4string(poly.data)

On 5/25/2011 3:22 AM, Pierre Roudier wrote:
> Hi Nicolas,
>
> I do not have a R session handy, but if I remember correctly, the
> function gUnion() in the rgeos package would do what you want.
>
> Hope this helps,
>
> Pierre
>
> 2011/5/25 Nicolas Degallier<nicolas.degallier at ird.fr>:
>> Hi All,
>>
>> I have read different shapefiles that are contiguous and that have different column names with the function "readShapePoly".
>>
>> example :
>>
>> noumea<- readShapePoly(noumea.file, IDvar = "NOUMEA2_ID", proj4string = crs_rgnc)
>>
>> and
>>
>> dumbea<- readShapePoly(dumbea.file, IDvar = "DUMBEA2_", proj4string = crs_rgnc)
>>
>> Now I would like to create a new shapefile with all the polygones in the "noumea" and "dumbea" spatial polygone data frames.
>>
>> I tried :
>> spRbind(noumea, dumbea)
>>
>> I get this message error :
>>
>> Error in spRbind(as(obj, "SpatialPolygons"), as(x, "SpatialPolygons")) :
>>   non-unique polygon IDs
>>
>> I have tried with the function rbind()
>> I have tried to set noumea$NOUMEA2_ID and dumbea$DUMBEA2_ with unique values but I still get the same message error as if the function spRbind was not using those two columns as polygons ID...
>>
>> Does anyone know how I can fix this problem ?
>>
>> Thanks a lot
>>
>> Nicolas
>>
>>
>> Nicolas Degallier
>>
>> IRD UMR182
>> Laboratoire d'Oc?anographie et du Climat, Exp?rimentation et Approches Num?riques (LOCEAN)
>> Tour 45-55, 4e ?t., case 100, 4 place Jussieu
>> 75252  Paris Cedex 5  France
>> t?l: (33) 01 44 27 51 57
>> fax: (33) 01 44 27 38 05
>>
>> E-mail:<Nicolas.Degallier at ird.fr>
>> pdf reprints:
>> http://www.locean-ipsl.upmc.fr/~ndelod/production/
>>
>> Skype:"xuxaxu"
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110525/df96063a/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: zua3.vcf
Type: text/x-vcard
Size: 281 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110525/df96063a/attachment.vcf>

From mathieu.rajerison at gmail.com  Wed May 25 15:50:52 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Wed, 25 May 2011 15:50:52 +0200
Subject: [R-sig-Geo] merging several shapefiles into one
In-Reply-To: <4DDCF524.3070800@cornell.edu>
References: <A5115738-A0E9-4224-A02B-1E59D377D5F6@ird.fr>
	<BANLkTi=vBJehathXJd=L7X84NX-PRNGObQ@mail.gmail.com>
	<4DDCF524.3070800@cornell.edu>
Message-ID: <BANLkTine9jxg6SX8qk5C--4d+BNaQzgP-A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110525/0a430401/attachment.pl>

From mathieu.rajerison at gmail.com  Wed May 25 17:40:09 2011
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Wed, 25 May 2011 17:40:09 +0200
Subject: [R-sig-Geo] split polygons by percentage
In-Reply-To: <AANLkTikP_2RZDCXbEy-Cq+0OF_ijduMMSeX+ZSQO6ghr@mail.gmail.com>
References: <AANLkTikr+K38N3jJvih1-JW7gGHkKvbJVTqsvn3TJ-3i@mail.gmail.com>
	<AANLkTikxXsEb3eXQpw85UBRpJqnM8R6RubRuCso8KJHE@mail.gmail.com>
	<AANLkTikP_2RZDCXbEy-Cq+0OF_ijduMMSeX+ZSQO6ghr@mail.gmail.com>
Message-ID: <BANLkTin=WbPC7LhWoeiH5gWx65FfvF_crA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110525/6e43cb5b/attachment.pl>

From sarah.papworth06 at imperial.ac.uk  Wed May 25 17:48:20 2011
From: sarah.papworth06 at imperial.ac.uk (Sarah Papworth)
Date: Wed, 25 May 2011 16:48:20 +0100
Subject: [R-sig-Geo] Exporting from R to use in ArcMap
Message-ID: <BANLkTikMjgtUPBbf-uvHHbFW5LKzN41jGA@mail.gmail.com>

Dear all,
I have made a map of home ranges from lat-long data using the function
BRB from the package adehabitatHR (see code below) What I can't work
out how to do is to export the image (which is made up of cells with
probability UD and contours) in a way in which it is georeferenced for
import into ArcMap. I would really appreciate it if anyone knows how
to do this!
Sarah


library(adehabitatHR)
datetime <- as.POSIXct(paste(hunter1$Date,hunter1$Time), format =
"%d/%m/%Y %H:%M:%S","GMT")
##make data.frame of lat and long in meters
coord<-data.frame(hunter1$POINT_X,hunter1$POINT_Y)
## make ltraj split by person
huntGPS2<-as.ltraj(coord,datetime,hunter1$Person,burst=hunter1$Person,typeII=TRUE)
summary(huntGPS2)
#get smoothy parameter
a2<-BRB.D(huntGPS2, Tmax = 300*60, Lmin = 0)
#make the HR estimates
best2<-BRB(huntGPS2, a2, Tmax=300*60, Lmin=0, hmin=68, grid = 125, b = FALSE,
same4all = TRUE, extent=0.1,tau=10)

#make the map for each person
# Hunter4
person4<-getvolumeUD(best2[[4]])
 par(mar=c(0,0,2,0))
image(person4)
#nice title
title("Utilisation distribution Hunter 4")
#add contours
xyzv<-as.image.SpatialGridDataFrame(person4)
contour(xyzv,add=TRUE)
#work out a way to export image

-- 
Imperial College London
http://www.iccs.org.uk/sarahpapworth.htm


From Tim.Haering at lwf.bayern.de  Wed May 25 17:50:39 2011
From: Tim.Haering at lwf.bayern.de (=?iso-8859-1?Q?H=E4ring=2C_Tim_=28LWF=29?=)
Date: Wed, 25 May 2011 17:50:39 +0200
Subject: [R-sig-Geo] multivariate output with predict() on rasterStack
Message-ID: <70FC67C4A585D1489E66225A4E0238BAF4EFBF@RZS-EXC-CL06.rz-sued.bayern.de>

Hello,

According to the help file, the predict() function in the raster package creates a RasterLayer. Since a RasterLayer cannot store more than one layer like a RasterStack, I wonder if it is possible to use the predict() functions when the output of the prediction is multivariate? For example when predicting the class probabilities. Is it possible to create a RasterStack with the predict function, in which the probabilies for different classes are stored in single layers?

Thank you.
TIM

---------------- 
Tim H?ring
Bavarian State Institute of Forest Research 
Department of Soil and Climate
Hans-Carl-von-Carlowitz-Platz 1
D-85354 Freising

E-Mail: tim.haering at lwf.bayern.de
http://www.lwf.bayern.de


From francoisrousseu at hotmail.com  Wed May 25 19:34:37 2011
From: francoisrousseu at hotmail.com (Francois Rousseu)
Date: Wed, 25 May 2011 13:34:37 -0400
Subject: [R-sig-Geo] Distance from a point to the closest polygon
In-Reply-To: <BANLkTikMjgtUPBbf-uvHHbFW5LKzN41jGA@mail.gmail.com>
References: <BANLkTikMjgtUPBbf-uvHHbFW5LKzN41jGA@mail.gmail.com>
Message-ID: <BLU149-W48FF1C2936529C7E4A1BABBA740@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110525/919ae919/attachment.pl>

From roman.lustrik at gmail.com  Wed May 25 19:43:29 2011
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Wed, 25 May 2011 19:43:29 +0200
Subject: [R-sig-Geo] Distance from a point to the closest polygon
In-Reply-To: <BLU149-W48FF1C2936529C7E4A1BABBA740@phx.gbl>
References: <BANLkTikMjgtUPBbf-uvHHbFW5LKzN41jGA@mail.gmail.com>
	<BLU149-W48FF1C2936529C7E4A1BABBA740@phx.gbl>
Message-ID: <BANLkTimTUS30++jznaDpMXPGBMqFsNQF9g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110525/3e4638e6/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Wed May 25 19:53:09 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed, 25 May 2011 18:53:09 +0100
Subject: [R-sig-Geo] Distance from a point to the closest polygon
In-Reply-To: <BLU149-W48FF1C2936529C7E4A1BABBA740@phx.gbl>
References: <BANLkTikMjgtUPBbf-uvHHbFW5LKzN41jGA@mail.gmail.com>
	<BLU149-W48FF1C2936529C7E4A1BABBA740@phx.gbl>
Message-ID: <BANLkTim4n8x0nwrjFRRp2Vc5SiayKSLC7Q@mail.gmail.com>

On Wed, May 25, 2011 at 6:34 PM, Francois Rousseu
<francoisrousseu at hotmail.com> wrote:
>
> Hi useRs
>
> I want to measure the distance between several points on a map and the closest water body, represented by polygons. The method I found uses the dist2Line function from package geosphere. In my example, I create a circular polygon made from a 100 000 points and measure the distance separating it from a given point:
>
> ?buff<-destPoint( c(-74,46), b=seq(1,365,length.out=100000), d=1000)
> system.time(dist2Line(c(-75,45), buff))
>
> This takes almost 10 seconds on my computer which is way too long for me. In my case, I need to determine that distance between thousands of points in a complex lake system. ?Is there a faster way to do this in R?

 Do your lakes really have 100,000 coordinates defining them? (And do
circles really have 365 degrees in them?).

 Trying:

 buff<-destPoint( c(-74,46), b=seq(1,360,length.out=N), d=100)

shows that the time to do dist2Line is about linear with the
complexity of the polygon, here N. If your lakes are that finely
digitized, then can you thin their boundaries? Can you pre-test
against the bounding boxes of the lakes to reduce the number of
point-line segment tests? Note that I don't think the nearest lake
will always be the one with the nearest bbox, but you do know the max
possible distance to that lake is the distance to the furthest corner
of the bbox. Any lakes whose nearest bbox corner is _further_ than
that distance can be eliminated.

 Beyond that you are possibly looking into spatial indexing and maybe
loading it into a PostGIS database with this kind of optimised spatial
indexing searches.

 And rgeos of course.

 Random thoughts.

Barry


From francoisrousseu at hotmail.com  Wed May 25 20:11:05 2011
From: francoisrousseu at hotmail.com (Francois Rousseu)
Date: Wed, 25 May 2011 14:11:05 -0400
Subject: [R-sig-Geo] Distance from a point to the closest polygon
In-Reply-To: <BANLkTim4n8x0nwrjFRRp2Vc5SiayKSLC7Q@mail.gmail.com>
References: <BANLkTikMjgtUPBbf-uvHHbFW5LKzN41jGA@mail.gmail.com>,
	<BLU149-W48FF1C2936529C7E4A1BABBA740@phx.gbl>,
	<BANLkTim4n8x0nwrjFRRp2Vc5SiayKSLC7Q@mail.gmail.com>
Message-ID: <BLU149-W10CF6F81B78B77D169F8DABA740@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110525/8e5e0935/attachment.pl>

From colinr23 at gmail.com  Wed May 25 21:58:51 2011
From: colinr23 at gmail.com (Colin Robertson)
Date: Wed, 25 May 2011 15:58:51 -0400
Subject: [R-sig-Geo] bivariate pairwise interaction spatial point process
Message-ID: <BANLkTi=wou=sewi=FeDr2aQWS7krz1=0pQ@mail.gmail.com>

Dear List,

I am looking for examples of how to simulate a bivariate pairwise
interaction point process. The only multivariate (type) model I can
find is the poisson multitype pattern in Spatstat. The Strauss process
can give me interaction point process, but I cannot see how to use it
to formulate a bivariate model.

Help much appreciated,

Colin


From r.turner at auckland.ac.nz  Wed May 25 22:39:06 2011
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Thu, 26 May 2011 08:39:06 +1200
Subject: [R-sig-Geo] bivariate pairwise interaction spatial point process
In-Reply-To: <BANLkTi=wou=sewi=FeDr2aQWS7krz1=0pQ@mail.gmail.com>
References: <BANLkTi=wou=sewi=FeDr2aQWS7krz1=0pQ@mail.gmail.com>
Message-ID: <4DDD68EA.4070401@auckland.ac.nz>

On 26/05/11 07:58, Colin Robertson wrote:
> Dear List,
>
> I am looking for examples of how to simulate a bivariate pairwise
> interaction point process. The only multivariate (type) model I can
> find is the poisson multitype pattern in Spatstat. The Strauss process
> can give me interaction point process, but I cannot see how to use it
> to formulate a bivariate model.
It's not clear to me what you're asking but does the "straussm"
conditional intensity function for rmh() (multitype Strauss model)
do what you want?

See ?rmhmodel.default.

If not, can you be more explicit about the model that you wish
to simulate?

     cheers,

         Rolf Turner


From r.hijmans at gmail.com  Thu May 26 08:04:00 2011
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Wed, 25 May 2011 23:04:00 -0700 (PDT)
Subject: [R-sig-Geo] multivariate output with predict() on rasterStack
In-Reply-To: <70FC67C4A585D1489E66225A4E0238BAF4EFBF@RZS-EXC-CL06.rz-sued.bayern.de>
References: <70FC67C4A585D1489E66225A4E0238BAF4EFBF@RZS-EXC-CL06.rz-sued.bayern.de>
Message-ID: <1306389840441-6405741.post@n2.nabble.com>

> According to the help file, the predict() function in the raster package
creates a RasterLayer. Since a
> RasterLayer cannot store more than one layer like a RasterStack, I wonder
> if it is possible to use the 
> predict() functions when the output of the prediction is multivariate? For
> example when predicting the class 
> probabilities. Is it possible to create a RasterStack with the predict
> function, in which the probabilies for 
> different classes are stored in single layers? 

Tim, 

You can create a RasterBrick. You need to use the index argument to indicate
how many layers, and which, (columns in the prediction matrix) you expect /
want.

For example:
x <- predict(stack, model, type='prob', index=1:2)

Unfortunately that does not work in the current version, because the '...'
arguments ('type' in this case) are ignored. (I introduced an error solving
a problem for you 2 weeks ago. 1 step forward, 2 steps back). I'll upload a
new version to CRAN tomorrow. 

But there is a work around, using the fun argument. You will also need this
argument if your modelling method does not return a matrix but, e.g., a
list.

predfun <- function(model, data) {
  predict(model, data=data, type='prob')
}
x <- predict(stack, model, fun=predfun, index=1:2)

Robert

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/multivariate-output-with-predict-on-rasterStack-tp6403349p6405741.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From r.hijmans at gmail.com  Thu May 26 08:12:29 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 25 May 2011 23:12:29 -0700
Subject: [R-sig-Geo] raster: creating a layer of NA
In-Reply-To: <BANLkTikR0Pkj3PEfRJBmS-FhUB8AXEfgtQ@mail.gmail.com>
References: <BANLkTinTFFv8dOXYU+ByuJB7MH3-b4chxA@mail.gmail.com>
	<BANLkTikroj9r+AbSeiWZiQxBiNWsuBf9_A@mail.gmail.com>
	<BANLkTi=Q_+AgbvuGO0HU5PGGZTkaux1OFg@mail.gmail.com>
	<BANLkTikR0Pkj3PEfRJBmS-FhUB8AXEfgtQ@mail.gmail.com>
Message-ID: <BANLkTimpQjy4E7wKCSRh_WA8RETdazWhhQ@mail.gmail.com>

Hi Agus,

That happens because I defined Arith functions for Raster* objects and
numeric values, but not for Raster* objects and logical values. NA is
a logical value, see class(NA). I will add that.

Here are two more work arounds:

r <- D10N2009[[1]] * as.numeric(NA)

r <- calc(D10N2009[[1]], fun=function(x) x * NA)

Robert


On Wed, May 25, 2011 at 3:41 AM, Lyndon Estes <lestes at princeton.edu> wrote:
> Based on the example by Pierre:
>
> logo <- raster(system.file("external/rlogo.grd", package="raster"))
> # Use this rastre to create a new, void Raster object
> r <- raster(logo)
>
>> show(r)
> class ? ? ? : RasterLayer
> dimensions ?: 77, 101, 7777 ?(nrow, ncol, ncell)
> resolution ?: 1, 1 ?(x, y)
> extent ? ? ?: 0, 101, 0, 77 ?(xmin, xmax, ymin, ymax)
> projection ?: +proj=merc +ellps=WGS84
> values ? ? ?: none
>
> # Set to NA
> r[] <- NA
>> show(r)
> class ? ? ? : RasterLayer
> dimensions ?: 77, 101, 7777 ?(nrow, ncol, ncell)
> resolution ?: 1, 1 ?(x, y)
> extent ? ? ?: 0, 101, 0, 77 ?(xmin, xmax, ymin, ymax)
> projection ?: +proj=merc +ellps=WGS84
> values ? ? ?: in memory
> min value ? : NA
> max value ? : NA
>
> So this should work for your raster:
>
> D10N2009[] <- NA
>
>
> Cheers, Lyndon
>
>
> On Wed, May 25, 2011 at 2:32 AM, Roman Lu?trik <roman.lustrik at gmail.com> wrote:
>> I would use setValues on individual layer.
>>
>> Cheers,
>> Roman
>>
>>
>>
>> On Wed, May 25, 2011 at 8:25 AM, Pierre Roudier <pierre.roudier at gmail.com>wrote:
>>
>>> Hi Agustin,
>>>
>>> What about this:
>>>
>>> # Create a Raster object
>>> logo <- raster(system.file("external/rlogo.grd", package="raster"))
>>> # Use this rastre to create a new, void Raster object
>>> r <- raster(logo)
>>> show(r)
>>>
>>> Pierre
>>>
>>> 2011/5/25 Agustin Lobo <alobolistas at gmail.com>:
>>> > HI!
>>> >
>>> > I must create a layer with all missing values. I try:
>>> >> show(D10N2009)
>>> > class ? ? ? : RasterBrick
>>> > dimensions ?: 393, 606, 35 ?(nrow, ncol, nlayers)
>>> > resolution ?: 0.008928571, 0.008928571 ?(x, y)
>>> > extent ? ? ?: -2.004464, 3.40625, 40.49554, 44.00446 ?(xmin, xmax, ymin,
>>> ymax)
>>> > projection ?: +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs
>>> +towgs84=0,0,0
>>> > values ? ? ?:
>>> /media/Iomega_HDD/FLUXPYR/VGTFLUXPYR1/D10/FLXP_NDD10_2009.vrt
>>> > min values ?: 0 0 0 0 0 0 0 0 0 0 ...
>>> > max values ?: 255 255 255 255 255 255 255 255 255 255 ...
>>> >
>>> >> delme = D10N2009[[1]]*0
>>> >> show(delme)
>>> > class ? ? ? : RasterLayer
>>> > dimensions ?: 393, 606, 238158 ?(nrow, ncol, ncell)
>>> > resolution ?: 0.008928571, 0.008928571 ?(x, y)
>>> > extent ? ? ?: -2.004464, 3.40625, 40.49554, 44.00446 ?(xmin, xmax, ymin,
>>> ymax)
>>> > projection ?: +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs
>>> +towgs84=0,0,0
>>> > values ? ? ?: in memory
>>> > min value ? : 0
>>> > max value ? : 0
>>> >
>>> > But
>>> >> delme = D10N2009[[1]]*NA
>>> > Error in D10N2009[[1]] * NA : non-numeric argument to binary operator
>>> >
>>> > I also try
>>> >> NAvalue(delme) <- 0
>>> > but no trace of the NAs:
>>> >> show(delme)
>>> > class ? ? ? : RasterLayer
>>> > dimensions ?: 393, 606, 238158 ?(nrow, ncol, ncell)
>>> > resolution ?: 0.008928571, 0.008928571 ?(x, y)
>>> > extent ? ? ?: -2.004464, 3.40625, 40.49554, 44.00446 ?(xmin, xmax, ymin,
>>> ymax)
>>> > projection ?: +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs
>>> +towgs84=0,0,0
>>> > values ? ? ?: in memory
>>> > min value ? : 0
>>> > max value ? : 0
>>> >
>>> > By now I write with NAflag=0 and read back, but there must be a
>>> > cleaner way of generating a layer with all NA values
>>> > (it's a missing layer for a particular time)
>>> >
>>> > Thanks!
>>> >
>>> > Agus
>>> >
>>> > _______________________________________________
>>> > R-sig-Geo mailing list
>>> > R-sig-Geo at r-project.org
>>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> >
>>>
>>>
>>>
>>> --
>>> Scientist
>>> Landcare Research, New Zealand
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>>
>>
>> --
>> In God we trust, all others bring data.
>>
>> ? ? ? ?[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
>
> --
> Lyndon Estes
> Research Associate
> Woodrow Wilson School
> Princeton University
> +1-609-258-2392?(o)
> +1-609-258-6082?(f)
> +1-202-431-0496?(m)
> lestes at princeton.edu
>


From ruocco at idi.ntnu.no  Thu May 26 10:21:23 2011
From: ruocco at idi.ntnu.no (ruocco)
Date: Thu, 26 May 2011 10:21:23 +0200
Subject: [R-sig-Geo] Ripley's K-function and CSR/CSRT test for Very Large
	Dataset
Message-ID: <100R689f0101da66b36cfcef637e3979c831@idi.ntnu.no>

Hi,
i am trying to apply the CSR and CSRT test, in a case-control context.
The size of control data is ~400.000 points. I have then a set of case 
data (around 500 and i want to verify, for each one, the interaction 
between the case and control data) and the size of these data vary from 
100 to 4000 events.

I am using the ripley k-function and the test statistic 
D(h)/sqrt(var(D)), for each distance h in the range.

The problem is that i should use Monte Carlo hypothesis testing to 
obtain the p-value, but with this size of control data the 
computational cost is prohibitive.

Are there other types of tests, less computationally expensive to 
verify the null hypothesis applying the ripley's K-function on very 
large dataset?

Regards

Massimiliano Ruocco
PhD Student
Department of Computer and Information Science (IDI), NTNU
Office: 260 IT-bygget
Phone:(+47) 735 94168
Email:ruocco at idi.ntnu.no
Website: http://www.idi.ntnu.no/~ruocco/


From b.rowlingson at lancaster.ac.uk  Thu May 26 11:40:55 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Thu, 26 May 2011 10:40:55 +0100
Subject: [R-sig-Geo] Ripley's K-function and CSR/CSRT test for Very
	Large Dataset
In-Reply-To: <100R689f0101da66b36cfcef637e3979c831@idi.ntnu.no>
References: <100R689f0101da66b36cfcef637e3979c831@idi.ntnu.no>
Message-ID: <BANLkTin6ydYtHa04wuP37Z==5JxKsZFWEQ@mail.gmail.com>

On Thu, May 26, 2011 at 9:21 AM, ruocco <ruocco at idi.ntnu.no> wrote:
> Hi,
> i am trying to apply the CSR and CSRT test, in a case-control context.
> The size of control data is ~400.000 points. I have then a set of case data
> (around 500 and i want to verify, for each one, the interaction between the
> case and control data) and the size of these data vary from 100 to 4000
> events.
>
> I am using the ripley k-function and the test statistic D(h)/sqrt(var(D)),
> for each distance h in the range.
>
> The problem is that i should use Monte Carlo hypothesis testing to obtain
> the p-value, but with this size of control data the computational cost is
> prohibitive.
>
> Are there other types of tests, less computationally expensive to verify the
> null hypothesis applying the ripley's K-function on very large dataset?

 Any reason why you can't randomly sample from your control points,
and do the analysis with 4,000 control points instead of 400,000?
Repeat that a few times to get an idea of the sensitivity and that's
job done.

 K-function tests for  500 cases/4000 controls should be doable on a
PC these days.

Barry


From ogbos.okike at gmail.com  Thu May 26 13:49:49 2011
From: ogbos.okike at gmail.com (ogbos okike)
Date: Thu, 26 May 2011 13:49:49 +0200
Subject: [R-sig-Geo] Random numbers of equal length
Message-ID: <BANLkTik5=xWZqnF_ZrrhBsmsQWudm9zokw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110526/6d6ee98b/attachment.pl>

From colinr23 at gmail.com  Thu May 26 15:04:03 2011
From: colinr23 at gmail.com (Colin Robertson)
Date: Thu, 26 May 2011 09:04:03 -0400
Subject: [R-sig-Geo] bivariate pairwise interaction spatial point process
In-Reply-To: <4DDD68EA.4070401@auckland.ac.nz>
References: <BANLkTi=wou=sewi=FeDr2aQWS7krz1=0pQ@mail.gmail.com>
	<4DDD68EA.4070401@auckland.ac.nz>
Message-ID: <BANLkTi=uAc_EjkAq1Cbj2xOyXAobv7z0xQ@mail.gmail.com>

Hi Rolf,

Thanks for your reply. Yes I think the multitype Strauss model is what
I was looking for, with parameters (gammas) for interaction in
component 1, 2 and between 1 & 2, which I believe is the gamma matrix
parameter for straussm.

Apologies for my lack of clarity in the initial question, I was
looking at the model in Diggle pg 85 under Markov point processes.

Thanks again,

Colin





On Wed, May 25, 2011 at 4:39 PM, Rolf Turner <r.turner at auckland.ac.nz> wrote:
> On 26/05/11 07:58, Colin Robertson wrote:
>>
>> Dear List,
>>
>> I am looking for examples of how to simulate a bivariate pairwise
>> interaction point process. The only multivariate (type) model I can
>> find is the poisson multitype pattern in Spatstat. The Strauss process
>> can give me interaction point process, but I cannot see how to use it
>> to formulate a bivariate model.
>
> It's not clear to me what you're asking but does the "straussm"
> conditional intensity function for rmh() (multitype Strauss model)
> do what you want?
>
> See ?rmhmodel.default.
>
> If not, can you be more explicit about the model that you wish
> to simulate?
>
> ? ?cheers,
>
> ? ? ? ?Rolf Turner
>


From zev at zevross.com  Thu May 26 16:19:18 2011
From: zev at zevross.com (Zev Ross)
Date: Thu, 26 May 2011 10:19:18 -0400
Subject: [R-sig-Geo] Kernel Density With Lines
Message-ID: <4DDE6166.9030609@zevross.com>

Hi All,

Has anyone done kernel density estimation on line "features" in R 
similar to what can be computed in ArcGIS (link below)? They have a 
kernel density for line features but it only supports one kernel 
function -- I'd like to experiment with different kernels.

Zev

http://help.arcgis.com/en/arcgisdesktop/10.0/help/index.html#/How_Kernel_Density_works/009z00000011000000/

-- 
Zev Ross
ZevRoss Spatial Analysis
120 N Aurora, Suite 3A
Ithaca, NY 14850
607-277-0004 (phone)
866-877-3690 (fax, toll-free)
zev at zevross.com


From valerio.bartolino at uniroma1.it  Thu May 26 16:44:40 2011
From: valerio.bartolino at uniroma1.it (Valerio Bartolino)
Date: Thu, 26 May 2011 16:44:40 +0200
Subject: [R-sig-Geo] Kernel Density With Lines
In-Reply-To: <4DDE6166.9030609@zevross.com>
References: <4DDE6166.9030609@zevross.com>
Message-ID: <1306421080.2005.60.camel@ubuntu.ubuntu-domain>

I think the package 'spatstat' has the capabilities you are looking for.
Look at the psp-class.
Hope this help

Valerio

On Thu, 2011-05-26 at 10:19 -0400, Zev Ross wrote:
> Hi All,
> 
> Has anyone done kernel density estimation on line "features" in R 
> similar to what can be computed in ArcGIS (link below)? They have a 
> kernel density for line features but it only supports one kernel 
> function -- I'd like to experiment with different kernels.
> 
> Zev
> 
> http://help.arcgis.com/en/arcgisdesktop/10.0/help/index.html#/How_Kernel_Density_works/009z00000011000000/
> 


From mdsumner at gmail.com  Thu May 26 16:47:00 2011
From: mdsumner at gmail.com (Michael Sumner)
Date: Fri, 27 May 2011 00:47:00 +1000
Subject: [R-sig-Geo] Kernel Density With Lines
In-Reply-To: <4DDE6166.9030609@zevross.com>
References: <4DDE6166.9030609@zevross.com>
Message-ID: <BANLkTi=096GvNsZ2WVM3Pm3c7DiriJSmUg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110527/6853cc28/attachment.pl>

From gos47 at hotmail.com  Thu May 26 16:54:32 2011
From: gos47 at hotmail.com (=?iso-8859-1?Q?Gaspar_Reyes_P=F3ndigo?=)
Date: Thu, 26 May 2011 09:54:32 -0500
Subject: [R-sig-Geo]  2-D Scatter Plots from the Image
References: <632FCB4B-EB34-4E62-9FE3-1895FD0ABF09@hotmail.com>
Message-ID: <BLU0-SMTP189DC67CD5211F18DF614D5B7770@phx.gbl>


Hi, Dear list 

I have one question:

How to make 2-D Scatter Plots from the Image (p.e. landsat band 4 vs 3) in R, is it possible?


------------------------------
Gaspar Reyes P?ndigo
Universidad del Mar, Oaxaca, M?xico
Campus Puerto-?ngel
Carretera principal Puerto ?ngel Zipolite km 1.5 
C.P. 70902

From burtonshank at gmail.com  Thu May 26 17:27:36 2011
From: burtonshank at gmail.com (Burton Shank)
Date: Thu, 26 May 2011 11:27:36 -0400
Subject: [R-sig-Geo] predict.gstat memory allocation error
Message-ID: <BANLkTinVf=HY6-cW7tj0+yrK+KmfvCUR8w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110526/cffe1129/attachment.pl>

From boris.orlowsky at env.ethz.ch  Thu May 26 17:44:07 2011
From: boris.orlowsky at env.ethz.ch (Boris Orlowsky)
Date: Thu, 26 May 2011 17:44:07 +0200
Subject: [R-sig-Geo] Global maps in Robinson projections
Message-ID: <4DDE7547.2030808@env.ethz.ch>

Hi,

does anyone know of a way how to project a global rectangular lon-lat 
map into the Robinson projection?

For the rectangular map, I use as.image() to create an object plotable 
with image(). The grid-argument for as.image() comes from an 
expand.grid(lon,lat), where lon and lat derive from a Gaussian T42 grid. 
Vector z which contains my data at each  point of the Gaussian T42 grid 
contains NAs, for example over the oceans.

I manage to transform the original gridpoints to the robinson-projection 
(by spTransform() after converting the grid to SpatialPoints), however 
the interpolation of the data to this new grid fails (interp() from the 
akima library) because of the missing values in z.

Any idea would be highly appreciated!

Cheers, Boris.


From edzer.pebesma at uni-muenster.de  Thu May 26 17:44:20 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 26 May 2011 17:44:20 +0200
Subject: [R-sig-Geo] predict.gstat memory allocation error
In-Reply-To: <BANLkTinVf=HY6-cW7tj0+yrK+KmfvCUR8w@mail.gmail.com>
References: <BANLkTinVf=HY6-cW7tj0+yrK+KmfvCUR8w@mail.gmail.com>
Message-ID: <4DDE7554.3030700@uni-muenster.de>



On 05/26/2011 05:27 PM, Burton Shank wrote:
> I can't tell that predict.gstat has options for limiting predictor data sets
> using nmax or maxdist arguments when cokriging.
> 

well, ?gstat, used to create the object to be passed on to
predict.gstat, has these. Did you use them?

A reproducable example, maybe with fake data, would be helpful -- I have
a similar linux box here. Ah, and just to make sure:

uname -a

on your box indicates x86_64 as architecture, not i686, right?
-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From zev at zevross.com  Thu May 26 17:50:57 2011
From: zev at zevross.com (Zev Ross)
Date: Thu, 26 May 2011 11:50:57 -0400
Subject: [R-sig-Geo] Kernel Density With Lines
In-Reply-To: <BANLkTi=096GvNsZ2WVM3Pm3c7DiriJSmUg@mail.gmail.com>
References: <4DDE6166.9030609@zevross.com>
	<BANLkTi=096GvNsZ2WVM3Pm3c7DiriJSmUg@mail.gmail.com>
Message-ID: <4DDE76E1.5030002@zevross.com>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110526/617fdee2/attachment.html>

From carson.farmer at gmail.com  Thu May 26 19:38:20 2011
From: carson.farmer at gmail.com (Carson Farmer)
Date: Thu, 26 May 2011 18:38:20 +0100
Subject: [R-sig-Geo] classIntervals issue
Message-ID: <BANLkTi=uhwPzHcQFsLjdR7HGUOkczC+GcA@mail.gmail.com>

Hi List, not sure if this is *really* an r-sig-geo question, but since
Roger is the maintainer for the classInt package, I thought I'd start
here.

For some reason, whenever creating a classIntervals object, if I try
to print/access said object's "table" attribute for using in a legend
(see p. 79 in ASDA with R), I get the following error message:

> classIntervals(layer$incoming, n=5, style="fisher", cutlabels=TRUE)
style: fisher
      [3,813)  [813,2782.5) [2782.5,6365)  [6365,12569) [12569,20422]
         2993           306            84            20             6
Warning messages:
1: In factorial(n - 1) : value out of range in 'gammafn'
2: In factorial(n - k) : value out of range in 'gammafn'

Can anyone tell me why? For reference, the data that I'm trying to
classify looks like this (nothing too weird that I can see):

> summary(layer$incoming)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
    3.0    43.0    86.0   434.1   263.0 20420.0

> sessionInfo()
R version 2.13.0 (2011-04-13)
Platform: x86_64-pc-linux-gnu (64-bit)

locale:
 [1] LC_CTYPE=en_IE.utf8       LC_NUMERIC=C
LC_TIME=en_IE.utf8
 [4] LC_COLLATE=en_IE.utf8     LC_MONETARY=C
LC_MESSAGES=en_IE.utf8
 [7] LC_PAPER=en_IE.utf8       LC_NAME=C                 LC_ADDRESS=C
[10] LC_TELEPHONE=C            LC_MEASUREMENT=en_IE.utf8
LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] lattice_0.19-26   classInt_0.1-14   e1071_1.5-25      class_7.3-3
     TeachingDemos_2.7
[6] sp_0.9-80         CircStats_0.2-4   boot_1.2-43       MASS_7.3-13

loaded via a namespace (and not attached):
[1] grid_2.13.0  tools_2.13.0

-- 
Carson J. Q. Farmer
ISSP Doctoral Fellow
National Centre for Geocomputation
National University of Ireland, Maynooth,
http://www.carsonfarmer.com/


From advaitgodbole at gmail.com  Thu May 26 21:03:06 2011
From: advaitgodbole at gmail.com (Advait Godbole)
Date: Thu, 26 May 2011 15:03:06 -0400
Subject: [R-sig-Geo] correlogram for missing values
Message-ID: <BANLkTi=Rf5mrJgECSSnbZ+zDa9yOkF9e3A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110526/8dd24072/attachment.pl>

From Andy.Bunn at wwu.edu  Thu May 26 21:52:11 2011
From: Andy.Bunn at wwu.edu (Andy Bunn)
Date: Thu, 26 May 2011 19:52:11 +0000
Subject: [R-sig-Geo] coarsening a grid
In-Reply-To: <alpine.LRH.2.00.1105242301300.24563@reclus.nhh.no>
References: <4DDC14D6.1040308@berkeley.edu>
	<alpine.LRH.2.00.1105242301300.24563@reclus.nhh.no>
Message-ID: <9B597DE5AF080D418509A7E9F1E93EAF02079096@Exch2010MB-3.univ.dir.wwu.edu>

> -----Original Message-----
> From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-
> project.org] On Behalf Of Roger Bivand
> Sent: Tuesday, May 24, 2011 2:03 PM
> To: Nick Matzke
> Cc: r-sig-geo at stat.math.ethz.ch
> Subject: Re: [R-sig-Geo] coarsening a grid
> 
> On Tue, 24 May 2011, Nick Matzke wrote:
> 
> > Hi all,
> >
> > Maybe this is obvious but I can't seem to find anything on it.
> >
> > I have loaded and displayed a small DEM grid (6 MB) with readGDAL.
> >
> > Is there an easy way to coarsen it or downsample it?

aggregate() in raster is useful/fast as well.


> 
> You can downsample it when reading in, see the output.dim= argument to
> readGDAL() and its use in the examples there.
> 
> Roger
> 
> >
> > Cheers!
> > Nick
> >
> >
> >
> 
> --
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School
> of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Roger.Bivand at nhh.no  Thu May 26 22:05:55 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 26 May 2011 22:05:55 +0200
Subject: [R-sig-Geo] classIntervals issue
In-Reply-To: <BANLkTi=uhwPzHcQFsLjdR7HGUOkczC+GcA@mail.gmail.com>
References: <BANLkTi=uhwPzHcQFsLjdR7HGUOkczC+GcA@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1105262153240.31936@reclus.nhh.no>

On Thu, 26 May 2011, Carson Farmer wrote:

> Hi List, not sure if this is *really* an r-sig-geo question, but since
> Roger is the maintainer for the classInt package, I thought I'd start
> here.
>
> For some reason, whenever creating a classIntervals object, if I try
> to print/access said object's "table" attribute for using in a legend
> (see p. 79 in ASDA with R), I get the following error message:
>
>> classIntervals(layer$incoming, n=5, style="fisher", cutlabels=TRUE)
> style: fisher
>      [3,813)  [813,2782.5) [2782.5,6365)  [6365,12569) [12569,20422]
>         2993           306            84            20             6
> Warning messages:
> 1: In factorial(n - 1) : value out of range in 'gammafn'
> 2: In factorial(n - k) : value out of range in 'gammafn'
>
> Can anyone tell me why? For reference, the data that I'm trying to
> classify looks like this (nothing too weird that I can see):
>
>> summary(layer$incoming)
>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
>    3.0    43.0    86.0   434.1   263.0 20420.0

Class intervals must be relevant, no?

Reproducing:

> x <- exp(runif(3409, 0, 10))
> summary(x)
     Min.  1st Qu.   Median     Mean  3rd Qu.     Max.
     1.00    11.48   143.70  2277.00  1776.00 21970.00
> cl <- classIntervals(x, n=5, style="fisher", cutlabels=TRUE)
> cl
style: fisher
   [1.000301,1745.2)   [1745.2,5520.098) [5520.098,10475.15) 
[10475.15,16236.95)
                2549                 375                 217 
147
[16236.95,21965.68]
                 121
Warning messages:
1: In factorial(n - 1) : value out of range in 'gammafn'
2: In factorial(n - k) : value out of range in 'gammafn'

> factorial(3409-1)
[1] Inf
Warning message:
In factorial(3409 - 1) : value out of range in 'gammafn'
> factorial(3409-5)
[1] Inf
Warning message:
In factorial(3409 - 5) : value out of range in 'gammafn'
> factorial
function (x)
gamma(x + 1)
<environment: namespace:base>
> gamma(3409)
[1] Inf
Warning message:
value out of range in 'gammafn'
> nPartitions
function (x)
{
     n <- attr(x, "nobs")
     k <- length(x$brks) - 1
     (factorial(n - 1))/(factorial(n - k) * factorial(k - 1))
}
<environment: namespace:classInt>
> nPartitions(cl)
[1] NaN
Warning messages:
1: In factorial(n - 1) : value out of range in 'gammafn'
2: In factorial(n - k) : value out of range in 'gammafn'

This is coming from the code in the print method that shows how many 
combinations of 3409 objects into 5 classes are possible, which is so 
large that the calls to factorial() and from there to gamma() fail. I can 
put in a check for n > 170 to suppress this information, because 
factorial(n-1) fails just above there.

Interesting point!

Roger


>
>> sessionInfo()
> R version 2.13.0 (2011-04-13)
> Platform: x86_64-pc-linux-gnu (64-bit)
>
> locale:
> [1] LC_CTYPE=en_IE.utf8       LC_NUMERIC=C
> LC_TIME=en_IE.utf8
> [4] LC_COLLATE=en_IE.utf8     LC_MONETARY=C
> LC_MESSAGES=en_IE.utf8
> [7] LC_PAPER=en_IE.utf8       LC_NAME=C                 LC_ADDRESS=C
> [10] LC_TELEPHONE=C            LC_MEASUREMENT=en_IE.utf8
> LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] lattice_0.19-26   classInt_0.1-14   e1071_1.5-25      class_7.3-3
>     TeachingDemos_2.7
> [6] sp_0.9-80         CircStats_0.2-4   boot_1.2-43       MASS_7.3-13
>
> loaded via a namespace (and not attached):
> [1] grid_2.13.0  tools_2.13.0
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From carson.farmer at gmail.com  Thu May 26 23:02:55 2011
From: carson.farmer at gmail.com (Carson Farmer)
Date: Thu, 26 May 2011 22:02:55 +0100
Subject: [R-sig-Geo] classIntervals issue
In-Reply-To: <alpine.LRH.2.00.1105262153240.31936@reclus.nhh.no>
References: <BANLkTi=uhwPzHcQFsLjdR7HGUOkczC+GcA@mail.gmail.com>
	<alpine.LRH.2.00.1105262153240.31936@reclus.nhh.no>
Message-ID: <BANLkTikjG=k7MtnuR2G7-YV++0pAewSR4g@mail.gmail.com>

Thanks for clearing that up Roger!
> This is coming from the code in the print method that shows how many
> combinations of 3409 objects into 5 classes are possible, which is so large
> that the calls to factorial() and from there to gamma() fail. I can put in a
> check for n > 170 to suppress this information, because factorial(n-1) fails
> just above there.
Good to know. For now I can simply catch this myself as a work around.
As you may have guessed, I was trying to classify exactly 3409 values.

Carson


-- 
Carson J. Q. Farmer
ISSP Doctoral Fellow
National Centre for Geocomputation
National University of Ireland, Maynooth,
http://www.carsonfarmer.com/


From kidsmake6 at msn.com  Thu May 26 23:26:59 2011
From: kidsmake6 at msn.com (Brad Nesom)
Date: Thu, 26 May 2011 16:26:59 -0500
Subject: [R-sig-Geo] split polygons by percentage
In-Reply-To: <BANLkTin=WbPC7LhWoeiH5gWx65FfvF_crA@mail.gmail.com>
References: <AANLkTikr+K38N3jJvih1-JW7gGHkKvbJVTqsvn3TJ-3i@mail.gmail.com>
	<AANLkTikxXsEb3eXQpw85UBRpJqnM8R6RubRuCso8KJHE@mail.gmail.com>
	<AANLkTikP_2RZDCXbEy-Cq+0OF_ijduMMSeX+ZSQO6ghr@mail.gmail.com>
	<BANLkTin=WbPC7LhWoeiH5gWx65FfvF_crA@mail.gmail.com>
Message-ID: <BANLkTimOg5WCtMgo=nj7vKjfKK1rAzatDQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110526/5f7e372b/attachment.pl>

From advaitgodbole at gmail.com  Fri May 27 03:47:32 2011
From: advaitgodbole at gmail.com (Advait Godbole)
Date: Thu, 26 May 2011 21:47:32 -0400
Subject: [R-sig-Geo] empty neighbour sets and lm.morantest()
Message-ID: <BANLkTikDYUwjG19ga+4Mg7CEqpGegZmKSA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110526/7f047c57/attachment.pl>

From matzke at berkeley.edu  Fri May 27 04:33:05 2011
From: matzke at berkeley.edu (Nick Matzke)
Date: Thu, 26 May 2011 16:33:05 -1000
Subject: [R-sig-Geo] coarsening a grid
In-Reply-To: <9B597DE5AF080D418509A7E9F1E93EAF02079096@Exch2010MB-3.univ.dir.wwu.edu>
References: <4DDC14D6.1040308@berkeley.edu>
	<alpine.LRH.2.00.1105242301300.24563@reclus.nhh.no>
	<9B597DE5AF080D418509A7E9F1E93EAF02079096@Exch2010MB-3.univ.dir.wwu.edu>
Message-ID: <BANLkTinxmkcR9-Wt8s=A_W_ZHW6EC5bmsA@mail.gmail.com>

Thanks to both!  Even for plotting a large grid, these are good
options for speeding that up where the full resolution isn't needed...

On Thu, May 26, 2011 at 9:52 AM, Andy Bunn <Andy.Bunn at wwu.edu> wrote:
>> -----Original Message-----
>> From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-
>> project.org] On Behalf Of Roger Bivand
>> Sent: Tuesday, May 24, 2011 2:03 PM
>> To: Nick Matzke
>> Cc: r-sig-geo at stat.math.ethz.ch
>> Subject: Re: [R-sig-Geo] coarsening a grid
>>
>> On Tue, 24 May 2011, Nick Matzke wrote:
>>
>> > Hi all,
>> >
>> > Maybe this is obvious but I can't seem to find anything on it.
>> >
>> > I have loaded and displayed a small DEM grid (6 MB) with readGDAL.
>> >
>> > Is there an easy way to coarsen it or downsample it?
>
> aggregate() in raster is useful/fast as well.
>
>
>>
>> You can downsample it when reading in, see the output.dim= argument to
>> readGDAL() and its use in the examples there.
>>
>> Roger
>>
>> >
>> > Cheers!
>> > Nick
>> >
>> >
>> >
>>
>> --
>> Roger Bivand
>> Economic Geography Section, Department of Economics, Norwegian School
>> of
>> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


From Roger.Bivand at nhh.no  Fri May 27 07:42:09 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 27 May 2011 07:42:09 +0200
Subject: [R-sig-Geo] correlogram for missing values
In-Reply-To: <BANLkTi=Rf5mrJgECSSnbZ+zDa9yOkF9e3A@mail.gmail.com>
References: <BANLkTi=Rf5mrJgECSSnbZ+zDa9yOkF9e3A@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1105270713580.1732@reclus.nhh.no>

On Thu, 26 May 2011, Advait Godbole wrote:

> Dear List,
>
> I am performing a spatial analysis for gridded data with ~8000 cells. Each
> grid cell is 10 x 10 km and has one dependent and 4 independent variables.
> The dependent variable is log-transformed and has some NAs. I generated a
> first order queen neighbour object:

The missing values are almost certainly the source of your problem. Subset 
both your data and your neighbour object to retain only complete cases.

You did not state your command for Moran's I, but I guess that you set 
na.action=na.omit - you do not seem to have passed this to correlog, which 
gives the message you see irrespective of the cause of the error. The 
problem will be resolved by removing incomplete cases.

Roger

>
>> vulcgrid.queen.nb
>
> Neighbour list object:
> Number of regions: 8281
> Number of nonzero links: 64944
> Percentage nonzero weights: 0.09470512
> Average number of links: 7.842531
>
> and then ran a Moran's I (after accounting for the missing values using
> na.omit):
>
>> lnemitpcap.morans.queen.1st
>
>        Moran's I test under randomisation
>
> data:  LNEMITPCAP
> weights: vulcgrid.queen.nb.w
> omitted: 7, 176, 259, 1304, 1424, 1473, 1532, 2101, 2273, 2436, 2451, 2884,
> 2921, 4260, 4271, 4454, 4577, 4957, 5111, 5126, 5589, 5837, 5871, 5994,
> 6084, 6315, 6527, 6528, 6696, 6697, 6865, 6946, 7022, 7034, 7115, 7558,
> 7638, 7658, 7780, 7898
>
> Moran I statistic standard deviate = 58.0851, p-value < 2.2e-16
> alternative hypothesis: greater
> sample estimates:
> Moran I statistic       Expectation          Variance
>     3.249438e-01     -1.213592e-04      3.131927e-05
>
> I wanted to test for the suitability of higher order neighbours and hence
> tried sp.correlogram which does not work with NAs. Is there a workaround?
> Also, on trying correlog() following suggestions in the ASDAR book, gives
> the following output:
>
>> vulcgrid.correlog <- correlog(coords, LNEMITPCAP, method = "Moran",
> nbclass=NULL)
> Error in correlog(coords, LNEMITPCAP, method = "Moran", nbclass = NULL) :
>  Bad selection of class breaks, try another one...
>
> How may I go about this? Do I need to manually specify distance bands? the
> data are not on a regular grid. The GIS file is an extract from a larger
> dataset for the conterminous US in North American Lambert Conformal Conic
> projection with NAD 1983 datum. Suggestions are greatly appreciated.
>
> Regards,
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Fri May 27 07:53:55 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 27 May 2011 07:53:55 +0200
Subject: [R-sig-Geo] empty neighbour sets and lm.morantest()
In-Reply-To: <BANLkTikDYUwjG19ga+4Mg7CEqpGegZmKSA@mail.gmail.com>
References: <BANLkTikDYUwjG19ga+4Mg7CEqpGegZmKSA@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1105270742230.1835@reclus.nhh.no>

On Thu, 26 May 2011, Advait Godbole wrote:

> Dear List,
>
> I am performing a spatial analysis for gridded data with ~8000 cells. Each
> grid cell is 10 x 10 km and has one dependent and 5 independent variables.
> The dependent variable is log-transformed and has some NAs, as do the
> independent variables.
>
> I set up the lm() function using na.action=na.exclude (different from the
> default na.omit, since the lm documentation says that na.exclude pads the
> residuals to the correct length and fills with NA). Using a 1st order queen
> weights matrix generated keeping zero.policy=TRUE, I ran the lm.morantest()
> function, which returned this error:

Well, working without complete cases is always very unsatisfactory. 
Consider subsetting everything (data and neighbour object) to remove 
incomplete cases first - the results will be the same anyway. The error 
messages are caused by the internal subsetting of the neighbour object 
creating observations with no neighbours. You can choose to pass 
zero.policy=TRUE in all functions using the neighbour object, or setting 
set.ZeroPolicyOption() globally. The error message does tell you what the 
problem is.

>
>> allxform.lm.moran.queen <-
> lm.morantest(ols.allxform,vulcgrid.queen.nb.w,alternative = "two.sided")
> Error in nb2listw(neighbours = subnb, glist = NULL, style = style,
> zero.policy = zero.policy) :
>  Empty neighbour sets found
>
> repeating the same using an 8 nearest neighbour matrix also yielded the same
> error:
>
>> allxform.lm.moran.queen <-
> lm.morantest(ols.allxform,vulcgrid.knn8.w,alternative = "two.sided")
> Error in nb2listw(neighbours = subnb, glist = NULL, style = style,
> zero.policy = zero.policy) :
>  Empty neighbour sets found
>
> I then tried reading in a 45km distance thresholded neighbour matrix
> generated in OpenGeoDa using read.gwt2nb(), after converting to listw using
> zero.policy=TRUE and style="W". Running lm.morantest using this weights
> matrix returns the error:
>
>> allxform.lm.moran.queen <-
> lm.morantest(ols.allxform,vulcgrid.nb.dist.45km.gwt.w,alternative =
> "two.sided")
> Error in lm.morantest(ols.allxform, vulcgrid.nb.dist.45km.gwt.w, alternative
> = "two.sided") :
>  objects of different length
>
> Checking length of the objects, which I presume are "ols.allxform" (my lm
> result) and "vulcgrid.nb.dist.45km.gwt.w":
>
>> length(ols.allxform)
> [1] 13
>> length(vulcgrid.nb.dist.45km.gwt.w)
> [1] 3

Wrong check: length(residuals(ols.allxform)) is not equal to 
length(vulcgrid.nb.dist.45km.gwt.w$neighbours) - that is, the object 
created in OpenGeoDa is not for the same objects as the lm model objects.

Roger

>
>
> Weights matrix summary:
>
>> vulcgrid.nb.dist.45km.gwt.w
> Characteristics of weights list object:
> Neighbour list object:
> Number of regions: 8281
> Number of nonzero links: 533700
> Percentage nonzero weights: 0.7782724
> Average number of links: 64.44874
>
> Weights style: W
> Weights constants summary:
>     n       nn   S0       S1       S2
> W 8281 68574961 8281 261.9284 33173.84
>
> I then ran the lm.LMtests() function on the same linear model for the
> queen's weights matrix and for the distance thresholded weights matrix
> yileding the same error..
>
>> chi.lmtest.nohdr <- lm.LMtests(ols.allxform, vulcgrid.queen.nb.w,
> zero.policy=NULL, test="all", spChk=NULL, naSubset=TRUE)
> Error in lm.LMtests(ols.allxform, vulcgrid.queen.nb.w, zero.policy = TRUE,
> :
>  objects of different length
>
> sessionInfo output:
>
> R version 2.11.1 (2010-05-31)
> x86_64-pc-mingw32
>
> locale:
> [1] LC_COLLATE=English_United Kingdom.1252  LC_CTYPE=English_United
> Kingdom.1252
> [3] LC_MONETARY=English_United Kingdom.1252 LC_NUMERIC=C
>
> [5] LC_TIME=English_United Kingdom.1252
>
> attached base packages:
> [1] grDevices datasets  splines   graphics  stats     tcltk     utils
> methods   base
>
> other attached packages:
> [1] pgirmess_1.4.9      RandomFields_1.3.41 plyr_1.2.1
> robust_0.3-11
> [5] rrcov_1.1-00        pcaPP_1.8-3         mvtnorm_0.9-92
> robustbase_0.5-0-1
> [9] sandwich_2.2-6      zoo_1.6-4           rgdal_0.6-28
> raster_1.8-9
> [13] RNetCDF_1.2-1.1     clim.pact_2.2-41    akima_0.5-4         ncdf_1.6.3
>
> [17] car_2.0-2           nnet_7.3-1          tkrplot_0.0-19
> TeachingDemos_2.7
> [21] sphet_1.1-0         fields_6.3          spam_0.23-0         geoR_1.6-32
>
> [25] RColorBrewer_1.0-2  spdep_0.5-33        coda_0.13-5
> deldir_0.0-12
> [29] maptools_0.7-38     foreign_0.8-40      nlme_3.1-96         MASS_7.3-7
>
> [33] Matrix_0.999375-39  lattice_0.18-8      boot_1.2-42         sp_0.9-71
>
> [37] survival_2.35-8
>
> loaded via a namespace (and not attached):
> [1] grid_2.11.1   stats4_2.11.1 tools_2.11.1
>
>
> Suggestions are greatly appreciated!
>
> Regards,
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From emmanuel.blondel1 at gmail.com  Fri May 27 08:32:43 2011
From: emmanuel.blondel1 at gmail.com (Emmanuel Blondel)
Date: Fri, 27 May 2011 08:32:43 +0200
Subject: [R-sig-Geo] {rgeos} readWKT - str_replace() function ??
Message-ID: <BANLkTim1EyGAbWdrSG5Xstxi5BGEo+DZgw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110527/9d025a35/attachment.pl>

From edzer.pebesma at uni-muenster.de  Fri May 27 08:49:58 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 27 May 2011 08:49:58 +0200
Subject: [R-sig-Geo] {rgeos} readWKT - str_replace() function ??
In-Reply-To: <BANLkTim1EyGAbWdrSG5Xstxi5BGEo+DZgw@mail.gmail.com>
References: <BANLkTim1EyGAbWdrSG5Xstxi5BGEo+DZgw@mail.gmail.com>
Message-ID: <4DDF4996.3040808@uni-muenster.de>

You'll find it in package stringr; rgeos depends on this package.

On 05/27/2011 08:32 AM, Emmanuel Blondel wrote:
> Dear all,
> 
> Here a brief question about readWKT() function of rgeos package. I tried to
> apply it, but I got the message: could not find "str_replace" function.
> My question is: what is this function str_replace() / I know such function
> exists in PHP but I didnot find anything in R. Could somebody clarify this?
> 
> Thanks for your answers,
> 
> Best regards,
> Emmanuel
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From landis at isciences.com  Fri May 27 13:38:00 2011
From: landis at isciences.com (Matthew Landis)
Date: Fri, 27 May 2011 07:38:00 -0400
Subject: [R-sig-Geo] coarsening a grid
In-Reply-To: <BANLkTinxmkcR9-Wt8s=A_W_ZHW6EC5bmsA@mail.gmail.com>
References: <4DDC14D6.1040308@berkeley.edu>	<alpine.LRH.2.00.1105242301300.24563@reclus.nhh.no>	<9B597DE5AF080D418509A7E9F1E93EAF02079096@Exch2010MB-3.univ.dir.wwu.edu>
	<BANLkTinxmkcR9-Wt8s=A_W_ZHW6EC5bmsA@mail.gmail.com>
Message-ID: <4DDF8D18.20807@isciences.com>

Nick - note that for plotting, raster:::plot by default only plots a 
subset of the pixels.  You can use the 'maxpixels' argument to control 
how many pixels it uses.  See ?raster:::plot

On 5/26/2011 10:33 PM, Nick Matzke wrote:
> Thanks to both!  Even for plotting a large grid, these are good
> options for speeding that up where the full resolution isn't needed...

-- 
~~~~~~~~~~~~~~~~~~~~~~~~~~
Matthew Landis, Ph.D.
Research Scientist
ISciences, LLC
61 Main St. Suite 200
Burlington VT 05401
802.864.2999
~~~~~~~~~~~~~~~~~~~~~~~~~~


From sglish at hotmail.com  Sat May 28 18:18:30 2011
From: sglish at hotmail.com (Chris English)
Date: Sat, 28 May 2011 12:18:30 -0400
Subject: [R-sig-Geo] Creating SpatialGridDataFrame - unequal number of
	objects
Message-ID: <SNT117-W28BCE5C62C46CE5F059ECBC5790@phx.gbl>


Dear List:
I have a SpatialGrid for which I am trying to make adata.frame and thence a SpatialGridDataFrame.
I can't seem to get the size of data.frame and gridto match up. ?I assume I'm missing something straight forward.

?summary(grid1)Object of class SpatialGridCoordinates:? min ? ?maxx 0.5 1824.5y 0.5 1368.5Is projected: NA?proj4string : [NA]Number of points: 2Grid attributes:? cellcentre.offset cellsize cells.dimx ? ? ? ? ? ? ? ? 1 ? ? ? ?1 ? ? ?1824y ? ? ? ? ? ? ? ? 1 ? ? ? ?1 ? ? ?1368> help(str)> bike_mat<- matrix(rep(1368:1, each=1824), ncol=1824, byrow=TRUE)> bike_df<- as.data.frame(bike_mat)> bike_sgdf_1<- SpatialGridDataFrame(grid1,bike_df)Error in validityMethod(object) :?? unequal number of objects in full grid and data slot
Thank you for you assistance.
Chris 		 	   		  

From sglish at hotmail.com  Sat May 28 18:18:31 2011
From: sglish at hotmail.com (Chris English)
Date: Sat, 28 May 2011 12:18:31 -0400
Subject: [R-sig-Geo] Creating SpatialGridDataFrame - unequal number of
	objects
Message-ID: <SNT117-W187145F02EB0279D1884C8C5790@phx.gbl>


Dear List:
I have a SpatialGrid for which I am trying to make adata.frame and thence a SpatialGridDataFrame.
I can't seem to get the size of data.frame and gridto match up. ?I assume I'm missing something straight forward.

?summary(grid1)Object of class SpatialGridCoordinates:? min ? ?maxx 0.5 1824.5y 0.5 1368.5Is projected: NA?proj4string : [NA]Number of points: 2Grid attributes:? cellcentre.offset cellsize cells.dimx ? ? ? ? ? ? ? ? 1 ? ? ? ?1 ? ? ?1824y ? ? ? ? ? ? ? ? 1 ? ? ? ?1 ? ? ?1368> help(str)> bike_mat<- matrix(rep(1368:1, each=1824), ncol=1824, byrow=TRUE)> bike_df<- as.data.frame(bike_mat)> bike_sgdf_1<- SpatialGridDataFrame(grid1,bike_df)Error in validityMethod(object) :?? unequal number of objects in full grid and data slot
Thank you for you assistance.
Chris 		 	   		  

From yan_boulanger at hotmail.com  Sat May 28 19:30:45 2011
From: yan_boulanger at hotmail.com (Yan Boulanger)
Date: Sat, 28 May 2011 17:30:45 +0000
Subject: [R-sig-Geo] Problem with the skater function in spdep
In-Reply-To: <1304EA17-1820-45CB-960A-6400208E88B5@gmail.com>
References: <1304EA17-1820-45CB-960A-6400208E88B5@gmail.com>
Message-ID: <SNT124-W49828A9B2F7BB7DB10D35E8D790@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110528/0b03fd87/attachment.pl>

From yan_boulanger at hotmail.com  Sat May 28 19:35:33 2011
From: yan_boulanger at hotmail.com (Yan Boulanger)
Date: Sat, 28 May 2011 17:35:33 +0000
Subject: [R-sig-Geo] Problem with the skater function in spdep
In-Reply-To: <SNT124-W49828A9B2F7BB7DB10D35E8D790@phx.gbl>
References: <1304EA17-1820-45CB-960A-6400208E88B5@gmail.com>,
	<SNT124-W49828A9B2F7BB7DB10D35E8D790@phx.gbl>
Message-ID: <SNT124-w59F7DCD202B7E2F98DC4B38D790@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110528/d055e660/attachment.pl>

From tgriffin at uaex.edu  Sun May 29 01:39:09 2011
From: tgriffin at uaex.edu (Terry Griffin)
Date: Sat, 28 May 2011 18:39:09 -0500 (CDT)
Subject: [R-sig-Geo] Creating SpatialGridDataFrame - unequal number
	of	objects
Message-ID: <911240847.1117036.1306625949474.JavaMail.root@zmail.uaex.edu>



Terry Griffin, PhD
tgriffin at uaex.edu
501.249.6360

-----Original Message-----
From: Chris English <sglish at hotmail.com>
Sent: Saturday, May 28, 2011 11:20 AM
To: r-sig-geo at r-project.org
Subject: [R-sig-Geo] Creating SpatialGridDataFrame - unequal number of	objects


Dear List:
I have a SpatialGrid for which I am trying to make adata.frame and thence a SpatialGridDataFrame.
I can't seem to get the size of data.frame and gridto match up. ?I assume I'm missing something straight forward.

?summary(grid1)Object of class SpatialGridCoordinates:? min ? ?maxx 0.5 1824.5y 0.5 1368.5Is projected: NA?proj4string : [NA]Number of points: 2Grid attributes:? cellcentre.offset cellsize cells.dimx ? ? ? ? ? ? ? ? 1 ? ? ? ?1 ? ? ?1824y ? ? ? ? ? ? ? ? 1 ? ? ? ?1 ? ? ?1368> help(str)> bike_mat<- matrix(rep(1368:1, each=1824), ncol=1824, byrow=TRUE)> bike_df<- as.data.frame(bike_mat)> bike_sgdf_1<- SpatialGridDataFrame(grid1,bike_df)Error in validityMethod(object) :?? unequal number of objects in full grid and data slot
Thank you for you assistance.
Chris 		 	   		  
_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From edzer.pebesma at uni-muenster.de  Sun May 29 14:29:58 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sun, 29 May 2011 14:29:58 +0200
Subject: [R-sig-Geo] Creating SpatialGridDataFrame - unequal number of
 objects
In-Reply-To: <SNT117-W187145F02EB0279D1884C8C5790@phx.gbl>
References: <SNT117-W187145F02EB0279D1884C8C5790@phx.gbl>
Message-ID: <4DE23C46.4090607@uni-muenster.de>

Your example below is very hard to read. But if I understand it
correctly, the following change,

bike_df <- as.data.frame(as.vector(bike_mat))

may result in something that is syntactically correct; whether it does
what you want is not clear from the context.

Hth,


On 05/28/2011 06:18 PM, Chris English wrote:
> 
> Dear List:
> I have a SpatialGrid for which I am trying to make adata.frame and thence a SpatialGridDataFrame.
> I can't seem to get the size of data.frame and gridto match up.  I assume I'm missing something straight forward.
> 
>  summary(grid1)Object of class SpatialGridCoordinates:  min    maxx 0.5 1824.5y 0.5 1368.5Is projected: NA proj4string : [NA]Number of points: 2Grid attributes:  cellcentre.offset cellsize cells.dimx                 1        1      1824y                 1        1      1368> help(str)> bike_mat<- matrix(rep(1368:1, each=1824), ncol=1824, byrow=TRUE)> bike_df<- as.data.frame(bike_mat)> bike_sgdf_1<- SpatialGridDataFrame(grid1,bike_df)Error in validityMethod(object) :   unequal number of objects in full grid and data slot
> Thank you for you assistance.
> Chris 		 	   		  
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From sglish at hotmail.com  Sun May 29 19:22:17 2011
From: sglish at hotmail.com (Chris English)
Date: Sun, 29 May 2011 13:22:17 -0400
Subject: [R-sig-Geo] Creating SpatialGridDataFrame - unequal number of
 objects
In-Reply-To: <911240847.1117036.1306625949474.JavaMail.root@zmail.uaex.edu>
References: <911240847.1117036.1306625949474.JavaMail.root@zmail.uaex.edu>
Message-ID: <SNT117-W262E934DEB092BD2DB290AC5780@phx.gbl>



Re: [R-sig-Geo] R spatial matrix to SpatialGridDataFrameEdzer Pebesma
Tue, 26 Jan 2010 00:54:21 -0800?suggested the following to?Ian McCallum - herein adapted
?bike_1<- list(x = 1:1824, y = 1:1824, z = matrix(rep(1824:1, each=1824), ncol=1824, byrow=TRUE))
> bgrid<- GridTopology(cellcentre.offset = c(bike_1$x[1], bike_1$y[1]), cellsize =?+ c(bike_1$x[1], bike_1$y[1]), cells.dim = dim(bike_1$z))
> bike_1_sgdf<- SpatialGridDataFrame(bgrid, data.frame(depth =?+ as.vector(bike_1$z[,ncol(bike_1$z):1])))
> image(bike_1_sgdf, axes = TRUE)
This produces the highly desired and previously elusive SGDF. I would neverhave figured out the "data.frame(depth = & etc" myself and have plenty of examples ofSGDF's that contain none of the values I sought to show for my efforts.
This approach requires x=z and so my prior z=y is untenable. When viewed in imagethe values seem rotated clockwise 90 deg, which I guess is just matrix vs raster origin.?
I was hoping to?attain a grid of x= 1824, y= 1368, and z values descending?from 1368:1 by column. ?And thence create a Terragen file through rgdal.
I suppose I can rotate, clip & etc post rgdal but wonder if I can simplify my approach.
Thanks,Chris


----------------------------------------
> From: tgriffin at uaex.edu
> Subject: RE: [R-sig-Geo] Creating SpatialGridDataFrame - unequal number of objects
> Date: Sat, 28 May 2011 18:39:09 -0500
> To: sglish at hotmail.com; r-sig-geo at r-project.org
>
>
>
> Terry Griffin, PhD
> tgriffin at uaex.edu
> 501.249.6360
>
> -----Original Message-----
> From: Chris English 
> Sent: Saturday, May 28, 2011 11:20 AM
> To: r-sig-geo at r-project.org
> Subject: [R-sig-Geo] Creating SpatialGridDataFrame - unequal number of objects
>
>
> Dear List:
> I have a SpatialGrid for which I am trying to make adata.frame and thence a SpatialGridDataFrame.
> I can't seem to get the size of data.frame and gridto match up.  I assume I'm missing something straight forward.
>
>  summary(grid1)Object of class SpatialGridCoordinates:  min    maxx 0.5 1824.5y 0.5 1368.5Is projected: NA proj4string : [NA]Number of points: 2Grid attributes:  cellcentre.offset cellsize cells.dimx                 1        1      1824y                 1        1      1368> help(str)> bike_mat<- matrix(rep(1368:1, each=1824), ncol=1824, byrow=TRUE)> bike_df<- as.data.frame(bike_mat)> bike_sgdf_1<- SpatialGridDataFrame(grid1,bike_df)Error in validityMethod(object) :   unequal number of objects in full grid and data slot
> Thank you for you assistance.
> Chris
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
 		 	   		  

From HodgessE at uhd.edu  Sun May 29 21:16:26 2011
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Sun, 29 May 2011 14:16:26 -0500
Subject: [R-sig-Geo] newbie bbox type question
Message-ID: <586A4828D7AAA04CA9B258C50A28DA206DB81A@BALI.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110529/978e2993/attachment.pl>

From david.holstius at berkeley.edu  Sun May 29 21:59:53 2011
From: david.holstius at berkeley.edu (David Holstius)
Date: Sun, 29 May 2011 12:59:53 -0700
Subject: [R-sig-Geo] rectangular adjacency matrix/list: geo or graph
	packages?
Message-ID: <51790452-D6E3-40BC-B616-1052FC4100AC@berkeley.edu>

Hi all,

I'm searching for an efficient, preferably prepackaged, way to compute and store a rectangular adjacency matrix in R. All I'm using it for is to screen out a large number of unnecessary computations. I have no need for weighted edges, and the matrix would be pretty sparse. I found this thread from 2007:

  <https://stat.ethz.ch/pipermail/r-sig-geo/2007-May/002092.html>

Has anyone tackled this problem using the 'igraph' package? Or have recommendations for another library to use or keep an eye on? 

Many thanks,
David

--
David Holstius
PhD Student in Environmental Health Sciences
UC Berkeley School of Public Health


From lists at remoteinformation.com.au  Mon May 30 07:13:48 2011
From: lists at remoteinformation.com.au (Ben Madin)
Date: Mon, 30 May 2011 13:13:48 +0800
Subject: [R-sig-Geo] Converting Spatial Polygons to data frame for krige.conv
In-Reply-To: <4C75124D.50000@uni-muenster.de>
References: <AANLkTikm45REAjiyR0tYYtjJ4c1Ge3KU0ksHAa2b+Ebs@mail.gmail.com>
	<alpine.LRH.2.00.1008182047040.4275@reclus.nhh.no>
	<4C75124D.50000@uni-muenster.de>
Message-ID: <63890B78-05C9-44C6-AA34-97A70AF1195D@remoteinformation.com.au>

G'day,

I'm re-running some old models with new data, but in the same location as previously. In the past I had a text file with the border coordinates, but this is no longer anywhere to be found - thus I'm coming unstuck with krige.conv() and the borders option.

I have otherwise moved very happily into using sp classes for everything, so can load a set of boundaries from PostGIS in using rgdal but although I find discussion about this (see below) for SpatialPoints, I am stumped for a method to convert Spatial Polygons to a list of coordinates - I guess I could manually split the object into it's component polygons and then iterate through the coords ... but I was hoping that there might be a method that I've overlooked.

I confess I have also forgotten how I originally created the text file I had - there must have been a method, but I'm not sure I can remember where it was. (> 5years ago). I thought it was maptools, but all the maptools functions seem to read into sp classes...

cheers

Ben





> 	Subject: 	Re: [R-sig-Geo] Spatial data tower of babel
> 	Date: 	25 August 2010 8:53:33 PM AWST
> 
On 25/08/2010, at 8:53 PM, Edzer Pebesma wrote:

> Barry, what exactly did you try out before you posted?
> 
> Your claim is not completely true: geoR has a function
> as.geodata.SpatialPointsDataFrame, so you can do, for instance:
> 
> library(geoR)
> data(meuse) # from sp
> coordinates(meuse) = ~x+y
> krige.bayes(as.geodata(meuse, "zinc"))
> 
> and its locations argument can be a SpatialPoints object.
> 
> Best regards,
> 
> On 08/18/2010 09:05 PM, Roger Bivand wrote:
>> On Wed, 18 Aug 2010, Barry Rowlingson wrote:
>> 
>>> Hi,
>>> 
>>> Recently while teaching at SFU I hit the problem that infects R when
>>> many people work on similar projects - the multitude of data formats
>>> for similar data. The sp project was partly an attempt to give a
>>> standard format for spatial data but its widespread non-use in older
>>> packages causes trouble.
>>> 
>>> So for example I taught the students all about 'sp' objects, and then
>>> they had to use spatstat and splancs for some point-process stuff,
>>> then geoR for some kriging, none of which use sp objects.
>>> 
>>> So I figured maybe we need a whole load of 'as' functions that can
>>> convert between the various spatial data formats (there are more in
>>> CRAN, I am sure) to help us all out on this. Some of these functions
>>> may already exist, indeed I just found something about converting
>>> fairly raw x-y coordinate objects to SpatialPolygons hidden away in
>>> the SpatialEpi package (polygons2spatial.polygons).
>> 
>> Barry,
>> 
>> I think that spatstat is well provided for, mostly in maptools, but also
>> in the spatstat vignette on using shapefiles. Of course, the available
>> functionalities sp <-> spatstat classes could probably be documented
>> more fully, and the coercion functions updated, but I think that they do
>> most of what is needed.
>> 
>> I agree that there may be others out there, and like you come across
>> them from time to time. Sometimes the CRAN reverse dependencies show who
>> they might be. Since splancs is largely pre-S3 (right?) and doesn't use
>> classes, coercion isn't an option, so documentation and a wrapper
>> function or two might be sensible. I started on this, but only got as
>> far as the spkernel2d() that uses a call to GridTopology() to set up the
>> output grid.
>> 
>> geoR does use S3 classes, so might be closer, and does depend on sp.
>> There is a method for coercing a SpatialPointsDataFrame to "geodata".
>> The borders component of a "geodata" object is harder to introduce.
>> Taking the coordinates() of a SpatialPixels object to pass to locations=
>> is OK, as are the subsetting of data frame columns for the trend.d= and
>> trend.l= arguments. I guess Paulo would need to move to a formula= data=
>> interface to likfit(), krige.bayes() and krige.conv(), at least, to
>> permit sp objects to be used "closer" to the actual core.
>> 
>> Probably a good deal could be done by documentation, and by
>> communicating better about what already is there.
>> 
>> Useful topic!
>> 
>> Best wishes,
>> 
>> Roger
>> 
>>> 
>>> Would it be a good idea to stick all the conversions we can think of
>>> into a single package, "spBabel" say (or spConversion to avoid any
>>> cultural reference), so people have a one-stop shop? And if we find
>>> routines stuck in other packages (such as polygons2spatial.polygons)
>>> we rip them out and bundle them?
>>> 
>>> Yes, its a matter of time and effort and we're all busy, but I'd like
>>> to put it out as a proposal. It might make a nice intern or GSOC
>>> project, but we're a bit late for that, so maybe if anyone has a PhD
>>> student starting who needs to get up to speed with R packages and
>>> spatial data it would be a good introduction for them. Once its all
>>> set up (on R-forge or similar) contributing shouldn't be a problem.
>>> 
>>> Okay, that's my one crazy idea for the day done.
>>> 
>>> Barry
>>> 
>>> 
>>> 
>> 
> 
> -- 
> Edzer Pebesma
> Institute for Geoinformatics (ifgi), University of M?nster
> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
> 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
> http://www.52north.org/geostatistics      e.pebesma at wwu.de
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From edzer.pebesma at uni-muenster.de  Mon May 30 07:38:17 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 30 May 2011 07:38:17 +0200
Subject: [R-sig-Geo] newbie bbox type question
In-Reply-To: <586A4828D7AAA04CA9B258C50A28DA206DB81A@BALI.uhd.campus>
References: <586A4828D7AAA04CA9B258C50A28DA206DB81A@BALI.uhd.campus>
Message-ID: <4DE32D49.7000407@uni-muenster.de>

Hi Erin,

it is not clear to me whether your goal is to write the data with
writeOGR, or create spatio-temporal data objects and analyse / display
them. OGR (and writeOGR) intrinsically know nothing about time, so
having time as, say attribute columns is the only thing you could do
(AFAIK).

If you want to create space-time objects in R, you might want to try the
functions in package spacetime (e.g. STFDF(), or stConstruct()); when
you're new to the package, start by reading its vignette.

bbox is not something that can be set; coordinates can be set but only
refer to spatial coordinates. The Spatial* objects created by
coordinates<- are a building block for space-time objects.

Hth,

On 05/29/2011 09:16 PM, Hodgess, Erin wrote:
> Dear R Sig Geo People:
> 
> I have a large data frame which includes dates and times as columns.
> 
> I want to have one map (via writeOGR) which has the whole thing, and then have several maps by days.
> 
> However, I want the whole area as defined by the entire data set to show every day.
> 
> I looked at bbox but I can't set a bbox.
> 
> How would I set the coordinates, please?
> 
> Maybe use the coordinates function with the big set structure, please?
> 
> Thanks,
> Have a great weekend,
> Sincerely,
> Erin
> 
> 
> Erin M. Hodgess, PhD
> Associate Professor
> Department of Computer and Mathematical Sciences
> University of Houston - Downtown
> mailto: hodgesse at uhd.edu
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From edzer.pebesma at uni-muenster.de  Mon May 30 07:52:49 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 30 May 2011 07:52:49 +0200
Subject: [R-sig-Geo] Converting Spatial Polygons to data frame for
	krige.conv
In-Reply-To: <63890B78-05C9-44C6-AA34-97A70AF1195D@remoteinformation.com.au>
References: <AANLkTikm45REAjiyR0tYYtjJ4c1Ge3KU0ksHAa2b+Ebs@mail.gmail.com>	<alpine.LRH.2.00.1008182047040.4275@reclus.nhh.no>	<4C75124D.50000@uni-muenster.de>
	<63890B78-05C9-44C6-AA34-97A70AF1195D@remoteinformation.com.au>
Message-ID: <4DE330B1.6080606@uni-muenster.de>

Have you tried

> coordinates(obj)

?

It retrieves the polygon centroids as a matrix.

On 05/30/2011 07:13 AM, Ben Madin wrote:
> G'day,
> 
> I'm re-running some old models with new data, but in the same location as previously. In the past I had a text file with the border coordinates, but this is no longer anywhere to be found - thus I'm coming unstuck with krige.conv() and the borders option.
> 
> I have otherwise moved very happily into using sp classes for everything, so can load a set of boundaries from PostGIS in using rgdal but although I find discussion about this (see below) for SpatialPoints, I am stumped for a method to convert Spatial Polygons to a list of coordinates - I guess I could manually split the object into it's component polygons and then iterate through the coords ... but I was hoping that there might be a method that I've overlooked.
> 
> I confess I have also forgotten how I originally created the text file I had - there must have been a method, but I'm not sure I can remember where it was. (> 5years ago). I thought it was maptools, but all the maptools functions seem to read into sp classes...
> 
> cheers
> 
> Ben
> 
> 
> 
> 
> 
>> 	Subject: 	Re: [R-sig-Geo] Spatial data tower of babel
>> 	Date: 	25 August 2010 8:53:33 PM AWST
>>
> On 25/08/2010, at 8:53 PM, Edzer Pebesma wrote:
> 
>> Barry, what exactly did you try out before you posted?
>>
>> Your claim is not completely true: geoR has a function
>> as.geodata.SpatialPointsDataFrame, so you can do, for instance:
>>
>> library(geoR)
>> data(meuse) # from sp
>> coordinates(meuse) = ~x+y
>> krige.bayes(as.geodata(meuse, "zinc"))
>>
>> and its locations argument can be a SpatialPoints object.
>>
>> Best regards,
>>
>> On 08/18/2010 09:05 PM, Roger Bivand wrote:
>>> On Wed, 18 Aug 2010, Barry Rowlingson wrote:
>>>
>>>> Hi,
>>>>
>>>> Recently while teaching at SFU I hit the problem that infects R when
>>>> many people work on similar projects - the multitude of data formats
>>>> for similar data. The sp project was partly an attempt to give a
>>>> standard format for spatial data but its widespread non-use in older
>>>> packages causes trouble.
>>>>
>>>> So for example I taught the students all about 'sp' objects, and then
>>>> they had to use spatstat and splancs for some point-process stuff,
>>>> then geoR for some kriging, none of which use sp objects.
>>>>
>>>> So I figured maybe we need a whole load of 'as' functions that can
>>>> convert between the various spatial data formats (there are more in
>>>> CRAN, I am sure) to help us all out on this. Some of these functions
>>>> may already exist, indeed I just found something about converting
>>>> fairly raw x-y coordinate objects to SpatialPolygons hidden away in
>>>> the SpatialEpi package (polygons2spatial.polygons).
>>>
>>> Barry,
>>>
>>> I think that spatstat is well provided for, mostly in maptools, but also
>>> in the spatstat vignette on using shapefiles. Of course, the available
>>> functionalities sp <-> spatstat classes could probably be documented
>>> more fully, and the coercion functions updated, but I think that they do
>>> most of what is needed.
>>>
>>> I agree that there may be others out there, and like you come across
>>> them from time to time. Sometimes the CRAN reverse dependencies show who
>>> they might be. Since splancs is largely pre-S3 (right?) and doesn't use
>>> classes, coercion isn't an option, so documentation and a wrapper
>>> function or two might be sensible. I started on this, but only got as
>>> far as the spkernel2d() that uses a call to GridTopology() to set up the
>>> output grid.
>>>
>>> geoR does use S3 classes, so might be closer, and does depend on sp.
>>> There is a method for coercing a SpatialPointsDataFrame to "geodata".
>>> The borders component of a "geodata" object is harder to introduce.
>>> Taking the coordinates() of a SpatialPixels object to pass to locations=
>>> is OK, as are the subsetting of data frame columns for the trend.d= and
>>> trend.l= arguments. I guess Paulo would need to move to a formula= data=
>>> interface to likfit(), krige.bayes() and krige.conv(), at least, to
>>> permit sp objects to be used "closer" to the actual core.
>>>
>>> Probably a good deal could be done by documentation, and by
>>> communicating better about what already is there.
>>>
>>> Useful topic!
>>>
>>> Best wishes,
>>>
>>> Roger
>>>
>>>>
>>>> Would it be a good idea to stick all the conversions we can think of
>>>> into a single package, "spBabel" say (or spConversion to avoid any
>>>> cultural reference), so people have a one-stop shop? And if we find
>>>> routines stuck in other packages (such as polygons2spatial.polygons)
>>>> we rip them out and bundle them?
>>>>
>>>> Yes, its a matter of time and effort and we're all busy, but I'd like
>>>> to put it out as a proposal. It might make a nice intern or GSOC
>>>> project, but we're a bit late for that, so maybe if anyone has a PhD
>>>> student starting who needs to get up to speed with R packages and
>>>> spatial data it would be a good introduction for them. Once its all
>>>> set up (on R-forge or similar) contributing shouldn't be a problem.
>>>>
>>>> Okay, that's my one crazy idea for the day done.
>>>>
>>>> Barry
>>>>
>>>>
>>>>
>>>
>>
>> -- 
>> Edzer Pebesma
>> Institute for Geoinformatics (ifgi), University of M?nster
>> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
>> 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
>> http://www.52north.org/geostatistics      e.pebesma at wwu.de
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From tom.gottfried at tum.de  Mon May 30 08:24:07 2011
From: tom.gottfried at tum.de (Tom Gottfried)
Date: Mon, 30 May 2011 08:24:07 +0200
Subject: [R-sig-Geo] Converting Spatial Polygons to data frame for
	krige.conv
In-Reply-To: <63890B78-05C9-44C6-AA34-97A70AF1195D@remoteinformation.com.au>
References: <AANLkTikm45REAjiyR0tYYtjJ4c1Ge3KU0ksHAa2b+Ebs@mail.gmail.com>	<alpine.LRH.2.00.1008182047040.4275@reclus.nhh.no>	<4C75124D.50000@uni-muenster.de>
	<63890B78-05C9-44C6-AA34-97A70AF1195D@remoteinformation.com.au>
Message-ID: <4DE33807.3050909@tum.de>

Hi Ben,

do you want the coordinates of all the vertices of your polygons?
Have a look at ?geometry. But this doesn't take you down to a mere list of coordinates. There might 
be a more elegant way, but you can try that little function to achieve this:

     asText.SpatialPolygonsDataFrame <- function(obj){
         coords <- matrix(double(), ncol=3)
         for (Polygons in obj at polygons){
             for (Polygon in Polygons at Polygons){
                 coords <- rbind(coords,
                     cbind(as.integer(Polygons at ID), Polygon at coords),
                     c(as.integer(Polygons at ID), NA, NA))
                 }
             }
         return(coords)
         }

regards,
Tom

Am 30.05.2011 07:13, schrieb Ben Madin:
> G'day,
>
> I'm re-running some old models with new data, but in the same location as previously. In the past I had a text file with the border coordinates, but this is no longer anywhere to be found - thus I'm coming unstuck with krige.conv() and the borders option.
>
> I have otherwise moved very happily into using sp classes for everything, so can load a set of boundaries from PostGIS in using rgdal but although I find discussion about this (see below) for SpatialPoints, I am stumped for a method to convert Spatial Polygons to a list of coordinates - I guess I could manually split the object into it's component polygons and then iterate through the coords ... but I was hoping that there might be a method that I've overlooked.
>
> I confess I have also forgotten how I originally created the text file I had - there must have been a method, but I'm not sure I can remember where it was. (>  5years ago). I thought it was maptools, but all the maptools functions seem to read into sp classes...
>
> cheers
>
> Ben
>
>
>
>
>
>> 	Subject: 	Re: [R-sig-Geo] Spatial data tower of babel
>> 	Date: 	25 August 2010 8:53:33 PM AWST
>>
> On 25/08/2010, at 8:53 PM, Edzer Pebesma wrote:
>
>> Barry, what exactly did you try out before you posted?
>>
>> Your claim is not completely true: geoR has a function
>> as.geodata.SpatialPointsDataFrame, so you can do, for instance:
>>
>> library(geoR)
>> data(meuse) # from sp
>> coordinates(meuse) = ~x+y
>> krige.bayes(as.geodata(meuse, "zinc"))
>>
>> and its locations argument can be a SpatialPoints object.
>>
>> Best regards,
>>
>> On 08/18/2010 09:05 PM, Roger Bivand wrote:
>>> On Wed, 18 Aug 2010, Barry Rowlingson wrote:
>>>
>>>> Hi,
>>>>
>>>> Recently while teaching at SFU I hit the problem that infects R when
>>>> many people work on similar projects - the multitude of data formats
>>>> for similar data. The sp project was partly an attempt to give a
>>>> standard format for spatial data but its widespread non-use in older
>>>> packages causes trouble.
>>>>
>>>> So for example I taught the students all about 'sp' objects, and then
>>>> they had to use spatstat and splancs for some point-process stuff,
>>>> then geoR for some kriging, none of which use sp objects.
>>>>
>>>> So I figured maybe we need a whole load of 'as' functions that can
>>>> convert between the various spatial data formats (there are more in
>>>> CRAN, I am sure) to help us all out on this. Some of these functions
>>>> may already exist, indeed I just found something about converting
>>>> fairly raw x-y coordinate objects to SpatialPolygons hidden away in
>>>> the SpatialEpi package (polygons2spatial.polygons).
>>>
>>> Barry,
>>>
>>> I think that spatstat is well provided for, mostly in maptools, but also
>>> in the spatstat vignette on using shapefiles. Of course, the available
>>> functionalities sp<->  spatstat classes could probably be documented
>>> more fully, and the coercion functions updated, but I think that they do
>>> most of what is needed.
>>>
>>> I agree that there may be others out there, and like you come across
>>> them from time to time. Sometimes the CRAN reverse dependencies show who
>>> they might be. Since splancs is largely pre-S3 (right?) and doesn't use
>>> classes, coercion isn't an option, so documentation and a wrapper
>>> function or two might be sensible. I started on this, but only got as
>>> far as the spkernel2d() that uses a call to GridTopology() to set up the
>>> output grid.
>>>
>>> geoR does use S3 classes, so might be closer, and does depend on sp.
>>> There is a method for coercing a SpatialPointsDataFrame to "geodata".
>>> The borders component of a "geodata" object is harder to introduce.
>>> Taking the coordinates() of a SpatialPixels object to pass to locations=
>>> is OK, as are the subsetting of data frame columns for the trend.d= and
>>> trend.l= arguments. I guess Paulo would need to move to a formula= data=
>>> interface to likfit(), krige.bayes() and krige.conv(), at least, to
>>> permit sp objects to be used "closer" to the actual core.
>>>
>>> Probably a good deal could be done by documentation, and by
>>> communicating better about what already is there.
>>>
>>> Useful topic!
>>>
>>> Best wishes,
>>>
>>> Roger
>>>
>>>>
>>>> Would it be a good idea to stick all the conversions we can think of
>>>> into a single package, "spBabel" say (or spConversion to avoid any
>>>> cultural reference), so people have a one-stop shop? And if we find
>>>> routines stuck in other packages (such as polygons2spatial.polygons)
>>>> we rip them out and bundle them?
>>>>
>>>> Yes, its a matter of time and effort and we're all busy, but I'd like
>>>> to put it out as a proposal. It might make a nice intern or GSOC
>>>> project, but we're a bit late for that, so maybe if anyone has a PhD
>>>> student starting who needs to get up to speed with R packages and
>>>> spatial data it would be a good introduction for them. Once its all
>>>> set up (on R-forge or similar) contributing shouldn't be a problem.
>>>>
>>>> Okay, that's my one crazy idea for the day done.
>>>>
>>>> Barry
>>>>
>>>>
>>>>
>>>
>>
>> --
>> Edzer Pebesma
>> Institute for Geoinformatics (ifgi), University of M?nster
>> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
>> 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
>> http://www.52north.org/geostatistics      e.pebesma at wwu.de
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Technische Universit?t M?nchen
Department f?r Pflanzenwissenschaften
Lehrstuhl f?r Gr?nlandlehre
Alte Akademie 12
85350 Freising / Germany
Phone: ++49 (0)8161 715324
Fax:   ++49 (0)8161 713243
email: tom.gottfried at wzw.tum.de
http://www.wzw.tum.de/gruenland


From b.rowlingson at lancaster.ac.uk  Mon May 30 09:36:30 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Mon, 30 May 2011 08:36:30 +0100
Subject: [R-sig-Geo] newbie bbox type question
In-Reply-To: <586A4828D7AAA04CA9B258C50A28DA206DB81A@BALI.uhd.campus>
References: <586A4828D7AAA04CA9B258C50A28DA206DB81A@BALI.uhd.campus>
Message-ID: <BANLkTik2S+K-nRxbNQS_yfpCMCo_HBUdig@mail.gmail.com>

On Sun, May 29, 2011 at 8:16 PM, Hodgess, Erin <HodgessE at uhd.edu> wrote:

> I want to have one map (via writeOGR) which has the whole thing, and then have several maps by days.
>
> However, I want the whole area as defined by the entire data set to show every day.
>
> I looked at bbox but I can't set a bbox.

 I think the problem here is that writeOGR doesn't create maps, it
creates data files.

 If you wnt to create a map plot that is based on the bbox of a given
sp object, you can set up an empty plot from its bbox this way:

 > plot(SpatialPoints(t(bbox(m))),cex=0)

 two things to note: I use cex=0 so the points dont show up (because
type="n" doesnt work) and the bbox is transposed because of the way
its rows and columns are arranged.

 Then you can add stuff to the plot area, eg the first polygon:

 > plot(m[1,],add=TRUE)

Not sure if this is what you are really after since its not clear what
your 'map' is and where writeOGR fits into this...

Barry


From Roger.Bivand at nhh.no  Mon May 30 10:31:02 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 30 May 2011 10:31:02 +0200 (CEST)
Subject: [R-sig-Geo] newbie bbox type question
In-Reply-To: <BANLkTik2S+K-nRxbNQS_yfpCMCo_HBUdig@mail.gmail.com>
References: <586A4828D7AAA04CA9B258C50A28DA206DB81A@BALI.uhd.campus>
	<BANLkTik2S+K-nRxbNQS_yfpCMCo_HBUdig@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1105301028120.15211@reclus.nhh.no>

On Mon, 30 May 2011, Barry Rowlingson wrote:

> On Sun, May 29, 2011 at 8:16 PM, Hodgess, Erin <HodgessE at uhd.edu> wrote:
>
>> I want to have one map (via writeOGR) which has the whole thing, and then have several maps by days.
>>
>> However, I want the whole area as defined by the entire data set to show every day.
>>
>> I looked at bbox but I can't set a bbox.
>
> I think the problem here is that writeOGR doesn't create maps, it
> creates data files.
>
> If you wnt to create a map plot that is based on the bbox of a given
> sp object, you can set up an empty plot from its bbox this way:
>
> > plot(SpatialPoints(t(bbox(m))),cex=0)

Equivalently:

plot(as(m, "Spatial"))

which drops all the unnecessary stuff. I wasn't sure what was needed, 
either. It could be an output file with the data reshaped to "wide" from 
"long", but this is just another guess.

Roger

>
> two things to note: I use cex=0 so the points dont show up (because
> type="n" doesnt work) and the bbox is transposed because of the way
> its rows and columns are arranged.
>
> Then you can add stuff to the plot area, eg the first polygon:
>
> > plot(m[1,],add=TRUE)
>
> Not sure if this is what you are really after since its not clear what
> your 'map' is and where writeOGR fits into this...
>
> Barry
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From paul.hiemstra at knmi.nl  Mon May 30 11:59:24 2011
From: paul.hiemstra at knmi.nl (Paul Hiemstra)
Date: Mon, 30 May 2011 09:59:24 +0000
Subject: [R-sig-Geo] 2-D Scatter Plots from the Image
In-Reply-To: <BLU0-SMTP189DC67CD5211F18DF614D5B7770@phx.gbl>
References: <632FCB4B-EB34-4E62-9FE3-1895FD0ABF09@hotmail.com>
	<BLU0-SMTP189DC67CD5211F18DF614D5B7770@phx.gbl>
Message-ID: <4DE36A7C.3090902@knmi.nl>

 On 05/26/2011 02:54 PM, Gaspar Reyes P?ndigo wrote:
> Hi, Dear list 
>
> I have one question:
>
> How to make 2-D Scatter Plots from the Image (p.e. landsat band 4 vs 3) in R, is it possible?
>
>
> ------------------------------
> Gaspar Reyes P?ndigo
> Universidad del Mar, Oaxaca, M?xico
> Campus Puerto-?ngel
> Carretera principal Puerto ?ngel Zipolite km 1.5 
> C.P. 70902
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
Hi,

Take a look at any of the plotting packages in R: the standard plotting,
lattice or ggplot (I prefer the latter). Using the standard plotting
facilities:

library(gstat)
loadMeuse()
plot(meuse.grid$dist, meuse.grid$soil)

cheers,
Paul

-- 
Paul Hiemstra, Ph.D.
Global Climate Division
Royal Netherlands Meteorological Institute (KNMI)
Wilhelminalaan 10 | 3732 GK | De Bilt | Kamer B 3.39
P.O. Box 201 | 3730 AE | De Bilt
tel: +31 30 2206 494

http://intamap.geo.uu.nl/~paul
http://nl.linkedin.com/pub/paul-hiemstra/20/30b/770


From b.rowlingson at lancaster.ac.uk  Mon May 30 16:05:58 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Mon, 30 May 2011 15:05:58 +0100
Subject: [R-sig-Geo] newbie bbox type question
In-Reply-To: <alpine.LRH.2.00.1105301028120.15211@reclus.nhh.no>
References: <586A4828D7AAA04CA9B258C50A28DA206DB81A@BALI.uhd.campus>
	<BANLkTik2S+K-nRxbNQS_yfpCMCo_HBUdig@mail.gmail.com>
	<alpine.LRH.2.00.1105301028120.15211@reclus.nhh.no>
Message-ID: <BANLkTik_n+e4gi8OSksxWG3Vd-s4Q6cgig@mail.gmail.com>

 > plot(as(m, "Spatial"))

 Coercion with 'as' seems to fail for me:

 > rb=bbox(r)
 > rb
        min       max
x -2.840466 -2.342137
y 54.042700 54.339724
 > as(rb,"Spatial")

Error in as(rb, "Spatial") :
  no method or default for coercing "matrix" to "Spatial"

but using Spatial() works:

 plot(Spatial(rb))

despite the warning about Spatial being an abstract class...


> which drops all the unnecessary stuff. I wasn't sure what was needed,
> either. It could be an output file with the data reshaped to "wide" from
> "long", but this is just another guess.

 Texas may be awake now, but I think it might be a holiday in the USA...

Barry


From Roger.Bivand at nhh.no  Mon May 30 16:20:43 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 30 May 2011 16:20:43 +0200 (CEST)
Subject: [R-sig-Geo] newbie bbox type question
In-Reply-To: <BANLkTik_n+e4gi8OSksxWG3Vd-s4Q6cgig@mail.gmail.com>
References: <586A4828D7AAA04CA9B258C50A28DA206DB81A@BALI.uhd.campus>
	<BANLkTik2S+K-nRxbNQS_yfpCMCo_HBUdig@mail.gmail.com>
	<alpine.LRH.2.00.1105301028120.15211@reclus.nhh.no>
	<BANLkTik_n+e4gi8OSksxWG3Vd-s4Q6cgig@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1105301618560.16076@reclus.nhh.no>

On Mon, 30 May 2011, Barry Rowlingson wrote:

>
> > plot(as(m, "Spatial"))
>
> Coercion with 'as' seems to fail for me:
>
> > rb=bbox(r)
> > rb
>        min       max
> x -2.840466 -2.342137
> y 54.042700 54.339724
> > as(rb,"Spatial")
>
> Error in as(rb, "Spatial") :
>  no method or default for coercing "matrix" to "Spatial"
>
> but using Spatial() works:
>
> plot(Spatial(rb))

Would plot(as(rb, "Spatial")) work - the object needs to be just "Spatial" 
to just set up the plot device? I didn't check what was what carefully 
enough.

Roger

>
> despite the warning about Spatial being an abstract class...
>
>
>> which drops all the unnecessary stuff. I wasn't sure what was needed,
>> either. It could be an output file with the data reshaped to "wide" from
>> "long", but this is just another guess.
>
> Texas may be awake now, but I think it might be a holiday in the USA...
>
> Barry
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Mon May 30 16:27:22 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 30 May 2011 16:27:22 +0200 (CEST)
Subject: [R-sig-Geo] newbie bbox type question
In-Reply-To: <alpine.LRH.2.00.1105301618560.16076@reclus.nhh.no>
References: <586A4828D7AAA04CA9B258C50A28DA206DB81A@BALI.uhd.campus>
	<BANLkTik2S+K-nRxbNQS_yfpCMCo_HBUdig@mail.gmail.com>
	<alpine.LRH.2.00.1105301028120.15211@reclus.nhh.no>
	<BANLkTik_n+e4gi8OSksxWG3Vd-s4Q6cgig@mail.gmail.com>
	<alpine.LRH.2.00.1105301618560.16076@reclus.nhh.no>
Message-ID: <alpine.LRH.2.00.1105301626440.16076@reclus.nhh.no>

On Mon, 30 May 2011, Roger Bivand wrote:

> On Mon, 30 May 2011, Barry Rowlingson wrote:
>
>> 
>> > plot(as(m, "Spatial"))
>> 
>> Coercion with 'as' seems to fail for me:
>> 
>> > rb=bbox(r)
>> > rb
>>        min       max
>> x -2.840466 -2.342137
>> y 54.042700 54.339724
>> > as(rb,"Spatial")
>> 
>> Error in as(rb, "Spatial") :
>>  no method or default for coercing "matrix" to "Spatial"
>> 
>> but using Spatial() works:
>> 
>> plot(Spatial(rb))
>
> Would plot(as(rb, "Spatial")) work - the object needs to be just "Spatial" to 
> just set up the plot device? I didn't check what was what carefully enough.


Ahh - plot(as(r, "Spatial")) ...

>
> Roger
>
>> 
>> despite the warning about Spatial being an abstract class...
>> 
>> 
>>> which drops all the unnecessary stuff. I wasn't sure what was needed,
>>> either. It could be an output file with the data reshaped to "wide" from
>>> "long", but this is just another guess.
>> 
>> Texas may be awake now, but I think it might be a holiday in the USA...
>> 
>> Barry
>> 
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From lists at remoteinformation.com.au  Mon May 30 18:28:15 2011
From: lists at remoteinformation.com.au (Ben Madin)
Date: Tue, 31 May 2011 00:28:15 +0800
Subject: [R-sig-Geo] Converting Spatial Polygons to data frame for
	krige.conv
In-Reply-To: <4DE33807.3050909@tum.de>
References: <AANLkTikm45REAjiyR0tYYtjJ4c1Ge3KU0ksHAa2b+Ebs@mail.gmail.com>	<alpine.LRH.2.00.1008182047040.4275@reclus.nhh.no>	<4C75124D.50000@uni-muenster.de>
	<63890B78-05C9-44C6-AA34-97A70AF1195D@remoteinformation.com.au>
	<4DE33807.3050909@tum.de>
Message-ID: <0879F172-B5E8-4BAD-A024-1DA1100DBF77@remoteinformation.com.au>

Thanks Tom,

On 30/05/2011, at 2:24 PM, Tom Gottfried wrote:

> do you want the coordinates of all the vertices of your polygons?
> Have a look at ?geometry. But this doesn't take you down to a mere list of coordinates. There might be a more elegant way, but you can try that little function to achieve this:
> 
>    asText.SpatialPolygonsDataFrame <- function(obj){
>        coords <- matrix(double(), ncol=3)
>        for (Polygons in obj at polygons){
>            for (Polygon in Polygons at Polygons){
>                coords <- rbind(coords,
>                    cbind(as.integer(Polygons at ID), Polygon at coords),
>                    c(as.integer(Polygons at ID), NA, NA))
>                }
>            }
>        return(coords)
>        }

Perfect. It's where I thought I was going, but it probably would have taken me about two days!

cheers

Ben


From rhunne at mac.com  Mon May 30 22:40:59 2011
From: rhunne at mac.com (Robin W Hunnewell)
Date: Mon, 30 May 2011 20:40:59 +0000 (GMT)
Subject: [R-sig-Geo] pixellating multiple polygon data
Message-ID: <fdee9b21-c0fe-efce-93ab-a398d05a4841@me.com>

Hi,

I'd seeking a way to handle multiple polygon data as a spatial pattern. I know?superimpose {spatstat} allows one to?superimpose multiple point patterns or line segment patterns, but is there any way to do this for a set of polygon features? ?Similarly,?'pixellate.owin' {spatstat} allows the user to convert a window to a pixel image by measuring the area of intersection between the windows and each pixel in a raster. But is there a way to do this for a window that contains multiple polygon features?

To explain, I have a SpatialPolygonsDataFrame (SPDF) with 14 constituent objects.?Each polygon represents a different observation window used on different dates. The windows cross-over and overlap within a composite search window.?I've managed to coerce the SPDF to an 'owin' in spatstat, and then pixellate it as an 'im' object. But I can't then assign the composite window that I want to this pixel image.

The multiple feature owin was created from .shp file (readShapePoly) as SpatialPoygonsDataFrame and then as window with <- as(x, "owin"). ?To prevent error when spatstat.options(checkpolygons=TRUE) ?"Error in owin(poly = opls) : ?Polygon data contain overlaps between polygons," ?I temporarily set checkpolygons=FALSE so that the garbled polygon data could be accepted:

> summary(Bpaths.owin)
Window: polygonal boundary
14 separate polygons (no holes)
?? ? ? ? ? ?vertices ? ?area relative.area
polygon 1 ? ? ? 8276 196.270 ? ? ? ?0.0722
polygon 2 ? ? ? 7536 193.306 ? ? ? ?0.0712
polygon 3 ? ? ? 8177 193.257 ? ? ? ?0.0711
polygon 4 ? ? ? 7683 194.428 ? ? ? ?0.0716
polygon 5 ? ? ? 8144 193.848 ? ? ? ?0.0714
polygon 6 ? ? ? 7995 193.967 ? ? ? ?0.0714
polygon 7 ? ? ? 7693 196.711 ? ? ? ?0.0724
polygon 8 ? ? ? 7904 191.466 ? ? ? ?0.0705
polygon 9 ? ? ? 7074 191.830 ? ? ? ?0.0706
polygon 10 ? ? ?6274 192.397 ? ? ? ?0.0708
polygon 11 ? ? ?9189 202.067 ? ? ? ?0.0744
polygon 12 ? ? ?6422 192.339 ? ? ? ?0.0708
polygon 13 ? ? ?6809 189.818 ? ? ? ?0.0699
polygon 14 ? ? ?8095 195.107 ? ? ? ?0.0718
enclosing rectangle: [686.7108, 719.9453]x[4886.263, 4926.089]kilometer
Window area = ?2716.81 square kilometer?
Unit of length: 1 kilometer?


I also created the composite search window, computed from the geometric union of the constituent polygons in ArcGIS, and read in as a single feature .shp file and then as a single feature owin:

> summary(W3)
Window: polygonal boundary
single connected closed polygon with 8095 vertices
enclosing rectangle: [686.7108, 719.9453]x[4886.263, 4926.137]kilometer
Window area = ?526.371 square kilometer?
Unit of length: 1 kilometer?


I was able to pixellate the multi-polygon 'Bpaths.owin' object on a fine grid;

> summary(Bpaths.pix)
real-valued pixel image
600 x 600 pixel array (ny, nx)
enclosing rectangle: [686.710843032164, 719.945292821527] x [4886.26281350552, 4926.08940155008] kilometer
dimensions of each pixel: 0.0554 x 0.0664 kilometer?
Image is defined on the full rectangular grid
Frame area = ?1323.61474064852 square kilometer?
Pixel values :
	range = [0,0.0514739065807758]
	integral = 9.98891868259874
	mean = 0.00754669646373897


But what I really want is to assign the correct single-poly, composite window [W3] to this 'im', so that my pixel?Image is defined on a subset of the rectangular grid -- set by W3.
Basically I'm trying to?convert a multi-feature window to a pixel image by measuring the area of intersection between all the constituent windows in the pattern and each pixel in a raster.
The impetus is to generate raster data that shows density surface of survey coverage,?as this is an integral spatial covariate for the distribution of points in my study.. ?I know you can perform 'densityppp' and 'density.psp' for kernel density on points and lines, but haven't been able to find ways to extend this to a pattern of polygons.

Apologies if I'm missing something basic as to why such functionality is either not tenable or feasible??
Thanks greatly for your patience and help!
Robin



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110530/80eb8f88/attachment.html>

From hilton at meteo.psu.edu  Mon May 30 23:00:44 2011
From: hilton at meteo.psu.edu (Timothy W. Hilton)
Date: Mon, 30 May 2011 14:00:44 -0700
Subject: [R-sig-Geo] spplot: overlay colored points on grid
Message-ID: <20110530210021.GA2170@Tim.local>

R-sig-geo folks,

I'm trying to plot a SpatialPointsDataFrame over a SpatialGridDataFrame,
with both the points and the grid colored by the same color scale.  I
can get either one separately, but I haven't been able to combine them.
Code to reproduce my problem below.  The real data are results from
krige(), and I'd like to plot observations on top of the interpolated
field.

Ideally, I'd like to give the points a black outline, with a filled
background according to the value, like
plot(rnorm(10), pch=21, col="black", bg=cols)  ## cols from code below

Many thanks!
Tim

## set up a color scheme
cols <- c("#40004B", "#762A83", "#9970AB", "#C2A5CF", "#E7D4E8", "#D9F0D3", 
          "#A6DBA0", "#5AAE61", "#1B7837", "#00441B")
colbreaks <- seq(0, 1.0, by=0.1)

## make a 10x10 SpatialGridDataFrame w/ random data
grd <- SpatialGrid(grid = GridTopology(c(0,0), c(1,1), c(10,10)))
df <- SpatialGridDataFrame(grid=grd, data=data.frame(z=rnorm(nrow(coordinates(grd)))))

## make a SpatialPointsDataFrame with 15 points with random data
pts <- data.frame(x=round(runif(15) * 10),
                  y=round(runif(15) * 10),
                  z=runif(15))
coordinates(pts) <- ~x+y

## this plots the grid the way I want it plotted
spplot(df, col.regions=cols, at=colbreaks)

## this plots the points the way I'd like to
dev.new()
spplot(pts, zcol="z", col.regions=cols, cuts=colbreaks, key.space="right", pch=16, fill=TRUE)

## I can't figure out how to get the points colored by their value, like
## in the previous plot
dev.new()
spplot(df, col.regions=cols, at=colbreaks,
       sp.layout=list("sp.points", pts, pch=21, cuts=colbreaks),
       main="not quite right")


From lists at remoteinformation.com.au  Tue May 31 07:43:15 2011
From: lists at remoteinformation.com.au (Ben Madin)
Date: Tue, 31 May 2011 13:43:15 +0800
Subject: [R-sig-Geo] Advice on Citation for geoR
Message-ID: <B0DC9037-E179-42A3-9C23-8030D62899CC@remoteinformation.com.au>

G'day,

I am just checking - the citation('geoR') command returns :

  @Article{,
    title = {geo{R}: a package for geostatistical analysis},
    author = {Paulo J. Ribeiro Jr and Peter J. Diggle},
    journal = {R-NEWS},
    year = {2001},
    month = {June},
    volume = {1},
    number = {2},
    pages = {14--18},
    note = {ISSN 1609-3631},
    url = {http://CRAN.R-project.org/doc/Rnews/},
  }

whereas rgdal returns :

  @Manual{,
    title = {rgdal: Bindings for the Geospatial Data Abstraction Library},
    author = {Timothy H. Keitt and Roger Bivand and Edzer Pebesma and Barry Rowlingson},
    year = {2010},
    note = {R package version 0.6-33},
    url = {http://CRAN.R-project.org/package=rgdal},
  }

Using the article citation is fine, but I haven't read the R-news article, and feel that the manual pages for geoR are probably more up to date... and the information in the R-news article may be somewhat outdated.

From an academic perspective, am I bette to cite the manual using a similar style to rgdal?

cheers

Ben


From Roger.Bivand at nhh.no  Tue May 31 08:06:50 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 31 May 2011 08:06:50 +0200 (CEST)
Subject: [R-sig-Geo] Advice on Citation for geoR
In-Reply-To: <B0DC9037-E179-42A3-9C23-8030D62899CC@remoteinformation.com.au>
References: <B0DC9037-E179-42A3-9C23-8030D62899CC@remoteinformation.com.au>
Message-ID: <alpine.LRH.2.00.1105310800540.18674@reclus.nhh.no>

On Tue, 31 May 2011, Ben Madin wrote:

> G'day,
>
> I am just checking - the citation('geoR') command returns :
>
>  @Article{,
>    title = {geo{R}: a package for geostatistical analysis},
>    author = {Paulo J. Ribeiro Jr and Peter J. Diggle},
>    journal = {R-NEWS},
>    year = {2001},
>    month = {June},
>    volume = {1},
>    number = {2},
>    pages = {14--18},
>    note = {ISSN 1609-3631},
>    url = {http://CRAN.R-project.org/doc/Rnews/},
>  }
>
> whereas rgdal returns :
>
>  @Manual{,
>    title = {rgdal: Bindings for the Geospatial Data Abstraction Library},
>    author = {Timothy H. Keitt and Roger Bivand and Edzer Pebesma and Barry Rowlingson},
>    year = {2010},
>    note = {R package version 0.6-33},
>    url = {http://CRAN.R-project.org/package=rgdal},
>  }
>
> Using the article citation is fine, but I haven't read the R-news 
> article, and feel that the manual pages for geoR are probably more up to 
> date... and the information in the R-news article may be somewhat 
> outdated.

R-News is online, so you could check. I suspect that citation() should 
also give:

@book{Diggle+Ribeiro:2007,
    title ={Model-Based Geostatistics},
    author = { Diggle, P. J. and {Ribeiro Jr.}, P. J.},
    publisher = { Springer },
    address = {New York},
    year = {	2007 }
}

which covers geoR in detail. Ideally, the package CITATION file should be 
kept up to date, but I don't think that package maintainers focus on this.
>
> From an academic perspective, am I bette to cite the manual using a 
> similar style to rgdal?

Happily, more journals are letting us cite both manuals and the software 
itself, so citation by default gives the software reference.

Roger

>
> cheers
>
> Ben
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From edzer.pebesma at uni-muenster.de  Tue May 31 08:09:27 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 31 May 2011 08:09:27 +0200
Subject: [R-sig-Geo] spplot: overlay colored points on grid
In-Reply-To: <20110530210021.GA2170@Tim.local>
References: <20110530210021.GA2170@Tim.local>
Message-ID: <4DE48617.70506@uni-muenster.de>

Tim, maybe this works:

pts$col = findInterval(pts$z, colbreaks)
spplot(df, col.regions=cols, at=colbreaks,
       sp.layout=list(list("sp.points", pts, pch=21, col=1,cex=1.8),
       list("sp.points", pts, col = cols[pts$col], pch=16,cex=1.6)),
       main="maybe right")

plotting pts twice is a bit of a hack; you need to get the cex arguments
right by tweaking them somewhat.

Hth,

On 05/30/2011 11:00 PM, Timothy W. Hilton wrote:
> R-sig-geo folks,
> 
> I'm trying to plot a SpatialPointsDataFrame over a SpatialGridDataFrame,
> with both the points and the grid colored by the same color scale.  I
> can get either one separately, but I haven't been able to combine them.
> Code to reproduce my problem below.  The real data are results from
> krige(), and I'd like to plot observations on top of the interpolated
> field.
> 
> Ideally, I'd like to give the points a black outline, with a filled
> background according to the value, like
> plot(rnorm(10), pch=21, col="black", bg=cols)  ## cols from code below
> 
> Many thanks!
> Tim
> 
> ## set up a color scheme
> cols <- c("#40004B", "#762A83", "#9970AB", "#C2A5CF", "#E7D4E8", "#D9F0D3", 
>           "#A6DBA0", "#5AAE61", "#1B7837", "#00441B")
> colbreaks <- seq(0, 1.0, by=0.1)
> 
> ## make a 10x10 SpatialGridDataFrame w/ random data
> grd <- SpatialGrid(grid = GridTopology(c(0,0), c(1,1), c(10,10)))
> df <- SpatialGridDataFrame(grid=grd, data=data.frame(z=rnorm(nrow(coordinates(grd)))))
> 
> ## make a SpatialPointsDataFrame with 15 points with random data
> pts <- data.frame(x=round(runif(15) * 10),
>                   y=round(runif(15) * 10),
>                   z=runif(15))
> coordinates(pts) <- ~x+y
> 
> ## this plots the grid the way I want it plotted
> spplot(df, col.regions=cols, at=colbreaks)
> 
> ## this plots the points the way I'd like to
> dev.new()
> spplot(pts, zcol="z", col.regions=cols, cuts=colbreaks, key.space="right", pch=16, fill=TRUE)
> 
> ## I can't figure out how to get the points colored by their value, like
> ## in the previous plot
> dev.new()
> spplot(df, col.regions=cols, at=colbreaks,
>        sp.layout=list("sp.points", pts, pch=21, cuts=colbreaks),
>        main="not quite right")
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From rhunne at mac.com  Tue May 31 18:25:58 2011
From: rhunne at mac.com (Robin W Hunnewell)
Date: Tue, 31 May 2011 16:25:58 +0000 (GMT)
Subject: [R-sig-Geo] pixellate.owin when "owin" contains separate,
	overlapping polygons
Message-ID: <1d7deb28-eef2-4b32-9342-ce912ae613ae@me.com>

Dear R-sig Geo listers,

sorry for my longwinded post, maybe I could try again..?

I've used pixellate.owin() to convert an object of class "owin" to a pixel image -- the owin in question is unusual in that it contains multiple, overlapping polygons.

Now I'd like to?change (constrict) the frame area of a resulting "im" object by assigning?a different and smaller window to it, using pixellate.owin ?
## S3 method for class 'owin'
pixellate(x, W = NULL, ...)
where?W is?Optional - Window determining the pixel raster on which the conversion should occur.

It works perfectly when converting a line segment pattern (pixellate.psp) to pixel image. The resulting "im" is clipped by an assigned, smaller window.?But when I try the same with an owin object, it doesn't seem to work I either get an error, when trying it out on a normal (single polygon) owin object:?

Error in pixellate.owin() :??W does not cover the domain of x

But when trying it out on my multi-polygon owin object, the frame area barely changes and I can't control the pixel resolution of the resulting image. See code below.
I'm sure I'm missing something basic about windows and pixellating them. If my question is not up to standards for this List, I'll stop perstering, just wanted to try again.
I'd?be grateful any help, thank you!!



## convert line segment object to a pixel image
> A <- pixellate(Depth, dimyx=200)
> summary(A)
real-valued pixel image
200 x 200 pixel array (ny, nx)
...?
Image is defined on the full rectangular grid
Frame area = ?3336.49966365421 square kilometer?

## now assign a smaller window to the same line segment object being converted to pixel image
> A2 <- pixellate(Depth, W=convexW3, dimyx=200)
> summary(A2)
real-valued pixel image
200 x 200 pixel array (ny, nx)
...?
Image is defined on a subset of the rectangular grid
Subset area = ?747.515033662265 square units?


## All works well
## now when I try same thing to my owin object (which contains multiple polygons), the frame area stays same - if anything increasing just a tiny bit
##pixellate owin object
> A <- pixellate(Mowin, dimyx=200)
> summary(A)
real-valued pixel image
200 x 200 pixel array (ny, nx)
...
Image is defined on the full rectangular grid
Frame area = ?1323.61474064852 square kilometer?

## now assign a smaller window to the same owin object being converted to pixel image
> A2 <- pixellate(Mowin, W=W3, dimyx=200)
> summary(A2)
real-valued pixel image
200 x 200 pixel array (ny, nx)
...
Image is defined on the full rectangular grid
Frame area = ?1325.20504128399 square kilometer?




-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110531/6e0bf90a/attachment.html>

