From massimodisasha at yahoo.it  Fri Feb  2 01:54:39 2007
From: massimodisasha at yahoo.it (epifanio)
Date: Fri, 2 Feb 2007 01:54:39 +0100
Subject: [R-sig-Geo] rgdal update
Message-ID: <D996C1EC-0CE8-4A9D-99BF-70F3203076EB@yahoo.it>

hi,
i'm trying to update the rgdal package,
but i have this error :

computer-di-epifanio:~ epifanio$ R CMD install --with-configure- 
args='--with-gdal-config=/Library/Frameworks/GDAL.framework/Versions/ 
1.4/Programs/gdal-config' /Users/epifanio/Desktop/rgdal_0.5-6.tar.gz
WARNING: invalid package '--with-configure-args=--with-gdal-config=/ 
Library/Frameworks/GDAL.framework/Versions/1.4/Programs/gdal-config'
* Installing *source* package 'rgdal' ...
gdal-config: gdal-config
checking for gcc... gcc-4.0 -arch i386
checking for C compiler default output file name... a.out
checking whether the C compiler works... yes
checking whether we are cross compiling... no
checking for suffix of executables...
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether gcc-4.0 -arch i386 accepts -g... yes
checking for gcc-4.0 -arch i386 option to accept ANSI C... none needed
checking how to run the C preprocessor... gcc-4.0 -arch i386 -E
checking for egrep... grep -E
checking for ANSI C header files... yes
checking for sys/types.h... yes
checking for sys/stat.h... yes
checking for stdlib.h... yes
checking for string.h... yes
checking for memory.h... yes
checking for strings.h... yes
checking for inttypes.h... yes
checking for stdint.h... yes
checking for unistd.h... yes
checking proj_api.h usability... yes
checking proj_api.h presence... yes
checking for proj_api.h... yes
checking for pj_init_plus in -lproj... yes
Package CPP flags: -I/Library/Frameworks/GDAL.framework/unix/include
Package LIBS: -L/Library/Frameworks/GDAL.framework/unix/lib -lgdal
configure: creating ./config.status
config.status: creating src/Makevars
** libs
** arch - i386
g++-4.0 -arch i386 -I/Library/Frameworks/R.framework/Resources/ 
include -I/Library/Frameworks/R.framework/Resources/include/i386 -I/ 
Library/Frameworks/GDAL.framework/unix/include -msse3    -fPIC  -g - 
O2 -march=nocona -c OGR_write.cpp -o OGR_write.o
/var/tmp//ccKIx4jK.s:3370:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:3385:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:3400:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:3415:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:3430:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:3445:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:3460:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:3475:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:3494:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:3509:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:3524:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:3539:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:3554:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:3569:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:3584:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:3599:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:3614:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:3629:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:3644:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:3659:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:3674:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:3689:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:3704:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:3719:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:3734:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:3749:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:3764:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:3779:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:3794:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:3809:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:3824:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:3839:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:3854:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:3869:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:3884:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:3899:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:3914:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:3929:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:3944:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:3963:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:3978:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:3993:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:4008:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:4023:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:4038:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:4053:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:4068:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:4083:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:4098:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:4113:indirect jmp without `*'
/var/tmp//ccKIx4jK.s:4128:indirect jmp without `*'
g++-4.0 -arch i386 -I/Library/Frameworks/R.framework/Resources/ 
include -I/Library/Frameworks/R.framework/Resources/include/i386 -I/ 
Library/Frameworks/GDAL.framework/unix/include -msse3    -fPIC  -g - 
O2 -march=nocona -c gdal-bindings.cpp -o gdal-bindings.o
/var/tmp//ccGf6H76.s:6598:indirect jmp without `*'
/var/tmp//ccGf6H76.s:6613:indirect jmp without `*'
/var/tmp//ccGf6H76.s:6628:indirect jmp without `*'
/var/tmp//ccGf6H76.s:6643:indirect jmp without `*'
/var/tmp//ccGf6H76.s:6658:indirect jmp without `*'
/var/tmp//ccGf6H76.s:6673:indirect jmp without `*'
/var/tmp//ccGf6H76.s:6688:indirect jmp without `*'
/var/tmp//ccGf6H76.s:6703:indirect jmp without `*'
/var/tmp//ccGf6H76.s:6718:indirect jmp without `*'
/var/tmp//ccGf6H76.s:6733:indirect jmp without `*'
/var/tmp//ccGf6H76.s:6748:indirect jmp without `*'
/var/tmp//ccGf6H76.s:6763:indirect jmp without `*'
/var/tmp//ccGf6H76.s:6778:indirect jmp without `*'
/var/tmp//ccGf6H76.s:6793:indirect jmp without `*'
/var/tmp//ccGf6H76.s:6808:indirect jmp without `*'
/var/tmp//ccGf6H76.s:6823:indirect jmp without `*'
/var/tmp//ccGf6H76.s:6838:indirect jmp without `*'
/var/tmp//ccGf6H76.s:6853:indirect jmp without `*'
/var/tmp//ccGf6H76.s:6868:indirect jmp without `*'
/var/tmp//ccGf6H76.s:6883:indirect jmp without `*'
/var/tmp//ccGf6H76.s:6898:indirect jmp without `*'
/var/tmp//ccGf6H76.s:6913:indirect jmp without `*'
/var/tmp//ccGf6H76.s:6928:indirect jmp without `*'
/var/tmp//ccGf6H76.s:6943:indirect jmp without `*'
/var/tmp//ccGf6H76.s:6958:indirect jmp without `*'
/var/tmp//ccGf6H76.s:6973:indirect jmp without `*'
/var/tmp//ccGf6H76.s:6992:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7007:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7022:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7037:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7052:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7067:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7082:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7097:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7112:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7127:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7142:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7157:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7172:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7187:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7202:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7217:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7232:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7247:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7266:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7281:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7296:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7311:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7326:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7341:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7356:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7371:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7386:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7401:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7416:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7431:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7450:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7465:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7480:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7495:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7514:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7529:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7548:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7563:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7578:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7593:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7608:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7623:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7638:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7653:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7668:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7683:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7698:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7713:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7728:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7743:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7758:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7773:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7788:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7803:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7818:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7833:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7848:indirect jmp without `*'
/var/tmp//ccGf6H76.s:7863:indirect jmp without `*'
g++-4.0 -arch i386 -I/Library/Frameworks/R.framework/Resources/ 
include -I/Library/Frameworks/R.framework/Resources/include/i386 -I/ 
Library/Frameworks/GDAL.framework/unix/include -msse3    -fPIC  -g - 
O2 -march=nocona -c ogr_geom.cpp -o ogr_geom.o
/var/tmp//ccDOLihn.s:1411:indirect jmp without `*'
/var/tmp//ccDOLihn.s:1426:indirect jmp without `*'
/var/tmp//ccDOLihn.s:1441:indirect jmp without `*'
/var/tmp//ccDOLihn.s:1456:indirect jmp without `*'
/var/tmp//ccDOLihn.s:1471:indirect jmp without `*'
/var/tmp//ccDOLihn.s:1486:indirect jmp without `*'
/var/tmp//ccDOLihn.s:1501:indirect jmp without `*'
/var/tmp//ccDOLihn.s:1516:indirect jmp without `*'
/var/tmp//ccDOLihn.s:1531:indirect jmp without `*'
/var/tmp//ccDOLihn.s:1546:indirect jmp without `*'
/var/tmp//ccDOLihn.s:1565:indirect jmp without `*'
/var/tmp//ccDOLihn.s:1580:indirect jmp without `*'
/var/tmp//ccDOLihn.s:1595:indirect jmp without `*'
/var/tmp//ccDOLihn.s:1610:indirect jmp without `*'
/var/tmp//ccDOLihn.s:1625:indirect jmp without `*'
/var/tmp//ccDOLihn.s:1640:indirect jmp without `*'
/var/tmp//ccDOLihn.s:1655:indirect jmp without `*'
/var/tmp//ccDOLihn.s:1670:indirect jmp without `*'
/var/tmp//ccDOLihn.s:1685:indirect jmp without `*'
/var/tmp//ccDOLihn.s:1700:indirect jmp without `*'
/var/tmp//ccDOLihn.s:1715:indirect jmp without `*'
/var/tmp//ccDOLihn.s:1730:indirect jmp without `*'
/var/tmp//ccDOLihn.s:1745:indirect jmp without `*'
/var/tmp//ccDOLihn.s:1760:indirect jmp without `*'
/var/tmp//ccDOLihn.s:1775:indirect jmp without `*'
/var/tmp//ccDOLihn.s:1794:indirect jmp without `*'
/var/tmp//ccDOLihn.s:1809:indirect jmp without `*'
/var/tmp//ccDOLihn.s:1824:indirect jmp without `*'
/var/tmp//ccDOLihn.s:1839:indirect jmp without `*'
/var/tmp//ccDOLihn.s:1854:indirect jmp without `*'
/var/tmp//ccDOLihn.s:1869:indirect jmp without `*'
/var/tmp//ccDOLihn.s:1884:indirect jmp without `*'
/var/tmp//ccDOLihn.s:1899:indirect jmp without `*'
g++-4.0 -arch i386 -I/Library/Frameworks/R.framework/Resources/ 
include -I/Library/Frameworks/R.framework/Resources/include/i386 -I/ 
Library/Frameworks/GDAL.framework/unix/include -msse3    -fPIC  -g - 
O2 -march=nocona -c ogr_proj.cpp -o ogr_proj.o
/var/tmp//cc8FZ6b8.s:496:indirect jmp without `*'
/var/tmp//cc8FZ6b8.s:511:indirect jmp without `*'
/var/tmp//cc8FZ6b8.s:526:indirect jmp without `*'
/var/tmp//cc8FZ6b8.s:541:indirect jmp without `*'
/var/tmp//cc8FZ6b8.s:556:indirect jmp without `*'
/var/tmp//cc8FZ6b8.s:571:indirect jmp without `*'
/var/tmp//cc8FZ6b8.s:586:indirect jmp without `*'
/var/tmp//cc8FZ6b8.s:601:indirect jmp without `*'
/var/tmp//cc8FZ6b8.s:616:indirect jmp without `*'
/var/tmp//cc8FZ6b8.s:631:indirect jmp without `*'
/var/tmp//cc8FZ6b8.s:646:indirect jmp without `*'
/var/tmp//cc8FZ6b8.s:661:indirect jmp without `*'
/var/tmp//cc8FZ6b8.s:676:indirect jmp without `*'
/var/tmp//cc8FZ6b8.s:695:indirect jmp without `*'
/var/tmp//cc8FZ6b8.s:714:indirect jmp without `*'
/var/tmp//cc8FZ6b8.s:729:indirect jmp without `*'
/var/tmp//cc8FZ6b8.s:744:indirect jmp without `*'
/var/tmp//cc8FZ6b8.s:759:indirect jmp without `*'
g++-4.0 -arch i386 -I/Library/Frameworks/R.framework/Resources/ 
include -I/Library/Frameworks/R.framework/Resources/include/i386 -I/ 
Library/Frameworks/GDAL.framework/unix/include -msse3    -fPIC  -g - 
O2 -march=nocona -c ogrdrivers.cpp -o ogrdrivers.o
/var/tmp//cch0qJYo.s:317:indirect jmp without `*'
/var/tmp//cch0qJYo.s:332:indirect jmp without `*'
/var/tmp//cch0qJYo.s:347:indirect jmp without `*'
/var/tmp//cch0qJYo.s:362:indirect jmp without `*'
/var/tmp//cch0qJYo.s:377:indirect jmp without `*'
/var/tmp//cch0qJYo.s:396:indirect jmp without `*'
/var/tmp//cch0qJYo.s:411:indirect jmp without `*'
/var/tmp//cch0qJYo.s:426:indirect jmp without `*'
/var/tmp//cch0qJYo.s:441:indirect jmp without `*'
/var/tmp//cch0qJYo.s:460:indirect jmp without `*'
/var/tmp//cch0qJYo.s:475:indirect jmp without `*'
/var/tmp//cch0qJYo.s:490:indirect jmp without `*'
g++-4.0 -arch i386 -I/Library/Frameworks/R.framework/Resources/ 
include -I/Library/Frameworks/R.framework/Resources/include/i386 -I/ 
Library/Frameworks/GDAL.framework/unix/include -msse3    -fPIC  -g - 
O2 -march=nocona -c ogrsource.cpp -o ogrsource.o
/var/tmp//ccbieY4v.s:1331:indirect jmp without `*'
/var/tmp//ccbieY4v.s:1346:indirect jmp without `*'
/var/tmp//ccbieY4v.s:1361:indirect jmp without `*'
/var/tmp//ccbieY4v.s:1376:indirect jmp without `*'
/var/tmp//ccbieY4v.s:1391:indirect jmp without `*'
/var/tmp//ccbieY4v.s:1406:indirect jmp without `*'
/var/tmp//ccbieY4v.s:1421:indirect jmp without `*'
/var/tmp//ccbieY4v.s:1436:indirect jmp without `*'
/var/tmp//ccbieY4v.s:1451:indirect jmp without `*'
/var/tmp//ccbieY4v.s:1466:indirect jmp without `*'
/var/tmp//ccbieY4v.s:1481:indirect jmp without `*'
/var/tmp//ccbieY4v.s:1496:indirect jmp without `*'
/var/tmp//ccbieY4v.s:1511:indirect jmp without `*'
/var/tmp//ccbieY4v.s:1533:indirect jmp without `*'
/var/tmp//ccbieY4v.s:1548:indirect jmp without `*'
/var/tmp//ccbieY4v.s:1563:indirect jmp without `*'
/var/tmp//ccbieY4v.s:1578:indirect jmp without `*'
/var/tmp//ccbieY4v.s:1593:indirect jmp without `*'
/var/tmp//ccbieY4v.s:1608:indirect jmp without `*'
g++-4.0 -arch i386 -I/Library/Frameworks/R.framework/Resources/ 
include -I/Library/Frameworks/R.framework/Resources/include/i386 -I/ 
Library/Frameworks/GDAL.framework/unix/include -msse3    -fPIC  -g - 
O2 -march=nocona -c projectit.cpp -o projectit.o
projectit.cpp:10:22: error: proj_api.h: No such file or directory
projectit.cpp: In function 'void project(int*, double*, double*,  
double*, double*, char**)':
projectit.cpp:21: error: 'projUV' was not declared in this scope
projectit.cpp:21: error: expected `;' before 'p'
projectit.cpp:22: error: 'projPJ' was not declared in this scope
projectit.cpp:22: error: expected `;' before 'pj'
projectit.cpp:24: error: 'pj' was not declared in this scope
projectit.cpp:24: error: 'pj_init_plus' was not declared in this scope
projectit.cpp:25: error: 'pj_get_errno_ref' was not declared in this  
scope
projectit.cpp:25: error: 'pj_strerrno' was not declared in this scope
projectit.cpp:34: error: 'p' was not declared in this scope
projectit.cpp:36: error: 'DEG_TO_RAD' was not declared in this scope
projectit.cpp:38: error: 'pj' was not declared in this scope
projectit.cpp:38: error: 'pj_fwd' was not declared in this scope
projectit.cpp:40: error: 'pj_free' was not declared in this scope
projectit.cpp:41: error: 'pj_get_errno_ref' was not declared in this  
scope
projectit.cpp:41: error: 'pj_strerrno' was not declared in this scope
projectit.cpp:48: error: 'pj' was not declared in this scope
projectit.cpp:48: error: 'pj_free' was not declared in this scope
projectit.cpp: In function 'void project_inv(int*, double*, double*,  
double*, double*, char**)':
projectit.cpp:59: error: 'projUV' was not declared in this scope
projectit.cpp:59: error: expected `;' before 'p'
projectit.cpp:60: error: 'projPJ' was not declared in this scope
projectit.cpp:60: error: expected `;' before 'pj'
projectit.cpp:62: error: 'pj' was not declared in this scope
projectit.cpp:62: error: 'pj_init_plus' was not declared in this scope
projectit.cpp:63: error: 'pj_get_errno_ref' was not declared in this  
scope
projectit.cpp:63: error: 'pj_strerrno' was not declared in this scope
projectit.cpp:71: error: 'p' was not declared in this scope
projectit.cpp:73: error: 'pj' was not declared in this scope
projectit.cpp:73: error: 'pj_inv' was not declared in this scope
projectit.cpp:75: error: 'pj_free' was not declared in this scope
projectit.cpp:76: error: 'pj_get_errno_ref' was not declared in this  
scope
projectit.cpp:76: error: 'pj_strerrno' was not declared in this scope
projectit.cpp:78: error: 'RAD_TO_DEG' was not declared in this scope
projectit.cpp:83: error: 'pj' was not declared in this scope
projectit.cpp:83: error: 'pj_free' was not declared in this scope
projectit.cpp: In function 'SEXPREC* transform(SEXPREC*, SEXPREC*,  
SEXPREC*, SEXPREC*, SEXPREC*)':
projectit.cpp:93: error: 'projUV' was not declared in this scope
projectit.cpp:93: error: expected `;' before 'p'
projectit.cpp:94: error: 'projPJ' was not declared in this scope
projectit.cpp:94: error: expected `;' before 'fromPJ'
projectit.cpp:97: error: 'fromPJ' was not declared in this scope
projectit.cpp:97: error: 'pj_init_plus' was not declared in this scope
projectit.cpp:98: error: 'pj_get_errno_ref' was not declared in this  
scope
projectit.cpp:98: error: 'pj_strerrno' was not declared in this scope
projectit.cpp:100: error: 'toPJ' was not declared in this scope
projectit.cpp:100: error: 'pj_init_plus' was not declared in this scope
projectit.cpp:101: error: 'pj_get_errno_ref' was not declared in this  
scope
projectit.cpp:101: error: 'pj_strerrno' was not declared in this scope
projectit.cpp:110: error: 'fromPJ' was not declared in this scope
projectit.cpp:110: error: 'pj_get_def' was not declared in this scope
projectit.cpp:113: error: 'toPJ' was not declared in this scope
projectit.cpp:120: error: 'p' was not declared in this scope
projectit.cpp:125: error: 'pj_is_latlong' was not declared in this scope
projectit.cpp:126: error: 'DEG_TO_RAD' was not declared in this scope
projectit.cpp:131: error: 'pj_transform' was not declared in this scope
projectit.cpp:138: error: 'pj_free' was not declared in this scope
projectit.cpp:139: error: 'pj_get_errno_ref' was not declared in this  
scope
projectit.cpp:139: error: 'pj_strerrno' was not declared in this scope
projectit.cpp:141: error: 'pj_is_latlong' was not declared in this scope
projectit.cpp:142: error: 'RAD_TO_DEG' was not declared in this scope
projectit.cpp:151: error: 'pj_free' was not declared in this scope
projectit.cpp: In function 'SEXPREC* checkCRSArgs(SEXPREC*)':
projectit.cpp:158: error: 'projPJ' was not declared in this scope
projectit.cpp:158: error: expected `;' before 'pj'
projectit.cpp:164: error: 'pj' was not declared in this scope
projectit.cpp:164: error: 'pj_init_plus' was not declared in this scope
projectit.cpp:167: error: 'pj_get_errno_ref' was not declared in this  
scope
projectit.cpp:167: error: 'pj_strerrno' was not declared in this scope
projectit.cpp:174: error: 'pj' was not declared in this scope
projectit.cpp:174: error: 'pj_get_def' was not declared in this scope
make: *** [projectit.o] Error 1
chmod: impossibile accedere a `/Library/Frameworks/R.framework/ 
Versions/2.4/Resources/library/rgdal/libs/i386/*': No such file or  
directory
ERROR: compilation failed for package 'rgdal'
** Removing '/Library/Frameworks/R.framework/Versions/2.4/Resources/ 
library/rgdal'
** Restoring previous '/Library/Frameworks/R.framework/Versions/2.4/ 
Resources/library/rgdal'
computer-di-epifanio:~ epifanio$




until the last version of rgdal, i have not problem to update it from  
command line,
using a command like :

R CMD install --with-configure-args='--with-gdal-config=/Library/ 
Frameworks/GDAL.framework/Versions/1.4/Programs/gdal-config' /Users/ 
epifanio/Desktop/rgdal_0.5-6.tar.gz


have you any idea about ?
im on a mac osx intel.
i'm using a gdal frameworks,
computer-di-epifanio:~ epifanio$ gdalinfo --version
GDAL 1.4.0.0, released 2007/01/02
computer-di-epifanio:~ epifanio$


thanks!

Massimo.



From massimodisasha at yahoo.it  Fri Feb  2 02:06:29 2007
From: massimodisasha at yahoo.it (epifanio)
Date: Fri, 2 Feb 2007 02:06:29 +0100
Subject: [R-sig-Geo] re : gdal update ( fix )
Message-ID: <9ADADCA8-FA6F-4E3A-8A97-846092C3ABAC@yahoo.it>

hi,
sorry for the worning about rgdal,
i'missed to comment some line in my
bash  .profile

now oll works fine :-)
thanks,

Massimo



From drf5n at maplepark.com  Fri Feb  2 21:45:26 2007
From: drf5n at maplepark.com (David Forrest)
Date: Fri, 2 Feb 2007 14:45:26 -0600 (CST)
Subject: [R-sig-Geo] CVS checkout instructions out of date at
	http://r-spatial.sourceforge.net/
Message-ID: <Pine.LNX.4.64.0702021439020.4068@maplepark.com>

Maybe I'm doing things wrong, but do the instructions for CVS checkout 
from
http://r-spatial.sourceforge.net/ (and the Download link show there:
http://r-spatial.sourceforge.net/download.html )
work for others?

export CVS_RSH=ssh

cvs -d:pserver:anonymous at cvs.sourceforge.net:/cvsroot/r-spatial login
cvs -z3 -d:pserver:anonymous at cvs.sourceforge.net:/cvsroot/r-spatial co -P 
sp

They seem inconsistent with the instructions at 
http://sourceforge.net/cvs/?group_id=84357 which seem to work.

Dave
-- 
  Dr. David Forrest
  drf at vims.edu                                    (804)684-7900w
  drf5n at maplepark.com                             (804)642-0662h
                                    http://maplepark.com/~drf5n/



From v.gomezrubio at imperial.ac.uk  Fri Feb  2 22:48:19 2007
From: v.gomezrubio at imperial.ac.uk (Virgilio =?ISO-8859-1?Q?G=F3mez-Rubio?=)
Date: Fri, 02 Feb 2007 21:48:19 +0000
Subject: [R-sig-Geo] CVS checkout instructions out of date
	at	http://r-spatial.sourceforge.net/
In-Reply-To: <Pine.LNX.4.64.0702021439020.4068@maplepark.com>
References: <Pine.LNX.4.64.0702021439020.4068@maplepark.com>
Message-ID: <1170452899.7928.7.camel@fh-vrubio.sm.med.ic.ac.uk>

Hi David,

My setting to connect to the CVS are:

export CVSROOT=":ext:vir at r-spatial.cvs.sf.net:/cvsroot/r-spatial"
export CVS_RSH=ssh


You will need to change the server to r-spatial.cvs.sf.net. I do not
know why, but it works.

Best,

Virgilio

El vie, 02-02-2007 a las 14:45 -0600, David Forrest escribi?:
> Maybe I'm doing things wrong, but do the instructions for CVS checkout 
> from
> http://r-spatial.sourceforge.net/ (and the Download link show there:
> http://r-spatial.sourceforge.net/download.html )
> work for others?
> 
> export CVS_RSH=ssh
> 
> cvs -d:pserver:anonymous at cvs.sourceforge.net:/cvsroot/r-spatial login
> cvs -z3 -d:pserver:anonymous at cvs.sourceforge.net:/cvsroot/r-spatial co -P 
> sp
> 
> They seem inconsistent with the instructions at 
> http://sourceforge.net/cvs/?group_id=84357 which seem to work.
> 
> Dave



From v.gomezrubio at imperial.ac.uk  Fri Feb  2 23:05:43 2007
From: v.gomezrubio at imperial.ac.uk (Virgilio =?ISO-8859-1?Q?G=F3mez-Rubio?=)
Date: Fri, 02 Feb 2007 22:05:43 +0000
Subject: [R-sig-Geo] Small Area Estimation with R (Request for Comments)
Message-ID: <1170453943.7928.13.camel@fh-vrubio.sm.med.ic.ac.uk>

Dear all,

First of all, apologies if I am making a wrong use of this list, 
but we have been working on a package to implement EBLUP and Spatial
EBLUP estimators (code provided by Nicola Salvati) for Small Area
Estimation and we would like to announce it in this list. The package
itself contains a few functions but we have included a vignette that, we
hope, is a good starting point to Small Area Estimation with R and can
be used for teaching purposes (for example).

The package (source and Windows binary), can be downloaded from:

http://www.bias-project.org.uk/software/

and the vignette is here:

http://www.bias-project.org.uk/software/SAE.pdf


Any comments and feedback will be very welcome.

Best regards,

Virgilio



From Roger.Bivand at nhh.no  Mon Feb  5 09:17:16 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 5 Feb 2007 09:17:16 +0100 (CET)
Subject: [R-sig-Geo] CVS checkout instructions out of date at
 http://r-spatial.sourceforge.net/
In-Reply-To: <1170452899.7928.7.camel@fh-vrubio.sm.med.ic.ac.uk>
Message-ID: <Pine.LNX.4.44.0702050913570.12369-100000@reclus.nhh.no>

On Fri, 2 Feb 2007, Virgilio G?mez-Rubio wrote:

> Hi David,
> 
> My setting to connect to the CVS are:
> 
> export CVSROOT=":ext:vir at r-spatial.cvs.sf.net:/cvsroot/r-spatial"
> export CVS_RSH=ssh
> 
> 
> You will need to change the server to r-spatial.cvs.sf.net. I do not
> know why, but it works.

The reason is that Sourceforge split out projects into separate addresses 
last year to aid administration. I have updated the information on the 
website, and added notes where appropriate that the old R repository on 
sourceforge is now no longer updated, because the packages kept there are 
all included in rgdal, maptools, or spgrass6 on CRAN.

Thanks for pointing out the lapse.

Roger


> 
> Best,
> 
> Virgilio
> 
> El vie, 02-02-2007 a las 14:45 -0600, David Forrest escribi?:
> > Maybe I'm doing things wrong, but do the instructions for CVS checkout 
> > from
> > http://r-spatial.sourceforge.net/ (and the Download link show there:
> > http://r-spatial.sourceforge.net/download.html )
> > work for others?
> > 
> > export CVS_RSH=ssh
> > 
> > cvs -d:pserver:anonymous at cvs.sourceforge.net:/cvsroot/r-spatial login
> > cvs -z3 -d:pserver:anonymous at cvs.sourceforge.net:/cvsroot/r-spatial co -P 
> > sp
> > 
> > They seem inconsistent with the instructions at 
> > http://sourceforge.net/cvs/?group_id=84357 which seem to work.
> > 
> > Dave
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From drf5n at maplepark.com  Mon Feb  5 19:12:07 2007
From: drf5n at maplepark.com (David Forrest)
Date: Mon, 5 Feb 2007 12:12:07 -0600 (CST)
Subject: [R-sig-Geo] CVS checkout instructions out of date at
 http://r-spatial.sourceforge.net/
In-Reply-To: <Pine.LNX.4.44.0702050913570.12369-100000@reclus.nhh.no>
References: <Pine.LNX.4.44.0702050913570.12369-100000@reclus.nhh.no>
Message-ID: <Pine.LNX.4.64.0702051210010.14506@maplepark.com>

On Mon, 5 Feb 2007, Roger Bivand wrote:

> On Fri, 2 Feb 2007, Virgilio G?mez-Rubio wrote:
>
>> Hi David,
...
> The reason is that Sourceforge split out projects into separate addresses
> last year to aid administration. I have updated the information on the
> website, and added notes where appropriate that the old R repository on
> sourceforge is now no longer updated, because the packages kept there are
> all included in rgdal, maptools, or spgrass6 on CRAN.
>
> Thanks for pointing out the lapse.

Thanks for repairing it -- I bonked up against it a few times and thought 
the server was down or I was doing something wrong.

Dave
-- 
  Dr. David Forrest
  drf at vims.edu                                    (804)684-7900w
  drf5n at maplepark.com                             (804)642-0662h
                                    http://maplepark.com/~drf5n/

From Roger.Bivand at nhh.no  Mon Feb  5 20:39:46 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 5 Feb 2007 20:39:46 +0100 (CET)
Subject: [R-sig-Geo] Small Area Estimation with R (Request for Comments)
In-Reply-To: <1170453943.7928.13.camel@fh-vrubio.sm.med.ic.ac.uk>
Message-ID: <Pine.LNX.4.44.0702052038510.12369-100000@reclus.nhh.no>

On Fri, 2 Feb 2007, Virgilio G?mez-Rubio wrote:

> Dear all,
> 
> First of all, apologies if I am making a wrong use of this list, 
> but we have been working on a package to implement EBLUP and Spatial
> EBLUP estimators (code provided by Nicola Salvati) for Small Area
> Estimation and we would like to announce it in this list. The package
> itself contains a few functions but we have included a vignette that, we
> hope, is a good starting point to Small Area Estimation with R and can
> be used for teaching purposes (for example).
> 
> The package (source and Windows binary), can be downloaded from:
> 
> http://www.bias-project.org.uk/software/
> 
> and the vignette is here:
> 
> http://www.bias-project.org.uk/software/SAE.pdf
> 
> 
> Any comments and feedback will be very welcome.

Thanks, Virgilio, a reference is on the R-geo website.

Roger

> 
> Best regards,
> 
> Virgilio
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From m.fanta at soilmaps.it  Tue Feb  6 12:10:55 2007
From: m.fanta at soilmaps.it (=?iso-8859-1?Q?Maria_Fantappi=E8?=)
Date: Tue, 6 Feb 2007 12:10:55 +0100
Subject: [R-sig-Geo] export from adf to dat
Message-ID: <000601c749df$7a6e6ba0$2200a8c0@issds.it>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070206/a46e1e14/attachment.pl>

From Roger.Bivand at nhh.no  Tue Feb  6 19:55:21 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 6 Feb 2007 19:55:21 +0100 (CET)
Subject: [R-sig-Geo] export from adf to dat
In-Reply-To: <000601c749df$7a6e6ba0$2200a8c0@issds.it>
Message-ID: <Pine.LNX.4.44.0702061944430.13521-100000@reclus.nhh.no>

On Tue, 6 Feb 2007, Maria Fantappi? wrote:

> Hallo to everybody,
> 
> I need to know how to export a file .adf (that is a DEM) to the ascii
> format (.dat),

Perhaps just use gdal_translate from AIG to AAIGrid:

http://www.gdal.org/gdal_translate.html

Or any ESRI product?

The rgdal package for R Windows binary provides read access for both, and
copy access for AAIGrid, so you'd need to copy but not create to the
output format.

> 
> thank you,
> 
> Maria
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From cwjacksonjr at hotmail.com  Tue Feb  6 20:54:32 2007
From: cwjacksonjr at hotmail.com (CJ Jackson)
Date: Tue, 06 Feb 2007 14:54:32 -0500
Subject: [R-sig-Geo] GIS Tasks in R
Message-ID: <BAY123-DAV8A0DDB4F03E86941FF431B29F0@phx.gbl>

Hi everyone,

I'm currently working on my PhD (geology) and would like to explore the 
possible GIS capabilities of R.  I currently use ESRI's ArcView (3.x), 
ArcGIS (9.1), and ArcInfo (9) software for all of my GIS work.  I have 
written an "extension" for the old ArcView that performs various 
analyses of points/polylines/polygons and have been wanting to update 
the extension for the latest version of ArcGIS to help me solve various 
research problems.  With that being said, I discovered 'R' last year and 
fell in love with it and have been using it for data analysis of 
attribute tables from GIS Shapefiles.  Ultimately, as part of my 
research, I would like to make a package for R that would handle various 
GIS tasks of shapefiles themselves, not just their data tables.  It 
would be great to have a analysis package for my research that is not 
solely dependent on ESRI's software.  Furthermore, I dread programming 
in Visual Basic for the new ArcGIS because I have limited programming 
skills.  Here are some of the tasks I would like to perform:

- produce a new point shapefile that contains points where two or more 
shapefiles with polylines intersect
- intersect two or more shapefiles with polygons and store the results 
in a new shapefile
- calculate area of polygons
- calculate the distance from a point shapefile to another point shapefile

Is this possible in R, or, am I barking up the wrong tree?  Thanks!

cj



From Roger.Bivand at nhh.no  Tue Feb  6 21:35:24 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 6 Feb 2007 21:35:24 +0100 (CET)
Subject: [R-sig-Geo] GIS Tasks in R
In-Reply-To: <BAY123-DAV8A0DDB4F03E86941FF431B29F0@phx.gbl>
	<45C8DCF8.4080704@hotmail.com>
Message-ID: <Pine.LNX.4.44.0702062110310.13521-100000@reclus.nhh.no>

On Tue, 6 Feb 2007, CJ Jackson wrote:

> Hi everyone,
> 
> I'm currently working on my PhD (geology) and would like to explore the 
> possible GIS capabilities of R.  I currently use ESRI's ArcView (3.x), 
> ArcGIS (9.1), and ArcInfo (9) software for all of my GIS work.  I have 
> written an "extension" for the old ArcView that performs various 
> analyses of points/polylines/polygons and have been wanting to update 
> the extension for the latest version of ArcGIS to help me solve various 
> research problems.  With that being said, I discovered 'R' last year and 
> fell in love with it and have been using it for data analysis of 
> attribute tables from GIS Shapefiles.  Ultimately, as part of my 
> research, I would like to make a package for R that would handle various 
> GIS tasks of shapefiles themselves, not just their data tables.  It 
> would be great to have a analysis package for my research that is not 
> solely dependent on ESRI's software.  Furthermore, I dread programming 
> in Visual Basic for the new ArcGIS because I have limited programming 
> skills.  

There are a number of possibilities for computing on the geometries, using 
the classes defined in the sp package as containers. There is no direct 
interface to the Geom functionality in GDAL/OGR, so access to 
computational geometry is patchy, and spread across several packages.

> Here are some of the tasks I would like to perform:
> 
> - produce a new point shapefile that contains points where two or more 
> shapefiles with polylines intersect

This involves finding the crossing point of the polylines, and may be
somewhere, probably an internal function in the spatstat package - see
?distppll for a list (the functions are described as not being for users
to call directly, but I've found those I've used very solid). There may be 
suitable code in the PBSmapping package.

> - intersect two or more shapefiles with polygons and store the results 
> in a new shapefile

Either the PBSmapping package or use gpclib with sp and maptools (there is 
a function for merging SpatialPolygons in a single set of shapes in 
maptools using gpclib).

> - calculate area of polygons

Code lots of places, sp, PBSmapping, spatstat, splancs - the main issues 
are what to do with holes.

> - calculate the distance from a point shapefile to another point shapefile
> 

spDistN1 in sp, stepping over the coordinates in one set for all in the 
other probably using *apply(), or alternatives in spatstat or splancs.

I'm assuming that the geometries are all projected, if not, things get a 
bit more interesting.

> Is this possible in R, or, am I barking up the wrong tree?  Thanks!
> 

library(fortunes)
fortune("Yoda")

Roger

> cj
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From tkeitt at gmail.com  Tue Feb  6 22:07:27 2007
From: tkeitt at gmail.com (Tim Keitt)
Date: Tue, 6 Feb 2007 15:07:27 -0600
Subject: [R-sig-Geo] GIS Tasks in R
In-Reply-To: <BAY123-DAV8A0DDB4F03E86941FF431B29F0@phx.gbl>
References: <BAY123-DAV8A0DDB4F03E86941FF431B29F0@phx.gbl>
Message-ID: <6262c54c0702061307m50c68d9v4ccb9200b3d53123@mail.gmail.com>

In addition to Rogers advise, you might take a peek at the functions
available in postgis. Once you have polys in the postgis database, you
can do quite a lot of geometry ops by eg "select intersection(poly1,
poly2) from tabname" and so on. There's some grunt work involved. Its
certainly not pointy-clicky (although QGIS and GRASS have some ability
to work with postgis). I have found some useful functions there.
Documentation is pretty good too.

THK

On 2/6/07, CJ Jackson <cwjacksonjr at hotmail.com> wrote:
> Hi everyone,
>
> I'm currently working on my PhD (geology) and would like to explore the
> possible GIS capabilities of R.  I currently use ESRI's ArcView (3.x),
> ArcGIS (9.1), and ArcInfo (9) software for all of my GIS work.  I have
> written an "extension" for the old ArcView that performs various
> analyses of points/polylines/polygons and have been wanting to update
> the extension for the latest version of ArcGIS to help me solve various
> research problems.  With that being said, I discovered 'R' last year and
> fell in love with it and have been using it for data analysis of
> attribute tables from GIS Shapefiles.  Ultimately, as part of my
> research, I would like to make a package for R that would handle various
> GIS tasks of shapefiles themselves, not just their data tables.  It
> would be great to have a analysis package for my research that is not
> solely dependent on ESRI's software.  Furthermore, I dread programming
> in Visual Basic for the new ArcGIS because I have limited programming
> skills.  Here are some of the tasks I would like to perform:
>
> - produce a new point shapefile that contains points where two or more
> shapefiles with polylines intersect
> - intersect two or more shapefiles with polygons and store the results
> in a new shapefile
> - calculate area of polygons
> - calculate the distance from a point shapefile to another point shapefile
>
> Is this possible in R, or, am I barking up the wrong tree?  Thanks!
>
> cj
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


-- 
Timothy H. Keitt, University of Texas at Austin
Contact info and schedule at http://www.keittlab.org/tkeitt/
Reprints at http://www.keittlab.org/tkeitt/papers/
ODF attachment? See http://www.openoffice.org/



From Roger.Bivand at nhh.no  Tue Feb  6 23:11:53 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 6 Feb 2007 23:11:53 +0100 (CET)
Subject: [R-sig-Geo] GIS Tasks in R
In-Reply-To: <6262c54c0702061307m50c68d9v4ccb9200b3d53123@mail.gmail.com>
Message-ID: <Pine.LNX.4.44.0702062302460.13521-100000@reclus.nhh.no>

On Tue, 6 Feb 2007, Tim Keitt wrote:

> In addition to Rogers advise, you might take a peek at the functions
> available in postgis. Once you have polys in the postgis database, you
> can do quite a lot of geometry ops by eg "select intersection(poly1,
> poly2) from tabname" and so on. There's some grunt work involved. Its
> certainly not pointy-clicky (although QGIS and GRASS have some ability
> to work with postgis). I have found some useful functions there.
> Documentation is pretty good too.

And as Edzer tried out recently, you can get data to PostGIS from rgdal 
if your GDAL/OGR is built with PostGIS (PostgreSQL anyway) support - 
writeOGR(). We didn't try readOGR(), but it ought to work if the driver is 
present. Reports welcome.

Roger

> 
> THK
> 
> On 2/6/07, CJ Jackson <cwjacksonjr at hotmail.com> wrote:
> > Hi everyone,
> >
> > I'm currently working on my PhD (geology) and would like to explore the
> > possible GIS capabilities of R.  I currently use ESRI's ArcView (3.x),
> > ArcGIS (9.1), and ArcInfo (9) software for all of my GIS work.  I have
> > written an "extension" for the old ArcView that performs various
> > analyses of points/polylines/polygons and have been wanting to update
> > the extension for the latest version of ArcGIS to help me solve various
> > research problems.  With that being said, I discovered 'R' last year and
> > fell in love with it and have been using it for data analysis of
> > attribute tables from GIS Shapefiles.  Ultimately, as part of my
> > research, I would like to make a package for R that would handle various
> > GIS tasks of shapefiles themselves, not just their data tables.  It
> > would be great to have a analysis package for my research that is not
> > solely dependent on ESRI's software.  Furthermore, I dread programming
> > in Visual Basic for the new ArcGIS because I have limited programming
> > skills.  Here are some of the tasks I would like to perform:
> >
> > - produce a new point shapefile that contains points where two or more
> > shapefiles with polylines intersect
> > - intersect two or more shapefiles with polygons and store the results
> > in a new shapefile
> > - calculate area of polygons
> > - calculate the distance from a point shapefile to another point shapefile
> >
> > Is this possible in R, or, am I barking up the wrong tree?  Thanks!
> >
> > cj
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> 
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From jzhang1982 at gmail.com  Wed Feb  7 04:42:03 2007
From: jzhang1982 at gmail.com (Zhang Jian)
Date: Wed, 7 Feb 2007 11:42:03 +0800
Subject: [R-sig-Geo] about "moran's I test"?
Message-ID: <3f2938d50702061942l5ba88487h6d0eff6a9e4a4b57@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070207/40fc6622/attachment.pl>

From Roger.Bivand at nhh.no  Wed Feb  7 08:40:05 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 7 Feb 2007 08:40:05 +0100 (CET)
Subject: [R-sig-Geo] about "moran's I test"?
In-Reply-To: <3f2938d50702061942l5ba88487h6d0eff6a9e4a4b57@mail.gmail.com>
Message-ID: <Pine.LNX.4.44.0702070829280.14157-100000@reclus.nhh.no>

On Wed, 7 Feb 2007, Zhang Jian wrote:

> I want to do "moran's I test" in R language. I try to use "gearymoran" in
> Package "ade4","moran" in Package "spdep", and Moran.I in Package "ape". But
> I do not know how to do it because data format is different.

Please state clearly what the points are - are they point entities, ot 
points representing areal entities? Your choice of measures of contiguity, 
which are essential for the use of Moran's I, will depend on this choice. 
In addition, the points seem to be along a narrow band (river, road?).

My advice on R-help, given your phrasing, was that the correlog function 
in Ottar Bj?rnstad's off-CRAN ncf package looks appropriate:

t1 <- read.table("zj1.txt", header=TRUE)
# to read your data as given in your mail (very few observations indeed)
str(t1)
install.packages("ncf",contriburl="http://asi23.ent.psu.edu/onb1/R/src")
# this for Linux/Mac, Windows is
# install.packages("ncf",contriburl="http://asi23.ent.psu.edu/onb1/R/windows")
library(ncf)
summary(dist(as.matrix(t1[,1:2])))
# to find appropriate distance increments
res <- correlog(t1$x, t1$y, t1$dbh, increment=25)
str(res)
plot(res)

However, this is largely without meaning unless you have some motivated 
understanding of how or why the observations are showing similar values in 
space. The correlog() function takes the whole data range, which is most 
likely totally inappropriate if you know that influence drops off quickly. 
In any case, without taking background variables into account, you may 
"find" autocorrelation when in fact there are spatially patterned missing 
variables.

Hope this helps,

Roger


> 
> My data:
> 
>    x        y       dbh
> 
> 111.03    10.7       7
> 
> 118.11    0.28     1.2
> 
> 165.36    0.36     8.4
> 
>   282.9     0.3     7.5
> 
> 303.29   13.32    12.2
> 
> 319.28    3.88     6.2
> 
>     447       9       6
> 
>   445.5    18.3    13.8
> 
>   445.5    12.1     7.1
> 
> 467.64     1.2     4.7
> 
>   485.4    14.1     4.4
> 
>    2.98   23.95    11.7
> 
>      15   35.78    23.5
> 
> 130.21    23.6    14.1
> 
>   213.5   23.22    21.5
> 
> 233.57   28.76    35.4
> 
>   482.3    20.5       6
> 
>   69.73   45.21     7.5
> 
>    69.8   50.49    10.2
> 
>   76.65    45.5    21.5
> 
> 
> 
> "x","y" are spatial coordinate;
> 
> "dbh" is variable
> 
> I want to test the spatial autocorrelation of "dbh" in different distances
> by "x" and "y".
> 
> 
> 
> Thanks,
> 
>                                Jian Zhang
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From p.hiemstra at geo.uu.nl  Wed Feb  7 09:49:02 2007
From: p.hiemstra at geo.uu.nl (Paul Hiemstra)
Date: Wed, 07 Feb 2007 09:49:02 +0100
Subject: [R-sig-Geo] Any example using UMN Mapserver with R
In-Reply-To: <20070124194504.39472.qmail@web10915.mail.bbt.yahoo.co.jp>
References: <20070124194504.39472.qmail@web10915.mail.bbt.yahoo.co.jp>
Message-ID: <45C9927E.5070902@geo.uu.nl>

Dear Hisaji,

You can link MapServer and R by using MapServer in mapscript mode. The 
next step would be to find an extension that links R to this the 
programming language of your choice (Python, Perl, php). I myself use 
Python (www.python.org) in combination with the rpy extension 
(http://rpy.sourceforge.net/). Rpy allows R functions to be called from 
within a python script. I haven't tried this combination of 
MapServer/Python/R myself and do not know what is possible and what not, 
but is certainly worthwhile to give it a try.

hth,

Paul

Hisaji ONO schreef:
> Hello.
>
>  UMN Mapserver is one of most famous Open Source Web GIS
> Engine.
>
>  Is there any example combine this with R for spatial data
> mining etc?
>
>
>  Regards.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   


-- 
Drs. Paul Hiemstra
Department of Physical Geography
Faculty of Geosciences
University of Utrecht
Heidelberglaan 2
P.O. Box 80.115
3508 TC Utrecht
Phone: 	+31302535773
Fax:	+31302531145



From Luisr at frs.fo  Wed Feb  7 12:15:03 2007
From: Luisr at frs.fo (Luis Ridao Cruz)
Date: Wed, 07 Feb 2007 11:15:03 +0000
Subject: [R-sig-Geo] warning and error message when dowloading/installing
	package'sp'
Message-ID: <s5c9b4c0.018@ffdata.setur.fo>

R-sig-geo help,

I'm trying to install 'sp' package from the repositories
and I get the following message:

Warning: unable to access index for repository
http://pangora.org/cran/bin/windows/contrib/2.4 
Warning in download.packages(pkgs, destdir = tmpd, available =
available,  : 
         no package 'sp' at the repositories

I used CRAN mirrors in Denmark and Germany

It works fine to install it from local zip (sp_0.8-9.zip) file but when
loading
the package with library(sp) an error message comes up:

Error in loadNamespace(package, c(which.lib.loc, lib.loc), keep.source
= keep.source) : 
        in 'sp' methods for export not found: bbox, coordinates,
coordinates<-, coordnames, coordnames<-, gridded, polygons, polygons<-,
dimensions, [, transform, overlay, plot, recenter, spplot, spsample,
summary
Error: package/namespace load failed for 'sp'


Is anyone experiencing this problem?

Thanks in advance

> version
               _                           
platform       i386-pc-mingw32             
arch           i386                        
os             mingw32                     
system         i386, mingw32               
status                                     
major          2                           
minor          4.1                         
year           2006                        
month          12                          
day            18                          
svn rev        40228                       
language       R                           
version.string R version 2.4.1 (2006-12-18)



From Roger.Bivand at nhh.no  Wed Feb  7 12:24:11 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 7 Feb 2007 12:24:11 +0100 (CET)
Subject: [R-sig-Geo] warning and error message when
 dowloading/installing package'sp'
In-Reply-To: <s5c9b4c0.018@ffdata.setur.fo>
Message-ID: <Pine.LNX.4.44.0702071221360.14157-100000@reclus.nhh.no>

On Wed, 7 Feb 2007, Luis Ridao Cruz wrote:

> R-sig-geo help,
> 
> I'm trying to install 'sp' package from the repositories
> and I get the following message:

Mirrors do have outages from time to time. The Norwegian mirror seems to 
be up, the Danish mirror took a fair time to respond, and the German one 
you used isn't responding for me. Note that the current release of sp is 
sp_0.9-7.

Roger

> 
> Warning: unable to access index for repository
> http://pangora.org/cran/bin/windows/contrib/2.4 
> Warning in download.packages(pkgs, destdir = tmpd, available =
> available,  : 
>          no package 'sp' at the repositories
> 
> I used CRAN mirrors in Denmark and Germany
> 
> It works fine to install it from local zip (sp_0.8-9.zip) file but when
> loading
> the package with library(sp) an error message comes up:
> 
> Error in loadNamespace(package, c(which.lib.loc, lib.loc), keep.source
> = keep.source) : 
>         in 'sp' methods for export not found: bbox, coordinates,
> coordinates<-, coordnames, coordnames<-, gridded, polygons, polygons<-,
> dimensions, [, transform, overlay, plot, recenter, spplot, spsample,
> summary
> Error: package/namespace load failed for 'sp'
> 
> 
> Is anyone experiencing this problem?
> 
> Thanks in advance
> 
> > version
>                _                           
> platform       i386-pc-mingw32             
> arch           i386                        
> os             mingw32                     
> system         i386, mingw32               
> status                                     
> major          2                           
> minor          4.1                         
> year           2006                        
> month          12                          
> day            18                          
> svn rev        40228                       
> language       R                           
> version.string R version 2.4.1 (2006-12-18)
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From horacio.samaniego at gmail.com  Wed Feb  7 15:03:21 2007
From: horacio.samaniego at gmail.com (Horacio Samaniego)
Date: Wed, 7 Feb 2007 07:03:21 -0700
Subject: [R-sig-Geo] facing the bad move: how to retrieve old (sp) data
	after an upgrade...?
Message-ID: <34DB24C4-E49C-424A-AD98-F07F9C96667C@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070207/61ddfa6e/attachment.pl>

From e.pebesma at geo.uu.nl  Wed Feb  7 15:20:28 2007
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Wed, 07 Feb 2007 15:20:28 +0100
Subject: [R-sig-Geo] facing the bad move: how to retrieve old (sp) data
 after an upgrade...?
In-Reply-To: <34DB24C4-E49C-424A-AD98-F07F9C96667C@gmail.com>
References: <34DB24C4-E49C-424A-AD98-F07F9C96667C@gmail.com>
Message-ID: <45C9E02C.1030507@geo.uu.nl>

Perhaps try

 > pija.scoressp at data@att[[1]]

etc.
--
Edzer

Horacio Samaniego wrote:
> I first need to apologize as I  have made a mistake, I know that I  
> should have read the Breaking News before (http://www.sal.uiuc.edu/ 
> tools/tools-sum/rgeo/r-spatial-projects)
>
> Now I am trying to step back so that I can retrieve my data. However,  
> I don't seem to find old versions of the sp and spdep I need 0.8* of  
> sp as I have messed up my objects 'big time'  by upgrading the whole  
> installation.
>
> The question is this:
>
> - What is the best method to make up this error? (I'm hoping that I  
> am not the only one...)
> or
> - Is re-installing old versions of the packages the only method?
>
> - Where can I find the repository for old packages?
>
> thanks in advance! Any hint is appreciated
>
> The errors I get are not apparent at first sight... but I later tried  
> to retrieve a column of the @data in a SpatialPointsDataFrame object  
> and just got >NULL
>
> here's the sequence:
>
>  > pija.scoressp at data[,1]
> Error in pija.scoressp at data[, 1] : incorrect number of dimensions
>  > pija.scoressp at data$PC1
> NULL
>  > names(pija.scoressp at data)
> NULL
>
> However I can see the data with str():
>  > str(pija.scoressp)
> list()
> - attr(*, "bbox")= num [1:2, 1:2] 1032800  333100 1211500  474500
>    ..- attr(*, "dimnames")=List of 2
>    .. ..$ : chr [1:2] "slongitude" "slatitude"
>    .. ..$ : chr [1:2] "min" "max"
> - attr(*, "proj4string")= list()
>    ..- attr(*, "projargs")= chr "+proj=aea +lat_0=23.0000000000  
> +lat_1=29.5000000000 +lat_2=45.5000000000 +lon_0=-96.0000000000  
> +x_0=0.0000000000 +y_0=0.0000000"| __truncated__
>    ..- attr(*, "class")= atomic [1:1] CRS
>    .. ..- attr(*, "package")= chr "sp"
> - attr(*, "coords")= num [1:111, 1:2] 1131900 1120300 1092600 1114200  
> 1092600 ...
>    ..- attr(*, "dimnames")=List of 2
>    .. ..$ : NULL
>    .. ..$ : chr [1:2] "slongitude" "slatitude"
> - attr(*, "data")= list()
>    ..- attr(*, "att")=List of 37
>    .. ..$ PC1 : num [1:111]   -8.10 -191.88   -9.30  -28.90   -8.12 ...
>    .. ..$ PC2 : num [1:111] -25.05 316.29  -9.20 -20.25  -8.59 ...
>    .. ..$ PC3 : num [1:111]  -17.470 -104.794    0.333   48.261    
> -0.136 ...
>    .. ..$ PC4 : num [1:111]  -7.1660 -99.8927  -0.0452   3.9708   
> -4.5581 ...
>    .. ..$ PC5 : num [1:111]  24.83 210.48  -6.93   3.92 -12.88 ...
>    .. ..$ PC6 : num [1:111]   4.80 -19.21   2.76 -87.98   7.33 ...
>    .. ..$ PC7 : num [1:111] -19.88  -2.51  -2.57 -69.88  -4.70 ...
>    .. ..$ PC8 : num [1:111]   4.42  29.52   3.81 -21.48  12.54 ...
>
> ........
>
>
>
>
>
> Horacio
>
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



From Roger.Bivand at nhh.no  Wed Feb  7 15:32:24 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 7 Feb 2007 15:32:24 +0100 (CET)
Subject: [R-sig-Geo] facing the bad move: how to retrieve old (sp) data
 after an upgrade...?
In-Reply-To: <34DB24C4-E49C-424A-AD98-F07F9C96667C@gmail.com>
Message-ID: <Pine.LNX.4.44.0702071525130.14157-100000@reclus.nhh.no>

On Wed, 7 Feb 2007, Horacio Samaniego wrote:

> I first need to apologize as I  have made a mistake, I know that I  
> should have read the Breaking News before (http://www.sal.uiuc.edu/ 
> tools/tools-sum/rgeo/r-spatial-projects)
> 
> Now I am trying to step back so that I can retrieve my data. However,  
> I don't seem to find old versions of the sp and spdep I need 0.8* of  
> sp as I have messed up my objects 'big time'  by upgrading the whole  
> installation.
> 
> The question is this:
> 
> - What is the best method to make up this error? (I'm hoping that I  
> am not the only one...)
> or
> - Is re-installing old versions of the packages the only method?

Yes, R >= 2.4.0 use a different internal representation for new-style 
class objects.

> 
> - Where can I find the repository for old packages?
> 

If Windows, R itself is at:

http://cran.r-project.org/bin/windows/base/old/2.3.1/R-2.3.1-win32.exe

and sp at:

http://cran.r-project.org/bin/windows/contrib/2.3/sp_0.8-20.zip
(but install.packages("sp") in R 2.3.1 will choose that version)

Otherwise:

http://cran.r-project.org/src/base/R-2/R-2.3.1.tar.gz

http://cran.r-project.org/src/contrib/Archive/S/sp_0.8-20.tar.gz

as the most recent sp < 0.9 - use R CMD INSTALL sp_0.8-20.tar.gz from the 
command line for the old R engine. 

In either case install the old R engine somewhere locally, so that it will 
not damage your new installation, the same with sp. If need be, on some 
other machine.

Hope this helps,

Roger

> thanks in advance! Any hint is appreciated
> 
> The errors I get are not apparent at first sight... but I later tried  
> to retrieve a column of the @data in a SpatialPointsDataFrame object  
> and just got >NULL
> 
> here's the sequence:
> 
>  > pija.scoressp at data[,1]
> Error in pija.scoressp at data[, 1] : incorrect number of dimensions
>  > pija.scoressp at data$PC1
> NULL
>  > names(pija.scoressp at data)
> NULL
> 
> However I can see the data with str():
>  > str(pija.scoressp)
> list()
> - attr(*, "bbox")= num [1:2, 1:2] 1032800  333100 1211500  474500
>    ..- attr(*, "dimnames")=List of 2
>    .. ..$ : chr [1:2] "slongitude" "slatitude"
>    .. ..$ : chr [1:2] "min" "max"
> - attr(*, "proj4string")= list()
>    ..- attr(*, "projargs")= chr "+proj=aea +lat_0=23.0000000000  
> +lat_1=29.5000000000 +lat_2=45.5000000000 +lon_0=-96.0000000000  
> +x_0=0.0000000000 +y_0=0.0000000"| __truncated__
>    ..- attr(*, "class")= atomic [1:1] CRS
>    .. ..- attr(*, "package")= chr "sp"
> - attr(*, "coords")= num [1:111, 1:2] 1131900 1120300 1092600 1114200  
> 1092600 ...
>    ..- attr(*, "dimnames")=List of 2
>    .. ..$ : NULL
>    .. ..$ : chr [1:2] "slongitude" "slatitude"
> - attr(*, "data")= list()
>    ..- attr(*, "att")=List of 37
>    .. ..$ PC1 : num [1:111]   -8.10 -191.88   -9.30  -28.90   -8.12 ...
>    .. ..$ PC2 : num [1:111] -25.05 316.29  -9.20 -20.25  -8.59 ...
>    .. ..$ PC3 : num [1:111]  -17.470 -104.794    0.333   48.261    
> -0.136 ...
>    .. ..$ PC4 : num [1:111]  -7.1660 -99.8927  -0.0452   3.9708   
> -4.5581 ...
>    .. ..$ PC5 : num [1:111]  24.83 210.48  -6.93   3.92 -12.88 ...
>    .. ..$ PC6 : num [1:111]   4.80 -19.21   2.76 -87.98   7.33 ...
>    .. ..$ PC7 : num [1:111] -19.88  -2.51  -2.57 -69.88  -4.70 ...
>    .. ..$ PC8 : num [1:111]   4.42  29.52   3.81 -21.48  12.54 ...
> 
> ........
> 
> 
> 
> 
> 
> Horacio
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Roger.Bivand at nhh.no  Wed Feb  7 16:15:05 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 7 Feb 2007 16:15:05 +0100 (CET)
Subject: [R-sig-Geo] facing the bad move: how to retrieve old (sp) data
 after an upgrade...?
In-Reply-To: <45C9E02C.1030507@geo.uu.nl>
Message-ID: <Pine.LNX.4.44.0702071610000.14157-100000@reclus.nhh.no>

On Wed, 7 Feb 2007, Edzer J. Pebesma wrote:

> Perhaps try
> 
>  > pija.scoressp at data@att[[1]]

For R < 2.4, the magic was that the new style classes were empty lists 
with all the data in attributes, so this might be:

attr(attr(pija.scoressp, "data"), "att")[[1]]

(untried)

Roger

> 
> etc.
> --
> Edzer
> 
> Horacio Samaniego wrote:
> > I first need to apologize as I  have made a mistake, I know that I  
> > should have read the Breaking News before (http://www.sal.uiuc.edu/ 
> > tools/tools-sum/rgeo/r-spatial-projects)
> >
> > Now I am trying to step back so that I can retrieve my data. However,  
> > I don't seem to find old versions of the sp and spdep I need 0.8* of  
> > sp as I have messed up my objects 'big time'  by upgrading the whole  
> > installation.
> >
> > The question is this:
> >
> > - What is the best method to make up this error? (I'm hoping that I  
> > am not the only one...)
> > or
> > - Is re-installing old versions of the packages the only method?
> >
> > - Where can I find the repository for old packages?
> >
> > thanks in advance! Any hint is appreciated
> >
> > The errors I get are not apparent at first sight... but I later tried  
> > to retrieve a column of the @data in a SpatialPointsDataFrame object  
> > and just got >NULL
> >
> > here's the sequence:
> >
> >  > pija.scoressp at data[,1]
> > Error in pija.scoressp at data[, 1] : incorrect number of dimensions
> >  > pija.scoressp at data$PC1
> > NULL
> >  > names(pija.scoressp at data)
> > NULL
> >
> > However I can see the data with str():
> >  > str(pija.scoressp)
> > list()
> > - attr(*, "bbox")= num [1:2, 1:2] 1032800  333100 1211500  474500
> >    ..- attr(*, "dimnames")=List of 2
> >    .. ..$ : chr [1:2] "slongitude" "slatitude"
> >    .. ..$ : chr [1:2] "min" "max"
> > - attr(*, "proj4string")= list()
> >    ..- attr(*, "projargs")= chr "+proj=aea +lat_0=23.0000000000  
> > +lat_1=29.5000000000 +lat_2=45.5000000000 +lon_0=-96.0000000000  
> > +x_0=0.0000000000 +y_0=0.0000000"| __truncated__
> >    ..- attr(*, "class")= atomic [1:1] CRS
> >    .. ..- attr(*, "package")= chr "sp"
> > - attr(*, "coords")= num [1:111, 1:2] 1131900 1120300 1092600 1114200  
> > 1092600 ...
> >    ..- attr(*, "dimnames")=List of 2
> >    .. ..$ : NULL
> >    .. ..$ : chr [1:2] "slongitude" "slatitude"
> > - attr(*, "data")= list()
> >    ..- attr(*, "att")=List of 37
> >    .. ..$ PC1 : num [1:111]   -8.10 -191.88   -9.30  -28.90   -8.12 ...
> >    .. ..$ PC2 : num [1:111] -25.05 316.29  -9.20 -20.25  -8.59 ...
> >    .. ..$ PC3 : num [1:111]  -17.470 -104.794    0.333   48.261    
> > -0.136 ...
> >    .. ..$ PC4 : num [1:111]  -7.1660 -99.8927  -0.0452   3.9708   
> > -4.5581 ...
> >    .. ..$ PC5 : num [1:111]  24.83 210.48  -6.93   3.92 -12.88 ...
> >    .. ..$ PC6 : num [1:111]   4.80 -19.21   2.76 -87.98   7.33 ...
> >    .. ..$ PC7 : num [1:111] -19.88  -2.51  -2.57 -69.88  -4.70 ...
> >    .. ..$ PC8 : num [1:111]   4.42  29.52   3.81 -21.48  12.54 ...
> >
> > ........
> >
> >
> >
> >
> >
> > Horacio
> >
> >
> >
> > 	[[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From drf5n at maplepark.com  Wed Feb  7 18:25:28 2007
From: drf5n at maplepark.com (David Forrest)
Date: Wed, 7 Feb 2007 11:25:28 -0600 (CST)
Subject: [R-sig-Geo] Shifting a spatial object by (dx,dy)
Message-ID: <Pine.LNX.4.64.0702071103110.20306@maplepark.com>

Hi,

I've got a mis-projected UTM zone 18 polygon shapefile, the coordinates of 
which need a transformation of (+287.4395, -77.5542) added to them to be 
in WGS84/NAD83 UTM 18.  Since this is a non-standard CRS / non-EPSG CRS, 
I'm not sure about the best way to fix it.

Is there some function that would add this offset to the component 
polygon coordinates, bbox, and labpts data?

Dave
-- 
  Dr. David Forrest
  drf at vims.edu                                    (804)684-7900w
  drf5n at maplepark.com                             (804)642-0662h
                                    http://maplepark.com/~drf5n/



From Roger.Bivand at nhh.no  Wed Feb  7 18:46:56 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 7 Feb 2007 18:46:56 +0100 (CET)
Subject: [R-sig-Geo] Shifting a spatial object by (dx,dy)
In-Reply-To: <Pine.LNX.4.64.0702071103110.20306@maplepark.com>
Message-ID: <Pine.LNX.4.44.0702071841390.14157-100000@reclus.nhh.no>

On Wed, 7 Feb 2007, David Forrest wrote:

> Hi,
> 
> I've got a mis-projected UTM zone 18 polygon shapefile, the coordinates of 
> which need a transformation of (+287.4395, -77.5542) added to them to be 
> in WGS84/NAD83 UTM 18.  Since this is a non-standard CRS / non-EPSG CRS, 
> I'm not sure about the best way to fix it.
> 
> Is there some function that would add this offset to the component 
> polygon coordinates, bbox, and labpts data?

No, although it could be done by picking things apart and shifting them 
point for point. My first choice would be to hand-craft a +proj=tmerc CRS 
for the shifted data and use spTransform() in rgdal to move it, probably 
by making the modifications in +x_0= and +y_0= in relation to the correct 
ones for the UTM zone. When the differences between the bounding boxes or 
label points of the input and output data are correct, the fake CRS will 
be the right one.

http://www.remotesensing.org/geotiff/proj_list/transverse_mercator.html

has lots of information.

Roger

> 
> Dave
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From drf5n at maplepark.com  Wed Feb  7 19:53:59 2007
From: drf5n at maplepark.com (David Forrest)
Date: Wed, 7 Feb 2007 12:53:59 -0600 (CST)
Subject: [R-sig-Geo] Shifting a spatial object by (dx,dy)
In-Reply-To: <Pine.LNX.4.44.0702071841390.14157-100000@reclus.nhh.no>
References: <Pine.LNX.4.44.0702071841390.14157-100000@reclus.nhh.no>
Message-ID: <Pine.LNX.4.64.0702071250450.20306@maplepark.com>

On Wed, 7 Feb 2007, Roger Bivand wrote:

> On Wed, 7 Feb 2007, David Forrest wrote:
>
>> Hi,
>>
>> I've got a mis-projected UTM zone 18 polygon shapefile, the coordinates of
>> which need a transformation of (+287.4395, -77.5542) added to them to be
>> in WGS84/NAD83 UTM 18.  Since this is a non-standard CRS / non-EPSG CRS,
>> I'm not sure about the best way to fix it.
>>
>> Is there some function that would add this offset to the component
>> polygon coordinates, bbox, and labpts data?
>
> No, although it could be done by picking things apart and shifting them
> point for point. My first choice would be to hand-craft a +proj=tmerc CRS
> for the shifted data and use spTransform() in rgdal to move it, probably
> by making the modifications in +x_0= and +y_0= in relation to the correct
> ones for the UTM zone. When the differences between the bounding boxes or
> label points of the input and output data are correct, the fake CRS will
> be the right one.

Fiddling with UTM's +x_0 and +y_0 options sounds good -- I tried a optim() 
over the towgs84 parameter space to minimizes the errors on my small set 
known points and thought it was doing some rotations I didn't trust..

Thanks,
-- 
  Dr. David Forrest
  drf at vims.edu                                    (804)684-7900w
  drf5n at maplepark.com                             (804)642-0662h
                                    http://maplepark.com/~drf5n/



From hi_ono2001 at yahoo.co.jp  Thu Feb  8 02:16:33 2007
From: hi_ono2001 at yahoo.co.jp (Hisaji ONO)
Date: Thu, 8 Feb 2007 10:16:33 +0900 (JST)
Subject: [R-sig-Geo] Any example using UMN Mapserver with R
In-Reply-To: <45C9927E.5070902@geo.uu.nl>
Message-ID: <20070208011633.70096.qmail@web10909.mail.bbt.yahoo.co.jp>

Thank you for your help, Paul.

 I've tried to test PHP for R, but not with MapServer.



 Regards.

 
--- Paul Hiemstra <p.hiemstra at geo.uu.nl> wrote:

> You can link MapServer and R by using MapServer in
> mapscript mode. The 
> next step would be to find an extension that links R
> to this the 
> programming language of your choice (Python, Perl,
> php). I myself use 
> Python (www.python.org) in combination with the rpy
> extension 
> (http://rpy.sourceforge.net/). Rpy allows R
> functions to be called from 
> within a python script. I haven't tried this
> combination of 
> MapServer/Python/R myself and do not know what is
> possible and what not, 
> but is certainly worthwhile to give it a try.
>



From hi_ono2001 at yahoo.co.jp  Thu Feb  8 02:20:18 2007
From: hi_ono2001 at yahoo.co.jp (Hisaji ONO)
Date: Thu, 8 Feb 2007 10:20:18 +0900 (JST)
Subject: [R-sig-Geo] Any Grid Computing or Pararrel Processing using R for
	spatial analysis
Message-ID: <20070208012018.74529.qmail@web10913.mail.bbt.yahoo.co.jp>

Hello.

 Does anyone know examples using grid computing using R
for spatial analysis, or geocomputaion(computational
geography) like Stan Openshaw's works?



 Regards.



From Roger.Bivand at nhh.no  Thu Feb  8 09:45:43 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 8 Feb 2007 09:45:43 +0100 (CET)
Subject: [R-sig-Geo] Any Grid Computing or Pararrel Processing using R
 for spatial analysis
In-Reply-To: <20070208012018.74529.qmail@web10913.mail.bbt.yahoo.co.jp>
Message-ID: <Pine.LNX.4.44.0702080923460.15143-100001@reclus.nhh.no>

On Thu, 8 Feb 2007, Hisaji ONO wrote:

> Hello.
> 
>  Does anyone know examples using grid computing using R
> for spatial analysis, or geocomputaion(computational
> geography) like Stan Openshaw's works?
> 

A good deal of the infrastructure is there, this example is on an oldish 
twin processor Xeon 32-bit box using sockets, but I've looked at Duo as 
well, which under Linux and I believe OSX is recognised as SMP:

library(snow)
cl <- makeCluster(c("localhost","localhost"), type = "SOCK")
cl
library(maptools)
library(gpclib)
clusterEvalQ(cl,library(maptools))
clusterEvalQ(cl,library(gpclib))
nc1 <- readShapePoly(system.file("shapes/sids.shp", package="maptools")[1],
 proj4string=CRS("+proj=longlat +ellps=clrk66"))
pl <- slot(nc1, "polygons")
system.time(pl_new <- lapply(pl, checkPolygonsHoles))
system.time(pl_new_c <- parLapply(cl, pl, checkPolygonsHoles))
stopCluster(cl)

with system times on a single processor:

> system.time(pl_new <- lapply(pl, checkPolygonsHoles))
[1] 3.650 0.002 3.651 0.000 0.000

and using two:

> system.time(pl_new_c <- parLapply(cl, pl, checkPolygonsHoles))
[1] 0.024 0.002 2.006 0.000 0.000

so a speed-up of 3.651/2.006 with a very simple setup (system monitor PNG
attached). Putting more work into configuring MPI or PVM would increase
the benefits. But note that snow means Simple Network of Workstations, and
is only for "embarrassingly parallel" work, especially work where each
node takes its share of the data and does its work without communicating
with the other nodes until completion. Essentially where lapply() works,
parLapply() should work. I haven't looked at spTransform(), but that would
be another candidate. The snow package is not available for Windows.

Hope this helps,

Roger

> 
> 
>  Regards.
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

-------------- next part --------------
A non-text attachment was scrubbed...
Name: snow.png
Type: image/png
Size: 4888 bytes
Desc: 
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070208/135c5294/attachment.png>

From stanimura-ngs at umin.ac.jp  Fri Feb  9 18:02:11 2007
From: stanimura-ngs at umin.ac.jp (Susumu Tanimura)
Date: Sat, 10 Feb 2007 02:02:11 +0900
Subject: [R-sig-Geo] ring not closed - readShapePoly - read.shape -
 maptools
In-Reply-To: <4593E9D8.60006@univ-fcomte.fr>
References: <4593E3BD.2050401@univ-fcomte.fr> <4593E9D8.60006@univ-fcomte.fr>
Message-ID: <20070210020211.96ddd83d.stanimura-ngs@umin.ac.jp>

Hi there,

The same problem happened to me when I used the shape file that is
sold as commercial products.

> getinfo.shape("Phu_Yen_Commune_ll_region.shp")
Shapefile type: Polygon, (5), # of Shapes: 104
> a <- read.shape("Phu_Yen_Commune_ll_region.shp")
Field name:  1__PERS  changed to:  X1__PERS 
Field name:  2_PERS  changed to:  X2_PERS 
Field name:  3_PERS  changed to:  X3_PERS 
       [snip]
Shapefile type: Polygon, (5), # of Shapes: 104
> b <- readShapePoly("Phu_Yen_Commune_ll_region.shp",verbose=TRUE)
Field name:  1__PERS  changed to:  X1__PERS 
Field name:  2_PERS  changed to:  X2_PERS 
Field name:  3_PERS  changed to:  X3_PERS 
       [snip]
Shapefile type: Polygon, (5), # of Shapes: 104
Error in validityMethod(object) : ring not closed

So, read.shape seems to be OK, but readShapePoly does not.  Since
readShapePoly uses internally read.shape and then Map object is passed
to .Map2PolyDF(), I tried to find Map2PolyDF or validityMethod in
source of maptools and sp package.  However, I could not find them.

Dose anybody have better solution?

> OK... after a check, none of the rings are closed... suppose closing was 
> managed automatically by ArcGIS and read.Shape...
> 
> 
> Patrick Giraudoux a ?crit :
> > Hi,
> >
> > I have slept on some data of a project which started in 2003 and  just 
> > coming back on them today gives the opportunity to compare read.shape 
> > (shapefiles were initially imported with this function) and 
> > readShapePoly (the new one sp style). The latter will be much more 
> > interesting for the next step, giving directed handling to overlay 
> > methods.
> >
> > Importing one of my shapefile with read.shape ( read as polyshape in 
> > ArcGIS) made (and still makes) no problem. However, when I try to 
> > import it again via readShapePoly, I get this message:
> >
> > > UG<-readShapePoly("U:/Documents and Settings/giraudoux/Mes 
> > documents/FC25/NewSIG050317/UG.shp")
> > Error in validityMethod(object) : ring not closed
> >
> > Clear enough: at least one of the polygons is not closed... which is 
> > confirmed by the fact that I can import the shapefile easy with 
> > readShapeLines. I suppose the readShapePoly is more demanding in 
> > validity control than the older read.Shape and ArcGIS: one cannot 
> > complain for that.
> >
> > I am not afraid of sorting this out with some lines of programme. I 
> > have however a question before writing it: is there already a function 
> > making a check somewhere which could be used to know which one(s) of 
> > the polygons are not closed?
> >
> > Patrick

--
Susumu Tanimura MSc PhD
Dept. of Socio-environmental Medicine
Inst. of Tropical Medicine, Nagasaki University
TEL +81-95-849-7865 FAX +81-95-849-7867
e-mail stanimura-ngs at umin.ac.jp



From Roger.Bivand at nhh.no  Fri Feb  9 19:35:39 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 9 Feb 2007 19:35:39 +0100 (CET)
Subject: [R-sig-Geo] ring not closed - readShapePoly - read.shape -
 maptools
In-Reply-To: <20070210020211.96ddd83d.stanimura-ngs@umin.ac.jp>
Message-ID: <Pine.LNX.4.44.0702091926430.16775-100000@reclus.nhh.no>

On Sat, 10 Feb 2007, Susumu Tanimura wrote:

> Hi there,

> The same problem happened to me when I used the shape file that is
> sold as commercial products.

> > getinfo.shape("Phu_Yen_Commune_ll_region.shp")
> Shapefile type: Polygon, (5), # of Shapes: 104
> a <- read.shape("Phu_Yen_Commune_ll_region.shp")
> Field name:  1__PERS  changed to:  X1__PERS 
> Field name:  2_PERS  changed to:  X2_PERS 
> Field name:  3_PERS  changed to:  X3_PERS 
>        [snip]
> Shapefile type: Polygon, (5), # of Shapes: 104
> > b <- readShapePoly("Phu_Yen_Commune_ll_region.shp",verbose=TRUE)
> Field name:  1__PERS  changed to:  X1__PERS 
> Field name:  2_PERS  changed to:  X2_PERS 
> Field name:  3_PERS  changed to:  X3_PERS 
>        [snip]
> Shapefile type: Polygon, (5), # of Shapes: 104
> Error in validityMethod(object) : ring not closed

> So, read.shape seems to be OK, but readShapePoly does not.  Since
> readShapePoly uses internally read.shape and then Map object is passed
> to .Map2PolyDF(), I tried to find Map2PolyDF or validityMethod in
> source of maptools and sp package.  However, I could not find them.

> Dose anybody have better solution?

Patrick, Susumu,

Could (either or both) you please make sample files available? I think 
that readOGR() will do the same as readShapePoly(), even though it does 
not use the same intermediate R code (same shapelib code in OGR). The 
internal function .Map2PolyDF can be accessed inside the maptools 
namespace as maptools:::.Map2PolyDF; it calls 
maptools:::.asSpatialPolygonsShapes, calling maptools:::.shp2srsI. This 
calls Polygon() with coords set to the current ring, so if it isn't 
closed, no check is made. It would be possible to pass an argument through 
closing unclosed rings if TRUE, default FALSE.

Best wishes,

Roger


> OK... after a check, none of the rings are closed... suppose closing was 
> managed automatically by ArcGIS and read.Shape...
> 
> 
> Patrick Giraudoux a ??crit :
> > Hi,
> >
> > I have slept on some data of a project which started in 2003 and  just 
> > coming back on them today gives the opportunity to compare read.shape 
> > (shapefiles were initially imported with this function) and 
> > readShapePoly (the new one sp style). The latter will be much more 
> > interesting for the next step, giving directed handling to overlay 
> > methods.
> >
> > Importing one of my shapefile with read.shape ( read as polyshape in 
> > ArcGIS) made (and still makes) no problem. However, when I try to 
> > import it again via readShapePoly, I get this message:
> >
> > > UG<-readShapePoly("U:/Documents and Settings/giraudoux/Mes 
> > documents/FC25/NewSIG050317/UG.shp")
> > Error in validityMethod(object) : ring not closed
> >
> > Clear enough: at least one of the polygons is not closed... which is 
> > confirmed by the fact that I can import the shapefile easy with 
> > readShapeLines. I suppose the readShapePoly is more demanding in 
> > validity control than the older read.Shape and ArcGIS: one cannot 
> > complain for that.
> >
> > I am not afraid of sorting this out with some lines of programme. I 
> > have however a question before writing it: is there already a function 
> > making a check somewhere which could be used to know which one(s) of 
> > the polygons are not closed?
> >
> > Patrick

--
Susumu Tanimura MSc PhD
Dept. of Socio-environmental Medicine
Inst. of Tropical Medicine, Nagasaki University
TEL +81-95-849-7865 FAX +81-95-849-7867
e-mail stanimura-ngs at umin.ac.jp

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Olsen.Tony at epamail.epa.gov  Fri Feb  9 20:01:44 2007
From: Olsen.Tony at epamail.epa.gov (Olsen.Tony at epamail.epa.gov)
Date: Fri, 9 Feb 2007 11:01:44 -0800
Subject: [R-sig-Geo] ring not closed - readShapePoly - read.shape -
	maptools
In-Reply-To: <Pine.LNX.4.44.0702091926430.16775-100000@reclus.nhh.no>
Message-ID: <OFBC327E35.D2FD96B2-ON8825727D.00683CF9-8825727D.00688769@epamail.epa.gov>

A new package, spsurvey, has function to read ESRI shapefiles -
read.shape and read.dbf.  The result is an sp spatial object.  The
functions read point, line, and polygon shapefiles.  package is on CRAN.
We have encountered all types of issues with shapefiles so may handle
your problem.

Tony



                                                                        
             Roger Bivand                                               
             <Roger.Bivand at nh                                           
             h.no>                                                   To 
             Sent by:                 Susumu Tanimura                   
             r-sig-geo-bounce         <stanimura-ngs at umin.ac.jp>        
             s at stat.math.ethz                                        cc 
             .ch                      r-sig-geo at stat.math.ethz.ch,      
                                      patrick.giraudoux at univ-fcomte.fr  
                                                                Subject 
             02/09/2007 10:35         Re: [R-sig-Geo] ring not closed - 
             AM                       readShapePoly - read.shape -      
                                      maptools                          
                                                                        
              Please respond                                            
                    to                                                  
             Roger.Bivand at nhh                                           
                   .no                                                  
                                                                        
                                                                        




On Sat, 10 Feb 2007, Susumu Tanimura wrote:

> Hi there,

> The same problem happened to me when I used the shape file that is
> sold as commercial products.

> > getinfo.shape("Phu_Yen_Commune_ll_region.shp")
> Shapefile type: Polygon, (5), # of Shapes: 104
> a <- read.shape("Phu_Yen_Commune_ll_region.shp")
> Field name:  1__PERS  changed to:  X1__PERS
> Field name:  2_PERS  changed to:  X2_PERS
> Field name:  3_PERS  changed to:  X3_PERS
>        [snip]
> Shapefile type: Polygon, (5), # of Shapes: 104
> > b <- readShapePoly("Phu_Yen_Commune_ll_region.shp",verbose=TRUE)
> Field name:  1__PERS  changed to:  X1__PERS
> Field name:  2_PERS  changed to:  X2_PERS
> Field name:  3_PERS  changed to:  X3_PERS
>        [snip]
> Shapefile type: Polygon, (5), # of Shapes: 104
> Error in validityMethod(object) : ring not closed

> So, read.shape seems to be OK, but readShapePoly does not.  Since
> readShapePoly uses internally read.shape and then Map object is passed
> to .Map2PolyDF(), I tried to find Map2PolyDF or validityMethod in
> source of maptools and sp package.  However, I could not find them.

> Dose anybody have better solution?

Patrick, Susumu,

Could (either or both) you please make sample files available? I think
that readOGR() will do the same as readShapePoly(), even though it does
not use the same intermediate R code (same shapelib code in OGR). The
internal function .Map2PolyDF can be accessed inside the maptools
namespace as maptools:::.Map2PolyDF; it calls
maptools:::.asSpatialPolygonsShapes, calling maptools:::.shp2srsI. This
calls Polygon() with coords set to the current ring, so if it isn't
closed, no check is made. It would be possible to pass an argument
through
closing unclosed rings if TRUE, default FALSE.

Best wishes,

Roger


> OK... after a check, none of the rings are closed... suppose closing
was
> managed automatically by ArcGIS and read.Shape...
>
>
> Patrick Giraudoux a ??crit :
> > Hi,
> >
> > I have slept on some data of a project which started in 2003 and
just
> > coming back on them today gives the opportunity to compare
read.shape
> > (shapefiles were initially imported with this function) and
> > readShapePoly (the new one sp style). The latter will be much more
> > interesting for the next step, giving directed handling to overlay
> > methods.
> >
> > Importing one of my shapefile with read.shape ( read as polyshape in

> > ArcGIS) made (and still makes) no problem. However, when I try to
> > import it again via readShapePoly, I get this message:
> >
> > > UG<-readShapePoly("U:/Documents and Settings/giraudoux/Mes
> > documents/FC25/NewSIG050317/UG.shp")
> > Error in validityMethod(object) : ring not closed
> >
> > Clear enough: at least one of the polygons is not closed... which is

> > confirmed by the fact that I can import the shapefile easy with
> > readShapeLines. I suppose the readShapePoly is more demanding in
> > validity control than the older read.Shape and ArcGIS: one cannot
> > complain for that.
> >
> > I am not afraid of sorting this out with some lines of programme. I
> > have however a question before writing it: is there already a
function
> > making a check somewhere which could be used to know which one(s) of

> > the polygons are not closed?
> >
> > Patrick

--
Susumu Tanimura MSc PhD
Dept. of Socio-environmental Medicine
Inst. of Tropical Medicine, Nagasaki University
TEL +81-95-849-7865 FAX +81-95-849-7867
e-mail stanimura-ngs at umin.ac.jp

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


--
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch
https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From Roger.Bivand at nhh.no  Fri Feb  9 20:30:36 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 9 Feb 2007 20:30:36 +0100 (CET)
Subject: [R-sig-Geo] ring not closed - readShapePoly - read.shape -
 maptools
In-Reply-To: <OFBC327E35.D2FD96B2-ON8825727D.00683CF9-8825727D.00688769@epamail.epa.gov>
Message-ID: <Pine.LNX.4.44.0702092026440.16775-100000@reclus.nhh.no>

On Fri, 9 Feb 2007 Olsen.Tony at epamail.epa.gov wrote:

> A new package, spsurvey, has function to read ESRI shapefiles -
> read.shape and read.dbf.  The result is an sp spatial object.  The
> functions read point, line, and polygon shapefiles.  package is on CRAN.
> We have encountered all types of issues with shapefiles so may handle
> your problem.

Thanks, the issue here is that the first and final row of the 
shape$verts[from[i]:to[i],] slice are not equal, so Polygon() throws an 
error, because this isn't a ring. Polygon() cannot take a closure 
argument, but the function in spsurvey or that in maptools could. It's 
certainly worth trying, a further alternative is the function in the 
shapefiles package that just uses connections.

Roger

> 
> Tony
> 
> 
> 
>                                                                        
>              Roger Bivand                                              
>              <Roger.Bivand at nh                                          
>              h.no>                                                   To
>              Sent by:                 Susumu Tanimura                  
>              r-sig-geo-bounce         <stanimura-ngs at umin.ac.jp>       
>              s at stat.math.ethz                                        cc
>              .ch                      r-sig-geo at stat.math.ethz.ch,     
>                                       patrick.giraudoux at univ-fcomte.fr 
>                                                                 Subject
>              02/09/2007 10:35         Re: [R-sig-Geo] ring not closed -
>              AM                       readShapePoly - read.shape -     
>                                       maptools                         
>                                                                        
>               Please respond                                           
>                     to                                                 
>              Roger.Bivand at nhh                                          
>                    .no                                                 
>                                                                        
>                                                                        
> 
> 
> 
> 
> On Sat, 10 Feb 2007, Susumu Tanimura wrote:
> 
> > Hi there,
> 
> > The same problem happened to me when I used the shape file that is
> > sold as commercial products.
> 
> > > getinfo.shape("Phu_Yen_Commune_ll_region.shp")
> > Shapefile type: Polygon, (5), # of Shapes: 104
> > a <- read.shape("Phu_Yen_Commune_ll_region.shp")
> > Field name:  1__PERS  changed to:  X1__PERS
> > Field name:  2_PERS  changed to:  X2_PERS
> > Field name:  3_PERS  changed to:  X3_PERS
> >        [snip]
> > Shapefile type: Polygon, (5), # of Shapes: 104
> > > b <- readShapePoly("Phu_Yen_Commune_ll_region.shp",verbose=TRUE)
> > Field name:  1__PERS  changed to:  X1__PERS
> > Field name:  2_PERS  changed to:  X2_PERS
> > Field name:  3_PERS  changed to:  X3_PERS
> >        [snip]
> > Shapefile type: Polygon, (5), # of Shapes: 104
> > Error in validityMethod(object) : ring not closed
> 
> > So, read.shape seems to be OK, but readShapePoly does not.  Since
> > readShapePoly uses internally read.shape and then Map object is passed
> > to .Map2PolyDF(), I tried to find Map2PolyDF or validityMethod in
> > source of maptools and sp package.  However, I could not find them.
> 
> > Dose anybody have better solution?
> 
> Patrick, Susumu,
> 
> Could (either or both) you please make sample files available? I think
> that readOGR() will do the same as readShapePoly(), even though it does
> not use the same intermediate R code (same shapelib code in OGR). The
> internal function .Map2PolyDF can be accessed inside the maptools
> namespace as maptools:::.Map2PolyDF; it calls
> maptools:::.asSpatialPolygonsShapes, calling maptools:::.shp2srsI. This
> calls Polygon() with coords set to the current ring, so if it isn't
> closed, no check is made. It would be possible to pass an argument
> through
> closing unclosed rings if TRUE, default FALSE.
> 
> Best wishes,
> 
> Roger
> 
> 
> > OK... after a check, none of the rings are closed... suppose closing
> was
> > managed automatically by ArcGIS and read.Shape...
> >
> >
> > Patrick Giraudoux a ??crit :
> > > Hi,
> > >
> > > I have slept on some data of a project which started in 2003 and
> just
> > > coming back on them today gives the opportunity to compare
> read.shape
> > > (shapefiles were initially imported with this function) and
> > > readShapePoly (the new one sp style). The latter will be much more
> > > interesting for the next step, giving directed handling to overlay
> > > methods.
> > >
> > > Importing one of my shapefile with read.shape ( read as polyshape in
> 
> > > ArcGIS) made (and still makes) no problem. However, when I try to
> > > import it again via readShapePoly, I get this message:
> > >
> > > > UG<-readShapePoly("U:/Documents and Settings/giraudoux/Mes
> > > documents/FC25/NewSIG050317/UG.shp")
> > > Error in validityMethod(object) : ring not closed
> > >
> > > Clear enough: at least one of the polygons is not closed... which is
> 
> > > confirmed by the fact that I can import the shapefile easy with
> > > readShapeLines. I suppose the readShapePoly is more demanding in
> > > validity control than the older read.Shape and ArcGIS: one cannot
> > > complain for that.
> > >
> > > I am not afraid of sorting this out with some lines of programme. I
> > > have however a question before writing it: is there already a
> function
> > > making a check somewhere which could be used to know which one(s) of
> 
> > > the polygons are not closed?
> > >
> > > Patrick
> 
> --
> Susumu Tanimura MSc PhD
> Dept. of Socio-environmental Medicine
> Inst. of Tropical Medicine, Nagasaki University
> TEL +81-95-849-7865 FAX +81-95-849-7867
> e-mail stanimura-ngs at umin.ac.jp
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 
> --
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From andrew.niccolai at yale.edu  Fri Feb  9 20:35:01 2007
From: andrew.niccolai at yale.edu (Andrew Niccolai)
Date: Fri, 9 Feb 2007 14:35:01 -0500
Subject: [R-sig-Geo] Identifying overlapping polygons
Message-ID: <002401c74c81$645913c0$0302a8c0@D3K86YB1>

Hi.  I am relatively new to Spatial-R.  I have two objects that are both
SpatialPolygonsDataFrame classes.  One is comprised of polygons from a
section of a segmented image and the other is essentially circular polygons
representing the potential areas that the crowns of known tree locations
might cover.  I would like to identify every polygon from the first object
(image segmentation polys) that completely are even partially (hopefully I
can control the "partial" threshold) falls within any given polygon from the
second object (crown areas).  In ArcGIS this can be accomplished using the
Identity application under ArcToolbox.  I was hoping to accomplish the same
feats in R.  Any help would be greatly appreciated!!

Andrew Niccolai
Doctoral Candidate
Yale School of Forestry



From Roger.Bivand at nhh.no  Fri Feb  9 20:56:08 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 9 Feb 2007 20:56:08 +0100 (CET)
Subject: [R-sig-Geo] Identifying overlapping polygons
In-Reply-To: <002401c74c81$645913c0$0302a8c0@D3K86YB1>
Message-ID: <Pine.LNX.4.44.0702092052350.16775-100000@reclus.nhh.no>

On Fri, 9 Feb 2007, Andrew Niccolai wrote:

> Hi.  I am relatively new to Spatial-R.  I have two objects that are both
> SpatialPolygonsDataFrame classes.  One is comprised of polygons from a
> section of a segmented image and the other is essentially circular polygons
> representing the potential areas that the crowns of known tree locations
> might cover.  I would like to identify every polygon from the first object
> (image segmentation polys) that completely are even partially (hopefully I
> can control the "partial" threshold) falls within any given polygon from the
> second object (crown areas).  In ArcGIS this can be accomplished using the
> Identity application under ArcToolbox.  I was hoping to accomplish the same
> feats in R.  Any help would be greatly appreciated!!

This is not present yet, but not impossible. If you look in the code of 
the unionSpatialPolygons() function in the maptools package, you will see 
that it uses functions in the gpclib package. Using similar ideas to 
examine either all n by m intersections, or a clever subset by looking at 
bounding box intersections first, it ought to be feasible. You'll need to 
be prepared to code it, though.

Roger

> 
> Andrew Niccolai
> Doctoral Candidate
> Yale School of Forestry
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Greg.Snow at intermountainmail.org  Fri Feb  9 22:27:13 2007
From: Greg.Snow at intermountainmail.org (Greg Snow)
Date: Fri, 9 Feb 2007 14:27:13 -0700
Subject: [R-sig-Geo] Identifying overlapping polygons
Message-ID: <07E228A5BE53C24CAD490193A7381BBB7FCBF1@LP-EXCHVS07.CO.IHC.COM>

Andrew,

Util the functionality is programmed in, here is a quick approximation
to what you want:

1. generate a large number of random (or gridded) points within the
polygon of interest in the first object (sample.polygon function in
package sp).
2. use the overlay function in the sp package to find out which polygons
in object 2 the random points fall into.  You know these overlap. 

If there is a polygon in object 1 that only slightly overlaps a polygon
in object 2, then you are unlikely to detect that using this method, but
your statement about controlling the "Partial" indicates that this may
be a good thing.

Turning this around and generating the points from object 2 and seeing
which polygon in object 1 they are in will tell you if the polygon in
object 2 is completely overlapped by the one in 1.

Hope this helps,

-- 
Gregory (Greg) L. Snow Ph.D.
Statistical Data Center
Intermountain Healthcare
greg.snow at intermountainmail.org
(801) 408-8111
 
 

> -----Original Message-----
> From: r-sig-geo-bounces at stat.math.ethz.ch 
> [mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of Roger Bivand
> Sent: Friday, February 09, 2007 12:56 PM
> To: Andrew Niccolai
> Cc: r-sig-geo at stat.math.ethz.ch
> Subject: Re: [R-sig-Geo] Identifying overlapping polygons
> 
> On Fri, 9 Feb 2007, Andrew Niccolai wrote:
> 
> > Hi.  I am relatively new to Spatial-R.  I have two objects that are 
> > both SpatialPolygonsDataFrame classes.  One is comprised of 
> polygons 
> > from a section of a segmented image and the other is essentially 
> > circular polygons representing the potential areas that the 
> crowns of 
> > known tree locations might cover.  I would like to identify every 
> > polygon from the first object (image segmentation polys) that 
> > completely are even partially (hopefully I can control the 
> "partial" 
> > threshold) falls within any given polygon from the second object 
> > (crown areas).  In ArcGIS this can be accomplished using 
> the Identity 
> > application under ArcToolbox.  I was hoping to accomplish 
> the same feats in R.  Any help would be greatly appreciated!!
> 
> This is not present yet, but not impossible. If you look in 
> the code of the unionSpatialPolygons() function in the 
> maptools package, you will see that it uses functions in the 
> gpclib package. Using similar ideas to examine either all n 
> by m intersections, or a clever subset by looking at bounding 
> box intersections first, it ought to be feasible. You'll need 
> to be prepared to code it, though.
> 
> Roger
> 
> > 
> > Andrew Niccolai
> > Doctoral Candidate
> > Yale School of Forestry
> > 
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > 
> 
> --
> Roger Bivand
> Economic Geography Section, Department of Economics, 
> Norwegian School of Economics and Business Administration, 
> Helleveien 30, N-5045 Bergen, Norway. voice: +47 55 95 93 55; 
> fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



From White.Denis at epamail.epa.gov  Fri Feb  9 22:43:41 2007
From: White.Denis at epamail.epa.gov (White.Denis at epamail.epa.gov)
Date: Fri, 9 Feb 2007 13:43:41 -0800
Subject: [R-sig-Geo] Identifying overlapping polygons
In-Reply-To: <07E228A5BE53C24CAD490193A7381BBB7FCBF1@LP-EXCHVS07.CO.IHC.COM>
Message-ID: <OF5D0D5F70.FE865FCB-ON8825727D.0076D4D6-8825727D.00775B18@epamail.epa.gov>

r-sig-geo-bounces at stat.math.ethz.ch wrote on 2007-02-09 13:27:13:

> Andrew,
>
> Util the functionality is programmed in, here is a quick approximation
> to what you want:
>
> 1. generate a large number of random (or gridded) points within the
> polygon of interest in the first object (sample.polygon function in
> package sp).
> 2. use the overlay function in the sp package to find out which
polygons
> in object 2 the random points fall into.  You know these overlap.
>
> If there is a polygon in object 1 that only slightly overlaps a
polygon
> in object 2, then you are unlikely to detect that using this method,
but
> your statement about controlling the "Partial" indicates that this may
> be a good thing.
>
> Turning this around and generating the points from object 2 and seeing
> which polygon in object 1 they are in will tell you if the polygon in
> object 2 is completely overlapped by the one in 1.

An interesting suggestion, emulating the old manual way of computing the
area of a polygon, if you were to use a grid of points whose surrounding
areas (Voronoi polygons) were all identical.  To deal with "partial",
choose the spacing of points (hence areas of Voronoi polygons) to be a
compromise between a desired resolution and computation time, depending
on how many of these comparisons you need to make.

>
> Hope this helps,
>
> --
> Gregory (Greg) L. Snow Ph.D.
> Statistical Data Center
> Intermountain Healthcare
> greg.snow at intermountainmail.org
> (801) 408-8111
>
>
>
> > -----Original Message-----
> > From: r-sig-geo-bounces at stat.math.ethz.ch
> > [mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of Roger
Bivand
> > Sent: Friday, February 09, 2007 12:56 PM
> > To: Andrew Niccolai
> > Cc: r-sig-geo at stat.math.ethz.ch
> > Subject: Re: [R-sig-Geo] Identifying overlapping polygons
> >
> > On Fri, 9 Feb 2007, Andrew Niccolai wrote:
> >
> > > Hi.  I am relatively new to Spatial-R.  I have two objects that
are
> > > both SpatialPolygonsDataFrame classes.  One is comprised of
> > polygons
> > > from a section of a segmented image and the other is essentially
> > > circular polygons representing the potential areas that the
> > crowns of
> > > known tree locations might cover.  I would like to identify every
> > > polygon from the first object (image segmentation polys) that
> > > completely are even partially (hopefully I can control the
> > "partial"
> > > threshold) falls within any given polygon from the second object
> > > (crown areas).  In ArcGIS this can be accomplished using
> > the Identity
> > > application under ArcToolbox.  I was hoping to accomplish
> > the same feats in R.  Any help would be greatly appreciated!!
> >
> > This is not present yet, but not impossible. If you look in
> > the code of the unionSpatialPolygons() function in the
> > maptools package, you will see that it uses functions in the
> > gpclib package. Using similar ideas to examine either all n
> > by m intersections, or a clever subset by looking at bounding
> > box intersections first, it ought to be feasible. You'll need
> > to be prepared to code it, though.
> >
> > Roger
> >
> > >
> > > Andrew Niccolai
> > > Doctoral Candidate
> > > Yale School of Forestry
> > >
> > > _______________________________________________
> > > R-sig-Geo mailing list
> > > R-sig-Geo at stat.math.ethz.ch
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > >
> >
> > --
> > Roger Bivand
> > Economic Geography Section, Department of Economics,
> > Norwegian School of Economics and Business Administration,
> > Helleveien 30, N-5045 Bergen, Norway. voice: +47 55 95 93 55;
> > fax +47 55 95 95 43
> > e-mail: Roger.Bivand at nhh.no
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From Roger.Bivand at nhh.no  Fri Feb  9 22:52:52 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 9 Feb 2007 22:52:52 +0100 (CET)
Subject: [R-sig-Geo] Identifying overlapping polygons
In-Reply-To: <OF5D0D5F70.FE865FCB-ON8825727D.0076D4D6-8825727D.00775B18@epamail.epa.gov>
Message-ID: <Pine.LNX.4.44.0702092247580.16775-100000@reclus.nhh.no>

On Fri, 9 Feb 2007 White.Denis at epamail.epa.gov wrote:

> r-sig-geo-bounces at stat.math.ethz.ch wrote on 2007-02-09 13:27:13:
> 
> > Andrew,
> >
> > Util the functionality is programmed in, here is a quick approximation
> > to what you want:
> >
> > 1. generate a large number of random (or gridded) points within the
> > polygon of interest in the first object (sample.polygon function in
> > package sp).
> > 2. use the overlay function in the sp package to find out which
> polygons
> > in object 2 the random points fall into.  You know these overlap.
> >
> > If there is a polygon in object 1 that only slightly overlaps a
> polygon
> > in object 2, then you are unlikely to detect that using this method,
> but
> > your statement about controlling the "Partial" indicates that this may
> > be a good thing.
> >
> > Turning this around and generating the points from object 2 and seeing
> > which polygon in object 1 they are in will tell you if the polygon in
> > object 2 is completely overlapped by the one in 1.
> 
> An interesting suggestion, emulating the old manual way of computing the
> area of a polygon, if you were to use a grid of points whose surrounding
> areas (Voronoi polygons) were all identical.  To deal with "partial",
> choose the spacing of points (hence areas of Voronoi polygons) to be a
> compromise between a desired resolution and computation time, depending
> on how many of these comparisons you need to make.

Yes, with a good choice of resolution it will get you pretty close without 
any coding, certainly close enough to know whether coding is worth the 
trouble. For a medium resolution grid and running through lunch breaks or 
overnight, it could be all you need. The code in the GE_overlay() function 
in maptools might show how to build an input SpatialGrid to overlay - but 
you'll need to check to use a bounding box to include both sets of 
polygons.

Roger

> 
> >
> > Hope this helps,
> >
> > --
> > Gregory (Greg) L. Snow Ph.D.
> > Statistical Data Center
> > Intermountain Healthcare
> > greg.snow at intermountainmail.org
> > (801) 408-8111
> >
> >
> >
> > > -----Original Message-----
> > > From: r-sig-geo-bounces at stat.math.ethz.ch
> > > [mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of Roger
> Bivand
> > > Sent: Friday, February 09, 2007 12:56 PM
> > > To: Andrew Niccolai
> > > Cc: r-sig-geo at stat.math.ethz.ch
> > > Subject: Re: [R-sig-Geo] Identifying overlapping polygons
> > >
> > > On Fri, 9 Feb 2007, Andrew Niccolai wrote:
> > >
> > > > Hi.  I am relatively new to Spatial-R.  I have two objects that
> are
> > > > both SpatialPolygonsDataFrame classes.  One is comprised of
> > > polygons
> > > > from a section of a segmented image and the other is essentially
> > > > circular polygons representing the potential areas that the
> > > crowns of
> > > > known tree locations might cover.  I would like to identify every
> > > > polygon from the first object (image segmentation polys) that
> > > > completely are even partially (hopefully I can control the
> > > "partial"
> > > > threshold) falls within any given polygon from the second object
> > > > (crown areas).  In ArcGIS this can be accomplished using
> > > the Identity
> > > > application under ArcToolbox.  I was hoping to accomplish
> > > the same feats in R.  Any help would be greatly appreciated!!
> > >
> > > This is not present yet, but not impossible. If you look in
> > > the code of the unionSpatialPolygons() function in the
> > > maptools package, you will see that it uses functions in the
> > > gpclib package. Using similar ideas to examine either all n
> > > by m intersections, or a clever subset by looking at bounding
> > > box intersections first, it ought to be feasible. You'll need
> > > to be prepared to code it, though.
> > >
> > > Roger
> > >
> > > >
> > > > Andrew Niccolai
> > > > Doctoral Candidate
> > > > Yale School of Forestry
> > > >
> > > > _______________________________________________
> > > > R-sig-Geo mailing list
> > > > R-sig-Geo at stat.math.ethz.ch
> > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > >
> > >
> > > --
> > > Roger Bivand
> > > Economic Geography Section, Department of Economics,
> > > Norwegian School of Economics and Business Administration,
> > > Helleveien 30, N-5045 Bergen, Norway. voice: +47 55 95 93 55;
> > > fax +47 55 95 95 43
> > > e-mail: Roger.Bivand at nhh.no
> > >
> > > _______________________________________________
> > > R-sig-Geo mailing list
> > > R-sig-Geo at stat.math.ethz.ch
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > >
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From andrew.niccolai at yale.edu  Fri Feb  9 23:07:19 2007
From: andrew.niccolai at yale.edu (Andrew Niccolai)
Date: Fri, 9 Feb 2007 17:07:19 -0500
Subject: [R-sig-Geo] Identifying overlapping polygons
In-Reply-To: <07E228A5BE53C24CAD490193A7381BBB7FCBF1@LP-EXCHVS07.CO.IHC.COM>
References: <07E228A5BE53C24CAD490193A7381BBB7FCBF1@LP-EXCHVS07.CO.IHC.COM>
Message-ID: <002901c74c96$aada5830$0302a8c0@D3K86YB1>

I am still feeling my way around the "protocol" of this list serve, so I do
not want to clobber the archives with unneccessary communication.  However,
I am compelled to say thanks for the quick turn around and the extremely
helpful suggestions from Greg and Roger.  Thanks and I will let you know how
it ends up! 

-----Original Message-----
From: Greg Snow [mailto:Greg.Snow at intermountainmail.org] 
Sent: Friday, February 09, 2007 4:27 PM
To: Roger.Bivand at nhh.no; Andrew Niccolai
Cc: r-sig-geo at stat.math.ethz.ch
Subject: RE: [R-sig-Geo] Identifying overlapping polygons

Andrew,

Util the functionality is programmed in, here is a quick approximation to
what you want:

1. generate a large number of random (or gridded) points within the polygon
of interest in the first object (sample.polygon function in package sp).
2. use the overlay function in the sp package to find out which polygons in
object 2 the random points fall into.  You know these overlap. 

If there is a polygon in object 1 that only slightly overlaps a polygon in
object 2, then you are unlikely to detect that using this method, but your
statement about controlling the "Partial" indicates that this may be a good
thing.

Turning this around and generating the points from object 2 and seeing which
polygon in object 1 they are in will tell you if the polygon in object 2 is
completely overlapped by the one in 1.

Hope this helps,

--
Gregory (Greg) L. Snow Ph.D.
Statistical Data Center
Intermountain Healthcare
greg.snow at intermountainmail.org
(801) 408-8111
 
 

> -----Original Message-----
> From: r-sig-geo-bounces at stat.math.ethz.ch
> [mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of Roger Bivand
> Sent: Friday, February 09, 2007 12:56 PM
> To: Andrew Niccolai
> Cc: r-sig-geo at stat.math.ethz.ch
> Subject: Re: [R-sig-Geo] Identifying overlapping polygons
> 
> On Fri, 9 Feb 2007, Andrew Niccolai wrote:
> 
> > Hi.  I am relatively new to Spatial-R.  I have two objects that are 
> > both SpatialPolygonsDataFrame classes.  One is comprised of
> polygons
> > from a section of a segmented image and the other is essentially 
> > circular polygons representing the potential areas that the
> crowns of
> > known tree locations might cover.  I would like to identify every 
> > polygon from the first object (image segmentation polys) that 
> > completely are even partially (hopefully I can control the
> "partial" 
> > threshold) falls within any given polygon from the second object 
> > (crown areas).  In ArcGIS this can be accomplished using
> the Identity
> > application under ArcToolbox.  I was hoping to accomplish
> the same feats in R.  Any help would be greatly appreciated!!
> 
> This is not present yet, but not impossible. If you look in the code 
> of the unionSpatialPolygons() function in the maptools package, you 
> will see that it uses functions in the gpclib package. Using similar 
> ideas to examine either all n by m intersections, or a clever subset 
> by looking at bounding box intersections first, it ought to be 
> feasible. You'll need to be prepared to code it, though.
> 
> Roger
> 
> > 
> > Andrew Niccolai
> > Doctoral Candidate
> > Yale School of Forestry
> > 
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > 
> 
> --
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School 
> of Economics and Business Administration, Helleveien 30, N-5045 
> Bergen, Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



From Roger.Bivand at nhh.no  Sat Feb 10 11:15:58 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 10 Feb 2007 11:15:58 +0100 (CET)
Subject: [R-sig-Geo] Identifying overlapping polygons
In-Reply-To: <002901c74c96$aada5830$0302a8c0@D3K86YB1>
Message-ID: <Pine.LNX.4.44.0702101104150.17504-100000@reclus.nhh.no>

On Fri, 9 Feb 2007, Andrew Niccolai wrote:

> I am still feeling my way around the "protocol" of this list serve, so I do
> not want to clobber the archives with unneccessary communication.  

Andrew,

My feeling is that volume is not unacceptably high, and that with the list
being searchable, for example:

RSiteSearch("query points polygon")

from the R prompt, the usefulness of the list as a record of ideas, hints, 
and answers is substantial. There is also a pretty complete record of 
the last year or so at:

http://gmane.org/info.php?group=gmane.comp.lang.r.geo

> However, I am compelled to say thanks for the quick turn around and the
> extremely helpful suggestions from Greg and Roger.  Thanks and I will
> let you know how it ends up!

Please do so, I'm sure others can benefit from your experience!

Roger

> 
> -----Original Message-----
> From: Greg Snow [mailto:Greg.Snow at intermountainmail.org] 
> Sent: Friday, February 09, 2007 4:27 PM
> To: Roger.Bivand at nhh.no; Andrew Niccolai
> Cc: r-sig-geo at stat.math.ethz.ch
> Subject: RE: [R-sig-Geo] Identifying overlapping polygons
> 
> Andrew,
> 
> Util the functionality is programmed in, here is a quick approximation to
> what you want:
> 
> 1. generate a large number of random (or gridded) points within the polygon
> of interest in the first object (sample.polygon function in package sp).
> 2. use the overlay function in the sp package to find out which polygons in
> object 2 the random points fall into.  You know these overlap. 
> 
> If there is a polygon in object 1 that only slightly overlaps a polygon in
> object 2, then you are unlikely to detect that using this method, but your
> statement about controlling the "Partial" indicates that this may be a good
> thing.
> 
> Turning this around and generating the points from object 2 and seeing which
> polygon in object 1 they are in will tell you if the polygon in object 2 is
> completely overlapped by the one in 1.
> 
> Hope this helps,
> 
> --
> Gregory (Greg) L. Snow Ph.D.
> Statistical Data Center
> Intermountain Healthcare
> greg.snow at intermountainmail.org
> (801) 408-8111
>  
>  
> 
> > -----Original Message-----
> > From: r-sig-geo-bounces at stat.math.ethz.ch
> > [mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of Roger Bivand
> > Sent: Friday, February 09, 2007 12:56 PM
> > To: Andrew Niccolai
> > Cc: r-sig-geo at stat.math.ethz.ch
> > Subject: Re: [R-sig-Geo] Identifying overlapping polygons
> > 
> > On Fri, 9 Feb 2007, Andrew Niccolai wrote:
> > 
> > > Hi.  I am relatively new to Spatial-R.  I have two objects that are 
> > > both SpatialPolygonsDataFrame classes.  One is comprised of
> > polygons
> > > from a section of a segmented image and the other is essentially 
> > > circular polygons representing the potential areas that the
> > crowns of
> > > known tree locations might cover.  I would like to identify every 
> > > polygon from the first object (image segmentation polys) that 
> > > completely are even partially (hopefully I can control the
> > "partial" 
> > > threshold) falls within any given polygon from the second object 
> > > (crown areas).  In ArcGIS this can be accomplished using
> > the Identity
> > > application under ArcToolbox.  I was hoping to accomplish
> > the same feats in R.  Any help would be greatly appreciated!!
> > 
> > This is not present yet, but not impossible. If you look in the code 
> > of the unionSpatialPolygons() function in the maptools package, you 
> > will see that it uses functions in the gpclib package. Using similar 
> > ideas to examine either all n by m intersections, or a clever subset 
> > by looking at bounding box intersections first, it ought to be 
> > feasible. You'll need to be prepared to code it, though.
> > 
> > Roger
> > 
> > > 
> > > Andrew Niccolai
> > > Doctoral Candidate
> > > Yale School of Forestry
> > > 
> > > _______________________________________________
> > > R-sig-Geo mailing list
> > > R-sig-Geo at stat.math.ethz.ch
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > 
> > 
> > --
> > Roger Bivand
> > Economic Geography Section, Department of Economics, Norwegian School 
> > of Economics and Business Administration, Helleveien 30, N-5045 
> > Bergen, Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> > e-mail: Roger.Bivand at nhh.no
> > 
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From perrygeo at gmail.com  Sun Feb 11 22:49:36 2007
From: perrygeo at gmail.com (Matthew Perry)
Date: Sun, 11 Feb 2007 13:49:36 -0800
Subject: [R-sig-Geo] variogram on 3D points with gstat ?
Message-ID: <5383fa5e0702111349r63574dbenfd18407a5df8ec3e@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070211/721c73a5/attachment.pl>

From yong.li at unimelb.edu.au  Sun Feb 11 09:16:21 2007
From: yong.li at unimelb.edu.au (Yong Li)
Date: Sun, 11 Feb 2007 19:16:21 +1100 (EST)
Subject: [R-sig-Geo] huge problem with geoR application
Message-ID: <50816.61.29.147.229.1171181781.squirrel@webmail.unimelb.edu.au>

Dear All,

I have a huge problem with geoR.
When I try to build a grid (1000 x 1000) and use krige to do kriging, I am
told that R can not handle the vector size of 677mb. I have tried to
increase R memory use allocation by -max-mem-size=2500M or
memory.limit(size=2500M). It did not work either.

Can anybody save me at this point?

Cheer

Yong



From adrian at maths.uwa.edu.au  Mon Feb 12 03:06:08 2007
From: adrian at maths.uwa.edu.au (Adrian Baddeley)
Date: Mon, 12 Feb 2007 10:06:08 +0800
Subject: [R-sig-Geo] Identifying overlapping polygons
Message-ID: <17871.52112.129182.650119@maths.uwa.edu.au>


Andrew Niccolai writes:

 >  I would like to identify every polygon from the first object
 >  [...] that completely or even partially [...] 
 >  falls within any given polygon from the second object (crown areas).  

This can be done in the package 'spatstat'.

If your polygons are simply connected (i.e. they do not consist of
multiple pieces and do not have any holes) then use the function
		
		overlap.xypolygon(A, B)

where A and B are two polygons. This function is not documented (sorry
about that). Both A and B should be in the format list(x, y) where x and y
are numeric vectors containing the x and y coordinates of the vertices 
of the polygon, traversed in anti-clockwise order, without repeating the 
first vertex. 

The value returned by overlap.xypolygon is the area of the overlap
(intersection) between the two polygons. 

The area of a polygon is computed by area.xypolygon(A) where A is 
again a simply-connected polygon in the same format as above.

So for example, you could decide that if
		overlap.xypolygon(A, B)/area.xypolygon(B) > 0.9
then you'll declare that B is substantially contained in A.
(Or whatever threshold you choose).

If your polygons are not simply-connected (e.g. they consist of
several pieces) you could use the functions

		overlap.owin(U, V)
		area.owin(U)

where U and V are objects of class "owin" representing spatial 
regions. See help(owin) for details of the format.

Hope that helps
Adrian Baddeley



From fernandomayer at gmail.com  Mon Feb 12 13:49:51 2007
From: fernandomayer at gmail.com (Fernando Mayer)
Date: Mon, 12 Feb 2007 10:49:51 -0200
Subject: [R-sig-Geo] Map2points() substitute for class "map"
Message-ID: <45D0626F.1000805@gmail.com>

Hi,

following Tanimura et al. 2006 (Proportional Symbol Mapping in R) [1], 
I'm trying to implement the ProportionalSymbolMap function for maps of 
class "map" (produced by the maps package), instead of maps of class 
"Map" (imported from a GIS polygon vector file). That function uses 
the Map2points() function to (as far as I could understand) extract 
the points (i.e. map boundaries) from a "Map" object to a n x 2 
matrix, as in

 > verts <- Map2points(map)[order(variable, decreasing = T),]

What I tried to do to substitute this function was

 > verts <- matrix(c(map$x,map$y),ncol=2)[order(variable,
	decreasing = T),]

where map is an object of class "map". But, that doesn't work. As I 
have no experience with shapefiles, I'm restricted to know what 
exactly Map2points() does and if there is some other function that can 
do the same thing for a "map" object.

BTW, if trying to implement this function (ProportionalSymbolMap) for 
a "map" object (instead of a "Map") is not a good idea (because all 
the rest of the function), please let me know. I think (on my limited 
knowledge on this) that with same adjustments it may be possible.

[1] http://www.jstatsoft.org/v15/i05/v15i05.pdf

Thanks for any hint,
-- 
Fernando Mayer
Grupo de Estudos Pesqueiros - GEP
Centro de Ci?ncias Tecnol?gicas, da Terra e do Mar - CTTMar
Universidade do Vale do Itaja? - UNIVALI
Itaja? - SC - Brasil
e-mail: fernandomayer [@] gmail.com



From Roger.Bivand at nhh.no  Mon Feb 12 14:46:37 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 12 Feb 2007 14:46:37 +0100 (CET)
Subject: [R-sig-Geo] Map2points() substitute for class "map"
In-Reply-To: <45D0626F.1000805@gmail.com>
Message-ID: <Pine.LNX.4.44.0702121407070.16082-100000@reclus.nhh.no>

On Mon, 12 Feb 2007, Fernando Mayer wrote:

> Hi,
> 
> following Tanimura et al. 2006 (Proportional Symbol Mapping in R) [1], 
> I'm trying to implement the ProportionalSymbolMap function for maps of 
> class "map" (produced by the maps package), instead of maps of class 
> "Map" (imported from a GIS polygon vector file). That function uses 
> the Map2points() function to (as far as I could understand) extract 
> the points (i.e. map boundaries) from a "Map" object to a n x 2 
> matrix, as in
> 
>  > verts <- Map2points(map)[order(variable, decreasing = T),]
> 
> What I tried to do to substitute this function was
> 
>  > verts <- matrix(c(map$x,map$y),ncol=2)[order(variable,
> 	decreasing = T),]
> 
> where map is an object of class "map". But, that doesn't work. As I 
> have no experience with shapefiles, I'm restricted to know what 
> exactly Map2points() does and if there is some other function that can 
> do the same thing for a "map" object.

Map2points() is a function returning a matrix of coordinates, from a 
point-type Map object, for the centres of the proportional symbols. You 
will not get anywhere using an object of class "map", because it is either 
a collection of polygon boundaries or a collection of lines, and they are 
not associated with any data. If you have "map" polygons, then you need 
some central point to pass to ProportionalSymbolMap(). So you'll need to 
find those points. The SpatialPolygons objects in the sp package define 
centroids by default.

If you comment out the lines:

#  if(missing(map)) stop("map object is missing.")
#  if(!inherits(map, "Map")) stop("Map.obj must be of class Map")
#  if(missing(variable)) stop("variable to be plot is missing")

in ProportionalSymbolMap(), and rename the map argument as verts, you can 
pass the coordinates in:

library(maps)
map <- map("county", "illinois", fill=TRUE, col="transparent", plot=FALSE)
library(maptools)
str(map)
ID <- substring(map$names, 10)
ill <- map2SpatialPolygons(map, ID, proj4string=CRS("+proj=longlat"))
plot(ill, axes=TRUE)
x <- runif(102)
ProportionalSymbolMap_rev(coordinates(ill), x, max.size=0.3)

Note that you have to be careful with polygon IDs, and need to match them 
with the data remembering that the order is very likely to differ.

Would it be sensible to include ProportionalSymbolMap() in maptools? In 
fact, it is the legend that is the tough problem, so in fact using the 
bubble-plot method in sp may be an easier way forward:

SPDF <- SpatialPointsDataFrame(coordinates(ill), data=data.frame(x=x), 
  proj4string=CRS("+proj=longlat"))
bubble(SPDF, "x", axes=TRUE)

There does not seem to be an easy way to plot the polygon borders as a 
background in the bubble method, which uses lattice graphics.

The use of sp class objects tends to make questions like this easier to 
handle.

Roger

> 
> BTW, if trying to implement this function (ProportionalSymbolMap) for 
> a "map" object (instead of a "Map") is not a good idea (because all 
> the rest of the function), please let me know. I think (on my limited 
> knowledge on this) that with same adjustments it may be possible.
> 
> [1] http://www.jstatsoft.org/v15/i05/v15i05.pdf
> 
> Thanks for any hint,
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From e.pebesma at geo.uu.nl  Mon Feb 12 16:13:18 2007
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Mon, 12 Feb 2007 16:13:18 +0100
Subject: [R-sig-Geo] Map2points() substitute for class "map"
In-Reply-To: <Pine.LNX.4.44.0702121407070.16082-100000@reclus.nhh.no>
References: <Pine.LNX.4.44.0702121407070.16082-100000@reclus.nhh.no>
Message-ID: <45D0840E.7090200@geo.uu.nl>

Roger Bivand wrote:
> Would it be sensible to include ProportionalSymbolMap() in maptools? In 
> fact, it is the legend that is the tough problem, so in fact using the 
> bubble-plot method in sp may be an easier way forward:
>
> SPDF <- SpatialPointsDataFrame(coordinates(ill), data=data.frame(x=x), 
>   proj4string=CRS("+proj=longlat"))
> bubble(SPDF, "x", axes=TRUE)
>
> There does not seem to be an easy way to plot the polygon borders as a 
> background in the bubble method, which uses lattice graphics.
>   
Perhaps something along the lines of:

library(maps)
map <- map("county", "illinois", fill=TRUE, col="transparent", plot=FALSE)
library(maptools)
str(map)
ID <- substring(map$names, 10)
ill <- map2SpatialPolygons(map, ID, proj4string=CRS("+proj=longlat"))
plot(ill, axes=TRUE)
x <- runif(102)
SPDF <- SpatialPointsDataFrame(coordinates(ill), data=data.frame(x=x),
  proj4string=CRS("+proj=longlat"))

mypanel = function(x,y, subscripts, sp.layout, ...) {
    sp:::sp.panel.layout(sp.layout, panel.number())
    lattice:::panel.xyplot(x, y, ...)
}

sp.layout = list("sp.polygons", ill)
bubble(SPDF, "x", scales=list(draw=TRUE), panel = mypanel, sp.layout = 
sp.layout)


I agree this is rather ugly with all the ::: ; will see that bubble gets 
a sp.layout argument.
--
Edzer



From Roger.Bivand at nhh.no  Mon Feb 12 16:30:17 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 12 Feb 2007 16:30:17 +0100 (CET)
Subject: [R-sig-Geo] Map2points() substitute for class "map"
In-Reply-To: <45D0840E.7090200@geo.uu.nl>
Message-ID: <Pine.LNX.4.44.0702121628470.16082-100000@reclus.nhh.no>

On Mon, 12 Feb 2007, Edzer J. Pebesma wrote:

> Roger Bivand wrote:
> > Would it be sensible to include ProportionalSymbolMap() in maptools? In 
> > fact, it is the legend that is the tough problem, so in fact using the 
> > bubble-plot method in sp may be an easier way forward:
> >
> > SPDF <- SpatialPointsDataFrame(coordinates(ill), data=data.frame(x=x), 
> >   proj4string=CRS("+proj=longlat"))
> > bubble(SPDF, "x", axes=TRUE)
> >
> > There does not seem to be an easy way to plot the polygon borders as a 
> > background in the bubble method, which uses lattice graphics.
> >   
> Perhaps something along the lines of:
> 
> library(maps)
> map <- map("county", "illinois", fill=TRUE, col="transparent", plot=FALSE)
> library(maptools)
> str(map)
> ID <- substring(map$names, 10)
> ill <- map2SpatialPolygons(map, ID, proj4string=CRS("+proj=longlat"))
> plot(ill, axes=TRUE)
> x <- runif(102)
> SPDF <- SpatialPointsDataFrame(coordinates(ill), data=data.frame(x=x),
>   proj4string=CRS("+proj=longlat"))
> 
> mypanel = function(x,y, subscripts, sp.layout, ...) {
>     sp:::sp.panel.layout(sp.layout, panel.number())
>     lattice:::panel.xyplot(x, y, ...)
> }
> 
> sp.layout = list("sp.polygons", ill)
> bubble(SPDF, "x", scales=list(draw=TRUE), panel = mypanel, sp.layout = 
> sp.layout)
> 
> 
> I agree this is rather ugly with all the ::: ; will see that bubble gets 
> a sp.layout argument.

Very nice, and respecting the polygon bounding box too!

Roger

> --
> Edzer
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From fernandomayer at gmail.com  Mon Feb 12 19:41:14 2007
From: fernandomayer at gmail.com (Fernando Mayer)
Date: Mon, 12 Feb 2007 16:41:14 -0200
Subject: [R-sig-Geo] Map2points() substitute for class "map"
In-Reply-To: <Pine.LNX.4.44.0702121407070.16082-100000@reclus.nhh.no>
References: <Pine.LNX.4.44.0702121407070.16082-100000@reclus.nhh.no>
Message-ID: <45D0B4CA.5070108@gmail.com>

Roger, thanks for your explanations. Thanks also to Edzer Pebesma who 
provided soma additional improvements. However, now I think I have 2 
problems, as follows:

Roger Bivand escreveu:

> If you comment out the lines:
> 
> #  if(missing(map)) stop("map object is missing.")
> #  if(!inherits(map, "Map")) stop("Map.obj must be of class Map")
> #  if(missing(variable)) stop("variable to be plot is missing")
> 
> in ProportionalSymbolMap(), and rename the map argument as verts, you can 
> pass the coordinates in:
> 
> library(maps)
> map <- map("county", "illinois", fill=TRUE, col="transparent", plot=FALSE)
> library(maptools)
> str(map)
> ID <- substring(map$names, 10)
> ill <- map2SpatialPolygons(map, ID, proj4string=CRS("+proj=longlat"))
> plot(ill, axes=TRUE)
> x <- runif(102)
> ProportionalSymbolMap_rev(coordinates(ill), x, max.size=0.3)

# Problem 1

Doing exactly this, I have an error in

 > plot(ill, axes=TRUE)
Error in as.vector(x, "double") : cannot coerce to vector

and I was not able to find out what is going wrong. However if I do

 > map("county", "illinois", fill=TRUE, col="transparent", plot=T)

before all that code code and ignore the error, I can see the map with 
the proportional symbols. So I don't know exactly how long this error 
influence on what was to be the point here. But, I understood 
something new here and know comes the

# Problem 2

As far as I could understand, the polygon IDs are used to identify 
where the symbols are to be plotted (after the processment with 
map2SpatialPolygons()). Maybe it was my mistake haven't said this 
before, but what I'm trying to do is to plot the symbols not in the 
land, but in the ocean. So I think there's no polygon IDs in this case 
isn't?

What I'm trying to do exactly is maps to plot fishery data, with the 
symbols proportional to catch, effort, etc. I was trying something 
like this [1], which is a function using map(), degAxis(), quantile(), 
points(), legend(), etc. However I would like to improve this, mainly 
the legend and the way the symbols are plotted. That's why I was 
trying the ProportionalSymbolMap(). But now, because of the polygon 
IDs I'm not sure anymore how this could be done.

[1] http://img468.imageshack.us/img468/9397/rplot005us9.png

Thanks again for the explanations,
-- 
Fernando Mayer
Grupo de Estudos Pesqueiros - GEP
Centro de Ci?ncias Tecnol?gicas, da Terra e do Mar - CTTMar
Universidade do Vale do Itaja? - UNIVALI
Itaja? - SC - Brasil
e-mail: fernandomayer [@] gmail.com



From Roger.Bivand at nhh.no  Mon Feb 12 21:14:38 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 12 Feb 2007 21:14:38 +0100 (CET)
Subject: [R-sig-Geo] Map2points() substitute for class "map"
In-Reply-To: <45D0B4CA.5070108@gmail.com>
Message-ID: <Pine.LNX.4.44.0702122050490.16082-100000@reclus.nhh.no>

On Mon, 12 Feb 2007, Fernando Mayer wrote:

> Roger, thanks for your explanations. Thanks also to Edzer Pebesma who 
> provided soma additional improvements. However, now I think I have 2 
> problems, as follows:
> 
> Roger Bivand escreveu:
> 
> > If you comment out the lines:
> > 
> > #  if(missing(map)) stop("map object is missing.")
> > #  if(!inherits(map, "Map")) stop("Map.obj must be of class Map")
> > #  if(missing(variable)) stop("variable to be plot is missing")
> > 
> > in ProportionalSymbolMap(), and rename the map argument as verts, you can 
> > pass the coordinates in:
> > 
> > library(maps)
> > map <- map("county", "illinois", fill=TRUE, col="transparent", plot=FALSE)
> > library(maptools)
> > str(map)
> > ID <- substring(map$names, 10)
> > ill <- map2SpatialPolygons(map, ID, proj4string=CRS("+proj=longlat"))
> > plot(ill, axes=TRUE)
> > x <- runif(102)
> > ProportionalSymbolMap_rev(coordinates(ill), x, max.size=0.3)
> 
> # Problem 1
> 
> Doing exactly this, I have an error in
> 
>  > plot(ill, axes=TRUE)
> Error in as.vector(x, "double") : cannot coerce to vector
> 
> and I was not able to find out what is going wrong. However if I do
> 
>  > map("county", "illinois", fill=TRUE, col="transparent", plot=T)
> 
> before all that code code and ignore the error, I can see the map with 
> the proportional symbols. So I don't know exactly how long this error 
> influence on what was to be the point here. But, I understood 
> something new here and know comes the

At a distance it's difficult to say - but from #2 below, it doesn't 
matter, because the map is only a background, it does nothing itself.

> 
> # Problem 2
> 
> As far as I could understand, the polygon IDs are used to identify 
> where the symbols are to be plotted (after the processment with 
> map2SpatialPolygons()). Maybe it was my mistake haven't said this 
> before, but what I'm trying to do is to plot the symbols not in the 
> land, but in the ocean. So I think there's no polygon IDs in this case 
> isn't?

Well, using map() to access boundary data is usually to attach data to the
polygons, but your case is different, you only need a background. My first
idea would be to see whether the PBSmapping package already has what you
need - they are Northern Pacific, but that doesn't have to hurt for your
South Atlantic location. 

I think that I would try to get the coastlines you need from map() or
Rgshhs() in maptools (possibly with a higher resolution GSHHS database),
and convert them to a PBSmapping object. The reason for suggesting
PBSmapping is that the functions provided there are for fisheries
research, and so may be closer to you than more general functions.

library(maptools)
gshhs.c.b <- system.file("share/gshhs_c.b", package="maptools")
SA <- Rgshhs(gshhs.c.b, xlim=c(295,340), ylim=c(-10,-55))$SP
plot(SA, axes=TRUE, col="grey")
SA_PBS <- SpatialPolygons2PolySet(SA)
plotMap(SA_PBS)

I found the map on page 19 of their User Guide quite like what you are 
after, but they choose to colour-fill the quadrats.
 
The same things can be done with generic sp class objects too.

Roger

> 
> What I'm trying to do exactly is maps to plot fishery data, with the 
> symbols proportional to catch, effort, etc. I was trying something 
> like this [1], which is a function using map(), degAxis(), quantile(), 
> points(), legend(), etc. However I would like to improve this, mainly 
> the legend and the way the symbols are plotted. That's why I was 
> trying the ProportionalSymbolMap(). But now, because of the polygon 
> IDs I'm not sure anymore how this could be done.
> 
> [1] http://img468.imageshack.us/img468/9397/rplot005us9.png
> 
> Thanks again for the explanations,
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Roger.Bivand at nhh.no  Mon Feb 12 21:27:23 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 12 Feb 2007 21:27:23 +0100 (CET)
Subject: [R-sig-Geo] Map2points() substitute for class "map"
In-Reply-To: <Pine.LNX.4.44.0702122050490.16082-100000@reclus.nhh.no>
Message-ID: <Pine.LNX.4.44.0702122126460.16082-100000@reclus.nhh.no>

On Mon, 12 Feb 2007, Roger Bivand wrote:

> On Mon, 12 Feb 2007, Fernando Mayer wrote:
> 
> > Roger, thanks for your explanations. Thanks also to Edzer Pebesma who 
> > provided soma additional improvements. However, now I think I have 2 
> > problems, as follows:
> > 
> > Roger Bivand escreveu:
> > 
> > > If you comment out the lines:
> > > 
> > > #  if(missing(map)) stop("map object is missing.")
> > > #  if(!inherits(map, "Map")) stop("Map.obj must be of class Map")
> > > #  if(missing(variable)) stop("variable to be plot is missing")
> > > 
> > > in ProportionalSymbolMap(), and rename the map argument as verts, you can 
> > > pass the coordinates in:
> > > 
> > > library(maps)
> > > map <- map("county", "illinois", fill=TRUE, col="transparent", plot=FALSE)
> > > library(maptools)
> > > str(map)
> > > ID <- substring(map$names, 10)
> > > ill <- map2SpatialPolygons(map, ID, proj4string=CRS("+proj=longlat"))
> > > plot(ill, axes=TRUE)
> > > x <- runif(102)
> > > ProportionalSymbolMap_rev(coordinates(ill), x, max.size=0.3)
> > 
> > # Problem 1
> > 
> > Doing exactly this, I have an error in
> > 
> >  > plot(ill, axes=TRUE)
> > Error in as.vector(x, "double") : cannot coerce to vector
> > 
> > and I was not able to find out what is going wrong. However if I do
> > 
> >  > map("county", "illinois", fill=TRUE, col="transparent", plot=T)
> > 
> > before all that code code and ignore the error, I can see the map with 
> > the proportional symbols. So I don't know exactly how long this error 
> > influence on what was to be the point here. But, I understood 
> > something new here and know comes the
> 
> At a distance it's difficult to say - but from #2 below, it doesn't 
> matter, because the map is only a background, it does nothing itself.
> 
> > 
> > # Problem 2
> > 
> > As far as I could understand, the polygon IDs are used to identify 
> > where the symbols are to be plotted (after the processment with 
> > map2SpatialPolygons()). Maybe it was my mistake haven't said this 
> > before, but what I'm trying to do is to plot the symbols not in the 
> > land, but in the ocean. So I think there's no polygon IDs in this case 
> > isn't?
> 
> Well, using map() to access boundary data is usually to attach data to the
> polygons, but your case is different, you only need a background. My first
> idea would be to see whether the PBSmapping package already has what you
> need - they are Northern Pacific, but that doesn't have to hurt for your
> South Atlantic location. 
> 
> I think that I would try to get the coastlines you need from map() or
> Rgshhs() in maptools (possibly with a higher resolution GSHHS database),
> and convert them to a PBSmapping object. The reason for suggesting
> PBSmapping is that the functions provided there are for fisheries
> research, and so may be closer to you than more general functions.
> 
> library(maptools)
> gshhs.c.b <- system.file("share/gshhs_c.b", package="maptools")
> SA <- Rgshhs(gshhs.c.b, xlim=c(295,340), ylim=c(-10,-55))$SP

Of course:

SA <- Rgshhs(gshhs.c.b, xlim=c(295,340), ylim=c(-55, -10))$SP

Sorry!

> plot(SA, axes=TRUE, col="grey")
> SA_PBS <- SpatialPolygons2PolySet(SA)
> plotMap(SA_PBS)
> 
> I found the map on page 19 of their User Guide quite like what you are 
> after, but they choose to colour-fill the quadrats.
>  
> The same things can be done with generic sp class objects too.
> 
> Roger
> 
> > 
> > What I'm trying to do exactly is maps to plot fishery data, with the 
> > symbols proportional to catch, effort, etc. I was trying something 
> > like this [1], which is a function using map(), degAxis(), quantile(), 
> > points(), legend(), etc. However I would like to improve this, mainly 
> > the legend and the way the symbols are plotted. That's why I was 
> > trying the ProportionalSymbolMap(). But now, because of the polygon 
> > IDs I'm not sure anymore how this could be done.
> > 
> > [1] http://img468.imageshack.us/img468/9397/rplot005us9.png
> > 
> > Thanks again for the explanations,
> > 
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From ivsouza at usp.br  Tue Feb 13 00:30:16 2007
From: ivsouza at usp.br (Igor Viveiros)
Date: Mon, 12 Feb 2007 21:30:16 -0200
Subject: [R-sig-Geo] reading shapefiles in geoR
Message-ID: <1171323016.45d0f8880b801@webmail.usp.br>

Dear all,

I need some help. I have some data from brazilian cities and I want to do a
spacial interpolation for these cities using models implement by geoR.
I have shapefiles for these locations but I can't use then to construct the
polygons for cities borders and for the counties.
Could you help me?

Thanks,
Igor.



From Roger.Bivand at nhh.no  Tue Feb 13 09:03:55 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 13 Feb 2007 09:03:55 +0100 (CET)
Subject: [R-sig-Geo] reading shapefiles in geoR
In-Reply-To: <1171323016.45d0f8880b801@webmail.usp.br>
Message-ID: <Pine.LNX.4.44.0702130844020.16755-100000@reclus.nhh.no>

On Mon, 12 Feb 2007, Igor Viveiros wrote:

> Dear all,
> 
> I need some help. I have some data from brazilian cities and I want to do a
> spacial interpolation for these cities using models implement by geoR.
> I have shapefiles for these locations but I can't use then to construct the
> polygons for cities borders and for the counties.
> Could you help me?

I think that you would like to use the border= argument to mask the 
interpolations. The examples in the package do not include the use of 
SpatialPolygons objects as borders, but this is permitted in the code. 
Using either readShapePoly() in the maptools package or readOGR() in the 
rgdal package, you can get to a SpatialPolygons object from a shapefile:

SPobj <- as(readShapePoly(<myfile>), "SpatialPolygons")

but passing the input SpatialPolygonsDataFrame object should also be OK, 
the attribute data will be ignored. To give more advice, more details of 
what you are trying to do will be needed. Since this code is fairly new, 
documenting your experience will be useful for others - having access to 
example data sets including the point observations (possibly a shapefile), 
the prediction mask polygon(s) as a shapefile, and the prediction grid 
parameters.

Roger

> 
> Thanks,
> Igor.
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From fernandomayer at gmail.com  Tue Feb 13 12:32:49 2007
From: fernandomayer at gmail.com (Fernando Mayer)
Date: Tue, 13 Feb 2007 09:32:49 -0200
Subject: [R-sig-Geo] Map2points() substitute for class "map"
In-Reply-To: <Pine.LNX.4.44.0702122126460.16082-100000@reclus.nhh.no>
References: <Pine.LNX.4.44.0702122126460.16082-100000@reclus.nhh.no>
Message-ID: <45D1A1E1.5090608@gmail.com>

Dear Roger, thank you very much again for your help. I didn't know 
about PBSmapping and the Rgshhs() function. It seems both will be very 
useful to me.

Thanks again,
Fernando Mayer.

Roger Bivand escreveu:
> On Mon, 12 Feb 2007, Roger Bivand wrote:
> 
>> On Mon, 12 Feb 2007, Fernando Mayer wrote:
>>
>>> Roger, thanks for your explanations. Thanks also to Edzer Pebesma who 
>>> provided soma additional improvements. However, now I think I have 2 
>>> problems, as follows:
>>>
>>> Roger Bivand escreveu:
>>>
>>>> If you comment out the lines:
>>>>
>>>> #  if(missing(map)) stop("map object is missing.")
>>>> #  if(!inherits(map, "Map")) stop("Map.obj must be of class Map")
>>>> #  if(missing(variable)) stop("variable to be plot is missing")
>>>>
>>>> in ProportionalSymbolMap(), and rename the map argument as verts, you can 
>>>> pass the coordinates in:
>>>>
>>>> library(maps)
>>>> map <- map("county", "illinois", fill=TRUE, col="transparent", plot=FALSE)
>>>> library(maptools)
>>>> str(map)
>>>> ID <- substring(map$names, 10)
>>>> ill <- map2SpatialPolygons(map, ID, proj4string=CRS("+proj=longlat"))
>>>> plot(ill, axes=TRUE)
>>>> x <- runif(102)
>>>> ProportionalSymbolMap_rev(coordinates(ill), x, max.size=0.3)
>>> # Problem 1
>>>
>>> Doing exactly this, I have an error in
>>>
>>>  > plot(ill, axes=TRUE)
>>> Error in as.vector(x, "double") : cannot coerce to vector
>>>
>>> and I was not able to find out what is going wrong. However if I do
>>>
>>>  > map("county", "illinois", fill=TRUE, col="transparent", plot=T)
>>>
>>> before all that code code and ignore the error, I can see the map with 
>>> the proportional symbols. So I don't know exactly how long this error 
>>> influence on what was to be the point here. But, I understood 
>>> something new here and know comes the
>> At a distance it's difficult to say - but from #2 below, it doesn't 
>> matter, because the map is only a background, it does nothing itself.
>>
>>> # Problem 2
>>>
>>> As far as I could understand, the polygon IDs are used to identify 
>>> where the symbols are to be plotted (after the processment with 
>>> map2SpatialPolygons()). Maybe it was my mistake haven't said this 
>>> before, but what I'm trying to do is to plot the symbols not in the 
>>> land, but in the ocean. So I think there's no polygon IDs in this case 
>>> isn't?
>> Well, using map() to access boundary data is usually to attach data to the
>> polygons, but your case is different, you only need a background. My first
>> idea would be to see whether the PBSmapping package already has what you
>> need - they are Northern Pacific, but that doesn't have to hurt for your
>> South Atlantic location. 
>>
>> I think that I would try to get the coastlines you need from map() or
>> Rgshhs() in maptools (possibly with a higher resolution GSHHS database),
>> and convert them to a PBSmapping object. The reason for suggesting
>> PBSmapping is that the functions provided there are for fisheries
>> research, and so may be closer to you than more general functions.
>>
>> library(maptools)
>> gshhs.c.b <- system.file("share/gshhs_c.b", package="maptools")
>> SA <- Rgshhs(gshhs.c.b, xlim=c(295,340), ylim=c(-10,-55))$SP
> 
> Of course:
> 
> SA <- Rgshhs(gshhs.c.b, xlim=c(295,340), ylim=c(-55, -10))$SP
> 
> Sorry!
> 
>> plot(SA, axes=TRUE, col="grey")
>> SA_PBS <- SpatialPolygons2PolySet(SA)
>> plotMap(SA_PBS)
>>
>> I found the map on page 19 of their User Guide quite like what you are 
>> after, but they choose to colour-fill the quadrats.
>>  
>> The same things can be done with generic sp class objects too.
>>
>> Roger
>>
>>> What I'm trying to do exactly is maps to plot fishery data, with the 
>>> symbols proportional to catch, effort, etc. I was trying something 
>>> like this [1], which is a function using map(), degAxis(), quantile(), 
>>> points(), legend(), etc. However I would like to improve this, mainly 
>>> the legend and the way the symbols are plotted. That's why I was 
>>> trying the ProportionalSymbolMap(). But now, because of the polygon 
>>> IDs I'm not sure anymore how this could be done.
>>>
>>> [1] http://img468.imageshack.us/img468/9397/rplot005us9.png
>>>
>>> Thanks again for the explanations,
>>>
>>
> 

-- 
Fernando Mayer
Grupo de Estudos Pesqueiros - GEP
Centro de Ci?ncias Tecnol?gicas, da Terra e do Mar - CTTMar
Universidade do Vale do Itaja? - UNIVALI
Itaja? - SC - Brasil
e-mail: fernandomayer [@] gmail.com



From mxbasalt at blueridge.net  Wed Feb 14 00:22:59 2007
From: mxbasalt at blueridge.net (Enid Craig)
Date: Tue, 13 Feb 2007 23:22:59 -0000
Subject: [R-sig-Geo] As authoritarian my sanguine
Message-ID: <001801c0709a$c36b2f70$00199dac@06>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070213/a336efcf/attachment.pl>

From Luisr at frs.fo  Wed Feb 14 11:53:04 2007
From: Luisr at frs.fo (Luis Ridao Cruz)
Date: Wed, 14 Feb 2007 10:53:04 +0000
Subject: [R-sig-Geo] Error: package/namespace load failed for 'sp'
Message-ID: <s5d2ea15.084@ffdata.setur.fo>

R-sig-geo help,

I'm having problems (actually a workmate)
to run the sp package.

When I execute library(sp) I get the following error message:

Error in importIntoEnv(impenv, impnames, ns, impvars) : 
        object 'panel.number' is not exported by 'namespace:lattice'
Error: package/namespace load failed for 'sp'

The package has been install from the repositories and manually
from zip files. But no matter the way we do it R fails.
In addtion we insatlle R anew.

As said it's working on my machine  but not on my workmate session.

Thanks in advance

> version
               _                           
platform       i386-pc-mingw32             
arch           i386                        
os             mingw32                     
system         i386, mingw32               
status                                     
major          2                           
minor          4.1                         
year           2006                        
month          12                          
day            18                          
svn rev        40228                       
language       R                           
version.string R version 2.4.1 (2006-12-18)



From Roger.Bivand at nhh.no  Wed Feb 14 13:39:13 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 14 Feb 2007 13:39:13 +0100 (CET)
Subject: [R-sig-Geo] Error: package/namespace load failed for 'sp'
In-Reply-To: <s5d2ea15.084@ffdata.setur.fo>
Message-ID: <Pine.LNX.4.44.0702141330350.7177-100000@reclus.nhh.no>

On Wed, 14 Feb 2007, Luis Ridao Cruz wrote:

> R-sig-geo help,
> 
> I'm having problems (actually a workmate)
> to run the sp package.
> 
> When I execute library(sp) I get the following error message:
> 
> Error in importIntoEnv(impenv, impnames, ns, impvars) : 
>         object 'panel.number' is not exported by 'namespace:lattice'
> Error: package/namespace load failed for 'sp'
> 
> The package has been install from the repositories and manually
> from zip files. But no matter the way we do it R fails.
> In addtion we insatlle R anew.
> 
> As said it's working on my machine  but not on my workmate session.

A full sessionInfo() please, this depends on versions of lattice and 
sp. panel.number is exported by lattice in R >= 2.4, so I think your 
workmate has an earlier version of lattice in the package search path 
despite running a later R. 

> 
> Thanks in advance
> 
> > version
>                _                           
> platform       i386-pc-mingw32             
> arch           i386                        
> os             mingw32                     
> system         i386, mingw32               
> status                                     
> major          2                           
> minor          4.1                         
> year           2006                        
> month          12                          
> day            18                          
> svn rev        40228                       
> language       R                           
> version.string R version 2.4.1 (2006-12-18)
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From hawkekade at dallas.tamu.edu  Wed Feb 14 15:58:50 2007
From: hawkekade at dallas.tamu.edu (Meir Borowski)
Date: Wed, 14 Feb 2007 16:58:50 +0200
Subject: [R-sig-Geo] to orrispowde
Message-ID: <01c75048$a2a5f100$8d10a8c0@workstation>

Hi,

Save over 50% on your medication

http://www.ledrx .com

Remove space in the above link



See you later,  Harry muttered to Ron, and he picked up his bag and
headed for the trapdoor, ignoring Professor Trelawney, who was wearing
an expression of great frustration, as though she had just been denied a



From andrew.niccolai at yale.edu  Wed Feb 14 17:31:49 2007
From: andrew.niccolai at yale.edu (Andrew Niccolai)
Date: Wed, 14 Feb 2007 11:31:49 -0500
Subject: [R-sig-Geo] Subsetting a spatial polygon dataframe with a for loop
In-Reply-To: <Pine.LNX.4.44.0702121407070.16082-100000@reclus.nhh.no>
Message-ID: <200702141633.l1EGVpXn012829@pantheon-po05.its.yale.edu>

Hi.  I had such great success last time, I thought I would ask for more
assistance.  I have an object (cb.poly) of class "SpatialPolygonsDataFrame".
I would like to subset this object using a for loop that essentially loops
through polygon ID from a larger list.  The code looks like this:

class(cb.poly)
sub.cb.poly <- cb.poly[cb.poly$Plg_id == thresh.poly.id[[687]][1,],]
polygons(sub.cb.poly)
dissolveset <- thresh.poly.id[[687]]
ilength <- nrow(dissolveset)
for (i in 2:ilength){
i <- cb.poly[cb.poly$Plg_id == thresh.poly.id[[687]][i,],]
polygons(i)
sub.cb.poly <- c(sub.cb.poly, i)
}
gg <- SpatialPolygons(sub.cb.poly,pO=1:length(sub.cb.poly))

The object thresh.poly.id[[]] is a "list" class object that holds the unique
polygon names that overlapped with my tree crown polygon (thanks Roger and
Greg and others).

The first time I call sub.cb.poly it is a "SpatialPolygonsDataFrame" class.
I then try to convert to a polygon so that after I loop it through my list
of appropriate polygon IDs I can reconvert to a "SpatialPolygonsDataFrame"
class.  I am attempting this because after the for loop, my sub.cb.poly
object is a "list" class.  I could not determine how to join elements from a
loop into a "SpatialPolygonsDataFrame" class, so I thought I might convert
to polygons and then use SpatialPolygons function (see gg object).  

This is not working for me.  

Ultimately, I want to create an object that is a subset of my original
cb.poly object so that I can do a "unionSpatialPolygons" operation to create
a merged or dissolved object. 

Thanks for any assistance. 


Andrew Niccolai
Doctoral Candidate
Yale School of Forestry
203-432-5144



From e.pebesma at geo.uu.nl  Wed Feb 14 17:45:24 2007
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Wed, 14 Feb 2007 17:45:24 +0100
Subject: [R-sig-Geo] Subsetting a spatial polygon dataframe with a for
 loop
In-Reply-To: <200702141633.l1EGVpXn012829@pantheon-po05.its.yale.edu>
References: <200702141633.l1EGVpXn012829@pantheon-po05.its.yale.edu>
Message-ID: <45D33CA4.6030208@geo.uu.nl>

I'm not a 100% sure, but it might be that you are using c(sub.cb.poly, 
i) which creates a list when the arguments are complicated structures. 
You may wish to use rbind on two (or more!) SpatialPolygonsDataFrame 
objects instead. Provided you have the latest sp from CRAN...

Hth,
--
Edzer

Andrew Niccolai wrote:
> Hi.  I had such great success last time, I thought I would ask for more
> assistance.  I have an object (cb.poly) of class "SpatialPolygonsDataFrame".
> I would like to subset this object using a for loop that essentially loops
> through polygon ID from a larger list.  The code looks like this:
>
> class(cb.poly)
> sub.cb.poly <- cb.poly[cb.poly$Plg_id == thresh.poly.id[[687]][1,],]
> polygons(sub.cb.poly)
> dissolveset <- thresh.poly.id[[687]]
> ilength <- nrow(dissolveset)
> for (i in 2:ilength){
> i <- cb.poly[cb.poly$Plg_id == thresh.poly.id[[687]][i,],]
> polygons(i)
> sub.cb.poly <- c(sub.cb.poly, i)
> }
> gg <- SpatialPolygons(sub.cb.poly,pO=1:length(sub.cb.poly))
>
> The object thresh.poly.id[[]] is a "list" class object that holds the unique
> polygon names that overlapped with my tree crown polygon (thanks Roger and
> Greg and others).
>
> The first time I call sub.cb.poly it is a "SpatialPolygonsDataFrame" class.
> I then try to convert to a polygon so that after I loop it through my list
> of appropriate polygon IDs I can reconvert to a "SpatialPolygonsDataFrame"
> class.  I am attempting this because after the for loop, my sub.cb.poly
> object is a "list" class.  I could not determine how to join elements from a
> loop into a "SpatialPolygonsDataFrame" class, so I thought I might convert
> to polygons and then use SpatialPolygons function (see gg object).  
>
> This is not working for me.  
>
> Ultimately, I want to create an object that is a subset of my original
> cb.poly object so that I can do a "unionSpatialPolygons" operation to create
> a merged or dissolved object. 
>
> Thanks for any assistance. 
>
>
> Andrew Niccolai
> Doctoral Candidate
> Yale School of Forestry
> 203-432-5144
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



From ghos0033 at UMN.EDU  Thu Feb 15 18:41:15 2007
From: ghos0033 at UMN.EDU (Debarchana Ghosh)
Date: Thu, 15 Feb 2007 11:41:15 -0600
Subject: [R-sig-Geo] How to find neighbor polygons and analysis of their
	attributes
Message-ID: <d1b8ff630702150941x58bfff08o9835e695a320cffd@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070215/e5d122c9/attachment.pl>

From Roger.Bivand at nhh.no  Thu Feb 15 20:23:20 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 15 Feb 2007 20:23:20 +0100 (CET)
Subject: [R-sig-Geo] How to find neighbor polygons and analysis of their
 attributes
In-Reply-To: <d1b8ff630702150941x58bfff08o9835e695a320cffd@mail.gmail.com>
Message-ID: <Pine.LNX.4.44.0702152005210.8357-100000@reclus.nhh.no>

On Thu, 15 Feb 2007, Debarchana Ghosh wrote:

> Hi All,
> 
> I am trying to select a polygon (parcel), then select all its neighboring
> polygons that share a border with the original polygon so that all the
> neighbor polygons and the original one are selected. Then I want to
> calculate the mean value of one of the attributes from all the selected
> polys and assign that value to a new filed in the original poly. I would
> like to loop this so that it will do it for all the polygons in my layer. I
> have approx 50,000 polygons.

What we don't know is how your 50k polygons are stored, nor which platform 
and version of R you are using.

Assuming current R on a modern OS[1], and reading from a file format read
by OGR, then:

# step 1
library(rgdal)
my_50k_polys <- readOGR(dsn=".", layer="my_layer")
# see ?readOGR for format-dependent variants on dsn= and layer=
# my_50k_polys is an "SpatialPolygonsDataFrame" object

# step 2
library(spdep)
nbs <- poly2nb(as(my_50k_polys, "SpatialPolygons"))
# nbs is an object of class "nb"
# the need to coerce using as() will go away in the next release of spdep;
# this step will take a lunch break but the output object can be saved
# and reused

# step 3
wts <- nb2listw(nbs, style="W")
# wts is an object of class "listw"
# convert neighbours to spatial weights

#step 4
my_50k_polys$W_var <- lag(wts, my_50k_polys$var)
# to assign to the original polygons

You'll need to see whether the neighbour object has no-neighbour polygons, 
which will be reported if you just say:

nbs

at the R prompt (this invokes the print method for this class of object). 
If there are no-neighbour polygons, you can choose to add zero.policy=TRUE 
to steps 3 and 4.

Hope this helps,

Roger

[1] Windows, including XP, allocates memory differently from Unix/Linux or
OSX, so if each of the 50k polygons has thousands of coordinates in its
border, there may be problems with timings and memory allocation, and
these problems will be harder to handle on Windows. If the underlying data
are "odd" in some sense, like having rivers between polygons that should
be made neighbours, more details will be needed (see the snap= argument to
poly2nb()).

> 
> Any help with will be greatly appreciated.
> 
> Thanks,
> Debs.
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Thierry.ONKELINX at inbo.be  Fri Feb 16 11:25:45 2007
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Fri, 16 Feb 2007 11:25:45 +0100
Subject: [R-sig-Geo] R vs GSLIB
Message-ID: <2E9C414912813E4EB981326983E0A10402977798@inboexch.inbo.be>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070216/1b2f33fe/attachment.pl>

From e.pebesma at geo.uu.nl  Fri Feb 16 11:36:26 2007
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Fri, 16 Feb 2007 11:36:26 +0100
Subject: [R-sig-Geo] R vs GSLIB
In-Reply-To: <2E9C414912813E4EB981326983E0A10402977798@inboexch.inbo.be>
References: <2E9C414912813E4EB981326983E0A10402977798@inboexch.inbo.be>
Message-ID: <45D5892A.5040702@geo.uu.nl>

Hi Thierry,

I think spatstat covers point pattern analysis, which is mostly not 
covered by gslib. I have seen either no or small differences between 
gstat and gslib, but never differences that I could not explain. They 
may for instance relate to how you integrate covariances over a block; 
there's many ways you can do this, all approximate. Other issues are 
neighbourhood selections that may be non-unique (e.g. take the nearest 
20 neighbours).

I don't know of anyone who did a systematic comparison; you may want to 
ask on ai-geostats.  I also don't know how to address the gslib 
community, if there is one. Has the open source version ever been 
updated since the printing of the 2nd edition of the book? Who to 
address with bugs or issues?
--
Edzer

ONKELINX, Thierry wrote:
> Dear useRs,
>
>  
>
> Currently I'm taking a course on spatial statistics. We use GSLIB in the
> exercises. Maybe I could convince the professor to let the R aficionados
> do their homework with R. So I was wondering if someone had already
> compared the algorithms used in R packages like spatstat and gstat
> versus the algorithms of GSLIB. If both R and GSLIB use similar
> algorithm and hence yield the same results, then we probably can switch
> to R.
>
>  
>
> Best regards,
>
>  
>
> Thierry
>
>  
>
> ------------------------------------------------------------------------
> ----
>
> ir. Thierry Onkelinx
>
> Instituut voor natuur- en bosonderzoek / Reseach Institute for Nature
> and Forest
>
> Cel biometrie, methodologie en kwaliteitszorg / Section biometrics,
> methodology and quality assurance
>
> Gaverstraat 4
>
> 9500 Geraardsbergen
>
> Belgium
>
> tel. + 32 54/436 185
>
> Thierry.Onkelinx at inbo.be <mailto:Thierry.Onkelinx at inbo.be> 
>
> www.inbo.be <http://www.inbo.be/>  
>
>  
>
> Do not put your faith in what statistics say until you have carefully
> considered what they do not say.  ~William W. Watt
>
> A statistical analysis, properly conducted, is a delicate dissection of
> uncertainties, a surgery of suppositions. ~M.J.Moroney
>
>  
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



From paulojus at c3sl.ufpr.br  Fri Feb 16 13:05:46 2007
From: paulojus at c3sl.ufpr.br (Paulo Justiniano Ribeiro Jr)
Date: Fri, 16 Feb 2007 10:05:46 -0200 (BRST)
Subject: [R-sig-Geo] R vs GSLIB
In-Reply-To: <2E9C414912813E4EB981326983E0A10402977798@inboexch.inbo.be>
References: <2E9C414912813E4EB981326983E0A10402977798@inboexch.inbo.be>
Message-ID: <Pine.LNX.4.58.0702160958430.24151@talisker.c3sl.ufpr.br>

Thierry

Indeed many algorithms between GSLIB and some geostats packages in R (have
a look at the Spatial CRAN task view) are similar, although they can
produce sligtly different results in some cases.
This is specially valid for the "core" goestats algorithms (SK, OK, KTE,
UK)

However, there are algorithms in GSLIB without an analogue within the R
packages, and there are some implementations in R packages without
analogue in GSLIB.

E.g. some examples for the former are given by some variograms estimators,
p-Field, sasim, sisim, gtsim among others.
R is a language and therefore you can aways expand what is available with
some programming.
You can have similar versions in R for those GSLIB specific programs but
may require a bit of programming.



Paulo Justiniano Ribeiro Jr
LEG (Laborat?rio de Estat?stica e Geoinforma??o)
Departamento de Estat?stica
Universidade Federal do Paran?
Caixa Postal 19.081
CEP 81.531-990
Curitiba, PR  -  Brasil
Tel: (+55) 41 3361 3573
Fax: (+55) 41 3361 3141
e-mail: paulojus AT  ufpr  br
http://www.leg.ufpr.br/~paulojus

On Fri, 16 Feb 2007, ONKELINX, Thierry wrote:

> Dear useRs,
>
>
>
> Currently I'm taking a course on spatial statistics. We use GSLIB in the
> exercises. Maybe I could convince the professor to let the R aficionados
> do their homework with R. So I was wondering if someone had already
> compared the algorithms used in R packages like spatstat and gstat
> versus the algorithms of GSLIB. If both R and GSLIB use similar
> algorithm and hence yield the same results, then we probably can switch
> to R.
>
>
>
> Best regards,
>
>
>
> Thierry
>
>
>
> ------------------------------------------------------------------------
> ----
>
> ir. Thierry Onkelinx
>
> Instituut voor natuur- en bosonderzoek / Reseach Institute for Nature
> and Forest
>
> Cel biometrie, methodologie en kwaliteitszorg / Section biometrics,
> methodology and quality assurance
>
> Gaverstraat 4
>
> 9500 Geraardsbergen
>
> Belgium
>
> tel. + 32 54/436 185
>
> Thierry.Onkelinx at inbo.be <mailto:Thierry.Onkelinx at inbo.be>
>
> www.inbo.be <http://www.inbo.be/>
>
>
>
> Do not put your faith in what statistics say until you have carefully
> considered what they do not say.  ~William W. Watt
>
> A statistical analysis, properly conducted, is a delicate dissection of
> uncertainties, a surgery of suppositions. ~M.J.Moroney
>
>
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



From Thomas.Adams at noaa.gov  Fri Feb 16 13:49:58 2007
From: Thomas.Adams at noaa.gov (Thomas Adams)
Date: Fri, 16 Feb 2007 07:49:58 -0500
Subject: [R-sig-Geo] R vs GSLIB
In-Reply-To: <45D5892A.5040702@geo.uu.nl>
References: <2E9C414912813E4EB981326983E0A10402977798@inboexch.inbo.be>
	<45D5892A.5040702@geo.uu.nl>
Message-ID: <45D5A876.2050501@noaa.gov>

Thierry

I have used used both GSTAT and GSLIB a lot and from a usability point 
of view, I much prefer GSTAT because of it's ability to interface with 
with GRASS GIS. This is particularly true of the standalone version of 
GSTAT. I began using GSLIB, and while I continue to make use of it, I 
fing GSTAT fits my needs better.

Another factor is that when ever I have encountered problems, Edzer has 
been very helpful to me ? thank you Edzer!

Regards,
Tom


Edzer J. Pebesma wrote:
> Hi Thierry,
>
> I think spatstat covers point pattern analysis, which is mostly not 
> covered by gslib. I have seen either no or small differences between 
> gstat and gslib, but never differences that I could not explain. They 
> may for instance relate to how you integrate covariances over a block; 
> there's many ways you can do this, all approximate. Other issues are 
> neighbourhood selections that may be non-unique (e.g. take the nearest 
> 20 neighbours).
>
> I don't know of anyone who did a systematic comparison; you may want to 
> ask on ai-geostats.  I also don't know how to address the gslib 
> community, if there is one. Has the open source version ever been 
> updated since the printing of the 2nd edition of the book? Who to 
> address with bugs or issues?
> --
> Edzer
>
> ONKELINX, Thierry wrote:
>   
>> Dear useRs,
>>
>>  
>>
>> Currently I'm taking a course on spatial statistics. We use GSLIB in the
>> exercises. Maybe I could convince the professor to let the R aficionados
>> do their homework with R. So I was wondering if someone had already
>> compared the algorithms used in R packages like spatstat and gstat
>> versus the algorithms of GSLIB. If both R and GSLIB use similar
>> algorithm and hence yield the same results, then we probably can switch
>> to R.
>>
>>  
>>
>> Best regards,
>>
>>  
>>
>> Thierry
>>
>>  
>>
>> ------------------------------------------------------------------------
>> ----
>>
>> ir. Thierry Onkelinx
>>
>> Instituut voor natuur- en bosonderzoek / Reseach Institute for Nature
>> and Forest
>>
>> Cel biometrie, methodologie en kwaliteitszorg / Section biometrics,
>> methodology and quality assurance
>>
>> Gaverstraat 4
>>
>> 9500 Geraardsbergen
>>
>> Belgium
>>
>> tel. + 32 54/436 185
>>
>> Thierry.Onkelinx at inbo.be <mailto:Thierry.Onkelinx at inbo.be> 
>>
>> www.inbo.be <http://www.inbo.be/>  
>>
>>  
>>
>> Do not put your faith in what statistics say until you have carefully
>> considered what they do not say.  ~William W. Watt
>>
>> A statistical analysis, properly conducted, is a delicate dissection of
>> uncertainties, a surgery of suppositions. ~M.J.Moroney
>>
>>  
>>
>>
>> 	[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>     
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   


-- 
Thomas E Adams
National Weather Service
Ohio River Forecast Center
1901 South State Route 134
Wilmington, OH 45177

EMAIL:	thomas.adams at noaa.gov

VOICE:	937-383-0528
FAX:	937-383-0033



From rizem at fas.harvard.edu  Fri Feb 16 22:00:53 2007
From: rizem at fas.harvard.edu (Rima Izem)
Date: Fri, 16 Feb 2007 16:00:53 -0500
Subject: [R-sig-Geo] CAR model in spdep?
Message-ID: <45D61B85.1030206@fas.harvard.edu>

Hello,
I teach a spatial stat course, and I used S+ spatial package for areal 
data analysis in the past. I am switching to R this year and I was 
hoping to use spdep or other R libraries.

The description of spdep in R lists both SAR and CAR as models fitted by 
the library. As far as I could tell, the sarlm sequence (summary.sarlm, 
residuals.sarlm, predict.sarlm..etc) presents  output of a SAR model fit 
and there is nothing for CAR. I could not find a built-in function in R 
for fitting the spatial CAR model in other R libraries either, am I 
missing something?

Thanks in advance,

Rima



From Roger.Bivand at nhh.no  Fri Feb 16 22:21:33 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 16 Feb 2007 22:21:33 +0100 (CET)
Subject: [R-sig-Geo] CAR model in spdep?
In-Reply-To: <45D61B85.1030206@fas.harvard.edu>
Message-ID: <Pine.LNX.4.44.0702162217120.15903-100000@reclus.nhh.no>

On Fri, 16 Feb 2007, Rima Izem wrote:

> Hello,
> I teach a spatial stat course, and I used S+ spatial package for areal 
> data analysis in the past. I am switching to R this year and I was 
> hoping to use spdep or other R libraries.
> 
> The description of spdep in R lists both SAR and CAR as models fitted by 
> the library. As far as I could tell, the sarlm sequence (summary.sarlm, 
> residuals.sarlm, predict.sarlm..etc) presents  output of a SAR model fit 
> and there is nothing for CAR. I could not find a built-in function in R 
> for fitting the spatial CAR model in other R libraries either, am I 
> missing something?

The sarlm are the "spatial econometrics" functions, SAR/CAR including
weights are in the newer spautolm() function, also in spdep. The examples
used there are the ones taken from Waller and Gotway, and get quite close
(weighted CAR is hardest to reproduce). The spdep package is getting 
unwieldy, time for a proper vignette, maybe? Please let me know if you 
have suggestions.

Hope this helps,

Roger

> 
> Thanks in advance,
> 
> Rima
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From debarchana.ghosh at gmail.com  Fri Feb 16 23:58:43 2007
From: debarchana.ghosh at gmail.com (Debarchana Ghosh)
Date: Fri, 16 Feb 2007 16:58:43 -0600
Subject: [R-sig-Geo] How to find neighbor polygons and analysis of their
	attributes
In-Reply-To: <Pine.LNX.4.44.0702152125250.8357-100000@reclus.nhh.no>
References: <d1b8ff630702151203y7b112a41l82c57ef1dedbcfb3@mail.gmail.com>
	<Pine.LNX.4.44.0702152125250.8357-100000@reclus.nhh.no>
Message-ID: <d1b8ff630702161458i1e30c241h44a670a46069224@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070216/4bd7c81d/attachment.pl>

From Roger.Bivand at nhh.no  Sat Feb 17 12:12:53 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 17 Feb 2007 12:12:53 +0100 (CET)
Subject: [R-sig-Geo] How to find neighbor polygons and analysis of their
 attributes
In-Reply-To: <d1b8ff630702161458i1e30c241h44a670a46069224@mail.gmail.com>
Message-ID: <Pine.LNX.4.44.0702171149200.16656-100000@reclus.nhh.no>

On Fri, 16 Feb 2007, Debarchana Ghosh wrote:

> Hi,
> 
> I followed the steps as provided by Roger in the previous emails on a test
> ESRI shapefile with 1300 polygons. Everything went fine and I got the
> intended output. But when I tried to use the same functions on a ESRI
> shapefile with 50,000 polygons It gave the following error.
> 
> > scot<-readOGR("parcels_scot.shp", layer="parcels_scot")
> OGR data source with driver: ESRI Shapefile
> Source: "parcels_scot.shp", layer: "parcels_scot"
> with  49958  rows and  66  columns
> Error in readOGR("parcels_scot.shp", layer = "parcels_scot") :
>         unsupported type
> 
> The parcel_scot.shp has lakes and some other water features in it. If this
> is a problem, do I have to use readShapePoly() in maptools?

No, the underlying code for both of these is the same, shapelib, (but in
maptools has some extra tweaks for non-conforming shapefiles).

You can use getinfo.shape() in maptools to show what shapefile type is
being returned. The ones permitted in readShapePoly() are 1 (POINT), 8
(MULTIPOINT), 11 (POINTZ), 3 (ARC), 13 (ARCZ - 3rd dimension discarded), 5
(POLYGON), and 15 (POLYGONZ - 3rd dimension discarded). The readOGR()  
function using the current OGR shapefile driver appears to handle POLYGON
5, POLYGONM 25, and POLYGONZ 15, ARC 3, ARCM 23, and ARCZ 13, and
MULTIPATCH 31, as well as POINT 1, POINTM 21, POINTZ 11, and MULTIPOINT 8,
MULTIPOINTM 28, and MULTIPOINTZ 18.

The third dimensions are discarded from non-points.

The extra polygons for lakes and water bodies could be the problem, 
because there are no data for them, but it appears that the shape type is 
not among those supported. So the first question is what does 
getinfo.shape() say? Could the file (or a subset with the same problems) 
be made available (say on a website for a short time) for debugging? And 
how was the file created - were there options that could be turned off to 
make it simpler?

Hope this helps,

Roger

> 
> Thanks,
> Debs.
> 
> On 2/15/07, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> >
> > On Thu, 15 Feb 2007, Debarchana Ghosh wrote:
> >
> > > Hi,
> > >
> > > I'm extremely sorry for not giving the entire information about the
> > problem.
> >
> > OK, it makes a difference for some things.
> >
> > > I'm using current R version on Windows on a 2 GB Ram PC. The polygon is
> > in
> > > the ESRI shapefile format. I tried to do this in Arc but of course
> > failed.
> > > So can I do this in R following the steps you've mentioned in your
> > reply?
> >
> > In principle, yes. Reading the shapefile with readOGR() ought to work, and
> > will use less memory than readShapePoly() in maptools. The poly2nb()
> > function will grind on, overnight if need be, but does depend on the
> > numbers of coordinates on polygon boundaries, the more there are, the
> > longer it takes. It uses C functions internally, and was made faster
> > thanks to helpful comments by Hisaji Ono, but is not designed for speed
> > (rather to build an "nb" object once and save, reuse, or export as GAL).
> > Please keep us posted on your progress, there are other tricks that can be
> > tried if you get stuck!
> >
> > writeOGR() should also be able to get the data back out again.
> >
> > <ad>There will be a workshop on using R with spatial data at the
> > Association of American Geographers Conference in San Francisco, Tuesday
> > 17 April</ad>
> >
> > Roger
> >
> >
> > > Will there be any changes?
> > >
> > > Thanks,
> > > Debs.
> > >
> > > On 2/15/07, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> > > >
> > > > On Thu, 15 Feb 2007, Debarchana Ghosh wrote:
> > > >
> > > > > Hi All,
> > > > >
> > > > > I am trying to select a polygon (parcel), then select all its
> > > > neighboring
> > > > > polygons that share a border with the original polygon so that all
> > the
> > > > > neighbor polygons and the original one are selected. Then I want to
> > > > > calculate the mean value of one of the attributes from all the
> > selected
> > > > > polys and assign that value to a new filed in the original poly. I
> > would
> > > > > like to loop this so that it will do it for all the polygons in my
> > > > layer. I
> > > > > have approx 50,000 polygons.
> > > >
> > > > What we don't know is how your 50k polygons are stored, nor which
> > platform
> > > > and version of R you are using.
> > > >
> > > > Assuming current R on a modern OS[1], and reading from a file format
> > read
> > > > by OGR, then:
> > > >
> > > > # step 1
> > > > library(rgdal)
> > > > my_50k_polys <- readOGR(dsn=".", layer="my_layer")
> > > > # see ?readOGR for format-dependent variants on dsn= and layer=
> > > > # my_50k_polys is an "SpatialPolygonsDataFrame" object
> > > >
> > > > # step 2
> > > > library(spdep)
> > > > nbs <- poly2nb(as(my_50k_polys, "SpatialPolygons"))
> > > > # nbs is an object of class "nb"
> > > > # the need to coerce using as() will go away in the next release of
> > spdep;
> > > > # this step will take a lunch break but the output object can be saved
> > > > # and reused
> > > >
> > > > # step 3
> > > > wts <- nb2listw(nbs, style="W")
> > > > # wts is an object of class "listw"
> > > > # convert neighbours to spatial weights
> > > >
> > > > #step 4
> > > > my_50k_polys$W_var <- lag(wts, my_50k_polys$var)
> > > > # to assign to the original polygons
> > > >
> > > > You'll need to see whether the neighbour object has no-neighbour
> > polygons,
> > > > which will be reported if you just say:
> > > >
> > > > nbs
> > > >
> > > > at the R prompt (this invokes the print method for this class of
> > object).
> > > > If there are no-neighbour polygons, you can choose to add
> > zero.policy=TRUE
> > > > to steps 3 and 4.
> > > >
> > > > Hope this helps,
> > > >
> > > > Roger
> > > >
> > > > [1] Windows, including XP, allocates memory differently from
> > Unix/Linux or
> > > > OSX, so if each of the 50k polygons has thousands of coordinates in
> > its
> > > > border, there may be problems with timings and memory allocation, and
> > > > these problems will be harder to handle on Windows. If the underlying
> > data
> > > > are "odd" in some sense, like having rivers between polygons that
> > should
> > > > be made neighbours, more details will be needed (see the snap=
> > argument to
> > > > poly2nb()).
> > > >
> > > > >
> > > > > Any help with will be greatly appreciated.
> > > > >
> > > > > Thanks,
> > > > > Debs.
> > > > >
> > > > >
> > > >
> > > > --
> > > > Roger Bivand
> > > > Economic Geography Section, Department of Economics, Norwegian School
> > of
> > > > Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> > > > Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> > > > e-mail: Roger.Bivand at nhh.no
> > > >
> > > >
> > >
> > >
> > >
> >
> > --
> > Roger Bivand
> > Economic Geography Section, Department of Economics, Norwegian School of
> > Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> > Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> > e-mail: Roger.Bivand at nhh.no
> >
> >
> >
> 
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Roger.Bivand at nhh.no  Sat Feb 17 12:27:15 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 17 Feb 2007 12:27:15 +0100 (CET)
Subject: [R-sig-Geo] How to find neighbor polygons and analysis of their
 attributes
In-Reply-To: <d1b8ff630702161458i1e30c241h44a670a46069224@mail.gmail.com>
Message-ID: <Pine.LNX.4.44.0702171216430.16656-100000@reclus.nhh.no>

Debs:

Please diregard my previous message, the problem is that one of the 
columns in the DBF is of an unsupported type, so not the shapes, the 
problem is the data. readOGR() only supports Real, Integer, and String. 
orgInfo() on the file might help to show what is going on.

readShapePoly() uses read.dbf() from foreign, which is probably more 
robust. See if readShapePoly() works better fot the types of fields you 
have in your dbf file, or try:

library(foreign)
x <- read.dbf("parcels_scot.dbf", as.is = TRUE)

to see if it can read the file. If it can, readShapePoly() will work too. 
Are there for example any Date fields?

Roger


On Fri, 16 Feb 2007, Debarchana Ghosh wrote:

> Hi,
> 
> I followed the steps as provided by Roger in the previous emails on a test
> ESRI shapefile with 1300 polygons. Everything went fine and I got the
> intended output. But when I tried to use the same functions on a ESRI
> shapefile with 50,000 polygons It gave the following error.
> 
> > scot<-readOGR("parcels_scot.shp", layer="parcels_scot")
> OGR data source with driver: ESRI Shapefile
> Source: "parcels_scot.shp", layer: "parcels_scot"
> with  49958  rows and  66  columns
> Error in readOGR("parcels_scot.shp", layer = "parcels_scot") :
>         unsupported type
> 
> The parcel_scot.shp has lakes and some other water features in it. If this
> is a problem, do I have to use readShapePoly() in maptools?
> 
> Thanks,
> Debs.
> 
> On 2/15/07, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> >
> > On Thu, 15 Feb 2007, Debarchana Ghosh wrote:
> >
> > > Hi,
> > >
> > > I'm extremely sorry for not giving the entire information about the
> > problem.
> >
> > OK, it makes a difference for some things.
> >
> > > I'm using current R version on Windows on a 2 GB Ram PC. The polygon is
> > in
> > > the ESRI shapefile format. I tried to do this in Arc but of course
> > failed.
> > > So can I do this in R following the steps you've mentioned in your
> > reply?
> >
> > In principle, yes. Reading the shapefile with readOGR() ought to work, and
> > will use less memory than readShapePoly() in maptools. The poly2nb()
> > function will grind on, overnight if need be, but does depend on the
> > numbers of coordinates on polygon boundaries, the more there are, the
> > longer it takes. It uses C functions internally, and was made faster
> > thanks to helpful comments by Hisaji Ono, but is not designed for speed
> > (rather to build an "nb" object once and save, reuse, or export as GAL).
> > Please keep us posted on your progress, there are other tricks that can be
> > tried if you get stuck!
> >
> > writeOGR() should also be able to get the data back out again.
> >
> > <ad>There will be a workshop on using R with spatial data at the
> > Association of American Geographers Conference in San Francisco, Tuesday
> > 17 April</ad>
> >
> > Roger
> >
> >
> > > Will there be any changes?
> > >
> > > Thanks,
> > > Debs.
> > >
> > > On 2/15/07, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> > > >
> > > > On Thu, 15 Feb 2007, Debarchana Ghosh wrote:
> > > >
> > > > > Hi All,
> > > > >
> > > > > I am trying to select a polygon (parcel), then select all its
> > > > neighboring
> > > > > polygons that share a border with the original polygon so that all
> > the
> > > > > neighbor polygons and the original one are selected. Then I want to
> > > > > calculate the mean value of one of the attributes from all the
> > selected
> > > > > polys and assign that value to a new filed in the original poly. I
> > would
> > > > > like to loop this so that it will do it for all the polygons in my
> > > > layer. I
> > > > > have approx 50,000 polygons.
> > > >
> > > > What we don't know is how your 50k polygons are stored, nor which
> > platform
> > > > and version of R you are using.
> > > >
> > > > Assuming current R on a modern OS[1], and reading from a file format
> > read
> > > > by OGR, then:
> > > >
> > > > # step 1
> > > > library(rgdal)
> > > > my_50k_polys <- readOGR(dsn=".", layer="my_layer")
> > > > # see ?readOGR for format-dependent variants on dsn= and layer=
> > > > # my_50k_polys is an "SpatialPolygonsDataFrame" object
> > > >
> > > > # step 2
> > > > library(spdep)
> > > > nbs <- poly2nb(as(my_50k_polys, "SpatialPolygons"))
> > > > # nbs is an object of class "nb"
> > > > # the need to coerce using as() will go away in the next release of
> > spdep;
> > > > # this step will take a lunch break but the output object can be saved
> > > > # and reused
> > > >
> > > > # step 3
> > > > wts <- nb2listw(nbs, style="W")
> > > > # wts is an object of class "listw"
> > > > # convert neighbours to spatial weights
> > > >
> > > > #step 4
> > > > my_50k_polys$W_var <- lag(wts, my_50k_polys$var)
> > > > # to assign to the original polygons
> > > >
> > > > You'll need to see whether the neighbour object has no-neighbour
> > polygons,
> > > > which will be reported if you just say:
> > > >
> > > > nbs
> > > >
> > > > at the R prompt (this invokes the print method for this class of
> > object).
> > > > If there are no-neighbour polygons, you can choose to add
> > zero.policy=TRUE
> > > > to steps 3 and 4.
> > > >
> > > > Hope this helps,
> > > >
> > > > Roger
> > > >
> > > > [1] Windows, including XP, allocates memory differently from
> > Unix/Linux or
> > > > OSX, so if each of the 50k polygons has thousands of coordinates in
> > its
> > > > border, there may be problems with timings and memory allocation, and
> > > > these problems will be harder to handle on Windows. If the underlying
> > data
> > > > are "odd" in some sense, like having rivers between polygons that
> > should
> > > > be made neighbours, more details will be needed (see the snap=
> > argument to
> > > > poly2nb()).
> > > >
> > > > >
> > > > > Any help with will be greatly appreciated.
> > > > >
> > > > > Thanks,
> > > > > Debs.
> > > > >
> > > > >
> > > >
> > > > --
> > > > Roger Bivand
> > > > Economic Geography Section, Department of Economics, Norwegian School
> > of
> > > > Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> > > > Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> > > > e-mail: Roger.Bivand at nhh.no
> > > >
> > > >
> > >
> > >
> > >
> >
> > --
> > Roger Bivand
> > Economic Geography Section, Department of Economics, Norwegian School of
> > Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> > Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> > e-mail: Roger.Bivand at nhh.no
> >
> >
> >
> 
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From patrick.giraudoux at univ-fcomte.fr  Sun Feb 18 16:52:57 2007
From: patrick.giraudoux at univ-fcomte.fr (Patrick Giraudoux)
Date: Sun, 18 Feb 2007 16:52:57 +0100
Subject: [R-sig-Geo] reading a gps from R
In-Reply-To: <Pine.LNX.4.44.0701142131200.26032-100000@reclus.nhh.no>
References: <Pine.LNX.4.44.0701142131200.26032-100000@reclus.nhh.no>
Message-ID: <45D87659.7080509@univ-fcomte.fr>

On the thread and in case it may help somebody, find below this function 
that can read Garmin Etrex Summit from R (whatever the plateform - 
tested on Windows XP and Ubuntu 6.10 Edgy eft) if gpsbabel is installed.

Packaged in pgirbric at http://perso.orange.fr/giraudoux/SiteGiraudoux.html.

readGPS<-function(type="w",wcom=4){

    if (!(type=="w" | type=="t")) stop("type must be 'w' (waypoints) or 
't' (tracks)")

    if (Sys.info()["sysname"]!="Windows") {# OK sous linux Ubuntu 6.10
        gpsdata<-system(paste("gpsbabel -",type," -i garmin -f 
/dev/ttyUSB0 -o tabsep -F -",sep=""), intern=TRUE)
        if (any(grep("Can't init",gpsdata))) stop("Cannot read GPS: 
check connexion")
        }
    else {# OK sous Windows
        if (any(grep(wcom,0:9))){
            gpsdata <- system(paste("gpsbabel -",type," -i garmin -f 
com",wcom,": -o tabsep -F -",sep=""), intern=TRUE)
            if (any(grep("Can't init",gpsdata))) stop("Cannot read GPS: 
check connexion and com port number 'wcom'")
            }
        else stop("Windows com port number 'wcom' must be one of 0:9")
    }
    gpsdata<-read.table(textConnection(gpsdata), fill=TRUE)
   
   
    if (type=="w"){
        gpsdata<-gpsdata[,c(2,6,7,17)]
        names(gpsdata)<-c("ident","long","lat","altitude")
        
gpsdata$altitude<-as.numeric(substr(as.character(gpsdata$altitude),1,nchar(as.character(gpsdata$altitude))-1))
        attributes(gpsdata)$type<-"Waypoints"
    }
   
    if (type=="t"){
        gpsdata<-gpsdata[,c(3,4,14)]
        names(gpsdata)<-c("long","lat","altitude")
        ident<-1:length(gpsdata[,1])
        gpsdata<-data.frame(ident=ident,gpsdata)
        
gpsdata$altitude<-as.numeric(substr(as.character(gpsdata$altitude),1,nchar(as.character(gpsdata$altitude))-1))
        attributes(gpsdata)$type<-"Track"
    }
   
    attributes(gpsdata)$sysTime<-Sys.time()
    gpsdata
}



From debarchana.ghosh at gmail.com  Mon Feb 19 18:14:55 2007
From: debarchana.ghosh at gmail.com (Debarchana Ghosh)
Date: Mon, 19 Feb 2007 11:14:55 -0600
Subject: [R-sig-Geo] How to find neighbor polygons and analysis of their
	attributes
In-Reply-To: <Pine.LNX.4.44.0702171216430.16656-100000@reclus.nhh.no>
References: <d1b8ff630702161458i1e30c241h44a670a46069224@mail.gmail.com>
	<Pine.LNX.4.44.0702171216430.16656-100000@reclus.nhh.no>
Message-ID: <d1b8ff630702190914p2b2180b2mc525dc29cf12f8af@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070219/0d35befd/attachment.pl>

From rob.robinson at bto.org  Tue Feb 20 13:01:03 2007
From: rob.robinson at bto.org (Rob Robinson)
Date: Tue, 20 Feb 2007 12:01:03 -0000
Subject: [R-sig-Geo] Line colours when plotting SpatialPolygons
Message-ID: <001c01c754e6$cb8b3e20$5285c3c1@btodomain.bto.org>


OK, I give up! I am trying to plot a SpatialPolygonsDataFrame (actually a
part of a world map with simple country outlines). For presentational
reasons I would like these outlines to be something other than black. I can
easily change line width etc, but can't figure out the plot argument to
change the colour. All the documentation I have looked at implies "col="
ought to do it, but this sets the foreground fill colour. What have I
missed?
Many thanks for any pointers
Best wishes
rob


*** Want to know about Britain's birds? Try  www.bto.org/birdfacts ***

Dr Rob Robinson, Senior Population Biologist
British Trust for Ornithology, The Nunnery, Thetford, Norfolk, IP24 2PU
Ph: +44 (0)1842 750050         E: rob.robinson at bto.org
Fx: +44 (0)1842 750030         W: http://www.bto.org
eSafe scanned this email for viruses, vandals and malicious content (!)

==== "How can anyone be enlightened, when truth is so poorly lit" =====



From Roger.Bivand at nhh.no  Tue Feb 20 15:16:46 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 20 Feb 2007 15:16:46 +0100 (CET)
Subject: [R-sig-Geo] Line colours when plotting SpatialPolygons
In-Reply-To: <001c01c754e6$cb8b3e20$5285c3c1@btodomain.bto.org>
Message-ID: <Pine.LNX.4.44.0702201512530.12950-100000@reclus.nhh.no>

On Tue, 20 Feb 2007, Rob Robinson wrote:

> 
> OK, I give up! I am trying to plot a SpatialPolygonsDataFrame (actually a
> part of a world map with simple country outlines). For presentational
> reasons I would like these outlines to be something other than black. I can
> easily change line width etc, but can't figure out the plot argument to
> change the colour. All the documentation I have looked at implies "col="
> ought to do it, but this sets the foreground fill colour. What have I
> missed?


border=

I have to agree that the documentation is not good enough, will be 
improved, thanks.

Roger

> Many thanks for any pointers
> Best wishes
> rob
> 
> 
> *** Want to know about Britain's birds? Try  www.bto.org/birdfacts ***
> 
> Dr Rob Robinson, Senior Population Biologist
> British Trust for Ornithology, The Nunnery, Thetford, Norfolk, IP24 2PU
> Ph: +44 (0)1842 750050         E: rob.robinson at bto.org
> Fx: +44 (0)1842 750030         W: http://www.bto.org
> eSafe scanned this email for viruses, vandals and malicious content (!)
> 
> ==== "How can anyone be enlightened, when truth is so poorly lit" =====
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From debarchana.ghosh at gmail.com  Tue Feb 20 18:05:18 2007
From: debarchana.ghosh at gmail.com (Debarchana Ghosh)
Date: Tue, 20 Feb 2007 11:05:18 -0600
Subject: [R-sig-Geo] How to find neighbor polygons and analysis of their
	attributes
In-Reply-To: <d1b8ff630702190914p2b2180b2mc525dc29cf12f8af@mail.gmail.com>
References: <d1b8ff630702161458i1e30c241h44a670a46069224@mail.gmail.com>
	<Pine.LNX.4.44.0702171216430.16656-100000@reclus.nhh.no>
	<d1b8ff630702190914p2b2180b2mc525dc29cf12f8af@mail.gmail.com>
Message-ID: <d1b8ff630702200905l7bd07622sf2987f4f467b5dd6@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070220/eab4cc05/attachment.pl>

From Roger.Bivand at nhh.no  Tue Feb 20 18:51:51 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 20 Feb 2007 18:51:51 +0100 (CET)
Subject: [R-sig-Geo] How to find neighbor polygons and analysis of their
 attributes
In-Reply-To: <d1b8ff630702200905l7bd07622sf2987f4f467b5dd6@mail.gmail.com>
Message-ID: <Pine.LNX.4.44.0702201840160.12950-100000@reclus.nhh.no>

On Tue, 20 Feb 2007, Debarchana Ghosh wrote:

> Hi,
> 
> The following codes worked except step6. I thought I'll write all the steps
> once agian to remind you of this particular problem.
> 
> # step1
> library(maptools)
> scot<-readShapePoly("parcels_scot.shp")
> 
> # step2
> scotnbs<-poly2nb(as(scot, "SpatialPolygons"))
> #(It kept on grindng overnight, but worked)
> 
> # step 3
> scotnbs
> Neighbour list object:
> Number of regions: 49958
> Number of nonzero links: 186210
> Percentage nonzero weights: 0.007460929
> Average number of links: 3.727331
> 189 regions with no links:
> 
> # step 4
> scotwts<-nb2listw(scotnbs, style="W", zero.policy=TRUE)
> 
> # step 5
> scot$W_EMV_TOTAL<-lag(scotwts, scot$EMV_TOTAL, zero.policy=TRUE)
> 
> # step 6
> writePolyShape(scot, fn="scot.shp")

I don't think we can get to the cause of the warnings by remote debugging. 
Please try writeOGR() in rgdal instead, with the appropriate 
driver="ESRI Shapefile", probably:

writeOGR(scot, dsn=".", layer="scot", driver="ESRI Shapefile")

We may need to convert some data frame columns to other classes, but 
readOGR() is more restrictive than writeOGR().

If you'd like to get to the bottom of the warnings, please do save(scot, 
file="scot.RData", compress=TRUE) and put it on a temporary website. I 
can't see any obvious calls to max() that might not have suitable 
arguments, so it needs running under debug. 

Can readShapePoly() read the output shapefile?

Roger

> There were 21 warnings (use warnings() to see them)
> warnings()
> Warning messages:
> 1: no non-missing arguments to max; returning -Inf
> 2: no non-missing arguments to max; returning -Inf
> 3: no non-missing arguments to max; returning -Inf
> 4: no non-missing arguments to max; returning -Inf
> 5: no non-missing arguments to max; returning -Inf
> 6: no non-missing arguments to max; returning -Inf
> 7: no non-missing arguments to max; returning -Inf
> 8: no non-missing arguments to max; returning -Inf
> 9: no non-missing arguments to max; returning -Inf
> 10: no non-missing arguments to max; returning -Inf
> 11: no non-missing arguments to max; returning -Inf
> 12: no non-missing arguments to max; returning -Inf
> 13: no non-missing arguments to max; returning -Inf
> 14: no non-missing arguments to max; returning -Inf
> 15: no non-missing arguments to max; returning -Inf
> 16: no non-missing arguments to max; returning -Inf
> 17: no non-missing arguments to max; returning -Inf
> 18: no non-missing arguments to max; returning -Inf
> 19: no non-missing arguments to max; returning -Inf
> 20: no non-missing arguments to max; returning -Inf
> 21: no non-missing arguments to max; returning -Inf
> 
> I can't understand what these warnings mean. writePolyShape() writes 3
> files, "scot.shp", "scot.shp.dbf", "scot.shx". I can view the dbf file but
> not the shapefile in ESRI arccatalog.
> 
> Thanks,
> Debs.
> 
> On 2/19/07, Debarchana Ghosh <debarchana.ghosh at gmail.com> wrote:
> >
> >
> >
> > library(foreign)
> > > x <- read.dbf("parcels_scot.dbf", as.is = TRUE)
> >
> >
> > This  worked with no problem. I also did
> > summary(x) to see whether it was able to read in all the attributes. All
> > the attributes are there.
> >
> > to see if it can read the file. If it can, readShapePoly() will work too.
> > > Are there for example any Date fields?
> >
> >
> > Yes there is one Date field.  But  I'm  trying  to see  whether
> > readShapePoly() will  work  as well.
> >
> > Thanks for all the codes.
> > Debs.
> >
> > Roger
> > >
> > >
> > > On Fri, 16 Feb 2007, Debarchana Ghosh wrote:
> > >
> > > > Hi,
> > > >
> > > > I followed the steps as provided by Roger in the previous emails on a
> > > test
> > > > ESRI shapefile with 1300 polygons. Everything went fine and I got the
> > > > intended output. But when I tried to use the same functions on a ESRI
> > > > shapefile with 50,000 polygons It gave the following error.
> > > >
> > > > > scot<-readOGR("parcels_scot.shp", layer="parcels_scot")
> > > > OGR data source with driver: ESRI Shapefile
> > > > Source: "parcels_scot.shp", layer: "parcels_scot"
> > > > with  49958  rows and  66  columns
> > > > Error in readOGR("parcels_scot.shp", layer = "parcels_scot") :
> > > >         unsupported type
> > > >
> > > > The parcel_scot.shp has lakes and some other water features in it. If
> > > this
> > > > is a problem, do I have to use readShapePoly() in maptools?
> > > >
> > > > Thanks,
> > > > Debs.
> > > >
> > > > On 2/15/07, Roger Bivand < Roger.Bivand at nhh.no> wrote:
> > > > >
> > > > > On Thu, 15 Feb 2007, Debarchana Ghosh wrote:
> > > > >
> > > > > > Hi,
> > > > > >
> > > > > > I'm extremely sorry for not giving the entire information about
> > > the
> > > > > problem.
> > > > >
> > > > > OK, it makes a difference for some things.
> > > > >
> > > > > > I'm using current R version on Windows on a 2 GB Ram PC. The
> > > polygon is
> > > > > in
> > > > > > the ESRI shapefile format. I tried to do this in Arc but of course
> > >
> > > > > failed.
> > > > > > So can I do this in R following the steps you've mentioned in your
> > > > > reply?
> > > > >
> > > > > In principle, yes. Reading the shapefile with readOGR() ought to
> > > work, and
> > > > > will use less memory than readShapePoly() in maptools. The poly2nb()
> > > > > function will grind on, overnight if need be, but does depend on the
> > > > > numbers of coordinates on polygon boundaries, the more there are,
> > > the
> > > > > longer it takes. It uses C functions internally, and was made faster
> > > > > thanks to helpful comments by Hisaji Ono, but is not designed for
> > > speed
> > > > > (rather to build an "nb" object once and save, reuse, or export as
> > > GAL).
> > > > > Please keep us posted on your progress, there are other tricks that
> > > can be
> > > > > tried if you get stuck!
> > > > >
> > > > > writeOGR() should also be able to get the data back out again.
> > > > >
> > > > > <ad>There will be a workshop on using R with spatial data at the
> > > > > Association of American Geographers Conference in San Francisco,
> > > Tuesday
> > > > > 17 April</ad>
> > > > >
> > > > > Roger
> > > > >
> > > > >
> > > > > > Will there be any changes?
> > > > > >
> > > > > > Thanks,
> > > > > > Debs.
> > > > > >
> > > > > > On 2/15/07, Roger Bivand < Roger.Bivand at nhh.no> wrote:
> > > > > > >
> > > > > > > On Thu, 15 Feb 2007, Debarchana Ghosh wrote:
> > > > > > >
> > > > > > > > Hi All,
> > > > > > > >
> > > > > > > > I am trying to select a polygon (parcel), then select all its
> > > > > > > neighboring
> > > > > > > > polygons that share a border with the original polygon so that
> > > all
> > > > > the
> > > > > > > > neighbor polygons and the original one are selected. Then I
> > > want to
> > > > > > > > calculate the mean value of one of the attributes from all the
> > > > > selected
> > > > > > > > polys and assign that value to a new filed in the original
> > > poly. I
> > > > > would
> > > > > > > > like to loop this so that it will do it for all the polygons
> > > in my
> > > > > > > layer. I
> > > > > > > > have approx 50,000 polygons.
> > > > > > >
> > > > > > > What we don't know is how your 50k polygons are stored, nor
> > > which
> > > > > platform
> > > > > > > and version of R you are using.
> > > > > > >
> > > > > > > Assuming current R on a modern OS[1], and reading from a file
> > > format
> > > > > read
> > > > > > > by OGR, then:
> > > > > > >
> > > > > > > # step 1
> > > > > > > library(rgdal)
> > > > > > > my_50k_polys <- readOGR(dsn=".", layer="my_layer")
> > > > > > > # see ?readOGR for format-dependent variants on dsn= and layer=
> > > > > > > # my_50k_polys is an "SpatialPolygonsDataFrame" object
> > > > > > >
> > > > > > > # step 2
> > > > > > > library(spdep)
> > > > > > > nbs <- poly2nb(as(my_50k_polys, "SpatialPolygons"))
> > > > > > > # nbs is an object of class "nb"
> > > > > > > # the need to coerce using as() will go away in the next release
> > > of
> > > > > spdep;
> > > > > > > # this step will take a lunch break but the output object can be
> > > saved
> > > > > > > # and reused
> > > > > > >
> > > > > > > # step 3
> > > > > > > wts <- nb2listw(nbs, style="W")
> > > > > > > # wts is an object of class "listw"
> > > > > > > # convert neighbours to spatial weights
> > > > > > >
> > > > > > > #step 4
> > > > > > > my_50k_polys$W_var <- lag(wts, my_50k_polys$var)
> > > > > > > # to assign to the original polygons
> > > > > > >
> > > > > > > You'll need to see whether the neighbour object has no-neighbour
> > > > > polygons,
> > > > > > > which will be reported if you just say:
> > > > > > >
> > > > > > > nbs
> > > > > > >
> > > > > > > at the R prompt (this invokes the print method for this class of
> > > > > object).
> > > > > > > If there are no-neighbour polygons, you can choose to add
> > > > > zero.policy=TRUE
> > > > > > > to steps 3 and 4.
> > > > > > >
> > > > > > > Hope this helps,
> > > > > > >
> > > > > > > Roger
> > > > > > >
> > > > > > > [1] Windows, including XP, allocates memory differently from
> > > > > Unix/Linux or
> > > > > > > OSX, so if each of the 50k polygons has thousands of coordinates
> > > in
> > > > > its
> > > > > > > border, there may be problems with timings and memory
> > > allocation, and
> > > > > > > these problems will be harder to handle on Windows. If the
> > > underlying
> > > > > data
> > > > > > > are "odd" in some sense, like having rivers between polygons
> > > that
> > > > > should
> > > > > > > be made neighbours, more details will be needed (see the snap=
> > > > > argument to
> > > > > > > poly2nb()).
> > > > > > >
> > > > > > > >
> > > > > > > > Any help with will be greatly appreciated.
> > > > > > > >
> > > > > > > > Thanks,
> > > > > > > > Debs.
> > > > > > > >
> > > > > > > >
> > > > > > >
> > > > > > > --
> > > > > > > Roger Bivand
> > > > > > > Economic Geography Section, Department of Economics, Norwegian
> > > School
> > > > > of
> > > > > > > Economics and Business Administration, Helleveien 30, N-5045
> > > Bergen,
> > > > > > > Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> > > > > > > e-mail: Roger.Bivand at nhh.no
> > > > > > >
> > > > > > >
> > > > > >
> > > > > >
> > > > > >
> > > > >
> > > > > --
> > > > > Roger Bivand
> > > > > Economic Geography Section, Department of Economics, Norwegian
> > > School of
> > > > > Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> > > > > Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> > > > > e-mail: Roger.Bivand at nhh.no
> > > > >
> > > > >
> > > > >
> > > >
> > > >
> > > >
> > >
> > > --
> > > Roger Bivand
> > > Economic Geography Section, Department of Economics, Norwegian School of
> > >
> > > Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> > > Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> > > e-mail: Roger.Bivand at nhh.no
> > >
> > >
> >
> >
> > --
> > Debarchana Ghosh
> > Research Assistant,
> > Department of Geography
> > University of Minnesota.
> > PH: 8143607580
> > www.tc.umn.edu/~ghos0033/ <http://www.tc.umn.edu/%7Eghos0033/>
> >
> 
> 
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From debarchana.ghosh at gmail.com  Tue Feb 20 23:27:28 2007
From: debarchana.ghosh at gmail.com (Debarchana Ghosh)
Date: Tue, 20 Feb 2007 16:27:28 -0600
Subject: [R-sig-Geo] How to find neighbor polygons and analysis of their
	attributes
In-Reply-To: <Pine.LNX.4.44.0702201840160.12950-100000@reclus.nhh.no>
References: <d1b8ff630702200905l7bd07622sf2987f4f467b5dd6@mail.gmail.com>
	<Pine.LNX.4.44.0702201840160.12950-100000@reclus.nhh.no>
Message-ID: <d1b8ff630702201427h5e852b1agbd89b5862cf772c8@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070220/a1f1c951/attachment.pl>

From Roger.Bivand at nhh.no  Wed Feb 21 12:38:02 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 21 Feb 2007 12:38:02 +0100 (CET)
Subject: [R-sig-Geo] How to find neighbor polygons and analysis of their
 attributes
In-Reply-To: <d1b8ff630702201427h5e852b1agbd89b5862cf772c8@mail.gmail.com>
Message-ID: <Pine.LNX.4.44.0702211155060.13703-100000@reclus.nhh.no>

On Tue, 20 Feb 2007, Debarchana Ghosh wrote:

> >
> > Please try writeOGR() in rgdal instead, with the appropriate
> > driver="ESRI Shapefile", probably:
> >
> > writeOGR(scot, dsn=".", layer="scot", driver="ESRI Shapefile")
> 
> 
> 
> I tried this but were giving errors.
> > writeOGR(scot, dsn=".", layer="scot", driver="ESRI Shapefile")
> Error in writeOGR(scot, dsn = ".", layer = "scot", driver = "ESRI
> Shapefile") :
>         unknown data type
> 
> ## the scot file has a date field.
> 
> If you'd like to get to the bottom of the warnings, please do save(scot,
> > file="scot.RData", compress=TRUE) and put it on a temporary website. I
> > can't see any obvious calls to max() that might not have suitable
> > arguments, so it needs running under debug.
> 
> 
> I've put the file in this website
> http://rguha.ath.cx/~debarchana/

OK, thanks. The 21 warnings come from the fact that 21 of the DBF columns 
are just missing values (or are read by R as missing values). This is:

    max(nchar(x[!is.na(x)]))

in write.dbf(), in trying to work out the field width.

These include two of the three dates, only SALE_DATE has values, but they
likely ought to be checked, the highest value is long in the future. Many
of the others also have many missing values, but I suppose they are as
they should be.

> scot$SALE_DATE <- as.character(scot$SALE_DATE)
> scot$AGPRE_ENRD <- as.character(scot$AGPRE_ENRD)
> scot$AGPRE_EXPD <- as.character(scot$AGPRE_EXPD)
> table(sapply(as(scot, "data.frame"), class))

character    factor   numeric 
        3        50        14 
> table(sapply(as(scot, "data.frame"), typeof))

character    double   integer 
        3        14        50 
> writeOGR(scot, dsn=".", layer="scot", driver="ESRI Shapefile")

now runs for me. So does:

> writePolyShape(scot, "scot_1")
There were 21 warnings (use warnings() to see them)

The writePolyShape() DBF was much smaller than the writeOGR() one, because 
writePolyShape uses write.dbf() to try to guess the width of fields, while 
writeOGR() - at the moment - just uses defaults. I read scot_1.shp into 
ArcMAP 9.1 successfully, I didn't try scot.shp because of the very large 
DBF - my Arc is on a laptop with 256M RAM. Your lagged values were 
present.

I hope you said save(scotnbs, "scotnbs.RData", compress=TRUE), to save 
repeating the generation of the neighbour lists. I feel that some of the 
lists will be rather strange, because I think your plots are separated by 
roads, etc., which will mean that many miss almost-contiguous neighbours 
across a road. However, that is how the data are.

Best wishes,

Roger

> 
> Thanks for the help.
> Debs.
> 
> 
> Can readShapePoly() read the output shapefile?
> >
> > Roger
> >
> > > There were 21 warnings (use warnings() to see them)
> > > warnings()
> > > Warning messages:
> > > 1: no non-missing arguments to max; returning -Inf
> > > 2: no non-missing arguments to max; returning -Inf
> > > 3: no non-missing arguments to max; returning -Inf
> > > 4: no non-missing arguments to max; returning -Inf
> > > 5: no non-missing arguments to max; returning -Inf
> > > 6: no non-missing arguments to max; returning -Inf
> > > 7: no non-missing arguments to max; returning -Inf
> > > 8: no non-missing arguments to max; returning -Inf
> > > 9: no non-missing arguments to max; returning -Inf
> > > 10: no non-missing arguments to max; returning -Inf
> > > 11: no non-missing arguments to max; returning -Inf
> > > 12: no non-missing arguments to max; returning -Inf
> > > 13: no non-missing arguments to max; returning -Inf
> > > 14: no non-missing arguments to max; returning -Inf
> > > 15: no non-missing arguments to max; returning -Inf
> > > 16: no non-missing arguments to max; returning -Inf
> > > 17: no non-missing arguments to max; returning -Inf
> > > 18: no non-missing arguments to max; returning -Inf
> > > 19: no non-missing arguments to max; returning -Inf
> > > 20: no non-missing arguments to max; returning -Inf
> > > 21: no non-missing arguments to max; returning -Inf
> > >
> > > I can't understand what these warnings mean. writePolyShape() writes 3
> > > files, "scot.shp", "scot.shp.dbf", "scot.shx". I can view the dbf file
> > but
> > > not the shapefile in ESRI arccatalog.
> > >
> > > Thanks,
> > > Debs.
> > >
> > > On 2/19/07, Debarchana Ghosh <debarchana.ghosh at gmail.com> wrote:
> > > >
> > > >
> > > >
> > > > library(foreign)
> > > > > x <- read.dbf("parcels_scot.dbf", as.is = TRUE)
> > > >
> > > >
> > > > This  worked with no problem. I also did
> > > > summary(x) to see whether it was able to read in all the attributes.
> > All
> > > > the attributes are there.
> > > >
> > > > to see if it can read the file. If it can, readShapePoly() will work
> > too.
> > > > > Are there for example any Date fields?
> > > >
> > > >
> > > > Yes there is one Date field.  But  I'm  trying  to see  whether
> > > > readShapePoly() will  work  as well.
> > > >
> > > > Thanks for all the codes.
> > > > Debs.
> > > >
> > > > Roger
> > > > >
> > > > >
> > > > > On Fri, 16 Feb 2007, Debarchana Ghosh wrote:
> > > > >
> > > > > > Hi,
> > > > > >
> > > > > > I followed the steps as provided by Roger in the previous emails
> > on a
> > > > > test
> > > > > > ESRI shapefile with 1300 polygons. Everything went fine and I got
> > the
> > > > > > intended output. But when I tried to use the same functions on a
> > ESRI
> > > > > > shapefile with 50,000 polygons It gave the following error.
> > > > > >
> > > > > > > scot<-readOGR("parcels_scot.shp", layer="parcels_scot")
> > > > > > OGR data source with driver: ESRI Shapefile
> > > > > > Source: "parcels_scot.shp", layer: "parcels_scot"
> > > > > > with  49958  rows and  66  columns
> > > > > > Error in readOGR("parcels_scot.shp", layer = "parcels_scot") :
> > > > > >         unsupported type
> > > > > >
> > > > > > The parcel_scot.shp has lakes and some other water features in it.
> > If
> > > > > this
> > > > > > is a problem, do I have to use readShapePoly() in maptools?
> > > > > >
> > > > > > Thanks,
> > > > > > Debs.
> > > > > >
> > > > > > On 2/15/07, Roger Bivand < Roger.Bivand at nhh.no> wrote:
> > > > > > >
> > > > > > > On Thu, 15 Feb 2007, Debarchana Ghosh wrote:
> > > > > > >
> > > > > > > > Hi,
> > > > > > > >
> > > > > > > > I'm extremely sorry for not giving the entire information
> > about
> > > > > the
> > > > > > > problem.
> > > > > > >
> > > > > > > OK, it makes a difference for some things.
> > > > > > >
> > > > > > > > I'm using current R version on Windows on a 2 GB Ram PC. The
> > > > > polygon is
> > > > > > > in
> > > > > > > > the ESRI shapefile format. I tried to do this in Arc but of
> > course
> > > > >
> > > > > > > failed.
> > > > > > > > So can I do this in R following the steps you've mentioned in
> > your
> > > > > > > reply?
> > > > > > >
> > > > > > > In principle, yes. Reading the shapefile with readOGR() ought to
> > > > > work, and
> > > > > > > will use less memory than readShapePoly() in maptools. The
> > poly2nb()
> > > > > > > function will grind on, overnight if need be, but does depend on
> > the
> > > > > > > numbers of coordinates on polygon boundaries, the more there
> > are,
> > > > > the
> > > > > > > longer it takes. It uses C functions internally, and was made
> > faster
> > > > > > > thanks to helpful comments by Hisaji Ono, but is not designed
> > for
> > > > > speed
> > > > > > > (rather to build an "nb" object once and save, reuse, or export
> > as
> > > > > GAL).
> > > > > > > Please keep us posted on your progress, there are other tricks
> > that
> > > > > can be
> > > > > > > tried if you get stuck!
> > > > > > >
> > > > > > > writeOGR() should also be able to get the data back out again.
> > > > > > >
> > > > > > > <ad>There will be a workshop on using R with spatial data at the
> > > > > > > Association of American Geographers Conference in San Francisco,
> > > > > Tuesday
> > > > > > > 17 April</ad>
> > > > > > >
> > > > > > > Roger
> > > > > > >
> > > > > > >
> > > > > > > > Will there be any changes?
> > > > > > > >
> > > > > > > > Thanks,
> > > > > > > > Debs.
> > > > > > > >
> > > > > > > > On 2/15/07, Roger Bivand < Roger.Bivand at nhh.no> wrote:
> > > > > > > > >
> > > > > > > > > On Thu, 15 Feb 2007, Debarchana Ghosh wrote:
> > > > > > > > >
> > > > > > > > > > Hi All,
> > > > > > > > > >
> > > > > > > > > > I am trying to select a polygon (parcel), then select all
> > its
> > > > > > > > > neighboring
> > > > > > > > > > polygons that share a border with the original polygon so
> > that
> > > > > all
> > > > > > > the
> > > > > > > > > > neighbor polygons and the original one are selected. Then
> > I
> > > > > want to
> > > > > > > > > > calculate the mean value of one of the attributes from all
> > the
> > > > > > > selected
> > > > > > > > > > polys and assign that value to a new filed in the original
> > > > > poly. I
> > > > > > > would
> > > > > > > > > > like to loop this so that it will do it for all the
> > polygons
> > > > > in my
> > > > > > > > > layer. I
> > > > > > > > > > have approx 50,000 polygons.
> > > > > > > > >
> > > > > > > > > What we don't know is how your 50k polygons are stored, nor
> > > > > which
> > > > > > > platform
> > > > > > > > > and version of R you are using.
> > > > > > > > >
> > > > > > > > > Assuming current R on a modern OS[1], and reading from a
> > file
> > > > > format
> > > > > > > read
> > > > > > > > > by OGR, then:
> > > > > > > > >
> > > > > > > > > # step 1
> > > > > > > > > library(rgdal)
> > > > > > > > > my_50k_polys <- readOGR(dsn=".", layer="my_layer")
> > > > > > > > > # see ?readOGR for format-dependent variants on dsn= and
> > layer=
> > > > > > > > > # my_50k_polys is an "SpatialPolygonsDataFrame" object
> > > > > > > > >
> > > > > > > > > # step 2
> > > > > > > > > library(spdep)
> > > > > > > > > nbs <- poly2nb(as(my_50k_polys, "SpatialPolygons"))
> > > > > > > > > # nbs is an object of class "nb"
> > > > > > > > > # the need to coerce using as() will go away in the next
> > release
> > > > > of
> > > > > > > spdep;
> > > > > > > > > # this step will take a lunch break but the output object
> > can be
> > > > > saved
> > > > > > > > > # and reused
> > > > > > > > >
> > > > > > > > > # step 3
> > > > > > > > > wts <- nb2listw(nbs, style="W")
> > > > > > > > > # wts is an object of class "listw"
> > > > > > > > > # convert neighbours to spatial weights
> > > > > > > > >
> > > > > > > > > #step 4
> > > > > > > > > my_50k_polys$W_var <- lag(wts, my_50k_polys$var)
> > > > > > > > > # to assign to the original polygons
> > > > > > > > >
> > > > > > > > > You'll need to see whether the neighbour object has
> > no-neighbour
> > > > > > > polygons,
> > > > > > > > > which will be reported if you just say:
> > > > > > > > >
> > > > > > > > > nbs
> > > > > > > > >
> > > > > > > > > at the R prompt (this invokes the print method for this
> > class of
> > > > > > > object).
> > > > > > > > > If there are no-neighbour polygons, you can choose to add
> > > > > > > zero.policy=TRUE
> > > > > > > > > to steps 3 and 4.
> > > > > > > > >
> > > > > > > > > Hope this helps,
> > > > > > > > >
> > > > > > > > > Roger
> > > > > > > > >
> > > > > > > > > [1] Windows, including XP, allocates memory differently from
> > > > > > > Unix/Linux or
> > > > > > > > > OSX, so if each of the 50k polygons has thousands of
> > coordinates
> > > > > in
> > > > > > > its
> > > > > > > > > border, there may be problems with timings and memory
> > > > > allocation, and
> > > > > > > > > these problems will be harder to handle on Windows. If the
> > > > > underlying
> > > > > > > data
> > > > > > > > > are "odd" in some sense, like having rivers between polygons
> > > > > that
> > > > > > > should
> > > > > > > > > be made neighbours, more details will be needed (see the
> > snap=
> > > > > > > argument to
> > > > > > > > > poly2nb()).
> > > > > > > > >
> > > > > > > > > >
> > > > > > > > > > Any help with will be greatly appreciated.
> > > > > > > > > >
> > > > > > > > > > Thanks,
> > > > > > > > > > Debs.
> > > > > > > > > >
> > > > > > > > > >
> > > > > > > > >
> > > > > > > > > --
> > > > > > > > > Roger Bivand
> > > > > > > > > Economic Geography Section, Department of Economics,
> > Norwegian
> > > > > School
> > > > > > > of
> > > > > > > > > Economics and Business Administration, Helleveien 30, N-5045
> > > > > Bergen,
> > > > > > > > > Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> > > > > > > > > e-mail: Roger.Bivand at nhh.no
> > > > > > > > >
> > > > > > > > >
> > > > > > > >
> > > > > > > >
> > > > > > > >
> > > > > > >
> > > > > > > --
> > > > > > > Roger Bivand
> > > > > > > Economic Geography Section, Department of Economics, Norwegian
> > > > > School of
> > > > > > > Economics and Business Administration, Helleveien 30, N-5045
> > Bergen,
> > > > > > > Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> > > > > > > e-mail: Roger.Bivand at nhh.no
> > > > > > >
> > > > > > >
> > > > > > >
> > > > > >
> > > > > >
> > > > > >
> > > > >
> > > > > --
> > > > > Roger Bivand
> > > > > Economic Geography Section, Department of Economics, Norwegian
> > School of
> > > > >
> > > > > Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> > > > > Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> > > > > e-mail: Roger.Bivand at nhh.no
> > > > >
> > > > >
> > > >
> > > >
> > > > --
> > > > Debarchana Ghosh
> > > > Research Assistant,
> > > > Department of Geography
> > > > University of Minnesota.
> > > > PH: 8143607580
> > > > www.tc.umn.edu/~ghos0033/ <http://www.tc.umn.edu/%7Eghos0033/>
> > > >
> > >
> > >
> > >
> > >
> >
> > --
> > Roger Bivand
> > Economic Geography Section, Department of Economics, Norwegian School of
> > Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> > Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> > e-mail: Roger.Bivand at nhh.no
> >
> >
> 
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From perrygeo at gmail.com  Wed Feb 21 21:21:56 2007
From: perrygeo at gmail.com (Matthew Perry)
Date: Wed, 21 Feb 2007 12:21:56 -0800
Subject: [R-sig-Geo] variogram on 3D points with gstat ?
In-Reply-To: <5383fa5e0702111349r63574dbenfd18407a5df8ec3e@mail.gmail.com>
References: <5383fa5e0702111349r63574dbenfd18407a5df8ec3e@mail.gmail.com>
Message-ID: <5383fa5e0702211221ra91053fl2aef0e787f625864@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20070221/df4c760c/attachment.pl>

From carmubelgin at naf-inc.com  Thu Feb 22 17:03:33 2007
From: carmubelgin at naf-inc.com (Abilene Farner)
Date: Thu, 22 Feb 2007 17:03:33 +0100
Subject: [R-sig-Geo] at barfl
Message-ID: <01c7569b$00ec3c30$0301a8c0@ordinateur>

Hi,

Via_aagra $3. 35
Va_aalium $1. 25
Cia_aalis $3. 75
Xan_nnax
Som_mma

http://www. kedrx .com

Remove spaces in the above link


and Crouch was shunted sideways into the Department of International
Magical Cooperation. 
There was a long silence. Harry was thinking of the way Crouchs eyes



From e.pebesma at geo.uu.nl  Fri Feb 23 14:29:46 2007
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Fri, 23 Feb 2007 14:29:46 +0100
Subject: [R-sig-Geo] variogram on 3D points with gstat ?
In-Reply-To: <5383fa5e0702211221ra91053fl2aef0e787f625864@mail.gmail.com>
References: <5383fa5e0702111349r63574dbenfd18407a5df8ec3e@mail.gmail.com>
	<5383fa5e0702211221ra91053fl2aef0e787f625864@mail.gmail.com>
Message-ID: <45DEEC4A.5090108@geo.uu.nl>

Matthew, try

library(gstat)
demo(gstat3D)

It doesn't use the sp classes, and in the next version it will be like this:

# $Id: gstat3D.R,v 1.4 2006-02-10 19:05:02 edzer Exp $
# simple demo of 3D interpolation of 50 points with random normal values,
# randomly located in the unit cube
n <- 50

data3D <- data.frame(x = runif(n), y = runif(n), z = runif(n), v = rnorm(n))
coordinates(data3D) = ~x+y+z

range1D <- seq(from = 0, to = 1, length = 20)
grid3D <- expand.grid(x = range1D, y = range1D, z = range1D)
gridded(grid3D) = ~x+y+z

res3D <- krige(formula = v ~ 1, data3D, grid3D, model = vgm(1, "Exp", .2))

library(lattice)

levelplot(var1.pred ~ x + y | z, as.data.frame(res3D))

--
Edzer

Matthew Perry wrote:
> Any one know if kriging data in 3 dimensions is possible with R/gstat? Any
> examples?
>
> Thanks,
> Matt
>
>
> On 2/11/07, Matthew Perry <perrygeo at gmail.com> wrote:
>   
>> Hey folks,
>>
>>  I'm trying to use R/gstat to krige data in 3 dimensions. Is this
>> possible? I haven't had much luck...
>>
>>     
>>> library(gstat)
>>>       
>> Loading required package: sp
>>     
>>> d <- read.table("C:\\Workspace\\temp\\points.txt",sep="\t",header=TRUE)
>>> coordinates(d) = ~x+y+z
>>> summary(d)
>>>       
>> Object of class SpatialPointsDataFrame
>> Coordinates:
>>   min max
>> x   1   3
>> y   1   3
>> z   1   3
>> Is projected: NA
>> proj4string : [NA]
>> Number of points: 27
>> Data attributes:
>>       conc
>>  Min.   :   2.0
>>  1st Qu.:   5.0
>>  Median :  20.0
>>  Mean   : 653.2
>>  3rd Qu.:1000.0
>>  Max.   :2000.0
>>     
>>> d
>>>       
>>    coordinates conc
>> 1    (1, 1, 1)  500
>> 2    (1, 1, 2) 1000
>> 3    (1, 1, 3) 2000
>> 4    (2, 1, 1)  500
>> 5    (2, 1, 2) 1000
>> 6    (2, 1, 3) 2000
>> 7    (3, 1, 1)  500
>> 8    (3, 1, 2) 1000
>> 9    (3, 1, 3) 2000
>> 10   (1, 2, 1)    5
>> 11   (1, 2, 2) 1000
>> 12   (1, 2, 3) 2000
>> 13   (2, 2, 1)    5
>> 14   (2, 2, 2)   20
>> 15   (2, 2, 3) 2000
>> 16   (3, 2, 1)    5
>> 17   (3, 2, 2)   20
>> 18   (3, 2, 3) 2000
>> 19   (1, 3, 1)    2
>> 20   (1, 3, 2)    5
>> 21   (1, 3, 3)   20
>> 22   (2, 3, 1)    2
>> 23   (2, 3, 2)    5
>> 24   (2, 3, 3)   20
>> 25   (3, 3, 1)    2
>> 26   (3, 3, 2)    5
>> 27   (3, 3, 3)   20
>>     
>>> cvgm <- variogram(log(conc)~1,data=d)
>>>       
>> Error in as.vector(x, mode) : invalid argument 'mode'
>>
>>
>> When I set "coordinates(d) = ~x+y", the variogram works fine. Does the R
>> interface to gstat allow for 3D data?
>>
>> --
>> Matthew T. Perry
>> http://www.perrygeo.net
>>     
>
>
>
>
>



From tkobayas at indiana.edu  Fri Feb 23 21:09:58 2007
From: tkobayas at indiana.edu (Takatsugu Kobayashi)
Date: Fri, 23 Feb 2007 15:09:58 -0500
Subject: [R-sig-Geo] How to list neighbors IDs and corresponding
	frequencies
Message-ID: <45DF4A16.3040709@indiana.edu>

Rusers:

I am trying to compute a Moran's I coefficient for census tracts for 
Indianapolis in R. I have a shapefile for Indianapolis and uploaded it 
into R. I understand how to compute a Moran's I coefficient using knn2nb 
command. How can I compute a Moran's I based on a edge/border contiguity 
matrix?

Also, in Matlab, using the find command, I can find the IDs for 
observations that satisfy some conditions like

a=randn(10,1) % create a row vector that contains 10 random normal numbers
INDEX=find(a>0) % INDEX is a row vector that contains IDs of 
observations whose values are greater than 0
a(INDEX) % Returns frequencies attached to the IDs of observations whose 
values are greater than 0

This way, I can identify nearest neighbors of a point within n miles.

Thank you very much

Takatsugu
Indiana Univ.



From Roger.Bivand at nhh.no  Fri Feb 23 22:38:11 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 23 Feb 2007 22:38:11 +0100 (CET)
Subject: [R-sig-Geo] How to list neighbors IDs and corresponding
	frequencies
In-Reply-To: <45DF4A16.3040709@indiana.edu>
Message-ID: <Pine.LNX.4.44.0702232224030.15179-100000@reclus.nhh.no>

On Fri, 23 Feb 2007, Takatsugu Kobayashi wrote:

> Rusers:
> 
> I am trying to compute a Moran's I coefficient for census tracts for 
> Indianapolis in R. I have a shapefile for Indianapolis and uploaded it 
> into R. I understand how to compute a Moran's I coefficient using knn2nb 
> command. How can I compute a Moran's I based on a edge/border contiguity 
> matrix?

These are functions in the spdep package, yes?

For boundary contiguity based in a shapefile of tract boundaries, see 
poly2nb(), like knn2nb(knearneigh()) for k-nearest neighbours, and 
dnearneigh() for distance-based neighbours.

> 
> Also, in Matlab, using the find command, I can find the IDs for 
> observations that satisfy some conditions like
> 
> a=randn(10,1) % create a row vector that contains 10 random normal numbers
> INDEX=find(a>0) % INDEX is a row vector that contains IDs of 
> observations whose values are greater than 0
> a(INDEX) % Returns frequencies attached to the IDs of observations whose 
> values are greater than 0
> 

a <- rnorm(10)
INDEX <- which(a > 0)
a[INDEX]

I'm not bilingual, but it looks like which(); please use dnearneigh() to
generate objects of class "nb".

It is usually helpful to illustrate your question using an example from 
the help pages - in your case:

example(moran.test)

and

example(poly2nb)

would give you some ideas that should help (the example() function runs 
the example for the named function on packaged data). Trying to work out 
what to do on the packaged data is easier than on your own data, and it is 
easier for people on the list to help if they can see both the code and 
the data (so packaged data avoids the need to post your own until needed, 
if the specific data are the problem).

Hope this helps,

Roger

> This way, I can identify nearest neighbors of a point within n miles.
> 
> Thank you very much
> 
> Takatsugu
> Indiana Univ.
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From trevor.doerksen at gmail.com  Tue Feb 27 18:07:46 2007
From: trevor.doerksen at gmail.com (Trevor Doerksen)
Date: Tue, 27 Feb 2007 13:07:46 -0400
Subject: [R-sig-Geo] search,grids,SA significance test
Message-ID: <45E46562.802@gmail.com>

Hi,

I'm new to the mailing list and I see there is a large repository of 
info in the archives. Is there any way to search it, to find answers to 
my potentially redundant questions?

I have some training in IDRISI's GIS and have used R for just over a 
year. I've started using the gstat package in R and worked through some 
of the excellent examples in 1) Pebesma and Bivand. 2005. S classes and 
methods for spatial data: the sp package.  2) Pebesma. 2006. The meuse 
data set: a tutorial for gstat R package. 3) Pebesma. 2004. 
Multivariable geostatistics in S: the gstat package. Computers & 
Geosciences. 30:683-691.

I have two specific questions:
1) I'm having trouble creating a grid of regularly spaced points that 
gstat will accept for use with the krige function. Also, I don't know 
how to mask a specific area (like the nice grid in the meuse data set) 
of interest within that grid. Does anyone have examples/references not 
listed above? Below is one attempt at some code which didn't work. NOTE: 
My samples are irregularly spaced and I don't need predictions over the 
entire rectangular grid.

#FIRST attempt
x=seq(246000,606000,1000)
length(x)    #361
y=seq(4851000,5084000,1000)
length(y)    #234
pts.4.grd=expand.grid(x,y)    # resolution = 1km^2; size = 361*234 = 84474
names(pts.4.grd)=c('x','y')
str(pts.4.grd)    # dataframe
grd.pts = SpatialPixels(SpatialPoints(pts.4.grd))
str(grd.pts)    #SpatialPixels
grd = as(grd.pts, "SpatialGrid")
str(grd)    #X=Var1, Y=Var2

# variogram fit not shown. Trying 'universal kriging', with a N-S trend 
removed.
kr1.f2.v2=krige(bv~UTMN83+UTMN83*UTMN83,locations=~UTME83+UTMN83,data=all,grd,model=fit2.v2)
#doesn't work with the following error. Grid and sample data not same size?
#Error in gstat.formula.predict(d$formula, newdata, na.action = 
na.action) :
#        NROW(locs) != NROW(X): this should not occur
#In addition: Warning messages:
#1: 'newdata' had 84474 rows but variable(s) found have 440 rows
#2: 'newdata' had 84474 rows but variable(s) found have 440 rows

2) Is there a test to compute the significance of spatial 
autocorrelation in a variogram? The biological signal I'm modelling in 
my variograms is very weak, with a huge nugget. How large can the nugget 
be before it negates the spatially specific weights for kriging, thus 
rendering the prediction close to an inverse distance weighting scheme?

Thanks,

Trevor.



From Roger.Bivand at nhh.no  Tue Feb 27 20:22:43 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 27 Feb 2007 20:22:43 +0100 (CET)
Subject: [R-sig-Geo] search,grids,SA significance test
In-Reply-To: <45E46562.802@gmail.com>
Message-ID: <Pine.LNX.4.44.0702271851500.15125-100000@reclus.nhh.no>

On Tue, 27 Feb 2007, Trevor Doerksen wrote:

> Hi,
> 
> I'm new to the mailing list and I see there is a large repository of 
> info in the archives. Is there any way to search it, to find answers to 
> my potentially redundant questions?

If going back 18 months is OK, try:

http://news.gmane.org/gmane.comp.lang.r.geo

Alternatively, the RSiteSearch() function inside R takes a search string, 
and searches R documentation including this mailing list, so that:

RSiteSearch("gstat krige")

hits this list a good deal.
> 
> I have some training in IDRISI's GIS and have used R for just over a 
> year. I've started using the gstat package in R and worked through some 
> of the excellent examples in 1) Pebesma and Bivand. 2005. S classes and 
> methods for spatial data: the sp package.  2) Pebesma. 2006. The meuse 
> data set: a tutorial for gstat R package. 3) Pebesma. 2004. 
> Multivariable geostatistics in S: the gstat package. Computers & 
> Geosciences. 30:683-691.
> 
> I have two specific questions:
> 1) I'm having trouble creating a grid of regularly spaced points that 
> gstat will accept for use with the krige function. Also, I don't know 
> how to mask a specific area (like the nice grid in the meuse data set) 
> of interest within that grid. Does anyone have examples/references not 
> listed above? Below is one attempt at some code which didn't work. NOTE: 
> My samples are irregularly spaced and I don't need predictions over the 
> entire rectangular grid.
> 
> #FIRST attempt
> x=seq(246000,606000,1000)
> length(x)    #361
> y=seq(4851000,5084000,1000)
> length(y)    #234
> pts.4.grd=expand.grid(x,y)    # resolution = 1km^2; size = 361*234 = 84474
> names(pts.4.grd)=c('x','y')
> str(pts.4.grd)    # dataframe
> grd.pts = SpatialPixels(SpatialPoints(pts.4.grd))
> str(grd.pts)    #SpatialPixels
> grd = as(grd.pts, "SpatialGrid")
> str(grd)    #X=Var1, Y=Var2
> 
> # variogram fit not shown. Trying 'universal kriging', with a N-S trend 
> removed.
> kr1.f2.v2=krige(bv~UTMN83+UTMN83*UTMN83, 
>     locations=~UTME83+UTMN83, data=all, grd, model=fit2.v2)

You could get to grd quicker by saying:

grdT <- GridTopology(cellcentre.offset=c(246000, 4851000), 
  cellsize=c(1000, 1000), cells.dim=c(361, 234))
grd <- SpatialGrid(grdT) # possibly setting proj4string

I would advise setting up a gstat object first, then predicting from it, 
to keep the steps apart for ease of debugging:

kr1.f2.v2_input <- gstat(bv ~ UTMN83 + I(UTMN83*UTMN83), data=all, 
  model=fit2.v2)

assuming that bv and UTMN83 are columns of the all object, and that the 
all object is a SpatialPointsDataFrame. Please do note that 
I(UTMN83*UTMN83) is of the order of 2.35322e+13, and that this may render 
the UK part of your model unworkable numerically. 

kr1.f2.v2 <- predict(kr1.f2.v2_input, newdata=grd)

will now probably fail because grd does not have a column called UTMN83.

So I suggest you first try setting the variogram model on a gstat object 
including a numerically secure quadratic trend (both directions) - see the 
degree= argument to gstat() - 

quad_obj <- gstat(bv ~ 1, data=all, degree=2)

then get the variogram for quad_obj, fit the variogram, make a new gstat 
object, then predict. When that works, make it more complicated by taking 
out the UTMN83 coordinates as a separate local variable (scaled in the 
same way in all and grd), and it should just work. The source of problems 
here is trying to do too many things in a single step.

> #doesn't work with the following error. Grid and sample data not same size?
> #Error in gstat.formula.predict(d$formula, newdata, na.action = 
> na.action) :
> #        NROW(locs) != NROW(X): this should not occur
> #In addition: Warning messages:
> #1: 'newdata' had 84474 rows but variable(s) found have 440 rows
> #2: 'newdata' had 84474 rows but variable(s) found have 440 rows
> 
> 2) Is there a test to compute the significance of spatial 
> autocorrelation in a variogram? The biological signal I'm modelling in 
> my variograms is very weak, with a huge nugget. How large can the nugget 
> be before it negates the spatially specific weights for kriging, thus 
> rendering the prediction close to an inverse distance weighting scheme?
> 

This is a different question, but the predictions would only be like a 
regional disc if the maximum number of neighbours or the maximum distance 
was set.

Roger

> Thanks,
> 
> Trevor.
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From e.pebesma at geo.uu.nl  Tue Feb 27 20:47:36 2007
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Tue, 27 Feb 2007 20:47:36 +0100
Subject: [R-sig-Geo] search,grids,SA significance test
In-Reply-To: <45E46562.802@gmail.com>
References: <45E46562.802@gmail.com>
Message-ID: <45E48AD8.10900@geo.uu.nl>

Trevor, a few notes in addition to Roger's answer:

Trevor Doerksen wrote:
> I have two specific questions:
> 1) ...
>  Also, I don't know 
> how to mask a specific area (like the nice grid in the meuse data set) 
> of interest within that grid. 
Depends on where you start. Suppose you have a SpatialPolygons or 
SpatialPolygonsDataFrame object, you can generate a regular grid using 
spsample, or start with makegrid, convert to SpatialPixels, and then use 
overlay the result to obtain NA indices for grid points outside any 
polygon. If you don't have a polygon, you may select grid points within 
a certain distance to nearest observations by interpolating them with a 
search radius; again the NA pattern will reveal grid points too far away.
> 2) Is there a test to compute the significance of spatial 
> autocorrelation in a variogram? The biological signal I'm modelling in 
> my variograms is very weak, with a huge nugget. How large can the nugget 
> be before it negates the spatially specific weights for kriging, thus 
> rendering the prediction close to an inverse distance weighting scheme?
>   
IMHO, insignificant spatial correlation in spatial data will usually 
indicate a too small sample. A large relative nugget may indicate that 
statistics under the independence assumption are reasonable, 
insignificant correlation still does not imply zero correlation.

Large nugget effects lead to predictions equal to the grand (or local) 
mean or trend estimate, not the inverse distance weighted interpolated 
value.
--
Edzer



From Roger.Bivand at nhh.no  Wed Feb 28 12:02:06 2007
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 28 Feb 2007 12:02:06 +0100 (CET)
Subject: [R-sig-Geo] R Spatial workshops, San Francisco and Bergen
Message-ID: <Pine.LNX.4.44.0702281142280.15830-100000@reclus.nhh.no>

There will be a workshop on: "Analyzing Spatial Data with R" at the 2007 
meeting of the AAG (Association of American Geographers), April 17, 
1300-1600, San Francisco, CA (USA). Details are to be found on the meeting 
website:

http://www.aag.org/annualmeetings/SF2007/workshops.cfm

I will be at the AAG meeting for the whole period, and would welcome the 
opportunity to meet users of R for spatial data, and participants in this 
community. Meeting users directly has often been of great help in getting 
fresh ideas and useful experiences. 

The AAG workshop will be repeated at the Nordic Geographers Meeting in 
Bergen, 15-17 June, workshop date not yet fixed.

http://www.uib.no/ngm/

The NGM workshop page has a deadline that is not relevant, please just get 
in touch if the workshop in Bergen is of interest.

Best wishes,

Roger

(PS. The workshops will follow the format of last year's workshops in 
Vienna at useR06, in Tokyo at ISM, and at Lausanne at FOSS4G, as well as 
Edzer Pebesma's eSeminar in December).

(PPS. Although both workshops presuppose meeting registration, I trust 
that security will be absent - although as participants at Vienna will 
recall, a fire-extinguisher used to keep the door open to let some air 
in, did cause some friction with an official!). 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From qne at techtop.co.zw  Wed Feb 28 17:22:25 2007
From: qne at techtop.co.zw (self-seeking)
Date: Wed, 28 Feb 2007 17:22:25 +0100
Subject: [R-sig-Geo] Mon 5th  March     12.
Message-ID: <001c01c75b55$9bf60d50$2f7ae331@lsmrl>


There will also be an opportunity for us to emphasise the very strong case we have for fairer funding.
Modern colorful icons.
Choral repertoire will include new works commissioned by the festival from composers Goff Richards and Russell Pascoe.
The awards scheme hopes to overcome this barrier to IT training through supporting informal training projects that introduce ICT to disadvantaged young people and adults in the most appropriate way. His 'Mass' was hit but his 'Super' crashed.
The film is going to be released on Shivarathri, 23rd of February .
MK is also claiming that there is much disinformation being spread around.
Nine of the properties will be for rent and the other ten will be available on a shared ownership basis. Rosemary Aitken is Cornish born and bred and a widely published author of English teaching texts and Cornish historical sagas.
He has shown through his intelligence and campaigning zeal that he could achieve a tremendous amount for his constituents and Cornwall and succeed on the national stage of politics. We have received two stalling letters, but we will continue to press until all the information is released. Three successes out of five is a pretty healthy trend for Tollywood. Bring your own digital or other cameras to work with him on site. Added possibility to change file associations. Although the normal frequency of bowel movements can vary from once or more a day to three times a week, you are likely constipated if you pass a hard, dry stool less than three times a week. i did not receive a reply to my last mail 

