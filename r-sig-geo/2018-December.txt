From c@willme@ @ending from uni-koeln@de  Tue Dec  4 16:42:33 2018
From: c@willme@ @ending from uni-koeln@de (Christian Willmes)
Date: Tue, 4 Dec 2018 16:42:33 +0100
Subject: [R-sig-Geo] How to test for a layer in GRASS GIS mapset using
 rgrass7
Message-ID: <80913593-5451-109d-4549-b11ea4e1cd52@uni-koeln.de>

Hello,

I am not sure if this is the correct list to ask this specific question 
about executing GRASS GIS from R Scripts.

My problem is how to determine if a layer exists in the current GRASS 
GIS mapset or not.

During my script I use r.mapcalc from GRASS GIS to do some expensive 
computation. So I want to store and reuse the resulting layer, wich is 
produced according to a variable value, in case I need this layer for 
the specific variable value again.

If I just omit the overwrite tag it does not work, becasue GRASS GIS 
stops the execution on this event.

Error in execGRASS("r.mapcalc", expression = expr) : The command:
r.mapcalc expression="rsl40 = GEBCO_2014_2D_4326 >= -40"
produced an error (1) during execution:
FEHLER: output map <rsl40> exists. To overwrite, use the --overwrite flag
Error in execGRASS("r.mapcalc", expression = expr) : The command:
r.mapcalc expression="land_NA_1_rsl40? =? if( rsl40 , 1 ,null())"
produced an error (1) during execution:
FEHLER: output map <land_NA_1_rsl40> exists. To overwrite, use the
 ??????? --overwrite flag

So, I tryed to check if a certain layer already exists in the mapset to 
test if the computation needs/can be executed or not.

Using the following:

if(execGRASS("g.findfile", element="cell", file=lyrname, mapset='"."')){
 ??? return(FALSE)
 ? }else{
 ??? return(TRUE)
 ? }

Here it stops, if the layer does not exist:

Fehler in execGRASS("g.findfile", element = "cell", file = lyrname, 
mapset = "\".\"") :
 ? The command:
g.findfile element=cell file=rsl40 mapset="."
produced an error (1) during execution:


Does anyone know a solution to this?

Thank you very much!

Best,
Christian


-- 
Dr. Christian Willmes	
AG GIS & Fernerkundung      | GIS & RS Group
Geographisches Institut     | Institute of Geography
Universit?t zu K?ln         | University of Cologne
Tel.: +49 (0)221 470 6234
http://www.geographie.uni-koeln.de/14126.html
http://www.sfb806.de
http://crc806db.uni-koeln.de
http://publons.com/a/1316706/
http://orcid.org/0000-0002-5566-6542


From bf@levli@t @ending from gm@il@com  Tue Dec  4 16:50:29 2018
From: bf@levli@t @ending from gm@il@com (=?UTF-8?Q?Bede-Fazekas_=c3=81kos?=)
Date: Tue, 4 Dec 2018 16:50:29 +0100
Subject: [R-sig-Geo] [R-sig-eco] raster::predict example doesn't work?
In-Reply-To: <b0da65baed4a49eba15be8ad15b8a53d@hi.no>
References: <b0da65baed4a49eba15be8ad15b8a53d@hi.no>
Message-ID: <9b100def-346a-0562-d67c-ae70e99ba151@gmail.com>

Dear Genoveva,

All the examples in the help file of package 'party' 
(https://cran.r-project.org/web/packages/party/party.pdf) use the 
function predict() from package 'stats' instead of package 'raster'.
But converting the RasterStack to data.frame, changing the column 'red' 
from numeric to factor, using stats::predict(..., newdata), and create a 
new layer of the RasterStack can solve the problem.
logo_df <- as.data.frame(logo)
logo_df$red <- factor(logo_df$red, levels = levels(v$red))
pc <- stats::predict(m, OOB = TRUE, newdata = logo_df)
logo$pc <- pc

HTH,
?kos Bede-Fazekas
Hungarian Academy of Sciences


2018.12.04. 15:52 keltez?ssel, Gonzalez-Mirelis, Genoveva ?rta:
> Dear list,
>
> I posted this question recently on another list so I apologize for any cross-posting. Still no solution.
>
>
> I would like to use the 'predict' function in the 'raster' package in an implementation of species distribution modelling with a couple of factor variables. Furthermore, I would like to set this up exactly as the cforest example listed in the help file. Unfortunately, I cannot get the example to work!
>
>
>
> # create a RasterStack or RasterBrick with with a set of predictor layers
>
>
>
> logo <- brick(system.file("external/rlogo.grd", package="raster"))
>
> names(logo)
>
>
>
> # known presence and absence points
>
> p <- matrix(c(48, 48, 48, 53, 50, 46, 54, 70, 84, 85, 74, 84, 95, 85,
>
>                66, 42, 26, 4, 19, 17, 7, 14, 26, 29, 39, 45, 51, 56, 46, 38, 31,
>
>                22, 34, 60, 70, 73, 63, 46, 43, 28), ncol=2)
>
>
>
> a <- matrix(c(22, 33, 64, 85, 92, 94, 59, 27, 30, 64, 60, 33, 31, 9,
>
>                99, 67, 15, 5, 4, 30, 8, 37, 42, 27, 19, 69, 60, 73, 3, 5, 21,
>
>                37, 52, 70, 74, 9, 13, 4, 17, 47), ncol=2)
>
>
>
> # extract values for points
>
> xy <- rbind(cbind(1, p), cbind(0, a))
>
> v <- data.frame(cbind(pa=xy[,1], extract(logo, xy[,2:3])))
>
>
>
> # cforest (other Random Forest implementation) example with factors argument
>
>
>
> v$red <- as.factor(round(v$red/100))
>
> logo$red <- round(logo[[1]]/100)
>
>
>
> library(party)
>
> m <- cforest(pa~., control=cforest_unbiased(mtry=3), data=v) f <- list(levels(v$red))
>
> names(f) <- 'red'
>
> pc <- predict(logo, m, OOB=TRUE, factors=f)
>
>
>
> # Error in v[cells, ] <- predv :
>
> # number of items to replace is not a multiple of replacement length
>
>
>
> # If you change the order of the first two arguments (I read this somewhere) then the error changes, like this:
>
>
>
> pc <- predict(m, logo, OOB=TRUE, factors=f)
>
>
>
> # Error in RET at prediction_weights(newdata = newdata, mincriterion = mincriterion,  :
>
> # unused argument (factors = f)
>
>
>
> # Lastly, if I run the line without the 'factors' argument
>
> pc <- predict(m, logo, OOB=TRUE)
>
>
>
> # Then I get no errors, but I don't understand the result. It's a vector of 40 values (predictions?)
>
>
>
> I am using Package 'raster' version 2.6-7 in RStudio 1.1.453, running off a server. I have tried the on several other computers, though, and the error persisted.
>
>
>
> Many thanks for any help,
>
>
>
> Genoveva
>
> Genoveva Gonzalez Mirelis, Scientist
> Institute of Marine Research
> Nordnesgaten 50
> 5005 Bergen, Norway
> Phone number +47 55238510
>
>
> Genoveva Gonzalez Mirelis, Scientist
> Institute of Marine Research
> Nordnesgaten 50
> 5005 Bergen, Norway
> Phone number +47 55238510
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-ecology mailing list
> R-sig-ecology at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-ecology
>


From r@hep@rd @ending from @ppl-eco@y@@com  Tue Dec  4 19:25:34 2018
From: r@hep@rd @ending from @ppl-eco@y@@com (Rich Shepard)
Date: Tue, 4 Dec 2018 10:25:34 -0800 (PST)
Subject: [R-sig-Geo] How to test for a layer in GRASS GIS mapset using
 rgrass7
In-Reply-To: <80913593-5451-109d-4549-b11ea4e1cd52@uni-koeln.de>
References: <80913593-5451-109d-4549-b11ea4e1cd52@uni-koeln.de>
Message-ID: <alpine.LNX.2.20.1812041023060.32236@salmo.appl-ecosys.com>

On Tue, 4 Dec 2018, Christian Willmes wrote:

> During my script I use r.mapcalc from GRASS GIS to do some expensive
> computation. So I want to store and reuse the resulting layer, wich is
> produced according to a variable value, in case I need this layer for the
> specific variable value again.
>
> If I just omit the overwrite tag it does not work, becasue GRASS GIS stops 
> the execution on this event.

Christian,

   Yes, grass wants the --o flag to overwrite an existing file. You can learn
what raster maps exist using 'g.list type=rast | grep <mapname>'.

HTH,

Rich


From Roger@Biv@nd @ending from nhh@no  Tue Dec  4 20:55:08 2018
From: Roger@Biv@nd @ending from nhh@no (Roger Bivand)
Date: Tue, 4 Dec 2018 20:55:08 +0100
Subject: [R-sig-Geo] How to test for a layer in GRASS GIS mapset using
 rgrass7
In-Reply-To: <80913593-5451-109d-4549-b11ea4e1cd52@uni-koeln.de>
References: <80913593-5451-109d-4549-b11ea4e1cd52@uni-koeln.de>
Message-ID: <alpine.LFD.2.21.1812042048020.5400@reclus.nhh.no>

On Tue, 4 Dec 2018, Christian Willmes wrote:

> Hello,
>
> I am not sure if this is the correct list to ask this specific question about 
> executing GRASS GIS from R Scripts.
>
> My problem is how to determine if a layer exists in the current GRASS GIS 
> mapset or not.
>
> During my script I use r.mapcalc from GRASS GIS to do some expensive 
> computation. So I want to store and reuse the resulting layer, wich is 
> produced according to a variable value, in case I need this layer for the 
> specific variable value again.
>
> If I just omit the overwrite tag it does not work, becasue GRASS GIS stops 
> the execution on this event.
>
> Error in execGRASS("r.mapcalc", expression = expr) : The command:
> r.mapcalc expression="rsl40 = GEBCO_2014_2D_4326 >= -40"
> produced an error (1) during execution:
> FEHLER: output map <rsl40> exists. To overwrite, use the --overwrite flag
> Error in execGRASS("r.mapcalc", expression = expr) : The command:
> r.mapcalc expression="land_NA_1_rsl40? =? if( rsl40 , 1 ,null())"
> produced an error (1) during execution:
> FEHLER: output map <land_NA_1_rsl40> exists. To overwrite, use the
> ??????? --overwrite flag
>
> So, I tryed to check if a certain layer already exists in the mapset to test 
> if the computation needs/can be executed or not.
>
> Using the following:
>
> if(execGRASS("g.findfile", element="cell", file=lyrname, mapset='"."')){
> ??? return(FALSE)
> ? }else{
> ??? return(TRUE)
> ? }

You need to wrap the test in try() if it may not succeed (in nc):

oo <- try(execGRASS("g.findfile", element="cell", file="slope",
       mapset="'.'", intern=TRUE), silent=TRUE)
ifelse(class(oo) == "try-error", FALSE, TRUE)

and use intern to capture the output if the file exists. However, you can, 
as Rich says, simply overwrite existing files if you wish.

>
> Here it stops, if the layer does not exist:
>

Note that your R script does not stop, simply g.findfile has returned 1 
rather than 0 on exit.

Hope this clarifies,

Roger


> Fehler in execGRASS("g.findfile", element = "cell", file = lyrname, mapset = 
> "\".\"") :
> ? The command:
> g.findfile element=cell file=rsl40 mapset="."
> produced an error (1) during execution:
>
>
> Does anyone know a solution to this?
>
> Thank you very much!
>
> Best,
> Christian
>
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From t@vib@r @ending from gm@il@com  Tue Dec  4 22:42:50 2018
From: t@vib@r @ending from gm@il@com (Micha Silver)
Date: Tue, 4 Dec 2018 23:42:50 +0200
Subject: [R-sig-Geo] How to test for a layer in GRASS GIS mapset using
 rgrass7
In-Reply-To: <80913593-5451-109d-4549-b11ea4e1cd52@uni-koeln.de>
References: <80913593-5451-109d-4549-b11ea4e1cd52@uni-koeln.de>
Message-ID: <adaaab4e-ba11-37b9-94a8-d9b7c7f85c32@gmail.com>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20181204/06b39917/attachment.html>

From c@willme@ @ending from uni-koeln@de  Wed Dec  5 09:24:20 2018
From: c@willme@ @ending from uni-koeln@de (Christian Willmes)
Date: Wed, 5 Dec 2018 09:24:20 +0100
Subject: [R-sig-Geo] How to test for a layer in GRASS GIS mapset using
 rgrass7
In-Reply-To: <alpine.LFD.2.21.1812042048020.5400@reclus.nhh.no>
References: <80913593-5451-109d-4549-b11ea4e1cd52@uni-koeln.de>
 <alpine.LFD.2.21.1812042048020.5400@reclus.nhh.no>
Message-ID: <05a80563-7a1c-2965-950c-afb363ce1f68@uni-koeln.de>


Am 04.12.18 um 20:55 schrieb Roger Bivand:
> You need to wrap the test in try() if it may not succeed (in nc):
>
> oo <- try(execGRASS("g.findfile", element="cell", file="slope",
> ????? mapset="'.'", intern=TRUE), silent=TRUE)
> ifelse(class(oo) == "try-error", FALSE, TRUE)
>
> and use intern to capture the output if the file exists.

Thank you very much, this was exactly what solved the issue.

Best regards,
Christian



-- 
Dr. Christian Willmes	
AG GIS & Fernerkundung      | GIS & RS Group
Geographisches Institut     | Institute of Geography
Universit?t zu K?ln         | University of Cologne
Tel.: +49 (0)221 470 6234
http://www.geographie.uni-koeln.de/14126.html
http://www.sfb806.de
http://crc806db.uni-koeln.de
http://publons.com/a/1316706/
http://orcid.org/0000-0002-5566-6542


From genovev@@gonz@lez-mireli@ @ending from hi@no  Wed Dec  5 10:06:29 2018
From: genovev@@gonz@lez-mireli@ @ending from hi@no (Gonzalez-Mirelis, Genoveva)
Date: Wed, 5 Dec 2018 09:06:29 +0000
Subject: [R-sig-Geo] [R-sig-eco] raster::predict example doesn't work?
In-Reply-To: <9b100def-346a-0562-d67c-ae70e99ba151@gmail.com>
References: <b0da65baed4a49eba15be8ad15b8a53d@hi.no>
 <9b100def-346a-0562-d67c-ae70e99ba151@gmail.com>
Message-ID: <e6f6bae646a84cc2afdc91c9ed522bbb@hi.no>

Thank you ?kos, your solution does work. One caveat, though: the 'predict' function from 'stats' returns a matrix, whereas that from the 'raster' package returns a raster object of identical extent and resolution as the supplied predictor stack, which is very handy. If no other solutions arise I will just convert that matrix to a raster as follows:

r <- raster(ncol=ncol(logo), nrow=nrow(logo))
extent(r) <- extent(logo)
values(r) <- pc


-----Original Message-----
From: R-sig-ecology <r-sig-ecology-bounces at r-project.org> On Behalf Of Bede-Fazekas ?kos
Sent: 4. desember 2018 16:50
To: r-sig-ecology at r-project.org; R-sig-geo <r-sig-geo at r-project.org>
Subject: Re: [R-sig-eco] raster::predict example doesn't work?

Dear Genoveva,

All the examples in the help file of package 'party' 
(https://cran.r-project.org/web/packages/party/party.pdf) use the function predict() from package 'stats' instead of package 'raster'.
But converting the RasterStack to data.frame, changing the column 'red' 
from numeric to factor, using stats::predict(..., newdata), and create a new layer of the RasterStack can solve the problem.
logo_df <- as.data.frame(logo)
logo_df$red <- factor(logo_df$red, levels = levels(v$red)) pc <- stats::predict(m, OOB = TRUE, newdata = logo_df) logo$pc <- pc

HTH,
?kos Bede-Fazekas
Hungarian Academy of Sciences


2018.12.04. 15:52 keltez?ssel, Gonzalez-Mirelis, Genoveva ?rta:
> Dear list,
>
> I posted this question recently on another list so I apologize for any cross-posting. Still no solution.
>
>
> I would like to use the 'predict' function in the 'raster' package in an implementation of species distribution modelling with a couple of factor variables. Furthermore, I would like to set this up exactly as the cforest example listed in the help file. Unfortunately, I cannot get the example to work!
>
>
>
> # create a RasterStack or RasterBrick with with a set of predictor 
> layers
>
>
>
> logo <- brick(system.file("external/rlogo.grd", package="raster"))
>
> names(logo)
>
>
>
> # known presence and absence points
>
> p <- matrix(c(48, 48, 48, 53, 50, 46, 54, 70, 84, 85, 74, 84, 95, 85,
>
>                66, 42, 26, 4, 19, 17, 7, 14, 26, 29, 39, 45, 51, 56, 
> 46, 38, 31,
>
>                22, 34, 60, 70, 73, 63, 46, 43, 28), ncol=2)
>
>
>
> a <- matrix(c(22, 33, 64, 85, 92, 94, 59, 27, 30, 64, 60, 33, 31, 9,
>
>                99, 67, 15, 5, 4, 30, 8, 37, 42, 27, 19, 69, 60, 73, 3, 
> 5, 21,
>
>                37, 52, 70, 74, 9, 13, 4, 17, 47), ncol=2)
>
>
>
> # extract values for points
>
> xy <- rbind(cbind(1, p), cbind(0, a))
>
> v <- data.frame(cbind(pa=xy[,1], extract(logo, xy[,2:3])))
>
>
>
> # cforest (other Random Forest implementation) example with factors 
> argument
>
>
>
> v$red <- as.factor(round(v$red/100))
>
> logo$red <- round(logo[[1]]/100)
>
>
>
> library(party)
>
> m <- cforest(pa~., control=cforest_unbiased(mtry=3), data=v) f <- 
> list(levels(v$red))
>
> names(f) <- 'red'
>
> pc <- predict(logo, m, OOB=TRUE, factors=f)
>
>
>
> # Error in v[cells, ] <- predv :
>
> # number of items to replace is not a multiple of replacement length
>
>
>
> # If you change the order of the first two arguments (I read this somewhere) then the error changes, like this:
>
>
>
> pc <- predict(m, logo, OOB=TRUE, factors=f)
>
>
>
> # Error in RET at prediction_weights(newdata = newdata, mincriterion = mincriterion,  :
>
> # unused argument (factors = f)
>
>
>
> # Lastly, if I run the line without the 'factors' argument
>
> pc <- predict(m, logo, OOB=TRUE)
>
>
>
> # Then I get no errors, but I don't understand the result. It's a 
> vector of 40 values (predictions?)
>
>
>
> I am using Package 'raster' version 2.6-7 in RStudio 1.1.453, running off a server. I have tried the on several other computers, though, and the error persisted.
>
>
>
> Many thanks for any help,
>
>
>
> Genoveva
>
> Genoveva Gonzalez Mirelis, Scientist
> Institute of Marine Research
> Nordnesgaten 50
> 5005 Bergen, Norway
> Phone number +47 55238510
>
>
> Genoveva Gonzalez Mirelis, Scientist
> Institute of Marine Research
> Nordnesgaten 50
> 5005 Bergen, Norway
> Phone number +47 55238510
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-ecology mailing list
> R-sig-ecology at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-ecology
>

_______________________________________________
R-sig-ecology mailing list
R-sig-ecology at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-ecology


From c@willme@ @ending from uni-koeln@de  Thu Dec  6 09:37:29 2018
From: c@willme@ @ending from uni-koeln@de (Christian Willmes)
Date: Thu, 6 Dec 2018 09:37:29 +0100
Subject: [R-sig-Geo] clip a raster layer to a mask layer using raster
 algebra in R?
Message-ID: <697c40e7-2d38-f90f-cd79-9f2cade54598@uni-koeln.de>

Hello,

this should be normally a very basic simple one-liner, but I can't get 
my head around it. I only find solutions for cliping a raster against a 
vector, but none for clipping a raster against a raster mask.

I want to clip a layer to a mask. In GRASS GIS r.mapcalc the syntax is:

result = if(RSLmask, gebco, null())

This clips the GEBCO dataset to the extent of the given raster mask 
'rslmask'. The result raster has heigt values within the raster mask 
extent, the rest of the raster layer has NULL or NA values.

In R I did the following, but it does not work as expected:

gebco <- raster(gebco2014) #load raster

RSLmask <- gebco >= 0? #create mask layer

RSL <- ifelse(RSLmask, 1, NA)

The last command gives an error about vector type 'S4'?!

 >In is.na(test) :
 ? >is.na() auf nicht-(Liste oder Vektor) des Typs 'S4' angewendet

So, in short: what is the R way to simply clip a raster to a raster mask?

Thanks and best regards,
Christian

PS: If found many solutions for clipping a raster to a vector polygon, 
but this is not what I want.

-- 
Dr. Christian Willmes	
AG GIS & Fernerkundung      | GIS & RS Group
Geographisches Institut     | Institute of Geography
Universit?t zu K?ln         | University of Cologne
Tel.: +49 (0)221 470 6234
http://www.geographie.uni-koeln.de/14126.html
http://www.sfb806.de
http://crc806db.uni-koeln.de
http://publons.com/a/1316706/
http://orcid.org/0000-0002-5566-6542


From c@willme@ @ending from uni-koeln@de  Thu Dec  6 09:40:14 2018
From: c@willme@ @ending from uni-koeln@de (Christian Willmes)
Date: Thu, 6 Dec 2018 09:40:14 +0100
Subject: [R-sig-Geo] clip a raster layer to a mask layer using raster
 algebra in R?
In-Reply-To: <697c40e7-2d38-f90f-cd79-9f2cade54598@uni-koeln.de>
References: <697c40e7-2d38-f90f-cd79-9f2cade54598@uni-koeln.de>
Message-ID: <900eb148-37f5-3389-8e5a-5147d65bbf05@uni-koeln.de>

Sorry, I had an error in the main command.

It should be:

gebco_clipped <- ifelse(RSLmask, gebco, NA)

But it still gives the same error.

Best,
Christian

Am 06.12.18 um 09:37 schrieb Christian Willmes:
> Hello,
>
> this should be normally a very basic simple one-liner, but I can't get 
> my head around it. I only find solutions for cliping a raster against 
> a vector, but none for clipping a raster against a raster mask.
>
> I want to clip a layer to a mask. In GRASS GIS r.mapcalc the syntax is:
>
> result = if(RSLmask, gebco, null())
>
> This clips the GEBCO dataset to the extent of the given raster mask 
> 'rslmask'. The result raster has heigt values within the raster mask 
> extent, the rest of the raster layer has NULL or NA values.
>
> In R I did the following, but it does not work as expected:
>
> gebco <- raster(gebco2014) #load raster
>
> RSLmask <- gebco >= 0? #create mask layer
>
> RSL <- ifelse(RSLmask, 1, NA)
>
> The last command gives an error about vector type 'S4'?!
>
> >In is.na(test) :
> ? >is.na() auf nicht-(Liste oder Vektor) des Typs 'S4' angewendet
>
> So, in short: what is the R way to simply clip a raster to a raster mask?
>
> Thanks and best regards,
> Christian
>
> PS: If found many solutions for clipping a raster to a vector polygon, 
> but this is not what I want.
>
-- 
Dr. Christian Willmes	
AG GIS & Fernerkundung      | GIS & RS Group
Geographisches Institut     | Institute of Geography
Universit?t zu K?ln         | University of Cologne
Tel.: +49 (0)221 470 6234
http://www.geographie.uni-koeln.de/14126.html
http://www.sfb806.de
http://crc806db.uni-koeln.de
http://publons.com/a/1316706/
http://orcid.org/0000-0002-5566-6542


From bf@levli@t @ending from gm@il@com  Thu Dec  6 10:59:37 2018
From: bf@levli@t @ending from gm@il@com (=?UTF-8?Q?Bede-Fazekas_=c3=81kos?=)
Date: Thu, 6 Dec 2018 10:59:37 +0100
Subject: [R-sig-Geo] clip a raster layer to a mask layer using raster
 algebra in R?
In-Reply-To: <900eb148-37f5-3389-8e5a-5147d65bbf05@uni-koeln.de>
References: <697c40e7-2d38-f90f-cd79-9f2cade54598@uni-koeln.de>
 <900eb148-37f5-3389-8e5a-5147d65bbf05@uni-koeln.de>
Message-ID: <cbbe935a-85fd-bf53-5f24-b2a54f083672@gmail.com>

Dear Christian,
raster::mask() and raster::crop() may solve your problem.
https://www.rdocumentation.org/packages/raster/versions/2.8-4/topics/mask
https://www.rdocumentation.org/packages/raster/versions/2.8-4/topics/crop

HTH,
?kos Bede-Fazekas
Hungarian Academy of Sciences

2018.12.06. 9:40 keltez?ssel, Christian Willmes ?rta:
> Sorry, I had an error in the main command.
>
> It should be:
>
> gebco_clipped <- ifelse(RSLmask, gebco, NA)
>
> But it still gives the same error.
>
> Best,
> Christian
>
> Am 06.12.18 um 09:37 schrieb Christian Willmes:
>> Hello,
>>
>> this should be normally a very basic simple one-liner, but I can't 
>> get my head around it. I only find solutions for cliping a raster 
>> against a vector, but none for clipping a raster against a raster mask.
>>
>> I want to clip a layer to a mask. In GRASS GIS r.mapcalc the syntax is:
>>
>> result = if(RSLmask, gebco, null())
>>
>> This clips the GEBCO dataset to the extent of the given raster mask 
>> 'rslmask'. The result raster has heigt values within the raster mask 
>> extent, the rest of the raster layer has NULL or NA values.
>>
>> In R I did the following, but it does not work as expected:
>>
>> gebco <- raster(gebco2014) #load raster
>>
>> RSLmask <- gebco >= 0? #create mask layer
>>
>> RSL <- ifelse(RSLmask, 1, NA)
>>
>> The last command gives an error about vector type 'S4'?!
>>
>> >In is.na(test) :
>> ? >is.na() auf nicht-(Liste oder Vektor) des Typs 'S4' angewendet
>>
>> So, in short: what is the R way to simply clip a raster to a raster 
>> mask?
>>
>> Thanks and best regards,
>> Christian
>>
>> PS: If found many solutions for clipping a raster to a vector 
>> polygon, but this is not what I want.
>>


From c@willme@ @ending from uni-koeln@de  Thu Dec  6 13:33:29 2018
From: c@willme@ @ending from uni-koeln@de (Christian Willmes)
Date: Thu, 6 Dec 2018 13:33:29 +0100
Subject: [R-sig-Geo] clip a raster layer to a mask layer using raster
 algebra in R?
In-Reply-To: <cbbe935a-85fd-bf53-5f24-b2a54f083672@gmail.com>
References: <697c40e7-2d38-f90f-cd79-9f2cade54598@uni-koeln.de>
 <900eb148-37f5-3389-8e5a-5147d65bbf05@uni-koeln.de>
 <cbbe935a-85fd-bf53-5f24-b2a54f083672@gmail.com>
Message-ID: <3f715b25-8f56-2c6a-8336-8a3aac5fad95@uni-koeln.de>

Thank you.

It seems that both approaches need an additional, very expensive 
computation (takes several minutes on a i7-4790 with SSD) to create the 
mask or the extent, and in my case the mask computed by this command 
below is already what I want. Only values above a given RSL (Sealevel) 
height. The rest of the raster needs to be NA or NULL.

 >gebco_rsl <- gebco
 >gebco_rsl[gebco < rsl] <- NA

....

The easy (and faster) approach for creating a mask:

 >gebco_mask <- gebco >= rsl

writes 0's into the remaining cells, which does not work for me (and the 
mask() function).

On the other hand, the GRASS mapcalc computation (given below) takes 
less than a minute on that same raster.

I wanted to re-implement the whole analysis in R for better/easier 
reproducibility, but now I think I will stick to R + GRASS GIS.

If anyone knows a faster approach for creating a mask in R, please let 
me know.

Thanks and best regards,
Christian

Am 06.12.18 um 10:59 schrieb Bede-Fazekas ?kos:
> Dear Christian,
> raster::mask() and raster::crop() may solve your problem.
> https://www.rdocumentation.org/packages/raster/versions/2.8-4/topics/mask
> https://www.rdocumentation.org/packages/raster/versions/2.8-4/topics/crop
>
> HTH,
> ?kos Bede-Fazekas
> Hungarian Academy of Sciences
>
> 2018.12.06. 9:40 keltez?ssel, Christian Willmes ?rta:
>> Sorry, I had an error in the main command.
>>
>> It should be:
>>
>> gebco_clipped <- ifelse(RSLmask, gebco, NA)
>>
>> But it still gives the same error.
>>
>> Best,
>> Christian
>>
>> Am 06.12.18 um 09:37 schrieb Christian Willmes:
>>> Hello,
>>>
>>> this should be normally a very basic simple one-liner, but I can't 
>>> get my head around it. I only find solutions for cliping a raster 
>>> against a vector, but none for clipping a raster against a raster mask.
>>>
>>> I want to clip a layer to a mask. In GRASS GIS r.mapcalc the syntax is:
>>>
>>> result = if(RSLmask, gebco, null())
>>>
>>> This clips the GEBCO dataset to the extent of the given raster mask 
>>> 'rslmask'. The result raster has heigt values within the raster mask 
>>> extent, the rest of the raster layer has NULL or NA values.
>>>
>>> In R I did the following, but it does not work as expected:
>>>
>>> gebco <- raster(gebco2014) #load raster
>>>
>>> RSLmask <- gebco >= 0? #create mask layer
>>>
>>> RSL <- ifelse(RSLmask, 1, NA)
>>>
>>> The last command gives an error about vector type 'S4'?!
>>>
>>> >In is.na(test) :
>>> ? >is.na() auf nicht-(Liste oder Vektor) des Typs 'S4' angewendet
>>>
>>> So, in short: what is the R way to simply clip a raster to a raster 
>>> mask?
>>>
>>> Thanks and best regards,
>>> Christian
>>>
>>> PS: If found many solutions for clipping a raster to a vector 
>>> polygon, but this is not what I want.
>>>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Dr. Christian Willmes	
AG GIS & Fernerkundung      | GIS & RS Group
Geographisches Institut     | Institute of Geography
Universit?t zu K?ln         | University of Cologne
Tel.: +49 (0)221 470 6234
http://www.geographie.uni-koeln.de/14126.html
http://www.sfb806.de
http://crc806db.uni-koeln.de
http://publons.com/a/1316706/
http://orcid.org/0000-0002-5566-6542


From hugo@gco@t@ @ending from gm@il@com  Thu Dec  6 14:22:54 2018
From: hugo@gco@t@ @ending from gm@il@com (Hugo Costa)
Date: Thu, 6 Dec 2018 14:22:54 +0100
Subject: [R-sig-Geo] clip a raster layer to a mask layer using raster
 algebra in R?
In-Reply-To: <3f715b25-8f56-2c6a-8336-8a3aac5fad95@uni-koeln.de>
References: <697c40e7-2d38-f90f-cd79-9f2cade54598@uni-koeln.de>
 <900eb148-37f5-3389-8e5a-5147d65bbf05@uni-koeln.de>
 <cbbe935a-85fd-bf53-5f24-b2a54f083672@gmail.com>
 <3f715b25-8f56-2c6a-8336-8a3aac5fad95@uni-koeln.de>
Message-ID: <CADvFi5pLJx_xBWAT6jOBkp9Um+OVn2P+N8BAjeexfr+hQKrvGw@mail.gmail.com>

Possibly there are alternatives, like exploring raster::overlay together
with raster:clusterR
Hugo

Christian Willmes <c.willmes at uni-koeln.de> escreveu no dia quinta,
6/12/2018 ?(s) 13:34:

> Thank you.
>
> It seems that both approaches need an additional, very expensive
> computation (takes several minutes on a i7-4790 with SSD) to create the
> mask or the extent, and in my case the mask computed by this command
> below is already what I want. Only values above a given RSL (Sealevel)
> height. The rest of the raster needs to be NA or NULL.
>
>  >gebco_rsl <- gebco
>  >gebco_rsl[gebco < rsl] <- NA
>
> ....
>
> The easy (and faster) approach for creating a mask:
>
>  >gebco_mask <- gebco >= rsl
>
> writes 0's into the remaining cells, which does not work for me (and the
> mask() function).
>
> On the other hand, the GRASS mapcalc computation (given below) takes
> less than a minute on that same raster.
>
> I wanted to re-implement the whole analysis in R for better/easier
> reproducibility, but now I think I will stick to R + GRASS GIS.
>
> If anyone knows a faster approach for creating a mask in R, please let
> me know.
>
> Thanks and best regards,
> Christian
>
> Am 06.12.18 um 10:59 schrieb Bede-Fazekas ?kos:
> > Dear Christian,
> > raster::mask() and raster::crop() may solve your problem.
> >
> https://www.rdocumentation.org/packages/raster/versions/2.8-4/topics/mask
> >
> https://www.rdocumentation.org/packages/raster/versions/2.8-4/topics/crop
> >
> > HTH,
> > ?kos Bede-Fazekas
> > Hungarian Academy of Sciences
> >
> > 2018.12.06. 9:40 keltez?ssel, Christian Willmes ?rta:
> >> Sorry, I had an error in the main command.
> >>
> >> It should be:
> >>
> >> gebco_clipped <- ifelse(RSLmask, gebco, NA)
> >>
> >> But it still gives the same error.
> >>
> >> Best,
> >> Christian
> >>
> >> Am 06.12.18 um 09:37 schrieb Christian Willmes:
> >>> Hello,
> >>>
> >>> this should be normally a very basic simple one-liner, but I can't
> >>> get my head around it. I only find solutions for cliping a raster
> >>> against a vector, but none for clipping a raster against a raster mask.
> >>>
> >>> I want to clip a layer to a mask. In GRASS GIS r.mapcalc the syntax is:
> >>>
> >>> result = if(RSLmask, gebco, null())
> >>>
> >>> This clips the GEBCO dataset to the extent of the given raster mask
> >>> 'rslmask'. The result raster has heigt values within the raster mask
> >>> extent, the rest of the raster layer has NULL or NA values.
> >>>
> >>> In R I did the following, but it does not work as expected:
> >>>
> >>> gebco <- raster(gebco2014) #load raster
> >>>
> >>> RSLmask <- gebco >= 0  #create mask layer
> >>>
> >>> RSL <- ifelse(RSLmask, 1, NA)
> >>>
> >>> The last command gives an error about vector type 'S4'?!
> >>>
> >>> >In is.na(test) :
> >>>   >is.na() auf nicht-(Liste oder Vektor) des Typs 'S4' angewendet
> >>>
> >>> So, in short: what is the R way to simply clip a raster to a raster
> >>> mask?
> >>>
> >>> Thanks and best regards,
> >>> Christian
> >>>
> >>> PS: If found many solutions for clipping a raster to a vector
> >>> polygon, but this is not what I want.
> >>>
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> --
> Dr. Christian Willmes
> AG GIS & Fernerkundung      | GIS & RS Group
> Geographisches Institut     | Institute of Geography
> Universit?t zu K?ln         | University of Cologne
> Tel.: +49 (0)221 470 6234
> http://www.geographie.uni-koeln.de/14126.html
> http://www.sfb806.de
> http://crc806db.uni-koeln.de
> http://publons.com/a/1316706/
> http://orcid.org/0000-0002-5566-6542
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From obrl@oil@u @ending from gm@il@com  Sun Dec  9 09:59:19 2018
From: obrl@oil@u @ending from gm@il@com (obrl soil)
Date: Sun, 9 Dec 2018 18:59:19 +1000
Subject: [R-sig-Geo] clip a raster layer to a mask layer using raster
 algebra in R?
In-Reply-To: <697c40e7-2d38-f90f-cd79-9f2cade54598@uni-koeln.de>
References: <697c40e7-2d38-f90f-cd79-9f2cade54598@uni-koeln.de>
Message-ID: <CALG31BUU7fm=v_eOnEJw8L0y2xgX4LTKePpPg3QQMDB0w5ocig@mail.gmail.com>

Hello,

in R you're working without the benefit of the GRASS 'region' concept
for raster work (and all the hidden helper code that goes with it), so
its never going to be a one liner - but the following may help.

You can use raster algebra in R to do masking. Construct your mask so
that the cells you want to keep are 0 and the cells you want to lose
are NA.

Then you can just add the raster and its mask together:

masked_raster <- raster + mask

because data + 0 = data, and data + NA = NA. This will still work even
if the two rasters don't have the same extent, so long as they have
the same cell size and alignment. The operation will throw a warning
but will complete successfully, returning the intersection of the two
objects. This should complete fairly quickly if the mask extent is
small relative to the target dataset. Try using raster::trim() on the
mask beforehand if it has a lot of whitespace.

HTH
@obrl_soil

On Thu, Dec 6, 2018 at 6:38 PM Christian Willmes <c.willmes at uni-koeln.de> wrote:
>
> Hello,
>
> this should be normally a very basic simple one-liner, but I can't get
> my head around it. I only find solutions for cliping a raster against a
> vector, but none for clipping a raster against a raster mask.
>
> I want to clip a layer to a mask. In GRASS GIS r.mapcalc the syntax is:
>
> result = if(RSLmask, gebco, null())
>
> This clips the GEBCO dataset to the extent of the given raster mask
> 'rslmask'. The result raster has heigt values within the raster mask
> extent, the rest of the raster layer has NULL or NA values.
>
> In R I did the following, but it does not work as expected:
>
> gebco <- raster(gebco2014) #load raster
>
> RSLmask <- gebco >= 0  #create mask layer
>
> RSL <- ifelse(RSLmask, 1, NA)
>
> The last command gives an error about vector type 'S4'?!
>
>  >In is.na(test) :
>    >is.na() auf nicht-(Liste oder Vektor) des Typs 'S4' angewendet
>
> So, in short: what is the R way to simply clip a raster to a raster mask?
>
> Thanks and best regards,
> Christian
>
> PS: If found many solutions for clipping a raster to a vector polygon,
> but this is not what I want.
>
> --
> Dr. Christian Willmes
> AG GIS & Fernerkundung      | GIS & RS Group
> Geographisches Institut     | Institute of Geography
> Universit?t zu K?ln         | University of Cologne
> Tel.: +49 (0)221 470 6234
> http://www.geographie.uni-koeln.de/14126.html
> http://www.sfb806.de
> http://crc806db.uni-koeln.de
> http://publons.com/a/1316706/
> http://orcid.org/0000-0002-5566-6542
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From c@willme@ @ending from uni-koeln@de  Mon Dec 10 15:46:06 2018
From: c@willme@ @ending from uni-koeln@de (Christian Willmes)
Date: Mon, 10 Dec 2018 15:46:06 +0100
Subject: [R-sig-Geo] clip a raster layer to a mask layer using raster
 algebra in R?
In-Reply-To: <CALG31BUU7fm=v_eOnEJw8L0y2xgX4LTKePpPg3QQMDB0w5ocig@mail.gmail.com>
References: <697c40e7-2d38-f90f-cd79-9f2cade54598@uni-koeln.de>
 <CALG31BUU7fm=v_eOnEJw8L0y2xgX4LTKePpPg3QQMDB0w5ocig@mail.gmail.com>
Message-ID: <e36c56ca-8704-7735-6051-d272a30f379d@uni-koeln.de>

Thank you.

But the most expensive step is constructing the mask with NA values.

 >gebco_rsl[gebco < rsl] <- NA

The rest of the computations is quite fast indeed... Do you know a 
faster alternative, for creating the mask, to the line above?

Best,
Christian

Am 09.12.18 um 09:59 schrieb obrl soil:
> Hello,
>
> in R you're working without the benefit of the GRASS 'region' concept
> for raster work (and all the hidden helper code that goes with it), so
> its never going to be a one liner - but the following may help.
>
> You can use raster algebra in R to do masking. Construct your mask so
> that the cells you want to keep are 0 and the cells you want to lose
> are NA.
>
> Then you can just add the raster and its mask together:
>
> masked_raster <- raster + mask
>
> because data + 0 = data, and data + NA = NA. This will still work even
> if the two rasters don't have the same extent, so long as they have
> the same cell size and alignment. The operation will throw a warning
> but will complete successfully, returning the intersection of the two
> objects. This should complete fairly quickly if the mask extent is
> small relative to the target dataset. Try using raster::trim() on the
> mask beforehand if it has a lot of whitespace.
>
> HTH
> @obrl_soil
>
> On Thu, Dec 6, 2018 at 6:38 PM Christian Willmes <c.willmes at uni-koeln.de> wrote:
>> Hello,
>>
>> this should be normally a very basic simple one-liner, but I can't get
>> my head around it. I only find solutions for cliping a raster against a
>> vector, but none for clipping a raster against a raster mask.
>>
>> I want to clip a layer to a mask. In GRASS GIS r.mapcalc the syntax is:
>>
>> result = if(RSLmask, gebco, null())
>>
>> This clips the GEBCO dataset to the extent of the given raster mask
>> 'rslmask'. The result raster has heigt values within the raster mask
>> extent, the rest of the raster layer has NULL or NA values.
>>
>> In R I did the following, but it does not work as expected:
>>
>> gebco <- raster(gebco2014) #load raster
>>
>> RSLmask <- gebco >= 0  #create mask layer
>>
>> RSL <- ifelse(RSLmask, 1, NA)
>>
>> The last command gives an error about vector type 'S4'?!
>>
>>   >In is.na(test) :
>>     >is.na() auf nicht-(Liste oder Vektor) des Typs 'S4' angewendet
>>
>> So, in short: what is the R way to simply clip a raster to a raster mask?
>>
>> Thanks and best regards,
>> Christian
>>
>> PS: If found many solutions for clipping a raster to a vector polygon,
>> but this is not what I want.
>>
>> --
>> Dr. Christian Willmes
>> AG GIS & Fernerkundung      | GIS & RS Group
>> Geographisches Institut     | Institute of Geography
>> Universit?t zu K?ln         | University of Cologne
>> Tel.: +49 (0)221 470 6234
>> http://www.geographie.uni-koeln.de/14126.html
>> http://www.sfb806.de
>> http://crc806db.uni-koeln.de
>> http://publons.com/a/1316706/
>> http://orcid.org/0000-0002-5566-6542
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Dr. Christian Willmes	
AG GIS & Fernerkundung      | GIS & RS Group
Geographisches Institut     | Institute of Geography
Universit?t zu K?ln         | University of Cologne
Tel.: +49 (0)221 470 6234
http://www.geographie.uni-koeln.de/14126.html
http://www.sfb806.de
http://crc806db.uni-koeln.de
http://publons.com/a/1316706/
http://orcid.org/0000-0002-5566-6542


From @loboli@t@@ @ending from gm@il@com  Wed Dec 19 09:56:24 2018
From: @loboli@t@@ @ending from gm@il@com (Agustin Lobo)
Date: Wed, 19 Dec 2018 09:56:24 +0100
Subject: [R-sig-Geo] writeRaster: BSQ despite BIL is requested
Message-ID: <CAG4NReLWOcnyjiArEx=NK45PS6W4xqHWnC7n2Ru6YF0nBWZXWg@mail.gmail.com>

I do

writeRaster(testin,
file="testin",format="ENVI",datatype="INT2U",bandorder="BIL",overwrite=TRUE)

but get an image with BSQ order
(rda object: https://www.dropbox.com/s/or5h7yb9nd52e94/testin.rda?dl=0)
Thanks
Agus

R version 3.5.0 (2018-04-23)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Debian GNU/Linux buster/sid

Matrix products: default
BLAS: /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.8.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.8.0

locale:
 [1] LC_CTYPE=en_GB.UTF-8       LC_NUMERIC=C
LC_TIME=en_GB.UTF-8        LC_COLLATE=en_GB.UTF-8
LC_MONETARY=en_GB.UTF-8
 [6] LC_MESSAGES=en_GB.UTF-8    LC_PAPER=en_GB.UTF-8       LC_NAME=C
               LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_GB.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] raster_2.7-15 rgdal_1.3-6   sp_1.3-1


Agus


From Roger@Biv@nd @ending from nhh@no  Wed Dec 19 11:51:57 2018
From: Roger@Biv@nd @ending from nhh@no (Roger Bivand)
Date: Wed, 19 Dec 2018 11:51:57 +0100
Subject: [R-sig-Geo] writeRaster: BSQ despite BIL is requested
In-Reply-To: <CAG4NReLWOcnyjiArEx=NK45PS6W4xqHWnC7n2Ru6YF0nBWZXWg@mail.gmail.com>
References: <CAG4NReLWOcnyjiArEx=NK45PS6W4xqHWnC7n2Ru6YF0nBWZXWg@mail.gmail.com>
Message-ID: <alpine.LFD.2.21.1812191136300.3510@reclus.nhh.no>

On Wed, 19 Dec 2018, Agustin Lobo wrote:

> I do
>
> writeRaster(testin,
> file="testin",format="ENVI",datatype="INT2U",bandorder="BIL",overwrite=TRUE)
>
> but get an image with BSQ order
> (rda object: https://www.dropbox.com/s/or5h7yb9nd52e94/testin.rda?dl=0)

Which version of GDAL is under all of this? It doesn't matter here, but 
might have mattered.

raster::writeRaster() puts interleave = bsq in the *.hdr files. "BIP" and 
does not seem to do anything. However:

writeGDAL(as(testin, "SpatialGridDataFrame"), fname="testinsp.envi", 
drivername="ENVI", type="UInt16", options="INTERLEAVE=BIL", 
setStatistics=TRUE)

yields interleave = bil in the *.hdr file. Using the same route, I get:

writeRaster(testin, file="testin", format="ENVI", datatype="INT2U", 
options="INTERLEAVE=BIL", overwrite=TRUE)

with interleave = bil in the *.hdr file. I'm not sure where 
raster::writeRaster() drops the options definitions given in bandorder=, 
maybe ENVI is not a 'native' file format?

Hope this helps,

Roger


> Thanks
> Agus
>
> R version 3.5.0 (2018-04-23)
> Platform: x86_64-pc-linux-gnu (64-bit)
> Running under: Debian GNU/Linux buster/sid
>
> Matrix products: default
> BLAS: /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.8.0
> LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.8.0
>
> locale:
> [1] LC_CTYPE=en_GB.UTF-8       LC_NUMERIC=C
> LC_TIME=en_GB.UTF-8        LC_COLLATE=en_GB.UTF-8
> LC_MONETARY=en_GB.UTF-8
> [6] LC_MESSAGES=en_GB.UTF-8    LC_PAPER=en_GB.UTF-8       LC_NAME=C
>               LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_GB.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] raster_2.7-15 rgdal_1.3-6   sp_1.3-1
>
>
> Agus
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From @loboli@t@@ @ending from gm@il@com  Wed Dec 19 14:45:34 2018
From: @loboli@t@@ @ending from gm@il@com (Agustin Lobo)
Date: Wed, 19 Dec 2018 14:45:34 +0100
Subject: [R-sig-Geo] writeRaster: BSQ despite BIL is requested
In-Reply-To: <alpine.LFD.2.21.1812191136300.3510@reclus.nhh.no>
References: <CAG4NReLWOcnyjiArEx=NK45PS6W4xqHWnC7n2Ru6YF0nBWZXWg@mail.gmail.com>
 <alpine.LFD.2.21.1812191136300.3510@reclus.nhh.no>
Message-ID: <CAG4NReJ-cWEtmKGPh5f5cZSAoqgryJ+MyQZWfqAcM7A5AXctvw@mail.gmail.com>

Thanks Roger,

Just to summarize, not only the hdr files are correct, the hdr files
are consistent with the ordering in the data files:

require(rgdal)
require(raster)
m <- matrix(rep(10,20),ncol=5)
b <- brick(raster(m),raster(10*m),raster(100*m))
b
writeRaster(b, file="bwrast", format="ENVI", datatype="INT2U",
            bandorder="BIL", overwrite=TRUE)

writes a correct BSQ file, despite having requested BIL order

writeRaster(b, file="bwrast2", format="ENVI", datatype="INT2U",
            options="INTERLEAVE=BIL", overwrite=TRUE)

writes a correct BIL file (and this is a useful solution, thanks).

I tend to think that the fact that writeRaster() ignores
bandorder="BIL" is a bug.

Agus
(mi R is using Loaded GDAL runtime: GDAL 2.3.2, released 2018/09/21)

On Wed, Dec 19, 2018 at 11:52 AM Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
> On Wed, 19 Dec 2018, Agustin Lobo wrote:
>
> > I do
> >
> > writeRaster(testin,
> > file="testin",format="ENVI",datatype="INT2U",bandorder="BIL",overwrite=TRUE)
> >
> > but get an image with BSQ order
> > (rda object: https://www.dropbox.com/s/or5h7yb9nd52e94/testin.rda?dl=0)
>
> Which version of GDAL is under all of this? It doesn't matter here, but
> might have mattered.
>
> raster::writeRaster() puts interleave = bsq in the *.hdr files. "BIP" and
> does not seem to do anything. However:
>
> writeGDAL(as(testin, "SpatialGridDataFrame"), fname="testinsp.envi",
> drivername="ENVI", type="UInt16", options="INTERLEAVE=BIL",
> setStatistics=TRUE)
>
> yields interleave = bil in the *.hdr file. Using the same route, I get:
>
> writeRaster(testin, file="testin", format="ENVI", datatype="INT2U",
> options="INTERLEAVE=BIL", overwrite=TRUE)
>
> with interleave = bil in the *.hdr file. I'm not sure where
> raster::writeRaster() drops the options definitions given in bandorder=,
> maybe ENVI is not a 'native' file format?
>
> Hope this helps,
>
> Roger
>
>
> > Thanks
> > Agus
> >
> > R version 3.5.0 (2018-04-23)
> > Platform: x86_64-pc-linux-gnu (64-bit)
> > Running under: Debian GNU/Linux buster/sid
> >
> > Matrix products: default
> > BLAS: /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.8.0
> > LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.8.0
> >
> > locale:
> > [1] LC_CTYPE=en_GB.UTF-8       LC_NUMERIC=C
> > LC_TIME=en_GB.UTF-8        LC_COLLATE=en_GB.UTF-8
> > LC_MONETARY=en_GB.UTF-8
> > [6] LC_MESSAGES=en_GB.UTF-8    LC_PAPER=en_GB.UTF-8       LC_NAME=C
> >               LC_ADDRESS=C               LC_TELEPHONE=C
> > [11] LC_MEASUREMENT=en_GB.UTF-8 LC_IDENTIFICATION=C
> >
> > attached base packages:
> > [1] stats     graphics  grDevices utils     datasets  methods   base
> >
> > other attached packages:
> > [1] raster_2.7-15 rgdal_1.3-6   sp_1.3-1
> >
> >
> > Agus
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> https://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From e@u8683 @ending from y@hoo@com  Thu Dec 20 22:56:38 2018
From: e@u8683 @ending from y@hoo@com (Esu Esu)
Date: Thu, 20 Dec 2018 21:56:38 +0000 (UTC)
Subject: [R-sig-Geo] R Help
References: <338573592.8310602.1545342998814.ref@mail.yahoo.com>
Message-ID: <338573592.8310602.1545342998814@mail.yahoo.com>

Dear All,
I am new to R-programming. I have question if anyone can help me with:Q: how can I create functions in R to compute the area (A), centroid (Cx and Cy) and perimeter (P) of a polygon list .??I want to write R functions to compute these quantities for individual polygons, as well asan overall function to take a polygon list and return a data frame with four columns and the samenumber of rows as polygons in the list.??Each quantity should?correspond to each column.?it is (sp) class object.?
Hope to find any suggestion or answer?
?RegardsMuhsien?
	[[alternative HTML version deleted]]


From hugo@gco@t@ @ending from gm@il@com  Thu Dec 20 23:08:41 2018
From: hugo@gco@t@ @ending from gm@il@com (Hugo Costa)
Date: Thu, 20 Dec 2018 22:08:41 +0000
Subject: [R-sig-Geo] R Help
In-Reply-To: <338573592.8310602.1545342998814@mail.yahoo.com>
References: <338573592.8310602.1545342998814.ref@mail.yahoo.com>
 <338573592.8310602.1545342998814@mail.yahoo.com>
Message-ID: <CADvFi5qfjfOoNZ3wrOP9P7LZBkgwJfTco37i6qCBOT9+vW0efw@mail.gmail.com>

Package rgeos is a good starting point.

Esu Esu via R-sig-Geo <r-sig-geo at r-project.org> escreveu no dia quinta,
20/12/2018 ?(s) 21:58:

> Dear All,
> I am new to R-programming. I have question if anyone can help me with:Q:
> how can I create functions in R to compute the area (A), centroid (Cx and
> Cy) and perimeter (P) of a polygon list .  I want to write R functions to
> compute these quantities for individual polygons, as well asan overall
> function to take a polygon list and return a data frame with four columns
> and the samenumber of rows as polygons in the list.  Each quantity
> should correspond to each column. it is (sp) class object.
> Hope to find any suggestion or answer
>  RegardsMuhsien
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From r@turner @ending from @uckl@nd@@c@nz  Thu Dec 20 23:47:10 2018
From: r@turner @ending from @uckl@nd@@c@nz (Rolf Turner)
Date: Fri, 21 Dec 2018 11:47:10 +1300
Subject: [R-sig-Geo] [FORGED]  R Help
In-Reply-To: <338573592.8310602.1545342998814@mail.yahoo.com>
References: <338573592.8310602.1545342998814.ref@mail.yahoo.com>
 <338573592.8310602.1545342998814@mail.yahoo.com>
Message-ID: <13ea731f-0eb8-d18a-4d36-08c903000827@auckland.ac.nz>


On 12/21/18 10:56 AM, Esu Esu via R-sig-Geo wrote:

> Dear All,
> I am new to R-programming. 

Learn to crawl before you start trying to walk or run.  Study some of 
the many R tutorials that are available.

> I have question if anyone can help me with:Q: how can I create functions in R to compute the area
> (A), centroid (Cx and Cy) and perimeter (P) of a polygon list .??I want to write R functions to
> compute these quantities for individual polygons, as well asan overall function to take a polygon
> list and return a data frame with four columns and the samenumber of rows as polygons in the list.
> Each quantity should correspond to each column. it is (sp) class object. > Hope to find any suggestion or answer

The spatstat package will enable you to do all this pretty easily.  See

     ?centroid.owin
     ?perimeter
     ?area.owin

You will need to convert your polygons to objects of class "owin".  The 
as.owin() function should handle this for you.

cheers,

Rolf Turner


-- 
Technical Editor ANZJS
Department of Statistics
University of Auckland
Phone: +64-9-373-7599 ext. 88276


From m@di@zl @ending from gm@il@com  Fri Dec 21 13:33:32 2018
From: m@di@zl @ending from gm@il@com (Andres Diaz Loaiza)
Date: Fri, 21 Dec 2018 13:33:32 +0100
Subject: [R-sig-Geo] R Help
In-Reply-To: <338573592.8310602.1545342998814@mail.yahoo.com>
References: <338573592.8310602.1545342998814.ref@mail.yahoo.com>
 <338573592.8310602.1545342998814@mail.yahoo.com>
Message-ID: <CAMXOh=37CdOMZXVs5LB0_-2yZHfAbSKCKppES3jaSZfWSeWppw@mail.gmail.com>

Dear Esu,

About your question there is huge literature already written.

I recommend to read the sp package manual.

An example for extract the coordinates you can  find it here:

https://gis.stackexchange.com/questions/43543/how-to-calculate-polygon-centroids-in-r-for-non-contiguous-shapes

If you want to see how works the function remember that r is an open source
code and you can find the original functions over the binaries repositories
or compressed packages.

All the best,

Andres


On Thu, 20 Dec 2018 at 22:58, Esu Esu via R-sig-Geo <r-sig-geo at r-project.org>
wrote:

> Dear All,
> I am new to R-programming. I have question if anyone can help me with:Q:
> how can I create functions in R to compute the area (A), centroid (Cx and
> Cy) and perimeter (P) of a polygon list .  I want to write R functions to
> compute these quantities for individual polygons, as well asan overall
> function to take a polygon list and return a data frame with four columns
> and the samenumber of rows as polygons in the list.  Each quantity
> should correspond to each column. it is (sp) class object.
> Hope to find any suggestion or answer
>  RegardsMuhsien
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
-- 
Andr?s D.

	[[alternative HTML version deleted]]


From mirz@ceng @ending from gm@il@com  Fri Dec 21 14:07:14 2018
From: mirz@ceng @ending from gm@il@com (Mirza Cengic)
Date: Fri, 21 Dec 2018 14:07:14 +0100
Subject: [R-sig-Geo] R Help
In-Reply-To: <CAMXOh=37CdOMZXVs5LB0_-2yZHfAbSKCKppES3jaSZfWSeWppw@mail.gmail.com>
References: <338573592.8310602.1545342998814.ref@mail.yahoo.com>
 <338573592.8310602.1545342998814@mail.yahoo.com>
 <CAMXOh=37CdOMZXVs5LB0_-2yZHfAbSKCKppES3jaSZfWSeWppw@mail.gmail.com>
Message-ID: <CAJAunff059DK_LnPcEZEKkBYpoQAQa2SgSMzvN1kf7ZRLuZC_w@mail.gmail.com>

Dear Esu,

you can probably solve these tasks using sf package, which uses bit
different way of representing spatial objects compared to the sp object.
Below you'll find an example for the North Carolina dataset. Keep in mind
that calculating area and perimeter depends on your coordinate system (i.e.
you can use projection that works better for calculating areas, or
distances; check the area/perimeter columns in nc dataset versus the output
of the functions below).
Package lwgeom is for the st_perimeter() function, and I converted it to
equidistant projection, since st_perimeter() doesn't like lat/long data.
Spatial objects of sp class you can convert to simple feature using
st_as_sf() function.

Hope it helps,
Mirza.

library(sf)
library(lwgeom)

nc <- st_read(system.file("shape/nc.shp", package="sf"))
nc <- st_transform(nc, crs = "+proj=eqc +lat_ts=0 +lat_0=0 +lon_0=0 +x_0=0
+y_0=0 +a=6371007 +b=6371007 +units=m +no_defs")

my_area <- st_area(nc)
my_centroid_x = st_coordinates(st_centroid(nc))[, 1]
my_centroid_y = st_coordinates(st_centroid(nc))[, 2]
my_perimeter = st_perimeter(nc)

On Fri, Dec 21, 2018 at 1:34 PM Andres Diaz Loaiza <madiazl at gmail.com>
wrote:

> Dear Esu,
>
> About your question there is huge literature already written.
>
> I recommend to read the sp package manual.
>
> An example for extract the coordinates you can  find it here:
>
>
> https://gis.stackexchange.com/questions/43543/how-to-calculate-polygon-centroids-in-r-for-non-contiguous-shapes
>
> If you want to see how works the function remember that r is an open source
> code and you can find the original functions over the binaries repositories
> or compressed packages.
>
> All the best,
>
> Andres
>
>
> On Thu, 20 Dec 2018 at 22:58, Esu Esu via R-sig-Geo <
> r-sig-geo at r-project.org>
> wrote:
>
> > Dear All,
> > I am new to R-programming. I have question if anyone can help me with:Q:
> > how can I create functions in R to compute the area (A), centroid (Cx and
> > Cy) and perimeter (P) of a polygon list .  I want to write R functions to
> > compute these quantities for individual polygons, as well asan overall
> > function to take a polygon list and return a data frame with four columns
> > and the samenumber of rows as polygons in the list.  Each quantity
> > should correspond to each column. it is (sp) class object.
> > Hope to find any suggestion or answer
> >  RegardsMuhsien
> >         [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> --
> Andr?s D.
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


-- 
*Mirza ?engi?*

*Junior Researcher | Department of Environmental Science*
Radboud University | Heyendaalseweg 135
6525 AJ Nijmegen | The Netherlands

+31 657020823 | +38761908392
Skype: mirzacengic
<https://www.linkedin.com/in/mirzacengic>

	[[alternative HTML version deleted]]


From @rrowt@do @ending from gm@il@com  Sun Dec 23 13:44:17 2018
From: @rrowt@do @ending from gm@il@com (=?utf-8?Q?Carlos_Rodr=C3=ADguez?=)
Date: Sun, 23 Dec 2018 13:44:17 +0100
Subject: [R-sig-Geo] error when trying to use RStudio within GRASS
Message-ID: <459D4C24-45DE-421A-B690-06ADB822F76B@gmail.com>

Hi guys,

I have the following error when using Rstudio within GRASS 7.2.2 (stand-alone version) in Windows 10:



Location Spearfish_60

> points <- readVECT("archsites")

Error in if (get("SYS", envir = .GRASS_CACHE) == "WinNat" && nchar(WN_bat) ==  :

  missing value where TRUE/FALSE needed


> traceback()

7: parseGRASS(cmd, legacyExec = legacyExec)

6: doGRASS(cmd, flags = flags, ..., parameters = parameters, echoCmd = echoCmd,

       legacyExec = legacyExec)

5: execGRASS("v.in.ogr", flags = ifelse(ignore.stderr, c("f", "quiet"),

       "f"), intern = TRUE, ignore.stderr = ignore.stderr)

4: .read_vect_non_plugin(vname = vname, layer = layer, type = type,

       remove.duplicates = remove.duplicates, ignore.stderr = ignore.stderr,

       pointDropZ = pointDropZ, driver = driver, with_prj = with_prj,

       with_c = with_c)

3: tryCatchList(expr, classes, parentenv, handlers)

2: tryCatch({

       stopifnot(is.logical(plugin) || is.null(plugin))

       stopifnot(is.logical(ignore.stderr))

       if (missing(layer))

           layer <- "1"

       layer <- as.character(layer)

       stopifnot(is.logical(with_c))

       if (!is.null(driver) && driver == "GRASS")

           plugin <- TRUE

       if (!requireNamespace("rgdal", quietly = TRUE)) {

           stop("rgdal not available")

       }

       if (is.null(plugin)) {

           ogrD <- rgdal::ogrDrivers()$name

           plugin <- "GRASS" %in% ogrD

       }

       if (plugin) {

           res <- .read_vect_plugin(vname = vname, layer = layer,

               type = type, ignore.stderr = ignore.stderr, pointDropZ = pointDropZ,

               mapset = mapset)

       }

       else {

           res <- .read_vect_non_plugin(vname = vname, layer = layer,

               type = type, remove.duplicates = remove.duplicates,

               ignore.stderr = ignore.stderr, pointDropZ = pointDropZ,

               driver = driver, with_prj = with_prj, with_c = with_c)

       }

   }, finally = {

       if (get.suppressEchoCmdInFuncOption()) {

           tull <- set.echoCmdOption(inEchoCmd)

       }

   })

1: readVECT("archsites")

 

 

This error does not show when using R instead of RStudio. I?ve searched around and tried to implement the fixes proposed for similar issues (unsuccessfully).  I feel that it might be a very simple issue, but I am stuck and I will appreciate any help. Here the Sys.getenv() and sessionInfo(), in case there are needed.




> Sys.getenv()

__COMPAT_LAYER              RunAsAdmin DetectorsWin7

ADSK_CLM_WPAD_PROXY_CHECK   FALSE

ALLUSERSPROFILE             C:\ProgramData

APPDATA                     C:\Users\...\AppData\Roaming

CLICOLOR_FORCE              1

CommonProgramFiles          C:\Program Files\Common Files

CommonProgramFiles(x86)     C:\Program Files (x86)\Common Files

CommonProgramW6432          C:\Program Files\Common Files

COMPUTERNAME               

ComSpec                     C:\WINDOWS\system32\cmd.exe

DISPLAY                     :0

DriverData                  C:\Windows\System32\Drivers\DriverData

FP_NO_HOST_CHECK            NO

GDAL_DATA                   C:/Program Files/R/R-3.5.1/library/rgdal/gdal

GEODA_GDAL_DATA             C:\Program Files\GeoDa Software\data

GEODA_OGR_DRIVER_PATH       C:\Program Files\GeoDa Software

GFORTRAN_STDERR_UNIT        -1

GFORTRAN_STDOUT_UNIT        -1

GRASS_MESSAGE_FORMAT        text

GRASS_PAGER                 cat

HOME                        C:/Users/?/Documents

HOMEDRIVE                   C:

HOMEPATH                    \Users\...

JRI_HOME                    C:\Users\...\Documents\R\win-library\3.4\rJava\jri

LOCALAPPDATA                C:\Users\...\AppData\Local

LOGONSERVER                 \\...

MSYS2_ENV_CONV_EXCL         R_ARCH

NUMBER_OF_PROCESSORS        8

OneDrive                    C:\Users\...\OneDrive

OS                          Windows_NT

PATH                        C:\Program

                            Files\R\R-3.5.1\bin\x64;C:\Rtools\bin;C:\ProgramData\Oracle\Java\javapath;c:\Rtools\gcc-4.6.3\bin;C:\Program

                            Files (x86)\Intel\iCLS Client\;C:\Program

                            Files\Intel\iCLS

                            Client\;C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbem;C:\WINDOWS\System32\WindowsPowerShell\v1.0\;C:\Program

                            Files\Intel\Intel(R) Management Engine

                            Components\DAL;C:\Program Files\Intel\Intel(R)

                            Management Engine Components\IPT;C:\Program Files

                            (x86)\Intel\Intel(R) Management Engine

                            Components\DAL;C:\Program Files (x86)\Intel\Intel(R)

                            Management Engine Components\IPT;C:\Program Files

                            (x86)\ATI Technologies\ATI.ACE\Core-Static;C:\Program

                            Files\MiKTeX 2.9\miktex\bin\x64\;C:\Program

                            Files\Git\cmd;C:\Program Files

                            (x86)\Skype\Phone\;C:\Program

                            Files\R\R-3.5.1\bin\x64;C:\Program

                            Files\RStudio\bin;C:\WINDOWS\System32\OpenSSH\;C:\Program

                            Files (x86)\Calibre2\;C:\Program

                            Files\Intel\WiFi\bin\;C:\Program Files\Common

                            Files\Intel\WirelessCommon\;C:\Users\... \AppData\Local\Microsoft\WindowsApps

PATHEXT                     .COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC

PROCESSOR_ARCHITECTURE      AMD64

PROCESSOR_IDENTIFIER        Intel64 Family 6 Model 60 Stepping 3, GenuineIntel

PROCESSOR_LEVEL             6

PROCESSOR_REVISION          3c03

ProgramData                 C:\ProgramData

ProgramFiles                C:\Program Files

ProgramFiles(x86)           C:\Program Files (x86)

ProgramW6432                C:\Program Files

PROJ_LIB                    C:/Program Files/R/R-3.5.1/library/rgdal/proj

PSModulePath                C:\WINDOWS\system32\WindowsPowerShell\v1.0\Modules\

PUBLIC                      C:\Users\Public

R_ARCH                      /x64

R_COMPILED_BY               gcc 4.9.3

R_DOC_DIR                   C:/PROGRA~1/R/R-35~1.1/doc

R_HOME                      C:/PROGRA~1/R/R-35~1.1

R_LIBS_USER                 C:\Program Files\R\R-3.5.1\library

R_MAP_DATA_DIR              C:/Program Files/R/R-3.5.1/library/maps/mapdata/

R_MAP_DATA_DIR_WORLD        C:/Program Files/R/R-3.5.1/library/maps/mapdata/

R_USER                      C:/Users/?/Documents

RCRAN                       C:\Program Files\R\R-3.5.1\bin\x64

RMARKDOWN_MATHJAX_PATH      C:/Program Files/RStudio/resources/mathjax-26

RS_LOCAL_PEER               \\.\pipe\30976-rsession

RS_RPOSTBACK_PATH           C:/Program Files/RStudio/bin/rpostback

RS_SHARED_SECRET            63341846741

RSTUDIO                     1

RSTUDIO_CONSOLE_COLOR       256

RSTUDIO_CONSOLE_WIDTH       80

RSTUDIO_MSYS_SSH            C:/Program Files/RStudio/bin/msys-ssh-1000-18

RSTUDIO_PANDOC              C:/Program Files/RStudio/bin/pandoc

RSTUDIO_SESSION_PORT        30976

RSTUDIO_USER_IDENTITY       ?

RSTUDIO_WINUTILS            C:/Program Files/RStudio/bin/winutils

SystemDrive                 C:

SystemRoot                  C:\WINDOWS

TEMP                        C:\Users\...\AppData\Local\Temp

TERM                        xterm-256color

TMP                         C:\Users\...\AppData\Local\Temp

USERDOMAIN                  ?

USERDOMAIN_ROAMINGPROFILE   ?

USERNAME                    ?

USERPROFILE                 C:\Users\...

windir                      C:\WINDOWS

 

 

> sessionInfo()

R version 3.5.1 (2018-07-02)

Platform: x86_64-w64-mingw32/x64 (64-bit)

Running under: Windows >= 8 x64 (build 9200)

 

Matrix products: default

 

locale:

[1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United States.1252  

[3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C                         

[5] LC_TIME=English_United States.1252   

 

attached base packages:

[1] stats     graphics  grDevices utils     datasets  methods   base    

 

other attached packages:

 [1] dbscan_1.1-2        rgdal_1.3-4         geostatsp_1.7.2     Matrix_1.2-14     

 [5] raster_2.6-7        maptools_0.9-3      maps_3.3.0          spatstat_1.56-1   

 [9] rpart_4.1-13        nlme_3.1-137        spatstat.data_1.3-1 rgrass7_0.1-10    

[13] XML_3.98-1.16       sp_1.3-1          

 

 

 

Thanks in advance,

 

William 
	[[alternative HTML version deleted]]


From @@r@h@go@lee @ending from gm@il@com  Sun Dec 23 14:06:22 2018
From: @@r@h@go@lee @ending from gm@il@com (Sarah Goslee)
Date: Sun, 23 Dec 2018 08:06:22 -0500
Subject: [R-sig-Geo] error when trying to use RStudio within GRASS
In-Reply-To: <459D4C24-45DE-421A-B690-06ADB822F76B@gmail.com>
References: <459D4C24-45DE-421A-B690-06ADB822F76B@gmail.com>
Message-ID: <CAM_vju=SgRzmnaApV3H+YNc5-xriaMuTzo50bYtd93hpfGRi-w@mail.gmail.com>

Hi Carlos,

"This error does not show when using R instead of RStudio."

Then you probably need to use RStudio help channels. You *might* get lucky
here, but this is an R help list, not RStudio help.

Sarah

On Sun, Dec 23, 2018 at 7:44 AM Carlos Rodr?guez <arrowtado at gmail.com>
wrote:

> Hi guys,
>
> I have the following error when using Rstudio within GRASS 7.2.2
> (stand-alone version) in Windows 10:
>
>
>
> Location Spearfish_60
>
> > points <- readVECT("archsites")
>
> Error in if (get("SYS", envir = .GRASS_CACHE) == "WinNat" && nchar(WN_bat)
> ==  :
>
>   missing value where TRUE/FALSE needed
>
>
> > traceback()
>
> 7: parseGRASS(cmd, legacyExec = legacyExec)
>
> 6: doGRASS(cmd, flags = flags, ..., parameters = parameters, echoCmd =
> echoCmd,
>
>        legacyExec = legacyExec)
>
> 5: execGRASS("v.in.ogr", flags = ifelse(ignore.stderr, c("f", "quiet"),
>
>        "f"), intern = TRUE, ignore.stderr = ignore.stderr)
>
> 4: .read_vect_non_plugin(vname = vname, layer = layer, type = type,
>
>        remove.duplicates = remove.duplicates, ignore.stderr =
> ignore.stderr,
>
>        pointDropZ = pointDropZ, driver = driver, with_prj = with_prj,
>
>        with_c = with_c)
>
> 3: tryCatchList(expr, classes, parentenv, handlers)
>
> 2: tryCatch({
>
>        stopifnot(is.logical(plugin) || is.null(plugin))
>
>        stopifnot(is.logical(ignore.stderr))
>
>        if (missing(layer))
>
>            layer <- "1"
>
>        layer <- as.character(layer)
>
>        stopifnot(is.logical(with_c))
>
>        if (!is.null(driver) && driver == "GRASS")
>
>            plugin <- TRUE
>
>        if (!requireNamespace("rgdal", quietly = TRUE)) {
>
>            stop("rgdal not available")
>
>        }
>
>        if (is.null(plugin)) {
>
>            ogrD <- rgdal::ogrDrivers()$name
>
>            plugin <- "GRASS" %in% ogrD
>
>        }
>
>        if (plugin) {
>
>            res <- .read_vect_plugin(vname = vname, layer = layer,
>
>                type = type, ignore.stderr = ignore.stderr, pointDropZ =
> pointDropZ,
>
>                mapset = mapset)
>
>        }
>
>        else {
>
>            res <- .read_vect_non_plugin(vname = vname, layer = layer,
>
>                type = type, remove.duplicates = remove.duplicates,
>
>                ignore.stderr = ignore.stderr, pointDropZ = pointDropZ,
>
>                driver = driver, with_prj = with_prj, with_c = with_c)
>
>        }
>
>    }, finally = {
>
>        if (get.suppressEchoCmdInFuncOption()) {
>
>            tull <- set.echoCmdOption(inEchoCmd)
>
>        }
>
>    })
>
> 1: readVECT("archsites")
>
>
>
>
>
> This error does not show when using R instead of RStudio. I?ve searched
> around and tried to implement the fixes proposed for similar issues
> (unsuccessfully).  I feel that it might be a very simple issue, but I am
> stuck and I will appreciate any help. Here the Sys.getenv() and
> sessionInfo(), in case there are needed.
>
>
>
>
> > Sys.getenv()
>
> __COMPAT_LAYER              RunAsAdmin DetectorsWin7
>
> ADSK_CLM_WPAD_PROXY_CHECK   FALSE
>
> ALLUSERSPROFILE             C:\ProgramData
>
> APPDATA                     C:\Users\...\AppData\Roaming
>
> CLICOLOR_FORCE              1
>
> CommonProgramFiles          C:\Program Files\Common Files
>
> CommonProgramFiles(x86)     C:\Program Files (x86)\Common Files
>
> CommonProgramW6432          C:\Program Files\Common Files
>
> COMPUTERNAME
>
> ComSpec                     C:\WINDOWS\system32\cmd.exe
>
> DISPLAY                     :0
>
> DriverData                  C:\Windows\System32\Drivers\DriverData
>
> FP_NO_HOST_CHECK            NO
>
> GDAL_DATA                   C:/Program Files/R/R-3.5.1/library/rgdal/gdal
>
> GEODA_GDAL_DATA             C:\Program Files\GeoDa Software\data
>
> GEODA_OGR_DRIVER_PATH       C:\Program Files\GeoDa Software
>
> GFORTRAN_STDERR_UNIT        -1
>
> GFORTRAN_STDOUT_UNIT        -1
>
> GRASS_MESSAGE_FORMAT        text
>
> GRASS_PAGER                 cat
>
> HOME                        C:/Users/?/Documents
>
> HOMEDRIVE                   C:
>
> HOMEPATH                    \Users\...
>
> JRI_HOME
> C:\Users\...\Documents\R\win-library\3.4\rJava\jri
>
> LOCALAPPDATA                C:\Users\...\AppData\Local
>
> LOGONSERVER                 \\...
>
> MSYS2_ENV_CONV_EXCL         R_ARCH
>
> NUMBER_OF_PROCESSORS        8
>
> OneDrive                    C:\Users\...\OneDrive
>
> OS                          Windows_NT
>
> PATH                        C:\Program
>
>
> Files\R\R-3.5.1\bin\x64;C:\Rtools\bin;C:\ProgramData\Oracle\Java\javapath;c:\Rtools\gcc-4.6.3\bin;C:\Program
>
>                             Files (x86)\Intel\iCLS Client\;C:\Program
>
>                             Files\Intel\iCLS
>
>
> Client\;C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbem;C:\WINDOWS\System32\WindowsPowerShell\v1.0\;C:\Program
>
>                             Files\Intel\Intel(R) Management Engine
>
>                             Components\DAL;C:\Program Files\Intel\Intel(R)
>
>                             Management Engine Components\IPT;C:\Program
> Files
>
>                             (x86)\Intel\Intel(R) Management Engine
>
>                             Components\DAL;C:\Program Files
> (x86)\Intel\Intel(R)
>
>                             Management Engine Components\IPT;C:\Program
> Files
>
>                             (x86)\ATI
> Technologies\ATI.ACE\Core-Static;C:\Program
>
>                             Files\MiKTeX 2.9\miktex\bin\x64\;C:\Program
>
>                             Files\Git\cmd;C:\Program Files
>
>                             (x86)\Skype\Phone\;C:\Program
>
>                             Files\R\R-3.5.1\bin\x64;C:\Program
>
>
> Files\RStudio\bin;C:\WINDOWS\System32\OpenSSH\;C:\Program
>
>                             Files (x86)\Calibre2\;C:\Program
>
>                             Files\Intel\WiFi\bin\;C:\Program Files\Common
>
>                             Files\Intel\WirelessCommon\;C:\Users\...
> \AppData\Local\Microsoft\WindowsApps
>
> PATHEXT
>  .COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC
>
> PROCESSOR_ARCHITECTURE      AMD64
>
> PROCESSOR_IDENTIFIER        Intel64 Family 6 Model 60 Stepping 3,
> GenuineIntel
>
> PROCESSOR_LEVEL             6
>
> PROCESSOR_REVISION          3c03
>
> ProgramData                 C:\ProgramData
>
> ProgramFiles                C:\Program Files
>
> ProgramFiles(x86)           C:\Program Files (x86)
>
> ProgramW6432                C:\Program Files
>
> PROJ_LIB                    C:/Program Files/R/R-3.5.1/library/rgdal/proj
>
> PSModulePath
> C:\WINDOWS\system32\WindowsPowerShell\v1.0\Modules\
>
> PUBLIC                      C:\Users\Public
>
> R_ARCH                      /x64
>
> R_COMPILED_BY               gcc 4.9.3
>
> R_DOC_DIR                   C:/PROGRA~1/R/R-35~1.1/doc
>
> R_HOME                      C:/PROGRA~1/R/R-35~1.1
>
> R_LIBS_USER                 C:\Program Files\R\R-3.5.1\library
>
> R_MAP_DATA_DIR              C:/Program
> Files/R/R-3.5.1/library/maps/mapdata/
>
> R_MAP_DATA_DIR_WORLD        C:/Program
> Files/R/R-3.5.1/library/maps/mapdata/
>
> R_USER                      C:/Users/?/Documents
>
> RCRAN                       C:\Program Files\R\R-3.5.1\bin\x64
>
> RMARKDOWN_MATHJAX_PATH      C:/Program Files/RStudio/resources/mathjax-26
>
> RS_LOCAL_PEER               \\.\pipe\30976-rsession
>
> RS_RPOSTBACK_PATH           C:/Program Files/RStudio/bin/rpostback
>
> RS_SHARED_SECRET            63341846741
>
> RSTUDIO                     1
>
> RSTUDIO_CONSOLE_COLOR       256
>
> RSTUDIO_CONSOLE_WIDTH       80
>
> RSTUDIO_MSYS_SSH            C:/Program Files/RStudio/bin/msys-ssh-1000-18
>
> RSTUDIO_PANDOC              C:/Program Files/RStudio/bin/pandoc
>
> RSTUDIO_SESSION_PORT        30976
>
> RSTUDIO_USER_IDENTITY       ?
>
> RSTUDIO_WINUTILS            C:/Program Files/RStudio/bin/winutils
>
> SystemDrive                 C:
>
> SystemRoot                  C:\WINDOWS
>
> TEMP                        C:\Users\...\AppData\Local\Temp
>
> TERM                        xterm-256color
>
> TMP                         C:\Users\...\AppData\Local\Temp
>
> USERDOMAIN                  ?
>
> USERDOMAIN_ROAMINGPROFILE   ?
>
> USERNAME                    ?
>
> USERPROFILE                 C:\Users\...
>
> windir                      C:\WINDOWS
>
>
>
>
>
> > sessionInfo()
>
> R version 3.5.1 (2018-07-02)
>
> Platform: x86_64-w64-mingw32/x64 (64-bit)
>
> Running under: Windows >= 8 x64 (build 9200)
>
>
>
> Matrix products: default
>
>
>
> locale:
>
> [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United
> States.1252
>
> [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
>
>
> [5] LC_TIME=English_United States.1252
>
>
>
> attached base packages:
>
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
>
>
> other attached packages:
>
>  [1] dbscan_1.1-2        rgdal_1.3-4         geostatsp_1.7.2
>  Matrix_1.2-14
>
>  [5] raster_2.6-7        maptools_0.9-3      maps_3.3.0
> spatstat_1.56-1
>
>  [9] rpart_4.1-13        nlme_3.1-137        spatstat.data_1.3-1
> rgrass7_0.1-10
>
> [13] XML_3.98-1.16       sp_1.3-1
>
>
>
>
>
>
>
> Thanks in advance,
>
>
>
> William
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
-- 
Sarah Goslee (she/her)
http://www.sarahgoslee.com

	[[alternative HTML version deleted]]


From Roger@Biv@nd @ending from nhh@no  Sun Dec 23 19:42:48 2018
From: Roger@Biv@nd @ending from nhh@no (Roger Bivand)
Date: Sun, 23 Dec 2018 19:42:48 +0100
Subject: [R-sig-Geo] error when trying to use RStudio within GRASS
In-Reply-To: <CAM_vju=SgRzmnaApV3H+YNc5-xriaMuTzo50bYtd93hpfGRi-w@mail.gmail.com>
References: <459D4C24-45DE-421A-B690-06ADB822F76B@gmail.com>
 <CAM_vju=SgRzmnaApV3H+YNc5-xriaMuTzo50bYtd93hpfGRi-w@mail.gmail.com>
Message-ID: <alpine.LFD.2.21.1812231938470.27040@reclus.nhh.no>

On Sun, 23 Dec 2018, Sarah Goslee wrote:

> Hi Carlos,
>
> "This error does not show when using R instead of RStudio."
>
> Then you probably need to use RStudio help channels. You *might* get lucky
> here, but this is an R help list, not RStudio help.

Maybe also try https://lists.osgeo.org/mailman/listinfo/grass-stats, which 
has a recent thread on this topic. I just tried Win10/GRASS 7.4/RStudio, 
and had no trouble either running rgrass7::initGRASS() in RStudio started 
on its own, or running rgrass::parseGRASS() in rstudio started in RStudio 
started from the console command line inside GRASS. Consider following up 
the thread on that list.

Roger

>
> Sarah
>
> On Sun, Dec 23, 2018 at 7:44 AM Carlos Rodr?guez <arrowtado at gmail.com>
> wrote:
>
>> Hi guys,
>>
>> I have the following error when using Rstudio within GRASS 7.2.2
>> (stand-alone version) in Windows 10:
>>
>>
>>
>> Location Spearfish_60
>>
>>> points <- readVECT("archsites")
>>
>> Error in if (get("SYS", envir = .GRASS_CACHE) == "WinNat" && nchar(WN_bat)
>> ==  :
>>
>>   missing value where TRUE/FALSE needed
>>
>>
>>> traceback()
>>
>> 7: parseGRASS(cmd, legacyExec = legacyExec)
>>
>> 6: doGRASS(cmd, flags = flags, ..., parameters = parameters, echoCmd =
>> echoCmd,
>>
>>        legacyExec = legacyExec)
>>
>> 5: execGRASS("v.in.ogr", flags = ifelse(ignore.stderr, c("f", "quiet"),
>>
>>        "f"), intern = TRUE, ignore.stderr = ignore.stderr)
>>
>> 4: .read_vect_non_plugin(vname = vname, layer = layer, type = type,
>>
>>        remove.duplicates = remove.duplicates, ignore.stderr =
>> ignore.stderr,
>>
>>        pointDropZ = pointDropZ, driver = driver, with_prj = with_prj,
>>
>>        with_c = with_c)
>>
>> 3: tryCatchList(expr, classes, parentenv, handlers)
>>
>> 2: tryCatch({
>>
>>        stopifnot(is.logical(plugin) || is.null(plugin))
>>
>>        stopifnot(is.logical(ignore.stderr))
>>
>>        if (missing(layer))
>>
>>            layer <- "1"
>>
>>        layer <- as.character(layer)
>>
>>        stopifnot(is.logical(with_c))
>>
>>        if (!is.null(driver) && driver == "GRASS")
>>
>>            plugin <- TRUE
>>
>>        if (!requireNamespace("rgdal", quietly = TRUE)) {
>>
>>            stop("rgdal not available")
>>
>>        }
>>
>>        if (is.null(plugin)) {
>>
>>            ogrD <- rgdal::ogrDrivers()$name
>>
>>            plugin <- "GRASS" %in% ogrD
>>
>>        }
>>
>>        if (plugin) {
>>
>>            res <- .read_vect_plugin(vname = vname, layer = layer,
>>
>>                type = type, ignore.stderr = ignore.stderr, pointDropZ =
>> pointDropZ,
>>
>>                mapset = mapset)
>>
>>        }
>>
>>        else {
>>
>>            res <- .read_vect_non_plugin(vname = vname, layer = layer,
>>
>>                type = type, remove.duplicates = remove.duplicates,
>>
>>                ignore.stderr = ignore.stderr, pointDropZ = pointDropZ,
>>
>>                driver = driver, with_prj = with_prj, with_c = with_c)
>>
>>        }
>>
>>    }, finally = {
>>
>>        if (get.suppressEchoCmdInFuncOption()) {
>>
>>            tull <- set.echoCmdOption(inEchoCmd)
>>
>>        }
>>
>>    })
>>
>> 1: readVECT("archsites")
>>
>>
>>
>>
>>
>> This error does not show when using R instead of RStudio. I?ve searched
>> around and tried to implement the fixes proposed for similar issues
>> (unsuccessfully).  I feel that it might be a very simple issue, but I am
>> stuck and I will appreciate any help. Here the Sys.getenv() and
>> sessionInfo(), in case there are needed.
>>
>>
>>
>>
>>> Sys.getenv()
>>
>> __COMPAT_LAYER              RunAsAdmin DetectorsWin7
>>
>> ADSK_CLM_WPAD_PROXY_CHECK   FALSE
>>
>> ALLUSERSPROFILE             C:\ProgramData
>>
>> APPDATA                     C:\Users\...\AppData\Roaming
>>
>> CLICOLOR_FORCE              1
>>
>> CommonProgramFiles          C:\Program Files\Common Files
>>
>> CommonProgramFiles(x86)     C:\Program Files (x86)\Common Files
>>
>> CommonProgramW6432          C:\Program Files\Common Files
>>
>> COMPUTERNAME
>>
>> ComSpec                     C:\WINDOWS\system32\cmd.exe
>>
>> DISPLAY                     :0
>>
>> DriverData                  C:\Windows\System32\Drivers\DriverData
>>
>> FP_NO_HOST_CHECK            NO
>>
>> GDAL_DATA                   C:/Program Files/R/R-3.5.1/library/rgdal/gdal
>>
>> GEODA_GDAL_DATA             C:\Program Files\GeoDa Software\data
>>
>> GEODA_OGR_DRIVER_PATH       C:\Program Files\GeoDa Software
>>
>> GFORTRAN_STDERR_UNIT        -1
>>
>> GFORTRAN_STDOUT_UNIT        -1
>>
>> GRASS_MESSAGE_FORMAT        text
>>
>> GRASS_PAGER                 cat
>>
>> HOME                        C:/Users/?/Documents
>>
>> HOMEDRIVE                   C:
>>
>> HOMEPATH                    \Users\...
>>
>> JRI_HOME
>> C:\Users\...\Documents\R\win-library\3.4\rJava\jri
>>
>> LOCALAPPDATA                C:\Users\...\AppData\Local
>>
>> LOGONSERVER                 \\...
>>
>> MSYS2_ENV_CONV_EXCL         R_ARCH
>>
>> NUMBER_OF_PROCESSORS        8
>>
>> OneDrive                    C:\Users\...\OneDrive
>>
>> OS                          Windows_NT
>>
>> PATH                        C:\Program
>>
>>
>> Files\R\R-3.5.1\bin\x64;C:\Rtools\bin;C:\ProgramData\Oracle\Java\javapath;c:\Rtools\gcc-4.6.3\bin;C:\Program
>>
>>                             Files (x86)\Intel\iCLS Client\;C:\Program
>>
>>                             Files\Intel\iCLS
>>
>>
>> Client\;C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbem;C:\WINDOWS\System32\WindowsPowerShell\v1.0\;C:\Program
>>
>>                             Files\Intel\Intel(R) Management Engine
>>
>>                             Components\DAL;C:\Program Files\Intel\Intel(R)
>>
>>                             Management Engine Components\IPT;C:\Program
>> Files
>>
>>                             (x86)\Intel\Intel(R) Management Engine
>>
>>                             Components\DAL;C:\Program Files
>> (x86)\Intel\Intel(R)
>>
>>                             Management Engine Components\IPT;C:\Program
>> Files
>>
>>                             (x86)\ATI
>> Technologies\ATI.ACE\Core-Static;C:\Program
>>
>>                             Files\MiKTeX 2.9\miktex\bin\x64\;C:\Program
>>
>>                             Files\Git\cmd;C:\Program Files
>>
>>                             (x86)\Skype\Phone\;C:\Program
>>
>>                             Files\R\R-3.5.1\bin\x64;C:\Program
>>
>>
>> Files\RStudio\bin;C:\WINDOWS\System32\OpenSSH\;C:\Program
>>
>>                             Files (x86)\Calibre2\;C:\Program
>>
>>                             Files\Intel\WiFi\bin\;C:\Program Files\Common
>>
>>                             Files\Intel\WirelessCommon\;C:\Users\...
>> \AppData\Local\Microsoft\WindowsApps
>>
>> PATHEXT
>>  .COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC
>>
>> PROCESSOR_ARCHITECTURE      AMD64
>>
>> PROCESSOR_IDENTIFIER        Intel64 Family 6 Model 60 Stepping 3,
>> GenuineIntel
>>
>> PROCESSOR_LEVEL             6
>>
>> PROCESSOR_REVISION          3c03
>>
>> ProgramData                 C:\ProgramData
>>
>> ProgramFiles                C:\Program Files
>>
>> ProgramFiles(x86)           C:\Program Files (x86)
>>
>> ProgramW6432                C:\Program Files
>>
>> PROJ_LIB                    C:/Program Files/R/R-3.5.1/library/rgdal/proj
>>
>> PSModulePath
>> C:\WINDOWS\system32\WindowsPowerShell\v1.0\Modules\
>>
>> PUBLIC                      C:\Users\Public
>>
>> R_ARCH                      /x64
>>
>> R_COMPILED_BY               gcc 4.9.3
>>
>> R_DOC_DIR                   C:/PROGRA~1/R/R-35~1.1/doc
>>
>> R_HOME                      C:/PROGRA~1/R/R-35~1.1
>>
>> R_LIBS_USER                 C:\Program Files\R\R-3.5.1\library
>>
>> R_MAP_DATA_DIR              C:/Program
>> Files/R/R-3.5.1/library/maps/mapdata/
>>
>> R_MAP_DATA_DIR_WORLD        C:/Program
>> Files/R/R-3.5.1/library/maps/mapdata/
>>
>> R_USER                      C:/Users/?/Documents
>>
>> RCRAN                       C:\Program Files\R\R-3.5.1\bin\x64
>>
>> RMARKDOWN_MATHJAX_PATH      C:/Program Files/RStudio/resources/mathjax-26
>>
>> RS_LOCAL_PEER               \\.\pipe\30976-rsession
>>
>> RS_RPOSTBACK_PATH           C:/Program Files/RStudio/bin/rpostback
>>
>> RS_SHARED_SECRET            63341846741
>>
>> RSTUDIO                     1
>>
>> RSTUDIO_CONSOLE_COLOR       256
>>
>> RSTUDIO_CONSOLE_WIDTH       80
>>
>> RSTUDIO_MSYS_SSH            C:/Program Files/RStudio/bin/msys-ssh-1000-18
>>
>> RSTUDIO_PANDOC              C:/Program Files/RStudio/bin/pandoc
>>
>> RSTUDIO_SESSION_PORT        30976
>>
>> RSTUDIO_USER_IDENTITY       ?
>>
>> RSTUDIO_WINUTILS            C:/Program Files/RStudio/bin/winutils
>>
>> SystemDrive                 C:
>>
>> SystemRoot                  C:\WINDOWS
>>
>> TEMP                        C:\Users\...\AppData\Local\Temp
>>
>> TERM                        xterm-256color
>>
>> TMP                         C:\Users\...\AppData\Local\Temp
>>
>> USERDOMAIN                  ?
>>
>> USERDOMAIN_ROAMINGPROFILE   ?
>>
>> USERNAME                    ?
>>
>> USERPROFILE                 C:\Users\...
>>
>> windir                      C:\WINDOWS
>>
>>
>>
>>
>>
>>> sessionInfo()
>>
>> R version 3.5.1 (2018-07-02)
>>
>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>>
>> Running under: Windows >= 8 x64 (build 9200)
>>
>>
>>
>> Matrix products: default
>>
>>
>>
>> locale:
>>
>> [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United
>> States.1252
>>
>> [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
>>
>>
>> [5] LC_TIME=English_United States.1252
>>
>>
>>
>> attached base packages:
>>
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>>
>>
>> other attached packages:
>>
>>  [1] dbscan_1.1-2        rgdal_1.3-4         geostatsp_1.7.2
>>  Matrix_1.2-14
>>
>>  [5] raster_2.6-7        maptools_0.9-3      maps_3.3.0
>> spatstat_1.56-1
>>
>>  [9] rpart_4.1-13        nlme_3.1-137        spatstat.data_1.3-1
>> rgrass7_0.1-10
>>
>> [13] XML_3.98-1.16       sp_1.3-1
>>
>>
>>
>>
>>
>>
>>
>> Thanks in advance,
>>
>>
>>
>> William
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From @olinto@l@t @ending from gm@il@com  Wed Dec 26 21:42:19 2018
From: @olinto@l@t @ending from gm@il@com (Antonio Silva)
Date: Wed, 26 Dec 2018 18:42:19 -0200
Subject: [R-sig-Geo] get data from nc file
Message-ID: <CAE8g1gPz2x21yDAW7i3kOVBESwRx0ppgM11ycHRTSti0rGMQ1w@mail.gmail.com>

Dear list members

I downloaded some nc files with precipitation data from
https://pmm.nasa.gov/data-access/downloads/trmm (Level 3 3B43:
Multisatellite Precipitation). For the image link see the global attribute
"history" (below).

With ncdf4::nc_open I cloud open the file (nc.data <- nc_open("
3B43.20080101.7A.HDF.nc")

I want to extract the "StartGranuleDateTime" but it is inside the global
attribute FileHeader (see below).

With ncatt_get(nc.data,0,"FileHeader")$value I got
[1]
"AlgorithmID=3B43;\nAlgorithmVersion=3B43_7.0;\nFileName=3B43.20080101.7A.HDF;\nGenerationDateTime=2012-11-29T19:12:01.000Z;\nStartGranuleDateTime=2008-01-01T00:00:00.000Z;\nStopGranuleDateTime=2008-01-31T23:59:59.999Z;\nGranuleNumber=;\nNumberOfSwaths=0;\nNumberOfGrids=1;\nGranuleStart=;\nTimeInterval=MONTH;\nProcessingSystem=PPS;\nProductVersion=7A;\nMissingData=;\n"

Is there any way to extract only the string "2008-01-01T00:00:00.000Z"?

The best I could do was
as.Date(substr(strsplit(ncatt_get(nc.data,0,"FileHeader")$value,";\n")[[1]][5],22,45),"%Y-%m-%dT%H:%M:%OSZ")

but probably, I suppose, there must be a more direct way of getting the
data. I appreciate any suggestions.

Best regards,

Antonio Olinto
Fisheries Institute
Brazil

nc.data
File 3B43.20080101.7A.HDF.nc (NC_FORMAT_CLASSIC):

     1 variables (excluding dimension variables):
        float precipitation[nlat,nlon]
            units: mm/hr
            coordinates: nlon nlat
            _FillValue: -9999.900390625

     2 dimensions:
        nlon  Size:33
            long_name: longitude
            standard_name: longitude
            units: degrees_east
        nlat  Size:41
            long_name: latitude
            standard_name: latitude
            units: degrees_north

    5 global attributes:
        Grid.GridHeader: BinMethod=ARITHMETIC_MEAN;
Registration=CENTER;
LatitudeResolution=0.25;
LongitudeResolution=0.25;
NorthBoundingCoordinate=50;
SouthBoundingCoordinate=-50;
EastBoundingCoordinate=180;
WestBoundingCoordinate=-180;
Origin=SOUTHWEST;

        FileHeader: AlgorithmID=3B43;
AlgorithmVersion=3B43_7.0;
FileName=3B43.20080101.7A.HDF;
GenerationDateTime=2012-11-29T19:12:01.000Z;
StartGranuleDateTime=2008-01-01T00:00:00.000Z;
StopGranuleDateTime=2008-01-31T23:59:59.999Z;
GranuleNumber=;
NumberOfSwaths=0;
NumberOfGrids=1;
GranuleStart=;
TimeInterval=MONTH;
ProcessingSystem=PPS;
ProductVersion=7A;
MissingData=;

        FileInfo: DataFormatVersion=m;
TKCodeBuildVersion=1;
MetadataVersion=m;
FormatPackage=HDF Version 4.2 Release 4, January 25, 2009;
BlueprintFilename=TRMM.V7.3B43.blueprint.xml;
BlueprintVersion=BV_13;
TKIOVersion=1.6;
MetadataStyle=PVL;
EndianType=LITTLE_ENDIAN;

        GridHeader: BinMethod=ARITHMETIC_MEAN;
Registration=CENTER;
LatitudeResolution=0.25;
LongitudeResolution=0.25;
NorthBoundingCoordinate=50;
SouthBoundingCoordinate=-50;
EastBoundingCoordinate=180;
WestBoundingCoordinate=-180;
Origin=SOUTHWEST;

        history: 2018-12-26 17:57:56 GMT Hyrax-1.13.4
https://disc2.gesdisc.eosdis.nasa.gov:443/opendap/TRMM_L3/TRMM_3B43.7/2008/3B43.20080101.7A.HDF.nc?precipitation[604:636][3:43],nlat[3:43],nlon[604:636]

	[[alternative HTML version deleted]]


From btupper @ending from bigelow@org  Thu Dec 27 01:01:29 2018
From: btupper @ending from bigelow@org (Ben Tupper)
Date: Wed, 26 Dec 2018 19:01:29 -0500
Subject: [R-sig-Geo] get data from nc file
In-Reply-To: <CAE8g1gPz2x21yDAW7i3kOVBESwRx0ppgM11ycHRTSti0rGMQ1w@mail.gmail.com>
References: <CAE8g1gPz2x21yDAW7i3kOVBESwRx0ppgM11ycHRTSti0rGMQ1w@mail.gmail.com>
Message-ID: <6BB9421A-0E8E-4928-B299-3C8D5097D61E@bigelow.org>

Hi,

Yikes.  I don't think there is any other way as the attributes are sort of buried in the string; that's unfortunate.  I guess you could at least make a reusable function assuming you'll be doing this again or looking to pull other attributes.  Something like this...


#' Extract one of the GLobal Attributes of a TRMM NetCDF as a named vector 
#'
#' @param nc the ncdf4 object
#' @param name the name of the global attribute
#' @param sep the separator used to delimit fields in the attribute
#' @return named character vector of attributes
nc_att_split <- function(nc, name = "FileHeader", sep = ";\n"){
	
	a1 <- ncdf4::ncatt_get(nc, 0)[[name[1]]]
	if (is.null(a1)) return(a1)
	
	a2 <- strsplit(a1,";\n", fixed = TRUE)[[1]]
	aa <- strsplit(a2, "=", fixed = TRUE)
	
	x <- sapply(aa,
		function(s) x = if(length(s) <= 1) "" else s[2]
		)	
	names(x) <- sapply(aa,
		function(s) x = if(length(s) <= 1) "unknown" else s[1]
		)
	
	x
}


nc <- ncdf4::nc_open("3B43.20080101.7A.HDF.nc")
x <- nc_att_split(nc)
as.Date(x[['StartGranuleDateTime']], format = "%Y-%m-%dT%H:%M:%OSZ")
[1] "2008-01-01"


Cheers,
Ben

> On Dec 26, 2018, at 3:42 PM, Antonio Silva <aolinto.lst at gmail.com> wrote:
> 
> Dear list members
> 
> I downloaded some nc files with precipitation data from
> https://pmm.nasa.gov/data-access/downloads/trmm (Level 3 3B43:
> Multisatellite Precipitation). For the image link see the global attribute
> "history" (below).
> 
> With ncdf4::nc_open I cloud open the file (nc.data <- nc_open("
> 3B43.20080101.7A.HDF.nc")
> 
> I want to extract the "StartGranuleDateTime" but it is inside the global
> attribute FileHeader (see below).
> 
> With ncatt_get(nc.data,0,"FileHeader")$value I got
> [1]
> "AlgorithmID=3B43;\nAlgorithmVersion=3B43_7.0;\nFileName=3B43.20080101.7A.HDF;\nGenerationDateTime=2012-11-29T19:12:01.000Z;\nStartGranuleDateTime=2008-01-01T00:00:00.000Z;\nStopGranuleDateTime=2008-01-31T23:59:59.999Z;\nGranuleNumber=;\nNumberOfSwaths=0;\nNumberOfGrids=1;\nGranuleStart=;\nTimeInterval=MONTH;\nProcessingSystem=PPS;\nProductVersion=7A;\nMissingData=;\n"
> 
> Is there any way to extract only the string "2008-01-01T00:00:00.000Z"?
> 
> The best I could do was
> as.Date(substr(strsplit(ncatt_get(nc.data,0,"FileHeader")$value,";\n")[[1]][5],22,45),"%Y-%m-%dT%H:%M:%OSZ")
> 
> but probably, I suppose, there must be a more direct way of getting the
> data. I appreciate any suggestions.
> 
> Best regards,
> 
> Antonio Olinto
> Fisheries Institute
> Brazil
> 
> nc.data
> File 3B43.20080101.7A.HDF.nc (NC_FORMAT_CLASSIC):
> 
>     1 variables (excluding dimension variables):
>        float precipitation[nlat,nlon]
>            units: mm/hr
>            coordinates: nlon nlat
>            _FillValue: -9999.900390625
> 
>     2 dimensions:
>        nlon  Size:33
>            long_name: longitude
>            standard_name: longitude
>            units: degrees_east
>        nlat  Size:41
>            long_name: latitude
>            standard_name: latitude
>            units: degrees_north
> 
>    5 global attributes:
>        Grid.GridHeader: BinMethod=ARITHMETIC_MEAN;
> Registration=CENTER;
> LatitudeResolution=0.25;
> LongitudeResolution=0.25;
> NorthBoundingCoordinate=50;
> SouthBoundingCoordinate=-50;
> EastBoundingCoordinate=180;
> WestBoundingCoordinate=-180;
> Origin=SOUTHWEST;
> 
>        FileHeader: AlgorithmID=3B43;
> AlgorithmVersion=3B43_7.0;
> FileName=3B43.20080101.7A.HDF;
> GenerationDateTime=2012-11-29T19:12:01.000Z;
> StartGranuleDateTime=2008-01-01T00:00:00.000Z;
> StopGranuleDateTime=2008-01-31T23:59:59.999Z;
> GranuleNumber=;
> NumberOfSwaths=0;
> NumberOfGrids=1;
> GranuleStart=;
> TimeInterval=MONTH;
> ProcessingSystem=PPS;
> ProductVersion=7A;
> MissingData=;
> 
>        FileInfo: DataFormatVersion=m;
> TKCodeBuildVersion=1;
> MetadataVersion=m;
> FormatPackage=HDF Version 4.2 Release 4, January 25, 2009;
> BlueprintFilename=TRMM.V7.3B43.blueprint.xml;
> BlueprintVersion=BV_13;
> TKIOVersion=1.6;
> MetadataStyle=PVL;
> EndianType=LITTLE_ENDIAN;
> 
>        GridHeader: BinMethod=ARITHMETIC_MEAN;
> Registration=CENTER;
> LatitudeResolution=0.25;
> LongitudeResolution=0.25;
> NorthBoundingCoordinate=50;
> SouthBoundingCoordinate=-50;
> EastBoundingCoordinate=180;
> WestBoundingCoordinate=-180;
> Origin=SOUTHWEST;
> 
>        history: 2018-12-26 17:57:56 GMT Hyrax-1.13.4
> https://disc2.gesdisc.eosdis.nasa.gov:443/opendap/TRMM_L3/TRMM_3B43.7/2008/3B43.20080101.7A.HDF.nc?precipitation[604:636][3:43],nlat[3:43],nlon[604:636]
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Ben Tupper
Bigelow Laboratory for Ocean Sciences
60 Bigelow Drive, P.O. Box 380
East Boothbay, Maine 04544
http://www.bigelow.org

Ecological Forecasting: https://eco.bigelow.org/


From @olinto@l@t @ending from gm@il@com  Thu Dec 27 18:15:01 2018
From: @olinto@l@t @ending from gm@il@com (Antonio Silva)
Date: Thu, 27 Dec 2018 15:15:01 -0200
Subject: [R-sig-Geo] get data from nc file
In-Reply-To: <6BB9421A-0E8E-4928-B299-3C8D5097D61E@bigelow.org>
References: <CAE8g1gPz2x21yDAW7i3kOVBESwRx0ppgM11ycHRTSti0rGMQ1w@mail.gmail.com>
 <6BB9421A-0E8E-4928-B299-3C8D5097D61E@bigelow.org>
Message-ID: <CAE8g1gMQ9O18A0JyM7uwT-0BoPxOVmObpuH_piV_BVu45_4wAw@mail.gmail.com>

Thanks for you nice idea and code Ben. I will use them for sure.

Have a wonderful 2019. All the best

Antonio Olinto
Fisheries Institute
Brazil


Em qua, 26 de dez de 2018 ?s 22:01, Ben Tupper <btupper at bigelow.org>
escreveu:

> Hi,
>
> .  I don't think there is any other way as the attributes are sort of
> buried in the string; that's unfortunate.  I guess you could at least make
> a reusable function assuming you'll be doing this again or looking to pull
> other attributes.  Something like this...
>
>
> #' Extract one of the GLobal Attributes of a TRMM NetCDF as a named vector
> #'
> #' @param nc the ncdf4 object
> #' @param name the name of the global attribute
> #' @param sep the separator used to delimit fields in the attribute
> #' @return named character vector of attributes
> nc_att_split <- function(nc, name = "FileHeader", sep = ";\n"){
>
>         a1 <- ncdf4::ncatt_get(nc, 0)[[name[1]]]
>         if (is.null(a1)) return(a1)
>
>         a2 <- strsplit(a1,";\n", fixed = TRUE)[[1]]
>         aa <- strsplit(a2, "=", fixed = TRUE)
>
>         x <- sapply(aa,
>                 function(s) x = if(length(s) <= 1) "" else s[2]
>                 )
>         names(x) <- sapply(aa,
>                 function(s) x = if(length(s) <= 1) "unknown" else s[1]
>                 )
>
>         x
> }
>
>
> nc <- ncdf4::nc_open("3B43.20080101.7A.HDF.nc")
> x <- nc_att_split(nc)
> as.Date(x[['StartGranuleDateTime']], format = "%Y-%m-%dT%H:%M:%OSZ")
> [1] "2008-01-01"
>
>
> Cheers,
> Ben
>
> > On Dec 26, 2018, at 3:42 PM, Antonio Silva <aolinto.lst at gmail.com>
> wrote:
> >
> > Dear list members
> >
> > I downloaded some nc files with precipitation data from
> > https://pmm.nasa.gov/data-access/downloads/trmm (Level 3 3B43:
> > Multisatellite Precipitation). For the image link see the global
> attribute
> > "history" (below).
> >
> > With ncdf4::nc_open I cloud open the file (nc.data <- nc_open("
> > 3B43.20080101.7A.HDF.nc")
> >
> > I want to extract the "StartGranuleDateTime" but it is inside the global
> > attribute FileHeader (see below).
> >
> > With ncatt_get(nc.data,0,"FileHeader")$value I got
> > [1]
> >
> "AlgorithmID=3B43;\nAlgorithmVersion=3B43_7.0;\nFileName=3B43.20080101.7A.HDF;\nGenerationDateTime=2012-11-29T19:12:01.000Z;\nStartGranuleDateTime=2008-01-01T00:00:00.000Z;\nStopGranuleDateTime=2008-01-31T23:59:59.999Z;\nGranuleNumber=;\nNumberOfSwaths=0;\nNumberOfGrids=1;\nGranuleStart=;\nTimeInterval=MONTH;\nProcessingSystem=PPS;\nProductVersion=7A;\nMissingData=;\n"
> >
> > Is there any way to extract only the string "2008-01-01T00:00:00.000Z"?
> >
> > The best I could do was
> >
> as.Date(substr(strsplit(ncatt_get(nc.data,0,"FileHeader")$value,";\n")[[1]][5],22,45),"%Y-%m-%dT%H:%M:%OSZ")
> >
> > but probably, I suppose, there must be a more direct way of getting the
> > data. I appreciate any suggestions.
> >
> > Best regards,
> >
> > Antonio Olinto
> > Fisheries Institute
> > Brazil
> >
> > nc.data
> > File 3B43.20080101.7A.HDF.nc (NC_FORMAT_CLASSIC):
> >
> >     1 variables (excluding dimension variables):
> >        float precipitation[nlat,nlon]
> >            units: mm/hr
> >            coordinates: nlon nlat
> >            _FillValue: -9999.900390625
> >
> >     2 dimensions:
> >        nlon  Size:33
> >            long_name: longitude
> >            standard_name: longitude
> >            units: degrees_east
> >        nlat  Size:41
> >            long_name: latitude
> >            standard_name: latitude
> >            units: degrees_north
> >
> >    5 global attributes:
> >        Grid.GridHeader: BinMethod=ARITHMETIC_MEAN;
> > Registration=CENTER;
> > LatitudeResolution=0.25;
> > LongitudeResolution=0.25;
> > NorthBoundingCoordinate=50;
> > SouthBoundingCoordinate=-50;
> > EastBoundingCoordinate=180;
> > WestBoundingCoordinate=-180;
> > Origin=SOUTHWEST;
> >
> >        FileHeader: AlgorithmID=3B43;
> > AlgorithmVersion=3B43_7.0;
> > FileName=3B43.20080101.7A.HDF;
> > GenerationDateTime=2012-11-29T19:12:01.000Z;
> > StartGranuleDateTime=2008-01-01T00:00:00.000Z;
> > StopGranuleDateTime=2008-01-31T23:59:59.999Z;
> > GranuleNumber=;
> > NumberOfSwaths=0;
> > NumberOfGrids=1;
> > GranuleStart=;
> > TimeInterval=MONTH;
> > ProcessingSystem=PPS;
> > ProductVersion=7A;
> > MissingData=;
> >
> >        FileInfo: DataFormatVersion=m;
> > TKCodeBuildVersion=1;
> > MetadataVersion=m;
> > FormatPackage=HDF Version 4.2 Release 4, January 25, 2009;
> > BlueprintFilename=TRMM.V7.3B43.blueprint.xml;
> > BlueprintVersion=BV_13;
> > TKIOVersion=1.6;
> > MetadataStyle=PVL;
> > EndianType=LITTLE_ENDIAN;
> >
> >        GridHeader: BinMethod=ARITHMETIC_MEAN;
> > Registration=CENTER;
> > LatitudeResolution=0.25;
> > LongitudeResolution=0.25;
> > NorthBoundingCoordinate=50;
> > SouthBoundingCoordinate=-50;
> > EastBoundingCoordinate=180;
> > WestBoundingCoordinate=-180;
> > Origin=SOUTHWEST;
> >
> >        history: 2018-12-26 17:57:56 GMT Hyrax-1.13.4
> >
> https://disc2.gesdisc.eosdis.nasa.gov:443/opendap/TRMM_L3/TRMM_3B43.7/2008/3B43.20080101.7A.HDF.nc?precipitation[604:636][3:43],nlat[3:43],nlon[604:636]
> >
> >       [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> Ben Tupper
> Bigelow Laboratory for Ocean Sciences
> 60 Bigelow Drive, P.O. Box 380
> East Boothbay, Maine 04544
> http://www.bigelow.org
>
> Ecological Forecasting: https://eco.bigelow.org

	[[alternative HTML version deleted]]


From @olinto@l@t @ending from gm@il@com  Fri Dec 28 16:04:59 2018
From: @olinto@l@t @ending from gm@il@com (Antonio Silva)
Date: Fri, 28 Dec 2018 13:04:59 -0200
Subject: [R-sig-Geo] how to get an attribute from a raster layer
Message-ID: <CAE8g1gM5VjJPAxzQcMoUxL4u2KwntUBcdr3hxvKGWf8f6oD5KA@mail.gmail.com>

Dear list members

I need help to do something that should be easy but I could not execute.

I just want to plot a raster layer and use "z-value" as the title.

rst.data[[1]]
class       : RasterLayer
band        : 1  (of  4  bands)
dimensions  : 33, 45, 1485  (nrow, ncol, ncell)
resolution  : 0.25, 0.25  (x, y)
extent      : -50.25, -39, -29, -20.75  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0
data source : /mnt/.../dataset-sss-ssd-rep-monthly_2016-11-12_sos.nc
names       : X2016.11.15.1
z-value     : 2016-11-15
zvar        : sos

Is it possible to extract the z-value value directly (2016-11-15)?

The best I could do was

plot(rst.data[[1]],main=substr(names(rst.data[[1]]),2,11))

Thanks a lot

Antonio Olinto
Fisheries Institute
S?o Paulo, Brazil

	[[alternative HTML version deleted]]


From btupper @ending from bigelow@org  Fri Dec 28 16:19:47 2018
From: btupper @ending from bigelow@org (Ben Tupper)
Date: Fri, 28 Dec 2018 10:19:47 -0500
Subject: [R-sig-Geo] how to get an attribute from a raster layer
In-Reply-To: <CAE8g1gM5VjJPAxzQcMoUxL4u2KwntUBcdr3hxvKGWf8f6oD5KA@mail.gmail.com>
References: <CAE8g1gM5VjJPAxzQcMoUxL4u2KwntUBcdr3hxvKGWf8f6oD5KA@mail.gmail.com>
Message-ID: <EA2D9528-3FA6-4DAD-A8FF-671E00168B87@bigelow.org>

Hi,

You are looking for raster::getZ() but be aware that the Z value can be of any type - in this case I would guess it is a Date class so you will need to cast it to character using format() to get a label you desire.

https://www.rdocumentation.org/packages/raster/versions/2.8-4/topics/z-values


Cheers,
Ben
> On Dec 28, 2018, at 10:04 AM, Antonio Silva <aolinto.lst at gmail.com> wrote:
> 
> Dear list members
> 
> I need help to do something that should be easy but I could not execute.
> 
> I just want to plot a raster layer and use "z-value" as the title.
> 
> rst.data[[1]]
> class       : RasterLayer
> band        : 1  (of  4  bands)
> dimensions  : 33, 45, 1485  (nrow, ncol, ncell)
> resolution  : 0.25, 0.25  (x, y)
> extent      : -50.25, -39, -29, -20.75  (xmin, xmax, ymin, ymax)
> coord. ref. : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0
> data source : /mnt/.../dataset-sss-ssd-rep-monthly_2016-11-12_sos.nc
> names       : X2016.11.15.1
> z-value     : 2016-11-15
> zvar        : sos
> 
> Is it possible to extract the z-value value directly (2016-11-15)?
> 
> The best I could do was
> 
> plot(rst.data[[1]],main=substr(names(rst.data[[1]]),2,11))
> 
> Thanks a lot
> 
> Antonio Olinto
> Fisheries Institute
> S?o Paulo, Brazil
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Ben Tupper
Bigelow Laboratory for Ocean Sciences
60 Bigelow Drive, P.O. Box 380
East Boothbay, Maine 04544
http://www.bigelow.org

Ecological Forecasting: https://eco.bigelow.org/






	[[alternative HTML version deleted]]


From @olinto@l@t @ending from gm@il@com  Fri Dec 28 17:39:21 2018
From: @olinto@l@t @ending from gm@il@com (Antonio Silva)
Date: Fri, 28 Dec 2018 14:39:21 -0200
Subject: [R-sig-Geo] how to get an attribute from a raster layer
In-Reply-To: <EA2D9528-3FA6-4DAD-A8FF-671E00168B87@bigelow.org>
References: <CAE8g1gM5VjJPAxzQcMoUxL4u2KwntUBcdr3hxvKGWf8f6oD5KA@mail.gmail.com>
 <EA2D9528-3FA6-4DAD-A8FF-671E00168B87@bigelow.org>
Message-ID: <CAE8g1gO9w1DMfJ9hMp5-C5WhFs6n20JdLCyBBF6CwAyTJ-nt0g@mail.gmail.com>

Dear Ben

Thanks again. I didn't find this function in my search.

Happy new year to all.

Antonio Olinto

Em sex, 28 de dez de 2018 ?s 13:19, Ben Tupper <btupper at bigelow.org>
escreveu:

> Hi,
>
> You are looking for raster::getZ() but be aware that the Z value can be of
> any type - in this case I would guess it is a Date class so you will need
> to cast it to character using format() to get a label you desire.
>
>
> https://www.rdocumentation.org/packages/raster/versions/2.8-4/topics/z-values
>
>
> Cheers,
> Ben
>
> On Dec 28, 2018, at 10:04 AM, Antonio Silva <aolinto.lst at gmail.com> wrote:
>
> Dear list members
>
> I need help to do something that should be easy but I could not execute.
>
> I just want to plot a raster layer and use "z-value" as the title.
>
> rst.data[[1]]
> class       : RasterLayer
> band        : 1  (of  4  bands)
> dimensions  : 33, 45, 1485  (nrow, ncol, ncell)
> resolution  : 0.25, 0.25  (x, y)
> extent      : -50.25, -39, -29, -20.75  (xmin, xmax, ymin, ymax)
> coord. ref. : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0
> data source : /mnt/.../dataset-sss-ssd-rep-monthly_2016-11-12_sos.nc
> names       : X2016.11.15.1
> z-value     : 2016-11-15
> zvar        : sos
>
> Is it possible to extract the z-value value directly (2016-11-15)?
>
> The best I could do was
>
> plot(rst.data[[1]],main=substr(names(rst.data[[1]]),2,11))
>
> Thanks a lot
>
> Antonio Olinto
> Fisheries Institute
> S?o Paulo, Brazil
>
> [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
> Ben Tupper
> Bigelow Laboratory for Ocean Sciences
> 60 Bigelow Drive, P.O. Box 380
> East Boothbay, Maine 04544
> http://www.bigelow.org
>
> Ecological Forecasting: https://eco.bigelow.org/
>

	[[alternative HTML version deleted]]


From dc@rl@on @ending from t@mu@edu  Sat Dec 29 20:04:38 2018
From: dc@rl@on @ending from t@mu@edu (David L Carlson)
Date: Sat, 29 Dec 2018 19:04:38 +0000
Subject: [R-sig-Geo] how to get an attribute from a raster layer
In-Reply-To: <CAE8g1gO9w1DMfJ9hMp5-C5WhFs6n20JdLCyBBF6CwAyTJ-nt0g@mail.gmail.com>
References: <CAE8g1gM5VjJPAxzQcMoUxL4u2KwntUBcdr3hxvKGWf8f6oD5KA@mail.gmail.com>
 <EA2D9528-3FA6-4DAD-A8FF-671E00168B87@bigelow.org>
 <CAE8g1gO9w1DMfJ9hMp5-C5WhFs6n20JdLCyBBF6CwAyTJ-nt0g@mail.gmail.com>
Message-ID: <d28ead0e531d46dbb37d82641bed3c79@tamu.edu>

Where did you search? My google search for "getZ package raster" found it easily. If you have loaded the raster package, then the command ?getZ brings up the manual page:

> library(raster)
Loading required package: sp
> ?getZ

--------------------------------------
David L. Carlson
Department of Anthropology
Texas A&M University


-----Original Message-----
From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Antonio Silva
Sent: Friday, December 28, 2018 10:39 AM
To: Ben Tupper <btupper at bigelow.org>
Cc: R-mailing list <r-sig-geo at r-project.org>
Subject: Re: [R-sig-Geo] how to get an attribute from a raster layer

Dear Ben

Thanks again. I didn't find this function in my search.

Happy new year to all.

Antonio Olinto

Em sex, 28 de dez de 2018 ?s 13:19, Ben Tupper <btupper at bigelow.org>
escreveu:

> Hi,
>
> You are looking for raster::getZ() but be aware that the Z value can be of
> any type - in this case I would guess it is a Date class so you will need
> to cast it to character using format() to get a label you desire.
>
>
> https://www.rdocumentation.org/packages/raster/versions/2.8-4/topics/z-values
>
>
> Cheers,
> Ben
>
> On Dec 28, 2018, at 10:04 AM, Antonio Silva <aolinto.lst at gmail.com> wrote:
>
> Dear list members
>
> I need help to do something that should be easy but I could not execute.
>
> I just want to plot a raster layer and use "z-value" as the title.
>
> rst.data[[1]]
> class       : RasterLayer
> band        : 1  (of  4  bands)
> dimensions  : 33, 45, 1485  (nrow, ncol, ncell)
> resolution  : 0.25, 0.25  (x, y)
> extent      : -50.25, -39, -29, -20.75  (xmin, xmax, ymin, ymax)
> coord. ref. : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0
> data source : /mnt/.../dataset-sss-ssd-rep-monthly_2016-11-12_sos.nc
> names       : X2016.11.15.1
> z-value     : 2016-11-15
> zvar        : sos
>
> Is it possible to extract the z-value value directly (2016-11-15)?
>
> The best I could do was
>
> plot(rst.data[[1]],main=substr(names(rst.data[[1]]),2,11))
>
> Thanks a lot
>
> Antonio Olinto
> Fisheries Institute
> S?o Paulo, Brazil
>
> [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
> Ben Tupper
> Bigelow Laboratory for Ocean Sciences
> 60 Bigelow Drive, P.O. Box 380
> East Boothbay, Maine 04544
> http://www.bigelow.org
>
> Ecological Forecasting: https://eco.bigelow.org/
>

	[[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

