From gholt at uw.edu  Tue Apr  1 00:05:34 2014
From: gholt at uw.edu (Gordon Holtgrieve)
Date: Mon, 31 Mar 2014 15:05:34 -0700
Subject: [R-sig-Geo] Iteratively subsample a rater and reassemble
In-Reply-To: <CAEBQMMnqaHo+X7qwnEZTG780h8HGuDDecLYzx=MyFh5WGnODmg@mail.gmail.com>
References: <CAMiGwMd63BJAO1CP7aGeBvNRj+oHGiYwWV4jJhdwG5B41YERCA@mail.gmail.com>
	<CABG0rfv_S_qxZUerLxZBexQWMJM2WM7vGPfxFtwgg1rKGUf2gw@mail.gmail.com>
	<CAMiGwMddwby-D1W5tcqVxz1uwAGc9oALTk0=F9=iP3y1odrPVA@mail.gmail.com>
	<CABG0rftpvM2-4u-uQ2WqSNrxFijydcXc0KvDrqrwY+15q32oOw@mail.gmail.com>
	<CAEBQMMnqaHo+X7qwnEZTG780h8HGuDDecLYzx=MyFh5WGnODmg@mail.gmail.com>
Message-ID: <CAMiGwMdic0WciZVamyn3sos5qLG+nQBFE6q_PDySYhRNbArTmw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140331/985d83cf/attachment.pl>

From jgrn at illinois.edu  Tue Apr  1 16:50:57 2014
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Tue, 1 Apr 2014 09:50:57 -0500
Subject: [R-sig-Geo] Singlepart to multipart
In-Reply-To: <alpine.LRH.2.03.1310292030311.3464@reclus.nhh.no>
References: <CABG0rfuSWTAAZ7AYUxksJBrjT__=gHLxAyX74Ob+RYYCAJtpMA@mail.gmail.com>
	<alpine.LRH.2.03.1310292030311.3464@reclus.nhh.no>
Message-ID: <CABG0rfu=BSsN2PmzsHM+2Z3cKT3x_PUySRCaQW0VV_haZOfuFQ@mail.gmail.com>

This is a counter-question to the previous one: how would I go about
taking a multipart SpatialPolygon* and "flattening" it so each
individual polygon is its own component, "repeating" the data frame
(if a SpatialPolygonsDataFrame) for the new polygons, effectively
"undoing" the previous suggestion?

--j

On Tue, Oct 29, 2013 at 2:32 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> On Tue, 29 Oct 2013, Jonathan Greenberg wrote:
>
>> R-sig-geo'ers:
>>
>> If I have a SpatialPolygonsDataFrame with a field "MYID", how do I go
>> about
>> coercing that object to a multipart polygon, where I am "merging" on the
>> MYID field?
>
>
> maptools::unionSpatialPolygons() which calls rgeos::gUnaryUnion, so go to
> rgeos::gUnaryUnion first unless you have challenged geometries - if hole
> problems use maptools::checkPolygonsHoles first.
>
> Hope this helps,
>
> Roger
>
>>
>> --j
>>
>>
>
> --
> Roger Bivand
> Department of Economics, NHH Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>



-- 
Jonathan A. Greenberg, PhD
Assistant Professor
Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
Department of Geography and Geographic Information Science
University of Illinois at Urbana-Champaign
259 Computing Applications Building, MC-150
605 East Springfield Avenue
Champaign, IL  61820-6371
Phone: 217-300-1924
http://www.geog.illinois.edu/~jgrn/
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007


From r.hijmans at gmail.com  Tue Apr  1 18:21:15 2014
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 1 Apr 2014 09:21:15 -0700
Subject: [R-sig-Geo] Singlepart to multipart
In-Reply-To: <CABG0rfu=BSsN2PmzsHM+2Z3cKT3x_PUySRCaQW0VV_haZOfuFQ@mail.gmail.com>
References: <CABG0rfuSWTAAZ7AYUxksJBrjT__=gHLxAyX74Ob+RYYCAJtpMA@mail.gmail.com>
	<alpine.LRH.2.03.1310292030311.3464@reclus.nhh.no>
	<CABG0rfu=BSsN2PmzsHM+2Z3cKT3x_PUySRCaQW0VV_haZOfuFQ@mail.gmail.com>
Message-ID: <CANtt_hwRNXVmQqRJfX4Sb_c2rSya1fuDfS8HdDuCvM=7DwuONw@mail.gmail.com>

Jonathan,
You can go back and forth with (raster/sp) functions aggregate and disaggregate
Robert

On Tue, Apr 1, 2014 at 7:50 AM, Jonathan Greenberg <jgrn at illinois.edu> wrote:
> This is a counter-question to the previous one: how would I go about
> taking a multipart SpatialPolygon* and "flattening" it so each
> individual polygon is its own component, "repeating" the data frame
> (if a SpatialPolygonsDataFrame) for the new polygons, effectively
> "undoing" the previous suggestion?
>
> --j
>
> On Tue, Oct 29, 2013 at 2:32 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>> On Tue, 29 Oct 2013, Jonathan Greenberg wrote:
>>
>>> R-sig-geo'ers:
>>>
>>> If I have a SpatialPolygonsDataFrame with a field "MYID", how do I go
>>> about
>>> coercing that object to a multipart polygon, where I am "merging" on the
>>> MYID field?
>>
>>
>> maptools::unionSpatialPolygons() which calls rgeos::gUnaryUnion, so go to
>> rgeos::gUnaryUnion first unless you have challenged geometries - if hole
>> problems use maptools::checkPolygonsHoles first.
>>
>> Hope this helps,
>>
>> Roger
>>
>>>
>>> --j
>>>
>>>
>>
>> --
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>
>
>
> --
> Jonathan A. Greenberg, PhD
> Assistant Professor
> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
> Department of Geography and Geographic Information Science
> University of Illinois at Urbana-Champaign
> 259 Computing Applications Building, MC-150
> 605 East Springfield Avenue
> Champaign, IL  61820-6371
> Phone: 217-300-1924
> http://www.geog.illinois.edu/~jgrn/
> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Roger.Bivand at nhh.no  Tue Apr  1 19:53:34 2014
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 1 Apr 2014 19:53:34 +0200
Subject: [R-sig-Geo] Singlepart to multipart
In-Reply-To: <CABG0rfu=BSsN2PmzsHM+2Z3cKT3x_PUySRCaQW0VV_haZOfuFQ@mail.gmail.com>
References: <CABG0rfuSWTAAZ7AYUxksJBrjT__=gHLxAyX74Ob+RYYCAJtpMA@mail.gmail.com>
	<alpine.LRH.2.03.1310292030311.3464@reclus.nhh.no>
	<CABG0rfu=BSsN2PmzsHM+2Z3cKT3x_PUySRCaQW0VV_haZOfuFQ@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1404011940260.683@reclus.nhh.no>

On Tue, 1 Apr 2014, Jonathan Greenberg wrote:

> This is a counter-question to the previous one: how would I go about
> taking a multipart SpatialPolygon* and "flattening" it so each
> individual polygon is its own component, "repeating" the data frame
> (if a SpatialPolygonsDataFrame) for the new polygons, effectively
> "undoing" the previous suggestion?

Crucially, and typically for me, what do you mean by "polygon"? Do you 
mean SFS POLYGON (one exterior ring and zero or more interior rings aka 
holes), or Polygon as defined in sp, which is a linear ring either hole or 
non-hole? I suspect the former, but the answers would differ.

The IDs on the Polygons objects (features) are tied to rows in the data 
frame, so you are breaking up each Polygons object either to the lowest 
level of each component linear ring irrespective of its hole status, or, 
more likely, to that of each constituent SFS POLYGON. Something like this 
happens as Polygons objects enter GEOS, but there such a Polygons object 
may go to MULTIPOLYGON (multiple exterior rings) or POLYGON (single 
exterior ring) as encoded in the comment attribute of Polygons objects 
(yes, a nasty kludge, knowing about SFS postdated the definition of 
polygon vector objects in sp). Some mechainsm for assigning ID values 
would also be needed.

Roger

>
> --j
>
> On Tue, Oct 29, 2013 at 2:32 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>> On Tue, 29 Oct 2013, Jonathan Greenberg wrote:
>>
>>> R-sig-geo'ers:
>>>
>>> If I have a SpatialPolygonsDataFrame with a field "MYID", how do I go
>>> about
>>> coercing that object to a multipart polygon, where I am "merging" on the
>>> MYID field?
>>
>>
>> maptools::unionSpatialPolygons() which calls rgeos::gUnaryUnion, so go to
>> rgeos::gUnaryUnion first unless you have challenged geometries - if hole
>> problems use maptools::checkPolygonsHoles first.
>>
>> Hope this helps,
>>
>> Roger
>>
>>>
>>> --j
>>>
>>>
>>
>> --
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>
>
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From dj1 at noc.ac.uk  Tue Apr  1 21:50:50 2014
From: dj1 at noc.ac.uk (Jones, Daniel O.B.)
Date: Tue, 1 Apr 2014 20:50:50 +0100
Subject: [R-sig-Geo] gridding data prior to spatial analyses
Message-ID: <D7ED5D2780D3334299EDDBC1F66E96E40736745679@nerckwmb1.ad.nerc.ac.uk>

Dear all,
I have a reasonably large database (~2500 points) of biomass values (the response variable) with associated positional information (lat / long) in the Atlantic. I want to look at potential environmental explanatory variables. I have several environmental datasets associated with each point (e.g. temperature, salinity, oxygen, organic carbon etc.). The data are spatially patchy and some locations (e.g. the North Sea) have a lot of data in a small area, while other areas have sparse data (e.g. the central Atlantic). I wanted to use spatial simultaneous autoregressive error modelling (errorSARlm in the spdep package) in R to assess how the biomass varies with each of the potential explanatory variables. In many other analyses I have seen the data are gridded prior to analysis. This leads to several questions:
1)      Should I grid the data? This dramatically reduces the available number of observations from around 2500 to around 150 (geometric mean biomass in 5 degree grid cells), but solves the problem of unequal data distribution. Are there any references that provide a recommendation for this?
2)      If I grid the data, should I grid the data at a higher resolution i.e. with lots of smaller cells (e.g. 1 degree). This will result in a sparse coverage (i.e. lots of holes) and lower number of observations per cell but will increase the accuracy and precision of the environmental data (which can vary dramatically over a 5 degree grid) and will increase the number of cells in the analysis (presumably increasing statistical power).
3)      If I grid the data, should I pick a minimum number of observations per cell and exclude the cells that do not meet this criteria. Other papers exclude grid cells where the number of observations is lower than a set value (determined, for example, by assessing how relative standard errors decrease with the number of observations).
I would greatly appreciate any advice from someone familiar with these analyses, particularly if you know of any published papers that back up the approach.
Many thanks, Daniel

This message (and any attachments) is for the recipient ...{{dropped:6}}


From jgrn at illinois.edu  Tue Apr  1 23:51:14 2014
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Tue, 1 Apr 2014 16:51:14 -0500
Subject: [R-sig-Geo] gridding data prior to spatial analyses
In-Reply-To: <D7ED5D2780D3334299EDDBC1F66E96E40736745679@nerckwmb1.ad.nerc.ac.uk>
References: <D7ED5D2780D3334299EDDBC1F66E96E40736745679@nerckwmb1.ad.nerc.ac.uk>
Message-ID: <CABG0rfvB-oqYp2WmQ1+0h+AuAg+_zhMOLvdhj5LoAP=+66UYag@mail.gmail.com>

Daniel:

I guess I'm not entirely understanding why you WOULD grid the data
first unless you plan on using the model to make
predictions/interpolate your response variable (biomass) spatially.
If you do plan on doing this (create continuous maps of biomass based
on spatial predictors), then yes you need continuous maps of each of
the predictor variables.  You do probably want to account for
autocorrelation in your dataset, since as you mentioned your data is
clumped, but this can all be done using the data as points.

--j

On Tue, Apr 1, 2014 at 2:50 PM, Jones, Daniel O.B. <dj1 at noc.ac.uk> wrote:
> Dear all,
> I have a reasonably large database (~2500 points) of biomass values (the response variable) with associated positional information (lat / long) in the Atlantic. I want to look at potential environmental explanatory variables. I have several environmental datasets associated with each point (e.g. temperature, salinity, oxygen, organic carbon etc.). The data are spatially patchy and some locations (e.g. the North Sea) have a lot of data in a small area, while other areas have sparse data (e.g. the central Atlantic). I wanted to use spatial simultaneous autoregressive error modelling (errorSARlm in the spdep package) in R to assess how the biomass varies with each of the potential explanatory variables. In many other analyses I have seen the data are gridded prior to analysis. This leads to several questions:
> 1)      Should I grid the data? This dramatically reduces the available number of observations from around 2500 to around 150 (geometric mean biomass in 5 degree grid cells), but solves the problem of unequal data distribution. Are there any references that provide a recommendation for this?
> 2)      If I grid the data, should I grid the data at a higher resolution i.e. with lots of smaller cells (e.g. 1 degree). This will result in a sparse coverage (i.e. lots of holes) and lower number of observations per cell but will increase the accuracy and precision of the environmental data (which can vary dramatically over a 5 degree grid) and will increase the number of cells in the analysis (presumably increasing statistical power).
> 3)      If I grid the data, should I pick a minimum number of observations per cell and exclude the cells that do not meet this criteria. Other papers exclude grid cells where the number of observations is lower than a set value (determined, for example, by assessing how relative standard errors decrease with the number of observations).
> I would greatly appreciate any advice from someone familiar with these analyses, particularly if you know of any published papers that back up the approach.
> Many thanks, Daniel
>
> This message (and any attachments) is for the recipient ...{{dropped:6}}
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Jonathan A. Greenberg, PhD
Assistant Professor
Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
Department of Geography and Geographic Information Science
University of Illinois at Urbana-Champaign
259 Computing Applications Building, MC-150
605 East Springfield Avenue
Champaign, IL  61820-6371
Phone: 217-300-1924
http://www.geog.illinois.edu/~jgrn/
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007


From jgrn at illinois.edu  Wed Apr  2 02:58:17 2014
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Tue, 1 Apr 2014 19:58:17 -0500
Subject: [R-sig-Geo] Need some help with rasterize...
Message-ID: <CABG0rfsgt_hpw8znCMs9p3JfvMjun-GtreJ5haMPxM=B_pwqWw@mail.gmail.com>

Robert et al.:

I'm seeing a potential issue with rasterize that I'm having a hard
time solving.  Here is the goal: I want to create two masks based on a
polygon: 1) a rasterized version of the ENTIRE polygon, and 2) a
rasterized version of only the edge of the polygon.  I thought it
would be sufficient to simply convert the SpatialPolygons to a
SpatialLines, but the rasterized SpatialLines does not coincide with
the edge of the SpatialPolygons.  Any help would be much appreciated.

I'm going to reference two test files that are in spatial.tools:

install.packages("spatial.tools",
repos="http://R-Forge.R-project.org",type="source")

# Some polys:
y <- readOGR(
dsn=system.file("external",
package="spatial.tools"),layer="tahoe_highrez_training")

# A brick:
x <- brick(system.file("external/tahoe_highrez.tif", package="spatial.tools"))

# We'll pull out a single poly:
y_poly <- y[1,]
# And crop the raster to it to make it a bit easier to see:
miniraster <- crop(x,y_poly)

# Now, we'll rasterize the polygon:
test_poly <- rasterize(y_poly,miniraster)

# And plot it:
plot(test_poly)
plot(y_poly,add=TRUE)

# Convert the poly to a SpatialLines:
y_line <- as(y_poly,"SpatialLines")

# Confirm it is in the same place as the poly:
plot(test_poly)
plot(y_poly,add=TRUE)
plot(y_line,col="red",add=TRUE)
# (Same place)

# Now rasterize the line:
test_line <- rasterize(y_line,miniraster)
plot(test_line,col="blue",add=TRUE)

Notice the line is being rasterized on both sides, but the polygon is
only rasterized inside (this is what I assume it is doing).  Any ideas
for how to tweak this so the test_line is simply the "edge" of the
test_poly (the outer set of pixels)?  Using the rasterized polygon as
a mask for the rasterized line isn't doing the trick (notice that the
"ring" of pixels is not continuous:

test_line_masked <-  test_poly * test_line
plot(test_poly)
plot(test_line_masked,col="blue",add=TRUE)

Ideas?

--j

-- 
Jonathan A. Greenberg, PhD
Assistant Professor
Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
Department of Geography and Geographic Information Science
University of Illinois at Urbana-Champaign
259 Computing Applications Building, MC-150
605 East Springfield Avenue
Champaign, IL  61820-6371
Phone: 217-300-1924
http://www.geog.illinois.edu/~jgrn/
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007


From rvaldezr at gmail.com  Wed Apr  2 07:02:10 2014
From: rvaldezr at gmail.com (Rolando Valdez)
Date: Tue, 1 Apr 2014 23:02:10 -0600
Subject: [R-sig-Geo] Error message when dissolving polygons
Message-ID: <3C605470-14BA-4C5E-B15D-6C37C1F3CACC@gmail.com>

Hi,

I?m trying to dissolve a polygon with 345 municipalities in 56 metropolitan areas. I?m following a tutorial found in the web, now I?m stuck in a step, I got an error message:

> input = readShapePoly("zm.shp", proj4string=CRS("+proj=lcc +ellps=GRS80 +datum=WGS84"))
> projectedpolygons = spTransform(input, CRS("+proj=lcc +ellps=GRS80 +datum=WGS84"))
> zmprojPS = SpatialPolygons2PolySet(projectedpolygons)
> plotPolys(zmprojPS, proj=TRUE, col="wheat1", xlab="longitude", ylab="latitude")
> print("Calculating polygon areas...")
[1] "Calculating polygon areas..."
> attr(zmprojPS, "projection")
[1] "1"
> attr(zmprojPS, "projection") <- "LL"
> zmPolyAreas = calcArea(zmprojPS, rollup=1)
Error in calcArea(zmprojPS, rollup = 1) : 
  To calculate the areas of polygons defined by longitude-latitude
coordinates, this routine first projects them in UTM.

Attempted to automatically calculate the missing 'zone' attribute, but
that failed because the mean longitude falls outside the range
-180 < x <= 180.

How I can solve this issue?

Thanks in advance,

Rolando Valdez


From e.defriez11 at imperial.ac.uk  Wed Apr  2 12:35:38 2014
From: e.defriez11 at imperial.ac.uk (Defriez, Emma)
Date: Wed, 2 Apr 2014 10:35:38 +0000
Subject: [R-sig-Geo] Strange R2 values from spatial durbin model
Message-ID: <2E74FF57C79A824FB51A7B057F8497173A515841@icexch-m4.ic.ac.uk>

Hi,
 I am hoping someone might be able to help me. I have been fitting spatial models with spdep. The mixed model appears to best describe the spatial autocorrelation in the data and I am now trying to  find the most parsimonious combination of variables. I have noticed that although the AIC and log likelihood values do change the Nagelkerke R2 remains essentially the same for all models, showing the biggest change when a different weight matrix is used. Below is a small summery table for 3 different models and 4 weight matrices. A single variable model with only var1 explains the same amount of variation as the full model which could be reasonable but a completely different single variable model (var6) still explains the same amount of variation which is very strange. 

I realise that R2 is not used to determine the most appropriate model with this kind of modelling but it has raised alarm bells ,does  this suggests that the model is misspecified? I don't know if I have made a mistake in my code somewhere that I cannot see.


weight         formula       					AIC       	            	 R2         		 LogLik
W 	chl~ var1+var2+var3+var4+var5+var6 		-34554.06 	0.8910829 	17292.03
W            			          chl~ var1		 -33882.83 	0.8886748 	16946.41
W       			                          chl~ var6		 -33581.47 	0.8876084 	16795.74
S 	chl~ var1+var2+var3+var4+var5+var6 		-28317.57 	0.8673353 	14174.79
S          			     	        chl~ var1		 -26324.23 	0.8586102 	13168.12
S           				        chl~ var6		-24746.26 	0.8513727 	12379.13
B	chl~ var1+var2+var3+var4+var5+var6 		-24368.85 	0.8496826 	12200.43
B          				        chl~ var1 		-21194.94 	0.8337000 	10603.47
B           				       chl~ var6 		-19051.44 	0.8220316  	9531.72
C 	chl~ var1+var2+var3+var4+var5+var6		 -24314.47 	0.8494238 	12173.24
C              			       chl~ var1 		-20918.91 	0.8322414 	10465.45
C           				       chl~ var6     		-18839.42 	0.8208338  	9425.71


#############################################################
### Example of code for creating models, weight style and ols formula varied
#############################################################

coords<-cbind(longs,lats)
coords<-as.matrix(coords)

#######################
#Define neighbourhood
nn<-dnearneigh(coords,0,150,longlat = TRUE)

#get inverse distances so further points have less influence
dists <- nbdists(nn, coords)
idw <- lapply(dists, function(x) 1/(x^2))

 #Spatial weights
nnW<-nb2listw(nn, glist=idw, style=W,zero.policy=TRUE)

#-------------------------------------------  model ----------------------------------------------------------#
ols<-lm(as.formula(chl~ var1+var2+var3+var4+var5+var6))

hW <- as(as_dgRMatrix_listw(nnW), "CsparseMatrix")
  set.seed(123456)
  htr <- trW(hW, m = 24)

  mod<-lagsarlm(formula=formula(ols),listw=nnW, na.action=na.omit, type="mixed", method='LU',
              tol.solve=1e-16, zero.policy=TRUE, tr=htr)


sessionInfo()
R version 3.0.2 (2013-09-25)
Platform: x86_64-pc-linux-gnu (64-bit)

locale:
 [1] LC_CTYPE=en_GB.UTF-8       LC_NUMERIC=C
 [3] LC_TIME=en_GB.UTF-8        LC_COLLATE=en_GB.UTF-8
 [5] LC_MONETARY=en_GB.UTF-8    LC_MESSAGES=en_GB.UTF-8
 [7] LC_PAPER=en_GB.UTF-8       LC_NAME=C
 [9] LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_GB.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] boot_1.3-9   spdep_0.5-68 Matrix_1.1-0 sp_1.0-14

loaded via a namespace (and not attached):
[1] coda_0.16-1     deldir_0.1-1    grid_3.0.2      lattice_0.20-24
[5] LearnBayes_2.12 MASS_7.3-29     nlme_3.1-111    splines_3.0.2

Thanks,
Emma

PhD student?
Faculty of Natural Sciences,?Department of Life Sciences
Imperial College London?


From Roger.Bivand at nhh.no  Wed Apr  2 13:07:57 2014
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 2 Apr 2014 13:07:57 +0200
Subject: [R-sig-Geo] Strange R2 values from spatial durbin model
In-Reply-To: <2E74FF57C79A824FB51A7B057F8497173A515841@icexch-m4.ic.ac.uk>
References: <2E74FF57C79A824FB51A7B057F8497173A515841@icexch-m4.ic.ac.uk>
Message-ID: <alpine.LRH.2.03.1404021255000.3371@reclus.nhh.no>

On Wed, 2 Apr 2014, Defriez, Emma wrote:

> Hi, I am hoping someone might be able to help me. I have been fitting 
> spatial models with spdep. The mixed model appears to best describe the 
> spatial autocorrelation in the data and I am now trying to find the most 
> parsimonious combination of variables. I have noticed that although the 
> AIC and log likelihood values do change the Nagelkerke R2 remains 
> essentially the same for all models, showing the biggest change when a 
> different weight matrix is used. Below is a small summery table for 3 
> different models and 4 weight matrices. A single variable model with 
> only var1 explains the same amount of variation as the full model which 
> could be reasonable but a completely different single variable model 
> (var6) still explains the same amount of variation which is very 
> strange.
>
> I realise that R2 is not used to determine the most appropriate model 
> with this kind of modelling but it has raised alarm bells ,does this 
> suggests that the model is misspecified? I don't know if I have made a 
> mistake in my code somewhere that I cannot see.

The pseudo-R2 provided is the Nagelkerke, see:

http://en.wikipedia.org/wiki/Coefficient_of_determination#Generalized_R2

comparing the log likelihood values null model (intercept only) with the 
fitted model. If the spatial coefficient "dominates" the outcome in the 
fitted model, what you see is to be expected. Please do not talk about 
this as "explained variance", it is just a number, and (as in OLS) its use 
depends on lots of assumptions that may not be met. Nagelkerke R2, AIC and 
the LL value give some indications, but should never be trusted implicly 
unless you know that the assumptions of all components are met.

Note that you need to be very careful in handling any model including the 
spatially lagged response, as its coefficients cannot be interpreted 
directly, and this may upset you variable selection process. Please see 
?impacts for guidance on this.

Hope this clarifies,

Roger



>
>
> weight         formula       					AIC       	            	 R2         		 LogLik
> W 	chl~ var1+var2+var3+var4+var5+var6 		-34554.06 	0.8910829 	17292.03
> W            			          chl~ var1		 -33882.83 	0.8886748 	16946.41
> W       			                          chl~ var6		 -33581.47 	0.8876084 	16795.74
> S 	chl~ var1+var2+var3+var4+var5+var6 		-28317.57 	0.8673353 	14174.79
> S          			     	        chl~ var1		 -26324.23 	0.8586102 	13168.12
> S           				        chl~ var6		-24746.26 	0.8513727 	12379.13
> B	chl~ var1+var2+var3+var4+var5+var6 		-24368.85 	0.8496826 	12200.43
> B          				        chl~ var1 		-21194.94 	0.8337000 	10603.47
> B           				       chl~ var6 		-19051.44 	0.8220316  	9531.72
> C 	chl~ var1+var2+var3+var4+var5+var6		 -24314.47 	0.8494238 	12173.24
> C              			       chl~ var1 		-20918.91 	0.8322414 	10465.45
> C           				       chl~ var6     		-18839.42 	0.8208338  	9425.71
>
>
> #############################################################
> ### Example of code for creating models, weight style and ols formula varied
> #############################################################
>
> coords<-cbind(longs,lats)
> coords<-as.matrix(coords)
>
> #######################
> #Define neighbourhood
> nn<-dnearneigh(coords,0,150,longlat = TRUE)
>
> #get inverse distances so further points have less influence
> dists <- nbdists(nn, coords)
> idw <- lapply(dists, function(x) 1/(x^2))
>
> #Spatial weights
> nnW<-nb2listw(nn, glist=idw, style=W,zero.policy=TRUE)
>
> #-------------------------------------------  model ----------------------------------------------------------#
> ols<-lm(as.formula(chl~ var1+var2+var3+var4+var5+var6))
>
> hW <- as(as_dgRMatrix_listw(nnW), "CsparseMatrix")
>  set.seed(123456)
>  htr <- trW(hW, m = 24)
>
>  mod<-lagsarlm(formula=formula(ols),listw=nnW, na.action=na.omit, type="mixed", method='LU',
>              tol.solve=1e-16, zero.policy=TRUE, tr=htr)
>
>
> sessionInfo()
> R version 3.0.2 (2013-09-25)
> Platform: x86_64-pc-linux-gnu (64-bit)
>
> locale:
> [1] LC_CTYPE=en_GB.UTF-8       LC_NUMERIC=C
> [3] LC_TIME=en_GB.UTF-8        LC_COLLATE=en_GB.UTF-8
> [5] LC_MONETARY=en_GB.UTF-8    LC_MESSAGES=en_GB.UTF-8
> [7] LC_PAPER=en_GB.UTF-8       LC_NAME=C
> [9] LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_GB.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] boot_1.3-9   spdep_0.5-68 Matrix_1.1-0 sp_1.0-14
>
> loaded via a namespace (and not attached):
> [1] coda_0.16-1     deldir_0.1-1    grid_3.0.2      lattice_0.20-24
> [5] LearnBayes_2.12 MASS_7.3-29     nlme_3.1-111    splines_3.0.2
>
> Thanks,
> Emma
>
> PhD student?
> Faculty of Natural Sciences,?Department of Life Sciences
> Imperial College London?
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no

From e.defriez11 at imperial.ac.uk  Wed Apr  2 13:37:41 2014
From: e.defriez11 at imperial.ac.uk (Defriez, Emma)
Date: Wed, 2 Apr 2014 11:37:41 +0000
Subject: [R-sig-Geo] Strange R2 values from spatial durbin model
In-Reply-To: <alpine.LRH.2.03.1404021255000.3371@reclus.nhh.no>
References: <2E74FF57C79A824FB51A7B057F8497173A515841@icexch-m4.ic.ac.uk>
	<alpine.LRH.2.03.1404021255000.3371@reclus.nhh.no>
Message-ID: <2E74FF57C79A824FB51A7B057F8497173A5158AC@icexch-m4.ic.ac.uk>

Ah I see, the spatial coefficient does seem to dominate my output so that would explain it. Thank you for your help.

Emma

-----Original Message-----
From: Roger Bivand [mailto:Roger.Bivand at nhh.no] 
Sent: 02 April 2014 12:08
To: Defriez, Emma
Cc: 'r-sig-geo at r-project.org'
Subject: Re: [R-sig-Geo] Strange R2 values from spatial durbin model

On Wed, 2 Apr 2014, Defriez, Emma wrote:

> Hi, I am hoping someone might be able to help me. I have been fitting 
> spatial models with spdep. The mixed model appears to best describe 
> the spatial autocorrelation in the data and I am now trying to find 
> the most parsimonious combination of variables. I have noticed that 
> although the AIC and log likelihood values do change the Nagelkerke R2 
> remains essentially the same for all models, showing the biggest 
> change when a different weight matrix is used. Below is a small 
> summery table for 3 different models and 4 weight matrices. A single 
> variable model with only var1 explains the same amount of variation as 
> the full model which could be reasonable but a completely different 
> single variable model
> (var6) still explains the same amount of variation which is very 
> strange.
>
> I realise that R2 is not used to determine the most appropriate model 
> with this kind of modelling but it has raised alarm bells ,does this 
> suggests that the model is misspecified? I don't know if I have made a 
> mistake in my code somewhere that I cannot see.

The pseudo-R2 provided is the Nagelkerke, see:

http://en.wikipedia.org/wiki/Coefficient_of_determination#Generalized_R2

comparing the log likelihood values null model (intercept only) with the fitted model. If the spatial coefficient "dominates" the outcome in the fitted model, what you see is to be expected. Please do not talk about this as "explained variance", it is just a number, and (as in OLS) its use depends on lots of assumptions that may not be met. Nagelkerke R2, AIC and the LL value give some indications, but should never be trusted implicly unless you know that the assumptions of all components are met.

Note that you need to be very careful in handling any model including the spatially lagged response, as its coefficients cannot be interpreted directly, and this may upset you variable selection process. Please see ?impacts for guidance on this.

Hope this clarifies,

Roger



>
>
> weight         formula       					AIC       	            	 R2         		 LogLik
> W 	chl~ var1+var2+var3+var4+var5+var6 		-34554.06 	0.8910829 	17292.03
> W            			          chl~ var1		 -33882.83 	0.8886748 	16946.41
> W       			                          chl~ var6		 -33581.47 	0.8876084 	16795.74
> S 	chl~ var1+var2+var3+var4+var5+var6 		-28317.57 	0.8673353 	14174.79
> S          			     	        chl~ var1		 -26324.23 	0.8586102 	13168.12
> S           				        chl~ var6		-24746.26 	0.8513727 	12379.13
> B	chl~ var1+var2+var3+var4+var5+var6 		-24368.85 	0.8496826 	12200.43
> B          				        chl~ var1 		-21194.94 	0.8337000 	10603.47
> B           				       chl~ var6 		-19051.44 	0.8220316  	9531.72
> C 	chl~ var1+var2+var3+var4+var5+var6		 -24314.47 	0.8494238 	12173.24
> C              			       chl~ var1 		-20918.91 	0.8322414 	10465.45
> C           				       chl~ var6     		-18839.42 	0.8208338  	9425.71
>
>
> #############################################################
> ### Example of code for creating models, weight style and ols formula 
> varied #############################################################
>
> coords<-cbind(longs,lats)
> coords<-as.matrix(coords)
>
> #######################
> #Define neighbourhood
> nn<-dnearneigh(coords,0,150,longlat = TRUE)
>
> #get inverse distances so further points have less influence dists <- 
> nbdists(nn, coords) idw <- lapply(dists, function(x) 1/(x^2))
>
> #Spatial weights
> nnW<-nb2listw(nn, glist=idw, style=W,zero.policy=TRUE)
>
> #-------------------------------------------  model 
> ----------------------------------------------------------#
> ols<-lm(as.formula(chl~ var1+var2+var3+var4+var5+var6))
>
> hW <- as(as_dgRMatrix_listw(nnW), "CsparseMatrix")
>  set.seed(123456)
>  htr <- trW(hW, m = 24)
>
>  mod<-lagsarlm(formula=formula(ols),listw=nnW, na.action=na.omit, type="mixed", method='LU',
>              tol.solve=1e-16, zero.policy=TRUE, tr=htr)
>
>
> sessionInfo()
> R version 3.0.2 (2013-09-25)
> Platform: x86_64-pc-linux-gnu (64-bit)
>
> locale:
> [1] LC_CTYPE=en_GB.UTF-8       LC_NUMERIC=C
> [3] LC_TIME=en_GB.UTF-8        LC_COLLATE=en_GB.UTF-8
> [5] LC_MONETARY=en_GB.UTF-8    LC_MESSAGES=en_GB.UTF-8
> [7] LC_PAPER=en_GB.UTF-8       LC_NAME=C
> [9] LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_GB.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] boot_1.3-9   spdep_0.5-68 Matrix_1.1-0 sp_1.0-14
>
> loaded via a namespace (and not attached):
> [1] coda_0.16-1     deldir_0.1-1    grid_3.0.2      lattice_0.20-24
> [5] LearnBayes_2.12 MASS_7.3-29     nlme_3.1-111    splines_3.0.2
>
> Thanks,
> Emma
>
> PhD student
> Faculty of Natural Sciences,?Department of Life Sciences Imperial 
> College London
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

--
Roger Bivand
Department of Economics, Norwegian School of Economics, Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From bakare at ualberta.ca  Wed Apr  2 18:08:25 2014
From: bakare at ualberta.ca (Moshood Agba Bakare)
Date: Wed, 2 Apr 2014 10:08:25 -0600
Subject: [R-sig-Geo] gstat: SSerr vs Cross validation statistics for
	variogram model
Message-ID: <CAJRR3XOkmP4Y6+7tjUphe8rfy7yASe+qz_wWzr3haiu+G2c6AA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140402/10bf01a7/attachment.pl>

From alessandracarioli at gmail.com  Wed Apr  2 18:28:58 2014
From: alessandracarioli at gmail.com (Alessandra Carioli)
Date: Wed, 2 Apr 2014 18:28:58 +0200
Subject: [R-sig-Geo] problem with findInterval when mapping in a loop
Message-ID: <16003FE8-4354-47AB-9B4D-2BBD52722CA0@gmail.com>

Dear Bloggers,
I?ve been working with a for loop to create maps of dependent variables to speed up a bit the work but I keep getting this error message

Error in findInterval(varofint2, bins, rightmost.closed = T) :  'vec' must be sorted non-decreasingly

I am not sure what to do (I have tried sorting the variables, just to see what happens but I still get the message).
Any help on the matter is very much appreciated!

Ale

R code:

library(spdep)
library(RColorBrewer)

var.data<- data.frame(var1,var2,var3,var4,var5,var6,var7,var8,var9) 
var.names<-c(?name variable 1?,?,?name variable 9"

m <- length(var.data)
var.color <- matrix(nrow=n,ncol=m, data=rep(0,n*m))
for (i in 1:m) {
 varofint <- var.data[,i]
 mean <- mean(varofint)
 sd <- sd(varofint)
 min <- min(varofint)
 max <- max(varofint)
 bins <- c(min,mean-sd, mean, mean+sd, max)
 lb <- length(bins)
 med <- median(1:lb)
 colpal <- brewer.pal(lb, "PRGn")[-med]
 var.color[,i] <- colpal[findInterval(varofint, bins, rightmost.closed=T)] #this is what does not work
 plot(shape.shp, col=var.color[,i], bg="grey5",lty=0) #shape.shp name of shape file
 title(var.names[[i]], cex=1)
 legend("bottomright",fill=colpal,legend=paste(round(bins[-length(bins)],2),
                                               "-", round(bins[-1],2)),cex=0.7, bg="white")
}

From edzer.pebesma at uni-muenster.de  Wed Apr  2 18:59:50 2014
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 02 Apr 2014 18:59:50 +0200
Subject: [R-sig-Geo] problem with findInterval when mapping in a loop
In-Reply-To: <16003FE8-4354-47AB-9B4D-2BBD52722CA0@gmail.com>
References: <16003FE8-4354-47AB-9B4D-2BBD52722CA0@gmail.com>
Message-ID: <533C4206.6050707@uni-muenster.de>

see ?findIntervals: vec refers to the second argument, i.e. bins in your
call. That one has to be sorted. Why do you think that mean-sd is larger
than min? Most things in this world are not normally distributed.

On 04/02/2014 06:28 PM, Alessandra Carioli wrote:
> Dear Bloggers,
> I?ve been working with a for loop to create maps of dependent variables to speed up a bit the work but I keep getting this error message
> 
> Error in findInterval(varofint2, bins, rightmost.closed = T) :  'vec' must be sorted non-decreasingly
> 
> I am not sure what to do (I have tried sorting the variables, just to see what happens but I still get the message).
> Any help on the matter is very much appreciated!
> 
> Ale
> 
> R code:
> 
> library(spdep)
> library(RColorBrewer)
> 
> var.data<- data.frame(var1,var2,var3,var4,var5,var6,var7,var8,var9) 
> var.names<-c(?name variable 1?,?,?name variable 9"
> 
> m <- length(var.data)
> var.color <- matrix(nrow=n,ncol=m, data=rep(0,n*m))
> for (i in 1:m) {
>  varofint <- var.data[,i]
>  mean <- mean(varofint)
>  sd <- sd(varofint)
>  min <- min(varofint)
>  max <- max(varofint)
>  bins <- c(min,mean-sd, mean, mean+sd, max)
>  lb <- length(bins)
>  med <- median(1:lb)
>  colpal <- brewer.pal(lb, "PRGn")[-med]
>  var.color[,i] <- colpal[findInterval(varofint, bins, rightmost.closed=T)] #this is what does not work
>  plot(shape.shp, col=var.color[,i], bg="grey5",lty=0) #shape.shp name of shape file
>  title(var.names[[i]], cex=1)
>  legend("bottomright",fill=colpal,legend=paste(round(bins[-length(bins)],2),
>                                                "-", round(bins[-1],2)),cex=0.7, bg="white")
> }
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140402/6760820e/attachment.bin>

From bakare at ualberta.ca  Wed Apr  2 23:37:12 2014
From: bakare at ualberta.ca (Moshood Agba Bakare)
Date: Wed, 2 Apr 2014 15:37:12 -0600
Subject: [R-sig-Geo] gstat model cross validation SSerr vs other diagnostic
	measures
Message-ID: <CAJRR3XOcEye93Wi2MFj1+tM6BAcEM6veWsMDbSkdf+1fuXAx5A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140402/049135fa/attachment.pl>

From kridox at ymail.com  Thu Apr  3 05:39:37 2014
From: kridox at ymail.com (Pascal Oettli)
Date: Thu, 3 Apr 2014 12:39:37 +0900
Subject: [R-sig-Geo] Subset of a 0-360 Raster* object astride the Greenwich
	Meridian
Message-ID: <CAAcyNCxnJzFj5LDd4i_vit04n7gy1dTE=pdx3kNhAhu52zL8uA@mail.gmail.com>

Dear list members,

I am generally working with Raster* objects that has longitude from 0
to 360. And I am always facing a problem when I try to get a subset
these objects, when the cropping region is astride the Greenwich
Meridian.

One way is to create 2 subsets, west and east of the Greenwich
Meridian, then stack these subsets together. Another way is to rotate
the original Raster* object, then create the subset.

I am wondering whether a more clever/efficient way exists, allowing
direct cropping.

Best Regards,
Pascal Oettli

-- 
Pascal Oettli
Project Scientist
JAMSTEC
Yokohama, Japan


From edzer.pebesma at uni-muenster.de  Thu Apr  3 08:22:39 2014
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 03 Apr 2014 08:22:39 +0200
Subject: [R-sig-Geo] gstat model cross validation SSerr vs other
	diagnostic measures
In-Reply-To: <CAJRR3XOcEye93Wi2MFj1+tM6BAcEM6veWsMDbSkdf+1fuXAx5A@mail.gmail.com>
References: <CAJRR3XOcEye93Wi2MFj1+tM6BAcEM6veWsMDbSkdf+1fuXAx5A@mail.gmail.com>
Message-ID: <533CFE2F.7010809@uni-muenster.de>

They are very different things. SSErr is an attribute of a variogram
model fitted to a sample variogram that describes how well this fit
went. Cross validation statistics tell you how well prediction went in a
cross validation context, under a given variogram model.

You can for instance multiply the variances in your variogram model with
a constang, e.g. change vgm(1, "Exp", 3, 1) with vgm(2, "Exp", 3, 2) and
you'd see completely identical predictions, but SSErr values typically
be very different.

On 04/02/2014 11:37 PM, Moshood Agba Bakare wrote:
> Dear All,
> Could any one tell me the difference between SSerr (Sum of Squares error)
> differs from other gstat krige.cv cross validation diagnostic measures such
> as mean error (ME), root of means square error (RMSE) and means square
> deviation error (MSDR) of residual to kriging variance?
> 
> is SSerr appropriate statistics for validating a model? Is SSerr means sum
> of squares of difference between actual values and predicted values of
> fitted model? in MSDR, what is difference between residual and kriging
> variance? formula for computing the kriging variance.
> 
> Thanks
> Moshood
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140403/50c110ee/attachment.bin>

From au232 at medschl.cam.ac.uk  Thu Apr  3 12:12:58 2014
From: au232 at medschl.cam.ac.uk (Alvaro Ullrich)
Date: Thu, 3 Apr 2014 10:12:58 +0000
Subject: [R-sig-Geo] R-sig-Geo Digest, Vol 128, Issue 3
In-Reply-To: <mailman.12.1396519205.23393.r-sig-geo@r-project.org>
References: <mailman.12.1396519205.23393.r-sig-geo@r-project.org>
Message-ID: <4F295760B4047D40A4B655C13B8B57B75E2DB3D0@me-mbx1.medschl.cam.ac.uk>


No lo he dicho xo resulta evidente: las vacaciones en Mayo depende tb de lo de tu t?o... Mejor localizarle pronto.

-----Original Message-----
From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of r-sig-geo-request at r-project.org
Sent: 03 April 2014 11:00
To: r-sig-geo at r-project.org
Subject: R-sig-Geo Digest, Vol 128, Issue 3

Send R-sig-Geo mailing list submissions to
	r-sig-geo at r-project.org

To subscribe or unsubscribe via the World Wide Web, visit
	https://stat.ethz.ch/mailman/listinfo/r-sig-geo
or, via email, send a message with subject or body 'help' to
	r-sig-geo-request at r-project.org

You can reach the person managing the list at
	r-sig-geo-owner at r-project.org

When replying, please edit your Subject line so it is more specific
than "Re: Contents of R-sig-Geo digest..."


From acturcr at gmail.com  Fri Apr  4 03:54:07 2014
From: acturcr at gmail.com (CRUR)
Date: Thu, 3 Apr 2014 19:54:07 -0600
Subject: [R-sig-Geo] Recommended package to fit classes of nonseparable,
	spatio-temporal stationary covariance functions
Message-ID: <934BB2B5-9EDC-4E47-A6F6-2F079B07CC72@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140403/5c7353ad/attachment.pl>

From kridox at ymail.com  Fri Apr  4 04:48:02 2014
From: kridox at ymail.com (Pascal Oettli)
Date: Fri, 4 Apr 2014 11:48:02 +0900
Subject: [R-sig-Geo] Recommended package to fit classes of nonseparable,
 spatio-temporal stationary covariance functions
In-Reply-To: <934BB2B5-9EDC-4E47-A6F6-2F079B07CC72@gmail.com>
References: <934BB2B5-9EDC-4E47-A6F6-2F079B07CC72@gmail.com>
Message-ID: <CAAcyNCzMpb0VCT3NKeWjt74FUfsYkn1P81HdRzS=64kAaZk7yw@mail.gmail.com>

Hello,

library(sos)
findFn('Cressie Huang')

Regards,
Pascal


On Fri, Apr 4, 2014 at 10:54 AM, CRUR <acturcr at gmail.com> wrote:
> Hi,
>
>         I'm currently working on ozone concentrations for my master's thesis using spatio-temporal models.  I already cleaned the data and loaded into the STFDF class of the "spacetime" package in order to visualize it.  So, I'm currently in the prediction phase.
>
>         Since there are a lot of packages described on the CRAN's SpatioTemporal task view, and I'm only interested in fit the spatio-temporal stationary covariance functions suggested in the paper "Clases of Nonseparable, Spatio-Temporal Stationary Covariance Functions" by Noel Cressie and Hsin-Cheng Huang, I want to know if already exists a package with these classes or a package that allows me to define these models?
>
>         My last resource is to program by myself (they used the weighted-least-squares method), but I want to avoid reinventing the wheel if something like this already exists.
>
> Thank you in advance.
>
> Cesar
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Pascal Oettli
Project Scientist
JAMSTEC
Yokohama, Japan


From mauriziomarchi85 at gmail.com  Fri Apr  4 13:37:07 2014
From: mauriziomarchi85 at gmail.com (Maurizio Marchi)
Date: Fri, 4 Apr 2014 13:37:07 +0200
Subject: [R-sig-Geo] Kriging: which and when
Message-ID: <CANJhsN3M6=J_HWxDmOOx+zQD_7pTjsfDUh02FifM9O2npSODSA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140404/3bf30b95/attachment.pl>

From Emma.Brooks at soton.ac.uk  Fri Apr  4 16:20:59 2014
From: Emma.Brooks at soton.ac.uk (Brooks E.G.E.)
Date: Fri, 4 Apr 2014 14:20:59 +0000
Subject: [R-sig-Geo] Error in function to negative buffer a
 SpatialPolygonsDataFrame - 'names' attribute must be the same length as the
 vector
Message-ID: <F075976912A9094987C85F2ADA48393A4DEDFF9B@SRV00046.soton.ac.uk>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140404/1de05c2d/attachment.pl>

From jon.skoien at jrc.ec.europa.eu  Fri Apr  4 17:28:40 2014
From: jon.skoien at jrc.ec.europa.eu (Jon Olav Skoien)
Date: Fri, 04 Apr 2014 17:28:40 +0200
Subject: [R-sig-Geo] Error in function to negative buffer a
 SpatialPolygonsDataFrame - 'names' attribute must be the same length as the
 vector
In-Reply-To: <F075976912A9094987C85F2ADA48393A4DEDFF9B@SRV00046.soton.ac.uk>
References: <F075976912A9094987C85F2ADA48393A4DEDFF9B@SRV00046.soton.ac.uk>
Message-ID: <533ECFA8.3080008@jrc.ec.europa.eu>

Emma,

I don't know what has changed in rgeos, anyway, your current problem 
seems to be the way you assign the results of gBuffer to a list. gBuffer 
will frequently return NULL (probably the vanishing polygons), which 
removes this element from the list if you try to assign. A simplified 
example:

aa <- vector("list",10)
for (i in 1:10) {
   aa[[i]] <- NULL
   print(paste(i, length(aa)))
}
aa

You can for example try to replace the assignment with
   bb <- gBuffer(spdf[i,], width=widths[i], capStyle="ROUND")
     if (!is.null(bb)) buffs[[i]] = bb
  although you will also have to update your Filter function, as bbox 
will not work on NULL-objects.

Best wishes,
Jon



On 04-Apr-14 16:20, Brooks E.G.E. wrote:
> Dear List Members
>
> Several months ago I wrote a code to buffer a SpatialPolygonsDataFrame. Each attribute of the SPDF needed to be buffered by a different amount (defined by one of the columns within the SPDF), some of which were negative. Some of the negative buffers were large enough to warrant the vanishing of that particular polygon. Since gBuffer on its own could not deal with these aspects, the code included a function which would buffer each polygon individually, add the outputs to a list, remove any features which no longer existed, then convert it back to a SPDF. However I have come back to my code and it no longer works with negative buffers, even on the original datasets. It now produces the following error:
>
> Error in names(buffs)[i] <- ID[i] :
>    'names' attribute [1598] must be the same length as the vector [1597]
>
> even though the length of the SPDF is 1747. It does however still work for positive only buffers. The only thing I can think of is that gBuffer has been updated and now deals with vanishing features differently but I have not been able to adapt the code to make it work. Since all elements of the function come from the same object I don't understand how attributes are ending up at different lengths. Also, if I manually do the function step by step, the attributes remain at 1747 and I am not able to reproduce the same error so I am very confused.
>
> Here is a reproduction of the code:
>
> library(Guerry)
> data(gfrance)
>
> bufferby <- function(spdf,widths,ID){
>    library(rgeos)
>    #Create empty buffer list based on spdf
>    buffs<-vector("list",length(spdf))
>    #For every item in spdf,
>    for(i in seq_len(length(spdf))){
>      #Loop buffer each polygon individually based on widths, and add to 'list'
>      buffs[[i]] <- gBuffer(spdf[i,], width=widths[i], capStyle="ROUND")
>      #Name each object in list by ID
>      names(buffs)[i] <- ID[i]
>    }
>    #Filter results by those that worked (i.e. exclude any 'vanished' buffers)
>    buffs=Filter(function(x){!is.null(bbox(x))},buffs)
>    #Convert the filtered results to SP
>    buffsSP<-SpatialPolygons(lapply(1:length(buffs), function(i) {
>      Pol <- slot(buffs[[i]], "polygons")[[1]]
>      #Add names to be able to link to other datasets
>      slot(Pol, "ID") <- names(buffs)[i]
>      Pol
>    }))
>    #Project output (SP) based on input (spdf)
>    proj4string(buffsSP)<-CRS(projection(spdf))
>    buffsSP
> }
>
> #Create widths defining column, including negatives
> gfrance$buffwid<- runif(length(gfrance), min=-200000, max=20000)
>
> newbuffs<-bufferby(gfrance,gfrance$buffwid,gfrance$Department)
> plot(newbuffs)
>
> If I define "widths" as a column with only positive values it works fine, but it no longer works if any of the negative features vanish.
>
> N.B. This function should (and did) also work for SpatialPoints.
>
> Many thanks for any help, and your time.
>
> Emma
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


-- 
Jon Olav Sk?ien
Joint Research Centre - European Commission
Institute for Environment and Sustainability (IES)
Land Resource Management Unit

Via Fermi 2749, TP 440,  I-21027 Ispra (VA), ITALY

jon.skoien at jrc.ec.europa.eu
Tel:  +39 0332 789205

Disclaimer: Views expressed in this email are those of the individual and do not necessarily represent official views of the European Commission.


From tephilippi at gmail.com  Fri Apr  4 18:39:29 2014
From: tephilippi at gmail.com (Tom Philippi)
Date: Fri, 4 Apr 2014 09:39:29 -0700
Subject: [R-sig-Geo] Error in function to negative buffer a
 SpatialPolygonsDataFrame - 'names' attribute must be the same length as the
 vector
In-Reply-To: <533ECFA8.3080008@jrc.ec.europa.eu>
References: <F075976912A9094987C85F2ADA48393A4DEDFF9B@SRV00046.soton.ac.uk>
	<533ECFA8.3080008@jrc.ec.europa.eu>
Message-ID: <CALyPt8wxL=OF3XcrOuOaOALrB6yKQ7W0PTiXsyqRPjHeotXeXQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140404/ff8a4ff4/attachment.pl>

From yuster0 at gmail.com  Fri Apr  4 19:25:49 2014
From: yuster0 at gmail.com (Yuster Ronoh)
Date: Fri, 4 Apr 2014 20:25:49 +0300
Subject: [R-sig-Geo] Filtering shapefile to come up with only one county
Message-ID: <CAP6hh3-UiY90pHCJ9_jiWEfqkQcgYZUN5mvYLqkXwgFidjAHjQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140404/89a24ac0/attachment.pl>

From bakare at ualberta.ca  Fri Apr  4 19:47:38 2014
From: bakare at ualberta.ca (Moshood Agba Bakare)
Date: Fri, 4 Apr 2014 11:47:38 -0600
Subject: [R-sig-Geo] gstat: Warning message for cross validation linear model
Message-ID: <CAJRR3XO=8XtvB9pRYkB+5pHRqksaPpuuZxgY2Wm3xzJQ67V1hA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140404/0c4bc452/attachment.pl>

From bakare at ualberta.ca  Fri Apr  4 20:05:14 2014
From: bakare at ualberta.ca (Moshood Agba Bakare)
Date: Fri, 4 Apr 2014 12:05:14 -0600
Subject: [R-sig-Geo] gstat: model fitting vs cross validation
Message-ID: <CAJRR3XMG+f43no5MDJ2cRdp=KR3kO=nsvFeMDoUDagdBMpKt=Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140404/ec73deaf/attachment.pl>

From kmcoulib at gmail.com  Sat Apr  5 00:16:56 2014
From: kmcoulib at gmail.com (Kapo Coulibaly)
Date: Fri, 4 Apr 2014 18:16:56 -0400
Subject: [R-sig-Geo] Filtering shapefile to come up with only one county
In-Reply-To: <CAP6hh3-UiY90pHCJ9_jiWEfqkQcgYZUN5mvYLqkXwgFidjAHjQ@mail.gmail.com>
References: <CAP6hh3-UiY90pHCJ9_jiWEfqkQcgYZUN5mvYLqkXwgFidjAHjQ@mail.gmail.com>
Message-ID: <CANcefXaapeVfQZMD0AZkgsZVh=2-TrkyPYitp1uppXhtrcLjUQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140404/5e2ee653/attachment.pl>

From yuster0 at gmail.com  Sat Apr  5 07:17:45 2014
From: yuster0 at gmail.com (Yuster Ronoh)
Date: Sat, 5 Apr 2014 08:17:45 +0300
Subject: [R-sig-Geo] Filtering shapefile to come up with only one county
In-Reply-To: <CANcefXaapeVfQZMD0AZkgsZVh=2-TrkyPYitp1uppXhtrcLjUQ@mail.gmail.com>
References: <CAP6hh3-UiY90pHCJ9_jiWEfqkQcgYZUN5mvYLqkXwgFidjAHjQ@mail.gmail.com>
	<CANcefXaapeVfQZMD0AZkgsZVh=2-TrkyPYitp1uppXhtrcLjUQ@mail.gmail.com>
Message-ID: <CAP6hh3_WPXKNLyNSUfV-bhx-WN0Aqey7++pcj9QKRYDMxPq_vw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140405/ec6367d4/attachment.pl>

From Roger.Bivand at nhh.no  Sat Apr  5 12:18:03 2014
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 5 Apr 2014 12:18:03 +0200
Subject: [R-sig-Geo] Filtering shapefile to come up with only one county
In-Reply-To: <CAP6hh3_WPXKNLyNSUfV-bhx-WN0Aqey7++pcj9QKRYDMxPq_vw@mail.gmail.com>
References: <CAP6hh3-UiY90pHCJ9_jiWEfqkQcgYZUN5mvYLqkXwgFidjAHjQ@mail.gmail.com>
	<CANcefXaapeVfQZMD0AZkgsZVh=2-TrkyPYitp1uppXhtrcLjUQ@mail.gmail.com>
	<CAP6hh3_WPXKNLyNSUfV-bhx-WN0Aqey7++pcj9QKRYDMxPq_vw@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1404051214080.14928@reclus.nhh.no>

On Sat, 5 Apr 2014, Yuster Ronoh wrote:

> Thanks Gordon and Kapo. Gordon I tried your code and it plot the whole
> country  but for Kapo it work well and I manage to plot Nakuru county but I
> still have problem in exporting shapefile here in the error message:
>
> writeOGR(Nakuru,dsn="C://Users/symon/Desktop/gis/",layer="Nakuru",driver="ESRI
> Shapefile")Error in writeOGR(Nakuru, dsn =
> "C://Users/symon/Desktop/gis/", layer = "Nakuru",  :
>  Creation of output file failed

This is a known problem under Windows, the dsn should read:

"C:/Users/symon/Desktop/gis"

with no trailing directory separator. Can be replicated with:

library(rgdal)
td <- tempdir()
dsn <- system.file("vectors", package = "rgdal")[1]
cities <- readOGR(dsn=dsn, layer="cities")
td
writeOGR(cities, paste(td, "/", sep=""), "cities",
  driver="ESRI Shapefile")
# Error in writeOGR(cities, paste(td, "/", sep = ""), "cities",
#  driver = "ESRI Shapefile") :
#  Creation of output file failed
writeOGR(cities, td, "cities", driver="ESRI Shapefile")
# works

Roger

>
>
>
>
> On Sat, Apr 5, 2014 at 1:16 AM, Kapo Coulibaly <kmcoulib at gmail.com> wrote:
>
>> Something like this works for me:
>> counties<-readOGR(dsn=""C://Users/symon/Desktop/gis/",layer="counties")
>> Nakuru<-subset(counties,COUNTY_NAM=="Nakuru") # make sure the name and the
>> content of the columns are spelled correctly
>> plot(Nakuru) # Plots the county map
>>
>>
>> You can write the shapefile of Nakuru county with:
>> writeOGR(Nakuru,dsn=""C://Users/symon/Desktop/gis/",layer="Nakuru",driver="ESRI
>> Shapefile")
>>
>>
>>
>> On Fri, Apr 4, 2014 at 1:25 PM, Yuster Ronoh <yuster0 at gmail.com> wrote:
>>
>>> Dear List members
>>> I have a Kenya shapefile with counties.I try to come up with Nakuru county
>>> map and I try with the below code and got an error.How do i  sub-set to
>>> come up with Nakuru shapefile from the Kenya shapefile
>>> here is my code:
>>>
>>>> library(maps)
>>>
>>>> library(maptools)
>>>
>>>> library(sp)
>>>
>>>> library(rgdal)
>>>
>>>> library(ggplot2)
>>>
>>>> counties<-readShapePoly("C://Users/symon/Desktop/gis/counties.shp")
>>>
>>>> str(counties)
>>>
>>>> Nakuru <- fortify(counties, region = "COUNTY_NAM")
>>>> str(Nakuru)
>>>> unique(counties at data$COUNTY_NAM)
>>>
>>>> class(counties)
>>>
>>>> counties at data = counties at data[counties at data$COUNTY_NAME != "NAKURU",]
>>>
>>>> plot(counties at data)Error in plot.window(...) : need finite 'xlim'
>>> valuesIn addition: Warning messages:1: In min(x) : no non-missing arguments
>>> to min; returning Inf2: In max(x) : no non-missing arguments to max;
>>> returning -Inf3: In min(x) : no non-missing arguments to min; returning
>>> Inf4: In max(x) : no non-missing arguments to max; returning -Inf
>>>
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From yuster0 at gmail.com  Sat Apr  5 13:47:02 2014
From: yuster0 at gmail.com (Yuster Ronoh)
Date: Sat, 5 Apr 2014 14:47:02 +0300
Subject: [R-sig-Geo] Filtering shapefile to come up with only one county
In-Reply-To: <alpine.LRH.2.03.1404051214080.14928@reclus.nhh.no>
References: <CAP6hh3-UiY90pHCJ9_jiWEfqkQcgYZUN5mvYLqkXwgFidjAHjQ@mail.gmail.com>
	<CANcefXaapeVfQZMD0AZkgsZVh=2-TrkyPYitp1uppXhtrcLjUQ@mail.gmail.com>
	<CAP6hh3_WPXKNLyNSUfV-bhx-WN0Aqey7++pcj9QKRYDMxPq_vw@mail.gmail.com>
	<alpine.LRH.2.03.1404051214080.14928@reclus.nhh.no>
Message-ID: <CAP6hh39FS4mAF=r7hDPLwxc4Wu=Stk7LDgu-aORkKKWzp-3pnQ@mail.gmail.com>

Thanks rogers I figured out with the code
> writeOGR(Nakuru, dsn= "gis", layer="Nakuru". driver="ESRI Shapefile")

On 4/5/14, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> On Sat, 5 Apr 2014, Yuster Ronoh wrote:
>
>> Thanks Gordon and Kapo. Gordon I tried your code and it plot the whole
>> country  but for Kapo it work well and I manage to plot Nakuru county but
>> I
>> still have problem in exporting shapefile here in the error message:
>>
>> writeOGR(Nakuru,dsn="C://Users/symon/Desktop/gis/",layer="Nakuru",driver="ESRI
>> Shapefile")Error in writeOGR(Nakuru, dsn =
>> "C://Users/symon/Desktop/gis/", layer = "Nakuru",  :
>>  Creation of output file failed
>
> This is a known problem under Windows, the dsn should read:
>
> "C:/Users/symon/Desktop/gis"
>
> with no trailing directory separator. Can be replicated with:
>
> library(rgdal)
> td <- tempdir()
> dsn <- system.file("vectors", package = "rgdal")[1]
> cities <- readOGR(dsn=dsn, layer="cities")
> td
> writeOGR(cities, paste(td, "/", sep=""), "cities",
>   driver="ESRI Shapefile")
> # Error in writeOGR(cities, paste(td, "/", sep = ""), "cities",
> #  driver = "ESRI Shapefile") :
> #  Creation of output file failed
> writeOGR(cities, td, "cities", driver="ESRI Shapefile")
> # works
>
> Roger
>
>>
>>
>>
>>
>> On Sat, Apr 5, 2014 at 1:16 AM, Kapo Coulibaly <kmcoulib at gmail.com>
>> wrote:
>>
>>> Something like this works for me:
>>> counties<-readOGR(dsn=""C://Users/symon/Desktop/gis/",layer="counties")
>>> Nakuru<-subset(counties,COUNTY_NAM=="Nakuru") # make sure the name and
>>> the
>>> content of the columns are spelled correctly
>>> plot(Nakuru) # Plots the county map
>>>
>>>
>>> You can write the shapefile of Nakuru county with:
>>> writeOGR(Nakuru,dsn=""C://Users/symon/Desktop/gis/",layer="Nakuru",driver="ESRI
>>> Shapefile")
>>>
>>>
>>>
>>> On Fri, Apr 4, 2014 at 1:25 PM, Yuster Ronoh <yuster0 at gmail.com> wrote:
>>>
>>>> Dear List members
>>>> I have a Kenya shapefile with counties.I try to come up with Nakuru
>>>> county
>>>> map and I try with the below code and got an error.How do i  sub-set to
>>>> come up with Nakuru shapefile from the Kenya shapefile
>>>> here is my code:
>>>>
>>>>> library(maps)
>>>>
>>>>> library(maptools)
>>>>
>>>>> library(sp)
>>>>
>>>>> library(rgdal)
>>>>
>>>>> library(ggplot2)
>>>>
>>>>> counties<-readShapePoly("C://Users/symon/Desktop/gis/counties.shp")
>>>>
>>>>> str(counties)
>>>>
>>>>> Nakuru <- fortify(counties, region = "COUNTY_NAM")
>>>>> str(Nakuru)
>>>>> unique(counties at data$COUNTY_NAM)
>>>>
>>>>> class(counties)
>>>>
>>>>> counties at data = counties at data[counties at data$COUNTY_NAME != "NAKURU",]
>>>>
>>>>> plot(counties at data)Error in plot.window(...) : need finite 'xlim'
>>>> valuesIn addition: Warning messages:1: In min(x) : no non-missing
>>>> arguments
>>>> to min; returning Inf2: In max(x) : no non-missing arguments to max;
>>>> returning -Inf3: In min(x) : no non-missing arguments to min; returning
>>>> Inf4: In max(x) : no non-missing arguments to max; returning -Inf
>>>>
>>>>
>>>>         [[alternative HTML version deleted]]
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>
>>>
>>
>> 	[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 91 00
> e-mail: Roger.Bivand at nhh.no
>
>


From rgenevest at free.fr  Sat Apr  5 14:35:59 2014
From: rgenevest at free.fr (remissssss)
Date: Sat, 5 Apr 2014 05:35:59 -0700 (PDT)
Subject: [R-sig-Geo] Incompatible geometry error with a .kml file using
	readOGR()
Message-ID: <1396701359106-7586135.post@n2.nabble.com>

Hello,
I got difficulties with reading a kml file, using rgdal package on a linux
OS. This file has been downloaded on the European Soil Database website (
http://eusoils.jrc.ec.europa.eu/ESDB_Archive/ESDBv3/googleearth/index.cfm
<http://eusoils.jrc.ec.europa.eu/ESDB_Archive/ESDBv3/googleearth/index.cfm>  
 What does "Incompatible geometry" refer to? and how can I solve this pb
without having to edit the .kml in a GIS software (if possible) ?

Below my code : 

> library(rgdal)
Loading required package: sp
rgdal: version: 0.8-16, (SVN revision 498)
Geospatial Data Abstraction Library extensions to R successfully loaded
Loaded GDAL runtime: GDAL 1.10.0, released 2013/04/24
Path to GDAL shared files: /usr/share/gdal/1.10
Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
Path to PROJ.4 shared files: (autodetected)

> ogrListLayers("/windows/BDD_sol/BDD_esdb_kml/kml/EAWC_SUB.kml")
[1] "EAWC_SUB:Subsoil easily avail.water capac."

> readOGR(dsn="/windows/BDD_sol/BDD_esdb_kml/kml/EAWC_SUB.kml",layer="EAWC_SUB:Subsoil
> easily avail.water capac.")
OGR data source with driver: KML 
Source: "/windows/BDD_sol/BDD_esdb_kml/kml/EAWC_SUB.kml", layer:
"EAWC_SUB:Subsoil easily avail.water capac."
with 6 features and 2 fields
Feature type: wkbGeometryCollection with 3 dimensions
Error in readOGR(dsn = "/windows/BDD_sol/BDD_esdb_kml/kml/EAWC_SUB.kml",  : 
  *Incompatible geometry: 7*
In addition: Warning messages:
1: In readOGR(dsn = "/windows/BDD_sol/BDD_esdb_kml/kml/EAWC_SUB.kml",  :
  eType not chosen
2: In readOGR(dsn = "/windows/BDD_sol/BDD_esdb_kml/kml/EAWC_SUB.kml",  :
  eType not chosen
3: In readOGR(dsn = "/windows/BDD_sol/BDD_esdb_kml/kml/EAWC_SUB.kml",  :
  eType not chosen
4: In readOGR(dsn = "/windows/BDD_sol/BDD_esdb_kml/kml/EAWC_SUB.kml",  :
  eType not chosen
5: In readOGR(dsn = "/windows/BDD_sol/BDD_esdb_kml/kml/EAWC_SUB.kml",  :
  eType not chosen
6: In readOGR(dsn = "/windows/BDD_sol/BDD_esdb_kml/kml/EAWC_SUB.kml",  :
  eType not chosen

and some additional information about my R session :

> sessionInfo()
R version 3.1.0 beta (2014-03-28 r65330)
Platform: x86_64-pc-linux-gnu (64-bit)

locale:
 [1] LC_CTYPE=en_GB.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_GB.UTF-8        LC_COLLATE=en_GB.UTF-8    
 [5] LC_MONETARY=en_GB.UTF-8    LC_MESSAGES=en_GB.UTF-8   
 [7] LC_PAPER=en_GB.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_GB.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] rgdal_0.8-16 sp_1.0-14   

loaded via a namespace (and not attached):
[1] grid_3.1.0      lattice_0.20-27 tools_3.1.0



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Incompatible-geometry-error-with-a-kml-file-using-readOGR-tp7586135.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Roger.Bivand at nhh.no  Sat Apr  5 14:45:40 2014
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 5 Apr 2014 14:45:40 +0200
Subject: [R-sig-Geo] Changing the units of shape file areas
In-Reply-To: <1396123774386-7586083.post@n2.nabble.com>
References: <1396123774386-7586083.post@n2.nabble.com>
Message-ID: <alpine.LRH.2.03.1404051418200.15186@reclus.nhh.no>

On Sat, 29 Mar 2014, laanders wrote:

> Hello!
>
> I've been working with Philippine shape files I found at:
> http://www.philgis.org/freegisdata.htm
> Specifically, I've been looking at the barangay level shape files.  I'm
> trying to get the area of each barangay so I can bet the population density
> and plot a heat map.  Unfortunately, I don't understand the units of these
> areas.

Thanks for providing a reproducible example:

library(rgdal)
bg <- readOGR(".", "Barangays")
ZCB <- bg[bg$NAME_2=="Zamboanga City",]
proj4string(ZCB)
plot(ZCB, axes=TRUE)
bbox(ZCB)

The imported data is in geographical coordinates (WGS84 is the datum, it 
is not a projection), so the "areas" are in decimal degrees, which is not 
helpful. To calculate areas, you must project the features, and to do that 
you must find a relevant projection. Using the EPSG table:

EPSG <- make_EPSG()
EPSG[grep("Philippines", EPSG$note),]

and searching around, it appears that 3124 # PRS92 / Philippines zone 4 
may be appropriate - others might also be:

CRS("+init=epsg:3124")
ZCBtm <- spTransform(ZCB, CRS("+init=epsg:3124"))
plot(ZCBtm, axes=TRUE)

with units in metres. To get the areas:

library(rgeos)
AR <- gArea(ZCBtm, byid=TRUE)
summary(AR)

and AR (here in square metres) can be added as a variable into ZCB:

ZCB$area <- AR

if you want to continue using the original unprojected dataset.

If you choose another projection and datum, the areas may vary:

ZCButm <- spTransform(ZCB, CRS("+proj=utm +zone=51 +datum=WGS84"))
summary(abs(AR - gArea(ZCButm, byid=TRUE)))

Hope this helps,

Roger

> Here's the R code I'm using to get the areas: 
>
> ###########################
> BarangaysPlot <- readOGR("~/Barangays", layer = "Barangays?) 
> ZCB <- BarangaysPlot[BarangaysPlot$NAME_2=="Zamboanga City?,]  ## Subsetting
> the shape file to get ZamboCity
>
> sapply(slot(ZCB, "polygons"), slot, "area?)  ## Get the areas
>
> [1] 1.392389e-04 1.946191e-04 7.702360e-05 2.711882e-03 4.610627e-05
> 5.659337e-05
> [7] 6.926905e-05 5.678706e-05 8.203009e-04 1.639304e-03 1.336925e-03
> 4.909287e-03
> ###########################
>
> Since the areas are so small, I thought maybe there were either holes in the
> shape files or I am dealing with the degree coordinate system.  The
> coordinates are planar, so we're good there.  So to see if there were holes
> I used the code provided by Dr. Bivand in an earlier post, I found there
> were no holes.  According to the website, the current projection for these
> shape files is WGS 1984.  So I then looked at spTransform() using the code I
> mentioned earlier by Dr. Bivand.
>
> ###########################
> ## epsg for WGS 1984 is 4326
> ZCBareas <- spTransform(ZCB, CRS("+init=epsg:4326")) 
> ## Gives some ?non-simple polygon objects"
> sapply(slot(ZCBareas, "polygons"), function(x) length(slot(x, "Polygons"))) 
>
> ## Gives any holes in the polygons; there are none
> sapply(slot(ZCBareas, "polygons"), function(x) { 
> xi <- slot(x, "Polygons") 
> any(sapply(xi, slot, "hole")) 
> }) 
>
> ## Gives the same areas as before
> sapply(slot(ZCBareas, "polygons"), slot, "area?) 
> ###########################
>
> Again, I'm just trying to find the areas in a unit I can understand to apply
> to population densities. 
> Any help would be much appreciated!! 
> Lew
>
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Changing-the-units-of-shape-file-areas-tp7586083.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no

From Roger.Bivand at nhh.no  Sat Apr  5 15:54:32 2014
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 5 Apr 2014 15:54:32 +0200
Subject: [R-sig-Geo] Incompatible geometry error with a .kml file using
 readOGR()
In-Reply-To: <1396701359106-7586135.post@n2.nabble.com>
References: <1396701359106-7586135.post@n2.nabble.com>
Message-ID: <alpine.LRH.2.03.1404051457280.15186@reclus.nhh.no>

On Sat, 5 Apr 2014, remissssss wrote:

> Hello,
> I got difficulties with reading a kml file, using rgdal package on a linux
> OS. This file has been downloaded on the European Soil Database website (
> http://eusoils.jrc.ec.europa.eu/ESDB_Archive/ESDBv3/googleearth/index.cfm
> <http://eusoils.jrc.ec.europa.eu/ESDB_Archive/ESDBv3/googleearth/index.cfm>
> What does "Incompatible geometry" refer to? and how can I solve this pb
> without having to edit the .kml in a GIS software (if possible) ?

Thanks for providing enough information to reproduce (more or less, the 
KMZ file had to be uncompressed into a large KML file):

library(rgdal)
ogrListLayers("DOC.kml")
ogrInfo(dsn="DOC.kml", layer="EAWC_SUB:Subsoil easily avail.water capac.")

which shows:

Source: "DOC.kml", layer: "EAWC_SUB:Subsoil easily avail.water capac."
Driver: KML number of rows 6
Feature type: wkbGeometryCollection with 3 dimensions
Extent: (-10.56697 34.83962) - (31.58095 70.09262)
CRS: +proj=longlat +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +no_defs
Number of fields: 2
          name type length typeName
1        Name    4      0   String
2 Description    4      0   String

This shows two problems: wkbGeometryCollection which cannot be read into 
any sp class, and potentially 3 dimensions, as only SpatialPoints may be 
3D (looking at the details in the unpacked file, the third dimension is 
spurious, and the geometries are Polygon or MultiPolygon). I didn't 
succeed in reading it into GRASS 6.4 either (using the same OGR library).

The underlying problem is that the real data source is:

http://eusoils.jrc.ec.europa.eu/ESDB_Archive/ESDB_Data_Distribution/ESDB_data.html

and is not free to download without other steps. The files made available 
are really only intended to be displayed in Google Earth. For data 
handling and analysis, either the provider should make files available in 
a more usable format, or at least improve the production of KMZ files so 
that they are not in the "catch-all" category. If the data are actually in 
3D vector form (a volume), very few applications can handle them. They do 
not appear to be volumes, as the Name: field has 6 values:

  High (140 - 190 mm/m)    :6195
  Low ( < 100 mm/m)        :3565
  Medium (100 - 140 mm/m)  :4117
  No data or not applicable:4191
  Very high ( > 190 mm/m)  :2673
  Very low ( ~ 0 mm/m)     :2067

(the counts are constituent polygons).

Using the OGR command line utility:

ogr2ogr -f "ESRI Shapefile" DOC.shp -explodecollections DOC.kml

I got a shapefile which may be similar to the input:

> ogrInfo("DOC.shp", "DOC")
Source: "DOC.shp", layer: "DOC"
Driver: ESRI Shapefile number of rows 22808
Feature type: wkbPolygon with 2 dimensions
Extent: (-10.56697 34.83962) - (31.58095 70.09262)
CRS: +proj=longlat +datum=WGS84 +no_defs
LDID: 87
Number of fields: 2
         name type length typeName
1       Name    4     80   String
2 Descriptio    4     80   String

but the geometries read into R are not valid (checked with GEOS), and 
cannot be plotted, so ogr2ogr hasn't managed to make fish of fish soup.

For analysis, you need the actual polygons in an appropriate format; you 
should approach the data provider and persuade them to open data access 
properly. Maybe they can be forced out of the fish soup, but it would be 
much easier if the fish had not been smashed up first. The GML and SHP 
representations of the same data are an order of magnitude smaller too, 
KMZ and KML are big space-wasters.

Hope this clarifies,

Roger


>
> Below my code :
>
>> library(rgdal)
> Loading required package: sp
> rgdal: version: 0.8-16, (SVN revision 498)
> Geospatial Data Abstraction Library extensions to R successfully loaded
> Loaded GDAL runtime: GDAL 1.10.0, released 2013/04/24
> Path to GDAL shared files: /usr/share/gdal/1.10
> Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
> Path to PROJ.4 shared files: (autodetected)
>
>> ogrListLayers("/windows/BDD_sol/BDD_esdb_kml/kml/EAWC_SUB.kml")
> [1] "EAWC_SUB:Subsoil easily avail.water capac."
>
>> readOGR(dsn="/windows/BDD_sol/BDD_esdb_kml/kml/EAWC_SUB.kml",layer="EAWC_SUB:Subsoil
>> easily avail.water capac.")
> OGR data source with driver: KML
> Source: "/windows/BDD_sol/BDD_esdb_kml/kml/EAWC_SUB.kml", layer:
> "EAWC_SUB:Subsoil easily avail.water capac."
> with 6 features and 2 fields
> Feature type: wkbGeometryCollection with 3 dimensions
> Error in readOGR(dsn = "/windows/BDD_sol/BDD_esdb_kml/kml/EAWC_SUB.kml",  :
>  *Incompatible geometry: 7*
> In addition: Warning messages:
> 1: In readOGR(dsn = "/windows/BDD_sol/BDD_esdb_kml/kml/EAWC_SUB.kml",  :
>  eType not chosen
> 2: In readOGR(dsn = "/windows/BDD_sol/BDD_esdb_kml/kml/EAWC_SUB.kml",  :
>  eType not chosen
> 3: In readOGR(dsn = "/windows/BDD_sol/BDD_esdb_kml/kml/EAWC_SUB.kml",  :
>  eType not chosen
> 4: In readOGR(dsn = "/windows/BDD_sol/BDD_esdb_kml/kml/EAWC_SUB.kml",  :
>  eType not chosen
> 5: In readOGR(dsn = "/windows/BDD_sol/BDD_esdb_kml/kml/EAWC_SUB.kml",  :
>  eType not chosen
> 6: In readOGR(dsn = "/windows/BDD_sol/BDD_esdb_kml/kml/EAWC_SUB.kml",  :
>  eType not chosen
>
> and some additional information about my R session :
>
>> sessionInfo()
> R version 3.1.0 beta (2014-03-28 r65330)
> Platform: x86_64-pc-linux-gnu (64-bit)
>
> locale:
> [1] LC_CTYPE=en_GB.UTF-8       LC_NUMERIC=C
> [3] LC_TIME=en_GB.UTF-8        LC_COLLATE=en_GB.UTF-8
> [5] LC_MONETARY=en_GB.UTF-8    LC_MESSAGES=en_GB.UTF-8
> [7] LC_PAPER=en_GB.UTF-8       LC_NAME=C
> [9] LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_GB.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] rgdal_0.8-16 sp_1.0-14
>
> loaded via a namespace (and not attached):
> [1] grid_3.1.0      lattice_0.20-27 tools_3.1.0
>
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Incompatible-geometry-error-with-a-kml-file-using-readOGR-tp7586135.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From yuster0 at gmail.com  Sat Apr  5 17:12:57 2014
From: yuster0 at gmail.com (Yuster Ronoh)
Date: Sat, 5 Apr 2014 18:12:57 +0300
Subject: [R-sig-Geo] Merging shapefiles to one
Message-ID: <CAP6hh39E_iLbB7hsMmFJyJomDso3C6H_nu34RXUJX=+FegKceQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140405/f2185dcd/attachment.pl>

From mdsumner at gmail.com  Sun Apr  6 00:48:26 2014
From: mdsumner at gmail.com (Michael Sumner)
Date: Sun, 6 Apr 2014 08:48:26 +1000
Subject: [R-sig-Geo] Filtering shapefile to come up with only one county
In-Reply-To: <alpine.LRH.2.03.1404051214080.14928@reclus.nhh.no>
References: <CAP6hh3-UiY90pHCJ9_jiWEfqkQcgYZUN5mvYLqkXwgFidjAHjQ@mail.gmail.com>
	<CANcefXaapeVfQZMD0AZkgsZVh=2-TrkyPYitp1uppXhtrcLjUQ@mail.gmail.com>
	<CAP6hh3_WPXKNLyNSUfV-bhx-WN0Aqey7++pcj9QKRYDMxPq_vw@mail.gmail.com>
	<alpine.LRH.2.03.1404051214080.14928@reclus.nhh.no>
Message-ID: <CAAcGz98ofjtm6rW4zbE+V9Jb1KHA1yW9asNTEh6HLMhejLfrOw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140406/60755581/attachment.pl>

From kmcoulib at gmail.com  Sun Apr  6 14:07:23 2014
From: kmcoulib at gmail.com (Kapo Coulibaly)
Date: Sun, 6 Apr 2014 08:07:23 -0400
Subject: [R-sig-Geo] Merging shapefiles to one
In-Reply-To: <CAP6hh39E_iLbB7hsMmFJyJomDso3C6H_nu34RXUJX=+FegKceQ@mail.gmail.com>
References: <CAP6hh39E_iLbB7hsMmFJyJomDso3C6H_nu34RXUJX=+FegKceQ@mail.gmail.com>
Message-ID: <CANcefXbiEVz1c8xnxi0bKwK=AnY7t7LvjxE4uPLN+hqtxUqgzA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140406/55bd7b29/attachment.pl>

From mauriziomarchi85 at gmail.com  Sun Apr  6 23:08:16 2014
From: mauriziomarchi85 at gmail.com (Maurizio Marchi)
Date: Sun, 6 Apr 2014 23:08:16 +0200
Subject: [R-sig-Geo] Regression Kriging definition and packages
Message-ID: <CANJhsN2AxjFpgaasob+jvoN-zGjzKHaV7zG5CbOHcwafvyoPJA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140406/969d5caa/attachment.pl>

From emma.brooks at soton.ac.uk  Mon Apr  7 12:09:06 2014
From: emma.brooks at soton.ac.uk (Emma Brooks)
Date: Mon, 7 Apr 2014 03:09:06 -0700 (PDT)
Subject: [R-sig-Geo] Error in function to negative buffer a
 SpatialPolygonsDataFrame - 'names' attribute must be the same length as the
 vector
In-Reply-To: <CALyPt8wxL=OF3XcrOuOaOALrB6yKQ7W0PTiXsyqRPjHeotXeXQ@mail.gmail.com>
References: <F075976912A9094987C85F2ADA48393A4DEDFF9B@SRV00046.soton.ac.uk>
	<533ECFA8.3080008@jrc.ec.europa.eu>
	<CALyPt8wxL=OF3XcrOuOaOALrB6yKQ7W0PTiXsyqRPjHeotXeXQ@mail.gmail.com>
Message-ID: <1396865346609-7586142.post@n2.nabble.com>

Very interesting link to the negative buffering thread.

FYI sessionInfo:
R version 3.0.3 (2014-03-06)
Platform: x86_64-w64-mingw32/x64 (64-bit)
other attached packages:
[1] rgeos_0.3-4   raster_2.2-31 rgdal_0.8-16  sp_1.0-14

However you're absolutely right - now gBuffer has been updated to remove
NULL geometries I was just confusing matters by effectively trying to do the
same thing twice. 



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Error-in-function-to-negative-buffer-a-SpatialPolygonsDataFrame-names-attribute-must-be-the-same-lenr-tp7586124p7586142.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From amommendes at hotmail.com  Mon Apr  7 15:40:56 2014
From: amommendes at hotmail.com (amluiz)
Date: Mon, 7 Apr 2014 06:40:56 -0700 (PDT)
Subject: [R-sig-Geo] Join Count "correlogram"?
Message-ID: <1396878056902-7586143.post@n2.nabble.com>

Dear List,

I'm using an approach which calculates Manhattan distances in a matrix where
the columns represent the correlograms of species abundances, as follow:

require (vegan)
require (ncf)

data (mite)
data(mite.xy)
Y.hel<- decostand(mite, 'hel')
kk<- 10
inc<- 1
Correlog<- matrix(NA, nrow=ncol(Y.hel), ncol=kk)

for (i in 1:ncol(Y.hel)){
  cor<-correlog(x=mite.xy[,1], y=mite.xy[,2], z=Y.hel[,i], increment=inc,
resamp=1)
  nn<-  length (cor$correlation)
  Correlog[i,]<-as.matrix(cor$correlation)
  rownames(Correlog)<-colnames(Y.hel)
}
Correlog

However, my matrix is binary, i.e. rows are sites and columns species
presence (1) or absence (0) in a given site. 
1- Is there some alternative way to calculate an analogous matrix as in the
code above, with my presence/absence data? 
2- I've read that Moran's I does not deal with binary data, while Join Count
analysis would be more appropriated. But, is it possible generates
"correlograms" with join count analysis?
Any help will be appreciated.

Thanks in advance,

best,

Amom



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Join-Count-correlogram-tp7586143.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From peroe at myumanitoba.ca  Mon Apr  7 18:48:45 2014
From: peroe at myumanitoba.ca (Ellen Pero)
Date: Mon, 7 Apr 2014 09:48:45 -0700 (PDT)
Subject: [R-sig-Geo] adehabitatHR: kerneloverlap and kernelUD etc.
Message-ID: <1396889325456-7586144.post@n2.nabble.com>

Hello list members:

I have some questions regarding the kerneloverlap function within the
adehabitatHR package, and must offer my apologies if they seem rather base:

-I understand that the comparisons between the HR method for kerneloverlap
and MCP overlap are often misleading. Why doesn't this method make for a
good comparison to MCP area intersection?

-kerneloverlap function computes indices from sets of relocations, whereas
kerneloverlaphr computes indices from estUDs. Why or in what scenarios might
one be preferred over the other?

-I notice in working with the kerneloverlap function that the selected grid
size influences home range overlap. What is the best way to go about
selecting a biologically meaningful grid size?

-When trying to work with the kerneloverlaphr, I am given the warning "In vi
* vj : longer object length is not a multiple of shorter object length". I'm
afraid I can't say I really understand this statement (as each animal has
the same number of relocations) nor what the function is doing with the data
to account for it.

-I also realize that an issue with the kernelUD LSCV estimate is that the
cross-validation criterion sometimes fails to be minimized. But /why / is
this sometimes the case? i.e. what about the relocations might cause this?
And when LSCV method does fail to converge, I understand that the method can
no longer be reliably used. In such cases, is it best to default to another
hr estimate like MCP, or another method for selecting h (href or selective
h?)?

Any feedback would be greatly appreciated!
Ellen Pero
M.Sc. Candidate
Department of Biological Sciences
University of Manitoba
Winnipeg, MB



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/adehabitatHR-kerneloverlap-and-kernelUD-etc-tp7586144.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From bakare at ualberta.ca  Mon Apr  7 20:59:14 2014
From: bakare at ualberta.ca (Moshood Agba Bakare)
Date: Mon, 7 Apr 2014 12:59:14 -0600
Subject: [R-sig-Geo] gstat warning message from cross validate linear model
Message-ID: <CAJRR3XMir6n=++YitC6fq4BjaMhuz243fzdAai7eUAPgnce+AA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140407/557e894b/attachment.pl>

From Clement.Calenge at oncfs.gouv.fr  Mon Apr  7 21:00:52 2014
From: Clement.Calenge at oncfs.gouv.fr (Calenge Clement)
Date: Mon, 7 Apr 2014 19:00:52 +0000
Subject: [R-sig-Geo] adehabitatHR: kerneloverlap and kernelUD etc.
References: <1396889325456-7586144.post@n2.nabble.com>
Message-ID: <EF5D3065747CC8438B3B16856EF7F7B73335901C@SVRDSI078MBX02V>

> I have some questions regarding the kerneloverlap function within the
> adehabitatHR package, and must offer my apologies if they seem rather base:
>
> -I understand that the comparisons between the HR method for kerneloverlap
> and MCP overlap are often misleading. Why doesn't this method make for a
> good comparison to MCP area intersection?

I am not sure to understand what you mean here, but the function 
kerneloverlap implements exactly the approach described in Fieberg and 
Kochanny (2005, see the help page of the function for complete 
reference). Maybe this reference would help you to understand the 
differences with other approaches?


> -kerneloverlap function computes indices from sets of relocations, whereas
> kerneloverlaphr computes indices from estUDs. Why or in what scenarios might
> one be preferred over the other?

Generally, the function kerneloverlap is to be preferred (simpler to use 
if you start from a set of relocations, see below), except if you 
already have an object of class estUD in suitable format (i.e. with the 
kernel estimation carried out on the *same grid* for all animals). The 
function kerneloverlaphr might be preferred if you work with 
"nonclassical" kernel approaches, such as BRB, kernelbb, etc., if you 
have built your own estUD object from UDs estimated with another 
software, etc.


> -I notice in working with the kerneloverlap function that the selected grid
> size influences home range overlap. What is the best way to go about
> selecting a biologically meaningful grid size?

Normally, the effect of the grid size on the kernel estimates should be 
negligible. If it is not, it may be because the grid is way too coarse. 
Increase the resolution until no further noticeable change occurs.


> -When trying to work with the kerneloverlaphr, I am given the warning "In vi
> * vj : longer object length is not a multiple of shorter object length". I'm
> afraid I can't say I really understand this statement (as each animal has
> the same number of relocations) nor what the function is doing with the data
> to account for it.

Hard to say without any reproducible example... Just a guess: you try to 
use kerneloverlaphr with an estUD which is not in the correct format 
(i.e. the size and the resolution of the grid is not the same for all 
animals). The function kerneloverlap might be easier to use? If you 
really really want to use kerneloverlap on an estUD object generated by 
kernelUD, please use same4all=TRUE in the function estUD.


> -I also realize that an issue with the kernelUD LSCV estimate is that the
> cross-validation criterion sometimes fails to be minimized. But /why / is
> this sometimes the case? i.e. what about the relocations might cause this?
> And when LSCV method does fail to converge, I understand that the method can
> no longer be reliably used. In such cases, is it best to default to another
> hr estimate like MCP, or another method for selecting h (href or selective
> h?)?

Have a look at the following urls:

http://lists.faunalia.it/pipermail/animov/2006-May/000137.html
http://lists.faunalia.it/pipermail/animov/2006-May/000130.html
http://lists.faunalia.it/pipermail/animov/2006-May/000165.html

Best regards
HTH,

Cl?ment Calenge

-- 
Cl?ment CALENGE
Cellule d'appui ? l'analyse de donn?es
Direction des Etudes et de la Recherche
Office national de la chasse et de la faune sauvage
Saint Benoist - 78610 Auffargis
tel. (33) 01.30.46.54.14


From pingyang.whu at gmail.com  Mon Apr  7 22:05:52 2014
From: pingyang.whu at gmail.com (ping yang)
Date: Mon, 7 Apr 2014 15:05:52 -0500
Subject: [R-sig-Geo] issue in using projectRaster in raster library
Message-ID: <CAK8gSG-zmjVhAkH9eBZetq4G47w9Ym3z3fwr=FNZB4hirMKS3Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140407/7a537363/attachment.pl>

From edzer.pebesma at uni-muenster.de  Mon Apr  7 22:09:01 2014
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 07 Apr 2014 22:09:01 +0200
Subject: [R-sig-Geo] gstat warning message from cross validate linear
	model
In-Reply-To: <CAJRR3XMir6n=++YitC6fq4BjaMhuz243fzdAai7eUAPgnce+AA@mail.gmail.com>
References: <CAJRR3XMir6n=++YitC6fq4BjaMhuz243fzdAai7eUAPgnce+AA@mail.gmail.com>
Message-ID: <534305DD.8090005@uni-muenster.de>

You are using a variogram that is permissible in 1D, but not in 2D
(linear with sill). This will generate negative variances, from which
the square root (sqrt) is computed in order to produce z scores.

The advice is to not use this model for data spanning more than one
dimension; the software, or its author, assumed you know this.

On 04/07/2014 08:59 PM, Moshood Agba Bakare wrote:
> Hi,
> The four variograme models below are fitted to the same dataset. I got
> a *warning
> message *while cross validating a fitted linear variogram model as
> 
> 
> Warning message:In sqrt(ret[[var.name]]) : NaNs produced
> 
> 
> from this R script
> lin.kcv <- krige.cv(yield ~ 1, canmod.sp, model = lin.var,nmax=100, nfold =
> 5)
> 
> what is the meaning of this warning? Each time I run this R script, I got
> different values for the cross validation statistics of linear.
> 
> Model         RMSE    MSDR
> Spherical      0.66    1.61
> Gaussian       0.62    3.17
> Exponential    0.65    1.91
> Linear         95.91   83.25
> 
> 
> These valueslook very strange compared to others because of warning message
> above. How do I explain this?
>  I made effort to redefine my nfold to be 10 but still give the same
> warning.
> 
> Thanks
> Moshood
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140407/80d9d0f4/attachment.bin>

From azvoleff at conservation.org  Mon Apr  7 22:30:01 2014
From: azvoleff at conservation.org (Alex Zvoleff)
Date: Mon, 7 Apr 2014 16:30:01 -0400
Subject: [R-sig-Geo] issue in using projectRaster in raster library
In-Reply-To: <CAK8gSG-zmjVhAkH9eBZetq4G47w9Ym3z3fwr=FNZB4hirMKS3Q@mail.gmail.com>
References: <CAK8gSG-zmjVhAkH9eBZetq4G47w9Ym3z3fwr=FNZB4hirMKS3Q@mail.gmail.com>
Message-ID: <CACwzsXEJJpxGMwNmzfTc6=Jt8OyYZe9GzT8dBUc5oM+2wqGsbA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140407/0b039909/attachment.pl>

From jgrn at illinois.edu  Mon Apr  7 22:42:58 2014
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Mon, 7 Apr 2014 15:42:58 -0500
Subject: [R-sig-Geo] issue in using projectRaster in raster library
In-Reply-To: <CACwzsXEJJpxGMwNmzfTc6=Jt8OyYZe9GzT8dBUc5oM+2wqGsbA@mail.gmail.com>
References: <CAK8gSG-zmjVhAkH9eBZetq4G47w9Ym3z3fwr=FNZB4hirMKS3Q@mail.gmail.com>
	<CACwzsXEJJpxGMwNmzfTc6=Jt8OyYZe9GzT8dBUc5oM+2wqGsbA@mail.gmail.com>
Message-ID: <CABG0rfu2Nnh5Ah98K-xRwJMDRs+_90JKjZ76Pfcewrc6jaKDAg@mail.gmail.com>

Ping:

Re: maxmemory -- you really shouldn't adjust that, definitely not to
what you set it to -- you've set it to (by my quick calculations) to
be around 7500 GB of needed memory (this is assuming each cell takes
64 bits of space) -- this is probably why you are crashing.  Chunksize
also is usually set correctly, raster processes generally have a
quickly diminishing returns as you increase the chunk size.

You might want to try gdalwarp in my gdalUtils package -- it will be
faster to reproject, and you can even enable parallelized warping.

install.packages("gdalUtils",
repos="http://R-Forge.R-project.org",type="source") # To get the
latest, otherwise just use CRAN

--j

On Mon, Apr 7, 2014 at 3:30 PM, Alex Zvoleff <azvoleff at conservation.org> wrote:
> On Mon, Apr 7, 2014 at 4:05 PM, ping yang <pingyang.whu at gmail.com> wrote:
>
>> Dear r-sig-geo,
>>
>> I plan to reproject from lonlat to UTM for a bunch of 10 meter NED files
>> (large) using a R script(I did it successfully for the 30 meter DEM), I
>> used the following code to run:
>>
>> rasterOptions(chunksize = 1e+10, maxmemory = 1e+12) #need to allow bigger
>> chunksize for the processing!!!
>>
>
> Why do you find that you "need to allow bigger chunksize"? I rarely need to
> adjust the chunksize, even for large images.
>
>
>>  #*----Function for detect the UTM Zone-----#
>> long2UTM <- function(long) {
>>   (floor((long + 180)/6) %% 60) + 1
>> }
>>
>>   require(raster)
>>   require(rgdal)
>>   filename <- "grdn41w083_13"
>>   longitude <- paste("-",substr(filename,9,10),sep="")
>>   lon <- as.numeric(longitude)
>>   utm <-paste("+proj=utm +zone=",long2UTM(lon)," +datum=NAD83 +ellps=GRS80
>> +towgs84=0,0,0 +units=m +no_defs",sep="")
>>   r  <- raster(filename)
>>   outputfile <- paste("projected/",substr(filename,4,10),".tif",sep='')
>>   print(paste(outputfile))
>>   pr <- projectRaster(r, crs=utm, res=10.0, method='bilinear')
>>
>> However, the projectRaster takes forever to finish and it almost crashed my
>> computer.
>>
>> The file is kind of big  (file size is 455MB),The file information is
>> class       : RasterLayer
>> dimensions  : 10812, 10812, 116899344  (nrow, ncol, ncell)
>> resolution  : 9.259259e-05, 9.259259e-05  (x, y)
>> extent      : -83.00056, -81.99944, 39.99944, 41.00056  (xmin, xmax, ymin,
>> ymax)
>> coord. ref. : +proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs
>> data source : c:\temporary\10M\grdn41w083_13
>> names       : grdn41w083_13
>> values      : 212.254, 460.0799  (min, max)
>>
>> My R information:
>> sessionInfo()
>> R version 3.0.1 (2013-05-16)
>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>> other attached packages:
>> [1] rgdal_0.8-10  raster_2.1-49 sp_1.0-11
>> loaded via a namespace (and not attached):
>> [1] grid_3.0.1      lattice_0.20-27 tools_3.0.1
>>
>> However, this process only took 10 seconds using the existing tool in
>> ArcGIS toolbox. Has someone experienced this before? Any comments will be
>> welcome.
>>
>
> Are you using "Project" or "Define Projection" in ArcGIS? "Define
> projection" just overwrites the existing projection rather than
> reprojecting the data, which is much more calculation intensive.
>
>
>>
>> Thanks,
>>
>> Ping
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
> --
> Alex Zvoleff
> Postdoctoral Associate
> Tropical Ecology Assessment and Monitoring (TEAM) Network
> Conservation International
> 2011 Crystal Dr. Suite 500, Arlington, Virginia 22202, USA
> Tel: +1-703-341-2749, Fax: +1-703-979-0953, Skype: azvoleff
> http://www.teamnetwork.org | http://www.conservation.org
>
>
> On Mon, Apr 7, 2014 at 4:05 PM, ping yang <pingyang.whu at gmail.com> wrote:
>
>> Dear r-sig-geo,
>>
>> I plan to reproject from lonlat to UTM for a bunch of 10 meter NED files
>> (large) using a R script(I did it successfully for the 30 meter DEM), I
>> used the following code to run:
>>
>> rasterOptions(chunksize = 1e+10, maxmemory = 1e+12) #need to allow bigger
>> chunksize for the processing!!!
>>  #*----Function for detect the UTM Zone-----#
>> long2UTM <- function(long) {
>>   (floor((long + 180)/6) %% 60) + 1
>> }
>>
>>   require(raster)
>>   require(rgdal)
>>   filename <- "grdn41w083_13"
>>   longitude <- paste("-",substr(filename,9,10),sep="")
>>   lon <- as.numeric(longitude)
>>   utm <-paste("+proj=utm +zone=",long2UTM(lon)," +datum=NAD83 +ellps=GRS80
>> +towgs84=0,0,0 +units=m +no_defs",sep="")
>>   r  <- raster(filename)
>>   outputfile <- paste("projected/",substr(filename,4,10),".tif",sep='')
>>   print(paste(outputfile))
>>   pr <- projectRaster(r, crs=utm, res=10.0, method='bilinear')
>>
>> However, the projectRaster takes forever to finish and it almost crashed my
>> computer.
>>
>> The file is kind of big  (file size is 455MB),The file information is
>> class       : RasterLayer
>> dimensions  : 10812, 10812, 116899344  (nrow, ncol, ncell)
>> resolution  : 9.259259e-05, 9.259259e-05  (x, y)
>> extent      : -83.00056, -81.99944, 39.99944, 41.00056  (xmin, xmax, ymin,
>> ymax)
>> coord. ref. : +proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs
>> data source : c:\temporary\10M\grdn41w083_13
>> names       : grdn41w083_13
>> values      : 212.254, 460.0799  (min, max)
>>
>> My R information:
>> sessionInfo()
>> R version 3.0.1 (2013-05-16)
>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>> other attached packages:
>> [1] rgdal_0.8-10  raster_2.1-49 sp_1.0-11
>> loaded via a namespace (and not attached):
>> [1] grid_3.0.1      lattice_0.20-27 tools_3.0.1
>>
>> However, this process only took 10 seconds using the existing tool in
>> ArcGIS toolbox. Has someone experienced this before? Any comments will be
>> welcome.
>>
>> Thanks,
>>
>> Ping
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
>
> --
> Alex Zvoleff
> Postdoctoral Associate
> Tropical Ecology Assessment and Monitoring (TEAM) Network
> Conservation International
> 2011 Crystal Dr. Suite 500, Arlington, Virginia 22202, USA
> Tel: +1-703-341-2749, Fax: +1-703-979-0953, Skype: azvoleff
> http://www.teamnetwork.org | http://www.conservation.org
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Jonathan A. Greenberg, PhD
Assistant Professor
Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
Department of Geography and Geographic Information Science
University of Illinois at Urbana-Champaign
259 Computing Applications Building, MC-150
605 East Springfield Avenue
Champaign, IL  61820-6371
Phone: 217-300-1924
http://www.geog.illinois.edu/~jgrn/
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007


From pingyang.whu at gmail.com  Mon Apr  7 23:47:47 2014
From: pingyang.whu at gmail.com (ping yang)
Date: Mon, 7 Apr 2014 16:47:47 -0500
Subject: [R-sig-Geo] issue in using projectRaster in raster library
In-Reply-To: <CABG0rfu2Nnh5Ah98K-xRwJMDRs+_90JKjZ76Pfcewrc6jaKDAg@mail.gmail.com>
References: <CAK8gSG-zmjVhAkH9eBZetq4G47w9Ym3z3fwr=FNZB4hirMKS3Q@mail.gmail.com>
	<CACwzsXEJJpxGMwNmzfTc6=Jt8OyYZe9GzT8dBUc5oM+2wqGsbA@mail.gmail.com>
	<CABG0rfu2Nnh5Ah98K-xRwJMDRs+_90JKjZ76Pfcewrc6jaKDAg@mail.gmail.com>
Message-ID: <CAK8gSG81UwLHqc0z4paX-T2yJF13L5T9ptpY25Sifgq8vjMjKQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140407/4094ccad/attachment.pl>

From jgrn at illinois.edu  Tue Apr  8 06:37:44 2014
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Mon, 7 Apr 2014 23:37:44 -0500
Subject: [R-sig-Geo] issue in using projectRaster in raster library
In-Reply-To: <CAK8gSG81UwLHqc0z4paX-T2yJF13L5T9ptpY25Sifgq8vjMjKQ@mail.gmail.com>
References: <CAK8gSG-zmjVhAkH9eBZetq4G47w9Ym3z3fwr=FNZB4hirMKS3Q@mail.gmail.com>
	<CACwzsXEJJpxGMwNmzfTc6=Jt8OyYZe9GzT8dBUc5oM+2wqGsbA@mail.gmail.com>
	<CABG0rfu2Nnh5Ah98K-xRwJMDRs+_90JKjZ76Pfcewrc6jaKDAg@mail.gmail.com>
	<CAK8gSG81UwLHqc0z4paX-T2yJF13L5T9ptpY25Sifgq8vjMjKQ@mail.gmail.com>
Message-ID: <CABG0rftD0BECeaF0wDA97jbBhHdsLH3-g-yP+zUwCJ2yXi8Tsw@mail.gmail.com>

For gdalUtils, you don't need to upgrade to 3.2 -- the latest CRAN
version only requires R 2.14 or later.  It should find your cygwin
version, but let me know if it doesn't.

The key with the rasterOptions you used is that, previously, you were
forcing the ENTIRE RASTER to load into memory with the max memory and
chunk size you used -- this is really not a good idea for 99.9% of
raster calculations.  I would try two things: 1) reduce the max memory
back to its default settings (1e+08 cells on my machine -- about 750mb
of RAM usage if each cell is 64 bits), and 2) adjust the chunk size to
maybe 250mb (3e+07 cells)  If you leave your settings like that,
particularly on Windows, you'll end up with out-of-memory crashes
fairly often (since I'm guessing you don't have 8TB of RAM on a
Windows box).

--j



On Mon, Apr 7, 2014 at 4:47 PM, ping yang <pingyang.whu at gmail.com> wrote:
> Hi Alex and Jonathan,
>
> The reason I used the rasterOptions is because when previously I did the
> reproject for 30 meter DEM, it worked after I raised the chunksize(otherwise
> it ran out of memory), so I added here just to avoid that issue(probably it
> not work  for this case)
>
> I am going to install gdalUtils package, however, I need to upgrade my R
> from 3.0.1 to 3.2 (I am afraid to do it since some other work is running).
>
> However, I have an update for this, i used the gdalwarp in my
> Cygwin(actually installed by the QGIS) and run it successfully:
> gdalwarp -t_srs '+proj=utm +zone=17 +datum=NAD83 +units=m +no_defs
> +ellps=GRS80 +towgs84=0,0,0' -r bilinear -multi -tr 10 10 -of GTiff
> grdn41w083_13/hdr.adf n41w083.tif
>
> it took 11 second to finish.
>
> I am still looking for the slop calculation based on the projected tif file,
> I will appreciated if anyone could give me some suggestions if have this
> experience.
>
> Thanks a lot.
>
> Ping
>
>
> On Mon, Apr 7, 2014 at 3:42 PM, Jonathan Greenberg <jgrn at illinois.edu>
> wrote:
>>
>> Ping:
>>
>> Re: maxmemory -- you really shouldn't adjust that, definitely not to
>> what you set it to -- you've set it to (by my quick calculations) to
>> be around 7500 GB of needed memory (this is assuming each cell takes
>> 64 bits of space) -- this is probably why you are crashing.  Chunksize
>> also is usually set correctly, raster processes generally have a
>> quickly diminishing returns as you increase the chunk size.
>>
>> You might want to try gdalwarp in my gdalUtils package -- it will be
>> faster to reproject, and you can even enable parallelized warping.
>>
>> install.packages("gdalUtils",
>> repos="http://R-Forge.R-project.org",type="source") # To get the
>> latest, otherwise just use CRAN
>>
>> --j
>>
>> On Mon, Apr 7, 2014 at 3:30 PM, Alex Zvoleff <azvoleff at conservation.org>
>> wrote:
>> > On Mon, Apr 7, 2014 at 4:05 PM, ping yang <pingyang.whu at gmail.com>
>> > wrote:
>> >
>> >> Dear r-sig-geo,
>> >>
>> >> I plan to reproject from lonlat to UTM for a bunch of 10 meter NED
>> >> files
>> >> (large) using a R script(I did it successfully for the 30 meter DEM), I
>> >> used the following code to run:
>> >>
>> >> rasterOptions(chunksize = 1e+10, maxmemory = 1e+12) #need to allow
>> >> bigger
>> >> chunksize for the processing!!!
>> >>
>> >
>> > Why do you find that you "need to allow bigger chunksize"? I rarely need
>> > to
>> > adjust the chunksize, even for large images.
>> >
>> >
>> >>  #*----Function for detect the UTM Zone-----#
>> >> long2UTM <- function(long) {
>> >>   (floor((long + 180)/6) %% 60) + 1
>> >> }
>> >>
>> >>   require(raster)
>> >>   require(rgdal)
>> >>   filename <- "grdn41w083_13"
>> >>   longitude <- paste("-",substr(filename,9,10),sep="")
>> >>   lon <- as.numeric(longitude)
>> >>   utm <-paste("+proj=utm +zone=",long2UTM(lon)," +datum=NAD83
>> >> +ellps=GRS80
>> >> +towgs84=0,0,0 +units=m +no_defs",sep="")
>> >>   r  <- raster(filename)
>> >>   outputfile <- paste("projected/",substr(filename,4,10),".tif",sep='')
>> >>   print(paste(outputfile))
>> >>   pr <- projectRaster(r, crs=utm, res=10.0, method='bilinear')
>> >>
>> >> However, the projectRaster takes forever to finish and it almost
>> >> crashed my
>> >> computer.
>> >>
>> >> The file is kind of big  (file size is 455MB),The file information is
>> >> class       : RasterLayer
>> >> dimensions  : 10812, 10812, 116899344  (nrow, ncol, ncell)
>> >> resolution  : 9.259259e-05, 9.259259e-05  (x, y)
>> >> extent      : -83.00056, -81.99944, 39.99944, 41.00056  (xmin, xmax,
>> >> ymin,
>> >> ymax)
>> >> coord. ref. : +proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0
>> >> +no_defs
>> >> data source : c:\temporary\10M\grdn41w083_13
>> >> names       : grdn41w083_13
>> >> values      : 212.254, 460.0799  (min, max)
>> >>
>> >> My R information:
>> >> sessionInfo()
>> >> R version 3.0.1 (2013-05-16)
>> >> Platform: x86_64-w64-mingw32/x64 (64-bit)
>> >> attached base packages:
>> >> [1] stats     graphics  grDevices utils     datasets  methods   base
>> >> other attached packages:
>> >> [1] rgdal_0.8-10  raster_2.1-49 sp_1.0-11
>> >> loaded via a namespace (and not attached):
>> >> [1] grid_3.0.1      lattice_0.20-27 tools_3.0.1
>> >>
>> >> However, this process only took 10 seconds using the existing tool in
>> >> ArcGIS toolbox. Has someone experienced this before? Any comments will
>> >> be
>> >> welcome.
>> >>
>> >
>> > Are you using "Project" or "Define Projection" in ArcGIS? "Define
>> > projection" just overwrites the existing projection rather than
>> > reprojecting the data, which is much more calculation intensive.
>> >
>> >
>> >>
>> >> Thanks,
>> >>
>> >> Ping
>> >>
>> >>         [[alternative HTML version deleted]]
>> >>
>> >> _______________________________________________
>> >> R-sig-Geo mailing list
>> >> R-sig-Geo at r-project.org
>> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >>
>> >
>> >
>> > --
>> > Alex Zvoleff
>> > Postdoctoral Associate
>> > Tropical Ecology Assessment and Monitoring (TEAM) Network
>> > Conservation International
>> > 2011 Crystal Dr. Suite 500, Arlington, Virginia 22202, USA
>> > Tel: +1-703-341-2749, Fax: +1-703-979-0953, Skype: azvoleff
>> > http://www.teamnetwork.org | http://www.conservation.org
>> >
>> >
>> > On Mon, Apr 7, 2014 at 4:05 PM, ping yang <pingyang.whu at gmail.com>
>> > wrote:
>> >
>> >> Dear r-sig-geo,
>> >>
>> >> I plan to reproject from lonlat to UTM for a bunch of 10 meter NED
>> >> files
>> >> (large) using a R script(I did it successfully for the 30 meter DEM), I
>> >> used the following code to run:
>> >>
>> >> rasterOptions(chunksize = 1e+10, maxmemory = 1e+12) #need to allow
>> >> bigger
>> >> chunksize for the processing!!!
>> >>  #*----Function for detect the UTM Zone-----#
>> >> long2UTM <- function(long) {
>> >>   (floor((long + 180)/6) %% 60) + 1
>> >> }
>> >>
>> >>   require(raster)
>> >>   require(rgdal)
>> >>   filename <- "grdn41w083_13"
>> >>   longitude <- paste("-",substr(filename,9,10),sep="")
>> >>   lon <- as.numeric(longitude)
>> >>   utm <-paste("+proj=utm +zone=",long2UTM(lon)," +datum=NAD83
>> >> +ellps=GRS80
>> >> +towgs84=0,0,0 +units=m +no_defs",sep="")
>> >>   r  <- raster(filename)
>> >>   outputfile <- paste("projected/",substr(filename,4,10),".tif",sep='')
>> >>   print(paste(outputfile))
>> >>   pr <- projectRaster(r, crs=utm, res=10.0, method='bilinear')
>> >>
>> >> However, the projectRaster takes forever to finish and it almost
>> >> crashed my
>> >> computer.
>> >>
>> >> The file is kind of big  (file size is 455MB),The file information is
>> >> class       : RasterLayer
>> >> dimensions  : 10812, 10812, 116899344  (nrow, ncol, ncell)
>> >> resolution  : 9.259259e-05, 9.259259e-05  (x, y)
>> >> extent      : -83.00056, -81.99944, 39.99944, 41.00056  (xmin, xmax,
>> >> ymin,
>> >> ymax)
>> >> coord. ref. : +proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0
>> >> +no_defs
>> >> data source : c:\temporary\10M\grdn41w083_13
>> >> names       : grdn41w083_13
>> >> values      : 212.254, 460.0799  (min, max)
>> >>
>> >> My R information:
>> >> sessionInfo()
>> >> R version 3.0.1 (2013-05-16)
>> >> Platform: x86_64-w64-mingw32/x64 (64-bit)
>> >> attached base packages:
>> >> [1] stats     graphics  grDevices utils     datasets  methods   base
>> >> other attached packages:
>> >> [1] rgdal_0.8-10  raster_2.1-49 sp_1.0-11
>> >> loaded via a namespace (and not attached):
>> >> [1] grid_3.0.1      lattice_0.20-27 tools_3.0.1
>> >>
>> >> However, this process only took 10 seconds using the existing tool in
>> >> ArcGIS toolbox. Has someone experienced this before? Any comments will
>> >> be
>> >> welcome.
>> >>
>> >> Thanks,
>> >>
>> >> Ping
>> >>
>> >>         [[alternative HTML version deleted]]
>> >>
>> >> _______________________________________________
>> >> R-sig-Geo mailing list
>> >> R-sig-Geo at r-project.org
>> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >>
>> >
>> >
>> >
>> > --
>> > Alex Zvoleff
>> > Postdoctoral Associate
>> > Tropical Ecology Assessment and Monitoring (TEAM) Network
>> > Conservation International
>> > 2011 Crystal Dr. Suite 500, Arlington, Virginia 22202, USA
>> > Tel: +1-703-341-2749, Fax: +1-703-979-0953, Skype: azvoleff
>> > http://www.teamnetwork.org | http://www.conservation.org
>> >
>> >         [[alternative HTML version deleted]]
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at r-project.org
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>>
>> --
>> Jonathan A. Greenberg, PhD
>> Assistant Professor
>> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
>> Department of Geography and Geographic Information Science
>> University of Illinois at Urbana-Champaign
>> 259 Computing Applications Building, MC-150
>> 605 East Springfield Avenue
>> Champaign, IL  61820-6371
>> Phone: 217-300-1924
>> http://www.geog.illinois.edu/~jgrn/
>> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
>
>



-- 
Jonathan A. Greenberg, PhD
Assistant Professor
Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
Department of Geography and Geographic Information Science
University of Illinois at Urbana-Champaign
259 Computing Applications Building, MC-150
605 East Springfield Avenue
Champaign, IL  61820-6371
Phone: 217-300-1924
http://www.geog.illinois.edu/~jgrn/
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007


From imirum_amir at hotmail.com  Tue Apr  8 18:20:28 2014
From: imirum_amir at hotmail.com (irum Amir)
Date: Tue, 8 Apr 2014 16:20:28 +0000
Subject: [R-sig-Geo] how to assess which smooth estimates are more reliable?
Message-ID: <COL131-W62599E528C7417C6ECC5F5806B0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140408/91f0028e/attachment.pl>

From katharine.miller at noaa.gov  Tue Apr  8 22:29:22 2014
From: katharine.miller at noaa.gov (Katharine Miller - NOAA Federal)
Date: Tue, 8 Apr 2014 12:29:22 -0800
Subject: [R-sig-Geo] Problem with over() from sp package
Message-ID: <CACnUi6_M9WP=GX50j4A-zJBt6bOVRQ3i2fi2R20GadrnXUGQeg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140408/371223e6/attachment.pl>

From pingyang.whu at gmail.com  Tue Apr  8 23:50:52 2014
From: pingyang.whu at gmail.com (ping yang)
Date: Tue, 8 Apr 2014 16:50:52 -0500
Subject: [R-sig-Geo] issue in using projectRaster in raster library
In-Reply-To: <CABG0rftD0BECeaF0wDA97jbBhHdsLH3-g-yP+zUwCJ2yXi8Tsw@mail.gmail.com>
References: <CAK8gSG-zmjVhAkH9eBZetq4G47w9Ym3z3fwr=FNZB4hirMKS3Q@mail.gmail.com>
	<CACwzsXEJJpxGMwNmzfTc6=Jt8OyYZe9GzT8dBUc5oM+2wqGsbA@mail.gmail.com>
	<CABG0rfu2Nnh5Ah98K-xRwJMDRs+_90JKjZ76Pfcewrc6jaKDAg@mail.gmail.com>
	<CAK8gSG81UwLHqc0z4paX-T2yJF13L5T9ptpY25Sifgq8vjMjKQ@mail.gmail.com>
	<CABG0rftD0BECeaF0wDA97jbBhHdsLH3-g-yP+zUwCJ2yXi8Tsw@mail.gmail.com>
Message-ID: <CAK8gSG_y586EmrHuVZ6g3+G3Ug8sLdo-XdkFTqpRgZGiVg3NPg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140408/b6b8ff71/attachment.pl>

From jgrn at illinois.edu  Wed Apr  9 00:42:39 2014
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Tue, 8 Apr 2014 17:42:39 -0500
Subject: [R-sig-Geo] issue in using projectRaster in raster library
In-Reply-To: <CAK8gSG_y586EmrHuVZ6g3+G3Ug8sLdo-XdkFTqpRgZGiVg3NPg@mail.gmail.com>
References: <CAK8gSG-zmjVhAkH9eBZetq4G47w9Ym3z3fwr=FNZB4hirMKS3Q@mail.gmail.com>
	<CACwzsXEJJpxGMwNmzfTc6=Jt8OyYZe9GzT8dBUc5oM+2wqGsbA@mail.gmail.com>
	<CABG0rfu2Nnh5Ah98K-xRwJMDRs+_90JKjZ76Pfcewrc6jaKDAg@mail.gmail.com>
	<CAK8gSG81UwLHqc0z4paX-T2yJF13L5T9ptpY25Sifgq8vjMjKQ@mail.gmail.com>
	<CABG0rftD0BECeaF0wDA97jbBhHdsLH3-g-yP+zUwCJ2yXi8Tsw@mail.gmail.com>
	<CAK8gSG_y586EmrHuVZ6g3+G3Ug8sLdo-XdkFTqpRgZGiVg3NPg@mail.gmail.com>
Message-ID: <CABG0rfuJoRs5YhLJsxiwMguWcj1TMGZa_tDSy=A9uKzD20kKig@mail.gmail.com>

Ping:

Re: raster:::projectRaster I'm not sure how much you can speed that up
(Robert?) -- I think it is native R code which is generally a lot
slower than compiled code like the GDAL utilities.  It has to use
"chunking", but for reasonable chunk sizes this is not likely to cause
any noticeable overhead.

Re: gdalUtils vs. cygwin -- you got basically the same execution time
-- 21.15 vs. 20.7 seconds is not worth worrying about (~ a 2% increase
using gdal from R)-- gdalUtils has the (small) overhead from R, but it
is actually using your installed gdalwarp in cygwin anyway, it is just
an R wrapper for it if you are more comfortable using R functions vs.
command line.  The first time you launch gdalwarp in an R session it
takes a few seconds to find your local installation of GDAL -- the
second time it runs, there should be almost no overhead.

Re: parallelization -- if you have GDAL 1.10.1 or later (perhaps a
slightly earlier version, not sure when it was implemented), you can
use -multi -wo NUM_THREADS=ALL_CPUS to parallelize the operation -- in
gdalUtils, this would be:

gdalwarp(...,multi=TRUE,wo="NUM_THREADS=ALL_CPUS")

# See: http://lists.osgeo.org/pipermail/gdal-dev/2012-June/033084.html

If you are trying to warp a LOT of images, you can also use e.g.
foreach() to warp each image using a different thread.  You'd have to
experiment with which one (loop through each image one at a time,
parallel processing each individual image vs. parallel processing
multiple images at the same time) is more efficient.

--j




On Tue, Apr 8, 2014 at 4:50 PM, ping yang <pingyang.whu at gmail.com> wrote:
> Hi Jonathan,
>
> I am following up with the previous thread, Now I successfully installed the
> gdalUtils from the source and ran successfully the task (both projection and
> slope calculation) using the following script:
>
> rasterOptions(chunksize = 3e+07, maxmemory = 1e+08) #suggestions according
> to Jonanthan, it made the raster::projectRaster work but for much longer
> time such as 40 minutes!!!
>
> #*----Function for detect the UTM Zone-----#
> long2UTM <- function(long) {
>   (floor((long + 180)/6) %% 60) + 1
> }
>
>   filename <- "grdn41w083_13"
>   longitude <- paste("-",substr(filename,9,10),sep="") #this could be change
> according to the directory string
>   lon <- as.numeric(longitude)
>   utm <-paste("+proj=utm +zone=",long2UTM(lon)," +datum=NAD83 +ellps=GRS80
> +towgs84=0,0,0 +units=m +no_defs",sep="")
>   outputfile <-
> paste("projected/",substr(filename,4,10),"_raster.tif",sep='')
>   gdalwarp(srcfile=filename, dstfile=outputfile,
> t_srs=utm,output_Raster=TRUE,overwrite=TRUE,multi=TRUE,
> tr=c(10,10),r="bilinear", verbose=TRUE)
>   slp <- gdaldem(mode="slope",input_dem=outputfile,
> output="n41w083_rgdalslp.tif",output_Raster=TRUE,verbose=TRUE)
>
> Now it took me 21.15 seconds to finish the projection(while using the
> gdalWarp in cygwin took about 20.7 seconds)
>
> I am wondering if there is way to speed up this process, How to parallel
> this process(parallelized warping)?
>
> Big Thanks,
>
> Ping
>
>
>
> On Mon, Apr 7, 2014 at 11:37 PM, Jonathan Greenberg <jgrn at illinois.edu>
> wrote:
>>
>> For gdalUtils, you don't need to upgrade to 3.2 -- the latest CRAN
>> version only requires R 2.14 or later.  It should find your cygwin
>> version, but let me know if it doesn't.
>>
>> The key with the rasterOptions you used is that, previously, you were
>> forcing the ENTIRE RASTER to load into memory with the max memory and
>> chunk size you used -- this is really not a good idea for 99.9% of
>> raster calculations.  I would try two things: 1) reduce the max memory
>> back to its default settings (1e+08 cells on my machine -- about 750mb
>> of RAM usage if each cell is 64 bits), and 2) adjust the chunk size to
>> maybe 250mb (3e+07 cells)  If you leave your settings like that,
>> particularly on Windows, you'll end up with out-of-memory crashes
>> fairly often (since I'm guessing you don't have 8TB of RAM on a
>> Windows box).
>>
>> --j
>>
>>
>>
>> On Mon, Apr 7, 2014 at 4:47 PM, ping yang <pingyang.whu at gmail.com> wrote:
>> > Hi Alex and Jonathan,
>> >
>> > The reason I used the rasterOptions is because when previously I did the
>> > reproject for 30 meter DEM, it worked after I raised the
>> > chunksize(otherwise
>> > it ran out of memory), so I added here just to avoid that issue(probably
>> > it
>> > not work  for this case)
>> >
>> > I am going to install gdalUtils package, however, I need to upgrade my R
>> > from 3.0.1 to 3.2 (I am afraid to do it since some other work is
>> > running).
>> >
>> > However, I have an update for this, i used the gdalwarp in my
>> > Cygwin(actually installed by the QGIS) and run it successfully:
>> > gdalwarp -t_srs '+proj=utm +zone=17 +datum=NAD83 +units=m +no_defs
>> > +ellps=GRS80 +towgs84=0,0,0' -r bilinear -multi -tr 10 10 -of GTiff
>> > grdn41w083_13/hdr.adf n41w083.tif
>> >
>> > it took 11 second to finish.
>> >
>> > I am still looking for the slop calculation based on the projected tif
>> > file,
>> > I will appreciated if anyone could give me some suggestions if have this
>> > experience.
>> >
>> > Thanks a lot.
>> >
>> > Ping
>> >
>> >
>> > On Mon, Apr 7, 2014 at 3:42 PM, Jonathan Greenberg <jgrn at illinois.edu>
>> > wrote:
>> >>
>> >> Ping:
>> >>
>> >> Re: maxmemory -- you really shouldn't adjust that, definitely not to
>> >> what you set it to -- you've set it to (by my quick calculations) to
>> >> be around 7500 GB of needed memory (this is assuming each cell takes
>> >> 64 bits of space) -- this is probably why you are crashing.  Chunksize
>> >> also is usually set correctly, raster processes generally have a
>> >> quickly diminishing returns as you increase the chunk size.
>> >>
>> >> You might want to try gdalwarp in my gdalUtils package -- it will be
>> >> faster to reproject, and you can even enable parallelized warping.
>> >>
>> >> install.packages("gdalUtils",
>> >> repos="http://R-Forge.R-project.org",type="source") # To get the
>> >> latest, otherwise just use CRAN
>> >>
>> >> --j
>> >>
>> >> On Mon, Apr 7, 2014 at 3:30 PM, Alex Zvoleff
>> >> <azvoleff at conservation.org>
>> >> wrote:
>> >> > On Mon, Apr 7, 2014 at 4:05 PM, ping yang <pingyang.whu at gmail.com>
>> >> > wrote:
>> >> >
>> >> >> Dear r-sig-geo,
>> >> >>
>> >> >> I plan to reproject from lonlat to UTM for a bunch of 10 meter NED
>> >> >> files
>> >> >> (large) using a R script(I did it successfully for the 30 meter
>> >> >> DEM), I
>> >> >> used the following code to run:
>> >> >>
>> >> >> rasterOptions(chunksize = 1e+10, maxmemory = 1e+12) #need to allow
>> >> >> bigger
>> >> >> chunksize for the processing!!!
>> >> >>
>> >> >
>> >> > Why do you find that you "need to allow bigger chunksize"? I rarely
>> >> > need
>> >> > to
>> >> > adjust the chunksize, even for large images.
>> >> >
>> >> >
>> >> >>  #*----Function for detect the UTM Zone-----#
>> >> >> long2UTM <- function(long) {
>> >> >>   (floor((long + 180)/6) %% 60) + 1
>> >> >> }
>> >> >>
>> >> >>   require(raster)
>> >> >>   require(rgdal)
>> >> >>   filename <- "grdn41w083_13"
>> >> >>   longitude <- paste("-",substr(filename,9,10),sep="")
>> >> >>   lon <- as.numeric(longitude)
>> >> >>   utm <-paste("+proj=utm +zone=",long2UTM(lon)," +datum=NAD83
>> >> >> +ellps=GRS80
>> >> >> +towgs84=0,0,0 +units=m +no_defs",sep="")
>> >> >>   r  <- raster(filename)
>> >> >>   outputfile <-
>> >> >> paste("projected/",substr(filename,4,10),".tif",sep='')
>> >> >>   print(paste(outputfile))
>> >> >>   pr <- projectRaster(r, crs=utm, res=10.0, method='bilinear')
>> >> >>
>> >> >> However, the projectRaster takes forever to finish and it almost
>> >> >> crashed my
>> >> >> computer.
>> >> >>
>> >> >> The file is kind of big  (file size is 455MB),The file information
>> >> >> is
>> >> >> class       : RasterLayer
>> >> >> dimensions  : 10812, 10812, 116899344  (nrow, ncol, ncell)
>> >> >> resolution  : 9.259259e-05, 9.259259e-05  (x, y)
>> >> >> extent      : -83.00056, -81.99944, 39.99944, 41.00056  (xmin, xmax,
>> >> >> ymin,
>> >> >> ymax)
>> >> >> coord. ref. : +proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0
>> >> >> +no_defs
>> >> >> data source : c:\temporary\10M\grdn41w083_13
>> >> >> names       : grdn41w083_13
>> >> >> values      : 212.254, 460.0799  (min, max)
>> >> >>
>> >> >> My R information:
>> >> >> sessionInfo()
>> >> >> R version 3.0.1 (2013-05-16)
>> >> >> Platform: x86_64-w64-mingw32/x64 (64-bit)
>> >> >> attached base packages:
>> >> >> [1] stats     graphics  grDevices utils     datasets  methods   base
>> >> >> other attached packages:
>> >> >> [1] rgdal_0.8-10  raster_2.1-49 sp_1.0-11
>> >> >> loaded via a namespace (and not attached):
>> >> >> [1] grid_3.0.1      lattice_0.20-27 tools_3.0.1
>> >> >>
>> >> >> However, this process only took 10 seconds using the existing tool
>> >> >> in
>> >> >> ArcGIS toolbox. Has someone experienced this before? Any comments
>> >> >> will
>> >> >> be
>> >> >> welcome.
>> >> >>
>> >> >
>> >> > Are you using "Project" or "Define Projection" in ArcGIS? "Define
>> >> > projection" just overwrites the existing projection rather than
>> >> > reprojecting the data, which is much more calculation intensive.
>> >> >
>> >> >
>> >> >>
>> >> >> Thanks,
>> >> >>
>> >> >> Ping
>> >> >>
>> >> >>         [[alternative HTML version deleted]]
>> >> >>
>> >> >> _______________________________________________
>> >> >> R-sig-Geo mailing list
>> >> >> R-sig-Geo at r-project.org
>> >> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >> >>
>> >> >
>> >> >
>> >> > --
>> >> > Alex Zvoleff
>> >> > Postdoctoral Associate
>> >> > Tropical Ecology Assessment and Monitoring (TEAM) Network
>> >> > Conservation International
>> >> > 2011 Crystal Dr. Suite 500, Arlington, Virginia 22202, USA
>> >> > Tel: +1-703-341-2749, Fax: +1-703-979-0953, Skype: azvoleff
>> >> > http://www.teamnetwork.org | http://www.conservation.org
>> >> >
>> >> >
>> >> > On Mon, Apr 7, 2014 at 4:05 PM, ping yang <pingyang.whu at gmail.com>
>> >> > wrote:
>> >> >
>> >> >> Dear r-sig-geo,
>> >> >>
>> >> >> I plan to reproject from lonlat to UTM for a bunch of 10 meter NED
>> >> >> files
>> >> >> (large) using a R script(I did it successfully for the 30 meter
>> >> >> DEM), I
>> >> >> used the following code to run:
>> >> >>
>> >> >> rasterOptions(chunksize = 1e+10, maxmemory = 1e+12) #need to allow
>> >> >> bigger
>> >> >> chunksize for the processing!!!
>> >> >>  #*----Function for detect the UTM Zone-----#
>> >> >> long2UTM <- function(long) {
>> >> >>   (floor((long + 180)/6) %% 60) + 1
>> >> >> }
>> >> >>
>> >> >>   require(raster)
>> >> >>   require(rgdal)
>> >> >>   filename <- "grdn41w083_13"
>> >> >>   longitude <- paste("-",substr(filename,9,10),sep="")
>> >> >>   lon <- as.numeric(longitude)
>> >> >>   utm <-paste("+proj=utm +zone=",long2UTM(lon)," +datum=NAD83
>> >> >> +ellps=GRS80
>> >> >> +towgs84=0,0,0 +units=m +no_defs",sep="")
>> >> >>   r  <- raster(filename)
>> >> >>   outputfile <-
>> >> >> paste("projected/",substr(filename,4,10),".tif",sep='')
>> >> >>   print(paste(outputfile))
>> >> >>   pr <- projectRaster(r, crs=utm, res=10.0, method='bilinear')
>> >> >>
>> >> >> However, the projectRaster takes forever to finish and it almost
>> >> >> crashed my
>> >> >> computer.
>> >> >>
>> >> >> The file is kind of big  (file size is 455MB),The file information
>> >> >> is
>> >> >> class       : RasterLayer
>> >> >> dimensions  : 10812, 10812, 116899344  (nrow, ncol, ncell)
>> >> >> resolution  : 9.259259e-05, 9.259259e-05  (x, y)
>> >> >> extent      : -83.00056, -81.99944, 39.99944, 41.00056  (xmin, xmax,
>> >> >> ymin,
>> >> >> ymax)
>> >> >> coord. ref. : +proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0
>> >> >> +no_defs
>> >> >> data source : c:\temporary\10M\grdn41w083_13
>> >> >> names       : grdn41w083_13
>> >> >> values      : 212.254, 460.0799  (min, max)
>> >> >>
>> >> >> My R information:
>> >> >> sessionInfo()
>> >> >> R version 3.0.1 (2013-05-16)
>> >> >> Platform: x86_64-w64-mingw32/x64 (64-bit)
>> >> >> attached base packages:
>> >> >> [1] stats     graphics  grDevices utils     datasets  methods   base
>> >> >> other attached packages:
>> >> >> [1] rgdal_0.8-10  raster_2.1-49 sp_1.0-11
>> >> >> loaded via a namespace (and not attached):
>> >> >> [1] grid_3.0.1      lattice_0.20-27 tools_3.0.1
>> >> >>
>> >> >> However, this process only took 10 seconds using the existing tool
>> >> >> in
>> >> >> ArcGIS toolbox. Has someone experienced this before? Any comments
>> >> >> will
>> >> >> be
>> >> >> welcome.
>> >> >>
>> >> >> Thanks,
>> >> >>
>> >> >> Ping
>> >> >>
>> >> >>         [[alternative HTML version deleted]]
>> >> >>
>> >> >> _______________________________________________
>> >> >> R-sig-Geo mailing list
>> >> >> R-sig-Geo at r-project.org
>> >> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >> >>
>> >> >
>> >> >
>> >> >
>> >> > --
>> >> > Alex Zvoleff
>> >> > Postdoctoral Associate
>> >> > Tropical Ecology Assessment and Monitoring (TEAM) Network
>> >> > Conservation International
>> >> > 2011 Crystal Dr. Suite 500, Arlington, Virginia 22202, USA
>> >> > Tel: +1-703-341-2749, Fax: +1-703-979-0953, Skype: azvoleff
>> >> > http://www.teamnetwork.org | http://www.conservation.org
>> >> >
>> >> >         [[alternative HTML version deleted]]
>> >> >
>> >> > _______________________________________________
>> >> > R-sig-Geo mailing list
>> >> > R-sig-Geo at r-project.org
>> >> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >>
>> >>
>> >>
>> >> --
>> >> Jonathan A. Greenberg, PhD
>> >> Assistant Professor
>> >> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
>> >> Department of Geography and Geographic Information Science
>> >> University of Illinois at Urbana-Champaign
>> >> 259 Computing Applications Building, MC-150
>> >> 605 East Springfield Avenue
>> >> Champaign, IL  61820-6371
>> >> Phone: 217-300-1924
>> >> http://www.geog.illinois.edu/~jgrn/
>> >> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
>> >
>> >
>>
>>
>>
>> --
>> Jonathan A. Greenberg, PhD
>> Assistant Professor
>> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
>> Department of Geography and Geographic Information Science
>> University of Illinois at Urbana-Champaign
>> 259 Computing Applications Building, MC-150
>> 605 East Springfield Avenue
>> Champaign, IL  61820-6371
>> Phone: 217-300-1924
>> http://www.geog.illinois.edu/~jgrn/
>> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
>
>



-- 
Jonathan A. Greenberg, PhD
Assistant Professor
Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
Department of Geography and Geographic Information Science
University of Illinois at Urbana-Champaign
259 Computing Applications Building, MC-150
605 East Springfield Avenue
Champaign, IL  61820-6371
Phone: 217-300-1924
http://www.geog.illinois.edu/~jgrn/
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007


From edzer.pebesma at uni-muenster.de  Wed Apr  9 09:38:49 2014
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 09 Apr 2014 09:38:49 +0200
Subject: [R-sig-Geo] Problem with over() from sp package
In-Reply-To: <CACnUi6_M9WP=GX50j4A-zJBt6bOVRQ3i2fi2R20GadrnXUGQeg@mail.gmail.com>
References: <CACnUi6_M9WP=GX50j4A-zJBt6bOVRQ3i2fi2R20GadrnXUGQeg@mail.gmail.com>
Message-ID: <5344F909.4070400@uni-muenster.de>

The documentation of sp::over says, for over(x,y):

"at the spatial locations of object x retrieves the indexes or
attributes from spatial object y"

From your description it seems that you want the polygon attributes
at the locations of your points. For this, you try:

temp <- over(vec, xy_allClasses)

but that gives point indexes or attributes for all each of the polygons.

If xy_allClasses has no attributes, temp is correctly of class integer.
See also http://cran.r-project.org/web/packages/sp/vignettes/over.pdf

According to the documentation, and if I understand your problem
correctly, you want:

temp <- over(xy_allClasses, vec)

Your email contains a lot of code that seems irrelevant to your
question, and also does not contain a reproducible example, so my
answer can only be a wild guess. But I hope it helps,


On 04/08/2014 10:29 PM, Katharine Miller - NOAA Federal wrote:
> Hi
> 
> I am new to the sp package.  When I use over() with a
> SpatialPolygoneDataframe and SpatialPoints objects I get an object of class
> "integer", not a dataframe as the sp help documentation suggests.
> 
> The  SpatialPolygoneDataframe object is shape file imported using readOGR.
> The SpatialPoints object is a random sample of points within each polygon.
> I want to use this information to train a random forest model to classify a
> raster image.  So I am using over () to combine the data from the two files
> so I can extract the  variable name/class from my shapefile for each
> point.  Unfortunately, the result of the over () application is simply a
> string of numbers with no attributes.
> 
> Here is the code:
> 
> # get shapefile
> vec<- readOGR('E:/', layer = "DVTraining")
> ## this is an objective of class SpatialPolygoneDataframe
> 
> # Code for abstracting random points from each polygon to create training
> data
> for (x in 1:9) {
>   # Get the metadata for all polygons for a particular class (based on the
> uniqueAtt variable)
>   class_data<- vec[vec[[attName]]==uniqueAtt[x],]
>   # Get the area of each polygon for a particular class
>   areas <- sapply(slot(class_data, "polygons"), slot, "area")
>   # Calculate the number of samples for each polygon based on the area in
> proportion to total area for a class
>   nsamps <- ceiling(numsamps*(areas/sum(areas)))
>   # Use random sampling to select training points (proportial based on
> area) from each polygon for a given class
>   for (i in 1:dim(class_data)[1]) {
>     xy_class <- spsample(class_data[i,], type="random", n=nsamps[i])
>     # Add coordinates to create a list of random points for all polygons
>     if (i == 1) cpts <- xy_class
>     else cpts <- rbind(cpts, xy_class)
>   }
> # The number of points might not match numsamps exactly.
>   classpts <- cpts
>   if (x == 1) {
>     xy_allClasses<- classpts
>   } else {
>     xy_allClasses<- rbind(xy_allClasses, classpts)
>   }
> }
> 
> 
> ### Now, combine the points and polygons to get the class number for each
> point
> temp <- over(vec, xy_allClasses)
> 
> Temp is an object of class "integer"  and as such does not have any
> attributes - so there are no attribute names for the points.
> 
> Thanks for any help.
> 
> Note: I borrowed this code from
> http://biodiversityinformatics.amnh.org/index.php?section=R_Scripts.  The
> original code used readShapePoly to load the shapefile but when I tried
> that it came in without a coordinate reference, so I switched to readOGR.
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140409/606739eb/attachment.bin>

From enzo.ccc at gmail.com  Wed Apr  9 11:22:01 2014
From: enzo.ccc at gmail.com (Enzo Cocca)
Date: Wed, 9 Apr 2014 11:22:01 +0200
Subject: [R-sig-Geo] flow or directional raster map
Message-ID: <CAC_+zup=8ZVXBORgBZ2OTO7MVx63GLDkpTLpmms5qSK+15kmng@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140409/c697aa7b/attachment.pl>

From jgcorripio at mac.com  Wed Apr  9 12:53:46 2014
From: jgcorripio at mac.com (Javier G. Corripio)
Date: Wed, 09 Apr 2014 12:53:46 +0200
Subject: [R-sig-Geo] Raster default datatype and Mac OSX problem
Message-ID: <14DB9053-012D-41E2-8C3E-D6194D26ADD7@mac.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140409/991e1cb8/attachment.pl>

From culinovic.domagoj at gmail.com  Wed Apr  9 12:58:03 2014
From: culinovic.domagoj at gmail.com (Domagoj Culinovic)
Date: Wed, 9 Apr 2014 12:58:03 +0200
Subject: [R-sig-Geo] Genetic Algorithm in R?
Message-ID: <CACgt3o=9CR5J-JjHCfRmY_uC7pkt077Bk1XyVmHOonHfBxgbzw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140409/c02cfff7/attachment.pl>

From oscar.perpinan at upm.es  Wed Apr  9 13:23:38 2014
From: oscar.perpinan at upm.es (=?ISO-8859-1?Q?Oscar_Perpi=F1an?=)
Date: Wed, 9 Apr 2014 13:23:38 +0200
Subject: [R-sig-Geo] flow or directional raster map
In-Reply-To: <CAC_+zup=8ZVXBORgBZ2OTO7MVx63GLDkpTLpmms5qSK+15kmng@mail.gmail.com>
References: <CAC_+zup=8ZVXBORgBZ2OTO7MVx63GLDkpTLpmms5qSK+15kmng@mail.gmail.com>
Message-ID: <CAMLL7bmJWY1aRGdiPvfdv7aoOSQJ1S-VoCcGf29jLMm_owPaWw@mail.gmail.com>

Hi,

You can use rasterVis::vectorplot:
http://oscarperpinan.github.io/rastervis/#vectorplot

Best,

Oscar.
-----------------------------------------------------------------
Oscar Perpi??n Lamigueiro
Dpto. Ingenier?a El?ctrica (ETSIDI-UPM)
Grupo de Sistemas Fotovoltaicos (IES-UPM)
URL: http://oscarperpinan.github.io
Twitter: @oscarperpinan


2014-04-09 11:22 GMT+02:00 Enzo Cocca <enzo.ccc at gmail.com>:
> Hi all,
>
> I have a question: It's possible ti create a flow or directional raster map
> in R like this (
> http://www.google.it/imgres?imgurl=http%3A%2F%2Fproceedings.esri.com%2Flibrary%2Fuserconf%2Fproc97%2Fproc97%2Fto200%2Fpap198%2Fp1983.gif&imgrefurl=http%3A%2F%2Fforums.esri.com%2FThread.asp%3Fc%3D93%26f%3D982%26t%3D287847&h=287&w=288&tbnid=WvjYx-ljqQDDXM%3A&zoom=1&docid=NjxmMaQ0WgGvOM&ei=vBBFU-OfNoGL7AbPk4GgCQ&tbm=isch&ved=0CFkQhBwwAQ&iact=rc&dur=462&page=1&start=0&ndsp=17?
> )
>
> If yes How can I to do it?
>
> thanks
>
>
>
> --
> Enzo Cocca (PhD Candidate)
> Research Fellow
> Universit? di Napoli "L'Orientale"
> mail: enzo.ccc at gmail.com
> cell: +393495087014
>
>         [[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From alobolistas at gmail.com  Wed Apr  9 15:27:02 2014
From: alobolistas at gmail.com (Agustin Lobo)
Date: Wed, 9 Apr 2014 15:27:02 +0200
Subject: [R-sig-Geo] NAvalue() from raster not working?
Message-ID: <CAG4NReJ4ogg2F-uzjhzQvb5Yuge3ibWMAYj=3uH4jNeUxR0ojQ@mail.gmail.com>

I have raster layers with may nodata values (-10000)
I set them as NAvalues but nothing seems to change:

r <- raster(matrix(runif(100),nrow=10))
r[seq(10,100,by=10)]<- -10000
cellStats(r,mean)
[1] -999.521

NAvalue(r) <- -10000
cellStats(r,mean)
[1] -999.521

Instead:
r[r==-10000] <- NA
cellStats(r,mean)
[1] 0.5322636

is this the intentional behaviour?
what is NAvalues() for in that case?
Thanks
Agus


From kridox at ymail.com  Wed Apr  9 15:39:00 2014
From: kridox at ymail.com (Pascal Oettli)
Date: Wed, 9 Apr 2014 22:39:00 +0900
Subject: [R-sig-Geo] NAvalue() from raster not working?
In-Reply-To: <CAG4NReJ4ogg2F-uzjhzQvb5Yuge3ibWMAYj=3uH4jNeUxR0ojQ@mail.gmail.com>
References: <CAG4NReJ4ogg2F-uzjhzQvb5Yuge3ibWMAYj=3uH4jNeUxR0ojQ@mail.gmail.com>
Message-ID: <CAAcyNCxn1bGLCfeedF3v4zbs6W5cqoXR04iteLyQnQ+=8ngACw@mail.gmail.com>

Hello,

In the help file of "NAvalue", it is written : "Values already in
memory will not be affected."

r <- raster(matrix(runif(100),nrow=10))
r[seq(10,100,by=10)]<- -10000
inMemory(r)
[1] TRUE

Regards,
Pascal

On Wed, Apr 9, 2014 at 10:27 PM, Agustin Lobo <alobolistas at gmail.com> wrote:
> I have raster layers with may nodata values (-10000)
> I set them as NAvalues but nothing seems to change:
>
> r <- raster(matrix(runif(100),nrow=10))
> r[seq(10,100,by=10)]<- -10000
> cellStats(r,mean)
> [1] -999.521
>
> NAvalue(r) <- -10000
> cellStats(r,mean)
> [1] -999.521
>
> Instead:
> r[r==-10000] <- NA
> cellStats(r,mean)
> [1] 0.5322636
>
> is this the intentional behaviour?
> what is NAvalues() for in that case?
> Thanks
> Agus
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Pascal Oettli
Project Scientist
JAMSTEC
Yokohama, Japan


From bakare at ualberta.ca  Thu Apr 10 00:17:38 2014
From: bakare at ualberta.ca (Moshood Agba Bakare)
Date: Wed, 9 Apr 2014 16:17:38 -0600
Subject: [R-sig-Geo] gstat: Parameter estimate Matern vs exponential
	variogram model
Message-ID: <CAJRR3XPPvpaBY1FE_FuVL5W39DHcD_qxzF68AhLn-wG+d1_Msg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140409/9e98d07a/attachment.pl>

From amsantac at hotmail.com  Thu Apr 10 02:39:32 2014
From: amsantac at hotmail.com (=?iso-8859-1?B?QWztIFNhbnRhY3J1eg==?=)
Date: Wed, 9 Apr 2014 20:39:32 -0400
Subject: [R-sig-Geo] Genetic Algorithm in R?
In-Reply-To: <CACgt3o=9CR5J-JjHCfRmY_uC7pkt077Bk1XyVmHOonHfBxgbzw@mail.gmail.com>
References: <CACgt3o=9CR5J-JjHCfRmY_uC7pkt077Bk1XyVmHOonHfBxgbzw@mail.gmail.com>
Message-ID: <BLU173-W47D3F783AA10D0E432FEEFC9550@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140409/1cbeff1b/attachment.pl>

From annajess at gmx.de  Thu Apr 10 10:07:23 2014
From: annajess at gmx.de (Anna-Marie Corman)
Date: Thu, 10 Apr 2014 10:07:23 +0200
Subject: [R-sig-Geo] kernelbb: getverticeshr and kernel.area do not return
	same results
Message-ID: <5346513B.3070609@gmx.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140410/c9946b65/attachment.pl>

From edzer.pebesma at uni-muenster.de  Thu Apr 10 10:39:25 2014
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 10 Apr 2014 10:39:25 +0200
Subject: [R-sig-Geo] gstat: Parameter estimate Matern vs exponential
	variogram model
In-Reply-To: <CAJRR3XPPvpaBY1FE_FuVL5W39DHcD_qxzF68AhLn-wG+d1_Msg@mail.gmail.com>
References: <CAJRR3XPPvpaBY1FE_FuVL5W39DHcD_qxzF68AhLn-wG+d1_Msg@mail.gmail.com>
Message-ID: <534658BD.7050208@uni-muenster.de>

This is well known, see e.g. Ribeiro & Diggle, "Model-based
geostatistics", 2007, page 51. The point of the Matern model is that
different values of kappa represent random fields with different degrees
of smoothness, the exponential, fixing kappa at 0.5, does not provide
that. Nobody can tell you upfront how smooth the variable is from which
you obtained data.

On 04/10/2014 12:17 AM, Moshood Agba Bakare wrote:
> Hi all,
> I used gstat to fit Matern variogram model to my crop yield by setting the
> kappa = 0.5. To my surprise, its parameters estimate are exactly the same
> with that of exponential. Does it mean there is no point in fitting matern
> model? When I set the kappa = 0.7, the parameters estimate are now
> different from that of exponential. Could anyone tell me the appropriate
> value for kappa? Having known that matern is a generalized form of
> theoretical variogram, does it worth fitting matern model when I have
> already fitted the common theoretical variogram (spherical Gaussian, and
> exponential)
> 
> 
> exponential model
> 
> model      psill   range
> 1   Nug 0.04281109 0.00000
> 2   Exp 0.76810071 5.45954
> 
> 
> 
> 
> 
> Matern Model
> 
>   model      psill   range kappa
> 1   Nug 0.04281109 0.00000   0.0
> 2   Mat 0.76810071 5.45954   0.5
> 
> 
> 
> 
> 
> R Script
> 
> ## Exponential variogram model
> exp.var<-vgm(psill = 0.7, model = "Exp", range = 10, nugget= 0.1)
> exp.mod<-fit.variogram(empvar,model=exp.var)
> print(exp.mod)
> plot(empvar,model=exp.mod, xlab = "Lag distance (m)", ylab =
> "Semivariance",main="Exponential variogram model")
> 
> 
> 
> 
> 
> ## Matern variogram model
> mat.var<-vgm(psill = 0.7, model = "Mat", range = 10, nugget = 0.1,kappa = 0.7)
> mat.mod<-fit.variogram(empvar,model = mat.var)
> print(mat.mod)
> plot(empvar,model = mat.mod, xlab = "Lag distance (m)", ylab =
> "Semivariance", main="Matern variogram model")
> 
> 
> 
> Thanks
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140410/2cf1f654/attachment.bin>

From Clement.Calenge at oncfs.gouv.fr  Thu Apr 10 11:01:11 2014
From: Clement.Calenge at oncfs.gouv.fr (Calenge Clement)
Date: Thu, 10 Apr 2014 09:01:11 +0000
Subject: [R-sig-Geo] kernelbb: getverticeshr and kernel.area do not
 return	same results
References: <5346513B.3070609@gmx.de>
Message-ID: <EF5D3065747CC8438B3B16856EF7F7B733359BF6@SVRDSI078MBX02V>

Dear Anna-Marie,


> I have a problem with calculating UD areas: I calculated UDs by
> kernelbb(). When I use the getverticeshr command and after that the
> kernel.area command, the results differ. Does anyone see my mistake?

The mistake is here:

kernelcontoursha111_50  <- getverticeshr(ha111BbKern,lev=50, unout="km2")

The level should not be defined with lev, but with percent (see the help 
page of getverticeshr). The correct code should therefore be:

kernelcontoursha111_50  <- getverticeshr(ha111BbKern, percent=50, 
unout="km2")

However, note that the two approaches do not rely on the same algorithm 
to calculate the area of the kernel home range, so that a small 
difference is expected. On one hand, getverticeshr vectorizes the 
contour of the home range (i.e. finds the coordinates of the vertices of 
the contour polygon corresponding to a given isopleth) and then 
calculates the area of the resulting polygon. On the other hand, 
kernel.area uses the raster grid used for the kernel estimation to find 
the pixels located in the home range, and then sums the areas of these 
pixels. Therefore, a small variation is expected due to the difference 
of modes (vector vs. raster) used in calculations.

For example, consider the following example (just copy and paste in R):

## use the dataset puechcirc
library(adehabitatHR)
data(puechcirc)
x <- puechcirc[1]
ud <- kernelbb(x, sig1 = 6.23, sig2 = 58, grid = 100)
kernel.area(ud, unout="km2", percent=50)
#       50
#0.3231074
getverticeshr(ud, unout="km2", percent=50)
#Object of class "SpatialPolygonsDataFrame" (package sp):
#
#Number of SpatialPolygons:  1
#
#Variables measured:
#                 id      area
#homerange homerange 0.3164564

as you can see, the two results are pretty similar, though not exactly 
identical.

Best regards,


Cl?ment Calenge




>
> Thanks a lot and best regards,
> Anna
>
>
>> head(dcol[,c(1:11,17,25:27)])
>           date day month year hour minute second time_sec time_diff latitude longitude
> 1 13.05.2011  13     5 2011   21     11     33    76293       186 54.70463  8.349938
> 2 13.05.2011  13     5 2011   21     14     37    76477       184 54.70479  8.349722
> 3 13.05.2011  13     5 2011   21     17     40    76660       183 54.70548  8.344133
> 4 13.05.2011  13     5 2011   21     20     44    76844       184 54.71007  8.338260
> 5 13.05.2011  13     5 2011   21     23     48    77028       184 54.72099  8.320427
> 6 13.05.2011  13     5 2011   21     26     52    77212       184 54.73233  8.312453
>      bird_id                 cet   xKoord  yKoord
> 1 HA1_2011 2011-05-13 21:11:33 458111.9 6062117
> 2 HA1_2011 2011-05-13 21:14:37 458098.1 6062135
> 3 HA1_2011 2011-05-13 21:17:40 457738.7 6062216
> 4 HA1_2011 2011-05-13 21:20:44 457365.1 6062730
> 5 HA1_2011 2011-05-13 21:23:48 456227.9 6063956
> 6 HA1_2011 2011-05-13 21:26:52 455726.7 6065223
>
>
>
> #### create ltraj elements:
> ##HA1_2011
> ha111<-subset(dcol,bird_id=="HA1_2011")
> ha111time <- ha111[, c("cet")]
> ha111XY <- ha111[,c("xKoord", "yKoord")]
> ha111ltraj <- as.ltraj(ha111XY, ha111time, id="HA1_2011")
> ha111Liker <- liker (ha111ltraj, sig2=20, rangesig1=c(1,100) )
> ha111Liker
> head(ha111Liker)
> ha111BbKern <- kernelbb(ha111ltraj, sig1=18.5405, sig2=20)
>
> kernelcontoursha111_50  <- getverticeshr(ha111BbKern,lev=50, unout="km2")
> # Object of class "SpatialPolygonsDataFrame" (package sp):
>
> Number of SpatialPolygons:  1
>
> Variables measured:
>                    id     area
> homerange homerange 6.055773
>
> ## kernel areas:
> ha111area<-kernel.area(ha111BbKern, unout=c("km2"),percent=50) ## 0.9744107
>
>
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


-- 
Cl?ment CALENGE
Cellule d'appui ? l'analyse de donn?es
Direction des Etudes et de la Recherche
Office national de la chasse et de la faune sauvage
Saint Benoist - 78610 Auffargis
tel. (33) 01.30.46.54.14


From frtog at vestas.com  Thu Apr 10 15:31:49 2014
From: frtog at vestas.com (=?iso-8859-1?Q?Frede_Aakmann_T=F8gersen?=)
Date: Thu, 10 Apr 2014 15:31:49 +0200
Subject: [R-sig-Geo] where does that additional outer margin comes from when
 using sp::image or sp::spplot on SpatialPixelsDataFRame data?
Message-ID: <B078CDF40DFE4045AF172A8B4F68FC4857C5BF2FF8@DKRDSEXC016.vestas.net>

Hi

First, thank you for a great package.

I can't figure out where this additional outer margin comes from. The following script illustrates it. To download my data use the DropBox link.


library(sp)

## Here is a link to my data on my DropBox account
dropBoxFile <- "https://www.dropbox.com/s/9853s5pempoapzf/xyz.R"

## source(dropBoxFile)
## or if for security reasons then you're more secure to download through web browser
## inspect data before you source it ;-)

myBreaks <- seq(2,11.5, by = 0.5)
mycols1 <- c("#FFFFFF", "#D5D5D5", "#AAAAAA", "#808080", "#000080", "#0080BF",
             "#00FFFF", "#004000", "#009F00", "#00FF00", "#FF8000", "#FFBF00",
             "#FFFF00", "#800000", "#BF0000", "#FF0000", "#800080", "#BF40BF",
             "#FF80FF")

## Removing plot margins works for meuse.grid data set

data(meuse.grid)
meuse <- SpatialPixelsDataFrame(points = meuse.grid[c("x", "y")], data = meuse.grid)

dims <- meuse at grid@cells.dim

## on Windows
windows(width = dims[1], height = dims[2])

## on linux
## X11(width = 78, height = 104)

## first with plot margins
image(meuse[3], bg = "grey80")

## use all plot area for plot
par('plt')

par(mar=rep(0,4))

par('plt')

image(meuse[3], bg = "grey80")

## For my data a sort of margin is produced using sp plotting functions

dims <- xyz at grid@cells.dim
windows(width = dims[1], height = dims[2])
par('plt')

### there is both a white and grey "margin"
image(xyz, col = mycols1, bg = "grey80", aspect = "iso")

## can get rid of white margin
## but not the grey
par(mar=c(0,0,0,0))#, pty = "m")
par('plt')

## still a gray "margin"
image(xyz[1], col = mycols1, breaks = myBreaks, bg = "grey80", aspect = "iso")

## Also this is not working
spplot(xyz[1], at = myBreaks, col.regions = mycols1, aspect = "iso")

## same class of data
str(meuse)
str(xyz)


## I can get this to work
x <- unique(xyz$x)
y <- unique(xyz$y)
z <- xyz$z
dim(z) <- c(length(x), length(y))

image.default(x, y, z, breaks = myBreaks, col = mycols1, bg = "grey80")

Thank you for your help.


Yours sincerely / Med venlig hilsen
data

Frede Aakmann T?gersen
Specialist, M.Sc., Ph.D.
Plant Performance & Modeling

Technology & Service Solutions
T +45 9730 5135
M +45 2547 6050
frtog at vestas.com
http://www.vestas.com

Company reg. name: Vestas Wind Systems A/S
This e-mail is subject to our e-mail disclaimer statement.
Please refer to www.vestas.com/legal/notice
If you have received this e-mail in error please contact the sender. 


From ariel.fuentesdi at usach.cl  Thu Apr 10 16:38:52 2014
From: ariel.fuentesdi at usach.cl (Ariel Fuentesdi)
Date: Thu, 10 Apr 2014 10:38:52 -0400
Subject: [R-sig-Geo] UTM coordinates
Message-ID: <CAD0a9Kg6TqmuRuzsGShFkaT_amf8tFmcnqCh4NxyFTuCu=H9kw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140410/725b5f4a/attachment.pl>

From ariel.fuentesdi at usach.cl  Thu Apr 10 16:58:12 2014
From: ariel.fuentesdi at usach.cl (Ariel Fuentesdi)
Date: Thu, 10 Apr 2014 10:58:12 -0400
Subject: [R-sig-Geo] UTM coordinates
Message-ID: <CAD0a9KiZ8DjB92oRNW6g_PMgW42PwaLjU0jkfbL_PD2zTrgyxg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140410/7ef8996d/attachment.pl>

From annajess at gmx.de  Thu Apr 10 18:43:27 2014
From: annajess at gmx.de (Anna-Marie Corman)
Date: Thu, 10 Apr 2014 18:43:27 +0200
Subject: [R-sig-Geo] BRB command for several animals?
Message-ID: <5346CA2F.2020501@gmx.de>

Dear all,

as I want to calculate UDs for several tagged individuals of one colony, 
I wondered if it's possible to calculate UDs with the BRB command of 
several animals simultaneously? Or does it only work with the kernelUD 
command?

Thanks a lot in advance,
Anna


From milansharma2012 at yahoo.com  Thu Apr 10 21:35:50 2014
From: milansharma2012 at yahoo.com (Milan Sharma)
Date: Thu, 10 Apr 2014 12:35:50 -0700 (PDT)
Subject: [R-sig-Geo] INterpretation of AIC
Message-ID: <1397158550.86562.YahooMailNeo@web120001.mail.ne1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140410/06bf5bc2/attachment.pl>

From zaholdenfs at gmail.com  Thu Apr 10 22:06:58 2014
From: zaholdenfs at gmail.com (Zack Holden)
Date: Thu, 10 Apr 2014 13:06:58 -0700
Subject: [R-sig-Geo] decimals in NA value using raster::writeRaster with
	.ascii format
Message-ID: <CAGC_mZTEpDOwYVQh7ZEBgnjgRWjPn2HdK5-9NjQ7RQ_9jm5qTg@mail.gmail.com>

Dear list,

I am creating ascii files as inputs to the PCraster software (no other
gdal format is allowed). When I write my ascii file using
raster::writeRaster, the first cell of every raster that I write has a
large number of decimal values appended to it. This causes errors
later in the model workflow.

This also happens to the first NA value in the file, so that all NA
values in the file are e.g. -9999 except the first cell. which appears
as: -9999.00000000000

Can anyone suggest a method for ensuring that all of my NA values are
identical and with no trailing decimals?

A small reproducible example follows. Any help or suggestions is appreciated.

Thanks,
Zack

##################
# start code
require(raster)
r <- raster(nrows=2, ncols=2, xmn=0, xmx=2, ymn=0, ymx=2)
r <- setValues(r, seq(1:ncell(r)))
rexpand <- extend(r, c(2,2))
NAvalue(rexpand) <- -9999

temp.dir <- "/home/zholden/"
writeRaster(rexpand, file=paste(temp.dir, "testraster.asc",sep=""),
NAflag=-9999, dataType="INT2U", overwrite=T)
# end code
##################

# opening in a text editor reveals trailing decimals in the first NA value.
system(paste("gedit ", temp.dir, "testraster.asc", sep=""))

################################
 sessionInfo()
R version 3.0.2 (2013-09-25)
Platform: x86_64-redhat-linux-gnu (64-bit)

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
LC_MONETARY=en_US.UTF-8
 [6] LC_MESSAGES=en_US.UTF-8    LC_PAPER=en_US.UTF-8       LC_NAME=C
               LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] rgdal_0.8-16  raster_2.2-12 sp_1.0-14

loaded via a namespace (and not attached):
[1] grid_3.0.2      lattice_0.20-23 tools_3.0.2


From pingyang.whu at gmail.com  Thu Apr 10 23:49:22 2014
From: pingyang.whu at gmail.com (ping yang)
Date: Thu, 10 Apr 2014 16:49:22 -0500
Subject: [R-sig-Geo] issue in using projectRaster in raster library
In-Reply-To: <CABG0rfuJoRs5YhLJsxiwMguWcj1TMGZa_tDSy=A9uKzD20kKig@mail.gmail.com>
References: <CAK8gSG-zmjVhAkH9eBZetq4G47w9Ym3z3fwr=FNZB4hirMKS3Q@mail.gmail.com>
	<CACwzsXEJJpxGMwNmzfTc6=Jt8OyYZe9GzT8dBUc5oM+2wqGsbA@mail.gmail.com>
	<CABG0rfu2Nnh5Ah98K-xRwJMDRs+_90JKjZ76Pfcewrc6jaKDAg@mail.gmail.com>
	<CAK8gSG81UwLHqc0z4paX-T2yJF13L5T9ptpY25Sifgq8vjMjKQ@mail.gmail.com>
	<CABG0rftD0BECeaF0wDA97jbBhHdsLH3-g-yP+zUwCJ2yXi8Tsw@mail.gmail.com>
	<CAK8gSG_y586EmrHuVZ6g3+G3Ug8sLdo-XdkFTqpRgZGiVg3NPg@mail.gmail.com>
	<CABG0rfuJoRs5YhLJsxiwMguWcj1TMGZa_tDSy=A9uKzD20kKig@mail.gmail.com>
Message-ID: <CAK8gSG_Lb02Btes1TysFYLTbU7ApeLC=NSjY5rECsDUz-03ykA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140410/6a0c3cc8/attachment.pl>

From jgrn at illinois.edu  Fri Apr 11 00:20:03 2014
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Thu, 10 Apr 2014 17:20:03 -0500
Subject: [R-sig-Geo] issue in using projectRaster in raster library
In-Reply-To: <CAK8gSG_Lb02Btes1TysFYLTbU7ApeLC=NSjY5rECsDUz-03ykA@mail.gmail.com>
References: <CAK8gSG-zmjVhAkH9eBZetq4G47w9Ym3z3fwr=FNZB4hirMKS3Q@mail.gmail.com>
	<CACwzsXEJJpxGMwNmzfTc6=Jt8OyYZe9GzT8dBUc5oM+2wqGsbA@mail.gmail.com>
	<CABG0rfu2Nnh5Ah98K-xRwJMDRs+_90JKjZ76Pfcewrc6jaKDAg@mail.gmail.com>
	<CAK8gSG81UwLHqc0z4paX-T2yJF13L5T9ptpY25Sifgq8vjMjKQ@mail.gmail.com>
	<CABG0rftD0BECeaF0wDA97jbBhHdsLH3-g-yP+zUwCJ2yXi8Tsw@mail.gmail.com>
	<CAK8gSG_y586EmrHuVZ6g3+G3Ug8sLdo-XdkFTqpRgZGiVg3NPg@mail.gmail.com>
	<CABG0rfuJoRs5YhLJsxiwMguWcj1TMGZa_tDSy=A9uKzD20kKig@mail.gmail.com>
	<CAK8gSG_Lb02Btes1TysFYLTbU7ApeLC=NSjY5rECsDUz-03ykA@mail.gmail.com>
Message-ID: <CABG0rfvcJVAx_+EYFJjFbcU84hng1tZYtksQco3Z-is55zyUfg@mail.gmail.com>

Responses below:

On Thu, Apr 10, 2014 at 4:49 PM, ping yang <pingyang.whu at gmail.com> wrote:
> Hi Jonathan,
>
> I am using GDAL 1.9.2 and -wo NUM_THREADS=ALL_CPUS didn't work. Actually I
> have several thousands file to process, so I am thinking of the foreach, I
> changed the code as follows:

GDAL 1.9.2 is pretty old (October 2012) -- I'd recommend upgrading to
1.10.1 -- I think they added the parallel support around v. 1.10.0.
OSGeo4W is my install of choice for Windows, but you can see the
various versions at:
http://trac.osgeo.org/gdal/wiki/DownloadingGdalBinaries  Also, you
need to use the -multi parameter as well, otherwise it will ignore the
-wo NUM_THREADS=ALL_CPUS.


> ProjectANDSlope<- function(zipfile)
> {
>   require(raster)
>   require(rgdal)
>   require(gdalUtils)
>   require(foreach)
>   zipfile <-filelist[i]
>   #First Unzip the file
>   unzip(zipfile,overwrite = TRUE,exdir = "../UNZIPPED")
>   longitude <- paste("-",substr(zipfile,5,7),sep="")
>   lon <- as.numeric(longitude)
>   zoneNo <- (floor((lon + 180)/6) %% 60) + 1
>   utm <-paste("+proj=utm +zone=",zoneNo," +datum=NAD83 +ellps=GRS80
> +towgs84=0,0,0 +units=m +no_defs",sep="")
>   outputfile <- paste("../PROJECTED/",substr(zipfile,1,7),".tif",sep='')
>   inputfile <- paste("../UNZIPPED/grd",substr(zipfile,1,7),"_13",sep="")
>   #Project Raster to UTM
>   gdalwarp(srcfile=inputfile, dstfile=outputfile,
> t_srs=utm,output_Raster=TRUE,overwrite=TRUE,multi=TRUE,
> tr=c(10,10),r="bilinear", verbose=TRUE)
>   #Generate Slope raster
>   slopefile <- paste("../SLOPE/",substr(zipfile,1,7),".tif",sep='')
>   gdaldem(mode="slope",input_dem=outputfile,
> output=slopefile,compute_edges=TRUE,output_Raster=TRUE,verbose=TRUE)
>   #delete the intermedia files
>   unlink(inputfile,recursive=TRUE,force=TRUE)
> }
>
> and use different methods to run it, First I use:
> filelist <-dir(".",pattern="n*.zip") #all the file list
> system.time(
> for(i in 21:30)
> {
>   ProjectANDSlope(filelist[i])
> }
> )
> The time used
>    user  system elapsed
>   25.58   36.31  810.08
> Then I used foreach (do and dopar)
> system.time(
> foreach(i=21:30) %dopar% ProjectANDSlope(filelist[i])
> )
>
> The time used:
>    user  system elapsed
>   24.86   35.50  757.93
>
> not much improved, then I realized that I didn't generate the parallel
> backend, I added the following code:
> require(parallel)
> Sys.getenv('NUMBER_OF_PROCESSORS') "8"
> cl <-makeCluster(4)
> But I get errors:
> Error in socketConnection("localhost", port = port, server = TRUE, blocking
> = TRUE,  :
>   cannot open the connection
> In addition: Warning message:
> In socketConnection("localhost", port = port, server = TRUE, blocking =
> TRUE,  :
>   port 11216 cannot be opened

This looks like a potential firewall problem -- but you also need to
register it with foreach -- this is a good question for r-sig-hpc, by
the way, since that is where the foreach people tend to hang out.  try
something like:

cl <- makeCluster(spec=4,type="PSOCK")
registerDoParallel(cl)

Keep in mind, if you don't see your CPUs being pegged it is because
you are (likely) I/O limited.

Incidentally, the "cleaner" way to use packages with foreach is using
the .packages= parameter rather than using require():
foreach(...,.packages=c("raster","rgdal","gdalUtils")) # You don't
need to require foreach -- it is autoloaded

> I don't know what happened(I remember I used the makeCluster before but now
> it is not working). By the way, can you help to specify how to compare the
> two methods (
> parallel processing each individual image vs. parallel processing multiple
> images at the same time)?

The idea is for a lot of files, you can approach it in two ways:
1) Sequentially loop through each file, but parallelize the single
file processing (e.g. using -multi -wo NUM_THREADS=ALL_CPUS in GDAL)
-- when you see all the processors light up, this is processing ONE
file.
2) Parallel loop through your files -- each CPU ("worker"), then, is
processing a SINGLE file, but you are processing multiple files at the
same time.  This would be more like what you are trying to accomplish
above (using foreach).

Slope calculations are a form of focal-window analysis which can be
CPU limited, so I think #2 is the right way to go.  If you are trying
to cut down the time, you should look for bottlenecks -- are you
reading and writing to the same drive?  Are you doing it over a
network?  Things like that can really slow the process down.

--j



> Look forward to hearing from you.
>
> Thanks,
>
> Ping
>
>
>
> On Tue, Apr 8, 2014 at 5:42 PM, Jonathan Greenberg <jgrn at illinois.edu>
> wrote:
>>
>> Ping:
>>
>> Re: raster:::projectRaster I'm not sure how much you can speed that up
>> (Robert?) -- I think it is native R code which is generally a lot
>> slower than compiled code like the GDAL utilities.  It has to use
>> "chunking", but for reasonable chunk sizes this is not likely to cause
>> any noticeable overhead.
>>
>> Re: gdalUtils vs. cygwin -- you got basically the same execution time
>> -- 21.15 vs. 20.7 seconds is not worth worrying about (~ a 2% increase
>> using gdal from R)-- gdalUtils has the (small) overhead from R, but it
>> is actually using your installed gdalwarp in cygwin anyway, it is just
>> an R wrapper for it if you are more comfortable using R functions vs.
>> command line.  The first time you launch gdalwarp in an R session it
>> takes a few seconds to find your local installation of GDAL -- the
>> second time it runs, there should be almost no overhead.
>>
>> Re: parallelization -- if you have GDAL 1.10.1 or later (perhaps a
>> slightly earlier version, not sure when it was implemented), you can
>> use -multi -wo NUM_THREADS=ALL_CPUS to parallelize the operation -- in
>> gdalUtils, this would be:
>>
>> gdalwarp(...,multi=TRUE,wo="NUM_THREADS=ALL_CPUS")
>>
>> # See: http://lists.osgeo.org/pipermail/gdal-dev/2012-June/033084.html
>>
>> If you are trying to warp a LOT of images, you can also use e.g.
>> foreach() to warp each image using a different thread.  You'd have to
>> experiment with which one (loop through each image one at a time,
>> parallel processing each individual image vs. parallel processing
>> multiple images at the same time) is more efficient.
>>
>> --j
>>
>>
>>
>>
>> On Tue, Apr 8, 2014 at 4:50 PM, ping yang <pingyang.whu at gmail.com> wrote:
>> > Hi Jonathan,
>> >
>> > I am following up with the previous thread, Now I successfully installed
>> > the
>> > gdalUtils from the source and ran successfully the task (both projection
>> > and
>> > slope calculation) using the following script:
>> >
>> > rasterOptions(chunksize = 3e+07, maxmemory = 1e+08) #suggestions
>> > according
>> > to Jonanthan, it made the raster::projectRaster work but for much longer
>> > time such as 40 minutes!!!
>> >
>> > #*----Function for detect the UTM Zone-----#
>> > long2UTM <- function(long) {
>> >   (floor((long + 180)/6) %% 60) + 1
>> > }
>> >
>> >   filename <- "grdn41w083_13"
>> >   longitude <- paste("-",substr(filename,9,10),sep="") #this could be
>> > change
>> > according to the directory string
>> >   lon <- as.numeric(longitude)
>> >   utm <-paste("+proj=utm +zone=",long2UTM(lon)," +datum=NAD83
>> > +ellps=GRS80
>> > +towgs84=0,0,0 +units=m +no_defs",sep="")
>> >   outputfile <-
>> > paste("projected/",substr(filename,4,10),"_raster.tif",sep='')
>> >   gdalwarp(srcfile=filename, dstfile=outputfile,
>> > t_srs=utm,output_Raster=TRUE,overwrite=TRUE,multi=TRUE,
>> > tr=c(10,10),r="bilinear", verbose=TRUE)
>> >   slp <- gdaldem(mode="slope",input_dem=outputfile,
>> > output="n41w083_rgdalslp.tif",output_Raster=TRUE,verbose=TRUE)
>> >
>> > Now it took me 21.15 seconds to finish the projection(while using the
>> > gdalWarp in cygwin took about 20.7 seconds)
>> >
>> > I am wondering if there is way to speed up this process, How to parallel
>> > this process(parallelized warping)?
>> >
>> > Big Thanks,
>> >
>> > Ping
>> >
>> >
>> >
>> > On Mon, Apr 7, 2014 at 11:37 PM, Jonathan Greenberg <jgrn at illinois.edu>
>> > wrote:
>> >>
>> >> For gdalUtils, you don't need to upgrade to 3.2 -- the latest CRAN
>> >> version only requires R 2.14 or later.  It should find your cygwin
>> >> version, but let me know if it doesn't.
>> >>
>> >> The key with the rasterOptions you used is that, previously, you were
>> >> forcing the ENTIRE RASTER to load into memory with the max memory and
>> >> chunk size you used -- this is really not a good idea for 99.9% of
>> >> raster calculations.  I would try two things: 1) reduce the max memory
>> >> back to its default settings (1e+08 cells on my machine -- about 750mb
>> >> of RAM usage if each cell is 64 bits), and 2) adjust the chunk size to
>> >> maybe 250mb (3e+07 cells)  If you leave your settings like that,
>> >> particularly on Windows, you'll end up with out-of-memory crashes
>> >> fairly often (since I'm guessing you don't have 8TB of RAM on a
>> >> Windows box).
>> >>
>> >> --j
>> >>
>> >>
>> >>
>> >> On Mon, Apr 7, 2014 at 4:47 PM, ping yang <pingyang.whu at gmail.com>
>> >> wrote:
>> >> > Hi Alex and Jonathan,
>> >> >
>> >> > The reason I used the rasterOptions is because when previously I did
>> >> > the
>> >> > reproject for 30 meter DEM, it worked after I raised the
>> >> > chunksize(otherwise
>> >> > it ran out of memory), so I added here just to avoid that
>> >> > issue(probably
>> >> > it
>> >> > not work  for this case)
>> >> >
>> >> > I am going to install gdalUtils package, however, I need to upgrade
>> >> > my R
>> >> > from 3.0.1 to 3.2 (I am afraid to do it since some other work is
>> >> > running).
>> >> >
>> >> > However, I have an update for this, i used the gdalwarp in my
>> >> > Cygwin(actually installed by the QGIS) and run it successfully:
>> >> > gdalwarp -t_srs '+proj=utm +zone=17 +datum=NAD83 +units=m +no_defs
>> >> > +ellps=GRS80 +towgs84=0,0,0' -r bilinear -multi -tr 10 10 -of GTiff
>> >> > grdn41w083_13/hdr.adf n41w083.tif
>> >> >
>> >> > it took 11 second to finish.
>> >> >
>> >> > I am still looking for the slop calculation based on the projected
>> >> > tif
>> >> > file,
>> >> > I will appreciated if anyone could give me some suggestions if have
>> >> > this
>> >> > experience.
>> >> >
>> >> > Thanks a lot.
>> >> >
>> >> > Ping
>> >> >
>> >> >
>> >> > On Mon, Apr 7, 2014 at 3:42 PM, Jonathan Greenberg
>> >> > <jgrn at illinois.edu>
>> >> > wrote:
>> >> >>
>> >> >> Ping:
>> >> >>
>> >> >> Re: maxmemory -- you really shouldn't adjust that, definitely not to
>> >> >> what you set it to -- you've set it to (by my quick calculations) to
>> >> >> be around 7500 GB of needed memory (this is assuming each cell takes
>> >> >> 64 bits of space) -- this is probably why you are crashing.
>> >> >> Chunksize
>> >> >> also is usually set correctly, raster processes generally have a
>> >> >> quickly diminishing returns as you increase the chunk size.
>> >> >>
>> >> >> You might want to try gdalwarp in my gdalUtils package -- it will be
>> >> >> faster to reproject, and you can even enable parallelized warping.
>> >> >>
>> >> >> install.packages("gdalUtils",
>> >> >> repos="http://R-Forge.R-project.org",type="source") # To get the
>> >> >> latest, otherwise just use CRAN
>> >> >>
>> >> >> --j
>> >> >>
>> >> >> On Mon, Apr 7, 2014 at 3:30 PM, Alex Zvoleff
>> >> >> <azvoleff at conservation.org>
>> >> >> wrote:
>> >> >> > On Mon, Apr 7, 2014 at 4:05 PM, ping yang <pingyang.whu at gmail.com>
>> >> >> > wrote:
>> >> >> >
>> >> >> >> Dear r-sig-geo,
>> >> >> >>
>> >> >> >> I plan to reproject from lonlat to UTM for a bunch of 10 meter
>> >> >> >> NED
>> >> >> >> files
>> >> >> >> (large) using a R script(I did it successfully for the 30 meter
>> >> >> >> DEM), I
>> >> >> >> used the following code to run:
>> >> >> >>
>> >> >> >> rasterOptions(chunksize = 1e+10, maxmemory = 1e+12) #need to
>> >> >> >> allow
>> >> >> >> bigger
>> >> >> >> chunksize for the processing!!!
>> >> >> >>
>> >> >> >
>> >> >> > Why do you find that you "need to allow bigger chunksize"? I
>> >> >> > rarely
>> >> >> > need
>> >> >> > to
>> >> >> > adjust the chunksize, even for large images.
>> >> >> >
>> >> >> >
>> >> >> >>  #*----Function for detect the UTM Zone-----#
>> >> >> >> long2UTM <- function(long) {
>> >> >> >>   (floor((long + 180)/6) %% 60) + 1
>> >> >> >> }
>> >> >> >>
>> >> >> >>   require(raster)
>> >> >> >>   require(rgdal)
>> >> >> >>   filename <- "grdn41w083_13"
>> >> >> >>   longitude <- paste("-",substr(filename,9,10),sep="")
>> >> >> >>   lon <- as.numeric(longitude)
>> >> >> >>   utm <-paste("+proj=utm +zone=",long2UTM(lon)," +datum=NAD83
>> >> >> >> +ellps=GRS80
>> >> >> >> +towgs84=0,0,0 +units=m +no_defs",sep="")
>> >> >> >>   r  <- raster(filename)
>> >> >> >>   outputfile <-
>> >> >> >> paste("projected/",substr(filename,4,10),".tif",sep='')
>> >> >> >>   print(paste(outputfile))
>> >> >> >>   pr <- projectRaster(r, crs=utm, res=10.0, method='bilinear')
>> >> >> >>
>> >> >> >> However, the projectRaster takes forever to finish and it almost
>> >> >> >> crashed my
>> >> >> >> computer.
>> >> >> >>
>> >> >> >> The file is kind of big  (file size is 455MB),The file
>> >> >> >> information
>> >> >> >> is
>> >> >> >> class       : RasterLayer
>> >> >> >> dimensions  : 10812, 10812, 116899344  (nrow, ncol, ncell)
>> >> >> >> resolution  : 9.259259e-05, 9.259259e-05  (x, y)
>> >> >> >> extent      : -83.00056, -81.99944, 39.99944, 41.00056  (xmin,
>> >> >> >> xmax,
>> >> >> >> ymin,
>> >> >> >> ymax)
>> >> >> >> coord. ref. : +proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0
>> >> >> >> +no_defs
>> >> >> >> data source : c:\temporary\10M\grdn41w083_13
>> >> >> >> names       : grdn41w083_13
>> >> >> >> values      : 212.254, 460.0799  (min, max)
>> >> >> >>
>> >> >> >> My R information:
>> >> >> >> sessionInfo()
>> >> >> >> R version 3.0.1 (2013-05-16)
>> >> >> >> Platform: x86_64-w64-mingw32/x64 (64-bit)
>> >> >> >> attached base packages:
>> >> >> >> [1] stats     graphics  grDevices utils     datasets  methods
>> >> >> >> base
>> >> >> >> other attached packages:
>> >> >> >> [1] rgdal_0.8-10  raster_2.1-49 sp_1.0-11
>> >> >> >> loaded via a namespace (and not attached):
>> >> >> >> [1] grid_3.0.1      lattice_0.20-27 tools_3.0.1
>> >> >> >>
>> >> >> >> However, this process only took 10 seconds using the existing
>> >> >> >> tool
>> >> >> >> in
>> >> >> >> ArcGIS toolbox. Has someone experienced this before? Any comments
>> >> >> >> will
>> >> >> >> be
>> >> >> >> welcome.
>> >> >> >>
>> >> >> >
>> >> >> > Are you using "Project" or "Define Projection" in ArcGIS? "Define
>> >> >> > projection" just overwrites the existing projection rather than
>> >> >> > reprojecting the data, which is much more calculation intensive.
>> >> >> >
>> >> >> >
>> >> >> >>
>> >> >> >> Thanks,
>> >> >> >>
>> >> >> >> Ping
>> >> >> >>
>> >> >> >>         [[alternative HTML version deleted]]
>> >> >> >>
>> >> >> >> _______________________________________________
>> >> >> >> R-sig-Geo mailing list
>> >> >> >> R-sig-Geo at r-project.org
>> >> >> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >> >> >>
>> >> >> >
>> >> >> >
>> >> >> > --
>> >> >> > Alex Zvoleff
>> >> >> > Postdoctoral Associate
>> >> >> > Tropical Ecology Assessment and Monitoring (TEAM) Network
>> >> >> > Conservation International
>> >> >> > 2011 Crystal Dr. Suite 500, Arlington, Virginia 22202, USA
>> >> >> > Tel: +1-703-341-2749, Fax: +1-703-979-0953, Skype: azvoleff
>> >> >> > http://www.teamnetwork.org | http://www.conservation.org
>> >> >> >
>> >> >> >
>> >> >> > On Mon, Apr 7, 2014 at 4:05 PM, ping yang <pingyang.whu at gmail.com>
>> >> >> > wrote:
>> >> >> >
>> >> >> >> Dear r-sig-geo,
>> >> >> >>
>> >> >> >> I plan to reproject from lonlat to UTM for a bunch of 10 meter
>> >> >> >> NED
>> >> >> >> files
>> >> >> >> (large) using a R script(I did it successfully for the 30 meter
>> >> >> >> DEM), I
>> >> >> >> used the following code to run:
>> >> >> >>
>> >> >> >> rasterOptions(chunksize = 1e+10, maxmemory = 1e+12) #need to
>> >> >> >> allow
>> >> >> >> bigger
>> >> >> >> chunksize for the processing!!!
>> >> >> >>  #*----Function for detect the UTM Zone-----#
>> >> >> >> long2UTM <- function(long) {
>> >> >> >>   (floor((long + 180)/6) %% 60) + 1
>> >> >> >> }
>> >> >> >>
>> >> >> >>   require(raster)
>> >> >> >>   require(rgdal)
>> >> >> >>   filename <- "grdn41w083_13"
>> >> >> >>   longitude <- paste("-",substr(filename,9,10),sep="")
>> >> >> >>   lon <- as.numeric(longitude)
>> >> >> >>   utm <-paste("+proj=utm +zone=",long2UTM(lon)," +datum=NAD83
>> >> >> >> +ellps=GRS80
>> >> >> >> +towgs84=0,0,0 +units=m +no_defs",sep="")
>> >> >> >>   r  <- raster(filename)
>> >> >> >>   outputfile <-
>> >> >> >> paste("projected/",substr(filename,4,10),".tif",sep='')
>> >> >> >>   print(paste(outputfile))
>> >> >> >>   pr <- projectRaster(r, crs=utm, res=10.0, method='bilinear')
>> >> >> >>
>> >> >> >> However, the projectRaster takes forever to finish and it almost
>> >> >> >> crashed my
>> >> >> >> computer.
>> >> >> >>
>> >> >> >> The file is kind of big  (file size is 455MB),The file
>> >> >> >> information
>> >> >> >> is
>> >> >> >> class       : RasterLayer
>> >> >> >> dimensions  : 10812, 10812, 116899344  (nrow, ncol, ncell)
>> >> >> >> resolution  : 9.259259e-05, 9.259259e-05  (x, y)
>> >> >> >> extent      : -83.00056, -81.99944, 39.99944, 41.00056  (xmin,
>> >> >> >> xmax,
>> >> >> >> ymin,
>> >> >> >> ymax)
>> >> >> >> coord. ref. : +proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0
>> >> >> >> +no_defs
>> >> >> >> data source : c:\temporary\10M\grdn41w083_13
>> >> >> >> names       : grdn41w083_13
>> >> >> >> values      : 212.254, 460.0799  (min, max)
>> >> >> >>
>> >> >> >> My R information:
>> >> >> >> sessionInfo()
>> >> >> >> R version 3.0.1 (2013-05-16)
>> >> >> >> Platform: x86_64-w64-mingw32/x64 (64-bit)
>> >> >> >> attached base packages:
>> >> >> >> [1] stats     graphics  grDevices utils     datasets  methods
>> >> >> >> base
>> >> >> >> other attached packages:
>> >> >> >> [1] rgdal_0.8-10  raster_2.1-49 sp_1.0-11
>> >> >> >> loaded via a namespace (and not attached):
>> >> >> >> [1] grid_3.0.1      lattice_0.20-27 tools_3.0.1
>> >> >> >>
>> >> >> >> However, this process only took 10 seconds using the existing
>> >> >> >> tool
>> >> >> >> in
>> >> >> >> ArcGIS toolbox. Has someone experienced this before? Any comments
>> >> >> >> will
>> >> >> >> be
>> >> >> >> welcome.
>> >> >> >>
>> >> >> >> Thanks,
>> >> >> >>
>> >> >> >> Ping
>> >> >> >>
>> >> >> >>         [[alternative HTML version deleted]]
>> >> >> >>
>> >> >> >> _______________________________________________
>> >> >> >> R-sig-Geo mailing list
>> >> >> >> R-sig-Geo at r-project.org
>> >> >> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >> >> >>
>> >> >> >
>> >> >> >
>> >> >> >
>> >> >> > --
>> >> >> > Alex Zvoleff
>> >> >> > Postdoctoral Associate
>> >> >> > Tropical Ecology Assessment and Monitoring (TEAM) Network
>> >> >> > Conservation International
>> >> >> > 2011 Crystal Dr. Suite 500, Arlington, Virginia 22202, USA
>> >> >> > Tel: +1-703-341-2749, Fax: +1-703-979-0953, Skype: azvoleff
>> >> >> > http://www.teamnetwork.org | http://www.conservation.org
>> >> >> >
>> >> >> >         [[alternative HTML version deleted]]
>> >> >> >
>> >> >> > _______________________________________________
>> >> >> > R-sig-Geo mailing list
>> >> >> > R-sig-Geo at r-project.org
>> >> >> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >> >>
>> >> >>
>> >> >>
>> >> >> --
>> >> >> Jonathan A. Greenberg, PhD
>> >> >> Assistant Professor
>> >> >> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
>> >> >> Department of Geography and Geographic Information Science
>> >> >> University of Illinois at Urbana-Champaign
>> >> >> 259 Computing Applications Building, MC-150
>> >> >> 605 East Springfield Avenue
>> >> >> Champaign, IL  61820-6371
>> >> >> Phone: 217-300-1924
>> >> >> http://www.geog.illinois.edu/~jgrn/
>> >> >> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype:
>> >> >> jgrn3007
>> >> >
>> >> >
>> >>
>> >>
>> >>
>> >> --
>> >> Jonathan A. Greenberg, PhD
>> >> Assistant Professor
>> >> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
>> >> Department of Geography and Geographic Information Science
>> >> University of Illinois at Urbana-Champaign
>> >> 259 Computing Applications Building, MC-150
>> >> 605 East Springfield Avenue
>> >> Champaign, IL  61820-6371
>> >> Phone: 217-300-1924
>> >> http://www.geog.illinois.edu/~jgrn/
>> >> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
>> >
>> >
>>
>>
>>
>> --
>> Jonathan A. Greenberg, PhD
>> Assistant Professor
>> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
>> Department of Geography and Geographic Information Science
>> University of Illinois at Urbana-Champaign
>> 259 Computing Applications Building, MC-150
>> 605 East Springfield Avenue
>> Champaign, IL  61820-6371
>> Phone: 217-300-1924
>> http://www.geog.illinois.edu/~jgrn/
>> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
>
>



-- 
Jonathan A. Greenberg, PhD
Assistant Professor
Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
Department of Geography and Geographic Information Science
University of Illinois at Urbana-Champaign
259 Computing Applications Building, MC-150
605 East Springfield Avenue
Champaign, IL  61820-6371
Phone: 217-300-1924
http://www.geog.illinois.edu/~jgrn/
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007


From jgrn at illinois.edu  Fri Apr 11 00:22:39 2014
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Thu, 10 Apr 2014 17:22:39 -0500
Subject: [R-sig-Geo] decimals in NA value using raster::writeRaster with
 .ascii format
In-Reply-To: <CAGC_mZTEpDOwYVQh7ZEBgnjgRWjPn2HdK5-9NjQ7RQ_9jm5qTg@mail.gmail.com>
References: <CAGC_mZTEpDOwYVQh7ZEBgnjgRWjPn2HdK5-9NjQ7RQ_9jm5qTg@mail.gmail.com>
Message-ID: <CABG0rfvntKdq_wv=L5ijmYXwmijP-xuvMRAx3XQ5M7jjbDWKrw@mail.gmail.com>

Zack:

Are you creating the files from within R, or are you just trying to
convert an existing file?  If the latter, can you make one of those
files available (e.g. via google drive or dropbox or something like
that)?

--j

On Thu, Apr 10, 2014 at 3:06 PM, Zack Holden <zaholdenfs at gmail.com> wrote:
> Dear list,
>
> I am creating ascii files as inputs to the PCraster software (no other
> gdal format is allowed). When I write my ascii file using
> raster::writeRaster, the first cell of every raster that I write has a
> large number of decimal values appended to it. This causes errors
> later in the model workflow.
>
> This also happens to the first NA value in the file, so that all NA
> values in the file are e.g. -9999 except the first cell. which appears
> as: -9999.00000000000
>
> Can anyone suggest a method for ensuring that all of my NA values are
> identical and with no trailing decimals?
>
> A small reproducible example follows. Any help or suggestions is appreciated.
>
> Thanks,
> Zack
>
> ##################
> # start code
> require(raster)
> r <- raster(nrows=2, ncols=2, xmn=0, xmx=2, ymn=0, ymx=2)
> r <- setValues(r, seq(1:ncell(r)))
> rexpand <- extend(r, c(2,2))
> NAvalue(rexpand) <- -9999
>
> temp.dir <- "/home/zholden/"
> writeRaster(rexpand, file=paste(temp.dir, "testraster.asc",sep=""),
> NAflag=-9999, dataType="INT2U", overwrite=T)
> # end code
> ##################
>
> # opening in a text editor reveals trailing decimals in the first NA value.
> system(paste("gedit ", temp.dir, "testraster.asc", sep=""))
>
> ################################
>  sessionInfo()
> R version 3.0.2 (2013-09-25)
> Platform: x86_64-redhat-linux-gnu (64-bit)
>
> locale:
>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
> LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
> LC_MONETARY=en_US.UTF-8
>  [6] LC_MESSAGES=en_US.UTF-8    LC_PAPER=en_US.UTF-8       LC_NAME=C
>                LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] rgdal_0.8-16  raster_2.2-12 sp_1.0-14
>
> loaded via a namespace (and not attached):
> [1] grid_3.0.2      lattice_0.20-23 tools_3.0.2
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Jonathan A. Greenberg, PhD
Assistant Professor
Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
Department of Geography and Geographic Information Science
University of Illinois at Urbana-Champaign
259 Computing Applications Building, MC-150
605 East Springfield Avenue
Champaign, IL  61820-6371
Phone: 217-300-1924
http://www.geog.illinois.edu/~jgrn/
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007


From zaholdenfs at gmail.com  Fri Apr 11 00:29:37 2014
From: zaholdenfs at gmail.com (Zack Holden)
Date: Thu, 10 Apr 2014 16:29:37 -0600
Subject: [R-sig-Geo] decimals in NA value using raster::writeRaster with
 .ascii format
In-Reply-To: <CABG0rfvntKdq_wv=L5ijmYXwmijP-xuvMRAx3XQ5M7jjbDWKrw@mail.gmail.com>
References: <CAGC_mZTEpDOwYVQh7ZEBgnjgRWjPn2HdK5-9NjQ7RQ_9jm5qTg@mail.gmail.com>
	<CABG0rfvntKdq_wv=L5ijmYXwmijP-xuvMRAx3XQ5M7jjbDWKrw@mail.gmail.com>
Message-ID: <CAGC_mZSgqfKiww_hB3OuNdy7TLbAT81VH8QkrnX=kSmUKX8XrA@mail.gmail.com>

Thanks for getting back to me Jonathan.

In reality, I am creating the files from an existing DEM. However, I
get the same behavior regardless of whether I generate the file in R
(as with my example code) or with actual data.
I have since tested on 4 machines. One windows machine with an older
version of R successfully generates the desired ascii file without the
decimals. The other 3 computers (Linux and windows machines) add the
decimals. As a workaround, I've tried using -Inf as my NAflag. This
eliminates the decimals, but results in a large string of white space
in front of the first row of data. These still cause problems for
PCraster (the next step in the processing chain).

I'm still stumped.

Thanks again,
Zack


On Thu, Apr 10, 2014 at 4:22 PM, Jonathan Greenberg <jgrn at illinois.edu> wrote:
> Zack:
>
> Are you creating the files from within R, or are you just trying to
> convert an existing file?  If the latter, can you make one of those
> files available (e.g. via google drive or dropbox or something like
> that)?
>
> --j
>
> On Thu, Apr 10, 2014 at 3:06 PM, Zack Holden <zaholdenfs at gmail.com> wrote:
>> Dear list,
>>
>> I am creating ascii files as inputs to the PCraster software (no other
>> gdal format is allowed). When I write my ascii file using
>> raster::writeRaster, the first cell of every raster that I write has a
>> large number of decimal values appended to it. This causes errors
>> later in the model workflow.
>>
>> This also happens to the first NA value in the file, so that all NA
>> values in the file are e.g. -9999 except the first cell. which appears
>> as: -9999.00000000000
>>
>> Can anyone suggest a method for ensuring that all of my NA values are
>> identical and with no trailing decimals?
>>
>> A small reproducible example follows. Any help or suggestions is appreciated.
>>
>> Thanks,
>> Zack
>>
>> ##################
>> # start code
>> require(raster)
>> r <- raster(nrows=2, ncols=2, xmn=0, xmx=2, ymn=0, ymx=2)
>> r <- setValues(r, seq(1:ncell(r)))
>> rexpand <- extend(r, c(2,2))
>> NAvalue(rexpand) <- -9999
>>
>> temp.dir <- "/home/zholden/"
>> writeRaster(rexpand, file=paste(temp.dir, "testraster.asc",sep=""),
>> NAflag=-9999, dataType="INT2U", overwrite=T)
>> # end code
>> ##################
>>
>> # opening in a text editor reveals trailing decimals in the first NA value.
>> system(paste("gedit ", temp.dir, "testraster.asc", sep=""))
>>
>> ################################
>>  sessionInfo()
>> R version 3.0.2 (2013-09-25)
>> Platform: x86_64-redhat-linux-gnu (64-bit)
>>
>> locale:
>>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>> LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>> LC_MONETARY=en_US.UTF-8
>>  [6] LC_MESSAGES=en_US.UTF-8    LC_PAPER=en_US.UTF-8       LC_NAME=C
>>                LC_ADDRESS=C               LC_TELEPHONE=C
>> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> other attached packages:
>> [1] rgdal_0.8-16  raster_2.2-12 sp_1.0-14
>>
>> loaded via a namespace (and not attached):
>> [1] grid_3.0.2      lattice_0.20-23 tools_3.0.2
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>
> --
> Jonathan A. Greenberg, PhD
> Assistant Professor
> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
> Department of Geography and Geographic Information Science
> University of Illinois at Urbana-Champaign
> 259 Computing Applications Building, MC-150
> 605 East Springfield Avenue
> Champaign, IL  61820-6371
> Phone: 217-300-1924
> http://www.geog.illinois.edu/~jgrn/
> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007


From jgrn at illinois.edu  Fri Apr 11 00:36:02 2014
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Thu, 10 Apr 2014 17:36:02 -0500
Subject: [R-sig-Geo] decimals in NA value using raster::writeRaster with
 .ascii format
In-Reply-To: <CAGC_mZSgqfKiww_hB3OuNdy7TLbAT81VH8QkrnX=kSmUKX8XrA@mail.gmail.com>
References: <CAGC_mZTEpDOwYVQh7ZEBgnjgRWjPn2HdK5-9NjQ7RQ_9jm5qTg@mail.gmail.com>
	<CABG0rfvntKdq_wv=L5ijmYXwmijP-xuvMRAx3XQ5M7jjbDWKrw@mail.gmail.com>
	<CAGC_mZSgqfKiww_hB3OuNdy7TLbAT81VH8QkrnX=kSmUKX8XrA@mail.gmail.com>
Message-ID: <CABG0rftdREoQKJZniJJX7LKvvOKb4Qz+0AzLbsO+M0_Q=jpzOg@mail.gmail.com>

Zack:

Hopefully Robert will get back to you (I confirmed it -- it looks like
a bug to me) -- but in the meantime, you might want to try my
gdalUtils package, which uses gdal_translate to convert files.  You
can use one of the many ASCII formats -- you'll want to use parameters
like:
gdal_translate(...,a_nodata=-9999,ot="UInt16",format="...")

You can see the available formats at: http://www.gdal.org/formats_list.html

--j



--

On Thu, Apr 10, 2014 at 5:29 PM, Zack Holden <zaholdenfs at gmail.com> wrote:
> Thanks for getting back to me Jonathan.
>
> In reality, I am creating the files from an existing DEM. However, I
> get the same behavior regardless of whether I generate the file in R
> (as with my example code) or with actual data.
> I have since tested on 4 machines. One windows machine with an older
> version of R successfully generates the desired ascii file without the
> decimals. The other 3 computers (Linux and windows machines) add the
> decimals. As a workaround, I've tried using -Inf as my NAflag. This
> eliminates the decimals, but results in a large string of white space
> in front of the first row of data. These still cause problems for
> PCraster (the next step in the processing chain).
>
> I'm still stumped.
>
> Thanks again,
> Zack
>
>
> On Thu, Apr 10, 2014 at 4:22 PM, Jonathan Greenberg <jgrn at illinois.edu> wrote:
>> Zack:
>>
>> Are you creating the files from within R, or are you just trying to
>> convert an existing file?  If the latter, can you make one of those
>> files available (e.g. via google drive or dropbox or something like
>> that)?
>>
>> --j
>>
>> On Thu, Apr 10, 2014 at 3:06 PM, Zack Holden <zaholdenfs at gmail.com> wrote:
>>> Dear list,
>>>
>>> I am creating ascii files as inputs to the PCraster software (no other
>>> gdal format is allowed). When I write my ascii file using
>>> raster::writeRaster, the first cell of every raster that I write has a
>>> large number of decimal values appended to it. This causes errors
>>> later in the model workflow.
>>>
>>> This also happens to the first NA value in the file, so that all NA
>>> values in the file are e.g. -9999 except the first cell. which appears
>>> as: -9999.00000000000
>>>
>>> Can anyone suggest a method for ensuring that all of my NA values are
>>> identical and with no trailing decimals?
>>>
>>> A small reproducible example follows. Any help or suggestions is appreciated.
>>>
>>> Thanks,
>>> Zack
>>>
>>> ##################
>>> # start code
>>> require(raster)
>>> r <- raster(nrows=2, ncols=2, xmn=0, xmx=2, ymn=0, ymx=2)
>>> r <- setValues(r, seq(1:ncell(r)))
>>> rexpand <- extend(r, c(2,2))
>>> NAvalue(rexpand) <- -9999
>>>
>>> temp.dir <- "/home/zholden/"
>>> writeRaster(rexpand, file=paste(temp.dir, "testraster.asc",sep=""),
>>> NAflag=-9999, dataType="INT2U", overwrite=T)
>>> # end code
>>> ##################
>>>
>>> # opening in a text editor reveals trailing decimals in the first NA value.
>>> system(paste("gedit ", temp.dir, "testraster.asc", sep=""))
>>>
>>> ################################
>>>  sessionInfo()
>>> R version 3.0.2 (2013-09-25)
>>> Platform: x86_64-redhat-linux-gnu (64-bit)
>>>
>>> locale:
>>>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>>> LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>>> LC_MONETARY=en_US.UTF-8
>>>  [6] LC_MESSAGES=en_US.UTF-8    LC_PAPER=en_US.UTF-8       LC_NAME=C
>>>                LC_ADDRESS=C               LC_TELEPHONE=C
>>> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>>>
>>> attached base packages:
>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>
>>> other attached packages:
>>> [1] rgdal_0.8-16  raster_2.2-12 sp_1.0-14
>>>
>>> loaded via a namespace (and not attached):
>>> [1] grid_3.0.2      lattice_0.20-23 tools_3.0.2
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>>
>> --
>> Jonathan A. Greenberg, PhD
>> Assistant Professor
>> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
>> Department of Geography and Geographic Information Science
>> University of Illinois at Urbana-Champaign
>> 259 Computing Applications Building, MC-150
>> 605 East Springfield Avenue
>> Champaign, IL  61820-6371
>> Phone: 217-300-1924
>> http://www.geog.illinois.edu/~jgrn/
>> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007



-- 
Jonathan A. Greenberg, PhD
Assistant Professor
Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
Department of Geography and Geographic Information Science
University of Illinois at Urbana-Champaign
259 Computing Applications Building, MC-150
605 East Springfield Avenue
Champaign, IL  61820-6371
Phone: 217-300-1924
http://www.geog.illinois.edu/~jgrn/
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007


From r.hijmans at gmail.com  Fri Apr 11 02:06:23 2014
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 10 Apr 2014 17:06:23 -0700
Subject: [R-sig-Geo] decimals in NA value using raster::writeRaster with
 .ascii format
In-Reply-To: <CABG0rftdREoQKJZniJJX7LKvvOKb4Qz+0AzLbsO+M0_Q=jpzOg@mail.gmail.com>
References: <CAGC_mZTEpDOwYVQh7ZEBgnjgRWjPn2HdK5-9NjQ7RQ_9jm5qTg@mail.gmail.com>
	<CABG0rfvntKdq_wv=L5ijmYXwmijP-xuvMRAx3XQ5M7jjbDWKrw@mail.gmail.com>
	<CAGC_mZSgqfKiww_hB3OuNdy7TLbAT81VH8QkrnX=kSmUKX8XrA@mail.gmail.com>
	<CABG0rftdREoQKJZniJJX7LKvvOKb4Qz+0AzLbsO+M0_Q=jpzOg@mail.gmail.com>
Message-ID: <CANtt_hzJvYzX2mAHohemjUhBnjpWe+KnzmwrTCAh3m4fB3qkBQ@mail.gmail.com>

Zack,

You are using:     dataType="INT2U"

but it should be:     datatype="INT2U"  # (or any other INT data type)

That fixes it. If the datatype is FLT* (the default), the first value
gets decimals to assure that GDAL and others treat the values as
floats, not integers.

Robert

On Thu, Apr 10, 2014 at 3:36 PM, Jonathan Greenberg <jgrn at illinois.edu> wrote:
> Zack:
>
> Hopefully Robert will get back to you (I confirmed it -- it looks like
> a bug to me) -- but in the meantime, you might want to try my
> gdalUtils package, which uses gdal_translate to convert files.  You
> can use one of the many ASCII formats -- you'll want to use parameters
> like:
> gdal_translate(...,a_nodata=-9999,ot="UInt16",format="...")
>
> You can see the available formats at: http://www.gdal.org/formats_list.html
>
> --j
>
>
>
> --
>
> On Thu, Apr 10, 2014 at 5:29 PM, Zack Holden <zaholdenfs at gmail.com> wrote:
>> Thanks for getting back to me Jonathan.
>>
>> In reality, I am creating the files from an existing DEM. However, I
>> get the same behavior regardless of whether I generate the file in R
>> (as with my example code) or with actual data.
>> I have since tested on 4 machines. One windows machine with an older
>> version of R successfully generates the desired ascii file without the
>> decimals. The other 3 computers (Linux and windows machines) add the
>> decimals. As a workaround, I've tried using -Inf as my NAflag. This
>> eliminates the decimals, but results in a large string of white space
>> in front of the first row of data. These still cause problems for
>> PCraster (the next step in the processing chain).
>>
>> I'm still stumped.
>>
>> Thanks again,
>> Zack
>>
>>
>> On Thu, Apr 10, 2014 at 4:22 PM, Jonathan Greenberg <jgrn at illinois.edu> wrote:
>>> Zack:
>>>
>>> Are you creating the files from within R, or are you just trying to
>>> convert an existing file?  If the latter, can you make one of those
>>> files available (e.g. via google drive or dropbox or something like
>>> that)?
>>>
>>> --j
>>>
>>> On Thu, Apr 10, 2014 at 3:06 PM, Zack Holden <zaholdenfs at gmail.com> wrote:
>>>> Dear list,
>>>>
>>>> I am creating ascii files as inputs to the PCraster software (no other
>>>> gdal format is allowed). When I write my ascii file using
>>>> raster::writeRaster, the first cell of every raster that I write has a
>>>> large number of decimal values appended to it. This causes errors
>>>> later in the model workflow.
>>>>
>>>> This also happens to the first NA value in the file, so that all NA
>>>> values in the file are e.g. -9999 except the first cell. which appears
>>>> as: -9999.00000000000
>>>>
>>>> Can anyone suggest a method for ensuring that all of my NA values are
>>>> identical and with no trailing decimals?
>>>>
>>>> A small reproducible example follows. Any help or suggestions is appreciated.
>>>>
>>>> Thanks,
>>>> Zack
>>>>
>>>> ##################
>>>> # start code
>>>> require(raster)
>>>> r <- raster(nrows=2, ncols=2, xmn=0, xmx=2, ymn=0, ymx=2)
>>>> r <- setValues(r, seq(1:ncell(r)))
>>>> rexpand <- extend(r, c(2,2))
>>>> NAvalue(rexpand) <- -9999
>>>>
>>>> temp.dir <- "/home/zholden/"
>>>> writeRaster(rexpand, file=paste(temp.dir, "testraster.asc",sep=""),
>>>> NAflag=-9999, dataType="INT2U", overwrite=T)
>>>> # end code
>>>> ##################
>>>>
>>>> # opening in a text editor reveals trailing decimals in the first NA value.
>>>> system(paste("gedit ", temp.dir, "testraster.asc", sep=""))
>>>>
>>>> ################################
>>>>  sessionInfo()
>>>> R version 3.0.2 (2013-09-25)
>>>> Platform: x86_64-redhat-linux-gnu (64-bit)
>>>>
>>>> locale:
>>>>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>>>> LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>>>> LC_MONETARY=en_US.UTF-8
>>>>  [6] LC_MESSAGES=en_US.UTF-8    LC_PAPER=en_US.UTF-8       LC_NAME=C
>>>>                LC_ADDRESS=C               LC_TELEPHONE=C
>>>> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>>>>
>>>> attached base packages:
>>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>>
>>>> other attached packages:
>>>> [1] rgdal_0.8-16  raster_2.2-12 sp_1.0-14
>>>>
>>>> loaded via a namespace (and not attached):
>>>> [1] grid_3.0.2      lattice_0.20-23 tools_3.0.2
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>>>
>>> --
>>> Jonathan A. Greenberg, PhD
>>> Assistant Professor
>>> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
>>> Department of Geography and Geographic Information Science
>>> University of Illinois at Urbana-Champaign
>>> 259 Computing Applications Building, MC-150
>>> 605 East Springfield Avenue
>>> Champaign, IL  61820-6371
>>> Phone: 217-300-1924
>>> http://www.geog.illinois.edu/~jgrn/
>>> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
>
>
>
> --
> Jonathan A. Greenberg, PhD
> Assistant Professor
> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
> Department of Geography and Geographic Information Science
> University of Illinois at Urbana-Champaign
> 259 Computing Applications Building, MC-150
> 605 East Springfield Avenue
> Champaign, IL  61820-6371
> Phone: 217-300-1924
> http://www.geog.illinois.edu/~jgrn/
> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From nevil.amos at gmail.com  Fri Apr 11 06:14:32 2014
From: nevil.amos at gmail.com (nevil amos)
Date: Fri, 11 Apr 2014 14:14:32 +1000
Subject: [R-sig-Geo] Combine two rasters combining attributes ( or at least
	values of each)?
Message-ID: <CAN9eD7=zFvF+xXtmCdPRpAoP1tM13HynmMc6_WOuC965FXUpCg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140411/1b35c429/attachment.pl>

From j.garcia-pintado at reading.ac.uk  Fri Apr 11 09:09:05 2014
From: j.garcia-pintado at reading.ac.uk (Javier Garcia-Pintado)
Date: Fri, 11 Apr 2014 07:09:05 +0000
Subject: [R-sig-Geo] decimals in NA value using raster::writeRaster
	with	.ascii format
In-Reply-To: <CAGC_mZTEpDOwYVQh7ZEBgnjgRWjPn2HdK5-9NjQ7RQ_9jm5qTg@mail.gmail.com>
References: <CAGC_mZTEpDOwYVQh7ZEBgnjgRWjPn2HdK5-9NjQ7RQ_9jm5qTg@mail.gmail.com>
Message-ID: <E82BBC061BBD7448BC7905721F497B0770204EE4@vime-mbx5.rdg.ac.uk>

Note you also have a 'PCRaster' driver in GDAL.

Javier
---


________________________________________
From: r-sig-geo-bounces at r-project.org [r-sig-geo-bounces at r-project.org] on behalf of Zack Holden [zaholdenfs at gmail.com]
Sent: 10 April 2014 21:06
To: r-sig-geo at r-project.org
Subject: [R-sig-Geo] decimals in NA value using raster::writeRaster with        .ascii format

Dear list,

I am creating ascii files as inputs to the PCraster software (no other
gdal format is allowed). When I write my ascii file using
raster::writeRaster, the first cell of every raster that I write has a
large number of decimal values appended to it. This causes errors
later in the model workflow.

This also happens to the first NA value in the file, so that all NA
values in the file are e.g. -9999 except the first cell. which appears
as: -9999.00000000000

Can anyone suggest a method for ensuring that all of my NA values are
identical and with no trailing decimals?

A small reproducible example follows. Any help or suggestions is appreciated.

Thanks,
Zack

##################
# start code
require(raster)
r <- raster(nrows=2, ncols=2, xmn=0, xmx=2, ymn=0, ymx=2)
r <- setValues(r, seq(1:ncell(r)))
rexpand <- extend(r, c(2,2))
NAvalue(rexpand) <- -9999

temp.dir <- "/home/zholden/"
writeRaster(rexpand, file=paste(temp.dir, "testraster.asc",sep=""),
NAflag=-9999, dataType="INT2U", overwrite=T)
# end code
##################

# opening in a text editor reveals trailing decimals in the first NA value.
system(paste("gedit ", temp.dir, "testraster.asc", sep=""))

################################
 sessionInfo()
R version 3.0.2 (2013-09-25)
Platform: x86_64-redhat-linux-gnu (64-bit)

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
LC_MONETARY=en_US.UTF-8
 [6] LC_MESSAGES=en_US.UTF-8    LC_PAPER=en_US.UTF-8       LC_NAME=C
               LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] rgdal_0.8-16  raster_2.2-12 sp_1.0-14

loaded via a namespace (and not attached):
[1] grid_3.0.2      lattice_0.20-23 tools_3.0.2

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From culinovic.domagoj at gmail.com  Fri Apr 11 12:20:06 2014
From: culinovic.domagoj at gmail.com (Domagoj Culinovic)
Date: Fri, 11 Apr 2014 12:20:06 +0200
Subject: [R-sig-Geo] Genetic algorithm and Spatial data
Message-ID: <CACgt3o=8FYLM4N4Uza0UnzzF+o5Yew-T1Zo1vFW57XGOmoMtyw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140411/6be04ebf/attachment.pl>

From Bastien.Ferland-Raymond at mrn.gouv.qc.ca  Fri Apr 11 13:58:21 2014
From: Bastien.Ferland-Raymond at mrn.gouv.qc.ca (Bastien Ferland-Raymond)
Date: Fri, 11 Apr 2014 04:58:21 -0700 (PDT)
Subject: [R-sig-Geo] INterpretation of AIC
In-Reply-To: <1397158550.86562.YahooMailNeo@web120001.mail.ne1.yahoo.com>
References: <1397158550.86562.YahooMailNeo@web120001.mail.ne1.yahoo.com>
Message-ID: <1397217501642-7586184.post@n2.nabble.com>

Hello,

I'm not familliar with SAR and CAR model, but smaller AIC is better than
larger AIC.  The important thing here is to have the same Y vector (which
you have)

See the Burnham and Anderson's book for a full, well explained explanation
on AIC:
Burnham, K. P.; Anderson, D. R. (2002), Model Selection and Multimodel
Inference: A Practical Information-Theoretic Approach (2nd ed.),
Springer-Verlag, 


Bastien



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/INterpretation-of-AIC-tp7586173p7586184.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From mlc at isa.ulisboa.pt  Fri Apr 11 15:07:00 2014
From: mlc at isa.ulisboa.pt (Manuel Campagnolo)
Date: Fri, 11 Apr 2014 14:07:00 +0100
Subject: [R-sig-Geo] handling of 3D polylines or 3D polygons in R
Message-ID: <5347E8F4.1040608@isa.ulisboa.pt>


I realized that sp classes SpatialPolygons and SpatialLines do not 
handle Z coordinates. Are there alternatives for spatial geometries 
with  Z coordinates? I would like to read and write 3D line and polygon 
shapefiles (that represent roads, streams, ridges or basins) and analyse 
them in R.

Thanks in advance for suggestions,
Manuel

-- 
_________________
Manuel Campagnolo
http://math.isa.utl.pt/~mlc/


From alessandracarioli at gmail.com  Fri Apr 11 15:14:11 2014
From: alessandracarioli at gmail.com (Alessandra Carioli)
Date: Fri, 11 Apr 2014 15:14:11 +0200
Subject: [R-sig-Geo] how to construct a variogram map
Message-ID: <9F9A66B5-47A6-434E-8263-8D71E6901F7F@gmail.com>

Dear All,

I am trying to construct a variogram map from a SptialPolygonsDataFrame. I am not sure where to start as I would need a SpatialPoints and not Polygons. Is there a way to coerce it into points? I have tried as.SpatialPoints.ppp and as.SpatialPointsDataFrame but neither works (I have my matrix of coordinates `coords`).

Bests,

Ale

From Roger.Bivand at nhh.no  Fri Apr 11 15:18:49 2014
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 11 Apr 2014 15:18:49 +0200
Subject: [R-sig-Geo] INterpretation of AIC
In-Reply-To: <1397217501642-7586184.post@n2.nabble.com>
References: <1397158550.86562.YahooMailNeo@web120001.mail.ne1.yahoo.com>
	<1397217501642-7586184.post@n2.nabble.com>
Message-ID: <alpine.LRH.2.03.1404111513120.9896@reclus.nhh.no>

On Fri, 11 Apr 2014, Bastien Ferland-Raymond wrote:

> Hello,
>
> I'm not familliar with SAR and CAR model, but smaller AIC is better than
> larger AIC.  The important thing here is to have the same Y vector (which
> you have)
>
> See the Burnham and Anderson's book for a full, well explained explanation
> on AIC:
> Burnham, K. P.; Anderson, D. R. (2002), Model Selection and Multimodel
> Inference: A Practical Information-Theoretic Approach (2nd ed.),
> Springer-Verlag,

I don't have this reference, but doubt that it covers this case. The 
underlying issue is connected to the way in which the spatial weights 
matrix enters the CAR and SAR models, and whether the underlying model is 
well specified with regard to the spatial processes in Y and X. At face 
value the difference in AIC might seem to point to SAR, but if all the 
models are misspecified, you are still not very much further forward. 
Waller and Gotway link their discussion (2004) to weighted OLS, weighted 
SAR and weighted CAR, where using weights to pick up variability between 
observation units turns out to remove the residual spatial 
autocorrelation.

Roger

>
>
> Bastien
>
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/INterpretation-of-AIC-tp7586173p7586184.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From jgrn at illinois.edu  Fri Apr 11 16:48:57 2014
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Fri, 11 Apr 2014 09:48:57 -0500
Subject: [R-sig-Geo] decimals in NA value using raster::writeRaster with
 .ascii format
In-Reply-To: <CANtt_hzJvYzX2mAHohemjUhBnjpWe+KnzmwrTCAh3m4fB3qkBQ@mail.gmail.com>
References: <CAGC_mZTEpDOwYVQh7ZEBgnjgRWjPn2HdK5-9NjQ7RQ_9jm5qTg@mail.gmail.com>
	<CABG0rfvntKdq_wv=L5ijmYXwmijP-xuvMRAx3XQ5M7jjbDWKrw@mail.gmail.com>
	<CAGC_mZSgqfKiww_hB3OuNdy7TLbAT81VH8QkrnX=kSmUKX8XrA@mail.gmail.com>
	<CABG0rftdREoQKJZniJJX7LKvvOKb4Qz+0AzLbsO+M0_Q=jpzOg@mail.gmail.com>
	<CANtt_hzJvYzX2mAHohemjUhBnjpWe+KnzmwrTCAh3m4fB3qkBQ@mail.gmail.com>
Message-ID: <CABG0rfvErscZyUOQe4+V=FtrjzowZk1aJi0p=KRzPJ-y6k00Xg@mail.gmail.com>

Robert:

What is the practical difference between those two? -- does dataType
get passed off to GDAL, while datatype is interpreted by your R code?

--j

On Thu, Apr 10, 2014 at 7:06 PM, Robert J. Hijmans <r.hijmans at gmail.com> wrote:
> Zack,
>
> You are using:     dataType="INT2U"
>
> but it should be:     datatype="INT2U"  # (or any other INT data type)
>
> That fixes it. If the datatype is FLT* (the default), the first value
> gets decimals to assure that GDAL and others treat the values as
> floats, not integers.
>
> Robert
>
> On Thu, Apr 10, 2014 at 3:36 PM, Jonathan Greenberg <jgrn at illinois.edu> wrote:
>> Zack:
>>
>> Hopefully Robert will get back to you (I confirmed it -- it looks like
>> a bug to me) -- but in the meantime, you might want to try my
>> gdalUtils package, which uses gdal_translate to convert files.  You
>> can use one of the many ASCII formats -- you'll want to use parameters
>> like:
>> gdal_translate(...,a_nodata=-9999,ot="UInt16",format="...")
>>
>> You can see the available formats at: http://www.gdal.org/formats_list.html
>>
>> --j
>>
>>
>>
>> --
>>
>> On Thu, Apr 10, 2014 at 5:29 PM, Zack Holden <zaholdenfs at gmail.com> wrote:
>>> Thanks for getting back to me Jonathan.
>>>
>>> In reality, I am creating the files from an existing DEM. However, I
>>> get the same behavior regardless of whether I generate the file in R
>>> (as with my example code) or with actual data.
>>> I have since tested on 4 machines. One windows machine with an older
>>> version of R successfully generates the desired ascii file without the
>>> decimals. The other 3 computers (Linux and windows machines) add the
>>> decimals. As a workaround, I've tried using -Inf as my NAflag. This
>>> eliminates the decimals, but results in a large string of white space
>>> in front of the first row of data. These still cause problems for
>>> PCraster (the next step in the processing chain).
>>>
>>> I'm still stumped.
>>>
>>> Thanks again,
>>> Zack
>>>
>>>
>>> On Thu, Apr 10, 2014 at 4:22 PM, Jonathan Greenberg <jgrn at illinois.edu> wrote:
>>>> Zack:
>>>>
>>>> Are you creating the files from within R, or are you just trying to
>>>> convert an existing file?  If the latter, can you make one of those
>>>> files available (e.g. via google drive or dropbox or something like
>>>> that)?
>>>>
>>>> --j
>>>>
>>>> On Thu, Apr 10, 2014 at 3:06 PM, Zack Holden <zaholdenfs at gmail.com> wrote:
>>>>> Dear list,
>>>>>
>>>>> I am creating ascii files as inputs to the PCraster software (no other
>>>>> gdal format is allowed). When I write my ascii file using
>>>>> raster::writeRaster, the first cell of every raster that I write has a
>>>>> large number of decimal values appended to it. This causes errors
>>>>> later in the model workflow.
>>>>>
>>>>> This also happens to the first NA value in the file, so that all NA
>>>>> values in the file are e.g. -9999 except the first cell. which appears
>>>>> as: -9999.00000000000
>>>>>
>>>>> Can anyone suggest a method for ensuring that all of my NA values are
>>>>> identical and with no trailing decimals?
>>>>>
>>>>> A small reproducible example follows. Any help or suggestions is appreciated.
>>>>>
>>>>> Thanks,
>>>>> Zack
>>>>>
>>>>> ##################
>>>>> # start code
>>>>> require(raster)
>>>>> r <- raster(nrows=2, ncols=2, xmn=0, xmx=2, ymn=0, ymx=2)
>>>>> r <- setValues(r, seq(1:ncell(r)))
>>>>> rexpand <- extend(r, c(2,2))
>>>>> NAvalue(rexpand) <- -9999
>>>>>
>>>>> temp.dir <- "/home/zholden/"
>>>>> writeRaster(rexpand, file=paste(temp.dir, "testraster.asc",sep=""),
>>>>> NAflag=-9999, dataType="INT2U", overwrite=T)
>>>>> # end code
>>>>> ##################
>>>>>
>>>>> # opening in a text editor reveals trailing decimals in the first NA value.
>>>>> system(paste("gedit ", temp.dir, "testraster.asc", sep=""))
>>>>>
>>>>> ################################
>>>>>  sessionInfo()
>>>>> R version 3.0.2 (2013-09-25)
>>>>> Platform: x86_64-redhat-linux-gnu (64-bit)
>>>>>
>>>>> locale:
>>>>>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>>>>> LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>>>>> LC_MONETARY=en_US.UTF-8
>>>>>  [6] LC_MESSAGES=en_US.UTF-8    LC_PAPER=en_US.UTF-8       LC_NAME=C
>>>>>                LC_ADDRESS=C               LC_TELEPHONE=C
>>>>> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>>>>>
>>>>> attached base packages:
>>>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>>>
>>>>> other attached packages:
>>>>> [1] rgdal_0.8-16  raster_2.2-12 sp_1.0-14
>>>>>
>>>>> loaded via a namespace (and not attached):
>>>>> [1] grid_3.0.2      lattice_0.20-23 tools_3.0.2
>>>>>
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>>
>>>>
>>>> --
>>>> Jonathan A. Greenberg, PhD
>>>> Assistant Professor
>>>> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
>>>> Department of Geography and Geographic Information Science
>>>> University of Illinois at Urbana-Champaign
>>>> 259 Computing Applications Building, MC-150
>>>> 605 East Springfield Avenue
>>>> Champaign, IL  61820-6371
>>>> Phone: 217-300-1924
>>>> http://www.geog.illinois.edu/~jgrn/
>>>> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
>>
>>
>>
>> --
>> Jonathan A. Greenberg, PhD
>> Assistant Professor
>> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
>> Department of Geography and Geographic Information Science
>> University of Illinois at Urbana-Champaign
>> 259 Computing Applications Building, MC-150
>> 605 East Springfield Avenue
>> Champaign, IL  61820-6371
>> Phone: 217-300-1924
>> http://www.geog.illinois.edu/~jgrn/
>> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Jonathan A. Greenberg, PhD
Assistant Professor
Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
Department of Geography and Geographic Information Science
University of Illinois at Urbana-Champaign
259 Computing Applications Building, MC-150
605 East Springfield Avenue
Champaign, IL  61820-6371
Phone: 217-300-1924
http://www.geog.illinois.edu/~jgrn/
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007


From jgrn at illinois.edu  Fri Apr 11 16:52:46 2014
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Fri, 11 Apr 2014 09:52:46 -0500
Subject: [R-sig-Geo] Combine two rasters combining attributes ( or at
 least values of each)?
In-Reply-To: <CAN9eD7=zFvF+xXtmCdPRpAoP1tM13HynmMc6_WOuC965FXUpCg@mail.gmail.com>
References: <CAN9eD7=zFvF+xXtmCdPRpAoP1tM13HynmMc6_WOuC965FXUpCg@mail.gmail.com>
Message-ID: <CABG0rfvh6xHoPrhpg5j6AALgzFeTdSO=6OLOUbKm9b374ieyXQ@mail.gmail.com>

Nevil:

Can you be more specific with what those attributes are?  You can use
a RAT table with rasters (?ratify in the raster package), but without
more specific details it is hard to give you a good answer.  What is
the data, and what, exactly, are you trying to accomplish?

--j

On Thu, Apr 10, 2014 at 11:14 PM, nevil amos <nevil.amos at gmail.com> wrote:
> How can I combine tow overlapping Rasters in R maintaining such that the
> output raster cells are assigned the attributes of both the input rasters.
>  - The equivalent of ARCGIS spatial analyst combine rasters followed by
> joining back to each of the input raster  attribute tables?
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Jonathan A. Greenberg, PhD
Assistant Professor
Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
Department of Geography and Geographic Information Science
University of Illinois at Urbana-Champaign
259 Computing Applications Building, MC-150
605 East Springfield Avenue
Champaign, IL  61820-6371
Phone: 217-300-1924
http://www.geog.illinois.edu/~jgrn/
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007


From milansharma2012 at yahoo.com  Fri Apr 11 16:57:56 2014
From: milansharma2012 at yahoo.com (Milan Sharma)
Date: Fri, 11 Apr 2014 07:57:56 -0700 (PDT)
Subject: [R-sig-Geo] INterpretation of AIC
In-Reply-To: <1397217501642-7586184.post@n2.nabble.com>
References: <1397158550.86562.YahooMailNeo@web120001.mail.ne1.yahoo.com>
	<1397217501642-7586184.post@n2.nabble.com>
Message-ID: <1397228276.17340.YahooMailNeo@web120002.mail.ne1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140411/c60e5032/attachment.pl>

From basille.web at ase-research.org  Fri Apr 11 17:37:02 2014
From: basille.web at ase-research.org (Mathieu Basille)
Date: Fri, 11 Apr 2014 11:37:02 -0400
Subject: [R-sig-Geo] adehabitatHR: kerneloverlap and kernelUD etc.
In-Reply-To: <EF5D3065747CC8438B3B16856EF7F7B73335901C@SVRDSI078MBX02V>
References: <1396889325456-7586144.post@n2.nabble.com>
	<EF5D3065747CC8438B3B16856EF7F7B73335901C@SVRDSI078MBX02V>
Message-ID: <53480C1E.6090008@ase-research.org>

Le 07/04/2014 15:00, Calenge Clement a ?crit :
>
> [...]
>
> Generally, the function kerneloverlap is to be preferred (simpler to use
> if you start from a set of relocations, see below), except if you
> already have an object of class estUD in suitable format (i.e. with the
> kernel estimation carried out on the *same grid* for all animals). The
> function kerneloverlaphr might be preferred if you work with
> "nonclassical" kernel approaches, such as BRB, kernelbb, etc., if you
> have built your own estUD object from UDs estimated with another
> software, etc.

Alternatively, I recently modified the 'kerneloverlap' function to accept 
either a `SpatialPointsDataFrame` or a `estUDm` object in a single function 
(no more need of 'kerneloverlaphr'). Essentially, the function reuses the 
code of the regular 'kerneloverlap' function when working on a SPDF, and 
the code of the regular 'kerneloverlaphr' function when working on a estUDm 
object.

It also allows to use several functions at once, e.g. 'c("PHR", "BA")', 
with a new summary function which can be pretty convenient. The modified 
function is available here:

http://ase-research.org/basille/hab/

Mathieu.


>> -I notice in working with the kerneloverlap function that the selected grid
>> size influences home range overlap. What is the best way to go about
>> selecting a biologically meaningful grid size?
>
> Normally, the effect of the grid size on the kernel estimates should be
> negligible. If it is not, it may be because the grid is way too coarse.
> Increase the resolution until no further noticeable change occurs.
>
>
>> -When trying to work with the kerneloverlaphr, I am given the warning "In vi
>> * vj : longer object length is not a multiple of shorter object length". I'm
>> afraid I can't say I really understand this statement (as each animal has
>> the same number of relocations) nor what the function is doing with the data
>> to account for it.
>
> Hard to say without any reproducible example... Just a guess: you try to
> use kerneloverlaphr with an estUD which is not in the correct format
> (i.e. the size and the resolution of the grid is not the same for all
> animals). The function kerneloverlap might be easier to use? If you
> really really want to use kerneloverlap on an estUD object generated by
> kernelUD, please use same4all=TRUE in the function estUD.
>
>
>> -I also realize that an issue with the kernelUD LSCV estimate is that the
>> cross-validation criterion sometimes fails to be minimized. But /why / is
>> this sometimes the case? i.e. what about the relocations might cause this?
>> And when LSCV method does fail to converge, I understand that the method can
>> no longer be reliably used. In such cases, is it best to default to another
>> hr estimate like MCP, or another method for selecting h (href or selective
>> h?)?
>
> Have a look at the following urls:
>
> http://lists.faunalia.it/pipermail/animov/2006-May/000137.html
> http://lists.faunalia.it/pipermail/animov/2006-May/000130.html
> http://lists.faunalia.it/pipermail/animov/2006-May/000165.html
>
> Best regards
> HTH,
>
> Cl?ment Calenge
>

-- 

~$ whoami
Mathieu Basille, PhD

~$ locate --details
University of Florida \\
Fort Lauderdale Research and Education Center
(+1) 954-577-6314
http://ase-research.org/basille

~$ fortune
? Le tout est de tout dire, et je manque de mots
Et je manque de temps, et je manque d'audace. ?
  -- Paul ?luard


From zaholdenfs at gmail.com  Fri Apr 11 17:46:42 2014
From: zaholdenfs at gmail.com (Zack Holden)
Date: Fri, 11 Apr 2014 09:46:42 -0600
Subject: [R-sig-Geo] decimals in NA value using raster::writeRaster with
 .ascii format
In-Reply-To: <CABG0rfvErscZyUOQe4+V=FtrjzowZk1aJi0p=KRzPJ-y6k00Xg@mail.gmail.com>
References: <CAGC_mZTEpDOwYVQh7ZEBgnjgRWjPn2HdK5-9NjQ7RQ_9jm5qTg@mail.gmail.com>
	<CABG0rfvntKdq_wv=L5ijmYXwmijP-xuvMRAx3XQ5M7jjbDWKrw@mail.gmail.com>
	<CAGC_mZSgqfKiww_hB3OuNdy7TLbAT81VH8QkrnX=kSmUKX8XrA@mail.gmail.com>
	<CABG0rftdREoQKJZniJJX7LKvvOKb4Qz+0AzLbsO+M0_Q=jpzOg@mail.gmail.com>
	<CANtt_hzJvYzX2mAHohemjUhBnjpWe+KnzmwrTCAh3m4fB3qkBQ@mail.gmail.com>
	<CABG0rfvErscZyUOQe4+V=FtrjzowZk1aJi0p=KRzPJ-y6k00Xg@mail.gmail.com>
Message-ID: <CAGC_mZT8NQ=0mEsU35yeyVnQOCXMogP=ji1yQp3MvrkYY60-kw@mail.gmail.com>

Robert,
Thank you for your help. I failed to notice the "datatype vs. dataType
difference. Calling 'datatype' does indeed solve my integer test case.
However, some of the raster datasets that I am processing are actually
floating point. When I call writeRaster(datatype = 'FLT4S'), I still
see the long string of decimals in the first value in my ascii grid.

Is there any way to handle this in R? From your response, it sounds
like this might be an artifact of GDAL, and I may need to manually (or
with text manipulations) edit out the decimal strings.

Thanks for any additional suggestions.

Javier, thanks for pointing out the available GDAL drivers in
PCraster, I'm just getting acquainted with that software program.

Cheers,
Zack


On Fri, Apr 11, 2014 at 8:48 AM, Jonathan Greenberg <jgrn at illinois.edu> wrote:
> Robert:
>
> What is the practical difference between those two? -- does dataType
> get passed off to GDAL, while datatype is interpreted by your R code?
>
> --j
>
> On Thu, Apr 10, 2014 at 7:06 PM, Robert J. Hijmans <r.hijmans at gmail.com> wrote:
>> Zack,
>>
>> You are using:     dataType="INT2U"
>>
>> but it should be:     datatype="INT2U"  # (or any other INT data type)
>>
>> That fixes it. If the datatype is FLT* (the default), the first value
>> gets decimals to assure that GDAL and others treat the values as
>> floats, not integers.
>>
>> Robert
>>
>> On Thu, Apr 10, 2014 at 3:36 PM, Jonathan Greenberg <jgrn at illinois.edu> wrote:
>>> Zack:
>>>
>>> Hopefully Robert will get back to you (I confirmed it -- it looks like
>>> a bug to me) -- but in the meantime, you might want to try my
>>> gdalUtils package, which uses gdal_translate to convert files.  You
>>> can use one of the many ASCII formats -- you'll want to use parameters
>>> like:
>>> gdal_translate(...,a_nodata=-9999,ot="UInt16",format="...")
>>>
>>> You can see the available formats at: http://www.gdal.org/formats_list.html
>>>
>>> --j
>>>
>>>
>>>
>>> --
>>>
>>> On Thu, Apr 10, 2014 at 5:29 PM, Zack Holden <zaholdenfs at gmail.com> wrote:
>>>> Thanks for getting back to me Jonathan.
>>>>
>>>> In reality, I am creating the files from an existing DEM. However, I
>>>> get the same behavior regardless of whether I generate the file in R
>>>> (as with my example code) or with actual data.
>>>> I have since tested on 4 machines. One windows machine with an older
>>>> version of R successfully generates the desired ascii file without the
>>>> decimals. The other 3 computers (Linux and windows machines) add the
>>>> decimals. As a workaround, I've tried using -Inf as my NAflag. This
>>>> eliminates the decimals, but results in a large string of white space
>>>> in front of the first row of data. These still cause problems for
>>>> PCraster (the next step in the processing chain).
>>>>
>>>> I'm still stumped.
>>>>
>>>> Thanks again,
>>>> Zack
>>>>
>>>>
>>>> On Thu, Apr 10, 2014 at 4:22 PM, Jonathan Greenberg <jgrn at illinois.edu> wrote:
>>>>> Zack:
>>>>>
>>>>> Are you creating the files from within R, or are you just trying to
>>>>> convert an existing file?  If the latter, can you make one of those
>>>>> files available (e.g. via google drive or dropbox or something like
>>>>> that)?
>>>>>
>>>>> --j
>>>>>
>>>>> On Thu, Apr 10, 2014 at 3:06 PM, Zack Holden <zaholdenfs at gmail.com> wrote:
>>>>>> Dear list,
>>>>>>
>>>>>> I am creating ascii files as inputs to the PCraster software (no other
>>>>>> gdal format is allowed). When I write my ascii file using
>>>>>> raster::writeRaster, the first cell of every raster that I write has a
>>>>>> large number of decimal values appended to it. This causes errors
>>>>>> later in the model workflow.
>>>>>>
>>>>>> This also happens to the first NA value in the file, so that all NA
>>>>>> values in the file are e.g. -9999 except the first cell. which appears
>>>>>> as: -9999.00000000000
>>>>>>
>>>>>> Can anyone suggest a method for ensuring that all of my NA values are
>>>>>> identical and with no trailing decimals?
>>>>>>
>>>>>> A small reproducible example follows. Any help or suggestions is appreciated.
>>>>>>
>>>>>> Thanks,
>>>>>> Zack
>>>>>>
>>>>>> ##################
>>>>>> # start code
>>>>>> require(raster)
>>>>>> r <- raster(nrows=2, ncols=2, xmn=0, xmx=2, ymn=0, ymx=2)
>>>>>> r <- setValues(r, seq(1:ncell(r)))
>>>>>> rexpand <- extend(r, c(2,2))
>>>>>> NAvalue(rexpand) <- -9999
>>>>>>
>>>>>> temp.dir <- "/home/zholden/"
>>>>>> writeRaster(rexpand, file=paste(temp.dir, "testraster.asc",sep=""),
>>>>>> NAflag=-9999, dataType="INT2U", overwrite=T)
>>>>>> # end code
>>>>>> ##################
>>>>>>
>>>>>> # opening in a text editor reveals trailing decimals in the first NA value.
>>>>>> system(paste("gedit ", temp.dir, "testraster.asc", sep=""))
>>>>>>
>>>>>> ################################
>>>>>>  sessionInfo()
>>>>>> R version 3.0.2 (2013-09-25)
>>>>>> Platform: x86_64-redhat-linux-gnu (64-bit)
>>>>>>
>>>>>> locale:
>>>>>>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>>>>>> LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>>>>>> LC_MONETARY=en_US.UTF-8
>>>>>>  [6] LC_MESSAGES=en_US.UTF-8    LC_PAPER=en_US.UTF-8       LC_NAME=C
>>>>>>                LC_ADDRESS=C               LC_TELEPHONE=C
>>>>>> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>>>>>>
>>>>>> attached base packages:
>>>>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>>>>
>>>>>> other attached packages:
>>>>>> [1] rgdal_0.8-16  raster_2.2-12 sp_1.0-14
>>>>>>
>>>>>> loaded via a namespace (and not attached):
>>>>>> [1] grid_3.0.2      lattice_0.20-23 tools_3.0.2
>>>>>>
>>>>>> _______________________________________________
>>>>>> R-sig-Geo mailing list
>>>>>> R-sig-Geo at r-project.org
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>
>>>>>
>>>>>
>>>>> --
>>>>> Jonathan A. Greenberg, PhD
>>>>> Assistant Professor
>>>>> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
>>>>> Department of Geography and Geographic Information Science
>>>>> University of Illinois at Urbana-Champaign
>>>>> 259 Computing Applications Building, MC-150
>>>>> 605 East Springfield Avenue
>>>>> Champaign, IL  61820-6371
>>>>> Phone: 217-300-1924
>>>>> http://www.geog.illinois.edu/~jgrn/
>>>>> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
>>>
>>>
>>>
>>> --
>>> Jonathan A. Greenberg, PhD
>>> Assistant Professor
>>> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
>>> Department of Geography and Geographic Information Science
>>> University of Illinois at Urbana-Champaign
>>> 259 Computing Applications Building, MC-150
>>> 605 East Springfield Avenue
>>> Champaign, IL  61820-6371
>>> Phone: 217-300-1924
>>> http://www.geog.illinois.edu/~jgrn/
>>> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>
> --
> Jonathan A. Greenberg, PhD
> Assistant Professor
> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
> Department of Geography and Geographic Information Science
> University of Illinois at Urbana-Champaign
> 259 Computing Applications Building, MC-150
> 605 East Springfield Avenue
> Champaign, IL  61820-6371
> Phone: 217-300-1924
> http://www.geog.illinois.edu/~jgrn/
> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007


From mdsumner at gmail.com  Sat Apr 12 00:28:39 2014
From: mdsumner at gmail.com (Michael Sumner)
Date: Sat, 12 Apr 2014 08:28:39 +1000
Subject: [R-sig-Geo] handling of 3D polylines or 3D polygons in R
In-Reply-To: <5347E8F4.1040608@isa.ulisboa.pt>
References: <5347E8F4.1040608@isa.ulisboa.pt>
Message-ID: <CAAcGz99wLUcXrk_69sT_phpBSnddPQmsOZjajfzBfvGaq-2FFw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140412/279f4461/attachment.pl>

From annajess at gmx.de  Sat Apr 12 14:20:16 2014
From: annajess at gmx.de (Anna-Marie Corman)
Date: Sat, 12 Apr 2014 14:20:16 +0200
Subject: [R-sig-Geo] Problems in handling several animals in BRB calculation
Message-ID: <53492F80.5040404@gmx.de>

Dear all,

I have a problem with the BRB calculation of my seabird tracking data. 
When I run the model R always has a fatal error and is aborted. Is there 
anything wrong in my ltraj-class or with the "D=" term in the BRB code? 
Does anyone see my beginner's mistake(s)?

Thank you again.

Best regards,
Anna

#Overview of my data (6 different individuals)
 > head(dcol[,c(1:11,17,25:27)])
         date day month year hour minute second time_sec time_diff latitude
1 13.05.2011  13     5 2011   21     11     33    76293       186 54.70463
2 13.05.2011  13     5 2011   21     14     37    76477       184 54.70479
3 13.05.2011  13     5 2011   21     17     40    76660       183 54.70548
4 13.05.2011  13     5 2011   21     20     44    76844       184 54.71007
5 13.05.2011  13     5 2011   21     23     48    77028       184 54.72099
6 13.05.2011  13     5 2011   21     26     52    77212       184 54.73233
   longitude  bird_id                 cet   xKoord  yKoord
1  8.349938 HA1_2011 2011-05-13 21:11:33 458111.9 6062117
2  8.349722 HA1_2011 2011-05-13 21:14:37 458098.1 6062135
3  8.344133 HA1_2011 2011-05-13 21:17:40 457738.7 6062216
4  8.338260 HA1_2011 2011-05-13 21:20:44 457365.1 6062730
5  8.320427 HA1_2011 2011-05-13 21:23:48 456227.9 6063956
6  8.312453 HA1_2011 2011-05-13 21:26:52 455726.7 6065223

ha11time <- dcol[, c("cet")]
ha11XY <- dcol[,c("xKoord", "yKoord")]
ha11ltraj <- as.ltraj(ha11XY, ha11time, id=dcol$bird_id,typeII=T)

##diffusion parameter
ha11D<-BRB.D(ha11ltraj,Tmax=420,Lmin=20)

##BRB
ha11_ud<-BRB(ha11ltraj,D=ha11_likD,type="UD",Tmax=420,tau=120,Lmin=20,radius=100, 
maxt=10*60,hmin=100,grid=500,extent=5)
##fatal error occurs


From annajess at gmx.de  Sat Apr 12 14:28:36 2014
From: annajess at gmx.de (Anna-Marie Corman)
Date: Sat, 12 Apr 2014 14:28:36 +0200
Subject: [R-sig-Geo] Problems in handling several animals in BRB calculation
In-Reply-To: <53492F80.5040404@gmx.de>
References: <53492F80.5040404@gmx.de>
Message-ID: <53493174.9010407@gmx.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140412/e43b64f7/attachment.pl>

From stefjelko at gmail.com  Sun Apr 13 20:36:09 2014
From: stefjelko at gmail.com (Stefan Jelkovich)
Date: Sun, 13 Apr 2014 20:36:09 +0200
Subject: [R-sig-Geo] How to create a SpatialMultiPoints object
Message-ID: <5B86315B-8639-4315-9974-0AF31C5762C8@gmail.com>

Hi all,

I?m struggling with the creation of a SpatialPoints/SpatialPointsDataFrame object containing MultiPoints. Is this possible at all?

# SinglePoints are that easy:
library(sp)
data(meuse)
coordinates(meuse) <- ~x+y

# MultiPolygons are that easy:
p1 <- Polygon(cbind(x=c(0, 0, 10, 10, 0), y=c(0, 10, 10, 0, 0)))
p2 <- Polygon(cbind(x=c(13, 13, 17, 17, 13), y=c(13, 17, 17, 13, 13)))
lp <- list(p1, p2)
pls <- Polygons(lp, ID="1")
mp <- SpatialPolygons(list(pls))

How can I put all the meuse data points in one MultiPoint object?

Stefan


From Roger.Bivand at nhh.no  Sun Apr 13 20:57:01 2014
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sun, 13 Apr 2014 20:57:01 +0200
Subject: [R-sig-Geo] How to create a SpatialMultiPoints object
In-Reply-To: <5B86315B-8639-4315-9974-0AF31C5762C8@gmail.com>
References: <5B86315B-8639-4315-9974-0AF31C5762C8@gmail.com>
Message-ID: <alpine.LRH.2.03.1404132051120.6460@reclus.nhh.no>

On Sun, 13 Apr 2014, Stefan Jelkovich wrote:

> Hi all,
>
> I?m struggling with the creation of a 
> SpatialPoints/SpatialPointsDataFrame object containing MultiPoints. Is 
> this possible at all?

Why would it be possible, as each geomtry feature (point) is associated 
with unique observed data values? A multipoint object is of little use in 
point pattern analysis or geostatistics (or other areas of spatial 
statistics) as its support is hard to use - the single unique observed 
data value for each geometry would be associated with multiple points, and 
a set of such objects might well overlap mutually, meaning that it would 
be very hard to retrieve observations.

If you feel that multipoint objects have a future in spatial statistics, 
please contribute a suitable class container and methods for handling it.

Hope this clarifies,

Roger

>
> # SinglePoints are that easy:
> library(sp)
> data(meuse)
> coordinates(meuse) <- ~x+y
>
> # MultiPolygons are that easy:
> p1 <- Polygon(cbind(x=c(0, 0, 10, 10, 0), y=c(0, 10, 10, 0, 0)))
> p2 <- Polygon(cbind(x=c(13, 13, 17, 17, 13), y=c(13, 17, 17, 13, 13)))
> lp <- list(p1, p2)
> pls <- Polygons(lp, ID="1")
> mp <- SpatialPolygons(list(pls))
>
> How can I put all the meuse data points in one MultiPoint object?
>
> Stefan
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no

From tkeitt at utexas.edu  Mon Apr 14 01:28:44 2014
From: tkeitt at utexas.edu (Tim Keitt)
Date: Sun, 13 Apr 2014 18:28:44 -0500
Subject: [R-sig-Geo] How to create a SpatialMultiPoints object
In-Reply-To: <5B86315B-8639-4315-9974-0AF31C5762C8@gmail.com>
References: <5B86315B-8639-4315-9974-0AF31C5762C8@gmail.com>
Message-ID: <CANnL8gpipzCKvxvwy5pRFcuTZB9iXdkmd+_MVkNuuLxymCSx+A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140413/fb9b2cc4/attachment.pl>

From kridox at ymail.com  Mon Apr 14 10:25:00 2014
From: kridox at ymail.com (Pascal Oettli)
Date: Mon, 14 Apr 2014 17:25:00 +0900
Subject: [R-sig-Geo] Subset a Raster* object read from a 4D NetCDF file
Message-ID: <CAAcyNCwU8LGG=927_aDeGWBPqCgKnxDkNVzTgnK+5ccQd9vr0A@mail.gmail.com>

Dear list members,

Could someone help me to understand the following case (works on
Linux. I don't know for other OS):

library(raster)
out <- brick('http://www.esrl.noaa.gov/psd/thredds/dodsC/Datasets/godas/pottmp.2013.nc',
lvar=3, level=1, varname='pottmp')

# error while subsetting
pottmp <- subset(out, 1:3)

# multiply by 1
out <- out * 1

# no error
pottmp <- subset(out, 1:3)


Thank you,
Pascal


From stefjelko at gmail.com  Mon Apr 14 11:35:40 2014
From: stefjelko at gmail.com (Stefan Jelkovich)
Date: Mon, 14 Apr 2014 11:35:40 +0200
Subject: [R-sig-Geo]  How to create a SpatialMultiPoints object
In-Reply-To: <alpine.LRH.2.03.1404132051120.6460@reclus.nhh.no>
References: <5B86315B-8639-4315-9974-0AF31C5762C8@gmail.com>
	<alpine.LRH.2.03.1404132051120.6460@reclus.nhh.no>
Message-ID: <F494F272-C2F8-459A-B928-738F3525E8F2@gmail.com>

Roger,

you are right. In case of the meuse data it makes no sense at all. Not the best example...
I do not see a clear adventage for the use of MultiPoints, too. Maybe in case of categorical data? I only wanted to create such an object to investigate the structure and prepare my functions for MultiPoint objects. 

So MultiPoints are not supported by the SpatialPoints and SpatialPointsDataFrame classes? That's fine for me.

By the way: if MultiPoint objects are imported in R and converted to SpatialPoints, the MultiPoint structure is just gone?

Thanks
Stefan

>> Am 13.04.2014 um 20:57 schrieb Roger Bivand <Roger.Bivand at nhh.no>:
>> 
>> On Sun, 13 Apr 2014, Stefan Jelkovich wrote:
>> 
>> Hi all,
>> 
>> I?m struggling with the creation of a SpatialPoints/SpatialPointsDataFrame object containing MultiPoints. Is this possible at all?
> 
> Why would it be possible, as each geomtry feature (point) is associated with unique observed data values? A multipoint object is of little use in point pattern analysis or geostatistics (or other areas of spatial statistics) as its support is hard to use - the single unique observed data value for each geometry would be associated with multiple points, and a set of such objects might well overlap mutually, meaning that it would be very hard to retrieve observations.
> 
> If you feel that multipoint objects have a future in spatial statistics, please contribute a suitable class container and methods for handling it.
> 
> Hope this clarifies,
> 
> Roger
> 
>> 
>> # SinglePoints are that easy:
>> library(sp)
>> data(meuse)
>> coordinates(meuse) <- ~x+y
>> 
>> # MultiPolygons are that easy:
>> p1 <- Polygon(cbind(x=c(0, 0, 10, 10, 0), y=c(0, 10, 10, 0, 0)))
>> p2 <- Polygon(cbind(x=c(13, 13, 17, 17, 13), y=c(13, 17, 17, 13, 13)))
>> lp <- list(p1, p2)
>> pls <- Polygons(lp, ID="1")
>> mp <- SpatialPolygons(list(pls))
>> 
>> How can I put all the meuse data points in one MultiPoint object?
>> 
>> Stefan
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> -- 
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 91 00
> e-mail: Roger.Bivand at nhh.no


From stefjelko at gmail.com  Mon Apr 14 11:46:59 2014
From: stefjelko at gmail.com (Stefan Jelkovich)
Date: Mon, 14 Apr 2014 11:46:59 +0200
Subject: [R-sig-Geo]  How to create a SpatialMultiPoints object
In-Reply-To: <CANnL8gpipzCKvxvwy5pRFcuTZB9iXdkmd+_MVkNuuLxymCSx+A@mail.gmail.com>
References: <5B86315B-8639-4315-9974-0AF31C5762C8@gmail.com>
	<CANnL8gpipzCKvxvwy5pRFcuTZB9iXdkmd+_MVkNuuLxymCSx+A@mail.gmail.com>
Message-ID: <284D2B1B-9B4F-44AF-B039-8E84CFA9B88E@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140414/9cdc8ecb/attachment.pl>

From loic.dutrieux at wur.nl  Mon Apr 14 11:51:37 2014
From: loic.dutrieux at wur.nl (Dutrieux, Loic)
Date: Mon, 14 Apr 2014 09:51:37 +0000
Subject: [R-sig-Geo] Subset a Raster* object read from a 4D NetCDF file
In-Reply-To: <CAAcyNCwU8LGG=927_aDeGWBPqCgKnxDkNVzTgnK+5ccQd9vr0A@mail.gmail.com>
References: <CAAcyNCwU8LGG=927_aDeGWBPqCgKnxDkNVzTgnK+5ccQd9vr0A@mail.gmail.com>
Message-ID: <A83620D4CC4762448EFB789FD6E9BBB7310FA944@SCOMP0937.wurnet.nl>

Dear Pascal,

It appears that you can't do this type of operations if the file is only open through a remote connection.
You may try:

library(raster)
out <- brick('http://www.esrl.noaa.gov/psd/thredds/dodsC/Datasets/godas/pottmp.2013.nc',
lvar=3, level=1, varname='pottmp')
out2 <- readAll(out)

# subset
pottmp <- subset(out2, 1:3)

Best regards,
Lo?c
________________________________________
From: r-sig-geo-bounces at r-project.org [r-sig-geo-bounces at r-project.org] on behalf of Pascal Oettli [kridox at ymail.com]
Sent: Monday, April 14, 2014 10:25 AM
To: r-sig-geo at r-project.org
Subject: [R-sig-Geo] Subset a Raster* object read from a 4D NetCDF file

Dear list members,

Could someone help me to understand the following case (works on
Linux. I don't know for other OS):

library(raster)
out <- brick('http://www.esrl.noaa.gov/psd/thredds/dodsC/Datasets/godas/pottmp.2013.nc',
lvar=3, level=1, varname='pottmp')

# error while subsetting
pottmp <- subset(out, 1:3)

# multiply by 1
out <- out * 1

# no error
pottmp <- subset(out, 1:3)


Thank you,
Pascal

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From kridox at ymail.com  Mon Apr 14 12:01:07 2014
From: kridox at ymail.com (Pascal Oettli)
Date: Mon, 14 Apr 2014 19:01:07 +0900
Subject: [R-sig-Geo] Subset a Raster* object read from a 4D NetCDF file
In-Reply-To: <A83620D4CC4762448EFB789FD6E9BBB7310FA944@SCOMP0937.wurnet.nl>
References: <CAAcyNCwU8LGG=927_aDeGWBPqCgKnxDkNVzTgnK+5ccQd9vr0A@mail.gmail.com>
	<A83620D4CC4762448EFB789FD6E9BBB7310FA944@SCOMP0937.wurnet.nl>
Message-ID: <CAAcyNCwNi3bDZrgtPvBEMK1VHbcB7UfPLaYeO27jzX-+HYHmFQ@mail.gmail.com>

Hello,

Thank you.

The same appears when the file is locally stored.

Regards,
Pascal

On Mon, Apr 14, 2014 at 6:51 PM, Dutrieux, Loic <loic.dutrieux at wur.nl> wrote:
> Dear Pascal,
>
> It appears that you can't do this type of operations if the file is only open through a remote connection.
> You may try:
>
> library(raster)
> out <- brick('http://www.esrl.noaa.gov/psd/thredds/dodsC/Datasets/godas/pottmp.2013.nc',
> lvar=3, level=1, varname='pottmp')
> out2 <- readAll(out)
>
> # subset
> pottmp <- subset(out2, 1:3)
>
> Best regards,
> Lo?c
> ________________________________________
> From: r-sig-geo-bounces at r-project.org [r-sig-geo-bounces at r-project.org] on behalf of Pascal Oettli [kridox at ymail.com]
> Sent: Monday, April 14, 2014 10:25 AM
> To: r-sig-geo at r-project.org
> Subject: [R-sig-Geo] Subset a Raster* object read from a 4D NetCDF file
>
> Dear list members,
>
> Could someone help me to understand the following case (works on
> Linux. I don't know for other OS):
>
> library(raster)
> out <- brick('http://www.esrl.noaa.gov/psd/thredds/dodsC/Datasets/godas/pottmp.2013.nc',
> lvar=3, level=1, varname='pottmp')
>
> # error while subsetting
> pottmp <- subset(out, 1:3)
>
> # multiply by 1
> out <- out * 1
>
> # no error
> pottmp <- subset(out, 1:3)
>
>
> Thank you,
> Pascal
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>



-- 
Pascal Oettli
Project Scientist
JAMSTEC
Yokohama, Japan


From Roger.Bivand at nhh.no  Mon Apr 14 13:55:29 2014
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 14 Apr 2014 13:55:29 +0200
Subject: [R-sig-Geo] How to create a SpatialMultiPoints object
In-Reply-To: <F494F272-C2F8-459A-B928-738F3525E8F2@gmail.com>
References: <5B86315B-8639-4315-9974-0AF31C5762C8@gmail.com>
	<alpine.LRH.2.03.1404132051120.6460@reclus.nhh.no>
	<F494F272-C2F8-459A-B928-738F3525E8F2@gmail.com>
Message-ID: <alpine.LRH.2.03.1404141349090.9302@reclus.nhh.no>

On Mon, 14 Apr 2014, Stefan Jelkovich wrote:

> Roger,
>
> you are right. In case of the meuse data it makes no sense at all. Not 
> the best example... I do not see a clear adventage for the use of 
> MultiPoints, too. Maybe in case of categorical data? I only wanted to 
> create such an object to investigate the structure and prepare my 
> functions for MultiPoint objects.
>
> So MultiPoints are not supported by the SpatialPoints and 
> SpatialPointsDataFrame classes? That's fine for me.
>
> By the way: if MultiPoint objects are imported in R and converted to 
> SpatialPoints, the MultiPoint structure is just gone?

library(rgeos)
g4=readWKT("MULTIPOINT((3.5 5.6),(4.8 10.5))")
g4
class(g4)
str(g4)
slot(g4, "coords")

(they get identical rownames in the coordinate matrix, but by default 
there is no key/ID checking for points, so this is not reliable). The fact 
that the points belong to a multipoint geometry is not recorded anywhere 
as it is an attribute of the points.

In your use case, the categorical observations have point support, not 
multipoint support, so grouping points with the same category level is a 
choice the user makes, but does confuse support. It could be done, but 
would involve a lot of shoehorning to associate the points with their 
appropriate geometry, and makes no great sense.

Roger


>
> Thanks
> Stefan
>
>>> Am 13.04.2014 um 20:57 schrieb Roger Bivand <Roger.Bivand at nhh.no>:
>>> 
>>> On Sun, 13 Apr 2014, Stefan Jelkovich wrote:
>>> 
>>> Hi all,
>>> 
>>> I?m struggling with the creation of a SpatialPoints/SpatialPointsDataFrame object containing MultiPoints. Is this possible at all?
>> 
>> Why would it be possible, as each geomtry feature (point) is associated with unique observed data values? A multipoint object is of little use in point pattern analysis or geostatistics (or other areas of spatial statistics) as its support is hard to use - the single unique observed data value for each geometry would be associated with multiple points, and a set of such objects might well overlap mutually, meaning that it would be very hard to retrieve observations.
>> 
>> If you feel that multipoint objects have a future in spatial statistics, please contribute a suitable class container and methods for handling it.
>> 
>> Hope this clarifies,
>> 
>> Roger
>> 
>>> 
>>> # SinglePoints are that easy:
>>> library(sp)
>>> data(meuse)
>>> coordinates(meuse) <- ~x+y
>>> 
>>> # MultiPolygons are that easy:
>>> p1 <- Polygon(cbind(x=c(0, 0, 10, 10, 0), y=c(0, 10, 10, 0, 0)))
>>> p2 <- Polygon(cbind(x=c(13, 13, 17, 17, 13), y=c(13, 17, 17, 13, 13)))
>>> lp <- list(p1, p2)
>>> pls <- Polygons(lp, ID="1")
>>> mp <- SpatialPolygons(list(pls))
>>> 
>>> How can I put all the meuse data points in one MultiPoint object?
>>> 
>>> Stefan
>>> 
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
>> -- 
>> Roger Bivand
>> Department of Economics, Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 91 00
>> e-mail: Roger.Bivand at nhh.no
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no

From edzer.pebesma at uni-muenster.de  Mon Apr 14 15:34:56 2014
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 14 Apr 2014 15:34:56 +0200
Subject: [R-sig-Geo] How to create a SpatialMultiPoints object
In-Reply-To: <alpine.LRH.2.03.1404141349090.9302@reclus.nhh.no>
References: <5B86315B-8639-4315-9974-0AF31C5762C8@gmail.com>	<alpine.LRH.2.03.1404132051120.6460@reclus.nhh.no>	<F494F272-C2F8-459A-B928-738F3525E8F2@gmail.com>
	<alpine.LRH.2.03.1404141349090.9302@reclus.nhh.no>
Message-ID: <534BE400.4050904@uni-muenster.de>

http://cran.r-project.org/web/packages/sp/vignettes/csdacm.pdf

is a retired chapter from the first edition of http://www.asdar-book.org
and describes a possible implementation of SpatialMultiPoints in a way
similar to other classes deriving from Spatial. Since its appearance in
2008, nobody has ever mentioned using them, but if you try, let me know
which new problems it solves!

I think the more usual way of treating these things is having
SpatialPointsDataFrame objects with a factor explaining what each point
represents (e.g, trees of different species), like a marked point
pattern with nominal marks.

On 04/14/2014 01:55 PM, Roger Bivand wrote:
> On Mon, 14 Apr 2014, Stefan Jelkovich wrote:
> 
>> Roger,
>>
>> you are right. In case of the meuse data it makes no sense at all. Not
>> the best example... I do not see a clear adventage for the use of
>> MultiPoints, too. Maybe in case of categorical data? I only wanted to
>> create such an object to investigate the structure and prepare my
>> functions for MultiPoint objects.
>>
>> So MultiPoints are not supported by the SpatialPoints and
>> SpatialPointsDataFrame classes? That's fine for me.
>>
>> By the way: if MultiPoint objects are imported in R and converted to
>> SpatialPoints, the MultiPoint structure is just gone?
> 
> library(rgeos)
> g4=readWKT("MULTIPOINT((3.5 5.6),(4.8 10.5))")
> g4
> class(g4)
> str(g4)
> slot(g4, "coords")
> 
> (they get identical rownames in the coordinate matrix, but by default
> there is no key/ID checking for points, so this is not reliable). The
> fact that the points belong to a multipoint geometry is not recorded
> anywhere as it is an attribute of the points.
> 
> In your use case, the categorical observations have point support, not
> multipoint support, so grouping points with the same category level is a
> choice the user makes, but does confuse support. It could be done, but
> would involve a lot of shoehorning to associate the points with their
> appropriate geometry, and makes no great sense.
> 
> Roger
> 
> 
>>
>> Thanks
>> Stefan
>>
>>>> Am 13.04.2014 um 20:57 schrieb Roger Bivand <Roger.Bivand at nhh.no>:
>>>>
>>>> On Sun, 13 Apr 2014, Stefan Jelkovich wrote:
>>>>
>>>> Hi all,
>>>>
>>>> I?m struggling with the creation of a
>>>> SpatialPoints/SpatialPointsDataFrame object containing MultiPoints.
>>>> Is this possible at all?
>>>
>>> Why would it be possible, as each geomtry feature (point) is
>>> associated with unique observed data values? A multipoint object is
>>> of little use in point pattern analysis or geostatistics (or other
>>> areas of spatial statistics) as its support is hard to use - the
>>> single unique observed data value for each geometry would be
>>> associated with multiple points, and a set of such objects might well
>>> overlap mutually, meaning that it would be very hard to retrieve
>>> observations.
>>>
>>> If you feel that multipoint objects have a future in spatial
>>> statistics, please contribute a suitable class container and methods
>>> for handling it.
>>>
>>> Hope this clarifies,
>>>
>>> Roger
>>>
>>>>
>>>> # SinglePoints are that easy:
>>>> library(sp)
>>>> data(meuse)
>>>> coordinates(meuse) <- ~x+y
>>>>
>>>> # MultiPolygons are that easy:
>>>> p1 <- Polygon(cbind(x=c(0, 0, 10, 10, 0), y=c(0, 10, 10, 0, 0)))
>>>> p2 <- Polygon(cbind(x=c(13, 13, 17, 17, 13), y=c(13, 17, 17, 13, 13)))
>>>> lp <- list(p1, p2)
>>>> pls <- Polygons(lp, ID="1")
>>>> mp <- SpatialPolygons(list(pls))
>>>>
>>>> How can I put all the meuse data points in one MultiPoint object?
>>>>
>>>> Stefan
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>> -- 
>>> Roger Bivand
>>> Department of Economics, Norwegian School of Economics,
>>> Helleveien 30, N-5045 Bergen, Norway.
>>> voice: +47 55 95 93 55; fax +47 55 95 91 00
>>> e-mail: Roger.Bivand at nhh.no
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140414/064c276d/attachment.bin>

From edzer.pebesma at uni-muenster.de  Mon Apr 14 15:58:17 2014
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 14 Apr 2014 15:58:17 +0200
Subject: [R-sig-Geo] decimals in NA value using raster::writeRaster with
 .ascii format
In-Reply-To: <CAGC_mZT8NQ=0mEsU35yeyVnQOCXMogP=ji1yQp3MvrkYY60-kw@mail.gmail.com>
References: <CAGC_mZTEpDOwYVQh7ZEBgnjgRWjPn2HdK5-9NjQ7RQ_9jm5qTg@mail.gmail.com>	<CABG0rfvntKdq_wv=L5ijmYXwmijP-xuvMRAx3XQ5M7jjbDWKrw@mail.gmail.com>	<CAGC_mZSgqfKiww_hB3OuNdy7TLbAT81VH8QkrnX=kSmUKX8XrA@mail.gmail.com>	<CABG0rftdREoQKJZniJJX7LKvvOKb4Qz+0AzLbsO+M0_Q=jpzOg@mail.gmail.com>	<CANtt_hzJvYzX2mAHohemjUhBnjpWe+KnzmwrTCAh3m4fB3qkBQ@mail.gmail.com>	<CABG0rfvErscZyUOQe4+V=FtrjzowZk1aJi0p=KRzPJ-y6k00Xg@mail.gmail.com>
	<CAGC_mZT8NQ=0mEsU35yeyVnQOCXMogP=ji1yQp3MvrkYY60-kw@mail.gmail.com>
Message-ID: <534BE979.2010303@uni-muenster.de>



On 04/11/2014 05:46 PM, Zack Holden wrote:
> Robert,
> Thank you for your help. I failed to notice the "datatype vs. dataType
> difference. Calling 'datatype' does indeed solve my integer test case.
> However, some of the raster datasets that I am processing are actually
> floating point. When I call writeRaster(datatype = 'FLT4S'), I still
> see the long string of decimals in the first value in my ascii grid.
> 
> Is there any way to handle this in R? From your response, it sounds
> like this might be an artifact of GDAL, and I may need to manually (or
> with text manipulations) edit out the decimal strings.

Look for

https://r-forge.r-project.org/scm/viewvc.php/pkg/raster/R/writeAllAscii.R?view=markup&root=raster

and lower the 15, or else change the formatC call, then rebuild raster.

As described earlier, raster does this on purpose: the gdal asciigrid
reader makes the wrong assumption about the data type when a grid starts
with too many missing values that look like an integer (like -9999 but
unlike -9999.0). This has been reported over a decade ago, and may be
seen as an indication of gdal's liveliness. Not only OpenSSL suffers
from too few eyes to make bugs shallow.

What software are you using that can't digest the 15-digit float?

> 
> Thanks for any additional suggestions.
> 
> Javier, thanks for pointing out the available GDAL drivers in
> PCraster, I'm just getting acquainted with that software program.
> 
> Cheers,
> Zack
> 
> 
> On Fri, Apr 11, 2014 at 8:48 AM, Jonathan Greenberg <jgrn at illinois.edu> wrote:
>> Robert:
>>
>> What is the practical difference between those two? -- does dataType
>> get passed off to GDAL, while datatype is interpreted by your R code?
>>
>> --j
>>
>> On Thu, Apr 10, 2014 at 7:06 PM, Robert J. Hijmans <r.hijmans at gmail.com> wrote:
>>> Zack,
>>>
>>> You are using:     dataType="INT2U"
>>>
>>> but it should be:     datatype="INT2U"  # (or any other INT data type)
>>>
>>> That fixes it. If the datatype is FLT* (the default), the first value
>>> gets decimals to assure that GDAL and others treat the values as
>>> floats, not integers.
>>>
>>> Robert
>>>
>>> On Thu, Apr 10, 2014 at 3:36 PM, Jonathan Greenberg <jgrn at illinois.edu> wrote:
>>>> Zack:
>>>>
>>>> Hopefully Robert will get back to you (I confirmed it -- it looks like
>>>> a bug to me) -- but in the meantime, you might want to try my
>>>> gdalUtils package, which uses gdal_translate to convert files.  You
>>>> can use one of the many ASCII formats -- you'll want to use parameters
>>>> like:
>>>> gdal_translate(...,a_nodata=-9999,ot="UInt16",format="...")
>>>>
>>>> You can see the available formats at: http://www.gdal.org/formats_list.html
>>>>
>>>> --j
>>>>
>>>>
>>>>
>>>> --
>>>>
>>>> On Thu, Apr 10, 2014 at 5:29 PM, Zack Holden <zaholdenfs at gmail.com> wrote:
>>>>> Thanks for getting back to me Jonathan.
>>>>>
>>>>> In reality, I am creating the files from an existing DEM. However, I
>>>>> get the same behavior regardless of whether I generate the file in R
>>>>> (as with my example code) or with actual data.
>>>>> I have since tested on 4 machines. One windows machine with an older
>>>>> version of R successfully generates the desired ascii file without the
>>>>> decimals. The other 3 computers (Linux and windows machines) add the
>>>>> decimals. As a workaround, I've tried using -Inf as my NAflag. This
>>>>> eliminates the decimals, but results in a large string of white space
>>>>> in front of the first row of data. These still cause problems for
>>>>> PCraster (the next step in the processing chain).
>>>>>
>>>>> I'm still stumped.
>>>>>
>>>>> Thanks again,
>>>>> Zack
>>>>>
>>>>>
>>>>> On Thu, Apr 10, 2014 at 4:22 PM, Jonathan Greenberg <jgrn at illinois.edu> wrote:
>>>>>> Zack:
>>>>>>
>>>>>> Are you creating the files from within R, or are you just trying to
>>>>>> convert an existing file?  If the latter, can you make one of those
>>>>>> files available (e.g. via google drive or dropbox or something like
>>>>>> that)?
>>>>>>
>>>>>> --j
>>>>>>
>>>>>> On Thu, Apr 10, 2014 at 3:06 PM, Zack Holden <zaholdenfs at gmail.com> wrote:
>>>>>>> Dear list,
>>>>>>>
>>>>>>> I am creating ascii files as inputs to the PCraster software (no other
>>>>>>> gdal format is allowed). When I write my ascii file using
>>>>>>> raster::writeRaster, the first cell of every raster that I write has a
>>>>>>> large number of decimal values appended to it. This causes errors
>>>>>>> later in the model workflow.
>>>>>>>
>>>>>>> This also happens to the first NA value in the file, so that all NA
>>>>>>> values in the file are e.g. -9999 except the first cell. which appears
>>>>>>> as: -9999.00000000000
>>>>>>>
>>>>>>> Can anyone suggest a method for ensuring that all of my NA values are
>>>>>>> identical and with no trailing decimals?
>>>>>>>
>>>>>>> A small reproducible example follows. Any help or suggestions is appreciated.
>>>>>>>
>>>>>>> Thanks,
>>>>>>> Zack
>>>>>>>
>>>>>>> ##################
>>>>>>> # start code
>>>>>>> require(raster)
>>>>>>> r <- raster(nrows=2, ncols=2, xmn=0, xmx=2, ymn=0, ymx=2)
>>>>>>> r <- setValues(r, seq(1:ncell(r)))
>>>>>>> rexpand <- extend(r, c(2,2))
>>>>>>> NAvalue(rexpand) <- -9999
>>>>>>>
>>>>>>> temp.dir <- "/home/zholden/"
>>>>>>> writeRaster(rexpand, file=paste(temp.dir, "testraster.asc",sep=""),
>>>>>>> NAflag=-9999, dataType="INT2U", overwrite=T)
>>>>>>> # end code
>>>>>>> ##################
>>>>>>>
>>>>>>> # opening in a text editor reveals trailing decimals in the first NA value.
>>>>>>> system(paste("gedit ", temp.dir, "testraster.asc", sep=""))
>>>>>>>
>>>>>>> ################################
>>>>>>>  sessionInfo()
>>>>>>> R version 3.0.2 (2013-09-25)
>>>>>>> Platform: x86_64-redhat-linux-gnu (64-bit)
>>>>>>>
>>>>>>> locale:
>>>>>>>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>>>>>>> LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>>>>>>> LC_MONETARY=en_US.UTF-8
>>>>>>>  [6] LC_MESSAGES=en_US.UTF-8    LC_PAPER=en_US.UTF-8       LC_NAME=C
>>>>>>>                LC_ADDRESS=C               LC_TELEPHONE=C
>>>>>>> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>>>>>>>
>>>>>>> attached base packages:
>>>>>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>>>>>
>>>>>>> other attached packages:
>>>>>>> [1] rgdal_0.8-16  raster_2.2-12 sp_1.0-14
>>>>>>>
>>>>>>> loaded via a namespace (and not attached):
>>>>>>> [1] grid_3.0.2      lattice_0.20-23 tools_3.0.2
>>>>>>>
>>>>>>> _______________________________________________
>>>>>>> R-sig-Geo mailing list
>>>>>>> R-sig-Geo at r-project.org
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>>
>>>>>>
>>>>>>
>>>>>> --
>>>>>> Jonathan A. Greenberg, PhD
>>>>>> Assistant Professor
>>>>>> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
>>>>>> Department of Geography and Geographic Information Science
>>>>>> University of Illinois at Urbana-Champaign
>>>>>> 259 Computing Applications Building, MC-150
>>>>>> 605 East Springfield Avenue
>>>>>> Champaign, IL  61820-6371
>>>>>> Phone: 217-300-1924
>>>>>> http://www.geog.illinois.edu/~jgrn/
>>>>>> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
>>>>
>>>>
>>>>
>>>> --
>>>> Jonathan A. Greenberg, PhD
>>>> Assistant Professor
>>>> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
>>>> Department of Geography and Geographic Information Science
>>>> University of Illinois at Urbana-Champaign
>>>> 259 Computing Applications Building, MC-150
>>>> 605 East Springfield Avenue
>>>> Champaign, IL  61820-6371
>>>> Phone: 217-300-1924
>>>> http://www.geog.illinois.edu/~jgrn/
>>>> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>>
>> --
>> Jonathan A. Greenberg, PhD
>> Assistant Professor
>> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
>> Department of Geography and Geographic Information Science
>> University of Illinois at Urbana-Champaign
>> 259 Computing Applications Building, MC-150
>> 605 East Springfield Avenue
>> Champaign, IL  61820-6371
>> Phone: 217-300-1924
>> http://www.geog.illinois.edu/~jgrn/
>> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140414/603c28f5/attachment.bin>

From bakare at ualberta.ca  Mon Apr 14 17:56:35 2014
From: bakare at ualberta.ca (Moshood Agba Bakare)
Date: Mon, 14 Apr 2014 09:56:35 -0600
Subject: [R-sig-Geo] gstat: standard error of variogram model parameter
	estimate
Message-ID: <CAJRR3XMLfMm80OU9xCBks6X3LLiaecZDG83WHnRti1JLmNqOmg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140414/1096f822/attachment.pl>

From zaholdenfs at gmail.com  Mon Apr 14 18:54:34 2014
From: zaholdenfs at gmail.com (Zack Holden)
Date: Mon, 14 Apr 2014 09:54:34 -0700
Subject: [R-sig-Geo] decimals in NA value using raster::writeRaster with
 .ascii format
In-Reply-To: <534BE979.2010303@uni-muenster.de>
References: <CAGC_mZTEpDOwYVQh7ZEBgnjgRWjPn2HdK5-9NjQ7RQ_9jm5qTg@mail.gmail.com>
	<CABG0rfvntKdq_wv=L5ijmYXwmijP-xuvMRAx3XQ5M7jjbDWKrw@mail.gmail.com>
	<CAGC_mZSgqfKiww_hB3OuNdy7TLbAT81VH8QkrnX=kSmUKX8XrA@mail.gmail.com>
	<CABG0rftdREoQKJZniJJX7LKvvOKb4Qz+0AzLbsO+M0_Q=jpzOg@mail.gmail.com>
	<CANtt_hzJvYzX2mAHohemjUhBnjpWe+KnzmwrTCAh3m4fB3qkBQ@mail.gmail.com>
	<CABG0rfvErscZyUOQe4+V=FtrjzowZk1aJi0p=KRzPJ-y6k00Xg@mail.gmail.com>
	<CAGC_mZT8NQ=0mEsU35yeyVnQOCXMogP=ji1yQp3MvrkYY60-kw@mail.gmail.com>
	<534BE979.2010303@uni-muenster.de>
Message-ID: <CAGC_mZRc7a25DZnYHU0df_kwamewJ8qrzNqC-D5JK67jELqruQ@mail.gmail.com>

Hi Edzer,
Thank you for your helpful comments. I am generating ascii files as
inputs to PCraster. I realize now that when producing grids for other
software, I need to be more careful about assigning data type and NA
values to my outputs when I write them. When my work is all done in R,
this hasn't ever been a problem. Using:
writeRaster(file="myraster.asc", datatype="FLT4S", NAval=-Inf )
PCraster reads them correctly.

Thanks all for the helpful suggestions.

Best,
Zack


On Mon, Apr 14, 2014 at 6:58 AM, Edzer Pebesma
<edzer.pebesma at uni-muenster.de> wrote:
>
>
> On 04/11/2014 05:46 PM, Zack Holden wrote:
>> Robert,
>> Thank you for your help. I failed to notice the "datatype vs. dataType
>> difference. Calling 'datatype' does indeed solve my integer test case.
>> However, some of the raster datasets that I am processing are actually
>> floating point. When I call writeRaster(datatype = 'FLT4S'), I still
>> see the long string of decimals in the first value in my ascii grid.
>>
>> Is there any way to handle this in R? From your response, it sounds
>> like this might be an artifact of GDAL, and I may need to manually (or
>> with text manipulations) edit out the decimal strings.
>
> Look for
>
> https://r-forge.r-project.org/scm/viewvc.php/pkg/raster/R/writeAllAscii.R?view=markup&root=raster
>
> and lower the 15, or else change the formatC call, then rebuild raster.
>
> As described earlier, raster does this on purpose: the gdal asciigrid
> reader makes the wrong assumption about the data type when a grid starts
> with too many missing values that look like an integer (like -9999 but
> unlike -9999.0). This has been reported over a decade ago, and may be
> seen as an indication of gdal's liveliness. Not only OpenSSL suffers
> from too few eyes to make bugs shallow.
>
> What software are you using that can't digest the 15-digit float?
>
>>
>> Thanks for any additional suggestions.
>>
>> Javier, thanks for pointing out the available GDAL drivers in
>> PCraster, I'm just getting acquainted with that software program.
>>
>> Cheers,
>> Zack
>>
>>
>> On Fri, Apr 11, 2014 at 8:48 AM, Jonathan Greenberg <jgrn at illinois.edu> wrote:
>>> Robert:
>>>
>>> What is the practical difference between those two? -- does dataType
>>> get passed off to GDAL, while datatype is interpreted by your R code?
>>>
>>> --j
>>>
>>> On Thu, Apr 10, 2014 at 7:06 PM, Robert J. Hijmans <r.hijmans at gmail.com> wrote:
>>>> Zack,
>>>>
>>>> You are using:     dataType="INT2U"
>>>>
>>>> but it should be:     datatype="INT2U"  # (or any other INT data type)
>>>>
>>>> That fixes it. If the datatype is FLT* (the default), the first value
>>>> gets decimals to assure that GDAL and others treat the values as
>>>> floats, not integers.
>>>>
>>>> Robert
>>>>
>>>> On Thu, Apr 10, 2014 at 3:36 PM, Jonathan Greenberg <jgrn at illinois.edu> wrote:
>>>>> Zack:
>>>>>
>>>>> Hopefully Robert will get back to you (I confirmed it -- it looks like
>>>>> a bug to me) -- but in the meantime, you might want to try my
>>>>> gdalUtils package, which uses gdal_translate to convert files.  You
>>>>> can use one of the many ASCII formats -- you'll want to use parameters
>>>>> like:
>>>>> gdal_translate(...,a_nodata=-9999,ot="UInt16",format="...")
>>>>>
>>>>> You can see the available formats at: http://www.gdal.org/formats_list.html
>>>>>
>>>>> --j
>>>>>
>>>>>
>>>>>
>>>>> --
>>>>>
>>>>> On Thu, Apr 10, 2014 at 5:29 PM, Zack Holden <zaholdenfs at gmail.com> wrote:
>>>>>> Thanks for getting back to me Jonathan.
>>>>>>
>>>>>> In reality, I am creating the files from an existing DEM. However, I
>>>>>> get the same behavior regardless of whether I generate the file in R
>>>>>> (as with my example code) or with actual data.
>>>>>> I have since tested on 4 machines. One windows machine with an older
>>>>>> version of R successfully generates the desired ascii file without the
>>>>>> decimals. The other 3 computers (Linux and windows machines) add the
>>>>>> decimals. As a workaround, I've tried using -Inf as my NAflag. This
>>>>>> eliminates the decimals, but results in a large string of white space
>>>>>> in front of the first row of data. These still cause problems for
>>>>>> PCraster (the next step in the processing chain).
>>>>>>
>>>>>> I'm still stumped.
>>>>>>
>>>>>> Thanks again,
>>>>>> Zack
>>>>>>
>>>>>>
>>>>>> On Thu, Apr 10, 2014 at 4:22 PM, Jonathan Greenberg <jgrn at illinois.edu> wrote:
>>>>>>> Zack:
>>>>>>>
>>>>>>> Are you creating the files from within R, or are you just trying to
>>>>>>> convert an existing file?  If the latter, can you make one of those
>>>>>>> files available (e.g. via google drive or dropbox or something like
>>>>>>> that)?
>>>>>>>
>>>>>>> --j
>>>>>>>
>>>>>>> On Thu, Apr 10, 2014 at 3:06 PM, Zack Holden <zaholdenfs at gmail.com> wrote:
>>>>>>>> Dear list,
>>>>>>>>
>>>>>>>> I am creating ascii files as inputs to the PCraster software (no other
>>>>>>>> gdal format is allowed). When I write my ascii file using
>>>>>>>> raster::writeRaster, the first cell of every raster that I write has a
>>>>>>>> large number of decimal values appended to it. This causes errors
>>>>>>>> later in the model workflow.
>>>>>>>>
>>>>>>>> This also happens to the first NA value in the file, so that all NA
>>>>>>>> values in the file are e.g. -9999 except the first cell. which appears
>>>>>>>> as: -9999.00000000000
>>>>>>>>
>>>>>>>> Can anyone suggest a method for ensuring that all of my NA values are
>>>>>>>> identical and with no trailing decimals?
>>>>>>>>
>>>>>>>> A small reproducible example follows. Any help or suggestions is appreciated.
>>>>>>>>
>>>>>>>> Thanks,
>>>>>>>> Zack
>>>>>>>>
>>>>>>>> ##################
>>>>>>>> # start code
>>>>>>>> require(raster)
>>>>>>>> r <- raster(nrows=2, ncols=2, xmn=0, xmx=2, ymn=0, ymx=2)
>>>>>>>> r <- setValues(r, seq(1:ncell(r)))
>>>>>>>> rexpand <- extend(r, c(2,2))
>>>>>>>> NAvalue(rexpand) <- -9999
>>>>>>>>
>>>>>>>> temp.dir <- "/home/zholden/"
>>>>>>>> writeRaster(rexpand, file=paste(temp.dir, "testraster.asc",sep=""),
>>>>>>>> NAflag=-9999, dataType="INT2U", overwrite=T)
>>>>>>>> # end code
>>>>>>>> ##################
>>>>>>>>
>>>>>>>> # opening in a text editor reveals trailing decimals in the first NA value.
>>>>>>>> system(paste("gedit ", temp.dir, "testraster.asc", sep=""))
>>>>>>>>
>>>>>>>> ################################
>>>>>>>>  sessionInfo()
>>>>>>>> R version 3.0.2 (2013-09-25)
>>>>>>>> Platform: x86_64-redhat-linux-gnu (64-bit)
>>>>>>>>
>>>>>>>> locale:
>>>>>>>>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>>>>>>>> LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>>>>>>>> LC_MONETARY=en_US.UTF-8
>>>>>>>>  [6] LC_MESSAGES=en_US.UTF-8    LC_PAPER=en_US.UTF-8       LC_NAME=C
>>>>>>>>                LC_ADDRESS=C               LC_TELEPHONE=C
>>>>>>>> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>>>>>>>>
>>>>>>>> attached base packages:
>>>>>>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>>>>>>
>>>>>>>> other attached packages:
>>>>>>>> [1] rgdal_0.8-16  raster_2.2-12 sp_1.0-14
>>>>>>>>
>>>>>>>> loaded via a namespace (and not attached):
>>>>>>>> [1] grid_3.0.2      lattice_0.20-23 tools_3.0.2
>>>>>>>>
>>>>>>>> _______________________________________________
>>>>>>>> R-sig-Geo mailing list
>>>>>>>> R-sig-Geo at r-project.org
>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>> --
>>>>>>> Jonathan A. Greenberg, PhD
>>>>>>> Assistant Professor
>>>>>>> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
>>>>>>> Department of Geography and Geographic Information Science
>>>>>>> University of Illinois at Urbana-Champaign
>>>>>>> 259 Computing Applications Building, MC-150
>>>>>>> 605 East Springfield Avenue
>>>>>>> Champaign, IL  61820-6371
>>>>>>> Phone: 217-300-1924
>>>>>>> http://www.geog.illinois.edu/~jgrn/
>>>>>>> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
>>>>>
>>>>>
>>>>>
>>>>> --
>>>>> Jonathan A. Greenberg, PhD
>>>>> Assistant Professor
>>>>> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
>>>>> Department of Geography and Geographic Information Science
>>>>> University of Illinois at Urbana-Champaign
>>>>> 259 Computing Applications Building, MC-150
>>>>> 605 East Springfield Avenue
>>>>> Champaign, IL  61820-6371
>>>>> Phone: 217-300-1924
>>>>> http://www.geog.illinois.edu/~jgrn/
>>>>> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
>>>>>
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>>>
>>> --
>>> Jonathan A. Greenberg, PhD
>>> Assistant Professor
>>> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
>>> Department of Geography and Geographic Information Science
>>> University of Illinois at Urbana-Champaign
>>> 259 Computing Applications Building, MC-150
>>> 605 East Springfield Avenue
>>> Champaign, IL  61820-6371
>>> Phone: 217-300-1924
>>> http://www.geog.illinois.edu/~jgrn/
>>> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> --
> Edzer Pebesma
> Institute for Geoinformatics (ifgi), University of M?nster
> Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
> 83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From edzer.pebesma at uni-muenster.de  Mon Apr 14 21:42:55 2014
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 14 Apr 2014 21:42:55 +0200
Subject: [R-sig-Geo] how to construct a variogram map
In-Reply-To: <9F9A66B5-47A6-434E-8263-8D71E6901F7F@gmail.com>
References: <9F9A66B5-47A6-434E-8263-8D71E6901F7F@gmail.com>
Message-ID: <534C3A3F.9020702@uni-muenster.de>



On 04/11/2014 03:14 PM, Alessandra Carioli wrote:
> Dear All,
> 
> I am trying to construct a variogram map from a SptialPolygonsDataFrame. I am not sure where to start as I would need a SpatialPoints and not Polygons. Is there a way to coerce it into points? I have tried as.SpatialPoints.ppp and as.SpatialPointsDataFrame but neither works (I have my matrix of coordinates `coords`).
> 
> Bests,
> 
> Ale


It depends whether your polygons represent a constant property
throughout the polygons, e.g. like soil or geology maps do, or aggregate
properties over an area, such as population over administrative regions.

In the former case, you could use spsample to sample points within the
polygons; in the second case you may want to assign the attribute values
to polygon centroids, e.g. if your object is called pol, by

SpatialPointsDataFrame(coordinates(pol), as.data.frame(pol))

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795


From pingyang.whu at gmail.com  Mon Apr 14 22:57:16 2014
From: pingyang.whu at gmail.com (ping yang)
Date: Mon, 14 Apr 2014 15:57:16 -0500
Subject: [R-sig-Geo] issue in using projectRaster in raster library
In-Reply-To: <CABG0rfvcJVAx_+EYFJjFbcU84hng1tZYtksQco3Z-is55zyUfg@mail.gmail.com>
References: <CAK8gSG-zmjVhAkH9eBZetq4G47w9Ym3z3fwr=FNZB4hirMKS3Q@mail.gmail.com>
	<CACwzsXEJJpxGMwNmzfTc6=Jt8OyYZe9GzT8dBUc5oM+2wqGsbA@mail.gmail.com>
	<CABG0rfu2Nnh5Ah98K-xRwJMDRs+_90JKjZ76Pfcewrc6jaKDAg@mail.gmail.com>
	<CAK8gSG81UwLHqc0z4paX-T2yJF13L5T9ptpY25Sifgq8vjMjKQ@mail.gmail.com>
	<CABG0rftD0BECeaF0wDA97jbBhHdsLH3-g-yP+zUwCJ2yXi8Tsw@mail.gmail.com>
	<CAK8gSG_y586EmrHuVZ6g3+G3Ug8sLdo-XdkFTqpRgZGiVg3NPg@mail.gmail.com>
	<CABG0rfuJoRs5YhLJsxiwMguWcj1TMGZa_tDSy=A9uKzD20kKig@mail.gmail.com>
	<CAK8gSG_Lb02Btes1TysFYLTbU7ApeLC=NSjY5rECsDUz-03ykA@mail.gmail.com>
	<CABG0rfvcJVAx_+EYFJjFbcU84hng1tZYtksQco3Z-is55zyUfg@mail.gmail.com>
Message-ID: <CAK8gSG8=mp42fkdhTPuSabpxG4As-LHhEZ4-4c0g+SHrhtcbKg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140414/9d68648b/attachment.pl>

From ariel.fuentesdi at usach.cl  Tue Apr 15 01:26:03 2014
From: ariel.fuentesdi at usach.cl (Ariel Fuentesdi)
Date: Mon, 14 Apr 2014 19:26:03 -0400
Subject: [R-sig-Geo] Help on Connecting R with Grass!
Message-ID: <CAD0a9KgQyKUsiTJ6cLuhnv8+Ckz15earZnjAm=B4axiwkLLUbw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140414/d3bc53bc/attachment.pl>

From philippe.roudier at jrc.ec.europa.eu  Tue Apr 15 12:12:36 2014
From: philippe.roudier at jrc.ec.europa.eu (Philippe R)
Date: Tue, 15 Apr 2014 03:12:36 -0700 (PDT)
Subject: [R-sig-Geo] [RGDAL] Error with writeGDAL to pcraster maps (in a
	loop)
Message-ID: <1397556756418-7586213.post@n2.nabble.com>

Hello everyone

My problem is the following : basically I need to pick up daily
precipitation data from a netcdf file (50000 days) to create 50000 pcraster
maps (one for each day). 
I am therefore doing a loop using RGDAL that looks like:

/for (d in 1:50000){

tget<-readGDAL("R:/mypath/target.map")   ##here I load my .map target file

tget at data<-new_data[d]    #I change the data (replacing with the on efrom
Netcdf)

writeGDAL(tget, fname=name_out,
drivername='PCRaster',type="Float32",mvFlag=-9999)   #export to .map files
}
/
This works well until d=509 (and outputs are perfectly fine) and then it
crashes, and I got the error message 

/Error in .local(.Object, ...) : Dataset copy failed
Calls: writeGDAL ... saveDataset -> new -> initialize -> initialize ->
.local -> .Call
/
The point is that if I start the loop at e.g. d=100, it crashes at 509+100.
So, it does not seem to be a problem of syntax.
So I suspect it may be a problem of memory (but I have enough disk space
left)?.maybe I should close the connection everytime but GDAL.close(tget)
does not work 

/Error in slot(dataset, "handle") : 
  no slot of name "handle" for this object of class "SpatialGridDataFrame"
/
The very weird thing is that it happens when I run it on the cluster. If
doing it locally (windows), I have no problem when d=509?

Do you have any idea?

Best,




--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/RGDAL-Error-with-writeGDAL-to-pcraster-maps-in-a-loop-tp7586213.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From mariomontecinos at gmail.com  Tue Apr 15 17:12:19 2014
From: mariomontecinos at gmail.com (Mario Montecinos Carvajal)
Date: Tue, 15 Apr 2014 12:12:19 -0300
Subject: [R-sig-Geo] Help to estimate Anisotropy Parameters
Message-ID: <CAJ-ph1kmDcbVg4Dnue66gee2Kej8-+HcGbXNqO1P2LGnyKkODQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140415/d0661a43/attachment.pl>

From zaholdenfs at gmail.com  Tue Apr 15 17:37:05 2014
From: zaholdenfs at gmail.com (Zack Holden)
Date: Tue, 15 Apr 2014 08:37:05 -0700
Subject: [R-sig-Geo] [RGDAL] Error with writeGDAL to pcraster maps (in a
	loop)
In-Reply-To: <1397556756418-7586213.post@n2.nabble.com>
References: <1397556756418-7586213.post@n2.nabble.com>
Message-ID: <CAGC_mZTxo3kBb9o8Ar7TRYFpBap7d3zYeRYw3zR+mEdc7S6d-w@mail.gmail.com>

Hi Phillipe,
I've had problems in the past reading many NetCDF files with having
too many open files. I don't know if this is related to the issue
you're seeing, but I'm attaching a link to to my solution for that
problem. You could have an upper limit set on your machine to the
number of files that can be opened.

http://r-sig-geo.2731867.n2.nabble.com/solved-raster-ncdf4-error-too-many-open-files-td7583723.html

Also, it might help others diagnose your problem if you tell us what
OS you are using and provide information about your R session.

I hope this helps,

Zack


On Tue, Apr 15, 2014 at 3:12 AM, Philippe R
<philippe.roudier at jrc.ec.europa.eu> wrote:
> Hello everyone
>
> My problem is the following : basically I need to pick up daily
> precipitation data from a netcdf file (50000 days) to create 50000 pcraster
> maps (one for each day).
> I am therefore doing a loop using RGDAL that looks like:
>
> /for (d in 1:50000){
>
> tget<-readGDAL("R:/mypath/target.map")   ##here I load my .map target file
>
> tget at data<-new_data[d]    #I change the data (replacing with the on efrom
> Netcdf)
>
> writeGDAL(tget, fname=name_out,
> drivername='PCRaster',type="Float32",mvFlag=-9999)   #export to .map files
> }
> /
> This works well until d=509 (and outputs are perfectly fine) and then it
> crashes, and I got the error message
>
> /Error in .local(.Object, ...) : Dataset copy failed
> Calls: writeGDAL ... saveDataset -> new -> initialize -> initialize ->
> .local -> .Call
> /
> The point is that if I start the loop at e.g. d=100, it crashes at 509+100.
> So, it does not seem to be a problem of syntax.
> So I suspect it may be a problem of memory (but I have enough disk space
> left)?.maybe I should close the connection everytime but GDAL.close(tget)
> does not work
>
> /Error in slot(dataset, "handle") :
>   no slot of name "handle" for this object of class "SpatialGridDataFrame"
> /
> The very weird thing is that it happens when I run it on the cluster. If
> doing it locally (windows), I have no problem when d=509?
>
> Do you have any idea?
>
> Best,
>
>
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/RGDAL-Error-with-writeGDAL-to-pcraster-maps-in-a-loop-tp7586213.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From mspinola10 at gmail.com  Wed Apr 16 15:25:52 2014
From: mspinola10 at gmail.com (=?UTF-8?Q?Manuel_Sp=C3=ADnola?=)
Date: Wed, 16 Apr 2014 07:25:52 -0600
Subject: [R-sig-Geo] rgdal for iOS mavericks build (R 3.1.0)
Message-ID: <CABkCotRoH6ixr_4B-eYUbu7A5ZMNkX6Wa2KL+CtASqeLWA5R9A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140416/a1d426dd/attachment.pl>

From jon.skoien at jrc.ec.europa.eu  Wed Apr 16 15:57:08 2014
From: jon.skoien at jrc.ec.europa.eu (Jon Olav Skoien)
Date: Wed, 16 Apr 2014 15:57:08 +0200
Subject: [R-sig-Geo] Help to estimate Anisotropy Parameters
In-Reply-To: <CAJ-ph1kmDcbVg4Dnue66gee2Kej8-+HcGbXNqO1P2LGnyKkODQ@mail.gmail.com>
References: <CAJ-ph1kmDcbVg4Dnue66gee2Kej8-+HcGbXNqO1P2LGnyKkODQ@mail.gmail.com>
Message-ID: <534E8C34.1010508@jrc.ec.europa.eu>

Mario,

The issue with the current version of intamap is that the anisotropy 
detection method is too slow and too memory consuming for larger data 
sets. The old version used a method based on the akima package, but this 
was discontinued because of incompatible licenses (akima is strictly 
non-commercial). If your use is non-commercial (you seem to email from a 
university), you might be able to use an old version of intamap, as the 
later changes to the package does not affect analyses. You might need 
Rtools or devtools to install the tar-file if you are on Windows, 
although I dont think it is necessary.

 > 
download.file("http://cran.r-project.org/src/contrib/Archive/intamap/intamap_1.3-23.tar.gz", 
"intamap_1.3-23.tar.gz")
 > install.packages("intamap_1.3-23.tar.gz", repos = NULL, type = "source")

There is a promising candidate for replacement, but we are still waiting 
for a bug fix in that package.

Best wishes,
Jon

On 15-Apr-14 17:12, Mario Montecinos Carvajal wrote:
> Dear fellow user of R
>
> I need a Little help
>
> I am trying to estimate Anisotropy parameters, from a large data set (13
> thousand data) that have Anistropy. All of these for correct the
> coordinates, allowing use of a directional Variogram for estimate the
> parameters that will be used for do a kriging.
>
> For  small data set of the same place, I use estimateAnistropy() function,
> from package intaMap, but the code of these function not allow working with
> large data set (function estimateAnisotropySc(), that is used for
> estimateAnistropy() function, have restriccion of size of data set) and
> moreover show of error of "Slope tensors estimation error. Override
> anisotropy estimation"
>
> Any help of suggestion will be very well received.
>
> Regards
>
>
>
>
>
>


-- 
Jon Olav Sk?ien
Joint Research Centre - European Commission
Institute for Environment and Sustainability (IES)
Land Resource Management Unit

Via Fermi 2749, TP 440,  I-21027 Ispra (VA), ITALY

jon.skoien at jrc.ec.europa.eu
Tel:  +39 0332 789205

Disclaimer: Views expressed in this email are those of the individual and do not necessarily represent official views of the European Commission.


From gab.cozzi at gmail.com  Wed Apr 16 16:20:01 2014
From: gab.cozzi at gmail.com (Gabriele Cozzi)
Date: Wed, 16 Apr 2014 16:20:01 +0200
Subject: [R-sig-Geo] nearest neighbour between locations in two data sets
Message-ID: <CADr8yXA2K31ggJ3i38Jj3WUdJuXHYAcA+GRZaebdufYd8aL6fA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140416/7e662ae0/attachment.pl>

From edzer.pebesma at uni-muenster.de  Wed Apr 16 16:20:45 2014
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 16 Apr 2014 16:20:45 +0200
Subject: [R-sig-Geo] spplot of SpatialGridDateFrame (sparsely populated
 with data) fails
In-Reply-To: <permail-201403271159349e949f53000074df-rolandh@message-id.uni-muenster.de>
References: <permail-201403271159349e949f53000074df-rolandh@message-id.uni-muenster.de>
Message-ID: <534E91BD.6020003@uni-muenster.de>

After some off-list communication, this pointed to several bugs in sp,
which have now been corrected (patch committed to r-forge).

On 03/27/2014 12:59 PM, rolandh at uni-muenster.de wrote:
> Hello R-users!
> 
> I want to plot SpatialGridDataFrames with spplot() and I get some strange /
> unexpected / irregular results in some special cases:
> 
> For testing and illustration issues I have created 4 SpatialGridDataFrames by
> aggregation from the same SpatialPointDataFrame (attribute)  (which is
> populated with a lot of NA values). When I check the data, I see that there is
> just one grid cell that is populated with data in the SpatialGridDataFrames.
> 
> If I try to plot these four SpatialGridDataFrames with spplot(), just one of
> the spplots finishes successfully.
> The others throw an error...
> 
> 
> Overview of the creation of the SpatialGridDataFrames and the errors /
> returns:
> 
> a) spGridDF_builtByMeanAsAggFct
> Packages used: raster, sp.
> I built a raster layer and aggregated the data by using the method rasterize()
> and the aggregation function "mean".
> Then I used as(... , "SpatialGridDataFrame"). When I try to plot with spplot()
> I get:
> Error in validObject(.Object) :
>   invalid class ?SpatialPoints? object: invalid object for slot "coords" in
>   class "SpatialPoints": got class "numeric", should be or extend class
>   "matrix"
> I get the same error when I use "median" or "sd" as aggregation function.
> 
> b) spGridDF_builtByMinAsAggFct
> Here I did the same as above (!) but I just used "min" (!) as aggregation
> function and spplot() finishes successfully! The plot contains one grid cell.
> That is fine and it is what I expected. I also get a plot when I use "max" as
> aggregation function.
> I do not understand the relationship of the selected aggregation function and
> the spplot result (error, success).
> 
> c) spGridDF_builtByPkgSP_minAsAggFct
> Packages used: sp
> After the creation of the grid I aggregated the data using the method
> aggregate() with "min" as aggregation function.
> When I try to plot with spplot() I get:
> Error in seq.default(zrng[1], zrng[2], length.out = cuts + 2) :
>   'from' cannot be NA, NaN or infinite
> Zus?tzlich: Warnmeldungen: (warnings)
> 1: In asMethod(object) :
>   complete map seems to be NA's -- no selection was made
> 2: In min(x) : kein nicht-fehlendes Argument f?r min; gebe Inf zur?ck
> 3: In max(x) : kein nicht-fehlendes Argument f?r max; gebe -Inf zur?ck
> 
> d) spGridDF_builtByPkgSP_withoutNA_minAsAggFct
> In this case I did the same as above [case c)], but I removed the NA values in
> the SpatialPointDataFrame with subset(spdf_wgs,
> complete.cases(spdf_wgs[[attribute]])) before I used the aggregate() method.
> When I try to plot with spplot() I get (again):
> Error in validObject(.Object) :
>   invalid class ?SpatialPoints? object: invalid object for slot "coords" in
>   class "SpatialPoints": got class "numeric", should be or extend class
>   "matrix"
> 
> 
> If you want to check the data, you may get an .RData file containing the 4
> SpatialGridDataFrames and the SpatialPointDataFrame on:
> https://github.com/LarsGH/Geosoftware2GroupC/tree/master/R/spplot_problem.RData
> 
> 
> What may be the problem causing spplot to fail?
> 
> And, even more important, how may I avoid that problem?
> 
> 
> I would be very happy if someone could please help me.
> 
> Thank you very much in advance!
> 
> Greetings!
> 
> Roland
> 
> 
> ###
>> sessionInfo()
> 
> R version 3.0.3 (2014-03-06)
> Platform: i686-pc-linux-gnu (32-bit)
> 
> locale:
>  [1] LC_CTYPE=de_DE.UTF-8       LC_NUMERIC=C               LC_TIME=de_DE.UTF-8
>  LC_COLLATE=de_DE.UTF-8
>  [5] LC_MONETARY=de_DE.UTF-8    LC_MESSAGES=de_DE.UTF-8
>  LC_PAPER=de_DE.UTF-8       LC_NAME=C
>  [9] LC_ADDRESS=C               LC_TELEPHONE=C
>  LC_MEASUREMENT=de_DE.UTF-8 LC_IDENTIFICATION=C
> 
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> 
> other attached packages:
>  [1] colorRamps_2.3      plyr_1.8            Cairo_1.5-5
>  latticeExtra_0.6-26 RColorBrewer_1.0-5
>  [6] ggmap_2.3           ggplot2_0.9.3.1     raster_2.2-12
>  lattice_0.20-27     RCurl_1.95-4.1
> [11] bitops_1.0-6        maptools_0.8-27     rgdal_0.8-14        sp_1.0-14
> futile.logger_1.3.7
> [16] rjson_0.2.13
> 
> loaded via a namespace (and not attached):
>  [1] colorspace_1.2-4     dichromat_2.0-0      digest_0.6.4
>  foreign_0.8-59       futile.options_1.0.0
>  [6] grid_3.0.3           gtable_0.1.2         labeling_0.2
>  lambda.r_1.1.6       mapproj_1.2-2
> [11] maps_2.3-6           MASS_7.3-30          munsell_0.4.2        png_0.1-7
> proto_0.3-10
> [16] reshape2_1.2.2       RgoogleMaps_1.2.0.5  RJSONIO_1.0-3
> scales_0.2.3         stringr_0.6.2
> [21] tools_3.0.3
> ###
> 
> ###
>> library(help=sp)
> 
>                 Information on package ?sp?
> 
> Description:
> 
> Package:            sp
> Version:            1.0-14
> Date:               2013-10-15
> Title:              classes and methods for spatial data
> Authors at R:          c(person("Edzer", "Pebesma", role = c("aut", "cre"), email
> =
>                     "edzer.pebesma at uni-muenster.de"), person("Roger",
>                     "Bivand", role = "aut", email =
>                     "Roger.Bivand at nhh.no"), person("Barry", "Rowlingson", role
>                     = "ctb"),
>                     person("Virgilio", "Gomez-Rubio", role = "ctb"))
> Depends:            R (>= 2.14.0)
> Imports:            methods, graphics, utils, lattice, grid
> Suggests:           RColorBrewer, rgdal (>= 0.8-7), rgeos (>= 0.2-20), gstat
> Description:        A package that provides classes and methods for spatial
> data. The classes
>                     document where the spatial location information resides,
>                     for 2D or 3D data.
>                     Utility functions are provided, e.g. for plotting data as
>                     maps, spatial
>                     selection, as well as methods for retrieving coordinates,
>                     for subsetting, print,
>                     summary, etc.
> License:            GPL (>= 2)
> URL:                https://r-forge.r-project.org/projects/rspatial/
>                     http://rspatial.r-forge.r-project.org/
> Collate:            AAA.R Class-CRS.R CRS-methods.R Class-Spatial.R
> Spatial-methods.R projected.R
>                     Class-SpatialPoints.R SpatialPoints-methods.R
>                     Class-SpatialPointsDataFrame.R
>                     SpatialPointsDataFrame-methods.R Class-GridTopology.R
>                     Class-SpatialGrid.R
>                     Class-SpatialGridDataFrame.R Class-SpatialLines.R
>                     SpatialLines-methods.R
>                     Class-SpatialLinesDataFrame.R
>                     SpatialLinesDataFrame-methods.R
>                     Class-SpatialPolygons.R Class-SpatialPolygonsDataFrame.R
>                     SpatialPolygons-methods.R
>                     SpatialPolygonsDataFrame-methods.R
>                     GridTopology-methods.R SpatialGrid-methods.R
>                     SpatialGridDataFrame-methods.R
>                     SpatialPolygons-internals.R point.in.polygon.R
>                     SpatialPolygons-displayMethods.R
>                     zerodist.R image.R stack.R bpy.colors.R bubble.R mapasp.R
>                     select.spatial.R
>                     gridded.R asciigrid.R spplot.R over.R overlay.R spsample.R
>                     recenter.R dms.R
>                     gridlines.R spdists.R rbind.R flipSGDF.R chfids.R
>                     loadmeuse.R compassRose.R
>                     surfaceArea.R spOptions.R subset.R disaggregate.R
>                     sp_spat1.R merge.R
> Packaged:           2013-10-23 11:03:37 UTC; edzer
> Author:             Edzer Pebesma [aut, cre], Roger Bivand [aut], Barry
> Rowlingson [ctb], Virgilio
>                     Gomez-Rubio [ctb]
> Maintainer:         Edzer Pebesma <edzer.pebesma at uni-muenster.de>
> NeedsCompilation:   yes
> Repository:         CRAN
> Date/Publication:   2013-10-24 09:38:03
> Built:              R 3.0.2; i686-pc-linux-gnu; 2013-12-11 13:36:45 UTC; unix
> ###
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795


From sasha.cuerda at gmail.com  Wed Apr 16 16:39:50 2014
From: sasha.cuerda at gmail.com (Sasha Cuerda)
Date: Wed, 16 Apr 2014 10:39:50 -0400
Subject: [R-sig-Geo] nearest neighbour between locations in two data sets
In-Reply-To: <CADr8yXA2K31ggJ3i38Jj3WUdJuXHYAcA+GRZaebdufYd8aL6fA@mail.gmail.com>
References: <CADr8yXA2K31ggJ3i38Jj3WUdJuXHYAcA+GRZaebdufYd8aL6fA@mail.gmail.com>
Message-ID: <CABVnpg4WoPPA7AfwLO6cvZ_pKg-seqm5g7mCh+FTF69tdn73_g@mail.gmail.com>

Gabriele,

Check out the nncross function within spatstat. Should be what you are
looking for.

Sasha

On Wed, Apr 16, 2014 at 10:20 AM, Gabriele Cozzi <gab.cozzi at gmail.com> wrote:
> Dear list,
>
> I have two data sets sets:
> - one with lon lat coordinates of relocation events from GPS radio collared
> animals and
> - one with lon lat coordinates of villages.
>
> For each animal relocation (n = 50'000 ), I want to compute the distance to
> the nearest village (n = 40). I am failing to find a function that allows
> this calculation between two data sets and only find functions that return
> the neared neighbour from within a single data set such as
>  nndist{spatstat}.
>
> Is there a function that returns the distance between each location in a
> data frame and the closes location from another data frame?
>
> Alternatively I was considering, in turn (through a loop) pasting each
> animal relocation into the villages data set, calculate the nearest
> neighbour and then paste the distance to the nearest village back to the
> original animal relocation data set, but this seems an incredibly
> non-efficient solution...
>
> Any suggestion will be highly appreciated!
>
> Thanks,
> Gabriele
>
>
> --
> Gabriele Cozzi
> Postdoctoral Research Associate
> Population Ecology Research Group
> http://www.popecol.org
>
> Zurich University
> Institute of Evolutionary Biology and Environmental Studies
> Winterthurerstr. 190
> 8057 Zurich - Switzerland
> E-mail: gabriele.cozzi at uzh.ch
> Phone: +41(0)44 635 49 12
> Fax: +41(0)16355711
> http://www.ieu.uzh.ch
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From gab.cozzi at gmail.com  Wed Apr 16 16:55:03 2014
From: gab.cozzi at gmail.com (Gabriele Cozzi)
Date: Wed, 16 Apr 2014 16:55:03 +0200
Subject: [R-sig-Geo] nearest neighbour between locations in two data sets
In-Reply-To: <CABVnpg4WoPPA7AfwLO6cvZ_pKg-seqm5g7mCh+FTF69tdn73_g@mail.gmail.com>
References: <CADr8yXA2K31ggJ3i38Jj3WUdJuXHYAcA+GRZaebdufYd8aL6fA@mail.gmail.com>
	<CABVnpg4WoPPA7AfwLO6cvZ_pKg-seqm5g7mCh+FTF69tdn73_g@mail.gmail.com>
Message-ID: <CADr8yXCO0ZWjGaTM7zWtAU9f8ig=iQ4iGbdnK7FUkeZXERT7yQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140416/f6e8e3c5/attachment.pl>

From gab.cozzi at gmail.com  Wed Apr 16 19:10:41 2014
From: gab.cozzi at gmail.com (Gabriele Cozzi)
Date: Wed, 16 Apr 2014 19:10:41 +0200
Subject: [R-sig-Geo] import iml with readOGR
Message-ID: <CADr8yXCZqyz8H3zREhve0wazcmytuJPfKUO7QRRnHRobTwG6OA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140416/3cea610e/attachment.pl>

From frtog at vestas.com  Wed Apr 16 19:21:21 2014
From: frtog at vestas.com (=?utf-8?B?RnJlZGUgQWFrbWFubiBUw7hnZXJzZW4=?=)
Date: Wed, 16 Apr 2014 19:21:21 +0200
Subject: [R-sig-Geo] import iml with readOGR
Message-ID: <hjbk8wp9mbg5e2tw29r2p34j.1397668877826@email.android.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140416/015ee844/attachment.pl>

From Roger.Bivand at nhh.no  Wed Apr 16 19:23:09 2014
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 16 Apr 2014 19:23:09 +0200
Subject: [R-sig-Geo] rgdal for iOS mavericks build (R 3.1.0)
In-Reply-To: <CABkCotRoH6ixr_4B-eYUbu7A5ZMNkX6Wa2KL+CtASqeLWA5R9A@mail.gmail.com>
References: <CABkCotRoH6ixr_4B-eYUbu7A5ZMNkX6Wa2KL+CtASqeLWA5R9A@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1404161913120.18290@reclus.nhh.no>

On Wed, 16 Apr 2014, Manuel Sp?nola wrote:

> Dear list members,
>
> I am using R 3.1.0 mavericks build but I noticed that rgdal is not
> available yet.  Any idea when will be available?

Thanks for the heads-up - this is not something the rgdal maintainer or 
developers can answer (also I have no OSX access of any kind, let alone 
Mavericks). Please ask on R-sig-mac to establish the current situation - 
it may be that the new Apple build trains are creating problems for GDAL 
and PROJ, and if they cannot be built easily, the rgdal binaries will also 
not be forthcoming until this is dealt with. Please report back on replies 
on R-sig-mac.

If you can install rgdal from source, look at:

http://www.kyngchaos.com/software/frameworks

for suitable frameworks for GDAL/PROJ (and GEOS if you need rgeos). There 
are discussions related to Mavericks on Kyngchaos.

Hope this helps,

Best wishes,

Roger

>
> Best,
>
> Manuel
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no

From mspinola10 at gmail.com  Wed Apr 16 19:26:33 2014
From: mspinola10 at gmail.com (=?UTF-8?Q?Manuel_Sp=C3=ADnola?=)
Date: Wed, 16 Apr 2014 11:26:33 -0600
Subject: [R-sig-Geo] rgdal for iOS mavericks build (R 3.1.0)
In-Reply-To: <alpine.LRH.2.03.1404161913120.18290@reclus.nhh.no>
References: <CABkCotRoH6ixr_4B-eYUbu7A5ZMNkX6Wa2KL+CtASqeLWA5R9A@mail.gmail.com>
	<alpine.LRH.2.03.1404161913120.18290@reclus.nhh.no>
Message-ID: <CABkCotQJgUW2mAKrVY5VuCsgsoEnCXGoKky98Nk3e7QcOF_4Lw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140416/3d09ddab/attachment.pl>

From fvbersse at gmail.com  Wed Apr 16 19:58:03 2014
From: fvbersse at gmail.com (Ferdinand Bersse)
Date: Wed, 16 Apr 2014 13:58:03 -0400
Subject: [R-sig-Geo] Multilevel spatial regression models,
 with spatial structure at the first level only
Message-ID: <CA+nXtYZZRm8ho39ieSjVswVPLGQmXwSVk5AEwcK292xOiWeuYg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140416/c78aa1a5/attachment.pl>

From gab.cozzi at gmail.com  Wed Apr 16 20:51:26 2014
From: gab.cozzi at gmail.com (Gabriele Cozzi)
Date: Wed, 16 Apr 2014 20:51:26 +0200
Subject: [R-sig-Geo] import kml with readOGR
Message-ID: <CADr8yXBse1P2TDaduEKF+-Gbd-OmHpD8xs505zp1z7cX-_zKLw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140416/18574297/attachment.pl>

From Roger.Bivand at nhh.no  Wed Apr 16 20:57:06 2014
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 16 Apr 2014 20:57:06 +0200
Subject: [R-sig-Geo] import kml with readOGR
In-Reply-To: <CADr8yXBse1P2TDaduEKF+-Gbd-OmHpD8xs505zp1z7cX-_zKLw@mail.gmail.com>
References: <CADr8yXBse1P2TDaduEKF+-Gbd-OmHpD8xs505zp1z7cX-_zKLw@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1404162053560.18290@reclus.nhh.no>

On Wed, 16 Apr 2014, Gabriele Cozzi wrote:

> Hi,
>
> my understanding is that the second argument correspond to the kml layer
> name, which is not necessarily the file name. However it is in my case, I
> suppose (think).
>
>> From opening my file with a text editor I get:
> <Document><name>Sarikamis.kml</name>

Try first OGRListLayers(dsn=) to list the layer(s) actually seen by the 
software. Also use setwd() first to give the file name, if you are unsure 
of its name. Once OGRListLayers() runs correctly, you will have 
confirmation of the dsn=, and a listing of recognised layer= value(s).

Hope this clarifies,

Roger

>
> The two arguments should correspond to the arguments:
> dsn= data source name
> layer= layer name
>
>
> Gabriele
>
>
>
> On Wed, Apr 16, 2014 at 7:21 PM, Frede Aakmann T??gersen <frtog at vestas.com>wrote:
>
>>  Hi
>>
>> I'm not close to my R right now. Can you explain to me what you think your
>> second argument to readORG does?
>>
>> Br. Frede
>>
>>
>> Sendt fra Samsung mobil
>>
>>
>> -------- Oprindelig meddelelse --------
>> Fra: Gabriele Cozzi
>> Dato:16/04/2014 19.11 (GMT+01:00)
>> Til: r-sig-geo
>> Emne: [R-sig-Geo] import iml with readOGR
>>
>> Dear all,
>>
>> I am trying to import a kml (polygon) into R following the suggestions
>> from:
>>
>> http://gis.stackexchange.com/questions/58131/how-to-efficiently-read-a-kml-file-into-r
>>
>> and
>> https://stat.ethz.ch/pipermail/r-sig-geo/2010-May/008355.html
>>
>>
>> the code I run is the following:
>>
>> S <- readOGR(???~/Documents/Sarikamis.kml", "Sarikamis???)
>> and I also tried:
>> S <- readOGR(???~/Documents/Sarikamis.kml", ???Sarikamis.kml???)
>>
>> but I get the usual error:
>> Error in ogrInfo(dsn = dsn, layer = layer, encoding = encoding, use_iconv =
>> use_iconv) :
>>   Cannot open file
>>
>>
>> When I open the kml file using a text editor it reads as below (in blue),
>> which makes me think that the kml file name is ???Sarikamis??? and the string
>> is ???Document/Sarikamis.kml???. But obviously I am doing something wrong, but
>> I can???t understand what.
>>
>> <?xml version="1.0" encoding="UTF-8"?>
>> <kml xmlns="http://www.opengis.net/kml/2.2" xmlns:gx="
>> http://www.google.com/kml/ext/2.2" xmlns:kml="
>> http://www.opengis.net/kml/2.2"
>> xmlns:atom="http://www.w3.org/2005/Atom">
>> <Document>
>> <name>Sarikamis.kml</name>
>> <StyleMap id="msn_ylw-pushpin">
>> <Pair>
>> <key>normal</key>
>> <styleUrl>#sn_ylw-pushpin</styleUrl>
>> </Pair>
>> <Pair>
>> <key>highlight</key>
>> <styleUrl>#sh_ylw-pushpin</styleUrl>
>>                        ......
>>                         ......
>>
>>
>> Any advice is highly appreciated!
>>
>> I am running R 3.0.3 for Mac
>>
>>
>> Best,
>> Gabriele
>>
>>
>> --
>> Gabriele Cozzi
>> Postdoctoral Research Associate
>> Population Ecology Research Group
>> http://www.popecol.org
>>
>> Zurich University
>> Institute of Evolutionary Biology and Environmental Studies
>> Winterthurerstr. 190
>> 8057 Zurich - Switzerland
>> E-mail: gabriele.cozzi at uzh.ch
>> Phone: +41(0)44 635 49 12
>> Fax: +41(0)16355711
>> http://www.ieu.uzh.ch
>>
>>         [[alternative HTML version deleted]]
>>
>>
>
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From gab.cozzi at gmail.com  Wed Apr 16 22:13:03 2014
From: gab.cozzi at gmail.com (Gabriele Cozzi)
Date: Wed, 16 Apr 2014 22:13:03 +0200
Subject: [R-sig-Geo] import kml with readOGR
In-Reply-To: <alpine.LRH.2.03.1404162053560.18290@reclus.nhh.no>
References: <CADr8yXBse1P2TDaduEKF+-Gbd-OmHpD8xs505zp1z7cX-_zKLw@mail.gmail.com>
	<alpine.LRH.2.03.1404162053560.18290@reclus.nhh.no>
Message-ID: <CADr8yXDa-6vA5UYPVqXmvW+Bcc8ZRwRvo0s6veY3XFm6UArz+g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140416/bbeaec59/attachment.pl>

From gab.cozzi at gmail.com  Wed Apr 16 22:23:58 2014
From: gab.cozzi at gmail.com (Gabriele Cozzi)
Date: Wed, 16 Apr 2014 22:23:58 +0200
Subject: [R-sig-Geo] import kml with readOGR
In-Reply-To: <CADr8yXDa-6vA5UYPVqXmvW+Bcc8ZRwRvo0s6veY3XFm6UArz+g@mail.gmail.com>
References: <CADr8yXBse1P2TDaduEKF+-Gbd-OmHpD8xs505zp1z7cX-_zKLw@mail.gmail.com>
	<alpine.LRH.2.03.1404162053560.18290@reclus.nhh.no>
	<CADr8yXDa-6vA5UYPVqXmvW+Bcc8ZRwRvo0s6veY3XFm6UArz+g@mail.gmail.com>
Message-ID: <CADr8yXDqE_1hT9JaPjKMQ9=nnpPdoRNVPMjMhgO64SDHPVeZiA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140416/834838e0/attachment.pl>

From bakare at ualberta.ca  Thu Apr 17 02:08:12 2014
From: bakare at ualberta.ca (Moshood Agba Bakare)
Date: Wed, 16 Apr 2014 18:08:12 -0600
Subject: [R-sig-Geo] gstat Statistical measures of goodness fit of variogram
	model
Message-ID: <CAJRR3XPAMEJZA-hOWFTU86WdD8tGV4wFfz9FPED8yd=O7c0hzg@mail.gmail.com>

Dear All,
The statistical measures of goodness of fit of variogram model to
experimental variogram is often determined by Sums of squares error (SSErr)
function of gstat library.Am I right to define this statistic to be
summation of the product of weighting factor and squared of difference
between experimental and model semivariance for the number of lag bins?

Please see the attached word document for the equation. Let me know if I am
wrong please.

Moshood
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140416/ce36003e/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Statistical measure of goodness fit of variogram model.docx
Type: application/vnd.openxmlformats-officedocument.wordprocessingml.document
Size: 14166 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140416/ce36003e/attachment.bin>

From andrew.bernj at gmail.com  Thu Apr 17 06:33:54 2014
From: andrew.bernj at gmail.com (Andrew Bernj)
Date: Thu, 17 Apr 2014 00:33:54 -0400
Subject: [R-sig-Geo] Counting overlapping polygons in a given area
Message-ID: <CAJQosKe3fSFrqdibgw_XCu3SJoawtXgoADi9-M3trmw+UBrjFg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140417/38a755f8/attachment.pl>

From Roger.Bivand at nhh.no  Thu Apr 17 11:19:05 2014
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 17 Apr 2014 11:19:05 +0200
Subject: [R-sig-Geo] Counting overlapping polygons in a given area
In-Reply-To: <CAJQosKe3fSFrqdibgw_XCu3SJoawtXgoADi9-M3trmw+UBrjFg@mail.gmail.com>
References: <CAJQosKe3fSFrqdibgw_XCu3SJoawtXgoADi9-M3trmw+UBrjFg@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1404171044410.20765@reclus.nhh.no>

On Thu, 17 Apr 2014, Andrew Bernj wrote:

> Hi,
>
> I am used to work with ArcGIS but I am new to R spatial functionalities.
> So, I have been searching in the archives of this list, but did not find a
> previous question exaclty on what I have to accomplish.

On lists in this community, it is usual to follow the instructions, in 
particular to provide a toy example illustrating your problem. If you 
don't, nobody knows whether the suggested resolution matches your problem. 
You also posted HTML-mail; please use plain text only, so that included 
code may be pasted straight into an R console.

>
> It is the following. I have two shapefiles, one with US city and town
> divisions, where each polygon is a city/town (UScities.shp) and another
> with some US religious groups, where polygons represent the area where
> there are significant followers of a given religion (USrelig.shp).
>
> So, in UScities.shp of course the polygons do not overlap. While in
> USrelig.shp polygons do overlap, since followers from different religions
> can be present in the same place.

library(sp)
library(rgdal)
dsn <- system.file("vectors", package = "rgdal")[1]
scot_BNG <- readOGR(dsn=dsn, layer="scot_BNG")
plot(scot_BNG, axes=TRUE)

gives something like UScities.shp.

set.seed(1)
pts <- spsample(scot_BNG, n=200, type="random")
plot(pts, add=TRUE, col="red")
library(rgeos)
polys <- gBuffer(pts, width=50000, byid=TRUE)
plot(polys, add=TRUE, border="red")

gives something like USrelig.shp.

library(rgeos)
gO <- gOverlaps(scot_BNG, polys, byid=c(TRUE, TRUE))
dim(gO)

makes a logical matrix with TRUE where scot_BNG[i,] overlaps with 
polys[j].

count_by_city <- apply(gO, 2, sum)

The output vector is named using row.names(scot_BNG), so if you need 
recognizable names in the output, change the input row.names to something 
informative.

This is OK if the number of cities times the number of religions is 
moderate. If the product is large, try the development version of rgeos 
from:

https://r-forge.r-project.org/R/?group_id=602

and use:

gO <- gOverlaps(scot_BNG, polys, byid=c(TRUE, TRUE), returnDense=FALSE)
length(gO)
count_by_city1 <- sapply(gO, length)

and in this case we see that they are equivalent:

all.equal(count_by_city, count_by_city1)

Hope this helps,

Roger

>
> What I want do is to count how many religious groups according to
> USrelig.shp there are in each city present in UScities.shp. It means, to
> count how many polygons overlap in USrelig.shp for each polygon division
> given by UScities.shp.
>
>
> Is there a way to do that in R? Thanks in advance for any tip you may have
> on this task.
>
> Bernj
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From senator at ecotoxicology.de  Thu Apr 17 12:14:00 2014
From: senator at ecotoxicology.de (=?iso-8859-1?Q?Ralf_Sch=E4fer?=)
Date: Thu, 17 Apr 2014 12:14:00 +0200
Subject: [R-sig-Geo] R-sig-Geo Digest, Vol 128, Issue 17
In-Reply-To: <mailman.11.1397728803.15374.r-sig-geo@r-project.org>
References: <mailman.11.1397728803.15374.r-sig-geo@r-project.org>
Message-ID: <9BCFA5AF-986D-4064-9A1B-4036F3797D62@ecotoxicology.de>


> 
> Message: 9
> Date: Wed, 16 Apr 2014 19:23:09 +0200
> From: Roger Bivand <Roger.Bivand at nhh.no>
> To: Manuel Sp?nola <mspinola10 at gmail.com>
> Cc: "r-sig-geo at r-project.org" <r-sig-geo at r-project.org>
> Subject: Re: [R-sig-Geo] rgdal for iOS mavericks build (R 3.1.0)
> Message-ID: <alpine.LRH.2.03.1404161913120.18290 at reclus.nhh.no>
> Content-Type: text/plain; charset="iso-8859-15"; Format="flowed"
> 
> On Wed, 16 Apr 2014, Manuel Sp?nola wrote:
> 
>> Dear list members,
>> 
>> I am using R 3.1.0 mavericks build but I noticed that rgdal is not
>> available yet.  Any idea when will be available?
> 
> Thanks for the heads-up - this is not something the rgdal maintainer or 
> developers can answer (also I have no OSX access of any kind, let alone 
> Mavericks). Please ask on R-sig-mac to establish the current situation - 
> it may be that the new Apple build trains are creating problems for GDAL 
> and PROJ, and if they cannot be built easily, the rgdal binaries will also 
> not be forthcoming until this is dealt with. Please report back on replies 
> on R-sig-mac.
> 
> If you can install rgdal from source, look at:
> 
> http://www.kyngchaos.com/software/frameworks
> 
> for suitable frameworks for GDAL/PROJ (and GEOS if you need rgeos). There 
> are discussions related to Mavericks on Kyngchaos.
> 

The problems seem to have to do with the new built for Maverick.

However, you can download the package here:
http://cran.r-project.org/bin/macosx/contrib/3.1/
And install manually (local package with source code)

This works also for gstat, rgeos, spacetime and so on.

I found this solution here:
https://groups.google.com/forum/#!msg/r-sig-mac/3yrqRaMrSPQ/ERkzSsoYe-cJ

Best regards
Ralf


From aguitatierra at hotmail.com  Thu Apr 17 13:09:10 2014
From: aguitatierra at hotmail.com (Bea GD)
Date: Thu, 17 Apr 2014 13:09:10 +0200
Subject: [R-sig-Geo] Overlay  Spatial Points Data Frame over Raster Layer
Message-ID: <BLU0-SMTP204ED7E63AFD7D28B50D998D9520@phx.gbl>

Dear list,

I'd like to overlay points and associated attributes on a raster layer. 
Therefore, I'd like the points to give me more information than just its 
coordinates.

I show you with an example:

# 1.  Load data
# Points data: 'meuse.points' "SpatialPointsDataFrame"
data(meuse)
coordinates(meuse) <- ~x+y
meuse.points <- meuse

# Raster data: 'meuse.raster'
data(meuse.grid)
gridded(meuse.grid) <- ~x+y # SpatialPixelDataFrame
# Coerce to raster
meuse.raster <- raster(meuse.grid) # "RasterLayer"


# 2. Plotting
# Plot points with attributes
spplot(meuse.points, "soil", key.space = "bottom")

# Plot(meuse.raster)
plot(meuse.raster)

# Somehow, I'd like is to join these two plots above. I've been looking 
for information and trying different possibilities but none seems to 
work. Does anyone know what I'm not doing correctly?
# Plot points overlaying raster. It doesn't work!
plot(meuse.raster,
      addfun=(spplot(meuse.points, "soil", key.space="bottom")), add=T)

Many thanks in advance!


From edzer.pebesma at uni-muenster.de  Thu Apr 17 14:20:05 2014
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 17 Apr 2014 14:20:05 +0200
Subject: [R-sig-Geo] Overlay Spatial Points Data Frame over Raster Layer
In-Reply-To: <BLU0-SMTP204ED7E63AFD7D28B50D998D9520@phx.gbl>
References: <BLU0-SMTP204ED7E63AFD7D28B50D998D9520@phx.gbl>
Message-ID: <534FC6F5.6010907@uni-muenster.de>



On 04/17/2014 01:09 PM, Bea GD wrote:
> Dear list,
> 
> I'd like to overlay points and associated attributes on a raster layer.
> Therefore, I'd like the points to give me more information than just its
> coordinates.
> 
> I show you with an example:
> 
> # 1.  Load data
> # Points data: 'meuse.points' "SpatialPointsDataFrame"
> data(meuse)
> coordinates(meuse) <- ~x+y
> meuse.points <- meuse
> 
> # Raster data: 'meuse.raster'
> data(meuse.grid)
> gridded(meuse.grid) <- ~x+y # SpatialPixelDataFrame
> # Coerce to raster
> meuse.raster <- raster(meuse.grid) # "RasterLayer"
> 
> 
> # 2. Plotting
> # Plot points with attributes
> spplot(meuse.points, "soil", key.space = "bottom")
> 
> # Plot(meuse.raster)
> plot(meuse.raster)
> 
> # Somehow, I'd like is to join these two plots above. I've been looking
> for information and trying different possibilities but none seems to
> work. Does anyone know what I'm not doing correctly?
> # Plot points overlaying raster. It doesn't work!
> plot(meuse.raster,
>      addfun=(spplot(meuse.points, "soil", key.space="bottom")), add=T)

after
plot(meuse.raster)
,
points(meuse, col= meuse$soil, pch=16)

will give you coloured points on top of the raster, but not the legend.
spplot and plot use lattice and base plot, respectively, which are
incompatible. You can try to use legend() to add another legend to the
base plot created this way.


> 
> Many thanks in advance!
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140417/b022d3c5/attachment.bin>

From philippe.roudier at jrc.ec.europa.eu  Thu Apr 17 15:39:27 2014
From: philippe.roudier at jrc.ec.europa.eu (Philippe R)
Date: Thu, 17 Apr 2014 06:39:27 -0700 (PDT)
Subject: [R-sig-Geo] [RGDAL] Error with writeGDAL to pcraster maps (in a
	loop)
In-Reply-To: <CAGC_mZTxo3kBb9o8Ar7TRYFpBap7d3zYeRYw3zR+mEdc7S6d-w@mail.gmail.com>
References: <1397556756418-7586213.post@n2.nabble.com>
	<CAGC_mZTxo3kBb9o8Ar7TRYFpBap7d3zYeRYw3zR+mEdc7S6d-w@mail.gmail.com>
Message-ID: <1397741967800-7586237.post@n2.nabble.com>

Considering what i have read on several forums, it may come from a problem in
the GDAL.close function in a previous version of rgdal package ( I am using
rgdal 0.8-11). So updating the package would normally solve the problem...



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/RGDAL-Error-with-writeGDAL-to-pcraster-maps-in-a-loop-tp7586213p7586237.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From ROONEYJ4 at tcd.ie  Thu Apr 17 17:03:54 2014
From: ROONEYJ4 at tcd.ie (James Rooney)
Date: Thu, 17 Apr 2014 16:03:54 +0100
Subject: [R-sig-Geo] areal data with point covariates
Message-ID: <75C8D19A1470D344A8AF5312F01160A602BBB78CFE81@GOMAIL.college.tcd.ie>

Dear List,

This is not strictly an R question so I hope it is allowed. I am a little unsure of what type of analysis I need to use next so hoping someone can point me in the right direction.

I have point data representing cases of disease. I also have population data attached to polygons. I have used this to calculate areal standardised incidence rates and applied the BYM model via Bayesian methods to draw a smoothed relative risks map.
Now I would like to check for correlation between this risk and spatial data from other sources - e.g. soil mineral measurements etc. Note that the cases and soil measurements are not colocated.
What should be my next step ? Do I need to krig the soil data and get mean values per polygon ? Or should I be taking an entirely different approach here ?
Again apologies if this is off-topic.

Many thanks,
James

From paul.ziyu.ma at gmail.com  Fri Apr 18 13:49:09 2014
From: paul.ziyu.ma at gmail.com (Ziyu Ma)
Date: Fri, 18 Apr 2014 13:49:09 +0200
Subject: [R-sig-Geo] raster plotting problem
Message-ID: <CAK3B57iUGuFFUCwnRWBV9npz816btF_W8ztc=47e9eGYr++z8Q@mail.gmail.com>

Dear R-sig-geo,

I was having a problem of not being able to plot a raster, simply by:

 plot(raster("somefilename"))

but the plot is blank (like the attached file). There was no error message,
and apparently the plot function was reading the raster data because the
scale was plotted.

I tried to plot several different data sets, even one raster generated from
a matrix of all random numbers. They all turned out to be blank.

This is not my first time encountering this "blank raster plot" problem.
I've seen this on other cases while working as a TA. It appeared on few
computers while using completely the same data and codes as the others in
the class.

I encountered this problem myself today while trying to remotely work on
the lab's GIS server. The server was running on Windows 7 with an older
version of R. I updated to R 3.1.0 and updated all packages, but the
problem persists.

Have anyone encountered this before? What could be wrong in my case here?

Thank you very much.
Happy Easter holidays.

Ziyu Ma
PhD Student
Ecoinformatics & Biodiversity,
Department of Bioscience, Aarhus University
Ny Munkegade 114, DK-8000 Aarhus C, Denmark
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140418/ea47f22c/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Errorplot.png
Type: image/png
Size: 2223 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140418/ea47f22c/attachment.png>

From mspinola10 at gmail.com  Sat Apr 19 02:39:28 2014
From: mspinola10 at gmail.com (=?UTF-8?Q?Manuel_Sp=C3=ADnola?=)
Date: Fri, 18 Apr 2014 18:39:28 -0600
Subject: [R-sig-Geo] R-sig-Geo Digest, Vol 128, Issue 17
In-Reply-To: <9BCFA5AF-986D-4064-9A1B-4036F3797D62@ecotoxicology.de>
References: <mailman.11.1397728803.15374.r-sig-geo@r-project.org>
	<9BCFA5AF-986D-4064-9A1B-4036F3797D62@ecotoxicology.de>
Message-ID: <CABkCotRZ9pW8VOxatki7m+P_Cq4OsK9yrc6X4tEEkb8wRDOEfA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140418/3842a7df/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Sat Apr 19 10:59:40 2014
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Sat, 19 Apr 2014 09:59:40 +0100
Subject: [R-sig-Geo] raster plotting problem
In-Reply-To: <9afcc5fa1c6443afae79c7d87c439668@EX-0-HT0.lancs.local>
References: <9afcc5fa1c6443afae79c7d87c439668@EX-0-HT0.lancs.local>
Message-ID: <CANVKczOfpuD01aq6PCdxPwh0CV7qaF9uf6A0pvfpQs=_Xb=YWA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140419/d5e66974/attachment.pl>

From waterdogdan at gmail.com  Sun Apr 20 07:56:21 2014
From: waterdogdan at gmail.com (Dan Olsen)
Date: Sat, 19 Apr 2014 21:56:21 -0800
Subject: [R-sig-Geo] BRB AdehabitatLT help
Message-ID: <CAFO+YkJcbzvwE=kQegbg7iiR7AHjd6Z_0uH2EH5yM=ZxBE=Lxg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140419/c8d56027/attachment.pl>

From imirum_amir at hotmail.com  Sun Apr 20 14:24:51 2014
From: imirum_amir at hotmail.com (irum Amir)
Date: Sun, 20 Apr 2014 12:24:51 +0000
Subject: [R-sig-Geo] FW: [R-sig-Epi] problem with nb2listw( ) command
In-Reply-To: <COL131-W817FA69F1AE575D0540374805F0@phx.gbl>
References: <COL131-W817FA69F1AE575D0540374805F0@phx.gbl>
Message-ID: <COL131-W6118C38D88B5B030A6C9F3805F0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140420/9689fc26/attachment.pl>

From andrew.bernj at gmail.com  Sun Apr 20 23:30:53 2014
From: andrew.bernj at gmail.com (Andrew Bernj)
Date: Sun, 20 Apr 2014 17:30:53 -0400
Subject: [R-sig-Geo] Counting overlapping polygons in a given area
In-Reply-To: <alpine.LRH.2.03.1404171044410.20765@reclus.nhh.no>
References: <CAJQosKe3fSFrqdibgw_XCu3SJoawtXgoADi9-M3trmw+UBrjFg@mail.gmail.com>
	<alpine.LRH.2.03.1404171044410.20765@reclus.nhh.no>
Message-ID: <CAJQosKf5PKzL41bFx7xgp2ZF6z1-zMw7Tbao36tYru2KrPg-CA@mail.gmail.com>

Dear Roger,

Thank you very much for this example. It was exactly what I needed to
get started on this issue. Especially the final part, using the
development version of rgeos. I have been trying some different things
before and I suspect one of the problems had to do with the fact that
I have just too many cities*religions. It helped a lot with other
problems I had to solve.

Also, I do apologize for not sending my previous code or a toy
exmaple. I will remember that in the future.

Best,

Andrew



2014-04-17 5:19 GMT-04:00 Roger Bivand <Roger.Bivand at nhh.no>:
> On Thu, 17 Apr 2014, Andrew Bernj wrote:
>
>> Hi,
>>
>> I am used to work with ArcGIS but I am new to R spatial functionalities.
>> So, I have been searching in the archives of this list, but did not find a
>> previous question exaclty on what I have to accomplish.
>
>
> On lists in this community, it is usual to follow the instructions, in
> particular to provide a toy example illustrating your problem. If you don't,
> nobody knows whether the suggested resolution matches your problem. You also
> posted HTML-mail; please use plain text only, so that included code may be
> pasted straight into an R console.
>
>
>>
>> It is the following. I have two shapefiles, one with US city and town
>> divisions, where each polygon is a city/town (UScities.shp) and another
>> with some US religious groups, where polygons represent the area where
>> there are significant followers of a given religion (USrelig.shp).
>>
>> So, in UScities.shp of course the polygons do not overlap. While in
>> USrelig.shp polygons do overlap, since followers from different religions
>> can be present in the same place.
>
>
> library(sp)
> library(rgdal)
> dsn <- system.file("vectors", package = "rgdal")[1]
> scot_BNG <- readOGR(dsn=dsn, layer="scot_BNG")
> plot(scot_BNG, axes=TRUE)
>
> gives something like UScities.shp.
>
> set.seed(1)
> pts <- spsample(scot_BNG, n=200, type="random")
> plot(pts, add=TRUE, col="red")
> library(rgeos)
> polys <- gBuffer(pts, width=50000, byid=TRUE)
> plot(polys, add=TRUE, border="red")
>
> gives something like USrelig.shp.
>
> library(rgeos)
> gO <- gOverlaps(scot_BNG, polys, byid=c(TRUE, TRUE))
> dim(gO)
>
> makes a logical matrix with TRUE where scot_BNG[i,] overlaps with polys[j].
>
> count_by_city <- apply(gO, 2, sum)
>
> The output vector is named using row.names(scot_BNG), so if you need
> recognizable names in the output, change the input row.names to something
> informative.
>
> This is OK if the number of cities times the number of religions is
> moderate. If the product is large, try the development version of rgeos
> from:
>
> https://r-forge.r-project.org/R/?group_id=602
>
> and use:
>
> gO <- gOverlaps(scot_BNG, polys, byid=c(TRUE, TRUE), returnDense=FALSE)
> length(gO)
> count_by_city1 <- sapply(gO, length)
>
> and in this case we see that they are equivalent:
>
> all.equal(count_by_city, count_by_city1)
>
> Hope this helps,
>
> Roger
>
>>
>> What I want do is to count how many religious groups according to
>> USrelig.shp there are in each city present in UScities.shp. It means, to
>> count how many polygons overlap in USrelig.shp for each polygon division
>> given by UScities.shp.
>>
>>
>> Is there a way to do that in R? Thanks in advance for any tip you may have
>> on this task.
>>
>> Bernj
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 91 00
> e-mail: Roger.Bivand at nhh.no
>


From HodgessE at uhd.edu  Mon Apr 21 17:05:15 2014
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Mon, 21 Apr 2014 15:05:15 +0000
Subject: [R-sig-Geo] time units with plotKML
Message-ID: <FF9DB805FC41CC4E95825A50F680630217B6F6D3@columbia.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140421/a82ec028/attachment.pl>

From matschi4 at gmx.de  Tue Apr 22 18:09:43 2014
From: matschi4 at gmx.de (M.E.)
Date: Tue, 22 Apr 2014 09:09:43 -0700 (PDT)
Subject: [R-sig-Geo] Package "genalg". Function "rbga.bin"
Message-ID: <1398182983718-7586247.post@n2.nabble.com>

I am using the "genalg" Package (Function rgba.bin)
(http://cran.r-project.org/web/packages/genalg/genalg.pdf) for some
calculations in R. For me it isn't very clear, how to set the
"zeroToOneRatio" for the "rbga.bin" function. Does anybody has some
suggestions for me? 
Many Thanks in advance!!



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Package-genalg-Function-rbga-bin-tp7586247.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From geponce at gmail.com  Tue Apr 22 20:09:33 2014
From: geponce at gmail.com (Guillermo E. Ponce-Campos)
Date: Tue, 22 Apr 2014 11:09:33 -0700
Subject: [R-sig-Geo] writeRaster issue
Message-ID: <CAGKzJ7qzgCZQLj1HLRFH0A6_UOFYj1ToCmfyTdZ6VyxPxu3FQA@mail.gmail.com>

Hi:

Is there any known issue on using writeRaster under Windows vs Linux?

I have been trying to write a rasterlayer as a geotif in a Linux
(centos) machine with no success...

I have this raster layer:

> varTmpRaster
class       : RasterLayer
dimensions  : 720, 1440, 1036800  (nrow, ncol, ncell)
resolution  : 0.25, 0.25  (x, y)
extent      : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)
coord. ref. : +init=epsg:4326 +proj=longlat +ellps=WGS84 +datum=WGS84
+no_defs +towgs84=0,0,0
data source : in memory
names       : layer
values      : 0, 0.9132664  (min, max)

>plot(varTmpRaster)
It shows everything right...

When I run the writeRaster the resulting file only have NA's:

>tf <- writeRaster(varTmpRaster, "testGeoTif", format="GTiff", overwrite=TRUE)
>plot(tf)
Just blank plot...

>length(tf)
[1]1036800
>length(tf[is.na[tf])
[1] 1036800


If I run the exact same instructions on R for Windows7 and everything
goes fine, both plots, the one from varTmpRaster and the tf show
exactly the same map...

Here are the characteristics from both machines...

Linux-Centos:
---------------
R version 3.0.2 (2013-09-25) -- "Frisbee Sailing"
rgdal: version: 0.8-16, (SVN revision 498)
Geospatial Data Abstraction Library extensions to R successfully loaded
Loaded GDAL runtime: GDAL 1.10.1, released 2013/08/26
Path to GDAL shared files: /usr/local/share/gdal
Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
Path to PROJ.4 shared files: /opt/source/proj-4.8.0/nad

Windows 7:
----------------
R version 3.0.1 (2013-05-16) -- "Good Sport"
Loading required package: sp
rgdal: version: 0.8-11, (SVN revision 479M)
Geospatial Data Abstraction Library extensions to R successfully loaded
Loaded GDAL runtime: GDAL 1.9.2, released 2012/10/08
Path to GDAL shared files: C:/Program Files/R/R-3.0.1/library/rgdal/gdal
GDAL does not use iconv for recoding strings.
Loaded PROJ.4 runtime: Rel. 4.7.1, 23 September 2009, [PJ_VERSION: 470]
Path to PROJ.4 shared files: C:/Program Files/R/R-3.0.1/library/rgdal/proj

Does anyone has seen a thread commenting on an issue like this before ?

I have tried the NAvalue() and also using the datatype FLT8S and FLT4S
as part of the parameters of the writeRaster but no luck.


Thanks,
Guillermo


From cmohamma at gmail.com  Tue Apr 22 22:32:02 2014
From: cmohamma at gmail.com (Cyrus Mohammadian)
Date: Tue, 22 Apr 2014 13:32:02 -0700
Subject: [R-sig-Geo] errors with stConstruct() and STFDF()
Message-ID: <AE026B53-2DD0-4C2C-A734-DB243FA2E228@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140422/6e81f8d6/attachment.pl>

From cmohamma at gmail.com  Tue Apr 22 22:32:05 2014
From: cmohamma at gmail.com (Cyrus Mohammadian)
Date: Tue, 22 Apr 2014 13:32:05 -0700
Subject: [R-sig-Geo] Errors with stConstruct() and STFDF()
Message-ID: <473F8554-3AAB-4605-9356-3E80B810D183@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140422/109f0886/attachment.pl>

From vitale232 at gmail.com  Wed Apr 23 06:07:22 2014
From: vitale232 at gmail.com (Andrew Vitale)
Date: Tue, 22 Apr 2014 21:07:22 -0700
Subject: [R-sig-Geo] writeRaster issue
In-Reply-To: <CAGKzJ7qzgCZQLj1HLRFH0A6_UOFYj1ToCmfyTdZ6VyxPxu3FQA@mail.gmail.com>
References: <CAGKzJ7qzgCZQLj1HLRFH0A6_UOFYj1ToCmfyTdZ6VyxPxu3FQA@mail.gmail.com>
Message-ID: <CAFTcopfa=e+LChSKg8MVrNocbZ_sSoQ4JZjz1MizvkJ82TAN1w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140422/440a696b/attachment.pl>

From geponce at gmail.com  Wed Apr 23 07:39:16 2014
From: geponce at gmail.com (Guillermo E. Ponce-Campos)
Date: Tue, 22 Apr 2014 22:39:16 -0700
Subject: [R-sig-Geo] writeRaster issue
In-Reply-To: <CAFTcopfa=e+LChSKg8MVrNocbZ_sSoQ4JZjz1MizvkJ82TAN1w@mail.gmail.com>
References: <CAGKzJ7qzgCZQLj1HLRFH0A6_UOFYj1ToCmfyTdZ6VyxPxu3FQA@mail.gmail.com>
	<CAFTcopfa=e+LChSKg8MVrNocbZ_sSoQ4JZjz1MizvkJ82TAN1w@mail.gmail.com>
Message-ID: <CAGKzJ7qMf3kRQoXsC=OeijKP02vdtHVTftrW16SFYn717wbygg@mail.gmail.com>

Thanks Andrew...
Here is the raster layer object I can save as geoTif on Windows XP and
7 but not in Centos...

https://www.dropbox.com/s/t8rqkvwqnam3imm/rasterLayer.RData

As you can see, in the Centos box I have a newer version for the rgdal
and raster packages.

Thanks,
Guillermo


On Tue, Apr 22, 2014 at 9:07 PM, Andrew Vitale <vitale232 at gmail.com> wrote:
> Hey Guillermo,
>
> All I can add is that I'm unable to reproduce this on my Lubutu 14.04
> laptop.
>
> Perhaps you should try updating R and your packages?
>
>
> ## The following code plots as expected:
>
> setwd("~/Desktop")
> library(raster)
>
> r <- raster()
> r[] <- 1:ncell(r) * 0.001
> plot(r)
>
> r2 <- writeRaster(r, "testGeoTif", format="GTiff", overwrite=TRUE)
> plot(r2)
>
> r3 <- raster("testGeoTif.tif")
> plot(r3)
>
>
>> sessionInfo()
> R version 3.1.0 (2014-04-10)
> Platform: i686-pc-linux-gnu (32-bit)
>
> locale:
>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
>  [9] LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] rgdal_0.8-16  raster_2.2-31 sp_1.0-15
>
> loaded via a namespace (and not attached):
> [1] grid_3.1.0      lattice_0.20-29
>
>
>
> On Tue, Apr 22, 2014 at 11:09 AM, Guillermo E. Ponce-Campos
> <geponce at gmail.com> wrote:
>>
>> Hi:
>>
>> Is there any known issue on using writeRaster under Windows vs Linux?
>>
>> I have been trying to write a rasterlayer as a geotif in a Linux
>> (centos) machine with no success...
>>
>> I have this raster layer:
>>
>> > varTmpRaster
>> class       : RasterLayer
>> dimensions  : 720, 1440, 1036800  (nrow, ncol, ncell)
>> resolution  : 0.25, 0.25  (x, y)
>> extent      : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)
>> coord. ref. : +init=epsg:4326 +proj=longlat +ellps=WGS84 +datum=WGS84
>> +no_defs +towgs84=0,0,0
>> data source : in memory
>> names       : layer
>> values      : 0, 0.9132664  (min, max)
>>
>> >plot(varTmpRaster)
>> It shows everything right...
>>
>> When I run the writeRaster the resulting file only have NA's:
>>
>> >tf <- writeRaster(varTmpRaster, "testGeoTif", format="GTiff",
>> > overwrite=TRUE)
>> >plot(tf)
>> Just blank plot...
>>
>> >length(tf)
>> [1]1036800
>> >length(tf[is.na[tf])
>> [1] 1036800
>>
>>
>> If I run the exact same instructions on R for Windows7 and everything
>> goes fine, both plots, the one from varTmpRaster and the tf show
>> exactly the same map...
>>
>> Here are the characteristics from both machines...
>>
>> Linux-Centos:
>> ---------------
>> R version 3.0.2 (2013-09-25) -- "Frisbee Sailing"
>> rgdal: version: 0.8-16, (SVN revision 498)
>> Geospatial Data Abstraction Library extensions to R successfully loaded
>> Loaded GDAL runtime: GDAL 1.10.1, released 2013/08/26
>> Path to GDAL shared files: /usr/local/share/gdal
>> Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
>> Path to PROJ.4 shared files: /opt/source/proj-4.8.0/nad
>>
>> Windows 7:
>> ----------------
>> R version 3.0.1 (2013-05-16) -- "Good Sport"
>> Loading required package: sp
>> rgdal: version: 0.8-11, (SVN revision 479M)
>> Geospatial Data Abstraction Library extensions to R successfully loaded
>> Loaded GDAL runtime: GDAL 1.9.2, released 2012/10/08
>> Path to GDAL shared files: C:/Program Files/R/R-3.0.1/library/rgdal/gdal
>> GDAL does not use iconv for recoding strings.
>> Loaded PROJ.4 runtime: Rel. 4.7.1, 23 September 2009, [PJ_VERSION: 470]
>> Path to PROJ.4 shared files: C:/Program Files/R/R-3.0.1/library/rgdal/proj
>>
>> Does anyone has seen a thread commenting on an issue like this before ?
>>
>> I have tried the NAvalue() and also using the datatype FLT8S and FLT4S
>> as part of the parameters of the writeRaster but no luck.
>>
>>
>> Thanks,
>> Guillermo
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>
>
> --
> Andrew P. Vitale
> Masters Student
> Department of Geography
> University of Nevada, Reno
> vitale232 at gmail.com



-- 
Guillermo E. Ponce-Campos
PGP Key ID: 0x57EDC060
Ph. (520) 261-8486


From vitale232 at gmail.com  Wed Apr 23 08:31:26 2014
From: vitale232 at gmail.com (Andrew Vitale)
Date: Tue, 22 Apr 2014 23:31:26 -0700
Subject: [R-sig-Geo] writeRaster issue
In-Reply-To: <CAGKzJ7qMf3kRQoXsC=OeijKP02vdtHVTftrW16SFYn717wbygg@mail.gmail.com>
References: <CAGKzJ7qzgCZQLj1HLRFH0A6_UOFYj1ToCmfyTdZ6VyxPxu3FQA@mail.gmail.com>
	<CAFTcopfa=e+LChSKg8MVrNocbZ_sSoQ4JZjz1MizvkJ82TAN1w@mail.gmail.com>
	<CAGKzJ7qMf3kRQoXsC=OeijKP02vdtHVTftrW16SFYn717wbygg@mail.gmail.com>
Message-ID: <CAFTcopfFcDXsgjw1sZJsB0rH1-_kpRsW6bV8+zehArkzmPYX3w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140422/fb93858e/attachment.pl>

From ben.graeler at uni-muenster.de  Wed Apr 23 09:20:05 2014
From: ben.graeler at uni-muenster.de (=?windows-1252?Q?Benedikt_Gr=E4ler?=)
Date: Wed, 23 Apr 2014 09:20:05 +0200
Subject: [R-sig-Geo] errors with stConstruct() and STFDF()
In-Reply-To: <AE026B53-2DD0-4C2C-A734-DB243FA2E228@gmail.com>
References: <AE026B53-2DD0-4C2C-A734-DB243FA2E228@gmail.com>
Message-ID: <535769A5.3020006@uni-muenster.de>

Dear Cyrus,

regarding "stConstruct":
Reading the help page of stConstruct, you will find that "space" and
"time" (2nd and 3rd argument) need to be the name (character) or number
(integer) of the corresponding columns, not the full column as you
provided. Please pay careful attention to the package documentation.

regarding "STFDF":
The error message says, that the product of spatial and temporal
instances is not the same as the length of the data. This condition is
crucial for a STFDF object, as it assumes that for any combination of
space and time there is an observation.
In your case, the time slot has already as many instances as are rows in
your data.frame. You only have to provide each date once and it will be
associated with all spatial instances by the design of a STFDF. Note
that the ordering of the data slot assumes space to cycle fastest.
Furthermore, you need to make sure that your polygons have a matching
ordering to the spatial entities in the data frame.
See the vignette of spacetime [1] for further explanations and
illustrations (i.e. Figure 1) on STFDF, STSDF and STIDF.

[1] http://cran.r-project.org/web/packages/spacetime/vignettes/jss816.pdf

HTH,

 Ben


On 22.04.2014 22:32, Cyrus Mohammadian wrote:
> Hey everyone, I?m new to R and this forum so I apologize in advance for any ambiguity in my question. What I want to do is create a spatiotemporal object (class st) out of an esri shapefile with multiple features and csv file containing data in long format (each row is one observation in space-time). So what I?ve done is imported the shapefile into r using 
> 
> Library(rgdal)
> # read in shape files
> polygons.shp <- readOGR(?polygon.shp", layer=?polygon?)
> 
> # rgdal returns the .prj file associated with the shapefile
> print(proj4string(polygon.shp))
> [1] "+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"
> 
> # converted the csv file to a data.frame 
> long_format.df <- as.data.frame(long_format.csv)
> 
> # converted time variable to proper date format in R
> long_format.df$Date <- as.Date(as.character(long_format.df$Date), format= "%Y%m%d?) 
> 
> 
> My long format table looks something like this: each location is associated with an ID (that matches the polygon IDs in my shapefile) has a location name and   specific date and some variables. The variables fluctuate between temporal and static. For example, X3 and X4 only change over space but not time while X1  and X2 vary over space and time. The dates are the time at which the space-time variables were collected (the last day of each month). 
> 
>    ID   LocationName    Date 	X1 X2 X3 X4...
> 	1		California		2013-03-28	1  1  3	 0
> 	2		Washington	2013-03-28	0  1  9  9
> 	3		Oregon		2013-03-28	1  3  0	 8
> 	1		California		2013-04-30	0  4  3	 0
> 	2		Washington	2013-04-30	5  9  9  9
> 	3		Oregon		2013-04-30	1  0  0	 8	
> 	1		California		2013-05-31	7  6  3	 0
> 	2		Washington	2013-05-31	0  0  9  9
> 	3		Oregon		2013-05-31	1  5  0  8
> 
> When I try to use the stConstruct() I get this error:
> 
> stConstruct(long_format.df, long_format.df $ID, long_format.df $Date, SpatialObj =polygon.shp, TimeObj = NULL)
> Error in stConstruct(long_format.df, long_format.df $ID, long_format.df $Date, SpatialObj =polygon.shp, TimeObj = NULL) : 
>   unknown parameter combination
> 
> When I try to use the STFDF() I get this error:
> 
> STFDF(polygon, long_format.df$Date, long_format.df)
> Error: nrow(object at data) == length(object at sp) * nrow(object at time) is not TRUE
> 
> I also created a separate xts time object in place of ?long_format.df$Date' and tried that but it resulted in the same error.
> 
> Any help or advice would be much appreciated!!!
> 
> Best,
> 
> Cyrus
> 
> 
> 	[[alternative HTML version deleted]]
> 
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Benedikt Gr?ler

ifgi - Institute for Geoinformatics
University of Muenster

http://ifgi.uni-muenster.de/graeler

Phone: +49 251 83-33082
Mail: ben.graeler at uni-muenster.de

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 560 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140423/76e245ae/attachment.bin>

From jan.verbesselt at wur.nl  Wed Apr 23 10:04:36 2014
From: jan.verbesselt at wur.nl (Verbesselt, Jan)
Date: Wed, 23 Apr 2014 08:04:36 +0000
Subject: [R-sig-Geo] writeRaster issue
In-Reply-To: <CAFTcopfFcDXsgjw1sZJsB0rH1-_kpRsW6bV8+zehArkzmPYX3w@mail.gmail.com>
References: <CAGKzJ7qzgCZQLj1HLRFH0A6_UOFYj1ToCmfyTdZ6VyxPxu3FQA@mail.gmail.com>
	<CAFTcopfa=e+LChSKg8MVrNocbZ_sSoQ4JZjz1MizvkJ82TAN1w@mail.gmail.com>
	<CAGKzJ7qMf3kRQoXsC=OeijKP02vdtHVTftrW16SFYn717wbygg@mail.gmail.com>
	<CAFTcopfFcDXsgjw1sZJsB0rH1-_kpRsW6bV8+zehArkzmPYX3w@mail.gmail.com>
Message-ID: <CF7D3F6B.13AD1%jan.verbesselt@wur.nl>

I did a quick test here and it runs fine here (via the terminal/Rstudio).
One thing that might help is to do:
update.packages(checkBuilt=TRUE)
Hope this helps,
Jan

> library(raster)
Loading required package: sp
> library(rgdal)
rgdal: version: 0.8-16, (SVN revision 498)
Geospatial Data Abstraction Library extensions to R successfully loaded
Loaded GDAL runtime: GDAL 1.9.2, released 2012/10/08
Path to GDAL shared files:
/Library/Frameworks/R.framework/Versions/3.0/Resources/library/rgdal/gdal
Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
Path to PROJ.4 shared files:
/Library/Frameworks/R.framework/Versions/3.0/Resources/library/rgdal/proj
> load("~/Downloads/rasterLayer.RData")
> plot(varTmpRaster)
> tf <- writeRaster(varTmpRaster, "~/Desktop/testGeoTif", format = "GTiff",
+  overwrite = TRUE)
> plot(tf)
> all.equal(varTmpRaster, tf)
[1] TRUE
> length(tf)
[1] 1036800
> length(tf[is.na(tf)])
[1] 919682
> ncell(varTmpRaster)
[1] 1036800
> length(tf[is.na(tf)])
[1] 919682
> sessionInfo()
R version 3.0.3 (2014-03-06)
Platform: x86_64-apple-darwin10.8.0 (64-bit)

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] rgdal_0.8-16  raster_2.2-31 sp_1.0-15     devtools_1.5

loaded via a namespace (and not attached):
 [1] digest_0.6.4    evaluate_0.5.3  grid_3.0.3      httr_0.3
lattice_0.20-29
 [6] memoise_0.1     parallel_3.0.3  RCurl_1.95-4.1  stringr_0.6.2
tools_3.0.3    
[11] whisker_0.3-2




On 23/04/14 08:31, "Andrew Vitale" <vitale232 at gmail.com> wrote:

>It runs on my system.  I would still suggest updating to R 3.1.0 and
>making
>sure raster and rgdal are the latest versions.  I'm also running it in the
>terminal, not through something like R Studio.
>
>That's really all I can offer.  Good luck!
>
>-Andrew
>
>
>
>library(raster)
>library(rgdal)
>
>load("~/Downloads/rasterLayer.RData")
>plot(varTmpRaster)
>
>tf <- writeRaster(varTmpRaster, "~/Desktop/testGeoTif", format = "GTiff",
>overwrite = TRUE)
>plot(tf)
>
>
>all.equal(varTmpRaster, tf)
>
>length(tf)
>length(tf[is.na(tf)])
>
>ncell(varTmpRaster)
>length(tf[is.na(tf)])
>
>sessionInfo()
>
>
># > all.equal(varTmpRaster, tf)
># [1] TRUE
># >
>#   > length(tf)
># [1] 1036800
># > length(tf[is.na(tf)])
># [1] 919682
># >
>#   > ncell(varTmpRaster)
># [1] 1036800
># > length(tf[is.na(tf)])
># [1] 919682
># >
>#   > sessionInfo()
># R version 3.1.0 (2014-04-10)
># Platform: x86_64-pc-linux-gnu (64-bit)
>#
># locale:
>#   [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
># [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
># [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
># [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
># [9] LC_ADDRESS=C               LC_TELEPHONE=C
># [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>#
># attached base packages:
>#   [1] stats     graphics  grDevices utils     datasets  methods   base
>
>#
># other attached packages:
>#   [1] rgdal_0.8-16  raster_2.2-31 sp_1.0-15
>#
># loaded via a namespace (and not attached):
>#   [1] grid_3.1.0      lattice_0.20-29 tcltk_3.1.0     tools_3.1.0
>
>
>
>On Tue, Apr 22, 2014 at 10:39 PM, Guillermo E. Ponce-Campos <
>geponce at gmail.com> wrote:
>
>> Thanks Andrew...
>> Here is the raster layer object I can save as geoTif on Windows XP and
>> 7 but not in Centos...
>>
>> https://www.dropbox.com/s/t8rqkvwqnam3imm/rasterLayer.RData
>>
>> As you can see, in the Centos box I have a newer version for the rgdal
>> and raster packages.
>>
>> Thanks,
>> Guillermo
>>
>>
>> On Tue, Apr 22, 2014 at 9:07 PM, Andrew Vitale <vitale232 at gmail.com>
>> wrote:
>> > Hey Guillermo,
>> >
>> > All I can add is that I'm unable to reproduce this on my Lubutu 14.04
>> > laptop.
>> >
>> > Perhaps you should try updating R and your packages?
>> >
>> >
>> > ## The following code plots as expected:
>> >
>> > setwd("~/Desktop")
>> > library(raster)
>> >
>> > r <- raster()
>> > r[] <- 1:ncell(r) * 0.001
>> > plot(r)
>> >
>> > r2 <- writeRaster(r, "testGeoTif", format="GTiff", overwrite=TRUE)
>> > plot(r2)
>> >
>> > r3 <- raster("testGeoTif.tif")
>> > plot(r3)
>> >
>> >
>> >> sessionInfo()
>> > R version 3.1.0 (2014-04-10)
>> > Platform: i686-pc-linux-gnu (32-bit)
>> >
>> > locale:
>> >  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>> >  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>> >  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>> >  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
>> >  [9] LC_ADDRESS=C               LC_TELEPHONE=C
>> > [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>> >
>> > attached base packages:
>> > [1] stats     graphics  grDevices utils     datasets  methods   base
>> >
>> > other attached packages:
>> > [1] rgdal_0.8-16  raster_2.2-31 sp_1.0-15
>> >
>> > loaded via a namespace (and not attached):
>> > [1] grid_3.1.0      lattice_0.20-29
>> >
>> >
>> >
>> > On Tue, Apr 22, 2014 at 11:09 AM, Guillermo E. Ponce-Campos
>> > <geponce at gmail.com> wrote:
>> >>
>> >> Hi:
>> >>
>> >> Is there any known issue on using writeRaster under Windows vs Linux?
>> >>
>> >> I have been trying to write a rasterlayer as a geotif in a Linux
>> >> (centos) machine with no success...
>> >>
>> >> I have this raster layer:
>> >>
>> >> > varTmpRaster
>> >> class       : RasterLayer
>> >> dimensions  : 720, 1440, 1036800  (nrow, ncol, ncell)
>> >> resolution  : 0.25, 0.25  (x, y)
>> >> extent      : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)
>> >> coord. ref. : +init=epsg:4326 +proj=longlat +ellps=WGS84 +datum=WGS84
>> >> +no_defs +towgs84=0,0,0
>> >> data source : in memory
>> >> names       : layer
>> >> values      : 0, 0.9132664  (min, max)
>> >>
>> >> >plot(varTmpRaster)
>> >> It shows everything right...
>> >>
>> >> When I run the writeRaster the resulting file only have NA's:
>> >>
>> >> >tf <- writeRaster(varTmpRaster, "testGeoTif", format="GTiff",
>> >> > overwrite=TRUE)
>> >> >plot(tf)
>> >> Just blank plot...
>> >>
>> >> >length(tf)
>> >> [1]1036800
>> >> >length(tf[is.na[tf])
>> >> [1] 1036800
>> >>
>> >>
>> >> If I run the exact same instructions on R for Windows7 and everything
>> >> goes fine, both plots, the one from varTmpRaster and the tf show
>> >> exactly the same map...
>> >>
>> >> Here are the characteristics from both machines...
>> >>
>> >> Linux-Centos:
>> >> ---------------
>> >> R version 3.0.2 (2013-09-25) -- "Frisbee Sailing"
>> >> rgdal: version: 0.8-16, (SVN revision 498)
>> >> Geospatial Data Abstraction Library extensions to R successfully
>>loaded
>> >> Loaded GDAL runtime: GDAL 1.10.1, released 2013/08/26
>> >> Path to GDAL shared files: /usr/local/share/gdal
>> >> Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
>> >> Path to PROJ.4 shared files: /opt/source/proj-4.8.0/nad
>> >>
>> >> Windows 7:
>> >> ----------------
>> >> R version 3.0.1 (2013-05-16) -- "Good Sport"
>> >> Loading required package: sp
>> >> rgdal: version: 0.8-11, (SVN revision 479M)
>> >> Geospatial Data Abstraction Library extensions to R successfully
>>loaded
>> >> Loaded GDAL runtime: GDAL 1.9.2, released 2012/10/08
>> >> Path to GDAL shared files: C:/Program
>>Files/R/R-3.0.1/library/rgdal/gdal
>> >> GDAL does not use iconv for recoding strings.
>> >> Loaded PROJ.4 runtime: Rel. 4.7.1, 23 September 2009, [PJ_VERSION:
>>470]
>> >> Path to PROJ.4 shared files: C:/Program
>> Files/R/R-3.0.1/library/rgdal/proj
>> >>
>> >> Does anyone has seen a thread commenting on an issue like this
>>before ?
>> >>
>> >> I have tried the NAvalue() and also using the datatype FLT8S and
>>FLT4S
>> >> as part of the parameters of the writeRaster but no luck.
>> >>
>> >>
>> >> Thanks,
>> >> Guillermo
>> >>
>> >> _______________________________________________
>> >> R-sig-Geo mailing list
>> >> R-sig-Geo at r-project.org
>> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >
>> >
>> >
>> >
>> > --
>> > Andrew P. Vitale
>> > Masters Student
>> > Department of Geography
>> > University of Nevada, Reno
>> > vitale232 at gmail.com
>>
>>
>>
>> --
>> Guillermo E. Ponce-Campos
>> PGP Key ID: 0x57EDC060
>> Ph. (520) 261-8486
>>
>
>
>
>-- 
>*Andrew P. Vitale*
>Masters Student
>Department of Geography
>University of Nevada, Reno
>vitale232 at gmail.com
>
>	[[alternative HTML version deleted]]
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From loic.dutrieux at wur.nl  Wed Apr 23 10:27:37 2014
From: loic.dutrieux at wur.nl (=?ISO-8859-1?Q?Lo=EFc_Dutrieux?=)
Date: Wed, 23 Apr 2014 10:27:37 +0200
Subject: [R-sig-Geo] writeRaster issue
In-Reply-To: <CAFTcopfFcDXsgjw1sZJsB0rH1-_kpRsW6bV8+zehArkzmPYX3w@mail.gmail.com>
References: <CAGKzJ7qzgCZQLj1HLRFH0A6_UOFYj1ToCmfyTdZ6VyxPxu3FQA@mail.gmail.com>	<CAFTcopfa=e+LChSKg8MVrNocbZ_sSoQ4JZjz1MizvkJ82TAN1w@mail.gmail.com>	<CAGKzJ7qMf3kRQoXsC=OeijKP02vdtHVTftrW16SFYn717wbygg@mail.gmail.com>
	<CAFTcopfFcDXsgjw1sZJsB0rH1-_kpRsW6bV8+zehArkzmPYX3w@mail.gmail.com>
Message-ID: <53577979.2070603@wur.nl>

Dear Guillermo,

Yes, there are a few differences among platforms when it comes to rgdal. 
You may check that your gdal installation has the GTiff driver.

##
library(rgdal)
gdalDrivers()

In most cases gdal will automatically configure with GTiff though.

Best regards,
--
Lo?c Dutrieux
Laboratory of Geo-Information Science and Remote Sensing
Wageningen University
The Netherlands

On 14-04-23 08:31 AM, Andrew Vitale wrote:
> It runs on my system.  I would still suggest updating to R 3.1.0 and making
> sure raster and rgdal are the latest versions.  I'm also running it in the
> terminal, not through something like R Studio.
>
> That's really all I can offer.  Good luck!
>
> -Andrew
>
>
>
> library(raster)
> library(rgdal)
>
> load("~/Downloads/rasterLayer.RData")
> plot(varTmpRaster)
>
> tf <- writeRaster(varTmpRaster, "~/Desktop/testGeoTif", format = "GTiff",
> overwrite = TRUE)
> plot(tf)
>
>
> all.equal(varTmpRaster, tf)
>
> length(tf)
> length(tf[is.na(tf)])
>
> ncell(varTmpRaster)
> length(tf[is.na(tf)])
>
> sessionInfo()
>
>
> # > all.equal(varTmpRaster, tf)
> # [1] TRUE
> # >
> #   > length(tf)
> # [1] 1036800
> # > length(tf[is.na(tf)])
> # [1] 919682
> # >
> #   > ncell(varTmpRaster)
> # [1] 1036800
> # > length(tf[is.na(tf)])
> # [1] 919682
> # >
> #   > sessionInfo()
> # R version 3.1.0 (2014-04-10)
> # Platform: x86_64-pc-linux-gnu (64-bit)
> #
> # locale:
> #   [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
> # [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
> # [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
> # [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
> # [9] LC_ADDRESS=C               LC_TELEPHONE=C
> # [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
> #
> # attached base packages:
> #   [1] stats     graphics  grDevices utils     datasets  methods   base
>
> #
> # other attached packages:
> #   [1] rgdal_0.8-16  raster_2.2-31 sp_1.0-15
> #
> # loaded via a namespace (and not attached):
> #   [1] grid_3.1.0      lattice_0.20-29 tcltk_3.1.0     tools_3.1.0
>
>
>
> On Tue, Apr 22, 2014 at 10:39 PM, Guillermo E. Ponce-Campos <
> geponce at gmail.com> wrote:
>
>> Thanks Andrew...
>> Here is the raster layer object I can save as geoTif on Windows XP and
>> 7 but not in Centos...
>>
>> https://www.dropbox.com/s/t8rqkvwqnam3imm/rasterLayer.RData
>>
>> As you can see, in the Centos box I have a newer version for the rgdal
>> and raster packages.
>>
>> Thanks,
>> Guillermo
>>
>>
>> On Tue, Apr 22, 2014 at 9:07 PM, Andrew Vitale <vitale232 at gmail.com>
>> wrote:
>>> Hey Guillermo,
>>>
>>> All I can add is that I'm unable to reproduce this on my Lubutu 14.04
>>> laptop.
>>>
>>> Perhaps you should try updating R and your packages?
>>>
>>>
>>> ## The following code plots as expected:
>>>
>>> setwd("~/Desktop")
>>> library(raster)
>>>
>>> r <- raster()
>>> r[] <- 1:ncell(r) * 0.001
>>> plot(r)
>>>
>>> r2 <- writeRaster(r, "testGeoTif", format="GTiff", overwrite=TRUE)
>>> plot(r2)
>>>
>>> r3 <- raster("testGeoTif.tif")
>>> plot(r3)
>>>
>>>
>>>> sessionInfo()
>>> R version 3.1.0 (2014-04-10)
>>> Platform: i686-pc-linux-gnu (32-bit)
>>>
>>> locale:
>>>   [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>>>   [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>>>   [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>>>   [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
>>>   [9] LC_ADDRESS=C               LC_TELEPHONE=C
>>> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>>>
>>> attached base packages:
>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>
>>> other attached packages:
>>> [1] rgdal_0.8-16  raster_2.2-31 sp_1.0-15
>>>
>>> loaded via a namespace (and not attached):
>>> [1] grid_3.1.0      lattice_0.20-29
>>>
>>>
>>>
>>> On Tue, Apr 22, 2014 at 11:09 AM, Guillermo E. Ponce-Campos
>>> <geponce at gmail.com> wrote:
>>>>
>>>> Hi:
>>>>
>>>> Is there any known issue on using writeRaster under Windows vs Linux?
>>>>
>>>> I have been trying to write a rasterlayer as a geotif in a Linux
>>>> (centos) machine with no success...
>>>>
>>>> I have this raster layer:
>>>>
>>>>> varTmpRaster
>>>> class       : RasterLayer
>>>> dimensions  : 720, 1440, 1036800  (nrow, ncol, ncell)
>>>> resolution  : 0.25, 0.25  (x, y)
>>>> extent      : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)
>>>> coord. ref. : +init=epsg:4326 +proj=longlat +ellps=WGS84 +datum=WGS84
>>>> +no_defs +towgs84=0,0,0
>>>> data source : in memory
>>>> names       : layer
>>>> values      : 0, 0.9132664  (min, max)
>>>>
>>>>> plot(varTmpRaster)
>>>> It shows everything right...
>>>>
>>>> When I run the writeRaster the resulting file only have NA's:
>>>>
>>>>> tf <- writeRaster(varTmpRaster, "testGeoTif", format="GTiff",
>>>>> overwrite=TRUE)
>>>>> plot(tf)
>>>> Just blank plot...
>>>>
>>>>> length(tf)
>>>> [1]1036800
>>>>> length(tf[is.na[tf])
>>>> [1] 1036800
>>>>
>>>>
>>>> If I run the exact same instructions on R for Windows7 and everything
>>>> goes fine, both plots, the one from varTmpRaster and the tf show
>>>> exactly the same map...
>>>>
>>>> Here are the characteristics from both machines...
>>>>
>>>> Linux-Centos:
>>>> ---------------
>>>> R version 3.0.2 (2013-09-25) -- "Frisbee Sailing"
>>>> rgdal: version: 0.8-16, (SVN revision 498)
>>>> Geospatial Data Abstraction Library extensions to R successfully loaded
>>>> Loaded GDAL runtime: GDAL 1.10.1, released 2013/08/26
>>>> Path to GDAL shared files: /usr/local/share/gdal
>>>> Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
>>>> Path to PROJ.4 shared files: /opt/source/proj-4.8.0/nad
>>>>
>>>> Windows 7:
>>>> ----------------
>>>> R version 3.0.1 (2013-05-16) -- "Good Sport"
>>>> Loading required package: sp
>>>> rgdal: version: 0.8-11, (SVN revision 479M)
>>>> Geospatial Data Abstraction Library extensions to R successfully loaded
>>>> Loaded GDAL runtime: GDAL 1.9.2, released 2012/10/08
>>>> Path to GDAL shared files: C:/Program Files/R/R-3.0.1/library/rgdal/gdal
>>>> GDAL does not use iconv for recoding strings.
>>>> Loaded PROJ.4 runtime: Rel. 4.7.1, 23 September 2009, [PJ_VERSION: 470]
>>>> Path to PROJ.4 shared files: C:/Program
>> Files/R/R-3.0.1/library/rgdal/proj
>>>>
>>>> Does anyone has seen a thread commenting on an issue like this before ?
>>>>
>>>> I have tried the NAvalue() and also using the datatype FLT8S and FLT4S
>>>> as part of the parameters of the writeRaster but no luck.
>>>>
>>>>
>>>> Thanks,
>>>> Guillermo
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>>>
>>>
>>> --
>>> Andrew P. Vitale
>>> Masters Student
>>> Department of Geography
>>> University of Nevada, Reno
>>> vitale232 at gmail.com
>>
>>
>>
>> --
>> Guillermo E. Ponce-Campos
>> PGP Key ID: 0x57EDC060
>> Ph. (520) 261-8486
>>
>
>
>


From alobolistas at gmail.com  Wed Apr 23 12:41:00 2014
From: alobolistas at gmail.com (Agustin Lobo)
Date: Wed, 23 Apr 2014 12:41:00 +0200
Subject: [R-sig-Geo] Access WMS (and alike) services from R?
Message-ID: <CAG4NReJwsCWwVyzoR4bB2mys7A1OzcKDTvxQ=XPjcyo41fJ4qA@mail.gmail.com>

Hi!

Is there any project attempting to access remote geoservices such as
WMS in a similar way
as it is done with google maps (i.e. through ggmap:get_map()) ?

Agus


From Roger.Bivand at nhh.no  Wed Apr 23 14:09:51 2014
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 23 Apr 2014 14:09:51 +0200
Subject: [R-sig-Geo] Access WMS (and alike) services from R?
In-Reply-To: <CAG4NReJwsCWwVyzoR4bB2mys7A1OzcKDTvxQ=XPjcyo41fJ4qA@mail.gmail.com>
References: <CAG4NReJwsCWwVyzoR4bB2mys7A1OzcKDTvxQ=XPjcyo41fJ4qA@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1404231405410.32337@reclus.nhh.no>

On Wed, 23 Apr 2014, Agustin Lobo wrote:

> Hi!
>
> Is there any project attempting to access remote geoservices such as
> WMS in a similar way
> as it is done with google maps (i.e. through ggmap:get_map()) ?

I've no idea how ggmap does this, or whether it uses WMS. Your GDAL may 
have been built with a WMS driver - see gdalDrivers() to check. The CRAN 
Windows rgdal binary does not have this driver. For driver details see:

http://www.gdal.org/frmt_wms.html

which has examples of the short xml files needed to configure access to 
such services.

Roger

>
> Agus
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From alobolistas at gmail.com  Wed Apr 23 15:34:12 2014
From: alobolistas at gmail.com (Agustin Lobo)
Date: Wed, 23 Apr 2014 15:34:12 +0200
Subject: [R-sig-Geo] Access WMS (and alike) services from R?
In-Reply-To: <alpine.LRH.2.03.1404231405410.32337@reclus.nhh.no>
References: <CAG4NReJwsCWwVyzoR4bB2mys7A1OzcKDTvxQ=XPjcyo41fJ4qA@mail.gmail.com>
	<alpine.LRH.2.03.1404231405410.32337@reclus.nhh.no>
Message-ID: <CAG4NReK9Lj0bwDSqbJU0bCXUQDjDvn5XMOOCZxfSLefnytgMpQ@mail.gmail.com>

According to gdalDrivers(), I have
115             WCS                                       OGC Web
Coverage Service  FALSE FALSE
116             WMS                                      OGC Web Map
Service  FALSE  TRUE


which I understand implies that I should be able to read wms.

I'll see if I can find someone interested on building this type of utility in R.

Agus

Details on my system (linuxmint 15, based on ubuntu raring) (gdal from
ubuntugis-unstable):
> require(rgdal)
Loading required package: rgdal
Loading required package: sp
rgdal: version: 0.8-16, (SVN revision 498)
Geospatial Data Abstraction Library extensions to R successfully loaded
Loaded GDAL runtime: GDAL 1.10.0, released 2013/04/24
Path to GDAL shared files: /usr/share/gdal/1.10
Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
Path to PROJ.4 shared files: (autodetected)

> sessionInfo()
R version 3.0.2 (2013-09-25)
Platform: x86_64-pc-linux-gnu (64-bit)

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
LC_TIME=es_ES.UTF-8        LC_COLLATE=en_US.UTF-8
 [5] LC_MONETARY=es_ES.UTF-8    LC_MESSAGES=en_US.UTF-8
LC_PAPER=es_ES.UTF-8       LC_NAME=C
 [9] LC_ADDRESS=C               LC_TELEPHONE=C
LC_MEASUREMENT=es_ES.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] grid      stats     graphics  grDevices utils     datasets
methods   base

other attached packages:
 [1] rasterVis_0.27      hexbin_1.26.3       latticeExtra_0.6-26
lattice_0.20-24     RColorBrewer_1.0-5
 [6] ggmap_2.3           ggplot2_0.9.3.1     raster_2.2-31
rgdal_0.8-16        sp_1.0-14

loaded via a namespace (and not attached):
 [1] colorspace_1.2-4    dichromat_2.0-0     digest_0.6.4
gtable_0.1.2        labeling_0.2
 [6] mapproj_1.2-1       maps_2.3-6          MASS_7.3-29
munsell_0.4.2       plyr_1.8
[11] png_0.1-7           proto_0.3-10        reshape2_1.2.2
RgoogleMaps_1.2.0.5 rjson_0.2.13
[16] RJSONIO_1.0-3       scales_0.2.3        stringr_0.6.2
tools_3.0.2         zoo_1.7-10

$ uname -a
Linux Delia 3.8.0-35-generic #50-Ubuntu SMP Tue Dec 3 01:24:59 UTC
2013 x86_64 x86_64 x86_64 GNU/Linux



On Wed, Apr 23, 2014 at 2:09 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> On Wed, 23 Apr 2014, Agustin Lobo wrote:
>
>> Hi!
>>
>> Is there any project attempting to access remote geoservices such as
>> WMS in a similar way
>> as it is done with google maps (i.e. through ggmap:get_map()) ?
>
>
> I've no idea how ggmap does this, or whether it uses WMS. Your GDAL may have
> been built with a WMS driver - see gdalDrivers() to check. The CRAN Windows
> rgdal binary does not have this driver. For driver details see:
>
> http://www.gdal.org/frmt_wms.html
>
> which has examples of the short xml files needed to configure access to such
> services.
>
> Roger
>
>>
>> Agus
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 91 00
> e-mail: Roger.Bivand at nhh.no
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From alobolistas at gmail.com  Wed Apr 23 15:42:03 2014
From: alobolistas at gmail.com (Agustin Lobo)
Date: Wed, 23 Apr 2014 15:42:03 +0200
Subject: [R-sig-Geo] projection of ggmap:get_map() output
Message-ID: <CAG4NReJWfjj5tHM=TEazz6piggCSbOs0Nq_gWYD3gtg3B1d3sA@mail.gmail.com>

I think that the output of get_map commands, i.e.

gmap <- get_map(location = rprobextLL at bbox, maptype = "hybrid", source
= "google",
    crop = FALSE, zoom = 5)

is a raster (not in the sense of an object of the raster package) in
gepgraphic coordinates
(epsg:4326), but actually do not see it specified anywhere. Does
anyone know for sure?
The alternative would be google PseudoMercator (eps:3857)

Also, I'm kind of confused with the get_map help page:
"Value
a data.frame with columns latitude, longitude, and fill"

while in R we get:
> str(gmap)
 chr [1:1280, 1:1280] "#24392B" "#2E4832" "#3E583B" "#3E583B"
"#55675F" "#5B6C52" "#656B58" ...
 - attr(*, "class")= chr [1:2] "ggmap" "raster"
 - attr(*, "bb")='data.frame':    1 obs. of  4 variables:
  ..$ ll.lat: num -38.2
  ..$ ll.lon: num -73.4
  ..$ ur.lat: num -13.2
  ..$ ur.lon: num -45.3


Agus


From b.rowlingson at lancaster.ac.uk  Wed Apr 23 16:37:46 2014
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed, 23 Apr 2014 15:37:46 +0100
Subject: [R-sig-Geo] projection of ggmap:get_map() output
In-Reply-To: <15399b6d75f748d28822ecdb366ebd84@EX-0-HT0.lancs.local>
References: <15399b6d75f748d28822ecdb366ebd84@EX-0-HT0.lancs.local>
Message-ID: <CANVKczNLjyBAZ2y7FOvDP+c-ZSwABT_6BWK276uJJy=7MEew4w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140423/9c12fddb/attachment.pl>

From agus.camacho at gmail.com  Wed Apr 23 18:33:58 2014
From: agus.camacho at gmail.com (Agus Camacho)
Date: Wed, 23 Apr 2014 13:33:58 -0300
Subject: [R-sig-Geo] Find the two nearest locations for each raster cell in
	a raster layer.
Message-ID: <CALsJ7pQQVfGBd2S=56NSEx4J=o9Mww7K4BDmgmXt4E5qqHf7Pg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140423/e0efe195/attachment.pl>

From alobolistas at gmail.com  Thu Apr 24 09:43:38 2014
From: alobolistas at gmail.com (Agustin Lobo)
Date: Thu, 24 Apr 2014 09:43:38 +0200
Subject: [R-sig-Geo] projection of ggmap:get_map() output
In-Reply-To: <CANVKczNLjyBAZ2y7FOvDP+c-ZSwABT_6BWK276uJJy=7MEew4w@mail.gmail.com>
References: <15399b6d75f748d28822ecdb366ebd84@EX-0-HT0.lancs.local>
	<CANVKczNLjyBAZ2y7FOvDP+c-ZSwABT_6BWK276uJJy=7MEew4w@mail.gmail.com>
Message-ID: <CAG4NReLZfUtayt+koJvSZJAK1q_vNJAnJmQ_9GBtOc=X2uGqfw@mail.gmail.com>

Barry,

On Wed, Apr 23, 2014 at 4:37 PM, Barry Rowlingson
<b.rowlingson at lancaster.ac.uk> wrote:
> On Wed, Apr 23, 2014 at 2:42 PM, Agustin Lobo <alobolistas at gmail.com> wrote:
>
>> I think that the output of get_map commands, i.e.
>>
>> gmap <- get_map(location = rprobextLL at bbox, maptype = "hybrid", source
>> = "google",
>>     crop = FALSE, zoom = 5)
>>
>> is a raster (not in the sense of an object of the raster package) in
>> gepgraphic coordinates
>> (epsg:4326), but actually do not see it specified anywhere. Does
>> anyone know for sure?
>> The alternative would be google PseudoMercator (eps:3857)
>>
>> The bounding boxes generally just get passed through to the web service
> that is providing the tiles - eg for google maps its getting:
>
> http://maps.googleapis.com/maps/api/staticmap?center=29.763284,-95.363271&zoom=10&size=640x640&scale=
> 2&&maptype=terrain&&&&&&&sensor=false
>
>  - I imagine the web services expect EPSG:4326.

What they expect, yes. But what about what we retrieve? The bb
coordinates might be in geographic coordinates (epsg:4326) but
the actual projection of the matrix could be any other. Actually, I
think that no geographic object without CRS information should be
admitted in R.

In order to investigate this further, I've done the following:


gmap <- get_map(location = rprobextLL at bbox, maptype = "hybrid",
source= "google", crop = FALSE, zoom = 5)

(use
> rprobextLL at bbox
        min       max
x -69.88634 -48.78450
y -34.05533 -18.63424

i.e.
mibb <- matrix(c(69.88634, -48.78450, -34.05533, -18.63424),nrow=2)

mgmap <- as.matrix(gmap)
vgmap <- as.vector(mgmap)
vgmaprgb <- col2rgb(vgmap)
gmapr <- matrix(vgmaprgb[1,],ncol=ncol(mgmap),nrow=nrow(mgmap))
gmapg <- matrix(vgmaprgb[2,],ncol=ncol(mgmap),nrow=nrow(mgmap))
gmapb <- matrix(vgmaprgb[3,],ncol=ncol(mgmap),nrow=nrow(mgmap))
rgmaprgb <- brick(raster(gmapr),raster(gmapg),raster(gmapb))
projection(rgmaprgb) <- CRS("+init=epsg:4326")
extent(rgmaprgb) <- unlist(attr(gmap,which="bb"))[c(2,4,1,3)]
rgmaprgb
plotRGB(rgmaprgb)
writeRaster(rgmaprgb,file="rgmaprgb",format="GTiff",overwrite=TRUE,datatype="INT1U")



>
>> Also, I'm kind of confused with the get_map help page:
>> "Value
>> a data.frame with columns latitude, longitude, and fill"
>>
>> while in R we get:
>> > str(gmap)
>>  chr [1:1280, 1:1280] "#24392B" "#2E4832" "#3E583B" "#3E583B"
>> "#55675F" "#5B6C52" "#656B58" ...
>>  - attr(*, "class")= chr [1:2] "ggmap" "raster"
>>  - attr(*, "bb")='data.frame':    1 obs. of  4 variables:
>>   ..$ ll.lat: num -38.2
>>   ..$ ll.lon: num -73.4
>>   ..$ ur.lat: num -13.2
>>   ..$ ur.lon: num -45.3
>>
>>
>  I think its lying - why not report a documentation bug?
>
>  The returned objects are just matrices of colour values with bb attributes
> and class "ggmap" "raster". You can make one yourself easily enough:
>
>  > green = matrix("#00FF00",256,256)
>  > attr(green,"bb")=attr(gmap,"bb")
>  > class(green)=c("ggmap","raster")
>
>  - taking the bbox from a previous get_map call. Looking at the code the
> matrix just comes from readPNG via the png file it dumps in your current
> directory (by default). So... if you can work out the WMS call to get a PNG
> then you can easily make a ggmap object.
>
> Barry
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From alobolistas at gmail.com  Thu Apr 24 09:56:02 2014
From: alobolistas at gmail.com (Agustin Lobo)
Date: Thu, 24 Apr 2014 09:56:02 +0200
Subject: [R-sig-Geo] projection of ggmap:get_map() output
In-Reply-To: <CAG4NReLZfUtayt+koJvSZJAK1q_vNJAnJmQ_9GBtOc=X2uGqfw@mail.gmail.com>
References: <15399b6d75f748d28822ecdb366ebd84@EX-0-HT0.lancs.local>
	<CANVKczNLjyBAZ2y7FOvDP+c-ZSwABT_6BWK276uJJy=7MEew4w@mail.gmail.com>
	<CAG4NReLZfUtayt+koJvSZJAK1q_vNJAnJmQ_9GBtOc=X2uGqfw@mail.gmail.com>
Message-ID: <CAG4NReJz-eq6GcGm=cQrMikz9VnhSu=HdpOyQHmB9PUK3e=Xpg@mail.gmail.com>

(follow up of previous message, I pressed enter as if I were in the R
session and sent the message...)

On Wed, Apr 23, 2014 at 4:37 PM, Barry Rowlingson
<b.rowlingson at lancaster.ac.uk> wrote:
>  - I imagine the web services expect EPSG:4326.

What they expect, yes. But what about what we retrieve? The bbox
coordinates might be in geographic coordinates (epsg:4326) but
the actual projection of the matrix could be any other. Actually, I
think that no geographic object without CRS information should be
admitted in R.

In order to investigate this further, I've done the following:

mibb <- matrix(c(-69.88634, -48.78450, -34.05533, -18.63424),byrow=TRUE,nrow=2)
delme <- get_map(location = mibb, maptype = "hybrid", source=
"google", crop = FALSE, zoom = 5)

mgmap <- as.matrix(gmap)
vgmap <- as.vector(mgmap)
vgmaprgb <- col2rgb(vgmap)
gmapr <- matrix(vgmaprgb[1,],ncol=ncol(
mgmap),nrow=nrow(mgmap))
gmapg <- matrix(vgmaprgb[2,],ncol=ncol(mgmap),nrow=nrow(mgmap))
gmapb <- matrix(vgmaprgb[3,],ncol=ncol(mgmap),nrow=nrow(mgmap))
rgmaprgb <- brick(raster(gmapr),raster(gmapg),raster(gmapb))
projection(rgmaprgb) <- CRS("+init=epsg:4326")
extent(rgmaprgb) <- unlist(attr(gmap,which="bb"))[c(2,4,1,3)]
rgmaprgb
plotRGB(rgmaprgb)

This looks good, but when I save as GTiff
writeRaster(rgmaprgb,file="rgmaprgb",format="GTiff",overwrite=TRUE,datatype="INT1U")

and check with QGIS, there is a very significant shift versus the GM
layer that is downladed by plugin OpenLayers.

Thus I worry that my overlay using rasterVis:levelplot and ggmap:
layer could actually be wrong as well.

I'm going to test on a more local area and let you know.

Agus


From edzer.pebesma at uni-muenster.de  Thu Apr 24 10:21:26 2014
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 24 Apr 2014 10:21:26 +0200
Subject: [R-sig-Geo] projection of ggmap:get_map() output
In-Reply-To: <CAG4NReJz-eq6GcGm=cQrMikz9VnhSu=HdpOyQHmB9PUK3e=Xpg@mail.gmail.com>
References: <15399b6d75f748d28822ecdb366ebd84@EX-0-HT0.lancs.local>	<CANVKczNLjyBAZ2y7FOvDP+c-ZSwABT_6BWK276uJJy=7MEew4w@mail.gmail.com>	<CAG4NReLZfUtayt+koJvSZJAK1q_vNJAnJmQ_9GBtOc=X2uGqfw@mail.gmail.com>
	<CAG4NReJz-eq6GcGm=cQrMikz9VnhSu=HdpOyQHmB9PUK3e=Xpg@mail.gmail.com>
Message-ID: <5358C986.9080309@uni-muenster.de>

EPSG:4326, or WGS84, is only one way to refer to places on the earth by
longitudes and latitudes; it seems that google maps come in a Mercator
projection, EPSG:3857, read e.g. this:

http://docs.openlayers.org/library/spherical_mercator.html

or

https://developers.google.com/maps/documentation/javascript/maptypes#MapCoordinates

Iliffe and Lott: Datums and Map Projections: For Remote Sensing, GIS and
Surveying

provide an excellent explanation on what goes on here, including what
google maps does.

On 04/24/2014 09:56 AM, Agustin Lobo wrote:
> (follow up of previous message, I pressed enter as if I were in the R
> session and sent the message...)
> 
> On Wed, Apr 23, 2014 at 4:37 PM, Barry Rowlingson
> <b.rowlingson at lancaster.ac.uk> wrote:
>>  - I imagine the web services expect EPSG:4326.
> 
> What they expect, yes. But what about what we retrieve? The bbox
> coordinates might be in geographic coordinates (epsg:4326) but
> the actual projection of the matrix could be any other. Actually, I
> think that no geographic object without CRS information should be
> admitted in R.
> 
> In order to investigate this further, I've done the following:
> 
> mibb <- matrix(c(-69.88634, -48.78450, -34.05533, -18.63424),byrow=TRUE,nrow=2)
> delme <- get_map(location = mibb, maptype = "hybrid", source=
> "google", crop = FALSE, zoom = 5)
> 
> mgmap <- as.matrix(gmap)
> vgmap <- as.vector(mgmap)
> vgmaprgb <- col2rgb(vgmap)
> gmapr <- matrix(vgmaprgb[1,],ncol=ncol(
> mgmap),nrow=nrow(mgmap))
> gmapg <- matrix(vgmaprgb[2,],ncol=ncol(mgmap),nrow=nrow(mgmap))
> gmapb <- matrix(vgmaprgb[3,],ncol=ncol(mgmap),nrow=nrow(mgmap))
> rgmaprgb <- brick(raster(gmapr),raster(gmapg),raster(gmapb))
> projection(rgmaprgb) <- CRS("+init=epsg:4326")
> extent(rgmaprgb) <- unlist(attr(gmap,which="bb"))[c(2,4,1,3)]
> rgmaprgb
> plotRGB(rgmaprgb)
> 
> This looks good, but when I save as GTiff
> writeRaster(rgmaprgb,file="rgmaprgb",format="GTiff",overwrite=TRUE,datatype="INT1U")
> 
> and check with QGIS, there is a very significant shift versus the GM
> layer that is downladed by plugin OpenLayers.
> 
> Thus I worry that my overlay using rasterVis:levelplot and ggmap:
> layer could actually be wrong as well.
> 
> I'm going to test on a more local area and let you know.
> 
> Agus
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140424/cece2a3c/attachment.bin>

From alobolistas at gmail.com  Thu Apr 24 13:43:22 2014
From: alobolistas at gmail.com (Agustin Lobo)
Date: Thu, 24 Apr 2014 13:43:22 +0200
Subject: [R-sig-Geo] projection of ggmap:get_map() output
In-Reply-To: <5358C986.9080309@uni-muenster.de>
References: <15399b6d75f748d28822ecdb366ebd84@EX-0-HT0.lancs.local>
	<CANVKczNLjyBAZ2y7FOvDP+c-ZSwABT_6BWK276uJJy=7MEew4w@mail.gmail.com>
	<CAG4NReLZfUtayt+koJvSZJAK1q_vNJAnJmQ_9GBtOc=X2uGqfw@mail.gmail.com>
	<CAG4NReJz-eq6GcGm=cQrMikz9VnhSu=HdpOyQHmB9PUK3e=Xpg@mail.gmail.com>
	<5358C986.9080309@uni-muenster.de>
Message-ID: <CAG4NRe+vnJwiu2gAQ6npS38zG77ryagqDHuqfwbsLSdUMDp_fg@mail.gmail.com>

But the fact that the output of get_map() includes the bounding box in
geographic
coordinates (epsg:4326) does not imply that the matrix is on the same
projection.
This should be specified.
I can provide you a utm raster along with bounding box coordinates in
geographic coordinates (epsg:4326).
Actually, according to the code I just showed, it is not clear at all
that the matrix provided
in the ggmap "raster" object is in epsg:4326.

Agus



On Thu, Apr 24, 2014 at 10:21 AM, Edzer Pebesma
<edzer.pebesma at uni-muenster.de> wrote:
> EPSG:4326, or WGS84, is only one way to refer to places on the earth by
> longitudes and latitudes; it seems that google maps come in a Mercator
> projection, EPSG:3857, read e.g. this:
>
> http://docs.openlayers.org/library/spherical_mercator.html
>
> or
>
> https://developers.google.com/maps/documentation/javascript/maptypes#MapCoordinates
>
> Iliffe and Lott: Datums and Map Projections: For Remote Sensing, GIS and
> Surveying
>
> provide an excellent explanation on what goes on here, including what
> google maps does.
>
> On 04/24/2014 09:56 AM, Agustin Lobo wrote:
>> (follow up of previous message, I pressed enter as if I were in the R
>> session and sent the message...)
>>
>> On Wed, Apr 23, 2014 at 4:37 PM, Barry Rowlingson
>> <b.rowlingson at lancaster.ac.uk> wrote:
>>>  - I imagine the web services expect EPSG:4326.
>>
>> What they expect, yes. But what about what we retrieve? The bbox
>> coordinates might be in geographic coordinates (epsg:4326) but
>> the actual projection of the matrix could be any other. Actually, I
>> think that no geographic object without CRS information should be
>> admitted in R.
>>
>> In order to investigate this further, I've done the following:
>>
>> mibb <- matrix(c(-69.88634, -48.78450, -34.05533, -18.63424),byrow=TRUE,nrow=2)
>> delme <- get_map(location = mibb, maptype = "hybrid", source=
>> "google", crop = FALSE, zoom = 5)
>>
>> mgmap <- as.matrix(gmap)
>> vgmap <- as.vector(mgmap)
>> vgmaprgb <- col2rgb(vgmap)
>> gmapr <- matrix(vgmaprgb[1,],ncol=ncol(
>> mgmap),nrow=nrow(mgmap))
>> gmapg <- matrix(vgmaprgb[2,],ncol=ncol(mgmap),nrow=nrow(mgmap))
>> gmapb <- matrix(vgmaprgb[3,],ncol=ncol(mgmap),nrow=nrow(mgmap))
>> rgmaprgb <- brick(raster(gmapr),raster(gmapg),raster(gmapb))
>> projection(rgmaprgb) <- CRS("+init=epsg:4326")
>> extent(rgmaprgb) <- unlist(attr(gmap,which="bb"))[c(2,4,1,3)]
>> rgmaprgb
>> plotRGB(rgmaprgb)
>>
>> This looks good, but when I save as GTiff
>> writeRaster(rgmaprgb,file="rgmaprgb",format="GTiff",overwrite=TRUE,datatype="INT1U")
>>
>> and check with QGIS, there is a very significant shift versus the GM
>> layer that is downladed by plugin OpenLayers.
>>
>> Thus I worry that my overlay using rasterVis:levelplot and ggmap:
>> layer could actually be wrong as well.
>>
>> I'm going to test on a more local area and let you know.
>>
>> Agus
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> --
> Edzer Pebesma
> Institute for Geoinformatics (ifgi), University of M?nster
> Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
> 83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From b.rowlingson at lancaster.ac.uk  Thu Apr 24 15:52:54 2014
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Thu, 24 Apr 2014 14:52:54 +0100
Subject: [R-sig-Geo] projection of ggmap:get_map() output
In-Reply-To: <345780f75d2045169a2f656dd4fca6a9@EX-0-HT0.lancs.local>
References: <15399b6d75f748d28822ecdb366ebd84@EX-0-HT0.lancs.local>
	<CANVKczNLjyBAZ2y7FOvDP+c-ZSwABT_6BWK276uJJy=7MEew4w@mail.gmail.com>
	<CAG4NReLZfUtayt+koJvSZJAK1q_vNJAnJmQ_9GBtOc=X2uGqfw@mail.gmail.com>
	<CAG4NReJz-eq6GcGm=cQrMikz9VnhSu=HdpOyQHmB9PUK3e=Xpg@mail.gmail.com>
	<5358C986.9080309@uni-muenster.de>
	<345780f75d2045169a2f656dd4fca6a9@EX-0-HT0.lancs.local>
Message-ID: <CANVKczMKm4JqLbJ-bvJsEiGc+MdmLf7Fvzgc7NtebODOcRvY9g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140424/06457080/attachment.pl>

From alessandrosamuel at yahoo.com.br  Thu Apr 24 16:38:22 2014
From: alessandrosamuel at yahoo.com.br (Alessandro Samuel Rosa)
Date: Thu, 24 Apr 2014 07:38:22 -0700 (PDT)
Subject: [R-sig-Geo] Legend inside bubble plot
Message-ID: <1398350302.75527.YahooMailBasic@web141503.mail.bf1.yahoo.com>

Dear all,

I'd like to know if someone knows a easy way of putting the legend inside the sp::bubble plot like we can do with sp::spplot.

Best,

Alessandro Samuel-Rosa
---
Graduate School in Agronomy - Soil Science
Federal Rural University of Rio de Janeiro
Serop?dica, Rio de Janeiro, Brazil
---
Guest Researcher at ISRIC - World Soil Information
Wageningen, the Netherlands
---
Homepage: soil-scientist.net   Skype: alessandrosamuel


From jon.skoien at jrc.ec.europa.eu  Thu Apr 24 17:08:06 2014
From: jon.skoien at jrc.ec.europa.eu (Jon Olav Skoien)
Date: Thu, 24 Apr 2014 17:08:06 +0200
Subject: [R-sig-Geo] projection of ggmap:get_map() output
In-Reply-To: <CANVKczMKm4JqLbJ-bvJsEiGc+MdmLf7Fvzgc7NtebODOcRvY9g@mail.gmail.com>
References: <15399b6d75f748d28822ecdb366ebd84@EX-0-HT0.lancs.local>
	<CANVKczNLjyBAZ2y7FOvDP+c-ZSwABT_6BWK276uJJy=7MEew4w@mail.gmail.com>
	<CAG4NReLZfUtayt+koJvSZJAK1q_vNJAnJmQ_9GBtOc=X2uGqfw@mail.gmail.com>
	<CAG4NReJz-eq6GcGm=cQrMikz9VnhSu=HdpOyQHmB9PUK3e=Xpg@mail.gmail.com>
	<5358C986.9080309@uni-muenster.de>
	<345780f75d2045169a2f656dd4fca6a9@EX-0-HT0.lancs.local>
	<CANVKczMKm4JqLbJ-bvJsEiGc+MdmLf7Fvzgc7NtebODOcRvY9g@mail.gmail.com>
Message-ID: <535928D6.5000107@jrc.ec.europa.eu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140424/20ca1946/attachment.pl>

From agus.camacho at gmail.com  Thu Apr 24 17:47:23 2014
From: agus.camacho at gmail.com (Agus Camacho)
Date: Thu, 24 Apr 2014 12:47:23 -0300
Subject: [R-sig-Geo] Importing only lines from big shape file
Message-ID: <CALsJ7pTV+SBpgpkks2134+96i=iCAj=PD7S7FWNTkkD1y6abHQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140424/b97c0d97/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Thu Apr 24 17:58:48 2014
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Thu, 24 Apr 2014 16:58:48 +0100
Subject: [R-sig-Geo] Importing only lines from big shape file
In-Reply-To: <0069efed9eaa444da414165b4ec9275c@EX-1-HT0.lancs.local>
References: <0069efed9eaa444da414165b4ec9275c@EX-1-HT0.lancs.local>
Message-ID: <CANVKczNSYPsbdEd35dwZ+7HDcvy7a6uN0M+omahZ-2cDffjruQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140424/6bd9e9f5/attachment.pl>

From j.garcia-pintado at reading.ac.uk  Thu Apr 24 18:02:27 2014
From: j.garcia-pintado at reading.ac.uk (Javier Garcia-Pintado)
Date: Thu, 24 Apr 2014 16:02:27 +0000
Subject: [R-sig-Geo] Importing only lines from big shape file
In-Reply-To: <CANVKczNSYPsbdEd35dwZ+7HDcvy7a6uN0M+omahZ-2cDffjruQ@mail.gmail.com>
References: <0069efed9eaa444da414165b4ec9275c@EX-1-HT0.lancs.local>,
	<CANVKczNSYPsbdEd35dwZ+7HDcvy7a6uN0M+omahZ-2cDffjruQ@mail.gmail.com>
Message-ID: <E82BBC061BBD7448BC7905721F497B077020700F@vime-mbx5.rdg.ac.uk>

A possibility is, if you are interested in some specific area of the mata atlantica, to crop the file externally with OGR just for your study area, and read the cropped file into R.

Javier
---
__________
From: r-sig-geo-bounces at r-project.org [r-sig-geo-bounces at r-project.org] on behalf of Barry Rowlingson [b.rowlingson at lancaster.ac.uk]
Sent: 24 April 2014 16:58
To: Agus Camacho
Cc: r-sig-geo
Subject: Re: [R-sig-Geo] Importing only lines from big shape file

On Thu, Apr 24, 2014 at 4:47 PM, Agus Camacho <agus.camacho at gmail.com>wrote:

> Dear Rgeos,
>
> Id like to know if there is some workaround to import  the lines contained
> by a shape file, avoiding memory problems when the only thing you need is
> the lines it contains.
>
> I mean, reading the lines of the world's coast lines can be done in a
> instant with:
>
> wcoastline <- PBSmapping::importShapefile("GSHHS_c_L1.shp")#
>
> However, reading a relatively small region, like the brazilian atlantic
> forest, seems impossible for my little laptop.  I tried all of these
> possibilities.
>
> AF=PBSmapping::importShapefile("mata_atlantica.shp")
> AF=rgdal::readOGR("dir",layer="mata_atlantica")
> AF=shapefiles::read.shp("mata_atlantica.shp")
>
> Any hint would be very welcome.
>

 Ummm not sure this makes sense. You can read all the coastlines, but not
some of the coastlines?

 Are the mata_atlantica  files bigger because they are more detailed?
Sometimes global data is generalized.

 Show us the size in bytes of the files...

Barry

        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From agus.camacho at gmail.com  Thu Apr 24 18:28:21 2014
From: agus.camacho at gmail.com (Agus Camacho)
Date: Thu, 24 Apr 2014 13:28:21 -0300
Subject: [R-sig-Geo] Importing only lines from big shape file
In-Reply-To: <E82BBC061BBD7448BC7905721F497B077020700F@vime-mbx5.rdg.ac.uk>
References: <0069efed9eaa444da414165b4ec9275c@EX-1-HT0.lancs.local>
	<CANVKczNSYPsbdEd35dwZ+7HDcvy7a6uN0M+omahZ-2cDffjruQ@mail.gmail.com>
	<E82BBC061BBD7448BC7905721F497B077020700F@vime-mbx5.rdg.ac.uk>
Message-ID: <CALsJ7pR75iQCSst+vZ0zM+db-FTwxbJ3fvJgQ8Q0U5sqiOzHYg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140424/b00c2002/attachment.pl>

From Roger.Bivand at nhh.no  Thu Apr 24 18:47:54 2014
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 24 Apr 2014 18:47:54 +0200
Subject: [R-sig-Geo] Importing only lines from big shape file
In-Reply-To: <CALsJ7pR75iQCSst+vZ0zM+db-FTwxbJ3fvJgQ8Q0U5sqiOzHYg@mail.gmail.com>
References: <0069efed9eaa444da414165b4ec9275c@EX-1-HT0.lancs.local>
	<CANVKczNSYPsbdEd35dwZ+7HDcvy7a6uN0M+omahZ-2cDffjruQ@mail.gmail.com>
	<E82BBC061BBD7448BC7905721F497B077020700F@vime-mbx5.rdg.ac.uk>
	<CALsJ7pR75iQCSst+vZ0zM+db-FTwxbJ3fvJgQ8Q0U5sqiOzHYg@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1404241839220.11612@reclus.nhh.no>

On Thu, 24 Apr 2014, Agus Camacho wrote:

> Thanks for the fast response,
>
> @ Barry
> The .shp file is 420,241KB, the .shx is 6,994KB and the .dbf is 1,729,941KB.
> @ Javier, id like to use the whole region.

But you'll never be able to render the detail in this coastline anyway. 
Why not just use maptools::Rgshhs with the intermediate binary dataset, 
setting a sensible bounding box? I've had trouble with the newest fine 
data set and with the equivalent 2.3.0 shapefile (missing Norwegian 
islands), but an older version (2.1.0) was fine.

Roger


>
> Might be any easy way to reduce the number of vertex previously to import?
>
> These shape files are available at:
> http://mapas.mma.gov.br/mapas/aplic/probio/datadownload.htm
>
>
>
>
>
>
>
>
> 2014-04-24 13:02 GMT-03:00 Javier Garcia-Pintado <
> j.garcia-pintado at reading.ac.uk>:
>
>> A possibility is, if you are interested in some specific area of the mata
>> atlantica, to crop the file externally with OGR just for your study area,
>> and read the cropped file into R.
>>
>> Javier
>> ---
>> __________
>> From: r-sig-geo-bounces at r-project.org [r-sig-geo-bounces at r-project.org]
>> on behalf of Barry Rowlingson [b.rowlingson at lancaster.ac.uk]
>> Sent: 24 April 2014 16:58
>> To: Agus Camacho
>> Cc: r-sig-geo
>> Subject: Re: [R-sig-Geo] Importing only lines from big shape file
>>
>> On Thu, Apr 24, 2014 at 4:47 PM, Agus Camacho <agus.camacho at gmail.com
>>> wrote:
>>
>>> Dear Rgeos,
>>>
>>> Id like to know if there is some workaround to import  the lines
>> contained
>>> by a shape file, avoiding memory problems when the only thing you need is
>>> the lines it contains.
>>>
>>> I mean, reading the lines of the world's coast lines can be done in a
>>> instant with:
>>>
>>> wcoastline <- PBSmapping::importShapefile("GSHHS_c_L1.shp")#
>>>
>>> However, reading a relatively small region, like the brazilian atlantic
>>> forest, seems impossible for my little laptop.  I tried all of these
>>> possibilities.
>>>
>>> AF=PBSmapping::importShapefile("mata_atlantica.shp")
>>> AF=rgdal::readOGR("dir",layer="mata_atlantica")
>>> AF=shapefiles::read.shp("mata_atlantica.shp")
>>>
>>> Any hint would be very welcome.
>>>
>>
>>  Ummm not sure this makes sense. You can read all the coastlines, but not
>> some of the coastlines?
>>
>>  Are the mata_atlantica  files bigger because they are more detailed?
>> Sometimes global data is generalized.
>>
>>  Show us the size in bytes of the files...
>>
>> Barry
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From agus.camacho at gmail.com  Thu Apr 24 19:07:14 2014
From: agus.camacho at gmail.com (Agus Camacho)
Date: Thu, 24 Apr 2014 14:07:14 -0300
Subject: [R-sig-Geo] Importing only lines from big shape file
In-Reply-To: <alpine.LRH.2.03.1404241839220.11612@reclus.nhh.no>
References: <0069efed9eaa444da414165b4ec9275c@EX-1-HT0.lancs.local>
	<CANVKczNSYPsbdEd35dwZ+7HDcvy7a6uN0M+omahZ-2cDffjruQ@mail.gmail.com>
	<E82BBC061BBD7448BC7905721F497B077020700F@vime-mbx5.rdg.ac.uk>
	<CALsJ7pR75iQCSst+vZ0zM+db-FTwxbJ3fvJgQ8Q0U5sqiOzHYg@mail.gmail.com>
	<alpine.LRH.2.03.1404241839220.11612@reclus.nhh.no>
Message-ID: <CALsJ7pRMu+b6GP8S+rt7VoZaZHyadWVQZ1ENg6H97d8o0zGigA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140424/ae09dd05/attachment.pl>

From agus.camacho at gmail.com  Thu Apr 24 19:10:25 2014
From: agus.camacho at gmail.com (Agus Camacho)
Date: Thu, 24 Apr 2014 14:10:25 -0300
Subject: [R-sig-Geo] Importing only lines from big shape file
In-Reply-To: <CALsJ7pRMu+b6GP8S+rt7VoZaZHyadWVQZ1ENg6H97d8o0zGigA@mail.gmail.com>
References: <0069efed9eaa444da414165b4ec9275c@EX-1-HT0.lancs.local>
	<CANVKczNSYPsbdEd35dwZ+7HDcvy7a6uN0M+omahZ-2cDffjruQ@mail.gmail.com>
	<E82BBC061BBD7448BC7905721F497B077020700F@vime-mbx5.rdg.ac.uk>
	<CALsJ7pR75iQCSst+vZ0zM+db-FTwxbJ3fvJgQ8Q0U5sqiOzHYg@mail.gmail.com>
	<alpine.LRH.2.03.1404241839220.11612@reclus.nhh.no>
	<CALsJ7pRMu+b6GP8S+rt7VoZaZHyadWVQZ1ENg6H97d8o0zGigA@mail.gmail.com>
Message-ID: <CALsJ7pSg_orbMRsReX4xp+rfcxvjc67=oVKsFKEivBRqvFKo4w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140424/e9bf2a48/attachment.pl>

From Roger.Bivand at nhh.no  Thu Apr 24 19:23:56 2014
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 24 Apr 2014 19:23:56 +0200
Subject: [R-sig-Geo] Importing only lines from big shape file
In-Reply-To: <CALsJ7pSg_orbMRsReX4xp+rfcxvjc67=oVKsFKEivBRqvFKo4w@mail.gmail.com>
References: <0069efed9eaa444da414165b4ec9275c@EX-1-HT0.lancs.local>
	<CANVKczNSYPsbdEd35dwZ+7HDcvy7a6uN0M+omahZ-2cDffjruQ@mail.gmail.com>
	<E82BBC061BBD7448BC7905721F497B077020700F@vime-mbx5.rdg.ac.uk>
	<CALsJ7pR75iQCSst+vZ0zM+db-FTwxbJ3fvJgQ8Q0U5sqiOzHYg@mail.gmail.com>
	<alpine.LRH.2.03.1404241839220.11612@reclus.nhh.no>
	<CALsJ7pRMu+b6GP8S+rt7VoZaZHyadWVQZ1ENg6H97d8o0zGigA@mail.gmail.com>
	<CALsJ7pSg_orbMRsReX4xp+rfcxvjc67=oVKsFKEivBRqvFKo4w@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1404241913350.11612@reclus.nhh.no>

On Thu, 24 Apr 2014, Agus Camacho wrote:

> I think i might have not made myself clear in first place:
>
> I want the lines from mata_atlantica.shp, but those are much more than
> shorelines.
> They are inland polygons.

Then you'll need a machine with a lot of memory. The URL you gave does not 
lead to any single shapefile, but to:

/mata_atlantica/dados/shape_file/folhas

and folders recortes_elim and recortes_9x9_MA, both of which include many 
shapefiles.

The key question is why you need to read detailed boundary data into R, 
and we do not know the answer. If there are inland polygons, then GSHHS 
will not help.

Roger

>
> thanks
>
>
> 2014-04-24 14:07 GMT-03:00 Agus Camacho <agus.camacho at gmail.com>:
>
>> Thanks Roger,
>>
>> I didnt get what you mean with the intermediate binary dataset, you mean
>> the mata_atlantica.shp file (420,241KB)?
>>
>> I tried maptools::Rgshhs and also getRgshhsMap but got the error:
>>
>> Error in Rgshhs(fn, xlim = xl.west, ylim = ylim, shift = shift, level =
>> level,  :
>>   Data not same version as software
>>
>>
>>
>> 2014-04-24 13:47 GMT-03:00 Roger Bivand <Roger.Bivand at nhh.no>:
>>
>> On Thu, 24 Apr 2014, Agus Camacho wrote:
>>>
>>>  Thanks for the fast response,
>>>>
>>>> @ Barry
>>>> The .shp file is 420,241KB, the .shx is 6,994KB and the .dbf is
>>>> 1,729,941KB.
>>>> @ Javier, id like to use the whole region.
>>>>
>>>
>>> But you'll never be able to render the detail in this coastline anyway.
>>> Why not just use maptools::Rgshhs with the intermediate binary dataset,
>>> setting a sensible bounding box? I've had trouble with the newest fine data
>>> set and with the equivalent 2.3.0 shapefile (missing Norwegian islands),
>>> but an older version (2.1.0) was fine.
>>>
>>> Roger
>>>
>>>
>>>
>>>
>>>> Might be any easy way to reduce the number of vertex previously to
>>>> import?
>>>>
>>>> These shape files are available at:
>>>> http://mapas.mma.gov.br/mapas/aplic/probio/datadownload.htm
>>>>
>>>>
>>>>
>>>>
>>>>
>>>>
>>>>
>>>>
>>>> 2014-04-24 13:02 GMT-03:00 Javier Garcia-Pintado <
>>>> j.garcia-pintado at reading.ac.uk>:
>>>>
>>>>  A possibility is, if you are interested in some specific area of the
>>>>> mata
>>>>> atlantica, to crop the file externally with OGR just for your study
>>>>> area,
>>>>> and read the cropped file into R.
>>>>>
>>>>> Javier
>>>>> ---
>>>>> __________
>>>>> From: r-sig-geo-bounces at r-project.org [r-sig-geo-bounces at r-project.org]
>>>>> on behalf of Barry Rowlingson [b.rowlingson at lancaster.ac.uk]
>>>>> Sent: 24 April 2014 16:58
>>>>> To: Agus Camacho
>>>>> Cc: r-sig-geo
>>>>> Subject: Re: [R-sig-Geo] Importing only lines from big shape file
>>>>>
>>>>> On Thu, Apr 24, 2014 at 4:47 PM, Agus Camacho <agus.camacho at gmail.com
>>>>>
>>>>>> wrote:
>>>>>>
>>>>>
>>>>>  Dear Rgeos,
>>>>>>
>>>>>> Id like to know if there is some workaround to import  the lines
>>>>>>
>>>>> contained
>>>>>
>>>>>> by a shape file, avoiding memory problems when the only thing you need
>>>>>> is
>>>>>> the lines it contains.
>>>>>>
>>>>>> I mean, reading the lines of the world's coast lines can be done in a
>>>>>> instant with:
>>>>>>
>>>>>> wcoastline <- PBSmapping::importShapefile("GSHHS_c_L1.shp")#
>>>>>>
>>>>>> However, reading a relatively small region, like the brazilian atlantic
>>>>>> forest, seems impossible for my little laptop.  I tried all of these
>>>>>> possibilities.
>>>>>>
>>>>>> AF=PBSmapping::importShapefile("mata_atlantica.shp")
>>>>>> AF=rgdal::readOGR("dir",layer="mata_atlantica")
>>>>>> AF=shapefiles::read.shp("mata_atlantica.shp")
>>>>>>
>>>>>> Any hint would be very welcome.
>>>>>>
>>>>>>
>>>>>  Ummm not sure this makes sense. You can read all the coastlines, but
>>>>> not
>>>>> some of the coastlines?
>>>>>
>>>>>  Are the mata_atlantica  files bigger because they are more detailed?
>>>>> Sometimes global data is generalized.
>>>>>
>>>>>  Show us the size in bytes of the files...
>>>>>
>>>>> Barry
>>>>>
>>>>>         [[alternative HTML version deleted]]
>>>>>
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>
>>>>>
>>>>
>>>>
>>>>
>>>>
>>> --
>>> Roger Bivand
>>> Department of Economics, Norwegian School of Economics,
>>> Helleveien 30, N-5045 Bergen, Norway.
>>> voice: +47 55 95 93 55; fax +47 55 95 91 00
>>> e-mail: Roger.Bivand at nhh.no
>>>
>>>
>>
>>
>> --
>> Agust?n Camacho Guerrero.
>> Doutor em Zoologia.
>> Laborat?rio de Herpetologia, Departamento de Zoologia, Instituto de
>> Bioci?ncias, USP.
>> Rua do Mat?o, trav. 14, n? 321, Cidade Universit?ria,
>> S?o Paulo - SP, CEP: 05508-090, Brasil.
>>
>
>
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no

From edzer.pebesma at uni-muenster.de  Thu Apr 24 20:00:05 2014
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 24 Apr 2014 20:00:05 +0200
Subject: [R-sig-Geo] projection of ggmap:get_map() output
In-Reply-To: <CANVKczMKm4JqLbJ-bvJsEiGc+MdmLf7Fvzgc7NtebODOcRvY9g@mail.gmail.com>
References: <15399b6d75f748d28822ecdb366ebd84@EX-0-HT0.lancs.local>	<CANVKczNLjyBAZ2y7FOvDP+c-ZSwABT_6BWK276uJJy=7MEew4w@mail.gmail.com>	<CAG4NReLZfUtayt+koJvSZJAK1q_vNJAnJmQ_9GBtOc=X2uGqfw@mail.gmail.com>	<CAG4NReJz-eq6GcGm=cQrMikz9VnhSu=HdpOyQHmB9PUK3e=Xpg@mail.gmail.com>	<5358C986.9080309@uni-muenster.de>	<345780f75d2045169a2f656dd4fca6a9@EX-0-HT0.lancs.local>
	<CANVKczMKm4JqLbJ-bvJsEiGc+MdmLf7Fvzgc7NtebODOcRvY9g@mail.gmail.com>
Message-ID: <53595125.60606@uni-muenster.de>



On 04/24/2014 03:52 PM, Barry Rowlingson wrote:
> So do you mean (and I've not tried your code yet, sorry) that the
> corners may well be at the given lat-long points but half way along any
> edge might not be at the halfway-point in lat-long?

Indeed:

library(ggmap)
ggmap(get_map(matrix(c(-10,20,40,80),2,2)))

and look at the tics along the y-axis: they're not linear, neither are
they drawn by google (at least, they're not on the ggmapTemp.png file
written).

http://journal.r-project.org/archive/2013-1/kahle-wickham.pdf

mention on p. 146 that "... the coordinate system is ?xed to the
Mercator projection."

> 
> if you convert the bbox coords to epsg:3857 then maybe you have a
> correctly projected raster in those coordinates?

The google API wants long/lat in WGS84, and what gets returned has a
different bbox anyway, but I believe that a long/lat aligned "box" in
WGS84 remains a box in Mercator.

> 
> I've avoided ggmap et al because I've been unconvinced about their
> geographic rigour vs their prettiness....
> 
> 
> 
> 
> 
> On Thu, Apr 24, 2014 at 12:43 PM, Agustin Lobo <alobolistas at gmail.com
> <mailto:alobolistas at gmail.com>> wrote:
> 
>     But the fact that the output of get_map() includes the bounding box in
>     geographic
>     coordinates (epsg:4326) does not imply that the matrix is on the same
>     projection.
>     This should be specified.
>     I can provide you a utm raster along with bounding box coordinates in
>     geographic coordinates (epsg:4326).
>     Actually, according to the code I just showed, it is not clear at all
>     that the matrix provided
>     in the ggmap "raster" object is in epsg:4326.
> 
>     Agus
> 
> 
> 
>     On Thu, Apr 24, 2014 at 10:21 AM, Edzer Pebesma
>     <edzer.pebesma at uni-muenster.de
>     <mailto:edzer.pebesma at uni-muenster.de>> wrote:
>     > EPSG:4326, or WGS84, is only one way to refer to places on the
>     earth by
>     > longitudes and latitudes; it seems that google maps come in a Mercator
>     > projection, EPSG:3857, read e.g. this:
>     >
>     > http://docs.openlayers.org/library/spherical_mercator.html
>     >
>     > or
>     >
>     >
>     https://developers.google.com/maps/documentation/javascript/maptypes#MapCoordinates
>     >
>     > Iliffe and Lott: Datums and Map Projections: For Remote Sensing,
>     GIS and
>     > Surveying
>     >
>     > provide an excellent explanation on what goes on here, including what
>     > google maps does.
>     >
>     > On 04/24/2014 09:56 AM, Agustin Lobo wrote:
>     >> (follow up of previous message, I pressed enter as if I were in the R
>     >> session and sent the message...)
>     >>
>     >> On Wed, Apr 23, 2014 at 4:37 PM, Barry Rowlingson
>     >> <b.rowlingson at lancaster.ac.uk
>     <mailto:b.rowlingson at lancaster.ac.uk>> wrote:
>     >>>  - I imagine the web services expect EPSG:4326.
>     >>
>     >> What they expect, yes. But what about what we retrieve? The bbox
>     >> coordinates might be in geographic coordinates (epsg:4326) but
>     >> the actual projection of the matrix could be any other. Actually, I
>     >> think that no geographic object without CRS information should be
>     >> admitted in R.
>     >>
>     >> In order to investigate this further, I've done the following:
>     >>
>     >> mibb <- matrix(c(-69.88634, -48.78450, -34.05533,
>     -18.63424),byrow=TRUE,nrow=2)
>     >> delme <- get_map(location = mibb, maptype = "hybrid", source=
>     >> "google", crop = FALSE, zoom = 5)
>     >>
>     >> mgmap <- as.matrix(gmap)
>     >> vgmap <- as.vector(mgmap)
>     >> vgmaprgb <- col2rgb(vgmap)
>     >> gmapr <- matrix(vgmaprgb[1,],ncol=ncol(
>     >> mgmap),nrow=nrow(mgmap))
>     >> gmapg <- matrix(vgmaprgb[2,],ncol=ncol(mgmap),nrow=nrow(mgmap))
>     >> gmapb <- matrix(vgmaprgb[3,],ncol=ncol(mgmap),nrow=nrow(mgmap))
>     >> rgmaprgb <- brick(raster(gmapr),raster(gmapg),raster(gmapb))
>     >> projection(rgmaprgb) <- CRS("+init=epsg:4326")
>     >> extent(rgmaprgb) <- unlist(attr(gmap,which="bb"))[c(2,4,1,3)]
>     >> rgmaprgb
>     >> plotRGB(rgmaprgb)
>     >>
>     >> This looks good, but when I save as GTiff
>     >>
>     writeRaster(rgmaprgb,file="rgmaprgb",format="GTiff",overwrite=TRUE,datatype="INT1U")
>     >>
>     >> and check with QGIS, there is a very significant shift versus the GM
>     >> layer that is downladed by plugin OpenLayers.
>     >>
>     >> Thus I worry that my overlay using rasterVis:levelplot and ggmap:
>     >> layer could actually be wrong as well.
>     >>
>     >> I'm going to test on a more local area and let you know.
>     >>
>     >> Agus
>     >>
>     >> _______________________________________________
>     >> R-sig-Geo mailing list
>     >> R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>     >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>     >>
>     >
>     > --
>     > Edzer Pebesma
>     > Institute for Geoinformatics (ifgi), University of M?nster
>     > Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
>     > 83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795
>     >
>     >
>     > _______________________________________________
>     > R-sig-Geo mailing list
>     > R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>     > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>     >
> 
>     _______________________________________________
>     R-sig-Geo mailing list
>     R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>     https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140424/abae40c4/attachment.bin>

From tkeitt at utexas.edu  Thu Apr 24 23:07:43 2014
From: tkeitt at utexas.edu (Tim Keitt)
Date: Thu, 24 Apr 2014 16:07:43 -0500
Subject: [R-sig-Geo] Importing only lines from big shape file
In-Reply-To: <CALsJ7pTV+SBpgpkks2134+96i=iCAj=PD7S7FWNTkkD1y6abHQ@mail.gmail.com>
References: <CALsJ7pTV+SBpgpkks2134+96i=iCAj=PD7S7FWNTkkD1y6abHQ@mail.gmail.com>
Message-ID: <CANnL8gqoKac1OfJBZzfOsXkK+t-O+UQT3k8Rx5NMSmLAdovyvw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140424/2c80dd38/attachment.pl>

From HodgessE at uhd.edu  Fri Apr 25 05:28:09 2014
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Fri, 25 Apr 2014 03:28:09 +0000
Subject: [R-sig-Geo] trouble with makegrid
Message-ID: <FF9DB805FC41CC4E95825A50F680630217B72B64@columbia.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140425/aa6cdbaf/attachment.pl>

From momadou at yahoo.fr  Fri Apr 25 10:08:05 2014
From: momadou at yahoo.fr (Komine)
Date: Fri, 25 Apr 2014 01:08:05 -0700 (PDT)
Subject: [R-sig-Geo] Legend of map
Message-ID: <1398413285053-7586282.post@n2.nabble.com>

Dear all, 

I used this code to plot a map. 

>library(raster) 
>Biomasse<-rasterFromXYZ(tab) 
>PlotBio<-plot(Biomass) 
>PlotBio<-plot(Biomass,col=(topo.colors(100)),legend=TRUE,cex.axis=0.8,adj=1) 
>plot(Biomass,legend.only=TRUE,col=(topo.colors(100)),legend.args=list(text="Biomass(Kg/ha)",side=3,line=2,cex=0.8))
 
However I have both problems. 

1-The title of legend overflows on the map, so I want that the title of the
legend moves to right. For this I used ?adj=1?, but the problem is not
resolved.  
 2-I want also to reduce the size of the labels of legend (graduation). I
used ?cex.axis? but the size don?t change.
 
Thank you for your assistance 
Komine 




--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Legend-of-map-tp7586282.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From kridox at ymail.com  Fri Apr 25 10:09:52 2014
From: kridox at ymail.com (Pascal Oettli)
Date: Fri, 25 Apr 2014 17:09:52 +0900
Subject: [R-sig-Geo] trouble with makegrid
In-Reply-To: <FF9DB805FC41CC4E95825A50F680630217B72B64@columbia.uhd.campus>
References: <FF9DB805FC41CC4E95825A50F680630217B72B64@columbia.uhd.campus>
Message-ID: <CAAcyNCyQB03+ogJaq1WxNYFhdnWY8buYJQPAKgdCHAEydzbTDw@mail.gmail.com>

Hello Erin,

Your example is not reproducible.

Regards,
Pascal

On Fri, Apr 25, 2014 at 12:28 PM, Hodgess, Erin <HodgessE at uhd.edu> wrote:
> Hi everyone!
>
> I have been using makegrid and it worked fine.  Until tonight.  I upgraded to R-3.1.0 on my Ubuntu, and am using plotKML and gstat from R-Forge.
>
> Here is my new snag:
>
>> u2 <- SpatialPoints(makegrid(texb,n=800))
> Warning message:
> In makegrid(texb, n = 800) : NaNs produced
> Error in coordinates(coords) :
>   error in evaluating the argument 'obj' in selecting a method for function 'coordinates': Error in if (any(sel)) min.coords[sel] = min.coords[sel] - cellsize[sel] :
>   missing value where TRUE/FALSE needed
>>
>
> It worked fine this morning.
>
> What went wrong, please?
>
> Thanks,
> Erin
>
>
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Pascal Oettli
Project Scientist
JAMSTEC
Yokohama, Japan


From oscar.perpinan at upm.es  Fri Apr 25 12:13:23 2014
From: oscar.perpinan at upm.es (=?UTF-8?Q?Oscar_Perpi=C3=B1an?=)
Date: Fri, 25 Apr 2014 12:13:23 +0200
Subject: [R-sig-Geo] projection of ggmap:get_map() output
In-Reply-To: <53595125.60606@uni-muenster.de>
References: <15399b6d75f748d28822ecdb366ebd84@EX-0-HT0.lancs.local>
	<CANVKczNLjyBAZ2y7FOvDP+c-ZSwABT_6BWK276uJJy=7MEew4w@mail.gmail.com>
	<CAG4NReLZfUtayt+koJvSZJAK1q_vNJAnJmQ_9GBtOc=X2uGqfw@mail.gmail.com>
	<CAG4NReJz-eq6GcGm=cQrMikz9VnhSu=HdpOyQHmB9PUK3e=Xpg@mail.gmail.com>
	<5358C986.9080309@uni-muenster.de>
	<345780f75d2045169a2f656dd4fca6a9@EX-0-HT0.lancs.local>
	<CANVKczMKm4JqLbJ-bvJsEiGc+MdmLf7Fvzgc7NtebODOcRvY9g@mail.gmail.com>
	<53595125.60606@uni-muenster.de>
Message-ID: <CAMLL7bn87AhW-v=C5yhEZJ7ANVMRQUhg2LDtFgPBGLJu6XKXTA@mail.gmail.com>

> On 04/24/2014 03:52 PM, Barry Rowlingson wrote:
>> So do you mean (and I've not tried your code yet, sorry) that the
>> corners may well be at the given lat-long points but half way along any
>> edge might not be at the halfway-point in lat-long?
> Indeed:
>
> library(ggmap)
> ggmap(get_map(matrix(c(-10,20,40,80),2,2)))
>
> and look at the tics along the y-axis: they're not linear, neither are
> they drawn by google (at least, they're not on the ggmapTemp.png file
> written).
>
> http://journal.r-project.org/archive/2013-1/kahle-wickham.pdf
>
> mention on p. 146 that "... the coordinate system is ?xed to the
> Mercator projection."

Just as additional confirmation: inspecting the code, ggmap uses the
mercator projection for displaying the "raster":
https://github.com/dkahle/ggmap/blob/master/R/ggmap.R#L562

>> if you convert the bbox coords to epsg:3857 then maybe you have a
>> correctly projected raster in those coordinates?
> The google API wants long/lat in WGS84, and what gets returned has a
> different bbox anyway, but I believe that a long/lat aligned "box" in
> WGS84 remains a box in Mercator.

I have been playing with code to show the differences. If my code is
correct, the differences are very small, at least for the bounding box
I have chosen:

library(geosphere) ## provides a mercator function

## Bounding box: lower-left and upper-right
ll <- c(-10, 30)
ur <- c(10, 50)
## Bounding box in mercator projection
llxy <- mercator(ll)
urxy <- mercator(ur)

## Matrix of coordinates in mercator projection
xy <- expand.grid(x=seq(llxy[1], urxy[1], length=100),
                  y=seq(llxy[2], urxy[2], length=100))

## Matrix of lon-lat values using bounding box
lonlat <- expand.grid(x=seq(ll[1], ur[1], length=100),
                  y=seq(ll[2], ur[2], length=100))

## Mercator coordinates using matrix of lon-lat
xyproj <- mercator(lonlat)

## Differences between xy and xyproj
dif <- 1 - xyproj/xy
names(dif) <- paste0('dif', names(dif))
summary(dif)

library(lattice)
difXY <- cbind(xy, dif)
levelplot(difx + dify ~ x*y, data=difXY)

>> I've avoided ggmap et al because I've been unconvinced about their
>> geographic rigour vs their prettiness....

IMHO ggmap and friends are useful only when you need an easy way to
add an attractive context or "decorative" material to a graphic.

Best,

Oscar.


From annajess at gmx.de  Fri Apr 25 14:15:57 2014
From: annajess at gmx.de (Anna-Marie Corman)
Date: Fri, 25 Apr 2014 14:15:57 +0200
Subject: [R-sig-Geo] kerneloverlaphr and BRB
Message-ID: <535A51FD.7040703@gmx.de>

Dear all,

I apologize in advance for any stupid question. But I am completeIy new 
in this kind of analyses and confused with some of the necessary input 
parameters...
I want to compare my BRB outputs of different individuals (gulls) from 
DIFFERENT COLONIES (i.e. single breeding colonies are about 5 to 160 km 
away (beeline) from each other) by calculating their volume of 
intersection with kerneloverlaphr.
Seems as if I  don't really understand the grid and extent option within 
the BRB command. Increasing the grid means increasing resolution, 
doesn't it? But what does increasing of the extent mean at the same time?

I need to use the same grid for all individuals to calculate the 
overlap, right? The problem is to find the right grid for all 
colonies/individuals.
Additionally, the output of kernel.area always differs when I use other 
grids and extents and I often get the following error message:

"The grid is too small to allow the estimation of home-range for the 
following value of percent: 
20,25,30,35,40,45,50,55,60,65,70,75,80,85,90,95. You should rerun 
kernelUD with a larger extent parameter."

Why are the areas not the same irrespective of the grid size?

Is it just not possible to calculate the overlap of individuals from 
different colonies?

Hope, anyone can help me out of this confusion.

Thanks a lot in advance,
Anna


From alobolistas at gmail.com  Fri Apr 25 15:55:56 2014
From: alobolistas at gmail.com (Agustin Lobo)
Date: Fri, 25 Apr 2014 15:55:56 +0200
Subject: [R-sig-Geo] projection of ggmap:get_map() output
In-Reply-To: <CAMLL7bn87AhW-v=C5yhEZJ7ANVMRQUhg2LDtFgPBGLJu6XKXTA@mail.gmail.com>
References: <15399b6d75f748d28822ecdb366ebd84@EX-0-HT0.lancs.local>
	<CANVKczNLjyBAZ2y7FOvDP+c-ZSwABT_6BWK276uJJy=7MEew4w@mail.gmail.com>
	<CAG4NReLZfUtayt+koJvSZJAK1q_vNJAnJmQ_9GBtOc=X2uGqfw@mail.gmail.com>
	<CAG4NReJz-eq6GcGm=cQrMikz9VnhSu=HdpOyQHmB9PUK3e=Xpg@mail.gmail.com>
	<5358C986.9080309@uni-muenster.de>
	<345780f75d2045169a2f656dd4fca6a9@EX-0-HT0.lancs.local>
	<CANVKczMKm4JqLbJ-bvJsEiGc+MdmLf7Fvzgc7NtebODOcRvY9g@mail.gmail.com>
	<53595125.60606@uni-muenster.de>
	<CAMLL7bn87AhW-v=C5yhEZJ7ANVMRQUhg2LDtFgPBGLJu6XKXTA@mail.gmail.com>
Message-ID: <CAG4NReLf4Xg5-SvJgemMxhif=6-fnm_n6842ofvV27W0Y3R7Ug@mail.gmail.com>

According to the results
https://dl.dropboxusercontent.com/u/3180464/ggmap_GM_compare.odp
of the code below, the matrix downloaded by get_map() is on epsg:3857,
the so-called
Google Pseudo Mercator, while the bounding box is given in epsg:4326
coordinates.
The odp file shows the raster as created by the code below out of a
get_map() command,
and the same area displayed by plugin OpenLayers.
Note there is still a bit of shift/distortion between the 2 when you
compare alternatively,
but this is much less than what I had assuming get_map() was
downloading in epsg:4326

mibb <- matrix(c(-69.88634, -48.78450, -34.05533, -18.63424),byrow=TRUE,nrow=2)
gmap <- get_map(location = mibb, maptype = "hybrid", source= "google",
crop = FALSE, zoom = 5)

# Make a raster brick object from gmap
mgmap <- as.matrix(gmap)
vgmap <- as.vector(mgmap)
vgmaprgb <- col2rgb(vgmap)
gmapr <- matrix(vgmaprgb[1,],ncol=ncol(mgmap),nrow=nrow(mgmap))
gmapg <- matrix(vgmaprgb[2,],ncol=ncol(mgmap),nrow=nrow(mgmap))
gmapb <- matrix(vgmaprgb[3,],ncol=ncol(mgmap),nrow=nrow(mgmap))
rgmaprgb <- brick(raster(gmapr),raster(gmapg),raster(gmapb))

#version in "Google PseudoMercator" epsg:3857
rgmaprgbGM <- rgmaprgb
projection(rgmaprgbGM) <- CRS("+init=epsg:3857")
#We have to find out the extent in the units of the new projection
unlist(attr(gmap,which="bb"))[c(2,4,1,3)]
rprobextSpDF <- as(extent(unlist(attr(gmap,which="bb"))[c(2,4,1,3)]),
"SpatialPolygons")
projection(rprobextSpDF) <- CRS("+init=epsg:4326")
rprobextGM <- spTransform(rprobextSpDF,CRS("+init=epsg:3857"))
rprobextGM at bbox
extent(rgmaprgbGM) <- c(rprobextGM at bbox[1,],rprobextGM at bbox[2,])
rgmaprgbGM
plotRGB(rgmaprgbGM)
writeRaster(rgmaprgbGM,file="rgmaprgbGM",format="GTiff",overwrite=TRUE,datatype="INT1U")

I therefore think that overlaying layers using levelplot() + layer()
might have to be done with the user's layers
in epsg:4326, but I'll confirm soon. It could be as well that ggmap
reprojects from 4326 to 3857.
The query for get_map() must be done in epsg:4326, though, that's for sure.

ggmap should specify the projection of the object retrieved by
get_map(). The mentions you find to "mercator" are not unambiguous, as
"mercator" is not one projection but a projection family.

Geo-graphics must be pretty **and** exact.

Agus

On Fri, Apr 25, 2014 at 12:13 PM, Oscar Perpi?an <oscar.perpinan at upm.es> wrote:
>> On 04/24/2014 03:52 PM, Barry Rowlingson wrote:
>>> So do you mean (and I've not tried your code yet, sorry) that the
>>> corners may well be at the given lat-long points but half way along any
>>> edge might not be at the halfway-point in lat-long?
>> Indeed:
>>
>> library(ggmap)
>> ggmap(get_map(matrix(c(-10,20,40,80),2,2)))
>>
>> and look at the tics along the y-axis: they're not linear, neither are
>> they drawn by google (at least, they're not on the ggmapTemp.png file
>> written).
>>
>> http://journal.r-project.org/archive/2013-1/kahle-wickham.pdf
>>
>> mention on p. 146 that "... the coordinate system is ?xed to the
>> Mercator projection."
>
> Just as additional confirmation: inspecting the code, ggmap uses the
> mercator projection for displaying the "raster":
> https://github.com/dkahle/ggmap/blob/master/R/ggmap.R#L562
>
>>> if you convert the bbox coords to epsg:3857 then maybe you have a
>>> correctly projected raster in those coordinates?
>> The google API wants long/lat in WGS84, and what gets returned has a
>> different bbox anyway, but I believe that a long/lat aligned "box" in
>> WGS84 remains a box in Mercator.
>
> I have been playing with code to show the differences. If my code is
> correct, the differences are very small, at least for the bounding box
> I have chosen:
>
> library(geosphere) ## provides a mercator function
>
> ## Bounding box: lower-left and upper-right
> ll <- c(-10, 30)
> ur <- c(10, 50)
> ## Bounding box in mercator projection
> llxy <- mercator(ll)
> urxy <- mercator(ur)
>
> ## Matrix of coordinates in mercator projection
> xy <- expand.grid(x=seq(llxy[1], urxy[1], length=100),
>                   y=seq(llxy[2], urxy[2], length=100))
>
> ## Matrix of lon-lat values using bounding box
> lonlat <- expand.grid(x=seq(ll[1], ur[1], length=100),
>                   y=seq(ll[2], ur[2], length=100))
>
> ## Mercator coordinates using matrix of lon-lat
> xyproj <- mercator(lonlat)
>
> ## Differences between xy and xyproj
> dif <- 1 - xyproj/xy
> names(dif) <- paste0('dif', names(dif))
> summary(dif)
>
> library(lattice)
> difXY <- cbind(xy, dif)
> levelplot(difx + dify ~ x*y, data=difXY)
>
>>> I've avoided ggmap et al because I've been unconvinced about their
>>> geographic rigour vs their prettiness....
>
> IMHO ggmap and friends are useful only when you need an easy way to
> add an attractive context or "decorative" material to a graphic.
>
> Best,
>
> Oscar.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From alobolistas at gmail.com  Fri Apr 25 20:15:42 2014
From: alobolistas at gmail.com (Agustin Lobo)
Date: Fri, 25 Apr 2014 20:15:42 +0200
Subject: [R-sig-Geo] projection of ggmap:get_map() output
In-Reply-To: <CAG4NReLf4Xg5-SvJgemMxhif=6-fnm_n6842ofvV27W0Y3R7Ug@mail.gmail.com>
References: <15399b6d75f748d28822ecdb366ebd84@EX-0-HT0.lancs.local>
	<CANVKczNLjyBAZ2y7FOvDP+c-ZSwABT_6BWK276uJJy=7MEew4w@mail.gmail.com>
	<CAG4NReLZfUtayt+koJvSZJAK1q_vNJAnJmQ_9GBtOc=X2uGqfw@mail.gmail.com>
	<CAG4NReJz-eq6GcGm=cQrMikz9VnhSu=HdpOyQHmB9PUK3e=Xpg@mail.gmail.com>
	<5358C986.9080309@uni-muenster.de>
	<345780f75d2045169a2f656dd4fca6a9@EX-0-HT0.lancs.local>
	<CANVKczMKm4JqLbJ-bvJsEiGc+MdmLf7Fvzgc7NtebODOcRvY9g@mail.gmail.com>
	<53595125.60606@uni-muenster.de>
	<CAMLL7bn87AhW-v=C5yhEZJ7ANVMRQUhg2LDtFgPBGLJu6XKXTA@mail.gmail.com>
	<CAG4NReLf4Xg5-SvJgemMxhif=6-fnm_n6842ofvV27W0Y3R7Ug@mail.gmail.com>
Message-ID: <CAG4NReLXPL7H39SjX=7v3DgH0WMz757VLyTZ_=fTH6zGvHfywg@mail.gmail.com>

I've tested the effect of the projections on overlaying graphs using
levelplot() + layer()
In short, the user's object must be in epsg:4326, probably because
layer() carries out a reprojection.
The bad news is that it carries out a wrong reprojection, perhaps
because the incorrect
(or insufficient) definition of the projection as just "mercator" in layer()

Example:
(shape file in
https://dl.dropboxusercontent.com/u/3180464/NWEur.zip)

gmap2 <- get_map(location = c(5,51), maptype = "hybrid", source=
"google", crop = FALSE, zoom = 6)
ggmap(gmap2)
#convert gmap2 to rgb raster brick
mgmap2 <- as.matrix(gmap2)
vgmap2 <- as.vector(mgmap2)
vgmap2rgb <- col2rgb(vgmap2)
gmap2r <- matrix(vgmap2rgb[1,],ncol=ncol(mgmap2),nrow=nrow(mgmap2))
gmap2g <- matrix(vgmap2rgb[2,],ncol=ncol(mgmap2),nrow=nrow(mgmap2))
gmap2b <- matrix(vgmap2rgb[3,],ncol=ncol(mgmap2),nrow=nrow(mgmap2))
rgmap2 <- brick(raster(gmap2r),raster(gmap2g),raster(gmap2b))
extent(rgmap2) <- unlist(attr(gmap2,which="bb"))[c(2,4,1,3)]
projection(rgmap2) <- CRS("+init=epsg:3857")
plotRGB(rgmap2)
plot(rgmap2[[3]],col=grey.colors(32,start=0,end=1,gamma=1))
#shapefiles to be overlaid: coastlines easy to follow in the resulting graphic
NWEur <- readOGR(dsn="countries_shp",layer="NWEur",stringsAsFactors=FALSE)
projection(NWEur)
NWEurGM <- spTransform(NWEur,CRS("+init=epsg:3857"))
#levelplots
levelplot(rgmap2[[3]],margin=FALSE,par.settings=GrTheme) +
  layer(sp.polygons(NWEur))
levelplot(rgmap2[[3]],margin=FALSE,par.settings=GrTheme) +
  layer(sp.polygons(NWEurGM))

overlay with the layer in epsg3857 is totaly out of place,
but the one with the layer in epsg4326 is clearly shifted.

Thus, we cannot use levelplot() + layer() with get_map() output at the moment.

Agus


On Fri, Apr 25, 2014 at 3:55 PM, Agustin Lobo <alobolistas at gmail.com> wrote:
> According to the results
> https://dl.dropboxusercontent.com/u/3180464/ggmap_GM_compare.odp
> of the code below, the matrix downloaded by get_map() is on epsg:3857,
> the so-called
> Google Pseudo Mercator, while the bounding box is given in epsg:4326
> coordinates.
> The odp file shows the raster as created by the code below out of a
> get_map() command,
> and the same area displayed by plugin OpenLayers.
> Note there is still a bit of shift/distortion between the 2 when you
> compare alternatively,
> but this is much less than what I had assuming get_map() was
> downloading in epsg:4326
>
> mibb <- matrix(c(-69.88634, -48.78450, -34.05533, -18.63424),byrow=TRUE,nrow=2)
> gmap <- get_map(location = mibb, maptype = "hybrid", source= "google",
> crop = FALSE, zoom = 5)
>
> # Make a raster brick object from gmap
> mgmap <- as.matrix(gmap)
> vgmap <- as.vector(mgmap)
> vgmaprgb <- col2rgb(vgmap)
> gmapr <- matrix(vgmaprgb[1,],ncol=ncol(mgmap),nrow=nrow(mgmap))
> gmapg <- matrix(vgmaprgb[2,],ncol=ncol(mgmap),nrow=nrow(mgmap))
> gmapb <- matrix(vgmaprgb[3,],ncol=ncol(mgmap),nrow=nrow(mgmap))
> rgmaprgb <- brick(raster(gmapr),raster(gmapg),raster(gmapb))
>
> #version in "Google PseudoMercator" epsg:3857
> rgmaprgbGM <- rgmaprgb
> projection(rgmaprgbGM) <- CRS("+init=epsg:3857")
> #We have to find out the extent in the units of the new projection
> unlist(attr(gmap,which="bb"))[c(2,4,1,3)]
> rprobextSpDF <- as(extent(unlist(attr(gmap,which="bb"))[c(2,4,1,3)]),
> "SpatialPolygons")
> projection(rprobextSpDF) <- CRS("+init=epsg:4326")
> rprobextGM <- spTransform(rprobextSpDF,CRS("+init=epsg:3857"))
> rprobextGM at bbox
> extent(rgmaprgbGM) <- c(rprobextGM at bbox[1,],rprobextGM at bbox[2,])
> rgmaprgbGM
> plotRGB(rgmaprgbGM)
> writeRaster(rgmaprgbGM,file="rgmaprgbGM",format="GTiff",overwrite=TRUE,datatype="INT1U")
>
> I therefore think that overlaying layers using levelplot() + layer()
> might have to be done with the user's layers
> in epsg:4326, but I'll confirm soon. It could be as well that ggmap
> reprojects from 4326 to 3857.
> The query for get_map() must be done in epsg:4326, though, that's for sure.
>
> ggmap should specify the projection of the object retrieved by
> get_map(). The mentions you find to "mercator" are not unambiguous, as
> "mercator" is not one projection but a projection family.
>
> Geo-graphics must be pretty **and** exact.
>
> Agus
>
> On Fri, Apr 25, 2014 at 12:13 PM, Oscar Perpi?an <oscar.perpinan at upm.es> wrote:
>>> On 04/24/2014 03:52 PM, Barry Rowlingson wrote:
>>>> So do you mean (and I've not tried your code yet, sorry) that the
>>>> corners may well be at the given lat-long points but half way along any
>>>> edge might not be at the halfway-point in lat-long?
>>> Indeed:
>>>
>>> library(ggmap)
>>> ggmap(get_map(matrix(c(-10,20,40,80),2,2)))
>>>
>>> and look at the tics along the y-axis: they're not linear, neither are
>>> they drawn by google (at least, they're not on the ggmapTemp.png file
>>> written).
>>>
>>> http://journal.r-project.org/archive/2013-1/kahle-wickham.pdf
>>>
>>> mention on p. 146 that "... the coordinate system is ?xed to the
>>> Mercator projection."
>>
>> Just as additional confirmation: inspecting the code, ggmap uses the
>> mercator projection for displaying the "raster":
>> https://github.com/dkahle/ggmap/blob/master/R/ggmap.R#L562
>>
>>>> if you convert the bbox coords to epsg:3857 then maybe you have a
>>>> correctly projected raster in those coordinates?
>>> The google API wants long/lat in WGS84, and what gets returned has a
>>> different bbox anyway, but I believe that a long/lat aligned "box" in
>>> WGS84 remains a box in Mercator.
>>
>> I have been playing with code to show the differences. If my code is
>> correct, the differences are very small, at least for the bounding box
>> I have chosen:
>>
>> library(geosphere) ## provides a mercator function
>>
>> ## Bounding box: lower-left and upper-right
>> ll <- c(-10, 30)
>> ur <- c(10, 50)
>> ## Bounding box in mercator projection
>> llxy <- mercator(ll)
>> urxy <- mercator(ur)
>>
>> ## Matrix of coordinates in mercator projection
>> xy <- expand.grid(x=seq(llxy[1], urxy[1], length=100),
>>                   y=seq(llxy[2], urxy[2], length=100))
>>
>> ## Matrix of lon-lat values using bounding box
>> lonlat <- expand.grid(x=seq(ll[1], ur[1], length=100),
>>                   y=seq(ll[2], ur[2], length=100))
>>
>> ## Mercator coordinates using matrix of lon-lat
>> xyproj <- mercator(lonlat)
>>
>> ## Differences between xy and xyproj
>> dif <- 1 - xyproj/xy
>> names(dif) <- paste0('dif', names(dif))
>> summary(dif)
>>
>> library(lattice)
>> difXY <- cbind(xy, dif)
>> levelplot(difx + dify ~ x*y, data=difXY)
>>
>>>> I've avoided ggmap et al because I've been unconvinced about their
>>>> geographic rigour vs their prettiness....
>>
>> IMHO ggmap and friends are useful only when you need an easy way to
>> add an attractive context or "decorative" material to a graphic.
>>
>> Best,
>>
>> Oscar.
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Roger.Bivand at nhh.no  Sun Apr 27 15:17:20 2014
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sun, 27 Apr 2014 15:17:20 +0200
Subject: [R-sig-Geo] FW: [R-sig-Epi] problem with nb2listw( ) command
In-Reply-To: <COL131-W6118C38D88B5B030A6C9F3805F0@phx.gbl>
References: <COL131-W817FA69F1AE575D0540374805F0@phx.gbl>
	<COL131-W6118C38D88B5B030A6C9F3805F0@phx.gbl>
Message-ID: <alpine.LRH.2.03.1404271449360.4848@reclus.nhh.no>

Do not write to multiple lists at the same time - nobody not on both lists 
will know whether the question has been answered.

Always provide simple reproducible code.

See below inline for answer:


On Sun, 20 Apr 2014, irum Amir wrote:

>
>
>> From: imirum_amir at hotmail.com
>> To: r-sig-epi at r-project.org
>> Date: Sun, 20 Apr 2014 09:23:14 +0000
>> Subject: [R-sig-Epi] problem with nb2listw( ) command
>>
>>
>> Dear all I am using scottish lip cancer data, which contains the 
>> columns of observed, expected, AFF(person at risk) and latitude and 
>> longitude. i use the commands
>>
>
>>  nc<-combine.data.shapefile(data=scotland,shp=shp,dbf=dbf)
>> ###CARBayes package
>

This function is rather confusing and probably not a good idea here - see 
PS below.

>> W.nb<-poly2nb(nc=scotland,row.names=rownames(scotland)) ### spdep
>> package
>>
>>   > W.nb
>> Out put is
>>
>> Neighbour
>> list object:
>>
>>
>> Number of
>> regions: 56
>>
>>
>> Number of
>> nonzero links: 234
>>
>>
>> Percentage
>> nonzero weights: 7.461735
>>
>>
>> Average
>> number of links: 4.178571
>>
>>
>> 3 regions
>> with no links:
>>
^^^^^^^^^^^^^^^^^^^^

Please always read the output you see - your use of poly2nb created three 
no-neighbour regions,

>>
>> 6554   6655 6756
^^^^^^^^^^^^^^^^^^^^

these.


>>
>>
>>      >   col.W<-nb2listw(W.nb,style="B",zero.policy=TRUE)
>>
>>

You use zero.policy=TRUE to get round the problem you yourself created 
here, but then forget to continue to do the same in print.listw() and 
moranI.test().

If you really want regions with no neighbours, you must use 
zero.policy=TRUE everwhere - because usually you are advised not to 
generate such neighbour objects (the theoretical properties of tests etc. 
were developed for graphs with all regions connected.

If you read ?set.ZeroPolicyOption in spdep, you can see how to set the 
option to TRUE globally as an option for your current session. Only use 
this if you understand the consequences and wish to accept the risk that 
the methods do not behave as expected.

Hope this clarifies,

Roger

PS. The boundaries in the scot_BNG shapefile in rgdal (see examples in 
readOGR) include small slivers securing contiguity across water (spotted 
by Barry Rowlingson, derived from an unprojected shapefile on Lance 
Waller's website), and the data you are trying to analyse. This is also 
used in Bivand et al. (2013), see: 
http://www.asdar-book.org/bundles2ed/die_bundle.zip, and: 
http://www.asdar-book.org/book2ed/die_mod.R chunks 31-46.

>>      >   col.W
>>
>>
>> which gives out put
>> Error in
>> print.listw(list(style = "B", neighbours = list(c(5L, 9L, 19L :  regions with no neighbours found, use zero.policy=TRUEwhen i use the command
>>> moranI.test(Observed~AFF+offset(log(Expected)),
>> as(nc, "data.frame"), "negbin", 999,
>>
>>
>>    listw=col.W, n=length(W.nb), S0=Szero(col.W)
>> )
>>
>>
>>              Moran's I test of
>> spatial autocorrelation
>>
>>
>>              Type of boots.: parametric
>>
>>             Model used when sampling: Negative
>> Binomial
>>
>>              Number of simulations: 999
>>             Statistic:  NA
>>             p-value :  NA
>> please help if any body has an idea.
>>
>>
>>
>> There were 50 or more warnings (use
>> warnings() to see the first 50)
>>
>>
>>
>> 	[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Epi at r-project.org mailing list
>> https://stat.ethz.ch/mailman/listinfo/r-sig-epi
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From oscar.perpinan at upm.es  Mon Apr 28 11:58:02 2014
From: oscar.perpinan at upm.es (=?UTF-8?Q?Oscar_Perpi=C3=B1an?=)
Date: Mon, 28 Apr 2014 11:58:02 +0200
Subject: [R-sig-Geo] projection of ggmap:get_map() output
In-Reply-To: <CAG4NReLXPL7H39SjX=7v3DgH0WMz757VLyTZ_=fTH6zGvHfywg@mail.gmail.com>
References: <15399b6d75f748d28822ecdb366ebd84@EX-0-HT0.lancs.local>
	<CANVKczNLjyBAZ2y7FOvDP+c-ZSwABT_6BWK276uJJy=7MEew4w@mail.gmail.com>
	<CAG4NReLZfUtayt+koJvSZJAK1q_vNJAnJmQ_9GBtOc=X2uGqfw@mail.gmail.com>
	<CAG4NReJz-eq6GcGm=cQrMikz9VnhSu=HdpOyQHmB9PUK3e=Xpg@mail.gmail.com>
	<5358C986.9080309@uni-muenster.de>
	<345780f75d2045169a2f656dd4fca6a9@EX-0-HT0.lancs.local>
	<CANVKczMKm4JqLbJ-bvJsEiGc+MdmLf7Fvzgc7NtebODOcRvY9g@mail.gmail.com>
	<53595125.60606@uni-muenster.de>
	<CAMLL7bn87AhW-v=C5yhEZJ7ANVMRQUhg2LDtFgPBGLJu6XKXTA@mail.gmail.com>
	<CAG4NReLf4Xg5-SvJgemMxhif=6-fnm_n6842ofvV27W0Y3R7Ug@mail.gmail.com>
	<CAG4NReLXPL7H39SjX=7v3DgH0WMz757VLyTZ_=fTH6zGvHfywg@mail.gmail.com>
Message-ID: <CAMLL7bkemZSdiDxjf=X=02K65OAvQkh8Tu-_QE42iKaZ+YkMOA@mail.gmail.com>

Hello,

I couldn't run your code because I am not able to read the file.
Anyway, some comments about your last email:

- "layer" is a function of the latticeExtra package. This function
modifies the panel function of a "trellis" graphic produced with a
function of the lattice package. This function, together with
"+.trellis" (of the same package) allows for overlaying layers. It is
important to note that it does not carry out any projection. It only
displays the graphical result of another function (for example,
sp.polygons or whatever).

- You create the canvas with "levelplot" displaying the ggmap raster,
and then overlay the data with layer. This is the same approach that
ggmap uses. Instead, I prefer to rely on the main data to be displayed
to configure the graphical window instead of using an auxiliary image
as the starting point.

- I'm not a fan of the ggmap approach. I agree with you that the
resulting object should include the projection information and even
adhere to the sp classes. However, I think that their results are
useful if managed with care.

In order to show that this is not an issue strictly related to
rasterVis::levelplot, I have written some code with spplot. I think
that the concordance between the ggmap raster and the shapefile is
aceptable.

Best,

Oscar.

##########################################################
library(sp)
library(ggmap)
## latticeExtra must be loaded after ggmap because both ggplot2 and
## latticeExtra define a 'layer' function. We need the definition from
## latticeExtra.
library(latticeExtra)

## Shape example
library(maptools)
owd <- getwd()
setwd(system.file("shapes", package = "maptools"))
sc90 <- readShapeSpatial("co45_d90")
proj4string(sc90) <- CRS("+proj=longlat +datum=NAD27")
setwd(owd)

## Get the stamen map
bbPoly <- bbox(sc90)
gmap <- get_map(c(bbPoly), maptype='toner', source='stamen', crop=FALSE)
bbMap <- attr(gmap, 'bb')
latCenter <- with(bbMap, ll.lat + ur.lat)/2
lonCenter <- with(bbMap, ll.lon + ur.lon)/2
height <- with(bbMap, ur.lat - ll.lat)
width <- with(bbMap, ur.lon - ll.lon)

## Use latticeExtra::+.trellis and latticeExtra::layer
spplot(sc90['AREA'], fill='transparent', col='indianred1') +
                  layer(grid.raster(gmap,
                                    x=lonCenter, y=latCenter,
                                    width=width, height=height,
                                    default.units='native'),
                        under=TRUE)


From jwm302 at gmail.com  Mon Apr 28 14:18:40 2014
From: jwm302 at gmail.com (Justin Michell)
Date: Mon, 28 Apr 2014 14:18:40 +0200
Subject: [R-sig-Geo] Problem merging rasters after conversion and
	reprojection of .hdf file
Message-ID: <10530E7E-DE99-43D3-81DE-DD3CD51A294B@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140428/abd0a8db/attachment.pl>

From jgrn at illinois.edu  Mon Apr 28 15:12:59 2014
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Mon, 28 Apr 2014 08:12:59 -0500
Subject: [R-sig-Geo] Problem merging rasters after conversion and
 reprojection of .hdf file
In-Reply-To: <10530E7E-DE99-43D3-81DE-DD3CD51A294B@gmail.com>
References: <10530E7E-DE99-43D3-81DE-DD3CD51A294B@gmail.com>
Message-ID: <CABG0rfvUGK0GFM4ij+pfT4VvzLnPV9MT6oGSY4+TUzFO-6kMNw@mail.gmail.com>

Justin:

Couple of comments:

1) In general, I find it easier to mosaic FIRST and then reproject
SECOND -- when you reproject first, mosaic second, you can get weird
issues particularly along the seams.
2) Since you are already using gdalUtils, have you tried
?mosaic_rasters (which will be faster than merge() in all likelihood,
since it uses the base GDAL mosaicking capabilities)?  Make sure
separate=FALSE for this particular application.

--j

On Mon, Apr 28, 2014 at 7:18 AM, Justin Michell <jwm302 at gmail.com> wrote:
> Dear Group
>
> I am dealing with the task of preprocessing and re-projecting MODIS gridded tiles in .hdf format from Sinusoidal projection, in R, to a geographic projection. I would like to align all my other climate layers (from worldclim.org) which are at 1km resolution to my NDVI layers. I am using the gdal_utils package in R, and only one subset I?m interested in (monthly NDVI). I am working on Mac OS and grabbed gdal from here: http://www.kyngchaos.com/software/frameworks .
>
> To do this I use the following code (previous list entries relating to gdalUtils have assisted me up till this point):
>
> # download all available monthly images for the year 2013 - MODIS PRODUCT (MOD13A3, Terra, Vegetation Indices, Tile, 1000m, Monthly)
> ModisDownload(x="MOD13A3",h=c(20,21,22),v=c(8,9),dates=c('2013.01.01','2013.12.31'),mosaic=F,proj=F)
>
> # extract the NDVI band (sd_index=1) and converts to .tiff for 1 tile for January
> gdal_translate("MOD13A3.A2013001.h20v08.005.2013042085256.hdf", "Jan_1.tiff", sd_index=1)
>
> # converts projection to Geog WGS84
> gdalwarp(?Jan_1.tiff","MODIS_NDVI/NDVIJan_1.tiff", s_srs="+proj=sinu +lon_0=0 +x_0=0 +y_0=0 +a=6371007.181 +b=6371007.181 +units=m +no_defs",t_srs="+proj=longlat +datum=WGS84 +no_defs",srcnodata=-3000,dstnodata=-3000)
>
>  I have 6 tiles per month (covering Kenya). For each month I?d like to merge all 6 tiles using the raster package (to cover Kenya). For January I perform the following operation using the merge function in the raster package:
>
> NDVI1  <- (merge(raster("MODIS_NDVI/NDVIJan_1.tiff"),raster("MODIS_NDVI/NDVIJan_2.tiff"),raster("MODIS_NDVI/NDVIJan_3.tiff"), raster("MODIS_NDVI/NDVIJan_4.tiff"), raster("MODIS_NDVI/NDVIJan_5.tiff"), raster("MODIS_NDVI/NDVIJan_6.tiff"), tolerance=0.5))*0.0001
> NDVI1 <- crop(NDVI1, extent(kenya))
>
> Without including the tolerance argument I get an error:
>
> Error in compareRaster(x, extent = FALSE, rowcol = FALSE, orig = TRUE,  :
>   different origin
>
>  But after this merge a lot of NA?s are introduced and the plot doesn?t look right (as it did before for each tile).
>
> The resolution is not exactly the same. Here are a comparison of the layers (before merging NDVI tiles) and my SpatialPolygonsDataFrame called kenya, as well as my r sessionInfo() printed below:
>
>
>> n1 <- raster("MODIS_NDVI/NDVIJan_1.tiff")
>> n1
> class       : RasterLayer
> dimensions  : 1219, 1275, 1554225  (nrow, ncol, ncell)
> resolution  : 0.008205785, 0.008205785  (x, y)
> extent      : 20, 30.46238, -0.002852273, 10  (xmin, xmax, ymin, ymax)
> coord. ref. : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0
> data source : /Users/justinmichell/MODIS_NDVI/NDVIJan_1.tiff
> names       : NDVIJan_1
> values      : -32768, 32767  (min, max)
>
>> meanTemp1
> class       : RasterLayer
> dimensions  : 1115, 960, 1070400  (nrow, ncol, ncell)
> resolution  : 0.008333333, 0.008333333  (x, y)
> extent      : 33.90833, 41.90833, -4.666667, 4.625  (xmin, xmax, ymin, ymax)
> coord. ref. : +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0
> data source : in memory
> names       : layer
> values      : -4.4, 30  (min, max)
>
>> kenya
> class       : SpatialPolygonsDataFrame
> features    : 1
> extent      : 33.90722, 41.90517, -4.669618, 4.622499  (xmin, xmax, ymin, ymax)
> coord. ref. : +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0
> variables   : 11
> names       : FIPS, ISO2, ISO3,  UN,  NAME,  AREA,  POP2005, REGION, SUBREGION,    LON,  LAT
> min values  :   KE,   KE,  KEN, 404, Kenya, 56914, 35598952,      2,        14, 37.858, 0.53
> max values  :   KE,   KE,  KEN, 404, Kenya, 56914, 35598952,      2,        14, 37.858, 0.53
>
>> sessionInfo()
> R version 3.0.2 (2013-09-25)
> Platform: x86_64-apple-darwin10.8.0 (64-bit)
>
> locale:
> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] gdalUtils_0.2.0 rgdal_0.8-14    RCurl_1.95-4.1  bitops_1.0-6    raster_2.2-12   sp_1.0-14
>
> loaded via a namespace (and not attached):
> [1] codetools_0.2-8      foreach_1.4.1        grid_3.0.2           iterators_1.0.6      lattice_0.20-24      scatterplot3d_0.3-34
>
>
> Thanks very much,
> Justin Michell
>
>
>
>
>
>
>
>
>
>
>
>         [[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Jonathan A. Greenberg, PhD
Assistant Professor
Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
Department of Geography and Geographic Information Science
University of Illinois at Urbana-Champaign
259 Computing Applications Building, MC-150
605 East Springfield Avenue
Champaign, IL  61820-6371
Phone: 217-300-1924
http://www.geog.illinois.edu/~jgrn/
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007


From jgrn at illinois.edu  Mon Apr 28 15:17:46 2014
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Mon, 28 Apr 2014 08:17:46 -0500
Subject: [R-sig-Geo] Problem merging rasters after conversion and
 reprojection of .hdf file
In-Reply-To: <CABG0rfvUGK0GFM4ij+pfT4VvzLnPV9MT6oGSY4+TUzFO-6kMNw@mail.gmail.com>
References: <10530E7E-DE99-43D3-81DE-DD3CD51A294B@gmail.com>
	<CABG0rfvUGK0GFM4ij+pfT4VvzLnPV9MT6oGSY4+TUzFO-6kMNw@mail.gmail.com>
Message-ID: <CABG0rfvTrJY7ckzbJRqm_=YPObDmC+atUN1oSz1oQBBdcd=v1g@mail.gmail.com>

Also note you can use ?batch_gdal_translate to do your HDF -> TIF conversions.

--j

On Mon, Apr 28, 2014 at 8:12 AM, Jonathan Greenberg <jgrn at illinois.edu> wrote:
> Justin:
>
> Couple of comments:
>
> 1) In general, I find it easier to mosaic FIRST and then reproject
> SECOND -- when you reproject first, mosaic second, you can get weird
> issues particularly along the seams.
> 2) Since you are already using gdalUtils, have you tried
> ?mosaic_rasters (which will be faster than merge() in all likelihood,
> since it uses the base GDAL mosaicking capabilities)?  Make sure
> separate=FALSE for this particular application.
>
> --j
>
> On Mon, Apr 28, 2014 at 7:18 AM, Justin Michell <jwm302 at gmail.com> wrote:
>> Dear Group
>>
>> I am dealing with the task of preprocessing and re-projecting MODIS gridded tiles in .hdf format from Sinusoidal projection, in R, to a geographic projection. I would like to align all my other climate layers (from worldclim.org) which are at 1km resolution to my NDVI layers. I am using the gdal_utils package in R, and only one subset I?m interested in (monthly NDVI). I am working on Mac OS and grabbed gdal from here: http://www.kyngchaos.com/software/frameworks .
>>
>> To do this I use the following code (previous list entries relating to gdalUtils have assisted me up till this point):
>>
>> # download all available monthly images for the year 2013 - MODIS PRODUCT (MOD13A3, Terra, Vegetation Indices, Tile, 1000m, Monthly)
>> ModisDownload(x="MOD13A3",h=c(20,21,22),v=c(8,9),dates=c('2013.01.01','2013.12.31'),mosaic=F,proj=F)
>>
>> # extract the NDVI band (sd_index=1) and converts to .tiff for 1 tile for January
>> gdal_translate("MOD13A3.A2013001.h20v08.005.2013042085256.hdf", "Jan_1.tiff", sd_index=1)
>>
>> # converts projection to Geog WGS84
>> gdalwarp(?Jan_1.tiff","MODIS_NDVI/NDVIJan_1.tiff", s_srs="+proj=sinu +lon_0=0 +x_0=0 +y_0=0 +a=6371007.181 +b=6371007.181 +units=m +no_defs",t_srs="+proj=longlat +datum=WGS84 +no_defs",srcnodata=-3000,dstnodata=-3000)
>>
>>  I have 6 tiles per month (covering Kenya). For each month I?d like to merge all 6 tiles using the raster package (to cover Kenya). For January I perform the following operation using the merge function in the raster package:
>>
>> NDVI1  <- (merge(raster("MODIS_NDVI/NDVIJan_1.tiff"),raster("MODIS_NDVI/NDVIJan_2.tiff"),raster("MODIS_NDVI/NDVIJan_3.tiff"), raster("MODIS_NDVI/NDVIJan_4.tiff"), raster("MODIS_NDVI/NDVIJan_5.tiff"), raster("MODIS_NDVI/NDVIJan_6.tiff"), tolerance=0.5))*0.0001
>> NDVI1 <- crop(NDVI1, extent(kenya))
>>
>> Without including the tolerance argument I get an error:
>>
>> Error in compareRaster(x, extent = FALSE, rowcol = FALSE, orig = TRUE,  :
>>   different origin
>>
>>  But after this merge a lot of NA?s are introduced and the plot doesn?t look right (as it did before for each tile).
>>
>> The resolution is not exactly the same. Here are a comparison of the layers (before merging NDVI tiles) and my SpatialPolygonsDataFrame called kenya, as well as my r sessionInfo() printed below:
>>
>>
>>> n1 <- raster("MODIS_NDVI/NDVIJan_1.tiff")
>>> n1
>> class       : RasterLayer
>> dimensions  : 1219, 1275, 1554225  (nrow, ncol, ncell)
>> resolution  : 0.008205785, 0.008205785  (x, y)
>> extent      : 20, 30.46238, -0.002852273, 10  (xmin, xmax, ymin, ymax)
>> coord. ref. : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0
>> data source : /Users/justinmichell/MODIS_NDVI/NDVIJan_1.tiff
>> names       : NDVIJan_1
>> values      : -32768, 32767  (min, max)
>>
>>> meanTemp1
>> class       : RasterLayer
>> dimensions  : 1115, 960, 1070400  (nrow, ncol, ncell)
>> resolution  : 0.008333333, 0.008333333  (x, y)
>> extent      : 33.90833, 41.90833, -4.666667, 4.625  (xmin, xmax, ymin, ymax)
>> coord. ref. : +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0
>> data source : in memory
>> names       : layer
>> values      : -4.4, 30  (min, max)
>>
>>> kenya
>> class       : SpatialPolygonsDataFrame
>> features    : 1
>> extent      : 33.90722, 41.90517, -4.669618, 4.622499  (xmin, xmax, ymin, ymax)
>> coord. ref. : +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0
>> variables   : 11
>> names       : FIPS, ISO2, ISO3,  UN,  NAME,  AREA,  POP2005, REGION, SUBREGION,    LON,  LAT
>> min values  :   KE,   KE,  KEN, 404, Kenya, 56914, 35598952,      2,        14, 37.858, 0.53
>> max values  :   KE,   KE,  KEN, 404, Kenya, 56914, 35598952,      2,        14, 37.858, 0.53
>>
>>> sessionInfo()
>> R version 3.0.2 (2013-09-25)
>> Platform: x86_64-apple-darwin10.8.0 (64-bit)
>>
>> locale:
>> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> other attached packages:
>> [1] gdalUtils_0.2.0 rgdal_0.8-14    RCurl_1.95-4.1  bitops_1.0-6    raster_2.2-12   sp_1.0-14
>>
>> loaded via a namespace (and not attached):
>> [1] codetools_0.2-8      foreach_1.4.1        grid_3.0.2           iterators_1.0.6      lattice_0.20-24      scatterplot3d_0.3-34
>>
>>
>> Thanks very much,
>> Justin Michell
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>         [[alternative HTML version deleted]]
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
>
> --
> Jonathan A. Greenberg, PhD
> Assistant Professor
> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
> Department of Geography and Geographic Information Science
> University of Illinois at Urbana-Champaign
> 259 Computing Applications Building, MC-150
> 605 East Springfield Avenue
> Champaign, IL  61820-6371
> Phone: 217-300-1924
> http://www.geog.illinois.edu/~jgrn/
> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007



-- 
Jonathan A. Greenberg, PhD
Assistant Professor
Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
Department of Geography and Geographic Information Science
University of Illinois at Urbana-Champaign
259 Computing Applications Building, MC-150
605 East Springfield Avenue
Champaign, IL  61820-6371
Phone: 217-300-1924
http://www.geog.illinois.edu/~jgrn/
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007


From edzer.pebesma at uni-muenster.de  Mon Apr 28 16:57:21 2014
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 28 Apr 2014 16:57:21 +0200
Subject: [R-sig-Geo] projection of ggmap:get_map() output
In-Reply-To: <CAMLL7bkemZSdiDxjf=X=02K65OAvQkh8Tu-_QE42iKaZ+YkMOA@mail.gmail.com>
References: <15399b6d75f748d28822ecdb366ebd84@EX-0-HT0.lancs.local>	<CANVKczNLjyBAZ2y7FOvDP+c-ZSwABT_6BWK276uJJy=7MEew4w@mail.gmail.com>	<CAG4NReLZfUtayt+koJvSZJAK1q_vNJAnJmQ_9GBtOc=X2uGqfw@mail.gmail.com>	<CAG4NReJz-eq6GcGm=cQrMikz9VnhSu=HdpOyQHmB9PUK3e=Xpg@mail.gmail.com>	<5358C986.9080309@uni-muenster.de>	<345780f75d2045169a2f656dd4fca6a9@EX-0-HT0.lancs.local>	<CANVKczMKm4JqLbJ-bvJsEiGc+MdmLf7Fvzgc7NtebODOcRvY9g@mail.gmail.com>	<53595125.60606@uni-muenster.de>	<CAMLL7bn87AhW-v=C5yhEZJ7ANVMRQUhg2LDtFgPBGLJu6XKXTA@mail.gmail.com>	<CAG4NReLf4Xg5-SvJgemMxhif=6-fnm_n6842ofvV27W0Y3R7Ug@mail.gmail.com>	<CAG4NReLXPL7H39SjX=7v3DgH0WMz757VLyTZ_=fTH6zGvHfywg@mail.gmail.com>
	<CAMLL7bkemZSdiDxjf=X=02K65OAvQkh8Tu-_QE42iKaZ+YkMOA@mail.gmail.com>
Message-ID: <535E6C51.9060508@uni-muenster.de>

Nice, thank you!

Markus Loecher, author of RgoogleMaps, explained that ggmap uses

https://github.com/dkahle/ggmap/blob/master/R/LonLat2XY.R

to go from long/lat to XY (pixels in google map tiles), which was taken
from the RgoogleMaps one:

https://github.com/markusloecher/RgoogleMaps/blob/master/R/LatLon2XY.R

which points to code by someone called Neil Young in a google groups:

https://groups.google.com/forum/?hl=en#!topic/Google-Maps-API/0hA6wp6VaW8

I would expect that your cylindrical, equidistant projection (linear in
long/lat) must collide more with the Mercator used by google when the
plotted area becomes larger.

On 04/28/2014 11:58 AM, Oscar Perpi?an wrote:
> Hello,
> 
> I couldn't run your code because I am not able to read the file.
> Anyway, some comments about your last email:
> 
> - "layer" is a function of the latticeExtra package. This function
> modifies the panel function of a "trellis" graphic produced with a
> function of the lattice package. This function, together with
> "+.trellis" (of the same package) allows for overlaying layers. It is
> important to note that it does not carry out any projection. It only
> displays the graphical result of another function (for example,
> sp.polygons or whatever).
> 
> - You create the canvas with "levelplot" displaying the ggmap raster,
> and then overlay the data with layer. This is the same approach that
> ggmap uses. Instead, I prefer to rely on the main data to be displayed
> to configure the graphical window instead of using an auxiliary image
> as the starting point.
> 
> - I'm not a fan of the ggmap approach. I agree with you that the
> resulting object should include the projection information and even
> adhere to the sp classes. However, I think that their results are
> useful if managed with care.
> 
> In order to show that this is not an issue strictly related to
> rasterVis::levelplot, I have written some code with spplot. I think
> that the concordance between the ggmap raster and the shapefile is
> aceptable.
> 
> Best,
> 
> Oscar.
> 
> ##########################################################
> library(sp)
> library(ggmap)
> ## latticeExtra must be loaded after ggmap because both ggplot2 and
> ## latticeExtra define a 'layer' function. We need the definition from
> ## latticeExtra.
> library(latticeExtra)
> 
> ## Shape example
> library(maptools)
> owd <- getwd()
> setwd(system.file("shapes", package = "maptools"))
> sc90 <- readShapeSpatial("co45_d90")
> proj4string(sc90) <- CRS("+proj=longlat +datum=NAD27")
> setwd(owd)
> 
> ## Get the stamen map
> bbPoly <- bbox(sc90)
> gmap <- get_map(c(bbPoly), maptype='toner', source='stamen', crop=FALSE)
> bbMap <- attr(gmap, 'bb')
> latCenter <- with(bbMap, ll.lat + ur.lat)/2
> lonCenter <- with(bbMap, ll.lon + ur.lon)/2
> height <- with(bbMap, ur.lat - ll.lat)
> width <- with(bbMap, ur.lon - ll.lon)
> 
> ## Use latticeExtra::+.trellis and latticeExtra::layer
> spplot(sc90['AREA'], fill='transparent', col='indianred1') +
>                   layer(grid.raster(gmap,
>                                     x=lonCenter, y=latCenter,
>                                     width=width, height=height,
>                                     default.units='native'),
>                         under=TRUE)
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140428/f137aa64/attachment.bin>

From alobolistas at gmail.com  Tue Apr 29 09:38:18 2014
From: alobolistas at gmail.com (Agustin Lobo)
Date: Tue, 29 Apr 2014 09:38:18 +0200
Subject: [R-sig-Geo] projection of ggmap:get_map() output
In-Reply-To: <CAMLL7bkemZSdiDxjf=X=02K65OAvQkh8Tu-_QE42iKaZ+YkMOA@mail.gmail.com>
References: <15399b6d75f748d28822ecdb366ebd84@EX-0-HT0.lancs.local>
	<CANVKczNLjyBAZ2y7FOvDP+c-ZSwABT_6BWK276uJJy=7MEew4w@mail.gmail.com>
	<CAG4NReLZfUtayt+koJvSZJAK1q_vNJAnJmQ_9GBtOc=X2uGqfw@mail.gmail.com>
	<CAG4NReJz-eq6GcGm=cQrMikz9VnhSu=HdpOyQHmB9PUK3e=Xpg@mail.gmail.com>
	<5358C986.9080309@uni-muenster.de>
	<345780f75d2045169a2f656dd4fca6a9@EX-0-HT0.lancs.local>
	<CANVKczMKm4JqLbJ-bvJsEiGc+MdmLf7Fvzgc7NtebODOcRvY9g@mail.gmail.com>
	<53595125.60606@uni-muenster.de>
	<CAMLL7bn87AhW-v=C5yhEZJ7ANVMRQUhg2LDtFgPBGLJu6XKXTA@mail.gmail.com>
	<CAG4NReLf4Xg5-SvJgemMxhif=6-fnm_n6842ofvV27W0Y3R7Ug@mail.gmail.com>
	<CAG4NReLXPL7H39SjX=7v3DgH0WMz757VLyTZ_=fTH6zGvHfywg@mail.gmail.com>
	<CAMLL7bkemZSdiDxjf=X=02K65OAvQkh8Tu-_QE42iKaZ+YkMOA@mail.gmail.com>
Message-ID: <CAG4NReJg+Av678gvt6isyfLiVfZ7apprx77xKfOi00HONdxjqw@mail.gmail.com>

Oscar,

On Mon, Apr 28, 2014 at 11:58 AM, Oscar Perpi?an <oscar.perpinan at upm.es> wrote:
> Hello,
>
> I couldn't run your code because I am not able to read the file.
Note dsn is the directory where you have the 4 files and layer is the
name of the layer, which is the name of the files without extension.

> Anyway, some comments about your last email:
>
> - "layer" is a function of the latticeExtra package. This function
> modifies the panel function of a "trellis" graphic produced with a
> function of the lattice package. This function, together with
> "+.trellis" (of the same package) allows for overlaying layers. It is
> important to note that it does not carry out any projection. It only
> displays the graphical result of another function (for example,
> sp.polygons or whatever).

There has to be a reprojection on the fly because the the two layers of
the plot are on different coordinate systems. I think it is clear now that
ggplot uses the Google "PseudoMercator" for the matrix while expects
all user input on epsg4326

> - You create the canvas with "levelplot" displaying the ggmap raster,
> and then overlay the data with layer. This is the same approach that
> ggmap uses. Instead, I prefer to rely on the main data to be displayed
> to configure the graphical window instead of using an auxiliary image
> as the starting point.
>
> - I'm not a fan of the ggmap approach. I agree with you that the
> resulting object should include the projection information and even
> adhere to the sp classes. However, I think that their results are
> useful if managed with care.

Users cannot handle with care undocumented idiosyncratic features.

> In order to show that this is not an issue strictly related to
> rasterVis::levelplot,
I agree this is not an specific problem of reasterVis:levleplot.

> I have written some code with spplot. I think
> that the concordance between the ggmap raster and the shapefile is
> aceptable.

I think "acceptable" depends on the scale only. At coarser scale you
just do not see the error
because it is relative to the extent and the result converges to the
correct  reprojection.

I do not think we should settle for this kind of errors.

In the code you provide, how do you know NAD27 is the appropriate datum?
There is no prj file (one of the big shortcomings of shapefiles is
that the presence
of crs information in the form of a prj file is not compulsory). Note
that you define
a datum != WGS84 and you do not define the towgs argument.

Agus

> Best,
>
> Oscar.
>
> ##########################################################
> library(sp)
> library(ggmap)
> ## latticeExtra must be loaded after ggmap because both ggplot2 and
> ## latticeExtra define a 'layer' function. We need the definition from
> ## latticeExtra.
> library(latticeExtra)
>
> ## Shape example
> library(maptools)
> owd <- getwd()
> setwd(system.file("shapes", package = "maptools"))
> sc90 <- readShapeSpatial("co45_d90")
> proj4string(sc90) <- CRS("+proj=longlat +datum=NAD27")
> setwd(owd)
> ## Get the stamen map
> bbPoly <- bbox(sc90)
> gmap <- get_map(c(bbPoly), maptype='toner', source='stamen', crop=FALSE)
> bbMap <- attr(gmap, 'bb')
> latCenter <- with(bbMap, ll.lat + ur.lat)/2
> lonCenter <- with(bbMap, ll.lon + ur.lon)/2
> height <- with(bbMap, ur.lat - ll.lat)
> width <- with(bbMap, ur.lon - ll.lon)
>
> ## Use latticeExtra::+.trellis and latticeExtra::layer
> spplot(sc90['AREA'], fill='transparent', col='indianred1') +
>                   layer(grid.raster(gmap,
>                                     x=lonCenter, y=latCenter,
>                                     width=width, height=height,
>                                     default.units='native'),
>                         under=TRUE)
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From alobolistas at gmail.com  Tue Apr 29 09:42:35 2014
From: alobolistas at gmail.com (Agustin Lobo)
Date: Tue, 29 Apr 2014 09:42:35 +0200
Subject: [R-sig-Geo] projection of ggmap:get_map() output
In-Reply-To: <535E6C51.9060508@uni-muenster.de>
References: <15399b6d75f748d28822ecdb366ebd84@EX-0-HT0.lancs.local>
	<CANVKczNLjyBAZ2y7FOvDP+c-ZSwABT_6BWK276uJJy=7MEew4w@mail.gmail.com>
	<CAG4NReLZfUtayt+koJvSZJAK1q_vNJAnJmQ_9GBtOc=X2uGqfw@mail.gmail.com>
	<CAG4NReJz-eq6GcGm=cQrMikz9VnhSu=HdpOyQHmB9PUK3e=Xpg@mail.gmail.com>
	<5358C986.9080309@uni-muenster.de>
	<345780f75d2045169a2f656dd4fca6a9@EX-0-HT0.lancs.local>
	<CANVKczMKm4JqLbJ-bvJsEiGc+MdmLf7Fvzgc7NtebODOcRvY9g@mail.gmail.com>
	<53595125.60606@uni-muenster.de>
	<CAMLL7bn87AhW-v=C5yhEZJ7ANVMRQUhg2LDtFgPBGLJu6XKXTA@mail.gmail.com>
	<CAG4NReLf4Xg5-SvJgemMxhif=6-fnm_n6842ofvV27W0Y3R7Ug@mail.gmail.com>
	<CAG4NReLXPL7H39SjX=7v3DgH0WMz757VLyTZ_=fTH6zGvHfywg@mail.gmail.com>
	<CAMLL7bkemZSdiDxjf=X=02K65OAvQkh8Tu-_QE42iKaZ+YkMOA@mail.gmail.com>
	<535E6C51.9060508@uni-muenster.de>
Message-ID: <CAG4NRe++f-6jUFw_8n713kyu1M3Nb+W6jXsybUdjX0nSspYjiw@mail.gmail.com>

This is great information, thanks.
It is clear that without an infrastructure such as the proj4 used by
spTransform() the overlays will never be
without error.

Agus

On Mon, Apr 28, 2014 at 4:57 PM, Edzer Pebesma
<edzer.pebesma at uni-muenster.de> wrote:
> Nice, thank you!
>
> Markus Loecher, author of RgoogleMaps, explained that ggmap uses
>
> https://github.com/dkahle/ggmap/blob/master/R/LonLat2XY.R
>
> to go from long/lat to XY (pixels in google map tiles), which was taken
> from the RgoogleMaps one:
>
> https://github.com/markusloecher/RgoogleMaps/blob/master/R/LatLon2XY.R
>
> which points to code by someone called Neil Young in a google groups:
>
> https://groups.google.com/forum/?hl=en#!topic/Google-Maps-API/0hA6wp6VaW8
>
> I would expect that your cylindrical, equidistant projection (linear in
> long/lat) must collide more with the Mercator used by google when the
> plotted area becomes larger.
>
> On 04/28/2014 11:58 AM, Oscar Perpi?an wrote:
>> Hello,
>>
>> I couldn't run your code because I am not able to read the file.
>> Anyway, some comments about your last email:
>>
>> - "layer" is a function of the latticeExtra package. This function
>> modifies the panel function of a "trellis" graphic produced with a
>> function of the lattice package. This function, together with
>> "+.trellis" (of the same package) allows for overlaying layers. It is
>> important to note that it does not carry out any projection. It only
>> displays the graphical result of another function (for example,
>> sp.polygons or whatever).
>>
>> - You create the canvas with "levelplot" displaying the ggmap raster,
>> and then overlay the data with layer. This is the same approach that
>> ggmap uses. Instead, I prefer to rely on the main data to be displayed
>> to configure the graphical window instead of using an auxiliary image
>> as the starting point.
>>
>> - I'm not a fan of the ggmap approach. I agree with you that the
>> resulting object should include the projection information and even
>> adhere to the sp classes. However, I think that their results are
>> useful if managed with care.
>>
>> In order to show that this is not an issue strictly related to
>> rasterVis::levelplot, I have written some code with spplot. I think
>> that the concordance between the ggmap raster and the shapefile is
>> aceptable.
>>
>> Best,
>>
>> Oscar.
>>
>> ##########################################################
>> library(sp)
>> library(ggmap)
>> ## latticeExtra must be loaded after ggmap because both ggplot2 and
>> ## latticeExtra define a 'layer' function. We need the definition from
>> ## latticeExtra.
>> library(latticeExtra)
>>
>> ## Shape example
>> library(maptools)
>> owd <- getwd()
>> setwd(system.file("shapes", package = "maptools"))
>> sc90 <- readShapeSpatial("co45_d90")
>> proj4string(sc90) <- CRS("+proj=longlat +datum=NAD27")
>> setwd(owd)
>>
>> ## Get the stamen map
>> bbPoly <- bbox(sc90)
>> gmap <- get_map(c(bbPoly), maptype='toner', source='stamen', crop=FALSE)
>> bbMap <- attr(gmap, 'bb')
>> latCenter <- with(bbMap, ll.lat + ur.lat)/2
>> lonCenter <- with(bbMap, ll.lon + ur.lon)/2
>> height <- with(bbMap, ur.lat - ll.lat)
>> width <- with(bbMap, ur.lon - ll.lon)
>>
>> ## Use latticeExtra::+.trellis and latticeExtra::layer
>> spplot(sc90['AREA'], fill='transparent', col='indianred1') +
>>                   layer(grid.raster(gmap,
>>                                     x=lonCenter, y=latCenter,
>>                                     width=width, height=height,
>>                                     default.units='native'),
>>                         under=TRUE)
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> --
> Edzer Pebesma
> Institute for Geoinformatics (ifgi), University of M?nster
> Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
> 83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From oscar.perpinan at upm.es  Tue Apr 29 11:40:03 2014
From: oscar.perpinan at upm.es (=?UTF-8?Q?Oscar_Perpi=C3=B1an?=)
Date: Tue, 29 Apr 2014 11:40:03 +0200
Subject: [R-sig-Geo] projection of ggmap:get_map() output
In-Reply-To: <CAG4NReJg+Av678gvt6isyfLiVfZ7apprx77xKfOi00HONdxjqw@mail.gmail.com>
References: <15399b6d75f748d28822ecdb366ebd84@EX-0-HT0.lancs.local>
	<CANVKczNLjyBAZ2y7FOvDP+c-ZSwABT_6BWK276uJJy=7MEew4w@mail.gmail.com>
	<CAG4NReLZfUtayt+koJvSZJAK1q_vNJAnJmQ_9GBtOc=X2uGqfw@mail.gmail.com>
	<CAG4NReJz-eq6GcGm=cQrMikz9VnhSu=HdpOyQHmB9PUK3e=Xpg@mail.gmail.com>
	<5358C986.9080309@uni-muenster.de>
	<345780f75d2045169a2f656dd4fca6a9@EX-0-HT0.lancs.local>
	<CANVKczMKm4JqLbJ-bvJsEiGc+MdmLf7Fvzgc7NtebODOcRvY9g@mail.gmail.com>
	<53595125.60606@uni-muenster.de>
	<CAMLL7bn87AhW-v=C5yhEZJ7ANVMRQUhg2LDtFgPBGLJu6XKXTA@mail.gmail.com>
	<CAG4NReLf4Xg5-SvJgemMxhif=6-fnm_n6842ofvV27W0Y3R7Ug@mail.gmail.com>
	<CAG4NReLXPL7H39SjX=7v3DgH0WMz757VLyTZ_=fTH6zGvHfywg@mail.gmail.com>
	<CAMLL7bkemZSdiDxjf=X=02K65OAvQkh8Tu-_QE42iKaZ+YkMOA@mail.gmail.com>
	<CAG4NReJg+Av678gvt6isyfLiVfZ7apprx77xKfOi00HONdxjqw@mail.gmail.com>
Message-ID: <CAMLL7bn7gAFE-_etk-brwBQ+63aSjSDD_JrBb2RSVH2xZLAX4g@mail.gmail.com>

>> I couldn't run your code because I am not able to read the file.
> Note dsn is the directory where you have the 4 files and layer is the
> name of the layer, which is the name of the files without extension.

My fault, sorry.

> There has to be a reprojection on the fly because the the two layers of
> the plot are on different coordinate systems. I think it is clear now that
> ggplot uses the Google "PseudoMercator" for the matrix while expects
> all user input on epsg4326

I am not sure what do you mean with "reprojection on the fly" but
"layer" does not make any reprojection.
In fact, it is only a wrapper around
"eval(substitute(expression(...)))" to modify easily the panel
function of a trellis graphic.
However, in my code I am using "grid.raster" with its arguments width,
height, x and y, to resize the ggmap raster and to position it in the
graphic window created with spplot.

> I think "acceptable" depends on the scale only. At coarser scale you
> just do not see the error
> because it is relative to the extent and the result converges to the
> correct  reprojection.

I think it depends on the extent. I have tested the code again with
the administrative boundaries of Spain and some of its regions
(http://biogeo.ucdavis.edu/data/gadm2/shp/ESP_adm.zip).
It fails for the country extent (as Edzer suggested and you have found
with your file) but it works correctly for a smaller extent (code
copied below).

> In the code you provide, how do you know NAD27 is the appropriate datum?
> There is no prj file (one of the big shortcomings of shapefiles is
> that the presence
> of crs information in the form of a prj file is not compulsory). Note
> that you define
> a datum != WGS84 and you do not define the towgs argument.

It is an example extracted from the p.121 of the 2008 edition of
"Applied Spatial Data Analysis with R". That chapter is now available
here: http://cran.r-project.org/web/packages/maptools/vignettes/combine_maptools.pdf

Best,

Oscar.

#######################################################
library(ggmap)
library(latticeExtra)
library(sp)
library(maptools)

## http://biogeo.ucdavis.edu/data/gadm2/shp/ESP_adm.zip
setwd('/tmp')
spain <- readShapePoly('ESP_adm/ESP_adm1')
proj4string(spain) <- CRS("+proj=longlat +datum=WGS84")

andalucia <- spain[spain$ID_1 == 1,]
catalonia <- spain[spain$ID_1 == 6,]

## myPoly <- spain
myPoly <- andalucia
## myPoly <- catalonia

bbPoly <- bbox(myPoly)
gmap <- get_map(c(bbPoly), maptype='watercolor', source='stamen', crop=FALSE)
bbMap <- attr(gmap, 'bb')
latCenter <- with(bbMap, ll.lat + ur.lat)/2
lonCenter <- with(bbMap, ll.lon + ur.lon)/2
height <- with(bbMap, ur.lat - ll.lat)
width <- with(bbMap, ur.lon - ll.lon)

spplot(myPoly["ID_1"], fill='transparent') +
                  layer(grid.raster(gmap,
                                    x=lonCenter, y=latCenter,
                                    width=width, height=height,
                                    default.units='native'),
                        under=TRUE)


From mfiori at arpa.sardegna.it  Tue Apr 29 13:33:26 2014
From: mfiori at arpa.sardegna.it (Michele Fiori)
Date: Tue, 29 Apr 2014 13:33:26 +0200
Subject: [R-sig-Geo]  Regression Kriging cross validation
Message-ID: <001101cf639e$d6cfa9f0$846efdd0$@arpa.sardegna.it>

Hi everyone,
I am working on rainfall interpolation using regression kriging method and I
need suggestions on how I can carry out a cross validation (leave-one-out)
for this elaboration. At first I tried to apply directly Krige.cv, similarly
to UK method (example for october: PP10uk.cv <- krige.cv(reg, prec2,
PP10.vgm)), but unfortunately when I applied Universal Kriging on the same
data, I realized that UK map was a little different from RK map.
So my question is: How could I manage universal kriging in order to make it
equivalent to regression kriging and use the above cross-validation, or is
there 
another different method to apply cross validation (leave-one-out) on
Regression Kriging interpolation?  
Below my code:
Many thanks

Michele Fiori

ARPAS - Environmental Protection Agency of Sardinia
MeteoClimatic Department - Meteorological Service

Viale Porto Torres 119 - 07100 Sassari, Italy
Tel + 39 079 258617
Fax + 39 079 262681
www.sardegnaambiente.it/arpas

####	Creating SpatialPixelDataFrame ("dem" - 250x250 m grid)
	....
####	Loading Precipitation data
   	prec2 <- read.table("prec2.txt", sep="\t", header =TRUE)
  	coordinates(prec2) <- c("x", "y")
   	proj4string(prec2) <- CRS("+init=epsg:32632")
####	Linear regression Model
  	mod.gen <- lm(PP10 ~ QUOTA_MARE + UTM_EST + UTM_NORD + DIST_MARE,
prec2)
  	step1 <- stepAIC(mod.gen, direction="both")
  	reg <- formula(step1)
   	PP10.lm <- lm(reg, prec2)
  	summary(PP10.lm)
   	prec2$residuals <- residuals(PP10.lm)
    	dem$predlm <- predict(PP10.lm, dem)
####	Variogram of residuals
	PP10.vgm <- vgm(nugget=51.46, model="Sph", range=38038.89,
psill=86.44)
####	Ordinary Kriging of residuals
	PP10.okr <- krige(PP10.lm$residuals ~ 1, prec2, dem, PP10.vgm,
maxdist=Inf)
	dem$varokr <- PP10.okr$var1.pred
####	Regression Kriging (Linear Regression + Ordinary Kriging of
residuals)
	dem$vark <- dem$predlm + dem$varokr
####	Universal kriging
	PP10.uk <- krige(reg, prec2, dem, PP10.vgm, maxdist=Inf)
	dem$varuk <- PP10.uk$var1.pred
	dem$difference <- dem$vark - dem$varuk
	spplot(dem[c("difference")], col.regions=terrain.colors(25),
contour=FALSE, cuts = 15)


From agus.camacho at gmail.com  Tue Apr 29 14:39:16 2014
From: agus.camacho at gmail.com (Agus Camacho)
Date: Tue, 29 Apr 2014 09:39:16 -0300
Subject: [R-sig-Geo] Importing only lines from big shape file
In-Reply-To: <alpine.LRH.2.03.1404241913350.11612@reclus.nhh.no>
References: <0069efed9eaa444da414165b4ec9275c@EX-1-HT0.lancs.local>
	<CANVKczNSYPsbdEd35dwZ+7HDcvy7a6uN0M+omahZ-2cDffjruQ@mail.gmail.com>
	<E82BBC061BBD7448BC7905721F497B077020700F@vime-mbx5.rdg.ac.uk>
	<CALsJ7pR75iQCSst+vZ0zM+db-FTwxbJ3fvJgQ8Q0U5sqiOzHYg@mail.gmail.com>
	<alpine.LRH.2.03.1404241839220.11612@reclus.nhh.no>
	<CALsJ7pRMu+b6GP8S+rt7VoZaZHyadWVQZ1ENg6H97d8o0zGigA@mail.gmail.com>
	<CALsJ7pSg_orbMRsReX4xp+rfcxvjc67=oVKsFKEivBRqvFKo4w@mail.gmail.com>
	<alpine.LRH.2.03.1404241913350.11612@reclus.nhh.no>
Message-ID: <CALsJ7pSAU0YSJaEykGOyWtV-4R9CM5wPg+LY-NE995kb4yEOeg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140429/009fffff/attachment.pl>

From pbidanset at gmail.com  Tue Apr 29 14:46:40 2014
From: pbidanset at gmail.com (Paul Bidanset)
Date: Tue, 29 Apr 2014 08:46:40 -0400
Subject: [R-sig-Geo] SPGWR Application to Holdout Sample
Message-ID: <CAD7wDOB1VcsHVQmF1cPrU6x7nWM6ZZPMh92HmYMPa6S+=AFSWQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140429/7ad7841e/attachment.pl>

From wanluhe at 163.com  Tue Apr 29 16:16:00 2014
From: wanluhe at 163.com (wanluhe)
Date: Tue, 29 Apr 2014 22:16:00 +0800 (CST)
Subject: [R-sig-Geo] Tutorial for novice look
Message-ID: <1a78c966.cdbd.145add79f89.Coremail.wanluhe@163.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140429/6b462d7e/attachment.pl>

From Xochitl.Cormon at ifremer.fr  Tue Apr 29 17:08:14 2014
From: Xochitl.Cormon at ifremer.fr (Xochitl.Cormon at ifremer.fr)
Date: Tue, 29 Apr 2014 17:08:14 +0200
Subject: [R-sig-Geo] Dissolve polygons - unionSpatialPolygons - Error :
 isTRUE(gpclibPermitStatus()) is not TRUE
Message-ID: <20140429170814.129546malrdlziam@vdmz1mail.ifremer.fr>

Hi all,

I am trying to merge ICES divisions polygons by subareas i.e. division  
IVa, IVb and IVc in the shapefile and I want to obtain IV (IVa+IVb+IVc).

To realize that I thought to use the function unionSpatialPolygons().  
Is that a good choice?

If yes, I tried to apply it and obtained the error  
"isTRUE(gpclibPermitStatus()) is not TRUE".

I therefore try to find more information about the use of this  
function and download the following example:  
http://www.nceas.ucsb.edu/scicomp/usecases/PolygonDissolveOperationsR


Unfortunately I get the same error and I really don't understand how  
it coudl be as I am using the example script. Maybe something is wrong  
with my R configuration?

Thank you very much for your help,

Best,

Xochitl C.

R.Version()
$platform
[1] "i386-w64-mingw32"

$arch
[1] "i386"

$os
[1] "mingw32"

$system
[1] "i386, mingw32"

$status
[1] ""

$major
[1] "2"

$minor
[1] "15.3"

$year
[1] "2013"

$month
[1] "03"

$day
[1] "01"

$`svn rev`
[1] "62090"

$language
[1] "R"

$version.string
[1] "R version 2.15.3 (2013-03-01)"

$nickname
[1] "Security Blanket"


From jgrn at illinois.edu  Tue Apr 29 17:50:57 2014
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Tue, 29 Apr 2014 10:50:57 -0500
Subject: [R-sig-Geo] Problem merging rasters after conversion and
 reprojection of .hdf file
In-Reply-To: <362E1298-C2A0-46B1-96CD-E80282689AF3@gmail.com>
References: <10530E7E-DE99-43D3-81DE-DD3CD51A294B@gmail.com>
	<CABG0rfvUGK0GFM4ij+pfT4VvzLnPV9MT6oGSY4+TUzFO-6kMNw@mail.gmail.com>
	<CABG0rfvTrJY7ckzbJRqm_=YPObDmC+atUN1oSz1oQBBdcd=v1g@mail.gmail.com>
	<362E1298-C2A0-46B1-96CD-E80282689AF3@gmail.com>
Message-ID: <CABG0rfv_Mda0NdJuK9B44tJqS7FLyJkYfkhH+bYmbAxUqdkzaA@mail.gmail.com>

(cc'ing to r-sig-geo to preserve the info):

Justin:

Right now, mosaic doesn't work directly with HDFs (although I could do
a little tweaking to fix that, I suppose -- I'll look into that) --
you'll want to go ahead and first batch convert the HDFs to e.g.
GeoTIFFs via gdal_translate or (even easier) batch_gdal_translate,
then run the mosaic on the geotiffs.  Let me know how it goes!

--j

On Tue, Apr 29, 2014 at 7:56 AM, Justin Michell <jwm302 at gmail.com> wrote:
> Hi Jonathan
>
> Thanks for you help here. I get the following error when I tried the following as per you advice (and the example for mosaic_rasters). Do I not have the right GDALDriver?:
>
>> gdal_setInstallation()
>> valid_install <- !is.null(getOption("gdalUtils_gdalPath"))
>> valid_install
> [1] TRUE
>> if(require(raster) && require(rgdal) && valid_install)
> + {
> + NDVI_1 <- mosaic_rasters(gdalfile=c(out.files[1],out.files[2], out.files[3],out.files[4], out.files[5], out.files[6]),dst_dataset="NDVI1_mosaic.hdf", separate=F, of=c("HDF4","HDF5"), verbose=TRUE)
> + gdalinfo("NDVI1_mosaic.hdf")
> + }
> Checking gdal_installation...
> GDAL command being used: "/Library/Frameworks/GDAL.framework/Versions/1.10/Programs/gdalbuildvrt" -separate  "/var/folders/t_/dby7tsnj0vgbfxp8hgclyrj80000gn/T//RtmpSKFW71/file17fd953983454.vrt" "MOD13A3.A2013001.h20v08.005.2013042085256.hdf" "MOD13A3.A2013001.h20v09.005.2013042085401.hdf" "MOD13A3.A2013001.h21v08.005.2013042085514.hdf" "MOD13A3.A2013001.h21v09.005.2013042085607.hdf" "MOD13A3.A2013001.h22v08.005.2013042085522.hdf" "MOD13A3.A2013001.h22v09.005.2013042085359.hdf"
> Checking gdal_installation...
> GDAL command being used: "/Library/Frameworks/GDAL.framework/Versions/1.10/Programs/gdal_translate" -of "HDF4" -of "HDF5" "/var/folders/t_/dby7tsnj0vgbfxp8hgclyrj80000gn/T//RtmpSKFW71/file17fd953983454.vrt" "NDVI1_mosaic.hdf"
> Input file size is 3600, 24000
> character(0)
> attr(,"status")
> [1] 1
> Warning messages:
> 1: running command '"/Library/Frameworks/GDAL.framework/Versions/1.10/Programs/gdal_translate" -of "HDF4" -of "HDF5" "/var/folders/t_/dby7tsnj0vgbfxp8hgclyrj80000gn/T//RtmpSKFW71/file17fd953983454.vrt" "NDVI1_mosaic.hdf"' had status 1
> 2: running command '"/Library/Frameworks/GDAL.framework/Versions/1.10/Programs/gdalinfo" "NDVI1_mosaic.hdf"' had status 1
> ERROR 6: GDALDriver::Create() ... no create method implemented for this format.
>
> ERROR 4: `NDVI1_mosaic.hdf' does not exist in the file system,
> and is not recognised as a supported dataset name.
>
> gdalinfo failed - unable to open 'NDVI1_mosaic.hdf?.
>
>
> Cheers
> Justin
>
>
>
>
>
>
> On Apr 28, 2014, at 3:17 PM, Jonathan Greenberg <jgrn at illinois.edu> wrote:
>
>> Also note you can use ?batch_gdal_translate to do your HDF -> TIF conversions.
>>
>> --j
>>
>> On Mon, Apr 28, 2014 at 8:12 AM, Jonathan Greenberg <jgrn at illinois.edu> wrote:
>>> Justin:
>>>
>>> Couple of comments:
>>>
>>> 1) In general, I find it easier to mosaic FIRST and then reproject
>>> SECOND -- when you reproject first, mosaic second, you can get weird
>>> issues particularly along the seams.
>>> 2) Since you are already using gdalUtils, have you tried
>>> ?mosaic_rasters (which will be faster than merge() in all likelihood,
>>> since it uses the base GDAL mosaicking capabilities)?  Make sure
>>> separate=FALSE for this particular application.
>>>
>>> --j
>>>
>>> On Mon, Apr 28, 2014 at 7:18 AM, Justin Michell <jwm302 at gmail.com> wrote:
>>>> Dear Group
>>>>
>>>> I am dealing with the task of preprocessing and re-projecting MODIS gridded tiles in .hdf format from Sinusoidal projection, in R, to a geographic projection. I would like to align all my other climate layers (from worldclim.org) which are at 1km resolution to my NDVI layers. I am using the gdal_utils package in R, and only one subset I?m interested in (monthly NDVI). I am working on Mac OS and grabbed gdal from here: http://www.kyngchaos.com/software/frameworks .
>>>>
>>>> To do this I use the following code (previous list entries relating to gdalUtils have assisted me up till this point):
>>>>
>>>> # download all available monthly images for the year 2013 - MODIS PRODUCT (MOD13A3, Terra, Vegetation Indices, Tile, 1000m, Monthly)
>>>> ModisDownload(x="MOD13A3",h=c(20,21,22),v=c(8,9),dates=c('2013.01.01','2013.12.31'),mosaic=F,proj=F)
>>>>
>>>> # extract the NDVI band (sd_index=1) and converts to .tiff for 1 tile for January
>>>> gdal_translate("MOD13A3.A2013001.h20v08.005.2013042085256.hdf", "Jan_1.tiff", sd_index=1)
>>>>
>>>> # converts projection to Geog WGS84
>>>> gdalwarp(?Jan_1.tiff","MODIS_NDVI/NDVIJan_1.tiff", s_srs="+proj=sinu +lon_0=0 +x_0=0 +y_0=0 +a=6371007.181 +b=6371007.181 +units=m +no_defs",t_srs="+proj=longlat +datum=WGS84 +no_defs",srcnodata=-3000,dstnodata=-3000)
>>>>
>>>> I have 6 tiles per month (covering Kenya). For each month I?d like to merge all 6 tiles using the raster package (to cover Kenya). For January I perform the following operation using the merge function in the raster package:
>>>>
>>>> NDVI1  <- (merge(raster("MODIS_NDVI/NDVIJan_1.tiff"),raster("MODIS_NDVI/NDVIJan_2.tiff"),raster("MODIS_NDVI/NDVIJan_3.tiff"), raster("MODIS_NDVI/NDVIJan_4.tiff"), raster("MODIS_NDVI/NDVIJan_5.tiff"), raster("MODIS_NDVI/NDVIJan_6.tiff"), tolerance=0.5))*0.0001
>>>> NDVI1 <- crop(NDVI1, extent(kenya))
>>>>
>>>> Without including the tolerance argument I get an error:
>>>>
>>>> Error in compareRaster(x, extent = FALSE, rowcol = FALSE, orig = TRUE,  :
>>>>  different origin
>>>>
>>>> But after this merge a lot of NA?s are introduced and the plot doesn?t look right (as it did before for each tile).
>>>>
>>>> The resolution is not exactly the same. Here are a comparison of the layers (before merging NDVI tiles) and my SpatialPolygonsDataFrame called kenya, as well as my r sessionInfo() printed below:
>>>>
>>>>
>>>>> n1 <- raster("MODIS_NDVI/NDVIJan_1.tiff")
>>>>> n1
>>>> class       : RasterLayer
>>>> dimensions  : 1219, 1275, 1554225  (nrow, ncol, ncell)
>>>> resolution  : 0.008205785, 0.008205785  (x, y)
>>>> extent      : 20, 30.46238, -0.002852273, 10  (xmin, xmax, ymin, ymax)
>>>> coord. ref. : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0
>>>> data source : /Users/justinmichell/MODIS_NDVI/NDVIJan_1.tiff
>>>> names       : NDVIJan_1
>>>> values      : -32768, 32767  (min, max)
>>>>
>>>>> meanTemp1
>>>> class       : RasterLayer
>>>> dimensions  : 1115, 960, 1070400  (nrow, ncol, ncell)
>>>> resolution  : 0.008333333, 0.008333333  (x, y)
>>>> extent      : 33.90833, 41.90833, -4.666667, 4.625  (xmin, xmax, ymin, ymax)
>>>> coord. ref. : +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0
>>>> data source : in memory
>>>> names       : layer
>>>> values      : -4.4, 30  (min, max)
>>>>
>>>>> kenya
>>>> class       : SpatialPolygonsDataFrame
>>>> features    : 1
>>>> extent      : 33.90722, 41.90517, -4.669618, 4.622499  (xmin, xmax, ymin, ymax)
>>>> coord. ref. : +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0
>>>> variables   : 11
>>>> names       : FIPS, ISO2, ISO3,  UN,  NAME,  AREA,  POP2005, REGION, SUBREGION,    LON,  LAT
>>>> min values  :   KE,   KE,  KEN, 404, Kenya, 56914, 35598952,      2,        14, 37.858, 0.53
>>>> max values  :   KE,   KE,  KEN, 404, Kenya, 56914, 35598952,      2,        14, 37.858, 0.53
>>>>
>>>>> sessionInfo()
>>>> R version 3.0.2 (2013-09-25)
>>>> Platform: x86_64-apple-darwin10.8.0 (64-bit)
>>>>
>>>> locale:
>>>> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>>>>
>>>> attached base packages:
>>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>>
>>>> other attached packages:
>>>> [1] gdalUtils_0.2.0 rgdal_0.8-14    RCurl_1.95-4.1  bitops_1.0-6    raster_2.2-12   sp_1.0-14
>>>>
>>>> loaded via a namespace (and not attached):
>>>> [1] codetools_0.2-8      foreach_1.4.1        grid_3.0.2           iterators_1.0.6      lattice_0.20-24      scatterplot3d_0.3-34
>>>>
>>>>
>>>> Thanks very much,
>>>> Justin Michell
>>>>
>>>>
>>>>
>>>>
>>>>
>>>>
>>>>
>>>>
>>>>
>>>>
>>>>
>>>>        [[alternative HTML version deleted]]
>>>>
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>
>>>
>>>
>>> --
>>> Jonathan A. Greenberg, PhD
>>> Assistant Professor
>>> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
>>> Department of Geography and Geographic Information Science
>>> University of Illinois at Urbana-Champaign
>>> 259 Computing Applications Building, MC-150
>>> 605 East Springfield Avenue
>>> Champaign, IL  61820-6371
>>> Phone: 217-300-1924
>>> http://www.geog.illinois.edu/~jgrn/
>>> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
>>
>>
>>
>> --
>> Jonathan A. Greenberg, PhD
>> Assistant Professor
>> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
>> Department of Geography and Geographic Information Science
>> University of Illinois at Urbana-Champaign
>> 259 Computing Applications Building, MC-150
>> 605 East Springfield Avenue
>> Champaign, IL  61820-6371
>> Phone: 217-300-1924
>> http://www.geog.illinois.edu/~jgrn/
>> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
>



-- 
Jonathan A. Greenberg, PhD
Assistant Professor
Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
Department of Geography and Geographic Information Science
University of Illinois at Urbana-Champaign
259 Computing Applications Building, MC-150
605 East Springfield Avenue
Champaign, IL  61820-6371
Phone: 217-300-1924
http://www.geog.illinois.edu/~jgrn/
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007


From jgrn at illinois.edu  Tue Apr 29 17:55:14 2014
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Tue, 29 Apr 2014 10:55:14 -0500
Subject: [R-sig-Geo] Access WMS (and alike) services from R?
In-Reply-To: <CAG4NReK9Lj0bwDSqbJU0bCXUQDjDvn5XMOOCZxfSLefnytgMpQ@mail.gmail.com>
References: <CAG4NReJwsCWwVyzoR4bB2mys7A1OzcKDTvxQ=XPjcyo41fJ4qA@mail.gmail.com>
	<alpine.LRH.2.03.1404231405410.32337@reclus.nhh.no>
	<CAG4NReK9Lj0bwDSqbJU0bCXUQDjDvn5XMOOCZxfSLefnytgMpQ@mail.gmail.com>
Message-ID: <CABG0rft6pfh8DfHho=pBDOyGRcAB1C6_AbWyqL9nrLXaDD+tEw@mail.gmail.com>

I haven't tested this exact application yet, but perhaps try gdalUtils
(which are wrappers for the gdal utilities, and use an independent
GDAL install).  Let me know if it works!

--j

On Wed, Apr 23, 2014 at 8:34 AM, Agustin Lobo <alobolistas at gmail.com> wrote:
> According to gdalDrivers(), I have
> 115             WCS                                       OGC Web
> Coverage Service  FALSE FALSE
> 116             WMS                                      OGC Web Map
> Service  FALSE  TRUE
>
>
> which I understand implies that I should be able to read wms.
>
> I'll see if I can find someone interested on building this type of utility in R.
>
> Agus
>
> Details on my system (linuxmint 15, based on ubuntu raring) (gdal from
> ubuntugis-unstable):
>> require(rgdal)
> Loading required package: rgdal
> Loading required package: sp
> rgdal: version: 0.8-16, (SVN revision 498)
> Geospatial Data Abstraction Library extensions to R successfully loaded
> Loaded GDAL runtime: GDAL 1.10.0, released 2013/04/24
> Path to GDAL shared files: /usr/share/gdal/1.10
> Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
> Path to PROJ.4 shared files: (autodetected)
>
>> sessionInfo()
> R version 3.0.2 (2013-09-25)
> Platform: x86_64-pc-linux-gnu (64-bit)
>
> locale:
>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
> LC_TIME=es_ES.UTF-8        LC_COLLATE=en_US.UTF-8
>  [5] LC_MONETARY=es_ES.UTF-8    LC_MESSAGES=en_US.UTF-8
> LC_PAPER=es_ES.UTF-8       LC_NAME=C
>  [9] LC_ADDRESS=C               LC_TELEPHONE=C
> LC_MEASUREMENT=es_ES.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] grid      stats     graphics  grDevices utils     datasets
> methods   base
>
> other attached packages:
>  [1] rasterVis_0.27      hexbin_1.26.3       latticeExtra_0.6-26
> lattice_0.20-24     RColorBrewer_1.0-5
>  [6] ggmap_2.3           ggplot2_0.9.3.1     raster_2.2-31
> rgdal_0.8-16        sp_1.0-14
>
> loaded via a namespace (and not attached):
>  [1] colorspace_1.2-4    dichromat_2.0-0     digest_0.6.4
> gtable_0.1.2        labeling_0.2
>  [6] mapproj_1.2-1       maps_2.3-6          MASS_7.3-29
> munsell_0.4.2       plyr_1.8
> [11] png_0.1-7           proto_0.3-10        reshape2_1.2.2
> RgoogleMaps_1.2.0.5 rjson_0.2.13
> [16] RJSONIO_1.0-3       scales_0.2.3        stringr_0.6.2
> tools_3.0.2         zoo_1.7-10
>
> $ uname -a
> Linux Delia 3.8.0-35-generic #50-Ubuntu SMP Tue Dec 3 01:24:59 UTC
> 2013 x86_64 x86_64 x86_64 GNU/Linux
>
>
>
> On Wed, Apr 23, 2014 at 2:09 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>> On Wed, 23 Apr 2014, Agustin Lobo wrote:
>>
>>> Hi!
>>>
>>> Is there any project attempting to access remote geoservices such as
>>> WMS in a similar way
>>> as it is done with google maps (i.e. through ggmap:get_map()) ?
>>
>>
>> I've no idea how ggmap does this, or whether it uses WMS. Your GDAL may have
>> been built with a WMS driver - see gdalDrivers() to check. The CRAN Windows
>> rgdal binary does not have this driver. For driver details see:
>>
>> http://www.gdal.org/frmt_wms.html
>>
>> which has examples of the short xml files needed to configure access to such
>> services.
>>
>> Roger
>>
>>>
>>> Agus
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>> --
>> Roger Bivand
>> Department of Economics, Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 91 00
>> e-mail: Roger.Bivand at nhh.no
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Jonathan A. Greenberg, PhD
Assistant Professor
Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
Department of Geography and Geographic Information Science
University of Illinois at Urbana-Champaign
259 Computing Applications Building, MC-150
605 East Springfield Avenue
Champaign, IL  61820-6371
Phone: 217-300-1924
http://www.geog.illinois.edu/~jgrn/
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007


From rubenfcasal at gmail.com  Tue Apr 29 19:48:50 2014
From: rubenfcasal at gmail.com (rubenfcasal)
Date: Tue, 29 Apr 2014 19:48:50 +0200
Subject: [R-sig-Geo] Regression Kriging cross validation
In-Reply-To: <001101cf639e$d6cfa9f0$846efdd0$@arpa.sardegna.it>
References: <001101cf639e$d6cfa9f0$846efdd0$@arpa.sardegna.it>
Message-ID: <535FE602.8070605@gmail.com>

Hello Michele,

     Universal kriging is equivalent to Linear Regression (with the 
generalized-least-squaresestimator) + Simple Kriging of residuals (e.g. 
Cressie, 1993, section 3.4.5). The differences you observe are probably 
due to the use of ordinary least squares. If you use (leave-one-out) 
cross-validation with krige.cv (considering the UK model), the trend is 
also re-estimated at each prediction location. From my point of view, 
this would be the recommended way to proceed.
     As far as I know, there are no available implementations of the 
procedure you are suggesting.

     Best regards,
         Rub?n.


El 29/04/2014 13:33, Michele Fiori escribi?:
> Hi everyone,
> I am working on rainfall interpolation using regression kriging method and I
> need suggestions on how I can carry out a cross validation (leave-one-out)
> for this elaboration. At first I tried to apply directly Krige.cv, similarly
> to UK method (example for october: PP10uk.cv <- krige.cv(reg, prec2,
> PP10.vgm)), but unfortunately when I applied Universal Kriging on the same
> data, I realized that UK map was a little different from RK map.
> So my question is: How could I manage universal kriging in order to make it
> equivalent to regression kriging and use the above cross-validation, or is
> there
> another different method to apply cross validation (leave-one-out) on
> Regression Kriging interpolation?
> Below my code:
> Many thanks
>
> Michele Fiori
>
> ARPAS - Environmental Protection Agency of Sardinia
> MeteoClimatic Department - Meteorological Service
>
> Viale Porto Torres 119 - 07100 Sassari, Italy
> Tel + 39 079 258617
> Fax + 39 079 262681
> www.sardegnaambiente.it/arpas
>
> ####	Creating SpatialPixelDataFrame ("dem" - 250x250 m grid)
> 	....
> ####	Loading Precipitation data
>     	prec2 <- read.table("prec2.txt", sep="\t", header =TRUE)
>    	coordinates(prec2) <- c("x", "y")
>     	proj4string(prec2) <- CRS("+init=epsg:32632")
> ####	Linear regression Model
>    	mod.gen <- lm(PP10 ~ QUOTA_MARE + UTM_EST + UTM_NORD + DIST_MARE,
> prec2)
>    	step1 <- stepAIC(mod.gen, direction="both")
>    	reg <- formula(step1)
>     	PP10.lm <- lm(reg, prec2)
>    	summary(PP10.lm)
>     	prec2$residuals <- residuals(PP10.lm)
>      	dem$predlm <- predict(PP10.lm, dem)
> ####	Variogram of residuals
> 	PP10.vgm <- vgm(nugget=51.46, model="Sph", range=38038.89,
> psill=86.44)
> ####	Ordinary Kriging of residuals
> 	PP10.okr <- krige(PP10.lm$residuals ~ 1, prec2, dem, PP10.vgm,
> maxdist=Inf)
> 	dem$varokr <- PP10.okr$var1.pred
> ####	Regression Kriging (Linear Regression + Ordinary Kriging of
> residuals)
> 	dem$vark <- dem$predlm + dem$varokr
> ####	Universal kriging
> 	PP10.uk <- krige(reg, prec2, dem, PP10.vgm, maxdist=Inf)
> 	dem$varuk <- PP10.uk$var1.pred
> 	dem$difference <- dem$vark - dem$varuk
> 	spplot(dem[c("difference")], col.regions=terrain.colors(25),
> contour=FALSE, cuts = 15)
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From richjh1916 at yahoo.com  Tue Apr 29 21:18:02 2014
From: richjh1916 at yahoo.com (richard hewitt)
Date: Tue, 29 Apr 2014 20:18:02 +0100 (BST)
Subject: [R-sig-Geo] assign values to raster according to row and columns
	from a dataframe
Message-ID: <1398799082.92570.YahooMailNeo@web172704.mail.ir2.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140429/ea3030e6/attachment.pl>

From holland.aggie at gmail.com  Tue Apr 29 22:45:02 2014
From: holland.aggie at gmail.com (James Holland)
Date: Tue, 29 Apr 2014 15:45:02 -0500
Subject: [R-sig-Geo] plotGooglemaps - Problem with the legend
Message-ID: <CABdaQ+tODwM+rY6EzvqJgPLy=AQhP7YLgagVYjn7OswbZF3eJA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140429/69f16970/attachment.pl>

From jwm302 at gmail.com  Wed Apr 30 01:10:01 2014
From: jwm302 at gmail.com (Justin Michell)
Date: Wed, 30 Apr 2014 01:10:01 +0200
Subject: [R-sig-Geo] Problem merging rasters after conversion and
	reprojection of .hdf file
In-Reply-To: <362E1298-C2A0-46B1-96CD-E80282689AF3@gmail.com>
References: <10530E7E-DE99-43D3-81DE-DD3CD51A294B@gmail.com>
	<CABG0rfvUGK0GFM4ij+pfT4VvzLnPV9MT6oGSY4+TUzFO-6kMNw@mail.gmail.com>
	<CABG0rfvTrJY7ckzbJRqm_=YPObDmC+atUN1oSz1oQBBdcd=v1g@mail.gmail.com>
	<362E1298-C2A0-46B1-96CD-E80282689AF3@gmail.com>
Message-ID: <842A85E8-E6D1-4C2A-A054-D1371AD028EB@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140430/7d4d7671/attachment.pl>

From milan.kili11 at gmail.com  Wed Apr 30 09:00:17 2014
From: milan.kili11 at gmail.com (Milan Kilibarda)
Date: Wed, 30 Apr 2014 09:00:17 +0200
Subject: [R-sig-Geo] plotGooglemaps - Problem with the legend
In-Reply-To: <CABdaQ+tODwM+rY6EzvqJgPLy=AQhP7YLgagVYjn7OswbZF3eJA@mail.gmail.com>
References: <CABdaQ+tODwM+rY6EzvqJgPLy=AQhP7YLgagVYjn7OswbZF3eJA@mail.gmail.com>
Message-ID: <CAPSaU-_BUQfSi0CH5OBMnntL8QzFreemN=RAgG8gxEQL93Oftg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140430/23e0538a/attachment.pl>

From alobolistas at gmail.com  Wed Apr 30 09:58:14 2014
From: alobolistas at gmail.com (Agustin Lobo)
Date: Wed, 30 Apr 2014 09:58:14 +0200
Subject: [R-sig-Geo] Access WMS (and alike) services from R?
In-Reply-To: <CABG0rft6pfh8DfHho=pBDOyGRcAB1C6_AbWyqL9nrLXaDD+tEw@mail.gmail.com>
References: <CAG4NReJwsCWwVyzoR4bB2mys7A1OzcKDTvxQ=XPjcyo41fJ4qA@mail.gmail.com>
	<alpine.LRH.2.03.1404231405410.32337@reclus.nhh.no>
	<CAG4NReK9Lj0bwDSqbJU0bCXUQDjDvn5XMOOCZxfSLefnytgMpQ@mail.gmail.com>
	<CABG0rft6pfh8DfHho=pBDOyGRcAB1C6_AbWyqL9nrLXaDD+tEw@mail.gmail.com>
Message-ID: <CAG4NReKo29EofOzLUH9mEi1W7u5Hjh=TWsLDTyhychxej-J7eg@mail.gmail.com>

Actually had found this
http://www.gdal.org/frmt_wms.html

My idea is using qgis for the interactive selection of the wms
service, layer and window, and then
make the xml and request the layer in R.

A bridge between qgis to R for raster layers, similar to the no-longer
working manageR plugin for vector layers,
would be another solution, but would imply writing to disk a raster layer.

Unfortunately cannot do this myself, trying to find an interested ms student.

Agus

On Tue, Apr 29, 2014 at 5:55 PM, Jonathan Greenberg <jgrn at illinois.edu> wrote:
> I haven't tested this exact application yet, but perhaps try gdalUtils
> (which are wrappers for the gdal utilities, and use an independent
> GDAL install).  Let me know if it works!
>
> --j
>
> On Wed, Apr 23, 2014 at 8:34 AM, Agustin Lobo <alobolistas at gmail.com> wrote:
>> According to gdalDrivers(), I have
>> 115             WCS                                       OGC Web
>> Coverage Service  FALSE FALSE
>> 116             WMS                                      OGC Web Map
>> Service  FALSE  TRUE
>>
>>
>> which I understand implies that I should be able to read wms.
>>
>> I'll see if I can find someone interested on building this type of utility in R.
>>
>> Agus
>>
>> Details on my system (linuxmint 15, based on ubuntu raring) (gdal from
>> ubuntugis-unstable):
>>> require(rgdal)
>> Loading required package: rgdal
>> Loading required package: sp
>> rgdal: version: 0.8-16, (SVN revision 498)
>> Geospatial Data Abstraction Library extensions to R successfully loaded
>> Loaded GDAL runtime: GDAL 1.10.0, released 2013/04/24
>> Path to GDAL shared files: /usr/share/gdal/1.10
>> Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
>> Path to PROJ.4 shared files: (autodetected)
>>
>>> sessionInfo()
>> R version 3.0.2 (2013-09-25)
>> Platform: x86_64-pc-linux-gnu (64-bit)
>>
>> locale:
>>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>> LC_TIME=es_ES.UTF-8        LC_COLLATE=en_US.UTF-8
>>  [5] LC_MONETARY=es_ES.UTF-8    LC_MESSAGES=en_US.UTF-8
>> LC_PAPER=es_ES.UTF-8       LC_NAME=C
>>  [9] LC_ADDRESS=C               LC_TELEPHONE=C
>> LC_MEASUREMENT=es_ES.UTF-8 LC_IDENTIFICATION=C
>>
>> attached base packages:
>> [1] grid      stats     graphics  grDevices utils     datasets
>> methods   base
>>
>> other attached packages:
>>  [1] rasterVis_0.27      hexbin_1.26.3       latticeExtra_0.6-26
>> lattice_0.20-24     RColorBrewer_1.0-5
>>  [6] ggmap_2.3           ggplot2_0.9.3.1     raster_2.2-31
>> rgdal_0.8-16        sp_1.0-14
>>
>> loaded via a namespace (and not attached):
>>  [1] colorspace_1.2-4    dichromat_2.0-0     digest_0.6.4
>> gtable_0.1.2        labeling_0.2
>>  [6] mapproj_1.2-1       maps_2.3-6          MASS_7.3-29
>> munsell_0.4.2       plyr_1.8
>> [11] png_0.1-7           proto_0.3-10        reshape2_1.2.2
>> RgoogleMaps_1.2.0.5 rjson_0.2.13
>> [16] RJSONIO_1.0-3       scales_0.2.3        stringr_0.6.2
>> tools_3.0.2         zoo_1.7-10
>>
>> $ uname -a
>> Linux Delia 3.8.0-35-generic #50-Ubuntu SMP Tue Dec 3 01:24:59 UTC
>> 2013 x86_64 x86_64 x86_64 GNU/Linux
>>
>>
>>
>> On Wed, Apr 23, 2014 at 2:09 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>>> On Wed, 23 Apr 2014, Agustin Lobo wrote:
>>>
>>>> Hi!
>>>>
>>>> Is there any project attempting to access remote geoservices such as
>>>> WMS in a similar way
>>>> as it is done with google maps (i.e. through ggmap:get_map()) ?
>>>
>>>
>>> I've no idea how ggmap does this, or whether it uses WMS. Your GDAL may have
>>> been built with a WMS driver - see gdalDrivers() to check. The CRAN Windows
>>> rgdal binary does not have this driver. For driver details see:
>>>
>>> http://www.gdal.org/frmt_wms.html
>>>
>>> which has examples of the short xml files needed to configure access to such
>>> services.
>>>
>>> Roger
>>>
>>>>
>>>> Agus
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>
>>> --
>>> Roger Bivand
>>> Department of Economics, Norwegian School of Economics,
>>> Helleveien 30, N-5045 Bergen, Norway.
>>> voice: +47 55 95 93 55; fax +47 55 95 91 00
>>> e-mail: Roger.Bivand at nhh.no
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>
> --
> Jonathan A. Greenberg, PhD
> Assistant Professor
> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
> Department of Geography and Geographic Information Science
> University of Illinois at Urbana-Champaign
> 259 Computing Applications Building, MC-150
> 605 East Springfield Avenue
> Champaign, IL  61820-6371
> Phone: 217-300-1924
> http://www.geog.illinois.edu/~jgrn/
> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From joona.lehtomaki at cs.helsinki.fi  Wed Apr 30 10:19:29 2014
From: joona.lehtomaki at cs.helsinki.fi (=?ISO-8859-1?Q?Joona_Lehtom=E4ki?=)
Date: Wed, 30 Apr 2014 11:19:29 +0300
Subject: [R-sig-Geo] Access WMS (and alike) services from R?
In-Reply-To: <CAG4NReKo29EofOzLUH9mEi1W7u5Hjh=TWsLDTyhychxej-J7eg@mail.gmail.com>
References: <CAG4NReJwsCWwVyzoR4bB2mys7A1OzcKDTvxQ=XPjcyo41fJ4qA@mail.gmail.com>	<alpine.LRH.2.03.1404231405410.32337@reclus.nhh.no>	<CAG4NReK9Lj0bwDSqbJU0bCXUQDjDvn5XMOOCZxfSLefnytgMpQ@mail.gmail.com>	<CABG0rft6pfh8DfHho=pBDOyGRcAB1C6_AbWyqL9nrLXaDD+tEw@mail.gmail.com>
	<CAG4NReKo29EofOzLUH9mEi1W7u5Hjh=TWsLDTyhychxej-J7eg@mail.gmail.com>
Message-ID: <5360B211.3050505@cs.helsinki.fi>

Hi Agustin,

A while ago I wrote some code for dealing with WMS from R which can be 
found here:

https://github.com/louhos/takomo/tree/master/GIS

The idea was to define WMS URLs in a separate file and then create the 
necessary XML specs for rgdal dynamically. Unfortunately the URLs have 
gone stale since so the code can't easily be tested right now and I have 
no plans to fix the URLs. But just in case you might find something 
useful in there.

Cheers,

Joona

On 04/30/2014 10:58 AM, Agustin Lobo wrote:
> Actually had found this
> http://www.gdal.org/frmt_wms.html
>
> My idea is using qgis for the interactive selection of the wms
> service, layer and window, and then
> make the xml and request the layer in R.
>
> A bridge between qgis to R for raster layers, similar to the no-longer
> working manageR plugin for vector layers,
> would be another solution, but would imply writing to disk a raster layer.
>
> Unfortunately cannot do this myself, trying to find an interested ms student.
>
> Agus
>
> On Tue, Apr 29, 2014 at 5:55 PM, Jonathan Greenberg <jgrn at illinois.edu> wrote:
>> I haven't tested this exact application yet, but perhaps try gdalUtils
>> (which are wrappers for the gdal utilities, and use an independent
>> GDAL install).  Let me know if it works!
>>
>> --j
>>
>> On Wed, Apr 23, 2014 at 8:34 AM, Agustin Lobo <alobolistas at gmail.com> wrote:
>>> According to gdalDrivers(), I have
>>> 115             WCS                                       OGC Web
>>> Coverage Service  FALSE FALSE
>>> 116             WMS                                      OGC Web Map
>>> Service  FALSE  TRUE
>>>
>>>
>>> which I understand implies that I should be able to read wms.
>>>
>>> I'll see if I can find someone interested on building this type of utility in R.
>>>
>>> Agus
>>>
>>> Details on my system (linuxmint 15, based on ubuntu raring) (gdal from
>>> ubuntugis-unstable):
>>>> require(rgdal)
>>> Loading required package: rgdal
>>> Loading required package: sp
>>> rgdal: version: 0.8-16, (SVN revision 498)
>>> Geospatial Data Abstraction Library extensions to R successfully loaded
>>> Loaded GDAL runtime: GDAL 1.10.0, released 2013/04/24
>>> Path to GDAL shared files: /usr/share/gdal/1.10
>>> Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
>>> Path to PROJ.4 shared files: (autodetected)
>>>
>>>> sessionInfo()
>>> R version 3.0.2 (2013-09-25)
>>> Platform: x86_64-pc-linux-gnu (64-bit)
>>>
>>> locale:
>>>   [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>>> LC_TIME=es_ES.UTF-8        LC_COLLATE=en_US.UTF-8
>>>   [5] LC_MONETARY=es_ES.UTF-8    LC_MESSAGES=en_US.UTF-8
>>> LC_PAPER=es_ES.UTF-8       LC_NAME=C
>>>   [9] LC_ADDRESS=C               LC_TELEPHONE=C
>>> LC_MEASUREMENT=es_ES.UTF-8 LC_IDENTIFICATION=C
>>>
>>> attached base packages:
>>> [1] grid      stats     graphics  grDevices utils     datasets
>>> methods   base
>>>
>>> other attached packages:
>>>   [1] rasterVis_0.27      hexbin_1.26.3       latticeExtra_0.6-26
>>> lattice_0.20-24     RColorBrewer_1.0-5
>>>   [6] ggmap_2.3           ggplot2_0.9.3.1     raster_2.2-31
>>> rgdal_0.8-16        sp_1.0-14
>>>
>>> loaded via a namespace (and not attached):
>>>   [1] colorspace_1.2-4    dichromat_2.0-0     digest_0.6.4
>>> gtable_0.1.2        labeling_0.2
>>>   [6] mapproj_1.2-1       maps_2.3-6          MASS_7.3-29
>>> munsell_0.4.2       plyr_1.8
>>> [11] png_0.1-7           proto_0.3-10        reshape2_1.2.2
>>> RgoogleMaps_1.2.0.5 rjson_0.2.13
>>> [16] RJSONIO_1.0-3       scales_0.2.3        stringr_0.6.2
>>> tools_3.0.2         zoo_1.7-10
>>>
>>> $ uname -a
>>> Linux Delia 3.8.0-35-generic #50-Ubuntu SMP Tue Dec 3 01:24:59 UTC
>>> 2013 x86_64 x86_64 x86_64 GNU/Linux
>>>
>>>
>>>
>>> On Wed, Apr 23, 2014 at 2:09 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>>>> On Wed, 23 Apr 2014, Agustin Lobo wrote:
>>>>
>>>>> Hi!
>>>>>
>>>>> Is there any project attempting to access remote geoservices such as
>>>>> WMS in a similar way
>>>>> as it is done with google maps (i.e. through ggmap:get_map()) ?
>>>>
>>>>
>>>> I've no idea how ggmap does this, or whether it uses WMS. Your GDAL may have
>>>> been built with a WMS driver - see gdalDrivers() to check. The CRAN Windows
>>>> rgdal binary does not have this driver. For driver details see:
>>>>
>>>> http://www.gdal.org/frmt_wms.html
>>>>
>>>> which has examples of the short xml files needed to configure access to such
>>>> services.
>>>>
>>>> Roger
>>>>
>>>>>
>>>>> Agus
>>>>>
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>
>>>>
>>>> --
>>>> Roger Bivand
>>>> Department of Economics, Norwegian School of Economics,
>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>> voice: +47 55 95 93 55; fax +47 55 95 91 00
>>>> e-mail: Roger.Bivand at nhh.no
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>>
>> --
>> Jonathan A. Greenberg, PhD
>> Assistant Professor
>> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
>> Department of Geography and Geographic Information Science
>> University of Illinois at Urbana-Champaign
>> 259 Computing Applications Building, MC-150
>> 605 East Springfield Avenue
>> Champaign, IL  61820-6371
>> Phone: 217-300-1924
>> http://www.geog.illinois.edu/~jgrn/
>> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From Roger.Bivand at nhh.no  Wed Apr 30 10:39:05 2014
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 30 Apr 2014 10:39:05 +0200
Subject: [R-sig-Geo] Dissolve polygons - unionSpatialPolygons - Error :
 isTRUE(gpclibPermitStatus()) is not TRUE
In-Reply-To: <20140429170814.129546malrdlziam@vdmz1mail.ifremer.fr>
References: <20140429170814.129546malrdlziam@vdmz1mail.ifremer.fr>
Message-ID: <alpine.LRH.2.03.1404301037200.31935@reclus.nhh.no>

On Tue, 29 Apr 2014, Xochitl.Cormon at ifremer.fr wrote:

> Hi all,
>
> I am trying to merge ICES divisions polygons by subareas i.e. division IVa, 
> IVb and IVc in the shapefile and I want to obtain IV (IVa+IVb+IVc).
>
> To realize that I thought to use the function unionSpatialPolygons(). Is that 
> a good choice?

Yes.

>
> If yes, I tried to apply it and obtained the error 
> "isTRUE(gpclibPermitStatus()) is not TRUE".
>

Please install rgeos which the function will use instead; gpclib should no 
longer be used, but support is retained for backward compatibility.

Hope this clarifies,

Roger

> I therefore try to find more information about the use of this function and 
> download the following example: 
> http://www.nceas.ucsb.edu/scicomp/usecases/PolygonDissolveOperationsR
>
>
> Unfortunately I get the same error and I really don't understand how it coudl 
> be as I am using the example script. Maybe something is wrong with my R 
> configuration?
>
> Thank you very much for your help,
>
> Best,
>
> Xochitl C.
>
> R.Version()
> $platform
> [1] "i386-w64-mingw32"
>
> $arch
> [1] "i386"
>
> $os
> [1] "mingw32"
>
> $system
> [1] "i386, mingw32"
>
> $status
> [1] ""
>
> $major
> [1] "2"
>
> $minor
> [1] "15.3"
>
> $year
> [1] "2013"
>
> $month
> [1] "03"
>
> $day
> [1] "01"
>
> $`svn rev`
> [1] "62090"
>
> $language
> [1] "R"
>
> $version.string
> [1] "R version 2.15.3 (2013-03-01)"
>
> $nickname
> [1] "Security Blanket"
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From albin.blaschka at standortsanalyse.net  Wed Apr 30 12:19:56 2014
From: albin.blaschka at standortsanalyse.net (Albin Blaschka)
Date: Wed, 30 Apr 2014 12:19:56 +0200
Subject: [R-sig-Geo] Problem merging rasters after conversion and
 reprojection of .hdf file
In-Reply-To: <842A85E8-E6D1-4C2A-A054-D1371AD028EB@gmail.com>
References: <10530E7E-DE99-43D3-81DE-DD3CD51A294B@gmail.com>	<CABG0rfvUGK0GFM4ij+pfT4VvzLnPV9MT6oGSY4+TUzFO-6kMNw@mail.gmail.com>	<CABG0rfvTrJY7ckzbJRqm_=YPObDmC+atUN1oSz1oQBBdcd=v1g@mail.gmail.com>	<362E1298-C2A0-46B1-96CD-E80282689AF3@gmail.com>
	<842A85E8-E6D1-4C2A-A054-D1371AD028EB@gmail.com>
Message-ID: <5360CE4C.5050304@standortsanalyse.net>

Hello!

is the function resample() from the raster package what you need?

HTH,
Albin


Am 30.04.2014 01:10, schrieb Justin Michell:
> Hi Jonathan
>
> Thanks, very helpful!
>
> I have followed your suggestions (except I already had a loop going so I didn?t use batch_gdal_translate). But after this process when I I try to match these NDVI values (for Jan as shown below) to the coordinates of my dataset, I get mostly NA?s. I am not sure if this makes sense, although the reprojected map when I plot it looks fine I think.
>
> My coordinates in my spatial dataset represent 464 unique sample sites scattered across Kenya with a count of the number people examined and positive at each site, and downloaded from the malaria atlas project (http://www.map.ox.ac.uk/browse-resources/). Any thoughts would be appreciated!
>
> # Jan tiles (4 tiles cover Kenya)
>
>> for (i in 1 : 4){
> +   # extract the NDVI band (sd_index=1) and converts to .tiff
> +   gdal_translate(out.files[i], paste0("Jan", "_", i, ".tiff"), sd_index=1)
> + }
>
>> mosaic_rasters(gdalfile=c("Jan_1.tiff", "Jan_2.tiff", "Jan_3.tiff", "Jan_4.tiff"),dst_dataset="NDVI1_mosaic.tiff", separate=F, verbose=TRUE)
>
>> gdalwarp("NDVI1_mosaic.tiff","MODIS_NDVI/NDVIJan.tiff", s_srs="+proj=sinu +lon_0=0 +x_0=0 +y_0=0 +a=6371007.181 +b=6371007.181 +units=m +no_defs",t_srs="+proj=longlat +datum=WGS84 +no_defs", srcnodata=-3000,dstnodata=-3000)
>
>> NDVI1 <- raster("MODIS_NDVI/NDVIJan.tiff")*0.0001
>> NDVI1 <- crop(NDVI1, extent(kenya))
>
>> NDVI1
> class       : RasterLayer
> dimensions  : 1107, 953, 1054971  (nrow, ncol, ncell)
> resolution  : 0.008397857, 0.008397857  (x, y)
> extent      : 33.905, 41.90816, -4.671056, 4.625372  (xmin, xmax, ymin, ymax)
> coord. ref. : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0
> data source : in memory
> names       : NDVIJan
> values      : -0.2, 0.9031  (min, max)
>
>> summary(NDVI1)
>              NDVIJan
> Min.        -0.2000
> 1st Qu.      0.1813
> Median       0.2892
> 3rd Qu.      0.4550
> Max.         0.9031
> NA's    652208.0000
>
>> extract(NDVI1, sitesPolyPoints at coords)
>
>   extract(NDVI1, sitesPolyPoints at coords)
>    [1] 0.5094     NA 0.6557     NA     NA 0.6575 0.6493 0.6469     NA 0.6607     NA     NA     NA 0.6814     NA     NA 0.6620     NA     NA     NA     NA 0.6749 0.6887     NA 0.6880 0.5959     NA
>   [28]     NA     NA 0.6570 0.6212     NA     NA     NA     NA     NA 0.6647     NA     NA 0.6296     NA     NA 0.5831     NA     NA     NA 0.6147     NA 0.6167     NA 0.6258 0.6615     NA 0.6613
>   [55]     NA 0.6626     NA     NA 0.6406     NA 0.6451 0.6718     NA 0.6641     NA     NA     NA     NA 0.6479     NA 0.6506     NA 0.6478     NA 0.6629     NA     NA     NA 0.6519     NA 0.6699
>   [82]     NA     NA     NA     NA 0.5996     NA 0.6694     NA 0.6855     NA 0.6625     NA     NA     NA     NA     NA     NA     NA 0.6389     NA     NA     NA     NA     NA     NA     NA     NA
> [109]     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA 0.6203     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA
> [136] 0.6159     NA     NA 0.6538     NA 0.6613 0.6731     NA     NA     NA 0.6781     NA 0.6090     NA     NA 0.6054     NA     NA     NA 0.6810     NA     NA     NA     NA     NA     NA     NA
> [163] 0.6486     NA     NA 0.6328     NA     NA 0.6681     NA 0.6681 0.6766     NA     NA 0.6910     NA     NA     NA     NA     NA     NA     NA     NA     NA 0.6706     NA     NA     NA     NA
> [190]     NA 0.6839     NA 0.6632     NA     NA     NA     NA     NA     NA 0.6716     NA     NA     NA     NA     NA     NA 0.6282     NA     NA     NA     NA 0.6607     NA     NA     NA     NA
> [217]     NA     NA     NA     NA     NA 0.2105     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA 0.7046     NA 0.7367     NA 0.6968     NA     NA
> [244]     NA 0.5180 0.3300 0.7082 0.5610 0.3725     NA     NA     NA     NA     NA     NA 0.2636 0.7032 0.6201 0.6996     NA     NA 0.3071 0.3292 0.4628     NA     NA     NA     NA     NA     NA
> [271]     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA
> [298]     NA     NA     NA     NA 0.7367     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA
> [325]     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA 0.7073     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA
> [352]     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA
> [379]     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA
> [406]     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA
> [433]     NA     NA     NA     NA     NA     NA     NA     NA     NA 0.3652     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA
>
>> head(sitesPolyPoints at coords)
>       coords.x1 coords.x2
> [1,]   33.9940    0.1580
> [2,]   34.1164   -0.0115
> [3,]   34.1175    0.3770
> [4,]   34.1277   -0.4222
> [5,]   34.1318   -0.0035
> [6,]   34.1350    0.4016
>
> Cheers
> Justin
>
>
> On Apr 29, 2014, at 2:56 PM, Justin Michell <jwm302 at gmail.com> wrote:
>
>> Hi Jonathan
>>
>> Thanks for you help here. I get the following error when I tried the following as per you advice (and the example for mosaic_rasters). Do I not have the right GDALDriver?:
>>
>>> gdal_setInstallation()
>>> valid_install <- !is.null(getOption("gdalUtils_gdalPath"))
>>> valid_install
>> [1] TRUE
>>> if(require(raster) && require(rgdal) && valid_install)
>> + {
>> + NDVI_1 <- mosaic_rasters(gdalfile=c(out.files[1],out.files[2], out.files[3],out.files[4], out.files[5], out.files[6]),dst_dataset="NDVI1_mosaic.hdf", separate=F, of=c("HDF4","HDF5"), verbose=TRUE)
>> + gdalinfo("NDVI1_mosaic.hdf")
>> + }
>> Checking gdal_installation...
>> GDAL command being used: "/Library/Frameworks/GDAL.framework/Versions/1.10/Programs/gdalbuildvrt" -separate  "/var/folders/t_/dby7tsnj0vgbfxp8hgclyrj80000gn/T//RtmpSKFW71/file17fd953983454.vrt" "MOD13A3.A2013001.h20v08.005.2013042085256.hdf" "MOD13A3.A2013001.h20v09.005.2013042085401.hdf" "MOD13A3.A2013001.h21v08.005.2013042085514.hdf" "MOD13A3.A2013001.h21v09.005.2013042085607.hdf" "MOD13A3.A2013001.h22v08.005.2013042085522.hdf" "MOD13A3.A2013001.h22v09.005.2013042085359.hdf"
>> Checking gdal_installation...
>> GDAL command being used: "/Library/Frameworks/GDAL.framework/Versions/1.10/Programs/gdal_translate" -of "HDF4" -of "HDF5" "/var/folders/t_/dby7tsnj0vgbfxp8hgclyrj80000gn/T//RtmpSKFW71/file17fd953983454.vrt" "NDVI1_mosaic.hdf"
>> Input file size is 3600, 24000
>> character(0)
>> attr(,"status")
>> [1] 1
>> Warning messages:
>> 1: running command '"/Library/Frameworks/GDAL.framework/Versions/1.10/Programs/gdal_translate" -of "HDF4" -of "HDF5" "/var/folders/t_/dby7tsnj0vgbfxp8hgclyrj80000gn/T//RtmpSKFW71/file17fd953983454.vrt" "NDVI1_mosaic.hdf"' had status 1
>> 2: running command '"/Library/Frameworks/GDAL.framework/Versions/1.10/Programs/gdalinfo" "NDVI1_mosaic.hdf"' had status 1
>> ERROR 6: GDALDriver::Create() ... no create method implemented for this format.
>>
>> ERROR 4: `NDVI1_mosaic.hdf' does not exist in the file system,
>> and is not recognised as a supported dataset name.
>>
>> gdalinfo failed - unable to open 'NDVI1_mosaic.hdf?.
>>
>>
>> Cheers
>> Justin
>>
>>
>>
>>
>>
>>
>> On Apr 28, 2014, at 3:17 PM, Jonathan Greenberg <jgrn at illinois.edu> wrote:
>>
>>> Also note you can use ?batch_gdal_translate to do your HDF -> TIF conversions.
>>>
>>> --j
>>>
>>> On Mon, Apr 28, 2014 at 8:12 AM, Jonathan Greenberg <jgrn at illinois.edu> wrote:
>>>> Justin:
>>>>
>>>> Couple of comments:
>>>>
>>>> 1) In general, I find it easier to mosaic FIRST and then reproject
>>>> SECOND -- when you reproject first, mosaic second, you can get weird
>>>> issues particularly along the seams.
>>>> 2) Since you are already using gdalUtils, have you tried
>>>> ?mosaic_rasters (which will be faster than merge() in all likelihood,
>>>> since it uses the base GDAL mosaicking capabilities)?  Make sure
>>>> separate=FALSE for this particular application.
>>>>
>>>> --j
>>>>
>>>> On Mon, Apr 28, 2014 at 7:18 AM, Justin Michell <jwm302 at gmail.com> wrote:
>>>>> Dear Group
>>>>>
>>>>> I am dealing with the task of preprocessing and re-projecting MODIS gridded tiles in .hdf format from Sinusoidal projection, in R, to a geographic projection. I would like to align all my other climate layers (from worldclim.org) which are at 1km resolution to my NDVI layers. I am using the gdal_utils package in R, and only one subset I?m interested in (monthly NDVI). I am working on Mac OS and grabbed gdal from here: http://www.kyngchaos.com/software/frameworks .
>>>>>
>>>>> To do this I use the following code (previous list entries relating to gdalUtils have assisted me up till this point):
>>>>>
>>>>> # download all available monthly images for the year 2013 - MODIS PRODUCT (MOD13A3, Terra, Vegetation Indices, Tile, 1000m, Monthly)
>>>>> ModisDownload(x="MOD13A3",h=c(20,21,22),v=c(8,9),dates=c('2013.01.01','2013.12.31'),mosaic=F,proj=F)
>>>>>
>>>>> # extract the NDVI band (sd_index=1) and converts to .tiff for 1 tile for January
>>>>> gdal_translate("MOD13A3.A2013001.h20v08.005.2013042085256.hdf", "Jan_1.tiff", sd_index=1)
>>>>>
>>>>> # converts projection to Geog WGS84
>>>>> gdalwarp(?Jan_1.tiff","MODIS_NDVI/NDVIJan_1.tiff", s_srs="+proj=sinu +lon_0=0 +x_0=0 +y_0=0 +a=6371007.181 +b=6371007.181 +units=m +no_defs",t_srs="+proj=longlat +datum=WGS84 +no_defs",srcnodata=-3000,dstnodata=-3000)
>>>>>
>>>>> I have 6 tiles per month (covering Kenya). For each month I?d like to merge all 6 tiles using the raster package (to cover Kenya). For January I perform the following operation using the merge function in the raster package:
>>>>>
>>>>> NDVI1  <- (merge(raster("MODIS_NDVI/NDVIJan_1.tiff"),raster("MODIS_NDVI/NDVIJan_2.tiff"),raster("MODIS_NDVI/NDVIJan_3.tiff"), raster("MODIS_NDVI/NDVIJan_4.tiff"), raster("MODIS_NDVI/NDVIJan_5.tiff"), raster("MODIS_NDVI/NDVIJan_6.tiff"), tolerance=0.5))*0.0001
>>>>> NDVI1 <- crop(NDVI1, extent(kenya))
>>>>>
>>>>> Without including the tolerance argument I get an error:
>>>>>
>>>>> Error in compareRaster(x, extent = FALSE, rowcol = FALSE, orig = TRUE,  :
>>>>> different origin
>>>>>
>>>>> But after this merge a lot of NA?s are introduced and the plot doesn?t look right (as it did before for each tile).
>>>>>
>>>>> The resolution is not exactly the same. Here are a comparison of the layers (before merging NDVI tiles) and my SpatialPolygonsDataFrame called kenya, as well as my r sessionInfo() printed below:
>>>>>
>>>>>
>>>>>> n1 <- raster("MODIS_NDVI/NDVIJan_1.tiff")
>>>>>> n1
>>>>> class       : RasterLayer
>>>>> dimensions  : 1219, 1275, 1554225  (nrow, ncol, ncell)
>>>>> resolution  : 0.008205785, 0.008205785  (x, y)
>>>>> extent      : 20, 30.46238, -0.002852273, 10  (xmin, xmax, ymin, ymax)
>>>>> coord. ref. : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0
>>>>> data source : /Users/justinmichell/MODIS_NDVI/NDVIJan_1.tiff
>>>>> names       : NDVIJan_1
>>>>> values      : -32768, 32767  (min, max)
>>>>>
>>>>>> meanTemp1
>>>>> class       : RasterLayer
>>>>> dimensions  : 1115, 960, 1070400  (nrow, ncol, ncell)
>>>>> resolution  : 0.008333333, 0.008333333  (x, y)
>>>>> extent      : 33.90833, 41.90833, -4.666667, 4.625  (xmin, xmax, ymin, ymax)
>>>>> coord. ref. : +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0
>>>>> data source : in memory
>>>>> names       : layer
>>>>> values      : -4.4, 30  (min, max)
>>>>>
>>>>>> kenya
>>>>> class       : SpatialPolygonsDataFrame
>>>>> features    : 1
>>>>> extent      : 33.90722, 41.90517, -4.669618, 4.622499  (xmin, xmax, ymin, ymax)
>>>>> coord. ref. : +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0
>>>>> variables   : 11
>>>>> names       : FIPS, ISO2, ISO3,  UN,  NAME,  AREA,  POP2005, REGION, SUBREGION,    LON,  LAT
>>>>> min values  :   KE,   KE,  KEN, 404, Kenya, 56914, 35598952,      2,        14, 37.858, 0.53
>>>>> max values  :   KE,   KE,  KEN, 404, Kenya, 56914, 35598952,      2,        14, 37.858, 0.53
>>>>>
>>>>>> sessionInfo()
>>>>> R version 3.0.2 (2013-09-25)
>>>>> Platform: x86_64-apple-darwin10.8.0 (64-bit)
>>>>>
>>>>> locale:
>>>>> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>>>>>
>>>>> attached base packages:
>>>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>>>
>>>>> other attached packages:
>>>>> [1] gdalUtils_0.2.0 rgdal_0.8-14    RCurl_1.95-4.1  bitops_1.0-6    raster_2.2-12   sp_1.0-14
>>>>>
>>>>> loaded via a namespace (and not attached):
>>>>> [1] codetools_0.2-8      foreach_1.4.1        grid_3.0.2           iterators_1.0.6      lattice_0.20-24      scatterplot3d_0.3-34
>>>>>
>>>>>
>>>>> Thanks very much,
>>>>> Justin Michell
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>        [[alternative HTML version deleted]]
>>>>>
>>>>>
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>
>>>>
>>>>
>>>>
>>>> --
>>>> Jonathan A. Greenberg, PhD
>>>> Assistant Professor
>>>> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
>>>> Department of Geography and Geographic Information Science
>>>> University of Illinois at Urbana-Champaign
>>>> 259 Computing Applications Building, MC-150
>>>> 605 East Springfield Avenue
>>>> Champaign, IL  61820-6371
>>>> Phone: 217-300-1924
>>>> http://www.geog.illinois.edu/~jgrn/
>>>> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
>>>
>>>
>>>
>>> --
>>> Jonathan A. Greenberg, PhD
>>> Assistant Professor
>>> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
>>> Department of Geography and Geographic Information Science
>>> University of Illinois at Urbana-Champaign
>>> 259 Computing Applications Building, MC-150
>>> 605 East Springfield Avenue
>>> Champaign, IL  61820-6371
>>> Phone: 217-300-1924
>>> http://www.geog.illinois.edu/~jgrn/
>>> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
>>
>
>
> 	[[alternative HTML version deleted]]
>
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
| Albin Blaschka, Mag.rer.nat.
| Etrichstrasse 26, A-5020 Salzburg
| * www.albinblaschka.info *
| * www.researchgate.net/profile/Albin_Blaschka *
| - It's hard to live in the mountains, hard but not hopeless!


From Roger.Bivand at nhh.no  Wed Apr 30 14:00:44 2014
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 30 Apr 2014 14:00:44 +0200
Subject: [R-sig-Geo] SPGWR Application to Holdout Sample
In-Reply-To: <CAD7wDOB1VcsHVQmF1cPrU6x7nWM6ZZPMh92HmYMPa6S+=AFSWQ@mail.gmail.com>
References: <CAD7wDOB1VcsHVQmF1cPrU6x7nWM6ZZPMh92HmYMPa6S+=AFSWQ@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1404301354240.31935@reclus.nhh.no>

On Tue, 29 Apr 2014, Paul Bidanset wrote:

> Hello,
>
> I was just curious - am I safe in assuming that when applying holdout data
> (new data points not included in model calibration) to GWR models in the
> SPGWR package (as below), each new point is applied to the local regression
> model in closest geographic proximity?

No, you are not safe. The #fit.points models fitted are fitted at - hence 
the name - the fit points, using the kernel and bandwidths specified. In 
this case, the data in the data= argument are geographically weighted in 
these #fit.points models, but never fitted themselves.

Please do not use HTML, and do provide an example in which georgiaNewData 
is made explicit (is it a subset of gSRDF?).

Hope this clarifies,

Roger


>
>>>> * PredictionsOfNewData  <- gwr(PctBach ~ TotPop90 + PctRural + PctEld +
> *>>>* PctFB
> *>>>* + PctPov + PctBlack, data=gSRDF, adapt=TRUE, gweight=gwr.Gauss, method =
> *>>>* "aic",  bandwidth=bw1,
> *>>>* predictions=TRUE, fit.points=georgiaNewData)
> *>>>* PredictionsOfNewData*
>
>
> Thank you in advance for your assistance.
>
> Best,
>
> Paul
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From culinovic.domagoj at gmail.com  Wed Apr 30 14:25:48 2014
From: culinovic.domagoj at gmail.com (Domagoj Culinovic)
Date: Wed, 30 Apr 2014 14:25:48 +0200
Subject: [R-sig-Geo] Data analyses trough period of time
Message-ID: <CACgt3om=k-naNw5Zh9B5a+0G_4QQHxbp54MxEX2run-84N-TGw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140430/dbd60fdc/attachment.pl>

From loic.dutrieux at wur.nl  Wed Apr 30 14:49:16 2014
From: loic.dutrieux at wur.nl (=?UTF-8?B?TG/Dr2MgRHV0cmlldXg=?=)
Date: Wed, 30 Apr 2014 14:49:16 +0200
Subject: [R-sig-Geo] Problem merging rasters after conversion and
 reprojection of .hdf file
In-Reply-To: <842A85E8-E6D1-4C2A-A054-D1371AD028EB@gmail.com>
References: <10530E7E-DE99-43D3-81DE-DD3CD51A294B@gmail.com>	<CABG0rfvUGK0GFM4ij+pfT4VvzLnPV9MT6oGSY4+TUzFO-6kMNw@mail.gmail.com>	<CABG0rfvTrJY7ckzbJRqm_=YPObDmC+atUN1oSz1oQBBdcd=v1g@mail.gmail.com>	<362E1298-C2A0-46B1-96CD-E80282689AF3@gmail.com>
	<842A85E8-E6D1-4C2A-A054-D1371AD028EB@gmail.com>
Message-ID: <5360F14C.3090808@wur.nl>

Dear Justin,

gdalwarp is able to reproject/resample and mosaic all at once, and that 
is probably the preferred option in that case (since there are no 
overlapping areas).
See the simplified example below:


###
library(raster)
library(gdalUtils)

dir <- file.path(rasterOptions()$tmpdir, 'MODIS')
dir.create(dir, recursive=TRUE)

# Download two neighboring modis tiles
download.file('http://e4ftl01.cr.usgs.gov/MOLT/MOD13A2.005/2000.04.22/MOD13A2.A2000113.h20v08.005.2006275210548.hdf', 
destfile=file.path(dir, 'NDVI.h20v08.hdf'))
download.file('http://e4ftl01.cr.usgs.gov/MOLT/MOD13A2.005/2000.04.22/MOD13A2.A2000113.h21v08.005.2006275210549.hdf', 
destfile=file.path(dir, 'NDVI.h20v09.hdf'))

# Get list of files downloaded
list <- list.files(dir, full.names=TRUE)
# Get list of sds1
sdsList <- sapply(X=list, FUN=function(x){get_subdatasets(x)[1]})
# Warp
gdalwarp(srcfile=sdsList, t_srs="+proj=longlat +datum=WGS84 +no_defs", 
dstfile=file.path(dir, 'mosaic_latlong.tif'))

r <- raster(file.path(dir, 'mosaic_latlong.tif'))
plot(r)

Hope this helps
Best regards,

--
Lo?c Dutrieux
Laboratory of Geo-Information Science and Remote Sensing
Wageningen University
The Netherlands



On 14-04-30 01:10 AM, Justin Michell wrote:
> Hi Jonathan
>
> Thanks, very helpful!
>
> I have followed your suggestions (except I already had a loop going so I
> didn?t use batch_gdal_translate). But after this process when I I try to
> match these NDVI values (for Jan as shown below) to the coordinates of
> my dataset, I get mostly NA?s. I am not sure if this makes sense,
> although the reprojected map when I plot it looks fine I think.
>
> My coordinates in my spatial dataset represent 464 unique sample sites
> scattered across Kenya with a count of the number people examined and
> positive at each site, and downloaded from the malaria atlas project
> (http://www.map.ox.ac.uk/browse-resources/). Any thoughts would be
> appreciated!
>
> # Jan tiles (4 tiles cover Kenya)
>
>> for (i in 1 : 4){
> +   # extract the NDVI band (sd_index=1) and converts to .tiff
> +   gdal_translate(out.files[i], paste0("Jan", "_", i, ".tiff"),
> sd_index=1)
> + }
>
>> mosaic_rasters(gdalfile=c("Jan_1.tiff", "Jan_2.tiff", "Jan_3.tiff", "Jan_4.tiff"),dst_dataset="NDVI1_mosaic.tiff", separate=F, verbose=TRUE)
>
>> gdalwarp("NDVI1_mosaic.tiff","MODIS_NDVI/NDVIJan.tiff", s_srs="+proj=sinu +lon_0=0 +x_0=0 +y_0=0 +a=6371007.181 +b=6371007.181 +units=m +no_defs",t_srs="+proj=longlat +datum=WGS84 +no_defs", srcnodata=-3000,dstnodata=-3000)
>
>> NDVI1 <- raster("MODIS_NDVI/NDVIJan.tiff")*0.0001
>> NDVI1 <- crop(NDVI1, extent(kenya))
>
>> NDVI1
> class       : RasterLayer
> dimensions  : 1107, 953, 1054971  (nrow, ncol, ncell)
> resolution  : 0.008397857, 0.008397857  (x, y)
> extent      : 33.905, 41.90816, -4.671056, 4.625372  (xmin, xmax, ymin,
> ymax)
> coord. ref. : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84
> +towgs84=0,0,0
> data source : in memory
> names       : NDVIJan
> values      : -0.2, 0.9031  (min, max)
>
>> summary(NDVI1)
>              NDVIJan
> Min.        -0.2000
> 1st Qu.      0.1813
> Median       0.2892
> 3rd Qu.      0.4550
> Max.         0.9031
> NA's    652208.0000
>
>> extract(NDVI1, sitesPolyPoints at coords)
>
>   extract(NDVI1, sitesPolyPoints at coords)
>    [1] 0.5094     NA 0.6557     NA     NA 0.6575 0.6493 0.6469     NA
> 0.6607     NA     NA     NA 0.6814     NA     NA 0.6620     NA
> NA     NA     NA 0.6749 0.6887     NA 0.6880 0.5959     NA
>   [28]     NA     NA 0.6570 0.6212     NA     NA     NA     NA     NA
> 0.6647     NA     NA 0.6296     NA     NA 0.5831     NA     NA     NA
> 0.6147     NA 0.6167     NA 0.6258 0.6615     NA 0.6613
>   [55]     NA 0.6626     NA     NA 0.6406     NA 0.6451 0.6718     NA
> 0.6641     NA     NA     NA     NA 0.6479     NA 0.6506     NA
> 0.6478     NA 0.6629     NA     NA     NA 0.6519     NA 0.6699
>   [82]     NA     NA     NA     NA 0.5996     NA 0.6694     NA
> 0.6855     NA 0.6625     NA     NA     NA     NA     NA     NA     NA
> 0.6389     NA     NA     NA     NA     NA     NA     NA     NA
> [109]     NA     NA     NA     NA     NA     NA     NA     NA     NA
> NA     NA 0.6203     NA     NA     NA     NA     NA     NA     NA
> NA     NA     NA     NA     NA     NA     NA     NA
> [136] 0.6159     NA     NA 0.6538     NA 0.6613 0.6731     NA     NA
> NA 0.6781     NA 0.6090     NA     NA 0.6054     NA     NA     NA
> 0.6810     NA     NA     NA     NA     NA     NA     NA
> [163] 0.6486     NA     NA 0.6328     NA     NA 0.6681     NA 0.6681
> 0.6766     NA     NA 0.6910     NA     NA     NA     NA     NA
> NA     NA     NA     NA 0.6706     NA     NA     NA     NA
> [190]     NA 0.6839     NA 0.6632     NA     NA     NA     NA     NA
> NA 0.6716     NA     NA     NA     NA     NA     NA 0.6282     NA
> NA     NA     NA 0.6607     NA     NA     NA     NA
> [217]     NA     NA     NA     NA     NA 0.2105     NA     NA     NA
> NA     NA     NA     NA     NA     NA     NA     NA     NA     NA     NA
> 0.7046     NA 0.7367     NA 0.6968     NA     NA
> [244]     NA 0.5180 0.3300 0.7082 0.5610 0.3725     NA     NA     NA
> NA     NA     NA 0.2636 0.7032 0.6201 0.6996     NA     NA 0.3071 0.3292
> 0.4628     NA     NA     NA     NA     NA     NA
> [271]     NA     NA     NA     NA     NA     NA     NA     NA     NA
> NA     NA     NA     NA     NA     NA     NA     NA     NA     NA
> NA     NA     NA     NA     NA     NA     NA     NA
> [298]     NA     NA     NA     NA 0.7367     NA     NA     NA     NA
> NA     NA     NA     NA     NA     NA     NA     NA     NA     NA
> NA     NA     NA     NA     NA     NA     NA     NA
> [325]     NA     NA     NA     NA     NA     NA     NA     NA     NA
> NA     NA     NA     NA 0.7073     NA     NA     NA     NA     NA
> NA     NA     NA     NA     NA     NA     NA     NA
> [352]     NA     NA     NA     NA     NA     NA     NA     NA     NA
> NA     NA     NA     NA     NA     NA     NA     NA     NA     NA
> NA     NA     NA     NA     NA     NA     NA     NA
> [379]     NA     NA     NA     NA     NA     NA     NA     NA     NA
> NA     NA     NA     NA     NA     NA     NA     NA     NA     NA
> NA     NA     NA     NA     NA     NA     NA     NA
> [406]     NA     NA     NA     NA     NA     NA     NA     NA     NA
> NA     NA     NA     NA     NA     NA     NA     NA     NA     NA
> NA     NA     NA     NA     NA     NA     NA     NA
> [433]     NA     NA     NA     NA     NA     NA     NA     NA     NA
> 0.3652     NA     NA     NA     NA     NA     NA     NA     NA
> NA     NA     NA     NA     NA     NA     NA     NA     NA
>
>> head(sitesPolyPoints at coords)
>       coords.x1 coords.x2
> [1,]   33.9940    0.1580
> [2,]   34.1164   -0.0115
> [3,]   34.1175    0.3770
> [4,]   34.1277   -0.4222
> [5,]   34.1318   -0.0035
> [6,]   34.1350    0.4016
>
> Cheers
> Justin
>
>
> On Apr 29, 2014, at 2:56 PM, Justin Michell <jwm302 at gmail.com> wrote:
>
>> Hi Jonathan
>>
>> Thanks for you help here. I get the following error when I tried the following as per you advice (and the example for mosaic_rasters). Do I not have the right GDALDriver?:
>>
>>> gdal_setInstallation()
>>> valid_install <- !is.null(getOption("gdalUtils_gdalPath"))
>>> valid_install
>> [1] TRUE
>>> if(require(raster) && require(rgdal) && valid_install)
>> + {
>> + NDVI_1 <- mosaic_rasters(gdalfile=c(out.files[1],out.files[2], out.files[3],out.files[4], out.files[5], out.files[6]),dst_dataset="NDVI1_mosaic.hdf", separate=F, of=c("HDF4","HDF5"), verbose=TRUE)
>> + gdalinfo("NDVI1_mosaic.hdf")
>> + }
>> Checking gdal_installation...
>> GDAL command being used: "/Library/Frameworks/GDAL.framework/Versions/1.10/Programs/gdalbuildvrt" -separate  "/var/folders/t_/dby7tsnj0vgbfxp8hgclyrj80000gn/T//RtmpSKFW71/file17fd953983454.vrt" "MOD13A3.A2013001.h20v08.005.2013042085256.hdf" "MOD13A3.A2013001.h20v09.005.2013042085401.hdf"  "MOD13A3.A2013001.h21v08.005.2013042085514.hdf"
> "MOD13A3.A2013001.h21v09.005.2013042085607.hdf"
> "MOD13A3.A2013001.h22v08.005.2013042085522.hdf"
> "MOD13A3.A2013001.h22v09.005.2013042085359.hdf"
>> Checking gdal_installation...
>> GDAL command being used: "/Library/Frameworks/GDAL.framework/Versions/1.10/Programs/gdal_translate" -of "HDF4" -of "HDF5" "/var/folders/t_/dby7tsnj0vgbfxp8hgclyrj80000gn/T//RtmpSKFW71/file17fd953983454.vrt" "NDVI1_mosaic.hdf"
>> Input file size is 3600, 24000
>> character(0)
>> attr(,"status")
>> [1] 1
>> Warning messages:
>> 1: running command '"/Library/Frameworks/GDAL.framework/Versions/1.10/Programs/gdal_translate" -of "HDF4" -of "HDF5" "/var/folders/t_/dby7tsnj0vgbfxp8hgclyrj80000gn/T//RtmpSKFW71/file17fd953983454.vrt" "NDVI1_mosaic.hdf"' had status 1
>> 2: running command '"/Library/Frameworks/GDAL.framework/Versions/1.10/Programs/gdalinfo" "NDVI1_mosaic.hdf"' had status 1
>> ERROR 6: GDALDriver::Create() ... no create method implemented for this format.
>>
>> ERROR 4: `NDVI1_mosaic.hdf' does not exist in the file system,
>> and is not recognised as a supported dataset name.
>>
>> gdalinfo failed - unable to open 'NDVI1_mosaic.hdf?.
>>
>>
>> Cheers
>> Justin
>>
>>
>>
>>
>>
>>
>> On Apr 28, 2014, at 3:17 PM, Jonathan Greenberg <jgrn at illinois.edu> wrote:
>>
>>> Also note you can use ?batch_gdal_translate to do your HDF -> TIF conversions.
>>>
>>> --j
>>>
>>> On Mon, Apr 28, 2014 at 8:12 AM, Jonathan Greenberg <jgrn at illinois.edu> wrote:
>>>> Justin:
>>>>
>>>> Couple of comments:
>>>>
>>>> 1) In general, I find it easier to mosaic FIRST and then reproject
>>>> SECOND -- when you reproject first, mosaic second, you can get weird
>>>> issues particularly along the seams.
>>>> 2) Since you are already using gdalUtils, have you tried
>>>> ?mosaic_rasters (which will be faster than merge() in all likelihood,
>>>> since it uses the base GDAL mosaicking capabilities)?  Make sure
>>>> separate=FALSE for this particular application.
>>>>
>>>> --j
>>>>
>>>> On Mon, Apr 28, 2014 at 7:18 AM, Justin Michell <jwm302 at gmail.com> wrote:
>>>>> Dear Group
>>>>>
>>>>> I am dealing with the task of preprocessing and re-projecting MODIS gridded tiles in .hdf format from Sinusoidal projection, in R, to a geographic projection. I would like to align all my other climate layers (from worldclim.org) which are at 1km resolution  to my NDVI layers. I am using the gdal_utils package in R, and only
> one subset I?m interested in (monthly NDVI). I am working on Mac OS and
> grabbed gdal from here: http://www.kyngchaos.com/software/frameworks .
>>>>>
>>>>> To do this I use the following code (previous list entries relating to gdalUtils have assisted me up till this point):
>>>>>
>>>>> # download all available monthly images for the year 2013 - MODIS PRODUCT (MOD13A3, Terra, Vegetation Indices, Tile, 1000m, Monthly)
>>>>> ModisDownload(x="MOD13A3",h=c(20,21,22),v=c(8,9),dates=c('2013.01.01','2013.12.31'),mosaic=F,proj=F)
>>>>>
>>>>> # extract the NDVI band (sd_index=1) and converts to .tiff for 1 tile for January
>>>>> gdal_translate("MOD13A3.A2013001.h20v08.005.2013042085256.hdf", "Jan_1.tiff", sd_index=1)
>>>>>
>>>>> # converts projection to Geog WGS84
>>>>> gdalwarp(?Jan_1.tiff","MODIS_NDVI/NDVIJan_1.tiff", s_srs="+proj=sinu +lon_0=0 +x_0=0 +y_0=0 +a=6371007.181 +b=6371007.181 +units=m +no_defs",t_srs="+proj=longlat +datum=WGS84 +no_defs",srcnodata=-3000,dstnodata=-3000)
>>>>>
>>>>> I have 6 tiles per month (covering Kenya). For each month I?d like to merge all 6 tiles using the raster package (to cover Kenya). For January I perform the following operation using the merge function in the raster package:
>>>>>
>>>>> NDVI1  <- (merge(raster("MODIS_NDVI/NDVIJan_1.tiff"),raster("MODIS_NDVI/NDVIJan_2.tiff"),raster("MODIS_NDVI/NDVIJan_3.tiff"), raster("MODIS_NDVI/NDVIJan_4.tiff"), raster("MODIS_NDVI/NDVIJan_5.tiff"), raster("MODIS_NDVI/NDVIJan_6.tiff"), tolerance=0.5))*0.0001
>>>>> NDVI1 <- crop(NDVI1, extent(kenya))
>>>>>
>>>>> Without including the tolerance argument I get an error:
>>>>>
>>>>> Error in compareRaster(x, extent = FALSE, rowcol = FALSE, orig = TRUE,  :
>>>>> different origin
>>>>>
>>>>> But after this merge a lot of NA?s are introduced and the plot doesn?t look right (as it did before for each tile).
>>>>>
>>>>> The resolution is not exactly the same. Here are a comparison of the layers (before merging NDVI tiles) and my SpatialPolygonsDataFrame called kenya, as well as my r sessionInfo() printed below:
>>>>>
>>>>>
>>>>>> n1 <- raster("MODIS_NDVI/NDVIJan_1.tiff")
>>>>>> n1
>>>>> class       : RasterLayer
>>>>> dimensions  : 1219, 1275, 1554225  (nrow, ncol, ncell)
>>>>> resolution  : 0.008205785, 0.008205785  (x, y)
>>>>> extent      : 20, 30.46238, -0.002852273, 10  (xmin, xmax, ymin, ymax)
>>>>> coord. ref. : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0
>>>>> data source : /Users/justinmichell/MODIS_NDVI/NDVIJan_1.tiff
>>>>> names       : NDVIJan_1
>>>>> values      : -32768, 32767  (min, max)
>>>>>
>>>>>> meanTemp1
>>>>> class       : RasterLayer
>>>>> dimensions  : 1115, 960, 1070400  (nrow, ncol, ncell)
>>>>> resolution  : 0.008333333, 0.008333333  (x, y)
>>>>> extent      : 33.90833, 41.90833, -4.666667, 4.625  (xmin, xmax, ymin, ymax)
>>>>> coord. ref. : +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0
>>>>> data source : in memory
>>>>> names       : layer
>>>>> values      : -4.4, 30  (min, max)
>>>>>
>>>>>> kenya
>>>>> class       : SpatialPolygonsDataFrame
>>>>> features    : 1
>>>>> extent      : 33.90722, 41.90517, -4.669618, 4.622499  (xmin, xmax, ymin, ymax)
>>>>> coord. ref. : +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0
>>>>> variables   : 11
>>>>> names       : FIPS, ISO2, ISO3,  UN,  NAME,  AREA,  POP2005, REGION, SUBREGION,    LON,  LAT
>>>>> min values  :   KE,   KE,  KEN, 404, Kenya, 56914, 35598952,      2,        14, 37.858, 0.53
>>>>> max values  :   KE,   KE,  KEN, 404, Kenya, 56914, 35598952,      2,        14, 37.858, 0.53
>>>>>
>>>>>> sessionInfo()
>>>>> R version 3.0.2 (2013-09-25)
>>>>> Platform: x86_64-apple-darwin10.8.0 (64-bit)
>>>>>
>>>>> locale:
>>>>> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>>>>>
>>>>> attached base packages:
>>>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>>>>
>>>>> other attached packages:
>>>>> [1] gdalUtils_0.2.0 rgdal_0.8-14    RCurl_1.95-4.1  bitops_1.0-6    raster_2.2-12   sp_1.0-14
>>>>>
>>>>> loaded via a namespace (and not attached):
>>>>> [1] codetools_0.2-8      foreach_1.4.1        grid_3.0.2           iterators_1.0.6      lattice_0.20-24      scatterplot3d_0.3-34
>>>>>
>>>>>
>>>>> Thanks very much,
>>>>> Justin Michell
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>       [[alternative HTML version deleted]]
>>>>>
>>>>>
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org
>>>>>https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>
>>>>
>>>>
>>>>
>>>> --
>>>> Jonathan A. Greenberg, PhD
>>>> Assistant Professor
>>>> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
>>>> Department of Geography and Geographic Information Science
>>>> University of Illinois at Urbana-Champaign
>>>> 259 Computing Applications Building, MC-150
>>>> 605 East Springfield Avenue
>>>> Champaign, IL  61820-6371
>>>> Phone: 217-300-1924
>>>>http://www.geog.illinois.edu/~jgrn/
>>>> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
>>>
>>>
>>>
>>> --
>>> Jonathan A. Greenberg, PhD
>>> Assistant Professor
>>> Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
>>> Department of Geography and Geographic Information Science
>>> University of Illinois at Urbana-Champaign
>>> 259 Computing Applications Building, MC-150
>>> 605 East Springfield Avenue
>>> Champaign, IL  61820-6371
>>> Phone: 217-300-1924
>>>http://www.geog.illinois.edu/~jgrn/
>>> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
>>
>
>
>          [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From holland.aggie at gmail.com  Wed Apr 30 18:16:26 2014
From: holland.aggie at gmail.com (James Holland)
Date: Wed, 30 Apr 2014 11:16:26 -0500
Subject: [R-sig-Geo] plotGooglemaps - Problem with the legend
In-Reply-To: <CAPSaU-_BUQfSi0CH5OBMnntL8QzFreemN=RAgG8gxEQL93Oftg@mail.gmail.com>
References: <CABdaQ+tODwM+rY6EzvqJgPLy=AQhP7YLgagVYjn7OswbZF3eJA@mail.gmail.com>
	<CAPSaU-_BUQfSi0CH5OBMnntL8QzFreemN=RAgG8gxEQL93Oftg@mail.gmail.com>
Message-ID: <CABdaQ+vK4E8ktx1uqGXikR9weo3G8c6uX2Gt0Mz_SU6YF5jUsw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140430/ca5f02b3/attachment.pl>

From st_john_brown at yahoo.com  Wed Apr 30 18:24:43 2014
From: st_john_brown at yahoo.com (St John Brown)
Date: Wed, 30 Apr 2014 09:24:43 -0700 (PDT)
Subject: [R-sig-Geo] Specifying Albers projection for the contiguous US
Message-ID: <1398875083.60274.YahooMailNeo@web122404.mail.ne1.yahoo.com>

Hello, 
I?m trying to use the map function from package maps to draw the contiguous United States with the projection, "+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=39.8 +lon_0=-98.6 +x_0=0 +y_0=0 +datum=WGS84 +units=km +no_defs". 
Below is my code I have written, but I don't know what to put for X. The maps documentation says, "the default is to use a rectangular projection with the aspect ratio chosen so that longitude and latitude scales are equivalent at the center of the picture." I can't figure out how to specify this in terms of a CRS string for X. 
us = map("state", plot=FALSE, fill=TRUE, col="transparent") 
us_sp = map2SpatialPolygons(us, IDs=us$names, proj4string = CRS(X) ) #don't know what to put for X 
proj.string.alb = CRS("+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=39.8 +lon_0=-98.6 +x_0=0 +y_0=0 +datum=WGS84 +units=km +no_defs") 
us_sp = spTransform(us_sp, CRS=proj.string.alb) 
plot(us_sp) 
Thanks for your help!



From amonleong at wanadoo.es  Wed Apr 30 21:16:49 2014
From: amonleong at wanadoo.es (Toni Monleon)
Date: Wed, 30 Apr 2014 21:16:49 +0200
Subject: [R-sig-Geo] =?utf-8?q?Geostatistical_Space=E2=80=93Time_Models?=
Message-ID: <CAFFKpM1WJtN_JLradntxDOutTFVAYSYGH7BANBM++xHsWSQanQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20140430/5bc5f1d9/attachment.pl>

