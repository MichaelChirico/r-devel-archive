From matzke at berkeley.edu  Sat Jan  1 04:58:06 2011
From: matzke at berkeley.edu (Nick Matzke)
Date: Fri, 31 Dec 2010 19:58:06 -0800
Subject: [R-sig-Geo] image classification with GRASS
In-Reply-To: <4D1D653E.6040106@berkeley.edu>
References: <4D1D653E.6040106@berkeley.edu>
Message-ID: <4D1EA64E.8090502@berkeley.edu>

After great struggles, this is what I got to work...thanks!
Nick

================
Open GRASS.app
(last step was huge manual compile *after* the app had been 
created)
(need to update libpng)

# For some reason this works even though I UNINSTALLED wxpython
g.gui wxpython


GRASS commands

# Load via File --> Import Raster Map


# i.group group=lsat7_2002 subgroup=lsat7_2002 \
 
input=lsat7_2002_10,lsat7_2002_20,lsat7_2002_30,lsat7_2002_40,lsat7_2002_50,lsat7_2002_70


# make group and subgroup
i.group group=gp1 subgroup=gp1 
input=betm.1,betm.2,betm.3,betm.4,betm.5,betm.6

# make unsupervised clustering
i.cluster group=gp1 subgroup=gp1 sigfile=unsup1 classes=2

# assign pixels to classes
i.maxlik group=gp1 subgroup=gp1 sigfile=unsup1 
class=unsup1_class reject=unsup1_reject

# unsupervised classification puts pixels into class #1 
(ocean) or #2 (land/cloud);
# we need to multiply by 100 to make it a big difference
Raster --> Map Calculator
new: unsup_x10
existing: edges3 at PERMANENT
edges3 at PERMANENT * 100

# identify edge pixels
i.zc --overwrite input=unsup_x10 output=edges3 width=3 
threshold=1

# Set the #1 pixels (the edges) to a mask
r.mask -o input=edges3 maskcats=1

# drag up the RGB image, now it is limited to just the mask


# unsupervised clustering, 4 classes, of just (?) edge pixels
i.cluster group=gp1 subgroup=gp1 sigfile=edges_unsup1 
classes=4 reportfile=edges_unsup1_report.txt

# assign pixels to classes
i.maxlik --overwrite group=gp1 subgroup=gp1 
sigfile=edges_unsup1 class=edges_unsup1_class 
reject=edges_unsup1_reject
================

On 12/30/10 9:08 PM, Nick Matzke wrote:
> Hi all,
>
> I've got R (with spgrass6) and GRASS installed on my Mac OS
> X machine.
>
> My goal is to load and classify a .img file that was clipped
> out of a Landsat 7 ETM image in ERDAS.
>
> However, GRASS seems to have a huge learning curve to even
> get started. Could I beg some GRASS wizard to post the very
> basic commands that one would typically use to:
>
> 1. load a .img file into GRASS
> 2. Display it
> 3. Conduct a classification of the pixels (any sort of
> classification would be fine, even a simple 2-class
> unsupervised classification).
>
> Thanks *very much* if you are able to help! Normally I'm
> pretty good at this sort of thing, but GRASS is
> extra-intimidating to newbies.
>
> Thanks, and cheers!
> Nick
>
>
>

-- 
====================================================
Nicholas J. Matzke
Ph.D. Candidate, Graduate Student Researcher
Huelsenbeck Lab
Center for Theoretical Evolutionary Genomics
4151 VLSB (Valley Life Sciences Building)
Department of Integrative Biology
University of California, Berkeley

Graduate Student Instructor, IB200A
Principles of Phylogenetics: Systematics
http://ib.berkeley.edu/courses/ib200a/index.shtml

Lab websites:
http://ib.berkeley.edu/people/lab_detail.php?lab=54
http://fisher.berkeley.edu/cteg/hlab.html
Dept. personal page: 
http://ib.berkeley.edu/people/students/person_detail.php?person=370
Lab personal page: 
http://fisher.berkeley.edu/cteg/members/matzke.html
Lab phone: 510-643-6299
Dept. fax: 510-643-6264
Cell phone: 510-301-0179
Email: matzke at berkeley.edu

Mailing address:
Department of Integrative Biology
3060 VLSB #3140
Berkeley, CA 94720-3140

-----------------------------------------------------
"[W]hen people thought the earth was flat, they were wrong. 
When people thought the earth was spherical, they were 
wrong. But if you think that thinking the earth is spherical 
is just as wrong as thinking the earth is flat, then your 
view is wronger than both of them put together."

Isaac Asimov (1989). "The Relativity of Wrong." The 
Skeptical Inquirer, 14(1), 35-44. Fall 1989.
http://chem.tufts.edu/AnswersInScience/RelativityofWrong.htm


From tom.richardson at bristol.ac.uk  Sun Jan  2 19:41:45 2011
From: tom.richardson at bristol.ac.uk (Tom_R)
Date: Sun, 2 Jan 2011 10:41:45 -0800 (PST)
Subject: [R-sig-Geo] changing the area of a shapefile to a new value
Message-ID: <1293993705690-5879842.post@n2.nabble.com>


Hi List,
I would appreciate some help regarding resizing shapefile areas.
I have several different animals, each with a different home-range (HR). To
test whether the overlap between HR's is more or less than expected, I would
like to reassign the HR areas amongst the different HR's. THen I will
compare the permuted overlap to the observed overlap. 

My (inelegant) code goes:

## load data & set up HR
xy <-  data.frame(cbind(points$x,  points$y))                ## x,y coords
ud <-  kernelUD(xy, id=NULL, h = "href",  kern = c("epa"))  ## 
kernel-estimate of the home range (from adehabitat)
ver <- getverticeshr(ud, home.range)     ## The HR; may have >1 disjoint
areas, & also have empty lakes
shapefile_HR <- kver2shapefile(ver)                              ##
shapefile for an individual animal
blobby <- shape2poly(shapefile_HR, region.id=NULL)	## convert shapefile  to
a polygon
HR_polygons <-  lapply(ver, area2spol)   			## convert "shapefile" to
"spatial polygons"

## Sum the area across all of the (potentially) disjoint parts
for (h in 1:length(blobby)  )                             ## loop for each
of the disjoint parts of the HR
	{
	regions <- slot(HR_polygons[[1]], "polygons")
	regions <- lapply(regions, function(x) {SpatialPolygons(list(x))})
	windoze <- lapply(regions, as.owin)			                  ## A spatstat
window		
	wind_shape <- writePolyShape(as(windoze[[h]], "spatialPolygons")
	if (h == 1) {blob_area <- area.owin(windoze[[h]])}                 
	if (h > 1)  {blob_area <- blob_area + area.owin(windoze[[h]])} ## sums the
disjoint HR areas
	}

The above gives me the HR area for a single animal ("blob_area"). But what I
would now like to do is to enlarge or shrink the HR's (i.e. modify
"shapefile_HR") of each animal. If all I wanted to do was to increase the HR
size by a factor x, then I could use the "scaleXY" function. However, I
actually need to change the AREA, to a new value, e.g. enlarge 
"shapefile_HR" from 130 mm^2 to  350mm^2. I can't find a simple function to
do that...

I imagine there is a simple function to do this, & I have spent all day
looking, to no avail...

Thanks list & happy 2011!
Tom


-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/changing-the-area-of-a-shapefile-to-a-new-value-tp5879842p5879842.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From chethanuniversal at gmail.com  Mon Jan  3 02:12:21 2011
From: chethanuniversal at gmail.com (Chethan S)
Date: Mon, 3 Jan 2011 06:42:21 +0530
Subject: [R-sig-Geo] Modules for using geostatistics for image classification
Message-ID: <AANLkTin+a1Z-kFHi+ye1haMbJ6ofU4s+ApS-cYkbWcve@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110103/2b6efd96/attachment.pl>

From Roger.Bivand at nhh.no  Mon Jan  3 12:58:09 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 3 Jan 2011 12:58:09 +0100 (CET)
Subject: [R-sig-Geo] Modules for using geostatistics for image
 classification
In-Reply-To: <AANLkTin+a1Z-kFHi+ye1haMbJ6ofU4s+ApS-cYkbWcve@mail.gmail.com>
References: <AANLkTin+a1Z-kFHi+ye1haMbJ6ofU4s+ApS-cYkbWcve@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1101031222550.20666@reclus.nhh.no>

On Mon, 3 Jan 2011, Chethan S wrote:

> Hello everyone!
>
> I am using GRASS with spgrass6 for my work. I will be using variograms in
> the process of landsat image classification. I am quite ok with GRASS but am
> finding R really tough. I understand that spgrass6 is a link between GRASS
> and R which can read and write raster/vector layers. Out of really many
> packages in R, for generating variograms out of landsat images which
> packages of R can be used? I want to go for image segmentation after that -
> i.e., for further work I will be using object oriented classification.

You broke several basic list rules in this posting. You cross-posted to 
R-help - never cross-post, simply post on one list and wait for replies. 
If this doesn't satisfy you, or if so directed, post to another list. 
Cross-posting is bad because helpers on one list are probably not 
subscribed to others, so no-one can see all the replies to a thread as 
they are split among different lists. In addition, you stress that you are 
not willing to take the effort to try to find out for yourself - as a 
reply on R-help has already pointed out by suggesting a Google search.

Had you taken the trouble to visit the Spatial task view on CRAN, you 
would have found plenty of links to R packages for geostatistics. However, 
how that might fit into classification of satellite images is a completely 
different, and arguably wrong-headed question. Variograms and kriging are 
used for interpolation, not classification. So your work flow is seriously 
muddled too.

You seem to want to resample your images to a different resolution using 
geostatistical methods (why?) before classifying the new images; possibly 
you want to fill in missing pixels in your images before classification 
rather than resampling, but you don't say this. An area in which 
geostatistical methods are used in image classification is in the analysis 
of image texture, but you do not mention this as your goal. You would 
anyway find it easier to use the GRASS module r.texture instead of 
geostatics, I think.

In any case, from your spate of postings on the GRASS users list, you do 
seem to rely on other people to do your work for you, don't you? Your 
posting on GRASS-stats of 6 December is very like the above, and went 
unanswered, because you were asking for an example study to follow.

You need to design your own study (with your supervisor?), and post again 
only once you have clear and specific questions showing where the 
functions in the packages you are using are causing problems.

Roger Bivand
(list admin.)

>
> Regards,
>
> Chethan S.
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From martin_brandt at gmx.net  Mon Jan  3 13:09:00 2011
From: martin_brandt at gmx.net (Martin)
Date: Mon, 3 Jan 2011 04:09:00 -0800 (PST)
Subject: [R-sig-Geo] recent raster package, bricks and ncdfs
Message-ID: <1294056540351-5880713.post@n2.nabble.com>


Dear raster package developers,

since my last update to the newest version bricks don't work any more with
netcdf files. I can load the data to a brick and everything seems normal,
but if i do any function I get this error:

> ncep_wa = crop(ncp, e)
Fehler in .readRowsBrickNetCDF(x, row, nrows, col, ncols, nlyrs = nlyrs) : 
  unbenutzte(s) Argument(e) (nlyrs = nlyrs)

> ncep = rotate(ncp)
Fehler in .readRowsBrickNetCDF(x, row, nrows, col, ncols, nlyrs = nlyrs) : 
  unbenutzte(s) Argument(e) (nlyrs = nlyrs)

the same worked with the old raster package without problems..

Martin Brandt
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/recent-raster-package-bricks-and-ncdfs-tp5880713p5880713.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From chethanuniversal at gmail.com  Mon Jan  3 14:57:28 2011
From: chethanuniversal at gmail.com (Chethan S)
Date: Mon, 3 Jan 2011 19:27:28 +0530
Subject: [R-sig-Geo] Modules for using geostatistics for image
	classification
In-Reply-To: <AANLkTim_3Yxjj55D94pULVKhetY5JuwweFV0rnsmvTN6@mail.gmail.com>
References: <AANLkTin+a1Z-kFHi+ye1haMbJ6ofU4s+ApS-cYkbWcve@mail.gmail.com>
	<alpine.LRH.2.00.1101031222550.20666@reclus.nhh.no>
	<AANLkTim_3Yxjj55D94pULVKhetY5JuwweFV0rnsmvTN6@mail.gmail.com>
Message-ID: <AANLkTimjAvRKPYmZwM4BEGRRSM6h3WKxubvbebxf6cMB@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110103/146003ba/attachment.pl>

From axs.seven at gmail.com  Tue Jan  4 00:00:09 2011
From: axs.seven at gmail.com (Axs Seven)
Date: Tue, 4 Jan 2011 01:00:09 +0200
Subject: [R-sig-Geo] Cutting off graphics at polygon/country borders
Message-ID: <AANLkTikzaJYD0YuLEaR5d6BjtNs4Nd7RhCbZrbiQbemh@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110104/c7bc43cf/attachment.pl>

From geomalik at live.com  Tue Jan  4 04:17:44 2011
From: geomalik at live.com (Malik Shahzad)
Date: Tue, 4 Jan 2011 10:17:44 +0700
Subject: [R-sig-Geo] Buffering in RS Image
Message-ID: <SNT111-W5494E448716C0EF7AA7A48AC080@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110104/49509a5b/attachment.pl>

From r.hijmans at gmail.com  Tue Jan  4 23:31:52 2011
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Tue, 4 Jan 2011 14:31:52 -0800 (PST)
Subject: [R-sig-Geo] recent raster package, bricks and ncdfs
In-Reply-To: <1294056540351-5880713.post@n2.nabble.com>
References: <1294056540351-5880713.post@n2.nabble.com>
Message-ID: <1294180312086-5890387.post@n2.nabble.com>


Sorry about that & thanks for reporting. Fixed in version 1.7-23, which is on
its way to CRAN. Robert
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/recent-raster-package-bricks-and-ncdfs-tp5880713p5890387.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From r.hijmans at gmail.com  Tue Jan  4 23:34:32 2011
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Tue, 4 Jan 2011 14:34:32 -0800 (PST)
Subject: [R-sig-Geo] Buffering in RS Image
In-Reply-To: <SNT111-W5494E448716C0EF7AA7A48AC080@phx.gbl>
References: <SNT111-W5494E448716C0EF7AA7A48AC080@phx.gbl>
Message-ID: <1294180472474-5890394.post@n2.nabble.com>


There are some functions in the 'raster' package. Perhaps something like:

library(raster)
x <- raster("vegetation file")
extract(x, houses, buffer=100) 

-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Buffering-in-RS-Image-tp5887532p5890394.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From martin_brandt at gmx.net  Wed Jan  5 14:18:44 2011
From: martin_brandt at gmx.net (Martin)
Date: Wed, 5 Jan 2011 05:18:44 -0800 (PST)
Subject: [R-sig-Geo] recent raster package, bricks and ncdfs
In-Reply-To: <1294180312086-5890387.post@n2.nabble.com>
References: <1294056540351-5880713.post@n2.nabble.com>
	<1294180312086-5890387.post@n2.nabble.com>
Message-ID: <1294233524037-5891925.post@n2.nabble.com>


thanks for fixing Robert. This error's gone, but there still seems to be a
problem with the dimensions of the ncdf-bricks. If I crop a brick, it
returns only one layer, and if i try to rotate it, i get the following
error:

>ncp = rotate(nc)
Fehler in dim(res) <- c(ncols, raster at data@nlayers * nrows):
  Dimensionen [Produkt 462240] passen nicht zur L?nge des Objektes [720]

which means in english that the dimensions do not fit the object length. As
a stack this works without problems..


-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/recent-raster-package-bricks-and-ncdfs-tp5880713p5891925.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From m.fairbrother at bristol.ac.uk  Thu Jan  6 12:15:59 2011
From: m.fairbrother at bristol.ac.uk (Malcolm Fairbrother)
Date: Thu, 6 Jan 2011 11:15:59 +0000
Subject: [R-sig-Geo] extracting the non-overlapping part of a polygon?
In-Reply-To: <mailman.9.1294138803.23930.r-sig-geo@r-project.org>
References: <mailman.9.1294138803.23930.r-sig-geo@r-project.org>
Message-ID: <23A99837-61D8-45F1-BDF8-333AC4E10846@bristol.ac.uk>

Dear all,

Is there a straightforward way of changing the shape of a polygon "A", by superimposing another polygon "B", and keeping only that part of "A" which is not overlapped by "B"?

In brief, and as a reproducible example, I'm trying to get a polygon for Greek Cyprus. It's easy to get a polygon for the whole island, and I've found a polygon of just the Turkish part of Cyprus. But I can't find a polygon for the Greek part alone, and it seems like there might be a way to create one by carving out the Turkish part from the whole island:

library(cshapes)
world <- cshp(date=as.Date("2008-6-30"))
cy <- world[world$CNTRY_NAME=="Cyprus",]

library(maptools)
download.file(url="http://www.naturalearthdata.com/http//www.naturalearthdata.com/download/50m/cultural/50m-admin-0-breakaway-disputed-areas.zip", dest="50m-admin-0-breakaway-disputed-areas.zip")
unzip("50m-admin-0-breakaway-disputed-areas.zip")
brk <- readShapeSpatial("50m-admin-0-breakaway-disputed-areas.shp", proj4string=CRS("+proj=longlat +ellps=WGS84"))
tuc <- brk[brk$Name=="Turkish Republic of Northern Cyprus",]

plot(cy)
plot(tuc, add=T)

Any assistance/suggestions would be much appreciated. Apologies if I've overlooked anything obvious.

- Malcolm


From hengl at spatial-analyst.net  Thu Jan  6 12:49:31 2011
From: hengl at spatial-analyst.net (Tomislav Hengl)
Date: Thu, 06 Jan 2011 12:49:31 +0100
Subject: [R-sig-Geo] Registrations for GEOSTAT 2011 summer school;
 24-31 July 2011 Koblenz-Landau University
Message-ID: <4D25AC4B.6010904@spatial-analyst.net>


Dear R-sig-geo,

It is my pleasure to inform you that the next GEOSTAT summer school will 
be held in the period 24-31 July 2011 at the Koblenz-Landau University. 
Interested candidates are invited to register for this summer school via:

[http://geostat-course.org/Register_for_Landau]

The registration deadline is 1st of March 2011.

To find more about the GEOSTAT 2011, please visit: 
[http://geostat-course.org/Landau_2011].


Local organizers:

Ralf B. Sch?fer (schaefer-ralf at uni-landau.de), Tomislav Hengl 
(tom.hengl at wur.nl)

Invited lecturers:

Roger Bivand (nhh.no), Edzer Pebesma (uni-muenster.de), Gerard Heuvelink 
(wur.nl), Markus Neteler (iasma.it), Olaf Conrad 
(geowiss.uni-hamburg.de), Markus Metz (uni-ulm.de), Dylan Beaudette 
(ucdavis.edu),


Topics:

- Spatial and temporal data representations
- Open Source Tools for Soil (and Environmental) Scientists
- Introduction to GRASS GIS
- SAGA GIS Tutorial
- Spatio-temporal variogram models - how to fit them, how to use them
- Optimisation of Spatial Sampling Designs
- Visualization and analysis of live data (MySQL, PostGIS, Google Earth)


Selection of candidates:

Candidates will be selected based on the following four criteria:
- Publication record derived as square root of number of publications 
multiplied by total citations.
- Contributions to the open source software community derived as the 
average ranking of the R-sig-geo traffic and OS software contributions.
- Distance to the venue expressed in arc-degrees.
- Time of application.


Course fees:

Course fees include registration fees (handouts, website and 
multimedia), coffee breaks, 5 lunch tickets, 1 ticket for gala dinner 
and complete costs of excursion on Saturday. The course fee are 
typically kept low (ca 200-300 EUR). A number of participants from ODA 
countries (i.e. with a permanent residence in some of the ODA listed 
countries) will be offered affordable or free accommodation in the 
vicinity of the institute. This summer school will be hosted by the 
Institute of Environmental Science, University of Koblenz-Landau. We are 
actively working on acquiring funding and financial support from the 
connected academic institutions and companies. All lecturers are 
volunteers. See also the refunding policy.


Travel and accommodation:

Landau is is easy accessible via train from major German airports 
(Frankfurt Airport, Stuttgart Airport etc.) within 1-2 hours. The 
university is located close to the town centre with many affordable 
opportunities for accommodation.

Registered participants will be offered a single room in a budget hotel 
(price about 25 ? per night including breakfast) unless they decide to 
arrange own accommodation. Free accommodation within the campus will be 
offered to a number of students from ODA countries (depending on the 
ranking).


cheers,

T. Hengl
http://www.wewur.wur.nl/popups/vcard.aspx?id=HENGL001


From kji2080 at gmail.com  Thu Jan  6 12:52:03 2011
From: kji2080 at gmail.com (Jooil Kim)
Date: Thu, 6 Jan 2011 20:52:03 +0900
Subject: [R-sig-Geo] Strategies for modifying country-specific grids
 from a global gridded dataset in simple matrix form?
In-Reply-To: <AANLkTi=59C-nDHQ+8OBLXfoSBrc9YW=3LhHfsgCMu90V@mail.gmail.com>
References: <AANLkTi=59C-nDHQ+8OBLXfoSBrc9YW=3LhHfsgCMu90V@mail.gmail.com>
Message-ID: <AANLkTikYbuRZkHtrWrwYDwkuSJRWbuZAao1qhXyubF0Z@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110106/901f6df2/attachment.pl>

From kji2080 at gmail.com  Thu Jan  6 17:18:24 2011
From: kji2080 at gmail.com (Jooil Kim)
Date: Fri, 7 Jan 2011 01:18:24 +0900
Subject: [R-sig-Geo] Strategies for modifying country-specific grids
 from a global gridded dataset in simple matrix form?
In-Reply-To: <AANLkTikYbuRZkHtrWrwYDwkuSJRWbuZAao1qhXyubF0Z@mail.gmail.com>
References: <AANLkTi=59C-nDHQ+8OBLXfoSBrc9YW=3LhHfsgCMu90V@mail.gmail.com>
	<AANLkTikYbuRZkHtrWrwYDwkuSJRWbuZAao1qhXyubF0Z@mail.gmail.com>
Message-ID: <AANLkTi=76PRdgEa+ZLSb3oaZdV_6JvbNyTdTeG_K+eFZ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110107/59065029/attachment.pl>

From pearman at wsl.ch  Thu Jan  6 18:02:14 2011
From: pearman at wsl.ch (Peter B. Pearman)
Date: Thu, 06 Jan 2011 18:02:14 +0100
Subject: [R-sig-Geo] no slot of name "data" for this object of class
	"RasterStack"
Message-ID: <4D25F596.6070809@wsl.ch>

Dear All,

I would, as a complete novice with raster() and associated R, very much 
appreciate any helpful suggestion here.

I created an xy-file and a stack of cropped rasters. The cropping was 
done the xy-file is the same size as the rasters (and stack), i.e. I'm 
trying to sample all the pixels.  But when I try to extract the values 
for all pixels of the rasters in the stack, I get the following error 
message:

 > full.area <- extract(raster.stack,xyfile)
Error in .readCells(x at layers[[j]], cells) :
   no slot of name "data" for this object of class "RasterStack"

I would greatly appreciate any constructive comment.

Best,

Peter


#The following is most of the code to create the raster stack and sample 
it using extract(), but which instead creates the error message.
library(rgdal)
library(raster)
library(utils)

dir.string <- "../WC_10min/"
vargroup <- c("bio","prec","tmax","tmin","tmean")
numfiles <- c(19,12,12,12,12)

mask <- raster("wheatmask")
extent <- extent(mask)

xmin <- attributes(extent)$xmin
xmax <- attributes(extent)$xmax
ymin <- attributes(extent)$ymin
ymax <- attributes(extent)$ymax
xlength <- dim(mask)[2]
ylength <- dim(mask)[1]


# make a file with coordinates for the mask area
x <- seq(from=xmin, to=xmax, length.out=xlength)
y <- seq(from=ymin,to=ymax,length.out=ylength)
xyfile <- expand.grid(x,y)

...

# create the raster stack
raster.stack <- stack()

# fill the stack with cropped climate rasters
raster.name.index <- 0
for (i in 1:length(numfiles)) {
   counter <- numfiles[i]
   for(j in 1:counter) {
     raster.name.index <- raster.name.index + 1
     rasterfile <- 
paste("../WC_10min/",vargroup[i],"/",vargroup[i],"_",j,sep="")
     eval(parse(text=paste(raw.raster.names[raster.name.index],".raw <- 
raster('",rasterfile,"')",sep="")))
     eval(parse(text=paste(raw.raster.names[raster.name.index],"<- 
crop(",raw.raster.names[raster.name.index],".raw,extent)",sep="")))
     eval(parse(text=paste("raster.stack <- 
stack(raster.stack,",raw.raster.names[raster.name.index],")",sep="")))
     print(paste("stack size is now ",raster.name.index,sep=""))
   }
}
full.area <- extract(raster.stack,xyfile)

Here is some more info on the objects:

 > head(xyfile)
       long      lat
1 5.745968 1.982493
2 5.912968 1.982493
3 6.079968 1.982493
4 6.246968 1.982493
5 6.413968 1.982493
6 6.580968 1.982493

# here is a partial attributes listing of the stack
 > attributes(raster.stack)
$filename
[1] ""

$layers
$layers[[1]]
class       : RasterStack
dimensions  : 418, 501, 1  (nrow, ncol, nlayers)
ncell       : 209418
projection  : +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs 
+towgs84=0,0,0
min values  : -132
max values  : 314
extent      : 5.666676, 89.16668, 2.000003, 71.66667  (xmin, xmax, ymin, 
ymax)
resolution  : 0.1666667, 0.1666667  (x, y)


$layers[[2]]
class       : RasterLayer
filename    :
dimensions  : 418, 501, 1  (nrow, ncol, nlayers)
ncell       : 209418
min value   : 38
max value   : 204
projection  : +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs 
+towgs84=0,0,0
extent      : 5.666676, 89.16668, 2.000003, 71.66667  (xmin, xmax, ymin, 
ymax)
resolution  : 0.1666667, 0.1666667  (x, y)


$layers[[3]]
class       : RasterLayer
filename    :
dimensions  : 418, 501, 1  (nrow, ncol, nlayers)
ncell       : 209418
min value   : 16
max value   : 88
projection  : +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs 
+towgs84=0,0,0
extent      : 5.666676, 89.16668, 2.000003, 71.66667  (xmin, xmax, ymin, 
ymax)
resolution  : 0.1666667, 0.1666667  (x, y)

...

I note that the first entry (above) is of class 'RasterStack', not 
'RasterLayer'.  Could this be important?


From r.hijmans at gmail.com  Thu Jan  6 19:25:51 2011
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Thu, 6 Jan 2011 10:25:51 -0800 (PST)
Subject: [R-sig-Geo] no slot of name "data" for this object of class
	"RasterStack"
In-Reply-To: <4D25F596.6070809@wsl.ch>
References: <4D25F596.6070809@wsl.ch>
Message-ID: <1294338351933-5896604.post@n2.nabble.com>


Hi Peter, 

I think you have made things way too complicated. I would suggest to do
something along these lines:

library(raster) 
# first get the filenames. 
vargroup <- c("bio","prec","tmax","tmin","tmean") 
filenames <- list()
for (v in vargroup) { 
	filenames <- c(filenames, list.files(path=paste("../WC_10min/", v, sep=""),
pattern=v) 
} 
# or perhaps even this would work (I am not sure what your file name pattern
is):
# filenames <- c(filenames, list.files(path="../WC_10min/", pattern=".grd",
recursive=TRUE) 

# then make a stack
s <- stack(filenames)
# get all the values
v <- getValues(s)


# Studying the raster vignette might also be a good idea

# For readability, instead of 
extent <- extent(mask) 
xmin <- attributes(extent)$xmin 
# you can do
xmin <- xmin(mask)
# and
xlength <- dim(mask)[2] 
# is equivalent to
xlength <- ncol(mask) 



Best, Robert

-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/no-slot-of-name-data-for-this-object-of-class-RasterStack-tp5896279p5896604.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From r.hijmans at gmail.com  Thu Jan  6 19:34:31 2011
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Thu, 6 Jan 2011 10:34:31 -0800 (PST)
Subject: [R-sig-Geo] no slot of name "data" for this object of class
	"RasterStack"
In-Reply-To: <1294338351933-5896604.post@n2.nabble.com>
References: <4D25F596.6070809@wsl.ch>
	<1294338351933-5896604.post@n2.nabble.com>
Message-ID: <1294338871305-5896633.post@n2.nabble.com>


Peter, I did not do the cropping, so it should probably be:

s <- stack(filenames) 
mask <- raster("wheatmask") 
sc <- crop(s, mask)
v <- getValues(sc) 

Robert
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/no-slot-of-name-data-for-this-object-of-class-RasterStack-tp5896279p5896633.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From jimmyjuan1 at hotmail.com  Thu Jan  6 20:41:58 2011
From: jimmyjuan1 at hotmail.com (Jimmy Martina)
Date: Thu, 6 Jan 2011 14:41:58 -0500
Subject: [R-sig-Geo] A definition to S.scale, please
Message-ID: <BLU162-w6100C494C0269117EDCEA8940A0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110106/a74d6ce4/attachment.pl>

From jimmyjuan1 at hotmail.com  Thu Jan  6 20:43:34 2011
From: jimmyjuan1 at hotmail.com (Jimmy Martina)
Date: Thu, 6 Jan 2011 14:43:34 -0500
Subject: [R-sig-Geo] Details about GLSM
Message-ID: <BLU162-w49D743DD1B663646C27D22940A0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110106/d5485921/attachment.pl>

From jimmyjuan1 at hotmail.com  Thu Jan  6 21:11:47 2011
From: jimmyjuan1 at hotmail.com (Jimmy Martina)
Date: Thu, 6 Jan 2011 15:11:47 -0500
Subject: [R-sig-Geo] What's a GLSM??? Please!
In-Reply-To: <BLU162-w49D743DD1B663646C27D22940A0@phx.gbl>
References: <BLU162-w49D743DD1B663646C27D22940A0@phx.gbl>
Message-ID: <BLU162-w2156AE698F0160558C25C8940A0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110106/31d5f586/attachment.pl>

From jimmyjuan1 at hotmail.com  Thu Jan  6 21:16:50 2011
From: jimmyjuan1 at hotmail.com (Jimmy Martina)
Date: Thu, 6 Jan 2011 15:16:50 -0500
Subject: [R-sig-Geo] What kind of kriging does a GLSM use?
Message-ID: <BLU162-w35D22ECA66997C0699CA0D940A0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110106/b8df3f8f/attachment.pl>

From rundel at gmail.com  Fri Jan  7 03:31:49 2011
From: rundel at gmail.com (rundel)
Date: Thu, 6 Jan 2011 18:31:49 -0800 (PST)
Subject: [R-sig-Geo] extracting the non-overlapping part of a polygon?
In-Reply-To: <23A99837-61D8-45F1-BDF8-333AC4E10846@bristol.ac.uk>
References: <23A99837-61D8-45F1-BDF8-333AC4E10846@bristol.ac.uk>
Message-ID: <1294367509118-5898021.post@n2.nabble.com>


You can accomplish this easily with rgeos. The function gDifference will
return the part of polygon A outside of polygon B. The following code should
get you what you need, some additional cleanup may be necessary since the
two polygons dont overlap very well.

library(rgeos)
greek_cy = gDifference(cy,tuc)

You will have to install the geos library and then the rgeos package from
source (you can download the source from r-forge) to use the package. If you
run into any problems let me know.
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/extracting-the-non-overlapping-part-of-a-polygon-tp5895179p5898021.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From jroll at lcog.org  Fri Jan  7 04:11:27 2011
From: jroll at lcog.org (jroll)
Date: Thu, 6 Jan 2011 19:11:27 -0800 (PST)
Subject: [R-sig-Geo] Dont show zero values in line graph
Message-ID: <1294369887234-5898080.post@n2.nabble.com>


Hey everyone,
   Im getting better at plotting my data but cant for the life of me figure
out how to show a line graph with missing data that doesnt continue the line
down to zero then back up to the remaining values.

Consider the following
x<-c(1:5,0,0,8:10)
y<-1:10

plot(0,0,xlim=c(0,10), ylim=c(0,10),type="n",main="Dont show the bloody 0
values!!")
lines(x~y, col="blue", lwd=2,)

My data is missing the 6th and 7th values and they come in as NA's so i
change them to 0s but then the plot has these ugly lines that dive toward
the x axis then back up.  I would do bar plots but i need to show multiple
sets of data on the same and side by side bars doesnt do it for me.  

So i need a line graph that starts and stops where 0s or missing values
exist.  Thoughts?

JR 
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Dont-show-zero-values-in-line-graph-tp5898080p5898080.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From edzer.pebesma at uni-muenster.de  Fri Jan  7 08:43:14 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 07 Jan 2011 08:43:14 +0100
Subject: [R-sig-Geo] Dont show zero values in line graph
In-Reply-To: <1294369887234-5898080.post@n2.nabble.com>
References: <1294369887234-5898080.post@n2.nabble.com>
Message-ID: <4D26C412.3090700@uni-muenster.de>



On 01/07/2011 04:11 AM, jroll wrote:
> 
> Hey everyone,
>    Im getting better at plotting my data but cant for the life of me figure
> out how to show a line graph with missing data that doesnt continue the line
> down to zero then back up to the remaining values.
> 
> Consider the following
> x<-c(1:5,0,0,8:10)
> y<-1:10
> 
> plot(0,0,xlim=c(0,10), ylim=c(0,10),type="n",main="Dont show the bloody 0
> values!!")
> lines(x~y, col="blue", lwd=2,)
> 
> My data is missing the 6th and 7th values and they come in as NA's so i
> change them to 0s but then the plot has these ugly lines that dive toward
> the x axis then back up.  I would do bar plots but i need to show multiple
> sets of data on the same and side by side bars doesnt do it for me.  
> 
> So i need a line graph that starts and stops where 0s or missing values
> exist.  Thoughts?

x<-c(1:5,NA,NA,8:10)
y<-1:10

plot(0,0,xlim=c(0,10), ylim=c(0,10),type="n",main="Dont show the bloody 0
values!!")
lines(x~y, col="blue", lwd=2,)

> 
> JR 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From r.m.krug at gmail.com  Fri Jan  7 09:43:05 2011
From: r.m.krug at gmail.com (Rainer M Krug)
Date: Fri, 07 Jan 2011 09:43:05 +0100
Subject: [R-sig-Geo] Dont show zero values in line graph
In-Reply-To: <4D26C412.3090700@uni-muenster.de>
References: <1294369887234-5898080.post@n2.nabble.com>
	<4D26C412.3090700@uni-muenster.de>
Message-ID: <4D26D219.7090307@gmail.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 01/07/2011 08:43 AM, Edzer Pebesma wrote:
> 
> 
> On 01/07/2011 04:11 AM, jroll wrote:
>>
>> Hey everyone,
>>    Im getting better at plotting my data but cant for the life of me figure
>> out how to show a line graph with missing data that doesnt continue the line
>> down to zero then back up to the remaining values.
>>
>> Consider the following
>> x<-c(1:5,0,0,8:10)
>> y<-1:10
>>
>> plot(0,0,xlim=c(0,10), ylim=c(0,10),type="n",main="Dont show the bloody 0
>> values!!")
>> lines(x~y, col="blue", lwd=2,)
>>
>> My data is missing the 6th and 7th values and they come in as NA's so i
>> change them to 0s but then the plot has these ugly lines that dive toward
>> the x axis then back up.  I would do bar plots but i need to show multiple
>> sets of data on the same and side by side bars doesnt do it for me.  
>>
>> So i need a line graph that starts and stops where 0s or missing values
>> exist.  Thoughts?
> 
> x<-c(1:5,NA,NA,8:10)
> y<-1:10
> 
> plot(0,0,xlim=c(0,10), ylim=c(0,10),type="n",main="Dont show the bloody 0
> values!!")
> lines(x~y, col="blue", lwd=2,)

And just to complete it: to replace all the 0 in x with NA, you can do

x[x==0] <- NA

There is also the is.na() function which should do this, i.e.

is.na(x) <- 0

should (in my understanding) set all 0 values in x to NA - but it dose
not work, whereas setting e.g. all the 4s to NA works:

> x<-c(1:5,0,0,8:10)
> is.na(x) <- 0
> x
 [1]  1  2  3  4  5  0  0  8  9 10
> is.na(x) <- 4
> x
 [1]  1  2  3 NA  5  0  0  8  9 10
>

Why is this? Is this a bug in R or in y understanding?

Cheers,

Rainer
> 
>>
>> JR 
> 


- -- 
Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation
Biology, UCT), Dipl. Phys. (Germany)

Centre of Excellence for Invasion Biology
Natural Sciences Building
Office Suite 2039
Stellenbosch University
Main Campus, Merriman Avenue
Stellenbosch
South Africa

Tel:        +33 - (0)9 53 10 27 44
Cell:       +27 - (0)8 39 47 90 42
Fax (SA):   +27 - (0)8 65 16 27 82
Fax (D) :   +49 - (0)3 21 21 25 22 44
Fax (FR):   +33 - (0)9 58 10 27 44
email:      Rainer at krugs.de

Skype:      RMkrug
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/

iEYEARECAAYFAk0m0hkACgkQoYgNqgF2egrgkwCfaBiMYARsOW41gSHF/7VXf41Z
2sIAnA4eGuy5Wo51Paya3BP/XpCC9Q9D
=yNlD
-----END PGP SIGNATURE-----


From breitbach at uni-mainz.de  Fri Jan  7 11:37:32 2011
From: breitbach at uni-mainz.de (Breitbach, Nils)
Date: Fri, 7 Jan 2011 10:37:32 +0000
Subject: [R-sig-Geo] Habitat on a given location (spatial join with R)
Message-ID: <E7F1EF063B11DA4DAD16374549B879E82AE5C4B5@e14mdb-02.zdv.Uni-Mainz.DE>

Derar community,

this time I need to find habitat type on given location for a huge number of points. I have two layers: the first (upper) one is a point shape with approx. 100,000 point locations; the second one is a polygon shape with many features containing habitat types (on a very fine scale). Now, I need the habitat type "under" every point or better said for every point location.

The "Spatial Join" Tool in ESRI's ArcGIS  would do exactly what I need but since I did all my analyses with R so far I really would like to avoid the permanent jumping between R and ArcGIS. Is there a function in R that solves my problem?              

Cheers,

Nils

From edzer.pebesma at uni-muenster.de  Fri Jan  7 11:56:16 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 07 Jan 2011 11:56:16 +0100
Subject: [R-sig-Geo] Dont show zero values in line graph
In-Reply-To: <4D26D219.7090307@gmail.com>
References: <1294369887234-5898080.post@n2.nabble.com>
	<4D26C412.3090700@uni-muenster.de> <4D26D219.7090307@gmail.com>
Message-ID: <4D26F150.8080906@uni-muenster.de>



On 01/07/2011 09:43 AM, Rainer M Krug wrote:
> On 01/07/2011 08:43 AM, Edzer Pebesma wrote:
> 
> 
>> On 01/07/2011 04:11 AM, jroll wrote:
>>>
>>> Hey everyone,
>>>    Im getting better at plotting my data but cant for the life of me figure
>>> out how to show a line graph with missing data that doesnt continue the line
>>> down to zero then back up to the remaining values.
>>>
>>> Consider the following
>>> x<-c(1:5,0,0,8:10)
>>> y<-1:10
>>>
>>> plot(0,0,xlim=c(0,10), ylim=c(0,10),type="n",main="Dont show the bloody 0
>>> values!!")
>>> lines(x~y, col="blue", lwd=2,)
>>>
>>> My data is missing the 6th and 7th values and they come in as NA's so i
>>> change them to 0s but then the plot has these ugly lines that dive toward
>>> the x axis then back up.  I would do bar plots but i need to show multiple
>>> sets of data on the same and side by side bars doesnt do it for me.  
>>>
>>> So i need a line graph that starts and stops where 0s or missing values
>>> exist.  Thoughts?
> 
>> x<-c(1:5,NA,NA,8:10)
>> y<-1:10
> 
>> plot(0,0,xlim=c(0,10), ylim=c(0,10),type="n",main="Dont show the bloody 0
>> values!!")
>> lines(x~y, col="blue", lwd=2,)
> 
> And just to complete it: to replace all the 0 in x with NA, you can do
> 
> x[x==0] <- NA
> 
> There is also the is.na() function which should do this, i.e.
> 
> is.na(x) <- 0
> 
> should (in my understanding) set all 0 values in x to NA - but it dose
> not work, whereas setting e.g. all the 4s to NA works:
> 
>> x<-c(1:5,0,0,8:10)
>> is.na(x) <- 0
>> x
>  [1]  1  2  3  4  5  0  0  8  9 10
>> is.na(x) <- 4
>> x
>  [1]  1  2  3 NA  5  0  0  8  9 10
> 
> 
> Why is this? Is this a bug in R or in y understanding?

try ?is.na:

Usage:

     NA
     is.na(x)
     ## S3 method for class 'data.frame'
     is.na(x)

     is.na(x) <- value

Arguments:

       x: an R object to be tested: the default method handles atomic
          vectors, lists and pairlists.

   value: a suitable index vector for use with ?x?.

so,

is.na(x) <- 0

does nothing, as 0 is not a suitable index vector:

> x = 1:10
> x[0]
integer(0)

x[5] = 0
is.na(x) <- x == 0
x
 [1]  1  2  3  4 NA  6  7  8  9 10

does what you wanted, I believe.

> 
> Cheers,
> 
> Rainer
> 
>>>
>>> JR 
> 
> 
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From mdsumner at gmail.com  Fri Jan  7 12:01:07 2011
From: mdsumner at gmail.com (Michael Sumner)
Date: Fri, 7 Jan 2011 22:01:07 +1100
Subject: [R-sig-Geo] Habitat on a given location (spatial join with R)
In-Reply-To: <E7F1EF063B11DA4DAD16374549B879E82AE5C4B5@e14mdb-02.zdv.Uni-Mainz.DE>
References: <E7F1EF063B11DA4DAD16374549B879E82AE5C4B5@e14mdb-02.zdv.Uni-Mainz.DE>
Message-ID: <AANLkTim_Z==f0przjwv-vRpb_pHsMNQykPR9Gp-Fo-vQ@mail.gmail.com>

library(sp)
?overlay

The example there overlay(srdf, meuse) does what you want for two
variables "X1" and "X2" copied from SpatialPolygonsDataFrame srdf to
the coordinates of SpatialPointsDataFrame meuse.

Also try the sp vignette for an introduction to the Spatial types:

vignette("sp")

I used rgdal's readOGR for shapefiles, but there are other read
functions for shapefiles in maptools, which may be more convenient.

Cheers, Mike.




On Fri, Jan 7, 2011 at 9:37 PM, Breitbach, Nils <breitbach at uni-mainz.de> wrote:
> Derar community,
>
> this time I need to find habitat type on given location for a huge number of points. I have two layers: the first (upper) one is a point shape with approx. 100,000 point locations; the second one is a polygon shape with many features containing habitat types (on a very fine scale). Now, I need the habitat type "under" every point or better said for every point location.
>
> The "Spatial Join" Tool in ESRI's ArcGIS ?would do exactly what I need but since I did all my analyses with R so far I really would like to avoid the permanent jumping between R and ArcGIS. Is there a function in R that solves my problem?
>
> Cheers,
>
> Nils
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Michael Sumner
Institute for Marine and Antarctic Studies, University of Tasmania
Hobart, Australia
e-mail: mdsumner at gmail.com


From r.m.krug at gmail.com  Fri Jan  7 12:07:23 2011
From: r.m.krug at gmail.com (Rainer M Krug)
Date: Fri, 07 Jan 2011 12:07:23 +0100
Subject: [R-sig-Geo] Dont show zero values in line graph
In-Reply-To: <4D26F150.8080906@uni-muenster.de>
References: <1294369887234-5898080.post@n2.nabble.com>
	<4D26C412.3090700@uni-muenster.de> <4D26D219.7090307@gmail.com>
	<4D26F150.8080906@uni-muenster.de>
Message-ID: <4D26F3EB.9090405@gmail.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 01/07/2011 11:56 AM, Edzer Pebesma wrote:
> 
> 
> On 01/07/2011 09:43 AM, Rainer M Krug wrote:
>> On 01/07/2011 08:43 AM, Edzer Pebesma wrote:
>>
>>
>>> On 01/07/2011 04:11 AM, jroll wrote:
>>>>
>>>> Hey everyone,
>>>>    Im getting better at plotting my data but cant for the life of me figure
>>>> out how to show a line graph with missing data that doesnt continue the line
>>>> down to zero then back up to the remaining values.
>>>>
>>>> Consider the following
>>>> x<-c(1:5,0,0,8:10)
>>>> y<-1:10
>>>>
>>>> plot(0,0,xlim=c(0,10), ylim=c(0,10),type="n",main="Dont show the bloody 0
>>>> values!!")
>>>> lines(x~y, col="blue", lwd=2,)
>>>>
>>>> My data is missing the 6th and 7th values and they come in as NA's so i
>>>> change them to 0s but then the plot has these ugly lines that dive toward
>>>> the x axis then back up.  I would do bar plots but i need to show multiple
>>>> sets of data on the same and side by side bars doesnt do it for me.  
>>>>
>>>> So i need a line graph that starts and stops where 0s or missing values
>>>> exist.  Thoughts?
>>
>>> x<-c(1:5,NA,NA,8:10)
>>> y<-1:10
>>
>>> plot(0,0,xlim=c(0,10), ylim=c(0,10),type="n",main="Dont show the bloody 0
>>> values!!")
>>> lines(x~y, col="blue", lwd=2,)
>>
>> And just to complete it: to replace all the 0 in x with NA, you can do
>>
>> x[x==0] <- NA
>>
>> There is also the is.na() function which should do this, i.e.
>>
>> is.na(x) <- 0
>>
>> should (in my understanding) set all 0 values in x to NA - but it dose
>> not work, whereas setting e.g. all the 4s to NA works:
>>
>>> x<-c(1:5,0,0,8:10)
>>> is.na(x) <- 0
>>> x
>>  [1]  1  2  3  4  5  0  0  8  9 10
>>> is.na(x) <- 4
>>> x
>>  [1]  1  2  3 NA  5  0  0  8  9 10
>>
>>
>> Why is this? Is this a bug in R or in y understanding?
> 
> try ?is.na:

I did ...

> 
> Usage:
> 
>      NA
>      is.na(x)
>      ## S3 method for class 'data.frame'
>      is.na(x)
> 
>      is.na(x) <- value
> 
> Arguments:
> 
>        x: an R object to be tested: the default method handles atomic
>           vectors, lists and pairlists.
> 
>    value: a suitable index vector for use with ?x?.

but my understanding of is.na() modified the help.
Thanks for pointing this out - now I know how I can use
is.na(...) <- ...

> 
> so,
> 
> is.na(x) <- 0
> 
> does nothing, as 0 is not a suitable index vector:

Absolutely true.

> 
>> x = 1:10
>> x[0]
> integer(0)
> 
> x[5] = 0
> is.na(x) <- x == 0
> x
>  [1]  1  2  3  4 NA  6  7  8  9 10
> 
> does what you wanted, I believe.

Yes - thanks a lot.

> 
>>
>> Cheers,
>>
>> Rainer
>>
>>>>
>>>> JR 
>>
>>
>>
> 


- -- 
Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation
Biology, UCT), Dipl. Phys. (Germany)

Centre of Excellence for Invasion Biology
Natural Sciences Building
Office Suite 2039
Stellenbosch University
Main Campus, Merriman Avenue
Stellenbosch
South Africa

Tel:        +33 - (0)9 53 10 27 44
Cell:       +27 - (0)8 39 47 90 42
Fax (SA):   +27 - (0)8 65 16 27 82
Fax (D) :   +49 - (0)3 21 21 25 22 44
Fax (FR):   +33 - (0)9 58 10 27 44
email:      Rainer at krugs.de

Skype:      RMkrug
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/

iEYEARECAAYFAk0m8+sACgkQoYgNqgF2egoHmQCghTrTf0nYgEB4O8oHbnbm0Eit
gOQAn0//sj7xshLPFZ+QDxzXiyofv39J
=mSj4
-----END PGP SIGNATURE-----


From seanpor at acm.org  Fri Jan  7 12:15:38 2011
From: seanpor at acm.org (Sean O'Riordain)
Date: Fri, 7 Jan 2011 11:15:38 +0000
Subject: [R-sig-Geo] Habitat on a given location (spatial join with R)
In-Reply-To: <E7F1EF063B11DA4DAD16374549B879E82AE5C4B5@e14mdb-02.zdv.Uni-Mainz.DE>
References: <E7F1EF063B11DA4DAD16374549B879E82AE5C4B5@e14mdb-02.zdv.Uni-Mainz.DE>
Message-ID: <AANLkTimUzF3eo=o+T29YGA1GmCDp2Z-5L1ts_RSvTN3p@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110107/b8cabad6/attachment.ksh>

From kevinummel at gmail.com  Fri Jan  7 16:14:52 2011
From: kevinummel at gmail.com (Kevin Ummel)
Date: Fri, 7 Jan 2011 15:14:52 +0000
Subject: [R-sig-Geo] 'nowrapSpatialPolygons' doesn't remove horizontal
	scratches
Message-ID: <9133A8C9-924B-4B85-B29A-DEDC978CA47A@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110107/88a8a94e/attachment.pl>

From tgriffin at uaex.edu  Fri Jan  7 16:35:05 2011
From: tgriffin at uaex.edu (Terry Griffin)
Date: Fri, 7 Jan 2011 09:35:05 -0600 (CST)
Subject: [R-sig-Geo] Dont show zero values in line graph
Message-ID: <357814273.9766531294414505700.JavaMail.root@zmail.uaex.edu>



Terry Griffin, PhD
Assistant Professor - Economics
University of Arkansas - Division of Agriculture
501.671.2182

-----Original Message-----
From: Rainer M Krug <r.m.krug at gmail.com>
Sent: Friday, January 07, 2011 3:44 AM
To: Edzer Pebesma <edzer.pebesma at uni-muenster.de>
Cc: r-sig-geo at r-project.org; jroll at lcog.org
Subject: Re: [R-sig-Geo] Dont show zero values in line graph

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 01/07/2011 08:43 AM, Edzer Pebesma wrote:
> 
> 
> On 01/07/2011 04:11 AM, jroll wrote:
>>
>> Hey everyone,
>>    Im getting better at plotting my data but cant for the life of me figure
>> out how to show a line graph with missing data that doesnt continue the line
>> down to zero then back up to the remaining values.
>>
>> Consider the following
>> x<-c(1:5,0,0,8:10)
>> y<-1:10
>>
>> plot(0,0,xlim=c(0,10), ylim=c(0,10),type="n",main="Dont show the bloody 0
>> values!!")
>> lines(x~y, col="blue", lwd=2,)
>>
>> My data is missing the 6th and 7th values and they come in as NA's so i
>> change them to 0s but then the plot has these ugly lines that dive toward
>> the x axis then back up.  I would do bar plots but i need to show multiple
>> sets of data on the same and side by side bars doesnt do it for me.  
>>
>> So i need a line graph that starts and stops where 0s or missing values
>> exist.  Thoughts?
> 
> x<-c(1:5,NA,NA,8:10)
> y<-1:10
> 
> plot(0,0,xlim=c(0,10), ylim=c(0,10),type="n",main="Dont show the bloody 0
> values!!")
> lines(x~y, col="blue", lwd=2,)

And just to complete it: to replace all the 0 in x with NA, you can do

x[x==0] <- NA

There is also the is.na() function which should do this, i.e.

is.na(x) <- 0

should (in my understanding) set all 0 values in x to NA - but it dose
not work, whereas setting e.g. all the 4s to NA works:

> x<-c(1:5,0,0,8:10)
> is.na(x) <- 0
> x
 [1]  1  2  3  4  5  0  0  8  9 10
> is.na(x) <- 4
> x
 [1]  1  2  3 NA  5  0  0  8  9 10
>

Why is this? Is this a bug in R or in y understanding?

Cheers,

Rainer
> 
>>
>> JR 
> 


- -- 
Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation
Biology, UCT), Dipl. Phys. (Germany)

Centre of Excellence for Invasion Biology
Natural Sciences Building
Office Suite 2039
Stellenbosch University
Main Campus, Merriman Avenue
Stellenbosch
South Africa

Tel:        +33 - (0)9 53 10 27 44
Cell:       +27 - (0)8 39 47 90 42
Fax (SA):   +27 - (0)8 65 16 27 82
Fax (D) :   +49 - (0)3 21 21 25 22 44
Fax (FR):   +33 - (0)9 58 10 27 44
email:      Rainer at krugs.de

Skype:      RMkrug
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/

iEYEARECAAYFAk0m0hkACgkQoYgNqgF2egrgkwCfaBiMYARsOW41gSHF/7VXf41Z
2sIAnA4eGuy5Wo51Paya3BP/XpCC9Q9D
=yNlD
-----END PGP SIGNATURE-----

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From jean.lapointe at tlb.sympatico.ca  Fri Jan  7 17:38:57 2011
From: jean.lapointe at tlb.sympatico.ca (Jean Lapointe)
Date: Fri, 7 Jan 2011 11:38:57 -0500
Subject: [R-sig-Geo] How to export kde object in ArcGIS?
Message-ID: <!&!AAAAAAAAAAAYAAAAAAAAACvQ1mt4wq9Dqz1E6V77n4jCgAAAEAAAALBeqZctiLFAicW1xTa+5KoBAAAAAA==@tlb.sympatico.ca>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110107/01bdf139/attachment.pl>

From Roger.Bivand at nhh.no  Fri Jan  7 20:21:13 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 7 Jan 2011 20:21:13 +0100 (CET)
Subject: [R-sig-Geo] 'nowrapSpatialPolygons' doesn't remove horizontal
 scratches
In-Reply-To: <9133A8C9-924B-4B85-B29A-DEDC978CA47A@gmail.com>
References: <9133A8C9-924B-4B85-B29A-DEDC978CA47A@gmail.com>
Message-ID: <alpine.LRH.2.00.1101072013310.9063@reclus.nhh.no>

On Fri, 7 Jan 2011, Kevin Ummel wrote:

> Hello,
>
> I have a shapefile with polygons located in Oceania, some of which straddle longitude =-180/0. When plotted, horizontal scratches result. I assumed that use of 'nowrapSpatialPolygons' would do the trick, but the plot looks the same before and after. Clearly, I'm not utilizing it properly. Could someone look at the example code below Ultimately, I need to successfully rasterize the data onto a -180/180 grid, so maybe another solution exists...
>
> Thanks!
> Kevin
>
> The folder (WDPA Oceania) with the example shapefile can be downloaded here: http://dl.dropbox.com/u/14314000/WDPA%20Oceania.zip
>
> orig=readShapeSpatial("sql_statement",CRS("+proj=longlat"))
>
> plot(orig)
>
> out=nowrapSpatialPolygons(orig,offset=180)

No, you mean:

out <- recenter(orig)
out1 <- SpatialPolygonsDataFrame(out, data=slot(orig, "data"))
plot(out1, axes=TRUE)

If you need to merge the input polygons that were split by 180 degrees, 
and now appear as touching polygons, you'll need to identify them somehow.

Hope this helps,

Roger

>
> plot(out)
>
>
>
>
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From tsippel at gmail.com  Fri Jan  7 21:05:23 2011
From: tsippel at gmail.com (tsippel)
Date: Fri, 7 Jan 2011 10:05:23 -1000
Subject: [R-sig-Geo] Habitat on a given location (spatial join with R)
Message-ID: <AANLkTik_K8Z7BHomB2=iX4AmTZkosj9f-XOQA-Vjyagb@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110107/c43c4745/attachment.pl>

From kevinummel at gmail.com  Fri Jan  7 23:38:39 2011
From: kevinummel at gmail.com (Kevin Ummel)
Date: Fri, 7 Jan 2011 22:38:39 +0000
Subject: [R-sig-Geo] 'nowrapSpatialPolygons' doesn't remove horizontal
	scratches
In-Reply-To: <alpine.LRH.2.00.1101072013310.9063@reclus.nhh.no>
References: <9133A8C9-924B-4B85-B29A-DEDC978CA47A@gmail.com>
	<alpine.LRH.2.00.1101072013310.9063@reclus.nhh.no>
Message-ID: <47466CC6-566D-4F1C-8161-93938BAAE63A@gmail.com>

Thanks, Roger. I still need the extent of 'out1' to match the extent of 'orig'. i.e. I need to subtract 360 from each out1 x-coordinate greater than 180, but is there an easy way to directly access and overwrite the polygon coordinates? Indexing through the structure -- at least judging by str(out1) -- looks potentially messy.

> extent(orig)
class       : Extent 
xmin        : -180 
xmax        : 180 
ymin        : -68.65256 
ymax        : 22.47224 

> extent(out1)
class       : Extent 
xmin        : 60.87917 
xmax        : 221.1910 
ymin        : -68.65256 
ymax        : 22.47224 

On Jan 7, 2011, at 7:21 PM, Roger Bivand wrote:

> On Fri, 7 Jan 2011, Kevin Ummel wrote:
> 
>> Hello,
>> 
>> I have a shapefile with polygons located in Oceania, some of which straddle longitude =-180/0. When plotted, horizontal scratches result. I assumed that use of 'nowrapSpatialPolygons' would do the trick, but the plot looks the same before and after. Clearly, I'm not utilizing it properly. Could someone look at the example code below Ultimately, I need to successfully rasterize the data onto a -180/180 grid, so maybe another solution exists...
>> 
>> Thanks!
>> Kevin
>> 
>> The folder (WDPA Oceania) with the example shapefile can be downloaded here: http://dl.dropbox.com/u/14314000/WDPA%20Oceania.zip
>> 
>> orig=readShapeSpatial("sql_statement",CRS("+proj=longlat"))
>> 
>> plot(orig)
>> 
>> out=nowrapSpatialPolygons(orig,offset=180)
> 
> No, you mean:
> 
> out <- recenter(orig)
> out1 <- SpatialPolygonsDataFrame(out, data=slot(orig, "data"))
> plot(out1, axes=TRUE)
> 
> If you need to merge the input polygons that were split by 180 degrees, and now appear as touching polygons, you'll need to identify them somehow.
> 
> Hope this helps,
> 
> Roger
> 
>> 
>> plot(out)
>> 
>> 
>> 
>> 
>> 
>> 
>> 	[[alternative HTML version deleted]]
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
> 
> -- 
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
> 


From HodgessE at uhd.edu  Sat Jan  8 05:35:12 2011
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Fri, 7 Jan 2011 22:35:12 -0600
Subject: [R-sig-Geo] sqrt{chi squared} map
Message-ID: <586A4828D7AAA04CA9B258C50A28DA206DB2C7@BALI.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110107/870d9244/attachment.pl>

From r.hijmans at gmail.com  Sat Jan  8 05:51:52 2011
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Fri, 7 Jan 2011 20:51:52 -0800 (PST)
Subject: [R-sig-Geo] How to export kde object in ArcGIS?
In-Reply-To: <!&!AAAAAAAAAAAYAAAAAAAAACvQ1mt4wq9Dqz1E6V77n4jCgAAAEAAAALBeqZctiLFAicW1xTa+5KoBAAAAAA==@tlb.sympatico.ca>
References: <!&!AAAAAAAAAAAYAAAAAAAAACvQ1mt4wq9Dqz1E6V77n4jCgAAAEAAAALBeqZctiLFAicW1xTa+5KoBAAAAAA==@tlb.sympatico.ca>
Message-ID: <1294462312291-5901748.post@n2.nabble.com>


Jean, 
I do not know anything about this object, so perhaps there are better
solutions. But a quick inspection with str(kd) suggest you can do the below:

library(raster)
library(rgdal)

r <- raster(kd$estimate, xmn=min(kd$eval.points[[1]]),
xmx=max(kd$eval.points[[1]]), ymn=min(kd$eval.points[[2]]),
ymx=max(kd$eval.points[[2]]))
plot(r)
contour(r, add=TRUE)

# you can save the raster values
r <- writeRaster(r, 'filename.tif') 

# and the contours, but to get the contours you want you may 
# need to scale the raster and add arguments to rasterToContour
x = rasterToContour(r)
writeOGR(x, ... 

Robert
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/How-to-export-kde-object-in-ArcGIS-tp5899887p5901748.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Roger.Bivand at nhh.no  Sat Jan  8 12:39:23 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 8 Jan 2011 12:39:23 +0100 (CET)
Subject: [R-sig-Geo] 'nowrapSpatialPolygons' doesn't remove horizontal
 scratches
In-Reply-To: <47466CC6-566D-4F1C-8161-93938BAAE63A@gmail.com>
References: <9133A8C9-924B-4B85-B29A-DEDC978CA47A@gmail.com>
	<alpine.LRH.2.00.1101072013310.9063@reclus.nhh.no>
	<47466CC6-566D-4F1C-8161-93938BAAE63A@gmail.com>
Message-ID: <alpine.LRH.2.00.1101081234240.11765@reclus.nhh.no>

On Fri, 7 Jan 2011, Kevin Ummel wrote:

> Thanks, Roger. I still need the extent of 'out1' to match the extent of 
> 'orig'. i.e. I need to subtract 360 from each out1 x-coordinate greater 
> than 180, but is there an easy way to directly access and overwrite the 
> polygon coordinates? Indexing through the structure -- at least judging 
> by str(out1) -- looks potentially messy.

No, you can either have geographical coordinates -180 to 180 or 0 to 360, 
but not both. You cannot join -180 == 180 on a planar display. So either 
you suffer the reat of the world getting in the way, or you convert all 
the other objects to 0 to 360 (which looks easier to do - if rasters, 
substitute the GridTopology in the underlying SpatialGridData Frame. If 
you cannot, then you can either analyse or display, but not both.

Roger

>
>> extent(orig)
> class       : Extent
> xmin        : -180
> xmax        : 180
> ymin        : -68.65256
> ymax        : 22.47224
>
>> extent(out1)
> class       : Extent
> xmin        : 60.87917
> xmax        : 221.1910
> ymin        : -68.65256
> ymax        : 22.47224
>
> On Jan 7, 2011, at 7:21 PM, Roger Bivand wrote:
>
>> On Fri, 7 Jan 2011, Kevin Ummel wrote:
>>
>>> Hello,
>>>
>>> I have a shapefile with polygons located in Oceania, some of which straddle longitude =-180/0. When plotted, horizontal scratches result. I assumed that use of 'nowrapSpatialPolygons' would do the trick, but the plot looks the same before and after. Clearly, I'm not utilizing it properly. Could someone look at the example code below Ultimately, I need to successfully rasterize the data onto a -180/180 grid, so maybe another solution exists...
>>>
>>> Thanks!
>>> Kevin
>>>
>>> The folder (WDPA Oceania) with the example shapefile can be downloaded here: http://dl.dropbox.com/u/14314000/WDPA%20Oceania.zip
>>>
>>> orig=readShapeSpatial("sql_statement",CRS("+proj=longlat"))
>>>
>>> plot(orig)
>>>
>>> out=nowrapSpatialPolygons(orig,offset=180)
>>
>> No, you mean:
>>
>> out <- recenter(orig)
>> out1 <- SpatialPolygonsDataFrame(out, data=slot(orig, "data"))
>> plot(out1, axes=TRUE)
>>
>> If you need to merge the input polygons that were split by 180 degrees, and now appear as touching polygons, you'll need to identify them somehow.
>>
>> Hope this helps,
>>
>> Roger
>>
>>>
>>> plot(out)
>>>
>>>
>>>
>>>
>>>
>>>
>>> 	[[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>> --
>> Roger Bivand
>> Economic Geography Section, Department of Economics, Norwegian School of
>> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Sat Jan  8 18:40:47 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 8 Jan 2011 18:40:47 +0100 (CET)
Subject: [R-sig-Geo] Installation of rgdal from CRAN on MACOSX does not
 work
In-Reply-To: <alpine.LRH.2.00.1012301555250.4426@reclus.nhh.no>
References: <AANLkTikBcJ1DM=D=0_sB7kHjiYVjhv9+1gnLnj3MzZTJ@mail.gmail.com>
	<alpine.LRH.2.00.1012291519480.771@reclus.nhh.no>
	<AANLkTi=utB+O8PPVmYtE8yuhMt+yRReiK6rUHpnCj9v3@mail.gmail.com>
	<alpine.LRH.2.00.1012301555250.4426@reclus.nhh.no>
Message-ID: <alpine.LRH.2.00.1101081830230.12554@reclus.nhh.no>

On Thu, 30 Dec 2010, Roger Bivand wrote:

> On Wed, 29 Dec 2010, Agustin Lobo wrote:
>
>> Roger,
>> 
>> But
>> http://www.kyngchaos.com/files/software/frameworks/rgdal-0.6.29-1.zip
>> installs with no problems on the same machine and on the same R, would that 
>> not
>> discard the possibility of an
>>> issue of your R installation,
>>> possibly a multi-architecture issue
>> 
>> as you suggest?
>> 
>> Please note I'm not personally in a hurry any more as we can work with
>> the rgdal from kyngchaos.
>
> I will have access to an OSX laptop in a little over a week, and will try out 
> the CRAN rgdal binaries. Just one report of installation failure isn't 
> enough. I think that maybe someone on R-sig-mac might know why rgdal.so is 
> looking for libR.dylib; I don't use OSX, and don't have easy access to such a 
> machine, which is why I asked for others to comment.

On a Leopard 10.5.8, I see the problem reported by Agus for the CRAN-extra 
OSX binary rgdal package and freshly installed R 2.12.1 (libR.dylib image 
not found) in the 32-bit R-GUI, but no problem when running R from the 
command line. A different problem (mach-o, but wrong architecture) occurs 
in 64-bit systems, both run from the command line and from R-GUI. Could 
anyone who wants to follow this up please post to R-sig-Mac, which is the 
correct list for OSX issues?

Conclusion: on Leopard, the CRAN extras rgdal binary can be used in the 
32-bit R application run from the command line, but not otherwise. R 
2.12.1 installs the 64-bit GUI into the OSX applications toolbar - one 
needs to open a terminal and type "R", checking that the length of a 
pointer is 4, to run the version that works.

Roger

PS. The symptoms are:

R64, R-GUI 64

> library(rgdal)
Loading required package: sp
Error in dyn.load(file, DLLpath = DLLpath, ...) :
   unable to load shared object 
'/Library/Frameworks/R.framework/Versions/2.12/Resources/library/rgdal/libs/x86_64/rgdal.so':

dlopen(/Library/Frameworks/R.framework/Versions/2.12/Resources/library/rgdal/libs/x86_64/rgdal.so, 
6): no suitable image found.  Did find:

/Library/Frameworks/R.framework/Versions/2.12/Resources/library/rgdal/libs/x86_64/rgdal.so: 
mach-o, but wrong architecture
Error: package/namespace load failed for 'rgdal'



R-GUI 32

> library(rgdal)
Loading required package: sp
Error in dyn.load(file, DLLpath = DLLpath, ...) :
   unable to load shared object 
'/Library/Frameworks/R.framework/Versions/2.12/Resources/library/rgdal/libs/i386/rgdal.so':

dlopen(/Library/Frameworks/R.framework/Versions/2.12/Resources/library/rgdal/libs/i386/rgdal.so, 
6): Library not loaded: libR.dylib
   Referenced from: 
/Library/Frameworks/R.framework/Versions/2.12/Resources/library/rgdal/libs/i386/rgdal.so
   Reason: image not found
Error: package/namespace load failed for 'rgdal'


>
> Roger
>
>> I just want to report the error to help
>> having an rgdal installation for MACOSX as
>> simple as for Windows.
>> I understand installing from source will always be a bit more
>> difficult on MACOSX than on linux as there are some basic tools and
>> libraries that are missing on regular MAC systems that must be
>> previously installed, but this is not my concern now as I'm focusing
>> on installations from binaries.
>> 
>> Thanks!
>> 
>> Agus
>> 
>> 
>> 
>> 2010/12/29 Roger Bivand <Roger.Bivand at nhh.no>:
>>> On Wed, 29 Dec 2010, Agustin Lobo wrote:
>>> 
>>>> While the installation from
>>>> http://www.kyngchaos.com/files/software/frameworks/rgdal-0.6.29-1.zip
>>>> works fine
>>>> the installation of rgdal from CRAN on MACOSX does not work, despite
>>>> my previous message that this issue was solved as well
>>> 
>>> Please do read the error message:
>>> 
>>>> ?unable to load shared object
>>>> 
>>> '/Library/Frameworks/R.framework/Versions/2.12/Resources/library/rgdal/libs/i$
>>>> 
>>> dlopen(/Library/Frameworks/R.framework/Versions/2.12/Resources/library/rgdal$
>>>> 
>>>> 6): Library not loaded: libR.dylib
>>>> ?Referenced from:
>>>> 
>>> /Library/Frameworks/R.framework/Versions/2.12/Resources/library/rgdal/libs/i3$
>>>> 
>>>> ?Reason: image not found
>>> 
>>> The image that is not found is libR.dylib, the main R dylib against which
>>> rgdal.so is linked. So this is still an issue of your R installation,
>>> possibly a multi-architecture issue (is libR.dylib the i386 version,
>>> guessing - is libR64.dylib the 64-bit Intel version?).
>>> 
>>> Could any OSX users who are using CRAN extra rgdal please help Agus to
>>> resolve this - it could be that local path modifications are hiding
>>> libR.dylib, or that R was installed 64-bit only, and the INSTALL_opts=
>>> argument to install.packages() was not set correctly? I assume that the 
>>> CRAN
>>> extras OSX rgdal binary is built against a standard R OSX Intel install,
>>> which is multi-architecture.
>>> 
>>> For a fully updated rgdal, the best combination remains installing the 
>>> full
>>> GDAL framework from Kyngchaos, the full tools collection:
>>> 
>>> http://r.research.att.com/tools/
>>> http://cran.r-project.org/bin/macosx/tools
>>> 
>>> and install from CRAN source. For a lab, the instructor would rather build 
>>> a
>>> local OSX rgdal binary package using the tools collection on one 
>>> development
>>> machine with all the correct path variables set (R CMD check rgdal; R CMD
>>> INSTALL --build rgdal), paying attention to multi-architectures, and
>>> distribute to lab machines from there. This means that the lab instructor
>>> can keep rgdal updated if need be, as both Kyngchaos and CRAN extras rgdal
>>> OSX binary packages typically lag CRAN source.
>>> 
>>> Please also note that there are very many very old GDAL binaries out there
>>> that users pick up and apply, missing all the subsequent bug-fixes and
>>> improvements - GDAL 1.8.0 release candidate 1 is now out, so we are 
>>> looking
>>> at an upgrade to 1.8.0 during January, which Kyngchaos will most likely 
>>> pick
>>> up quickly, probably with a current rgdal binary.
>>> 
>>> Roger
>>> 
>>> 
>>>> (my confusion was a consequence of mixing both installations in the
>>>> same session):
>>>> 
>>>>> setRepositories(ind=1:2)
>>>>> install.packages("rgdal")
>>>> 
>>>> --- Please select a CRAN mirror for use in this session ---
>>>> probando la URL
>>>> 
>>>> 'http://www.stats.ox.ac.uk/pub/RWin/bin/macosx/leopard/contrib/2.12/rgdal_0.6-31.tgz'
>>>> Content type 'application/x-gzip' length 10203689 bytes (9.7 Mb)
>>>> URL abierta
>>>> ==================================================
>>>> downloaded 9.7 Mb
>>>> 
>>>> 
>>>> The downloaded packages are in
>>>> 
>>>> ?/var/folders/iR/iRxOvaG9F10viNoa7WceNU+++TI/-Tmp-//RtmpqIhqn9/downloaded_packages
>>>>> 
>>>>> require(rgdal)
>>>> 
>>>> Loading required package: rgdal
>>>> Loading required package: sp
>>>> Error in dyn.load(file, DLLpath = DLLpath, ...) :
>>>> ?unable to load shared object
>>>> 
>>>> '/Library/Frameworks/R.framework/Versions/2.12/Resources/library/rgdal/libs/i386/rgdal.so':
>>>> 
>>>> ?dlopen(/Library/Frameworks/R.framework/Versions/2.12/Resources/library/rgdal/libs/i386/rgdal.so,
>>>> 6): Library not loaded: libR.dylib
>>>> ?Referenced from:
>>>> 
>>>> /Library/Frameworks/R.framework/Versions/2.12/Resources/library/rgdal/libs/i386/rgdal.so
>>>> ?Reason: image not found
>>>>> 
>>>>> sessionInfo()
>>>> 
>>>> R version 2.12.1 (2010-12-16)
>>>> Platform: i386-apple-darwin9.8.0/i386 (32-bit)
>>>> 
>>>> locale:
>>>> [1] es_ES.UTF-8/es_ES.UTF-8/C/C/es_ES.UTF-8/es_ES.UTF-8
>>>> 
>>>> attached base packages:
>>>> [1] stats ? ? graphics ?grDevices utils ? ? datasets ?methods ? base
>>>> 
>>>> other attached packages:
>>>> [1] sp_0.9-76
>>>> 
>>>> loaded via a namespace (and not attached):
>>>> [1] grid_2.12.1 ? ? lattice_0.19-13 tools_2.12.1
>>>> 
>>>> Note that rgdal.so is where it should be:
>>>> 
>>>> imac-de-agustin-lobo:~ agustinlobo$ ls -l
>>>> 
>>>> /Library/Frameworks/R.framework/Versions/2.12/Resources/library/rgdal/libs/i386/
>>>> total 15088
>>>> -rwxr-xr-x ?1 agustinlobo ?admin ?7722168 ?4 dic 15:57 rgdal.so
>>>> 
>>>> This error is not solved by setting the GDAL path.
>>>> 
>>>> Agus
>>>> 
>>> 
>>> --
>>> Roger Bivand
>>> Economic Geography Section, Department of Economics, Norwegian School of
>>> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>>> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>>> e-mail: Roger.Bivand at nhh.no
>>> 
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> 
>> 
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From Tom.Richardson at bristol.ac.uk  Sat Jan  8 19:35:32 2011
From: Tom.Richardson at bristol.ac.uk (T.O. Richardson)
Date: Sat, 08 Jan 2011 18:35:32 +0000
Subject: [R-sig-Geo] manipulate SpatialPolygons object
Message-ID: <A319DFB073797A9DDCCE484D@bio-nfvideo3.bio.bris.ac.uk>

Hi list,

I have a SpatialPolygons object, 'HR_polygons' which may be composed of 
several disjoint polygons. Thus
length(HR_polygons[[1]]@polygons) is often > 1.
I sum the area across all the disjoint polygons to get the total area; 
'blob_area'.

How should I accomplish the following?:
- Enlarge or shrink the HR_polygons object (scaling all of the disjoint 
areas by an identical factor) such that it's blob_area reaches a new value- 
either larger (magnify) or smaller (shrink) than the original.

In this way the shape of HR_polygons is preserved, but the coordinates 
defining its edges will change completely. If the original HR_polygons 
contains > 1 disjoint areas , a magnification could conceivably cause the 
disjoint areas to overlap- that is fine.


Thanks
Tom






-----------------------------------------------
Dept. of Maths and Stats, UWE and Ant Lab, Bristol

Room B79.
SoBS, Woodland Rd. BS8 1UG.
+44 (0)117 928 8443


From Roger.Bivand at nhh.no  Sat Jan  8 20:04:01 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 8 Jan 2011 20:04:01 +0100 (CET)
Subject: [R-sig-Geo] manipulate SpatialPolygons object
In-Reply-To: <A319DFB073797A9DDCCE484D@bio-nfvideo3.bio.bris.ac.uk>
References: <A319DFB073797A9DDCCE484D@bio-nfvideo3.bio.bris.ac.uk>
Message-ID: <alpine.LRH.2.00.1101081957130.12688@reclus.nhh.no>

On Sat, 8 Jan 2011, T.O. Richardson wrote:

> Hi list,
>
> I have a SpatialPolygons object, 'HR_polygons' which may be composed of 
> several disjoint polygons. Thus
> length(HR_polygons[[1]]@polygons) is often > 1.
> I sum the area across all the disjoint polygons to get the total area; 
> 'blob_area'.
>
> How should I accomplish the following?:
> - Enlarge or shrink the HR_polygons object (scaling all of the disjoint areas 
> by an identical factor) such that it's blob_area reaches a new value- either 
> larger (magnify) or smaller (shrink) than the original.
>
> In this way the shape of HR_polygons is preserved, but the coordinates 
> defining its edges will change completely. If the original HR_polygons 
> contains > 1 disjoint areas , a magnification could conceivably cause the 
> disjoint areas to overlap- that is fine.

Although it isn't clear what you want to do - geographers wouldn't do it 
because Bristol might end up in Bath - you could look at the elide() 
methods in maptools - ?elide, and see whether you can subset your input 
geometries into groups subject to the same transformations. The methods 
are mostly used for disguising locations for epidemiological applications.

Hope this helps,

Roger

>
>
> Thanks
> Tom
>
>
>
>
>
>
> -----------------------------------------------
> Dept. of Maths and Stats, UWE and Ant Lab, Bristol
>
> Room B79.
> SoBS, Woodland Rd. BS8 1UG.
> +44 (0)117 928 8443
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From tom.richardson at bristol.ac.uk  Sat Jan  8 22:19:42 2011
From: tom.richardson at bristol.ac.uk (Tom_R)
Date: Sat, 8 Jan 2011 13:19:42 -0800 (PST)
Subject: [R-sig-Geo] manipulate SpatialPolygons object
In-Reply-To: <alpine.LRH.2.00.1101081957130.12688@reclus.nhh.no>
References: <A319DFB073797A9DDCCE484D@bio-nfvideo3.bio.bris.ac.uk>
	<alpine.LRH.2.00.1101081957130.12688@reclus.nhh.no>
Message-ID: <1294521582349-5903163.post@n2.nabble.com>


Hi Roger, 
Thanks very much for replying! Your input is very much appreciated.

Perhaps I better first give more detail about what I'm trying to do. I have
the trajectories for several animals, for which I have calculated their home
ranges (using kernelUD), and the degree of overlap between the HR's of
different animals. Now I want to conduct a randomisation by reallocating the
observed areas amongst the observed HR's. I want to keep the HR shape &
centroids, whilst either enlarging or shrinking the HR. Then I would
recalculate the overlap for the randomised HR's & compare to the observed
overlap. 

Anyway, long story short, there doesn't seem to be a function that will, 
shrink/enlarge a shape with an area x to area, y, whilst keepin it fixed to
the same centroid.

I though of using a (really embarrassing) brute-force trial & error method
using 'shrinkXY' - see below. This is very dodgy- so far it only
approximates the 'new-area' and doesn't stop when it's near- just flip-flops
around it. Also shrinkXY shifts the object so it does not stay fixed to the
same centriod, which is problematic, but solvable. 


	old_HR_area <- 500
	new_HR_area <- 1000		
	
	temp_area <-0 
	while (temp_area < old_HR_area)			## if we're SHRINKING
		{
		shapefile_HR <- 	scaleXY(shapefile_HR, 1.01)	## shrink shapefile_HR
		blobby <- shape2poly(shapefile_HR, region.id=NULL)
		plot(blobby, add=TRUE)
		for (h in 1:length(blobby))
			{
			if (h == 1) {temp_area <- areapl(blobby[[h]]) } 
			if (h > 1)  {temp_area <- blob_area + areapl(blobby[[h]]) }
			}
		print("shrinking")
		print(temp_area)
		
		while (temp_area < new_HR_area )			## if we're GROWING 
			{
			shapefile_HR <- 	scaleXY(shapefile_HR, .99)	## grows shapefile_HR
			blobby <- shape2poly(shapefile_HR, region.id=NULL)
			plot(blobby, add=TRUE)
			for (h in 1:length(blobby))
				{
				if (h == 1) {temp_area <- areapl(blobby[[h]]) } 
				if (h > 1)  {temp_area <- blob_area + areapl(blobby[[h]]) }
				}
			print("growing")
			print(temp_area)
			}

		}


I already posted a query on this earlier this month- but it didn't attract
any feedback; FYI:
http://r-sig-geo.2731867.n2.nabble.com/changing-the-area-of-a-shapefile-to-a-new-value-td5879842.html

that's all folks!
Tom

-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/manipulate-SpatialPolygons-object-tp5902903p5903163.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From HodgessE at uhd.edu  Sun Jan  9 23:23:59 2011
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Sun, 9 Jan 2011 16:23:59 -0600
Subject: [R-sig-Geo] newbie question about R and GRASS
Message-ID: <586A4828D7AAA04CA9B258C50A28DA206DB2D2@BALI.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110109/5337a121/attachment.pl>

From Roger.Bivand at nhh.no  Mon Jan 10 10:18:37 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 10 Jan 2011 10:18:37 +0100 (CET)
Subject: [R-sig-Geo] newbie question about R and GRASS
In-Reply-To: <586A4828D7AAA04CA9B258C50A28DA206DB2D2@BALI.uhd.campus>
References: <586A4828D7AAA04CA9B258C50A28DA206DB2D2@BALI.uhd.campus>
Message-ID: <alpine.LRH.2.00.1101101007040.21009@reclus.nhh.no>

On Sun, 9 Jan 2011, Hodgess, Erin wrote:

> Dear R SIG Geo People:
>
> I'm trying to replicate the material on page 100 in Prof. Bivand ASDAR 
> book.  However, I am getting the following error message:
>
>
>> gmeta6()
> Error in if (file.exists(file) == FALSE) if (!missing(asText) && asText ==  :
>  argument is of length zero
> In addition: Warning message:
> running command 'g.region.exe --interface-description' had status 309
> Error in parseGRASS(cmd) : g.region not parsed
>>

No, this is not expected (checked with R 2.12.1 on Native GRASS 6.4.0 on 
Windows XP). You needed to provide full traceback() output, and 
sessionInfo(), and which Windows; verbatim output from loading spgrass6 
would also have been informative. Your problem is in your GRASS 
installation, as the message:

running command 'g.region.exe --interface-description' had status 309

shows.

Start GRASS 6.4.0 in MSYS mode, and try to run

g.region.exe --interface-description

from the console prompt. MSYS mode is helpful, because running R through 
the Layer Manager blocks the manager until R is terminated. Starting R in 
an existing location on Windows entails:

Starting GRASS in MSYS mode, choosing location and mapset as normal 
(Spearfish as location for the example refered to) - this sets many GRASS 
environment variables that are needed by spgrass6;

Starting R with the complete path, e.g.:

"C:/Program Files/R/R-2.12.1/bin/i386/Rgui.exe
R_LIBS=C:/Program Files/r_libs"

(line break for mailer)

in the MSYS console;

Check that spgrass6 reports the correct location on loading.

Hope this helps,

Roger

>
> This is in R-2.12.1 and GRASS version 6.4 on Windows.  Does this look 
> familiar, please?  Any suggestions would be much appreciated.
>
> Thanks,
> Erin
>
>
> Erin M. Hodgess, PhD
> Associate Professor
> Department of Computer and Mathematical Sciences
> University of Houston - Downtown
> mailto: hodgesse at uhd.edu
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From HodgessE at uhd.edu  Mon Jan 10 18:04:47 2011
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Mon, 10 Jan 2011 11:04:47 -0600
Subject: [R-sig-Geo] newbie question about R and GRASS
References: <586A4828D7AAA04CA9B258C50A28DA206DB2D2@BALI.uhd.campus>
	<alpine.LRH.2.00.1101101007040.21009@reclus.nhh.no>
Message-ID: <586A4828D7AAA04CA9B258C50A28DA206DB2D7@BALI.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110110/0e1e91cb/attachment.pl>

From giuseppe.amatulli at gmail.com  Mon Jan 10 18:48:48 2011
From: giuseppe.amatulli at gmail.com (Giuseppe Amatulli)
Date: Mon, 10 Jan 2011 18:48:48 +0100
Subject: [R-sig-Geo] (no subject)
Message-ID: <AANLkTimshKBdjLx7=F0aw0AXCnwiGWZ0cm3tzhDP-B2q@mail.gmail.com>

Hi,
first of all  happy new year!

I'm trying to do forest species distribution at European level (1 km
resolution) by means of  randomForest running it in a cluster
computer. I'm using several predictors of different data sources. All
of them are rasters in grass format.  Therefore i was using spgrass6
to import the data in to R and apply randomForest prediction to the
layers.

In the same time, reading carefully the help page of the raster
package seems to me that his "row by row" feature allows a better
performance of the memory limitation, compare to spgrass6. It is this
the case?
If raster package is more efficient, how i can use it to import grass
data?  I suppose by reading the raster under the cellhd folder
>  maps  <-  stack ( c ( 'LOCATION/PERMANENT/cellhd/grid1','LOCATION/PERMANENT/cellhd/grid2'))

One more question.
The data for training randomforest are stored in R table. Each
observation represent the  presence/absence ( 0 or 1 ) of a plant
specie. I also have an item of presence/absence reliability which give
to me information concerning the quality of the data. Whit this item i
would like to give a "weight" in randForest in order to give more
importance to the "good" data. Any idea?
As rough  idea i was thinking to replicate the data in accordance to
the quality but it this will increment to much the amount of data. On
the opposite a stratified bootstrapping will result in a data
squeezing and long computation.
In other words i'm searching a weight options as present in lm model. Any idea?

Thank in advance
Regards
Giuseppe Amatulli


From Roger.Bivand at nhh.no  Mon Jan 10 20:25:08 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 10 Jan 2011 20:25:08 +0100 (CET)
Subject: [R-sig-Geo] (no subject)
In-Reply-To: <AANLkTimshKBdjLx7=F0aw0AXCnwiGWZ0cm3tzhDP-B2q@mail.gmail.com>
References: <AANLkTimshKBdjLx7=F0aw0AXCnwiGWZ0cm3tzhDP-B2q@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1101102018120.24874@reclus.nhh.no>

On Mon, 10 Jan 2011, Giuseppe Amatulli wrote:

> Hi,
> first of all  happy new year!
>
> I'm trying to do forest species distribution at European level (1 km
> resolution) by means of  randomForest running it in a cluster
> computer. I'm using several predictors of different data sources. All
> of them are rasters in grass format.  Therefore i was using spgrass6
> to import the data in to R and apply randomForest prediction to the
> layers.
>
> In the same time, reading carefully the help page of the raster
> package seems to me that his "row by row" feature allows a better
> performance of the memory limitation, compare to spgrass6. It is this
> the case?
> If raster package is more efficient, how i can use it to import grass
> data?  I suppose by reading the raster under the cellhd folder
>>  maps  <-  stack ( c ( 'LOCATION/PERMANENT/cellhd/grid1','LOCATION/PERMANENT/cellhd/grid2'))

In principle, the GRASS GDAL plugin should work in this way, but you can 
also use g.region in GRASS to set the region for readRAST6() to read, 
which could be in tiles or rows at your convenience. This might be easier 
if the predicted tiles are to be written back to GRASS as part of the 
process. It would be overkill to think of this kind of iterated region 
support in raster, which uses the region.dim= and offset= features of the 
GDAL interface, I think.

It would be fun to see whether SAGA could be used in the same way with 
raster, as there is a SAGA GDAL driver.

Roger

>
> One more question.
> The data for training randomforest are stored in R table. Each
> observation represent the  presence/absence ( 0 or 1 ) of a plant
> specie. I also have an item of presence/absence reliability which give
> to me information concerning the quality of the data. Whit this item i
> would like to give a "weight" in randForest in order to give more
> importance to the "good" data. Any idea?
> As rough  idea i was thinking to replicate the data in accordance to
> the quality but it this will increment to much the amount of data. On
> the opposite a stratified bootstrapping will result in a data
> squeezing and long computation.
> In other words i'm searching a weight options as present in lm model. Any idea?
>
> Thank in advance
> Regards
> Giuseppe Amatulli
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Mon Jan 10 20:59:32 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 10 Jan 2011 20:59:32 +0100 (CET)
Subject: [R-sig-Geo] Installation of rgdal from CRAN on MACOSX does not
 work
In-Reply-To: <alpine.LRH.2.00.1101081830230.12554@reclus.nhh.no>
References: <AANLkTikBcJ1DM=D=0_sB7kHjiYVjhv9+1gnLnj3MzZTJ@mail.gmail.com>
	<alpine.LRH.2.00.1012291519480.771@reclus.nhh.no>
	<AANLkTi=utB+O8PPVmYtE8yuhMt+yRReiK6rUHpnCj9v3@mail.gmail.com>
	<alpine.LRH.2.00.1012301555250.4426@reclus.nhh.no>
	<alpine.LRH.2.00.1101081830230.12554@reclus.nhh.no>
Message-ID: <alpine.LRH.2.00.1101102056230.24874@reclus.nhh.no>

On Sat, 8 Jan 2011, Roger Bivand wrote:

> On Thu, 30 Dec 2010, Roger Bivand wrote:
>
>> On Wed, 29 Dec 2010, Agustin Lobo wrote:
>> 
>>> Roger,
>>> 
>>> But
>>> http://www.kyngchaos.com/files/software/frameworks/rgdal-0.6.29-1.zip
>>> installs with no problems on the same machine and on the same R, would 
>>> that not
>>> discard the possibility of an
>>>> issue of your R installation,
>>>> possibly a multi-architecture issue
>>> 
>>> as you suggest?
>>> 
>>> Please note I'm not personally in a hurry any more as we can work with
>>> the rgdal from kyngchaos.
>> 
>> I will have access to an OSX laptop in a little over a week, and will try 
>> out the CRAN rgdal binaries. Just one report of installation failure isn't 
>> enough. I think that maybe someone on R-sig-mac might know why rgdal.so is 
>> looking for libR.dylib; I don't use OSX, and don't have easy access to such 
>> a machine, which is why I asked for others to comment.
>
> On a Leopard 10.5.8, I see the problem reported by Agus for the CRAN-extra 
> OSX binary rgdal package and freshly installed R 2.12.1 (libR.dylib image not 
> found) in the 32-bit R-GUI, but no problem when running R from the command 
> line. A different problem (mach-o, but wrong architecture) occurs in 64-bit 
> systems, both run from the command line and from R-GUI. Could anyone who 
> wants to follow this up please post to R-sig-Mac, which is the correct list 
> for OSX issues?
>
> Conclusion: on Leopard, the CRAN extras rgdal binary can be used in the 
> 32-bit R application run from the command line, but not otherwise. R 2.12.1 
> installs the 64-bit GUI into the OSX applications toolbar - one needs to open 
> a terminal and type "R", checking that the length of a pointer is 4, to run 
> the version that works.

Prof. Ripley has updated the OSX CRAN extras rgdal binaries to rgdal 
0.6.33, and this new version is confirmed to work under Leopard both 32 
and 64 bit, both GUI and terminal. So the simplest way to install rgdal 
for OSX for the basic set of GDAL and OGR drivers is once again:

setRepositories(ind=1:2)
install.packages("rgdal")

Roger

>
> Roger
>
> PS. The symptoms are:
>
> R64, R-GUI 64
>
>> library(rgdal)
> Loading required package: sp
> Error in dyn.load(file, DLLpath = DLLpath, ...) :
>  unable to load shared object 
> '/Library/Frameworks/R.framework/Versions/2.12/Resources/library/rgdal/libs/x86_64/rgdal.so':
>
> dlopen(/Library/Frameworks/R.framework/Versions/2.12/Resources/library/rgdal/libs/x86_64/rgdal.so, 
> 6): no suitable image found.  Did find:
>
> /Library/Frameworks/R.framework/Versions/2.12/Resources/library/rgdal/libs/x86_64/rgdal.so: 
> mach-o, but wrong architecture
> Error: package/namespace load failed for 'rgdal'
>
>
>
> R-GUI 32
>
>> library(rgdal)
> Loading required package: sp
> Error in dyn.load(file, DLLpath = DLLpath, ...) :
>  unable to load shared object 
> '/Library/Frameworks/R.framework/Versions/2.12/Resources/library/rgdal/libs/i386/rgdal.so':
>
> dlopen(/Library/Frameworks/R.framework/Versions/2.12/Resources/library/rgdal/libs/i386/rgdal.so, 
> 6): Library not loaded: libR.dylib
>  Referenced from: 
> /Library/Frameworks/R.framework/Versions/2.12/Resources/library/rgdal/libs/i386/rgdal.so
>  Reason: image not found
> Error: package/namespace load failed for 'rgdal'
>
>
>> 
>> Roger
>> 
>>> I just want to report the error to help
>>> having an rgdal installation for MACOSX as
>>> simple as for Windows.
>>> I understand installing from source will always be a bit more
>>> difficult on MACOSX than on linux as there are some basic tools and
>>> libraries that are missing on regular MAC systems that must be
>>> previously installed, but this is not my concern now as I'm focusing
>>> on installations from binaries.
>>> 
>>> Thanks!
>>> 
>>> Agus
>>> 
>>> 
>>> 
>>> 2010/12/29 Roger Bivand <Roger.Bivand at nhh.no>:
>>>> On Wed, 29 Dec 2010, Agustin Lobo wrote:
>>>> 
>>>>> While the installation from
>>>>> http://www.kyngchaos.com/files/software/frameworks/rgdal-0.6.29-1.zip
>>>>> works fine
>>>>> the installation of rgdal from CRAN on MACOSX does not work, despite
>>>>> my previous message that this issue was solved as well
>>>> 
>>>> Please do read the error message:
>>>> 
>>>>> ?unable to load shared object
>>>>> 
>>>> '/Library/Frameworks/R.framework/Versions/2.12/Resources/library/rgdal/libs/i$
>>>>> 
>>>> dlopen(/Library/Frameworks/R.framework/Versions/2.12/Resources/library/rgdal$
>>>>> 
>>>>> 6): Library not loaded: libR.dylib
>>>>> ?Referenced from:
>>>>> 
>>>> /Library/Frameworks/R.framework/Versions/2.12/Resources/library/rgdal/libs/i3$
>>>>> 
>>>>> ?Reason: image not found
>>>> 
>>>> The image that is not found is libR.dylib, the main R dylib against which
>>>> rgdal.so is linked. So this is still an issue of your R installation,
>>>> possibly a multi-architecture issue (is libR.dylib the i386 version,
>>>> guessing - is libR64.dylib the 64-bit Intel version?).
>>>> 
>>>> Could any OSX users who are using CRAN extra rgdal please help Agus to
>>>> resolve this - it could be that local path modifications are hiding
>>>> libR.dylib, or that R was installed 64-bit only, and the INSTALL_opts=
>>>> argument to install.packages() was not set correctly? I assume that the 
>>>> CRAN
>>>> extras OSX rgdal binary is built against a standard R OSX Intel install,
>>>> which is multi-architecture.
>>>> 
>>>> For a fully updated rgdal, the best combination remains installing the 
>>>> full
>>>> GDAL framework from Kyngchaos, the full tools collection:
>>>> 
>>>> http://r.research.att.com/tools/
>>>> http://cran.r-project.org/bin/macosx/tools
>>>> 
>>>> and install from CRAN source. For a lab, the instructor would rather 
>>>> build a
>>>> local OSX rgdal binary package using the tools collection on one 
>>>> development
>>>> machine with all the correct path variables set (R CMD check rgdal; R CMD
>>>> INSTALL --build rgdal), paying attention to multi-architectures, and
>>>> distribute to lab machines from there. This means that the lab instructor
>>>> can keep rgdal updated if need be, as both Kyngchaos and CRAN extras 
>>>> rgdal
>>>> OSX binary packages typically lag CRAN source.
>>>> 
>>>> Please also note that there are very many very old GDAL binaries out 
>>>> there
>>>> that users pick up and apply, missing all the subsequent bug-fixes and
>>>> improvements - GDAL 1.8.0 release candidate 1 is now out, so we are 
>>>> looking
>>>> at an upgrade to 1.8.0 during January, which Kyngchaos will most likely 
>>>> pick
>>>> up quickly, probably with a current rgdal binary.
>>>> 
>>>> Roger
>>>> 
>>>> 
>>>>> (my confusion was a consequence of mixing both installations in the
>>>>> same session):
>>>>> 
>>>>>> setRepositories(ind=1:2)
>>>>>> install.packages("rgdal")
>>>>> 
>>>>> --- Please select a CRAN mirror for use in this session ---
>>>>> probando la URL
>>>>> 
>>>>> 'http://www.stats.ox.ac.uk/pub/RWin/bin/macosx/leopard/contrib/2.12/rgdal_0.6-31.tgz'
>>>>> Content type 'application/x-gzip' length 10203689 bytes (9.7 Mb)
>>>>> URL abierta
>>>>> ==================================================
>>>>> downloaded 9.7 Mb
>>>>> 
>>>>> 
>>>>> The downloaded packages are in
>>>>> 
>>>>> ?/var/folders/iR/iRxOvaG9F10viNoa7WceNU+++TI/-Tmp-//RtmpqIhqn9/downloaded_packages
>>>>>> 
>>>>>> require(rgdal)
>>>>> 
>>>>> Loading required package: rgdal
>>>>> Loading required package: sp
>>>>> Error in dyn.load(file, DLLpath = DLLpath, ...) :
>>>>> ?unable to load shared object
>>>>> 
>>>>> '/Library/Frameworks/R.framework/Versions/2.12/Resources/library/rgdal/libs/i386/rgdal.so':
>>>>> 
>>>>> ?dlopen(/Library/Frameworks/R.framework/Versions/2.12/Resources/library/rgdal/libs/i386/rgdal.so,
>>>>> 6): Library not loaded: libR.dylib
>>>>> ?Referenced from:
>>>>> 
>>>>> /Library/Frameworks/R.framework/Versions/2.12/Resources/library/rgdal/libs/i386/rgdal.so
>>>>> ?Reason: image not found
>>>>>> 
>>>>>> sessionInfo()
>>>>> 
>>>>> R version 2.12.1 (2010-12-16)
>>>>> Platform: i386-apple-darwin9.8.0/i386 (32-bit)
>>>>> 
>>>>> locale:
>>>>> [1] es_ES.UTF-8/es_ES.UTF-8/C/C/es_ES.UTF-8/es_ES.UTF-8
>>>>> 
>>>>> attached base packages:
>>>>> [1] stats ? ? graphics ?grDevices utils ? ? datasets ?methods ? base
>>>>> 
>>>>> other attached packages:
>>>>> [1] sp_0.9-76
>>>>> 
>>>>> loaded via a namespace (and not attached):
>>>>> [1] grid_2.12.1 ? ? lattice_0.19-13 tools_2.12.1
>>>>> 
>>>>> Note that rgdal.so is where it should be:
>>>>> 
>>>>> imac-de-agustin-lobo:~ agustinlobo$ ls -l
>>>>> 
>>>>> /Library/Frameworks/R.framework/Versions/2.12/Resources/library/rgdal/libs/i386/
>>>>> total 15088
>>>>> -rwxr-xr-x ?1 agustinlobo ?admin ?7722168 ?4 dic 15:57 rgdal.so
>>>>> 
>>>>> This error is not solved by setting the GDAL path.
>>>>> 
>>>>> Agus
>>>>> 
>>>> 
>>>> --
>>>> Roger Bivand
>>>> Economic Geography Section, Department of Economics, Norwegian School of
>>>> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>>>> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>>>> e-mail: Roger.Bivand at nhh.no
>>>> 
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>> 
>>> 
>> 
>> 
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From r.hijmans at gmail.com  Tue Jan 11 06:51:01 2011
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Mon, 10 Jan 2011 21:51:01 -0800 (PST)
Subject: [R-sig-Geo] (no subject)
In-Reply-To: <alpine.LRH.2.00.1101102018120.24874@reclus.nhh.no>
References: <AANLkTimshKBdjLx7=F0aw0AXCnwiGWZ0cm3tzhDP-B2q@mail.gmail.com>
	<alpine.LRH.2.00.1101102018120.24874@reclus.nhh.no>
Message-ID: <1294725061460-5909773.post@n2.nabble.com>


Giuseppe, 

You can also have a look at the 'dismo' package for species distribution
modeling.  The vignette (under development) has a brief example with
randomForest.

To apply weights in randomForest (I have not tried this and could very well
be wrong), you can perhaps use regression rather than classification (in my
experience randomForest regression works much better in this context) and
adjust your presence/absence data based on certainty (highly certain absence
= -1, highly certain presence = 1, everything else scaled in between). 

A perhpas better alternative would be to use the cforest function (another
random forest implementation) in 'party', because this function has a
weights argument.

Robert

-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/no-subject-tp5907876p5909773.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From r.m.krug at gmail.com  Tue Jan 11 08:37:25 2011
From: r.m.krug at gmail.com (Rainer M Krug)
Date: Tue, 11 Jan 2011 08:37:25 +0100
Subject: [R-sig-Geo] (no subject)
In-Reply-To: <AANLkTimshKBdjLx7=F0aw0AXCnwiGWZ0cm3tzhDP-B2q@mail.gmail.com>
References: <AANLkTimshKBdjLx7=F0aw0AXCnwiGWZ0cm3tzhDP-B2q@mail.gmail.com>
Message-ID: <4D2C08B5.7020107@gmail.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On 01/10/2011 06:48 PM, Giuseppe Amatulli wrote:
> Hi,
> first of all  happy new year!
> 
> I'm trying to do forest species distribution at European level (1 km
> resolution) by means of  randomForest running it in a cluster
> computer. I'm using several predictors of different data sources. All
> of them are rasters in grass format.  Therefore i was using spgrass6
> to import the data in to R and apply randomForest prediction to the
> layers.
> 
> In the same time, reading carefully the help page of the raster
> package seems to me that his "row by row" feature allows a better
> performance of the memory limitation, compare to spgrass6. It is this
> the case?
> If raster package is more efficient, how i can use it to import grass
> data?  I suppose by reading the raster under the cellhd folder
>>  maps  <-  stack ( c ( 'LOCATION/PERMANENT/cellhd/grid1','LOCATION/PERMANENT/cellhd/grid2'))

Another option would be to copy the data into a database, and then use
sql queries to select locations to analyse. In this way, you could have
more control over the number of cells to analyse. This obviously only
works, if you don't need neighbourhood information.

Cheers,

Rainer


> 
> One more question.
> The data for training randomforest are stored in R table. Each
> observation represent the  presence/absence ( 0 or 1 ) of a plant
> specie. I also have an item of presence/absence reliability which give
> to me information concerning the quality of the data. Whit this item i
> would like to give a "weight" in randForest in order to give more
> importance to the "good" data. Any idea?
> As rough  idea i was thinking to replicate the data in accordance to
> the quality but it this will increment to much the amount of data. On
> the opposite a stratified bootstrapping will result in a data
> squeezing and long computation.
> In other words i'm searching a weight options as present in lm model. Any idea?
> 
> Thank in advance
> Regards
> Giuseppe Amatulli
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


- -- 
Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation
Biology, UCT), Dipl. Phys. (Germany)

Centre of Excellence for Invasion Biology
Natural Sciences Building
Office Suite 2039
Stellenbosch University
Main Campus, Merriman Avenue
Stellenbosch
South Africa

Tel:        +33 - (0)9 53 10 27 44
Cell:       +27 - (0)8 39 47 90 42
Fax (SA):   +27 - (0)8 65 16 27 82
Fax (D) :   +49 - (0)3 21 21 25 22 44
Fax (FR):   +33 - (0)9 58 10 27 44
email:      Rainer at krugs.de

Skype:      RMkrug
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/

iEYEARECAAYFAk0sCLUACgkQoYgNqgF2egqO8ACfWW+xW5pjMWAyFNwBWMpZrzDa
Z+AAn1i5yQcHuBjY68g7xheCpJkYhL3z
=vfdo
-----END PGP SIGNATURE-----


From f.veronesi at cranfield.ac.uk  Tue Jan 11 12:14:13 2011
From: f.veronesi at cranfield.ac.uk (Veronesi, Fabio)
Date: Tue, 11 Jan 2011 11:14:13 +0000
Subject: [R-sig-Geo] predict.gstat and LDL factor error
Message-ID: <6E3C09D338C1BB46AD3778BB99012D6005ECA1FF97@CCEXCHSTORE-2.central.cranfield.ac.uk>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110111/ef56ced0/attachment.pl>

From edzer.pebesma at uni-muenster.de  Tue Jan 11 12:33:21 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 11 Jan 2011 12:33:21 +0100
Subject: [R-sig-Geo] predict.gstat and LDL factor error
In-Reply-To: <6E3C09D338C1BB46AD3778BB99012D6005ECA1FF97@CCEXCHSTORE-2.central.cranfield.ac.uk>
References: <6E3C09D338C1BB46AD3778BB99012D6005ECA1FF97@CCEXCHSTORE-2.central.cranfield.ac.uk>
Message-ID: <4D2C4001.2080901@uni-muenster.de>

The memory will not be the problem, that would give a different error
message. Also, zero distance between observation and prediction
locations should not be a problem.

The distance in metres is not sufficient information, as the singularity
problem is in the covariance matrix or in the design matrix. Do you have
observations with identical locations? How large is the area? Which
variogram model did you specify? Did you specify a trend?

On 01/11/2011 12:14 PM, Veronesi, Fabio wrote:
> Dear All,
> I'm trying some simulation with my data.
> I set the gstat object and the newdata (in a data frame format) but when I start the simulation with the function predict.gstat it return the LDL error.
> Now, I check the distance between observation and prediction location with the function zerodist and the minimum is 10 metres, so it should not be the problem. My data are 30 observation and I'm trying to simulate in 94 location, therefore with a 32bit machine and 4Gb of available RAM also the memory should not be a problem.
> What could it be then?
> Many thanks for any help,
> Fabio
> 
> 
> Mr. Fabio Veronesi
> Ph.D. student
> Cranfield University
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From Gema.FAviles at uclm.es  Tue Jan 11 20:51:45 2011
From: Gema.FAviles at uclm.es (GEMA FERNANDEZ-AVILES CALDERON)
Date: Tue, 11 Jan 2011 20:51:45 +0100
Subject: [R-sig-Geo] SHAPEFILES + DATABASES
Message-ID: <BFE1525242E7DA4B9CBBDE2CF4DDBBFB9E1B3B@EVSAB01.uclm.es>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110111/78f21fc9/attachment.pl>

From pierre.roudier at gmail.com  Tue Jan 11 23:34:32 2011
From: pierre.roudier at gmail.com (Pierre Roudier)
Date: Wed, 12 Jan 2011 11:34:32 +1300
Subject: [R-sig-Geo] SHAPEFILES + DATABASES
In-Reply-To: <BFE1525242E7DA4B9CBBDE2CF4DDBBFB9E1B3B@EVSAB01.uclm.es>
References: <BFE1525242E7DA4B9CBBDE2CF4DDBBFB9E1B3B@EVSAB01.uclm.es>
Message-ID: <AANLkTi=POhpGtg1Ras4NkWP1_rwD+OUNn3j+O+AdA8gs@mail.gmail.com>

Hi Gema,

I understand you have a polygon layer, stored as a shapefile. That
layer would store the districts within a given city. On the other
hand, you have informations about those districts.

If what you want is to merge those informations into your polygon
(spatial) layer, here's an example:

library(rgdal)

# I'm taking a polygon layer from the rgdal package to produce a
reproducible example
dsn <- system.file("vectors", package = "rgdal")[1]
sc <- readOGR(dsn=dsn, layer="scot_BNG")

# The data about your polygons is store in the "data" slot of the sc object:
summary(sc at data)

# Create some dummy properties you want to include. It may come from a CSV file.
# this include a key (id) to relate that data frame with the polygons.
dummy <- data.frame(id=rownames(sc at data),
property1=sample(letters[1:5],size=nrow(sc),replace=T),
property2=rnorm(nrow(sc)))
head(dummy)

# here I chose rownames(sc at data) as the key. You need to add the same
id column that to your sc at data
sc at data$id <- rownames(sc at data)

# Merge the informations into your sc at data data frame:
sc at data <- merge(sc at data, dummy, by="id")

# You're done:
summary(sc)
spplot(sc, "property1")
spplot(sc, "property2")

In that example, I took the long way, there's probably some shortcuts
possible, but I thought that'd be easier to understand.

HTH,

Pierre

2011/1/12 GEMA FERNANDEZ-AVILES CALDERON <Gema.FAviles at uclm.es>:
>
> Dear all,
>
> first Happy 2011!
>
>
> I have two diferent files:
> - on the one hand a shapefile ( *.dbf, *,shp, *.shx) for a city and,
> -on the other hand different variables (*.csv or *.txt) for each district.
> I would like to joint the district with its variables for study its characteristics but I can't found how to merge the files.
>
> Could you help me?
>
> Thanks in advance,
> Gema
>
>
>
>
>
>
> Gema Fern?ndez-Avil?s
>
> Department of Statistics
> Faculty of Law and Social Sciences
> University of Castilla-La Mancha at Toledo
>
> http://www.uclm.es/profesorado/gemafaviles/t <http://www.uclm.es/profesorado/gemafaviles/t>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>



-- 
Scientist
Landcare Research, New Zealand


From aren at arencambre.com  Wed Jan 12 04:19:50 2011
From: aren at arencambre.com (Aren Cambre)
Date: Tue, 11 Jan 2011 21:19:50 -0600
Subject: [R-sig-Geo] Spatio-temporal data question
Message-ID: <AANLkTinL6QN0uLexWcZaFvfyqkL9-ir9oP1Om-ytHhSZ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110111/641361db/attachment.pl>

From ldecola at comcast.net  Wed Jan 12 04:56:30 2011
From: ldecola at comcast.net (ldecola at comcast.net)
Date: Wed, 12 Jan 2011 03:56:30 +0000 (UTC)
Subject: [R-sig-Geo] tutorial for sp?
Message-ID: <2085070540.1139672.1294804590688.JavaMail.root@sz0030a.westchester.pa.mail.comcast.net>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110112/dc58e0b1/attachment.pl>

From meg.krawchuk at gmail.com  Wed Jan 12 07:47:30 2011
From: meg.krawchuk at gmail.com (Meg Krawchuk)
Date: Tue, 11 Jan 2011 22:47:30 -0800
Subject: [R-sig-Geo] help with dismo biovars when using rasterStacks
Message-ID: <AANLkTikiueVCpfArRKd-Oy=vpcn9neWiZYeGZLtOof9Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110111/e3bca17d/attachment.pl>

From edzer.pebesma at uni-muenster.de  Wed Jan 12 07:55:33 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 12 Jan 2011 07:55:33 +0100
Subject: [R-sig-Geo] tutorial for sp?
In-Reply-To: <2085070540.1139672.1294804590688.JavaMail.root@sz0030a.westchester.pa.mail.comcast.net>
References: <2085070540.1139672.1294804590688.JavaMail.root@sz0030a.westchester.pa.mail.comcast.net>
Message-ID: <4D2D5065.3090403@uni-muenster.de>

sp has a vignette, obtained by

> library(sp)
> vignette("sp")

More extensive information might be found in the asdar book, see
http://www.asdar-book.org

On 01/12/2011 04:56 AM, ldecola at comcast.net wrote:
> i'm teaching a course on geospatial data structures that will in part be using the sp package. 
> 
> does anyone know of a tutorial that introduces the fundamentals? 
> 
> Lee De Cola, PhD, MCP. 
> DATA to Insight 
> LDECOLA at COMCAST.NET 
> Reston, Virginia 
> 571 315 0577 mobile 
> 703 709 6972 home & fax 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From alobolistas at gmail.com  Wed Jan 12 11:05:14 2011
From: alobolistas at gmail.com (Agustin Lobo)
Date: Wed, 12 Jan 2011 11:05:14 +0100
Subject: [R-sig-Geo] Installation of rgdal from CRAN on MACOSX does not
	work
In-Reply-To: <alpine.LRH.2.00.1101102056230.24874@reclus.nhh.no>
References: <AANLkTikBcJ1DM=D=0_sB7kHjiYVjhv9+1gnLnj3MzZTJ@mail.gmail.com>
	<alpine.LRH.2.00.1012291519480.771@reclus.nhh.no>
	<AANLkTi=utB+O8PPVmYtE8yuhMt+yRReiK6rUHpnCj9v3@mail.gmail.com>
	<alpine.LRH.2.00.1012301555250.4426@reclus.nhh.no>
	<alpine.LRH.2.00.1101081830230.12554@reclus.nhh.no>
	<alpine.LRH.2.00.1101102056230.24874@reclus.nhh.no>
Message-ID: <AANLkTimncvgxPgD2yDJoV+5DcAvmd5GzBUw8bqxgx2br@mail.gmail.com>

Thanks,

it has worked with no problems on 4 Macs, both Snow Leopard and Leopard.

Agus


2011/1/10 Roger Bivand <Roger.Bivand at nhh.no>:
> On Sat, 8 Jan 2011, Roger Bivand wrote:
>
>> On Thu, 30 Dec 2010, Roger Bivand wrote:
>>
>>> On Wed, 29 Dec 2010, Agustin Lobo wrote:
>>>
>>>> Roger,
>>>>
>>>> But
>>>> http://www.kyngchaos.com/files/software/frameworks/rgdal-0.6.29-1.zip
>>>> installs with no problems on the same machine and on the same R, would
>>>> that not
>>>> discard the possibility of an
>>>>>
>>>>> issue of your R installation,
>>>>> possibly a multi-architecture issue
>>>>
>>>> as you suggest?
>>>>
>>>> Please note I'm not personally in a hurry any more as we can work with
>>>> the rgdal from kyngchaos.
>>>
>>> I will have access to an OSX laptop in a little over a week, and will try
>>> out the CRAN rgdal binaries. Just one report of installation failure isn't
>>> enough. I think that maybe someone on R-sig-mac might know why rgdal.so is
>>> looking for libR.dylib; I don't use OSX, and don't have easy access to such
>>> a machine, which is why I asked for others to comment.
>>
>> On a Leopard 10.5.8, I see the problem reported by Agus for the CRAN-extra
>> OSX binary rgdal package and freshly installed R 2.12.1 (libR.dylib image
>> not found) in the 32-bit R-GUI, but no problem when running R from the
>> command line. A different problem (mach-o, but wrong architecture) occurs in
>> 64-bit systems, both run from the command line and from R-GUI. Could anyone
>> who wants to follow this up please post to R-sig-Mac, which is the correct
>> list for OSX issues?
>>
>> Conclusion: on Leopard, the CRAN extras rgdal binary can be used in the
>> 32-bit R application run from the command line, but not otherwise. R 2.12.1
>> installs the 64-bit GUI into the OSX applications toolbar - one needs to
>> open a terminal and type "R", checking that the length of a pointer is 4, to
>> run the version that works.
>
> Prof. Ripley has updated the OSX CRAN extras rgdal binaries to rgdal 0.6.33,
> and this new version is confirmed to work under Leopard both 32 and 64 bit,
> both GUI and terminal. So the simplest way to install rgdal for OSX for the
> basic set of GDAL and OGR drivers is once again:
>
> setRepositories(ind=1:2)
> install.packages("rgdal")
>
> Roger
>
>>
>> Roger
>>
>> PS. The symptoms are:
>>
>> R64, R-GUI 64
>>
>>> library(rgdal)
>>
>> Loading required package: sp
>> Error in dyn.load(file, DLLpath = DLLpath, ...) :
>> ?unable to load shared object
>> '/Library/Frameworks/R.framework/Versions/2.12/Resources/library/rgdal/libs/x86_64/rgdal.so':
>>
>>
>> dlopen(/Library/Frameworks/R.framework/Versions/2.12/Resources/library/rgdal/libs/x86_64/rgdal.so,
>> 6): no suitable image found. ?Did find:
>>
>>
>> /Library/Frameworks/R.framework/Versions/2.12/Resources/library/rgdal/libs/x86_64/rgdal.so:
>> mach-o, but wrong architecture
>> Error: package/namespace load failed for 'rgdal'
>>
>>
>>
>> R-GUI 32
>>
>>> library(rgdal)
>>
>> Loading required package: sp
>> Error in dyn.load(file, DLLpath = DLLpath, ...) :
>> ?unable to load shared object
>> '/Library/Frameworks/R.framework/Versions/2.12/Resources/library/rgdal/libs/i386/rgdal.so':
>>
>>
>> dlopen(/Library/Frameworks/R.framework/Versions/2.12/Resources/library/rgdal/libs/i386/rgdal.so,
>> 6): Library not loaded: libR.dylib
>> ?Referenced from:
>> /Library/Frameworks/R.framework/Versions/2.12/Resources/library/rgdal/libs/i386/rgdal.so
>> ?Reason: image not found
>> Error: package/namespace load failed for 'rgdal'
>>
>>
>>>
>>> Roger
>>>
>>>> I just want to report the error to help
>>>> having an rgdal installation for MACOSX as
>>>> simple as for Windows.
>>>> I understand installing from source will always be a bit more
>>>> difficult on MACOSX than on linux as there are some basic tools and
>>>> libraries that are missing on regular MAC systems that must be
>>>> previously installed, but this is not my concern now as I'm focusing
>>>> on installations from binaries.
>>>>
>>>> Thanks!
>>>>
>>>> Agus
>>>>
>>>>
>>>>
>>>> 2010/12/29 Roger Bivand <Roger.Bivand at nhh.no>:
>>>>>
>>>>> On Wed, 29 Dec 2010, Agustin Lobo wrote:
>>>>>
>>>>>> While the installation from
>>>>>> http://www.kyngchaos.com/files/software/frameworks/rgdal-0.6.29-1.zip
>>>>>> works fine
>>>>>> the installation of rgdal from CRAN on MACOSX does not work, despite
>>>>>> my previous message that this issue was solved as well
>>>>>
>>>>> Please do read the error message:
>>>>>
>>>>>> ?unable to load shared object
>>>>>>
>>>>>
>>>>> '/Library/Frameworks/R.framework/Versions/2.12/Resources/library/rgdal/libs/i$
>>>>>>
>>>>>
>>>>> dlopen(/Library/Frameworks/R.framework/Versions/2.12/Resources/library/rgdal$
>>>>>>
>>>>>> 6): Library not loaded: libR.dylib
>>>>>> ?Referenced from:
>>>>>>
>>>>>
>>>>> /Library/Frameworks/R.framework/Versions/2.12/Resources/library/rgdal/libs/i3$
>>>>>>
>>>>>> ?Reason: image not found
>>>>>
>>>>> The image that is not found is libR.dylib, the main R dylib against
>>>>> which
>>>>> rgdal.so is linked. So this is still an issue of your R installation,
>>>>> possibly a multi-architecture issue (is libR.dylib the i386 version,
>>>>> guessing - is libR64.dylib the 64-bit Intel version?).
>>>>>
>>>>> Could any OSX users who are using CRAN extra rgdal please help Agus to
>>>>> resolve this - it could be that local path modifications are hiding
>>>>> libR.dylib, or that R was installed 64-bit only, and the INSTALL_opts=
>>>>> argument to install.packages() was not set correctly? I assume that the
>>>>> CRAN
>>>>> extras OSX rgdal binary is built against a standard R OSX Intel
>>>>> install,
>>>>> which is multi-architecture.
>>>>>
>>>>> For a fully updated rgdal, the best combination remains installing the
>>>>> full
>>>>> GDAL framework from Kyngchaos, the full tools collection:
>>>>>
>>>>> http://r.research.att.com/tools/
>>>>> http://cran.r-project.org/bin/macosx/tools
>>>>>
>>>>> and install from CRAN source. For a lab, the instructor would rather
>>>>> build a
>>>>> local OSX rgdal binary package using the tools collection on one
>>>>> development
>>>>> machine with all the correct path variables set (R CMD check rgdal; R
>>>>> CMD
>>>>> INSTALL --build rgdal), paying attention to multi-architectures, and
>>>>> distribute to lab machines from there. This means that the lab
>>>>> instructor
>>>>> can keep rgdal updated if need be, as both Kyngchaos and CRAN extras
>>>>> rgdal
>>>>> OSX binary packages typically lag CRAN source.
>>>>>
>>>>> Please also note that there are very many very old GDAL binaries out
>>>>> there
>>>>> that users pick up and apply, missing all the subsequent bug-fixes and
>>>>> improvements - GDAL 1.8.0 release candidate 1 is now out, so we are
>>>>> looking
>>>>> at an upgrade to 1.8.0 during January, which Kyngchaos will most likely
>>>>> pick
>>>>> up quickly, probably with a current rgdal binary.
>>>>>
>>>>> Roger
>>>>>
>>>>>
>>>>>> (my confusion was a consequence of mixing both installations in the
>>>>>> same session):
>>>>>>
>>>>>>> setRepositories(ind=1:2)
>>>>>>> install.packages("rgdal")
>>>>>>
>>>>>> --- Please select a CRAN mirror for use in this session ---
>>>>>> probando la URL
>>>>>>
>>>>>>
>>>>>> 'http://www.stats.ox.ac.uk/pub/RWin/bin/macosx/leopard/contrib/2.12/rgdal_0.6-31.tgz'
>>>>>> Content type 'application/x-gzip' length 10203689 bytes (9.7 Mb)
>>>>>> URL abierta
>>>>>> ==================================================
>>>>>> downloaded 9.7 Mb
>>>>>>
>>>>>>
>>>>>> The downloaded packages are in
>>>>>>
>>>>>>
>>>>>> ?/var/folders/iR/iRxOvaG9F10viNoa7WceNU+++TI/-Tmp-//RtmpqIhqn9/downloaded_packages
>>>>>>>
>>>>>>> require(rgdal)
>>>>>>
>>>>>> Loading required package: rgdal
>>>>>> Loading required package: sp
>>>>>> Error in dyn.load(file, DLLpath = DLLpath, ...) :
>>>>>> ?unable to load shared object
>>>>>>
>>>>>>
>>>>>> '/Library/Frameworks/R.framework/Versions/2.12/Resources/library/rgdal/libs/i386/rgdal.so':
>>>>>>
>>>>>>
>>>>>> ?dlopen(/Library/Frameworks/R.framework/Versions/2.12/Resources/library/rgdal/libs/i386/rgdal.so,
>>>>>> 6): Library not loaded: libR.dylib
>>>>>> ?Referenced from:
>>>>>>
>>>>>>
>>>>>> /Library/Frameworks/R.framework/Versions/2.12/Resources/library/rgdal/libs/i386/rgdal.so
>>>>>> ?Reason: image not found
>>>>>>>
>>>>>>> sessionInfo()
>>>>>>
>>>>>> R version 2.12.1 (2010-12-16)
>>>>>> Platform: i386-apple-darwin9.8.0/i386 (32-bit)
>>>>>>
>>>>>> locale:
>>>>>> [1] es_ES.UTF-8/es_ES.UTF-8/C/C/es_ES.UTF-8/es_ES.UTF-8
>>>>>>
>>>>>> attached base packages:
>>>>>> [1] stats ? ? graphics ?grDevices utils ? ? datasets ?methods ? base
>>>>>>
>>>>>> other attached packages:
>>>>>> [1] sp_0.9-76
>>>>>>
>>>>>> loaded via a namespace (and not attached):
>>>>>> [1] grid_2.12.1 ? ? lattice_0.19-13 tools_2.12.1
>>>>>>
>>>>>> Note that rgdal.so is where it should be:
>>>>>>
>>>>>> imac-de-agustin-lobo:~ agustinlobo$ ls -l
>>>>>>
>>>>>>
>>>>>> /Library/Frameworks/R.framework/Versions/2.12/Resources/library/rgdal/libs/i386/
>>>>>> total 15088
>>>>>> -rwxr-xr-x ?1 agustinlobo ?admin ?7722168 ?4 dic 15:57 rgdal.so
>>>>>>
>>>>>> This error is not solved by setting the GDAL path.
>>>>>>
>>>>>> Agus
>>>>>>
>>>>>
>>>>> --
>>>>> Roger Bivand
>>>>> Economic Geography Section, Department of Economics, Norwegian School
>>>>> of
>>>>> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>>>>> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>>>>> e-mail: Roger.Bivand at nhh.no
>>>>>
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>
>>>>
>>>
>>>
>>
>>
>
> --
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


From f.veronesi at cranfield.ac.uk  Wed Jan 12 12:44:09 2011
From: f.veronesi at cranfield.ac.uk (Veronesi, Fabio)
Date: Wed, 12 Jan 2011 11:44:09 +0000
Subject: [R-sig-Geo] predict.gstat and LDL factor error
Message-ID: <6E3C09D338C1BB46AD3778BB99012D6005ECA91926@CCEXCHSTORE-2.central.cranfield.ac.uk>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110112/3143b6cc/attachment.pl>

From gianni.lavaredo at gmail.com  Wed Jan 12 14:00:17 2011
From: gianni.lavaredo at gmail.com (gianni lavaredo)
Date: Wed, 12 Jan 2011 14:00:17 +0100
Subject: [R-sig-Geo] suggestion to MERGE or UNION 3 shapefiles
Message-ID: <AANLkTikzmVeCRFGN747iUC7-dG4ozKbbVwazaW2H4gVv@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110112/7420a2c9/attachment.pl>

From matevz.pavlic at gi-zrmk.si  Wed Jan 12 15:39:43 2011
From: matevz.pavlic at gi-zrmk.si (=?iso-8859-2?Q?Matev=BE_Pavli=E8?=)
Date: Wed, 12 Jan 2011 15:39:43 +0100
Subject: [R-sig-Geo] variogram error
Message-ID: <AD5CA6183570B54F92AA45CE2619F9B9F9F02F@gi-zrmk.si>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110112/2c9d09e5/attachment.pl>

From pazurrobert at gmail.com  Wed Jan 12 16:44:39 2011
From: pazurrobert at gmail.com (Robert Pazur)
Date: Wed, 12 Jan 2011 16:44:39 +0100
Subject: [R-sig-Geo] datasets - main pan-European transportation corridors
Message-ID: <AANLkTi=EPx_D37G+hGq2XQc2xM8FdmW3WbmN=9HjZCqR@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110112/7b557868/attachment.pl>

From r.hijmans at gmail.com  Wed Jan 12 18:06:16 2011
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Wed, 12 Jan 2011 09:06:16 -0800 (PST)
Subject: [R-sig-Geo] help with dismo biovars when using rasterStacks
In-Reply-To: <AANLkTikiueVCpfArRKd-Oy=vpcn9neWiZYeGZLtOof9Q@mail.gmail.com>
References: <AANLkTikiueVCpfArRKd-Oy=vpcn9neWiZYeGZLtOof9Q@mail.gmail.com>
Message-ID: <1294851976307-5915338.post@n2.nabble.com>


Meg, 

> Hello. 
> I'm trying to work my way through creating the bioclim variables using the 
> biovars function. 
> (...)
> out <- brick(raster(prec)) 
>          out at data@nlayers <- 19 

I think this should have been 

  out at data@nlayers <- as.integer( 19 )

I fixed the function in version 0.5-13, and the below works

library(dismo)
tmin = tmax = prec = brick(nrow=1, ncol=1)
tmin <- setValues(tmin, t(matrix(c(10,12,14,16,18,20,22,21,19,17,15,12))))
tmax <- tmin + 5
prec <- setValues(prec, t(matrix(c(0,2,10,30,80,160,80,20,40,60,20,0))))
b <- biovars(prec, tmin, tmax)
as.matrix(b)


Robert
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/help-with-dismo-biovars-when-using-rasterStacks-tp5913584p5915338.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From karthik.ram at gmail.com  Wed Jan 12 19:35:17 2011
From: karthik.ram at gmail.com (Karthik Ram)
Date: Wed, 12 Jan 2011 10:35:17 -0800
Subject: [R-sig-Geo] Warnings: " Window containing simulated patterns is not
 a subset of data window"
Message-ID: <AANLkTi=pRa4ycAXd5m+gWGs+dZ2p_YYtb26kJdjHwbMM@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110112/4d5723b4/attachment.pl>

From karthik at ucdavis.edu  Wed Jan 12 19:52:56 2011
From: karthik at ucdavis.edu (Karthik Ram)
Date: Wed, 12 Jan 2011 10:52:56 -0800
Subject: [R-sig-Geo] Typo Re. Warnings: " Window containing simulated
 patterns is not a subset of data window"
Message-ID: <AANLkTi=FMQrdkAMvf8wQCPe40OyeQVerfg3ARzdBjmJO@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110112/ff66e994/attachment.pl>

From sturgeon09 at gmail.com  Wed Jan 12 21:25:38 2011
From: sturgeon09 at gmail.com (Samuel Turgeon)
Date: Wed, 12 Jan 2011 15:25:38 -0500
Subject: [R-sig-Geo] backtransform prediction variance in gstat?
Message-ID: <AANLkTinq0RBN=Zjqp3CM8w77+fjwuoYfg0N16NZ8Z9Ya@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110112/41c67d5c/attachment.pl>

From pierre.roudier at gmail.com  Wed Jan 12 22:03:28 2011
From: pierre.roudier at gmail.com (Pierre Roudier)
Date: Thu, 13 Jan 2011 10:03:28 +1300
Subject: [R-sig-Geo] tutorial for sp?
In-Reply-To: <4D2D5065.3090403@uni-muenster.de>
References: <2085070540.1139672.1294804590688.JavaMail.root@sz0030a.westchester.pa.mail.comcast.net>
	<4D2D5065.3090403@uni-muenster.de>
Message-ID: <AANLkTimM8am_MUX9ndsEw-bUXnb5DAPbMmBzuoSe2H7+@mail.gmail.com>

Beside the vignette, the ASDAR book is the one book to get when
learning to handle spatial data in R:
http://www.asdar-book.org/

Pierre

2011/1/12 Edzer Pebesma <edzer.pebesma at uni-muenster.de>:
> sp has a vignette, obtained by
>
>> library(sp)
>> vignette("sp")
>
> More extensive information might be found in the asdar book, see
> http://www.asdar-book.org
>
> On 01/12/2011 04:56 AM, ldecola at comcast.net wrote:
>> i'm teaching a course on geospatial data structures that will in part be using the sp package.
>>
>> does anyone know of a tutorial that introduces the fundamentals?
>>
>> Lee De Cola, PhD, MCP.
>> DATA to Insight
>> LDECOLA at COMCAST.NET
>> Reston, Virginia
>> 571 315 0577 mobile
>> 703 709 6972 home & fax
>>
>>
>> ? ? ? [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> --
> Edzer Pebesma
> Institute for Geoinformatics (ifgi), University of M?nster
> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
> 8333081, Fax: +49 251 8339763 ?http://ifgi.uni-muenster.de
> http://www.52north.org/geostatistics ? ? ?e.pebesma at wwu.de
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Scientist
Landcare Research, New Zealand


From pierre.roudier at gmail.com  Wed Jan 12 22:06:27 2011
From: pierre.roudier at gmail.com (Pierre Roudier)
Date: Thu, 13 Jan 2011 10:06:27 +1300
Subject: [R-sig-Geo] variogram error
In-Reply-To: <AD5CA6183570B54F92AA45CE2619F9B9F9F02F@gi-zrmk.si>
References: <AD5CA6183570B54F92AA45CE2619F9B9F9F02F@gi-zrmk.si>
Message-ID: <AANLkTimtJAZPC1Z-Eoeyndw32g2doq2Fyopq+UEfYJKf@mail.gmail.com>

Matev?,

You gave very, very few informations about your data, and about your
configuration.

However, the error message is clear - obviously there's something
wrong about your DF object.

Could you give us the outputs of:
class(DF)
str(DF)

Is there any NA in your data?

Pierre

2011/1/13 Matev? Pavli? <matevz.pavlic at gi-zrmk.si>:
> Hi all, when I try to create a variogram using gstat I get this error :
>
>
>
>> v<-variogram(C~1, loc=DF)
>
> Error: dimensions do not match: locations 40 and data 18
>
>
>
> Any ideas?
>
>
>
> regards, m
>
>
>
>
>
>
>
>
>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Scientist
Landcare Research, New Zealand


From pierre.roudier at gmail.com  Wed Jan 12 22:09:04 2011
From: pierre.roudier at gmail.com (Pierre Roudier)
Date: Thu, 13 Jan 2011 10:09:04 +1300
Subject: [R-sig-Geo] suggestion to MERGE or UNION 3 shapefiles
In-Reply-To: <AANLkTikzmVeCRFGN747iUC7-dG4ozKbbVwazaW2H4gVv@mail.gmail.com>
References: <AANLkTikzmVeCRFGN747iUC7-dG4ozKbbVwazaW2H4gVv@mail.gmail.com>
Message-ID: <AANLkTikhn7mLsQQie61BTSruDuLeO-DgtGhnX7jt5Boh@mail.gmail.com>

Gianni,

My understanding is that the rgeos package would ease that sort of
things (without any gpclib licensing problems). I'm not sure if it is
stable yet. It is available through r-forge (not sure it's a CRAN
yet).

Otherwise, this sounds very much like a GIS operation: why don't you
do it in a GIS?

My 2 cents,

Pierre

2011/1/13 gianni lavaredo <gianni.lavaredo at gmail.com>:
> Dear Researchers,
>
> I have 3 shapefiles and I wish to find a way to union (or merge) to have
> only one shapefile. Do i need to use spatstat?
>
> thanks Gianni
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Scientist
Landcare Research, New Zealand


From dan.putler at sauder.ubc.ca  Wed Jan 12 23:50:59 2011
From: dan.putler at sauder.ubc.ca (Dan Putler)
Date: Wed, 12 Jan 2011 14:50:59 -0800
Subject: [R-sig-Geo] suggestion to MERGE or UNION 3 shapefiles
In-Reply-To: <7411_1294870741_1294870741_AANLkTikhn7mLsQQie61BTSruDuLeO-DgtGhnX7jt5Boh@mail.gmail.com>
References: <AANLkTikzmVeCRFGN747iUC7-dG4ozKbbVwazaW2H4gVv@mail.gmail.com>
	<7411_1294870741_1294870741_AANLkTikhn7mLsQQie61BTSruDuLeO-DgtGhnX7jt5Boh@mail.gmail.com>
Message-ID: <4D2E3053.10402@sauder.ubc.ca>

All,

Why not just use the ogr2ogr command line tool included with GDAL/OGR to 
combine the shapefiles, and then bring the combined shapefile into R? 
Look at the *Examples* section on the following link to see the syntax 
on how to do it: http://www.gdal.org/ogr/drv_shapefile.html

Dan


On 01/12/2011 01:09 PM, Pierre Roudier wrote:
> Gianni,
>
> My understanding is that the rgeos package would ease that sort of
> things (without any gpclib licensing problems). I'm not sure if it is
> stable yet. It is available through r-forge (not sure it's a CRAN
> yet).
>
> Otherwise, this sounds very much like a GIS operation: why don't you
> do it in a GIS?
>
> My 2 cents,
>
> Pierre
>
> 2011/1/13 gianni lavaredo<gianni.lavaredo at gmail.com>:
>> Dear Researchers,
>>
>> I have 3 shapefiles and I wish to find a way to union (or merge) to have
>> only one shapefile. Do i need to use spatstat?
>>
>> thanks Gianni
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>


From zua3 at cornell.edu  Thu Jan 13 01:49:25 2011
From: zua3 at cornell.edu (Zia Ahmed)
Date: Wed, 12 Jan 2011 19:49:25 -0500
Subject: [R-sig-Geo] suggestion to MERGE or UNION 3 shapefiles
In-Reply-To: <4D2E3053.10402@sauder.ubc.ca>
References: <AANLkTikzmVeCRFGN747iUC7-dG4ozKbbVwazaW2H4gVv@mail.gmail.com>	<7411_1294870741_1294870741_AANLkTikhn7mLsQQie61BTSruDuLeO-DgtGhnX7jt5Boh@mail.gmail.com>
	<4D2E3053.10402@sauder.ubc.ca>
Message-ID: <4D2E4C15.1070902@cornell.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110112/4d2da7a7/attachment.pl>

From gavan.mcgrath at uwa.edu.au  Thu Jan 13 10:17:29 2011
From: gavan.mcgrath at uwa.edu.au (Gavan McGrath)
Date: Thu, 13 Jan 2011 17:17:29 +0800
Subject: [R-sig-Geo] Using distmap from spatstat with latitude and longitude
Message-ID: <F9CC8F918F2B7B458329EC1DF9D15B770B7D98D7@ITS-WIN-063.staffad.uwa.edu.au>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110113/09efb723/attachment.pl>

From andy.a.wilson at gmail.com  Thu Jan 13 11:14:07 2011
From: andy.a.wilson at gmail.com (Andy Wilson)
Date: Thu, 13 Jan 2011 10:14:07 +0000
Subject: [R-sig-Geo] R, TINs & Raster
Message-ID: <4D2ED06F.1070603@googlemail.com>

Hi all,
I'm pretty new to R so was hoping someone could someone point me in the 
right direction to get started. Is it possible to construct a TIN from 
point elevation values and then convert this to a raster?
Many thanks
Andy


From b.rowlingson at lancaster.ac.uk  Thu Jan 13 11:14:42 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Thu, 13 Jan 2011 10:14:42 +0000
Subject: [R-sig-Geo] Using distmap from spatstat with latitude and
	longitude
In-Reply-To: <F9CC8F918F2B7B458329EC1DF9D15B770B7D98D7@ITS-WIN-063.staffad.uwa.edu.au>
References: <F9CC8F918F2B7B458329EC1DF9D15B770B7D98D7@ITS-WIN-063.staffad.uwa.edu.au>
Message-ID: <AANLkTinL=VEkBhEWMRRWMKwbWurjJ1junDWw5TwNkm=b@mail.gmail.com>

On Thu, Jan 13, 2011 at 9:17 AM, Gavan McGrath <gavan.mcgrath at uwa.edu.au> wrote:
> Being new to spatial stats I need help calculating the distance to cyclone paths at continental scales.
> I have a map with pixels at fixed latitude and longitude intervals and cyclone positions as lat and long points.
> Can I use distmap from the spatstat package?

Looks like that will only be happy with euclidean distances. You'll
get an answer in degrees, which will depend on your latitude...

 If you have lat-long data then the distance you probably want is the
great circle distance, for which you can use the 'rdist.earth'
function in the 'fields' package:

-- Description:

     Given two sets of longitude/latitude locations computes the Great
     circle (geographic) distance matrix among all pairings.


 RSiteSearch("great circle") gives some other options for working out
distances on this non-spherical planet on which we live on.

Barry


From phb4 at st-andrews.ac.uk  Thu Jan 13 14:49:26 2011
From: phb4 at st-andrews.ac.uk (Philipp Boersch-Supan)
Date: Thu, 13 Jan 2011 13:49:26 +0000
Subject: [R-sig-Geo] Using distmap from spatstat with latitude and
	longitude
In-Reply-To: <AANLkTinL=VEkBhEWMRRWMKwbWurjJ1junDWw5TwNkm=b@mail.gmail.com>
References: <F9CC8F918F2B7B458329EC1DF9D15B770B7D98D7@ITS-WIN-063.staffad.uwa.edu.au>
	<AANLkTinL=VEkBhEWMRRWMKwbWurjJ1junDWw5TwNkm=b@mail.gmail.com>
Message-ID: <4D2F02E6.4060204@st-andrews.ac.uk>

  Hi Gavan,

spDists/spDistsN1 from the sp package would be another option. It can 
return distances in kilometers based on the WGS84 ellipsoid.

HTH,
Philipp



On 13/01/2011 10:14, Barry Rowlingson wrote:
> On Thu, Jan 13, 2011 at 9:17 AM, Gavan McGrath<gavan.mcgrath at uwa.edu.au>  wrote:
>> Being new to spatial stats I need help calculating the distance to cyclone paths at continental scales.
>> I have a map with pixels at fixed latitude and longitude intervals and cyclone positions as lat and long points.
>> Can I use distmap from the spatstat package?
> Looks like that will only be happy with euclidean distances. You'll
> get an answer in degrees, which will depend on your latitude...
>
>   If you have lat-long data then the distance you probably want is the
> great circle distance, for which you can use the 'rdist.earth'
> function in the 'fields' package:
>
> -- Description:
>
>       Given two sets of longitude/latitude locations computes the Great
>       circle (geographic) distance matrix among all pairings.
>
>
>   RSiteSearch("great circle") gives some other options for working out
> distances on this non-spherical planet on which we live on.
>
> Barry
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Philipp Boersch-Supan, MRes

Pelagic Ecology Research Group
University of St. Andrews

Current Address:
University of Oxford
Department of Zoology
South Parks Road
Oxford
OX1 3PS
United Kingdom


From r.hijmans at gmail.com  Thu Jan 13 18:27:49 2011
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Thu, 13 Jan 2011 09:27:49 -0800 (PST)
Subject: [R-sig-Geo] Using distmap from spatstat with latitude and
	longitude
In-Reply-To: <F9CC8F918F2B7B458329EC1DF9D15B770B7D98D7@ITS-WIN-063.staffad.uwa.edu.au>
References: <F9CC8F918F2B7B458329EC1DF9D15B770B7D98D7@ITS-WIN-063.staffad.uwa.edu.au>
Message-ID: <1294939669649-5919043.post@n2.nabble.com>


> Being new to spatial stats I need help calculating the distance to cyclone
paths at continental scales. 
> I have a map with pixels at fixed latitude and longitude intervals and
> cyclone positions as lat and long
> points. Can I use distmap from the spatstat package? 

For the distance to a _line_ you can use the dist2Line function in the
geosphere package.

Robert
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Using-distmap-from-spatstat-with-latitude-and-longitude-tp5917578p5919043.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From matevz.pavlic at gi-zrmk.si  Thu Jan 13 19:52:04 2011
From: matevz.pavlic at gi-zrmk.si (=?UTF-8?B?TWF0ZXbFviBQYXZsacSN?=)
Date: Thu, 13 Jan 2011 19:52:04 +0100
Subject: [R-sig-Geo] variogram error
In-Reply-To: <AANLkTimtJAZPC1Z-Eoeyndw32g2doq2Fyopq+UEfYJKf@mail.gmail.com>
References: <AD5CA6183570B54F92AA45CE2619F9B9F9F02F@gi-zrmk.si>
	<AANLkTimtJAZPC1Z-Eoeyndw32g2doq2Fyopq+UEfYJKf@mail.gmail.com>
Message-ID: <AD5CA6183570B54F92AA45CE2619F9B9F9F138@gi-zrmk.si>

Hi all, 

thanks, I realize I gave a little info, but Edzar's hints did the trick...
thanks, 

m

-----Original Message-----
From: Pierre Roudier [mailto:pierre.roudier at gmail.com] 
Sent: Wednesday, January 12, 2011 10:06 PM
To: Matev? Pavli?
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] variogram error

Matev?,

You gave very, very few informations about your data, and about your configuration.

However, the error message is clear - obviously there's something wrong about your DF object.

Could you give us the outputs of:
class(DF)
str(DF)

Is there any NA in your data?

Pierre

2011/1/13 Matev? Pavli? <matevz.pavlic at gi-zrmk.si>:
> Hi all, when I try to create a variogram using gstat I get this error :
>
>
>
>> v<-variogram(C~1, loc=DF)
>
> Error: dimensions do not match: locations 40 and data 18
>
>
>
> Any ideas?
>
>
>
> regards, m
>
>
>
>
>
>
>
>
>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



--
Scientist
Landcare Research, New Zealand

From horacio.samaniego at gmail.com  Thu Jan 13 20:10:05 2011
From: horacio.samaniego at gmail.com (Horacio Samaniego)
Date: Thu, 13 Jan 2011 16:10:05 -0300
Subject: [R-sig-Geo] predict gam model....
Message-ID: <AANLkTim0sqMOGUxMoPhRFO0a8sZpKD1ey00+kUWro4cT@mail.gmail.com>

Hi,
I'm having some trouble on a very basic operation it seems.... I am
not successful generating GAM predictions on a grid. I suspect an
issue with NA's but are not sure what it is. I get the following
error:

> preds[["gam1"]]=predict(gam4.1,newdata=clima4.1,type="response")*100
Error in `[[<-.data.frame`(`*tmp*`, i, value = c(NA, NA, 0.259444360380994,  :
  replacement has 88486 rows, data has 996705

Any hint on where the discrepancy between rows come from?....
basically,  don't think that I'm fully understanding the error.

Thanks,

Here's a description of the dataset employed.



1st) I adjusted a gam (from mgcv's library)
mod.gam1 <- gam(formula = resp ~ s(tmin_yr_3km) + s(bio4_3km) +
s(bio15_3km) + s(Slope_3km) + s(Roughness_3km) + s(Bare_3km) +
s(Herb_3km) + s(evi_mean) + s(srtm_3km), family = "binomial", data =
data2, method = "GACV.Cp")

2nd) generated grid to hold the prediction (here's the def)
> str(preds)
Formal class 'SpatialGridDataFrame' [package "sp"] with 6 slots
  ..@ data       :'data.frame':	996705 obs. of  0 variables
  ..@ grid       :Formal class 'GridTopology' [package "sp"] with 3 slots
  .. .. ..@ cellcentre.offset: Named num [1:2] -427500 3475500
  .. .. .. ..- attr(*, "names")= chr [1:2] "x" "y"
  .. .. ..@ cellsize         : num [1:2] 3000 3000
  .. .. ..@ cells.dim        : int [1:2] 621 1605
  ..@ grid.index : int(0)
  ..@ coords     : num [1:2, 1:2] -427500 1432500 3475500 8287500
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : NULL
  .. .. ..$ : chr [1:2] "x" "y"
  ..@ bbox       : num [1:2, 1:2] -429000 3474000 1434000 8289000
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : chr [1:2] "x" "y"
  .. .. ..$ : chr [1:2] "min" "max"
  ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slots
  .. .. ..@ projargs: chr " +proj=utm +south +no_defs +zone=19
+a=6378137 +rf=298.257223563 +towgs84=0.000,0.000,0.000 +to_meter=1"



HERE's are the variables where this grid came from:
> str(clima4.1)
Formal class 'SpatialGridDataFrame' [package "sp"] with 6 slots
  ..@ data       :'data.frame':	996705 obs. of  15 variables:
  .. ..$ tmin_yr_3km  : int [1:996705] NA NA NA NA NA NA NA NA NA NA ...
  .. ..$ tmax_yr_3km  : int [1:996705] NA NA NA NA NA NA NA NA NA NA ...
  .. ..$ bio1_3km     : int [1:996705] NA NA NA NA NA NA NA NA NA NA ...
  .. ..$ bio4_3km     : int [1:996705] NA NA NA NA NA NA NA NA NA NA ...
  .. ..$ bio12_3km    : int [1:996705] NA NA NA NA NA NA NA NA NA NA ...
  .. ..$ bio15_3km    : int [1:996705] NA NA NA NA NA NA NA NA NA NA ...
  .. ..$ Aspect_3km   : num [1:996705] NaN NaN NaN NaN NaN NaN NaN NaN
NaN NaN ...
  .. ..$ Slope_3km    : num [1:996705] NaN NaN NaN NaN NaN NaN NaN NaN
NaN NaN ...
  .. ..$ Roughness_3km: num [1:996705] NaN NaN NaN NaN NaN NaN NaN NaN
NaN NaN ...
  .. ..$ Tree_3km     : int [1:996705] NA NA NA NA NA NA NA NA NA NA ...
  .. ..$ Bare_3km     : int [1:996705] NA NA NA NA NA NA NA NA NA NA ...
  .. ..$ Herb_3km     : int [1:996705] NA NA NA NA NA NA NA NA NA NA ...
  .. ..$ evi_mean     : num [1:996705] NaN NaN NaN NaN NaN NaN NaN NaN
NaN NaN ...
  .. ..$ clpop2008    : num [1:996705] NaN NaN NaN NaN NaN NaN NaN NaN
NaN NaN ...
  .. ..$ srtm_3km     : int [1:996705] NA NA NA NA NA NA NA NA NA NA ...
  ..@ grid       :Formal class 'GridTopology' [package "sp"] with 3 slots
  .. .. ..@ cellcentre.offset: Named num [1:2] -427500 3475500
  .. .. .. ..- attr(*, "names")= chr [1:2] "x" "y"
  .. .. ..@ cellsize         : num [1:2] 3000 3000
  .. .. ..@ cells.dim        : int [1:2] 621 1605
  ..@ grid.index : int(0)
  ..@ coords     : num [1:2, 1:2] -427500 1432500 3475500 8287500
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : NULL
  .. .. ..$ : chr [1:2] "x" "y"
  ..@ bbox       : num [1:2, 1:2] -429000 3474000 1434000 8289000
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : chr [1:2] "x" "y"
  .. .. ..$ : chr [1:2] "min" "max"
  ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slots
  .. .. ..@ projargs: chr " +proj=utm +south +no_defs +zone=19
+a=6378137 +rf=298.257223563 +towgs84=0.000,0.000,0.000 +to_meter=1"



Data to model:
> str(data2)
'data.frame':	1252 obs. of  18 variables:
 $ tmin_yr_3km  : int  1 1 1 1 1 1 0 0 1 0 ...
 $ tmax_yr_3km  : int  10 11 10 10 9 8 17 18 10 13 ...
 $ bio1_3km     : int  59 65 62 63 56 52 82 94 59 67 ...
 $ bio4_3km     : int  3818 3610 3717 3687 2928 2777 2413 2415 3677 3486 ...
 $ bio12_3km    : int  567 609 509 487 339 567 184 167 568 226 ...
 $ bio15_3km    : int  31 15 17 17 20 16 166 165 16 92 ...
 $ Aspect_3km   : num  136 200 202 112 149 ...
 $ Slope_3km    : num  8.38 2.47 5.39 5.59 1.21 ...
 $ Roughness_3km: num  417.7 141.2 249.4 255.2 70.3 ...
 $ Tree_3km     : int  8 12 7 7 11 34 2 2 14 0 ...
 $ Bare_3km     : int  21 37 18 53 13 37 2 3 17 0 ...
 $ Herb_3km     : int  78 67 83 74 79 65 61 55 79 22 ...
 $ evi_mean     : num  0.191 0.187 0.24 0.214 0.311 ...
 $ clpop2008    : num  0 0.628 1.04 0.339 0 ...
 $ srtm_3km     : int  675 242 389 250 208 185 3492 3288 413 2306 ...
 $ resp         : num  1 1 1 1 1 1 1 1 1 1 ...
 $ X            : num  250553 236521 243073 246358 483071 ...
 $ Y            : num  4781714 4341028 4352441 4337020 4130890 ...

-- 
Instituto de Silvicultura
Universidad Austral de Chile
Isla Teja, Valdivia, Chile

+56 (63) 222480 [of.]
http://www.ecoinformatica.cl


From r.turner at auckland.ac.nz  Thu Jan 13 22:36:31 2011
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Fri, 14 Jan 2011 10:36:31 +1300
Subject: [R-sig-Geo] Testing.
Message-ID: <809DEBB6-8E75-414E-B50F-CA280BE3B795@auckland.ac.nz>


Please ignore this message.  My apologies for the noise.

	cheers,

		Rolf Turner


From manuel.schneider at art.admin.ch  Fri Jan 14 08:05:28 2011
From: manuel.schneider at art.admin.ch (Manuel Schneider)
Date: Fri, 14 Jan 2011 07:05:28 +0000 (UTC)
Subject: [R-sig-Geo] R, TINs &amp; Raster
References: <4D2ED06F.1070603@googlemail.com>
Message-ID: <loom.20110114T080201-450@post.gmane.org>

Andy Wilson <andy.a.wilson <at> gmail.com> writes:

> 
> Hi all,
> I'm pretty new to R so was hoping someone could someone point me in the 
> right direction to get started. Is it possible to construct a TIN from 
> point elevation values and then convert this to a raster?
> Many thanks
> Andy
> 

I can really recommend the book by Tom Hengl (specifically Ch.9) at
http://www.lulu.com/product/paperback/a-practical-guide-to-geostatistical-mapping/6379056

Abw


From manuel.schneider at art.admin.ch  Fri Jan 14 08:12:30 2011
From: manuel.schneider at art.admin.ch (Manuel Schneider)
Date: Fri, 14 Jan 2011 07:12:30 +0000 (UTC)
Subject: [R-sig-Geo] predict gam model....
References: <AANLkTim0sqMOGUxMoPhRFO0a8sZpKD1ey00+kUWro4cT@mail.gmail.com>
Message-ID: <loom.20110114T081005-655@post.gmane.org>

Horacio Samaniego <horacio.samaniego <at> gmail.com> writes:

> 
> Hi,
> I'm having some trouble on a very basic operation it seems.... I am
> not successful generating GAM predictions on a grid. I suspect an
> issue with NA's but are not sure what it is. I get the following
> error:
> 
> > preds[["gam1"]]=predict(gam4.1,newdata=clima4.1,type="response")*100
> Error in `[[<-.data.frame`(`*tmp*`, i, value = c(NA, NA, 0.259444360380994,  :
>   replacement has 88486 rows, data has 996705

Not sure whether predict.gam operates on a SGDF.
Have you tried newdata=clima4.1 at data ?

Abw
Manuel

> 
> Any hint on where the discrepancy between rows come from?....
> basically,  don't think that I'm fully understanding the error.
> 
> Thanks,
>


From jim at bitwrit.com.au  Fri Jan 14 10:17:56 2011
From: jim at bitwrit.com.au (Jim Lemon)
Date: Fri, 14 Jan 2011 20:17:56 +1100
Subject: [R-sig-Geo] Testing.
In-Reply-To: <809DEBB6-8E75-414E-B50F-CA280BE3B795@auckland.ac.nz>
References: <809DEBB6-8E75-414E-B50F-CA280BE3B795@auckland.ac.nz>
Message-ID: <4D3014C4.6090409@bitwrit.com.au>

On 01/14/2011 08:36 AM, Rolf Turner wrote:
>
> Please ignore this message.  My apologies for the noise.
>
What? I didn't hear anything!

Jim


From geomalik at live.com  Fri Jan 14 15:13:43 2011
From: geomalik at live.com (Malik Shahzad)
Date: Fri, 14 Jan 2011 21:13:43 +0700
Subject: [R-sig-Geo] RASTER or RGDAL package
Message-ID: <SNT111-W405E3D30743852FC7BBF8EACF30@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110114/7cede86a/attachment.pl>

From carstennh at aol.com  Fri Jan 14 15:43:10 2011
From: carstennh at aol.com (Carsten Neumann)
Date: Fri, 14 Jan 2011 15:43:10 +0100
Subject: [R-sig-Geo] RASTER or RGDAL package
In-Reply-To: <SNT111-W405E3D30743852FC7BBF8EACF30@phx.gbl>
References: <SNT111-W405E3D30743852FC7BBF8EACF30@phx.gbl>
Message-ID: <4D3060FE.5000703@aol.com>

  Am 14.01.2011 15:13, schrieb Malik Shahzad:
> Dear mailing list.. Please give me some information.
> Which one is best fit for Remote Sensing Data RASTER or RGDAL package???
>
> with Best Regards,
>
>
>
> Malik
>
>      [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
Dear Malik,

to handle large datasets package raster is the best solution. Using 
rgdal causes memory error because data is directly read into memory. 
Especially multidimesnional remote sensing images are characterized by a 
huge amount of data that has to be processed. The package raster allows 
to read and process blocks of data from a path where your image is 
stored on disc. Additionally you can use rgdal drivers in raster  to 
store your processed image result in different formats.

With best regards

Carsten


From jeffrey.stratford at wilkes.edu  Fri Jan 14 16:44:00 2011
From: jeffrey.stratford at wilkes.edu (Stratford, Jeffrey)
Date: Fri, 14 Jan 2011 10:44:00 -0500
Subject: [R-sig-Geo] sampling a raster using sample points
In-Reply-To: <4D3060FE.5000703@aol.com>
References: <SNT111-W405E3D30743852FC7BBF8EACF30@phx.gbl>
	<4D3060FE.5000703@aol.com>
Message-ID: <72B2B2BDFE51E64DAC6381495614980006844063@STAFFEXCHVS3.wilkesu.wilkes.edu>

Hi everyone,

Does anyone have any suggestions on sampling a raster (NLCD land cover
map, 30 m res) using circular buffers centered on 100+ sample points?

The NLCD map has classifications such as high density urban, medium
density urban, crop, etc.  The goal is to produce a data set with the
percent of each cover type for each point and relate this to biological
data (+/- blood parasites).  The next goal would be to extrapolate
parasitism probabilities throughout the landscape but that's a big next
step.  For now, I'd be happy to figure out how to extract data from the
NLCD map.

In the past I had been using raster calculator in ArcGIS/spatial analyst
but I would prefer to use open source software. I'm also a low-level
programmer - my specialty is the ecological side. 

Thanks,

Jeff

************************************
Dr. Jeffrey A. Stratford
Department of Health and Biological Sciences
84 W. South Street
Wilkes University, PA 18766
jeffrey.stratford at wilkes.edu
570-408-4761 (office)
570-332-2942 (cell)
http://web.wilkes.edu/jeffrey.stratford/
************************************

    


From r.hijmans at gmail.com  Fri Jan 14 18:13:45 2011
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Fri, 14 Jan 2011 09:13:45 -0800 (PST)
Subject: [R-sig-Geo] RASTER or RGDAL package
In-Reply-To: <4D3060FE.5000703@aol.com>
References: <SNT111-W405E3D30743852FC7BBF8EACF30@phx.gbl>
	<4D3060FE.5000703@aol.com>
Message-ID: <1295025225527-5922589.post@n2.nabble.com>


> Dear mailing list.. Please give me some information. 
> Which one is best fit for Remote Sensing Data RASTER or RGDAL package??? 
> 
> with Best Regards, 
> 

I would add that raster builds on rgdal, and so, if you use raster, in most
cases it would be raster & rgdal, with rgdal providing the basic file
reading and writing, and raster managing that to avoid memory problems, and
through a large number of additional functions that operate on raster data.
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/RASTER-or-RGDAL-package-tp5921830p5922589.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From r.hijmans at gmail.com  Fri Jan 14 18:17:01 2011
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Fri, 14 Jan 2011 09:17:01 -0800 (PST)
Subject: [R-sig-Geo] sampling a raster using sample points
In-Reply-To: <72B2B2BDFE51E64DAC6381495614980006844063@STAFFEXCHVS3.wilkesu.wilkes.edu>
References: <SNT111-W405E3D30743852FC7BBF8EACF30@phx.gbl>
	<4D3060FE.5000703@aol.com>
	<72B2B2BDFE51E64DAC6381495614980006844063@STAFFEXCHVS3.wilkesu.wilkes.edu>
Message-ID: <1295025421914-5922603.post@n2.nabble.com>


> Does anyone have any suggestions on sampling a raster (NLCD land cover 
> map, 30 m res) using circular buffers centered on 100+ sample points? 

You can do:

library(raster)
r <- raster('filename')
extract(r, points, buffer=250)

where points is a two column matrix (x,y), or (inherits from) a
SpatialPoints object

Robert
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/RASTER-or-RGDAL-package-tp5921830p5922603.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Andy.Bunn at wwu.edu  Fri Jan 14 22:44:40 2011
From: Andy.Bunn at wwu.edu (Andy Bunn)
Date: Fri, 14 Jan 2011 13:44:40 -0800
Subject: [R-sig-Geo] Rotated EOF
Message-ID: <7E6EA3F4372E474F8F3F850DD262FDA903F5B259F8@ExchMailbox3.univ.dir.wwu.edu>

Hi all, 

I'm developing a teaching example doing EOF analysis on global temperature data using the clim.pact library. Does anybody know if there is an existing function to do rotated EOF analysis? E.g., a varimax rotation on an EOF object?

Regards, Andy


From edzer.pebesma at uni-muenster.de  Fri Jan 14 23:17:40 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 14 Jan 2011 23:17:40 +0100
Subject: [R-sig-Geo] Rotated EOF
In-Reply-To: <7E6EA3F4372E474F8F3F850DD262FDA903F5B259F8@ExchMailbox3.univ.dir.wwu.edu>
References: <7E6EA3F4372E474F8F3F850DD262FDA903F5B259F8@ExchMailbox3.univ.dir.wwu.edu>
Message-ID: <4D30CB84.7050101@uni-muenster.de>

If I recall correctly, EOF is equivalent to PCA. Does it use the
available PCA functions, prcomp or princomp? Anyway, base R has the
function factanal to do varimax. Does your EOF object contain a
correlation or covariance matrix?

> Hi all, 
> 
> I'm developing a teaching example doing EOF analysis on global temperature data using the clim.pact library. Does anybody know if there is an existing function to do rotated EOF analysis? E.g., a varimax rotation on an EOF object?
> 
> Regards, Andy
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From Jan.Quets at ua.ac.be  Sat Jan 15 21:34:14 2011
From: Jan.Quets at ua.ac.be (Quets Jan)
Date: Sat, 15 Jan 2011 21:34:14 +0100
Subject: [R-sig-Geo] from gps-coordinates to euclidean coordinates
Message-ID: <88D678F82D1A1447BD5C643160FFCBC20C1714@xmail07.ad.ua.ac.be>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110115/05359bc8/attachment.pl>

From mario.bellinato at gmail.com  Sun Jan 16 00:54:18 2011
From: mario.bellinato at gmail.com (Mario Bellinato)
Date: Sun, 16 Jan 2011 00:54:18 +0100
Subject: [R-sig-Geo] reading into R IPCC data files
Message-ID: <AANLkTime8gNzpF+19F=SaAtCdxdMtuzaOZ4p3EF5Qg3d@mail.gmail.com>

Dear R-sig-geo users,

I was wondering whether there is a way of reading into R the IPCC
climate scenario data (see
<http://www.ipcc-data.org/sres/hadcm3_download.html>) and export them
into a format that can be read by a GIS programme?

thanks in advance,

Marco


From ldecola at comcast.net  Sun Jan 16 12:44:31 2011
From: ldecola at comcast.net (ldecola at comcast.net)
Date: Sun, 16 Jan 2011 11:44:31 +0000 (UTC)
Subject: [R-sig-Geo] from gps-coordinates to euclidean coordinates
In-Reply-To: <88D678F82D1A1447BD5C643160FFCBC20C1714@xmail07.ad.ua.ac.be>
Message-ID: <1441095822.1352153.1295178271376.JavaMail.root@sz0030a.westchester.pa.mail.comcast.net>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110116/da3f5384/attachment.pl>

From Jan.Quets at ua.ac.be  Sun Jan 16 13:06:38 2011
From: Jan.Quets at ua.ac.be (Quets Jan)
Date: Sun, 16 Jan 2011 13:06:38 +0100
Subject: [R-sig-Geo] from gps-coordinates to euclidean coordinates
References: <1441095822.1352153.1295178271376.JavaMail.root@sz0030a.westchester.pa.mail.comcast.net>
Message-ID: <88D678F82D1A1447BD5C643160FFCBC20C1719@xmail07.ad.ua.ac.be>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110116/ce53e5f9/attachment.pl>

From tom.gottfried at wzw.tum.de  Sun Jan 16 13:50:57 2011
From: tom.gottfried at wzw.tum.de (Tom Gottfried)
Date: Sun, 16 Jan 2011 13:50:57 +0100
Subject: [R-sig-Geo] from gps-coordinates to euclidean coordinates
In-Reply-To: <88D678F82D1A1447BD5C643160FFCBC20C1714@xmail07.ad.ua.ac.be>
References: <88D678F82D1A1447BD5C643160FFCBC20C1714@xmail07.ad.ua.ac.be>
Message-ID: <4D32E9B1.3020700@wzw.tum.de>

Hi Jan,

spTransform in the package rgdal can do the job. You can reproject your 
GPS-coordinates (probably WGS84) into e.g. UTM and then substract the 
coordinates from one of your points from all to get relative coordinates.

Tom


From tom.gottfried at wzw.tum.de  Sun Jan 16 14:39:33 2011
From: tom.gottfried at wzw.tum.de (Tom Gottfried)
Date: Sun, 16 Jan 2011 14:39:33 +0100
Subject: [R-sig-Geo] converting points to grid
In-Reply-To: <406664.38148.qm@web63601.mail.re1.yahoo.com>
References: <88D678F82D1A1447BD5C643160FFCBC20C1714@xmail07.ad.ua.ac.be>
	<4D32E9B1.3020700@wzw.tum.de>
	<406664.38148.qm@web63601.mail.re1.yahoo.com>
Message-ID: <4D32F515.2080405@wzw.tum.de>

Leons,

Maybe that's what you mean:

grid <- as(as(points, "SpatialPixelsDataFrame"), "SpatialGridDataFrame")

Tom

P.S.: please post to the list instead of just writing me.

Am 16.01.2011 14:05, schrieb Leons Mwenda:
> Hi Tom,
> Have you come across on the way of converting SpatialPointDataFrame to
> SpatialPointGridFrame?
> Kindly regards
> Leons
>
>
> ----- Original Message ----
> From: Tom Gottfried<tom.gottfried at wzw.tum.de>
> To: r-sig-geo at r-project.org
> Sent: Sun, 16 January, 2011 13:50:57
> Subject: Re: [R-sig-Geo] from gps-coordinates to euclidean coordinates
>
> Hi Jan,
>
> spTransform in the package rgdal can do the job. You can reproject your
> GPS-coordinates (probably WGS84) into e.g. UTM and then substract the
> coordinates from one of your points from all to get relative coordinates.
>
> Tom
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>
>


From Thomas.Adams at noaa.gov  Sun Jan 16 16:28:48 2011
From: Thomas.Adams at noaa.gov (Thomas Adams)
Date: Sun, 16 Jan 2011 10:28:48 -0500
Subject: [R-sig-Geo] reading into R IPCC data files
In-Reply-To: <AANLkTime8gNzpF+19F=SaAtCdxdMtuzaOZ4p3EF5Qg3d@mail.gmail.com>
References: <AANLkTime8gNzpF+19F=SaAtCdxdMtuzaOZ4p3EF5Qg3d@mail.gmail.com>
Message-ID: <4D330EB0.7020200@noaa.gov>



Marco,

I just took a look at the data; unfortunately, it's not in a very usable format without reformatting it for
importing the data into either R or a GIS, such as GRASS GIS. I'm sure an experienced R programmer could
write a clever R script to do what you want. Personally, I would write a Perl script to reformat the data to
import directly into GRASS GIS. I looked at the HADCM3_A2a_PREC_1980.tar.gz data and it is cell-centered.
GRASS grids are referenced by the lower-left grid corner. I noticed that there are many different grid spacings
and not all the grids are square, they are rectangular. Bottom line is that a lot of care is going to be needed
to manipulate these data sources. I have to think that somewhere there must be this same data available in grib
format, which imports into GRASS very easily.

Regards,
Tom


On 1/15/11 6:54 PM, Mario Bellinato wrote:
> Dear R-sig-geo users,
>
> I was wondering whether there is a way of reading into R the IPCC
> climate scenario data (see
> <http://www.ipcc-data.org/sres/hadcm3_download.html>) and export them
> into a format that can be read by a GIS programme?
>
> thanks in advance,
>
> Marco
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


-- 
Thomas E Adams
National Weather Service
Ohio River Forecast Center
1901 South State Route 134
Wilmington, OH 45177

EMAIL:	thomas.adams at noaa.gov

VOICE:	937-383-0528
FAX:	937-383-0033


From b.rowlingson at lancaster.ac.uk  Sun Jan 16 16:26:05 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Sun, 16 Jan 2011 15:26:05 +0000
Subject: [R-sig-Geo] from gps-coordinates to euclidean coordinates
In-Reply-To: <88D678F82D1A1447BD5C643160FFCBC20C1714@xmail07.ad.ua.ac.be>
References: <Acu085MHIXaTdj6WT+CY6MD59y009A==>
	<88D678F82D1A1447BD5C643160FFCBC20C1714@xmail07.ad.ua.ac.be>
Message-ID: <AANLkTimx9E-S5oP5VzRRKbrvSdY3LR7Q68kC8zkaaQ3Z@mail.gmail.com>

On Sat, Jan 15, 2011 at 8:34 PM, Quets Jan <Jan.Quets at ua.ac.be> wrote:
>
> Hi all,
>
> is there an R function which can transform gps-coordinates to euclidean coordinates,
>
> given that,
>
> a) the earth's curvature can be neglected (eg. all points lie withing 10km from each other)

 Neglecting earth's curvature depends not only on the range of the
data, but also on how precise and accurate your measurements are. If
you are working to some small fraction of a cm, you might need the
consider the curvature of the earth over a 10km region.

 You might think this would never happen in the real world at this
scale, but engineers building suspension bridges have to take into
account the fact that the tops of suspension towers are further apart
than the bottoms, because of the earth's curvature, for a bridge of
the order of a few km!

 I'm just having a pedantic Sunday :)

Barry


From b.rowlingson at lancaster.ac.uk  Sun Jan 16 17:04:12 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Sun, 16 Jan 2011 16:04:12 +0000
Subject: [R-sig-Geo] reading into R IPCC data files
In-Reply-To: <4D330EB0.7020200@noaa.gov>
References: <AANLkTime8gNzpF+19F=SaAtCdxdMtuzaOZ4p3EF5Qg3d@mail.gmail.com>
	<4D330EB0.7020200@noaa.gov>
Message-ID: <AANLkTik88H+5dp0Rzsus7G+W3PGEgcbv85v3e7CFxvGn@mail.gmail.com>

On Sun, Jan 16, 2011 at 3:28 PM, Thomas Adams <Thomas.Adams at noaa.gov> wrote:
>
>
> Marco,
>
> I just took a look at the data; unfortunately, it's not in a very usable
> format without reformatting it for
> importing the data into either R or a GIS, such as GRASS GIS. I'm sure an
> experienced R programmer could
> write a clever R script to do what you want. Personally, I would write a
> Perl script to reformat the data to
> import directly into GRASS GIS. I looked at the HADCM3_A2a_PREC_1980.tar.gz
> data and it is cell-centered.
> GRASS grids are referenced by the lower-left grid corner. I noticed that
> there are many different grid spacings
> and not all the grids are square, they are rectangular. Bottom line is that
> a lot of care is going to be needed
> to manipulate these data sources. I have to think that somewhere there must
> be this same data available in grib
> format, which imports into GRASS very easily.
>
> Regards,
> Tom
>
>
> On 1/15/11 6:54 PM, Mario Bellinato wrote:
>>
>> Dear R-sig-geo users,
>>
>> I was wondering whether there is a way of reading into R the IPCC
>> climate scenario data (see
>> <http://www.ipcc-data.org/sres/hadcm3_download.html>) and export them
>> into a format that can be read by a GIS programme?
>>

That's a horrendous data file format, typical of the sort of thing you
get from Fortran programmers :)

There's a very complex-looking "web 0.1" style data browser thing here
which lets you eventually download .csv files which might be easier to
read into R. I think you can only get a month at a time though, and it
might not be the same data as in your original link (but the Hadley
centre stuff seems to be there...):

http://www.ipcc-data.org/cgi-bin/ddc_nav/dataset=ar4_gcm

 You'd almost think they don't want us to know about climate change....

Barry


From Thomas.Adams at noaa.gov  Sun Jan 16 18:35:24 2011
From: Thomas.Adams at noaa.gov (Thomas Adams)
Date: Sun, 16 Jan 2011 12:35:24 -0500
Subject: [R-sig-Geo] reading into R IPCC data files
In-Reply-To: <AANLkTik88H+5dp0Rzsus7G+W3PGEgcbv85v3e7CFxvGn@mail.gmail.com>
References: <AANLkTime8gNzpF+19F=SaAtCdxdMtuzaOZ4p3EF5Qg3d@mail.gmail.com>
	<4D330EB0.7020200@noaa.gov>
	<AANLkTik88H+5dp0Rzsus7G+W3PGEgcbv85v3e7CFxvGn@mail.gmail.com>
Message-ID: <4D332C5C.30901@noaa.gov>

  Barry,

WRT your last line ? I could not agree more; the same thought came to me 
as well!

Tom

On 1/16/11 11:04 AM, Barry Rowlingson wrote:
> On Sun, Jan 16, 2011 at 3:28 PM, Thomas Adams<Thomas.Adams at noaa.gov>  wrote:
>>
>> Marco,
>>
>> I just took a look at the data; unfortunately, it's not in a very usable
>> format without reformatting it for
>> importing the data into either R or a GIS, such as GRASS GIS. I'm sure an
>> experienced R programmer could
>> write a clever R script to do what you want. Personally, I would write a
>> Perl script to reformat the data to
>> import directly into GRASS GIS. I looked at the HADCM3_A2a_PREC_1980.tar.gz
>> data and it is cell-centered.
>> GRASS grids are referenced by the lower-left grid corner. I noticed that
>> there are many different grid spacings
>> and not all the grids are square, they are rectangular. Bottom line is that
>> a lot of care is going to be needed
>> to manipulate these data sources. I have to think that somewhere there must
>> be this same data available in grib
>> format, which imports into GRASS very easily.
>>
>> Regards,
>> Tom
>>
>>
>> On 1/15/11 6:54 PM, Mario Bellinato wrote:
>>> Dear R-sig-geo users,
>>>
>>> I was wondering whether there is a way of reading into R the IPCC
>>> climate scenario data (see
>>> <http://www.ipcc-data.org/sres/hadcm3_download.html>) and export them
>>> into a format that can be read by a GIS programme?
>>>
> That's a horrendous data file format, typical of the sort of thing you
> get from Fortran programmers :)
>
> There's a very complex-looking "web 0.1" style data browser thing here
> which lets you eventually download .csv files which might be easier to
> read into R. I think you can only get a month at a time though, and it
> might not be the same data as in your original link (but the Hadley
> centre stuff seems to be there...):
>
> http://www.ipcc-data.org/cgi-bin/ddc_nav/dataset=ar4_gcm
>
>   You'd almost think they don't want us to know about climate change....
>
> Barry


-- 
Thomas E Adams
National Weather Service
Ohio River Forecast Center
1901 South State Route 134
Wilmington, OH 45177

EMAIL:	thomas.adams at noaa.gov

VOICE:	937-383-0528
FAX:	937-383-0033


From b.rowlingson at lancaster.ac.uk  Sun Jan 16 19:19:24 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Sun, 16 Jan 2011 18:19:24 +0000
Subject: [R-sig-Geo] reading into R IPCC data files
In-Reply-To: <4D332C5C.30901@noaa.gov>
References: <AANLkTime8gNzpF+19F=SaAtCdxdMtuzaOZ4p3EF5Qg3d@mail.gmail.com>
	<4D330EB0.7020200@noaa.gov>
	<AANLkTik88H+5dp0Rzsus7G+W3PGEgcbv85v3e7CFxvGn@mail.gmail.com>
	<4D332C5C.30901@noaa.gov>
Message-ID: <AANLkTimDGoQQCTnaSM_Lhd=89yBiMFTQy8=CT=Ocd7Sq@mail.gmail.com>

On Sun, Jan 16, 2011 at 5:35 PM, Thomas Adams <Thomas.Adams at noaa.gov> wrote:
> ?Barry,
>
> WRT your last line ? I could not agree more; the same thought came to me as
> well!

 The counter-argument of course is that these guys are hardcore
programmers who don't have time to put a wussy presentation layer on
top of the data! *Their* Fortran code tells them climate change is
real, why should they have to convert everything to ESRI Raster Grids
when it's so obvious? :)

Barry


From cribeiro at ualg.pt  Sun Jan 16 21:17:05 2011
From: cribeiro at ualg.pt (=?ISO-8859-1?Q?Concei=E7=E3o_Ribeiro?=)
Date: Sun, 16 Jan 2011 20:17:05 +0000
Subject: [R-sig-Geo] plotIC
In-Reply-To: <mailman.458.1295201037.4467.r-sig-geo@r-project.org>
References: <mailman.458.1295201037.4467.r-sig-geo@r-project.org>
Message-ID: <AANLkTimqErTCKafirwcEYdQ2hj-QS6WseMACJqZkrQov@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110116/54a82191/attachment.pl>

From sadz_a1000 at yahoo.co.uk  Sun Jan 16 22:31:00 2011
From: sadz_a1000 at yahoo.co.uk (Sadz A)
Date: Sun, 16 Jan 2011 21:31:00 +0000 (GMT)
Subject: [R-sig-Geo] Restricting an interpolation
Message-ID: <615343.5213.qm@web24613.mail.ird.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110116/e2017f81/attachment.pl>

From wjbyrd at troy.edu  Mon Jan 17 02:58:48 2011
From: wjbyrd at troy.edu (Jennings Byrd)
Date: Sun, 16 Jan 2011 19:58:48 -0600
Subject: [R-sig-Geo] gstsls help
Message-ID: <000001cbb5ea$16d7d790$448786b0$@troy.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110116/66d829e8/attachment.pl>

From jim at bitwrit.com.au  Mon Jan 17 08:37:17 2011
From: jim at bitwrit.com.au (Jim Lemon)
Date: Mon, 17 Jan 2011 18:37:17 +1100
Subject: [R-sig-Geo] plotIC
In-Reply-To: <AANLkTimqErTCKafirwcEYdQ2hj-QS6WseMACJqZkrQov@mail.gmail.com>
References: <mailman.458.1295201037.4467.r-sig-geo@r-project.org>
	<AANLkTimqErTCKafirwcEYdQ2hj-QS6WseMACJqZkrQov@mail.gmail.com>
Message-ID: <4D33F1AD.4030508@bitwrit.com.au>

On 01/17/2011 07:17 AM, Concei??o Ribeiro wrote:
> ---------- Mensagem encaminhada ----------
> De:<r-sig-geo-owner at r-project.org>
> Data: 16 de janeiro de 2011 18:03
> Assunto: Fwd: plotIC
> Para: cribeiro6168 at gmail.com
>
>
> You are not allowed to post to this mailing list, and your message has
> been automatically rejected.  If you think that your messages are
> being rejected in error, contact the mailing list owner at
> r-sig-geo-owner at r-project.org.
>
>
> Hi,
>
> when I use the plotIC with all values and ask to label with the names it
> goes very well,
>
> library(plotrix)
>
> y<-cbind(lower,upper)
> plotCI(1:278,rate,li=lower,ui=upper,xlab="278 Concelhos",ylab="SMR",pch=19)
> text(1:278,upper+0.25,NomeConc,cex=.5)
> abline(1,0,col=4,lwd=2)
>
>
> but I need to do separate plots and when I ask to label in this separate
> plots it show more than one label in each IC, it repeats the name several
> times.
>
> y<-cbind(lower,upper)
> plotCI(1:27,rate[1:27],li=lower,ui=upper,xlab="278
> Concelhos",ylab="SMR",pch=19)
> text(1:27,upper+0.25,NomeConc[1:27],cex=.5)
> abline(1,0,col=4,lwd=2)
>
Hi Concei??o,
I can't really work out what is happening, but if you could post the 
data (or just a bunch of random numbers with the same names) perhaps I 
could find a solution.

Jim


From Roger.Bivand at nhh.no  Mon Jan 17 10:04:02 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 17 Jan 2011 10:04:02 +0100 (CET)
Subject: [R-sig-Geo] gstsls help
In-Reply-To: <000001cbb5ea$16d7d790$448786b0$@troy.edu>
References: <000001cbb5ea$16d7d790$448786b0$@troy.edu>
Message-ID: <alpine.LRH.2.00.1101170957110.7278@reclus.nhh.no>

On Sun, 16 Jan 2011, Jennings Byrd wrote:

> All,
>
>
>
> I'm new to the R language and the packages therein.  What I wanted to know
> is if there are any way to obtain additional diagnostic info such as log
> likelihood or r square in the gstsls function in the spdep package.  I have
> searched the documentation and have largely come up empty handed.  Any help
> would be greatly appreciated.
>

Note that gstsls is a spatial TSLS, followed by a GLS, followed by a 
spatial TSLS. None of these are ML, so you don't have a likelihood 
expression, I think? I don't think that there is an easy expression for 
the R-squared either, other than the unadjusted ratio of the variance of 
the third step residuals and the variance of the response, but given the 
lag component, I'm not sure that this is appropriate either. This is not a 
well-explored area, contributions welcome.

Roger

>
>
> Will
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From ashenkin at ufl.edu  Mon Jan 17 21:47:18 2011
From: ashenkin at ufl.edu (Alexander Shenkin)
Date: Mon, 17 Jan 2011 15:47:18 -0500
Subject: [R-sig-Geo] spatstat error, rotate after union
Message-ID: <4D34AAD6.3040502@ufl.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110117/ad38fe74/attachment.pl>

From Andy.Bunn at wwu.edu  Mon Jan 17 22:59:27 2011
From: Andy.Bunn at wwu.edu (Andy Bunn)
Date: Mon, 17 Jan 2011 13:59:27 -0800
Subject: [R-sig-Geo] reading into R IPCC data files
In-Reply-To: <AANLkTimDGoQQCTnaSM_Lhd=89yBiMFTQy8=CT=Ocd7Sq@mail.gmail.com>
References: <AANLkTime8gNzpF+19F=SaAtCdxdMtuzaOZ4p3EF5Qg3d@mail.gmail.com>
	<4D330EB0.7020200@noaa.gov>
	<AANLkTik88H+5dp0Rzsus7G+W3PGEgcbv85v3e7CFxvGn@mail.gmail.com>
	<4D332C5C.30901@noaa.gov>
	<AANLkTimDGoQQCTnaSM_Lhd=89yBiMFTQy8=CT=Ocd7Sq@mail.gmail.com>
Message-ID: <7E6EA3F4372E474F8F3F850DD262FDA903F5B25A50@ExchMailbox3.univ.dir.wwu.edu>

>  The counter-argument of course is that these guys are hardcore
> programmers who don't have time to put a wussy presentation layer on
> top of the data!

Two things:
1. Casual perusal of the AR4 data can be done via the Visualisation Tools. I think it's well done overall in terms of accessing and plotting a ludicrous amount of GCM data. Look here: 
http://www.ipcc-data.org/ddc_visualisation.html 

2. If you want the actual zeros and ones, model output from the AR4 is available from the Coupled Model Intercomparison Project (CMIP3 - specifically). Unlike the IPCC DDC link given originally in this thread, the CMIP3 data are easier to parse for non F90 folks and available as netCDF. Look here: http://www-pcmdi.llnl.gov/ipcc/about_ipcc.php 

There is a nice overview of the model simulation archive here:
http://www.realclimate.org/index.php/archives/2008/02/ipcc-archive/ 

HTH, -AB


From Andy.Bunn at wwu.edu  Mon Jan 17 23:24:51 2011
From: Andy.Bunn at wwu.edu (Andy Bunn)
Date: Mon, 17 Jan 2011 14:24:51 -0800
Subject: [R-sig-Geo] Rotated EOF
In-Reply-To: <4D30CB84.7050101@uni-muenster.de>
References: <7E6EA3F4372E474F8F3F850DD262FDA903F5B259F8@ExchMailbox3.univ.dir.wwu.edu>
	<4D30CB84.7050101@uni-muenster.de>
Message-ID: <7E6EA3F4372E474F8F3F850DD262FDA903F5B25A51@ExchMailbox3.univ.dir.wwu.edu>

> If I recall correctly, EOF is equivalent to PCA. Does it use the
> available PCA functions, prcomp or princomp? Anyway, base R has the
> function factanal to do varimax. Does your EOF object contain a
> correlation or covariance matrix?

The clim.pact algorithm uses SVD and does not calculate the eigenvectors for a covariance matrix. But the authors discuss rotation in their book. So, shockingly, I'll go RTFB. Thx, AB


From r.hijmans at gmail.com  Tue Jan 18 00:04:04 2011
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Mon, 17 Jan 2011 15:04:04 -0800 (PST)
Subject: [R-sig-Geo] reading into R IPCC data files
In-Reply-To: <7E6EA3F4372E474F8F3F850DD262FDA903F5B25A50@ExchMailbox3.univ.dir.wwu.edu>
References: <AANLkTime8gNzpF+19F=SaAtCdxdMtuzaOZ4p3EF5Qg3d@mail.gmail.com>
	<4D330EB0.7020200@noaa.gov>
	<AANLkTik88H+5dp0Rzsus7G+W3PGEgcbv85v3e7CFxvGn@mail.gmail.com>
	<4D332C5C.30901@noaa.gov>
	<AANLkTimDGoQQCTnaSM_Lhd=89yBiMFTQy8=CT=Ocd7Sq@mail.gmail.com>
	<7E6EA3F4372E474F8F3F850DD262FDA903F5B25A50@ExchMailbox3.univ.dir.wwu.edu>
Message-ID: <1295305444634-5933842.post@n2.nabble.com>


I agree with Andy, although dealing with ncdf files has its own problems
((although you can open most with raster: brick(filename))

So, for the record, reading these ASCII files is not that hard if you have
R. See below for an example that works on the one file I looked at. You
could easily extend this to automate downloading and processing all the
files with functions download.file() and uzip() 

Robert


library(raster)

filename <- HADCM3_A1F_DSWF_1980.mea

x <- readLines(filename)
x <- apply(matrix(x),1, function(x) gsub("  ", " ", x))
x <- apply(matrix(x),1, function(x) trim (gsub("  ", " ", x)))

start = which(substr(x,1,5)=="7008 ")+1
end = c(which(substr(x,1,4)=="IPCC")[-1] - 1, length(x))

nc = as.integer(substr(x[2], 8, 11))
nr = as.integer(substr(x[2], 13, 16))

# "Grid is 96 * 73  Month is Jan"         

if (length(start) != 12) {
	stop('something wrong')
} else {
	d = matrix(nrow=nc *nr, ncol=12)
	month = NULL
	for (m in 1:12) {
		d[,m] <- as.numeric(unlist(strsplit(x[start[m]:end[m]], " ")))
		mm <- x[start[m]-4]
		mm <- trim(substr(mm, nchar(mm)-3, nchar(mm)))
		month <- c(month, mm)
	}
}

b <- brick(nrow=nr, ncol=nc)
b <- setValues(b, d)
b <- rotate(b)
ln <- paste(month, ";", x[1], ";", x[3], ";", x[4])
layerNames(b) <- ln

plot(b, 1)
plot(b)

b <- writeRaster(b, 'filename.tif')







-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/reading-into-R-IPCC-data-files-tp5925687p5933842.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From paulobrando at gmail.com  Tue Jan 18 02:59:51 2011
From: paulobrando at gmail.com (Paulo Brando)
Date: Mon, 17 Jan 2011 23:59:51 -0200
Subject: [R-sig-Geo] Reached total memory allocation - stack raster
Message-ID: <AANLkTi=aFBBe81=LEpoKCVyCQC5oMbLswL6_Pkr0Sb-L@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110117/5f91f1ac/attachment.pl>

From r.turner at auckland.ac.nz  Tue Jan 18 03:39:43 2011
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Tue, 18 Jan 2011 15:39:43 +1300
Subject: [R-sig-Geo] spatstat error, rotate after union
In-Reply-To: <4D34AAD6.3040502@ufl.edu>
References: <4D34AAD6.3040502@ufl.edu>
Message-ID: <9F31B1E9-4F06-4753-AE17-9EBBBDC9A766@auckland.ac.nz>


On 18/01/2011, at 9:47 AM, Alexander Shenkin wrote:

> Hello Folks,
>
> I'm getting an error trying to rotate after union operations:
>
>     library(spatstat)
>     library(gpclib)
>     spatstat.options(gpclib=TRUE)
>     rotate( union.owin( square(), disc() ) )
>
>         Polygon  contains duplicated vertices
>         Error in owin(poly = bdry, unitname = unitname(X)) :
>           Polygon data contain duplicated vertices
>
> any ideas?

Well, there really are duplicated points.  The error is in the union
operation, not in the rotate() function.  It appears to arise from the
application of the union function in the gpclib package.  The point  
(0,1)
does indeed appear twice.

We'll have to ponder upon how to fix this.

A somewhat dubious workaround is to do:

 > require(gpclib)
 > spatstat.options(gpclib=TRUE)
 > U <- union.owin(square(),disc())
 > V <- as.data.frame(U$bdry[[1]][1:2])
 > V <- V[!duplicated(V),]
 > U$bdry[[1]][1:2] <- V
 > # Check:
 > plot(rotate(U))

Well, the workaround works in this toy example.  Who knows what pitfalls
lurk in more complicated settings?

	cheers,

		Rolf Turner


From ashenkin at ufl.edu  Tue Jan 18 06:10:59 2011
From: ashenkin at ufl.edu (Alexander Shenkin)
Date: Tue, 18 Jan 2011 00:10:59 -0500
Subject: [R-sig-Geo] spatstat error, rotate after union
In-Reply-To: <9F31B1E9-4F06-4753-AE17-9EBBBDC9A766@auckland.ac.nz>
References: <4D34AAD6.3040502@ufl.edu>
	<9F31B1E9-4F06-4753-AE17-9EBBBDC9A766@auckland.ac.nz>
Message-ID: <4D3520E3.9080701@ufl.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110118/093a759b/attachment.pl>

From r.hijmans at gmail.com  Tue Jan 18 07:48:02 2011
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Mon, 17 Jan 2011 22:48:02 -0800 (PST)
Subject: [R-sig-Geo] Reached total memory allocation - stack raster
In-Reply-To: <AANLkTi=aFBBe81=LEpoKCVyCQC5oMbLswL6_Pkr0Sb-L@mail.gmail.com>
References: <AANLkTi=aFBBe81=LEpoKCVyCQC5oMbLswL6_Pkr0Sb-L@mail.gmail.com>
Message-ID: <1295333282355-5934656.post@n2.nabble.com>



> Question: is there a way to deal with the memory issues? Note that saving 
> the file to disc didn't solve this problem.

This should not happen, so thanks for reporting (as did Marcia two weeks
ago. 
http://r-sig-geo.2731867.n2.nabble.com/memory-issues-w-raster-processing-td5875072.html
)

"calc" was being too optimistic in its assessment of memory needs (it
ignored the number of layers in the stack used). I have adjusted that, and I
guess that it will now work (version 1.7-30; should be available from
R-Forge in 24 hours).

For now, you could use make adjustments with options 'maxmemory' and/or
'chunksize', by giving them lower values (but not too low for speed's sake).
E.g.

showOptions()
setOptions(maxmemory=1e+08, chunksize=100000)
showOptions()

Robert
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Reached-total-memory-allocation-stack-raster-tp5934248p5934656.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From b.rowlingson at lancaster.ac.uk  Tue Jan 18 10:48:41 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Tue, 18 Jan 2011 09:48:41 +0000
Subject: [R-sig-Geo] reading into R IPCC data files
In-Reply-To: <1295305444634-5933842.post@n2.nabble.com>
References: <AANLkTime8gNzpF+19F=SaAtCdxdMtuzaOZ4p3EF5Qg3d@mail.gmail.com>
	<4D330EB0.7020200@noaa.gov>
	<AANLkTik88H+5dp0Rzsus7G+W3PGEgcbv85v3e7CFxvGn@mail.gmail.com>
	<4D332C5C.30901@noaa.gov>
	<AANLkTimDGoQQCTnaSM_Lhd=89yBiMFTQy8=CT=Ocd7Sq@mail.gmail.com>
	<7E6EA3F4372E474F8F3F850DD262FDA903F5B25A50@ExchMailbox3.univ.dir.wwu.edu>
	<1295305444634-5933842.post@n2.nabble.com>
Message-ID: <AANLkTi=nNg+9uWCbZ_3HhdrVDfSWc5zYGjv_qpC9uzsH@mail.gmail.com>

On Mon, Jan 17, 2011 at 11:04 PM, Robert Hijmans <r.hijmans at gmail.com> wrote:

> So, for the record, reading these ASCII files is not that hard if you have
> R. See below for an example that works on the one file I looked at. You
> could easily extend this to automate downloading and processing all the
> files with functions download.file() and uzip()

 The important point here is that you say it works on the _one_ file
you looked at. Probably works on others. You don't know until you've
tried. It might read it in without giving any errors but get all the
wrong numbers and then polar bears die.

 There's no excuse for publishing ASCII data sets like this when there
are open standards for data in this format, including all the metadata
hacked on to the top of the ASCII. This makes automated, repeatable
analysis hard to do.

 Probably preaching to the converted here anyway. I have done some
work with the environmental modelling community and they are in their
own little world sometimes with regard to code development (complete
lack of any concept of a revision control system) and standards usage
(ascii in, ascii out). Made me appreciate R even more!

Barry


From franziska.schulze at wiwi.hu-berlin.de  Tue Jan 18 11:47:38 2011
From: franziska.schulze at wiwi.hu-berlin.de (Franziska Schulze)
Date: Tue, 18 Jan 2011 11:47:38 +0100
Subject: [R-sig-Geo] transformin multipart shapefile to singlepart shapefile
Message-ID: <4D356FCA.8080603@wiwi.hu-berlin.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110118/98267a29/attachment.pl>

From research at georgruss.de  Tue Jan 18 12:40:12 2011
From: research at georgruss.de (Georg =?iso-8859-15?B?UnXf?=)
Date: Tue, 18 Jan 2011 12:40:12 +0100
Subject: [R-sig-Geo] transformin multipart shapefile to singlepart
 shapefile
In-Reply-To: <4D356FCA.8080603@wiwi.hu-berlin.de>
References: <4D356FCA.8080603@wiwi.hu-berlin.de>
Message-ID: <20110118114012.GL21818@greode>

On 18/01/11 11:47:38, Franziska Schulze wrote:
> is there a package in R that allows me to split multipart shapefiles in
> singlepart ones? In my shape file there is a region that consists of
> more than one parts. For my spatial econometric analysis, I only need
> one of these parts as the other do not have a particular meaning in my
> context. I read the shapefile using readShapePoly (package maptools).

Hi Franziska,

it would help us if you could provide an example with code. If there's
some standard data in R, try using that (like in the example of
?readShapePoly).

I guess what you want to do can be achieved by leaving the multipart
shapefile intact and instead selecting specific things (those for your
analysis) from that. Probably Roger is going to comment on this. You may
try looking into "Applied Spatial Data Analysis with R", if you haven't
done that so far.

Regards,
Georg.
-- 
Research Assistant
Otto-von-Guericke-Universit?t Magdeburg
research at georgruss.de
http://research.georgruss.de


From b.rowlingson at lancaster.ac.uk  Tue Jan 18 14:11:32 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Tue, 18 Jan 2011 13:11:32 +0000
Subject: [R-sig-Geo] transformin multipart shapefile to singlepart
	shapefile
In-Reply-To: <4D356FCA.8080603@wiwi.hu-berlin.de>
References: <4D356FCA.8080603@wiwi.hu-berlin.de>
Message-ID: <AANLkTikzyxCOR+6FesCxa3wNPfvqFZnJnZ1=25PkFgxJ@mail.gmail.com>

On Tue, Jan 18, 2011 at 10:47 AM, Franziska Schulze
<franziska.schulze at wiwi.hu-berlin.de> wrote:
> Hi,
>
> is there a package in R that allows me to split multipart shapefiles in
> singlepart ones? In my shape file there is a region that consists of
> more than one parts. For my spatial econometric analysis, I only need
> one of these parts as the other do not have a particular meaning in my
> context. I read the shapefile using readShapePoly (package maptools).

 You might find it easier to use a GIS package for this. Quantum GIS
is open source, and has a Multipart-to-singleparts function in its
Vector Geometry Tools menu.

 www,qgis.org - cross platform, open source, reads and writes shapefiles.

 the R method would probably involve deep hacking of the sp data
structures unless someone has already written code to do it. At this
point I expect an email from Roger B to arrive in my Inbox saying
exactly that...

Barry


From Gema.FAviles at uclm.es  Tue Jan 18 15:54:15 2011
From: Gema.FAviles at uclm.es (GEMA FERNANDEZ-AVILES CALDERON)
Date: Tue, 18 Jan 2011 15:54:15 +0100
Subject: [R-sig-Geo] shapefiles + plot
Message-ID: <BFE1525242E7DA4B9CBBDE2CF4DDBBFB9E1BAD@EVSAB01.uclm.es>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110118/128390af/attachment.pl>

From mario.bellinato at gmail.com  Tue Jan 18 17:55:30 2011
From: mario.bellinato at gmail.com (Mario Bellinato)
Date: Tue, 18 Jan 2011 17:55:30 +0100
Subject: [R-sig-Geo] reading into R IPCC data files
In-Reply-To: <AANLkTi=nNg+9uWCbZ_3HhdrVDfSWc5zYGjv_qpC9uzsH@mail.gmail.com>
References: <AANLkTime8gNzpF+19F=SaAtCdxdMtuzaOZ4p3EF5Qg3d@mail.gmail.com>
	<4D330EB0.7020200@noaa.gov>
	<AANLkTik88H+5dp0Rzsus7G+W3PGEgcbv85v3e7CFxvGn@mail.gmail.com>
	<4D332C5C.30901@noaa.gov>
	<AANLkTimDGoQQCTnaSM_Lhd=89yBiMFTQy8=CT=Ocd7Sq@mail.gmail.com>
	<7E6EA3F4372E474F8F3F850DD262FDA903F5B25A50@ExchMailbox3.univ.dir.wwu.edu>
	<1295305444634-5933842.post@n2.nabble.com>
	<AANLkTi=nNg+9uWCbZ_3HhdrVDfSWc5zYGjv_qpC9uzsH@mail.gmail.com>
Message-ID: <AANLkTi=NGP5JOpdZPqWKb86O1q_n11joKCKRQ8DzCmzd@mail.gmail.com>

Thank you for all for your useful suggestions and the interesting
discussion! I am currently trying use Professor Hijmans's code to read
in the same file. I have already encountered one problem though. The
code runs fine until:

b <- rotate(b)

when I get the following error message:

Error in intersectExtent(x, y) : Invalid extent

This is the the RasterBrick object obtained from
b <- setValues(b, d)

b

class       : RasterBrick
filename    :
nlayers     : 12
nrow        : 73
ncol        : 96
ncell       : 7008
projection  : +proj=longlat +datum=WGS84
min value   :  0  0 10  0  0  0  0  0  6  0 ...
max value   : 427 336 324 352 360 396 375 355 323 354 ...
extent      : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)
resolution  : 3.75, 2.465753  (x, y)


Any help would be greatly appreciated! I am running R 2.12.1 on Ubuntu 10.04

Best wishes,

Mario


From r.hijmans at gmail.com  Tue Jan 18 18:51:45 2011
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Tue, 18 Jan 2011 09:51:45 -0800 (PST)
Subject: [R-sig-Geo] reading into R IPCC data files
In-Reply-To: <AANLkTi=NGP5JOpdZPqWKb86O1q_n11joKCKRQ8DzCmzd@mail.gmail.com>
References: <AANLkTime8gNzpF+19F=SaAtCdxdMtuzaOZ4p3EF5Qg3d@mail.gmail.com>
	<4D330EB0.7020200@noaa.gov>
	<AANLkTik88H+5dp0Rzsus7G+W3PGEgcbv85v3e7CFxvGn@mail.gmail.com>
	<4D332C5C.30901@noaa.gov>
	<AANLkTimDGoQQCTnaSM_Lhd=89yBiMFTQy8=CT=Ocd7Sq@mail.gmail.com>
	<7E6EA3F4372E474F8F3F850DD262FDA903F5B25A50@ExchMailbox3.univ.dir.wwu.edu>
	<1295305444634-5933842.post@n2.nabble.com>
	<AANLkTi=nNg+9uWCbZ_3HhdrVDfSWc5zYGjv_qpC9uzsH@mail.gmail.com>
	<AANLkTi=NGP5JOpdZPqWKb86O1q_n11joKCKRQ8DzCmzd@mail.gmail.com>
Message-ID: <1295373105713-5936500.post@n2.nabble.com>


> Thank you for all for your useful suggestions and the interesting 
> discussion! I am currently trying use Professor Hijmans's code to read 
> in the same file. I have already encountered one problem though. The 
> code runs fine until: 

I think this goes away if you update the raster package from CRAN. 

I noticed one other thing that needs to be done. After

b <- brick(nrow=nr, ncol=nc) 

You need to do:

xmin(b) = 0
xmax(b) = 360

And then continue. 

Barry is right in saying that: 

> The important point here is that you say it works on the _one_ file
> you looked at. Probably works on others. You don't know until you've
> tried. It might read it in without giving any errors but get all the
> wrong numbers and then polar bears die.

Although it should not be too hard to fix the script as you muddle along,
you obviously need to very careful. 

R
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/reading-into-R-IPCC-data-files-tp5925687p5936500.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From b.rowlingson at lancaster.ac.uk  Tue Jan 18 19:38:01 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Tue, 18 Jan 2011 18:38:01 +0000
Subject: [R-sig-Geo] shapefiles + plot
In-Reply-To: <BFE1525242E7DA4B9CBBDE2CF4DDBBFB9E1BAD@EVSAB01.uclm.es>
References: <BFE1525242E7DA4B9CBBDE2CF4DDBBFB9E1BAD@EVSAB01.uclm.es>
Message-ID: <AANLkTinOkLWb7BhRNoz7qNqpSJmvZTZ8XLExMD5Ak_Jb@mail.gmail.com>

On Tue, Jan 18, 2011 at 2:54 PM, GEMA FERNANDEZ-AVILES CALDERON
<Gema.FAviles at uclm.es> wrote:
> Dear all:
>
> first of all, thank you very much for helping me to solve the doubts I wrote you in the previous mail.
>
> I've a shapefiles with some variables and I would like to plot a map with the basic descriptives of the variable. How Can I do it?
>
> I am tryining to use "readOGR", but I don't know if it is correct.

 That is one way, but readOGR can read all sorts of geographic data
and can get complicated. You might want to try readShapeSpatial from
the maptools package.

 Install maptools, then help(readShapeSpatial) will give you some examples.

Barry


From r.hijmans at gmail.com  Wed Jan 19 01:54:12 2011
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Tue, 18 Jan 2011 16:54:12 -0800 (PST)
Subject: [R-sig-Geo] transformin multipart shapefile to singlepart
	shapefile
In-Reply-To: <4D356FCA.8080603@wiwi.hu-berlin.de>
References: <4D356FCA.8080603@wiwi.hu-berlin.de>
Message-ID: <1295398452420-5937859.post@n2.nabble.com>


> is there a package in R that allows me to split multipart shapefiles in 
> singlepart ones? In my shape file there is a region that consists of 
> more than one parts

Perhaps the below is useful. I extract the UK from the world's countries,
and create a multi-part polygon.
In the second step I select the largest part, and re-insert that into the
countries object, replacing the original. Just a hack, no guarantees,
perhaps there are more formal methods to accomplish some of this  (e.g.
spRbind in maptools)


library(maptools)
data(wrld_simpl)
plot(wrld_simpl)
x <- wrld_simpl at data[,1] == 'UK'
uk <- wrld_simpl[x,]
pols <- uk at polygons[[1]]@Polygons
islands <- list()
for (i in 1:length(pols)) { islands[i] <- Polygons(list(pols[[i]]), i)    }
islands <- SpatialPolygons(islands)
plot(islands, col=terrain.colors(length(pols)))


# step2
mx <- which.max(sapply(pols, function(x)x at area))
newuk <- Polygons(list(pols[[mx]]), uk at polygons[[1]]@ID)
wrld2 <- wrld_simpl
wrld2 at polygons[x] <- newuk
plot(wrld_simpl, xlim=c(-10, 10), ylim=c(50,60), lwd=3)
plot(wrld2, xlim=c(-10, 10), ylim=c(50,60), border='red', add=TRUE)

-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/transformin-multipart-shapefile-to-singlepart-shapefile-tp5935148p5937859.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From gavan.mcgrath at uwa.edu.au  Wed Jan 19 06:07:00 2011
From: gavan.mcgrath at uwa.edu.au (Gavan McGrath)
Date: Wed, 19 Jan 2011 13:07:00 +0800
Subject: [R-sig-Geo] Had to revert to install of older geosphere package
Message-ID: <AANLkTi=BYqG9E3mN6AfXk+6KV7b0yYwtSmjJphsBweeC@mail.gmail.com>

I could not install geosphere_1.2-18 in R 2.9.2 on Ubuntu - Karmic.
But I could install geosphere_1.2-7.

Here's the log for those who may be interested.

> install.packages("geosphere")
Warning in install.packages("geosphere") :
  argument 'lib' is missing: using
'/home/user/R/x86_64-pc-linux-gnu-library/2.9'
--- Please select a CRAN mirror for use in this session ---
Loading Tcl/Tk interface ... done
trying URL 'http://cran.ms.unimelb.edu.au/src/contrib/geosphere_1.2-18.tar.gz'
Content type 'application/x-tar' length 2488736 bytes (2.4 Mb)
opened URL
==================================================
downloaded 2.4 Mb

* Installing *source* package ?geosphere? ...
** R
** data
** inst
** preparing package for lazy loading
Warning in matchSignature(signature, fdef, where) :
  in the method signature for function "areaPolygon" no definition for
class: ?SpatialPolygons?
Warning in matchSignature(signature, fdef, where) :
  in the method signature for function "centroid" no definition for
class: ?SpatialPolygons?
Warning in matchSignature(signature, fdef, where) :
  in the method signature for function "perimeter" no definition for
class: ?SpatialPolygons?
Warning in matchSignature(signature, fdef, where) :
  in the method signature for function "perimeter" no definition for
class: ?SpatialLines?
Warning in matchSignature(signature, fdef, where) :
  in the method signature for function "span" no definition for class:
?SpatialPolygons?
** help
*** installing help indices
 >>> Building/Updating help pages for package 'geosphere'
     Formats: text html latex example
  alongTrackDistance                text    html    latex   example
  antipode                          text    html    latex   example
  area                              text    html    latex   example
  bearing                           text    html    latex   example
  bearingRhumb                      text    html    latex   example
  centroid                          text    html    latex   example
  data                              text    html    latex
  daylength                         text    html    latex   example
  destPoint                         text    html    latex   example
  destPointRhumb                    text    html    latex   example
  dist2gc                           text    html    latex   example
  dist2line                         text    html    latex   example
  distCosine                        text    html    latex   example
  distHaversine                     text    html    latex   example
Error in file 'distMeeus.Rd':
  \tab this-is-escaped-codenormal-bracket17bracket-normal \tab
this-is-escaped-codenormal-bracket18bracket-normal \tab
this-is-escaped-codenormal-bracket19bracket-normal \cr
does not fit tabular format {rllll}
ERROR: building help failed for package ?geosphere?
* Removing ?/home/user/R/x86_64-pc-linux-gnu-library/2.9/geosphere?

The downloaded packages are in
	?/tmp/RtmpXDFCAs/downloaded_packages?
Warning message:
In install.packages("geosphere") :
  installation of package 'geosphere' had non-zero exit status

-- 
Dr Gavan McGrath
School of Earth and Environment
The University of Western Australia, M087
35 Stirling Highway
Crawley, 6009, AUSTRALIA

Ph: +61 8 64883735
Mob: +614589559765
Fax: +61 8 64881050
email: gmcgrath at cyllene.uwa.edu.au


From franziska.schulze at wiwi.hu-berlin.de  Wed Jan 19 10:45:56 2011
From: franziska.schulze at wiwi.hu-berlin.de (Franziska Schulze)
Date: Wed, 19 Jan 2011 10:45:56 +0100
Subject: [R-sig-Geo] transformin multipart shapefile to singlepart
	shapefile
In-Reply-To: <AANLkTikzyxCOR+6FesCxa3wNPfvqFZnJnZ1=25PkFgxJ@mail.gmail.com>
References: <4D356FCA.8080603@wiwi.hu-berlin.de>
	<AANLkTikzyxCOR+6FesCxa3wNPfvqFZnJnZ1=25PkFgxJ@mail.gmail.com>
Message-ID: <4D36B2D4.4090302@wiwi.hu-berlin.de>

Thanks, it is right, this program provides such features.



Am 18.01.2011 14:11, schrieb Barry Rowlingson:
> On Tue, Jan 18, 2011 at 10:47 AM, Franziska Schulze
> <franziska.schulze at wiwi.hu-berlin.de>  wrote:
>> Hi,
>>
>> is there a package in R that allows me to split multipart shapefiles in
>> singlepart ones? In my shape file there is a region that consists of
>> more than one parts. For my spatial econometric analysis, I only need
>> one of these parts as the other do not have a particular meaning in my
>> context. I read the shapefile using readShapePoly (package maptools).
>   You might find it easier to use a GIS package for this. Quantum GIS
> is open source, and has a Multipart-to-singleparts function in its
> Vector Geometry Tools menu.
>
>   www,qgis.org - cross platform, open source, reads and writes shapefiles.
>
>   the R method would probably involve deep hacking of the sp data
> structures unless someone has already written code to do it. At this
> point I expect an email from Roger B to arrive in my Inbox saying
> exactly that...
>
> Barry


-- 
Dipl.-Vw. Franziska Schulze

Wissenschaftliche Mitarbeiterin

Humboldt-Universit?t zu Berlin
Wirtschaftswissenschaftliche Fakult?t
Lehrstuhl f?r ?konometrie

Spandauer Str. 1
10178 Berlin
Tel.: 0049-(0)30-2093 5705
http://www2.hu-berlin.de/oekonometrie/


From franziska.schulze at wiwi.hu-berlin.de  Wed Jan 19 10:58:24 2011
From: franziska.schulze at wiwi.hu-berlin.de (Franziska Schulze)
Date: Wed, 19 Jan 2011 10:58:24 +0100
Subject: [R-sig-Geo] ordering of data in polygons shapefile
Message-ID: <4D36B5C0.3010307@wiwi.hu-berlin.de>

Hallo,

I still have another question:

I have a polygon shapefile and I want to use it in order to construct my 
neighbors object and listw object to perform spatial econometric tests 
and to estimate a spatial model. The problem ist that the regions in my 
shapefile are not ordered as they should be in order to match with the 
other variables. Therefore, my question is whether it is possible to 
order a spatial polygons data frame with respect to one of its 
attributes. (The attribute is a region id number which has to ordered in 
increasing order.)

Thanks in advance!


From Roger.Bivand at nhh.no  Wed Jan 19 11:12:24 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 19 Jan 2011 11:12:24 +0100 (CET)
Subject: [R-sig-Geo] ordering of data in polygons shapefile
In-Reply-To: <4D36B5C0.3010307@wiwi.hu-berlin.de>
References: <4D36B5C0.3010307@wiwi.hu-berlin.de>
Message-ID: <alpine.LRH.2.00.1101191107030.3569@reclus.nhh.no>

On Wed, 19 Jan 2011, Franziska Schulze wrote:

> Hallo,
>
> I still have another question:
>
> I have a polygon shapefile and I want to use it in order to construct my 
> neighbors object and listw object to perform spatial econometric tests and to 
> estimate a spatial model. The problem ist that the regions in my shapefile 
> are not ordered as they should be in order to match with the other variables. 
> Therefore, my question is whether it is possible to order a spatial polygons 
> data frame with respect to one of its attributes. (The attribute is a region 
> id number which has to ordered in increasing order.)

Yes, it is possible, but it is better practice and much easier to reorder 
the other data, and add it with spCbind() in maptools to the 
SpatialPolygonsDataFrame object. You need to make sure that the match 
between the row.names() of the SpatialPolygonsDataFrame object and the 
row.names() of the additional data stored as a data.frame object is exact. 
Look at the example for ?spCbind for further details. Re-ordering a 
data.frame object is a standard operation in R.

Hope this helps,

Roger

>
> Thanks in advance!
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From franziska.schulze at wiwi.hu-berlin.de  Wed Jan 19 11:16:34 2011
From: franziska.schulze at wiwi.hu-berlin.de (Franziska Schulze)
Date: Wed, 19 Jan 2011 11:16:34 +0100
Subject: [R-sig-Geo] ordering of data in polygons shapefile
In-Reply-To: <alpine.LRH.2.00.1101191107030.3569@reclus.nhh.no>
References: <4D36B5C0.3010307@wiwi.hu-berlin.de>
	<alpine.LRH.2.00.1101191107030.3569@reclus.nhh.no>
Message-ID: <4D36BA02.7050903@wiwi.hu-berlin.de>

I see, the problem is that the other data is properly ordered but the 
shape file is not properly ordered. So, I should mimic the strange 
ordering of the shapefile in my other data than. I think, I will do 
this. Thank you!


Am 19.01.2011 11:12, schrieb Roger Bivand:
> On Wed, 19 Jan 2011, Franziska Schulze wrote:
>
>> Hallo,
>>
>> I still have another question:
>>
>> I have a polygon shapefile and I want to use it in order to construct 
>> my neighbors object and listw object to perform spatial econometric 
>> tests and to estimate a spatial model. The problem ist that the 
>> regions in my shapefile are not ordered as they should be in order to 
>> match with the other variables. Therefore, my question is whether it 
>> is possible to order a spatial polygons data frame with respect to 
>> one of its attributes. (The attribute is a region id number which has 
>> to ordered in increasing order.)
>
> Yes, it is possible, but it is better practice and much easier to 
> reorder the other data, and add it with spCbind() in maptools to the 
> SpatialPolygonsDataFrame object. You need to make sure that the match 
> between the row.names() of the SpatialPolygonsDataFrame object and the 
> row.names() of the additional data stored as a data.frame object is 
> exact. Look at the example for ?spCbind for further details. 
> Re-ordering a data.frame object is a standard operation in R.
>
> Hope this helps,
>
> Roger
>
>>
>> Thanks in advance!
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>


-- 
Dipl.-Vw. Franziska Schulze

Wissenschaftliche Mitarbeiterin

Humboldt-Universit?t zu Berlin
Wirtschaftswissenschaftliche Fakult?t
Lehrstuhl f?r ?konometrie

Spandauer Str. 1
10178 Berlin
Tel.: 0049-(0)30-2093 5705
http://www2.hu-berlin.de/oekonometrie/


From piero.campa at gmail.com  Wed Jan 19 17:56:46 2011
From: piero.campa at gmail.com (piero campa)
Date: Wed, 19 Jan 2011 08:56:46 -0800 (PST)
Subject: [R-sig-Geo] Function to smooth grids using n x n window moving
 average (low-pass filter)
In-Reply-To: <485F9E02.8050403@geo.uu.nl>
References: <485F9E02.8050403@geo.uu.nl>
Message-ID: <1295456206912-5940465.post@n2.nabble.com>


Very quick method Paul,
I tried on my own by simple pixel by pixel computing and the result is much
slower.
Good work.

Anyway I was trying to understand how to yield a small modification to your
code:
having a SpatiaGridDataFrame with NA holes, I noticed that the borderline
pixels turn to NA too (and that's because x + NA = NA in R by default),
letting theholes grow proportionally to the kernel size (just like the
border pixels in a fullgrid data frame).

I was trying to do add the ability to ignore NAs (just like it's in the sum
method with na.rm = TRUE).
I can't find the way however.

Thank for any suggestion !
Cheers,
Piero
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Function-to-smooth-grids-using-n-x-n-window-moving-average-low-pass-filter-tp2765093p5940465.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From r.hijmans at gmail.com  Wed Jan 19 18:14:41 2011
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Wed, 19 Jan 2011 09:14:41 -0800 (PST)
Subject: [R-sig-Geo] Function to smooth grids using n x n window moving
 average (low-pass filter)
In-Reply-To: <1295456206912-5940465.post@n2.nabble.com>
References: <485F9E02.8050403@geo.uu.nl>
	<1295456206912-5940465.post@n2.nabble.com>
Message-ID: <1295457281188-5940533.post@n2.nabble.com>


> I was trying to do add the ability to ignore NAs (just like it's in the sum
method with na.rm = TRUE). 
> I can't find the way however. 

You can also compare with the focal functions in raster; that should support
NA values

library(raster)
r  = raster(meuse.grid, "log.zinc")
rf = focal(r, 3)
 

-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Function-to-smooth-grids-using-n-x-n-window-moving-average-low-pass-filter-tp2765093p5940533.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From E.Couce.07 at bristol.ac.uk  Wed Jan 19 23:50:11 2011
From: E.Couce.07 at bristol.ac.uk (ElenaC)
Date: Wed, 19 Jan 2011 14:50:11 -0800 (PST)
Subject: [R-sig-Geo] How to overlay world map using non-standard projection
Message-ID: <1295477411063-5941681.post@n2.nabble.com>


Dear all,

I have a SpatialGrid (covering the entire world) in geographical coordinates
that I'm trying to transform to equal-area cylindrical projection (such as
given by CRS("+proj=cea +lat ts=30")). I also want to center the plot in the
Pacific and overlay a map of the coasts on top. 

I have successfully transformed my SpatialGrid using the functions
"projectExtent()" and "projectRaster()" from the raster package, and I've
also centered the data where I want. 

Problem is that I've been unable to overlay a map of the world. I've tried
to use the map() function, and I've generated the map I want (right
projection and centered correctly) with the call:

library(maps)
world <-map(projection = "cylequalarea", parameter=30, interior=FALSE,
wrap=TRUE, ylim=c(-60,60),xlim=c(-180,180), orientation=c(90,-205,0))

But when I try to overlay this map on the plot of my transformed SpatialGrid
I find that the scale of both maps is completely different. Their
coordinates don't match:

> bbox(mydata)
         min      max
s1 -17352991 17352991
s2  -6291291  6356742

> range(world$x, na.rm=TRUE)
[1] -2.355834  2.355591
> range(world$y, na.rm=TRUE)
[1] -0.8613535  0.8899210

 Moreover, it looks like it is a different scale factor affecting the 'x'
and 'y' axis. Since the projection I'm trying to use dictates the ratio
between the x and y axis, I don't understand how this can be.

Any suggestion on how to proceed would be greatly appreciated..

Thanks,
Elena
 
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/How-to-overlay-world-map-using-non-standard-projection-tp5941681p5941681.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From malipulla at yahoo.com  Thu Jan 20 00:43:43 2011
From: malipulla at yahoo.com (Leons Mwenda)
Date: Wed, 19 Jan 2011 15:43:43 -0800 (PST)
Subject: [R-sig-Geo] shapefiles + plot
In-Reply-To: <AANLkTinOkLWb7BhRNoz7qNqpSJmvZTZ8XLExMD5Ak_Jb@mail.gmail.com>
References: <BFE1525242E7DA4B9CBBDE2CF4DDBBFB9E1BAD@EVSAB01.uclm.es>
	<AANLkTinOkLWb7BhRNoz7qNqpSJmvZTZ8XLExMD5Ak_Jb@mail.gmail.com>
Message-ID: <917999.3770.qm@web63607.mail.re1.yahoo.com>

Dear all, 
?I need to performe universal kriging using ancillary data. Dependent data 
(variable) is irregular data in projected coordinates. Secondary data 
(independent variable) is image in geographical coordinates system. The problem 
is I am getting error when projecting image that of torrelance exceeds limit. 

Help to fix this



----- Original Message ----
From: Barry Rowlingson <b.rowlingson at lancaster.ac.uk>
To: GEMA FERNANDEZ-AVILES CALDERON <Gema.FAviles at uclm.es>
Cc: r-sig-geo at r-project.org
Sent: Tue, 18 January, 2011 19:38:01
Subject: Re: [R-sig-Geo] shapefiles + plot

On Tue, Jan 18, 2011 at 2:54 PM, GEMA FERNANDEZ-AVILES CALDERON
<Gema.FAviles at uclm.es> wrote:
> Dear all:
>
> first of all, thank you very much for helping me to solve the doubts I wrote 
>you in the previous mail.
>
> I've a shapefiles with some variables and I would like to plot a map with the 
>basic descriptives of the variable. How Can I do it?
>
> I am tryining to use "readOGR", but I don't know if it is correct.

That is one way, but readOGR can read all sorts of geographic data
and can get complicated. You might want to try readShapeSpatial from
the maptools package.

Install maptools, then help(readShapeSpatial) will give you some examples.

Barry

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo






From hacke78 at googlemail.com  Thu Jan 20 11:42:42 2011
From: hacke78 at googlemail.com (Jan Hackenberg)
Date: Thu, 20 Jan 2011 11:42:42 +0100
Subject: [R-sig-Geo] ssplots produces a straight line
Message-ID: <AANLkTik=Yr_Cgfu+WwHVVMiYVGc+3oUWgVdcSe+xk=SH@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110120/af644ac9/attachment.pl>

From p.hiemstra at geo.uu.nl  Thu Jan 20 12:09:40 2011
From: p.hiemstra at geo.uu.nl (Paul Hiemstra)
Date: Thu, 20 Jan 2011 12:09:40 +0100
Subject: [R-sig-Geo] How to overlay world map using non-standard
	projection
In-Reply-To: <1295477411063-5941681.post@n2.nabble.com>
References: <1295477411063-5941681.post@n2.nabble.com>
Message-ID: <4D3817F4.9010706@geo.uu.nl>

Hi Elena,

Look at the spplot function and in particular to the sp.layout argument.

cheers,
Paul

On 01/19/2011 11:50 PM, ElenaC wrote:
> Dear all,
>
> I have a SpatialGrid (covering the entire world) in geographical coordinates
> that I'm trying to transform to equal-area cylindrical projection (such as
> given by CRS("+proj=cea +lat ts=30")). I also want to center the plot in the
> Pacific and overlay a map of the coasts on top.
>
> I have successfully transformed my SpatialGrid using the functions
> "projectExtent()" and "projectRaster()" from the raster package, and I've
> also centered the data where I want.
>
> Problem is that I've been unable to overlay a map of the world. I've tried
> to use the map() function, and I've generated the map I want (right
> projection and centered correctly) with the call:
>
> library(maps)
> world<-map(projection = "cylequalarea", parameter=30, interior=FALSE,
> wrap=TRUE, ylim=c(-60,60),xlim=c(-180,180), orientation=c(90,-205,0))
>
> But when I try to overlay this map on the plot of my transformed SpatialGrid
> I find that the scale of both maps is completely different. Their
> coordinates don't match:
>
>    
>> bbox(mydata)
>>      
>           min      max
> s1 -17352991 17352991
> s2  -6291291  6356742
>
>    
>> range(world$x, na.rm=TRUE)
>>      
> [1] -2.355834  2.355591
>    
>> range(world$y, na.rm=TRUE)
>>      
> [1] -0.8613535  0.8899210
>
>   Moreover, it looks like it is a different scale factor affecting the 'x'
> and 'y' axis. Since the projection I'm trying to use dictates the ratio
> between the x and y axis, I don't understand how this can be.
>
> Any suggestion on how to proceed would be greatly appreciated..
>
> Thanks,
> Elena
>
>    


-- 
Paul Hiemstra, MSc
Department of Physical Geography
Faculty of Geosciences
University of Utrecht
Heidelberglaan 2
P.O. Box 80.115
3508 TC Utrecht
Phone:  +3130 253 5773
http://intamap.geo.uu.nl/~paul
http://nl.linkedin.com/pub/paul-hiemstra/20/30b/770

currently @ KNMI
paul.hiemstra_AT_knmi.nl


From tom.gottfried at wzw.tum.de  Thu Jan 20 13:06:50 2011
From: tom.gottfried at wzw.tum.de (Tom Gottfried)
Date: Thu, 20 Jan 2011 13:06:50 +0100
Subject: [R-sig-Geo] ssplots produces a straight line
In-Reply-To: <AANLkTik=Yr_Cgfu+WwHVVMiYVGc+3oUWgVdcSe+xk=SH@mail.gmail.com>
References: <AANLkTik=Yr_Cgfu+WwHVVMiYVGc+3oUWgVdcSe+xk=SH@mail.gmail.com>
Message-ID: <4D38255A.4050200@wzw.tum.de>

Hi Jan,

the example coordinates you gave actually lie on a straight line:

x <- c(3405540, 3405790, 3407790)
y <- c(5758268, 5758518, 5760518)
plot(x, y)
lines(x[c(1,3)], y[c(1,3)])

regards,
Tom

-- 
Technische Universit?t M?nchen
Department f?r Pflanzenwissenschaften
Lehrstuhl f?r Gr?nlandlehre
Alte Akademie 12
85350 Freising / Germany
Phone: ++49 (0)8161 715324
Fax:   ++49 (0)8161 713243
email: tom.gottfried at wzw.tum.de
http://www.wzw.tum.de/gruenland


From tom.gottfried at wzw.tum.de  Thu Jan 20 13:17:37 2011
From: tom.gottfried at wzw.tum.de (Tom Gottfried)
Date: Thu, 20 Jan 2011 13:17:37 +0100
Subject: [R-sig-Geo] projecting image (was shapefiles + plot)
In-Reply-To: <917999.3770.qm@web63607.mail.re1.yahoo.com>
References: <917999.3770.qm@web63607.mail.re1.yahoo.com>
Message-ID: <4D3827E1.10407@wzw.tum.de>

Dear Leons,

please post some example code to help people understand what you are actually trying to do.

You might want to read this:
http://www.r-project.org/posting-guide.html

Tom

 > Dear all,
 > I need to performe universal kriging using ancillary data. Dependent data
 > (variable) is irregular data in projected coordinates. Secondary data
 > (independent variable) is image in geographical coordinates system. The problem
 > is I am getting error when projecting image that of torrelance exceeds limit.
 >
 > Help to fix this


-- 
Technische Universit?t M?nchen
Department f?r Pflanzenwissenschaften
Lehrstuhl f?r Gr?nlandlehre
Alte Akademie 12
85350 Freising / Germany
Phone: ++49 (0)8161 715324
Fax:   ++49 (0)8161 713243
email: tom.gottfried at wzw.tum.de
http://www.wzw.tum.de/gruenland


From r.hijmans at gmail.com  Thu Jan 20 19:22:31 2011
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Thu, 20 Jan 2011 10:22:31 -0800 (PST)
Subject: [R-sig-Geo] How to overlay world map using non-standard
	projection
In-Reply-To: <1295477411063-5941681.post@n2.nabble.com>
References: <1295477411063-5941681.post@n2.nabble.com>
Message-ID: <1295547751826-5944824.post@n2.nabble.com>


>Problem is that I've been unable to overlay a map of the world. I've tried
to use the map() function, and >I've generated the map I want (right
projection and centered correctly) with the call: 

>library(maps) 
>world <-map(projection = "cylequalarea", parameter=30, interior=FALSE,
wrap=TRUE, ylim=c(->60,60),xlim=c(-180,180), orientation=c(90,-205,0)) 

>But when I try to overlay this map on the plot of my transformed
SpatialGrid I find that the scale of both >maps is completely different.
Their coordinates don't match: 

Perhaps you need to provide more parameters to map() (ellipsoid, datum?), as
it appears that it now uses something equivalent to an ellipsoid with radii
of about ~1 meter 

Robert
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/How-to-overlay-world-map-using-non-standard-projection-tp5941681p5944824.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Roger.Bivand at nhh.no  Thu Jan 20 20:16:44 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 20 Jan 2011 20:16:44 +0100 (CET)
Subject: [R-sig-Geo] How to overlay world map using non-standard
 projection
In-Reply-To: <1295547751826-5944824.post@n2.nabble.com>
References: <1295477411063-5941681.post@n2.nabble.com>
	<1295547751826-5944824.post@n2.nabble.com>
Message-ID: <alpine.LRH.2.00.1101201947370.7506@reclus.nhh.no>

On Thu, 20 Jan 2011, Robert Hijmans wrote:

>
>> Problem is that I've been unable to overlay a map of the world. I've tried
> to use the map() function, and >I've generated the map I want (right
> projection and centered correctly) with the call:
>
>> library(maps)
>> world <-map(projection = "cylequalarea", parameter=30, interior=FALSE,
> wrap=TRUE, ylim=c(->60,60),xlim=c(-180,180), orientation=c(90,-205,0))
>
>> But when I try to overlay this map on the plot of my transformed
> SpatialGrid I find that the scale of both >maps is completely different.
> Their coordinates don't match:
>
> Perhaps you need to provide more parameters to map() (ellipsoid, datum?), as
> it appears that it now uses something equivalent to an ellipsoid with radii
> of about ~1 meter

When the map() function in the maps package calls functions in the mapproj 
package to project geographical coordinates to planar, the output 
coordinates are planar but in a nonstandard metric not documented in that 
package. If you would like control over the coordinates, convert the 
object returned by map() with map2SpatialLines() or map2SpatialPolygons() 
in maptools, and project with spTransform() methods in rgdal instead:

library(maps)
wrld <- map(plot=FALSE, interior=FALSE, wrap=TRUE,
   ylim=c(-60,60),xlim=c(-179.9, 179.9))
# shaving off edges to avoid horizontal line artefact
library(maptools)
wrld_sp <- map2SpatialLines(wrld)
proj4string(wrld_sp) <- CRS("+proj=longlat")
library(rgdal)
cea_wrld_sp <- spTransform(wrld_sp, CRS("+proj=cea +lat_ts=30"))
plot(cea_wrld_sp, axes=TRUE)

I'm assuming that you meant CRS("+proj=cea +lat_ts=30"), where the second 
value is the standard parallel.

Roger

>
> Robert
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From tsippel at gmail.com  Thu Jan 20 21:59:33 2011
From: tsippel at gmail.com (tsippel)
Date: Thu, 20 Jan 2011 10:59:33 -1000
Subject: [R-sig-Geo] Global ocean currents
Message-ID: <AANLkTingFHr3+3DrYjs5A0qVui+aUdiUzrhogESC1LfW@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110120/4dd6bf5f/attachment.pl>

From r.turner at auckland.ac.nz  Thu Jan 20 22:38:17 2011
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Fri, 21 Jan 2011 10:38:17 +1300
Subject: [R-sig-Geo] Warnings: " Window containing simulated patterns is
	not a subset of data window"
Message-ID: <F4EC56B8-D133-43AC-8CF9-44648584CB87@auckland.ac.nz>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110121/b5d8fce9/attachment.pl>

From r.turner at auckland.ac.nz  Fri Jan 21 04:27:27 2011
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Fri, 21 Jan 2011 16:27:27 +1300
Subject: [R-sig-Geo] Warnings: " Window containing simulated patterns is
	not a subset of data window"
In-Reply-To: <F4EC56B8-D133-43AC-8CF9-44648584CB87@auckland.ac.nz>
References: <F4EC56B8-D133-43AC-8CF9-44648584CB87@auckland.ac.nz>
Message-ID: <D6B90E90-91C5-4060-851B-A14B8FAE4895@auckland.ac.nz>


I had a look just now at the data that you sent me.

The problem is pretty obvious --- the window for the ``data''
pattern is not the same as the window for the ``landscape''
pattern.  It is a proper sub-window.

Since the pattern ``data'' is a sub-pattern of the pattern
``landscape'' it is mysterious as to why you changed the
window for ``data'' to something smaller.  Be that as it
may, if you do

	data$window <- landscape$window

then your envelope calculations run without producing any
warnings.

The simulated patterns produced within envelope() will be
patterns on the window corresponding to ``intens'' which
is in turn the window of ``landscape''.  It doesn't really
make sense to compare the (inhomogeneous) K function of
a pattern living in window W_1 with those of patterns living
in window W_2 unless W_1 = W_2.

	cheers,

		Rolf Turner


From mbh02 at live.com  Fri Jan 21 05:37:36 2011
From: mbh02 at live.com (Matthew Hasbrouck)
Date: Thu, 20 Jan 2011 23:37:36 -0500
Subject: [R-sig-Geo] Creating Regions With a Dummy Variable Identifier
Message-ID: <SNT143-w58251E469BAED4C7D413A3C6F80@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110120/f67ddc31/attachment.pl>

From Roger.Bivand at nhh.no  Fri Jan 21 08:11:20 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 21 Jan 2011 08:11:20 +0100 (CET)
Subject: [R-sig-Geo] Creating Regions With a Dummy Variable Identifier
In-Reply-To: <SNT143-w58251E469BAED4C7D413A3C6F80@phx.gbl>
References: <SNT143-w58251E469BAED4C7D413A3C6F80@phx.gbl>
Message-ID: <alpine.LRH.2.00.1101210808420.12857@reclus.nhh.no>

On Thu, 20 Jan 2011, Matthew Hasbrouck wrote:

>
> Hello everyone,
>
> I am a graduate student currently working with census tract data. I have 
> identified census tracts as either having a certain characteristic or 
> not, using a dummy variable. This variable is coded as 1 if the tract 
> has that characteristic and 0 if it doesn't. I would like to take all 
> contiguous tracts coded as 1 and dissolve them into single records. What 
> would be left are all of the original tracts that do not have this 
> characteristic, coded as 0, and records for the larger dissolved areas 
> that contained this characteristic. I originally thought the SKATER 
> function might work, but I don't think it will work properly with a 
> dummy variable.

Please see ?unionSpatialPolygons in maptools. You'll need to construct a 
new set of ID values, with your tracts to be dissolved having the same ID, 
and all the others having their own different IDs. Note the warning about 
the license of gpclib in case you are affected.

Roger

>
> Thanks,
> Matt
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From clementine.fritsch at univ-fcomte.fr  Fri Jan 21 17:48:57 2011
From: clementine.fritsch at univ-fcomte.fr (=?windows-1252?Q?Cl=E9mentine_Fritsch?=)
Date: Fri, 21 Jan 2011 17:48:57 +0100
Subject: [R-sig-Geo] read ascii problem floating point
Message-ID: <4D39B8F9.9080609@univ-fcomte.fr>

I have tried to read an ascii file using ?readAsciiGrid? {maptools} in R 
2.12.0. The z values are incorrect, and I strongly suppose that the 
problem is due to floating point.

Is it possible to specify the number of significant digits in readAsciiGrid?

If not, how could I import my ascii?

Thanks for your help,

Cl?mentine

-- 
Cl?mentine Fritsch
PhD, post-doc researcher
UMR 6249 - Chrono-Environment
University of Franche-Comte
Place Leclerc
F-25030 Besan?on Cedex
FRANCE
E-mail: clementine.fritsch at univ-fcomte.fr
Tel.: +33 (0) 381 665 710
Fax: +33 (0) 381 665 797

-------------- next part --------------
A non-text attachment was scrubbed...
Name: clementine_fritsch.vcf
Type: text/x-vcard
Size: 405 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110121/9bf3ca73/attachment.vcf>

From r.hijmans at gmail.com  Fri Jan 21 17:54:47 2011
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Fri, 21 Jan 2011 08:54:47 -0800 (PST)
Subject: [R-sig-Geo] read ascii problem floating point
In-Reply-To: <4D39B8F9.9080609@univ-fcomte.fr>
References: <4D39B8F9.9080609@univ-fcomte.fr>
Message-ID: <1295628887004-5948458.post@n2.nabble.com>


> I have tried to read an ascii file using ?readAsciiGrid? {maptools} in R 
> 2.12.0. The z values are incorrect, and I strongly suppose that the 
> problem is due to floating point. 

Cl?mentine

If would helpful if you said what is incorrect about the z values. You could
try this alternative route:

library(raster)
r = raster('filename.asc')
plot(r)

# if you want an sp object:
x = as(r, 'SpatialGridDataFrame')

Robert
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/read-ascii-problem-floating-point-tp5948435p5948458.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From piero.campa at gmail.com  Fri Jan 21 18:29:09 2011
From: piero.campa at gmail.com (piero campa)
Date: Fri, 21 Jan 2011 09:29:09 -0800 (PST)
Subject: [R-sig-Geo] Warning: longlat data cannot do quadtree [variogram]
Message-ID: <1295630949848-5948577.post@n2.nabble.com>


Hi all,
I was trying to understand the reason of the above-mentioned warning, which
is thrown as I try to compute (cross-)variograms on a gstat object but I
found no information in this forum nor elsewhere.

The gstat object is built over a SpatialPixelsDataFrame and a
SpatialPointsDataFrame.
The coordinate information is in longlat and the projection is the
following:
projargs: chr " +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs
+towgs84=0,0,0"

Do you have any clue about this?
Thank you,
Piero

-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Warning-longlat-data-cannot-do-quadtree-variogram-tp5948577p5948577.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From clementine.fritsch at univ-fcomte.fr  Fri Jan 21 18:54:34 2011
From: clementine.fritsch at univ-fcomte.fr (=?UTF-8?B?Q2zDqW1lbnRpbmUgRnJpdHNjaA==?=)
Date: Fri, 21 Jan 2011 18:54:34 +0100
Subject: [R-sig-Geo] read ascii problem floating point
In-Reply-To: <1295628887004-5948458.post@n2.nabble.com>
References: <4D39B8F9.9080609@univ-fcomte.fr>
	<1295628887004-5948458.post@n2.nabble.com>
Message-ID: <4D39C85A.9020808@univ-fcomte.fr>

Sorry for the lack of information. My purpose is to export a x,y,z text 
file.

The values in the ascii imported vary from 0.4 to 5.3 while the correct 
values vary from 0.1 to 2402.
I have performed several checking in GRASS and I really think that the 
problem is due to floating point.

The values are correct using your method:

r = raster('filename.asc')
plot(r)

# if you want an sp object:
x = as(r, 'SpatialGridDataFrame')

However, when I have exported a text file of x at data with "write.delim" 
{pgirmess}, the z values in the text file are incorrect (again 0.4 to 
5.3 instead of 0.1 to 2402).

Ideas about how to export ?

Many thanks,

Cl?mentine


Robert Hijmans a ?crit :
>> I have tried to read an ascii file using ?readAsciiGrid? {maptools} in R 
>> 2.12.0. The z values are incorrect, and I strongly suppose that the 
>> problem is due to floating point. 
>>     
>
> Cl?mentine
>
> If would helpful if you said what is incorrect about the z values. You could
> try this alternative route:
>
> library(raster)
> r = raster('filename.asc')
> plot(r)
>
> # if you want an sp object:
> x = as(r, 'SpatialGridDataFrame')
>
> Robert
>   

-- 
Cl?mentine Fritsch
PhD, post-doc researcher
UMR 6249 - Chrono-Environment
University of Franche-Comte
Place Leclerc
F-25030 Besan?on Cedex
FRANCE
E-mail: clementine.fritsch at univ-fcomte.fr
Tel.: +33 (0) 381 665 710
Fax: +33 (0) 381 665 797

-------------- next part --------------
A non-text attachment was scrubbed...
Name: clementine_fritsch.vcf
Type: text/x-vcard
Size: 416 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110121/ce51306b/attachment.vcf>

From r.hijmans at gmail.com  Fri Jan 21 19:20:35 2011
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Fri, 21 Jan 2011 10:20:35 -0800
Subject: [R-sig-Geo] read ascii problem floating point
In-Reply-To: <4D39C85A.9020808@univ-fcomte.fr>
References: <4D39B8F9.9080609@univ-fcomte.fr>
	<1295628887004-5948458.post@n2.nabble.com>
	<4D39C85A.9020808@univ-fcomte.fr>
Message-ID: <AANLkTi=MH3g-X3bH+er1VM1YPg2tQvUnP9jT3-69cFuj@mail.gmail.com>

Cl?mentine,

You could try something like this:

r = raster('filename.asc')
xyv <- cbind(xyFromCell(r, 1:ncell(r)), v=values(r))
write.table(xyv, file='data.txt', row.names=FALSE, sep="\t")

If xyv is correct but the file is not, perhaps the problem is caused
by confusion about the decimal delimiter (perhaps a comma on your
system?)

Robert




2011/1/21 Cl?mentine Fritsch <clementine.fritsch at univ-fcomte.fr>:
> Sorry for the lack of information. My purpose is to export a x,y,z text
> file.
>
> The values in the ascii imported vary from 0.4 to 5.3 while the correct
> values vary from 0.1 to 2402.
> I have performed several checking in GRASS and I really think that the
> problem is due to floating point.
>
> The values are correct using your method:
>
> r = raster('filename.asc')
> plot(r)
>
> # if you want an sp object:
> x = as(r, 'SpatialGridDataFrame')
>
> However, when I have exported a text file of x at data with "write.delim"
> {pgirmess}, the z values in the text file are incorrect (again 0.4 to 5.3
> instead of 0.1 to 2402).
>
> Ideas about how to export ?
>
> Many thanks,
>
> Cl?mentine
>
>
> Robert Hijmans a ?crit :
>>>
>>> I have tried to read an ascii file using ?readAsciiGrid? {maptools} in R
>>> 2.12.0. The z values are incorrect, and I strongly suppose that the problem
>>> is due to floating point.
>>
>> Cl?mentine
>>
>> If would helpful if you said what is incorrect about the z values. You
>> could
>> try this alternative route:
>>
>> library(raster)
>> r = raster('filename.asc')
>> plot(r)
>>
>> # if you want an sp object:
>> x = as(r, 'SpatialGridDataFrame')
>>
>> Robert
>>
>
> --
> Cl?mentine Fritsch
> PhD, post-doc researcher
> UMR 6249 - Chrono-Environment
> University of Franche-Comte
> Place Leclerc
> F-25030 Besan?on Cedex
> FRANCE
> E-mail: clementine.fritsch at univ-fcomte.fr
> Tel.: +33 (0) 381 665 710
> Fax: +33 (0) 381 665 797
>
>


From mbh02 at live.com  Fri Jan 21 23:46:43 2011
From: mbh02 at live.com (Matthew Hasbrouck)
Date: Fri, 21 Jan 2011 17:46:43 -0500
Subject: [R-sig-Geo] Creating Regions With a Dummy Variable Identifier
In-Reply-To: <alpine.LRH.2.00.1101210808420.12857@reclus.nhh.no>
References: <SNT143-w58251E469BAED4C7D413A3C6F80@phx.gbl>,
	<alpine.LRH.2.00.1101210808420.12857@reclus.nhh.no>
Message-ID: <SNT143-w422034F23814C37131E789C6F80@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110121/48013ea6/attachment.pl>

From Roger.Bivand at nhh.no  Sat Jan 22 10:15:39 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 22 Jan 2011 10:15:39 +0100 (CET)
Subject: [R-sig-Geo] Creating Regions With a Dummy Variable Identifier
In-Reply-To: <SNT143-w422034F23814C37131E789C6F80@phx.gbl>
References: <SNT143-w58251E469BAED4C7D413A3C6F80@phx.gbl>,
	<alpine.LRH.2.00.1101210808420.12857@reclus.nhh.no>
	<SNT143-w422034F23814C37131E789C6F80@phx.gbl>
Message-ID: <alpine.LRH.2.00.1101221010470.19886@reclus.nhh.no>


CONTINUES AT FOOT:

On Fri, 21 Jan 2011, Matthew Hasbrouck wrote:

>> Date: Fri, 21 Jan 2011 08:11:20 +0100
>> From: Roger.Bivand at nhh.no
>> To: mbh02 at live.com
>> CC: r-sig-geo at r-project.org
>> Subject: Re: [R-sig-Geo] Creating Regions With a Dummy Variable Identifier
>>
>> On Thu, 20 Jan 2011, Matthew Hasbrouck wrote:
>>
>>>
>>> Hello everyone,
>>>
>>> I am a graduate student currently working with census tract data. I have
>>> identified census tracts as either having a certain characteristic or
>>> not, using a dummy variable. This variable is coded as 1 if the tract
>>> has that characteristic and 0 if it doesn't. I would like to take all
>>> contiguous tracts coded as 1 and dissolve them into single records. What
>>> would be left are all of the original tracts that do not have this
>>> characteristic, coded as 0, and records for the larger dissolved areas
>>> that contained this characteristic. I originally thought the SKATER
>>> function might work, but I don't think it will work properly with a
>>> dummy variable.
>>
>> Please see ?unionSpatialPolygons in maptools. You'll need to construct a
>> new set of ID values, with your tracts to be dissolved having the same ID,
>> and all the others having their own different IDs. Note the warning about
>> the license of gpclib in case you are affected.
>>
>> Roger
>>
>>>
>>> Thanks,
>>> Matt
>
>
> I think I understand a way to do this using unionSpatialPolygons if I
> have a fairly small number of tracts.  I could view a map of the dummy
> variable and manually give a unique ID to all tracts in a particular
> cluster.  I could continue doing that for all other clusters.  Then I
> could save the shapefile and union them in R.  The problem is
> that I am dealing with over 9,000 tracts in 91 cities.  Is there a
> systematic way to identify all of the contiguous 1's (on the dummy
> variable) and give them an ID?
>

So you have two questions, not one? You want to identify contiguous groups 
of 1s on the dummy, and group them into separate Polygons objects, and 
then merge the m contiguous groups so identified. I suggest subsetting the 
input object to just the 1s, then use poly2nb() to get the contiguities, 
next n.comp.nb() to identify the groups, unionSpatialPolygons() them, and 
spRbind() back the 0s. I would have liked to provide an example but have 
to rush ...

Hope this helps,

Roger



> Thanks,
> Matt
>
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From patrick.giraudoux at univ-fcomte.fr  Sat Jan 22 11:18:20 2011
From: patrick.giraudoux at univ-fcomte.fr (Patrick Giraudoux)
Date: Sat, 22 Jan 2011 11:18:20 +0100
Subject: [R-sig-Geo] lattice, xyplot, sp,
 spplot: is it possible to fix maximum and minimum values in the key
 ?
Message-ID: <4D3AAEEC.1040300@univ-fcomte.fr>

Hi,

Does anybody knows if it is possible to fix user defined maximum and 
minimum values in the key of a xyplot (or spplot) graphics ? I have a 
set of seperate drawings and I would like to keep the same color scheme 
between fixed values for all of them (which looks like being not 
possible, autokey normally adapting the range of colors to the 
particular range of values in each plot.

Patrick


From patrick.giraudoux at univ-fcomte.fr  Sat Jan 22 11:38:39 2011
From: patrick.giraudoux at univ-fcomte.fr (Patrick Giraudoux)
Date: Sat, 22 Jan 2011 11:38:39 +0100
Subject: [R-sig-Geo] spplot and labels
Message-ID: <4D3AB3AF.5090206@univ-fcomte.fr>

Hi again,

I am working with spplot and would like to draw labels on a number if 
items. I supposed that one must use the layout arguments of spplot, but 
I understand from the doc that  sp.text(loc, txt, ...) can be used only 
for one location and not for a matrix of locations (as the 'classical' 
text function does in the package base).

Is there a way to pass a matrix of locations + labels to the layout 
argument ?

Thanks in advance,

Patrick


From patrick.giraudoux at univ-fcomte.fr  Sat Jan 22 15:49:55 2011
From: patrick.giraudoux at univ-fcomte.fr (Patrick Giraudoux)
Date: Sat, 22 Jan 2011 15:49:55 +0100
Subject: [R-sig-Geo] spplot and labels
In-Reply-To: <4D3AB3AF.5090206@univ-fcomte.fr>
References: <4D3AB3AF.5090206@univ-fcomte.fr>
Message-ID: <4D3AEE93.3060905@univ-fcomte.fr>

Le 22/01/2011 11:38, Patrick Giraudoux a ?crit :
> Hi again,
>
> I am working with spplot and would like to draw labels on a number if 
> items. I supposed that one must use the layout arguments of spplot, 
> but I understand from the doc that  sp.text(loc, txt, ...) can be used 
> only for one location and not for a matrix of locations (as the 
> 'classical' text function does in the package base).
>
> Is there a way to pass a matrix of locations + labels to the layout 
> argument ?
>
> Thanks in advance,
>
> Patrick
>
>
>


Sorry to respond to myself, but I got the trick. Just use ltext. Eg

pv<-data.frame(coordinates(ZonesFrancis),pv)
SpPv<-list("ltext",pv[,1:2],labels=round(pv[,4],2))

then:

spplot(FCgrid.sp,z=2,col.regions=mypal,sp.layout=list(SpPv))


From zenlines at gmail.com  Sat Jan 22 17:40:06 2011
From: zenlines at gmail.com (Brian Oney)
Date: Sat, 22 Jan 2011 17:40:06 +0100
Subject: [R-sig-Geo] extract function - return the ID of the polygon
Message-ID: <4D3B0866.70006@gmail.com>

Hello list,
I would like to know how to also reurn the ID of the polygon when using 
the 'extract' function to extract raster cell values.
Honestly, I am just extracting and using the cell numbers to extract 
values for these polygons in other raster layers for the same extent, 
because it is so much faster.
Right now the one idea I have for the raster package would be to 
rasterize the polygons and then extract using the same polygons and then 
take the cell numbers and their values so that I would have a cell with 
a value for the polygon to which it corresponds.

poly.rast <- rasterize(poly, rast, field=c(poly$FID))
ex <- extract(poly.rast, poly, cellnumbers=T)

I don't know how this would work with much larger files. My current 
operation corresponds to ~12000 cells and could be faster.
Could be the problem that it is saturday and my brain is refusing to work...

A function that might be handy (and fast) in the future might be of the 
cellFrom* function family (with an argument to carry over a polygon 
field ID etc.).
Thanks for the help!
Best,
Brian


From edzer.pebesma at uni-muenster.de  Sat Jan 22 22:51:59 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sat, 22 Jan 2011 22:51:59 +0100
Subject: [R-sig-Geo] lattice, xyplot, sp,
 spplot: is it possible to fix maximum and minimum values in the key
 ?
In-Reply-To: <4D3AAEEC.1040300@univ-fcomte.fr>
References: <4D3AAEEC.1040300@univ-fcomte.fr>
Message-ID: <4D3B517F.2050302@uni-muenster.de>



On 01/22/2011 11:18 AM, Patrick Giraudoux wrote:
> Hi,
> 
> Does anybody knows if it is possible to fix user defined maximum and
> minimum values in the key of a xyplot (or spplot) graphics ? I have a
> set of seperate drawings and I would like to keep the same color scheme
> between fixed values for all of them (which looks like being not
> possible, autokey normally adapting the range of colors to the
> particular range of values in each plot.

If your object is of class SpatialPointsDataFrame, it may suffice to
pass the argument "cuts" with the vector of cuts. If it is
grid/polygons/lines, use the "at" component of the "colorkey" argument
to specify breaks; see ?levelplot in package lattice.

> 
> Patrick
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From r.hijmans at gmail.com  Sat Jan 22 22:59:18 2011
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Sat, 22 Jan 2011 13:59:18 -0800 (PST)
Subject: [R-sig-Geo] extract function - return the ID of the polygon
In-Reply-To: <4D3B0866.70006@gmail.com>
References: <4D3B0866.70006@gmail.com>
Message-ID: <1295733558191-5951691.post@n2.nabble.com>


Brian,

> I would like to know how to also reurn the ID of the polygon when using 
> the 'extract' function to extract raster cell values. 

The values are returned in the order of the polygons. So the IDs would be
1:n, or in your example, poly$FID. Isn't that enough?

> I am just extracting and using the cell numbers to extract 
> values for these polygons in other raster layers for the same extent, 
> because it is so much faster. 

It would also be much faster to make a RasterStack and use 'extract' only
once.

>rasterize the polygons and then extract using the same polygons and then 
>take the cell numbers and their values so that I would have a cell with 
>a value for the polygon to which it corresponds. 

That works if the polygons do not overlap. 'extract' also works if the
polygons do overlap.

If you go along your route, which could be handy if you repeatedly want to
extract values, I think I would first do 'rasterize' (once), but then
(repeatedly) use 'zonal', or perhaps 'crosstab'.

> A function that might be handy (and fast) in the future might be of the 
> cellFrom* function family 

I agree. I think I'll add cellFromPolygons and cellFromLines

Best, Robert


-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/extract-function-return-the-ID-of-the-polygon-tp5951128p5951691.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From chethanuniversal at gmail.com  Sun Jan 23 04:20:33 2011
From: chethanuniversal at gmail.com (Chethan S)
Date: Sun, 23 Jan 2011 08:50:33 +0530
Subject: [R-sig-Geo] Madogram, rodogram, semi-variogram of satellite imagery
Message-ID: <AANLkTikj+fG2MHTOuRfshdrom0Of34paj-gC43Q_E_yS@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110123/89b5e17a/attachment.pl>

From yichingtree at gmail.com  Sun Jan 23 08:03:58 2011
From: yichingtree at gmail.com (Yiching Lin)
Date: Sun, 23 Jan 2011 15:03:58 +0800
Subject: [R-sig-Geo] (no subject)
Message-ID: <AANLkTinp=ucq1FxJfVH42pjYob6KsHfTxCtZdEbvzQgQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110123/6dc1fcd4/attachment.pl>

From edzer.pebesma at uni-muenster.de  Sun Jan 23 18:01:00 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sun, 23 Jan 2011 18:01:00 +0100
Subject: [R-sig-Geo] Warning: longlat data cannot do quadtree [variogram]
In-Reply-To: <1295630949848-5948577.post@n2.nabble.com>
References: <1295630949848-5948577.post@n2.nabble.com>
Message-ID: <4D3C5ECC.4030002@uni-muenster.de>

You can ignore it.

gstat builds quadtrees (or oct-trees in 3d) to efficiently find out
which observations are near others. For data on the sphere, using great
circle distance, this does not work, at least as far as I can see.

I would agree that the warning message is, well, somewhat cryptic.

On 01/21/2011 06:29 PM, piero campa wrote:
> 
> Hi all,
> I was trying to understand the reason of the above-mentioned warning, which
> is thrown as I try to compute (cross-)variograms on a gstat object but I
> found no information in this forum nor elsewhere.
> 
> The gstat object is built over a SpatialPixelsDataFrame and a
> SpatialPointsDataFrame.
> The coordinate information is in longlat and the projection is the
> following:
> projargs: chr " +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs
> +towgs84=0,0,0"
> 
> Do you have any clue about this?
> Thank you,
> Piero
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From e.jahanshiri at gmail.com  Sun Jan 23 20:43:09 2011
From: e.jahanshiri at gmail.com (Ebrahim Jahanshiri)
Date: Sun, 23 Jan 2011 23:13:09 +0330
Subject: [R-sig-Geo] Spatio-temporal regression in spdep
Message-ID: <AANLkTimsPFg6jz_ji5-ff2-oh==V2pq7gxF-o9H5hMXg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110123/c12089b9/attachment.pl>

From ashton at msu.edu  Mon Jan 24 05:14:15 2011
From: ashton at msu.edu (Ashton Shortridge)
Date: Sun, 23 Jan 2011 23:14:15 -0500
Subject: [R-sig-Geo] Madogram, rodogram,
	semi-variogram of satellite imagery
In-Reply-To: <AANLkTikj+fG2MHTOuRfshdrom0Of34paj-gC43Q_E_yS@mail.gmail.com>
References: <AANLkTikj+fG2MHTOuRfshdrom0Of34paj-gC43Q_E_yS@mail.gmail.com>
Message-ID: <201101232314.15803.ashton@msu.edu>

Hi Chethan,

The fields library does variograms efficiently on images. Check out the 
vgram.matrix function in there.

Cressie's robust variogram is already implemented, while madograms (or 
rodograms) are not implemented. However, the vgram.matrix function is basic R. 
I modified it readily to calculate madograms (R file with implemented function 
is attached); you could implement rodograms as easily. As far as I know cross-
variograms are not implemented in fields.

Here is an example using the modified function (attached):
library(fields)
data(lennon)
image(lennon)

source("madogram_fields.R")   # loads a modified function called vgram2.matrix()
out2 <- vgram2.matrix(lennon)
plot(out2$d.full, out2$madgram, xlab="separation distance", ylab="madogram")
title(main="Madogram for Lennon Image")

Hope this helps,

Ashton


On 2011-01-22, Chethan S, wrote:
> Greetings!
> 
> I am cross-posting this query here as suggested by R-Help list.
> 
> Is there in any package for R which can help me generate madogram,
> rodogram, semi-variogram, cross variogram from landsat imagery. I intend
> to select portions of large imagery (i.e., obtain subsets) and generate
> the above said texture layers. A simple Google search led to me a result
> suggesting SpatialExtremes for generating madograms. However I am not sure
> about its capability to generate one for image layers. I am a beginner
> level user in R and that's why I am posting this question to give me a
> quick start.
> 
> Thanks and regards,
> 
> Chethan S.


-----
Ashton Shortridge
Associate Professor			ashton at msu.edu
Dept of Geography			http://www.msu.edu/~ashton
235 Geography Building		ph (517) 432-3561
Michigan State University		fx (517) 432-1671
-------------- next part --------------

vgram2.matrix <- function (dat, R = 5, dx = 1, dy = 1) 
{
    # This function is a slight modification of vgram.matrix() in the 
    # fields library to calculate a madogram on matrix (image) data.
    # In fact, only two lines were added! Check help on vgram.matrix 
    # for more information. Requires the fields library. 
    # Written by Ashton Shortridge, 1/2011
    SI <- function(ntemp, delta) {
        n1 <- 1:ntemp
        n2 <- n1 + delta
        good <- (n2 >= 1) & (n2 <= ntemp)
        cbind(n1[good], n2[good])
    }
    N <- ncol(dat)
    M <- nrow(dat)
    m <- min(c(round(R/dx), M))
    n <- min(c(round(R/dy), N))
    ind <- rbind(as.matrix(expand.grid(0, 1:n)), as.matrix(expand.grid(1:m, 
        0)), as.matrix(expand.grid(c(-(m:1), 1:m), 1:n)))
    d <- sqrt((dx * ind[, 1])^2 + (dy * ind[, 2])^2)
    good <- (d > 0) & (d <= R)
    ind <- ind[good, ]
    d <- d[good]
    ind <- ind[order(d), ]
    d <- sort(d)
    nbin <- nrow(ind)
    holdVG <- rep(NA, nbin)
    holdMG <- rep(NA, nbin)
    holdRVG <- rep(NA, nbin)
    holdN <- rep(NA, nbin)
    for (k in 1:nbin) {
        MM <- SI(M, ind[k, 1])
        NN <- SI(N, ind[k, 2])
        holdN[k] <- length(MM) * length(NN)
        BigDiff <- (dat[MM[, 1], NN[, 1]] - dat[MM[, 2], NN[, 
            2]])
        holdVG[k] <- mean(0.5 * (BigDiff)^2)   # variogram
        holdMG[k] <- mean(0.5 * abs(BigDiff))  # madogram
        holdRVG[k] <- mean(abs(BigDiff)^0.5)   # Cressie & Hawkins
    }
    holdRVG <- 0.5 * (holdRVG^4)/(0.457 + 0.494 * holdN)
    top <- tapply(holdVG * holdN, d, FUN = "sum")
    bottom <- tapply(holdN, d, FUN = "sum")
    dcollapsed <- as.numeric(names(bottom))
    vgram <- top/bottom
    dimnames(vgram) <- NULL
    list(vgram = vgram, d = dcollapsed, ind = ind, d.full = d, 
        vgram.full = holdVG, robust.vgram = holdRVG, madgram = holdMG, 
        N = holdN, dx = dx, dy = dy)
}

From jeffrey.stratford at wilkes.edu  Sun Jan 23 22:25:27 2011
From: jeffrey.stratford at wilkes.edu (Stratford, Jeffrey)
Date: Sun, 23 Jan 2011 16:25:27 -0500
Subject: [R-sig-Geo] difficulty converting DDD to UTM (PBSmapping/convUL)
In-Reply-To: <4D32F515.2080405@wzw.tum.de>
References: <406664.38148.qm@web63601.mail.re1.yahoo.com>
	<4D32F515.2080405@wzw.tum.de>
Message-ID: <72B2B2BDFE51E64DAC638149561498000696AE5C@STAFFEXCHVS3.wilkesu.wilkes.edu>

Hi everyone,

I am attempting to convert points in DDD to UTM (zone 18) using
PBSmapping and I'm getting an error message. 

The code and output:

library(PBSmapping)
dd_sosp <- read.csv("g:\\sosp\\2010\\sosp2010coord.csv", header=T)
attr(dd_sosp, "zone") <- 18
str(dd_sosp)

'data.frame':   109 obs. of  2 variables:
 $ X: num  -75.8 -75.9 -75.8 -75.8 -75.8 ...
 $ Y: num  41.6 41.2 41.2 41.2 41.2 ...

sospUTM <- convUL(dd_sosp)
Error in convUL(dd_sosp) : Missing or invalid projection attribute

Any suggestions to getting this run?

Thanks,

Jeff
*****************************************
Jeffrey A. Stratford, Ph.D.
Department of Health and Biological Sciences
84 W. South St.
Wilkes Univertsity, PA 18766
570-332-2942
http://web.wilkes.edu/jeffrey.stratford/


From jeffrey.stratford at wilkes.edu  Mon Jan 24 03:26:39 2011
From: jeffrey.stratford at wilkes.edu (Stratford, Jeffrey)
Date: Sun, 23 Jan 2011 21:26:39 -0500
Subject: [R-sig-Geo] difficulty converting DDD to UTM): closer
Message-ID: <72B2B2BDFE51E64DAC638149561498000696AE90@STAFFEXCHVS3.wilkesu.wilkes.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110123/181a2427/attachment.pl>

From sjmyers at syr.edu  Mon Jan 24 04:41:13 2011
From: sjmyers at syr.edu (Seth J Myers)
Date: Mon, 24 Jan 2011 03:41:13 +0000
Subject: [R-sig-Geo] quick question on geary.test in spdep
Message-ID: <39F57DD4924BF64CA2C2F67CBAC97AB30221F1@BL2PRD0103MB007.prod.exchangelabs.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110124/bb815591/attachment.pl>

From Roger.Bivand at nhh.no  Mon Jan 24 09:28:12 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 24 Jan 2011 09:28:12 +0100 (CET)
Subject: [R-sig-Geo] Spatio-temporal regression in spdep
In-Reply-To: <AANLkTimsPFg6jz_ji5-ff2-oh==V2pq7gxF-o9H5hMXg@mail.gmail.com>
References: <AANLkTimsPFg6jz_ji5-ff2-oh==V2pq7gxF-o9H5hMXg@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1101240920540.29331@reclus.nhh.no>

On Sun, 23 Jan 2011, Ebrahim Jahanshiri wrote:

> Dear list
>
> I want to extend the spatial regression functions in spdep to do
> spatiotemporal regression. That is, instead of lambaW (lambda is
> autocorrelation parameter, W is the weighting matrix) I partition W to
> spatial(S), temporal(T) and spatial temporal (ST and TS) weight matrices
> (phi1S+phi2T+phi3ST+phi4TS) I am working to implement this inside the code
> for the ?spautolm?, It uses optimize method to get a value for lambda that
> maximizes the logliklihood fuction for the family chosen however I am
> puzzled as how to make the code ?optimize? for 4 parameters instead of one
> (also the meaning of ?.opt.fit? in the optimize formula), also how to make
> the logLik work for this type of the algorithm. I would appreciate even the
> smallest of clues.

?optimize (it does line search, so your surprise is unwarranted). If you 
really want to do this, please find a good, existing, open-source 
implementation to compare with, and re-implement from the ground up. Using 
spautolm(), which is only for a single spatial coefficient, will confuse 
you more than help you. In particular, you need to be very careful with 
the numerical optimization, as very often a naive implementation of a 
log-likelihood function is affected by scaling issues. I'm pretty certain 
that your ST and TS will mimic each other, and the optimizer will find it 
very hard to grasp your intentions (two local optima). You need to spend a 
lot of time with well-studied examples (and I don't think there are any or 
many such).

Have you looked at the work already done in the splm package on R-Forge?

Try to set this up in a Bayesian context in parallel, to get a sanity 
check on any results you think you have achieved.

Hope this helps,

Roger

>
> Ebrahim Jahanshiri
>
> UPM, ITMA,
>
> Spatial and Numerical lab.
>
> 	[[alternative HTML version deleted]]
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Mon Jan 24 09:44:23 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 24 Jan 2011 09:44:23 +0100 (CET)
Subject: [R-sig-Geo] quick question on geary.test in spdep
In-Reply-To: <39F57DD4924BF64CA2C2F67CBAC97AB30221F1@BL2PRD0103MB007.prod.exchangelabs.com>
References: <39F57DD4924BF64CA2C2F67CBAC97AB30221F1@BL2PRD0103MB007.prod.exchangelabs.com>
Message-ID: <alpine.LRH.2.00.1101240934480.29331@reclus.nhh.no>

On Mon, 24 Jan 2011, Seth J Myers wrote:

> Hi,
>
>> From R documentation, the default alternative hypothesis for moran.test 
>> in spdep is "greater" which leads me to think that the null hypothesis 
>> is then "less than or equal to zero" or no or negative autocorr.  A 
>> small p-value for this test would indicate a rejection of the null and 
>> support for positive spatial autocorrelation as measured by Moran's I. 
>> Is this correct so far?
>
> Geary's C stat as calculated by geary.test has a default alt. hypothesis 
> "greater" as well.  However, the expected value for Geary's C is 1 and 
> values below this indicates positive autocorrelation and values above 1 
> indicate negative autocorrelation.  So, it seems the null as a default 
> is "less than or equal to 1" (positive or no autocorr).  A small p-value 
> would then indicate support for negative autocorrelation.  Is this 
> correct?
>
> If I am reading the documentation correctly and asking an obvious 
> question, I am sorry.  It is confusing to me because I would expect the 
> default alternative hypotheses of the two tests to have p-values with 
> similar interpretations.

Since June 2009, geary.test() reports (EC - C) / sqrt(VC) as the standard 
deviate, replacing the previous, more usual, (C - EC) / sqrt(VC), and now 
agrees with Cliff & Ord (1973, p. 21). I've added further explanation on 
the help page. This means that the "greater" alternative for the Geary C 
test corresponds to the "greater" alternative for Moran's I test. The 
other possibility - not following Cliff & Ord - would be to do as you 
suggest, but it seems better to stay with their decision to change the 
sign for the standard deviate.

Hope this clarifies,

Roger



>
> Thanks, Seth
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From clementine.fritsch at univ-fcomte.fr  Mon Jan 24 11:54:21 2011
From: clementine.fritsch at univ-fcomte.fr (=?windows-1252?Q?Cl=E9mentine_Fritsch?=)
Date: Mon, 24 Jan 2011 11:54:21 +0100
Subject: [R-sig-Geo] read ascii problem floating point
In-Reply-To: <4D39B8F9.9080609@univ-fcomte.fr>
References: <4D39B8F9.9080609@univ-fcomte.fr>
Message-ID: <4D3D5A5D.5030007@univ-fcomte.fr>

Hi,

My purpose was to export a x,y,z text file from an ASCII file, and I 
encountered some problems due to floating point. The values of z were 
incorrect in the output file.

I have found a solution with the help of Robert Hijmans and Patrick 
Giraudoux. It is necessary to specify the number of significant digits 
using signif().

For instance:

library(raster)

r<-raster("data.asc")

xyv <- cbind(xyFromCell(r, 1:ncell(r)), v=signif(values(r), digits=2))

write.table(xyv, file="data.txt", row.names=FALSE, sep="\t",dec=".")


Regards,

Cl?mentine



Cl?mentine Fritsch a ?crit :
> I have tried to read an ascii file using ?readAsciiGrid? {maptools} in 
> R 2.12.0. The z values are incorrect, and I strongly suppose that the 
> problem is due to floating point.
>
> Is it possible to specify the number of significant digits in 
> readAsciiGrid?
>
> If not, how could I import my ascii?
>
> Thanks for your help,
>
> Cl?mentine
>

-- 
Cl?mentine Fritsch
PhD, post-doc researcher
UMR 6249 - Chrono-Environment
University of Franche-Comte
Place Leclerc
F-25030 Besan?on Cedex
FRANCE
E-mail: clementine.fritsch at univ-fcomte.fr
Tel.: +33 (0) 381 665 710
Fax: +33 (0) 381 665 797

-------------- next part --------------
A non-text attachment was scrubbed...
Name: clementine_fritsch.vcf
Type: text/x-vcard
Size: 405 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110124/90ee5315/attachment.vcf>

From gianni.lavaredo at gmail.com  Mon Jan 24 15:15:26 2011
From: gianni.lavaredo at gmail.com (gianni lavaredo)
Date: Mon, 24 Jan 2011 15:15:26 +0100
Subject: [R-sig-Geo] Help to move grid location in scatterplot3d
Message-ID: <AANLkTi=X5prrF4KjWbYmOLVHEan0awyOqEZuRqN_=ao5@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110124/773f2cf5/attachment.pl>

From piero.campa at gmail.com  Mon Jan 24 15:26:01 2011
From: piero.campa at gmail.com (piero campa)
Date: Mon, 24 Jan 2011 06:26:01 -0800 (PST)
Subject: [R-sig-Geo] Warning: longlat data cannot do quadtree [variogram]
In-Reply-To: <4D3C5ECC.4030002@uni-muenster.de>
References: <1295630949848-5948577.post@n2.nabble.com>
	<4D3C5ECC.4030002@uni-muenster.de>
Message-ID: <1295879161447-5955291.post@n2.nabble.com>


Don't worry Edzer, I'm still (and will be) eternally graceful for your hard
work.

Anyway, if I got it, then transforming the data to some XY-based coordinate
system (let's say EPSG:900913 ?) would let the gstat object exploit the
quadtrees optimization ?
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Warning-longlat-data-cannot-do-quadtree-variogram-tp5948577p5955291.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From tgriffin at uaex.edu  Mon Jan 24 15:48:35 2011
From: tgriffin at uaex.edu (Terry Griffin)
Date: Mon, 24 Jan 2011 08:48:35 -0600 (CST)
Subject: [R-sig-Geo] difficulty converting DDD to UTM): closer
In-Reply-To: <72B2B2BDFE51E64DAC638149561498000696AE90@STAFFEXCHVS3.wilkesu.wilkes.edu>
Message-ID: <29719933.131295880506234.JavaMail.SYSTEM@TGriffinWS>



----- Original Message -----
From: "Jeffrey Stratford" <jeffrey.stratford at wilkes.edu>
To: r-sig-geo at r-project.org
Sent: Sunday, January 23, 2011 8:26:39 PM GMT -06:00 US/Canada Central
Subject: [R-sig-Geo] difficulty converting DDD to UTM): closer

Hi everyone,

 

I've gotten closer to a solution but there's still something wonky going
on.  Here's the new code I'm using 

 

dd_sosp <- read.csv("g:\\sosp\\2010\\sosp2010coord.csv", header=T)

names(dd_sosp) <- c("X","Y") 

attr(dd_sosp, "projection") <- c("LL") 

sosp.utm <- convUL(dd_sosp)

 

The output is clearly wrong:

 

> sosp.utm

           X        Y

1   430.1917 4600.661

2   424.6950 4566.313

3   432.0162 4560.321

4   430.0987 4561.664

 

Here's the raster information and the points fall should within

# class       : Extent 

# xmin        : 1620430 

# xmax        : 1699212 

# ymin        : 2182993 

# ymax        : 2264400

 

Any ideas?

 

Also, I'm not sure why I see UTM coordinates between programs.  On
Google Earth, my coordinates might be 457536.61 m E,  4543110.30 m N but
this seems to be entirely different for positions associated with the
numbers I'm giving for my raster.  

 

Thanks for your patience!  

 

*****************************************

Jeffrey A. Stratford, Ph.D.

Department of Health and Biological Sciences

84 W. South St.

Wilkes Univertsity, PA 18766

570-332-2942

http://web.wilkes.edu/jeffrey.stratford/

*****************************************




	[[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


Hi Jeffrey,

If you are willing to try rgdal rather than PBSmapping, 

library(rgdal)


dd_sosp <- read.csv("g:\\sosp\\2010\\sosp2010coord.csv", header=T)

names(dd_sosp) <- c("X","Y") 

xycoords<-cbind(dd_sosp$X,dd_sosp$Y)

utm.m<-project(xycoords, "+proj=utm +north +zone=18")

colnames(utm.m)<-c("easting","northing")

data<-cbind(utm.m,ymd.data2)

head(data)


Terry Griffin, Ph.D.
Assistant Professor - Economics
University of Arkansas - Division of Agriculture
501.671.2182
tgriffin at uaex.edu


From piero.campa at gmail.com  Mon Jan 24 16:47:53 2011
From: piero.campa at gmail.com (piero campa)
Date: Mon, 24 Jan 2011 07:47:53 -0800 (PST)
Subject: [R-sig-Geo] Support size in gstat object
Message-ID: <1295884073657-5955513.post@n2.nabble.com>


Hi,
I couldn't find on ?gstat, ?predict.gstat nor here the answers to these
little doubts:

:: Having to build a gstat object with a SpatialPixelsDataFrame and a
SpatialPointsDataFrame, does the gstat object automatically recognize the
supoprt size of the two variables? (That is a block of same dimensions of
the cell size in the SPixelsDF, and a point for the SPointsDF instead)

:: Having then to predict a block co-kriged map on an output grid (again a
SpatialPixelsDataFrame object) with its own cell size, do I have to
explicitly specify the block or does the predict.gstat method automatically
compute block co-kriging?

I think I know the answers but I would feel better with 100% certainty.
Thank you all,
Piero
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Support-size-in-gstat-object-tp5955513p5955513.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From zenlines at gmail.com  Mon Jan 24 19:26:09 2011
From: zenlines at gmail.com (Brian Oney)
Date: Mon, 24 Jan 2011 19:26:09 +0100
Subject: [R-sig-Geo] extract function - return the ID of the polygon
In-Reply-To: <4D3B0866.70006@gmail.com>
References: <4D3B0866.70006@gmail.com>
Message-ID: <4D3DC441.6090900@gmail.com>

Hello Roger,
Using the extract function with a stack is exactly what I am doing. It 
is a handly little tool. Essentially one of the few ways (that I know) 
to handle large files from which a (much smaller) specific subset is 
required, while remaining within the limits of R and a laptop.

I would have used the poly$FID or 1:N(polygons) and did at first but 
found that the numbers of my polygons did not match up. Looking back now 
it was probably operator error. Sometimes a foolproof method is better 
when the computer is working better than the brain.

thanks for the handy package.

cheers,
Brian

On 1/22/2011 5:40 PM, Brian Oney wrote:
> Hello list,
> I would like to know how to also reurn the ID of the polygon when 
> using the 'extract' function to extract raster cell values.
> Honestly, I am just extracting and using the cell numbers to extract 
> values for these polygons in other raster layers for the same extent, 
> because it is so much faster.
> Right now the one idea I have for the raster package would be to 
> rasterize the polygons and then extract using the same polygons and 
> then take the cell numbers and their values so that I would have a 
> cell with a value for the polygon to which it corresponds.
>
> poly.rast <- rasterize(poly, rast, field=c(poly$FID))
> ex <- extract(poly.rast, poly, cellnumbers=T)
>
> I don't know how this would work with much larger files. My current 
> operation corresponds to ~12000 cells and could be faster.
> Could be the problem that it is saturday and my brain is refusing to 
> work...
>
> A function that might be handy (and fast) in the future might be of 
> the cellFrom* function family (with an argument to carry over a 
> polygon field ID etc.).
> Thanks for the help!
> Best,
> Brian
>


From zenlines at gmail.com  Mon Jan 24 19:38:30 2011
From: zenlines at gmail.com (Brian Oney)
Date: Mon, 24 Jan 2011 19:38:30 +0100
Subject: [R-sig-Geo] extract function - return the ID of the polygon
In-Reply-To: <4D3DC441.6090900@gmail.com>
References: <4D3B0866.70006@gmail.com>
	<4D3DC441.6090900@gmail.com>
Message-ID: <AANLkTi=D5Hq5bKd-oEkgC7SpkRD5xmNd3Lt-WQ0xPg=d@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110124/1684ccbc/attachment.pl>

From vesnikos at gmail.com  Tue Jan 25 13:18:59 2011
From: vesnikos at gmail.com (nikos)
Date: Tue, 25 Jan 2011 14:18:59 +0200
Subject: [R-sig-Geo] How to Identify the best subdataset of a dataset of
 points which follow a canonical distribution ?
Message-ID: <1295957939.4157.39.camel@nikos-desktop>

[The kind folks of Qgis list, suggested to post in this list as well]

Hello List,


I have an interesting problem, and I'd really appreciate if you could
give a couple insightful tips on how you'd solve the following: 

I want to order some meteo (rain mm/month for PSDI) data from my
corresponding national agency, but in their infinitive wisdom they
choose to place their weather stations in a pattern that follows
anything but a canonical distribution. 

I know this because they sent me a shp file with all their 136 stations
which are available to the general public - for a fee of couse.

Now my problems arise on how I choose  which possible combination of my
dataset of stations correspond to a canonical distribution of the
mainland - keeping the set of the stations to a minimum as with each
station the cost goes up?
I want to be as much efficient one can be using GIS technology ;)


My initial thinking is to find a subdataset which have their voronoi
polygons created with the same area. But im not so sure if thats the
correct approach

Any tips on how to solve this problem is greatly appreciated!




Ves Nikos


From ldecola at comcast.net  Tue Jan 25 13:45:02 2011
From: ldecola at comcast.net (ldecola at comcast.net)
Date: Tue, 25 Jan 2011 12:45:02 +0000 (UTC)
Subject: [R-sig-Geo] How to Identify the best subdataset of a dataset of
 points which follow a canonical distribution ?
In-Reply-To: <1295957939.4157.39.camel@nikos-desktop>
Message-ID: <1899175556.1827015.1295959502501.JavaMail.root@sz0030a.westchester.pa.mail.comcast.net>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110125/78cbfbed/attachment.pl>

From gianni.lavaredo at gmail.com  Tue Jan 25 13:53:33 2011
From: gianni.lavaredo at gmail.com (gianni lavaredo)
Date: Tue, 25 Jan 2011 13:53:33 +0100
Subject: [R-sig-Geo] problem with scatterplot3d
Message-ID: <AANLkTinujhoBD35Qraq9bGkw0tpF-2jwEqqSBZ-x-ctn@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110125/83dcb019/attachment.pl>

From Steve_Friedman at nps.gov  Tue Jan 25 16:47:19 2011
From: Steve_Friedman at nps.gov (Steve_Friedman at nps.gov)
Date: Tue, 25 Jan 2011 10:47:19 -0500
Subject: [R-sig-Geo] Learning "raster"
Message-ID: <OF861C0D45.CBABD104-ON85257823.00517592-85257823.0056BAD0@nps.gov>


Hello,

I am trying to learn how to use the Raster package.

I have moderate (480 MB) to large netCDF files (2 GB) that contain daily
records. The smaller files cover 10 years and the larger files cover 30 to
46 years of data.  I need to calculate a series of statistical summaries
(seasonal and annual means, sd) from the variables within these netCDF
files.  These files also store coordinate locations for cell specific
information.  For example the smaller files are  ncols = 194 by nrows 174
with 3650 layernames (one layer for every day in the 10 year period of
record),  and the larger file is larger in both spatial and temporal
domains.

I am looking for the most efficient method to read these data in R and then
process the statistical summaries that I mentioned above.  I do need to
retain the spatial structure of the data as I eventually want to overlay a
vegetation map on these files to generate zonal statistics for vegetation
classes.

I can open the files using:

library(raster)
s <- brick("salinity.nc", varname = "Salinity")

or

ss <- stack("salinity.nc", varname = "Salinity")

But now I don' see an approach to subsetting this on the temporal domain.
Does raster support this kind of analysis?

I can also open the files directly using ncdf
salt <- open.ncdf("salinity_1990.nc")    ##  note here that I have subset
the 10 year data record to include just the first year (365 daily records)
prior to importing to R.   I would really like to do this inside R if it is
feasible rather than using a stand alone utility for this purpose.

Once I have the annual data file in R, I can grab individual months as
follows:

for (i in 0 :30)
 Jan <- salt[, , i]
for (i in 31 : 58)
 Feb <- salt[, , i]

I found the cellStats function in raster, but I have not figure out how I
can convert this file to a raster, I think, correct me if I'm wrong, that
cellStats should be able to handle multiple layers and calculate the
statistics using data from each layer.  Is that right ?

Jan.ras <-  raster(Jan)

Error in function (classes, fdef, mtable)  :
  unable to find an inherited method for function "raster", for signature
"array"

What can you recommend to help me. I'm currently reading the "Introduction
to the 'raster' package (1.7.-29) and the manual for the raster package as
well.

 Thanks for your time and assistance.
Steve

Steve Friedman Ph. D.
Ecologist  / Spatial Statistical Analyst
Everglades and Dry Tortugas National Park
950 N Krome Ave (3rd Floor)
Homestead, Florida 33034

Steve_Friedman at nps.gov
Office (305) 224 - 4282
Fax     (305) 224 - 4147


From Pierre.Racine at sbf.ulaval.ca  Tue Jan 25 19:41:25 2011
From: Pierre.Racine at sbf.ulaval.ca (Pierre Racine)
Date: Tue, 25 Jan 2011 13:41:25 -0500
Subject: [R-sig-Geo] Vectorize and buffer
Message-ID: <87A96661E65C5541AB4D20721C2DD7F88DAD9A43CC@EXCH-MBX-A.ulaval.ca>

Hi list,

I trying to find how to do two operations in R:

1-Convert (vectorize) a raster to polygons

2-Make buffers around a set of polygons

Thanks for your help,

Pierre


From roman.lustrik at gmail.com  Tue Jan 25 20:26:40 2011
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Tue, 25 Jan 2011 20:26:40 +0100
Subject: [R-sig-Geo] Vectorize and buffer
In-Reply-To: <87A96661E65C5541AB4D20721C2DD7F88DAD9A43CC@EXCH-MBX-A.ulaval.ca>
References: <87A96661E65C5541AB4D20721C2DD7F88DAD9A43CC@EXCH-MBX-A.ulaval.ca>
Message-ID: <AANLkTimoMnuc2rtJu=hp--aCttGj=Jsb13LsBupC=HLD@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110125/8a08699d/attachment.pl>

From Pierre.Racine at sbf.ulaval.ca  Tue Jan 25 20:37:40 2011
From: Pierre.Racine at sbf.ulaval.ca (Pierre Racine)
Date: Tue, 25 Jan 2011 14:37:40 -0500
Subject: [R-sig-Geo] Vectorize and buffer
In-Reply-To: <AANLkTimoMnuc2rtJu=hp--aCttGj=Jsb13LsBupC=HLD@mail.gmail.com>
References: <87A96661E65C5541AB4D20721C2DD7F88DAD9A43CC@EXCH-MBX-A.ulaval.ca>
	<AANLkTimoMnuc2rtJu=hp--aCttGj=Jsb13LsBupC=HLD@mail.gmail.com>
Message-ID: <87A96661E65C5541AB4D20721C2DD7F88DAD9A43DE@EXCH-MBX-A.ulaval.ca>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110125/45b20967/attachment.pl>

From r.hijmans at gmail.com  Wed Jan 26 04:28:03 2011
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Tue, 25 Jan 2011 19:28:03 -0800 (PST)
Subject: [R-sig-Geo] Learning "raster"
In-Reply-To: <OF861C0D45.CBABD104-ON85257823.00517592-85257823.0056BAD0@nps.gov>
References: <OF861C0D45.CBABD104-ON85257823.00517592-85257823.0056BAD0@nps.gov>
Message-ID: <1296012483200-5961494.post@n2.nabble.com>


Steve,

> But now I don' see an approach to subsetting this on the temporal domain. 
> Does raster support this kind of analysis? 

x <- subset(ss, 2:10)
x <- ss[[2:10]]

But perhaps you do not need to subset, as you can probably use 'stackApply'
for your purposes

> cellStats should be able to handle multiple layers and calculate the 
> statistics using data from each layer.  Is that right ? 

Yes. 

> Jan.ras <-  raster(Jan) 

You could try:
 Jan.ras <-  brick(Jan) 


> What can you recommend to help me. I'm currently reading the "Introduction 
> to the 'raster' package (1.7.-29) and the manual for the raster package as 
> well. 

Steven Mosher has a couple of scripts on his blog that deal with climate
data in ncdf files. That is probably the best place to go given that you are
doing something similar. http://stevemosher.wordpress.com/

Robert
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Learning-raster-tp5959319p5961494.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From r.hijmans at gmail.com  Wed Jan 26 04:39:18 2011
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Tue, 25 Jan 2011 19:39:18 -0800 (PST)
Subject: [R-sig-Geo] Vectorize and buffer
In-Reply-To: <87A96661E65C5541AB4D20721C2DD7F88DAD9A43DE@EXCH-MBX-A.ulaval.ca>
References: <87A96661E65C5541AB4D20721C2DD7F88DAD9A43CC@EXCH-MBX-A.ulaval.ca>
	<AANLkTimoMnuc2rtJu=hp--aCttGj=Jsb13LsBupC=HLD@mail.gmail.com>
	<87A96661E65C5541AB4D20721C2DD7F88DAD9A43DE@EXCH-MBX-A.ulaval.ca>
Message-ID: <1296013158221-5961511.post@n2.nabble.com>


> I see functions to rasterize in the raster package but nothing to
vectorize... 
> and certainly nothing to do buffer around polygons. 

raster has "rasterToPolygons" -- but it only works well for smallish rasters
(or when few cells have non NA values) because each cell with a value
becomes a polygon; that needs work. You can dissolve the with
unionSpatialPolygons in maptools (hopefully rgeos soon). I think adahabitat
has a buffer tool for lines. Perhaps you can create lines from your
polygons, make the buffer, combine with the original polygons, and dissolve
again? You could also consider doing the buffering on the raster (use
distance, and then reclassify). 
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Vectorize-and-buffer-tp5959999p5961511.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From geomalik at live.com  Wed Jan 26 11:50:00 2011
From: geomalik at live.com (Malik Shahzad)
Date: Wed, 26 Jan 2011 17:50:00 +0700
Subject: [R-sig-Geo] Vegetation calculation
In-Reply-To: <SNT111-W7E8F00E0B69849A97E06CACFF0@phx.gbl>
References: <SNT111-W7E8F00E0B69849A97E06CACFF0@phx.gbl>
Message-ID: <SNT111-W105E6271ECB5E4C0A42251ACFF0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110126/4ec28fda/attachment.pl>

From bart at njn.nl  Wed Jan 26 11:58:24 2011
From: bart at njn.nl (bart)
Date: Wed, 26 Jan 2011 11:58:24 +0100
Subject: [R-sig-Geo] ECMWF grib and raster
Message-ID: <4D3FFE50.7080808@njn.nl>

Hi All

I'm trying to read grib files using Raster, form the ECMWF interim
dataset (example file linked below). I don't get errors but the
coordinate system of the read raster does not seem to match.

  > raster("tmp.grib")
class       : RasterLayer
filename    : /home/bart/Desktop/tmp.grib
nrow        : 121
ncol        : 240
ncell       : 29040
min value   : ?
max value   : ?
projection  : +proj=longlat +a=6367470 +b=6367470 +no_defs
extent      : -180, 180, -91.5, 90  (xmin, xmax, ymin, ymax)
resolution  : 1.5, 1.5  (x, y)


Notice the minimal latitude outside this world. For comparison i
extracted the same data using the grib_get_data program with the
following command: grib_get_data tmp.grib > bla.tab (small manual format
conversion for reading in R). grib_get_data is provided by:
libgrib-api-tools (http://packages.ubuntu.com/maverick/libgrib-api-tools) .

Comparing the datasets gives the following results
  > summary(b<-read.csv("bla.tab", sep=","))
      Latitude     Longitude           Value
   Min.   :-90   Min.   :-180.00   Min.   :2.093
   1st Qu.:-45   1st Qu.: -90.38   1st Qu.:2.695
   Median :  0   Median :  -0.75   Median :2.836
   Mean   :  0   Mean   :  -0.75   Mean   :2.791
   3rd Qu.: 45   3rd Qu.:  88.88   3rd Qu.:2.969
   Max.   : 90   Max.   : 178.50   Max.   :3.147
  > summary(a<-rasterToPoints(raster("tmp.grib")))
         x                 y                V3
   Min.   :-179.25   Min.   :-90.75   Min.   :209.3
   1st Qu.: -89.62   1st Qu.:-45.75   1st Qu.:269.5
   Median :   0.00   Median : -0.75   Median :283.6
   Mean   :   0.00   Mean   : -0.75   Mean   :279.1
   3rd Qu.:  89.62   3rd Qu.: 44.25   3rd Qu.:296.9
   Max.   : 179.25   Max.   : 89.25   Max.   :314.7

It seems the raster grid is offset by half a grid cell size. I'm not
sure what the grib file format specification is but since
libgrib-api-tools seems to be provided by ECMWF i tend to believe their
correct.


Bart

ps tmp.grib is downloadable here: 
https://depot.uni-konstanz.de/cgi-bin/exchange.pl?g=nv3xd (less than 100kb)


From piero.campa at gmail.com  Wed Jan 26 14:45:25 2011
From: piero.campa at gmail.com (piero campa)
Date: Wed, 26 Jan 2011 05:45:25 -0800 (PST)
Subject: [R-sig-Geo] temperature interpolation -- was: 3D kriging with
	gstat
In-Reply-To: <41DAF6A6.9070308@geog.uu.nl>
References: <1104844568.41da971862581@webmail.uoa.gr>
	<Pine.LNX.4.44.0501040837330.1189-100000@five-ten.cgd.ucar.edu>
	<41DAF6A6.9070308@geog.uu.nl>
Message-ID: <1296049525658-5962719.post@n2.nabble.com>


This is more about kriging theory actually,
but I can't understand in which different ways the elevation information is
taken into account in the prediction process when e.g.:

 - I apply ordinary cokriging on input data which include 3D (x,y,h) spatial
coordinates;
 - I apply universal cokriging on input data with 2D (x,y) spatial
coordinates and using the elevation h as external drift on the output grid.

Piero
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/3D-kriging-with-gstat-tp2761569p5962719.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From edzer.pebesma at uni-muenster.de  Wed Jan 26 15:11:45 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 26 Jan 2011 15:11:45 +0100
Subject: [R-sig-Geo] temperature interpolation -- was: 3D kriging with
 gstat
In-Reply-To: <1296049525658-5962719.post@n2.nabble.com>
References: <1104844568.41da971862581@webmail.uoa.gr>	<Pine.LNX.4.44.0501040837330.1189-100000@five-ten.cgd.ucar.edu>	<41DAF6A6.9070308@geog.uu.nl>
	<1296049525658-5962719.post@n2.nabble.com>
Message-ID: <4D402BA1.8070908@uni-muenster.de>



On 01/26/2011 02:45 PM, piero campa wrote:
> 
> This is more about kriging theory actually,
> but I can't understand in which different ways the elevation information is
> taken into account in the prediction process when e.g.:
> 
>  - I apply ordinary cokriging on input data which include 3D (x,y,h) spatial
> coordinates;

If your temperature is (near) surface temperature, then no, because you
want to predict surface temperature, not temperature for arbitrary h values.

>  - I apply universal cokriging on input data with 2D (x,y) spatial
> coordinates and using the elevation h as external drift on the output grid.

This sounds more reasonable, yes.

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From zua3 at cornell.edu  Wed Jan 26 18:07:41 2011
From: zua3 at cornell.edu (Zia Ahmed)
Date: Wed, 26 Jan 2011 12:07:41 -0500
Subject: [R-sig-Geo] Problem with Kriging with in strata
In-Reply-To: <4D3B517F.2050302@uni-muenster.de>
References: <4D3AAEEC.1040300@univ-fcomte.fr>
	<4D3B517F.2050302@uni-muenster.de>
Message-ID: <4D4054DD.60103@cornell.edu>

  Hi,
I am trying to do kriging with in strata. I  use the example in book 
"Applied Spatial Data Analysis with R" page:217. It works fine with 
"meuse" data. But when I am  trying to use my data it shows some error 
massage.
Do I missing something here?
Thanks in advance
Zia

  Note: I am using following codes:


coordinates(tala) <- ~ x + y
gridded(tala.grid) = ~x+y
 > names(tala.grid)
[1] "lt.a"      "lt.b"      "elev"      "FDID"      "wfe_was"   
"was"       "was.lt"    "elev.sqrt"
# lt.a= flooding land type 1 and lt.b=flooding land type 2

tala$lt.a <- tala.grid$lt.a[overlay(tala.grid, tala)]
 > names(tala)

[1] "YID"  "FDID" "elev" "was"  "sas"  "lt.a" "lt.b"


x1 <- krige(sas ~ 1, tala[tala$lt.a == 0, ],tala.grid[tala.grid$lt.a == 
0, ], model = vgm(35,"Sph", 2000, 15), nmin = 8, nmax = 40, maxdist = 1000)

Error in tala[tala$lt.a == 0, ] : NAs not permitted in row index Error 
in krige(sas ~ 1, tala[tala$lt.a == 0, ], tala.grid[tala.grid$lt.a ==  :
   error in evaluating the argument 'locations' in selecting a method 
for function 'krige'

x2<- krige(sas~1, tala[tala$lt.a == 1, ],tala.grid[tala.grid$lt.a == 1, 
], model = vgm(30,"Sph", 2000), nmin = 8, nmax = 40, maxdist = 1000)

Error in tala[tala$lt.a == 1, ] : NAs not permitted in row index Error 
in krige(sas ~ 1, tala[tala$lt.a == 1, ], tala.grid[tala.grid$lt.a ==  :
   error in evaluating the argument 'locations' in selecting a method 
for function 'krige'


On 1/22/2011 4:51 PM, Edzer Pebesma wrote:
>
> On 01/22/2011 11:18 AM, Patrick Giraudoux wrote:
>> Hi,
>>
>> Does anybody knows if it is possible to fix user defined maximum and
>> minimum values in the key of a xyplot (or spplot) graphics ? I have a
>> set of seperate drawings and I would like to keep the same color scheme
>> between fixed values for all of them (which looks like being not
>> possible, autokey normally adapting the range of colors to the
>> particular range of values in each plot.
> If your object is of class SpatialPointsDataFrame, it may suffice to
> pass the argument "cuts" with the vector of cuts. If it is
> grid/polygons/lines, use the "at" component of the "colorkey" argument
> to specify breaks; see ?levelplot in package lattice.
>
>> Patrick
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110126/3420bfed/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: zua3.vcf
Type: text/x-vcard
Size: 281 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110126/3420bfed/attachment.vcf>

From edzer.pebesma at uni-muenster.de  Wed Jan 26 18:35:24 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 26 Jan 2011 18:35:24 +0100
Subject: [R-sig-Geo] Problem with Kriging with in strata
In-Reply-To: <4D4054DD.60103@cornell.edu>
References: <4D3AAEEC.1040300@univ-fcomte.fr>
	<4D3B517F.2050302@uni-muenster.de> <4D4054DD.60103@cornell.edu>
Message-ID: <4D405B5C.4080207@uni-muenster.de>

It seems your lt.a contains missing values. Try

x1 <- krige(sas ~ 1, tala[tala$lt.a == 0 & !is.na(tala$lt.a), ], etc.

On 01/26/2011 06:07 PM, Zia Ahmed wrote:
>  Hi,
> I am trying to do kriging with in strata. I  use the example in book
> "Applied Spatial Data Analysis with R" page:217. It works fine with
> "meuse" data. But when I am  trying to use my data it shows some error
> massage.
> Do I missing something here?
> Thanks in advance
> Zia
> 
>  Note: I am using following codes:
> 
> 
> coordinates(tala) <- ~ x + y
> gridded(tala.grid) = ~x+y
>> names(tala.grid)
> [1] "lt.a"      "lt.b"      "elev"      "FDID"      "wfe_was"  
> "was"       "was.lt"    "elev.sqrt"
> # lt.a= flooding land type 1 and lt.b=flooding land type 2
> 
> tala$lt.a <- tala.grid$lt.a[overlay(tala.grid, tala)]
>> names(tala)
> 
> [1] "YID"  "FDID" "elev" "was"  "sas"  "lt.a" "lt.b"
> 
> 
> x1 <- krige(sas ~ 1, tala[tala$lt.a == 0, ],tala.grid[tala.grid$lt.a ==
> 0, ], model = vgm(35,"Sph", 2000, 15), nmin = 8, nmax = 40, maxdist = 1000)
> 
> Error in tala[tala$lt.a == 0, ] : NAs not permitted in row index Error
> in krige(sas ~ 1, tala[tala$lt.a == 0, ], tala.grid[tala.grid$lt.a ==  :
>   error in evaluating the argument 'locations' in selecting a method for
> function 'krige'
> 
> x2<- krige(sas~1, tala[tala$lt.a == 1, ],tala.grid[tala.grid$lt.a == 1,
> ], model = vgm(30,"Sph", 2000), nmin = 8, nmax = 40, maxdist = 1000)
> 
> Error in tala[tala$lt.a == 1, ] : NAs not permitted in row index Error
> in krige(sas ~ 1, tala[tala$lt.a == 1, ], tala.grid[tala.grid$lt.a ==  :
>   error in evaluating the argument 'locations' in selecting a method for
> function 'krige'
> 
> 
> On 1/22/2011 4:51 PM, Edzer Pebesma wrote:
>>
>> On 01/22/2011 11:18 AM, Patrick Giraudoux wrote:
>>> Hi,
>>>
>>> Does anybody knows if it is possible to fix user defined maximum and
>>> minimum values in the key of a xyplot (or spplot) graphics ? I have a
>>> set of seperate drawings and I would like to keep the same color scheme
>>> between fixed values for all of them (which looks like being not
>>> possible, autokey normally adapting the range of colors to the
>>> particular range of values in each plot.
>> If your object is of class SpatialPointsDataFrame, it may suffice to
>> pass the argument "cuts" with the vector of cuts. If it is
>> grid/polygons/lines, use the "at" component of the "colorkey" argument
>> to specify breaks; see ?levelplot in package lattice.
>>
>>> Patrick
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From r.hijmans at gmail.com  Wed Jan 26 19:06:25 2011
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Wed, 26 Jan 2011 10:06:25 -0800 (PST)
Subject: [R-sig-Geo] ECMWF grib and raster
In-Reply-To: <4D3FFE50.7080808@njn.nl>
References: <4D3FFE50.7080808@njn.nl>
Message-ID: <1296065185782-5963619.post@n2.nabble.com>


> I'm trying to read grib files using Raster, form the ECMWF interim 
> dataset (example file linked below). I don't get errors but the 
> coordinate system of the read raster does not seem to match. 

Bart, 

I think this is due to an instance of the "grid vs. cell-center convention
mistake" in gdal, reported here: http://trac.osgeo.org/gdal/ticket/2637 ,
but apparently not yet fixed. At least not in my gdal: "GDAL 1.7.2, released
2010/04/23" 

I confirmed that gdal gets it wrong using the 'degrib' software to export to
csv, and shapefile points and polygons. 

Here is a work-around:

> r <- raster( "tmp.grib" )
> r <- shift(r, x=-0.5*xres(r), y =0.5*yres(r))
> summary(rasterToPoints(r))
       x                 y             V3       
 Min.   :-180.00   Min.   :-90   Min.   :209.3  
 1st Qu.: -90.38   1st Qu.:-45   1st Qu.:269.5  
 Median :  -0.75   Median :  0   Median :283.6  
 Mean   :  -0.75   Mean   :  0   Mean   :279.1  
 3rd Qu.:  88.88   3rd Qu.: 45   3rd Qu.:296.9  
 Max.   : 178.50   Max.   : 90   Max.   :314.7  
> 

-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/ECMWF-grib-and-raster-tp5962291p5963619.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From horning at amnh.org  Wed Jan 26 23:32:04 2011
From: horning at amnh.org (Ned Horning)
Date: Wed, 26 Jan 2011 17:32:04 -0500
Subject: [R-sig-Geo] Error running gbm.step in dismo package
Message-ID: <4D40A0E4.7080308@amnh.org>

Hi -

I get the following error occasionally when I run gbm.step in the dismo:
--
Error in var(threshold.stats, use = "complete.obs") :
   no complete element pairs
--

I also get several warnings such as:
--
3: In glm.fit(x = X, y = Y, weights = weights, start = start, etastart = 
etastart,  :
   algorithm did not converge
4: In glm.fit(x = X, y = Y, weights = weights, start = start, etastart = 
etastart,  :
   fitted probabilities numerically 0 or 1 occurred
5: In cor(y_i, u_i) : the standard deviation is zero
--

Here is the line I use to run gbm.step:
gbm_object <- gbm.step(data=model.data,  gbm.x=9:45,  gbm.y=1,  
family="bernoulli",
     tree.complexity=5, learning.rate=0.001, bag.fraction=0.5)

The response variable is presence/absence (0/1) data for a bird species. 
When I run this with the full data set for particular bird species the 
data.frame "model.data" has 371 rows (plots) and then the error does not 
appear but I still get several warnings. When I run it on a subset of 
only 93 rows (I'd like to do k-fold partitioning) I get the error and 
warnings mentioned above. For what it's worth, this problem data subset 
has 88 presences and only 5 absences. It appears that when I run this 
for bird species with more of a balance of presences and absences I 
don't get any errors or warnings.

Any thoughts or pointers?

All the best,

Ned


From eric.boeker at gmail.com  Fri Jan 28 11:47:56 2011
From: eric.boeker at gmail.com (Eric Boeker)
Date: Fri, 28 Jan 2011 11:47:56 +0100
Subject: [R-sig-Geo] Piper Diagram
Message-ID: <AANLkTinVxSUUWnzNxOLtkzt3pny+nbevGZba993+eOMQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110128/b0a65487/attachment.pl>

From christian.paroissin at univ-pau.fr  Fri Jan 28 14:03:16 2011
From: christian.paroissin at univ-pau.fr (Christian Paroissin)
Date: Fri, 28 Jan 2011 14:03:16 +0100
Subject: [R-sig-Geo] Extracting "lines" from ArcGIS file
Message-ID: <20110128140316.19577g6k8qdcpd3o@webmail.univ-pau.fr>

Hello,

I have downloaded an Arcgis file here:
http://services.sandre.eaufrance.fr/data/zonage/Hydrographie2010/arcgis/Bassins/AG/COURS_D_EAU.SHP.zip

I would like to extract informations from these dataset. It gives an  
S4 object but I know nothing about it. Here is the code I wrote:

[code]
object1.shp <- readShapeSpatial("Cours-AG/COURS_D_EAU.shp")
index= which(object1.shp$TOPONYME=="L'Adour")
object1.shp[index,]
[/code]

I would like to extract the 'information' called "lines" but I don't  
known how do it. I find how to extract the 'information' "bbox"
[quote]
object1.shp[index,]@bbox
object1.shp[index,]@lines
[/quote]

Could you help me please?

Do "lines" correspond to the coordinates of the different points  
defining the river ("L'Adour" in my case)?

Thanks in advance,

Ch.

-- 
Christian Paroissin
Maitre de conf?rences
Universit? de Pau et des Pays de l'Adour
Laboratoire de Math?matiques et de leurs Applications
IPRA - LMAP
Avenue de l'Universit?
64013 Pau cedex
T?l : +33 (0)5 59 40 75 69
Web : http://web.univ-pau.fr/~cparoiss/


From roman.lustrik at gmail.com  Fri Jan 28 14:01:52 2011
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Fri, 28 Jan 2011 14:01:52 +0100
Subject: [R-sig-Geo] Piper Diagram
In-Reply-To: <AANLkTinVxSUUWnzNxOLtkzt3pny+nbevGZba993+eOMQ@mail.gmail.com>
References: <AANLkTinVxSUUWnzNxOLtkzt3pny+nbevGZba993+eOMQ@mail.gmail.com>
Message-ID: <AANLkTi=yAWedxCdT8be0p9CtaWHsKzS=MqZG0oB5Rghe@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110128/8b5c0e41/attachment.pl>

From r.m.krug at gmail.com  Fri Jan 28 14:38:22 2011
From: r.m.krug at gmail.com (Rainer M Krug)
Date: Fri, 28 Jan 2011 14:38:22 +0100
Subject: [R-sig-Geo] Problem with execGRASS and r.mapcalculator
Message-ID: <4D42C6CE.8070105@gmail.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Hi

when using r.mapcalculator via execGRASS, a problem arises if in the
formula are no spaces, as the formula is then not enclosed in \". This
leads to a syntax eror, as in the second example. Would it be a problem
to enclose *all* strings given in \"? This would solve the problem.

See example below.

In addidion (example 3), a cut off error message is printed in R, but no
error raised in R itself - would there be a possibility, to evaluate if
an error occurred in GRASS? I remember a discussion about that, but I
don't seem to recall the outcome.

Cheers,

Rainer


# ERROR #####################################
> doGRASS(cmd="r.mapcalculator", parameter=list(amap="MASK",
bmap="MASK", formula="round(A + B)", outfile="test"), flags="overwrite")
[1] "r.mapcalculator --overwrite amap=MASK bmap=MASK formula=\"round(A +
B)\" outfile=test"

> execGRASS(cmd="r.mapcalculator", parameter=list(amap="MASK",
bmap="MASK", formula="round(A+B)", outfile="test"), flags="overwrite")
sh: Syntax error: "(" unexpected

# WORKING #####################################
> doGRASS(cmd="r.mapcalculator", parameter=list(amap="MASK",
bmap="MASK", formula="round(A+B)", outfile="test"), flags="overwrite")
[1] "r.mapcalculator --overwrite amap=MASK bmap=MASK formula=round(A+B)
outfile=test"

> execGRASS(cmd="r.mapcalculator", parameter=list(amap="MASK",
bmap="MASK", formula="round(A + B)", outfile="test"), flags="overwrite")
r.mapcalc "test" = "(round( "MASK" + "MASK" ))"

Done.
######################################

# example 2 #####################################
> execGRASS(cmd="r.mapcalculator", parameter=list(amap="MASK",
bmap="MASK", formula="round(A + B", outfile="test"), flags="overwrite")
r.mapcalc "test" = "(round( "MASK" + "MASK" )"
syntax error, unexpected $end, expecting ')'
Parse error
RROR: Calculating test. Try expert mode.
>

- -- 
Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation
Biology, UCT), Dipl. Phys. (Germany)

Centre of Excellence for Invasion Biology
Natural Sciences Building
Office Suite 2039
Stellenbosch University
Main Campus, Merriman Avenue
Stellenbosch
South Africa

Tel:        +33 - (0)9 53 10 27 44
Cell:       +27 - (0)8 39 47 90 42
Fax (SA):   +27 - (0)8 65 16 27 82
Fax (D) :   +49 - (0)3 21 21 25 22 44
Fax (FR):   +33 - (0)9 58 10 27 44
email:      Rainer at krugs.de

Skype:      RMkrug
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/

iEYEARECAAYFAk1Cxs4ACgkQoYgNqgF2egqltACfSr15AScq4KYEi+VeurxietNG
g0oAn09CoVlvvHw2z3PeIOWb29DryZ5k
=XDGI
-----END PGP SIGNATURE-----


From b.rowlingson at lancaster.ac.uk  Fri Jan 28 15:42:36 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Fri, 28 Jan 2011 14:42:36 +0000
Subject: [R-sig-Geo] Extracting "lines" from ArcGIS file
In-Reply-To: <20110128140316.19577g6k8qdcpd3o@webmail.univ-pau.fr>
References: <20110128140316.19577g6k8qdcpd3o@webmail.univ-pau.fr>
Message-ID: <AANLkTi=2CVVRedmiEN0dDX4F0fAC647xQ7EPptL8kQYJ@mail.gmail.com>

On Fri, Jan 28, 2011 at 1:03 PM, Christian Paroissin
<christian.paroissin at univ-pau.fr> wrote:
> Hello,
>
> I have downloaded an Arcgis file here:
> http://services.sandre.eaufrance.fr/data/zonage/Hydrographie2010/arcgis/Bassins/AG/COURS_D_EAU.SHP.zip
>
> I would like to extract informations from these dataset. It gives an S4
> object but I know nothing about it. Here is the code I wrote:
>
> [code]
> object1.shp <- readShapeSpatial("Cours-AG/COURS_D_EAU.shp")
> index= which(object1.shp$TOPONYME=="L'Adour")
> object1.shp[index,]
> [/code]
>
> I would like to extract the 'information' called "lines" but I don't known
> how do it. I find how to extract the 'information' "bbox"
> [quote]
> object1.shp[index,]@bbox
> object1.shp[index,]@lines
> [/quote]
>
> Could you help me please?
>
> Do "lines" correspond to the coordinates of the different points defining
> the river ("L'Adour" in my case)?

 Yes. but rivers are never simple. The data structure is therefore complex :)

 object1.shp is a SpatialLinesDataFrame. Its a bit like a dataframe,
but with a geometry for each row. Each row is a 'feature' - not
necessarily a single wiggly line, it could be several lines. In your
case it seems there is one of everything, so you can do:

object1.shp[index,]@lines[[1]]@Lines[[1]]@coords

to get a 2-column matrix of the coordinates of that feature.

See the help for SpatialLinesDataFrame and the vignette for the sp
package and the ASDAR book for more.

Barry


From jmblanco at ub.edu  Fri Jan 28 19:04:25 2011
From: jmblanco at ub.edu (=?ISO-8859-1?Q?=22Jos=E9_M=2E_Blanco_Moreno=22?=)
Date: Fri, 28 Jan 2011 19:04:25 +0100
Subject: [R-sig-Geo] Issue with as.polygonal (gpclib not )
Message-ID: <4D430529.3080209@ub.edu>

Dear R users,
I have been trying to convert a mask owin object (generated by dilation) 
to a polygonal owin, but I am facing the following error message, and I 
have not been able to find the solution, neither among the 
documentation, nor in the mailing lists. Any hint? I know that some 
packages (one package, perhaps) have changed recently (months ago) their 
default behaviour with regards to gpclib, and I wonder if spatstats is 
one of these.
Thank you in advance,
Jos? M.

##############################
 > library(spatstat); library(gpclib)

 > pins <- cbind(x=rnorm(60),y=rnorm(60))

 > pins <- as.data.frame(pins)

 > pins.owin <- owin(poly=pins[rev(chull(pins)),])

 > pins.dil <- dilation(pins.owin,r=0.25)

 > pins.dil <- simplify.owin(dilation(pins.owin,r=0.25))
# Warning message:
# In as.polygonal(W) :
#   Can't convert mask to polygon: gpclib is disabled/unavailable

 > perimeter(pins.dil)
# Error in as.psp.owin(p) : x is a mask
# In addition: Warning messages:
# 1: In as.polygonal(w) :
#   Can't convert mask to polygon: gpclib is disabled/unavailable
# 2: In as.polygonal(W) :
#  Can't convert mask to polygon: gpclib is disabled/unavailable

##############################
## However I can execute the following example from gpclib
 > holepoly <- read.polyfile(system.file("poly-ex/hole-poly.txt", package =
+ "gpclib"), nohole = FALSE)

 > area.poly(holepoly)

 > sessionInfo()
R version 2.11.0 (2010-04-22)
i386-pc-mingw32

locale:
[1] LC_COLLATE=Spanish_Spain.1252  LC_CTYPE=Spanish_Spain.1252
[3] LC_MONETARY=Spanish_Spain.1252 LC_NUMERIC=C
[5] LC_TIME=Spanish_Spain.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] gpclib_1.5-1    spatstat_1.21-0 deldir_0.0-12   mgcv_1.7-1

loaded via a namespace (and not attached):
[1] grid_2.11.0        lattice_0.19-13    Matrix_0.999375-44 nlme_3.1-97
[5] tools_2.11.0

-- 
---------------------------------------
Jos? M. Blanco-Moreno

Dept. de Biologia Vegetal (Bot?nica)
Facultat de Biologia
Universitat de Barcelona
Av. Diagonal 645
08028 Barcelona
SPAIN
---------------------------------------

phone: (+34) 934 039 863
fax: (+34) 934 112 842


From jmblanco at ub.edu  Fri Jan 28 19:05:00 2011
From: jmblanco at ub.edu (=?ISO-8859-1?Q?=22Jos=E9_M=2E_Blanco_Moreno=22?=)
Date: Fri, 28 Jan 2011 19:05:00 +0100
Subject: [R-sig-Geo] Issue with as.polygonal (gpclib disabled?)
Message-ID: <4D43054C.9090607@ub.edu>

Dear R users,
I have been trying to convert a mask owin object (generated by dilation) 
to a polygonal owin, but I am facing the following error message, and I 
have not been able to find the solution, neither among the 
documentation, nor in the mailing lists. Any hint? I know that some 
packages (one package, perhaps) have changed recently (months ago) their 
default behaviour with regards to gpclib, and I wonder if spatstats is 
one of these.
Thank you in advance,
Jos? M.

##############################
 > library(spatstat); library(gpclib)

 > pins <- cbind(x=rnorm(60),y=rnorm(60))

 > pins <- as.data.frame(pins)

 > pins.owin <- owin(poly=pins[rev(chull(pins)),])

 > pins.dil <- dilation(pins.owin,r=0.25)

 > pins.dil <- simplify.owin(dilation(pins.owin,r=0.25))
# Warning message:
# In as.polygonal(W) :
#   Can't convert mask to polygon: gpclib is disabled/unavailable

 > perimeter(pins.dil)
# Error in as.psp.owin(p) : x is a mask
# In addition: Warning messages:
# 1: In as.polygonal(w) :
#   Can't convert mask to polygon: gpclib is disabled/unavailable
# 2: In as.polygonal(W) :
#  Can't convert mask to polygon: gpclib is disabled/unavailable

##############################
## However I can execute the following example from gpclib
 > holepoly <- read.polyfile(system.file("poly-ex/hole-poly.txt", package =
+ "gpclib"), nohole = FALSE)

 > area.poly(holepoly)

 > sessionInfo()
R version 2.11.0 (2010-04-22)
i386-pc-mingw32

locale:
[1] LC_COLLATE=Spanish_Spain.1252  LC_CTYPE=Spanish_Spain.1252
[3] LC_MONETARY=Spanish_Spain.1252 LC_NUMERIC=C
[5] LC_TIME=Spanish_Spain.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] gpclib_1.5-1    spatstat_1.21-0 deldir_0.0-12   mgcv_1.7-1

loaded via a namespace (and not attached):
[1] grid_2.11.0        lattice_0.19-13    Matrix_0.999375-44 nlme_3.1-97
[5] tools_2.11.0

-- 
---------------------------------------
Jos? M. Blanco-Moreno

Dept. de Biologia Vegetal (Bot?nica)
Facultat de Biologia
Universitat de Barcelona
Av. Diagonal 645
08028 Barcelona
SPAIN
---------------------------------------

phone: (+34) 934 039 863
fax: (+34) 934 112 842


From Pierre.Racine at sbf.ulaval.ca  Fri Jan 28 20:34:18 2011
From: Pierre.Racine at sbf.ulaval.ca (Pierre Racine)
Date: Fri, 28 Jan 2011 14:34:18 -0500
Subject: [R-sig-Geo] Problem reading back a raster from GRASS
Message-ID: <87A96661E65C5541AB4D20721C2DD7F88DAD9A462D@EXCH-MBX-A.ulaval.ca>

Hi,

It seems I'm having problem storing a raster into GRASS using the spgrass6 package. I writeRAST6() a 1376x1376 raster to GRASS, but when I readRAST6() it back to R the raster is only 1x1 pixels... Note that the raster is a bmp and hence is not projected to any coordinate system.

I must be doing something wrong. Here is my R code:

------------------------------------------------------------------
> image1 = readGDAL("D:/temp/image01.bmp")
  D:/Clients/AlainPaquette/AnalyseDeCimeR/images/image01.bmp has GDAL driver BMP
  and has 1376 rows and 1376 columns

> summary(image1)
  Object of class SpatialGridDataFrame
  Coordinates:
         min     max
  x    -2953 8123703
  y -8123703    2953
  Is projected: NA
  proj4string : [NA]
  Number of points: 2
  Grid attributes:
    cellcentre.offset cellsize cells.dim
  x                 0     5906      1376
  y          -8120750     5906      1376
  Data attributes:
     Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
   0.0000  1.0000  1.0000  0.9962  1.0000  1.0000

> writeRAST6(image1, "image1", overwrite=TRUE)
  ATTENTION : Raster map <image1> already exists and will be overwritten
  Projection of input dataset and current location appear to match

  RINGDA~1 termin?. Raster map <image1> created.

> image1_2 <-  readRAST6(c("image1"), cat=c(TRUE), ignore.stderr=TRUE, plugin=NULL)

> summary(image1_2)
  Object of class SpatialGridDataFrame
  Coordinates:
    min max
  x   0   1
  y   0   1
  Is projected: NA
  proj4string : [NA]
  Number of points: 2
  Grid attributes:
    cellcentre.offset cellsize cells.dim
  x               0.5        1         1
  y               0.5        1         1
  Data attributes:

  1

>
------------------------------------------------------------------

Thanks,

Pierre


From Roger.Bivand at nhh.no  Fri Jan 28 20:58:51 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 28 Jan 2011 20:58:51 +0100 (CET)
Subject: [R-sig-Geo] Problem reading back a raster from GRASS
In-Reply-To: <87A96661E65C5541AB4D20721C2DD7F88DAD9A462D@EXCH-MBX-A.ulaval.ca>
References: <87A96661E65C5541AB4D20721C2DD7F88DAD9A462D@EXCH-MBX-A.ulaval.ca>
Message-ID: <alpine.LRH.2.00.1101282048120.32112@reclus.nhh.no>

On Fri, 28 Jan 2011, Pierre Racine wrote:

> Hi,
>
> It seems I'm having problem storing a raster into GRASS using the 
> spgrass6 package. I writeRAST6() a 1376x1376 raster to GRASS, but when I 
> readRAST6() it back to R the raster is only 1x1 pixels... Note that the 
> raster is a bmp and hence is not projected to any coordinate system.
>
> I must be doing something wrong. Here is my R code:

What is the current region of your GRASS location? You can check by 
looking at the output of gmeta6(). If it does not match the extent of the 
file, you may experience this. Have you checked the extent of the data as 
seem by GRASS before reading it back? Are you running R within GRASS or 
did you start GRASS with initGRASS() from within R? If you used initGRASS, 
did you use the SG= argument?

Roger

>
> ------------------------------------------------------------------
>> image1 = readGDAL("D:/temp/image01.bmp")
>  D:/Clients/AlainPaquette/AnalyseDeCimeR/images/image01.bmp has GDAL driver BMP
>  and has 1376 rows and 1376 columns
>
>> summary(image1)
>  Object of class SpatialGridDataFrame
>  Coordinates:
>         min     max
>  x    -2953 8123703
>  y -8123703    2953
>  Is projected: NA
>  proj4string : [NA]
>  Number of points: 2
>  Grid attributes:
>    cellcentre.offset cellsize cells.dim
>  x                 0     5906      1376
>  y          -8120750     5906      1376
>  Data attributes:
>     Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
>   0.0000  1.0000  1.0000  0.9962  1.0000  1.0000
>
>> writeRAST6(image1, "image1", overwrite=TRUE)
>  ATTENTION : Raster map <image1> already exists and will be overwritten
>  Projection of input dataset and current location appear to match
>
>  RINGDA~1 termin?. Raster map <image1> created.
>
>> image1_2 <-  readRAST6(c("image1"), cat=c(TRUE), ignore.stderr=TRUE, plugin=NULL)
>
>> summary(image1_2)
>  Object of class SpatialGridDataFrame
>  Coordinates:
>    min max
>  x   0   1
>  y   0   1
>  Is projected: NA
>  proj4string : [NA]
>  Number of points: 2
>  Grid attributes:
>    cellcentre.offset cellsize cells.dim
>  x               0.5        1         1
>  y               0.5        1         1
>  Data attributes:
>
>  1
>
>>
> ------------------------------------------------------------------
>
> Thanks,
>
> Pierre
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From Pierre.Racine at sbf.ulaval.ca  Fri Jan 28 21:06:03 2011
From: Pierre.Racine at sbf.ulaval.ca (Pierre Racine)
Date: Fri, 28 Jan 2011 15:06:03 -0500
Subject: [R-sig-Geo] Problem reading back a raster from GRASS
In-Reply-To: <alpine.LRH.2.00.1101282048120.32112@reclus.nhh.no>
References: <87A96661E65C5541AB4D20721C2DD7F88DAD9A462D@EXCH-MBX-A.ulaval.ca>
	<alpine.LRH.2.00.1101282048120.32112@reclus.nhh.no>
Message-ID: <87A96661E65C5541AB4D20721C2DD7F88DAD9A4638@EXCH-MBX-A.ulaval.ca>

Ok I passed "SG=image1" to initGRASS() and now I get the full extent of the image back.

Thanks Roger

>-----Original Message-----
>From: Roger Bivand [mailto:Roger.Bivand at nhh.no]
>Sent: 28 janvier 2011 14:59
>To: Pierre Racine
>Cc: r-sig-geo
>Subject: Re: [R-sig-Geo] Problem reading back a raster from GRASS
>
>On Fri, 28 Jan 2011, Pierre Racine wrote:
>
>> Hi,
>>
>> It seems I'm having problem storing a raster into GRASS using the
>> spgrass6 package. I writeRAST6() a 1376x1376 raster to GRASS, but when I
>> readRAST6() it back to R the raster is only 1x1 pixels... Note that the
>> raster is a bmp and hence is not projected to any coordinate system.
>>
>> I must be doing something wrong. Here is my R code:
>
>What is the current region of your GRASS location? You can check by
>looking at the output of gmeta6(). If it does not match the extent of the
>file, you may experience this. Have you checked the extent of the data as
>seem by GRASS before reading it back? Are you running R within GRASS or
>did you start GRASS with initGRASS() from within R? If you used initGRASS,
>did you use the SG= argument?
>
>Roger
>
>>
>> ------------------------------------------------------------------
>>> image1 = readGDAL("D:/temp/image01.bmp")
>>  D:/Clients/AlainPaquette/AnalyseDeCimeR/images/image01.bmp has GDAL driver BMP
>>  and has 1376 rows and 1376 columns
>>
>>> summary(image1)
>>  Object of class SpatialGridDataFrame
>>  Coordinates:
>>         min     max
>>  x    -2953 8123703
>>  y -8123703    2953
>>  Is projected: NA
>>  proj4string : [NA]
>>  Number of points: 2
>>  Grid attributes:
>>    cellcentre.offset cellsize cells.dim
>>  x                 0     5906      1376
>>  y          -8120750     5906      1376
>>  Data attributes:
>>     Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
>>   0.0000  1.0000  1.0000  0.9962  1.0000  1.0000
>>
>>> writeRAST6(image1, "image1", overwrite=TRUE)
>>  ATTENTION : Raster map <image1> already exists and will be overwritten
>>  Projection of input dataset and current location appear to match
>>
>>  RINGDA~1 termin?. Raster map <image1> created.
>>
>>> image1_2 <-  readRAST6(c("image1"), cat=c(TRUE), ignore.stderr=TRUE, plugin=NULL)
>>
>>> summary(image1_2)
>>  Object of class SpatialGridDataFrame
>>  Coordinates:
>>    min max
>>  x   0   1
>>  y   0   1
>>  Is projected: NA
>>  proj4string : [NA]
>>  Number of points: 2
>>  Grid attributes:
>>    cellcentre.offset cellsize cells.dim
>>  x               0.5        1         1
>>  y               0.5        1         1
>>  Data attributes:
>>
>>  1
>>
>>>
>> ------------------------------------------------------------------
>>
>> Thanks,
>>
>> Pierre
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>--
>Roger Bivand
>Economic Geography Section, Department of Economics, Norwegian School of
>Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>e-mail: Roger.Bivand at nhh.no


From r.turner at auckland.ac.nz  Sat Jan 29 00:11:44 2011
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Sat, 29 Jan 2011 12:11:44 +1300
Subject: [R-sig-Geo] Issue with as.polygonal (gpclib disabled?)
In-Reply-To: <4D43054C.9090607@ub.edu>
References: <4D43054C.9090607@ub.edu>
Message-ID: <AF27DC24-150E-406C-83F8-A809D1CDB267@auckland.ac.nz>


Try setting:

	spatstat.options(gpclib=TRUE)

You would have found out about this if you'd done

	licence.polygons()

as the start-up message from spatstat suggests.

	cheers,

		Rolf Turner

P. S.  The help on spatstat.options() says that gpclib defaults
to TRUE.  This is an error.  It now defaults to FALSE.  We will
fix this glitch in the help in the next release.

		R. T.

On 29/01/2011, at 7:05 AM, Jos? M. Blanco Moreno wrote:

> Dear R users,
> I have been trying to convert a mask owin object (generated by  
> dilation)
> to a polygonal owin, but I am facing the following error message,  
> and I
> have not been able to find the solution, neither among the
> documentation, nor in the mailing lists. Any hint? I know that some
> packages (one package, perhaps) have changed recently (months ago)  
> their
> default behaviour with regards to gpclib, and I wonder if spatstats is
> one of these.
> Thank you in advance,
> Jos? M.
>
> ##############################
>> library(spatstat); library(gpclib)
>
>> pins <- cbind(x=rnorm(60),y=rnorm(60))
>
>> pins <- as.data.frame(pins)
>
>> pins.owin <- owin(poly=pins[rev(chull(pins)),])
>
>> pins.dil <- dilation(pins.owin,r=0.25)
>
>> pins.dil <- simplify.owin(dilation(pins.owin,r=0.25))
> # Warning message:
> # In as.polygonal(W) :
> #   Can't convert mask to polygon: gpclib is disabled/unavailable
>
>> perimeter(pins.dil)
> # Error in as.psp.owin(p) : x is a mask
> # In addition: Warning messages:
> # 1: In as.polygonal(w) :
> #   Can't convert mask to polygon: gpclib is disabled/unavailable
> # 2: In as.polygonal(W) :
> #  Can't convert mask to polygon: gpclib is disabled/unavailable
>
> ##############################
> ## However I can execute the following example from gpclib
>> holepoly <- read.polyfile(system.file("poly-ex/hole-poly.txt",  
>> package =
> + "gpclib"), nohole = FALSE)
>
>> area.poly(holepoly)
>
>> sessionInfo()
> R version 2.11.0 (2010-04-22)
> i386-pc-mingw32
>
> locale:
> [1] LC_COLLATE=Spanish_Spain.1252  LC_CTYPE=Spanish_Spain.1252
> [3] LC_MONETARY=Spanish_Spain.1252 LC_NUMERIC=C
> [5] LC_TIME=Spanish_Spain.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] gpclib_1.5-1    spatstat_1.21-0 deldir_0.0-12   mgcv_1.7-1
>
> loaded via a namespace (and not attached):
> [1] grid_2.11.0        lattice_0.19-13    Matrix_0.999375-44  
> nlme_3.1-97
> [5] tools_2.11.0
>
> -- 
> ---------------------------------------
> Jos? M. Blanco-Moreno
>
> Dept. de Biologia Vegetal (Bot?nica)
> Facultat de Biologia
> Universitat de Barcelona
> Av. Diagonal 645
> 08028 Barcelona
> SPAIN
> ---------------------------------------
>
> phone: (+34) 934 039 863
> fax: (+34) 934 112 842
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From wjbyrd at troy.edu  Sat Jan 29 05:11:52 2011
From: wjbyrd at troy.edu (Jennings Byrd)
Date: Fri, 28 Jan 2011 22:11:52 -0600
Subject: [R-sig-Geo] gstsls and lamda
Message-ID: <000001cbbf6a$ab0792f0$0116b8d0$@troy.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110128/39de3ca0/attachment.pl>

From jmblanco at ub.edu  Sat Jan 29 20:40:29 2011
From: jmblanco at ub.edu (=?ISO-8859-1?Q?=22Jos=E9_M=2E_Blanco_Moreno=22?=)
Date: Sat, 29 Jan 2011 20:40:29 +0100
Subject: [R-sig-Geo] Issue with as.polygonal (gpclib disabled?)
In-Reply-To: <AF27DC24-150E-406C-83F8-A809D1CDB267@auckland.ac.nz>
References: <4D43054C.9090607@ub.edu>
	<AF27DC24-150E-406C-83F8-A809D1CDB267@auckland.ac.nz>
Message-ID: <4D446D2D.7040905@ub.edu>

Oops, sorry about that, I did not read the start-up message.
Thanks.
Jos? M.

Al 29/01/2011 0:11, En/na Rolf Turner ha escrit:
>
> Try setting:
>
>     spatstat.options(gpclib=TRUE)
>
> You would have found out about this if you'd done
>
>     licence.polygons()
>
> as the start-up message from spatstat suggests.
>
>     cheers,
>
>         Rolf Turner
>
> P. S.  The help on spatstat.options() says that gpclib defaults
> to TRUE.  This is an error.  It now defaults to FALSE.  We will
> fix this glitch in the help in the next release.
>
>         R. T.
>
> On 29/01/2011, at 7:05 AM, Jos? M. Blanco Moreno wrote:
>
>> Dear R users,
>> I have been trying to convert a mask owin object (generated by dilation)
>> to a polygonal owin, but I am facing the following error message, and I
>> have not been able to find the solution, neither among the
>> documentation, nor in the mailing lists. Any hint? I know that some
>> packages (one package, perhaps) have changed recently (months ago) their
>> default behaviour with regards to gpclib, and I wonder if spatstats is
>> one of these.
>> Thank you in advance,
>> Jos? M.
>>
>> ##############################
>>> library(spatstat); library(gpclib)
>>
>>> pins <- cbind(x=rnorm(60),y=rnorm(60))
>>
>>> pins <- as.data.frame(pins)
>>
>>> pins.owin <- owin(poly=pins[rev(chull(pins)),])
>>
>>> pins.dil <- dilation(pins.owin,r=0.25)
>>
>>> pins.dil <- simplify.owin(dilation(pins.owin,r=0.25))
>> # Warning message:
>> # In as.polygonal(W) :
>> #   Can't convert mask to polygon: gpclib is disabled/unavailable
>>
>>> perimeter(pins.dil)
>> # Error in as.psp.owin(p) : x is a mask
>> # In addition: Warning messages:
>> # 1: In as.polygonal(w) :
>> #   Can't convert mask to polygon: gpclib is disabled/unavailable
>> # 2: In as.polygonal(W) :
>> #  Can't convert mask to polygon: gpclib is disabled/unavailable
>>
>> ##############################
>> ## However I can execute the following example from gpclib
>>> holepoly <- read.polyfile(system.file("poly-ex/hole-poly.txt", 
>>> package =
>> + "gpclib"), nohole = FALSE)
>>
>>> area.poly(holepoly)
>>
>>> sessionInfo()
>> R version 2.11.0 (2010-04-22)
>> i386-pc-mingw32
>>
>> locale:
>> [1] LC_COLLATE=Spanish_Spain.1252  LC_CTYPE=Spanish_Spain.1252
>> [3] LC_MONETARY=Spanish_Spain.1252 LC_NUMERIC=C
>> [5] LC_TIME=Spanish_Spain.1252
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> other attached packages:
>> [1] gpclib_1.5-1    spatstat_1.21-0 deldir_0.0-12   mgcv_1.7-1
>>
>> loaded via a namespace (and not attached):
>> [1] grid_2.11.0        lattice_0.19-13    Matrix_0.999375-44 nlme_3.1-97
>> [5] tools_2.11.0
>>
>> -- 
>> ---------------------------------------
>> Jos? M. Blanco-Moreno
>>
>> Dept. de Biologia Vegetal (Bot?nica)
>> Facultat de Biologia
>> Universitat de Barcelona
>> Av. Diagonal 645
>> 08028 Barcelona
>> SPAIN
>> ---------------------------------------
>>
>> phone: (+34) 934 039 863
>> fax: (+34) 934 112 842
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
---------------------------------------
Jos? M. Blanco-Moreno

Dept. de Biologia Vegetal (Bot?nica)
Facultat de Biologia
Universitat de Barcelona
Av. Diagonal 645
08028 Barcelona
SPAIN
---------------------------------------

phone: (+34) 934 039 863
fax: (+34) 934 112 842


From chethanuniversal at gmail.com  Sun Jan 30 15:48:36 2011
From: chethanuniversal at gmail.com (Chethan S)
Date: Sun, 30 Jan 2011 20:18:36 +0530
Subject: [R-sig-Geo] Moving window to generate variogram,
	cross-variogram etc.
Message-ID: <AANLkTi=GejbQdMpd-Sy5C9q=nSEvJ0G4u=PBL7CZSXuT@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110130/f2092b5e/attachment.pl>

From pajak at europa-uni.de  Mon Jan 31 00:26:31 2011
From: pajak at europa-uni.de (DPajak)
Date: Sun, 30 Jan 2011 15:26:31 -0800 (PST)
Subject: [R-sig-Geo] UnionSpatialPolygons in the German DEU_adm3.RData file
Message-ID: <1296429991161-5975724.post@n2.nabble.com>


Hello,

actually I started to learn how to produce a choropleth map today. So
hopefully somebody can help me?

I want to use the GADM data file for Germany (DEU_adm3.RData) along with
some data from my dissertation in business studies. So far so good. Since
there are some good examples out there it was easy to merge those two files.

The problem I have is due to some local government reorganizations (e.g. the
Kreisgebietsreform 2008 in Saxony).

So I have to merge some district in the DEU_adm3.RData file. 

I learnt today, that the "UnionSpatialPolygons" of the GPC library can do
that. 

So I tried to figured out, how to use this function. Here is what I have so
far:

---
library(sp)
library(maptools)
library(gpclib) #
http://en.wikipedia.org/wiki/GPC_General_Polygon_Clipper_Library
gpclibPermit() 
Germany <-load("./Dropbox/Projekte/Spatial Map/DEU_adm3.RData")

write.csv(gadm, "gadm-data.csv")

# ID_3 for the three former districts D?beln (23204), Freiberg (23185) &
Mittweida (23187)

Merge_Mittelsachsen <- gadm[gadm$ID_3 %in% c("23185","23187","23204"),]
ID <- rep("Mittelsachsen", length(slot(Merge_Mittelsachsen, "polygons")))
Mittelsachsen <- unionSpatialPolygons(Merge_Mittelsachsen, ID)
plot(Mittelsachsen)
---

This works perfectly to plot the new district of Mittelsachsen
(Middle-Saxony). 

But how can I combine this new merged district with the rest of the German
map? Or in others words, how can I overwrite the former three separated
districts with my new "Mittelsachsen" polygon.

Thank you very much for any hints you can give me.

Danny Pajak




-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/UnionSpatialPolygons-in-the-German-DEU-adm3-RData-file-tp5975724p5975724.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From elaine.kuo.tw at gmail.com  Mon Jan 31 00:42:51 2011
From: elaine.kuo.tw at gmail.com (elaine kuo)
Date: Mon, 31 Jan 2011 07:42:51 +0800
Subject: [R-sig-Geo] how to calculate areas of shape files using R
Message-ID: <AANLkTi=-Gz0Q7RTMNMtLK+3jgDsg0x5_g20oH_NnJDF1@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110131/0ccb21c9/attachment.pl>

From jeffrey.stratford at wilkes.edu  Mon Jan 31 01:55:52 2011
From: jeffrey.stratford at wilkes.edu (Stratford, Jeffrey)
Date: Sun, 30 Jan 2011 19:55:52 -0500
Subject: [R-sig-Geo] creating an adjacency matrix in spdep
Message-ID: <72B2B2BDFE51E64DAC6381495614980006A3756B@STAFFEXCHVS3.wilkesu.wilkes.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110130/5c2d8019/attachment.pl>

From roman.lustrik at gmail.com  Mon Jan 31 08:56:53 2011
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Mon, 31 Jan 2011 08:56:53 +0100
Subject: [R-sig-Geo] how to calculate areas of shape files using R
In-Reply-To: <AANLkTi=-Gz0Q7RTMNMtLK+3jgDsg0x5_g20oH_NnJDF1@mail.gmail.com>
References: <AANLkTi=-Gz0Q7RTMNMtLK+3jgDsg0x5_g20oH_NnJDF1@mail.gmail.com>
Message-ID: <AANLkTik2aPayvEUu1vJvBa1bz96FUyhw3LFbyr3mAGve@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110131/d39a0b5c/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Mon Jan 31 09:17:25 2011
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Mon, 31 Jan 2011 08:17:25 +0000
Subject: [R-sig-Geo] UnionSpatialPolygons in the German DEU_adm3.RData
	file
In-Reply-To: <1296429991161-5975724.post@n2.nabble.com>
References: <1296429991161-5975724.post@n2.nabble.com>
Message-ID: <AANLkTinPrnd8OMst-ZWsyYF2SGBZxB8zsNF14A5UuVWd@mail.gmail.com>

On Sun, Jan 30, 2011 at 11:26 PM, DPajak <pajak at europa-uni.de> wrote:
>
> Hello,
>
> actually I started to learn how to produce a choropleth map today. So
> hopefully somebody can help me?
>
> I want to use the GADM data file for Germany (DEU_adm3.RData) along with
> some data from my dissertation in business studies. So far so good. Since
> there are some good examples out there it was easy to merge those two files.
>
> The problem I have is due to some local government reorganizations (e.g. the
> Kreisgebietsreform 2008 in Saxony).
>
> So I have to merge some district in the DEU_adm3.RData file.
>
> I learnt today, that the "UnionSpatialPolygons" of the GPC library can do
> that.
>
> So I tried to figured out, how to use this function. Here is what I have so
> far:
>
> ---
> library(sp)
> library(maptools)
> library(gpclib) #
> http://en.wikipedia.org/wiki/GPC_General_Polygon_Clipper_Library
> gpclibPermit()
> Germany <-load("./Dropbox/Projekte/Spatial Map/DEU_adm3.RData")
>
> write.csv(gadm, "gadm-data.csv")
>
> # ID_3 for the three former districts D?beln (23204), Freiberg (23185) &
> Mittweida (23187)
>
> Merge_Mittelsachsen <- gadm[gadm$ID_3 %in% c("23185","23187","23204"),]
> ID <- rep("Mittelsachsen", length(slot(Merge_Mittelsachsen, "polygons")))
> Mittelsachsen <- unionSpatialPolygons(Merge_Mittelsachsen, ID)
> plot(Mittelsachsen)
> ---
>
> This works perfectly to plot the new district of Mittelsachsen
> (Middle-Saxony).
>
> But how can I combine this new merged district with the rest of the German
> map? Or in others words, how can I overwrite the former three separated
> districts with my new "Mittelsachsen" polygon.
>
> Thank you very much for any hints you can give me.

 Sometimes things are easier to do in something other than R (although
this is the point where Roger sends in a two-line R snippet to do
this).

 I'd fire up my favourite Free Open Source GIS package, Quantum GIS,
load the shapefile vector, enable editing, select the polygons, hit
the merge button, choose which of the original polygons attributes to
include (or construct new ones, such as summing the population of the
original three), save, and job done. Load it into R for your stats.

 www.qgis.org

Barry


From Roger.Bivand at nhh.no  Mon Jan 31 09:19:45 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 31 Jan 2011 09:19:45 +0100 (CET)
Subject: [R-sig-Geo] UnionSpatialPolygons in the German DEU_adm3.RData
 file
In-Reply-To: <1296429991161-5975724.post@n2.nabble.com>
References: <1296429991161-5975724.post@n2.nabble.com>
Message-ID: <alpine.LRH.2.00.1101310916130.12919@reclus.nhh.no>

On Sun, 30 Jan 2011, DPajak wrote:

>
> Hello,
>
> actually I started to learn how to produce a choropleth map today. So
> hopefully somebody can help me?
>
> I want to use the GADM data file for Germany (DEU_adm3.RData) along with
> some data from my dissertation in business studies. So far so good. Since
> there are some good examples out there it was easy to merge those two files.
>
> The problem I have is due to some local government reorganizations (e.g. the
> Kreisgebietsreform 2008 in Saxony).
>
> So I have to merge some district in the DEU_adm3.RData file. 
>
> I learnt today, that the "UnionSpatialPolygons" of the GPC library can do
> that. 
>
> So I tried to figured out, how to use this function. Here is what I have so
> far:
>
> ---
> library(sp)
> library(maptools)
> library(gpclib) #
> http://en.wikipedia.org/wiki/GPC_General_Polygon_Clipper_Library
> gpclibPermit() 
> Germany <-load("./Dropbox/Projekte/Spatial Map/DEU_adm3.RData")
>
> write.csv(gadm, "gadm-data.csv")
>
> # ID_3 for the three former districts D?beln (23204), Freiberg (23185) &
> Mittweida (23187)
>
> Merge_Mittelsachsen <- gadm[gadm$ID_3 %in% c("23185","23187","23204"),]
> ID <- rep("Mittelsachsen", length(slot(Merge_Mittelsachsen, "polygons")))
> Mittelsachsen <- unionSpatialPolygons(Merge_Mittelsachsen, ID)
> plot(Mittelsachsen)
> ---
>
> This works perfectly to plot the new district of Mittelsachsen
> (Middle-Saxony).

IDs <- gadm$ID_3
IDs[IDs %in% c("23185","23187","23204")] <- "Merge_Mittelsachsen"
gadm_new <- unionSpatialPolygons(gadm, IDs)

The unaltered entities are passed through unchanged, the non-unique IDs 
are merged.

Roger

>
> But how can I combine this new merged district with the rest of the German
> map? Or in others words, how can I overwrite the former three separated
> districts with my new "Mittelsachsen" polygon.
>
> Thank you very much for any hints you can give me.
>
> Danny Pajak
>
>
>
>
> -- 
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/UnionSpatialPolygons-in-the-German-DEU-adm3-RData-file-tp5975724p5975724.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From edzer.pebesma at uni-muenster.de  Mon Jan 31 09:21:10 2011
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 31 Jan 2011 09:21:10 +0100
Subject: [R-sig-Geo] Extracting "lines" from ArcGIS file
In-Reply-To: <AANLkTi=2CVVRedmiEN0dDX4F0fAC647xQ7EPptL8kQYJ@mail.gmail.com>
References: <20110128140316.19577g6k8qdcpd3o@webmail.univ-pau.fr>
	<AANLkTi=2CVVRedmiEN0dDX4F0fAC647xQ7EPptL8kQYJ@mail.gmail.com>
Message-ID: <4D4670F6.3010209@uni-muenster.de>



On 01/28/2011 03:42 PM, Barry Rowlingson wrote:
> On Fri, Jan 28, 2011 at 1:03 PM, Christian Paroissin
> <christian.paroissin at univ-pau.fr> wrote:
>> Hello,
>>
>> I have downloaded an Arcgis file here:
>> http://services.sandre.eaufrance.fr/data/zonage/Hydrographie2010/arcgis/Bassins/AG/COURS_D_EAU.SHP.zip
>>
>> I would like to extract informations from these dataset. It gives an S4
>> object but I know nothing about it. Here is the code I wrote:
>>
>> [code]
>> object1.shp <- readShapeSpatial("Cours-AG/COURS_D_EAU.shp")
>> index= which(object1.shp$TOPONYME=="L'Adour")
>> object1.shp[index,]
>> [/code]
>>
>> I would like to extract the 'information' called "lines" but I don't known
>> how do it. I find how to extract the 'information' "bbox"
>> [quote]
>> object1.shp[index,]@bbox
>> object1.shp[index,]@lines
>> [/quote]
>>
>> Could you help me please?
>>
>> Do "lines" correspond to the coordinates of the different points defining
>> the river ("L'Adour" in my case)?
> 
>  Yes. but rivers are never simple. The data structure is therefore complex :)
> 
>  object1.shp is a SpatialLinesDataFrame. Its a bit like a dataframe,
> but with a geometry for each row. Each row is a 'feature' - not
> necessarily a single wiggly line, it could be several lines. In your
> case it seems there is one of everything, so you can do:
> 
> object1.shp[index,]@lines[[1]]@Lines[[1]]@coords
> 
> to get a 2-column matrix of the coordinates of that feature.

What will also work is:

coordinates(object1.shp[index,])[[1]][[1]]

> 
> See the help for SpatialLinesDataFrame and the vignette for the sp
> package and the ASDAR book for more.
> 
> Barry
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From Roger.Bivand at nhh.no  Mon Jan 31 09:29:37 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 31 Jan 2011 09:29:37 +0100 (CET)
Subject: [R-sig-Geo] creating an adjacency matrix in spdep
In-Reply-To: <72B2B2BDFE51E64DAC6381495614980006A3756B@STAFFEXCHVS3.wilkesu.wilkes.edu>
References: <72B2B2BDFE51E64DAC6381495614980006A3756B@STAFFEXCHVS3.wilkesu.wilkes.edu>
Message-ID: <alpine.LRH.2.00.1101310919580.12919@reclus.nhh.no>

On Sun, 30 Jan 2011, Stratford, Jeffrey wrote:

> Hi everyone,
>
>
>
> Is it possible to create an adjacency matrix required for
> WinBUGS/GeoBUGS in spdep from a csv file containing UTM coordinates?
>
>
>
> I've gone through the spdep documentation and it looks like the
> equivalent there is col.gal.nb?  Is that right?  I see where that object
> is used but not how it was created.
>

There is plenty of documentation in spdep on the creation of nb objects if 
you look for it. For point support (your case), you can choose between 
dnearneigh() for distance-based neighbours, knn2nb(knearneigh()) for k 
nearest neighbours (will need making summetric with make.sym.nb() for 
WinBUGS), or the various graph2nb() variants (which may also need making 
symmetric). The case you refer to from ?nb2WB refers to ?columbus, which 
explains that col.gal.nb is an nb object imported from an original 
GAL-format file for compatibility with GeoDa - the example shows how, 
using read.gal(). You should also be able to read the *.gal or *.gwt files 
you made in GeoDa with read.gal() or read.gwt2nb(), then out again with 
nb2WB().

Hope this helps,

Roger

>
>
> I also realize that I can get the same through GeoDa but I haven't been
> able to figure out how to export the adj matrix from there.
>
>
>
> Many thanks,
>
>
>
> Jeff
>
>
>
> *****************************************
>
> Jeffrey A. Stratford, Ph.D.
>
> Department of Health and Biological Sciences
>
> 84 W. South St.
>
> Wilkes Univertsity, PA 18766
>
> 570-332-2942
>
> http://web.wilkes.edu/jeffrey.stratford/
>
> *****************************************
>
>
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Mon Jan 31 09:59:20 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 31 Jan 2011 09:59:20 +0100 (CET)
Subject: [R-sig-Geo] how to calculate areas of shape files using R
In-Reply-To: <AANLkTik2aPayvEUu1vJvBa1bz96FUyhw3LFbyr3mAGve@mail.gmail.com>
References: <AANLkTi=-Gz0Q7RTMNMtLK+3jgDsg0x5_g20oH_NnJDF1@mail.gmail.com>
	<AANLkTik2aPayvEUu1vJvBa1bz96FUyhw3LFbyr3mAGve@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1101310930160.12919@reclus.nhh.no>

On Mon, 31 Jan 2011, Roman Lu?trik wrote:

> When you convert your polygons to Spatial object, the area will be
> accessible through the slots. This can be very tedious to grasp at first
> (but try str()). For instance, for a SpatialPolygons of one Polygon

A small caveat - if the coordinates are planar, the explanation holds, if 
geographical (degrees), it doesn't. The naive area values have been used 
internally to plot larger Polygon objects before smaller Polygon objects, 
to avoid overplotting in earlier versions of R that did not "identify" 
holes automatically. So first make sure that you have planar coordinates, 
otherwise the "area" values have no metric. If need be, project with 
spTransform() methods in rgdal. If I recall, Elaine was working with an 
area covering much of the Western Pacific, hence the remark - hopefully, 
this question is about a project with a smaller extent.

In addition, if the Polygons objects are simple (one Polygon object per 
Polygons object), the "area" slot of the Polygons object is equal to that 
of the member Polygon, and:

sapply(slot(SP, "polygons"), slot, "area")

will return a vector of areas. Check with:

sapply(slot(SP, "polygons"), function(x) length(slot(x, "Polygons")))

If there are non-simple Polygons objects (with more than one Polygon 
member), we also need to check whether there are holes (or should be - try 
plot() too) - see below. If there are real holes not declared as holes, 
the total area will be inflated.

Example:

library(maptools)
fn <- system.file("shapes/sids.shp", package="maptools")[1]
prj <- CRS("+proj=longlat +ellps=clrk66")
xx <- readShapeSpatial(fn, IDvar="FIPSNO", proj4string=prj) 
library(rgdal)
xxx <- spTransform(xx, CRS("+init=epsg:3631"))
# NC State Plane latest
sapply(slot(xxx, "polygons"), function(x) length(slot(x, "Polygons")))
# some non-simple Polygons objects
sapply(slot(xxx, "polygons"), function(x) {
   xi <- slot(x, "Polygons")
   any(sapply(xi, slot, "hole"))
})
# no declared holes
sapply(slot(xxx, "polygons"), slot, "area")
# areas in square metres

Here the non-simple Polygons objects are counties made up of more than one 
part/island, with no holes. checkPolygonsHoles() in maptools may be used 
to check hole status if required.

Hope this helps,

Roger

>
>> my.object
> An object of class "SpatialPolygons"
> Slot "polygons":
> [[1]]
> An object of class "Polygons"
> Slot "Polygons":
> [[1]]
> An object of class "Polygon"
> Slot "labpt":
> [1] -38.80103  29.16010
>
> Slot "area":
> [1] 14371.66
>
> Slot "hole":
> [1] FALSE
>
> Slot "ringDir":
> [1] 1
>
> Slot "coords":
>           [,1]      [,2]
> [1,] -109.76555  61.91851
> [2,]   21.09385 105.52317
> [3,]   21.09385 -29.65128
> [4,] -105.85930 -25.29081
> [5,] -109.76555  61.91851
>
>
>
> Slot "plotOrder":
> [1] 1
>
> Slot "labpt":
> [1] -38.80103  29.16010
>
> Slot "ID":
> [1] "1"
>
> Slot "area":
> [1] 14371.66
>
>
>
> Slot "plotOrder":
> [1] 1
>
> Slot "bbox":
>         min       max
> x -109.76555  21.09385
> y  -29.65128 105.52317
>
> Slot "proj4string":
> CRS arguments: NA
>
> And for this particular case, you can access the area slot through
>
>
> my.object at polygons[[1]]@Polygons[[1]]@area
>
>
> Cheers,
> Roman
>
>
>
>
> On Mon, Jan 31, 2011 at 12:42 AM, elaine kuo <elaine.kuo.tw at gmail.com>wrote:
>
>> Dear List,
>>
>> I am dealing with hundreds of shape files. (generated by ArcGIS 9.3)
>> They are composed of multiple polygons.
>> The polygons are classified as 1, 2, 3, and 4 according to their seasonal
>> status.
>>
>> I want to calculate the total areas of each shape files.
>> Furthermore, the areas of 1, 2, 3, and 4 are also needed to be computed for
>> each shape file.
>>
>> Please kindly advise if it is possible to use R packages and functions are
>> suitable for the tasks.
>> (may be adehabitat)
>> Thank you.
>>
>> Elaine
>>
>>        [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From pajak at europa-uni.de  Mon Jan 31 10:25:09 2011
From: pajak at europa-uni.de (DPajak)
Date: Mon, 31 Jan 2011 01:25:09 -0800 (PST)
Subject: [R-sig-Geo] UnionSpatialPolygons in the German DEU_adm3.RData
	file
In-Reply-To: <alpine.LRH.2.00.1101310916130.12919@reclus.nhh.no>
References: <1296429991161-5975724.post@n2.nabble.com>
	<alpine.LRH.2.00.1101310916130.12919@reclus.nhh.no>
Message-ID: <1296465909210-5976551.post@n2.nabble.com>


Thank very much Roger. By doing this, I am loosing the information from the
original GADM-file, right?

So what else I have to do, to have a file with all the information I had
before, so I can use IDs to match my data, color the map, ... 

I used the following function spplot function before: 

--
Map = spplot(gadm, "NAME_3", col.regions=col, main="Germany", colorkey =
FALSE, lwd=.6, col="white")
--

Kinds regards 

Danny

-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/UnionSpatialPolygons-in-the-German-DEU-adm3-RData-file-tp5975724p5976551.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Roger.Bivand at nhh.no  Mon Jan 31 10:45:28 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 31 Jan 2011 10:45:28 +0100 (CET)
Subject: [R-sig-Geo] UnionSpatialPolygons in the German DEU_adm3.RData
 file
In-Reply-To: <1296465909210-5976551.post@n2.nabble.com>
References: <1296429991161-5975724.post@n2.nabble.com>
	<alpine.LRH.2.00.1101310916130.12919@reclus.nhh.no>
	<1296465909210-5976551.post@n2.nabble.com>
Message-ID: <alpine.LRH.2.00.1101311032351.12919@reclus.nhh.no>

On Mon, 31 Jan 2011, DPajak wrote:

>
> Thank very much Roger. By doing this, I am loosing the information from the
> original GADM-file, right?
>
> So what else I have to do, to have a file with all the information I had
> before, so I can use IDs to match my data, color the map, ...
>
> I used the following function spplot function before:
>
> --
> Map = spplot(gadm, "NAME_3", col.regions=col, main="Germany", colorkey =
> FALSE, lwd=.6, col="white")

By merging the Polygons objects, you have "wiped" their aggregated 
attributes - because unionSpatialPolygons() only merges the Polygons 
objects. So you could use a standard aggregation tool to aggregate the 
data.frame object in the data slot, and re-assemble later:

library(maptools)
nc1 <- readShapePoly(system.file("shapes/sids.shp",
   package="maptools")[1], proj4string=CRS("+proj=longlat +datum=NAD27"))
lps <- coordinates(nc1)
ID <- cut(lps[,1], quantile(lps[,1]), include.lowest=TRUE)
reg4 <- unionSpatialPolygons(nc1, ID)
row.names(reg4)
df <- as(nc1, "data.frame")
sapply(df, class)
dfa <- aggregate(df[,9:14], list(ID), sum)
sapply(df[,9:14], sum)
sapply(dfa[,2:7], sum)
row.names(dfa) <- as.character(dfa$Group.1)
nc2 <- SpatialPolygonsDataFrame(reg4, dfa)

But, as always, you need to make choices in aggregation to the variables 
in the data frame that can be aggregated, and about how to do it.

Hope this helps,

Roger


> --
>
> Kinds regards
>
> Danny
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From elaine.kuo.tw at gmail.com  Mon Jan 31 11:10:42 2011
From: elaine.kuo.tw at gmail.com (elaine kuo)
Date: Mon, 31 Jan 2011 18:10:42 +0800
Subject: [R-sig-Geo] how to calculate areas of shape files using R
In-Reply-To: <alpine.LRH.2.00.1101310930160.12919@reclus.nhh.no>
References: <AANLkTi=-Gz0Q7RTMNMtLK+3jgDsg0x5_g20oH_NnJDF1@mail.gmail.com>
	<AANLkTik2aPayvEUu1vJvBa1bz96FUyhw3LFbyr3mAGve@mail.gmail.com>
	<alpine.LRH.2.00.1101310930160.12919@reclus.nhh.no>
Message-ID: <AANLkTikWicP3M7XcVWg531M3+bkip2s9kxhurmnoY1EA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110131/44c45179/attachment.pl>

From roman.lustrik at gmail.com  Mon Jan 31 11:19:28 2011
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Mon, 31 Jan 2011 11:19:28 +0100
Subject: [R-sig-Geo] how to calculate areas of shape files using R
In-Reply-To: <AANLkTikWicP3M7XcVWg531M3+bkip2s9kxhurmnoY1EA@mail.gmail.com>
References: <AANLkTi=-Gz0Q7RTMNMtLK+3jgDsg0x5_g20oH_NnJDF1@mail.gmail.com>
	<AANLkTik2aPayvEUu1vJvBa1bz96FUyhw3LFbyr3mAGve@mail.gmail.com>
	<alpine.LRH.2.00.1101310930160.12919@reclus.nhh.no>
	<AANLkTikWicP3M7XcVWg531M3+bkip2s9kxhurmnoY1EA@mail.gmail.com>
Message-ID: <AANLkTi=KNfFCp_4u13BjWPkZRX+AcVVuRqY59D2bNpzm@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110131/68bd15e4/attachment.pl>

From jaimebg27 at gmail.com  Mon Jan 31 19:24:53 2011
From: jaimebg27 at gmail.com (=?ISO-8859-1?Q?Jaime_Burbano_Gir=F3n?=)
Date: Mon, 31 Jan 2011 13:24:53 -0500
Subject: [R-sig-Geo] Help Exporting ShapeFiles
Message-ID: <AANLkTim4_sJ_cA8eJocFndDxQanSLZVE6U3uNVcZ3eQM@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110131/3f6f6797/attachment.pl>

From kmcoulib at gmail.com  Mon Jan 31 20:26:02 2011
From: kmcoulib at gmail.com (kapo coulibaly)
Date: Mon, 31 Jan 2011 14:26:02 -0500
Subject: [R-sig-Geo] Help Exporting ShapeFiles
In-Reply-To: <AANLkTim4_sJ_cA8eJocFndDxQanSLZVE6U3uNVcZ3eQM@mail.gmail.com>
References: <AANLkTim4_sJ_cA8eJocFndDxQanSLZVE6U3uNVcZ3eQM@mail.gmail.com>
Message-ID: <AANLkTi=babGUq_ZrQfUK6nbaOU4zG8EUp_kNsezxYgvp@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110131/9262d845/attachment.pl>

From Roger.Bivand at nhh.no  Mon Jan 31 20:42:54 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 31 Jan 2011 20:42:54 +0100 (CET)
Subject: [R-sig-Geo] Help Exporting ShapeFiles
In-Reply-To: <AANLkTi=babGUq_ZrQfUK6nbaOU4zG8EUp_kNsezxYgvp@mail.gmail.com>
References: <AANLkTim4_sJ_cA8eJocFndDxQanSLZVE6U3uNVcZ3eQM@mail.gmail.com>
	<AANLkTi=babGUq_ZrQfUK6nbaOU4zG8EUp_kNsezxYgvp@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1101312040070.15782@reclus.nhh.no>

On Mon, 31 Jan 2011, kapo coulibaly wrote:

>> From what I can gather with your code:
> - check the result of your Paste command and make sure it is a valid path.
> - Also make sure your object a (in writePolyShape(a,Dir)) is a
> SpatialPolygonsDataFrame object, it seems to me that it is a plain data
> frame. You can convert it with the sp package command
> SpatialPolygonsDataFrame.

In addition, you might like to check whether you have a recent version of 
maptools (use update.packages()), because the foreign package containing 
write.dbf() was changed, calling for changes in writePolyShape(). Always 
give the output of sessionInfo() when asking questions like these.

Roger

>
> Hope it helps
>
> 2011/1/31 Jaime Burbano Gir?n <jaimebg27 at gmail.com>
>
>> Hi everybody, I am new using R with vector spatial data. I want to export 1
>> or a few polygons from my shapefile which has 421 polygons with the
>> function
>> "writePolyShape" from library maptools, but I get the following error:
>>
>> *Error en write.dbf(df, paste(file, ".dbf", sep = ""), factor2char =
>> factor2char,  :  unable to open file*
>>
>> This is the code:
>> *
>> Cuencas=readShapePoly("D:/Modelamiento_Hidrol?gico/Capas
>> Adicionales/Watershed_Final.shp")
>> A.Cuencas=as(Cuencas,"data.frame")
>> a=Cuencas[Cuencas$HydroID<151838,]
>> Dir=paste("D:/Modelamiento_Hidrol?gico/Watersheds",A.Cuencas[1,2],sep="/")
>> writePolyShape(a,Dir)
>
>
>
>> *
>>
>> I?ve tried exporting just 1 polygon, 2 or more, but the error is always the
>> same. I appreciate your help.
>>
>> Thanks a lot in advance and my best regards.
>>
>> --
>> Jaime Burbano Gir?n
>> Departamento de Ecolog?a y Territorio
>> Pontificia Universidad Javeriana
>> Bogot? - Colombia
>> (571) 3208320 Ext. 4836
>>
>>        [[alternative HTML version deleted]]
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>
> 	[[alternative HTML version deleted]]
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From markus.loecher at gmail.com  Mon Jan 31 21:41:50 2011
From: markus.loecher at gmail.com (Markus Loecher)
Date: Mon, 31 Jan 2011 15:41:50 -0500
Subject: [R-sig-Geo] kmlPolygon (maptools) with simple data frame/matrix
Message-ID: <AANLkTimOnu90O1NYoVdhJbQH=T7CVxsathv66YC+bhx-@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110131/9a25f678/attachment.pl>

From jaimebg27 at gmail.com  Mon Jan 31 21:51:28 2011
From: jaimebg27 at gmail.com (=?ISO-8859-1?Q?Jaime_Burbano_Gir=F3n?=)
Date: Mon, 31 Jan 2011 15:51:28 -0500
Subject: [R-sig-Geo] Help Exporting ShapeFiles
In-Reply-To: <alpine.LRH.2.00.1101312040070.15782@reclus.nhh.no>
References: <AANLkTim4_sJ_cA8eJocFndDxQanSLZVE6U3uNVcZ3eQM@mail.gmail.com>
	<AANLkTi=babGUq_ZrQfUK6nbaOU4zG8EUp_kNsezxYgvp@mail.gmail.com>
	<alpine.LRH.2.00.1101312040070.15782@reclus.nhh.no>
Message-ID: <AANLkTimVdCrj1kBHO8Y-2CJteU4+ciGo8wwpNZhrZ3+z@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110131/1d7a4581/attachment.pl>

From Roger.Bivand at nhh.no  Mon Jan 31 22:06:03 2011
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 31 Jan 2011 22:06:03 +0100 (CET)
Subject: [R-sig-Geo] kmlPolygon (maptools) with simple data frame/matrix
In-Reply-To: <AANLkTimOnu90O1NYoVdhJbQH=T7CVxsathv66YC+bhx-@mail.gmail.com>
References: <AANLkTimOnu90O1NYoVdhJbQH=T7CVxsathv66YC+bhx-@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1101312201030.15782@reclus.nhh.no>

On Mon, 31 Jan 2011, Markus Loecher wrote:

> Dear all,
> I am looking for example code that lets me use the kmlPolygon() function
> (pckg: maptools) with a simple (non projected) data frame of lat/lons.
> I found the documentation on converting data frames to SpatialPolygons in
> the package sp very sparse and that seems to be a prerequisite to use
> kmlPolygon() ?
>
> Wishful thinking would be the following:
>
> x <- cbind(lat = c(38.100, 38.100, 38.116, 38.116, 38.100), lon =
> c(-122.400, -122.384, -122.384, -122.400, -122.400) )

Always longitude first, latitude second, (x, y). Then:

x <- cbind(lon = c(-122.400, -122.384, -122.384, -122.400, -122.400),
   lat = c(38.100, 38.100, 38.116, 38.116, 38.100))
Pls <- Polygons(list(Polygon(x)), "1")
kmlPolygon(Pls)

Wishful is as simple as possible (and generic), but not more so ...

Roger


> kmlPolygon(x, ....)
>
> Thx,
>
> Markus Loecher
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Andrew.Duff at dfw.wa.gov  Mon Jan 31 23:19:59 2011
From: Andrew.Duff at dfw.wa.gov (Duff, Andrew A (DFW))
Date: Mon, 31 Jan 2011 14:19:59 -0800
Subject: [R-sig-Geo] filtering successive locations for kernelbb in
	adehabitat
Message-ID: <29B8F24E6C798B458FE57856ED8FF36101DD572A@ssvmxolydfw01.ssv.wa.lcl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20110131/944a6c03/attachment.pl>

From basille at ase-research.org  Mon Jan 31 23:32:35 2011
From: basille at ase-research.org (Mathieu Basille)
Date: Mon, 31 Jan 2011 17:32:35 -0500
Subject: [R-sig-Geo] filtering successive locations for kernelbb
	in	adehabitat
In-Reply-To: <29B8F24E6C798B458FE57856ED8FF36101DD572A@ssvmxolydfw01.ssv.wa.lcl>
References: <29B8F24E6C798B458FE57856ED8FF36101DD572A@ssvmxolydfw01.ssv.wa.lcl>
Message-ID: <4D473883.6070909@ase-research.org>

What about using a burst structure, with one burst for each period of
successive relocations? Use then the parameter 'byburst = TRUE' in the
kernelbb function.

You might want to have a look at 'cutltraj' to define the different
bursts, with a function that checks the time interval.

Hope this helps,
Mathieu.


Le 2011-01-31 17:19, Duff, Andrew A (DFW) a ?crit :
> Hi Group,
> 
>  
> 
> What is the best way to remove non-successive locations from the
> kernelbb (Brownian Bridge Movement Model Home Range) calculations in
> adehabitat?  For example I am working with Raptor data where there is a
> period when transmitters are shut off so that the batteries can
> recharge.  I want to remove those locations from the calculations. In
> Animal Space Use there is an input for the maximum time between
> successive locations.  Any ideas on how can I implement this in
> adehabitat?
> 
>  
> 
> Thanks,
> 
>  
> 
> Andy
> 
>  
> 
>  
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 

~$ whoami
Mathieu Basille, Post-Doc

~$ locate
Laboratoire d'?cologie Comportementale et de Conservation de la Faune
+ Centre d'?tude de la For?t
D?partement de Biologie
Universit? Laval, Qu?bec

~$ info
http://ase-research.org/basille

~$ fortune
``If you can't win by reason, go for volume.''
Calvin, by Bill Watterson.


