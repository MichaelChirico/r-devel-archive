From |e@g|meno @end|ng |rom gm@||@com  Fri Feb  1 16:11:48 2019
From: |e@g|meno @end|ng |rom gm@||@com (Fernando Gimeno)
Date: Fri, 1 Feb 2019 12:11:48 -0300
Subject: [R-sig-Geo] How i can do a shape merge?
Message-ID: <CACs6gjXqz6kamMyY5=hxi=s6YfAVw88Z35r96zDyiOe+90MqxQ@mail.gmail.com>

Hello

I'm looking a method with the same result that Arcgis "merge"

I have to do a shape merge with a lot of archives but most common tools on
R has not merged alll shape and always i have to export to arcgis. Has
anyone worked this?

Thank you

-- 
*Fernando J. Gimeno Molina*
*Licenciado en Geograf?a, Universidad de Chile*
*Ge?grafo, Universidad de Chile*
*Estudiante Magister en Gesti?n y Planificaci?n Ambiental, Universidad de
Chile*
*Diploma en Geom?tica Aplicada, Universidad de Chile*

	[[alternative HTML version deleted]]


From tech_dev @end|ng |rom w||d|nte||ect@com  Fri Feb  1 18:50:19 2019
From: tech_dev @end|ng |rom w||d|nte||ect@com (Alex M)
Date: Fri, 1 Feb 2019 09:50:19 -0800
Subject: [R-sig-Geo] How i can do a shape merge?
In-Reply-To: <CACs6gjXqz6kamMyY5=hxi=s6YfAVw88Z35r96zDyiOe+90MqxQ@mail.gmail.com>
References: <CACs6gjXqz6kamMyY5=hxi=s6YfAVw88Z35r96zDyiOe+90MqxQ@mail.gmail.com>
Message-ID: <abcfb4d1-ca91-f2e9-f5fd-63204770e309@wildintellect.com>

On 2/1/19 07:11, Fernando Gimeno wrote:
> Hello
> 
> I'm looking a method with the same result that Arcgis "merge"
> 
> I have to do a shape merge with a lot of archives but most common tools on
> R has not merged alll shape and always i have to export to arcgis. Has
> anyone worked this?
> 
> Thank you
> 

With sp type layers, use bind from the raster package, to do many layers
you use do.call with it.
https://rspatial.org/spatial/7-vectmanip.html#append
do.call(bind, listoflayers)

With sf you can use rbind, though if you have a lot of data you might
want to use data.table and noted in this discussion.
https://github.com/r-spatial/sf/issues/798
do.call(rbind, listoflayers)

But really if you have a lot of layers, loading them into memory in R
before combining is not particularly efficient. Consider using
commandline: ogr2ogr -append
https://www.gdal.org/ogr2ogr.html
You can call ogr2ogr from R with the gdalUtils package.

Enjoy,
Alex


From @ohr@b@@bb@@nej@d @end|ng |rom y@hoo@com  Sat Feb  2 14:36:13 2019
From: @ohr@b@@bb@@nej@d @end|ng |rom y@hoo@com (Sohrab Abbasnejad)
Date: Sat, 2 Feb 2019 13:36:13 +0000 (UTC)
Subject: [R-sig-Geo] How to get the coordinates (latitude/longitude) of a
 continent outline?
References: <640471070.1856766.1549114573479.ref@mail.yahoo.com>
Message-ID: <640471070.1856766.1549114573479@mail.yahoo.com>

Hello,
I would like to have the list of coordinates of the boundary (outline) of a continent (Africa). The "map" function from the "maps" package gives the coordinates for country outlines, but not the for the continents.

Does anybody have an idea where I can find the data?

Thank you!

Cheers,
Sohrab




	[[alternative HTML version deleted]]


From btupper @end|ng |rom b|ge|ow@org  Sat Feb  2 15:38:19 2019
From: btupper @end|ng |rom b|ge|ow@org (Ben Tupper)
Date: Sat, 2 Feb 2019 09:38:19 -0500
Subject: [R-sig-Geo] 
 How to get the coordinates (latitude/longitude) of a
 continent outline?
In-Reply-To: <640471070.1856766.1549114573479@mail.yahoo.com>
References: <640471070.1856766.1549114573479.ref@mail.yahoo.com>
 <640471070.1856766.1549114573479@mail.yahoo.com>
Message-ID: <4021D6D4-3999-422E-9E6A-4CF4CD5099DE@bigelow.org>

Hi,

There is a whole world of options (sorry for the lame pun!), but I would recommend checking out ROpenSci's rnaturalearth package

https://ropensci.org/tutorials/rnaturalearth_tutorial/ <https://ropensci.org/tutorials/rnaturalearth_tutorial/>

https://CRAN.R-project.org/package=rnaturalearth <https://cran.r-project.org/package=rnaturalearth>

Ben

> On Feb 2, 2019, at 8:36 AM, Sohrab Abbasnejad via R-sig-Geo <r-sig-geo at r-project.org> wrote:
> 
> Hello,
> I would like to have the list of coordinates of the boundary (outline) of a continent (Africa). The "map" function from the "maps" package gives the coordinates for country outlines, but not the for the continents.
> 
> Does anybody have an idea where I can find the data?
> 
> Thank you!
> 
> Cheers,
> Sohrab
> 
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Ben Tupper
Bigelow Laboratory for Ocean Sciences
60 Bigelow Drive, P.O. Box 380
East Boothbay, Maine 04544
http://www.bigelow.org

Ecological Forecasting: https://eco.bigelow.org/






	[[alternative HTML version deleted]]


From z|v@n@k@r@m@n @end|ng |rom gm@||@com  Sat Feb  2 16:07:16 2019
From: z|v@n@k@r@m@n @end|ng |rom gm@||@com (Zivan Karaman)
Date: Sat, 2 Feb 2019 16:07:16 +0100
Subject: [R-sig-Geo] 
 How to get the coordinates (latitude/longitude) of a
 continent outline?
In-Reply-To: <640471070.1856766.1549114573479@mail.yahoo.com>
References: <640471070.1856766.1549114573479.ref@mail.yahoo.com>
 <640471070.1856766.1549114573479@mail.yahoo.com>
Message-ID: <CAKtE6yOuK-Na-WV4Qwv-qF5c1rB32T35isseak=1JJYhzRtvYA@mail.gmail.com>

Hello Sohrab,

You can start with country maps, and then merge them in a single polygon.
For example, get the maps as a shape file from here
http://www.maplibrary.org/library/stacks/Africa/Africa_SHP.zip, unzip this
file and run the following R code

library(sp)
library(rgdal)
library(rgeos)
countries <- rgdal::readOGR(dsn = ".", layer = "Africa")
sp::proj4string(countries) <- sp::CRS("+init=epsg:4326")
a <- rgeos::gBuffer(countries, width = 0)
# ignore the warnings
sp::proj4string(a) <- sp::CRS("+init=epsg:4326")
plot(a)
# this produces quite a detailed map with islands, lakes, etc.
# you can simplify it to suit your needs by tuning the tol argument
b <- rgeos::gSimplify(a, tol = 0.1)
plot(b)

Cheers,
Zivan



Le sam. 2 f?vr. 2019 ? 14:36, Sohrab Abbasnejad via R-sig-Geo <
r-sig-geo at r-project.org> a ?crit :

> Hello,
> I would like to have the list of coordinates of the boundary (outline) of
> a continent (Africa). The "map" function from the "maps" package gives the
> coordinates for country outlines, but not the for the continents.
>
> Does anybody have an idea where I can find the data?
>
> Thank you!
>
> Cheers,
> Sohrab
>
>
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From @ohr@b@@bb@@nej@d @end|ng |rom y@hoo@com  Sat Feb  2 16:17:05 2019
From: @ohr@b@@bb@@nej@d @end|ng |rom y@hoo@com (Sohrab Abbasnejad)
Date: Sat, 2 Feb 2019 15:17:05 +0000 (UTC)
Subject: [R-sig-Geo] 
 How to get the coordinates (latitude/longitude) of a
 continent outline?
In-Reply-To: <4021D6D4-3999-422E-9E6A-4CF4CD5099DE@bigelow.org>
References: <640471070.1856766.1549114573479.ref@mail.yahoo.com>
 <640471070.1856766.1549114573479@mail.yahoo.com>
 <4021D6D4-3999-422E-9E6A-4CF4CD5099DE@bigelow.org>
Message-ID: <703101788.1886569.1549120625458@mail.yahoo.com>

 Dear Ben,

Thank you for your reply.

So far as I am aware, the rnaturalearth package provides information about countries within a continent, states within countries and "world" coastline (subsetting the coastline is not possible). Nevertheless, the package does not include maps/data of "continents". What I need is the coordinates of Africa's outline (as a single entity), not the coordinates of countries' outlines within Africa.

Best,
Sohrab


    On ?Saturday?, ?February? ?2?, ?2019? ?03?:?38?:?25? ?PM? ?CET, Ben Tupper wrote:  
 
 Hi,
There is a whole world of options (sorry for the lame pun!), but I would recommend checking out ROpenSci's rnaturalearth package
https://ropensci.org/tutorials/rnaturalearth_tutorial/
https://CRAN.R-project.org/package=rnaturalearth
Ben


On Feb 2, 2019, at 8:36 AM, Sohrab Abbasnejad via R-sig-Geo <r-sig-geo at r-project.org> wrote:
Hello,
I would like to have the list of coordinates of the boundary (outline) of a continent (Africa). The "map" function from the "maps" package gives the coordinates for country outlines, but not the for the continents.

Does anybody have an idea where I can find the data?

Thank you!

Cheers,
Sohrab




 [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


Ben Tupper
Bigelow Laboratory for Ocean?Sciences
60 Bigelow Drive, P.O. Box 380
East Boothbay, Maine 04544
http://www.bigelow.org
Ecological Forecasting: https://eco.bigelow.org/




  
	[[alternative HTML version deleted]]


From @ohr@b@@bb@@nej@d @end|ng |rom y@hoo@com  Sat Feb  2 17:36:15 2019
From: @ohr@b@@bb@@nej@d @end|ng |rom y@hoo@com (Sohrab Abbasnejad)
Date: Sat, 2 Feb 2019 16:36:15 +0000 (UTC)
Subject: [R-sig-Geo] 
 How to get the coordinates (latitude/longitude) of a
 continent outline?
In-Reply-To: <CAKtE6yOuK-Na-WV4Qwv-qF5c1rB32T35isseak=1JJYhzRtvYA@mail.gmail.com>
References: <640471070.1856766.1549114573479.ref@mail.yahoo.com>
 <640471070.1856766.1549114573479@mail.yahoo.com>
 <CAKtE6yOuK-Na-WV4Qwv-qF5c1rB32T35isseak=1JJYhzRtvYA@mail.gmail.com>
Message-ID: <253691135.1929839.1549125375181@mail.yahoo.com>

 Dear Zivan,

Your solution did the job! Thank you very much!

Best,
Sohrab

    On ?Saturday?, ?February? ?2?, ?2019? ?04?:?07?:?27? ?PM? ?CET, Zivan Karaman <zivan.karaman at gmail.com> wrote:  
 
 Hello Sohrab,
You can start with country maps, and then merge them in a single polygon.For example, get the maps as a shape file from here http://www.maplibrary.org/library/stacks/Africa/Africa_SHP.zip, unzip this file and run the following R code
library(sp)library(rgdal)library(rgeos)countries <- rgdal::readOGR(dsn = ".", layer = "Africa")
sp::proj4string(countries) <- sp::CRS("+init=epsg:4326")a <- rgeos::gBuffer(countries, width = 0)# ignore the warningssp::proj4string(a) <- sp::CRS("+init=epsg:4326")plot(a)# this produces quite a detailed map with islands, lakes, etc.# you can simplify it to suit your needs by tuning the tol argumentb <- rgeos::gSimplify(a, tol = 0.1)plot(b)
Cheers,Zivan


Le?sam. 2 f?vr. 2019 ??14:36, Sohrab Abbasnejad via R-sig-Geo <r-sig-geo at r-project.org> a ?crit?:

Hello,
I would like to have the list of coordinates of the boundary (outline) of a continent (Africa). The "map" function from the "maps" package gives the coordinates for country outlines, but not the for the continents.

Does anybody have an idea where I can find the data?

Thank you!

Cheers,
Sohrab




? ? ? ? [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

  
	[[alternative HTML version deleted]]


From btupper @end|ng |rom b|ge|ow@org  Sat Feb  2 20:40:19 2019
From: btupper @end|ng |rom b|ge|ow@org (Ben Tupper)
Date: Sat, 2 Feb 2019 14:40:19 -0500
Subject: [R-sig-Geo] 
 How to get the coordinates (latitude/longitude) of a
 continent outline?
In-Reply-To: <703101788.1886569.1549120625458@mail.yahoo.com>
References: <640471070.1856766.1549114573479.ref@mail.yahoo.com>
 <640471070.1856766.1549114573479@mail.yahoo.com>
 <4021D6D4-3999-422E-9E6A-4CF4CD5099DE@bigelow.org>
 <703101788.1886569.1549120625458@mail.yahoo.com>
Message-ID: <B2238833-CF7D-41C2-9A43-5739B6A682D8@bigelow.org>

Hi,

Yes, I flubbed that.  I had it in my head that this...

https://www.naturalearthdata.com/downloads/110m-physical-vectors/110m-land/ <https://www.naturalearthdata.com/downloads/110m-physical-vectors/110m-land/>

... had Africa as a stand alone polygon, but that is not so.  Sorry for the noise.

Ben

> On Feb 2, 2019, at 10:17 AM, Sohrab Abbasnejad <sohrab.abbasnejad at yahoo.com> wrote:
> 
> Dear Ben,
> 
> Thank you for your reply.
> 
> So far as I am aware, the rnaturalearth package provides information about countries within a continent, states within countries and "world" coastline (subsetting the coastline is not possible). Nevertheless, the package does not include maps/data of "continents". What I need is the coordinates of Africa's outline (as a single entity), not the coordinates of countries' outlines within Africa.
> 
> Best,
> Sohrab
> 
> 
> On ?Saturday?, ?February? ?2?, ?2019? ?03?:?38?:?25? ?PM? ?CET, Ben Tupper wrote:
> 
> 
> Hi,
> 
> There is a whole world of options (sorry for the lame pun!), but I would recommend checking out ROpenSci's rnaturalearth package
> 
> https://ropensci.org/tutorials/rnaturalearth_tutorial/ <https://ropensci.org/tutorials/rnaturalearth_tutorial/>
> 
> https://CRAN.R-project.org/package=rnaturalearth <https://cran.r-project.org/package=rnaturalearth>
> 
> Ben
> 
>> On Feb 2, 2019, at 8:36 AM, Sohrab Abbasnejad via R-sig-Geo <r-sig-geo at r-project.org <mailto:r-sig-geo at r-project.org>> wrote:
>> 
>> Hello,
>> I would like to have the list of coordinates of the boundary (outline) of a continent (Africa). The "map" function from the "maps" package gives the coordinates for country outlines, but not the for the continents.
>> 
>> Does anybody have an idea where I can find the data?
>> 
>> Thank you!
>> 
>> Cheers,
>> Sohrab
>> 
>> 
>> 
>> 
>> 	[[alternative HTML version deleted]]
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> Ben Tupper
> Bigelow Laboratory for Ocean Sciences
> 60 Bigelow Drive, P.O. Box 380
> East Boothbay, Maine 04544
> http://www.bigelow.org <http://www.bigelow.org/>
> 
> Ecological Forecasting: https://eco.bigelow.org/ <https://eco.bigelow.org/>
> 
> 
> 
> 

Ben Tupper
Bigelow Laboratory for Ocean Sciences
60 Bigelow Drive, P.O. Box 380
East Boothbay, Maine 04544
http://www.bigelow.org

Ecological Forecasting: https://eco.bigelow.org/






	[[alternative HTML version deleted]]


From @zm @end|ng |rom uow@edu@@u  Tue Feb  5 22:19:41 2019
From: @zm @end|ng |rom uow@edu@@u (Andrew Zammit Mangion)
Date: Tue, 5 Feb 2019 21:19:41 +0000
Subject: [R-sig-Geo] =?windows-1252?q?Book=3A_=93Spatio-Temporal_Statisti?=
 =?windows-1252?q?cs_with_R=2C=94_by_Christopher_K=2E_Wikle=2C_Andrew_Zamm?=
 =?windows-1252?q?it-Mangion=2C_and_Noel_Cressie?=
Message-ID: <1549401581502.52814@uow.edu.au>

Wikle, Zammit-Mangion, and Cressie (2019) is a recently published Chapman & Hall/CRC book: "Spatio-Temporal Statistics with R.? The book is a blend of theory and hands-on Labs in R, which show how to visualize and model spatio-temporal data, as well as diagnose model predictions.

The book is available as a free downloadable PDF at  https://spacetimewithr.org. This website also gives information on how to install the accompanying R package ?STRbook? that contains helper functions for use in the Labs, and a discount code for the hardcover version.

Christopher K. Wikle
Andrew Zammit-Mangion
Noel Cressie

NOTICE: This email is intended for the addressee named and may contain confidential information. If you are not the intended recipient, please delete it and notify the sender. Please consider the environment before printing this email.


	[[alternative HTML version deleted]]


From er|nm@hodge@@ @end|ng |rom gm@||@com  Tue Feb  5 22:34:05 2019
From: er|nm@hodge@@ @end|ng |rom gm@||@com (Erin Hodgess)
Date: Tue, 5 Feb 2019 14:34:05 -0700
Subject: [R-sig-Geo] 
	=?utf-8?q?Book=3A_=E2=80=9CSpatio-Temporal_Statistic?=
	=?utf-8?q?s_with_R=2C=E2=80=9D_by_Christopher_K=2E_Wikle=2C_Andrew?=
	=?utf-8?q?_Zammit-Mangion=2C_and_Noel_Cressie?=
In-Reply-To: <1549401581502.52814@uow.edu.au>
References: <1549401581502.52814@uow.edu.au>
Message-ID: <CACxE24m2TcahZ4e44qFh3yJRkhP=qnaNnUQGKOnYEm4N2W4VUQ@mail.gmail.com>

This looks totally awesome!  Will check it out right away!

Sincerely,
Erin


On Tue, Feb 5, 2019 at 2:20 PM Andrew Zammit Mangion <azm at uow.edu.au> wrote:

> Wikle, Zammit-Mangion, and Cressie (2019) is a recently published Chapman
> & Hall/CRC book: "Spatio-Temporal Statistics with R.? The book is a blend
> of theory and hands-on Labs in R, which show how to visualize and model
> spatio-temporal data, as well as diagnose model predictions.
>
> The book is available as a free downloadable PDF at
> https://spacetimewithr.org. This website also gives information on how to
> install the accompanying R package ?STRbook? that contains helper functions
> for use in the Labs, and a discount code for the hardcover version.
>
> Christopher K. Wikle
> Andrew Zammit-Mangion
> Noel Cressie
>
> NOTICE: This email is intended for the addressee named and may contain
> confidential information. If you are not the intended recipient, please
> delete it and notify the sender. Please consider the environment before
> printing this email.
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
-- 
Erin Hodgess, PhD
mailto: erinm.hodgess at gmail.com

	[[alternative HTML version deleted]]


From r@hep@rd @end|ng |rom @pp|-eco@y@@com  Tue Feb  5 22:36:29 2019
From: r@hep@rd @end|ng |rom @pp|-eco@y@@com (Rich Shepard)
Date: Tue, 5 Feb 2019 13:36:29 -0800 (PST)
Subject: [R-sig-Geo] 
 =?utf-8?q?Book=3A_=E2=80=9CSpatio-Temporal_Statistic?=
 =?utf-8?q?s_with_R=2C=E2=80=9D_by_Christopher_K=2E_Wikle=2C_Andrew_Zammit?=
 =?utf-8?q?-Mangion=2C_and_Noel_Cressie?=
In-Reply-To: <1549401581502.52814@uow.edu.au>
References: <1549401581502.52814@uow.edu.au>
Message-ID: <alpine.LNX.2.20.1902051334300.28099@salmo.appl-ecosys.com>

On Tue, 5 Feb 2019, Andrew Zammit Mangion wrote:

> The book is available as a free downloadable PDF at
> https://spacetimewithr.org. This website also gives information on how to
> install the accompanying R package ?STRbook? that contains helper
> functions for use in the Labs, and a discount code for the hardcover
> version.

Christopher, Andrew, and Noel:

Thank you all very much for the ability to download the book as a PDF file.
When a project budget allows I'll also buy a dead tree version so I can read
it everywhere.

Best regards,

Rich


From r@hep@rd @end|ng |rom @pp|-eco@y@@com  Tue Feb  5 23:00:36 2019
From: r@hep@rd @end|ng |rom @pp|-eco@y@@com (Rich Shepard)
Date: Tue, 5 Feb 2019 14:00:36 -0800 (PST)
Subject: [R-sig-Geo] 
 =?utf-8?q?Book=3A_=E2=80=9CSpatio-Temporal_Statistic?=
 =?utf-8?q?s_with_R=2C=E2=80=9D_by_Christopher_K=2E_Wikle=2C_Andrew_Zammit?=
 =?utf-8?q?-Mangion=2C_and_Noel_Cressie?=
In-Reply-To: <alpine.LNX.2.20.1902051334300.28099@salmo.appl-ecosys.com>
References: <1549401581502.52814@uow.edu.au>
 <alpine.LNX.2.20.1902051334300.28099@salmo.appl-ecosys.com>
Message-ID: <alpine.LNX.2.20.1902051359010.28099@salmo.appl-ecosys.com>

On Tue, 5 Feb 2019, Rich Shepard wrote:

> When a project budget allows I'll also buy a dead tree version so I can read
> it everywhere.

Well! The discounted price was too compelling so I ordered a copy and it
will be here by the end of the month.

Regards,

Rich


From ju@ten @end|ng |rom t@mu@edu  Wed Feb  6 00:30:32 2019
From: ju@ten @end|ng |rom t@mu@edu (Hannah Justen)
Date: Tue, 5 Feb 2019 17:30:32 -0600
Subject: [R-sig-Geo] Sampling random directional lines within a polygon
Message-ID: <CAGUtHj2aP0Tq4kk5t2P2FSgRa80EmJBXpv8k1VbVJpnDB_SP-A@mail.gmail.com>

Hi everyone,

I am studying migratory tracks of birds for my dissertation and I would
like to model possible pathways between two polygons. Therefore, I would
like to sample random lines between the polygons. These lines can differ in
total length but should consist of x - number of fragments of equal length.
Each fragment can have slightly different orientation but overall the lines
should connect the two polygons.

I fail to find the appropriate R package that will allow me to do this type
of analysis. Does anyone have a suggestion how to approach analysis?

Thank you,
Hannah

---
PhD Student |Ecology and Evolutionary Biology
Texas A&M University

	[[alternative HTML version deleted]]


From er|nm@hodge@@ @end|ng |rom gm@||@com  Wed Feb  6 01:13:47 2019
From: er|nm@hodge@@ @end|ng |rom gm@||@com (Erin Hodgess)
Date: Tue, 5 Feb 2019 17:13:47 -0700
Subject: [R-sig-Geo] Sampling random directional lines within a polygon
In-Reply-To: <CAGUtHj2aP0Tq4kk5t2P2FSgRa80EmJBXpv8k1VbVJpnDB_SP-A@mail.gmail.com>
References: <CAGUtHj2aP0Tq4kk5t2P2FSgRa80EmJBXpv8k1VbVJpnDB_SP-A@mail.gmail.com>
Message-ID: <CACxE24kyBNhSPL1Dyf0FYUgBwRMNb95at16CQK33Qa8rupKDnA@mail.gmail.com>

Have you seen plotKML, please?  Or space time?

On Tue, Feb 5, 2019 at 4:31 PM Hannah Justen <justen at tamu.edu> wrote:

> Hi everyone,
>
> I am studying migratory tracks of birds for my dissertation and I would
> like to model possible pathways between two polygons. Therefore, I would
> like to sample random lines between the polygons. These lines can differ in
> total length but should consist of x - number of fragments of equal length.
> Each fragment can have slightly different orientation but overall the lines
> should connect the two polygons.
>
> I fail to find the appropriate R package that will allow me to do this type
> of analysis. Does anyone have a suggestion how to approach analysis?
>
> Thank you,
> Hannah
>
> ---
> PhD Student |Ecology and Evolutionary Biology
> Texas A&M University
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
-- 
Erin Hodgess, PhD
mailto: erinm.hodgess at gmail.com

	[[alternative HTML version deleted]]


From b@row||ng@on @end|ng |rom gm@||@com  Wed Feb  6 13:45:16 2019
From: b@row||ng@on @end|ng |rom gm@||@com (Barry Rowlingson)
Date: Wed, 6 Feb 2019 12:45:16 +0000
Subject: [R-sig-Geo] Sampling random directional lines within a polygon
In-Reply-To: <CAGUtHj2aP0Tq4kk5t2P2FSgRa80EmJBXpv8k1VbVJpnDB_SP-A@mail.gmail.com>
References: <CAGUtHj2aP0Tq4kk5t2P2FSgRa80EmJBXpv8k1VbVJpnDB_SP-A@mail.gmail.com>
Message-ID: <CANVKczOe8dtawLp4Xbh3Z1oOqBJyM2O0YFod2BPBL+SsptQ10A@mail.gmail.com>

[reposting to list after a bounce...]

Interesting, but I think we need more details...

Do the lines have to start and finish at specific locations in the polygons
- like the centroid, or anywhere?

So one line might be 3 segments of 10km each connecting two polygon
centroids that are 15km apart? Imagining three rigid rods of length 10
connected at their ends and with the first and last also connected to two
fixed points tells me there's an infinite number of possible solutions.
There's probably also a number of ways of sampling from those solutions.
Its going to get very complicated with a larger number of segments.

Hmmmmm.....

On Tue, Feb 5, 2019 at 11:30 PM Hannah Justen <justen at tamu.edu> wrote:

> Hi everyone,
>
> I am studying migratory tracks of birds for my dissertation and I would
> like to model possible pathways between two polygons. Therefore, I would
> like to sample random lines between the polygons. These lines can differ in
> total length but should consist of x - number of fragments of equal length.
> Each fragment can have slightly different orientation but overall the lines
> should connect the two polygons.
>
> I fail to find the appropriate R package that will allow me to do this type
> of analysis. Does anyone have a suggestion how to approach analysis?
>
> Thank you,
> Hannah
>
> ---
> PhD Student |Ecology and Evolutionary Biology
> Texas A&M University
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From er|nm@hodge@@ @end|ng |rom gm@||@com  Wed Feb  6 16:09:15 2019
From: er|nm@hodge@@ @end|ng |rom gm@||@com (Erin Hodgess)
Date: Wed, 6 Feb 2019 08:09:15 -0700
Subject: [R-sig-Geo] 
	=?utf-8?q?Book=3A_=E2=80=9CSpatio-Temporal_Statistic?=
	=?utf-8?q?s_with_R=2C=E2=80=9D_by_Christopher_K=2E_Wikle=2C_Andrew?=
	=?utf-8?q?_Zammit-Mangion=2C_and_Noel_Cressie?=
In-Reply-To: <alpine.LNX.2.20.1902051359010.28099@salmo.appl-ecosys.com>
References: <1549401581502.52814@uow.edu.au>
 <alpine.LNX.2.20.1902051334300.28099@salmo.appl-ecosys.com>
 <alpine.LNX.2.20.1902051359010.28099@salmo.appl-ecosys.com>
Message-ID: <CACxE24k0u=72vNUB1syaXBJ62ooegNTo2vw_9EmNZtoK4u33pA@mail.gmail.com>

I got mine last night too!


On Tue, Feb 5, 2019 at 3:00 PM Rich Shepard <rshepard at appl-ecosys.com>
wrote:

> On Tue, 5 Feb 2019, Rich Shepard wrote:
>
> > When a project budget allows I'll also buy a dead tree version so I can
> read
> > it everywhere.
>
> Well! The discounted price was too compelling so I ordered a copy and it
> will be here by the end of the month.
>
> Regards,
>
> Rich
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
-- 
Erin Hodgess, PhD
mailto: erinm.hodgess at gmail.com

	[[alternative HTML version deleted]]


From b@row||ng@on @end|ng |rom gm@||@com  Wed Feb  6 21:23:53 2019
From: b@row||ng@on @end|ng |rom gm@||@com (Barry Rowlingson)
Date: Wed, 6 Feb 2019 20:23:53 +0000
Subject: [R-sig-Geo] Sampling random directional lines within a polygon
In-Reply-To: <d783fddb8a4d4de09eb0dd128d015333@CWXP265MB1704.GBRP265.PROD.OUTLOOK.COM>
References: <CAGUtHj2aP0Tq4kk5t2P2FSgRa80EmJBXpv8k1VbVJpnDB_SP-A@mail.gmail.com>
 <CANVKczMiQUw2oNcWACnXT_ge0f3f-7wgMjsj4agR_yWXJWoZ6g@mail.gmail.com>
 <d783fddb8a4d4de09eb0dd128d015333@CWXP265MB1704.GBRP265.PROD.OUTLOOK.COM>
Message-ID: <CANVKczNkWhTsifmTdxjxXm5mghjue8oOhOJ-BU1z=qoUr7ZTew@mail.gmail.com>

Do you want to generate these for input into some statistical process, or
to generate some test data that looks a bit like real data? I think
generating test data isn't too difficult, but anything that you might want
to put into a statistical test (eg testing some hypothesis about the birds
maximum deviation from the straight line A-B) needs a lot more care in
formulating the path generating process.

Here's some thoughts - if you consider one of the red segments in your map
as a piece of string (rather than 10 segments) anchored at the points, then
you can stretch it taut with a pencil and draw an ellipse with A and B as
the foci. Any path created with that string - taut or slack as in your map
- has to strictly lie within the ellipse. Now you can wiggle that string
inside that ellipse and create an infinity of paths from A to B of the same
length. I'm not sure how you can sample uniformly from that infinity such
that any path has an equal sampling probability. Your problem is similar
but has the additional rigid segment constraint.

Any two adjacent segments of a chain, eg 1----2-------3, as long as it
isn't taut (ie straight) can be perturbed by holding 1 and 3 still and
moving 2 to the "mirror image" point over the straight line from 1 to 3.
You can also take three segments 1--2--3--4 and hold 1 and 4 still and
perturb 2 and 3 fairly easily. In this way you could set up an initial
chain and then run multiple perturbations on the chain to get a "random"
chain, but quite what set of all chains it would be a sample from is not
clear. It could at least generate reasonable looking paths, but I wouldn't
want to test a hypothesis against it.

I'm going to generate a path from my office to my home now.

Barry






On Wed, Feb 6, 2019 at 7:50 PM Hannah Justen <justen at tamu.edu> wrote:

> Hello everyone,
>
> Thank you very much for the suggestions.
>
> Regarding more details (please also see attached figure):
> I would like to simulate a bird's migration between breeding (starting
> polygon - blue in the figure) and wintering grounds (end polygon - green in
> the figure). The lines can start from anywhere within the starting polygon
> and end anywhere in the end polygon. The lines shall consist of 10
> connected segments with variable length between 300 and 1000 km (see red
> lines in figure; two examples of possible lines with 10 segments between
> the polygons).
>
> Thank you very much for you help,
> Hannah
>
> ---
> PhD Student |Ecology and Evolutionary Biology
> Texas A&M University
>
> On Wed, Feb 6, 2019 at 5:12 AM Barry Rowlingson <
> b.rowlingson at lancaster.ac.uk> wrote:
>
>> Interesting, but I think we need more details...
>>
>> Do the lines have to start and finish at specific locations in the
>> polygons - like the centroid, or anywhere?
>>
>> So one line might be 3 segments of 10km each connecting two polygon
>> centroids that are 15km apart? Imagining three rigid rods of length 10
>> connected at their ends and with the first and last also connected to two
>> fixed points tells me there's an infinite number of possible solutions.
>> There's probably also a number of ways of sampling from those solutions.
>> Its going to get very complicated with a larger number of segments.
>>
>> Hmmmmm.....
>>
>> Barry
>>
>>
>>
>>
>> On Tue, Feb 5, 2019 at 11:30 PM Hannah Justen <justen at tamu.edu> wrote:
>>
>>> Hi everyone,
>>>
>>> I am studying migratory tracks of birds for my dissertation and I would
>>> like to model possible pathways between two polygons. Therefore, I would
>>> like to sample random lines between the polygons. These lines can differ
>>> in
>>> total length but should consist of x - number of fragments of equal
>>> length.
>>> Each fragment can have slightly different orientation but overall the
>>> lines
>>> should connect the two polygons.
>>>
>>> I fail to find the appropriate R package that will allow me to do this
>>> type
>>> of analysis. Does anyone have a suggestion how to approach analysis?
>>>
>>> Thank you,
>>> Hannah
>>>
>>> ---
>>> PhD Student |Ecology and Evolutionary Biology
>>> Texas A&M University
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> <https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dsig-2Dgeo&d=DwMFaQ&c=ODFT-G5SujMiGrKuoJJjVg&r=JTKhaSJXwF2BxCfjjnt61w&m=RH21jOLOEbLLudn70kOTH0wnklnKHk-tFm9cxjxAB9k&s=H_HhNMga7aaqbnNsWexqY1jdRFFo7zO_m9xvk2awODo&e=>
>>>
>>

	[[alternative HTML version deleted]]


From b@row||ng@on @end|ng |rom gm@||@com  Thu Feb  7 00:41:54 2019
From: b@row||ng@on @end|ng |rom gm@||@com (Barry Rowlingson)
Date: Wed, 6 Feb 2019 23:41:54 +0000
Subject: [R-sig-Geo] Sampling random directional lines within a polygon
In-Reply-To: <CANVKczNkWhTsifmTdxjxXm5mghjue8oOhOJ-BU1z=qoUr7ZTew@mail.gmail.com>
References: <CAGUtHj2aP0Tq4kk5t2P2FSgRa80EmJBXpv8k1VbVJpnDB_SP-A@mail.gmail.com>
 <CANVKczMiQUw2oNcWACnXT_ge0f3f-7wgMjsj4agR_yWXJWoZ6g@mail.gmail.com>
 <d783fddb8a4d4de09eb0dd128d015333@CWXP265MB1704.GBRP265.PROD.OUTLOOK.COM>
 <CANVKczNkWhTsifmTdxjxXm5mghjue8oOhOJ-BU1z=qoUr7ZTew@mail.gmail.com>
Message-ID: <CANVKczP-axSR3MMvJESSJ0T0Uv9x3XRK9enp8Bm9U4gS_ZOCSA@mail.gmail.com>

Had another idea which is now implemented...

Consider any segmented path of segments of lengths L_i at angles A_i. Its
endpoint will be the vector sum of those segments, ie at (x,y) = (sum(L_i
cos(A_i)), sum(L_i sin(A_i)).

To create a segmented path to a given (x,y), solve that expression for the
angles A_i. In R you can treat this as an optimisation problem - find a set
of angles A_i that minimise the distance of the end of the segmented path
from the target end point.

Here's some code that does that for a path from 0,0 to 0,1:

pathit <- function(segments){
    obj = function(angles){
        dxdy = dxdy(segments, angles)
        xerr = dxdy$dx-1
        yerr = dxdy$dy
        err = sqrt(xerr^2 + yerr^2)
        err
    }
    angles = runif(length(segments), 0 , 2*pi)
    optim(angles, obj)
}

dxdy = function(segments, angles){
    dx = sum(segments * cos(angles))
    dy = sum(segments * sin(angles))
    list(dx=dx, dy=dy)
}

plotsegs <- function(segments, angles){
    x = rep(NA, length(segments) +1)
    y = x
    x[1] = 0
    y[1] = 0
    for(i in 2:(length(segments)+1)){
        x[i] = x[i-1] + segments[i-1]*cos(angles[i-1])
        y[i] = y[i-1] + segments[i-1]*sin(angles[i-1])
    }
    cbind(x,y)
}

This is deliberately written naively for clarity.

To use, set the segment sizes, optimise, and then plot:

 s1 = c(.1,.3,.2,.1,.3,.3,.1)
 a1 = pathit(s1)
 plot(plotsegs(s1,a1$par),type="l")

which should show a path of seven segments from 0,0 to 0,1 - since the
initial starting values are random the model can find different solutions.
Run again for a different path.

To see what the space of paths looks like, do lots and overplot them:

  lots = lapply(1:1000, function(i)plotsegs(s1,pathit(s1)$par))
  plot(c(-.1,1.1),c(-1,1))
  p = lapply(lots, function(xy){lines(xy)})

this should show 1000 paths, and illustrates the "ellipse" of path
possibles that I mentioned in the previous email.

Sometimes the optimiser struggles to find a solution and so you should
probably test the output from optim for convergence and to make sure the
target function is close enough to zero for your purposes.  For the example
above most of the time the end point is about 1e-5  from (1,0) but for
harder problems such as s = rep(.1, 11) which only has 0.1 of extra "slack"
length, the error can be 0.02 and failed convergence. Possibly longer optim
runs would help or constraining the angles.

Anyway, interesting problem....

Barry







On Wed, Feb 6, 2019 at 8:23 PM Barry Rowlingson <b.rowlingson at gmail.com>
wrote:

> Do you want to generate these for input into some statistical process, or
> to generate some test data that looks a bit like real data? I think
> generating test data isn't too difficult, but anything that you might want
> to put into a statistical test (eg testing some hypothesis about the birds
> maximum deviation from the straight line A-B) needs a lot more care in
> formulating the path generating process.
>
> Here's some thoughts - if you consider one of the red segments in your map
> as a piece of string (rather than 10 segments) anchored at the points, then
> you can stretch it taut with a pencil and draw an ellipse with A and B as
> the foci. Any path created with that string - taut or slack as in your map
> - has to strictly lie within the ellipse. Now you can wiggle that string
> inside that ellipse and create an infinity of paths from A to B of the same
> length. I'm not sure how you can sample uniformly from that infinity such
> that any path has an equal sampling probability. Your problem is similar
> but has the additional rigid segment constraint.
>
> Any two adjacent segments of a chain, eg 1----2-------3, as long as it
> isn't taut (ie straight) can be perturbed by holding 1 and 3 still and
> moving 2 to the "mirror image" point over the straight line from 1 to 3.
> You can also take three segments 1--2--3--4 and hold 1 and 4 still and
> perturb 2 and 3 fairly easily. In this way you could set up an initial
> chain and then run multiple perturbations on the chain to get a "random"
> chain, but quite what set of all chains it would be a sample from is not
> clear. It could at least generate reasonable looking paths, but I wouldn't
> want to test a hypothesis against it.
>
> I'm going to generate a path from my office to my home now.
>
> Barry
>
>
>
>
>
>
> On Wed, Feb 6, 2019 at 7:50 PM Hannah Justen <justen at tamu.edu> wrote:
>
>> Hello everyone,
>>
>> Thank you very much for the suggestions.
>>
>> Regarding more details (please also see attached figure):
>> I would like to simulate a bird's migration between breeding (starting
>> polygon - blue in the figure) and wintering grounds (end polygon - green in
>> the figure). The lines can start from anywhere within the starting polygon
>> and end anywhere in the end polygon. The lines shall consist of 10
>> connected segments with variable length between 300 and 1000 km (see red
>> lines in figure; two examples of possible lines with 10 segments between
>> the polygons).
>>
>> Thank you very much for you help,
>> Hannah
>>
>> ---
>> PhD Student |Ecology and Evolutionary Biology
>> Texas A&M University
>>
>> On Wed, Feb 6, 2019 at 5:12 AM Barry Rowlingson <
>> b.rowlingson at lancaster.ac.uk> wrote:
>>
>>> Interesting, but I think we need more details...
>>>
>>> Do the lines have to start and finish at specific locations in the
>>> polygons - like the centroid, or anywhere?
>>>
>>> So one line might be 3 segments of 10km each connecting two polygon
>>> centroids that are 15km apart? Imagining three rigid rods of length 10
>>> connected at their ends and with the first and last also connected to two
>>> fixed points tells me there's an infinite number of possible solutions.
>>> There's probably also a number of ways of sampling from those solutions.
>>> Its going to get very complicated with a larger number of segments.
>>>
>>> Hmmmmm.....
>>>
>>> Barry
>>>
>>>
>>>
>>>
>>> On Tue, Feb 5, 2019 at 11:30 PM Hannah Justen <justen at tamu.edu> wrote:
>>>
>>>> Hi everyone,
>>>>
>>>> I am studying migratory tracks of birds for my dissertation and I would
>>>> like to model possible pathways between two polygons. Therefore, I would
>>>> like to sample random lines between the polygons. These lines can
>>>> differ in
>>>> total length but should consist of x - number of fragments of equal
>>>> length.
>>>> Each fragment can have slightly different orientation but overall the
>>>> lines
>>>> should connect the two polygons.
>>>>
>>>> I fail to find the appropriate R package that will allow me to do this
>>>> type
>>>> of analysis. Does anyone have a suggestion how to approach analysis?
>>>>
>>>> Thank you,
>>>> Hannah
>>>>
>>>> ---
>>>> PhD Student |Ecology and Evolutionary Biology
>>>> Texas A&M University
>>>>
>>>>         [[alternative HTML version deleted]]
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>> <https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dsig-2Dgeo&d=DwMFaQ&c=ODFT-G5SujMiGrKuoJJjVg&r=JTKhaSJXwF2BxCfjjnt61w&m=RH21jOLOEbLLudn70kOTH0wnklnKHk-tFm9cxjxAB9k&s=H_HhNMga7aaqbnNsWexqY1jdRFFo7zO_m9xvk2awODo&e=>
>>>>
>>>

	[[alternative HTML version deleted]]


From e|g@b@@@ @end|ng |rom gm@||@com  Tue Feb 12 14:34:59 2019
From: e|g@b@@@ @end|ng |rom gm@||@com (Ahmed El-Gabbas)
Date: Tue, 12 Feb 2019 14:34:59 +0100
Subject: [R-sig-Geo] converting raster to netcdf .nc with keeping CRS
 information
Message-ID: <CAJEGayc6HWLrK+t_2PbXP-y9xmvqQpVadpTDHL=jFV09FbyX1w@mail.gmail.com>

Hello all,


I am having a problem while converting a raster object as NetCDF (.nc)
file, with keeping the CRS information in the output file.

Here is a reproducible code:

require(raster)
require(ncdf4)
CurrTemp <- tempfile()
download.file(url =
"https://seaice.uni-bremen.de/data/amsre/asi_daygrid_swath/s6250/2003/feb/Antarctic/asi-s6250-20030214-v5.hdf",
destfile = CurrTemp, mode = "wb", quiet = T)
r <- raster(CurrTemp)
r <- flip(r,2)
extent(r) <- c(-3950000, 3950000, -3950000, 4350000)
crs(r) <- "+proj=stere +lat_0=-90 +lat_ts=-70 +lon_0=0 +k=1 +x_0=0
+y_0=0 +a=6378273 +b=6356889.449 +units=m +no_defs"
r# class       : RasterLayer # dimensions  : 1328, 1264, 1678592
(nrow, ncol, ncell)# resolution  : 6250, 6250  (x, y)# extent      :
-3950000, 3950000, -3950000, 4350000  (xmin, xmax, ymin, ymax)# coord.
ref. : +proj=stere +lat_0=-90 +lat_ts=-70 +lon_0=0 +k=1 +x_0=0 +y_0=0
+a=6378273 +b=6356889.449 +units=m +no_defs # data source : in memory#
names       : layer # values      : 0, 100  (min, max)

So far the raster object reads well, with CRS information included.

However, when I try to save it as .nc file, R prints "coord. ref. : NA",
and the produced file does not contain the CRS information.

writeRaster(r, filename = "O:/Ahmed/r001.nc", varname="IceConc",
            overwrite=TRUE, format="CDF",
            xname="Longitude", yname="Latitude")# class       :
RasterLayer # dimensions  : 1328, 1264, 1678592  (nrow, ncol, ncell)#
resolution  : 6250, 6250  (x, y)# extent      : -3950000, 3950000,
-3950000, 4350000  (xmin, xmax, ymin, ymax)# coord. ref. : NA # data
source : O:/Ahmed/r001.nc # names       : IceConc # zvar        :
IceConc

raster("O:/Ahmed/r001.nc")# class       : RasterLayer # dimensions  :
1328, 1264, 1678592  (nrow, ncol, ncell)# resolution  : 6250, 6250
(x, y)# extent      : -3950000, 3950000, -3950000, 4350000  (xmin,
xmax, ymin, ymax)# coord. ref. : NA # data source : O:/Ahmed/r001.nc #
names       : IceConc # zvar        : IceConc

Any solution?


N.B. I also sent the same question at stackoverflow
<https://stackoverflow.com/questions/54593552/saving-r-raster-to-netcdf-nc-file-with-keeping-crs-information>,
without a solution so far.


Thanks

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
*Dr. Ahmed El-Gabbas,*
Ocean Acoustics Lab,
Alfred-Wegener-Institut
Helmholtz-Zentrum f?r Polar und Meeresforschung
[image: image.png]
My Website:  https://elgabbas.github.io

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20190212/d2b0ddb9/attachment.html>

-------------- next part --------------
A non-text attachment was scrubbed...
Name: image.png
Type: image/png
Size: 16685 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20190212/d2b0ddb9/attachment.png>

From btupper @end|ng |rom b|ge|ow@org  Tue Feb 12 15:13:40 2019
From: btupper @end|ng |rom b|ge|ow@org (Ben Tupper)
Date: Tue, 12 Feb 2019 09:13:40 -0500
Subject: [R-sig-Geo] converting raster to netcdf .nc with keeping CRS
 information
In-Reply-To: <CAJEGayc6HWLrK+t_2PbXP-y9xmvqQpVadpTDHL=jFV09FbyX1w@mail.gmail.com>
References: <CAJEGayc6HWLrK+t_2PbXP-y9xmvqQpVadpTDHL=jFV09FbyX1w@mail.gmail.com>
Message-ID: <2B8BD0B2-65B4-4C9B-98E9-C985D8EE0ABB@bigelow.org>

Hi,

Have you tried using the 'prj' argument to writeRaster?  I don't know that it will be the solution, but according to ...

https://www.rdocumentation.org/packages/raster/versions/2.8-19/topics/writeRaster <https://www.rdocumentation.org/packages/raster/versions/2.8-19/topics/writeRaster>

It is documented among the '...' arguments.  Setting prj = TRUE will cause the crs to be written to the file.

Cheers,
Ben

> On Feb 12, 2019, at 8:34 AM, Ahmed El-Gabbas <elgabass at gmail.com> wrote:
> 
> Hello all,
> 
> I am having a problem while converting a raster object as NetCDF (.nc) file, with keeping the CRS information in the output file.
> Here is a reproducible code:
> require(raster)
> require(ncdf4)
> CurrTemp <- tempfile()
> download.file(url = "https://seaice.uni-bremen.de/data/amsre/asi_daygrid_swath/s6250/2003/feb/Antarctic/asi-s6250-20030214-v5.hdf <https://seaice.uni-bremen.de/data/amsre/asi_daygrid_swath/s6250/2003/feb/Antarctic/asi-s6250-20030214-v5.hdf>", destfile = CurrTemp, mode = "wb", quiet = T)
> r <- raster(CurrTemp)
> r <- flip(r,2)
> extent(r) <- c(-3950000, 3950000, -3950000, 4350000)
> crs(r) <- "+proj=stere +lat_0=-90 +lat_ts=-70 +lon_0=0 +k=1 +x_0=0 +y_0=0 +a=6378273 +b=6356889.449 +units=m +no_defs"
> r
> # class       : RasterLayer 
> # dimensions  : 1328, 1264, 1678592  (nrow, ncol, ncell)
> # resolution  : 6250, 6250  (x, y)
> # extent      : -3950000, 3950000, -3950000, 4350000  (xmin, xmax, ymin, ymax)
> # coord. ref. : +proj=stere +lat_0=-90 +lat_ts=-70 +lon_0=0 +k=1 +x_0=0 +y_0=0 +a=6378273 +b=6356889.449 +units=m +no_defs 
> # data source : in memory
> # names       : layer 
> # values      : 0, 100  (min, max)
> So far the raster object reads well, with CRS information included.
> However, when I try to save it as .nc file, R prints "coord. ref. : NA", and the produced file does not contain the CRS information.
> writeRaster(r, filename = "O:/Ahmed/r001.nc <http://r001.nc/>", varname="IceConc",
>             overwrite=TRUE, format="CDF",
>             xname="Longitude", yname="Latitude")
> # class       : RasterLayer 
> # dimensions  : 1328, 1264, 1678592  (nrow, ncol, ncell)
> # resolution  : 6250, 6250  (x, y)
> # extent      : -3950000, 3950000, -3950000, 4350000  (xmin, xmax, ymin, ymax)
> # coord. ref. : NA 
> # data source : O:/Ahmed/r001.nc <http://r001.nc/> 
> # names       : IceConc 
> # zvar        : IceConc
> 
> raster("O:/Ahmed/r001.nc <http://r001.nc/>")
> # class       : RasterLayer 
> # dimensions  : 1328, 1264, 1678592  (nrow, ncol, ncell)
> # resolution  : 6250, 6250  (x, y)
> # extent      : -3950000, 3950000, -3950000, 4350000  (xmin, xmax, ymin, ymax)
> # coord. ref. : NA 
> # data source : O:/Ahmed/r001.nc <http://r001.nc/> 
> # names       : IceConc 
> # zvar        : IceConc
> Any solution?
> 
> N.B. I also sent the same question at stackoverflow <https://stackoverflow.com/questions/54593552/saving-r-raster-to-netcdf-nc-file-with-keeping-crs-information>, without a solution so far.
> 
> Thanks
> 
> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> Dr. Ahmed El-Gabbas,
> Ocean Acoustics Lab,
> Alfred-Wegener-Institut
> Helmholtz-Zentrum f?r Polar und Meeresforschung
> <image.png>
> My Website:  https://elgabbas.github.io <https://elgabbas.github.io/>_______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Ben Tupper
Bigelow Laboratory for Ocean Sciences
60 Bigelow Drive, P.O. Box 380
East Boothbay, Maine 04544
http://www.bigelow.org

Ecological Forecasting: https://eco.bigelow.org/






	[[alternative HTML version deleted]]


From e|g@b@@@ @end|ng |rom gm@||@com  Tue Feb 12 15:19:27 2019
From: e|g@b@@@ @end|ng |rom gm@||@com (Ahmed El-Gabbas)
Date: Tue, 12 Feb 2019 15:19:27 +0100
Subject: [R-sig-Geo] converting raster to netcdf .nc with keeping CRS
 information
In-Reply-To: <2B8BD0B2-65B4-4C9B-98E9-C985D8EE0ABB@bigelow.org>
References: <CAJEGayc6HWLrK+t_2PbXP-y9xmvqQpVadpTDHL=jFV09FbyX1w@mail.gmail.com>
 <2B8BD0B2-65B4-4C9B-98E9-C985D8EE0ABB@bigelow.org>
Message-ID: <CAJEGayfo+A5gWXAcC6u5M0KTssURQzsXGAMqTjP7is-JiJ+e5Q@mail.gmail.com>

Thanks Ben for your suggestion.

Adding *prj = TRUE *argument caused this error:
           Error in ncdf4::ncvar_def(varname, varunit, list(xdim, ydim),
NAvalue(x),  :
           unused argument (prj = T)

Ahmed

On Tue, Feb 12, 2019 at 3:13 PM Ben Tupper <btupper at bigelow.org> wrote:

> Hi,
>
> Have you tried using the 'prj' argument to writeRaster?  I don't know that
> it will be the solution, but according to ...
>
>
> https://www.rdocumentation.org/packages/raster/versions/2.8-19/topics/writeRaster
>
> It is documented among the '...' arguments.  Setting prj = TRUE will cause
> the crs to be written to the file.
>
> Cheers,
> Ben
>
> On Feb 12, 2019, at 8:34 AM, Ahmed El-Gabbas <elgabass at gmail.com> wrote:
>
> Hello all,
>
> I am having a problem while converting a raster object as NetCDF (.nc)
> file, with keeping the CRS information in the output file.
> Here is a reproducible code:
>
> require(raster)
> require(ncdf4)
> CurrTemp <- tempfile()
> download.file(url = "https://seaice.uni-bremen.de/data/amsre/asi_daygrid_swath/s6250/2003/feb/Antarctic/asi-s6250-20030214-v5.hdf", destfile = CurrTemp, mode = "wb", quiet = T)
> r <- raster(CurrTemp)
> r <- flip(r,2)
> extent(r) <- c(-3950000, 3950000, -3950000, 4350000)
> crs(r) <- "+proj=stere +lat_0=-90 +lat_ts=-70 +lon_0=0 +k=1 +x_0=0 +y_0=0 +a=6378273 +b=6356889.449 +units=m +no_defs"
> r# class       : RasterLayer # dimensions  : 1328, 1264, 1678592  (nrow, ncol, ncell)# resolution  : 6250, 6250  (x, y)# extent      : -3950000, 3950000, -3950000, 4350000  (xmin, xmax, ymin, ymax)# coord. ref. : +proj=stere +lat_0=-90 +lat_ts=-70 +lon_0=0 +k=1 +x_0=0 +y_0=0 +a=6378273 +b=6356889.449 +units=m +no_defs # data source : in memory# names       : layer # values      : 0, 100  (min, max)
>
> So far the raster object reads well, with CRS information included.
> However, when I try to save it as .nc file, R prints "coord. ref. : NA",
> and the produced file does not contain the CRS information.
>
> writeRaster(r, filename = "O:/Ahmed/r001.nc", varname="IceConc",
>             overwrite=TRUE, format="CDF",
>             xname="Longitude", yname="Latitude")# class       : RasterLayer # dimensions  : 1328, 1264, 1678592  (nrow, ncol, ncell)# resolution  : 6250, 6250  (x, y)# extent      : -3950000, 3950000, -3950000, 4350000  (xmin, xmax, ymin, ymax)# coord. ref. : NA # data source : O:/Ahmed/r001.nc # names       : IceConc # zvar        : IceConc
>
> raster("O:/Ahmed/r001.nc")# class       : RasterLayer # dimensions  : 1328, 1264, 1678592  (nrow, ncol, ncell)# resolution  : 6250, 6250  (x, y)# extent      : -3950000, 3950000, -3950000, 4350000  (xmin, xmax, ymin, ymax)# coord. ref. : NA # data source : O:/Ahmed/r001.nc # names       : IceConc # zvar        : IceConc
>
> Any solution?
>
> N.B. I also sent the same question at stackoverflow
> <https://stackoverflow.com/questions/54593552/saving-r-raster-to-netcdf-nc-file-with-keeping-crs-information>,
> without a solution so far.
>
> Thanks
>
> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> *Dr. Ahmed El-Gabbas,*
> Ocean Acoustics Lab,
> Alfred-Wegener-Institut
> Helmholtz-Zentrum f?r Polar und Meeresforschung
> <image.png>
> My Website:  https://elgabbas.github.io
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
> Ben Tupper
> Bigelow Laboratory for Ocean Sciences
> 60 Bigelow Drive, P.O. Box 380
> East Boothbay, Maine 04544
> http://www.bigelow.org
>
> Ecological Forecasting: https://eco.bigelow.org/
>
>
>
>
>
>

	[[alternative HTML version deleted]]


From btupper @end|ng |rom b|ge|ow@org  Wed Feb 13 02:46:46 2019
From: btupper @end|ng |rom b|ge|ow@org (Ben Tupper)
Date: Tue, 12 Feb 2019 20:46:46 -0500
Subject: [R-sig-Geo] converting raster to netcdf .nc with keeping CRS
 information
In-Reply-To: <CAJEGayfo+A5gWXAcC6u5M0KTssURQzsXGAMqTjP7is-JiJ+e5Q@mail.gmail.com>
References: <CAJEGayc6HWLrK+t_2PbXP-y9xmvqQpVadpTDHL=jFV09FbyX1w@mail.gmail.com>
 <2B8BD0B2-65B4-4C9B-98E9-C985D8EE0ABB@bigelow.org>
 <CAJEGayfo+A5gWXAcC6u5M0KTssURQzsXGAMqTjP7is-JiJ+e5Q@mail.gmail.com>
Message-ID: <72204A1C-304B-4EFD-A89E-D4EF9C797EEF@bigelow.org>

Hi Ahmed,

I can confirm that on my system I get the same result as you.

Does your workflow confine you to using NetCDF?  I can successfully write/read to the native raster format.

r2 <- writeRaster(r, filename = "r001.grd", overwrite=TRUE)
r2 
#class       : RasterLayer 
#dimensions  : 1328, 1264, 1678592  (nrow, ncol, ncell)
#resolution  : 6250, 6250  (x, y)
#extent      : -3950000, 3950000, -3950000, 4350000  (xmin, xmax, ymin, ymax)
#coord. ref. : +proj=stere +lat_0=-90 +lat_ts=-70 +lon_0=0 +k=1 +x_0=0 +y_0=0 +a=6378273 +b=6356889.449 +units=m +no_defs 
#data source : /home/btupper/r001.grd 
#names       : layer 
#values      : 0, 100  (min, max)


r3 <- raster("r001.grd")
r3 
#class       : RasterLayer 
#dimensions  : 1328, 1264, 1678592  (nrow, ncol, ncell)
#resolution  : 6250, 6250  (x, y)
#extent      : -3950000, 3950000, -3950000, 4350000  (xmin, xmax, ymin, ymax)
#coord. ref. : +proj=stere +lat_0=-90 +lat_ts=-70 +lon_0=0 +k=1 +x_0=0 +y_0=0 +a=6378273 +b=6356889.449 +units=m +no_defs 
#data source : /home/btupper/r001.grd 
#names       : layer 
#values      : 0, 100  (min, max)

Ben

> sessionInfo()
R version 3.5.1 (2018-07-02)
Platform: x86_64-redhat-linux-gnu (64-bit)
Running under: CentOS Linux 7 (Core)

Matrix products: default
BLAS/LAPACK: /usr/lib64/R/lib/libRblas.so

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] raster_2.8-19 sp_1.3-1      ncdf4_1.16   

loaded via a namespace (and not attached):
[1] compiler_3.5.1   rgdal_1.3-6      Rcpp_1.0.0       codetools_0.2-15
[5] grid_3.5.1       lattice_0.20-35 





> On Feb 12, 2019, at 9:19 AM, Ahmed El-Gabbas <elgabass at gmail.com> wrote:
> 
> Thanks Ben for your suggestion.
> 
> Adding *prj = TRUE *argument caused this error:
>           Error in ncdf4::ncvar_def(varname, varunit, list(xdim, ydim),
> NAvalue(x),  :
>           unused argument (prj = T)
> 
> Ahmed
> 
> On Tue, Feb 12, 2019 at 3:13 PM Ben Tupper <btupper at bigelow.org> wrote:
> 
>> Hi,
>> 
>> Have you tried using the 'prj' argument to writeRaster?  I don't know that
>> it will be the solution, but according to ...
>> 
>> 
>> https://www.rdocumentation.org/packages/raster/versions/2.8-19/topics/writeRaster
>> 
>> It is documented among the '...' arguments.  Setting prj = TRUE will cause
>> the crs to be written to the file.
>> 
>> Cheers,
>> Ben
>> 
>> On Feb 12, 2019, at 8:34 AM, Ahmed El-Gabbas <elgabass at gmail.com> wrote:
>> 
>> Hello all,
>> 
>> I am having a problem while converting a raster object as NetCDF (.nc)
>> file, with keeping the CRS information in the output file.
>> Here is a reproducible code:
>> 
>> require(raster)
>> require(ncdf4)
>> CurrTemp <- tempfile()
>> download.file(url = "https://seaice.uni-bremen.de/data/amsre/asi_daygrid_swath/s6250/2003/feb/Antarctic/asi-s6250-20030214-v5.hdf", destfile = CurrTemp, mode = "wb", quiet = T)
>> r <- raster(CurrTemp)
>> r <- flip(r,2)
>> extent(r) <- c(-3950000, 3950000, -3950000, 4350000)
>> crs(r) <- "+proj=stere +lat_0=-90 +lat_ts=-70 +lon_0=0 +k=1 +x_0=0 +y_0=0 +a=6378273 +b=6356889.449 +units=m +no_defs"
>> r# class       : RasterLayer # dimensions  : 1328, 1264, 1678592  (nrow, ncol, ncell)# resolution  : 6250, 6250  (x, y)# extent      : -3950000, 3950000, -3950000, 4350000  (xmin, xmax, ymin, ymax)# coord. ref. : +proj=stere +lat_0=-90 +lat_ts=-70 +lon_0=0 +k=1 +x_0=0 +y_0=0 +a=6378273 +b=6356889.449 +units=m +no_defs # data source : in memory# names     : layer # values      : 0, 100  (min, max)
>> 
>> So far the raster object reads well, with CRS information included.
>> However, when I try to save it as .nc file, R prints "coord. ref. : NA",
>> and the produced file does not contain the CRS information.
>> 
>> writeRaster(r, filename = "O:/Ahmed/r001.nc", varname="IceConc",
>>            overwrite=TRUE, format="CDF",
>>            xname="Longitude", yname="Latitude")# class       : RasterLayer # dimensions  : 1328, 1264, 1678592  (nrow, ncol, ncell)# resolution  : 6250, 6250  (x, y)# extent      : -3950000, 3950000, -3950000, 4350000  (xmin, xmax, ymin, ymax)# coord. ref. : NA # data source : O:/Ahmed/r001.nc # names       : IceConc # zvar        : IceConc
>> 
>> raster("O:/Ahmed/r001.nc")# class       : RasterLayer # dimensions  : 1328, 1264, 1678592  (nrow, ncol, ncell)# resolution  : 6250, 6250  (x, y)# extent      : -3950000, 3950000, -3950000, 4350000  (xmin, xmax, ymin, ymax)# coord. ref. : NA # data source : O:/Ahmed/r001.nc # names       : IceConc # zvar        : IceConc
>> 
>> Any solution?
>> 
>> N.B. I also sent the same question at stackoverflow
>> <https://stackoverflow.com/questions/54593552/saving-r-raster-to-netcdf-nc-file-with-keeping-crs-information>,
>> without a solution so far.
>> 
>> Thanks
>> 
>> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
>> *Dr. Ahmed El-Gabbas,*
>> Ocean Acoustics Lab,
>> Alfred-Wegener-Institut
>> Helmholtz-Zentrum f?r Polar und Meeresforschung
>> <image.png>
>> My Website:  https://elgabbas.github.io
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
>> 
>> Ben Tupper
>> Bigelow Laboratory for Ocean Sciences
>> 60 Bigelow Drive, P.O. Box 380
>> East Boothbay, Maine 04544
>> http://www.bigelow.org
>> 
>> Ecological Forecasting: https://eco.bigelow.org/
>> 
>> 
>> 
>> 
>> 
>> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Ben Tupper
Bigelow Laboratory for Ocean Sciences
60 Bigelow Drive, P.O. Box 380
East Boothbay, Maine 04544
http://www.bigelow.org

Ecological Forecasting: https://eco.bigelow.org/


From md@umner @end|ng |rom gm@||@com  Wed Feb 13 06:11:46 2019
From: md@umner @end|ng |rom gm@||@com (Michael Sumner)
Date: Wed, 13 Feb 2019 16:11:46 +1100
Subject: [R-sig-Geo] converting raster to netcdf .nc with keeping CRS
 information
In-Reply-To: <72204A1C-304B-4EFD-A89E-D4EF9C797EEF@bigelow.org>
References: <CAJEGayc6HWLrK+t_2PbXP-y9xmvqQpVadpTDHL=jFV09FbyX1w@mail.gmail.com>
 <2B8BD0B2-65B4-4C9B-98E9-C985D8EE0ABB@bigelow.org>
 <CAJEGayfo+A5gWXAcC6u5M0KTssURQzsXGAMqTjP7is-JiJ+e5Q@mail.gmail.com>
 <72204A1C-304B-4EFD-A89E-D4EF9C797EEF@bigelow.org>
Message-ID: <CAAcGz9-Y_DSfwRmjaftV4zdD_EGKbPWwfRMCR9nU8GBxEDjmiw@mail.gmail.com>

I agree, I wouldn't try to bend NetCDF to work this way via raster. The
convention/s require parameters of the projection to be specified via
attributes and you could do that via RNetCDF or ncdf4, but it's a lot of
painful work.

It's not easy to create NetCDF from R, it's a simple as that - and
typically those files don't play well with projections - it's changed
recently but you'll see a lot of patchy partial support across different
softwares.

You can use rgdal or call out out to GDAL - but then round-tripping gives
warnings, because again raster has to unpack all the components of metadata
that GDAL created, and none of this is very systematic and clearly is
broken atm.

system('gdal_translate r001.nc r001_aux.nc -of NetCDF -a_srs
"+init=epsg:3412"')
## you could do this with  stars too
rgdal::writeGDAL(as(r, "SpatialGridDataFrame"), "r001_rgdal.nc", drivername
= "NetCDF")


But, beware as in neither case is raster guaranteed to get the right
interpretation (THIS IS WRONG):

raster("r001_aux.nc")
raster("r001_rgdal.nc")
class       : RasterLayer
dimensions  : 1328, 1264, 1678592  (nrow, ncol, ncell)
resolution  : 6250, 6250  (x, y)
extent      : -3950000, 3950000, -3950000, 4350000  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=stere +lon_0=0 +x_0=0 +y_0=0 +lat_0=-90 +pm=0
+a=6378273 +rf=298.279411123064
data source : r001_rgdal.nc
names       : GDAL.Band.Number.1
zvar        : Band1

BTW, you called your X and Y "longitude" and "latitude" but this grid isn't
defined by those (eastings and northings is not a better name either, but
that's another problem).

Do you have to create new files?  I find that constantly a fraught problem,
For usage it's way easier to wrap stuff up with R code and work around all
these problems.

Cheers, Mike.

On Wed, 13 Feb 2019 at 12:47 Ben Tupper <btupper at bigelow.org> wrote:

> Hi Ahmed,
>
> I can confirm that on my system I get the same result as you.
>
> Does your workflow confine you to using NetCDF?  I can successfully
> write/read to the native raster format.
>
> r2 <- writeRaster(r, filename = "r001.grd", overwrite=TRUE)
> r2
> #class       : RasterLayer
> #dimensions  : 1328, 1264, 1678592  (nrow, ncol, ncell)
> #resolution  : 6250, 6250  (x, y)
> #extent      : -3950000, 3950000, -3950000, 4350000  (xmin, xmax, ymin,
> ymax)
> #coord. ref. : +proj=stere +lat_0=-90 +lat_ts=-70 +lon_0=0 +k=1 +x_0=0
> +y_0=0 +a=6378273 +b=6356889.449 +units=m +no_defs
> #data source : /home/btupper/r001.grd
> #names       : layer
> #values      : 0, 100  (min, max)
>
>
> r3 <- raster("r001.grd")
> r3
> #class       : RasterLayer
> #dimensions  : 1328, 1264, 1678592  (nrow, ncol, ncell)
> #resolution  : 6250, 6250  (x, y)
> #extent      : -3950000, 3950000, -3950000, 4350000  (xmin, xmax, ymin,
> ymax)
> #coord. ref. : +proj=stere +lat_0=-90 +lat_ts=-70 +lon_0=0 +k=1 +x_0=0
> +y_0=0 +a=6378273 +b=6356889.449 +units=m +no_defs
> #data source : /home/btupper/r001.grd
> #names       : layer
> #values      : 0, 100  (min, max)
>
> Ben
>
> > sessionInfo()
> R version 3.5.1 (2018-07-02)
> Platform: x86_64-redhat-linux-gnu (64-bit)
> Running under: CentOS Linux 7 (Core)
>
> Matrix products: default
> BLAS/LAPACK: /usr/lib64/R/lib/libRblas.so
>
> locale:
>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
>  [9] LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] raster_2.8-19 sp_1.3-1      ncdf4_1.16
>
> loaded via a namespace (and not attached):
> [1] compiler_3.5.1   rgdal_1.3-6      Rcpp_1.0.0       codetools_0.2-15
> [5] grid_3.5.1       lattice_0.20-35
>
>
>
>
>
> > On Feb 12, 2019, at 9:19 AM, Ahmed El-Gabbas <elgabass at gmail.com> wrote:
> >
> > Thanks Ben for your suggestion.
> >
> > Adding *prj = TRUE *argument caused this error:
> >           Error in ncdf4::ncvar_def(varname, varunit, list(xdim, ydim),
> > NAvalue(x),  :
> >           unused argument (prj = T)
> >
> > Ahmed
> >
> > On Tue, Feb 12, 2019 at 3:13 PM Ben Tupper <btupper at bigelow.org> wrote:
> >
> >> Hi,
> >>
> >> Have you tried using the 'prj' argument to writeRaster?  I don't know
> that
> >> it will be the solution, but according to ...
> >>
> >>
> >>
> https://www.rdocumentation.org/packages/raster/versions/2.8-19/topics/writeRaster
> >>
> >> It is documented among the '...' arguments.  Setting prj = TRUE will
> cause
> >> the crs to be written to the file.
> >>
> >> Cheers,
> >> Ben
> >>
> >> On Feb 12, 2019, at 8:34 AM, Ahmed El-Gabbas <elgabass at gmail.com>
> wrote:
> >>
> >> Hello all,
> >>
> >> I am having a problem while converting a raster object as NetCDF (.nc)
> >> file, with keeping the CRS information in the output file.
> >> Here is a reproducible code:
> >>
> >> require(raster)
> >> require(ncdf4)
> >> CurrTemp <- tempfile()
> >> download.file(url = "
> https://seaice.uni-bremen.de/data/amsre/asi_daygrid_swath/s6250/2003/feb/Antarctic/asi-s6250-20030214-v5.hdf",
> destfile = CurrTemp, mode = "wb", quiet = T)
> >> r <- raster(CurrTemp)
> >> r <- flip(r,2)
> >> extent(r) <- c(-3950000, 3950000, -3950000, 4350000)
> >> crs(r) <- "+proj=stere +lat_0=-90 +lat_ts=-70 +lon_0=0 +k=1 +x_0=0
> +y_0=0 +a=6378273 +b=6356889.449 +units=m +no_defs"
> >> r# class       : RasterLayer # dimensions  : 1328, 1264, 1678592
> (nrow, ncol, ncell)# resolution  : 6250, 6250  (x, y)# extent      :
> -3950000, 3950000, -3950000, 4350000  (xmin, xmax, ymin, ymax)# coord. ref.
> : +proj=stere +lat_0=-90 +lat_ts=-70 +lon_0=0 +k=1 +x_0=0 +y_0=0 +a=6378273
> +b=6356889.449 +units=m +no_defs # data source : in memory# names     :
> layer # values      : 0, 100  (min, max)
> >>
> >> So far the raster object reads well, with CRS information included.
> >> However, when I try to save it as .nc file, R prints "coord. ref. : NA",
> >> and the produced file does not contain the CRS information.
> >>
> >> writeRaster(r, filename = "O:/Ahmed/r001.nc", varname="IceConc",
> >>            overwrite=TRUE, format="CDF",
> >>            xname="Longitude", yname="Latitude")# class       :
> RasterLayer # dimensions  : 1328, 1264, 1678592  (nrow, ncol, ncell)#
> resolution  : 6250, 6250  (x, y)# extent      : -3950000, 3950000,
> -3950000, 4350000  (xmin, xmax, ymin, ymax)# coord. ref. : NA # data source
> : O:/Ahmed/r001.nc # names       : IceConc # zvar        : IceConc
> >>
> >> raster("O:/Ahmed/r001.nc")# class       : RasterLayer # dimensions  :
> 1328, 1264, 1678592  (nrow, ncol, ncell)# resolution  : 6250, 6250  (x, y)#
> extent      : -3950000, 3950000, -3950000, 4350000  (xmin, xmax, ymin,
> ymax)# coord. ref. : NA # data source : O:/Ahmed/r001.nc # names       :
> IceConc # zvar        : IceConc
> >>
> >> Any solution?
> >>
> >> N.B. I also sent the same question at stackoverflow
> >> <
> https://stackoverflow.com/questions/54593552/saving-r-raster-to-netcdf-nc-file-with-keeping-crs-information
> >,
> >> without a solution so far.
> >>
> >> Thanks
> >>
> >> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> >> *Dr. Ahmed El-Gabbas,*
> >> Ocean Acoustics Lab,
> >> Alfred-Wegener-Institut
> >> Helmholtz-Zentrum f?r Polar und Meeresforschung
> >> <image.png>
> >> My Website:  https://elgabbas.github.io
> >> _______________________________________________
> >> R-sig-Geo mailing list
> >> R-sig-Geo at r-project.org
> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>
> >>
> >> Ben Tupper
> >> Bigelow Laboratory for Ocean Sciences
> >> 60 Bigelow Drive, P.O. Box 380
> >> East Boothbay, Maine 04544
> >> http://www.bigelow.org
> >>
> >> Ecological Forecasting: https://eco.bigelow.org/
> >>
> >>
> >>
> >>
> >>
> >>
> >
> >       [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> Ben Tupper
> Bigelow Laboratory for Ocean Sciences
> 60 Bigelow Drive, P.O. Box 380
> East Boothbay, Maine 04544
> http://www.bigelow.org
>
> Ecological Forecasting: https://eco.bigelow.org/
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
-- 
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia

	[[alternative HTML version deleted]]


From ju@ten @end|ng |rom t@mu@edu  Wed Feb 13 06:48:43 2019
From: ju@ten @end|ng |rom t@mu@edu (Hannah Justen)
Date: Tue, 12 Feb 2019 23:48:43 -0600
Subject: [R-sig-Geo] Sampling random directional lines within a polygon
In-Reply-To: <CANVKczP-axSR3MMvJESSJ0T0Uv9x3XRK9enp8Bm9U4gS_ZOCSA@mail.gmail.com>
References: <CAGUtHj2aP0Tq4kk5t2P2FSgRa80EmJBXpv8k1VbVJpnDB_SP-A@mail.gmail.com>
 <CANVKczMiQUw2oNcWACnXT_ge0f3f-7wgMjsj4agR_yWXJWoZ6g@mail.gmail.com>
 <d783fddb8a4d4de09eb0dd128d015333@CWXP265MB1704.GBRP265.PROD.OUTLOOK.COM>
 <CANVKczNkWhTsifmTdxjxXm5mghjue8oOhOJ-BU1z=qoUr7ZTew@mail.gmail.com>
 <CANVKczP-axSR3MMvJESSJ0T0Uv9x3XRK9enp8Bm9U4gS_ZOCSA@mail.gmail.com>
Message-ID: <CAGUtHj3jFSuoX6QfPH1TMdb3bGxqDypkY334A=pvuD1eoxec7w@mail.gmail.com>

Hi everyone,

I wanted to generate random lines between two spatial points (random points
in polygons). The lines should consist of segments (9 segments), after
following suggestions I received to my previous post, I ended up using
trajectories. My aim now is to restrict these random trajectories (see
points in the attachment as an example) to the extent of a polygon (shown
in the attachment in yellow). So the trajectories should lie within the
polygon.
Please find the code I used below:
I first generated a data frame with my start and end point and used it to
generate a trajectory (straight line in attachment). I then generated a
random trajectory and shifted it so that the start and endpoints were equal
to my first trajectory. I transformed the matrices to a Spatial Data frame
to be able to plot it. Does anyone know how I can restrict the extent of
the trajectory that I randomly generate?

#coordinates of start and end point and time steps
x<-c(1649786,-1636500)
y<-c(-2902593,738500)
times<-c(0,9)
start_end_points<-as.data.frame(cbind(x,y,times))

# generate a trajectory between start and endpoint
trj<-TrajFromCoords(point_trj,xCol=1,yCol=2,timeCol=3, spatialUnits="m",
timeUnits="d")

# generate a random trajectory with 9 segments
track<-TrajGenerate(n=9, random=T, stepLength=TrajLength(trj)/9)

# To be able to use StartEndTranslate transform trajectories into matrices
ma1<-as.matrix(trj)
ma2<-as.matrix(track)

# Translate, rotate and scale the points of traj2 using traj1. The new traj
will have the same start and end points as traj1.
p<-StartEndTranslate(ma1,ma2)

# to check if this worked transform into SpatialDataFrame
# the start and end point of the new matrix are the same as the traj1 which
is good, the rest of the points changed as well
p_df<-as.data.frame(p)

# change lat / longs to nummeric
p_df$x<-as.numeric(p_df$x)
p_df$y<-as.numeric(p_df$y)

# generate a spatial dataframe to check if the StartEndTranslate function
worked by plotting it
xy<-p_df[,c(1,2)]

spdf<-SpatialPointsDataFrame(coords=xy, data=p_df, proj4string =
CRS(projection))

Thank you very much!

On Wed, Feb 6, 2019 at 5:42 PM Barry Rowlingson <b.rowlingson at gmail.com>
wrote:

> Had another idea which is now implemented...
>
> Consider any segmented path of segments of lengths L_i at angles A_i. Its
> endpoint will be the vector sum of those segments, ie at (x,y) = (sum(L_i
> cos(A_i)), sum(L_i sin(A_i)).
>
> To create a segmented path to a given (x,y), solve that expression for the
> angles A_i. In R you can treat this as an optimisation problem - find a set
> of angles A_i that minimise the distance of the end of the segmented path
> from the target end point.
>
> Here's some code that does that for a path from 0,0 to 0,1:
>
> pathit <- function(segments){
>     obj = function(angles){
>         dxdy = dxdy(segments, angles)
>         xerr = dxdy$dx-1
>         yerr = dxdy$dy
>         err = sqrt(xerr^2 + yerr^2)
>         err
>     }
>     angles = runif(length(segments), 0 , 2*pi)
>     optim(angles, obj)
> }
>
> dxdy = function(segments, angles){
>     dx = sum(segments * cos(angles))
>     dy = sum(segments * sin(angles))
>     list(dx=dx, dy=dy)
> }
>
> plotsegs <- function(segments, angles){
>     x = rep(NA, length(segments) +1)
>     y = x
>     x[1] = 0
>     y[1] = 0
>     for(i in 2:(length(segments)+1)){
>         x[i] = x[i-1] + segments[i-1]*cos(angles[i-1])
>         y[i] = y[i-1] + segments[i-1]*sin(angles[i-1])
>     }
>     cbind(x,y)
> }
>
> This is deliberately written naively for clarity.
>
> To use, set the segment sizes, optimise, and then plot:
>
>  s1 = c(.1,.3,.2,.1,.3,.3,.1)
>  a1 = pathit(s1)
>  plot(plotsegs(s1,a1$par),type="l")
>
> which should show a path of seven segments from 0,0 to 0,1 - since the
> initial starting values are random the model can find different solutions.
> Run again for a different path.
>
> To see what the space of paths looks like, do lots and overplot them:
>
>   lots = lapply(1:1000, function(i)plotsegs(s1,pathit(s1)$par))
>   plot(c(-.1,1.1),c(-1,1))
>   p = lapply(lots, function(xy){lines(xy)})
>
> this should show 1000 paths, and illustrates the "ellipse" of path
> possibles that I mentioned in the previous email.
>
> Sometimes the optimiser struggles to find a solution and so you should
> probably test the output from optim for convergence and to make sure the
> target function is close enough to zero for your purposes.  For the example
> above most of the time the end point is about 1e-5  from (1,0) but for
> harder problems such as s = rep(.1, 11) which only has 0.1 of extra "slack"
> length, the error can be 0.02 and failed convergence. Possibly longer optim
> runs would help or constraining the angles.
>
> Anyway, interesting problem....
>
> Barry
>
>
>
>
>
>
>
> On Wed, Feb 6, 2019 at 8:23 PM Barry Rowlingson <b.rowlingson at gmail.com>
> wrote:
>
>> Do you want to generate these for input into some statistical process, or
>> to generate some test data that looks a bit like real data? I think
>> generating test data isn't too difficult, but anything that you might want
>> to put into a statistical test (eg testing some hypothesis about the birds
>> maximum deviation from the straight line A-B) needs a lot more care in
>> formulating the path generating process.
>>
>> Here's some thoughts - if you consider one of the red segments in your
>> map as a piece of string (rather than 10 segments) anchored at the points,
>> then you can stretch it taut with a pencil and draw an ellipse with A and B
>> as the foci. Any path created with that string - taut or slack as in your
>> map - has to strictly lie within the ellipse. Now you can wiggle that
>> string inside that ellipse and create an infinity of paths from A to B of
>> the same length. I'm not sure how you can sample uniformly from that
>> infinity such that any path has an equal sampling probability. Your problem
>> is similar but has the additional rigid segment constraint.
>>
>> Any two adjacent segments of a chain, eg 1----2-------3, as long as it
>> isn't taut (ie straight) can be perturbed by holding 1 and 3 still and
>> moving 2 to the "mirror image" point over the straight line from 1 to 3.
>> You can also take three segments 1--2--3--4 and hold 1 and 4 still and
>> perturb 2 and 3 fairly easily. In this way you could set up an initial
>> chain and then run multiple perturbations on the chain to get a "random"
>> chain, but quite what set of all chains it would be a sample from is not
>> clear. It could at least generate reasonable looking paths, but I wouldn't
>> want to test a hypothesis against it.
>>
>> I'm going to generate a path from my office to my home now.
>>
>> Barry
>>
>>
>>
>>
>>
>>
>> On Wed, Feb 6, 2019 at 7:50 PM Hannah Justen <justen at tamu.edu> wrote:
>>
>>> Hello everyone,
>>>
>>> Thank you very much for the suggestions.
>>>
>>> Regarding more details (please also see attached figure):
>>> I would like to simulate a bird's migration between breeding (starting
>>> polygon - blue in the figure) and wintering grounds (end polygon - green in
>>> the figure). The lines can start from anywhere within the starting polygon
>>> and end anywhere in the end polygon. The lines shall consist of 10
>>> connected segments with variable length between 300 and 1000 km (see red
>>> lines in figure; two examples of possible lines with 10 segments between
>>> the polygons).
>>>
>>> Thank you very much for you help,
>>> Hannah
>>>
>>> ---
>>> PhD Student |Ecology and Evolutionary Biology
>>> Texas A&M University
>>>
>>> On Wed, Feb 6, 2019 at 5:12 AM Barry Rowlingson <
>>> b.rowlingson at lancaster.ac.uk> wrote:
>>>
>>>> Interesting, but I think we need more details...
>>>>
>>>> Do the lines have to start and finish at specific locations in the
>>>> polygons - like the centroid, or anywhere?
>>>>
>>>> So one line might be 3 segments of 10km each connecting two polygon
>>>> centroids that are 15km apart? Imagining three rigid rods of length 10
>>>> connected at their ends and with the first and last also connected to two
>>>> fixed points tells me there's an infinite number of possible solutions.
>>>> There's probably also a number of ways of sampling from those solutions.
>>>> Its going to get very complicated with a larger number of segments.
>>>>
>>>> Hmmmmm.....
>>>>
>>>> Barry
>>>>
>>>>
>>>>
>>>>
>>>> On Tue, Feb 5, 2019 at 11:30 PM Hannah Justen <justen at tamu.edu> wrote:
>>>>
>>>>> Hi everyone,
>>>>>
>>>>> I am studying migratory tracks of birds for my dissertation and I would
>>>>> like to model possible pathways between two polygons. Therefore, I
>>>>> would
>>>>> like to sample random lines between the polygons. These lines can
>>>>> differ in
>>>>> total length but should consist of x - number of fragments of equal
>>>>> length.
>>>>> Each fragment can have slightly different orientation but overall the
>>>>> lines
>>>>> should connect the two polygons.
>>>>>
>>>>> I fail to find the appropriate R package that will allow me to do this
>>>>> type
>>>>> of analysis. Does anyone have a suggestion how to approach analysis?
>>>>>
>>>>> Thank you,
>>>>> Hannah
>>>>>
>>>>> ---
>>>>> PhD Student |Ecology and Evolutionary Biology
>>>>> Texas A&M University
>>>>>
>>>>>         [[alternative HTML version deleted]]
>>>>>
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>> <https://urldefense.proofpoint.com/v2/url?u=https-3A__stat.ethz.ch_mailman_listinfo_r-2Dsig-2Dgeo&d=DwMFaQ&c=ODFT-G5SujMiGrKuoJJjVg&r=JTKhaSJXwF2BxCfjjnt61w&m=RH21jOLOEbLLudn70kOTH0wnklnKHk-tFm9cxjxAB9k&s=H_HhNMga7aaqbnNsWexqY1jdRFFo7zO_m9xvk2awODo&e=>
>>>>>
>>>>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20190212/61f58f91/attachment.html>

-------------- next part --------------
A non-text attachment was scrubbed...
Name: restrict_trajectory_to_extent_of_polygon2.jpg
Type: image/jpeg
Size: 14874 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20190212/61f58f91/attachment.jpg>

From m||or| @end|ng |rom @rp@@@@rdegn@@|t  Wed Feb 13 12:06:07 2019
From: m||or| @end|ng |rom @rp@@@@rdegn@@|t (Michele Fiori)
Date: Wed, 13 Feb 2019 12:06:07 +0100
Subject: [R-sig-Geo] Sirad for hourly extraterrestrial solar radiation
Message-ID: <003c01d4c38c$20bdbb90$623932b0$@arpa.sardegna.it>

Hello everybody,

I use SIrad for estimating daily extraterrestrial solar radiation for
Sardinia using dem, in this way

 

DAY    = "2019-02-13"

dem$Ra <- extrat(dayOfYear(DAY),
radians(dem$lat_250))$ExtraTerrestrialSolarRadiationDaily

 

now I need to map hourly values for specific hours, but when I calculate
$ExtraTerrestrialSolarRadiationHorly 

I obtain the whole set of 24 values for each grid point, ma question is ..
how can I extract and plot only specific hourly values, for example maximum
values (12 o' clock)?  

Thank you

Regards, Michele

 

 

Michele Fiori

ARPAS - Agenzia Regionale per la Protezione dell'Ambiente della Sardegna
Dipartimento Meteoclimatico - Servizio Meteorologico Agrometeorologico ed
Ecosistemi

Viale Porto Torres 119 - 07100 Sassari
Tel + 39 079 258617 Fax +39 262681

 

 <http://www.sardegnaambiente.it/arpas> www.sardegnaambiente.it/arpas

 


	[[alternative HTML version deleted]]


From |@r@@@|p@@||v@ @end|ng |rom gm@||@com  Wed Feb 13 15:47:34 2019
From: |@r@@@|p@@||v@ @end|ng |rom gm@||@com (Lara Silva)
Date: Wed, 13 Feb 2019 13:47:34 -0100
Subject: [R-sig-Geo] Is there a way to merge different stacks?
Message-ID: <CALN9TETPxnf3kJmp3ejeYt2VCtTnvYtoMzvXgqjXt1qfy7JzFw@mail.gmail.com>

Hello everybody,
I am having a problem to merge several stacks. My stacks have different
extensions ... It is a problem.

If possible, I want to merge several (5 stacks) asc grids into in a "global
grid/stack"
How can I do it? "Merging", "joining" ...?
Any sugestion?

Thanks,

Lara Silva

My outputs:

1st stack

> grids_climatic_SMP <- list.files(pattern='asc', full.names=T)# All "asc"
files in folder
> climatic_SMP<- stack(grids_climatic_SMP)# Make a "stack" of EGV #Install
"stack"
> climatic_SMP
class       : RasterStack
dimensions  : 901, 901, 811801, 20  (nrow, ncol, ncell, nlayers)
resolution  : 100, 100  (x, y)
extent      : 586974, 677074, 4140847, 4230947  (xmin, xmax, ymin, ymax)
coord. ref. : NA
names       : bio1_SMP, bio10_SMP, bio11_SMP, bio12_SMP, bio13_SMP,
bio14_SMP, bio15_SMP, bio16_SMP, bio17_SMP, bio18_SMP, bio19_SMP, bio2_SMP,
bio3_SMP, bio4_SMP, bio4a_SMP, ...

2nd stack

> grids_climatic_PP <- list.files(pattern='asc', full.names=T)# All "asc"
files in folder
> climatic_PP<- stack(grids_climatic_PP)# Make a "stack" of EGV #Install
"stack"
> climatic_PP
class       : RasterStack
dimensions  : 601, 601, 361201, 20  (nrow, ncol, ncell, nlayers)
resolution  : 100, 100  (x, y)
extent      : 358603, 418703, 4229376, 4289476  (xmin, xmax, ymin, ymax)
coord. ref. : NA
names       : bio1_PP, bio10_PP, bio11_PP, bio12_PP, bio13_PP, bio14_PP,
bio15_PP, bio16_PP, bio17_PP, bio18_PP, bio19_PP, bio2_PP, bio3_PP,
bio4_PP, bio4a_PP, ...

3rd stack

> grids_climatic_TP <- list.files(pattern='asc', full.names=T)# All "asc"
files in folder
> climatic_TP<- stack(grids_climatic_TP)# Make a "stack" of EGV #Install
"stack"
> climatic_TP
class       : RasterStack
dimensions  : 277, 412, 114124, 20  (nrow, ncol, ncell, nlayers)
resolution  : 100, 100  (x, y)
extent      : 461214, 502414, 4272892, 4300592  (xmin, xmax, ymin, ymax)
coord. ref. : NA
names       : bio1_TP, bio10_TP, bio11_TP, bio12_TP, bio13_TP, bio14_TP,
bio15_TP, bio16_TP, bio17_TP, bio18_TP, bio19_TP, bio2_TP, bio3_TP,
bio4_TP, bio4a_TP, ...


4th stack

> grids_climatic_FP <- list.files(pattern='asc', full.names=T)# All "asc"
files in folder
> climatic_FP<- stack(grids_climatic_FP)# Make a "stack" of EGV #Install
"stack"
> climatic_FP
class       : RasterStack
dimensions  : 301, 301, 90601, 20  (nrow, ncol, ncell, nlayers)
resolution  : 100, 100  (x, y)
extent      : 336088, 366188, 4256440, 4286540  (xmin, xmax, ymin, ymax)
coord. ref. : NA
names       : bio1_FP, bio10_FP, bio11_FP, bio12_FP, bio13_FP, bio14_FP,
bio15_FP, bio16_FP, bio17_FP, bio18_FP, bio19_FP, bio2_FP, bio3_FP,
bio4_FP, bio4a_FP, ...


5th stack

> grids_climatic_SJP <- list.files(pattern='asc', full.names=T)# All "asc"
files in folder
> climatic_SJP<- stack(grids_climatic_SJP)# Make a "stack" of EGV #Install
"stack"
> climatic_SJP
class       : RasterStack
dimensions  : 602, 602, 362404, 20  (nrow, ncol, ncell, nlayers)
resolution  : 100, 100  (x, y)
extent      : 381100, 441300, 4249487, 4309687  (xmin, xmax, ymin, ymax)
coord. ref. : NA
names       : bio1_SJP, bio10_SJP, bio11_SJP, bio12_SJP, bio13_SJP,
bio14_SJP, bio15_SJP, bio16_SJP, bio17_SJP, bio18_SJP, bio19_SJP, bio2_SJP,
bio3_SJP, bio4_SJP, bio4a_SJP, ...

>

	[[alternative HTML version deleted]]


From hugo@gco@t@ @end|ng |rom gm@||@com  Wed Feb 13 16:21:46 2019
From: hugo@gco@t@ @end|ng |rom gm@||@com (Hugo Costa)
Date: Wed, 13 Feb 2019 15:21:46 +0000
Subject: [R-sig-Geo] Is there a way to merge different stacks?
In-Reply-To: <CALN9TETPxnf3kJmp3ejeYt2VCtTnvYtoMzvXgqjXt1qfy7JzFw@mail.gmail.com>
References: <CALN9TETPxnf3kJmp3ejeYt2VCtTnvYtoMzvXgqjXt1qfy7JzFw@mail.gmail.com>
Message-ID: <CADvFi5oGGV5uZ-stkPhz9Rr75kdSJTRwTZYbMwOt1hivLQtOmA@mail.gmail.com>

You are possibly looking for function mosaic (raster package).
Hugo

Lara Silva <lara.sfp.silva at gmail.com> escreveu no dia quarta, 13/02/2019
?(s) 14:47:

> Hello everybody,
> I am having a problem to merge several stacks. My stacks have different
> extensions ... It is a problem.
>
> If possible, I want to merge several (5 stacks) asc grids into in a "global
> grid/stack"
> How can I do it? "Merging", "joining" ...?
> Any sugestion?
>
> Thanks,
>
> Lara Silva
>
> My outputs:
>
> 1st stack
>
> > grids_climatic_SMP <- list.files(pattern='asc', full.names=T)# All "asc"
> files in folder
> > climatic_SMP<- stack(grids_climatic_SMP)# Make a "stack" of EGV #Install
> "stack"
> > climatic_SMP
> class       : RasterStack
> dimensions  : 901, 901, 811801, 20  (nrow, ncol, ncell, nlayers)
> resolution  : 100, 100  (x, y)
> extent      : 586974, 677074, 4140847, 4230947  (xmin, xmax, ymin, ymax)
> coord. ref. : NA
> names       : bio1_SMP, bio10_SMP, bio11_SMP, bio12_SMP, bio13_SMP,
> bio14_SMP, bio15_SMP, bio16_SMP, bio17_SMP, bio18_SMP, bio19_SMP, bio2_SMP,
> bio3_SMP, bio4_SMP, bio4a_SMP, ...
>
> 2nd stack
>
> > grids_climatic_PP <- list.files(pattern='asc', full.names=T)# All "asc"
> files in folder
> > climatic_PP<- stack(grids_climatic_PP)# Make a "stack" of EGV #Install
> "stack"
> > climatic_PP
> class       : RasterStack
> dimensions  : 601, 601, 361201, 20  (nrow, ncol, ncell, nlayers)
> resolution  : 100, 100  (x, y)
> extent      : 358603, 418703, 4229376, 4289476  (xmin, xmax, ymin, ymax)
> coord. ref. : NA
> names       : bio1_PP, bio10_PP, bio11_PP, bio12_PP, bio13_PP, bio14_PP,
> bio15_PP, bio16_PP, bio17_PP, bio18_PP, bio19_PP, bio2_PP, bio3_PP,
> bio4_PP, bio4a_PP, ...
>
> 3rd stack
>
> > grids_climatic_TP <- list.files(pattern='asc', full.names=T)# All "asc"
> files in folder
> > climatic_TP<- stack(grids_climatic_TP)# Make a "stack" of EGV #Install
> "stack"
> > climatic_TP
> class       : RasterStack
> dimensions  : 277, 412, 114124, 20  (nrow, ncol, ncell, nlayers)
> resolution  : 100, 100  (x, y)
> extent      : 461214, 502414, 4272892, 4300592  (xmin, xmax, ymin, ymax)
> coord. ref. : NA
> names       : bio1_TP, bio10_TP, bio11_TP, bio12_TP, bio13_TP, bio14_TP,
> bio15_TP, bio16_TP, bio17_TP, bio18_TP, bio19_TP, bio2_TP, bio3_TP,
> bio4_TP, bio4a_TP, ...
>
>
> 4th stack
>
> > grids_climatic_FP <- list.files(pattern='asc', full.names=T)# All "asc"
> files in folder
> > climatic_FP<- stack(grids_climatic_FP)# Make a "stack" of EGV #Install
> "stack"
> > climatic_FP
> class       : RasterStack
> dimensions  : 301, 301, 90601, 20  (nrow, ncol, ncell, nlayers)
> resolution  : 100, 100  (x, y)
> extent      : 336088, 366188, 4256440, 4286540  (xmin, xmax, ymin, ymax)
> coord. ref. : NA
> names       : bio1_FP, bio10_FP, bio11_FP, bio12_FP, bio13_FP, bio14_FP,
> bio15_FP, bio16_FP, bio17_FP, bio18_FP, bio19_FP, bio2_FP, bio3_FP,
> bio4_FP, bio4a_FP, ...
>
>
> 5th stack
>
> > grids_climatic_SJP <- list.files(pattern='asc', full.names=T)# All "asc"
> files in folder
> > climatic_SJP<- stack(grids_climatic_SJP)# Make a "stack" of EGV #Install
> "stack"
> > climatic_SJP
> class       : RasterStack
> dimensions  : 602, 602, 362404, 20  (nrow, ncol, ncell, nlayers)
> resolution  : 100, 100  (x, y)
> extent      : 381100, 441300, 4249487, 4309687  (xmin, xmax, ymin, ymax)
> coord. ref. : NA
> names       : bio1_SJP, bio10_SJP, bio11_SJP, bio12_SJP, bio13_SJP,
> bio14_SJP, bio15_SJP, bio16_SJP, bio17_SJP, bio18_SJP, bio19_SJP, bio2_SJP,
> bio3_SJP, bio4_SJP, bio4a_SJP, ...
>
> >
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From |@r@@@|p@@||v@ @end|ng |rom gm@||@com  Wed Feb 13 16:28:27 2019
From: |@r@@@|p@@||v@ @end|ng |rom gm@||@com (Lara Silva)
Date: Wed, 13 Feb 2019 14:28:27 -0100
Subject: [R-sig-Geo] Is there a way to merge different stacks?
In-Reply-To: <CADvFi5oGGV5uZ-stkPhz9Rr75kdSJTRwTZYbMwOt1hivLQtOmA@mail.gmail.com>
References: <CALN9TETPxnf3kJmp3ejeYt2VCtTnvYtoMzvXgqjXt1qfy7JzFw@mail.gmail.com>
 <CADvFi5oGGV5uZ-stkPhz9Rr75kdSJTRwTZYbMwOt1hivLQtOmA@mail.gmail.com>
Message-ID: <CALN9TETEs-wC98US1gEA+LCTOY_X0-Xk1zTgVTK-M4tc1fQK-Q@mail.gmail.com>

Thank you for your answer.

Lara

Hugo Costa <hugoagcosta at gmail.com> escreveu no dia quarta, 13/02/2019 ?(s)
14:21:

> You are possibly looking for function mosaic (raster package).
> Hugo
>
> Lara Silva <lara.sfp.silva at gmail.com> escreveu no dia quarta, 13/02/2019
> ?(s) 14:47:
>
>> Hello everybody,
>> I am having a problem to merge several stacks. My stacks have different
>> extensions ... It is a problem.
>>
>> If possible, I want to merge several (5 stacks) asc grids into in a
>> "global
>> grid/stack"
>> How can I do it? "Merging", "joining" ...?
>> Any sugestion?
>>
>> Thanks,
>>
>> Lara Silva
>>
>> My outputs:
>>
>> 1st stack
>>
>> > grids_climatic_SMP <- list.files(pattern='asc', full.names=T)# All "asc"
>> files in folder
>> > climatic_SMP<- stack(grids_climatic_SMP)# Make a "stack" of EGV #Install
>> "stack"
>> > climatic_SMP
>> class       : RasterStack
>> dimensions  : 901, 901, 811801, 20  (nrow, ncol, ncell, nlayers)
>> resolution  : 100, 100  (x, y)
>> extent      : 586974, 677074, 4140847, 4230947  (xmin, xmax, ymin, ymax)
>> coord. ref. : NA
>> names       : bio1_SMP, bio10_SMP, bio11_SMP, bio12_SMP, bio13_SMP,
>> bio14_SMP, bio15_SMP, bio16_SMP, bio17_SMP, bio18_SMP, bio19_SMP,
>> bio2_SMP,
>> bio3_SMP, bio4_SMP, bio4a_SMP, ...
>>
>> 2nd stack
>>
>> > grids_climatic_PP <- list.files(pattern='asc', full.names=T)# All "asc"
>> files in folder
>> > climatic_PP<- stack(grids_climatic_PP)# Make a "stack" of EGV #Install
>> "stack"
>> > climatic_PP
>> class       : RasterStack
>> dimensions  : 601, 601, 361201, 20  (nrow, ncol, ncell, nlayers)
>> resolution  : 100, 100  (x, y)
>> extent      : 358603, 418703, 4229376, 4289476  (xmin, xmax, ymin, ymax)
>> coord. ref. : NA
>> names       : bio1_PP, bio10_PP, bio11_PP, bio12_PP, bio13_PP, bio14_PP,
>> bio15_PP, bio16_PP, bio17_PP, bio18_PP, bio19_PP, bio2_PP, bio3_PP,
>> bio4_PP, bio4a_PP, ...
>>
>> 3rd stack
>>
>> > grids_climatic_TP <- list.files(pattern='asc', full.names=T)# All "asc"
>> files in folder
>> > climatic_TP<- stack(grids_climatic_TP)# Make a "stack" of EGV #Install
>> "stack"
>> > climatic_TP
>> class       : RasterStack
>> dimensions  : 277, 412, 114124, 20  (nrow, ncol, ncell, nlayers)
>> resolution  : 100, 100  (x, y)
>> extent      : 461214, 502414, 4272892, 4300592  (xmin, xmax, ymin, ymax)
>> coord. ref. : NA
>> names       : bio1_TP, bio10_TP, bio11_TP, bio12_TP, bio13_TP, bio14_TP,
>> bio15_TP, bio16_TP, bio17_TP, bio18_TP, bio19_TP, bio2_TP, bio3_TP,
>> bio4_TP, bio4a_TP, ...
>>
>>
>> 4th stack
>>
>> > grids_climatic_FP <- list.files(pattern='asc', full.names=T)# All "asc"
>> files in folder
>> > climatic_FP<- stack(grids_climatic_FP)# Make a "stack" of EGV #Install
>> "stack"
>> > climatic_FP
>> class       : RasterStack
>> dimensions  : 301, 301, 90601, 20  (nrow, ncol, ncell, nlayers)
>> resolution  : 100, 100  (x, y)
>> extent      : 336088, 366188, 4256440, 4286540  (xmin, xmax, ymin, ymax)
>> coord. ref. : NA
>> names       : bio1_FP, bio10_FP, bio11_FP, bio12_FP, bio13_FP, bio14_FP,
>> bio15_FP, bio16_FP, bio17_FP, bio18_FP, bio19_FP, bio2_FP, bio3_FP,
>> bio4_FP, bio4a_FP, ...
>>
>>
>> 5th stack
>>
>> > grids_climatic_SJP <- list.files(pattern='asc', full.names=T)# All "asc"
>> files in folder
>> > climatic_SJP<- stack(grids_climatic_SJP)# Make a "stack" of EGV #Install
>> "stack"
>> > climatic_SJP
>> class       : RasterStack
>> dimensions  : 602, 602, 362404, 20  (nrow, ncol, ncell, nlayers)
>> resolution  : 100, 100  (x, y)
>> extent      : 381100, 441300, 4249487, 4309687  (xmin, xmax, ymin, ymax)
>> coord. ref. : NA
>> names       : bio1_SJP, bio10_SJP, bio11_SJP, bio12_SJP, bio13_SJP,
>> bio14_SJP, bio15_SJP, bio16_SJP, bio17_SJP, bio18_SJP, bio19_SJP,
>> bio2_SJP,
>> bio3_SJP, bio4_SJP, bio4a_SJP, ...
>>
>> >
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>

	[[alternative HTML version deleted]]


From johnw@@|ge @end|ng |rom gm@||@com  Sun Feb 17 13:35:41 2019
From: johnw@@|ge @end|ng |rom gm@||@com (John Wasige)
Date: Sun, 17 Feb 2019 13:35:41 +0100
Subject: [R-sig-Geo] Error with running bfastSpatial on MODIS data
Message-ID: <CAJgdCD5yAHvQwVserMv1ktQf9XNYcE5QXu_uQYvROpzbBFNYSw@mail.gmail.com>

Dear all,
I got error with running bfastSpatial on MODIS data for period of 2001-2019
. What could be my problem here?

###########

library(bfastSpatial)



##########

#MODIS data for period of 2001-2019

  n <- timeStackMODIS(list.files(path = dir, pattern = ".tif"))

   t <- system.time(

    bfm <- bfmSpatial(n, start=c(2009, 1), order=1)

 )



 # extract change raster

 change <- raster(bfm, 1)

months <- changeMonth(change)



###### Error

Error in setValues(r, values = methods::callGeneric(getValues(e1), e2)) :

  length(values) is not equal to ncell(x), or to 1

	[[alternative HTML version deleted]]


From rv@|@v| @end|ng |rom @tudent@un|me|b@edu@@u  Mon Feb 18 03:46:50 2019
From: rv@|@v| @end|ng |rom @tudent@un|me|b@edu@@u (Roozbeh Valavi)
Date: Mon, 18 Feb 2019 13:46:50 +1100
Subject: [R-sig-Geo] Euclidean distance raster
Message-ID: <CAH-s5PP811ph+H=NUGb4_AVPMSd2eH+yGLGuE29EZttjQHW5xQ@mail.gmail.com>

Hi all,

I want to create a nearest distance raster in R. As far as I know, the
common practice is to compute the distance matrix of all the points in the
mask raster to all the features in the vector layer, then calculate the min
distance for each point. But this makes a huge (m by n) matrix and it
involves a lot of computation which is too slow.

To go around the computation, I wrote the following function that first
gets the index of the nearest feature to each point in the mask raster,
then only calculates the distance between each point and its nearest
feature. This solution is 3 times faster than the previous one, but still
not fast enough.

I wonder if anyone knows a better solution to this problem.

Thank you in advance,
Roozbeh Valavi

rasterDistance <- function(feature, rastermask){
  require(raster)
  require(sf)
  require(progress)
  p <- st_as_sf(rasterToPoints(rastermask, spatial = TRUE))
  p$indx <- st_nearest_feature(st_geometry(p), st_geometry(feature))
  pb <- progress::progress_bar$new(format = " Progress [:bar] :percent in
:elapsed",
                                   total=nrow(p), clear=FALSE, width=75) #
add progress bar
  for(i in 1:nrow(p)){
    p$dist[i] <- st_distance(st_geometry(p[i,]),
st_geometry(feature[p$indx[i],]))
    pb$tick() # update progress bar
  }
  output <- raster::rasterize(p, rastermask, field = "dist")
  return(output)
}

-- 
*Roozbeh Valavi*
PhD Candidate
The Quantitative & Applied Ecology Group <http://qaeco.com/>
School of BioSciences | Faculty of Science
The University of Melbourne, VIC 3010, Australia
Mobile: +61 423 283 238

	[[alternative HTML version deleted]]


From m||uj|@b @end|ng |rom gm@||@com  Mon Feb 18 09:57:15 2019
From: m||uj|@b @end|ng |rom gm@||@com (Miluji Sb)
Date: Mon, 18 Feb 2019 09:57:15 +0100
Subject: [R-sig-Geo] Plot coordinates on world map with Robinson CRS -
 ggplot2
Message-ID: <CAMLwc7NZyf52=+BT2P4jq7b=j6V39cuxVLiR07=UZshPAtRmiQ@mail.gmail.com>

Dear all,

I am trying to plot coordinates on a world map with Robinson CRS. While the
world map is generated without any issues, when I try to plot the points -
I only get a single point.

The code I am using and the coordinates data is below. What am I doing
wrong? Any help/suggestions will be highly appreciated.

library(data.table)
library(foreign)
library(readstata13)
library(rgdal)
library(maptools)
library(ggplot2)
library(dplyr)

load(url("
https://github.com/valentinitnelav/RandomScripts/blob/master/NaturalEarth.RData?raw=true
"))

PROJ <- "+proj=robin +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84
+units=m +no_defs"

NE_countries_rob  <- spTransform(NE_countries, CRSobj = PROJ)
NE_graticules_rob <- spTransform(NE_graticules, CRSobj = PROJ)
NE_box_rob        <- spTransform(NE_box, CRSobj = PROJ)

# project long-lat coordinates for graticule label data frames
# (two extra columns with projected XY are created)
prj.coord <- project(cbind(lbl.Y$lon, lbl.Y$lat), proj=PROJ)
lbl.Y.prj <- cbind(prj.coord, lbl.Y)
names(lbl.Y.prj)[1:2] <- c("X.prj","Y.prj")

prj.coord <- project(cbind(lbl.X$lon, lbl.X$lat), proj=PROJ)
lbl.X.prj <- cbind(prj.coord, lbl.X)
names(lbl.X.prj)[1:2] <- c("X.prj","Y.prj")

m <- ggplot() +
  # add Natural Earth countries projected to Robinson, give black border
and fill with gray
  geom_polygon(data=NE_countries_rob, aes(long,lat, group=group),
colour="black", fill="gray80", size = 0.25) +
  # Note: "Regions defined for each Polygons" warning has to do with
fortify transformation. Might get deprecated in future!
  # alternatively, use use map_data(NE_countries) to transform to data
frame and then use project() to change to desired projection.
  # add Natural Earth box projected to Robinson
  geom_polygon(data=NE_box_rob, aes(x=long, y=lat), colour="black",
fill="transparent", size = 0.25) +
  # add graticules projected to Robinson
  geom_path(data=NE_graticules_rob, aes(long, lat, group=group),
linetype="dotted", color="grey50", size = 0.25) +
  # add graticule labels - latitude and longitude
  geom_text(data = lbl.Y.prj, aes(x = X.prj, y = Y.prj, label = lbl),
color="grey50", size=2) +
  geom_text(data = lbl.X.prj, aes(x = X.prj, y = Y.prj, label = lbl),
color="grey50", size=2) +
  # the default, ratio = 1 in coord_fixed ensures that one unit on the
x-axis is the same length as one unit on the y-axis
  coord_fixed(ratio = 1) +
  geom_point(data=df,
             aes(x=lon, y=lat), colour="Deep Pink",
             fill="Pink",pch=21, size=2, alpha=I(0.7))
  # remove the background and default gridlines
  theme_void()

## coordinates dataframe
dput(df)
structure(list(lon = c(2.67569724621467, 17.5766416259819,
28.4126232192772,
23.8147674538232, 29.8917589327105), lat = c(28.1503115976162,
-12.3388787380201, 9.78891068739477, -22.1873831176644, -3.36546931479253
)), class = "data.frame", row.names = c(NA, -5L))

Sincerely,

Milu

	[[alternative HTML version deleted]]


From Roger@B|v@nd @end|ng |rom nhh@no  Mon Feb 18 10:17:43 2019
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Mon, 18 Feb 2019 10:17:43 +0100
Subject: [R-sig-Geo] Plot coordinates on world map with Robinson CRS -
 ggplot2
In-Reply-To: <CAMLwc7NZyf52=+BT2P4jq7b=j6V39cuxVLiR07=UZshPAtRmiQ@mail.gmail.com>
References: <CAMLwc7NZyf52=+BT2P4jq7b=j6V39cuxVLiR07=UZshPAtRmiQ@mail.gmail.com>
Message-ID: <alpine.LFD.2.21.1902181015210.14056@reclus.nhh.no>

On Mon, 18 Feb 2019, Miluji Sb wrote:

> Dear all,
>
> I am trying to plot coordinates on a world map with Robinson CRS. While the
> world map is generated without any issues, when I try to plot the points -
> I only get a single point.

Well, the point is correct, since you didn't project df, did you? This 
seems to be typical of the arcane nature of ggplot invocations. Did you 
try tmap? Almost all the loaded&attached packages are superfluous too.

Roger

>
> The code I am using and the coordinates data is below. What am I doing
> wrong? Any help/suggestions will be highly appreciated.
>
> library(data.table)
> library(foreign)
> library(readstata13)
> library(rgdal)
> library(maptools)
> library(ggplot2)
> library(dplyr)
>
> load(url("
> https://github.com/valentinitnelav/RandomScripts/blob/master/NaturalEarth.RData?raw=true
> "))
>
> PROJ <- "+proj=robin +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84
> +units=m +no_defs"
>
> NE_countries_rob  <- spTransform(NE_countries, CRSobj = PROJ)
> NE_graticules_rob <- spTransform(NE_graticules, CRSobj = PROJ)
> NE_box_rob        <- spTransform(NE_box, CRSobj = PROJ)
>
> # project long-lat coordinates for graticule label data frames
> # (two extra columns with projected XY are created)
> prj.coord <- project(cbind(lbl.Y$lon, lbl.Y$lat), proj=PROJ)
> lbl.Y.prj <- cbind(prj.coord, lbl.Y)
> names(lbl.Y.prj)[1:2] <- c("X.prj","Y.prj")
>
> prj.coord <- project(cbind(lbl.X$lon, lbl.X$lat), proj=PROJ)
> lbl.X.prj <- cbind(prj.coord, lbl.X)
> names(lbl.X.prj)[1:2] <- c("X.prj","Y.prj")
>
> m <- ggplot() +
>  # add Natural Earth countries projected to Robinson, give black border
> and fill with gray
>  geom_polygon(data=NE_countries_rob, aes(long,lat, group=group),
> colour="black", fill="gray80", size = 0.25) +
>  # Note: "Regions defined for each Polygons" warning has to do with
> fortify transformation. Might get deprecated in future!
>  # alternatively, use use map_data(NE_countries) to transform to data
> frame and then use project() to change to desired projection.
>  # add Natural Earth box projected to Robinson
>  geom_polygon(data=NE_box_rob, aes(x=long, y=lat), colour="black",
> fill="transparent", size = 0.25) +
>  # add graticules projected to Robinson
>  geom_path(data=NE_graticules_rob, aes(long, lat, group=group),
> linetype="dotted", color="grey50", size = 0.25) +
>  # add graticule labels - latitude and longitude
>  geom_text(data = lbl.Y.prj, aes(x = X.prj, y = Y.prj, label = lbl),
> color="grey50", size=2) +
>  geom_text(data = lbl.X.prj, aes(x = X.prj, y = Y.prj, label = lbl),
> color="grey50", size=2) +
>  # the default, ratio = 1 in coord_fixed ensures that one unit on the
> x-axis is the same length as one unit on the y-axis
>  coord_fixed(ratio = 1) +
>  geom_point(data=df,
>             aes(x=lon, y=lat), colour="Deep Pink",
>             fill="Pink",pch=21, size=2, alpha=I(0.7))
>  # remove the background and default gridlines
>  theme_void()
>
> ## coordinates dataframe
> dput(df)
> structure(list(lon = c(2.67569724621467, 17.5766416259819,
> 28.4126232192772,
> 23.8147674538232, 29.8917589327105), lat = c(28.1503115976162,
> -12.3388787380201, 9.78891068739477, -22.1873831176644, -3.36546931479253
> )), class = "data.frame", row.names = c(NA, -5L))
>
> Sincerely,
>
> Milu
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From md@umner @end|ng |rom gm@||@com  Mon Feb 18 11:00:59 2019
From: md@umner @end|ng |rom gm@||@com (Michael Sumner)
Date: Mon, 18 Feb 2019 21:00:59 +1100
Subject: [R-sig-Geo] Plot coordinates on world map with Robinson CRS -
 ggplot2
In-Reply-To: <CAMLwc7NZyf52=+BT2P4jq7b=j6V39cuxVLiR07=UZshPAtRmiQ@mail.gmail.com>
References: <CAMLwc7NZyf52=+BT2P4jq7b=j6V39cuxVLiR07=UZshPAtRmiQ@mail.gmail.com>
Message-ID: <CAAcGz9_Nyf7iD8_ULBm5ATPjqiHhimukPxo5vVi1ZGN2ZH8vNg@mail.gmail.com>

You are very close, just needed the expert-knowledge for the incantation
required to transform the longlat points (as was already done for the
prj.coord, btw).

HTH: https://gist.github.com/mdsumner/afd9228aa1dc4652f8bf193cad4245aa

It does come as a surprise to many that R's plotting is not unit or
projection aware (well, it is sometimes, but not usually ... a modern
example is ggplot2::geom_sf  and the sf package but you need quite a lot of
prior-won expertise there too, good luck).

Cheers, Mike.

On Mon, 18 Feb 2019 at 20:01 Miluji Sb <milujisb at gmail.com> wrote:

> Dear all,
>
> I am trying to plot coordinates on a world map with Robinson CRS. While the
> world map is generated without any issues, when I try to plot the points -
> I only get a single point.
>
> The code I am using and the coordinates data is below. What am I doing
> wrong? Any help/suggestions will be highly appreciated.
>
> library(data.table)
> library(foreign)
> library(readstata13)
> library(rgdal)
> library(maptools)
> library(ggplot2)
> library(dplyr)
>
> load(url("
>
> https://github.com/valentinitnelav/RandomScripts/blob/master/NaturalEarth.RData?raw=true
> "))
>
> PROJ <- "+proj=robin +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84
> +units=m +no_defs"
>
> NE_countries_rob  <- spTransform(NE_countries, CRSobj = PROJ)
> NE_graticules_rob <- spTransform(NE_graticules, CRSobj = PROJ)
> NE_box_rob        <- spTransform(NE_box, CRSobj = PROJ)
>
> # project long-lat coordinates for graticule label data frames
> # (two extra columns with projected XY are created)
> prj.coord <- project(cbind(lbl.Y$lon, lbl.Y$lat), proj=PROJ)
> lbl.Y.prj <- cbind(prj.coord, lbl.Y)
> names(lbl.Y.prj)[1:2] <- c("X.prj","Y.prj")
>
> prj.coord <- project(cbind(lbl.X$lon, lbl.X$lat), proj=PROJ)
> lbl.X.prj <- cbind(prj.coord, lbl.X)
> names(lbl.X.prj)[1:2] <- c("X.prj","Y.prj")
>
> m <- ggplot() +
>   # add Natural Earth countries projected to Robinson, give black border
> and fill with gray
>   geom_polygon(data=NE_countries_rob, aes(long,lat, group=group),
> colour="black", fill="gray80", size = 0.25) +
>   # Note: "Regions defined for each Polygons" warning has to do with
> fortify transformation. Might get deprecated in future!
>   # alternatively, use use map_data(NE_countries) to transform to data
> frame and then use project() to change to desired projection.
>   # add Natural Earth box projected to Robinson
>   geom_polygon(data=NE_box_rob, aes(x=long, y=lat), colour="black",
> fill="transparent", size = 0.25) +
>   # add graticules projected to Robinson
>   geom_path(data=NE_graticules_rob, aes(long, lat, group=group),
> linetype="dotted", color="grey50", size = 0.25) +
>   # add graticule labels - latitude and longitude
>   geom_text(data = lbl.Y.prj, aes(x = X.prj, y = Y.prj, label = lbl),
> color="grey50", size=2) +
>   geom_text(data = lbl.X.prj, aes(x = X.prj, y = Y.prj, label = lbl),
> color="grey50", size=2) +
>   # the default, ratio = 1 in coord_fixed ensures that one unit on the
> x-axis is the same length as one unit on the y-axis
>   coord_fixed(ratio = 1) +
>   geom_point(data=df,
>              aes(x=lon, y=lat), colour="Deep Pink",
>              fill="Pink",pch=21, size=2, alpha=I(0.7))
>   # remove the background and default gridlines
>   theme_void()
>
> ## coordinates dataframe
> dput(df)
> structure(list(lon = c(2.67569724621467, 17.5766416259819,
> 28.4126232192772,
> 23.8147674538232, 29.8917589327105), lat = c(28.1503115976162,
> -12.3388787380201, 9.78891068739477, -22.1873831176644, -3.36546931479253
> )), class = "data.frame", row.names = c(NA, -5L))
>
> Sincerely,
>
> Milu
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
-- 
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia

	[[alternative HTML version deleted]]


From m||uj|@b @end|ng |rom gm@||@com  Mon Feb 18 12:43:23 2019
From: m||uj|@b @end|ng |rom gm@||@com (Miluji Sb)
Date: Mon, 18 Feb 2019 12:43:23 +0100
Subject: [R-sig-Geo] Plot coordinates on world map with Robinson CRS -
 ggplot2
In-Reply-To: <CAAcGz9_Nyf7iD8_ULBm5ATPjqiHhimukPxo5vVi1ZGN2ZH8vNg@mail.gmail.com>
References: <CAMLwc7NZyf52=+BT2P4jq7b=j6V39cuxVLiR07=UZshPAtRmiQ@mail.gmail.com>
 <CAAcGz9_Nyf7iD8_ULBm5ATPjqiHhimukPxo5vVi1ZGN2ZH8vNg@mail.gmail.com>
Message-ID: <CAMLwc7Nezph1h6HWVXURS_-Z2XD5qnqcY4At7Vm=b++ERmwk6g@mail.gmail.com>

Thank you very much. This works perfectly. Appreciate it.

Sincerely,

Milu

On Mon, Feb 18, 2019 at 11:01 AM Michael Sumner <mdsumner at gmail.com> wrote:

> You are very close, just needed the expert-knowledge for the incantation
> required to transform the longlat points (as was already done for the
> prj.coord, btw).
>
> HTH: https://gist.github.com/mdsumner/afd9228aa1dc4652f8bf193cad4245aa
>
> It does come as a surprise to many that R's plotting is not unit or
> projection aware (well, it is sometimes, but not usually ... a modern
> example is ggplot2::geom_sf  and the sf package but you need quite a lot of
> prior-won expertise there too, good luck).
>
> Cheers, Mike.
>
> On Mon, 18 Feb 2019 at 20:01 Miluji Sb <milujisb at gmail.com> wrote:
>
>> Dear all,
>>
>> I am trying to plot coordinates on a world map with Robinson CRS. While
>> the
>> world map is generated without any issues, when I try to plot the points -
>> I only get a single point.
>>
>> The code I am using and the coordinates data is below. What am I doing
>> wrong? Any help/suggestions will be highly appreciated.
>>
>> library(data.table)
>> library(foreign)
>> library(readstata13)
>> library(rgdal)
>> library(maptools)
>> library(ggplot2)
>> library(dplyr)
>>
>> load(url("
>>
>> https://github.com/valentinitnelav/RandomScripts/blob/master/NaturalEarth.RData?raw=true
>> "))
>>
>> PROJ <- "+proj=robin +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84
>> +units=m +no_defs"
>>
>> NE_countries_rob  <- spTransform(NE_countries, CRSobj = PROJ)
>> NE_graticules_rob <- spTransform(NE_graticules, CRSobj = PROJ)
>> NE_box_rob        <- spTransform(NE_box, CRSobj = PROJ)
>>
>> # project long-lat coordinates for graticule label data frames
>> # (two extra columns with projected XY are created)
>> prj.coord <- project(cbind(lbl.Y$lon, lbl.Y$lat), proj=PROJ)
>> lbl.Y.prj <- cbind(prj.coord, lbl.Y)
>> names(lbl.Y.prj)[1:2] <- c("X.prj","Y.prj")
>>
>> prj.coord <- project(cbind(lbl.X$lon, lbl.X$lat), proj=PROJ)
>> lbl.X.prj <- cbind(prj.coord, lbl.X)
>> names(lbl.X.prj)[1:2] <- c("X.prj","Y.prj")
>>
>> m <- ggplot() +
>>   # add Natural Earth countries projected to Robinson, give black border
>> and fill with gray
>>   geom_polygon(data=NE_countries_rob, aes(long,lat, group=group),
>> colour="black", fill="gray80", size = 0.25) +
>>   # Note: "Regions defined for each Polygons" warning has to do with
>> fortify transformation. Might get deprecated in future!
>>   # alternatively, use use map_data(NE_countries) to transform to data
>> frame and then use project() to change to desired projection.
>>   # add Natural Earth box projected to Robinson
>>   geom_polygon(data=NE_box_rob, aes(x=long, y=lat), colour="black",
>> fill="transparent", size = 0.25) +
>>   # add graticules projected to Robinson
>>   geom_path(data=NE_graticules_rob, aes(long, lat, group=group),
>> linetype="dotted", color="grey50", size = 0.25) +
>>   # add graticule labels - latitude and longitude
>>   geom_text(data = lbl.Y.prj, aes(x = X.prj, y = Y.prj, label = lbl),
>> color="grey50", size=2) +
>>   geom_text(data = lbl.X.prj, aes(x = X.prj, y = Y.prj, label = lbl),
>> color="grey50", size=2) +
>>   # the default, ratio = 1 in coord_fixed ensures that one unit on the
>> x-axis is the same length as one unit on the y-axis
>>   coord_fixed(ratio = 1) +
>>   geom_point(data=df,
>>              aes(x=lon, y=lat), colour="Deep Pink",
>>              fill="Pink",pch=21, size=2, alpha=I(0.7))
>>   # remove the background and default gridlines
>>   theme_void()
>>
>> ## coordinates dataframe
>> dput(df)
>> structure(list(lon = c(2.67569724621467, 17.5766416259819,
>> 28.4126232192772,
>> 23.8147674538232, 29.8917589327105), lat = c(28.1503115976162,
>> -12.3388787380201, 9.78891068739477, -22.1873831176644, -3.36546931479253
>> )), class = "data.frame", row.names = c(NA, -5L))
>>
>> Sincerely,
>>
>> Milu
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
> --
> Dr. Michael Sumner
> Software and Database Engineer
> Australian Antarctic Division
> 203 Channel Highway
> Kingston Tasmania 7050 Australia
>
>

	[[alternative HTML version deleted]]


From |@r@@@|p@@||v@ @end|ng |rom gm@||@com  Wed Feb 20 12:20:25 2019
From: |@r@@@|p@@||v@ @end|ng |rom gm@||@com (Lara Silva)
Date: Wed, 20 Feb 2019 10:20:25 -0100
Subject: [R-sig-Geo] Problem in generate random samples in r
Message-ID: <CALN9TETFnW5-TWzu0xL5jWnof7hFXW1Mp2Lm_+WD=JOKvnEygQ@mail.gmail.com>

Hello,

I am trying to generate random samples from the following code

### Setting random seed to always create the same
### Random set of points
set.seed(0)

absences_15000<-absences[sample(nrow(absences), 15000),]
points(absences_15000, cex=0.1)

## Subsample_10000
set.seed(0)

absences_10000<-absences_15000[sample(nrow(absences_15000), 10000),]
dim(absences_10000)

I get the following error:

Error in sample.int(length(x), size, replace, prob) :
  cannot take a sample larger than the population when 'replace = FALSE'

Any advice?

Regards,

Lara

	[[alternative HTML version deleted]]


From |@r@@@|p@@||v@ @end|ng |rom gm@||@com  Wed Feb 20 12:29:15 2019
From: |@r@@@|p@@||v@ @end|ng |rom gm@||@com (Lara Silva)
Date: Wed, 20 Feb 2019 10:29:15 -0100
Subject: [R-sig-Geo] [R-sig-eco] Problem in generate random samples in r
In-Reply-To: <4BECCA16-5A9E-4ED0-BEB0-AF040DA7FE60@gmail.com>
References: <CALN9TETFnW5-TWzu0xL5jWnof7hFXW1Mp2Lm_+WD=JOKvnEygQ@mail.gmail.com>
 <4BECCA16-5A9E-4ED0-BEB0-AF040DA7FE60@gmail.com>
Message-ID: <CALN9TETY6pVTgJ3DcX031Q-6hwfVbKDGvp3iRc8wuNzTzG0s4w@mail.gmail.com>

Thanks!

Lara

Henrik Eckermann <henrik.eckermann87 at gmail.com> escreveu no dia quarta,
20/02/2019 ?(s) 10:25:

> Hi Lara,
>
> the error is quite informative. You use the sample function twice. At
> least for one the length of the vector where you sample from is shorter
> (contains less values) than than the number of samples you wanna draw.
>
> best,
>
> Henrik
>
> > On 20. Feb 2019, at 12:20, Lara Silva <lara.sfp.silva at gmail.com> wrote:
> >
> > Hello,
> >
> > I am trying to generate random samples from the following code
> >
> > ### Setting random seed to always create the same
> > ### Random set of points
> > set.seed(0)
> >
> > absences_15000<-absences[sample(nrow(absences), 15000),]
> > points(absences_15000, cex=0.1)
> >
> > ## Subsample_10000
> > set.seed(0)
> >
> > absences_10000<-absences_15000[sample(nrow(absences_15000), 10000),]
> > dim(absences_10000)
> >
> > I get the following error:
> >
> > Error in sample.int(length(x), size, replace, prob) :
> >  cannot take a sample larger than the population when 'replace = FALSE'
> >
> > Any advice?
> >
> > Regards,
> >
> > Lara
> >
> >       [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-ecology mailing list
> > R-sig-ecology at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-ecology
>
>

	[[alternative HTML version deleted]]


From rom@n@|u@tr|k @end|ng |rom gm@||@com  Wed Feb 20 12:28:46 2019
From: rom@n@|u@tr|k @end|ng |rom gm@||@com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Wed, 20 Feb 2019 12:28:46 +0100
Subject: [R-sig-Geo] [R-sig-eco] Problem in generate random samples in r
In-Reply-To: <CALN9TETFnW5-TWzu0xL5jWnof7hFXW1Mp2Lm_+WD=JOKvnEygQ@mail.gmail.com>
References: <CALN9TETFnW5-TWzu0xL5jWnof7hFXW1Mp2Lm_+WD=JOKvnEygQ@mail.gmail.com>
Message-ID: <CAHT1vpgaeNOnnvscy8b=ztMBuv76oQ=j4pF6ZciKoUb8_rPfJA@mail.gmail.com>

My guess would be that absences_150000 doesn't have 10000 rows. Can you
confirm or refute this?

Cheers,
Roman

On Wed, Feb 20, 2019 at 12:20 PM Lara Silva <lara.sfp.silva at gmail.com>
wrote:

> Hello,
>
> I am trying to generate random samples from the following code
>
> ### Setting random seed to always create the same
> ### Random set of points
> set.seed(0)
>
> absences_15000<-absences[sample(nrow(absences), 15000),]
> points(absences_15000, cex=0.1)
>
> ## Subsample_10000
> set.seed(0)
>
> absences_10000<-absences_15000[sample(nrow(absences_15000), 10000),]
> dim(absences_10000)
>
> I get the following error:
>
> Error in sample.int(length(x), size, replace, prob) :
>   cannot take a sample larger than the population when 'replace = FALSE'
>
> Any advice?
>
> Regards,
>
> Lara
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-ecology mailing list
> R-sig-ecology at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-ecology
>


-- 
In God we trust, all others bring data.

	[[alternative HTML version deleted]]


From m@h@@@@met|1384 @end|ng |rom gm@||@com  Thu Feb 21 07:02:48 2019
From: m@h@@@@met|1384 @end|ng |rom gm@||@com (Mahsa Sameti)
Date: Thu, 21 Feb 2019 09:32:48 +0330
Subject: [R-sig-Geo] Reverse color in stplot
Message-ID: <CADN=v_w3sYyMaeoE5B4spgprTaxOKWfy4ZWS+HMkRQqQxHqTHw@mail.gmail.com>

Dear all

I want to reverse color in my spatio-temporal maps that are created with
stplot function. How can i solve this problem?

Thanks alot
Mahsa Sameti

	[[alternative HTML version deleted]]


From edzer@pebe@m@ @end|ng |rom un|-muen@ter@de  Thu Feb 21 08:45:04 2019
From: edzer@pebe@m@ @end|ng |rom un|-muen@ter@de (Edzer Pebesma)
Date: Thu, 21 Feb 2019 08:45:04 +0100
Subject: [R-sig-Geo] Reverse color in stplot
In-Reply-To: <CADN=v_w3sYyMaeoE5B4spgprTaxOKWfy4ZWS+HMkRQqQxHqTHw@mail.gmail.com>
References: <CADN=v_w3sYyMaeoE5B4spgprTaxOKWfy4ZWS+HMkRQqQxHqTHw@mail.gmail.com>
Message-ID: <dce0b4cb-0192-a587-4c7f-58e5b5f9404f@uni-muenster.de>

I think that it accepts an argument col.regions where you specify a
color palette; if you have a particular one, called pal, and want to
revert it, use rev(pal).

On 2/21/19 7:02 AM, Mahsa Sameti wrote:
> Dear all
> 
> I want to reverse color in my spatio-temporal maps that are created with
> stplot function. How can i solve this problem?
> 
> Thanks alot
> Mahsa Sameti
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48151 Muenster, Germany
Phone: +49 251 8333081

-------------- next part --------------
A non-text attachment was scrubbed...
Name: pEpkey.asc
Type: application/pgp-keys
Size: 2472 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20190221/0dbd2964/attachment.bin>

From |@r@@@|p@@||v@ @end|ng |rom gm@||@com  Thu Feb 21 13:29:24 2019
From: |@r@@@|p@@||v@ @end|ng |rom gm@||@com (Lara Silva)
Date: Thu, 21 Feb 2019 11:29:24 -0100
Subject: [R-sig-Geo] Use rbind for more than two data frame
Message-ID: <CALN9TETwfyZitXOTaBgFjOSjtYKO9PPxDr34FKMjnxCU1C+3_g@mail.gmail.com>

Hello,

I am trying to join different data frames using rbind but I have the
following mensage:

sdmata_global <-
rbind(sdmdata_SM,sdmdata_P,sdmdata_T,sdmdata_F,sdmdata_SJ)

Error in match.names(clabs, names(xi)) :
names do not match previous names

> class(sdmdata_SM)
[1] "data.frame"
> class(sdmdata_P)
[1] "data.frame"
> class(sdmdata_T)
[1] "data.frame"
> class(sdmdata_F)
[1] "data.frame"
> class(sdmdata_SJ)
[1] "data.frame"
> dim(sdmdata_SM)
[1] 10003    22
> dim(sdmdata_P)
[1] 10005    22
> dim(sdmdata_T)
[1] 10004    22
> dim(sdmdata_F)
[1] 10001    22
> dim(sdmdata_SJ)
[1] 10001    22


> dim(sdmdata_SM)
[1] 10003    22
> dim(sdmdata_SM)
[1] 10003    22
> dim(sdmdata_P)
[1] 10005    22
> dim(sdmdata_T)
[1] 10004    22
> dim(sdmdata_F)
[1] 10001    22
> dim(sdmdata_SJ)
[1] 10001    22
>

> names(sdmdata_SM)
 [1] "pb"    "bio1"  "bio10" "bio11" "bio12" "bio13" "bio14" "bio15" "bio16"
[10] "bio17" "bio18" "bio19" "bio2"  "bio3"  "bio4"  "bio4a" "bio5"  "bio6"
[19] "bio7"  "bio8"  "bio9"  "code"
> names(sdmdata_P)
 [1] "pb"    "bio1"  "bio10" "bio11" "bio12" "bio13" "bio14" "bio15" "bio16"
[10] "bio17" "bio18" "bio19" "bio2"  "bio3"  "bio4"  "bio4a" "bio5"  "bio6"
[19] "bio7"  "bio8"  "bio9"  "code"
> names(sdmdata_T)
 [1] "pb"    "bio1"  "bio10" "bio11" "bio12" "bio13" "bio14" "bio15" "bio16"
[10] "bio17" "bio18" "bio19" "bio2"  "bio3"  "bio4"  "bio4a" "bio5"  "bio6"
[19] "bio7"  "bio8"  "bio9"  "code"
> names(sdmdata_F)
 [1] "pb"       "bio1"     "bio10"    "bio11"    "bio12"    "bio13"
 [7] "bio14"    "bio15_FP" "bio16"    "bio17"    "bio18"    "bio19"
[13] "bio2"     "bio3"     "bio4"     "bio4a"    "bio5"     "bio6"
[19] "bio7"     "bio8"     "bio9"     "code"
> names(sdmdata_SJ)
 [1] "pb"    "bio1"  "bio10" "bio11" "bio12" "bio13" "bio14" "bio15" "bio16"
[10] "bio17" "bio18" "bio19" "bio2"  "bio3"  "bio4"  "bio4a" "bio5"  "bio6"
[19] "bio7"  "bio8"  "bio9"  "code"
>

Any suggestion?

Thanks!

Lara

	[[alternative HTML version deleted]]


From |@r@@@|p@@||v@ @end|ng |rom gm@||@com  Thu Feb 21 13:34:30 2019
From: |@r@@@|p@@||v@ @end|ng |rom gm@||@com (Lara Silva)
Date: Thu, 21 Feb 2019 11:34:30 -0100
Subject: [R-sig-Geo] [R-sig-eco] Use rbind for more than two data frame
In-Reply-To: <761DB032-C91C-4500-A190-D2C9BEAC4432@gmail.com>
References: <CALN9TETwfyZitXOTaBgFjOSjtYKO9PPxDr34FKMjnxCU1C+3_g@mail.gmail.com>
 <761DB032-C91C-4500-A190-D2C9BEAC4432@gmail.com>
Message-ID: <CALN9TESNpd0WmSVWwtNn4s9tJsv1XviXMo9xCa2JkcNMk_ET=g@mail.gmail.com>

Thanks for the advice!

Mollie Brooks <mollieebrooks at gmail.com> escreveu no dia quinta, 21/02/2019
?(s) 11:31:

> Try changing  "bio15_FP" to  "bio15" so that the names match.
>
>
> On 21Feb 2019, at 13:29, Lara Silva <lara.sfp.silva at gmail.com> wrote:
>
> Hello,
>
> I am trying to join different data frames using rbind but I have the
> following mensage:
>
> sdmata_global <-
> rbind(sdmdata_SM,sdmdata_P,sdmdata_T,sdmdata_F,sdmdata_SJ)
>
> Error in match.names(clabs, names(xi)) :
> names do not match previous names
>
> class(sdmdata_SM)
>
> [1] "data.frame"
>
> class(sdmdata_P)
>
> [1] "data.frame"
>
> class(sdmdata_T)
>
> [1] "data.frame"
>
> class(sdmdata_F)
>
> [1] "data.frame"
>
> class(sdmdata_SJ)
>
> [1] "data.frame"
>
> dim(sdmdata_SM)
>
> [1] 10003    22
>
> dim(sdmdata_P)
>
> [1] 10005    22
>
> dim(sdmdata_T)
>
> [1] 10004    22
>
> dim(sdmdata_F)
>
> [1] 10001    22
>
> dim(sdmdata_SJ)
>
> [1] 10001    22
>
>
> dim(sdmdata_SM)
>
> [1] 10003    22
>
> dim(sdmdata_SM)
>
> [1] 10003    22
>
> dim(sdmdata_P)
>
> [1] 10005    22
>
> dim(sdmdata_T)
>
> [1] 10004    22
>
> dim(sdmdata_F)
>
> [1] 10001    22
>
> dim(sdmdata_SJ)
>
> [1] 10001    22
>
>
>
> names(sdmdata_SM)
>
> [1] "pb"    "bio1"  "bio10" "bio11" "bio12" "bio13" "bio14" "bio15" "bio16"
> [10] "bio17" "bio18" "bio19" "bio2"  "bio3"  "bio4"  "bio4a" "bio5"  "bio6"
> [19] "bio7"  "bio8"  "bio9"  "code"
>
> names(sdmdata_P)
>
> [1] "pb"    "bio1"  "bio10" "bio11" "bio12" "bio13" "bio14" "bio15" "bio16"
> [10] "bio17" "bio18" "bio19" "bio2"  "bio3"  "bio4"  "bio4a" "bio5"  "bio6"
> [19] "bio7"  "bio8"  "bio9"  "code"
>
> names(sdmdata_T)
>
> [1] "pb"    "bio1"  "bio10" "bio11" "bio12" "bio13" "bio14" "bio15" "bio16"
> [10] "bio17" "bio18" "bio19" "bio2"  "bio3"  "bio4"  "bio4a" "bio5"  "bio6"
> [19] "bio7"  "bio8"  "bio9"  "code"
>
> names(sdmdata_F)
>
> [1] "pb"       "bio1"     "bio10"    "bio11"    "bio12"    "bio13"
> [7] "bio14"    "bio15_FP" "bio16"    "bio17"    "bio18"    "bio19"
> [13] "bio2"     "bio3"     "bio4"     "bio4a"    "bio5"     "bio6"
> [19] "bio7"     "bio8"     "bio9"     "code"
>
> names(sdmdata_SJ)
>
> [1] "pb"    "bio1"  "bio10" "bio11" "bio12" "bio13" "bio14" "bio15" "bio16"
> [10] "bio17" "bio18" "bio19" "bio2"  "bio3"  "bio4"  "bio4a" "bio5"  "bio6"
> [19] "bio7"  "bio8"  "bio9"  "code"
>
>
>
> Any suggestion?
>
> Thanks!
>
> Lara
>
> [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-ecology mailing list
> R-sig-ecology at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-ecology
>
>
>

	[[alternative HTML version deleted]]


From peter@v@nhor@@en @end|ng |rom wx@@n|  Thu Feb 21 13:37:48 2019
From: peter@v@nhor@@en @end|ng |rom wx@@n| (Peter van Horssen)
Date: Thu, 21 Feb 2019 13:37:48 +0100
Subject: [R-sig-Geo] Use rbind for more than two data frame
In-Reply-To: <CALN9TETwfyZitXOTaBgFjOSjtYKO9PPxDr34FKMjnxCU1C+3_g@mail.gmail.com>
References: <CALN9TETwfyZitXOTaBgFjOSjtYKO9PPxDr34FKMjnxCU1C+3_g@mail.gmail.com>
Message-ID: <d1be3785-0da3-c93c-8175-c1fca25efd98@wxs.nl>

Yes,

alter columname ? "bio15_FP" to "bio15" in? table 'sdmdata_F'

:-)

greetings? Peter


Op 21-2-2019 om 13:29 schreef Lara Silva:
> Hello,
>
> I am trying to join different data frames using rbind but I have the
> following mensage:
>
> sdmata_global <-
> rbind(sdmdata_SM,sdmdata_P,sdmdata_T,sdmdata_F,sdmdata_SJ)
>
> Error in match.names(clabs, names(xi)) :
> names do not match previous names
>
>> class(sdmdata_SM)
> [1] "data.frame"
>> class(sdmdata_P)
> [1] "data.frame"
>> class(sdmdata_T)
> [1] "data.frame"
>> class(sdmdata_F)
> [1] "data.frame"
>> class(sdmdata_SJ)
> [1] "data.frame"
>> dim(sdmdata_SM)
> [1] 10003    22
>> dim(sdmdata_P)
> [1] 10005    22
>> dim(sdmdata_T)
> [1] 10004    22
>> dim(sdmdata_F)
> [1] 10001    22
>> dim(sdmdata_SJ)
> [1] 10001    22
>
>
>> dim(sdmdata_SM)
> [1] 10003    22
>> dim(sdmdata_SM)
> [1] 10003    22
>> dim(sdmdata_P)
> [1] 10005    22
>> dim(sdmdata_T)
> [1] 10004    22
>> dim(sdmdata_F)
> [1] 10001    22
>> dim(sdmdata_SJ)
> [1] 10001    22
>> names(sdmdata_SM)
>   [1] "pb"    "bio1"  "bio10" "bio11" "bio12" "bio13" "bio14" "bio15" "bio16"
> [10] "bio17" "bio18" "bio19" "bio2"  "bio3"  "bio4"  "bio4a" "bio5"  "bio6"
> [19] "bio7"  "bio8"  "bio9"  "code"
>> names(sdmdata_P)
>   [1] "pb"    "bio1"  "bio10" "bio11" "bio12" "bio13" "bio14" "bio15" "bio16"
> [10] "bio17" "bio18" "bio19" "bio2"  "bio3"  "bio4"  "bio4a" "bio5"  "bio6"
> [19] "bio7"  "bio8"  "bio9"  "code"
>> names(sdmdata_T)
>   [1] "pb"    "bio1"  "bio10" "bio11" "bio12" "bio13" "bio14" "bio15" "bio16"
> [10] "bio17" "bio18" "bio19" "bio2"  "bio3"  "bio4"  "bio4a" "bio5"  "bio6"
> [19] "bio7"  "bio8"  "bio9"  "code"
>> names(sdmdata_F)
>   [1] "pb"       "bio1"     "bio10"    "bio11"    "bio12"    "bio13"
>   [7] "bio14"    "bio15_FP" "bio16"    "bio17"    "bio18"    "bio19"
> [13] "bio2"     "bio3"     "bio4"     "bio4a"    "bio5"     "bio6"
> [19] "bio7"     "bio8"     "bio9"     "code"
>> names(sdmdata_SJ)
>   [1] "pb"    "bio1"  "bio10" "bio11" "bio12" "bio13" "bio14" "bio15" "bio16"
> [10] "bio17" "bio18" "bio19" "bio2"  "bio3"  "bio4"  "bio4a" "bio5"  "bio6"
> [19] "bio7"  "bio8"  "bio9"  "code"
> Any suggestion?
>
> Thanks!
>
> Lara
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From |@r@@@|p@@||v@ @end|ng |rom gm@||@com  Thu Feb 21 13:56:34 2019
From: |@r@@@|p@@||v@ @end|ng |rom gm@||@com (Lara Silva)
Date: Thu, 21 Feb 2019 11:56:34 -0100
Subject: [R-sig-Geo] Use rbind for more than two data frame
In-Reply-To: <d1be3785-0da3-c93c-8175-c1fca25efd98@wxs.nl>
References: <CALN9TETwfyZitXOTaBgFjOSjtYKO9PPxDr34FKMjnxCU1C+3_g@mail.gmail.com>
 <d1be3785-0da3-c93c-8175-c1fca25efd98@wxs.nl>
Message-ID: <CALN9TETbh1R7W2g2TUi5CV_mCeK+2s6w488-HQskyrA68x=zvA@mail.gmail.com>

Thank you!
Sorry for my silly doubt.

Peter van Horssen <peter.vanhorssen at wxs.nl> escreveu no dia quinta,
21/02/2019 ?(s) 11:39:

> Yes,
>
> alter columname   "bio15_FP" to "bio15" in  table 'sdmdata_F'
>
> :-)
>
> greetings  Peter
>
>
> Op 21-2-2019 om 13:29 schreef Lara Silva:
> > Hello,
> >
> > I am trying to join different data frames using rbind but I have the
> > following mensage:
> >
> > sdmata_global <-
> > rbind(sdmdata_SM,sdmdata_P,sdmdata_T,sdmdata_F,sdmdata_SJ)
> >
> > Error in match.names(clabs, names(xi)) :
> > names do not match previous names
> >
> >> class(sdmdata_SM)
> > [1] "data.frame"
> >> class(sdmdata_P)
> > [1] "data.frame"
> >> class(sdmdata_T)
> > [1] "data.frame"
> >> class(sdmdata_F)
> > [1] "data.frame"
> >> class(sdmdata_SJ)
> > [1] "data.frame"
> >> dim(sdmdata_SM)
> > [1] 10003    22
> >> dim(sdmdata_P)
> > [1] 10005    22
> >> dim(sdmdata_T)
> > [1] 10004    22
> >> dim(sdmdata_F)
> > [1] 10001    22
> >> dim(sdmdata_SJ)
> > [1] 10001    22
> >
> >
> >> dim(sdmdata_SM)
> > [1] 10003    22
> >> dim(sdmdata_SM)
> > [1] 10003    22
> >> dim(sdmdata_P)
> > [1] 10005    22
> >> dim(sdmdata_T)
> > [1] 10004    22
> >> dim(sdmdata_F)
> > [1] 10001    22
> >> dim(sdmdata_SJ)
> > [1] 10001    22
> >> names(sdmdata_SM)
> >   [1] "pb"    "bio1"  "bio10" "bio11" "bio12" "bio13" "bio14" "bio15"
> "bio16"
> > [10] "bio17" "bio18" "bio19" "bio2"  "bio3"  "bio4"  "bio4a" "bio5"
> "bio6"
> > [19] "bio7"  "bio8"  "bio9"  "code"
> >> names(sdmdata_P)
> >   [1] "pb"    "bio1"  "bio10" "bio11" "bio12" "bio13" "bio14" "bio15"
> "bio16"
> > [10] "bio17" "bio18" "bio19" "bio2"  "bio3"  "bio4"  "bio4a" "bio5"
> "bio6"
> > [19] "bio7"  "bio8"  "bio9"  "code"
> >> names(sdmdata_T)
> >   [1] "pb"    "bio1"  "bio10" "bio11" "bio12" "bio13" "bio14" "bio15"
> "bio16"
> > [10] "bio17" "bio18" "bio19" "bio2"  "bio3"  "bio4"  "bio4a" "bio5"
> "bio6"
> > [19] "bio7"  "bio8"  "bio9"  "code"
> >> names(sdmdata_F)
> >   [1] "pb"       "bio1"     "bio10"    "bio11"    "bio12"    "bio13"
> >   [7] "bio14"    "bio15_FP" "bio16"    "bio17"    "bio18"    "bio19"
> > [13] "bio2"     "bio3"     "bio4"     "bio4a"    "bio5"     "bio6"
> > [19] "bio7"     "bio8"     "bio9"     "code"
> >> names(sdmdata_SJ)
> >   [1] "pb"    "bio1"  "bio10" "bio11" "bio12" "bio13" "bio14" "bio15"
> "bio16"
> > [10] "bio17" "bio18" "bio19" "bio2"  "bio3"  "bio4"  "bio4a" "bio5"
> "bio6"
> > [19] "bio7"  "bio8"  "bio9"  "code"
> > Any suggestion?
> >
> > Thanks!
> >
> > Lara
> >
> >       [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From i-c-b m@iii@g oii web@de  Fri Feb 22 13:37:52 2019
From: i-c-b m@iii@g oii web@de (i-c-b m@iii@g oii web@de)
Date: Fri, 22 Feb 2019 13:37:52 +0100
Subject: [R-sig-Geo] Geographically weighted regression
Message-ID: <trinity-85cb4a0d-c8d3-405f-b6c0-44e669ee17f2-1550839072949@3c-app-webde-bs50>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20190222/bcc18b4d/attachment.html>

From j@ck@onmrodr|gue@ @end|ng |rom gm@||@com  Fri Feb 22 15:59:49 2019
From: j@ck@onmrodr|gue@ @end|ng |rom gm@||@com (Jackson Rodrigues)
Date: Fri, 22 Feb 2019 11:59:49 -0300
Subject: [R-sig-Geo] create a raster time series with negative years (years
 Before Present)
Message-ID: <CAPL76w-D7p9bwBUh=NeebCXpFVVdZXzsqL6i_bc-2=p4Tk3rNQ@mail.gmail.com>

Hey guys,

I need some help to set a time serie (ts) to raster stack, however my
raster serie has negative ages (years Before Present (yrBP)).

I have tried several codes and packages unsuccessfully.

If succeed, I would like to apply seasonal and other calculations to my
new  raster time serie.

Below are some codes from package rts. I adapted years to negative value
only as a example.

#####
>path <- system.file("external", package="rts") # location of files
>lst <- list.files(path=path,pattern='.asc$',full.names=TRUE)
>lst # list of raster files
>r <- stack(lst) # creating a RasterStack object
>r
>d <- c("-2000-02-01","-2000-03-01","-2000-04-01","-2000-05-01") #
corresponding dates to 4 rasters
>d <- as.Date(d) # or d <- as.POSIXct(d)
Error in charToDate(x) :
  character string is not in a standard unambiguous format
>rt <- rts(r,d) # creating a RasterStackTS object
>rt
>plot(rt)
#########

best,

Jackson Rodrigues
--

	[[alternative HTML version deleted]]


From edzer@pebe@m@ @end|ng |rom un|-muen@ter@de  Fri Feb 22 16:12:07 2019
From: edzer@pebe@m@ @end|ng |rom un|-muen@ter@de (Edzer Pebesma)
Date: Fri, 22 Feb 2019 16:12:07 +0100
Subject: [R-sig-Geo] 
 create a raster time series with negative years (years
 Before Present)
In-Reply-To: <CAPL76w-D7p9bwBUh=NeebCXpFVVdZXzsqL6i_bc-2=p4Tk3rNQ@mail.gmail.com>
References: <CAPL76w-D7p9bwBUh=NeebCXpFVVdZXzsqL6i_bc-2=p4Tk3rNQ@mail.gmail.com>
Message-ID: <29bb0b7e-c144-8928-ca88-4fba46235539@uni-muenster.de>

See ?as.Date:

"Years before 1CE (aka 1AD) will probably not be handled correctly."

On 2/22/19 3:59 PM, Jackson Rodrigues wrote:
> Hey guys,
> 
> I need some help to set a time serie (ts) to raster stack, however my
> raster serie has negative ages (years Before Present (yrBP)).
> 
> I have tried several codes and packages unsuccessfully.
> 
> If succeed, I would like to apply seasonal and other calculations to my
> new  raster time serie.
> 
> Below are some codes from package rts. I adapted years to negative value
> only as a example.
> 
> #####
>> path <- system.file("external", package="rts") # location of files
>> lst <- list.files(path=path,pattern='.asc$',full.names=TRUE)
>> lst # list of raster files
>> r <- stack(lst) # creating a RasterStack object
>> r
>> d <- c("-2000-02-01","-2000-03-01","-2000-04-01","-2000-05-01") #
> corresponding dates to 4 rasters
>> d <- as.Date(d) # or d <- as.POSIXct(d)
> Error in charToDate(x) :
>   character string is not in a standard unambiguous format
>> rt <- rts(r,d) # creating a RasterStackTS object
>> rt
>> plot(rt)
> #########
> 
> best,
> 
> Jackson Rodrigues
> --
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48151 Muenster, Germany
Phone: +49 251 8333081

-------------- next part --------------
A non-text attachment was scrubbed...
Name: pEpkey.asc
Type: application/pgp-keys
Size: 2472 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20190222/5dd1d8f1/attachment.bin>

From @@r@h@go@|ee @end|ng |rom gm@||@com  Fri Feb 22 19:50:44 2019
From: @@r@h@go@|ee @end|ng |rom gm@||@com (Sarah Goslee)
Date: Fri, 22 Feb 2019 13:50:44 -0500
Subject: [R-sig-Geo] Geographically weighted regression
In-Reply-To: <trinity-85cb4a0d-c8d3-405f-b6c0-44e669ee17f2-1550839072949@3c-app-webde-bs50>
References: <trinity-85cb4a0d-c8d3-405f-b6c0-44e669ee17f2-1550839072949@3c-app-webde-bs50>
Message-ID: <CAM_vjuk-BcNwJT6YQBaawp1zoPyhqTquqOfoSHNu-4=h=Ki=4Q@mail.gmail.com>

The first step should be to look at

str(Daten90)
str(Daten10)

and if that doesn't solve the problem, then consider a reproducible
example, or at the very least posting the results of the above to this
list.

Sarah

On Fri, Feb 22, 2019 at 7:38 AM <f-c-b at web.de> wrote:
>
> Dear all,
>
> I am currently working out a geographically weighted regression, in which 90% of the data set the model should be calculated and for 10% of the values to be predicted. For the prediction I use the function gwr.predict from the package GWModel:
>
>  Erg<-gwr.predict(formula=Ziel~ as.factor(Var1) + log(Var2, base = exp(1)) + Var3, data = Daten90,predictdata = Daten10,bw = bwG, kernel = "gaussian",adaptive = FALSE, p = 2, theta = 0, longlat = FALSE)
>
> I always get this error, although Daten10 and Daten90 have the same structure:
> Error in gwr.predict(formula = Ziel~ as.factor(Var1) + log(Var2, base = exp(1)) + Var3, :
> All the independent variables should be included in the predictdata.
>
> Can you tell me what the problem with this code is?
> Or is there any other way for a GWR and the prediction?
>
> Thank you,
> Christoph
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Sarah Goslee (she/her)
http://www.numberwright.com


From bi@bi@iu m@iii@g oii whu@edu@c@  Sat Feb 23 08:22:24 2019
From: bi@bi@iu m@iii@g oii whu@edu@c@ (bi@bi@iu m@iii@g oii whu@edu@c@)
Date: Sat, 23 Feb 2019 15:22:24 +0800
Subject: [R-sig-Geo] Geographically weighted regression
References: <trinity-85cb4a0d-c8d3-405f-b6c0-44e669ee17f2-1550839072949@3c-app-webde-bs50>
Message-ID: <201902231522232652913@whu.edu.cn>

Hi,
The formula is wrongly specified, Ziel~ as.factor(Var1) + log(Var2, base = exp(1)) + Var3, use the corresponding var-names only.

As I understand, you want to do some calculations with the variables, and you can process them in the data frame before using it in this command, not in the formula.

Binbin




Dr Binbin Lu
Lecturer in School of Remote Sensing and Information Engineering, Wuhan University
Email: binbinlu at whu.edu.cn
 
From: f-c-b
Date: 2019-02-22 20:37
To: r-sig-geo
Subject: [R-sig-Geo] Geographically weighted regression
Dear all,
 
I am currently working out a geographically weighted regression, in which 90% of the data set the model should be calculated and for 10% of the values to be predicted. For the prediction I use the function gwr.predict from the package GWModel:

 Erg<-gwr.predict(formula=Ziel~ as.factor(Var1) + log(Var2, base = exp(1)) + Var3, data = Daten90,predictdata = Daten10,bw = bwG, kernel = "gaussian",adaptive = FALSE, p = 2, theta = 0, longlat = FALSE)

I always get this error, although Daten10 and Daten90 have the same structure:
Error in gwr.predict(formula = Ziel~ as.factor(Var1) + log(Var2, base = exp(1)) + Var3, :
All the independent variables should be included in the predictdata.
 
Can you tell me what the problem with this code is?
Or is there any other way for a GWR and the prediction?

Thank you,
Christoph

	[[alternative HTML version deleted]]


From Roger@B|v@nd @end|ng |rom nhh@no  Sat Feb 23 12:18:38 2019
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Sat, 23 Feb 2019 12:18:38 +0100
Subject: [R-sig-Geo] Geographically weighted regression
In-Reply-To: <201902231522232652913@whu.edu.cn>
References: <trinity-85cb4a0d-c8d3-405f-b6c0-44e669ee17f2-1550839072949@3c-app-webde-bs50>
 <201902231522232652913@whu.edu.cn>
Message-ID: <alpine.LFD.2.21.1902231215130.12749@reclus.nhh.no>

On Sat, 23 Feb 2019, binbinlu at whu.edu.cn wrote:

> Hi,

> The formula is wrongly specified, Ziel~ as.factor(Var1) + log(Var2, base 
> = exp(1)) + Var3, use the corresponding var-names only.
>
> As I understand, you want to do some calculations with the variables, 
> and you can process them in the data frame before using it in this 
> command, not in the formula.

Correct, not in the formula in the way that these functions handle the 
names made by formula() and model.matrix(). lm() and its prediction 
function do seem to handle them correctly, but it is very hard in more 
complicated fitting/prediction functions to get this right. Pre-compute 
the modified variables so that the package functions just see simple 
variables.

Roger

>
> Binbin
>
>
>
>
> Dr Binbin Lu
> Lecturer in School of Remote Sensing and Information Engineering, Wuhan University
> Email: binbinlu at whu.edu.cn
>
> From: f-c-b
> Date: 2019-02-22 20:37
> To: r-sig-geo
> Subject: [R-sig-Geo] Geographically weighted regression
> Dear all,
>
> I am currently working out a geographically weighted regression, in which 90% of the data set the model should be calculated and for 10% of the values to be predicted. For the prediction I use the function gwr.predict from the package GWModel:
>
> Erg<-gwr.predict(formula=Ziel~ as.factor(Var1) + log(Var2, base = exp(1)) + Var3, data = Daten90,predictdata = Daten10,bw = bwG, kernel = "gaussian",adaptive = FALSE, p = 2, theta = 0, longlat = FALSE)
>
> I always get this error, although Daten10 and Daten90 have the same structure:
> Error in gwr.predict(formula = Ziel~ as.factor(Var1) + log(Var2, base = exp(1)) + Var3, :
> All the independent variables should be included in the predictdata.
>
> Can you tell me what the problem with this code is?
> Or is there any other way for a GWR and the prediction?
>
> Thank you,
> Christoph
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From i-c-b m@iii@g oii web@de  Sat Feb 23 13:59:46 2019
From: i-c-b m@iii@g oii web@de (i-c-b m@iii@g oii web@de)
Date: Sat, 23 Feb 2019 13:59:46 +0100
Subject: [R-sig-Geo] Geographically weighted regression
References: <trinity-85cb4a0d-c8d3-405f-b6c0-44e669ee17f2-1550839072949@3c-app-webde-bs50>
 <CAM_vjuk-BcNwJT6YQBaawp1zoPyhqTquqOfoSHNu-4=h=Ki=4Q@mail.gmail.com>
 <trinity-23510f46-de29-4120-aaaa-506190935271-1550911144437@3c-app-webde-bs05>
Message-ID: <trinity-e0778366-5638-4eb8-b0ef-ac3e61f40cec-1550926786291@3c-app-webde-bap53>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20190223/51975f75/attachment.html>

From Roger@B|v@nd @end|ng |rom nhh@no  Sat Feb 23 21:20:18 2019
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Sat, 23 Feb 2019 21:20:18 +0100
Subject: [R-sig-Geo] Geographically weighted regression
In-Reply-To: <trinity-e0778366-5638-4eb8-b0ef-ac3e61f40cec-1550926786291@3c-app-webde-bap53>
References: <trinity-85cb4a0d-c8d3-405f-b6c0-44e669ee17f2-1550839072949@3c-app-webde-bs50>
 <CAM_vjuk-BcNwJT6YQBaawp1zoPyhqTquqOfoSHNu-4=h=Ki=4Q@mail.gmail.com>
 <trinity-23510f46-de29-4120-aaaa-506190935271-1550911144437@3c-app-webde-bs05>
 <trinity-e0778366-5638-4eb8-b0ef-ac3e61f40cec-1550926786291@3c-app-webde-bap53>
Message-ID: <alpine.LFD.2.21.1902232106001.14877@reclus.nhh.no>

On Sat, 23 Feb 2019, f-c-b at web.de wrote:

> Thank you for your answer.
> ?I tried to do the transformations before the calculation, but the 
> Problem is still the same. I think the problem lies in the factor. But 
> in my model I need the factor, because there is no linear influence of 
> the year.
> ?
> Is there any solution for this Problem?
> ?https://www.dropbox.com/s/fbhwsy3sd333ung/Example.zip?dl=0 The zip-file 
> in the link contains a picture of str(Daten90) and str(Daten10) and also 
> my data and R-skript. Var4 is log(Var2).
> ?

I see:

> gwrGp <- gwr(formula=Ziel~ Var1 + Var3 + Var4, data = Daten90,
+ bandwidth = bwG, gweight = gwr.Gauss,hatmatrix = TRUE,
+ fit.points=Daten10, predictions=TRUE)
Warning message:
In gwr(formula = Ziel ~ Var1 + Var3 + Var4, data = Daten90, bandwidth = 
bwG,  :
   standard errors set to NA, normalised RSS not available

but using your gwrG object and:

> gwrGp <- gwr(formula=Ziel~ Var1 + Var3 + Var4, data = Daten90,
+ bandwidth = bwG, gweight = gwr.Gauss,hatmatrix = TRUE,
+ fit.points=Daten10, predictions=TRUE, fittedGWRobject=gwrG)

I think the model matrix handling of the factor is OK. The problem in the 
GWmodel::gwr.predict() approach is that the full model matrix approach is 
used on the formula and data arguments, but not on predictdata, which is 
coerced to data frame but never regularised by going through model.matrix, 
hence the error message:

Browse[2]>
debug: if (any((inde_vars %in% names(predictdata)) == F)) stop("All the 
independent variables should be included in the predictdata")
Browse[2]> inde_vars
[1] "Var12006" "Var12007" "Var12008" "Var12009" "Var3"     "Var4"
Browse[2]> names(predictdata)
  [1] "OBJECTID"   "Rechtswert" "Hochwert"   "Var1"       "Var2"
  [6] "Var3"       "Ziel"       "Var4"       "coords.x1"  "coords.x2"

Had the proper approach been used, the names would have been the same.

The relevant part of spgwr::gwr() in R/gwr.R is:

 	if (predictions) {
             t1 <- try(slot(fit.points, "data"), silent=TRUE)
 	    if (class(t1) == "try-error")
 			stop("No data slot in fit.points")
             predx <- try(model.matrix(delete.response(mt), fit.points))
             if (class(predx) == "try-error")
 			stop("missing RHS variable in fit.points")
             if (ncol(predx) != ncol(x))
 			stop("new data matrix columns mismatch")
         }

(lines 71-80)

which uses model.matrix() and uses try() to catch mis-matches.

Hope this helps,

Roger

> Christoph
> ?
> ?
> ?
> ?
> The first step should be to look at
> 
> str(Daten90)
> str(Daten10)
> 
> and if that doesn't solve the problem, then consider a reproducible
> example, or at the very least posting the results of the above to this
> list.
> 
> Sarah
> 
> On Fri, Feb 22, 2019 at 7:38 AM <f-c-b at web.de> wrote:
> >
> > Dear all,
> >
> > I am currently working out a geographically weighted regression, in which
> 90% of the data set the model should be calculated and for 10% of the values
> to be predicted. For the prediction I use the function gwr.predict from the
> package GWModel:
> >
> > Erg<-gwr.predict(formula=Ziel~ as.factor(Var1) + log(Var2, base = exp(1))
> + Var3, data = Daten90,predictdata = Daten10,bw = bwG, kernel =
> "gaussian",adaptive = FALSE, p = 2, theta = 0, longlat = FALSE)
> >
> > I always get this error, although Daten10 and Daten90 have the same
> structure:
> > Error in gwr.predict(formula = Ziel~ as.factor(Var1) + log(Var2, base =
> exp(1)) + Var3, :
> > All the independent variables should be included in the predictdata.
> >
> > Can you tell me what the problem with this code is?
> > Or is there any other way for a GWR and the prediction?
> >
> > Thank you,
> > Christoph
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 
> 
> --
> Sarah Goslee (she/her)
> http://www.numberwright.com
> 
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From i-c-b m@iii@g oii web@de  Sun Feb 24 10:01:32 2019
From: i-c-b m@iii@g oii web@de (i-c-b m@iii@g oii web@de)
Date: Sun, 24 Feb 2019 10:01:32 +0100
Subject: [R-sig-Geo] Geographically weighted regression
In-Reply-To: <alpine.LFD.2.21.1902232106001.14877@reclus.nhh.no>
References: <trinity-85cb4a0d-c8d3-405f-b6c0-44e669ee17f2-1550839072949@3c-app-webde-bs50>
 <CAM_vjuk-BcNwJT6YQBaawp1zoPyhqTquqOfoSHNu-4=h=Ki=4Q@mail.gmail.com>
 <trinity-23510f46-de29-4120-aaaa-506190935271-1550911144437@3c-app-webde-bs05>
 <trinity-e0778366-5638-4eb8-b0ef-ac3e61f40cec-1550926786291@3c-app-webde-bap53>
 <alpine.LFD.2.21.1902232106001.14877@reclus.nhh.no>
Message-ID: <trinity-cf687c3c-a46e-45a4-b145-9b6ab5b7ef04-1550998892067@3c-app-webde-bs38>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20190224/6dc37a7b/attachment.html>

From J|n@L| @end|ng |rom g@@gov@@u  Mon Feb 25 01:52:10 2019
From: J|n@L| @end|ng |rom g@@gov@@u (Li Jin)
Date: Mon, 25 Feb 2019 00:52:10 +0000
Subject: [R-sig-Geo] =?windows-1252?q?A_new_version_=281=2E2=2E0=29_of_th?=
 =?windows-1252?q?e_=93spm=94_package_for_spatial_predictive_modelling__is?=
 =?windows-1252?q?_now_on_CRAN=2E_=5BSEC=3DUNCLASSIFIED=5D?=
Message-ID: <SYAPR01MB2413A812BA896A5E6F77A2D0D07A0@SYAPR01MB2413.ausprd01.prod.outlook.com>

Dear R users,



A new version (1.2.0) of the ?spm? package for spatial predictive modelling  is now available on CRAN.



The introductory vignette is available here:

https://cran.rstudio.com/web/packages/spm/vignettes/spm.html


In this version, two additional functions, avi and rvi have been added; and some typos in the help files have been corrected.

avi: to calculate averaged variable importance (avi) for ranfom forest; and
rvi: to calculate relative variable influence (rvi) for generalised boosted regression modelling (gbm).



As always, if you find any bugs and have any suggestions, please send me an email! Thanks in advance!



Kind regards,

Jin Li, PhD | Spatial Modeller / Computational Statistician
National Earth and Marine Observations | Environmental Geoscience Division
t:  +61 2 6249 9899    www.ga.gov.au<http://www.ga.gov.au/>



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20190225/0c0f5c13/attachment.html>

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: mg_info.txt
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20190225/0c0f5c13/attachment.txt>

From Roger@B|v@nd @end|ng |rom nhh@no  Mon Feb 25 09:50:17 2019
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Mon, 25 Feb 2019 09:50:17 +0100
Subject: [R-sig-Geo] Geographically weighted regression
In-Reply-To: <trinity-cf687c3c-a46e-45a4-b145-9b6ab5b7ef04-1550998892067@3c-app-webde-bs38>
References: <trinity-85cb4a0d-c8d3-405f-b6c0-44e669ee17f2-1550839072949@3c-app-webde-bs50>
 <CAM_vjuk-BcNwJT6YQBaawp1zoPyhqTquqOfoSHNu-4=h=Ki=4Q@mail.gmail.com>
 <trinity-23510f46-de29-4120-aaaa-506190935271-1550911144437@3c-app-webde-bs05>
 <trinity-e0778366-5638-4eb8-b0ef-ac3e61f40cec-1550926786291@3c-app-webde-bap53>
 <alpine.LFD.2.21.1902232106001.14877@reclus.nhh.no>
 <trinity-cf687c3c-a46e-45a4-b145-9b6ab5b7ef04-1550998892067@3c-app-webde-bs38>
Message-ID: <alpine.LFD.2.21.1902250948120.2813@reclus.nhh.no>

On Sun, 24 Feb 2019, f-c-b at web.de wrote:

> Hello Roger,
> ?
> thank you for your answer.
> ?
> I tried:
> > gwrGp <- gwr(formula=Ziel~ Var1 + Var3 + Var4, data = Daten90,
> + bandwidth = bwG, gweight = gwr.Gauss,hatmatrix = TRUE,
> + fit.points=Daten10, predictions=TRUE, fittedGWRobject=gwrG)
> ?
> Now the prediction works, but when I give out the result, I get this error:
> 
> Error in sqrt(x$results$sigma2.b) :
>   non-numeric argument to mathematical function
> How can I solve this problem?

I am not looking over your shoulder. Always provide the code verbatim, if 
I guess which mess you are in, I may get the wrong mess.

Generally, I advise against GWR in all settings, it should only ever be 
used for exploring data for non-stationarity.

Roger

> ?
> Thank you,
> Christoph
> 
> 
> > Thank you for your answer.
> > ?I tried to do the transformations before the calculation, but the
> > Problem is still the same. I think the problem lies in the factor. But
> > in my model I need the factor, because there is no linear influence of
> > the year.
> > ?
> > Is there any solution for this Problem?
> > ?https://www.dropbox.com/s/fbhwsy3sd333ung/Example.zip?dl=0 The zip-file
> > in the link contains a picture of str(Daten90) and str(Daten10) and also
> > my data and R-skript. Var4 is log(Var2).
> > ?
> 
> I see:
> 
> > gwrGp <- gwr(formula=Ziel~ Var1 + Var3 + Var4, data = Daten90,
> + bandwidth = bwG, gweight = gwr.Gauss,hatmatrix = TRUE,
> + fit.points=Daten10, predictions=TRUE)
> Warning message:
> In gwr(formula = Ziel ~ Var1 + Var3 + Var4, data = Daten90, bandwidth =
> bwG, :
> standard errors set to NA, normalised RSS not available
> 
> but using your gwrG object and:
> 
> > gwrGp <- gwr(formula=Ziel~ Var1 + Var3 + Var4, data = Daten90,
> + bandwidth = bwG, gweight = gwr.Gauss,hatmatrix = TRUE,
> + fit.points=Daten10, predictions=TRUE, fittedGWRobject=gwrG)
> 
> I think the model matrix handling of the factor is OK. The problem in the
> GWmodel::gwr.predict() approach is that the full model matrix approach is
> used on the formula and data arguments, but not on predictdata, which is
> coerced to data frame but never regularised by going through model.matrix,
> hence the error message:
> 
> Browse[2]>
> debug: if (any((inde_vars %in% names(predictdata)) == F)) stop("All the
> independent variables should be included in the predictdata")
> Browse[2]> inde_vars
> [1] "Var12006" "Var12007" "Var12008" "Var12009" "Var3" "Var4"
> Browse[2]> names(predictdata)
> [1] "OBJECTID" "Rechtswert" "Hochwert" "Var1" "Var2"
> [6] "Var3" "Ziel" "Var4" "coords.x1" "coords.x2"
> 
> Had the proper approach been used, the names would have been the same.
> 
> The relevant part of spgwr::gwr() in R/gwr.R is:
> 
> if (predictions) {
> t1 <- try(slot(fit.points, "data"), silent=TRUE)
> if (class(t1) == "try-error")
> stop("No data slot in fit.points")
> predx <- try(model.matrix(delete.response(mt), fit.points))
> if (class(predx) == "try-error")
> stop("missing RHS variable in fit.points")
> if (ncol(predx) != ncol(x))
> stop("new data matrix columns mismatch")
> }
> 
> (lines 71-80)
> 
> which uses model.matrix() and uses try() to catch mis-matches.
> 
> Hope this helps,
> 
> Roger
> 
> > Christoph
> > ?
> > ?
> > ?
> > ?
> > The first step should be to look at
> >
> > str(Daten90)
> > str(Daten10)
> >
> > and if that doesn't solve the problem, then consider a reproducible
> > example, or at the very least posting the results of the above to this
> > list.
> >
> > Sarah
> >
> > On Fri, Feb 22, 2019 at 7:38 AM <f-c-b at web.de> wrote:
> > >
> > > Dear all,
> > >
> > > I am currently working out a geographically weighted regression, in
> which
> > 90% of the data set the model should be calculated and for 10% of the
> values
> > to be predicted. For the prediction I use the function gwr.predict from
> the
> > package GWModel:
> > >
> > > Erg<-gwr.predict(formula=Ziel~ as.factor(Var1) + log(Var2, base =
> exp(1))
> > + Var3, data = Daten90,predictdata = Daten10,bw = bwG, kernel =
> > "gaussian",adaptive = FALSE, p = 2, theta = 0, longlat = FALSE)
> > >
> > > I always get this error, although Daten10 and Daten90 have the same
> > structure:
> > > Error in gwr.predict(formula = Ziel~ as.factor(Var1) + log(Var2, base =
> > exp(1)) + Var3, :
> > > All the independent variables should be included in the predictdata.
> > >
> > > Can you tell me what the problem with this code is?
> > > Or is there any other way for a GWR and the prediction?
> > >
> > > Thank you,
> > > Christoph
> > > _______________________________________________
> > > R-sig-Geo mailing list
> > > R-sig-Geo at r-project.org
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> >
> >
> > --
> > Sarah Goslee (she/her)
> > http://www.numberwright.com
> >
> >
> 
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> https://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en
> 
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From pg@udhee@h @end|ng |rom gm@||@com  Thu Feb 28 12:44:26 2019
From: pg@udhee@h @end|ng |rom gm@||@com (sudheesh pai)
Date: Thu, 28 Feb 2019 12:44:26 +0100
Subject: [R-sig-Geo] Error when using over
Message-ID: <CA+2PVpFABUXDxvS2gqZS6i0b1T=nY7s00mjCAeT-2p-bphsZ+A@mail.gmail.com>

Hi all,
I am getting a strange error when I am using over function. Ideally, the
over function should return the index of polygon, which i got for first set
of data.
But when i compiled for another set of data, not only the index, all the
values are shown as NA. The CRS of polygon and points when i did
proj4string are same.

If someone has anyidea what has happened  here, please let me know.
Thanks
[image: image.png]

-- 
SUDHEESH.P.G
Postdoctoral Fellow,
LTU, Sweden
pgsudheesh at gmail.com

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20190228/bb410269/attachment.html>

-------------- next part --------------
A non-text attachment was scrubbed...
Name: image.png
Type: image/png
Size: 11129 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20190228/bb410269/attachment.png>

