From Roger.Bivand at nhh.no  Tue Jan  1 20:49:28 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 1 Jan 2013 20:49:28 +0100
Subject: [R-sig-Geo] function to convert 3D geographical coordinates to
 Cartesian?
In-Reply-To: <871ue8jdw8.fsf@pobox.com>
References: <871ue8jdw8.fsf@pobox.com>
Message-ID: <alpine.LRH.2.02.1301012037100.11674@reclus.nhh.no>

On Sun, 30 Dec 2012, Tom Roche wrote:

>
> Is there packaged code to convert geographical coordinates (e.g.,
> longitude, latitude, elevation) to Cartesian coordinates in 3-space?
> The spherical-to-Cartesian math is straightforward enough, but there's
> certainly scope for error, so I'd prefer to use tested, previously-used
> code if available.

Have you searched the PROJ.4 list archives? My guess is that the problem 
is intractable, because your apparent elevation at the geographical 
coordinate point is crucially dependent on the datum. If the datum is 
unknown, then no geodetic transformation will be well-defined. If you do 
have the datum, that would help. This looks rather like backwards GPS, so 
maybe a GPS text would point to appropriate algorithms?

If you look at the C code underlying spTransform(), you'll see that the 
call to pj_transform() sets z to zero, that is to the datum surface, and 
the returned values are discarded. The most robust route forward might be 
to permit 3D SpatialPoints to be transformed directly, and choose a 
geo-centric target projection. If you have a data set case with both the 
input and matching output data, I could take a look.

Best wishes,

Roger

>
> TIA, Tom Roche <Tom_Roche at pobox.com>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From tlumley at uw.edu  Wed Jan  2 00:23:22 2013
From: tlumley at uw.edu (Thomas Lumley)
Date: Wed, 2 Jan 2013 12:23:22 +1300
Subject: [R-sig-Geo] Formula of function "lchoose"
In-Reply-To: <CANuoaEEuXTv1B5=fotUaRJXboM3pby_u7b77+kf56x-CLCC6vw@mail.gmail.com>
References: <CANuoaEEuXTv1B5=fotUaRJXboM3pby_u7b77+kf56x-CLCC6vw@mail.gmail.com>
Message-ID: <CAJ55+dKUqa5n-0ZP-jPNAVTLG2iqL=z4TDdHUHxFOJzj55qEdQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130102/d2ec4f4e/attachment.pl>

From Tom_Roche at pobox.com  Wed Jan  2 01:39:09 2013
From: Tom_Roche at pobox.com (Tom Roche)
Date: Tue, 01 Jan 2013 19:39:09 -0500
Subject: [R-sig-Geo] function to convert 3D geographical coordinates to
 Cartesian?
In-Reply-To: <alpine.LRH.2.02.1301012037100.11674@reclus.nhh.no>
References: <alpine.LRH.2.02.1301012037100.11674@reclus.nhh.no> 
Message-ID: <87623gifki.fsf@pobox.com>


https://stat.ethz.ch/pipermail/r-sig-geo/2012-December/017099.html
>>> Is there packaged code to convert geographical coordinates (e.g.,
>>> longitude, latitude, elevation) to Cartesian coordinates in 3-space?
>>> The spherical-to-Cartesian math is straightforward enough, but
>>> there's certainly scope for error, so I'd prefer to use tested,
>>> previously-used code if available.

https://stat.ethz.ch/pipermail/r-sig-geo/2013-January/017110.html
(rearranged)
> your apparent elevation at the geographical coordinate point is
> crucially dependent on the datum.

Fortunately, the atmospheric model with which I'm working assumes a
spherical earth. So (If I Understand Correctly--please correct if not),
I have no such dependency; hence proposed code @ end of

https://stat.ethz.ch/pipermail/r-sig-geo/2012-December/017105.html

In the general case, the user should provide a CRS (more below).

> If you look at the C code underlying spTransform(), you'll see that
> the call to pj_transform() sets z to zero, that is to the datum
> surface, and the returned values are discarded.

So spTransform() is, by design, 2D-only? <sigh/>

> The most robust route forward might be to permit 3D SpatialPoints to
> be transformed directly, and choose a geo-centric target projection.

That's also my impression:

https://stat.ethz.ch/pipermail/r-sig-geo/2012-December/017105.html
>> I'm looking for code [which]
...
>> * _properly_ converts elevation to radial distance (from earth
>>   center), i.e., using a user-specified CRS. My function
>>   elev2rdist below is a blatant kludge, though it should work for
>>   the model for which I'm assimilating data.

> If you have a data set case with both the input and matching output
> data, I could take a look.

I don't have output data yet, nor even data in the form my output must
match (though I should have the latter soon, and I believe I know its
form--more below). I do have input data, with which I'm working @

https://bitbucket.org/tlroche/mozart-global-to-aqmeii-na

My usecase is like this:

I need to conservatively 3D-regrid atmospheric concentration data from a
global inventory (aka "the input") which

- has lon-lat horizontal coordinates

- has hybrid sigma-pressure

http://en.wikipedia.org/wiki/Sigma_coordinate_system#hybrid_sigma-pressure

  (aka "H?P") vertical coordinates

- assumes a spherical earth

to a regional space (aka "the output") which

+ is Lambert conformal conic horizontal (at much finer resolution than
  the input)

+ is (I believe) H?P vertical (with different vertical levels than the
  input)

+ assumes a spherical earth

(The input is, and the output must be, netCDF.) After considerable
research, ISTM the current best tool for this job is NCL

http://www.ncl.ucar.edu/

since it has API for

* converting H?P to elevation

* calling ESMF routines that (apparently) most conservatively 3D-regrid

But NCL and ESMF consider LCC (at least in the form in which my output
uses it) to be a Cartesian grid, so before I can use that, I must (IIUC)

1. horizontally crop the input to the output's bounds. Fortunately R
   package=raster makes this easy.

2. convert the cropped input grid's vertical coordinates from H?P to
   elevation. I can do this with NCL.

3. convert the cropped input grid's from geographical coordinates to
   Cartesian coordinates.

Step 3 motivates my request. Fortunately I'm working with spheres, and
there are several available 3D spherical-to-Cartesian routines (and even
I can handle that math :-) so for now I can do something like the code @

https://stat.ethz.ch/pipermail/r-sig-geo/2012-December/017105.html

But, longer-term, It Would Be Nice if someone provided a proper (i.e.,
taking a user-provided CRS argument) 3D geographical-to-Cartesian
conversion.

Your assistance is appreciated (even if only useful in future),
Tom Roche <Tom_Roche at pobox.com>


From lubinbin220 at gmail.com  Wed Jan  2 16:58:17 2013
From: lubinbin220 at gmail.com (binbin lu)
Date: Wed, 2 Jan 2013 15:58:17 +0000
Subject: [R-sig-Geo] Formula of function "lchoose"
In-Reply-To: <CAJ55+dKUqa5n-0ZP-jPNAVTLG2iqL=z4TDdHUHxFOJzj55qEdQ@mail.gmail.com>
References: <CANuoaEEuXTv1B5=fotUaRJXboM3pby_u7b77+kf56x-CLCC6vw@mail.gmail.com>
	<CAJ55+dKUqa5n-0ZP-jPNAVTLG2iqL=z4TDdHUHxFOJzj55qEdQ@mail.gmail.com>
Message-ID: <CANuoaEGvzbXpgXB_GgvaqydxdAtNT2YDjio-rTQo7xLC6oG7_A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130102/300752a8/attachment.pl>

From Tom_Roche at pobox.com  Wed Jan  2 18:23:58 2013
From: Tom_Roche at pobox.com (Tom Roche)
Date: Wed, 02 Jan 2013 12:23:58 -0500
Subject: [R-sig-Geo] requesting 3D spTransform()
Message-ID: <87licb4hxt.fsf@pobox.com>


https://stat.ethz.ch/pipermail/r-sig-geo/2012-December/017099.html
>> Is there packaged code to convert geographical coordinates (e.g.,
>> longitude, latitude, elevation) to Cartesian coordinates in 3-space?

https://stat.ethz.ch/pipermail/r-sig-geo/2013-January/017110.html
> [In] the C code underlying spTransform(), you'll see that the call to
> pj_transform() sets z to zero, that is to the datum surface, and the
> returned values are discarded.

ISTM "The Better Way" would be to add a boolean argument: e.g.,
spTransform(..., 3d=false, ...)

* make the current behavior the default
* for 3d=true, don't discard the elevations

Am I missing something?

> The most robust route forward might be to permit 3D SpatialPoints to
> be transformed directly, and choose a geo-centric target projection.

Is there a way to request this? I note package=sp allows FRs

https://r-forge.r-project.org/tracker/?atid=4032&group_id=1014&func=browse

but I'm not seeing equivalent UI for package=rgdal.

TIA, Tom Roche <Tom_Roche at pobox.com>


From Tom_Roche at pobox.com  Wed Jan  2 19:31:30 2013
From: Tom_Roche at pobox.com (Tom Roche)
Date: Wed, 02 Jan 2013 13:31:30 -0500
Subject: [R-sig-Geo] multiple data variables in one {Raster*, netCDF file}
Message-ID: <87ip7f4et9.fsf@pobox.com>


Can one read multiple data variables (datavars) to one netCDF-derived
Raster*? Can one write* from several Raster*'s to several datavars in
one netCDF file? What I mean, why I ask:

I have a netCDF file with several datavars. One datavar (concentrations)
is of primary interest, but I will need several of the other datavars to
do subsequent computations on the concentrations datavar. The concs
datavar is 3D (vertical level, latitude, longitude) but the others are
either 2D (surface pressure, dims=(lat, lon)) or 1D (coefficients,
dim=level). (There is only one timestep.)

I also need to crop the horizontal extent of the datavars >= 2D in the
file. This is easy with raster::crop(Raster*, ...), but it seems one can
only construct a Raster* with one datavar per netCDF file:

http://cran.r-project.org/web/packages/raster/raster.pdf
> raster   Create a RasterLayer object
...
> Details
...
> If x represents a NetCDF file, the following additional variable is
> recognized:

> varname: character. The variable name, such as ?tasmax? or ?pr?. If
> not supplied and the file has multiple variables are a guess will be
> made (and reported)

Am I missing something? If not, I'd like to know:

1. Must I create and crop separate Raster*s for each datavar?

2. Can I at least create/crop separate Raster*s for each of the
   dimensionalities: i.e., put the 3D datavars in one Raster* and put
   the 2D datavars in another Raster*?

3. A subsequent processor (apparently) finds it advantageous to have all
   the datavars in one netCDF file. Can one write from multiple Raster*
   to multiple datavars in a single netCDF file? An optimistic reading
   of raster.pdf suggests this is supported via the sequence
   [writeStart, writeValues, writeStop], but I'd appreciate
   confirmation.

TIA, Tom Roche <Tom_Roche at pobox.com>


From Roger.Bivand at nhh.no  Wed Jan  2 19:45:10 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 2 Jan 2013 19:45:10 +0100
Subject: [R-sig-Geo] requesting 3D spTransform()
In-Reply-To: <87licb4hxt.fsf@pobox.com>
References: <87licb4hxt.fsf@pobox.com>
Message-ID: <alpine.LRH.2.02.1301021911390.14503@reclus.nhh.no>

On Wed, 2 Jan 2013, Tom Roche wrote:

>
> https://stat.ethz.ch/pipermail/r-sig-geo/2012-December/017099.html
>>> Is there packaged code to convert geographical coordinates (e.g.,
>>> longitude, latitude, elevation) to Cartesian coordinates in 3-space?
>
> https://stat.ethz.ch/pipermail/r-sig-geo/2013-January/017110.html
>> [In] the C code underlying spTransform(), you'll see that the call to
>> pj_transform() sets z to zero, that is to the datum surface, and the
>> returned values are discarded.
>
> ISTM "The Better Way" would be to add a boolean argument: e.g.,
> spTransform(..., 3d=false, ...)
>
> * make the current behavior the default
> * for 3d=true, don't discard the elevations
>
> Am I missing something?
>
>> The most robust route forward might be to permit 3D SpatialPoints to
>> be transformed directly, and choose a geo-centric target projection.
>
> Is there a way to request this? I note package=sp allows FRs
>
> https://r-forge.r-project.org/tracker/?atid=4032&group_id=1014&func=browse
>
> but I'm not seeing equivalent UI for package=rgdal.

It is much preferred for users to submit patches, or at least workable 
examples. Wishes tend only to vex developers, and the sp list is usually 
ignored - all the useful communication happens on R-sig-geo. I'm assuming 
that you can install rgdal from source, that is that you can check out the 
current R-forge rgdal SVN (revision 421), and install it. There you will 
find that a SpatialPoints object with a third dimension will now be 
transformed as you seem to think you need, since pj_transform() does take 
a z vector. SpatialLines and SpatialPolygons objects are limited to 2D and 
will not be accommodated.

I'm concerned that two of your steps make your workflow debatable, one 
that you are not actually dealing with height (which on the sphere is of 
no consequence); it seems that pj_transform is useful where z changes when 
datum transformation occurs. If both your cases are spherical, there is no 
datum transformation, so admitting z in spTransform() is a red herring. 
I'm also concerned that you appear to expect the input and output to be 
gridded, but after projection they will not be gridded without warping. In 
addition, you need to interpolate to a finer grid.

I'm willing to hazard the view that you would be better placed using 2D 
interpolation methods warping your model values to the finer projected 
grid after having projected the model input to irregular points. That is, 
3D interpolation is still a very different animal from what you need to 
do. Unfortunately both atmospheric and oceanographic models use their own 
dimensions in their own grids, none of which map easily into the real 
world. Please do try several approaches and let us know which actually 
works - 3D datum transformation is now implemented in rgdal, but I don't 
think it is what you really need. The real problem is change of support in 
3D, in addition to interpolation to a finer 2/3D grid.

Worry about the output format only once you reach a sensible outcome (in 
reply to your further NetCDF question). My guess would be that some form 
of hierarchical geostatistical model for interpolation is needed to carry 
out the change of support. Please wait before overwhelming people with 
your problems, I'd be grateful now for feedback on spTransform() only. If 
you cannot help with that, change your OS and get back when you are able 
to contribute, nobody here gets paid for answering!

Please also always quote verbatim your full thread - you've been dropping 
things, here starting a new thread (sigh!!), and wasting time because I 
have to scan several days' mail to find your workflow:

"My usecase is like this:

I need to conservatively 3D-regrid atmospheric concentration data from a
global inventory (aka "the input") which

- has lon-lat horizontal coordinates

- has hybrid sigma-pressure

http://en.wikipedia.org/wiki/Sigma_coordinate_system#hybrid_sigma-pressure

   (aka "H?P") vertical coordinates

- assumes a spherical earth

to a regional space (aka "the output") which

+ is Lambert conformal conic horizontal (at much finer resolution than
   the input)

+ is (I believe) H?P vertical (with different vertical levels than the
   input)

+ assumes a spherical earth"

OK?

Roger

>
> TIA, Tom Roche <Tom_Roche at pobox.com>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From freddy.vate01 at gmail.com  Wed Jan  2 22:06:39 2013
From: freddy.vate01 at gmail.com (=?UTF-8?Q?Freddy_L=C3=B3pez?=)
Date: Wed, 2 Jan 2013 16:36:39 -0430
Subject: [R-sig-Geo] Doubts about GLM
In-Reply-To: <CABWNPhq45WemB+BR+hjt5bogzm2PQc724bpM-0u488x22_f+Sg@mail.gmail.com>
References: <CABWNPhq45WemB+BR+hjt5bogzm2PQc724bpM-0u488x22_f+Sg@mail.gmail.com>
Message-ID: <CALCOUqv9RfruDS4nr8N9UkPTWDwNYo9H1-khc7H1a89qrd9JRQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130102/08bf383e/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Wed Jan  2 22:33:30 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed, 2 Jan 2013 21:33:30 +0000
Subject: [R-sig-Geo] Doubts about GLM
In-Reply-To: <11d5754f36ad470487dd82add24cb6fc@EX-1-HT0.lancs.local>
References: <11d5754f36ad470487dd82add24cb6fc@EX-1-HT0.lancs.local>
Message-ID: <CANVKczOG7DJ_SDo1UTZkh7iCi3QYsPycgaZe-_AjUUAihmFOJA@mail.gmail.com>

On Sun, Dec 30, 2012 at 1:55 PM, Suzana Stutz <suzana.stutz at gmail.com> wrote:
> Dear list members.
>
> I've been trying to apply GLM for spatial analysis of  a marine animal's
> distribution (as the dependant variable) related to many environmental
> variables (as the independant ones). But some of them are correlated, for
> example, the depth increases as the distance to coast increases, and  I
> must test both. Does it disagree with the assumption of independence of the
> data? If yes, how can I fix it in order to keep the two variables in the
> model?

 Correlation in your explanatory variables is a classical problem of
variable selection, and there are methods for that. The bigger problem
with doing a GLM with spatial data is that the data points are going
to have spatial autocorrelation...

 Two measurements of 10 fish per square meter at depth 50m taken two
metres apart are less likely to be independent than two measurements
of 10 fish per square meter at depth 50m taken twenty kilometres
apart. In the first case, the second measurement doesn't much extra
information - you already knew that this location had 10 fish/m^2 -
but in the second case the second measurement is much more useful.
There were 10 fish/m^2 even though the locations were far apart! It
might be due to the 50m depth!

You can do a GLM for starters, but its important to check the
independence assumption of the GLM otherwise you could be getting
significant effects when none are really there.

Barry


From megan.evans at anu.edu.au  Thu Jan  3 01:11:13 2013
From: megan.evans at anu.edu.au (Megan Evans)
Date: Thu, 3 Jan 2013 11:11:13 +1100
Subject: [R-sig-Geo] Raster crosstab output: -1 values?
In-Reply-To: <CALuVVaZUvow6oksZ-0ZTdSyVys2VuK+xn3UVdkVR2jBhYqRDmA@mail.gmail.com>
References: <1355958193522-7582028.post@n2.nabble.com>
	<CALuVVaZUvow6oksZ-0ZTdSyVys2VuK+xn3UVdkVR2jBhYqRDmA@mail.gmail.com>
Message-ID: <006001cde946$d8039b70$880ad250$@anu.edu.au>

Hi Lyndon,

Thanks for your suggestions - I'll have to look into this some more. To be
honest I did the resampling and reprojecting in ArcGIS, since it was taking
forever in R. I think I'll go back and redo this in R to try to eliminate
the possibility that this is what's introducing the '-1' values. 

Thanks again,
Megan

-----Original Message-----
From: Lyndon Estes [mailto:lyndon.estes at gmail.com] 
Sent: Friday, 21 December 2012 2:01 AM
To: Megan Evans
Cc: r-sig-geo
Subject: Re: [R-sig-Geo] Raster crosstab output: -1 values?

Hi Megan,

Can you give some steps on how you prepared the data before stacking?
Was there any resampling, reprojecting, etc. involved in your forest cover
layer?  I have had similar results with rasters in the past where NA values
were represented by negative numbers.  What might have happened is a
relatively large negative number (in absolute terms) was resampled down to a
small one (in absolute terms) with the default setting at bilinear, e.g.

resample(x)

But that's just a guess without knowing your processing steps.

Best, Lyndon

On Wed, Dec 19, 2012 at 6:03 PM, Megan Evans <megan.evans at anu.edu.au> wrote:
> Hi everyone,
>
> I'm computing a very large crosstab analysis (using the raster 
> package) for around 700 tiles of 25m resolution vegetation raster 
> data. Essentially, I want to figure out how much forest is contained 
> within each land use, land tenure and jurisdictional boundary (eight 
> Australian States) over a 39 year time period (20 years with data).
>
> The land tenure, land use and State layers have all been cut up into 
> the same extent, resolution and projection as the forest cover data. I 
> then create a raster stack of the forest cover, State and land 
> tenure-use (the latter was combined into one raster layer) tiles, and 
> subsequently a crosstab. This process is repeated for each tile and 
> year (~700 loops, taking a rather long time). The forest cover data 
> (in this particular year -
> 1972) has values of only 0 and 1 (non-forest/forest). However, I'm 
> finding in some cases the crosstab output contains data in a "-1" 
> category, despite this value not being part of the original forest cover
data.
>
> I'm at a loss to explain this; all datasets have the same number of 
> cells, resoluton, and no missing data. Would really appreciate any
insights!
>
> Cheers, Megan
>
> Data details below:
>
> Forest Cover (ttile):
> class       : RasterLayer
> dimensions  : 16000, 28360, 453760000  (nrow, ncol, ncell) resolution  
> : 0.00025, 0.00025  (x, y)
> extent      : 112.91, 120, -28, -24  (xmin, xmax, ymin, ymax)
> coord. ref. : +proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 
> +no_defs data source :
> D:/Analysis/R/Data/forestextent_reg/forest_v8_72_11/sg50/forst72.grd
> names       : layer
> values      : 0, 1  (min, max)
> Raster Attribute Table
>      fields : ID     COUNT
>         min :  0  30065009
>         max :  1 423694991
>
> State (st_tex):
> class       : RasterLayer
> dimensions  : 16000, 28360, 453760000  (nrow, ncol, ncell) resolution  
> : 0.00025, 0.00025  (x, y)
> extent      : 112.91, 120, -28, -24  (xmin, xmax, ymin, ymax)
> coord. ref. : +proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 
> +no_defs data source :
D:/Analysis/R/Data/sttiles/forest_v8_72_11/stsg50.grd
> names       : states_p
> values      : 8, 8  (min, max)
>
> Land Use/Tenure (lu_ten_tex):
> class       : RasterLayer
> dimensions  : 16000, 28360, 453760000  (nrow, ncol, ncell) resolution  
> : 0.00025, 0.00025  (x, y)
> extent      : 112.91, 120, -28, -24  (xmin, xmax, ymin, ymax)
> coord. ref. : +proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 
> +no_defs data source :
D:/Analysis/R/Data/lutentiles/forest_v8_72_11/lutensg50.grd
> names       : lu_ten
> values      : 1, 73  (min, max)
> Raster Attribute Table
>      fields : ID       COUNT
>         min :  1 -1816924096
>         max : 73  1681761600
>
> Relevant code:
> # Create raster stack between forestextent, lu and state
>         x <-stack(ttile, lu_ten_tex, st_tex)
>
>         #Crosstab will calculate the frequency of each level 
> (0=non-forest, 1=primforest, 2=regforest) in each land use/tenure/state
>         vegfreq <-crosstab(x, digits=0, long=FALSE, progress="text")
>
>> vegfreq
> , , states_p = 8
>
>      lu_ten
> layer         0         1         3        11        13        61
63
> 33
>    0     400975   2059222   2355223  28336430  13144612   2565663
316999241
> 42855
>    1      15814      1098     19824   6497248   3958995    761517
17902798
> 345
>    -1        11      1280       153      3522       393        20
15961
> 0
>      lu_ten
> layer        43        73        23        53        71        51
12
> 22
>    0       8447     16777     64401     50205     19375     17463
334230
> 664199
>    1       1153      7223     66799       995     31825       137
396970
> 126201
>    -1         0         0         0         0         0         0
0
> 0
>      lu_ten
> layer        62         2        32
>    0     310439      1586     13062
>    1     201561        14      2938
>    -1         0         0         0
>
>
>
>
> --
> View this message in context: 
> http://r-sig-geo.2731867.n2.nabble.com/Raster-crosstab-output-1-values
> -tp7582028.html Sent from the R-sig-geo mailing list archive at 
> Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Roger.Bivand at nhh.no  Thu Jan  3 12:20:43 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 3 Jan 2013 12:20:43 +0100
Subject: [R-sig-Geo] gdal color tables
In-Reply-To: <CANVKczOONGzE+bXOmorftsGc-LpC=RfTYhxX-6npmkLkNerXqA@mail.gmail.com>
References: <e34b82729aed4b3f9b38cab5c8243770@EX-1-HT0.lancs.local>
	<CANVKczPSLFLN4vj7viF46Fgj6QgwK9dkshWYABwLb1JG-Oq4ug@mail.gmail.com>
	<CAG4NReKWW=ptKztB+txMye_0ym7_tUi+TeZqAOTMY7tdxhH9+A@mail.gmail.com>
	<alpine.LRH.2.02.1212231529180.26107@reclus.nhh.no>
	<CAG4NReLiSLK9W0VA6hq5B6AT5+uOL=Bo0Ak1cntjwdQ5xHwh4A@mail.gmail.com>
	<da346ab4f5bd4563918623ef0b210404@EX-1-HT0.lancs.local>
	<bd3d6d241f90457a891f72e124a33ff8@EX-0-HT0.lancs.local>
	<605df35965554cd39d3a44c635458589@EX-0-HT0.lancs.local>
	<CANVKczOONGzE+bXOmorftsGc-LpC=RfTYhxX-6npmkLkNerXqA@mail.gmail.com>
Message-ID: <alpine.LRH.2.02.1301031211060.18196@reclus.nhh.no>

On Thu, 27 Dec 2012, Barry Rowlingson wrote:

> How to create colour-paletted rasters using R and Python:
>
> http://www.rpubs.com/geospacedman/rasterColourPalettes
>
> It would be great to be able to do this solely from R using either
> raster or rgdal, and to have the couple of bugs with paletted rasters
> in package:raster mentioned in the Rpubs doc fixed. I shall try and
> raise this with Robert H when everyone comes out of hibernation in
> January.

Barry:

As of SVN revision 422 on R-forge, writeGDAL() can write a properly 
configured ColorTable to a Byte GTiff (other drivers untried, probably 
limited to Byte, so #colors 256), by band. It can add CategoryNames by 
band; these and the colors seem to be read by ArcGIS 10.1; the color table 
is read by GRASS 6.4.2, but not the category names. See the examples at 
foot of ?writeGDAL. I haven't so far checked out how one might pass the 
ColorTable through from raster (from the object metadata?), and the 
creation of the table isn't very intuitive (rather like your 
makePalette()) - the look-up from the raster should be zero-based (value 0 
gets the first color, etc.). I'd be interested in feedback with your 
examples.

Best wishes,

Roger


>
> On Sun, Dec 23, 2012 at 9:51 PM, Rowlingson, Barry
> <b.rowlingson at lancaster.ac.uk> wrote:
>> Here's a solution:
>>
>> makePalette <- function(colourvector){
>>   cmat = cbind(t(col2rgb(colourvector)),255)
>>   res = apply(cmat,1,function(x){sprintf('<Entry c1="%s" c2="%s"
>> c3="%s" c4="%s"/>',x[1],x[2],x[3],x[4])})
>>   res = paste(res,collapse="\n")
>>   res
>> }
>>
>>
>> Then:
>>
>>  write a raster tiff
>>
>>  writeRaster(iom,"test.tif",overwrite=TRUE,datatype="INT1U")
>>
>>
>> Then use makePalette to create the colortable lines:
>>
>> cat(makePalette(iom at legend@colortable)) # replace
>> iom at legend@colortable with your colour table vector
>>
>> That spits out a bunch of <Entry> lines. Stick them in your .vrt file thus:
>>
>> <VRTDataset rasterXSize="413" rasterYSize="397">
>>   <VRTRasterBand dataType="Byte" band="1">
>>     <ColorInterp>Palette</ColorInterp>
>> <SimpleSource>
>> <SourceFilename relativeToVRT="1">test.tif</SourceFilename>
>> </SimpleSource>
>>     <ColorTable>
>> <Entry c1="0" c2="0" c3="0" c4="255"/>
>> <Entry c1="230" c2="0" c3="77" c4="255"/>
>> <Entry c1="255" c2="0" c3="0" c4="255"/>
>> <Entry c1="204" c2="77" c3="242" c4="255"/>
>> <Entry c1="204" c2="0" c3="0" c4="255"/>
>> [etc]
>>    </ColorTable>
>>   </VRTRasterBand>
>> </VRTDataset>
>>
>> Note you have to fill in the rasterXSize and rasterYSize, and the
>> source filename. Also you'll need to get the geotransform of the
>> original and stick that in otherwise your raster is geolocated at
>> (1:Nrows, 1:Ncolumns).
>>
>> If I do all that, I get a raster created by R that I can read into
>> QGis and is coloured according to my colour scheme, as long as I open
>> *test.vrt* in QGis and *not* test.tif.
>>
>> I'm sorry this isn't (yet) a one-shot solution, and its a bit of a
>> construction set. Like I said, two minute job, twenty minute job to do
>> properly... I've spent ten minutes on it :)
>>
>> Barry
>>
>>
>>
>>
>> On Sun, Dec 23, 2012 at 9:25 PM, Rowlingson, Barry
>> <b.rowlingson at lancaster.ac.uk> wrote:
>>> On Sun, Dec 23, 2012 at 8:23 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>>>
>>>> There is no support in raster or sp objects for symbology, and unless
>>>> someone extends the classes to accommodate symbology on a dynamic
>>>> by-attribute basis, it isn't going to happen.
>>>>
>>>
>>>  I'm not sure that's true - I can read in a raster from a geoTIFF and
>>> get a colour table from it, then plot will show it with the right
>>> colours - here's a Land Use tiff:
>>>
>>>> lu
>>> class       : RasterLayer
>>> dimensions  : 397, 413, 163961  (nrow, ncol, ncell)
>>> resolution  : 100, 100  (x, y)
>>> extent      : 3356200, 3397500, 3533200, 3572900  (xmin, xmax, ymin, ymax)
>>> coord. ref. : +proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000
>>> +ellps=GRS80 +units=m +no_defs
>>> data source : /data/rowlings/MapLibrary/Europe/UK/IsleOfMan/iomcorine.tiff
>>> names       : iomcorine
>>> values      : 0, 255  (min, max)
>>>
>>>> lu at legend@colortable[1:10]
>>>  [1] "#000000" "#E6004D" "#FF0000" "#CC4DF2" "#CC0000" "#E6CCCC" "#E6CCE6"
>>>  [8] "#A600CC" "#A64D00" "#FF4DFF"
>>>
>>>
>>>  Support for this is minimal in package:raster, and I think what Agus
>>> is trying to do (correct me if wrong) is create a raster with a colour
>>> table such as this from R. If I just use writeRaster I get a numeric
>>> raster with no palette.
>>>
>>> I think Robert has talked about better support for paletted rasters in the past.
>>>
>>> Barry
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From alobolistas at gmail.com  Thu Jan  3 12:25:50 2013
From: alobolistas at gmail.com (Agustin Lobo)
Date: Thu, 3 Jan 2013 12:25:50 +0100
Subject: [R-sig-Geo] Fwd: kml file does not open with ogrinfo but works with
	GE
In-Reply-To: <CAG4NReKNr+rPWNpJBx+r1onb=Y0mnkh-gpJR8qDGBdBXHS7p1w@mail.gmail.com>
References: <CAG4NReKNr+rPWNpJBx+r1onb=Y0mnkh-gpJR8qDGBdBXHS7p1w@mail.gmail.com>
Message-ID: <CAG4NReJTvxt_d6ZcJV8Yz0uzRfffvSOff7gdRYgwwfd=caZmaQ@mail.gmail.com>

FYI
I will keep the list informed in case gdal-dev suggests a solution
Agus
---------- Forwarded message ----------
From: Agustin Lobo <alobolistas at gmail.com>
Date: Thu, Jan 3, 2013 at 12:17 PM
Subject: kml file does not open with ogrinfo but works with GE
To: gdal-dev at lists.osgeo.org


A program (Mission Planner for Ardupilot)
http://code.google.com/p/ardupilot-mega/wiki/MPTlog
produces kml files
with track information that can be represented with the same program
and GE, but I cannot open them with ogrinfo:
$ ogrinfo test.kml
FAILURE:
Unable to open datasource `test.kml' with the following drivers.
$ ogrinfo --version
GDAL 1.9.2, released 2012/10/08

I cannot open it with QGIS or R (readOGR()) either.

Is there a newer kml format that is recognized by GE but not by the OGR library?
Any help with this?
I've uploaded test.kml in case someone could help:
http://dl.dropbox.com/u/3180464/test.kml

Thanks!
Agus


From alobolistas at gmail.com  Thu Jan  3 19:34:42 2013
From: alobolistas at gmail.com (Agustin Lobo)
Date: Thu, 3 Jan 2013 19:34:42 +0100
Subject: [R-sig-Geo] gdal color tables
In-Reply-To: <alpine.LRH.2.02.1301031211060.18196@reclus.nhh.no>
References: <e34b82729aed4b3f9b38cab5c8243770@EX-1-HT0.lancs.local>
	<CANVKczPSLFLN4vj7viF46Fgj6QgwK9dkshWYABwLb1JG-Oq4ug@mail.gmail.com>
	<CAG4NReKWW=ptKztB+txMye_0ym7_tUi+TeZqAOTMY7tdxhH9+A@mail.gmail.com>
	<alpine.LRH.2.02.1212231529180.26107@reclus.nhh.no>
	<CAG4NReLiSLK9W0VA6hq5B6AT5+uOL=Bo0Ak1cntjwdQ5xHwh4A@mail.gmail.com>
	<da346ab4f5bd4563918623ef0b210404@EX-1-HT0.lancs.local>
	<bd3d6d241f90457a891f72e124a33ff8@EX-0-HT0.lancs.local>
	<605df35965554cd39d3a44c635458589@EX-0-HT0.lancs.local>
	<CANVKczOONGzE+bXOmorftsGc-LpC=RfTYhxX-6npmkLkNerXqA@mail.gmail.com>
	<alpine.LRH.2.02.1301031211060.18196@reclus.nhh.no>
Message-ID: <CAG4NReJcwBLDiDgkr+REvjRwcVF+atf5m0_dS7V6B-PABF3cgQ@mail.gmail.com>

FYI:

---------- Forwarded message ----------
From: Even Rouault <even.rouault at mines-paris.org>
Date: Sun, Dec 23, 2012 at 11:14 PM
Subject: Re: [gdal-dev] write pseudocolor raster
To: gdal-dev at lists.osgeo.org, Agustin.Lobo at ictja.csic.es


Le dimanche 23 d?cembre 2012 14:40:59, Agustin Lobo a ?crit :
> I have some 1-band raster layers that I  would like to write as
> pseudocolor files. Is it
> possible to use gdal_traslate or another gdal utility to write the
> raster using the color palette
> of another file?
> I've seen the procedure described in
> http://trac.osgeo.org/gdal/wiki/FAQRaster#Howtocreateormodifyanimagecolorta
> ble but I  would like no having to edit the vrt file manually.

You can use the following GDAL Python script :

http://trac.osgeo.org/gdal/browser/trunk/gdal/swig/python/samples/attachpct.py


From alobolistas at gmail.com  Thu Jan  3 20:06:57 2013
From: alobolistas at gmail.com (Agustin Lobo)
Date: Thu, 3 Jan 2013 20:06:57 +0100
Subject: [R-sig-Geo] gdal color tables
In-Reply-To: <CANVKczOONGzE+bXOmorftsGc-LpC=RfTYhxX-6npmkLkNerXqA@mail.gmail.com>
References: <e34b82729aed4b3f9b38cab5c8243770@EX-1-HT0.lancs.local>
	<CANVKczPSLFLN4vj7viF46Fgj6QgwK9dkshWYABwLb1JG-Oq4ug@mail.gmail.com>
	<CAG4NReKWW=ptKztB+txMye_0ym7_tUi+TeZqAOTMY7tdxhH9+A@mail.gmail.com>
	<alpine.LRH.2.02.1212231529180.26107@reclus.nhh.no>
	<CAG4NReLiSLK9W0VA6hq5B6AT5+uOL=Bo0Ak1cntjwdQ5xHwh4A@mail.gmail.com>
	<da346ab4f5bd4563918623ef0b210404@EX-1-HT0.lancs.local>
	<bd3d6d241f90457a891f72e124a33ff8@EX-0-HT0.lancs.local>
	<605df35965554cd39d3a44c635458589@EX-0-HT0.lancs.local>
	<CANVKczOONGzE+bXOmorftsGc-LpC=RfTYhxX-6npmkLkNerXqA@mail.gmail.com>
Message-ID: <CAG4NReLRsBFrqSjcUdko4RVyMFBvrrx+OT3nEm28u9gVtuz-2w@mail.gmail.com>

Happy 2013 to everyone!
Thanks Barry, very useful page.
Nevertheless, I think the equivalent to zlim in plot() should be
included also, because most of the time
we use standard palettes that must be applied to the particular range
of interest of the raster(s) (note
real raster data often has outliers), i.e.:
plot(r,col=matlab.like(64),zlim=c(20,50))

The same would be useful for makePalette(). Currentely, my raster is
almost all black if use
writePaletteVRT("test.vrt", rin, matlab.like(64))
system("python addPalette.py test.vrt test.tif")

By now i'll use plot() to write a jpeg with the appropriate zlim and
use attachpct.py to apply
the palette to all rasters, or extract the tuned palette from the
output of plot() and use your functions
as they are now. By some reason I'm having problems with raster on my
home computer and
cannot use plot(), but will try
tomorrow from the office. I'll let you know.

Agus

On Thu, Dec 27, 2012 at 11:35 PM, Barry Rowlingson
<b.rowlingson at lancaster.ac.uk> wrote:
> How to create colour-paletted rasters using R and Python:
>
> http://www.rpubs.com/geospacedman/rasterColourPalettes
>
> It would be great to be able to do this solely from R using either
> raster or rgdal, and to have the couple of bugs with paletted rasters
> in package:raster mentioned in the Rpubs doc fixed. I shall try and
> raise this with Robert H when everyone comes out of hibernation in
> January.
>
> On Sun, Dec 23, 2012 at 9:51 PM, Rowlingson, Barry
> <b.rowlingson at lancaster.ac.uk> wrote:
>> Here's a solution:
>>
>> makePalette <- function(colourvector){
>>   cmat = cbind(t(col2rgb(colourvector)),255)
>>   res = apply(cmat,1,function(x){sprintf('<Entry c1="%s" c2="%s"
>> c3="%s" c4="%s"/>',x[1],x[2],x[3],x[4])})
>>   res = paste(res,collapse="\n")
>>   res
>> }
>>
>>
>> Then:
>>
>>  write a raster tiff
>>
>>  writeRaster(iom,"test.tif",overwrite=TRUE,datatype="INT1U")
>>
>>
>> Then use makePalette to create the colortable lines:
>>
>> cat(makePalette(iom at legend@colortable)) # replace
>> iom at legend@colortable with your colour table vector
>>
>> That spits out a bunch of <Entry> lines. Stick them in your .vrt file thus:
>>
>> <VRTDataset rasterXSize="413" rasterYSize="397">
>>   <VRTRasterBand dataType="Byte" band="1">
>>     <ColorInterp>Palette</ColorInterp>
>> <SimpleSource>
>> <SourceFilename relativeToVRT="1">test.tif</SourceFilename>
>> </SimpleSource>
>>     <ColorTable>
>> <Entry c1="0" c2="0" c3="0" c4="255"/>
>> <Entry c1="230" c2="0" c3="77" c4="255"/>
>> <Entry c1="255" c2="0" c3="0" c4="255"/>
>> <Entry c1="204" c2="77" c3="242" c4="255"/>
>> <Entry c1="204" c2="0" c3="0" c4="255"/>
>> [etc]
>>    </ColorTable>
>>   </VRTRasterBand>
>> </VRTDataset>
>>
>> Note you have to fill in the rasterXSize and rasterYSize, and the
>> source filename. Also you'll need to get the geotransform of the
>> original and stick that in otherwise your raster is geolocated at
>> (1:Nrows, 1:Ncolumns).
>>
>> If I do all that, I get a raster created by R that I can read into
>> QGis and is coloured according to my colour scheme, as long as I open
>> *test.vrt* in QGis and *not* test.tif.
>>
>> I'm sorry this isn't (yet) a one-shot solution, and its a bit of a
>> construction set. Like I said, two minute job, twenty minute job to do
>> properly... I've spent ten minutes on it :)
>>
>> Barry
>>
>>
>>
>>
>> On Sun, Dec 23, 2012 at 9:25 PM, Rowlingson, Barry
>> <b.rowlingson at lancaster.ac.uk> wrote:
>>> On Sun, Dec 23, 2012 at 8:23 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>>>
>>>> There is no support in raster or sp objects for symbology, and unless
>>>> someone extends the classes to accommodate symbology on a dynamic
>>>> by-attribute basis, it isn't going to happen.
>>>>
>>>
>>>  I'm not sure that's true - I can read in a raster from a geoTIFF and
>>> get a colour table from it, then plot will show it with the right
>>> colours - here's a Land Use tiff:
>>>
>>>> lu
>>> class       : RasterLayer
>>> dimensions  : 397, 413, 163961  (nrow, ncol, ncell)
>>> resolution  : 100, 100  (x, y)
>>> extent      : 3356200, 3397500, 3533200, 3572900  (xmin, xmax, ymin, ymax)
>>> coord. ref. : +proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000
>>> +ellps=GRS80 +units=m +no_defs
>>> data source : /data/rowlings/MapLibrary/Europe/UK/IsleOfMan/iomcorine.tiff
>>> names       : iomcorine
>>> values      : 0, 255  (min, max)
>>>
>>>> lu at legend@colortable[1:10]
>>>  [1] "#000000" "#E6004D" "#FF0000" "#CC4DF2" "#CC0000" "#E6CCCC" "#E6CCE6"
>>>  [8] "#A600CC" "#A64D00" "#FF4DFF"
>>>
>>>
>>>  Support for this is minimal in package:raster, and I think what Agus
>>> is trying to do (correct me if wrong) is create a raster with a colour
>>> table such as this from R. If I just use writeRaster I get a numeric
>>> raster with no palette.
>>>
>>> I think Robert has talked about better support for paletted rasters in the past.
>>>
>>> Barry
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Roger.Bivand at nhh.no  Thu Jan  3 20:20:43 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 3 Jan 2013 20:20:43 +0100
Subject: [R-sig-Geo] gdal color tables
In-Reply-To: <CAG4NReLRsBFrqSjcUdko4RVyMFBvrrx+OT3nEm28u9gVtuz-2w@mail.gmail.com>
References: <e34b82729aed4b3f9b38cab5c8243770@EX-1-HT0.lancs.local>
	<CANVKczPSLFLN4vj7viF46Fgj6QgwK9dkshWYABwLb1JG-Oq4ug@mail.gmail.com>
	<CAG4NReKWW=ptKztB+txMye_0ym7_tUi+TeZqAOTMY7tdxhH9+A@mail.gmail.com>
	<alpine.LRH.2.02.1212231529180.26107@reclus.nhh.no>
	<CAG4NReLiSLK9W0VA6hq5B6AT5+uOL=Bo0Ak1cntjwdQ5xHwh4A@mail.gmail.com>
	<da346ab4f5bd4563918623ef0b210404@EX-1-HT0.lancs.local>
	<bd3d6d241f90457a891f72e124a33ff8@EX-0-HT0.lancs.local>
	<605df35965554cd39d3a44c635458589@EX-0-HT0.lancs.local>
	<CANVKczOONGzE+bXOmorftsGc-LpC=RfTYhxX-6npmkLkNerXqA@mail.gmail.com>
	<CAG4NReLRsBFrqSjcUdko4RVyMFBvrrx+OT3nEm28u9gVtuz-2w@mail.gmail.com>
Message-ID: <alpine.LRH.2.02.1301032018020.19385@reclus.nhh.no>

On Thu, 3 Jan 2013, Agustin Lobo wrote:

> Happy 2013 to everyone!
> Thanks Barry, very useful page.
> Nevertheless, I think the equivalent to zlim in plot() should be
> included also, because most of the time
> we use standard palettes that must be applied to the particular range
> of interest of the raster(s) (note
> real raster data often has outliers), i.e.:
> plot(r,col=matlab.like(64),zlim=c(20,50))
>

This is exactly why I referred to classInt, which returns the indices 
that you must have to attach a color table to a file. With a color table, 
the indices (zero-based) point to rows in the color table, so using 
findIntervals() or similar as used in classInt is the obvious route to 
provide standard palettes.

Roger

> The same would be useful for makePalette(). Currentely, my raster is
> almost all black if use
> writePaletteVRT("test.vrt", rin, matlab.like(64))
> system("python addPalette.py test.vrt test.tif")
>
> By now i'll use plot() to write a jpeg with the appropriate zlim and
> use attachpct.py to apply
> the palette to all rasters, or extract the tuned palette from the
> output of plot() and use your functions
> as they are now. By some reason I'm having problems with raster on my
> home computer and
> cannot use plot(), but will try
> tomorrow from the office. I'll let you know.
>
> Agus
>
> On Thu, Dec 27, 2012 at 11:35 PM, Barry Rowlingson
> <b.rowlingson at lancaster.ac.uk> wrote:
>> How to create colour-paletted rasters using R and Python:
>>
>> http://www.rpubs.com/geospacedman/rasterColourPalettes
>>
>> It would be great to be able to do this solely from R using either
>> raster or rgdal, and to have the couple of bugs with paletted rasters
>> in package:raster mentioned in the Rpubs doc fixed. I shall try and
>> raise this with Robert H when everyone comes out of hibernation in
>> January.
>>
>> On Sun, Dec 23, 2012 at 9:51 PM, Rowlingson, Barry
>> <b.rowlingson at lancaster.ac.uk> wrote:
>>> Here's a solution:
>>>
>>> makePalette <- function(colourvector){
>>>   cmat = cbind(t(col2rgb(colourvector)),255)
>>>   res = apply(cmat,1,function(x){sprintf('<Entry c1="%s" c2="%s"
>>> c3="%s" c4="%s"/>',x[1],x[2],x[3],x[4])})
>>>   res = paste(res,collapse="\n")
>>>   res
>>> }
>>>
>>>
>>> Then:
>>>
>>>  write a raster tiff
>>>
>>>  writeRaster(iom,"test.tif",overwrite=TRUE,datatype="INT1U")
>>>
>>>
>>> Then use makePalette to create the colortable lines:
>>>
>>> cat(makePalette(iom at legend@colortable)) # replace
>>> iom at legend@colortable with your colour table vector
>>>
>>> That spits out a bunch of <Entry> lines. Stick them in your .vrt file thus:
>>>
>>> <VRTDataset rasterXSize="413" rasterYSize="397">
>>>   <VRTRasterBand dataType="Byte" band="1">
>>>     <ColorInterp>Palette</ColorInterp>
>>> <SimpleSource>
>>> <SourceFilename relativeToVRT="1">test.tif</SourceFilename>
>>> </SimpleSource>
>>>     <ColorTable>
>>> <Entry c1="0" c2="0" c3="0" c4="255"/>
>>> <Entry c1="230" c2="0" c3="77" c4="255"/>
>>> <Entry c1="255" c2="0" c3="0" c4="255"/>
>>> <Entry c1="204" c2="77" c3="242" c4="255"/>
>>> <Entry c1="204" c2="0" c3="0" c4="255"/>
>>> [etc]
>>>    </ColorTable>
>>>   </VRTRasterBand>
>>> </VRTDataset>
>>>
>>> Note you have to fill in the rasterXSize and rasterYSize, and the
>>> source filename. Also you'll need to get the geotransform of the
>>> original and stick that in otherwise your raster is geolocated at
>>> (1:Nrows, 1:Ncolumns).
>>>
>>> If I do all that, I get a raster created by R that I can read into
>>> QGis and is coloured according to my colour scheme, as long as I open
>>> *test.vrt* in QGis and *not* test.tif.
>>>
>>> I'm sorry this isn't (yet) a one-shot solution, and its a bit of a
>>> construction set. Like I said, two minute job, twenty minute job to do
>>> properly... I've spent ten minutes on it :)
>>>
>>> Barry
>>>
>>>
>>>
>>>
>>> On Sun, Dec 23, 2012 at 9:25 PM, Rowlingson, Barry
>>> <b.rowlingson at lancaster.ac.uk> wrote:
>>>> On Sun, Dec 23, 2012 at 8:23 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>>>>
>>>>> There is no support in raster or sp objects for symbology, and unless
>>>>> someone extends the classes to accommodate symbology on a dynamic
>>>>> by-attribute basis, it isn't going to happen.
>>>>>
>>>>
>>>>  I'm not sure that's true - I can read in a raster from a geoTIFF and
>>>> get a colour table from it, then plot will show it with the right
>>>> colours - here's a Land Use tiff:
>>>>
>>>>> lu
>>>> class       : RasterLayer
>>>> dimensions  : 397, 413, 163961  (nrow, ncol, ncell)
>>>> resolution  : 100, 100  (x, y)
>>>> extent      : 3356200, 3397500, 3533200, 3572900  (xmin, xmax, ymin, ymax)
>>>> coord. ref. : +proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000
>>>> +ellps=GRS80 +units=m +no_defs
>>>> data source : /data/rowlings/MapLibrary/Europe/UK/IsleOfMan/iomcorine.tiff
>>>> names       : iomcorine
>>>> values      : 0, 255  (min, max)
>>>>
>>>>> lu at legend@colortable[1:10]
>>>>  [1] "#000000" "#E6004D" "#FF0000" "#CC4DF2" "#CC0000" "#E6CCCC" "#E6CCE6"
>>>>  [8] "#A600CC" "#A64D00" "#FF4DFF"
>>>>
>>>>
>>>>  Support for this is minimal in package:raster, and I think what Agus
>>>> is trying to do (correct me if wrong) is create a raster with a colour
>>>> table such as this from R. If I just use writeRaster I get a numeric
>>>> raster with no palette.
>>>>
>>>> I think Robert has talked about better support for paletted rasters in the past.
>>>>
>>>> Barry
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From eboyd3 at tigers.lsu.edu  Thu Jan  3 22:24:28 2013
From: eboyd3 at tigers.lsu.edu (Ezra Boyd)
Date: Thu, 3 Jan 2013 15:24:28 -0600
Subject: [R-sig-Geo] how to use my data
In-Reply-To: <20121228033315.9F48F730002@webmail.sinamail.sina.com.cn>
References: <20121228033315.9F48F730002@webmail.sinamail.sina.com.cn>
Message-ID: <CAPo57m_VZpY5=Rr8MNaZ=zGMHe9umrCZFYNj9NsdvKoXyUyYUw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130103/549ca90f/attachment.pl>

From jfeighery at gmail.com  Thu Jan  3 22:54:38 2013
From: jfeighery at gmail.com (jfeighery)
Date: Thu, 3 Jan 2013 13:54:38 -0800 (PST)
Subject: [R-sig-Geo] Calculate matrix of distances from points to multiple
	polygons
Message-ID: <1357250078374-7582204.post@n2.nabble.com>

Dear all,I am trying to create a matrix of distances between wells and all
nearby ponds that will be used to calculate a contamination risk variable
(the equivalent of Generate Near Table in ArcGIS). The wells locations and
pond polygons were imported from shapefiles as SpatialPointsDataFrame and
SpatialPolygonsDataFrame, respectively. Through searching this forum, I
found solutions that work for two sets of points (e.g. crossdist in
{spatstat}) or two sets of polygons. The function dist2Line {geosphere}
works but appears to only find the distance to the nearest polygon. I am
hoping that there is a way to do this for each polygon without resorting to
writing a function with a for loop. Thanks in advance for any help or
advice!John



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Calculate-matrix-of-distances-from-points-to-multiple-polygons-tp7582204.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From pingyang.whu at gmail.com  Thu Jan  3 23:09:31 2013
From: pingyang.whu at gmail.com (ping yang)
Date: Thu, 3 Jan 2013 17:09:31 -0500
Subject: [R-sig-Geo] Spatial Statistics for NetCDF files in R
Message-ID: <CAK8gSG9gzpWr4E1_L=U6CEaGu79gQ1BBiOajfPu0Y7poJVm6QQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130103/cb85d74e/attachment.pl>

From lyndon.estes at gmail.com  Fri Jan  4 04:37:53 2013
From: lyndon.estes at gmail.com (Lyndon Estes)
Date: Thu, 3 Jan 2013 22:37:53 -0500
Subject: [R-sig-Geo] Raster crosstab output: -1 values?
In-Reply-To: <006001cde946$d8039b70$880ad250$@anu.edu.au>
References: <1355958193522-7582028.post@n2.nabble.com>
	<CALuVVaZUvow6oksZ-0ZTdSyVys2VuK+xn3UVdkVR2jBhYqRDmA@mail.gmail.com>
	<006001cde946$d8039b70$880ad250$@anu.edu.au>
Message-ID: <CALuVVaZeEcdQqPJ4yK_+4+8DoP1Nj-7=KkNh32uK6U6-28PdWQ@mail.gmail.com>

Hi Megan,

You might be able to do both the resampling and reprojecting quite
handily with gdal, using a system call out of R.

Here are some lines from one of my scripts (I haven't looked at this
in a while and haven't verified now, so caveat emptor) that might
help:

# lc is a landsat landcover I was working with
TARGET_SRS <- "SR-ORG:6842" # Your projection. See spatialreference.org
TARGET_EXTENT <- paste(extent(lc)@xmin, extent(lc)@ymin,
extent(lc)@xmax, extent(lc)@ymax)
# In target units!
TARGET_RES <- "30" # Whatever you want the output resolution to be
output_name <- "your_grid_name.tif"
gdcall <- "/Library/Frameworks/GDAL.framework/Programs/gdalwarp"  #
path to gdalwarp on my mac
gdwarp <- paste(gdcall, "-t_srs", TARGET_SRS,  "-te", TARGET_EXTENT,
"-tr", TARGET_RES, lc at file@name,
                           "-of GTiff -co 'COMPRESS=LZW'", output_name)
# In the above you will probably want to insert the -r option with
bilinear specified (e.g. "-r bilinear" worked
# into the paste command), otherwise you will have a nearest neighbor
resample done.
setwd("path/where/your/grids/live")
system(gdwarp, intern = F)

Hope it works, but if so it should be pretty quick.  Note, you can
also specify NA values:

http://www.gdal.org/gdalwarp.html

Best, Lyndon


From b.rowlingson at lancaster.ac.uk  Fri Jan  4 10:13:34 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Fri, 4 Jan 2013 09:13:34 +0000
Subject: [R-sig-Geo] gdal color tables
In-Reply-To: <95454b871f404d2e9e1bbcdc22e0d5ae@EX-1-HT0.lancs.local>
References: <e34b82729aed4b3f9b38cab5c8243770@EX-1-HT0.lancs.local>
	<CANVKczPSLFLN4vj7viF46Fgj6QgwK9dkshWYABwLb1JG-Oq4ug@mail.gmail.com>
	<CAG4NReKWW=ptKztB+txMye_0ym7_tUi+TeZqAOTMY7tdxhH9+A@mail.gmail.com>
	<alpine.LRH.2.02.1212231529180.26107@reclus.nhh.no>
	<CAG4NReLiSLK9W0VA6hq5B6AT5+uOL=Bo0Ak1cntjwdQ5xHwh4A@mail.gmail.com>
	<da346ab4f5bd4563918623ef0b210404@EX-1-HT0.lancs.local>
	<bd3d6d241f90457a891f72e124a33ff8@EX-0-HT0.lancs.local>
	<605df35965554cd39d3a44c635458589@EX-0-HT0.lancs.local>
	<CANVKczOONGzE+bXOmorftsGc-LpC=RfTYhxX-6npmkLkNerXqA@mail.gmail.com>
	<95454b871f404d2e9e1bbcdc22e0d5ae@EX-1-HT0.lancs.local>
Message-ID: <CANVKczOb0iSZzYw6MJsJu_qT2qNtLFyeJq79R9TQPL6juwstXQ@mail.gmail.com>

On Thu, Jan 3, 2013 at 7:06 PM, Agustin Lobo <alobolistas at gmail.com> wrote:
> Happy 2013 to everyone!
> Thanks Barry, very useful page.
> Nevertheless, I think the equivalent to zlim in plot() should be
> included also, because most of the time
> we use standard palettes that must be applied to the particular range
> of interest of the raster(s) (note
> real raster data often has outliers), i.e.:
> plot(r,col=matlab.like(64),zlim=c(20,50))

 My only concern here was with categorical rasters, where the values
(and hence the colours) are only meaningful with a label. For example
20=Deciduous Forest, 21=PIne Forest, 22=Burnt Forest, 10=Meadow,
12=Urban, and so on. In this context I don't see a need to restrict
plotting with zlim because the idea of 'limits' for a non-continuous
variable is a bit odd. You might want to get all the forest-related
variables and so plot everything from 20 to 29, but if your interest
is forestry then you should probably select those categories from the
raster into a new raster.

My intention wasn't to create a generic value-colour palette handling system.

I've also written some code that works with legend to display legends
for categorical data. I don't really want to release it until the
raster package decides what RasterLegend objects are all about...

Barry


From b.rowlingson at lancaster.ac.uk  Fri Jan  4 10:43:30 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Fri, 4 Jan 2013 09:43:30 +0000
Subject: [R-sig-Geo] Calculate matrix of distances from points to
	multiple polygons
In-Reply-To: <3c88411248e7421eac3902cb8c4db084@EX-0-HT0.lancs.local>
References: <3c88411248e7421eac3902cb8c4db084@EX-0-HT0.lancs.local>
Message-ID: <CANVKczMdHCTt4brUQWhBWh4bS6Hdg2VDve3RRXmsVZh1HCPa7A@mail.gmail.com>

On Thu, Jan 3, 2013 at 9:54 PM, jfeighery <jfeighery at gmail.com> wrote:
> Dear all,I am trying to create a matrix of distances between wells and all
> nearby ponds that will be used to calculate a contamination risk variable
> (the equivalent of Generate Near Table in ArcGIS). The wells locations and
> pond polygons were imported from shapefiles as SpatialPointsDataFrame and
> SpatialPolygonsDataFrame, respectively. Through searching this forum, I
> found solutions that work for two sets of points (e.g. crossdist in
> {spatstat}) or two sets of polygons. The function dist2Line {geosphere}
> works but appears to only find the distance to the nearest polygon. I am
> hoping that there is a way to do this for each polygon without resorting to
> writing a function with a for loop. Thanks in advance for any help or
> advice!John
>

 I think you want gDistance in package:rgeos. If 'ponds' is a
SpatialPolygonsDataFrame with two ponds in it, and pts is a
SpatialPointsDataFrame with 10 wells in it, then:

 > gDistance(ponds,pts,byid=TRUE)
           2         1
1  1.7668458 0.0000000
2  2.2301705 0.0000000
3  2.5487968 0.1181480
4  0.0000000 2.0410047
5  2.6075170 0.0000000
6  1.3145692 0.4563602
7  1.4300834 0.1179114
8  0.0000000 1.0461675
9  0.7633464 0.5052239
10 2.2691795 0.0000000

is all the well-pond nearest distances. Note the zeroes where the well
is inside the pond. I'm not sure what the distance will be if the well
is on an island in a pond...

Once you've got that then its a simple matter to find the nearest. If
you have a massive dataset and really only want to find the nearest
then this procedure might be slow and we'll have to think of something
else...

Barry


From alobolistas at gmail.com  Fri Jan  4 11:50:08 2013
From: alobolistas at gmail.com (Agustin Lobo)
Date: Fri, 4 Jan 2013 11:50:08 +0100
Subject: [R-sig-Geo] gdal color tables
In-Reply-To: <alpine.LRH.2.02.1301032018020.19385@reclus.nhh.no>
References: <e34b82729aed4b3f9b38cab5c8243770@EX-1-HT0.lancs.local>
	<CANVKczPSLFLN4vj7viF46Fgj6QgwK9dkshWYABwLb1JG-Oq4ug@mail.gmail.com>
	<CAG4NReKWW=ptKztB+txMye_0ym7_tUi+TeZqAOTMY7tdxhH9+A@mail.gmail.com>
	<alpine.LRH.2.02.1212231529180.26107@reclus.nhh.no>
	<CAG4NReLiSLK9W0VA6hq5B6AT5+uOL=Bo0Ak1cntjwdQ5xHwh4A@mail.gmail.com>
	<da346ab4f5bd4563918623ef0b210404@EX-1-HT0.lancs.local>
	<bd3d6d241f90457a891f72e124a33ff8@EX-0-HT0.lancs.local>
	<605df35965554cd39d3a44c635458589@EX-0-HT0.lancs.local>
	<CANVKczOONGzE+bXOmorftsGc-LpC=RfTYhxX-6npmkLkNerXqA@mail.gmail.com>
	<CAG4NReLRsBFrqSjcUdko4RVyMFBvrrx+OT3nEm28u9gVtuz-2w@mail.gmail.com>
	<alpine.LRH.2.02.1301032018020.19385@reclus.nhh.no>
Message-ID: <CAG4NReK2VntrHfCnO5OZJ2GkM7Lj8EiACESjDWQRBDjr8cdXoQ@mail.gmail.com>

Yes, using classIntervals() is not hard, but note that the VRT table
does not have a values field. This is not
a problem for unsigned integer8 tif files (i.e., for landcover raster
maps) but it is in the case of raster
files of float values (i.e., many of my aerial thermograms).  I presume
gdal tif files make a linear interpolation between the min to the max
value in this case , but I really cannot dig
into it myself right now.

But I also have a set of thermograms as 8bit images, so for those I
can hack Barry's functions with classIntervals()

For the thermograms in 16bits integers and floating values, what I can
do is to modify Barry's functions to write a QGIS qml , very similar
to the table in the VRT file but
including a values field.

Agus

On Thu, Jan 3, 2013 at 8:20 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> On Thu, 3 Jan 2013, Agustin Lobo wrote:
>
>> Happy 2013 to everyone!
>> Thanks Barry, very useful page.
>> Nevertheless, I think the equivalent to zlim in plot() should be
>> included also, because most of the time
>> we use standard palettes that must be applied to the particular range
>> of interest of the raster(s) (note
>> real raster data often has outliers), i.e.:
>> plot(r,col=matlab.like(64),zlim=c(20,50))
>>
>
> This is exactly why I referred to classInt, which returns the indices that
> you must have to attach a color table to a file. With a color table, the
> indices (zero-based) point to rows in the color table, so using
> findIntervals() or similar as used in classInt is the obvious route to
> provide standard palettes.
>
> Roger
>
>
>> The same would be useful for makePalette(). Currentely, my raster is
>> almost all black if use
>> writePaletteVRT("test.vrt", rin, matlab.like(64))
>> system("python addPalette.py test.vrt test.tif")
>>
>> By now i'll use plot() to write a jpeg with the appropriate zlim and
>> use attachpct.py to apply
>> the palette to all rasters, or extract the tuned palette from the
>> output of plot() and use your functions
>> as they are now. By some reason I'm having problems with raster on my
>> home computer and
>> cannot use plot(), but will try
>> tomorrow from the office. I'll let you know.
>>
>> Agus
>>
>> On Thu, Dec 27, 2012 at 11:35 PM, Barry Rowlingson
>> <b.rowlingson at lancaster.ac.uk> wrote:
>>>
>>> How to create colour-paletted rasters using R and Python:
>>>
>>> http://www.rpubs.com/geospacedman/rasterColourPalettes
>>>
>>> It would be great to be able to do this solely from R using either
>>> raster or rgdal, and to have the couple of bugs with paletted rasters
>>> in package:raster mentioned in the Rpubs doc fixed. I shall try and
>>> raise this with Robert H when everyone comes out of hibernation in
>>> January.
>>>
>>> On Sun, Dec 23, 2012 at 9:51 PM, Rowlingson, Barry
>>> <b.rowlingson at lancaster.ac.uk> wrote:
>>>>
>>>> Here's a solution:
>>>>
>>>> makePalette <- function(colourvector){
>>>>   cmat = cbind(t(col2rgb(colourvector)),255)
>>>>   res = apply(cmat,1,function(x){sprintf('<Entry c1="%s" c2="%s"
>>>> c3="%s" c4="%s"/>',x[1],x[2],x[3],x[4])})
>>>>   res = paste(res,collapse="\n")
>>>>   res
>>>> }
>>>>
>>>>
>>>> Then:
>>>>
>>>>  write a raster tiff
>>>>
>>>>  writeRaster(iom,"test.tif",overwrite=TRUE,datatype="INT1U")
>>>>
>>>>
>>>> Then use makePalette to create the colortable lines:
>>>>
>>>> cat(makePalette(iom at legend@colortable)) # replace
>>>> iom at legend@colortable with your colour table vector
>>>>
>>>> That spits out a bunch of <Entry> lines. Stick them in your .vrt file
>>>> thus:
>>>>
>>>> <VRTDataset rasterXSize="413" rasterYSize="397">
>>>>   <VRTRasterBand dataType="Byte" band="1">
>>>>     <ColorInterp>Palette</ColorInterp>
>>>> <SimpleSource>
>>>> <SourceFilename relativeToVRT="1">test.tif</SourceFilename>
>>>> </SimpleSource>
>>>>     <ColorTable>
>>>> <Entry c1="0" c2="0" c3="0" c4="255"/>
>>>> <Entry c1="230" c2="0" c3="77" c4="255"/>
>>>> <Entry c1="255" c2="0" c3="0" c4="255"/>
>>>> <Entry c1="204" c2="77" c3="242" c4="255"/>
>>>> <Entry c1="204" c2="0" c3="0" c4="255"/>
>>>> [etc]
>>>>    </ColorTable>
>>>>   </VRTRasterBand>
>>>> </VRTDataset>
>>>>
>>>> Note you have to fill in the rasterXSize and rasterYSize, and the
>>>> source filename. Also you'll need to get the geotransform of the
>>>> original and stick that in otherwise your raster is geolocated at
>>>> (1:Nrows, 1:Ncolumns).
>>>>
>>>> If I do all that, I get a raster created by R that I can read into
>>>> QGis and is coloured according to my colour scheme, as long as I open
>>>> *test.vrt* in QGis and *not* test.tif.
>>>>
>>>> I'm sorry this isn't (yet) a one-shot solution, and its a bit of a
>>>> construction set. Like I said, two minute job, twenty minute job to do
>>>> properly... I've spent ten minutes on it :)
>>>>
>>>> Barry
>>>>
>>>>
>>>>
>>>>
>>>> On Sun, Dec 23, 2012 at 9:25 PM, Rowlingson, Barry
>>>> <b.rowlingson at lancaster.ac.uk> wrote:
>>>>>
>>>>> On Sun, Dec 23, 2012 at 8:23 PM, Roger Bivand <Roger.Bivand at nhh.no>
>>>>> wrote:
>>>>>
>>>>>> There is no support in raster or sp objects for symbology, and unless
>>>>>> someone extends the classes to accommodate symbology on a dynamic
>>>>>> by-attribute basis, it isn't going to happen.
>>>>>>
>>>>>
>>>>>  I'm not sure that's true - I can read in a raster from a geoTIFF and
>>>>> get a colour table from it, then plot will show it with the right
>>>>> colours - here's a Land Use tiff:
>>>>>
>>>>>> lu
>>>>>
>>>>> class       : RasterLayer
>>>>> dimensions  : 397, 413, 163961  (nrow, ncol, ncell)
>>>>> resolution  : 100, 100  (x, y)
>>>>> extent      : 3356200, 3397500, 3533200, 3572900  (xmin, xmax, ymin,
>>>>> ymax)
>>>>> coord. ref. : +proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000
>>>>> +ellps=GRS80 +units=m +no_defs
>>>>> data source :
>>>>> /data/rowlings/MapLibrary/Europe/UK/IsleOfMan/iomcorine.tiff
>>>>> names       : iomcorine
>>>>> values      : 0, 255  (min, max)
>>>>>
>>>>>> lu at legend@colortable[1:10]
>>>>>
>>>>>  [1] "#000000" "#E6004D" "#FF0000" "#CC4DF2" "#CC0000" "#E6CCCC"
>>>>> "#E6CCE6"
>>>>>  [8] "#A600CC" "#A64D00" "#FF4DFF"
>>>>>
>>>>>
>>>>>  Support for this is minimal in package:raster, and I think what Agus
>>>>> is trying to do (correct me if wrong) is create a raster with a colour
>>>>> table such as this from R. If I just use writeRaster I get a numeric
>>>>> raster with no palette.
>>>>>
>>>>> I think Robert has talked about better support for paletted rasters in
>>>>> the past.
>>>>>
>>>>> Barry
>>>>>
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>
> --
> Roger Bivand
> Department of Economics, NHH Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Roger.Bivand at nhh.no  Fri Jan  4 12:00:26 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 4 Jan 2013 12:00:26 +0100
Subject: [R-sig-Geo] gdal color tables
In-Reply-To: <CAG4NReK2VntrHfCnO5OZJ2GkM7Lj8EiACESjDWQRBDjr8cdXoQ@mail.gmail.com>
References: <e34b82729aed4b3f9b38cab5c8243770@EX-1-HT0.lancs.local>
	<CANVKczPSLFLN4vj7viF46Fgj6QgwK9dkshWYABwLb1JG-Oq4ug@mail.gmail.com>
	<CAG4NReKWW=ptKztB+txMye_0ym7_tUi+TeZqAOTMY7tdxhH9+A@mail.gmail.com>
	<alpine.LRH.2.02.1212231529180.26107@reclus.nhh.no>
	<CAG4NReLiSLK9W0VA6hq5B6AT5+uOL=Bo0Ak1cntjwdQ5xHwh4A@mail.gmail.com>
	<da346ab4f5bd4563918623ef0b210404@EX-1-HT0.lancs.local>
	<bd3d6d241f90457a891f72e124a33ff8@EX-0-HT0.lancs.local>
	<605df35965554cd39d3a44c635458589@EX-0-HT0.lancs.local>
	<CANVKczOONGzE+bXOmorftsGc-LpC=RfTYhxX-6npmkLkNerXqA@mail.gmail.com>
	<CAG4NReLRsBFrqSjcUdko4RVyMFBvrrx+OT3nEm28u9gVtuz-2w@mail.gmail.com>
	<alpine.LRH.2.02.1301032018020.19385@reclus.nhh.no>
	<CAG4NReK2VntrHfCnO5OZJ2GkM7Lj8EiACESjDWQRBDjr8cdXoQ@mail.gmail.com>
Message-ID: <alpine.LRH.2.02.1301041151590.22285@reclus.nhh.no>

On Fri, 4 Jan 2013, Agustin Lobo wrote:

> Yes, using classIntervals() is not hard, but note that the VRT table
> does not have a values field. This is not
> a problem for unsigned integer8 tif files (i.e., for landcover raster
> maps) but it is in the case of raster
> files of float values (i.e., many of my aerial thermograms).  I presume
> gdal tif files make a linear interpolation between the min to the max
> value in this case , but I really cannot dig
> into it myself right now.

The GDAL implementation of color tables only works internally for Byte 
valued rasters - try assigning to say a Float32, and GDAL refuses to add 
the table. I don't know how this works in the GDAL/Python implementation, 
but it cannot do more than the GDAL base functionality. There are internal 
color ramp functions in GDAL, but there are no break points or 
quantization rules (that you find in GRASS, which supports color tables 
for floating point rasters).

If you treat classIntervals() as a way of creating quantization rules, you 
can store the floating point values in one file, and the quantized 0-255 
(or fewer) values in a Byte file.

I do see references to quantization in GDAL for specific drivers, such as 
PNG, but not as a general facility - does anyone know whether such a 
facility exists (to add quantized color tables and rules to arbitrary 
raster bands)?

Roger

>
> But I also have a set of thermograms as 8bit images, so for those I
> can hack Barry's functions with classIntervals()
>
> For the thermograms in 16bits integers and floating values, what I can
> do is to modify Barry's functions to write a QGIS qml , very similar
> to the table in the VRT file but
> including a values field.
>
> Agus
>
> On Thu, Jan 3, 2013 at 8:20 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>> On Thu, 3 Jan 2013, Agustin Lobo wrote:
>>
>>> Happy 2013 to everyone!
>>> Thanks Barry, very useful page.
>>> Nevertheless, I think the equivalent to zlim in plot() should be
>>> included also, because most of the time
>>> we use standard palettes that must be applied to the particular range
>>> of interest of the raster(s) (note
>>> real raster data often has outliers), i.e.:
>>> plot(r,col=matlab.like(64),zlim=c(20,50))
>>>
>>
>> This is exactly why I referred to classInt, which returns the indices that
>> you must have to attach a color table to a file. With a color table, the
>> indices (zero-based) point to rows in the color table, so using
>> findIntervals() or similar as used in classInt is the obvious route to
>> provide standard palettes.
>>
>> Roger
>>
>>
>>> The same would be useful for makePalette(). Currentely, my raster is
>>> almost all black if use
>>> writePaletteVRT("test.vrt", rin, matlab.like(64))
>>> system("python addPalette.py test.vrt test.tif")
>>>
>>> By now i'll use plot() to write a jpeg with the appropriate zlim and
>>> use attachpct.py to apply
>>> the palette to all rasters, or extract the tuned palette from the
>>> output of plot() and use your functions
>>> as they are now. By some reason I'm having problems with raster on my
>>> home computer and
>>> cannot use plot(), but will try
>>> tomorrow from the office. I'll let you know.
>>>
>>> Agus
>>>
>>> On Thu, Dec 27, 2012 at 11:35 PM, Barry Rowlingson
>>> <b.rowlingson at lancaster.ac.uk> wrote:
>>>>
>>>> How to create colour-paletted rasters using R and Python:
>>>>
>>>> http://www.rpubs.com/geospacedman/rasterColourPalettes
>>>>
>>>> It would be great to be able to do this solely from R using either
>>>> raster or rgdal, and to have the couple of bugs with paletted rasters
>>>> in package:raster mentioned in the Rpubs doc fixed. I shall try and
>>>> raise this with Robert H when everyone comes out of hibernation in
>>>> January.
>>>>
>>>> On Sun, Dec 23, 2012 at 9:51 PM, Rowlingson, Barry
>>>> <b.rowlingson at lancaster.ac.uk> wrote:
>>>>>
>>>>> Here's a solution:
>>>>>
>>>>> makePalette <- function(colourvector){
>>>>>   cmat = cbind(t(col2rgb(colourvector)),255)
>>>>>   res = apply(cmat,1,function(x){sprintf('<Entry c1="%s" c2="%s"
>>>>> c3="%s" c4="%s"/>',x[1],x[2],x[3],x[4])})
>>>>>   res = paste(res,collapse="\n")
>>>>>   res
>>>>> }
>>>>>
>>>>>
>>>>> Then:
>>>>>
>>>>>  write a raster tiff
>>>>>
>>>>>  writeRaster(iom,"test.tif",overwrite=TRUE,datatype="INT1U")
>>>>>
>>>>>
>>>>> Then use makePalette to create the colortable lines:
>>>>>
>>>>> cat(makePalette(iom at legend@colortable)) # replace
>>>>> iom at legend@colortable with your colour table vector
>>>>>
>>>>> That spits out a bunch of <Entry> lines. Stick them in your .vrt file
>>>>> thus:
>>>>>
>>>>> <VRTDataset rasterXSize="413" rasterYSize="397">
>>>>>   <VRTRasterBand dataType="Byte" band="1">
>>>>>     <ColorInterp>Palette</ColorInterp>
>>>>> <SimpleSource>
>>>>> <SourceFilename relativeToVRT="1">test.tif</SourceFilename>
>>>>> </SimpleSource>
>>>>>     <ColorTable>
>>>>> <Entry c1="0" c2="0" c3="0" c4="255"/>
>>>>> <Entry c1="230" c2="0" c3="77" c4="255"/>
>>>>> <Entry c1="255" c2="0" c3="0" c4="255"/>
>>>>> <Entry c1="204" c2="77" c3="242" c4="255"/>
>>>>> <Entry c1="204" c2="0" c3="0" c4="255"/>
>>>>> [etc]
>>>>>    </ColorTable>
>>>>>   </VRTRasterBand>
>>>>> </VRTDataset>
>>>>>
>>>>> Note you have to fill in the rasterXSize and rasterYSize, and the
>>>>> source filename. Also you'll need to get the geotransform of the
>>>>> original and stick that in otherwise your raster is geolocated at
>>>>> (1:Nrows, 1:Ncolumns).
>>>>>
>>>>> If I do all that, I get a raster created by R that I can read into
>>>>> QGis and is coloured according to my colour scheme, as long as I open
>>>>> *test.vrt* in QGis and *not* test.tif.
>>>>>
>>>>> I'm sorry this isn't (yet) a one-shot solution, and its a bit of a
>>>>> construction set. Like I said, two minute job, twenty minute job to do
>>>>> properly... I've spent ten minutes on it :)
>>>>>
>>>>> Barry
>>>>>
>>>>>
>>>>>
>>>>>
>>>>> On Sun, Dec 23, 2012 at 9:25 PM, Rowlingson, Barry
>>>>> <b.rowlingson at lancaster.ac.uk> wrote:
>>>>>>
>>>>>> On Sun, Dec 23, 2012 at 8:23 PM, Roger Bivand <Roger.Bivand at nhh.no>
>>>>>> wrote:
>>>>>>
>>>>>>> There is no support in raster or sp objects for symbology, and unless
>>>>>>> someone extends the classes to accommodate symbology on a dynamic
>>>>>>> by-attribute basis, it isn't going to happen.
>>>>>>>
>>>>>>
>>>>>>  I'm not sure that's true - I can read in a raster from a geoTIFF and
>>>>>> get a colour table from it, then plot will show it with the right
>>>>>> colours - here's a Land Use tiff:
>>>>>>
>>>>>>> lu
>>>>>>
>>>>>> class       : RasterLayer
>>>>>> dimensions  : 397, 413, 163961  (nrow, ncol, ncell)
>>>>>> resolution  : 100, 100  (x, y)
>>>>>> extent      : 3356200, 3397500, 3533200, 3572900  (xmin, xmax, ymin,
>>>>>> ymax)
>>>>>> coord. ref. : +proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000
>>>>>> +ellps=GRS80 +units=m +no_defs
>>>>>> data source :
>>>>>> /data/rowlings/MapLibrary/Europe/UK/IsleOfMan/iomcorine.tiff
>>>>>> names       : iomcorine
>>>>>> values      : 0, 255  (min, max)
>>>>>>
>>>>>>> lu at legend@colortable[1:10]
>>>>>>
>>>>>>  [1] "#000000" "#E6004D" "#FF0000" "#CC4DF2" "#CC0000" "#E6CCCC"
>>>>>> "#E6CCE6"
>>>>>>  [8] "#A600CC" "#A64D00" "#FF4DFF"
>>>>>>
>>>>>>
>>>>>>  Support for this is minimal in package:raster, and I think what Agus
>>>>>> is trying to do (correct me if wrong) is create a raster with a colour
>>>>>> table such as this from R. If I just use writeRaster I get a numeric
>>>>>> raster with no palette.
>>>>>>
>>>>>> I think Robert has talked about better support for paletted rasters in
>>>>>> the past.
>>>>>>
>>>>>> Barry
>>>>>>
>>>>>> _______________________________________________
>>>>>> R-sig-Geo mailing list
>>>>>> R-sig-Geo at r-project.org
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>
>>>>>
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>>
>> --
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From alobolistas at gmail.com  Fri Jan  4 13:50:50 2013
From: alobolistas at gmail.com (Agustin Lobo)
Date: Fri, 4 Jan 2013 13:50:50 +0100
Subject: [R-sig-Geo] gdal color tables
In-Reply-To: <CAG4NReK2VntrHfCnO5OZJ2GkM7Lj8EiACESjDWQRBDjr8cdXoQ@mail.gmail.com>
References: <e34b82729aed4b3f9b38cab5c8243770@EX-1-HT0.lancs.local>
	<CANVKczPSLFLN4vj7viF46Fgj6QgwK9dkshWYABwLb1JG-Oq4ug@mail.gmail.com>
	<CAG4NReKWW=ptKztB+txMye_0ym7_tUi+TeZqAOTMY7tdxhH9+A@mail.gmail.com>
	<alpine.LRH.2.02.1212231529180.26107@reclus.nhh.no>
	<CAG4NReLiSLK9W0VA6hq5B6AT5+uOL=Bo0Ak1cntjwdQ5xHwh4A@mail.gmail.com>
	<da346ab4f5bd4563918623ef0b210404@EX-1-HT0.lancs.local>
	<bd3d6d241f90457a891f72e124a33ff8@EX-0-HT0.lancs.local>
	<605df35965554cd39d3a44c635458589@EX-0-HT0.lancs.local>
	<CANVKczOONGzE+bXOmorftsGc-LpC=RfTYhxX-6npmkLkNerXqA@mail.gmail.com>
	<CAG4NReLRsBFrqSjcUdko4RVyMFBvrrx+OT3nEm28u9gVtuz-2w@mail.gmail.com>
	<alpine.LRH.2.02.1301032018020.19385@reclus.nhh.no>
	<CAG4NReK2VntrHfCnO5OZJ2GkM7Lj8EiACESjDWQRBDjr8cdXoQ@mail.gmail.com>
Message-ID: <CAG4NReL7LxcGErp8vk9Yi5YqUaTJdomW0BMtxufsdxGs+BMvXA@mail.gmail.com>

For the case of the quantitative 8bit images, it's actually easier, just tune
the palette to zlim and then apply Barry's functions. I've made tuneZpalette:

tuneZpalette <- function(palette,ncol,zlim){
  zlim <- zlim+c(-1,1)
  micolv <- classIntervals(zlim[1]:zlim[2], n=ncol,style="equal")
  micolv <- findColours(micolv,palette(ncol))
  micolv <- c(rep(micolv[1],zlim[1]),micolv,rep(micolv[length(micolv)],255-zlim[2]))
  micolv
}

Then the following R plot:
require(colorRamps)
require(raster)
rin <- raster("test2R.tif")
plot(rin,zlim=c(99,176) ,col=matlab.like(64),main=" ",axes=FALSE)

and the tif file created by the following code:
micolv <- tuneZpalette(palette=matlab.like,ncol=64,zlim=c(100,175))
writePaletteVRT("test2R.vrt", rin, micolv)
system("python addPalette.py test2R.vrt test2R.tif")

have the same colors, distributed within the interval 100,175
(and with 0-99 as deepest blue and 176-255 as deepest red)

Agus


On Fri, Jan 4, 2013 at 11:50 AM, Agustin Lobo <alobolistas at gmail.com> wrote:
> Yes, using classIntervals() is not hard, but note that the VRT table
> does not have a values field. This is not
> a problem for unsigned integer8 tif files (i.e., for landcover raster
> maps) but it is in the case of raster
> files of float values (i.e., many of my aerial thermograms).  I presume
> gdal tif files make a linear interpolation between the min to the max
> value in this case , but I really cannot dig
> into it myself right now.
>
> But I also have a set of thermograms as 8bit images, so for those I
> can hack Barry's functions with classIntervals()
>
> For the thermograms in 16bits integers and floating values, what I can
> do is to modify Barry's functions to write a QGIS qml , very similar
> to the table in the VRT file but
> including a values field.
>
> Agus
>
> On Thu, Jan 3, 2013 at 8:20 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>> On Thu, 3 Jan 2013, Agustin Lobo wrote:
>>
>>> Happy 2013 to everyone!
>>> Thanks Barry, very useful page.
>>> Nevertheless, I think the equivalent to zlim in plot() should be
>>> included also, because most of the time
>>> we use standard palettes that must be applied to the particular range
>>> of interest of the raster(s) (note
>>> real raster data often has outliers), i.e.:
>>> plot(r,col=matlab.like(64),zlim=c(20,50))
>>>
>>
>> This is exactly why I referred to classInt, which returns the indices that
>> you must have to attach a color table to a file. With a color table, the
>> indices (zero-based) point to rows in the color table, so using
>> findIntervals() or similar as used in classInt is the obvious route to
>> provide standard palettes.
>>
>> Roger
>>
>>
>>> The same would be useful for makePalette(). Currentely, my raster is
>>> almost all black if use
>>> writePaletteVRT("test.vrt", rin, matlab.like(64))
>>> system("python addPalette.py test.vrt test.tif")
>>>
>>> By now i'll use plot() to write a jpeg with the appropriate zlim and
>>> use attachpct.py to apply
>>> the palette to all rasters, or extract the tuned palette from the
>>> output of plot() and use your functions
>>> as they are now. By some reason I'm having problems with raster on my
>>> home computer and
>>> cannot use plot(), but will try
>>> tomorrow from the office. I'll let you know.
>>>
>>> Agus
>>>
>>> On Thu, Dec 27, 2012 at 11:35 PM, Barry Rowlingson
>>> <b.rowlingson at lancaster.ac.uk> wrote:
>>>>
>>>> How to create colour-paletted rasters using R and Python:
>>>>
>>>> http://www.rpubs.com/geospacedman/rasterColourPalettes
>>>>
>>>> It would be great to be able to do this solely from R using either
>>>> raster or rgdal, and to have the couple of bugs with paletted rasters
>>>> in package:raster mentioned in the Rpubs doc fixed. I shall try and
>>>> raise this with Robert H when everyone comes out of hibernation in
>>>> January.
>>>>
>>>> On Sun, Dec 23, 2012 at 9:51 PM, Rowlingson, Barry
>>>> <b.rowlingson at lancaster.ac.uk> wrote:
>>>>>
>>>>> Here's a solution:
>>>>>
>>>>> makePalette <- function(colourvector){
>>>>>   cmat = cbind(t(col2rgb(colourvector)),255)
>>>>>   res = apply(cmat,1,function(x){sprintf('<Entry c1="%s" c2="%s"
>>>>> c3="%s" c4="%s"/>',x[1],x[2],x[3],x[4])})
>>>>>   res = paste(res,collapse="\n")
>>>>>   res
>>>>> }
>>>>>
>>>>>
>>>>> Then:
>>>>>
>>>>>  write a raster tiff
>>>>>
>>>>>  writeRaster(iom,"test.tif",overwrite=TRUE,datatype="INT1U")
>>>>>
>>>>>
>>>>> Then use makePalette to create the colortable lines:
>>>>>
>>>>> cat(makePalette(iom at legend@colortable)) # replace
>>>>> iom at legend@colortable with your colour table vector
>>>>>
>>>>> That spits out a bunch of <Entry> lines. Stick them in your .vrt file
>>>>> thus:
>>>>>
>>>>> <VRTDataset rasterXSize="413" rasterYSize="397">
>>>>>   <VRTRasterBand dataType="Byte" band="1">
>>>>>     <ColorInterp>Palette</ColorInterp>
>>>>> <SimpleSource>
>>>>> <SourceFilename relativeToVRT="1">test.tif</SourceFilename>
>>>>> </SimpleSource>
>>>>>     <ColorTable>
>>>>> <Entry c1="0" c2="0" c3="0" c4="255"/>
>>>>> <Entry c1="230" c2="0" c3="77" c4="255"/>
>>>>> <Entry c1="255" c2="0" c3="0" c4="255"/>
>>>>> <Entry c1="204" c2="77" c3="242" c4="255"/>
>>>>> <Entry c1="204" c2="0" c3="0" c4="255"/>
>>>>> [etc]
>>>>>    </ColorTable>
>>>>>   </VRTRasterBand>
>>>>> </VRTDataset>
>>>>>
>>>>> Note you have to fill in the rasterXSize and rasterYSize, and the
>>>>> source filename. Also you'll need to get the geotransform of the
>>>>> original and stick that in otherwise your raster is geolocated at
>>>>> (1:Nrows, 1:Ncolumns).
>>>>>
>>>>> If I do all that, I get a raster created by R that I can read into
>>>>> QGis and is coloured according to my colour scheme, as long as I open
>>>>> *test.vrt* in QGis and *not* test.tif.
>>>>>
>>>>> I'm sorry this isn't (yet) a one-shot solution, and its a bit of a
>>>>> construction set. Like I said, two minute job, twenty minute job to do
>>>>> properly... I've spent ten minutes on it :)
>>>>>
>>>>> Barry
>>>>>
>>>>>
>>>>>
>>>>>
>>>>> On Sun, Dec 23, 2012 at 9:25 PM, Rowlingson, Barry
>>>>> <b.rowlingson at lancaster.ac.uk> wrote:
>>>>>>
>>>>>> On Sun, Dec 23, 2012 at 8:23 PM, Roger Bivand <Roger.Bivand at nhh.no>
>>>>>> wrote:
>>>>>>
>>>>>>> There is no support in raster or sp objects for symbology, and unless
>>>>>>> someone extends the classes to accommodate symbology on a dynamic
>>>>>>> by-attribute basis, it isn't going to happen.
>>>>>>>
>>>>>>
>>>>>>  I'm not sure that's true - I can read in a raster from a geoTIFF and
>>>>>> get a colour table from it, then plot will show it with the right
>>>>>> colours - here's a Land Use tiff:
>>>>>>
>>>>>>> lu
>>>>>>
>>>>>> class       : RasterLayer
>>>>>> dimensions  : 397, 413, 163961  (nrow, ncol, ncell)
>>>>>> resolution  : 100, 100  (x, y)
>>>>>> extent      : 3356200, 3397500, 3533200, 3572900  (xmin, xmax, ymin,
>>>>>> ymax)
>>>>>> coord. ref. : +proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000
>>>>>> +ellps=GRS80 +units=m +no_defs
>>>>>> data source :
>>>>>> /data/rowlings/MapLibrary/Europe/UK/IsleOfMan/iomcorine.tiff
>>>>>> names       : iomcorine
>>>>>> values      : 0, 255  (min, max)
>>>>>>
>>>>>>> lu at legend@colortable[1:10]
>>>>>>
>>>>>>  [1] "#000000" "#E6004D" "#FF0000" "#CC4DF2" "#CC0000" "#E6CCCC"
>>>>>> "#E6CCE6"
>>>>>>  [8] "#A600CC" "#A64D00" "#FF4DFF"
>>>>>>
>>>>>>
>>>>>>  Support for this is minimal in package:raster, and I think what Agus
>>>>>> is trying to do (correct me if wrong) is create a raster with a colour
>>>>>> table such as this from R. If I just use writeRaster I get a numeric
>>>>>> raster with no palette.
>>>>>>
>>>>>> I think Robert has talked about better support for paletted rasters in
>>>>>> the past.
>>>>>>
>>>>>> Barry
>>>>>>
>>>>>> _______________________________________________
>>>>>> R-sig-Geo mailing list
>>>>>> R-sig-Geo at r-project.org
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>
>>>>>
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>>
>> --
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From catalinroibu at gmail.com  Fri Jan  4 20:54:23 2013
From: catalinroibu at gmail.com (catalin roibu)
Date: Fri, 4 Jan 2013 21:54:23 +0200
Subject: [R-sig-Geo] quadrat
Message-ID: <CAEW+BDJGB_at=QnDxAJcnYdrWY=GtrcD43y0qHny2Y9SyGA8Lw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130104/13a6a07b/attachment.pl>

From jgrn at illinois.edu  Sat Jan  5 20:32:26 2013
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Sat, 5 Jan 2013 13:32:26 -0600
Subject: [R-sig-Geo] Writing an ENVI classification file?
Message-ID: <CABG0rfvBZaKRbUgMrr+qA876AxjNJp9Wutbakyr7aVcpVjmhUw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130105/85d89103/attachment.pl>

From suzana.stutz at gmail.com  Sat Jan  5 21:34:46 2013
From: suzana.stutz at gmail.com (Suzana Stutz)
Date: Sat, 5 Jan 2013 18:34:46 -0200
Subject: [R-sig-Geo] Doubts about GLM
In-Reply-To: <CANVKczOG7DJ_SDo1UTZkh7iCi3QYsPycgaZe-_AjUUAihmFOJA@mail.gmail.com>
References: <11d5754f36ad470487dd82add24cb6fc@EX-1-HT0.lancs.local>
	<CANVKczOG7DJ_SDo1UTZkh7iCi3QYsPycgaZe-_AjUUAihmFOJA@mail.gmail.com>
Message-ID: <CABWNPhq_m9CojRNc5rk+j=GuTRf2Q8AJOzht9EUYReNo+aPn+w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130105/ef6deb2f/attachment.pl>

From jfeighery at gmail.com  Sat Jan  5 21:44:17 2013
From: jfeighery at gmail.com (jfeighery)
Date: Sat, 5 Jan 2013 12:44:17 -0800 (PST)
Subject: [R-sig-Geo] Calculate matrix of distances from points to
	multiple polygons
In-Reply-To: <CANVKczMdHCTt4brUQWhBWh4bS6Hdg2VDve3RRXmsVZh1HCPa7A@mail.gmail.com>
References: <1357250078374-7582204.post@n2.nabble.com>
	<CANVKczMdHCTt4brUQWhBWh4bS6Hdg2VDve3RRXmsVZh1HCPa7A@mail.gmail.com>
Message-ID: <1357418657218-7582228.post@n2.nabble.com>

Thanks, Barry. gDistance with byid=T works beautifully!
John



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Calculate-matrix-of-distances-from-points-to-multiple-polygons-tp7582204p7582228.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Roger.Bivand at nhh.no  Sat Jan  5 21:55:58 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 5 Jan 2013 21:55:58 +0100
Subject: [R-sig-Geo] Writing an ENVI classification file?
In-Reply-To: <CABG0rfvBZaKRbUgMrr+qA876AxjNJp9Wutbakyr7aVcpVjmhUw@mail.gmail.com>
References: <CABG0rfvBZaKRbUgMrr+qA876AxjNJp9Wutbakyr7aVcpVjmhUw@mail.gmail.com>
Message-ID: <alpine.LRH.2.02.1301052152510.27181@reclus.nhh.no>

This is a continuation of thread: gdal color tables:

https://stat.ethz.ch/pipermail/r-sig-geo/2013-January/017120.html

continued from:

https://stat.ethz.ch/pipermail/r-sig-geo/2012-December/017071.html

Could you please try to use the results there with the ENVI driver? If you 
have a small example file showing what you want to achieve, that might 
help.

Roger


On Sat, 5 Jan 2013, Jonathan Greenberg wrote:

> Folks:
>
> I was wondering if there is any support for writing an ENVI classification
> file (which contains additional header info to assign the number of
> classes, the color as RGB values, and class names to each class).  Here's
> an example from the ENVI header:
>
> classes = 11
> class lookup = {
>   0,   0,   0, 255,   0,   0, 139,   0,   0, 205,   0,   0,   0,   0, 255,
>   0, 255, 255, 238, 210, 238, 255, 255,   0, 160,  32, 240,   0,   0, 139,
> 255, 165,   0}
> class names = {
> Unclassified, temperature_min, temperature_max, temperature_var,
> precipitation_mean, precipitation_var, wnd_mean, rad_mean, eto_mean,
> aet_mean, deficit_mean}
>
> Specifically I'd like to use writeRaster to do it, but I assume this is an
> issue with passing rgdal the right info...
>
> --j
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From jgrn at illinois.edu  Sun Jan  6 01:20:15 2013
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Sat, 5 Jan 2013 18:20:15 -0600
Subject: [R-sig-Geo] Writing an ENVI classification file?
In-Reply-To: <alpine.LRH.2.02.1301052152510.27181@reclus.nhh.no>
References: <CABG0rfvBZaKRbUgMrr+qA876AxjNJp9Wutbakyr7aVcpVjmhUw@mail.gmail.com>
	<alpine.LRH.2.02.1301052152510.27181@reclus.nhh.no>
Message-ID: <CABG0rfsTCAwQzW9gjzRvFmxXFxde9jU=HtJY7HBX8TSnVdqxOA@mail.gmail.com>

Hi Roger:

Not sure if I'm following what you are asking about -- ENVI classification
files have four characteristics that differentiate themselves from "ENVI
Standard" files, all of which are stored in the ENVI header:
file type = ENVI Classification
--> as opposed to "ENVI Standard"
and 3 class parameters relating to 1) the number of classes, 2) the class
colors in RGB format, and 3) the class names.

I'm attaching two small example files to this email, one is a "raw" file
(test_envi_noclass.envi + .hdr) generated from a
writeRaster(...,.format="ENVI",datatype="INT2S",NAflag=0); and one is what
the file should look like, given the variables below (test_envi_class.envi
+ .hdr) -- note the hdr is the only thing that differs.

I have written a script that allows me to simply append this info after
I've written the file to ENVI format with writeRaster, but I wanted to know
there was some way to do this from within writeRaster.

Incidentally, here are the R variables:
class_names=c("Unclassified",
"temperature_min",
"temperature_max",
 "temperature_var",
"precipitation_mean",
"precipitation_var",
 "wnd_mean",
"rad_mean",
"eto_mean",
 "aet_mean",
"def_mean"
)
class_number=length(class_names)

# I don't know if the formatting matters for ENVI
class_colors=format(
as.character(c(0,0,0,as.vector(col2rgb(rainbow(n=(class_number-1)))))),
 width=4,justify="right")

# The string to append to the header file should be:
 if(length(var_value)==1)
{
header_string=paste(var_name,var_value,sep=" = ")
 } else
{
header_string=paste(var_name," = {",(paste(var_value,collapse=",
")),"}",sep="")
 # Use brackets
}

# where var_name would be
var_name="classes"
var_value=class_number
# and..
var_name="class lookup"
var_value=class_colors
# and...
var_name="class names"
var_value=class_names

# I haven't written code to swap in "file type = ENVI Classification" yet,
but that also would need to be modded.

Thanks!

--j

On Sat, Jan 5, 2013 at 2:55 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:

> This is a continuation of thread: gdal color tables:
>
> https://stat.ethz.ch/**pipermail/r-sig-geo/2013-**January/017120.html<https://stat.ethz.ch/pipermail/r-sig-geo/2013-January/017120.html>
>
> continued from:
>
> https://stat.ethz.ch/**pipermail/r-sig-geo/2012-**December/017071.html<https://stat.ethz.ch/pipermail/r-sig-geo/2012-December/017071.html>
>
> Could you please try to use the results there with the ENVI driver? If you
> have a small example file showing what you want to achieve, that might help.
>
> Roger
>
>
>
> On Sat, 5 Jan 2013, Jonathan Greenberg wrote:
>
>  Folks:
>>
>> I was wondering if there is any support for writing an ENVI classification
>> file (which contains additional header info to assign the number of
>> classes, the color as RGB values, and class names to each class).  Here's
>> an example from the ENVI header:
>>
>> classes = 11
>> class lookup = {
>>   0,   0,   0, 255,   0,   0, 139,   0,   0, 205,   0,   0,   0,   0, 255,
>>   0, 255, 255, 238, 210, 238, 255, 255,   0, 160,  32, 240,   0,   0, 139,
>> 255, 165,   0}
>> class names = {
>> Unclassified, temperature_min, temperature_max, temperature_var,
>> precipitation_mean, precipitation_var, wnd_mean, rad_mean, eto_mean,
>> aet_mean, deficit_mean}
>>
>> Specifically I'd like to use writeRaster to do it, but I assume this is an
>> issue with passing rgdal the right info...
>>
>> --j
>>
>>
>>
> --
> Roger Bivand
> Department of Economics, NHH Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
>


-- 
Jonathan A. Greenberg, PhD
Assistant Professor
Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
Department of Geography and Geographic Information Science
University of Illinois at Urbana-Champaign
607 South Mathews Avenue, MC 150
Urbana, IL 61801
Phone: 217-300-1924
http://www.geog.illinois.edu/~jgrn/
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307, Skype: jgrn3007
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130105/4a0f6963/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: test_envi_class.envi
Type: application/octet-stream
Size: 1800 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130105/4a0f6963/attachment.obj>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: test_envi_class.hdr
Type: application/octet-stream
Size: 994 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130105/4a0f6963/attachment-0001.obj>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: test_envi_noclass.envi
Type: application/octet-stream
Size: 1800 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130105/4a0f6963/attachment-0002.obj>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: test_envi_noclass.hdr
Type: application/octet-stream
Size: 606 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130105/4a0f6963/attachment-0003.obj>

From jgrn at illinois.edu  Sun Jan  6 01:22:57 2013
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Sat, 5 Jan 2013 18:22:57 -0600
Subject: [R-sig-Geo] "Accessing" command line gdal?
Message-ID: <CABG0rfv1AyGzVK+YdVbiy0=6O7H4Z3Bu6WA4STmZCuKCbNA6GA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130105/c88c4e9c/attachment.pl>

From finleya at msu.edu  Sun Jan  6 04:44:17 2013
From: finleya at msu.edu (Andrew Finley)
Date: Sat, 5 Jan 2013 22:44:17 -0500
Subject: [R-sig-Geo] Doubts about GLM
In-Reply-To: <CABWNPhq_m9CojRNc5rk+j=GuTRf2Q8AJOzht9EUYReNo+aPn+w@mail.gmail.com>
References: <11d5754f36ad470487dd82add24cb6fc@EX-1-HT0.lancs.local>
	<CANVKczOG7DJ_SDo1UTZkh7iCi3QYsPycgaZe-_AjUUAihmFOJA@mail.gmail.com>
	<CABWNPhq_m9CojRNc5rk+j=GuTRf2Q8AJOzht9EUYReNo+aPn+w@mail.gmail.com>
Message-ID: <07440D5D-8B3B-492E-A1F5-C2D0C99A1DEA@msu.edu>

Hi Suzana,
You can try the spGLM function in the spBayes package or similar functions in the geoRglm package which provide spatial random effects to accommodate residual spatial dependence.
-Andy

On Jan 5, 2013, at 15:34, Suzana Stutz <suzana.stutz at gmail.com> wrote:

> Hello dear list members.
> 
> First I want to wish you all Happy New Year! I Hope 2013 brings us many
> opportunities to learn and to do our best in our careers and personal life.
> After that,  I must apologize for the late response.
> 
> I am very greatful  for your useful cues.
> 
> Sr. L?pez, you're right about the uncountable variables, the formula
> accepted it and all worked well with the countable ones. Thank you a lot
> for the help. I'll keep trying to solve the problem on the correlated
> predictors.
> 
> Sr. Rowlingson, thank you for the example of spatial autocorrelation, and
> yes it is an important issue to worry about. The environmental variables
> were colected at stations far from each other, trying to avoid it. Also we
> are not using the colected values, but new ones estimated from the real
> ones. Does it help to avoid the data spatial autocorrelation too??
> 
> 
> Thank you a lot.
> 
> Cheers!!
> 
> 
> Suzana
> 
> 
> 
> 
> 
> 
> 
> 
> 2013/1/2 Barry Rowlingson <b.rowlingson at lancaster.ac.uk>
> 
>> On Sun, Dec 30, 2012 at 1:55 PM, Suzana Stutz <suzana.stutz at gmail.com>
>> wrote:
>>> Dear list members.
>>> 
>>> I've been trying to apply GLM for spatial analysis of  a marine animal's
>>> distribution (as the dependant variable) related to many environmental
>>> variables (as the independant ones). But some of them are correlated, for
>>> example, the depth increases as the distance to coast increases, and  I
>>> must test both. Does it disagree with the assumption of independence of
>> the
>>> data? If yes, how can I fix it in order to keep the two variables in the
>>> model?
>> 
>> Correlation in your explanatory variables is a classical problem of
>> variable selection, and there are methods for that. The bigger problem
>> with doing a GLM with spatial data is that the data points are going
>> to have spatial autocorrelation...
>> 
>> Two measurements of 10 fish per square meter at depth 50m taken two
>> metres apart are less likely to be independent than two measurements
>> of 10 fish per square meter at depth 50m taken twenty kilometres
>> apart. In the first case, the second measurement doesn't much extra
>> information - you already knew that this location had 10 fish/m^2 -
>> but in the second case the second measurement is much more useful.
>> There were 10 fish/m^2 even though the locations were far apart! It
>> might be due to the 50m depth!
>> 
>> You can do a GLM for starters, but its important to check the
>> independence assumption of the GLM otherwise you could be getting
>> significant effects when none are really there.
>> 
>> Barry
>> 
> 
> 
> 
> -- 
> *Suzana Stutz Reis*
> Mestranda do Programa de P?s Gradua??o em Ci?ncias Biol?gicas -
> Comportamento e Biologia Animal
> Universidade Federal de Juiz de Fora, MG, Brasil.
> 
>    [[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Roger.Bivand at nhh.no  Sun Jan  6 10:28:26 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sun, 6 Jan 2013 10:28:26 +0100
Subject: [R-sig-Geo] "Accessing" command line gdal?
In-Reply-To: <CABG0rfv1AyGzVK+YdVbiy0=6O7H4Z3Bu6WA4STmZCuKCbNA6GA@mail.gmail.com>
References: <CABG0rfv1AyGzVK+YdVbiy0=6O7H4Z3Bu6WA4STmZCuKCbNA6GA@mail.gmail.com>
Message-ID: <alpine.LRH.2.02.1301061018070.32196@reclus.nhh.no>

On Sun, 6 Jan 2013, Jonathan Greenberg wrote:

> r-sig-geo'ers: is there a way to use rgdal to look for where the gdal
> installation is hiding?  In other words: if I wanted to write a modified
> wrapper for some gdal function (e.g. gdal_translate), how do I locate gdal
> assuming rgdal has been installed?  I am correct in assuming rgdal installs
> GDAL, correct?

Please never assume, just check? If you are thinking of a source install, 
of course nothing is installed, as GDAL etc. are external dependencies. If 
you mean the Windows or OSX binary rgdal packages from CRAN, check by 
looking inside the compressed archive files on CRAN (answer, given many 
times here, no, they are built static, so rgdal.dll and rgdal.dylib 
contain all the GDAL etc. binary objects needed to run, nothing more). 
rgdal does not install any GDAL utility programs etc. for obvious reasons.

rgdal cannot know about the GDAL install, but system("gdal-config") may 
tell you something on systems with GDAL installed externally. On 
Windows/OSX with rgdal installed as a CRAN binary, this will probably mean 
that the GDAL used in rgdal and the external GDAL may differ in version, 
and this should be checked by the user if it matters.

Hope this clarifies,

Roger

>
> --j
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Sun Jan  6 12:25:53 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sun, 6 Jan 2013 12:25:53 +0100
Subject: [R-sig-Geo] Writing an ENVI classification file?
In-Reply-To: <CABG0rfsTCAwQzW9gjzRvFmxXFxde9jU=HtJY7HBX8TSnVdqxOA@mail.gmail.com>
References: <CABG0rfvBZaKRbUgMrr+qA876AxjNJp9Wutbakyr7aVcpVjmhUw@mail.gmail.com>
	<alpine.LRH.2.02.1301052152510.27181@reclus.nhh.no>
	<CABG0rfsTCAwQzW9gjzRvFmxXFxde9jU=HtJY7HBX8TSnVdqxOA@mail.gmail.com>
Message-ID: <alpine.LRH.2.02.1301061206310.32196@reclus.nhh.no>

On Sun, 6 Jan 2013, Jonathan Greenberg wrote:

> Hi Roger:
>
> Not sure if I'm following what you are asking about -- ENVI classification
> files have four characteristics that differentiate themselves from "ENVI
> Standard" files, all of which are stored in the ENVI header:

Hi Jonathan,

What ENVI does is irrelevant, it is what the GDAL ENVI driver does that is 
crucial, since nobody is going to re-do all the drivers separately. It 
turns out that with a small patch to handle the fact that your input file 
has more colors and names than unique values (SVN revision 423 on 
R-Forge) - earlier versions required the numbers to agree - this works:

# I've taken the liberty of shipping your file with rgdal for reference
#fn <- system.file("pictures/test_envi_class.envi", package = "rgdal")[1]
fn <- "test_envi_class.envi"
Gi <- GDALinfo(fn, returnColorTable=TRUE, returnCategoryNames=TRUE)
CT <- attr(Gi, "ColorTable")[[1]]
CT
attr(Gi, "CATlist")[[1]]
with <- readGDAL(fn)
# reports input values and names, because factor creates a 1-based 
# sequence, turn off the console output with:
with <- readGDAL(fn, silent=TRUE)
table(with$band1)
table(as.numeric(with$band1))
# read input as-is to retrieve color table 0-based look-up
with1 <- readGDAL(fn, as.is=TRUE)
table(with1$band1)
# beware 0-base table
ind <- sort(unique(na.omit(with1$band1)))+1
# is this as ENVI?
spplot(with, col.regions=CT[ind])
# write out same data (but coded as factor)
tf <- tempfile()
cN <- levels(with$band1)
CTi <- t(col2rgb(CT[ind]))
# beware 0-base table, convert from factor to integer
with$band1 <- as.integer(with$band1)-1
writeGDAL(with, tf, drivername="ENVI", type="Int16", colorTable=list(CTi),
  catNames=list(cN), mvFlag=7L)
# header OK?
cat(paste(readLines(paste(tf, "hdr", sep=".")), "\n", sep=""), "\n")
wGi <- GDALinfo(tf, returnColorTable=TRUE, returnCategoryNames=TRUE)
CTN <- attr(wGi, "ColorTable")[[1]]
CTN
attr(wGi, "CATlist")[[1]]
# re-read
withN <- readGDAL(tf)
table(withN$band1)
withN1 <- readGDAL(tf, as.is=TRUE)
table(withN1$band1)
# beware 0-base table
ind <- sort(unique(na.omit(withN1$band1)))+1
spplot(withN, col.regions=CTN[ind])

with the same data moved into R, out of R, and back in again. The changes 
induced are in the factor codes given to the values in the raster, but 
this isn't easy to handle sensibly if the input codes are arbitrary 
integers.

As you can see, had you investigated the ENVI driver in GDAL, you would 
have found that it does provide access to the metadata you need, and that 
what the GDAL driver sees is also visible in rgdal. That is why GDAL is:

Geospatial Data Abstraction Library

to avoid messing around with file-format specifics.

In the complete thread, what we don't have so far is a mechanism for 
quantization, that is packaging rules for break points in a numeric raster 
to quantize it into discrete color table entries and category names (class 
intervals). I think that it might be done in the Raster Attribute Table, 
and would welcome input from others that applies generally through GDAL.

Please report back as soon as you've tried rgdal from SVN.

Roger

> file type = ENVI Classification
> --> as opposed to "ENVI Standard"
> and 3 class parameters relating to 1) the number of classes, 2) the class
> colors in RGB format, and 3) the class names.
>
> I'm attaching two small example files to this email, one is a "raw" file
> (test_envi_noclass.envi + .hdr) generated from a
> writeRaster(...,.format="ENVI",datatype="INT2S",NAflag=0); and one is what
> the file should look like, given the variables below (test_envi_class.envi
> + .hdr) -- note the hdr is the only thing that differs.
>
> I have written a script that allows me to simply append this info after
> I've written the file to ENVI format with writeRaster, but I wanted to know
> there was some way to do this from within writeRaster.
>
> Incidentally, here are the R variables:
> class_names=c("Unclassified",
> "temperature_min",
> "temperature_max",
> "temperature_var",
> "precipitation_mean",
> "precipitation_var",
> "wnd_mean",
> "rad_mean",
> "eto_mean",
> "aet_mean",
> "def_mean"
> )
> class_number=length(class_names)
>
> # I don't know if the formatting matters for ENVI
> class_colors=format(
> as.character(c(0,0,0,as.vector(col2rgb(rainbow(n=(class_number-1)))))),
> width=4,justify="right")
>
> # The string to append to the header file should be:
> if(length(var_value)==1)
> {
> header_string=paste(var_name,var_value,sep=" = ")
> } else
> {
> header_string=paste(var_name," = {",(paste(var_value,collapse=",
> ")),"}",sep="")
> # Use brackets
> }
>
> # where var_name would be
> var_name="classes"
> var_value=class_number
> # and..
> var_name="class lookup"
> var_value=class_colors
> # and...
> var_name="class names"
> var_value=class_names
>
> # I haven't written code to swap in "file type = ENVI Classification" yet,
> but that also would need to be modded.
>
> Thanks!
>
> --j
>
> On Sat, Jan 5, 2013 at 2:55 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> This is a continuation of thread: gdal color tables:
>>
>> https://stat.ethz.ch/**pipermail/r-sig-geo/2013-**January/017120.html<https://stat.ethz.ch/pipermail/r-sig-geo/2013-January/017120.html>
>>
>> continued from:
>>
>> https://stat.ethz.ch/**pipermail/r-sig-geo/2012-**December/017071.html<https://stat.ethz.ch/pipermail/r-sig-geo/2012-December/017071.html>
>>
>> Could you please try to use the results there with the ENVI driver? If you
>> have a small example file showing what you want to achieve, that might help.
>>
>> Roger
>>
>>
>>
>> On Sat, 5 Jan 2013, Jonathan Greenberg wrote:
>>
>>  Folks:
>>>
>>> I was wondering if there is any support for writing an ENVI classification
>>> file (which contains additional header info to assign the number of
>>> classes, the color as RGB values, and class names to each class).  Here's
>>> an example from the ENVI header:
>>>
>>> classes = 11
>>> class lookup = {
>>>   0,   0,   0, 255,   0,   0, 139,   0,   0, 205,   0,   0,   0,   0, 255,
>>>   0, 255, 255, 238, 210, 238, 255, 255,   0, 160,  32, 240,   0,   0, 139,
>>> 255, 165,   0}
>>> class names = {
>>> Unclassified, temperature_min, temperature_max, temperature_var,
>>> precipitation_mean, precipitation_var, wnd_mean, rad_mean, eto_mean,
>>> aet_mean, deficit_mean}
>>>
>>> Specifically I'd like to use writeRaster to do it, but I assume this is an
>>> issue with passing rgdal the right info...
>>>
>>> --j
>>>
>>>
>>>
>> --
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>>
>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Virgilio.Gomez at uclm.es  Sun Jan  6 17:49:33 2013
From: Virgilio.Gomez at uclm.es (Virgilio Gomez Rubio)
Date: Sun, 6 Jan 2013 17:49:33 +0100
Subject: [R-sig-Geo] DCluster package
In-Reply-To: <CALSKosAE38ThmJkOqiRzKYTWj10LCPvXVohUxN27iXOi=Nk6Lw@mail.gmail.com>
References: <CALSKosAE38ThmJkOqiRzKYTWj10LCPvXVohUxN27iXOi=Nk6Lw@mail.gmail.com>
Message-ID: <1357490973.3139.14.camel@Virgilio-Gomez>

Hi,

> I noticed that 'DCluster' package is not available any more while I
> self-study 'Applied Spatial Data Analysis with R'.  Is there an
> alternative?

DCluster was archived because of the necessity of complying  with recent
changes in R internals and a busy (lazy?) maintainer. The package has
been fixed and sources are on the main CRAN server now and they will
appear in other mirrors soon, as well as compiled versions for Windows
and Mac.

Best,

Virgilio


From lily_franknich at yahoo.com  Mon Jan  7 07:08:44 2013
From: lily_franknich at yahoo.com (Lilis Husna)
Date: Mon, 7 Jan 2013 14:08:44 +0800 (SGT)
Subject: [R-sig-Geo] invers matrix
Message-ID: <1357538924.54947.YahooMailNeo@web192905.mail.sg3.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130107/6de0171e/attachment.pl>

From lily_franknich at yahoo.com  Mon Jan  7 07:08:44 2013
From: lily_franknich at yahoo.com (Lilis Husna)
Date: Mon, 7 Jan 2013 14:08:44 +0800
Subject: [R-sig-Geo] invers matrix
Message-ID: <1357538924.54947.YahooMailNeo@web192905.mail.sg3.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130107/6de0171e/attachment-0001.pl>

From lily_franknich at yahoo.com  Mon Jan  7 07:09:52 2013
From: lily_franknich at yahoo.com (Lilis Husna)
Date: Mon, 7 Jan 2013 14:09:52 +0800 (SGT)
Subject: [R-sig-Geo] invers matrix
Message-ID: <1357538992.89272.YahooMailNeo@web192906.mail.sg3.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130107/14fca691/attachment.pl>

From lily_franknich at yahoo.com  Mon Jan  7 07:09:52 2013
From: lily_franknich at yahoo.com (Lilis Husna)
Date: Mon, 7 Jan 2013 14:09:52 +0800
Subject: [R-sig-Geo] invers matrix
Message-ID: <1357538992.89272.YahooMailNeo@web192906.mail.sg3.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130107/14fca691/attachment-0001.pl>

From s.blomberg1 at uq.edu.au  Mon Jan  7 07:14:18 2013
From: s.blomberg1 at uq.edu.au (Simon Blomberg)
Date: Mon, 07 Jan 2013 16:14:18 +1000
Subject: [R-sig-Geo] invers matrix
In-Reply-To: <1357538924.54947.YahooMailNeo@web192905.mail.sg3.yahoo.com>
References: <1357538924.54947.YahooMailNeo@web192905.mail.sg3.yahoo.com>
Message-ID: <50EA67BA.5070205@uq.edu.au>

Singular matrices do not have an inverse.

Simon.

On 07/01/13 16:08, Lilis Husna wrote:
> How to get invers of sigular matrix in R?
>   
> Regards,
> Lilis Nurul Husna
> Institute of Statistics
>
> Jakarta
>
> 	[[alternative HTML version deleted]]
>

-- 
Simon Blomberg, BSc (Hons), PhD, MAppStat, AStat.
Lecturer and Consultant Statistician
School of Biological Sciences
The University of Queensland
St. Lucia Queensland 4072
Australia
T: +61 7 3365 2506
email: S.Blomberg1_at_uq.edu.au
http://www.evolutionarystatistics.org

Policies:
1.  I will NOT analyse your data for you.
2.  Your deadline is your problem.

Statistics is the grammar of science - Karl Pearson.


From mohammadr at packtpub.com  Mon Jan  7 12:31:00 2013
From: mohammadr at packtpub.com (Mohammad Rizvi)
Date: Mon, 07 Jan 2013 17:01:00 +0530
Subject: [R-sig-Geo] Need Geo Spatial Social Network Analysis with R experts.
Message-ID: <50EAB1F4.4050909@packtpub.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130107/321b46e4/attachment.pl>

From senator at ecotoxicology.de  Mon Jan  7 12:36:37 2013
From: senator at ecotoxicology.de (=?iso-8859-1?Q?Ralf_Sch=E4fer?=)
Date: Mon, 7 Jan 2013 12:36:37 +0100
Subject: [R-sig-Geo]  invers matrix
Message-ID: <8EDC75A4-7A74-441E-B2FB-109BE6F9609B@ecotoxicology.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130107/86b16b10/attachment.pl>

From lucianolasala at yahoo.com.ar  Mon Jan  7 13:36:30 2013
From: lucianolasala at yahoo.com.ar (Luciano La Sala)
Date: Mon, 7 Jan 2013 09:36:30 -0300
Subject: [R-sig-Geo] RV: [Rsig-Geo] Raster processing,
	pop density estimation and more
Message-ID: <008e01cdecd3$9fe39840$dfaac8c0$@com.ar>

Dear r-sig-geo crew, 
Sorry about the redundant posting of a na?ve issue here, but I can't seem to
wrap my head around it. 
I have a raster image of human population counts a LandScan grid at a
resolution of 1 km where each pixel's value represents population number,
which I am processing using Quantum GIS and GRASS the modules inside of it.

Using GRASS (either module r.out.ascii or r.out.xyz) I  got an ASCII text
file which I then loaded into R using the rgdal package as shown below.

However, I get a dataframe consisting of three columns and as many rows as
max print permits (see output below). 

Q1. What do these values represent? 
Q2. How can I view the population data corresponding to each cell? I need
this variable to do some statistics.        
Q3. What does the "GDAL driver XYZ and has 4289 rows and 2375 columns" piece
really mean? Does it mean that I have 4289*2375 = 10186375 cells?

Thanks in advance, 

Luciano 

###################################

> r <- readGDAL("C:/Users/.../ASCII_XYZ/XYZ")


C:/Users/Luciano/Documents/Analisis/Risk_AI/ASCII_XYZ/XYZ has GDAL driver
XYZ and has 4289 rows and 2375 columns

> r

Object of class SpatialGridDataFrame
Object of class SpatialGrid

Grid topology:
  cellcentre.offset cellsize cells.dim
x         -597582.9 873.0906      2375
y         3847318.5 873.0906      4289

SpatialPoints:

[4007,]  826427.8274 7590258
[4008,]  827300.9180 7590258
[4009,]  828174.0086 7590258
[4010,]  829047.0992 7590258
....
....
....
[4999,] -381056.4737 7589385
[5000,] -380183.3831 7589385

[ reached getOption("max.print") -- omitted 10181375 rows ] Coordinate
Reference System (CRS) arguments: NA 

Data summary:
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
    0.00     0.00     0.00     3.56     0.00 54760.00


From edzer.pebesma at uni-muenster.de  Mon Jan  7 17:28:12 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 07 Jan 2013 17:28:12 +0100
Subject: [R-sig-Geo] Visualisation tool assessment
Message-ID: <50EAF79C.90505@uni-muenster.de>

The following request has relatively little to do with R, but a lot with
the interactive visualisation of probabilistic spatial data, an area
where R is, let's say, not so strong.

the UncertWeb FP7 EU project (http://www.uncertweb.org) has developed
methods and open source tools for uncertainty propagation in web-enabled
environmental modeling chains. One of these tools visualises
probabilistic spatial and spatio-temporal data in a browser. To assess
the usability of this visualisation tool, we prepared an online survey.
We would be grateful if you could spend 20 minutes to get to know the
tool and give your opinion about it. We will need this before Jan 15,
23:59 UTC. We will send a reminder on Jan 14.

The questionnaire is available at:
http://surveys.ifgi.de/index.php?sid=81531&lang=en

With best regards,
-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From kjjw32 at yahoo.com  Mon Jan  7 23:36:36 2013
From: kjjw32 at yahoo.com (K Jjw)
Date: Mon, 7 Jan 2013 14:36:36 -0800 (PST)
Subject: [R-sig-Geo] Regular expression
Message-ID: <1357598196.19546.YahooMailNeo@web142304.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130107/478a44b1/attachment.pl>

From sidartagalas at gmail.com  Tue Jan  8 03:13:49 2013
From: sidartagalas at gmail.com (sidartagalas)
Date: Mon, 7 Jan 2013 23:13:49 -0300
Subject: [R-sig-Geo] How could I do a Box map?
Message-ID: <CACmk37JnMh_XG7Q2hhC6jBVXQO34npemZnh=2X_7ZX5Wrxetww@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130107/27aa50fe/attachment.pl>

From halim10-fes at sust.edu  Tue Jan  8 11:57:49 2013
From: halim10-fes at sust.edu (halim10-fes)
Date: Tue, 8 Jan 2013 16:57:49 +0600
Subject: [R-sig-Geo] Problem in regression kriggin
Message-ID: <20130108104050.M21401@sust.edu>

Dear Group,

Happy New Year to Everybody.

I am a novice user of gstat and geostatistics. I have a data set (please see 
attached: data.csv) containing coordinates (East_x, North_y),Elev(Elevation), 
and Richness (Plant Species) collected from 125 plots of 10m x 10m plots. I 
want to interpolate plant species richness from the relationship between 
Richness and Elevation of the study area using Regression Krigging. I have 
written the following codes:

#Variogram of residuals
#===========================================================================

data<-read.csv("E://data.csv",header=TRUE)
attach(data)
names(data)
m2=glm(Richness~Elev)
summary(m2)
residuals<-m2$residuals
data$Residuals<-residuals

library(maptools)

coordinates(data) = ~ East_x+North_y

library(gstat)

var <- variogram(Residuals~1, data=data,alpha=c(0,22.5,45,67.5,90,112.5,135),
                 tol.hor=30,cutoff=1000,width=67)
plot(var)

#Variogram shows that major axis is 45 & minor 112.5; Fitting variogram in 
#major axis

var.45<-var$dir.hor==45
plot(var[var.45,])

eye.sph<-vgm(psill=10.5,model="Sph",range=705,nugget=2)
plot(var[var.45,],eye.sph)


#Fit anisotropic variogram

fit.sph<-fit.variogram(var,model=vgm(psill=10.5,model="Sph",range=705,
                                     nugget=2,anis=c(45,0.72)))
plot(var, model=fit.sph, as.table=TRUE)

fit.exp<-fit.variogram(var, model=vgm(psill=10.5,model='Exp',range=705/3,
                                      nugget=2, anis=c(45, 0.72)))
plot(var, model=fit.exp, as.table=TRUE)

fit.gau<-fit.variogram(var,model=vgm(psill=10.5,model='Exp',range=705/sqrt(3),
                                     nugget=2, anis=c(45, 0.72)))
plot(var, model=fit.gau, as.table=TRUE)

#Cross Variogram

cv.sph<-krige.cv(Residuals~1,data,fit.sph)
View(cv.sph)
mean(cv.sph$zscore) #-0.0001968425
var(cv.sph$zscore)  #1.114187

cv.exp<-krige.cv(Residuals~1,data,fit.exp)
View(cv.exp)
mean(cv.exp$zscore)  #-1.243423e-05
var(cv.exp$zscore)   #1.116687

cv.gau<-krige.cv(Residuals~1,data,fit.gau)
View(cv.gau)
mean(cv.gau$zscore)  #-1.235693e-05
var(cv.gau$zscore)   #1.116684


#Cross variogram shows that spherical model shows the best fit. The sill 
varies in different direction of the varigram. So, we will have to fit a zonal 
#anisotropic variogram with spherical model (fit.sph). Variogram shows that
#22.5 deg has the highest sill and 112.5 deg should have the lowest sill. We 
#will fit the zonal variogram to the 112.5 deg direction with an anisotropic 
#ratio of 293/(1600*10000)

#Fitting zonal anisotropic variogram

fit.sph1<-vgm(psill=2.5,"Sph",range=1600*10000,anis=c(122.5,1.825e-05),
              add.to=fit.sph)
plot(var,fit.sph1,as.table=TRUE)

#Cross Variogram of the final model

cv.sph1<-krige.cv(Residuals~1,data,fit.sph1)
View(cv.sph1)
mean(cv.sph1$zscore)  #-0.0009952294
var(cv.sph1$zscore)   #1.071403

#Creating a grid file
#============================================================================

grd <- expand.grid(x=seq(from=341960,to=343195,by=10), 
                   y=seq(from=2667253,to=2668873,by=10))

library(maptools)

coordinates(grd) <- ~ x+y
gridded(grd) <- TRUE

So far,I think, things were going well but I found a error while running the 
following code

#Regression kriggin
#===========================================================================

prk.rich<-krige(Richness~Elev, data=data, newdata=grd,model=fit.sph1)

Error in function (classes, fdef, mtable)  : 
  unable to find an inherited method for function ?krige? for signature 
?"formula", "missing"?

Can anyone help me out of this please? I shall be grateful.

Best regards,

---------------
Md. Abdul Halim
Assistant Professor
Department of Forestry and Environmental Science
Shahjalal University of Science and Technology,Sylhet-3114,
Bangladesh.
Cell: +8801714078386.
alt. e-mail: xou03 at yahoo.com

-- 
This message has been scanned for viruses and
dangerous content by MailScanner, and is
believed to be clean.

-------------- next part --------------
A non-text attachment was scrubbed...
Name: data.csv
Type: application/vnd.ms-excel
Size: 4212 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130108/36efe1ae/attachment.xlb>

From ashton at msu.edu  Tue Jan  8 14:44:27 2013
From: ashton at msu.edu (Ashton Shortridge)
Date: Tue, 8 Jan 2013 08:44:27 -0500
Subject: [R-sig-Geo] Problem in regression kriggin
In-Reply-To: <20130108104050.M21401@sust.edu>
References: <20130108104050.M21401@sust.edu>
Message-ID: <201301080844.28017.ashton@msu.edu>

Dear Abdul,

there are a couple of strange things about your code (the cross-variogram 
section actually performs cross-validation), but there are two problems with 
your code for the regression kriging in particular:
1. in my version of R at least, specifying 'data=data' throws the error you 
describe. This way seems to work better:
prk.rich<-krige(Richness~Elev, data, newdata=grd,model=fit.sph1)

2. More critically, the prediction object you wish to predict to (grd) must 
have the independent variable(s) in the model as attributes; in your case, 
there is one variable called Elev. However, you do not have that. If you could 
import a DEM and use that as the prediction object, this might work. For 
example, if I change your code to ordinary kriging, it works fine:
prk.rich<-krige(Richness~1, data, newdata=grd,model=fit.sph1)

though of course this is the wrong variogram model to use in ordinary kriging!

For more on regression kriging, check out the following wiki page, especially 
the R+gstat section:
http://spatial-analyst.net/wiki/index.php?title=Regression-kriging_guide

On 01/08/13, halim10-fes, wrote:
> Dear Group,
> 
> Happy New Year to Everybody.
> 
> I am a novice user of gstat and geostatistics. I have a data set (please
> see attached: data.csv) containing coordinates (East_x,
> North_y),Elev(Elevation), and Richness (Plant Species) collected from 125
> plots of 10m x 10m plots. I want to interpolate plant species richness
> from the relationship between Richness and Elevation of the study area
> using Regression Krigging. I have written the following codes:
> 
> #Variogram of residuals
> 
#==========================================================================
> =
> 
> data<-read.csv("E://data.csv",header=TRUE)
> attach(data)
> names(data)
> m2=glm(Richness~Elev)
> summary(m2)
> residuals<-m2$residuals
> data$Residuals<-residuals
> 
> library(maptools)
> 
> coordinates(data) = ~ East_x+North_y
> 
> library(gstat)
> 
> var <- variogram(Residuals~1,
> data=data,alpha=c(0,22.5,45,67.5,90,112.5,135),
> tol.hor=30,cutoff=1000,width=67)
> plot(var)
> 
> #Variogram shows that major axis is 45 & minor 112.5; Fitting variogram in
> #major axis
> 
> var.45<-var$dir.hor==45
> plot(var[var.45,])
> 
> eye.sph<-vgm(psill=10.5,model="Sph",range=705,nugget=2)
> plot(var[var.45,],eye.sph)
> 
> 
> #Fit anisotropic variogram
> 
> fit.sph<-fit.variogram(var,model=vgm(psill=10.5,model="Sph",range=705,
>                                      nugget=2,anis=c(45,0.72)))
> plot(var, model=fit.sph, as.table=TRUE)
> 
> fit.exp<-fit.variogram(var, model=vgm(psill=10.5,model='Exp',range=705/3,
>                                       nugget=2, anis=c(45, 0.72)))
> plot(var, model=fit.exp, as.table=TRUE)
> 
> fit.gau<-
fit.variogram(var,model=vgm(psill=10.5,model='Exp',range=705/sqrt(
> 3), nugget=2, anis=c(45, 0.72)))
> plot(var, model=fit.gau, as.table=TRUE)
> 
> #Cross Variogram
> 
> cv.sph<-krige.cv(Residuals~1,data,fit.sph)
> View(cv.sph)
> mean(cv.sph$zscore) #-0.0001968425
> var(cv.sph$zscore)  #1.114187
> 
> cv.exp<-krige.cv(Residuals~1,data,fit.exp)
> View(cv.exp)
> mean(cv.exp$zscore)  #-1.243423e-05
> var(cv.exp$zscore)   #1.116687
> 
> cv.gau<-krige.cv(Residuals~1,data,fit.gau)
> View(cv.gau)
> mean(cv.gau$zscore)  #-1.235693e-05
> var(cv.gau$zscore)   #1.116684
> 
> 
> #Cross variogram shows that spherical model shows the best fit. The sill
> varies in different direction of the varigram. So, we will have to fit a
> zonal #anisotropic variogram with spherical model (fit.sph). Variogram
> shows that #22.5 deg has the highest sill and 112.5 deg should have the
> lowest sill. We #will fit the zonal variogram to the 112.5 deg direction
> with an anisotropic #ratio of 293/(1600*10000)
> 
> #Fitting zonal anisotropic variogram
> 
> fit.sph1<-vgm(psill=2.5,"Sph",range=1600*10000,anis=c(122.5,1.825e-05),
>               add.to=fit.sph)
> plot(var,fit.sph1,as.table=TRUE)
> 
> #Cross Variogram of the final model
> 
> cv.sph1<-krige.cv(Residuals~1,data,fit.sph1)
> View(cv.sph1)
> mean(cv.sph1$zscore)  #-0.0009952294
> var(cv.sph1$zscore)   #1.071403
> 
> #Creating a grid file
> 
#==========================================================================
> ==
> 
> grd <- expand.grid(x=seq(from=341960,to=343195,by=10),
>                    y=seq(from=2667253,to=2668873,by=10))
> 
> library(maptools)
> 
> coordinates(grd) <- ~ x+y
> gridded(grd) <- TRUE
> 
> So far,I think, things were going well but I found a error while running
> the following code
> 
> #Regression kriggin
> 
#==========================================================================
> =
> 
> prk.rich<-krige(Richness~Elev, data=data, newdata=grd,model=fit.sph1)
> 
> Error in function (classes, fdef, mtable)  :
>   unable to find an inherited method for function ?krige? for signature
> ?"formula", "missing"?
> 
> Can anyone help me out of this please? I shall be grateful.
> 
> Best regards,
> 
> ---------------
> Md. Abdul Halim
> Assistant Professor
> Department of Forestry and Environmental Science
> Shahjalal University of Science and Technology,Sylhet-3114,
> Bangladesh.
> Cell: +8801714078386.
> alt. e-mail: xou03 at yahoo.com


-----
Ashton Shortridge
Associate Professor			ashton at msu.edu
Dept of Geography			http://www.msu.edu/~ashton
235 Geography Building		ph (517) 432-3561
Michigan State University		fx (517) 432-1671


From milansharma2012 at yahoo.com  Tue Jan  8 15:48:45 2013
From: milansharma2012 at yahoo.com (Milan Sharma)
Date: Tue, 8 Jan 2013 06:48:45 -0800 (PST)
Subject: [R-sig-Geo] Poisson regression spatial residual plot
In-Reply-To: <1357085310.26767.YahooMailNeo@web162101.mail.bf1.yahoo.com>
References: <1357085310.26767.YahooMailNeo@web162101.mail.bf1.yahoo.com>
Message-ID: <1357656525.94998.YahooMailNeo@web162101.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130108/bce4017d/attachment.pl>

From carolina.lang at ifop.cl  Tue Jan  8 16:28:53 2013
From: carolina.lang at ifop.cl (Carolina Lang)
Date: Tue, 8 Jan 2013 12:28:53 -0300 (BRT)
Subject: [R-sig-Geo] directional variograms
Message-ID: <26042711.41357658954529.JavaMail.SYSTEM@clangxp>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130108/7873f07e/attachment.pl>

From edzer.pebesma at uni-muenster.de  Tue Jan  8 16:47:11 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 08 Jan 2013 16:47:11 +0100
Subject: [R-sig-Geo] directional variograms
In-Reply-To: <26042711.41357658954529.JavaMail.SYSTEM@clangxp>
References: <26042711.41357658954529.JavaMail.SYSTEM@clangxp>
Message-ID: <50EC3F7F.2040308@uni-muenster.de>

Please specify which R package you are using.

If it is gstat, please read the help of function variogram, and search
for the word "direction".

On 01/08/2013 04:28 PM, Carolina Lang wrote:
> Dear list, 
> 
> happy new year everybody!!! 
> 
> I have question, i??m working in directional variogram with marine resource (acoustic density of hake), and my results indicates that the direction with major continuity (maximun range) is 90?? degrees, is this axe represents by east direction??? 
> 
> greetings 
> 
> 
> 
> 	Carolina Lang A. 
> Investigador 
> Instituto de Fomento Pesquero 
> Blanco #839, Valpara??so, Chile. 
> Fono: (32) 2151572-2151500 
> 	IFOP.CL 
> 
> ------------------------------------------------------------------------------------------------
> Certificacion ISO 9001/2000: Sistema de Datos Bio-Pesqueros (Iquique, Valparaiso y Talcahuano)
> 
> Acreditacion INN - ISO 17025: Determinacion de la edad de jurel y merluza comun
> 
> 
> 	[[alternative HTML version deleted]]
> 
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From etiennebr at gmail.com  Tue Jan  8 16:48:02 2013
From: etiennebr at gmail.com (Etienne B. Racine)
Date: Tue, 8 Jan 2013 10:48:02 -0500
Subject: [R-sig-Geo] Regular expression
In-Reply-To: <1357598196.19546.YahooMailNeo@web142304.mail.bf1.yahoo.com>
References: <1357598196.19546.YahooMailNeo@web142304.mail.bf1.yahoo.com>
Message-ID: <CALjAYt6n01eDv6RWqe7rvN9Xc8=ox9bGACS7Np9Ln0d77NtuzA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130108/a1bb21ad/attachment.pl>

From carolina.lang at ifop.cl  Tue Jan  8 16:58:00 2013
From: carolina.lang at ifop.cl (Carolina Lang)
Date: Tue, 8 Jan 2013 12:58:00 -0300 (BRT)
Subject: [R-sig-Geo] directional variograms
In-Reply-To: <50EC3F7F.2040308@uni-muenster.de>
Message-ID: <1980629.81357660685500.JavaMail.SYSTEM@clangxp>

I'm using "geoR" package.



	Carolina Lang A. 
Investigador 
Instituto de Fomento Pesquero 
Blanco #839, Valpara?so, Chile. 
Fono: (32) 2151572-2151500 
	IFOP.CL 

----- Mensaje original -----
De: "Edzer Pebesma" <edzer.pebesma at uni-muenster.de>
Para: r-sig-geo at r-project.org
Enviados: Martes, 8 de Enero 2013 11:47:11 GMT -04:00 Georgetown
Asunto: Re: [R-sig-Geo] directional variograms

Please specify which R package you are using.

If it is gstat, please read the help of function variogram, and search
for the word "direction".

On 01/08/2013 04:28 PM, Carolina Lang wrote:
> Dear list, 
> 
> happy new year everybody!!! 
> 
> I have question, i??m working in directional variogram with marine resource (acoustic density of hake), and my results indicates that the direction with major continuity (maximun range) is 90?? degrees, is this axe represents by east direction??? 
> 
> greetings 
> 
> 
> 
> 	Carolina Lang A. 
> Investigador 
> Instituto de Fomento Pesquero 
> Blanco #839, Valpara??so, Chile. 
> Fono: (32) 2151572-2151500 
> 	IFOP.CL 
> 
> ------------------------------------------------------------------------------------------------
> Certificacion ISO 9001/2000: Sistema de Datos Bio-Pesqueros (Iquique, Valparaiso y Talcahuano)
> 
> Acreditacion INN - ISO 17025: Determinacion de la edad de jurel y merluza comun
> 
> 
> 	[[alternative HTML version deleted]]
> 
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

------------------------------------------------------------------------------------------------
Certificacion ISO 9001/2000: Sistema de Datos Bio-Pesqueros (Iquique, Valparaiso y Talcahuano)

Acreditacion INN - ISO 17025: Determinacion de la edad de jurel y merluza comun


From ppanday at clarku.edu  Tue Jan  8 17:42:11 2013
From: ppanday at clarku.edu (ppanday)
Date: Tue, 8 Jan 2013 08:42:11 -0800 (PST)
Subject: [R-sig-Geo] loading all levels and time in netCDF using brick/stack
Message-ID: <1357663331318-7582269.post@n2.nabble.com>

Hello all

I have a netCDF file with 42 levels across time. Is it possible to load
using brick or stack both levels and time dimensions? Using brick option, I
can only load either all time or all levels? Is it possible to work with
both dimensions so that if I need to average across levels, across time, I
would be able to do that.

Thanks,
Prajjwal

**********************************************************************
Example: foo.nc
[1] "file foo.nc has 4 dimensions:"
[1] "time   Size: 2"
[1] "levels   Size: 42"
[1] "longitude   Size: 540"
[1] "latitude   Size: 361"
[1] "------------------------"
[1] "file foo.nc has 1 variables:"
[1] "float t[longitude,latitude,levels,time]  Longname:Air temperature
Missval:999999986991104"

r <- brick("foo.nc")
r
class       : RasterBrick 
dimensions  : 361, 540, 194940, 2  (nrow, ncol, ncell, nlayers)
resolution  : 0.6666667, 0.5  (x, y)
extent      : -180.3333, 179.6667, -90.25, 90.25  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=longlat +datum=WGS84 
data source : C:\Data\Documents\IBIS\reanalysis_data\merra\temp\foo.nc 
names       : X0, X720 
z-value     : 0, 720 
varname     : t 
level       : 1 





--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/loading-all-levels-and-time-in-netCDF-using-brick-stack-tp7582269.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From virgilio.gomez at uclm.es  Tue Jan  8 20:42:05 2013
From: virgilio.gomez at uclm.es (Virgilio =?ISO-8859-1?Q?G=F3mez-Rubio?=)
Date: Tue, 08 Jan 2013 20:42:05 +0100
Subject: [R-sig-Geo] Poisson regression spatial residual plot
In-Reply-To: <1357656525.94998.YahooMailNeo@web162101.mail.bf1.yahoo.com>
References: <1357085310.26767.YahooMailNeo@web162101.mail.bf1.yahoo.com>
	<1357656525.94998.YahooMailNeo@web162101.mail.bf1.yahoo.com>
Message-ID: <1357674125.3019.14.camel@virgil-HP-Compaq-8000-Elite-USDT-PC>

Dear Milan, 

El mar, 08-01-2013 a las 06:48 -0800, Milan Sharma escribi?:
> 
> Dear list,
> I wanted to plot residuals from poisson regression model (like the figure 10.5 of Applied spatial data analysis with R, Bivand et. al.).
> My data has response,Tcrash, and the covariates,
> 100MVMT, Alcohol PVMT Alignment 
> and longitude and latitude.
> I used their code, but what "TCE" represents in my case, I am unable to figure out.

TCE refers to a number of sites and they are just another layer on the
plot but has nothing to do on the GLM.

> I will paste a small portion of data and code here, if that helps.
> Please, help me, if possible.
> wi<-map("county", "wisconsin", fill=TRUE, plot=FALSE)
> county.names<-as.character(wi$names)
> wi.sp<-map2SpatialPolygons(wi, IDs=county.names, proj4string=CRS("+proj=longlat"))
> WI_queen<-poly2nb(wi.sp, queen=TRUE)
> WI_queenb<-nb2listw(WI_queen, style="B")
> summary(WI_queenb)
> WI_queenw<-nb2listw(WI_queen, style="W")
> County population Tcrash 100MVMT Alcohol PVMT Alignment Longitude Latitude 
> adams 18643 225 225.6 0.093333 0.288889 0.155556 -89.792 43.95184 
> ashland 16866 187 174.3 0.058824 0.368984 0.235294 -90.7791 46.46137 
> barron 44963 379 495.5 0.055409 0.358839 0.248021 -91.821 45.43696 


The R code in lat2.R (available from www.asdar-book.org) that need to
look at are:

#Fit GLM
nyGLMp <- glm(Cases~PEXPOSURE+PCTAGE65P+PCTOWNHOME+offset(log(POP8)),
data=NY8, family="poisson")

#Get residuals
NY8$lmpresid <- residuals(nyGLMp, type="deviance")

#Display residuals; REMOVE sp.layout=list(TCEpts)
spplot(NY8, "lmpresid", sp.layout=list(TCEpts),
col.regions=grey.colors(9, 0.95, 0.55, 2.2), at=seq(-3,5,length.out=9))


You will need to change the names of the variables in the model but you
should be able to plot the residuals by customizing these tree lines of
code.

Best,

Virgilio


From halim10-fes at sust.edu  Wed Jan  9 19:26:41 2013
From: halim10-fes at sust.edu (halim10-fes)
Date: Thu, 10 Jan 2013 00:26:41 +0600
Subject: [R-sig-Geo] Problem in regression kriggin
Message-ID: <20130109182328.M68590@sust.edu>

Dear Ashton, Andy and the group,

Thank you very much for your suggestions. Yes, specifying ?data=data? is 
throwing the error and 

prk.rich<-krige(Richness~Elev, data, newdata=grd, model=fit.sph1)

is not giving that. But regarding your second suggestion to have elevation 
covariate at all location on the prediction grid or DEM, I am lost again. 
Please help me out. The issue is as follows:

Since I have no DEM at this moment, I have interpolated (ordinary krigging) 
the elevation of the whole study area based on 125 plots:

g.sph <- gstat(gelev, id="Elev", model=fit.sph)
p.sph <- predict(g.sph, model=fit.sph, newdata=grd)
a<-(p.sph["Elev.pred"])
library(raster)
raster(a)
s <- as(a, 'SpatialGridDataFrame')
str(s)

Formal class 'SpatialGridDataFrame' [package "sp"] with 4 slots
  ..@ data       :'data.frame':	20212 obs. of  1 variable:
  .. ..$ Elev.pred: num [1:20212] 70.3 70.2 70.2 70.2 70.2 ...
  ..@ grid       :Formal class 'GridTopology' [package "sp"] with 3 slots
  .. .. ..@ cellcentre.offset: Named num [1:2] 341960 2667253
  .. .. .. ..- attr(*, "names")= chr [1:2] "x" "y"
  .. .. ..@ cellsize         : Named num [1:2] 10 10
  .. .. .. ..- attr(*, "names")= chr [1:2] "x" "y"
  .. .. ..@ cells.dim        : Named int [1:2] 124 163
  .. .. .. ..- attr(*, "names")= chr [1:2] "x" "y"
  ..@ bbox       : num [1:2, 1:2] 341955 2667248 343195 2668878
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : chr [1:2] "x" "y"
  .. .. ..$ : chr [1:2] "min" "max"
  ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slots
  .. .. ..@ projargs: chr NA

And then I tried regression krigging as follows:

prk.rich<-krige(Richness~Elev, data, newdata=s, model=fit.sph1)

But it gave me following error:

Error in gstat.formula.predict(d$formula, newdata, na.action = na.action,  : 
  NROW(locs) != NROW(X): this should not occur
In addition: Warning messages:
1: 'newdata' had 20212 rows but variable(s) found have 125 rows 
2: 'newdata' had 20212 rows but variable(s) found have 125 rows

I have gone through http://spatial-analyst.net/wiki/index.php?
title=Regression-kriging_guide  and other possible different guidelines but 
could not come to any conclusion.

Any help is appreciated.


Best regards,

---------------
Md. Abdul Halim
Assistant Professor
Department of Forestry and Environmental Science
Shahjalal University of Science and Technology,Sylhet-3114,
Bangladesh.
Cell: +8801714078386.
alt. e-mail: xou03 at yahoo.com


-- 
This message has been scanned for viruses and
dangerous content by MailScanner, and is
believed to be clean.


From zua3 at cornell.edu  Wed Jan  9 21:34:34 2013
From: zua3 at cornell.edu (Zia Uddin Ahmed)
Date: Wed, 9 Jan 2013 20:34:34 +0000
Subject: [R-sig-Geo] Problem in regression kriggin
In-Reply-To: <20130109182328.M68590@sust.edu>
References: <20130109182328.M68590@sust.edu>
Message-ID: <2D58402B-0FDD-4869-BC4D-017DB05DB4C2@cornell.edu>

Your prediction grid must  have elevation data, that you predicted by OK. Newdata  file (prediction grid file) may be looks like this:
x
y
Elev

Data file: x  y Richness  Elev
Zia

Sent from my iPad

On Jan 9, 2013, at 2:33 PM, "halim10-fes" <halim10-fes at sust.edu> wrote:

> Dear Ashton, Andy and the group,
> 
> Thank you very much for your suggestions. Yes, specifying 'data=data' is 
> throwing the error and 
> 
> prk.rich<-krige(Richness~Elev, data, newdata=grd, model=fit.sph1)
> 
> is not giving that. But regarding your second suggestion to have elevation 
> covariate at all location on the prediction grid or DEM, I am lost again. 
> Please help me out. The issue is as follows:
> 
> Since I have no DEM at this moment, I have interpolated (ordinary krigging) 
> the elevation of the whole study area based on 125 plots:
> 
> g.sph <- gstat(gelev, id="Elev", model=fit.sph)
> p.sph <- predict(g.sph, model=fit.sph, newdata=grd)
> a<-(p.sph["Elev.pred"])
> library(raster)
> raster(a)
> s <- as(a, 'SpatialGridDataFrame')
> str(s)
> 
> Formal class 'SpatialGridDataFrame' [package "sp"] with 4 slots
>  ..@ data       :'data.frame':    20212 obs. of  1 variable:
>  .. ..$ Elev.pred: num [1:20212] 70.3 70.2 70.2 70.2 70.2 ...
>  ..@ grid       :Formal class 'GridTopology' [package "sp"] with 3 slots
>  .. .. ..@ cellcentre.offset: Named num [1:2] 341960 2667253
>  .. .. .. ..- attr(*, "names")= chr [1:2] "x" "y"
>  .. .. ..@ cellsize         : Named num [1:2] 10 10
>  .. .. .. ..- attr(*, "names")= chr [1:2] "x" "y"
>  .. .. ..@ cells.dim        : Named int [1:2] 124 163
>  .. .. .. ..- attr(*, "names")= chr [1:2] "x" "y"
>  ..@ bbox       : num [1:2, 1:2] 341955 2667248 343195 2668878
>  .. ..- attr(*, "dimnames")=List of 2
>  .. .. ..$ : chr [1:2] "x" "y"
>  .. .. ..$ : chr [1:2] "min" "max"
>  ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slots
>  .. .. ..@ projargs: chr NA
> 
> And then I tried regression krigging as follows:
> 
> prk.rich<-krige(Richness~Elev, data, newdata=s, model=fit.sph1)
> 
> But it gave me following error:
> 
> Error in gstat.formula.predict(d$formula, newdata, na.action = na.action,  : 
>  NROW(locs) != NROW(X): this should not occur
> In addition: Warning messages:
> 1: 'newdata' had 20212 rows but variable(s) found have 125 rows 
> 2: 'newdata' had 20212 rows but variable(s) found have 125 rows
> 
> I have gone through http://spatial-analyst.net/wiki/index.php?
> title=Regression-kriging_guide  and other possible different guidelines but 
> could not come to any conclusion.
> 
> Any help is appreciated.
> 
> 
> Best regards,
> 
> ---------------
> Md. Abdul Halim
> Assistant Professor
> Department of Forestry and Environmental Science
> Shahjalal University of Science and Technology,Sylhet-3114,
> Bangladesh.
> Cell: +8801714078386.
> alt. e-mail: xou03 at yahoo.com
> 
> 
> -- 
> This message has been scanned for viruses and
> dangerous content by MailScanner, and is
> believed to be clean.
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From milansharma2012 at yahoo.com  Wed Jan  9 22:07:37 2013
From: milansharma2012 at yahoo.com (Milan Sharma)
Date: Wed, 9 Jan 2013 13:07:37 -0800 (PST)
Subject: [R-sig-Geo] Poisson regression spatial residual plot
In-Reply-To: <1357694933.83315.YahooMailNeo@web162104.mail.bf1.yahoo.com>
References: <1357085310.26767.YahooMailNeo@web162101.mail.bf1.yahoo.com>
	<1357656525.94998.YahooMailNeo@web162101.mail.bf1.yahoo.com>
	<1357674125.3019.14.camel@virgil-HP-Compaq-8000-Elite-USDT-PC>
	<1357694933.83315.YahooMailNeo@web162104.mail.bf1.yahoo.com>
Message-ID: <1357765657.89756.YahooMailNeo@web162101.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130109/9407730f/attachment.pl>

From edzer.pebesma at uni-muenster.de  Wed Jan  9 23:31:46 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 09 Jan 2013 23:31:46 +0100
Subject: [R-sig-Geo] Problem in regression kriggin
In-Reply-To: <20130109182328.M68590@sust.edu>
References: <20130109182328.M68590@sust.edu>
Message-ID: <50EDEFD2.8030707@uni-muenster.de>



On 01/09/2013 07:26 PM, halim10-fes wrote:
> Dear Ashton, Andy and the group,
> 
> Thank you very much for your suggestions. Yes, specifying ?data=data? is 
> throwing the error and 
> 
> prk.rich<-krige(Richness~Elev, data, newdata=grd, model=fit.sph1)
> 
> is not giving that. But regarding your second suggestion to have elevation 
> covariate at all location on the prediction grid or DEM, I am lost again. 
> Please help me out. The issue is as follows:
> 
> Since I have no DEM at this moment, I have interpolated (ordinary krigging) 
> the elevation of the whole study area based on 125 plots:
> 
> g.sph <- gstat(gelev, id="Elev", model=fit.sph)

what is gelev?

> p.sph <- predict(g.sph, model=fit.sph, newdata=grd)
> a<-(p.sph["Elev.pred"])
> library(raster)
> raster(a)

this seems useless to me.

> s <- as(a, 'SpatialGridDataFrame')

this too.

> str(s)
> 
> Formal class 'SpatialGridDataFrame' [package "sp"] with 4 slots
>   ..@ data       :'data.frame':	20212 obs. of  1 variable:
>   .. ..$ Elev.pred: num [1:20212] 70.3 70.2 70.2 70.2 70.2 ...
>   ..@ grid       :Formal class 'GridTopology' [package "sp"] with 3 slots
>   .. .. ..@ cellcentre.offset: Named num [1:2] 341960 2667253
>   .. .. .. ..- attr(*, "names")= chr [1:2] "x" "y"
>   .. .. ..@ cellsize         : Named num [1:2] 10 10
>   .. .. .. ..- attr(*, "names")= chr [1:2] "x" "y"
>   .. .. ..@ cells.dim        : Named int [1:2] 124 163
>   .. .. .. ..- attr(*, "names")= chr [1:2] "x" "y"
>   ..@ bbox       : num [1:2, 1:2] 341955 2667248 343195 2668878
>   .. ..- attr(*, "dimnames")=List of 2
>   .. .. ..$ : chr [1:2] "x" "y"
>   .. .. ..$ : chr [1:2] "min" "max"
>   ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slots
>   .. .. ..@ projargs: chr NA
> 
> And then I tried regression krigging as follows:
> 
> prk.rich<-krige(Richness~Elev, data, newdata=s, model=fit.sph1)

data has an Elev attribute, but s has an Elev.pred attribute. Mabye it
helps if you first do a

s$Elev = s$Elev.pred

and then

prk.rich<-krige(Richness~Elev, data, newdata=s, model=fit.sph1)

There is much unclear, and none of this is reproducible for us.

Doing regression kriging with interpolated variables sounds a bit like a
Baron M?nchhausen strategy, pulling yourself up by your own hair.


> 
> But it gave me following error:
> 
> Error in gstat.formula.predict(d$formula, newdata, na.action = na.action,  : 
>   NROW(locs) != NROW(X): this should not occur
> In addition: Warning messages:
> 1: 'newdata' had 20212 rows but variable(s) found have 125 rows 
> 2: 'newdata' had 20212 rows but variable(s) found have 125 rows
> 
> I have gone through http://spatial-analyst.net/wiki/index.php?
> title=Regression-kriging_guide  and other possible different guidelines but 
> could not come to any conclusion.
> 
> Any help is appreciated.
> 
> 
> Best regards,
> 
> ---------------
> Md. Abdul Halim
> Assistant Professor
> Department of Forestry and Environmental Science
> Shahjalal University of Science and Technology,Sylhet-3114,
> Bangladesh.
> Cell: +8801714078386.
> alt. e-mail: xou03 at yahoo.com
> 
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From edzer.pebesma at uni-muenster.de  Wed Jan  9 23:34:44 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 09 Jan 2013 23:34:44 +0100
Subject: [R-sig-Geo] Poisson regression spatial residual plot
In-Reply-To: <1357765657.89756.YahooMailNeo@web162101.mail.bf1.yahoo.com>
References: <1357085310.26767.YahooMailNeo@web162101.mail.bf1.yahoo.com>
	<1357656525.94998.YahooMailNeo@web162101.mail.bf1.yahoo.com>
	<1357674125.3019.14.camel@virgil-HP-Compaq-8000-Elite-USDT-PC>
	<1357694933.83315.YahooMailNeo@web162104.mail.bf1.yahoo.com>
	<1357765657.89756.YahooMailNeo@web162101.mail.bf1.yahoo.com>
Message-ID: <50EDF084.2030905@uni-muenster.de>



On 01/09/2013 10:07 PM, Milan Sharma wrote:
> Dear all,?  
> I want to plot Poisson regression spatial residual plot, all the codes run but there is a small error?  at the end in spplot command, which is shown below. Can someone figure out what is wrong?
> ##################################
>> GLMp <- glm(Tcrash~X100MVMT+Alcohol+Alignment+PVMT+offset(log(population)), data=data, family="poisson")
>> summary(GLMp)
> 
> Call:
> glm(formula = Tcrash ~ X100MVMT + Alcohol + Alignment + PVMT + 
> ? ? ?  offset(log(population)), family = "poisson", data = data)
> 
> Deviance Residuals: 
> ? ? ?  Min? ? ? ? ? ?  1Q? ?  Median? ? ? ? ? ?  3Q? ? ? ? ?  Max ? 
> -19.144? ?  -3.900? ?  -0.500? ? ?  2.693? ?  24.990
>  ? 
> 
> Coefficients:
> ? ? ? ? ? ? ? ? ? ? ? ? ?  Estimate Std. Error z value Pr(>|z|)? ?  ? 
> (Intercept) -4.456e+00?  4.740e-02 -94.012?  < 2e-16 ***
> X100MVMT? ? ?  -5.574e-05?  2.457e-06 -22.688?  < 2e-16 ***
> Alcohol? ? ? ?  -2.378e+00?  2.598e-01?  -9.153?  < 2e-16 ***
> Alignment? ? ?  2.872e-01?  7.207e-02? ?  3.985 6.75e-05 ***
> PVMT? ? ? ? ? ? ? ?  7.467e-01?  1.197e-01? ?  6.236 4.48e-10 ***
> ---
> Signif. codes:?  0 ???***??? 0.001 ???**??? 0.01 ???*??? 0.05 ???.??? 0.1 ??? ??? 1 
> 
> (Dispersion parameter for poisson family taken to be 1)
> 
> ? ? ?  Null deviance: 5089.2?  on 70?  degrees of freedom
> Residual deviance: 3736.1?  on 66?  degrees of freedom
> AIC: 4325.1
> 
> Number of
>  Fisher Scoring iterations: 4
> 
>> lmpresid <- residuals(GLMp, type="deviance")
>> #Display residuals; REMOVE sp.layout=list(TCEpts)
>> spplot(data, "lmpresid",col.regions=grey.colors(9, 0.95, 0.55, 2.2), at=seq(-3,5,length.out=9))
> Error in function (classes, fdef, mtable)?  : 
> ?  unable to find an inherited method for function "spplot", for signature "data.frame"
>>
> Milan

Milan, your email is unreadable and your script is unreproducible.

the error says that object data (which I don't see created in your
script) is of class data.frame -- spplot needs Spatial* objects to do
something useful.

> 
> 
> 
> 
> ________________________________
>  From: Virgilio G??mez-Rubio <virgilio.gomez at uclm.es>
> 
> Cc: "r-sig-geo at r-project.org" <r-sig-geo at r-project.org> 
> Sent: Tuesday, January 8, 2013 1:42 PM
> Subject: Re: [R-sig-Geo] Poisson regression spatial residual plot
> 
> Dear Milan, 
> 
> El mar, 08-01-2013 a las 06:48 -0800, Milan Sharma escribi??:
>>
>> Dear list,
>> I wanted to plot residuals from poisson regression model (like the figure 10.5 of Applied spatial data analysis with R, Bivand et. al.).
>> My data has response,Tcrash, and the covariates,
>> 100MVMT, Alcohol PVMT Alignment 
>> and longitude and latitude.
>> I used their code, but what "TCE" represents in my case, I am unable to figure out.
> 
> TCE refers to a number of sites and they are just another layer on the
> plot but has nothing to do on the GLM.
> 
>> I will paste a small portion of data and code here, if that helps.
>> Please, help me, if possible.
>> wi<-map("county", "wisconsin", fill=TRUE, plot=FALSE)
>> county.names<-as.character(wi$names)
>> wi.sp<-map2SpatialPolygons(wi, IDs=county.names, proj4string=CRS("+proj=longlat"))
>> WI_queen<-poly2nb(wi.sp,
>  queen=TRUE)
>> WI_queenb<-nb2listw(WI_queen, style="B")
>> summary(WI_queenb)
>> WI_queenw<-nb2listw(WI_queen, style="W")
>> County population Tcrash 100MVMT Alcohol PVMT Alignment Longitude Latitude 
>> adams 18643 225 225.6 0.093333 0.288889 0.155556 -89.792 43.95184 
>> ashland 16866 187 174.3 0.058824 0.368984 0.235294 -90.7791 46.46137 
>> barron 44963 379 495.5 0.055409 0.358839 0.248021 -91.821 45.43696 
> 
> 
> The R code in lat2.R (available from www.asdar-book.org) that need to
> look at are:
> 
> #Fit GLM
> nyGLMp <- glm(Cases~PEXPOSURE+PCTAGE65P+PCTOWNHOME+offset(log(POP8)),
> data=NY8, family="poisson")
> 
> #Get residuals
> NY8$lmpresid <- residuals(nyGLMp, type="deviance")
> 
> #Display residuals; REMOVE sp.layout=list(TCEpts)
> spplot(NY8, "lmpresid", sp.layout=list(TCEpts),
> col.regions=grey.colors(9, 0.95, 0.55, 2.2),
>  at=seq(-3,5,length.out=9))
> 
> 
> You will need to change the names of the variables in the model but you
> should be able to plot the residuals by customizing these tree lines of
> code.
> 
> Best,
> 
> Virgilio
> 	[[alternative HTML version deleted]]
> 
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From milansharma2012 at yahoo.com  Thu Jan 10 04:13:42 2013
From: milansharma2012 at yahoo.com (Milan Sharma)
Date: Wed, 9 Jan 2013 19:13:42 -0800 (PST)
Subject: [R-sig-Geo] Poisson regression spatial residual plot
In-Reply-To: <50EDF084.2030905@uni-muenster.de>
References: <1357085310.26767.YahooMailNeo@web162101.mail.bf1.yahoo.com>
	<1357656525.94998.YahooMailNeo@web162101.mail.bf1.yahoo.com>
	<1357674125.3019.14.camel@virgil-HP-Compaq-8000-Elite-USDT-PC>
	<1357694933.83315.YahooMailNeo@web162104.mail.bf1.yahoo.com>
	<1357765657.89756.YahooMailNeo@web162101.mail.bf1.yahoo.com>
	<50EDF084.2030905@uni-muenster.de>
Message-ID: <1357787622.77938.YahooMailNeo@web162103.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130109/f7a4be41/attachment.pl>

From piero.campa at gmail.com  Thu Jan 10 15:20:55 2013
From: piero.campa at gmail.com (Piero Campalani)
Date: Thu, 10 Jan 2013 15:20:55 +0100
Subject: [R-sig-Geo] Weird experimental 3D spatiotemporal variogram
Message-ID: <CAMp9JaMqj-nDBc25oixoBcJVxDR5-bi7e-EwypGjKp156CV=tw@mail.gmail.com>

Dear list,

I am predicting PM measurements on a spatiotemporal grid with monthly
intervals in time.
At modeling time, I am looking at the experimental 3D variograms
(`wireframes`) but I see that weird decreasing behavior in time (see
wireframes_2008-1.eps for January 2008): there is a peak at 0 time lags,
then correlation in time is much higher over different days.
How can I interpret such variogram?
Would it mean that there is a very high spatial variability for values on
the same day, whereas temporal variability is significantly lower?

Thanks for any hint,
(I can provide implementation details in case of need)

Piero
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130110/a16591a2/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: wireframes_2008-1.eps
Type: application/postscript
Size: 19612 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130110/a16591a2/attachment.eps>

From milansharma2012 at yahoo.com  Thu Jan 10 17:23:30 2013
From: milansharma2012 at yahoo.com (Milan Sharma)
Date: Thu, 10 Jan 2013 08:23:30 -0800 (PST)
Subject: [R-sig-Geo] Poisson regression spatial residual plot
In-Reply-To: <CAJjzREFB8F8NWP_910JDn4T7_M04SK6SUDHXSWhgKYkUQYXQ1w@mail.gmail.com>
References: <1357085310.26767.YahooMailNeo@web162101.mail.bf1.yahoo.com>
	<1357656525.94998.YahooMailNeo@web162101.mail.bf1.yahoo.com>
	<1357674125.3019.14.camel@virgil-HP-Compaq-8000-Elite-USDT-PC>
	<1357694933.83315.YahooMailNeo@web162104.mail.bf1.yahoo.com>
	<1357765657.89756.YahooMailNeo@web162101.mail.bf1.yahoo.com>
	<50EDF084.2030905@uni-muenster.de>
	<1357787622.77938.YahooMailNeo@web162103.mail.bf1.yahoo.com>
	<CAJjzREFB8F8NWP_910JDn4T7_M04SK6SUDHXSWhgKYkUQYXQ1w@mail.gmail.com>
Message-ID: <1357835010.48033.YahooMailNeo@web162106.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130110/810c6ff1/attachment.pl>

From narayani at ku.edu  Thu Jan 10 20:19:26 2013
From: narayani at ku.edu (Narayani Barve)
Date: Thu, 10 Jan 2013 13:19:26 -0600
Subject: [R-sig-Geo] error in rasterFromXYZ
Message-ID: <CAE=+0-JA=kKtWwGKiDwURTX=OfwzwWzHnkqZsSx35UDM29TFww@mail.gmail.com>

Hi All,

I have ESRI ASCII grid format files. I want to apply principal
component on those files and then save those PCA components into ASCII
grid format. I used raster package to perform this operation. My steps
are
1. Read ASCII file, and make stack
2. Use rasterToPoints function to get the matrix to be used for PCA
3. use princomp function on the generated table above.
4. extract the scores from pca output.
5. convert the score of each component to table of 3 columns (x,y,comp)
6. use rasterFromXYZ function to convert the component to raster
7. Save the raster object to ASCII grid.

The trouble is I am receiving error at step 6, for rasterFromXYZ
function. It says "Error in rasterFromXYZ(tbl2) : y cell sizes are not
regular"
I checked the cell sizes for both x and y, to be sure. It is square. I
also tried supplying, digits=5 argument, but no use. I am not able
tease out the error. Am I doing anything wrong? The written code is
below. I cannot supply with the files, as these files are huge.

   BioStack = MakeStack("Select ASCII files :")
   BioPt1 = rasterToPoints(BioStack)
   print("Generating principal component")
   pcaPt1 = princomp(BioPt1[,3:dim(BioPt1)[2]], cor = "TRUE")
   pcaScores = pcaPt1$scores
   d1 = dim(pcaScores)
   for ( i in 1:d1[2])
   {
      print(paste("Writing principal component file ", i ), sep = " ")
      tbl1 = cbind(BioPt1[,1:2], pcaScores[,i])
      r2 = rasterFromXYZ(tbl1,digits=5)
      FileName = paste("Comp",i,".asc", sep = "")
      writeRaster(r2,FileName)
   }


Thank you in advance and any help is appreciated.

Narayani


-- 
Narayani Barve
PhD Candidate,
Ecology and Evolutionary Biology,
University of Kansas, KS 66044


From subbu_843 at yahoo.co.in  Thu Jan 10 20:40:42 2013
From: subbu_843 at yahoo.co.in (subash)
Date: Thu, 10 Jan 2013 11:40:42 -0800 (PST)
Subject: [R-sig-Geo] kriging on transformed data
Message-ID: <1357846842040-7582280.post@n2.nabble.com>

I am beginner in R.I have seen that prior to using kriging the data
distribution has to be investigated to check if they are gaussian.

The quantile-quantile plot of rainfall on a day using 50 stations data 
<http://r-sig-geo.2731867.n2.nabble.com/file/n7582280/prob_plot.png>  . The
q-q plotof log tarnsformed rainfall data 
<http://r-sig-geo.2731867.n2.nabble.com/file/n7582280/log_trsanformed.png> 
is also attached.

I have few basic questions:

(1) How to back transform the data  after interploation?
(2) How to choose the block size in block kriging? any guidelines. I would
like to compare the kriged value against the gridded rainfall from TRMM(25
km by 25 km)?
(3) If the interpolation was performed on square root transformed data , how
is the back transformation done?

Thanks you.




--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/kriging-on-transformed-data-tp7582280.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From mdsumner at gmail.com  Thu Jan 10 20:55:38 2013
From: mdsumner at gmail.com (Michael Sumner)
Date: Fri, 11 Jan 2013 06:55:38 +1100
Subject: [R-sig-Geo] error in rasterFromXYZ
In-Reply-To: <CAE=+0-JA=kKtWwGKiDwURTX=OfwzwWzHnkqZsSx35UDM29TFww@mail.gmail.com>
References: <CAE=+0-JA=kKtWwGKiDwURTX=OfwzwWzHnkqZsSx35UDM29TFww@mail.gmail.com>
Message-ID: <CAAcGz9-oTs2GjDtnu_aCi5+xADh9rQVg9830o-e-fbqx_6KzFA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130111/2f3908ee/attachment.pl>

From etiennebr at gmail.com  Thu Jan 10 21:05:23 2013
From: etiennebr at gmail.com (Etienne B. Racine)
Date: Thu, 10 Jan 2013 15:05:23 -0500
Subject: [R-sig-Geo] error in rasterFromXYZ
In-Reply-To: <CAAcGz9-oTs2GjDtnu_aCi5+xADh9rQVg9830o-e-fbqx_6KzFA@mail.gmail.com>
References: <CAE=+0-JA=kKtWwGKiDwURTX=OfwzwWzHnkqZsSx35UDM29TFww@mail.gmail.com>
	<CAAcGz9-oTs2GjDtnu_aCi5+xADh9rQVg9830o-e-fbqx_6KzFA@mail.gmail.com>
Message-ID: <CALjAYt4rwkOJ6YF8mT5ADyeAFxKdGzLj-hW-YKEU=yvn4X2PjQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130110/a8de391e/attachment.pl>

From narayani at ku.edu  Thu Jan 10 21:31:12 2013
From: narayani at ku.edu (Narayani Barve)
Date: Thu, 10 Jan 2013 14:31:12 -0600
Subject: [R-sig-Geo] error in rasterFromXYZ
In-Reply-To: <CAAcGz9-oTs2GjDtnu_aCi5+xADh9rQVg9830o-e-fbqx_6KzFA@mail.gmail.com>
References: <CAE=+0-JA=kKtWwGKiDwURTX=OfwzwWzHnkqZsSx35UDM29TFww@mail.gmail.com>
	<CAAcGz9-oTs2GjDtnu_aCi5+xADh9rQVg9830o-e-fbqx_6KzFA@mail.gmail.com>
Message-ID: <CAE=+0-+BBUsKjXHOdNEEXwkdr1gRoEdraFK4FK8bv-nXAdoHrA@mail.gmail.com>

Hi Michael,

I generate a table of x,y and z after principal component is
generated. In this case z is PCA component value and thus this is my
xyz table which I want to convert to raster using rasterFromXYZ
command.

Regards,
Narayani

On Thu, Jan 10, 2013 at 1:55 PM, Michael Sumner <mdsumner at gmail.com> wrote:
> Regular is different to square, and ESRI ASCII is not XYZ. I suspect you
> should just read it with raster().
>
> HTH
>
> On Friday, January 11, 2013, Narayani Barve wrote:
>>
>> Hi All,
>>
>> I have ESRI ASCII grid format files. I want to apply principal
>> component on those files and then save those PCA components into ASCII
>> grid format. I used raster package to perform this operation. My steps
>> are
>> 1. Read ASCII file, and make stack
>> 2. Use rasterToPoints function to get the matrix to be used for PCA
>> 3. use princomp function on the generated table above.
>> 4. extract the scores from pca output.
>> 5. convert the score of each component to table of 3 columns (x,y,comp)
>> 6. use rasterFromXYZ function to convert the component to raster
>> 7. Save the raster object to ASCII grid.
>>
>> The trouble is I am receiving error at step 6, for rasterFromXYZ
>> function. It says "Error in rasterFromXYZ(tbl2) : y cell sizes are not
>> regular"
>> I checked the cell sizes for both x and y, to be sure. It is square. I
>> also tried supplying, digits=5 argument, but no use. I am not able
>> tease out the error. Am I doing anything wrong? The written code is
>> below. I cannot supply with the files, as these files are huge.
>>
>>    BioStack = MakeStack("Select ASCII files :")
>>    BioPt1 = rasterToPoints(BioStack)
>>    print("Generating principal component")
>>    pcaPt1 = princomp(BioPt1[,3:dim(BioPt1)[2]], cor = "TRUE")
>>    pcaScores = pcaPt1$scores
>>    d1 = dim(pcaScores)
>>    for ( i in 1:d1[2])
>>    {
>>       print(paste("Writing principal component file ", i ), sep = " ")
>>       tbl1 = cbind(BioPt1[,1:2], pcaScores[,i])
>>       r2 = rasterFromXYZ(tbl1,digits=5)
>>       FileName = paste("Comp",i,".asc", sep = "")
>>       writeRaster(r2,FileName)
>>    }
>>
>>
>> Thank you in advance and any help is appreciated.
>>
>> Narayani
>>
>>
>>


From narayani at ku.edu  Thu Jan 10 21:32:31 2013
From: narayani at ku.edu (Narayani Barve)
Date: Thu, 10 Jan 2013 14:32:31 -0600
Subject: [R-sig-Geo] error in rasterFromXYZ
In-Reply-To: <CALjAYt4rwkOJ6YF8mT5ADyeAFxKdGzLj-hW-YKEU=yvn4X2PjQ@mail.gmail.com>
References: <CAE=+0-JA=kKtWwGKiDwURTX=OfwzwWzHnkqZsSx35UDM29TFww@mail.gmail.com>
	<CAAcGz9-oTs2GjDtnu_aCi5+xADh9rQVg9830o-e-fbqx_6KzFA@mail.gmail.com>
	<CALjAYt4rwkOJ6YF8mT5ADyeAFxKdGzLj-hW-YKEU=yvn4X2PjQ@mail.gmail.com>
Message-ID: <CAE=+0-LjHw+0F+pc48BVzhDCDL0YxJ37qgx4TH6tzLtaUEsWVA@mail.gmail.com>

I use following function to generate the stack from .asc files.

library(raster)
MakeStack <- function(Prompt)
{
   Mfiles = choose.files(caption=Prompt)
   for (i in 1: length(Mfiles))
   {
      fl1 = raster(Mfiles[i])
	  if (i == 1)
	  {
	     stk = stack(fl1)
	  }
	  else
	  {
	     stk = stack(stk, fl1)
	  }

   }
   return(stk)
}

Regards,
Narayani

On Thu, Jan 10, 2013 at 2:05 PM, Etienne B. Racine <etiennebr at gmail.com> wrote:
> What code are you using to read your stack ?
>
> Try this as a stack (from stack example)
> library(raster)
> fn <- system.file("external/test.grd", package="raster")
> s <- stack(fn, fn, fn)
> BioStack = s
>
> And then run the rest of your code.
> Etienne
>
>
> 2013/1/10 Michael Sumner <mdsumner at gmail.com>
>>
>> Regular is different to square, and ESRI ASCII is not XYZ. I suspect you
>> should just read it with raster().
>>
>> HTH
>>
>> On Friday, January 11, 2013, Narayani Barve wrote:
>>
>> > Hi All,
>> >
>> > I have ESRI ASCII grid format files. I want to apply principal
>> > component on those files and then save those PCA components into ASCII
>> > grid format. I used raster package to perform this operation. My steps
>> > are
>> > 1. Read ASCII file, and make stack
>> > 2. Use rasterToPoints function to get the matrix to be used for PCA
>> > 3. use princomp function on the generated table above.
>> > 4. extract the scores from pca output.
>> > 5. convert the score of each component to table of 3 columns (x,y,comp)
>> > 6. use rasterFromXYZ function to convert the component to raster
>> > 7. Save the raster object to ASCII grid.
>> >
>> > The trouble is I am receiving error at step 6, for rasterFromXYZ
>> > function. It says "Error in rasterFromXYZ(tbl2) : y cell sizes are not
>> > regular"
>> > I checked the cell sizes for both x and y, to be sure. It is square. I
>> > also tried supplying, digits=5 argument, but no use. I am not able
>> > tease out the error. Am I doing anything wrong? The written code is
>> > below. I cannot supply with the files, as these files are huge.
>> >
>> >    BioStack = MakeStack("Select ASCII files :")
>> >    BioPt1 = rasterToPoints(BioStack)
>> >    print("Generating principal component")
>> >    pcaPt1 = princomp(BioPt1[,3:dim(BioPt1)[2]], cor = "TRUE")
>> >    pcaScores = pcaPt1$scores
>> >    d1 = dim(pcaScores)
>> >    for ( i in 1:d1[2])
>> >    {
>> >       print(paste("Writing principal component file ", i ), sep = " ")
>> >       tbl1 = cbind(BioPt1[,1:2], pcaScores[,i])
>> >       r2 = rasterFromXYZ(tbl1,digits=5)
>> >       FileName = paste("Comp",i,".asc", sep = "")
>> >       writeRaster(r2,FileName)
>> >    }
>> >
>> >
>> > Thank you in advance and any help is appreciated.
>> >
>> > Narayani
>> >
>> >
>> > -
>


From jon.skoien at jrc.ec.europa.eu  Fri Jan 11 12:10:05 2013
From: jon.skoien at jrc.ec.europa.eu (Jon Olav Skoien)
Date: Fri, 11 Jan 2013 12:10:05 +0100
Subject: [R-sig-Geo] proj4string-issue - leading spaces
Message-ID: <50EFF30D.7060900@jrc.ec.europa.eu>

Dear list,

Leading spaces seems to be a tricky thing in proj4strings, I think the 
issue below is related to the following post where leading spaces where 
removed:
http://r-sig-geo.2731867.n2.nabble.com/a-minor-bug-in-rgdal-tt7581906.html#none

It seems the stripping of leading spaces has created another issue in my 
case, when overlaying objects with (from outside R) and without (created 
in R) these spaces, as over calls identical to check if the proj4strings 
are equal.  Below is an example where I add a space to the proj4string, 
similar to the object I actually get from outside R:

# (R 2.15-1, sp_1.0-5, rgdal_0.8-01)
library(rgdal)
spdf = SpatialPixelsDataFrame(matrix(c(0,0,1,1,0,1,1,0), ncol = 2), 
proj4string = CRS("+init=epsg:4326"), data = data.frame(dat = 1:4))
P1 = Polygon(cbind(c(0,0,1,1,0),c(0,1,1,0,0)))
P2 = Polygons(list(P1), "p1")
SpP = SpatialPolygons(list(P2), proj4string = CRS(" +init=epsg:4326"))
over(SpP, spdf)

# Up to here it works fine, as the leading space in SpP was stripped by 
the CRS function. Then I add this space directly to projargs, as the 
objects I am loading:
spdf at proj4string@projargs = SpP at proj4string@projargs = paste(" 
",proj4string(spdf), sep = "")
proj4string(spdf)
over(SpP, spdf)

#However, when setting the proj4string with CRS on one of them and doing 
the overlay:
proj4string(spdf) = CRS(proj4string(spdf))
over(SpP, spdf)

#  I get an error because of the missing space in one of the objects. In 
my case this error comes when spdf is transformed to a different 
projection and back again:
spdfb = spTransform(spdf, CRS("+proj=moll +lon_0+x_0+y_0") )
# do something with spdfb
spdfc = spTransform(spdfb, CRS(proj4string(spdf)))
over(SpP, spdfc) # will then fail in the same way as above.

Is there a simple way to solve this, not having check and modify the 
proj4string of all objects? Or could the call to identical in functions 
like over be replaced by an identicalCRS()-function?

identicalCRS = function(x,y) {
   identical(CRS(proj4string(x)), CRS(proj4string(y)))
}

Thanks,
Jon

-- 
Jon Olav Sk?ien
Joint Research Centre - European Commission
Institute for Environment and Sustainability (IES)
Land Resource Management Unit

Via Fermi 2749, TP 440,  I-21027 Ispra (VA), ITALY

jon.skoien at jrc.ec.europa.eu
Tel:  +39 0332 789206

Disclaimer: Views expressed in this email are those of the individual and do not necessarily represent official views of the European Commission.


From edzer.pebesma at uni-muenster.de  Fri Jan 11 12:34:53 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 11 Jan 2013 12:34:53 +0100
Subject: [R-sig-Geo] proj4string-issue - leading spaces
In-Reply-To: <50EFF30D.7060900@jrc.ec.europa.eu>
References: <50EFF30D.7060900@jrc.ec.europa.eu>
Message-ID: <50EFF8DD.5060904@uni-muenster.de>



On 01/11/2013 12:10 PM, Jon Olav Skoien wrote:
> 
> Is there a simple way to solve this, not having check and modify the
> proj4string of all objects? Or could the call to identical in functions
> like over be replaced by an identicalCRS()-function?
> 
> identicalCRS = function(x,y) {
>   identical(CRS(proj4string(x)), CRS(proj4string(y)))
> }

Great suggestion, Jon; I added this to sp on r-forge.
-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From Roger.Bivand at nhh.no  Fri Jan 11 12:36:17 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 11 Jan 2013 12:36:17 +0100
Subject: [R-sig-Geo] proj4string-issue - leading spaces
In-Reply-To: <50EFF30D.7060900@jrc.ec.europa.eu>
References: <50EFF30D.7060900@jrc.ec.europa.eu>
Message-ID: <alpine.LRH.2.02.1301111227160.4785@reclus.nhh.no>

On Fri, 11 Jan 2013, Jon Olav Skoien wrote:

> Dear list,
>
> Leading spaces seems to be a tricky thing in proj4strings, I think the issue 
> below is related to the following post where leading spaces where removed:
> http://r-sig-geo.2731867.n2.nabble.com/a-minor-bug-in-rgdal-tt7581906.html#none

Well, preferably:

https://stat.ethz.ch/pipermail/r-sig-geo/2012-December/016913.html

but also see:

http://cran.r-project.org/web/packages/rgdal/ChangeLog

or

library(rgdal)
file.show(system.file("ChangeLog", package="rgdal"))

See also:

https://r-forge.r-project.org/scm/viewvc.php/pkg/R/Class-CRSx.R?root=rgdal&r1=378&r2=401

https://r-forge.r-project.org/scm/viewvc.php/pkg/src/projectit.cpp?root=rgdal&r1=361&r2=401

The underlying problem is the very widespread use of identical() in all 
kinds of code in lots of places. Since the rgdal release in December, 
entry into libproj is not going to prepend spaces anymore. So over time, 
workarounds to add spaces will cease to be needed. In the mean time, all 
use of identical() for comparing these character strings remains 
problematic. Extending to a dependency from sp to the compare package 
seems unnecessary, but the sp package could offer a function to compare 
CRS directly - contributions welcome!

Roger

>
> It seems the stripping of leading spaces has created another issue in my 
> case, when overlaying objects with (from outside R) and without (created in 
> R) these spaces, as over calls identical to check if the proj4strings are 
> equal.  Below is an example where I add a space to the proj4string, similar 
> to the object I actually get from outside R:
>
> # (R 2.15-1, sp_1.0-5, rgdal_0.8-01)
> library(rgdal)
> spdf = SpatialPixelsDataFrame(matrix(c(0,0,1,1,0,1,1,0), ncol = 2), 
> proj4string = CRS("+init=epsg:4326"), data = data.frame(dat = 1:4))
> P1 = Polygon(cbind(c(0,0,1,1,0),c(0,1,1,0,0)))
> P2 = Polygons(list(P1), "p1")
> SpP = SpatialPolygons(list(P2), proj4string = CRS(" +init=epsg:4326"))
> over(SpP, spdf)
>
> # Up to here it works fine, as the leading space in SpP was stripped by the 
> CRS function. Then I add this space directly to projargs, as the objects I am 
> loading:
> spdf at proj4string@projargs = SpP at proj4string@projargs = paste(" 
> ",proj4string(spdf), sep = "")
> proj4string(spdf)
> over(SpP, spdf)
>
> #However, when setting the proj4string with CRS on one of them and doing the 
> overlay:
> proj4string(spdf) = CRS(proj4string(spdf))
> over(SpP, spdf)
>
> #  I get an error because of the missing space in one of the objects. In my 
> case this error comes when spdf is transformed to a different projection and 
> back again:
> spdfb = spTransform(spdf, CRS("+proj=moll +lon_0+x_0+y_0") )
> # do something with spdfb
> spdfc = spTransform(spdfb, CRS(proj4string(spdf)))
> over(SpP, spdfc) # will then fail in the same way as above.
>
> Is there a simple way to solve this, not having check and modify the 
> proj4string of all objects? Or could the call to identical in functions like 
> over be replaced by an identicalCRS()-function?
>
> identicalCRS = function(x,y) {
>  identical(CRS(proj4string(x)), CRS(proj4string(y)))
> }
>
> Thanks,
> Jon
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Fri Jan 11 12:42:58 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 11 Jan 2013 12:42:58 +0100
Subject: [R-sig-Geo] proj4string-issue - leading spaces
In-Reply-To: <50EFF8DD.5060904@uni-muenster.de>
References: <50EFF30D.7060900@jrc.ec.europa.eu>
	<50EFF8DD.5060904@uni-muenster.de>
Message-ID: <alpine.LRH.2.02.1301111239430.4785@reclus.nhh.no>

On Fri, 11 Jan 2013, Edzer Pebesma wrote:

>
>
> On 01/11/2013 12:10 PM, Jon Olav Skoien wrote:
>>
>> Is there a simple way to solve this, not having check and modify the
>> proj4string of all objects? Or could the call to identical in functions
>> like over be replaced by an identicalCRS()-function?
>>
>> identicalCRS = function(x,y) {
>>   identical(CRS(proj4string(x)), CRS(proj4string(y)))
>> }
>
> Great suggestion, Jon; I added this to sp on r-forge.

Not so great, it doesn't address the problem that users with different 
versions of rgdal (and/or with stored objects from older versions of 
rgdal) may have extraneous prepended spaces. The function nees to test for 
NA or not, then length, if lengths equal, OK, test, if differ by one check 
whether space and if so trim, ...

Roger

>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From jon.skoien at jrc.ec.europa.eu  Fri Jan 11 14:29:06 2013
From: jon.skoien at jrc.ec.europa.eu (Jon Olav Skoien)
Date: Fri, 11 Jan 2013 14:29:06 +0100
Subject: [R-sig-Geo] proj4string-issue - leading spaces
In-Reply-To: <alpine.LRH.2.02.1301111239430.4785@reclus.nhh.no>
References: <50EFF30D.7060900@jrc.ec.europa.eu>
	<50EFF8DD.5060904@uni-muenster.de>
	<alpine.LRH.2.02.1301111239430.4785@reclus.nhh.no>
Message-ID: <50F013A2.9060600@jrc.ec.europa.eu>

On 11-Jan-13 12:42, Roger Bivand wrote:
> On Fri, 11 Jan 2013, Edzer Pebesma wrote:
>
>>
>>
>> On 01/11/2013 12:10 PM, Jon Olav Skoien wrote:
>>>
>>> Is there a simple way to solve this, not having check and modify the
>>> proj4string of all objects? Or could the call to identical in functions
>>> like over be replaced by an identicalCRS()-function?
>>>
>>> identicalCRS = function(x,y) {
>>>   identical(CRS(proj4string(x)), CRS(proj4string(y)))
>>> }
>>
>> Great suggestion, Jon; I added this to sp on r-forge.
>
> Not so great, it doesn't address the problem that users with different 
> versions of rgdal (and/or with stored objects from older versions of 
> rgdal) may have extraneous prepended spaces. The function nees to test 
> for NA or not, then length, if lengths equal, OK, test, if differ by 
> one check whether space and if so trim, ...
>
You mean that the suggestion does not solve the problem when using CRS 
from sp instead of rgdal as the sp-version does not trim leading spaces? 
Then I think an alternative sp version could use gsub without being too 
complicated. Leading spaces can be removed from the proj4string if they 
exists, NAs are not touched:

ch = "+init=epsg:4326"
gsub("^ .", "", ch)
ch = " +init=epsg:4326"
gsub("^ .", "", ch)
ch = NA
gsub("^ .", "", ch)

and the function could be something like:

identicalCRS = function(x,y) {
   if (inherits(x, "Spatial")) x = proj4string(x)
   if (inherits(y, "Spatial")) y = proj4string(y)
   x = gsub("^ .", "", y)
   y = gsub("^ .", "", y)
   identical(x,y)
}

Two NA-proj4strings will be treated as identical, same as they are now. 
However, it will not catch the similarity between "+init=epsg:4326" and 
"+init=epsg:4326 +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs 
+towgs84=0,0,0" such as a possible rgdal-version (first suggestion 
above) can do.

Cheers,
Jon


-- 
Jon Olav Sk?ien
Joint Research Centre - European Commission
Institute for Environment and Sustainability (IES)
Land Resource Management Unit

Via Fermi 2749, TP 440,  I-21027 Ispra (VA), ITALY

jon.skoien at jrc.ec.europa.eu
Tel:  +39 0332 789206

Disclaimer: Views expressed in this email are those of the individual and do not necessarily represent official views of the European Commission.


From Roger.Bivand at nhh.no  Fri Jan 11 14:42:19 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 11 Jan 2013 14:42:19 +0100
Subject: [R-sig-Geo] proj4string-issue - leading spaces
In-Reply-To: <50F013A2.9060600@jrc.ec.europa.eu>
References: <50EFF30D.7060900@jrc.ec.europa.eu>
	<50EFF8DD.5060904@uni-muenster.de>
	<alpine.LRH.2.02.1301111239430.4785@reclus.nhh.no>
	<50F013A2.9060600@jrc.ec.europa.eu>
Message-ID: <alpine.LRH.2.02.1301111438090.4785@reclus.nhh.no>

On Fri, 11 Jan 2013, Jon Olav Skoien wrote:

> On 11-Jan-13 12:42, Roger Bivand wrote:
>> On Fri, 11 Jan 2013, Edzer Pebesma wrote:
>> 
>>> 
>>> 
>>> On 01/11/2013 12:10 PM, Jon Olav Skoien wrote:
>>>> 
>>>> Is there a simple way to solve this, not having check and modify the
>>>> proj4string of all objects? Or could the call to identical in functions
>>>> like over be replaced by an identicalCRS()-function?
>>>> 
>>>> identicalCRS = function(x,y) {
>>>>   identical(CRS(proj4string(x)), CRS(proj4string(y)))
>>>> }
>>> 
>>> Great suggestion, Jon; I added this to sp on r-forge.
>> 
>> Not so great, it doesn't address the problem that users with different 
>> versions of rgdal (and/or with stored objects from older versions of rgdal) 
>> may have extraneous prepended spaces. The function nees to test for NA or 
>> not, then length, if lengths equal, OK, test, if differ by one check 
>> whether space and if so trim, ...
>> 
> You mean that the suggestion does not solve the problem when using CRS from 
> sp instead of rgdal as the sp-version does not trim leading spaces?

There is only one user-facing CRS(), but it behaves differently when rgdal 
is loaded (checking against projlib), or not available (no check against 
projlib). The problem arose because (lazy programming in projlib?) a space 
gets prepended to the string when it passes through projlib (and we 
certainly want to use the output from projlib, because it completes tags 
while going through - it parses the tags as input, and re-assembles them 
on the way back out).

Roger

> Then I think an alternative sp version could use gsub without being too 
> complicated. Leading spaces can be removed from the proj4string if they 
> exists, NAs are not touched:
>
> ch = "+init=epsg:4326"
> gsub("^ .", "", ch)
> ch = " +init=epsg:4326"
> gsub("^ .", "", ch)
> ch = NA
> gsub("^ .", "", ch)
>
> and the function could be something like:
>
> identicalCRS = function(x,y) {
>  if (inherits(x, "Spatial")) x = proj4string(x)
>  if (inherits(y, "Spatial")) y = proj4string(y)
>  x = gsub("^ .", "", y)
>  y = gsub("^ .", "", y)
>  identical(x,y)
> }
>
> Two NA-proj4strings will be treated as identical, same as they are now. 
> However, it will not catch the similarity between "+init=epsg:4326" and 
> "+init=epsg:4326 +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs 
> +towgs84=0,0,0" such as a possible rgdal-version (first suggestion above) can 
> do.
>
> Cheers,
> Jon
>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From jeanbaptiste.paroissien at gmail.com  Fri Jan 11 18:28:21 2013
From: jeanbaptiste.paroissien at gmail.com (Jean-Baptiste)
Date: Fri, 11 Jan 2013 09:28:21 -0800 (PST)
Subject: [R-sig-Geo] grass.script not found in R+grass7 session
Message-ID: <1357925301566-7582292.post@n2.nabble.com>

Hi listers,

I am working on Ubuntu 12.04, R 2.15.2, GRASS 7.0. All function work fine in
a classic GRASS session.

I am trying to run GRASS interface in an R session with spgrass6 and
initGRASS function. When I am used a grass function with command system(), I
am getting the following error message :
"ImportError: No module named grass.script"

I checked python path from the GRASS terminal and getting the following
message :
/usr/local/grass-7.0.svn/etc/python

Any idea on how to fix this problem?
Thanks,

Jean-Baptiste



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/grass-script-not-found-in-R-grass7-session-tp7582292.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Roger.Bivand at nhh.no  Fri Jan 11 18:37:23 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 11 Jan 2013 18:37:23 +0100
Subject: [R-sig-Geo] grass.script not found in R+grass7 session
In-Reply-To: <1357925301566-7582292.post@n2.nabble.com>
References: <1357925301566-7582292.post@n2.nabble.com>
Message-ID: <alpine.LRH.2.02.1301111833530.4785@reclus.nhh.no>

On Fri, 11 Jan 2013, Jean-Baptiste wrote:

> Hi listers,
>
> I am working on Ubuntu 12.04, R 2.15.2, GRASS 7.0. All function work fine in
> a classic GRASS session.
>
> I am trying to run GRASS interface in an R session with spgrass6 and
> initGRASS function. When I am used a grass function with command system(), I
> am getting the following error message :
> "ImportError: No module named grass.script"
>
> I checked python path from the GRASS terminal and getting the following
> message :
> /usr/local/grass-7.0.svn/etc/python
>
> Any idea on how to fix this problem?

None at all, with this level of detail in your account. A simple 
reproducible example is needed (at least with the SVN revision number of 
GRASS 7, it is the development version, and moves fast). You haven't 
included any details of the offending R code, or of the versions of 
packages (output of sessionInfo()). Finally, the right list is:

http://lists.osgeo.org/mailman/listinfo/grass-stats

for this kind of detailed question.

Roger

> Thanks,
>
> Jean-Baptiste
>
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/grass-script-not-found-in-R-grass7-session-tp7582292.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Sat Jan 12 13:16:41 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 12 Jan 2013 13:16:41 +0100
Subject: [R-sig-Geo] grass.script not found in R+grass7 session
In-Reply-To: <alpine.LRH.2.02.1301111833530.4785@reclus.nhh.no>
References: <1357925301566-7582292.post@n2.nabble.com>
	<alpine.LRH.2.02.1301111833530.4785@reclus.nhh.no>
Message-ID: <alpine.LRH.2.02.1301121312490.13505@reclus.nhh.no>

On Fri, 11 Jan 2013, Roger Bivand wrote:

> On Fri, 11 Jan 2013, Jean-Baptiste wrote:
>
>> Hi listers,
>> 
>> I am working on Ubuntu 12.04, R 2.15.2, GRASS 7.0. All function work fine 
>> in
>> a classic GRASS session.
>> 
>> I am trying to run GRASS interface in an R session with spgrass6 and
>> initGRASS function. When I am used a grass function with command system(), 
>> I
>> am getting the following error message :
>> "ImportError: No module named grass.script"
>> 
>> I checked python path from the GRASS terminal and getting the following
>> message :
>> /usr/local/grass-7.0.svn/etc/python
>> 
>> Any idea on how to fix this problem?
>
> None at all, with this level of detail in your account. A simple reproducible 
> example is needed (at least with the SVN revision number of GRASS 7, it is 
> the development version, and moves fast). You haven't included any details of 
> the offending R code, or of the versions of packages (output of 
> sessionInfo()). Finally, the right list is:
>
> http://lists.osgeo.org/mailman/listinfo/grass-stats
>
> for this kind of detailed question.

Further, after updating GRASS 7 to revision 54605, I can run:

library(spgrass6)
data(meuse)
library(rgdal)
coordinates(meuse) <- ~x+y
proj4string(meuse) <- CRS("+init=epsg:28992")
library(maptools)
SG <- Sobj_SpatialGrid(meuse)$SG
td <- tempdir()
loc <- initGRASS("/home/rsb/topics/GRASS/G7svn/grass-7.0.svn", td, SG)
loc
writeVECT6(meuse, "meuse", v.in.ogr_flags="o")

without problems. My sessionInfo() output:

> sessionInfo()
R version 2.15.2 (2012-10-26)
Platform: x86_64-unknown-linux-gnu (64-bit)

locale:
  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
  [7] LC_PAPER=C                 LC_NAME=C
  [9] LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] grid      stats     graphics  grDevices utils     datasets  methods
[8] base

other attached packages:
[1] maptools_0.8-21 lattice_0.20-13 foreign_0.8-52  rgdal_0.8-01
[5] spgrass6_0.7-12 XML_3.95-0.1    sp_1.0-5

loaded via a namespace (and not attached):
[1] tools_2.15.2
> execGRASS("g.version")
GRASS 7.0.svn (2012)

Roger

>
> Roger
>
>> Thanks,
>> 
>> Jean-Baptiste
>> 
>> 
>> 
>> --
>> View this message in context: 
>> http://r-sig-geo.2731867.n2.nabble.com/grass-script-not-found-in-R-grass7-session-tp7582292.html
>> Sent from the R-sig-geo mailing list archive at Nabble.com.
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Sat Jan 12 14:06:12 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 12 Jan 2013 14:06:12 +0100
Subject: [R-sig-Geo] grass.script not found in R+grass7 session
In-Reply-To: <alpine.LRH.2.02.1301121312490.13505@reclus.nhh.no>
References: <1357925301566-7582292.post@n2.nabble.com>
	<alpine.LRH.2.02.1301111833530.4785@reclus.nhh.no>
	<alpine.LRH.2.02.1301121312490.13505@reclus.nhh.no>
Message-ID: <alpine.LRH.2.02.1301121357590.13650@reclus.nhh.no>

On Sat, 12 Jan 2013, Roger Bivand wrote:

> On Fri, 11 Jan 2013, Roger Bivand wrote:
>
>> On Fri, 11 Jan 2013, Jean-Baptiste wrote:
>> 
>>> Hi listers,
>>> 
>>> I am working on Ubuntu 12.04, R 2.15.2, GRASS 7.0. All function work fine 
>>> in
>>> a classic GRASS session.
>>> 
>>> I am trying to run GRASS interface in an R session with spgrass6 and
>>> initGRASS function. When I am used a grass function with command system(), 
>>> I
>>> am getting the following error message :
>>> "ImportError: No module named grass.script"
>>> 
>>> I checked python path from the GRASS terminal and getting the following
>>> message :
>>> /usr/local/grass-7.0.svn/etc/python
>>> 
>>> Any idea on how to fix this problem?
>> 
>> None at all, with this level of detail in your account. A simple 
>> reproducible example is needed (at least with the SVN revision number of 
>> GRASS 7, it is the development version, and moves fast). You haven't 
>> included any details of the offending R code, or of the versions of 
>> packages (output of sessionInfo()). Finally, the right list is:
>> 
>> http://lists.osgeo.org/mailman/listinfo/grass-stats
>> 
>> for this kind of detailed question.
>
> Further, after updating GRASS 7 to revision 54605, I can run:
>
> library(spgrass6)
> data(meuse)
> library(rgdal)
> coordinates(meuse) <- ~x+y
> proj4string(meuse) <- CRS("+init=epsg:28992")
> library(maptools)
> SG <- Sobj_SpatialGrid(meuse)$SG
> td <- tempdir()
> loc <- initGRASS("/home/rsb/topics/GRASS/G7svn/grass-7.0.svn", td, SG)
> loc
> writeVECT6(meuse, "meuse", v.in.ogr_flags="o")
>
> without problems. My sessionInfo() output:
>
>> sessionInfo()
> R version 2.15.2 (2012-10-26)
> Platform: x86_64-unknown-linux-gnu (64-bit)
>
> locale:
> [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
> [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
> [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
> [7] LC_PAPER=C                 LC_NAME=C
> [9] LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] grid      stats     graphics  grDevices utils     datasets  methods
> [8] base
>
> other attached packages:
> [1] maptools_0.8-21 lattice_0.20-13 foreign_0.8-52  rgdal_0.8-01
> [5] spgrass6_0.7-12 XML_3.95-0.1    sp_1.0-5
>
> loaded via a namespace (and not attached):
> [1] tools_2.15.2
>> execGRASS("g.version")
> GRASS 7.0.svn (2012)

But:

> parseGRASS("v.db.addcolumn")
Traceback (most recent call last):
   File 
"/home/rsb/topics/GRASS/G7svn/grass-7.0.svn/scripts/v.db.addcolumn", line 
43, in <module>
     import grass.script as grass
ImportError: No module named grass.script
Error in if (file.exists(file) == FALSE) if (!missing(asText) && asText == 
:
   argument is of length zero
In addition: Warning message:
running command 'v.db.addcolumn --interface-description' had status 1
Error in parseGRASS("v.db.addcolumn") : v.db.addcolumn not parsed
> Sys.getenv("PYTHONPATH")
[1] ""
> Sys.getenv("GISBASE")
[1] "/home/rsb/topics/GRASS/G7svn/grass-7.0.svn"
> Sys.setenv(PYTHONPATH=paste(Sys.getenv("GISBASE"), "etc", "python", 
sep="/"))
> Sys.getenv("PYTHONPATH")
[1] "/home/rsb/topics/GRASS/G7svn/grass-7.0.svn/etc/python"
> parseGRASS("v.db.addcolumn")
Command: v.db.addcolumn
Description: Adds one or more columns to the attribute table connected to 
a given vector map.
Keywords: vector, attribute table, database
Parameters:
   name: map, type: string, required: yes, multiple: no
   keydesc: name, keydesc_count: 1
...

so changes in GRASS require a modification to initGRASS(). I've committed 
a patch to the R-forge rspatial project, module spgrass6, revision 1333. 
Please report back if you can check the revised version - try:

  install.packages("spgrass6", repos="http://R-Forge.R-project.org")

once you see 0.7-13 and revision >=1333 in the spgrass6 box on:

https://r-forge.r-project.org/R/?group_id=1014

If others could try this too, also on other platforms, I'd be grateful.

Roger


>
> Roger
>
>> 
>> Roger
>> 
>>> Thanks,
>>> 
>>> Jean-Baptiste
>>> 
>>> 
>>> 
>>> --
>>> View this message in context: 
>>> http://r-sig-geo.2731867.n2.nabble.com/grass-script-not-found-in-R-grass7-session-tp7582292.html
>>> Sent from the R-sig-geo mailing list archive at Nabble.com.
>>> 
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> 
>> 
>> 
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From hugoe.loyolat at gmail.com  Sat Jan 12 15:15:43 2013
From: hugoe.loyolat at gmail.com (Hugo Loyola)
Date: Sat, 12 Jan 2013 11:15:43 -0300
Subject: [R-sig-Geo] Question about rgdal on Ubuntu 12.04
Message-ID: <CACezswi9g9Uqzoi=EewbH2ctWrcNx3cd_fXQGxWnur6EsFBpHA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130112/87e0dd3c/attachment.pl>

From roman.lustrik at gmail.com  Sat Jan 12 15:18:53 2013
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Sat, 12 Jan 2013 15:18:53 +0100
Subject: [R-sig-Geo] Question about rgdal on Ubuntu 12.04
In-Reply-To: <CACezswi9g9Uqzoi=EewbH2ctWrcNx3cd_fXQGxWnur6EsFBpHA@mail.gmail.com>
References: <CACezswi9g9Uqzoi=EewbH2ctWrcNx3cd_fXQGxWnur6EsFBpHA@mail.gmail.com>
Message-ID: <CAHT1vpiF2kQfYSY4ZaPbcYrFy04=qxe_97av6o7AKDoqEcKXLQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130112/e343c4b1/attachment.pl>

From piero.campa at gmail.com  Sat Jan 12 17:46:45 2013
From: piero.campa at gmail.com (Piero Campalani)
Date: Sat, 12 Jan 2013 17:46:45 +0100
Subject: [R-sig-Geo] Localized krigeST
Message-ID: <CAMp9JaMkgZObsi58qzuOrGVxeHh1qU-C5ExmA2iVpfqoDEFMLw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130112/b3bc6d17/attachment.pl>

From alobolistas at gmail.com  Sat Jan 12 22:36:48 2013
From: alobolistas at gmail.com (Agustin Lobo)
Date: Sat, 12 Jan 2013 22:36:48 +0100
Subject: [R-sig-Geo] poly.counts() very slow: potential alternative suggested
Message-ID: <CAG4NReKZ0tZwukvALowCgJ6enKGY+ykn=XyBXbZ5VQ-=7jLePQ@mail.gmail.com>

I've found poly.counts() (in GISTools) to be very slow and actually
cannot use it for 2 complex layers (13969 points and 32036 polygons):

system.time(nbp2 <- poly.counts(fireLCg,BorneoLCg))
Error: cannot allocate vector of size 1.7 Gb
Timing stopped at: 351.766 5.164 722.586

while a function based on over() works reasonably well:
system.time(nbp <- minbpINpoly(fireLCg,BorneoLCg))
   user  system elapsed
 46.999   2.088  73.805

Is perhaps my function less general and/or do you appreciate
any other potential problem? Or perhaps there is another alternative
in another package already.

function(points,polys)
{
#Agustin.Lobo at ictja.csic.es
#points:Spatial Points DF
#polys: Spatial Polygons DF
#output:vector
#In order to count the number of fire pixels we first extract the
coordinates to a dumy object
#in which each component corresponds to a polygon and contains a
dataframe with the information
#of each point within that polygon.
#Once we have created such a list, we just count the number of rows of
the data frame within each component.
delme6 <- over(points,polys, returnList = TRUE)
nbp <- sapply(delme6,nrow)
nbp
}

Thanks

Agus


From piero.campa at gmail.com  Sun Jan 13 13:53:17 2013
From: piero.campa at gmail.com (Piero Campalani)
Date: Sun, 13 Jan 2013 13:53:17 +0100
Subject: [R-sig-Geo] Cross-validation with spacetime
Message-ID: <CAMp9JaM8QFrNx9S42oHjHB2WPhCxFVan1EWW3p=dKpjttTtgyA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130113/ac509db1/attachment.pl>

From piero.campa at gmail.com  Sun Jan 13 16:05:55 2013
From: piero.campa at gmail.com (Piero Campalani)
Date: Sun, 13 Jan 2013 16:05:55 +0100
Subject: [R-sig-Geo] Block spatiotemporal kriging with separable covariance
	model
Message-ID: <CAMp9JaP5GaYUz5mSqB7sv=64+s0ySbebVpRCXCKAHUj8eKyZdg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130113/ff09c1f0/attachment.pl>

From edzer.pebesma at uni-muenster.de  Sun Jan 13 18:20:16 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sun, 13 Jan 2013 18:20:16 +0100
Subject: [R-sig-Geo] Localized krigeST
In-Reply-To: <CAMp9JaMkgZObsi58qzuOrGVxeHh1qU-C5ExmA2iVpfqoDEFMLw@mail.gmail.com>
References: <CAMp9JaMkgZObsi58qzuOrGVxeHh1qU-C5ExmA2iVpfqoDEFMLw@mail.gmail.com>
Message-ID: <50F2ECD0.1050209@uni-muenster.de>



On 01/12/2013 05:46 PM, Piero Campalani wrote:
> Dear list,
> 
> is there a way restrict the search spatial radius in a spatiotemporal
> prediction with gstat::krigeST() (separable covariance models)?
> In the help page I can see that further arguments ("...") are passed to the
> gstat function, but it seems that e.g. "nmax" is ignored.

not within krigeST, you'd have to write a loop around it that selects
the data used for kriging at a particular set of prediction locations/times.

things like nmax or radius are obviously not defined in space-time...
I'll add sth to the docs in this respect.

> 
> In the usual spatial prediction, the parameters for localized kriging
> needed to be specified upon creation of the gstat object (and not during
> prediction with krige/precict), so probably something needs to be set when
> creating a ST*DF?
> 
> Piero
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From edzer.pebesma at uni-muenster.de  Sun Jan 13 18:20:54 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sun, 13 Jan 2013 18:20:54 +0100
Subject: [R-sig-Geo] Cross-validation with spacetime
In-Reply-To: <CAMp9JaM8QFrNx9S42oHjHB2WPhCxFVan1EWW3p=dKpjttTtgyA@mail.gmail.com>
References: <CAMp9JaM8QFrNx9S42oHjHB2WPhCxFVan1EWW3p=dKpjttTtgyA@mail.gmail.com>
Message-ID: <50F2ECF6.7070908@uni-muenster.de>



On 01/13/2013 01:53 PM, Piero Campalani wrote:
> Dear list,
> 
> I was wondering if there is a way to automatically compute x-validation
> with the new spacetime objects (as is in gstat::gstat.cv).
> Looking through the available functions it does not look so, thus I bet I
> just need to manually run it. ?
> 
I guess so, yes - this is what we've done so far.

> Thanks,
> Piero
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From edzer.pebesma at uni-muenster.de  Sun Jan 13 18:31:36 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sun, 13 Jan 2013 18:31:36 +0100
Subject: [R-sig-Geo] Block spatiotemporal kriging with separable
 covariance model
In-Reply-To: <CAMp9JaP5GaYUz5mSqB7sv=64+s0ySbebVpRCXCKAHUj8eKyZdg@mail.gmail.com>
References: <CAMp9JaP5GaYUz5mSqB7sv=64+s0ySbebVpRCXCKAHUj8eKyZdg@mail.gmail.com>
Message-ID: <50F2EF78.3000106@uni-muenster.de>



On 01/13/2013 04:05 PM, Piero Campalani wrote:
> Dear list,
> 
> is there a way to have block-kriging predictions when using spatio-temporal
> with separable covariance model, in particular by using the gstat/spacetime
> suite. ?
> I saw examples of block kriging when using a 3D metric kriging, with
> rescaled time axis, so that a parallelepiped can be set in the krige()
> function.

I'd call it a rectangle.

> Setting a block in the krigeST does not work, seemingly.

That is correct -- I've now added this to the docs, too (in svn on r-forge).

> 
> Thanks for any help,
> Piero
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From piero.campa at gmail.com  Sun Jan 13 20:48:20 2013
From: piero.campa at gmail.com (Piero Campalani)
Date: Sun, 13 Jan 2013 20:48:20 +0100
Subject: [R-sig-Geo] Block spatiotemporal kriging with separable
 covariance model
In-Reply-To: <50F2EF78.3000106@uni-muenster.de>
References: <CAMp9JaP5GaYUz5mSqB7sv=64+s0ySbebVpRCXCKAHUj8eKyZdg@mail.gmail.com>
	<50F2EF78.3000106@uni-muenster.de>
Message-ID: <CAMp9JaMGq8z=EMek8RYgW+mgUVTvCraBv4MGoG2RY8Zbyq3arw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130113/12af17cb/attachment.pl>

From edzer.pebesma at uni-muenster.de  Sun Jan 13 21:17:53 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sun, 13 Jan 2013 21:17:53 +0100
Subject: [R-sig-Geo] Block spatiotemporal kriging with separable
 covariance model
In-Reply-To: <CAMp9JaMGq8z=EMek8RYgW+mgUVTvCraBv4MGoG2RY8Zbyq3arw@mail.gmail.com>
References: <CAMp9JaP5GaYUz5mSqB7sv=64+s0ySbebVpRCXCKAHUj8eKyZdg@mail.gmail.com>
	<50F2EF78.3000106@uni-muenster.de>
	<CAMp9JaMGq8z=EMek8RYgW+mgUVTvCraBv4MGoG2RY8Zbyq3arw@mail.gmail.com>
Message-ID: <50F31671.7070807@uni-muenster.de>



On 01/13/2013 08:48 PM, Piero Campalani wrote:
> Dear Edzer,
> thanks for the help.
> Is block-kriging possible with this kind of covariance model, or is it just
> not implemented in the `spacetime` package?

it is just not implemented.

> 
> On 13 January 2013 18:31, Edzer Pebesma <edzer.pebesma at uni-muenster.de>wrote:
> 
>>> I saw examples of block kriging when using a 3D metric kriging, with
>>> rescaled time axis, so that a parallelepiped can be set in the krige()
>>> function.
>>
>> I'd call it a rectangle.
>>
> 
> ..why would you? Wouldn't you have a 3D xyt block ?
> 

yes, but with right angles.

I don't know what you saw, with the 3D metric model. Specifying a block
in gstat with block = c(dx, dy, dz), you get a rectangular block.

You can estimate block means for arbitrary shapes when you specify a
polygon (only 2D), or a set of points (1, 2 or 3D) that discretizes your
shape, but I've never actually seen people trying to do this for
parallelepipeds.

Bests,
-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From piero.campa at gmail.com  Sun Jan 13 21:45:06 2013
From: piero.campa at gmail.com (Piero Campalani)
Date: Sun, 13 Jan 2013 21:45:06 +0100
Subject: [R-sig-Geo] Block spatiotemporal kriging with separable
 covariance model
In-Reply-To: <50F31671.7070807@uni-muenster.de>
References: <CAMp9JaP5GaYUz5mSqB7sv=64+s0ySbebVpRCXCKAHUj8eKyZdg@mail.gmail.com>
	<50F2EF78.3000106@uni-muenster.de>
	<CAMp9JaMGq8z=EMek8RYgW+mgUVTvCraBv4MGoG2RY8Zbyq3arw@mail.gmail.com>
	<50F31671.7070807@uni-muenster.de>
Message-ID: <CAMp9JaM1BeirVmvQfVXHdct+mMJYV52VZEazoP7VajAweXY5JQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130113/1e70ce1f/attachment.pl>

From tiagovieira7 at yahoo.com.br  Mon Jan 14 02:36:56 2013
From: tiagovieira7 at yahoo.com.br (Tiago Vieira)
Date: Sun, 13 Jan 2013 22:36:56 -0300
Subject: [R-sig-Geo] (no subject)
In-Reply-To: <CAMp9JaMGq8z=EMek8RYgW+mgUVTvCraBv4MGoG2RY8Zbyq3arw@mail.gmail.com>
References: <CAMp9JaP5GaYUz5mSqB7sv=64+s0ySbebVpRCXCKAHUj8eKyZdg@mail.gmail.com>
	<50F2EF78.3000106@uni-muenster.de>
	<CAMp9JaMGq8z=EMek8RYgW+mgUVTvCraBv4MGoG2RY8Zbyq3arw@mail.gmail.com>
Message-ID: <50F36138.9050100@yahoo.com.br>

Dear,

How can I set the parameter horizontal band and vertical band of 
experimental variogram in gstat package? I can only transforming 
coordinates.

Tiago Vieira.


From tiagovieira7 at yahoo.com.br  Mon Jan 14 02:40:04 2013
From: tiagovieira7 at yahoo.com.br (Tiago Vieira)
Date: Sun, 13 Jan 2013 22:40:04 -0300
Subject: [R-sig-Geo] Horizontal and vertical band
In-Reply-To: <50F36138.9050100@yahoo.com.br>
References: <50F36138.9050100@yahoo.com.br>
Message-ID: <50F361F4.3050005@yahoo.com.br>

Dear,

How can I set the parameter horizontal band and vertical band of 
experimental variogram in gstat package? I can only transforming 
coordinates.

Tiago Vieira.


From jeanbaptiste.paroissien at gmail.com  Mon Jan 14 09:06:46 2013
From: jeanbaptiste.paroissien at gmail.com (Jean-Baptiste)
Date: Mon, 14 Jan 2013 00:06:46 -0800 (PST)
Subject: [R-sig-Geo] grass.script not found in R+grass7 session
In-Reply-To: <alpine.LRH.2.02.1301121357590.13650@reclus.nhh.no>
References: <1357925301566-7582292.post@n2.nabble.com>
	<alpine.LRH.2.02.1301111833530.4785@reclus.nhh.no>
	<alpine.LRH.2.02.1301121312490.13505@reclus.nhh.no>
	<alpine.LRH.2.02.1301121357590.13650@reclus.nhh.no>
Message-ID: <1358150806248-7582310.post@n2.nabble.com>

Perfect. The lastest version of spgrass6 (0.7-13, revision 1333) work fine
for me (Platform: i686-pc-linux-gnu (32-bit)
R version 2.15.2 + GRASS 7.0.svn (2012))

Thank you very much!
Cheers,

Jean-Baptiste





--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/grass-script-not-found-in-R-grass7-session-tp7582292p7582310.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From edzer.pebesma at uni-muenster.de  Mon Jan 14 10:13:42 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 14 Jan 2013 10:13:42 +0100
Subject: [R-sig-Geo] [reminder] Visualisation tool assessment
Message-ID: <50F3CC46.2090804@uni-muenster.de>

This is a reminder email, first sent on Jan 7.

The following request has relatively little to do with R, but a lot with
the interactive visualisation of probabilistic spatial data, an area
where R is, let's say, not so strong.

the UncertWeb FP7 EU project (http://www.uncertweb.org) has developed
methods and open source tools for uncertainty propagation in web-enabled
environmental modeling chains. One of these tools visualises
probabilistic spatial and spatio-temporal data in a browser. To assess
the usability of this visualisation tool, we prepared an online survey.
We would be grateful if you could spend 20 minutes to get to know the
tool and give your opinion about it. We will need this before Jan 15,
23:59 UTC.

The questionnaire is available at:
http://surveys.ifgi.de/index.php?sid=81531&lang=en

With best regards,
-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From dariofrn at gmail.com  Mon Jan 14 15:42:34 2013
From: dariofrn at gmail.com (Dario Fiorentino)
Date: Mon, 14 Jan 2013 15:42:34 +0100
Subject: [R-sig-Geo] gstat kriging anisotropy
Message-ID: <50F4195A.60508@gmail.com>

Dear R-Sig-Geo,
I am a new user of this list and I am quite new both to R and spatial analysis.
Recently I got enthusiast on spatial statistics and I started to read really intensely this mailing list, all the suggestions and problems colleagues have been posting, helping me already in many occasions.
I am really thankful to all of you!

Today I really need your help because I am struggling for a problem maybe I hope it is
trivial for you. It concerns how integrate anisotropy in the kriging procedure.
I am interpolating some sediment data, and I've been performing a couple of test to check for anisotropy because I am aware that in case it is present it should be removed before applying kriging. However the gstat krige function I would like to use, doesn't allow to perform on models with anisotropies defined.
May any of you recommend any way of proceeding?
All the best,
sincerely,
Dario

-- 
___________________
Dr. Dario Fiorentino PhD
Bioconsult Schuchardt & Scholle GbR
Auf der Muggenburg 30 - 28217 Bremen
e-mail: dariofrn at gmail.com
http://sites.google.com/site/dariofrn/


From mestre.frederico at gmail.com  Tue Jan 15 01:45:06 2013
From: mestre.frederico at gmail.com (Frederico Mestre)
Date: Tue, 15 Jan 2013 00:45:06 -0000
Subject: [R-sig-Geo] Frequency table of rasters within polygons
Message-ID: <!&!AAAAAAAAAAAYAAAAAAAAANurYWtafkREnWeH4rBeYRHigQAAEAAAALd+u4Z8liZGqGZbF2FdWooBAAAAAA==@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130115/f7cac684/attachment.pl>

From edzer.pebesma at uni-muenster.de  Tue Jan 15 11:38:52 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 15 Jan 2013 11:38:52 +0100
Subject: [R-sig-Geo] gstat kriging anisotropy
In-Reply-To: <50F4195A.60508@gmail.com>
References: <50F4195A.60508@gmail.com>
Message-ID: <50F531BC.3040705@uni-muenster.de>



On 01/14/2013 03:42 PM, Dario Fiorentino wrote:
> Dear R-Sig-Geo,
> I am a new user of this list and I am quite new both to R and spatial
> analysis.
> Recently I got enthusiast on spatial statistics and I started to read
> really intensely this mailing list, all the suggestions and problems
> colleagues have been posting, helping me already in many occasions.
> I am really thankful to all of you!
> 
> Today I really need your help because I am struggling for a problem
> maybe I hope it is
> trivial for you. It concerns how integrate anisotropy in the kriging
> procedure.
> I am interpolating some sediment data, and I've been performing a couple
> of test to check for anisotropy because I am aware that in case it is
> present it should be removed before applying kriging. However the gstat
> krige function I would like to use, doesn't allow to perform on models
> with anisotropies defined.

what made you think so?

> May any of you recommend any way of proceeding?

read the documentation of function vgm in package gstat.

> All the best,
> sincerely,
> Dario
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From edzer.pebesma at uni-muenster.de  Tue Jan 15 11:51:59 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 15 Jan 2013 11:51:59 +0100
Subject: [R-sig-Geo] Weird experimental 3D spatiotemporal variogram
In-Reply-To: <CAMp9JaMqj-nDBc25oixoBcJVxDR5-bi7e-EwypGjKp156CV=tw@mail.gmail.com>
References: <CAMp9JaMqj-nDBc25oixoBcJVxDR5-bi7e-EwypGjKp156CV=tw@mail.gmail.com>
Message-ID: <50F534CF.8060703@uni-muenster.de>

Piero,

from the orientation of your graph, I could not see very well what
happens at zero-time, zero-space lag.

Did you compute a pure-time variogram, i.e. with zero space distance?
This one should have a missing zero-value, unless you have duplicate
measurements.

On 01/10/2013 03:20 PM, Piero Campalani wrote:
> Dear list,
> 
> I am predicting PM measurements on a spatiotemporal grid with monthly
> intervals in time.
> At modeling time, I am looking at the experimental 3D variograms
> (`wireframes`) but I see that weird decreasing behavior in time (see
> wireframes_2008-1.eps for January 2008): there is a peak at 0 time lags,
> then correlation in time is much higher over different days.
> How can I interpret such variogram?
> Would it mean that there is a very high spatial variability for values on
> the same day, whereas temporal variability is significantly lower?
> 
> Thanks for any hint,
> (I can provide implementation details in case of need)
> 
> Piero
> 
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From dariofrn at gmail.com  Tue Jan 15 14:15:25 2013
From: dariofrn at gmail.com (Dario Fiorentino)
Date: Tue, 15 Jan 2013 05:15:25 -0800 (PST)
Subject: [R-sig-Geo] gstat kriging anisotropy
In-Reply-To: <50F531BC.3040705@uni-muenster.de>
References: <50F4195A.60508@gmail.com> <50F531BC.3040705@uni-muenster.de>
Message-ID: <1358255725496-7582316.post@n2.nabble.com>

Thanks!
Sorry, I had that problem because of the error message: 

"Error in predict.gstat(g, newdata = newdata, block = block, nsim = nsim,  : 
  gstat: value not allowed for: for long/lat data, anisotropy cannot be
defined"

Now I guess this message is displayed when using decimal degree as
coordinates. Just later I understood that indeed metric coordinates are
accepted.
In fact it worked really smoothly after having converted to metres.
Somewhere I should have skipped to read that metric coordinates should be
used.

Thanks again,
Dario



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/gstat-kriging-anisotropy-tp7582312p7582316.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From tim.winke at gmail.com  Tue Jan 15 15:05:33 2013
From: tim.winke at gmail.com (mojito)
Date: Tue, 15 Jan 2013 06:05:33 -0800 (PST)
Subject: [R-sig-Geo] readOGR ceased working since updating to R 2.15.2
In-Reply-To: <alpine.LRH.2.02.1212132104520.12078@reclus.nhh.no>
References: <3852B275C82A9444AB29EA92AA1B0C9201E8F1C0BB@MADARRMAILBOX07.indra.es>
	<3852B275C82A9444AB29EA92AA1B0C9201E8F1C15E@MADARRMAILBOX07.indra.es>
	<alpine.LRH.2.02.1212132104520.12078@reclus.nhh.no>
Message-ID: <1358258733291-7582317.post@n2.nabble.com>

I have the same problem. Do you mind posting how you solved it?



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/readOGR-ceased-working-since-updating-to-R-2-15-2-tp7581936p7582317.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From ben.graeler at uni-muenster.de  Tue Jan 15 15:15:42 2013
From: ben.graeler at uni-muenster.de (=?ISO-8859-1?Q?Benedikt_Gr=E4ler?=)
Date: Tue, 15 Jan 2013 15:15:42 +0100
Subject: [R-sig-Geo] Weird experimental 3D spatiotemporal variogram
In-Reply-To: <50F534CF.8060703@uni-muenster.de>
References: <CAMp9JaMqj-nDBc25oixoBcJVxDR5-bi7e-EwypGjKp156CV=tw@mail.gmail.com>
	<50F534CF.8060703@uni-muenster.de>
Message-ID: <50F5648E.8010207@uni-muenster.de>

Dear Piero,

how did you compute these variograms, using variogramST in gstat (which 
version?)?

Figures 4-7 in gstat's vignette "Spatio-temporal geostatistics using 
gstat" on CRAN show the missing value for the zero temporal and zero 
spatial lag class. I could not identify this property in your wireframe 
plots.

To me, the temporal effect looks like being "upside-down". I'll be happy 
to take a quick look at your script/data in case your problem still 
remains.

Best,

  Ben



On 15.01.2013 11:51, Edzer Pebesma wrote:
> Piero,
>
> from the orientation of your graph, I could not see very well what
> happens at zero-time, zero-space lag.
>
> Did you compute a pure-time variogram, i.e. with zero space distance?
> This one should have a missing zero-value, unless you have duplicate
> measurements.
>
> On 01/10/2013 03:20 PM, Piero Campalani wrote:
>> Dear list,
>>
>> I am predicting PM measurements on a spatiotemporal grid with monthly
>> intervals in time.
>> At modeling time, I am looking at the experimental 3D variograms
>> (`wireframes`) but I see that weird decreasing behavior in time (see
>> wireframes_2008-1.eps for January 2008): there is a peak at 0 time lags,
>> then correlation in time is much higher over different days.
>> How can I interpret such variogram?
>> Would it mean that there is a very high spatial variability for values on
>> the same day, whereas temporal variability is significantly lower?
>>
>> Thanks for any hint,
>> (I can provide implementation details in case of need)
>>
>> Piero
>>
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>

-- 
Benedikt Gr?ler

ifgi - Institute for Geoinformatics
University of Muenster

http://ifgi.uni-muenster.de/graeler

Phone: +49 251 83-33082
Mail: ben.graeler at uni-muenster.de


From piero.campa at gmail.com  Tue Jan 15 16:09:45 2013
From: piero.campa at gmail.com (Piero Campalani)
Date: Tue, 15 Jan 2013 16:09:45 +0100
Subject: [R-sig-Geo] Weird experimental 3D spatiotemporal variogram
In-Reply-To: <50F5648E.8010207@uni-muenster.de>
References: <CAMp9JaMqj-nDBc25oixoBcJVxDR5-bi7e-EwypGjKp156CV=tw@mail.gmail.com>
	<50F534CF.8060703@uni-muenster.de>
	<50F5648E.8010207@uni-muenster.de>
Message-ID: <CAMp9JaPUOud91FVQLXwzWN47atUJ0T0RvohiN6c8KhTU79PNkQ@mail.gmail.com>

Edzer, Ben,
(I was missing the vignette on spatio-temporal analysis with gstat.. !!)

I'm attaching a clearer figure of the experimental variogram: the /origin/
at 0 spatio-temporal lag is not zero actually.

Yes, I am using **variogramST** on a STFDF: the spacetime object looks ok,
then I simply call:
> variogramST(pm~1, mySTFDF, tlags=0:6)

Ben, out of band I can give you my .Rdata cutout with the STFDF if you're
interested.
(It seems from the ST vignette that `variogramST` is now merged into
`variogram` ?)

--------------------------
> R.version.string
[1] "R Under development (unstable) (2012-10-03 r60866)"
--------------------------

Thanks,
Piero

On 15 January 2013 15:15, Benedikt Gr?ler <ben.graeler at uni-muenster.de>wrote:

> Dear Piero,
>
> how did you compute these variograms, using variogramST in gstat (which
> version?)?
>
> Figures 4-7 in gstat's vignette "Spatio-temporal geostatistics using
> gstat" on CRAN show the missing value for the zero temporal and zero
> spatial lag class. I could not identify this property in your wireframe
> plots.
>
> To me, the temporal effect looks like being "upside-down". I'll be happy
> to take a quick look at your script/data in case your problem still remains.
>
> Best,
>
>  Ben
>
>
>
>
> On 15.01.2013 11:51, Edzer Pebesma wrote:
>
>> Piero,
>>
>> from the orientation of your graph, I could not see very well what
>> happens at zero-time, zero-space lag.
>>
>> Did you compute a pure-time variogram, i.e. with zero space distance?
>> This one should have a missing zero-value, unless you have duplicate
>> measurements.
>>
>> On 01/10/2013 03:20 PM, Piero Campalani wrote:
>>
>>> Dear list,
>>>
>>> I am predicting PM measurements on a spatiotemporal grid with monthly
>>> intervals in time.
>>> At modeling time, I am looking at the experimental 3D variograms
>>> (`wireframes`) but I see that weird decreasing behavior in time (see
>>> wireframes_2008-1.eps for January 2008): there is a peak at 0 time lags,
>>> then correlation in time is much higher over different days.
>>> How can I interpret such variogram?
>>> Would it mean that there is a very high spatial variability for values on
>>> the same day, whereas temporal variability is significantly lower?
>>>
>>> Thanks for any hint,
>>> (I can provide implementation details in case of need)
>>>
>>> Piero
>>>
>>>
>>>
>>> ______________________________**_________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/**listinfo/r-sig-geo<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>>>
>>>
>>
> --
> Benedikt Gr?ler
>
> ifgi - Institute for Geoinformatics
> University of Muenster
>
> http://ifgi.uni-muenster.de/**graeler<http://ifgi.uni-muenster.de/graeler>
>
> Phone: +49 251 83-33082
> Mail: ben.graeler at uni-muenster.de
>
>
> ______________________________**_________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/**listinfo/r-sig-geo<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130115/67fa614a/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: wireframes_2008-1.eps
Type: application/postscript
Size: 20100 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130115/67fa614a/attachment.eps>

From jogwalker at gmail.com  Wed Jan 16 13:21:43 2013
From: jogwalker at gmail.com (Josephine Walker)
Date: Wed, 16 Jan 2013 12:21:43 +0000
Subject: [R-sig-Geo] RasterLayer for origin and goal in passage function
	(gdistance)
Message-ID: <CAJLgYb2hYDjoOum-JFKsh9Rkf+xDLd7NrhNu6gPqgdF9z5CKdA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130116/43550065/attachment.pl>

From roman.lustrik at gmail.com  Wed Jan 16 13:48:59 2013
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Wed, 16 Jan 2013 13:48:59 +0100
Subject: [R-sig-Geo] RasterLayer for origin and goal in passage function
	(gdistance)
In-Reply-To: <CAJLgYb2hYDjoOum-JFKsh9Rkf+xDLd7NrhNu6gPqgdF9z5CKdA@mail.gmail.com>
References: <CAJLgYb2hYDjoOum-JFKsh9Rkf+xDLd7NrhNu6gPqgdF9z5CKdA@mail.gmail.com>
Message-ID: <CAHT1vpi0XAw1gJse2afzqWR_XKZ5b16ei-4zkyyg2=nDw1dDog@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130116/be1b4b3c/attachment.pl>

From roman.lustrik at gmail.com  Wed Jan 16 13:51:01 2013
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Wed, 16 Jan 2013 13:51:01 +0100
Subject: [R-sig-Geo] RasterLayer for origin and goal in passage function
	(gdistance)
In-Reply-To: <CAHT1vpi0XAw1gJse2afzqWR_XKZ5b16ei-4zkyyg2=nDw1dDog@mail.gmail.com>
References: <CAJLgYb2hYDjoOum-JFKsh9Rkf+xDLd7NrhNu6gPqgdF9z5CKdA@mail.gmail.com>
	<CAHT1vpi0XAw1gJse2afzqWR_XKZ5b16ei-4zkyyg2=nDw1dDog@mail.gmail.com>
Message-ID: <CAHT1vpg=F0c4Xh7HS-Sqo3XCZRzeNEz8zw0wT4z=4gAnMPfYLA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130116/b6b90fb6/attachment.pl>

From jacobvanetten at yahoo.com  Wed Jan 16 14:05:13 2013
From: jacobvanetten at yahoo.com (Jacob van Etten)
Date: Wed, 16 Jan 2013 13:05:13 +0000 (GMT)
Subject: [R-sig-Geo] RasterLayer for origin and goal in passage function
	(gdistance)
In-Reply-To: <CAJLgYb2hYDjoOum-JFKsh9Rkf+xDLd7NrhNu6gPqgdF9z5CKdA@mail.gmail.com>
References: <CAJLgYb2hYDjoOum-JFKsh9Rkf+xDLd7NrhNu6gPqgdF9z5CKdA@mail.gmail.com>
Message-ID: <1358341513.33497.YahooMailNeo@web133204.mail.ir2.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130116/e71b8034/attachment.pl>

From jogwalker at gmail.com  Wed Jan 16 14:12:37 2013
From: jogwalker at gmail.com (Josephine Walker)
Date: Wed, 16 Jan 2013 13:12:37 +0000
Subject: [R-sig-Geo] RasterLayer for origin and goal in passage function
	(gdistance)
In-Reply-To: <1358341513.33497.YahooMailNeo@web133204.mail.ir2.yahoo.com>
References: <CAJLgYb2hYDjoOum-JFKsh9Rkf+xDLd7NrhNu6gPqgdF9z5CKdA@mail.gmail.com>
	<1358341513.33497.YahooMailNeo@web133204.mail.ir2.yahoo.com>
Message-ID: <CAJLgYb3rUOw9_gKJZ8qPNfS2JsxRtONG0v3hSkRS2=PUXXbWQg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130116/e7ea6610/attachment.pl>

From godina at dal.ca  Wed Jan 16 14:40:46 2013
From: godina at dal.ca (Aurelie C.Godin)
Date: Wed, 16 Jan 2013 05:40:46 -0800 (PST)
Subject: [R-sig-Geo] Spatial indexing of a point pattern
Message-ID: <1358343646471-7582325.post@n2.nabble.com>

Hello,
I have a point pattern and a tessellation (grid). Is there a way to
spatially index each of my points? In other words, my tessellation grid has
/n/ quadrats, I would like to know for each of my points which of these
/(1:n)/ quadrats they are associated with. 
If not, is there another way to do so?
Many thanks for your suggestions!



-----
Aurelie Cosandey-Godin
Ph.D. Student, Department of Biology, Dalhousie University
Industrial Graduate Fellow, WWF-Canada
Email: godina at dal.ca | Web: wormlab.biology.dal.ca

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Spatial-indexing-of-a-point-pattern-tp7582325.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From flaxman at gmail.com  Wed Jan 16 15:02:27 2013
From: flaxman at gmail.com (Seth Flaxman)
Date: Wed, 16 Jan 2013 09:02:27 -0500
Subject: [R-sig-Geo] Spatial indexing of a point pattern
In-Reply-To: <1358343646471-7582325.post@n2.nabble.com>
References: <1358343646471-7582325.post@n2.nabble.com>
Message-ID: <CAPGk9pdwe1L0=bDsvhuCSE+NSbOGtB=sky1ZJpSC6Biq-3zUdg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130116/c52dd94a/attachment.pl>

From julian at hafro.is  Wed Jan 16 15:24:17 2013
From: julian at hafro.is (Julian Burgos)
Date: Wed, 16 Jan 2013 14:24:17 +0000
Subject: [R-sig-Geo] Spatial indexing of a point pattern
In-Reply-To: <1358343646471-7582325.post@n2.nabble.com>
References: <1358343646471-7582325.post@n2.nabble.com>
Message-ID: <50F6B811.5030602@hafro.is>

Hi Aurelie,

If your points and grid are objects of the spatial class you can use the 
function "over" in the sp package.  The overlay of points on polygons 
returns a vector with the polygon index where each point is located.

Julian


-- 
Julian Mariano Burgos, PhD
Hafranns?knastofnunin/Marine Research Institute
Sk?lagata 4, 121 Reykjav?k, Iceland
S?mi/Telephone : +354-5752037
Br?fs?mi/Telefax:  +354-5752001
Netfang/Email: julian at hafro.is



On 01/16/2013 01:40 PM, Aurelie C.Godin wrote:
> Hello,
> I have a point pattern and a tessellation (grid). Is there a way to
> spatially index each of my points? In other words, my tessellation grid has
> /n/ quadrats, I would like to know for each of my points which of these
> /(1:n)/ quadrats they are associated with.
> If not, is there another way to do so?
> Many thanks for your suggestions!
>
>
>
> -----
> Aurelie Cosandey-Godin
> Ph.D. Student, Department of Biology, Dalhousie University
> Industrial Graduate Fellow, WWF-Canada
> Email: godina at dal.ca | Web: wormlab.biology.dal.ca
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Spatial-indexing-of-a-point-pattern-tp7582325.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From m.barrueto at yahoo.com  Wed Jan 16 18:00:59 2013
From: m.barrueto at yahoo.com (Mirjam Barrueto)
Date: Wed, 16 Jan 2013 09:00:59 -0800 (PST)
Subject: [R-sig-Geo] Spatial autocorrelaton in quasi one-dimensional binary
	data (road mortality)
Message-ID: <1358355659.95844.YahooMailNeo@web141101.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130116/8462847b/attachment.pl>

From r.turner at auckland.ac.nz  Thu Jan 17 00:04:47 2013
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Thu, 17 Jan 2013 12:04:47 +1300
Subject: [R-sig-Geo] Spatial indexing of a point pattern
In-Reply-To: <1358343646471-7582325.post@n2.nabble.com>
References: <1358343646471-7582325.post@n2.nabble.com>
Message-ID: <50F7320F.8080708@auckland.ac.nz>


If you are analysing point pattern data,  you should probably be using 
"spatstat".

Here is a toy example of how you might determine the index of the quadrat
in which each of the points of your pattern lie:

require(spatstat)

# Simulate a pattern
set.seed(42)
X <- rpoispp(100) # By default the observation window is the unit square.

# Create quadrats
Q <- quadrats(X,nx=4)

# Cut X by Q
XQ <- cut(X,z=Q)

# Look at which quadrat the points fall into:
marks(XQ)

# If you want the *number* of each quadrat:
n <- factor(marks(XQ),labels=1:16)

# Plot the quadrat numbers:
plot(as.owin(X),main="")
text(X$x,X$y,labels=n))
plot(Q,add=TRUE)

# If you want to number along columns rather than along rows:
tQ <- tiles(Q)
tQ2 <- tQ[matrix(1:16,4,4,byrow=TRUE)] # Reordering the quadrats.
Q2   <- tess(tiles=tQ2)
XQ2 <- cut(X,z=Q2)
n2 <- factor(marks(XQ2),labels=1:16)

# Plot the quadrat numbers with the new ordering:
plot(as.owin(X),main="")
text(X$x,X$y,labels=n2))
plot(Q,add=TRUE)

HTH

     cheers,

         Rolf Turner

On 01/17/2013 02:40 AM, Aurelie C.Godin wrote:
> Hello,
> I have a point pattern and a tessellation (grid). Is there a way to
> spatially index each of my points? In other words, my tessellation grid has
> /n/ quadrats, I would like to know for each of my points which of these
> /(1:n)/ quadrats they are associated with.
> If not, is there another way to do so?
> Many thanks for your suggestions!


From emanuele.cordano at gmail.com  Thu Jan 17 08:54:28 2013
From: emanuele.cordano at gmail.com (Emanuele Cordano)
Date: Thu, 17 Jan 2013 08:54:28 +0100
Subject: [R-sig-Geo] list of SpatialPolygons to SpatialPolygonsDataFrame
Message-ID: <14C399AC-D527-417A-A146-6C018A50CEC7@gmail.com>

Dear all, 

I have a list of SpatialPolygons-class  objects containing only one polygon for each list element. 
How can we gather each SpatialPolygons-class  objects list element in only one SpatialPolygons-class  object without using a 'for' loop? 

Our final target is to have this information in only one  SpatialPolygonsDataFrame-class which can easily created from one SpatialPolygons-class  object. 

Regards
Thank you 

Emanuele Cordano

From subbu_843 at yahoo.co.in  Thu Jan 17 10:23:43 2013
From: subbu_843 at yahoo.co.in (subash)
Date: Thu, 17 Jan 2013 01:23:43 -0800 (PST)
Subject: [R-sig-Geo] issue with variogram plotting using
	autofitVariogram(automap)
Message-ID: <1358414623537-7582331.post@n2.nabble.com>

I am a newbie in R. I am using *autofitVariogram* to  daily rainfall data of
50 stations.The sample data is provided below.Some of stations have missing
values represented by "NaN" values. 

My question is regarding the variogramfit. The variogram covers only a
distance of 60,000m. Why are the points in bins beyond 60Km not plotted. I
had seen from spatial correlation plot maximum distance from lon-lat
information is >200Km.


The summary of* latitide and longitude* information is provided below.
summary(lonlat)
      lon             lat       
 Min.   :74.78   Min.   :15.77  
 1st Qu.:75.14   1st Qu.:16.04  
 Median :75.56   Median :16.33  
 Mean   :75.54   Mean   :16.37  
 3rd Qu.:75.94   3rd Qu.:16.66  
 Max.   :76.31   Max.   :17.23  

$ Sample data  given below:
dput(rain[140:145,])

structure(list(Col0 = c(0, 0, 1, 9, 6.5, 0), Col1 = c(1.5, 36, 
21, 44, 4, 0), Col2 = c(0, 0, 24.5, 21.5, 7.5, 1), Col3 = c(0, 
1, 45, 3, 0, 0), Col4 = c(2, 0, 5, 54.5, 13.5, 0), Col5 = c(0.5, 
2, 0, 3.5, 13.5, 0), Col6 = c(0.5, 0, 0, 59, 15.5, 0), Col7 = c(0, 
0, 2.5, 1, 0, 0), Col8 = c(0, 6, 24, 2, 5.5, 0), Col9 = c(0, 
3, 6, 1, 0, 7), Col10 = c(0.5, 1, 64, 20, 1, 0.5), Col11 = c(NaN, 
NaN, NaN, NaN, NaN, NaN), Col12 = c(0, 11, 75, 19, 15.5, 0), 
    Col13 = c(0, 4, 57.5, 50.5, 8.5, 0), Col14 = c(1.5, 0.5, 
    127, 33.5, 34.5, 0), Col15 = c(0, 7, 0.5, 13, 1, 0), Col16 = c(0, 
    0.5, 81.5, 15, 49, 0), Col17 = c(0, 0, 4.5, 17, 5.5, 1), 
    Col18 = c(0, 3, 2.5, 0.5, 0, 0), Col19 = c(NaN, NaN, NaN, 
    NaN, NaN, NaN), Col20 = c(0, 0, 0, 0, 7, 0), Col21 = c(0, 
    1, 0, 5, 3.5, 0), Col22 = c(0, 0, 11.5, 28, 3.5, 0), Col23 = c(0, 
    0, 48.5, 0, 24.5, 0), Col24 = c(0, 0, 0, 10, 0.5, 14), Col25 = c(NaN, 
    NaN, NaN, NaN, NaN, NaN), Col26 = c(0, 7.5, 16, 28.5, 20.5, 
    0), Col27 = c(1.5, 0.5, 38, 28.5, 50, 0), Col28 = c(NaN, 
    NaN, NaN, NaN, NaN, NaN), Col29 = c(NaN, NaN, NaN, NaN, NaN, 
    NaN), Col30 = c(2.5, 0, 0, 80.5, 28, 13.5), Col31 = c(1, 
    0, 17, 85.5, 3.5, 0), Col32 = c(0, 0.5, 8, 101, 20, 4), Col33 = c(NaN, 
    NaN, NaN, NaN, NaN, NaN), Col34 = c(4, 3, 17, 122, 2, 2), 
    Col35 = c(0, 15.5, 14.5, 20, 3.5, 0), Col36 = c(0, 6.5, 8.5, 
    21, 7, 0), Col37 = c(0, 0, 1.5, 14.5, 0, 1.5), Col38 = c(0, 
    28, 30, 4, 0, 73), Col39 = c(28.5, 0, 4.5, 9.5, 1, 0), Col40 = c(1.5, 
    11.5, 32.5, 55, 0, 1), Col41 = c(0, 14.5, 0, 19, 12.5, 47.5
    ), Col42 = c(0, 28, 29, 17, 0.5, 20.5), Col43 = c(NaN, NaN, 
    NaN, NaN, NaN, NaN), Col44 = c(0, 19, 3.5, 42, 0, 0), Col45 = c(0, 
    0, 85, 15.5, 1, 0), Col46 = c(0, 0.5, 8, 24, 0.5, 0), Col47 = c(0, 
    1.5, 7, 12, 8.5, 0), Col48 = c(0, 0, 0, 43.5, 0, 1.5), Col49 = c(0, 
    13.5, 1, 16, 1, 1)), .Names = c("Col0", "Col1", "Col2", "Col3", 
"Col4", "Col5", "Col6", "Col7", "Col8", "Col9", "Col10", "Col11", 
"Col12", "Col13", "Col14", "Col15", "Col16", "Col17", "Col18", 
"Col19", "Col20", "Col21", "Col22", "Col23", "Col24", "Col25", 
"Col26", "Col27", "Col28", "Col29", "Col30", "Col31", "Col32", 
"Col33", "Col34", "Col35", "Col36", "Col37", "Col38", "Col39", 
"Col40", "Col41", "Col42", "Col43", "Col44", "Col45", "Col46", 
"Col47", "Col48", "Col49"), row.names = 143:148, class = "data.frame")


# Import the required libraries
library(rgdal)
library(maptools)
library(gstat)
library(sp)
library(automap)
library(XLConnect) 

# Read the station data from xls file
rawdata = readWorksheetFromFile(path_fileName,"Sheet1", region = "D1:BA187",
header = FALSE)
N = nrow(rawdata)
rain = rawdata[4:N,]
lat = as.numeric(t(rawdata[2,]))
lon = as.numeric(t(rawdata[3,]))
lonlat = cbind(lon,lat)

#Transform from GCS to UTM protection
sp = SpatialPoints(lonlat,proj4string = CRS("+proj=longlat")) 
sp_utm = spTransform(sp, CRS("+proj=utm +zone=43N +datum=WGS84"))

krige_value = list() #prepare a list for storing the autokrige output
krige_stderr    = list()

nRows = nrow(rain)


for (i in 1:nRows) 
{   
  irain = rain[i,]
  indx = (irain == "NaN")
  irain = irain[!indx]
  irain = as.numeric(irain)

  isallzeros = max(irain) # To take care of the cases of dry day(irain =0)
at all stations
  irain = as.data.frame(irain)
  M = nrow(irain)
    
  if (M > 5) # To avoid cases of NaN across many stations
  {
    if (!(isallzeros == 0))
    {
      print(i)
      foo_utm = sp_utm[!indx]# Removing the locations with NaN values
      data = data.frame(foo_utm,irain)
      names(data) = c("Easting","Northing","rain")
      coordinates(data) = c("Easting","Northing") 
      
      variogram = autofitVariogram(rain~1,data,model =
"Sph",fix.values=c(0,NA,NA)) 
      p = plot(variogram, main="Semi-variogram (Spherical
Model)",xlab="Distance(m)",ylab="Semi-Variance(mm2)", sub=paste("Range:
",variogram$var_model$range[2], "Day",i))
      print(p)
    }
    else
    {
      krige_value[[i]] = list(rep(0, L))
      krige_stderr[[i]]   = list(rep(0, L))
    }
  }
}

Please let me know if I am missing something?

<http://r-sig-geo.2731867.n2.nabble.com/file/n7582331/141.png> 



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/issue-with-variogram-plotting-using-autofitVariogram-automap-tp7582331.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Roger.Bivand at nhh.no  Thu Jan 17 18:50:10 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 17 Jan 2013 18:50:10 +0100
Subject: [R-sig-Geo] list of SpatialPolygons to SpatialPolygonsDataFrame
In-Reply-To: <14C399AC-D527-417A-A146-6C018A50CEC7@gmail.com>
References: <14C399AC-D527-417A-A146-6C018A50CEC7@gmail.com>
Message-ID: <alpine.LRH.2.02.1301171828090.17417@reclus.nhh.no>

On Thu, 17 Jan 2013, Emanuele Cordano wrote:

> Dear all,
>
> I have a list of SpatialPolygons-class objects containing only one 
> polygon for each list element. How can we gather each 
> SpatialPolygons-class objects list element in only one 
> SpatialPolygons-class object without using a 'for' loop?

These are the *apply functions - here first making your input object:

library(sp)
grd <- GridTopology(c(0.5, 0.5), c(1, 1), c(6, 6))
Spol <- as(grd, "SpatialPolygons")
list_of_SPolsu <- lapply(slot(Spol, "polygons"), function(x)
   SpatialPolygons(list(x)))
list_of_SPols <- lapply(slot(Spol, "polygons"), function(x) {
   Pol <- x
   slot(Pol, "ID") <- "1"
   SpatialPolygons(list(Pol))
})

which also messes things up by giving all the Polygons objects the same ID 
- if all your IDs are known to be unique, you can simplify from:

IDs <- sapply(list_of_SPols, function(x)
   slot(slot(x, "polygons")[[1]], "ID"))
length(unique(IDs)) == length(list_of_SPols)

Spol1 <- SpatialPolygons(lapply(1:length(list_of_SPols), function(i) {
   Pol <- slot(list_of_SPols[[i]], "polygons")[[1]]
   slot(Pol, "ID") <- as.character(i)
   Pol
}))

giving a sequence of new IDs, to:

IDsu <- sapply(list_of_SPolsu, function(x)
   slot(slot(x, "polygons")[[1]], "ID"))
length(unique(IDsu)) == length(list_of_SPolsu)

Spol2 <- SpatialPolygons(lapply(list_of_SPolsu,
   function(x) slot(x, "polygons")[[1]]))

When the input IDs are unique, you can also use them to help you order and 
add the data.frame in the next step.

You can also use the names of list components:

set.seed(1)
IDs <- sample(c(LETTERS, letters), 36)
names(list_of_SPols) <- IDs
Spol3 <- SpatialPolygons(lapply(1:length(list_of_SPols), function(i) {
   Pol <- slot(list_of_SPols[[i]], "polygons")[[1]]
   slot(Pol, "ID") <- names(list_of_SPols)[i]
   Pol
}))

if that is more convenient, provided that they are unique.

Checking:

row.names(Spol)
row.names(Spol1)
row.names(Spol2)
row.names(Spol3)

Hope this helps,

Roger

>
> Our final target is to have this information in only one 
> SpatialPolygonsDataFrame-class which can easily created from one 
> SpatialPolygons-class object.
>
> Regards
> Thank you
>
> Emanuele Cordano
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From julien.salanie at agrocampus-ouest.fr  Fri Jan 18 00:35:05 2013
From: julien.salanie at agrocampus-ouest.fr (=?ISO-8859-1?Q?Julien_Salani=E9?=)
Date: Fri, 18 Jan 2013 00:35:05 +0100
Subject: [R-sig-Geo] a problem with readOGR
Message-ID: <50F88AA9.6080902@agrocampus-ouest.fr>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130118/ac703bc1/attachment.pl>

From kridox at ymail.com  Fri Jan 18 05:38:12 2013
From: kridox at ymail.com (Pascal Oettli)
Date: Fri, 18 Jan 2013 13:38:12 +0900
Subject: [R-sig-Geo] a problem with readOGR
In-Reply-To: <50F88AA9.6080902@agrocampus-ouest.fr>
References: <50F88AA9.6080902@agrocampus-ouest.fr>
Message-ID: <50F8D1B4.3010000@ymail.com>

Hello,

To me, the following works:

setwd("D:/mydirectory/")
carte = readOGR(getwd(),layer="COMMUNE")

HTH,
Pascal

Le 18/01/2013 08:35, Julien Salani? a ?crit :
> Hello,
>
> I was working on a script (which was working perfectly). For some reason
> I updated my packages and readOGR() is not working anymore. I was able
> to read those data before. I decided to reinstall everything, and it is
> still not working. Does anyone has the same problem. Here is the code,
> the warning and session info :
>
> CODE:
> setwd("D:/mydirectory");
> carte = readOGR("COMMUNE.shp",layer="COMMUNE");
>
> COMMUNE.shp .dbf. and all other required files are in D:/mydirectory. I
> was able to build the map before the problem arised.
>
> WARNING:
> [8] ERREUR:
> impossible d'ouvrir la connexion
>
> That is : "Impossible to open connection".
>
> SESSION INFO:
>   > sessionInfo();
> R version 2.15.2 (2012-10-26)
> Platform: x86_64-w64-mingw32/x64 (64-bit)
>
> locale:
> [1] LC_COLLATE=French_France.1252 LC_CTYPE=French_France.1252
> LC_MONETARY=French_France.1252 LC_NUMERIC=C
> LC_TIME=French_France.1252
>
> attached base packages:
> [1] splines   grid      stats     graphics  grDevices utils datasets
> methods   base
>
> other attached packages:
>    [1] mgcv_1.7-22     sfsmisc_1.0-23  spdep_0.5-56 coda_0.16-1
> deldir_0.0-21   maptools_0.8-22 foreign_0.8-52 nlme_3.1-107
> Matrix_1.0-9    boot_1.3-7
> [11] rgdal_0.8-3     lattice_0.20-13 geoR_1.7-4 sp_1.0-5
> Rcmdr_1.9-3     car_2.0-15      nnet_7.3-5 MASS_7.3-22
>
> loaded via a namespace (and not attached):
> [1] LearnBayes_2.12     RandomFields_2.0.59 splancs_2.01-32 tcltk_2.15.2
>
>
> Thank you very much for your help. Best regards. Julien
>
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From Roger.Bivand at nhh.no  Fri Jan 18 12:45:14 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 18 Jan 2013 12:45:14 +0100
Subject: [R-sig-Geo] a problem with readOGR
In-Reply-To: <50F8D1B4.3010000@ymail.com>
References: <50F88AA9.6080902@agrocampus-ouest.fr> <50F8D1B4.3010000@ymail.com>
Message-ID: <alpine.LRH.2.02.1301181239030.19967@reclus.nhh.no>

On Fri, 18 Jan 2013, Pascal Oettli wrote:

> Hello,
>
> To me, the following works:
>
> setwd("D:/mydirectory/")
> carte = readOGR(getwd(),layer="COMMUNE")

Yes, thanks for the reports. In the changes made for 0.8-*, an attempt is 
made for the ESRI Shapefile driver to read the LDID byte in the *.dbf file 
to indicate which character set is used for encoding. The current code is:

con <- file(paste(dsn, .Platform$file.sep, layer, ".dbf", sep=""), "rb")

which will fail if dsn is the shapefile itself, but pass if dsn is the 
data source name (the directory in which the shapefiles are placed). I'll 
try to patch this so that both ways of reading shapefiles work again, and 
report back when the fix is committed. The failure was in ogrInfo() inside 
readOGR() - running traceback() after the error would show this.

Best wishes,

Roger

>
> HTH,
> Pascal
>
> Le 18/01/2013 08:35, Julien Salani? a ?crit :
>> Hello,
>> 
>> I was working on a script (which was working perfectly). For some reason
>> I updated my packages and readOGR() is not working anymore. I was able
>> to read those data before. I decided to reinstall everything, and it is
>> still not working. Does anyone has the same problem. Here is the code,
>> the warning and session info :
>> 
>> CODE:
>> setwd("D:/mydirectory");
>> carte = readOGR("COMMUNE.shp",layer="COMMUNE");
>> 
>> COMMUNE.shp .dbf. and all other required files are in D:/mydirectory. I
>> was able to build the map before the problem arised.
>> 
>> WARNING:
>> [8] ERREUR:
>> impossible d'ouvrir la connexion
>> 
>> That is : "Impossible to open connection".
>> 
>> SESSION INFO:
>>   > sessionInfo();
>> R version 2.15.2 (2012-10-26)
>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>> 
>> locale:
>> [1] LC_COLLATE=French_France.1252 LC_CTYPE=French_France.1252
>> LC_MONETARY=French_France.1252 LC_NUMERIC=C
>> LC_TIME=French_France.1252
>> 
>> attached base packages:
>> [1] splines   grid      stats     graphics  grDevices utils datasets
>> methods   base
>> 
>> other attached packages:
>>    [1] mgcv_1.7-22     sfsmisc_1.0-23  spdep_0.5-56 coda_0.16-1
>> deldir_0.0-21   maptools_0.8-22 foreign_0.8-52 nlme_3.1-107
>> Matrix_1.0-9    boot_1.3-7
>> [11] rgdal_0.8-3     lattice_0.20-13 geoR_1.7-4 sp_1.0-5
>> Rcmdr_1.9-3     car_2.0-15      nnet_7.3-5 MASS_7.3-22
>> 
>> loaded via a namespace (and not attached):
>> [1] LearnBayes_2.12     RandomFields_2.0.59 splancs_2.01-32 tcltk_2.15.2
>> 
>> 
>> Thank you very much for your help. Best regards. Julien
>> 
>> 
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From julien.salanie at agrocampus-ouest.fr  Fri Jan 18 13:05:01 2013
From: julien.salanie at agrocampus-ouest.fr (=?ISO-8859-1?Q?Julien_Salani=E9?=)
Date: Fri, 18 Jan 2013 13:05:01 +0100
Subject: [R-sig-Geo] a problem with readOGR
In-Reply-To: <alpine.LRH.2.02.1301181239030.19967@reclus.nhh.no>
References: <50F88AA9.6080902@agrocampus-ouest.fr> <50F8D1B4.3010000@ymail.com>
	<alpine.LRH.2.02.1301181239030.19967@reclus.nhh.no>
Message-ID: <50F93A6D.3060709@agrocampus-ouest.fr>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130118/5c212308/attachment.pl>

From Roger.Bivand at nhh.no  Fri Jan 18 15:32:08 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 18 Jan 2013 15:32:08 +0100
Subject: [R-sig-Geo] a problem with readOGR
In-Reply-To: <alpine.LRH.2.02.1301181239030.19967@reclus.nhh.no>
References: <50F88AA9.6080902@agrocampus-ouest.fr> <50F8D1B4.3010000@ymail.com>
	<alpine.LRH.2.02.1301181239030.19967@reclus.nhh.no>
Message-ID: <alpine.LRH.2.02.1301181527240.29633@reclus.nhh.no>

On Fri, 18 Jan 2013, Roger Bivand wrote:

> On Fri, 18 Jan 2013, Pascal Oettli wrote:
>
>> Hello,
>> 
>> To me, the following works:
>> 
>> setwd("D:/mydirectory/")
>> carte = readOGR(getwd(),layer="COMMUNE")
>
> Yes, thanks for the reports. In the changes made for 0.8-*, an attempt is 
> made for the ESRI Shapefile driver to read the LDID byte in the *.dbf file to 
> indicate which character set is used for encoding. The current code is:
>
> con <- file(paste(dsn, .Platform$file.sep, layer, ".dbf", sep=""), "rb")
>
> which will fail if dsn is the shapefile itself, but pass if dsn is the data 
> source name (the directory in which the shapefiles are placed). I'll try to 
> patch this so that both ways of reading shapefiles work again, and report 
> back when the fix is committed. The failure was in ogrInfo() inside readOGR() 
> - running traceback() after the error would show this.

rgdal version 0.8-4 will resolve the problem, SVN revision 431. It has 
been submitted to CRAN. This is also related to

https://stat.ethz.ch/pipermail/r-sig-geo/2013-January/017210.html
https://stat.ethz.ch/pipermail/r-sig-geo/2012-December/016942.html

Roger

>
> Best wishes,
>
> Roger
>
>> 
>> HTH,
>> Pascal
>> 
>> Le 18/01/2013 08:35, Julien Salani? a ?crit :
>>> Hello,
>>> 
>>> I was working on a script (which was working perfectly). For some reason
>>> I updated my packages and readOGR() is not working anymore. I was able
>>> to read those data before. I decided to reinstall everything, and it is
>>> still not working. Does anyone has the same problem. Here is the code,
>>> the warning and session info :
>>> 
>>> CODE:
>>> setwd("D:/mydirectory");
>>> carte = readOGR("COMMUNE.shp",layer="COMMUNE");
>>> 
>>> COMMUNE.shp .dbf. and all other required files are in D:/mydirectory. I
>>> was able to build the map before the problem arised.
>>> 
>>> WARNING:
>>> [8] ERREUR:
>>> impossible d'ouvrir la connexion
>>> 
>>> That is : "Impossible to open connection".
>>> 
>>> SESSION INFO:
>>>   > sessionInfo();
>>> R version 2.15.2 (2012-10-26)
>>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>>> 
>>> locale:
>>> [1] LC_COLLATE=French_France.1252 LC_CTYPE=French_France.1252
>>> LC_MONETARY=French_France.1252 LC_NUMERIC=C
>>> LC_TIME=French_France.1252
>>> 
>>> attached base packages:
>>> [1] splines   grid      stats     graphics  grDevices utils datasets
>>> methods   base
>>> 
>>> other attached packages:
>>>    [1] mgcv_1.7-22     sfsmisc_1.0-23  spdep_0.5-56 coda_0.16-1
>>> deldir_0.0-21   maptools_0.8-22 foreign_0.8-52 nlme_3.1-107
>>> Matrix_1.0-9    boot_1.3-7
>>> [11] rgdal_0.8-3     lattice_0.20-13 geoR_1.7-4 sp_1.0-5
>>> Rcmdr_1.9-3     car_2.0-15      nnet_7.3-5 MASS_7.3-22
>>> 
>>> loaded via a namespace (and not attached):
>>> [1] LearnBayes_2.12     RandomFields_2.0.59 splancs_2.01-32 tcltk_2.15.2
>>> 
>>> 
>>> Thank you very much for your help. Best regards. Julien
>>> 
>>> 
>>> 
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> 
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From janesh.devkota at gmail.com  Sat Jan 19 04:00:02 2013
From: janesh.devkota at gmail.com (jdbaba)
Date: Fri, 18 Jan 2013 19:00:02 -0800 (PST)
Subject: [R-sig-Geo] How to clip the object created by Conourlines2SLDF with
	polygon
Message-ID: <1358564402234-7582339.post@n2.nabble.com>

Hello All,

I am a new user in R and am trying hard to have a understanding in R and
mapping techniques. 

I have an estuary shapefile and then I have data points with x,yand z
coordinates. I want to show the contour lines on the shapefile. 

The procedure I used is using akima package to do the interpolation. The
code I used to interpolate is 

fld <- interp(x,y,z)

Then I changed this to spatial object by using following code:

res <-ContourLines2SLDF(contourLines(fld))

The above command would store the contourlines as spatial data. 

Then I read the shapefile and I plot both shapefile and res as follows:

p1 <-
spplot(hello,sp.layout=list(list("sp.lines",res)),col="blue",lwd=0,fill="grey",colorkey=F)
p1

"hello" is my shapefile and "res" is the object I created as shown above. 

The problem is contour stored is "res" extends beyound the shapefile. So I
want to clip that contour with the shapefile and only display the contour
within the shapefile area. 



I have attached the image I got with my code. 
<http://r-sig-geo.2731867.n2.nabble.com/file/n7582339/shapefile_with_contour.png> 


In the image you can see the lines out of the shapefile. I also want to know
how can I display the contour levels on the map. 

Thank you so much. 

Jdbaba



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/How-to-clip-the-object-created-by-Conourlines2SLDF-with-polygon-tp7582339.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From janesh.devkota at gmail.com  Sat Jan 19 13:26:24 2013
From: janesh.devkota at gmail.com (Jd Devkota)
Date: Sat, 19 Jan 2013 06:26:24 -0600
Subject: [R-sig-Geo] How to show the color ramp legend with discrete data in
	spplot ?
Message-ID: <CAPTbr1pZYh-eocA1vk2FA7Z8pHu0rdnDLnix7=1dY8YvBYTG5Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130119/b9438e99/attachment.pl>

From edzer.pebesma at uni-muenster.de  Sat Jan 19 13:48:09 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sat, 19 Jan 2013 13:48:09 +0100
Subject: [R-sig-Geo] How to show the color ramp legend with discrete
 data in spplot ?
In-Reply-To: <CAPTbr1pZYh-eocA1vk2FA7Z8pHu0rdnDLnix7=1dY8YvBYTG5Q@mail.gmail.com>
References: <CAPTbr1pZYh-eocA1vk2FA7Z8pHu0rdnDLnix7=1dY8YvBYTG5Q@mail.gmail.com>
Message-ID: <50FA9609.2040706@uni-muenster.de>



On 01/19/2013 01:26 PM, Jd Devkota wrote:> Hello All,
>
> I have a discontinuous dataset and I used spplot to plot the points.
>
> I was wondering whether it is possible to show the legend of the plot as
> color ramp. I saw that on continuous data. If anyone could tell me that
> would be great.

try:

library(fortunes)
fortune("there is no if")

Reflecting on that, it would involve a bit of programming, essentially
writing an appropriate panel function for lattice::levelplot. I did this
back then for polygons, found in sp:::panel.polygonsplot, which is 80
lines of R code. My guess is that it should be considerable more easy
for points. I'd be happy to receive & consider proposals.


>
> Another thing I would like to know is how can we create the horizontal
> legend. By default, the legend is vertical.
>
> I was able to shift the legend inside the plot but not horizontal. Some of
> the code I used is as follows:
>
> ##Polygon as major plot and contour as layout
> ## Put north icon on the map
> l2 = list("SpatialPolygonsRescale", layout.north.arrow(), offset =
> c(439000,3368000), scale = 4000)
> l3 = list("SpatialPolygonsRescale", layout.scale.bar(), offset =
> c(460000,3352000), scale = 5000, fill=c("transparent","black"))
> l4 = list("sp.text",c(460000,3351500),"0")
> l5 = list("sp.text",c(465000,3351500),"100 m")
> cuts=c(0,5,10,15,20,25,30,35,37,39,40)
>
> p1 <-
>
spplot(data1,sp.layout=list(list("sp.polygons",hello),l2,l3,l4,l5),axes=T,xlab="Eastings",cuts=cuts,
> ylab="Northings",lwd=2,cex=1.2,col.regions = rainbow(100, start =
3/15, end
> = 1))

Error in spplot(data1, sp.layout = list(list("sp.polygons", hello), l2,  :
  error in evaluating the argument 'obj' in selecting a method for
function 'spplot': Error: object 'data1' not found


>
> # Legend in Spplot
> names(p1$legend) <- "inside"
> p1$legend$inside$x <- 0.15
> p1$legend$inside$y <- 0.9
> plot(p1)

We don't have data1, so we can't see what you mean.

Please provide an example that, when copy and pasted, simply runs. This
means: include a library(sp), and import and use a data set available in
a package, such as the meuse data.

>
> Thank you so much.
>
> Janesh
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From edzer.pebesma at uni-muenster.de  Sat Jan 19 15:14:14 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sat, 19 Jan 2013 15:14:14 +0100
Subject: [R-sig-Geo] Weird experimental 3D spatiotemporal variogram
In-Reply-To: <CAMp9JaPUOud91FVQLXwzWN47atUJ0T0RvohiN6c8KhTU79PNkQ@mail.gmail.com>
References: <CAMp9JaMqj-nDBc25oixoBcJVxDR5-bi7e-EwypGjKp156CV=tw@mail.gmail.com>
	<50F534CF.8060703@uni-muenster.de>
	<50F5648E.8010207@uni-muenster.de>
	<CAMp9JaPUOud91FVQLXwzWN47atUJ0T0RvohiN6c8KhTU79PNkQ@mail.gmail.com>
Message-ID: <50FAAA36.6070504@uni-muenster.de>

Thanks Piero; this report revealed a bug in the gstat spatio-temporal
variogram computation, which should be fixed in the development version.
gstat source code has move to r-forge, development binaries can be
downloaded from https://r-forge.r-project.org/projects/gstat/


On 01/15/2013 04:09 PM, Piero Campalani wrote:
> Edzer, Ben,
> (I was missing the vignette on spatio-temporal analysis with gstat.. !!)
> 
> I'm attaching a clearer figure of the experimental variogram: the /origin/
> at 0 spatio-temporal lag is not zero actually.
> 
> Yes, I am using **variogramST** on a STFDF: the spacetime object looks ok,
> then I simply call:
>> variogramST(pm~1, mySTFDF, tlags=0:6)
> 
> Ben, out of band I can give you my .Rdata cutout with the STFDF if you're
> interested.
> (It seems from the ST vignette that `variogramST` is now merged into
> `variogram` ?)
> 
> --------------------------
>> R.version.string
> [1] "R Under development (unstable) (2012-10-03 r60866)"
> --------------------------
> 
> Thanks,
> Piero
> 
> On 15 January 2013 15:15, Benedikt Gr?ler <ben.graeler at uni-muenster.de>wrote:
> 
>> Dear Piero,
>>
>> how did you compute these variograms, using variogramST in gstat (which
>> version?)?
>>
>> Figures 4-7 in gstat's vignette "Spatio-temporal geostatistics using
>> gstat" on CRAN show the missing value for the zero temporal and zero
>> spatial lag class. I could not identify this property in your wireframe
>> plots.
>>
>> To me, the temporal effect looks like being "upside-down". I'll be happy
>> to take a quick look at your script/data in case your problem still remains.
>>
>> Best,
>>
>>  Ben
>>
>>
>>
>>
>> On 15.01.2013 11:51, Edzer Pebesma wrote:
>>
>>> Piero,
>>>
>>> from the orientation of your graph, I could not see very well what
>>> happens at zero-time, zero-space lag.
>>>
>>> Did you compute a pure-time variogram, i.e. with zero space distance?
>>> This one should have a missing zero-value, unless you have duplicate
>>> measurements.
>>>
>>> On 01/10/2013 03:20 PM, Piero Campalani wrote:
>>>
>>>> Dear list,
>>>>
>>>> I am predicting PM measurements on a spatiotemporal grid with monthly
>>>> intervals in time.
>>>> At modeling time, I am looking at the experimental 3D variograms
>>>> (`wireframes`) but I see that weird decreasing behavior in time (see
>>>> wireframes_2008-1.eps for January 2008): there is a peak at 0 time lags,
>>>> then correlation in time is much higher over different days.
>>>> How can I interpret such variogram?
>>>> Would it mean that there is a very high spatial variability for values on
>>>> the same day, whereas temporal variability is significantly lower?
>>>>
>>>> Thanks for any hint,
>>>> (I can provide implementation details in case of need)
>>>>
>>>> Piero
>>>>
>>>>
>>>>
>>>> ______________________________**_________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/**listinfo/r-sig-geo<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>>>>
>>>>
>>>
>> --
>> Benedikt Gr?ler
>>
>> ifgi - Institute for Geoinformatics
>> University of Muenster
>>
>> http://ifgi.uni-muenster.de/**graeler<http://ifgi.uni-muenster.de/graeler>
>>
>> Phone: +49 251 83-33082
>> Mail: ben.graeler at uni-muenster.de
>>
>>
>> ______________________________**_________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/**listinfo/r-sig-geo<https://stat.ethz.ch/mailman/listinfo/r-sig-geo>
>>
> 
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From oscar.perpinan at gmail.com  Sat Jan 19 19:14:06 2013
From: oscar.perpinan at gmail.com (=?ISO-8859-1?Q?Oscar_Perpi=F1an?=)
Date: Sat, 19 Jan 2013 19:14:06 +0100
Subject: [R-sig-Geo] How to show the color ramp legend with discrete
 data in spplot ?
In-Reply-To: <50FA9609.2040706@uni-muenster.de>
References: <CAPTbr1pZYh-eocA1vk2FA7Z8pHu0rdnDLnix7=1dY8YvBYTG5Q@mail.gmail.com>
	<50FA9609.2040706@uni-muenster.de>
Message-ID: <CAMLL7bmkoubkhB1bJuoNtqBzDt7Fgost=zo_aOsSNRCQybKDXA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130119/b5cc9d5a/attachment.pl>

From edzer.pebesma at uni-muenster.de  Sat Jan 19 19:29:57 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sat, 19 Jan 2013 19:29:57 +0100
Subject: [R-sig-Geo] How to show the color ramp legend with discrete
 data in spplot ?
In-Reply-To: <CAMLL7bmkoubkhB1bJuoNtqBzDt7Fgost=zo_aOsSNRCQybKDXA@mail.gmail.com>
References: <CAPTbr1pZYh-eocA1vk2FA7Z8pHu0rdnDLnix7=1dY8YvBYTG5Q@mail.gmail.com>
	<50FA9609.2040706@uni-muenster.de>
	<CAMLL7bmkoubkhB1bJuoNtqBzDt7Fgost=zo_aOsSNRCQybKDXA@mail.gmail.com>
Message-ID: <50FAE625.4020109@uni-muenster.de>



On 01/19/2013 07:14 PM, Oscar Perpi?an wrote:
>> Reflecting on that, it would involve a bit of programming, essentially
>> writing an appropriate panel function for lattice::levelplot. I did this
>> back then for polygons, found in sp:::panel.polygonsplot, which is 80
>> lines of R code. My guess is that it should be considerable more easy
>> for points. I'd be happy to receive & consider proposals.
>>
>> I think panel.levelplot.points from latticeExtra can be useful:
> http://latticeextra.r-forge.r-project.org/#panel.levelplot.points
> 
> Best,
> 
> Oscar.
> 

Thanks!

Sth like

library(latticeExtra)
library(sp)
loadMeuse()
levelplot(zinc~x+y, as.data.frame(meuse), panel=panel.levelplot.points,
    aspect = "iso", scales = list(draw=FALSE), xlab=NULL, ylab = NULL,
    colorkey = list(space = "bottom"))


would get you close, you might want to control xlim and ylim further.

I'll see how I can integrate this with spplot.

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From janesh.devkota at gmail.com  Sat Jan 19 21:17:03 2013
From: janesh.devkota at gmail.com (Jd Devkota)
Date: Sat, 19 Jan 2013 14:17:03 -0600
Subject: [R-sig-Geo] How to show the color ramp legend with discrete
 data in spplot ?
In-Reply-To: <50FAE625.4020109@uni-muenster.de>
References: <CAPTbr1pZYh-eocA1vk2FA7Z8pHu0rdnDLnix7=1dY8YvBYTG5Q@mail.gmail.com>
	<50FA9609.2040706@uni-muenster.de>
	<CAMLL7bmkoubkhB1bJuoNtqBzDt7Fgost=zo_aOsSNRCQybKDXA@mail.gmail.com>
	<50FAE625.4020109@uni-muenster.de>
Message-ID: <CAPTbr1okzr3EZBNmFs464Q+Xmv9EcU9CJ9K8Z8-PFVYRS0nXnQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130119/96c44764/attachment.pl>

From edzer.pebesma at uni-muenster.de  Sat Jan 19 21:25:50 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sat, 19 Jan 2013 21:25:50 +0100
Subject: [R-sig-Geo] How to show the color ramp legend with discrete
 data in spplot ?
In-Reply-To: <CAPTbr1okzr3EZBNmFs464Q+Xmv9EcU9CJ9K8Z8-PFVYRS0nXnQ@mail.gmail.com>
References: <CAPTbr1pZYh-eocA1vk2FA7Z8pHu0rdnDLnix7=1dY8YvBYTG5Q@mail.gmail.com>
	<50FA9609.2040706@uni-muenster.de>
	<CAMLL7bmkoubkhB1bJuoNtqBzDt7Fgost=zo_aOsSNRCQybKDXA@mail.gmail.com>
	<50FAE625.4020109@uni-muenster.de>
	<CAPTbr1okzr3EZBNmFs464Q+Xmv9EcU9CJ9K8Z8-PFVYRS0nXnQ@mail.gmail.com>
Message-ID: <50FB014E.9070200@uni-muenster.de>

If, by shapefile, you mean a SpatialPolygons object, try:

library(latticeExtra)
library(sp)
loadMeuse(river=TRUE)
levelplot(zinc~x+y, as.data.frame(meuse),
    panel=function(x,y,subset,...) {
        panel.levelplot.points(x,y,subset,...)
        sp.polygons(meuse.riv)
    },
    aspect = "iso", scales = list(draw=FALSE), xlab=NULL, ylab = NULL,
    colorkey = list(space = "bottom"), col.symbol = 0)


On 01/19/2013 09:17 PM, Jd Devkota wrote:
> Hi Edzer
> 
> Thank you for providing the code to start with.
> 
> I used that code you gave and slightly modified and got the results close.
> I have posted the links for both level plot and spplot at the bottom of the
> post. The colors on spplot is more smooth than the levelplot but the legend
> on levelplot is better. Another thing what command do I use to add
> shapefile in level plot ?In spplot I could use sp.list command.
> 
> 
> The code I used for levelplot is as follows:
> 
> levelplot(age2100$z~age2100$x+age2100$y, as.data.frame(age2100),
> panel=panel.levelplot.points,
>     aspect = "iso", scales = list(draw=FALSE), xlab=NULL, ylab =
> NULL,cex=1.35,cuts=40,
>     colorkey = list(space = "bottom"),col.regions = rainbow(100, start =
> 3/15, end = 1),
> xlim=c(438000,468900),ylim=c(3347500,3374500))
> 
> I also tried contourplot in place of levelplot but both of them gave me the
> same plot, no change. I added contour=TRUE, label=TRUE but no change.
> 
> Please suggest what needs to be done to make the colors smooth like spplot.
> 
> Levelplot has been uploaded on
> https://www.dropbox.com/s/qng6asyn6uc3x1z/levelplot.png
> 
> Spplot can be found on https://www.dropbox.com/s/0ws3uyiyrreza6n/spplot.png
> 
> Thanks a lot.
> 
> Janesh
> 
> 
> 
> On Sat, Jan 19, 2013 at 12:29 PM, Edzer Pebesma <
> edzer.pebesma at uni-muenster.de> wrote:
> 
>>
>>
>> On 01/19/2013 07:14 PM, Oscar Perpi?an wrote:
>>>> Reflecting on that, it would involve a bit of programming, essentially
>>>> writing an appropriate panel function for lattice::levelplot. I did this
>>>> back then for polygons, found in sp:::panel.polygonsplot, which is 80
>>>> lines of R code. My guess is that it should be considerable more easy
>>>> for points. I'd be happy to receive & consider proposals.
>>>>
>>>> I think panel.levelplot.points from latticeExtra can be useful:
>>> http://latticeextra.r-forge.r-project.org/#panel.levelplot.points
>>>
>>> Best,
>>>
>>> Oscar.
>>>
>>
>> Thanks!
>>
>> Sth like
>>
>> library(latticeExtra)
>> library(sp)
>> loadMeuse()
>> levelplot(zinc~x+y, as.data.frame(meuse), panel=panel.levelplot.points,
>>     aspect = "iso", scales = list(draw=FALSE), xlab=NULL, ylab = NULL,
>>     colorkey = list(space = "bottom"))
>>
>>
>> would get you close, you might want to control xlim and ylim further.
>>
>> I'll see how I can integrate this with spplot.
>>
>> --
>> Edzer Pebesma
>> Institute for Geoinformatics (ifgi), University of M?nster
>> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
>> 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
>> http://www.52north.org/geostatistics      e.pebesma at wwu.de
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From k.musa at lancaster.ac.uk  Sat Jan 19 22:11:54 2013
From: k.musa at lancaster.ac.uk (Musa, Kamarul Imran)
Date: Sat, 19 Jan 2013 21:11:54 +0000
Subject: [R-sig-Geo] Convert shapefiles to objects of the class geodata in
 geoR and geoRglm
Message-ID: <4AF347BCEED71C418A39B9DE1995E196C677F7@EX-0-MB1.lancs.local>

Hi all,

I appreciate if someone can help me with this. I have two shapefiles,each one in point and polygon format. I would like to convert them to objects of the class geodata to be used later on with 'geoR' and'geoRglm' packages. How can I do this?

Thanks very much.

Best regards,
Kamarul Imran Musa
Lancaster University

From janesh.devkota at gmail.com  Sat Jan 19 22:38:09 2013
From: janesh.devkota at gmail.com (Jd Devkota)
Date: Sat, 19 Jan 2013 15:38:09 -0600
Subject: [R-sig-Geo] How to show the color ramp legend with discrete
 data in spplot ?
In-Reply-To: <50FB014E.9070200@uni-muenster.de>
References: <CAPTbr1pZYh-eocA1vk2FA7Z8pHu0rdnDLnix7=1dY8YvBYTG5Q@mail.gmail.com>
	<50FA9609.2040706@uni-muenster.de>
	<CAMLL7bmkoubkhB1bJuoNtqBzDt7Fgost=zo_aOsSNRCQybKDXA@mail.gmail.com>
	<50FAE625.4020109@uni-muenster.de>
	<CAPTbr1okzr3EZBNmFs464Q+Xmv9EcU9CJ9K8Z8-PFVYRS0nXnQ@mail.gmail.com>
	<50FB014E.9070200@uni-muenster.de>
Message-ID: <CAPTbr1oGTKmihU2uxTDvfJbHRP-fU4GGP=bQ3TEGUxf=XQGkyA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130119/c4561e01/attachment.pl>

From oscar.perpinan at gmail.com  Sun Jan 20 01:34:01 2013
From: oscar.perpinan at gmail.com (=?ISO-8859-1?Q?Oscar_Perpi=F1an?=)
Date: Sun, 20 Jan 2013 01:34:01 +0100
Subject: [R-sig-Geo] How to show the color ramp legend with discrete
 data in spplot ?
In-Reply-To: <CAPTbr1oGTKmihU2uxTDvfJbHRP-fU4GGP=bQ3TEGUxf=XQGkyA@mail.gmail.com>
References: <CAPTbr1pZYh-eocA1vk2FA7Z8pHu0rdnDLnix7=1dY8YvBYTG5Q@mail.gmail.com>
	<50FA9609.2040706@uni-muenster.de>
	<CAMLL7bmkoubkhB1bJuoNtqBzDt7Fgost=zo_aOsSNRCQybKDXA@mail.gmail.com>
	<50FAE625.4020109@uni-muenster.de>
	<CAPTbr1okzr3EZBNmFs464Q+Xmv9EcU9CJ9K8Z8-PFVYRS0nXnQ@mail.gmail.com>
	<50FB014E.9070200@uni-muenster.de>
	<CAPTbr1oGTKmihU2uxTDvfJbHRP-fU4GGP=bQ3TEGUxf=XQGkyA@mail.gmail.com>
Message-ID: <CAMLL7bmur3x_aLA3Q101YOTs4O7ZDPoSdtKHRCZpLHbf+vwGOQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130120/b65f871b/attachment.pl>

From pgalpern at gmail.com  Mon Jan 21 20:41:37 2013
From: pgalpern at gmail.com (Paul Galpern)
Date: Mon, 21 Jan 2013 13:41:37 -0600
Subject: [R-sig-Geo] Class nb (spdep) from class igraph
Message-ID: <50FD99F1.3040805@gmail.com>

Is there a simple way to produce an nb object (in spdep) from a weighted 
or unweighted undirected graph (in igraph).

Could the output of igraph::graph.adjacency(x) be converted to class nb?

Alternatively, igraph::graph.edgelist(x) could be manipulated into class 
Graph, and then spdep::graph2nb() used.

Am I missing an obvious way to do this?

Thanks,
Paul

-- 
Paul Galpern
Natural Resources Institute
70 Dysart Road
University of Manitoba
Winnipeg, Manitoba, Canada R3T 2M6
http://borealscape.ca


From oscar.perpinan at gmail.com  Mon Jan 21 22:26:41 2013
From: oscar.perpinan at gmail.com (=?ISO-8859-1?Q?Oscar_Perpi=F1an?=)
Date: Mon, 21 Jan 2013 22:26:41 +0100
Subject: [R-sig-Geo] How to show the color ramp legend with discrete
 data in spplot ?
In-Reply-To: <50FAE625.4020109@uni-muenster.de>
References: <CAPTbr1pZYh-eocA1vk2FA7Z8pHu0rdnDLnix7=1dY8YvBYTG5Q@mail.gmail.com>
	<50FA9609.2040706@uni-muenster.de>
	<CAMLL7bmkoubkhB1bJuoNtqBzDt7Fgost=zo_aOsSNRCQybKDXA@mail.gmail.com>
	<50FAE625.4020109@uni-muenster.de>
Message-ID: <CAMLL7b=_9m7MV-Pj1ZgQJ-KT-uDhXXaBgXAc6Bxuz2mgQGzkuw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130121/c0105172/attachment.pl>

From alemu.tadesse at gmail.com  Tue Jan 22 00:46:20 2013
From: alemu.tadesse at gmail.com (Alemu Tadesse)
Date: Mon, 21 Jan 2013 16:46:20 -0700
Subject: [R-sig-Geo] Kriging problem
Message-ID: <CACGkHRM+pLSz3SdBh715ktRMueLm0ohr-4kPS94TeXTT1wP7FQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130121/a6017bf9/attachment.pl>

From alemu.tadesse at gmail.com  Tue Jan 22 07:12:05 2013
From: alemu.tadesse at gmail.com (Alemu Tadesse)
Date: Mon, 21 Jan 2013 23:12:05 -0700
Subject: [R-sig-Geo] Kriging problem
In-Reply-To: <CACGkHRMh1nMUU-t709YbAUgcSno=EHtGh3XDyi=dW-j_BZ0yrQ@mail.gmail.com>
References: <CACGkHRM+pLSz3SdBh715ktRMueLm0ohr-4kPS94TeXTT1wP7FQ@mail.gmail.com>
	<CACGkHRMh1nMUU-t709YbAUgcSno=EHtGh3XDyi=dW-j_BZ0yrQ@mail.gmail.com>
Message-ID: <CACGkHRN76V2zK+4vF7-LF0ppcfoZ4yNDXr+07jy=Uu8uj9w33g@mail.gmail.com>

>  Dear All,
>
>>
>>
>> I was trying to understand the spatial variability of a variable over a
>> region (variogram and kriging). I have attache the file for you to have a
>> look if ONLY you have a time. I am not familiar how R is computing
>> variogram and ultimately kriging. I read couple of papers and I had
>> difficulty to understand them. I really appreciate your help. For most of
>> you this might be a very trivial problem.
>>
>> Thank you in Advance for your time and help.
>>
>> Best,
>> Alemu
>>
>>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130121/3af46356/attachment.html>
-------------- next part --------------
stn_id,id1,id2,id3,id8,id7,id65,,,
lat,40.658519,40.637669,40.604976,40.697424,40.686422,40.643817,,,
lon,-74.226656,-74.263492,-74.289558,-74.276542,-74.310531,-74.22905,,,
2012,1,5,1,-0.073466667,-0.073466667,-0.076,-0.054466667,-0.063333333,-0.077283333
2012,1,5,2,-0.073466667,-0.074733333,-0.076,-0.048133333,-0.073466667,-0.076
2012,1,5,3,-0.073466667,-0.070933333,-0.076,-0.038,-0.0646,-0.077283333
2012,1,5,4,-0.073466667,-0.07475,-0.076,-0.048133333,-0.065866667,-0.077283333
2012,1,5,5,-0.070933333,-0.076,-0.076,-0.043066667,-0.076,-0.076
2012,1,5,6,-0.0722,-0.0722,-0.076,-0.039266667,-0.072135593,-0.076
2012,1,5,7,-0.0608,-0.039216667,-0.0722,-0.040533333,-0.067133333,-0.07985
2012,1,5,8,3.50575,9.45795,2.8979,3.320066667,3.400166667,2.89915
2012,1,5,9,39.24308333,29.74076667,34.85105,29.4584,27.5523,33.7449
2012,1,5,10,62.36396667,165.7473667,54.6011,53.50116667,53.224,53.9831
2012,1,5,11,274.53615,418.1773333,163.9925167,287.028,270.8855,203.9171833
2012,1,5,12,692.5392,495.0155167,528.1320667,578.0880833,558.67645,551.7641833
2012,1,5,13,671.98945,511.5267667,557.3705167,562.1986333,547.3289,571.6336
2012,1,5,14,240.3272333,409.9439,277.0628333,176.3801,161.4838167,232.2921833
2012,1,5,15,180.5622667,310.8444167,144.37865,171.7453,138.30065,199.7439333
2012,1,5,16,173.6552,219.1213333,82.99003333,165.60495,116.5084833,162.4196167
2012,1,5,17,16.9067,15.93268333,19.17143333,31.40643333,13.12256667,22.6466
2012,1,5,18,0.000116667,-0.041783333,-0.049333333,0.008983333,-0.037916667,-0.0557
2012,1,5,19,-0.057,-0.067133333,-0.076,-0.036733333,-0.0684,-0.077283333
2012,1,5,20,-0.063333333,-0.065866667,-0.076,-0.038,-0.0684,-0.076
2012,1,5,21,-0.069666667,-0.0684,-0.076,-0.050666667,-0.069666667,-0.084983333
2012,1,5,22,-0.0722,-0.0722,-0.076,-0.044333333,-0.073466667,-0.082416667
2012,1,5,23,-0.0684,-0.063333333,-0.076,-0.044333333,-0.073466667,-0.0837
2012,1,6,0,-0.073466667,-0.0722,-0.076,-0.051933333,-0.074733333,-0.077283333
2012,1,6,1,-0.069666667,-0.069666667,-0.076,-0.058266667,-0.0722,-0.077283333
2012,1,6,2,-0.069666667,-0.068383333,-0.076,-0.0494,-0.0722,-0.076
2012,1,6,3,-0.0684,-0.074733333,-0.076,-0.043066667,-0.067133333,-0.077283333
2012,1,6,4,-0.065866667,-0.070933333,-0.076,-0.0418,-0.0684,-0.077283333
2012,1,6,5,-0.069666667,-0.070933333,-0.076,-0.044333333,-0.076,-0.076
2012,1,6,6,-0.073466667,-0.070933333,-0.076,-0.0532,-0.068271186,-0.078566667
2012,1,6,7,-0.04045,-0.058266667,-0.058233333,-0.029066667,-0.041716667,-0.073583333
2012,1,6,8,20.10728333,9.602883333,16.88131667,16.94738333,17.78286667,15.66575
2012,1,6,9,153.5403167,29.46091667,84.1853,113.2278667,112.09875,110.6657167
2012,1,6,10,472.4655,171.3626,249.1353333,383.72045,354.2734667,323.9733333
2012,1,6,11,394.8135667,431.9991667,289.0584237,264.0037333,226.0360833,322.0456333
2012,1,6,12,376.6912,445.3010667,399.32505,232.17015,224.67675,319.3384833
2012,1,6,13,475.3761667,395.30565,446.7671667,381.4303167,443.60735,423.0613167
2012,1,6,14,470.2860667,464.92645,439.6095167,373.1142167,370.4732667,436.3632167
2012,1,6,15,200.4229,208.09555,200.8997333,166.51545,164.1425833,184.9695833
2012,1,6,16,82.33896667,190.6382333,69.17321667,66.99255,65.7552,70.74231667
2012,1,6,17,19.79705,30.03441667,19.36981667,19.90133333,17.47266667,26.09636667
2012,1,6,18,0.115766667,-0.036683333,0.076516667,0.115783333,0.076433333,0.08285
2012,1,6,19,-0.0266,-0.0722,-0.076,-0.0342,-0.062066667,-0.07985
2012,1,6,20,-0.037983333,-0.0684,-0.076,-0.027866667,-0.055733333,-0.076
2012,1,6,21,-0.048133333,-0.073466667,-0.076,-0.032933333,-0.059533333,-0.076
2012,1,6,22,-0.046866667,-0.073466667,-0.076,-0.0342,-0.069666667,-0.07985
2012,1,6,23,-0.0494,-0.074733333,-0.076,-0.035466667,-0.069666667,-0.081133333

From alemu.tadesse at gmail.com  Tue Jan 22 07:25:21 2013
From: alemu.tadesse at gmail.com (Alemu Tadesse)
Date: Mon, 21 Jan 2013 23:25:21 -0700
Subject: [R-sig-Geo] Kriging
Message-ID: <CACGkHRM37VA6oireWHf7dPTb5U3LQd0f7kD1PR0Gp19xrACKGA@mail.gmail.com>

Dear All,

I was trying to understand the spatial variability of a variable over a
region (variogram and kriging). I have attache the file for you to have a
look if ONLY you have a time. I am not familiar how R is computing
variogram and ultimately kriging. I read couple of papers and I had
difficulty to understand them. I really appreciate your help. For most of
you this might be a very trivial problem.

Thank you in Advance for your time and help.

Best,
Alemu
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130121/12f9f249/attachment.html>
-------------- next part --------------
stn_id,id1,id2,id3,id8,id7,id65,,,
lat,40.658519,40.637669,40.604976,40.697424,40.686422,40.643817,,,
lon,-74.226656,-74.263492,-74.289558,-74.276542,-74.310531,-74.22905,,,
2012,1,5,1,-0.073466667,-0.073466667,-0.076,-0.054466667,-0.063333333,-0.077283333
2012,1,5,2,-0.073466667,-0.074733333,-0.076,-0.048133333,-0.073466667,-0.076
2012,1,5,3,-0.073466667,-0.070933333,-0.076,-0.038,-0.0646,-0.077283333
2012,1,5,4,-0.073466667,-0.07475,-0.076,-0.048133333,-0.065866667,-0.077283333
2012,1,5,5,-0.070933333,-0.076,-0.076,-0.043066667,-0.076,-0.076
2012,1,5,6,-0.0722,-0.0722,-0.076,-0.039266667,-0.072135593,-0.076
2012,1,5,7,-0.0608,-0.039216667,-0.0722,-0.040533333,-0.067133333,-0.07985
2012,1,5,8,3.50575,9.45795,2.8979,3.320066667,3.400166667,2.89915
2012,1,5,9,39.24308333,29.74076667,34.85105,29.4584,27.5523,33.7449
2012,1,5,10,62.36396667,165.7473667,54.6011,53.50116667,53.224,53.9831
2012,1,5,11,274.53615,418.1773333,163.9925167,287.028,270.8855,203.9171833
2012,1,5,12,692.5392,495.0155167,528.1320667,578.0880833,558.67645,551.7641833
2012,1,5,13,671.98945,511.5267667,557.3705167,562.1986333,547.3289,571.6336
2012,1,5,14,240.3272333,409.9439,277.0628333,176.3801,161.4838167,232.2921833
2012,1,5,15,180.5622667,310.8444167,144.37865,171.7453,138.30065,199.7439333
2012,1,5,16,173.6552,219.1213333,82.99003333,165.60495,116.5084833,162.4196167
2012,1,5,17,16.9067,15.93268333,19.17143333,31.40643333,13.12256667,22.6466
2012,1,5,18,0.000116667,-0.041783333,-0.049333333,0.008983333,-0.037916667,-0.0557
2012,1,5,19,-0.057,-0.067133333,-0.076,-0.036733333,-0.0684,-0.077283333
2012,1,5,20,-0.063333333,-0.065866667,-0.076,-0.038,-0.0684,-0.076
2012,1,5,21,-0.069666667,-0.0684,-0.076,-0.050666667,-0.069666667,-0.084983333
2012,1,5,22,-0.0722,-0.0722,-0.076,-0.044333333,-0.073466667,-0.082416667
2012,1,5,23,-0.0684,-0.063333333,-0.076,-0.044333333,-0.073466667,-0.0837
2012,1,6,0,-0.073466667,-0.0722,-0.076,-0.051933333,-0.074733333,-0.077283333
2012,1,6,1,-0.069666667,-0.069666667,-0.076,-0.058266667,-0.0722,-0.077283333
2012,1,6,2,-0.069666667,-0.068383333,-0.076,-0.0494,-0.0722,-0.076
2012,1,6,3,-0.0684,-0.074733333,-0.076,-0.043066667,-0.067133333,-0.077283333
2012,1,6,4,-0.065866667,-0.070933333,-0.076,-0.0418,-0.0684,-0.077283333
2012,1,6,5,-0.069666667,-0.070933333,-0.076,-0.044333333,-0.076,-0.076
2012,1,6,6,-0.073466667,-0.070933333,-0.076,-0.0532,-0.068271186,-0.078566667
2012,1,6,7,-0.04045,-0.058266667,-0.058233333,-0.029066667,-0.041716667,-0.073583333
2012,1,6,8,20.10728333,9.602883333,16.88131667,16.94738333,17.78286667,15.66575
2012,1,6,9,153.5403167,29.46091667,84.1853,113.2278667,112.09875,110.6657167
2012,1,6,10,472.4655,171.3626,249.1353333,383.72045,354.2734667,323.9733333
2012,1,6,11,394.8135667,431.9991667,289.0584237,264.0037333,226.0360833,322.0456333
2012,1,6,12,376.6912,445.3010667,399.32505,232.17015,224.67675,319.3384833
2012,1,6,13,475.3761667,395.30565,446.7671667,381.4303167,443.60735,423.0613167
2012,1,6,14,470.2860667,464.92645,439.6095167,373.1142167,370.4732667,436.3632167
2012,1,6,15,200.4229,208.09555,200.8997333,166.51545,164.1425833,184.9695833
2012,1,6,16,82.33896667,190.6382333,69.17321667,66.99255,65.7552,70.74231667
2012,1,6,17,19.79705,30.03441667,19.36981667,19.90133333,17.47266667,26.09636667
2012,1,6,18,0.115766667,-0.036683333,0.076516667,0.115783333,0.076433333,0.08285
2012,1,6,19,-0.0266,-0.0722,-0.076,-0.0342,-0.062066667,-0.07985
2012,1,6,20,-0.037983333,-0.0684,-0.076,-0.027866667,-0.055733333,-0.076
2012,1,6,21,-0.048133333,-0.073466667,-0.076,-0.032933333,-0.059533333,-0.076
2012,1,6,22,-0.046866667,-0.073466667,-0.076,-0.0342,-0.069666667,-0.07985
2012,1,6,23,-0.0494,-0.074733333,-0.076,-0.035466667,-0.069666667,-0.081133333

From Roger.Bivand at nhh.no  Tue Jan 22 08:44:45 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 22 Jan 2013 08:44:45 +0100
Subject: [R-sig-Geo] Class nb (spdep) from class igraph
In-Reply-To: <50FD99F1.3040805@gmail.com>
References: <50FD99F1.3040805@gmail.com>
Message-ID: <alpine.LRH.2.02.1301220827370.23461@reclus.nhh.no>

On Mon, 21 Jan 2013, Paul Galpern wrote:

> Is there a simple way to produce an nb object (in spdep) from a weighted or 
> unweighted undirected graph (in igraph).

No, unless you can make them back into a (possibly sparse) adjacency 
matrix. The igraph S3 class (returned by graph.adjacency) is fish soup, 
while the input adjacency matrix would work directly with 
spdep::mat2listw().

Please provide sample code to illustrate your question - preferably 
showing how to go from and to nb objects. If you add igraph <-> graphNEL 
<-> sparse matrix, you can get there, but not igraph <-> nb in one hop, 
going through graphNEL is needed:

library(igraph)
set.seed(1)
adjm <- matrix(sample(0:1, 100, replace=TRUE, prob=c(0.8,0.2)), nc=10)
g1 <- graph.adjacency(adjm)
library(graph)
g1G <- igraph.to.graphNEL(g1)
library(Matrix)
sM <- as(g1G, "sparseMatrix")
library(spdep)
nb <- mat2listw(sM)$neighbours
nb
sum(adjm)

If you wanted to contribute a function, the igraph.[to|from].graphNEL code 
would probably show how it could be done, because graphNEL are quite 
similar to listw objects.

Hope this helps,

Roger

>
> Could the output of igraph::graph.adjacency(x) be converted to class nb?
>
> Alternatively, igraph::graph.edgelist(x) could be manipulated into class 
> Graph, and then spdep::graph2nb() used.
>
> Am I missing an obvious way to do this?
>
> Thanks,
> Paul
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From hailushi31 at yahoo.com  Tue Jan 22 13:09:11 2013
From: hailushi31 at yahoo.com (Hailu)
Date: Tue, 22 Jan 2013 04:09:11 -0800 (PST)
Subject: [R-sig-Geo] some help
In-Reply-To: <mailman.11.1358852403.20390.r-sig-geo@r-project.org>
Message-ID: <1358856551.17163.YahooMailClassic@web121404.mail.ne1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130122/468eb371/attachment.pl>

From edzer.pebesma at uni-muenster.de  Tue Jan 22 13:36:41 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 22 Jan 2013 13:36:41 +0100
Subject: [R-sig-Geo] some help
In-Reply-To: <1358856551.17163.YahooMailClassic@web121404.mail.ne1.yahoo.com>
References: <1358856551.17163.YahooMailClassic@web121404.mail.ne1.yahoo.com>
Message-ID: <50FE87D9.5090902@uni-muenster.de>

It indicates a singular or near-singular covariance matrix.

The two most common reasons for this are: (i) you have one or more
duplicate observations (try: zerodist(Dembia.utm)) , or (ii) using a
Gaussian variogram model.

Deciphering your "script", it seems (ii) might apply.

On 01/22/2013 01:09 PM, Hailu wrote:
> Dear all,what is LDLfactor in kriging?I got at error message while I was using OK. the error statement is like this "Error in predict.gstat(g, newdata = newdata, block = block, nsim = nsim, :   LDLfactor "
> I was using the following optional script for kriging to run: 1. <Dembia.OM.krg <- krige(OM_perc~1, loc=Dembia.utm, newdata=Dembia.grid, model=fit.OM_perc.gau)>2. <Dembia.OM.krg <- krige(OM_perc ~1, Dembia.utm, Dembia.grid, fit.OM_perc.gau)>3. <Dembia.OM.krg <- krige(OM_perc~1, newdata=Dembia.utm, block=Dembia.grid, model=fit.OM_perc.gau)>
> all of the above give the same error, and kriging does not work.Can you give me some hint?Thanks
> 
> Hailu 
> --- On Tue, 1/22/13, r-sig-geo-request at r-project.org <r-sig-geo-request at r-project.org> wrote:
> 
> From: r-sig-geo-request at r-project.org <r-sig-geo-request at r-project.org>
> Subject: R-sig-Geo Digest, Vol 113, Issue 21
> To: r-sig-geo at r-project.org
> Date: Tuesday, January 22, 2013, 3:00 AM
> 
> Send R-sig-Geo mailing list submissions to
>     r-sig-geo at r-project.org
> 
> To subscribe or unsubscribe via the World Wide Web, visit
>     https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> or, via email, send a message with subject or body 'help' to
>     r-sig-geo-request at r-project.org
> 
> You can reach the person managing the list at
>     r-sig-geo-owner at r-project.org
> 
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of R-sig-Geo digest..."
> 
> 
> Today's Topics:
> 
>    1. Class nb (spdep) from class igraph (Paul Galpern)
>    2. Re: How to show the color ramp legend with discrete data in
>       spplot ? (Oscar Perpi?an)
>    3. Kriging problem (Alemu Tadesse)
>    4. Re: Kriging problem (Alemu Tadesse)
>    5. Kriging (Alemu Tadesse)
>    6. Re: Class nb (spdep) from class igraph (Roger Bivand)
> 
> 
> ----------------------------------------------------------------------
> 
> Message: 1
> Date: Mon, 21 Jan 2013 13:41:37 -0600
> From: Paul Galpern <pgalpern at gmail.com>
> To: "r-sig-geo at r-project.org" <r-sig-geo at r-project.org>
> Subject: [R-sig-Geo] Class nb (spdep) from class igraph
> Message-ID: <50FD99F1.3040805 at gmail.com>
> Content-Type: text/plain; charset=ISO-8859-1; format=flowed
> 
> Is there a simple way to produce an nb object (in spdep) from a weighted 
> or unweighted undirected graph (in igraph).
> 
> Could the output of igraph::graph.adjacency(x) be converted to class nb?
> 
> Alternatively, igraph::graph.edgelist(x) could be manipulated into class 
> Graph, and then spdep::graph2nb() used.
> 
> Am I missing an obvious way to do this?
> 
> Thanks,
> Paul
> 
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From hi_ono2001 at ybb.ne.jp  Tue Jan 22 14:23:00 2013
From: hi_ono2001 at ybb.ne.jp (hi_ono2001 at ybb.ne.jp)
Date: Tue, 22 Jan 2013 22:23:00 +0900 (JST)
Subject: [R-sig-Geo] About your BiDimensional Regression Package
Message-ID: <401372.92164.qm@web200203.mail.kks.yahoo.co.jp>

Hello,
 
  I've been very interested in your recently published package in CRAN.
 
  However I was disappointed by yor shortage of description of this package.
 
  Waldo Tobler's original paper dealt with following three types of parameter calibration methods as you might know.
 
  From reading scripts,? function "BiDimensional " seems to support only one method. Which one does your function support?
 
  Could you add more description in the document?
 
 
 Thanks in advance.

> 
>


From pgalpern at gmail.com  Tue Jan 22 16:13:09 2013
From: pgalpern at gmail.com (Paul Galpern)
Date: Tue, 22 Jan 2013 09:13:09 -0600
Subject: [R-sig-Geo] Class nb (spdep) from class igraph
In-Reply-To: <alpine.LRH.2.02.1301220827370.23461@reclus.nhh.no>
References: <50FD99F1.3040805@gmail.com>
	<alpine.LRH.2.02.1301220827370.23461@reclus.nhh.no>
Message-ID: <50FEAC85.7020701@gmail.com>

Thanks Roger.

Apologies: the two functions I intended to reference in my original post 
were igraph::get.adjacency() and igraph::get.edgelist() which produce a 
slightly clearer broth (I like this expression "fish soup").

Your suggestion requiring a third party package seems the easiest. I 
found another 3rd party approach using the ade4 package which has two 
functions ade4::neig() and ade4::neig2nb() that together do the trick.  
(Note this approach ignores edge weights).

library(igraph)
library(spdep)

## igraph2nb
## Convert igraph undirected graphs (of S3 class igraph) into nb objects 
(class spdep)
## No checking performed
igraph2nb <- function(gr) {
     library(ade4)
     return(neig2nb(neig(edges=get.edgelist(gr))))
}

## Create simple igraph object
ringGraph <- graph.ring(10)

## Convert to nb object
ringGraph_nb <- igraph2nb(ringGraph)

## Visualize using plot.nb
plot(ringGraph_nb, coords=cbind(runif(10), runif(10)))


Best,
Paul

On 22/01/2013 1:44 AM, Roger Bivand wrote:
> On Mon, 21 Jan 2013, Paul Galpern wrote:
>
>> Is there a simple way to produce an nb object (in spdep) from a 
>> weighted or unweighted undirected graph (in igraph).
>
> No, unless you can make them back into a (possibly sparse) adjacency 
> matrix. The igraph S3 class (returned by graph.adjacency) is fish 
> soup, while the input adjacency matrix would work directly with 
> spdep::mat2listw().
>
> Please provide sample code to illustrate your question - preferably 
> showing how to go from and to nb objects. If you add igraph <-> 
> graphNEL <-> sparse matrix, you can get there, but not igraph <-> nb 
> in one hop, going through graphNEL is needed:
>
> library(igraph)
> set.seed(1)
> adjm <- matrix(sample(0:1, 100, replace=TRUE, prob=c(0.8,0.2)), nc=10)
> g1 <- graph.adjacency(adjm)
> library(graph)
> g1G <- igraph.to.graphNEL(g1)
> library(Matrix)
> sM <- as(g1G, "sparseMatrix")
> library(spdep)
> nb <- mat2listw(sM)$neighbours
> nb
> sum(adjm)
>
> If you wanted to contribute a function, the igraph.[to|from].graphNEL 
> code would probably show how it could be done, because graphNEL are 
> quite similar to listw objects.
>
> Hope this helps,
>
> Roger
>
>>
>> Could the output of igraph::graph.adjacency(x) be converted to class nb?
>>
>> Alternatively, igraph::graph.edgelist(x) could be manipulated into 
>> class Graph, and then spdep::graph2nb() used.
>>
>> Am I missing an obvious way to do this?
>>
>> Thanks,
>> Paul
>>
>>
>

-- 
Paul Galpern
Natural Resources Institute
70 Dysart Road
University of Manitoba
Winnipeg, Manitoba, Canada R3T 2M6
http://borealscape.ca


From edzer.pebesma at uni-muenster.de  Tue Jan 22 19:14:16 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 22 Jan 2013 19:14:16 +0100
Subject: [R-sig-Geo] How to show the color ramp legend with discrete
 data in spplot ?
In-Reply-To: <CAMLL7b=_9m7MV-Pj1ZgQJ-KT-uDhXXaBgXAc6Bxuz2mgQGzkuw@mail.gmail.com>
References: <CAPTbr1pZYh-eocA1vk2FA7Z8pHu0rdnDLnix7=1dY8YvBYTG5Q@mail.gmail.com>
	<50FA9609.2040706@uni-muenster.de>
	<CAMLL7bmkoubkhB1bJuoNtqBzDt7Fgost=zo_aOsSNRCQybKDXA@mail.gmail.com>
	<50FAE625.4020109@uni-muenster.de>
	<CAMLL7b=_9m7MV-Pj1ZgQJ-KT-uDhXXaBgXAc6Bxuz2mgQGzkuw@mail.gmail.com>
Message-ID: <50FED6F8.9090200@uni-muenster.de>



On 01/21/2013 10:26 PM, Oscar Perpi?an wrote:
> Hello,
> 
>> I'll see how I can integrate this with spplot.
>> Edzer Pebesma
> 
> Perhaps the approach of the figure 5.6 of the "Lattice" book can be more
> easily integrated in the spplot method:
> http://lmdvr.r-forge.r-project.org/figures/figures.html?chapter=05;figure=05_06;theme=stdBW;code=right
> It uses xyplot and displays the legend with draw.key.
> 

Thanks for the suggestion.

I committed this to sp; in particular with sp from svn on r-forge one
can now e.g. do

loadMeuse()
spplot(meuse[c("lead", "zinc")], edge.col=1, colorkey=TRUE,
cuts=c(10,100,200,500,1000,2000))

edge.col = 1 results in black lines around the symbols,
colorkey = TRUE results in levelplot-type legend, instead the one with
the symbols; the default nr of colors used will also be large (100).

Comments welcome,

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From piero.campa at gmail.com  Tue Jan 22 20:50:01 2013
From: piero.campa at gmail.com (Piero Campalani)
Date: Tue, 22 Jan 2013 20:50:01 +0100
Subject: [R-sig-Geo] Cross-validation with spacetime
In-Reply-To: <50F2ECF6.7070908@uni-muenster.de>
References: <CAMp9JaM8QFrNx9S42oHjHB2WPhCxFVan1EWW3p=dKpjttTtgyA@mail.gmail.com>
	<50F2ECF6.7070908@uni-muenster.de>
Message-ID: <CAMp9JaOrTMNFji1h8f965ozXWt=CivSWBdK8RvLwzk_kxLim-Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130122/17d7e565/attachment.pl>

From thi_veloso at yahoo.com.br  Wed Jan 23 00:55:47 2013
From: thi_veloso at yahoo.com.br (Thiago V. dos Santos)
Date: Tue, 22 Jan 2013 15:55:47 -0800 (PST)
Subject: [R-sig-Geo] See coordinates vector in raster
Message-ID: <1358898947.75663.YahooMailNeo@web121903.mail.ne1.yahoo.com>

Dear all,

Is there any way to access the vector containing the longitude and latitude coordinates of a raster object? For example:


library(raster)
r1 <- raster(nrows=800, ncols=820, xmn=0, xmx=10)

# I am looking for something like this:
r1$lon
r2$lat

Thanks in advance,

Thiago.


From mdsumner at gmail.com  Wed Jan 23 01:06:57 2013
From: mdsumner at gmail.com (Michael Sumner)
Date: Wed, 23 Jan 2013 11:06:57 +1100
Subject: [R-sig-Geo] See coordinates vector in raster
In-Reply-To: <1358898947.75663.YahooMailNeo@web121903.mail.ne1.yahoo.com>
References: <1358898947.75663.YahooMailNeo@web121903.mail.ne1.yahoo.com>
Message-ID: <CAAcGz99KRU_U2WfxoKORwsvQzSXGmSYayB5j2fpxwgGDLRf+_w@mail.gmail.com>

You can just do

xy <- coordinates(r1)

which gives a 2-column matrix with

lon <- xy[,1]
lat <- xy[,2]

Note that for largish rasters this is a considerable amount of data,
and it's mostly all redundant since you can generate it from the
resolution and extent, so you might need to consider other options.

Cheers, Mike.

On Wed, Jan 23, 2013 at 10:55 AM, Thiago V. dos Santos
<thi_veloso at yahoo.com.br> wrote:
> Dear all,
>
> Is there any way to access the vector containing the longitude and latitude coordinates of a raster object? For example:
>
>
> library(raster)
> r1 <- raster(nrows=800, ncols=820, xmn=0, xmx=10)
>
> # I am looking for something like this:
> r1$lon
> r2$lat
>
> Thanks in advance,
>
> Thiago.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Michael Sumner
Hobart, Australia
e-mail: mdsumner at gmail.com


From b.rowlingson at lancaster.ac.uk  Wed Jan 23 14:33:51 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed, 23 Jan 2013 13:33:51 +0000
Subject: [R-sig-Geo] See coordinates vector in raster
In-Reply-To: <3d60722b16a744a582b8eaf4528ac1bf@EX-0-HT0.lancs.local>
References: <1358898947.75663.YahooMailNeo@web121903.mail.ne1.yahoo.com>
	<3d60722b16a744a582b8eaf4528ac1bf@EX-0-HT0.lancs.local>
Message-ID: <CANVKczMBPc1V2Lh9ZJqpy+7F74WmdQJ-ShaTqVe49WfA3F8K_g@mail.gmail.com>

On Wed, Jan 23, 2013 at 12:06 AM, Michael Sumner <mdsumner at gmail.com> wrote:
> You can just do
>
> xy <- coordinates(r1)
>
> which gives a 2-column matrix with
>
> lon <- xy[,1]
> lat <- xy[,2]
>
> Note that for largish rasters this is a considerable amount of data,
> and it's mostly all redundant since you can generate it from the
> resolution and extent, so you might need to consider other options.

 Better to use xFromCol and yFromRow!

xFromCol(r,1:ncol(r))
yFromRow(r,1:nrow(r))

 should do the job.

Barry


From mathieu.rajerison at gmail.com  Wed Jan 23 16:19:37 2013
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Wed, 23 Jan 2013 16:19:37 +0100
Subject: [R-sig-Geo] How to clip the object created by Conourlines2SLDF
 with polygon
In-Reply-To: <1358564402234-7582339.post@n2.nabble.com>
References: <1358564402234-7582339.post@n2.nabble.com>
Message-ID: <CAGfc75mKAtY7--kHNP9r7B7gi9aFjTScxRaeAfoWfWsKwVuxQw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130123/98a5712e/attachment.pl>

From thi_veloso at yahoo.com.br  Wed Jan 23 20:57:41 2013
From: thi_veloso at yahoo.com.br (Thiago V. dos Santos)
Date: Wed, 23 Jan 2013 11:57:41 -0800 (PST)
Subject: [R-sig-Geo] See coordinates vector in raster
In-Reply-To: <CANVKczMBPc1V2Lh9ZJqpy+7F74WmdQJ-ShaTqVe49WfA3F8K_g@mail.gmail.com>
References: <1358898947.75663.YahooMailNeo@web121903.mail.ne1.yahoo.com>
	<3d60722b16a744a582b8eaf4528ac1bf@EX-0-HT0.lancs.local>
	<CANVKczMBPc1V2Lh9ZJqpy+7F74WmdQJ-ShaTqVe49WfA3F8K_g@mail.gmail.com>
Message-ID: <1358971061.36934.YahooMailNeo@web121902.mail.ne1.yahoo.com>

Michael and Barry,

Thank you for the tips. Both worked like a charm!

Regards,
Thiago.


----- Original Message -----
From: Barry Rowlingson <b.rowlingson at lancaster.ac.uk>
To: Michael Sumner <mdsumner at gmail.com>
Cc: Thiago V. dos Santos <thi_veloso at yahoo.com.br>; R-SIG list <r-sig-geo at r-project.org>
Sent: Wednesday, January 23, 2013 7:33 AM
Subject: Re: [R-sig-Geo] See coordinates vector in raster

On Wed, Jan 23, 2013 at 12:06 AM, Michael Sumner <mdsumner at gmail.com> wrote:
> You can just do
>
> xy <- coordinates(r1)
>
> which gives a 2-column matrix with
>
> lon <- xy[,1]
> lat <- xy[,2]
>
> Note that for largish rasters this is a considerable amount of data,
> and it's mostly all redundant since you can generate it from the
> resolution and extent, so you might need to consider other options.

Better to use xFromCol and yFromRow!

xFromCol(r,1:ncol(r))
yFromRow(r,1:nrow(r))

should do the job.

Barry



From mdsumner at gmail.com  Thu Jan 24 02:17:23 2013
From: mdsumner at gmail.com (Michael Sumner)
Date: Thu, 24 Jan 2013 12:17:23 +1100
Subject: [R-sig-Geo] See coordinates vector in raster
In-Reply-To: <CANVKczMBPc1V2Lh9ZJqpy+7F74WmdQJ-ShaTqVe49WfA3F8K_g@mail.gmail.com>
References: <1358898947.75663.YahooMailNeo@web121903.mail.ne1.yahoo.com>
	<3d60722b16a744a582b8eaf4528ac1bf@EX-0-HT0.lancs.local>
	<CANVKczMBPc1V2Lh9ZJqpy+7F74WmdQJ-ShaTqVe49WfA3F8K_g@mail.gmail.com>
Message-ID: <CAAcGz9_cqKs8TH9Rg8=Ma_p1HRtP18ipf3LgjLDCXqXW=VM89g@mail.gmail.com>

"Better" depends on what was required, which wasn't specified - all
the coordinates, or just 1-d arrays of the unique ones. Our answers
are totally different, Thiago I trust that you see the difference?

It would be good if xFromCol / yFromRow had defaults for their second
argument to return all if colnr/rownr are not specified.

Robert: do you think that's a reasonable modification?  (Or are their
already other functions for that?) :)

Cheers, Mike.

On Thu, Jan 24, 2013 at 12:33 AM, Barry Rowlingson
<b.rowlingson at lancaster.ac.uk> wrote:
> On Wed, Jan 23, 2013 at 12:06 AM, Michael Sumner <mdsumner at gmail.com> wrote:
>> You can just do
>>
>> xy <- coordinates(r1)
>>
>> which gives a 2-column matrix with
>>
>> lon <- xy[,1]
>> lat <- xy[,2]
>>
>> Note that for largish rasters this is a considerable amount of data,
>> and it's mostly all redundant since you can generate it from the
>> resolution and extent, so you might need to consider other options.
>
>  Better to use xFromCol and yFromRow!
>
> xFromCol(r,1:ncol(r))
> yFromRow(r,1:nrow(r))
>
>  should do the job.
>
> Barry



-- 
Michael Sumner
Hobart, Australia
e-mail: mdsumner at gmail.com


From mathieu.rajerison at gmail.com  Thu Jan 24 14:17:33 2013
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Thu, 24 Jan 2013 14:17:33 +0100
Subject: [R-sig-Geo] Finding the Circumscribing Circle of a polygon
Message-ID: <CAGfc75kY5KESgwB-UoQh4EFn0Et9EZUmweyNa3j31VpWZUHnaA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130124/39c3f6cb/attachment.pl>

From mathieu.rajerison at gmail.com  Thu Jan 24 15:19:14 2013
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Thu, 24 Jan 2013 15:19:14 +0100
Subject: [R-sig-Geo] Finding the Circumscribing Circle of a polygon
In-Reply-To: <CAGfc75kY5KESgwB-UoQh4EFn0Et9EZUmweyNa3j31VpWZUHnaA@mail.gmail.com>
References: <CAGfc75kY5KESgwB-UoQh4EFn0Et9EZUmweyNa3j31VpWZUHnaA@mail.gmail.com>
Message-ID: <CAGfc75=6h4Gb1889fFNE9vRU_UQOq6P16eOe5Tb6iQ4sUvwNXw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130124/26539c81/attachment.pl>

From etiennebr at gmail.com  Thu Jan 24 20:10:18 2013
From: etiennebr at gmail.com (Etienne B. Racine)
Date: Thu, 24 Jan 2013 14:10:18 -0500
Subject: [R-sig-Geo] See coordinates vector in raster
In-Reply-To: <CAAcGz9_cqKs8TH9Rg8=Ma_p1HRtP18ipf3LgjLDCXqXW=VM89g@mail.gmail.com>
References: <1358898947.75663.YahooMailNeo@web121903.mail.ne1.yahoo.com>
	<3d60722b16a744a582b8eaf4528ac1bf@EX-0-HT0.lancs.local>
	<CANVKczMBPc1V2Lh9ZJqpy+7F74WmdQJ-ShaTqVe49WfA3F8K_g@mail.gmail.com>
	<CAAcGz9_cqKs8TH9Rg8=Ma_p1HRtP18ipf3LgjLDCXqXW=VM89g@mail.gmail.com>
Message-ID: <CALjAYt4KRu5zUN27+QVcNJhd5Kpt0PpFDHQj0+bc-tz10FQxsg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130124/772c2a13/attachment.pl>

From pingyang.whu at gmail.com  Thu Jan 24 22:31:15 2013
From: pingyang.whu at gmail.com (ping yang)
Date: Thu, 24 Jan 2013 16:31:15 -0500
Subject: [R-sig-Geo] Zonal Statistics as Table
In-Reply-To: <CANtt_hwdS+qoTxFOfkJ8f+datU2HomWt4HZg-7mVHr26SBu2yQ@mail.gmail.com>
References: <1344012077.6904.YahooMailNeo@web190406.mail.sg3.yahoo.com>
	<CANtt_hwdS+qoTxFOfkJ8f+datU2HomWt4HZg-7mVHr26SBu2yQ@mail.gmail.com>
Message-ID: <CAK8gSG-JvdZpQCBPOy1NGoyVP6dPANB2WqW8rF08GNkTzTfrng@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130124/466e9708/attachment.pl>

From ppanday at clarku.edu  Thu Jan 24 22:54:49 2013
From: ppanday at clarku.edu (ppanday)
Date: Thu, 24 Jan 2013 13:54:49 -0800 (PST)
Subject: [R-sig-Geo] Rasterbrick to netCDF
Message-ID: <1359064489341-7582376.post@n2.nabble.com>

Hello

I have an output from R-script in the form of a rasterbrick with 3
dimensions (time, latitude, longitude). I want to be able to write it to a
netCDF format, add another dimension (time, level, latitude, longitude), and
be able to edit dimension attributes.
Below you will see the properties when I write my rasterbrick to a netCDF
format using writeRaster.
I would like to change 'value' dimension to time, and edit time:units as
well.
Alternatively, is there a way I can copy dimensions and attributes from
another netCDF template and put my rasterbrick in that empty netCDF file?
Any help is greatly appreciated.

Sincerely,
Prajjwal


dimensions:
	longitude = 720 ;
	latitude = 360 ;
	value = UNLIMITED ; // (12 currently)
variables:
	double longitude(longitude) ;
		longitude:units = "degrees_east" ;
		longitude:long_name = "longitude" ;
	double latitude(latitude) ;
		latitude:units = "degrees_north" ;
		latitude:long_name = "latitude" ;
	int value(value) ;
		value:units = "unknown" ;
		value:long_name = "value" ;
	float prec(value, latitude, longitude) ;
		prec:_FillValue = -3.4e+38 ;
		prec:missing_value = -3.4e+38 ;
		prec:long_name = "prec" ;
		prec:projection = "+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0"
;
		prec:projection_format = "PROJ.4" ;
		prec:min = 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0. ;
		prec:max = 663.033325195312, 553.867553710938, 595.225219726562,
577.460388183594, 688.026123046875, 1178.05859375, 1098.39819335938,
1269.41442871094, 1184.70092773438, 1013.62524414062, 755.313537597656,
633.667541503906 ;

// global attributes:
		:Conventions = "CF-1.4" ;
		:created_by = "R, packages ncdf and raster (version 2.0-31)" ;
		:date = "2013-01-24 15:58:09" ;







--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Rasterbrick-to-netCDF-tp7582376.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From thi_veloso at yahoo.com.br  Fri Jan 25 03:37:56 2013
From: thi_veloso at yahoo.com.br (Thiago V. dos Santos)
Date: Thu, 24 Jan 2013 18:37:56 -0800 (PST)
Subject: [R-sig-Geo] Rasterbrick to netCDF
In-Reply-To: <1359064489341-7582376.post@n2.nabble.com>
References: <1359064489341-7582376.post@n2.nabble.com>
Message-ID: <1359081476.24921.YahooMailNeo@web121903.mail.ne1.yahoo.com>

Hi Prajjwal,

I think the best approach in your case is to create a new, updated netcd file instead of adding a dimension to an existing file. By using the ncdf4 package to create the file, you have lots of options to customize names and descriptions of?variables and dimensions.

At the end of this message you can see the code that I use to create a netcdf file with global coverage at 0.5 degree resolution based obviously on a netcdf with the same features. The resulting netcdf will contain one level "slice" and 12 time "slices". One detail about netcdf files is that the coordinates of point refers to the center of the point and not to the edge. That's why I start longitude at -179.75 instead of -180 and longitude at 89.75 instead of 90.

If the resulting file looks like longitude and latitude are inverted, you must transpose the data when converting raster to matrix:
data <- t(as.matrix(r))


I hope it helps,

Thiago.

#--------------------------------------------------------begin of code-----------------------------------------------------

# Load required packages
library(raster)
library(ncdf4)

# Load your data
r <- raster('old_file.nc')

# Here's the trick: convert your data to a matrix
data <- as.matrix(r)

# Now that we have the data we need, make output file in the correct format

# Create dimensions lon, lat, level and time
dim_lon ?<- ncdim_def('longitude', 'degrees_east', seq(-179.75,179.75,by=0.5))
dim_lat ?<- ncdim_def('latitude', 'degrees_north', seq(89.75,-89.75,by=-0.5))
dim_lev ?<- ncdim_def('level', 'level/index', 1)
dim_time <- ncdim_def('time', "years since 1990-01-01", 1:12, unlim=T)

# Create a new variable "precipitation", create netcdf file, put updated contents on it and close file
# Note that variable "data" is the actual contents of the original netcdf file
var_out <- ncvar_def('precipitation', 'mm/day', list(dim_lon,dim_lat,dim_lev,dim_time), 9.e20)
ncid_out <- nc_create('updated_netcdf.nc', var_out)
ncvar_put(ncid_out, var_out, data, start=c(1, 1, 1, 1), count=c(720, 360, 1, 12))
nc_close(ncid_out)
#--------------------------------------------------------end of code-----------------------------------------------------


----- Original Message -----
From: ppanday <ppanday at clarku.edu>
To: r-sig-geo at r-project.org
Cc: 
Sent: Thursday, January 24, 2013 3:54 PM
Subject: [R-sig-Geo] Rasterbrick to netCDF

Hello

I have an output from R-script in the form of a rasterbrick with 3
dimensions (time, latitude, longitude). I want to be able to write it to a
netCDF format, add another dimension (time, level, latitude, longitude), and
be able to edit dimension attributes.
Below you will see the properties when I write my rasterbrick to a netCDF
format using writeRaster.
I would like to change 'value' dimension to time, and edit time:units as
well.
Alternatively, is there a way I can copy dimensions and attributes from
another netCDF template and put my rasterbrick in that empty netCDF file?
Any help is greatly appreciated.

Sincerely,
Prajjwal


dimensions:
??? longitude = 720 ;
??? latitude = 360 ;
??? value = UNLIMITED ; // (12 currently)
variables:
??? double longitude(longitude) ;
??? ??? longitude:units = "degrees_east" ;
??? ??? longitude:long_name = "longitude" ;
??? double latitude(latitude) ;
??? ??? latitude:units = "degrees_north" ;
??? ??? latitude:long_name = "latitude" ;
??? int value(value) ;
??? ??? value:units = "unknown" ;
??? ??? value:long_name = "value" ;
??? float prec(value, latitude, longitude) ;
??? ??? prec:_FillValue = -3.4e+38 ;
??? ??? prec:missing_value = -3.4e+38 ;
??? ??? prec:long_name = "prec" ;
??? ??? prec:projection = "+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0"
;
??? ??? prec:projection_format = "PROJ.4" ;
??? ??? prec:min = 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0. ;
??? ??? prec:max = 663.033325195312, 553.867553710938, 595.225219726562,
577.460388183594, 688.026123046875, 1178.05859375, 1098.39819335938,
1269.41442871094, 1184.70092773438, 1013.62524414062, 755.313537597656,
633.667541503906 ;

// global attributes:
??? ??? :Conventions = "CF-1.4" ;
??? ??? :created_by = "R, packages ncdf and raster (version 2.0-31)" ;
??? ??? :date = "2013-01-24 15:58:09" ;







--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Rasterbrick-to-netCDF-tp7582376.html
Sent from the R-sig-geo mailing list archive at Nabble.com.

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From thi_veloso at yahoo.com.br  Fri Jan 25 04:26:12 2013
From: thi_veloso at yahoo.com.br (Thiago V. dos Santos)
Date: Thu, 24 Jan 2013 19:26:12 -0800 (PST)
Subject: [R-sig-Geo] See coordinates vector in raster
In-Reply-To: <CAAcGz9_cqKs8TH9Rg8=Ma_p1HRtP18ipf3LgjLDCXqXW=VM89g@mail.gmail.com>
References: <1358898947.75663.YahooMailNeo@web121903.mail.ne1.yahoo.com>
	<3d60722b16a744a582b8eaf4528ac1bf@EX-0-HT0.lancs.local>
	<CANVKczMBPc1V2Lh9ZJqpy+7F74WmdQJ-ShaTqVe49WfA3F8K_g@mail.gmail.com>
	<CAAcGz9_cqKs8TH9Rg8=Ma_p1HRtP18ipf3LgjLDCXqXW=VM89g@mail.gmail.com>
Message-ID: <1359084372.82683.YahooMailNeo@web121903.mail.ne1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130124/04159fd0/attachment.pl>

From jacp1104 at gmail.com  Fri Jan 25 06:11:05 2013
From: jacp1104 at gmail.com (Antonio Cabrera)
Date: Thu, 24 Jan 2013 22:11:05 -0700
Subject: [R-sig-Geo] exporting local estimates of gwr to csv file
Message-ID: <CA+SrhBaazGO1PuSLqYg+cdRCqTG1URbdQDh3EomFYT23hesx_g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130124/2cddf918/attachment.pl>

From 538280 at gmail.com  Fri Jan 25 06:21:04 2013
From: 538280 at gmail.com (Greg Snow)
Date: Thu, 24 Jan 2013 22:21:04 -0700
Subject: [R-sig-Geo] Finding the Circumscribing Circle of a polygon
In-Reply-To: <CAGfc75=6h4Gb1889fFNE9vRU_UQOq6P16eOe5Tb6iQ4sUvwNXw@mail.gmail.com>
References: <CAGfc75kY5KESgwB-UoQh4EFn0Et9EZUmweyNa3j31VpWZUHnaA@mail.gmail.com>
	<CAGfc75=6h4Gb1889fFNE9vRU_UQOq6P16eOe5Tb6iQ4sUvwNXw@mail.gmail.com>
Message-ID: <CAFEqCdx4_MOocsjmzftMj89WynicLTJH+xXuvGLmU-s4oZoG+w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130124/11f2cda4/attachment.pl>

From Roger.Bivand at nhh.no  Fri Jan 25 08:24:59 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 25 Jan 2013 08:24:59 +0100
Subject: [R-sig-Geo] exporting local estimates of gwr to csv file
In-Reply-To: <CA+SrhBaazGO1PuSLqYg+cdRCqTG1URbdQDh3EomFYT23hesx_g@mail.gmail.com>
References: <CA+SrhBaazGO1PuSLqYg+cdRCqTG1URbdQDh3EomFYT23hesx_g@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1301250808020.12269@reclus.nhh.no>

On Fri, 25 Jan 2013, Antonio Cabrera wrote:

> I ran a gwr model, with 2491 obs. No problems there, and mapping it all
> went smoothly. But I don't see all the local coefficients estimates in the
> summary (it only gives min, max, median, and quartile values), and would
> really like to use the beta coefficients in other programs, such as GeoDa.
> How can I take the estimated local coefficients and export them to a csv
> file?

Please DO read the function help page, and DO follow list rules, provide a 
small working example from the built-in data sets showing which package(s) 
you used, report the output of sessionInfo(), and NEVER post HTML.

library(spgwr)
# spgwr_0.6-18
data(columbus)
col.bw <- gwr.sel(crime ~ income + housing, data=columbus,
  coords=cbind(columbus$x, columbus$y))
col.gauss <- gwr(crime ~ income + housing, data=columbus,
   coords=cbind(columbus$x, columbus$y), bandwidth=col.bw, hatmatrix=TRUE)

So you have an object "col.gauss" - what is inside it? Typing its name 
shows it using its print method, use str() to see inside:

str(col.gauss)

It contains, as ?gwr documents:

A list of class ?gwr?:

SDF: a SpatialPointsDataFrame (may be gridded) or
           SpatialPolygonsDataFrame object (see package "sp") with
           fit.points, weights, GWR coefficient estimates, R-squared,
           and coefficient standard errors in its "data" slot.

lhat: Leung et al. L matrix

lm: Ordinary least squares global regression on the same model
           formula, as returned by lm.wfit().

bandwidth: the bandwidth used.

this.call: the function call used.

and a couple of other things returned when the lhat is returned. Read what 
the SDF component is, you can export it to shapefile with writeOGR() in 
rgdal or writeSpatialShape() in maptools. So:

writeSpatialShape(col.gauss$SDF, "my_GWR_results")

can be read into programs using shapefiles.

Please note that GWR is an unproven method, should never be used in work 
with policy consequences, and is ever only a diagnostic aid for finding 
model misspecification. Your aim is always to find and resolve the 
misspecification, then fit a global model (with the possible exception of 
Bayesian varying-coefficient approaches).

Hope this clarifies,

Roger

>
> Thanks in advance!
>
>
> - Tito
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From hengl at spatial-analyst.net  Fri Jan 25 11:09:54 2013
From: hengl at spatial-analyst.net (Tomislav Hengl)
Date: Fri, 25 Jan 2013 11:09:54 +0100
Subject: [R-sig-Geo] MEMO: deadline to apply for the GEOSTAT Quebec City /
 ISRIC's Spring School 2013
Message-ID: <510259F2.408@spatial-analyst.net>


GEOSTAT 2013 Quebec City
------------------------------------------------------
The GEOSTAT Quebec city 2013 summer school is 8th in a series of summer 
schools organized by R and OS GIS developers and enthusiasts. GEOSTAT 
aims at PhD students and R-sig-geo enthusiasts in a range of 
environmental and GIS sciences, with a special focus on analyzing 
spatio-temporal gridded data in R and connected OS GIS software. The 
participants will learn how to import and organize space-time data i.e. 
time series of rasters and how to program statistical and geographical 
analysis using a combination of R and OS GIS functionality. The school 
will be hosted at the Faculty of Forestry, Geomatics and Geography, on 
the campus of Laval University, a few kilometers from the heart of 
Quebec City, Canada.
Lecturers: J. (John) E. Lewis; E.(Edzer) Pebesma; A. (Alex) Brenning; T. 
(Tom) Hengl

The deadline to apply for this Summer School is: 1st of February 2013
For more info see: http://geostat-course.org/Quebec_2013


ISRIC's SPRING SCHOOL ON DIGITAL SOIL MAPPING (HANDS-ON GSIF)
------------------------------------------------------
Hands-on Global Soil Information Facilities (methods and tools for 3D 
soil analysis and mapping) is a one week block course on using R and 
other open source tools for digital soil mapping and analysis. Who is it 
for: Digital soil mappers, soil data producers and soil mappers at PhD 
and post-doctoral level.
Lecturers: G.B.M (Gerard) Heuvelink, T. (Tom) Hengl, H. (Hannes) Reuter, 
B. (Bas) Kempen

Registration deadline: 15th of February 2013
For more info see: 
http://www.isric.org/training/hands-global-soil-information-facilities


From mathieu.rajerison at gmail.com  Fri Jan 25 11:22:33 2013
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Fri, 25 Jan 2013 11:22:33 +0100
Subject: [R-sig-Geo] Finding the Circumscribing Circle of a polygon
In-Reply-To: <CAFEqCdx4_MOocsjmzftMj89WynicLTJH+xXuvGLmU-s4oZoG+w@mail.gmail.com>
References: <CAGfc75kY5KESgwB-UoQh4EFn0Et9EZUmweyNa3j31VpWZUHnaA@mail.gmail.com>
	<CAGfc75=6h4Gb1889fFNE9vRU_UQOq6P16eOe5Tb6iQ4sUvwNXw@mail.gmail.com>
	<CAFEqCdx4_MOocsjmzftMj89WynicLTJH+xXuvGLmU-s4oZoG+w@mail.gmail.com>
Message-ID: <CAGfc75kyZX1o1zGjdbJurALHZu0tJjXOJn35HS_=bOxmZ3kx8w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130125/e5a135a0/attachment.pl>

From 538280 at gmail.com  Fri Jan 25 16:25:23 2013
From: 538280 at gmail.com (Greg Snow)
Date: Fri, 25 Jan 2013 08:25:23 -0700
Subject: [R-sig-Geo] Finding the Circumscribing Circle of a polygon
In-Reply-To: <CAGfc75kyZX1o1zGjdbJurALHZu0tJjXOJn35HS_=bOxmZ3kx8w@mail.gmail.com>
References: <CAGfc75kY5KESgwB-UoQh4EFn0Et9EZUmweyNa3j31VpWZUHnaA@mail.gmail.com>
	<CAGfc75=6h4Gb1889fFNE9vRU_UQOq6P16eOe5Tb6iQ4sUvwNXw@mail.gmail.com>
	<CAFEqCdx4_MOocsjmzftMj89WynicLTJH+xXuvGLmU-s4oZoG+w@mail.gmail.com>
	<CAGfc75kyZX1o1zGjdbJurALHZu0tJjXOJn35HS_=bOxmZ3kx8w@mail.gmail.com>
Message-ID: <CAFEqCdxfFAxhr3xF3+maoXVnDTBWvQsY9ApSsu0PPWX0nc_4+Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130125/943965ca/attachment.pl>

From lestes at princeton.edu  Fri Jan 25 18:15:12 2013
From: lestes at princeton.edu (Lyndon Estes)
Date: Fri, 25 Jan 2013 12:15:12 -0500
Subject: [R-sig-Geo] Cleaning up self-intersections
In-Reply-To: <CALuVVaZxM_35B7N_NJaQHEFC7awnt5LU0ti8O6gFtq_P04ncJA@mail.gmail.com>
References: <79c927d12d74474ab8de3233faf9b9fc@EX-1-HT0.lancs.local>
	<3a151ec42ec6465a9a0d091120a1034d@CSGHUB209W.pu.win.princeton.edu>
	<CALuVVaZxM_35B7N_NJaQHEFC7awnt5LU0ti8O6gFtq_P04ncJA@mail.gmail.com>
Message-ID: <CALuVVaYrtBJgnHEupeX7pca-ujQsszJdc9bTnGnfzHR1dt2uPQ@mail.gmail.com>

Hi,

I am back with the polygon cleaning issue after having looked into it
some more.  We are working on getting pprepair up and running, but I
have failed thus far to get it running and tested because it has a
large number of dependencies that don't seem to all agree with my
Macbook (Lion), so we are putting it on our linux server and will try
it there.

In the meantime, I have come up with a Grass-based solution.  I also
found that postgis's st_MakeValid seems to clean up things alright and
lead to valid polygons upon importing from my postgis database, but
there are problems that persist in downstream operations, which I
suppose has to do with noding, but I am not sure.  I am interested in
cleaning up polygon self-intersections, but I also need to get rid of
polygon overlaps so that I can do map comparisons, which entails a
number of intersects and differences between separate SpatialPolygons
objects.

Here is the solution I have come up with that seems to work. The code
seems to work for the situations I have found so far, so my main
question is: can I do the cleaning and overlap removal more
efficiently than this (assuming I can't get pprepair working)?

Immediately below the first example is a modified version of the first
that illustrate the type of lingering problem that can result even
with valid polygons, passed out of postgis with st_MakeValid applied
first (code for that not illustrated here because I don't have a way
of giving ready access to a postgis database).

##############################################################################################

library(rgdal)
library(rgeos)
library(spgrass6)

load(url("http://dl.dropbox.com/u/31890709/test_polys.Rdata"))
# u and q are the objects of interest
# u is invalid on two of its polygons, q is all valid, both have
overlaps in their polygons
# Since the code is lengthy, to avoid repetition, reassign a new name
to the object to test
pol <- q
gIsValid(pol, byid = T)  # Two invalid polygons
gOverlaps(pol, byid = T)  # Plenty of overlaps

# Step 1, GRASS cleaning
SG <- Sobj_SpatialGrid(pol)$SG
loc <- initGRASS("/Applications/GRASS-6.4.app/Contents/MacOS/",
home=tempdir(), SG, override = TRUE)
tf <- tempfile()
mapset <- execGRASS("g.gisenv", parameters=list(get="MAPSET"), intern=TRUE)
execGRASS("g.gisenv", parameters=list(set=shQuote('MAPSET=PERMANENT')))
prj <- showWKT(proj4string(pol), tf)
execGRASS("g.proj", flags="c", parameters=list(wkt=tf))
execGRASS("g.proj", flags="p")
execGRASS("g.gisenv", parameters=list(set=paste("'MAPSET=", mapset,
"'", sep="")))
execGRASS("g.region", flags="d")
writeVECT6(pol, "pol")
o <- readVECT6("pol", with_c=FALSE, remove.duplicates = F)
polylist <- lapply(1:length(unique(o at data$cat)), function(x)
gUnaryUnion(o[o at data$cat == x, ]))
newu <- SpatialPolygons(lapply(1:length(unique(o at data$cat)), function(x) {
 Polygons(polylist[[x]]@polygons[[1]]@Polygons, x)
}))  # Union each polygons and its little overlapping bits to make valid polygon
gIsValid(newu, byid = T)  # All valid


# Step 2, remove overlaps between polygons
outpoly <- newu
newpoly2 <- lapply(1:length(outpoly), function(j) outpoly[j, ])
itab <- gOverlaps(outpoly, byid = T)
itab[which(itab)] <- 1
itab1 <- rowSums(itab)
i <- which(itab1 > 0)[1]

while(i <= length(outpoly)) {
  print(unname(i))
  newpoly2[[i]] <- gDifference(spgeom1 = outpoly[i, ], spgeom2 =
gUnaryUnion(outpoly[-i, ]), byid = T)
  outpoly <- SpatialPolygons(lapply(1:length(newpoly2), function(x) {
    Polygons(newpoly2[[x]]@polygons[[1]]@Polygons, x)
  }))
  itab <- gOverlaps(outpoly, byid = T)
  itab[which(itab)] <- 1
  itab1 <- rowSums(itab)
  ct <- which(itab1 > 0)[1]
  i <- ifelse(is.na(ct), length(outpoly) + 1, ct)
}
gOverlaps(outpoly, byid = T)  # No overlaps
rm(list = ls())

###############################################################################################

Now, here is how a valid polygons will fail.  q is a valid polygon
before going through the Grass clean up process. However, if you skip
Step 1, and jump straight to Step 2, you will get caught in an endless
loop (modifed code below salutation).  Any thoughts as to why this is?

Any recommendations for how to improve this very clunky process will
be highly appreciated.

Thanks, Lyndon

load(url("http://dl.dropbox.com/u/31890709/test_polys.Rdata"))
# u and q are the objects of interest
# u is invalid on two of its polygons, q is all valid, both have
overlaps in their polygons
# Since the code is lengthy, to avoid repetition, reassign a new name
to the object to test
pol <- q
gIsValid(pol, byid = T)  # Two invalid polygons
gOverlaps(pol, byid = T)  # Plenty of overlaps

# Step 1 removed

# Step 2, remove overlaps between polygons
outpoly <- pol
newpoly2 <- lapply(1:length(outpoly), function(j) outpoly[j, ])
itab <- gOverlaps(outpoly, byid = T)
itab[which(itab)] <- 1
itab1 <- rowSums(itab)
i <- which(itab1 > 0)[1]

while(i <= length(outpoly)) {
 print(unname(i))
 newpoly2[[i]] <- gDifference(spgeom1 = outpoly[i, ], spgeom2 =
gUnaryUnion(outpoly[-i, ]), byid = T)
 outpoly <- SpatialPolygons(lapply(1:length(newpoly2), function(x) {
  Polygons(newpoly2[[x]]@polygons[[1]]@Polygons, x)
 }))
 itab <- gOverlaps(outpoly, byid = T)
 itab[which(itab)] <- 1
 itab1 <- rowSums(itab)
 ct <- which(itab1 > 0)[1]
 i <- ifelse(is.na(ct), length(outpoly) + 1, ct)
}
gOverlaps(outpoly, byid = T)  # No overlaps
rm(list = ls())


From kji2080 at gmail.com  Sat Jan 26 02:14:16 2013
From: kji2080 at gmail.com (Jooil Kim)
Date: Fri, 25 Jan 2013 17:14:16 -0800
Subject: [R-sig-Geo] Problems using lattice in a function?
Message-ID: <229BF6A2-E5E8-43EB-98EC-424B1BF1F937@gmail.com>

Hello list,

I've created a function incorporating lattice, and I'm getting weird results that I can't explain?

Here's the results I would like to have, without encapsulating it into a function (this works without problems):

A <- data.frame(x = rnorm(100), y = rnorm(100)) 
  xyplot(y ~ x, data = A) 
  trellis.focus("toplevel") ## has coordinate system [0,1] x [0,1] 
  panel.text(c(0.5, 0.6, 0.7), c(0.4, 0.2, 0.3), c("A", "B", "C"), cex = 1.2, font = 2) 
  trellis.unfocus()


I thought I could make up a function as such to do the same thing:

test <- function(xi, yi, li){
	A <- data.frame(x = rnorm(100), y = rnorm(100)) 
	  p <- xyplot(y ~ x, data = A)
	  trellis.focus("toplevel") ## has coordinate system [0,1] x [0,1] 
	  p <- p + layer(panel.text(xi, yi, li, cex = 1.2, font = 2))
	  trellis.unfocus()
	  
	  return(p)
}

test(c(0.5, 0.6, 0.7), c(0.4, 0.2, 0.3), c("A", "B", "C"))


With my function, I get an error for the panel.text part, with the message "Error using packet 1    object 'xi' not found".

Any help on this would be greatly appreciated!


Best regards,

Jooil


----------------------------------------------------
Jooil Kim
Postdoc Fellow
Scripps Institution of Oceanography, UC San Diego
Mailing address:
9500 Gilman Drive # 0244
La Jolla, CA 92093-0244, USA
For FedEx/UPS:
8675 Discovery Way, Vaughan Hall Rm. 447
La Jolla, CA 92037, USA

Tel. +1-858-534-2599
Fax. +1-858-455-8306


From oscar.perpinan at gmail.com  Sat Jan 26 08:57:52 2013
From: oscar.perpinan at gmail.com (=?ISO-8859-1?Q?Oscar_Perpi=F1an?=)
Date: Sat, 26 Jan 2013 08:57:52 +0100
Subject: [R-sig-Geo] Problems using lattice in a function?
In-Reply-To: <229BF6A2-E5E8-43EB-98EC-424B1BF1F937@gmail.com>
References: <229BF6A2-E5E8-43EB-98EC-424B1BF1F937@gmail.com>
Message-ID: <CAMLL7bnNPxK=UUWfdKcUnyDBA8oRoQowJ=KRri5g-tL6pXz7PQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130126/90fe5a6f/attachment.pl>

From berryboessenkool at hotmail.com  Sat Jan 26 11:57:56 2013
From: berryboessenkool at hotmail.com (Berry Boessenkool)
Date: Sat, 26 Jan 2013 02:57:56 -0800 (PST)
Subject: [R-sig-Geo] Finding the Circumscribing Circle of a polygon
In-Reply-To: <CAFEqCdx4_MOocsjmzftMj89WynicLTJH+xXuvGLmU-s4oZoG+w@mail.gmail.com>
References: <CAGfc75kY5KESgwB-UoQh4EFn0Et9EZUmweyNa3j31VpWZUHnaA@mail.gmail.com>
	<CAGfc75=6h4Gb1889fFNE9vRU_UQOq6P16eOe5Tb6iQ4sUvwNXw@mail.gmail.com>
	<CAFEqCdx4_MOocsjmzftMj89WynicLTJH+xXuvGLmU-s4oZoG+w@mail.gmail.com>
Message-ID: <1359197876221-7582388.post@n2.nabble.com>


Hi Greg,

why did you add in particular
+ 10*sum(dists<0) 
in the function to be minimized?

If I understand this correctly, this is the "punishment" of points outside
the current circle.
But if the points are very far apart (distances are large), then wouldn't
optim focus more on that part of the sum, instead of the number of points
outside as above?
Shouldn't the factor 10 be relative to the distance units?
Or is there a way to have optim only look at circles enclosing all vertices
of the convex hull?

I was thinking there must be an analytical solution, but apparently not:
http://en.wikipedia.org/wiki/Smallest_circle_problem

Berry




--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Finding-the-Circumscribing-Circle-of-a-polygon-tp7582372p7582388.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From vladimir.gut at gmail.com  Sat Jan 26 12:42:53 2013
From: vladimir.gut at gmail.com (Vladimir Gutierrez Corea)
Date: Sat, 26 Jan 2013 12:42:53 +0100
Subject: [R-sig-Geo] Problems using lattice in a function?
Message-ID: <CALiSPOrkhiOWy1VNXbDLH2C9Xt83txY1sD+A-Y6ZzwGjCPYX=g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130126/d48fc467/attachment.pl>

From 538280 at gmail.com  Sat Jan 26 16:18:13 2013
From: 538280 at gmail.com (Greg Snow)
Date: Sat, 26 Jan 2013 08:18:13 -0700
Subject: [R-sig-Geo] Finding the Circumscribing Circle of a polygon
In-Reply-To: <1359197876221-7582388.post@n2.nabble.com>
References: <CAGfc75kY5KESgwB-UoQh4EFn0Et9EZUmweyNa3j31VpWZUHnaA@mail.gmail.com>
	<CAGfc75=6h4Gb1889fFNE9vRU_UQOq6P16eOe5Tb6iQ4sUvwNXw@mail.gmail.com>
	<CAFEqCdx4_MOocsjmzftMj89WynicLTJH+xXuvGLmU-s4oZoG+w@mail.gmail.com>
	<1359197876221-7582388.post@n2.nabble.com>
Message-ID: <CAFEqCdwf43nTFjwSpToP6eTJPutGuRsZGCLRA0B4DjcCm85grg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130126/4d965eed/attachment.pl>

From kji2080 at gmail.com  Sun Jan 27 08:45:58 2013
From: kji2080 at gmail.com (Jooil Kim)
Date: Sat, 26 Jan 2013 23:45:58 -0800
Subject: [R-sig-Geo] Problems using lattice in a function?
In-Reply-To: <CAMLL7bnNPxK=UUWfdKcUnyDBA8oRoQowJ=KRri5g-tL6pXz7PQ@mail.gmail.com>
References: <229BF6A2-E5E8-43EB-98EC-424B1BF1F937@gmail.com>
	<CAMLL7bnNPxK=UUWfdKcUnyDBA8oRoQowJ=KRri5g-tL6pXz7PQ@mail.gmail.com>
Message-ID: <0BFC3D5C-A495-43C2-BEBE-6FB5DE4FCC6A@gmail.com>

Hello Oscar,

Thank you very much for the prompt reply, problem certainly solved, and I can sleep in peace! : )

And I apologize for posting to the wrong forum (I also realized I forgot to post the details of my R setup!). The graphs I will eventually create are based on spatial data, and I had blindly thought I should ask here.

Thanks again!

Cheers,

Jooil

----------------------------------------------------
Jooil Kim
Postdoc Fellow
Scripps Institution of Oceanography, UC San Diego
Mailing address:
9500 Gilman Drive # 0244
La Jolla, CA 92093-0244, USA
For FedEx/UPS:
8675 Discovery Way, Vaughan Hall Rm. 447
La Jolla, CA 92037, USA

Tel. +1-858-534-2599
Fax. +1-858-455-8306

On Jan 25, 2013, at 11:57 PM, Oscar Perpi?an <oscar.perpinan at gmail.com> wrote:

> layer(panel.text(xi, yi, li), data=list(xi=xi, yi=yi, li=li))


From iruckaE at mail2world.com  Sun Jan 27 11:47:15 2013
From: iruckaE at mail2world.com (Irucka Embry)
Date: Sun, 27 Jan 2013 02:47:15 -0800
Subject: [R-sig-Geo] lapply and SpatialGridDataFrame
Message-ID: <C23BA77241E54084BE7DC1EF4F7D629F@mail2world.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130127/f33c725b/attachment.pl>

From orietta.nicolis at uv.cl  Sun Jan 27 22:09:56 2013
From: orietta.nicolis at uv.cl (Orietta Nicolis)
Date: Sun, 27 Jan 2013 22:09:56 +0100
Subject: [R-sig-Geo] make_EPSG chile
Message-ID: <CACS7Kc8u5+=X+EdMn7EPYDAPDqv1W7ZVooJ2uSLHpabPG8x2Uw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130127/670e8cc7/attachment.pl>

From julian at hafro.is  Sun Jan 27 22:37:50 2013
From: julian at hafro.is (Julian Burgos)
Date: Sun, 27 Jan 2013 21:37:50 -0000 (GMT)
Subject: [R-sig-Geo] make_EPSG chile
In-Reply-To: <CACS7Kc8u5+=X+EdMn7EPYDAPDqv1W7ZVooJ2uSLHpabPG8x2Uw@mail.gmail.com>
References: <CACS7Kc8u5+=X+EdMn7EPYDAPDqv1W7ZVooJ2uSLHpabPG8x2Uw@mail.gmail.com>
Message-ID: <51725.46.239.234.92.1359322670.squirrel@www.hafro.is>

Hi Orietta,
As the error message is telling you, R cannot find a file named "Chile" in
your default folder.  Just replace "Chile" with a full path to the file.
All the best,

Julian

Julian Mariano Burgos, PhD
Hafranns?knastofnunin/Marine Research Institute
Sk?lagata 4, 121 Reykjav?k, Iceland
S?mi/Telephone : +354-5752037
Br?fs?mi/Telefax:  +354-5752001
Netfang/Email: julian at hafro.is


> Dear R users,
>
>
> I'm trying to run the following example with data of Chile, but I didn't
> find a EPSG code for this country which could be used in R.
>
> data <http://inside-r.org/r-doc/utils/data>(meuse)
> coordinates(meuse)<-~x+y proj4string(meuse) <- CRS('+init=epsg:28992')
> # Line data
> data <http://inside-r.org/r-doc/utils/data>(meuse.grid)
> coordinates(meuse.grid)<-c <http://inside-r.org/r-doc/base/c>('x','y')
> meuse.grid<-as <http://inside-r.org/r-doc/methods/as>(meuse.grid,
> 'SpatialPixelsDataFrame')
> im<-as.image.SpatialGridDataFrame(meuse.grid['dist'])
> cl<-ContourLines2SLDF(contourLines<http://inside-r.org/r-doc/grDevices/contourLines>
> (im))
> proj4string(cl) <- CRS('+init=epsg:28992')
>
>
> I run the script:
>
> make_EPSG("Chile")
>
> but it gives the following error:
>
> In file(file, open = "r") :
>   cannot open file 'Chile': No such file or directory
> Please, can anyone suggest me how to solve this problem?
> Thank you very much,
> Orietta
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From mauricio.zambrano at jrc.ec.europa.eu  Mon Jan 28 11:29:58 2013
From: mauricio.zambrano at jrc.ec.europa.eu (Mauricio Zambrano-Bigiarini)
Date: Mon, 28 Jan 2013 11:29:58 +0100
Subject: [R-sig-Geo] make_EPSG chile
In-Reply-To: <CACS7Kc8u5+=X+EdMn7EPYDAPDqv1W7ZVooJ2uSLHpabPG8x2Uw@mail.gmail.com>
References: <CACS7Kc8u5+=X+EdMn7EPYDAPDqv1W7ZVooJ2uSLHpabPG8x2Uw@mail.gmail.com>
Message-ID: <51065326.9090405@jrc.ec.europa.eu>

On 27/01/13 22:09, Orietta Nicolis wrote:
> Dear R users,
>
>
> I'm trying to run the following example with data of Chile, but I didn't
> find a EPSG code for this country which could be used in R.
>
Hi Orietta,

AFAIK, in Chile there are two main local projections:

PSAD56 / UTM zone 18S, and
PSAD56 / UTM zone 19S

which are used depending on the latitude you are working on.

For PSAD56_Z19S, you may try:

library(sp)
psad56.p4s <- CRS("+proj=utm +zone=19 +south +ellps=intl +units=m +no_defs")

which is equivalent to use EPSG:24879

if you need higher precision, you may need to add the '+towgs84' 
argument to 'psad56.p4s'

Saludos,

Mauricio

PS,
I'm happy to know there are people in Chile using R !

-- 
=================================================
Water Resources Unit
Institute for Environment and Sustainability (IES)
Joint Research Centre (JRC), European Commission
TP 261, Via Enrico Fermi 2749, 21027 Ispra (VA), IT
webinfo    : http://floods.jrc.ec.europa.eu/
=================================================
DISCLAIMER:
"The views expressed are purely those of the writer
and may not in any circumstances be regarded as sta-
ting an official position of the European Commission"
=================================================
Linux user #454569 -- Ubuntu user #17469
=================================================
"True courage is a result of reasoning.
A brave mind is always impregnable"
(Jeremy Collier)

> data<http://inside-r.org/r-doc/utils/data>(meuse)
> coordinates(meuse)<-~x+y proj4string(meuse)<- CRS('+init=epsg:28992')
> # Line data
> data<http://inside-r.org/r-doc/utils/data>(meuse.grid)
> coordinates(meuse.grid)<-c<http://inside-r.org/r-doc/base/c>('x','y')
> meuse.grid<-as<http://inside-r.org/r-doc/methods/as>(meuse.grid,
> 'SpatialPixelsDataFrame')
> im<-as.image.SpatialGridDataFrame(meuse.grid['dist'])
> cl<-ContourLines2SLDF(contourLines<http://inside-r.org/r-doc/grDevices/contourLines>
> (im))
> proj4string(cl)<- CRS('+init=epsg:28992')
>
>
> I run the script:
>
> make_EPSG("Chile")
>
> but it gives the following error:
>
> In file(file, open = "r") :
>    cannot open file 'Chile': No such file or directory
> Please, can anyone suggest me how to solve this problem?
> Thank you very much,
> Orietta
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From Roger.Bivand at nhh.no  Mon Jan 28 11:48:19 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 28 Jan 2013 11:48:19 +0100
Subject: [R-sig-Geo] make_EPSG chile
In-Reply-To: <51065326.9090405@jrc.ec.europa.eu>
References: <CACS7Kc8u5+=X+EdMn7EPYDAPDqv1W7ZVooJ2uSLHpabPG8x2Uw@mail.gmail.com>
	<51065326.9090405@jrc.ec.europa.eu>
Message-ID: <alpine.LRH.2.03.1301281140520.7758@reclus.nhh.no>

On Mon, 28 Jan 2013, Mauricio Zambrano-Bigiarini wrote:

> On 27/01/13 22:09, Orietta Nicolis wrote:
>> Dear R users,
>> 
>> 
>> I'm trying to run the following example with data of Chile, but I didn't
>> find a EPSG code for this country which could be used in R.
>> 
> Hi Orietta,
>
> AFAIK, in Chile there are two main local projections:
>
> PSAD56 / UTM zone 18S, and
> PSAD56 / UTM zone 19S

But:

> EPSG <- make_EPSG()
> EPSG[grep("Chile", EPSG$note), 1:2]
      code                          note
450  5360                # SIRGAS-Chile
2697 5361 # SIRGAS-Chile / UTM zone 19S
2698 5362 # SIRGAS-Chile / UTM zone 18S

all of which are WGS84 - do we know whether the +ellps in Orietta's data 
is GRS80 or your earlier intl?

With PROJ.4 4.8.0, we get a later EPSG too, with:

> CRS("+init=epsg:24879")
CRS arguments:
  +init=epsg:24879 +proj=utm +zone=19 +south +ellps=intl
+towgs84=-288,175,-376,0,0,0,0 +units=m +no_defs

which can be transformed to WGS84.

Roger

>
> which are used depending on the latitude you are working on.
>
> For PSAD56_Z19S, you may try:
>
> library(sp)
> psad56.p4s <- CRS("+proj=utm +zone=19 +south +ellps=intl +units=m +no_defs")
>
> which is equivalent to use EPSG:24879
>
> if you need higher precision, you may need to add the '+towgs84' argument to 
> 'psad56.p4s'
>
> Saludos,
>
> Mauricio
>
> PS,
> I'm happy to know there are people in Chile using R !
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From mathieu.rajerison at gmail.com  Mon Jan 28 12:01:54 2013
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Mon, 28 Jan 2013 12:01:54 +0100
Subject: [R-sig-Geo] Finding the Circumscribing Circle of a polygon
In-Reply-To: <CAFEqCdwf43nTFjwSpToP6eTJPutGuRsZGCLRA0B4DjcCm85grg@mail.gmail.com>
References: <CAGfc75kY5KESgwB-UoQh4EFn0Et9EZUmweyNa3j31VpWZUHnaA@mail.gmail.com>
	<CAGfc75=6h4Gb1889fFNE9vRU_UQOq6P16eOe5Tb6iQ4sUvwNXw@mail.gmail.com>
	<CAFEqCdx4_MOocsjmzftMj89WynicLTJH+xXuvGLmU-s4oZoG+w@mail.gmail.com>
	<1359197876221-7582388.post@n2.nabble.com>
	<CAFEqCdwf43nTFjwSpToP6eTJPutGuRsZGCLRA0B4DjcCm85grg@mail.gmail.com>
Message-ID: <CAGfc75n-DG_Rwphr=0YZ8NWr=5YA=m5qbMNh06VUoENP=rW-DQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130128/9baf1e5f/attachment.pl>

From mauricio.zambrano at jrc.ec.europa.eu  Mon Jan 28 12:14:39 2013
From: mauricio.zambrano at jrc.ec.europa.eu (Mauricio Zambrano-Bigiarini)
Date: Mon, 28 Jan 2013 12:14:39 +0100
Subject: [R-sig-Geo] make_EPSG chile
In-Reply-To: <alpine.LRH.2.03.1301281140520.7758@reclus.nhh.no>
References: <CACS7Kc8u5+=X+EdMn7EPYDAPDqv1W7ZVooJ2uSLHpabPG8x2Uw@mail.gmail.com>
	<51065326.9090405@jrc.ec.europa.eu>
	<alpine.LRH.2.03.1301281140520.7758@reclus.nhh.no>
Message-ID: <51065D9F.8090702@jrc.ec.europa.eu>

On 28/01/13 11:48, Roger Bivand wrote:
> On Mon, 28 Jan 2013, Mauricio Zambrano-Bigiarini wrote:
>
>> On 27/01/13 22:09, Orietta Nicolis wrote:
>>> Dear R users,
>>>
>>>
>>> I'm trying to run the following example with data of Chile, but I didn't
>>> find a EPSG code for this country which could be used in R.
>>>
>> Hi Orietta,
>>
>> AFAIK, in Chile there are two main local projections:
>>
>> PSAD56 / UTM zone 18S, and
>> PSAD56 / UTM zone 19S
>
> But:
>
>> EPSG <- make_EPSG()
>> EPSG[grep("Chile", EPSG$note), 1:2]
> code note
> 450 5360 # SIRGAS-Chile
> 2697 5361 # SIRGAS-Chile / UTM zone 19S
> 2698 5362 # SIRGAS-Chile / UTM zone 18S

I do not get those values:

library(rgdal)
Loading required package: sp
rgdal: version: 0.8-4, (SVN revision 431)
Geospatial Data Abstraction Library extensions to R successfully loaded
Loaded GDAL runtime: GDAL 1.8.1, released 2011/07/09
Path to GDAL shared files: /usr/share/gdal
GDAL does not use iconv for recoding strings.
Loaded PROJ.4 runtime: Rel. 4.7.1, 23 September 2009, [PJ_VERSION: 470]
Path to PROJ.4 shared files: (autodetected)

EPSG <- make_EPSG()
EPSG[grep("Chile", EPSG$note), 1:2]
[1] code note
<0 rows> (or 0-length row.names)

which is very likely due to the fact I'm using PROJ4 4.7.1 :(

>
> all of which are WGS84 - do we know whether the +ellps in Orietta's data
> is GRS80 or your earlier intl?

She didn't mention it.
I was working in Chile up to 2006, and at that time most of the 
cartography I saw from public institutions (related to water) used intl 
as ellipsoid. However, last December I realized the cartography (related 
to water) used WGS84.

>
> With PROJ.4 4.8.0, we get a later EPSG too, with:
>
>> CRS("+init=epsg:24879")
> CRS arguments:
> +init=epsg:24879 +proj=utm +zone=19 +south +ellps=intl
> +towgs84=-288,175,-376,0,0,0,0 +units=m +no_defs

Thank you very much for this info. I'll try to update my PROJ4.
>
> which can be transformed to WGS84.

I recently used that projection. Then, when I transformed some  features 
to WGS84 for visualizing in Google Earth, all of them were in close 
agreement with GE.

Mauricio
>
> Roger
>
>>
>> which are used depending on the latitude you are working on.
>>
>> For PSAD56_Z19S, you may try:
>>
>> library(sp)
>> psad56.p4s <- CRS("+proj=utm +zone=19 +south +ellps=intl +units=m
>> +no_defs")
>>
>> which is equivalent to use EPSG:24879
>>
>> if you need higher precision, you may need to add the '+towgs84'
>> argument to 'psad56.p4s'
>>
>> Saludos,
>>
>> Mauricio
>>
>> PS,
>> I'm happy to know there are people in Chile using R !
>>
>>
>


From macqueen1 at llnl.gov  Mon Jan 28 19:34:56 2013
From: macqueen1 at llnl.gov (MacQueen, Don)
Date: Mon, 28 Jan 2013 18:34:56 +0000
Subject: [R-sig-Geo] lapply and SpatialGridDataFrame
In-Reply-To: <C23BA77241E54084BE7DC1EF4F7D629F@mail2world.com>
Message-ID: <5E1B812FAC2C4A49B3D99593B5A521912413CE@PRDEXMBX-08.the-lab.llnl.gov>

I suspect you're not passing arguments correctly to lapply()

I'd try
 maxdepth.plys <- lapply(modeldepthsmore, Grid2Polygons, level=FALSE)

-Don



-- 
Don MacQueen

Lawrence Livermore National Laboratory
7000 East Ave., L-627
Livermore, CA 94550
925-423-1062





On 1/27/13 2:47 AM, "Irucka Embry" <iruckaE at mail2world.com> wrote:

>Hi all, I have a set of 54 files that I need to convert from ASCII grid
>format to .shp files to .bnd files for BayesX.
>
>I have the following R code to operate on those files:
>
>library(maptools)
>library(Grid2Polygons)
>
>readfunct <- function(x)
>{
>u <- readAsciiGrid(x)
>}
>
>modfilesmore <- paste0("MaxFloodDepth_", 1:54, ".txt")
>modeldepthsmore <- lapply(modfilesmore, readfunct)
>
>maxdepth.plys <- lapply(modeldepthsmore, Grid2Polygons(modeldepthsmore,
>level = FALSE)) 
>
>layers <- paste0("examples/floodlayers_", 1:54)
>writePolyShape(maxdepth.plys, layers)
>shpName <- sub(pattern="(.*)\\.dbf", replacement="\\1",
>x=system.file("examples/Flood/layer_.dbf", package="BayesX"))
>floodmaps <- shp2bnd(shpname=shpName, regionnames="SP_ID")
>
>## draw the map
>drawmap(map=floodmaps)
>
>
>This is the error message that I receive:
>> maxdepth.plys <- lapply(modeldepthsmore,
>Grid2Polygons(modeldepthsmore, level = FALSE))
>Error in Grid2Polygons(modeldepthsmore, level = FALSE) :
>Grid object not of class SpatialGridDataFrame
>
>
>Can someone assist me in modifying the R code so that I can convert the
>set of files to .shp files?
>
>Thank-you.
>
>Irucka Embry 
>
>
><span id=m2wTl><p><font face="Arial, Helvetica, sans-serif" size="2"
>style="font-size:13.5px">_________________________________________________
>______________<BR>Get the Free email that has everyone talking at <a
>href=http://www.mail2world.com
>target=new>http://www.mail2world.com</a><br>  <font
>color=#999999>Unlimited Email Storage &#150; POP3 &#150; Calendar &#150;
>SMS &#150; Translator &#150; Much More!</font></font></span>
>	[[alternative HTML version deleted]]
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From edzer.pebesma at uni-muenster.de  Mon Jan 28 20:45:32 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 28 Jan 2013 20:45:32 +0100
Subject: [R-sig-Geo] SpatioTemporal CRAN task view
Message-ID: <5106D55C.6040507@uni-muenster.de>

List,

CRAN now has a task view for handling and analyzing spatio-temporal
data; visit:

http://cran.r-project.org/web/views/SpatioTemporal.html

If some package is mentioned here in the wrong way, or in the wrong
context, or if you know of packages or subjects that could be added, any
ideas for improvement, please let me know.

With best regards,
-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From pingyang.whu at gmail.com  Mon Jan 28 22:44:59 2013
From: pingyang.whu at gmail.com (ping yang)
Date: Mon, 28 Jan 2013 16:44:59 -0500
Subject: [R-sig-Geo] SpatioTemporal CRAN task view
In-Reply-To: <5106D55C.6040507@uni-muenster.de>
References: <5106D55C.6040507@uni-muenster.de>
Message-ID: <CAK8gSG8guGDm3P-NHEc1n3iEyrRfUauPU94AcpFoit+oTkjV7g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130128/628a89d1/attachment.pl>

From edzer.pebesma at uni-muenster.de  Mon Jan 28 22:52:27 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 28 Jan 2013 22:52:27 +0100
Subject: [R-sig-Geo] SpatioTemporal CRAN task view
In-Reply-To: <CAK8gSG8guGDm3P-NHEc1n3iEyrRfUauPU94AcpFoit+oTkjV7g@mail.gmail.com>
References: <5106D55C.6040507@uni-muenster.de>
	<CAK8gSG8guGDm3P-NHEc1n3iEyrRfUauPU94AcpFoit+oTkjV7g@mail.gmail.com>
Message-ID: <5106F31B.1080003@uni-muenster.de>

Thanks, Ping.

As written on http://cran.r-project.org/web/packages/index.html ,

"CRAN Task Views allow you to browse packages by topic and provide tools
to automatically install all packages for special areas of interest."

I'll add the ncdf and Rnetcdf packages to the task view.

On 01/28/2013 10:44 PM, ping yang wrote:
> Hi,
> 
> The spatio-temporal tasks are spectacular! Can they bundled in a library or
> in one package?
> 
> Actually, if the tasks can be imported into ncdf or Rnetcdf (which is
> natively a space-time data), that will be extremely useful.
> 
> Thanks,
> 
> Ping
> 
> 
> On Mon, Jan 28, 2013 at 2:45 PM, Edzer Pebesma <
> edzer.pebesma at uni-muenster.de> wrote:
> 
>> List,
>>
>> CRAN now has a task view for handling and analyzing spatio-temporal
>> data; visit:
>>
>> http://cran.r-project.org/web/views/SpatioTemporal.html
>>
>> If some package is mentioned here in the wrong way, or in the wrong
>> context, or if you know of packages or subjects that could be added, any
>> ideas for improvement, please let me know.
>>
>> With best regards,
>> --
>> Edzer Pebesma
>> Institute for Geoinformatics (ifgi), University of M?nster
>> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
>> 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
>> http://www.52north.org/geostatistics      e.pebesma at wwu.de
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From sidartagalas at gmail.com  Tue Jan 29 00:22:17 2013
From: sidartagalas at gmail.com (sidartagalas)
Date: Mon, 28 Jan 2013 20:22:17 -0300
Subject: [R-sig-Geo] Erro in variog
Message-ID: <CACmk37Kmsx-iqPcPuuHJuLJfMxf9FbhKCWfZ6NfJPhbkHWP5Pw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130128/b6385c78/attachment.pl>

From iruckaE at mail2world.com  Tue Jan 29 01:44:54 2013
From: iruckaE at mail2world.com (Irucka Embry)
Date: Mon, 28 Jan 2013 16:44:54 -0800
Subject: [R-sig-Geo] lapply and SpatialGridDataFrame
Message-ID: <BF633A7DE86B48B2A09EE638A5953740@mail2world.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130128/e2454fd0/attachment.pl>

From edzer.pebesma at uni-muenster.de  Tue Jan 29 07:35:03 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 29 Jan 2013 07:35:03 +0100
Subject: [R-sig-Geo] Erro in variog
In-Reply-To: <CACmk37Kmsx-iqPcPuuHJuLJfMxf9FbhKCWfZ6NfJPhbkHWP5Pw@mail.gmail.com>
References: <CACmk37Kmsx-iqPcPuuHJuLJfMxf9FbhKCWfZ6NfJPhbkHWP5Pw@mail.gmail.com>
Message-ID: <51076D97.9030802@uni-muenster.de>



On 01/29/2013 12:22 AM, sidartagalas wrote:
> Hi,
> 
> I've tried to do a plot of some variogram and this error has happen... Any
> one knows what could I do?
> 
>> plot(vario.exp1990, type = "c", lty=2, col = "blue") #darkblue
> Erro em xy.coords(x, y, xlabel, ylabel, log) :
>   'x' and 'y' lengths differ
> Al?m disso: Mensagens de aviso perdidas:
> In max(x$classic/2, x$robust/2, na.rm = TRUE) :
>   nenhum argumento n?o faltante para max; retornando -Inf
> 
> 
> 

At a minimum, you should tell us which packages you loaded
(sessionInfo()); preferably, provide us with a script that reproduces
the error with only copy and paste (without manually downloading things).

> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From Roger.Bivand at nhh.no  Tue Jan 29 08:06:13 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 29 Jan 2013 08:06:13 +0100
Subject: [R-sig-Geo] SpatioTemporal CRAN task view
In-Reply-To: <CAK8gSG8guGDm3P-NHEc1n3iEyrRfUauPU94AcpFoit+oTkjV7g@mail.gmail.com>
References: <5106D55C.6040507@uni-muenster.de>
	<CAK8gSG8guGDm3P-NHEc1n3iEyrRfUauPU94AcpFoit+oTkjV7g@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1301290800590.11238@reclus.nhh.no>

On Mon, 28 Jan 2013, ping yang wrote:

> Hi,
>
> The spatio-temporal tasks are spectacular! Can they bundled in a library or
> in one package?

install.packages("ctv")
library(ctv)
install.views("SpatioTemporal", coreOnly=TRUE)

with coreOnly=FALSE to get the lot. That is part of the idea of Task 
Views (and is documented, see the foot of 
http://cran.r-project.org/web/views/; does anyone nowadays read what we 
document?).

Roger

>
> Actually, if the tasks can be imported into ncdf or Rnetcdf (which is
> natively a space-time data), that will be extremely useful.
>
> Thanks,
>
> Ping
>
>
> On Mon, Jan 28, 2013 at 2:45 PM, Edzer Pebesma <
> edzer.pebesma at uni-muenster.de> wrote:
>
>> List,
>>
>> CRAN now has a task view for handling and analyzing spatio-temporal
>> data; visit:
>>
>> http://cran.r-project.org/web/views/SpatioTemporal.html
>>
>> If some package is mentioned here in the wrong way, or in the wrong
>> context, or if you know of packages or subjects that could be added, any
>> ideas for improvement, please let me know.
>>
>> With best regards,
>> --
>> Edzer Pebesma
>> Institute for Geoinformatics (ifgi), University of M?nster
>> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
>> 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
>> http://www.52north.org/geostatistics      e.pebesma at wwu.de
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> 	[[alternative HTML version deleted]]
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Tue Jan 29 09:07:32 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 29 Jan 2013 09:07:32 +0100
Subject: [R-sig-Geo] lapply and SpatialGridDataFrame
In-Reply-To: <BF633A7DE86B48B2A09EE638A5953740@mail2world.com>
References: <BF633A7DE86B48B2A09EE638A5953740@mail2world.com>
Message-ID: <alpine.LRH.2.03.1301290806200.11238@reclus.nhh.no>

On Tue, 29 Jan 2013, Irucka Embry wrote:

> Hi Don MacQueen, I want to thank you for your response.
>
> I received assistance from the main R help mailing list with this code
> suggestion: maxdepth.plys <- lapply(modeldepthsmore, function(x)
> Grid2Polygons(x, level = FALSE)).

You posted to the second list when nobody replied within two hours - some 
of us sleep at some time of the day. The two replies are equivalent, and 
both indicate that either you didn't read the documentation of lapply, or 
didn't understand what you read.

> I have not allowed that code suggestion or your suggestion to complete 
> all 54 polygons because it has taken too long. Thus I thought about 
> revising the code that you provided me to save each polygon to a file so 
> that I can know which files have been completed and which ones have not 
> been yet.
>

Wrong, you mean object, not file. You also need to learn about trapping 
errors. Simplify what you are doing as a loop, as most of this is 
confusing because you've written it in a confusing way (don't write a 
single line function, it is pointless). In addition, you have not said 
what you are actually doing.

You are reading 54 ASCII Grid files into SpatialGridDataFrame objects, 
then using Grid2Polygons in the Grid2Polygons package to make a simple 
conversion of each input grid cell (pixel) to a Polygons object. The 
output SpatialPolygonsDataFrame objects are simple copies of the input, so 
you do not use the functionality of Grid2Polygons to aggregate to blocks 
of pixels; you could use coercion in sp instead.

However, in your message to R-help, you showed that your goal was to use 
BayesX. So is your actual aim to stack 54 rasters (possibly 54 time 
periods???), create a single set of SpatialPolygons, output to Shapefile, 
read in through the functions in BayesX (which are not based on sp classes 
- had they been, you wouldn't need to write out and read in again), then 
run some space-time analysis?

Or are the 54 grids all different - in which case get your whole workflow 
functioning with a single raster first, and then iterate that in a loop, 
storing results in a list. If your raster has many cells, you may find 
that the time it takes to run BayesX makes the time taken to convert 
SpatialGrid -> SpatialPolygons very small, but then again, it could be the 
use of Grid2Polygons when its advanced features are not needed:

> library(Grid2Polygons)
> GT <- GridTopology(c(0.5, 0.5), c(1,1), c(100, 100))
> SGDF <- SpatialGridDataFrame(GT, data=data.frame(x=runif(10000)))
> system.time(G2P <- Grid2Polygons(SGDF, level=FALSE))
    user  system elapsed
  36.129   0.832  37.013
> system.time(SPDF <- as(SGDF, "SpatialPolygonsDataFrame"))
    user  system elapsed
   2.875   0.043   2.945

If the SpatialGridDataFrame objects all share the same GridTopology, you 
should make a single SpatialGridDataFrame in a loop, or a single 
RasterBrick or RasterStack in the raster package, and go from there. But 
your proposed workflow is so opaque that helping you fix lapply isn't 
going to move you forward at all.

You must think through your workflow carefully - it is very possible that 
you can create the BayesX bnd object directly from the GridTopology of the 
input data, without any intermediate SpatialPolygons objects or 
shapefiles. The authors of BayesX would have done everyone a big favour if 
they had supported sp and spacetime classes, for example by coercion - 
spatstat is a good example of how to use both sp and package-specific 
classes, and possibly used facilities in sp and spacetime for 
visualisation.

Roger

> I have tried to update the previous R code to save each output file to a
> folder:
>
> library(maptools)
> library(Grid2Polygons)
>
> readfunct <- function(x)
> {
> u <- readAsciiGrid(x)
> }
>
> modfilesmore <- paste0("MaxFloodDepth_", 1:54, ".txt")
> modeldepthsmore <- lapply(modfilesmore, readfunct)
>
> myfolder <- paste0("/MaxFloodDepthImages/MaxFloodDepthPolygon_", 1:54)
> maxdepth.plys <- lapply(modeldepthsmore, Grid2Polygons, level=FALSE,
> cat, file = "myfolder", append = TRUE)
>
> Error in FUN(X[[1L]], ...) :
> unused argument(s) (file = "myfolder", append = TRUE)
>
>
> <-----Original Message----->
>> From: MacQueen, Don [macqueen1 at llnl.gov]
>> Sent: 1/28/2013 12:34:56 PM
>> To: iruckaE at mail2world.com;r-sig-geo at r-project.org
>> Subject: Re: [R-sig-Geo] lapply and SpatialGridDataFrame
>>
>> I suspect you're not passing arguments correctly to lapply()
>>
>> I'd try
>> maxdepth.plys <- lapply(modeldepthsmore, Grid2Polygons, level=FALSE)
>>
>> -Don
>>
>>
>>
>> --
>> Don MacQueen
>>
>> Lawrence Livermore National Laboratory
>> 7000 East Ave., L-627
>> Livermore, CA 94550
>> 925-423-1062
>>
>>
>>
>>
>>
>> On 1/27/13 2:47 AM, "Irucka Embry" <iruckaE at mail2world.com> wrote:
>>
>>> Hi all, I have a set of 54 files that I need to convert from ASCII
> grid
>>> format to .shp files to .bnd files for BayesX.
>>>
>>> I have the following R code to operate on those files:
>>>
>>> library(maptools)
>>> library(Grid2Polygons)
>>>
>>> readfunct <- function(x)
>>> {
>>> u <- readAsciiGrid(x)
>>> }
>>>
>>> modfilesmore <- paste0("MaxFloodDepth_", 1:54, ".txt")
>>> modeldepthsmore <- lapply(modfilesmore, readfunct)
>>>
>>> maxdepth.plys <- lapply(modeldepthsmore,
> Grid2Polygons(modeldepthsmore,
>>> level = FALSE))
>>>
>>> layers <- paste0("examples/floodlayers_", 1:54)
>>> writePolyShape(maxdepth.plys, layers)
>>> shpName <- sub(pattern="(.*)\\.dbf", replacement="\\1",
>>> x=system.file("examples/Flood/layer_.dbf", package="BayesX"))
>>> floodmaps <- shp2bnd(shpname=shpName, regionnames="SP_ID")
>>>
>>> ## draw the map
>>> drawmap(map=floodmaps)
>>>
>>>
>>> This is the error message that I receive:
>>>> maxdepth.plys <- lapply(modeldepthsmore,
>>> Grid2Polygons(modeldepthsmore, level = FALSE))
>>> Error in Grid2Polygons(modeldepthsmore, level = FALSE) :
>>> Grid object not of class SpatialGridDataFrame
>>>
>>>
>>> Can someone assist me in modifying the R code so that I can convert
> the
>>> set of files to .shp files?
>>>
>>> Thank-you.
>>>
>>> Irucka Embry
>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
> <span id=m2wTl><p><font face="Arial, Helvetica, sans-serif" size="2" style="font-size:13.5px">_______________________________________________________________<BR>Get the Free email that has everyone talking at <a href=http://www.mail2world.com target=new>http://www.mail2world.com</a><br>  <font color=#999999>Unlimited Email Storage &#150; POP3 &#150; Calendar &#150; SMS &#150; Translator &#150; Much More!</font></font></span>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From b.rowlingson at lancaster.ac.uk  Tue Jan 29 10:10:53 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Tue, 29 Jan 2013 09:10:53 +0000
Subject: [R-sig-Geo] SpatioTemporal CRAN task view
In-Reply-To: <c676b52ed93e45afaf4a945b74732879@EX-0-HT0.lancs.local>
References: <5106D55C.6040507@uni-muenster.de>
	<CAK8gSG8guGDm3P-NHEc1n3iEyrRfUauPU94AcpFoit+oTkjV7g@mail.gmail.com>
	<c676b52ed93e45afaf4a945b74732879@EX-0-HT0.lancs.local>
Message-ID: <CANVKczMy_CRrc2MVkAGni+ob3ypXn7drDDptin+9J5afSL+KXQ@mail.gmail.com>

On Tue, Jan 29, 2013 at 7:06 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> On Mon, 28 Jan 2013, ping yang wrote:
>
>> Hi,
>>
>> The spatio-temporal tasks are spectacular! Can they bundled in a library or
>> in one package?
>
> install.packages("ctv")

It would help if the one-liner for ctv in the big list of R packages
was a bit more explanatory:

ctv       CRAN Task Views

and its not clear that the functions in that package actually install
the packages referenced in the Task View (rather than install the
"Task View" itself, ie the document).

help.search("task view")

gives the one-liner for ctv::install.views which just says "CRAN Task
Views: Client-side Tools". Which doesn't say "get packages mentioned
in a Task View" or similar.

I still think "task view" is a bad name, and these things need
integrating into R documentation in a much better way. They can be
perfect sources for domain- and problem-specific newcomers to R, yet
are unfindable from the R home page because they are on CRAN which
waves its little independence flag at the R home page (I exaggerate
slightly!). There should be a link to the task views on the R home
page, under documentation, which should be at least the second thing
on the sidebar...

Oh I'm going off on a rant about the R web site now. I'll go take a cold shower.

CC'd to Achim as maintainter of ctv for comment. Migrate to R-dev if needed.


Barry


From mankga.ledile at gmail.com  Tue Jan 29 10:45:22 2013
From: mankga.ledile at gmail.com (Ledile Mankga)
Date: Tue, 29 Jan 2013 09:45:22 +0000
Subject: [R-sig-Geo] (no subject)
Message-ID: <CANbetH1vTmY=Yj7pqjU+geLDoSwQSaSDgFrT3b3gpxtX_Cspdg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130129/510af76f/attachment.pl>

From Roger.Bivand at nhh.no  Tue Jan 29 11:03:40 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 29 Jan 2013 11:03:40 +0100
Subject: [R-sig-Geo] (no subject)
In-Reply-To: <CANbetH1vTmY=Yj7pqjU+geLDoSwQSaSDgFrT3b3gpxtX_Cspdg@mail.gmail.com>
References: <CANbetH1vTmY=Yj7pqjU+geLDoSwQSaSDgFrT3b3gpxtX_Cspdg@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1301291055510.11238@reclus.nhh.no>

On Tue, 29 Jan 2013, Ledile Mankga wrote:

> Dear list members
>
> I am having a problem with reading a shapefile, please have a look at the
> problem below:
>
> koppen <- readOGR("GIS/Koppen_Geiger/koppen.shp", layer="koppen")
> Error in ogrInfo(dsn = dsn, layer = layer, encoding = encoding, use_iconv =
> use_iconv) :
>  Cannot open file
>
> then I tried this again,
>
>> koppen <- readOGR(dsn="C:\\Users\\Ledile
> emachines\\Desktop\\Modelling_species _distribution\\SDM
> course\\GIS\\Koppen_Geiger\\koppen.shp", layer="koppen")
> Error in file(paste(dsn, .Platform$file.sep, layer, ".dbf", sep = ""),  :
>  cannot open the connection
> In addition: Warning message:
> In file(paste(dsn, .Platform$file.sep, layer, ".dbf", sep = ""),  :
>  cannot open file 'C:\Users\Ledile emachines\Desktop\Modelling_species
> _distribution\SDM course\GIS\Koppen_Geiger\koppen.shp/koppen.dbf': No such
> file or directory
>

Please always provide the output of sessionInfo(). I am fairly certain 
that you have rgdal < 0.8-4, because this bug was fixed in 0.8-4 - see 
the first entry in:

http://cran.r-project.org/web/packages/rgdal/ChangeLog

In general you should pass the path to the layer as the dsn=, and the 
layer name as layer=. If you use the alternative form, use a complete path 
to the shapefile dsn, which would have worked here if you had updated 
rgdal.

The same problem was mentioned and resolved in:

https://stat.ethz.ch/pipermail/r-sig-geo/2013-January/017226.html

Hope this helps,

Roger

>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From kridox at ymail.com  Tue Jan 29 11:19:22 2013
From: kridox at ymail.com (Pascal Oettli)
Date: Tue, 29 Jan 2013 19:19:22 +0900
Subject: [R-sig-Geo] (no subject)
In-Reply-To: <CANbetH1vTmY=Yj7pqjU+geLDoSwQSaSDgFrT3b3gpxtX_Cspdg@mail.gmail.com>
References: <CANbetH1vTmY=Yj7pqjU+geLDoSwQSaSDgFrT3b3gpxtX_Cspdg@mail.gmail.com>
Message-ID: <5107A22A.3000202@ymail.com>

Hello,

Maybe the problem is the space in "Ledile emachines" and "SDM course".

Try to put your files directly in "C:\", to see whether it solves the 
problem.

HTH
Pascal


Le 29/01/2013 18:45, Ledile Mankga a ?crit :
> Dear list members
>
> I am having a problem with reading a shapefile, please have a look at the
> problem below:
>
> koppen <- readOGR("GIS/Koppen_Geiger/koppen.shp", layer="koppen")
> Error in ogrInfo(dsn = dsn, layer = layer, encoding = encoding, use_iconv =
> use_iconv) :
>    Cannot open file
>
> then I tried this again,
>
>> koppen <- readOGR(dsn="C:\\Users\\Ledile
> emachines\\Desktop\\Modelling_species _distribution\\SDM
> course\\GIS\\Koppen_Geiger\\koppen.shp", layer="koppen")
> Error in file(paste(dsn, .Platform$file.sep, layer, ".dbf", sep = ""),  :
>    cannot open the connection
> In addition: Warning message:
> In file(paste(dsn, .Platform$file.sep, layer, ".dbf", sep = ""),  :
>    cannot open file 'C:\Users\Ledile emachines\Desktop\Modelling_species
> _distribution\SDM course\GIS\Koppen_Geiger\koppen.shp/koppen.dbf': No such
> file or directory
>
>
>


From vijayaraghavan at smart.mit.edu  Tue Jan 29 15:41:08 2013
From: vijayaraghavan at smart.mit.edu (Rajagopal Vijayaraghavan)
Date: Tue, 29 Jan 2013 22:41:08 +0800
Subject: [R-sig-Geo] 3D Point Pattern Summary Statistics
Message-ID: <D3EFA21E-D678-4F26-8042-60DCB99C495A@smart.mit.edu>

Hi,

I would like some expert guidance with an issue I am having; I hope this is the right place to ask this question. 

I want to test the validity of a non-parametric model to simulate a 3D point pattern. I am using the G-function and a-priori knowledge on restrictions on the pattern (there is an attraction for the points towards an anatomical landmark that I have quantified) as the basis of an energy function I minimize through a form of poisson thinning with the aim of matching the statistical measures that have been observed in the real data. 

I use the F3est, K3est, pcf3Est and G3est functions to generate the envelopes from this non-parametric model to then see if my observed data (that I used to generate the stats for the energy function in the first place) fits into the envelope. 

I find that the K, G and pcf of the observed data fits well within the envelopes of K, G and pcf from the 99 simulated point patterns. However, I find that the F function of the observed is slightly outside the envelope for the F from the simulations. My questions are:

(i) If G, K and pcf (I acknowledge that K and pcf are related) fit into the envelope, then F should, should it not? F(r) is the proportion of the nearest points in the point process that are less than r away from an arbitrary point in the window. The K and G are related to some degree to this aren't they?

(ii) How far out of the envelope is too far? I guess I am asking if the envelope test is a hard black/white kind of rule or does one think of the context and justify how sincerely one must adhere to the envelope test for these different summary statistics?

I would like to note that I have kept the details to a minimum to save time, but I do have these plots and can give further explanation if needed. Thank you for your help in advance.

best wishes

Vijay


From a.mosnier at gmail.com  Tue Jan 29 21:08:24 2013
From: a.mosnier at gmail.com (Arnaud Mosnier)
Date: Tue, 29 Jan 2013 15:08:24 -0500
Subject: [R-sig-Geo] Raster and layout
Message-ID: <CANkFkEeoAv81smp0Dp=dCf2udXf8P-nGv-kSLGL2hmw78yAX3w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130129/67a84c7e/attachment.pl>

From a.mosnier at gmail.com  Tue Jan 29 21:21:46 2013
From: a.mosnier at gmail.com (Arnaud Mosnier)
Date: Tue, 29 Jan 2013 15:21:46 -0500
Subject: [R-sig-Geo] Raster and layout
In-Reply-To: <CANkFkEeoAv81smp0Dp=dCf2udXf8P-nGv-kSLGL2hmw78yAX3w@mail.gmail.com>
References: <CANkFkEeoAv81smp0Dp=dCf2udXf8P-nGv-kSLGL2hmw78yAX3w@mail.gmail.com>
Message-ID: <CANkFkEew_8afSRZGWWM6zCEt8TbqXQMk=tjK1mgGaHVJh5BsQQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130129/0fe9c4ea/attachment.pl>

From milansharma2012 at yahoo.com  Wed Jan 30 08:17:21 2013
From: milansharma2012 at yahoo.com (Milan Sharma)
Date: Tue, 29 Jan 2013 23:17:21 -0800 (PST)
Subject: [R-sig-Geo] Shape file problem
Message-ID: <1359530241.79351.YahooMailNeo@web162105.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130129/8b4f12ab/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Wed Jan 30 09:24:38 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed, 30 Jan 2013 08:24:38 +0000
Subject: [R-sig-Geo] Shape file problem
In-Reply-To: <453826b6fbe649f3beaa80dab98781f2@EX-1-HT0.lancs.local>
References: <453826b6fbe649f3beaa80dab98781f2@EX-1-HT0.lancs.local>
Message-ID: <CANVKczPYjR4zNcYiR5uvsWfoW4Nba5FkJU4ySOrr6AWHv=rUPA@mail.gmail.com>

What are the correct names? "01", "02" and so on? Or were you
expecting something else? We don't have your data so we have no idea
what the right answer is.

How did you create your shapefile? In R? You don't say.

Please show is the code you used, or a simple example that illustrates
the problem. It might be something to with R not liking column names
to be numeric. I tried a little test just now, and saving an
SpatialPointsDataFrame with numeric column names produces a warning,
and reading a shapefile with numeric column names converted the names
to "X01" and "X02".

But I'm wasting my time if this isn't your problem, and you haven't
really told us enough.





On Wed, Jan 30, 2013 at 7:17 AM, Milan Sharma <milansharma2012 at yahoo.com> wrote:
> Dear all,
> my question is about shapefile and GIS, rather than R. If somebody could kindly help me, or can direct me to another site, I would appreciate that.
> I created my shapefile successfully, and the name of my shapefile is AZ. I have different name for the columns of my shape file, but shape file assigns the names of my columns as "AZ_01", ",....AZ_02",.., and so on. How can I get correct names correctly in my shapefile?
>
> Thanks,
> Milan
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Lindsay.Beazley at dfo-mpo.gc.ca  Wed Jan 30 14:07:31 2013
From: Lindsay.Beazley at dfo-mpo.gc.ca (Beazley, Lindsay)
Date: Wed, 30 Jan 2013 09:07:31 -0400
Subject: [R-sig-Geo] Help with interpreting correlog results, package ncf
Message-ID: <C29E4917390DA44189281D08DE11CDD107F0B6E8@marbioexc01.mar.dfo-mpo.ca>

Dear Roger Bivand and list members,

I am looking for advice on how to interpret a correlogram of species
richness data collected from photographic transects of the seabed. I am
an amateur in R, and am completely new to spatial analysis, so please
forgive the naivety of my issue.

I have four photographic transects consisting of photos at varying
distances apart. Photos within transects are not at equal distances
apart, and the transects themselves also vary in distance from one
another. Three of these transects are relatively close together (within
a 26 km diameter), while the fourth transect is roughly 100 km away from
the first three. The total distance between the two farthest photos is
138 km. 

Using glm I have fit a poisson distribution with log link to determine
the influence of four environmental variables on species richness. This
was fit using all photos across all transects. I am interested in
determining whether there is spatial autocorrelation present in the
residuals of this model. I used correlog( ) in package 'ncf' to create a
Moran's I correlogram. The code I used is: 

cor1<-correlog(data$Longitude, data$Latitude, residuals(glm1),
increment=1, latlon=TRUE, resamp=1000). 

Latlon was set to true as my coordinates are geographical. I set
increment=1 as I understood each distance class would represent 1 km. I
then plotted the correlogram using plot(cor1$correlation[1:30]). There
are 30 distance classes. The correlogram is attached to this email. I am
confused on how to interpret the results of the correlogram. I have 30
distance classes, although the scale of my data is roughly 138 km,
therefore each distance class does not equal 1 km as I expected. The
output of cor1 (attached) shows 30 distance classes, although they are
labelled 1-8, 19-26, 111-119, and 134-138. I'm assuming the distances
classes are broken up like this because the photos are not contiguous?
Should the autocorrelation therefore be assessed within transects
instead of across them? 

My second question relates to significance testing. I set resamp to 1000
and generated the p values for each distance class. Is this a suitable
method for testing the significance of the autocorrelation at each
class? In this case my first distance class is significant (p=0.028).
>From reading other list postings there doesn't appear to be a method to
test for significant autocorrelation in glm fits (although there is for
lm fits). 

Thanks for any advice you can provide.

Cheers,

Lindsay

 <<Correlogram_SpeciesRichness.pdf>>  <<Cor1.txt>> 




-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130130/c837a499/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Correlogram_SpeciesRichness.pdf
Type: application/pdf
Size: 2512 bytes
Desc: Correlogram_SpeciesRichness.pdf
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130130/c837a499/attachment.pdf>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: Cor1.txt
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130130/c837a499/attachment.txt>

From Anne.Reichmuth at dlr.de  Wed Jan 30 15:21:20 2013
From: Anne.Reichmuth at dlr.de (Anne.Reichmuth at dlr.de)
Date: Wed, 30 Jan 2013 14:21:20 +0000
Subject: [R-sig-Geo]  probability predict by class
Message-ID: <6BD7933C26A7E84B93C0B10952E5CAE501986AAF@DLREXMBX01.intra.dlr.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130130/9f151332/attachment.pl>

From milansharma2012 at yahoo.com  Wed Jan 30 15:42:53 2013
From: milansharma2012 at yahoo.com (Milan Sharma)
Date: Wed, 30 Jan 2013 06:42:53 -0800 (PST)
Subject: [R-sig-Geo] Shape file problem
In-Reply-To: <CANVKczPYjR4zNcYiR5uvsWfoW4Nba5FkJU4ySOrr6AWHv=rUPA@mail.gmail.com>
References: <453826b6fbe649f3beaa80dab98781f2@EX-1-HT0.lancs.local>
	<CANVKczPYjR4zNcYiR5uvsWfoW4Nba5FkJU4ySOrr6AWHv=rUPA@mail.gmail.com>
Message-ID: <1359556973.66864.YahooMailNeo@web162101.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130130/0a9d77e7/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Wed Jan 30 16:05:10 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed, 30 Jan 2013 15:05:10 +0000
Subject: [R-sig-Geo] Shape file problem
In-Reply-To: <f44309e2b70d48e5935aef001229da43@EX-0-HT0.lancs.local>
References: <453826b6fbe649f3beaa80dab98781f2@EX-1-HT0.lancs.local>
	<CANVKczPYjR4zNcYiR5uvsWfoW4Nba5FkJU4ySOrr6AWHv=rUPA@mail.gmail.com>
	<f44309e2b70d48e5935aef001229da43@EX-0-HT0.lancs.local>
Message-ID: <CANVKczM35dbMDf7K926CiG7cOi3N_1W+K37KVUWNfqzmTVUZ+Q@mail.gmail.com>

On Wed, Jan 30, 2013 at 2:42 PM, Milan Sharma <milansharma2012 at yahoo.com> wrote:

>> #in my shape file, column names have come
>> #SD_csv_O,  SD_CSV_D,instead of open water,
>> #or other names like that because of my problem in creating shape file.

Well, we don't know how you created the shapefile so we can't solve
that problem.

>> # I wanted to assign the correct names of my columns using names (data).
>> But got error
>> colnames(data) <- c( "STATEFP","COUNTYFP","COUNTYNS" ,  "GEOID",
>> "NAME","NAMELSAD","LSAD","CLASSFP","MTFCC","CSAFP","CBSAFP","METDIVFP","FUNCSTAT","ALAND","AWATER","INTPTLAT","INTPTLON",
>> "Openwater","Dev
>> open","DevLowin","DevMed","DevHi","Barren","Deciduous","Evergr","Mixfor","Shrub","Grass","Sedge","Cultcrop","Woody","wetHerb","p2010","Areasqml","Popsqm")
> Error in `colnames<-`(`*tmp*`, value = c("STATEFP", "COUNTYFP", "COUNTYNS",

Why did you say "using names (data)" and then try "colnames(data)"?
Because "names(data)" should work. Here is a complete reusable
example:

 > require(sp)

 > data=data.frame(x=runif(10),y=runif(10),z1=runif(10),z2=runif(10))
 > coordinates(data)=~x+y
 > data
            coordinates         z1         z2
1  (0.724746, 0.557815) 0.47356654 0.93721636
2   (0.614448, 0.10798) 0.80956133 0.78836015
3   (0.39065, 0.845377) 0.61940167 0.36847489
4   (0.35598, 0.363572) 0.07214902 0.45609632
5  (0.248248, 0.219995) 0.64276010 0.52574029
...

 > colnames(data)
NULL
 > names(data)
[1] "z1" "z2"
 > colnames(data)=c("foo","bar")
Error in `colnames<-`(`*tmp*`, value = c("foo", "bar")) :
  'dimnames' applied to non-array
 > names(data)=c("foo","bar")
 > data
            coordinates        foo        bar
1  (0.724746, 0.557815) 0.47356654 0.93721636
2   (0.614448, 0.10798) 0.80956133 0.78836015
3   (0.39065, 0.845377) 0.61940167 0.36847489
4   (0.35598, 0.363572) 0.07214902 0.45609632
5  (0.248248, 0.219995) 0.64276010 0.52574029
6  (0.955221, 0.185988) 0.93994016 0.64672931
...


From klborgmann at gmail.com  Wed Jan 30 17:17:39 2013
From: klborgmann at gmail.com (Kathi Borgmann)
Date: Wed, 30 Jan 2013 08:17:39 -0800
Subject: [R-sig-Geo] Failure during raster IO
Message-ID: <CAPD=AxpFNas=+yxg_cUK9-+GXT6s4ED6GBaswKtah-WiRmRmhQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130130/21ec825c/attachment.pl>

From jh.hornych at gmail.com  Wed Jan 30 17:48:43 2013
From: jh.hornych at gmail.com (Jan Hornych)
Date: Wed, 30 Jan 2013 17:48:43 +0100
Subject: [R-sig-Geo] SpatialPolygon with the max value gets no color
 assigned in spplot function when using "at" parameter
Message-ID: <CAEFfJxgWSX=QyKT6GCyDL-bya2euNuSQsojWQ6hvvU4nPpTOBQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130130/f5c0b585/attachment.pl>

From Roger.Bivand at nhh.no  Wed Jan 30 20:04:26 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 30 Jan 2013 20:04:26 +0100
Subject: [R-sig-Geo] SpatialPolygon with the max value gets no color
 assigned in spplot function when using "at" parameter
In-Reply-To: <CAEFfJxgWSX=QyKT6GCyDL-bya2euNuSQsojWQ6hvvU4nPpTOBQ@mail.gmail.com>
References: <CAEFfJxgWSX=QyKT6GCyDL-bya2euNuSQsojWQ6hvvU4nPpTOBQ@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1301301808460.16242@reclus.nhh.no>

On Wed, 30 Jan 2013, Jan Hornych wrote:

> Hi,
> I would like to do coloring of map regions based on the region values
> "weight". The approach I am taking is first to break regions into equal
> intervals,
> classIntervals(spdf$weight,4)$brks #4 intervals in this case
> and than coloring all regions within the interval with the same color
> col = brewer.pal(4,"RdYlGn"))
> The max "weight" is as well the boundary of the interval The problem is
> that the last region is not included into the last interval nad has thus no
> color. I do belive I am missing something, because any other solution to
> manually manipulate the intervals, is overcomplicating the simplicity of
> classIntervals function.
> any idea how to get all rectangles colored?
> Thank you
> Jan
> here is the example, see the rectangle in the right upper corner, it
> remains white.
> library(sp)
> library(classInt)
> library(RColorBrewer)
> p1=cbind(c(0,0,1,1,0),c(0,1,1,0,0));colnames(p1)=c("x","y")
> p2=cbind(c(0,0,1,1,0),c(1,2,2,1,1));colnames(p2)=c("x","y")
> p3=cbind(c(1,1,2,2,1),c(0,1,1,0,0));colnames(p3)=c("x","y")
> p4=cbind(c(1,1,2,2,1),c(1,2,2,1,1));colnames(p4)=c("x","y")
> p5=cbind(c(2,2,3,3,2),c(0,1,1,0,0));colnames(p5)=c("x","y")
> p6=cbind(c(2,2,3,3,2),c(1,2,2,1,1));colnames(p6)=c("x","y")
> ps1=Polygons(list(Polygon(p1)), ID="ps1")
> ps2=Polygons(list(Polygon(p2)), ID="ps2")
> ps3=Polygons(list(Polygon(p3)), ID="ps3")
> ps4=Polygons(list(Polygon(p4)), ID="ps4")
> ps5=Polygons(list(Polygon(p5)), ID="ps5")
> ps6=Polygons(list(Polygon(p6)), ID="ps6")
> sps = SpatialPolygons(list(ps1,ps2,ps3, ps4, ps5, ps6))
> spdf=
> SpatialPolygonsDataFrame(sps,data.frame(weight=c(0.1,0.1,0.3,0.4,0.45,0.6),row.names=c("ps1","ps2","ps3","ps4",
> "ps5","ps6")))
> sp.theme(set = TRUE, regions = list(col = brewer.pal(4,"RdYlGn")))
> spplot(spdf, "weight", at=classIntervals(spdf$weight,4)$brks)

I'm fairly sure I replied to this question very recently, but can't find 
the link. The at= argument in lattice graphics by default breaks [a, b), 
see:

http://en.wikipedia.org/wiki/Interval_(mathematics)#Excluding_the_endpoints

so the upper limit should be eased out beyond the maximum, here doing 
both for symmetry:

ats <- classIntervals(spdf$weight,4)$brks
ats[1] <- ats[1] - .Machine$double.eps
ats[length(ats)] <- ats[length(ats)] + .Machine$double.eps
spplot(spdf, "weight", at=ats)

This is described on the levelplot help page, linked from the spplot help 
page:

       at: A numeric vector giving breakpoints along the range of ?z?.
           ...  However, this also means that when supplying ?at?
           explicitly, one has to be careful to include values outside
           the range of ?z? to ensure that all the data are shown.

Hope this clarifies,

Roger

>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From iruckaE at mail2world.com  Wed Jan 30 20:36:11 2013
From: iruckaE at mail2world.com (Irucka Embry)
Date: Wed, 30 Jan 2013 11:36:11 -0800
Subject: [R-sig-Geo] lapply and SpatialGridDataFrame
Message-ID: <07C699823AB54D5088EFB7D2B63AB56A@mail2world.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130130/53b2f8e2/attachment.pl>

From arudolph at PIRE.org  Wed Jan 30 20:54:05 2013
From: arudolph at PIRE.org (Abby Rudolph)
Date: Wed, 30 Jan 2013 14:54:05 -0500
Subject: [R-sig-Geo] converting latitude and longitude to UTM
Message-ID: <0F5A69EADAE27F44B09561937B83C3A45954BE1B2B@MDMBX.PIRE.org>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130130/630d8e93/attachment.pl>

From macqueen1 at llnl.gov  Wed Jan 30 22:54:13 2013
From: macqueen1 at llnl.gov (MacQueen, Don)
Date: Wed, 30 Jan 2013 21:54:13 +0000
Subject: [R-sig-Geo] lapply and SpatialGridDataFrame
In-Reply-To: <07C699823AB54D5088EFB7D2B63AB56A@mail2world.com>
Message-ID: <5E1B812FAC2C4A49B3D99593B5A5219124ADB8@PRDEXMBX-08.the-lab.llnl.gov>

This should help you get started:

floodfiles <- list.files(pattern=".txt")

maxdepths <- list()
length(maxdepths) <- length(floodfiles)

for(i in seq(along=floodfiles)) {
  cat('-------',i,floodfiles[i],'----------\n')
  maxdepths[[i]] <- readAsciiGrid(floodfiles[i])}

Of course it overwrites. You are assigning the result of readAsciiGrid to
the same object each time.

I believe you would find it helpful to study the basics of R some more.
For example, the difference between [i] and [[i]] is crucial to this
example.

I added the cat() statement so that later on, when something fails as you
loop through the files, it will be obvious which input file had the
problem.

-Don
-- 
Don MacQueen

Lawrence Livermore National Laboratory
7000 East Ave., L-627
Livermore, CA 94550
925-423-1062





On 1/30/13 11:36 AM, "Irucka Embry" <iruckaE at mail2world.com> wrote:

>Hi all, Roger Bivand - thank-you for your assistance.
>
>I have attempted to write a for loop to create an object named maxdepth
>(see str(maxdepth)), but the loop overwrites the previous iteration.
>Although I have 54 files that I will be processing, I am attempting this
>for loop with only the first 2 files. I have searched online for a
>solution to this problem, but I have not been successful in finding one
>yet.
>
>Can someone offer a suggestion on how to fix the problem?
>
>Thank-you.
>
>Irucka Embry
>
>
>library(maptools)
>
>floodfiles <- list.files(pattern=".txt")
>for(i in seq(along=floodfiles)) {
>maxdepth <- readAsciiGrid(floodfiles[i])
>}
>
>str(maxdepth)
>Formal class 'SpatialGridDataFrame' [package "sp"] with 4 slots
>..@ data :'data.frame': 265472 obs. of 1 variable:
>.. ..$ MaxFloodDepth_2.txt: num [1:265472] 0 0 0 0 0 0 0 0 0 0 ...
>..@ grid :Formal class 'GridTopology' [package "sp"] with 3 slots
>.. .. ..@ cellcentre.offset: num [1:2] 356766 3936098
>.. .. ..@ cellsize : num [1:2] 22.9 22.9
>.. .. ..@ cells.dim : int [1:2] 976 272
>..@ bbox : num [1:2, 1:2] 356755 3936087 379079 3942308
>.. ..- attr(*, "dimnames")=List of 2
>.. .. ..$ : NULL
>.. .. ..$ : chr [1:2] "min" "max"
>..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slots
>.. .. ..@ projargs: chr NA
>
>
>
>
>
>
>
>
>
>
><-----Original Message----->
>>From: Roger Bivand [Roger.Bivand at nhh.no]
>>Sent: 1/29/2013 2:07:32 AM
>>To: iruckaE at mail2world.com
>>Cc: r-sig-geo at r-project.org
>>Subject: Re: [R-sig-Geo] lapply and SpatialGridDataFrame
>>
>>On Tue, 29 Jan 2013, Irucka Embry wrote:
>>
>>> Hi Don MacQueen, I want to thank you for your response.
>>>
>>> I received assistance from the main R help mailing list with this
>code
>>> suggestion: maxdepth.plys <- lapply(modeldepthsmore, function(x)
>>> Grid2Polygons(x, level = FALSE)).
>>
>>You posted to the second list when nobody replied within two hours -
>some 
>>of us sleep at some time of the day. The two replies are equivalent,
>and 
>>both indicate that either you didn't read the documentation of lapply,
>or 
>>didn't understand what you read.
>>
>>> I have not allowed that code suggestion or your suggestion to
>complete 
>>> all 54 polygons because it has taken too long. Thus I thought about
>>> revising the code that you provided me to save each polygon to a file
>so 
>>> that I can know which files have been completed and which ones have
>not 
>>> been yet.
>>>
>>
>>Wrong, you mean object, not file. You also need to learn about trapping
>>errors. Simplify what you are doing as a loop, as most of this is
>>confusing because you've written it in a confusing way (don't write a
>>single line function, it is pointless). In addition, you have not said
>>what you are actually doing.
>>
>>You are reading 54 ASCII Grid files into SpatialGridDataFrame objects,
>>then using Grid2Polygons in the Grid2Polygons package to make a simple
>>conversion of each input grid cell (pixel) to a Polygons object. The
>>output SpatialPolygonsDataFrame objects are simple copies of the input,
>so 
>>you do not use the functionality of Grid2Polygons to aggregate to
>blocks 
>>of pixels; you could use coercion in sp instead.
>>
>>However, in your message to R-help, you showed that your goal was to
>use 
>>BayesX. So is your actual aim to stack 54 rasters (possibly 54 time
>>periods???), create a single set of SpatialPolygons, output to
>Shapefile, 
>>read in through the functions in BayesX (which are not based on sp
>classes 
>>- had they been, you wouldn't need to write out and read in again),
>then 
>>run some space-time analysis?
>>
>>Or are the 54 grids all different - in which case get your whole
>workflow 
>>functioning with a single raster first, and then iterate that in a
>loop, 
>>storing results in a list. If your raster has many cells, you may find
>>that the time it takes to run BayesX makes the time taken to convert
>>SpatialGrid -> SpatialPolygons very small, but then again, it could be
>the 
>>use of Grid2Polygons when its advanced features are not needed:
>>
>>> library(Grid2Polygons)
>>> GT <- GridTopology(c(0.5, 0.5), c(1,1), c(100, 100))
>>> SGDF <- SpatialGridDataFrame(GT, data=data.frame(x=runif(10000)))
>>> system.time(G2P <- Grid2Polygons(SGDF, level=FALSE))
>> user system elapsed
>> 36.129 0.832 37.013
>>> system.time(SPDF <- as(SGDF, "SpatialPolygonsDataFrame"))
>> user system elapsed
>> 2.875 0.043 2.945
>>
>>If the SpatialGridDataFrame objects all share the same GridTopology,
>you 
>>should make a single SpatialGridDataFrame in a loop, or a single
>>RasterBrick or RasterStack in the raster package, and go from there.
>But 
>>your proposed workflow is so opaque that helping you fix lapply isn't
>>going to move you forward at all.
>>
>>You must think through your workflow carefully - it is very possible
>that 
>>you can create the BayesX bnd object directly from the GridTopology of
>the 
>>input data, without any intermediate SpatialPolygons objects or
>>shapefiles. The authors of BayesX would have done everyone a big favour
>if 
>>they had supported sp and spacetime classes, for example by coercion -
>>spatstat is a good example of how to use both sp and package-specific
>>classes, and possibly used facilities in sp and spacetime for
>>visualisation.
>>
>>Roger
>>
>>> I have tried to update the previous R code to save each output file
>to a
>>> folder:
>>>
>>> library(maptools)
>>> library(Grid2Polygons)
>>>
>>> readfunct <- function(x)
>>> {
>>> u <- readAsciiGrid(x)
>>> }
>>>
>>> modfilesmore <- paste0("MaxFloodDepth_", 1:54, ".txt")
>>> modeldepthsmore <- lapply(modfilesmore, readfunct)
>>>
>>> myfolder <- paste0("/MaxFloodDepthImages/MaxFloodDepthPolygon_",
>1:54)
>>> maxdepth.plys <- lapply(modeldepthsmore, Grid2Polygons, level=FALSE,
>>> cat, file = "myfolder", append = TRUE)
>>>
>>> Error in FUN(X[[1L]], ...) :
>>> unused argument(s) (file = "myfolder", append = TRUE)
>>>
>>>
>>> <-----Original Message----->
>>>> From: MacQueen, Don [macqueen1 at llnl.gov]
>>>> Sent: 1/28/2013 12:34:56 PM
>>>> To: iruckaE at mail2world.com;r-sig-geo at r-project.org
>>>> Subject: Re: [R-sig-Geo] lapply and SpatialGridDataFrame
>>>>
>>>> I suspect you're not passing arguments correctly to lapply()
>>>>
>>>> I'd try
>>>> maxdepth.plys <- lapply(modeldepthsmore, Grid2Polygons, level=FALSE)
>>>>
>>>> -Don
>>>>
>>>>
>>>>
>>>> --
>>>> Don MacQueen
>>>>
>>>> Lawrence Livermore National Laboratory
>>>> 7000 East Ave., L-627
>>>> Livermore, CA 94550
>>>> 925-423-1062
>>>>
>>>>
>>>>
>>>>
>>>>
>>>> On 1/27/13 2:47 AM, "Irucka Embry" <iruckaE at mail2world.com> wrote:
>>>>
>>>>> Hi all, I have a set of 54 files that I need to convert from ASCII
>>> grid
>>>>> format to .shp files to .bnd files for BayesX.
>>>>>
>>>>> I have the following R code to operate on those files:
>>>>>
>>>>> library(maptools)
>>>>> library(Grid2Polygons)
>>>>>
>>>>> readfunct <- function(x)
>>>>> {
>>>>> u <- readAsciiGrid(x)
>>>>> }
>>>>>
>>>>> modfilesmore <- paste0("MaxFloodDepth_", 1:54, ".txt")
>>>>> modeldepthsmore <- lapply(modfilesmore, readfunct)
>>>>>
>>>>> maxdepth.plys <- lapply(modeldepthsmore,
>>> Grid2Polygons(modeldepthsmore,
>>>>> level = FALSE))
>>>>>
>>>>> layers <- paste0("examples/floodlayers_", 1:54)
>>>>> writePolyShape(maxdepth.plys, layers)
>>>>> shpName <- sub(pattern="(.*)\\.dbf", replacement="\\1",
>>>>> x=system.file("examples/Flood/layer_.dbf", package="BayesX"))
>>>>> floodmaps <- shp2bnd(shpname=shpName, regionnames="SP_ID")
>>>>>
>>>>> ## draw the map
>>>>> drawmap(map=floodmaps)
>>>>>
>>>>>
>>>>> This is the error message that I receive:
>>>>>> maxdepth.plys <- lapply(modeldepthsmore,
>>>>> Grid2Polygons(modeldepthsmore, level = FALSE))
>>>>> Error in Grid2Polygons(modeldepthsmore, level = FALSE) :
>>>>> Grid object not of class SpatialGridDataFrame
>>>>>
>>>>>
>>>>> Can someone assist me in modifying the R code so that I can convert
>>> the
>>>>> set of files to .shp files?
>>>>>
>>>>> Thank-you.
>>>>>
>>>>> Irucka Embry
>>>
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>>-- 
>>Roger Bivand
>>Department of Economics, NHH Norwegian School of Economics,
>>Helleveien 30, N-5045 Bergen, Norway.
>>voice: +47 55 95 93 55; fax +47 55 95 95 43
>>e-mail: Roger.Bivand at nhh.no
>
>
><span id=m2wTl><p><font face="Arial, Helvetica, sans-serif" size="2"
>style="font-size:13.5px">_________________________________________________
>______________<BR>Get the Free email that has everyone talking at <a
>href=http://www.mail2world.com
>target=new>http://www.mail2world.com</a><br>  <font
>color=#999999>Unlimited Email Storage &#150; POP3 &#150; Calendar &#150;
>SMS &#150; Translator &#150; Much More!</font></font></span>
>	[[alternative HTML version deleted]]
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From chen_yiqun at hotmail.com  Wed Jan 30 23:50:07 2013
From: chen_yiqun at hotmail.com (chenyiqun)
Date: Wed, 30 Jan 2013 22:50:07 +0000
Subject: [R-sig-Geo] A question about conversion from a
 "spatialploygondatafrme" object to a "geojson" string with "rgdal" library
Message-ID: <BLU168-W51ED2E5692F8B14B372D5EEA1E0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130130/216fab77/attachment.pl>

From r.hijmans at gmail.com  Thu Jan 31 01:24:44 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 30 Jan 2013 16:24:44 -0800
Subject: [R-sig-Geo] lapply and SpatialGridDataFrame
In-Reply-To: <C23BA77241E54084BE7DC1EF4F7D629F@mail2world.com>
References: <C23BA77241E54084BE7DC1EF4F7D629F@mail2world.com>
Message-ID: <CANtt_hzSQpmrg8iTTUiqgLd_wftaSidqnrjpr=o=jdmn60Ch6w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130130/78e5f0e1/attachment.pl>

From mdsumner at gmail.com  Thu Jan 31 01:30:19 2013
From: mdsumner at gmail.com (Michael Sumner)
Date: Thu, 31 Jan 2013 11:30:19 +1100
Subject: [R-sig-Geo] converting latitude and longitude to UTM
In-Reply-To: <0F5A69EADAE27F44B09561937B83C3A45954BE1B2B@MDMBX.PIRE.org>
References: <0F5A69EADAE27F44B09561937B83C3A45954BE1B2B@MDMBX.PIRE.org>
Message-ID: <CAAcGz98WpNYqb8iEGmE2=uKaymDbyc3gaa-KgCppj3Nx+D0O7g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130131/0278efb8/attachment.pl>

From r.hijmans at gmail.com  Thu Jan 31 01:37:10 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 30 Jan 2013 16:37:10 -0800
Subject: [R-sig-Geo] probability predict by class
In-Reply-To: <6BD7933C26A7E84B93C0B10952E5CAE501986AAF@DLREXMBX01.intra.dlr.de>
References: <6BD7933C26A7E84B93C0B10952E5CAE501986AAF@DLREXMBX01.intra.dlr.de>
Message-ID: <CANtt_hxWPDoqtMyZ2HfJMZnv0qPO_cfm34AwCb1vE=nKD_jMtw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130130/beb00e3a/attachment.pl>

From r.hijmans at gmail.com  Thu Jan 31 01:44:26 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 30 Jan 2013 16:44:26 -0800
Subject: [R-sig-Geo] See coordinates vector in raster
In-Reply-To: <CAAcGz9_cqKs8TH9Rg8=Ma_p1HRtP18ipf3LgjLDCXqXW=VM89g@mail.gmail.com>
References: <1358898947.75663.YahooMailNeo@web121903.mail.ne1.yahoo.com>
	<3d60722b16a744a582b8eaf4528ac1bf@EX-0-HT0.lancs.local>
	<CANVKczMBPc1V2Lh9ZJqpy+7F74WmdQJ-ShaTqVe49WfA3F8K_g@mail.gmail.com>
	<CAAcGz9_cqKs8TH9Rg8=Ma_p1HRtP18ipf3LgjLDCXqXW=VM89g@mail.gmail.com>
Message-ID: <CANtt_hzbVo1cTFGQoQ6+hQ-A5iTBk_7ZVOTGKaLs5=kKzsEHPw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130130/a9478859/attachment.pl>

From r.hijmans at gmail.com  Thu Jan 31 01:53:28 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 30 Jan 2013 16:53:28 -0800
Subject: [R-sig-Geo] Zonal Statistics as Table
In-Reply-To: <CAK8gSG-JvdZpQCBPOy1NGoyVP6dPANB2WqW8rF08GNkTzTfrng@mail.gmail.com>
References: <1344012077.6904.YahooMailNeo@web190406.mail.sg3.yahoo.com>
	<CANtt_hwdS+qoTxFOfkJ8f+datU2HomWt4HZg-7mVHr26SBu2yQ@mail.gmail.com>
	<CAK8gSG-JvdZpQCBPOy1NGoyVP6dPANB2WqW8rF08GNkTzTfrng@mail.gmail.com>
Message-ID: <CANtt_hzLVkF-oN1QW1uAtic7-UQbr3sEc5-cT+7g2PCD8seAbg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130130/7c2d7aa0/attachment.pl>

From r.hijmans at gmail.com  Thu Jan 31 01:57:02 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 30 Jan 2013 16:57:02 -0800
Subject: [R-sig-Geo] Rasterbrick to netCDF
In-Reply-To: <1359081476.24921.YahooMailNeo@web121903.mail.ne1.yahoo.com>
References: <1359064489341-7582376.post@n2.nabble.com>
	<1359081476.24921.YahooMailNeo@web121903.mail.ne1.yahoo.com>
Message-ID: <CANtt_hyHM0wwGMeJxWHO6DptUvFTsm4tpe4GHDDqdiJxgLzipQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130130/8da423ac/attachment.pl>

From r.hijmans at gmail.com  Thu Jan 31 01:58:43 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 30 Jan 2013 16:58:43 -0800
Subject: [R-sig-Geo] Frequency table of rasters within polygons
In-Reply-To: <!&!AAAAAAAAAAAYAAAAAAAAANurYWtafkREnWeH4rBeYRHigQAAEAAAALd+u4Z8liZGqGZbF2FdWooBAAAAAA==@gmail.com>
References: <!&!AAAAAAAAAAAYAAAAAAAAANurYWtafkREnWeH4rBeYRHigQAAEAAAALd+u4Z8liZGqGZbF2FdWooBAAAAAA==@gmail.com>
Message-ID: <CANtt_hxHMOzWSrOg0B-nP6kdbBYqNY5rdRYCuXS3hFnD8xidUg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130130/2d732422/attachment.pl>

From r.hijmans at gmail.com  Thu Jan 31 02:47:32 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 30 Jan 2013 17:47:32 -0800
Subject: [R-sig-Geo] error in rasterFromXYZ
In-Reply-To: <CAE=+0-LjHw+0F+pc48BVzhDCDL0YxJ37qgx4TH6tzLtaUEsWVA@mail.gmail.com>
References: <CAE=+0-JA=kKtWwGKiDwURTX=OfwzwWzHnkqZsSx35UDM29TFww@mail.gmail.com>
	<CAAcGz9-oTs2GjDtnu_aCi5+xADh9rQVg9830o-e-fbqx_6KzFA@mail.gmail.com>
	<CALjAYt4rwkOJ6YF8mT5ADyeAFxKdGzLj-hW-YKEU=yvn4X2PjQ@mail.gmail.com>
	<CAE=+0-LjHw+0F+pc48BVzhDCDL0YxJ37qgx4TH6tzLtaUEsWVA@mail.gmail.com>
Message-ID: <CANtt_hx5QOhbF3hYkyXKk-YYqYXOCQ1M1SY3=KP=omw5EP0gNg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130130/957d2e7d/attachment.pl>

From Adrian.Baddeley at csiro.au  Thu Jan 31 08:08:49 2013
From: Adrian.Baddeley at csiro.au (Adrian.Baddeley at csiro.au)
Date: Thu, 31 Jan 2013 15:08:49 +0800
Subject: [R-sig-Geo]  3D Point Pattern Summary Statistics
Message-ID: <57DC18C299094D4299F837570C5DF1C5010D0263021E@EXWA-MBX01.nexus.csiro.au>

 	
Rajagopal Vijayaraghavan [vijayaraghavan at smart.mit.edu] wrote:

> I want to test the validity of a non-parametric model to simulate a 3D point pattern. [...]

> I use the F3est, K3est, pcf3Est and G3est functions to generate the envelopes from 
> this non-parametric model to then see if my observed data (that I used to generate the 
> stats for the energy function in the first place) fits into the envelope.

These functions are from the 'spatstat' package - but the question applies more generally.

> I find that the K, G and pcf of the observed data fits well within the envelopes of K, G and pcf
>  from the 99 simulated point patterns. However, I find that the F function of the observed is 
> slightly outside the envelope for the F from the simulations. My questions are:

> (i) If G, K and pcf (I acknowledge that K and pcf are related) fit into the envelope, then F should, should it not?

No, not necessarily. Different statistical procedures do not always agree when applied to the same data.

>  F(r) is the proportion of the nearest points in the point process that are less than r away from an
>  arbitrary point in the window. The K and G are related to some degree to this aren't they?

No, they come from the same circle of ideas but they are not directly related.
In some sense F is the 'opposite' of G. 

> (ii) How far out of the envelope is too far? I guess I am asking if the envelope test is a hard black/white 
> kind of rule or does one think of the context and justify how sincerely one must adhere to the envelope test 
> for these different summary statistics?

There are two basic kinds of envelopes: 'pointwise' and 'global', which have different statistical interpretations.

Assuming you used the spatstat function 'envelope' to generate the envelopes, the default is to produce a pointwise envelope.
The interpretation here is that, for a *fixed* value of distance r, the test rule which rejects the null hypothesis whenever the empirical curve
goes outside the critical boundary, has significance level alpha (usually alpha = 2/(nsim + 1)). 

If you use envelope() with global=TRUE, you get a global envelope. The interpretation is that the test rule which rejects the null
hypothesis if the empirical curve EVER goes outside the critical boundary for ANY value of distance r, has significance level alpha
(usually alpha = 1/(nsim+1)).

In your question, talking about the curve "fitting inside" the envelope, you effectively treated the envelope as if it was the 'global' kind.
This would be valid if you had set global=TRUE in the call to envelope.

This is explained in detail in the help file for 'envelope', or in the spatstat workshop notes (see www.spatstat.org)

Adrian Baddeley

 Prof Adrian Baddeley FAA
School of Earth & Environment                          |      CSIRO Mathematics, Informatics & Statistics
University of Western Australia                         |      Leeuwin Centre
35 Stirling Hwy, Crawley WA 6009, Australia    |      65 Brockway Rd, Floreat WA 6014, Australia
                                                        skype adrian.baddeley

From khenn_02 at uni-muenster.de  Thu Jan 31 12:28:25 2013
From: khenn_02 at uni-muenster.de (Katharina =?iso-8859-1?Q?Henneb=F6hl?=)
Date: Thu, 31 Jan 2013 12:28:25 +0100 (CET)
Subject: [R-sig-Geo] Problems with CondSimu() in RandomFields 2.0.59
Message-ID: <permail-20130131112825fe5316b6000025eb-khenn_02@message-id.uni-muenster.de>

Dear R-sig-geo list,

I am using the CondSimu() function in RandomFields for performance tests on
conditional simulation - in particular the circulant embedding method.
Unfortunately I am getting strange results when using the current RandomFields
version 2.0.59. The code is attached below. I have tested it on Windows 7 (R
2.15.2) and Ubuntu 12.04 (R 2.15.1).
The first realization seems OK, all subsequent realizations not. Has anybody
an idea what is going wrong?

The code produces valid simulations when using RandomFields version 1.3.47
(Feb 2011).

Thanks and best wishes,
Katharina Henneb?hl

Institute for Geoinformatics (ifgi)
University of Muenster
Weseler Str. 253
48151 M?nster
Germany


# RandomFields 2.0.59
library(RandomFields)

m = 100 # simulation grid 100 x 100
n = 144 # number of data points

# covariance model, assume mean 0, var 1, nugget 0, range 10)
param <- c(0, 1, 0, 10)
model <- "exponential"

# simulation locations
x <-  seq(1, m, by=1)
y <-  seq(1, m, by=1)

# some gridded data locations, gridded is required for circulant embedding
xdata = c(8, 16, 24, 32, 40, 48, 56, 64, 72, 80, 88, 96)
ydata = c(8, 16, 24, 32, 40, 48, 56, 64, 72, 80, 88, 96)
given = expand.grid(xdata, ydata)

# (uncorrelated) dummy data
data <- rnorm(n)

# an extreme data value that we can 'see' in the plot
data[15]=10 # location in data grid row 24 and column 16

# conditioning using simple kriging
krige.method <- "S"

# generating 50 conditional simulations
cz <- CondSimu(krige.method, x, y, n=50, given=given,method="circulant
embedding", grid=TRUE, model=model, param=param,data=data)

# the first realization seems correct
image(cz[,,1])
cz[,,1][24,16] # extreme data point
# the 2nd realization not
image(cz[,,2])
cz[,,2][24,16] # extreme data point
# the 10th realization not
image(cz[,,10])
cz[,,10][24,16] # extreme data point


From arudolph at PIRE.org  Thu Jan 31 14:03:36 2013
From: arudolph at PIRE.org (Abby Rudolph)
Date: Thu, 31 Jan 2013 08:03:36 -0500
Subject: [R-sig-Geo] converting latitude and longitude to UTM
In-Reply-To: <497BE0E36D19BC4F8580C74E9E7749A94EA4940A3B@MDMBX.PIRE.org>
References: <497BE0E36D19BC4F8580C74E9E7749A94EA4940A3B@MDMBX.PIRE.org>
Message-ID: <0F5A69EADAE27F44B09561937B83C3A45954AC641F@MDMBX.PIRE.org>

Hello,

I am using the following code to create ppp files from csv data and map shape files, but I am getting some errors which I have been unable to fix by searching them online:

library(spatstat)
library(maps)
library(maptools)

NYC2<-readShapePoly("nybb.shp") # this is a map of the NYC boroughs without waterways and no census tract divisions (but it does include lines separating the 5 boroughs)
plot(NYC2)

NYBorough<-readShapePoly("NYBoroughsShapeMerge.shp") # this is a map of the NYC boroughs with census tract divisions
plot(NYBorough)

myfile<-read.csv("myfile.csv")
# my csv file contains 4 columns (ID, variable_type, X, Y)
# my goal is to determine whether individuals of variable_type=1 are spatially distributed more than what would be expected due to chance, if individuals of variable_type=0 are spatially distributed more than what would be expected due to chance, and finally if the spatial distribution of variable_type=1 differs from that of variable_type=0.

x<-NYBorough at polygons[[1]]@Polygons
# ppp(x.coordinates, y.coordinates, x.range, y.range)
coords<-slot(x[[1]],"coords")
coords
coords<-coords[19:1,]
coords<-coords[-1,]
coords

u<-myfile$type==0

Type_0<-ppp(myfile$X[u],myfile$Y[u],
                window=owin(poly=list(x=coords[,1],y=coords[,2])))
Type_1<-ppp(myfile$X[!u],myfile$Y[!u],
                window=owin(poly=list(x=coords[,1],y=coords[,2])))

ERROR Message:
Warning message:
In ppp(myfile$X[u], myfile$Y[u], window = owin(poly = list(x = coords[,  :
  217 points were rejected as lying outside the specified window
Warning message:
In ppp(myfile$X[!u], myfile$Y[!u], window = owin(poly = list(x = coords[,  :
  435 points were rejected as lying outside the specified window

# I only have 652 points, so all of my points are rejected as lying outside the specified window


Below is the sample code I was using as a template:

x<-BaltCity2 at polygons[[1]]@Polygons
coords<-slot(x[[1]],"coords")
coords<-coords[167:1,]
coords<-coords[-1,]
coords.mi<-coords*0.000621371192
# convert meters to miles

play2<-ppp(play$X_m*0.000621371192,play$Y_m*0.000621371192,
           window=owin(poly=list(x=coords.mi[,1],y=coords.mi[,2])))

There are two things I can think of that might be different between my data set and the data that is used for this template code - and might cause the warning:
1) My shapefile is for NYC and includes 5 different boroughs, whereas the shapefile for Baltimore looks more like a regular polygon (like a rectangle).
2) My data has only lat/lon coordinates and the data corresponding with the template code I am working off of is using what I think is UTM (X_m and Y_m).

Is there another way I can run the code above that will utilize the latitude and longitude coordinates and will not return a warning?

Thanks,
Abby
________________________________________
From: Abby Rudolph
Sent: Wednesday, January 30, 2013 2:54 PM
To: r-sig-geo at r-project.org
Subject: converting latitude and longitude to UTM

Hello,
Is there a formula to convert x-/y-coordinates (latitude /longitude) into UTM.  My data is in the form of latitude and longitude, but the code I wish to use relies on x_m and y_m which I believe are UTM measurements (x in meters and y in meters).
Thanks
Abby


From Anne.Reichmuth at dlr.de  Thu Jan 31 14:05:03 2013
From: Anne.Reichmuth at dlr.de (Anne.Reichmuth at dlr.de)
Date: Thu, 31 Jan 2013 13:05:03 +0000
Subject: [R-sig-Geo] probability predict by class
Message-ID: <6BD7933C26A7E84B93C0B10952E5CAE50A5C52B9@DLREXMBX01.intra.dlr.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130131/6c753375/attachment.pl>

From Anne.Reichmuth at dlr.de  Thu Jan 31 18:14:05 2013
From: Anne.Reichmuth at dlr.de (Anne.Reichmuth at dlr.de)
Date: Thu, 31 Jan 2013 17:14:05 +0000
Subject: [R-sig-Geo] probability predict by class
In-Reply-To: <CANtt_hys2wUptimw=v5=+q=VN00TYPrPNEZVYHsZq+LQ-TMnNg@mail.gmail.com>
References: <6BD7933C26A7E84B93C0B10952E5CAE501986AAF@DLREXMBX01.intra.dlr.de>
	<CANtt_hxWPDoqtMyZ2HfJMZnv0qPO_cfm34AwCb1vE=nKD_jMtw@mail.gmail.com>
	<6BD7933C26A7E84B93C0B10952E5CAE50A5C32A9@DLREXMBX01.intra.dlr.de>
	<CANtt_hys2wUptimw=v5=+q=VN00TYPrPNEZVYHsZq+LQ-TMnNg@mail.gmail.com>
Message-ID: <6BD7933C26A7E84B93C0B10952E5CAE50A5C62E2@DLREXMBX01.intra.dlr.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130131/8cd2ce14/attachment.pl>

From r.hijmans at gmail.com  Thu Jan 31 19:20:04 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 31 Jan 2013 10:20:04 -0800
Subject: [R-sig-Geo] probability predict by class
In-Reply-To: <6BD7933C26A7E84B93C0B10952E5CAE50A5C62E2@DLREXMBX01.intra.dlr.de>
References: <6BD7933C26A7E84B93C0B10952E5CAE501986AAF@DLREXMBX01.intra.dlr.de>
	<CANtt_hxWPDoqtMyZ2HfJMZnv0qPO_cfm34AwCb1vE=nKD_jMtw@mail.gmail.com>
	<6BD7933C26A7E84B93C0B10952E5CAE50A5C32A9@DLREXMBX01.intra.dlr.de>
	<CANtt_hys2wUptimw=v5=+q=VN00TYPrPNEZVYHsZq+LQ-TMnNg@mail.gmail.com>
	<6BD7933C26A7E84B93C0B10952E5CAE50A5C62E2@DLREXMBX01.intra.dlr.de>
Message-ID: <CANtt_hzz6=2f0eo3TiU2xzBfDzY+6gdxr6g9xX84Otqf2B4c2A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130131/af3dce9e/attachment.pl>

From Anne.Reichmuth at dlr.de  Thu Jan 31 19:25:26 2013
From: Anne.Reichmuth at dlr.de (Anne.Reichmuth at dlr.de)
Date: Thu, 31 Jan 2013 18:25:26 +0000
Subject: [R-sig-Geo] probability predict by class
In-Reply-To: <CANtt_hzz6=2f0eo3TiU2xzBfDzY+6gdxr6g9xX84Otqf2B4c2A@mail.gmail.com>
References: <6BD7933C26A7E84B93C0B10952E5CAE501986AAF@DLREXMBX01.intra.dlr.de>
	<CANtt_hxWPDoqtMyZ2HfJMZnv0qPO_cfm34AwCb1vE=nKD_jMtw@mail.gmail.com>
	<6BD7933C26A7E84B93C0B10952E5CAE50A5C32A9@DLREXMBX01.intra.dlr.de>
	<CANtt_hys2wUptimw=v5=+q=VN00TYPrPNEZVYHsZq+LQ-TMnNg@mail.gmail.com>
	<6BD7933C26A7E84B93C0B10952E5CAE50A5C62E2@DLREXMBX01.intra.dlr.de>
	<CANtt_hzz6=2f0eo3TiU2xzBfDzY+6gdxr6g9xX84Otqf2B4c2A@mail.gmail.com>
Message-ID: <6BD7933C26A7E84B93C0B10952E5CAE50A5C631E@DLREXMBX01.intra.dlr.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130131/e6b8c55b/attachment.pl>

From ppanday at clarku.edu  Thu Jan 31 20:21:26 2013
From: ppanday at clarku.edu (ppanday)
Date: Thu, 31 Jan 2013 11:21:26 -0800 (PST)
Subject: [R-sig-Geo] Rasterbrick to netCDF
In-Reply-To: <CANtt_hyHM0wwGMeJxWHO6DptUvFTsm4tpe4GHDDqdiJxgLzipQ@mail.gmail.com>
References: <1359064489341-7582376.post@n2.nabble.com>
	<1359081476.24921.YahooMailNeo@web121903.mail.ne1.yahoo.com>
	<CANtt_hyHM0wwGMeJxWHO6DptUvFTsm4tpe4GHDDqdiJxgLzipQ@mail.gmail.com>
Message-ID: <C3A65516E00A294DA9B1DBF9474A0EA63FBB2342@CH1PRD0310MB356.namprd03.prod.outlook.com>

Robert

Yes, the ncdf4 packages works fine. However, it seems it runs in the unix environment currently. Thank you for your response.

Sincerely,
Prajjwal
________________________________
From: Robert Hijmans [via R-sig-geo] [ml-node+s2731867n7582433h43 at n2.nabble.com]
Sent: Wednesday, January 30, 2013 7:57 PM
To: Panday, Prajjwal
Subject: Re: Rasterbrick to netCDF

Prajjwal,
As Thiago shows you can do such things directly via the ncdf(4) package;
raster does not provide too many options beyond setting variable names
(arguments varname, varunit, longname, xname, yname, zname, zunit), see
?writeRaster. It would be nice to expand that and allow for more flexible
ncdf file writing from Raster objects.
Robert


On Thu, Jan 24, 2013 at 6:37 PM, Thiago V. dos Santos <
[hidden email]<UrlBlockedError.aspx>> wrote:

> Hi Prajjwal,
>
> I think the best approach in your case is to create a new, updated netcd
> file instead of adding a dimension to an existing file. By using the ncdf4
> package to create the file, you have lots of options to customize names and
> descriptions of variables and dimensions.
>
> At the end of this message you can see the code that I use to create a
> netcdf file with global coverage at 0.5 degree resolution based obviously
> on a netcdf with the same features. The resulting netcdf will contain one
> level "slice" and 12 time "slices". One detail about netcdf files is that
> the coordinates of point refers to the center of the point and not to the
> edge. That's why I start longitude at -179.75 instead of -180 and longitude
> at 89.75 instead of 90.
>
> If the resulting file looks like longitude and latitude are inverted, you
> must transpose the data when converting raster to matrix:
> data <- t(as.matrix(r))
>
>
> I hope it helps,
>
> Thiago.
>
> #--------------------------------------------------------begin of
> code-----------------------------------------------------
>
> # Load required packages
> library(raster)
> library(ncdf4)
>
> # Load your data
> r <- raster('old_file.nc')
>
> # Here's the trick: convert your data to a matrix
> data <- as.matrix(r)
>
> # Now that we have the data we need, make output file in the correct format
>
> # Create dimensions lon, lat, level and time
> dim_lon  <- ncdim_def('longitude', 'degrees_east',
> seq(-179.75,179.75,by=0.5))
> dim_lat  <- ncdim_def('latitude', 'degrees_north',
> seq(89.75,-89.75,by=-0.5))
> dim_lev  <- ncdim_def('level', 'level/index', 1)
> dim_time <- ncdim_def('time', "years since 1990-01-01", 1:12, unlim=T)
>
> # Create a new variable "precipitation", create netcdf file, put updated
> contents on it and close file
> # Note that variable "data" is the actual contents of the original netcdf
> file
> var_out <- ncvar_def('precipitation', 'mm/day',
> list(dim_lon,dim_lat,dim_lev,dim_time), 9.e20)
> ncid_out <- nc_create('updated_netcdf.nc', var_out)
> ncvar_put(ncid_out, var_out, data, start=c(1, 1, 1, 1), count=c(720, 360,
> 1, 12))
> nc_close(ncid_out)
> #--------------------------------------------------------end of
> code-----------------------------------------------------
>
>
> ----- Original Message -----
> From: ppanday <[hidden email]<UrlBlockedError.aspx>>
> To: [hidden email]<UrlBlockedError.aspx>
> Cc:
> Sent: Thursday, January 24, 2013 3:54 PM
> Subject: [R-sig-Geo] Rasterbrick to netCDF
>
> Hello
>
> I have an output from R-script in the form of a rasterbrick with 3
> dimensions (time, latitude, longitude). I want to be able to write it to a
> netCDF format, add another dimension (time, level, latitude, longitude),
> and
> be able to edit dimension attributes.
> Below you will see the properties when I write my rasterbrick to a netCDF
> format using writeRaster.
> I would like to change 'value' dimension to time, and edit time:units as
> well.
> Alternatively, is there a way I can copy dimensions and attributes from
> another netCDF template and put my rasterbrick in that empty netCDF file?
> Any help is greatly appreciated.
>
> Sincerely,
> Prajjwal
>
>
> dimensions:
>     longitude = 720 ;
>     latitude = 360 ;
>     value = UNLIMITED ; // (12 currently)
> variables:
>     double longitude(longitude) ;
>         longitude:units = "degrees_east" ;
>         longitude:long_name = "longitude" ;
>     double latitude(latitude) ;
>         latitude:units = "degrees_north" ;
>         latitude:long_name = "latitude" ;
>     int value(value) ;
>         value:units = "unknown" ;
>         value:long_name = "value" ;
>     float prec(value, latitude, longitude) ;
>         prec:_FillValue = -3.4e+38 ;
>         prec:missing_value = -3.4e+38 ;
>         prec:long_name = "prec" ;
>         prec:projection = "+proj=longlat +datum=WGS84 +ellps=WGS84
> +towgs84=0,0,0"
> ;
>         prec:projection_format = "PROJ.4" ;
>         prec:min = 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0. ;
>         prec:max = 663.033325195312, 553.867553710938, 595.225219726562,
> 577.460388183594, 688.026123046875, 1178.05859375, 1098.39819335938,
> 1269.41442871094, 1184.70092773438, 1013.62524414062, 755.313537597656,
> 633.667541503906 ;
>
> // global attributes:
>         :Conventions = "CF-1.4" ;
>         :created_by = "R, packages ncdf and raster (version 2.0-31)" ;
>         :date = "2013-01-24 15:58:09" ;
>
>
>
>
>
>
>
> --
> View this message in context:
> http://r-sig-geo.2731867.n2.nabble.com/Rasterbrick-to-netCDF-tp7582376.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> [hidden email]<UrlBlockedError.aspx>
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
> _______________________________________________
> R-sig-Geo mailing list
> [hidden email]<UrlBlockedError.aspx>
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
[hidden email]<UrlBlockedError.aspx>
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


________________________________
If you reply to this email, your message will be added to the discussion below:
http://r-sig-geo.2731867.n2.nabble.com/Rasterbrick-to-netCDF-tp7582376p7582433.html
To unsubscribe from Rasterbrick to netCDF, click here<http://r-sig-geo.2731867.n2.nabble.com/template/NamlServlet.jtp?macro=unsubscribe_by_code&node=7582376&code=cHBhbmRheUBjbGFya3UuZWR1fDc1ODIzNzZ8LTEwMDM2MDU1Njk=>.
NAML<http://r-sig-geo.2731867.n2.nabble.com/template/NamlServlet.jtp?macro=macro_viewer&id=instant_html%21nabble%3Aemail.naml&base=nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.view.web.template.NodeNamespace&breadcrumbs=notify_subscribers%21nabble%3Aemail.naml-instant_emails%21nabble%3Aemail.naml-send_instant_email%21nabble%3Aemail.naml>




--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Rasterbrick-to-netCDF-tp7582376p7582443.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From r.hijmans at gmail.com  Thu Jan 31 22:04:12 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 31 Jan 2013 13:04:12 -0800
Subject: [R-sig-Geo] Rasterbrick to netCDF
In-Reply-To: <C3A65516E00A294DA9B1DBF9474A0EA63FBB2342@CH1PRD0310MB356.namprd03.prod.outlook.com>
References: <1359064489341-7582376.post@n2.nabble.com>
	<1359081476.24921.YahooMailNeo@web121903.mail.ne1.yahoo.com>
	<CANtt_hyHM0wwGMeJxWHO6DptUvFTsm4tpe4GHDDqdiJxgLzipQ@mail.gmail.com>
	<C3A65516E00A294DA9B1DBF9474A0EA63FBB2342@CH1PRD0310MB356.namprd03.prod.outlook.com>
Message-ID: <CANtt_hxyWfwpn2gxCazmUigE7gzECTJz2itz29nEzCowBZQfjg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130131/cb734e05/attachment.pl>

From ppanday at clarku.edu  Thu Jan 31 22:51:00 2013
From: ppanday at clarku.edu (ppanday)
Date: Thu, 31 Jan 2013 13:51:00 -0800 (PST)
Subject: [R-sig-Geo] Rasterbrick to netCDF
In-Reply-To: <CANtt_hxyWfwpn2gxCazmUigE7gzECTJz2itz29nEzCowBZQfjg@mail.gmail.com>
References: <1359064489341-7582376.post@n2.nabble.com>
	<1359081476.24921.YahooMailNeo@web121903.mail.ne1.yahoo.com>
	<CANtt_hyHM0wwGMeJxWHO6DptUvFTsm4tpe4GHDDqdiJxgLzipQ@mail.gmail.com>
	<C3A65516E00A294DA9B1DBF9474A0EA63FBB2342@CH1PRD0310MB356.namprd03.prod.outlook.com>
	<CANtt_hxyWfwpn2gxCazmUigE7gzECTJz2itz29nEzCowBZQfjg@mail.gmail.com>
Message-ID: <C3A65516E00A294DA9B1DBF9474A0EA63FBB23F1@CH1PRD0310MB356.namprd03.prod.outlook.com>

Robert,

The ncdf4 through David Pierce's site seems incompatible with R version 2.15.2.
( package ?C:/Data/Downloads/ncdf4_1.4.zip? is not available (for R version 2.15.2).
Is there an alternate way to get it for R 32 bit windows? Or is it easier to switch my code to ncdf package?

Prajjwal
________________________________
From: Robert Hijmans [via R-sig-geo] [ml-node+s2731867n7582444h84 at n2.nabble.com]
Sent: Thursday, January 31, 2013 4:04 PM
To: Panday, Prajjwal
Subject: Re: Rasterbrick to netCDF

Prajjwal, you can install ncdf4 on windows (not from CRAN, but from here
http://cirrus.ucsd.edu/~pierce/ncdf/ ) but it may be easier to use the ncdf
library instead. Robert

On Thu, Jan 31, 2013 at 11:21 AM, ppanday <[hidden email]<UrlBlockedError.aspx>> wrote:

> Robert
>
> Yes, the ncdf4 packages works fine. However, it seems it runs in the unix
> environment currently. Thank you for your response.
>
> Sincerely,
> Prajjwal
> ________________________________
> From: Robert Hijmans [via R-sig-geo] [
> [hidden email]<UrlBlockedError.aspx>]
> Sent: Wednesday, January 30, 2013 7:57 PM
> To: Panday, Prajjwal
> Subject: Re: Rasterbrick to netCDF
>
> Prajjwal,
> As Thiago shows you can do such things directly via the ncdf(4) package;
> raster does not provide too many options beyond setting variable names
> (arguments varname, varunit, longname, xname, yname, zname, zunit), see
> ?writeRaster. It would be nice to expand that and allow for more flexible
> ncdf file writing from Raster objects.
> Robert
>
>
> On Thu, Jan 24, 2013 at 6:37 PM, Thiago V. dos Santos <
> [hidden email]<UrlBlockedError.aspx>> wrote:
>
> > Hi Prajjwal,
> >
> > I think the best approach in your case is to create a new, updated netcd
> > file instead of adding a dimension to an existing file. By using the
> ncdf4
> > package to create the file, you have lots of options to customize names
> and
> > descriptions of variables and dimensions.
> >
> > At the end of this message you can see the code that I use to create a
> > netcdf file with global coverage at 0.5 degree resolution based obviously
> > on a netcdf with the same features. The resulting netcdf will contain one
> > level "slice" and 12 time "slices". One detail about netcdf files is that
> > the coordinates of point refers to the center of the point and not to the
> > edge. That's why I start longitude at -179.75 instead of -180 and
> longitude
> > at 89.75 instead of 90.
> >
> > If the resulting file looks like longitude and latitude are inverted, you
> > must transpose the data when converting raster to matrix:
> > data <- t(as.matrix(r))
> >
> >
> > I hope it helps,
> >
> > Thiago.
> >
> > #--------------------------------------------------------begin of
> > code-----------------------------------------------------
> >
> > # Load required packages
> > library(raster)
> > library(ncdf4)
> >
> > # Load your data
> > r <- raster('old_file.nc')
> >
> > # Here's the trick: convert your data to a matrix
> > data <- as.matrix(r)
> >
> > # Now that we have the data we need, make output file in the correct
> format
> >
> > # Create dimensions lon, lat, level and time
> > dim_lon  <- ncdim_def('longitude', 'degrees_east',
> > seq(-179.75,179.75,by=0.5))
> > dim_lat  <- ncdim_def('latitude', 'degrees_north',
> > seq(89.75,-89.75,by=-0.5))
> > dim_lev  <- ncdim_def('level', 'level/index', 1)
> > dim_time <- ncdim_def('time', "years since 1990-01-01", 1:12, unlim=T)
> >
> > # Create a new variable "precipitation", create netcdf file, put updated
> > contents on it and close file
> > # Note that variable "data" is the actual contents of the original netcdf
> > file
> > var_out <- ncvar_def('precipitation', 'mm/day',
> > list(dim_lon,dim_lat,dim_lev,dim_time), 9.e20)
> > ncid_out <- nc_create('updated_netcdf.nc', var_out)
> > ncvar_put(ncid_out, var_out, data, start=c(1, 1, 1, 1), count=c(720, 360,
> > 1, 12))
> > nc_close(ncid_out)
> > #--------------------------------------------------------end of
> > code-----------------------------------------------------
> >
> >
> > ----- Original Message -----
> > From: ppanday <[hidden email]<UrlBlockedError.aspx>>
> > To: [hidden email]<UrlBlockedError.aspx>
> > Cc:
> > Sent: Thursday, January 24, 2013 3:54 PM
> > Subject: [R-sig-Geo] Rasterbrick to netCDF
> >
> > Hello
> >
> > I have an output from R-script in the form of a rasterbrick with 3
> > dimensions (time, latitude, longitude). I want to be able to write it to
> a
> > netCDF format, add another dimension (time, level, latitude, longitude),
> > and
> > be able to edit dimension attributes.
> > Below you will see the properties when I write my rasterbrick to a netCDF
> > format using writeRaster.
> > I would like to change 'value' dimension to time, and edit time:units as
> > well.
> > Alternatively, is there a way I can copy dimensions and attributes from
> > another netCDF template and put my rasterbrick in that empty netCDF file?
> > Any help is greatly appreciated.
> >
> > Sincerely,
> > Prajjwal
> >
> >
> > dimensions:
> >     longitude = 720 ;
> >     latitude = 360 ;
> >     value = UNLIMITED ; // (12 currently)
> > variables:
> >     double longitude(longitude) ;
> >         longitude:units = "degrees_east" ;
> >         longitude:long_name = "longitude" ;
> >     double latitude(latitude) ;
> >         latitude:units = "degrees_north" ;
> >         latitude:long_name = "latitude" ;
> >     int value(value) ;
> >         value:units = "unknown" ;
> >         value:long_name = "value" ;
> >     float prec(value, latitude, longitude) ;
> >         prec:_FillValue = -3.4e+38 ;
> >         prec:missing_value = -3.4e+38 ;
> >         prec:long_name = "prec" ;
> >         prec:projection = "+proj=longlat +datum=WGS84 +ellps=WGS84
> > +towgs84=0,0,0"
> > ;
> >         prec:projection_format = "PROJ.4" ;
> >         prec:min = 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0. ;
> >         prec:max = 663.033325195312, 553.867553710938, 595.225219726562,
> > 577.460388183594, 688.026123046875, 1178.05859375, 1098.39819335938,
> > 1269.41442871094, 1184.70092773438, 1013.62524414062, 755.313537597656,
> > 633.667541503906 ;
> >
> > // global attributes:
> >         :Conventions = "CF-1.4" ;
> >         :created_by = "R, packages ncdf and raster (version 2.0-31)" ;
> >         :date = "2013-01-24 15:58:09" ;
> >
> >
> >
> >
> >
> >
> >
> > --
> > View this message in context:
> >
> http://r-sig-geo.2731867.n2.nabble.com/Rasterbrick-to-netCDF-tp7582376.html
> > Sent from the R-sig-geo mailing list archive at Nabble.com.
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > [hidden email]<UrlBlockedError.aspx>
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > [hidden email]<UrlBlockedError.aspx>
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> [hidden email]<UrlBlockedError.aspx>
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
> ________________________________
> If you reply to this email, your message will be added to the discussion
> below:
>
> http://r-sig-geo.2731867.n2.nabble.com/Rasterbrick-to-netCDF-tp7582376p7582433.html
> To unsubscribe from Rasterbrick to netCDF, click here<
> >.
> NAML<
> <UrlBlockedError.aspx> http://r-sig-geo.2731867.n2.nabble.com/template/NamlServlet.jtp?macro=macro_viewer&id=instant_html%21nabble%3Aemail.naml&base=nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.view.web.template.NodeNamespace&breadcrumbs=notify_subscribers%21nabble%3Aemail.naml-instant_emails%21nabble%3Aemail.naml-send_instant_email%21nabble%3Aemail.naml
> >
>
>
>
>
> --
> View this message in context:
> http://r-sig-geo.2731867.n2.nabble.com/Rasterbrick-to-netCDF-tp7582376p7582443.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> [hidden email]<UrlBlockedError.aspx>
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
[hidden email]<UrlBlockedError.aspx>
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


________________________________
If you reply to this email, your message will be added to the discussion below:
http://r-sig-geo.2731867.n2.nabble.com/Rasterbrick-to-netCDF-tp7582376p7582444.html
To unsubscribe from Rasterbrick to netCDF, click here<http://r-sig-geo.2731867.n2.nabble.com/template/NamlServlet.jtp?macro=unsubscribe_by_code&node=7582376&code=cHBhbmRheUBjbGFya3UuZWR1fDc1ODIzNzZ8LTEwMDM2MDU1Njk=>.
NAML<http://r-sig-geo.2731867.n2.nabble.com/template/NamlServlet.jtp?macro=macro_viewer&id=instant_html%21nabble%3Aemail.naml&base=nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.view.web.template.NodeNamespace&breadcrumbs=notify_subscribers%21nabble%3Aemail.naml-instant_emails%21nabble%3Aemail.naml-send_instant_email%21nabble%3Aemail.naml>




--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Rasterbrick-to-netCDF-tp7582376p7582445.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From r.hijmans at gmail.com  Thu Jan 31 23:07:08 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 31 Jan 2013 14:07:08 -0800
Subject: [R-sig-Geo] Failure during raster IO
In-Reply-To: <CAPD=AxpFNas=+yxg_cUK9-+GXT6s4ED6GBaswKtah-WiRmRmhQ@mail.gmail.com>
References: <CAPD=AxpFNas=+yxg_cUK9-+GXT6s4ED6GBaswKtah-WiRmRmhQ@mail.gmail.com>
Message-ID: <CANtt_hxEcK7FPxrjDUQXTO4vFQHsKsDW6JfDmkD+jjOVs_VfrA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20130131/db46d700/attachment.pl>

From klborgmann at gmail.com  Thu Jan 31 23:41:22 2013
From: klborgmann at gmail.com (klborgmann)
Date: Thu, 31 Jan 2013 14:41:22 -0800 (PST)
Subject: [R-sig-Geo] Failure during raster IO
In-Reply-To: <CANtt_hxEcK7FPxrjDUQXTO4vFQHsKsDW6JfDmkD+jjOVs_VfrA@mail.gmail.com>
References: <CAPD=AxpFNas=+yxg_cUK9-+GXT6s4ED6GBaswKtah-WiRmRmhQ@mail.gmail.com>
	<CANtt_hxEcK7FPxrjDUQXTO4vFQHsKsDW6JfDmkD+jjOVs_VfrA@mail.gmail.com>
Message-ID: <1359672082466-7582447.post@n2.nabble.com>

Thanks Robert!
That did eliminate the Failure during raster IO
I am following your example vignette for SDM (page 31) and have several
raster layers with wetland attributes that have different extents.  It seems
that in order to stack rasters they have to be the same extent, hence why I
was trying to change the extents of the rasters.  Is there a better method
for combining rasters with different extents to allow for spatial
predictions based on a glm model? My model has three wetland attributes and
I have a raster layer for each wetland attribute. 
Thanks Again!!
-Kathi



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Failure-during-raster-IO-tp7582421p7582447.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


