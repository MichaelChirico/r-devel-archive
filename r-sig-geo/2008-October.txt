From hzambran.newsgroups at gmail.com  Thu Oct  2 10:55:22 2008
From: hzambran.newsgroups at gmail.com (Mauricio Zambrano)
Date: Thu, 2 Oct 2008 10:55:22 +0200
Subject: [R-sig-Geo] Question about temporal Kriging
Message-ID: <63d616b0810020155j6edf2de3rddc656553b2fa723@mail.gmail.com>

Dear list,

I'll really appreciate any ideas/comments about the following situation:

I need to carry out some spatial interpolations of daily precipitation
on several catchments, using point measurements (rain gauges).

The precipitation regime is quite different between the northern part
of the catchments and the southern one, and among seasons (summer,
winter)

In principle, I guess that one (not optimal) way of doing this is to
select one variogram for each day and use it for carrying out the
interpolations on that day. However, my problem is that I need to do
that for 30 years (~11000 days), an it would be a very time-consuming
task.

I've heard that Bayesian Maximum Entropy (so far, I don't have
knowledge on this field) is appropriate for tackling this situation,
but I haven't found an R package for doing BME interpolations.

At the other hand, I was thinking on probably fit a spatio-temporal
regression model for interpolating the daily precipitation at
different times, and then analyse the residuals with OK or UK, using
the time as a third dimension in gstat.

However, regarding to the last approach I have some questions:

-) What should be the minimum number of points in each time step for
obtaining a meaningful 3D semivariogram ?.
-) What should be the time scale used as third dimension ?. The xy
coordinates are in UTM (~6000000, ~400000). If the time coordinate
varies within [0, ~11000], will the analysis suffer of numerical
problems due to differences in magnitudes among the 3 dimensions ?.

Could you suggest any other practical way of tackling this problem ?.

Thanks in advance,

Mauricio Zambrano B.
-- 
?============================================
Ph.D. Candidate,
Dept. of Civil and Env. Engineering
University of Trento, Italy
=============================================
Linux user #454569 -- Ubuntu user #17469
=============================================
"Predicting the future is hard,
especially if it hasn't happened yet"
(Yogi Berra)

From Gema.FAviles at uclm.es  Thu Oct  2 11:25:24 2008
From: Gema.FAviles at uclm.es (GEMA FERNANDEZ-AVILES CALDERON)
Date: Thu, 2 Oct 2008 11:25:24 +0200
Subject: [R-sig-Geo] Doubts about kriging
Message-ID: <BFE1525242E7DA4B9CBBDE2CF4DDBBFB41B619@EVSAB01.uclm.es>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081002/21e6c149/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Thu Oct  2 11:45:20 2008
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Thu, 2 Oct 2008 10:45:20 +0100
Subject: [R-sig-Geo] Open Source GeoSpatial Software Course
Message-ID: <d8ad40b50810020245y6900d613hb6ebe7429e6b3dbf@mail.gmail.com>

Hi All,

 we're running a two-day course on Open Source Geospatial Software
here in sunny Lancaster, UK, in November. It will cover the basics of
open standards and mapping, spatial analysis with R, desktop GIS, and
web-mapping.

 Details, and a print-out-and-paste-up PDF poster are here:

http://www.maths.lancs.ac.uk/~rowlings/Teaching/OSgeo/

 thanks in advance to anyone for circulating this amongst interested parties!

Barry



From rroa at udec.cl  Thu Oct  2 14:09:28 2008
From: rroa at udec.cl (=?ISO-8859-1?Q?Rub=E9n_Roa-Ureta?=)
Date: Thu, 02 Oct 2008 08:09:28 -0400
Subject: [R-sig-Geo] Doubts about kriging
In-Reply-To: <BFE1525242E7DA4B9CBBDE2CF4DDBBFB41B619@EVSAB01.uclm.es>
References: <BFE1525242E7DA4B9CBBDE2CF4DDBBFB41B619@EVSAB01.uclm.es>
Message-ID: <48E4B9F8.9090103@udec.cl>

GEMA FERNANDEZ-AVILES CALDERON wrote:

> Dear list,
>  
> I have two problem and I would like to know you opinion.
>  
> 1.  I am kriging 6 environmental variables, SO2, NOx, O3, CO, NO, 
> PM10, to built and enviromental index in R. I have standardized the 
> observed values and I am implementing in geoR  the function likfit to 
> obtain the parameter lambda (Box-Cox transformation) to see if the 
> standarized variables are normal. But I have error using the likfit 
> function. It could be that the error arise because the standarized 
> variables contain negative values?
>   
You have to tell us what the error message says. The negative values of 
your variable should not be the problem.
Another thing. The lambda parameter is there not to 'see' if the 
regionalised variable is normal. The lambda parameter is there to *make* 
the regionalised variable as close to normal as possible.

>  
> 2. I have values of the 6 variables at 25 locations but I want to use 
> a linear combination of the six variables to deal with only a 
> variable. Finally, I want to interpolate this only variable in several 
> sites where I have not observed data. What do you think is better? - 
> To interpolate each one of the six variables and then elaborate the 
> linear combination.
> - Or to elaborate a linear combination with the observed values and 
> finally krige the linear combination.
>   
If the variables are correlated you can use your first option doing a 
principal component analysis, and then kriging the first component.
HTH
R.



From ashton at msu.edu  Thu Oct  2 15:25:09 2008
From: ashton at msu.edu (Ashton Shortridge)
Date: Thu, 2 Oct 2008 09:25:09 -0400
Subject: [R-sig-Geo] Doubts about kriging
In-Reply-To: <BFE1525242E7DA4B9CBBDE2CF4DDBBFB41B619@EVSAB01.uclm.es>
References: <BFE1525242E7DA4B9CBBDE2CF4DDBBFB41B619@EVSAB01.uclm.es>
Message-ID: <200810020925.09825.ashton@msu.edu>

On Thursday 02 October 2008, GEMA FERNANDEZ-AVILES CALDERON wrote:
> Dear list,
>
> I have two problem and I would like to know you opinion.
>
> 1.  I am kriging 6 environmental variables, SO2, NOx, O3, CO, NO, PM10, to
> built and enviromental index in R. I have standardized the observed values
> and I am implementing in geoR  the function likfit to obtain the parameter
> lambda (Box-Cox transformation) to see if the standarized variables are
> normal. But I have error using the likfit function. It could be that the
> error arise because the standarized variables contain negative values?
>
> 2. I have values of the 6 variables at 25 locations but I want to use a
> linear combination of the six variables to deal with only a variable.
> Finally, I want to interpolate this only variable in several sites where I
> have not observed data. What do you think is better?
> - To interpolate each one of the six variables and then elaborate the
> linear combination. - Or to elaborate a linear combination with the
> observed values and finally krige the linear combination.
>
> Thanks in advance,
> Gema Fern?ndez-Avil?s
>
> Universidad de Castilla-La Mancha.
> (Spain)
>
>
> 	[[alternative HTML version deleted]]

Hi,

Dodging your questions a bit, but I have some concerns and/or issues for your 
consideration:

1. 25 locations is very small for kriging, unless you have some other means to 
develop your spatial covariance models. Perhaps you mean that the 6 variables 
are collocated at only 25 locations, but you have other sites with fewer than 
all 6? If not - if all you have are 25 sites with six variables each - I 
wouldn't attempt kriging in any form.

2. Actually I think 25 is pretty small for the multivariate analysis you 
propose as well. 

3. With respect to your point 2, I would develop the linear combination with 
the real data, not on a bunch of interpolated 'data'. Standard methods of 
combining the variables will assume that the observations are independent; if 
they aren't then the model will be flawed, so be cautious of that.

Hope this helps,

Ashton

-- 
Ashton Shortridge
Associate Professor			ashton at msu.edu
Dept of Geography			http://www.msu.edu/~ashton
235 Geography Building		ph (517) 432-3561
Michigan State University		fx (517) 432-1671



From galvis at illinois.edu  Thu Oct  2 15:37:13 2008
From: galvis at illinois.edu (Luis Galvis)
Date: Thu, 2 Oct 2008 08:37:13 -0500
Subject: [R-sig-Geo] workshop "Advances in Spatial Regression Analysis"
Message-ID: <67460d080810020637h57fe303dvded9b5c074867e99@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081002/9a61e010/attachment.pl>

From milton.ruser at gmail.com  Thu Oct  2 23:12:35 2008
From: milton.ruser at gmail.com (milton ruser)
Date: Thu, 2 Oct 2008 19:12:35 -0200
Subject: [R-sig-Geo] spliting lines on equal-space points.
Message-ID: <3aaf1a030810021412o7cc40a47n217010f41be93876@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081002/39e4f385/attachment.pl>

From Roger.Bivand at nhh.no  Fri Oct  3 09:12:11 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 3 Oct 2008 09:12:11 +0200 (CEST)
Subject: [R-sig-Geo] spliting lines on equal-space points.
In-Reply-To: <3aaf1a030810021412o7cc40a47n217010f41be93876@mail.gmail.com>
References: <3aaf1a030810021412o7cc40a47n217010f41be93876@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0810030903440.10503@reclus.nhh.no>

On Thu, 2 Oct 2008, milton ruser wrote:

> Dear all,
> I have a shapefile with line features (like for example drainage),
> and I need to generate another shape with points using
> the features from the first shape.
>
> But the points is not the points that I can get from the lines.
> I need, for example, define that I want one point each 50 meters,
> and the points have ~ 50 meters of space between other points
> if we follow the "flow" of drainage.
>
> I wrote this simple code to try short the time for helpers.
>
> library(maptools)
>
> xx <- readShapeLines(system.file("shapes/fylk-val.shp",
> package="maptools")[1],
>    proj4string=CRS("+proj=utm +zone=33 +datum=WGS84"))
> plot(xx, col="blue", axes=T)
>
> xx.selectone<-xx[xx$VALINJE_==20,]
>
> plot(xx.selectone, col="red", add=T)

spsample(xx.selectone, n=82, type="regular")

gets you there directly - choose n either directly (here roughly one 
sample per km) or based on the object length:

sum(sapply(slot(xx.selectone, "lines"), function(x) sapply(slot(x,
   "Lines"), LineLength)))

Also see the spsurvey package for an industry-strength development of 
sampling in stream networks.

Roger

>
> Best wishes,
>
> miltinho astronauta
> brazil
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From juliane_struve at yahoo.co.uk  Fri Oct  3 14:02:50 2008
From: juliane_struve at yahoo.co.uk (Juliane Struve)
Date: Fri, 3 Oct 2008 12:02:50 +0000 (GMT)
Subject: [R-sig-Geo] Modifying a column in a Shapefile
Message-ID: <977412.38658.qm@web27205.mail.ukl.yahoo.com>

Dear list members,

I am using a grid called "MergedCentroids" in which I need to modify?entries in ?column?"NEARANGLE and write the result into a column?"NEARANG_R". I have tried to convert the Spatial Points Data Frame to a data frame in order to do this.?I want to convert the updated grid into a new shapefile at the end. This is my code so far:

MergedCentroids <- readOGR("Centroids_Merge.shp","Centroids_Merge")
write.table(MergedCentroids,file="MergedCentroids.csv",sep=",",row.names=F)
MC=read.csv("MergedCentroids.csv")
MCDF<-as.data.frame(MC) 
MCDF$NEARANG_R=ifelse(MCDF$NEARANGLE<0,MCDF$NEARANGLE+360,MCDF$NEARANG)
MCSPDF = SpatialPointsDataFrame(MCDF[,3:4],data.frame(MCDF[,1:16]))
write.pointShape(coordinates(MCSPDF),data.frame(MCSPDF),paste("NEWMCSPDF"))
?
After executing the last statement I get two error messages:
?
write.pointShape(coordinates(MCSPDF),data.frame(MCSPDF),paste("NEWMCSPDF"))
Error in write.dbf(df, paste(file, ".dbf", sep = ""), factor2char = factor2char,? :
? unable to open file
In addition: Warning message:
use writeSpatialShape:
objects other than Spatial objects defined in the sp package are deprecated
?
Would somebody be able to help ? 
?
Many thanks !
?
Juliane 


?Dr. Juliane Struve
Environmental Scientist
10, Lynwood Crescent
Sunningdale SL5 0BL
01344 620811







From Roger.Bivand at nhh.no  Fri Oct  3 14:33:44 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 3 Oct 2008 14:33:44 +0200 (CEST)
Subject: [R-sig-Geo] Modifying a column in a Shapefile
In-Reply-To: <977412.38658.qm@web27205.mail.ukl.yahoo.com>
References: <977412.38658.qm@web27205.mail.ukl.yahoo.com>
Message-ID: <Pine.LNX.4.64.0810031422060.11612@reclus.nhh.no>

On Fri, 3 Oct 2008, Juliane Struve wrote:

> Dear list members,
>
> I am using a grid called "MergedCentroids" in which I need to 
> modify?entries in ?column?"NEARANGLE and write the result into a 
> column?"NEARANG_R". I have tried to convert the Spatial Points Data 
> Frame to a data frame in order to do this.?I want to convert the updated 
> grid into a new shapefile at the end. This is my code so far:
>
> MergedCentroids <- readOGR("Centroids_Merge.shp","Centroids_Merge")
> write.table(MergedCentroids,file="MergedCentroids.csv",sep=",",row.names=F)
> MC=read.csv("MergedCentroids.csv")
> MCDF<-as.data.frame(MC)
> MCDF$NEARANG_R=ifelse(MCDF$NEARANGLE<0,MCDF$NEARANGLE+360,MCDF$NEARANG)
> MCSPDF = SpatialPointsDataFrame(MCDF[,3:4],data.frame(MCDF[,1:16]))
> write.pointShape(coordinates(MCSPDF),data.frame(MCSPDF),paste("NEWMCSPDF"))
> ?
> After executing the last statement I get two error messages:
> ?
> write.pointShape(coordinates(MCSPDF),data.frame(MCSPDF),paste("NEWMCSPDF"))
> Error in write.dbf(df, paste(file, ".dbf", sep = ""), factor2char = factor2char,? :
> ? unable to open file
> In addition: Warning message:
> use writeSpatialShape:
> objects other than Spatial objects defined in the sp package are deprecated
> ?
> Would somebody be able to help ?

Difficult to know where to start. If you had used a provided data set, it 
might have been easier.

First, to coerce to a data.frame, use as(), the coerce method:

MC <- as(MergedCentroids, "data.frame")

What actually got written to the CSV file probably resulted from coercion 
being invoked internally in write.table() - did you inspect the file?

Why not just operate on the MergedCentroids object?

MergedCentroids$NEARANG_R <- ifelse(MergedCentroids$NEARANGLE<0,
  MergedCentroids$NEARANGLE+360, MergedCentroids$NEARANG)

is quite OK. Why not then simply use:

writeOGR(MergedCentroids, "NEWMCSPDF", driver="ESRI Shapefile")

I can imagine that the input object is polygons not points, adding one 
possible extra level, and that the OGR driver does not handle dates 
gracefully, leading you to prefer writeSpatialShape() in maptools (using 
the improved write.dbf() in foreign), but not much more reason for the 
complications you introduce. Simplifying usually helps, as does giving 
working examples from the included data sets.

Roger

> ?
> Many thanks !
> ?
> Juliane
>
>
> ?Dr. Juliane Struve
> Environmental Scientist
> 10, Lynwood Crescent
> Sunningdale SL5 0BL
> 01344 620811
>
>
>
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From jean-paul.kibambe at uclouvain.be  Fri Oct  3 16:44:04 2008
From: jean-paul.kibambe at uclouvain.be (Jean-Paul Kibambe Lubamba)
Date: Fri, 3 Oct 2008 16:44:04 +0200 (CEST)
Subject: [R-sig-Geo] GWR : Confidence intervals on predictions
Message-ID: <d662e0e706f557fab8a63ff7446e6cf1.squirrel@mmp.sipr-dc.ucl.ac.be>

Hello everybody,

I want to obtain confidence intervals on predictions when using gwr. I
received some matrix algebra to implement to do that, but I need the gwr
weight matrix and I do not know how to get it. Could anyone help me ?

Thanks in advance for any help !


JP


Here is below the matrix operations, using a latex notation:

The vector of regression coefficients at a given point is

\beta = (X^TWX)^(-1) X^TWy

Where the weight matrix W depends on the location of the point,  as usual.
We can simplify this by writing

\beta = Cy where C = (X^TWX)^(-1) X^TW

Then

Var(\beta) = CC^T \sigma^2 - so far,  this is in the GWR book - including
how to estimate \sigma^2

Now if we have a new vector of predictors x at the same point,  then
predictor of the y-variable is

x^T \beta

And so its variance is

x^T C x \sigma^2

This gives the variance of the expected y-variable given a set of
predictors - but this is just the variance of the mean of its
distribution.  The y-variable itself will be the sum of the predicted mean
plus an error term with mean zero and variance\sigma^2.

This has variance

x^T C x \sigma^2 + \sigma^2

or

(x^T C x + 1)\sigma^2

And so the standard error of the prediction is

sqrt(x^T C x + 1)\sigma



From dylan.beaudette at gmail.com  Fri Oct  3 19:42:28 2008
From: dylan.beaudette at gmail.com (Dylan Beaudette)
Date: Fri, 3 Oct 2008 10:42:28 -0700
Subject: [R-sig-Geo] question about simulating patchy landscapes
In-Reply-To: <48DB5221.7060907@uni-muenster.de>
References: <D7B94F0B40246740A3EFF9DBBD921B7B796B65@SAGE.forestry.oregonstate.edu>
	<200809241544.35192.dylan.beaudette@gmail.com>
	<48DB5221.7060907@uni-muenster.de>
Message-ID: <200810031042.28259.dylan.beaudette@gmail.com>

On Thursday 25 September 2008, Edzer Pebesma wrote:
> demo(uisim)

This seems work work with the demo code, but not with another example using my 
own data:

# setup
library(gstat)
library(spgrass6)

# load GRASS region settings
G <- gmeta6()
grd <- gmeta2grd()

# make a new grid from GRASS region
new_data <- SpatialGrid(grd)


# works fine:
var.model <- vgm(psill=10, model="Exp", range=1000)
sim <- predict(gstat(formula=z~1, dummy=TRUE, beta=0, model=var.model, 
nmax=20), newdata = new_data, nsim = 1)

# does not work -- produces a field of '0' values
sim <- predict(gstat(formula=z~1, dummy=TRUE, beta=0, model=var.model, 
nmax=20), newdata = new_data, nsim = 1, indicators=TRUE)


# any ideas on why UISIM works in the demo, and not in my examples? I have 
noticed that the syntax is slightly different in the demo, could this be the 
cause:

# prediction grid:
data(meuse.grid)
gridded(meuse.grid) = ~x+y

# define variable as dummy data
v = vgm(.25, "Sph", 900)
g = gstat(NULL, "var1", x~1, beta = .5, nmax = 20, model = v, dummy = TRUE)

# simulation of a single variable
out = predict(g, meuse.grid, nsim = 20, indicators = TRUE)

Thanks,
Dylan

-- 
Dylan Beaudette
Soil Resource Laboratory
http://casoilresource.lawr.ucdavis.edu/
University of California at Davis
530.754.7341



From dylan.beaudette at gmail.com  Fri Oct  3 19:49:57 2008
From: dylan.beaudette at gmail.com (Dylan Beaudette)
Date: Fri, 3 Oct 2008 10:49:57 -0700
Subject: [R-sig-Geo] question about simulating patchy landscapes [solved]
In-Reply-To: <200810031042.28259.dylan.beaudette@gmail.com>
References: <D7B94F0B40246740A3EFF9DBBD921B7B796B65@SAGE.forestry.oregonstate.edu>
	<48DB5221.7060907@uni-muenster.de>
	<200810031042.28259.dylan.beaudette@gmail.com>
Message-ID: <200810031049.57199.dylan.beaudette@gmail.com>

On Friday 03 October 2008, Dylan Beaudette wrote:
> On Thursday 25 September 2008, Edzer Pebesma wrote:
> > demo(uisim)
>
> This seems work work with the demo code, but not with another example using
> my own data:
>
> # setup
> library(gstat)
> library(spgrass6)
>
> # load GRASS region settings
> G <- gmeta6()
> grd <- gmeta2grd()
>
> # make a new grid from GRASS region
> new_data <- SpatialGrid(grd)
>
>
> # works fine:
> var.model <- vgm(psill=10, model="Exp", range=1000)
> sim <- predict(gstat(formula=z~1, dummy=TRUE, beta=0, model=var.model,
> nmax=20), newdata = new_data, nsim = 1)
>
> # does not work -- produces a field of '0' values
> sim <- predict(gstat(formula=z~1, dummy=TRUE, beta=0, model=var.model,
> nmax=20), newdata = new_data, nsim = 1, indicators=TRUE)
>

Oops. It looks like my second example works when I set 'beta=0.5'. Probably my 
lack of experience in this field that caused me to overlook the importance of 
this parameter. Anyone care to explain why?

Cheers,

Dylan


> # any ideas on why UISIM works in the demo, and not in my examples? I have
> noticed that the syntax is slightly different in the demo, could this be
> the cause:
>
> # prediction grid:
> data(meuse.grid)
> gridded(meuse.grid) = ~x+y
>
> # define variable as dummy data
> v = vgm(.25, "Sph", 900)
> g = gstat(NULL, "var1", x~1, beta = .5, nmax = 20, model = v, dummy = TRUE)
>
> # simulation of a single variable
> out = predict(g, meuse.grid, nsim = 20, indicators = TRUE)
>
> Thanks,
> Dylan



-- 
Dylan Beaudette
Soil Resource Laboratory
http://casoilresource.lawr.ucdavis.edu/
University of California at Davis
530.754.7341



From Roger.Bivand at nhh.no  Fri Oct  3 21:40:19 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 3 Oct 2008 21:40:19 +0200 (CEST)
Subject: [R-sig-Geo] GWR : Confidence intervals on predictions
In-Reply-To: <d662e0e706f557fab8a63ff7446e6cf1.squirrel@mmp.sipr-dc.ucl.ac.be>
References: <d662e0e706f557fab8a63ff7446e6cf1.squirrel@mmp.sipr-dc.ucl.ac.be>
Message-ID: <Pine.LNX.4.64.0810032115240.3483@reclus.nhh.no>

On Fri, 3 Oct 2008, Jean-Paul Kibambe Lubamba wrote:

> Hello everybody,
>
> I want to obtain confidence intervals on predictions when using gwr. I
> received some matrix algebra to implement to do that, but I need the gwr
> weight matrix and I do not know how to get it. Could anyone help me ?

Which of the n matrices (for n fit points - are your fit points and data 
points identical?) do you want? I think that first you need to find out 
whether you should trust the local betas and the GWR sigma^2 - where the 
latter crucially depends on the assumed effective degrees of freedom. I 
guess this is around p. 55 in the GWR book? My feeling is that until the 
coefficient forcing collinearity is resolved (the strong negative 
correlation between fitted local coefficients), GWR should not be relied 
on to give helpful inferential results.

In this case, it isn't clear whether your fit points are your data points, 
or where the new x values are on the map. If they are at a fit point, you 
could just multiply them through (vector of betas, vector of x) to use 
your fitted betas. I guess one could do what you describe, but I don't 
think it is prudent (also based on having discussed prediction with one of 
the book authors after the book was published).

The method is for detecting non-stationarity to help in reaching a better 
model specification. When the model is well-specified, you may predict 
using standard functions, ones that are well-studied. If a spatial process 
is important for you, given GWR's point support, consider using a kriging 
approach instead, where prediction and prediction uncertainty are 
well-studied.

Sorry to be negative. In the case in which data and fit points are 
identical, I can more or less see how one might call the predict() method 
for lm objects internally on the i-th point using unchanged x values, but 
the n lm fits are not stored, and C varies for each i. Using new x values 
would mean storing the fits - in principle, it could be done, but I don't 
know whether the effort would be worthwhile given the underlying doubts 
surrounding the technique. For example, Danlin Yu has a conference paper 
showing that the local coefficient patterning may be sensitive to the 
distribution of the response, over and above the collinearity demonstrated 
by Wheeler & Tiefelsdorf. Unfortunately, as far as I am aware, the GWR 
authors have not engaged these issues.

Best wishes,

Roger

>
> Thanks in advance for any help !
>
>
> JP
>
>
> Here is below the matrix operations, using a latex notation:
>
> The vector of regression coefficients at a given point is
>
> \beta = (X^TWX)^(-1) X^TWy
>
> Where the weight matrix W depends on the location of the point,  as usual.
> We can simplify this by writing
>
> \beta = Cy where C = (X^TWX)^(-1) X^TW
>
> Then
>
> Var(\beta) = CC^T \sigma^2 - so far,  this is in the GWR book - including
> how to estimate \sigma^2
>
> Now if we have a new vector of predictors x at the same point,  then
> predictor of the y-variable is
>
> x^T \beta
>
> And so its variance is
>
> x^T C x \sigma^2
>
> This gives the variance of the expected y-variable given a set of
> predictors - but this is just the variance of the mean of its
> distribution.  The y-variable itself will be the sum of the predicted mean
> plus an error term with mean zero and variance\sigma^2.
>
> This has variance
>
> x^T C x \sigma^2 + \sigma^2
>
> or
>
> (x^T C x + 1)\sigma^2
>
> And so the standard error of the prediction is
>
> sqrt(x^T C x + 1)\sigma
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Steve_Friedman at nps.gov  Fri Oct  3 21:37:36 2008
From: Steve_Friedman at nps.gov (Steve_Friedman at nps.gov)
Date: Fri, 3 Oct 2008 15:37:36 -0400
Subject: [R-sig-Geo] question about simulating patchy landscapes [solved]
In-Reply-To: <200810031049.57199.dylan.beaudette@gmail.com>
Message-ID: <OFDF57ACA8.C4322D3C-ON852574D7.006B8A11-852574D7.006BD01A@nps.gov>

Dylan,

You might also want to explore cellular based models.

Here is an example, somebody else posted this to the R site but I don't
recall who to give credit to.
This a patch model which considers changes to the "landscape" over time.

Have fun.

library(simecol)

CA <- new("gridModel", main = function(time, init, parms) {
    z <- init
    nb <- eightneighbors(z)
    pgen <- 1 - (1-parms$pbirth)^nb
    zgen <- ifelse(z == 0 &
              runif(z) < pgen, 1, 0)
    zsurv <- ifelse(z >= 1 &
              runif(z) < (1 - parms$pdeath), z + 1, 0)
    zgen + zsurv
    },
    parms = list(pbirths = 0.02, pdeath = 0.01),
    times = c(from = 1, to = 50, by = 1),
    init = matrix(0, nrow = 30, ncol = 30),
    solver = "iteration"
)

init(CA)[18:22, 18:22] <- 1

data(CA, package = "simecol")

times(CA)
times(CA) <- c(to = 1000)
CA <- sim(CA)
plot(CA)


Steve Friedman Ph. D.
Spatial Statistical Analyst
Everglades and Dry Tortugas National Park
950 N Krome Ave (3rd Floor)
Homestead, Florida 33034

Office (305) 224 - 4282
Steve_Friedman at nps.gov


                                                                           
             Dylan Beaudette                                               
             <dylan.beaudette@                                             
             gmail.com>                                                 To 
             Sent by:                  r-sig-geo at stat.math.ethz.ch         
             r-sig-geo-bounces                                          cc 
             @stat.math.ethz.c                                             
             h                                                     Subject 
                                       Re: [R-sig-Geo] question about      
                                       simulating patchy landscapes        
             10/03/2008 10:49          [solved]                            
             AM MST                                                        
                                                                           
                                                                           
             Please respond to                                             
             dylan.beaudette at g                                             
                 mail.com                                                  
                                                                           
                                                                           




On Friday 03 October 2008, Dylan Beaudette wrote:
> On Thursday 25 September 2008, Edzer Pebesma wrote:
> > demo(uisim)
>
> This seems work work with the demo code, but not with another example
using
> my own data:
>
> # setup
> library(gstat)
> library(spgrass6)
>
> # load GRASS region settings
> G <- gmeta6()
> grd <- gmeta2grd()
>
> # make a new grid from GRASS region
> new_data <- SpatialGrid(grd)
>
>
> # works fine:
> var.model <- vgm(psill=10, model="Exp", range=1000)
> sim <- predict(gstat(formula=z~1, dummy=TRUE, beta=0, model=var.model,
> nmax=20), newdata = new_data, nsim = 1)
>
> # does not work -- produces a field of '0' values
> sim <- predict(gstat(formula=z~1, dummy=TRUE, beta=0, model=var.model,
> nmax=20), newdata = new_data, nsim = 1, indicators=TRUE)
>

Oops. It looks like my second example works when I set 'beta=0.5'. Probably
my
lack of experience in this field that caused me to overlook the importance
of
this parameter. Anyone care to explain why?

Cheers,

Dylan


> # any ideas on why UISIM works in the demo, and not in my examples? I
have
> noticed that the syntax is slightly different in the demo, could this be
> the cause:
>
> # prediction grid:
> data(meuse.grid)
> gridded(meuse.grid) = ~x+y
>
> # define variable as dummy data
> v = vgm(.25, "Sph", 900)
> g = gstat(NULL, "var1", x~1, beta = .5, nmax = 20, model = v, dummy =
TRUE)
>
> # simulation of a single variable
> out = predict(g, meuse.grid, nsim = 20, indicators = TRUE)
>
> Thanks,
> Dylan



--
Dylan Beaudette
Soil Resource Laboratory
http://casoilresource.lawr.ucdavis.edu/
University of California at Davis
530.754.7341

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch
https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From kowtet at yahoo.com  Sat Oct  4 05:34:48 2008
From: kowtet at yahoo.com (Isaac Tetteh)
Date: Fri, 3 Oct 2008 20:34:48 -0700 (PDT)
Subject: [R-sig-Geo] Running Mean code for gridded datasets
Message-ID: <731750.29825.qm@web38108.mail.mud.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081003/287ebd3d/attachment.pl>

From alexandre.villers at cebc.cnrs.fr  Sun Oct  5 15:05:49 2008
From: alexandre.villers at cebc.cnrs.fr (Alexandre VILLERS)
Date: Sun, 05 Oct 2008 15:05:49 +0200
Subject: [R-sig-Geo] GRASS and R
Message-ID: <48E8BBAD.6080405@cebc.cnrs.fr>


Good afternoon,

I started using R because I appreciated all its possibilities and the 
general idea of Public software. Since I'm also getting involved in 
spatial analysis, I would like to start using GRASS (with R) for the 
same reason (fleixibility, updates, etc.).
I've been using ArcGis for a while now and so have some knowledge on GIS 
software but no one in my lab is using GRASS and so I have to start form 
the beginning. I downloaded some tutorials but for the moment it remains 
quite dark to me, especially with the GRASS 6.3.0 version, for which 
documentation appears to be scarce.

Could someone advise me with a tutorial which would help me with 
handling GRASS (something like "GRASS for the beginners") and connecting 
GRASS to R (using spgrass6).

Best regards

Alex

-- 
Alexandre Villers
PhD Student
Team "Biodiversity"
CEBC-CNRS UPR1934
79360 Beauvoir sur Niort

Phone +33 (0)5 49 09 96 13
Fax   +33 (0)5 49 09 65 26




__________ Information from ESET Mail Security, version of virus signature database 3495 (20081004) __________

The message was checked by ESET Mail Security.
http://www.eset.com


    part000.txt - is OK



From tech_dev at wildintellect.com  Sun Oct  5 19:53:29 2008
From: tech_dev at wildintellect.com (Alex Mandel)
Date: Sun, 05 Oct 2008 10:53:29 -0700
Subject: [R-sig-Geo] GRASS and R
In-Reply-To: <48E8BBAD.6080405@cebc.cnrs.fr>
References: <48E8BBAD.6080405@cebc.cnrs.fr>
Message-ID: <48E8FF19.4070409@wildintellect.com>

Alexandre VILLERS wrote:
> 
> Good afternoon,
> 
> I started using R because I appreciated all its possibilities and the
> general idea of Public software. Since I'm also getting involved in
> spatial analysis, I would like to start using GRASS (with R) for the
> same reason (fleixibility, updates, etc.).
> I've been using ArcGis for a while now and so have some knowledge on GIS
> software but no one in my lab is using GRASS and so I have to start form
> the beginning. I downloaded some tutorials but for the moment it remains
> quite dark to me, especially with the GRASS 6.3.0 version, for which
> documentation appears to be scarce.
> 
> Could someone advise me with a tutorial which would help me with
> handling GRASS (something like "GRASS for the beginners") and connecting
> GRASS to R (using spgrass6).
> 
> Best regards
> 
> Alex
> 
I found Grass a little confusing to start with also, I would suggest you
actually start with QGIS which contains a plugin to access grass. It can
help you get the feel for how grass works and stores data. There are
also several plugins that use R to perform operations, so if you're into
programming you could learn from those.

Here are some tutorials that might help you
http://wiki.osgeo.org/wiki/Educational_Content_Inventory

Alex



From eaeff at mtsu.edu  Sun Oct  5 20:43:57 2008
From: eaeff at mtsu.edu (E. Anthon Eff)
Date: Sun, 05 Oct 2008 13:43:57 -0500
Subject: [R-sig-Geo] GRASS and R
In-Reply-To: <48E8BBAD.6080405@cebc.cnrs.fr>
References: <48E8BBAD.6080405@cebc.cnrs.fr>
Message-ID: <48E90AED.7040200@mtsu.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081005/a51552dd/attachment.pl>

From giohappy at gmail.com  Sun Oct  5 21:00:02 2008
From: giohappy at gmail.com (G. Allegri)
Date: Sun, 5 Oct 2008 21:00:02 +0200
Subject: [R-sig-Geo] GRASS and R
In-Reply-To: <48E90AED.7040200@mtsu.edu>
References: <48E8BBAD.6080405@cebc.cnrs.fr> <48E90AED.7040200@mtsu.edu>
Message-ID: <e12429640810051200l1820f5derdcda24d706821110@mail.gmail.com>

I suggest you also the following pages:
http://cran.r-project.org/web/packages/spgrass6/index.html
http://grass.itc.it/statsgrass/index.php
http://grass.itc.it/statsgrass/grass_geostats.html

A nice plugin from Carson Farmer for QGIS:
http://www.ftools.ca/manageR.html

Giovanni

2008/10/5 E. Anthon Eff <eaeff at mtsu.edu>:
> Alex, there are a couple of books that would be worth buying:
>
> Bivand, Roger S., Edzer J. Pebesma, and Virgilio G?mez-Rubio. 2008.
> Applied Spatial Data Analysis with R. 1st ed. Springer.
>
> Neteler, Markus, and Helena Mitasova. 2007. Open Source GIS: A GRASS GIS
> Approach. 3rd ed. Springer.
>
>
> best,
> Anthon
>
> Alexandre VILLERS wrote:
>>
>> Good afternoon,
>>
>> I started using R because I appreciated all its possibilities and the
>> general idea of Public software. Since I'm also getting involved in
>> spatial analysis, I would like to start using GRASS (with R) for the
>> same reason (fleixibility, updates, etc.).
>> I've been using ArcGis for a while now and so have some knowledge on
>> GIS software but no one in my lab is using GRASS and so I have to
>> start form the beginning. I downloaded some tutorials but for the
>> moment it remains quite dark to me, especially with the GRASS 6.3.0
>> version, for which documentation appears to be scarce.
>>
>> Could someone advise me with a tutorial which would help me with
>> handling GRASS (something like "GRASS for the beginners") and
>> connecting GRASS to R (using spgrass6).
>>
>> Best regards
>>
>> Alex
>>
>
> --
> E. Anthon Eff, Associate Professor
> Dept. of Economics, Middle Tennessee State University
> Box X050, Murfreesboro TN 37132
> Phone: 615.898.2387
> http://www.mtsu.edu/~eaeff/
>
> Natura non facit saltum.
>
>
>        [[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>



From jorge.de-jesus at jrc.it  Mon Oct  6 09:04:47 2008
From: jorge.de-jesus at jrc.it (Jorge de Jesus)
Date: Mon, 06 Oct 2008 09:04:47 +0200
Subject: [R-sig-Geo] GRASS and R
In-Reply-To: <48E8BBAD.6080405@cebc.cnrs.fr>
References: <48E8BBAD.6080405@cebc.cnrs.fr>
Message-ID: <48E9B88F.7020502@jrc.it>

Hi

Aside from the books and link suggestions, the  safest way to start
dealing with open source GIS is to run everything is a VMWare virtual
machine.

In this site you can download a virtual machine image with Ubuntu as OS
and with all the OpenSource software installed and running
(GRASS/Qgis/R/FWTools etc)

http://www.gisvm.com/

Best
Jorge




Alexandre VILLERS wrote:
>
> Good afternoon,
>
> I started using R because I appreciated all its possibilities and the
> general idea of Public software. Since I'm also getting involved in
> spatial analysis, I would like to start using GRASS (with R) for the
> same reason (fleixibility, updates, etc.).
> I've been using ArcGis for a while now and so have some knowledge on
> GIS software but no one in my lab is using GRASS and so I have to
> start form the beginning. I downloaded some tutorials but for the
> moment it remains quite dark to me, especially with the GRASS 6.3.0
> version, for which documentation appears to be scarce.
>
> Could someone advise me with a tutorial which would help me with
> handling GRASS (something like "GRASS for the beginners") and
> connecting GRASS to R (using spgrass6).
>
> Best regards
>
> Alex
>


-- 
Ph.D. Jorge Samuel Mendes de Jesus

European Commission (EC)
Joint Research Centre Directorate (DG JRC)
Institute for Environment and Sustainability (IES)
TP 441, Via Fermi 1
21020 Ispra (VA)
Italy

Phone: +39 0332 78 3536
Fax:   +39 0332 78 5466

http://rem.jrc.cec.eu.int

"The views expressed are purely those of the writer and may not in any circumstances be regarded as stating an official position of the European Commission"



From juliane_struve at yahoo.co.uk  Mon Oct  6 13:14:11 2008
From: juliane_struve at yahoo.co.uk (Juliane Struve)
Date: Mon, 6 Oct 2008 11:14:11 +0000 (GMT)
Subject: [R-sig-Geo] Modifying a column in a Shapefile
Message-ID: <293269.580.qm@web27206.mail.ukl.yahoo.com>




Dear Roger,

thank you very much for your help, (and thank you to others who have helped me to set this up)?. The code below seems to convert the data in column NEAR_ANGLE correctly and also writes a new shapefile,although I may have made mistakes that I am not yet aware of. 

MergedCentroids <- readOGR("Centroids_Merge.shp","Centroids_Merge")
MergedCentroids$NEARANG_R <- ifelse(MergedCentroids$NEAR_ANGLE<0,MergedCentroids$NEAR_ANGLE+360, MergedCentroids$NEAR_ANGLE)
MergedCentroids$NEARANG_R=90-MergedCentroids$NEARANG_R
MergedCentroids$NEARANG_R <- ifelse(MergedCentroids$NEARANG_R<0,MergedCentroids$NEARANG_R+360, MergedCentroids$NEARANG_R)
write.pointShape(coordinates(MergedCentroids),data.frame(MergedCentroids),paste("NEWMC")) 
NEWMCSPDF=readOGR("NEWMC.shp","NEWMC")

However:
#writeOGR(MergedCentroids, "NEWMCSPDF", driver="ESRI Shapefile")
did not work. I will try and find out more about it.

Regards,

Juliane 

Below is an example of my data.

coordinates????????????????????? Id PolyFID?? UTMX??? UTMY 
?(330430, 3043940)? ??? ??? 0? 187416 330430 3043937??????? 
?(330430, 3044040)? ??? ??? 0? 187417 330430 3044037???????
?(330430, 3044140)? ??? ??? 0? 187418 330430 3044137???????
?(330430, 3044240)? ??? ??? 0? 187419 330430 3044237???????
(330430, 3044340)?????????????0? 187420 330430 3044337?????
(330430, 3044440)????????????0? 187421 330430 3044437??????? 
(330430, 3044540)? ??? ??? ??? 0? 187422 330430 3044537??????? 
?(330430, 3044640)? ??? ??? ??? 0? 187423 330430 3044637???????
?(330430, 3044740)? ??? ??? ??? 0? 187424 330430 3044737???????
?(330430, 3044840)? ??? ??? ??? 0? 187425 330430 3044837??????? 
?(330430, 3044940)? ??? ??? ??? 0? 187426 330430 3044937??????? 
?
??? CELLTYPE NEAR_FID NEAR_DIST?? NEAR_X? NEAR_Y NEAR_ANGLE NEARANG_R 
500??????? 1????????? ??? 604 ??? ??? 266.91098 330681.3 3043847? -19.66356? ??? ??? ??? ??? 109.6636??? 
501??????? 1????? ??? ??? 604 ??? ??? 314.96727 330681.3 3043847? -37.05982? ??? ??? ??? ??? 127.0598???
502??????? 1????? ??? ??? 612 ??? ??? 307.32628 330378.1 3044440?? 99.71783? ??? ??? ??? ??? 350.2822??? 
503??????? 1????? ??? ??? 612 ??? ??? 209.44248 330378.1 3044440? 104.34049? ??? ??? ??? ??? 345.6595??? 
504??????? 1????? ??? ??? 612 ??? ??? 114.03715 330394.0 3044445? 108.42658? ??? ??? ??? ??? 341.5734??? 
505??????? 1????? ??? ??? 612?????????19.16420 330423.9 3044455? 108.42658?????????????????????341.5734??? 
506??????? 1??? ????? ??? 612? ??? ??? 27.46970 330420.8 3044563? 109.47166? ??? ??? ??? ??? 340.5283???
507??????? 1????? ??? ??? 612? ??? ??? 21.19512 330439.2 3044618? -64.29902?????????????????????154.2990??? 
508??????? 1????? ??? ??? 612???????????111.30209 330478.3 3044637? -64.29902? ??? ??? ??? ??? 154.2990??? 
509??????? 1????? ??? ??? 612 ??? ??? 201.57582 330516.4 3044655? -64.61209? ??? ??? ??? ??? 154.6121??? 
510??????? 1????? ??? ??? 612 ??? ??? 291.91840 330555.2 3044673? -64.61209? ??? ??? ??? ??? 154.6121??? 


?
----- Original Message ----
From: Roger Bivand <Roger.Bivand at nhh.no>
To: Juliane Struve <juliane_struve at yahoo.co.uk>
Cc: r-sig-geo at stat.math.ethz.ch
Sent: Friday, 3 October, 2008 13:33:44
Subject: Re: [R-sig-Geo] Modifying a column in a Shapefile

On Fri, 3 Oct 2008, Juliane Struve wrote:

> Dear list members,
>
> I am using a grid called "MergedCentroids" in which I need to 
> modify?entries in ?column?"NEARANGLE and write the result into a 
> column?"NEARANG_R". I have tried to convert the Spatial Points Data 
> Frame to a data frame in order to do this.?I want to convert the updated 
> grid into a new shapefile at the end. This is my code so far:
>
> MergedCentroids <- readOGR("Centroids_Merge.shp","Centroids_Merge")
> write.table(MergedCentroids,file="MergedCentroids.csv",sep=",",row.names=F)
> MC=read.csv("MergedCentroids.csv")
> MCDF<-as.data.frame(MC)
> MCDF$NEARANG_R=ifelse(MCDF$NEARANGLE<0,MCDF$NEARANGLE+360,MCDF$NEARANG)
> MCSPDF = SpatialPointsDataFrame(MCDF[,3:4],data.frame(MCDF[,1:16]))
> write.pointShape(coordinates(MCSPDF),data.frame(MCSPDF),paste("NEWMCSPDF"))
> ?
> After executing the last statement I get two error messages:
> ?
> write.pointShape(coordinates(MCSPDF),data.frame(MCSPDF),paste("NEWMCSPDF"))
> Error in write.dbf(df, paste(file, ".dbf", sep = ""), factor2char = factor2char,? :
> ? unable to open file
> In addition: Warning message:
> use writeSpatialShape:
> objects other than Spatial objects defined in the sp package are deprecated
> ?
> Would somebody be able to help ?

Difficult to know where to start. If you had used a provided data set, it 
might have been easier.

First, to coerce to a data.frame, use as(), the coerce method:

MC <- as(MergedCentroids, "data.frame")

What actually got written to the CSV file probably resulted from coercion 
being invoked internally in write.table() - did you inspect the file?

Why not just operate on the MergedCentroids object?

MergedCentroids$NEARANG_R <- ifelse(MergedCentroids$NEARANGLE<0,
? MergedCentroids$NEARANGLE+360, MergedCentroids$NEARANG)

is quite OK. Why not then simply use:

writeOGR(MergedCentroids, "NEWMCSPDF", driver="ESRI Shapefile")

I can imagine that the input object is polygons not points, adding one 
possible extra level, and that the OGR driver does not handle dates 
gracefully, leading you to prefer writeSpatialShape() in maptools (using 
the improved write.dbf() in foreign), but not much more reason for the 
complications you introduce. Simplifying usually helps, as does giving 
working examples from the included data sets.

Roger

> ?
> Many thanks !
> ?
> Juliane
>
>
> ?Dr. Juliane Struve
> Environmental Scientist
> 10, Lynwood Crescent
> Sunningdale SL5 0BL
> 01344 620811
>
>
>
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no







From ddepew at sciborg.uwaterloo.ca  Mon Oct  6 19:48:01 2008
From: ddepew at sciborg.uwaterloo.ca (Dave Depew)
Date: Mon, 06 Oct 2008 13:48:01 -0400
Subject: [R-sig-Geo] [Gstat-info] LOCAL universal kriging with GLOBAL
 reg. coeff.estimation
In-Reply-To: <635F946AC8DA41A39D3C02EA71CFE2ED@pcibed193>
References: <635F946AC8DA41A39D3C02EA71CFE2ED@pcibed193>
Message-ID: <48EA4F51.9070106@scimail.uwaterloo.ca>

A late follow up question to this thread....

What if the local neighbor hood was restricted to the range of 
autocorrelation? My impression was that values beyond that have little 
weight in the interpolation anyways.
I realize that this is of course not statistically optimal, but for 
those with large data sets (and lacking the computing power) would this 
not give a reasonable approximation?










 >Dear Radim, Edzer,

I was thinking about the same problem few years ago (I assume that you 
work with auxiliary maps and
not only coordinates).

I think (have a feeling) that local and global Universal kriging should 
be treated as two things
(especially if you put a very narrow search radius). This is because, in 
the case of KED algorithm,
both regression and kriging part of predictions are solved at the same 
time. Hence, if we limit the
search window, but keep a constant variogram model, we could obtain very 
different predictions then
if we use a global (regression-kriging) model. Only if the variogram of 
residuals if absolutely
stationary (constant), then we can limit the search window to fit the 
KED weights. In fact, I am
confident that software packages should not allow UK/KED predictions 
with a limited search radius,
because this conflicts the model assumptions (a bit deeper discussion 
about this problem can be
found in my lecture notes section 2.2 "Localized versus local models").

In the case of regression-kriging, this is less problematic because it 
is computationally cheap to
fit the regression part, and then you are allowed to limit the search 
radius to interpolate the
residuals (we still cheat but not so much). But then the problem is that 
we do not have an estimate
of the RK kriging variance (you could estimate the OLS prediction 
variance and then OK-residuals
prediction variance and then add them together - both can be done in 
gstat - but then you completely
ignore correlation of the two terms; although this is often insignificant).

If gstat already does something like this (global GLS simulations of 
trend with local kriging), then
this would be a legitime solution. But I still can not run much 
geostatistics with big datasets
(>>1000 points, >>10^6 grids) in R+gstat (on standard PCs), not to 
mention geostatistical
simulations (that are computationally much more demanding than 
predictions)... if you would have to
do it 100 times, this would really take a lot of processing.

One alternative is to run UK/KED in SAGA software (I have tested it - it 
runs about 5-10 times
faster than R+gstat and has no memory limit problems), which is possible 
through R also, e.g.:

rsaga.get.usage("geostatistics_kriging", 3)
rsaga.geoprocessor(lib="geostatistics_kriging", module=3,
param=list(GRIDS="DEM.sgrd;SLOPE.sgrd;PLANC.sgrd;TWI.sgrd;SINS.sgrd;SMU1.sgrd;SMU3.sgrd;SMU4.sgrd;SM
U9.sgrd", GRID="SOLUM_rk.sgrd", SHAPES="baranja.shp", FIELD=0, MODEL=1, 
NUGGET=0, SILL=200,
RANGE=500, INTERPOL=0))

see also http://geomorphometry.org/view_scripts.asp?id=24

But the last version of SAGA had some bug in this module, so I remember 
that I did not get correct
results (I did not test the most recent version of SAGA).

I personally think that we should simply think about implementing local 
RK (regressions/variograms
in moving window; maps of regression coefficients, variogram parameters, 
R-square etc.), and this
would then solve this problem (+give us much more insight into the data).


Tom Hengl
http://spatial-analyst.net


-----Original Message-----
From: gstat-info-bounces at geo.uu.nl [mailto:gstat-info-bounces at 
geo.uu.nl] On Behalf Of Edzer Pebesma
Sent: donderdag 21 augustus 2008 13:07
To: Vasat, Radim
Cc: Gstat-info at geo.uu.nl; sig-geo
Subject: Re: [Gstat-info] LOCAL universal kriging with GLOBAL reg. 
coeff.estimation

Good question, I'll include r-sig-geo as well.

actually the prediction equations you end up with are kind of funny, and
I've never seen them written out. Two different covariance matrices
being inversed.

Package gstat can do the two-step approach: global BLUE, then simple
kriging of residual, but that ignores the correlation of both terms,
when added.

I'm quite sure that if you do Gaussian simulation however with gstat,
the trend is fitted globally (and simulated from the corresponding GLS
mean & covariance), whereas the kriging is done locally, so that should
result in realisations that have the variance you want. You just have to
compute the average and variance, to get estimates of the kriging mean
and variance you're looking for. Also, it might be computationally
demanding, both in time and space (memory).
--
Edzer

Vasat, Radim wrote:
 > Dear all,
 >
 > My question is how to performe LOCAL universal kriging with
 > estimation of regression coefficients from the whole area
 > (GLOBAL estimation) at once.
 >
 > For large data (I have more than 8000 records) is computationaly too
 > demanding to handle with all the data for UK prediction. Hence,
 > I prefer to do it LOCALLY (namx=100), but the reg. coeff.
 > would be estimated only with limited data in this case (not all
 > data are included).
 >
 > To estimate the reg. coeff. first (with BLUE=TRUE) and then perform
 > the simple kriging with beta equals to the reg. coeff. and nmax=100
 > might be the
 > solution. But the reg. coeff. estimation error is not included into the
 > final kriging variance in this case.
 >
 > Anybody knows how to join these two requirements (LOCAL UK and GLOBAL
 > estinmation of reg. coeff.) into one prediction???
 >
 > I will appreciate any coments!
 > Radim
 >
 > _______________________________________________
 > Gstat-info mailing list
 > Gstat-info at geo.uu.nl
 > http://mailman.geo.uu.nl/mailman/listinfo/gstat-info
 >  

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster,
Weseler Stra?e 253, 48151 M?nster, Germany.  Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de/

_______________________________________________
Gstat-info mailing list
Gstat-info at geo.uu.nl

-- 
David Depew
PhD Candidate
Department of Biology
University of Waterloo
200 University Ave W.
Waterloo, ON. Canada
N2L 3G1

(T) 1-519-888-4567 x33895
(F) 1-519-746-0614

http://www.science.uwaterloo.ca/~ddepew



From edzer.pebesma at uni-muenster.de  Mon Oct  6 19:57:10 2008
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 06 Oct 2008 19:57:10 +0200
Subject: [R-sig-Geo] [Gstat-info] LOCAL universal kriging with GLOBAL
 reg. coeff.estimation
In-Reply-To: <48EA4F51.9070106@scimail.uwaterloo.ca>
References: <635F946AC8DA41A39D3C02EA71CFE2ED@pcibed193>
	<48EA4F51.9070106@scimail.uwaterloo.ca>
Message-ID: <48EA5176.1@uni-muenster.de>



Dave Depew wrote:
> A late follow up question to this thread....
>
> What if the local neighbor hood was restricted to the range of 
> autocorrelation? My impression was that values beyond that have little 
> weight in the interpolation anyways.
Often, yes. Three exceptions are (i) when the nugget forms a large part 
of the sill, or (ii) when you use a Gaussian variogram, or (iii) when 
you use a trend function.
> I realize that this is of course not statistically optimal, but for 
> those with large data sets (and lacking the computing power) would 
> this not give a reasonable approximation?
If the nugget is small, and you have say 500+ observations within the 
range, restricting it to a much smaller number may still be near-optimal.
--
Edzer
>
>
>
>
>
>
>
>
>
>
> >Dear Radim, Edzer,
>
> I was thinking about the same problem few years ago (I assume that you 
> work with auxiliary maps and
> not only coordinates).
>
> I think (have a feeling) that local and global Universal kriging 
> should be treated as two things
> (especially if you put a very narrow search radius). This is because, 
> in the case of KED algorithm,
> both regression and kriging part of predictions are solved at the same 
> time. Hence, if we limit the
> search window, but keep a constant variogram model, we could obtain 
> very different predictions then
> if we use a global (regression-kriging) model. Only if the variogram 
> of residuals if absolutely
> stationary (constant), then we can limit the search window to fit the 
> KED weights. In fact, I am
> confident that software packages should not allow UK/KED predictions 
> with a limited search radius,
> because this conflicts the model assumptions (a bit deeper discussion 
> about this problem can be
> found in my lecture notes section 2.2 "Localized versus local models").
>
> In the case of regression-kriging, this is less problematic because it 
> is computationally cheap to
> fit the regression part, and then you are allowed to limit the search 
> radius to interpolate the
> residuals (we still cheat but not so much). But then the problem is 
> that we do not have an estimate
> of the RK kriging variance (you could estimate the OLS prediction 
> variance and then OK-residuals
> prediction variance and then add them together - both can be done in 
> gstat - but then you completely
> ignore correlation of the two terms; although this is often 
> insignificant).
>
> If gstat already does something like this (global GLS simulations of 
> trend with local kriging), then
> this would be a legitime solution. But I still can not run much 
> geostatistics with big datasets
> (>>1000 points, >>10^6 grids) in R+gstat (on standard PCs), not to 
> mention geostatistical
> simulations (that are computationally much more demanding than 
> predictions)... if you would have to
> do it 100 times, this would really take a lot of processing.
>
> One alternative is to run UK/KED in SAGA software (I have tested it - 
> it runs about 5-10 times
> faster than R+gstat and has no memory limit problems), which is 
> possible through R also, e.g.:
>
> rsaga.get.usage("geostatistics_kriging", 3)
> rsaga.geoprocessor(lib="geostatistics_kriging", module=3,
> param=list(GRIDS="DEM.sgrd;SLOPE.sgrd;PLANC.sgrd;TWI.sgrd;SINS.sgrd;SMU1.sgrd;SMU3.sgrd;SMU4.sgrd;SM 
>
> U9.sgrd", GRID="SOLUM_rk.sgrd", SHAPES="baranja.shp", FIELD=0, 
> MODEL=1, NUGGET=0, SILL=200,
> RANGE=500, INTERPOL=0))
>
> see also http://geomorphometry.org/view_scripts.asp?id=24
>
> But the last version of SAGA had some bug in this module, so I 
> remember that I did not get correct
> results (I did not test the most recent version of SAGA).
>
> I personally think that we should simply think about implementing 
> local RK (regressions/variograms
> in moving window; maps of regression coefficients, variogram 
> parameters, R-square etc.), and this
> would then solve this problem (+give us much more insight into the data).
>
>
> Tom Hengl
> http://spatial-analyst.net
>
>
> -----Original Message-----
> From: gstat-info-bounces at geo.uu.nl [mailto:gstat-info-bounces at 
> geo.uu.nl] On Behalf Of Edzer Pebesma
> Sent: donderdag 21 augustus 2008 13:07
> To: Vasat, Radim
> Cc: Gstat-info at geo.uu.nl; sig-geo
> Subject: Re: [Gstat-info] LOCAL universal kriging with GLOBAL reg. 
> coeff.estimation
>
> Good question, I'll include r-sig-geo as well.
>
> actually the prediction equations you end up with are kind of funny, and
> I've never seen them written out. Two different covariance matrices
> being inversed.
>
> Package gstat can do the two-step approach: global BLUE, then simple
> kriging of residual, but that ignores the correlation of both terms,
> when added.
>
> I'm quite sure that if you do Gaussian simulation however with gstat,
> the trend is fitted globally (and simulated from the corresponding GLS
> mean & covariance), whereas the kriging is done locally, so that should
> result in realisations that have the variance you want. You just have to
> compute the average and variance, to get estimates of the kriging mean
> and variance you're looking for. Also, it might be computationally
> demanding, both in time and space (memory).
> -- 
> Edzer
>
> Vasat, Radim wrote:
> > Dear all,
> >
> > My question is how to performe LOCAL universal kriging with
> > estimation of regression coefficients from the whole area
> > (GLOBAL estimation) at once.
> >
> > For large data (I have more than 8000 records) is computationaly too
> > demanding to handle with all the data for UK prediction. Hence,
> > I prefer to do it LOCALLY (namx=100), but the reg. coeff.
> > would be estimated only with limited data in this case (not all
> > data are included).
> >
> > To estimate the reg. coeff. first (with BLUE=TRUE) and then perform
> > the simple kriging with beta equals to the reg. coeff. and nmax=100
> > might be the
> > solution. But the reg. coeff. estimation error is not included into the
> > final kriging variance in this case.
> >
> > Anybody knows how to join these two requirements (LOCAL UK and GLOBAL
> > estinmation of reg. coeff.) into one prediction???
> >
> > I will appreciate any coments!
> > Radim
> >
> > _______________________________________________
> > Gstat-info mailing list
> > Gstat-info at geo.uu.nl
> > http://mailman.geo.uu.nl/mailman/listinfo/gstat-info
> > 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster,
Weseler Stra?e 253, 48151 M?nster, Germany.  Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de/
http://www.springer.com/978-0-387-78170-9



From drew.rayburn at aggiemail.usu.edu  Mon Oct  6 19:58:52 2008
From: drew.rayburn at aggiemail.usu.edu (Andrew Rayburn)
Date: Mon, 6 Oct 2008 11:58:52 -0600
Subject: [R-sig-Geo] Can't import precise GPS data
Message-ID: <6361675b0810061058o37f9f3b9mf0c91cbf275cd29@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081006/be2aa860/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Mon Oct  6 20:03:25 2008
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Mon, 6 Oct 2008 19:03:25 +0100
Subject: [R-sig-Geo] Can't import precise GPS data
In-Reply-To: <6361675b0810061058o37f9f3b9mf0c91cbf275cd29@mail.gmail.com>
References: <6361675b0810061058o37f9f3b9mf0c91cbf275cd29@mail.gmail.com>
Message-ID: <d8ad40b50810061103h5f319615w79f3fe86954a2b90@mail.gmail.com>

2008/10/6 Andrew Rayburn <drew.rayburn at aggiemail.usu.edu>:
> My problem is that I can't import precise (to 3 decimal places) Northing and
> Easting coordinates into R.  The data were taken on a ProMark3 GPS unit,
> with the intent of obtaining extremely precise GPS coordinates.
> Post-processing was done correctly, and the resulting Northings and Eastings
> were to 3 decimal places.  However, every attempt I've made to import them
> into R (scan, read.table, read.delim, read.dbf via FOREIGN package, and I
> also the tried maptools package) results in the exact same thing - the
> Northings column is shown to 1 decimal place, and the Eastings column has no
> decimal places.  In other words, I read in the data using one of many
> different import options, and then view the data after import - and all the
> precision has been eliminated.
>
> Has anyone else encountered this problem, and/or can anyone offer a
> solution?  I've spend an inordinate amount of time on this problem, with no
> luck.

 I suspect we'll need to see the file you are trying to import - or at
least part of it. It's possible that R is only *displaying* few
decimal places, controlled by options(digits=...), but that sounds
unlikely.

 Post a bit of your file and then we can have a look....

Barry



From dylan.beaudette at gmail.com  Mon Oct  6 20:14:46 2008
From: dylan.beaudette at gmail.com (Dylan Beaudette)
Date: Mon, 6 Oct 2008 11:14:46 -0700
Subject: [R-sig-Geo] Can't import precise GPS data
In-Reply-To: <6361675b0810061058o37f9f3b9mf0c91cbf275cd29@mail.gmail.com>
References: <6361675b0810061058o37f9f3b9mf0c91cbf275cd29@mail.gmail.com>
Message-ID: <200810061114.47024.dylan.beaudette@gmail.com>

On Monday 06 October 2008, Andrew Rayburn wrote:
> My problem is that I can't import precise (to 3 decimal places) Northing
> and Easting coordinates into R.  The data were taken on a ProMark3 GPS
> unit, with the intent of obtaining extremely precise GPS coordinates.
> Post-processing was done correctly, and the resulting Northings and
> Eastings were to 3 decimal places.  However, every attempt I've made to
> import them into R (scan, read.table, read.delim, read.dbf via FOREIGN
> package, and I also the tried maptools package) results in the exact same
> thing - the Northings column is shown to 1 decimal place, and the Eastings
> column has no decimal places.  In other words, I read in the data using one
> of many different import options, and then view the data after import - and
> all the precision has been eliminated.
>
> Has anyone else encountered this problem, and/or can anyone offer a
> solution?  I've spend an inordinate amount of time on this problem, with no
> luck.
>
> Thanks,
>
> Drew

Hi Drew. I suspect that the print method for sp objects in truncating the 
*printing* of coordinates, but not their actual values. Have a look at this 
thread:

https://stat.ethz.ch/pipermail/r-sig-geo/2007-October/002694.html

Cheers,
Dylan

-- 
Dylan Beaudette
Soil Resource Laboratory
http://casoilresource.lawr.ucdavis.edu/
University of California at Davis
530.754.7341



From dylan.beaudette at gmail.com  Tue Oct  7 06:21:43 2008
From: dylan.beaudette at gmail.com (Dylan Beaudette)
Date: Mon, 6 Oct 2008 21:21:43 -0700
Subject: [R-sig-Geo] writing shapefiles / DBF files when input data contains
	NA
Message-ID: <3c5546140810062121s15257912xea52d522d34151e7@mail.gmail.com>

Hi,

I have noticed that saving data to files that include a DBF, result in
bogus data where there were NA. Using the write.dbf() function from
the foreign package seems to work a little better, but I still get odd
results in numeric columns. Writing to GRASS with the methods in the
spgrass6 package results in some thing that looks like this:

### code snippet:
writeVECT6(SDF=spatial.data, vname='pedons_grouped')


### errors:
Projection of input dataset and current location appear to match
Layer: pedons_g
WARNING: Column name changed: 'describer.' -> 'describer_'
WARNING: Column name changed: 'cat' -> 'cat_'
Importing map 103 features...
DBMI-DBF driver error:
SQL parser error: @@rror, unexpected NAME processing 'nan'
in statement:
insert into pedons_grouped values ( 1, 'd2g1', 'alex',
32.311427999999999,      252.434875000000005,     7227.804688000000169,
-0.000162000000000,           3,                      nan, 'NA',
-2147483648, 'NA', 'NA', -2147483648, -2147483648, 'NA',
nan, '1', 'NA' )
Error in db_execute_immediate()

ERROR: Cannot insert new row: insert into pedons_grouped values ( 1,
       'd2g1', 'alex', 32.311427999999999, 252.434875000000005,
       7227.804688000000169, -0.000162000000000, 3, nan, 'NA',
-2147483648,
       'NA', 'NA', -2147483648, -2147483648, 'NA', nan, '1', 'NA' )


### another self-contained example:


# load libs
library(sp)
library(rgdal)
library(foreign)

# read in xy data and promote to sp object
e <- read.csv(url('http://casoilresource.lawr.ucdavis.edu/drupal/files/elev.csv_.txt'))
coordinates(e) <- ~ x+y

# add a factor column
e at data$f <- factor(rep(letters[1:10], each=30))

# add some NA
e at data$elev[288:300] <- NA
e at data$f[288:300] <- NA

# save sp object to shapefile
writeOGR(e, driver='ESRI Shapefile', dsn='.', layer='pts')


# the results from dumping the DBF:
[...]
285,1543,j
286,1518,j
287,1656,j
288,-2147483648,NA
289,-2147483648,NA
[...]


# one more try with the foreign package's write.dbf()
write.dbf(e at data, file='second_try.dbf')

# results: look better, although the '******' isn't a legal int!
[...]
285,1543,j
286,1518,j
287,1656,j
288,*******,
289,*******,
[...]


Any ideas on how to work with missing data in numeric columns, when
the dreaded DBF file is involved??? This is a real show-stopper when
sending vector data back to GRASS, as it seems to rely on intermediate
files. Maybe it would be a good idea to send  the geometry first, and
then the attribute data. There would still be a problem if the DBF
back-end is in use...

Cheers,

Dylan



From Roger.Bivand at nhh.no  Tue Oct  7 09:10:50 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 7 Oct 2008 09:10:50 +0200 (CEST)
Subject: [R-sig-Geo] writing shapefiles / DBF files when input data
 contains NA
In-Reply-To: <3c5546140810062121s15257912xea52d522d34151e7@mail.gmail.com>
References: <3c5546140810062121s15257912xea52d522d34151e7@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0810070857510.11660@reclus.nhh.no>

On Mon, 6 Oct 2008, Dylan Beaudette wrote:

> Hi,
>
> I have noticed that saving data to files that include a DBF, result in
> bogus data where there were NA. Using the write.dbf() function from
> the foreign package seems to work a little better, but I still get odd
> results in numeric columns. Writing to GRASS with the methods in the
> spgrass6 package results in some thing that looks like this:
>

Dylan,

I'm afraid that there is no good solution for this at all. DBF does not 
seem to have a clear and uniform NA treatment (or even !is.finite() 
treatment). The only work-around is to preprocess the data.frame in the 
output object to insert known NODATA values, and to replace those flags 
manually on the GRASS side. This could possibly be written as a wrapper 
around writeVECT6(). The help page does say:

     "Please note that the OGR drivers used may not handle missing data
      gracefully, and be prepared to have to correct for this manually.
      For example use of the 'readOGR' PostGIS driver directly may
      perform better than moving the data through the DBF driver used in
      this function - or a PostgreSQL driver used directly or through
      ODBC may be a solution. Do not rely on missing values of vector
      data moving smoothly across the interface."

I did try to look at the SQLite driver on the GRASS side, which might be 
more robust, but did not see how to proceed.

One possibility is not to recode, but to build an NA mask on the R side, 
and then loop over fields on the GRASS side for the chosen driver 
inserting NAs in the correct rows (whatever the syntax for that might be). 
Would this be db.execute with an insertion of SQL NULL?

Can we redirect this discussion to the statgrass list, because GRASS 
developers follow that list?

Best wishes,

Roger

> ### code snippet:
> writeVECT6(SDF=spatial.data, vname='pedons_grouped')
>
>
> ### errors:
> Projection of input dataset and current location appear to match
> Layer: pedons_g
> WARNING: Column name changed: 'describer.' -> 'describer_'
> WARNING: Column name changed: 'cat' -> 'cat_'
> Importing map 103 features...
> DBMI-DBF driver error:
> SQL parser error: @@rror, unexpected NAME processing 'nan'
> in statement:
> insert into pedons_grouped values ( 1, 'd2g1', 'alex',
> 32.311427999999999,      252.434875000000005,     7227.804688000000169,
> -0.000162000000000,           3,                      nan, 'NA',
> -2147483648, 'NA', 'NA', -2147483648, -2147483648, 'NA',
> nan, '1', 'NA' )
> Error in db_execute_immediate()
>
> ERROR: Cannot insert new row: insert into pedons_grouped values ( 1,
>       'd2g1', 'alex', 32.311427999999999, 252.434875000000005,
>       7227.804688000000169, -0.000162000000000, 3, nan, 'NA',
> -2147483648,
>       'NA', 'NA', -2147483648, -2147483648, 'NA', nan, '1', 'NA' )
>
>
> ### another self-contained example:
>
>
> # load libs
> library(sp)
> library(rgdal)
> library(foreign)
>
> # read in xy data and promote to sp object
> e <- read.csv(url('http://casoilresource.lawr.ucdavis.edu/drupal/files/elev.csv_.txt'))
> coordinates(e) <- ~ x+y
>
> # add a factor column
> e at data$f <- factor(rep(letters[1:10], each=30))
>
> # add some NA
> e at data$elev[288:300] <- NA
> e at data$f[288:300] <- NA
>
> # save sp object to shapefile
> writeOGR(e, driver='ESRI Shapefile', dsn='.', layer='pts')
>
>
> # the results from dumping the DBF:
> [...]
> 285,1543,j
> 286,1518,j
> 287,1656,j
> 288,-2147483648,NA
> 289,-2147483648,NA
> [...]
>
>
> # one more try with the foreign package's write.dbf()
> write.dbf(e at data, file='second_try.dbf')
>
> # results: look better, although the '******' isn't a legal int!
> [...]
> 285,1543,j
> 286,1518,j
> 287,1656,j
> 288,*******,
> 289,*******,
> [...]
>
>
> Any ideas on how to work with missing data in numeric columns, when
> the dreaded DBF file is involved??? This is a real show-stopper when
> sending vector data back to GRASS, as it seems to rely on intermediate
> files. Maybe it would be a good idea to send  the geometry first, and
> then the attribute data. There would still be a problem if the DBF
> back-end is in use...
>
> Cheers,
>
> Dylan
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From jorge.de-jesus at jrc.it  Tue Oct  7 16:32:40 2008
From: jorge.de-jesus at jrc.it (Jorge de Jesus)
Date: Tue, 07 Oct 2008 16:32:40 +0200
Subject: [R-sig-Geo] Virtual Machine with R packages
Message-ID: <48EB7308.6050606@jrc.it>

Hi to all

In a previous post I gave a link to a website that hosts a VMware
virtual machine with GIS software using Ubuntu as distribution, I was
thinking that this virtual machine had R installed but I was
incorrect....sorry

So I have downloaded the virtual machine and installed R-2.6.0  with the
libraries necessary to run the examples used in the book "Applied
Spatial Analysis with R", only the packages RSAGA and BRugs were left
out, because they can't be installed in a Linux distribution .

The virtual machine also has TerraLib, Rpy and Python IDE Eric.

The virtual machine is in a compressed file with 1.7Gigas, and it is
stored in a public place, with login/password access, if anyone needs
the virtual machine I will send a login/password and URL

Best
Jorge

-- 
Ph.D. Jorge Samuel Mendes de Jesus

European Commission (EC)
Joint Research Centre Directorate (DG JRC)
Institute for Environment and Sustainability (IES)
TP 441, Via Fermi 1
21020 Ispra (VA)
Italy

Phone: +39 0332 78 3536
Fax:   +39 0332 78 5466

http://rem.jrc.cec.eu.int

"The views expressed are purely those of the writer and may not in any circumstances be regarded as stating an official position of the European Commission"



From dylan.beaudette at gmail.com  Wed Oct  8 03:15:42 2008
From: dylan.beaudette at gmail.com (Dylan Beaudette)
Date: Tue, 7 Oct 2008 18:15:42 -0700
Subject: [R-sig-Geo] writing shapefiles / DBF files when input data
	contains NA
In-Reply-To: <Pine.LNX.4.64.0810070857510.11660@reclus.nhh.no>
References: <3c5546140810062121s15257912xea52d522d34151e7@mail.gmail.com>
	<Pine.LNX.4.64.0810070857510.11660@reclus.nhh.no>
Message-ID: <200810071815.42637.dylan.beaudette@gmail.com>

On Tuesday 07 October 2008, Roger Bivand wrote:
> On Mon, 6 Oct 2008, Dylan Beaudette wrote:
> > Hi,
> >
> > I have noticed that saving data to files that include a DBF, result in
> > bogus data where there were NA. Using the write.dbf() function from
> > the foreign package seems to work a little better, but I still get odd
> > results in numeric columns. Writing to GRASS with the methods in the
> > spgrass6 package results in some thing that looks like this:
>
> Dylan,
>
> I'm afraid that there is no good solution for this at all. DBF does not
> seem to have a clear and uniform NA treatment (or even !is.finite()
> treatment). The only work-around is to preprocess the data.frame in the
> output object to insert known NODATA values, and to replace those flags
> manually on the GRASS side. This could possibly be written as a wrapper
> around writeVECT6(). The help page does say:
>
>      "Please note that the OGR drivers used may not handle missing data
>       gracefully, and be prepared to have to correct for this manually.
>       For example use of the 'readOGR' PostGIS driver directly may
>       perform better than moving the data through the DBF driver used in
>       this function - or a PostgreSQL driver used directly or through
>       ODBC may be a solution. Do not rely on missing values of vector
>       data moving smoothly across the interface."
>
> I did try to look at the SQLite driver on the GRASS side, which might be
> more robust, but did not see how to proceed.
>
> One possibility is not to recode, but to build an NA mask on the R side,
> and then loop over fields on the GRASS side for the chosen driver
> inserting NAs in the correct rows (whatever the syntax for that might be).
> Would this be db.execute with an insertion of SQL NULL?
>
> Can we redirect this discussion to the statgrass list, because GRASS
> developers follow that list?
>
> Best wishes,
>
> Roger

Sorry for the cross-posting. Wanted to clarify where this thread is 
going/went.

Hi Roger--

It looks like the limiting factor in this equation is the code used in 
v.out.ogr. 

From the GRASS-dev + Frank W's help:

> > Sounds good :)
> > Does anyone know how to fix
> >  vector/v.out.ogr/main.c
> > to support NULLs? I see db_set_value_null() in
> >  lib/db/dbmi_base/value.c
> > which might be relevant.
>
> Markus,
>
> Once you establish which GRASS attributes are NULL, you can ensure they
> are pushed out to OGR as null by just skipping the step that sets them.
> Perhaps that will help a bit.


So, once v.out.ogr is fixed, this should clear up several issues:

1. import of vector data into R via spgrass6 methods
2. better compatibility of vector data exported from GRASS

I still do not know why writeOGR() does not create correct DBF files... it may 
be related to the code in v.out.ogr.... 

Cheers,

Dylan

-- 
Dylan Beaudette
Soil Resource Laboratory
http://casoilresource.lawr.ucdavis.edu/
University of California at Davis
530.754.7341



From dylan.beaudette at gmail.com  Wed Oct  8 05:55:22 2008
From: dylan.beaudette at gmail.com (Dylan Beaudette)
Date: Tue, 7 Oct 2008 20:55:22 -0700
Subject: [R-sig-Geo] [GRASS-stats] Re: writing shapefiles / DBF files
	when input data contains NA
In-Reply-To: <343999.6066.qm@web110015.mail.gq1.yahoo.com>
References: <200810071815.42637.dylan.beaudette@gmail.com>
	<343999.6066.qm@web110015.mail.gq1.yahoo.com>
Message-ID: <3c5546140810072055u35d91aebq17f3938e83918f36@mail.gmail.com>

On Tue, Oct 7, 2008 at 6:26 PM, Hamish <hamish_b at yahoo.com> wrote:
> Dylan:
>> It looks like the limiting factor in this equation is the
>> code used in v.out.ogr.
>
> maybe a silly question, but is a 3rd party format even needed here?
>
> $ ogrinfo --formats | grep -i grass
>  -> "GRASS" (readonly)
>
> at least in the one direction.
>

Excellent question. I had also wondered about this. It looks like
there is a new argument in readVECT():

# read in directly with GDAL/OGR -- no intermediate file:
x <- readVECT6('xxx', plugin=TRUE)

This is quite fast and depends on the GDAL-GRASS plugin... However,
NULL data in a GRASS table is not imported correctly-- character
fields are imported as '', and numeric fields as 0.

So... Is the error in GDAL itself?

I tried inspecting a vector from GRASS with NULL data in some of the
columns from the table, using ogrinfo -al
location/mapset/vector/xxx/head

OGRFeature(1):23
  cat (Integer) = 24
  cat_ (Integer) = 24
  str1 (String) = (null)
  xyz (Real) = (null)
  abc (Integer) = (null)
  POINT (591583 4925280 0)

... which seems to correctly report the NULL values.

This leads me to suspect that something in readOGR() and writeOGR are
at fault in handling of NULL values.

Unfortunately looking at the rgdal source code wasn't very productive
(my fault).

Cheers,

Dylan



From Gema.FAviles at uclm.es  Wed Oct  8 09:22:06 2008
From: Gema.FAviles at uclm.es (GEMA FERNANDEZ-AVILES CALDERON)
Date: Wed, 8 Oct 2008 09:22:06 +0200
Subject: [R-sig-Geo] Doubts about kriging (2 part)
In-Reply-To: <9010CBFE5DDC4027BA11AE54B979F212@DSB>
References: <BFE1525242E7DA4B9CBBDE2CF4DDBBFB41B619@EVSAB01.uclm.es>
	<9010CBFE5DDC4027BA11AE54B979F212@DSB>
Message-ID: <BFE1525242E7DA4B9CBBDE2CF4DDBBFB4AD256@EVSAB01.uclm.es>



Hi to everybody:


I would like to thank your suggestions, especially from the following
people.
 

-          David: very interesting suggestion. We will think about this.

-          Ashton: We have not more monitoring stations. 

-          Ruben: Box-Cox problems apart, Why do you choose to elaborate
an index with the observed values using PCA and then kriging the index? 

Don't you think that is better to krige every observed variable and then
elaborate the index? Myers (1983) suggests that this last option is
better in terms of MSE. However, in the literature everybody use the
first procedure.

Thanks in advance.

 Best regards,
Gema.







-----Mensaje original-----
De: David S. Bieri [mailto:dsb at vt.edu] 
Enviado el: jueves, 02 de octubre de 2008 23:09
Para: GEMA FERNANDEZ-AVILES CALDERON
Asunto: RE: [R-sig-Geo] Doubts about kriging

Hi Gema,

Just a quick general observation: Kriging/interpolation techniques for
CAPs
(criteria air pollutants) is problematic due to the way in which
atmospheric
influences distort the source-receptor distribution [ie how pollution
travels from source of emission (point sources? mobile source?) to where
it
is measured]. Without some sort of atmospheric model, you would need at
least a source-receptor matrix to get meaningful results 

[see eg. http://www.epa.gov/AMD/ModelDevelopment/index.html]

Kriging works well for things like precipitation, temperatures etc.
because
the spatial dispersion process that underlies them is very different
from
air pollutants.

Hope this helps,
David



-----Original Message-----
From: r-sig-geo-bounces at stat.math.ethz.ch
[mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of GEMA
FERNANDEZ-AVILES CALDERON
Sent: Thursday, October 02, 2008 5:25 AM
To: r-sig-geo at stat.math.ethz.ch
Subject: [R-sig-Geo] Doubts about kriging

Dear list,
 
I have two problem and I would like to know you opinion.
 
1.  I am kriging 6 environmental variables, SO2, NOx, O3, CO, NO, PM10,
to
built and enviromental index in R. I have standardized the observed
values
and I am implementing in geoR  the function likfit to obtain the
parameter
lambda (Box-Cox transformation) to see if the standarized variables are
normal. But I have error using the likfit function. 
It could be that the error arise because the standarized variables
contain
negative values?
 
2. I have values of the 6 variables at 25 locations but I want to use a
linear combination of the six variables to deal with only a variable.
Finally, I want to interpolate this only variable in several sites where
I
have not observed data. 
What do you think is better? 
- To interpolate each one of the six variables and then elaborate the
linear
combination.
- Or to elaborate a linear combination with the observed values and
finally
krige the linear combination.
 
Thanks in advance,
Gema Fernandez-Avilis
 
Universidad de Castilla-La Mancha.
(Spain)


	[[alternative HTML version deleted]]



From alexandre.villers at cebc.cnrs.fr  Wed Oct  8 12:52:05 2008
From: alexandre.villers at cebc.cnrs.fr (Alexandre VILLERS)
Date: Wed, 08 Oct 2008 12:52:05 +0200
Subject: [R-sig-Geo] convert data.frame into raster image
Message-ID: <48EC90D5.2030200@cebc.cnrs.fr>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081008/43bcbd38/attachment.html>

From p.hiemstra at geo.uu.nl  Wed Oct  8 14:07:47 2008
From: p.hiemstra at geo.uu.nl (Paul Hiemstra)
Date: Wed, 08 Oct 2008 14:07:47 +0200
Subject: [R-sig-Geo] convert data.frame into raster image
In-Reply-To: <48EC90D5.2030200@cebc.cnrs.fr>
References: <48EC90D5.2030200@cebc.cnrs.fr>
Message-ID: <48ECA293.90301@geo.uu.nl>

Hi,

You can take a look at the sp-package which provides Spatial objects for 
R, especially the coordinates-command. See the R-Spatial taskview for 
more info on spatial data in R 
(http://cran.r-project.org/web/views/Spatial.html).

cheers,
Paul

Alexandre VILLERS wrote:
> Good afternoon (even if it might be morning or evening for some of you),
>
> The question might appear ordinary.
> I have a large dataset where such dataframe is repeated
>
> Oct 1972    6.25    6.75    7.25    7.75    8.25
> 43.75    189    210    190    155    140
> 44.25    153    163    174    164    160
> 44.75    110    98    99    114    128
> 45.25    58    52    56    75    86
> 45.75    42    39    42    57    67
>
> with *rainfall values* for a given Month Year in function of (xy) 
> coordinates.
> I isolated each data.frame in an object but how can I turn this into a 
> raster image with the appropriate coordinates
> Don't need (for the moment !) to write me down the code but just let 
> me know which packages or funtion I could use.
> (the idea is then to link those values to birds' nests locations).
> Best regards
>
> Alex
>
>
> -- 
> Alexandre Villers
> PhD Student
> Team "Biodiversity"
> CEBC-CNRS UPR1934
> 79360 Beauvoir sur Niort
>
> Phone +33 (0)5 49 09 96 13
> Fax   +33 (0)5 49 09 65 26
>
>
> __________ Information from ESET Mail Security, version of virus 
> signature database 3503 (20081008) __________
>
> The message was checked by ESET Mail Security.
> http://www.eset.com
>
> part000.htm - is OK
> ------------------------------------------------------------------------
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   


-- 
Drs. Paul Hiemstra
Department of Physical Geography
Faculty of Geosciences
University of Utrecht
Heidelberglaan 2
P.O. Box 80.115
3508 TC Utrecht
Phone: 	+31302535773
Fax:	+31302531145
http://intamap.geo.uu.nl/~paul



From liov2067 at gmail.com  Wed Oct  8 17:15:53 2008
From: liov2067 at gmail.com (ivan valencia)
Date: Wed, 8 Oct 2008 12:15:53 -0300
Subject: [R-sig-Geo] CODE for spatial logistic regression
Message-ID: <684e31d40810080815w4ad17547pae674f205708fb3a@mail.gmail.com>

Hello

I need some guide about spatial logistic regression, Is it available a
code in R?

{}

LIOV



From liov2067 at gmail.com  Wed Oct  8 17:15:53 2008
From: liov2067 at gmail.com (ivan valencia)
Date: Wed, 8 Oct 2008 12:15:53 -0300
Subject: [R-sig-Geo] CODE for spatial logistic regression
Message-ID: <684e31d40810080815w4ad17547pae674f205708fb3a@mail.gmail.com>

Hello

I need some guide about spatial logistic regression, Is it available a
code in R?

{}

LIOV



From jnylen+rgeo at gmail.com  Wed Oct  8 17:27:34 2008
From: jnylen+rgeo at gmail.com (James Nylen)
Date: Wed, 8 Oct 2008 10:27:34 -0500
Subject: [R-sig-Geo] convert data.frame into raster image
In-Reply-To: <48EC90D5.2030200@cebc.cnrs.fr>
References: <48EC90D5.2030200@cebc.cnrs.fr>
Message-ID: <205a4c310810080827k750cd8d0pd70f0c233257712c@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081008/a3bb3686/attachment.pl>

From rroa at udec.cl  Wed Oct  8 17:40:57 2008
From: rroa at udec.cl (=?ISO-8859-1?Q?Rub=E9n_Roa-Ureta?=)
Date: Wed, 08 Oct 2008 11:40:57 -0400
Subject: [R-sig-Geo] CODE for spatial logistic regression
In-Reply-To: <684e31d40810080815w4ad17547pae674f205708fb3a@mail.gmail.com>
References: <684e31d40810080815w4ad17547pae674f205708fb3a@mail.gmail.com>
Message-ID: <48ECD489.3020207@udec.cl>

ivan valencia wrote:
> Hello
>
> I need some guide about spatial logistic regression, Is it available a
> code in R?
>
> {}
>
> LIOV
>   
You can try the functions in package geoRglm.
You can set binomial counts with spatial coordinates and fit a 
geostatistical logistic model in geoRglm.
HTH
R.



From liov2067 at gmail.com  Wed Oct  8 17:49:52 2008
From: liov2067 at gmail.com (ivan valencia)
Date: Wed, 8 Oct 2008 12:49:52 -0300
Subject: [R-sig-Geo] CODE for spatial logistic regression
In-Reply-To: <48ECD489.3020207@udec.cl>
References: <684e31d40810080815w4ad17547pae674f205708fb3a@mail.gmail.com>
	<48ECD489.3020207@udec.cl>
Message-ID: <684e31d40810080849v15a917a5n8d231e7e735f47d2@mail.gmail.com>

But I do not mean to do spatial interpolation, I need to adjust
logistic spatial model to area data..

liov

2008/10/8 Rub?n Roa-Ureta <rroa at udec.cl>:
> ivan valencia wrote:
>>
>> Hello
>>
>> I need some guide about spatial logistic regression, Is it available a
>> code in R?
>>
>> {}
>>
>> LIOV
>>
>
> You can try the functions in package geoRglm.
> You can set binomial counts with spatial coordinates and fit a
> geostatistical logistic model in geoRglm.
> HTH
> R.
>



-- 
Luis Iv?n Ortiz Valencia
Estat?stico Msc.
...............................................
http://oplanetaliov.blogspot.com/
...............................................



From eliaskrainski at yahoo.com.br  Wed Oct  8 17:55:32 2008
From: eliaskrainski at yahoo.com.br (Elias T. Krainski)
Date: Wed, 8 Oct 2008 08:55:32 -0700 (PDT)
Subject: [R-sig-Geo] CODE for spatial logistic regression
In-Reply-To: <684e31d40810080815w4ad17547pae674f205708fb3a@mail.gmail.com>
Message-ID: <414029.83306.qm@web50610.mail.re2.yahoo.com>

Dear Liov, 

Look at http://www.leg.ufpr.br/Rcitrus the R package with autologistic model for regular lattice. This package documentation is in portuguese. I am making another implementation of spatial and spatio-temporal autologistic model for both regular and irregular spatial lattice, the area data case. I believe that this implementation is concluded in next month. Look preliminary versions at 
 http://www.leg.ufpr.br/~elias/stLattice

Best regards,

Elias T. Krainski



--- Em qua, 8/10/08, ivan valencia <liov2067 at gmail.com> escreveu:

> De: ivan valencia <liov2067 at gmail.com>
> Assunto: [R-sig-Geo] CODE for spatial logistic regression
> Para: "r-sig-geo at stat.math.ethz.ch" <r-sig-geo at stat.math.ethz.ch>
> Data: Quarta-feira, 8 de Outubro de 2008, 12:15
> Hello
> 
> I need some guide about spatial logistic regression, Is it
> available a
> code in R?
> 
> {}
> 
> LIOV
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


      Novos endere?os, o Yahoo! que voc? conhece. Crie um email novo com a sua cara @ymail.com ou @rocketmail.com.
http://br.new.mail.yahoo.com/addresses



From dylan.beaudette at gmail.com  Wed Oct  8 17:59:55 2008
From: dylan.beaudette at gmail.com (Dylan Beaudette)
Date: Wed, 8 Oct 2008 08:59:55 -0700
Subject: [R-sig-Geo] CODE for spatial logistic regression
In-Reply-To: <684e31d40810080849v15a917a5n8d231e7e735f47d2@mail.gmail.com>
References: <684e31d40810080815w4ad17547pae674f205708fb3a@mail.gmail.com>
	<48ECD489.3020207@udec.cl>
	<684e31d40810080849v15a917a5n8d231e7e735f47d2@mail.gmail.com>
Message-ID: <200810080859.55950.dylan.beaudette@gmail.com>

On Wednesday 08 October 2008, ivan valencia wrote:
> But I do not mean to do spatial interpolation, I need to adjust
> logistic spatial model to area data..
>
> liov

Can you elaborate with an example? Are you suggesting weighting a logistic 
regression with area values associated with observations?

Cheers,

Dylan


> 2008/10/8 Rub?n Roa-Ureta <rroa at udec.cl>:
> > ivan valencia wrote:
> >> Hello
> >>
> >> I need some guide about spatial logistic regression, Is it available a
> >> code in R?
> >>
> >> {}
> >>
> >> LIOV
> >
> > You can try the functions in package geoRglm.
> > You can set binomial counts with spatial coordinates and fit a
> > geostatistical logistic model in geoRglm.
> > HTH
> > R.



-- 
Dylan Beaudette
Soil Resource Laboratory
http://casoilresource.lawr.ucdavis.edu/
University of California at Davis
530.754.7341



From dylan.beaudette at gmail.com  Wed Oct  8 18:01:34 2008
From: dylan.beaudette at gmail.com (Dylan Beaudette)
Date: Wed, 8 Oct 2008 09:01:34 -0700
Subject: [R-sig-Geo] writing shapefiles / DBF files when input data
	contains NA
In-Reply-To: <200810071815.42637.dylan.beaudette@gmail.com>
References: <3c5546140810062121s15257912xea52d522d34151e7@mail.gmail.com>
	<Pine.LNX.4.64.0810070857510.11660@reclus.nhh.no>
	<200810071815.42637.dylan.beaudette@gmail.com>
Message-ID: <200810080901.34463.dylan.beaudette@gmail.com>

On Tuesday 07 October 2008, Dylan Beaudette wrote:
> On Tuesday 07 October 2008, Roger Bivand wrote:
> > On Mon, 6 Oct 2008, Dylan Beaudette wrote:
> > > Hi,
> > >
> > > I have noticed that saving data to files that include a DBF, result in
> > > bogus data where there were NA. Using the write.dbf() function from
> > > the foreign package seems to work a little better, but I still get odd
> > > results in numeric columns. Writing to GRASS with the methods in the
> > > spgrass6 package results in some thing that looks like this:
> >
> > Dylan,
> >
> > I'm afraid that there is no good solution for this at all. DBF does not
> > seem to have a clear and uniform NA treatment (or even !is.finite()
> > treatment). The only work-around is to preprocess the data.frame in the
> > output object to insert known NODATA values, and to replace those flags
> > manually on the GRASS side. This could possibly be written as a wrapper
> > around writeVECT6(). The help page does say:
> >
> >      "Please note that the OGR drivers used may not handle missing data
> >       gracefully, and be prepared to have to correct for this manually.
> >       For example use of the 'readOGR' PostGIS driver directly may
> >       perform better than moving the data through the DBF driver used in
> >       this function - or a PostgreSQL driver used directly or through
> >       ODBC may be a solution. Do not rely on missing values of vector
> >       data moving smoothly across the interface."
> >
> > I did try to look at the SQLite driver on the GRASS side, which might be
> > more robust, but did not see how to proceed.
> >
> > One possibility is not to recode, but to build an NA mask on the R side,
> > and then loop over fields on the GRASS side for the chosen driver
> > inserting NAs in the correct rows (whatever the syntax for that might
> > be). Would this be db.execute with an insertion of SQL NULL?
> >
> > Can we redirect this discussion to the statgrass list, because GRASS
> > developers follow that list?
> >
> > Best wishes,
> >
> > Roger
>
> Sorry for the cross-posting. Wanted to clarify where this thread is
> going/went.
>
> Hi Roger--
>
> It looks like the limiting factor in this equation is the code used in
> v.out.ogr.
>
> >From the GRASS-dev + Frank W's help:
> > > Sounds good :)
> > > Does anyone know how to fix
> > >  vector/v.out.ogr/main.c
> > > to support NULLs? I see db_set_value_null() in
> > >  lib/db/dbmi_base/value.c
> > > which might be relevant.
> >
> > Markus,
> >
> > Once you establish which GRASS attributes are NULL, you can ensure they
> > are pushed out to OGR as null by just skipping the step that sets them.
> > Perhaps that will help a bit.
>
> So, once v.out.ogr is fixed, this should clear up several issues:
>
> 1. import of vector data into R via spgrass6 methods
> 2. better compatibility of vector data exported from GRASS
>
> I still do not know why writeOGR() does not create correct DBF files... it
> may be related to the code in v.out.ogr....
>
> Cheers,
>
> Dylan

Some follow-up: the incorrect handling of NULL values appears to be related to 
the current implementation of v.out.ogr AND readOGR() / writeOGR().

Dylan

-- 
Dylan Beaudette
Soil Resource Laboratory
http://casoilresource.lawr.ucdavis.edu/
University of California at Davis
530.754.7341



From liov2067 at gmail.com  Wed Oct  8 18:12:45 2008
From: liov2067 at gmail.com (ivan valencia)
Date: Wed, 8 Oct 2008 13:12:45 -0300
Subject: [R-sig-Geo] CODE for spatial logistic regression
In-Reply-To: <200810080859.55950.dylan.beaudette@gmail.com>
References: <684e31d40810080815w4ad17547pae674f205708fb3a@mail.gmail.com>
	<48ECD489.3020207@udec.cl>
	<684e31d40810080849v15a917a5n8d231e7e735f47d2@mail.gmail.com>
	<200810080859.55950.dylan.beaudette@gmail.com>
Message-ID: <684e31d40810080912x2f33b9b2mf26ed9dbf584a31c@mail.gmail.com>

Well, it is for modelling spatial binary data with spatial
covariables( continuous or discrete)
try incorporate spatial neighboorhod in the model.

Solution of Rub?n is interesting, ok Many thanks..
liov

2008/10/8 Dylan Beaudette <dylan.beaudette at gmail.com>:
> On Wednesday 08 October 2008, ivan valencia wrote:
>> But I do not mean to do spatial interpolation, I need to adjust
>> logistic spatial model to area data..
>>
>> liov
>
> Can you elaborate with an example? Are you suggesting weighting a logistic
> regression with area values associated with observations?
>
> Cheers,
>
> Dylan
>
>
>> 2008/10/8 Rub?n Roa-Ureta <rroa at udec.cl>:
>> > ivan valencia wrote:
>> >> Hello
>> >>
>> >> I need some guide about spatial logistic regression, Is it available a
>> >> code in R?
>> >>
>> >> {}
>> >>
>> >> LIOV
>> >
>> > You can try the functions in package geoRglm.
>> > You can set binomial counts with spatial coordinates and fit a
>> > geostatistical logistic model in geoRglm.
>> > HTH
>> > R.
>
>
>
> --
> Dylan Beaudette
> Soil Resource Laboratory
> http://casoilresource.lawr.ucdavis.edu/
> University of California at Davis
> 530.754.7341
>



-- 
Luis Iv?n Ortiz Valencia
Estat?stico Msc.
...............................................
http://oplanetaliov.blogspot.com/
...............................................



From Roger.Bivand at nhh.no  Wed Oct  8 19:22:30 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 8 Oct 2008 19:22:30 +0200 (CEST)
Subject: [R-sig-Geo] writing shapefiles / DBF files when input data
 contains NA
In-Reply-To: <200810080901.34463.dylan.beaudette@gmail.com>
References: <3c5546140810062121s15257912xea52d522d34151e7@mail.gmail.com>
	<Pine.LNX.4.64.0810070857510.11660@reclus.nhh.no>
	<200810071815.42637.dylan.beaudette@gmail.com>
	<200810080901.34463.dylan.beaudette@gmail.com>
Message-ID: <Pine.LNX.4.64.0810081813030.23179@reclus.nhh.no>

On Wed, 8 Oct 2008, Dylan Beaudette wrote:

> On Tuesday 07 October 2008, Dylan Beaudette wrote:
>> On Tuesday 07 October 2008, Roger Bivand wrote:
>>> On Mon, 6 Oct 2008, Dylan Beaudette wrote:
>>>> Hi,
>>>>
>>>> I have noticed that saving data to files that include a DBF, result in
>>>> bogus data where there were NA. Using the write.dbf() function from
>>>> the foreign package seems to work a little better, but I still get odd
>>>> results in numeric columns. Writing to GRASS with the methods in the
>>>> spgrass6 package results in some thing that looks like this:
>>>
>>> Dylan,
>>>
>>> I'm afraid that there is no good solution for this at all. DBF does not
>>> seem to have a clear and uniform NA treatment (or even !is.finite()
>>> treatment). The only work-around is to preprocess the data.frame in the
>>> output object to insert known NODATA values, and to replace those flags
>>> manually on the GRASS side. This could possibly be written as a wrapper
>>> around writeVECT6(). The help page does say:
>>>
>>>      "Please note that the OGR drivers used may not handle missing data
>>>       gracefully, and be prepared to have to correct for this manually.
>>>       For example use of the 'readOGR' PostGIS driver directly may
>>>       perform better than moving the data through the DBF driver used in
>>>       this function - or a PostgreSQL driver used directly or through
>>>       ODBC may be a solution. Do not rely on missing values of vector
>>>       data moving smoothly across the interface."
>>>
>>> I did try to look at the SQLite driver on the GRASS side, which might be
>>> more robust, but did not see how to proceed.
>>>
>>> One possibility is not to recode, but to build an NA mask on the R side,
>>> and then loop over fields on the GRASS side for the chosen driver
>>> inserting NAs in the correct rows (whatever the syntax for that might
>>> be). Would this be db.execute with an insertion of SQL NULL?
>>>
>>> Can we redirect this discussion to the statgrass list, because GRASS
>>> developers follow that list?
>>>
>>> Best wishes,
>>>
>>> Roger
>>
>> Sorry for the cross-posting. Wanted to clarify where this thread is
>> going/went.
>>
>> Hi Roger--
>>
>> It looks like the limiting factor in this equation is the code used in
>> v.out.ogr.
>>
>>> From the GRASS-dev + Frank W's help:
>>>> Sounds good :)
>>>> Does anyone know how to fix
>>>>  vector/v.out.ogr/main.c
>>>> to support NULLs? I see db_set_value_null() in
>>>>  lib/db/dbmi_base/value.c
>>>> which might be relevant.
>>>
>>> Markus,
>>>
>>> Once you establish which GRASS attributes are NULL, you can ensure they
>>> are pushed out to OGR as null by just skipping the step that sets them.
>>> Perhaps that will help a bit.
>>
>> So, once v.out.ogr is fixed, this should clear up several issues:
>>
>> 1. import of vector data into R via spgrass6 methods
>> 2. better compatibility of vector data exported from GRASS
>>
>> I still do not know why writeOGR() does not create correct DBF files... it
>> may be related to the code in v.out.ogr....
>>
>> Cheers,
>>
>> Dylan
>
> Some follow-up: the incorrect handling of NULL values appears to be related to
> the current implementation of v.out.ogr AND readOGR() / writeOGR().

OK, this makes sense, because parts of readOGR() / writeOGR() were written 
based on the logic of v.in.ogr and v.out.ogr, and more attention was given 
to the geometries than the attribute fields. If the GRASS code was taking 
liberties with handling NAs, then that behaviour is very probably present 
in readOGR() / writeOGR() too.

The rgdal package has a public sourceforge CVS repository, so everybody 
please feel free to browse for bugs. It would be helpful to have a set of 
vector files with valid NAs (not just shapefiles), and a set of sp objects 
with NAs, and to be able to move them in and out of both R and GRASS (and 
other software) with the NAs intact.

As a first bite, OGRFeature::IsFieldSet() seems to test whether the field 
is set or not. It isn't used in ogrReadColumn() in src/ogrsource.cpp in 
rgdal, nor the equivalent in OGR_write() in src/OGR_write.cpp.

Assuming that we can correct these to use OGR NULL data representations 
(would that be unset the field for the feature?), we then depend on the 
drivers using the same logic. In addition, non-OGR written files need to 
use the same understanding of NULL as the OGR drivers. GRASS v.in.ogr() 
does use OGR_F_IsFieldSet(), and if not set writes a NULL to numeric 
fields and an empty string to the others. Fixing writeOGR() ought to get 
NAs from R to GRASS. v.out.ogr does not seem to use OGR_F_UnsetField() on 
the fields being output, and readOGR() does not test for the fields being 
unset either - so getting NAs from GRASS to R needs more work.

This is described in extenso here because things don't happen by 
themselves, and this particular overlap of R/OGR/GRASS code probably 
matters to regular users of rgdal. Collaboration in fixing the handling of 
NAs in vector data files invited!

Roger

>
> Dylan
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From dylan.beaudette at gmail.com  Wed Oct  8 23:05:58 2008
From: dylan.beaudette at gmail.com (Dylan Beaudette)
Date: Wed, 8 Oct 2008 14:05:58 -0700
Subject: [R-sig-Geo] writing shapefiles / DBF files when input data
	contains NA
In-Reply-To: <Pine.LNX.4.64.0810081813030.23179@reclus.nhh.no>
References: <3c5546140810062121s15257912xea52d522d34151e7@mail.gmail.com>
	<200810080901.34463.dylan.beaudette@gmail.com>
	<Pine.LNX.4.64.0810081813030.23179@reclus.nhh.no>
Message-ID: <200810081405.58290.dylan.beaudette@gmail.com>

On Wednesday 08 October 2008, Roger Bivand wrote:
> On Wed, 8 Oct 2008, Dylan Beaudette wrote:
> > On Tuesday 07 October 2008, Dylan Beaudette wrote:
> >> On Tuesday 07 October 2008, Roger Bivand wrote:
> >>> On Mon, 6 Oct 2008, Dylan Beaudette wrote:
> >>>> Hi,
> >>>>
> >>>> I have noticed that saving data to files that include a DBF, result in
> >>>> bogus data where there were NA. Using the write.dbf() function from
> >>>> the foreign package seems to work a little better, but I still get odd
> >>>> results in numeric columns. Writing to GRASS with the methods in the
> >>>> spgrass6 package results in some thing that looks like this:
> >>>
> >>> Dylan,
> >>>
> >>> I'm afraid that there is no good solution for this at all. DBF does not
> >>> seem to have a clear and uniform NA treatment (or even !is.finite()
> >>> treatment). The only work-around is to preprocess the data.frame in the
> >>> output object to insert known NODATA values, and to replace those flags
> >>> manually on the GRASS side. This could possibly be written as a wrapper
> >>> around writeVECT6(). The help page does say:
> >>>
> >>>      "Please note that the OGR drivers used may not handle missing data
> >>>       gracefully, and be prepared to have to correct for this manually.
> >>>       For example use of the 'readOGR' PostGIS driver directly may
> >>>       perform better than moving the data through the DBF driver used
> >>> in this function - or a PostgreSQL driver used directly or through ODBC
> >>> may be a solution. Do not rely on missing values of vector data moving
> >>> smoothly across the interface."
> >>>
> >>> I did try to look at the SQLite driver on the GRASS side, which might
> >>> be more robust, but did not see how to proceed.
> >>>
> >>> One possibility is not to recode, but to build an NA mask on the R
> >>> side, and then loop over fields on the GRASS side for the chosen driver
> >>> inserting NAs in the correct rows (whatever the syntax for that might
> >>> be). Would this be db.execute with an insertion of SQL NULL?
> >>>
> >>> Can we redirect this discussion to the statgrass list, because GRASS
> >>> developers follow that list?
> >>>
> >>> Best wishes,
> >>>
> >>> Roger
> >>
> >> Sorry for the cross-posting. Wanted to clarify where this thread is
> >> going/went.
> >>
> >> Hi Roger--
> >>
> >> It looks like the limiting factor in this equation is the code used in
> >> v.out.ogr.
> >>
> >>> From the GRASS-dev + Frank W's help:
> >>>> Sounds good :)
> >>>> Does anyone know how to fix
> >>>>  vector/v.out.ogr/main.c
> >>>> to support NULLs? I see db_set_value_null() in
> >>>>  lib/db/dbmi_base/value.c
> >>>> which might be relevant.
> >>>
> >>> Markus,
> >>>
> >>> Once you establish which GRASS attributes are NULL, you can ensure they
> >>> are pushed out to OGR as null by just skipping the step that sets them.
> >>> Perhaps that will help a bit.
> >>
> >> So, once v.out.ogr is fixed, this should clear up several issues:
> >>
> >> 1. import of vector data into R via spgrass6 methods
> >> 2. better compatibility of vector data exported from GRASS
> >>
> >> I still do not know why writeOGR() does not create correct DBF files...
> >> it may be related to the code in v.out.ogr....
> >>
> >> Cheers,
> >>
> >> Dylan
> >
> > Some follow-up: the incorrect handling of NULL values appears to be
> > related to the current implementation of v.out.ogr AND readOGR() /
> > writeOGR().
>
> OK, this makes sense, because parts of readOGR() / writeOGR() were written
> based on the logic of v.in.ogr and v.out.ogr, and more attention was given
> to the geometries than the attribute fields. If the GRASS code was taking
> liberties with handling NAs, then that behaviour is very probably present
> in readOGR() / writeOGR() too.

If that is the case, then a fix for one should easily be 'ported'  to the 
other. A place to start looking for an answer would probably be the source 
for v.in.ogr -- as this correctly preserves NULL data when importing from 
shapefiles... haven't tried anything else.

> The rgdal package has a public sourceforge CVS repository, so everybody
> please feel free to browse for bugs. It would be helpful to have a set of
> vector files with valid NAs (not just shapefiles), and a set of sp objects
> with NAs, and to be able to move them in and out of both R and GRASS (and
> other software) with the NAs intact.

Attached to this message is one such shapefile-- sorry I do not have another 
vector format.

> As a first bite, OGRFeature::IsFieldSet() seems to test whether the field
> is set or not. It isn't used in ogrReadColumn() in src/ogrsource.cpp in
> rgdal, nor the equivalent in OGR_write() in src/OGR_write.cpp.
>
> Assuming that we can correct these to use OGR NULL data representations
> (would that be unset the field for the feature?), we then depend on the
> drivers using the same logic. In addition, non-OGR written files need to
> use the same understanding of NULL as the OGR drivers. GRASS v.in.ogr()
> does use OGR_F_IsFieldSet(), and if not set writes a NULL to numeric
> fields and an empty string to the others. Fixing writeOGR() ought to get
> NAs from R to GRASS. v.out.ogr does not seem to use OGR_F_UnsetField() on
> the fields being output, and readOGR() does not test for the fields being
> unset either - so getting NAs from GRASS to R needs more work.
>
> This is described in extenso here because things don't happen by
> themselves, and this particular overlap of R/OGR/GRASS code probably
> matters to regular users of rgdal. Collaboration in fixing the handling of
> NAs in vector data files invited!
>
> Roger
>

Maybe this bit from M. Neteler / Frank W. will help:

Markus:
> ?vector/v.out.ogr/main.c
> to support NULLs? I see db_set_value_null() in
> ?lib/db/dbmi_base/value.c
> which might be relevant.

Frank:
> Once you establish which GRASS attributes are NULL, you can ensure they
> are pushed out to OGR as null by just skipping the step that sets them.
> Perhaps that will help a bit.

Cheers,

Dylan

-------------- next part --------------
PROJCS["NAD_1927_UTM_Zone_13N",GEOGCS["GCS_North_American_1927",DATUM["D_North_American_1927",SPHEROID["Clarke_1866",6378206.4,294.978698213898]],PRIMEM["Greenwich",0],UNIT["Degree",0.017453292519943295]],PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETER["central_meridian",-105],PARAMETER["scale_factor",0.9996],PARAMETER["false_easting",500000],PARAMETER["false_northing",0],UNIT["Meter",1]]
-------------- next part --------------
A non-text attachment was scrubbed...
Name: a_temp2.shx
Type: application/octet-stream
Size: 300 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081008/290af92e/attachment.obj>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: a_temp2.dbf
Type: application/x-dbase
Size: 1518 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081008/290af92e/attachment.bin>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: a_temp2.shp
Type: application/octet-stream
Size: 800 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081008/290af92e/attachment-0001.obj>

From Henk.Sierdsema at sovon.nl  Thu Oct  9 14:01:24 2008
From: Henk.Sierdsema at sovon.nl (Henk Sierdsema)
Date: Thu, 9 Oct 2008 14:01:24 +0200
Subject: [R-sig-Geo] CODE for spatial logistic regression
In-Reply-To: <684e31d40810080815w4ad17547pae674f205708fb3a@mail.gmail.com>
Message-ID: <F7A3EE6B27F4D54B9CCAAB767F1B5AA3FDB4DB@mail.sovon.nl>

Hi Ivan,

Can you tell me what the purpose is of your modelling? Is it simply producing spatial predictions based on a logistic model or do you want to incorporate spatial autocorrelation in the models? Given your last mail it seems you want to incorporate spatial autocorrelation despite the fact that you deny this in your second mail. So please extend more on the type of data you have and your aim. Next to geoRglm, which is only suitable for small datasets, you might also try regression-kriging.

Is there by the way anyone who has experience with autoregressive models?

Henk



Henk Sierdsema

SOVON Vogelonderzoek Nederland / SOVON Dutch Centre for Field Ornithology

Rijksstraatweg 178
6573 DG  Beek-Ubbergen
The Netherlands
tel: +31 (0)24 6848145
fax: +31 (0)24 6848122



-----Oorspronkelijk bericht-----
Van: ivan valencia [mailto:liov2067 at gmail.com]
Verzonden: woensdag 8 oktober 2008 17:16
Aan: r-sig-geo at stat.math.ethz.ch
Onderwerp: [R-sig-Geo] CODE for spatial logistic regression


Hello

I need some guide about spatial logistic regression, Is it available a
code in R?

{}

LIOV

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch
https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From lassana60 at gmail.com  Thu Oct  9 14:12:08 2008
From: lassana60 at gmail.com (=?ISO-8859-1?Q?Lassana_Tour=E9?=)
Date: Thu, 9 Oct 2008 12:12:08 +0000
Subject: [R-sig-Geo] plotting Ripley fonctions
Message-ID: <8ca3c0ca0810090512w799b9af6mc3141a7e6dbd7fde@mail.gmail.com>

Hi.
I need some help for plotting L(r) and Lcross so that I can have my
confidence interval(CI) parallel to X axis.
The plot I have obtain so far the graphic is not horizontal, then it
is difficult to interpret strong the aggregation is or the attraction.
thanks



From liov2067 at gmail.com  Thu Oct  9 14:17:21 2008
From: liov2067 at gmail.com (ivan valencia)
Date: Thu, 9 Oct 2008 09:17:21 -0300
Subject: [R-sig-Geo] CODE for spatial logistic regression
In-Reply-To: <F7A3EE6B27F4D54B9CCAAB767F1B5AA3FDB4DB@mail.sovon.nl>
References: <684e31d40810080815w4ad17547pae674f205708fb3a@mail.gmail.com>
	<F7A3EE6B27F4D54B9CCAAB767F1B5AA3FDB4DB@mail.sovon.nl>
Message-ID: <684e31d40810090517k7d776c6dw3243f93c2f828735@mail.gmail.com>

Hi HENK

My data comes from land use classification, a grid with 1km2 resolution.
I have a bynary classification with 4 types of land use, for each land use type
have to run a logistic regression with available covariables also at
the same raster format.
I want to consider spatial logistic regression...is it possible?
{}
ivan

2008/10/9 Henk Sierdsema <Henk.Sierdsema at sovon.nl>:
> Hi Ivan,
>
> Can you tell me what the purpose is of your modelling? Is it simply producing spatial predictions based on a logistic model or do you want to incorporate spatial autocorrelation in the models? Given your last mail it seems you want to incorporate spatial autocorrelation despite the fact that you deny this in your second mail. So please extend more on the type of data you have and your aim. Next to geoRglm, which is only suitable for small datasets, you might also try regression-kriging.
>
> Is there by the way anyone who has experience with autoregressive models?
>
> Henk
>
>
>
> Henk Sierdsema
>
> SOVON Vogelonderzoek Nederland / SOVON Dutch Centre for Field Ornithology
>
> Rijksstraatweg 178
> 6573 DG  Beek-Ubbergen
> The Netherlands
> tel: +31 (0)24 6848145
> fax: +31 (0)24 6848122
>
>
>
> -----Oorspronkelijk bericht-----
> Van: ivan valencia [mailto:liov2067 at gmail.com]
> Verzonden: woensdag 8 oktober 2008 17:16
> Aan: r-sig-geo at stat.math.ethz.ch
> Onderwerp: [R-sig-Geo] CODE for spatial logistic regression
>
>
> Hello
>
> I need some guide about spatial logistic regression, Is it available a
> code in R?
>
> {}
>
> LIOV
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Luis Iv?n Ortiz Valencia
Estat?stico Msc.
...............................................
http://oplanetaliov.blogspot.com/
...............................................



From rroa at udec.cl  Thu Oct  9 14:23:03 2008
From: rroa at udec.cl (=?ISO-8859-1?Q?Rub=E9n_Roa-Ureta?=)
Date: Thu, 09 Oct 2008 08:23:03 -0400
Subject: [R-sig-Geo] CODE for spatial logistic regression
In-Reply-To: <F7A3EE6B27F4D54B9CCAAB767F1B5AA3FDB4DB@mail.sovon.nl>
References: <F7A3EE6B27F4D54B9CCAAB767F1B5AA3FDB4DB@mail.sovon.nl>
Message-ID: <48EDF7A7.2090705@udec.cl>

Henk Sierdsema wrote:
> Hi Ivan,
>
> Can you tell me what the purpose is of your modelling? Is it simply producing spatial predictions based on a logistic model or do you want to incorporate spatial autocorrelation in the models? Given your last mail it seems you want to incorporate spatial autocorrelation despite the fact that you deny this in your second mail. So please extend more on the type of data you have and your aim. Next to geoRglm, which is only suitable for small datasets, you might also try regression-kriging.
>
> Is there by the way anyone who has experience with autoregressive models?
>
> Henk
>
>
>
> Henk Sierdsema
>
> SOVON Vogelonderzoek Nederland / SOVON Dutch Centre for Field Ornithology
>
> Rijksstraatweg 178
> 6573 DG  Beek-Ubbergen
> The Netherlands
> tel: +31 (0)24 6848145
> fax: +31 (0)24 6848122
>   
What do you mean by small datasets?
I have used geoRglm to fit spatial binomial models with hundreds of 
point observations.
One approach that would allow the fit of models with even thousand of 
point observations with geoRglm is to create spatial cells (i.e. 
logistic regression with grouped data) and count the number of trials 
and successes in each cell. I implemented that approach in Roa-Ureta and 
Niklitschek, 2007, Biomass estimation from surveys with liklihood-based 
geostatistics, ICES Journal of Marine Science 64:1723-1734.
Rub?n



From Henk.Sierdsema at sovon.nl  Thu Oct  9 14:28:09 2008
From: Henk.Sierdsema at sovon.nl (Henk Sierdsema)
Date: Thu, 9 Oct 2008 14:28:09 +0200
Subject: [R-sig-Geo] CODE for spatial logistic regression
In-Reply-To: <684e31d40810090517k7d776c6dw3243f93c2f828735@mail.gmail.com>
Message-ID: <F7A3EE6B27F4D54B9CCAAB767F1B5AA3FDB4DE@mail.sovon.nl>

Hi Ivan,

I have uploaded two papers from Tom Hengl et al on this subject for you. This should give you a good idea how to solve the problem.

www.sovon.nl/temp/Hengl1.pdf
www.sovon.nl/temp/Hengl2.pdf

Henk



Henk Sierdsema

SOVON Vogelonderzoek Nederland / SOVON Dutch Centre for Field Ornithology

Rijksstraatweg 178
6573 DG  Beek-Ubbergen
The Netherlands
tel: +31 (0)24 6848145
fax: +31 (0)24 6848122



-----Oorspronkelijk bericht-----
Van: ivan valencia [mailto:liov2067 at gmail.com]
Verzonden: donderdag 9 oktober 2008 14:17
Aan: Henk Sierdsema
CC: r-sig-geo at stat.math.ethz.ch
Onderwerp: Re: [R-sig-Geo] CODE for spatial logistic regression


Hi HENK

My data comes from land use classification, a grid with 1km2 resolution.
I have a bynary classification with 4 types of land use, for each land use type
have to run a logistic regression with available covariables also at
the same raster format.
I want to consider spatial logistic regression...is it possible?
{}
ivan

2008/10/9 Henk Sierdsema <Henk.Sierdsema at sovon.nl>:
> Hi Ivan,
>
> Can you tell me what the purpose is of your modelling? Is it simply producing spatial predictions based on a logistic model or do you want to incorporate spatial autocorrelation in the models? Given your last mail it seems you want to incorporate spatial autocorrelation despite the fact that you deny this in your second mail. So please extend more on the type of data you have and your aim. Next to geoRglm, which is only suitable for small datasets, you might also try regression-kriging.
>
> Is there by the way anyone who has experience with autoregressive models?
>
> Henk
>
>
>
> Henk Sierdsema
>
> SOVON Vogelonderzoek Nederland / SOVON Dutch Centre for Field Ornithology
>
> Rijksstraatweg 178
> 6573 DG  Beek-Ubbergen
> The Netherlands
> tel: +31 (0)24 6848145
> fax: +31 (0)24 6848122
>
>
>
> -----Oorspronkelijk bericht-----
> Van: ivan valencia [mailto:liov2067 at gmail.com]
> Verzonden: woensdag 8 oktober 2008 17:16
> Aan: r-sig-geo at stat.math.ethz.ch
> Onderwerp: [R-sig-Geo] CODE for spatial logistic regression
>
>
> Hello
>
> I need some guide about spatial logistic regression, Is it available a
> code in R?
>
> {}
>
> LIOV
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Luis Iv?n Ortiz Valencia
Estat?stico Msc.
...............................................
http://oplanetaliov.blogspot.com/
...............................................



From brenning at uwaterloo.ca  Thu Oct  9 14:58:35 2008
From: brenning at uwaterloo.ca (Alexander Brenning)
Date: Thu, 09 Oct 2008 08:58:35 -0400
Subject: [R-sig-Geo] CODE for spatial logistic regression
In-Reply-To: <684e31d40810090517k7d776c6dw3243f93c2f828735@mail.gmail.com>
References: <684e31d40810080815w4ad17547pae674f205708fb3a@mail.gmail.com>	<F7A3EE6B27F4D54B9CCAAB767F1B5AA3FDB4DB@mail.sovon.nl>
	<684e31d40810090517k7d776c6dw3243f93c2f828735@mail.gmail.com>
Message-ID: <48EDFFFB.9030007@uwaterloo.ca>

Hi,

landcover classification with four classes... though I haven't 
experimented with spatial logistic regression, I would expect that there 
is more information in the spectral satellite data (feature space) that 
you are probably using as predictors than in the adjacency/distance 
information. The very nature of a categorical response variable implies 
that the response is discontinuous in geographic space, so a 
kriging-type approach would only help if you had high sampling density 
in your learning sample (several samples within each homogeneous 
landcover polygon - not a typical situation).

The feature-space perspective - ignoring geographic space - allows you 
to look at many excellent classification techniques that make best use 
of your predictor variables; have a look at the book of D.J. Hand: 
"Construction and assessment of classification techniques" for an 
overview. On the other hand, spatial continuity is often achieved by 
applying filters to the resulting prediction image.

Here a recent comparison of different classification techniques in crop 
identification:
http://www.zfl.uni-bonn.de/earsel/papers/64-71_brenning.pdf

Multinomial (non-spatial) logistic regression was pretty, support vector 
machine performed better. A comparison with spatial log.reg. would of 
course be interesting.

Maybe the more important spatial issue in using classification 
techniques is the question of error assessment in a spatial context, 
e.g. using a spatial cross-validation, or in the above paper 
cross-validation at the field level.

By the way, I am organizing a special session on Spatial Classification 
at the meeting of the International Federation of Classification 
Societies (IFCS) in March 2009 in Dresden, Germany. Theoretical and 
applied contributions are welcome, abstract deadline November 3rd. See 
http://www.ifcs2009.de/

Cheers
  Alex



ivan valencia wrote:
> Hi HENK
> 
> My data comes from land use classification, a grid with 1km2 resolution.
> I have a bynary classification with 4 types of land use, for each land use type
> have to run a logistic regression with available covariables also at
> the same raster format.
> I want to consider spatial logistic regression...is it possible?
> {}
> ivan
> 
> 2008/10/9 Henk Sierdsema <Henk.Sierdsema at sovon.nl>:
>> Hi Ivan,
>>
>> Can you tell me what the purpose is of your modelling? Is it simply producing spatial predictions based on a logistic model or do you want to incorporate spatial autocorrelation in the models? Given your last mail it seems you want to incorporate spatial autocorrelation despite the fact that you deny this in your second mail. So please extend more on the type of data you have and your aim. Next to geoRglm, which is only suitable for small datasets, you might also try regression-kriging.
>>
>> Is there by the way anyone who has experience with autoregressive models?
>>
>> Henk
>>
>>
>>
>> Henk Sierdsema
>>
>> SOVON Vogelonderzoek Nederland / SOVON Dutch Centre for Field Ornithology
>>
>> Rijksstraatweg 178
>> 6573 DG  Beek-Ubbergen
>> The Netherlands
>> tel: +31 (0)24 6848145
>> fax: +31 (0)24 6848122
>>
>>
>>
>> -----Oorspronkelijk bericht-----
>> Van: ivan valencia [mailto:liov2067 at gmail.com]
>> Verzonden: woensdag 8 oktober 2008 17:16
>> Aan: r-sig-geo at stat.math.ethz.ch
>> Onderwerp: [R-sig-Geo] CODE for spatial logistic regression
>>
>>
>> Hello
>>
>> I need some guide about spatial logistic regression, Is it available a
>> code in R?
>>
>> {}
>>
>> LIOV
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
> 
> 
> 

-- 
Alexander Brenning
brenning at uwaterloo.ca - T +1-519-888-4567 ext 35783
Department of Geography and Environmental Management
University of Waterloo
200 University Ave. W - Waterloo, ON - Canada N2L 3G1
http://www.fes.uwaterloo.ca/geography/faculty/brenning/



From jofrecarnicer at yahoo.es  Thu Oct  9 15:06:55 2008
From: jofrecarnicer at yahoo.es (jofre carnicer cols)
Date: Thu, 9 Oct 2008 13:06:55 +0000 (GMT)
Subject: [R-sig-Geo] GLS spatial model-- range error
Message-ID: <847282.60187.qm@web26003.mail.ukl.yahoo.com>

Hello,

I am computing a gls spatial model:

require(nlme)

gls.exp<-gls(S1 ~ X2TPall + tmngem + tmaxjlm + arbdenkm + prat_herm + 
    arbclakm + conreukm, data=snouter.df, correlation=corExp(form~X+Y), na.action=na.omit)

and obtain the following error:

Error en Initialize.corSpatial(X[[1L]], ...) : 
  Range must be > 0 in "corSpatial" initial value

I have checked CorExp, gls, and CorClasses help but couldn't find how to solve this error. Any help is welcome.

Many thanks in advance,

Jofre






From alexandre.villers at cebc.cnrs.fr  Thu Oct  9 15:30:30 2008
From: alexandre.villers at cebc.cnrs.fr (Alexandre VILLERS)
Date: Thu, 09 Oct 2008 15:30:30 +0200
Subject: [R-sig-Geo] plotting Ripley fonctions
In-Reply-To: <8ca3c0ca0810090512w799b9af6mc3141a7e6dbd7fde@mail.gmail.com>
References: <8ca3c0ca0810090512w799b9af6mc3141a7e6dbd7fde@mail.gmail.com>
Message-ID: <48EE0776.6090803@cebc.cnrs.fr>

Hey,

You need to transform the K function as follows

Ks<-Kest(object.ppp, border,r=seq(0,50000, by=1000))
plot(Ks$r, sqrt(Ks$border/pi)-Ks$r) if you choose border correction.

Hope that's stuff will make it
Best regards


Alex


P.S.: for a confidence enveloppe, you can use
    aleatoire<-runifpoint(length(s$X), win=aigle.wind, giveup=1000)
            Kalea<-Kest(aleatoire,r=seq(0,50000, by=1000))$border
                 for (j in 1:99){
                    aleatoire<-runifpoint(length(s$X), win=aigle.wind, 
giveup=1000)
                    Kalea<-cbind(Kalea,Kest(aleatoire,r=seq(0,50000, 
by=1000))$border)
                 }
      yKsaleamin<-apply(sqrt(Kalea/pi),1,min, na.rm=T)-Ks$r
      yKsaleamax<-apply(sqrt(Kalea/pi),1,max, na.rm=T)-Ks$r
      lines(Ks$r,yKsaleamin,lty=2, col="darkgrey", lwd=1.2)
      lines(Ks$r,yKsaleamax,lty=2, col="darkgrey",lwd=1.2) 

Lassana Tour? a ?crit :
> Hi.
> I need some help for plotting L(r) and Lcross so that I can have my
> confidence interval(CI) parallel to X axis.
> The plot I have obtain so far the graphic is not horizontal, then it
> is difficult to interpret strong the aggregation is or the attraction.
> thanks
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
> __________ Information from ESET Mail Security, version of virus signature database 3506 (20081009) __________
>
> The message was checked by ESET Mail Security.
> http://www.eset.com
>
>
>     part000.txt - is OK
>
>
>
>   

-- 
Alexandre Villers
PhD Student
Team "Biodiversity"
CEBC-CNRS UPR1934
79360 Beauvoir sur Niort

Phone +33 (0)5 49 09 96 13
Fax   +33 (0)5 49 09 65 26




__________ Information from ESET Mail Security, version of virus signature database 3506 (20081009) __________

The message was checked by ESET Mail Security.
http://www.eset.com


    part000.txt - is OK



From edzer.pebesma at uni-muenster.de  Thu Oct  9 15:32:56 2008
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 09 Oct 2008 15:32:56 +0200
Subject: [R-sig-Geo] GLS spatial model-- range error
In-Reply-To: <847282.60187.qm@web26003.mail.ukl.yahoo.com>
References: <847282.60187.qm@web26003.mail.ukl.yahoo.com>
Message-ID: <48EE0808.6000300@uni-muenster.de>

I don't I think the authors of nlme are on this list, but I looked at 
the help of corExp, and that suggests that using the argument

correlation = corExp(form = ~x+y)

will be more useful that what you did.
--
Edzer

jofre carnicer cols wrote:
> Hello,
>
> I am computing a gls spatial model:
>
> require(nlme)
>
> gls.exp<-gls(S1 ~ X2TPall + tmngem + tmaxjlm + arbdenkm + prat_herm + 
>     arbclakm + conreukm, data=snouter.df, correlation=corExp(form~X+Y), na.action=na.omit)
>
> and obtain the following error:
>
> Error en Initialize.corSpatial(X[[1L]], ...) : 
>   Range must be > 0 in "corSpatial" initial value
>
> I have checked CorExp, gls, and CorClasses help but couldn't find how to solve this error. Any help is welcome.
>
> Many thanks in advance,
>
> Jofre
>
>
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster,
Weseler Stra?e 253, 48151 M?nster, Germany.  Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de/
http://www.springer.com/978-0-387-78170-9



From Henk.Sierdsema at sovon.nl  Thu Oct  9 16:09:55 2008
From: Henk.Sierdsema at sovon.nl (Henk Sierdsema)
Date: Thu, 9 Oct 2008 16:09:55 +0200
Subject: [R-sig-Geo] CODE for spatial logistic regression
In-Reply-To: <48EDF7A7.2090705@udec.cl>
Message-ID: <F7A3EE6B27F4D54B9CCAAB767F1B5AA3FDB4DF@mail.sovon.nl>

Hi Rub?n,

Thanks for defining 'small' better. For me a dataset up to a thousand points is a small dataset, but for most people this is quite a big data set...

Henk




Henk Sierdsema

SOVON Vogelonderzoek Nederland / SOVON Dutch Centre for Field Ornithology

Rijksstraatweg 178
6573 DG  Beek-Ubbergen
The Netherlands
tel: +31 (0)24 6848145
fax: +31 (0)24 6848122



-----Oorspronkelijk bericht-----
Van: Rub?n Roa-Ureta [mailto:rroa at udec.cl]
Verzonden: donderdag 9 oktober 2008 14:23
CC: r-sig-geo at stat.math.ethz.ch
Onderwerp: Re: [R-sig-Geo] CODE for spatial logistic regression


Henk Sierdsema wrote:
> Hi Ivan,
>
> Can you tell me what the purpose is of your modelling? Is it simply producing spatial predictions based on a logistic model or do you want to incorporate spatial autocorrelation in the models? Given your last mail it seems you want to incorporate spatial autocorrelation despite the fact that you deny this in your second mail. So please extend more on the type of data you have and your aim. Next to geoRglm, which is only suitable for small datasets, you might also try regression-kriging.
>
> Is there by the way anyone who has experience with autoregressive models?
>
> Henk
>
>
>
> Henk Sierdsema
>
> SOVON Vogelonderzoek Nederland / SOVON Dutch Centre for Field Ornithology
>
> Rijksstraatweg 178
> 6573 DG  Beek-Ubbergen
> The Netherlands
> tel: +31 (0)24 6848145
> fax: +31 (0)24 6848122
>   
What do you mean by small datasets?
I have used geoRglm to fit spatial binomial models with hundreds of 
point observations.
One approach that would allow the fit of models with even thousand of 
point observations with geoRglm is to create spatial cells (i.e. 
logistic regression with grouped data) and count the number of trials 
and successes in each cell. I implemented that approach in Roa-Ureta and 
Niklitschek, 2007, Biomass estimation from surveys with liklihood-based 
geostatistics, ICES Journal of Marine Science 64:1723-1734.
Rub?n

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch
https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From b.rowlingson at lancaster.ac.uk  Thu Oct  9 16:11:51 2008
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Thu, 9 Oct 2008 15:11:51 +0100
Subject: [R-sig-Geo] PostGIS and sp integration
Message-ID: <d8ad40b50810090711k3c88a013s36b1335be05c4863@mail.gmail.com>

Hi All,

 I'm now very impressed with PostGIS and what it can do with spatial
data. Given the easy setup with Ubuntu, the easy admin with pgAdmin3,
and the great interface with Qgis, I'm won over totally.

 Of course I still need to read my spatial data into R (until I do all
my analysis in Python....).

 I'm trying to follow best practice with my database. So for any set
of polygons I have one table with the geometry and other tables with
data. I can create maps of the data by creating views where the data
table is linked to the geometry table via the polygon id. However some
of my views have many entries per polygon...

 For example I have monthly rainfall for 100 regions in Ethiopia over
5 years - so that's a data table with 12*100*5 rows. If I read that as
an sp object (via readOGR) I will end up with a 6000-row sp-object,
containing 60 copies of each of the 100 polygon boundaries. That
doesn't sound good to me.

 What I want to do with this data is draw 60 choropleth maps - one for
each month. I can think of four approaches:

 1. Suck it up - read the whole thing into an sp object and then
subset that by month for the map. Hope R doesn't fall over.

 2. Read the map (without attached data) into an sp object and read
the data (without map geometry) into a data frame (using RPgSQL). Then
attach each month to the sp object.

 3. As (2), but attach the whole dataframe to the sp-object and then
subset. Probably not much different from (2) really.

 4. Can I apply an SQL select to the readOGR call, so I only select a
map with a single month's rainfall? I've just thought of this one. I'm
not sure if the specification of a PostGIS layer allows it.

Any thoughts?

Barry



From giohappy at gmail.com  Thu Oct  9 16:22:22 2008
From: giohappy at gmail.com (G. Allegri)
Date: Thu, 9 Oct 2008 16:22:22 +0200
Subject: [R-sig-Geo] PostGIS and sp integration
In-Reply-To: <d8ad40b50810090711k3c88a013s36b1335be05c4863@mail.gmail.com>
References: <d8ad40b50810090711k3c88a013s36b1335be05c4863@mail.gmail.com>
Message-ID: <e12429640810090722t6e624640g18dc7a38e8f50c6@mail.gmail.com>

Hi Barry,
just a curiosity. Do you simply need a cloropleth with rainfall
amount/rate coloring, or you have to do more complex operations?

2008/10/9 Barry Rowlingson <b.rowlingson at lancaster.ac.uk>:
> Hi All,
>
>  I'm now very impressed with PostGIS and what it can do with spatial
> data. Given the easy setup with Ubuntu, the easy admin with pgAdmin3,
> and the great interface with Qgis, I'm won over totally.
>
>  Of course I still need to read my spatial data into R (until I do all
> my analysis in Python....).
>
>  I'm trying to follow best practice with my database. So for any set
> of polygons I have one table with the geometry and other tables with
> data. I can create maps of the data by creating views where the data
> table is linked to the geometry table via the polygon id. However some
> of my views have many entries per polygon...
>
>  For example I have monthly rainfall for 100 regions in Ethiopia over
> 5 years - so that's a data table with 12*100*5 rows. If I read that as
> an sp object (via readOGR) I will end up with a 6000-row sp-object,
> containing 60 copies of each of the 100 polygon boundaries. That
> doesn't sound good to me.
>
>  What I want to do with this data is draw 60 choropleth maps - one for
> each month. I can think of four approaches:
>
>  1. Suck it up - read the whole thing into an sp object and then
> subset that by month for the map. Hope R doesn't fall over.
>
>  2. Read the map (without attached data) into an sp object and read
> the data (without map geometry) into a data frame (using RPgSQL). Then
> attach each month to the sp object.
>
>  3. As (2), but attach the whole dataframe to the sp-object and then
> subset. Probably not much different from (2) really.
>
>  4. Can I apply an SQL select to the readOGR call, so I only select a
> map with a single month's rainfall? I've just thought of this one. I'm
> not sure if the specification of a PostGIS layer allows it.
>
> Any thoughts?
>
> Barry
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



From b.rowlingson at lancaster.ac.uk  Thu Oct  9 16:24:23 2008
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Thu, 9 Oct 2008 15:24:23 +0100
Subject: [R-sig-Geo] PostGIS and sp integration
In-Reply-To: <e12429640810090722t6e624640g18dc7a38e8f50c6@mail.gmail.com>
References: <d8ad40b50810090711k3c88a013s36b1335be05c4863@mail.gmail.com>
	<e12429640810090722t6e624640g18dc7a38e8f50c6@mail.gmail.com>
Message-ID: <d8ad40b50810090724h6753569wecd98454136d37f7@mail.gmail.com>

2008/10/9 G. Allegri <giohappy at gmail.com>:
> Hi Barry,
> just a curiosity. Do you simply need a cloropleth with rainfall
> amount/rate coloring, or you have to do more complex operations?
>

 Just simple colouring, but I will have to make sure the scales are
consistent across the 60 maps, so I will have to find the
spatial/temporal min/max first.

 The 60 maps are going into an animation.

Barry



From jofrecarnicer at yahoo.es  Thu Oct  9 16:28:48 2008
From: jofrecarnicer at yahoo.es (jofre carnicer cols)
Date: Thu, 9 Oct 2008 14:28:48 +0000 (GMT)
Subject: [R-sig-Geo] GLS spatial model-- range error
Message-ID: <991037.9952.qm@web26004.mail.ukl.yahoo.com>

Sorry, 

I have just solved the problem. There was a typographic error in the code.

Sorry for this mistake,

Jofre


--- El jue, 9/10/08, jofre carnicer cols <jofrecarnicer at yahoo.es> escribi?:

> De: jofre carnicer cols <jofrecarnicer at yahoo.es>
> Asunto: GLS spatial model-- range error
> Para: r-sig-geo at stat.math.ethz.ch
> Fecha: jueves, 9 octubre, 2008 3:06
> Hello,
> 
> I am computing a gls spatial model:
> 
> require(nlme)
> 
> gls.exp<-gls(S1 ~ X2TPall + tmngem + tmaxjlm + arbdenkm
> + prat_herm + 
>     arbclakm + conreukm, data=snouter.df,
> correlation=corExp(form~X+Y), na.action=na.omit)
> 
> and obtain the following error:
> 
> Error en Initialize.corSpatial(X[[1L]], ...) : 
>   Range must be > 0 in "corSpatial" initial
> value
> 
> I have checked CorExp, gls, and CorClasses help but
> couldn't find how to solve this error. Any help is
> welcome.
> 
> Many thanks in advance,
> 
> Jofre






From edzer.pebesma at uni-muenster.de  Thu Oct  9 16:37:00 2008
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 09 Oct 2008 16:37:00 +0200
Subject: [R-sig-Geo] PostGIS and sp integration
In-Reply-To: <d8ad40b50810090711k3c88a013s36b1335be05c4863@mail.gmail.com>
References: <d8ad40b50810090711k3c88a013s36b1335be05c4863@mail.gmail.com>
Message-ID: <48EE170C.6010602@uni-muenster.de>



Barry Rowlingson wrote:
> Hi All,
>
>  I'm now very impressed with PostGIS and what it can do with spatial
> data. Given the easy setup with Ubuntu, the easy admin with pgAdmin3,
> and the great interface with Qgis, I'm won over totally.
>
>  Of course I still need to read my spatial data into R (until I do all
> my analysis in Python....).
>
>  I'm trying to follow best practice with my database. So for any set
> of polygons I have one table with the geometry and other tables with
> data.
Why is this better practice than having a single 100x61 table with 
monthly rainfall in the usual columns and a geometry column?
>  I can create maps of the data by creating views where the data
> table is linked to the geometry table via the polygon id. However some
> of my views have many entries per polygon...
>
>  For example I have monthly rainfall for 100 regions in Ethiopia over
> 5 years - so that's a data table with 12*100*5 rows. If I read that as
> an sp object (via readOGR) I will end up with a 6000-row sp-object,
> containing 60 copies of each of the 100 polygon boundaries. That
> doesn't sound good to me.
>
>  What I want to do with this data is draw 60 choropleth maps - one for
> each month. I can think of four approaches:
>
>  1. Suck it up - read the whole thing into an sp object and then
> subset that by month for the map. Hope R doesn't fall over.
>
>  2. Read the map (without attached data) into an sp object and read
> the data (without map geometry) into a data frame (using RPgSQL). Then
> attach each month to the sp object.
>
>  3. As (2), but attach the whole dataframe to the sp-object and then
> subset. Probably not much different from (2) really.
>
>  4. Can I apply an SQL select to the readOGR call, so I only select a
> map with a single month's rainfall? I've just thought of this one. I'm
> not sure if the specification of a PostGIS layer allows it.
>
> Any thoughts?
>   
Sounds as if you've not seen the spplot light. If you had a single table 
with 60 columns and 100 rows, all that's needed would be

rain = readOGR("bla")
spplot(rain)

given that the rain columns would be useful and fit in the conditioning 
plot text boxes (so-called "strips")
--
Edzer
> Barry
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster,
Weseler Stra?e 253, 48151 M?nster, Germany.  Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de/
http://www.springer.com/978-0-387-78170-9



From b.rowlingson at lancaster.ac.uk  Thu Oct  9 16:51:21 2008
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Thu, 9 Oct 2008 15:51:21 +0100
Subject: [R-sig-Geo] PostGIS and sp integration
In-Reply-To: <48EE170C.6010602@uni-muenster.de>
References: <d8ad40b50810090711k3c88a013s36b1335be05c4863@mail.gmail.com>
	<48EE170C.6010602@uni-muenster.de>
Message-ID: <d8ad40b50810090751o77191acfva9b8fdcae99643a5@mail.gmail.com>

2008/10/9 Edzer Pebesma <edzer.pebesma at uni-muenster.de>:

> Why is this better practice than having a single 100x61 table with monthly
> rainfall in the usual columns and a geometry column?

 Because when I get another year's data, I have to change the table
definition. SQL doesn't like that[1]. Keep your original data
normalised, that's the idea. Of course you can denormalise for a
specific purpose, such as....

> Sounds as if you've not seen the spplot light. If you had a single table
> with 60 columns and 100 rows, all that's needed would be
>
> rain = readOGR("bla")
> spplot(rain)
>
> given that the rain columns would be useful and fit in the conditioning plot
> text boxes (so-called "strips")

 I'll give that a go. However, I need to get my 60 plots into 60 png
files for animation purposes. Can spplot do that? I was just going to
draw them into png() devices.

 Originally I had weekly data...

Barry



From edzer.pebesma at uni-muenster.de  Thu Oct  9 17:04:07 2008
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 09 Oct 2008 17:04:07 +0200
Subject: [R-sig-Geo] PostGIS and sp integration
In-Reply-To: <d8ad40b50810090751o77191acfva9b8fdcae99643a5@mail.gmail.com>
References: <d8ad40b50810090711k3c88a013s36b1335be05c4863@mail.gmail.com>	
	<48EE170C.6010602@uni-muenster.de>
	<d8ad40b50810090751o77191acfva9b8fdcae99643a5@mail.gmail.com>
Message-ID: <48EE1D67.2040202@uni-muenster.de>

Barry Rowlingson wrote:
> 2008/10/9 Edzer Pebesma <edzer.pebesma at uni-muenster.de>:
>
>   
>> Why is this better practice than having a single 100x61 table with monthly
>> rainfall in the usual columns and a geometry column?
>>     
>
>  Because when I get another year's data, I have to change the table
> definition. SQL doesn't like that[1]. Keep your original data
> normalised, that's the idea. Of course you can denormalise for a
> specific purpose, such as....
>   
Right, I forgot, SQL doesn't have the $<-
>   
>> Sounds as if you've not seen the spplot light. If you had a single table
>> with 60 columns and 100 rows, all that's needed would be
>>
>> rain = readOGR("bla")
>> spplot(rain)
>>
>> given that the rain columns would be useful and fit in the conditioning plot
>> text boxes (so-called "strips")
>>     
>
>  I'll give that a go. However, I need to get my 60 plots into 60 png
> files for animation purposes. Can spplot do that? I was just going to
> draw them into png() devices.
>   
Yes, but you need to fix the scale bar range ahead of time. spplot is 
just a wrapper around levelplot, so remember to put a print(spplot(...)) 
inside loops.
>  Originally I had weekly data...
>   
Well, yes, in that case animation becomes compelling. Aren't there any 
GIS clients that can do animation with time series of vector maps? I 
only know one for gridded data.

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster,
Weseler Stra?e 253, 48151 M?nster, Germany.  Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de/
http://www.springer.com/978-0-387-78170-9



From goarant at obs-vlfr.fr  Thu Oct  9 17:13:22 2008
From: goarant at obs-vlfr.fr (Anne Goarant)
Date: Thu, 09 Oct 2008 17:13:22 +0200
Subject: [R-sig-Geo] opening a grd file (Surfer)
Message-ID: <48EE1F92.2040802@obs-vlfr.fr>

Hello!

Does anyone know how to open a .grd file (surfer type file) with R (or 
convert this kind of file in ascii)? I tried using the RSAGA library but 
failed.
rsaga.geoprocessor("io_grid", 3, list( FILE = '10s70s0e150e.sgrd'))
This are bathymetry data from the GEBCO website.

Thanks
Anne



From Roger.Bivand at nhh.no  Thu Oct  9 17:38:39 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 9 Oct 2008 17:38:39 +0200 (CEST)
Subject: [R-sig-Geo] opening a grd file (Surfer)
In-Reply-To: <48EE1F92.2040802@obs-vlfr.fr>
References: <48EE1F92.2040802@obs-vlfr.fr>
Message-ID: <Pine.LNX.4.64.0810091735000.25461@reclus.nhh.no>

On Thu, 9 Oct 2008, Anne Goarant wrote:

> Hello!
>
> Does anyone know how to open a .grd file (surfer type file) with R (or 
> convert this kind of file in ascii)? I tried using the RSAGA library but 
> failed.
> rsaga.geoprocessor("io_grid", 3, list( FILE = '10s70s0e150e.sgrd'))
> This are bathymetry data from the GEBCO website.

The  GS7BG -- Golden Software Surfer 7 Binary Grid File Format, or GSBG -- 
Golden Software Binary Grid File Format drivers in the rgdal package ought 
to open these files for reading. They are in the CRAN Windows binary 
package.

Roger

>
> Thanks
> Anne
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From dylan.beaudette at gmail.com  Thu Oct  9 17:41:31 2008
From: dylan.beaudette at gmail.com (Dylan Beaudette)
Date: Thu, 9 Oct 2008 08:41:31 -0700
Subject: [R-sig-Geo] opening a grd file (Surfer)
In-Reply-To: <48EE1F92.2040802@obs-vlfr.fr>
References: <48EE1F92.2040802@obs-vlfr.fr>
Message-ID: <200810090841.31474.dylan.beaudette@gmail.com>

On Thursday 09 October 2008, Anne Goarant wrote:
> Hello!
>
> Does anyone know how to open a .grd file (surfer type file) with R (or
> convert this kind of file in ascii)? I tried using the RSAGA library but
> failed.
> rsaga.geoprocessor("io_grid", 3, list( FILE = '10s70s0e150e.sgrd'))
> This are bathymetry data from the GEBCO website.
>
> Thanks
> Anne
>
GDAL


-- 
Dylan Beaudette
Soil Resource Laboratory
http://casoilresource.lawr.ucdavis.edu/
University of California at Davis
530.754.7341



From dylan.beaudette at gmail.com  Thu Oct  9 17:44:37 2008
From: dylan.beaudette at gmail.com (Dylan Beaudette)
Date: Thu, 9 Oct 2008 08:44:37 -0700
Subject: [R-sig-Geo] PostGIS and sp integration
In-Reply-To: <48EE1D67.2040202@uni-muenster.de>
References: <d8ad40b50810090711k3c88a013s36b1335be05c4863@mail.gmail.com>
	<d8ad40b50810090751o77191acfva9b8fdcae99643a5@mail.gmail.com>
	<48EE1D67.2040202@uni-muenster.de>
Message-ID: <200810090844.37600.dylan.beaudette@gmail.com>

On Thursday 09 October 2008, Edzer Pebesma wrote:
> Barry Rowlingson wrote:
> > 2008/10/9 Edzer Pebesma <edzer.pebesma at uni-muenster.de>:
> >> Why is this better practice than having a single 100x61 table with
> >> monthly rainfall in the usual columns and a geometry column?
> >
> >  Because when I get another year's data, I have to change the table
> > definition. SQL doesn't like that[1]. Keep your original data
> > normalised, that's the idea. Of course you can denormalise for a
> > specific purpose, such as....
>
> Right, I forgot, SQL doesn't have the $<-
>
> >> Sounds as if you've not seen the spplot light. If you had a single table
> >> with 60 columns and 100 rows, all that's needed would be
> >>
> >> rain = readOGR("bla")
> >> spplot(rain)
> >>
> >> given that the rain columns would be useful and fit in the conditioning
> >> plot text boxes (so-called "strips")
> >
> >  I'll give that a go. However, I need to get my 60 plots into 60 png
> > files for animation purposes. Can spplot do that? I was just going to
> > draw them into png() devices.
>
> Yes, but you need to fix the scale bar range ahead of time. spplot is
> just a wrapper around levelplot, so remember to put a print(spplot(...))
> inside loops.
>
> >  Originally I had weekly data...
>
> Well, yes, in that case animation becomes compelling. Aren't there any
> GIS clients that can do animation with time series of vector maps? I
> only know one for gridded data.

If you are just making maps, and lots of them GRASS might be useful for 
automating the process. Here is one such example, with solar radiation data 
over the coarse of a normal year:

http://169.237.35.250/~dylan/solar/beam_normalized_color.mpg

Cheers,

Dylan

-- 
Dylan Beaudette
Soil Resource Laboratory
http://casoilresource.lawr.ucdavis.edu/
University of California at Davis
530.754.7341



From Roger.Bivand at nhh.no  Thu Oct  9 17:55:18 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 9 Oct 2008 17:55:18 +0200 (CEST)
Subject: [R-sig-Geo] PostGIS and sp integration
In-Reply-To: <d8ad40b50810090711k3c88a013s36b1335be05c4863@mail.gmail.com>
References: <d8ad40b50810090711k3c88a013s36b1335be05c4863@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0810091747110.25461@reclus.nhh.no>

On Thu, 9 Oct 2008, Barry Rowlingson wrote:

> Hi All,
>
> I'm now very impressed with PostGIS and what it can do with spatial
> data. Given the easy setup with Ubuntu, the easy admin with pgAdmin3,
> and the great interface with Qgis, I'm won over totally.
>
> Of course I still need to read my spatial data into R (until I do all
> my analysis in Python....).
>
> I'm trying to follow best practice with my database. So for any set
> of polygons I have one table with the geometry and other tables with
> data. I can create maps of the data by creating views where the data
> table is linked to the geometry table via the polygon id. However some
> of my views have many entries per polygon...
>
> For example I have monthly rainfall for 100 regions in Ethiopia over
> 5 years - so that's a data table with 12*100*5 rows. If I read that as
> an sp object (via readOGR) I will end up with a 6000-row sp-object,
> containing 60 copies of each of the 100 polygon boundaries. That
> doesn't sound good to me.
>
> What I want to do with this data is draw 60 choropleth maps - one for
> each month. I can think of four approaches:
>
> 1. Suck it up - read the whole thing into an sp object and then
> subset that by month for the map. Hope R doesn't fall over.
>
> 2. Read the map (without attached data) into an sp object and read
> the data (without map geometry) into a data frame (using RPgSQL). Then
> attach each month to the sp object.
>
> 3. As (2), but attach the whole dataframe to the sp-object and then
> subset. Probably not much different from (2) really.
>
> 4. Can I apply an SQL select to the readOGR call, so I only select a
> map with a single month's rainfall? I've just thought of this one. I'm
> not sure if the specification of a PostGIS layer allows it.

Could you look at how an SQL query to ogr2ogr might work? Of course, 
temporary files are messy, but you might be able to have ogr2ogr select 
the data you need for the fixed regional features? Your original Rmap code 
allowed selection of features, but not IIRC. Adding an sql="" argument to 
readOGR() might be fun (probably based on what ogr2ogr does)!

Roger

>
> Any thoughts?
>
> Barry
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From brenning at uwaterloo.ca  Thu Oct  9 21:40:56 2008
From: brenning at uwaterloo.ca (Alexander Brenning)
Date: Thu, 09 Oct 2008 15:40:56 -0400
Subject: [R-sig-Geo] opening a grd file (Surfer)
In-Reply-To: <48EE1F92.2040802@obs-vlfr.fr>
References: <48EE1F92.2040802@obs-vlfr.fr>
Message-ID: <48EE5E48.7050701@uwaterloo.ca>

Hi Anne,

in case you are not mainly interested in importing the (potentially 
large) Surfer grid into R, but want to do raster calculations instead 
(e.g. using other SAGA modules), you might still be interested in the 
RSAGA way of converting it:

You didn't specify the file name of the SAGA output grid (GRID 
argument), the your FILE argument should point to the Surfer file (.grd).

Here a generic solution, starting with a Surfer grid temp.grd (which you 
can generate with io_grid module 2 if you don't have one):

library(RSAGA)
setwd("C:/here/is/my/tempfile")
# Get some help:
rsaga.get.usage("io_grid",3)
# Convert Surfer grid temp.grd to SAGA grid temp.sgrd:
rsaga.geoprocessor("io_grid",3,
     param = list(GRID = "temp.sgrd", FILE = "temp.grd"))
# Convert temp.sgrd to temp.asc with three decimal places:
rsaga.sgrd.to.esri("temp", prec = 3)
# Read grid (without header):
d = read.ascii.grid("temp", return.header = FALSE)
str(d) # only the grid data matrix
# Read grid (with header):
d = read.ascii.grid("temp")
str(d) # list: header, data matrix



Cheers
   Alex



Anne Goarant wrote:
> Hello!
> 
> Does anyone know how to open a .grd file (surfer type file) with R (or 
> convert this kind of file in ascii)? I tried using the RSAGA library but 
> failed.
> rsaga.geoprocessor("io_grid", 3, list( FILE = '10s70s0e150e.sgrd'))
> This are bathymetry data from the GEBCO website.
> 
> Thanks
> Anne
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 

-- 
Alexander Brenning
brenning at uwaterloo.ca - T +1-519-888-4567 ext 35783
Department of Geography and Environmental Management
University of Waterloo
200 University Ave. W - Waterloo, ON - Canada N2L 3G1
http://www.fes.uwaterloo.ca/geography/faculty/brenning/



From Mikael.Carlsson at sgu.se  Fri Oct 10 09:14:40 2008
From: Mikael.Carlsson at sgu.se (Mikael Carlsson)
Date: Fri, 10 Oct 2008 09:14:40 +0200
Subject: [R-sig-Geo] interp.old and write.ascii.grid
Message-ID: <OF60FECCFB.37D4393D-ONC12574DE.0027BF85-C12574DE.0027D9C3@sgu.se>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081010/8cd3bf6f/attachment.pl>

From p.hiemstra at geo.uu.nl  Fri Oct 10 10:40:09 2008
From: p.hiemstra at geo.uu.nl (Paul Hiemstra)
Date: Fri, 10 Oct 2008 10:40:09 +0200
Subject: [R-sig-Geo] interp.old and write.ascii.grid
In-Reply-To: <OF60FECCFB.37D4393D-ONC12574DE.0027BF85-C12574DE.0027D9C3@sgu.se>
References: <OF60FECCFB.37D4393D-ONC12574DE.0027BF85-C12574DE.0027D9C3@sgu.se>
Message-ID: <48EF14E9.50902@geo.uu.nl>

Hi,

What is the exact error you get? Can you provide a example that 
reproduces the problem? What kind of system are you running 
(sessionInfo() output).

An idea: The documentation of write.asciigrid says that the variable x 
(in this case sn8.interpold) should be a SpatialGridDataFrame. Does 
interp.old give that output (try class(sn8.interpold))? If this is not 
the case you need to convert the output to a SpatialGridDataFrame.

cheers,
Paul

Mikael Carlsson wrote:
> Hello!
>  
> I have a text file that looks like
>  
> ew;ns;cures
> 1394180;6200295;48
> 1398190;6201020;52
> 1399690;6200420;59
> 1395780;6205105;84
> 1397820;6206590;50
> 1395290;6208305;46
> 1394995;6210370;114
> 1399475;6213715;92
> 1410825;6214870;48
> and so on
> I manage to interpolate with 
>  
> sn8.interpold <- interp.old(ew, ns, cures,
>               xo= seq(min(ew), max(ew), length = 400),
>               yo=seq(min(ns), max(ns), length = 300),
>               ncp = 4, extrap=FALSE, duplicate = "error", dupfun = NULL)
> then I want to crate a asciigrid...
> write.asciigrid(sn8.interpold,"asciisn8", na.value = -9999)
> and here I got problems...
> Any tips?
>  
> Thanks Mikael
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   


-- 
Drs. Paul Hiemstra
Department of Physical Geography
Faculty of Geosciences
University of Utrecht
Heidelberglaan 2
P.O. Box 80.115
3508 TC Utrecht
Phone: 	+31302535773
Fax:	+31302531145
http://intamap.geo.uu.nl/~paul



From T.Hengl at uva.nl  Fri Oct 10 11:26:50 2008
From: T.Hengl at uva.nl (Tomislav Hengl)
Date: Fri, 10 Oct 2008 11:26:50 +0200
Subject: [R-sig-Geo] interp.old and write.ascii.grid
In-Reply-To: <OF60FECCFB.37D4393D-ONC12574DE.0027BF85-C12574DE.0027D9C3@sgu.se>
References: <OF60FECCFB.37D4393D-ONC12574DE.0027BF85-C12574DE.0027D9C3@sgu.se>
Message-ID: <EA8ED91039304419AD98B00EA9F3CC60@pcibed193>


try this:

***********************

library(akima)
library(spatstat)
library(maptools)

ew <- as.vector(c(1394180, 1398190, 1399690, 1395780, 1397820, 1395290, 1394995, 1399475, 1410825))
ns <- as.vector(c(6200295, 6201020, 6200420, 6205105, 6206590, 6208305, 6210370, 6213715, 6214870))
cures <- as.vector(c(48, 52, 59, 84, 50, 46, 114, 92, 48))
sn8 <- data.frame(ew, ns, cures)
coordinates(sn8) <- ~ew+ns
sn8.interpold <- interp(ew, ns, cures, xo= seq(min(ew), max(ew), length = 400), yo=seq(min(ns),
max(ns), length = 300), linear=T)
sn8.interpold.grid <- as.SpatialGridDataFrame.im(as.im(sn8.interpold))
spplot(sn8.interpold.grid, col.regions=bpy.colors(), sp.layout=list("sp.points", pch="+", sn8))
slot(slot(sn8.interpold.grid, "grid"), "cellsize") <- rep(mean(slot(slot(sn8.interpold.grid,
"grid"), "cellsize")), 2)
write.asciigrid(sn8.interpold.grid[1], "asciisn8", na.value = -9999)

***********************

cheers,

Tom Hengl
http://spatial-analyst.net


-----Original Message-----
From: r-sig-geo-bounces at stat.math.ethz.ch [mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of
Mikael Carlsson
Sent: vrijdag 10 oktober 2008 9:15
To: r-sig-geo at stat.math.ethz.ch
Subject: [R-sig-Geo] interp.old and write.ascii.grid

Hello!
 
I have a text file that looks like
 
ew;ns;cures
1394180;6200295;48
1398190;6201020;52
1399690;6200420;59
1395780;6205105;84
1397820;6206590;50
1395290;6208305;46
1394995;6210370;114
1399475;6213715;92
1410825;6214870;48
and so on
I manage to interpolate with 
 
sn8.interpold <- interp.old(ew, ns, cures,
              xo= seq(min(ew), max(ew), length = 400),
              yo=seq(min(ns), max(ns), length = 300),
              ncp = 4, extrap=FALSE, duplicate = "error", dupfun = NULL)
then I want to crate a asciigrid...
write.asciigrid(sn8.interpold,"asciisn8", na.value = -9999)
and here I got problems...
Any tips?
 
Thanks Mikael
	[[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch
https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From b.rowlingson at lancaster.ac.uk  Fri Oct 10 12:45:17 2008
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Fri, 10 Oct 2008 11:45:17 +0100
Subject: [R-sig-Geo] lat/lon to timezone
In-Reply-To: <48DBA765.2010105@udel.edu>
References: <3827b1320809250700t375434e6x16b9b3c0cc893313@mail.gmail.com>
	<48DB9E0C.9080309@udel.edu>
	<d8ad40b50809250752x747cfccboe19d78825b7c6fdd@mail.gmail.com>
	<48DBA765.2010105@udel.edu>
Message-ID: <d8ad40b50810100345p637de936s56df6148d5259334@mail.gmail.com>

2008/9/25 John Callahan <john.callahan at udel.edu>:
> That's a handy little script to have, and learn from.  Geonames.org also
> hosts web services for finding the elevation, nearby populated places,
> nearby Wikipedia entries, some reverse geocoding, and a few more.
> (http://www.geonames.org/export/web-services.html)   Thanks for posting the
> script!

 I've almost finished writing a package to enable R queries to all the
geonames.org web services. I've applied for a project on R-forge for
it so that should go through later today.

 Most of the functions are one-liners anyway, being just a json call
and a wrapper to return a data frame. So soon you'll all be able to
know what kind of day we're having here:

> GNweather(north=55,east=-2,south=53,west=-3)
            clouds weatherCondition
1 scattered clouds              n/a
2       few clouds              n/a
3       few clouds              n/a
4       few clouds              n/a
                                               observation windDirection ICAO
1  EGNR 100850Z 20013G24KT 120V270 9999 SCT035 18/11 Q1023           200 EGNR
2       EGCC 100920Z 18011KT 9999 FEW030 14/08 Q1024 NOSIG           180 EGCC
3 EGNC 100920Z 23023KT 8000 RADZ FEW011 BKN015 16/14 Q1017           230 EGNC
4             EGGP 100920Z 21015KT 9999 FEW033 17/09 Q1023           210 EGGP
        lng temperature dewPoint windSpeed humidity        stationName
1 -2.966667          18       11        13       63           Hawarden
2 -2.266667          14        8        11       67 Manchester Airport
3 -2.950000          16       14        23       87           Carlisle
4 -2.850000          17        9        15       59 Liverpool Airport
             datetime      lat hectoPascAltimeter
1 2008-10-10 10:50:00 53.16667               1023
2 2008-10-10 11:20:00 53.35000               1024
3 2008-10-10 11:20:00 54.91667               1017
4 2008-10-10 11:20:00 53.31667               1023

Barry



From Bjarke.Christensen at sydbank.dk  Fri Oct 10 15:13:09 2008
From: Bjarke.Christensen at sydbank.dk (Bjarke Christensen)
Date: Fri, 10 Oct 2008 15:13:09 +0200
Subject: [R-sig-Geo] How to establish location of points relative to a line
In-Reply-To: <mailman.9.1223632808.5013.r-sig-geo@stat.math.ethz.ch>
Message-ID: <OF480BB96A.770222E2-ONC12574DE.00456D22-C12574DE.00489D96@bdpnet.dk>

Hi,

I have a SpatialLinesDataFrame (A) and a SpatialPointsDataFrame (B). How
can I establish which points in B are to the east of a given line in A?

The problem is to figure out which persons (whose addresses are geocoded in
B) have addresses to the east of a given road (whose coordinates are given
in A).

Thanks in advance!
Bjarke Christensen.



From b.rowlingson at lancaster.ac.uk  Fri Oct 10 16:40:19 2008
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Fri, 10 Oct 2008 15:40:19 +0100
Subject: [R-sig-Geo] How to establish location of points relative to a
	line
In-Reply-To: <OF480BB96A.770222E2-ONC12574DE.00456D22-C12574DE.00489D96@bdpnet.dk>
References: <mailman.9.1223632808.5013.r-sig-geo@stat.math.ethz.ch>
	<OF480BB96A.770222E2-ONC12574DE.00456D22-C12574DE.00489D96@bdpnet.dk>
Message-ID: <d8ad40b50810100740i33ac3e6eqc8b3bfa1be1e9153@mail.gmail.com>

2008/10/10 Bjarke Christensen <Bjarke.Christensen at sydbank.dk>:
> Hi,
>
> I have a SpatialLinesDataFrame (A) and a SpatialPointsDataFrame (B). How
> can I establish which points in B are to the east of a given line in A?
>
> The problem is to figure out which persons (whose addresses are geocoded in
> B) have addresses to the east of a given road (whose coordinates are given
> in A).

 Is this problem well-defined for a wiggly road? You could be both
east and west of a particularly curvy road.

 You could take the nearest point of the road to the address location
and then see if this vector has a positive or negative X component....

 And of course it would be a trivial problem in New York (except for Broadway!).

Barry



From Roger.Bivand at nhh.no  Fri Oct 10 19:50:56 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 10 Oct 2008 19:50:56 +0200 (CEST)
Subject: [R-sig-Geo] How to establish location of points relative to a
 line
In-Reply-To: <d8ad40b50810100740i33ac3e6eqc8b3bfa1be1e9153@mail.gmail.com>
References: <mailman.9.1223632808.5013.r-sig-geo@stat.math.ethz.ch>
	<OF480BB96A.770222E2-ONC12574DE.00456D22-C12574DE.00489D96@bdpnet.dk>
	<d8ad40b50810100740i33ac3e6eqc8b3bfa1be1e9153@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0810101946540.7433@reclus.nhh.no>

On Fri, 10 Oct 2008, Barry Rowlingson wrote:

> 2008/10/10 Bjarke Christensen <Bjarke.Christensen at sydbank.dk>:
>> Hi,
>>
>> I have a SpatialLinesDataFrame (A) and a SpatialPointsDataFrame (B). How
>> can I establish which points in B are to the east of a given line in A?
>>
>> The problem is to figure out which persons (whose addresses are geocoded in
>> B) have addresses to the east of a given road (whose coordinates are given
>> in A).
>
> Is this problem well-defined for a wiggly road? You could be both
> east and west of a particularly curvy road.
>
> You could take the nearest point of the road to the address location
> and then see if this vector has a positive or negative X component....

Perhaps you could consider completing a polygon with the road on the 
"west" edge, for your definition of "west", for example adding the south. 
east and north edges of the bounding box of the points to the line (take 
care over ring direction!). Then the overlay method would get you there.

Roger

>
> And of course it would be a trivial problem in New York (except for 
> Broadway!).
>

PS: or Wall St., here today, gone tomorrow?

> Barry
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From edschnitzke at gmail.com  Fri Oct 10 20:44:57 2008
From: edschnitzke at gmail.com (Edward Schnitzke)
Date: Fri, 10 Oct 2008 13:44:57 -0500
Subject: [R-sig-Geo] Q: pois.krige vs glsm.mcmc/glsm.krige in geoRglm?
Message-ID: <19d4d7e50810101144x186230b4h7736ecb9625df286@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081010/80c90cd5/attachment.pl>

From Mikael.Carlsson at sgu.se  Mon Oct 13 14:54:11 2008
From: Mikael.Carlsson at sgu.se (Mikael Carlsson)
Date: Mon, 13 Oct 2008 14:54:11 +0200
Subject: [R-sig-Geo] interp from Akima and smooth
Message-ID: <OFC416F60C.2C521B1B-ONC12574E1.004558F2-C12574E1.0046E960@sgu.se>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081013/b0f47371/attachment.pl>

From p.hiemstra at geo.uu.nl  Mon Oct 13 16:02:51 2008
From: p.hiemstra at geo.uu.nl (Paul Hiemstra)
Date: Mon, 13 Oct 2008 16:02:51 +0200
Subject: [R-sig-Geo] interp from Akima and smooth
In-Reply-To: <OFC416F60C.2C521B1B-ONC12574E1.004558F2-C12574E1.0046E960@sgu.se>
References: <OFC416F60C.2C521B1B-ONC12574E1.004558F2-C12574E1.0046E960@sgu.se>
Message-ID: <48F3550B.2090303@geo.uu.nl>

Mikael Carlsson wrote:
> Hi,
>
> Been testing interp from akima package but I wish more possibility to 
> influence 
> smoothness and also how many surrounding points that are considered in 
> each interpolated point.
>
> Someone who has a tip on a good function?
>
>
> /Mikael
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   
You could consider the gstat-package.

Paul

-- 
Drs. Paul Hiemstra
Department of Physical Geography
Faculty of Geosciences
University of Utrecht
Heidelberglaan 2
P.O. Box 80.115
3508 TC Utrecht
Phone: 	+31302535773
Fax:	+31302531145
http://intamap.geo.uu.nl/~paul



From T.Hengl at uva.nl  Mon Oct 13 17:17:52 2008
From: T.Hengl at uva.nl (Tomislav Hengl)
Date: Mon, 13 Oct 2008 17:17:52 +0200
Subject: [R-sig-Geo] interp from Akima and smooth
In-Reply-To: <OFC416F60C.2C521B1B-ONC12574E1.004558F2-C12574E1.0046E960@sgu.se>
References: <OFC416F60C.2C521B1B-ONC12574E1.004558F2-C12574E1.0046E960@sgu.se>
Message-ID: <F615C4A8F56F43B2B89C9A2474204EA6@pcibed193>


Funnily enough the most flexible surface generator that I know is the kernel gaussian smoother, as
implemented in spatstat package:

> library(spatstat)
> library(maptools)
> data(meuse)
> str(meuse$lead)
> bubble(meuse, "lead")
> coordinates(meuse) = ~x+y
> lead.ppp <- as(meuse["lead"], "ppp")
> lead.dens <- density.ppp(lead.ppp, sigma=120, weights=meuse$lead)
> image(lead.dens)
> plot(meuse, pch="+", add=T)

This gives you a weighted density of sampled values, hence the values will change depending on the
sigma parameter and grid topology. Note that you can also detect the smoothing parameter
objectively, which means that you could automate the whole procedure. The author of stapstat makes
it clear (http://www.csiro.au/resources/pf16h.html), however, that the such (meuse) data should not
be treated as a point process (lead in soil is obviously not a point process but an underlying
continuous field) but instead analyzed using geostatistical techniques e.g. gstat:

> data(meuse.grid)
> gridded(meuse.grid) = ~x+y
> lead.smooth <- krige(lead~x+y+x^2+y^2, meuse, meuse.grid, nmax=10)
> spplot(lead.smooth[1])

You could also try running the Thin Plate Splines as implemented in SAGA GIS:

> library(rgdal)
> library(RSAGA)
> rsaga.get.usage("grid_spline", 1)
> writeOGR(meuse["lead"], "lead.shp", "lead", "ESRI Shapefile")
> rsaga.geoprocessor(lib="grid_spline", module=1, param=list(GRID="lead.sgrd", SHAPES="lead.shp",
FIELD=0, RADIUS=sqrt(areaSpatialGrid(meuse.grid))/3, SELECT=1, MAXPOINTS=20,  TARGET=0,
USER_CELL_SIZE=meuse.grid at grid@cellsize[[1]], USER_X_EXTENT_MIN=meuse.grid at bbox[1, 1],
USER_X_EXTENT_MAX=meuse.grid at bbox[1,2], USER_Y_EXTENT_MIN=meuse.grid at bbox[2,1],
USER_Y_EXTENT_MAX=meuse.grid at bbox[2,2]))


Tom Hengl
http://spatial-analyst.net 

-----Original Message-----
From: r-sig-geo-bounces at stat.math.ethz.ch [mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of
Mikael Carlsson
Sent: Monday, October 13, 2008 2:54 PM
To: r-sig-geo at stat.math.ethz.ch
Subject: [R-sig-Geo] interp from Akima and smooth

Hi,

Been testing interp from akima package but I wish more possibility to 
influence 
smoothness and also how many surrounding points that are considered in 
each interpolated point.

Someone who has a tip on a good function?


/Mikael
	[[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch
https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From javier.martinez at um.es  Mon Oct 13 17:19:19 2008
From: javier.martinez at um.es (JAVIER MARTINEZ LOPEZ)
Date: Mon, 13 Oct 2008 17:19:19 +0200
Subject: [R-sig-Geo] identification of vegetation using aerial pictures
Message-ID: <20081013171919.4akk7i318ggg8444@webmail.atica.um.es>

Hi all,

Does anyone know any package which could serve me to to identify  
vegetation patterns in aerial pictures? I am working on wetlands.

Thank you very much in advance!

Javier
University of Murcia (Spain)



From jonthayn at ku.edu  Mon Oct 13 21:00:21 2008
From: jonthayn at ku.edu (Jonathan Boyd Thayn)
Date: Mon, 13 Oct 2008 14:00:21 -0500
Subject: [R-sig-Geo] Shared polygon border
Message-ID: <3455CFBC-338D-4320-A6A9-192BA55CAED0@ku.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081013/af39dfd5/attachment.pl>

From Roger.Bivand at nhh.no  Mon Oct 13 21:33:07 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 13 Oct 2008 21:33:07 +0200 (CEST)
Subject: [R-sig-Geo] Shared polygon border
In-Reply-To: <3455CFBC-338D-4320-A6A9-192BA55CAED0@ku.edu>
References: <3455CFBC-338D-4320-A6A9-192BA55CAED0@ku.edu>
Message-ID: <Pine.LNX.4.64.0810132108200.15504@reclus.nhh.no>

On Mon, 13 Oct 2008, Jonathan Boyd Thayn wrote:

> I want to know the length of the shared border of neighboring polygons
> in a shapefile.  I can use the slots () function to access the the
> "polyons" slot of the file, but I can't seem to create a list of the
> node coordinates of the polyon.  Is there a way to do this easily?

I imagine that you mean the end nodes of arcs with known left and right 
neighbours? The actual ring coordinates are simply the "coords" slots of 
each "Polygon" object in the list in the "Polygons" slot of each 
"Polygons" object in the list in the "polygons" slot of the 
SpatialPolygons object (for a very special definition of "simple"). But 
they wouldn't help much, because you need to build the topology first. If 
you have access to ArcGIS, you can push the polygons out for Arc as a 
shapefile, convert them into a coverage (if they build cleanly) and get 
the coverage back into R using readOGR as both polygons and arcs:

http://www.asdar-book.org/exercises.php?excode=3

and link therein. Getting the lengths from the arcs could use 
SpatialLinesLengths() in sp, and add the values to the 
SpatialLinesDataFrame; this function assumes planar coordinates at 
present. The coverage2nb() would need gentle editing to return a list of 
lengths in the same format as the nb object.

If GRASS is OK, look at vect2neigh() in the spgrass6 package by Markus 
Neteler - it does what you want if the topology builds cleanly, and 
possibly not on all platforms.

Hope this helps,

Roger


> Thanks.
>
>
> Jonathan B. Thayn
> Ph.D. Candidate ? Geography and Remote Sensing
> University of Kansas
> 2101 Constant Avenue, Higuchi Hall, Rm 121
> Lawrence, Kansas 66047-3759
> jonthayn at ku.edu
> http://people.ku.edu/~jonthayn
>
>
> 	[[alternative HTML version deleted]]
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From Paul.Satterthwaite at oregonstate.edu  Mon Oct 13 21:46:46 2008
From: Paul.Satterthwaite at oregonstate.edu (Satterthwaite, Paul)
Date: Mon, 13 Oct 2008 12:46:46 -0700
Subject: [R-sig-Geo] leaps and regsubsets
Message-ID: <D7B94F0B40246740A3EFF9DBBD921B7B796BEB@SAGE.forestry.oregonstate.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081013/ce8ccd5e/attachment.pl>

From friedman.steve at gmail.com  Mon Oct 13 23:22:32 2008
From: friedman.steve at gmail.com (Steve Friedman)
Date: Mon, 13 Oct 2008 17:22:32 -0400
Subject: [R-sig-Geo] Spatial Cross Correlation
Message-ID: <2439f5740810131422m68980edaq21f7381aeb339707@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081013/08a25e7d/attachment.pl>

From adrian at maths.uwa.edu.au  Tue Oct 14 07:39:42 2008
From: adrian at maths.uwa.edu.au (Adrian Baddeley)
Date: Tue, 14 Oct 2008 13:39:42 +0800
Subject: [R-sig-Geo]  plotting Ripley fonctions
Message-ID: <48F4309E.7090107@maths.uwa.edu.au>

Lassana Toure wrote:

 > I need some help for plotting L(r) and Lcross so that I can have my
 > confidence interval(CI) parallel to X axis.
 > The plot I have obtain so far the graphic is not horizontal, then it
 > is difficult to interpret strong the aggregation is or the attraction.

This is a question about the package 'spatstat'.

Presumably you want to plot L(r) - r against r, so that a horizontal 
line corresponds to a completely random pattern; and you want the 
envelopes to be horizontal as well.

If X is your point pattern, then type

     E <- envelope(X, Lest, global=TRUE, nsim=39)
     plot(E, . - r ~ r)

This is for L(r) = sqrt(K(r)/pi) where K(r) is Ripley's K-function. To 
do the same thing for the cross-type L function of a marked point 
pattern, e.g. for the 'amacrine' data:
 
      data(amacrine)
      V <- envelope(amacrine, Lcross, i="on", j="off",
                       global=TRUE, nsim=39)
     plot(V, . - r ~ r)

For further information, see the course notes on spatstat which are 
available at <www.spatstat.org>.

Please note that simulation envelopes are NOT confidence intervals for 
the true value of L(r). They are critical bands for a test of the 
hypothesis of a completely random pattern.

Adrian Baddeley
co-author of spatstat
www.spatstat.org



From astekonex at gmail.com  Tue Oct 14 09:42:55 2008
From: astekonex at gmail.com (seyma ozcan)
Date: Tue, 14 Oct 2008 10:42:55 +0300
Subject: [R-sig-Geo] sp package download problem
Message-ID: <4e4a16eb0810140042o564023bep1262c286b58ea8a@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081014/57cf1a26/attachment.pl>

From p.hiemstra at geo.uu.nl  Tue Oct 14 10:11:27 2008
From: p.hiemstra at geo.uu.nl (Paul Hiemstra)
Date: Tue, 14 Oct 2008 10:11:27 +0200
Subject: [R-sig-Geo] sp package download problem
In-Reply-To: <4e4a16eb0810140042o564023bep1262c286b58ea8a@mail.gmail.com>
References: <4e4a16eb0810140042o564023bep1262c286b58ea8a@mail.gmail.com>
Message-ID: <48F4542F.4020708@geo.uu.nl>

seyma ozcan wrote:
> Hi,For a week or so I have been trying to download the sp package from cran
> repositories but the web explorer gives error that it couldnt reach the web
> page. please can you help me...because it is very important me to download
> sp for my dissertation...
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   
Hi,

I have just downloaded the sp package from the CRAN mirror in Austria.

Are you running, windows or linux? What cran mirror did you try? Why do
you download it through a website? For windows you can use a menu option
from Rgui to get packages, from Linux you can use the install.packages()
command.

cheers and hth,

Paul

ps Try this link for the windows binary version 
http://cran.r-project.org/bin/windows/contrib/2.7/sp_0.9-26.zip
-- 
Drs. Paul Hiemstra
Department of Physical Geography
Faculty of Geosciences
University of Utrecht
Heidelberglaan 2
P.O. Box 80.115
3508 TC Utrecht
Phone: 	+31302535773
Fax:	+31302531145
http://intamap.geo.uu.nl/~paul



From Bjarke.Christensen at sydbank.dk  Tue Oct 14 16:12:27 2008
From: Bjarke.Christensen at sydbank.dk (Bjarke Christensen)
Date: Tue, 14 Oct 2008 16:12:27 +0200
Subject: [R-sig-Geo] How to establish location of points relative to a
	line
In-Reply-To: <Pine.LNX.4.64.0810101946540.7433@reclus.nhh.no>
Message-ID: <OF6DBE7D25.6267E555-ONC12574E2.002D76DF-C12574E2.004E0B67@bdpnet.dk>


>>> I have a SpatialLinesDataFrame (A) and a SpatialPointsDataFrame (B).
How
>>> can I establish which points in B are to the east of a given line in A?
>>>
>>> The problem is to figure out which persons (whose addresses are
geocoded in
>>> B) have addresses to the east of a given road (whose coordinates are
given
>>> in A).

Barry Rowlingson:
>> Is this problem well-defined for a wiggly road? You could be both
>> east and west of a particularly curvy road.

That's a good point. For my purpose, the more precise definition would
really be 'not to the west of any point in A having the same longitude',
but fortunately all my lines are very well behaved in that respect.

>> You could take the nearest point of the road to the address location
>> and then see if this vector has a positive or negative X component....

Roger Bivand:
>Perhaps you could consider completing a polygon with the road on the
>"west" edge, for your definition of "west", for example adding the south.
>east and north edges of the bounding box of the points to the line (take
>care over ring direction!). Then the overlay method would get you there.

This solution works for me, for my non-wiggly roads.

Thanks for your help!

Bjarke.



From opheliawang at mail.utexas.edu  Tue Oct 14 19:25:03 2008
From: opheliawang at mail.utexas.edu (opheliawang at mail.utexas.edu)
Date: Tue, 14 Oct 2008 12:25:03 -0500
Subject: [R-sig-Geo] Create/convert a point pattern from raw txt file in
	spatstat?
Message-ID: <20081014122503.89bxnnezeo4wwg48@new.webmail.utexas.edu>

Hi all,

I'm new to R, so I'm still learning how to do this: I have a txt file  
that contains X Y coordinate of trees (range from 0-100 for both X and  
Y) and a "mark" column that's the tree ID. The total is about 600  
lines. Part of the data looks like:

X	Y	Mark
1	94	1
2.5	94.5	4
3	93	5
4	92	6
4	95	7
6	98	8
4	84	9
6	86	10
6	86	11
6	86	12
6	86	13
8	88	14
9.5	89.5	15
10	90	16

In order to create a point pattern, should I used scanpp, ppp, or  
as.ppp?Here's the error I get for each command:

> test <- read.table("C:/dissertation/data2006/Parcela_1-3/Juyuin_tree.txt")
> w <- owin(c(0,100),c(0,100))
> as.ppp(test, w, fatal=TRUE)
Error: is.numeric(x) is not TRUE

> ppp(x,y, xrange=c(0,100), yrange=c(0,100),marks, check=TRUE)
Error in ppp(x, y, xrange = c(0, 100), yrange = c(0, 100), marks,  
check = TRUE) : object "x" not found

> scanpp("C:/dissertation/data2006/Parcela_1-3/Juyuin_tree.txt",  
> c(0,100,0, 100), header=TRUE, dir="", multitype=FALSE)
Error in verifyclass(window, "owin") : argument ?window? is not of  
class ?owin?

> scanpp("C:/dissertation/data2006/Parcela_1-3/Juyuin_tree.txt", w,  
> header=TRUE, dir="", multitype=FALSE)
Error: is.numeric(x) is not TRUE

My problems are not knowing which command to use and how the "window"  
should be specified. Can anyone help me with this? Thanks so much!

Ophelia



From b.rowlingson at lancaster.ac.uk  Tue Oct 14 19:47:54 2008
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Tue, 14 Oct 2008 18:47:54 +0100
Subject: [R-sig-Geo] Create/convert a point pattern from raw txt file in
	spatstat?
In-Reply-To: <20081014122503.89bxnnezeo4wwg48@new.webmail.utexas.edu>
References: <20081014122503.89bxnnezeo4wwg48@new.webmail.utexas.edu>
Message-ID: <d8ad40b50810141047p87b64acuc045e6799513ac12@mail.gmail.com>

2008/10/14  <opheliawang at mail.utexas.edu>:
> Hi all,
>
> I'm new to R, so I'm still learning how to do this: I have a txt file that
> contains X Y coordinate of trees (range from 0-100 for both X and Y) and a
> "mark" column that's the tree ID. The total is about 600 lines. Part of the
> data looks like:
>
> X       Y       Mark
> 1       94      1
> 2.5     94.5    4
> 3       93      5
> 4       92      6
> 4       95      7
> 6       98      8
> 4       84      9
> 6       86      10
> 6       86      11
> 6       86      12
> 6       86      13
> 8       88      14
> 9.5     89.5    15
> 10      90      16
>
> In order to create a point pattern, should I used scanpp, ppp, or
> as.ppp?Here's the error I get for each command:
>
>> test <- read.table("C:/dissertation/data2006/Parcela_1-3/Juyuin_tree.txt")
>> w <- owin(c(0,100),c(0,100))
>> as.ppp(test, w, fatal=TRUE)
>
> Error: is.numeric(x) is not TRUE

 That's a clue there. Something in your data isn't a number. Now your
file looks like all numbers.. except... those headers!

 You need to tell read.table that you've got headings, by using
head=TRUE. Compare:

 > test = read.table("tree.txt")
 > test[1:5,]
     V1   V2   V3     <- R made these headings
 1    X    Y Mark     <- oops
 2    1   94    1
 3  2.5 94.5    4
 4    3   93    5
 5    4   92    6

 > test = read.table("tree.txt",head=TRUE)
 > test[1:5,]
      X    Y Mark    <- R's headings
 1  1.0 94.0    1  <-  your data starts here
 2  2.5 94.5    4
 3  3.0 93.0    5
 4  4.0 92.0    6
 5  4.0 95.0    7

from there, as.ppp(test,w) works fine:

> as.ppp(test, w, fatal=TR)
marked planar point pattern: 14 points
marks are numeric, of type 'integer'
window: rectangle = [0, 100] x [0, 100] units
Warning message:
In ppp(X[, 1], X[, 2], window = win, check = check) :
  data contain duplicated points

 If you still get errors with head=TRUE then there's something else in
your data file that's not a number. Read some introductory R docs on
reading data (help(read.table) for starters).

 summary(test) and str(test) will tell you things about test before
you go on and try and do things with it. You should always make sure
step N is okay before assuming the problem is with step N+1...

Barry



From alessandro.montaghi at unifi.it  Tue Oct 14 21:03:37 2008
From: alessandro.montaghi at unifi.it (Alessandro)
Date: Tue, 14 Oct 2008 12:03:37 -0700
Subject: [R-sig-Geo] Points density in R
Message-ID: <001801c92e2f$918edf50$b4ac9df0$@montaghi@unifi.it>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081014/f20e7d62/attachment.pl>

From jonthayn at ku.edu  Tue Oct 14 21:36:34 2008
From: jonthayn at ku.edu (Jonathan Boyd Thayn)
Date: Tue, 14 Oct 2008 14:36:34 -0500
Subject: [R-sig-Geo] Shared polygon border
In-Reply-To: <Pine.LNX.4.64.0810132108200.15504@reclus.nhh.no>
References: <3455CFBC-338D-4320-A6A9-192BA55CAED0@ku.edu>
	<Pine.LNX.4.64.0810132108200.15504@reclus.nhh.no>
Message-ID: <919CDF97-C986-46BC-9747-C666A7D5ECC2@ku.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081014/a62734bb/attachment.pl>

From Roger.Bivand at nhh.no  Tue Oct 14 21:56:43 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 14 Oct 2008 21:56:43 +0200 (CEST)
Subject: [R-sig-Geo] Shared polygon border
In-Reply-To: <919CDF97-C986-46BC-9747-C666A7D5ECC2@ku.edu>
References: <3455CFBC-338D-4320-A6A9-192BA55CAED0@ku.edu>
	<Pine.LNX.4.64.0810132108200.15504@reclus.nhh.no>
	<919CDF97-C986-46BC-9747-C666A7D5ECC2@ku.edu>
Message-ID: <Pine.LNX.4.64.0810142145320.20786@reclus.nhh.no>

On Tue, 14 Oct 2008, Jonathan Boyd Thayn wrote:

> I appreciate the "simple" explanation, which does make since.  I am
> still unable, however, to access the "coords" matrices inside of the
> SpatialPolyons object.  I'm sure that there is a simple way to do
> this, but I can't figure it out.  If I open a shapefile using
> readOGR() what code to I use to access the node coordinates?  Thanks
> again for your help.

For example:

library(rgdal)
scot_BNG <- readOGR(system.file("vectors", package = "rgdal")[1],
   "scot_BNG")
length(slot(scot_BNG, "polygons"))
sapply(slot(scot_BNG, "polygons"), function(x) length(slot(x,
   "Polygons")))

slot(slot(slot(scot_BNG, "polygons")[[1]], "Polygons")[[1]], "coords")

retrieves the coordinate ring of the first Polygon object in the first 
Polygons object in the SpatialPolygons object scot_BNG. So:

res <- lapply(slot(scot_BNG, "polygons"), function(x) lapply(slot(x,
   "Polygons"), function(y) slot(y, "coords")))

gets all of the coordinates into a list of lists of matrices. However, it 
doesn't tell you which are nodes in an arc-node topology (points at which 
three or more polygon entities (including the external polygon) meet. 
Getting the coordinate rings doesn't give you the nodes - for that you 
have to build the topology, which is hard computational geometry best done 
in a GIS like GRASS or ArcGIS.

Hope this helps,

Roger

>
> Jon Thayn
>
>
> On Oct 13, 2008, at 2:33 PM, Roger Bivand wrote:
>
>> On Mon, 13 Oct 2008, Jonathan Boyd Thayn wrote:
>>
>>> I want to know the length of the shared border of neighboring
>>> polygons
>>> in a shapefile.  I can use the slots () function to access the the
>>> "polyons" slot of the file, but I can't seem to create a list of the
>>> node coordinates of the polyon.  Is there a way to do this easily?
>>
>> I imagine that you mean the end nodes of arcs with known left and
>> right neighbours? The actual ring coordinates are simply the
>> "coords" slots of each "Polygon" object in the list in the
>> "Polygons" slot of each "Polygons" object in the list in the
>> "polygons" slot of the SpatialPolygons object (for a very special
>> definition of "simple"). But they wouldn't help much, because you
>> need to build the topology first. If you have access to ArcGIS, you
>> can push the polygons out for Arc as a shapefile, convert them into
>> a coverage (if they build cleanly) and get the coverage back into R
>> using readOGR as both polygons and arcs:
>>
>> http://www.asdar-book.org/exercises.php?excode=3
>>
>> and link therein. Getting the lengths from the arcs could use
>> SpatialLinesLengths() in sp, and add the values to the
>> SpatialLinesDataFrame; this function assumes planar coordinates at
>> present. The coverage2nb() would need gentle editing to return a
>> list of lengths in the same format as the nb object.
>>
>> If GRASS is OK, look at vect2neigh() in the spgrass6 package by
>> Markus Neteler - it does what you want if the topology builds
>> cleanly, and possibly not on all platforms.
>>
>> Hope this helps,
>>
>> Roger
>>
>>
>>> Thanks.
>>>
>>>
>>> Jonathan B. Thayn
>>> Ph.D. Candidate ? Geography and Remote Sensing
>>> University of Kansas
>>> 2101 Constant Avenue, Higuchi Hall, Rm 121
>>> Lawrence, Kansas 66047-3759
>>> jonthayn at ku.edu
>>> http://people.ku.edu/~jonthayn
>>>
>>>
>>> 	[[alternative HTML version deleted]]
>>>
>>>
>>
>> --
>> Roger Bivand
>> Economic Geography Section, Department of Economics, Norwegian
>> School of
>> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>
>
> 	[[alternative HTML version deleted]]
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From T.Hengl at uva.nl  Wed Oct 15 09:52:44 2008
From: T.Hengl at uva.nl (Tomislav Hengl)
Date: Wed, 15 Oct 2008 09:52:44 +0200
Subject: [R-sig-Geo] Points density in R
In-Reply-To: <001801c92e2f$918edf50$b4ac9df0$@montaghi@unifi.it>
References: <001801c92e2f$918edf50$b4ac9df0$@montaghi@unifi.it>
Message-ID: <7D13FC8A5F644D63B1B5209CB972F655@pcibed193>


Kernel density can be derived in spatstat package, but also in adehabitat and many other packages.

You need to loop your operations (output as a list). Note that I use the same file names to save
space - you only need the output of course!

***************

library(maptools)
library(rgdal)
library(spatstat)

txt.list <- dir(pattern=glob2rx("*.txt"))
txt.list

vegetation.list <- as.list(paste(1:length(txt.list),"m",sep=""))
density.list <- as.list(paste(1:length(txt.list),"m",sep=""))
for(i in seq(along=txt.list)) {
   vegetation <- read.delim(paste(txt.list[[i]]), sep=" ")
   coordinates(vegetation) <- ~X+Y
   proj4string(vegetation) <- CRS("+init=epsg:26911")
   vegetation.ppp <- as(vegetation[1], "ppp")  # here you will probably be better of if you define
the grid topology yourself (otherwise you get 100x100 pixels by default)
   density.list[[i]] <- density.ppp(vegetation.ppp, sigma=120)
   writeOGR(vegetation[1], paste(vegetation.list[[i]], ".shp", sep=""), "vegetation", driver="ESRI
Shapefile")   
}

image(density.list[[1]])
str(density.list, max.level=2)

***************

For future reference, we can not help you if you do not provide any data (there is a lot of data on
CRAN already). Please also read carefully http://www.r-project.org/posting-guide.html 


yours,

T. Hengl
http://spatial-analyst.net 



-----Original Message-----
From: r-sig-geo-bounces at stat.math.ethz.ch [mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of
Alessandro
Sent: Tuesday, October 14, 2008 9:04 PM
To: r-sig-geo at stat.math.ethz.ch
Subject: [R-sig-Geo] Points density in R

Hi all,

 

I have a txt file with X,Y,Z value. I wish to create a density points Map in
R but sorry I didn't find a right code in R.

 

Part of my code is this.  I have a another  question. With many data files
to import, Is It possible don't write 10 lines like my not beautiful code? 

 

Thanks Ale

 

library(maptools)

library(rgdal)

rsaga.env(path="C:/Progra~1/saga_vc")

library(RSAGA)

library(gstat)

vegetation_2m <- read.delim("vegetation_2m.txt", sep=" ")

vegetation_3m <- read.delim("vegetation_3m.txt", sep=" ")

vegetation_4m <- read.delim("vegetation_4m.txt", sep=" ")

vegetation_5m <- read.delim("vegetation_5m.txt", sep=" ")

vegetation_6m <- read.delim("vegetation_6m.txt", sep=" ")

vegetation_7m <- read.delim("vegetation_7m.txt", sep=" ")

vegetation_8m <- read.delim("vegetation_8m.txt", sep=" ")

vegetation_9m <- read.delim("vegetation_9m.txt", sep=" ")

vegetation_10m <- read.delim("vegetation_10m.txt", sep=" ")

coordinates(vegetation_2m) =~X+Y

coordinates(vegetation_3m) =~X+Y

coordinates(vegetation_4m) =~X+Y

coordinates(vegetation_5m) =~X+Y

coordinates(vegetation_6m) =~X+Y

coordinates(vegetation_7m) =~X+Y

coordinates(vegetation_8m) =~X+Y

coordinates(vegetation_9m) =~X+Y

proj4string(vegetation_2m) <- CRS("+init=epsg:26911")

proj4string(vegetation_3m) <- CRS("+init=epsg:26911")

proj4string(vegetation_4m) <- CRS("+init=epsg:26911")

proj4string(vegetation_5m) <- CRS("+init=epsg:26911")

proj4string(vegetation_6m) <- CRS("+init=epsg:26911")

proj4string(vegetation_7m) <- CRS("+init=epsg:26911")

proj4string(vegetation_8m) <- CRS("+init=epsg:26911")

proj4string(vegetation_9m) <- CRS("+init=epsg:26911")

#convert in .shp to use RSAGA

writeOGR(vegetation_2m["Z"], "vegetation_2m.shp", "vegetation_2m",
driver="ESRI Shapefile")

writeOGR(vegetation_3m["Z"], "vegetation_3m.shp", "vegetation_3m",
driver="ESRI Shapefile")

writeOGR(vegetation_4m["Z"], "vegetation_4m.shp", "vegetation_4m",
driver="ESRI Shapefile")

writeOGR(vegetation_5m["Z"], "vegetation_5m.shp", "vegetation_5m",
driver="ESRI Shapefile")

writeOGR(vegetation_6m["Z"], "vegetation_6m.shp", "vegetation_6m",
driver="ESRI Shapefile")

writeOGR(vegetation_7m["Z"], "vegetation_7m.shp", "vegetation_7m",
driver="ESRI Shapefile")

writeOGR(vegetation_8m["Z"], "vegetation_8m.shp", "vegetation_8m",
driver="ESRI Shapefile")

writeOGR(vegetation_9m["Z"], "vegetation_9m.shp", "vegetation_9m",
driver="ESRI Shapefile")

 


	[[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch
https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From Mikael.Carlsson at sgu.se  Wed Oct 15 14:50:27 2008
From: Mikael.Carlsson at sgu.se (Mikael Carlsson)
Date: Wed, 15 Oct 2008 14:50:27 +0200
Subject: [R-sig-Geo] Uniras routin in R
Message-ID: <OF152446E8.217C4E31-ONC12574E3.004625B8-C12574E3.00469532@sgu.se>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081015/39d9f5bf/attachment.pl>

From mwdenslow at yahoo.com  Wed Oct 15 16:50:00 2008
From: mwdenslow at yahoo.com (Michael Denslow)
Date: Wed, 15 Oct 2008 07:50:00 -0700 (PDT)
Subject: [R-sig-Geo] info about package divagis
Message-ID: <279511.17999.qm@web33105.mail.mud.yahoo.com>

Hello List,

I was hoping that someone on this list might have some more information about the 'divagis' a package.
http://cran.r-project.org/web/packages/divagis/

The site says that it 'Provides tools for quality checks of georeferenced plant species accessions'. I am very interest in this area and have mostly used Biogeomancer for georeferenceing and error checking of legacy data. I was previously unaware that R had a package that was related to this area. It does not provide examples so I am a bit unclear as to what it is intended to do. Has anyone used it?

Thanks in advance for your help.
Michael


Michael Denslow

I.W. Carpenter Jr. Herbarium [BOON]
Appalachian State University
Boone, North Carolina U.S.A.

-- AND --

Communications Manager
Southeastern Regional Network of Expertise and Collections
sernec.org



From b.rowlingson at lancaster.ac.uk  Wed Oct 15 17:39:44 2008
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed, 15 Oct 2008 16:39:44 +0100
Subject: [R-sig-Geo] Geonames lookup (was lat/lon to timezone)
Message-ID: <d8ad40b50810150839jce086c0j925c707425555df1@mail.gmail.com>

My R interface to GeoNames is now on R-forge:

 http://geonames.r-forge.r-project.org/

Assuming I haven't mucked anything up the package binaries should get
built later, otherwise you can check out the SVN and play with it:

svn checkout svn://svn.r-forge.r-project.org/svnroot/geonames

Barry



From spluque at gmail.com  Wed Oct 15 18:49:06 2008
From: spluque at gmail.com (Sebastian P. Luque)
Date: Wed, 15 Oct 2008 11:49:06 -0500
Subject: [R-sig-Geo] map2SpatialPolygons' 'proj4string' in spmaps
Message-ID: <87abd5ajnh.fsf@patagonia.sebmags.homelinux.org>

Hi,

I don't understand what the 'proj4string' argument in
map2SpatialPolygons() does.  map() in the maps package has a
'projection' argument:

,-----[ *help[R](map)* ]
| projection: character string that names a map projection to use. See
|           'mapproject' (in the 'mapproj' library). The default is to
|           use a rectangular projection with the aspect ratio chosen so
|           that longitude and latitude scales are equivalent at the
|           center of the picture. 
`-----

so I don't know what projection was actually used in a given map() call
with that default 'projection' argument.  I suppose 'proj4string' in
map2SpatialPolygons() should match the actual projection used in the
map() call, shouldn't it?  Thanks.


Cheers,

-- 
Seb
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 196 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081015/8192e806/attachment.bin>

From Roger.Bivand at nhh.no  Wed Oct 15 19:24:18 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 15 Oct 2008 19:24:18 +0200 (CEST)
Subject: [R-sig-Geo] map2SpatialPolygons' 'proj4string' in spmaps
In-Reply-To: <87abd5ajnh.fsf@patagonia.sebmags.homelinux.org>
References: <87abd5ajnh.fsf@patagonia.sebmags.homelinux.org>
Message-ID: <Pine.LNX.4.64.0810151915500.32131@reclus.nhh.no>

On Wed, 15 Oct 2008, Sebastian P. Luque wrote:

> Hi,
>
> I don't understand what the 'proj4string' argument in
> map2SpatialPolygons() does.  map() in the maps package has a
> 'projection' argument:
>
> ,-----[ *help[R](map)* ]
> | projection: character string that names a map projection to use. See
> |           'mapproject' (in the 'mapproj' library). The default is to
> |           use a rectangular projection with the aspect ratio chosen so
> |           that longitude and latitude scales are equivalent at the
> |           center of the picture.
> `-----
>
> so I don't know what projection was actually used in a given map() call
> with that default 'projection' argument.  I suppose 'proj4string' in
> map2SpatialPolygons() should match the actual projection used in the
> map() call, shouldn't it?  Thanks.
>

No, not at all. The coordinates returned by map() if projection= is used 
are only for plotting, are in arbitrary units, and are only documented in 
code. map2SpatialPolygons() assumes that the data are in geographical 
coordinates, and ought perhaps to guess an ellipse and datum based on the 
age of the dataset (world possibly WGS84, US counties probably NAD27), but 
allows the user to set the CRS object directly. The projection= argument 
of map() makes the function call mapproject() with the given projection on 
the data flowing through, I believe.

If you do str() of map(projection=) output, you will see the projection 
name used, but note that the coordinates are arbitrary.

Roger

>
> Cheers,
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From spluque at gmail.com  Wed Oct 15 19:45:03 2008
From: spluque at gmail.com (Sebastian P. Luque)
Date: Wed, 15 Oct 2008 12:45:03 -0500
Subject: [R-sig-Geo] map2SpatialPolygons' 'proj4string' in spmaps
References: <87abd5ajnh.fsf@patagonia.sebmags.homelinux.org>
	<Pine.LNX.4.64.0810151915500.32131@reclus.nhh.no>
Message-ID: <8763ntah28.fsf@patagonia.sebmags.homelinux.org>

On Wed, 15 Oct 2008 19:24:18 +0200 (CEST),
Roger Bivand <Roger.Bivand at nhh.no> wrote:

[...]

> No, not at all. The coordinates returned by map() if projection= is used
> are only for plotting, are in arbitrary units, and are only documented in
> code. map2SpatialPolygons() assumes that the data are in geographical
> coordinates, and ought perhaps to guess an ellipse and datum based on the
> age of the dataset (world possibly WGS84, US counties probably NAD27), but
> allows the user to set the CRS object directly. The projection= argument of
> map() makes the function call mapproject() with the given projection on the
> data flowing through, I believe.

> If you do str() of map(projection=) output, you will see the projection
> name used, but note that the coordinates are arbitrary.

Thanks a lot Roger, so here:

se.baffin <- map("worldHires", xlim=c(-70, -60), ylim=c(62, 69),
                 resolution=0, interior=FALSE)

or in any of the world* databases, can we safely assume "+proj=longlat
+ellps=WGS84" (possibly with "+over" in some cases) in the returned
object?  This would be good info to have in ?map.

One problem I also run into with map2SpatialPolygons() with the above
map object, is that the ring is not closed.  Do you know of any examples
showing how one may close such rings, based on a polygon?  Say we have a
rectangle over the map object and want to close the ring so we enclose
all the land (or water)?


Cheers,

-- 
Seb
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 196 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081015/e7803e33/attachment.bin>

From Roger.Bivand at nhh.no  Wed Oct 15 20:20:16 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 15 Oct 2008 20:20:16 +0200 (CEST)
Subject: [R-sig-Geo] map2SpatialPolygons' 'proj4string' in spmaps
In-Reply-To: <8763ntah28.fsf@patagonia.sebmags.homelinux.org>
References: <87abd5ajnh.fsf@patagonia.sebmags.homelinux.org>
	<Pine.LNX.4.64.0810151915500.32131@reclus.nhh.no>
	<8763ntah28.fsf@patagonia.sebmags.homelinux.org>
Message-ID: <Pine.LNX.4.64.0810152011400.32131@reclus.nhh.no>

On Wed, 15 Oct 2008, Sebastian P. Luque wrote:

> On Wed, 15 Oct 2008 19:24:18 +0200 (CEST),
> Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
> [...]
>
>> No, not at all. The coordinates returned by map() if projection= is used
>> are only for plotting, are in arbitrary units, and are only documented in
>> code. map2SpatialPolygons() assumes that the data are in geographical
>> coordinates, and ought perhaps to guess an ellipse and datum based on the
>> age of the dataset (world possibly WGS84, US counties probably NAD27), but
>> allows the user to set the CRS object directly. The projection= argument of
>> map() makes the function call mapproject() with the given projection on the
>> data flowing through, I believe.
>
>> If you do str() of map(projection=) output, you will see the projection
>> name used, but note that the coordinates are arbitrary.
>
> Thanks a lot Roger, so here:
>
> se.baffin <- map("worldHires", xlim=c(-70, -60), ylim=c(62, 69),
>                 resolution=0, interior=FALSE)
>
> or in any of the world* databases, can we safely assume "+proj=longlat
> +ellps=WGS84" (possibly with "+over" in some cases) in the returned
> object?  This would be good info to have in ?map.
>
> One problem I also run into with map2SpatialPolygons() with the above
> map object, is that the ring is not closed.

If the fill=TRUE argument to map() is omitted, the rings are not built:

se.baffin <- map("worldHires", xlim=c(-70, -60), ylim=c(62, 69),
   resolution=0, interior=FALSE, fill=TRUE, plot=FALSE)
baff <- map2SpatialPolygons(se.baffin,
   IDs=se.baffin$names)[match("Canada:Baffin Island", se.baffin$names)]
plot(baff, axes=TRUE)

looks OK to me. Add the CRS later. I don't think that we know definitely 
that WGS84 was used, WDBII seems to have been around since 1985. Try 
overlaying on GE, for example, to get a feel.

> Do you know of any examples showing how one may close such rings, based 
> on a polygon?  Say we have a rectangle over the map object and want to 
> close the ring so we enclose all the land (or water)?

By hand, you need to insert coordinates into the coords slot of the 
Polygon object of interest and re-generate it. A recent question on the 
list about houses east of a road was handled this way (stitch the bounding 
box to the road and use overlay()).

Otherwise look at the unionSpatialPolygons() code for ideas on interfacing 
gpclib classes and methods (also in PBSmapping).

Best wishes,

Roger

>
>
> Cheers,
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From spluque at gmail.com  Wed Oct 15 20:31:51 2008
From: spluque at gmail.com (Sebastian P. Luque)
Date: Wed, 15 Oct 2008 13:31:51 -0500
Subject: [R-sig-Geo] map2SpatialPolygons' 'proj4string' in spmaps
References: <87abd5ajnh.fsf@patagonia.sebmags.homelinux.org>
	<Pine.LNX.4.64.0810151915500.32131@reclus.nhh.no>
	<8763ntah28.fsf@patagonia.sebmags.homelinux.org>
	<Pine.LNX.4.64.0810152011400.32131@reclus.nhh.no>
Message-ID: <87y70p90bs.fsf@patagonia.sebmags.homelinux.org>

On Wed, 15 Oct 2008 20:20:16 +0200 (CEST),
Roger Bivand <Roger.Bivand at nhh.no> wrote:

> On Wed, 15 Oct 2008, Sebastian P. Luque wrote:
>> On Wed, 15 Oct 2008 19:24:18 +0200 (CEST),
>> Roger Bivand <Roger.Bivand at nhh.no> wrote:

[...]

> If the fill=TRUE argument to map() is omitted, the rings are not
> built:

> se.baffin <- map("worldHires", xlim=c(-70, -60), ylim=c(62, 69),
> resolution=0, interior=FALSE, fill=TRUE, plot=FALSE) baff <-
> map2SpatialPolygons(se.baffin,
> IDs=se.baffin$names)[match("Canada:Baffin Island", se.baffin$names)]
> plot(baff, axes=TRUE)

> looks OK to me. Add the CRS later. I don't think that we know
> definitely that WGS84 was used, WDBII seems to have been around since
> 1985. Try overlaying on GE, for example, to get a feel.

Great, I'll check on this.


>> Do you know of any examples showing how one may close such rings,
>> based on a polygon?  Say we have a rectangle over the map object and
>> want to close the ring so we enclose all the land (or water)?

> By hand, you need to insert coordinates into the coords slot of the
> Polygon object of interest and re-generate it. A recent question on
> the list about houses east of a road was handled this way (stitch the
> bounding box to the road and use overlay()).

> Otherwise look at the unionSpatialPolygons() code for ideas on
> interfacing gpclib classes and methods (also in PBSmapping).

Thanks so much, I'll follow these leads!


All the best,

-- 
Seb
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 196 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081015/eb4c6eb2/attachment.bin>

From alessandro.montaghi at unifi.it  Wed Oct 15 22:08:31 2008
From: alessandro.montaghi at unifi.it (Alessandro)
Date: Wed, 15 Oct 2008 13:08:31 -0700
Subject: [R-sig-Geo] R+SAGA formula to subtract two raster
Message-ID: <001c01c92f01$cd6c7640$684562c0$@montaghi@unifi.it>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081015/ab7ad1ae/attachment.pl>

From tlumley at u.washington.edu  Thu Oct 16 01:06:47 2008
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Wed, 15 Oct 2008 16:06:47 -0700 (PDT)
Subject: [R-sig-Geo] points on polygons
Message-ID: <Pine.LNX.4.64.0810151606310.32235@homer21.u.washington.edu>



I am trying to draw a US map with color-coded cities superimposed on 
color-coded states, showing survey results from the Behavioral Risk Factor 
Surveillance System.  You can see the sort of thing I'm trying to do at
http://apps.nccd.cdc.gov/gisbrfss/select_question.aspx (though I don't want all 
the text).

I have the spatial data, which are a shapefile of polygons for the states, and 
a shapefile of points for the cities.  I can read these in and use spplot() and 
the sp.layout option to get the points plotted on top of the polygons, but I 
can't figure out how to get a common set of colors used for both and and a 
color key drawn.

 	-thomas

Thomas Lumley			Assoc. Professor, Biostatistics
tlumley at u.washington.edu	University of Washington, Seattle



From h.wickham at gmail.com  Thu Oct 16 01:38:09 2008
From: h.wickham at gmail.com (hadley wickham)
Date: Wed, 15 Oct 2008 18:38:09 -0500
Subject: [R-sig-Geo] points on polygons
In-Reply-To: <Pine.LNX.4.64.0810151606310.32235@homer21.u.washington.edu>
References: <Pine.LNX.4.64.0810151606310.32235@homer21.u.washington.edu>
Message-ID: <f8e6ff050810151638x2675d49fycc1b4401ded4b8d@mail.gmail.com>

On Wed, Oct 15, 2008 at 6:06 PM, Thomas Lumley <tlumley at u.washington.edu> wrote:
>
>
> I am trying to draw a US map with color-coded cities superimposed on
> color-coded states, showing survey results from the Behavioral Risk Factor
> Surveillance System.  You can see the sort of thing I'm trying to do at
> http://apps.nccd.cdc.gov/gisbrfss/select_question.aspx (though I don't want
> all the text).
>
> I have the spatial data, which are a shapefile of polygons for the states,
> and a shapefile of points for the cities.  I can read these in and use
> spplot() and the sp.layout option to get the points plotted on top of the
> polygons, but I can't figure out how to get a common set of colors used for
> both and and a color key drawn.

It's relatively easy to do this with ggplot2 (the tricky part is
converting the polygons to a data frame) - I can provide some code if
you're interested.

Hadley


-- 
http://had.co.nz/



From tlumley at u.washington.edu  Thu Oct 16 02:19:28 2008
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Wed, 15 Oct 2008 17:19:28 -0700 (PDT)
Subject: [R-sig-Geo] points on polygons
In-Reply-To: <f8e6ff050810151638x2675d49fycc1b4401ded4b8d@mail.gmail.com>
References: <Pine.LNX.4.64.0810151606310.32235@homer21.u.washington.edu>
	<f8e6ff050810151638x2675d49fycc1b4401ded4b8d@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0810151718210.32235@homer21.u.washington.edu>

On Wed, 15 Oct 2008, hadley wickham wrote:

> It's relatively easy to do this with ggplot2 (the tricky part is
> converting the polygons to a data frame) - I can provide some code if
> you're interested.
>

That would be great.

 	-thomas

Thomas Lumley			Assoc. Professor, Biostatistics
tlumley at u.washington.edu	University of Washington, Seattle



From Roger.Bivand at nhh.no  Thu Oct 16 09:29:43 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 16 Oct 2008 09:29:43 +0200 (CEST)
Subject: [R-sig-Geo] points on polygons
In-Reply-To: <Pine.LNX.4.64.0810151718210.32235@homer21.u.washington.edu>
References: <Pine.LNX.4.64.0810151606310.32235@homer21.u.washington.edu>
	<f8e6ff050810151638x2675d49fycc1b4401ded4b8d@mail.gmail.com>
	<Pine.LNX.4.64.0810151718210.32235@homer21.u.washington.edu>
Message-ID: <Pine.LNX.4.64.0810160912210.2735@reclus.nhh.no>

On Wed, 15 Oct 2008, Thomas Lumley wrote:

> On Wed, 15 Oct 2008, hadley wickham wrote:
>
>>  It's relatively easy to do this with ggplot2 (the tricky part is
>>  converting the polygons to a data frame) - I can provide some code if
>>  you're interested.
>> 
>
> That would be great.
>

A direct spplot draft, avoiding converting the geometries, would be 
something like:

library(sp)
library(rgdal)
# downloaded from the site you specified
MMSA <- readOGR(".", "BRFSS_MMSA_2007")
BRFSS <- readOGR(".", "brfss_state_2007_download")
library(classInt)
# make shared class intervals - "jenks" is similar to GIS "natural breaks"
cI <- classIntervals(BRFSS$X4409_3, n=5, style="jenks")
x <- MMSA$X4409_3
is.na(x) <- x < 1
range(x, na.rm=TRUE)
brks <- cI$brks
# manipulate breaks to span MMSA data
brks[1] <- range(x, na.rm=TRUE)[1]
brks[length(brks)] <- range(x, na.rm=TRUE)[2]
library(RColorBrewer)
pal <- brewer.pal(length(brks)-1, "YlOrBr")
spl0 <- list("sp.points", MMSA[MMSA$X4409_3 < 1,], pch=21, col=1,
   fill="grey")
# break out MMSA NAs
spl1 <- list("sp.points", MMSA[MMSA$X4409_3 > 0,], pch=21, col=1,
   fill=pal[findInterval(MMSA$X4409_3, brks, all.inside=TRUE)])
# colour MMSAs
spplot(BRFSS, "X4409_3", at=brks, col.regions=pal, sp.layout=list(spl0,
   spl1))

These are using the data from the shapefiles, I suspect that the values in 
the CSV files are being used in the online display, and that the two 
differ (not only in giving one digit after the decimal point, but also 
there are 183 in the shapefile and 184 in the CSV file).

I guess it could be automated and made more robust.

Hope this helps,

Roger

> 	-thomas
>
> Thomas Lumley			Assoc. Professor, Biostatistics
> tlumley at u.washington.edu	University of Washington, Seattle
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From brenning at uwaterloo.ca  Thu Oct 16 13:16:49 2008
From: brenning at uwaterloo.ca (Alexander Brenning)
Date: Thu, 16 Oct 2008 07:16:49 -0400
Subject: [R-sig-Geo] R+SAGA formula to subtract two raster
In-Reply-To: <001c01c92f01$cd6c7640$684562c0$@montaghi@unifi.it>
References: <001c01c92f01$cd6c7640$684562c0$@montaghi@unifi.it>
Message-ID: <48F722A1.3030100@uwaterloo.ca>

Hi Alessandro,

SAGA has a grid_calculus library. RSAGA provides a wrapper function 
rsaga.grid.calculus, and even rsaga.linear.combination as a more 
convenient version when you want to apply linear models to stacks of 
grids. See ?rsaga.grid.calculus, there's also some example code.

Here some code for your problem of subtracting grids. I am playing 
around with two small identical grids temp1.sgrd and temp2.sgrd and want 
to show that their difference is zero.


library(RSAGA)

rsaga.grid.calculus(in.grids = c("temp1","temp2"),
     out.grid = "result", formula = ~a-b)
# formula could also be  formula = "a+b"
# 'a' refers to the first grid from in.grids,
# 'b' to the second one, etc.

# Same result:
#rsaga.linear.combination( c("temp1", "temp2"), "result",
#    coef = c(1,-1))

# Let's have a look at the data in R
# (if the grid is not too large...):
rsaga.sgrd.to.esri("result", prec = 1)
res = read.ascii.grid("result", return.header = FALSE)
summary(as.vector(res)) # in my case, all ==0 because temp1=temp2


Note that there's also a wrapper function rsaga.close.gaps for the 
module that you are using in the following piece of code:

 > # filter the missing values using neighbours:
 >
 > rsaga.geoprocessor(lib="grid_tools", module=7,
 > param=list(INPUT="DEM_1.sgrd", RESULT="DEM_1_f.sgrd", THRESHOLD=0.1))


I hope this helps.
  Alex




Alessandro wrote:
> Hi All,
> 
>  
> 
> I need help to write a code in R to subtract two raster in SAGA.
> 
>  
> 
> I have "DEM_1_f.sgrd" and "DSM_1_f.sgrd" in SAGA format and I wish to
> subtract (DSM_1_f.sgrd - DEM_1_f.sgrd) to obtain a new layer 
> 
>  
> 
> A part of the code is this:
> 
>  
> 
> #A# DEM - 1) Shapes to Grid
> 
> rsaga.get.usage("grid_gridding", 3)
> 
> rsaga.geoprocessor(lib="grid_gridding", module=3,
> param=list(GRID="DEM_1.sgrd", INPUT="ground.shp", FIELD=0, LINE_TYPE=0,
> USER_CELL_SIZE=dem.pixelsize, USER_X_EXTENT_MIN=ground at bbox[1,1],
> USER_X_EXTENT_MAX=ground at bbox[1,2], USER_Y_EXTENT_MIN=ground at bbox[2,1],
> USER_Y_EXTENT_MAX=ground at bbox[2,2]))
> 
> # filter the missing values using neighbours:
> 
> rsaga.geoprocessor(lib="grid_tools", module=7,
> param=list(INPUT="DEM_1.sgrd", RESULT="DEM_1_f.sgrd", THRESHOLD=0.1))
> 
>  
> 
> #A# DSM - 2) Shapes to Grid
> 
> rsaga.get.usage("grid_gridding", 3)
> 
> rsaga.geoprocessor(lib="grid_gridding", module=3,
> param=list(GRID="DSM_1.sgrd", INPUT="vegetation.shp", FIELD=0, LINE_TYPE=0,
> USER_CELL_SIZE=dem.pixelsize, USER_X_EXTENT_MIN=vegetation at bbox[1,1],
> USER_X_EXTENT_MAX=vegetation at bbox[1,2],
> USER_Y_EXTENT_MIN=vegetation at bbox[2,1],
> USER_Y_EXTENT_MAX=vegetation at bbox[2,2]))
> 
> # filter the missing values using neighbours:
> 
> rsaga.geoprocessor(lib="grid_tools", module=7,
> param=list(INPUT="DSM_1.sgrd", RESULT="DSM_1_f.sgrd", THRESHOLD=0.1))
> 
>  
> 
> #DCM = DSM - DEM
> 
>  
> 
> Rsaga.geoprocessor(???)
> 
>  
> 
> Thanks for help 
> 
>  
> 
> Ale
> 
>  
> 
> PS: is there a link with a SAGA and R codes banks
> 
>  
> 
>  
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 

-- 
Alexander Brenning
brenning at uwaterloo.ca - T +1-519-888-4567 ext 35783
Department of Geography and Environmental Management
University of Waterloo
200 University Ave. W - Waterloo, ON - Canada N2L 3G1
http://www.fes.uwaterloo.ca/geography/faculty/brenning/



From b.rowlingson at lancaster.ac.uk  Thu Oct 16 13:54:30 2008
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Thu, 16 Oct 2008 12:54:30 +0100
Subject: [R-sig-Geo] geonames API for R
Message-ID: <d8ad40b50810160454l696feac6l11a574662a630c17@mail.gmail.com>

After the initial query about finding timezones in R, I've gone mad
and written an entire package for querying all of (well, most of)
geonames.org.

It's hosted on R-Forge:

http://geonames.r-forge.r-project.org/

and recently submitted to CRAN. Install from the R-forge repo with:

install.packages("geonames",repos="http://R-Forge.R-project.org")

if anyone else wants to help develop it, get an R-forge account and
I'll add you in.



From edzer.pebesma at uni-muenster.de  Thu Oct 16 14:34:31 2008
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 16 Oct 2008 14:34:31 +0200
Subject: [R-sig-Geo] geonames API for R
In-Reply-To: <d8ad40b50810160454l696feac6l11a574662a630c17@mail.gmail.com>
References: <d8ad40b50810160454l696feac6l11a574662a630c17@mail.gmail.com>
Message-ID: <48F734D7.9070504@uni-muenster.de>

Looks great, Barry.

I think to show the potential and to seduce people to start using this, 
it would be very valuable to add a few examples, preferably one for each 
of the items in http://www.geonames.org/export/ws-overview.html , or 
just the most dissimilar ones.

Right now you assume that users can figure out how to form requests by 
looking at the above link alone. I, for instance, couldn't.
--
Edzer

Barry Rowlingson wrote:
> After the initial query about finding timezones in R, I've gone mad
> and written an entire package for querying all of (well, most of)
> geonames.org.
>
> It's hosted on R-Forge:
>
> http://geonames.r-forge.r-project.org/
>
> and recently submitted to CRAN. Install from the R-forge repo with:
>
> install.packages("geonames",repos="http://R-Forge.R-project.org")
>
> if anyone else wants to help develop it, get an R-forge account and
> I'll add you in.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster,
Weseler Stra?e 253, 48151 M?nster, Germany.  Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de/
http://www.springer.com/978-0-387-78170-9  e.pebesma at wwu.de



From Yvan.Lebras at rennes.inra.fr  Thu Oct 16 15:18:14 2008
From: Yvan.Lebras at rennes.inra.fr (Yvan Le Bras)
Date: Thu, 16 Oct 2008 15:18:14 +0200
Subject: [R-sig-Geo] problem to convert gshhs to shapefile with R
Message-ID: <48F73F16.1080909@rennes.inra.fr>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081016/f05e827c/attachment.pl>

From Roger.Bivand at nhh.no  Thu Oct 16 20:55:02 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 16 Oct 2008 20:55:02 +0200 (CEST)
Subject: [R-sig-Geo] problem to convert gshhs to shapefile with R
In-Reply-To: <48F73F16.1080909@rennes.inra.fr>
References: <48F73F16.1080909@rennes.inra.fr>
Message-ID: <Pine.LNX.4.64.0810162047130.4768@reclus.nhh.no>

On Thu, 16 Oct 2008, Yvan Le Bras wrote:

> Good afternoon. Excuse I for getting bored. I need to work with
> shapefile and I thank that was easy to convert gshhs to shapefile but
> since 2 weeks I tried without any success. Can you help me? I'd success
> to import gshhs file with importGSHHS from PBSmapping and Rgshhs from
> maptools but I don't succeed to convert gshhs to a shapefile. The
> problem seems to be that my gshhs object is a List object with Rgshhs,

... so it would make sense to read the documentation (and/or the code) of 
Rgshhs(). There you find that the function returns a list, with a 
component called SP. Look in the examples to see exactly how this works. 
All the other components are intermediate objects possibly needed for 
debugging the running of the function, which is vulerable to changes in 
versions of GSHHS.

The output objects are either SpatialPolygons or SpatialLines objects, 
which need to be complemented with a data frame with at least one 
variable, and with row.names identical to the Lines or Polygons objects' 
ID slots, to make Spatial*DataFrame objects, which can then be exported as 
shapefiles.

It is always a good idea not to "think" too much, but rather to read the 
documentation and in particular study the examples provided.

Roger

> so I can't convert this file in Map object or anything else, and with
> importGSHHS, an error appeared (in validityMethod (object) :
> Geographical CRS given to non-conformant data) when I try to convert
> this file in Spatial Polygons. In fact I thank use Rgshhs to convert my
> gshhs file in SP object, then SP2MAP to convert SP in Map object, then
> MAP2POLY to convert in polylist object to endly use WRITEPOLYLISTSHAPE
> to convert in shapefile my map object and my polylist.... Can you help
> me to convert my gshhs in shapefile? When I saw the pdf for maptools
> tuto, I thank to have found the manner to make this because of th texte
> write for the Rgshhs function who said this function was use to convert
> SP to shapefile for example. I whisper you can help me, and am sorry for
> the approximative english and the disturbance. In wishing you a good end
> of week. Best regards,
>
>
>
> Yvan Le Bras
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From alessandro.montaghi at unifi.it  Fri Oct 17 01:27:20 2008
From: alessandro.montaghi at unifi.it (Alessandro)
Date: Thu, 16 Oct 2008 16:27:20 -0700
Subject: [R-sig-Geo] suggestion to write a more elegant code
Message-ID: <002701c92fe6$bd09a800$371cf800$@montaghi@unifi.it>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081016/d7470b3f/attachment.pl>

From brenning at uwaterloo.ca  Fri Oct 17 02:01:18 2008
From: brenning at uwaterloo.ca (Alexander Brenning)
Date: Thu, 16 Oct 2008 20:01:18 -0400
Subject: [R-sig-Geo] suggestion to write a more elegant code
In-Reply-To: <002701c92fe6$bd09a800$371cf800$@montaghi@unifi.it>
References: <002701c92fe6$bd09a800$371cf800$@montaghi@unifi.it>
Message-ID: <48F7D5CE.3000708@uwaterloo.ca>

Hi,

first, your formulas should read ~a^1.4 etc.; 'a' represents the first 
(and in your case only) grid in in.grids.

Instead of using a formula, you can use a character string:
   formula = "a^1.5" etc.,
so you just have to 'paste' things together; this should work:

for (pow in seq(1.5, 4.0, by = 0.1))
     rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),
          out.grid = "DCM_1_power15.sgrd",
          formula = paste("a^", pow, sep=""))

Cheers
  Alex



Alessandro wrote:
> Hi all,
> 
>  
> 
> I need a suggestion to write this code in R more elegant . I have a  DSM
> grid and I need to create a different grid raisin to different power.
> 
>  
> 
>  
> 
> Thanx Ale
> 
>  
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power15.sgrd", formula = ~^1.5)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power16.sgrd", formula = ~^1.6)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power17.sgrd", formula = ~^1.7)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power18.sgrd", formula = ~^1.8)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power19.sgrd", formula = ~^1.9)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power15.sgrd", formula = ~^2.0)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power20.sgrd", formula = ~^2.1)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power15.sgrd", formula = ~^2.2)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power15.sgrd", formula = ~^2.3)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power15.sgrd", formula = ~^2.4)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power15.sgrd", formula = ~^2.5)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power15.sgrd", formula = ~^1.6)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power15.sgrd", formula = ~^2.7)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power15.sgrd", formula = ~^2.8)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power15.sgrd", formula = ~^2.9)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power15.sgrd", formula = ~^3.0)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power15.sgrd", formula = ~^3.1)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power15.sgrd", formula = ~^3.2)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power15.sgrd", formula = ~^3.3)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power15.sgrd", formula = ~^3.4)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power15.sgrd", formula = ~^3.5)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power15.sgrd", formula = ~^3.6)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power15.sgrd", formula = ~^3.7)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power15.sgrd", formula = ~^3.8)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power15.sgrd", formula = ~^3.9)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power15.sgrd", formula = ~^4.0)
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 

-- 
Alexander Brenning
brenning at uwaterloo.ca - T +1-519-888-4567 ext 35783
Department of Geography and Environmental Management
University of Waterloo
200 University Ave. W - Waterloo, ON - Canada N2L 3G1
http://www.fes.uwaterloo.ca/geography/faculty/brenning/



From alessandro.montaghi at unifi.it  Fri Oct 17 02:56:05 2008
From: alessandro.montaghi at unifi.it (Alessandro)
Date: Thu, 16 Oct 2008 17:56:05 -0700
Subject: [R-sig-Geo] R:  suggestion to write a more elegant code
In-Reply-To: <48F7D5CE.3000708@uwaterloo.ca>
References: <002701c92fe6$bd09a800$371cf800$@montaghi@unifi.it>
	<48F7D5CE.3000708@uwaterloo.ca>
Message-ID: <003d01c92ff3$238b7430$6aa25c90$@montaghi@unifi.it>

Hi Thanx Alex and Mike

SORRY I am a brand-new

I tried this formula


for (pow in seq(1.5, 4.0, by = 0.1))
     rsaga.grid.calculus(in.grids = c("DCM_1.sgrd"),
          out.grid = "DCM_1_power15.sgrd",
          formula = paste("a^", pow, sep=""))

but the code create only one raster (DCM_1_power15.sgrd)

with this formula I have this error

power<- seq(1.5, 4.0, by=0.1)
for (i in 1:length(power)){
rsaga.grid.calculus(in.grids = c("DCM_1.sgrd"),out.grid
=paste("DCM_1_power"power[i]*10,".sgrd",sep=""), formula = ~^power[i])
}

ERROR message


power<- seq(1.5, 4.0, by=0.1)
> for (i in 1:length(power)){
+ rsaga.grid.calculus(in.grids = c("DCM_1.sgrd"),out.grid
=paste("DCM_1_power"power[i]*10,".sgrd",sep=""), formula = ~^power[i])
Errore: unexpected symbol in:
"for (i in 1:length(power)){
rsaga.grid.calculus(in.grids = c("DCM_1.sgrd"),out.grid
=paste("DCM_1_power"power"
> }
Errore: unexpected '}' in "}"
> 
>



-----Messaggio originale-----
Da: Alexander Brenning [mailto:brenning at uwaterloo.ca] 
Inviato: gioved? 16 ottobre 2008 17.01
A: Alessandro
Cc: r-sig-geo at stat.math.ethz.ch
Oggetto: Re: [R-sig-Geo] suggestion to write a more elegant code

Hi,

first, your formulas should read ~a^1.4 etc.; 'a' represents the first 
(and in your case only) grid in in.grids.

Instead of using a formula, you can use a character string:
   formula = "a^1.5" etc.,
so you just have to 'paste' things together; this should work:

for (pow in seq(1.5, 4.0, by = 0.1))
     rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),
          out.grid = "DCM_1_power15.sgrd",
          formula = paste("a^", pow, sep=""))

Cheers
  Alex



Alessandro wrote:
> Hi all,
> 
>  
> 
> I need a suggestion to write this code in R more elegant . I have a  DSM
> grid and I need to create a different grid raisin to different power.
> 
>  
> 
>  
> 
> Thanx Ale
> 
>  
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power15.sgrd", formula = ~^1.5)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power16.sgrd", formula = ~^1.6)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power17.sgrd", formula = ~^1.7)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power18.sgrd", formula = ~^1.8)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power19.sgrd", formula = ~^1.9)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power15.sgrd", formula = ~^2.0)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power20.sgrd", formula = ~^2.1)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power15.sgrd", formula = ~^2.2)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power15.sgrd", formula = ~^2.3)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power15.sgrd", formula = ~^2.4)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power15.sgrd", formula = ~^2.5)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power15.sgrd", formula = ~^1.6)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power15.sgrd", formula = ~^2.7)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power15.sgrd", formula = ~^2.8)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power15.sgrd", formula = ~^2.9)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power15.sgrd", formula = ~^3.0)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power15.sgrd", formula = ~^3.1)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power15.sgrd", formula = ~^3.2)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power15.sgrd", formula = ~^3.3)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power15.sgrd", formula = ~^3.4)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power15.sgrd", formula = ~^3.5)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power15.sgrd", formula = ~^3.6)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power15.sgrd", formula = ~^3.7)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power15.sgrd", formula = ~^3.8)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power15.sgrd", formula = ~^3.9)
> 
> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
> "DCM_1_power15.sgrd", formula = ~^4.0)
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 

-- 
Alexander Brenning
brenning at uwaterloo.ca - T +1-519-888-4567 ext 35783
Department of Geography and Environmental Management
University of Waterloo
200 University Ave. W - Waterloo, ON - Canada N2L 3G1
http://www.fes.uwaterloo.ca/geography/faculty/brenning/



From brenning at uwaterloo.ca  Fri Oct 17 03:17:10 2008
From: brenning at uwaterloo.ca (Alexander Brenning)
Date: Thu, 16 Oct 2008 21:17:10 -0400
Subject: [R-sig-Geo] R:  suggestion to write a more elegant code
In-Reply-To: <003d01c92ff3$238b7430$6aa25c90$@montaghi@unifi.it>
References: <002701c92fe6$bd09a800$371cf800$@montaghi@unifi.it>
	<48F7D5CE.3000708@uwaterloo.ca>
	<003d01c92ff3$238b7430$6aa25c90$@montaghi@unifi.it>
Message-ID: <48F7E796.7060704@uwaterloo.ca>

how about this...

power<- seq(1.5, 4.0, by=0.1)
for (i in 1:length(power)){
     rsaga.grid.calculus(in.grids = c("DCM_1.sgrd"),
           out.grid = paste("DCM_1_power",i,".sgrd",sep=""),
           formula = paste("a^",power[i],sep=""))
}




Alessandro wrote:
> Hi Thanx Alex and Mike
> 
> SORRY I am a brand-new
> 
> I tried this formula
> 
> 
> for (pow in seq(1.5, 4.0, by = 0.1))
>      rsaga.grid.calculus(in.grids = c("DCM_1.sgrd"),
>           out.grid = "DCM_1_power15.sgrd",
>           formula = paste("a^", pow, sep=""))
> 
> but the code create only one raster (DCM_1_power15.sgrd)
> 
> with this formula I have this error
> 
> power<- seq(1.5, 4.0, by=0.1)
> for (i in 1:length(power)){
> rsaga.grid.calculus(in.grids = c("DCM_1.sgrd"),out.grid
> =paste("DCM_1_power"power[i]*10,".sgrd",sep=""), formula = ~^power[i])
> }
> 
> ERROR message
> 
> 
> power<- seq(1.5, 4.0, by=0.1)
>> for (i in 1:length(power)){
> + rsaga.grid.calculus(in.grids = c("DCM_1.sgrd"),out.grid
> =paste("DCM_1_power"power[i]*10,".sgrd",sep=""), formula = ~^power[i])
> Errore: unexpected symbol in:
> "for (i in 1:length(power)){
> rsaga.grid.calculus(in.grids = c("DCM_1.sgrd"),out.grid
> =paste("DCM_1_power"power"
>> }
> Errore: unexpected '}' in "}"
>>
> 
> 
> 
> -----Messaggio originale-----
> Da: Alexander Brenning [mailto:brenning at uwaterloo.ca] 
> Inviato: gioved? 16 ottobre 2008 17.01
> A: Alessandro
> Cc: r-sig-geo at stat.math.ethz.ch
> Oggetto: Re: [R-sig-Geo] suggestion to write a more elegant code
> 
> Hi,
> 
> first, your formulas should read ~a^1.4 etc.; 'a' represents the first 
> (and in your case only) grid in in.grids.
> 
> Instead of using a formula, you can use a character string:
>    formula = "a^1.5" etc.,
> so you just have to 'paste' things together; this should work:
> 
> for (pow in seq(1.5, 4.0, by = 0.1))
>      rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),
>           out.grid = "DCM_1_power15.sgrd",
>           formula = paste("a^", pow, sep=""))
> 
> Cheers
>   Alex
> 
> 
> 
> Alessandro wrote:
>> Hi all,
>>
>>  
>>
>> I need a suggestion to write this code in R more elegant . I have a  DSM
>> grid and I need to create a different grid raisin to different power.
>>
>>  
>>
>>  
>>
>> Thanx Ale
>>
>>  
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power15.sgrd", formula = ~^1.5)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power16.sgrd", formula = ~^1.6)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power17.sgrd", formula = ~^1.7)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power18.sgrd", formula = ~^1.8)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power19.sgrd", formula = ~^1.9)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power15.sgrd", formula = ~^2.0)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power20.sgrd", formula = ~^2.1)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power15.sgrd", formula = ~^2.2)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power15.sgrd", formula = ~^2.3)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power15.sgrd", formula = ~^2.4)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power15.sgrd", formula = ~^2.5)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power15.sgrd", formula = ~^1.6)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power15.sgrd", formula = ~^2.7)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power15.sgrd", formula = ~^2.8)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power15.sgrd", formula = ~^2.9)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power15.sgrd", formula = ~^3.0)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power15.sgrd", formula = ~^3.1)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power15.sgrd", formula = ~^3.2)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power15.sgrd", formula = ~^3.3)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power15.sgrd", formula = ~^3.4)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power15.sgrd", formula = ~^3.5)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power15.sgrd", formula = ~^3.6)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power15.sgrd", formula = ~^3.7)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power15.sgrd", formula = ~^3.8)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power15.sgrd", formula = ~^3.9)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power15.sgrd", formula = ~^4.0)
>>
>>
>> 	[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
> 

-- 
Alexander Brenning
brenning at uwaterloo.ca - T +1-519-888-4567 ext 35783
Department of Geography and Environmental Management
University of Waterloo
200 University Ave. W - Waterloo, ON - Canada N2L 3G1
http://www.fes.uwaterloo.ca/geography/faculty/brenning/



From alessandro.montaghi at unifi.it  Fri Oct 17 03:23:13 2008
From: alessandro.montaghi at unifi.it (Alessandro)
Date: Thu, 16 Oct 2008 18:23:13 -0700
Subject: [R-sig-Geo] R: R:  suggestion to write a more elegant code
In-Reply-To: <48F7E796.7060704@uwaterloo.ca>
References: <002701c92fe6$bd09a800$371cf800$@montaghi@unifi.it>
	<48F7D5CE.3000708@uwaterloo.ca>
	<003d01c92ff3$238b7430$6aa25c90$@montaghi@unifi.it>
	<48F7E796.7060704@uwaterloo.ca>
Message-ID: <004101c92ff6$ed65c5a0$c83150e0$@montaghi@unifi.it>

It's Run


power<- seq(1.5, 4.0, by=0.1)
for (i in 1:length(power)){
     rsaga.grid.calculus(in.grids = c("DCM_1.sgrd"),
           out.grid = paste("DCM_1_power",i,".sgrd",sep=""),
           formula = paste("a^",power[i],sep="")) }

BUT...........

the only fix is create files with name DCM_1_power15.sgrd,
DCM_1_power1.6.sgrd, etc. etc.
because the code creates files like this: DCM_1_power1.sgrd,
DCM_1_power2.sgrd, etc. etc.

Alex

-----Messaggio originale-----
Da: Alexander Brenning [mailto:brenning at uwaterloo.ca] 
Inviato: gioved? 16 ottobre 2008 18.17
A: Alessandro
Cc: r-sig-geo at stat.math.ethz.ch
Oggetto: Re: R: [R-sig-Geo] suggestion to write a more elegant code

how about this...

power<- seq(1.5, 4.0, by=0.1)
for (i in 1:length(power)){
     rsaga.grid.calculus(in.grids = c("DCM_1.sgrd"),
           out.grid = paste("DCM_1_power",i,".sgrd",sep=""),
           formula = paste("a^",power[i],sep=""))
}




Alessandro wrote:
> Hi Thanx Alex and Mike
> 
> SORRY I am a brand-new
> 
> I tried this formula
> 
> 
> for (pow in seq(1.5, 4.0, by = 0.1))
>      rsaga.grid.calculus(in.grids = c("DCM_1.sgrd"),
>           out.grid = "DCM_1_power15.sgrd",
>           formula = paste("a^", pow, sep=""))
> 
> but the code create only one raster (DCM_1_power15.sgrd)
> 
> with this formula I have this error
> 
> power<- seq(1.5, 4.0, by=0.1)
> for (i in 1:length(power)){
> rsaga.grid.calculus(in.grids = c("DCM_1.sgrd"),out.grid
> =paste("DCM_1_power"power[i]*10,".sgrd",sep=""), formula = ~^power[i])
> }
> 
> ERROR message
> 
> 
> power<- seq(1.5, 4.0, by=0.1)
>> for (i in 1:length(power)){
> + rsaga.grid.calculus(in.grids = c("DCM_1.sgrd"),out.grid
> =paste("DCM_1_power"power[i]*10,".sgrd",sep=""), formula = ~^power[i])
> Errore: unexpected symbol in:
> "for (i in 1:length(power)){
> rsaga.grid.calculus(in.grids = c("DCM_1.sgrd"),out.grid
> =paste("DCM_1_power"power"
>> }
> Errore: unexpected '}' in "}"
>>
> 
> 
> 
> -----Messaggio originale-----
> Da: Alexander Brenning [mailto:brenning at uwaterloo.ca] 
> Inviato: gioved? 16 ottobre 2008 17.01
> A: Alessandro
> Cc: r-sig-geo at stat.math.ethz.ch
> Oggetto: Re: [R-sig-Geo] suggestion to write a more elegant code
> 
> Hi,
> 
> first, your formulas should read ~a^1.4 etc.; 'a' represents the first 
> (and in your case only) grid in in.grids.
> 
> Instead of using a formula, you can use a character string:
>    formula = "a^1.5" etc.,
> so you just have to 'paste' things together; this should work:
> 
> for (pow in seq(1.5, 4.0, by = 0.1))
>      rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),
>           out.grid = "DCM_1_power15.sgrd",
>           formula = paste("a^", pow, sep=""))
> 
> Cheers
>   Alex
> 
> 
> 
> Alessandro wrote:
>> Hi all,
>>
>>  
>>
>> I need a suggestion to write this code in R more elegant . I have a  DSM
>> grid and I need to create a different grid raisin to different power.
>>
>>  
>>
>>  
>>
>> Thanx Ale
>>
>>  
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power15.sgrd", formula = ~^1.5)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power16.sgrd", formula = ~^1.6)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power17.sgrd", formula = ~^1.7)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power18.sgrd", formula = ~^1.8)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power19.sgrd", formula = ~^1.9)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power15.sgrd", formula = ~^2.0)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power20.sgrd", formula = ~^2.1)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power15.sgrd", formula = ~^2.2)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power15.sgrd", formula = ~^2.3)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power15.sgrd", formula = ~^2.4)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power15.sgrd", formula = ~^2.5)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power15.sgrd", formula = ~^1.6)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power15.sgrd", formula = ~^2.7)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power15.sgrd", formula = ~^2.8)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power15.sgrd", formula = ~^2.9)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power15.sgrd", formula = ~^3.0)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power15.sgrd", formula = ~^3.1)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power15.sgrd", formula = ~^3.2)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power15.sgrd", formula = ~^3.3)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power15.sgrd", formula = ~^3.4)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power15.sgrd", formula = ~^3.5)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power15.sgrd", formula = ~^3.6)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power15.sgrd", formula = ~^3.7)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power15.sgrd", formula = ~^3.8)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power15.sgrd", formula = ~^3.9)
>>
>> rsaga.grid.calculus(in.grids = c("DSM_1.sgrd"),out.grid =
>> "DCM_1_power15.sgrd", formula = ~^4.0)
>>
>>
>> 	[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
> 

-- 
Alexander Brenning
brenning at uwaterloo.ca - T +1-519-888-4567 ext 35783
Department of Geography and Environmental Management
University of Waterloo
200 University Ave. W - Waterloo, ON - Canada N2L 3G1
http://www.fes.uwaterloo.ca/geography/faculty/brenning/



From jnylen+rgeo at gmail.com  Fri Oct 17 05:33:06 2008
From: jnylen+rgeo at gmail.com (James Nylen)
Date: Thu, 16 Oct 2008 22:33:06 -0500
Subject: [R-sig-Geo] R: R: suggestion to write a more elegant code
In-Reply-To: <-8861359744041991227@unknownmsgid>
References: <48F7D5CE.3000708@uwaterloo.ca> <48F7E796.7060704@uwaterloo.ca>
	<-8861359744041991227@unknownmsgid>
Message-ID: <205a4c310810162033n7950231bjb4b05f45cd8eaf0b@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081016/46d22f2a/attachment.pl>

From spluque at gmail.com  Sun Oct 19 03:14:47 2008
From: spluque at gmail.com (Sebastian P. Luque)
Date: Sat, 18 Oct 2008 20:14:47 -0500
Subject: [R-sig-Geo] staying up to date with r-spatial packages
Message-ID: <874p39tmgo.fsf@patagonia.sebmags.homelinux.org>

Hi,

Is it a good idea to have the r-spatial repository added to the 'repos'
option?  e.g.:

---<---------------cut here---------------start-------------->---
    options(repos=c(CRAN="http://probability.ca/cran/",
              Spatial="http://r-spatial.sourceforge.net/R"))
}
---<---------------cut here---------------end---------------->---

My only concern is that some packages would eventually make it into
CRAN, but I don't know what would happen to the r-spatial version in
that case.  Any thoughts?  Thanks.


Cheers,

-- 
Seb
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 196 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081018/1c0b0fc9/attachment.bin>

From Roger.Bivand at nhh.no  Sun Oct 19 13:20:36 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sun, 19 Oct 2008 13:20:36 +0200 (CEST)
Subject: [R-sig-Geo] staying up to date with r-spatial packages
In-Reply-To: <874p39tmgo.fsf@patagonia.sebmags.homelinux.org>
References: <874p39tmgo.fsf@patagonia.sebmags.homelinux.org>
Message-ID: <Pine.LNX.4.64.0810191313510.10533@reclus.nhh.no>

On Sat, 18 Oct 2008, Sebastian P. Luque wrote:

> Hi,
>
> Is it a good idea to have the r-spatial repository added to the 'repos'
> option?  e.g.:
>
> ---<---------------cut here---------------start-------------->---
>    options(repos=c(CRAN="http://probability.ca/cran/",
>              Spatial="http://r-spatial.sourceforge.net/R"))
> }
> ---<---------------cut here---------------end---------------->---
>
> My only concern is that some packages would eventually make it into
> CRAN, but I don't know what would happen to the r-spatial version in
> that case.  Any thoughts?  Thanks.
>

Definitely not, and we should probably take down that infrastructure. 
Since mid 2006, nothing has been released there and not on CRAN, so the 
contents are now very out of date.

While sp was changing rapidly, it made sense to limit consequences for 
packages depending on sp to that repository, but with the incorporation of 
most content into rgdal and maptools, this isn't needed any more.

Bleeding edge things can be handled if needed by checking revised source 
packages out from CVS - this occasionally happens with rgdal (different 
sourceforge project). The infrastructure on R-Forge is arguably better for 
R projects; for example, I've moved the spdep source repository from 
sourceforge CVS to R-Forge SVN.

Roger

>
> Cheers,
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From rroa at udec.cl  Mon Oct 20 01:11:48 2008
From: rroa at udec.cl (=?ISO-8859-1?Q?Rub=E9n_Roa-Ureta?=)
Date: Sun, 19 Oct 2008 20:11:48 -0300
Subject: [R-sig-Geo] Problem with points.geodata and plot.geodata
Message-ID: <48FBBEB4.6040808@udec.cl>

Hi ComRades,

The functions points.geoadata and plot.geodata have an underisable 
behavior with the limits of the X axis of the plot, as shown by the toy 
example below. The range covered by the X axis is too wide. Setting 
specific limits with xlim in, for example points.geoadata, doesn't solve 
the problem.
Does anybody knows of a solution or a way around this feature.
Thanks
Rub?n

x <- runif(100,100,200)
y <- runif(length(x),1000,2000)
z <- rnorm(length(x),50,15)
a <- sample(c(1,2),length(x),replace=TRUE)
Q <- data.frame(cbind(x,y,z,a))
z1 <- subset(Q,a==1,select=c(x,y,z))
library(geoR)
#Loading required package: sp
#
#-------------------------------------------------------------
#Analysis of geostatistical data
#For an Introduction to geoR go to http://www.leg.ufpr.br/geoR
#geoR version 1.6-22 (built on 2008-10-08) is now loaded
#-------------------------------------------------------------
z1 <- as.geodata(z1)
plot(z1)
points(z1,pt.divide=c("data.proportional"),lambda=1,col="gray",yl="",xl="")



From b.rowlingson at lancaster.ac.uk  Mon Oct 20 08:35:40 2008
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Mon, 20 Oct 2008 07:35:40 +0100
Subject: [R-sig-Geo] Problem with points.geodata and plot.geodata
In-Reply-To: <48FBBEB4.6040808@udec.cl>
References: <48FBBEB4.6040808@udec.cl>
Message-ID: <d8ad40b50810192335t4be4803dg57db67c2fad46800@mail.gmail.com>

2008/10/20 Rub?n Roa-Ureta <rroa at udec.cl>:
> Hi ComRades,
>
> The functions points.geoadata and plot.geodata have an underisable behavior
> with the limits of the X axis of the plot, as shown by the toy example
> below. The range covered by the X axis is too wide. Setting specific limits
> with xlim in, for example points.geoadata, doesn't solve the problem.
> Does anybody knows of a solution or a way around this feature.

When plotting spatial data it is desirable to see the points as they
would look on a map. Your data has a small X-range compared to it's
Y-range, and so when you plot it as spatial data it is laid out on a
thin, tall rectangle. This is how it would look on a map with regular
cartesian coordinates.

 If you plot something in R that isn't spatial data then R stretches
one axis to fill the space. This is the right thing to do if you don't
have a spatial relationship between the axes, such as when plotting
age against weight.

 Note that keeping this 1:1 ratio of X to Y axes (the 'aspect ratio')
for spatial data means that distances between points are preserved.
This is generally important for spatial data since your concern is
often distances and relationships to other points. If you stretched
the plot out then you would make points above and below point M closer
than points left and right.

 If you really want to plot this data in a filled square manner, just
get the coordinates and plot:

 > plot(z1$coords)

 you can control the aspect ratio of a plot with the asp option (see help(par))

 > plot(z$coords,asp=1)

 - reproduces the aspect ratio of the default geodata and sp plotting.

Barry



From gledson.picharski at yahoo.com.br  Mon Oct 20 08:47:02 2008
From: gledson.picharski at yahoo.com.br (Gledson Picharski)
Date: Sun, 19 Oct 2008 23:47:02 -0700 (PDT)
Subject: [R-sig-Geo] Res:  Problem with points.geodata and plot.geodata
Message-ID: <99768.98764.qm@web63107.mail.re1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081019/773f2f5d/attachment.pl>

From patrick.giraudoux at univ-fcomte.fr  Mon Oct 20 11:38:28 2008
From: patrick.giraudoux at univ-fcomte.fr (Patrick Giraudoux)
Date: Mon, 20 Oct 2008 11:38:28 +0200
Subject: [R-sig-Geo] spsample and small sample size
Message-ID: <48FC5194.8040205@univ-fcomte.fr>

Dear listers,

I met a trouble with spsample which has been solved by Roger Bivand off 
list. I though it was general enough to be of interest for other users. 
In brief I needed to get 50 random points on a SpatialLinesDataFrame 
called "hydntline" and got:

spsample(hydntline,50,type="random")
Error in function (classes, fdef, mtable)  :
unable to find an inherited method for function "coordinates", for 
signature "numeric"

Roger's response is the following:

The reason is that some lines are assigned no sample points, and the 
function tries to create a SpatialPoints object with no points. The 
workaround is to increase n, then reduce the output by sampling back down.

z <- spsample(hydntline,4000,type="random")
zz <- z[sample(nrow(coordinates(z)), 50)]
plot(hydntline, axes=TRUE)
points(zz, pch=3)


-------------- next part --------------
A non-text attachment was scrubbed...
Name: patrick_giraudoux.vcf
Type: text/x-vcard
Size: 399 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081020/51209072/attachment.vcf>

From rroa at udec.cl  Mon Oct 20 16:05:47 2008
From: rroa at udec.cl (=?ISO-8859-1?Q?Rub=E9n_Roa-Ureta?=)
Date: Mon, 20 Oct 2008 11:05:47 -0300
Subject: [R-sig-Geo] Res:  Problem with points.geodata and plot.geodata
In-Reply-To: <99768.98764.qm@web63107.mail.re1.yahoo.com>
References: <99768.98764.qm@web63107.mail.re1.yahoo.com>
Message-ID: <48FC903B.6030601@udec.cl>

Gledson Picharski wrote:
> Hi Rub??n,
>
> Try this,
>
> my.func <- set.coords.lims #if you want this geoR function latter.
> set.coords.lims <-function(coords)apply(coords,2,range) 
> plot(z1)
> points(z1,pt.divide=c("data.proportional"),lambda=1,col="gray",yl="",xl="")
>
> ## to get set.coords.lims back.
> set.coords.lims <- my.func
> plot(z1)
>
>  
>
> ______________________
> Gledson Luiz Pichasrki
> PET Estat??stica - UFPR
> http://www.leg.ufpr.br/~gledson
> http://www.leg.ufpr.br/pet
>
>
>
>
> ----- Mensagem original ----
> De: Rub??n Roa-Ureta <rroa at udec.cl>
> Para: r-sig-geo at stat.math.ethz.ch
> Enviadas: Domingo, 19 de Outubro de 2008 21:11:48
> Assunto: [R-sig-Geo] Problem with points.geodata and plot.geodata
>
> Hi ComRades,
>
> The functions points.geoadata and plot.geodata have an underisable 
> behavior with the limits of the X axis of the plot, as shown by the toy 
> example below. The range covered by the X axis is too wide. Setting 
> specific limits with xlim in, for example points.geoadata, doesn't solve 
> the problem.
> Does anybody knows of a solution or a way around this feature.
> Thanks
> Rub??n
>
> x <- runif(100,100,200)
> y <- runif(length(x),1000,2000)
> z <- rnorm(length(x),50,15)
> a <- sample(c(1,2),length(x),replace=TRUE)
> Q <- data.frame(cbind(x,y,z,a))
> z1 <- subset(Q,a==1,select=c(x,y,z))
> library(geoR)
> #Loading required package: sp
> #
> #-------------------------------------------------------------
> #Analysis of geostatistical data
> #For an Introduction to geoR go to http://www.leg.ufpr.br/geoR
> #geoR version 1.6-22 (built on 2008-10-08) is now loaded
> #-------------------------------------------------------------
> z1 <- as.geodata(z1)
> plot(z1)
> points(z1,pt.divide=c("data.proportional"),lambda=1,col="gray",yl="",xl="")
>   
Thanks Gledson. Your fuction method works for plot.geodata and 
points.geodata. I also wanted to make it work with image.kriging but it 
doesn't.
My general idea is that a good representation of model fit to data in 
the case of a geostatistical model is a two-panel plot showing the 
observation points on one panel (with size or color or both proportional 
to the magnitude of the spatial variable) and the spatial prediction by 
kriging with the fitted model on the other panel (like my Fig. 4 in ICES 
Journal of Marine Science 64:1723, 2007), but this presentation has 
problems when the spatial sample layout is elongated because it makes 
too much blank space, for the good reasons explained by Barry.
Rub?n



From jnylen+rgeo at gmail.com  Mon Oct 20 17:06:18 2008
From: jnylen+rgeo at gmail.com (James Nylen)
Date: Mon, 20 Oct 2008 10:06:18 -0500
Subject: [R-sig-Geo] Res: Problem with points.geodata and plot.geodata
In-Reply-To: <48FC903B.6030601@udec.cl>
References: <99768.98764.qm@web63107.mail.re1.yahoo.com>
	<48FC903B.6030601@udec.cl>
Message-ID: <205a4c310810200806n4e6baa95q6592c14609a23628@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081020/1b971266/attachment.pl>

From alessandro.montaghi at unifi.it  Mon Oct 20 20:01:24 2008
From: alessandro.montaghi at unifi.it (Alessandro)
Date: Mon, 20 Oct 2008 11:01:24 -0700
Subject: [R-sig-Geo] help to Improve "elegant" code
Message-ID: <000701c932dd$deb22d70$9c168850$@montaghi@unifi.it>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081020/76943853/attachment.pl>

From jnylen+rgeo at gmail.com  Mon Oct 20 22:46:16 2008
From: jnylen+rgeo at gmail.com (James Nylen)
Date: Mon, 20 Oct 2008 15:46:16 -0500
Subject: [R-sig-Geo] help to Improve "elegant" code
In-Reply-To: <1096423596925383140@unknownmsgid>
References: <1096423596925383140@unknownmsgid>
Message-ID: <205a4c310810201346g42346314s9fe76e0299cea31e@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081020/6f70918e/attachment.pl>

From saldanha.plangeo at gmail.com  Tue Oct 21 01:06:03 2008
From: saldanha.plangeo at gmail.com (Raphael Saldanha)
Date: Mon, 20 Oct 2008 22:06:03 -0100
Subject: [R-sig-Geo] Spatial Weights
Message-ID: <c85849370810201606g2c3f391al888bab2488ca9099@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081020/6a61cb06/attachment.pl>

From Roger.Bivand at nhh.no  Tue Oct 21 08:29:03 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 21 Oct 2008 08:29:03 +0200 (CEST)
Subject: [R-sig-Geo] Spatial Weights
In-Reply-To: <c85849370810201606g2c3f391al888bab2488ca9099@mail.gmail.com>
References: <c85849370810201606g2c3f391al888bab2488ca9099@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0810210825470.24325@reclus.nhh.no>

On Mon, 20 Oct 2008, Raphael Saldanha wrote:

> Hi!
> Can I create queen or rook spatial weights with R?

Yes, see ?poly2nb in spdep.

>
> I'm migrating from Geoda to R, is there any good introductory text for basic
> functions of spatial econometrics with R ?
>

See Luc Anselin's tutorials:

http://www.sal.uiuc.edu/stuff/stuff-sum/tutorials

for a GeoDa-flavoured introduction.

Hope this helps,

Roger

> Best regards,
>
> Raphael Saldanha
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Mikael.Carlsson at sgu.se  Tue Oct 21 10:16:28 2008
From: Mikael.Carlsson at sgu.se (Mikael Carlsson)
Date: Tue, 21 Oct 2008 10:16:28 +0200
Subject: [R-sig-Geo] Memory problems
Message-ID: <OFF8B2A85E.1A580363-ONC12574E9.002D4E02-C12574E9.002D7E98@sgu.se>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081021/6336af61/attachment.pl>

From Roger.Bivand at nhh.no  Tue Oct 21 10:23:54 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 21 Oct 2008 10:23:54 +0200 (CEST)
Subject: [R-sig-Geo] Memory problems
In-Reply-To: <OFF8B2A85E.1A580363-ONC12574E9.002D4E02-C12574E9.002D7E98@sgu.se>
References: <OFF8B2A85E.1A580363-ONC12574E9.002D4E02-C12574E9.002D7E98@sgu.se>
Message-ID: <Pine.LNX.4.64.0810211020190.24325@reclus.nhh.no>

On Tue, 21 Oct 2008, Mikael Carlsson wrote:

> Hi!
>
> I got the following
>
> The instruction at "0x0000002c" referenced memory at "0x0000002c". The
> memory could not be "read"
>

Please read the posting guide

http://www.r-project.org/posting-guide.html

then document your problem adequately with sessionInfo() and a 
reproducible example, and consider reposting. This tells us absolutely 
nothing!

>
> Any clue?
>
> Regards,
> Mikael
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From p.hiemstra at geo.uu.nl  Tue Oct 21 10:21:37 2008
From: p.hiemstra at geo.uu.nl (Paul Hiemstra)
Date: Tue, 21 Oct 2008 10:21:37 +0200
Subject: [R-sig-Geo] Memory problems
In-Reply-To: <OFF8B2A85E.1A580363-ONC12574E9.002D4E02-C12574E9.002D7E98@sgu.se>
References: <OFF8B2A85E.1A580363-ONC12574E9.002D4E02-C12574E9.002D7E98@sgu.se>
Message-ID: <48FD9111.8020907@geo.uu.nl>

Hi,

Please read the posting guide more carefully next time around:

- What is your platform (Windows/Linux)
- What is your version of R
- What where the commands that lead to this error
- Please provide a small piece of code that reproduces the problem (if 
possible ofcourse)

Wtihout this information we could give a wild guess to what happened, 
but no good, specific answer.

cheers,
Paul

Mikael Carlsson wrote:
> Hi!
>
> I got the following
>
> The instruction at "0x0000002c" referenced memory at "0x0000002c". The 
> memory could not be "read"
>
>
> Any clue?
>
> Regards,
> Mikael
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   


-- 
Drs. Paul Hiemstra
Department of Physical Geography
Faculty of Geosciences
University of Utrecht
Heidelberglaan 2
P.O. Box 80.115
3508 TC Utrecht
Phone: 	+31302535773
Fax:	+31302531145
http://intamap.geo.uu.nl/~paul



From Mikael.Carlsson at sgu.se  Tue Oct 21 10:36:58 2008
From: Mikael.Carlsson at sgu.se (Mikael Carlsson)
Date: Tue, 21 Oct 2008 10:36:58 +0200
Subject: [R-sig-Geo] Memory problems (new try)
Message-ID: <OF63CC1EDC.7EF3AC05-ONC12574E9.002E4083-C12574E9.002F5EEF@sgu.se>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081021/de5820c8/attachment.pl>

From p.hiemstra at geo.uu.nl  Tue Oct 21 13:19:10 2008
From: p.hiemstra at geo.uu.nl (Paul Hiemstra)
Date: Tue, 21 Oct 2008 13:19:10 +0200
Subject: [R-sig-Geo] Memory problems (new try)
In-Reply-To: <OF63CC1EDC.7EF3AC05-ONC12574E9.002E4083-C12574E9.002F5EEF@sgu.se>
References: <OF63CC1EDC.7EF3AC05-ONC12574E9.002E4083-C12574E9.002F5EEF@sgu.se>
Message-ID: <48FDBAAE.8090505@geo.uu.nl>

Hi,

You could try to upgrade R (2.4.1 is rather old) and all the packages 
and see if the error still occurs.

cheers,
Paul

Mikael Carlsson wrote:
> Hi,
> A little bit more info about my problems...
> R version and OS:
> R 2.4.1 on WinXP
>
> Loaded packages:
> library(akima)
> library(class) #The VR package
> library(fBasics)
> library(fSeries)
> library(fMultivar)
> library(fields)
> library(geoR)
> library(gstat)
> library(lattice)
> library(locfit)
> library(mapdata)
> library(maptools)
> library(MASS) #The VR package
> library(nnet) #The VR package
> library(rgdal)
> library(rgl)
> library(shapefiles)
> library(sp)
> library(spatial) #The VR package
> library(spatstat)
>
>
> Pice of code:
> attach(cumark)
> mew <- as.vector(ew)
> mns <- as.vector(ns)
> mcu <- as.vector(cu)
>
> fcumark <- data.frame(mew, mns, mcu)
>
> coordinates(fcumark) <- ~mew+mns
>
> fcumark.interp <- interp(mew, mns, mcu,
>                xo = seq(min(mew), max(mew), length = 400),
>                yo = seq(min(mns), max(mns), length = 400),
>                linear= FALSE,
>                extrap= FALSE,
>                duplicate = "error",
>                dupfun = NULL,
>                ncp = NULL)
>
> Hang up message:
> The instruction at "0x0000002c" referenced memory at "0x0000002c". The 
> memory could not be "read"
>
> Any clue?
>
> Regards,
> Mikael
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   


-- 
Drs. Paul Hiemstra
Department of Physical Geography
Faculty of Geosciences
University of Utrecht
Heidelberglaan 2
P.O. Box 80.115
3508 TC Utrecht
Phone: 	+31302535773
Fax:	+31302531145
http://intamap.geo.uu.nl/~paul



From alessandro.montaghi at unifi.it  Tue Oct 21 21:56:36 2008
From: alessandro.montaghi at unifi.it (Alessandro)
Date: Tue, 21 Oct 2008 12:56:36 -0700
Subject: [R-sig-Geo] error in my code
Message-ID: <000c01c933b7$21408cc0$63c1a640$@montaghi@unifi.it>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081021/5c7ee513/attachment.pl>

From saldanha.plangeo at gmail.com  Wed Oct 22 01:41:18 2008
From: saldanha.plangeo at gmail.com (Raphael Saldanha)
Date: Tue, 21 Oct 2008 22:41:18 -0100
Subject: [R-sig-Geo] poly2nb
Message-ID: <c85849370810211641q5f6ca77apa48d2307bf80df32@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081021/4d88b846/attachment.pl>

From danlinyu at gmail.com  Wed Oct 22 02:20:35 2008
From: danlinyu at gmail.com (Danlin Yu)
Date: Tue, 21 Oct 2008 20:20:35 -0400
Subject: [R-sig-Geo] poly2nb
In-Reply-To: <c85849370810211641q5f6ca77apa48d2307bf80df32@mail.gmail.com>
References: <c85849370810211641q5f6ca77apa48d2307bf80df32@mail.gmail.com>
Message-ID: <48FE71D3.7030009@googlemail.com>

Raphael:

First, you need to justify why higher orders are needed.

Then, once you've had the first order contiguity matrix, you can "power" 
them to higher orders, namely, square the first order matrix, and make 
every non-one cell zero, you'll be getting the second order contiguity 
matrix.

Hope this helps.

Cheers,
Dr. Danlin Yu

Raphael Saldanha wrote:
> Hi!
> As suggested, I'm using poly2nb to make queen and rook contiguity matrices,
> but all they are first order. How can I work with another orders?
>
> Regards,
>
> Raphael Saldanha
> saldanha.plangeo at gmail.com
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   

-- 
___________________________________________
Danlin Yu, Ph.D.
Assistant Professor
Department of Earth & Environmental Studies
Montclair State University
Montclair, NJ, 07043
Tel: 973-655-4313
Fax: 973-655-4072
email: yud at mail.montclair.edu
webpage: csam.montclair.edu/~yu



From alessandro.montaghi at unifi.it  Wed Oct 22 03:35:14 2008
From: alessandro.montaghi at unifi.it (Alessandro)
Date: Tue, 21 Oct 2008 18:35:14 -0700
Subject: [R-sig-Geo] summary pixel inside the shape-file polygon with R+SAGA
Message-ID: <001e01c933e6$6fbde3a0$4f39aae0$@montaghi@unifi.it>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081021/abfbfb20/attachment.pl>

From figen.ramirez at gmail.com  Wed Oct 22 05:32:06 2008
From: figen.ramirez at gmail.com (Figen Ramirez)
Date: Tue, 21 Oct 2008 22:32:06 -0500
Subject: [R-sig-Geo] how to export kriged result to Arcview
Message-ID: <1a5e77ac0810212032n1ddfe980k9d68c641da574cd6@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081021/11b27101/attachment.pl>

From h.bredel at gmx.de  Wed Oct 22 08:43:59 2008
From: h.bredel at gmx.de (Henning Bredel)
Date: Wed, 22 Oct 2008 08:43:59 +0200
Subject: [R-sig-Geo] Raster analysis using R
Message-ID: <200810220843.59349.h.bredel@gmx.de>

Hi,

I was wondering if there are some R packages which deal
with analysis functions on raster inputs.

While reading http://cran.r-project.org/web/views/Spatial.html
I've got the impression that the packages mentioned there
do not provide possibilities on doing for example spatial 
resampling or reclassification on an input raster file like a
(georeferenced) satallite image. 

In the seminar `Geostatistics and Image Analysis' I'm attending
some topics are dealing with the combination of in situ sensor 
data and satallite images or aerophoto respectively.

Is there a discussion on the web, how much R can (or should
be able to) handle raster image data and corresponding
raster analysis?

Best regards

  Henning

-- 
 . . . no signature
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part.
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081022/36d22daa/attachment.bin>

From Roger.Bivand at nhh.no  Wed Oct 22 09:22:37 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 22 Oct 2008 09:22:37 +0200 (CEST)
Subject: [R-sig-Geo] poly2nb
In-Reply-To: <c85849370810211641q5f6ca77apa48d2307bf80df32@mail.gmail.com>
References: <c85849370810211641q5f6ca77apa48d2307bf80df32@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0810220921090.29334@reclus.nhh.no>

On Tue, 21 Oct 2008, Raphael Saldanha wrote:

> Hi!
> As suggested, I'm using poly2nb to make queen and rook contiguity matrices,
> but all they are first order. How can I work with another orders?

nblag() in spdep to generate a list of nb objects for increasing orders, 
nblag_cumul() to cumulate such a list.

Roger

>
> Regards,
>
> Raphael Saldanha
> saldanha.plangeo at gmail.com
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From T.Hengl at uva.nl  Wed Oct 22 10:40:56 2008
From: T.Hengl at uva.nl (Tomislav Hengl)
Date: Wed, 22 Oct 2008 10:40:56 +0200
Subject: [R-sig-Geo] Raster analysis using R
In-Reply-To: <200810220843.59349.h.bredel@gmx.de>
References: <200810220843.59349.h.bredel@gmx.de>
Message-ID: <DF9022126CBC4518B99589A035298F1D@pcibed193>


Dear Henning,

There has been some discussion recently whether we should be developing raster data processing
capabilities in R (e.g. https://stat.ethz.ch/pipermail/r-sig-geo/2008-June/003785.html), since there
are number of (extensive!) open source GIS packages that can be nicely controlled from R. 

Most of R users under Linux use GRASS for raster map processing:
http://grass.itc.it/ 

I've just started writing a small user's guide to run GIS analysis in ILWIS/SAGA:
http://spatial-analyst.net/wiki/index.php?title=Software 

Have fun,

T. Hengl
http://spatial-analyst.net 


-----Original Message-----
From: r-sig-geo-bounces at stat.math.ethz.ch [mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of
Henning Bredel
Sent: Wednesday, October 22, 2008 8:44 AM
To: r-sig-geo at stat.math.ethz.ch
Subject: [R-sig-Geo] Raster analysis using R

Hi,

I was wondering if there are some R packages which deal
with analysis functions on raster inputs.

While reading http://cran.r-project.org/web/views/Spatial.html
I've got the impression that the packages mentioned there
do not provide possibilities on doing for example spatial 
resampling or reclassification on an input raster file like a
(georeferenced) satallite image. 

In the seminar `Geostatistics and Image Analysis' I'm attending
some topics are dealing with the combination of in situ sensor 
data and satallite images or aerophoto respectively.

Is there a discussion on the web, how much R can (or should
be able to) handle raster image data and corresponding
raster analysis?

Best regards

  Henning

-- 
 . . . no signature



From T.Hengl at uva.nl  Wed Oct 22 12:20:34 2008
From: T.Hengl at uva.nl (Tomislav Hengl)
Date: Wed, 22 Oct 2008 12:20:34 +0200
Subject: [R-sig-Geo] Problems with obtaining a copy of your ASDAR-book
In-Reply-To: <Pine.LNX.4.64.0810220921090.29334@reclus.nhh.no>
References: <c85849370810211641q5f6ca77apa48d2307bf80df32@mail.gmail.com>
	<Pine.LNX.4.64.0810220921090.29334@reclus.nhh.no>
Message-ID: <89EEE2FAAE4C42BB892262385041A89A@pcibed193>


Dear Roger, Edzer and Virgilio,

Somehow, I was not lucky enough to receive a copy of your ASDAR book (I only had a chance to browse
it yesterday at Edzer's place). First, I followed the R course Edzer gave at GEOENV2008, and our
copy did not arrive on time (the organizers made a wrong shipment order; then, they had to send it
back after the conference). Second, I just order your book 10 days ago, and it is already out of
print.

I would like to congratulate you on this excellent book. It helps me systematically adjust many of
my data analysis strategies and get a quick review of what and how things should be done (and what
should we think about in the near future). The accompanying website is also excellent.

The fact that the book has been sold-out so quickly proves my evaluation (I sincerely hope that
Springer did not print only a small number of copies?!).

An on-line version of each chapter is available at:
http://www.springerlink.com/content/978-0-387-78170-9 

Unfortunately, it is not a part of standard package that my University buys from Springer, hence I
would need to pay 25 USD per chapter (I would rather buy a complete copy for 45 EUR). 

Hopefully Springer will push this issue and order new prints very soon, so that your book gets in
the hands of its biggest fans. (otherwise, you might also want to check some open access publishers
in the near future: e.g. http://publications.copernicus.org/).


all the best,

Tom Hengl
http://spatial-analyst.net



From Virgilio.Gomez at uclm.es  Wed Oct 22 12:34:16 2008
From: Virgilio.Gomez at uclm.es (Virgilio Gomez Rubio)
Date: Wed, 22 Oct 2008 12:34:16 +0200
Subject: [R-sig-Geo] Problems with obtaining a copy of your ASDAR-book
In-Reply-To: <89EEE2FAAE4C42BB892262385041A89A@pcibed193>
References: <c85849370810211641q5f6ca77apa48d2307bf80df32@mail.gmail.com>
	<Pine.LNX.4.64.0810220921090.29334@reclus.nhh.no>
	<89EEE2FAAE4C42BB892262385041A89A@pcibed193>
Message-ID: <1224671656.6395.24.camel@Virgilio-Gomez>

Dear Tom,

Many thanks for your nice comments on the book. We realised a few days
ago that the book was out of stock in Europe, but it seems that you can
still get it from the USA (via Springer or Amazon.com). If you order via
through the Springer website (remember the 20% discount) you may need to
adjust the zone to North America to see that the book in still in stock.
Hopefully they will ship more copies to Europe.

As we have mentioned before, any comments on how to improve the book are
welcome (off-list, please).

Best wishes,

Virgilio

P.S: By the way, Amazon also allows you to search inside the book
and read a few pages at a time. This is useful even if you have the book
to look for specific keywords!



From T.Hengl at uva.nl  Wed Oct 22 13:11:25 2008
From: T.Hengl at uva.nl (Tomislav Hengl)
Date: Wed, 22 Oct 2008 13:11:25 +0200
Subject: [R-sig-Geo] Problems with obtaining a copy of your ASDAR-book
In-Reply-To: <1224671656.6395.24.camel@Virgilio-Gomez>
References: <c85849370810211641q5f6ca77apa48d2307bf80df32@mail.gmail.com>
	<Pine.LNX.4.64.0810220921090.29334@reclus.nhh.no>
	<89EEE2FAAE4C42BB892262385041A89A@pcibed193>
	<1224671656.6395.24.camel@Virgilio-Gomez>
Message-ID: <D6F4CCC828984F8BAD0C6000EB2D3ABE@pcibed193>


Dear Virgilio,

Thanks for the info. I will try to order it via USA.

You are right! The whole book is in fact available on-line for reading via Amazon:
http://www.amazon.com/gp/reader/0387781706/ 

I hope that nobody will be naive and waste 25 USD on Springer.

cheers,

Tom Hengl
http://spatial-analyst.net 



-----Original Message-----
From: Virgilio Gomez Rubio [mailto:Virgilio.Gomez at uclm.es] 
Sent: Wednesday, October 22, 2008 12:34 PM
To: Tomislav Hengl
Cc: r-sig-geo at stat.math.ethz.ch
Subject: Re: [R-sig-Geo] Problems with obtaining a copy of your ASDAR-book

Dear Tom,

Many thanks for your nice comments on the book. We realised a few days
ago that the book was out of stock in Europe, but it seems that you can
still get it from the USA (via Springer or Amazon.com). If you order via
through the Springer website (remember the 20% discount) you may need to
adjust the zone to North America to see that the book in still in stock.
Hopefully they will ship more copies to Europe.

As we have mentioned before, any comments on how to improve the book are
welcome (off-list, please).

Best wishes,

Virgilio

P.S: By the way, Amazon also allows you to search inside the book
and read a few pages at a time. This is useful even if you have the book
to look for specific keywords!



From r.hijmans at gmail.com  Wed Oct 22 13:35:09 2008
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Wed, 22 Oct 2008 19:35:09 +0800
Subject: [R-sig-Geo] Raster analysis using R
Message-ID: <dc22b2570810220435i894650fk52a93bc1c12adf5@mail.gmail.com>

We are developing the 'raster' package and related packages for raster
analysis, including for sat image analysis. The code is on r-forge
(http://r-forge.r-project.org/projects/r-gis/). It is still a bit
early days, the code is not stable, and the project not properly
described yet, but the raster package is functional for
reclassification and some other calculations. Robert


> -----Original Message
> From: r-sig-geo-bounces at stat.math.ethz.ch [mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of
> Henning Bredel
> Sent: Wednesday, October 22, 2008 8:44 AM
> To: r-sig-geo at stat.math.ethz.ch
> Subject: [R-sig-Geo] Raster analysis using R
>
> Hi,
>
> I was wondering if there are some R packages which deal
> with analysis functions on raster inputs.
>
> While reading http://cran.r-project.org/web/views/Spatial.html
> I've got the impression that the packages mentioned there
> do not provide possibilities on doing for example spatial
> resampling or reclassification on an input raster file like a
> (georeferenced) satallite image.
>
> In the seminar `Geostatistics and Image Analysis' I'm attending
> some topics are dealing with the combination of in situ sensor
> data and satallite images or aerophoto respectively.
>
> Is there a discussion on the web, how much R can (or should
> be able to) handle raster image data and corresponding
> raster analysis?
>
> Best regards
>
>  Henning
>
> --
>  . . . no signature
>
>
>
> ------------------------------
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
> End of R-sig-Geo Digest, Vol 62, Issue 18
> *****************************************
>



From edzer.pebesma at uni-muenster.de  Wed Oct 22 22:10:10 2008
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 22 Oct 2008 22:10:10 +0200
Subject: [R-sig-Geo] Raster analysis using R
In-Reply-To: <dc22b2570810220435i894650fk52a93bc1c12adf5@mail.gmail.com>
References: <dc22b2570810220435i894650fk52a93bc1c12adf5@mail.gmail.com>
Message-ID: <48FF88A2.5000803@uni-muenster.de>

Very interesting initiative. Will the raster package deal with raster 
images that are too large to fit in memory?
--
Edzer

Robert Hijmans wrote:
> We are developing the 'raster' package and related packages for raster
> analysis, including for sat image analysis. The code is on r-forge
> (http://r-forge.r-project.org/projects/r-gis/). It is still a bit
> early days, the code is not stable, and the project not properly
> described yet, but the raster package is functional for
> reclassification and some other calculations. Robert
>
>
>   
>> -----Original Message
>> From: r-sig-geo-bounces at stat.math.ethz.ch [mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of
>> Henning Bredel
>> Sent: Wednesday, October 22, 2008 8:44 AM
>> To: r-sig-geo at stat.math.ethz.ch
>> Subject: [R-sig-Geo] Raster analysis using R
>>
>> Hi,
>>
>> I was wondering if there are some R packages which deal
>> with analysis functions on raster inputs.
>>
>> While reading http://cran.r-project.org/web/views/Spatial.html
>> I've got the impression that the packages mentioned there
>> do not provide possibilities on doing for example spatial
>> resampling or reclassification on an input raster file like a
>> (georeferenced) satallite image.
>>
>> In the seminar `Geostatistics and Image Analysis' I'm attending
>> some topics are dealing with the combination of in situ sensor
>> data and satallite images or aerophoto respectively.
>>
>> Is there a discussion on the web, how much R can (or should
>> be able to) handle raster image data and corresponding
>> raster analysis?
>>
>> Best regards
>>
>>  Henning
>>
>> --
>>  . . . no signature
>>
>>
>>
>> ------------------------------
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>> End of R-sig-Geo Digest, Vol 62, Issue 18
>> *****************************************
>>
>>     
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de/
http://www.springer.com/978-0-387-78170-9 e.pebesma at wwu.de



From alessandro.montaghi at unifi.it  Thu Oct 23 00:27:26 2008
From: alessandro.montaghi at unifi.it (Alessandro)
Date: Wed, 22 Oct 2008 15:27:26 -0700
Subject: [R-sig-Geo] R+SAGA library=SHAPE_GRID
Message-ID: <006a01c93495$5d4f2850$17ed78f0$@montaghi@unifi.it>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081022/98470a86/attachment.pl>

From r.hijmans at gmail.com  Thu Oct 23 02:44:21 2008
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Thu, 23 Oct 2008 08:44:21 +0800
Subject: [R-sig-Geo] Raster analysis using R
In-Reply-To: <48FF88A2.5000803@uni-muenster.de>
References: <dc22b2570810220435i894650fk52a93bc1c12adf5@mail.gmail.com>
	<48FF88A2.5000803@uni-muenster.de>
Message-ID: <dc22b2570810221744r56f0aaf3v187822753f5bea25@mail.gmail.com>

Yes, that is one of the main reasons for developing it. Robert

On Thu, Oct 23, 2008 at 4:10 AM, Edzer Pebesma
<edzer.pebesma at uni-muenster.de> wrote:
> Very interesting initiative. Will the raster package deal with raster images
> that are too large to fit in memory?
> --
> Edzer
>
> Robert Hijmans wrote:
>>
>> We are developing the 'raster' package and related packages for raster
>> analysis, including for sat image analysis. The code is on r-forge
>> (http://r-forge.r-project.org/projects/r-gis/). It is still a bit
>> early days, the code is not stable, and the project not properly
>> described yet, but the raster package is functional for
>> reclassification and some other calculations. Robert
>>
>>
>>
>>>
>>> -----Original Message
>>> From: r-sig-geo-bounces at stat.math.ethz.ch
>>> [mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of
>>> Henning Bredel
>>> Sent: Wednesday, October 22, 2008 8:44 AM
>>> To: r-sig-geo at stat.math.ethz.ch
>>> Subject: [R-sig-Geo] Raster analysis using R
>>>
>>> Hi,
>>>
>>> I was wondering if there are some R packages which deal
>>> with analysis functions on raster inputs.
>>>
>>> While reading http://cran.r-project.org/web/views/Spatial.html
>>> I've got the impression that the packages mentioned there
>>> do not provide possibilities on doing for example spatial
>>> resampling or reclassification on an input raster file like a
>>> (georeferenced) satallite image.
>>>
>>> In the seminar `Geostatistics and Image Analysis' I'm attending
>>> some topics are dealing with the combination of in situ sensor
>>> data and satallite images or aerophoto respectively.
>>>
>>> Is there a discussion on the web, how much R can (or should
>>> be able to) handle raster image data and corresponding
>>> raster analysis?
>>>
>>> Best regards
>>>
>>>  Henning
>>>
>>> --
>>>  . . . no signature
>>>
>>>
>>>
>>> ------------------------------
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>>> End of R-sig-Geo Digest, Vol 62, Issue 18
>>> *****************************************
>>>
>>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> --
> Edzer Pebesma
> Institute for Geoinformatics (ifgi), University of M?nster
> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
> 8333081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de/
> http://www.springer.com/978-0-387-78170-9 e.pebesma at wwu.de
>
>



From alessandro.montaghi at unifi.it  Thu Oct 23 20:52:08 2008
From: alessandro.montaghi at unifi.it (Alessandro)
Date: Thu, 23 Oct 2008 11:52:08 -0700
Subject: [R-sig-Geo] export multi grids from .sgrd to asc fils in one simple
	code
Message-ID: <000901c93540$74dbf100$5e93d300$@montaghi@unifi.it>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081023/28a5e1d8/attachment.pl>

From pbeck at whrc.org  Thu Oct 23 21:14:40 2008
From: pbeck at whrc.org (Pieter Beck)
Date: Thu, 23 Oct 2008 15:14:40 -0400
Subject: [R-sig-Geo] subsetting
Message-ID: <000601c93543$99115260$cb33f720$@org>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081023/8d5e0207/attachment.pl>

From alessandro.montaghi at unifi.it  Thu Oct 23 23:08:49 2008
From: alessandro.montaghi at unifi.it (Alessandro)
Date: Thu, 23 Oct 2008 14:08:49 -0700
Subject: [R-sig-Geo] Create a 30 grid .asc with name in loop formula
Message-ID: <009601c93553$8cbc7b10$a6357130$@montaghi@unifi.it>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081023/0d831c0a/attachment.pl>

From mpinsky at stanford.edu  Fri Oct 24 01:28:59 2008
From: mpinsky at stanford.edu (Malin Pinsky)
Date: Thu, 23 Oct 2008 16:28:59 -0700
Subject: [R-sig-Geo] processing GPS track data?
Message-ID: <22ca8fae0810231628k2c00800bu51c2854c69b69252@mail.gmail.com>

Hi all,

I have a set of GPS track data (in .gpx format now) that I need to
process, and I'm hoping to use R to do it. I've been using R for a
number of years now, but this is my first time wading into spatial
data.

Specifically, I need to:
   1) Smooth the tracks
   2) Select random locations along the tracks
   3) Select segments of the tracks, corresponding to the random locations
   4) Check for overlap between the segments
   5) Output the random segments, preserving other track attribute
data (e.g., timestamps)

So far, my searches on r-sig-geo have come up negative. Has anyone
dealt with data like this before? Can someone recommend the
appropriate packages/functions? PostGIS sounds like it may be another
option if R doesn't yet have the packages.

Thanks for your help.

Regards,
Malin

-- 
Malin Pinsky
Ph.D. Candidate, Palumbi Lab
Hopkins Marine Station
Stanford University
Pacific Grove, CA  93950
mpinsky at stanford.edu



From szybalski at gmail.com  Fri Oct 24 01:33:42 2008
From: szybalski at gmail.com (Lukasz Szybalski)
Date: Thu, 23 Oct 2008 18:33:42 -0500
Subject: [R-sig-Geo] processing GPS track data?
In-Reply-To: <22ca8fae0810231628k2c00800bu51c2854c69b69252@mail.gmail.com>
References: <22ca8fae0810231628k2c00800bu51c2854c69b69252@mail.gmail.com>
Message-ID: <804e5c70810231633l13bbc788la4fae95897e3628c@mail.gmail.com>

What you want to do with the data?

You could try http://openstreetmap.org/
They have the tools that allow you to upload gps traces to their
software if you can share it.
They should also provide some tools that allow you to reformat the gps
trace to let say osm,kml,or shp files.

Lucas

On Thu, Oct 23, 2008 at 6:28 PM, Malin Pinsky <mpinsky at stanford.edu> wrote:
> Hi all,
>
> I have a set of GPS track data (in .gpx format now) that I need to
> process, and I'm hoping to use R to do it. I've been using R for a
> number of years now, but this is my first time wading into spatial
> data.
>
> Specifically, I need to:
>   1) Smooth the tracks
>   2) Select random locations along the tracks
>   3) Select segments of the tracks, corresponding to the random locations
>   4) Check for overlap between the segments
>   5) Output the random segments, preserving other track attribute
> data (e.g., timestamps)
>
> So far, my searches on r-sig-geo have come up negative. Has anyone
> dealt with data like this before? Can someone recommend the
> appropriate packages/functions? PostGIS sounds like it may be another
> option if R doesn't yet have the packages.
>
> Thanks for your help.
>
> Regards,
> Malin
>
> --
> Malin Pinsky
> Ph.D. Candidate, Palumbi Lab
> Hopkins Marine Station
> Stanford University
> Pacific Grove, CA  93950
> mpinsky at stanford.edu
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Turbogears2 Manual
http://lucasmanual.com/mywiki/TurboGears2
Bazaar and Launchpad
http://lucasmanual.com/mywiki/bzr



From dylan.beaudette at gmail.com  Fri Oct 24 01:45:56 2008
From: dylan.beaudette at gmail.com (Dylan Beaudette)
Date: Thu, 23 Oct 2008 16:45:56 -0700
Subject: [R-sig-Geo] processing GPS track data?
In-Reply-To: <22ca8fae0810231628k2c00800bu51c2854c69b69252@mail.gmail.com>
References: <22ca8fae0810231628k2c00800bu51c2854c69b69252@mail.gmail.com>
Message-ID: <200810231645.57053.dylan.beaudette@gmail.com>

On Thursday 23 October 2008 04:28:59 pm Malin Pinsky wrote:
> Hi all,
>
> I have a set of GPS track data (in .gpx format now) that I need to
> process, and I'm hoping to use R to do it. I've been using R for a
> number of years now, but this is my first time wading into spatial
> data.
>

You should be able to accomplish these things with minimal effort using other 
applications:

gpsbabel - Dump tracks, convert to common formats
GRASS - generalize tracks with v.generalize, check for overlap
R - use the 'sp' package to randomly sample the line networks, output sample 
points and import into GRASS to cut up the tracks
PostGIS - good for doing non-topological operations on your data

So-- with the above suite of applications you should be able to do just about 
anything with that GPS data!

Good luck,
Dylan

> Specifically, I need to:
>    1) Smooth the tracks
>    2) Select random locations along the tracks
>    3) Select segments of the tracks, corresponding to the random locations
>    4) Check for overlap between the segments
>    5) Output the random segments, preserving other track attribute
> data (e.g., timestamps)
>
> So far, my searches on r-sig-geo have come up negative. Has anyone
> dealt with data like this before? Can someone recommend the
> appropriate packages/functions? PostGIS sounds like it may be another
> option if R doesn't yet have the packages.
>
> Thanks for your help.
>
> Regards,
> Malin





-- 
Dylan Beaudette
Soil Resource Laboratory
http://casoilresource.lawr.ucdavis.edu/
University of California at Davis
530.754.7341



From dylan.beaudette at gmail.com  Fri Oct 24 01:49:39 2008
From: dylan.beaudette at gmail.com (Dylan Beaudette)
Date: Thu, 23 Oct 2008 16:49:39 -0700
Subject: [R-sig-Geo] processing GPS track data?
In-Reply-To: <22ca8fae0810231628k2c00800bu51c2854c69b69252@mail.gmail.com>
References: <22ca8fae0810231628k2c00800bu51c2854c69b69252@mail.gmail.com>
Message-ID: <200810231649.39640.dylan.beaudette@gmail.com>

On Thursday 23 October 2008 04:28:59 pm Malin Pinsky wrote:
> Hi all,
>
> I have a set of GPS track data (in .gpx format now) that I need to
> process, and I'm hoping to use R to do it. I've been using R for a
> number of years now, but this is my first time wading into spatial
> data.
>
> Specifically, I need to:
>    1) Smooth the tracks
>    2) Select random locations along the tracks
>    3) Select segments of the tracks, corresponding to the random locations
>    4) Check for overlap between the segments
>    5) Output the random segments, preserving other track attribute
> data (e.g., timestamps)
>
> So far, my searches on r-sig-geo have come up negative. Has anyone
> dealt with data like this before? Can someone recommend the
> appropriate packages/functions? PostGIS sounds like it may be another
> option if R doesn't yet have the packages.
>
> Thanks for your help.
>
> Regards,
> Malin

Also-- some tips on iteratively sampling several 'geometries' contained in a 
single file.

http://casoilresource.lawr.ucdavis.edu/drupal/node/644

Cheers,

Dylan





-- 
Dylan Beaudette
Soil Resource Laboratory
http://casoilresource.lawr.ucdavis.edu/
University of California at Davis
530.754.7341



From alessandro.montaghi at unifi.it  Fri Oct 24 01:59:05 2008
From: alessandro.montaghi at unifi.it (Alessandro)
Date: Thu, 23 Oct 2008 16:59:05 -0700
Subject: [R-sig-Geo] export .sgrd in tif with R+SAGA
Message-ID: <027301c9356b$566740f0$0335c2d0$@montaghi@unifi.it>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081023/a7bad83a/attachment.pl>

From corashea at gmail.com  Fri Oct 24 03:09:33 2008
From: corashea at gmail.com (Cora Shea)
Date: Thu, 23 Oct 2008 19:09:33 -0600
Subject: [R-sig-Geo] Mapping sparse data evenly to a SpatialPixelsDataFrame
Message-ID: <5faa2bd0810231809y26386ccduc766f78d1f2fce76@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081023/8bb5989a/attachment.pl>

From p.hiemstra at geo.uu.nl  Fri Oct 24 09:28:24 2008
From: p.hiemstra at geo.uu.nl (Paul Hiemstra)
Date: Fri, 24 Oct 2008 09:28:24 +0200
Subject: [R-sig-Geo] subsetting
In-Reply-To: <000601c93543$99115260$cb33f720$@org>
References: <000601c93543$99115260$cb33f720$@org>
Message-ID: <49017918.5000700@geo.uu.nl>

Hi,

Which version of R and sp are you using? I'm asking this because I had a 
similar problem as you had with a raster of 50.000+ points and some 7000 
polygons (not sure if this is comparable to your dataset). Doing the 
overlay took far too long, but after a question about this to the 
r-sig-geo list, Roger Bivand extended the code for point.in.polygon to 
first make a subset of the polygons based on the bounding boxes of the 
polygons (fast operation) and then perform a point in polygon operation. 
I'm not really sure from which version of sp this feature is included, 
but it should be included in the latest version (Roger?). Maybe an 
upgrade would solve your problem, it did mine.

hope this helps,
Paul

Pieter Beck wrote:
> Dear all,
>
> I am a new user to the world of spatial applications of R and am wondering
> about this trivial question:
>
> What is the easiest way to subset a SpatialGridDataFrame, based on 4 corner
> coordinates?
>
>  
>
> The reason I ask is that I want to do an overlay of a polygon file on a
> large raster dataset, to extract summary statistics from it. Both files are
> extremely large, however, and just applying overlay causes memory trouble. I
> was hoping to loop through the polygons, subset the SpatialGridDataFrame
> using the bounding box surrounding a polygon and then create the summary
> statistics one polygon at-a-time. To do this, I'd need to subset the
> SpatialGridDataFrame based on the bounding box corner coordinates.
>
> Thanks in advance for the help,
>
>  
>
> Kind Regards,
>
> Pieter Beck
>
>  
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   


-- 
Drs. Paul Hiemstra
Department of Physical Geography
Faculty of Geosciences
University of Utrecht
Heidelberglaan 2
P.O. Box 80.115
3508 TC Utrecht
Phone: 	+31302535773
Fax:	+31302531145
http://intamap.geo.uu.nl/~paul



From T.Hengl at uva.nl  Fri Oct 24 09:49:18 2008
From: T.Hengl at uva.nl (Tomislav Hengl)
Date: Fri, 24 Oct 2008 09:49:18 +0200
Subject: [R-sig-Geo] export .sgrd in tif with R+SAGA
In-Reply-To: <027301c9356b$566740f0$0335c2d0$@montaghi@unifi.it>
References: <027301c9356b$566740f0$0335c2d0$@montaghi@unifi.it>
Message-ID: <DB6D3DF65FF74E54B0EA2FCE78A2DF09@pcibed193>


Yes, you can export sgrd to geoTIFFs via the "io_grid_gdal" module:

> library(RSAGA)
> rsaga.get.modules("io_grid_gdal")
$io_grid_gdal
  code                              name interactive
1    0            Import Raster via GDAL       FALSE
2    1            Export Raster via GDAL       FALSE
3    2 Export Raster to GeoTIFF via GDAL       FALSE

> rsaga.get.usage("io_grid_gdal", 2)
SAGA CMD 2.0.3
library path:   C:/Progra~1/saga_vc/modules
library name:   io_grid_gdal
module name :   Export Raster to GeoTIFF via GDAL
Usage: 2 -GRIDS <str> [-FILE <str>]
  -GRIDS:<str>  Grid(s)
        Grid list (input)
  -FILE:<str>   File
        File path  


But it seems that you can not control much about that geoTIFFs, hence I would instead recommend
converting the sgrd files to ascii format, and then directly converting them to geoTIFF using the
GDAL binaries (DOS prompt; http://www.gdal.org/gdal_translate.html) e.g.:

gdal_translate '-of' GTiff 'landsat1.asc' 'landsat1.tif'

Unfortunately, SAGA GRID format is not registered at GDAL (maybe you should push this issue? try to
write to Olaf Conrad), so that you will always need to first convert to some other GDAL-recognized
format before you can do any conversion.

Another alternative would be to read the SAGA grid format directly to R, e.g. using the readBin
method (https://stat.ethz.ch/pipermail/r-sig-geo/2008-January/003079.html). But I do not really know
the structure of the SAGA sgrd format, so I do not know how to set the parameters. 

Maybe Alex has more info?

cheers,

Tom Hengl
http://spatial-analyst.net 






-----Original Message-----
From: r-sig-geo-bounces at stat.math.ethz.ch [mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of
Alessandro
Sent: Friday, October 24, 2008 1:59 AM
To: r-sig-geo at stat.math.ethz.ch
Subject: [R-sig-Geo] export .sgrd in tif with R+SAGA

Hi All,

 

Is It possible export a .sgrd grid in .tif image with R+SAGA?

 

Thanks

 

Ale


	[[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch
https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From T.Hengl at uva.nl  Fri Oct 24 10:08:36 2008
From: T.Hengl at uva.nl (Tomislav Hengl)
Date: Fri, 24 Oct 2008 10:08:36 +0200
Subject: [R-sig-Geo] subsetting
In-Reply-To: <000601c93543$99115260$cb33f720$@org>
References: <000601c93543$99115260$cb33f720$@org>
Message-ID: <6ABBB60697C2447DA22A3EEFE84A6092@pcibed193>


If the problem is memory handling in R (still a big headache to do much of GIS analysis in R), you
should instead consider reading pieces of grids that you need e.g.:

info <- GDALinfo("dem50m.asc")
info
gridmaps01 = readGDAL("dem50m.asc", region.dim = round(c(info[["rows"]]/2,info[["columns"]])))
gridmaps02 = readGDAL("dem50m.asc", region.dim = round(c(info[["rows"]]/2,info[["columns"]])),
offset=round(c(info[["rows"]]/2,0)))

will split the original map into two tiles. You could practically read any 'tile'/subset of a grid
using the 'region.dim' argument (rows and column coordinates). You could first prepare an empty grid
topology, then overlay it over your polygons just to get the region dimension, and then read each
piece of the grid that you need.

In GIS terms, getting a raster from one grid topology to (any) other grid topology (also subgrids)
is referred to 'resampling' (I do not think that this is yet implemented in any R package; a
combination of akima and spTransform will do the trick but it is not really compact). A generic
function to combine R+ILWIS to put a map to a different grid (e.g. to LatLon coordinates) would be:

# write to ILWIS:
> writeGDAL(dem25m[1], "dem25m.mpr", "ILWIS")
# create a new grid:
...
> gridparameters(geoarc)
# resample the map (Bilinear) to the new geographic grid:
> shell(cmd=paste(ILWIS, " crgrf geoarc.grf ",geoarc at grid@cells.dim[[2]],"
",geoarc at grid@cells.dim[[1]]," -crdsys=LatlonWGS84
-lowleft=(",geoarc at grid@cellcentre.offset[[1]],",",geoarc at grid@cellcentre.offset[[2]],")
-pixsize=",geoarc at grid@cellsize[[1]],sep=""), wait=F)
> shell(cmd=paste(ILWIS, "dem25m_ll_c.mpr = MapResample(dem25m_c.mpr, geoarc, BiLinear)"), wait=F)
> shell(cmd=paste(ILWIS, "open dem25m_ll_c.mpr -noask"), wait=F)
see http://geomorphometry.org/R.asp 

hth,

Tom Hengl
http://spatial-analyst.net 




-----Original Message-----
From: r-sig-geo-bounces at stat.math.ethz.ch [mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of
Pieter Beck
Sent: Thursday, October 23, 2008 9:15 PM
To: r-sig-geo at stat.math.ethz.ch
Subject: [R-sig-Geo] subsetting

Dear all,

I am a new user to the world of spatial applications of R and am wondering
about this trivial question:

What is the easiest way to subset a SpatialGridDataFrame, based on 4 corner
coordinates?

 

The reason I ask is that I want to do an overlay of a polygon file on a
large raster dataset, to extract summary statistics from it. Both files are
extremely large, however, and just applying overlay causes memory trouble. I
was hoping to loop through the polygons, subset the SpatialGridDataFrame
using the bounding box surrounding a polygon and then create the summary
statistics one polygon at-a-time. To do this, I'd need to subset the
SpatialGridDataFrame based on the bounding box corner coordinates.

Thanks in advance for the help,

 

Kind Regards,

Pieter Beck

 


	[[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch
https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From T.Hengl at uva.nl  Fri Oct 24 10:18:27 2008
From: T.Hengl at uva.nl (Tomislav Hengl)
Date: Fri, 24 Oct 2008 10:18:27 +0200
Subject: [R-sig-Geo] subsetting
In-Reply-To: <000601c93543$99115260$cb33f720$@org>
References: <000601c93543$99115260$cb33f720$@org>
Message-ID: <3133DE072F9C47F9ACDF383E0B443B74@pcibed193>


to get statistics of grids over polygons, you might also consider using the Grid Statistics for
Polygons method in SAGA GIS:

> rsaga.get.modules("shapes_grid")
$shapes_grid
   code                             name interactive
1     0        Add Grid Values to Points       FALSE
2     1         Get Grid Data for Shapes       FALSE
3     2     Grid Statistics for Polygons       FALSE
4     3            Grid Values to Points       FALSE
5     4 Grid Values to Points (randomly)       FALSE
6     5          Contour Lines from Grid       FALSE
7     6         Vectorising Grid Classes       FALSE
8     7           Clip Grid with Polygon       FALSE
9     8               Gradient from Grid       FALSE

> rsaga.get.usage("shapes_grid", 2)

*Note that SAGA can handle even large grids/polygons (up to 2GB size).

hth

Tom Hengl
http://spatial-analyst.net 


-----Original Message-----
From: r-sig-geo-bounces at stat.math.ethz.ch [mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of
Pieter Beck
Sent: Thursday, October 23, 2008 9:15 PM
To: r-sig-geo at stat.math.ethz.ch
Subject: [R-sig-Geo] subsetting

Dear all,

I am a new user to the world of spatial applications of R and am wondering
about this trivial question:

What is the easiest way to subset a SpatialGridDataFrame, based on 4 corner
coordinates?

 

The reason I ask is that I want to do an overlay of a polygon file on a
large raster dataset, to extract summary statistics from it. Both files are
extremely large, however, and just applying overlay causes memory trouble. I
was hoping to loop through the polygons, subset the SpatialGridDataFrame
using the bounding box surrounding a polygon and then create the summary
statistics one polygon at-a-time. To do this, I'd need to subset the
SpatialGridDataFrame based on the bounding box corner coordinates.

Thanks in advance for the help,

 

Kind Regards,

Pieter Beck

 


	[[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch
https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From mrufino at cripsul.ipimar.pt  Fri Oct 24 11:49:43 2008
From: mrufino at cripsul.ipimar.pt (Marta Rufino)
Date: Fri, 24 Oct 2008 10:49:43 +0100
Subject: [R-sig-Geo] bad position of png & klm file in google earth
Message-ID: <49019A37.9040200@cripsul.ipimar.pt>

Dear list,

I would like to start by acknowledging the wonderful work of this 
support list :-)
I have  a question, which should be prety dummy,... but I was looking 
around in the net, in reports, etc. and could not sort it out.

I am trying to export a image plot to google earth. I manage to do it 
with  points data... ok. but when I do it with the images, they simply 
go to Fiji (which I am sure it is a nice place... but a bit far from the 
Algarve, where it should be).
Even the example given in the help file, the image goes to the same 
place. What am I doing wrong?


require(maptools); require(rgdal)
# This is the example, in the file
opt_exask <- options(example.ask=FALSE)
qk <- SpatialPointsDataFrame(quakes[, c(2:1)], quakes)
proj4string(qk) <- CRS("+proj=longlat")
tf <- tempfile()
SGqk <- GE_SpatialGrid(qk)
png(file=paste(tf, ".png", sep=""), width=SGqk$width, 
height=SGqk$height, bg="transparent")
par(mar=c(0,0,0,0), xaxs="i", yaxs="i")
plot(qk, xlim=SGqk$xlim, ylim=SGqk$ylim, setParUsrBB=TRUE)
dev.off()
kmlOverlay(SGqk, paste(tf, ".kml", sep=""), paste(tf, ".png", sep=""))

# than the files produced are in
tf()

I go to the file, pick it the two of them and drag it in google earth... 
and there they are, in Fiji!!! I am sure it is silly, but it is my first 
steps in googleearth--R :-(
If I open it through google earth, it is the same...

A second doubt I have is if we can set apriori, in R the markers 
projected in google earth... how do I do if instead of the pins, I want 
a ball? Do I have to change one by one?


Thank you very much in advance,
Best wishes,
Marta

I am in windows, R 2.7.1, maptools, version 0.7-15, 2008-08-14...
GDAL 1.5.2, released 2008/05/29



From Virgilio.Gomez at uclm.es  Fri Oct 24 12:06:57 2008
From: Virgilio.Gomez at uclm.es (Virgilio Gomez Rubio)
Date: Fri, 24 Oct 2008 12:06:57 +0200
Subject: [R-sig-Geo] bad position of png & klm file in google earth
In-Reply-To: <49019A37.9040200@cripsul.ipimar.pt>
References: <49019A37.9040200@cripsul.ipimar.pt>
Message-ID: <1224842817.6426.9.camel@Virgilio-Gomez>

Marta.

I would say that it is a problem with the coordinates of your data. If
your original data are not in longlat you need to re-project them (with
spTransform) before exporting to GE. 

You can find an example with the meuse data set on these slides prepared
by Roger Bivand:

http://www.bias-project.org.uk/ASDARcourse/unit4_slides.pdf

The original data are not in longlat so they are re-projected before
being exported.

Hope this helps,

Virgilio

El vie, 24-10-2008 a las 10:49 +0100, Marta Rufino escribi?:
> Dear list,
> 
> I would like to start by acknowledging the wonderful work of this 
> support list :-)
> I have  a question, which should be prety dummy,... but I was looking 
> around in the net, in reports, etc. and could not sort it out.
> 
> I am trying to export a image plot to google earth. I manage to do it 
> with  points data... ok. but when I do it with the images, they simply 
> go to Fiji (which I am sure it is a nice place... but a bit far from the 
> Algarve, where it should be).
> Even the example given in the help file, the image goes to the same 
> place. What am I doing wrong?
> 
> 
> require(maptools); require(rgdal)
> # This is the example, in the file
> opt_exask <- options(example.ask=FALSE)
> qk <- SpatialPointsDataFrame(quakes[, c(2:1)], quakes)
> proj4string(qk) <- CRS("+proj=longlat")
> tf <- tempfile()
> SGqk <- GE_SpatialGrid(qk)
> png(file=paste(tf, ".png", sep=""), width=SGqk$width, 
> height=SGqk$height, bg="transparent")
> par(mar=c(0,0,0,0), xaxs="i", yaxs="i")
> plot(qk, xlim=SGqk$xlim, ylim=SGqk$ylim, setParUsrBB=TRUE)
> dev.off()
> kmlOverlay(SGqk, paste(tf, ".kml", sep=""), paste(tf, ".png", sep=""))
> 
> # than the files produced are in
> tf()
> 
> I go to the file, pick it the two of them and drag it in google earth... 
> and there they are, in Fiji!!! I am sure it is silly, but it is my first 
> steps in googleearth--R :-(
> If I open it through google earth, it is the same...
> 
> A second doubt I have is if we can set apriori, in R the markers 
> projected in google earth... how do I do if instead of the pins, I want 
> a ball? Do I have to change one by one?
> 
> 
> Thank you very much in advance,
> Best wishes,
> Marta
> 
> I am in windows, R 2.7.1, maptools, version 0.7-15, 2008-08-14...
> GDAL 1.5.2, released 2008/05/29
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From T.Hengl at uva.nl  Fri Oct 24 12:26:16 2008
From: T.Hengl at uva.nl (Tomislav Hengl)
Date: Fri, 24 Oct 2008 12:26:16 +0200
Subject: [R-sig-Geo] bad position of png & klm file in google earth
In-Reply-To: <49019A37.9040200@cripsul.ipimar.pt>
References: <49019A37.9040200@cripsul.ipimar.pt>
Message-ID: <954547CB32DE4A2EB39CCBD263A9791F@pcibed193>


Dear Marta,

I am not sure what is the projection system you use for the Algarve case study? If it is different
from CRS("+proj=longlat +datum=WGS84"), then you do need to first reproject your maps.

You should really look at the examples from the book by Bivand et al.:
http://www.asdar-book.org/code.php?chapter=3&figure=1
http://www.asdar-book.org/code.php?chapter=3&figure=2 

Here you will find small examples of how to export any raster map to GE (it reprojects a map using
the MapResample method of ILWIS GIS):
http://geomorphometry.org/R.asp 

I personally do not use much the maptools to generate GE KMLs, but instead write directly a KML file
from R e.g. to export a time-series of interpolated temperature images to KML in a loop:

> filename = "croclim12.kml"
> write("<?xml version=\"1.0\" encoding=\"UTF-8\"?>", filename)
> write("<kml xmlns=\"http://earth.google.com/kml/2.2\">", filename, append = TRUE)
> write("<Folder>", filename, append = TRUE)
> write("\t<name>Mean Daily TEMP</name>", filename, append = TRUE)
> write("\t<open>1</open>", filename, append = TRUE)
> for (i in slices) {
 slice = floor(unclass(as.POSIXct(i))/86400)[[1]]
 write("\t\t<GroundOverlay>", filename, append = TRUE)
 write(paste("\t\t<name>", i, "</name>", sep = ""),
 filename, append = TRUE)
 write("\t\t<TimeSpan>", filename, append = TRUE)
 write(paste("\t\t\t<begin>", slice, "</begin>", sep = ""),
 filename, append = TRUE)
 write(paste("\t\t\t<end>", slice + 1, "</end>", sep = ""),
 filename, append = TRUE)
 write("\t\t</TimeSpan>", filename, append = TRUE)
 write("\t\t<color>99ffffff</color>", filename, append = TRUE)
 write("\t\t<Icon>", filename, append = TRUE)
 write(paste("\t\t\t<href>", getwd(), "/MDTEMP", slice, ".png</href>", sep = ""), filename, append =
TRUE)
 write("\t\t\t<viewBoundScale>0.75</viewBoundScale>",
 filename, append = TRUE)
 write("\t\t</Icon>", filename, append = TRUE)
 write("\t\t<altitude>50</altitude>", filename, append = TRUE)
 write("\t\t<altitudeMode>relativeToGround</altitudeMode>",
 filename, append = TRUE)
 write("\t\t<LatLonBox>", filename, append = TRUE)
 write(paste("\t\t\t<north>", grids.kml$ylim[[2]],
 "</north>", sep = ""), filename, append = TRUE)
 write(paste("\t\t\t<south>", grids.kml$ylim[[1]],
 "</south>", sep = ""), filename, append = TRUE)
 write(paste("\t\t\t<east>", grids.kml$xlim[[2]],
 "</east>", sep = ""), filename, append = TRUE)
 write(paste("\t\t\t<west>", grids.kml$xlim[[1]],
 "</west>", sep = ""), filename, append = TRUE)
 write("\t\t</LatLonBox>", filename, append = TRUE)
 write("\t</GroundOverlay>", filename, append = TRUE)
}
> write("<ScreenOverlay>", filename, append = TRUE)
> write(paste(" <name>values from", MDTEMPxlim[[1]], " to ", MDTEMPxlim[[2]], "</name>", sep = ""),
filename, append = TRUE)
> write(" <Icon>", filename, append = TRUE)
> write(paste("\t\t\t<href>", getwd(), "/legend.png</href>", sep = ""), filename, append = TRUE)
> write(" </Icon>", filename, append = TRUE)
> write(" <overlayXY x=\"0\" y=\"1\" xunits=\"fraction\" yunits=\"fraction\"/>", filename, append =
TRUE)
> write(" <screenXY x=\"0\" y=\"1\" xunits=\"fraction\" yunits=\"fraction\"/>", filename, append =
TRUE)
> write(" <rotationXY x=\"0\" y=\"0\" xunits=\"fraction\" yunits=\"fraction\"/>", filename, append =
TRUE)
> write(" <size x=\"0\" y=\"0\" xunits=\"fraction\" yunits=\"fraction\"/>", filename, append = TRUE)
> write(" </ScreenOverlay>", filename, append = TRUE)
> write("</Folder>", filename, append = TRUE)
> write("</kml>", filename, append = TRUE)


I guess you need to read the KML tutorial
(http://code.google.com/apis/kml/documentation/kml_tut.html) to find out what exactly you need to
use.
 
hth

Tom Hengl 
http://spatial-analyst.net 


-----Original Message-----
From: r-sig-geo-bounces at stat.math.ethz.ch [mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of
Marta Rufino
Sent: Friday, October 24, 2008 11:50 AM
To: r-sig-geo at stat.math.ethz.ch
Subject: [R-sig-Geo] bad position of png & klm file in google earth

Dear list,

I would like to start by acknowledging the wonderful work of this 
support list :-)
I have  a question, which should be prety dummy,... but I was looking 
around in the net, in reports, etc. and could not sort it out.

I am trying to export a image plot to google earth. I manage to do it 
with  points data... ok. but when I do it with the images, they simply 
go to Fiji (which I am sure it is a nice place... but a bit far from the 
Algarve, where it should be).
Even the example given in the help file, the image goes to the same 
place. What am I doing wrong?


require(maptools); require(rgdal)
# This is the example, in the file
opt_exask <- options(example.ask=FALSE)
qk <- SpatialPointsDataFrame(quakes[, c(2:1)], quakes)
proj4string(qk) <- CRS("+proj=longlat")
tf <- tempfile()
SGqk <- GE_SpatialGrid(qk)
png(file=paste(tf, ".png", sep=""), width=SGqk$width, 
height=SGqk$height, bg="transparent")
par(mar=c(0,0,0,0), xaxs="i", yaxs="i")
plot(qk, xlim=SGqk$xlim, ylim=SGqk$ylim, setParUsrBB=TRUE)
dev.off()
kmlOverlay(SGqk, paste(tf, ".kml", sep=""), paste(tf, ".png", sep=""))

# than the files produced are in
tf()

I go to the file, pick it the two of them and drag it in google earth... 
and there they are, in Fiji!!! I am sure it is silly, but it is my first 
steps in googleearth--R :-(
If I open it through google earth, it is the same...

A second doubt I have is if we can set apriori, in R the markers 
projected in google earth... how do I do if instead of the pins, I want 
a ball? Do I have to change one by one?


Thank you very much in advance,
Best wishes,
Marta

I am in windows, R 2.7.1, maptools, version 0.7-15, 2008-08-14...
GDAL 1.5.2, released 2008/05/29

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch
https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From mrufino at cripsul.ipimar.pt  Fri Oct 24 12:33:34 2008
From: mrufino at cripsul.ipimar.pt (Marta Rufino)
Date: Fri, 24 Oct 2008 11:33:34 +0100
Subject: [R-sig-Geo] bad position of png & klm file in google earth
In-Reply-To: <954547CB32DE4A2EB39CCBD263A9791F@pcibed193>
References: <49019A37.9040200@cripsul.ipimar.pt>
	<954547CB32DE4A2EB39CCBD263A9791F@pcibed193>
Message-ID: <4901A47E.7030604@cripsul.ipimar.pt>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081024/59b47964/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Fri Oct 24 12:59:18 2008
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Fri, 24 Oct 2008 11:59:18 +0100
Subject: [R-sig-Geo] bad position of png & klm file in google earth
In-Reply-To: <49019A37.9040200@cripsul.ipimar.pt>
References: <49019A37.9040200@cripsul.ipimar.pt>
Message-ID: <d8ad40b50810240359n7ab5e0baq848940a5eb5a18bd@mail.gmail.com>

2008/10/24 Marta Rufino <mrufino at cripsul.ipimar.pt>:

> I am trying to export a image plot to google earth. I manage to do it with
>  points data... ok. but when I do it with the images, they simply go to Fiji
> (which I am sure it is a nice place... but a bit far from the Algarve, where
> it should be).
> Even the example given in the help file, the image goes to the same place.
> What am I doing wrong?
>
>
> require(maptools); require(rgdal)
> # This is the example, in the file
> opt_exask <- options(example.ask=FALSE)
> qk <- SpatialPointsDataFrame(quakes[, c(2:1)], quakes)
> proj4string(qk) <- CRS("+proj=longlat")
> tf <- tempfile()
> SGqk <- GE_SpatialGrid(qk)
> png(file=paste(tf, ".png", sep=""), width=SGqk$width, height=SGqk$height,
> bg="transparent")
> par(mar=c(0,0,0,0), xaxs="i", yaxs="i")
> plot(qk, xlim=SGqk$xlim, ylim=SGqk$ylim, setParUsrBB=TRUE)
> dev.off()
> kmlOverlay(SGqk, paste(tf, ".kml", sep=""), paste(tf, ".png", sep=""))

 When I do this, I get the following in my KML file:

<LatLonBox><north>-10.72</north><south>-38.59</south><east>188.158103454744</east><west>165.67</west></LatLonBox>

 which corresponds (near enough) to the bounding box of the data:

> bbox(qk)
        min    max
long 165.67 188.13
lat  -38.59 -10.72

 Does the KML for your data have the right LatLonBox coords?

> A second doubt I have is if we can set apriori, in R the markers projected
> in google earth... how do I do if instead of the pins, I want a ball? Do I
> have to change one by one?

 You'll need to edit the KML file, and do a search-and-replace. Or if
you want to be really smart, since the KML format is an XML format,
you could write an XSLT file to do the transformation. XSLT is another
XML format for doing transformations on XML files. Personally, I think
life is too short to do everything in XML, and it is probably quicker
to load it into your favourite editor and do a search-and-replace!

 If you need to do it in a program, you could read the XML into R with
the R XML tools, and then tweak it....

Barry



From edzer.pebesma at uni-muenster.de  Fri Oct 24 13:08:09 2008
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 24 Oct 2008 13:08:09 +0200
Subject: [R-sig-Geo] subsetting
In-Reply-To: <000601c93543$99115260$cb33f720$@org>
References: <000601c93543$99115260$cb33f720$@org>
Message-ID: <4901AC99.7070700@uni-muenster.de>

Pieter,

the easiest in terms of the least mental exercise might be to form a
polygon from the four points and then overlay that with the grid. This
will likely be too slow and/or memory intensive.

The more efficient way would be to compute the row and column index
ranges from the bounding box, and index the SpatialGridDataFrame with
that. gridparameters(x) gives you the necessary information for this.
--
Edzer

Pieter Beck wrote:
> Dear all,
>
> I am a new user to the world of spatial applications of R and am wondering
> about this trivial question:
>
> What is the easiest way to subset a SpatialGridDataFrame, based on 4 corner
> coordinates?
>
>  
>
> The reason I ask is that I want to do an overlay of a polygon file on a
> large raster dataset, to extract summary statistics from it. Both files are
> extremely large, however, and just applying overlay causes memory trouble. I
> was hoping to loop through the polygons, subset the SpatialGridDataFrame
> using the bounding box surrounding a polygon and then create the summary
> statistics one polygon at-a-time. To do this, I'd need to subset the
> SpatialGridDataFrame based on the bounding box corner coordinates.
>
> Thanks in advance for the help,
>
>  
>
> Kind Regards,
>
> Pieter Beck
>
>  
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de/
http://www.springer.com/978-0-387-78170-9 e.pebesma at wwu.de



From mrufino at cripsul.ipimar.pt  Fri Oct 24 13:56:23 2008
From: mrufino at cripsul.ipimar.pt (Marta Rufino)
Date: Fri, 24 Oct 2008 12:56:23 +0100
Subject: [R-sig-Geo] bad position of png & klm file in google earth
In-Reply-To: <d8ad40b50810240359n7ab5e0baq848940a5eb5a18bd@mail.gmail.com>
References: <49019A37.9040200@cripsul.ipimar.pt>
	<d8ad40b50810240359n7ab5e0baq848940a5eb5a18bd@mail.gmail.com>
Message-ID: <4901B7E7.4040904@cripsul.ipimar.pt>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081024/b16a1fec/attachment.pl>

From edzer.pebesma at uni-muenster.de  Fri Oct 24 17:24:46 2008
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 24 Oct 2008 17:24:46 +0200
Subject: [R-sig-Geo] subsetting
In-Reply-To: <6ABBB60697C2447DA22A3EEFE84A6092@pcibed193>
References: <000601c93543$99115260$cb33f720$@org>
	<6ABBB60697C2447DA22A3EEFE84A6092@pcibed193>
Message-ID: <4901E8BE.1030904@uni-muenster.de>

Tomislav Hengl wrote:
> In GIS terms, getting a raster from one grid topology to (any) other grid topology (also subgrids)
> is referred to 'resampling' (I do not think that this is yet implemented in any R package; a
> combination of akima and spTransform will do the trick but it is not really compact).
I do think so: overlay in sp is your friend:

library(sp)
data(meuse.grid)
gridded(meuse.grid) = ~x+y
grd = spsample(meuse.grid, n = 100, type = "regular")
image(meuse.grid["dist"])
points(grd, pch = 3)

gridded(grd)= TRUE
overlay(meuse.grid, grd)
grddf = SpatialPixelsDataFrame(grd, as(meuse.grid, 
"data.frame")[overlay(meuse.grid, grd),])
image(grddf["dist"])
points(as(grd, "SpatialPoints"), pch = 3)

Note that there is only a single code line that does the resample. If 
anyone has suggestions for a cleaner or simpler interface, or a function 
or method resample, please let me know.

This of course does not do any interpolation; I consider that a 
different chapter (and package). I cannot see how spTransform could help 
here.When warping grids, you'd have to revert them first into polygons 
and spTransform them, to conserve the non-square grid cells resulting.
--
Edzer


>  A generic
> function to combine R+ILWIS to put a map to a different grid (e.g. to LatLon coordinates) would be:
>
> # write to ILWIS:
>   
>> writeGDAL(dem25m[1], "dem25m.mpr", "ILWIS")
>>     
> # create a new grid:
> ...
>   
>> gridparameters(geoarc)
>>     
> # resample the map (Bilinear) to the new geographic grid:
>   
>> shell(cmd=paste(ILWIS, " crgrf geoarc.grf ",geoarc at grid@cells.dim[[2]],"
>>     
> ",geoarc at grid@cells.dim[[1]]," -crdsys=LatlonWGS84
> -lowleft=(",geoarc at grid@cellcentre.offset[[1]],",",geoarc at grid@cellcentre.offset[[2]],")
> -pixsize=",geoarc at grid@cellsize[[1]],sep=""), wait=F)
>   
>> shell(cmd=paste(ILWIS, "dem25m_ll_c.mpr = MapResample(dem25m_c.mpr, geoarc, BiLinear)"), wait=F)
>> shell(cmd=paste(ILWIS, "open dem25m_ll_c.mpr -noask"), wait=F)
>>     
> see http://geomorphometry.org/R.asp 
>
> hth,
>
> Tom Hengl
> http://spatial-analyst.net 
>
>
>
>
> -----Original Message-----
> From: r-sig-geo-bounces at stat.math.ethz.ch [mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of
> Pieter Beck
> Sent: Thursday, October 23, 2008 9:15 PM
> To: r-sig-geo at stat.math.ethz.ch
> Subject: [R-sig-Geo] subsetting
>
> Dear all,
>
> I am a new user to the world of spatial applications of R and am wondering
> about this trivial question:
>
> What is the easiest way to subset a SpatialGridDataFrame, based on 4 corner
> coordinates?
>
>  
>
> The reason I ask is that I want to do an overlay of a polygon file on a
> large raster dataset, to extract summary statistics from it. Both files are
> extremely large, however, and just applying overlay causes memory trouble. I
> was hoping to loop through the polygons, subset the SpatialGridDataFrame
> using the bounding box surrounding a polygon and then create the summary
> statistics one polygon at-a-time. To do this, I'd need to subset the
> SpatialGridDataFrame based on the bounding box corner coordinates.
>
> Thanks in advance for the help,
>
>  
>
> Kind Regards,
>
> Pieter Beck
>
>  
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de/
http://www.springer.com/978-0-387-78170-9 e.pebesma at wwu.de



From dylan.beaudette at gmail.com  Fri Oct 24 18:04:51 2008
From: dylan.beaudette at gmail.com (Dylan Beaudette)
Date: Fri, 24 Oct 2008 09:04:51 -0700
Subject: [R-sig-Geo] subsetting
In-Reply-To: <4901E8BE.1030904@uni-muenster.de>
References: <000601c93543$99115260$cb33f720$@org>
	<6ABBB60697C2447DA22A3EEFE84A6092@pcibed193>
	<4901E8BE.1030904@uni-muenster.de>
Message-ID: <3c5546140810240904j6cf57059pd75aec18e09f98e7@mail.gmail.com>

On Fri, Oct 24, 2008 at 8:24 AM, Edzer Pebesma
<edzer.pebesma at uni-muenster.de> wrote:
> Tomislav Hengl wrote:
>>
>> In GIS terms, getting a raster from one grid topology to (any) other grid
>> topology (also subgrids)
>> is referred to 'resampling' (I do not think that this is yet implemented
>> in any R package; a
>> combination of akima and spTransform will do the trick but it is not
>> really compact).

Unless there are some compelling reasons not listed, all of these
operations can be done in GRASS as well. There are no memory
constraints, and several resampling approaching built-in. Once you
have your resampled data, it is a simple matter to read in a subset
(defined by the current 'region') from GRASS into R.

I would imagine other open source GIS apps have similar functionality.
R is an excellent, multi-purpose tool-- but some operations (i.e.
resampling large grids / polygon overlays) are handily accomplished by
brute force algorithms found software like GRASS.

Cheers,

Dylan


>
> I do think so: overlay in sp is your friend:
>
> library(sp)
> data(meuse.grid)
> gridded(meuse.grid) = ~x+y
> grd = spsample(meuse.grid, n = 100, type = "regular")
> image(meuse.grid["dist"])
> points(grd, pch = 3)
>
> gridded(grd)= TRUE
> overlay(meuse.grid, grd)
> grddf = SpatialPixelsDataFrame(grd, as(meuse.grid,
> "data.frame")[overlay(meuse.grid, grd),])
> image(grddf["dist"])
> points(as(grd, "SpatialPoints"), pch = 3)
>
> Note that there is only a single code line that does the resample. If anyone
> has suggestions for a cleaner or simpler interface, or a function or method
> resample, please let me know.
>
> This of course does not do any interpolation; I consider that a different
> chapter (and package). I cannot see how spTransform could help here.When
> warping grids, you'd have to revert them first into polygons and spTransform
> them, to conserve the non-square grid cells resulting.
> --
> Edzer
>
>
>>  A generic
>> function to combine R+ILWIS to put a map to a different grid (e.g. to
>> LatLon coordinates) would be:
>>
>> # write to ILWIS:
>>
>>>
>>> writeGDAL(dem25m[1], "dem25m.mpr", "ILWIS")
>>>
>>
>> # create a new grid:
>> ...
>>
>>>
>>> gridparameters(geoarc)
>>>
>>
>> # resample the map (Bilinear) to the new geographic grid:
>>
>>>
>>> shell(cmd=paste(ILWIS, " crgrf geoarc.grf ",geoarc at grid@cells.dim[[2]],"
>>>
>>
>> ",geoarc at grid@cells.dim[[1]]," -crdsys=LatlonWGS84
>>
>> -lowleft=(",geoarc at grid@cellcentre.offset[[1]],",",geoarc at grid@cellcentre.offset[[2]],")
>> -pixsize=",geoarc at grid@cellsize[[1]],sep=""), wait=F)
>>
>>>
>>> shell(cmd=paste(ILWIS, "dem25m_ll_c.mpr = MapResample(dem25m_c.mpr,
>>> geoarc, BiLinear)"), wait=F)
>>> shell(cmd=paste(ILWIS, "open dem25m_ll_c.mpr -noask"), wait=F)
>>>
>>
>> see http://geomorphometry.org/R.asp
>> hth,
>>
>> Tom Hengl
>> http://spatial-analyst.net
>>
>>
>>
>> -----Original Message-----
>> From: r-sig-geo-bounces at stat.math.ethz.ch
>> [mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of
>> Pieter Beck
>> Sent: Thursday, October 23, 2008 9:15 PM
>> To: r-sig-geo at stat.math.ethz.ch
>> Subject: [R-sig-Geo] subsetting
>>
>> Dear all,
>>
>> I am a new user to the world of spatial applications of R and am wondering
>> about this trivial question:
>>
>> What is the easiest way to subset a SpatialGridDataFrame, based on 4
>> corner
>> coordinates?
>>
>>
>> The reason I ask is that I want to do an overlay of a polygon file on a
>> large raster dataset, to extract summary statistics from it. Both files
>> are
>> extremely large, however, and just applying overlay causes memory trouble.
>> I
>> was hoping to loop through the polygons, subset the SpatialGridDataFrame
>> using the bounding box surrounding a polygon and then create the summary
>> statistics one polygon at-a-time. To do this, I'd need to subset the
>> SpatialGridDataFrame based on the bounding box corner coordinates.
>>
>> Thanks in advance for the help,
>>
>>
>> Kind Regards,
>>
>> Pieter Beck
>>
>>
>>
>>        [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> --
> Edzer Pebesma
> Institute for Geoinformatics (ifgi), University of M?nster
> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
> 8333081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de/
> http://www.springer.com/978-0-387-78170-9 e.pebesma at wwu.de
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



From alessandro.montaghi at unifi.it  Fri Oct 24 21:45:11 2008
From: alessandro.montaghi at unifi.it (Alessandro)
Date: Fri, 24 Oct 2008 12:45:11 -0700
Subject: [R-sig-Geo] help to union two code in one
Message-ID: <000001c93611$08c3bf80$1a4b3e80$@montaghi@unifi.it>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081024/d7a8ccd5/attachment.pl>

From harryk at cal.berkeley.edu  Sun Oct 26 22:53:05 2008
From: harryk at cal.berkeley.edu (Harry Kim)
Date: Sun, 26 Oct 2008 14:53:05 -0700
Subject: [R-sig-Geo] finding the minimum distance from a point to
	SpatialLines objects
Message-ID: <91b8161f0810261453k2f514f32ua5b4285dddf73b7@mail.gmail.com>

Dear R-sig-geo users,

       I was wondering if there is a pre-written R function that
calculates the minimum distance from a point to  SpatialLines objects.

I have a european railroad shapefile which I read into R:

> class(railroad)
[1] "SpatialLinesDataFrame"
attr(,"package")
[1] "sp"

> names(railroad)
[1] "LENGTH"    "TYPE"      "LEVEL"     "NAME"      "NATION"
"CNTRYNAME" "TUNNEL"    "FLOOR"     "TONNAGE"

> slotNames(railroad)
[1] "data"        "lines"       "bbox"        "proj4string"


Using this data, I would like to search for the minimum distance from
an arbitrary point to the railroads nearby.
I could write a function that generates points  along the line from
coordinates given for each railroad segment as shown below:

> railroad at lines[[1]]@Lines
[[1]]
An object of class "Line"
Slot "coords":
       [,1]    [,2]
[1,] 8.3613 46.5359
[2,] 8.3603 46.5360
[3,] 8.3590 46.5361
[4,] 8.3578 46.5364
[5,] 8.3567 46.5365
[6,] 8.3555 46.5364
[7,] 8.3538 46.5361
[8,] 8.3524 46.5361

and find the minimum distances from a point to these multiple points.
But I would like to if there is a more intelligent way to calculate
this.
I've looked into the r-sig-geo archive and the only thing I found was
finding the minimum distance using some type of GIS software.

Thank you very much for your help in advance.

Harry



From T.Hengl at uva.nl  Mon Oct 27 16:48:14 2008
From: T.Hengl at uva.nl (Hengl, T.)
Date: Mon, 27 Oct 2008 16:48:14 +0100
Subject: [R-sig-Geo] subsetting
References: <000601c93543$99115260$cb33f720$@org>
	<6ABBB60697C2447DA22A3EEFE84A6092@pcibed193>
	<4901E8BE.1030904@uni-muenster.de>
Message-ID: <37382E8DCB905042969BA78541F6570624D60D@kwek.ic.uva.nl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081027/118f6fc4/attachment.pl>

From dylan.beaudette at gmail.com  Mon Oct 27 17:01:31 2008
From: dylan.beaudette at gmail.com (Dylan Beaudette)
Date: Mon, 27 Oct 2008 09:01:31 -0700
Subject: [R-sig-Geo] subsetting
In-Reply-To: <37382E8DCB905042969BA78541F6570624D60D@kwek.ic.uva.nl>
References: <000601c93543$99115260$cb33f720$@org>
	<4901E8BE.1030904@uni-muenster.de>
	<37382E8DCB905042969BA78541F6570624D60D@kwek.ic.uva.nl>
Message-ID: <200810270901.31169.dylan.beaudette@gmail.com>

And as a tasty GRASS-based follow-up:

the interested user can take a look at the following functions;

# change the resolution, resampling is automatic via NN
g.region
r.mapcalc "new_resampled = old_map"

# up-sample (or down-scale) via NN, bilinear, or cubic interpolation
r.resamp.interp

# down-sample (or up-scale) via block- mean, median, mode, etc.
r.resamp.stats

# coordinate transformation across projections / datums
# will also resample to new grid topology via NN, bilinear, cubic, 
# cubic-splines, etc.
r.proj

These operations can be performed from within R, via the spgrass6 package. 
FOSS GIS means lots of options for these kind of common operations on 
geographic data!

Cheers,

Dylan

On Monday 27 October 2008, Hengl, T. wrote:
> Edzer,
>
> I agree, your example is straight forward. But this is really a
> simplification of the problem, especially if you go from Cartesian to
> geographical coordinates (LatLon).
>
> This is how typically reproject+resample grids in R:
> > data(meuse.grid)
> > coordinates(meuse.grid) <- ~x+y
> > gridded(meuse.grid) <- TRUE
> > proj4string(meuse.grid) = CRS("+init=epsg:28992")
>
> # reprojection (first from grid to point map)
>
> > meuse.grid.ll <- spTransform(meuse.grid, CRS("+proj=longlat
> > +datum=WGS84"))
>
> # estimate a suitable grid cell size in the new coordinate system:
> > corrf <-
> > (1+cos((meuse.grid.ll at bbox[2,2]+meuse.grid.ll at bbox[2,1])/2*pi/180))/2 #
> > correction factor based on the latitude geogrd.cell <-
> > corrf*(meuse.grid.ll at bbox[1,2]-meuse.grid.ll at bbox[1,1])/meuse.grid at grid@c
> >ells.dim[1] geoarc <- spsample(meuse.grid.ll, type="regular",
> > cellsize=c(geogrd.cell,geogrd.cell)) gridded(geoarc) = TRUE
> > gridparameters(geoarc)
>
>    cellcentre.offset     cellsize cells.dim
> x1          5.721603 0.0004603493        96
> x2         50.956995 0.0004603493        80
>
> > gridparameters(meuse.grid)
> > grid.x <- geoarc at coords[geoarc at coords[,2]==geoarc at coords[1,2],1]
> > grid.y <- geoarc at coords[geoarc at coords[,1]==geoarc at coords[1,1],2]
>
> # bilinear resampling:
> > library(akima)
> > dist.grid.ll <- interp(x=meuse.grid.ll at coords[,1],
> > y=meuse.grid.ll at coords[,2], z=meuse.grid.ll$dist, xo=grid.x, yo=grid.y,
> > extrap=F, linear=T) dist.grid.ll <-
> > as.SpatialGridDataFrame.im(as.im(dist.grid.ll))
> > proj4string(dist.grid.ll) = CRS("+proj=longlat +datum=WGS84")
> > print(spplot(meuse.grid["dist"], scales=list(draw=T, cex=.8)),
> > split=c(1,1,2,1), more=T) print(spplot(dist.grid.ll[1],
> > scales=list(draw=T, cex=.8)), split=c(2,1,2,1), more=T)
>
> What 'interp' method of akima does is exactly what e.g. MapResample method
> in ILWIS does (except ILWIS does it in one line, but you have to get the
> data to ILWIS format first).
>
> I just remembered that one can also use SAGA GIS to reproject/resample grids 
from a coordinate system to geographic coordinates (and back) using the proj4 
module:
> > rsaga.get.modules("pj_proj4")
> > rsaga.get.usage("pj_proj4",1)
>
> ...
> SAGA CMD 2.0.3
> library path:   C:/Progra~1/saga_vc/modules
> library name:   pj_proj4
> module name :   Proj4 (Grid)
> author      :   (c) 2003 by O.Conrad
>
> Note that SAGA makes it possible to use a range of resampling techniques
> (this would allow you to do e.g. down/up-scaling):
>
> ...
>  -INTERPOLATION:<num>                  Grid Interpolation
>         Choice
>         Available Choices:
>         [0] Nearest Neigbhor
>         [1] Bilinear Interpolation
>         [2] Inverse Distance Interpolation
>         [3] Bicubic Spline Interpolation
>         [4] B-Spline Interpolation
>
> This is an example of a command that can be used to reproject/resample from 
TM to geographic grid (note that you can also leave it to SAGA to estimate 
the bounding box / new grid topology):
> > rsaga.esri.to.sgrd(in.grids="dem25m.asc", out.sgrds="dem25m.sgrd",
> > in.path=getwd()) rsaga.geoprocessor(lib="pj_proj4", module=1,
> > param=list(SOURCE="dem25m_ll.sgrd", DIRECTION=1, PROJ_TYPE=103,
> > ELLIPSOID=0, ELLPS_PREDEF=11, UNIT=1, LON_0=16.5, LAT_0=0, X_0=2500000,
> > Y_0=0, OUT_GRID="dem25m_ll.sgrd", TARGET_TYPE=0, INTERPOLATION=1,
> > GET_USER_SIZE=geoarc at grid@cellsize[[1]]))
>
> # unfortunately this does not work because I am not able to define the
> correct geodetic datum (dX, dY, dZ) for baranja hill dataset
> (http://geomorphometry.org/data.asp) in SAGA, so I get an empty grid!
>
> Unfortunately SAGA does not (yet!) support EPSG codes, so that the choice
> of coordinate systems is relatively limited.
>
>
> Tom Hengl
> http://spatial-analyst.net/wiki/index.php?title=Export_maps_to_GE
>
>
> -----Original Message-----
> From: Edzer Pebesma [mailto:edzer.pebesma at uni-muenster.de]
> Sent: Fri 24/10/2008 5:24 PM
> To: Hengl, T.
> Cc: 'Pieter Beck'; r-sig-geo at stat.math.ethz.ch
> Subject: Re: [R-sig-Geo] subsetting
>
> Tomislav Hengl wrote:
> > In GIS terms, getting a raster from one grid topology to (any) other grid
> > topology (also subgrids) is referred to 'resampling' (I do not think that
> > this is yet implemented in any R package; a combination of akima and
> > spTransform will do the trick but it is not really compact).
>
> I do think so: overlay in sp is your friend:
>
> library(sp)
> data(meuse.grid)
> gridded(meuse.grid) = ~x+y
> grd = spsample(meuse.grid, n = 100, type = "regular")
> image(meuse.grid["dist"])
> points(grd, pch = 3)
>
> gridded(grd)= TRUE
> overlay(meuse.grid, grd)
> grddf = SpatialPixelsDataFrame(grd, as(meuse.grid,
> "data.frame")[overlay(meuse.grid, grd),])
> image(grddf["dist"])
> points(as(grd, "SpatialPoints"), pch = 3)
>
> Note that there is only a single code line that does the resample. If
> anyone has suggestions for a cleaner or simpler interface, or a function
> or method resample, please let me know.
>
> This of course does not do any interpolation; I consider that a
> different chapter (and package). I cannot see how spTransform could help
> here.When warping grids, you'd have to revert them first into polygons
> and spTransform them, to conserve the non-square grid cells resulting.
> --
> Edzer
>
> >  A generic
> > function to combine R+ILWIS to put a map to a different grid (e.g. to
> > LatLon coordinates) would be:
> >
> > # write to ILWIS:
> >> writeGDAL(dem25m[1], "dem25m.mpr", "ILWIS")
> >
> > # create a new grid:
> > ...
> >
> >> gridparameters(geoarc)
> >
> > # resample the map (Bilinear) to the new geographic grid:
> >> shell(cmd=paste(ILWIS, " crgrf geoarc.grf ",geoarc at grid@cells.dim[[2]],"
> >
> > ",geoarc at grid@cells.dim[[1]]," -crdsys=LatlonWGS84
> > -lowleft=(",geoarc at grid@cellcentre.offset[[1]],",",geoarc at grid@cellcentre
> >.offset[[2]],") -pixsize=",geoarc at grid@cellsize[[1]],sep=""), wait=F)
> >
> >> shell(cmd=paste(ILWIS, "dem25m_ll_c.mpr = MapResample(dem25m_c.mpr,
> >> geoarc, BiLinear)"), wait=F) shell(cmd=paste(ILWIS, "open
> >> dem25m_ll_c.mpr -noask"), wait=F)
> >
> > see http://geomorphometry.org/R.asp
> >
> > hth,
> >
> > Tom Hengl
> > http://spatial-analyst.net
> >
> >
> >
> >
> > -----Original Message-----
> > From: r-sig-geo-bounces at stat.math.ethz.ch
> > [mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of Pieter Beck
> > Sent: Thursday, October 23, 2008 9:15 PM
> > To: r-sig-geo at stat.math.ethz.ch
> > Subject: [R-sig-Geo] subsetting
> >
> > Dear all,
> >
> > I am a new user to the world of spatial applications of R and am
> > wondering about this trivial question:
> >
> > What is the easiest way to subset a SpatialGridDataFrame, based on 4
> > corner coordinates?
> >
> >
> >
> > The reason I ask is that I want to do an overlay of a polygon file on a
> > large raster dataset, to extract summary statistics from it. Both files
> > are extremely large, however, and just applying overlay causes memory
> > trouble. I was hoping to loop through the polygons, subset the
> > SpatialGridDataFrame using the bounding box surrounding a polygon and
> > then create the summary statistics one polygon at-a-time. To do this, I'd
> > need to subset the SpatialGridDataFrame based on the bounding box corner
> > coordinates.
> >
> > Thanks in advance for the help,
> >
> >
> >
> > Kind Regards,
> >
> > Pieter Beck
> >
> >
> >
> >
> > 	[[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Dylan Beaudette
Soil Resource Laboratory
http://casoilresource.lawr.ucdavis.edu/
University of California at Davis
530.754.7341



From alessandro.montaghi at unifi.it  Mon Oct 27 19:53:23 2008
From: alessandro.montaghi at unifi.it (Alessandro)
Date: Mon, 27 Oct 2008 11:53:23 -0700
Subject: [R-sig-Geo] import sever txt files with one code in  (R+SAGA)
Message-ID: <001801c93865$4b4c3e30$e1e4ba90$@montaghi@unifi.it>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081027/c668f5c5/attachment.pl>

From tech_dev at wildintellect.com  Tue Oct 28 04:27:43 2008
From: tech_dev at wildintellect.com (Alex Mandel)
Date: Mon, 27 Oct 2008 20:27:43 -0700
Subject: [R-sig-Geo] Call for Papers - AAG 2009
Message-ID: <490686AF.40401@wildintellect.com>

--Please Pass On--
Call for Papers - "Free and Open Source Software for geographers"

The deadline to submit papers for the Association of American
Geographers(AAG) annual conference has been extended until Nov. 13, 2008.

There will be organized sessions on "Free and Open Source Software",
sponsored by the Open Source Geospatial Foundation(OSGEO) and the AAG
Cyberinfrastructure Specialty Group.

We have several sessions planned on a variety of topics, including
non-technical lightning talks with a group discussion to in depth
technical talks. For specifics of the sessions, current speaker lists
and general information please visit:
http://wiki.osgeo.org/wiki/AAG_2009#OSGeo_Sessions

We still have some spots for speakers and will create additional session
s based on demand. Please contact if you have submitted or intend to
submit so I can add you to the session listing.

Also, OSGEO will be running an exhibit booth and is soliciting for more
volunteers and sponsorship.

For more information:
AAG Conference
http://aag.org/annualmeetings/2009/index.htm
OSGeo
http://www.osgeo.org

Thank you,
Alex Mandel
tech at wildintellect.com

Geography Graduate Group
http://ggg.ucdavis.edu
Information Center for the Environment (ICE)
http://ice.ucdavis.edu
University of California, Davis



From a.ghisla at studenti.uninsubria.it  Tue Oct 28 14:56:05 2008
From: a.ghisla at studenti.uninsubria.it (Anne Ghisla)
Date: Tue, 28 Oct 2008 14:56:05 +0100
Subject: [R-sig-Geo] import sever txt files with one code in  (R+SAGA)
In-Reply-To: <001801c93865$4b4c3e30$e1e4ba90$@montaghi@unifi.it>
References: <001801c93865$4b4c3e30$e1e4ba90$@montaghi@unifi.it>
Message-ID: <1225202165.6958.7.camel@galadriel>

On Mon, 2008-10-27 at 11:53 -0700, Alessandro wrote:
> Hi All,
> 
> I have several txt files for a forest structures analysis and I wish to
> import, get coordinates and convert in shape. I need eventually if this code
> is correct:
> 
> (files name: vegetation_2.txt, vegetation_3.txt, etc.etc.)

Hello Alessandro,

may I suggest to use list.files() {base} function to pick up the files?

the code would look like:

files <- list.files(getwd(), pattern="vegetation")
for (i in files) {
# extract coordinates
coordinates(file=i, =~X+Y)
# write as shapefile
writeOGR(obj=i, <other options>, driver="ESRI Shapefile"))
}

hope this helps

Anne Ghisla
Insubria University, Varese (IT)
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081028/5cbacc67/attachment.bin>

From arnout.standaert at vito.be  Tue Oct 28 16:07:48 2008
From: arnout.standaert at vito.be (Standaert Arnout)
Date: Tue, 28 Oct 2008 16:07:48 +0100
Subject: [R-sig-Geo] Rgdal-Postgis driver on Windows
Message-ID: <C80BAC1F035B8E48B6AEA6EA8ADB9D5503D9C1E4@vitomail2.vito.local>

Hello list,

I'm currently trying to efficiently load some Postgis layers in R using
rgdal's readOGR() function. The problem is simple: the Postgis driver is
not provided in the OGR distrition used by rgdal (as shown by
ogrDrivers() ).

I'm not very familiar with the technical details, but my impression is
that rgdal should be explicitly compiled with the Postgis driver
included. Is that right? Is that the only way to get this working?
I did try to install FWTools and it does include the Postgis driver for
OGR, but rgdal seems to be using it's own OGR binaries (located in
libgdal-1.dll?), so that did not solve the problem...

Thanks a bunch for your time and advice,
Arnout

---
This e-mail, any attachments and the information it contains are confidential and meant only for the use of the addressee(s) only.  Access to this e-mail by anyone other than the addressee(s) is unauthorized.  If you are not the intended addressee (or responsible for delivery of the message to such person), you may not use, copy, distribute or deliver to anyone this message (or any part of its contents) or take any action in reliance on it.  In such case, you should destroy this message and notify the sender immediately.  If you have received this e-mail in error, please notify us immediately by e-mail or telephone and delete the e-mail from any computer.
All reasonable precautions have been taken to ensure no viruses are present in this e-mail and its attachments.  As our company cannot accept responsibility for any loss or damage arising from the use of this e-mail or attachments we recommend that you subject these to your virus checking procedures prior to use.



From celine_jouanin at yahoo.fr  Tue Oct 28 16:39:16 2008
From: celine_jouanin at yahoo.fr (Jouanin Celine)
Date: Tue, 28 Oct 2008 15:39:16 +0000 (GMT)
Subject: [R-sig-Geo] Problem with the scale of the Y-axis in the function
	points.geodata
Message-ID: <66956.51094.qm@web28610.mail.ukl.yahoo.com>

 
Dear RSig,

I have got some problems with the function points.geodata. I would like to change the scale of the Y-axis, and obtain a graph with the y
coordinates from the minimum =1963367 and maximum = 1966367.
Is it possible to change the Y-axis  in the
graphics ? 
I give you the graph I obtained with the R code, as you can see it?s difficult
to distinguish each values of each points.
 
Tanks for
your help,
C?line

Here is the code :
>Donn?es<-read.table("Data8_8.txt",h=T)
>library(geoR)

>i<-104
>Donn?es[i][is.na(Donn?es[i])]<-0
>Geodonn?es<-as.geodata(Donn?es,coords.col=190:191,data.col=i)
>summary(Geodonn?es)
Number of data points: 127 

Coordinates summary
      XGPS    YGPS
min 815162 1963367
max 827162 1966367

Distance summary
     min      max 
  250.00 12209.12 

Data summary
   Min. 1st Qu.  Median    Mean 3rd
Qu.    Max. 
  0.000   0.000   0.000   4.331  
1.000 118.000 

> plot(Geodonn?es)
>
points.geodata(Geodonn?es,xlab="",ylab="",col="grey",pt.divide="rank.proportional"
+ ,las=1,cex.lab=0.65,cex.axis=0.65,mgp=c(3.2,0.55,0.5))


      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081028/511425ff/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Graphic.pdf
Type: application/force-download
Size: 10075 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081028/511425ff/attachment.bin>

From Roger.Bivand at nhh.no  Tue Oct 28 17:37:54 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 28 Oct 2008 17:37:54 +0100 (CET)
Subject: [R-sig-Geo] Rgdal-Postgis driver on Windows
In-Reply-To: <C80BAC1F035B8E48B6AEA6EA8ADB9D5503D9C1E4@vitomail2.vito.local>
References: <C80BAC1F035B8E48B6AEA6EA8ADB9D5503D9C1E4@vitomail2.vito.local>
Message-ID: <Pine.LNX.4.64.0810281736000.1906@reclus.nhh.no>

On Tue, 28 Oct 2008, Standaert Arnout wrote:

> Hello list,
>
> I'm currently trying to efficiently load some Postgis layers in R using
> rgdal's readOGR() function. The problem is simple: the Postgis driver is
> not provided in the OGR distrition used by rgdal (as shown by
> ogrDrivers() ).
>
> I'm not very familiar with the technical details, but my impression is
> that rgdal should be explicitly compiled with the Postgis driver
> included. Is that right? Is that the only way to get this working?
> I did try to install FWTools and it does include the Postgis driver for
> OGR, but rgdal seems to be using it's own OGR binaries (located in
> libgdal-1.dll?), so that did not solve the problem...

You'll be involved in compiling if you need extra drivers. The gory 
details are at:

file.show(system.file("README.windows", package="rgdal"))

within running R and loaded rgdal. Consider using ogr2ogr from FWTools 
through system() to convert to a format for which you have a driver in 
rgdal.

Hope this helps,

Roger

>
> Thanks a bunch for your time and advice,
> Arnout
>
> ---
> This e-mail, any attachments and the information it contains are confidential and meant only for the use of the addressee(s) only.  Access to this e-mail by anyone other than the addressee(s) is unauthorized.  If you are not the intended addressee (or responsible for delivery of the message to such person), you may not use, copy, distribute or deliver to anyone this message (or any part of its contents) or take any action in reliance on it.  In such case, you should destroy this message and notify the sender immediately.  If you have received this e-mail in error, please notify us immediately by e-mail or telephone and delete the e-mail from any computer.
> All reasonable precautions have been taken to ensure no viruses are present in this e-mail and its attachments.  As our company cannot accept responsibility for any loss or damage arising from the use of this e-mail or attachments we recommend that you subject these to your virus checking procedures prior to use.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From edzer.pebesma at uni-muenster.de  Tue Oct 28 18:05:29 2008
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 28 Oct 2008 18:05:29 +0100
Subject: [R-sig-Geo] Problem with the scale of the Y-axis in the
 function points.geodata
In-Reply-To: <66956.51094.qm@web28610.mail.ukl.yahoo.com>
References: <66956.51094.qm@web28610.mail.ukl.yahoo.com>
Message-ID: <49074659.1050506@uni-muenster.de>

consider adding ylim=c(1963367, 1966367) to the plot command?
--
Edzer

Jouanin Celine wrote:
>
> Dear RSig,
>
> I have got some problems with the function points.geodata. I would 
> like to change the scale of the Y-axis, and obtain a graph with the y 
> coordinates from the minimum =1963367 and maximum = 1966367.
> Is it possible to change the Y-axis  in the graphics ?
> I give you the graph I obtained with the R code, as you can see it?s 
> difficult to distinguish each values of each points.
>
>  
>
> Tanks for your help,
>
> C?line
>
>
> Here is the code :
> >Donn?es<-read.table("Data8_8.txt",h=T)
> >library(geoR)
>
> >i<-104
> >Donn?es[i][is.na(Donn?es[i])]<-0
> >Geodonn?es<-as.geodata(Donn?es,coords.col=190:191,data.col=i)
> >summary(Geodonn?es)
> Number of data points: 127
>
> Coordinates summary
>       XGPS    YGPS
> min 815162 1963367
> max 827162 1966367
>
> Distance summary
>      min      max
>   250.00 12209.12
>
> Data summary
>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
>   0.000   0.000   0.000   4.331   1.000 118.000
>
> > plot(Geodonn?es)
> > points.geodata(Geodonn?es,xlab="",ylab="",col="grey",pt.divide="rank.proportional"
> + ,las=1,cex.lab=0.65,cex.axis=0.65,mgp=c(3.2,0.55,0.5))
>
>
> ------------------------------------------------------------------------
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de/
http://www.springer.com/978-0-387-78170-9 e.pebesma at wwu.de



From jrbouldin at ucdavis.edu  Tue Oct 28 21:35:40 2008
From: jrbouldin at ucdavis.edu (Jim Bouldin)
Date: Tue, 28 Oct 2008 13:35:40 -0700 (PDT)
Subject: [R-sig-Geo] Spatial Clustering in R
Message-ID: <200810282035.m9SKZeGM018703@xylocopa.ucdavis.edu>


I'm wondering whether any R package has the ability to perform spatial
clustering, i.e. the spatial partitioning of a data set into relatively
homogeneous polygons, based on one or more attributes of the items (similar
to what the program eCognition does).  Perhaps there is a more
statistically correct term for what I have just described, but I don't know
it.  Thanks.


Jim Bouldin, PhD
Associate in Agricultural Experiment Station
Department of Plant Sciences, UC Davis
Davis CA, 95616
530-554-1740



From Roger.Bivand at nhh.no  Tue Oct 28 21:45:46 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 28 Oct 2008 21:45:46 +0100 (CET)
Subject: [R-sig-Geo] Spatial Clustering in R
In-Reply-To: <200810282035.m9SKZeGM018703@xylocopa.ucdavis.edu>
References: <200810282035.m9SKZeGM018703@xylocopa.ucdavis.edu>
Message-ID: <Pine.LNX.4.64.0810282141530.1906@reclus.nhh.no>

On Tue, 28 Oct 2008, Jim Bouldin wrote:

>
> I'm wondering whether any R package has the ability to perform spatial
> clustering, i.e. the spatial partitioning of a data set into relatively
> homogeneous polygons, based on one or more attributes of the items (similar
> to what the program eCognition does).  Perhaps there is a more
> statistically correct term for what I have just described, but I don't know
> it.  Thanks.

You may like to look at the implementation of SKATER included in spdep 
thanks to Renato M. Assuncao and Elias T. Krainski, see ?skater. The 
underlying reference is:

      Assuncao, R. M, Neves, M. C., Camara, G. and Freitas, C. da C.
      (2006). Efficient regionalization techniques for socio-economic
      geographical units using minimum spanning trees. International
      Journal of Geographical Information Science Vol. 20, No. 7, August
      2006, 797-811

Hope this helps,

Roger

>
>
> Jim Bouldin, PhD
> Associate in Agricultural Experiment Station
> Department of Plant Sciences, UC Davis
> Davis CA, 95616
> 530-554-1740
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From dan.putler at sauder.ubc.ca  Tue Oct 28 21:53:32 2008
From: dan.putler at sauder.ubc.ca (Dan Putler)
Date: Tue, 28 Oct 2008 13:53:32 -0700
Subject: [R-sig-Geo] Spatial Clustering in R
In-Reply-To: <9367_1225226204_1225226204_200810282035.m9SKZeGM018703@xylocopa.ucdavis.edu>
References: <9367_1225226204_1225226204_200810282035.m9SKZeGM018703@xylocopa.ucdavis.edu>
Message-ID: <1225227212.7336.13.camel@whitebox>

Hi Jim,

What are the nature of the attributes of the items, are they simply
actually distances from one another, or is their some other measures of
similarity/dissimilarity (say differences in soil types)?

Dan Putler

On Tue, 2008-10-28 at 13:35 -0700, Jim Bouldin wrote:
> I'm wondering whether any R package has the ability to perform spatial
> clustering, i.e. the spatial partitioning of a data set into relatively
> homogeneous polygons, based on one or more attributes of the items (similar
> to what the program eCognition does).  Perhaps there is a more
> statistically correct term for what I have just described, but I don't know
> it.  Thanks.
> 
> 
> Jim Bouldin, PhD
> Associate in Agricultural Experiment Station
> Department of Plant Sciences, UC Davis
> Davis CA, 95616
> 530-554-1740
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
-- 
Dan Putler
Sauder School of Business
University of British Columbia



From alessandro.montaghi at unifi.it  Tue Oct 28 22:03:53 2008
From: alessandro.montaghi at unifi.it (Alessandro)
Date: Tue, 28 Oct 2008 14:03:53 -0700
Subject: [R-sig-Geo] get coordinates to multi file
Message-ID: <003601c93940$b01bc570$10535050$@montaghi@unifi.it>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081028/0fceb8e8/attachment.pl>

From dylan.beaudette at gmail.com  Tue Oct 28 22:41:40 2008
From: dylan.beaudette at gmail.com (Dylan Beaudette)
Date: Tue, 28 Oct 2008 14:41:40 -0700
Subject: [R-sig-Geo] Spatial Clustering in R
In-Reply-To: <1225227212.7336.13.camel@whitebox>
References: <9367_1225226204_1225226204_200810282035.m9SKZeGM018703@xylocopa.ucdavis.edu>
	<1225227212.7336.13.camel@whitebox>
Message-ID: <200810281441.40155.dylan.beaudette@gmail.com>

On Tuesday 28 October 2008, Dan Putler wrote:
> Hi Jim,
>
> What are the nature of the attributes of the items, are they simply
> actually distances from one another, or is their some other measures of
> similarity/dissimilarity (say differences in soil types)?
>
> Dan Putler

If that is the case here is an example:
http://casoilresource.lawr.ucdavis.edu/drupal/node/221

Cheers,

Dylan


> On Tue, 2008-10-28 at 13:35 -0700, Jim Bouldin wrote:
> > I'm wondering whether any R package has the ability to perform spatial
> > clustering, i.e. the spatial partitioning of a data set into relatively
> > homogeneous polygons, based on one or more attributes of the items
> > (similar to what the program eCognition does).  Perhaps there is a more
> > statistically correct term for what I have just described, but I don't
> > know it.  Thanks.
> >
> >
> > Jim Bouldin, PhD
> > Associate in Agricultural Experiment Station
> > Department of Plant Sciences, UC Davis
> > Davis CA, 95616
> > 530-554-1740
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Dylan Beaudette
Soil Resource Laboratory
http://casoilresource.lawr.ucdavis.edu/
University of California at Davis
530.754.7341



From jrbouldin at ucdavis.edu  Tue Oct 28 22:49:47 2008
From: jrbouldin at ucdavis.edu (Jim Bouldin)
Date: Tue, 28 Oct 2008 14:49:47 -0700 (PDT)
Subject: [R-sig-Geo] Spatial Clustering in R
Message-ID: <200810282149.m9SLnlOu018108@phaenicia.ucdavis.edu>


Hi Dan.  The attributes are not distances nor any type of
similarity/dissimilarity measure, but rather actual attributes of
individual spatially referenced items (specifically, continuous and
categorical measures of tree attributes, e.g. diameter and taxon).  Thanks.

And by the way the correct terminology appears to be either spatial
segmentation or spatial regionalization, not the "spatial clustering" that
I used in the subject line of my original post.  I don't mean to refer to
the spatial analysis of the points themselves, but rather to the ATTRIBUTES
of the items at those points.

Jim


Hi Jim,

What are the nature of the attributes of the items, are they simply
actually distances from one another, or is their some other measures of
similarity/dissimilarity (say differences in soil types)?

Dan Putler

On Tue, 2008-10-28 at 13:35 -0700, Jim Bouldin wrote:
> I'm wondering whether any R package has the ability to perform spatial
> clustering, i.e. the spatial partitioning of a data set into relatively
> homogeneous polygons, based on one or more attributes of the items (similar
> to what the program eCognition does).  Perhaps there is a more
> statistically correct term for what I have just described, but I don't know
> it.  Thanks.
> 
> 
> Jim Bouldin, PhD
> Associate in Agricultural Experiment Station
> Department of Plant Sciences, UC Davis
> Davis CA, 95616
> 530-554-1740
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
-- 
Dan Putler
Sauder School of Business
University of British Columbia



From jrbouldin at ucdavis.edu  Tue Oct 28 23:17:30 2008
From: jrbouldin at ucdavis.edu (Jim Bouldin)
Date: Tue, 28 Oct 2008 15:17:30 -0700 (PDT)
Subject: [R-sig-Geo] replying to messages at R-sig-Geo
Message-ID: <200810282217.m9SMHU6V003596@musca.ucdavis.edu>


Roger, thank you for your reply to my post--that is very much along the
lines of what I am looking for.

I cannot seem to figure out how to reply to messages properly in thresds,
so I am copying and pasting into my email program, but surely there is a
simpler way? Thanks.

Jim Bouldin



From Roger.Bivand at nhh.no  Wed Oct 29 09:08:28 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 29 Oct 2008 09:08:28 +0100 (CET)
Subject: [R-sig-Geo] replying to messages at R-sig-Geo
In-Reply-To: <200810282217.m9SMHU6V003596@musca.ucdavis.edu>
References: <200810282217.m9SMHU6V003596@musca.ucdavis.edu>
Message-ID: <Pine.LNX.4.64.0810290857580.4754@reclus.nhh.no>

On Tue, 28 Oct 2008, Jim Bouldin wrote:

>
> Roger, thank you for your reply to my post--that is very much along the
> lines of what I am looking for.
>
> I cannot seem to figure out how to reply to messages properly in thresds,
> so I am copying and pasting into my email program, but surely there is a
> simpler way? Thanks.

In principle, replying to a message in a thread should preserve the 
message headers, which contain a thread ID tag. This may vary across mail 
clients, but should be pretty robust. The "Subject:" tag does not preserve 
thread ID. Can you not simply choose to reply? Inspecting the list 
archives shows that others are not replying "in thread" - is something 
perhaps being filtered out by some mail clients or service providers?

I suggest continuing this off-list.

Roger

>
> Jim Bouldin
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From celine_jouanin at yahoo.fr  Wed Oct 29 09:53:53 2008
From: celine_jouanin at yahoo.fr (Jouanin Celine)
Date: Wed, 29 Oct 2008 08:53:53 +0000 (GMT)
Subject: [R-sig-Geo] Tr : Problem with the scale of the Y-axis in the
	function points.geodata
Message-ID: <116745.55926.qm@web28604.mail.ukl.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081029/1d4664ac/attachment.pl>

From alessandro.montaghi at unifi.it  Wed Oct 29 23:03:44 2008
From: alessandro.montaghi at unifi.it (Alessandro)
Date: Wed, 29 Oct 2008 15:03:44 -0700
Subject: [R-sig-Geo] Help with "Zonal Grid Statistics" (R+SAGA)
Message-ID: <003c01c93a12$3739b180$a5ad1480$@montaghi@unifi.it>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081029/d0915838/attachment.pl>

From greenberg at ucdavis.edu  Thu Oct 30 02:44:51 2008
From: greenberg at ucdavis.edu (Jonathan Greenberg)
Date: Wed, 29 Oct 2008 18:44:51 -0700
Subject: [R-sig-Geo] Tiled processing...
Message-ID: <49091193.5030909@ucdavis.edu>

I've recently got back into using R to perform spatial analyses, and I'm 
trying to figure out how to perform "true" tiled processing, e.g. 
controlled reading of subsets of an input file, performing a function on 
this subset, and writing the output, subset by subset, to an output file 
and, finally, setting up the appropriate "header" info (the metadata).

Using suggestions Tim Keitt and Roger Bivand gave me some years back, I 
wrote this simple code (all it should do is take an elevation geotiff 
and add 1000 to the elevations, writing the output):

***

library(rgdal)
ds1 <- GDAL.open("elev.tif")
driver <- new('GDALDriver', 'GTiff')
ds2 <- new('GDALTransientDataset', driver, nrow(ds1), ncol(ds1), type = 
"Float32")
  for (row in nrow(ds1)) {
    row
    x <- getRasterData(ds1, offset = c(row - 1, 0), region = c(1, 
ncol(ds1)))
    elevnew <- x+1000
    putRasterData(ds2, elevnew, offset = c(row - 1, 0))

  }
saveDataset(ds2, "out.tif")
closeDataset(ds2)
closeDataset(ds1)

***

Couple of issues/questions:
1) The code doesn't actually seem to work -- I get a tiny, unreadable 
TIFF out of the back of this algorithm -- what is wrong?
2) I'm actually unclear about exactly what this is doing -- am I really 
just creating a large in-memory matrix (ds2) and then writing the entire 
output image out to disk, or is this somehow writing line-by-line?  If 
the former is true, how do I modify this to write within the loop, 
rather than all-at-once?

Thanks!

--j


-- 

Jonathan A. Greenberg, PhD
Postdoctoral Scholar
Center for Spatial Technologies and Remote Sensing (CSTARS)
University of California, Davis
One Shields Avenue
The Barn, Room 250N
Davis, CA 95616
Cell: 415-794-5043
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307



From corashea at gmail.com  Thu Oct 30 06:11:08 2008
From: corashea at gmail.com (Cora Shea)
Date: Wed, 29 Oct 2008 23:11:08 -0600
Subject: [R-sig-Geo] Mapping sparse data evenly to a
	SpatialPixelsDataFrame
Message-ID: <5faa2bd0810292211x3561f55dyf6cb24f8c327a4c6@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081029/e201d0e7/attachment.pl>

From corashea at gmail.com  Thu Oct 30 06:24:30 2008
From: corashea at gmail.com (Cora Shea)
Date: Wed, 29 Oct 2008 23:24:30 -0600
Subject: [R-sig-Geo] Error in fit.variogram in gstatVariogram recalled from
	file
Message-ID: <5faa2bd0810292224g5c4c57b1u4dca669324ac58d2@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081029/fdd17bfa/attachment.pl>

From T.Hengl at uva.nl  Thu Oct 30 11:04:02 2008
From: T.Hengl at uva.nl (Hengl, T.)
Date: Thu, 30 Oct 2008 11:04:02 +0100
Subject: [R-sig-Geo] Help with "Zonal Grid Statistics" (R+SAGA)
References: <003c01c93a12$3739b180$a5ad1480$@montaghi@unifi.it>
Message-ID: <37382E8DCB905042969BA78541F6570624D618@kwek.ic.uva.nl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081030/72c6a55d/attachment.pl>

From koide at mosk.tytlabs.co.jp  Thu Oct 30 11:22:42 2008
From: koide at mosk.tytlabs.co.jp (Satoshi KOIDE)
Date: Thu, 30 Oct 2008 19:22:42 +0900
Subject: [R-sig-Geo] Checking whether SpatialPolygons includes SpatialLines
Message-ID: <49098AF2.1000002@mosk.tytlabs.co.jp>

Hi All,

I need a function which checks whether SpatialPolygons object includes
SpatialLines object.
If the polygon is convex, it is possible to use point.in.polygon(),
however, in non-convex case, it is not sufficient.
Does anyone have a good idea?

thanks,

Satoshi Koide



From edzer.pebesma at uni-muenster.de  Thu Oct 30 11:44:52 2008
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 30 Oct 2008 11:44:52 +0100
Subject: [R-sig-Geo] gstat::variogram - distance calculation is
 incorrect; kriging on sphere
In-Reply-To: <48CD649F.7070103@uni-muenster.de>
References: <48CD649F.7070103@uni-muenster.de>
Message-ID: <49099024.60306@uni-muenster.de>

Dear all,

In continuation of this thread, I've spent some time looking at kriging 
on the sphere, corrected some bugs, and need further help.

First of all, distances for covariances on the sphere were computed 
incorrectly as well in gstat, so I hope not too many people have been 
relying on this--kriging seemed to happen still in some Euclidian mode. 
The good news is that it seems to work now (gstat 0.9-53, accepted on 
CRAN). Inverse distance interpolation for spherical data seemed to work 
already.

Covariances on the sphere now work, but the models present do not 
include those specially deviced for spherical data. Can anyone provide 
me with or point me to useful, preferably simple covariance functions 
that are positive definite on the sphere? The example below seems to 
work but in certain cases without nugget the interpolation may go crazy. 
You'll need to update your sp to 0.9-27 to run it (also accepted on CRAN).

Below is an example script. It also needs the new sp and gstat versions.

library(gstat)
library(rgdal)
world = expand.grid(long=seq(-177.5,177.5,5),lat=seq(-87.5,87.5,5))
world.sp = SpatialPixels(SpatialPoints(world,CRS("+proj=longlat")))
plot(world.sp,axes=T)
pts=data.frame(long=runif(100,-180,180),lat=runif(100,-90,90),val=rnorm(100))
coordinates(pts)=~long+lat
proj4string(pts)=CRS("+proj=longlat")
points(pts,col='red')

# inverse distance interpolation on the sphere:
idw.out = idw(val~1,pts,world.sp)
image(idw.out, axes = TRUE, ylim = c(-90,90))
points(pts, pch=3)
idw.spdf = as(idw.out, "SpatialPolygonsDataFrame")
newproj = CRS("+proj=moll")
idw.spdf.moll = spTransform(idw.spdf, newproj)
spplot(idw.spdf.moll, "var1.pred",col.regions=bpy.colors(),col=0,
    sp.layout = list(sp.points, spTransform(pts, newproj), col = 'black'))

# kriging on the sphere
kr.out = krige(val~1,pts,world.sp,vgm(1, "Exp", 3000))
idw.spdf.moll$kr = kr.out[[1]]
spplot(idw.spdf.moll, "kr", col.regions=bpy.colors(), col=0,
    sp.layout = list(sp.points, spTransform(pts, newproj), col = 'black'))

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de/
http://www.springer.com/978-0-387-78170-9 e.pebesma at wwu.de

-------------- next part --------------
A non-text attachment was scrubbed...
Name: world.png
Type: image/png
Size: 22219 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081030/fbb4efe5/attachment.png>

From ashton at msu.edu  Thu Oct 30 14:46:15 2008
From: ashton at msu.edu (Ashton Shortridge)
Date: Thu, 30 Oct 2008 09:46:15 -0400
Subject: [R-sig-Geo] Tiled processing...
In-Reply-To: <49091193.5030909@ucdavis.edu>
References: <49091193.5030909@ucdavis.edu>
Message-ID: <200810300946.15750.ashton@msu.edu>

Hi Jonathan,

I use GDAL to read subsets of raster and image files, though usually I employ 
the python bindings. I don't actually have answers, but maybe ideas about how 
to get there...

> 1) The code doesn't actually seem to work -- I get a tiny, unreadable
> TIFF out of the back of this algorithm -- what is wrong?
I don't know; however, you can check to see that you are actually reading the 
data that you think you are. Insert a line like print(x) or print(elevnew) in 
the middle. If that works, then the problem is in how you are writing it.

> 2) I'm actually unclear about exactly what this is doing -- am I really
> just creating a large in-memory matrix (ds2) and then writing the entire
> output image out to disk, or is this somehow writing line-by-line?  If
> the former is true, how do I modify this to write within the loop,
> rather than all-at-once?
Yes, that is what your code seems to be doing - you are writing each line to 
an object in memory and then saving it outside of the loop as a tiff. In lots 
of batch processing you can add to a file incrementally (and therefore work 
with really large files in a memory-limited environment), but from my limited 
perspective, it doesn't appear that this is practical with gdal.

Your code therefore is not saving you lots of memory. It is saving you some - 
you don't have the entire input image in memory, just a row at a time, but 
the output is sitting there the whole time.

Another possibility might be to write small tiffs within the loop and then 
merge the tiffs, possibly (probably) outside of R, e.g. in a batch file 
employing command-line gdal.

Hope this helps, 

Ashton

On Wednesday 29 October 2008 09:44:51 pm Jonathan Greenberg wrote:
> I've recently got back into using R to perform spatial analyses, and I'm
> trying to figure out how to perform "true" tiled processing, e.g.
> controlled reading of subsets of an input file, performing a function on
> this subset, and writing the output, subset by subset, to an output file
> and, finally, setting up the appropriate "header" info (the metadata).
>
> Using suggestions Tim Keitt and Roger Bivand gave me some years back, I
> wrote this simple code (all it should do is take an elevation geotiff
> and add 1000 to the elevations, writing the output):
>
> ***
>
> library(rgdal)
> ds1 <- GDAL.open("elev.tif")
> driver <- new('GDALDriver', 'GTiff')
> ds2 <- new('GDALTransientDataset', driver, nrow(ds1), ncol(ds1), type =
> "Float32")
>   for (row in nrow(ds1)) {
>     row
>     x <- getRasterData(ds1, offset = c(row - 1, 0), region = c(1,
> ncol(ds1)))
>     elevnew <- x+1000
>     putRasterData(ds2, elevnew, offset = c(row - 1, 0))
>
>   }
> saveDataset(ds2, "out.tif")
> closeDataset(ds2)
> closeDataset(ds1)
>
> ***
>
> Couple of issues/questions:
> 1) The code doesn't actually seem to work -- I get a tiny, unreadable
> TIFF out of the back of this algorithm -- what is wrong?
> 2) I'm actually unclear about exactly what this is doing -- am I really
> just creating a large in-memory matrix (ds2) and then writing the entire
> output image out to disk, or is this somehow writing line-by-line?  If
> the former is true, how do I modify this to write within the loop,
> rather than all-at-once?
>
> Thanks!
>
> --j



-- 
Ashton Shortridge
Associate Professor			ashton at msu.edu
Dept of Geography			http://www.msu.edu/~ashton
235 Geography Building		ph (517) 432-3561
Michigan State University		fx (517) 432-1671



From brenning at uwaterloo.ca  Thu Oct 30 15:37:32 2008
From: brenning at uwaterloo.ca (Alexander Brenning)
Date: Thu, 30 Oct 2008 10:37:32 -0400
Subject: [R-sig-Geo] Tiled processing...
In-Reply-To: <49091193.5030909@ucdavis.edu>
References: <49091193.5030909@ucdavis.edu>
Message-ID: <4909C6AC.1010901@uwaterloo.ca>

Hi,

maybe the RSAGA package has the solution to your problem; there are 
actually two ways of applying functions to grids in RSAGA, (1) by 
row-by-row processing (special form of tiles), or (2) using the SAGA 
binaries.

1) local.function

local.function and focal.function are very flexible tools, but they are 
slow because they are written in R. They work with ASCII grids (see e.g. 
write.ascii.grid in RSAGA, or the appropriate GDAL export functions that 
work with your GeoTIFFs).

In your case:

local.function("ingrid", varnames = "outgrid",
      fun = function(x) x + 1000)

(or use focal.function with radius = 0). This will of course work with 
much more general R functions (even with predict methods if you look at 
grid.predict and multi.focal.function).

The RSAGA package technically depends on Windows (because most of its 
functions use SAGA GIS Windows binaries) but the local.function and 
focal.function are (supposed to be) platform-independent; I can provide 
you with the source code if you work on a non-Windows system and can't 
get it from CRAN.

2) rsaga.grid.calculus

Another approach, which involves SAGA itself and therefore (currently) 
depends on Windows, uses SAGA's grid calculator. SAGA is able to process 
large grids efficiently. E.g.:

# first convert the ASCII grid to a SAGA grid (.sgrd):
rsaga.esri.to.sgrd("ingrid")
rsaga.grid.calculus("ingrid", "outgrid", formula = "a+1000")
   # 'ingrid' is treated as 'a' in the formula
rsaga.sgrd.to.esri("outgrid", prec = 2)

I hope this helps...

Cheers
  Alex


Jonathan Greenberg wrote:
> I've recently got back into using R to perform spatial analyses, and I'm 
> trying to figure out how to perform "true" tiled processing, e.g. 
> controlled reading of subsets of an input file, performing a function on 
> this subset, and writing the output, subset by subset, to an output file 
> and, finally, setting up the appropriate "header" info (the metadata).
> 
> Using suggestions Tim Keitt and Roger Bivand gave me some years back, I 
> wrote this simple code (all it should do is take an elevation geotiff 
> and add 1000 to the elevations, writing the output):
> 
> ***
> 
> library(rgdal)
> ds1 <- GDAL.open("elev.tif")
> driver <- new('GDALDriver', 'GTiff')
> ds2 <- new('GDALTransientDataset', driver, nrow(ds1), ncol(ds1), type = 
> "Float32")
>  for (row in nrow(ds1)) {
>    row
>    x <- getRasterData(ds1, offset = c(row - 1, 0), region = c(1, 
> ncol(ds1)))
>    elevnew <- x+1000
>    putRasterData(ds2, elevnew, offset = c(row - 1, 0))
> 
>  }
> saveDataset(ds2, "out.tif")
> closeDataset(ds2)
> closeDataset(ds1)
> 
> ***
> 
> Couple of issues/questions:
> 1) The code doesn't actually seem to work -- I get a tiny, unreadable 
> TIFF out of the back of this algorithm -- what is wrong?
> 2) I'm actually unclear about exactly what this is doing -- am I really 
> just creating a large in-memory matrix (ds2) and then writing the entire 
> output image out to disk, or is this somehow writing line-by-line?  If 
> the former is true, how do I modify this to write within the loop, 
> rather than all-at-once?
> 
> Thanks!
> 
> --j
> 
> 

-- 
Alexander Brenning
brenning at uwaterloo.ca - T +1-519-888-4567 ext 35783
Department of Geography and Environmental Management
University of Waterloo
200 University Ave. W - Waterloo, ON - Canada N2L 3G1
http://www.fes.uwaterloo.ca/geography/faculty/brenning/



From jean-paul.kibambe at uclouvain.be  Thu Oct 30 19:04:09 2008
From: jean-paul.kibambe at uclouvain.be (Jean-Paul Kibambe Lubamba)
Date: Thu, 30 Oct 2008 19:04:09 +0100 (CET)
Subject: [R-sig-Geo] Implementing GWPR with R
Message-ID: <8702ac7cffaf79211cd635966fd28808.squirrel@mmp.sipr-dc.ucl.ac.be>

Hi,

I wonder if anyone know whether there is a R package for implementing a
geographically weighted poisson regression model.


Thanks in advance.


Jean-Paul



From Roger.Bivand at nhh.no  Thu Oct 30 19:15:17 2008
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 30 Oct 2008 19:15:17 +0100 (CET)
Subject: [R-sig-Geo] Implementing GWPR with R
In-Reply-To: <8702ac7cffaf79211cd635966fd28808.squirrel@mmp.sipr-dc.ucl.ac.be>
References: <8702ac7cffaf79211cd635966fd28808.squirrel@mmp.sipr-dc.ucl.ac.be>
Message-ID: <Pine.LNX.4.64.0810301914320.2855@reclus.nhh.no>

On Thu, 30 Oct 2008, Jean-Paul Kibambe Lubamba wrote:

> Hi,
>
> I wonder if anyone know whether there is a R package for implementing a
> geographically weighted poisson regression model.
>

For what it's worth, see the draft ggwr() function in the spgwr package.

Roger

>
> Thanks in advance.
>
>
> Jean-Paul
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From greenberg at ucdavis.edu  Thu Oct 30 20:17:54 2008
From: greenberg at ucdavis.edu (Jonathan Greenberg)
Date: Thu, 30 Oct 2008 12:17:54 -0700
Subject: [R-sig-Geo] Tiled processing...
In-Reply-To: <4909C6AC.1010901@uwaterloo.ca>
References: <49091193.5030909@ucdavis.edu> <4909C6AC.1010901@uwaterloo.ca>
Message-ID: <490A0862.9080506@ucdavis.edu>

Ok, I'm nearly there using only RGDAL and R-base commands, if I can get 
a bit of feedback I might have a decent tiled (row-by-row) processing 
structure worked up.  Couple of things -- first, I was mistakenly 
thinking all raster formats can even really support line-by-line 
writing, which is not neccessarily true (consider the various compressed 
image formats).  Let's assume that the user just wants a flat-binary 
type file, either ENVI or ESRI format.  We can use writebin and one of 
the writeGDAL(...,drivername='EHdr',...) or similar "header-only" write 
commands:

elev is a DEM, but it can be any raster format GDAL can read.

***

library(rgdal)
infile='elev'
outfile_base='testout'
outfile_ext='.bil'
outfile=paste(outfile_base,outfile_ext,sep='')
outcon <- file(outfile, "wb")

infile_info=GDALinfo(infile)
nl=infile_info[[1]]
ns=infile_info[[2]]

for (row in 1:nl) {
    templine <- readGDAL(infile,region.dim=c(1,ns),offset=c(row-1,0))
    writeBin(templine[[1]], outcon,size=4)
}
close(outcon)
writeGDAL(templine,outfile_base,drivername='EHdr',type="Float32")

***

Right now, this ALMOST works except, as you can see from the final line 
that the output header will incorrectly set the number of lines in the 
output to 1 (because I'm only reading one line at a time).  I'm using 
templine purely as a way to carry over the header info, it won't write 
any actual data out, as far as I know (or will it?)  How do I modify the 
"metadata" of the templine to reflect the correct "header" info (e.g. 
set the number of rows back to the total number of rows in the image, 
and reset the geographic position correctly.

--j

Alexander Brenning wrote:
> Hi,
> 
> maybe the RSAGA package has the solution to your problem; there are 
> actually two ways of applying functions to grids in RSAGA, (1) by 
> row-by-row processing (special form of tiles), or (2) using the SAGA 
> binaries.
> 
> 1) local.function
> 
> local.function and focal.function are very flexible tools, but they are 
> slow because they are written in R. They work with ASCII grids (see e.g. 
> write.ascii.grid in RSAGA, or the appropriate GDAL export functions that 
> work with your GeoTIFFs).
> 
> In your case:
> 
> local.function("ingrid", varnames = "outgrid",
>      fun = function(x) x + 1000)
> 
> (or use focal.function with radius = 0). This will of course work with 
> much more general R functions (even with predict methods if you look at 
> grid.predict and multi.focal.function).
> 
> The RSAGA package technically depends on Windows (because most of its 
> functions use SAGA GIS Windows binaries) but the local.function and 
> focal.function are (supposed to be) platform-independent; I can provide 
> you with the source code if you work on a non-Windows system and can't 
> get it from CRAN.
> 
> 2) rsaga.grid.calculus
> 
> Another approach, which involves SAGA itself and therefore (currently) 
> depends on Windows, uses SAGA's grid calculator. SAGA is able to process 
> large grids efficiently. E.g.:
> 
> # first convert the ASCII grid to a SAGA grid (.sgrd):
> rsaga.esri.to.sgrd("ingrid")
> rsaga.grid.calculus("ingrid", "outgrid", formula = "a+1000")
>   # 'ingrid' is treated as 'a' in the formula
> rsaga.sgrd.to.esri("outgrid", prec = 2)
> 
> I hope this helps...
> 
> Cheers
>  Alex
> 
> 
> Jonathan Greenberg wrote:
>> I've recently got back into using R to perform spatial analyses, and 
>> I'm trying to figure out how to perform "true" tiled processing, e.g. 
>> controlled reading of subsets of an input file, performing a function 
>> on this subset, and writing the output, subset by subset, to an output 
>> file and, finally, setting up the appropriate "header" info (the 
>> metadata).
>>
>> Using suggestions Tim Keitt and Roger Bivand gave me some years back, 
>> I wrote this simple code (all it should do is take an elevation 
>> geotiff and add 1000 to the elevations, writing the output):
>>
>> ***
>>
>> library(rgdal)
>> ds1 <- GDAL.open("elev.tif")
>> driver <- new('GDALDriver', 'GTiff')
>> ds2 <- new('GDALTransientDataset', driver, nrow(ds1), ncol(ds1), type 
>> = "Float32")
>>  for (row in nrow(ds1)) {
>>    row
>>    x <- getRasterData(ds1, offset = c(row - 1, 0), region = c(1, 
>> ncol(ds1)))
>>    elevnew <- x+1000
>>    putRasterData(ds2, elevnew, offset = c(row - 1, 0))
>>
>>  }
>> saveDataset(ds2, "out.tif")
>> closeDataset(ds2)
>> closeDataset(ds1)
>>
>> ***
>>
>> Couple of issues/questions:
>> 1) The code doesn't actually seem to work -- I get a tiny, unreadable 
>> TIFF out of the back of this algorithm -- what is wrong?
>> 2) I'm actually unclear about exactly what this is doing -- am I 
>> really just creating a large in-memory matrix (ds2) and then writing 
>> the entire output image out to disk, or is this somehow writing 
>> line-by-line?  If the former is true, how do I modify this to write 
>> within the loop, rather than all-at-once?
>>
>> Thanks!
>>
>> --j
>>
>>
> 

-- 

Jonathan A. Greenberg, PhD
Postdoctoral Scholar
Center for Spatial Technologies and Remote Sensing (CSTARS)
University of California, Davis
One Shields Avenue
The Barn, Room 250N
Davis, CA 95616
Cell: 415-794-5043
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307



From sp8ial at gmail.com  Fri Oct 31 00:12:23 2008
From: sp8ial at gmail.com (Greg Lee)
Date: Fri, 31 Oct 2008 10:12:23 +1100
Subject: [R-sig-Geo] gstat::variogram - distance calculation is
	incorrect; kriging on sphere
In-Reply-To: <49099024.60306@uni-muenster.de>
References: <48CD649F.7070103@uni-muenster.de> <49099024.60306@uni-muenster.de>
Message-ID: <54c8adaa0810301612g7203f7bds225703eb0010a601@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081031/a03a9222/attachment.pl>

From edzer.pebesma at uni-muenster.de  Fri Oct 31 08:44:35 2008
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 31 Oct 2008 08:44:35 +0100
Subject: [R-sig-Geo] gstat::variogram - distance calculation
 is	incorrect; kriging on sphere
In-Reply-To: <54c8adaa0810301612g7203f7bds225703eb0010a601@mail.gmail.com>
References: <48CD649F.7070103@uni-muenster.de> <49099024.60306@uni-muenster.de>
	<54c8adaa0810301612g7203f7bds225703eb0010a601@mail.gmail.com>
Message-ID: <490AB763.4070706@uni-muenster.de>

That's right; my fault that I sent the email and updated the sp package 
on CRAN almost at the same time. The new sp (0.9-27 would suffice) 
should now have propagated to your mirror, simply update your sp package 
again and it should work. Let me know if it doesn't.
--
Edzer

Greg Lee wrote:
> Hello Edzer,
>
> I was curious to run the example you provided (using the latest CRAN
> versions of all packages), but as written the line
>
>   
>> idw.spdf = as(idw.out, "SpatialPolygonsDataFrame")
>>     
>
> produces
>
> Error in as(idw.out, "SpatialPolygonsDataFrame") :  no method or default for
> coercing "SpatialPixelsDataFrame" to "SpatialPolygonsDataFrame"
> Regards,
> Greg.
>
>
> 2008/10/30 Edzer Pebesma <edzer.pebesma at uni-muenster.de>
>
>   
>> Dear all,
>>
>> In continuation of this thread, I've spent some time looking at kriging on
>> the sphere, corrected some bugs, and need further help.
>>
>> First of all, distances for covariances on the sphere were computed
>> incorrectly as well in gstat, so I hope not too many people have been
>> relying on this--kriging seemed to happen still in some Euclidian mode. The
>> good news is that it seems to work now (gstat 0.9-53, accepted on CRAN).
>> Inverse distance interpolation for spherical data seemed to work already.
>>
>> Covariances on the sphere now work, but the models present do not include
>> those specially deviced for spherical data. Can anyone provide me with or
>> point me to useful, preferably simple covariance functions that are positive
>> definite on the sphere? The example below seems to work but in certain cases
>> without nugget the interpolation may go crazy. You'll need to update your sp
>> to 0.9-27 to run it (also accepted on CRAN).
>>
>> Below is an example script. It also needs the new sp and gstat versions.
>>
>> library(gstat)
>> library(rgdal)
>> world = expand.grid(long=seq(-177.5,177.5,5),lat=seq(-87.5,87.5,5))
>> world.sp = SpatialPixels(SpatialPoints(world,CRS("+proj=longlat")))
>> plot(world.sp,axes=T)
>>
>> pts=data.frame(long=runif(100,-180,180),lat=runif(100,-90,90),val=rnorm(100))
>> coordinates(pts)=~long+lat
>> proj4string(pts)=CRS("+proj=longlat")
>> points(pts,col='red')
>>
>> # inverse distance interpolation on the sphere:
>> idw.out = idw(val~1,pts,world.sp)
>> image(idw.out, axes = TRUE, ylim = c(-90,90))
>> points(pts, pch=3)
>> idw.spdf = as(idw.out, "SpatialPolygonsDataFrame")
>> newproj = CRS("+proj=moll")
>> idw.spdf.moll = spTransform(idw.spdf, newproj)
>> spplot(idw.spdf.moll, "var1.pred",col.regions=bpy.colors(),col=0,
>>   sp.layout = list(sp.points, spTransform(pts, newproj), col = 'black'))
>>
>> # kriging on the sphere
>> kr.out = krige(val~1,pts,world.sp,vgm(1, "Exp", 3000))
>> idw.spdf.moll$kr = kr.out[[1]]
>> spplot(idw.spdf.moll, "kr", col.regions=bpy.colors(), col=0,
>>   sp.layout = list(sp.points, spTransform(pts, newproj), col = 'black'))
>>
>> --
>> Edzer Pebesma
>> Institute for Geoinformatics (ifgi), University of M?nster
>> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
>> 8333081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de/
>> http://www.springer.com/978-0-387-78170-9 e.pebesma at wwu.de
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>>     
>
> 	[[alternative HTML version deleted]]
>
>   
> ------------------------------------------------------------------------
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de/
http://www.springer.com/978-0-387-78170-9 e.pebesma at wwu.de



From sp8ial at gmail.com  Fri Oct 31 09:45:14 2008
From: sp8ial at gmail.com (Greg Lee)
Date: Fri, 31 Oct 2008 19:45:14 +1100
Subject: [R-sig-Geo] gstat::variogram - distance calculation is
	incorrect; kriging on sphere
In-Reply-To: <490AB763.4070706@uni-muenster.de>
References: <48CD649F.7070103@uni-muenster.de> <49099024.60306@uni-muenster.de>
	<54c8adaa0810301612g7203f7bds225703eb0010a601@mail.gmail.com>
	<490AB763.4070706@uni-muenster.de>
Message-ID: <54c8adaa0810310145m38763af6i6790239da1b6d0f7@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081031/03e3dd00/attachment.pl>

From p.hiemstra at geo.uu.nl  Fri Oct 31 10:00:43 2008
From: p.hiemstra at geo.uu.nl (Paul Hiemstra)
Date: Fri, 31 Oct 2008 10:00:43 +0100
Subject: [R-sig-Geo] Error in fit.variogram in gstatVariogram recalled
 from	file
In-Reply-To: <5faa2bd0810292224g5c4c57b1u4dca669324ac58d2@mail.gmail.com>
References: <5faa2bd0810292224g5c4c57b1u4dca669324ac58d2@mail.gmail.com>
Message-ID: <490AC93B.7010608@geo.uu.nl>

Hi Cora,

A mucht better way of storing R-objects in files is through the use of 
the save() command. The load() command is the equivalent to reload the 
file. Example in code:

vmodel = vgm(10, "Exp", 300, 4.5)
save(vmodel, file = "vmodel.rda")

# reloading the file
load("vmodel.rda")

see ?save and ?load for more details.

cheers,
Paul

Cora Shea wrote:
> Dear List,
>
> In the hopes that someone may know why, I will describe an error I get from
> fit.variogram when reading a variogram from a file.
>
> When I create a gstatVariogram object in a given R session, I can use
> fit.variogram upon it just fine via:
>   
>> temp.vgm <- variogram(z~x.coord+y.coord, temp.frame, cressie=T)
>> temp.fit <- fit.variogram(temp.vgm,v.model,fit.method=1)
>>
>>     
>
> Then, I store that same gstatVariogram object in a file via write.table:
>   
>> write.table(temp.vgm,file=file.name)
>>     
>
> And then, when I later recall it using read.table:
>   
>> temp.vgm <- read.table(file.name)
>> class(temp.vgm) <- "gstatVariogram"
>>
>>     
>
> But....then I can no longer perform the fit.variogram upon it using the
> exact same v.model.  I receive the error:
>   
>> temp.fit <- fit.variogram(temp.vgm,v.model,fit.method=1)
>>     
> Error in fit.variogram(temp.vgm, v.model, fit.method = 1) :
>         REAL() can only be applied to a 'numeric', not a 'integer'
>
> I would very much like to have these variograms in files and then use them
> later and on different computers, and I can unfortunately find no
> information on this error.
>
> Thank you for any help you can provide, and thank you for your time.
>
> Cora
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   


-- 
Drs. Paul Hiemstra
Department of Physical Geography
Faculty of Geosciences
University of Utrecht
Heidelberglaan 2
P.O. Box 80.115
3508 TC Utrecht
Phone: 	+31302535773
Fax:	+31302531145
http://intamap.geo.uu.nl/~paul



From Mikael.Carlsson at sgu.se  Fri Oct 31 10:50:39 2008
From: Mikael.Carlsson at sgu.se (Mikael Carlsson)
Date: Fri, 31 Oct 2008 10:50:39 +0100
Subject: [R-sig-Geo] Extracting data/value
Message-ID: <OF5149ED86.507646B2-ONC12574F3.002CC457-C12574F3.003621B9@sgu.se>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081031/d6c59138/attachment.pl>

From haering at lwf.uni-muenchen.de  Fri Oct 31 12:57:52 2008
From: haering at lwf.uni-muenchen.de (=?ISO-8859-1?Q?Tim_H=E4ring?=)
Date: Fri, 31 Oct 2008 12:57:52 +0100
Subject: [R-sig-Geo] Add Grid Values to Points
Message-ID: <490B00CF.19230.1162E4B@haering.lwf.uni-muenchen.de>

Hello to everybody,

I?m trying to use the SAGA tool "Add Grid Values to Points" in R using the RSAGA package 
("shapes_grid", 0) but there is an error message I can`t figure out.:

> rsaga.geoprocessor("shapes_grid",0, list(SHAPES="test.shp", GRIDS=list("slope.sgrd", 
"aspect.sgrd"), RESULT="add_grid.shp", INTERPOL=0), env=myenv)

SAGA CMD 2.0.3
library path:   C:/Programme/saga_vc/modules
library name:   shapes_grid
module name :   Add Grid Values to Points
author      :   (c) 2003 by O.Conrad

error: executing module [Add Grid Values to Points]
Usage: -silent -SHAPES <str> -GRIDS <str> -RESULT <str> [-INTERPOL <num>]
  -SHAPES:<str>         Points
        Shapes (input)
  -GRIDS:<str>          Grids
        Grid list (input)
  -RESULT:<str>         Result
        Shapes (output)
  -INTERPOL:<num>       Interpolation
        Choice
        Available Choices:
        [0] Nearest Neighbor
        [1] Bilinear Interpolation
        [2] Inverse Distance Interpolation
        [3] Bicubic Spline Interpolation
        [4] B-Spline Interpolation
'add_grid.shp' is not a correct numeric value for option 'INTERPOL'.

I can`t explain why R is trying to understand the expression "add_grid.shp" as the 
Interpolationmethod even though it is previous to the INTERPOL expression in the 
command.

Any ideas?
Thank`s a lot.

TIM

-- 
Dipl.-Geogr. Tim H?ring
Sachgebiet Standort und Bodenschutz (SG 2.1)
Bayerische Landesanstalt f?r Wald und Forstwirtschaft
Am Hochanger 11
D-85354 Freising



From brenning at uwaterloo.ca  Fri Oct 31 14:33:00 2008
From: brenning at uwaterloo.ca (Alexander Brenning)
Date: Fri, 31 Oct 2008 09:33:00 -0400
Subject: [R-sig-Geo] Add Grid Values to Points
In-Reply-To: <490B00CF.19230.1162E4B@haering.lwf.uni-muenchen.de>
References: <490B00CF.19230.1162E4B@haering.lwf.uni-muenchen.de>
Message-ID: <490B090C.1050909@uwaterloo.ca>

Hi Tim,

the most recent release of RSAGA has a wrapper function for this module 
that is called rsaga.add.grid.values.to.points; try this:

rsaga.add.grid.values.to.points("test", c("slope", "aspect"),
     "add_grid", method = "nearest.neighbour", env = myenv)

(Note that the wrapper function uses default file extensions.)

The problem with your call is that multiple file names have to be passed 
to SAGA_CMD in the form
    GRIDS=file1.sgrd;file2.sgrd;file3.sgrd
If you don't collapse the vector with semicolons, the geoprocessor will say
    GRIDS=file1.sgrd file2.sgrd file3.sgrd
and SAGA_CMD will assume that file2.sgrd is the next argument.
OK, maybe something to be changed in the next version of the 
geoprocessor, which is just a low-level workhorse.

rsaga.geoprocessor("shapes_grid", 0,
     param = list(SHAPES = "test.shp",
         GRIDS = paste(c("slope.sgrd", "aspect.sgrd"), collapse=";"),
         RESULT = "add_grid.shp", INTERPOL = 0),
     env = myenv)

I hope this helps...
   Alex


Tim H?ring wrote:
> Hello to everybody,
> 
> I?m trying to use the SAGA tool "Add Grid Values to Points" in R using the RSAGA package 
> ("shapes_grid", 0) but there is an error message I can`t figure out.:
> 
>> rsaga.geoprocessor("shapes_grid",0, list(SHAPES="test.shp", GRIDS=list("slope.sgrd", 
> "aspect.sgrd"), RESULT="add_grid.shp", INTERPOL=0), env=myenv)
> 
> SAGA CMD 2.0.3
> library path:   C:/Programme/saga_vc/modules
> library name:   shapes_grid
> module name :   Add Grid Values to Points
> author      :   (c) 2003 by O.Conrad
> 
> error: executing module [Add Grid Values to Points]
> Usage: -silent -SHAPES <str> -GRIDS <str> -RESULT <str> [-INTERPOL <num>]
>   -SHAPES:<str>         Points
>         Shapes (input)
>   -GRIDS:<str>          Grids
>         Grid list (input)
>   -RESULT:<str>         Result
>         Shapes (output)
>   -INTERPOL:<num>       Interpolation
>         Choice
>         Available Choices:
>         [0] Nearest Neighbor
>         [1] Bilinear Interpolation
>         [2] Inverse Distance Interpolation
>         [3] Bicubic Spline Interpolation
>         [4] B-Spline Interpolation
> 'add_grid.shp' is not a correct numeric value for option 'INTERPOL'.
> 
> I can`t explain why R is trying to understand the expression "add_grid.shp" as the 
> Interpolationmethod even though it is previous to the INTERPOL expression in the 
> command.
> 
> Any ideas?
> Thank`s a lot.
> 
> TIM
> 

-- 
Alexander Brenning
brenning at uwaterloo.ca - T +1-519-888-4567 ext 35783
Department of Geography and Environmental Management
University of Waterloo
200 University Ave. W - Waterloo, ON - Canada N2L 3G1
http://www.fes.uwaterloo.ca/geography/faculty/brenning/



From brenning at uwaterloo.ca  Fri Oct 31 15:02:48 2008
From: brenning at uwaterloo.ca (Alexander Brenning)
Date: Fri, 31 Oct 2008 10:02:48 -0400
Subject: [R-sig-Geo] Extracting data/value
In-Reply-To: <OF5149ED86.507646B2-ONC12574F3.002CC457-C12574F3.003621B9@sgu.se>
References: <OF5149ED86.507646B2-ONC12574F3.002CC457-C12574F3.003621B9@sgu.se>
Message-ID: <490B1008.10608@uwaterloo.ca>

Hi Mikael,

you can use some of the functions in the RSAGA package to extract values 
from a file (grid/shapefile) or data.frame and attach them to a 
data.frame with point locations.

If I may assume that 'indata' is an grid, try any of

   pick.from.ascii.grid
   pick.from.saga.grid
   rsaga.add.grid.values.to.points

(Only the latter actually uses SAGA itself, the former are independent 
of SAGA. The pick.* functions work on data.frames, the rsaga.* on files.)

I 'indata' is a shapefile, try

   pick.from.shapefile

And if 'indata' is another data.frame, try

   pick.from.points

If you choose method="krige" in the pick.* functions, this is just a 
quick-and-dirty ordinary kriging that should work without problems on 
dense point data; it would be fun to plug a more intelligent automatic 
interpolation procedure into these functions...

I hope this helps...
   Alex


Mikael Carlsson wrote:
> Dear readers,
> 
> I have one file look like
> ew;ns;cu;zn
> 1234567;7654321;23.4;13.7
> name indata
> load with read.table command
> 
> another file look like
> 2;cu;zn
> name parmlst
> also load with read.table
> 
> I want to do as follows
> 
> cu.v <- as.vector(cu)
> zn.v<- as.vector(zn)
>  
> but using a for loop, like
> 
> for (i in 1:2)
> {
> some good code for generating file name <- as.vector(some good code)
> #cu and zn in file name extracting value for cu and zn from indata
> }
> 
> 
> I have try almost everyting, using
> paste()
> noquote()
> but it won't work, can only extract cu not the value 23.4 in the as.vector 
> operation
> this 
>> noquote(paste(parmlst[[i+4]],".v",sep="")) <- 
> as.vector(eval(noquote(paste(parmlst[[i+4]]))))
> Error in noquote(paste(parmlst[[i + 4]], ".v", sep = "")) <- 
> as.vector(eval(noquote(paste(parmlst[[i +  : 
>   could not find function "noquote<-"
> - - - - - - - - - - - -
>> test.v <- as.vector(noquote(paste(parmlst[[i+4]])))
>> print(test.v)
> [1] "zn"
> when it should be 13.7
> 
> Running R 2.8.0 on Win NT
> 
> 
> Regards,
> Mikael
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 

-- 
Alexander Brenning
brenning at uwaterloo.ca - T +1-519-888-4567 ext 35783
Department of Geography and Environmental Management
University of Waterloo
200 University Ave. W - Waterloo, ON - Canada N2L 3G1
http://www.fes.uwaterloo.ca/geography/faculty/brenning/



From T.Hengl at uva.nl  Fri Oct 31 19:27:54 2008
From: T.Hengl at uva.nl (Hengl, T.)
Date: Fri, 31 Oct 2008 19:27:54 +0100
Subject: [R-sig-Geo] gstat::variogram - distance calculation isincorrect;
	kriging on sphere
References: <48CD649F.7070103@uni-muenster.de> <49099024.60306@uni-muenster.de>
	<54c8adaa0810301612g7203f7bds225703eb0010a601@mail.gmail.com>
	<490AB763.4070706@uni-muenster.de>
	<54c8adaa0810310145m38763af6i6790239da1b6d0f7@mail.gmail.com>
Message-ID: <37382E8DCB905042969BA78541F6570624D61C@kwek.ic.uva.nl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20081031/906746c3/attachment.pl>

