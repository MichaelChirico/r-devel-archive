From matteo.mattiuzzi at boku.ac.at  Wed Jul  1 12:28:46 2015
From: matteo.mattiuzzi at boku.ac.at (Matteo Mattiuzzi)
Date: Wed, 01 Jul 2015 12:28:46 +0200
Subject: [R-sig-Geo] Adding (custom) tags to a geotif
Message-ID: <5593DCFE0200002700027D24@gwia2.boku.ac.at>

Dear list,

I would like to add some meta information to a tif file. As my tif file can created by one or more source files depending on its location, I need to safe this information inside my tif.

Precisely I need to add if the specific file _could_ be created by one or two files (names of them) and then a second tag with the information of _effectively_ used source files for the creation of this file. 


Similar to the INPUTFILENAME tag in a composite eos-hdf:
gdalinfo on a MOD13Q1:
INPUTFILENAME=MOD09GQK.A2006129.h17v07.005.2008318081508.hdf, MOD09GQK.A2006130.h17v07.005.2008318122057.hdf.....

It does not necessary has to be a R solution, can also be something executed from within R (gdal, libtiff...)

(I work on a Linux system and I need it there, but portability is always preferable!)

Thanks,
Matteo
  
 


From SWalbridge at esri.com  Wed Jul  1 21:17:29 2015
From: SWalbridge at esri.com (Shaun Walbridge)
Date: Wed, 1 Jul 2015 19:17:29 +0000
Subject: [R-sig-Geo] Adding (custom) tags to a geotif
In-Reply-To: <5593DCFE0200002700027D24@gwia2.boku.ac.at>
References: <5593DCFE0200002700027D24@gwia2.boku.ac.at>
Message-ID: <D1B9B2B8.2ADFD%swalbridge@esri.com>

Assuming you're using GeoTIFF files, you could store the metadata in one
of the related metadata fields listed in the GDAL documentation [1].
These can be set in a variety of ways, such as using the gdal_translate
function within your gdalUtils package, and setting the 'mo' option
with the necessary fields:

  mo  Character. ("META-TAG=VALUE"). Passes a metadata key and value to
    set on the output dataset if possible.

Another approach would be doing something more robust with the PAM
.aux.xml files that GDAL can generate and parse [2]. For example, see
the spMetadata method of plotKML [3].

1. http://www.gdal.org/frmt_gtiff.html
2. http://www.gdal.org/classGDALPamDataset.html#_details
3. http://plotkml.r-forge.r-project.org/spMetadata.html

--
Shaun Walbridge
GIS Developer



On 7/1/15, 6:28 AM, "R-sig-Geo on behalf of Matteo Mattiuzzi"
<r-sig-geo-bounces at r-project.org on behalf of matteo.mattiuzzi at boku.ac.at>
wrote:

>Dear list,
>
>I would like to add some meta information to a tif file. As my tif file
>can created by one or more source files depending on its location, I need
>to safe this information inside my tif.
>
>Precisely I need to add if the specific file _could_ be created by one or
>two files (names of them) and then a second tag with the information of
>_effectively_ used source files for the creation of this file.
>
>
>Similar to the INPUTFILENAME tag in a composite eos-hdf:
>gdalinfo on a MOD13Q1:
>INPUTFILENAME=MOD09GQK.A2006129.h17v07.005.2008318081508.hdf,
>MOD09GQK.A2006130.h17v07.005.2008318122057.hdf.....
>
>It does not necessary has to be a R solution, can also be something
>executed from within R (gdal, libtiff...)
>
>(I work on a Linux system and I need it there, but portability is always
>preferable!)
>
>Thanks,
>Matteo
>  
> 
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From gosz at gmx.de  Thu Jul  2 11:15:56 2015
From: gosz at gmx.de (Guido Schulz)
Date: Thu, 02 Jul 2015 11:15:56 +0200
Subject: [R-sig-Geo] How to check model assumptions of a weighted
	spdep::spautolm?
Message-ID: <5595014C.4040001@gmx.de>

I would like to check the model assumptions of a weighted
spdep::spautolm model.

i.e., I would like to check if the (marginal) residuals, defined as Y -
(Signal Trend + Signal Stochastic) are homoscedastic, independent and
normal.

Unfortunately spdep::bptest.sarlm does not accept spautolm objects,
hence I cannot carry out a Breusch-Pagan test - unless there is a
workaround?

The only ideas I had so far:

- qqnorm & qqline plot of the residuals
- visual check of a map of the residuals (to identify obvious remaining
heteroscedasticity or autocorrelation)

Any suggestions?

Best,

Guido


From adeela.uaf at gmail.com  Sat Jul  4 04:57:34 2015
From: adeela.uaf at gmail.com (adeela uaf)
Date: Sat, 4 Jul 2015 07:57:34 +0500
Subject: [R-sig-Geo] Problem in geoR
Message-ID: <CABGg3O7LCfHUtEqXVe7P=Pg+W+d_ZKtEPwZpy4mZbX2XLRht1Q@mail.gmail.com>

Hi All,
I am trying to fit variogram on the elevation data used in geoR package and
running the same commands given in the book "Model Based Geostatistics"
by Diggle & Ribeiro. The commnd is:

 > plot(variog(elevation, uvec = seq(0, 5, by = 0.5)),type = "b")
 but the output message is

Error in plot.variogram(variog(elevation, uvec = seq(0, 5, by = 0.5)),  :
  type must be "c", "r", or "m".
Then I am using type="c" option but the message is:

variog: computing omnidirectional variogram
Error in xy.coords(x, y, xlabel, ylabel, log) :
  'x' and 'y' lengths differ
I am having the same problem when doing on my own data set. Can anyone
suggest me what I am doing wrong with this.
Thanks,
Adeela

	[[alternative HTML version deleted]]


From thierry.onkelinx at inbo.be  Sat Jul  4 09:09:48 2015
From: thierry.onkelinx at inbo.be (Thierry Onkelinx)
Date: Sat, 4 Jul 2015 09:09:48 +0200
Subject: [R-sig-Geo] Problem in geoR
In-Reply-To: <CABGg3O7LCfHUtEqXVe7P=Pg+W+d_ZKtEPwZpy4mZbX2XLRht1Q@mail.gmail.com>
References: <CABGg3O7LCfHUtEqXVe7P=Pg+W+d_ZKtEPwZpy4mZbX2XLRht1Q@mail.gmail.com>
Message-ID: <CAJuCY5yVCpM_xesmqkNWE06n-_FVJfmgxg=UGbEEyxRYZqHn-g@mail.gmail.com>

It would be easier for us to help you if the example is reproducible.

?
ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Research Institute for Nature and
Forest
team Biometrie & Kwaliteitszorg / team Biometrics & Quality Assurance
Kliniekstraat 25
1070 Anderlecht
Belgium

To call in the statistician after the experiment is done may be no more
than asking him to perform a post-mortem examination: he may be able to say
what the experiment died of. ~ Sir Ronald Aylmer Fisher
The plural of anecdote is not data. ~ Roger Brinner
The combination of some data and an aching desire for an answer does not
ensure that a reasonable answer can be extracted from a given body of data.
~ John Tukey
Op 4 jul. 2015 04:58 schreef "adeela uaf" <adeela.uaf at gmail.com>:

> Hi All,
> I am trying to fit variogram on the elevation data used in geoR package and
> running the same commands given in the book "Model Based Geostatistics"
> by Diggle & Ribeiro. The commnd is:
>
>  > plot(variog(elevation, uvec = seq(0, 5, by = 0.5)),type = "b")
>  but the output message is
>
> Error in plot.variogram(variog(elevation, uvec = seq(0, 5, by = 0.5)),  :
>   type must be "c", "r", or "m".
> Then I am using type="c" option but the message is:
>
> variog: computing omnidirectional variogram
> Error in xy.coords(x, y, xlabel, ylabel, log) :
>   'x' and 'y' lengths differ
> I am having the same problem when doing on my own data set. Can anyone
> suggest me what I am doing wrong with this.
> Thanks,
> Adeela
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From benweinstein2010 at gmail.com  Sun Jul  5 03:24:39 2015
From: benweinstein2010 at gmail.com (Ben Weinstein)
Date: Sat, 4 Jul 2015 18:24:39 -0700
Subject: [R-sig-Geo] Raster - rgdal Error: Failure during raster IO
Message-ID: <CAC28k7S4FjZXTD0v6QLBrg7bDYRud2=aZ4__5CMSX0ACuaB24Q@mail.gmail.com>

Hi all,

I'm getting a generic, " Error: Failure during raster IO" when trying to
crop or plot a .tif file using the raster package.

I made a markdown document showing the issue.

https://htmlpreview.github.io/?https://github.com/bw4sz/Drone/blob/master/error.html

To summarize:

I received a orthomosiac image from a collaborator that i'm reading into R.
The file was captured using a unmanned aerial vehicle and stitched in
Agisoft Photoscan, and the resulting .tif was sent to me.

The file is quite large (~4gb on disk) and at very high resolution.

When i read in using raster, everything seems fine. The extent matches the
correct location on the earth's surface.

I?ve tried over multiple computers, reading as brick/stack/raster,
reinstalling rgdal/raster, reinstalling R and playing around with the file
names.

Given the huge file size, i assume that this is has to do with memory (as
been suggested elsewhere with this error) - although checking out the task
manager, i see no memory spike (i have ~60gb memory) and it appears to be a
formatting error for gdal. I?ve tried reading direct with gdal, and that
fails, even when reading just a portion.

I worry that the because resolution has been labeled in reference to
latlong (Seconds?)  and is very small, and is approaching some rounding
error.

The metadata reads in correctly.


> r

class       : RasterLayer

band        : 1  (of  4  bands)

dimensions  : 39891, 35132, 1401450612  (nrow, ncol, ncell)

resolution  : 1.83715e-07, 1.3612e-07  (x, y)

extent      : -122.9106, -122.9042, 42.41708, 42.42251  (xmin, xmax, ymin,
ymax)

coord. ref. : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84
+towgs84=0,0,0

data source : C:\Users\Ben\Dropbox\Droning\AgisoftFull20150425_Run3.tif

names       : AgisoftFull20150425_Run3

values      : 0, 255  (min, max)


I appreciate any thoughts on the next thing to try.

Best,

Ben


Ecology and Evolution

Stony Brook University

http://benweinstein.weebly.com/

	[[alternative HTML version deleted]]


From mdsumner at gmail.com  Mon Jul  6 15:28:58 2015
From: mdsumner at gmail.com (Michael Sumner)
Date: Mon, 06 Jul 2015 13:28:58 +0000
Subject: [R-sig-Geo] Raster - rgdal Error: Failure during raster IO
In-Reply-To: <CAC28k7S4FjZXTD0v6QLBrg7bDYRud2=aZ4__5CMSX0ACuaB24Q@mail.gmail.com>
References: <CAC28k7S4FjZXTD0v6QLBrg7bDYRud2=aZ4__5CMSX0ACuaB24Q@mail.gmail.com>
Message-ID: <CAAcGz99V+fAh2iH51r8-wW2FgGMSocOqQAx_0cxJ+zhW2srkpg@mail.gmail.com>

Have you tried with the GDAL utilities? It might be be worth reporting on
what gdalinfo returns and what you get with gdal_translate, and please
report on the version/s you use. You did say 'I?ve tried reading direct
with gdal' but seems you mean 'with rgdal', which is close but also
different again since you get things into R. You might also try the
underlying R-GDAL-api with functions like GDAL.open and the "[" methods for
those objects.

It might be that you need a more recent version of GDAL, and you can
control that more easily by using GDAL directly - though it can be hard
still. It's certainly possible to build your own rgdal against a more
recent GDAL too, though it's a bit of a deep hole even in Linux.

There might be vagaries of tiling or compression causing problems so the
output of gdalinfo is relevant. I created a RGB image of the same size and
I can read one band with readGDAL fine (on Windows with the rgdal CRAN
build), though I hit memory limits if I try to read all 3 bands. I can't
reproduce your error with my own testing, but I haven't done a lot of that
either.  If you have more specifics reported by gdalinfo we could do more
targeted testing on different systems.

Cheers, Mike.

On Mon, 6 Jul 2015 at 18:32 Ben Weinstein <benweinstein2010 at gmail.com>
wrote:

> Hi all,
>
> I'm getting a generic, " Error: Failure during raster IO" when trying to
> crop or plot a .tif file using the raster package.
>
> I made a markdown document showing the issue.
>
>
> https://htmlpreview.github.io/?https://github.com/bw4sz/Drone/blob/master/error.html
>
> To summarize:
>
> I received a orthomosiac image from a collaborator that i'm reading into R.
> The file was captured using a unmanned aerial vehicle and stitched in
> Agisoft Photoscan, and the resulting .tif was sent to me.
>
> The file is quite large (~4gb on disk) and at very high resolution.
>
> When i read in using raster, everything seems fine. The extent matches the
> correct location on the earth's surface.
>
> I?ve tried over multiple computers, reading as brick/stack/raster,
> reinstalling rgdal/raster, reinstalling R and playing around with the file
> names.
>
> Given the huge file size, i assume that this is has to do with memory (as
> been suggested elsewhere with this error) - although checking out the task
> manager, i see no memory spike (i have ~60gb memory) and it appears to be a
> formatting error for gdal. I?ve tried reading direct with gdal, and that
> fails, even when reading just a portion.
>
> I worry that the because resolution has been labeled in reference to
> latlong (Seconds?)  and is very small, and is approaching some rounding
> error.
>
> The metadata reads in correctly.
>
>
> > r
>
> class       : RasterLayer
>
> band        : 1  (of  4  bands)
>
> dimensions  : 39891, 35132, 1401450612  (nrow, ncol, ncell)
>
> resolution  : 1.83715e-07, 1.3612e-07  (x, y)
>
> extent      : -122.9106, -122.9042, 42.41708, 42.42251  (xmin, xmax, ymin,
> ymax)
>
> coord. ref. : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84
> +towgs84=0,0,0
>
> data source : C:\Users\Ben\Dropbox\Droning\AgisoftFull20150425_Run3.tif
>
> names       : AgisoftFull20150425_Run3
>
> values      : 0, 255  (min, max)
>
>
> I appreciate any thoughts on the next thing to try.
>
> Best,
>
> Ben
>
>
> Ecology and Evolution
>
> Stony Brook University
>
> http://benweinstein.weebly.com/
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From Roger.Bivand at nhh.no  Mon Jul  6 15:58:53 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 6 Jul 2015 15:58:53 +0200
Subject: [R-sig-Geo] How to check model assumptions of a weighted
 spdep::spautolm?
In-Reply-To: <5595014C.4040001@gmx.de>
References: <5595014C.4040001@gmx.de>
Message-ID: <alpine.LFD.2.11.1507061557020.9413@reclus.nhh.no>

On Thu, 2 Jul 2015, Guido Schulz wrote:

> I would like to check the model assumptions of a weighted
> spdep::spautolm model.
>
> i.e., I would like to check if the (marginal) residuals, defined as Y -
> (Signal Trend + Signal Stochastic) are homoscedastic, independent and
> normal.
>
> Unfortunately spdep::bptest.sarlm does not accept spautolm objects,
> hence I cannot carry out a Breusch-Pagan test - unless there is a
> workaround?
>
> The only ideas I had so far:
>
> - qqnorm & qqline plot of the residuals
> - visual check of a map of the residuals (to identify obvious remaining
> heteroscedasticity or autocorrelation)

This is correct. The adaptation in spdep::bptest.sarlm is also untested, 
and was based on what was known when that was written. The underlying 
problem is that heteroscedasticity and spatial autocorrelation can be 
difficult to separate.

Hope this helps,

Roger

>
> Any suggestions?
>
> Best,
>
> Guido
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From paulojus at c3sl.ufpr.br  Mon Jul  6 17:09:04 2015
From: paulojus at c3sl.ufpr.br (Paulo Justiniano Ribeiro Jr)
Date: Mon, 6 Jul 2015 12:09:04 -0300 (BRT)
Subject: [R-sig-Geo] Problem in geoR
In-Reply-To: <CABGg3O7LCfHUtEqXVe7P=Pg+W+d_ZKtEPwZpy4mZbX2XLRht1Q@mail.gmail.com>
References: <CABGg3O7LCfHUtEqXVe7P=Pg+W+d_ZKtEPwZpy4mZbX2XLRht1Q@mail.gmail.com>
Message-ID: <alpine.DEB.2.10.1507061208090.439@macalan.c3sl.ufpr.br>

You example runs fine here for me with the following commands

require(geoR)
data(elevation)
plot(variog(elevation, uvec = seq(0, 5, by = 0.5)), type = "b")

Check your package version and posibly masked objects


Paulo Justiniano Ribeiro Jr
LEG (Laboratorio de Estatistica e Geoinformacao)
Universidade Federal do Parana
Caixa Postal 19.081
CEP 81.531-990
Curitiba, PR  -  Brasil
Tel: (+55) 41 3361 3573
VOIP: (+55) (41) (3361 3600) 1053 1066
Fax: (+55) 41 3361 3141
e-mail: paulojus AT  ufpr  br
http://www.leg.ufpr.br/~paulojus

On Sat, 4 Jul 2015, adeela uaf wrote:

> Hi All,
> I am trying to fit variogram on the elevation data used in geoR package and
> running the same commands given in the book "Model Based Geostatistics"
> by Diggle & Ribeiro. The commnd is:
>
> > plot(variog(elevation, uvec = seq(0, 5, by = 0.5)),type = "b")
> but the output message is
>
> Error in plot.variogram(variog(elevation, uvec = seq(0, 5, by = 0.5)),  :
>  type must be "c", "r", or "m".
> Then I am using type="c" option but the message is:
>
> variog: computing omnidirectional variogram
> Error in xy.coords(x, y, xlabel, ylabel, log) :
>  'x' and 'y' lengths differ
> I am having the same problem when doing on my own data set. Can anyone
> suggest me what I am doing wrong with this.
> Thanks,
> Adeela
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From a_lafontaine at hotmail.com  Mon Jul  6 19:38:44 2015
From: a_lafontaine at hotmail.com (Alexandre Lafontaine)
Date: Mon, 6 Jul 2015 13:38:44 -0400
Subject: [R-sig-Geo] Distance from point to specified raster cell value
Message-ID: <SNT149-W7218FEF573DDD4A5E156C5EC930@phx.gbl>


Dear members,
I am looking for a way to extract the distance from spatial points objects to the closest raster cell of a specific value. I have not a found a way to do so yet with the raster or rgeos librairies...

Something like the gDistance function in which I could specify the raster value I am interested in:


? ? ? ? ?gDistance( spatialpoints, r[r==15])


If anyone have suggestions, (it needs to be fairly quick because I have thousands of points to compute).


Any help really appreciated,


Alex Lafontaine
 		 	   		  

From strimas at zoology.ubc.ca  Mon Jul  6 20:57:20 2015
From: strimas at zoology.ubc.ca (Matt Strimas-Mackey)
Date: Mon, 6 Jul 2015 11:57:20 -0700
Subject: [R-sig-Geo] Distance from point to specified raster cell value
In-Reply-To: <SNT149-W7218FEF573DDD4A5E156C5EC930@phx.gbl>
References: <SNT149-W7218FEF573DDD4A5E156C5EC930@phx.gbl>
Message-ID: <CAHb9yCBqBKpjWjzt_95AQjN4STsk8cseN1LMNqpd+u08x+qvYQ@mail.gmail.com>

Perhaps the rasterToPoints function is what you're after:
http://www.inside-r.org/packages/cran/raster/docs/rasterToPoints

 gDistance(spatialpoints, rasterToPoints(r, fun=function(x) {x == 15}))

On Mon, Jul 6, 2015 at 10:38 AM, Alexandre Lafontaine
<a_lafontaine at hotmail.com> wrote:
>
> Dear members,
> I am looking for a way to extract the distance from spatial points objects to the closest raster cell of a specific value. I have not a found a way to do so yet with the raster or rgeos librairies...
>
> Something like the gDistance function in which I could specify the raster value I am interested in:
>
>
>          gDistance( spatialpoints, r[r==15])
>
>
> If anyone have suggestions, (it needs to be fairly quick because I have thousands of points to compute).
>
>
> Any help really appreciated,
>
>
> Alex Lafontaine
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From r.hijmans at gmail.com  Mon Jul  6 18:31:40 2015
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 6 Jul 2015 09:31:40 -0700
Subject: [R-sig-Geo] Raster - rgdal Error: Failure during raster IO
In-Reply-To: <CAC28k7S4FjZXTD0v6QLBrg7bDYRud2=aZ4__5CMSX0ACuaB24Q@mail.gmail.com>
References: <CAC28k7S4FjZXTD0v6QLBrg7bDYRud2=aZ4__5CMSX0ACuaB24Q@mail.gmail.com>
Message-ID: <CANtt_hx35nK74FqWeUqUou5A1azY0S3+VGx6Q9c_vsO8YUxr_A@mail.gmail.com>

Hi Ben,
I would not think this has to do with memory limitations. The error
message suggest that you have a bad file, and, hence, that the problem
is with the software that created the file, or with an interrupted
download.
Robert

On Sat, Jul 4, 2015 at 6:24 PM, Ben Weinstein
<benweinstein2010 at gmail.com> wrote:
> Hi all,
>
> I'm getting a generic, " Error: Failure during raster IO" when trying to
> crop or plot a .tif file using the raster package.
>
> I made a markdown document showing the issue.
>
> https://htmlpreview.github.io/?https://github.com/bw4sz/Drone/blob/master/error.html
>
> To summarize:
>
> I received a orthomosiac image from a collaborator that i'm reading into R.
> The file was captured using a unmanned aerial vehicle and stitched in
> Agisoft Photoscan, and the resulting .tif was sent to me.
>
> The file is quite large (~4gb on disk) and at very high resolution.
>
> When i read in using raster, everything seems fine. The extent matches the
> correct location on the earth's surface.
>
> I?ve tried over multiple computers, reading as brick/stack/raster,
> reinstalling rgdal/raster, reinstalling R and playing around with the file
> names.
>
> Given the huge file size, i assume that this is has to do with memory (as
> been suggested elsewhere with this error) - although checking out the task
> manager, i see no memory spike (i have ~60gb memory) and it appears to be a
> formatting error for gdal. I?ve tried reading direct with gdal, and that
> fails, even when reading just a portion.
>
> I worry that the because resolution has been labeled in reference to
> latlong (Seconds?)  and is very small, and is approaching some rounding
> error.
>
> The metadata reads in correctly.
>
>
>> r
>
> class       : RasterLayer
>
> band        : 1  (of  4  bands)
>
> dimensions  : 39891, 35132, 1401450612  (nrow, ncol, ncell)
>
> resolution  : 1.83715e-07, 1.3612e-07  (x, y)
>
> extent      : -122.9106, -122.9042, 42.41708, 42.42251  (xmin, xmax, ymin,
> ymax)
>
> coord. ref. : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84
> +towgs84=0,0,0
>
> data source : C:\Users\Ben\Dropbox\Droning\AgisoftFull20150425_Run3.tif
>
> names       : AgisoftFull20150425_Run3
>
> values      : 0, 255  (min, max)
>
>
> I appreciate any thoughts on the next thing to try.
>
> Best,
>
> Ben
>
>
> Ecology and Evolution
>
> Stony Brook University
>
> http://benweinstein.weebly.com/
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From johnwasige at gmail.com  Tue Jul  7 18:12:32 2015
From: johnwasige at gmail.com (John Wasige)
Date: Tue, 7 Jul 2015 18:12:32 +0200
Subject: [R-sig-Geo] error from lmgrid
Message-ID: <CAJgdCD7sREU=rzbANz6mtkru85kHs2jsD6v=b79EO0BYU3cL8Q@mail.gmail.com>

Dear community,

I am getting this error from lmgrid:

Error in empt[i, 1:(layers/2)] <- as.numeric(lm(mtrx[i, 1:(layers/2)] ~  :
  number of items to replace is not a multiple of replacement length


Any I dea on what could be the problem?

Thanks for your help

John

	[[alternative HTML version deleted]]


From a_lafontaine at hotmail.com  Tue Jul  7 19:56:14 2015
From: a_lafontaine at hotmail.com (Alexandre Lafontaine)
Date: Tue, 7 Jul 2015 13:56:14 -0400
Subject: [R-sig-Geo] Distance from point to specified raster cell value
In-Reply-To: <CAHb9yCBqBKpjWjzt_95AQjN4STsk8cseN1LMNqpd+u08x+qvYQ@mail.gmail.com>
References: <SNT149-W7218FEF573DDD4A5E156C5EC930@phx.gbl>,
	<CAHb9yCBqBKpjWjzt_95AQjN4STsk8cseN1LMNqpd+u08x+qvYQ@mail.gmail.com>
Message-ID: <SNT150-W77609CC13A1BB98E9CDE64EC920@phx.gbl>

Thanks Matt for the input, converting cells of interest to points was indeed an efficient and quick way to do it.

Alex


> Date: Mon, 6 Jul 2015 11:57:20 -0700
> Subject: Re: [R-sig-Geo] Distance from point to specified raster cell value
> From: strimas at zoology.ubc.ca
> To: a_lafontaine at hotmail.com
> CC: r-sig-geo at r-project.org
> 
> Perhaps the rasterToPoints function is what you're after:
> http://www.inside-r.org/packages/cran/raster/docs/rasterToPoints
> 
> gDistance(spatialpoints, rasterToPoints(r, fun=function(x) {x == 15}))
> 
> On Mon, Jul 6, 2015 at 10:38 AM, Alexandre Lafontaine
> <a_lafontaine at hotmail.com> wrote:
>>
>> Dear members,
>> I am looking for a way to extract the distance from spatial points objects to the closest raster cell of a specific value. I have not a found a way to do so yet with the raster or rgeos librairies...
>>
>> Something like the gDistance function in which I could specify the raster value I am interested in:
>>
>>
>> gDistance( spatialpoints, r[r==15])
>>
>>
>> If anyone have suggestions, (it needs to be fairly quick because I have thousands of points to compute).
>>
>>
>> Any help really appreciated,
>>
>>
>> Alex Lafontaine
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
 		 	   		  

From horning at amnh.org  Wed Jul  8 02:32:57 2015
From: horning at amnh.org (Ned Horning)
Date: Tue, 7 Jul 2015 20:32:57 -0400
Subject: [R-sig-Geo] Set output data type for projectRaster
Message-ID: <559C6FB9.9090609@amnh.org>

Hi all -

I am trying to project a raster using the projectRaster() function from 
the raster package and would like the data type for the output image to 
be the same as the data type of the input image (INT2U Landsat 8 image 
stack). For some reason I get an output data type of FLT8S, even when I 
set the resampling method to "ngb". I created some sample code to 
recreate the problem.
--
library(rgdal)
library(raster)
# create a new (not projected) RasterLayer with cellnumbers as values
r <- raster(xmn=-110, xmx=-90, ymn=40, ymx=60, ncols=40, nrows=40)
r <- setValues(r, 1:ncell(r))
dataType(r)  <- "INT2U"
dataType(r)
# proj.4 projection description
newproj <- "+proj=lcc +lat_1=48 +lat_2=33 +lon_0=-100 +ellps=WGS84"
pr1 <- projectRaster(r, crs=newproj, res=20000)
dataType(pr1)
pr2 <- projectRaster(r, crs=newproj, res=20000, method="ngb", 
filename="test.tif", dataType="INT2U", format='GTiff', overwrite=TRUE)
dataType(pr2)
--
In this example the data types are
r is INT2U
pr1 is FLT4S
pr2 is FLT8S

but I want the data type for pr2 to be "INT2U".

Is there any way to select the output data type for an image created 
using projectRaster()?

I'm using R version 3.2.1 and version 2.3-40 of the raster package.

All the best,

Ned


From loic.dutrieux at wur.nl  Wed Jul  8 09:14:13 2015
From: loic.dutrieux at wur.nl (=?windows-1252?Q?Lo=EFc_Dutrieux?=)
Date: Wed, 8 Jul 2015 09:14:13 +0200
Subject: [R-sig-Geo] Set output data type for projectRaster
In-Reply-To: <559C6FB9.9090609@amnh.org>
References: <559C6FB9.9090609@amnh.org>
Message-ID: <559CCDC5.30405@wur.nl>

Hi Ned,

dataType with capital T is the function to retrieve the data type of a 
raster object. When used as argument to set the type of a file being 
written, use datatype= (with lower case t).

Cheers,
Lo?c

On 07/08/2015 02:32 AM, Ned Horning wrote:
> Hi all -
>
> I am trying to project a raster using the projectRaster() function from
> the raster package and would like the data type for the output image to
> be the same as the data type of the input image (INT2U Landsat 8 image
> stack). For some reason I get an output data type of FLT8S, even when I
> set the resampling method to "ngb". I created some sample code to
> recreate the problem.
> --
> library(rgdal)
> library(raster)
> # create a new (not projected) RasterLayer with cellnumbers as values
> r <- raster(xmn=-110, xmx=-90, ymn=40, ymx=60, ncols=40, nrows=40)
> r <- setValues(r, 1:ncell(r))
> dataType(r)  <- "INT2U"
> dataType(r)
> # proj.4 projection description
> newproj <- "+proj=lcc +lat_1=48 +lat_2=33 +lon_0=-100 +ellps=WGS84"
> pr1 <- projectRaster(r, crs=newproj, res=20000)
> dataType(pr1)
> pr2 <- projectRaster(r, crs=newproj, res=20000, method="ngb",
> filename="test.tif", dataType="INT2U", format='GTiff', overwrite=TRUE)
> dataType(pr2)
> --
> In this example the data types are
> r is INT2U
> pr1 is FLT4S
> pr2 is FLT8S
>
> but I want the data type for pr2 to be "INT2U".
>
> Is there any way to select the output data type for an image created
> using projectRaster()?
>
> I'm using R version 3.2.1 and version 2.3-40 of the raster package.
>
> All the best,
>
> Ned
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From zivan.karaman at gmail.com  Wed Jul  8 13:25:54 2015
From: zivan.karaman at gmail.com (Zivan Karaman)
Date: Wed, 8 Jul 2015 13:25:54 +0200
Subject: [R-sig-Geo] custom axes in raster plot
Message-ID: <CAKtE6yNHEt-YuTQrfh9u8RmTNB8jHPQ5wWzD7126K6kbi_XeGA@mail.gmail.com>

Deal list,

I have a question regarding adding custom axes to raster plot.
I tried using the "axes=F" option in "plot" function (which
effectively doesn't plot axes) and then calling the "axis" function
(which unfortunately doesn't pot anything). Here's a fictitious
example:
library(raster)
r <- raster(nrows=10, ncols=10)
r <- setValues(r, 1:ncell(r))
plot(r)
plot(r, axes=F)
axis(1)
-> the last command doesn't produce any axes

while, for example,
plot(1:10, axes=F)
axis(1)
-> the last command works as expected

Any clues?
Thanks in advance.

Cheers,

Zivan


From roberto.barbetti at entecra.it  Wed Jul  8 18:04:20 2015
From: roberto.barbetti at entecra.it (roberto.barbetti at entecra.it)
Date: Wed,  8 Jul 2015 18:04:20 +0200
Subject: [R-sig-Geo] spmultinom GSIF
Message-ID: <NR6FB8$31FB52A2F55D4894B4FE5ACFD2418D4F@entecra.it>


    Dear list,

   I have a question regarding Predicting soil types using spmultinom function

   on GSIF package. At the end of the tutorial_eberg.R script we get an spatialpixeldataframe object

   eberg_sm <- spmultinom(formulaString, eberg.xy, eberg_spc at predicted)

   eberg_sm at class.c

   ## plot memberships:

   pal = seq(0, 1, 1/50)

   spplot(eberg_sm at mu, at=pal, col.regions=rev(grey(pal)))

   # classes predicted:

   Ls = length(levels(eberg_sm at predicted$soiltype))

   pnts = list("sp.points", eberg.xy, pch="+", cex=.6, col="black")

   spplot(eberg_sm at predicted, col.regions=rainbow(Ls)[rank(runif(Ls))], sp.layout=pnts)

   the information on soil type reside in eberg_sm at predicted but I can't correctly export them as asciigrid file, because every soilclass is considered as a separate band

   thanks for your help

   Roberto

	[[alternative HTML version deleted]]


From groemping at beuth-hochschule.de  Wed Jul  8 20:57:02 2015
From: groemping at beuth-hochschule.de (=?UTF-8?B?VWxyaWtlIEdyw7ZtcGluZw==?=)
Date: Wed, 8 Jul 2015 20:57:02 +0200
Subject: [R-sig-Geo] gUnaryUnion does not work on my
	SpatialPolygonsDataFrame?
Message-ID: <559D727E.5000504@beuth-hochschule.de>

Dear R-sig-Geos,

I am quite new to geographical data in R and also to shape files etc., 
and I have encountered the following difficulty: After reading a 
publicly available shape file on recent EU elections in Berlin (link 
https://www.statistik-berlin-brandenburg.de/opendata/RBS_OD_STI_EU1405.zip)
with the ReadShapePoly command, it contains the Berlin EU election 
"Stimmbezirke" (variable STI), as expected, and they can be plotted.
When using the gUnaryUnion or the gUnionCascaded function from rgeos for 
uniting several "Stimmbezirke" into the larger postal voting units 
(variable BRFW), the result is one single polygon instead of the 
expected 529 such units; plotting it shows a shape that does not explain 
itself to me.

BW_EU <- readShapePoly("RBS_OD_STI_EU1405.shp")  ## shape directory is 
working directory
plot(BW_EU)   ## plots the expected "Stimmbezirke"
BW_EU_BRFW <- gUnionCascaded(BW_EU, "BRFW")  ## gUnaryUnion does not 
make a difference
plot(BW_EU_BRFW)   ## plots only a single outline

I then tried to use gUnaryUnion with the variable STI (which I expected 
to return the unchanged polygons), which apparently returned exactly the 
same outline as the one obtained with BRFW. Presumable, I am overlooking 
something basic here, but I fail to see what. Can someone help?

Thanks in advance!
Best, Ulrike

-- 
##############################################
## Prof. Ulrike Groemping
## FB II
## Beuth University of Applied Sciences Berlin
##############################################
## prof.beuth-hochschule.de/groemping
## Phone: +49(0)30 4504 5127
## Fax:   +49(0)30 4504 66 5127
## Home office: +49(0)30 394 04 863
##############################################


From edzer.pebesma at uni-muenster.de  Wed Jul  8 21:49:55 2015
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 08 Jul 2015 21:49:55 +0200
Subject: [R-sig-Geo] gUnaryUnion does not work on my
	SpatialPolygonsDataFrame?
In-Reply-To: <559D727E.5000504@beuth-hochschule.de>
References: <559D727E.5000504@beuth-hochschule.de>
Message-ID: <559D7EE3.5060403@uni-muenster.de>

Hi Ulrike, does

require(sp)
a = aggregate(BW_EU, list(BW_EU$BRFW), dissolve = TRUE)

plot(BW_EU, border = 'grey')
plot(a, add = TRUE)

give what you want? I believe that none of the rgeos functions (can) do
anything with polygon attributes, such as BRFW.

Best regards,

On 07/08/2015 08:57 PM, Ulrike Gr?mping wrote:
> Dear R-sig-Geos,
> 
> I am quite new to geographical data in R and also to shape files etc.,
> and I have encountered the following difficulty: After reading a
> publicly available shape file on recent EU elections in Berlin (link
> https://www.statistik-berlin-brandenburg.de/opendata/RBS_OD_STI_EU1405.zip)
> with the ReadShapePoly command, it contains the Berlin EU election
> "Stimmbezirke" (variable STI), as expected, and they can be plotted.
> When using the gUnaryUnion or the gUnionCascaded function from rgeos for
> uniting several "Stimmbezirke" into the larger postal voting units
> (variable BRFW), the result is one single polygon instead of the
> expected 529 such units; plotting it shows a shape that does not explain
> itself to me.
> 
> BW_EU <- readShapePoly("RBS_OD_STI_EU1405.shp")  ## shape directory is
> working directory
> plot(BW_EU)   ## plots the expected "Stimmbezirke"
> BW_EU_BRFW <- gUnionCascaded(BW_EU, "BRFW")  ## gUnaryUnion does not
> make a difference
> plot(BW_EU_BRFW)   ## plots only a single outline
> 
> I then tried to use gUnaryUnion with the variable STI (which I expected
> to return the unchanged polygons), which apparently returned exactly the
> same outline as the one obtained with BRFW. Presumable, I am overlooking
> something basic here, but I fail to see what. Can someone help?
> 
> Thanks in advance!
> Best, Ulrike
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi),  University of M?nster,
Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
Journal of Statistical Software:   http://www.jstatsoft.org/
Computers & Geosciences:   http://elsevier.com/locate/cageo/
Spatial Statistics Society http://www.spatialstatistics.info

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150708/a62492b9/attachment.bin>

From rway024 at uottawa.ca  Thu Jul  9 00:36:48 2015
From: rway024 at uottawa.ca (Robert Way)
Date: Wed, 8 Jul 2015 18:36:48 -0400
Subject: [R-sig-Geo] Reply to: Spatial interpolation using thin plate spline
 [fields] through time
Message-ID: <CALxJZ4DLTHu65-81zpiueKjP6PUQjJnrpR9=YMhho0-GxYNgXQ@mail.gmail.com>

This is a reply to a prior post I had written here:
https://stat.ethz.ch/pipermail/r-sig-geo/2014-December/022082.html

The solution to the problem mentioned is to create a data frame which has
the to-be-interpolated measurements organized in columns per time step
corresponding to the independent x-variables. This code will allow an
individual to reuse the same independent variables (x position, y position,
elevation) with changing measurements at each time step in a loop. The loop
uses an input DEM to interpolate and output a .geotiff at each time step.

Below the rough code required for this type of thin plate spline
implementation is described. A cleaned up and fully commented version will
be made available as a supplemental to the following publication when it is
accepted:

Way, R.G., Lewkowicz, A.G. and Bonnaventure, P.P. Creating high-resolution
gridded air temperature and degree-day maps for the Labrador-Ungava region
of northern Canada. To be submitted to International Journal of Climatology.


### Load packages (not all required) ###
library(fields)
library(raster)
library(spatial.tools)
library(gdalUtils)
library(rgdal)
library(gstat)

### Use all computer resources ###
sfQuickInit()

### Load Independent X-Data ###
xdata <- file.choose()
x <- read.csv(xdata, TRUE, ",")

### Load Dependent Y-Data organized by time step ###
ydata <- file.choose()
y <- read.csv(ydata, TRUE, ",")

### Load elevation data ###
elev <- raster("elev.tif")

### Loop ###
### Make sure to set up name and appropriate file path ###
### This takes a while - Status Bar may be a good add-on ###

for (i in 1:(ncol(y))){

fit <- Tps(x, y[,i])
result <- interpolate(elev,fit, xyOnly=FALSE)
myfile <- file.path("...",
paste0("Name", "_", i, ".tif"))
writeRaster(result, myfile, overwrite=TRUE)
}

sfQuickStop()

-- 



*Robert WayB.A., M.Sc., PhD StudentUniversity of Ottawa*

	[[alternative HTML version deleted]]


From groemping at beuth-hochschule.de  Thu Jul  9 07:18:03 2015
From: groemping at beuth-hochschule.de (=?UTF-8?B?VWxyaWtlIEdyw7ZtcGluZw==?=)
Date: Thu, 9 Jul 2015 07:18:03 +0200
Subject: [R-sig-Geo] gUnaryUnion does not work on my
	SpatialPolygonsDataFrame?
In-Reply-To: <559D727E.5000504@beuth-hochschule.de>
References: <559D727E.5000504@beuth-hochschule.de>
Message-ID: <559E040B.5040604@beuth-hochschule.de>

Hi Edzer,

thanks a lot. In fact, a does contain what I want (but see also below).
gUnionCascaded or gUnaryUnion should have worked as well though; they 
did work in a similar situation combining smaller voting areas from 
German elections into larger administrative regions; as BRFW is a column 
in the @data slot of BW_EU, I expected this to work.

When using the aggregate method for the BW_EU, the only downside is that 
it creates a lot of NA columns with a lot of warnings, because the @data 
slot contains several non-numeric variables and the aggregation function 
is mean. Seeing this, I tried to make use of it by using the aggregation 
at a later step, changing the function to sum so that I would have 
aggregated numbers of votes. However, with FUN=sum, the aggregate step 
refused to work, because it complained about character arguments. 
Obviously this is inherent in the sum or mean functions, which react 
differently to character arguments. User comfort for the aggregate 
method would increase if it would apply the respective functions to 
those columns where it makes sense, but that's of course ambitious ...

The gUnion functions take a very conservative approach and do not 
include any of the data - the result is not even a 
SpatialPolygonsDataFrame object any more. Also not very nice ...

I think I will delete all character columns except BRFW and use 
aggregate with sum ...
But I would still like to understand why gUnaryUnion works with the one 
but not with the other file.

Best,
Ulrike

#############################################
## Edzer answered
Hi Ulrike, does

require(sp)
a = aggregate(BW_EU, list(BW_EU$BRFW), dissolve = TRUE)

plot(BW_EU, border = 'grey')
plot(a, add = TRUE)

give what you want? I believe that none of the rgeos functions (can) do
anything with polygon attributes, such as BRFW.

Best regards,

Am 08.07.2015 um 20:57 schrieb Ulrike Gr?mping:
> Dear R-sig-Geos,
>
> I am quite new to geographical data in R and also to shape files etc., 
> and I have encountered the following difficulty: After reading a 
> publicly available shape file on recent EU elections in Berlin (link 
> https://www.statistik-berlin-brandenburg.de/opendata/RBS_OD_STI_EU1405.zip)
> with the ReadShapePoly command, it contains the Berlin EU election 
> "Stimmbezirke" (variable STI), as expected, and they can be plotted.
> When using the gUnaryUnion or the gUnionCascaded function from rgeos 
> for uniting several "Stimmbezirke" into the larger postal voting units 
> (variable BRFW), the result is one single polygon instead of the 
> expected 529 such units; plotting it shows a shape that does not 
> explain itself to me.
>
> BW_EU <- readShapePoly("RBS_OD_STI_EU1405.shp")  ## shape directory is 
> working directory
> plot(BW_EU)   ## plots the expected "Stimmbezirke"
> BW_EU_BRFW <- gUnionCascaded(BW_EU, "BRFW")  ## gUnaryUnion does not 
> make a difference
> plot(BW_EU_BRFW)   ## plots only a single outline
>
> I then tried to use gUnaryUnion with the variable STI (which I 
> expected to return the unchanged polygons), which apparently returned 
> exactly the same outline as the one obtained with BRFW. Presumable, I 
> am overlooking something basic here, but I fail to see what. Can 
> someone help?
>
> Thanks in advance!
> Best, Ulrike
>


-- 
##############################################
## Prof. Dr. Ulrike Groemping
## FB II
## Beuth University of Applied Sciences Berlin
##############################################
## prof.beuth-hochschule.de/groemping
## Phone: +49(0)30 4504 5127
## Fax:   +49(0)30 4504 66 5127
## Home office: +49(0)30 394 04 863
##############################################


From edzer.pebesma at uni-muenster.de  Thu Jul  9 21:02:28 2015
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 09 Jul 2015 21:02:28 +0200
Subject: [R-sig-Geo] gUnaryUnion does not work on my
	SpatialPolygonsDataFrame?
In-Reply-To: <559E040B.5040604@beuth-hochschule.de>
References: <559D727E.5000504@beuth-hochschule.de>
	<559E040B.5040604@beuth-hochschule.de>
Message-ID: <559EC544.1000904@uni-muenster.de>



On 07/09/2015 07:18 AM, Ulrike Gr?mping wrote:
> Hi Edzer,
> 
> thanks a lot. In fact, a does contain what I want (but see also below).
> gUnionCascaded or gUnaryUnion should have worked as well though; they
> did work in a similar situation combining smaller voting areas from
> German elections into larger administrative regions; as BRFW is a column
> in the @data slot of BW_EU, I expected this to work.
> 
> When using the aggregate method for the BW_EU, the only downside is that
> it creates a lot of NA columns with a lot of warnings, because the @data
> slot contains several non-numeric variables and the aggregation function
> is mean. Seeing this, I tried to make use of it by using the aggregation
> at a later step, changing the function to sum so that I would have
> aggregated numbers of votes. However, with FUN=sum, the aggregate step
> refused to work, because it complained about character arguments.
> Obviously this is inherent in the sum or mean functions, which react
> differently to character arguments. User comfort for the aggregate
> method would increase if it would apply the respective functions to
> those columns where it makes sense, but that's of course ambitious ...

aggregate(BW_EU, list(BW_EU$BRFW), FUN = function(x) x[1], dissolve = TRUE)

works for factor data. This use of sp::aggregate, where the aggregation
predicate (by) comes from the attributes, is modelled after (and largely
copied from) stats::aggregate.data.frame.

> 
> The gUnion functions take a very conservative approach and do not
> include any of the data - the result is not even a
> SpatialPolygonsDataFrame object any more. Also not very nice ...
> 
> I think I will delete all character columns except BRFW and use
> aggregate with sum ...
> But I would still like to understand why gUnaryUnion works with the one
> but not with the other file.

g = gUnaryUnion(BW_EU, BW_EU$BRFW)

was what you want, and might be the form you used earlier.

> 
> Best,
> Ulrike
> 
> #############################################
> ## Edzer answered
> Hi Ulrike, does
> 
> require(sp)
> a = aggregate(BW_EU, list(BW_EU$BRFW), dissolve = TRUE)
> 
> plot(BW_EU, border = 'grey')
> plot(a, add = TRUE)
> 
> give what you want? I believe that none of the rgeos functions (can) do
> anything with polygon attributes, such as BRFW.
> 
> Best regards,
> 
> Am 08.07.2015 um 20:57 schrieb Ulrike Gr?mping:
>> Dear R-sig-Geos,
>>
>> I am quite new to geographical data in R and also to shape files etc.,
>> and I have encountered the following difficulty: After reading a
>> publicly available shape file on recent EU elections in Berlin (link
>> https://www.statistik-berlin-brandenburg.de/opendata/RBS_OD_STI_EU1405.zip)
>>
>> with the ReadShapePoly command, it contains the Berlin EU election
>> "Stimmbezirke" (variable STI), as expected, and they can be plotted.
>> When using the gUnaryUnion or the gUnionCascaded function from rgeos
>> for uniting several "Stimmbezirke" into the larger postal voting units
>> (variable BRFW), the result is one single polygon instead of the
>> expected 529 such units; plotting it shows a shape that does not
>> explain itself to me.
>>
>> BW_EU <- readShapePoly("RBS_OD_STI_EU1405.shp")  ## shape directory is
>> working directory
>> plot(BW_EU)   ## plots the expected "Stimmbezirke"
>> BW_EU_BRFW <- gUnionCascaded(BW_EU, "BRFW")  ## gUnaryUnion does not
>> make a difference
>> plot(BW_EU_BRFW)   ## plots only a single outline
>>
>> I then tried to use gUnaryUnion with the variable STI (which I
>> expected to return the unchanged polygons), which apparently returned
>> exactly the same outline as the one obtained with BRFW. Presumable, I
>> am overlooking something basic here, but I fail to see what. Can
>> someone help?
>>
>> Thanks in advance!
>> Best, Ulrike
>>
> 
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi),  University of M?nster,
Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
Journal of Statistical Software:   http://www.jstatsoft.org/
Computers & Geosciences:   http://elsevier.com/locate/cageo/
Spatial Statistics Society http://www.spatialstatistics.info

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150709/c209d688/attachment.bin>

From thi_veloso at yahoo.com.br  Fri Jul 10 02:22:45 2015
From: thi_veloso at yahoo.com.br (Thiago V. dos Santos)
Date: Fri, 10 Jul 2015 00:22:45 +0000 (UTC)
Subject: [R-sig-Geo] Detect and summarize changes in categorical raster
Message-ID: <734325432.2273849.1436487765521.JavaMail.yahoo@mail.yahoo.com>

Hi all,

I am trying to detect and summarize changes in categorical rasters.


I have two rasters. Each raster is a land use map, with values ranging from 1 to 15 and representing different land-use classes. r1 is my control scenario, and r2 is my climate change scenario where changes in climate induce changes in land use classes.

Here is some example data:

## scratch a raster brick with 120 timesteps (10 years)
r2 <- r1 <- brick(nrows=18, ncols=36, xmn=0, xmx=18, ymn=0, ymx=36, nl=120)

## fill some random values
set.seed(4)
r1[] <- round(runif(18 * 36 * 120, min=1, max=15), digits=0)

set.seed(5)
r2[] <- round(runif(18 * 36 * 120, min=1, max=15), digits=0)



What I would like to do is for each time step (brick layer), compare each cell of r2 relative to r1 in this way:
 - is the value different? yes/no
 - if yes, what was the change? for example 1 to 10, or 2 to 7 and so on.

By the end, I would like to be able to:
  - plot a map showing the occurence of changes
  - have a table with the frequency of changes in each class (i.e. 1 to 10, 2 to 7 etc)

Is there any tool to perform this analysis in R? Which one?

If no, what would be the best approach to implement that by myself?
 Thanks in advance,
--
Thiago V. dos Santos
PhD student
Land and Atmospheric Science
University of Minnesota
http://www.laas.umn.edu/CurrentStudents/MeettheStudents/ThiagodosSantos/index.htm
Phone: (612) 323 9898


From luca.candeloro at gmail.com  Fri Jul 10 11:59:38 2015
From: luca.candeloro at gmail.com (Luca Candeloro)
Date: Fri, 10 Jul 2015 11:59:38 +0200
Subject: [R-sig-Geo] spsample
Message-ID: <CAHF6Ynka=-fnuQE-yMZ+Ax8nPia8SxjFEQ_+1dVLmj=Mz63bOA@mail.gmail.com>

Hi,
following the example found in SpeciesDistributionModelling, a given number
of points is drawn randomly within a circle:

x <- circles(pts, d=50000, lonlat=T, col='light gray')
# sample randomly from all circles
> samp1 <- spsample(x at polygons, 250, type='random', iter=25)

Is there a way to specify weigths decreasing from the circle center, so
that random points are most likely near it?

thanks ,
Luca

	[[alternative HTML version deleted]]


From macqueen1 at llnl.gov  Fri Jul 10 17:23:08 2015
From: macqueen1 at llnl.gov (MacQueen, Don)
Date: Fri, 10 Jul 2015 15:23:08 +0000
Subject: [R-sig-Geo] spsample
In-Reply-To: <CAHF6Ynka=-fnuQE-yMZ+Ax8nPia8SxjFEQ_+1dVLmj=Mz63bOA@mail.gmail.com>
References: <CAHF6Ynka=-fnuQE-yMZ+Ax8nPia8SxjFEQ_+1dVLmj=Mz63bOA@mail.gmail.com>
Message-ID: <D1C52FEC.13112B%macqueen1@llnl.gov>

I'm not so deeply familiar with spsample that I know of a way to do this
directly.

However, I think it would be pretty easy to use spsample to first obtain
more points than needed, then calculate all the distances from the center,
then use the base::sample function to select a weighted sample, with
weights based on the distance from the center (see the prob argument to
sample).

-Don


-- 
Don MacQueen

Lawrence Livermore National Laboratory
7000 East Ave., L-627
Livermore, CA 94550
925-423-1062





On 7/10/15, 2:59 AM, "R-sig-Geo on behalf of Luca Candeloro"
<r-sig-geo-bounces at r-project.org on behalf of luca.candeloro at gmail.com>
wrote:

>Hi,
>following the example found in SpeciesDistributionModelling, a given
>number
>of points is drawn randomly within a circle:
>
>x <- circles(pts, d=50000, lonlat=T, col='light gray')
># sample randomly from all circles
>> samp1 <- spsample(x at polygons, 250, type='random', iter=25)
>
>Is there a way to specify weigths decreasing from the circle center, so
>that random points are most likely near it?
>
>thanks ,
>Luca
>
>	[[alternative HTML version deleted]]
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From tephilippi at gmail.com  Fri Jul 10 19:23:19 2015
From: tephilippi at gmail.com (Tom Philippi)
Date: Fri, 10 Jul 2015 10:23:19 -0700
Subject: [R-sig-Geo] spsample
In-Reply-To: <D1C52FEC.13112B%macqueen1@llnl.gov>
References: <CAHF6Ynka=-fnuQE-yMZ+Ax8nPia8SxjFEQ_+1dVLmj=Mz63bOA@mail.gmail.com>
	<D1C52FEC.13112B%macqueen1@llnl.gov>
Message-ID: <CALyPt8wa23iR5OC3e_0tKx4xAjcxDaXQSavZPXYjwJULHUnNhA@mail.gmail.com>

If you're really sampling (continuous) points in a circle, you can do what
you want by sampling in polar coordinates, then converting to Cartesian if
necessary.  You presumably want uniform direction (2*pi*runif()).  If your
overall circle has radius R, if you draw radius r from a pdf prob ~ r^2 you
get uniform area probability.  If you make that some function less steep
than r^2 you will have greater sample intensity closer to the center.

That is a very general approach, because you did not specify how much more
likely you want points to be near the center.

I hope that this helps...

Tom 2

On Fri, Jul 10, 2015 at 8:23 AM, MacQueen, Don <macqueen1 at llnl.gov> wrote:

> I'm not so deeply familiar with spsample that I know of a way to do this
> directly.
>
> However, I think it would be pretty easy to use spsample to first obtain
> more points than needed, then calculate all the distances from the center,
> then use the base::sample function to select a weighted sample, with
> weights based on the distance from the center (see the prob argument to
> sample).
>
> -Don
>
>
> --
> Don MacQueen
>
> Lawrence Livermore National Laboratory
> 7000 East Ave., L-627
> Livermore, CA 94550
> 925-423-1062
>
>
>
>
>
> On 7/10/15, 2:59 AM, "R-sig-Geo on behalf of Luca Candeloro"
> <r-sig-geo-bounces at r-project.org on behalf of luca.candeloro at gmail.com>
> wrote:
>
> >Hi,
> >following the example found in SpeciesDistributionModelling, a given
> >number
> >of points is drawn randomly within a circle:
> >
> >x <- circles(pts, d=50000, lonlat=T, col='light gray')
> ># sample randomly from all circles
> >> samp1 <- spsample(x at polygons, 250, type='random', iter=25)
> >
> >Is there a way to specify weigths decreasing from the circle center, so
> >that random points are most likely near it?
> >
> >thanks ,
> >Luca
> >
> >       [[alternative HTML version deleted]]
> >
> >_______________________________________________
> >R-sig-Geo mailing list
> >R-sig-Geo at r-project.org
> >https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From javajimburke at gmail.com  Fri Jul 10 20:17:33 2015
From: javajimburke at gmail.com (Jim Burke)
Date: Fri, 10 Jul 2015 13:17:33 -0500
Subject: [R-sig-Geo] Clip a SpatialLinesDataFrame
Message-ID: <CALkjiFQvSqHYfRs4iCWr=8gF4rzPp5dBEU4J+yn+GO9WvVpLyQ@mail.gmail.com>

Clipping a SpatialLinesDataFrame by an envelope "SpatialPolygons" results
in a bare bones "SpatialLines" with no "@data" slot. The "out" file is a
roads file which plots fine but has no road names available.

My question is how to restore nontopogical attribute information, such as
"@data", from the original large SpatialLinesDataFrame? .

in_df <-readOGR(dsn="new.shp", layer="new", verbose = TRUE)
env = gEnvelope( neighborhood_sp, byid=FALSE, id = NULL)  # neighborhood_sp
is class "SpatialPolygonsDataFrame"
out <- gIntersection(in_df, env, byid=TRUE) #works quite quickly

Additional information

The out class "SpatialLines"
> getSLLinesIDSlots(out)
   [1] "3239 1"   "3240 1"   "3543 1"   "7405 1"   "7406 1"   "7407 1"
   [7] "7408 1"   "7409 1"   "7410 1"   "7411 1"   "7412 1"   "7413 1"
  [13] "7424 1"   "7425 1"   "7426 1"   "7427 1"   "7428 1"   "7429 1"
> str(out)
Formal class 'SpatialLines' [package "sp"] with 3 slots
  ..@ lines      :List of 5870
  .. ..$ :Formal class 'Lines' [package "sp"] with 2 slots
  .. .. .. ..@ Lines:List of 1
  .. .. .. .. ..$ :Formal class 'Line' [package "sp"] with 1 slot
  .. .. .. .. .. .. ..@ coords: num [1:5, 1:2] 2499508 2499546 2499545
2499542 2499540 ...
  .. .. .. .. .. .. .. ..- attr(*, "dimnames")=List of 2
  .. .. .. .. .. .. .. .. ..$ : NULL
  .. .. .. .. .. .. .. .. ..$ : chr [1:2] "x" "y"
  .. .. .. ..@ ID   : chr "3239 1"
  .. ..$ :Formal class 'Lines' [package "sp"] with 2 slots
  .. .. .. ..@ Lines:List of 1
  .. .. .. .. ..$ :Formal class 'Line' [package "sp"] with 1 slot
  .. .. .. .. .. .. ..@ coords: num [1:2, 1:2] 2499506 2499508 7023664
7023801

The in_df class "SpatialLinesDataFrame"
> head(In_df at data, n = 12)
    DC_ID Prefix Pretype        Name Type Suffix           Class
 Label
0  843772   <NA>    <NA>    Freeport Pkwy   <NA>  Minor Arterial  Freeport
Pkwy
1  843773   <NA>    <NA>    Freeport Pkwy   <NA>  Minor Arterial  Freeport
Pkwy
2  844139   <NA>    STHY         183 <NA>      E Primary Highway    Airport
Fwy

Let me know if you want additional information.

Thanks in advance
Jim Burke

	[[alternative HTML version deleted]]


From r.hijmans at gmail.com  Sat Jul 11 01:53:28 2015
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Fri, 10 Jul 2015 16:53:28 -0700
Subject: [R-sig-Geo] Clip a SpatialLinesDataFrame
In-Reply-To: <CALkjiFQvSqHYfRs4iCWr=8gF4rzPp5dBEU4J+yn+GO9WvVpLyQ@mail.gmail.com>
References: <CALkjiFQvSqHYfRs4iCWr=8gF4rzPp5dBEU4J+yn+GO9WvVpLyQ@mail.gmail.com>
Message-ID: <CANtt_hyKvfZ2Pv7raezF7FPko+dR2rUtj_uDLrEx5eRYgQhSvw@mail.gmail.com>

Jim
You can try

library(raster)
x <- crop(roads, polygons)

Robert

On Fri, Jul 10, 2015 at 11:17 AM, Jim Burke <javajimburke at gmail.com> wrote:
> Clipping a SpatialLinesDataFrame by an envelope "SpatialPolygons" results
> in a bare bones "SpatialLines" with no "@data" slot. The "out" file is a
> roads file which plots fine but has no road names available.
>
> My question is how to restore nontopogical attribute information, such as
> "@data", from the original large SpatialLinesDataFrame? .
>
> in_df <-readOGR(dsn="new.shp", layer="new", verbose = TRUE)
> env = gEnvelope( neighborhood_sp, byid=FALSE, id = NULL)  # neighborhood_sp
> is class "SpatialPolygonsDataFrame"
> out <- gIntersection(in_df, env, byid=TRUE) #works quite quickly
>
> Additional information
>
> The out class "SpatialLines"
>> getSLLinesIDSlots(out)
>    [1] "3239 1"   "3240 1"   "3543 1"   "7405 1"   "7406 1"   "7407 1"
>    [7] "7408 1"   "7409 1"   "7410 1"   "7411 1"   "7412 1"   "7413 1"
>   [13] "7424 1"   "7425 1"   "7426 1"   "7427 1"   "7428 1"   "7429 1"
>> str(out)
> Formal class 'SpatialLines' [package "sp"] with 3 slots
>   ..@ lines      :List of 5870
>   .. ..$ :Formal class 'Lines' [package "sp"] with 2 slots
>   .. .. .. ..@ Lines:List of 1
>   .. .. .. .. ..$ :Formal class 'Line' [package "sp"] with 1 slot
>   .. .. .. .. .. .. ..@ coords: num [1:5, 1:2] 2499508 2499546 2499545
> 2499542 2499540 ...
>   .. .. .. .. .. .. .. ..- attr(*, "dimnames")=List of 2
>   .. .. .. .. .. .. .. .. ..$ : NULL
>   .. .. .. .. .. .. .. .. ..$ : chr [1:2] "x" "y"
>   .. .. .. ..@ ID   : chr "3239 1"
>   .. ..$ :Formal class 'Lines' [package "sp"] with 2 slots
>   .. .. .. ..@ Lines:List of 1
>   .. .. .. .. ..$ :Formal class 'Line' [package "sp"] with 1 slot
>   .. .. .. .. .. .. ..@ coords: num [1:2, 1:2] 2499506 2499508 7023664
> 7023801
>
> The in_df class "SpatialLinesDataFrame"
>> head(In_df at data, n = 12)
>     DC_ID Prefix Pretype        Name Type Suffix           Class
>  Label
> 0  843772   <NA>    <NA>    Freeport Pkwy   <NA>  Minor Arterial  Freeport
> Pkwy
> 1  843773   <NA>    <NA>    Freeport Pkwy   <NA>  Minor Arterial  Freeport
> Pkwy
> 2  844139   <NA>    STHY         183 <NA>      E Primary Highway    Airport
> Fwy
>
> Let me know if you want additional information.
>
> Thanks in advance
> Jim Burke
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From erich.subs at neuwirth.priv.at  Sat Jul 11 13:53:08 2015
From: erich.subs at neuwirth.priv.at (Erich Subscriptions)
Date: Sat, 11 Jul 2015 13:53:08 +0200
Subject: [R-sig-Geo] Changing projection
Message-ID: <44C2FD15-8809-4143-AC22-2CF906F4C051@neuwirth.priv.at>


I got hold of a map of Austria as shp file.
The projection is
MGI Austria Lambert.
I need to convert this to standard lon/lat.
What is the easiest way to do this within R?


From erich.subs at neuwirth.priv.at  Sat Jul 11 14:19:00 2015
From: erich.subs at neuwirth.priv.at (Erich Subscriptions)
Date: Sat, 11 Jul 2015 14:19:00 +0200
Subject: [R-sig-Geo] Changing projection
In-Reply-To: <44C2FD15-8809-4143-AC22-2CF906F4C051@neuwirth.priv.at>
References: <44C2FD15-8809-4143-AC22-2CF906F4C051@neuwirth.priv.at>
Message-ID: <E0AD6A21-6A20-48ED-AB3A-6FA7A04EAAF4@neuwirth.priv.at>

I forgot:
I was told the projection is
MGI Austria Lambert.


> On Jul 11, 2015, at 13:53, Erich Subscriptions <erich.subs at neuwirth.priv.at> wrote:
> 
> 
> I got hold of a map of Austria as shp file.
> The projection is
> MGI Austria Lambert.
> I need to convert this to standard lon/lat.
> What is the easiest way to do this within R?
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From jonathan at mazamascience.com  Sat Jul 11 19:16:39 2015
From: jonathan at mazamascience.com (Jonathan Callahan)
Date: Sat, 11 Jul 2015 10:16:39 -0700
Subject: [R-sig-Geo] Changing projection
In-Reply-To: <E0AD6A21-6A20-48ED-AB3A-6FA7A04EAAF4@neuwirth.priv.at>
References: <44C2FD15-8809-4143-AC22-2CF906F4C051@neuwirth.priv.at>
	<E0AD6A21-6A20-48ED-AB3A-6FA7A04EAAF4@neuwirth.priv.at>
Message-ID: <CAPjNR=TEDyt=eSzwuFBP-t0ivvqEh1pj7-ZzNSRN==iMjwGEUg@mail.gmail.com>

The MazamaSpatialUtils package has a number of scripts that convert
shapefiles into SpatialPolygonsDataFrames. It also contains a
convertLayer() function that does precisely what you are describing with
the following lines:

  # Load the shapefiles
  data_projected <- rgdal::readOGR(dsn=dsn, layer=layerName,
stringsAsFactors=FALSE)

  # Reproject to standard projection
  SPDF <- sp::spTransform(data_projected, sp::CRS("+proj=longlat
+ellps=GRS80 +datum=NAD83 +no_defs"))

Alternatively, you could use the package's convertGADM() function to
automatically create a shape file of Austria in the package "standard
projection" with:

convertGADM(countryCode='AT', admLevel=1)
loadSpatialData('GADM_AT_1')

Or, if you want Austrian provinces:

convertGADM(countryCode='AT', admLevel=2)
loadSpatialData('GADM_AT_2')


Viel Gl?ck mit ?sterreichischer Kartenherstellung!

Jon

On Sat, Jul 11, 2015 at 5:19 AM, Erich Subscriptions <
erich.subs at neuwirth.priv.at> wrote:

> I forgot:
> I was told the projection is
> MGI Austria Lambert.
>
>
> > On Jul 11, 2015, at 13:53, Erich Subscriptions <
> erich.subs at neuwirth.priv.at> wrote:
> >
> >
> > I got hold of a map of Austria as shp file.
> > The projection is
> > MGI Austria Lambert.
> > I need to convert this to standard lon/lat.
> > What is the easiest way to do this within R?
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Jonathan Callahan, PhD
Mazama Science
206-708-5028
mazamascience.com

	[[alternative HTML version deleted]]


From hp.iitb at gmail.com  Sun Jul 12 15:52:18 2015
From: hp.iitb at gmail.com (Harsh Pensi)
Date: Sun, 12 Jul 2015 19:22:18 +0530
Subject: [R-sig-Geo] Generating heat map on google based on values
Message-ID: <CAM1O49qnxr_-gPXG=WuvjL-1OUvtkAiTJeni1JY8RMeLrF+L3w@mail.gmail.com>

Hello

Given a set of geographic coordinates and values associated with those
points, i want to interpolate data and generate heat map on google maps
with colors based on the values. Can you guide me to some R examples that
achieve this? I have to create this from scratch...the data I have is like
->
latitude ; longitude ; value ; color(i can provide the color input at these
points if required from another application).

I am trying to generate something like this ->
http://www.caliper.com/Graphics/maptitude-analysis-hot-spot-heat-mapping.jpg

I have looked at the examples in Rgooglemaps and ggplot2 packages but none
of them seem to give such an output.

Kindly guide me regarding this.

Thanks and Regards
Harsh

	[[alternative HTML version deleted]]


From jazzpriestess2000 at yahoo.com  Sun Jul 12 19:08:36 2015
From: jazzpriestess2000 at yahoo.com (joke atuge)
Date: Sun, 12 Jul 2015 17:08:36 +0000 (UTC)
Subject: [R-sig-Geo] creating STFDF or ST objects in R
Message-ID: <1143289752.681787.1436720916728.JavaMail.yahoo@mail.yahoo.com>

Hello,
 I am having serious issues creating a space time object with a list of spatialpolygonsdataframes and their dates/ time. I keep getting an error about the time not changing. How can I get this done please? Here's a sample of my data:

[[1]]
class       : SpatialPolygonsDataFrame 
features    : 128 
extent      : -127.44, -67.8964, 1.000039, 31.71804  (xmin, xmax, ymin,  ymax)
coord. ref. : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0 
variables   : 1
names       : DDD.LFRP 
min values  :     16.6 
max values  :    488.5 

[[2]]
class       : SpatialPolygonsDataFrame 
features    : 126 
extent      : -129.04, -67.8964, 3.759985, 31.71804  (xmin, xmax, ymin,  ymax)
coord. ref. : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0 
variables   : 1
names       : DDD.LFRP 
min values  :       14 
max values  :    335.2
The Time variables look like this:
Timex
 [1] "2008-12-01 04:00:00 GMT" "2008-12-01 06:30:00 GMT"

I have a list of 3,000 and the aim is to structure these spatialpolygons 
dataframe in such a way that I can have monthly aggregates.
?How do I create an STFDF or STIDF, please? I can convert to rasters and agregate but they are of varying extents and resolutions for each time.
Kind regards,
Ajoke

	[[alternative HTML version deleted]]


From Ashraf.Afana at 3dlasermapping.com  Sun Jul 12 19:22:31 2015
From: Ashraf.Afana at 3dlasermapping.com (Ashraf Afana)
Date: Sun, 12 Jul 2015 17:22:31 +0000
Subject: [R-sig-Geo] Assign values of empty matrix to a raster layer in R
Message-ID: <VI1PR04MB1151BE28C8E7753198E300D2AF9D0@VI1PR04MB1151.eurprd04.prod.outlook.com>

Hi,
I'm trying to apply a conditional statement to three raster layers using the following function:

Con = function (condition, trueValue, falseValue){
  return(condition*trueValue + (!condition)*falseValue)
}

A priori I've generated an empty matrix (r4) that match the other two raster layers. Also, I've converted the three rasters to matrix (r1, r2 & r3).
I've create the conditional matrix (mCon):
mCon = as.matrix(Con1(r2< 2, r1, Con1(r2>1, r3, 0)))
Everything works perfectly. However, when I try to assign values mCon to the empty matrix (r4), I always get the following error message:
(Error in (function (classes, fdef, mtable):
unable to find an inherited method for function 'values<-' for signature '"matrix"')

Any suggestions of this error and how to sort this out?
Thanks
Ashraf,



	[[alternative HTML version deleted]]


From edzer.pebesma at uni-muenster.de  Sun Jul 12 20:58:38 2015
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sun, 12 Jul 2015 20:58:38 +0200
Subject: [R-sig-Geo] creating STFDF or ST objects in R
In-Reply-To: <1143289752.681787.1436720916728.JavaMail.yahoo@mail.yahoo.com>
References: <1143289752.681787.1436720916728.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <55A2B8DE.8060509@uni-muenster.de>



On 07/12/2015 07:08 PM, joke atuge via R-sig-Geo wrote:
> Hello,
>  I am having serious issues creating a space time object with a list of spatialpolygonsdataframes and their dates/ time. I keep getting an error about the time not changing. How can I get this done please? Here's a sample of my data:
> 
> [[1]]
> class       : SpatialPolygonsDataFrame 
> features    : 128 
> extent      : -127.44, -67.8964, 1.000039, 31.71804  (xmin, xmax, ymin,  ymax)
> coord. ref. : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0 
> variables   : 1
> names       : DDD.LFRP 
> min values  :     16.6 
> max values  :    488.5 
> 
> [[2]]
> class       : SpatialPolygonsDataFrame 
> features    : 126 
> extent      : -129.04, -67.8964, 3.759985, 31.71804  (xmin, xmax, ymin,  ymax)
> coord. ref. : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0 
> variables   : 1
> names       : DDD.LFRP 
> min values  :       14 
> max values  :    335.2
> The Time variables look like this:
> Timex
>  [1] "2008-12-01 04:00:00 GMT" "2008-12-01 06:30:00 GMT"
> 
> I have a list of 3,000 and the aim is to structure these spatialpolygons 
> dataframe in such a way that I can have monthly aggregates.
>  How do I create an STFDF or STIDF, please? I can convert to rasters and agregate but they are of varying extents and resolutions for each time.
> Kind regards,
> Ajoke
> 

Please tell the list more what your data are about, what your problem
is, what you have tried so far, and explain why that did not work.
-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi),  University of M?nster,
Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
Journal of Statistical Software:   http://www.jstatsoft.org/
Computers & Geosciences:   http://elsevier.com/locate/cageo/
Spatial Statistics Society http://www.spatialstatistics.info

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150712/a9931138/attachment.bin>

From jazzpriestess2000 at yahoo.com  Sun Jul 12 22:16:03 2015
From: jazzpriestess2000 at yahoo.com (joke atuge)
Date: Sun, 12 Jul 2015 20:16:03 +0000 (UTC)
Subject: [R-sig-Geo] creating STFDF or ST objects in R
In-Reply-To: <1143289752.681787.1436720916728.JavaMail.yahoo@mail.yahoo.com>
References: <1143289752.681787.1436720916728.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <1382343278.704438.1436732163985.JavaMail.yahoo@mail.yahoo.com>

Hello,?This is in addition to my earlier message. Here's the sample codes oh how I tried to create the STFDF. DLF is a list of variables called "FRP"? for each polygon in the DL3 list. Timex is the time list for the spatial polygons list.?
DL7 <- sapply(1:length(DL3), function(i) {
? x <- DL3[[i]]
x$FRP <- DLF[[i]]
?x$datetime<-Timex[i]
?z<-Timex[i]
? p<-STIDF(x,data=x["FRP"],x$datetime,delta(x$datetime))
? p})

The error I get is:?Error in augment.with.one(as.POSIXct(x)) : 
? cannot derive time interval from length 1 or constant sequence?
Kind regards,Ajoke

      On Sunday, July 12, 2015 6:08 PM, joke atuge <jazzpriestess2000 at yahoo.com> wrote:
   

 Hello,
 I am having serious issues creating a space time object with a list of spatialpolygonsdataframes and their dates/ time. I keep getting an error about the time not changing. How can I get this done please? Here's a sample of my data:

[[1]]
class       : SpatialPolygonsDataFrame 
features    : 128 
extent      : -127.44, -67.8964, 1.000039, 31.71804  (xmin, xmax, ymin,  ymax)
coord. ref. : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0 
variables   : 1
names       : DDD.LFRP 
min values  :     16.6 
max values  :    488.5 

[[2]]
class       : SpatialPolygonsDataFrame 
features    : 126 
extent      : -129.04, -67.8964, 3.759985, 31.71804  (xmin, xmax, ymin,  ymax)
coord. ref. : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0 
variables   : 1
names       : DDD.LFRP 
min values  :       14 
max values  :    335.2
The Time variables look like this:
Timex
 [1] "2008-12-01 04:00:00 GMT" "2008-12-01 06:30:00 GMT"

I have a list of 3,000 and the aim is to structure these spatialpolygons 
dataframe in such a way that I can have monthly aggregates.
?How do I create an STFDF or STIDF, please? I can convert to rasters and agregate but they are of varying extents and resolutions for each time.
Kind regards,
Ajoke


   
	[[alternative HTML version deleted]]


From edzer.pebesma at uni-muenster.de  Sun Jul 12 23:20:07 2015
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sun, 12 Jul 2015 23:20:07 +0200
Subject: [R-sig-Geo] creating STFDF or ST objects in R
In-Reply-To: <1382343278.704438.1436732163985.JavaMail.yahoo@mail.yahoo.com>
References: <1143289752.681787.1436720916728.JavaMail.yahoo@mail.yahoo.com>
	<1382343278.704438.1436732163985.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <55A2DA07.1080606@uni-muenster.de>



On 07/12/2015 10:16 PM, joke atuge via R-sig-Geo wrote:
> Hello, This is in addition to my earlier message. Here's the sample codes oh how I tried to create the STFDF. DLF is a list of variables called "FRP"  for each polygon in the DL3 list. Timex is the time list for the spatial polygons list. 
> DL7 <- sapply(1:length(DL3), function(i) {
>   x <- DL3[[i]]
> x$FRP <- DLF[[i]]
>  x$datetime<-Timex[i]
>  z<-Timex[i]
>   p<-STIDF(x,data=x["FRP"],x$datetime,delta(x$datetime))
>   p})
> 
> The error I get is: Error in augment.with.one(as.POSIXct(x)) : 
>   cannot derive time interval from length 1 or constant sequence 

x$datetime has length 1; the docs of delta() tell you that it requires
an argument of length 2 or larger. Maybe you can specify endTime to
STIDF, e.g. as x$datetime, possibly a constant added to it.

> Kind regards,Ajoke
> 
>       On Sunday, July 12, 2015 6:08 PM, joke atuge <jazzpriestess2000 at yahoo.com> wrote:
>    
> 
>  Hello,
>  I am having serious issues creating a space time object with a list of spatialpolygonsdataframes and their dates/ time. I keep getting an error about the time not changing. How can I get this done please? Here's a sample of my data:
> 
> [[1]]
> class       : SpatialPolygonsDataFrame 
> features    : 128 
> extent      : -127.44, -67.8964, 1.000039, 31.71804  (xmin, xmax, ymin,  ymax)
> coord. ref. : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0 
> variables   : 1
> names       : DDD.LFRP 
> min values  :     16.6 
> max values  :    488.5 
> 
> [[2]]
> class       : SpatialPolygonsDataFrame 
> features    : 126 
> extent      : -129.04, -67.8964, 3.759985, 31.71804  (xmin, xmax, ymin,  ymax)
> coord. ref. : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0 
> variables   : 1
> names       : DDD.LFRP 
> min values  :       14 
> max values  :    335.2
> The Time variables look like this:
> Timex
>  [1] "2008-12-01 04:00:00 GMT" "2008-12-01 06:30:00 GMT"
> 
> I have a list of 3,000 and the aim is to structure these spatialpolygons 
> dataframe in such a way that I can have monthly aggregates.
>  How do I create an STFDF or STIDF, please? I can convert to rasters and agregate but they are of varying extents and resolutions for each time.
> Kind regards,
> Ajoke
> 
> 
>    
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi),  University of M?nster,
Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
Journal of Statistical Software:   http://www.jstatsoft.org/
Computers & Geosciences:   http://elsevier.com/locate/cageo/
Spatial Statistics Society http://www.spatialstatistics.info

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150712/a7391be1/attachment.bin>

From johnbaums at gmail.com  Mon Jul 13 01:00:20 2015
From: johnbaums at gmail.com (John Baumgartner)
Date: Mon, 13 Jul 2015 09:00:20 +1000
Subject: [R-sig-Geo] Assign values of empty matrix to a raster layer in R
In-Reply-To: <VI1PR04MB1151BE28C8E7753198E300D2AF9D0@VI1PR04MB1151.eurprd04.prod.outlook.com>
References: <VI1PR04MB1151BE28C8E7753198E300D2AF9D0@VI1PR04MB1151.eurprd04.prod.outlook.com>
Message-ID: <CACpmSOu9ci1bOfYZAuEPDX=0GTVZYXnk6bf--6j-hY+GgVB45Q@mail.gmail.com>

A reproducible example would help us understand your problem, but since
you're working with matrices, this doesn't seem like a raster package (or
more generally, an R-sig-Geo) issue.

mCon is already a matrix - why do you need to assign it to an "empty
matrix" (r4)?

Do you mean an empty raster? If so, r4[] <- mCon should do what you want,
but then if that's the case, using Con(r2< 2, r1, Con(r2>1, r3, 0)) with
*rasters* r1, r2 and r3 should also return the raster you're after.

Cheers,
John



On Mon, Jul 13, 2015 at 3:22 AM, Ashraf Afana <
Ashraf.Afana at 3dlasermapping.com> wrote:

> Hi,
> I'm trying to apply a conditional statement to three raster layers using
> the following function:
>
> Con = function (condition, trueValue, falseValue){
>   return(condition*trueValue + (!condition)*falseValue)
> }
>
> A priori I've generated an empty matrix (r4) that match the other two
> raster layers. Also, I've converted the three rasters to matrix (r1, r2 &
> r3).
> I've create the conditional matrix (mCon):
> mCon = as.matrix(Con1(r2< 2, r1, Con1(r2>1, r3, 0)))
> Everything works perfectly. However, when I try to assign values mCon to
> the empty matrix (r4), I always get the following error message:
> (Error in (function (classes, fdef, mtable):
> unable to find an inherited method for function 'values<-' for signature
> '"matrix"')
>
> Any suggestions of this error and how to sort this out?
> Thanks
> Ashraf,
>
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From englishchristophera at gmail.com  Mon Jul 13 08:28:59 2015
From: englishchristophera at gmail.com (chris english)
Date: Mon, 13 Jul 2015 02:28:59 -0400
Subject: [R-sig-Geo] creating STFDF or ST objects in R
In-Reply-To: <55A2DA07.1080606@uni-muenster.de>
References: <1143289752.681787.1436720916728.JavaMail.yahoo@mail.yahoo.com>
	<1382343278.704438.1436732163985.JavaMail.yahoo@mail.yahoo.com>
	<55A2DA07.1080606@uni-muenster.de>
Message-ID: <CAASFQpTMoGAbDD5m-Xx2AP+7x=sOUTudto2DJM1YaT-BV8kgJA@mail.gmail.com>

Ajoke:

> delta
function (x)
{
    if (any(is.na(x)))
        stop("time values cannot be negative")
    augment.with.one = function(x) {
        ux = unique(x)
        l = length(ux)
        if (l <= 1)
            stop("cannot derive time interval from length 1 or constant
sequence")
        lx = length(x)
        x = x[c(1:lx, lx)]
        stopifnot(x[lx] == ux[l])
        x[lx + 1] = x[lx] + (ux[l] - ux[l - 1])
        x
    }
    if (is(x, "xts"))
        x = index(x)
    ret = augment.with.one(as.POSIXct(x))[-1]
    ret
}
<environment: namespace:spacetime>

Judging from your function paraphrasing "x$datetime <- Timex[i]" and the
subsequent p <- STIDF sounds to me like you're saying "The time is in there
(at x$datetime), recognize it!"  The test in delta says indeed it was
recognized as time, it's just not as long as you think it is.

I've found building my POSIXct objects outside my spatial df and then
calling STIDF of STFDF lets me first test that I have as many time values
as I should before tossing it in the tangle of STIDF.

HTH,

Chris

On Sun, Jul 12, 2015 at 5:20 PM, Edzer Pebesma <
edzer.pebesma at uni-muenster.de> wrote:

>
>
> On 07/12/2015 10:16 PM, joke atuge via R-sig-Geo wrote:
> > Hello, This is in addition to my earlier message. Here's the sample
> codes oh how I tried to create the STFDF. DLF is a list of variables called
> "FRP"  for each polygon in the DL3 list. Timex is the time list for the
> spatial polygons list.
> > DL7 <- sapply(1:length(DL3), function(i) {
> >   x <- DL3[[i]]
> > x$FRP <- DLF[[i]]
> >  x$datetime<-Timex[i]
> >  z<-Timex[i]
> >   p<-STIDF(x,data=x["FRP"],x$datetime,delta(x$datetime))
> >   p})
> >
> > The error I get is: Error in augment.with.one(as.POSIXct(x)) :
> >   cannot derive time interval from length 1 or constant sequence
>
> x$datetime has length 1; the docs of delta() tell you that it requires
> an argument of length 2 or larger. Maybe you can specify endTime to
> STIDF, e.g. as x$datetime, possibly a constant added to it.
>
> > Kind regards,Ajoke
> >
> >       On Sunday, July 12, 2015 6:08 PM, joke atuge <
> jazzpriestess2000 at yahoo.com> wrote:
> >
> >
> >  Hello,
> >  I am having serious issues creating a space time object with a list of
> spatialpolygonsdataframes and their dates/ time. I keep getting an error
> about the time not changing. How can I get this done please? Here's a
> sample of my data:
> >
> > [[1]]
> > class       : SpatialPolygonsDataFrame
> > features    : 128
> > extent      : -127.44, -67.8964, 1.000039, 31.71804  (xmin, xmax, ymin,
> ymax)
> > coord. ref. : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0
> > variables   : 1
> > names       : DDD.LFRP
> > min values  :     16.6
> > max values  :    488.5
> >
> > [[2]]
> > class       : SpatialPolygonsDataFrame
> > features    : 126
> > extent      : -129.04, -67.8964, 3.759985, 31.71804  (xmin, xmax, ymin,
> ymax)
> > coord. ref. : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0
> > variables   : 1
> > names       : DDD.LFRP
> > min values  :       14
> > max values  :    335.2
> > The Time variables look like this:
> > Timex
> >  [1] "2008-12-01 04:00:00 GMT" "2008-12-01 06:30:00 GMT"
> >
> > I have a list of 3,000 and the aim is to structure these spatialpolygons
> > dataframe in such a way that I can have monthly aggregates.
> >  How do I create an STFDF or STIDF, please? I can convert to rasters and
> agregate but they are of varying extents and resolutions for each time.
> > Kind regards,
> > Ajoke
> >
> >
> >
> >       [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
> --
> Edzer Pebesma
> Institute for Geoinformatics (ifgi),  University of M?nster,
> Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
> Journal of Statistical Software:   http://www.jstatsoft.org/
> Computers & Geosciences:   http://elsevier.com/locate/cageo/
> Spatial Statistics Society http://www.spatialstatistics.info
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>

	[[alternative HTML version deleted]]


From Ashraf.Afana at 3dlasermapping.com  Mon Jul 13 10:17:42 2015
From: Ashraf.Afana at 3dlasermapping.com (Ashraf Afana)
Date: Mon, 13 Jul 2015 08:17:42 +0000
Subject: [R-sig-Geo] Assign values of empty matrix to a raster layer in R
In-Reply-To: <CACpmSOu9ci1bOfYZAuEPDX=0GTVZYXnk6bf--6j-hY+GgVB45Q@mail.gmail.com>
References: <VI1PR04MB1151BE28C8E7753198E300D2AF9D0@VI1PR04MB1151.eurprd04.prod.outlook.com>
	<CACpmSOu9ci1bOfYZAuEPDX=0GTVZYXnk6bf--6j-hY+GgVB45Q@mail.gmail.com>
Message-ID: <VI1PR04MB1151636FA3B445592003BD01AF9C0@VI1PR04MB1151.eurprd04.prod.outlook.com>

Thanks John,
Sorry for the confusing, but yes r4 is an empty raster and not an empty matrix.
Indeed yes, it works with the raster directly without moving the raster layers to a matrix format. My error was not assigning [] to the r4.
Again, thanks for this John.
Ashraf,

From: John Baumgartner [mailto:johnbaums at gmail.com]
Sent: 13 July 2015 00:00
To: Ashraf Afana
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] Assign values of empty matrix to a raster layer in R

A reproducible example would help us understand your problem, but since you're working with matrices, this doesn't seem like a raster package (or more generally, an R-sig-Geo) issue.

mCon is already a matrix - why do you need to assign it to an "empty matrix" (r4)?

Do you mean an empty raster? If so, r4[] <- mCon should do what you want, but then if that's the case, using Con(r2< 2, r1, Con(r2>1, r3, 0)) with rasters r1, r2 and r3 should also return the raster you're after.

Cheers,
John



On Mon, Jul 13, 2015 at 3:22 AM, Ashraf Afana <Ashraf.Afana at 3dlasermapping.com<mailto:Ashraf.Afana at 3dlasermapping.com>> wrote:
Hi,
I'm trying to apply a conditional statement to three raster layers using the following function:

Con = function (condition, trueValue, falseValue){
  return(condition*trueValue + (!condition)*falseValue)
}

A priori I've generated an empty matrix (r4) that match the other two raster layers. Also, I've converted the three rasters to matrix (r1, r2 & r3).
I've create the conditional matrix (mCon):
mCon = as.matrix(Con1(r2< 2, r1, Con1(r2>1, r3, 0)))
Everything works perfectly. However, when I try to assign values mCon to the empty matrix (r4), I always get the following error message:
(Error in (function (classes, fdef, mtable):
unable to find an inherited method for function 'values<-' for signature '"matrix"')

Any suggestions of this error and how to sort this out?
Thanks
Ashraf,



        [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


	[[alternative HTML version deleted]]


From hc10024 at gmail.com  Sat Jul 11 20:54:27 2015
From: hc10024 at gmail.com (Helen Chen)
Date: Sat, 11 Jul 2015 11:54:27 -0700
Subject: [R-sig-Geo] Inverse Distance Weighting (IDW) with DEM
Message-ID: <CAKjCKvGq84zNaW1k4boJ_xBmUTNAYSo2cmA9x3X=74EnghWC4Q@mail.gmail.com>

Hi,

I would like to perform the IDW method with DEM for my rainfall data. I got
the error message that my DEM data and rainfall stations are in different
coordinates system.

I have tried to transform the projection for my rainfall gauge

Here is my code:

library(sp)
library(maptools)
sites <- readShapePoints("test2")
proj4string(sites)=CRS("+init=EPSG:3498")
library(raster)
DEM=raster("all_ok_Projec.tif")
library(gstat)
grd.elv=idw(sites$S3~1,sites,DEM)

the error message is this:

Error in predict.gstat(g, newdata = newdata, block = block, nsim = nsim,  :
  var1 : data item in gstat object and newdata have different coordinate
reference systems

this link is my data: https://dl.dropboxusercontent.com/u/16666204/data.zip

Could anyone help me to figure out transform the DEM into the same
coordinates with points data?

I have tried to transform the points data to DEM coordinates,but it showed
the same results.

Many thanks in advance.

Best,

Helen

	[[alternative HTML version deleted]]


From jerome.mathieu at upmc.fr  Tue Jul 14 00:03:04 2015
From: jerome.mathieu at upmc.fr (=?UTF-8?Q?J=C3=A9rome_Mathieu?=)
Date: Tue, 14 Jul 2015 00:03:04 +0200
Subject: [R-sig-Geo] rasterize in parrallel
Message-ID: <CALEhSiT=Pn4jJdw52bs0JxhYQ+Q1dSXQ1zXJajbZbaoPkonXOg@mail.gmail.com>

Dear all,

I need to rasterize the same shapefile according to different fields stored
in the @data of the shapefile. So I need to loop trough the fields (named
sc1 to sc27) to rasterize upon each field. With a regular sequential loop
it takes a very long time (much longer than in ArcMap), so I would like to
parallelize it, but I didn't succeed so far.

I tried :

# read shapefile
 library(maptools)
 polyg<-readShapePoly("D:\\polyg.shp")
 polyg at proj4string <- CRS("+init=epsg:2154")

library(doParallel)
cl <- makeCluster(4)
registerDoParallel(cl)

grain<-50
nsc<-4

foreach(idxsc = 1 : nsc , .packages="raster", polyg=polyg) %dopar% {

eval(parse(text=paste("RRpolyg_",idxsc,"<-raster(polyg,res=c(grain,grain))",sep="")))
# create raster template
eval(parse(text=paste("projection(RRpolyg_",idxsc,") <-
proj4string(polyg)",sep="")))      # projection
eval(parse(text=paste("RRpolyg_",idxsc,"<-rasterize(polyg,RRpolyg_",idxsc,",field=polyg at data$sc",idxsc,")",sep="")))
# rasterization

}

stopCluster(cl)

and I get the following error :

Error in { :
  task 1 failed - "unable to find an inherited method for function 'raster'
for signature '"numeric"'"


the data are here

http://we.tl/7qqegfLoBA


Any help would be greatly appreciated !

Jerome


> sessionInfo()
R version 3.1.3 (2015-03-09)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 7 x64 (build 7601) Service Pack 1

locale:
[1] LC_COLLATE=French_France.1252  LC_CTYPE=French_France.1252
LC_MONETARY=French_France.1252 LC_NUMERIC=C
LC_TIME=French_France.1252

attached base packages:
[1] parallel  stats     graphics  grDevices utils     datasets  methods
base

other attached packages:
 [1] rgeos_0.3-11     rgdal_0.9-2      maptools_0.8-36  lattice_0.20-31
foreign_0.8-63   raster_2.3-40    sp_1.1-0         doParallel_1.0.8
iterators_1.0.7  foreach_1.4.2

loaded via a namespace (and not attached):
[1] codetools_0.2-11 compiler_3.1.3   grid_3.1.3       tools_3.1.3







-- 
J?r?me Mathieu
Universit? Pierre & Marie Curie
Institute of Ecology and Environmental Science (Paris)

B?t. A - 7?me Etage, porte 715
7 quai St.-Bernard
F-75252 Paris Cedex 05

tel: 01 44 27 34 22

	[[alternative HTML version deleted]]


From johnbaums at gmail.com  Tue Jul 14 02:02:23 2015
From: johnbaums at gmail.com (John Baumgartner)
Date: Tue, 14 Jul 2015 10:02:23 +1000
Subject: [R-sig-Geo] rasterize in parrallel
In-Reply-To: <CALEhSiT=Pn4jJdw52bs0JxhYQ+Q1dSXQ1zXJajbZbaoPkonXOg@mail.gmail.com>
References: <CALEhSiT=Pn4jJdw52bs0JxhYQ+Q1dSXQ1zXJajbZbaoPkonXOg@mail.gmail.com>
Message-ID: <CACpmSOtXWq7ya7dhz77biHVLBuF-qLTpfE+X-_EvEreY=A8qgQ@mail.gmail.com>

I like using gdalUtils for this type of thing. It's often much faster to
work with files on disk using the gdal utilities than to use the raster
package, and may not even warrant parallelisation.

library(maptools)
library(raster)
library(gdalUtils)

# Read poly and assign CRS
polyg <- readShapePoly('polyg.shp')
proj4string(polyg) <- "+init=epsg:2154"

# Create the template raster
grain <- 50
r_template <- raster(polyg, res=c(50, 50))

# For each field (name), write out the template raster (to the working
directory),
# and then burn in the field's values. See ?gdal_rasterize and
# http://www.gdal.org/gdal_rasterize.html for details. Setting output_raster
# to TRUE means that the created rasters are returned to R and can be
# conveniently stacked.
s <- stack(lapply(names(polyg), function(nm) {
  f <- paste0('polyg_', nm, '.tif')
  suppressWarnings(writeRaster(r_template, f))
  gdal_rasterize(src_datasource='polyg.shp', dst_filename=f, a=nm,
                 output_Raster=TRUE)
}))

This took 56 sec on my system.

It's a simple step to then parallelise, which, for me, reduces the time
taken to 16 sec.

library(parallel)
nsc <- 4
cl <- makeCluster(nsc)

# Export required objects to each processes
clusterExport(cl, c('r_template', 'polyg'))

# Load the libraries on each process
clusterEvalQ(cl, sapply(c('raster', 'gdalUtils'), require, char=TRUE))

# Send to processes
system.time(s <- stack(parLapply(cl, names(polyg), function(nm) {
  f <- paste0('polyg_', nm, '.tif')
  suppressWarnings(writeRaster(r_template, f))
  gdal_rasterize(src_datasource='polyg.shp', dst_filename=f, a=nm,
                 output_Raster=TRUE)
})))


Cheers,
John




On Tue, Jul 14, 2015 at 8:03 AM, J?rome Mathieu <jerome.mathieu at upmc.fr>
wrote:

> Dear all,
>
> I need to rasterize the same shapefile according to different fields stored
> in the @data of the shapefile. So I need to loop trough the fields (named
> sc1 to sc27) to rasterize upon each field. With a regular sequential loop
> it takes a very long time (much longer than in ArcMap), so I would like to
> parallelize it, but I didn't succeed so far.
>
> I tried :
>
> # read shapefile
>  library(maptools)
>  polyg<-readShapePoly("D:\\polyg.shp")
>  polyg at proj4string <- CRS("+init=epsg:2154")
>
> library(doParallel)
> cl <- makeCluster(4)
> registerDoParallel(cl)
>
> grain<-50
> nsc<-4
>
> foreach(idxsc = 1 : nsc , .packages="raster", polyg=polyg) %dopar% {
>
>
> eval(parse(text=paste("RRpolyg_",idxsc,"<-raster(polyg,res=c(grain,grain))",sep="")))
> # create raster template
> eval(parse(text=paste("projection(RRpolyg_",idxsc,") <-
> proj4string(polyg)",sep="")))      # projection
>
> eval(parse(text=paste("RRpolyg_",idxsc,"<-rasterize(polyg,RRpolyg_",idxsc,",field=polyg at data
> $sc",idxsc,")",sep="")))
> # rasterization
>
> }
>
> stopCluster(cl)
>
> and I get the following error :
>
> Error in { :
>   task 1 failed - "unable to find an inherited method for function 'raster'
> for signature '"numeric"'"
>
>
> the data are here
>
> http://we.tl/7qqegfLoBA
>
>
> Any help would be greatly appreciated !
>
> Jerome
>
>
> > sessionInfo()
> R version 3.1.3 (2015-03-09)
> Platform: x86_64-w64-mingw32/x64 (64-bit)
> Running under: Windows 7 x64 (build 7601) Service Pack 1
>
> locale:
> [1] LC_COLLATE=French_France.1252  LC_CTYPE=French_France.1252
> LC_MONETARY=French_France.1252 LC_NUMERIC=C
> LC_TIME=French_France.1252
>
> attached base packages:
> [1] parallel  stats     graphics  grDevices utils     datasets  methods
> base
>
> other attached packages:
>  [1] rgeos_0.3-11     rgdal_0.9-2      maptools_0.8-36  lattice_0.20-31
> foreign_0.8-63   raster_2.3-40    sp_1.1-0         doParallel_1.0.8
> iterators_1.0.7  foreach_1.4.2
>
> loaded via a namespace (and not attached):
> [1] codetools_0.2-11 compiler_3.1.3   grid_3.1.3       tools_3.1.3
>
>
>
>
>
>
>
> --
> J?r?me Mathieu
> Universit? Pierre & Marie Curie
> Institute of Ecology and Environmental Science (Paris)
>
> B?t. A - 7?me Etage, porte 715
> 7 quai St.-Bernard
> F-75252 Paris Cedex 05
>
> tel: 01 44 27 34 22
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From johnbaums at gmail.com  Tue Jul 14 02:04:54 2015
From: johnbaums at gmail.com (John Baumgartner)
Date: Tue, 14 Jul 2015 10:04:54 +1000
Subject: [R-sig-Geo] rasterize in parrallel
In-Reply-To: <CACpmSOtXWq7ya7dhz77biHVLBuF-qLTpfE+X-_EvEreY=A8qgQ@mail.gmail.com>
References: <CALEhSiT=Pn4jJdw52bs0JxhYQ+Q1dSXQ1zXJajbZbaoPkonXOg@mail.gmail.com>
	<CACpmSOtXWq7ya7dhz77biHVLBuF-qLTpfE+X-_EvEreY=A8qgQ@mail.gmail.com>
Message-ID: <CACpmSOtvCstV-BbxCGH_jfRkBF8aR7O0Q6g+-qw2rRiPSqYmHg@mail.gmail.com>

(Note that the lines reading in the polygon and assigning the CRS are
actually redundant, since with gdal_rasterize we refer directly to the
shapefile's file path, and the .shp already had the appropriate CRS
assigned.)

On Tue, Jul 14, 2015 at 10:02 AM, John Baumgartner <johnbaums at gmail.com>
wrote:

> I like using gdalUtils for this type of thing. It's often much faster to
> work with files on disk using the gdal utilities than to use the raster
> package, and may not even warrant parallelisation.
>
> library(maptools)
> library(raster)
> library(gdalUtils)
>
> # Read poly and assign CRS
> polyg <- readShapePoly('polyg.shp')
> proj4string(polyg) <- "+init=epsg:2154"
>
> # Create the template raster
> grain <- 50
> r_template <- raster(polyg, res=c(50, 50))
>
> # For each field (name), write out the template raster (to the working
> directory),
> # and then burn in the field's values. See ?gdal_rasterize and
> # http://www.gdal.org/gdal_rasterize.html for details. Setting
> output_raster
> # to TRUE means that the created rasters are returned to R and can be
> # conveniently stacked.
> s <- stack(lapply(names(polyg), function(nm) {
>   f <- paste0('polyg_', nm, '.tif')
>   suppressWarnings(writeRaster(r_template, f))
>   gdal_rasterize(src_datasource='polyg.shp', dst_filename=f, a=nm,
>                  output_Raster=TRUE)
> }))
>
> This took 56 sec on my system.
>
> It's a simple step to then parallelise, which, for me, reduces the time
> taken to 16 sec.
>
> library(parallel)
> nsc <- 4
> cl <- makeCluster(nsc)
>
> # Export required objects to each processes
> clusterExport(cl, c('r_template', 'polyg'))
>
> # Load the libraries on each process
> clusterEvalQ(cl, sapply(c('raster', 'gdalUtils'), require, char=TRUE))
>
> # Send to processes
> system.time(s <- stack(parLapply(cl, names(polyg), function(nm) {
>   f <- paste0('polyg_', nm, '.tif')
>   suppressWarnings(writeRaster(r_template, f))
>   gdal_rasterize(src_datasource='polyg.shp', dst_filename=f, a=nm,
>                  output_Raster=TRUE)
> })))
>
>
> Cheers,
> John
>
>
>
>
> On Tue, Jul 14, 2015 at 8:03 AM, J?rome Mathieu <jerome.mathieu at upmc.fr>
> wrote:
>
>> Dear all,
>>
>> I need to rasterize the same shapefile according to different fields
>> stored
>> in the @data of the shapefile. So I need to loop trough the fields (named
>> sc1 to sc27) to rasterize upon each field. With a regular sequential loop
>> it takes a very long time (much longer than in ArcMap), so I would like to
>> parallelize it, but I didn't succeed so far.
>>
>> I tried :
>>
>> # read shapefile
>>  library(maptools)
>>  polyg<-readShapePoly("D:\\polyg.shp")
>>  polyg at proj4string <- CRS("+init=epsg:2154")
>>
>> library(doParallel)
>> cl <- makeCluster(4)
>> registerDoParallel(cl)
>>
>> grain<-50
>> nsc<-4
>>
>> foreach(idxsc = 1 : nsc , .packages="raster", polyg=polyg) %dopar% {
>>
>>
>> eval(parse(text=paste("RRpolyg_",idxsc,"<-raster(polyg,res=c(grain,grain))",sep="")))
>> # create raster template
>> eval(parse(text=paste("projection(RRpolyg_",idxsc,") <-
>> proj4string(polyg)",sep="")))      # projection
>>
>> eval(parse(text=paste("RRpolyg_",idxsc,"<-rasterize(polyg,RRpolyg_",idxsc,",field=polyg at data
>> $sc",idxsc,")",sep="")))
>> # rasterization
>>
>> }
>>
>> stopCluster(cl)
>>
>> and I get the following error :
>>
>> Error in { :
>>   task 1 failed - "unable to find an inherited method for function
>> 'raster'
>> for signature '"numeric"'"
>>
>>
>> the data are here
>>
>> http://we.tl/7qqegfLoBA
>>
>>
>> Any help would be greatly appreciated !
>>
>> Jerome
>>
>>
>> > sessionInfo()
>> R version 3.1.3 (2015-03-09)
>> Platform: x86_64-w64-mingw32/x64 (64-bit)
>> Running under: Windows 7 x64 (build 7601) Service Pack 1
>>
>> locale:
>> [1] LC_COLLATE=French_France.1252  LC_CTYPE=French_France.1252
>> LC_MONETARY=French_France.1252 LC_NUMERIC=C
>> LC_TIME=French_France.1252
>>
>> attached base packages:
>> [1] parallel  stats     graphics  grDevices utils     datasets  methods
>> base
>>
>> other attached packages:
>>  [1] rgeos_0.3-11     rgdal_0.9-2      maptools_0.8-36  lattice_0.20-31
>> foreign_0.8-63   raster_2.3-40    sp_1.1-0         doParallel_1.0.8
>> iterators_1.0.7  foreach_1.4.2
>>
>> loaded via a namespace (and not attached):
>> [1] codetools_0.2-11 compiler_3.1.3   grid_3.1.3       tools_3.1.3
>>
>>
>>
>>
>>
>>
>>
>> --
>> J?r?me Mathieu
>> Universit? Pierre & Marie Curie
>> Institute of Ecology and Environmental Science (Paris)
>>
>> B?t. A - 7?me Etage, porte 715
>> 7 quai St.-Bernard
>> F-75252 Paris Cedex 05
>>
>> tel: 01 44 27 34 22
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>

	[[alternative HTML version deleted]]


From r.hijmans at gmail.com  Tue Jul 14 06:02:30 2015
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 13 Jul 2015 21:02:30 -0700
Subject: [R-sig-Geo] rasterize in parrallel
In-Reply-To: <CALEhSiT=Pn4jJdw52bs0JxhYQ+Q1dSXQ1zXJajbZbaoPkonXOg@mail.gmail.com>
References: <CALEhSiT=Pn4jJdw52bs0JxhYQ+Q1dSXQ1zXJajbZbaoPkonXOg@mail.gmail.com>
Message-ID: <CANtt_hxa+iEUJeKnVNxbfnP1xnD9AWb_k_PgjCM9YCFwbY3_nQ@mail.gmail.com>

Jerome,

rasterize is indeed a bit slow, it is #1 on the list of functions that
need a rewrite for speed. However, I think your assumption is wrong.
You can rasterize all fields in one step, and it is pretty quick for
the example data:

library(raster)
polyg <- shapefile("polyg.shp")
grain <- 50
nsc <- 4
r <- raster(polyg, res=c(grain, grain))

x <- rasterize(polyg, r)
# perhaps followed by
y <- deratify(x)


So clustering is inefficient here, but I think the below shows how you
would do athat, using much simplified code (whenever you think you
need a construction like "eval(parse(text=paste(", you are wrong).

library(raster)
polyg <- shapefile("polyg.shp")

library(doParallel)
cl <- makeCluster(4)
registerDoParallel(cl)
grain <- 50
nsc <- 4
r <- raster(polyg, res=c(grain, grain), crs=crs(polyg))

rr <- foreach(i= 1:nsc, .packages="raster", .combine=c) %dopar% {
     rasterize(polyg, r, field=paste0("sc", i))
}

stopCluster(cl)



Best, Robert

On Mon, Jul 13, 2015 at 3:03 PM, J?rome Mathieu <jerome.mathieu at upmc.fr> wrote:
> Dear all,
>
> I need to rasterize the same shapefile according to different fields stored
> in the @data of the shapefile. So I need to loop trough the fields (named
> sc1 to sc27) to rasterize upon each field. With a regular sequential loop
> it takes a very long time (much longer than in ArcMap), so I would like to
> parallelize it, but I didn't succeed so far.
>
> I tried :
>
> # read shapefile
>  library(maptools)
>  polyg<-readShapePoly("D:\\polyg.shp")
>  polyg at proj4string <- CRS("+init=epsg:2154")
>
> library(doParallel)
> cl <- makeCluster(4)
> registerDoParallel(cl)
>
> grain<-50
> nsc<-4
>
> foreach(idxsc = 1 : nsc , .packages="raster", polyg=polyg) %dopar% {
>
> eval(parse(text=paste("RRpolyg_",idxsc,"<-raster(polyg,res=c(grain,grain))",sep="")))
> # create raster template
> eval(parse(text=paste("projection(RRpolyg_",idxsc,") <-
> proj4string(polyg)",sep="")))      # projection
> eval(parse(text=paste("RRpolyg_",idxsc,"<-rasterize(polyg,RRpolyg_",idxsc,",field=polyg at data$sc",idxsc,")",sep="")))
> # rasterization
>
> }
>
> stopCluster(cl)
>
> and I get the following error :
>
> Error in { :
>   task 1 failed - "unable to find an inherited method for function 'raster'
> for signature '"numeric"'"
>
>
> the data are here
>
> http://we.tl/7qqegfLoBA
>
>
> Any help would be greatly appreciated !
>
> Jerome
>
>
>> sessionInfo()
> R version 3.1.3 (2015-03-09)
> Platform: x86_64-w64-mingw32/x64 (64-bit)
> Running under: Windows 7 x64 (build 7601) Service Pack 1
>
> locale:
> [1] LC_COLLATE=French_France.1252  LC_CTYPE=French_France.1252
> LC_MONETARY=French_France.1252 LC_NUMERIC=C
> LC_TIME=French_France.1252
>
> attached base packages:
> [1] parallel  stats     graphics  grDevices utils     datasets  methods
> base
>
> other attached packages:
>  [1] rgeos_0.3-11     rgdal_0.9-2      maptools_0.8-36  lattice_0.20-31
> foreign_0.8-63   raster_2.3-40    sp_1.1-0         doParallel_1.0.8
> iterators_1.0.7  foreach_1.4.2
>
> loaded via a namespace (and not attached):
> [1] codetools_0.2-11 compiler_3.1.3   grid_3.1.3       tools_3.1.3
>
>
>
>
>
>
>
> --
> J?r?me Mathieu
> Universit? Pierre & Marie Curie
> Institute of Ecology and Environmental Science (Paris)
>
> B?t. A - 7?me Etage, porte 715
> 7 quai St.-Bernard
> F-75252 Paris Cedex 05
>
> tel: 01 44 27 34 22
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From jerome.mathieu at upmc.fr  Tue Jul 14 10:13:05 2015
From: jerome.mathieu at upmc.fr (=?UTF-8?Q?J=C3=A9rome_Mathieu?=)
Date: Tue, 14 Jul 2015 10:13:05 +0200
Subject: [R-sig-Geo] rasterize in parrallel
In-Reply-To: <CANtt_hxa+iEUJeKnVNxbfnP1xnD9AWb_k_PgjCM9YCFwbY3_nQ@mail.gmail.com>
References: <CALEhSiT=Pn4jJdw52bs0JxhYQ+Q1dSXQ1zXJajbZbaoPkonXOg@mail.gmail.com>
	<CANtt_hxa+iEUJeKnVNxbfnP1xnD9AWb_k_PgjCM9YCFwbY3_nQ@mail.gmail.com>
Message-ID: <CALEhSiSREKjvEJvyr4DQE0pfWvctnQMDd7GDkvZYABKW+AZZOw@mail.gmail.com>

Dear All,

Thanks a lot for your brilliant replies. It does work (fast) now!

Jerome


2015-07-14 6:02 GMT+02:00 Robert J. Hijmans <r.hijmans at gmail.com>:

> Jerome,
>
> rasterize is indeed a bit slow, it is #1 on the list of functions that
> need a rewrite for speed. However, I think your assumption is wrong.
> You can rasterize all fields in one step, and it is pretty quick for
> the example data:
>
> library(raster)
> polyg <- shapefile("polyg.shp")
> grain <- 50
> nsc <- 4
> r <- raster(polyg, res=c(grain, grain))
>
> x <- rasterize(polyg, r)
> # perhaps followed by
> y <- deratify(x)
>
>
> So clustering is inefficient here, but I think the below shows how you
> would do athat, using much simplified code (whenever you think you
> need a construction like "eval(parse(text=paste(", you are wrong).
>
> library(raster)
> polyg <- shapefile("polyg.shp")
>
> library(doParallel)
> cl <- makeCluster(4)
> registerDoParallel(cl)
> grain <- 50
> nsc <- 4
> r <- raster(polyg, res=c(grain, grain), crs=crs(polyg))
>
> rr <- foreach(i= 1:nsc, .packages="raster", .combine=c) %dopar% {
>      rasterize(polyg, r, field=paste0("sc", i))
> }
>
> stopCluster(cl)
>
>
>
> Best, Robert
>
> On Mon, Jul 13, 2015 at 3:03 PM, J?rome Mathieu <jerome.mathieu at upmc.fr>
> wrote:
> > Dear all,
> >
> > I need to rasterize the same shapefile according to different fields
> stored
> > in the @data of the shapefile. So I need to loop trough the fields (named
> > sc1 to sc27) to rasterize upon each field. With a regular sequential loop
> > it takes a very long time (much longer than in ArcMap), so I would like
> to
> > parallelize it, but I didn't succeed so far.
> >
> > I tried :
> >
> > # read shapefile
> >  library(maptools)
> >  polyg<-readShapePoly("D:\\polyg.shp")
> >  polyg at proj4string <- CRS("+init=epsg:2154")
> >
> > library(doParallel)
> > cl <- makeCluster(4)
> > registerDoParallel(cl)
> >
> > grain<-50
> > nsc<-4
> >
> > foreach(idxsc = 1 : nsc , .packages="raster", polyg=polyg) %dopar% {
> >
> >
> eval(parse(text=paste("RRpolyg_",idxsc,"<-raster(polyg,res=c(grain,grain))",sep="")))
> > # create raster template
> > eval(parse(text=paste("projection(RRpolyg_",idxsc,") <-
> > proj4string(polyg)",sep="")))      # projection
> >
> eval(parse(text=paste("RRpolyg_",idxsc,"<-rasterize(polyg,RRpolyg_",idxsc,",field=polyg at data
> $sc",idxsc,")",sep="")))
> > # rasterization
> >
> > }
> >
> > stopCluster(cl)
> >
> > and I get the following error :
> >
> > Error in { :
> >   task 1 failed - "unable to find an inherited method for function
> 'raster'
> > for signature '"numeric"'"
> >
> >
> > the data are here
> >
> > http://we.tl/7qqegfLoBA
> >
> >
> > Any help would be greatly appreciated !
> >
> > Jerome
> >
> >
> >> sessionInfo()
> > R version 3.1.3 (2015-03-09)
> > Platform: x86_64-w64-mingw32/x64 (64-bit)
> > Running under: Windows 7 x64 (build 7601) Service Pack 1
> >
> > locale:
> > [1] LC_COLLATE=French_France.1252  LC_CTYPE=French_France.1252
> > LC_MONETARY=French_France.1252 LC_NUMERIC=C
> > LC_TIME=French_France.1252
> >
> > attached base packages:
> > [1] parallel  stats     graphics  grDevices utils     datasets  methods
> > base
> >
> > other attached packages:
> >  [1] rgeos_0.3-11     rgdal_0.9-2      maptools_0.8-36  lattice_0.20-31
> > foreign_0.8-63   raster_2.3-40    sp_1.1-0         doParallel_1.0.8
> > iterators_1.0.7  foreach_1.4.2
> >
> > loaded via a namespace (and not attached):
> > [1] codetools_0.2-11 compiler_3.1.3   grid_3.1.3       tools_3.1.3
> >
> >
> >
> >
> >
> >
> >
> > --
> > J?r?me Mathieu
> > Universit? Pierre & Marie Curie
> > Institute of Ecology and Environmental Science (Paris)
> >
> > B?t. A - 7?me Etage, porte 715
> > 7 quai St.-Bernard
> > F-75252 Paris Cedex 05
> >
> > tel: 01 44 27 34 22
> >
> >         [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
J?r?me Mathieu
Universit? Pierre & Marie Curie
Institute of Ecology and Environmental Science (Paris)

B?t. A - 7?me Etage, porte 715
7 quai St.-Bernard
F-75252 Paris Cedex 05

tel: 01 44 27 34 22

	[[alternative HTML version deleted]]


From atsiban at unipi.gr  Tue Jul 14 17:37:33 2015
From: atsiban at unipi.gr (Apostolos Tsimpanos)
Date: Tue, 14 Jul 2015 18:37:33 +0300
Subject: [R-sig-Geo] A question about the estimated standard errors in SPGWR
	package
Message-ID: <000001d0be4b$008909f0$019b1dd0$@unipi.gr>

 

Dear List

 

I have a simple question about the estimated standard errors obtained from
the gwr command in SPGWR package. I run a  GWR  regression y~x 

GWRmodel<-gwr(y~x,coords=cbind(XCOO,YCOO),bandwidth=gfixcvsel,gweight=gwr.bi
square,hatmatrix=TRUE,se.fit=TRUE,se.fit.CCT=TRUE)

In the data frame 

GWRmodel$SDF

there are two estimated standard errors for the x coefficients denoted as
x_se and x_se_EDF. 

What is the difference between x_se and x_se_EDF and what is the best for
use, the former or the latter? The manual lacks information about this.

If I am not confused I think that the difference should be in the
approximation of hat matrix  that is  x_se  uses s^2 with approximation
whereas x_se_EDF not.

I would appreciate any help.

 

Thanks in advance

Apostolis


	[[alternative HTML version deleted]]


From yud at mail.montclair.edu  Tue Jul 14 18:32:22 2015
From: yud at mail.montclair.edu (Danlin Yu)
Date: Wed, 15 Jul 2015 00:32:22 +0800
Subject: [R-sig-Geo] A question about the estimated standard errors in
 SPGWR package
In-Reply-To: <000001d0be4b$008909f0$019b1dd0$@unipi.gr>
References: <000001d0be4b$008909f0$019b1dd0$@unipi.gr>
Message-ID: <55A53996.50106@mail.montclair.edu>

Hi, I would assume x_se_EDF is calculated with the effective degree of 
freedom, while x_se is calculated with the common sense degree of 
freedom (number of cases minus number of variables minus one). In any 
cases, the effective degree of freedom shall be used in GWR estimation 
since that is the "actual (effective)" degree of freedom in estimation.

I hope this helps.

Danlin

On 2015/7/14 23:37, Apostolos Tsimpanos wrote:
>   
>
> Dear List
>
>   
>
> I have a simple question about the estimated standard errors obtained from
> the gwr command in SPGWR package. I run a  GWR  regression y~x
>
> GWRmodel<-gwr(y~x,coords=cbind(XCOO,YCOO),bandwidth=gfixcvsel,gweight=gwr.bi
> square,hatmatrix=TRUE,se.fit=TRUE,se.fit.CCT=TRUE)
>
> In the data frame
>
> GWRmodel$SDF
>
> there are two estimated standard errors for the x coefficients denoted as
> x_se and x_se_EDF.
>
> What is the difference between x_se and x_se_EDF and what is the best for
> use, the former or the latter? The manual lacks information about this.
>
> If I am not confused I think that the difference should be in the
> approximation of hat matrix  that is  x_se  uses s^2 with approximation
> whereas x_se_EDF not.
>
> I would appreciate any help.
>
>   
>
> Thanks in advance
>
> Apostolis
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From robertomhorn at gmail.com  Wed Jul 15 02:12:42 2015
From: robertomhorn at gmail.com (Roberto Horn)
Date: Tue, 14 Jul 2015 21:12:42 -0300
Subject: [R-sig-Geo] Package MODIS error in function runMrt( ) object
	'ftpdirs' not found
Message-ID: <CAG42j+Pd6NQo4AwhvwdOdW-rJa+dk0qyu4Vsa1GWo9C-D7yY6Q@mail.gmail.com>

Hello

Im having trouble with function runMrt from the package MODIS. I've
already looked for help in forums, with no success. Any help would be
useful!

runMrt(product="MOD09GA",tileH="13",tileV="11" ,begin="2014.01.01",
end="2014.01.02", SDSstring="000000000000100001000",
job="mod09ga/safra14.15", outProj="GEO", datum="WGS84",
pixelSize="0.0045", mosaic="FALSE")

All suggested packages are installed
Output projection: Geographic
Output pixel size: 0.0045
Resampling method: nn
No output projection parameters specified. Reprojecting with no Parameters!
Error in runMrt(product = "MOD09GA", tileH = "13", tileV = "11", begin
= "2014.01.01",  :
  object 'ftpdirs' not found

-----------------------------------------------------
System info:
Win 7 32-bit
R version 3.2.1 (2015-06-18)
MODIS version: 0.10-29
MRT directory: D:/MRT/MRT
raster version: 2.4-15
rgdal 1.0-4
rgeos 0.3-11
XML 3.98-1.3
RCurl 1.95-4.7


Thank you!


From dicko.ahmadou at gmail.com  Wed Jul 15 02:21:15 2015
From: dicko.ahmadou at gmail.com (Ahmadou Dicko)
Date: Wed, 15 Jul 2015 00:21:15 +0000
Subject: [R-sig-Geo] Package MODIS error in function runMrt( ) object
 'ftpdirs' not found
In-Reply-To: <CAG42j+Pd6NQo4AwhvwdOdW-rJa+dk0qyu4Vsa1GWo9C-D7yY6Q@mail.gmail.com>
References: <CAG42j+Pd6NQo4AwhvwdOdW-rJa+dk0qyu4Vsa1GWo9C-D7yY6Q@mail.gmail.com>
Message-ID: <CAP8THHVUGdgKaOqfQZxs3x3Vh_jU8H=z0YQ_+zsoxj3YkfVaww@mail.gmail.com>

I had similar issue too.
I modified the runMrt to make it work, you will find attached a
working script that you can source to replace MODIS::runMrt before the
authors fix this bug (source('runMrt.R').

Hope it helps.




On Wed, Jul 15, 2015 at 12:12 AM, Roberto Horn <robertomhorn at gmail.com> wrote:
> Hello
>
> Im having trouble with function runMrt from the package MODIS. I've
> already looked for help in forums, with no success. Any help would be
> useful!
>
> runMrt(product="MOD09GA",tileH="13",tileV="11" ,begin="2014.01.01",
> end="2014.01.02", SDSstring="000000000000100001000",
> job="mod09ga/safra14.15", outProj="GEO", datum="WGS84",
> pixelSize="0.0045", mosaic="FALSE")
>
> All suggested packages are installed
> Output projection: Geographic
> Output pixel size: 0.0045
> Resampling method: nn
> No output projection parameters specified. Reprojecting with no Parameters!
> Error in runMrt(product = "MOD09GA", tileH = "13", tileV = "11", begin
> = "2014.01.01",  :
>   object 'ftpdirs' not found
>
> -----------------------------------------------------
> System info:
> Win 7 32-bit
> R version 3.2.1 (2015-06-18)
> MODIS version: 0.10-29
> MRT directory: D:/MRT/MRT
> raster version: 2.4-15
> rgdal 1.0-4
> rgeos 0.3-11
> XML 3.98-1.3
> RCurl 1.95-4.7
>
>
> Thank you!
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Ahmadou H. DICKO
statistician economist (Ing?nieur Statisticien ?conomiste)
PhD candidate in Climate change economics
Faculty of economics and managment - Cheikh Anta Diop University
West African Science Service Center on Climate Change and Adaptated
Land Use (WASCAL)
Center for Development Research (ZEF) - University of Bonn
email : ahmadou.dicko at ucad.edu.sn
twitter : @dickoah
github : github/dickoa
tel : +221 33 827 55 16
portable: +221 77 123 81 69
-------------- next part --------------
A non-text attachment was scrubbed...
Name: runMrt.R
Type: text/x-r-source
Size: 11372 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150715/a966ba95/attachment.bin>

From robertomhorn at gmail.com  Wed Jul 15 02:32:33 2015
From: robertomhorn at gmail.com (Roberto Horn)
Date: Tue, 14 Jul 2015 21:32:33 -0300
Subject: [R-sig-Geo] Package MODIS error in function runMrt( ) object
 'ftpdirs' not found
In-Reply-To: <CAP8THHVUGdgKaOqfQZxs3x3Vh_jU8H=z0YQ_+zsoxj3YkfVaww@mail.gmail.com>
References: <CAG42j+Pd6NQo4AwhvwdOdW-rJa+dk0qyu4Vsa1GWo9C-D7yY6Q@mail.gmail.com>
	<CAP8THHVUGdgKaOqfQZxs3x3Vh_jU8H=z0YQ_+zsoxj3YkfVaww@mail.gmail.com>
Message-ID: <CAG42j+Ne64D+h2wpno-DaDxjgN2j+eOWxos7tgTPYzxV1wGUtg@mail.gmail.com>

It worked, problem solved!

Thank you.

2015-07-14 21:21 GMT-03:00 Ahmadou Dicko <dicko.ahmadou at gmail.com>:

> I had similar issue too.
> I modified the runMrt to make it work, you will find attached a
> working script that you can source to replace MODIS::runMrt before the
> authors fix this bug (source('runMrt.R').
>
> Hope it helps.
>
>
>
>
> On Wed, Jul 15, 2015 at 12:12 AM, Roberto Horn <robertomhorn at gmail.com>
> wrote:
> > Hello
> >
> > Im having trouble with function runMrt from the package MODIS. I've
> > already looked for help in forums, with no success. Any help would be
> > useful!
> >
> > runMrt(product="MOD09GA",tileH="13",tileV="11" ,begin="2014.01.01",
> > end="2014.01.02", SDSstring="000000000000100001000",
> > job="mod09ga/safra14.15", outProj="GEO", datum="WGS84",
> > pixelSize="0.0045", mosaic="FALSE")
> >
> > All suggested packages are installed
> > Output projection: Geographic
> > Output pixel size: 0.0045
> > Resampling method: nn
> > No output projection parameters specified. Reprojecting with no
> Parameters!
> > Error in runMrt(product = "MOD09GA", tileH = "13", tileV = "11", begin
> > = "2014.01.01",  :
> >   object 'ftpdirs' not found
> >
> > -----------------------------------------------------
> > System info:
> > Win 7 32-bit
> > R version 3.2.1 (2015-06-18)
> > MODIS version: 0.10-29
> > MRT directory: D:/MRT/MRT
> > raster version: 2.4-15
> > rgdal 1.0-4
> > rgeos 0.3-11
> > XML 3.98-1.3
> > RCurl 1.95-4.7
> >
> >
> > Thank you!
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>
> --
> Ahmadou H. DICKO
> statistician economist (Ing?nieur Statisticien ?conomiste)
> PhD candidate in Climate change economics
> Faculty of economics and managment - Cheikh Anta Diop University
> West African Science Service Center on Climate Change and Adaptated
> Land Use (WASCAL)
> Center for Development Research (ZEF) - University of Bonn
> email : ahmadou.dicko at ucad.edu.sn
> twitter : @dickoah
> github : github/dickoa
> tel : +221 33 827 55 16
> portable: +221 77 123 81 69
>

	[[alternative HTML version deleted]]


From p.woods at qub.ac.uk  Wed Jul 15 09:58:00 2015
From: p.woods at qub.ac.uk (Paul Woods)
Date: Wed, 15 Jul 2015 07:58:00 +0000
Subject: [R-sig-Geo] Map point-of-view and joining locations with loops
Message-ID: <F0EE4335-0C02-46E5-AD26-F566958BE5DF@qub.ac.uk>

Hello everyone,

I?m not entirely sure how to explain what I?m looking for, but basically I?m hoping to do two things in R:

1) Rather than looking at a map face-on (from above, e.g., a normal OpenStreet Map or Google map), I would like to show the perspective of someone looking at the map from an angle, i.e., if someone were at altitude, hovering over the ground.

2) I would like to join two points on this map with a loop/line segment.

Is this possible to do in R? And how would I go about doing it? I have no idea where to start.

This type of map typically shows airline routes, e.g.,
http://www.barnabu.co.uk/wp-content/uploads/australia_flight_route_map_google_earth.JPG

Thanks,

Paul Woods

	[[alternative HTML version deleted]]


From mdsumner at gmail.com  Wed Jul 15 16:19:54 2015
From: mdsumner at gmail.com (Michael Sumner)
Date: Wed, 15 Jul 2015 14:19:54 +0000
Subject: [R-sig-Geo] Map point-of-view and joining locations with loops
In-Reply-To: <F0EE4335-0C02-46E5-AD26-F566958BE5DF@qub.ac.uk>
References: <F0EE4335-0C02-46E5-AD26-F566958BE5DF@qub.ac.uk>
Message-ID: <CAAcGz9_DvKqdDjxYUTO1Ew0ehB=40G7p2QT3aYtBap3T+UOxyA@mail.gmail.com>

On Wed, 15 Jul 2015 at 18:04 Paul Woods <p.woods at qub.ac.uk> wrote:

> Hello everyone,
>
> I?m not entirely sure how to explain what I?m looking for, but basically
> I?m hoping to do two things in R:
>
> 1) Rather than looking at a map face-on (from above, e.g., a normal
> OpenStreet Map or Google map), I would like to show the perspective of
> someone looking at the map from an angle, i.e., if someone were at
> altitude, hovering over the ground.
>
>

2) I would like to join two points on this map with a loop/line segment.
>
>
I can show you how to do this using raster/rgdal and the rgl package. It's
actually pretty straightforward once you can transfer between the sp and
raster data models and the quad-mesh model  available in rgl (see
?shade3d).  The essential difference for the raster grids is that sp/raster
store a rigid affine transform for the geography, but rgl stores every
pixel's corner coordinate once with a 4-piece index into that for each
"quad". You then can add texture coordinates with a few raster package
tricks to seamlessly overlay an image, and adding lines in 3d is pretty
simple - once you have a start/end, build a curve via some trajectory and
then store it in rgl's 2-index segment pairs (compared to sp's sequential
coordinates).

Maybe none of that makes sense to you, but if you can point to a specific
area and especially if you have actual data you want to use then I can
flesh this out some time, maybe next week. I've got tools that make it
simpler to do this data transfer now, but not on CRAN yet.  If you don't
have any data, you can obtain imagery through dismo::gmap, but a
topography/bathymetry layer can be harder and you might need to find a
local source - Etopo1 is an ok starting point that is global.

You can also use the ?persp facility in R to create static plots (rgl is
interactive 3d by default).

cheers, Mike.


Is this possible to do in R? And how would I go about doing it? I have no
> idea where to start.
>
> This type of map typically shows airline routes, e.g.,
>
> http://www.barnabu.co.uk/wp-content/uploads/australia_flight_route_map_google_earth.JPG
>
> Thanks,
>
> Paul Woods
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From pierluigi.derosa at gmail.com  Wed Jul 15 17:39:35 2015
From: pierluigi.derosa at gmail.com (pierluigi de rosa)
Date: Wed, 15 Jul 2015 17:39:35 +0200
Subject: [R-sig-Geo] Space Time Irregular DF - error in managing
Message-ID: <CAAgsrZjCfQobFPVcS=AyqiS9rvbabPz=BB=DQwQLSBuxSgGhPw@mail.gmail.com>

Dear All,

I have a space time data in long format. In particular I have 30 monitoring
stations and dayly data for each monitoring station. I converted such
dataframe using stConstruct and I created an Irregular Space time DF as I
don't have all data for all days for each monitoring station.
I have problem in plot this data and aggregate montly this data
My dataframe is listed below:

> head(dati_pioggie)
      nome       data  mm       x       y
1 Bastardo 2000-01-03 0.0 2320496 4748749
2 Bastardo 2000-01-04 0.0 2320496 4748749
3 Bastardo 2000-01-05 0.0 2320496 4748749
4 Bastardo 2000-01-06 0.1 2320496 4748749
5 Bastardo 2000-01-07 0.1 2320496 4748749
6 Bastardo 2000-01-08 0.0 2320496 4748749

> str(dati_pioggie)
'data.frame':    164001 obs. of  5 variables:
 $ nome: chr  "Bastardo" "Bastardo" "Bastardo" "Bastardo" ...
 $ data: Date, format: "2000-01-03" "2000-01-04" "2000-01-05" ...
 $ mm  : num  0 0 0 0.1 0.1 0 0 0 0 0 ...
 $ x   : num  2320496 2320496 2320496 2320496 2320496 ...
 $ y   : num  4748749 4748749 4748749 4748749 4748749 ...

The first column contain the measuring station name, the second the data
(in Date format), and coords are in x and y

I created the space time data frame as below:

> pioggieST = stConstruct(dati_pioggie, c("x", "y"), "data", interval =
TRUE,crs = CRS(stazioni at proj4string@projargs))

If I try to analyze data or aggregate I have several problems:

I I run
stplot(pioggieST[,,"mm"]) #IT works

stplot(pioggieST[,"2008-1","mm"],mode="xt") # it plot me only 6 plot but
I'm aspecting 31 plots

How can I plot a time series for all measuring station?
How can I aggregate data montly?

I tried:
> x1 = aggregate(pioggieST[,"2008"], "month", mean)
There were 50 or more warnings (use warnings() to see the first 50)
> warnings()
Messaggi di avvertimento:
1: In mean.default(X[[i]], ...) :
  argument is not numeric or logical: returning NA

Is this an error?

Thanks to all

Pierluigi



-- 
Ing. Pierluigi De Rosa (PhD)
cel: 3497558268 / fax: 075 7823038
skype: pierluigi.derosa

	[[alternative HTML version deleted]]


From edzer.pebesma at uni-muenster.de  Wed Jul 15 18:03:57 2015
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 15 Jul 2015 18:03:57 +0200
Subject: [R-sig-Geo] Space Time Irregular DF - error in managing
In-Reply-To: <CAAgsrZjCfQobFPVcS=AyqiS9rvbabPz=BB=DQwQLSBuxSgGhPw@mail.gmail.com>
References: <CAAgsrZjCfQobFPVcS=AyqiS9rvbabPz=BB=DQwQLSBuxSgGhPw@mail.gmail.com>
Message-ID: <55A6846D.8050007@uni-muenster.de>

For monitoring station data, spacetime::stplot is particularly useful if
it knows that these are repeated measurements for fixed stations.
Provided with an STIDF, stplot assumes they are not. So, you may want to try

pioggieST = as(pioggieST, "STFDF")

and then try to us stplot on that object.

On 07/15/2015 05:39 PM, pierluigi de rosa wrote:
> Dear All,
> 
> I have a space time data in long format. In particular I have 30 monitoring
> stations and dayly data for each monitoring station. I converted such
> dataframe using stConstruct and I created an Irregular Space time DF as I
> don't have all data for all days for each monitoring station.
> I have problem in plot this data and aggregate montly this data
> My dataframe is listed below:
> 
>> head(dati_pioggie)
>       nome       data  mm       x       y
> 1 Bastardo 2000-01-03 0.0 2320496 4748749
> 2 Bastardo 2000-01-04 0.0 2320496 4748749
> 3 Bastardo 2000-01-05 0.0 2320496 4748749
> 4 Bastardo 2000-01-06 0.1 2320496 4748749
> 5 Bastardo 2000-01-07 0.1 2320496 4748749
> 6 Bastardo 2000-01-08 0.0 2320496 4748749
> 
>> str(dati_pioggie)
> 'data.frame':    164001 obs. of  5 variables:
>  $ nome: chr  "Bastardo" "Bastardo" "Bastardo" "Bastardo" ...
>  $ data: Date, format: "2000-01-03" "2000-01-04" "2000-01-05" ...
>  $ mm  : num  0 0 0 0.1 0.1 0 0 0 0 0 ...
>  $ x   : num  2320496 2320496 2320496 2320496 2320496 ...
>  $ y   : num  4748749 4748749 4748749 4748749 4748749 ...
> 
> The first column contain the measuring station name, the second the data
> (in Date format), and coords are in x and y
> 
> I created the space time data frame as below:
> 
>> pioggieST = stConstruct(dati_pioggie, c("x", "y"), "data", interval =
> TRUE,crs = CRS(stazioni at proj4string@projargs))
> 
> If I try to analyze data or aggregate I have several problems:
> 
> I I run
> stplot(pioggieST[,,"mm"]) #IT works
> 
> stplot(pioggieST[,"2008-1","mm"],mode="xt") # it plot me only 6 plot but
> I'm aspecting 31 plots
> 
> How can I plot a time series for all measuring station?
> How can I aggregate data montly?
> 
> I tried:
>> x1 = aggregate(pioggieST[,"2008"], "month", mean)
> There were 50 or more warnings (use warnings() to see the first 50)
>> warnings()
> Messaggi di avvertimento:
> 1: In mean.default(X[[i]], ...) :
>   argument is not numeric or logical: returning NA
> 
> Is this an error?
> 
> Thanks to all
> 
> Pierluigi
> 
> 
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi),  University of M?nster,
Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
Journal of Statistical Software:   http://www.jstatsoft.org/
Computers & Geosciences:   http://elsevier.com/locate/cageo/
Spatial Statistics Society http://www.spatialstatistics.info

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150715/72a8ca94/attachment.bin>

From r-sig-geo at forreststevens.com  Wed Jul 15 20:44:09 2015
From: r-sig-geo at forreststevens.com (Forrest Stevens)
Date: Wed, 15 Jul 2015 14:44:09 -0400
Subject: [R-sig-Geo] Package MODIS error in function runMrt( ) object
 'ftpdirs' not found
In-Reply-To: <CAG42j+Ne64D+h2wpno-DaDxjgN2j+eOWxos7tgTPYzxV1wGUtg@mail.gmail.com>
References: <CAG42j+Pd6NQo4AwhvwdOdW-rJa+dk0qyu4Vsa1GWo9C-D7yY6Q@mail.gmail.com>
	<CAP8THHVUGdgKaOqfQZxs3x3Vh_jU8H=z0YQ_+zsoxj3YkfVaww@mail.gmail.com>
	<CAG42j+Ne64D+h2wpno-DaDxjgN2j+eOWxos7tgTPYzxV1wGUtg@mail.gmail.com>
Message-ID: <CAEBQMM=q3asZsWxAZW-9eMJqc8dJO_Trk6f2FNuzUpvUK8_6fQ@mail.gmail.com>

Hi guys, thank you for bringing this to our attention.  I believe I've
fixed the bug in the R-Forge version of the MODIS package.  If either
of you could install this from R-Forge and test it in your
environments that would be ideal.

Notice that these changes won't be reflected in the automated R-Forge
builds until at least tomorrow:
https://r-forge.r-project.org/scm/viewvc.php/pkg/MODIS/R/runMrt.R?root=modis&view=log

To install from the attached file (removed from r-sig-geo post):
install.packages("./MODIS.tar.gz", repos=NULL, type="source")

To install the package from R-Forge (once it has been built!):
install.packages("MODIS", repos="http://R-Forge.R-project.org")

Thanks and please don't hesitate to let us know if there are other
issues you find.  As an aside, you're less likely to run into these
types of inconsistencies if you use runGdal() instead of using the
MODIS Reprojection Tool.  I think more of us use that version and it's
likely to be much more well-tested.

Thanks,
Forrest

On Tue, Jul 14, 2015 at 8:32 PM, Roberto Horn <robertomhorn at gmail.com> wrote:
> It worked, problem solved!
>
> Thank you.
>
> 2015-07-14 21:21 GMT-03:00 Ahmadou Dicko <dicko.ahmadou at gmail.com>:
>
>> I had similar issue too.
>> I modified the runMrt to make it work, you will find attached a
>> working script that you can source to replace MODIS::runMrt before the
>> authors fix this bug (source('runMrt.R').
>>
>> Hope it helps.
>>
>>
>>
>>
>> On Wed, Jul 15, 2015 at 12:12 AM, Roberto Horn <robertomhorn at gmail.com>
>> wrote:
>> > Hello
>> >
>> > Im having trouble with function runMrt from the package MODIS. I've
>> > already looked for help in forums, with no success. Any help would be
>> > useful!
>> >
>> > runMrt(product="MOD09GA",tileH="13",tileV="11" ,begin="2014.01.01",
>> > end="2014.01.02", SDSstring="000000000000100001000",
>> > job="mod09ga/safra14.15", outProj="GEO", datum="WGS84",
>> > pixelSize="0.0045", mosaic="FALSE")
>> >
>> > All suggested packages are installed
>> > Output projection: Geographic
>> > Output pixel size: 0.0045
>> > Resampling method: nn
>> > No output projection parameters specified. Reprojecting with no
>> Parameters!
>> > Error in runMrt(product = "MOD09GA", tileH = "13", tileV = "11", begin
>> > = "2014.01.01",  :
>> >   object 'ftpdirs' not found
>> >
>> > -----------------------------------------------------
>> > System info:
>> > Win 7 32-bit
>> > R version 3.2.1 (2015-06-18)
>> > MODIS version: 0.10-29
>> > MRT directory: D:/MRT/MRT
>> > raster version: 2.4-15
>> > rgdal 1.0-4
>> > rgeos 0.3-11
>> > XML 3.98-1.3
>> > RCurl 1.95-4.7
>> >
>> >
>> > Thank you!
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at r-project.org
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>>
>> --
>> Ahmadou H. DICKO
>> statistician economist (Ing?nieur Statisticien ?conomiste)
>> PhD candidate in Climate change economics
>> Faculty of economics and managment - Cheikh Anta Diop University
>> West African Science Service Center on Climate Change and Adaptated
>> Land Use (WASCAL)
>> Center for Development Research (ZEF) - University of Bonn
>> email : ahmadou.dicko at ucad.edu.sn
>> twitter : @dickoah
>> github : github/dickoa
>> tel : +221 33 827 55 16
>> portable: +221 77 123 81 69
>>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From r-sig-geo at forreststevens.com  Wed Jul 15 20:44:09 2015
From: r-sig-geo at forreststevens.com (Forrest Stevens)
Date: Wed, 15 Jul 2015 14:44:09 -0400
Subject: [R-sig-Geo] Package MODIS error in function runMrt( ) object
 'ftpdirs' not found
In-Reply-To: <CAG42j+Ne64D+h2wpno-DaDxjgN2j+eOWxos7tgTPYzxV1wGUtg@mail.gmail.com>
References: <CAG42j+Pd6NQo4AwhvwdOdW-rJa+dk0qyu4Vsa1GWo9C-D7yY6Q@mail.gmail.com>
	<CAP8THHVUGdgKaOqfQZxs3x3Vh_jU8H=z0YQ_+zsoxj3YkfVaww@mail.gmail.com>
	<CAG42j+Ne64D+h2wpno-DaDxjgN2j+eOWxos7tgTPYzxV1wGUtg@mail.gmail.com>
Message-ID: <CAEBQMM=q3asZsWxAZW-9eMJqc8dJO_Trk6f2FNuzUpvUK8_6fQ@mail.gmail.com>

Hi guys, thank you for bringing this to our attention.  I believe I've
fixed the bug in the R-Forge version of the MODIS package.  If either
of you could install this from R-Forge and test it in your
environments that would be ideal.

Notice that these changes won't be reflected in the automated R-Forge
builds until at least tomorrow:
https://r-forge.r-project.org/scm/viewvc.php/pkg/MODIS/R/runMrt.R?root=modis&view=log

To install from the attached file (removed from r-sig-geo post):
install.packages("./MODIS.tar.gz", repos=NULL, type="source")

To install the package from R-Forge (once it has been built!):
install.packages("MODIS", repos="http://R-Forge.R-project.org")

Thanks and please don't hesitate to let us know if there are other
issues you find.  As an aside, you're less likely to run into these
types of inconsistencies if you use runGdal() instead of using the
MODIS Reprojection Tool.  I think more of us use that version and it's
likely to be much more well-tested.

Thanks,
Forrest

On Tue, Jul 14, 2015 at 8:32 PM, Roberto Horn <robertomhorn at gmail.com> wrote:
> It worked, problem solved!
>
> Thank you.
>
> 2015-07-14 21:21 GMT-03:00 Ahmadou Dicko <dicko.ahmadou at gmail.com>:
>
>> I had similar issue too.
>> I modified the runMrt to make it work, you will find attached a
>> working script that you can source to replace MODIS::runMrt before the
>> authors fix this bug (source('runMrt.R').
>>
>> Hope it helps.
>>
>>
>>
>>
>> On Wed, Jul 15, 2015 at 12:12 AM, Roberto Horn <robertomhorn at gmail.com>
>> wrote:
>> > Hello
>> >
>> > Im having trouble with function runMrt from the package MODIS. I've
>> > already looked for help in forums, with no success. Any help would be
>> > useful!
>> >
>> > runMrt(product="MOD09GA",tileH="13",tileV="11" ,begin="2014.01.01",
>> > end="2014.01.02", SDSstring="000000000000100001000",
>> > job="mod09ga/safra14.15", outProj="GEO", datum="WGS84",
>> > pixelSize="0.0045", mosaic="FALSE")
>> >
>> > All suggested packages are installed
>> > Output projection: Geographic
>> > Output pixel size: 0.0045
>> > Resampling method: nn
>> > No output projection parameters specified. Reprojecting with no
>> Parameters!
>> > Error in runMrt(product = "MOD09GA", tileH = "13", tileV = "11", begin
>> > = "2014.01.01",  :
>> >   object 'ftpdirs' not found
>> >
>> > -----------------------------------------------------
>> > System info:
>> > Win 7 32-bit
>> > R version 3.2.1 (2015-06-18)
>> > MODIS version: 0.10-29
>> > MRT directory: D:/MRT/MRT
>> > raster version: 2.4-15
>> > rgdal 1.0-4
>> > rgeos 0.3-11
>> > XML 3.98-1.3
>> > RCurl 1.95-4.7
>> >
>> >
>> > Thank you!
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at r-project.org
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>>
>> --
>> Ahmadou H. DICKO
>> statistician economist (Ing?nieur Statisticien ?conomiste)
>> PhD candidate in Climate change economics
>> Faculty of economics and managment - Cheikh Anta Diop University
>> West African Science Service Center on Climate Change and Adaptated
>> Land Use (WASCAL)
>> Center for Development Research (ZEF) - University of Bonn
>> email : ahmadou.dicko at ucad.edu.sn
>> twitter : @dickoah
>> github : github/dickoa
>> tel : +221 33 827 55 16
>> portable: +221 77 123 81 69
>>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From rhurlin at gwdg.de  Thu Jul 16 09:12:57 2015
From: rhurlin at gwdg.de (Rainer Hurling)
Date: Thu, 16 Jul 2015 09:12:57 +0200
Subject: [R-sig-Geo] rgdal: Cannot open data source
Message-ID: <55A75979.8050001@gwdg.de>

I am using GDAL 2.0.0 on FreeBSD and having trouble to get rgdal-1.0-4 
work correctly.

(1) The error looks like this:

ogrInfo("/home/rhurlin/SpatialData/world", "TM_WORLD_BORDERS-0.3")
Fehler in ogrInfo("/home/rhurlin/SpatialData/world", 
"TM_WORLD_BORDERS-0.3") :
   Cannot open data source


Obviously, rgdal does not find the path and/or files, given as 
parameters to functions like ogrInfo(). This problem also exists with 
similar rgdal tools like for example ogrListLayers:

ogrListLayers("/home/rhurlin/SpatialData/world")
Fehler in ogrListLayers("/home/rhurlin/SpatialData/world") :
   Cannot open data source


(2) The library rgdal loads fine so far:

library(rgdal)
Lade n?tiges Paket: sp
rgdal: version: 1.0-4, (SVN revision 548)
  Geospatial Data Abstraction Library extensions to R successfully loaded
  Loaded GDAL runtime: GDAL 2.0.0, released 2015/06/14
  Path to GDAL shared files: /usr/local/share/gdal
  Loaded PROJ.4 runtime: Rel. 4.9.1, 04 March 2015, [PJ_VERSION: 491]
  Path to PROJ.4 shared files: (autodetected)
  Linking to sp version: 1.1-1


(3) On the shell, outside of R, gdal 2.0.0 gives the expected output:

ogrinfo -so "/home/rhurlin/SpatialData/world" "TM_WORLD_BORDERS-0.3"
INFO: Open of `/home/rhurlin/SpatialData/world'
       using driver `ESRI Shapefile' successful.

Layer name: TM_WORLD_BORDERS-0.3
Metadata:
   DBF_DATE_LAST_UPDATE=2008-07-30
Geometry: Polygon
Feature Count: 246
Extent: (-180.000000, -90.000000) - (180.000000, 83.623596)
Layer SRS WKT:
GEOGCS["GCS_WGS_1984",
     DATUM["WGS_1984",
         SPHEROID["WGS_84",6378137.0,298.257223563]],
     PRIMEM["Greenwich",0.0],
     UNIT["Degree",0.0174532925199433]]
FIPS: String (2.0)
ISO2: String (2.0)
ISO3: String (3.0)
UN: Integer (3.0)
NAME: String (50.0)
AREA: Integer (7.0)
POP2005: Integer64 (10.0)
REGION: Integer (3.0)
SUBREGION: Integer (3.0)
LON: Real (8.3)
LAT: Real (7.3)

This leads me to the assumption, that the new rgdal-1.0_4 has some 
problem with path and/or file strings, at least on FreeBSD and at least 
for GDAL 2.0.0.


(4) I tried to get some insight with gdb, but my skills are far to small 
to get deeper. What I did:

- Run R with 'R -d gdb791'
- Load library(rgdal) within R
- Set 'bt ogrInfo' in gdb for src/ogrsource.cpp:l46
- Continue R, run the following command:


ogrInfo("/home/rhurlin/SpatialData/world", "TM_WORLD_BORDERS-0.3")

Breakpoint 1, ogrInfo (ogrsourcename=0x4b8cf458, Layer=0x4b8cf428) at 
ogrsource.cpp:46
46	    int nFIDs, nFields, iField, *nCount, pc=0;
(gdb) n
60	    installErrorHandler();
(gdb) n
62	    poDS=(GDALDataset*) GDALOpenEx(CHAR(STRING_ELT(ogrsourcename, 
0)), GDAL_OF_VECTOR, NULL, NULL, NULL);
(gdb) n
63	    if(poDS==NULL){
(gdb) bt
#0  ogrInfo (ogrsourcename=0x4b8cf458, Layer=0x4b8cf428) at ogrsource.cpp:63
#1  0x0000000040adf576 in R_doDotCall (ofun=0x4bc14201 <ogrInfo(SEXP, 
SEXP)>, nargs=2,
     cargs=0x7fffffffc5e0, call=0x4aae9f78) at dotcode.c:573
#2  0x0000000040aed4a2 in do_dotcall (call=0x4aae9f78, op=0x46ceeb50, 
args=0x4ab53468, env=0x4ab400b0)
     at dotcode.c:1251
#3  0x0000000040b291c1 in Rf_eval (e=0x4aae9f78, rho=0x4ab400b0) at 
eval.c:655
#4  0x0000000040b2dab3 in do_set (call=0x4aae6190, op=0x46cd71c8, 
args=0x4aae88b0, rho=0x4ab400b0)
     at eval.c:2106
#5  0x0000000040b28f71 in Rf_eval (e=0x4aae6190, rho=0x4ab400b0) at 
eval.c:627
#6  0x0000000040b2c9a0 in do_begin (call=0x4aae00b0, op=0x46cd8778, 
args=0x4aae61c8, rho=0x4ab400b0)
     at eval.c:1716
#7  0x0000000040b28f71 in Rf_eval (e=0x4aae00b0, rho=0x4ab400b0) at 
eval.c:627
#8  0x0000000040b2a256 in Rf_applyClosure (call=0x4aadc1c8, 
op=0x4aade238, arglist=0x4ab40318,
     rho=0x46f0a708, suppliedvars=0x46cd4f78) at eval.c:1039
#9  0x0000000040b29304 in Rf_eval (e=0x4aadc1c8, rho=0x46f0a708) at 
eval.c:674
#10 0x0000000040b6ad2c in Rf_ReplIteration (rho=0x46f0a708, savestack=0, 
browselevel=0,
     state=0x7fffffffd580) at main.c:258
#11 0x0000000040b6aef0 in R_ReplConsole (rho=0x46f0a708, savestack=0, 
browselevel=0) at main.c:308
#12 0x0000000040b6c682 in run_Rmainloop () at main.c:1009
#13 0x0000000040b6c697 in Rf_mainloop () at main.c:1016
#14 0x0000000000400a5c in main (ac=1, av=0x7fffffffe658) at Rmain.c:29
(gdb) n
64	      uninstallErrorHandlerAndTriggerError();
(gdb)
65	      error("Cannot open data source");
(gdb) n
Fehler in ogrInfo("/home/rhurlin/SpatialData/world", 
"TM_WORLD_BORDERS-0.3") :
   Cannot open data source
run_Rmainloop () at main.c:1008
1008	    R_GlobalContext = R_ToplevelContext = R_SessionContext = 
&R_Toplevel;
(gdb) n
1009	    R_ReplConsole(R_GlobalEnv, 0, 0);


Hope, my analysis it ok so far. From here on, I am lost and could really 
need some help. Please ask me, if you need more information or if I 
should try something.

Many thanks in advance.
Regards,
Rainer Hurling


sessionInfo()
R Under development (unstable) (2015-07-14 r68652)
Platform: amd64-portbld-freebsd11.0 (64-bit)
Running under: FreeBSD xxx.xxx.xxx 11.0-CURRENT FreeBSD 11.0-CURRENT #0 
r285383: Sat Jul 11 10:39:33 CEST 2015 
xxx at xxx.xxx.xxx:/usr/obj/usr/src/sys/XXX  amd64
locale:
[1] C/de_DE.UTF-8/de_DE.UTF-8/C/de_DE.UTF-8/de_DE.UTF-8
attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base
other attached packages:
[1] rgdal_1.0-4 sp_1.1-1
loaded via a namespace (and not attached):
[1] grid_3.3.0      lattice_0.20-33


From antonio.bubbico at gmail.com  Thu Jul 16 10:35:35 2015
From: antonio.bubbico at gmail.com (Antonio Bubbico)
Date: Thu, 16 Jul 2015 10:35:35 +0200
Subject: [R-sig-Geo] Bayesian model comparison
Message-ID: <CABW+3tBk7j0Y0ysGT1O+HugiwG0PsH5_JQLByzWe0M6RcvVn8A@mail.gmail.com>

Hello,

I would like to make a bayesian model comparison among SLX, SDM and SDEM
and produce model probabilities for all three. I would like to make it
rather than using likelihood
ratio tests that rely on two-way comparisons (Le Sage, 2014).

Can you suggest to me some package to make the model comparison among the
three models?

Thanks.

-- 
*Dr Antonio Bubbico*
Postdoctoral Researcher




*School of Agriculture and Food ScienceUniversity College DublinBelfield,
Dublin 4Ireland*

Tel: +353899528966
e-mail: a <marija.banovic at ucd.ie>ntonio.bubbico at gmail.com
Room: 1.27

	[[alternative HTML version deleted]]


From Roger.Bivand at nhh.no  Thu Jul 16 11:41:54 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 16 Jul 2015 11:41:54 +0200
Subject: [R-sig-Geo] Bayesian model comparison
In-Reply-To: <CABW+3tBk7j0Y0ysGT1O+HugiwG0PsH5_JQLByzWe0M6RcvVn8A@mail.gmail.com>
References: <CABW+3tBk7j0Y0ysGT1O+HugiwG0PsH5_JQLByzWe0M6RcvVn8A@mail.gmail.com>
Message-ID: <alpine.LFD.2.11.1507161137370.3629@reclus.nhh.no>

On Thu, 16 Jul 2015, Antonio Bubbico wrote:

> Hello,
>
> I would like to make a bayesian model comparison among SLX, SDM and SDEM
> and produce model probabilities for all three. I would like to make it
> rather than using likelihood
> ratio tests that rely on two-way comparisons (Le Sage, 2014).
>
> Can you suggest to me some package to make the model comparison among the
> three models?

Experimentally, try INLABMA and INLA with the slm latent model. The slm 
latent model itself with BIC or similar may be enough. These estimation 
methods are still under development.

Roger

>
> Thanks.
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Thu Jul 16 11:55:30 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 16 Jul 2015 11:55:30 +0200
Subject: [R-sig-Geo] rgdal: Cannot open data source
In-Reply-To: <55A75979.8050001@gwdg.de>
References: <55A75979.8050001@gwdg.de>
Message-ID: <alpine.LFD.2.11.1507161146480.3629@reclus.nhh.no>

Do you have other versions of GDAL on the system, and was rgdal 1.0-4 
installed against GDAL 2.0.0? I believe that the package should check that 
the GDAL runtime is the same as the one used to install rgdal, but the 
check may not be robust. I am away until mid-August, and cannot help with 
FreeBSD anyway. Does setwd() to the dsn of the shapefile help , then 
dsn=":"? Does

ogrInfo("/home/rhurlin/SpatialData/world/TM_WORLD_BORDERS-0.3.shp", 
"TM_WORLD_BORDERS-0.3")

help?

Is the shapefile in that folder? Do other drivers work? Does 
example(readOGR) work?

Roger

On Thu, 16 Jul 2015, Rainer Hurling wrote:

> I am using GDAL 2.0.0 on FreeBSD and having trouble to get rgdal-1.0-4 work 
> correctly.
>
> (1) The error looks like this:
>
> ogrInfo("/home/rhurlin/SpatialData/world", "TM_WORLD_BORDERS-0.3")
> Fehler in ogrInfo("/home/rhurlin/SpatialData/world", "TM_WORLD_BORDERS-0.3") 
> :
>   Cannot open data source
>
>
> Obviously, rgdal does not find the path and/or files, given as parameters to 
> functions like ogrInfo(). This problem also exists with similar rgdal tools 
> like for example ogrListLayers:
>
> ogrListLayers("/home/rhurlin/SpatialData/world")
> Fehler in ogrListLayers("/home/rhurlin/SpatialData/world") :
>   Cannot open data source
>
>
> (2) The library rgdal loads fine so far:
>
> library(rgdal)
> Lade n?tiges Paket: sp
> rgdal: version: 1.0-4, (SVN revision 548)
>  Geospatial Data Abstraction Library extensions to R successfully loaded
>  Loaded GDAL runtime: GDAL 2.0.0, released 2015/06/14
>  Path to GDAL shared files: /usr/local/share/gdal
>  Loaded PROJ.4 runtime: Rel. 4.9.1, 04 March 2015, [PJ_VERSION: 491]
>  Path to PROJ.4 shared files: (autodetected)
>  Linking to sp version: 1.1-1
>
>
> (3) On the shell, outside of R, gdal 2.0.0 gives the expected output:
>
> ogrinfo -so "/home/rhurlin/SpatialData/world" "TM_WORLD_BORDERS-0.3"
> INFO: Open of `/home/rhurlin/SpatialData/world'
>       using driver `ESRI Shapefile' successful.
>
> Layer name: TM_WORLD_BORDERS-0.3
> Metadata:
>  DBF_DATE_LAST_UPDATE=2008-07-30
> Geometry: Polygon
> Feature Count: 246
> Extent: (-180.000000, -90.000000) - (180.000000, 83.623596)
> Layer SRS WKT:
> GEOGCS["GCS_WGS_1984",
>     DATUM["WGS_1984",
>         SPHEROID["WGS_84",6378137.0,298.257223563]],
>     PRIMEM["Greenwich",0.0],
>     UNIT["Degree",0.0174532925199433]]
> FIPS: String (2.0)
> ISO2: String (2.0)
> ISO3: String (3.0)
> UN: Integer (3.0)
> NAME: String (50.0)
> AREA: Integer (7.0)
> POP2005: Integer64 (10.0)
> REGION: Integer (3.0)
> SUBREGION: Integer (3.0)
> LON: Real (8.3)
> LAT: Real (7.3)
>
> This leads me to the assumption, that the new rgdal-1.0_4 has some problem 
> with path and/or file strings, at least on FreeBSD and at least for GDAL 
> 2.0.0.
>
>
> (4) I tried to get some insight with gdb, but my skills are far to small to 
> get deeper. What I did:
>
> - Run R with 'R -d gdb791'
> - Load library(rgdal) within R
> - Set 'bt ogrInfo' in gdb for src/ogrsource.cpp:l46
> - Continue R, run the following command:
>
>
> ogrInfo("/home/rhurlin/SpatialData/world", "TM_WORLD_BORDERS-0.3")
>
> Breakpoint 1, ogrInfo (ogrsourcename=0x4b8cf458, Layer=0x4b8cf428) at 
> ogrsource.cpp:46
> 46	    int nFIDs, nFields, iField, *nCount, pc=0;
> (gdb) n
> 60	    installErrorHandler();
> (gdb) n
> 62	    poDS=(GDALDataset*) GDALOpenEx(CHAR(STRING_ELT(ogrsourcename, 
> 0)), GDAL_OF_VECTOR, NULL, NULL, NULL);
> (gdb) n
> 63	    if(poDS==NULL){
> (gdb) bt
> #0  ogrInfo (ogrsourcename=0x4b8cf458, Layer=0x4b8cf428) at ogrsource.cpp:63
> #1  0x0000000040adf576 in R_doDotCall (ofun=0x4bc14201 <ogrInfo(SEXP, SEXP)>, 
> nargs=2,
>    cargs=0x7fffffffc5e0, call=0x4aae9f78) at dotcode.c:573
> #2  0x0000000040aed4a2 in do_dotcall (call=0x4aae9f78, op=0x46ceeb50, 
> args=0x4ab53468, env=0x4ab400b0)
>    at dotcode.c:1251
> #3  0x0000000040b291c1 in Rf_eval (e=0x4aae9f78, rho=0x4ab400b0) at 
> eval.c:655
> #4  0x0000000040b2dab3 in do_set (call=0x4aae6190, op=0x46cd71c8, 
> args=0x4aae88b0, rho=0x4ab400b0)
>    at eval.c:2106
> #5  0x0000000040b28f71 in Rf_eval (e=0x4aae6190, rho=0x4ab400b0) at 
> eval.c:627
> #6  0x0000000040b2c9a0 in do_begin (call=0x4aae00b0, op=0x46cd8778, 
> args=0x4aae61c8, rho=0x4ab400b0)
>    at eval.c:1716
> #7  0x0000000040b28f71 in Rf_eval (e=0x4aae00b0, rho=0x4ab400b0) at 
> eval.c:627
> #8  0x0000000040b2a256 in Rf_applyClosure (call=0x4aadc1c8, op=0x4aade238, 
> arglist=0x4ab40318,
>    rho=0x46f0a708, suppliedvars=0x46cd4f78) at eval.c:1039
> #9  0x0000000040b29304 in Rf_eval (e=0x4aadc1c8, rho=0x46f0a708) at 
> eval.c:674
> #10 0x0000000040b6ad2c in Rf_ReplIteration (rho=0x46f0a708, savestack=0, 
> browselevel=0,
>    state=0x7fffffffd580) at main.c:258
> #11 0x0000000040b6aef0 in R_ReplConsole (rho=0x46f0a708, savestack=0, 
> browselevel=0) at main.c:308
> #12 0x0000000040b6c682 in run_Rmainloop () at main.c:1009
> #13 0x0000000040b6c697 in Rf_mainloop () at main.c:1016
> #14 0x0000000000400a5c in main (ac=1, av=0x7fffffffe658) at Rmain.c:29
> (gdb) n
> 64	      uninstallErrorHandlerAndTriggerError();
> (gdb)
> 65	      error("Cannot open data source");
> (gdb) n
> Fehler in ogrInfo("/home/rhurlin/SpatialData/world", "TM_WORLD_BORDERS-0.3") 
> :
>  Cannot open data source
> run_Rmainloop () at main.c:1008
> 1008	    R_GlobalContext = R_ToplevelContext = R_SessionContext = 
> &R_Toplevel;
> (gdb) n
> 1009	    R_ReplConsole(R_GlobalEnv, 0, 0);
>
>
> Hope, my analysis it ok so far. From here on, I am lost and could really need 
> some help. Please ask me, if you need more information or if I should try 
> something.
>
> Many thanks in advance.
> Regards,
> Rainer Hurling
>
>
> sessionInfo()
> R Under development (unstable) (2015-07-14 r68652)
> Platform: amd64-portbld-freebsd11.0 (64-bit)
> Running under: FreeBSD xxx.xxx.xxx 11.0-CURRENT FreeBSD 11.0-CURRENT #0 
> r285383: Sat Jul 11 10:39:33 CEST 2015 
> xxx at xxx.xxx.xxx:/usr/obj/usr/src/sys/XXX  amd64
> locale:
> [1] C/de_DE.UTF-8/de_DE.UTF-8/C/de_DE.UTF-8/de_DE.UTF-8
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> other attached packages:
> [1] rgdal_1.0-4 sp_1.1-1
> loaded via a namespace (and not attached):
> [1] grid_3.3.0      lattice_0.20-33
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no

From antonio.bubbico at gmail.com  Thu Jul 16 12:47:15 2015
From: antonio.bubbico at gmail.com (Antonio Bubbico)
Date: Thu, 16 Jul 2015 12:47:15 +0200
Subject: [R-sig-Geo] Bayesian model comparison
In-Reply-To: <alpine.LFD.2.11.1507161137370.3629@reclus.nhh.no>
References: <CABW+3tBk7j0Y0ysGT1O+HugiwG0PsH5_JQLByzWe0M6RcvVn8A@mail.gmail.com>
	<alpine.LFD.2.11.1507161137370.3629@reclus.nhh.no>
Message-ID: <CABW+3tCXHQU5SZ+H_U1xkomGiCU+pWFfWEjuy-t34r5LEQ4qcg@mail.gmail.com>

Hello Roger,

thanks for that. Is there any available code that I can take as an example?

Regards.

2015-07-16 11:41 GMT+02:00 Roger Bivand <Roger.Bivand at nhh.no>:

> On Thu, 16 Jul 2015, Antonio Bubbico wrote:
>
>  Hello,
>>
>> I would like to make a bayesian model comparison among SLX, SDM and SDEM
>> and produce model probabilities for all three. I would like to make it
>> rather than using likelihood
>> ratio tests that rely on two-way comparisons (Le Sage, 2014).
>>
>> Can you suggest to me some package to make the model comparison among the
>> three models?
>>
>
> Experimentally, try INLABMA and INLA with the slm latent model. The slm
> latent model itself with BIC or similar may be enough. These estimation
> methods are still under development.
>
> Roger
>
>
>> Thanks.
>>
>>
>>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 91 00
> e-mail: Roger.Bivand at nhh.no
>
>


-- 
*Dr Antonio Bubbico*
Postdoctoral Researcher




*School of Agriculture and Food ScienceUniversity College DublinBelfield,
Dublin 4Ireland*

Tel: +353899528966
e-mail: a <marija.banovic at ucd.ie>ntonio.bubbico at gmail.com
Room: 1.27

	[[alternative HTML version deleted]]


From atsiban at unipi.gr  Thu Jul 16 14:26:17 2015
From: atsiban at unipi.gr (Apostolis)
Date: Thu, 16 Jul 2015 12:26:17 +0000
Subject: [R-sig-Geo] A question about the estimated standard errors in
	SPGWR package
References: <000001d0be4b$008909f0$019b1dd0$@unipi.gr>
	<55A53996.50106@mail.montclair.edu>
Message-ID: <loom.20150716T122655-882@post.gmane.org>


Thank you for the help
Apostolis


From rhurlin at gwdg.de  Thu Jul 16 15:52:53 2015
From: rhurlin at gwdg.de (Rainer Hurling)
Date: Thu, 16 Jul 2015 15:52:53 +0200
Subject: [R-sig-Geo] rgdal: Cannot open data source
In-Reply-To: <alpine.LFD.2.11.1507161146480.3629@reclus.nhh.no>
References: <55A75979.8050001@gwdg.de>
	<alpine.LFD.2.11.1507161146480.3629@reclus.nhh.no>
Message-ID: <55A7B735.2020105@gwdg.de>

Hi Roger,

Am 16.07.2015 um 11:55 schrieb Roger Bivand:
> Do you have other versions of GDAL on the system, and was rgdal 1.0-4
> installed against GDAL 2.0.0? I believe that the package should check
> that the GDAL runtime is the same as the one used to install rgdal, but
> the check may not be robust. I am away until mid-August, and cannot help
> with FreeBSD anyway. Does setwd() to the dsn of the shapefile help ,
> then dsn=":"? Does

Yep. rgdal_1.0-4 is build against GDAL 2.0.0. Version 2.0.0 is the only 
one installed, see sessionInfo() at bottom of previous mail.

Other functions like ogrDrivers() work fine:

ogrDrivers()
              name 
long_name write  copy isVector
1          ARCGEN                                           Arc/Info 
Generate FALSE FALSE     TRUE
2          AVCBin                                    Arc/Info Binary 
Coverage FALSE FALSE     TRUE
3          AVCE00                               Arc/Info E00 (ASCII) 
Coverage FALSE FALSE     TRUE
4      AeronavFAA 
Aeronav FAA FALSE FALSE     TRUE
5             BNA 
Atlas BNA  TRUE FALSE     TRUE
[..snip..]


And also, ogrinfo() from package gdalUtils works fine:

gdalUtils::ogrinfo("/home/rhurlin/SpatialData/world", 
"TM_WORLD_BORDERS-0.3", so=TRUE)
  [1] "INFO: Open of `/home/rhurlin/SpatialData/world'"
  [2] "      using driver `ESRI Shapefile' successful."
  [3] ""
  [4] "Layer name: TM_WORLD_BORDERS-0.3"
  [5] "Metadata:"
  [6] "  DBF_DATE_LAST_UPDATE=2008-07-30"
  [7] "Geometry: Polygon"
  [8] "Feature Count: 246"
  [9] "Extent: (-180.000000, -90.000000) - (180.000000, 83.623596)"
[10] "Layer SRS WKT:"
[11] "GEOGCS[\"GCS_WGS_1984\","
[12] "    DATUM[\"WGS_1984\","
[13] "        SPHEROID[\"WGS_84\",6378137.0,298.257223563]],"
[14] "    PRIMEM[\"Greenwich\",0.0],"
[15] "    UNIT[\"Degree\",0.0174532925199433]]"
[16] "FIPS: String (2.0)"
[17] "ISO2: String (2.0)"
[18] "ISO3: String (3.0)"
[19] "UN: Integer (3.0)"
[20] "NAME: String (50.0)"
[21] "AREA: Integer (7.0)"
[22] "POP2005: Integer64 (10.0)"
[23] "REGION: Integer (3.0)"
[24] "SUBREGION: Integer (3.0)"
[25] "LON: Real (8.3)"
[26] "LAT: Real (7.3)"


I am afraid, I don't get you with the dsn=":" thing ;(

> ogrInfo("/home/rhurlin/SpatialData/world/TM_WORLD_BORDERS-0.3.shp",
> "TM_WORLD_BORDERS-0.3")

This works fine:

  ogrInfo("/home/rhurlin/SpatialData/world/TM_WORLD_BORDERS-0.3.shp", 
"TM_WORLD_BORDERS-0.3")
Source: "/home/rhurlin/SpatialData/world/TM_WORLD_BORDERS-0.3.shp", 
layer: "TM_WORLD_BORDERS-0.3"
Driver: ESRI Shapefile; number of rows: 246
Feature type: wkbPolygon with 2 dimensions
Extent: (-180 -90) - (180 83.6236)
CRS: +proj=longlat +datum=WGS84 +no_defs
LDID: 87
Number of fields: 11
         name type length  typeName
1       FIPS    4      2    String
2       ISO2    4      2    String
3       ISO3    4      3    String
4         UN    0      3   Integer
5       NAME    4     50    String
6       AREA    0      7   Integer
7    POP2005   12     10 Integer64
8     REGION    0      3   Integer
9  SUBREGION    0      3   Integer
10       LON    2      8      Real
11       LAT    2      7      Real



> help?
>
> Is the shapefile in that folder? Do other drivers work? Does
> example(readOGR) work?

It is the same as with ogrInfo(). With shape integrated in the dsn 
string it works, without not:

tm <- readOGR("/home/rhurlin/SpatialData/world", "TM_WORLD_BORDERS-0.3")
Fehler in ogrInfo(dsn = dsn, layer = layer, encoding = encoding, 
use_iconv = use_iconv,  :
   Cannot open data source


tm <- 
readOGR("/home/rhurlin/SpatialData/world/TM_WORLD_BORDERS-0.3.shp", 
"TM_WORLD_BORDERS-0.3")
OGR data source with driver: ESRI Shapefile
Source: "/home/rhurlin/SpatialData/world/TM_WORLD_BORDERS-0.3.shp", 
layer: "TM_WORLD_BORDERS-0.3"
with 246 features
It has 11 fields


Many thanks for your answer and your suggestions. It seems, there is 
something odd in the interpretation of the dsn string.

Best wishes,
Rainer


> Roger
>
> On Thu, 16 Jul 2015, Rainer Hurling wrote:
>
>> I am using GDAL 2.0.0 on FreeBSD and having trouble to get rgdal-1.0-4
>> work correctly.
>>
>> (1) The error looks like this:
>>
>> ogrInfo("/home/rhurlin/SpatialData/world", "TM_WORLD_BORDERS-0.3")
>> Fehler in ogrInfo("/home/rhurlin/SpatialData/world",
>> "TM_WORLD_BORDERS-0.3") :
>>   Cannot open data source
>>
>>
>> Obviously, rgdal does not find the path and/or files, given as
>> parameters to functions like ogrInfo(). This problem also exists with
>> similar rgdal tools like for example ogrListLayers:
>>
>> ogrListLayers("/home/rhurlin/SpatialData/world")
>> Fehler in ogrListLayers("/home/rhurlin/SpatialData/world") :
>>   Cannot open data source
>>
>>
>> (2) The library rgdal loads fine so far:
>>
>> library(rgdal)
>> Lade n?tiges Paket: sp
>> rgdal: version: 1.0-4, (SVN revision 548)
>>  Geospatial Data Abstraction Library extensions to R successfully loaded
>>  Loaded GDAL runtime: GDAL 2.0.0, released 2015/06/14
>>  Path to GDAL shared files: /usr/local/share/gdal
>>  Loaded PROJ.4 runtime: Rel. 4.9.1, 04 March 2015, [PJ_VERSION: 491]
>>  Path to PROJ.4 shared files: (autodetected)
>>  Linking to sp version: 1.1-1
>>
>>
>> (3) On the shell, outside of R, gdal 2.0.0 gives the expected output:
>>
>> ogrinfo -so "/home/rhurlin/SpatialData/world" "TM_WORLD_BORDERS-0.3"
>> INFO: Open of `/home/rhurlin/SpatialData/world'
>>       using driver `ESRI Shapefile' successful.
>>
>> Layer name: TM_WORLD_BORDERS-0.3
>> Metadata:
>>  DBF_DATE_LAST_UPDATE=2008-07-30
>> Geometry: Polygon
>> Feature Count: 246
>> Extent: (-180.000000, -90.000000) - (180.000000, 83.623596)
>> Layer SRS WKT:
>> GEOGCS["GCS_WGS_1984",
>>     DATUM["WGS_1984",
>>         SPHEROID["WGS_84",6378137.0,298.257223563]],
>>     PRIMEM["Greenwich",0.0],
>>     UNIT["Degree",0.0174532925199433]]
>> FIPS: String (2.0)
>> ISO2: String (2.0)
>> ISO3: String (3.0)
>> UN: Integer (3.0)
>> NAME: String (50.0)
>> AREA: Integer (7.0)
>> POP2005: Integer64 (10.0)
>> REGION: Integer (3.0)
>> SUBREGION: Integer (3.0)
>> LON: Real (8.3)
>> LAT: Real (7.3)
>>
>> This leads me to the assumption, that the new rgdal-1.0_4 has some
>> problem with path and/or file strings, at least on FreeBSD and at
>> least for GDAL 2.0.0.
>>
>>
>> (4) I tried to get some insight with gdb, but my skills are far to
>> small to get deeper. What I did:
>>
>> - Run R with 'R -d gdb791'
>> - Load library(rgdal) within R
>> - Set 'bt ogrInfo' in gdb for src/ogrsource.cpp:l46
>> - Continue R, run the following command:
>>
>>
>> ogrInfo("/home/rhurlin/SpatialData/world", "TM_WORLD_BORDERS-0.3")
>>
>> Breakpoint 1, ogrInfo (ogrsourcename=0x4b8cf458, Layer=0x4b8cf428) at
>> ogrsource.cpp:46
>> 46        int nFIDs, nFields, iField, *nCount, pc=0;
>> (gdb) n
>> 60        installErrorHandler();
>> (gdb) n
>> 62        poDS=(GDALDataset*)
>> GDALOpenEx(CHAR(STRING_ELT(ogrsourcename, 0)), GDAL_OF_VECTOR, NULL,
>> NULL, NULL);
>> (gdb) n
>> 63        if(poDS==NULL){
>> (gdb) bt
>> #0  ogrInfo (ogrsourcename=0x4b8cf458, Layer=0x4b8cf428) at
>> ogrsource.cpp:63
>> #1  0x0000000040adf576 in R_doDotCall (ofun=0x4bc14201 <ogrInfo(SEXP,
>> SEXP)>, nargs=2,
>>    cargs=0x7fffffffc5e0, call=0x4aae9f78) at dotcode.c:573
>> #2  0x0000000040aed4a2 in do_dotcall (call=0x4aae9f78, op=0x46ceeb50,
>> args=0x4ab53468, env=0x4ab400b0)
>>    at dotcode.c:1251
>> #3  0x0000000040b291c1 in Rf_eval (e=0x4aae9f78, rho=0x4ab400b0) at
>> eval.c:655
>> #4  0x0000000040b2dab3 in do_set (call=0x4aae6190, op=0x46cd71c8,
>> args=0x4aae88b0, rho=0x4ab400b0)
>>    at eval.c:2106
>> #5  0x0000000040b28f71 in Rf_eval (e=0x4aae6190, rho=0x4ab400b0) at
>> eval.c:627
>> #6  0x0000000040b2c9a0 in do_begin (call=0x4aae00b0, op=0x46cd8778,
>> args=0x4aae61c8, rho=0x4ab400b0)
>>    at eval.c:1716
>> #7  0x0000000040b28f71 in Rf_eval (e=0x4aae00b0, rho=0x4ab400b0) at
>> eval.c:627
>> #8  0x0000000040b2a256 in Rf_applyClosure (call=0x4aadc1c8,
>> op=0x4aade238, arglist=0x4ab40318,
>>    rho=0x46f0a708, suppliedvars=0x46cd4f78) at eval.c:1039
>> #9  0x0000000040b29304 in Rf_eval (e=0x4aadc1c8, rho=0x46f0a708) at
>> eval.c:674
>> #10 0x0000000040b6ad2c in Rf_ReplIteration (rho=0x46f0a708,
>> savestack=0, browselevel=0,
>>    state=0x7fffffffd580) at main.c:258
>> #11 0x0000000040b6aef0 in R_ReplConsole (rho=0x46f0a708, savestack=0,
>> browselevel=0) at main.c:308
>> #12 0x0000000040b6c682 in run_Rmainloop () at main.c:1009
>> #13 0x0000000040b6c697 in Rf_mainloop () at main.c:1016
>> #14 0x0000000000400a5c in main (ac=1, av=0x7fffffffe658) at Rmain.c:29
>> (gdb) n
>> 64          uninstallErrorHandlerAndTriggerError();
>> (gdb)
>> 65          error("Cannot open data source");
>> (gdb) n
>> Fehler in ogrInfo("/home/rhurlin/SpatialData/world",
>> "TM_WORLD_BORDERS-0.3") :
>>  Cannot open data source
>> run_Rmainloop () at main.c:1008
>> 1008        R_GlobalContext = R_ToplevelContext = R_SessionContext =
>> &R_Toplevel;
>> (gdb) n
>> 1009        R_ReplConsole(R_GlobalEnv, 0, 0);
>>
>>
>> Hope, my analysis it ok so far. From here on, I am lost and could
>> really need some help. Please ask me, if you need more information or
>> if I should try something.
>>
>> Many thanks in advance.
>> Regards,
>> Rainer Hurling
>>
>>
>> sessionInfo()
>> R Under development (unstable) (2015-07-14 r68652)
>> Platform: amd64-portbld-freebsd11.0 (64-bit)
>> Running under: FreeBSD xxx.xxx.xxx 11.0-CURRENT FreeBSD 11.0-CURRENT
>> #0 r285383: Sat Jul 11 10:39:33 CEST 2015
>> xxx at xxx.xxx.xxx:/usr/obj/usr/src/sys/XXX  amd64
>> locale:
>> [1] C/de_DE.UTF-8/de_DE.UTF-8/C/de_DE.UTF-8/de_DE.UTF-8
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>> other attached packages:
>> [1] rgdal_1.0-4 sp_1.1-1
>> loaded via a namespace (and not attached):
>> [1] grid_3.3.0      lattice_0.20-33


From synyster70 at gmail.com  Thu Jul 16 17:00:34 2015
From: synyster70 at gmail.com (Peter Gates)
Date: Thu, 16 Jul 2015 18:00:34 +0300
Subject: [R-sig-Geo] is it possible to do a double buffer around an area?
Message-ID: <CAEf0UwHqHyWUxqMJx3zkLyvezE6Vx4BUbCHNmuPGAjusMJtOhg@mail.gmail.com>

i have to do this so i can use if to put ranks in the raster.Also i have to
add mask.Can you help ?

	[[alternative HTML version deleted]]


From synyster70 at gmail.com  Thu Jul 16 17:07:15 2015
From: synyster70 at gmail.com (Peter Gates)
Date: Thu, 16 Jul 2015 18:07:15 +0300
Subject: [R-sig-Geo]  is it possible to do a double buffer around an area?
Message-ID: <CAEf0UwH5pMCun55u0DCFNiN3t0cNZMLFcT+e8EA+hgtX1xyCLQ@mail.gmail.com>

i have to do this so i can use" if" to put ranks in the raster.Also i have
to add mask.Can you help ?

	[[alternative HTML version deleted]]


From dexter.locke at gmail.com  Thu Jul 16 17:15:56 2015
From: dexter.locke at gmail.com (Dexter Locke)
Date: Thu, 16 Jul 2015 11:15:56 -0400
Subject: [R-sig-Geo] Recovering GWR Predicted Values from GGWR function
In-Reply-To: <alpine.LFD.2.11.1505202022550.15946@reclus.nhh.no>
References: <42F4267FAAD1BC4F968DAE5034E9AF0F1A398F20@NR3PWPGLCD2O.rb.win.frb.org>
	<alpine.LFD.2.11.1505202022550.15946@reclus.nhh.no>
Message-ID: <CAA=SVwFzsseuCOPz1F8SbkOhRnaFOw14_NtSHkcX_5kdbBma2g@mail.gmail.com>

Hi list,

Is there an in print citation to attribute this idea to "The aim of spgwr
has always been to explore the weaknesses of GWR as a technique, not to
help people use it"?

Or should I use something like "(R. Bivand, personal communication)"?

Thanks and happy R coding,
Dexter

On Wed, May 20, 2015 at 2:27 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:

> On Wed, 20 May 2015, Brown, Jason wrote:
>
>  Hello,
>>
>> I'm estimating a Poisson GWR using the ggwr function.  I would like to
>> recover the predicted values implied by the gwr model.  However, thus far
>> I've only been able to recover the fitted values from the global model
>> using $lm$fitted.values.  These obviously are the same values I get from a
>> standard Poisson model. Is it possible to get the gwr predicted values
>> instead?
>>
>
> No, they are not provided. They would only be available if the data points
> and the fit points were identical, or if newdata was available (and was
> admitted by the function, which it is not). The aim of spgwr has always
> been to explore the weaknesses of GWR as a technique, not to help people
> use it, so no provision for GLM-GWR predictions is likely to be forthcoming
> here (there are no coefficient standard errors either).
>
> Hope this clarifies,
>
> Roger
>
>
>> Thank you,
>> Jason
>>
>>
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 91 00
> e-mail: Roger.Bivand at nhh.no
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From robertomhorn at gmail.com  Thu Jul 16 21:52:03 2015
From: robertomhorn at gmail.com (Roberto Horn)
Date: Thu, 16 Jul 2015 16:52:03 -0300
Subject: [R-sig-Geo] Package MODIS error in function runMrt( ) object
 'ftpdirs' not found
In-Reply-To: <CAEBQMM=q3asZsWxAZW-9eMJqc8dJO_Trk6f2FNuzUpvUK8_6fQ@mail.gmail.com>
References: <CAG42j+Pd6NQo4AwhvwdOdW-rJa+dk0qyu4Vsa1GWo9C-D7yY6Q@mail.gmail.com>
	<CAP8THHVUGdgKaOqfQZxs3x3Vh_jU8H=z0YQ_+zsoxj3YkfVaww@mail.gmail.com>
	<CAG42j+Ne64D+h2wpno-DaDxjgN2j+eOWxos7tgTPYzxV1wGUtg@mail.gmail.com>
	<CAEBQMM=q3asZsWxAZW-9eMJqc8dJO_Trk6f2FNuzUpvUK8_6fQ@mail.gmail.com>
Message-ID: <CAG42j+Mj9Be=7kOBw_qsX8ws3yP1pgtm1mRsYq4ifa2DXNb6XA@mail.gmail.com>

Hello,



I installed here the version of the package in the attached file...
runMrt() still does not work here but I can be wrong. The function
that Ahmadou sent worked just fine.

I am going to start using runGdal. It works the same manner as runMrt
form what I saw in the documentation... There is any big difference?


Thanks


From r-sig-geo at forreststevens.com  Thu Jul 16 21:57:45 2015
From: r-sig-geo at forreststevens.com (Forrest Stevens)
Date: Thu, 16 Jul 2015 19:57:45 +0000
Subject: [R-sig-Geo] Package MODIS error in function runMrt( ) object
 'ftpdirs' not found
In-Reply-To: <CAG42j+Mj9Be=7kOBw_qsX8ws3yP1pgtm1mRsYq4ifa2DXNb6XA@mail.gmail.com>
References: <CAG42j+Pd6NQo4AwhvwdOdW-rJa+dk0qyu4Vsa1GWo9C-D7yY6Q@mail.gmail.com>
	<CAP8THHVUGdgKaOqfQZxs3x3Vh_jU8H=z0YQ_+zsoxj3YkfVaww@mail.gmail.com>
	<CAG42j+Ne64D+h2wpno-DaDxjgN2j+eOWxos7tgTPYzxV1wGUtg@mail.gmail.com>
	<CAEBQMM=q3asZsWxAZW-9eMJqc8dJO_Trk6f2FNuzUpvUK8_6fQ@mail.gmail.com>
	<CAG42j+Mj9Be=7kOBw_qsX8ws3yP1pgtm1mRsYq4ifa2DXNb6XA@mail.gmail.com>
Message-ID: <CAEBQMMnZ2m4V88xH7jDEn4tkONbAv6Begcb_U2E+rG-0cSrcyg@mail.gmail.com>

Does it fail in exactly the same way?  And no, in practice you shouldn't
see any large differences in reprojected/mosaicked output. The only
difference is less hassle with getting a working MRT in place. :)

Sincerely,
Forrest

On Thu, Jul 16, 2015 at 3:52 PM Roberto Horn <robertomhorn at gmail.com> wrote:

> Hello,
>
>
>
> I installed here the version of the package in the attached file...
> runMrt() still does not work here but I can be wrong. The function
> that Ahmadou sent worked just fine.
>
> I am going to start using runGdal. It works the same manner as runMrt
> form what I saw in the documentation... There is any big difference?
>
>
> Thanks
>

	[[alternative HTML version deleted]]


From robertomhorn at gmail.com  Thu Jul 16 22:09:17 2015
From: robertomhorn at gmail.com (Roberto Horn)
Date: Thu, 16 Jul 2015 17:09:17 -0300
Subject: [R-sig-Geo] Package MODIS error in function runMrt( ) object
 'ftpdirs' not found
In-Reply-To: <CAEBQMMnZ2m4V88xH7jDEn4tkONbAv6Begcb_U2E+rG-0cSrcyg@mail.gmail.com>
References: <CAG42j+Pd6NQo4AwhvwdOdW-rJa+dk0qyu4Vsa1GWo9C-D7yY6Q@mail.gmail.com>
	<CAP8THHVUGdgKaOqfQZxs3x3Vh_jU8H=z0YQ_+zsoxj3YkfVaww@mail.gmail.com>
	<CAG42j+Ne64D+h2wpno-DaDxjgN2j+eOWxos7tgTPYzxV1wGUtg@mail.gmail.com>
	<CAEBQMM=q3asZsWxAZW-9eMJqc8dJO_Trk6f2FNuzUpvUK8_6fQ@mail.gmail.com>
	<CAG42j+Mj9Be=7kOBw_qsX8ws3yP1pgtm1mRsYq4ifa2DXNb6XA@mail.gmail.com>
	<CAEBQMMnZ2m4V88xH7jDEn4tkONbAv6Begcb_U2E+rG-0cSrcyg@mail.gmail.com>
Message-ID: <CAG42j+NeVVu3n1jkB83jx3CHyptFWVb+6su7JJeYG-3AjPptdw@mail.gmail.com>

Hello,


No, it is different:

runMrt(product="MOD09GQ",tileH="13",tileV="11" ,begin=paste0(begingq),
end=paste0(endgq), SDSstring="0110000000", job=paste0(jobgq),
outProj="GEO", datum="WGS84", pixelSize="0.0023487", mosaic="FALSE")


All suggested packages are installed
Detecting available write drivers!
Found: 62 candidate drivers, detecting file extensions...
44 usable drivers detected!
Output projection: Geographic
Output pixel size: 0.0023487
Resampling method: nn
No output projection parameters specified. Reprojecting with no Parameters!
Error in `[.default`(ftpdirs[[1]], , todo[u]) :
  incorrect number of dimensions


Att

	[[alternative HTML version deleted]]


From r-sig-geo at forreststevens.com  Thu Jul 16 22:43:27 2015
From: r-sig-geo at forreststevens.com (Forrest Stevens)
Date: Thu, 16 Jul 2015 20:43:27 +0000
Subject: [R-sig-Geo] Package MODIS error in function runMrt( ) object
 'ftpdirs' not found
In-Reply-To: <CAG42j+NeVVu3n1jkB83jx3CHyptFWVb+6su7JJeYG-3AjPptdw@mail.gmail.com>
References: <CAG42j+Pd6NQo4AwhvwdOdW-rJa+dk0qyu4Vsa1GWo9C-D7yY6Q@mail.gmail.com>
	<CAP8THHVUGdgKaOqfQZxs3x3Vh_jU8H=z0YQ_+zsoxj3YkfVaww@mail.gmail.com>
	<CAG42j+Ne64D+h2wpno-DaDxjgN2j+eOWxos7tgTPYzxV1wGUtg@mail.gmail.com>
	<CAEBQMM=q3asZsWxAZW-9eMJqc8dJO_Trk6f2FNuzUpvUK8_6fQ@mail.gmail.com>
	<CAG42j+Mj9Be=7kOBw_qsX8ws3yP1pgtm1mRsYq4ifa2DXNb6XA@mail.gmail.com>
	<CAEBQMMnZ2m4V88xH7jDEn4tkONbAv6Begcb_U2E+rG-0cSrcyg@mail.gmail.com>
	<CAG42j+NeVVu3n1jkB83jx3CHyptFWVb+6su7JJeYG-3AjPptdw@mail.gmail.com>
Message-ID: <CAEBQMMnHPVuULxRHr8tPfVRJgDxo2DFrNFxWBjg88aig0bc7Sg@mail.gmail.com>

Thanks for catching that!  I've responded directly with a package file
attached, but the incomplete fix should be corrected in the next R-Forge
release.

Sincerely,
Forrest

On Thu, Jul 16, 2015 at 4:09 PM Roberto Horn <robertomhorn at gmail.com> wrote:

> Hello,
>
>
> No, it is different:
>
> runMrt(product="MOD09GQ",tileH="13",tileV="11" ,begin=paste0(begingq),
> end=paste0(endgq), SDSstring="0110000000", job=paste0(jobgq),
> outProj="GEO", datum="WGS84", pixelSize="0.0023487", mosaic="FALSE")
>
>
>
> All suggested packages are installed
> Detecting available write drivers!
> Found: 62 candidate drivers, detecting file extensions...
> 44 usable drivers detected!
> Output projection: Geographic
> Output pixel size: 0.0023487
>
> Resampling method: nn
> No output projection parameters specified. Reprojecting with no Parameters!
> Error in `[.default`(ftpdirs[[1]], , todo[u]) :
>   incorrect number of dimensions
>
>
> Att
>

	[[alternative HTML version deleted]]


From Roger.Bivand at nhh.no  Thu Jul 16 23:52:16 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 16 Jul 2015 23:52:16 +0200
Subject: [R-sig-Geo] Bayesian model comparison
In-Reply-To: <CABW+3tCXHQU5SZ+H_U1xkomGiCU+pWFfWEjuy-t34r5LEQ4qcg@mail.gmail.com>
References: <CABW+3tBk7j0Y0ysGT1O+HugiwG0PsH5_JQLByzWe0M6RcvVn8A@mail.gmail.com>
	<alpine.LFD.2.11.1507161137370.3629@reclus.nhh.no>
	<CABW+3tCXHQU5SZ+H_U1xkomGiCU+pWFfWEjuy-t34r5LEQ4qcg@mail.gmail.com>
Message-ID: <alpine.LFD.2.11.1507162350450.7325@reclus.nhh.no>

On Thu, 16 Jul 2015, Antonio Bubbico wrote:

> Hello Roger,
>
> thanks for that. Is there any available code that I can take as an example?

INLABMA is on CRAN; maybe see the documentation for the slm latent model 
om the R-INLA website, and possibly a paper in the JSS spatial statistics 
special number.

Roger

>
> Regards.
>
> 2015-07-16 11:41 GMT+02:00 Roger Bivand <Roger.Bivand at nhh.no>:
>
>> On Thu, 16 Jul 2015, Antonio Bubbico wrote:
>>
>>  Hello,
>>>
>>> I would like to make a bayesian model comparison among SLX, SDM and SDEM
>>> and produce model probabilities for all three. I would like to make it
>>> rather than using likelihood
>>> ratio tests that rely on two-way comparisons (Le Sage, 2014).
>>>
>>> Can you suggest to me some package to make the model comparison among the
>>> three models?
>>>
>>
>> Experimentally, try INLABMA and INLA with the slm latent model. The slm
>> latent model itself with BIC or similar may be enough. These estimation
>> methods are still under development.
>>
>> Roger
>>
>>
>>> Thanks.
>>>
>>>
>>>
>> --
>> Roger Bivand
>> Department of Economics, Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 91 00
>> e-mail: Roger.Bivand at nhh.no
>>
>>
>
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Fri Jul 17 00:00:21 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 17 Jul 2015 00:00:21 +0200
Subject: [R-sig-Geo] Recovering GWR Predicted Values from GGWR function
In-Reply-To: <CAA=SVwFzsseuCOPz1F8SbkOhRnaFOw14_NtSHkcX_5kdbBma2g@mail.gmail.com>
References: <42F4267FAAD1BC4F968DAE5034E9AF0F1A398F20@NR3PWPGLCD2O.rb.win.frb.org>
	<alpine.LFD.2.11.1505202022550.15946@reclus.nhh.no>
	<CAA=SVwFzsseuCOPz1F8SbkOhRnaFOw14_NtSHkcX_5kdbBma2g@mail.gmail.com>
Message-ID: <alpine.LFD.2.11.1507162359190.7325@reclus.nhh.no>

On Thu, 16 Jul 2015, Dexter Locke wrote:

> Hi list,
>
> Is there an in print citation to attribute this idea to "The aim of spgwr
> has always been to explore the weaknesses of GWR as a technique, not to
> help people use it"?
>
> Or should I use something like "(R. Bivand, personal communication)"?

Mailing lists are public communications, so cite by URL to the list 
archives if you so please.

Roger

>
> Thanks and happy R coding,
> Dexter
>
> On Wed, May 20, 2015 at 2:27 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> On Wed, 20 May 2015, Brown, Jason wrote:
>>
>>  Hello,
>>>
>>> I'm estimating a Poisson GWR using the ggwr function.  I would like to
>>> recover the predicted values implied by the gwr model.  However, thus far
>>> I've only been able to recover the fitted values from the global model
>>> using $lm$fitted.values.  These obviously are the same values I get from a
>>> standard Poisson model. Is it possible to get the gwr predicted values
>>> instead?
>>>
>>
>> No, they are not provided. They would only be available if the data points
>> and the fit points were identical, or if newdata was available (and was
>> admitted by the function, which it is not). The aim of spgwr has always
>> been to explore the weaknesses of GWR as a technique, not to help people
>> use it, so no provision for GLM-GWR predictions is likely to be forthcoming
>> here (there are no coefficient standard errors either).
>>
>> Hope this clarifies,
>>
>> Roger
>>
>>
>>> Thank you,
>>> Jason
>>>
>>>
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>> --
>> Roger Bivand
>> Department of Economics, Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 91 00
>> e-mail: Roger.Bivand at nhh.no
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From pierluigi.derosa at gmail.com  Fri Jul 17 18:48:54 2015
From: pierluigi.derosa at gmail.com (pierluigi de rosa)
Date: Fri, 17 Jul 2015 18:48:54 +0200
Subject: [R-sig-Geo] Cumulate space time data over days
Message-ID: <CAAgsrZhT_D=63Y7cOPd1kYdj_9NE1usHWJR6tGS=yqgSyZE5uA@mail.gmail.com>

Dear all,

I'm have a simple question that I think should be easly to answer but I'm
an R beginner anf I didn't find nothing exactly what I need.

I have a STFDF that register rainfall data over 14 years in 30 monitoring
stations.
I need to evaluate for each day the cumulative rainfall of the 3 days
before (or 72 hours) and than extract data where this cumulative value is
above a threshold.

How ca I reach that?
Thanks

Summary of my data is below
Thanks
Pierluigi

> summary(pioggieST1)
Object of class STFDF
 with Dimensions (s, t, attr): (30, 8401, 1)
[[Spatial:]]
Object of class SpatialPointsDataFrame
Coordinates:
              min     max
coords.x1 2272679 2320496
coords.x2 4698989 4821088
Is projected: TRUE
proj4string :
[+proj=tmerc +lat_0=0 +lon_0=15 +k=0.9996 +x_0=2520000 +y_0=0 +ellps=intl
+units=m +no_defs]
Number of points: 30
Data attributes:
                nome
 Allerona         : 1
 Amelia           : 1
 Attigliano       : 1
 Avigliano_Umbro  : 1
 Bastardo         : 1
 Calvi_dell_Umbria: 1
 (Other)          :24
[[Temporal:]]
     Index              timeIndex
 Min.   :1991-01-01   Min.   :   1
 1st Qu.:1996-10-01   1st Qu.:2101
 Median :2002-07-02   Median :4201
 Mean   :2002-07-02   Mean   :4201
 3rd Qu.:2008-04-01   3rd Qu.:6301
 Max.   :2013-12-31   Max.   :8401
[[Data attributes:]]
     values
 Min.   :  0.000
 1st Qu.:  0.000
 Median :  0.000
 Mean   :  1.489
 3rd Qu.:  0.000
 Max.   :273.000


-- 
Ing. Pierluigi De Rosa (PhD)
cel: 3497558268 / fax: 075 7823038
skype: pierluigi.derosa

	[[alternative HTML version deleted]]


From virgilio.gomez at uclm.es  Fri Jul 17 19:11:47 2015
From: virgilio.gomez at uclm.es (Virgilio =?ISO-8859-1?Q?G=F3mez-Rubio?=)
Date: Fri, 17 Jul 2015 19:11:47 +0200
Subject: [R-sig-Geo] Bayesian model comparison
In-Reply-To: <alpine.LFD.2.11.1507162350450.7325@reclus.nhh.no>
References: <CABW+3tBk7j0Y0ysGT1O+HugiwG0PsH5_JQLByzWe0M6RcvVn8A@mail.gmail.com>
	<alpine.LFD.2.11.1507161137370.3629@reclus.nhh.no>
	<CABW+3tCXHQU5SZ+H_U1xkomGiCU+pWFfWEjuy-t34r5LEQ4qcg@mail.gmail.com>
	<alpine.LFD.2.11.1507162350450.7325@reclus.nhh.no>
Message-ID: <1437153107.2151.22.camel@uclm.es>

Hi,

> INLABMA is on CRAN; maybe see the documentation for the slm latent model 
> om the R-INLA website, and possibly a paper in the JSS spatial statistics 
> special number.

For the slm latent effect, you can also check the materials on spatial
econometrics model of my tutorial at useR! 2015:

http://www.uclm.es/profesorado/vgomez/useR2015/

In any case, the slm latent effect in INLA is still experimental. 

Best wishes,

Virgilio


From selebatsom at yahoo.co.uk  Sat Jul 18 17:27:02 2015
From: selebatsom at yahoo.co.uk (moses selebatso)
Date: Sat, 18 Jul 2015 15:27:02 +0000 (UTC)
Subject: [R-sig-Geo] converting latlong in decimal degrees to utm
Message-ID: <763860304.201224.1437233222528.JavaMail.yahoo@mail.yahoo.com>

I am trying to get my data (sample below) to utm before I can use it for Kernel Density Estimates. Can?someone help?
> data<-read.csv("clipboard",sep="\t")
> head(data)
????????? x??????? y
1 -21.76580 23.20185
2 -21.76692 23.20126
3 -21.76690 23.20127
4 -21.76761 23.20338
5 -21.77223 23.20354
6 -21.77193 23.20327
> proj4string(data) <- CRS("+proj=utm +zone=34 +south +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs")
Error in (function (classes, fdef, mtable)? : 
? unable to find an inherited method for function ?proj4string<-? for signature ?"data.frame", "CRS"?
Thank you, in advance.?Moses SELEBATSO

(+267) 318 5219 (H) (+267) 716 393 70 (C)
 ?(+267) 738 393 70 (C
	[[alternative HTML version deleted]]


From bfalevlist at gmail.com  Sat Jul 18 17:46:30 2015
From: bfalevlist at gmail.com (=?UTF-8?Q?Bede-Fazekas_=C3=81kos?=)
Date: Sat, 18 Jul 2015 17:46:30 +0200
Subject: [R-sig-Geo] converting latlong in decimal degrees to utm
In-Reply-To: <763860304.201224.1437233222528.JavaMail.yahoo@mail.yahoo.com>
References: <763860304.201224.1437233222528.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <000801d0c170$eb9d0ae0$c2d720a0$@gmail.com>

Dear Moses,
you need firstly install the package "sp", then load it, and after that you should convert your data.frame to SpatialPoints or SpatialPointsDataFrame by setting the coordinates.

if (!("sp" %in% row.names(installed.packages()))){ # if package "sp" not yet installed
	suppressMessages(install.packages("sp", verbose = FALSE, quiet = TRUE, INSTALL_opts = c("--no-lock"), repos = "http://cran.us.r-project.org")) # installs it
} # if
library(sp) # loads it
coordinates(data) <- c("x", "y") # sets coordinates
if (class(data) == "SpatialPoints") {writeLines("Well done.")} # Now you can set projection.

Hope it helps,
?kos

-----Original Message-----
From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of moses selebatso
Sent: 2015. j?lius 18. 17:27
To: R-sig-Geo at r-project.org
Subject: [R-sig-Geo] converting latlong in decimal degrees to utm

I am trying to get my data (sample below) to utm before I can use it for Kernel Density Estimates. Can someone help?
> data<-read.csv("clipboard",sep="\t")
> head(data)
          x        y
1 -21.76580 23.20185
2 -21.76692 23.20126
3 -21.76690 23.20127
4 -21.76761 23.20338
5 -21.77223 23.20354
6 -21.77193 23.20327
> proj4string(data) <- CRS("+proj=utm +zone=34 +south +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs")
Error in (function (classes, fdef, mtable)  : 
  unable to find an inherited method for function ?proj4string<-? for signature ?"data.frame", "CRS"?
Thank you, in advance. Moses SELEBATSO

(+267) 318 5219 (H) (+267) 716 393 70 (C)
  (+267) 738 393 70 (C
	[[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From julian at hafro.is  Sat Jul 18 23:00:42 2015
From: julian at hafro.is (Julian Burgos)
Date: Sat, 18 Jul 2015 21:00:42 -0000
Subject: [R-sig-Geo] converting latlong in decimal degrees to utm
In-Reply-To: <000801d0c170$eb9d0ae0$c2d720a0$@gmail.com>
References: <763860304.201224.1437233222528.JavaMail.yahoo@mail.yahoo.com>
	<000801d0c170$eb9d0ae0$c2d720a0$@gmail.com>
Message-ID: <6aad23376ae3ee3971aaea35935cded1.squirrel@webmail.hafro.is>

Actually, you need to set the projection of the original data, and then
use spTransform the coordinates into UTM.  Do this:

data<-read.csv("clipboard",sep="\t")

library(sp)

coordinates(data) <- c("x", "y") # Creates a SpatialPoints object where x
and y are the coordinates, assuming that "x" is the horizontal coordinate
and "y" is the vertical one

proj4string(data) <- CRS("+proj=longlat + ellps=WGS84") # This sets the
projection of the data, assuming that you are using the WGS84 ellipsoid
(if you do not know for sure, it is a safe assumption)

data <-spTransform(data,CRS="+proj=utm +zone=27 +datum=WGS84") # Use
whatever UTM zone you need.

data <- as.data.frame(coordinates(data)) # This converts the SpatialPoints
object back into a data frame

All the best,

Julian

-- 
Julian Mariano Burgos, PhD
Hafranns?knastofnun/Marine Research Institute
Sk?lagata 4, 121 Reykjav?k, Iceland
S?mi/Telephone : +354-5752037
Br?fs?mi/Telefax:  +354-5752001
Netfang/Email: julian at hafro.is




> Dear Moses,
> you need firstly install the package "sp", then load it, and after that
> you should convert your data.frame to SpatialPoints or
> SpatialPointsDataFrame by setting the coordinates.
>
> if (!("sp" %in% row.names(installed.packages()))){ # if package "sp" not
> yet installed
> 	suppressMessages(install.packages("sp", verbose = FALSE, quiet = TRUE,
> INSTALL_opts = c("--no-lock"), repos = "http://cran.us.r-project.org")) #
> installs it
> } # if
> library(sp) # loads it
> coordinates(data) <- c("x", "y") # sets coordinates
> if (class(data) == "SpatialPoints") {writeLines("Well done.")} # Now you
> can set projection.
>
> Hope it helps,
> ?kos
>
> -----Original Message-----
> From: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of
> moses selebatso
> Sent: 2015. j?lius 18. 17:27
> To: R-sig-Geo at r-project.org
> Subject: [R-sig-Geo] converting latlong in decimal degrees to utm
>
> I am trying to get my data (sample below) to utm before I can use it for
> Kernel Density Estimates. Can someone help?
>> data<-read.csv("clipboard",sep="\t")
>> head(data)
>           x        y
> 1 -21.76580 23.20185
> 2 -21.76692 23.20126
> 3 -21.76690 23.20127
> 4 -21.76761 23.20338
> 5 -21.77223 23.20354
> 6 -21.77193 23.20327
>> proj4string(data) <- CRS("+proj=utm +zone=34 +south +ellps=WGS84
>> +towgs84=0,0,0,0,0,0,0 +units=m +no_defs")
> Error in (function (classes, fdef, mtable)  :
>   unable to find an inherited method for function ?proj4string<-? for
> signature ?"data.frame", "CRS"?
> Thank you, in advance. Moses SELEBATSO
>
> (+267) 318 5219 (H) (+267) 716 393 70 (C)
>   (+267) 738 393 70 (C
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From pep.bioalerts at gmail.com  Sun Jul 19 19:10:19 2015
From: pep.bioalerts at gmail.com (Josep M Serra diaz)
Date: Sun, 19 Jul 2015 13:10:19 -0400
Subject: [R-sig-Geo] from x,y plot to a raster with Raster package?
Message-ID: <CAF8H1dcL=wc7R_5977CkEr8rPB9KeUFRHU_FgVgcQoFAFGhkFA@mail.gmail.com>

Hi everyone,

I am wondering if I can speed up the process of transforming from  a 'plot'
(or matrix) to a raster.

The idea is that I have a matrix with x,y,z values. and I have a raster
with spatial data for x and for y, and I want to get a raster of z.

I would know how to do it on a cell-by-cell basis, but I was hoping there
was a more efficient way, since I have more than 14Milion Cells.

I left an simple example below to see the not very efficient way in which I
was dealing with it, hoping that someone will let me know that I have a
better chance trying with a function in the raster package that can do that
very easily. So far, I have tried with calc, but it is saying that 'I
cannot use this function'.




###### SIMPLE EXAMPLE

##dimensions of the matrix
mat <- list( x=c(23,25,27), y=c(33,34,35) , z=c(0.1,0.2,0.3))
mat2 <- matrix (data = mat$z,nrow=3, ncol=3,dimnames = mat[c(1,2)])

#input raster x axis
r1 <- raster ( nrows=10, ncols=10, crs=NA)
r1[] <- runif(n = 100,min=20,max=28)

#input raster y axis
r2 <- raster ( nrows=10, ncols=10, crs=NA)
r2[] <- runif(n = 100,min=31,max=36)


#AIM: I want a raster that has in the cell values the corresponding value
of the z dimension in mat.
#    That is r1 contains the values of the xaxis in mat, r2 contains inputs
values of the y axis in mat
#    I want the raster with the values of z in mat


#on a cell by cell basis it is 'easy'

cell.values <- lapply (1:ncell(r1),FUN = function (i){
  pos.x.axis <- if (r1[i] < range(mat$x)[1] | r1[i] > range(mat$x)[2]) {NA}
else{
    which(abs(r1[i]-mat$x) == min(abs(r1[i]-mat$x))) #it gives me the
closest postition in the y axis
    }

  pos.y.axis <- if (r2[i] < range(mat$y)[1] | r2[i] > range(mat$y)[2]) {NA}
else{
    which(abs(r2[i]-mat$x) == min(abs(r2[i]-mat$x))) #it gives me the
closest postition i nthe y axis
  }

  if (is.na (pos.x.axis) ==T | is.na(pos.y.axis)==T) {out.value <- NA} else{
    out.value <- mat2[pos.x.axis, pos.y.axis]
  }

  return (out.value)

})

raster.out <- r1 ; raster.out [] <- NA
raster.out[]<- unlist(cell.values)
plot (raster.out)


any hint on how to do it for 14Milion cells?

	[[alternative HTML version deleted]]


From r.hijmans at gmail.com  Sun Jul 19 22:35:49 2015
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sun, 19 Jul 2015 13:35:49 -0700
Subject: [R-sig-Geo] from x,y plot to a raster with Raster package?
In-Reply-To: <CAF8H1dcL=wc7R_5977CkEr8rPB9KeUFRHU_FgVgcQoFAFGhkFA@mail.gmail.com>
References: <CAF8H1dcL=wc7R_5977CkEr8rPB9KeUFRHU_FgVgcQoFAFGhkFA@mail.gmail.com>
Message-ID: <CANtt_hyKZzji_UU1TsvTnWxUmgUEGvTwNf_i7V_YBcQz2G+2mA@mail.gmail.com>

Josep,

I take it you have three variables, and want to create a raster for
the third variable, based on the other two, that are also represented
as rasters. If so, you can

# make a three column data.frame
d <- data.frame( x=c(23,25,27), y=c(33,34,35) , z=c(0.1,0.2,0.3))

# your two rasters, representing x and y
library(raster)
x <- y <- raster ( nrows=10, ncols=10, crs=NA)
values(x) <- runif(n=100, min=20, max=28)
values(y) <- runif(n=100, min=31, max=36)

# combine them
s <- stack(x, y)

# round them to match to x and y in 'd'
s <- round(s)

# compute z, based on x and y using 'subs' (equivalent to base::merge)
z <- subs(s, d, by=1:2)

# test
x <- stack(s, z)
# should have the same values as 'd'
unique(na.omit(values(x)))

Robert

On Sun, Jul 19, 2015 at 10:10 AM, Josep M Serra diaz
<pep.bioalerts at gmail.com> wrote:
> Hi everyone,
>
> I am wondering if I can speed up the process of transforming from  a 'plot'
> (or matrix) to a raster.
>
> The idea is that I have a matrix with x,y,z values. and I have a raster
> with spatial data for x and for y, and I want to get a raster of z.
>
> I would know how to do it on a cell-by-cell basis, but I was hoping there
> was a more efficient way, since I have more than 14Milion Cells.
>
> I left an simple example below to see the not very efficient way in which I
> was dealing with it, hoping that someone will let me know that I have a
> better chance trying with a function in the raster package that can do that
> very easily. So far, I have tried with calc, but it is saying that 'I
> cannot use this function'.
>
>
>
>
> ###### SIMPLE EXAMPLE
>
> ##dimensions of the matrix
> mat <- list( x=c(23,25,27), y=c(33,34,35) , z=c(0.1,0.2,0.3))
> mat2 <- matrix (data = mat$z,nrow=3, ncol=3,dimnames = mat[c(1,2)])
>
> #input raster x axis
> r1 <- raster ( nrows=10, ncols=10, crs=NA)
> r1[] <- runif(n = 100,min=20,max=28)
>
> #input raster y axis
> r2 <- raster ( nrows=10, ncols=10, crs=NA)
> r2[] <- runif(n = 100,min=31,max=36)
>
>
> #AIM: I want a raster that has in the cell values the corresponding value
> of the z dimension in mat.
> #    That is r1 contains the values of the xaxis in mat, r2 contains inputs
> values of the y axis in mat
> #    I want the raster with the values of z in mat
>
>
> #on a cell by cell basis it is 'easy'
>
> cell.values <- lapply (1:ncell(r1),FUN = function (i){
>   pos.x.axis <- if (r1[i] < range(mat$x)[1] | r1[i] > range(mat$x)[2]) {NA}
> else{
>     which(abs(r1[i]-mat$x) == min(abs(r1[i]-mat$x))) #it gives me the
> closest postition in the y axis
>     }
>
>   pos.y.axis <- if (r2[i] < range(mat$y)[1] | r2[i] > range(mat$y)[2]) {NA}
> else{
>     which(abs(r2[i]-mat$x) == min(abs(r2[i]-mat$x))) #it gives me the
> closest postition i nthe y axis
>   }
>
>   if (is.na (pos.x.axis) ==T | is.na(pos.y.axis)==T) {out.value <- NA} else{
>     out.value <- mat2[pos.x.axis, pos.y.axis]
>   }
>
>   return (out.value)
>
> })
>
> raster.out <- r1 ; raster.out [] <- NA
> raster.out[]<- unlist(cell.values)
> plot (raster.out)
>
>
> any hint on how to do it for 14Milion cells?
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From pep.bioalerts at gmail.com  Mon Jul 20 04:15:35 2015
From: pep.bioalerts at gmail.com (Pep SD)
Date: Sun, 19 Jul 2015 22:15:35 -0400
Subject: [R-sig-Geo] from x,y plot to a raster with Raster package?
In-Reply-To: <CANtt_hyKZzji_UU1TsvTnWxUmgUEGvTwNf_i7V_YBcQz2G+2mA@mail.gmail.com>
References: <CAF8H1dcL=wc7R_5977CkEr8rPB9KeUFRHU_FgVgcQoFAFGhkFA@mail.gmail.com>
	<CANtt_hyKZzji_UU1TsvTnWxUmgUEGvTwNf_i7V_YBcQz2G+2mA@mail.gmail.com>
Message-ID: <CAF8H1dfACp0mcasGOnMWopjYVCFxK-Unz_exLOYFz=qatyysWg@mail.gmail.com>

Hi Robert,

Thank you for your prompt response. That was actually really helpful.

The issue comes when your x and y axis on the plot (or the data) are
actually not round values and therefore we cannot do the  rounding
('s<-round(s)'). In that case we need to reassign each value, but I do not
know how to do it efficiently

Consider this case (from your example)

# make a three column data.frame
d <- data.frame( x=c(23.2, 33.7966 , 44.3932 ), y=c(33.2 , 34.46426 ,
35.72852) , z=c(0.1,0.2,0.3))

# your two rasters, representing x and y
library(raster)
x <- y <- raster ( nrows=10, ncols=10, crs=NA)
values(x) <- runif(n=100, min=22, max=45)
values(y) <- runif(n=100, min=31, max=37)



#before attempting to perform subs with the d data.frame as a base for
substitution, we need the x and y raster to match EXACTLY the values in the
axis.

#applying it on a cell by cell basis, it is easy...we try the nearest
neighbor value.
lapply (values (x), FUN = function (i) which.min(abs(i - d$x)))

#is there a way to do it with calc? I am just saying because lapplying over
a 14M cells might be slow
v1 <- calc(x = x,fun = function (x) which.min(abs(x - d$x))) #obviously
didnt work :(



THANKS !

Pep




2015-07-19 16:35 GMT-04:00 Robert J. Hijmans <r.hijmans at gmail.com>:

> Josep,
>
> I take it you have three variables, and want to create a raster for
> the third variable, based on the other two, that are also represented
> as rasters. If so, you can
>
> # make a three column data.frame
> d <- data.frame( x=c(23,25,27), y=c(33,34,35) , z=c(0.1,0.2,0.3))
>
> # your two rasters, representing x and y
> library(raster)
> x <- y <- raster ( nrows=10, ncols=10, crs=NA)
> values(x) <- runif(n=100, min=20, max=28)
> values(y) <- runif(n=100, min=31, max=36)
>
> # combine them
> s <- stack(x, y)
>
> # round them to match to x and y in 'd'
> s <- round(s)
>
> # compute z, based on x and y using 'subs' (equivalent to base::merge)
> z <- subs(s, d, by=1:2)
>
> # test
> x <- stack(s, z)
> # should have the same values as 'd'
> unique(na.omit(values(x)))
>
> Robert
>
> On Sun, Jul 19, 2015 at 10:10 AM, Josep M Serra diaz
> <pep.bioalerts at gmail.com> wrote:
> > Hi everyone,
> >
> > I am wondering if I can speed up the process of transforming from  a
> 'plot'
> > (or matrix) to a raster.
> >
> > The idea is that I have a matrix with x,y,z values. and I have a raster
> > with spatial data for x and for y, and I want to get a raster of z.
> >
> > I would know how to do it on a cell-by-cell basis, but I was hoping there
> > was a more efficient way, since I have more than 14Milion Cells.
> >
> > I left an simple example below to see the not very efficient way in
> which I
> > was dealing with it, hoping that someone will let me know that I have a
> > better chance trying with a function in the raster package that can do
> that
> > very easily. So far, I have tried with calc, but it is saying that 'I
> > cannot use this function'.
> >
> >
> >
> >
> > ###### SIMPLE EXAMPLE
> >
> > ##dimensions of the matrix
> > mat <- list( x=c(23,25,27), y=c(33,34,35) , z=c(0.1,0.2,0.3))
> > mat2 <- matrix (data = mat$z,nrow=3, ncol=3,dimnames = mat[c(1,2)])
> >
> > #input raster x axis
> > r1 <- raster ( nrows=10, ncols=10, crs=NA)
> > r1[] <- runif(n = 100,min=20,max=28)
> >
> > #input raster y axis
> > r2 <- raster ( nrows=10, ncols=10, crs=NA)
> > r2[] <- runif(n = 100,min=31,max=36)
> >
> >
> > #AIM: I want a raster that has in the cell values the corresponding value
> > of the z dimension in mat.
> > #    That is r1 contains the values of the xaxis in mat, r2 contains
> inputs
> > values of the y axis in mat
> > #    I want the raster with the values of z in mat
> >
> >
> > #on a cell by cell basis it is 'easy'
> >
> > cell.values <- lapply (1:ncell(r1),FUN = function (i){
> >   pos.x.axis <- if (r1[i] < range(mat$x)[1] | r1[i] > range(mat$x)[2])
> {NA}
> > else{
> >     which(abs(r1[i]-mat$x) == min(abs(r1[i]-mat$x))) #it gives me the
> > closest postition in the y axis
> >     }
> >
> >   pos.y.axis <- if (r2[i] < range(mat$y)[1] | r2[i] > range(mat$y)[2])
> {NA}
> > else{
> >     which(abs(r2[i]-mat$x) == min(abs(r2[i]-mat$x))) #it gives me the
> > closest postition i nthe y axis
> >   }
> >
> >   if (is.na (pos.x.axis) ==T | is.na(pos.y.axis)==T) {out.value <- NA}
> else{
> >     out.value <- mat2[pos.x.axis, pos.y.axis]
> >   }
> >
> >   return (out.value)
> >
> > })
> >
> > raster.out <- r1 ; raster.out [] <- NA
> > raster.out[]<- unlist(cell.values)
> > plot (raster.out)
> >
> >
> > any hint on how to do it for 14Milion cells?
> >
> >         [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From jl.iccp at gmail.com  Mon Jul 20 10:43:17 2015
From: jl.iccp at gmail.com (Jue Lin-Ye)
Date: Mon, 20 Jul 2015 10:43:17 +0200
Subject: [R-sig-Geo] Cumulate space time data over days
Message-ID: <CAAMkPW_6Uuu8MaAK5KzANX9_o06TCcsWaTPqpCrt82DA5D6h+g@mail.gmail.com>

Dear Dr. De Rosa,

May you attach some data to your e-mail so we could reproduce your case?

Best regards,

-- 
Jue

	[[alternative HTML version deleted]]


From jl.iccp at gmail.com  Mon Jul 20 12:43:45 2015
From: jl.iccp at gmail.com (Jue Lin-Ye)
Date: Mon, 20 Jul 2015 12:43:45 +0200
Subject: [R-sig-Geo] Cumulate space time data over days
In-Reply-To: <CAAgsrZiCCR-3=JjnGJa6vg28KqUGhhZyX0PchgSQf7Oc6AikJg@mail.gmail.com>
References: <CAAMkPW_6Uuu8MaAK5KzANX9_o06TCcsWaTPqpCrt82DA5D6h+g@mail.gmail.com>
	<CAAgsrZiCCR-3=JjnGJa6vg28KqUGhhZyX0PchgSQf7Oc6AikJg@mail.gmail.com>
Message-ID: <CAAMkPW8qLMY0RkSV6Yhb5nW8EYSPWehi71gev+QYviATgYQB6A@mail.gmail.com>

On 20 July 2015 at 11:32, pierluigi de rosa <pierluigi.derosa at gmail.com>
wrote:

> I simply have a STFDF like I attached at the end of the mail.
>
> > summary(pioggieST1)
> Object of class STFDF
>  with Dimensions (s, t, attr): (30, 8401, 1)
> [[Spatial:]]
> Object of class SpatialPointsDataFrame
> Coordinates:
>               min     max
> coords.x1 2272679 2320496
> coords.x2 4698989 4821088
> Is projected: TRUE
> proj4string :
> [+proj=tmerc +lat_0=0 +lon_0=15 +k=0.9996 +x_0=2520000 +y_0=0 +ellps=intl
> +units=m +no_defs]
> Number of points: 30
> Data attributes:
>                 nome
>  Allerona         : 1
>  Amelia           : 1
>  Attigliano       : 1
>  Avigliano_Umbro  : 1
>  Bastardo         : 1
>  Calvi_dell_Umbria: 1
>  (Other)          :24
> [[Temporal:]]
>      Index              timeIndex
>  Min.   :1991-01-01   Min.   :   1
>  1st Qu.:1996-10-01   1st Qu.:2101
>  Median :2002-07-02   Median :4201
>  Mean   :2002-07-02   Mean   :4201
>  3rd Qu.:2008-04-01   3rd Qu.:6301
>  Max.   :2013-12-31   Max.   :8401
> [[Data attributes:]]
>      values
>  Min.   :  0.000
>  1st Qu.:  0.000
>  Median :  0.000
>  Mean   :  1.489
>  3rd Qu.:  0.000
>  Max.   :273.000
>
> In the space slot I have 30 points.
> For each point I have a xts element:
> For the first point the xts element is:
> > summary(pioggieST1[1,])
>      Index                values          timeIndex
>  Min.   :1991-01-01   Min.   :  0.000   Min.   :   1
>  1st Qu.:1996-10-01   1st Qu.:  0.000   1st Qu.:2101
>  Median :2002-07-02   Median :  0.000   Median :4201
>  Mean   :2002-07-02   Mean   :  2.105   Mean   :4201
>  3rd Qu.:2008-04-01   3rd Qu.:  0.200   3rd Qu.:6301
>  Max.   :2013-12-31   Max.   :176.800   Max.   :8401
>
> or
>
> > head(pioggieST1[1,])
>            values timeIndex
> 1991-01-01      0         1
> 1991-01-02      0         2
> 1991-01-03      0         3
> 1991-01-04      0         4
> 1991-01-05      0         5
> 1991-01-06      0         6
>
> For each day I have to calculate the sum of "values" relative to the day +
> the "values" of the day -1 and the day -2
>
> How can I do that simply?
>
> Thanks
> Pierluigi
>
>
?
Dear Dr. De Rosa,

Please excuse me, what I meant was whether you may attach a fraction of the
array pioggieST1, even a modified one, so we could work on it.

Best regards,

Jue
?


> 2015-07-20 10:43 GMT+02:00 Jue Lin-Ye <jl.iccp at gmail.com>:
>
>> Dear Dr. De Rosa,
>>
>> May you attach some data to your e-mail so we could reproduce your case?
>>
>> Best regards,
>>
>> --
>> Jue
>>
>
>
>
> --
> Ing. Pierluigi De Rosa (PhD)
> cel: 3497558268 / fax: 075 7823038
> skype: pierluigi.derosa
>

	[[alternative HTML version deleted]]


From edzer.pebesma at uni-muenster.de  Mon Jul 20 13:45:16 2015
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 20 Jul 2015 13:45:16 +0200
Subject: [R-sig-Geo] Cumulate space time data over days
In-Reply-To: <CAAgsrZhT_D=63Y7cOPd1kYdj_9NE1usHWJR6tGS=yqgSyZE5uA@mail.gmail.com>
References: <CAAgsrZhT_D=63Y7cOPd1kYdj_9NE1usHWJR6tGS=yqgSyZE5uA@mail.gmail.com>
Message-ID: <55ACDF4C.8050805@uni-muenster.de>



On 07/17/2015 06:48 PM, pierluigi de rosa wrote:
> Dear all,
> 
> I'm have a simple question that I think should be easly to answer but I'm
> an R beginner anf I didn't find nothing exactly what I need.
> 
> I have a STFDF that register rainfall data over 14 years in 30 monitoring
> stations.
> I need to evaluate for each day the cumulative rainfall of the 3 days
> before (or 72 hours) and than extract data where this cumulative value is
> above a threshold.
> 
> How ca I reach that?

Since this is a pure time series problem, I'd try something along these
lines:

library(xts)
z = as(pioggieST1, "xts")
m = rollmean(z, 3, align = "right")
sel = m[apply(m > 300, 1, all),] # threshold 300

you may want to remove "any" with "all" if all stations should be above
the threshold of 300.

> Thanks
> 
> Summary of my data is below
> Thanks
> Pierluigi
> 
>> summary(pioggieST1)
> Object of class STFDF
>  with Dimensions (s, t, attr): (30, 8401, 1)
> [[Spatial:]]
> Object of class SpatialPointsDataFrame
> Coordinates:
>               min     max
> coords.x1 2272679 2320496
> coords.x2 4698989 4821088
> Is projected: TRUE
> proj4string :
> [+proj=tmerc +lat_0=0 +lon_0=15 +k=0.9996 +x_0=2520000 +y_0=0 +ellps=intl
> +units=m +no_defs]
> Number of points: 30
> Data attributes:
>                 nome
>  Allerona         : 1
>  Amelia           : 1
>  Attigliano       : 1
>  Avigliano_Umbro  : 1
>  Bastardo         : 1
>  Calvi_dell_Umbria: 1
>  (Other)          :24
> [[Temporal:]]
>      Index              timeIndex
>  Min.   :1991-01-01   Min.   :   1
>  1st Qu.:1996-10-01   1st Qu.:2101
>  Median :2002-07-02   Median :4201
>  Mean   :2002-07-02   Mean   :4201
>  3rd Qu.:2008-04-01   3rd Qu.:6301
>  Max.   :2013-12-31   Max.   :8401
> [[Data attributes:]]
>      values
>  Min.   :  0.000
>  1st Qu.:  0.000
>  Median :  0.000
>  Mean   :  1.489
>  3rd Qu.:  0.000
>  Max.   :273.000
> 
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi),  University of M?nster,
Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
Journal of Statistical Software:   http://www.jstatsoft.org/
Computers & Geosciences:   http://elsevier.com/locate/cageo/
Spatial Statistics Society http://www.spatialstatistics.info

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150720/30179479/attachment.bin>

From jazzpriestess2000 at yahoo.com  Mon Jul 20 18:31:22 2015
From: jazzpriestess2000 at yahoo.com (joke atuge)
Date: Mon, 20 Jul 2015 16:31:22 +0000 (UTC)
Subject: [R-sig-Geo] error stacking rasters from list in R on  Linux
Message-ID: <136362193.967570.1437409882526.JavaMail.yahoo@mail.yahoo.com>

 Hello I am having issues stacking my rasters from list before I create raster time series. When I do this directly in the R environment using sample data, it works out fine. However, once I send it in as a script to run on the HPC I get the following error:Error in x[[1]] : subscript out of bounds
Calls: stack -> stack -> .local
Execution halted
THe codes prior to this error are:?FunR<-function(r){
ext<-raster(extent(r),nrow=1100,ncol=1100)
crs(ext)<-crs(r)
D<-rasterize(r,ext,field="LFRP")
EC<-extent(-20, 60,0,30)
?D2<-extend(D,EC)
D3<-crop(D2,extent(-18,20,2,30))
s <- raster(nrow=600, ncol=1000,extent(-18,20,2,30))
crs(s)<-crs(WA)
Ds <- resample(D3, s, method='bilinear')
?crs(Ds)<-crs(WA)
Ds}
?###Create rasters and crop
DL4<-sapply(DL3,FunR)
DL5<-stack(DL4) .... (error occurs after this line)
How do I get ride of this, please? In addition, how do I get rid of files on my list that are totally NA. I suspect this may be an issue too.Regards,Ajoke
	[[alternative HTML version deleted]]


From edzer.pebesma at uni-muenster.de  Tue Jul 21 16:31:36 2015
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 21 Jul 2015 16:31:36 +0200
Subject: [R-sig-Geo] Esri announced a new initiative to build a
 collaborative community for R and ArcGIS users.
Message-ID: <55AE57C8.6020903@uni-muenster.de>

http://blogs.esri.com/esri/esri-insider/2015/07/20/building-a-bridge-to-the-r-community/#sthash.L6pRPmqc.hpvt
-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi),  University of M?nster,
Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
Journal of Statistical Software:   http://www.jstatsoft.org/
Computers & Geosciences:   http://elsevier.com/locate/cageo/
Spatial Statistics Society http://www.spatialstatistics.info


From virgilio.gomez at uclm.es  Tue Jul 21 16:37:57 2015
From: virgilio.gomez at uclm.es (Virgilio =?ISO-8859-1?Q?G=F3mez-Rubio?=)
Date: Tue, 21 Jul 2015 16:37:57 +0200
Subject: [R-sig-Geo] Esri announced a new initiative to build a
 collaborative community for R and ArcGIS users.
In-Reply-To: <55AE57C8.6020903@uni-muenster.de>
References: <55AE57C8.6020903@uni-muenster.de>
Message-ID: <1437489477.2249.17.camel@uclm.es>

Interesting. Any chance that they join the R Consortium?



El mar, 21-07-2015 a las 16:31 +0200, Edzer Pebesma escribi?:
> http://blogs.esri.com/esri/esri-insider/2015/07/20/building-a-bridge-to-the-r-community/#sthash.L6pRPmqc.hpvt


From sarah.goslee at gmail.com  Tue Jul 21 21:17:49 2015
From: sarah.goslee at gmail.com (Sarah Goslee)
Date: Tue, 21 Jul 2015 15:17:49 -0400
Subject: [R-sig-Geo] readGDAL and unz
Message-ID: <CAM_vjukH9biw1eYSPdvE0eNNHMe24dtKkrtYmX4MXx06Nv7vUA@mail.gmail.com>

Hi folks,

I'm stuck trying to read spatial data from a zip archive using unz()
rather than unzipping it. The latter option works, but the zip
archives I'm working with have hundreds of files in them, and I'd
rather avoid the mess of unzipping the whole thing.

Using readGDAL(unz()) throws an error:
rror in .local(.Object, ...) : `3' does not exist in the file system,
and is not recognised as a supported dataset name.

It appears that the name of the connection isn't being passed
correctly. Do any of you know a way around this, or shall I just
resign myself to unzipping everything?

Here's both a working (csv) and nonworking (tif) example:

###

library(rgdal)

# create files to test with
# NOTE: WRITES TO CURRENT DIRECTORY
# creates x.tif and zip archive x.zip using rgdal built-in data
x <- readGDAL(system.file("external/simple.ag", package="sp")[1])
writeGDAL(x, "x.tif")
zip("x.zip", "x.tif")

# creates y.csv and zip archive y.zip
y <- data.frame(A=1:3, B=letters[6:8])
write.csv(y, "y.csv")
zip("y.zip", "y.csv")

## works as expected
# list files in y.zip
y.files <- unzip("y.zip", list=TRUE)
# read in first file
y.in <- read.csv(unz("y.zip", y.files$Name[1]))

## does not work: fails with error
## Error in .local(.Object, ...) : `3' does not exist in the file system,
## and is not recognised as a supported dataset name.
## Note: the number increments.
# list files in x.zip
x.files <- unzip("x.zip", list=TRUE)
# read in first file
x.in <- readGDAL(unz("x.zip", x.files$Name[1]))


## There's no difference in the connection provided by unz():
# > unz("y.zip", y.files$Name[1])
#   description         class          mode          text        opened
# "y.zip:y.csv"         "unz"           "r"        "text"      "closed"
#      can read     can write
#         "yes"         "yes"
# > unz("x.zip", x.files$Name[1])
#   description         class          mode          text        opened
# "x.zip:x.tif"         "unz"           "r"        "text"      "closed"
#      can read     can write
#         "yes"         "yes"

## unzipping the file first works as expected
unzip("x.zip")
x.in2 <- readGDAL(x.files$Name[1])

Thanks,
Sarah
-- 
Sarah Goslee
http://www.functionaldiversity.org


From bob at rudis.net  Tue Jul 21 23:40:04 2015
From: bob at rudis.net (boB Rudis)
Date: Tue, 21 Jul 2015 17:40:04 -0400
Subject: [R-sig-Geo] readGDAL and unz
In-Reply-To: <CAM_vjukH9biw1eYSPdvE0eNNHMe24dtKkrtYmX4MXx06Nv7vUA@mail.gmail.com>
References: <CAM_vjukH9biw1eYSPdvE0eNNHMe24dtKkrtYmX4MXx06Nv7vUA@mail.gmail.com>
Message-ID: <CAJ4QxaMuoYJC9O2qRr5kyqq1hWNOa3RUh3OaVAXP4xrCDAqP8A@mail.gmail.com>

You can just do:

   unzip("x.zip", "x.tif")

and it will only extract that single file out to the current working
directory. readGDAL expects a filename vs a connection.

On Tue, Jul 21, 2015 at 3:17 PM, Sarah Goslee <sarah.goslee at gmail.com> wrote:
> Hi folks,
>
> I'm stuck trying to read spatial data from a zip archive using unz()
> rather than unzipping it. The latter option works, but the zip
> archives I'm working with have hundreds of files in them, and I'd
> rather avoid the mess of unzipping the whole thing.
>
> Using readGDAL(unz()) throws an error:
> rror in .local(.Object, ...) : `3' does not exist in the file system,
> and is not recognised as a supported dataset name.
>
> It appears that the name of the connection isn't being passed
> correctly. Do any of you know a way around this, or shall I just
> resign myself to unzipping everything?
>
> Here's both a working (csv) and nonworking (tif) example:
>
> ###
>
> library(rgdal)
>
> # create files to test with
> # NOTE: WRITES TO CURRENT DIRECTORY
> # creates x.tif and zip archive x.zip using rgdal built-in data
> x <- readGDAL(system.file("external/simple.ag", package="sp")[1])
> writeGDAL(x, "x.tif")
> zip("x.zip", "x.tif")
>
> # creates y.csv and zip archive y.zip
> y <- data.frame(A=1:3, B=letters[6:8])
> write.csv(y, "y.csv")
> zip("y.zip", "y.csv")
>
> ## works as expected
> # list files in y.zip
> y.files <- unzip("y.zip", list=TRUE)
> # read in first file
> y.in <- read.csv(unz("y.zip", y.files$Name[1]))
>
> ## does not work: fails with error
> ## Error in .local(.Object, ...) : `3' does not exist in the file system,
> ## and is not recognised as a supported dataset name.
> ## Note: the number increments.
> # list files in x.zip
> x.files <- unzip("x.zip", list=TRUE)
> # read in first file
> x.in <- readGDAL(unz("x.zip", x.files$Name[1]))
>
>
> ## There's no difference in the connection provided by unz():
> # > unz("y.zip", y.files$Name[1])
> #   description         class          mode          text        opened
> # "y.zip:y.csv"         "unz"           "r"        "text"      "closed"
> #      can read     can write
> #         "yes"         "yes"
> # > unz("x.zip", x.files$Name[1])
> #   description         class          mode          text        opened
> # "x.zip:x.tif"         "unz"           "r"        "text"      "closed"
> #      can read     can write
> #         "yes"         "yes"
>
> ## unzipping the file first works as expected
> unzip("x.zip")
> x.in2 <- readGDAL(x.files$Name[1])
>
> Thanks,
> Sarah
> --
> Sarah Goslee
> http://www.functionaldiversity.org
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From mdsumner at gmail.com  Wed Jul 22 00:03:20 2015
From: mdsumner at gmail.com (Michael Sumner)
Date: Tue, 21 Jul 2015 22:03:20 +0000
Subject: [R-sig-Geo] readGDAL and unz
In-Reply-To: <CAM_vjukH9biw1eYSPdvE0eNNHMe24dtKkrtYmX4MXx06Nv7vUA@mail.gmail.com>
References: <CAM_vjukH9biw1eYSPdvE0eNNHMe24dtKkrtYmX4MXx06Nv7vUA@mail.gmail.com>
Message-ID: <CAAcGz99X+L7DGrPBv63gxPntzT-wtwKY+CtHwDjFOQT29aMCVg@mail.gmail.com>

On Wed, 22 Jul 2015 at 05:18 Sarah Goslee <sarah.goslee at gmail.com> wrote:

> Hi folks,
>
> I'm stuck trying to read spatial data from a zip archive using unz()
> rather than unzipping it. The latter option works, but the zip
> archives I'm working with have hundreds of files in them, and I'd
> rather avoid the mess of unzipping the whole thing.
>
>
You might be able to get it working with the "readinzip" wrapper of GDAL.

https://trac.osgeo.org/gdal/wiki/UserDocs/ReadInZip


I get this "info" summary on Ubuntu -


R version 3.2.1 (2015-06-18) -- "World-Famous Astronaut"
Copyright (C) 2015 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)
...
> library(rgdal)
Loading required package: sp
rgdal: version: 1.0-4, (SVN revision (unknown))
 Geospatial Data Abstraction Library extensions to R successfully loaded
 Loaded GDAL runtime: GDAL 2.1.0dev, released 2015/99/99
 Path to GDAL shared files: /usr/local/share/gdal
 Loaded PROJ.4 runtime: Rel. 4.9.1, 04 March 2015, [PJ_VERSION: 491]
 Path to PROJ.4 shared files: (autodetected)
 Linking to sp version: 1.1-1
>  x <- readGDAL("/vsizip/x.zip/x.tif")
/vsizip/x.zip/x.tif has GDAL driver GTiff
and has 4 rows and 3 columns

(I get the same with rgdal 0.9-3 / GDAL 1.11.2,)

It might be that readGDAL itself is modifying the path string here

(I'm  not familliar with the syntax in detail, and I am further confused as
to how to use it in Windows. )

GDAL's "connections" have their own zoo of syntax specializations, so
there's quite a lot of variety to explore here -  this probably can't work
with a zipped NetCDF or HDF (but then more recent versions of those formats
have either internal compression, or .gz compression that works over a URL
handled by the driver).

Cheers, Mike.


Using readGDAL(unz()) throws an error:
> rror in .local(.Object, ...) : `3' does not exist in the file system,
> and is not recognised as a supported dataset name.
>
> It appears that the name of the connection isn't being passed
> correctly. Do any of you know a way around this, or shall I just
> resign myself to unzipping everything?
>
> Here's both a working (csv) and nonworking (tif) example:
>
> ###
>
> library(rgdal)
>
> # create files to test with
> # NOTE: WRITES TO CURRENT DIRECTORY
> # creates x.tif and zip archive x.zip using rgdal built-in data
> x <- readGDAL(system.file("external/simple.ag", package="sp")[1])
> writeGDAL(x, "x.tif")
> zip("x.zip", "x.tif")
>
> # creates y.csv and zip archive y.zip
> y <- data.frame(A=1:3, B=letters[6:8])
> write.csv(y, "y.csv")
> zip("y.zip", "y.csv")
>
> ## works as expected
> # list files in y.zip
> y.files <- unzip("y.zip", list=TRUE)
> # read in first file
> y.in <- read.csv(unz("y.zip", y.files$Name[1]))
>
> ## does not work: fails with error
> ## Error in .local(.Object, ...) : `3' does not exist in the file system,
> ## and is not recognised as a supported dataset name.
> ## Note: the number increments.
> # list files in x.zip
> x.files <- unzip("x.zip", list=TRUE)
> # read in first file
> x.in <- readGDAL(unz("x.zip", x.files$Name[1]))
>
>
> ## There's no difference in the connection provided by unz():
> # > unz("y.zip", y.files$Name[1])
> #   description         class          mode          text        opened
> # "y.zip:y.csv"         "unz"           "r"        "text"      "closed"
> #      can read     can write
> #         "yes"         "yes"
> # > unz("x.zip", x.files$Name[1])
> #   description         class          mode          text        opened
> # "x.zip:x.tif"         "unz"           "r"        "text"      "closed"
> #      can read     can write
> #         "yes"         "yes"
>
> ## unzipping the file first works as expected
> unzip("x.zip")
> x.in2 <- readGDAL(x.files$Name[1])
>
> Thanks,
> Sarah
> --
> Sarah Goslee
> http://www.functionaldiversity.org
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From janka.vanschoenwinkel at uhasselt.be  Wed Jul 22 11:36:45 2015
From: janka.vanschoenwinkel at uhasselt.be (Janka Vanschoenwinkel)
Date: Wed, 22 Jul 2015 11:36:45 +0200
Subject: [R-sig-Geo] Overlapping a grid shapefile with a NUTS3 shapefile to
 determine one average value for each NUTS3 region
Message-ID: <CAHymut+Lhe-2h6VQvBEiJvW2nO2hGC7ZPgfRQRmHgxNMR1KCKw@mail.gmail.com>

Dear listmembers!


I would like to add the average value of, let?s say soil moisture, to each
NUTS3 region. However, soil moisture values are stored in little grids.
Therefore, I need to find a way to calculate which grids overlap with a
certain NUTS3 region in order to determine the average soil moisture value
for that NUTS3 region. Visually, it can be compared to this picture where
little grids approximate together the shape of US states:
http://fieldguide.mt.gov/RangeMaps%5CESMapQUAD_9217.jpg


It is possible that one NUTS3 region consists of 2 full grids and 3 half
grids, while another NUTS3 region consists of only a 0.75 grid. It is also
possible that some grids are empty because I don?t have values there.


I assume that this requires 3 steps (but I am actually not sure):


   - Step 1 would be to add the values of the text file to the grid
   shapefile
   - Step 2 would be to overlap the grid shapefile with the empty nuts3
   shapefile
   - Step 3 would be to write a new nuts3 shapefile which contains the
   overlapped values

My data and shapefiles can be found through the following link:

https://drive.google.com/folderview?id=0By9u5m3kxn9yfjZtdFZLcW82SWpzT1VwZXE1a3FtRGtSdEl1c1NvY205TGpack9xSFc2T2s&usp=sharing


   - mydata = read.csv("MyData.csv", header = TRUE) #contains coordinates
   in latitude and longitude form that represent the centroids of each
   ?grid?.  #mydata also contains 1 variable (random numbers in this case)
   that I want to match to the nuts3 regions in the ?nuts? shapefile
   - library(rgdal)
   - grid <- readOGR(".", layer = "grid_025dd") #each grid contains de
   centroid coordinates that should be linked to mydata in order to fill all
   the grids with the variable of mydata
   - nuts <- readOGR(".", layer = "NUTS_RG_60M_2006")

Currently, I am nowhere. Maybe I don?t use the right keywords to google,
but mostly, I am not used to working with coordinates. In the previous maps
that I made, I was always capable of using some sort of objectid common to
the data and the shapefile. Now, this is not the case. There should be an
easy way to tell R to use the coordinates of mydata and combine them with
the coordinates of the grids, but I can?t figure it out.


Another issue that I face is that the values of the grids in ?mydata?
should fill up an entire grid. Yet, R recognizes the values as point values.



Could someone please help me and point me in the correct direction for step
1 and 2? I think I should be able to do step 3 on my own.

Thanks a lot for your help! I appreciate it a lot!



Dear kindness,


Janka

	[[alternative HTML version deleted]]


From holtermann at hwwi.org  Wed Jul 22 11:45:54 2015
From: holtermann at hwwi.org (Linus Holtermann)
Date: Wed, 22 Jul 2015 09:45:54 +0000
Subject: [R-sig-Geo] Overlapping a grid shapefile with a NUTS3 shapefile
 to determine one average value for each NUTS3 region
In-Reply-To: <CAHymut+Lhe-2h6VQvBEiJvW2nO2hGC7ZPgfRQRmHgxNMR1KCKw@mail.gmail.com>
References: <CAHymut+Lhe-2h6VQvBEiJvW2nO2hGC7ZPgfRQRmHgxNMR1KCKw@mail.gmail.com>
Message-ID: <11b75d20daf2457faea7afc54f663962@winhexbeeu15.win.mail>

Hello,

take a look at the "overlay" command in the raster-package. Weight=TRUE may be a step in the right direction for your problem.

Bests,



Linus Holtermann
Hamburgisches WeltWirtschaftsInstitut gemeinn?tzige GmbH (HWWI)
Heimhuder Stra?e 71
20148 Hamburg
Tel +49-(0)40-340576-336
Fax+49-(0)40-340576-776
Internet: www.hwwi.org
Email: holtermann at hwwi.org
?
Amtsgericht Hamburg HRB 94303
Gesch?ftsf?hrer: PD Dr. Christian Growitsch | Prof. Dr. Henning V?pel
Prokura: Dipl. Kauffrau Alexis Malchin
Umsatzsteuer-ID: DE 241849425


-----Urspr?ngliche Nachricht-----
Von: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] Im Auftrag von Janka Vanschoenwinkel
Gesendet: Mittwoch, 22. Juli 2015 11:37
An: r-sig-geo at r-project.org
Betreff: [R-sig-Geo] Overlapping a grid shapefile with a NUTS3 shapefile to determine one average value for each NUTS3 region

Dear listmembers!


I would like to add the average value of, let?s say soil moisture, to each
NUTS3 region. However, soil moisture values are stored in little grids.
Therefore, I need to find a way to calculate which grids overlap with a certain NUTS3 region in order to determine the average soil moisture value for that NUTS3 region. Visually, it can be compared to this picture where little grids approximate together the shape of US states:
http://fieldguide.mt.gov/RangeMaps%5CESMapQUAD_9217.jpg


It is possible that one NUTS3 region consists of 2 full grids and 3 half grids, while another NUTS3 region consists of only a 0.75 grid. It is also possible that some grids are empty because I don?t have values there.


I assume that this requires 3 steps (but I am actually not sure):


   - Step 1 would be to add the values of the text file to the grid
   shapefile
   - Step 2 would be to overlap the grid shapefile with the empty nuts3
   shapefile
   - Step 3 would be to write a new nuts3 shapefile which contains the
   overlapped values

My data and shapefiles can be found through the following link:

https://drive.google.com/folderview?id=0By9u5m3kxn9yfjZtdFZLcW82SWpzT1VwZXE1a3FtRGtSdEl1c1NvY205TGpack9xSFc2T2s&usp=sharing


   - mydata = read.csv("MyData.csv", header = TRUE) #contains coordinates
   in latitude and longitude form that represent the centroids of each
   ?grid?.  #mydata also contains 1 variable (random numbers in this case)
   that I want to match to the nuts3 regions in the ?nuts? shapefile
   - library(rgdal)
   - grid <- readOGR(".", layer = "grid_025dd") #each grid contains de
   centroid coordinates that should be linked to mydata in order to fill all
   the grids with the variable of mydata
   - nuts <- readOGR(".", layer = "NUTS_RG_60M_2006")

Currently, I am nowhere. Maybe I don?t use the right keywords to google, but mostly, I am not used to working with coordinates. In the previous maps that I made, I was always capable of using some sort of objectid common to the data and the shapefile. Now, this is not the case. There should be an easy way to tell R to use the coordinates of mydata and combine them with the coordinates of the grids, but I can?t figure it out.


Another issue that I face is that the values of the grids in ?mydata?
should fill up an entire grid. Yet, R recognizes the values as point values.



Could someone please help me and point me in the correct direction for step
1 and 2? I think I should be able to do step 3 on my own.

Thanks a lot for your help! I appreciate it a lot!



Dear kindness,


Janka

	[[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

From holtermann at hwwi.org  Wed Jul 22 11:48:54 2015
From: holtermann at hwwi.org (Linus Holtermann)
Date: Wed, 22 Jul 2015 09:48:54 +0000
Subject: [R-sig-Geo] Overlapping a grid shapefile with a NUTS3 shapefile
 to determine one average value for each NUTS3 region
In-Reply-To: <11b75d20daf2457faea7afc54f663962@winhexbeeu15.win.mail>
References: <CAHymut+Lhe-2h6VQvBEiJvW2nO2hGC7ZPgfRQRmHgxNMR1KCKw@mail.gmail.com>
	<11b75d20daf2457faea7afc54f663962@winhexbeeu15.win.mail>
Message-ID: <b18dad52c43843f1854a014c0c8b89f1@winhexbeeu15.win.mail>

Sorry,

the right command is "exctract", of course.

Mit freundlichen Gr??en


Linus Holtermann
Hamburgisches WeltWirtschaftsInstitut gemeinn?tzige GmbH (HWWI)
Heimhuder Stra?e 71
20148 Hamburg
Tel +49-(0)40-340576-336
Fax+49-(0)40-340576-776
Internet: www.hwwi.org
Email: holtermann at hwwi.org
?
Amtsgericht Hamburg HRB 94303
Gesch?ftsf?hrer: PD Dr. Christian Growitsch | Prof. Dr. Henning V?pel
Prokura: Dipl. Kauffrau Alexis Malchin
Umsatzsteuer-ID: DE 241849425


-----Urspr?ngliche Nachricht-----
Von: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] Im Auftrag von Linus Holtermann
Gesendet: Mittwoch, 22. Juli 2015 11:46
An: Janka Vanschoenwinkel; r-sig-geo at r-project.org
Betreff: Re: [R-sig-Geo] Overlapping a grid shapefile with a NUTS3 shapefile to determine one average value for each NUTS3 region

Hello,

take a look at the "overlay" command in the raster-package. Weight=TRUE may be a step in the right direction for your problem.

Bests,



Linus Holtermann
Hamburgisches WeltWirtschaftsInstitut gemeinn?tzige GmbH (HWWI) Heimhuder Stra?e 71
20148 Hamburg
Tel +49-(0)40-340576-336
Fax+49-(0)40-340576-776
Internet: www.hwwi.org
Email: holtermann at hwwi.org
?
Amtsgericht Hamburg HRB 94303
Gesch?ftsf?hrer: PD Dr. Christian Growitsch | Prof. Dr. Henning V?pel
Prokura: Dipl. Kauffrau Alexis Malchin
Umsatzsteuer-ID: DE 241849425


-----Urspr?ngliche Nachricht-----
Von: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] Im Auftrag von Janka Vanschoenwinkel
Gesendet: Mittwoch, 22. Juli 2015 11:37
An: r-sig-geo at r-project.org
Betreff: [R-sig-Geo] Overlapping a grid shapefile with a NUTS3 shapefile to determine one average value for each NUTS3 region

Dear listmembers!


I would like to add the average value of, let?s say soil moisture, to each
NUTS3 region. However, soil moisture values are stored in little grids.
Therefore, I need to find a way to calculate which grids overlap with a certain NUTS3 region in order to determine the average soil moisture value for that NUTS3 region. Visually, it can be compared to this picture where little grids approximate together the shape of US states:
http://fieldguide.mt.gov/RangeMaps%5CESMapQUAD_9217.jpg


It is possible that one NUTS3 region consists of 2 full grids and 3 half grids, while another NUTS3 region consists of only a 0.75 grid. It is also possible that some grids are empty because I don?t have values there.


I assume that this requires 3 steps (but I am actually not sure):


   - Step 1 would be to add the values of the text file to the grid
   shapefile
   - Step 2 would be to overlap the grid shapefile with the empty nuts3
   shapefile
   - Step 3 would be to write a new nuts3 shapefile which contains the
   overlapped values

My data and shapefiles can be found through the following link:

https://drive.google.com/folderview?id=0By9u5m3kxn9yfjZtdFZLcW82SWpzT1VwZXE1a3FtRGtSdEl1c1NvY205TGpack9xSFc2T2s&usp=sharing


   - mydata = read.csv("MyData.csv", header = TRUE) #contains coordinates
   in latitude and longitude form that represent the centroids of each
   ?grid?.  #mydata also contains 1 variable (random numbers in this case)
   that I want to match to the nuts3 regions in the ?nuts? shapefile
   - library(rgdal)
   - grid <- readOGR(".", layer = "grid_025dd") #each grid contains de
   centroid coordinates that should be linked to mydata in order to fill all
   the grids with the variable of mydata
   - nuts <- readOGR(".", layer = "NUTS_RG_60M_2006")

Currently, I am nowhere. Maybe I don?t use the right keywords to google, but mostly, I am not used to working with coordinates. In the previous maps that I made, I was always capable of using some sort of objectid common to the data and the shapefile. Now, this is not the case. There should be an easy way to tell R to use the coordinates of mydata and combine them with the coordinates of the grids, but I can?t figure it out.


Another issue that I face is that the values of the grids in ?mydata?
should fill up an entire grid. Yet, R recognizes the values as point values.



Could someone please help me and point me in the correct direction for step
1 and 2? I think I should be able to do step 3 on my own.

Thanks a lot for your help! I appreciate it a lot!



Dear kindness,


Janka

	[[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo
_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

From tmeeha at gmail.com  Wed Jul 22 21:10:21 2015
From: tmeeha at gmail.com (Tim Meehan)
Date: Wed, 22 Jul 2015 13:10:21 -0600
Subject: [R-sig-Geo] Modeling areal data with lots of holes, islands
Message-ID: <CAMTWOzqnEnME4d53GL=onr6XT3wFEVPhstrnA1+NaVwGGmva4w@mail.gmail.com>

Hi All,

I am using R to model data with repeated measures and strong spatial
autocorrelation in OLS residuals.  Response and independent variables are
summarized at the county level (2300 counties across contiguous US, each
measured once during each of four years).

There are lots of challenges with this data. First, the response is a
proportion, so I am looking at modeling methods that can accommodate a
beta-distribution (otherwise I'll logit-transform the response, or ignore
the issue since residual distributions don't look too bad).  Second, the 4
repeated measures per county sort of calls for either the ability to have
random intercepts or the ability to incorporate a temporal correlation
structure.  Third, the strong spatial patterning of residuals should
probably be dealt with some how.  The modeling tools I am considering
include mgcv::gam, mgcv::gamm, gamm4::gamm4, INLA::inla, spTimer::spTGibbs,
etc.

In order to choose the right tool, I need to decide on a way to specify the
spatial relationships.  This is areal data, so it seems most common and
correct to describe spatial relationships with graphs and employ
neighborhood-oriented modeling approaches (e.g., CAR models).  But this
data set is unusual in that I don't have data for all counties in the
contiguous US (roughly 2300 out of 3100).  There are a lot of holes and
islands in the map.  Conceptually, assigning neighbors seems odd when there
are big gaps between counties, especially when I suspect that the spatial
pattern in the data is due to continuous spatial processes.

I would prefer to model these data using a geostatistical approach, using
county centroids.  I know this is not ideal.  I have tried both approaches
and they both yield similar fixed effect estimates for independent
variables of interest. But the geostatistical approach produce better
fitting models, eliminating nearly all residual autocorrelation.

So, finally, the question.  Is it reasonable to model these areal data
using a geostatistical approach given (1) there are lots of holes and
islands in the areal data, (2) I suspect the spatial patterning to be due
to continuous spatial processes, not adjacency of administrative
boundaries, (3) there are roughly 2300 counties in the analysis, where
variation in county size and shape is small compared to the continental
analysis extent, (4) a geostatistical model does a better job of removing
residual autocorrelation, and (5) I better understand the geostatistical
ways of specifying spatial relationships?  What are the practical
consequences of using geostatistical methods for areal data?  Are they
greater than the consequences of using odd neighborhood specifications?

Thanks for any advice you can offer.

Best,

Tim

P.S. Sorry if this is the wrong venue for this question.  Please let me
know if there is a better place to send it.

	[[alternative HTML version deleted]]


From public at careaga.net  Thu Jul 23 08:07:42 2015
From: public at careaga.net (Richard Careaga)
Date: Wed, 22 Jul 2015 23:07:42 -0700
Subject: [R-sig-Geo] Proper use of maptools::elide to both scale AND shift a
	polygon object
Message-ID: <55B084AE.6060707@careaga.net>


My goal is to produce a choropleth map in which farflung units, like 
Hawaii, are brought into the bounding box for the continental US or 
brought in and downscaled, like Alaska. I would also like to "outset" 
the three smallest units within the US, the states of Rhode Island and 
Delaware and the District of Columbia. I'm finding that I cannot BOTH 
move and enlarge the same object.

Beginning with a shapefile, us, the following works

us_aea = spTransform(us, CRS("+proj=laea +lat_0=45 +lon_0=-100 +x_0=0 
+y_0=0 +a=6370997 +b=6370997 +units=m +no_defs"))
us_aea at data$id = rownames(us_aea at data)

alaska = us_aea[us_aea$STATEFP=="02",]
alaska = elide(alaska, rotate=-50)
alaska = elide(alaska, scale=max(apply(bbox(alaska), 1, diff)) / 2.3)
#alaska = elide(alaska, scale=max(apply(bbox(alaska), 1, diff)) / 5) # 
makes smaller
#alaska = elide(alaska, scale=max(apply(bbox(alaska), 1, diff)) / 1) # 
makes larger
alaska = elide(alaska, shift=c(-2100000, -2500000))
proj4string(alaska) = proj4string(us_aea)

hawaii = us_aea[us_aea$STATEFP=="15",]
hawaii = elide(hawaii, rotate=-35)
hawaii = elide(hawaii, shift=c(5400000, -1400000))
proj4string(hawaii) = proj4string(us_aea)

us_aea = us_aea[!us_aea$STATEFP %in% c("02", "15"),]
us_aea = rbind(us_aea, alaska, hawaii)


to properly place AK & HI

and

rhode_island = us_aea[us_aea$STATEFP=="44",]
rhode_island = elide(rhode_island, shift=c(0,-200000))
proj4string(rhode_island) = proj4string(us_aea)


delaware = us_aea[us_aea$STATEFP=="10",]
delaware = elide(delaware, shift=c(200000,0))
proj4string(delaware) = proj4string(us_aea)

dc = us_aea[us_aea$STATEFP=="11",]
#dc = elide(dc, scale=max(apply(bbox(dc), 1, diff)) / .999) # can't make 
smaller than 1.0
#dc = elide(dc, scale = 2000) # makes it invisible
dc = elide(dc, shift=c(250000,-125000))
proj4string(dc) = proj4string(us_aea)

us_aea = us_aea[!us_aea$STATEFP %in% c("44", "10", "11"),]
us_aea = rbind(us_aea, delaware, rhode_island, dc)

us50 <- fortify(us_aea, region="STUSPS")
us50 = remove.territories(us50)

p = ggplot(data=us50) +
     geom_map(map=us50, aes(x=long, y=lat, map_id=id, group=group), 
,fill="white", color="dark grey", size=0.15) +
     no_ylab +
     no_xlab +
     plain_theme
p

will plot everything, but when I uncomment either of the lines in the dc 
block the SpatialPolygonsDataFrame representing the District of Columbia 
vanishes from sight.

I can probably find a workaround by plotting DC in a separate layer 
because I don't worry about its CRS since it is small, very simply 
shaped, won't move far and the distortion is tolerable for this kind of 
thematic map. I'd prefer, however, to have everything in a single object.

Is it simply that the shift argument "values to shift the coordinates of 
the input object; this is made ineffective by the scale argument" means 
what I'm trying to do is impossible? (Seems to work for the case of AK, 
though.) Or is it not that subtle?

Thanks,

Richard Careaga



	[[alternative HTML version deleted]]


From janka.vanschoenwinkel at uhasselt.be  Thu Jul 23 10:16:42 2015
From: janka.vanschoenwinkel at uhasselt.be (Janka Vanschoenwinkel)
Date: Thu, 23 Jul 2015 10:16:42 +0200
Subject: [R-sig-Geo] Overlapping a grid shapefile with a NUTS3 shapefile
 to determine one average value for each NUTS3 region
In-Reply-To: <b18dad52c43843f1854a014c0c8b89f1@winhexbeeu15.win.mail>
References: <CAHymut+Lhe-2h6VQvBEiJvW2nO2hGC7ZPgfRQRmHgxNMR1KCKw@mail.gmail.com>
	<11b75d20daf2457faea7afc54f663962@winhexbeeu15.win.mail>
	<b18dad52c43843f1854a014c0c8b89f1@winhexbeeu15.win.mail>
Message-ID: <CAHymutLuQPzRBhawnR3Oh47bYVSYMmR8W3UHQnKfZJckiSb3-Q@mail.gmail.com>

Thank you very much Linus!

This would solve my problem of having point coordinates and the grid cells
would be filled.

However, with the raster package, can I read in an empty grid shapefile and
then add the values per grid through a text file? Because that was my first
problem: adding values from a text file to a grid based on longitude and
latitude centroids of each grid.

Thanks in advance!

Janka

2015-07-22 11:48 GMT+02:00 Linus Holtermann <holtermann at hwwi.org>:

> Sorry,
>
> the right command is "exctract", of course.
>
> Mit freundlichen Gr??en
>
>
> Linus Holtermann
> Hamburgisches WeltWirtschaftsInstitut gemeinn?tzige GmbH (HWWI)
> Heimhuder Stra?e 71
> 20148 Hamburg
> Tel +49-(0)40-340576-336
> Fax+49-(0)40-340576-776
> Internet: www.hwwi.org
> Email: holtermann at hwwi.org
>
> Amtsgericht Hamburg HRB 94303
> Gesch?ftsf?hrer: PD Dr. Christian Growitsch | Prof. Dr. Henning V?pel
> Prokura: Dipl. Kauffrau Alexis Malchin
> Umsatzsteuer-ID: DE 241849425
>
>
> -----Urspr?ngliche Nachricht-----
> Von: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] Im Auftrag von
> Linus Holtermann
> Gesendet: Mittwoch, 22. Juli 2015 11:46
> An: Janka Vanschoenwinkel; r-sig-geo at r-project.org
> Betreff: Re: [R-sig-Geo] Overlapping a grid shapefile with a NUTS3
> shapefile to determine one average value for each NUTS3 region
>
> Hello,
>
> take a look at the "overlay" command in the raster-package. Weight=TRUE
> may be a step in the right direction for your problem.
>
> Bests,
>
>
>
> Linus Holtermann
> Hamburgisches WeltWirtschaftsInstitut gemeinn?tzige GmbH (HWWI) Heimhuder
> Stra?e 71
> 20148 Hamburg
> Tel +49-(0)40-340576-336
> Fax+49-(0)40-340576-776
> Internet: www.hwwi.org
> Email: holtermann at hwwi.org
>
> Amtsgericht Hamburg HRB 94303
> Gesch?ftsf?hrer: PD Dr. Christian Growitsch | Prof. Dr. Henning V?pel
> Prokura: Dipl. Kauffrau Alexis Malchin
> Umsatzsteuer-ID: DE 241849425
>
>
> -----Urspr?ngliche Nachricht-----
> Von: R-sig-Geo [mailto:r-sig-geo-bounces at r-project.org] Im Auftrag von
> Janka Vanschoenwinkel
> Gesendet: Mittwoch, 22. Juli 2015 11:37
> An: r-sig-geo at r-project.org
> Betreff: [R-sig-Geo] Overlapping a grid shapefile with a NUTS3 shapefile
> to determine one average value for each NUTS3 region
>
> Dear listmembers!
>
>
> I would like to add the average value of, let?s say soil moisture, to each
> NUTS3 region. However, soil moisture values are stored in little grids.
> Therefore, I need to find a way to calculate which grids overlap with a
> certain NUTS3 region in order to determine the average soil moisture value
> for that NUTS3 region. Visually, it can be compared to this picture where
> little grids approximate together the shape of US states:
> http://fieldguide.mt.gov/RangeMaps%5CESMapQUAD_9217.jpg
>
>
> It is possible that one NUTS3 region consists of 2 full grids and 3 half
> grids, while another NUTS3 region consists of only a 0.75 grid. It is also
> possible that some grids are empty because I don?t have values there.
>
>
> I assume that this requires 3 steps (but I am actually not sure):
>
>
>    - Step 1 would be to add the values of the text file to the grid
>    shapefile
>    - Step 2 would be to overlap the grid shapefile with the empty nuts3
>    shapefile
>    - Step 3 would be to write a new nuts3 shapefile which contains the
>    overlapped values
>
> My data and shapefiles can be found through the following link:
>
>
> https://drive.google.com/folderview?id=0By9u5m3kxn9yfjZtdFZLcW82SWpzT1VwZXE1a3FtRGtSdEl1c1NvY205TGpack9xSFc2T2s&usp=sharing
>
>
>    - mydata = read.csv("MyData.csv", header = TRUE) #contains coordinates
>    in latitude and longitude form that represent the centroids of each
>    ?grid?.  #mydata also contains 1 variable (random numbers in this case)
>    that I want to match to the nuts3 regions in the ?nuts? shapefile
>    - library(rgdal)
>    - grid <- readOGR(".", layer = "grid_025dd") #each grid contains de
>    centroid coordinates that should be linked to mydata in order to fill
> all
>    the grids with the variable of mydata
>    - nuts <- readOGR(".", layer = "NUTS_RG_60M_2006")
>
> Currently, I am nowhere. Maybe I don?t use the right keywords to google,
> but mostly, I am not used to working with coordinates. In the previous maps
> that I made, I was always capable of using some sort of objectid common to
> the data and the shapefile. Now, this is not the case. There should be an
> easy way to tell R to use the coordinates of mydata and combine them with
> the coordinates of the grids, but I can?t figure it out.
>
>
> Another issue that I face is that the values of the grids in ?mydata?
> should fill up an entire grid. Yet, R recognizes the values as point
> values.
>
>
>
> Could someone please help me and point me in the correct direction for step
> 1 and 2? I think I should be able to do step 3 on my own.
>
> Thanks a lot for your help! I appreciate it a lot!
>
>
>
> Dear kindness,
>
>
> Janka
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 

[image: Logo UHasselt]Mevrouw Janka Vanschoenwinkel
*Doctoraatsbursaal - PhD *
Milieueconomie - Environmental economics

T +32(0)11 26 87 42 | GSM +32(0)476 28 21 40

www.uhasselt.be/eec

Universiteit Hasselt | Campus Diepenbeek
Agoralaan Gebouw D | B-3590 Diepenbeek
Kantoor F11

Postadres: Universiteit Hasselt | Martelarenlaan 42 | B-3500 Hasselt

P Please consider the environment before printing this e-mail

	[[alternative HTML version deleted]]


From hanna.meyer at geo.uni-marburg.de  Thu Jul 23 14:05:58 2015
From: hanna.meyer at geo.uni-marburg.de (Hanna Meyer)
Date: Thu, 23 Jul 2015 14:05:58 +0200
Subject: [R-sig-Geo] Rights to publish data based on Google satellite images
 in scientific journals?
Message-ID: <55B0D8A6.5080206@geo.uni-marburg.de>

Dear all,

Please excuse that my question is not about R in the first place but I 
guess it's still a good place to ask this question.

I downloaded google satellite images via the dismo R package. With the 
RGB values of the images I did a land cover classification.

Now I wonder whether I can use the results for a publication in a 
scientific journal.
Though a number of publications using the data in a similar way exist, 
according to the terms of service of google maps it is not allowed to 
produce derived products.
However, if the project falls under the term of "fair use" it might be 
possible (http://www.google.com/permissions/geoguidelines.html).
On the google maps API terms of service they highlight that the created 
products (https://developers.google.com/maps/terms) must be freely 
available which would be the case.

Do you have any experiences about this issue?

Best regards
Hanna

-- 
Hanna Meyer
  
Department of Geography
Environmental Informatics
Philipps-Universit?t Marburg
Deutschhausstr. 12
35032 Marburg
Phone: +49 6421-2825954

http://www.environmentalinformatics-marburg.de/


From hengl at spatial-analyst.net  Thu Jul 23 15:28:47 2015
From: hengl at spatial-analyst.net (Tomislav Hengl)
Date: Thu, 23 Jul 2015 15:28:47 +0200
Subject: [R-sig-Geo] Rights to publish data based on Google satellite
 images in scientific journals?
In-Reply-To: <55B0D8A6.5080206@geo.uni-marburg.de>
References: <55B0D8A6.5080206@geo.uni-marburg.de>
Message-ID: <55B0EC0F.6010105@spatial-analyst.net>


Hi Hanna,

I am aware of several journal articles where Google data is used in 
figures (e.g. 
http://www.sciencedirect.com/science/article/pii/S0301479708001151#gr2); 
take especially a look at: http://www.jstatsoft.org/v63/i04/paper

The Google Geo guidelines say:

"You may print Content from Maps and Earth for personal use and enlarge 
it. In all uses where print will be distributed, first be sure to read 
our FAQ on applicable product Terms of Service and fair use. Second, all 
uses must properly show attribution to both Google and our data 
providers. Please see our attribution page for more information... No 
explicit permission is required for your print project. We are unable to 
sign any letter or contract specifying that your project has our 
explicit permission."

My guess is that, as long as you clearly show Google and other (C) signs 
you should be fine.

Few times I've tried to upload some plotKML screenshots to Wikimedia 
Commons but they have removed them 
(https://commons.wikimedia.org/wiki/Commons:Copyright_rules_by_subject_matter#Maps_.26_satellite_imagery), 
so any screenshot you make with Google data is definitively not in 
public domain.

The publisher will be able to tell you more, but as far as I know 
companies such as Elsevier even support using web-maps:

http://www.journals.elsevier.com/animal-behaviour/news/google-maps-application-enriches-articles/

But why not use OpenStreetMap for this? See 
https://cran.r-project.org/web/packages/OpenStreetMap/ and/or 
https://cran.r-project.org/web/packages/osmar/

OpenStreetMap you can even combine with KML and then embed in websites 
etc (see e.g. 
http://gsif.isric.org/doku.php?id=wiki:tutorial_plotkml#point_line_polygon_and_gridded_objects).

HTH,

T. Hengl

On 23-7-2015 14:05, Hanna Meyer wrote:
> Dear all,
>
> Please excuse that my question is not about R in the first place but I
> guess it's still a good place to ask this question.
>
> I downloaded google satellite images via the dismo R package. With the
> RGB values of the images I did a land cover classification.
>
> Now I wonder whether I can use the results for a publication in a
> scientific journal.
> Though a number of publications using the data in a similar way exist,
> according to the terms of service of google maps it is not allowed to
> produce derived products.
> However, if the project falls under the term of "fair use" it might be
> possible (http://www.google.com/permissions/geoguidelines.html).
> On the google maps API terms of service they highlight that the created
> products (https://developers.google.com/maps/terms) must be freely
> available which would be the case.
>
> Do you have any experiences about this issue?
>
> Best regards
> Hanna
>


From hc10024 at gmail.com  Fri Jul 24 00:12:46 2015
From: hc10024 at gmail.com (Helen Chen)
Date: Thu, 23 Jul 2015 15:12:46 -0700
Subject: [R-sig-Geo] spBayes package spLM function
Message-ID: <CAKjCKvEzXE3eHHZXpC3PcE2NqbDPrQhrF8bR4_jeUWK013ed3Q@mail.gmail.com>

Hi,

I have tried to implement the spLM function from spBayes package to my data
(rainfall value, elevation, coordinates).

However, the error message shows up when I run this chunk of codes:

bef.sp <- spLM(S3~elv,
+ data=A, coords=cook, starting=list("phi"=3/200,"sigma.sq"=0.08,
+ "tau.sq"=0.02), tuning=list("phi"=0.1, "sigma.sq"=0.05, "tau.sq"=0.05),
+                priors=list("phi.Unif"=c(3/1500, 3/50), "sigma.sq.IG"=c(2,
0.08),"tau.sq.IG"=c(2, 0.02)), cov.model="spherical",n.samples=n.samples)

the error message is

Error in spLM(S3 ~ elv, data = A, coords = cook, starting = list(phi =
3/200,  :
  error: coords must n-by-2 matrix of xy-coordinate locations

I am sure that my coordinates is a 29 by 2 matrix, but it also tells me
this error message.

Could anyone help me to figure out. Thanks for all your help.



Helen

	[[alternative HTML version deleted]]


From sarah.goslee at gmail.com  Fri Jul 24 00:16:35 2015
From: sarah.goslee at gmail.com (Sarah Goslee)
Date: Thu, 23 Jul 2015 18:16:35 -0400
Subject: [R-sig-Geo] spBayes package spLM function
In-Reply-To: <CAKjCKvEzXE3eHHZXpC3PcE2NqbDPrQhrF8bR4_jeUWK013ed3Q@mail.gmail.com>
References: <CAKjCKvEzXE3eHHZXpC3PcE2NqbDPrQhrF8bR4_jeUWK013ed3Q@mail.gmail.com>
Message-ID: <CAM_vju=Nd-v1tCNa5MS0S9vj4=gdnQpbbdH+BTCKJPKWOD=5mg@mail.gmail.com>

Are you sure that cook is a matrix and not a data frame?

What are the outputs of:

dim(cook)
is.matrix(cook)
str(cook)

Sarah

On Thu, Jul 23, 2015 at 6:12 PM, Helen Chen <hc10024 at gmail.com> wrote:
> Hi,
>
> I have tried to implement the spLM function from spBayes package to my data
> (rainfall value, elevation, coordinates).
>
> However, the error message shows up when I run this chunk of codes:
>
> bef.sp <- spLM(S3~elv,
> + data=A, coords=cook, starting=list("phi"=3/200,"sigma.sq"=0.08,
> + "tau.sq"=0.02), tuning=list("phi"=0.1, "sigma.sq"=0.05, "tau.sq"=0.05),
> +                priors=list("phi.Unif"=c(3/1500, 3/50), "sigma.sq.IG"=c(2,
> 0.08),"tau.sq.IG"=c(2, 0.02)), cov.model="spherical",n.samples=n.samples)
>
> the error message is
>
> Error in spLM(S3 ~ elv, data = A, coords = cook, starting = list(phi =
> 3/200,  :
>   error: coords must n-by-2 matrix of xy-coordinate locations
>
> I am sure that my coordinates is a 29 by 2 matrix, but it also tells me
> this error message.
>
> Could anyone help me to figure out. Thanks for all your help.
>
>
>
> Helen
>

-- 
Sarah Goslee
http://www.functionaldiversity.org


From karljarvis at nau.edu  Fri Jul 24 02:48:17 2015
From: karljarvis at nau.edu (Karl Jarvis)
Date: Thu, 23 Jul 2015 18:48:17 -0600
Subject: [R-sig-Geo] Split polygon by line
Message-ID: <55B18B51.7070005@nau.edu>

Hi all,
I'd like to split a single convex polygon into two polygons by a line 
that bisects it, like in this toy example:

library(rgeos)
pol = 
SpatialPolygons(list(Polygons(list(Polygon(cbind(c(0,1,1,0,0),c(0,0,1,1,0)))), 
ID="polygon")))
line = SpatialLines(list(Lines(list(Line(cbind(c(0,1),c(0.5,0.5)))), 
ID="line")))

This gives a square with a horizontal line in the middle. I was hoping 
this would do it:

gUnion(pol, line)

But that just gives an answer similar to "pol" that lacks the line.

Another thought was to convert the polygon to lines, gUnion them, and 
then convert to SpatialPolygon.

pol.sl = as(pol, "SpatialLines")
pol.union = gUnion(pol.sl, line)

The first part works, but I can't think of how to get SpatialLines to 
become SpatialPolygons. There's no method for this:

as(pol.union, "SpatialPolygons")

Thoughts?
Karl

-- 
Karl Jarvis
PhD Candidate
Lab of Landscape Ecology and Conservation Biology, Landscape 
Conservation Initiative
Lab of Conservation Biology and Wildlife Ecology, School of Forestry
Northern Arizona University
karljarvis.wordpress.com <https://karljarvis.wordpress.com/>

	[[alternative HTML version deleted]]


From tim.appelhans at gmail.com  Fri Jul 24 11:39:46 2015
From: tim.appelhans at gmail.com (Tim Appelhans)
Date: Fri, 24 Jul 2015 11:39:46 +0200
Subject: [R-sig-Geo] mapView: basic interactive viewing of spatial data in R
Message-ID: <55B207E2.9030408@gmail.com>

Dear list members,

I would like to draw your attention to a little 'project' I've been 
working on over the past few weeks.

Using leaflet for R, I have defined some methods for spatial data (e.g. 
Raster*, Spatial* objects) to quickly visualise them in either the 
RStudio Viewer pan or the default web browser. The function I created 
for this is called mapView().

Think of it as an interactive version of spplot()/plot() for spatial 
data (though less versatile). It enables zooming, paning and basic layer 
queries (i.e. printing of the attributes in the @data slot of Spatial* 
objects + the x/y location of the feature). For Raster* objects queries 
are currently not available as leaflet translates the data into RGB 
values for display. Furthermore, background maps can be defined and 
multiple different spatial object layers can be overlaid.
At the moment mapView() lives in our Rsenal package on github 
(https://github.com/environmentalinformatics-marburg/Rsenal) but this is 
likely going to change at some point in the not too distant future. This 
also depends on whether there is active interest in developping this 
sort of thing further to provide more than the current admittedly rather 
limited functionality. This, however, would involve JavaScript coding 
which I do not have any experience with.

A quick (non-interactive) intorduction can be found here:

https://metvurst.wordpress.com/

The full introductory article including interactive examples is 
published here:

http://environmentalinformatics-marburg.github.io/web-presentations/20150723_mapView.html

I hope this may prove useful for some of you.
Also, if anyone is keen to get involved in taking this further, please 
let me know and we will see how to best proceed.

Best,
Tim

-- 
#####################################
Tim Appelhans
Department of Geography
Environmental Informatics
Philipps Universit?t Marburg
Deutschhausstra?e 12
35032 Marburg (Paketpost: 35037 Marburg)
Germany

Tel +49 (0) 6421 28-25957

http://environmentalinformatics-marburg.de/


	[[alternative HTML version deleted]]


From Rainer at krugs.de  Fri Jul 24 12:03:47 2015
From: Rainer at krugs.de (Rainer M Krug)
Date: Fri, 24 Jul 2015 12:03:47 +0200
Subject: [R-sig-Geo] mapView: basic interactive viewing of spatial data
	in R
In-Reply-To: <55B207E2.9030408@gmail.com> (Tim Appelhans's message of "Fri, 24
	Jul 2015 11:39:46 +0200")
References: <55B207E2.9030408@gmail.com>
Message-ID: <m2k2tpzxbw.fsf@krugs.de>

Tim Appelhans <tim.appelhans at gmail.com> writes:

> Dear list members,
>
> I would like to draw your attention to a little 'project' I've been 
> working on over the past few weeks.
>
> Using leaflet for R, I have defined some methods for spatial data (e.g. 
> Raster*, Spatial* objects) to quickly visualise them in either the 
> RStudio Viewer pan or the default web browser. The function I created 
> for this is called mapView().
>
> Think of it as an interactive version of spplot()/plot() for spatial 
> data (though less versatile). It enables zooming, paning and basic layer 
> queries (i.e. printing of the attributes in the @data slot of Spatial* 
> objects + the x/y location of the feature). For Raster* objects queries 
> are currently not available as leaflet translates the data into RGB 
> values for display. Furthermore, background maps can be defined and 
> multiple different spatial object layers can be overlaid.
> At the moment mapView() lives in our Rsenal package on github 
> (https://github.com/environmentalinformatics-marburg/Rsenal) but this is 
> likely going to change at some point in the not too distant future. This 
> also depends on whether there is active interest in developping this 
> sort of thing further to provide more than the current admittedly rather 
> limited functionality. This, however, would involve JavaScript coding 
> which I do not have any experience with.
>
> A quick (non-interactive) intorduction can be found here:
>
> https://metvurst.wordpress.com/
>
> The full introductory article including interactive examples is 
> published here:
>
> http://environmentalinformatics-marburg.github.io/web-presentations/20150723_mapView.html
>
> I hope this may prove useful for some of you.

This looks like something I was really missing! I was always exporting
my spatial data into GRASS and viewing it there - but this looks really
brilliant! This makes out of R a very powerful command line GIS.

I would really like to see this functionality in a separate R package on
CRAN - even with only its current functionality, it is very useful!

Thanks a lot and keep us posted,

Rainer

> Also, if anyone is keen to get involved in taking this further, please 
> let me know and we will see how to best proceed.
>
> Best,
> Tim

-- 
Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation Biology, UCT), Dipl. Phys. (Germany)

Centre of Excellence for Invasion Biology
Stellenbosch University
South Africa

Tel :       +33 - (0)9 53 10 27 44
Cell:       +33 - (0)6 85 62 59 98
Fax :       +33 - (0)9 58 10 27 44

Fax (D):    +49 - (0)3 21 21 25 22 44

email:      Rainer at krugs.de

Skype:      RMkrug

PGP: 0x0F52F982
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 480 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150724/5b3ccdb9/attachment.bin>

From bernd.vogelgesang at gmx.de  Fri Jul 24 13:13:46 2015
From: bernd.vogelgesang at gmx.de (Bernd Vogelgesang)
Date: Fri, 24 Jul 2015 13:13:46 +0200
Subject: [R-sig-Geo] mapView: basic interactive viewing of spatial data
 in R
In-Reply-To: <m2k2tpzxbw.fsf@krugs.de>
References: <55B207E2.9030408@gmail.com> <m2k2tpzxbw.fsf@krugs.de>
Message-ID: <op.x19ys8uvl2i25i@bernd-terra-pc>

Hi,

can some one tell me how I can install this package?
Cloning and copying it to the R folder does not do it, installing in from  
file wants to have a tar.gz.
I usually use RStudio.

Thanx
Bernd


Am 24.07.2015, 12:03 Uhr, schrieb Rainer M Krug <Rainer at krugs.de>:

> Tim Appelhans <tim.appelhans at gmail.com> writes:
>
>> Dear list members,
>>
>> I would like to draw your attention to a little 'project' I've been
>> working on over the past few weeks.
>>
>> Using leaflet for R, I have defined some methods for spatial data (e.g.
>> Raster*, Spatial* objects) to quickly visualise them in either the
>> RStudio Viewer pan or the default web browser. The function I created
>> for this is called mapView().
>>
>> Think of it as an interactive version of spplot()/plot() for spatial
>> data (though less versatile). It enables zooming, paning and basic layer
>> queries (i.e. printing of the attributes in the @data slot of Spatial*
>> objects + the x/y location of the feature). For Raster* objects queries
>> are currently not available as leaflet translates the data into RGB
>> values for display. Furthermore, background maps can be defined and
>> multiple different spatial object layers can be overlaid.
>> At the moment mapView() lives in our Rsenal package on github
>> (https://github.com/environmentalinformatics-marburg/Rsenal) but this is
>> likely going to change at some point in the not too distant future. This
>> also depends on whether there is active interest in developping this
>> sort of thing further to provide more than the current admittedly rather
>> limited functionality. This, however, would involve JavaScript coding
>> which I do not have any experience with.
>>
>> A quick (non-interactive) intorduction can be found here:
>>
>> https://metvurst.wordpress.com/
>>
>> The full introductory article including interactive examples is
>> published here:
>>
>> http://environmentalinformatics-marburg.github.io/web-presentations/20150723_mapView.html
>>
>> I hope this may prove useful for some of you.
>
> This looks like something I was really missing! I was always exporting
> my spatial data into GRASS and viewing it there - but this looks really
> brilliant! This makes out of R a very powerful command line GIS.
>
> I would really like to see this functionality in a separate R package on
> CRAN - even with only its current functionality, it is very useful!
>
> Thanks a lot and keep us posted,
>
> Rainer
>
>> Also, if anyone is keen to get involved in taking this further, please
>> let me know and we will see how to best proceed.
>>
>> Best,
>> Tim
>


-- 
Bernd Vogelgesang
Siedlerstra?e 2
91083 Baiersdorf/Igelsdorf
Tel: 09133-825374


From tim.appelhans at gmail.com  Fri Jul 24 13:20:07 2015
From: tim.appelhans at gmail.com (Tim Appelhans)
Date: Fri, 24 Jul 2015 13:20:07 +0200
Subject: [R-sig-Geo] mapView: basic interactive viewing of spatial data
 in R
In-Reply-To: <op.x19ys8uvl2i25i@bernd-terra-pc>
References: <55B207E2.9030408@gmail.com> <m2k2tpzxbw.fsf@krugs.de>
	<op.x19ys8uvl2i25i@bernd-terra-pc>
Message-ID: <55B21F67.1000903@gmail.com>



On 24.07.2015 13:13, Bernd Vogelgesang wrote:
> Hi,
>
> can some one tell me how I can install this package?
> Cloning and copying it to the R folder does not do it, installing in 
> from file wants to have a tar.gz.
> I usually use RStudio.
>
> Thanx
> Bernd
>

you can use library("devtools") for this. devtools is available on CRAN

library("devtools")
install_github("environmentalinformatics-marburg/Rsenal")

That should do it

>
> Am 24.07.2015, 12:03 Uhr, schrieb Rainer M Krug <Rainer at krugs.de>:
>
>> Tim Appelhans <tim.appelhans at gmail.com> writes:
>>
>>> Dear list members,
>>>
>>> I would like to draw your attention to a little 'project' I've been
>>> working on over the past few weeks.
>>>
>>> Using leaflet for R, I have defined some methods for spatial data (e.g.
>>> Raster*, Spatial* objects) to quickly visualise them in either the
>>> RStudio Viewer pan or the default web browser. The function I created
>>> for this is called mapView().
>>>
>>> Think of it as an interactive version of spplot()/plot() for spatial
>>> data (though less versatile). It enables zooming, paning and basic 
>>> layer
>>> queries (i.e. printing of the attributes in the @data slot of Spatial*
>>> objects + the x/y location of the feature). For Raster* objects queries
>>> are currently not available as leaflet translates the data into RGB
>>> values for display. Furthermore, background maps can be defined and
>>> multiple different spatial object layers can be overlaid.
>>> At the moment mapView() lives in our Rsenal package on github
>>> (https://github.com/environmentalinformatics-marburg/Rsenal) but 
>>> this is
>>> likely going to change at some point in the not too distant future. 
>>> This
>>> also depends on whether there is active interest in developping this
>>> sort of thing further to provide more than the current admittedly 
>>> rather
>>> limited functionality. This, however, would involve JavaScript coding
>>> which I do not have any experience with.
>>>
>>> A quick (non-interactive) intorduction can be found here:
>>>
>>> https://metvurst.wordpress.com/
>>>
>>> The full introductory article including interactive examples is
>>> published here:
>>>
>>> http://environmentalinformatics-marburg.github.io/web-presentations/20150723_mapView.html 
>>>
>>>
>>> I hope this may prove useful for some of you.
>>
>> This looks like something I was really missing! I was always exporting
>> my spatial data into GRASS and viewing it there - but this looks really
>> brilliant! This makes out of R a very powerful command line GIS.
>>
>> I would really like to see this functionality in a separate R package on
>> CRAN - even with only its current functionality, it is very useful!
>>
>> Thanks a lot and keep us posted,
>>
>> Rainer
>>
>>> Also, if anyone is keen to get involved in taking this further, please
>>> let me know and we will see how to best proceed.
>>>
>>> Best,
>>> Tim
>>
>
>

-- 
#####################################
Tim Appelhans
Department of Geography
Environmental Informatics
Philipps Universit?t Marburg
Deutschhausstra?e 12
35032 Marburg (Paketpost: 35037 Marburg)
Germany

Tel +49 (0) 6421 28-25957

http://environmentalinformatics-marburg.de/


From bernd.vogelgesang at gmx.de  Fri Jul 24 13:39:00 2015
From: bernd.vogelgesang at gmx.de (Bernd Vogelgesang)
Date: Fri, 24 Jul 2015 13:39:00 +0200
Subject: [R-sig-Geo] mapView: basic interactive viewing of spatial data
 in R
In-Reply-To: <55B21F67.1000903@gmail.com>
References: <55B207E2.9030408@gmail.com> <m2k2tpzxbw.fsf@krugs.de>
	<op.x19ys8uvl2i25i@bernd-terra-pc> <55B21F67.1000903@gmail.com>
Message-ID: <op.x19zzap7l2i25i@bernd-terra-pc>

Thanks a lot!
First it complained that latticeExtra was missing, but now everything is  
in place and running.
I never managed to learn how to create proper plots, so this is really  
nice.
I'm kind of excited!

Bernd

Am 24.07.2015, 13:20 Uhr, schrieb Tim Appelhans <tim.appelhans at gmail.com>:

> library("devtools")
> install_github("environmentalinformatics-marburg/Rsenal")


--


From tim.appelhans at gmail.com  Fri Jul 24 13:42:32 2015
From: tim.appelhans at gmail.com (Tim Appelhans)
Date: Fri, 24 Jul 2015 13:42:32 +0200
Subject: [R-sig-Geo] mapView: basic interactive viewing of spatial data
 in R
In-Reply-To: <E6E826EF-DE0C-4D85-A768-F0899A284679@uv.es>
References: <55B207E2.9030408@gmail.com> <m2k2tpzxbw.fsf@krugs.de>
	<op.x19ys8uvl2i25i@bernd-terra-pc> <55B21F67.1000903@gmail.com>
	<E6E826EF-DE0C-4D85-A768-F0899A284679@uv.es>
Message-ID: <55B224A8.1000409@gmail.com>



On 24.07.2015 13:29, Agustin Diez Castillo wrote:
> I?m getting an error when testing
>
> error: 'colour_ramp' is not an exported object from 'namespace:scales'

This is strange as 'colour_ramp' is an exported object from 
'namespace:scales' as can be seen here

https://github.com/cran/scales/blob/master/NAMESPACE

This function is used by leaflet

https://github.com/cran/leaflet/blob/master/R/colors.R

I do not get this error, my sessionInfo() is

R version 3.2.1 (2015-06-18)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 14.04.2 LTS

locale:
  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C LC_TIME=de_DE.UTF-8        
LC_COLLATE=en_US.UTF-8
  [5] LC_MONETARY=de_DE.UTF-8    LC_MESSAGES=en_US.UTF-8 
LC_PAPER=de_DE.UTF-8       LC_NAME=C
  [9] LC_ADDRESS=C               LC_TELEPHONE=C 
LC_MEASUREMENT=de_DE.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods base

other attached packages:
[1] Rsenal_0.1.81      raster_2.4-15      sp_1.1-1 leaflet_1.0.0.9999

loaded via a namespace (and not attached):
  [1] htmlwidgets_0.5.1 colorspace_1.2-6  scales_0.2.5 plyr_1.8.3        
magrittr_1.5      htmltools_0.2.6
  [7] tools_3.2.1       Rcpp_0.11.6       grid_3.2.1 digest_0.6.8      
munsell_0.4.2     lattice_0.20-33

which suggests I am using the same version of scales as you are...

I really am not sure what is happening here.

>
>  From the help page
> data(meuse.grid)
> coordinates(meuse.grid) = ~x+y
> proj4string(meuse.grid) <- CRS("+init=epsg:28992")
> gridded(meuse.grid) = TRUE
> meuse_rst <- stack(meuse.grid)
> m1 <- mapView(meuse_rst)
>
> sessionInfo()
> R version 3.1.3 (2015-03-09)
> Platform: x86_64-apple-darwin10.8.0 (64-bit)
> Running under: OS X 10.9.5 (Mavericks)
>
> locale:
> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
>   [1] leaflet_1.0.0       Rsenal_0.1.81       colorspace_1.2-6    automap_1.0-14      scales_0.2.5        outliers_0.14       spatstat_1.41-1     foreign_0.8-63
>   [9] plyr_1.8.1          rasterVis_0.35      latticeExtra_0.6-26 RColorBrewer_1.1-2  data.table_1.9.4    Bchron_4.1.1        inline_0.3.14       raster_2.3-40
> [17] rgeos_0.3-8         rgdal_0.9-2         lattice_0.20-31     ggplot2_1.0.1       devtools_1.7.0      spdep_0.5-88        Matrix_1.2-0        sp_1.0-17
>
> loaded via a namespace (and not attached):
>   [1] abind_1.4-3      bitops_1.0-6     boot_1.3-16      chron_2.3-45     coda_0.17-1      deldir_0.1-9     digest_0.6.8     ellipse_0.3-8    FNN_1.1          goftest_1.0-2
> [11] grid_3.1.3       gstat_1.0-22     gtable_0.1.2     hdrcde_3.1       hexbin_1.27.0    htmltools_0.2.6  htmlwidgets_0.5  httr_0.6.1       intervals_0.15.0 LearnBayes_2.15
> [21] magrittr_1.5     MASS_7.3-40      mclust_5.0.0     mgcv_1.8-6       munsell_0.4.2    nlme_3.1-120     polyclip_1.3-0   proto_0.3-10     Rcpp_0.11.5      RCurl_1.95-4.5
> [31] reshape_0.8.5    reshape2_1.4.1   spacetime_1.1-3  splines_3.1.3    stringr_0.6.2    tensor_1.5       tools_3.1.3      xts_0.9-7        zoo_1.7-12
>
> On 24Jul, 2015, at 1:20 PM, Tim Appelhans <tim.appelhans at gmail.com> wrote:
>
>>
>> On 24.07.2015 13:13, Bernd Vogelgesang wrote:
>>> Hi,
>>>
>>> can some one tell me how I can install this package?
>>> Cloning and copying it to the R folder does not do it, installing in from file wants to have a tar.gz.
>>> I usually use RStudio.
>>>
>>> Thanx
>>> Bernd
>>>
>> you can use library("devtools") for this. devtools is available on CRAN
>>
>> library("devtools")
>> install_github("environmentalinformatics-marburg/Rsenal")
>>
>> That should do it
>>
>>> Am 24.07.2015, 12:03 Uhr, schrieb Rainer M Krug <Rainer at krugs.de>:
>>>
>>>> Tim Appelhans <tim.appelhans at gmail.com> writes:
>>>>
>>>>> Dear list members,
>>>>>
>>>>> I would like to draw your attention to a little 'project' I've been
>>>>> working on over the past few weeks.
>>>>>
>>>>> Using leaflet for R, I have defined some methods for spatial data (e.g.
>>>>> Raster*, Spatial* objects) to quickly visualise them in either the
>>>>> RStudio Viewer pan or the default web browser. The function I created
>>>>> for this is called mapView().
>>>>>
>>>>> Think of it as an interactive version of spplot()/plot() for spatial
>>>>> data (though less versatile). It enables zooming, paning and basic layer
>>>>> queries (i.e. printing of the attributes in the @data slot of Spatial*
>>>>> objects + the x/y location of the feature). For Raster* objects queries
>>>>> are currently not available as leaflet translates the data into RGB
>>>>> values for display. Furthermore, background maps can be defined and
>>>>> multiple different spatial object layers can be overlaid.
>>>>> At the moment mapView() lives in our Rsenal package on github
>>>>> (https://github.com/environmentalinformatics-marburg/Rsenal) but this is
>>>>> likely going to change at some point in the not too distant future. This
>>>>> also depends on whether there is active interest in developping this
>>>>> sort of thing further to provide more than the current admittedly rather
>>>>> limited functionality. This, however, would involve JavaScript coding
>>>>> which I do not have any experience with.
>>>>>
>>>>> A quick (non-interactive) intorduction can be found here:
>>>>>
>>>>> https://metvurst.wordpress.com/
>>>>>
>>>>> The full introductory article including interactive examples is
>>>>> published here:
>>>>>
>>>>> http://environmentalinformatics-marburg.github.io/web-presentations/20150723_mapView.html
>>>>>
>>>>> I hope this may prove useful for some of you.
>>>> This looks like something I was really missing! I was always exporting
>>>> my spatial data into GRASS and viewing it there - but this looks really
>>>> brilliant! This makes out of R a very powerful command line GIS.
>>>>
>>>> I would really like to see this functionality in a separate R package on
>>>> CRAN - even with only its current functionality, it is very useful!
>>>>
>>>> Thanks a lot and keep us posted,
>>>>
>>>> Rainer
>>>>
>>>>> Also, if anyone is keen to get involved in taking this further, please
>>>>> let me know and we will see how to best proceed.
>>>>>
>>>>> Best,
>>>>> Tim
>>>
>> --
>> #####################################
>> Tim Appelhans
>> Department of Geography
>> Environmental Informatics
>> Philipps Universit?t Marburg
>> Deutschhausstra?e 12
>> 35032 Marburg (Paketpost: 35037 Marburg)
>> Germany
>>
>> Tel +49 (0) 6421 28-25957
>>
>> http://environmentalinformatics-marburg.de/
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
#####################################
Tim Appelhans
Department of Geography
Environmental Informatics
Philipps Universit?t Marburg
Deutschhausstra?e 12
35032 Marburg (Paketpost: 35037 Marburg)
Germany

Tel +49 (0) 6421 28-25957

http://environmentalinformatics-marburg.de/


From Rainer at krugs.de  Fri Jul 24 14:01:27 2015
From: Rainer at krugs.de (Rainer M Krug)
Date: Fri, 24 Jul 2015 14:01:27 +0200
Subject: [R-sig-Geo] mapView: basic interactive viewing of spatial data
	in R
In-Reply-To: <55B21F67.1000903@gmail.com> (Tim Appelhans's message of "Fri, 24
	Jul 2015 13:20:07 +0200")
References: <55B207E2.9030408@gmail.com> <m2k2tpzxbw.fsf@krugs.de>
	<op.x19ys8uvl2i25i@bernd-terra-pc> <55B21F67.1000903@gmail.com>
Message-ID: <m2fv4dzrvs.fsf@krugs.de>

Tim Appelhans <tim.appelhans at gmail.com> writes:

> On 24.07.2015 13:13, Bernd Vogelgesang wrote:
>> Hi,
>>
>> can some one tell me how I can install this package?
>> Cloning and copying it to the R folder does not do it, installing in
>> from file wants to have a tar.gz.
>> I usually use RStudio.
>>
>> Thanx
>> Bernd
>>
>
> you can use library("devtools") for this. devtools is available on CRAN
>
> library("devtools")
> install_github("environmentalinformatics-marburg/Rsenal")
>
> That should do it

That installed it, but "leaflet" is not installed:

,----
| > library(Rsenal
| + )
| Loading required package: raster
| Loading required package: sp
| 
| Attaching package: ?Rsenal?
| 
| The following object is masked from ?package:raster?:
| 
|     addLayer
| 
| > data(meuse.grid)
| > coordinates(meuse.grid) = ~x+y
| > proj4string(meuse.grid) <- CRS("+init=epsg:28992")
| > gridded(meuse.grid) = TRUE
| > meuse_rst <- stack(meuse.grid)
| > mapView(meuse_rst[[3]])
| Error in loadNamespace(name) : there is no package called ?leaflet?
| >
`----

After installing and loading leaflet, it works.

After that, "leaflet does not need to be loaded explicitly.

,----
| > sessionInfo()
| R version 3.2.1 (2015-06-18)
| Platform: x86_64-apple-darwin14.4.0 (64-bit)
| Running under: OS X 10.10.4 (Yosemite)
| 
| locale:
| [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
| 
| attached base packages:
| [1] stats     graphics  grDevices utils     datasets  methods   base
| 
| other attached packages:
| [1] Rsenal_0.1.81 raster_2.4-15 sp_1.1-1
| 
| loaded via a namespace (and not attached):
|  [1] Rcpp_0.11.6      lattice_0.20-31  png_0.1-7        digest_0.6.8
|  [5] grid_3.2.1       plyr_1.8.3       jsonlite_0.9.16  magrittr_1.5
|  [9] scales_0.2.5     leaflet_1.0.0    rgdal_1.0-4      tools_3.2.1
| [13] htmlwidgets_0.5  munsell_0.4.2    yaml_2.1.13      base64enc_0.1-2
| [17] colorspace_1.2-6 htmltools_0.2.6
| > version
|                _
| platform       x86_64-apple-darwin14.4.0
| arch           x86_64
| os             darwin14.4.0
| system         x86_64, darwin14.4.0
| status
| major          3
| minor          2.1
| year           2015
| month          06
| day            18
| svn rev        68531
| language       R
| version.string R version 3.2.1 (2015-06-18)
| nickname       World-Famous Astronaut
| >
`----

Cheers,

Rainer



Rainer
>
>>
>> Am 24.07.2015, 12:03 Uhr, schrieb Rainer M Krug <Rainer at krugs.de>:
>>
>>> Tim Appelhans <tim.appelhans at gmail.com> writes:
>>>
>>>> Dear list members,
>>>>
>>>> I would like to draw your attention to a little 'project' I've been
>>>> working on over the past few weeks.
>>>>
>>>> Using leaflet for R, I have defined some methods for spatial data (e.g.
>>>> Raster*, Spatial* objects) to quickly visualise them in either the
>>>> RStudio Viewer pan or the default web browser. The function I created
>>>> for this is called mapView().
>>>>
>>>> Think of it as an interactive version of spplot()/plot() for spatial
>>>> data (though less versatile). It enables zooming, paning and basic
>>>> layer
>>>> queries (i.e. printing of the attributes in the @data slot of Spatial*
>>>> objects + the x/y location of the feature). For Raster* objects queries
>>>> are currently not available as leaflet translates the data into RGB
>>>> values for display. Furthermore, background maps can be defined and
>>>> multiple different spatial object layers can be overlaid.
>>>> At the moment mapView() lives in our Rsenal package on github
>>>> (https://github.com/environmentalinformatics-marburg/Rsenal) but
>>>> this is
>>>> likely going to change at some point in the not too distant
>>>> future. This
>>>> also depends on whether there is active interest in developping this
>>>> sort of thing further to provide more than the current admittedly
>>>> rather
>>>> limited functionality. This, however, would involve JavaScript coding
>>>> which I do not have any experience with.
>>>>
>>>> A quick (non-interactive) intorduction can be found here:
>>>>
>>>> https://metvurst.wordpress.com/
>>>>
>>>> The full introductory article including interactive examples is
>>>> published here:
>>>>
>>>> http://environmentalinformatics-marburg.github.io/web-presentations/20150723_mapView.html 
>>>>
>>>>
>>>> I hope this may prove useful for some of you.
>>>
>>> This looks like something I was really missing! I was always exporting
>>> my spatial data into GRASS and viewing it there - but this looks really
>>> brilliant! This makes out of R a very powerful command line GIS.
>>>
>>> I would really like to see this functionality in a separate R package on
>>> CRAN - even with only its current functionality, it is very useful!
>>>
>>> Thanks a lot and keep us posted,
>>>
>>> Rainer
>>>
>>>> Also, if anyone is keen to get involved in taking this further, please
>>>> let me know and we will see how to best proceed.
>>>>
>>>> Best,
>>>> Tim
>>>
>>
>>

-- 
Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation Biology, UCT), Dipl. Phys. (Germany)

Centre of Excellence for Invasion Biology
Stellenbosch University
South Africa

Tel :       +33 - (0)9 53 10 27 44
Cell:       +33 - (0)6 85 62 59 98
Fax :       +33 - (0)9 58 10 27 44

Fax (D):    +49 - (0)3 21 21 25 22 44

email:      Rainer at krugs.de

Skype:      RMkrug

PGP: 0x0F52F982
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 480 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150724/79bff977/attachment.bin>

From edzer.pebesma at uni-muenster.de  Fri Jul 24 14:26:44 2015
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 24 Jul 2015 14:26:44 +0200
Subject: [R-sig-Geo] mapView: basic interactive viewing of spatial data
 in R
In-Reply-To: <55B207E2.9030408@gmail.com>
References: <55B207E2.9030408@gmail.com>
Message-ID: <55B22F04.3080704@uni-muenster.de>

Hi Tim, thanks for starting the discussion.

I started a similar discussion (off-list, with package maintainers) for
the case where google map or openstreetmap maps are used as background
in map plots created in R, support for which is now scattered over
ggmap::get_map, RgoogleMaps::GetMap, dismo::gmap and
https://github.com/hadley/rastermap. (on r-forge, sp::plot and
sp::spplot can now deal with these, see sp::demo(webmap)).

The (un)projection mapView does is towards epsg:4326 (longlat WGS84),
leaflet assumes this and takes care of the projection to web mercator;
the message printed in mapView (if verbose = TRUE) and your tutorial do
the correct thing but suggest they convert to mercator.

Some remaining questions:
- package leaflet also supports plotting Spatial* and Raster* objects,
what is exactly added by mapView?
- have you thought about integrating this functionality into the leaflet
R package?
- could we strive towards argument compatibility, so that we can get
things done by simply changing "plot" or "spplot" into "leaflet"?

On 07/24/2015 11:39 AM, Tim Appelhans wrote:
> Dear list members,
> 
> I would like to draw your attention to a little 'project' I've been 
> working on over the past few weeks.
> 
> Using leaflet for R, I have defined some methods for spatial data (e.g. 
> Raster*, Spatial* objects) to quickly visualise them in either the 
> RStudio Viewer pan or the default web browser. The function I created 
> for this is called mapView().
> 
> Think of it as an interactive version of spplot()/plot() for spatial 
> data (though less versatile). It enables zooming, paning and basic layer 
> queries (i.e. printing of the attributes in the @data slot of Spatial* 
> objects + the x/y location of the feature). For Raster* objects queries 
> are currently not available as leaflet translates the data into RGB 
> values for display. Furthermore, background maps can be defined and 
> multiple different spatial object layers can be overlaid.
> At the moment mapView() lives in our Rsenal package on github 
> (https://github.com/environmentalinformatics-marburg/Rsenal) but this is 
> likely going to change at some point in the not too distant future. This 
> also depends on whether there is active interest in developping this 
> sort of thing further to provide more than the current admittedly rather 
> limited functionality. This, however, would involve JavaScript coding 
> which I do not have any experience with.
> 
> A quick (non-interactive) intorduction can be found here:
> 
> https://metvurst.wordpress.com/
> 
> The full introductory article including interactive examples is 
> published here:
> 
> http://environmentalinformatics-marburg.github.io/web-presentations/20150723_mapView.html
> 
> I hope this may prove useful for some of you.
> Also, if anyone is keen to get involved in taking this further, please 
> let me know and we will see how to best proceed.
> 
> Best,
> Tim
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi),  University of M?nster,
Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
Journal of Statistical Software:   http://www.jstatsoft.org/
Computers & Geosciences:   http://elsevier.com/locate/cageo/
Spatial Statistics Society http://www.spatialstatistics.info

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150724/86f1d6c6/attachment.bin>

From tea3rd at gmail.com  Fri Jul 24 14:36:52 2015
From: tea3rd at gmail.com (Thomas Adams)
Date: Fri, 24 Jul 2015 07:36:52 -0500
Subject: [R-sig-Geo] mapView: basic interactive viewing of spatial data
	in R
In-Reply-To: <55B207E2.9030408@gmail.com>
References: <55B207E2.9030408@gmail.com>
Message-ID: <CAGxgkWiOgOMOjn9KdOgHEYwqkEi7mSj_dW220fX=S_=jtdExeA@mail.gmail.com>

Tim,

WOW! This is very cool...

Using the tips from others, I did the following (to summarize):

install.packages("leaflet",dependencies=T)
library("devtools")
install_github("environmentalinformatics-marburg/Rsenal")

Works great in the few minutes I've tried it.

Thanks!!

Tom

On Fri, Jul 24, 2015 at 4:39 AM, Tim Appelhans <tim.appelhans at gmail.com>
wrote:

> Dear list members,
>
> I would like to draw your attention to a little 'project' I've been
> working on over the past few weeks.
>
> Using leaflet for R, I have defined some methods for spatial data (e.g.
> Raster*, Spatial* objects) to quickly visualise them in either the
> RStudio Viewer pan or the default web browser. The function I created
> for this is called mapView().
>
> Think of it as an interactive version of spplot()/plot() for spatial
> data (though less versatile). It enables zooming, paning and basic layer
> queries (i.e. printing of the attributes in the @data slot of Spatial*
> objects + the x/y location of the feature). For Raster* objects queries
> are currently not available as leaflet translates the data into RGB
> values for display. Furthermore, background maps can be defined and
> multiple different spatial object layers can be overlaid.
> At the moment mapView() lives in our Rsenal package on github
> (https://github.com/environmentalinformatics-marburg/Rsenal) but this is
> likely going to change at some point in the not too distant future. This
> also depends on whether there is active interest in developping this
> sort of thing further to provide more than the current admittedly rather
> limited functionality. This, however, would involve JavaScript coding
> which I do not have any experience with.
>
> A quick (non-interactive) intorduction can be found here:
>
> https://metvurst.wordpress.com/
>
> The full introductory article including interactive examples is
> published here:
>
>
> http://environmentalinformatics-marburg.github.io/web-presentations/20150723_mapView.html
>
> I hope this may prove useful for some of you.
> Also, if anyone is keen to get involved in taking this further, please
> let me know and we will see how to best proceed.
>
> Best,
> Tim
>
> --
> #####################################
> Tim Appelhans
> Department of Geography
> Environmental Informatics
> Philipps Universit?t Marburg
> Deutschhausstra?e 12
> 35032 Marburg (Paketpost: 35037 Marburg)
> Germany
>
> Tel +49 (0) 6421 28-25957
>
> http://environmentalinformatics-marburg.de/
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Thomas E Adams, III
718 McBurney Drive
Lebanon, OH 45036

1 (513) 739-9512 (cell)

	[[alternative HTML version deleted]]


From pierluigi.derosa at gmail.com  Fri Jul 24 14:49:44 2015
From: pierluigi.derosa at gmail.com (pierluigi de rosa)
Date: Fri, 24 Jul 2015 14:49:44 +0200
Subject: [R-sig-Geo] Spplot error in change value color
Message-ID: <CAAgsrZjfxygd0RL=8YtU1Pr=pJp9veeGac+6DH-wR9Ud00euTg@mail.gmail.com>

Dear all,

I have a simple question.
I'm managing a SpatialPointsDataFrame with 12 columns

I'm able to plot it
this works:
> spplot(punti_eventi_siccita,zcol=6)  #only 6 column

I want to set value where change color
> custs=seq(20,250,50)
If I run this:

> spplot(punti_eventi_siccita,zcol=6,
colorkey=list(labels=list(at=cuts),at=cuts))
I have:
Error in legend[[i]]$fun : $ operator is invalid for atomic vectors

where I'm wrong?
I fund several example on internet and on several books but the code I
wrote above should work

Many thanks
Pierluigi


-- 
Ing. Pierluigi De Rosa (PhD)
cel: 3497558268 / fax: 075 7823038
skype: pierluigi.derosa

	[[alternative HTML version deleted]]


From bob at rudis.net  Fri Jul 24 15:07:44 2015
From: bob at rudis.net (boB Rudis)
Date: Fri, 24 Jul 2015 09:07:44 -0400
Subject: [R-sig-Geo] Positing a coord_proj for ggplot2
Message-ID: <CAJ4QxaNZh=sqtuT-8JpaEjjUxO16wc2fJn6Pd-BdmGLcsxpvjg@mail.gmail.com>

Hey folks

Having finally gotten tired of performing coordinate conversions to
Winkel-Tripel (and other) projections prior to passing map data to
ggplot2 (coord_map projection support is limited to what mapproject
supports and that's pretty scant) I was toying with a coord_proj
coordinate system for ggplot2 the other day and came up with this:
https://gist.github.com/hrbrmstr/363e33f74e2972c93ca7 (visual:
http://rpubs.com/hrbrmstr/coord-proj).

coord_proj uses proj4::project, so it supports any proj4string.

This won't be in ggplot2 right now as Hadley is updating/refactoring
the package and "coords" are going to work a bit differently. Plus
this adds a dependency I'm not sure he wants to add to it. You can
stick it in your own, local copy of ggplot2 and re-collate and rebuild
to use it.

proj4::project (and even spTransform, to a certain degree - no pun
intended) are unhappy dealing with lat/lon values outside the -90/90 :
-180:180 range and even have some issues with points right at the
extremes, so I did the following in the linked code:

df$x <- ifelse(df$x <= -180, -179.999999999, df$x)
df$x <- ifelse(df$x >= 180, 179.999999999, df$x)
df$y <- ifelse(df$y <= -90, -89.999999999, df$y)
df$y <- ifelse(df$y >= 90, 89.999999999, df$y)

It was a quick hack to just get coord_proj up and running and I know
it's a horrible one, but I'm looking for guidance/feedback/etc on what
I _should_ do here since I will be maintaining some version of this
moving forward (it's just too convenient for me not to and the new
"coords" may be as extensible as the forthcoming change to "geoms", so
this could be in a package all itself or added to another R geo
package).

thx,

-Bob


From tim.appelhans at gmail.com  Fri Jul 24 15:14:42 2015
From: tim.appelhans at gmail.com (Tim Appelhans)
Date: Fri, 24 Jul 2015 15:14:42 +0200
Subject: [R-sig-Geo] mapView: basic interactive viewing of spatial data
 in R
In-Reply-To: <55B22F04.3080704@uni-muenster.de>
References: <55B207E2.9030408@gmail.com> <55B22F04.3080704@uni-muenster.de>
Message-ID: <55B23A42.2020204@gmail.com>

Edzer,
see my answers below.

On 24.07.2015 14:26, Edzer Pebesma wrote:
> Hi Tim, thanks for starting the discussion.
>
> I started a similar discussion (off-list, with package maintainers) for
> the case where google map or openstreetmap maps are used as background
> in map plots created in R, support for which is now scattered over
> ggmap::get_map, RgoogleMaps::GetMap, dismo::gmap and
> https://github.com/hadley/rastermap. (on r-forge, sp::plot and
> sp::spplot can now deal with these, see sp::demo(webmap)).

The idea behind mapView was not to be able to underly google imagery or 
other map layers as such. The motivation was to avoid the detour via the 
hard drive in order to get interactive viewing capabilities (either via 
saving and opening manually or automatically as in plotKml).
I have not tested rastermap or sp::webmap so far, so I don't know their 
exact capabilities.

> The (un)projection mapView does is towards epsg:4326 (longlat WGS84),
> leaflet assumes this and takes care of the projection to web mercator;
> the message printed in mapView (if verbose = TRUE) and your tutorial do
> the correct thing but suggest they convert to mercator.

It is true that mapView (un)projects to epsg:4326 for Spatial* objects. 
The rest is handled by the leaflet package.
For Raster* objects this is not so straight forward as the current 
leaflet implementation expects two things. From the entry for projection 
argument in the help of addRasterImage:

"if TRUE, automatically project x to the map projection expected by 
Leaflet (EPSG:3857); if FALSE, it's the caller's responsibility to 
ensure that x is already projected, and that extent(x) is expressed in 
WGS84 latitude/longitude coordinates"

which means that the layer needs to be in wgs84 web mercator, whereas 
the extent needs to be in epsg:4326 (longlat WGS84). Therefore this is 
all handled by leaflet at the moment. Giving the user a bit more control 
over this would be desirable in the future.

I included the "projecting to web mercator" message to make people aware 
of the fact that reprojection is done under hood by leaflet. In my 
opinion, this is one of the things that many people do not realise (e.g. 
many of our students) when loading data into classic GIS systems like 
ArcGIS or QGIS who also do on-the-fly reprojection but without telling 
the user. In the case of mapView where we usually simply want to inspect 
the data this is rather unimportant (that's why verbose is set to FALSE 
by default) but once you want to do calculations this becomes an issue. 
Given that calculations in R will be done using the designated packages 
(e.g. sp or raster) this is taken care of anyway.

>
> Some remaining questions:
> - package leaflet also supports plotting Spatial* and Raster* objects,
> what is exactly added by mapView?

leaflet is great for individual maps. MapView simply provides some 
resonable default behaviour for the most commonly used objects from the 
R spatial universe, e.g. automatic parsing of layer names, pop-up text, 
backgraound maps. Also it enables automatic addition to existing maps 
without the need to manually look up existing layer (group) names.

> - have you thought about integrating this functionality into the leaflet
> R package?

I have contacted Joe Cheng a couple of weeks ago about this, but have 
not heard back from him so far.

> - could we strive towards argument compatibility, so that we can get
> things done by simply changing "plot" or "spplot" into "leaflet"?

Compatibility would be very desirable! Up to now, my efforts into 
mapView were more of a proof-of-concept than a structured 
implementation. This is exactly why I wanted to make the spatial 
community aware of it, so we can together decide where to take this 
approach (ideally including the leaflet maintainers from RStudio). Ther 
are some additional things to consider here, for example the use of 
magrittr pipes implemented in leaflet...


At the end of the day, I think we all agree that interactive GIS-like 
functionality in native R would be a great thing to have. I do recall a 
suggestion by Barry Rowlingson (if I remember correctly) who stated that 
one day a call to library("gis") would be nice. Maybe mapView is merely 
another puzzle piece along these lines.

Tim

>
> On 07/24/2015 11:39 AM, Tim Appelhans wrote:
>> Dear list members,
>>
>> I would like to draw your attention to a little 'project' I've been
>> working on over the past few weeks.
>>
>> Using leaflet for R, I have defined some methods for spatial data (e.g.
>> Raster*, Spatial* objects) to quickly visualise them in either the
>> RStudio Viewer pan or the default web browser. The function I created
>> for this is called mapView().
>>
>> Think of it as an interactive version of spplot()/plot() for spatial
>> data (though less versatile). It enables zooming, paning and basic layer
>> queries (i.e. printing of the attributes in the @data slot of Spatial*
>> objects + the x/y location of the feature). For Raster* objects queries
>> are currently not available as leaflet translates the data into RGB
>> values for display. Furthermore, background maps can be defined and
>> multiple different spatial object layers can be overlaid.
>> At the moment mapView() lives in our Rsenal package on github
>> (https://github.com/environmentalinformatics-marburg/Rsenal) but this is
>> likely going to change at some point in the not too distant future. This
>> also depends on whether there is active interest in developping this
>> sort of thing further to provide more than the current admittedly rather
>> limited functionality. This, however, would involve JavaScript coding
>> which I do not have any experience with.
>>
>> A quick (non-interactive) intorduction can be found here:
>>
>> https://metvurst.wordpress.com/
>>
>> The full introductory article including interactive examples is
>> published here:
>>
>> http://environmentalinformatics-marburg.github.io/web-presentations/20150723_mapView.html
>>
>> I hope this may prove useful for some of you.
>> Also, if anyone is keen to get involved in taking this further, please
>> let me know and we will see how to best proceed.
>>
>> Best,
>> Tim
>>
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
#####################################
Tim Appelhans
Department of Geography
Environmental Informatics
Philipps Universit?t Marburg
Deutschhausstra?e 12
35032 Marburg (Paketpost: 35037 Marburg)
Germany

Tel +49 (0) 6421 28-25957

http://environmentalinformatics-marburg.de/


	[[alternative HTML version deleted]]


From pingyang.whu at gmail.com  Fri Jul 24 15:54:20 2015
From: pingyang.whu at gmail.com (ping yang)
Date: Fri, 24 Jul 2015 08:54:20 -0500
Subject: [R-sig-Geo] mapView: basic interactive viewing of spatial data
	in R
In-Reply-To: <55B207E2.9030408@gmail.com>
References: <55B207E2.9030408@gmail.com>
Message-ID: <CAK8gSG8prU1PNnhkeJr1656D_fw8ZJ30Vj=SVMLs8XGLg_uePA@mail.gmail.com>

Hi Tim,

I installed the packages with the hints (with devtools and leaflet library)
successfully, however, when I tried to run the code from
http://environmentalinformatics-marburg.github.io/web-presentations/20150723_mapView.html
I got issues:
First, the error came for
 meuse_rst <- stack(meuse.grid)
Error in nlayers(b) :
  error in evaluating the argument 'x' in selecting a method for function
'nlayers': Error in .newCRS(value) :
  4 arguments passed to .Internal(nchar) which requires 3

And I tried the the code with spatialPolygons:
data("DEU_adm2")
m <- mapView(gadm, burst = FALSE)
m

However, the map did not show up instead created a pdf file (with a link
inside), I need to copy this link into browser for viewing the map.

Any ideas?

Thanks,

Peter

On Fri, Jul 24, 2015 at 4:39 AM, Tim Appelhans <tim.appelhans at gmail.com>
wrote:

> Dear list members,
>
> I would like to draw your attention to a little 'project' I've been
> working on over the past few weeks.
>
> Using leaflet for R, I have defined some methods for spatial data (e.g.
> Raster*, Spatial* objects) to quickly visualise them in either the
> RStudio Viewer pan or the default web browser. The function I created
> for this is called mapView().
>
> Think of it as an interactive version of spplot()/plot() for spatial
> data (though less versatile). It enables zooming, paning and basic layer
> queries (i.e. printing of the attributes in the @data slot of Spatial*
> objects + the x/y location of the feature). For Raster* objects queries
> are currently not available as leaflet translates the data into RGB
> values for display. Furthermore, background maps can be defined and
> multiple different spatial object layers can be overlaid.
> At the moment mapView() lives in our Rsenal package on github
> (https://github.com/environmentalinformatics-marburg/Rsenal) but this is
> likely going to change at some point in the not too distant future. This
> also depends on whether there is active interest in developping this
> sort of thing further to provide more than the current admittedly rather
> limited functionality. This, however, would involve JavaScript coding
> which I do not have any experience with.
>
> A quick (non-interactive) intorduction can be found here:
>
> https://metvurst.wordpress.com/
>
> The full introductory article including interactive examples is
> published here:
>
>
> http://environmentalinformatics-marburg.github.io/web-presentations/20150723_mapView.html
>
> I hope this may prove useful for some of you.
> Also, if anyone is keen to get involved in taking this further, please
> let me know and we will see how to best proceed.
>
> Best,
> Tim
>
> --
> #####################################
> Tim Appelhans
> Department of Geography
> Environmental Informatics
> Philipps Universit?t Marburg
> Deutschhausstra?e 12
> 35032 Marburg (Paketpost: 35037 Marburg)
> Germany
>
> Tel +49 (0) 6421 28-25957
>
> http://environmentalinformatics-marburg.de/
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From tim.appelhans at gmail.com  Fri Jul 24 16:01:25 2015
From: tim.appelhans at gmail.com (Tim Appelhans)
Date: Fri, 24 Jul 2015 16:01:25 +0200
Subject: [R-sig-Geo] mapView: basic interactive viewing of spatial data
 in R
In-Reply-To: <CAK8gSG8prU1PNnhkeJr1656D_fw8ZJ30Vj=SVMLs8XGLg_uePA@mail.gmail.com>
References: <55B207E2.9030408@gmail.com>
	<CAK8gSG8prU1PNnhkeJr1656D_fw8ZJ30Vj=SVMLs8XGLg_uePA@mail.gmail.com>
Message-ID: <55B24535.6040205@gmail.com>

Peter,
can you please provide the output from sessionInfo() so we know which 
packages are available and what platform you are using?

Cheers
Tim

On 24.07.2015 15:54, ping yang wrote:
> Hi Tim,
>
> I installed the packages with the hints (with devtools and leaflet 
> library) successfully, however, when I tried to run the code from 
> http://environmentalinformatics-marburg.github.io/web-presentations/20150723_mapView.html 
> I got issues:
> First, the error came for
>  meuse_rst <- stack(meuse.grid)
> Error in nlayers(b) :
>   error in evaluating the argument 'x' in selecting a method for 
> function 'nlayers': Error in .newCRS(value) :
>   4 arguments passed to .Internal(nchar) which requires 3
>
> And I tried the the code with spatialPolygons:|
> data("DEU_adm2")
> m <- mapView(gadm, burst = FALSE)
> m
> |
> However, the map did not show up instead created a pdf file (with a 
> link inside), I need to copy this link into browser for viewing the map.
>
> Any ideas?
>
> Thanks,
>
> Peter
>
> On Fri, Jul 24, 2015 at 4:39 AM, Tim Appelhans 
> <tim.appelhans at gmail.com <mailto:tim.appelhans at gmail.com>> wrote:
>
>     Dear list members,
>
>     I would like to draw your attention to a little 'project' I've been
>     working on over the past few weeks.
>
>     Using leaflet for R, I have defined some methods for spatial data
>     (e.g.
>     Raster*, Spatial* objects) to quickly visualise them in either the
>     RStudio Viewer pan or the default web browser. The function I created
>     for this is called mapView().
>
>     Think of it as an interactive version of spplot()/plot() for spatial
>     data (though less versatile). It enables zooming, paning and basic
>     layer
>     queries (i.e. printing of the attributes in the @data slot of Spatial*
>     objects + the x/y location of the feature). For Raster* objects
>     queries
>     are currently not available as leaflet translates the data into RGB
>     values for display. Furthermore, background maps can be defined and
>     multiple different spatial object layers can be overlaid.
>     At the moment mapView() lives in our Rsenal package on github
>     (https://github.com/environmentalinformatics-marburg/Rsenal) but
>     this is
>     likely going to change at some point in the not too distant
>     future. This
>     also depends on whether there is active interest in developping this
>     sort of thing further to provide more than the current admittedly
>     rather
>     limited functionality. This, however, would involve JavaScript coding
>     which I do not have any experience with.
>
>     A quick (non-interactive) intorduction can be found here:
>
>     https://metvurst.wordpress.com/
>
>     The full introductory article including interactive examples is
>     published here:
>
>     http://environmentalinformatics-marburg.github.io/web-presentations/20150723_mapView.html
>
>     I hope this may prove useful for some of you.
>     Also, if anyone is keen to get involved in taking this further, please
>     let me know and we will see how to best proceed.
>
>     Best,
>     Tim
>
>     --
>     #####################################
>     Tim Appelhans
>     Department of Geography
>     Environmental Informatics
>     Philipps Universit?t Marburg
>     Deutschhausstra?e 12
>     35032 Marburg (Paketpost: 35037 Marburg)
>     Germany
>
>     Tel +49 (0) 6421 28-25957 <tel:%2B49%20%280%29%206421%2028-25957>
>
>     http://environmentalinformatics-marburg.de/
>
>
>             [[alternative HTML version deleted]]
>
>     _______________________________________________
>     R-sig-Geo mailing list
>     R-sig-Geo at r-project.org <mailto:R-sig-Geo at r-project.org>
>     https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>

-- 
#####################################
Tim Appelhans
Department of Geography
Environmental Informatics
Philipps Universit?t Marburg
Deutschhausstra?e 12
35032 Marburg (Paketpost: 35037 Marburg)
Germany

Tel +49 (0) 6421 28-25957

http://environmentalinformatics-marburg.de/


	[[alternative HTML version deleted]]


From bernd.vogelgesang at gmx.de  Fri Jul 24 16:37:39 2015
From: bernd.vogelgesang at gmx.de (Bernd Vogelgesang)
Date: Fri, 24 Jul 2015 16:37:39 +0200
Subject: [R-sig-Geo] mapView: basic interactive viewing of spatial data
 in R
In-Reply-To: <55B207E2.9030408@gmail.com>
References: <55B207E2.9030408@gmail.com>
Message-ID: <op.x19781z9l2i25i@bernd-terra-pc>

Hi Tim,
you mentioned that it is also possible to view the map in the default web  
browser.
So far I could not find out by myself how to accomplish this from RStudio.

Thank you
Bernd



Am 24.07.2015, 11:39 Uhr, schrieb Tim Appelhans <tim.appelhans at gmail.com>:

> Dear list members,
>
> I would like to draw your attention to a little 'project' I've been
> working on over the past few weeks.
>
> Using leaflet for R, I have defined some methods for spatial data (e.g.
> Raster*, Spatial* objects) to quickly visualise them in either the
> RStudio Viewer pan or the default web browser. The function I created
> for this is called mapView().
>
> Think of it as an interactive version of spplot()/plot() for spatial
> data (though less versatile). It enables zooming, paning and basic layer
> queries (i.e. printing of the attributes in the @data slot of Spatial*
> objects + the x/y location of the feature). For Raster* objects queries
> are currently not available as leaflet translates the data into RGB
> values for display. Furthermore, background maps can be defined and
> multiple different spatial object layers can be overlaid.
> At the moment mapView() lives in our Rsenal package on github
> (https://github.com/environmentalinformatics-marburg/Rsenal) but this is
> likely going to change at some point in the not too distant future. This
> also depends on whether there is active interest in developping this
> sort of thing further to provide more than the current admittedly rather
> limited functionality. This, however, would involve JavaScript coding
> which I do not have any experience with.
>
> A quick (non-interactive) intorduction can be found here:
>
> https://metvurst.wordpress.com/
>
> The full introductory article including interactive examples is
> published here:
>
> http://environmentalinformatics-marburg.github.io/web-presentations/20150723_mapView.html
>
> I hope this may prove useful for some of you.
> Also, if anyone is keen to get involved in taking this further, please
> let me know and we will see how to best proceed.
>
> Best,
> Tim
>


-- 
Bernd Vogelgesang
Siedlerstra?e 2
91083 Baiersdorf/Igelsdorf
Tel: 09133-825374


From mauricio.zambrano at ufrontera.cl  Fri Jul 24 16:52:18 2015
From: mauricio.zambrano at ufrontera.cl (MAURICIO ZAMBRANO BIGIARINI)
Date: Fri, 24 Jul 2015 11:52:18 -0300
Subject: [R-sig-Geo] mapView: basic interactive viewing of spatial data
	in R
In-Reply-To: <55B22F04.3080704@uni-muenster.de>
References: <55B207E2.9030408@gmail.com> <55B22F04.3080704@uni-muenster.de>
Message-ID: <CAP6VarvkCgWQVopxu0HX1cgbx2vUtc_zVgKq20W12238d8bcBg@mail.gmail.com>

On 24 July 2015 at 09:26, Edzer Pebesma <edzer.pebesma at uni-muenster.de> wrote:
> Hi Tim, thanks for starting the discussion.

Thanks Tim for this nice implementation and to all of you for this
very interesting discussion.

>
> I started a similar discussion (off-list, with package maintainers) for
> the case where google map or openstreetmap maps are used as background
> in map plots created in R, support for which is now scattered over
> ggmap::get_map, RgoogleMaps::GetMap, dismo::gmap and
> https://github.com/hadley/rastermap. (on r-forge, sp::plot and
> sp::spplot can now deal with these, see sp::demo(webmap)).

by the way Edzer, the sp::demo(webmap) din't work for me with  sp_1.1-1:

library(sp)
demo(meuse)    # working
demo(webmap) # not working

could you tell me what I'm doing wrong ?


Thanks in advance,

Mauricio Zambrano-Bigiarini, PhD

=====================================
Dept. of Civil Engineering
Faculty of Engineering and Sciences
Universidad de La Frontera
PO Box 54-D, Temuco, Chile
=====================================
mailto     : mauricio.zambrano at ufrontera.cl
work-phone : +56 45 259 2812
http://ingenieriacivil.ufro.cl/
=====================================
"When the pupil is ready, the master arrives."
(Zen proverb)
=====================================
Linux user #454569 -- Linux Mint use


From edzer.pebesma at uni-muenster.de  Fri Jul 24 17:20:34 2015
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 24 Jul 2015 17:20:34 +0200
Subject: [R-sig-Geo] mapView: basic interactive viewing of spatial data
 in R
In-Reply-To: <CAP6VarvkCgWQVopxu0HX1cgbx2vUtc_zVgKq20W12238d8bcBg@mail.gmail.com>
References: <55B207E2.9030408@gmail.com> <55B22F04.3080704@uni-muenster.de>
	<CAP6VarvkCgWQVopxu0HX1cgbx2vUtc_zVgKq20W12238d8bcBg@mail.gmail.com>
Message-ID: <55B257C2.80307@uni-muenster.de>



On 07/24/2015 04:52 PM, MAURICIO ZAMBRANO BIGIARINI wrote:
> On 24 July 2015 at 09:26, Edzer Pebesma <edzer.pebesma at uni-muenster.de> wrote:
>> Hi Tim, thanks for starting the discussion.
> 
> Thanks Tim for this nice implementation and to all of you for this
> very interesting discussion.
> 
>>
>> I started a similar discussion (off-list, with package maintainers) for
>> the case where google map or openstreetmap maps are used as background
>> in map plots created in R, support for which is now scattered over
>> ggmap::get_map, RgoogleMaps::GetMap, dismo::gmap and
>> https://github.com/hadley/rastermap. (on r-forge, sp::plot and
>> sp::spplot can now deal with these, see sp::demo(webmap)).
> 
> by the way Edzer, the sp::demo(webmap) din't work for me with  sp_1.1-1:
> 
> library(sp)
> demo(meuse)    # working
> demo(webmap) # not working
> 
> could you tell me what I'm doing wrong ?
> 

I mentioned "on r-forge, ..."

Install sp 1.1-2 (devel) from r-forge; see
https://r-forge.r-project.org/R/?group_id=1014

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi),  University of M?nster,
Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
Journal of Statistical Software:   http://www.jstatsoft.org/
Computers & Geosciences:   http://elsevier.com/locate/cageo/
Spatial Statistics Society http://www.spatialstatistics.info

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150724/0509e9b7/attachment.bin>

From Roger.Bivand at nhh.no  Fri Jul 24 17:23:37 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 24 Jul 2015 15:23:37 +0000
Subject: [R-sig-Geo] mapView: basic interactive viewing of spatial data
 in R
In-Reply-To: <55B23A42.2020204@gmail.com>
References: <55B207E2.9030408@gmail.com>
	<55B22F04.3080704@uni-muenster.de>,<55B23A42.2020204@gmail.com>
Message-ID: <E953A98FD6EAA7479A68EE8C24491F6B80C577BF@DALER.valuta.nhh.no>

Please also see my comments on a parallel issue in the leaflet github:

https://github.com/rstudio/leaflet/issues/139#issuecomment-124035792

Briefly, no automatic system can help if the input geometries (raster or vector) have an incomplete CRS, which is very often the case. Users need not only a warning, but first to be told that their input CRS is probably incomplete, where to look for help, and then more help if the input CRS was complete but was wrong (or the Eastings and Northings were reversed in the input data. There is no easy way to do this, and indeed fundamental parts of our infrastructure for handling CRS, like the PROJ.4 library (bug corrections), datum grid versions, and the copy of the EPSG CRS definitions used do all change over time. Arguably, automatic projection or reprojection should be treated with sufficient caution unless all data acquisition is strictly managed (as it would/should be in a large professional organization employing its own surveyors or contracting photogrametric and surveying services). If position matters, it is worth taking the time to find an appropriate CRS, or we all end up at sea without an anchor.

Roger

--
Roger Bivand
Norwegian School of Economics
Helleveien 30, 5045 Bergen, Norway
Roger.Bivand at nhh.no


________________________________________
Fra: R-sig-Geo [r-sig-geo-bounces at r-project.org] p&#229; vegne av Tim Appelhans [tim.appelhans at gmail.com]
Sendt: 24. juli 2015 3:14
Til: r-sig-geo at r-project.org
Emne: Re: [R-sig-Geo] mapView: basic interactive viewing of spatial data in R

Edzer,
see my answers below.

On 24.07.2015 14:26, Edzer Pebesma wrote:
> Hi Tim, thanks for starting the discussion.
>
> I started a similar discussion (off-list, with package maintainers) for
> the case where google map or openstreetmap maps are used as background
> in map plots created in R, support for which is now scattered over
> ggmap::get_map, RgoogleMaps::GetMap, dismo::gmap and
> https://github.com/hadley/rastermap. (on r-forge, sp::plot and
> sp::spplot can now deal with these, see sp::demo(webmap)).

The idea behind mapView was not to be able to underly google imagery or
other map layers as such. The motivation was to avoid the detour via the
hard drive in order to get interactive viewing capabilities (either via
saving and opening manually or automatically as in plotKml).
I have not tested rastermap or sp::webmap so far, so I don't know their
exact capabilities.

> The (un)projection mapView does is towards epsg:4326 (longlat WGS84),
> leaflet assumes this and takes care of the projection to web mercator;
> the message printed in mapView (if verbose = TRUE) and your tutorial do
> the correct thing but suggest they convert to mercator.

It is true that mapView (un)projects to epsg:4326 for Spatial* objects.
The rest is handled by the leaflet package.
For Raster* objects this is not so straight forward as the current
leaflet implementation expects two things. From the entry for projection
argument in the help of addRasterImage:

"if TRUE, automatically project x to the map projection expected by
Leaflet (EPSG:3857); if FALSE, it's the caller's responsibility to
ensure that x is already projected, and that extent(x) is expressed in
WGS84 latitude/longitude coordinates"

which means that the layer needs to be in wgs84 web mercator, whereas
the extent needs to be in epsg:4326 (longlat WGS84). Therefore this is
all handled by leaflet at the moment. Giving the user a bit more control
over this would be desirable in the future.

I included the "projecting to web mercator" message to make people aware
of the fact that reprojection is done under hood by leaflet. In my
opinion, this is one of the things that many people do not realise (e.g.
many of our students) when loading data into classic GIS systems like
ArcGIS or QGIS who also do on-the-fly reprojection but without telling
the user. In the case of mapView where we usually simply want to inspect
the data this is rather unimportant (that's why verbose is set to FALSE
by default) but once you want to do calculations this becomes an issue.
Given that calculations in R will be done using the designated packages
(e.g. sp or raster) this is taken care of anyway.

>
> Some remaining questions:
> - package leaflet also supports plotting Spatial* and Raster* objects,
> what is exactly added by mapView?

leaflet is great for individual maps. MapView simply provides some
resonable default behaviour for the most commonly used objects from the
R spatial universe, e.g. automatic parsing of layer names, pop-up text,
backgraound maps. Also it enables automatic addition to existing maps
without the need to manually look up existing layer (group) names.

> - have you thought about integrating this functionality into the leaflet
> R package?

I have contacted Joe Cheng a couple of weeks ago about this, but have
not heard back from him so far.

> - could we strive towards argument compatibility, so that we can get
> things done by simply changing "plot" or "spplot" into "leaflet"?

Compatibility would be very desirable! Up to now, my efforts into
mapView were more of a proof-of-concept than a structured
implementation. This is exactly why I wanted to make the spatial
community aware of it, so we can together decide where to take this
approach (ideally including the leaflet maintainers from RStudio). Ther
are some additional things to consider here, for example the use of
magrittr pipes implemented in leaflet...


At the end of the day, I think we all agree that interactive GIS-like
functionality in native R would be a great thing to have. I do recall a
suggestion by Barry Rowlingson (if I remember correctly) who stated that
one day a call to library("gis") would be nice. Maybe mapView is merely
another puzzle piece along these lines.

Tim

>
> On 07/24/2015 11:39 AM, Tim Appelhans wrote:
>> Dear list members,
>>
>> I would like to draw your attention to a little 'project' I've been
>> working on over the past few weeks.
>>
>> Using leaflet for R, I have defined some methods for spatial data (e.g.
>> Raster*, Spatial* objects) to quickly visualise them in either the
>> RStudio Viewer pan or the default web browser. The function I created
>> for this is called mapView().
>>
>> Think of it as an interactive version of spplot()/plot() for spatial
>> data (though less versatile). It enables zooming, paning and basic layer
>> queries (i.e. printing of the attributes in the @data slot of Spatial*
>> objects + the x/y location of the feature). For Raster* objects queries
>> are currently not available as leaflet translates the data into RGB
>> values for display. Furthermore, background maps can be defined and
>> multiple different spatial object layers can be overlaid.
>> At the moment mapView() lives in our Rsenal package on github
>> (https://github.com/environmentalinformatics-marburg/Rsenal) but this is
>> likely going to change at some point in the not too distant future. This
>> also depends on whether there is active interest in developping this
>> sort of thing further to provide more than the current admittedly rather
>> limited functionality. This, however, would involve JavaScript coding
>> which I do not have any experience with.
>>
>> A quick (non-interactive) intorduction can be found here:
>>
>> https://metvurst.wordpress.com/
>>
>> The full introductory article including interactive examples is
>> published here:
>>
>> http://environmentalinformatics-marburg.github.io/web-presentations/20150723_mapView.html
>>
>> I hope this may prove useful for some of you.
>> Also, if anyone is keen to get involved in taking this further, please
>> let me know and we will see how to best proceed.
>>
>> Best,
>> Tim
>>
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

--
#####################################
Tim Appelhans
Department of Geography
Environmental Informatics
Philipps Universit?t Marburg
Deutschhausstra?e 12
35032 Marburg (Paketpost: 35037 Marburg)
Germany

Tel +49 (0) 6421 28-25957

http://environmentalinformatics-marburg.de/


        [[alternative HTML version deleted]]


From tim.appelhans at gmail.com  Fri Jul 24 18:16:58 2015
From: tim.appelhans at gmail.com (Tim Appelhans)
Date: Fri, 24 Jul 2015 18:16:58 +0200
Subject: [R-sig-Geo] mapView: basic interactive viewing of spatial data
 in R
In-Reply-To: <op.x19781z9l2i25i@bernd-terra-pc>
References: <55B207E2.9030408@gmail.com> <op.x19781z9l2i25i@bernd-terra-pc>
Message-ID: <55B264FA.3090005@gmail.com>

Bernd,
in RStudio there is a little button on top of the viewer that will open 
the current content in the default browser. I do not know how to tell 
RStudio to use the browser by default.

HTH
Tim

On 24.07.2015 16:37, Bernd Vogelgesang wrote:
> Hi Tim,
> you mentioned that it is also possible to view the map in the default 
> web browser.
> So far I could not find out by myself how to accomplish this from 
> RStudio.
>
> Thank you
> Bernd
>
>
>
> Am 24.07.2015, 11:39 Uhr, schrieb Tim Appelhans 
> <tim.appelhans at gmail.com>:
>
>> Dear list members,
>>
>> I would like to draw your attention to a little 'project' I've been
>> working on over the past few weeks.
>>
>> Using leaflet for R, I have defined some methods for spatial data (e.g.
>> Raster*, Spatial* objects) to quickly visualise them in either the
>> RStudio Viewer pan or the default web browser. The function I created
>> for this is called mapView().
>>
>> Think of it as an interactive version of spplot()/plot() for spatial
>> data (though less versatile). It enables zooming, paning and basic layer
>> queries (i.e. printing of the attributes in the @data slot of Spatial*
>> objects + the x/y location of the feature). For Raster* objects queries
>> are currently not available as leaflet translates the data into RGB
>> values for display. Furthermore, background maps can be defined and
>> multiple different spatial object layers can be overlaid.
>> At the moment mapView() lives in our Rsenal package on github
>> (https://github.com/environmentalinformatics-marburg/Rsenal) but this is
>> likely going to change at some point in the not too distant future. This
>> also depends on whether there is active interest in developping this
>> sort of thing further to provide more than the current admittedly rather
>> limited functionality. This, however, would involve JavaScript coding
>> which I do not have any experience with.
>>
>> A quick (non-interactive) intorduction can be found here:
>>
>> https://metvurst.wordpress.com/
>>
>> The full introductory article including interactive examples is
>> published here:
>>
>> http://environmentalinformatics-marburg.github.io/web-presentations/20150723_mapView.html 
>>
>>
>> I hope this may prove useful for some of you.
>> Also, if anyone is keen to get involved in taking this further, please
>> let me know and we will see how to best proceed.
>>
>> Best,
>> Tim
>>
>
>

-- 
#####################################
Tim Appelhans
Department of Geography
Environmental Informatics
Philipps Universit?t Marburg
Deutschhausstra?e 12
35032 Marburg (Paketpost: 35037 Marburg)
Germany

Tel +49 (0) 6421 28-25957

http://environmentalinformatics-marburg.de/


From hc10024 at gmail.com  Fri Jul 24 19:40:03 2015
From: hc10024 at gmail.com (Helen Chen)
Date: Fri, 24 Jul 2015 10:40:03 -0700
Subject: [R-sig-Geo] spBayes package spLM function
In-Reply-To: <CAM_vju=Nd-v1tCNa5MS0S9vj4=gdnQpbbdH+BTCKJPKWOD=5mg@mail.gmail.com>
References: <CAKjCKvEzXE3eHHZXpC3PcE2NqbDPrQhrF8bR4_jeUWK013ed3Q@mail.gmail.com>
	<CAM_vju=Nd-v1tCNa5MS0S9vj4=gdnQpbbdH+BTCKJPKWOD=5mg@mail.gmail.com>
Message-ID: <CAKjCKvHvh--Yhv9Tn9bSv9W+Y8Yf9a393xPB5MkFv2-rzWhyTg@mail.gmail.com>

Thanks for your help. I solve that problem.

I have another issue in the same function

I ran another chunks of code as following in order to predict

## Extract the coordinates of the BEF bounding polygon vertices and use the
pointsInPoly (spBayes) function to obtain the desired subset of the
prediction design matrix and associated prediction coordinates (i.e., pixel
centroids).
pred.coords <- SpatialPoints(BEF.grids)@coords
pred.covars <- pred.covars[pointsInPolyOut,]
pointsInPolyOut <- pointsInPoly(BEF.poly, pred.coords)
pred.covars <- p[pointsInPolyOut,]

#convert spdf to matrix
DF <- as.matrix(pred.covars at data)

pred.coords <- pred.coords[pointsInPolyOut,]

bef.bio.pred <- spPredict(bef.sp, start=burn.in, thin=2,
pred.coords=pred.coords, pred.covars=DF)

I got another error message:

 bef.bio.pred <- spPredict(bef.sp, start=burn.in, thin=2,
pred.coords=pred.coords, pred.covars=DF)
Error in spPredict(bef.sp, start = burn.in, thin = 2, pred.coords =
pred.coords,  :
  error: pred.covars must have  2  columns

My "DF" looks like this:

row.names band1
1 2342 573.4432
2 2343 572.7695
3 2344 572.9942
4 2345 574.6914
5 2346 575.8411
6 2347 577.7388
7 2348 579.3783
8 2349 581.7493
9 2350 583.5519
10 12607 574.7918
11 12608 573.9687
12 12609 573.6502
13 12610 575.8325
14 12611 576.9496
15 12612 578.4088
16 12613 580.6917
17 12614 582.3503
18 12615 583.6110
19 22872 575.9836
20 22873 574.9182
21 22874 574.4495
22 22875 576.1238
23 22876 577.8916
24 22877 579.7219
25 22878 581.2625
26 22879 582.9403
27 22880 584.3701
28 33124 569.6010
29 33125 572.2399

Could anyone help me to figure out? Thanks for all your help.

Best,

Helen

On Thu, Jul 23, 2015 at 3:16 PM, Sarah Goslee <sarah.goslee at gmail.com>
wrote:

> Are you sure that cook is a matrix and not a data frame?
>
> What are the outputs of:
>
> dim(cook)
> is.matrix(cook)
> str(cook)
>
> Sarah
>
> On Thu, Jul 23, 2015 at 6:12 PM, Helen Chen <hc10024 at gmail.com> wrote:
> > Hi,
> >
> > I have tried to implement the spLM function from spBayes package to my
> data
> > (rainfall value, elevation, coordinates).
> >
> > However, the error message shows up when I run this chunk of codes:
> >
> > bef.sp <- spLM(S3~elv,
> > + data=A, coords=cook, starting=list("phi"=3/200,"sigma.sq"=0.08,
> > + "tau.sq"=0.02), tuning=list("phi"=0.1, "sigma.sq"=0.05, "tau.sq"=0.05),
> > +                priors=list("phi.Unif"=c(3/1500, 3/50),
> "sigma.sq.IG"=c(2,
> > 0.08),"tau.sq.IG"=c(2, 0.02)), cov.model="spherical",n.samples=n.samples)
> >
> > the error message is
> >
> > Error in spLM(S3 ~ elv, data = A, coords = cook, starting = list(phi =
> > 3/200,  :
> >   error: coords must n-by-2 matrix of xy-coordinate locations
> >
> > I am sure that my coordinates is a 29 by 2 matrix, but it also tells me
> > this error message.
> >
> > Could anyone help me to figure out. Thanks for all your help.
> >
> >
> >
> > Helen
> >
>
> --
> Sarah Goslee
> http://www.functionaldiversity.org
>

	[[alternative HTML version deleted]]


From karljarvis at gmail.com  Fri Jul 24 23:04:14 2015
From: karljarvis at gmail.com (Karl Jarvis)
Date: Fri, 24 Jul 2015 15:04:14 -0600
Subject: [R-sig-Geo] Split polygon by line
In-Reply-To: <mailman.13.1437732004.30823.r-sig-geo@r-project.org>
References: <mailman.13.1437732004.30823.r-sig-geo@r-project.org>
Message-ID: <55B2A84E.8010803@gmail.com>

Jill Deines was kind enough to track down and adapt an answer for me 
from a similar question from here:
http://stackoverflow.com/questions/5726297/cut-polygons-using-contour-line-beneath-the-polygon-layers


pol = 
SpatialPolygons(list(Polygons(list(Polygon(cbind(c(0,1,1,0,0),c(0,0,1,1,0)))), 
ID="polygon")))
line = SpatialLines(list(Lines(list(Line(cbind(c(0,1),c(0.5,0.5)))), 
ID="line")))

lpi <- gIntersection(pol, line)               # intersect your line with 
the polygon
blpi <- gBuffer(lpi, width = 0.000001)  # create a very thin polygon 
buffer of the intersected line
dpi <- gDifference(pol, blpi)                # split using gDifference

plot(dpi)

# color by polygon
plot(pol)
plot(SpatialPolygons(list(Polygons(list(dpi at polygons[[1]]@Polygons[[1]]), "1"))), 

       add=T, col = "lightblue")
plot(SpatialPolygons(list(Polygons(list(dpi at polygons[[1]]@Polygons[[2]]), "2"))), 

      add = TRUE, col = "lightgreen")


From roman.lustrik at gmail.com  Sat Jul 25 08:04:55 2015
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Sat, 25 Jul 2015 08:04:55 +0200
Subject: [R-sig-Geo] Spplot error in change value color
In-Reply-To: <CAAgsrZjfxygd0RL=8YtU1Pr=pJp9veeGac+6DH-wR9Ud00euTg@mail.gmail.com>
References: <CAAgsrZjfxygd0RL=8YtU1Pr=pJp9veeGac+6DH-wR9Ud00euTg@mail.gmail.com>
Message-ID: <CAHT1vpi4NXstd1Dqp4CcTvaOoXzn5vq5PHNrU2LicSL93yQrDw@mail.gmail.com>

I noticed you have a typo, you are specifying `cuts` to the colorkey,
whereas you create a `custs` object.

Cheers,
Roman


On Fri, Jul 24, 2015 at 2:49 PM, pierluigi de rosa <
pierluigi.derosa at gmail.com> wrote:

> Dear all,
>
> I have a simple question.
> I'm managing a SpatialPointsDataFrame with 12 columns
>
> I'm able to plot it
> this works:
> > spplot(punti_eventi_siccita,zcol=6)  #only 6 column
>
> I want to set value where change color
> > custs=seq(20,250,50)
> If I run this:
>
> > spplot(punti_eventi_siccita,zcol=6,
> colorkey=list(labels=list(at=cuts),at=cuts))
> I have:
> Error in legend[[i]]$fun : $ operator is invalid for atomic vectors
>
> where I'm wrong?
> I fund several example on internet and on several books but the code I
> wrote above should work
>
> Many thanks
> Pierluigi
>
>
> --
> Ing. Pierluigi De Rosa (PhD)
> cel: 3497558268 / fax: 075 7823038
> skype: pierluigi.derosa
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
In God we trust, all others bring data.

	[[alternative HTML version deleted]]


From zenlines at gmail.com  Sat Jul 25 15:23:50 2015
From: zenlines at gmail.com (Brian)
Date: Sat, 25 Jul 2015 15:23:50 +0200
Subject: [R-sig-Geo] use_ob_tran in projectRaster?
In-Reply-To: <mailman.9.1437818403.17944.r-sig-geo@r-project.org>
References: <mailman.9.1437818403.17944.r-sig-geo@r-project.org>
Message-ID: <55B38DE6.4040402@gmail.com>

Dear Robert, dear list,

when using a rotated pole in rgdal::spTransform, I can set
use_ob_tran=TRUE to perform an oblique transformation (whatever that
means :)).  I'm missing this functionality in projectRaster.  I expect
this option will being useful with increasing use of R and the package
raster (great package!) for netcdf data,  which is very common in the
climate/meteorological modeling, who often use a rotated pole.

May I ask for this option to be included in the next version?

Many thanks again!

Cheers,
Brian


From Roger.Bivand at nhh.no  Sun Jul 26 17:31:02 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sun, 26 Jul 2015 17:31:02 +0200
Subject: [R-sig-Geo] Positing a coord_proj for ggplot2
In-Reply-To: <CAJ4QxaNZh=sqtuT-8JpaEjjUxO16wc2fJn6Pd-BdmGLcsxpvjg@mail.gmail.com>
References: <CAJ4QxaNZh=sqtuT-8JpaEjjUxO16wc2fJn6Pd-BdmGLcsxpvjg@mail.gmail.com>
Message-ID: <alpine.LFD.2.20.1507261702410.27395@reclus.nhh.no>

On Fri, 24 Jul 2015, boB Rudis wrote:

> Hey folks
>
> Having finally gotten tired of performing coordinate conversions to
> Winkel-Tripel (and other) projections prior to passing map data to
> ggplot2 (coord_map projection support is limited to what mapproject
> supports and that's pretty scant) I was toying with a coord_proj
> coordinate system for ggplot2 the other day and came up with this:
> https://gist.github.com/hrbrmstr/363e33f74e2972c93ca7 (visual:
> http://rpubs.com/hrbrmstr/coord-proj).
>
> coord_proj uses proj4::project, so it supports any proj4string.

Please use proj4::ptransform to add support for datum transformations, 
which are often needed. Also note that the help page for the function is 
probably incorrect, as the default +ellps= in PROJ.4 if given is WGS84.

>
> This won't be in ggplot2 right now as Hadley is updating/refactoring
> the package and "coords" are going to work a bit differently. Plus
> this adds a dependency I'm not sure he wants to add to it. You can
> stick it in your own, local copy of ggplot2 and re-collate and rebuild
> to use it.
>
> proj4::project (and even spTransform, to a certain degree - no pun
> intended) are unhappy dealing with lat/lon values outside the -90/90 :
> -180:180 range and even have some issues with points right at the
> extremes, so I did the following in the linked code:
>
> df$x <- ifelse(df$x <= -180, -179.999999999, df$x)
> df$x <- ifelse(df$x >= 180, 179.999999999, df$x)
> df$y <- ifelse(df$y <= -90, -89.999999999, df$y)
> df$y <- ifelse(df$y >= 90, 89.999999999, df$y)

This may well be unsafe, as 0 - 360 is also valid for longitudes, and in 
many cases -180 - 360 will also be feasible. The test in sp is in 
sp:::.ll_sanity() which uses an internal tolerance (which may be set) to 
do similar checks.

Roger



>
> It was a quick hack to just get coord_proj up and running and I know
> it's a horrible one, but I'm looking for guidance/feedback/etc on what
> I _should_ do here since I will be maintaining some version of this
> moving forward (it's just too convenient for me not to and the new
> "coords" may be as extensible as the forthcoming change to "geoms", so
> this could be in a package all itself or added to another R geo
> package).
>
> thx,
>
> -Bob
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From simone.ruzza12 at gmail.com  Mon Jul 27 03:43:17 2015
From: simone.ruzza12 at gmail.com (Simone Ruzza)
Date: Mon, 27 Jul 2015 03:43:17 +0200
Subject: [R-sig-Geo] query regarding gwr.gauss from the spgwr library
Message-ID: <CADZVqoZZRTnLno7io3mu5y-43dXvtfq20Kd5fdTN0NTfZdW+tQ@mail.gmail.com>

Dear list,

apologies for the total beginner's question. I would like to use
gwr.gauss function to calculate weights "manually" without resorting
to ggwr.sel.   I have seen the example from the spgwr manual:

plot(seq(-10,10,0.1), gwr.Gauss(seq(-10,10,0.1)^2, 3.5), type="l")

I was wondering if anyone knows of an example with a real dataset
(e.g. the columbus dataset that comes with the package). I understand
that this function is a key step in ggwr.sel, but, when looking into
ggwr.sel, I could not work out how it calculates the vector of squared
distances between observations and fit point for the dataset provided
in the package.

thanks in advance for your help,

Simone


From h.wickham at gmail.com  Tue Jul 28 18:22:37 2015
From: h.wickham at gmail.com (Hadley Wickham)
Date: Tue, 28 Jul 2015 11:22:37 -0500
Subject: [R-sig-Geo] Positing a coord_proj for ggplot2
In-Reply-To: <alpine.LFD.2.20.1507261702410.27395@reclus.nhh.no>
References: <CAJ4QxaNZh=sqtuT-8JpaEjjUxO16wc2fJn6Pd-BdmGLcsxpvjg@mail.gmail.com>
	<alpine.LFD.2.20.1507261702410.27395@reclus.nhh.no>
Message-ID: <CABdHhvH7j0zi1v_PkML2+Tiw_VOZaBxS0O6J=LgHw3=pTTva7A@mail.gmail.com>

>> This won't be in ggplot2 right now as Hadley is updating/refactoring
>> the package and "coords" are going to work a bit differently. Plus
>> this adds a dependency I'm not sure he wants to add to it. You can
>> stick it in your own, local copy of ggplot2 and re-collate and rebuild
>> to use it.
>>
>> proj4::project (and even spTransform, to a certain degree - no pun
>> intended) are unhappy dealing with lat/lon values outside the -90/90 :
>> -180:180 range and even have some issues with points right at the
>> extremes, so I did the following in the linked code:
>>
>> df$x <- ifelse(df$x <= -180, -179.999999999, df$x)
>> df$x <- ifelse(df$x >= 180, 179.999999999, df$x)
>> df$y <- ifelse(df$y <= -90, -89.999999999, df$y)
>> df$y <- ifelse(df$y >= 90, 89.999999999, df$y)
>
>
> This may well be unsafe, as 0 - 360 is also valid for longitudes, and in
> many cases -180 - 360 will also be feasible. The test in sp is in
> sp:::.ll_sanity() which uses an internal tolerance (which may be set) to do
> similar checks.

Is there a function to do this the "right" way? i.e. cut the
antimeridian after rotation?

Hadley

-- 
http://had.co.nz/


From Roger.Bivand at nhh.no  Tue Jul 28 21:36:26 2015
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 28 Jul 2015 21:36:26 +0200
Subject: [R-sig-Geo] Positing a coord_proj for ggplot2
In-Reply-To: <CABdHhvH7j0zi1v_PkML2+Tiw_VOZaBxS0O6J=LgHw3=pTTva7A@mail.gmail.com>
References: <CAJ4QxaNZh=sqtuT-8JpaEjjUxO16wc2fJn6Pd-BdmGLcsxpvjg@mail.gmail.com>
	<alpine.LFD.2.20.1507261702410.27395@reclus.nhh.no>
	<CABdHhvH7j0zi1v_PkML2+Tiw_VOZaBxS0O6J=LgHw3=pTTva7A@mail.gmail.com>
Message-ID: <alpine.LFD.2.20.1507282129040.11111@reclus.nhh.no>

On Tue, 28 Jul 2015, Hadley Wickham wrote:

>>> This won't be in ggplot2 right now as Hadley is updating/refactoring
>>> the package and "coords" are going to work a bit differently. Plus
>>> this adds a dependency I'm not sure he wants to add to it. You can
>>> stick it in your own, local copy of ggplot2 and re-collate and rebuild
>>> to use it.
>>>
>>> proj4::project (and even spTransform, to a certain degree - no pun
>>> intended) are unhappy dealing with lat/lon values outside the -90/90 :
>>> -180:180 range and even have some issues with points right at the
>>> extremes, so I did the following in the linked code:
>>>
>>> df$x <- ifelse(df$x <= -180, -179.999999999, df$x)
>>> df$x <- ifelse(df$x >= 180, 179.999999999, df$x)
>>> df$y <- ifelse(df$y <= -90, -89.999999999, df$y)
>>> df$y <- ifelse(df$y >= 90, 89.999999999, df$y)
>>
>>
>> This may well be unsafe, as 0 - 360 is also valid for longitudes, and in
>> many cases -180 - 360 will also be feasible. The test in sp is in
>> sp:::.ll_sanity() which uses an internal tolerance (which may be set) to do
>> similar checks.
>
> Is there a function to do this the "right" way? i.e. cut the
> antimeridian after rotation?

Not really, because the changes made are most often heuristics based on 
use cases for places near the antimeridian needing planar plotting. The 
"cleanest" solution is probably to determine either 0 to 360 or -180 to 
180 for a given prime meridian, and fold back anything out of domain, so 
that it can always be displayed on a sphere. -2 or 26 hours is similar in 
relation to daily time (really 2200 the day before or 0200 the day after).

A question on the proj-devel list would probably elicit a principled 
response; I think for example that New Zealand cartographers have a lot of 
experience that many others (US, Europe) do not have.

Roger

>
> Hadley
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 91 00
e-mail: Roger.Bivand at nhh.no


From Scott.Waichler at pnnl.gov  Tue Jul 28 22:55:01 2015
From: Scott.Waichler at pnnl.gov (Waichler, Scott R)
Date: Tue, 28 Jul 2015 20:55:01 +0000
Subject: [R-sig-Geo] Problem installing rgeos
Message-ID: <074C83DAD4825242A20B2D83FDBCB8881A059BD0@EX10MBOX03.pnnl.gov>

Hi,

I'm trying to install rgeos and I don't know how to respond to the error message:  "configure: error: cannot run C compiled programs"

> install.packages("rgeos", dependencies = "Depends", repos = "http://cran.fhcrc.org/")
trying URL 'http://cran.fhcrc.org/src/contrib/rgeos_0.3-11.tar.gz'
Content type 'application/x-gzip' length 247152 bytes (241 KB)
==================================================
downloaded 241 KB

* installing *source* package ?rgeos? ...
** package ?rgeos? successfully unpacked and MD5 sums checked
configure: CC: gcc -std=gnu99
configure: CXX: g++
configure: rgeos: 0.3-8
checking for /usr/bin/svnversion... yes
configure: svn revision: 479
checking for geos-config... /usr/local/bin/geos-config
checking geos-config usability... yes
configure: GEOS version: 3.4.2
checking geos version at least 3.2.0... yes
checking geos-config clibs... yes
checking for gcc... gcc -std=gnu99
checking whether the C compiler works... yes
checking for C compiler default output file name... a.out
checking for suffix of executables...
checking whether we are cross compiling... configure: error: in `/tmp/RtmpFSN1i4/R.INSTALL25f63e6c5cb4/rgeos':
configure: error: cannot run C compiled programs.
If you meant to cross compile, use `--host'.
See `config.log' for more details
ERROR: configuration failed for package ?rgeos?
* removing ?/files3/R/R-3.2.1_install/lib64/R/library/rgeos?

The downloaded source packages are in
        ?/tmp/RtmpceXyoL/downloaded_packages?
Updating HTML index of packages in '.Library'
Making 'packages.html' ... done
Warning message:
In install.packages("rgeos", dependencies = "Depends", repos = "http://cran.fhcrc.org/") :
  installation of package ?rgeos? had non-zero exit status

Thanks,
Scott Waichler
Hydrology Group
Pacific Northwest National Laboratory
Richland, WA, USA


From mdsumner at gmail.com  Wed Jul 29 05:52:18 2015
From: mdsumner at gmail.com (Michael Sumner)
Date: Wed, 29 Jul 2015 03:52:18 +0000
Subject: [R-sig-Geo] Positing a coord_proj for ggplot2
In-Reply-To: <alpine.LFD.2.20.1507282129040.11111@reclus.nhh.no>
References: <CAJ4QxaNZh=sqtuT-8JpaEjjUxO16wc2fJn6Pd-BdmGLcsxpvjg@mail.gmail.com>
	<alpine.LFD.2.20.1507261702410.27395@reclus.nhh.no>
	<CABdHhvH7j0zi1v_PkML2+Tiw_VOZaBxS0O6J=LgHw3=pTTva7A@mail.gmail.com>
	<alpine.LFD.2.20.1507282129040.11111@reclus.nhh.no>
Message-ID: <CAAcGz9-NCx3gex=FtGdexbHZNUcZBa2hwO6TPQcf7fzf9AyBAQ@mail.gmail.com>

On Wed, 29 Jul 2015 at 05:38 Roger Bivand <Roger.Bivand at nhh.no> wrote:

> On Tue, 28 Jul 2015, Hadley Wickham wrote:
>
> >>> This won't be in ggplot2 right now as Hadley is updating/refactoring
> >>> the package and "coords" are going to work a bit differently. Plus
> >>> this adds a dependency I'm not sure he wants to add to it. You can
> >>> stick it in your own, local copy of ggplot2 and re-collate and rebuild
> >>> to use it.
> >>>
> >>> proj4::project (and even spTransform, to a certain degree - no pun
> >>> intended) are unhappy dealing with lat/lon values outside the -90/90 :
> >>> -180:180 range and even have some issues with points right at the
> >>> extremes, so I did the following in the linked code:
> >>>
> >>> df$x <- ifelse(df$x <= -180, -179.999999999, df$x)
> >>> df$x <- ifelse(df$x >= 180, 179.999999999, df$x)
> >>> df$y <- ifelse(df$y <= -90, -89.999999999, df$y)
> >>> df$y <- ifelse(df$y >= 90, 89.999999999, df$y)
> >>
> >>
> >> This may well be unsafe, as 0 - 360 is also valid for longitudes, and in
> >> many cases -180 - 360 will also be feasible. The test in sp is in
> >> sp:::.ll_sanity() which uses an internal tolerance (which may be set)
> to do
> >> similar checks.
> >
> > Is there a function to do this the "right" way? i.e. cut the
> > antimeridian after rotation?
>
> Not really, because the changes made are most often heuristics based on
> use cases for places near the antimeridian needing planar plotting. The
> "cleanest" solution is probably to determine either 0 to 360 or -180 to
> 180 for a given prime meridian, and fold back anything out of domain, so
> that it can always be displayed on a sphere. -2 or 26 hours is similar in
> relation to daily time (really 2200 the day before or 0200 the day after).
>
>
A question on the proj-devel list would probably elicit a principled
> response; I think for example that New Zealand cartographers have a lot of
> experience that many others (US, Europe) do not have.
>
>
And Antarcticians. It's surprising how much of a pain this is in many
different ways. The authoritative solution is by Mike Bostock of course.
http://bost.ocks.org/mike/example/

I would have thought the RStudio clan was all over this with a javascript
future?  GIS just doesn't traditionally give this sort of flexibility.

Cheers, Mike.


> Roger
>
> >
> > Hadley
> >
> >
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 91 00
> e-mail: Roger.Bivand at nhh.no
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From englishchristophera at gmail.com  Wed Jul 29 10:03:19 2015
From: englishchristophera at gmail.com (chris english)
Date: Wed, 29 Jul 2015 04:03:19 -0400
Subject: [R-sig-Geo] Problem installing rgeos
In-Reply-To: <074C83DAD4825242A20B2D83FDBCB8881A059BD0@EX10MBOX03.pnnl.gov>
References: <074C83DAD4825242A20B2D83FDBCB8881A059BD0@EX10MBOX03.pnnl.gov>
Message-ID: <CAASFQpTnRRbN=XbaitBP3xCZxYhhm=VGBoH+xzKQaBeLxFbazw@mail.gmail.com>

Scott,

You're build is failing pretty early in the configuration process which
suggests you are missing some tools in your development environment.  The
latest geos was found. Was that a binary or built from source?  If from
source you have the necessary tools in your dev environment and it may
merely be a function of dropping the depends in you install.packages
call....

This just now on my box:

sessionInfo()
R version 3.2.1 (2015-06-18)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 14.04.2 LTS

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
 [9] LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] cluster_2.0.3   TraMineR_1.8-10

loaded via a namespace (and not attached):
[1] tools_3.2.1        RColorBrewer_1.1-2 boot_1.3-17
> install.packages("rgeos")
Installing package into ?/usr/local/lib/R/site-library?
(as ?lib? is unspecified)
--- Please select a CRAN mirror for use in this session ---
trying URL 'http://cran.cnr.Berkeley.edu/src/contrib/rgeos_0.3-11.tar.gz'
Content type 'application/x-gzip' length 247152 bytes (241 KB)
==================================================
downloaded 241 KB

* installing *source* package ?rgeos? ...
** package ?rgeos? successfully unpacked and MD5 sums checked
configure: CC: gcc -std=gnu99
configure: CXX: g++
configure: rgeos: 0.3-8
checking for /usr/bin/svnversion... yes
configure: svn revision: 479
checking for geos-config... /usr/local/bin/geos-config
checking geos-config usability... yes
configure: GEOS version: 3.4.2
checking geos version at least 3.2.0... yes
checking geos-config clibs... yes
checking for gcc... gcc -std=gnu99
checking whether the C compiler works... yes
checking for C compiler default output file name... a.out
checking for suffix of executables...
checking whether we are cross compiling... no
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether gcc -std=gnu99 accepts -g... yes
checking for gcc -std=gnu99 option to accept ISO C89... none needed
checking how to run the C preprocessor... gcc -std=gnu99 -E
checking for grep that handles long lines and -e... /bin/grep
checking for egrep... /bin/grep -E
checking for ANSI C header files... yes
checking for sys/types.h... yes
checking for sys/stat.h... yes
checking for stdlib.h... yes
checking for string.h... yes
checking for memory.h... yes
checking for strings.h... yes
checking for inttypes.h... yes
checking for stdint.h... yes
checking for unistd.h... yes
checking geos_c.h usability... yes
checking geos_c.h presence... yes
checking for geos_c.h... yes
checking geos: linking with libgeos_c... yes
configure: PKG_CPPFLAGS:  -I/usr/local/include
configure: PKG_LIBS:  -L/usr/local/lib -lgeos -L/usr/local/lib -lgeos_c
configure: creating ./config.status
config.status: creating src/Makevars
** libs

This configuraton built and installed correctly. When my configurations
choke, I try to track down a working configuration like that above, check
my environment to see if I have everything that is going to be asked for.
If I don't have it I find out which package provides it and install the
developer version of the package so I have the headers and eventually I
have a successful build.

HTH,
Chris

On Tue, Jul 28, 2015 at 4:55 PM, Waichler, Scott R <Scott.Waichler at pnnl.gov>
wrote:

> Hi,
>
> I'm trying to install rgeos and I don't know how to respond to the error
> message:  "configure: error: cannot run C compiled programs"
>
> > install.packages("rgeos", dependencies = "Depends", repos = "
> http://cran.fhcrc.org/")
> trying URL 'http://cran.fhcrc.org/src/contrib/rgeos_0.3-11.tar.gz'
> Content type 'application/x-gzip' length 247152 bytes (241 KB)
> ==================================================
> downloaded 241 KB
>
> * installing *source* package ?rgeos? ...
> ** package ?rgeos? successfully unpacked and MD5 sums checked
> configure: CC: gcc -std=gnu99
> configure: CXX: g++
> configure: rgeos: 0.3-8
> checking for /usr/bin/svnversion... yes
> configure: svn revision: 479
> checking for geos-config... /usr/local/bin/geos-config
> checking geos-config usability... yes
> configure: GEOS version: 3.4.2
> checking geos version at least 3.2.0... yes
> checking geos-config clibs... yes
> checking for gcc... gcc -std=gnu99
> checking whether the C compiler works... yes
> checking for C compiler default output file name... a.out
> checking for suffix of executables...
> checking whether we are cross compiling... configure: error: in
> `/tmp/RtmpFSN1i4/R.INSTALL25f63e6c5cb4/rgeos':
> configure: error: cannot run C compiled programs.
> If you meant to cross compile, use `--host'.
> See `config.log' for more details
> ERROR: configuration failed for package ?rgeos?
> * removing ?/files3/R/R-3.2.1_install/lib64/R/library/rgeos?
>
> The downloaded source packages are in
>         ?/tmp/RtmpceXyoL/downloaded_packages?
> Updating HTML index of packages in '.Library'
> Making 'packages.html' ... done
> Warning message:
> In install.packages("rgeos", dependencies = "Depends", repos = "
> http://cran.fhcrc.org/") :
>   installation of package ?rgeos? had non-zero exit status
>
> Thanks,
> Scott Waichler
> Hydrology Group
> Pacific Northwest National Laboratory
> Richland, WA, USA
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From pierluigi.derosa at gmail.com  Wed Jul 29 13:42:25 2015
From: pierluigi.derosa at gmail.com (pierluigi de rosa)
Date: Wed, 29 Jul 2015 13:42:25 +0200
Subject: [R-sig-Geo] Limit number of digits in writeOGR
Message-ID: <CAAgsrZjVoYYys5-b6=x3ZBaiK3Y32y8M=9++wqjDG9xtoqRLWA@mail.gmail.com>

Dear All

I have a SpatialPointDataFrame
with this code I'm able to export a shape file:

writeOGR(fogli_sup_10d_pioggia,".","fogli_sup_10d_pioggia",driver="ESRI
Shapefile")


It is possible to limit number of digits?

Thanks
Pierluigi

-- 
Ing. Pierluigi De Rosa (PhD)
cel: 3497558268 / fax: 075 7823038
skype: pierluigi.derosa

	[[alternative HTML version deleted]]


From paul.ziyu.ma at gmail.com  Wed Jul 29 13:45:18 2015
From: paul.ziyu.ma at gmail.com (Ziyu Ma)
Date: Wed, 29 Jul 2015 13:45:18 +0200
Subject: [R-sig-Geo] NetCDF: Unknown file format?
Message-ID: <CAK3B57hWKSY3B_9ZYh-wrt=mcnSWRKhvm7Oq3LZJ13weAz44Uw@mail.gmail.com>

Dear all,

I tried to use R to open NetCDF file from the ESA's  soil moisture database:
http://www.esa-soilmoisture-cci.org/node/145

I have tried to use the R packages "ncdf" or "RNetCDF", but whenever I
tried to open the file, I have this same error message:

"Error in R_nc_open: NetCDF: Unknown file format"

I'm confused since I think both packages where designed to handle this file
format. Is there some other dependent softwares/packages missing on my
computer? I'm running Windows 7 64 bit and R 3.2.0 64 bit.

The soil moisture database recommends the "ncdf4" package, but the Windows
version of it is no longer available.

Thank you very much.

Cheers,
Ma

Ziyu Ma
PhD Student
Ecoinformatics & Biodiversity,
Department of Bioscience, Aarhus University
Ny Munkegade 114, DK-8000 Aarhus C, Denmark

	[[alternative HTML version deleted]]


From edzer.pebesma at uni-muenster.de  Wed Jul 29 14:00:47 2015
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 29 Jul 2015 14:00:47 +0200
Subject: [R-sig-Geo] Limit number of digits in writeOGR
In-Reply-To: <CAAgsrZjVoYYys5-b6=x3ZBaiK3Y32y8M=9++wqjDG9xtoqRLWA@mail.gmail.com>
References: <CAAgsrZjVoYYys5-b6=x3ZBaiK3Y32y8M=9++wqjDG9xtoqRLWA@mail.gmail.com>
Message-ID: <55B8C06F.2000008@uni-muenster.de>



On 07/29/2015 01:42 PM, pierluigi de rosa wrote:
> Dear All
> 
> I have a SpatialPointDataFrame
> with this code I'm able to export a shape file:
> 
> writeOGR(fogli_sup_10d_pioggia,".","fogli_sup_10d_pioggia",driver="ESRI
> Shapefile")
> 
> 
> It is possible to limit number of digits?
> 


Pierluigi, I believe that the files written are binary files, so there
are no number of digits, really. Of course you can apply round() to your
data, prior to exporting, to round your data. Does it concern
attributes, or coordinates?

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi),  University of M?nster,
Heisenbergstra?e 2, 48149 M?nster, Germany; +49 251 83 33081
Journal of Statistical Software:   http://www.jstatsoft.org/
Computers & Geosciences:   http://elsevier.com/locate/cageo/
Spatial Statistics Society http://www.spatialstatistics.info

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150729/71747682/attachment.bin>

From mdsumner at gmail.com  Wed Jul 29 14:27:14 2015
From: mdsumner at gmail.com (Michael Sumner)
Date: Wed, 29 Jul 2015 12:27:14 +0000
Subject: [R-sig-Geo] NetCDF: Unknown file format?
In-Reply-To: <CAK3B57hWKSY3B_9ZYh-wrt=mcnSWRKhvm7Oq3LZJ13weAz44Uw@mail.gmail.com>
References: <CAK3B57hWKSY3B_9ZYh-wrt=mcnSWRKhvm7Oq3LZJ13weAz44Uw@mail.gmail.com>
Message-ID: <CAAcGz99DA+LgwYZR6WmGU8EVXLU_MsUdyHqe2XBLqW1qRRJ=Kw@mail.gmail.com>

 Essentially this is probably that NetCDF4 (version 4 of the external
library) is required, but that neither ncdf or RNetCDF have been built with
that. The ncdf4 package is the only one that *requires* this, and CRAN
supports NetCDF-3 for Windows via ncdf and RNETCDF and doesn't support
ncdf4 for Windows.

(There are many features in the NetCDF format, and there are many features
not supported by any of these packages whether version 4 or not.)

You can get a build of ncdf4 for Windows here:

http://cirrus.ucsd.edu/~pierce/ncdf/

but you're on your own in terms of what version of R that will work in, if
at all, etc.

You can  build one of the three packages yourself against NetCDF4 proper,
and that is my preference - it's easiest on Linux, but it's not exactly
"easy" if you are used to windows and the CRAN support for binary packages.

If this is confusing that's just how it is - there are three R packages for
NetCDF, none of them support everything in NetCDF and what works best
depends on what you have available. If you have to do this a lot I
recommend learning to work in Linux.

Cheers, Mike.

On Wed, 29 Jul 2015 at 21:45 Ziyu Ma <paul.ziyu.ma at gmail.com> wrote:

> Dear all,
>
> I tried to use R to open NetCDF file from the ESA's  soil moisture
> database:
> http://www.esa-soilmoisture-cci.org/node/145
>
> I have tried to use the R packages "ncdf" or "RNetCDF", but whenever I
> tried to open the file, I have this same error message:
>
> "Error in R_nc_open: NetCDF: Unknown file format"
>
> I'm confused since I think both packages where designed to handle this file
> format. Is there some other dependent softwares/packages missing on my
> computer? I'm running Windows 7 64 bit and R 3.2.0 64 bit.
>
> The soil moisture database recommends the "ncdf4" package, but the Windows
> version of it is no longer available.
>
> Thank you very much.
>
> Cheers,
> Ma
>
> Ziyu Ma
> PhD Student
> Ecoinformatics & Biodiversity,
> Department of Bioscience, Aarhus University
> Ny Munkegade 114, DK-8000 Aarhus C, Denmark
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From paul.ziyu.ma at gmail.com  Wed Jul 29 15:22:26 2015
From: paul.ziyu.ma at gmail.com (Ziyu Ma)
Date: Wed, 29 Jul 2015 15:22:26 +0200
Subject: [R-sig-Geo] NetCDF: Unknown file format?
In-Reply-To: <CAAcGz99DA+LgwYZR6WmGU8EVXLU_MsUdyHqe2XBLqW1qRRJ=Kw@mail.gmail.com>
References: <CAK3B57hWKSY3B_9ZYh-wrt=mcnSWRKhvm7Oq3LZJ13weAz44Uw@mail.gmail.com>
	<CAAcGz99DA+LgwYZR6WmGU8EVXLU_MsUdyHqe2XBLqW1qRRJ=Kw@mail.gmail.com>
Message-ID: <CAK3B57gCTDog5oJ2axy9ofmcfoaw1fZMVjPjAdxCC=0f+bUb3Q@mail.gmail.com>

Thank you Mike,

I see that there's probably no fast solution for this. And yes, there are
lots of data. I will learn to work with it in Linux then.

Cheers
Ma

Ziyu Ma
PhD Student
Ecoinformatics & Biodiversity,
Department of Bioscience, Aarhus University
Ny Munkegade 114, DK-8000 Aarhus C, Denmark


On Wed, Jul 29, 2015 at 2:27 PM, Michael Sumner <mdsumner at gmail.com> wrote:

>  Essentially this is probably that NetCDF4 (version 4 of the external
> library) is required, but that neither ncdf or RNetCDF have been built with
> that. The ncdf4 package is the only one that *requires* this, and CRAN
> supports NetCDF-3 for Windows via ncdf and RNETCDF and doesn't support
> ncdf4 for Windows.
>
> (There are many features in the NetCDF format, and there are many features
> not supported by any of these packages whether version 4 or not.)
>
> You can get a build of ncdf4 for Windows here:
>
> http://cirrus.ucsd.edu/~pierce/ncdf/
>
> but you're on your own in terms of what version of R that will work in, if
> at all, etc.
>
> You can  build one of the three packages yourself against NetCDF4 proper,
> and that is my preference - it's easiest on Linux, but it's not exactly
> "easy" if you are used to windows and the CRAN support for binary packages.
>
> If this is confusing that's just how it is - there are three R packages
> for NetCDF, none of them support everything in NetCDF and what works best
> depends on what you have available. If you have to do this a lot I
> recommend learning to work in Linux.
>
> Cheers, Mike.
>
> On Wed, 29 Jul 2015 at 21:45 Ziyu Ma <paul.ziyu.ma at gmail.com> wrote:
>
>> Dear all,
>>
>> I tried to use R to open NetCDF file from the ESA's  soil moisture
>> database:
>> http://www.esa-soilmoisture-cci.org/node/145
>>
>> I have tried to use the R packages "ncdf" or "RNetCDF", but whenever I
>> tried to open the file, I have this same error message:
>>
>> "Error in R_nc_open: NetCDF: Unknown file format"
>>
>> I'm confused since I think both packages where designed to handle this
>> file
>> format. Is there some other dependent softwares/packages missing on my
>> computer? I'm running Windows 7 64 bit and R 3.2.0 64 bit.
>>
>> The soil moisture database recommends the "ncdf4" package, but the Windows
>> version of it is no longer available.
>>
>> Thank you very much.
>>
>> Cheers,
>> Ma
>>
>> Ziyu Ma
>> PhD Student
>> Ecoinformatics & Biodiversity,
>> Department of Bioscience, Aarhus University
>> Ny Munkegade 114, DK-8000 Aarhus C, Denmark
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>

	[[alternative HTML version deleted]]


From almut.schlaich at grauwekiekendief.nl  Wed Jul 29 17:12:37 2015
From: almut.schlaich at grauwekiekendief.nl (Almut Schlaich - Werkgroep Grauwe Kiekendief)
Date: Wed, 29 Jul 2015 17:12:37 +0200
Subject: [R-sig-Geo] plotKML - set color according to category
Message-ID: <55B8ED65.8080701@grauwekiekendief.nl>

Dear Dr. Hengl,

First of all, I would like to thank you and your colleagues for the 
great package plotKML that I really enjoy using.
This was indeed a missing link to visualize data, in our case tracking 
data, in Google Earth to easily explore them visually.

I would like to ask you a question about the possibilities to color the 
points according to a variable.
In my data table I have a column with classification category "phase" 
(e.g. migration, stopover, breeding, wintering etc.).
Using e.g.: 
kml_layer(data,colour=phase,colour_scale=worldgrids_pal[[4]]), I get 
tracks nicely colored depending on category.

But the difficulty arises when one bird has less levels of the category 
than another (e.g. one bird making no stopover).
In this case the same colors are used, but for different values of the 
category, just in the order of first appearance.
To easily compare tracks between individuals I would like to color the 
same category always in the same color. I tried to
define the colors for each category and give the column with a color 
value per point to the kml_layer function, but this
didn't work. Is it possible to determine the color of each point?

At the moment I just use the combination of kml_open, kml_layer and 
kml_close to produce the output.
Unfortuntely, the much more beautiful and handy plotKML for Space-time 
Trajectory Data Frames doesn't work for the
tracks since they have too many points. Could you tell me what is the 
limit for this? And might it be possible for more
points in near future?

Thank you in advance for your help!

Kind regards,
Almut Schlaich

-- 
Almut Schlaich

Werkgroep Grauwe Kiekendief
telefoon: +31(0)650459766
e-mail: almut.schlaich at grauwekiekendief.nl
postadres: Postbus 46, 9679 ZG Scheemda
www.grauwekiekendief.nl
twitter: @grauwekiek
facebook: www.facebook.com/pages/Werkgroep-Grauwe-Kiekendief/190585087622000


From paul.ziyu.ma at gmail.com  Wed Jul 29 17:54:59 2015
From: paul.ziyu.ma at gmail.com (Ziyu Ma)
Date: Wed, 29 Jul 2015 17:54:59 +0200
Subject: [R-sig-Geo] NetCDF: Unknown file format?
In-Reply-To: <CAK3B57gCTDog5oJ2axy9ofmcfoaw1fZMVjPjAdxCC=0f+bUb3Q@mail.gmail.com>
References: <CAK3B57hWKSY3B_9ZYh-wrt=mcnSWRKhvm7Oq3LZJ13weAz44Uw@mail.gmail.com>
	<CAAcGz99DA+LgwYZR6WmGU8EVXLU_MsUdyHqe2XBLqW1qRRJ=Kw@mail.gmail.com>
	<CAK3B57gCTDog5oJ2axy9ofmcfoaw1fZMVjPjAdxCC=0f+bUb3Q@mail.gmail.com>
Message-ID: <CAK3B57hhv80M67PJ7cMUt2=Mrmeyd1weqgXJiOx7NMeKdnp1LA@mail.gmail.com>

Dear all,

I just found out the "raster" package actually handles NetCDF4 very nicely:
for example, NetCDF4 files can be converted to a raster simply by:

raster("FileName.nc", varname="SingleVariableToExtractInTheNetCDF4File")

I think it might be useful information to everybody so I repost it here.

Cheers,
Ma

Ziyu Ma
PhD Student
Ecoinformatics & Biodiversity,
Department of Bioscience, Aarhus University
Ny Munkegade 114, DK-8000 Aarhus C, Denmark


On Wed, Jul 29, 2015 at 3:22 PM, Ziyu Ma <paul.ziyu.ma at gmail.com> wrote:

> Thank you Mike,
>
> I see that there's probably no fast solution for this. And yes, there are
> lots of data. I will learn to work with it in Linux then.
>
> Cheers
> Ma
>
> Ziyu Ma
> PhD Student
> Ecoinformatics & Biodiversity,
> Department of Bioscience, Aarhus University
> Ny Munkegade 114, DK-8000 Aarhus C, Denmark
>
>
> On Wed, Jul 29, 2015 at 2:27 PM, Michael Sumner <mdsumner at gmail.com>
> wrote:
>
>>  Essentially this is probably that NetCDF4 (version 4 of the external
>> library) is required, but that neither ncdf or RNetCDF have been built with
>> that. The ncdf4 package is the only one that *requires* this, and CRAN
>> supports NetCDF-3 for Windows via ncdf and RNETCDF and doesn't support
>> ncdf4 for Windows.
>>
>> (There are many features in the NetCDF format, and there are many
>> features not supported by any of these packages whether version 4 or not.)
>>
>> You can get a build of ncdf4 for Windows here:
>>
>> http://cirrus.ucsd.edu/~pierce/ncdf/
>>
>> but you're on your own in terms of what version of R that will work in,
>> if at all, etc.
>>
>> You can  build one of the three packages yourself against NetCDF4 proper,
>> and that is my preference - it's easiest on Linux, but it's not exactly
>> "easy" if you are used to windows and the CRAN support for binary packages.
>>
>> If this is confusing that's just how it is - there are three R packages
>> for NetCDF, none of them support everything in NetCDF and what works best
>> depends on what you have available. If you have to do this a lot I
>> recommend learning to work in Linux.
>>
>> Cheers, Mike.
>>
>> On Wed, 29 Jul 2015 at 21:45 Ziyu Ma <paul.ziyu.ma at gmail.com> wrote:
>>
>>> Dear all,
>>>
>>> I tried to use R to open NetCDF file from the ESA's  soil moisture
>>> database:
>>> http://www.esa-soilmoisture-cci.org/node/145
>>>
>>> I have tried to use the R packages "ncdf" or "RNetCDF", but whenever I
>>> tried to open the file, I have this same error message:
>>>
>>> "Error in R_nc_open: NetCDF: Unknown file format"
>>>
>>> I'm confused since I think both packages where designed to handle this
>>> file
>>> format. Is there some other dependent softwares/packages missing on my
>>> computer? I'm running Windows 7 64 bit and R 3.2.0 64 bit.
>>>
>>> The soil moisture database recommends the "ncdf4" package, but the
>>> Windows
>>> version of it is no longer available.
>>>
>>> Thank you very much.
>>>
>>> Cheers,
>>> Ma
>>>
>>> Ziyu Ma
>>> PhD Student
>>> Ecoinformatics & Biodiversity,
>>> Department of Bioscience, Aarhus University
>>> Ny Munkegade 114, DK-8000 Aarhus C, Denmark
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>

	[[alternative HTML version deleted]]


From Andy.Bunn at wwu.edu  Wed Jul 29 19:08:55 2015
From: Andy.Bunn at wwu.edu (Andy Bunn)
Date: Wed, 29 Jul 2015 17:08:55 +0000
Subject: [R-sig-Geo] raster::calc with multiple arguments
Message-ID: <D1DE56B3.3D93B%andy.bunn@wwu.edu>

Hi all, likely a dumb question. I want to use raster::calc with a function containing more than one argument. This violates the expectation of calc so I know the code below shouldn't work but I'm wondering what the best alternative is for calculating values for a new raster object from another raster object using a function with multiple arguments (e.g., fun2 below).

Regards and thanks in advance, Andy


require(raster)
r <- raster(ncols=36, nrows=18)
r[] <- 1:ncell(r)

# multiply values by 10
fun1 <- function(x) { x * 10}
# multiply values by alpha
fun2 <- function(x, alpha) { x * alpha}

rc1 <- calc(r, fun1) # works
rc2 <- calc(r, fun2, alpha=10) # doesn't work


	[[alternative HTML version deleted]]


From elgabass at gmail.com  Wed Jul 29 20:18:51 2015
From: elgabass at gmail.com (Ahmed El-Gabbas)
Date: Wed, 29 Jul 2015 20:18:51 +0200
Subject: [R-sig-Geo] raster::calc with multiple arguments
In-Reply-To: <D1DE56B3.3D93B%andy.bunn@wwu.edu>
References: <D1DE56B3.3D93B%andy.bunn@wwu.edu>
Message-ID: <CAJEGayc1rXUy10g3wmmhgC_Sshia+2om-F66ZhAMqogwEE7DQw@mail.gmail.com>

Something like this should works:

require(raster)
r <- raster(ncols=36, nrows=18)
r[] <- 1:ncell(r)

fun1 <- function(R, alpha) {
   if(!is.numeric(alpha) | !class(R) %in% c("RasterLayer", "RasterStack")){
# check class type
      stop()
   } else {
      R*alpha
   }
}
r2 <- fun1(R = r, alpha = 10)

###|||||||||||||||||||||||
### or
###|||||||||||||||||||||||

fun2 <- function(..., alpha) {...*alpha}
r3 <- calc(r, function(x){  fun2(x, alpha = 10) } )

all.equal(r2[],r3[]) # both solutions give the same results

------------------------
Regards,
Ahmed

On Wed, Jul 29, 2015 at 7:08 PM, Andy Bunn <Andy.Bunn at wwu.edu> wrote:

> Hi all, likely a dumb question. I want to use raster::calc with a function
> containing more than one argument. This violates the expectation of calc so
> I know the code below shouldn't work but I'm wondering what the best
> alternative is for calculating values for a new raster object from another
> raster object using a function with multiple arguments (e.g., fun2 below).
>
> Regards and thanks in advance, Andy
>
>
> require(raster)
> r <- raster(ncols=36, nrows=18)
> r[] <- 1:ncell(r)
>
> # multiply values by 10
> fun1 <- function(x) { x * 10}
> # multiply values by alpha
> fun2 <- function(x, alpha) { x * alpha}
>
> rc1 <- calc(r, fun1) # works
> rc2 <- calc(r, fun2, alpha=10) # doesn't work
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From mdsumner at gmail.com  Wed Jul 29 22:11:42 2015
From: mdsumner at gmail.com (Michael Sumner)
Date: Wed, 29 Jul 2015 20:11:42 +0000
Subject: [R-sig-Geo] NetCDF: Unknown file format?
In-Reply-To: <CAK3B57hhv80M67PJ7cMUt2=Mrmeyd1weqgXJiOx7NMeKdnp1LA@mail.gmail.com>
References: <CAK3B57hWKSY3B_9ZYh-wrt=mcnSWRKhvm7Oq3LZJ13weAz44Uw@mail.gmail.com>
	<CAAcGz99DA+LgwYZR6WmGU8EVXLU_MsUdyHqe2XBLqW1qRRJ=Kw@mail.gmail.com>
	<CAK3B57gCTDog5oJ2axy9ofmcfoaw1fZMVjPjAdxCC=0f+bUb3Q@mail.gmail.com>
	<CAK3B57hhv80M67PJ7cMUt2=Mrmeyd1weqgXJiOx7NMeKdnp1LA@mail.gmail.com>
Message-ID: <CAAcGz99XYxN5piEcC65Oi3WPcg2QupWYDgXe3C0PSOLgsGZ_Rw@mail.gmail.com>

Hello,

On Thu, 30 Jul 2015 at 01:54 Ziyu Ma <paul.ziyu.ma at gmail.com> wrote:

> Dear all,
>
> I just found out the "raster" package actually handles NetCDF4 very nicely:
> for example, NetCDF4 files can be converted to a raster simply by:
>
> raster("FileName.nc", varname="SingleVariableToExtractInTheNetCDF4File")
>
>
That is great - but raster (last time I looked) relies on ncdf or ncdf4
being available for this format.
Is this now on Linux rather than Windows?  Can you please include the
output of sessionInfo()? (which lists the R build and package versions)

FWIW, if you didn't have either ncdf or ncdf4 it would pass to the GDAL
logic (via rgdal) and you might get success (but not on the
Windows-CRAN-rgdal, which doesn't include NetCDF - another wrinkle in this
adventure).

Cheers, Mike.


I think it might be useful information to everybody so I repost it here.
>
> Cheers,
> Ma
>
> Ziyu Ma
> PhD Student
> Ecoinformatics & Biodiversity,
> Department of Bioscience, Aarhus University
> Ny Munkegade 114, DK-8000 Aarhus C, Denmark
>
>
> On Wed, Jul 29, 2015 at 3:22 PM, Ziyu Ma <paul.ziyu.ma at gmail.com> wrote:
>
>> Thank you Mike,
>>
>> I see that there's probably no fast solution for this. And yes, there are
>> lots of data. I will learn to work with it in Linux then.
>>
>> Cheers
>> Ma
>>
>> Ziyu Ma
>> PhD Student
>> Ecoinformatics & Biodiversity,
>> Department of Bioscience, Aarhus University
>> Ny Munkegade 114, DK-8000 Aarhus C, Denmark
>>
>>
>> On Wed, Jul 29, 2015 at 2:27 PM, Michael Sumner <mdsumner at gmail.com>
>> wrote:
>>
>>>  Essentially this is probably that NetCDF4 (version 4 of the external
>>> library) is required, but that neither ncdf or RNetCDF have been built with
>>> that. The ncdf4 package is the only one that *requires* this, and CRAN
>>> supports NetCDF-3 for Windows via ncdf and RNETCDF and doesn't support
>>> ncdf4 for Windows.
>>>
>>> (There are many features in the NetCDF format, and there are many
>>> features not supported by any of these packages whether version 4 or not.)
>>>
>>> You can get a build of ncdf4 for Windows here:
>>>
>>> http://cirrus.ucsd.edu/~pierce/ncdf/
>>>
>>> but you're on your own in terms of what version of R that will work in,
>>> if at all, etc.
>>>
>>> You can  build one of the three packages yourself against NetCDF4
>>> proper, and that is my preference - it's easiest on Linux, but it's not
>>> exactly "easy" if you are used to windows and the CRAN support for binary
>>> packages.
>>>
>>> If this is confusing that's just how it is - there are three R packages
>>> for NetCDF, none of them support everything in NetCDF and what works best
>>> depends on what you have available. If you have to do this a lot I
>>> recommend learning to work in Linux.
>>>
>>> Cheers, Mike.
>>>
>>> On Wed, 29 Jul 2015 at 21:45 Ziyu Ma <paul.ziyu.ma at gmail.com> wrote:
>>>
>>>> Dear all,
>>>>
>>>> I tried to use R to open NetCDF file from the ESA's  soil moisture
>>>> database:
>>>> http://www.esa-soilmoisture-cci.org/node/145
>>>>
>>>> I have tried to use the R packages "ncdf" or "RNetCDF", but whenever I
>>>> tried to open the file, I have this same error message:
>>>>
>>>> "Error in R_nc_open: NetCDF: Unknown file format"
>>>>
>>>> I'm confused since I think both packages where designed to handle this
>>>> file
>>>> format. Is there some other dependent softwares/packages missing on my
>>>> computer? I'm running Windows 7 64 bit and R 3.2.0 64 bit.
>>>>
>>>> The soil moisture database recommends the "ncdf4" package, but the
>>>> Windows
>>>> version of it is no longer available.
>>>>
>>>> Thank you very much.
>>>>
>>>> Cheers,
>>>> Ma
>>>>
>>>> Ziyu Ma
>>>> PhD Student
>>>> Ecoinformatics & Biodiversity,
>>>> Department of Bioscience, Aarhus University
>>>> Ny Munkegade 114, DK-8000 Aarhus C, Denmark
>>>>
>>>>         [[alternative HTML version deleted]]
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>
>>
>

	[[alternative HTML version deleted]]


From hc10024 at gmail.com  Thu Jul 30 05:46:57 2015
From: hc10024 at gmail.com (Helen Chen)
Date: Wed, 29 Jul 2015 20:46:57 -0700
Subject: [R-sig-Geo] questions for predicting spatial GEV in spatial extreme
	package
Message-ID: <CAKjCKvFKNVmN9fc3iL0=XfL-02Jp6TGVQNDLRUks5LyF5xw5=g@mail.gmail.com>

Hi,

I would like to predict spatial GEV from spatial extreme package for my
data.

The following is the code I run:

library(SpatialExtremes)

rainfall=read.csv("rainfall.csv")
coordinate=read.csv("coordinates.csv")
rain=as.matrix(rainfall)
coord=as.matrix(coordinate)

## Define the trend surfaces
loc.form <- scale.form <- z ~ x * y
shape.form <- z ~ 1

## Center and scale the covariates
covariates <- scale(coord[,1:2])
M0 <- fitspatgev(rain, covariates, loc.form, scale.form, shape.form)

I got error message as:

> M0 <- fitspatgev(rain, covariates, loc.form, scale.form, shape.form)
Error in scale.model$dsgn.mat %*% scaleCoeff : non-conformable arguments
In addition: Warning messages:
1: In model.matrix.default(mt, mf, contrasts) :
  the response appeared on the right-hand side and was dropped
2: In model.matrix.default(mt, mf, contrasts) :
  problem with term 2 in model.matrix: no columns are assigned
3: In model.matrix.default(mt, mf, contrasts) :
  the response appeared on the right-hand side and was dropped
4: In model.matrix.default(mt, mf, contrasts) :
  problem with term 2 in model.matrix: no columns are assigned


Could anyone help me to figure it out? Many thanks in advance.

Helen

	[[alternative HTML version deleted]]


From adeela.uaf at gmail.com  Thu Jul 30 05:49:20 2015
From: adeela.uaf at gmail.com (adeela uaf)
Date: Thu, 30 Jul 2015 08:49:20 +0500
Subject: [R-sig-Geo] CRS format
Message-ID: <CABGg3O4c-skMcp=Q+fP-pD3c2gJL0dianvR5DcfjqcC1=V=OLg@mail.gmail.com>

Hi,
I want to project my data on a map. The data were taken from a town of
Faisalabad city in Pakistan. But I don't know how to place an 'epsg' value
for that. As for meuse data set the codes are:

data(meuse)
>coordinates(meuse)<-~x+y # convert to SPDF
>proj4string(meuse) <- CRS('+init=epsg:28992')
For my dataset
coordinates(mt)<-~XCORD+YCORD
how can I find the epsg code.
Regards,
Adeela
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150730/3482c307/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: mt - Copy.csv
Type: text/csv
Size: 691 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20150730/3482c307/attachment.bin>

From SWalbridge at esri.com  Thu Jul 30 05:53:36 2015
From: SWalbridge at esri.com (Shaun Walbridge)
Date: Thu, 30 Jul 2015 03:53:36 +0000
Subject: [R-sig-Geo] CRS format
In-Reply-To: <CABGg3O4c-skMcp=Q+fP-pD3c2gJL0dianvR5DcfjqcC1=V=OLg@mail.gmail.com>
References: <CABGg3O4c-skMcp=Q+fP-pD3c2gJL0dianvR5DcfjqcC1=V=OLg@mail.gmail.com>
Message-ID: <D1DF179C.2EC7E%swalbridge@esri.com>

Adeela,

It from the look of your CSV, the data appears to be in geographic
(unprojected)
coordinate space. It's most likely WGS84[1], which has an EPSG code of
4326.
I'd start with '+init=epsg:4326' and see if that does the trick.

Cheers,
Shaun

1. https://en.wikipedia.org/wiki/World_Geodetic_System#WGS84


-- 
Shaun Walbridge
GIS Developer





From:  R-sig-Geo <r-sig-geo-bounces at r-project.org> on behalf of adeela uaf
<adeela.uaf at gmail.com>
Date:  Wednesday, July 29, 2015 at 11:49 PM
To:  R-sig-geo Mailing List <R-sig-Geo at r-project.org>
Subject:  [R-sig-Geo] CRS format


Hi,
I want to project my data on a map. The data were taken from a town of
Faisalabad city in Pakistan. But I don't know how to place an 'epsg' value
for that. As for meuse data set the codes are:

data(meuse)
>coordinates(meuse)<-~x+y # convert to SPDF
>proj4string(meuse) <- CRS('+init=epsg:28992')

For my dataset
coordinates(mt)<-~XCORD+YCORD

how can I find the epsg code.
Regards,
Adeela


From rodrigo.plei at gmail.com  Thu Jul 30 17:14:49 2015
From: rodrigo.plei at gmail.com (Rodrigo Plei)
Date: Thu, 30 Jul 2015 12:14:49 -0300
Subject: [R-sig-Geo] error in reading shapefile
Message-ID: <CACs_BFOiYxMVgtKFHORgxen+w1aoEtcvc8ufNHicXa+hjzx6ow@mail.gmail.com>

Dear all,

I am getting the following error message when I try to open a shapefile
using maptools:

"Error in .shp2LinesDF(Map, proj4string = proj4string, delete_null_obj =
delete_null_obj) :
  not an arc or poly Map object"

How I can sort this out (if tthis is possible)?

Regards,

Rodrigo

-- 
=8-->=8-->=8-->=8-->=8-->=8-->=8-->=8-->=8-->=8-->=8-->=8-->

Prof. Dr. Rodrigo Silvestre Martins

Universidade Federal de S?o Paulo
Departamento de Ci?ncias do Mar
Campus Baixada Santista
Avenida Almirante Saldanha da Gama, 89
Ponta da Praia, 11030400 - Santos, SP - Brasil
Tel: + 55 13 3878-3965

http://www.unifesp.br/campus/san7/inicio-imar
<http://www.imar.unifesp.br/v2/>

Email: rodrigo.plei at gmail.com ; ocersm at lycos.com; rsmartins at usp.br;
rsmartins at unifesp.br
CV Lattes: http://lattes.cnpq.br/5350064124902777
Google Scholar:
http://scholar.google.com.br/citations?user=zX_EezEAAAAJ&hl=pt-BR
Research Gate: https://www.researchgate.net/profile/Rodrigo_Martins6/
<https://www.researchgate.net/profile/Rodrigo_Martins6/?ev=hdr_xprf>

	[[alternative HTML version deleted]]


From karlashikev at gmail.com  Fri Jul 31 00:20:24 2015
From: karlashikev at gmail.com (Karla Shikev)
Date: Thu, 30 Jul 2015 19:20:24 -0300
Subject: [R-sig-Geo] generating shapefiles based on the values on a raster
Message-ID: <CAPU4_4q1BirTEBJFebuh0Nen_XDjFnXcm23ZT4bOBoqLNi9AnA@mail.gmail.com>

Hi there,

I need to take a raster (e.g. mean annual temperature) and generate a
shapefile with all the regions between two values (e.g. between 20 and 25
degrees C). Any tips will be greatly appreciated.

Karla

	[[alternative HTML version deleted]]


From dobzhanski at gmail.com  Fri Jul 31 02:33:03 2015
From: dobzhanski at gmail.com (john d)
Date: Thu, 30 Jul 2015 21:33:03 -0300
Subject: [R-sig-Geo] finding limits in a shapefile
Message-ID: <CAMLNaBYVAfeTtQqpoQDUPYbo0zRU=jQaef5N4uwUg4wLmyba-A@mail.gmail.com>

Dear all,

Is there a simple way to obtain the coordinates for the N, S, E and W
limits of a shapefile?

Thanks

	[[alternative HTML version deleted]]


From johnbaums at gmail.com  Fri Jul 31 02:50:47 2015
From: johnbaums at gmail.com (John Baumgartner)
Date: Fri, 31 Jul 2015 10:50:47 +1000
Subject: [R-sig-Geo] finding limits in a shapefile
In-Reply-To: <CAMLNaBYVAfeTtQqpoQDUPYbo0zRU=jQaef5N4uwUg4wLmyba-A@mail.gmail.com>
References: <CAMLNaBYVAfeTtQqpoQDUPYbo0zRU=jQaef5N4uwUg4wLmyba-A@mail.gmail.com>
Message-ID: <CACpmSOvUGO+Vjf12JwNwKTyJPMHRAvTGzFf5jBD6kL3P6dhJqw@mail.gmail.com>

Assuming you've read it into R, e.g. with readOGR from the rgdal package,
you can query the extent of the spatial object with bbox (sp package) or
extent (raster package).

On Friday, 31 July 2015, john d <dobzhanski at gmail.com> wrote:

> Dear all,
>
> Is there a simple way to obtain the coordinates for the N, S, E and W
> limits of a shapefile?
>
> Thanks
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org <javascript:;>
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

	[[alternative HTML version deleted]]


From roman.lustrik at gmail.com  Fri Jul 31 08:55:51 2015
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Fri, 31 Jul 2015 08:55:51 +0200
Subject: [R-sig-Geo] generating shapefiles based on the values on a
	raster
In-Reply-To: <CAPU4_4q1BirTEBJFebuh0Nen_XDjFnXcm23ZT4bOBoqLNi9AnA@mail.gmail.com>
References: <CAPU4_4q1BirTEBJFebuh0Nen_XDjFnXcm23ZT4bOBoqLNi9AnA@mail.gmail.com>
Message-ID: <CAHT1vphA-DY9nQRHir=n-08F=q3NwO0whemzS9KE0SSvsK=3yQ@mail.gmail.com>

If I understand your question correctly, you're looking for a function that
will convert a raster into a polygon (
http://www.inside-r.org/packages/cran/raster/docs/rasterToPolygons).

Cheers,
Roman


On Fri, Jul 31, 2015 at 12:20 AM, Karla Shikev <karlashikev at gmail.com>
wrote:

> Hi there,
>
> I need to take a raster (e.g. mean annual temperature) and generate a
> shapefile with all the regions between two values (e.g. between 20 and 25
> degrees C). Any tips will be greatly appreciated.
>
> Karla
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
In God we trust, all others bring data.

	[[alternative HTML version deleted]]


From dobzhanski at gmail.com  Fri Jul 31 14:13:28 2015
From: dobzhanski at gmail.com (john d)
Date: Fri, 31 Jul 2015 09:13:28 -0300
Subject: [R-sig-Geo] finding limits in a shapefile
In-Reply-To: <CACpmSOvUGO+Vjf12JwNwKTyJPMHRAvTGzFf5jBD6kL3P6dhJqw@mail.gmail.com>
References: <CAMLNaBYVAfeTtQqpoQDUPYbo0zRU=jQaef5N4uwUg4wLmyba-A@mail.gmail.com>
	<CACpmSOvUGO+Vjf12JwNwKTyJPMHRAvTGzFf5jBD6kL3P6dhJqw@mail.gmail.com>
Message-ID: <CAMLNaBZ6Cc3otZsC784p7uitNHMriev1wzgQJeZpdOwxE4oyAQ@mail.gmail.com>

Excellent. That will do.

Thanks!

On Thu, Jul 30, 2015 at 9:50 PM, John Baumgartner <johnbaums at gmail.com>
wrote:

> Assuming you've read it into R, e.g. with readOGR from the rgdal package,
> you can query the extent of the spatial object with bbox (sp package) or
> extent (raster package).
>
> On Friday, 31 July 2015, john d <dobzhanski at gmail.com> wrote:
>
>> Dear all,
>>
>> Is there a simple way to obtain the coordinates for the N, S, E and W
>> limits of a shapefile?
>>
>> Thanks
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>

	[[alternative HTML version deleted]]


From dobzhanski at gmail.com  Fri Jul 31 16:47:06 2015
From: dobzhanski at gmail.com (john d)
Date: Fri, 31 Jul 2015 11:47:06 -0300
Subject: [R-sig-Geo] measuring longitudes as if they were parallels?
Message-ID: <CAMLNaBZ6ib9mpxL6+ircPNkgh-QBx=p+achBp-YheY44AOijmA@mail.gmail.com>

Dear all,

Here's another issue that I've been struggling with and I'd really
appreciate any input.

I want to compare the latitudinal and longitudinal extents of different
shapefiles. Comparing latitudes is straightforward because they are
measured as parallels, so they are "self-referential". However, measuring
longitudes is always tricky because, as they are represented as meridians,
longitudinal degrees always depend on their latitude.

Is there a way to represent longitudes that is also self-referential?
Perhaps some transformation?

Any discussion in this respect will be greatly appreciated.

	[[alternative HTML version deleted]]


From loic.dutrieux at wur.nl  Fri Jul 31 18:21:30 2015
From: loic.dutrieux at wur.nl (=?windows-1252?Q?Lo=EFc_Dutrieux?=)
Date: Fri, 31 Jul 2015 18:21:30 +0200
Subject: [R-sig-Geo] measuring longitudes as if they were parallels?
In-Reply-To: <CAMLNaBZ6ib9mpxL6+ircPNkgh-QBx=p+achBp-YheY44AOijmA@mail.gmail.com>
References: <CAMLNaBZ6ib9mpxL6+ircPNkgh-QBx=p+achBp-YheY44AOijmA@mail.gmail.com>
Message-ID: <55BBA08A.7090606@wur.nl>

Hi John,

Possibly what you're looking for is in the geosphere package 
(https://cran.r-project.org/web/packages/geosphere/geosphere.pdf).

Cheers,
Lo?c

On 07/31/2015 04:47 PM, john d wrote:
> Dear all,
>
> Here's another issue that I've been struggling with and I'd really
> appreciate any input.
>
> I want to compare the latitudinal and longitudinal extents of different
> shapefiles. Comparing latitudes is straightforward because they are
> measured as parallels, so they are "self-referential". However, measuring
> longitudes is always tricky because, as they are represented as meridians,
> longitudinal degrees always depend on their latitude.
>
> Is there a way to represent longitudes that is also self-referential?
> Perhaps some transformation?
>
> Any discussion in this respect will be greatly appreciated.
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From dobzhanski at gmail.com  Fri Jul 31 22:21:09 2015
From: dobzhanski at gmail.com (john d)
Date: Fri, 31 Jul 2015 17:21:09 -0300
Subject: [R-sig-Geo] measuring longitudes as if they were parallels?
In-Reply-To: <CAMLNaBZJPHsD4TF3b0MjkRC9GXaVSBfd6ofxGMYKJojfQAQV=g@mail.gmail.com>
References: <CAMLNaBZ6ib9mpxL6+ircPNkgh-QBx=p+achBp-YheY44AOijmA@mail.gmail.com>
	<55BBA08A.7090606@wur.nl>
	<CAMLNaBZJPHsD4TF3b0MjkRC9GXaVSBfd6ofxGMYKJojfQAQV=g@mail.gmail.com>
Message-ID: <CAMLNaBbRcQ5jQuJoqRiOc4mOECmoeBWrCb6C=fwjXHXQ_YV_KQ@mail.gmail.com>

Cool. I'll look into that. Thanks. Lo?c!

On Fri, Jul 31, 2015 at 3:44 PM, john d <dobzhanski at gmail.com> wrote:

> Cool. I'll look into that. Thanks. Lo?c!
>
> On Fri, Jul 31, 2015 at 1:21 PM, Lo?c Dutrieux <loic.dutrieux at wur.nl>
> wrote:
>
>> Hi John,
>>
>> Possibly what you're looking for is in the geosphere package (
>> https://cran.r-project.org/web/packages/geosphere/geosphere.pdf).
>>
>> Cheers,
>> Lo?c
>>
>>
>> On 07/31/2015 04:47 PM, john d wrote:
>>
>>> Dear all,
>>>
>>> Here's another issue that I've been struggling with and I'd really
>>> appreciate any input.
>>>
>>> I want to compare the latitudinal and longitudinal extents of different
>>> shapefiles. Comparing latitudes is straightforward because they are
>>> measured as parallels, so they are "self-referential". However, measuring
>>> longitudes is always tricky because, as they are represented as
>>> meridians,
>>> longitudinal degrees always depend on their latitude.
>>>
>>> Is there a way to represent longitudes that is also self-referential?
>>> Perhaps some transformation?
>>>
>>> Any discussion in this respect will be greatly appreciated.
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>

	[[alternative HTML version deleted]]


