From tghoward at gw.dec.state.ny.us  Tue Aug  1 14:22:13 2006
From: tghoward at gw.dec.state.ny.us (Tim Howard)
Date: Tue, 01 Aug 2006 08:22:13 -0400
Subject: [R-sig-Geo] randomForests for mapping vegetation with big data
Message-ID: <s4cf0f5c.089@gwsmtp.DEC.STATE.NY.US>

Alberto - 

I am doing the same with randomForests: We are working with 22,578 X
17,160 pixel GRIDS and 36 environmental variables. The big difference is
that we don't have nearly that size data frames for training data. In
the few cases that we do have a lot of points/rows (up to about 20,000)
, we end up running fewer trees (down from 600 to 100 trees). 

I think it may be more appropriate to divide by running fewer trees on
the entire set if you can. Try running 50-100 trees on the 300000 row
data frame, and then making sure you aren't starting from the same
random seed, keep running these smaller sets until you get the total
number of trees you want. Then combine them to make your prediction.  

The difficult, memory intensive part for us is running the prediction
on our large GRIDS. For this we have to read in the data from the 36
environmental variables (in ascii format) line by line and then write
out the prediction before reading in the next batch. 

Tim Howard



Date: Mon, 31 Jul 2006 12:17:34 +0200
From: "Alberto Ruiz Moreno" <aruiz at eeza.csic.es>
Subject: [R-sig-Geo] randomForests for mapping vegetation with big
	data
To: <r-sig-geo at stat.math.ethz.ch>
Message-ID:
	<306770A257EE3840A78215253AF233C815AC61 at CORREO.eeza.csic.es>
Content-Type: text/plain

Hi,
 
I*m trying to ran randomForests in R to do vegetation suitability
maps.
 
I*m working with 1000x1000 pixel maps and 30 environmental  variables.
 
My software is R v2.3.1 and RandomForests 4.5-16. 
1GB Ram memory and 3GB swap partition in a Linux or Windows machine
(the problem is the same in both configurations).
 
R abort with an memory limits error when I try to train randomForest
with 
big data frames, 300000 rows x 30 columns and 500 trees.
 
I have lost one week tuning the use of memory in R (I read tens of
messages on it) but
I think that it is not a R misconfiguration but a big memory expense of
randomforests library implementation.
 
My conclusion is: I need to divide...
 
ok, to solve this memory error, I ran randomForests several times, 
with less rows in the training data, and use the combine() function to
join the forests.
 
The cuestion is...
 
Is this the right way to train randomForest with big data? 
There are another way?
How do you make it?
 

thanks...

	[[alternative HTML version deleted]]



From gyrating2 at gmail.com  Wed Aug  2 16:30:16 2006
From: gyrating2 at gmail.com (...)
Date: Thu, 3 Aug 2006 00:30:16 +1000
Subject: [R-sig-Geo] Coerce list to SpatialGridDataFrame?
Message-ID: <ca76e7340608020730q27e7a317j5396424e974fc191@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20060803/5b0aa904/attachment.pl>

From gyrating2 at gmail.com  Thu Aug  3 12:18:50 2006
From: gyrating2 at gmail.com (...)
Date: Thu, 3 Aug 2006 20:18:50 +1000
Subject: [R-sig-Geo] Coerce list to SpatialGridDataFrame?
Message-ID: <ca76e7340608030318t451d6306t4a751bcdf28a352d@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20060803/38f69b5b/attachment.pl>

From e.pebesma at geo.uu.nl  Thu Aug  3 13:36:49 2006
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Thu, 03 Aug 2006 12:36:49 +0100
Subject: [R-sig-Geo] availability of Least-Squares
 Collocation(LSC)	technique for optimal interpolation of spatial data. on r
In-Reply-To: <20060727010755.34412.qmail@web10712.mail.bbt.yahoo.co.jp>
References: <20060727010755.34412.qmail@web10712.mail.bbt.yahoo.co.jp>
Message-ID: <44D1DFD1.6050101@geo.uu.nl>

Hisaji, I only know of collocated cokriging; this is a technique that is 
available in package gstat. Not particularly under this name, but if you 
set the neighbourhood size of the secondary variable(s) to the single 
nearest neighbour, then you effectively get collocated cokriging, given 
that this value is collocated with the prediction location.
--
Edzer

Hisaji ONO wrote:

>Hi
>
> Recently among geostatistics Least-Squares
>Collocation(LSC) technique seems to be one of notable
>methods.
>
> I've searched this method on R spatial packages, but no
>luck.
>
>
> Does anyone know free application/package support this
>method?
>
>
> Regards.
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at stat.math.ethz.ch
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>  
>



From e.pebesma at geo.uu.nl  Thu Aug  3 13:40:18 2006
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Thu, 03 Aug 2006 12:40:18 +0100
Subject: [R-sig-Geo] gstat error: singular matrix in function LDLfactor()
In-Reply-To: <OFA5FF45E8.BC9D5E23-ONCA2571B8.0007CBF1-CA2571B8.000C8D3B@nre.vic.gov.au>
References: <OFA5FF45E8.BC9D5E23-ONCA2571B8.0007CBF1-CA2571B8.000C8D3B@nre.vic.gov.au>
Message-ID: <44D1E0A2.2090105@geo.uu.nl>

karl.sommer at dpi.vic.gov.au wrote:

>When performing ordinary kriging under gstat in R I received the following
>error after the program had stopped.
>
>---R output
>vert.ok <- krige(vert~1, em38a, SPDF, model=vert.fit)
>[using ordinary kriging]
>
>"chfactor.c", line 130: singular matrix in function LDLfactor()
>
>gstat caught an error that occurred in the matrix library,
>the reason for it was: singular matrix
>
>HINT: Read the manual at http://www.gstat.org/ ;
>look for: Trouble shooting -> Error messages -> From meschach
>
>"chfactor.c", line 130: singular matrix in function LDLfactor()
>Error in predict.gstat(g, newdata = newdata, block = block, nsim = nsim,  :
>      matrix library error: gstat: matrix library error: singular matrix
>---end R output
>
>after consulting the gstat manual I found the following reference:
>
>"These two error messages may occur (a) during simulation, when an
>observation falls almost exactly at a simulation location (b) when two
>observations occur at identical location occur and noaverage was defined in
>its data definition. Solution to (a): increase the value of zero, to (b):
>remove the noaverage. Read also the next section."
>
>My input file was converted from lat/long to UTM using spTransform.  The
>sampling density is quite high and it is possible that after conversion
>from latlong to UTM because of rounding some measurements fall on identical
>coordinates.  Is this a possible explanation for the error?
>  
>
Yes. Also near-identical locations in combination with variograms 
without a nugget effect may caus it.

>The GSTAT online manual suggests to remove "noaverage" or increase "zero"
>to overcome the problem. However, I have not figured out how to do this
>when running gstat under R.
>  
>
Either package gstat, but more likely package sp has a function zerodist 
which will find point pairs with (nearly) zero distances. You may use 
the indexes it returns to do something with these points (e.g. remove 
one of them).

>Should I use only a subset of the orignial data or are there other
>alternatives to overcome the problem?
>  
>
Yes. An alternative would be to average observations, if they are scalar 
data.
--
Edzer

>Regards
>
>Karl
>
>_________________________________
>Karl J Sommer,
>Department of Primary Industries,
>Catchment & Agriculture Services,
>PO Box 905
>Mildura, VIC, Australia 3502
>
>Tel: +61 (0)3 5051 4390
>Fax +61 (0)3 5051 4534
>
>Email:     karl.sommer at dpi.vic.gov.au
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at stat.math.ethz.ch
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>  
>



From graham.cookson at imperial.ac.uk  Thu Aug  3 17:47:13 2006
From: graham.cookson at imperial.ac.uk (Graham Cookson)
Date: Thu, 03 Aug 2006 16:47:13 +0100
Subject: [R-sig-Geo] Map2Poly: Error message
Message-ID: <C0F7D911.62B5%graham.cookson@imperial.ac.uk>



Dear List,

I hope you can help me with this problem.

I am attempting to form an adjacency matrix and I'm trying to get my
shapefile into R. However, I get error messages at the initial stages.

I used the following code:
library(maptools)
library(spdep)
map<-read.shape("englandandwales.shp")
polylist<-Map2poly(map)

The map object is created fine and it finds all 8490 polygons, but the
Map2poly command generates the following error message:

Error in if (res[[6]] > 0) return(as.integer(-1)) else return(as.integer(1))

I have searched the web and the R Help Archives but can't find examples of
this problem occurring before.

The shapefile I am using was  created in ArcView by merging the separate
Wales and England shapefiles available from UK Borders at Edina.ac.uk

I am using R2.2.0 on an Apple iBook G4 running Mac OS X 10.3.9

I hope that this isn't a really stupid question

Thanks!
Graham





-- 
Graham Cookson
Centre for Environmental Policy
Imperial College London
4th Floor, RSM Building
Prince Consort Road
London  SW7 2BP

Tel: 020 7594 9313
Mob: 07968 061323
Email: graham.cookson at imperial.ac.uk



From Roger.Bivand at nhh.no  Thu Aug  3 19:00:36 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 3 Aug 2006 19:00:36 +0200 (CEST)
Subject: [R-sig-Geo] Map2Poly: Error message
In-Reply-To: <C0F7D911.62B5%graham.cookson@imperial.ac.uk>
Message-ID: <Pine.LNX.4.44.0608031847550.5635-100000@reclus.nhh.no>

On Thu, 3 Aug 2006, Graham Cookson wrote:

> 
> 
> Dear List,
> 
> I hope you can help me with this problem.
> 
> I am attempting to form an adjacency matrix and I'm trying to get my
> shapefile into R. However, I get error messages at the initial stages.
> 
> I used the following code:
> library(maptools)
> library(spdep)
> map<-read.shape("englandandwales.shp")
> polylist<-Map2poly(map)
> 
> The map object is created fine and it finds all 8490 polygons, but the
> Map2poly command generates the following error message:
> 
> Error in if (res[[6]] > 0) return(as.integer(-1)) else return(as.integer(1))
> 
> I have searched the web and the R Help Archives but can't find examples of
> this problem occurring before.
> 
> The shapefile I am using was  created in ArcView by merging the separate
> Wales and England shapefiles available from UK Borders at Edina.ac.uk
> 
> I am using R2.2.0 on an Apple iBook G4 running Mac OS X 10.3.9
> 
> I hope that this isn't a really stupid question

No, a relevant question on the right list with lots of helpful details. 
The error is thrown in Map2poly -> .get.polylist -> .ringDirxy, where the 
two last functions are internal ones, and the last one, with the error, is 
trying to determine the ring direction.

This is implemented differently in the readShapePoly() function also in 
maptools, which imports a shapefile into a SpatialPolygonsDataFrame. From 
there, you just coerce to SpatialPolygons to run poly2nb() - 
poly2nb(as(SPDF, "SpatialPolygons")) should work. Could you please try 
that route first, and let us know if it works?

If you'd prefer not to use the SpatialPolygonsDataFrame class, then we'll 
need to debug the older code, and then access to your shapefile (or a 
subset displaying the same symptoms) will be needed just for testing. In 
any case the output of sessionInfo() and of traceback() immediately after 
the error, together with the full error message would be very useful. 
Setting quiet=FALSE in the Map2poly() call may also show that some 
polygons are getting their ring directions reversed.

Roger

> 
> Thanks!
> Graham
> 
> 
> 
> 
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From mdsumner at utas.edu.au  Fri Aug  4 07:28:00 2006
From: mdsumner at utas.edu.au (Michael Sumner)
Date: Fri, 04 Aug 2006 7:28:00 +0200
Subject: [R-sig-Geo] Coerce list to SpatialGridDataFrame?
Message-ID: <200608040528.k745S0oE018894@corinna.its.utas.edu.au>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20060804/ee622628/attachment.pl>

From mdsumner at utas.edu.au  Fri Aug  4 09:06:05 2006
From: mdsumner at utas.edu.au (Michael Sumner)
Date: Fri, 04 Aug 2006 9:06:05 +0200
Subject: [R-sig-Geo] Coerce list to SpatialGridDataFrame?
Message-ID: <200608040706.k74765N8029403@corinna.its.utas.edu.au>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20060804/5b53d1f6/attachment.pl>

From Roger.Bivand at nhh.no  Fri Aug  4 11:24:37 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 4 Aug 2006 11:24:37 +0200 (CEST)
Subject: [R-sig-Geo] Coerce list to SpatialGridDataFrame?
In-Reply-To: <200608040706.k74765N8029403@corinna.its.utas.edu.au>
Message-ID: <Pine.LNX.4.44.0608041121420.9960-100000@reclus.nhh.no>

On Fri, 4 Aug 2006, Michael Sumner wrote:

> A correction (due to grid orientation), with example:
> 
> library(rgdal)
> d <- list(x  =1:10, y = 2:11, z = matrix(1:100, 10, 10))
> gt <- GridTopology(cellcentre.offset = c(d$x[1], d$x[2]), 
>     cellsize = c(diff(d$x[1:2])/2, diff(d$y[1:2])/2), cells.dim = dim(d$z))
> 
>  ## because of the way the grids are oriented compared to the normal R image
>  grd.atts <- SpatialGridDataFrame(gt, list(depth =
> as.vector(d$z[,ncol(d$z):1])))

Almost. The image() function is a bit wierd, so you do need to be careful. 
A couple of small suggestions:

d <- list(x  =1:10, y = 22:31, z = matrix(1:100, 10, 10))
image(d)
gt <- GridTopology(cellcentre.offset = c(d$x[1], d$y[1]), 
    cellsize = c(diff(d$x[1:2]), diff(d$y[1:2])), cells.dim = dim(d$z))
grd.atts <- SpatialGridDataFrame(gt, list(depth =
    as.vector(d$z[,ncol(d$z):1])))
image(grd.atts, axes=TRUE)

gets the cell centres and sizes right (assuming x and y are 
centre-registered).

Roger

> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From scottfr at gmail.com  Sat Aug  5 01:48:29 2006
From: scottfr at gmail.com (Scott Fortmann-Roe)
Date: Fri, 4 Aug 2006 16:48:29 -0700
Subject: [R-sig-Geo] [R-sig-GEO] [ANN] k-NNCH and R Improvements
Message-ID: <f18f141c0608041648v7895e13lac3a3a9e4651f5c1@mail.gmail.com>

I am pleased to announce the release of an improved version of the R
k-NNCH script (also known as LoCoH) that is included in adehabitat.
The k-NNCH method has a number advantages over other methods such as
kernel methods for finding a UD. It handles 'sharp' landscape features
(lakes, fences, etc.) well and generates density indicators.

This script has a number of improvements over the last version including:

* Generating homeranges for multiple k's.
* Correct plotting of isopleths containing holes.
* Optimisations for large data sets.
* Built in functions for dealing with shapefiles and textfiles.
* R tcl/tk GUI.
* A number of added helper functions and bug fixes.

This script has not yet been re-integrated into adehabitat as Clement
(the package maintainer) is on vacation until the end of August. When
he starts answering emails again, we hope to have it integrated. For
the moment, you can download the improved script at:
http://locoh.palary.org/rtutorial

Additionally, this R script has been used as the basis for an ArcGIS
toolbox, and a web application. Please check out
<http://locoh.palary.org> for more information.

Comments and suggestions for improvements are very welcomed and much desired.

-Scott Fortmann-Roe



From rbt501 at york.ac.uk  Mon Aug  7 16:38:49 2006
From: rbt501 at york.ac.uk (Taylor, RB)
Date: Mon, 07 Aug 2006 15:38:49 +0100
Subject: [R-sig-Geo] Converting LL to UTM in S Hemisphere
Message-ID: <44D75079.8DA95C77@york.ac.uk>

Hi Everyone,

I am working with coordinates from the South Africa which is East of the
Meridian and South of the Equator. Currently my cordinates are in WGS84
recorded something like this 19.523912 E -33.94084 N (or rather 33.94084
S). I understand when working in UTM in the Southern Hemisphere the
origin is defined as a point 10,000,000 metres south of the equator. Is
there a simple way to "tell" PBSmapping that I am working in the
Southern Hemisphere (i.e. latitude zone)?

Thanks,
Rob Taylor

PS I can get the correct easting value since PBSmapping allows one to
define the UTM longitudal zone



From jjpark at ucr.edu  Tue Aug  8 16:57:48 2006
From: jjpark at ucr.edu (Jung Joon Park)
Date: Tue, 8 Aug 2006 07:57:48 -0700
Subject: [R-sig-Geo] R-sig-Geo Digest, Vol 36, Issue 6
References: <mailman.11.1155031204.15896.r-sig-geo@stat.math.ethz.ch>
Message-ID: <000501c6bafb$03858f00$c6c80a0a@oardcwin.ohiostate.edu>

Dear Rob.

Hello I am Jung Joon Park at UCRiverside as Postdoc. Recently I changed LL to UTM by this spreadsheet in website, http://www.uwgb.edu/dutchs/UsefulData/HowUseExcel.HTM (see enclosed Excel file). I wish it will help you.

Cheers.

JJ Park


----- Original Message ----- 
From: <r-sig-geo-request at stat.math.ethz.ch>
To: <r-sig-geo at stat.math.ethz.ch>
Sent: Tuesday, August 08, 2006 3:00 AM
Subject: R-sig-Geo Digest, Vol 36, Issue 6


> Send R-sig-Geo mailing list submissions to
> r-sig-geo at stat.math.ethz.ch
> 
> To subscribe or unsubscribe via the World Wide Web, visit
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> or, via email, send a message with subject or body 'help' to
> r-sig-geo-request at stat.math.ethz.ch
> 
> You can reach the person managing the list at
> r-sig-geo-owner at stat.math.ethz.ch
> 
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of R-sig-Geo digest..."
> 
> 
> Today's Topics:
> 
>   1. Converting LL to UTM in S Hemisphere (Taylor, RB)
> 
> 
> ----------------------------------------------------------------------
> 
> Message: 1
> Date: Mon, 07 Aug 2006 15:38:49 +0100
> From: "Taylor, RB" <rbt501 at york.ac.uk>
> Subject: [R-sig-Geo] Converting LL to UTM in S Hemisphere
> To: r-sig-geo at stat.math.ethz.ch
> Message-ID: <44D75079.8DA95C77 at york.ac.uk>
> Content-Type: text/plain; charset=us-ascii
> 
> Hi Everyone,
> 
> I am working with coordinates from the South Africa which is East of the
> Meridian and South of the Equator. Currently my cordinates are in WGS84
> recorded something like this 19.523912 E -33.94084 N (or rather 33.94084
> S). I understand when working in UTM in the Southern Hemisphere the
> origin is defined as a point 10,000,000 metres south of the equator. Is
> there a simple way to "tell" PBSmapping that I am working in the
> Southern Hemisphere (i.e. latitude zone)?
> 
> Thanks,
> Rob Taylor
> 
> PS I can get the correct easting value since PBSmapping allows one to
> define the UTM longitudal zone
> 
> 
> 
> ------------------------------
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 
> End of R-sig-Geo Digest, Vol 36, Issue 6
> ****************************************
-------------- next part --------------
A non-text attachment was scrubbed...
Name: UTMConversions1.xls
Type: application/vnd.ms-excel
Size: 103936 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20060808/d2eb897e/attachment.xls>

From yong.li at unimelb.edu.au  Wed Aug  9 05:58:37 2006
From: yong.li at unimelb.edu.au (Yong Li)
Date: Wed, 09 Aug 2006 13:58:37 +1000
Subject: [R-sig-Geo] remote sensing in R
Message-ID: <6.2.5.6.2.20060809135534.02aea0e0@unimelb.edu.au>

Hi Everybody,
Has anybody done or know the remote sensing (e.g. satellite image 
processing) package in R?

Thanks. Yong



From cavallini at faunalia.it  Wed Aug  9 07:40:14 2006
From: cavallini at faunalia.it (Paolo Cavallini)
Date: Wed, 09 Aug 2006 07:40:14 +0200
Subject: [R-sig-Geo] remote sensing in R
In-Reply-To: <6.2.5.6.2.20060809135534.02aea0e0@unimelb.edu.au>
References: <6.2.5.6.2.20060809135534.02aea0e0@unimelb.edu.au>
Message-ID: <44D9753E.1060101@faunalia.it>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

I would suggest you to give GRASS a try for this. I do not think R is
the right tool. And GRASS plays nicely together with R.
pc

Yong Li ha scritto:
> Hi Everybody,
> Has anybody done or know the remote sensing (e.g. satellite image 
> processing) package in R?
> 
> Thanks. Yong
- --
Paolo Cavallini
email+jabber: cavallini at faunalia.it
www.faunalia.it
Piazza Garibaldi 5 - 56025 Pontedera (PI), Italy   Tel: (+39)348-3801953
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.3 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iD8DBQFE2XU+/NedwLUzIr4RAjtLAKCBaNEXkx8/mjerwOCCvR61o/a0vACgsTd4
8vypaour9IVk1zpOsimDmow=
=7Zez
-----END PGP SIGNATURE-----



From graham.cookson at imperial.ac.uk  Wed Aug  9 18:03:11 2006
From: graham.cookson at imperial.ac.uk (Graham Cookson)
Date: Wed, 09 Aug 2006 17:03:11 +0100
Subject: [R-sig-Geo] Map2Poly: Error message
In-Reply-To: <Pine.LNX.4.44.0608031847550.5635-100000@reclus.nhh.no>
Message-ID: <C0FFC5CF.6444%graham.cookson@imperial.ac.uk>



Dear Roger (...and the list)

Thank you Roger for that useful insight. I have tried your suggestion and,
once again, encountered some error messages. I've played around with it a
little bit, but I'm getting nowhere.

Perhaps you will have come across this problem before.

I tried your routine so I typed:

library(foreign)
library(maptools)
library(spdep)
map<-readShapePoly("englandandwales.shp")

But I got the following error:

Error in if (rD < 0) hole <- TRUE : missing value where TRUE/FALSE needed

Following the various examples in the help file I then tried

map<-readShapePoly("englandandwales.shp", IDvar="LABEL")

But now get the following error:

Error in from [j]: to [j]: NA/NaN argument

Error in coordinates(coords): unable to find the argument 'obj' in selecting
a method for function 'coordinates'


I've got this feeling I'm just doing something really silly but can't work
it out. Any help welcome. It may help to know that all I want to do is
produce a proximity matrix of contiguous boundary neighbours from the
Shapefile for now.


Again, I'm using R2.2.0 on an Apple iBook G4. The shapefile is a merged file
of England and Wales ward boundaries downloaded from Edina.ac.uk and was
merged in ArcView. It contains some 8,500 polygons and is 250MB.

Thank you,
Graham


-- 
Graham Cookson
Centre for Environmental Policy
Imperial College London
4th Floor, RSM Building
Prince Consort Road
London  SW7 2BP

Tel: 020 7594 9313
Mob: 07968 061323
Email: graham.cookson at imperial.ac.uk




> From: Roger Bivand <Roger.Bivand at nhh.no>
> Reply-To: Roger.Bivand at nhh.no
> Date: Thu, 3 Aug 2006 19:00:36 +0200 (CEST)
> To: Graham Cookson <graham.cookson at imperial.ac.uk>
> Cc: r-sig-geo at stat.math.ethz.ch
> Subject: Re: [R-sig-Geo] Map2Poly: Error message
> 
> On Thu, 3 Aug 2006, Graham Cookson wrote:
> 
>> 
>> 
>> Dear List,
>> 
>> I hope you can help me with this problem.
>> 
>> I am attempting to form an adjacency matrix and I'm trying to get my
>> shapefile into R. However, I get error messages at the initial stages.
>> 
>> I used the following code:
>> library(maptools)
>> library(spdep)
>> map<-read.shape("englandandwales.shp")
>> polylist<-Map2poly(map)
>> 
>> The map object is created fine and it finds all 8490 polygons, but the
>> Map2poly command generates the following error message:
>> 
>> Error in if (res[[6]] > 0) return(as.integer(-1)) else return(as.integer(1))
>> 
>> I have searched the web and the R Help Archives but can't find examples of
>> this problem occurring before.
>> 
>> The shapefile I am using was  created in ArcView by merging the separate
>> Wales and England shapefiles available from UK Borders at Edina.ac.uk
>> 
>> I am using R2.2.0 on an Apple iBook G4 running Mac OS X 10.3.9
>> 
>> I hope that this isn't a really stupid question
> 
> No, a relevant question on the right list with lots of helpful details.
> The error is thrown in Map2poly -> .get.polylist -> .ringDirxy, where the
> two last functions are internal ones, and the last one, with the error, is
> trying to determine the ring direction.
> 
> This is implemented differently in the readShapePoly() function also in
> maptools, which imports a shapefile into a SpatialPolygonsDataFrame. From
> there, you just coerce to SpatialPolygons to run poly2nb() -
> poly2nb(as(SPDF, "SpatialPolygons")) should work. Could you please try
> that route first, and let us know if it works?
> 
> If you'd prefer not to use the SpatialPolygonsDataFrame class, then we'll
> need to debug the older code, and then access to your shapefile (or a
> subset displaying the same symptoms) will be needed just for testing. In
> any case the output of sessionInfo() and of traceback() immediately after
> the error, together with the full error message would be very useful.
> Setting quiet=FALSE in the Map2poly() call may also show that some
> polygons are getting their ring directions reversed.
> 
> Roger
> 
>> 
>> Thanks!
>> Graham
>> 
>> 
>> 
>> 
>> 
>> 
> 
> -- 
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
> 
>



From Roger.Bivand at nhh.no  Wed Aug  9 20:34:14 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 9 Aug 2006 20:34:14 +0200 (CEST)
Subject: [R-sig-Geo] Map2Poly: Error message
In-Reply-To: <C0FFC5CF.6444%graham.cookson@imperial.ac.uk>
Message-ID: <Pine.LNX.4.44.0608092017320.31423-100000@reclus.nhh.no>

On Wed, 9 Aug 2006, Graham Cookson wrote:

> 
> 
> Dear Roger (...and the list)
> 
> Thank you Roger for that useful insight. I have tried your suggestion and,
> once again, encountered some error messages. I've played around with it a
> little bit, but I'm getting nowhere.
> 
> Perhaps you will have come across this problem before.
> 
> I tried your routine so I typed:
> 
> library(foreign)
> library(maptools)
> library(spdep)
> map<-readShapePoly("englandandwales.shp")
> 
> But I got the following error:
> 
> Error in if (rD < 0) hole <- TRUE : missing value where TRUE/FALSE needed
> 
> Following the various examples in the help file I then tried
> 
> map<-readShapePoly("englandandwales.shp", IDvar="LABEL")
> 
> But now get the following error:
> 
> Error in from [j]: to [j]: NA/NaN argument
> 
> Error in coordinates(coords): unable to find the argument 'obj' in selecting
> a method for function 'coordinates'
> 
> 
> I've got this feeling I'm just doing something really silly but can't work
> it out. Any help welcome. It may help to know that all I want to do is
> produce a proximity matrix of contiguous boundary neighbours from the
> Shapefile for now.
> 
> 
> Again, I'm using R2.2.0 on an Apple iBook G4. The shapefile is a merged file
> of England and Wales ward boundaries downloaded from Edina.ac.uk and was
> merged in ArcView. It contains some 8,500 polygons and is 250MB.

Graham,

There is almost certainly something wrong with the shapefile, and the only 
way to debug this is either for you to do it, or for you to make the file 
available for the maptools package maintainer (me) to do it. It's too 
large to email, you may not want to post it on an open website, so maybe 
copy it to a CDROM and send it by post?

We know that firms like Geolytics sell shapefiles breaking the ESRI
specification, and I would not be surprised if this is also the case.

In my original reply 

https://stat.ethz.ch/pipermail/r-sig-geo/2006-August/001214.html

I suggested that you should include sessionInfo() and traceback()  
information. Since you have not done this, we don't know which version of
maptools you are using, not what the call context of the error messages 
actually was. Since you are on OSX, you could install the rgdal
package from source (if you can do that, involving installing GDAL and 
PROJ.4 too, try readOGR() in that package). 

What we need to dig out is first which shape is throwing the error, and
then what value is present that leads to the error. This will involve
using debug() on the private functions I named before and trying to read
your data (or similar data with the same error).

Can other software read the file? 

Roger

> 
> Thank you,
> Graham
> 
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From graham.cookson at imperial.ac.uk  Thu Aug 10 13:41:40 2006
From: graham.cookson at imperial.ac.uk (Cookson, Graham D)
Date: Thu, 10 Aug 2006 12:41:40 +0100
Subject: [R-sig-Geo] Map2Poly: Error message
References: <Pine.LNX.4.44.0608092017320.31423-100000@reclus.nhh.no>
Message-ID: <F741E3C5AE0B914EAD5FFC59288B0D430106EC82@icex1.ic.ac.uk>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20060810/527ba7e8/attachment.pl>

From massimodisasha at yahoo.it  Fri Aug 11 13:09:25 2006
From: massimodisasha at yahoo.it (massimodisasha)
Date: Fri, 11 Aug 2006 13:09:25 +0200
Subject: [R-sig-Geo] spatstat from 1.9-3 to 1.9-4 (compile failure on mac
	osx)
Message-ID: <673635C6-85A1-431F-8F0A-51C4147A10B7@yahoo.it>

hi, i'm trying to update spatstat package from 1.9-3  to  1.9-4,
but i've this error :


The downloaded packages are in
	/private/tmp/RtmpKfD0aW/downloaded_packages
g++-3.3 -bundle -flat_namespace -undefined suppress -L/usr/local/lib - 
o spatstat.so Kborder.o Kwborder.o PerfectStrauss.o arand.o aru.o  
cif.o closepair.o corrections.o deathm.o deathu.o dgs.o diggra.o  
dinfty.o discarea.o dist2.o distances.o done.o dppll.o exactPdist.o  
exactdist.o fexitc.o fexitf.o geyer.o initaux.o inxyp.o lookup.o  
massdisthack.o mh1.o mh2.o mh3.o mh4.o mh5.o mh6.o mh7.o mh8.o mh9.o  
sftcr.o straush.o straushm.o strauss.o straussm.o updaux.o xyseg.o  - 
L/usr/local/lib/gcc/powerpc-apple-darwin6.8/3.4.2 -lg2c -lSystem - 
lcc_dynamic -F/Library/Frameworks/R.framework/.. -framework R
ld: multiple definitions of symbol _costm
dinfty.o definition of _costm in section (__DATA,__common)
done.o definition of _costm in section (__DATA,__common)
ld: multiple definitions of symbol _n
dinfty.o definition of _n in section (__DATA,__common)
done.o definition of _n in section (__DATA,__common)
ld: warning multiple definitions of symbol _signgam
/Library/Frameworks/R.framework/../R.framework/R(lgamma.lo)  
definition of _signgam
/usr/lib/libSystem.dylib(gamma9.o) definition of _signgam
make: *** [spatstat.so] Error 1
ERROR: compilation failed for package 'spatstat'
** Removing '/Library/Frameworks/R.framework/Versions/2.2/Resources/ 
library/spatstat'
** Restoring previous '/Library/Frameworks/R.framework/Versions/2.2/ 
Resources/library/spatstat'
 >

the version 1.9-3 work fine with the examples present in the package.

thanks for any suggestion.
Massimo.



From Kate.Searle at csiro.au  Sun Aug 13 05:05:11 2006
From: Kate.Searle at csiro.au (Kate.Searle at csiro.au)
Date: Sun, 13 Aug 2006 13:05:11 +1000
Subject: [R-sig-Geo] biivariate moran
Message-ID: <062AE320EF971E40ACD0F6C93391D769932C50@exqld1-tsv.nexus.csiro.au>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20060813/1784373a/attachment.pl>

From martell at smokey.forestry.utoronto.ca  Mon Aug 14 20:26:19 2006
From: martell at smokey.forestry.utoronto.ca (David Martell)
Date: Mon, 14 Aug 2006 14:26:19 -0400
Subject: [R-sig-Geo] Linking lm residuls to specific polygon in shape files
Message-ID: <Pine.SOL.4.55.0608141416550.867@smokey.forestry.utoronto.ca>


I am using the lm.morantest procedure in spdep to test for spatial
autocorrelation in my lm residuals.

I am not sure where this procedure gets the residuals.

I have prepared a GIS coverage that has a .shp file.  I ran the lm model,
produced the residuals, then put them them in the GIS coverage.


When I run lm in my R program, it produces an lm object that also contains
the residuals.


Does lm.morantest get the residuals from the .shp file or the lm object.

If it gets them from the latter, how does it determine which residual is
assigned to which polygon in the .shp file.

Thanks,

Dave Martell

_____________________________________________________________

David L. Martell, Professor
Faculty of Forestry, University of Toronto
33 Willcocks Street, Toronto, Ontario, Canada, M5S 3B3

E-mail:  martell at smokey.forestry.utoronto.ca
URL:     http://www.firelab.utoronto.ca
Phone:   (416) 978-6960
Fax:     (416) 978-3834
Map:     ES on campus map at http://oracle.osm.utoronto.ca/map/



From Roger.Bivand at nhh.no  Mon Aug 14 22:12:55 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 14 Aug 2006 22:12:55 +0200 (CEST)
Subject: [R-sig-Geo] Linking lm residuls to specific polygon in shape
 files
In-Reply-To: <Pine.SOL.4.55.0608141416550.867@smokey.forestry.utoronto.ca>
Message-ID: <Pine.LNX.4.44.0608142156080.13097-100000@reclus.nhh.no>

On Mon, 14 Aug 2006, David Martell wrote:

> 
> I am using the lm.morantest procedure in spdep to test for spatial
> autocorrelation in my lm residuals.
> 
> I am not sure where this procedure gets the residuals.
> 
> I have prepared a GIS coverage that has a .shp file.  I ran the lm model,
> produced the residuals, then put them them in the GIS coverage.
> 
> 
> When I run lm in my R program, it produces an lm object that also contains
> the residuals.
> 
> 
> Does lm.morantest get the residuals from the .shp file or the lm object.
> 
> If it gets them from the latter, how does it determine which residual is
> assigned to which polygon in the .shp file.

lm.morantest() uses the whole "lm" object returned by lm(), so the 
residuals are by definition in the same order as the variables included in 
the model formula. If you need tight control, do something like this:

xx <- readShapePoly(system.file("shapes/columbus.shp", 
  package="maptools")[1], IDvar="NEIGNO")
row.names(as(xx, "data.frame"))
xx_nb <- poly2nb(as(xx, "SpatialPolygons"))
attr(xx_nb, "region.id")
lm_obj <- lm(CRIME ~ INC + HOVAL, data=xx)
names(residuals(lm_obj))
lm.morantest(lm_obj, nb2listw(xx_nb), spChk=TRUE)

where spChk=TRUE checks the equality of the names of the residuals of the 
"lm" object (taken from the data= object of the call to lm()) with the 
"region.id" attribute of the neighbour list. From the time the sapefile is 
read, it has nothing more to do with the SpatialPolygonsDataFrame object 
(here xx). Doing something like:

xx$lm_obj_resids <- residuals(lm_obj)

and then

writePolyShape(xx, "newshape")

includes them in a new shapefile.

Does this clarify things?

Roger

> 
> Thanks,
> 
> Dave Martell
> 
> _____________________________________________________________
> 
> David L. Martell, Professor
> Faculty of Forestry, University of Toronto
> 33 Willcocks Street, Toronto, Ontario, Canada, M5S 3B3
> 
> E-mail:  martell at smokey.forestry.utoronto.ca
> URL:     http://www.firelab.utoronto.ca
> Phone:   (416) 978-6960
> Fax:     (416) 978-3834
> Map:     ES on campus map at http://oracle.osm.utoronto.ca/map/
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From martell at smokey.forestry.utoronto.ca  Mon Aug 14 22:19:25 2006
From: martell at smokey.forestry.utoronto.ca (David Martell)
Date: Mon, 14 Aug 2006 16:19:25 -0400
Subject: [R-sig-Geo] Linking lm residuls to specific polygon in shape
 files
In-Reply-To: <Pine.LNX.4.44.0608142156080.13097-100000@reclus.nhh.no>
References: <Pine.LNX.4.44.0608142156080.13097-100000@reclus.nhh.no>
Message-ID: <Pine.SOL.4.55.0608141617260.867@smokey.forestry.utoronto.ca>


Hello Roger,

Yes, that's very helpful.

Thanks very much,

Dave Martell


On Mon, 14 Aug 2006, Roger Bivand wrote:

> On Mon, 14 Aug 2006, David Martell wrote:
>
> >
> > I am using the lm.morantest procedure in spdep to test for spatial
> > autocorrelation in my lm residuals.
> >
> > I am not sure where this procedure gets the residuals.
> >
> > I have prepared a GIS coverage that has a .shp file.  I ran the lm model,
> > produced the residuals, then put them them in the GIS coverage.
> >
> >
> > When I run lm in my R program, it produces an lm object that also contains
> > the residuals.
> >
> >
> > Does lm.morantest get the residuals from the .shp file or the lm object.
> >
> > If it gets them from the latter, how does it determine which residual is
> > assigned to which polygon in the .shp file.
>
> lm.morantest() uses the whole "lm" object returned by lm(), so the
> residuals are by definition in the same order as the variables included in
> the model formula. If you need tight control, do something like this:
>
> xx <- readShapePoly(system.file("shapes/columbus.shp",
>   package="maptools")[1], IDvar="NEIGNO")
> row.names(as(xx, "data.frame"))
> xx_nb <- poly2nb(as(xx, "SpatialPolygons"))
> attr(xx_nb, "region.id")
> lm_obj <- lm(CRIME ~ INC + HOVAL, data=xx)
> names(residuals(lm_obj))
> lm.morantest(lm_obj, nb2listw(xx_nb), spChk=TRUE)
>
> where spChk=TRUE checks the equality of the names of the residuals of the
> "lm" object (taken from the data= object of the call to lm()) with the
> "region.id" attribute of the neighbour list. From the time the sapefile is
> read, it has nothing more to do with the SpatialPolygonsDataFrame object
> (here xx). Doing something like:
>
> xx$lm_obj_resids <- residuals(lm_obj)
>
> and then
>
> writePolyShape(xx, "newshape")
>
> includes them in a new shapefile.
>
> Does this clarify things?
>
> Roger
>
> >
> > Thanks,
> >
> > Dave Martell
> >
> > _____________________________________________________________
> >
> > David L. Martell, Professor
> > Faculty of Forestry, University of Toronto
> > 33 Willcocks Street, Toronto, Ontario, Canada, M5S 3B3
> >
> > E-mail:  martell at smokey.forestry.utoronto.ca
> > URL:     http://www.firelab.utoronto.ca
> > Phone:   (416) 978-6960
> > Fax:     (416) 978-3834
> > Map:     ES on campus map at http://oracle.osm.utoronto.ca/map/
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
> --
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
>

_____________________________________________________________

David L. Martell, Professor
Faculty of Forestry, University of Toronto
33 Willcocks Street, Toronto, Ontario, Canada, M5S 3B3

E-mail:  martell at smokey.forestry.utoronto.ca
URL:     http://www.firelab.utoronto.ca
Phone:   (416) 978-6960
Fax:     (416) 978-3834
Map:     ES on campus map at http://oracle.osm.utoronto.ca/map/



From sp8ial at gmail.com  Tue Aug 15 12:41:40 2006
From: sp8ial at gmail.com (Bruce Greene)
Date: Tue, 15 Aug 2006 20:41:40 +1000
Subject: [R-sig-Geo] multi-attribute tiff files?
Message-ID: <54c8adaa0608150341h385bc47dm199680dc9f861759@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20060815/9aab1255/attachment.pl>

From karl.sommer at dpi.vic.gov.au  Wed Aug 23 07:32:25 2006
From: karl.sommer at dpi.vic.gov.au (karl.sommer at dpi.vic.gov.au)
Date: Wed, 23 Aug 2006 15:32:25 +1000
Subject: [R-sig-Geo] [R-sig-GEO] data set manipulation, averaging
Message-ID: <OF52105C1D.CE0E57E5-ONCA2571D3.00140D3F-CA2571D3.001E6F0E@nre.vic.gov.au>

Hello list

I am stuck with a problem regarding the manipulation of two data sets.

The first data set contains electromagnetic induction (EMI) readings of a
field obtained with a high sampling density,14965 records in a field 1000
by 500 m. Each reading is geo-referenced.
The second set contains soil related information (texture) taken from soil
pits of the same field at a density of 75 x 75 m resulting in 111 readings.
The position of each pit is geo-referenced as well.

I would like to calculate an average of the EMI readings in the vicinity of
the soil pits, say within a radius of 2 - 5 metres and relate this average
to the soil texture data obtained from the pits.

Averaging would also reduce the size of the EMI data set which at the
moment is too big for ordinary kriging in GSTAT.

Can this be done with a few lines of code?

Regards

_________________________________
Karl J Sommer,
Department of Primary Industries,
Catchment & Agriculture Services,
PO Box 905
Mildura, VIC, Australia 3502

Tel: +61 (0)3 5051 4390
Fax +61 (0)3 5051 4534

Email:     karl.sommer at dpi.vic.gov.au



From e.pebesma at geo.uu.nl  Wed Aug 23 09:12:30 2006
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Wed, 23 Aug 2006 09:12:30 +0200
Subject: [R-sig-Geo] [R-sig-GEO] data set manipulation, averaging
In-Reply-To: <OF52105C1D.CE0E57E5-ONCA2571D3.00140D3F-CA2571D3.001E6F0E@nre.vic.gov.au>
References: <OF52105C1D.CE0E57E5-ONCA2571D3.00140D3F-CA2571D3.001E6F0E@nre.vic.gov.au>
Message-ID: <44EBFFDE.3070903@geo.uu.nl>

karl.sommer at dpi.vic.gov.au wrote:
> Hello list
>
> I am stuck with a problem regarding the manipulation of two data sets.
>
> The first data set contains electromagnetic induction (EMI) readings of a
> field obtained with a high sampling density,14965 records in a field 1000
> by 500 m. Each reading is geo-referenced.
> The second set contains soil related information (texture) taken from soil
> pits of the same field at a density of 75 x 75 m resulting in 111 readings.
> The position of each pit is geo-referenced as well.
>
> I would like to calculate an average of the EMI readings in the vicinity of
> the soil pits, say within a radius of 2 - 5 metres and relate this average
> to the soil texture data obtained from the pits.
>
> Averaging would also reduce the size of the EMI data set which at the
> moment is too big for ordinary kriging in GSTAT.
>   
I assume you did not set a local neighbourhood for kriging? It seems to 
work for me, but takes indeed almost 2 Gb of RAM,
 > 15000^2*8
[1] 1.8e+09
bytes are needed for the single full covariance matrix alone.
> Can this be done with a few lines of code?
>   
use gstat with a maxdist (search radius) of 2 to 5 m, and a pure nugget
variogram vgm(1, "Nug", 0) and you'll get the arithmetic mean of the data
within the search radius.

hth,
--
Edzer
> Regards
>
> _________________________________
> Karl J Sommer,
> Department of Primary Industries,
> Catchment & Agriculture Services,
> PO Box 905
> Mildura, VIC, Australia 3502
>
> Tel: +61 (0)3 5051 4390
> Fax +61 (0)3 5051 4534
>
> Email:     karl.sommer at dpi.vic.gov.au
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



From Roy.Philippe at ouranos.ca  Thu Aug 24 19:25:48 2006
From: Roy.Philippe at ouranos.ca (Philippe Roy)
Date: Thu, 24 Aug 2006 13:25:48 -0400
Subject: [R-sig-Geo] Mass conversions of Lat/Long to UTM (many zone)
Message-ID: <B114F711FB1C3247AABAF298491DA8242E357A@climat.ouranos.ca>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20060824/981fabad/attachment.pl>

From Roger.Bivand at nhh.no  Thu Aug 24 21:28:28 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 24 Aug 2006 21:28:28 +0200 (CEST)
Subject: [R-sig-Geo] Mass conversions of Lat/Long to UTM (many zone)
In-Reply-To: <B114F711FB1C3247AABAF298491DA8242E357A@climat.ouranos.ca>
Message-ID: <Pine.LNX.4.44.0608242114230.17874-100000@reclus.nhh.no>

On Thu, 24 Aug 2006, Philippe Roy wrote:

> Hi everyone!  I'm new to R.  I'll try using it for some Kriging.  My aim
> in the short-term is to convert my 2300 stations database from lat-long
> to UTM.  This network of stations goes from Virginia to the south, to
> Montr?al to the north, east coast to Michigan in the west.  So, I have a
> lot of UTM zones to consider.
> 
>  
> 
> Reading the archives, I've seen this formula to calculate the zones,
> based on lat-long coordinates :
> 
>  
> 
> UTM = floor((lon + 180) / 6) + 1
> 
>  
> 
> So, if I understand correctly, I need to run this formula on each
> station to get their zone, abnd then I use something like convUL ?
> 

If you want to use all the stations together, then they must be in the 
same zone (otherwise the western edge of the zone will jump for stations 
in different zones). I think that for continental North America a central 
UTM zone will not be a very good idea, and that probably a Lambert 
Azimuthal Equal Area is a better choice.

You can then use project() or spTransform() in the rgdal package, for 
example, with EPSG code 2163:

US National Atlas Equal Area

+proj=laea +lat_0=45 +lon_0=-100 +x_0=0 +y_0=0 +a=6370997 +b=6370997 +units=m

with some modification of +lat_0 and +lon_0 to suit your region.

> 
> 	[[alternative HTML version deleted]]
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From mzh at ualberta.ca  Fri Aug 25 00:29:16 2006
From: mzh at ualberta.ca (mzh at ualberta.ca)
Date: Thu, 24 Aug 2006 16:29:16 -0600
Subject: [R-sig-Geo] Spatial Panel data, random effects model
In-Reply-To: <Pine.LNX.4.44.0608242114230.17874-100000@reclus.nhh.no>
References: <Pine.LNX.4.44.0608242114230.17874-100000@reclus.nhh.no>
Message-ID: <20060824162916.pczje6d2s8gowcgg@webmail.ualberta.ca>

Does any one know if I can use R to run a spatial panel randome effects model?
Any references please???


Michael
Canada



From e.pebesma at geo.uu.nl  Fri Aug 25 08:35:04 2006
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Fri, 25 Aug 2006 08:35:04 +0200
Subject: [R-sig-Geo] Spatial Panel data, random effects model
In-Reply-To: <20060824162916.pczje6d2s8gowcgg@webmail.ualberta.ca>
References: <Pine.LNX.4.44.0608242114230.17874-100000@reclus.nhh.no>
	<20060824162916.pczje6d2s8gowcgg@webmail.ualberta.ca>
Message-ID: <44EE9A18.6020402@geo.uu.nl>

mzh at ualberta.ca wrote:
> Does any one know if I can use R to run a spatial panel randome effects model?
> Any references please???
>
>
> Michael
> Canada
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   
Package nmle, iirc,  allows for mixed effects and spatial covariance terms.
--
Edzer



From e.pebesma at geo.uu.nl  Fri Aug 25 09:54:11 2006
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Fri, 25 Aug 2006 09:54:11 +0200
Subject: [R-sig-Geo] problem assigning POSIX class to AttributeList column
Message-ID: <44EEACA3.10002@geo.uu.nl>

Mike, in reaction to 
https://stat.ethz.ch/pipermail/r-sig-geo/2006-July/001189.html

on http://www.geog.uu.nl/~pebesma/sp_0.9-0.tar.gz  I prepared an sp 
version where the data slot for storing attribute data of classes 
SpatialPointsDataFrame, SpatialGridDataFrame and SpatialPixelsDataFrame 
is (again) a genuine data.frame (this used to the the AttributeList). 
There's little point in further developing the AttributeList class as 
the problems we had with the data.frame class -- excessive memory, disk 
and CPU usage for creating huge character row.names vectors, see e.g. 
the little example in the R-News 5/2 -- have been solved in R 2.4.0; see 
https://stat.ethz.ch/pipermail/r-devel/2006-April/037306.html

The upgrade to 2.4.0 seems to be binary incompatible for S4 objects, so 
that may be a good moment to make this binary incompatible change in sp 
(see https://stat.ethz.ch/pipermail/r-devel/2006-August/038811.html). In 
general, we do recommend sp users to always keep the scripts that 
generate or manipulate their data.

You, or others, may want to use it, along with R 2.3.1 or 2.4.0 to solve 
your current problem.

Best regards,
--
Edzer



From maechler at stat.math.ethz.ch  Fri Aug 25 17:19:13 2006
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Fri, 25 Aug 2006 17:19:13 +0200
Subject: [R-sig-Geo] problem assigning POSIX class to AttributeList
	column
In-Reply-To: <44EEACA3.10002@geo.uu.nl>
References: <44EEACA3.10002@geo.uu.nl>
Message-ID: <17647.5361.602928.526089@stat.math.ethz.ch>

>>>>> "Edzer" == Edzer J Pebesma <e.pebesma at geo.uu.nl>
>>>>>     on Fri, 25 Aug 2006 09:54:11 +0200 writes:

    Edzer> Mike, in reaction to
    Edzer> https://stat.ethz.ch/pipermail/r-sig-geo/2006-July/001189.html

    Edzer> on http://www.geog.uu.nl/~pebesma/sp_0.9-0.tar.gz I
    Edzer> prepared an sp version where the data slot for
    Edzer> storing attribute data of classes
    Edzer> SpatialPointsDataFrame, SpatialGridDataFrame and
    Edzer> SpatialPixelsDataFrame is (again) a genuine
    Edzer> data.frame (this used to the the AttributeList).
    Edzer> There's little point in further developing the
    Edzer> AttributeList class as the problems we had with the
    Edzer> data.frame class -- excessive memory, disk and CPU
    Edzer> usage for creating huge character row.names vectors,
    Edzer> see e.g.  the little example in the R-News 5/2 --
    Edzer> have been solved in R 2.4.0; see
    Edzer> https://stat.ethz.ch/pipermail/r-devel/2006-April/037306.html

    Edzer> The upgrade to 2.4.0 seems to be binary incompatible
    Edzer> for S4 objects, 

well, 'yes'  if "binary incompatible" means that S4 objects saved
in older versions of R are not quite what they are when you
recreate them in R devel (2.4.0 to be).
I.e. if they belong to your package and are saved as <pkg>/data/<foo>.rda
you'll want recreate them eventually 
and then have your package depend on R 2.4.0 -- which is a bit
undesirable, unless you are willing to maintain too parallel
versions of your package, one for R <= 2.3.x, and another for
(current) R-devel and newer.

For the 'Matrix' package, we decided for the time being to use
./data/*.R scripts reading ./external/*.rda files which contain
the raw data and then recreate our S4 data objects at data load time.  

This has the one advantage that it does not depend on R versions
and even still works if we slightly change class definitions.


    Edzer> so that may be a good moment to make
    Edzer> this binary incompatible change in sp (see
    Edzer> https://stat.ethz.ch/pipermail/r-devel/2006-August/038811.html). In
    Edzer> general, we do recommend sp users to always keep the
    Edzer> scripts that generate or manipulate their data.

Indeed!  And that recommendation goes for all of using R, not
just "geo"-like use.

    Edzer> You, or others, may want to use it, along with R
    Edzer> 2.3.1 or 2.4.0 to solve your current problem.

    Edzer> Best regards, -- Edzer

    Edzer> _______________________________________________
    Edzer> R-sig-Geo mailing list R-sig-Geo at stat.math.ethz.ch
    Edzer> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From maechler at stat.math.ethz.ch  Fri Aug 25 17:19:18 2006
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Fri, 25 Aug 2006 17:19:18 +0200
Subject: [R-sig-Geo] problem assigning POSIX class to AttributeList
	column
In-Reply-To: <44EEACA3.10002@geo.uu.nl>
References: <44EEACA3.10002@geo.uu.nl>
Message-ID: <17647.5366.180916.103160@stat.math.ethz.ch>

>>>>> "Edzer" == Edzer J Pebesma <e.pebesma at geo.uu.nl>
>>>>>     on Fri, 25 Aug 2006 09:54:11 +0200 writes:

    Edzer> Mike, in reaction to
    Edzer> https://stat.ethz.ch/pipermail/r-sig-geo/2006-July/001189.html

    Edzer> on http://www.geog.uu.nl/~pebesma/sp_0.9-0.tar.gz I
    Edzer> prepared an sp version where the data slot for
    Edzer> storing attribute data of classes
    Edzer> SpatialPointsDataFrame, SpatialGridDataFrame and
    Edzer> SpatialPixelsDataFrame is (again) a genuine
    Edzer> data.frame (this used to the the AttributeList).
    Edzer> There's little point in further developing the
    Edzer> AttributeList class as the problems we had with the
    Edzer> data.frame class -- excessive memory, disk and CPU
    Edzer> usage for creating huge character row.names vectors,
    Edzer> see e.g.  the little example in the R-News 5/2 --
    Edzer> have been solved in R 2.4.0; see
    Edzer> https://stat.ethz.ch/pipermail/r-devel/2006-April/037306.html

    Edzer> The upgrade to 2.4.0 seems to be binary incompatible
    Edzer> for S4 objects, 

well, 'yes'  if "binary incompatible" means that S4 objects saved
in older versions of R are not quite what they are when you
recreate them in R devel (2.4.0 to be).
I.e. if they belong to your package and are saved as <pkg>/data/<foo>.rda
you'll want recreate them eventually 
and then have your package depend on R 2.4.0 -- which is a bit
undesirable, unless you are willing to maintain too parallel
versions of your package, one for R <= 2.3.x, and another for
(current) R-devel and newer.

For the 'Matrix' package, we decided for the time being to use
./data/*.R scripts reading ./external/*.rda files which contain
the raw data and then recreate our S4 data objects at data load time.  

This has the one advantage that it does not depend on R versions
and even still works if we slightly change class definitions.


    Edzer> so that may be a good moment to make
    Edzer> this binary incompatible change in sp (see
    Edzer> https://stat.ethz.ch/pipermail/r-devel/2006-August/038811.html). In
    Edzer> general, we do recommend sp users to always keep the
    Edzer> scripts that generate or manipulate their data.

Indeed!  And that recommendation goes for all of using R, not
just "geo"-like use.

    Edzer> You, or others, may want to use it, along with R
    Edzer> 2.3.1 or 2.4.0 to solve your current problem.

    Edzer> Best regards, -- Edzer

    Edzer> _______________________________________________
    Edzer> R-sig-Geo mailing list R-sig-Geo at stat.math.ethz.ch
    Edzer> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From maechler at stat.math.ethz.ch  Fri Aug 25 17:19:32 2006
From: maechler at stat.math.ethz.ch (Martin Maechler)
Date: Fri, 25 Aug 2006 17:19:32 +0200
Subject: [R-sig-Geo] problem assigning POSIX class to AttributeList
	column
In-Reply-To: <44EEACA3.10002@geo.uu.nl>
References: <44EEACA3.10002@geo.uu.nl>
Message-ID: <17647.5380.498766.875231@stat.math.ethz.ch>

>>>>> "Edzer" == Edzer J Pebesma <e.pebesma at geo.uu.nl>
>>>>>     on Fri, 25 Aug 2006 09:54:11 +0200 writes:

    Edzer> Mike, in reaction to
    Edzer> https://stat.ethz.ch/pipermail/r-sig-geo/2006-July/001189.html

    Edzer> on http://www.geog.uu.nl/~pebesma/sp_0.9-0.tar.gz I
    Edzer> prepared an sp version where the data slot for
    Edzer> storing attribute data of classes
    Edzer> SpatialPointsDataFrame, SpatialGridDataFrame and
    Edzer> SpatialPixelsDataFrame is (again) a genuine
    Edzer> data.frame (this used to the the AttributeList).
    Edzer> There's little point in further developing the
    Edzer> AttributeList class as the problems we had with the
    Edzer> data.frame class -- excessive memory, disk and CPU
    Edzer> usage for creating huge character row.names vectors,
    Edzer> see e.g.  the little example in the R-News 5/2 --
    Edzer> have been solved in R 2.4.0; see
    Edzer> https://stat.ethz.ch/pipermail/r-devel/2006-April/037306.html

    Edzer> The upgrade to 2.4.0 seems to be binary incompatible
    Edzer> for S4 objects, 

well, 'yes'  if "binary incompatible" means that S4 objects saved
in older versions of R are not quite what they are when you
recreate them in R devel (2.4.0 to be).
I.e. if they belong to your package and are saved as <pkg>/data/<foo>.rda
you'll want recreate them eventually 
and then have your package depend on R 2.4.0 -- which is a bit
undesirable, unless you are willing to maintain too parallel
versions of your package, one for R <= 2.3.x, and another for
(current) R-devel and newer.

For the 'Matrix' package, we decided for the time being to use
./data/*.R scripts reading ./external/*.rda files which contain
the raw data and then recreate our S4 data objects at data load time.  

This has the one advantage that it does not depend on R versions
and even still works if we slightly change class definitions.


    Edzer> so that may be a good moment to make
    Edzer> this binary incompatible change in sp (see
    Edzer> https://stat.ethz.ch/pipermail/r-devel/2006-August/038811.html). In
    Edzer> general, we do recommend sp users to always keep the
    Edzer> scripts that generate or manipulate their data.

Indeed!  And that recommendation goes for all of using R, not
just "geo"-like use.

    Edzer> You, or others, may want to use it, along with R
    Edzer> 2.3.1 or 2.4.0 to solve your current problem.

    Edzer> Best regards, -- Edzer

    Edzer> _______________________________________________
    Edzer> R-sig-Geo mailing list R-sig-Geo at stat.math.ethz.ch
    Edzer> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From Roy.Philippe at ouranos.ca  Fri Aug 25 17:22:02 2006
From: Roy.Philippe at ouranos.ca (Philippe Roy)
Date: Fri, 25 Aug 2006 11:22:02 -0400
Subject: [R-sig-Geo] RE :  Mass conversions of Lat/Long to UTM (many zone)
Message-ID: <B114F711FB1C3247AABAF298491DA82490051E@climat.ouranos.ca>


-----Message d'origine-----
De?: Roger Bivand [mailto:Roger.Bivand at nhh.no] 
Envoy??: 24 ao?t 2006 15:28
??: Philippe Roy
Cc?: r-sig-geo at stat.math.ethz.ch
Objet?: Re: [R-sig-Geo] Mass conversions of Lat/Long to UTM (many zone)

On Thu, 24 Aug 2006, Philippe Roy wrote:

> Hi everyone!  I'm new to R.  I'll try using it for some Kriging.  My aim
> in the short-term is to convert my 2300 stations database from lat-long
> to UTM.  This network of stations goes from Virginia to the south, to
> Montr?al to the north, east coast to Michigan in the west.  So, I have a
> lot of UTM zones to consider.
> 
>  
> 
> Reading the archives, I've seen this formula to calculate the zones,
> based on lat-long coordinates :
> 
>  
> 
> UTM = floor((lon + 180) / 6) + 1
> 
>  
> 
> So, if I understand correctly, I need to run this formula on each
> station to get their zone, abnd then I use something like convUL ?
> 

If you want to use all the stations together, then they must be in the 
same zone (otherwise the western edge of the zone will jump for stations 
in different zones). I think that for continental North America a central 
UTM zone will not be a very good idea, and that probably a Lambert 
Azimuthal Equal Area is a better choice.

You can then use project() or spTransform() in the rgdal package, for 
example, with EPSG code 2163:

US National Atlas Equal Area

+proj=laea +lat_0=45 +lon_0=-100 +x_0=0 +y_0=0 +a=6370997 +b=6370997 +units=m

with some modification of +lat_0 and +lon_0 to suit your region.

> 
> 	[[alternative HTML version deleted]]
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


Ok, so, in my kriging code, I need to specify a maximum distance in km (or meter can't remember).  Is this Lambert Azimuthal Equal Area good for Euclidian distance?  I mean, I need to specify the maximum distance to consider a station or not for each grid point of my regular grid.  Would that be good then?

Sorry if it sounds non-understandable! :/



From Roger.Bivand at nhh.no  Fri Aug 25 18:28:33 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 25 Aug 2006 18:28:33 +0200 (CEST)
Subject: [R-sig-Geo] RE : Mass conversions of Lat/Long to UTM (many zone)
In-Reply-To: <B114F711FB1C3247AABAF298491DA82490051E@climat.ouranos.ca>
Message-ID: <Pine.LNX.4.44.0608251823360.19440-100000@reclus.nhh.no>

On Fri, 25 Aug 2006, Philippe Roy wrote:

"Ok, so, in my kriging code, I need to specify a maximum distance in km
(or meter can't remember).  Is this Lambert Azimuthal Equal Area good for
Euclidian distance?  I mean, I need to specify the maximum distance to
consider a station or not for each grid point of my regular grid.  Would
that be good then?

Sorry if it sounds non-understandable! :/ "

(and using an HTML mailer - please do not, it makes thread management very 
difficult!)

Have you tried? (Hint: the metric is meters/metres). Yes, you can give a
maximum distance, otherwise the 2300 by 2300 martix of distances between
stations is unnecessarily large (and it is unlikely that interactions
across the whole region are strong).
                         


> 
> -----Message d'origine-----
> De?: Roger Bivand [mailto:Roger.Bivand at nhh.no] 
> Envoy??: 24 ao?t 2006 15:28
> ??: Philippe Roy
> Cc?: r-sig-geo at stat.math.ethz.ch
> Objet?: Re: [R-sig-Geo] Mass conversions of Lat/Long to UTM (many zone)
> 
> On Thu, 24 Aug 2006, Philippe Roy wrote:
> 
> > Hi everyone!  I'm new to R.  I'll try using it for some Kriging.  My aim
> > in the short-term is to convert my 2300 stations database from lat-long
> > to UTM.  This network of stations goes from Virginia to the south, to
> > Montr?al to the north, east coast to Michigan in the west.  So, I have a
> > lot of UTM zones to consider.
> > 
> >  
> > 
> > Reading the archives, I've seen this formula to calculate the zones,
> > based on lat-long coordinates :
> > 
> >  
> > 
> > UTM = floor((lon + 180) / 6) + 1
> > 
> >  
> > 
> > So, if I understand correctly, I need to run this formula on each
> > station to get their zone, abnd then I use something like convUL ?
> > 
> 
> If you want to use all the stations together, then they must be in the 
> same zone (otherwise the western edge of the zone will jump for stations 
> in different zones). I think that for continental North America a central 
> UTM zone will not be a very good idea, and that probably a Lambert 
> Azimuthal Equal Area is a better choice.
> 
> You can then use project() or spTransform() in the rgdal package, for 
> example, with EPSG code 2163:
> 
> US National Atlas Equal Area
> 
> +proj=laea +lat_0=45 +lon_0=-100 +x_0=0 +y_0=0 +a=6370997 +b=6370997 +units=m
> 
> with some modification of +lat_0 and +lon_0 to suit your region.
> 
> > 
> > 	[[alternative HTML version deleted]]
> > 
> > 
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From zev at zevross.com  Fri Aug 25 20:33:22 2006
From: zev at zevross.com (Zev Ross)
Date: Fri, 25 Aug 2006 14:33:22 -0400
Subject: [R-sig-Geo] Mass conversions of Lat/Long to UTM (many zone)
Message-ID: <44EF4272.7030708@zevross.com>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20060825/3d907d5a/attachment.html>

From tkobayas at indiana.edu  Fri Aug 25 22:18:16 2006
From: tkobayas at indiana.edu (tkobayas at indiana.edu)
Date: Fri, 25 Aug 2006 16:18:16 -0400
Subject: [R-sig-Geo] create a grid data
Message-ID: <20060825161816.o9hn047k04c80gs0@webmail.iu.edu>

Dear R users-


I have a dataset that has X, Y and other values (Zs) attached to points 
(X,Y). To show a map of this dataset, a matrix of Zs should be created 
because I would like to use filled.contour function.

Is there any recommendation to go about this?

Thanks you very much

Taka
R-2.3.1



From Roger.Bivand at nhh.no  Fri Aug 25 22:36:50 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 25 Aug 2006 22:36:50 +0200 (CEST)
Subject: [R-sig-Geo] create a grid data
In-Reply-To: <20060825161816.o9hn047k04c80gs0@webmail.iu.edu>
Message-ID: <Pine.LNX.4.44.0608252233450.19440-100000@reclus.nhh.no>

On Fri, 25 Aug 2006 tkobayas at indiana.edu wrote:

> Dear R users-
> 
> 
> I have a dataset that has X, Y and other values (Zs) attached to points 
> (X,Y). To show a map of this dataset, a matrix of Zs should be created 
> because I would like to use filled.contour function.

Do your x,y coordinates form a grid, or are they irregularly spaced? If 
so, you need to interpolate to a grid, for example using interp() in the 
akima package.

> 
> Is there any recommendation to go about this?
> 
> Thanks you very much
> 
> Taka
> R-2.3.1
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From mdsumner at utas.edu.au  Wed Aug 30 09:17:07 2006
From: mdsumner at utas.edu.au (Michael Sumner)
Date: Wed, 30 Aug 2006 17:17:07 +1000
Subject: [R-sig-Geo] package for writing shapefiles from SpatialPolygons ?
In-Reply-To: <OF52105C1D.CE0E57E5-ONCA2571D3.00140D3F-CA2571D3.001E6F0E@nre.vic.gov.au>
References: <OF52105C1D.CE0E57E5-ONCA2571D3.00140D3F-CA2571D3.001E6F0E@nre.vic.gov.au>
Message-ID: <44F53B73.8070502@utas.edu.au>

Hello, I'm sorry but I have lost track of how this is to be done. Any 
vector format would do, but I guess shapefiles are the most obvious.

 Is there a "spmaptools" package somewhere for doing this?
I can't find it.

Otherwise, how can I convert a "SpatialPolygons" object to a "polylist" 
(for writing by maptools)?

Sorry if this is documented somewhere, but it's one of those things I 
had assumed could done and have only just attempted to find out how.

Cheers, Mike.



From Roger.Bivand at nhh.no  Wed Aug 30 09:56:29 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 30 Aug 2006 09:56:29 +0200 (CEST)
Subject: [R-sig-Geo] package for writing shapefiles from SpatialPolygons
 ?
In-Reply-To: <44F53B73.8070502@utas.edu.au>
Message-ID: <Pine.LNX.4.44.0608300953570.5562-100000@reclus.nhh.no>

On Wed, 30 Aug 2006, Michael Sumner wrote:

> Hello, I'm sorry but I have lost track of how this is to be done. Any 
> vector format would do, but I guess shapefiles are the most obvious.
> 
>  Is there a "spmaptools" package somewhere for doing this?
> I can't find it.

It is included in the maptools package now - the writePolyShape() function
is the one you are looking for. If you also need to write a *.prj, use
showWKT() in the rgdal package. Code is getting ahead of documentation 
here ...

Roger

> 
> Otherwise, how can I convert a "SpatialPolygons" object to a "polylist" 
> (for writing by maptools)?
> 
> Sorry if this is documented somewhere, but it's one of those things I 
> had assumed could done and have only just attempted to find out how.
> 
> Cheers, Mike.
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From cmbarker at ucdavis.edu  Wed Aug 30 22:42:40 2006
From: cmbarker at ucdavis.edu (Chris Barker)
Date: Wed, 30 Aug 2006 13:42:40 -0700
Subject: [R-sig-Geo] Handling realisations in geoRglm
Message-ID: <44F5F840.3010403@ucdavis.edu>

Dear R users:

I want to model mosquito count data based on landcover attributes and 
meteorological variables using a Poisson GLSM in the geoRglm package.  I 
have monthly mosquito counts over more than 20 years with repeated 
observations from individual trap sites over time.  I have used 
as.geodata() to successfully read my dataset into the geodata format 
utilized by geoR and geoRglm, including specification of the 
realisations.  (I know the realisations have been specified correctly 
because I can get data summaries by realisation from the geodata 
object.)  However, after reading the packages' documentation and 
searching the mailing lists and other sources, it seems that the 
functions in geoRglm do not acknowledge the existence of multiple 
realisations per site.  I see that the likfit() function in geoR has an 
argument for realisations, but I cannot find anything similar in 
geoRglm.  Is it possible to model data with repeated realisations from 
the same sites using geoRglm?  If so, how can this be done and is there 
a way to model dependence among the realisations over time?

Thank you,
Chris Barker
Ph.D. Candidate
University of California, Davis
cmbarker at ucdavis.edu



From mdsumner at utas.edu.au  Thu Aug 31 01:07:50 2006
From: mdsumner at utas.edu.au (Michael Sumner)
Date: Thu, 31 Aug 2006 09:07:50 +1000
Subject: [R-sig-Geo] package for writing shapefiles from SpatialPolygons?
In-Reply-To: <Pine.LNX.4.44.0608300953570.5562-100000@reclus.nhh.no>
References: <Pine.LNX.4.44.0608300953570.5562-100000@reclus.nhh.no>
Message-ID: <44F61A46.4010102@utas.edu.au>


> It is included in the maptools package now - the writePolyShape() function
> is the one you are looking for. If you also need to write a *.prj, use
>   

Ah, thanks.  But how do I convert an "SpatialPolygons" object, or even 
the @polygons list to a "polylist"?

Sorry . . . an example?

Cheers, Mike.



From paulojus at c3sl.ufpr.br  Thu Aug 31 05:53:51 2006
From: paulojus at c3sl.ufpr.br (Paulo Justiniano Ribeiro Jr)
Date: Thu, 31 Aug 2006 00:53:51 -0300 (BRT)
Subject: [R-sig-Geo] Handling realisations in geoRglm
In-Reply-To: <44F5F840.3010403@ucdavis.edu>
References: <44F5F840.3010403@ucdavis.edu>
Message-ID: <Pine.LNX.4.58.0608310051030.25679@macalan.c3sl.ufpr.br>

Chris

I'm afraid with the current implementation the answers are no and no ...
geoRglm cannot handle realisations as geoR does (e.g. considering
different years as independent replications of the process).

Furthermore neither geoR nor geoRglm can fit spatial-temporal models
(with both, space and time dependence)
RandomFields can do this but, to my knowledge, only for Gaussian data

best
P.J.


On Wed, 30 Aug 2006, Chris Barker wrote:

> Dear R users:
>
> I want to model mosquito count data based on landcover attributes and
> meteorological variables using a Poisson GLSM in the geoRglm package.  I
> have monthly mosquito counts over more than 20 years with repeated
> observations from individual trap sites over time.  I have used
> as.geodata() to successfully read my dataset into the geodata format
> utilized by geoR and geoRglm, including specification of the
> realisations.  (I know the realisations have been specified correctly
> because I can get data summaries by realisation from the geodata
> object.)  However, after reading the packages' documentation and
> searching the mailing lists and other sources, it seems that the
> functions in geoRglm do not acknowledge the existence of multiple
> realisations per site.  I see that the likfit() function in geoR has an
> argument for realisations, but I cannot find anything similar in
> geoRglm.  Is it possible to model data with repeated realisations from
> the same sites using geoRglm?  If so, how can this be done and is there
> a way to model dependence among the realisations over time?
>
> Thank you,
> Chris Barker
> Ph.D. Candidate
> University of California, Davis
> cmbarker at ucdavis.edu
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



From Roger.Bivand at nhh.no  Thu Aug 31 08:56:26 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 31 Aug 2006 08:56:26 +0200 (CEST)
Subject: [R-sig-Geo] package for writing shapefiles from SpatialPolygons?
In-Reply-To: <44F61A46.4010102@utas.edu.au>
Message-ID: <Pine.LNX.4.44.0608310843430.5945-100000@reclus.nhh.no>

On Thu, 31 Aug 2006, Michael Sumner wrote:

> 
> > It is included in the maptools package now - the writePolyShape() function
> > is the one you are looking for. If you also need to write a *.prj, use
> >   
> 
> Ah, thanks.  But how do I convert an "SpatialPolygons" object, or even 
> the @polygons list to a "polylist"?
> 
> Sorry . . . an example?

What is a shapefile? It has a *.shp, a *.shx, _and_ a *.dbf at least. So 
you can't go from a SpatialPolygons object to a shapefile, it has to be 
SpatialPolygonsDataFrame, even if the only column in the data frame is 
just a holder. So create a data frame (with row names equal to the 
Polygons ID values), make a SpatialPolygonsDataFrame, and 
writePolyShape().

library(maptools)
xx <- readShapePoly(system.file("shapes/sids.shp", package="maptools")[1], 
  IDvar="FIPSNO", proj4string=CRS("+proj=longlat +ellps=clrk66"))
SPxx <- as(xx, "SpatialPolygons")
class(SPxx)
IDs <- sapply(slot(SPxx, "polygons"), function(x) slot(x, "ID"))
df <- data.frame(rep(0, length(IDs)), row.names=IDs)
SPDFxx <- SpatialPolygonsDataFrame(SPxx, df)
class(SPDFxx)
summary(SPDFxx)
tf <- tempfile()
writePolyShape(SPDFxx, tf)
getinfo.shape(tf)

The conversion stuff is probably irrelevant, it is internal and subject to 
change. It's in the source if you do need it. 

Roger

> 
> Cheers, Mike.
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From mdsumner at utas.edu.au  Thu Aug 31 10:33:35 2006
From: mdsumner at utas.edu.au (Michael Sumner)
Date: Thu, 31 Aug 2006 18:33:35 +1000
Subject: [R-sig-Geo] package for writing shapefiles from SpatialPolygons?
In-Reply-To: <Pine.LNX.4.44.0608310843430.5945-100000@reclus.nhh.no>
References: <Pine.LNX.4.44.0608310843430.5945-100000@reclus.nhh.no>
Message-ID: <44F69EDF.2070605@utas.edu.au>


> What is a shapefile? It has a *.shp, a *.shx, _and_ a *.dbf at least. So 
> you can't go from a SpatialPolygons object to a shapefile, it has to be 
> SpatialPolygonsDataFrame, even if the only column in the data frame is 
> just a holder. So create a data frame (with row names equal to the 
> Polygons ID values), make a SpatialPolygonsDataFrame, and 
> writePolyShape().
>   

Oh sorry, I had missed that "writePolyShape" function.  It's aliased to 
its read counterpart, and I thought I was seeing write.polylistShape.

Thanks!



From Roger.Bivand at nhh.no  Thu Aug 31 10:50:58 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 31 Aug 2006 10:50:58 +0200 (CEST)
Subject: [R-sig-Geo] package for writing shapefiles from SpatialPolygons?
In-Reply-To: <44F69EDF.2070605@utas.edu.au>
Message-ID: <Pine.LNX.4.44.0608311049360.5945-100000@reclus.nhh.no>

On Thu, 31 Aug 2006, Michael Sumner wrote:

> 
> > What is a shapefile? It has a *.shp, a *.shx, _and_ a *.dbf at least. So 
> > you can't go from a SpatialPolygons object to a shapefile, it has to be 
> > SpatialPolygonsDataFrame, even if the only column in the data frame is 
> > just a holder. So create a data frame (with row names equal to the 
> > Polygons ID values), make a SpatialPolygonsDataFrame, and 
> > writePolyShape().
> >   
> 
> Oh sorry, I had missed that "writePolyShape" function.  It's aliased to 
> its read counterpart, and I thought I was seeing write.polylistShape.

I'll split it out if you like - in the help.start() browser based help 
system, each alias is listed separately, so you would have seen it there.

> 
> Thanks!
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From cmbarker at ucdavis.edu  Thu Aug 31 18:22:34 2006
From: cmbarker at ucdavis.edu (Chris Barker)
Date: Thu, 31 Aug 2006 09:22:34 -0700
Subject: [R-sig-Geo] Handling realisations in geoRglm
In-Reply-To: <Pine.LNX.4.58.0608310051030.25679@macalan.c3sl.ufpr.br>
References: <44F5F840.3010403@ucdavis.edu>
	<Pine.LNX.4.58.0608310051030.25679@macalan.c3sl.ufpr.br>
Message-ID: <44F70CCA.7090207@ucdavis.edu>

Dear Dr. Ribeiro and Dr. Christensen,

Thanks very much to both of you for your replies.  Your answers are a 
big help, even if the answer is no.  I'll continue my search for a 
package to analyze my data, and if realisations are ever accommodated in 
geoRglm, I'd love to revisit this.

Thanks again,
Chris


Paulo Justiniano Ribeiro Jr wrote:
> Chris
>
> I'm afraid with the current implementation the answers are no and no ...
> geoRglm cannot handle realisations as geoR does (e.g. considering
> different years as independent replications of the process).
>
> Furthermore neither geoR nor geoRglm can fit spatial-temporal models
> (with both, space and time dependence)
> RandomFields can do this but, to my knowledge, only for Gaussian data
>
> best
> P.J.
>
>
> On Wed, 30 Aug 2006, Chris Barker wrote:
>
>   
>> Dear R users:
>>
>> I want to model mosquito count data based on landcover attributes and
>> meteorological variables using a Poisson GLSM in the geoRglm package.  I
>> have monthly mosquito counts over more than 20 years with repeated
>> observations from individual trap sites over time.  I have used
>> as.geodata() to successfully read my dataset into the geodata format
>> utilized by geoR and geoRglm, including specification of the
>> realisations.  (I know the realisations have been specified correctly
>> because I can get data summaries by realisation from the geodata
>> object.)  However, after reading the packages' documentation and
>> searching the mailing lists and other sources, it seems that the
>> functions in geoRglm do not acknowledge the existence of multiple
>> realisations per site.  I see that the likfit() function in geoR has an
>> argument for realisations, but I cannot find anything similar in
>> geoRglm.  Is it possible to model data with repeated realisations from
>> the same sites using geoRglm?  If so, how can this be done and is there
>> a way to model dependence among the realisations over time?
>>
>> Thank you,
>> Chris Barker
>> Ph.D. Candidate
>> University of California, Davis
>> cmbarker at ucdavis.edu
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>     
>
>   

-- 


Chris Barker
Ph.D. Candidate
Department of Entomology
Mailing Address: 
Center for Vectorborne Diseases
University of California
Old Davis Road
Davis, CA  95616
Phone: 530-752-0151
Fax: 530-754-6360
E-mail: cmbarker at ucdavis.edu

-------------- next part --------------
A non-text attachment was scrubbed...
Name: cmbarker.vcf
Type: text/x-vcard
Size: 301 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20060831/a4ccca12/attachment.vcf>

