From gianni.lavaredo at gmail.com  Wed Apr  1 02:24:40 2009
From: gianni.lavaredo at gmail.com (gianni lavaredo)
Date: Wed, 1 Apr 2009 02:24:40 +0200
Subject: [R-sig-Geo] I NEED Help with this spatial polygon problems (REALLY)
	Thanks really thanks
Message-ID: <518dff330903311724m364e5f70v4ac57a68b480e81d@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090401/5e4c9adc/attachment.pl>

From prairie.picker at gmail.com  Wed Apr  1 03:40:15 2009
From: prairie.picker at gmail.com (Tyler Dean Rudolph)
Date: Tue, 31 Mar 2009 21:40:15 -0400
Subject: [R-sig-Geo] Importing subsets of an ASCII file
Message-ID: <9fb1ae890903311840t52b4a053x630b3dae2934b0e1@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090331/8bd8c880/attachment.pl>

From ksafi at orn.mpg.de  Wed Apr  1 08:21:43 2009
From: ksafi at orn.mpg.de (Kamran Safi)
Date: Wed, 01 Apr 2009 08:21:43 +0200
Subject: [R-sig-Geo] Importing subsets of an ASCII file
In-Reply-To: <9fb1ae890903311840t52b4a053x630b3dae2934b0e1@mail.gmail.com>
References: <9fb1ae890903311840t52b4a053x630b3dae2934b0e1@mail.gmail.com>
Message-ID: <49D307F7.8030908@orn.mpg.de>

Hi Tyler,

sounds as if you need to look into raster{}. Checkout 
http://r-forge.r-project.org/projects/raster/

hope this helps.

Kamran

Tyler Dean Rudolph schrieb:
> I have yet to find a computer robust enough to import my landscape-level
> habitat data in one foul swoop (835 MB).  I tell myself once I do succeed I
> can save it as an R object, at which point it will be much smaller and
> easier to handle, but it seems another option that may be possible is to
> specify the x and y ranges of the SpatialGrid or im file I want to
> import within the import call itself, which would ideally make it easier to
> process for the average machine, at which point I could simply run a loop of
> sorts to progressively extract data for the various subregions of my study
> area.
>
> Now I've been pouring over the archives and it seems to me that earlier I
> ran across an option within some ascii import function where the x and y
> ranges can be specified.  Does this ring a bell for anyone?  It might be
> just the ticket in this type of situation.  The tif file is even bigger so
> that won't work and I'm not clear on what else would at the moment.
>
> Tyler
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>   
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/x-pkcs7-signature
Size: 3275 bytes
Desc: S/MIME Cryptographic Signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090401/5761645f/attachment.bin>

From Roger.Bivand at nhh.no  Wed Apr  1 09:19:40 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 1 Apr 2009 09:19:40 +0200 (CEST)
Subject: [R-sig-Geo] I NEED Help with this spatial polygon problems
 (REALLY) Thanks really thanks
In-Reply-To: <518dff330903311724m364e5f70v4ac57a68b480e81d@mail.gmail.com>
References: <518dff330903311724m364e5f70v4ac57a68b480e81d@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.0904010917530.456@reclus.nhh.no>

On Wed, 1 Apr 2009, gianni lavaredo wrote:

> Hey All,
>
> I have this problem and I need really help to understand (my limit) . I have
> a polygon shape file and I need to calculate some index and select the
> polygon with correct index value. I DID this with library(PBSmapping), but I
> need to obtain new polygon shapefile
>
> singleGap <- readOGR(".", "singleGap")
> # Convert the SpatialPolygonDataFrame into a PolySet object for
> compatibility
> # with the so that PBSMapping package's geospatial functions
>
> singleGapPBS <- SpatialPolygons2PolySet(singleGap)
> # Calcula AREA
> singleGap.area <- calcArea(singleGapPBS)
> str(singleGap.area)
>
> # Calcula PERIMETER
> singleGap.perimeter <- calcLength(singleGapPBS)
> str(singleGap.perimeter)
>
> singleGap.Index <-
> data.frame(singleGap.area[,c(1,3)],singleGap.perimeter[,3])
> names(singleGap.Index)[3] = "perimeter"
> str(singleGap.Index)

Which says what? Is singleGap.Index[[1]] named area? Is it a vector or a 
data frame? I think that singleGap.Index isn't what you think it is, 
meaning that singleGap.Index$area is NULL, and subsetting will not work.

Roger

>
> singleGap.Index <- singleGap.Index[singleGap.Index$area >= 5
> |singleGap.Index$area < 1000,]
> NOW I TRYING SEVERAL METHOD BUT NOTHING. Thank, really thanks
>
> Gianni
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Adrian.Baddeley at csiro.au  Wed Apr  1 11:13:12 2009
From: Adrian.Baddeley at csiro.au (Adrian.Baddeley at csiro.au)
Date: Wed, 1 Apr 2009 17:13:12 +0800
Subject: [R-sig-Geo] Issues importing BIG shapefile
Message-ID: <57DC18C299094D4299F837570C5DF1C50293EAB568@EXWA-MBX01.nexus.csiro.au>

Tyler Dean Rudolph prairie.picker at gmail.com<mailto:prairie.picker at gmail.com> encountered problems converting data from class 'SpatialLinesDataFrame' (package sp) to class 'psp' (package spatstat). For very large shapefiles (containing a quarter of a million line segments), this conversion was taking 24 hours on a desktop.

The code involved is in the packages 'maptools' and 'spatstat'.

The main bottleneck has been fixed in the next version of spatstat (1.15-1) which has just been sent to CRAN. With this modification the same data can be converted in 5-10 minutes on a laptop.

Minor modifications to maptools have also been recommended to the maintainer of maptools.

Adrian Baddeley


From gianni.lavaredo at gmail.com  Wed Apr  1 12:21:07 2009
From: gianni.lavaredo at gmail.com (gianni lavaredo)
Date: Wed, 1 Apr 2009 12:21:07 +0200
Subject: [R-sig-Geo] I NEED Help with this spatial polygon problems
	(REALLY) Thanks really thanks
In-Reply-To: <alpine.LRH.2.00.0904010917530.456@reclus.nhh.no>
References: <518dff330903311724m364e5f70v4ac57a68b480e81d@mail.gmail.com>
	<alpine.LRH.2.00.0904010917530.456@reclus.nhh.no>
Message-ID: <518dff330904010321o70d5a7f3o64787e545851473d@mail.gmail.com>

Thanks Dott. Milton and Thanks Prof. Bivand,

Dear Prof. Bivand thanks for your attention and sorry for my not experience,
every day I learn a little step in the huge R world. I am using "PBSmapping"
because in this package there are some useful function for my study (Area,
Perimeter, etc, etc). I have my first question: Is there another package to
calculate this metrics?

I import my polygon shape-file with readOGR

> summary(singleGap)
Object of class SpatialPolygonsDataFrame
Coordinates:
         min       max
r1  268136.9  268881.3
r2 4147539.6 4147794.8
Is projected: TRUE
proj4string :
[+init=epsg:26911 +proj=utm +zone=11 +ellps=GRS80 +datum=NAD83 +units=m
+no_defs +towgs84=0,0,0]
Data attributes:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
      0       0       0       0       0       0

singlegap is a "SpatialPolygonsDataFrame". I had read that to apply
PBSmapping I need to Convert the SpatialPolygonDataFrame into a PolySet
object for compatibility. I use this code

singleGapPBS <- SpatialPolygons2PolySet(singleGap)
now  "singleGapPBS" is a PolySet and I can apply my function:

singleGap.area <- calcArea(singleGapPBS)

str(singleGap.area)
Classes ?PolyData? and 'data.frame':    839 obs. of  3 variables:
 $ PID : int  1 2 3 4 5 6 7 8 9 10 ...
 $ SID : int  1 1 1 1 1 1 1 1 1 1 ...
 $ area: num  1 4 1 1 1 1 2 48 3 9 ...
Now "singleGap.area" is a ?"PolyData" and "data.frame". Every polygon under
5 m2 is a error and I need to eliminate.

singleGap.area <- singleGap.area[singleGap.area$area >= 5,]
> str(singleGap.area)
Classes ?PolyData? and 'data.frame':    179 obs. of  3 variables:
 $ PID : int  8 10 17 21 30 33 36 40 48 49 ...
 $ SID : int  1 1 1 1 1 1 1 1 1 1 ...
 $ area: num  48 9 13 8 36 ...
here I am trying a method to convert this in an " as.PolySet" and write a
new Polygon shapefile. but this a my day limit. Sorry

Gianni





2009/4/1 Roger Bivand <Roger.Bivand at nhh.no>

> On Wed, 1 Apr 2009, gianni lavaredo wrote:
>
> Hey All,
>>
>> I have this problem and I need really help to understand (my limit) . I
>> have
>> a polygon shape file and I need to calculate some index and select the
>> polygon with correct index value. I DID this with library(PBSmapping), but
>> I
>> need to obtain new polygon shapefile
>>
>> singleGap <- readOGR(".", "singleGap")
>> # Convert the SpatialPolygonDataFrame into a PolySet object for
>> compatibility
>> # with the so that PBSMapping package's geospatial functions
>>
>> singleGapPBS <- SpatialPolygons2PolySet(singleGap)
>> # Calcula AREA
>> singleGap.area <- calcArea(singleGapPBS)
>> str(singleGap.area)
>>
>> # Calcula PERIMETER
>> singleGap.perimeter <- calcLength(singleGapPBS)
>> str(singleGap.perimeter)
>>
>> singleGap.Index <-
>> data.frame(singleGap.area[,c(1,3)],singleGap.perimeter[,3])
>> names(singleGap.Index)[3] = "perimeter"
>> str(singleGap.Index)
>>
>
> Which says what? Is singleGap.Index[[1]] named area? Is it a vector or a
> data frame? I think that singleGap.Index isn't what you think it is, meaning
> that singleGap.Index$area is NULL, and subsetting will not work.
>
> Roger
>
>
>> singleGap.Index <- singleGap.Index[singleGap.Index$area >= 5
>> |singleGap.Index$area < 1000,]
>> NOW I TRYING SEVERAL METHOD BUT NOTHING. Thank, really thanks
>>
>> Gianni
>>
>>        [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
> --
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090401/02e50642/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: singleGAP.zip
Type: application/zip
Size: 39403 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090401/02e50642/attachment.zip>

From N.A.Batchelor at sms.ed.ac.uk  Wed Apr  1 13:37:19 2009
From: N.A.Batchelor at sms.ed.ac.uk (Nicola Batchelor)
Date: Wed, 1 Apr 2009 12:37:19 +0100
Subject: [R-sig-Geo] Model Based geostatistics and covariance models
Message-ID: <E4B0C58DA42A4A3286E22F799F95C035@VCS126114>

Dear list,

 

I'm using geoRglm with the log link function and a number of covariates.
I'm having convergence and mixing problems with my MCM algorithms and my
supervisors and I have come up with a few suggestions for what the problem
could be (I'm a novice geostatistician and R-user).  I was wondering if
someone could perhaps answer a couple of general questions about one theory?


 

Firstly, if the covariance model specified in model.glm.control does not fit
the data adequately is this likely to result in convergence/mixing problems?
And secondly, what impact could this have on the model results?  

 

My supervisor suggested trying to use only the short lags in model fitting
as the tail of my variogram does not fit well to the specified covariance
function - is this possible in geoRglm?  Could I use only lags up to 30km
and discard lags from 30 to 60km (max lag is about 60km in my dataset)?

 

My data shows a 'hole-effect' so the variogram rises, and then drops again,
but I have been using the spherical covariance function in my model fitting
which fits my data up to the peak, but not after.  So far I have been unable
to find a better fitting line for my data using lines.variomodel.  I'm not
sure if this is useful or not, but I have included my code below (nicola1 is
the dataset and MARKET is a covariate).  

 

Any advice or suggestions would be appreciated, 

 

Many thanks,

Nicola

 

 

varA<-variog(nicola1, trend=~MARKET, max.dist=30,uvec=15)

plot(varA)

lines.variomodel(cov.model="sph", cov.pars = c(1.2, 20), nug=0.8,
max.dist=30)

 

#Set a random seed

set.seed(548)

 

#Set the prior control

PriA<-prior.glm.control(beta.prior="flat", sigmasq.prior="uniform",
phi.prior="fixed", phi =20, tausq.rel=1)

#Set the MCMC control

McA<-mcmc.control(S.scale=0.03, phi.scale=0.36, burn.in=100000, thin=50,
n.iter=100000)

#Set the model control

ModA<-model.glm.control(trend.d=trend.spatial(~MARKET, nicola1),
cov.model="spherical", lambda=0)

#Set the output control

OutA<-output.glm.control(sim.posterior=TRUE, keep.mcmc.sim=TRUE,
quantile=TRUE, inference=TRUE)

 

#Run the model with inputs (prior control, MCMC control, trend
specification, model control, and output control)

testA<-binom.krige.bayes(nicola1, prior=PriA, model=ModA, mcmc.input=McA,
output=OutA)

 

save(testA, file="test1")

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090401/0067c69e/attachment.html>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090401/0067c69e/attachment.pl>

From Markku.Simila at fimr.fi  Wed Apr  1 17:07:24 2009
From: Markku.Simila at fimr.fi (Markku.Simila at fimr.fi)
Date: Wed, 1 Apr 2009 18:07:24 +0300
Subject: [R-sig-Geo] =?iso-8859-1?q?Markku_Simil=E4_is_out_of_the_office?=
	=?iso-8859-1?q?=2E?=
Message-ID: <OFA839AB13.AD1E9C54-ONC225758B.00531342-C225758B.00531341@fimr.fi>


I will be out of the office starting  01.04.2009 and will not return until
20.04.2009.

I will respond to your message when I return.


From prairie.picker at gmail.com  Wed Apr  1 18:53:37 2009
From: prairie.picker at gmail.com (Tyler Dean Rudolph)
Date: Wed, 1 Apr 2009 12:53:37 -0400
Subject: [R-sig-Geo] saving a RasterLayer object (raster package)
Message-ID: <9fb1ae890904010953l7a48b331vad1679b3085bfa3b@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090401/09969a7b/attachment.pl>

From brenning at uwaterloo.ca  Wed Apr  1 19:03:02 2009
From: brenning at uwaterloo.ca (Alexander Brenning)
Date: Wed, 01 Apr 2009 13:03:02 -0400
Subject: [R-sig-Geo] RPyGeo Query -- probably easy
In-Reply-To: <49CBEB4F.4060905@zevross.com>
References: <49CBEB4F.4060905@zevross.com>
Message-ID: <49D39E46.4000702@uwaterloo.ca>

Hi Zev,

the problems are definitely your quotes. First, they are syntactically 
incorrect - I count seven double quotes (I recommend using some editor 
with syntax highlighting, like Tinn-R or R-WinEdt, this helps discover 
mismatches). Second, escaping them (\") should allow you to put double 
quotes inside a double-quoted character string.

This might be closer to what you want to do (but I haven't tried to run 
it - sorry, busy end of term...):

rpygeo.geoprocessor("makefeaturelayer('X:\\abc.shp','walk')",
     "SelectLayerByAttribute('walk','NEW_SELECTION','\"hrwk05\"<>0')",
     env=myenv)

Note that an additional argument clean.up=FALSE to the 
rpygeo.geoprocessor allows you to inspect the Python file to check 
whether the quotes are syntactically correct in Python.

I hope this helps
  Alex



Zev Ross wrote:
> Hi All,
> 
> I'm wondering if anybody could give me a little guidance on formatting a 
> query using RPyGeo. I'm excited to be able to run Python geoprocessing 
> functions straight from R but am having trouble with the quote, double 
> quote kinds of issues.
> 
> Here's an example of what I'd like to run
> 
> rpygeo.geoprocessor("makefeaturelayer('X:\\abc.shp',
> 'walk')", "SelectLayerByAttribute('walk','NEW_SELECTION', ' "hrwk05" 
> '<>0")",env=myenv)
> 
> Where the sticking point is hrwk05 <> 0. In Python my query would be 
> double quote, field name, close double quote, comparison, number e.g, 
> "hrwk05" <> 0 but I'm not sure how to put this into RPyGeo
> 
> If I run like so:
> 
> rpygeo.geoprocessor("makefeaturelayer('X:\\abc.shp',
> 'walk')", "SelectLayerByAttribute('walk','NEW_SELECTION', '')",env=myenv)
> 
> it runs.
> 
> Thank you in advance for assistance.
> 
> Zev
> 

-- 
Alexander Brenning
brenning at uwaterloo.ca - T +1-519-888-4567 ext 35783
Department of Geography and Environmental Management
University of Waterloo
200 University Ave. W - Waterloo, ON - Canada N2L 3G1
http://www.fes.uwaterloo.ca/geography/faculty/brenning/


From marceivissa at gmail.com  Wed Apr  1 20:37:40 2009
From: marceivissa at gmail.com (=?ISO-8859-1?Q?Marc_Mar=ED_Dell=27Olmo?=)
Date: Wed, 1 Apr 2009 20:37:40 +0200
Subject: [R-sig-Geo] convert point and map coordinates UTM to WSG
In-Reply-To: <49C75522.5070104@geo.uu.nl>
References: <e0379d960903200351r18abe38fo72dc0000b6b825a0@mail.gmail.com>
	<49C75522.5070104@geo.uu.nl>
Message-ID: <e0379d960904011137n3070dfb9u486a6e6e89d1c47a@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090401/d5fec8f9/attachment.pl>

From marceivissa at gmail.com  Wed Apr  1 20:38:58 2009
From: marceivissa at gmail.com (=?ISO-8859-1?Q?Marc_Mar=ED_Dell=27Olmo?=)
Date: Wed, 1 Apr 2009 20:38:58 +0200
Subject: [R-sig-Geo] convert point and map coordinates UTM to WSG
In-Reply-To: <49C75522.5070104@geo.uu.nl>
References: <e0379d960903200351r18abe38fo72dc0000b6b825a0@mail.gmail.com>
	<49C75522.5070104@geo.uu.nl>
Message-ID: <e0379d960904011138v1b4f601hbbefaa0930dec25d@mail.gmail.com>

Dear all,

I have tried to transform coordinates from UTM Zone-31 ED-50 Spain
Portugal (EUR-D code in this web
http://earth-info.nga.mil/GandG/coordsys/onlinedatum/CountryEuropeTable.html
# EURD) to coordinates WSG84 ( google maps coordinates) with the
"ptransform" of the proj4 library and I can not do it right (first
syntax). I have tried also using the "spTransform" of the rgdal
library (second syntax) and I have not been successful.

I attach the syntax used, I got 4 points with coordinates ED ESP-50 (
"utm" in the syntax) and their respective coordinates WSG84 (wgs.gold
"in the syntax). Can anyone tell me where is the error?

Thank you very much,

Marc

> #First sintax
> library(proj4)
> x.utm <- c(428727134,431587743,434639340,426268557)
> y.utm <- c(4584118048,4581465377,4584855001,4584607449)
> x.wgs <- c(41.4036923115558,41.38010926480547,41.41148169051035,41.409534433320914)
> y.wgs <- c(2.145810127258301,2.1807003021240234,2.2183799743652344,2.1170568466186523)
>
> utm <- cbind(x.utm, y.utm)
> wgs.new <- ptransform(utm, "+proj=utm  +ellps=intl +zone=31 +towgs84=-84,-107,-120,0,0,0,0,0 +no_defs",
+                  "+proj=latlong  +datum=WGS84")
> wgs.new
          [,1]     [,2]     [,3]
[1,] -2.236353 1.570775 39.63333
[2,] -2.236353 1.570775 39.63333
[3,] -2.236353 1.570775 39.63333
[4,] -2.236353 1.570775 39.63333
> (wgs.gold <- cbind(x.wgs, y.wgs))
        x.wgs    y.wgs
[1,] 41.40369 2.145810
[2,] 41.38011 2.180700
[3,] 41.41148 2.218380
[4,] 41.40953 2.117057
>
>
>
> #Second sintax
> library(rgdal)
> (data.utm <- data.frame(x.utm,y.utm,x.wgs,y.wgs))
      x.utm      y.utm    x.wgs    y.wgs
1 428727134 4584118048 41.40369 2.145810
2 431587743 4581465377 41.38011 2.180700
3 434639340 4584855001 41.41148 2.218380
4 426268557 4584607449 41.40953 2.117057
> coordinates(data.utm) <- c("x.utm", "y.utm")
> proj4string(data.utm) <- CRS("+proj=utm  +ellps=intl +zone=31 +towgs84=-84,-107,-120,0,0,0,0,0 +no_defs")
> (wgs.new2 <- spTransform(data.utm, CRS("+proj=latlong +datum=WGS84")))
          coordinates    x.wgs    y.wgs
1 (-128.134, 89.9988) 41.40369 2.145810
2 (-128.134, 89.9988) 41.38011 2.180700
3 (-128.134, 89.9988) 41.41148 2.218380
4 (-128.134, 89.9988) 41.40953 2.117057



2009/3/23 Paul Hiemstra <p.hiemstra at geo.uu.nl>
>
> Hi,
>
> To transform coordinates you can use the spTransform function from the rgdal pacakge. It uses proj4 to do the transformations. Proj uses a string to describe a certain projection, the so called proj4string. If you can determine the proj4string for both your projections you can transform between them. The first string (WGS84) looks like this:
>
> "+proj=longlat +datum=WGS84"
>
> The second (UTM) something like:
>
> "+proj=utm +zone=yourzone +datum=yourdatum"
>
> See the documentation of spTransform for more information on how to use the function.
>
> cheers and hth,
> Paul
>
> Marc Mar? Dell'Olmo wrote:
>>
>> Dear R-users,
>>
>> Can anyone tell me how to convert point coordinates from WSG84 (google
>> maps coordinates) format to UTM HUSO-31 ED-50. And if I have a map
>> (shp format) with UTM HUSO-31 ED-50 coordinates, how can I convert to
>> WSG84 (google maps coordinates) coordinates. Should I install some
>> external software?
>>
>> Can anyone tell me the instructions?
>>
>> Thank you,
>>
>> Marc
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
> --
> Drs. Paul Hiemstra
> Department of Physical Geography
> Faculty of Geosciences
> University of Utrecht
> Heidelberglaan 2
> P.O. Box 80.115
> 3508 TC Utrecht
> Phone: ?+3130 274 3113 Mon-Tue
> Phone: ?+3130 253 5773 Wed-Fri
> http://intamap.geo.uu.nl/~paul
>


From Roger.Bivand at nhh.no  Wed Apr  1 22:17:36 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 1 Apr 2009 22:17:36 +0200 (CEST)
Subject: [R-sig-Geo] convert point and map coordinates UTM to WSG
In-Reply-To: <e0379d960904011137n3070dfb9u486a6e6e89d1c47a@mail.gmail.com>
References: <e0379d960903200351r18abe38fo72dc0000b6b825a0@mail.gmail.com>
	<49C75522.5070104@geo.uu.nl>
	<e0379d960904011137n3070dfb9u486a6e6e89d1c47a@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.0904012206180.740@reclus.nhh.no>

On Wed, 1 Apr 2009, Marc Mar? Dell'Olmo wrote:

> Dear all,
>
> I have tried to transform coordinates from UTM Zone-31 ED-50 Spain Portugal
> (EUR-D code in this web
> http://earth-info.nga.mil/GandG/coordsys/onlinedatum/CountryEuropeTable.html#
> EURD) to coordinates WSG84 ( google maps coordinates) with the
> "ptransform" of the proj4 library and I can not do it right (first syntax).
> I have tried also using the "spTransform" of the rgdal  library (second
> syntax) and I have not been successful.
>
> I attach the syntax used, I got 4 points with coordinates ED ESP-50 ( "utm"
> in the syntax) and their respective coordinates WSG84 (wgs.gold "in the
> syntax). Can anyone tell me where is the error?

So far several. One is reversing x and y values, another saying "latlong" 
when you mean "longlat", a third is the units of your input UTM (I think 
mm, not m), here, I'm going from longlat to UTM:

library(rgdal)

y.wgs <- c(41.4036923115558, 41.38010926480547, 41.41148169051035,
  41.409534433320914)
x.wgs <- c(2.145810127258301, 2.1807003021240234, 2.2183799743652344,
  2.1170568466186523)
SP <- SpatialPoints(cbind(x.wgs, y.wgs),
  proj4string=CRS("+proj=longlat +datum=WGS84"))
spTransform(SP,
  CRS("+proj=utm  +ellps=intl +zone=31 +towgs84=-84,-107,-120,0,0,0,0,0"))

The remaining differences are from the inadequacy of the +towgs84 string; 
Grids & Datums (http://www.asprs.org/resources/grids/) - like your source 
- gives +/- ranges for the transformation parameters, so you'll need to 
fish unless you can get a better authority (and there are few better than 
Grids & Datums).

Hope this helps,

Roger



>
> Thank you very much,
>
> Marc
>
>> #First sintax
>> library(proj4)
>> x.utm <- c(428727134,431587743,434639340,426268557)
>> y.utm <- c(4584118048,4581465377,4584855001,4584607449)
>> x.wgs <-
> c(41.4036923115558,41.38010926480547,41.41148169051035,41.409534433320914)
>> y.wgs <-
> c(2.145810127258301,2.1807003021240234,2.2183799743652344,2.1170568466186523)
>
>>
>> utm <- cbind(x.utm, y.utm)
>> wgs.new <- ptransform(utm, "+proj=utm  +ellps=intl +zone=31
> +towgs84=-84,-107,-120,0,0,0,0,0 +no_defs",
> +                  "+proj=latlong  +datum=WGS84")
>> wgs.new
>          [,1]     [,2]     [,3]
> [1,] -2.236353 1.570775 39.63333
> [2,] -2.236353 1.570775 39.63333
> [3,] -2.236353 1.570775 39.63333
> [4,] -2.236353 1.570775 39.63333
>> (wgs.gold <- cbind(x.wgs, y.wgs))
>        x.wgs    y.wgs
> [1,] 41.40369 2.145810
> [2,] 41.38011 2.180700
> [3,] 41.41148 2.218380
> [4,] 41.40953 2.117057
>>
>>
>>
>> #Second sintax
>> library(rgdal)
>> (data.utm <- data.frame(x.utm,y.utm,x.wgs,y.wgs))
>      x.utm      y.utm    x.wgs    y.wgs
> 1 428727134 4584118048 41.40369 2.145810
> 2 431587743 4581465377 41.38011 2.180700
> 3 434639340 4584855001 41.41148 2.218380
> 4 426268557 4584607449 41.40953 2.117057
>> coordinates(data.utm) <- c("x.utm", "y.utm")
>> proj4string(data.utm) <- CRS("+proj=utm  +ellps=intl +zone=31
> +towgs84=-84,-107,-120,0,0,0,0,0 +no_defs")
>> (wgs.new2 <- spTransform(data.utm, CRS("+proj=latlong +datum=WGS84")))
>          coordinates    x.wgs    y.wgs
> 1 (-128.134, 89.9988) 41.40369 2.145810
> 2 (-128.134, 89.9988) 41.38011 2.180700
> 3 (-128.134, 89.9988) 41.41148 2.218380
> 4 (-128.134, 89.9988) 41.40953 2.117057
>
>
>
> 2009/3/23 Paul Hiemstra <p.hiemstra at geo.uu.nl>
>
>> Hi,
>>
>> To transform coordinates you can use the spTransform function from the
>> rgdal pacakge. It uses proj4 to do the transformations. Proj uses a string
>> to describe a certain projection, the so called proj4string. If you can
>> determine the proj4string for both your projections you can transform
>> between them. The first string (WGS84) looks like this:
>>
>> "+proj=longlat +datum=WGS84"
>>
>> The second (UTM) something like:
>>
>> "+proj=utm +zone=yourzone +datum=yourdatum"
>>
>> See the documentation of spTransform for more information on how to use the
>> function.
>>
>> cheers and hth,
>> Paul
>>
>>
>> Marc Mar? Dell'Olmo wrote:
>>
>>> Dear R-users,
>>>
>>> Can anyone tell me how to convert point coordinates from WSG84 (google
>>> maps coordinates) format to UTM HUSO-31 ED-50. And if I have a map
>>> (shp format) with UTM HUSO-31 ED-50 coordinates, how can I convert to
>>> WSG84 (google maps coordinates) coordinates. Should I install some
>>> external software?
>>>
>>> Can anyone tell me the instructions?
>>>
>>> Thank you,
>>>
>>> Marc
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>>
>>
>> --
>> Drs. Paul Hiemstra
>> Department of Physical Geography
>> Faculty of Geosciences
>> University of Utrecht
>> Heidelberglaan 2
>> P.O. Box 80.115
>> 3508 TC Utrecht
>> Phone:  +3130 274 3113 Mon-Tue
>> Phone:  +3130 253 5773 Wed-Fri
>> http://intamap.geo.uu.nl/~paul <http://intamap.geo.uu.nl/%7Epaul>
>>
>>
>
> 	[[alternative HTML version deleted]]
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From qlemouland at yahoo.fr  Thu Apr  2 09:26:00 2009
From: qlemouland at yahoo.fr (Quentin LEMOULAND)
Date: Thu, 2 Apr 2009 07:26:00 +0000 (GMT)
Subject: [R-sig-Geo] as.psp don't work for big shapefiles?
In-Reply-To: <200903262208.26028.torleif.lunde@cih.uib.no>
Message-ID: <668548.10300.qm@web24202.mail.ird.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090402/30e4c537/attachment.pl>

From wroberts at csir.co.za  Thu Apr  2 09:26:28 2009
From: wroberts at csir.co.za (Wesley Roberts)
Date: Thu, 02 Apr 2009 09:26:28 +0200
Subject: [R-sig-Geo] Time series analysis with irregular time-series
Message-ID: <49D484C4.8E3B.0073.0@csir.co.za>

Dear R users

I am currently investigating time series analysis using an irregular time series. Our study is looking at vegetation change in areas of alien vegetation growth after clearing events. The irregular time series is sourced from Landsat ETM+ data, over a six year period I have 38 scenes. For certain periods I have monthly data while for others, images are up to three months apart. So far I have been using linear regression between NDVI (Normalized Difference Vegetation Index) and time to get an overall trend and then plotting the long term trend with the mFilter (Hodrick-Prescott filter). Additional to this I would like to plot a full time series of monthly rainfall data (with no missing data) against my irregular ts. I thus have the following questions,

1. While the mFilter does provide a good trend profile I would like to use a ts analysis procedure which is tailored to irregular environmental data, could anyone suggest a filter / analysis technique besides the mFilter? I am interested in the long term trend, but would also like to identify stochastic changes in the ts?

2. Is it possible to pad / interpolate missing values in a ts and how scientifically robust is this?

3. If interpolation / pad is not an issue how do I deal with NA values in a ts, the mFilter does not like NA and will return only NA if the ts contains any NA's?

I am using R version 2.8 on a Dell Precision 690 Workstation running Ubuntu Hardy Heron.

If any one has experience with time series analysis and has any suggestions regarding the questions posted, I would really appreciate some help.

Many thanks and kind regards,
Wesley



Wesley Roberts MSc.
Researcher: Earth Observation (Ecosystems)
Natural Resources and the Environment
CSIR
Tel: +27 (21) 888-2490
Fax: +27 (21) 888-2693

"To know the road ahead, ask those coming back."
- Chinese proverb



-- 
This message is subject to the CSIR's copyright terms and conditions, e-mail legal notice, and implemented Open Document Format (ODF) standard. 
The full disclaimer details can be found at http://www.csir.co.za/disclaimer.html.

This message has been scanned for viruses and dangerous content by MailScanner, 
and is believed to be clean.  MailScanner thanks Transtec Computers for their support.


From marceivissa at gmail.com  Thu Apr  2 16:06:54 2009
From: marceivissa at gmail.com (=?ISO-8859-1?Q?Marc_Mar=ED_Dell=27Olmo?=)
Date: Thu, 2 Apr 2009 16:06:54 +0200
Subject: [R-sig-Geo] convert point and map coordinates UTM to WSG
In-Reply-To: <alpine.LRH.2.00.0904012206180.740@reclus.nhh.no>
References: <e0379d960903200351r18abe38fo72dc0000b6b825a0@mail.gmail.com>
	<49C75522.5070104@geo.uu.nl>
	<e0379d960904011137n3070dfb9u486a6e6e89d1c47a@mail.gmail.com>
	<alpine.LRH.2.00.0904012206180.740@reclus.nhh.no>
Message-ID: <e0379d960904020706v165c4e67qb64330407bda1bab@mail.gmail.com>

Dear Roger,

thank you for your help. There is something I don't quite understand.
If I compare distances between the converted coordinates (SP.utm.wgs)
with the coordinates (SP.wgs) that I use to compare with (in pairs),
the distances are more variant than I expected. These go from
approximately 15 meters to 192. I thought that the error would be more
or less constant. Is it normal?


> spDistsN1(coordinates(SP.wgs),coordinates(SP.utm.wgs[1,]),longlat=TRUE)[1]*1000
[1] 25.66325
> spDistsN1(coordinates(SP.wgs),coordinates(SP.utm.wgs[2,]),longlat=TRUE)[2]*1000
[1] 15.8736
> spDistsN1(coordinates(SP.wgs),coordinates(SP.utm.wgs[3,]),longlat=TRUE)[3]*1000
[1] 158.1777
> spDistsN1(coordinates(SP.wgs),coordinates(SP.utm.wgs[4,]),longlat=TRUE)[4]*1000
[1] 194.8797

Thank you,

Marc

2009/4/1 Roger Bivand <Roger.Bivand at nhh.no>
>
> On Wed, 1 Apr 2009, Marc Mar? Dell'Olmo wrote:
>
>> Dear all,
>>
>> I have tried to transform coordinates from UTM Zone-31 ED-50 Spain Portugal
>> (EUR-D code in this web
>> http://earth-info.nga.mil/GandG/coordsys/onlinedatum/CountryEuropeTable.html#
>> EURD) to coordinates WSG84 ( google maps coordinates) with the
>> "ptransform" of the proj4 library and I can not do it right (first syntax).
>> I have tried also using the "spTransform" of the rgdal ?library (second
>> syntax) and I have not been successful.
>>
>> I attach the syntax used, I got 4 points with coordinates ED ESP-50 ( "utm"
>> in the syntax) and their respective coordinates WSG84 (wgs.gold "in the
>> syntax). Can anyone tell me where is the error?
>
> So far several. One is reversing x and y values, another saying "latlong" when you mean "longlat", a third is the units of your input UTM (I think mm, not m), here, I'm going from longlat to UTM:
>
> library(rgdal)
>
> y.wgs <- c(41.4036923115558, 41.38010926480547, 41.41148169051035,
> ?41.409534433320914)
> x.wgs <- c(2.145810127258301, 2.1807003021240234, 2.2183799743652344,
> ?2.1170568466186523)
> SP <- SpatialPoints(cbind(x.wgs, y.wgs),
> ?proj4string=CRS("+proj=longlat +datum=WGS84"))
> spTransform(SP,
> ?CRS("+proj=utm ?+ellps=intl +zone=31 +towgs84=-84,-107,-120,0,0,0,0,0"))
>
> The remaining differences are from the inadequacy of the +towgs84 string; Grids & Datums (http://www.asprs.org/resources/grids/) - like your source - gives +/- ranges for the transformation parameters, so you'll need to fish unless you can get a better authority (and there are few better than Grids & Datums).
>
> Hope this helps,
>
> Roger
>
>
>
>>
>> Thank you very much,
>>
>> Marc
>>
>>> #First sintax
>>> library(proj4)
>>> x.utm <- c(428727134,431587743,434639340,426268557)
>>> y.utm <- c(4584118048,4581465377,4584855001,4584607449)
>>> x.wgs <-
>>
>> c(41.4036923115558,41.38010926480547,41.41148169051035,41.409534433320914)
>>>
>>> y.wgs <-
>>
>> c(2.145810127258301,2.1807003021240234,2.2183799743652344,2.1170568466186523)
>>
>>>
>>> utm <- cbind(x.utm, y.utm)
>>> wgs.new <- ptransform(utm, "+proj=utm ?+ellps=intl +zone=31
>>
>> +towgs84=-84,-107,-120,0,0,0,0,0 +no_defs",
>> + ? ? ? ? ? ? ? ? ?"+proj=latlong ?+datum=WGS84")
>>>
>>> wgs.new
>>
>> ? ? ? ? [,1] ? ? [,2] ? ? [,3]
>> [1,] -2.236353 1.570775 39.63333
>> [2,] -2.236353 1.570775 39.63333
>> [3,] -2.236353 1.570775 39.63333
>> [4,] -2.236353 1.570775 39.63333
>>>
>>> (wgs.gold <- cbind(x.wgs, y.wgs))
>>
>> ? ? ? x.wgs ? ?y.wgs
>> [1,] 41.40369 2.145810
>> [2,] 41.38011 2.180700
>> [3,] 41.41148 2.218380
>> [4,] 41.40953 2.117057
>>>
>>>
>>>
>>> #Second sintax
>>> library(rgdal)
>>> (data.utm <- data.frame(x.utm,y.utm,x.wgs,y.wgs))
>>
>> ? ? x.utm ? ? ?y.utm ? ?x.wgs ? ?y.wgs
>> 1 428727134 4584118048 41.40369 2.145810
>> 2 431587743 4581465377 41.38011 2.180700
>> 3 434639340 4584855001 41.41148 2.218380
>> 4 426268557 4584607449 41.40953 2.117057
>>>
>>> coordinates(data.utm) <- c("x.utm", "y.utm")
>>> proj4string(data.utm) <- CRS("+proj=utm ?+ellps=intl +zone=31
>>
>> +towgs84=-84,-107,-120,0,0,0,0,0 +no_defs")
>>>
>>> (wgs.new2 <- spTransform(data.utm, CRS("+proj=latlong +datum=WGS84")))
>>
>> ? ? ? ? coordinates ? ?x.wgs ? ?y.wgs
>> 1 (-128.134, 89.9988) 41.40369 2.145810
>> 2 (-128.134, 89.9988) 41.38011 2.180700
>> 3 (-128.134, 89.9988) 41.41148 2.218380
>> 4 (-128.134, 89.9988) 41.40953 2.117057
>>
>>
>>
>> 2009/3/23 Paul Hiemstra <p.hiemstra at geo.uu.nl>
>>
>>> Hi,
>>>
>>> To transform coordinates you can use the spTransform function from the
>>> rgdal pacakge. It uses proj4 to do the transformations. Proj uses a string
>>> to describe a certain projection, the so called proj4string. If you can
>>> determine the proj4string for both your projections you can transform
>>> between them. The first string (WGS84) looks like this:
>>>
>>> "+proj=longlat +datum=WGS84"
>>>
>>> The second (UTM) something like:
>>>
>>> "+proj=utm +zone=yourzone +datum=yourdatum"
>>>
>>> See the documentation of spTransform for more information on how to use the
>>> function.
>>>
>>> cheers and hth,
>>> Paul
>>>
>>>
>>> Marc Mar? Dell'Olmo wrote:
>>>
>>>> Dear R-users,
>>>>
>>>> Can anyone tell me how to convert point coordinates from WSG84 (google
>>>> maps coordinates) format to UTM HUSO-31 ED-50. And if I have a map
>>>> (shp format) with UTM HUSO-31 ED-50 coordinates, how can I convert to
>>>> WSG84 (google maps coordinates) coordinates. Should I install some
>>>> external software?
>>>>
>>>> Can anyone tell me the instructions?
>>>>
>>>> Thank you,
>>>>
>>>> Marc
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at stat.math.ethz.ch
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>>
>>>
>>>
>>> --
>>> Drs. Paul Hiemstra
>>> Department of Physical Geography
>>> Faculty of Geosciences
>>> University of Utrecht
>>> Heidelberglaan 2
>>> P.O. Box 80.115
>>> 3508 TC Utrecht
>>> Phone: ?+3130 274 3113 Mon-Tue
>>> Phone: ?+3130 253 5773 Wed-Fri
>>> http://intamap.geo.uu.nl/~paul <http://intamap.geo.uu.nl/%7Epaul>
>>>
>>>
>>
>> ? ? ? ?[[alternative HTML version deleted]]
>>
>>
>
> --
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Thu Apr  2 16:43:30 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 2 Apr 2009 16:43:30 +0200 (CEST)
Subject: [R-sig-Geo] convert point and map coordinates UTM to WSG
In-Reply-To: <e0379d960904020706v165c4e67qb64330407bda1bab@mail.gmail.com>
References: <e0379d960903200351r18abe38fo72dc0000b6b825a0@mail.gmail.com>
	<49C75522.5070104@geo.uu.nl>
	<e0379d960904011137n3070dfb9u486a6e6e89d1c47a@mail.gmail.com>
	<alpine.LRH.2.00.0904012206180.740@reclus.nhh.no>
	<e0379d960904020706v165c4e67qb64330407bda1bab@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.0904021627450.6661@reclus.nhh.no>

On Thu, 2 Apr 2009, Marc Mar? Dell'Olmo wrote:

> Dear Roger,
>
> thank you for your help. There is something I don't quite understand.
> If I compare distances between the converted coordinates (SP.utm.wgs)
> with the coordinates (SP.wgs) that I use to compare with (in pairs),
> the distances are more variant than I expected. These go from
> approximately 15 meters to 192. I thought that the error would be more
> or less constant. Is it normal?

In datum transformation, it is hard to be precise without an accurate set 
of transformation parameters. These may also vary across an area of 
interest:

y.wgs <- c(41.4036923115558, 41.38010926480547, 41.41148169051035,
  41.409534433320914)
x.wgs <- c(2.145810127258301, 2.1807003021240234, 2.2183799743652344,
  2.1170568466186523)
x.utm <- c(428727134, 431587743, 434639340, 426268557)
y.utm <- c(4584118048, 4581465377, 4584855001, 4584607449)
orig <- cbind(x.utm, y.utm)/1000
library(rgdal)
out <- spTransform(SP,
  CRS("+proj=utm ?+ellps=intl +zone=31 +towgs84=-84,-107,-120,0,0,0,0,0"))
for (i in 1:nrow(orig)) print(spDistsN1(coordinates(out)[i,,drop=FALSE],
  orig[i, ]))

is:

[1] 164.4001
[1] 156.7712
[1] 167.2330
[1] 44.72934

crds <- cbind(x.wgs, y.wgs)
for (i in 2:nrow(crds)) print(spDistsN1(crds[1:(i-1),,drop=FALSE],
   crds[i,], longlat=TRUE)*1000)

suggests that the points are not too far apart, under 10km, so I would not 
expect differences of this scale. How were the UTM projected and WGS 
geographical coordinates measured - I guess that the ED50 UTM coordinates 
are from a legacy/archive source (manually digitized map?) and the WGS 
geographical coordinates from field measured GPS?

Roger

>
>
>> spDistsN1(coordinates(SP.wgs),coordinates(SP.utm.wgs[1,]),longlat=TRUE)[1]*1000
> [1] 25.66325
>> spDistsN1(coordinates(SP.wgs),coordinates(SP.utm.wgs[2,]),longlat=TRUE)[2]*1000
> [1] 15.8736
>> spDistsN1(coordinates(SP.wgs),coordinates(SP.utm.wgs[3,]),longlat=TRUE)[3]*1000
> [1] 158.1777
>> spDistsN1(coordinates(SP.wgs),coordinates(SP.utm.wgs[4,]),longlat=TRUE)[4]*1000
> [1] 194.8797
>
> Thank you,
>
> Marc
>
> 2009/4/1 Roger Bivand <Roger.Bivand at nhh.no>
>>
>> On Wed, 1 Apr 2009, Marc Mar? Dell'Olmo wrote:
>>
>>> Dear all,
>>>
>>> I have tried to transform coordinates from UTM Zone-31 ED-50 Spain Portugal
>>> (EUR-D code in this web
>>> http://earth-info.nga.mil/GandG/coordsys/onlinedatum/CountryEuropeTable.html#
>>> EURD) to coordinates WSG84 ( google maps coordinates) with the
>>> "ptransform" of the proj4 library and I can not do it right (first syntax).
>>> I have tried also using the "spTransform" of the rgdal ?library (second
>>> syntax) and I have not been successful.
>>>
>>> I attach the syntax used, I got 4 points with coordinates ED ESP-50 ( "utm"
>>> in the syntax) and their respective coordinates WSG84 (wgs.gold "in the
>>> syntax). Can anyone tell me where is the error?
>>
>> So far several. One is reversing x and y values, another saying "latlong" when you mean "longlat", a third is the units of your input UTM (I think mm, not m), here, I'm going from longlat to UTM:
>>
>> library(rgdal)
>>
>> y.wgs <- c(41.4036923115558, 41.38010926480547, 41.41148169051035,
>> ?41.409534433320914)
>> x.wgs <- c(2.145810127258301, 2.1807003021240234, 2.2183799743652344,
>> ?2.1170568466186523)
>> SP <- SpatialPoints(cbind(x.wgs, y.wgs),
>> ?proj4string=CRS("+proj=longlat +datum=WGS84"))
>> spTransform(SP,
>> ?CRS("+proj=utm ?+ellps=intl +zone=31 +towgs84=-84,-107,-120,0,0,0,0,0"))
>>
>> The remaining differences are from the inadequacy of the +towgs84 string; Grids & Datums (http://www.asprs.org/resources/grids/) - like your source - gives +/- ranges for the transformation parameters, so you'll need to fish unless you can get a better authority (and there are few better than Grids & Datums).
>>
>> Hope this helps,
>>
>> Roger
>>
>>
>>
>>>
>>> Thank you very much,
>>>
>>> Marc
>>>
>>>> #First sintax
>>>> library(proj4)
>>>> x.utm <- c(428727134,431587743,434639340,426268557)
>>>> y.utm <- c(4584118048,4581465377,4584855001,4584607449)
>>>> x.wgs <-
>>>
>>> c(41.4036923115558,41.38010926480547,41.41148169051035,41.409534433320914)
>>>>
>>>> y.wgs <-
>>>
>>> c(2.145810127258301,2.1807003021240234,2.2183799743652344,2.1170568466186523)
>>>
>>>>
>>>> utm <- cbind(x.utm, y.utm)
>>>> wgs.new <- ptransform(utm, "+proj=utm ?+ellps=intl +zone=31
>>>
>>> +towgs84=-84,-107,-120,0,0,0,0,0 +no_defs",
>>> + ? ? ? ? ? ? ? ? ?"+proj=latlong ?+datum=WGS84")
>>>>
>>>> wgs.new
>>>
>>> ? ? ? ? [,1] ? ? [,2] ? ? [,3]
>>> [1,] -2.236353 1.570775 39.63333
>>> [2,] -2.236353 1.570775 39.63333
>>> [3,] -2.236353 1.570775 39.63333
>>> [4,] -2.236353 1.570775 39.63333
>>>>
>>>> (wgs.gold <- cbind(x.wgs, y.wgs))
>>>
>>> ? ? ? x.wgs ? ?y.wgs
>>> [1,] 41.40369 2.145810
>>> [2,] 41.38011 2.180700
>>> [3,] 41.41148 2.218380
>>> [4,] 41.40953 2.117057
>>>>
>>>>
>>>>
>>>> #Second sintax
>>>> library(rgdal)
>>>> (data.utm <- data.frame(x.utm,y.utm,x.wgs,y.wgs))
>>>
>>> ? ? x.utm ? ? ?y.utm ? ?x.wgs ? ?y.wgs
>>> 1 428727134 4584118048 41.40369 2.145810
>>> 2 431587743 4581465377 41.38011 2.180700
>>> 3 434639340 4584855001 41.41148 2.218380
>>> 4 426268557 4584607449 41.40953 2.117057
>>>>
>>>> coordinates(data.utm) <- c("x.utm", "y.utm")
>>>> proj4string(data.utm) <- CRS("+proj=utm ?+ellps=intl +zone=31
>>>
>>> +towgs84=-84,-107,-120,0,0,0,0,0 +no_defs")
>>>>
>>>> (wgs.new2 <- spTransform(data.utm, CRS("+proj=latlong +datum=WGS84")))
>>>
>>> ? ? ? ? coordinates ? ?x.wgs ? ?y.wgs
>>> 1 (-128.134, 89.9988) 41.40369 2.145810
>>> 2 (-128.134, 89.9988) 41.38011 2.180700
>>> 3 (-128.134, 89.9988) 41.41148 2.218380
>>> 4 (-128.134, 89.9988) 41.40953 2.117057
>>>
>>>
>>>
>>> 2009/3/23 Paul Hiemstra <p.hiemstra at geo.uu.nl>
>>>
>>>> Hi,
>>>>
>>>> To transform coordinates you can use the spTransform function from the
>>>> rgdal pacakge. It uses proj4 to do the transformations. Proj uses a string
>>>> to describe a certain projection, the so called proj4string. If you can
>>>> determine the proj4string for both your projections you can transform
>>>> between them. The first string (WGS84) looks like this:
>>>>
>>>> "+proj=longlat +datum=WGS84"
>>>>
>>>> The second (UTM) something like:
>>>>
>>>> "+proj=utm +zone=yourzone +datum=yourdatum"
>>>>
>>>> See the documentation of spTransform for more information on how to use the
>>>> function.
>>>>
>>>> cheers and hth,
>>>> Paul
>>>>
>>>>
>>>> Marc Mar? Dell'Olmo wrote:
>>>>
>>>>> Dear R-users,
>>>>>
>>>>> Can anyone tell me how to convert point coordinates from WSG84 (google
>>>>> maps coordinates) format to UTM HUSO-31 ED-50. And if I have a map
>>>>> (shp format) with UTM HUSO-31 ED-50 coordinates, how can I convert to
>>>>> WSG84 (google maps coordinates) coordinates. Should I install some
>>>>> external software?
>>>>>
>>>>> Can anyone tell me the instructions?
>>>>>
>>>>> Thank you,
>>>>>
>>>>> Marc
>>>>>
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at stat.math.ethz.ch
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>
>>>>>
>>>>
>>>>
>>>> --
>>>> Drs. Paul Hiemstra
>>>> Department of Physical Geography
>>>> Faculty of Geosciences
>>>> University of Utrecht
>>>> Heidelberglaan 2
>>>> P.O. Box 80.115
>>>> 3508 TC Utrecht
>>>> Phone: ?+3130 274 3113 Mon-Tue
>>>> Phone: ?+3130 253 5773 Wed-Fri
>>>> http://intamap.geo.uu.nl/~paul <http://intamap.geo.uu.nl/%7Epaul>
>>>>
>>>>
>>>
>>> ? ? ? ?[[alternative HTML version deleted]]
>>>
>>>
>>
>> --
>> Roger Bivand
>> Economic Geography Section, Department of Economics, Norwegian School of
>> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From T.Hengl at uva.nl  Thu Apr  2 18:02:23 2009
From: T.Hengl at uva.nl (Tomislav Hengl)
Date: Thu, 2 Apr 2009 18:02:23 +0200
Subject: [R-sig-Geo] Running analysis on DEMs using GRASS (from R?)
In-Reply-To: <alpine.LRH.2.00.0903251321150.362@reclus.nhh.no>
References: <F3CCD791B842448D8E3A79D8906FE683@pcibed193>
	<49C9FD52.3040800@gmail.com>
	<92BE129F1A234A14AA6BE88F0649749C@pcibed193>
	<49CA153D.20207@gmail.com>
	<alpine.LRH.2.00.0903251321150.362@reclus.nhh.no>
Message-ID: <11834E23EAFF492E99B95BFC3AB44C0B@pcibed193>


Thanks to Roger (and with many useful comments from Augustin) GRASS just got another big user  -
possible even many more :)

Roger has prepared an update of his package spgrass6 that can now be used to control the GRASS
processing from R (functions: "initGRASS", "execGRASS"). This way one can skip some manual settings
of GRASS (environmental parameters) and just continue with the analysis (this is now really easy).
These are the installation steps (MS Windows machines):

1. Download and install GRASS 6 (e.g. from http://grass.itc.it/grass63/binary/mswindows/native/)
2. Install the updated version of the spgrass6 package (from
http://spatial.nhh.no/R/Devel/spgrass6_0.6-1.zip)
3. Start R and then run the following code:

# obtain the data:
> download.file("http://geomorphometry.org/data/dem25m.zip",
destfile=paste(getwd(),"dem25m.zip",sep="/"))
> fname <- zip.file.extract(file="DEM25m.asc", zipname="dem25m.zip")
> file.copy(fname, "./DEM25m.asc", overwrite=TRUE)

> library(spgrass6)  
# Location of your GRASS installation:
> loc <- initGRASS("C:/GRASS", home=tempdir())
> loc
# Import the ArcInfo ASCII file to GRASS:
> execGRASS("r.in.gdal", flags="o", parameters=list(input="DEM25m.asc", output="DEM"))
> execGRASS("g.region", parameters=list(rast="DEM"))
> gmeta6()
# extract the drainage network:
> execGRASS("r.watershed", flags="overwrite", parameters=list(elevation="DEM", stream="stream",
threshold=as.integer(50)))
# thin the raster map so it can be converted to vectors:
> execGRASS("r.thin", parameters=list(input="stream", output="streamt"))
# convert to vectors:
> execGRASS("r.to.vect", parameters=list(input="streamt", output="streamt", feature="line"))
> streamt <- readVECT6("streamt")
> plot(streamt)

Here are some screen shots:
http://geomorphometry.org/R.asp 

Tom Hengl
http://spatial-analyst.net 



> -----Original Message-----
> From: Roger Bivand [mailto:Roger.Bivand at nhh.no]
> Sent: Wednesday, March 25, 2009 1:27 PM
> To: Agustin Lobo
> Cc: Tomislav Hengl; carlos.grohmann at gmail.com; r-sig-geo at stat.math.ethz.ch
> Subject: Re: [R-sig-Geo] Running analysis on DEMs using GRASS (from R?)
> 
> On Wed, 25 Mar 2009, Agustin Lobo wrote:
> 
> > Tomislav,
> >
> > You set up your grass location and mapset, import your data
> > etc. outside R. Then, from the grass console, you start R and run
> > an scrip like the one I sent you or tits individual commands. Once you've
> > done
> >
> > require(spgrass6) #Package connecting R<->grass
> > G <- gmeta6() #Read grass environment
> >
> > you can run grass commands using system(), pass results from
> > R to grass and from grass to R (It's done in the script
> > I sent you), import raster files (which I normally
> > don't do: raster files are too large for R in general, I prefer to
> > use grass for processing and then pass data as tables to R for
> > the stats; but have no experience with the new raster package made
> > by Roger
> 
> The raster package on R-forge is by Robert Hijmans and a team of
> developers - very interesting, and often the most active project on the
> whole (very active) site!
> 
> As you write, spgrass6 itself uses system() within its functions. A year
> ago I did some work on an automatic interface generator for GRASS commands
> in R using the interface descriptions provided by GRASS modules in XML.
> Would there be interest in using these to try to automate the writing of
> GRASS commands from R? Would anyone like to help? Should spgrass6 be moved
> from sourceforge CVS to R-forge SVN to make it easier for others to join
> in?
> 
> Roger
> 
> 
> >
> > Actually, I often use R as an scripting language for grass. I used
> > to do scripts in the Bourne shell itself (actually, it was csh), but using R
> > (perhaps python also)
> > is much easier (and powerful).
> >
> > I do not see that many differences between
> > the way you are using saga and the way you would use grass, except that
> > for grass you must have your location, mapset and region set. This
> > is actually very powerful, as (re)defining regions with g.region lets you
> > restrict
> > your analysis to an area of interest, which you can change by
> > repeated calls to g.region that could depend upon a dynamic process.
> > The same can be done by setting a MASK.
> >
> > The script that I sent you is part of a process simulating the spread of an
> > invasive
> > plant. Note that all control is within R. You can do the same with R alone,
> > but
> > if your raster layers are large, it could become very slow (note that there
> > is for() loop
> > in the script, and for() loops have a very low performance in R; as most of
> > the commands run within the loop are grass commands run through system(),
> > there is minimum memory built up).
> >
> > I've used the grass that comes within QGIS in windows sometimes, but I feel
> > really not comfortable
> > doing this type of work outside linux though.
> >
> > You seem experienced with saga. Actually, would like to talk to you on a
> > possible use
> > of sage from within qgis thanks to the fact that both saga and qgis make use
> > of python.
> >
> > Agus
> >
> > Tomislav Hengl wrote:
> >> Dear Augustin,
> >>
> >> Thank you for your message and examples shown (flavored with a bits of
> >> Portuguese). I am aware of
> >> the spgrass6 package. I also know that there are plenty of examples for the
> >> R GRASS connection e.g.
> >> http://casoilresource.lawr.ucdavis.edu/drupal/node/438, but I would still
> >> like to see how an R
> >> script would look like for the case study shown below
> >> ("http:/www.geomorphometry.org/data/DEM25m.zip"; extraction of channel
> >> network).
> >> I am still confused whether GRASS can be run from R (or is it only the
> >> other way around?)? how to
> >> import the data into GRASS (e.g. ArcInfo ASCII)? how to set-up the
> >> parameters of the GRASS
> >> environment (working directory, projection system etc)? how to control the
> >> processing from R (e.g.
> >> using "system(...)"), and then read the results of analysis back to R?
> >> Please excuse my ignorance (and the fact that I am a MS Windows user). I am
> >> just a beginner with
> >> GRASS, so it could be that things are much simpler than they seem (it could
> >> also be that they are
> >> also much more complicated).
> >>
> >>
> >> Many thanks,
> >>
> >> Tom Hengl
> >> http://home.medewerker.uva.nl/t.hengl/
> >>
> >>
> >> -----Original Message-----
> >> From: Agustin Lobo [mailto:alobolistas at gmail.com] Sent: Wednesday, March
> >> 25, 2009 10:46 AM
> >> To: Tomislav Hengl
> >> Cc: r-sig-geo at stat.math.ethz.ch; carlos.grohmann at gmail.com
> >> Subject: Re: [R-sig-Geo] Running analysis on DEMs using GRASS (from R?)
> >>
> >> Tomislav,
> >>
> >> This would be part of an R script using grass:
> >>
> >> "brachspread" <- function(itmax=1,a=-1)
> >> {
> >> #Do the next once per session
> >> #attach("/media/mifat32/Rutils/utiles.rda")
> >> #Execute grass command: import tiff file into grass
> >> #Data:
> >> #manchas (importado de ****)
> >> #noocup (importado de no_ocupable1.tif, 3==no ocupable)
> >> #(senderos importado de senderos_raster10m.tif)
> >> #trailbuf importado de senderos
> >> #r.buffer -z --o in=senderos out=trailbuf distance=10 units=meters
> >> #camino:1; contiguo:2; resto, NULL
> >>
> >> require(spgrass6) #Package connecting R<->grass
> >> G <- gmeta6() #Read grass environment
> >> system("g.region rast=manchas")
> >>
> >> system("r.mapcalc 'habqual = if(trailbuf==1,0,trailbuf)'")
> >> system("r.mapcalc 'habqual = if(habqual==2,0.8,habqual)'")
> >> system("r.mapcalc 'habqual = if(isnull(habqual),0.5,habqual)'")
> >>
> >> #Execute grass command: set region to raster
> >> system("g.region rast=manchas")
> >> system("r.mapcalc 'manchasit = manchas'")
> >>
> >> #inicio del bucle de itersciones tiempo
> >> it <-0
> >> system("r.mapcalc 'prob = 0.000'")
> >> for(it in 1:itmax) {
> >> system("r.clump --o in=manchasit out=manchasit.clmp")
> >> #Execute grass command: create stats file
> >> system("r.stats -cl in=manchasit.clmp out=delme.txt")
> >> #Read stats file into R:
> >> mistat <- read.table("delme.txt",header=F,comment.char="*")
> >> system("rm delme.txt") #delete garbage
> >> #Write reclass file for grass
> >> write.table(mistat, file="delme.txt", row.names=F, col.names=F ,sep="=")
> >> system("r.reclass --o in=manchasit.clmp out=manchas.sze rules=delme.txt")
> >> system("rm delme.txt")
> >>
> >> etc
> >>
> >> Tomislav Hengl wrote:
> >>
> >>> Dear list,
> >>>
> >>> I am trying to test some DEM analysis functions in GRASS GIS (under MS
> >>> Windows machines). This is
> >>>
> >> my
> >>
> >>> first contact with GRASS scripting (I have successfully installed GRASS
> >>> 6.4 for windows from
> >>> http://grass.itc.it/grass63/binary/mswindows/native/).
> >>>
> >>> For example, with SAGA GIS, I can completely control the analysis from R
> >>> and use SAGA as external
> >>> application to run the processing, e.g. to extract the drainage networks
> >>> from a DEM:
> >>>
> >>>
> >>>> library(rgdal)
> >>>> library(RSAGA)
> >>>>
> >>> # obtain the data:
> >>> download.file("http://www.geomorphometry.org/data/DEM25m.zip",
> >>> destfile=paste(getwd(),"DEM25m.zip",sep="/"))
> >>> fname <- zip.file.extract(file="DEM25m.asc", zipname="DEM25m.zip")
> >>> file.copy(fname, "./DEM25m.asc", overwrite=TRUE)
> >>>
> >>> # load to SAGA format:
> >>>
> >>>> rsaga.esri.to.sgrd(in.grids="dem25m.asc", out.sgrds="dem25m.sgrd",
> >>>> in.path=getwd())
> >>>>
> >>> # Fill the spurious sinks:
> >>>
> >>>> rsaga.geoprocessor(lib="ta_preprocessor", module=2,
> >>>> param=list(DEM="dem25m.sgrd",
> >>>>
> >>> RESULT="dem25m_f.sgrd", MINSLOPE=0.05))
> >>> # extract the channel network:
> >>>
> >>>> rsaga.geoprocessor(lib="ta_channels", module=0,
> >>>> param=list(ELEVATION="dem25m_f.sgrd",
> >>>>
> >>> CHNLNTWRK="channel_ntwrk.sgrd", CHNLROUTE="channel_route.sgrd",
> >>> SHAPES="channels.shp",
> >>> INIT_GRID="dem25m_f.sgrd", DIV_CELLS=3, MINLEN=40))
> >>> # read back to R:
> >>>
> >>>> channels <- readOGR("channels.shp", "channels")
> >>>> spplot(channels["LENGTH"], col.regions=bpy.colors())
> >>>>
> >>> How could I run the same processing using GRASS? Can you control GRASS
> >>> from R at all? (I would be
> >>>
> >> a
> >>
> >>> bit disappointed with GRASS if I am not able to run the analysis from R).
> >>>
> >>> Many thanks for your time and suggestions in advance!
> >>>
> >>>
> >>> Tom Hengl
> >>> http://home.medewerker.uva.nl/t.hengl/
> >>>
> >>> _______________________________________________
> >>> R-sig-Geo mailing list
> >>> R-sig-Geo at stat.math.ethz.ch
> >>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>>
> >>>
> >>>
> >>
> >> _______________________________________________
> >> R-sig-Geo mailing list
> >> R-sig-Geo at stat.math.ethz.ch
> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>
> >>
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> 
> --
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no


From bfissel at ucsd.edu  Thu Apr  2 18:33:27 2009
From: bfissel at ucsd.edu (Ben Fissel)
Date: Thu, 2 Apr 2009 09:33:27 -0700
Subject: [R-sig-Geo] Time series analysis with irregular time-series
In-Reply-To: <49D484C4.8E3B.0073.0@csir.co.za>
References: <49D484C4.8E3B.0073.0@csir.co.za>
Message-ID: <ca69cc1d0904020933v10c301e7i7434f5a6545feea7@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090402/5729c8a6/attachment.pl>

From Roger.Bivand at nhh.no  Thu Apr  2 19:11:21 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 2 Apr 2009 19:11:21 +0200 (CEST)
Subject: [R-sig-Geo] Running analysis on DEMs using GRASS (from R?)
In-Reply-To: <11834E23EAFF492E99B95BFC3AB44C0B@pcibed193>
References: <F3CCD791B842448D8E3A79D8906FE683@pcibed193>
	<49C9FD52.3040800@gmail.com>
	<92BE129F1A234A14AA6BE88F0649749C@pcibed193>
	<49CA153D.20207@gmail.com>
	<alpine.LRH.2.00.0903251321150.362@reclus.nhh.no>
	<11834E23EAFF492E99B95BFC3AB44C0B@pcibed193>
Message-ID: <alpine.LRH.2.00.0904021902170.6661@reclus.nhh.no>

On Thu, 2 Apr 2009, Tomislav Hengl wrote:

>
> Thanks to Roger (and with many useful comments from Augustin) GRASS just 
> got another big user - possible even many more :)
>
> Roger has prepared an update of his package spgrass6 that can now be used to control the GRASS
> processing from R (functions: "initGRASS", "execGRASS"). This way one can skip some manual settings
> of GRASS (environmental parameters) and just continue with the analysis (this is now really easy).
> These are the installation steps (MS Windows machines):
>
> 1. Download and install GRASS 6 (e.g. from http://grass.itc.it/grass63/binary/mswindows/native/)
> 2. Install the updated version of the spgrass6 package (from
> http://spatial.nhh.no/R/Devel/spgrass6_0.6-1.zip)

Thanks, Tom!

The revised package will be released to CRAN in the usual way after a 
testing period - any comments and suggestions for corrections and 
improvements may be sent to me directly (or possibly the lower volume 
statgrass list, this list goes out to lots of people nowadays). When it is 
a bit more polished, I'll post here too. The source package may be checked 
out from sourceforge (project r-spatial, module spgrass6) in the usual way 
- I've tested on Linux, but not on OSX.

Existing users of spgrass6 can carry on as before (everything should still 
work), but the package now also depends on the XML package, used for 
parsing GRASS command interface descriptions. This means that you may need 
to install XML too.

Hoping for feedback,

Roger

> 3. Start R and then run the following code:
>
> # obtain the data:
>> download.file("http://geomorphometry.org/data/dem25m.zip",
> destfile=paste(getwd(),"dem25m.zip",sep="/"))
>> fname <- zip.file.extract(file="DEM25m.asc", zipname="dem25m.zip")
>> file.copy(fname, "./DEM25m.asc", overwrite=TRUE)
>
>> library(spgrass6)
> # Location of your GRASS installation:
>> loc <- initGRASS("C:/GRASS", home=tempdir())
>> loc
> # Import the ArcInfo ASCII file to GRASS:
>> execGRASS("r.in.gdal", flags="o", parameters=list(input="DEM25m.asc", output="DEM"))
>> execGRASS("g.region", parameters=list(rast="DEM"))
>> gmeta6()
> # extract the drainage network:
>> execGRASS("r.watershed", flags="overwrite", parameters=list(elevation="DEM", stream="stream",
> threshold=as.integer(50)))
> # thin the raster map so it can be converted to vectors:
>> execGRASS("r.thin", parameters=list(input="stream", output="streamt"))
> # convert to vectors:
>> execGRASS("r.to.vect", parameters=list(input="streamt", output="streamt", feature="line"))
>> streamt <- readVECT6("streamt")
>> plot(streamt)
>
> Here are some screen shots:
> http://geomorphometry.org/R.asp
>
> Tom Hengl
> http://spatial-analyst.net
>
>
>
>> -----Original Message-----
>> From: Roger Bivand [mailto:Roger.Bivand at nhh.no]
>> Sent: Wednesday, March 25, 2009 1:27 PM
>> To: Agustin Lobo
>> Cc: Tomislav Hengl; carlos.grohmann at gmail.com; r-sig-geo at stat.math.ethz.ch
>> Subject: Re: [R-sig-Geo] Running analysis on DEMs using GRASS (from R?)
>>
>> On Wed, 25 Mar 2009, Agustin Lobo wrote:
>>
>>> Tomislav,
>>>
>>> You set up your grass location and mapset, import your data etc. 
>>> outside R. Then, from the grass console, you start R and run an scrip 
>>> like the one I sent you or tits individual commands. Once you've
>>> done
>>>
>>> require(spgrass6) #Package connecting R<->grass
>>> G <- gmeta6() #Read grass environment
>>>
>>> you can run grass commands using system(), pass results from
>>> R to grass and from grass to R (It's done in the script
>>> I sent you), import raster files (which I normally
>>> don't do: raster files are too large for R in general, I prefer to
>>> use grass for processing and then pass data as tables to R for
>>> the stats; but have no experience with the new raster package made
>>> by Roger
>>
>> The raster package on R-forge is by Robert Hijmans and a team of
>> developers - very interesting, and often the most active project on the
>> whole (very active) site!
>>
>> As you write, spgrass6 itself uses system() within its functions. A year
>> ago I did some work on an automatic interface generator for GRASS commands
>> in R using the interface descriptions provided by GRASS modules in XML.
>> Would there be interest in using these to try to automate the writing of
>> GRASS commands from R? Would anyone like to help? Should spgrass6 be moved
>> from sourceforge CVS to R-forge SVN to make it easier for others to join
>> in?
>>
>> Roger
>>
>>
>>>
>>> Actually, I often use R as an scripting language for grass. I used
>>> to do scripts in the Bourne shell itself (actually, it was csh), but using R
>>> (perhaps python also)
>>> is much easier (and powerful).
>>>
>>> I do not see that many differences between
>>> the way you are using saga and the way you would use grass, except that
>>> for grass you must have your location, mapset and region set. This
>>> is actually very powerful, as (re)defining regions with g.region lets you
>>> restrict
>>> your analysis to an area of interest, which you can change by
>>> repeated calls to g.region that could depend upon a dynamic process.
>>> The same can be done by setting a MASK.
>>>
>>> The script that I sent you is part of a process simulating the spread of an
>>> invasive
>>> plant. Note that all control is within R. You can do the same with R alone,
>>> but
>>> if your raster layers are large, it could become very slow (note that there
>>> is for() loop
>>> in the script, and for() loops have a very low performance in R; as most of
>>> the commands run within the loop are grass commands run through system(),
>>> there is minimum memory built up).
>>>
>>> I've used the grass that comes within QGIS in windows sometimes, but I feel
>>> really not comfortable
>>> doing this type of work outside linux though.
>>>
>>> You seem experienced with saga. Actually, would like to talk to you on a
>>> possible use
>>> of sage from within qgis thanks to the fact that both saga and qgis make use
>>> of python.
>>>
>>> Agus
>>>
>>> Tomislav Hengl wrote:
>>>> Dear Augustin,
>>>>
>>>> Thank you for your message and examples shown (flavored with a bits of
>>>> Portuguese). I am aware of
>>>> the spgrass6 package. I also know that there are plenty of examples for the
>>>> R GRASS connection e.g.
>>>> http://casoilresource.lawr.ucdavis.edu/drupal/node/438, but I would still
>>>> like to see how an R
>>>> script would look like for the case study shown below
>>>> ("http:/www.geomorphometry.org/data/DEM25m.zip"; extraction of channel
>>>> network).
>>>> I am still confused whether GRASS can be run from R (or is it only the
>>>> other way around?)? how to
>>>> import the data into GRASS (e.g. ArcInfo ASCII)? how to set-up the
>>>> parameters of the GRASS
>>>> environment (working directory, projection system etc)? how to control the
>>>> processing from R (e.g.
>>>> using "system(...)"), and then read the results of analysis back to R?
>>>> Please excuse my ignorance (and the fact that I am a MS Windows user). I am
>>>> just a beginner with
>>>> GRASS, so it could be that things are much simpler than they seem (it could
>>>> also be that they are
>>>> also much more complicated).
>>>>
>>>>
>>>> Many thanks,
>>>>
>>>> Tom Hengl
>>>> http://home.medewerker.uva.nl/t.hengl/
>>>>
>>>>
>>>> -----Original Message-----
>>>> From: Agustin Lobo [mailto:alobolistas at gmail.com] Sent: Wednesday, March
>>>> 25, 2009 10:46 AM
>>>> To: Tomislav Hengl
>>>> Cc: r-sig-geo at stat.math.ethz.ch; carlos.grohmann at gmail.com
>>>> Subject: Re: [R-sig-Geo] Running analysis on DEMs using GRASS (from R?)
>>>>
>>>> Tomislav,
>>>>
>>>> This would be part of an R script using grass:
>>>>
>>>> "brachspread" <- function(itmax=1,a=-1)
>>>> {
>>>> #Do the next once per session
>>>> #attach("/media/mifat32/Rutils/utiles.rda")
>>>> #Execute grass command: import tiff file into grass
>>>> #Data:
>>>> #manchas (importado de ****)
>>>> #noocup (importado de no_ocupable1.tif, 3==no ocupable)
>>>> #(senderos importado de senderos_raster10m.tif)
>>>> #trailbuf importado de senderos
>>>> #r.buffer -z --o in=senderos out=trailbuf distance=10 units=meters
>>>> #camino:1; contiguo:2; resto, NULL
>>>>
>>>> require(spgrass6) #Package connecting R<->grass
>>>> G <- gmeta6() #Read grass environment
>>>> system("g.region rast=manchas")
>>>>
>>>> system("r.mapcalc 'habqual = if(trailbuf==1,0,trailbuf)'")
>>>> system("r.mapcalc 'habqual = if(habqual==2,0.8,habqual)'")
>>>> system("r.mapcalc 'habqual = if(isnull(habqual),0.5,habqual)'")
>>>>
>>>> #Execute grass command: set region to raster
>>>> system("g.region rast=manchas")
>>>> system("r.mapcalc 'manchasit = manchas'")
>>>>
>>>> #inicio del bucle de itersciones tiempo
>>>> it <-0
>>>> system("r.mapcalc 'prob = 0.000'")
>>>> for(it in 1:itmax) {
>>>> system("r.clump --o in=manchasit out=manchasit.clmp")
>>>> #Execute grass command: create stats file
>>>> system("r.stats -cl in=manchasit.clmp out=delme.txt")
>>>> #Read stats file into R:
>>>> mistat <- read.table("delme.txt",header=F,comment.char="*")
>>>> system("rm delme.txt") #delete garbage
>>>> #Write reclass file for grass
>>>> write.table(mistat, file="delme.txt", row.names=F, col.names=F ,sep="=")
>>>> system("r.reclass --o in=manchasit.clmp out=manchas.sze rules=delme.txt")
>>>> system("rm delme.txt")
>>>>
>>>> etc
>>>>
>>>> Tomislav Hengl wrote:
>>>>
>>>>> Dear list,
>>>>>
>>>>> I am trying to test some DEM analysis functions in GRASS GIS (under MS
>>>>> Windows machines). This is
>>>>>
>>>> my
>>>>
>>>>> first contact with GRASS scripting (I have successfully installed GRASS
>>>>> 6.4 for windows from
>>>>> http://grass.itc.it/grass63/binary/mswindows/native/).
>>>>>
>>>>> For example, with SAGA GIS, I can completely control the analysis from R
>>>>> and use SAGA as external
>>>>> application to run the processing, e.g. to extract the drainage networks
>>>>> from a DEM:
>>>>>
>>>>>
>>>>>> library(rgdal)
>>>>>> library(RSAGA)
>>>>>>
>>>>> # obtain the data:
>>>>> download.file("http://www.geomorphometry.org/data/DEM25m.zip",
>>>>> destfile=paste(getwd(),"DEM25m.zip",sep="/"))
>>>>> fname <- zip.file.extract(file="DEM25m.asc", zipname="DEM25m.zip")
>>>>> file.copy(fname, "./DEM25m.asc", overwrite=TRUE)
>>>>>
>>>>> # load to SAGA format:
>>>>>
>>>>>> rsaga.esri.to.sgrd(in.grids="dem25m.asc", out.sgrds="dem25m.sgrd",
>>>>>> in.path=getwd())
>>>>>>
>>>>> # Fill the spurious sinks:
>>>>>
>>>>>> rsaga.geoprocessor(lib="ta_preprocessor", module=2,
>>>>>> param=list(DEM="dem25m.sgrd",
>>>>>>
>>>>> RESULT="dem25m_f.sgrd", MINSLOPE=0.05))
>>>>> # extract the channel network:
>>>>>
>>>>>> rsaga.geoprocessor(lib="ta_channels", module=0,
>>>>>> param=list(ELEVATION="dem25m_f.sgrd",
>>>>>>
>>>>> CHNLNTWRK="channel_ntwrk.sgrd", CHNLROUTE="channel_route.sgrd",
>>>>> SHAPES="channels.shp",
>>>>> INIT_GRID="dem25m_f.sgrd", DIV_CELLS=3, MINLEN=40))
>>>>> # read back to R:
>>>>>
>>>>>> channels <- readOGR("channels.shp", "channels")
>>>>>> spplot(channels["LENGTH"], col.regions=bpy.colors())
>>>>>>
>>>>> How could I run the same processing using GRASS? Can you control GRASS
>>>>> from R at all? (I would be
>>>>>
>>>> a
>>>>
>>>>> bit disappointed with GRASS if I am not able to run the analysis from R).
>>>>>
>>>>> Many thanks for your time and suggestions in advance!
>>>>>
>>>>>
>>>>> Tom Hengl
>>>>> http://home.medewerker.uva.nl/t.hengl/
>>>>>
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at stat.math.ethz.ch
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>
>>>>>
>>>>>
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at stat.math.ethz.ch
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>>
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>> --
>> Roger Bivand
>> Economic Geography Section, Department of Economics, Norwegian School of
>> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From grenyer at imperial.ac.uk  Thu Apr  2 21:28:30 2009
From: grenyer at imperial.ac.uk (Grenyer, Richard)
Date: Thu, 2 Apr 2009 20:28:30 +0100
Subject: [R-sig-Geo] How can I overlay classified points onto a
	SpatialPolygons plot
Message-ID: <D84D8DA52F55334CA57709F6D3B47DD602D3B887@icex6.ic.ac.uk>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090402/1aa48a45/attachment.pl>

From jrbouldin at ucdavis.edu  Thu Apr  2 23:25:18 2009
From: jrbouldin at ucdavis.edu (Jim Bouldin)
Date: Thu, 2 Apr 2009 14:25:18 -0700 (PDT)
Subject: [R-sig-Geo] statistical tests under spatial autocorrelation
Message-ID: <200904022125.n32LPIEk020226@citheronia.ucdavis.edu>


I cannot seem to find any packages/functions that take spatial
autocorrelation into account , by whatever method, when performing
statistical tests.  Any pointers appreciated.  Thanks


Jim Bouldin, PhD
Research Ecologist
Department of Plant Sciences, UC Davis
Davis CA, 95616
530-554-1740


From Thierry.ONKELINX at inbo.be  Thu Apr  2 23:56:46 2009
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Thu, 2 Apr 2009 23:56:46 +0200
Subject: [R-sig-Geo] statistical tests under spatial autocorrelation
In-Reply-To: <200904022125.n32LPIEk020226@citheronia.ucdavis.edu>
References: <200904022125.n32LPIEk020226@citheronia.ucdavis.edu>
Message-ID: <2E9C414912813E4EB981326983E0A104064B81CA@inboexch.inbo.be>

Dear Jim,

Dormann et al (2007) gives a nice summary.

@ARTICLE{DormannEtAl2007,
  author = {Dormann, Carsten F. and McPherson, Jana M. and Ara\'{u}jo,
Miguel
	B. and Bivand, Roger and Bolliger, Janine and Carl, Gudrun and
Davies,
	Richart G. and Hirzel, Alexandre and Jetz, Walter and Kissling,
W.
	Daniel and K\"{u}hn, Ingolf and Ohlem\"{u}ller, Ralf and
Peres-Neto,
	Pedro R. and Reineking, Bj\"{o}rn and Schr\"{o}der, Boris and
Schurr,
	Frank M. and Wilson, Robert},
  title = {Methods to acount for spatial autocorrelation in the analysis
of
	species distributional data: a review},
  journal = {Ecography},
  year = {2007},
  volume = {30},
  pages = {609-628},
  doi = {10.1111/j.2007.0906-7590.05171.x}
} 

HTH,

Thierry
------------------------------------------------------------------------
----
ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Research Institute for Nature
and Forest
Cel biometrie, methodologie en kwaliteitszorg / Section biometrics,
methodology and quality assurance
Gaverstraat 4
9500 Geraardsbergen
Belgium 
tel. + 32 54/436 185
Thierry.Onkelinx at inbo.be 
www.inbo.be 

To call in the statistician after the experiment is done may be no more
than asking him to perform a post-mortem examination: he may be able to
say what the experiment died of.
~ Sir Ronald Aylmer Fisher

The plural of anecdote is not data.
~ Roger Brinner

The combination of some data and an aching desire for an answer does not
ensure that a reasonable answer can be extracted from a given body of
data.
~ John Tukey

-----Oorspronkelijk bericht-----
Van: r-sig-geo-bounces at stat.math.ethz.ch
[mailto:r-sig-geo-bounces at stat.math.ethz.ch] Namens Jim Bouldin
Verzonden: donderdag 2 april 2009 23:25
Aan: r-sig-geo at stat.math.ethz.ch
Onderwerp: [R-sig-Geo] statistical tests under spatial autocorrelation


I cannot seem to find any packages/functions that take spatial
autocorrelation into account , by whatever method, when performing
statistical tests.  Any pointers appreciated.  Thanks


Jim Bouldin, PhD
Research Ecologist
Department of Plant Sciences, UC Davis
Davis CA, 95616
530-554-1740

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Dit bericht en eventuele bijlagen geven enkel de visie van de schrijver weer 
en binden het INBO onder geen enkel beding, zolang dit bericht niet bevestigd is
door een geldig ondertekend document. The views expressed in  this message 
and any annex are purely those of the writer and may not be regarded as stating 
an official position of INBO, as long as the message is not confirmed by a duly 
signed document.


From horning at amnh.org  Fri Apr  3 10:17:10 2009
From: horning at amnh.org (Ned Horning)
Date: Fri, 03 Apr 2009 11:17:10 +0300
Subject: [R-sig-Geo] Write GeoTiff with color table
Message-ID: <49D5C606.4040506@amnh.org>

Hi - Is it possible to output an Indexed (single band byte image) 
GeoTiff using a predefined look-up-table in R? For now I output a byte 
GeoTiff file from R and then import it into GRASS, create a color table, 
and then export that as a colored GeoTiff. That works fine but it would 
be nice to be able to create the colored GeoTiff directly in R.

All the best,

Ned


From p.hiemstra at geo.uu.nl  Fri Apr  3 11:10:32 2009
From: p.hiemstra at geo.uu.nl (Paul Hiemstra)
Date: Fri, 03 Apr 2009 11:10:32 +0200
Subject: [R-sig-Geo] Write GeoTiff with color table
In-Reply-To: <49D5C606.4040506@amnh.org>
References: <49D5C606.4040506@amnh.org>
Message-ID: <49D5D288.9010704@geo.uu.nl>

Ned Horning schreef:
> Hi - Is it possible to output an Indexed (single band byte image) 
> GeoTiff using a predefined look-up-table in R? For now I output a byte 
> GeoTiff file from R and then import it into GRASS, create a color 
> table, and then export that as a colored GeoTiff. That works fine but 
> it would be nice to be able to create the colored GeoTiff directly in R.
>
> All the best,
>
> Ned
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
Hi,

You can create color RGB tiffs using the functions I wrote once. Hope it 
helps!

Paul

val2rgb = function(val, color, at)
# Function to map the value to an RGB value
{
    for(i in 1:length(at))
    {
        if(val <= at[i]) return(color[i])
    }
    return(color[length(color)])
}

writeTIFF = function(data, column_name, file, color, at, style = "quantile")
# Function to construct a color (RGB) GeoTIFF
#
# data :        The data for making the GeoTIFF
# file :        file for storing the tif file
# column_name : The name of the column in 'data' that is used for the 
GeoTIFF
# color :       A list with the colors that will be used. Most used is 
output
#               from functions such as 'rainbow' and 'RColorBrewer'.
# at :          The data values where the colors change.
{
        print(paste("writing",file))

    data2color = sapply(data[[column_name]], FUN = function(x) 
val2rgb(x, color,
    data2rgb = col2rgb(data2color)

    data$band1 = data2rgb["red",]
    data$band2 = data2rgb["green",]
    data$band3 = data2rgb["blue",]

    writeGDAL(data[c("band1","band2","band3")],file,type="Byte")
}

-- 
Drs. Paul Hiemstra
Department of Physical Geography
Faculty of Geosciences
University of Utrecht
Heidelberglaan 2
P.O. Box 80.115
3508 TC Utrecht
Phone:  +3130 274 3113 Mon-Tue
Phone:  +3130 253 5773 Wed-Fri
http://intamap.geo.uu.nl/~paul


From p.hiemstra at geo.uu.nl  Fri Apr  3 13:09:21 2009
From: p.hiemstra at geo.uu.nl (Paul Hiemstra)
Date: Fri, 03 Apr 2009 13:09:21 +0200
Subject: [R-sig-Geo] Write GeoTiff with color table
In-Reply-To: <49D5D288.9010704@geo.uu.nl>
References: <49D5C606.4040506@amnh.org> <49D5D288.9010704@geo.uu.nl>
Message-ID: <49D5EE61.9030006@geo.uu.nl>

Paul Hiemstra schreef:
> Ned Horning schreef:
>> Hi - Is it possible to output an Indexed (single band byte image) 
>> GeoTiff using a predefined look-up-table in R? For now I output a 
>> byte GeoTiff file from R and then import it into GRASS, create a 
>> color table, and then export that as a colored GeoTiff. That works 
>> fine but it would be nice to be able to create the colored GeoTiff 
>> directly in R.
>>
>> All the best,
>>
>> Ned
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> Hi,
>
> You can create color RGB tiffs using the functions I wrote once. Hope 
> it helps!
>
> Paul
>
> val2rgb = function(val, color, at)
> # Function to map the value to an RGB value
> {
>    for(i in 1:length(at))
>    {
>        if(val <= at[i]) return(color[i])
>    }
>    return(color[length(color)])
> }
>
> writeTIFF = function(data, column_name, file, color, at, style = 
> "quantile")
In addition: the style argument should be left out.

cheers and goodluck,
Paul
> # Function to construct a color (RGB) GeoTIFF
> #
> # data :        The data for making the GeoTIFF
> # file :        file for storing the tif file
> # column_name : The name of the column in 'data' that is used for the 
> GeoTIFF
> # color :       A list with the colors that will be used. Most used is 
> output
> #               from functions such as 'rainbow' and 'RColorBrewer'.
> # at :          The data values where the colors change.
> {
>        print(paste("writing",file))
>
>    data2color = sapply(data[[column_name]], FUN = function(x) 
> val2rgb(x, color,
>    data2rgb = col2rgb(data2color)
>
>    data$band1 = data2rgb["red",]
>    data$band2 = data2rgb["green",]
>    data$band3 = data2rgb["blue",]
>
>    writeGDAL(data[c("band1","band2","band3")],file,type="Byte")
> }
>


-- 
Drs. Paul Hiemstra
Department of Physical Geography
Faculty of Geosciences
University of Utrecht
Heidelberglaan 2
P.O. Box 80.115
3508 TC Utrecht
Phone:  +3130 274 3113 Mon-Tue
Phone:  +3130 253 5773 Wed-Fri
http://intamap.geo.uu.nl/~paul


From corey.sparks at UTSA.EDU  Fri Apr  3 15:21:47 2009
From: corey.sparks at UTSA.EDU (Corey Sparks)
Date: Fri, 3 Apr 2009 08:21:47 -0500
Subject: [R-sig-Geo] statistical tests under spatial autocorrelation
Message-ID: <178CAC5A-56D3-4820-87CD-ABE4BAF0C8EC@utsa.edu>

Jim,
Look at the spdep package for several regression methods that  
incorporate spatial dependence and structure.
CS

Corey Sparks
Assistant Professor
Department of Demography and Organization Studies
College of Public Policy
One UTSA Circle
San Antonio, TX 78239
corey.sparks at utsa.edu


From milton.ruser at gmail.com  Fri Apr  3 19:52:15 2009
From: milton.ruser at gmail.com (milton ruser)
Date: Fri, 3 Apr 2009 13:52:15 -0400
Subject: [R-sig-Geo] rasterize shape file and output as .img
Message-ID: <3aaf1a030904031052m1aafc74elfc6ff2d0522e38f2@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090403/6de4487a/attachment.pl>

From Roger.Bivand at nhh.no  Fri Apr  3 21:40:51 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 3 Apr 2009 21:40:51 +0200 (CEST)
Subject: [R-sig-Geo] rasterize shape file and output as .img
In-Reply-To: <3aaf1a030904031052m1aafc74elfc6ff2d0522e38f2@mail.gmail.com>
References: <3aaf1a030904031052m1aafc74elfc6ff2d0522e38f2@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.0904032137050.27318@reclus.nhh.no>

On Fri, 3 Apr 2009, milton ruser wrote:

> Dear all,
>
> I have a set of shapefile and I need rasterized it using a collumn called
> ClassCover,
> and with the resolution of 30 meters. How can I do this on R?

Use bbox() of the SpatialPolygonDataFrame to find the extent. Create a 
GridTopology object, and overlay the polygons - possibly just with 
ClassCover - and the SpatialGrid built with the GridTopology object. This 
should yield a SpatialGridDataFrame with a single band, with NAs outside 
the polygons, and the polygon column values for raster cells where their 
centres fall inside the polygons.

> Another thing is that I need to output the raster as IMG (erdas/arcgis)
> format.

writeGDAL in rgdal.

Hope this helps,

Roger

>
> Any help are welcome.
>
> Best wishes,
>
> milton
> Brasil/Toronto
>
>> require(maptools)
>> require(sp)
>> require(rgdal)
>> todos<-readShapePoly("myshape.shp")
>> sessionInfo()
> R version 2.9.0 alpha (2009-03-26 r48224)
> i386-pc-mingw32
> locale:
> LC_COLLATE=English_Canada.1252;LC_CTYPE=English_Canada.1252;LC_MONETARY=English_Canada.1252;LC_NUMERIC=C;LC_TIME=English_Canada.1252
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> other attached packages:
> [1] rgdal_0.6-7     maptools_0.7-20 sp_0.9-32       foreign_0.8-34
> loaded via a namespace (and not attached):
> [1] grid_2.9.0      lattice_0.17-20
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From pzs6 at CDC.GOV  Fri Apr  3 22:01:02 2009
From: pzs6 at CDC.GOV (Smith, Phil (CDC/CCID/NCIRD))
Date: Fri, 3 Apr 2009 16:01:02 -0400
Subject: [R-sig-Geo] County-level map of the US
Message-ID: <48069ED5E7CE234C8FC2BE2FE878BAA504F7A928@LTA3VS012.ees.hhs.gov>


 Hi R-sig:

I'm just an old guy and new to this list... But have been using R for
years now.

I want to make a map of couties in the US with shaded colors that depend
on the level of variable "Y" that I want to map.

I have the US county and state fips codes and the Y variable.

How do I do this?

Please reply to pzs6 at cdc.gov

Thanks,
Phil Smith
pzs6 at cdc.gov
 


From milton.ruser at gmail.com  Sat Apr  4 01:55:31 2009
From: milton.ruser at gmail.com (milton ruser)
Date: Fri, 3 Apr 2009 19:55:31 -0400
Subject: [R-sig-Geo] rasterize shape file and output as .img
In-Reply-To: <alpine.LRH.2.00.0904032137050.27318@reclus.nhh.no>
References: <3aaf1a030904031052m1aafc74elfc6ff2d0522e38f2@mail.gmail.com>
	<alpine.LRH.2.00.0904032137050.27318@reclus.nhh.no>
Message-ID: <3aaf1a030904031655m68d9d663pff08f493093759f9@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090403/7cb001d5/attachment.pl>

From murray.richardson at utoronto.ca  Sat Apr  4 02:55:38 2009
From: murray.richardson at utoronto.ca (Murray Richardson)
Date: Fri, 03 Apr 2009 20:55:38 -0400
Subject: [R-sig-Geo] error in trmesh (alphahull package)
Message-ID: <49D6B00A.4000309@utoronto.ca>

Hello R community,

I have cross-posted with r-sig-geo as this issue could fall under either 
interest group I believe. 

I just came accross the alphahull package and am very pleased I may not 
need to use CGAL anymore for this purpose.   However, I am having a 
problem computing alpha shapes with my point data, and it seems to have 
to do with the spatial configuration of my points (which form long, 
skinny, contiguous clusters).  If I use rnorm to generate the same 
sample size with the same mean and SD, I can compute the alpha shape 
without trouble (which is why I think it might have to do with the 
spatial arrangement of my points).  See below:

# first here's a quick sample of my data (UTM coordinates)
 > xcoords[1:5]
[1] 670080.2 670080.2 670080.2 670080.2 670080.2
 > ycoords[1:5]
[1] 5005501 5005499 5005498 5005497 5005495
 > xcoords[1:5]
#try the ashape routine with error
 > alpha.shape<-ashape(xcoords,ycoords,15)
Error in tri.mesh(X) : error in trmesh

#get statistics to generate a similar dataset to test against
 > length(xcoords)
[1] 26257
 > length(ycoords)
[1] 26257
 > mean(xcoords)
[1] 670462.4
 > mean(ycoords)
[1] 5005382
 > sd(xcoords)
[1] 149.3114
 > sd(ycoords)
[1] 181.5950

#generate the test data
 > xtest<-rnorm(26257,670462.4,149.3)
 > ytest<-rnorm(26257,5005382,181.60)

# try ashape routine with success
 > alpha.shape<-ashape(xtest,ytest,15)
 > class(alpha.shape)
[1] "ashape"

Thanks for any insight into this!

Murray

ps I am able to compute the alpha shapes for this same dataset without 
problem using CGAL but I find it a pain to work with....


From Roger.Bivand at nhh.no  Sat Apr  4 12:26:57 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 4 Apr 2009 12:26:57 +0200 (CEST)
Subject: [R-sig-Geo] rasterize shape file and output as .img
In-Reply-To: <3aaf1a030904031655m68d9d663pff08f493093759f9@mail.gmail.com>
References: <3aaf1a030904031052m1aafc74elfc6ff2d0522e38f2@mail.gmail.com>
	<alpine.LRH.2.00.0904032137050.27318@reclus.nhh.no>
	<3aaf1a030904031655m68d9d663pff08f493093759f9@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.0904041221080.29713@reclus.nhh.no>

On Fri, 3 Apr 2009, milton ruser wrote:

> Hi Roger,
>
> I think I am making something wrong (see the error message, please).
> reser is the polygon object that I read from a shapefile.
>
> Thanks for your time.
>
> milton
>
>> class(reser)
> [1] "SpatialPolygonsDataFrame"
> attr(,"package")
> [1] "sp"
>> head(reser at data)
>            DOCNAME  area_ha ClassCover
> 22 JRN-720 - 271,0m 8022.687          1
>>
>> reser.bbox<-bbox(reser)
>> resolution<-c(60,60) #meters
>>
>> #GridTopology(cellcentre.offset, cellsize, cells.dim)
>> ccoffset<-c(reser.bbox[,1])
>> cdim<-round((reser.bbox[,2]-reser.bbox[,1])/resolution[1],0)+1
>>
>> gride<-GridTopology(ccoffset, resolution, cdim)
>>
>> str(gride)
> Formal class 'GridTopology' [package "sp"] with 3 slots
>  ..@ cellcentre.offset: Named num [1:2] 283916 8578881
>  .. ..- attr(*, "names")= chr [1:2] "r1" "r2"
>  ..@ cellsize         : num [1:2] 60 60
>  ..@ cells.dim        : int [1:2] 313 1280
>>
>> overlay(reser at data$ClassCover, gride)
> Error in function (classes, fdef, mtable)  :
>  unable to find an inherited method for function "overlay", for signature
> "numeric", "GridTopology"

Try SpatialGrid(gride) instead - look at getMethods(overlay) if it helps 
(it may not, there are many methods). Also see the thread on this list (a 
reply: http://finzi.psych.upenn.edu/R/Rhelp08/2009-February/005049.html). 
RSiteSearch("rasterize") does help.

Roger

>
>
> On Fri, Apr 3, 2009 at 3:40 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> On Fri, 3 Apr 2009, milton ruser wrote:
>>
>> Dear all,
>>>
>>> I have a set of shapefile and I need rasterized it using a collumn called
>>> ClassCover,
>>> and with the resolution of 30 meters. How can I do this on R?
>>>
>>
>> Use bbox() of the SpatialPolygonDataFrame to find the extent. Create a
>> GridTopology object, and overlay the polygons - possibly just with
>> ClassCover - and the SpatialGrid built with the GridTopology object. This
>> should yield a SpatialGridDataFrame with a single band, with NAs outside the
>> polygons, and the polygon column values for raster cells where their centres
>> fall inside the polygons.
>>
>> Another thing is that I need to output the raster as IMG (erdas/arcgis)
>>> format.
>>>
>>
>> writeGDAL in rgdal.
>>
>> Hope this helps,
>>
>> Roger
>>
>>
>>> Any help are welcome.
>>>
>>> Best wishes,
>>>
>>> milton
>>> Brasil/Toronto
>>>
>>> require(maptools)
>>>> require(sp)
>>>> require(rgdal)
>>>> todos<-readShapePoly("myshape.shp")
>>>> sessionInfo()
>>>>
>>> R version 2.9.0 alpha (2009-03-26 r48224)
>>> i386-pc-mingw32
>>> locale:
>>>
>>> LC_COLLATE=English_Canada.1252;LC_CTYPE=English_Canada.1252;LC_MONETARY=English_Canada.1252;LC_NUMERIC=C;LC_TIME=English_Canada.1252
>>> attached base packages:
>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>> other attached packages:
>>> [1] rgdal_0.6-7     maptools_0.7-20 sp_0.9-32       foreign_0.8-34
>>> loaded via a namespace (and not attached):
>>> [1] grid_2.9.0      lattice_0.17-20
>>>
>>>        [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>> --
>> Roger Bivand
>> Economic Geography Section, Department of Economics, Norwegian School of
>> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From jmblanco at ub.edu  Sat Apr  4 13:43:09 2009
From: jmblanco at ub.edu (=?ISO-8859-1?Q?Jos=E9_Manuel_Blanco_Moreno?=)
Date: Sat, 04 Apr 2009 13:43:09 +0200
Subject: [R-sig-Geo] error in trmesh (alphahull package)
In-Reply-To: <49D6B00A.4000309@utoronto.ca>
References: <49D6B00A.4000309@utoronto.ca>
Message-ID: <49D747CD.5020701@ub.edu>

Hello,
The problem is that your first three points CANNOT be collinear. This is 
a feature of trmesh in tripack. So: either you "unsort" your data 
(keeping the indices you can sort them again) or alter (e.g. jitter) the 
coordinates very slightly. Either solution will do the work.
Cheers,
Jos? M. Blanco


Murray Richardson escribi?:
> Hello R community,
>
> I have cross-posted with r-sig-geo as this issue could fall under 
> either interest group I believe.
> I just came accross the alphahull package and am very pleased I may 
> not need to use CGAL anymore for this purpose.   However, I am having 
> a problem computing alpha shapes with my point data, and it seems to 
> have to do with the spatial configuration of my points (which form 
> long, skinny, contiguous clusters).  If I use rnorm to generate the 
> same sample size with the same mean and SD, I can compute the alpha 
> shape without trouble (which is why I think it might have to do with 
> the spatial arrangement of my points).  See below:
>
> # first here's a quick sample of my data (UTM coordinates)
> > xcoords[1:5]
> [1] 670080.2 670080.2 670080.2 670080.2 670080.2
> > ycoords[1:5]
> [1] 5005501 5005499 5005498 5005497 5005495
> > xcoords[1:5]
> #try the ashape routine with error
> > alpha.shape<-ashape(xcoords,ycoords,15)
> Error in tri.mesh(X) : error in trmesh
>
> #get statistics to generate a similar dataset to test against
> > length(xcoords)
> [1] 26257
> > length(ycoords)
> [1] 26257
> > mean(xcoords)
> [1] 670462.4
> > mean(ycoords)
> [1] 5005382
> > sd(xcoords)
> [1] 149.3114
> > sd(ycoords)
> [1] 181.5950
>
> #generate the test data
> > xtest<-rnorm(26257,670462.4,149.3)
> > ytest<-rnorm(26257,5005382,181.60)
>
> # try ashape routine with success
> > alpha.shape<-ashape(xtest,ytest,15)
> > class(alpha.shape)
> [1] "ashape"
>
> Thanks for any insight into this!
>
> Murray
>
> ps I am able to compute the alpha shapes for this same dataset without 
> problem using CGAL but I find it a pain to work with....
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


-- 
---------------------------------------
Jos? M. Blanco Moreno

Dept. de Biologia Vegetal (Bot?nica)
Universitat de Barcelona
Av. Diagonal 645 
08028 Barcelona SPAIN
---------------------------------------

phone: (+34) 934 039 863
fax: (+34) 934 112 842
e-mail: jmblanco at ub.edu 


From corey.sparks at UTSA.EDU  Sat Apr  4 15:46:59 2009
From: corey.sparks at UTSA.EDU (Corey Sparks)
Date: Sat, 4 Apr 2009 08:46:59 -0500
Subject: [R-sig-Geo] County-level map of the US
Message-ID: <71BAAA8E-EE46-4646-8310-0CD5AB626759@utsa.edu>

Hi Phil,
I saw your post and have been doing this exact thing for the US  
recently.  Do you have a county shapefile?  You will need this to join  
your data (Y) to.  I typically use ArcGIS to join my attribute data   
to my shapefiles, but I don't know if you have access to this  
software.  This is ONE way to do it there are lots of different ways  
to plot geographic data in polygons, so hopefully this will get you  
started.

Here is an example from some of my work, you need 3 libraries (and  
their dependencies installed: classInt, maptools and RColorBrewer
library(classInt)
library(maptools)
library(RColorBrewer)

##Read in the us county shapefile, I had my data in Lambert Conformal  
Conic projected coordinate system, you would have to change the  
proj4string to what your projection is
usdat<-readShapeSpatial(fn="us.county.shp",  
proj4string=CRS("+proj=lcc"))

#Find the "break levels" for classifying numeric values of Y into  
discrete intervals, this uses the Jenks/Fisher method which looks  for  
natural breaks in the data
brks.Y<-classIntervals(usdat$Y, n=5, style="fisher")

#Define a color ramp of increasing intensity Blues
cols<-brewer.pal(5,"Blues")

#Plot the polygons, plotting each county with a color corresponding to  
its attribute value Y
plot(usdat, col=cols[findInterval(usdat$Y, brks.Y, all.inside=T)],  
border=0.1)
title(main="County Plot of Y")
labs<-leglabs(brks.Y, under="Under", over="Over", between="to")
legend("bottomleft",legend=labs, cex=.9, fill=brewer.pal(5,"Blues"))

If you need the US shapefile, you can get them from the Census  
Cartographic Boundary files:
http://www.census.gov/geo/www/cob/

Hope this gets you started
Corey

Corey Sparks
Assistant Professor
Department of Demography and Organization Studies
College of Public Policy
One UTSA Circle
San Antonio, TX 78239
corey.sparks at utsa.edu

Responding To:
Hi R-sig:

I'm just an old guy and new to this list... But have been using R for
years now.

I want to make a map of couties in the US with shaded colors that depend
on the level of variable "Y" that I want to map.

I have the US county and state fips codes and the Y variable.

How do I do this?

Please reply to pzs6 at cdc.gov

Thanks,
Phil Smith
pzs6 at cdc.gov


From gianni.lavaredo at gmail.com  Sat Apr  4 17:54:41 2009
From: gianni.lavaredo at gmail.com (gianni lavaredo)
Date: Sat, 4 Apr 2009 17:54:41 +0200
Subject: [R-sig-Geo] extract value from grid and calculate weighted.mean of
	pixel
Message-ID: <518dff330904040854v6e0d2ae7o5f19fa9542e06084@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090404/e791fd40/attachment.pl>

From facrimas at libero.it  Sat Apr  4 19:18:12 2009
From: facrimas at libero.it (facrimas at libero.it)
Date: Sat, 4 Apr 2009 19:18:12 +0200 (CEST)
Subject: [R-sig-Geo] hscattergram between two different variables
Message-ID: <12380410.1540151238865492055.JavaMail.root@wmail49>


Dear all,


I want to plot the cross hscattergram between two different variables.

I used the following instruction:

hscat(jura.pred$Cd~jura.pred$Zn, jura.pred, c(0, 0.1, 0.2, 0.3, 0.5, 1), 
alpha=c(0,45))

where jura.pred$Cd and jura.pred$Ni are the two variables, but the result 
obtained is the same of the univariate case when I put 1 instead of jura.
pred$Zn.

Can you help me?

Thanks

Cristiano

>----Messaggio originale----
>Da: Roger.Bivand at nhh.no
>Data: 03/04/2009 21.40
>A: "milton ruser"<milton.ruser at gmail.com>
>Cc: <r-sig-geo at stat.math.ethz.ch>
>Ogg: Re: [R-sig-Geo] rasterize shape file and output as .img
>
>On Fri, 3 Apr 2009, milton ruser wrote:
>
>> Dear all,
>>
>> I have a set of shapefile and I need rasterized it using a collumn called
>> ClassCover,
>> and with the resolution of 30 meters. How can I do this on R?
>
>Use bbox() of the SpatialPolygonDataFrame to find the extent. Create a 
>GridTopology object, and overlay the polygons - possibly just with 
>ClassCover - and the SpatialGrid built with the GridTopology object. This 
>should yield a SpatialGridDataFrame with a single band, with NAs outside 
>the polygons, and the polygon column values for raster cells where their 
>centres fall inside the polygons.
>
>> Another thing is that I need to output the raster as IMG (erdas/arcgis)
>> format.
>
>writeGDAL in rgdal.
>
>Hope this helps,
>
>Roger
>
>>
>> Any help are welcome.
>>
>> Best wishes,
>>
>> milton
>> Brasil/Toronto
>>
>>> require(maptools)
>>> require(sp)
>>> require(rgdal)
>>> todos<-readShapePoly("myshape.shp")
>>> sessionInfo()
>> R version 2.9.0 alpha (2009-03-26 r48224)
>> i386-pc-mingw32
>> locale:
>> LC_COLLATE=English_Canada.1252;LC_CTYPE=English_Canada.1252;
LC_MONETARY=English_Canada.1252;LC_NUMERIC=C;LC_TIME=English_Canada.1252
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>> other attached packages:
>> [1] rgdal_0.6-7     maptools_0.7-20 sp_0.9-32       foreign_0.8-34
>> loaded via a namespace (and not attached):
>> [1] grid_2.9.0      lattice_0.17-20
>>
>> 	[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>-- 
>Roger Bivand
>Economic Geography Section, Department of Economics, Norwegian School of
>Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>e-mail: Roger.Bivand at nhh.no
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at stat.math.ethz.ch
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From murray.richardson at utoronto.ca  Sat Apr  4 21:38:29 2009
From: murray.richardson at utoronto.ca (Murray Richardson)
Date: Sat, 04 Apr 2009 15:38:29 -0400
Subject: [R-sig-Geo] error in trmesh (alphahull package)
In-Reply-To: <49D747CD.5020701@ub.edu>
References: <49D6B00A.4000309@utoronto.ca> <49D747CD.5020701@ub.edu>
Message-ID: <49D7B735.3010701@utoronto.ca>

Ahhh - so simple, my mistake.  Thanks!

Murray

Jos? Manuel Blanco Moreno wrote:
> Hello,
> The problem is that your first three points CANNOT be collinear. This 
> is a feature of trmesh in tripack. So: either you "unsort" your data 
> (keeping the indices you can sort them again) or alter (e.g. jitter) 
> the coordinates very slightly. Either solution will do the work.
> Cheers,
> Jos? M. Blanco
>
>
> Murray Richardson escribi?:
>> Hello R community,
>>
>> I have cross-posted with r-sig-geo as this issue could fall under 
>> either interest group I believe.
>> I just came accross the alphahull package and am very pleased I may 
>> not need to use CGAL anymore for this purpose.   However, I am having 
>> a problem computing alpha shapes with my point data, and it seems to 
>> have to do with the spatial configuration of my points (which form 
>> long, skinny, contiguous clusters).  If I use rnorm to generate the 
>> same sample size with the same mean and SD, I can compute the alpha 
>> shape without trouble (which is why I think it might have to do with 
>> the spatial arrangement of my points).  See below:
>>
>> # first here's a quick sample of my data (UTM coordinates)
>> > xcoords[1:5]
>> [1] 670080.2 670080.2 670080.2 670080.2 670080.2
>> > ycoords[1:5]
>> [1] 5005501 5005499 5005498 5005497 5005495
>> > xcoords[1:5]
>> #try the ashape routine with error
>> > alpha.shape<-ashape(xcoords,ycoords,15)
>> Error in tri.mesh(X) : error in trmesh
>>
>> #get statistics to generate a similar dataset to test against
>> > length(xcoords)
>> [1] 26257
>> > length(ycoords)
>> [1] 26257
>> > mean(xcoords)
>> [1] 670462.4
>> > mean(ycoords)
>> [1] 5005382
>> > sd(xcoords)
>> [1] 149.3114
>> > sd(ycoords)
>> [1] 181.5950
>>
>> #generate the test data
>> > xtest<-rnorm(26257,670462.4,149.3)
>> > ytest<-rnorm(26257,5005382,181.60)
>>
>> # try ashape routine with success
>> > alpha.shape<-ashape(xtest,ytest,15)
>> > class(alpha.shape)
>> [1] "ashape"
>>
>> Thanks for any insight into this!
>>
>> Murray
>>
>> ps I am able to compute the alpha shapes for this same dataset 
>> without problem using CGAL but I find it a pain to work with....
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


From gianni.lavaredo at gmail.com  Sat Apr  4 22:04:18 2009
From: gianni.lavaredo at gmail.com (gianni lavaredo)
Date: Sat, 4 Apr 2009 22:04:18 +0200
Subject: [R-sig-Geo] select a pixel with the right value respect the pixel
	around
Message-ID: <518dff330904041304p76ee8ce1s787330ce140e19f9@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090404/8d2904bb/attachment.pl>

From contact at dominikfuchs.com  Sun Apr  5 11:37:39 2009
From: contact at dominikfuchs.com (Dominik Fuchs)
Date: Sun, 05 Apr 2009 02:37:39 -0700
Subject: [R-sig-Geo] =?utf-8?q?R_interface_to_SEXTANTE=3F?=
Message-ID: <20090405023739.0c0c2a9e5faeb1149988f23a38ef111a.3e96b5ccfc.wbe@email04.secureserver.net>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090405/9f61d4a6/attachment.html>

From contact at dominikfuchs.com  Sun Apr  5 11:47:20 2009
From: contact at dominikfuchs.com (Dominik Fuchs)
Date: Sun, 05 Apr 2009 02:47:20 -0700
Subject: [R-sig-Geo] =?utf-8?q?R_interface_to_SEXTANTE=3F?=
Message-ID: <20090405024720.0c0c2a9e5faeb1149988f23a38ef111a.51958ff995.wbe@email04.secureserver.net>

Dear all,

I was wondering if anyone was aware of and/or developing an interface to
the SEXTANTE (www.sextantegis.com) library, along the lines of spgrass6
or RSAGA?  Also, if (as I think) no such project exists, I would be
interested to hear from anyone else wanting to collaborate on the
development of such a package, or has suggestions/wishes/ideas.

All the best,

Nick
 


From renaud.lancelot at cirad.fr  Sun Apr  5 12:30:08 2009
From: renaud.lancelot at cirad.fr (Renaud Lancelot)
Date: Sun, 05 Apr 2009 12:30:08 +0200
Subject: [R-sig-Geo] problem with function project() in package rgdal
Message-ID: <49D88830.80902@cirad.fr>

Dear all,

I meet a problem with the function project() in package rgdal:

> library(rgdal)
> data(state)
> res <- project(cbind(state.center$x, state.center$y),
+                "+proj=lcc +lat_1=48 +lat_2=33 +lon_0=-100")
Error in project(cbind(state.center$x, state.center$y), "+proj=lcc
+lat_1=48 +lat_2=33 +lon_0=-100") :
   major axis or radius = 0 or not given


> sessionInfo()
R version 2.8.1 Patched (2009-02-17 r47956)
i386-pc-mingw32

locale:
LC_COLLATE=French_France.1252;LC_CTYPE=French_France.1252;LC_MONETARY=French_France.1252;LC_NUMERIC=C;LC_TIME=French_France.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods
[7] base

other attached packages:
[1] rgdal_0.6-7    sp_0.9-34      fortunes_1.3-6

loaded via a namespace (and not attached):
[1] grid_2.8.1      lattice_0.17-20 tools_2.8.1
>

Is this a bug?

-- 
Renaud Lancelot
EDEN Project, coordinator
http://www.eden-fp6project.net/

UMR CIRAD-INRA "Contr?le des maladies animales exotiques et ?mergentes"
Joint research unit "Control of emerging and exotic animal diseases"

CIRAD
Campus International de Baillarguet TA A-DIR / B
F34398 Montpellier
http://www.cirad.fr  http://bluetongue.cirad.fr/

Tel.  +33 4 67 59 37 17  -  Fax  +33 4 67 59 37 95
Secr. +33 4 67 59 37 37  - Cell. +33 6 77 52 08 69


From tom.gottfried at wzw.tum.de  Sun Apr  5 14:02:27 2009
From: tom.gottfried at wzw.tum.de (Tom Gottfried)
Date: Sun, 5 Apr 2009 14:02:27 +0200
Subject: [R-sig-Geo] extract value from grid and calculate weighted.mean
	of	pixel
Message-ID: <1D4CA671-201A-41FA-8A4F-68E3CCE5F353@wzw.tum.de>

Hi Gianni,

you could possibly use the function `readShapePoly' in the package  
maptools to import your shapefile into an object of class  
SpatialPolygonsDataFrame. To extract the raster values inside the  
single polygons of your SpatialPolygonsDataFrame-object and to  
calculate their mean you can use the function `overlay' from the  
package sp.

Hope this helps,
Tom


From gianni.lavaredo at gmail.com  Sun Apr  5 22:00:30 2009
From: gianni.lavaredo at gmail.com (gianni lavaredo)
Date: Sun, 5 Apr 2009 22:00:30 +0200
Subject: [R-sig-Geo] merge ascii grid file format with "RASTER" package
Message-ID: <518dff330904051300p725c5be0p4d170a2263c85213@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090405/3ea5c818/attachment.pl>

From milton.ruser at gmail.com  Mon Apr  6 05:22:54 2009
From: milton.ruser at gmail.com (milton ruser)
Date: Sun, 5 Apr 2009 23:22:54 -0400
Subject: [R-sig-Geo] rasterize shape file and output as .img
In-Reply-To: <alpine.LRH.2.00.0904041221080.29713@reclus.nhh.no>
References: <3aaf1a030904031052m1aafc74elfc6ff2d0522e38f2@mail.gmail.com>
	<alpine.LRH.2.00.0904032137050.27318@reclus.nhh.no>
	<3aaf1a030904031655m68d9d663pff08f493093759f9@mail.gmail.com>
	<alpine.LRH.2.00.0904041221080.29713@reclus.nhh.no>
Message-ID: <3aaf1a030904052022j123a5cc8m33d30d1fef732272@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090405/bf34142c/attachment.pl>

From j.burke at earthlink.net  Mon Apr  6 05:46:10 2009
From: j.burke at earthlink.net (Jim Burke)
Date: Sun, 05 Apr 2009 22:46:10 -0500
Subject: [R-sig-Geo] rasterize shape file and output as .img
In-Reply-To: <3aaf1a030904052022j123a5cc8m33d30d1fef732272@mail.gmail.com>
References: <3aaf1a030904031052m1aafc74elfc6ff2d0522e38f2@mail.gmail.com>	<alpine.LRH.2.00.0904032137050.27318@reclus.nhh.no>	<3aaf1a030904031655m68d9d663pff08f493093759f9@mail.gmail.com>	<alpine.LRH.2.00.0904041221080.29713@reclus.nhh.no>
	<3aaf1a030904052022j123a5cc8m33d30d1fef732272@mail.gmail.com>
Message-ID: <49D97B02.50700@earthlink.net>

Milton,

Consider, and implement from the example
below from from R tip a day. It outputs
as an png.
http://onertipaday.blogspot.com/

R PROGRAM. I called mine original_r.txt
original <- read.table("original.txt",row.names=1)
# outputs a nicely sized png to the file below.
png("immigration_barplot_me.png", width = 1419, height = 736)
library(RColorBrewer) # take a look at 
http://www.personal.psu.edu/cab38/ColorBrewer/ColorBrewer_intro.html
# display.brewer.all()
FD.palette <- c("#984EA3","#377EB8","#4DAF4A","#FF7F00","#E41A1C")
options(scipen=10)
par(mar=c(6, 6, 3, 3), las=2)
data4bp <- t(original[,c(5,4,2,3,1)])
barplot( data4bp, beside=F,col=FD.palette, border=FD.palette, space=1, 
legend=F, ylab="Number of People", main="Migration to the United States 
by Source Region (1820 - 2006)", mgp=c(4.5,1,0) )
legend( "topleft", legend=rev(rownames(data4bp)), fill=rev(FD.palette) )
box()
dev.off()

R DATA - save it as ORIGINAL.TXT
Europe Asia Americas Africa Oceania
1820-30 106487 36 11951 17 33333
1831-40 495681 53 33424 54 69911
1841-50 1597442 141 62469 55 53144
1851-60 2452577 41538 74720 210 29169
1861-70 2065141 64759 166607 312 18005
1871-80 2271925 124160 404044 358 11704
1881-90 4735484 69942 426967 857 13363
1891-00 3555352 74862 38972 350 18028
1901-10 8056040 323543 361888 7368 46547
1911-20 4321887 247236 1143671 8443 14574
1921-30 2463194 112059 1516716 6286 8954
1931-40 347566 16595 160037 1750 2483
1941-50 621147 37028 354804 7367 14693
1951-60 1325727 153249 996944 14092 25467
1961-70 1123492 427642 1716374 28954 25215
1971-80 800368 1588178 1982735 80779 41254
1981-90 761550 2738157 3615225 176893 46237
1991-00 1359737 2795672 4486806 354939 98263
2001-06 1073726 2265696 3037122 446792 185986

Hope this helps,
Jim Burke





milton ruser wrote:
> Dear Roger,
>
> Sorry for my delay.
>
> I still can't do that. Please, see below the steps and the error message.
> I shapefile have only one polygon, and only one collumn (CoverClass).
>
>   
>> reser<-readOGR(dsn=".", layer="ARN_026_214pt5m")
>>     
> OGR data source with driver: ESRI Shapefile
> Source: ".", layer: "ARN_026_214pt5m"
> with  1  rows and  3  columns
> Feature type: wkbPolygon with 2 dimensions
>   
>> reser.df<-reser at data
>> reser.df$ClassCover<-1
>> reser.df<-subset(reser.df, select=c(ClassCover))
>> reser at data<-reser.df <reser at data%3C-reser.df>
>> reser at data
>>     
>   ClassCover
> 0          1
>   
>> reser.SG <- Sobj_SpatialGrid(reser)$SG
>>
>> plot(reser.SG)
>> plot(reser, add=T, col="red")
>> str(reser.SG)
>>     
> Formal class 'SpatialGrid' [package "sp"] with 5 slots
>   ..@ grid       :Formal class 'GridTopology' [package "sp"] with 3 slots
>   .. .. ..@ cellcentre.offset: Named num [1:2] 371506 8764564
>   .. .. .. ..- attr(*, "names")= chr [1:2] "x" "y"
>   .. .. ..@ cellsize         : Named num [1:2] 941 941
>   .. .. .. ..- attr(*, "names")= chr [1:2] "max" "max"
>   .. .. ..@ cells.dim        : int [1:2] 100 75
>   ..@ grid.index : int(0)
>   ..@ coords     : num [1:2, 1:2] 371506 464669 8764564 8834201
>   .. ..- attr(*, "dimnames")=List of 2
>   .. .. ..$ : NULL
>   .. .. ..$ : chr [1:2] "x" "y"
>   ..@ bbox       : num [1:2, 1:2] 371035 8764093 465139 8834672
>   .. ..- attr(*, "dimnames")=List of 2
>   .. .. ..$ : chr [1:2] "x" "y"
>   .. .. ..$ : chr [1:2] "min" "max"
>   ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slots
>   .. .. ..@ projargs: chr NA
>   
>> o <- overlay(reser, reser.SG)
>> o
>>     
>      ClassCover
> NA           NA
> NA.1         NA
>   
>> reser.SGDF <- SpatialGridDataFrame(slot(reser.SG, "grid"),
>>     
> +   proj4string=CRS(proj4string(reser.SG)), data=o)
> Error in validityMethod(object) :
>   unequal number of objects in full grid and data slot
>   
>
>
>   
>> sessionInfo()
>>     
> R version 2.9.0 alpha (2009-03-26 r48224)
> i386-pc-mingw32
> locale:
> LC_COLLATE=English_Canada.1252;LC_CTYPE=English_Canada.1252;LC_MONETARY=English_Canada.1252;LC_NUMERIC=C;LC_TIME=English_Canada.1252
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
> other attached packages:
> [1] raster_0.8.9-6  maptools_0.7-20 foreign_0.8-34  rgdal_0.6-7
> [5] sp_0.9-32
> loaded via a namespace (and not attached):
> [1] grid_2.9.0      lattice_0.17-20
>
> Best wishes,
>
> milton
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>


From macq at llnl.gov  Mon Apr  6 17:11:29 2009
From: macq at llnl.gov (Don MacQueen)
Date: Mon, 6 Apr 2009 08:11:29 -0700
Subject: [R-sig-Geo] Plotting depends on search() order?
Message-ID: <p06240801c5ffcb78dc95@[128.115.67.9]>

I am finding that plotting a SpatialPolygonsDataFrame object
fails when the base graphics packages are ahead of
sp in the search() path. This occurs when I put
     require(maptools)     [ or require(rgdal), or require(sp) ]
in my .Rprofile file.

In the examples below, the object 'srdf' was created exactly as in 
the example in help('overlay').

An entire transcript of both cases is included at the end, but here 
are the key excerpts:

-- Case 1 (problem):
>  search()
  [1] ".GlobalEnv"        "package:graphics"  "package:grDevices"
  [4] "package:utils"     "package:datasets"  "package:maptools"
  [7] "package:sp"        "package:foreign"   "package:stats"
[10] "package:methods"   "Autoloads"         "package:base"
>
>  plot(srdf)
Error in as.double(y) :
   cannot coerce type 'S4' to vector of type 'double'

-- Case 2 (ok):
>  search()
  [1] ".GlobalEnv"        "package:maptools"  "package:sp"
  [4] "package:foreign"   "package:stats"     "package:graphics"
  [7] "package:grDevices" "package:utils"     "package:datasets"
[10] "package:methods"   "Autoloads"         "package:base"
>
>  plot(srdf)
>

Do I understand correctly that the reason is that there is 'plot' 
function in the base graphics package, and another in the sp package, 
and the latter is required for plotting spatial objects, so it has to 
come first in the search order? Or have I missed something?

This is easy enough to deal with, but it would be convenient to be 
able to put those "requires" in .Rprofile.

Thanks
-Don

-------------------------------------------------------------

maptools.load.order[119]% cat .Rprofile
require(maptools)
maptools.load.order[120]%
maptools.load.order[120]% R

R version 2.8.1 (2008-12-22)
Copyright (C) 2008 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

   Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

Loading required package: maptools
Loading required package: foreign
Loading required package: stats
Loading required package: sp
[Previously saved workspace restored]

>  class(srdf)
[1] "SpatialPolygonsDataFrame"
attr(,"package")
[1] "sp"
>
>  search()
  [1] ".GlobalEnv"        "package:graphics"  "package:grDevices"
  [4] "package:utils"     "package:datasets"  "package:maptools"
  [7] "package:sp"        "package:foreign"   "package:stats"
[10] "package:methods"   "Autoloads"         "package:base"
>
>  plot(srdf)
Error in as.double(y) :
   cannot coerce type 'S4' to vector of type 'double'
>  q()
Save workspace image? [y/n/c]: y
maptools.load.order[121]%


--------------------------------------------------------------

maptools.load.order[123]% cat .Rprofile
## require(maptools)
maptools.load.order[124]%
maptools.load.order[124]% R

R version 2.8.1 (2008-12-22)
Copyright (C) 2008 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

   Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

>  require(maptools)
Loading required package: maptools
Loading required package: foreign
Loading required package: sp
>
>  class(srdf)
[1] "SpatialPolygonsDataFrame"
attr(,"package")
[1] "sp"
>
>  search()
  [1] ".GlobalEnv"        "package:maptools"  "package:sp"
  [4] "package:foreign"   "package:stats"     "package:graphics"
  [7] "package:grDevices" "package:utils"     "package:datasets"
[10] "package:methods"   "Autoloads"         "package:base"
>
>  plot(srdf)
>
>  sessionInfo()
R version 2.8.1 (2008-12-22)
i386-apple-darwin8.11.1

locale:
C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] maptools_0.7-21 sp_0.9-34       foreign_0.8-34

loaded via a namespace (and not attached):
[1] grid_2.8.1      lattice_0.17-20
Warning message:
'DESCRIPTION' file has 'Encoding' field and re-encoding is not possible
>
>  q()
Save workspace image? [y/n/c]: y
maptools.load.order[125]%

-- 
--------------------------------------
Don MacQueen
Environmental Protection Department
Lawrence Livermore National Laboratory
Livermore, CA, USA
925-423-1062


From gianni.lavaredo at gmail.com  Mon Apr  6 17:34:10 2009
From: gianni.lavaredo at gmail.com (gianni lavaredo)
Date: Mon, 6 Apr 2009 17:34:10 +0200
Subject: [R-sig-Geo] raster package and "?focal" FUN
Message-ID: <518dff330904060834j4d6eaf59lb1ea1ed4792f550d@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090406/a808bca3/attachment.pl>

From brenning at uwaterloo.ca  Mon Apr  6 17:53:28 2009
From: brenning at uwaterloo.ca (Alexander Brenning)
Date: Mon, 06 Apr 2009 11:53:28 -0400
Subject: [R-sig-Geo] raster package and "?focal" FUN
In-Reply-To: <518dff330904060834j4d6eaf59lb1ea1ed4792f550d@mail.gmail.com>
References: <518dff330904060834j4d6eaf59lb1ea1ed4792f550d@mail.gmail.com>
Message-ID: <49DA2578.8000500@uwaterloo.ca>

Hi,

I haven't used the focal function in raster, which should be able to do 
this, but in the RSAGA package there is a function called focal.function 
that does the same thing on ASCII grids. In your case this should work:

focal.function("dem",fun="max",radius=3,mw.to.vector=TRUE,mw.na.rm=TRUE)

or just

gapply("dem", "max", radius = 3)

Have a look at ?focal.function - there are examples on how to use 
customized focal functions.

I hope this helps
   Alex


gianni lavaredo wrote:
>  I am seeing RASTER  package and "focal". I have a raster ascii grid format
> with a Z value. I am trying to do a mobile window with a specific radius
> (es: 10 m) to find the pixel with the max value of Z inside the window. I
> need to do this operation for each pixel and save a a new grid with only the
> max value pixel.
> I wish to study a specific function or package for to do this but the R
> world is very huge...
> 
> 
> es: mobile window 10 m
> pixelmax <- value
> NO pixelmax <- 0
> 
> thanks
> Gianni
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 

-- 
Alexander Brenning
brenning at uwaterloo.ca - T +1-519-888-4567 ext 35783
Department of Geography and Environmental Management
University of Waterloo
200 University Ave. W - Waterloo, ON - Canada N2L 3G1
http://www.fes.uwaterloo.ca/geography/faculty/brenning/


From brenning at uwaterloo.ca  Mon Apr  6 18:05:25 2009
From: brenning at uwaterloo.ca (Alexander Brenning)
Date: Mon, 06 Apr 2009 12:05:25 -0400
Subject: [R-sig-Geo] R interface to SEXTANTE?
In-Reply-To: <20090405023739.0c0c2a9e5faeb1149988f23a38ef111a.3e96b5ccfc.wbe@email04.secureserver.net>
References: <20090405023739.0c0c2a9e5faeb1149988f23a38ef111a.3e96b5ccfc.wbe@email04.secureserver.net>
Message-ID: <49DA2845.10004@uwaterloo.ca>

Hi Nick,

SEXTANTE and SAGA are very closely related, many of their modules are
identical. So at least the gain in functionality that can be achieved by 
interfacing SEXTANTE would probably be small, but maybe you know more 
about this.

A SEXTANTE-R interface would be a bit different from SAGA-R because of 
different command line interfaces (SEXTANTE uses some scripting language 
with Java-type syntax, SAGA the OS command line). But maybe - if the 
modules are really identical - this could be solved by replacing the 
rsaga.geoprocessor function (and some other low-level functions) in the 
RSAGA package and recycling the module front-end functions (like 
rsaga.local.morphometry) and help papges. This would save you a lot of time.

I hope this helps
  Alex



http://forge.osor.eu/plugins/wiki/index.php?More%20about%20SEXTANTE&id=13&type=g
> The first version of SEXTANTE was based on the German software SAGA,
> a GIS mainly focused on analysis. The original SAGA set of 120+
> analysis modules was enriched by more that 70 new ones, and some
> modifications were also made to the core of the system. A very close
> relation existed between the SAGA and the SEXTANTE teams, and both
> the extensions and the core modification eventually made their way to
> the SAGA oficial distribution and are nowadays included in cur rent
> SAGA releases.




Dominik Fuchs wrote:
> Dear all,
> 
> I was wondering if anyone was aware of and/or developing an interface
> to the SEXTANTE (www.sextantegis.com) library, along the lines of
> spgrass6 or RSAGA? Also, if (as I think) no such project exists, I
> would be interested to hear from anyone else wanting to collaborate
> on the development of such a package, or has 
> suggestions/wishes/ideas.
> 
> All the best,
> 
> Nick
> 
> 
> ------------------------------------------------------------------------
> 
> 
> _______________________________________________ R-sig-Geo mailing
> list R-sig-Geo at stat.math.ethz.ch 
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Alexander Brenning
brenning at uwaterloo.ca - T +1-519-888-4567 ext 35783
Department of Geography and Environmental Management
University of Waterloo
200 University Ave. W - Waterloo, ON - Canada N2L 3G1
http://www.fes.uwaterloo.ca/geography/faculty/brenning/


From milton.ruser at gmail.com  Mon Apr  6 22:42:26 2009
From: milton.ruser at gmail.com (milton ruser)
Date: Mon, 6 Apr 2009 16:42:26 -0400
Subject: [R-sig-Geo] cross 2 SGDF with different extents
Message-ID: <3aaf1a030904061342s54c99a54w4c0bc398cadeec84@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090406/9e92813b/attachment.pl>

From gregspam at kooji.com  Tue Apr  7 00:00:44 2009
From: gregspam at kooji.com (Greg King)
Date: Mon, 6 Apr 2009 23:00:44 +0100
Subject: [R-sig-Geo] Spatial Interpolation of Regularly Gridded Data
Message-ID: <c7dbc1ea0904061500q1bcfc024o507fa9635667f518@mail.gmail.com>

Hi,

I'm fairly new to R, but finding the experience a good one.  However I am a
little overwhelmed by the number of packages and not sure I am necessarily
using the most appropriate ones.

Here is the background to what I am trying to achieve:  I have a CSV file
which contains weather forecast data for latitude and longitude points (see
attached out.csv, the data I understand is on WGS84
http://www.ready.noaa.gov/faq/geodatums.html).  The sample points are at
half degree intervals.  My objective is to work out what the forecast data
is at any specific given latitude/longitude by interpolating data from the
0.5x0.5 degree grid.  I am doing this for a number of different time points
using the following functions:

library(akima)
library(rgdal)

gks <- function(inLat,inLon,dframe,variab) {
    wind.grid <- expand.grid(lat=inLat, lon=inLon)
    coordinates(wind.grid) <- ~ lat+lon
    proj4string(wind.grid) <- CRS("+init=epsg:4326")
    pnt<-interpp(coordinates(dframe)[,1], coordinates(dframe)[,2],
z=as.data.frame(dframe)[,1],
coordinates(wind.grid)[,1],coordinates(wind.grid)[,2],linear=TRUE)
    return(pnt$z)
}

interp_gk <- function(lat, lon) {
    wind<-read.csv(file="/Users/greg/Out.csv",head=TRUE,sep=",",
colClasses=c("POSIXct","numeric","numeric","numeric","numeric"))
    coordinates(wind)=~lat+lon
    proj4string(wind) <- CRS("+init=epsg:4326")

    times<-unique(wind$vt)
    columns<-names(wind)[2:length(names(wind))]

    dOut<-data.frame(dateTime=times[1])

    for (i in 1:length(times)) {
    dOut[i,"dateTime"]<-times[i]
        for (j in 1:length(columns)) {
            sset<-subset(wind, wind$vt==times[i], select=c(columns[j]))
            dOut[i,columns[j]]<-gks(lat,lon,sset,columns[j])
        }
    }
    dOut<-cbind(dOut, mag=sqrt(dOut$ugrd_0^2+dOut$vgrd_0^2))
    return(dOut)
}

However, I have the following concerns:

   - Should I really be using akima?  The documentation states it is not for
   use on regularly spaced grids - what are my alternatives?
   - The interp funcrtion will not work for cubic spline "linear=FALSE"
   interpolation (is it because my data is regularly gridded?).  How can I
   achieve cubic spline interpolation?
   - Is my function really using the Cordinate reference system specified?
   When I comment out the CRS lines, my functions return the same values?

Lots of questions I appreciate, but I am curious!  It seems R can achieve
what I am trying to do... but I may just be missing some vital bits of
information.

Thanks,

Greg
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090406/6b460881/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: out.csv
Type: application/octet-stream
Size: 95054 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090406/6b460881/attachment.obj>

From c.anwesha at gmail.com  Tue Apr  7 08:40:17 2009
From: c.anwesha at gmail.com (Anwesha Chakrabarti)
Date: Tue, 7 Apr 2009 12:10:17 +0530
Subject: [R-sig-Geo] how to handle large datafile in R?
Message-ID: <a28956f70904062340v5c8aa955w120ece187bc0a447@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090407/ff7e2b05/attachment.pl>

From Roger.Bivand at nhh.no  Tue Apr  7 09:12:42 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 7 Apr 2009 09:12:42 +0200 (CEST)
Subject: [R-sig-Geo] how to handle large datafile in R?
In-Reply-To: <a28956f70904062340v5c8aa955w120ece187bc0a447@mail.gmail.com>
References: <a28956f70904062340v5c8aa955w120ece187bc0a447@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.0904070909090.18101@reclus.nhh.no>

On Tue, 7 Apr 2009, Anwesha Chakrabarti wrote:

> hi all,
> i want to read a .netcdf file in R. the file contains one variable that has
> three dimensions lon, lat and time.
> and the data consists of a 192x94 matrix of the variable. whenever i'm
> trying to open the file i'm getting the following error msg
> "can not allocate vector of size 1.2gb"!
> so i guess i have to open the data in short slices.
> could anyone tell me how can i do this?

They cannot. In order to get any help, it is essential that you paste a 
copy of your code into your message - including the error message(s), 
followed by the output of traceback() and sessionInfo() in that order. 
We don't even know which function in which package you are using, and 
whether you are using it correctly. As far as I know, no-one on the list 
can see over your shoulder ...

Roger

>
> regards
> anwesha
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Tue Apr  7 09:26:57 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 7 Apr 2009 09:26:57 +0200 (CEST)
Subject: [R-sig-Geo] Spatial Interpolation of Regularly Gridded Data
In-Reply-To: <c7dbc1ea0904061500q1bcfc024o507fa9635667f518@mail.gmail.com>
References: <c7dbc1ea0904061500q1bcfc024o507fa9635667f518@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.0904070921300.18101@reclus.nhh.no>

On Mon, 6 Apr 2009, Greg King wrote:

> Hi,
>
> I'm fairly new to R, but finding the experience a good one.  However I am a
> little overwhelmed by the number of packages and not sure I am necessarily
> using the most appropriate ones.

Have you read the Spatial Task View on your nearest CRAN? There you should 
find some information to help. Firstly, akima treats all coordinates as 
planar, so don't use interp(). Both fields and gstat can interpolate using 
geographical coordinates, gstat with IDW and kriging, fields with thin 
plate splines (I believe using rdist.earth, but have not checked) and 
kriging. You are trying to interpolate, so why not use a geostatistical 
method? You could see whether the new automap package (running gstat 
internally) can handle geographical coordinates - check by comparing the 
output with runs with the proj4string set and unset.

Hope this helps,

Roger

>
> Here is the background to what I am trying to achieve:  I have a CSV file
> which contains weather forecast data for latitude and longitude points (see
> attached out.csv, the data I understand is on WGS84
> http://www.ready.noaa.gov/faq/geodatums.html).  The sample points are at
> half degree intervals.  My objective is to work out what the forecast data
> is at any specific given latitude/longitude by interpolating data from the
> 0.5x0.5 degree grid.  I am doing this for a number of different time points
> using the following functions:
>
> library(akima)
> library(rgdal)
>
> gks <- function(inLat,inLon,dframe,variab) {
>    wind.grid <- expand.grid(lat=inLat, lon=inLon)
>    coordinates(wind.grid) <- ~ lat+lon
>    proj4string(wind.grid) <- CRS("+init=epsg:4326")
>    pnt<-interpp(coordinates(dframe)[,1], coordinates(dframe)[,2],
> z=as.data.frame(dframe)[,1],
> coordinates(wind.grid)[,1],coordinates(wind.grid)[,2],linear=TRUE)
>    return(pnt$z)
> }
>
> interp_gk <- function(lat, lon) {
>    wind<-read.csv(file="/Users/greg/Out.csv",head=TRUE,sep=",",
> colClasses=c("POSIXct","numeric","numeric","numeric","numeric"))
>    coordinates(wind)=~lat+lon
>    proj4string(wind) <- CRS("+init=epsg:4326")
>
>    times<-unique(wind$vt)
>    columns<-names(wind)[2:length(names(wind))]
>
>    dOut<-data.frame(dateTime=times[1])
>
>    for (i in 1:length(times)) {
>    dOut[i,"dateTime"]<-times[i]
>        for (j in 1:length(columns)) {
>            sset<-subset(wind, wind$vt==times[i], select=c(columns[j]))
>            dOut[i,columns[j]]<-gks(lat,lon,sset,columns[j])
>        }
>    }
>    dOut<-cbind(dOut, mag=sqrt(dOut$ugrd_0^2+dOut$vgrd_0^2))
>    return(dOut)
> }
>
> However, I have the following concerns:
>
>   - Should I really be using akima?  The documentation states it is not for
>   use on regularly spaced grids - what are my alternatives?
>   - The interp funcrtion will not work for cubic spline "linear=FALSE"
>   interpolation (is it because my data is regularly gridded?).  How can I
>   achieve cubic spline interpolation?
>   - Is my function really using the Cordinate reference system specified?
>   When I comment out the CRS lines, my functions return the same values?
>
> Lots of questions I appreciate, but I am curious!  It seems R can achieve
> what I am trying to do... but I may just be missing some vital bits of
> information.
>
> Thanks,
>
> Greg
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From c.anwesha at gmail.com  Tue Apr  7 09:31:11 2009
From: c.anwesha at gmail.com (Anwesha Chakrabarti)
Date: Tue, 7 Apr 2009 13:01:11 +0530
Subject: [R-sig-Geo] how to handle large datafile in R?
In-Reply-To: <alpine.LRH.2.00.0904070909090.18101@reclus.nhh.no>
References: <a28956f70904062340v5c8aa955w120ece187bc0a447@mail.gmail.com>
	<alpine.LRH.2.00.0904070909090.18101@reclus.nhh.no>
Message-ID: <a28956f70904070031w2273981dh4b5567e166ed7075@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090407/2ef54339/attachment.pl>

From Roger.Bivand at nhh.no  Tue Apr  7 09:36:52 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 7 Apr 2009 09:36:52 +0200 (CEST)
Subject: [R-sig-Geo] Plotting depends on search() order?
In-Reply-To: <p06240801c5ffcb78dc95@[128.115.67.9]>
References: <p06240801c5ffcb78dc95@[128.115.67.9]>
Message-ID: <alpine.LRH.2.00.0904070929160.18101@reclus.nhh.no>

On Mon, 6 Apr 2009, Don MacQueen wrote:

> I am finding that plotting a SpatialPolygonsDataFrame object
> fails when the base graphics packages are ahead of
> sp in the search() path. This occurs when I put
>    require(maptools)     [ or require(rgdal), or require(sp) ]
> in my .Rprofile file.

I never use an .Rprofile file for loading packages, because I forget that 
it/they is/are there. Mine sets up an alternative terminal handling of 
help pages, running R code from the base package. Could you try manually 
ordering the search path by requiring() the base packages 
graphics:datasets before maptools in your .Rprofile? Reading ?.Rprofile 
does suggest that one needs to tread carefully here.

Roger

>
> In the examples below, the object 'srdf' was created exactly as in the 
> example in help('overlay').
>
> An entire transcript of both cases is included at the end, but here are the 
> key excerpts:
>
> -- Case 1 (problem):
>>  search()
> [1] ".GlobalEnv"        "package:graphics"  "package:grDevices"
> [4] "package:utils"     "package:datasets"  "package:maptools"
> [7] "package:sp"        "package:foreign"   "package:stats"
> [10] "package:methods"   "Autoloads"         "package:base"
>>
>>  plot(srdf)
> Error in as.double(y) :
>  cannot coerce type 'S4' to vector of type 'double'
>
> -- Case 2 (ok):
>>  search()
> [1] ".GlobalEnv"        "package:maptools"  "package:sp"
> [4] "package:foreign"   "package:stats"     "package:graphics"
> [7] "package:grDevices" "package:utils"     "package:datasets"
> [10] "package:methods"   "Autoloads"         "package:base"
>>
>>  plot(srdf)
>> 
>
> Do I understand correctly that the reason is that there is 'plot' function in 
> the base graphics package, and another in the sp package, and the latter is 
> required for plotting spatial objects, so it has to come first in the search 
> order? Or have I missed something?
>
> This is easy enough to deal with, but it would be convenient to be able to 
> put those "requires" in .Rprofile.
>
> Thanks
> -Don
>
> -------------------------------------------------------------
>
> maptools.load.order[119]% cat .Rprofile
> require(maptools)
> maptools.load.order[120]%
> maptools.load.order[120]% R
>
> R version 2.8.1 (2008-12-22)
> Copyright (C) 2008 The R Foundation for Statistical Computing
> ISBN 3-900051-07-0
>
> R is free software and comes with ABSOLUTELY NO WARRANTY.
> You are welcome to redistribute it under certain conditions.
> Type 'license()' or 'licence()' for distribution details.
>
>  Natural language support but running in an English locale
>
> R is a collaborative project with many contributors.
> Type 'contributors()' for more information and
> 'citation()' on how to cite R or R packages in publications.
>
> Type 'demo()' for some demos, 'help()' for on-line help, or
> 'help.start()' for an HTML browser interface to help.
> Type 'q()' to quit R.
>
> Loading required package: maptools
> Loading required package: foreign
> Loading required package: stats
> Loading required package: sp
> [Previously saved workspace restored]
>
>>  class(srdf)
> [1] "SpatialPolygonsDataFrame"
> attr(,"package")
> [1] "sp"
>>
>>  search()
> [1] ".GlobalEnv"        "package:graphics"  "package:grDevices"
> [4] "package:utils"     "package:datasets"  "package:maptools"
> [7] "package:sp"        "package:foreign"   "package:stats"
> [10] "package:methods"   "Autoloads"         "package:base"
>>
>>  plot(srdf)
> Error in as.double(y) :
>  cannot coerce type 'S4' to vector of type 'double'
>>  q()
> Save workspace image? [y/n/c]: y
> maptools.load.order[121]%
>
>
> --------------------------------------------------------------
>
> maptools.load.order[123]% cat .Rprofile
> ## require(maptools)
> maptools.load.order[124]%
> maptools.load.order[124]% R
>
> R version 2.8.1 (2008-12-22)
> Copyright (C) 2008 The R Foundation for Statistical Computing
> ISBN 3-900051-07-0
>
> R is free software and comes with ABSOLUTELY NO WARRANTY.
> You are welcome to redistribute it under certain conditions.
> Type 'license()' or 'licence()' for distribution details.
>
>  Natural language support but running in an English locale
>
> R is a collaborative project with many contributors.
> Type 'contributors()' for more information and
> 'citation()' on how to cite R or R packages in publications.
>
> Type 'demo()' for some demos, 'help()' for on-line help, or
> 'help.start()' for an HTML browser interface to help.
> Type 'q()' to quit R.
>
> [Previously saved workspace restored]
>
>>  require(maptools)
> Loading required package: maptools
> Loading required package: foreign
> Loading required package: sp
>>
>>  class(srdf)
> [1] "SpatialPolygonsDataFrame"
> attr(,"package")
> [1] "sp"
>>
>>  search()
> [1] ".GlobalEnv"        "package:maptools"  "package:sp"
> [4] "package:foreign"   "package:stats"     "package:graphics"
> [7] "package:grDevices" "package:utils"     "package:datasets"
> [10] "package:methods"   "Autoloads"         "package:base"
>>
>>  plot(srdf)
>>
>>  sessionInfo()
> R version 2.8.1 (2008-12-22)
> i386-apple-darwin8.11.1
>
> locale:
> C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] maptools_0.7-21 sp_0.9-34       foreign_0.8-34
>
> loaded via a namespace (and not attached):
> [1] grid_2.8.1      lattice_0.17-20
> Warning message:
> 'DESCRIPTION' file has 'Encoding' field and re-encoding is not possible
>>
>>  q()
> Save workspace image? [y/n/c]: y
> maptools.load.order[125]%
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From marco.helbich at gmx.at  Tue Apr  7 12:11:03 2009
From: marco.helbich at gmx.at (Marco Helbich)
Date: Tue, 7 Apr 2009 12:11:03 +0200
Subject: [R-sig-Geo] convert spatstat owin-object to splancs
Message-ID: <D8589E6F7E3D474FB5BC3C70EB07C27A@mirk>

Dear list,

I have the following problem: my dataset contains some events (points) and a 
studyarea, I used some spatstat functions and now I want to use the 
bandwidth estimation mse2d() in the splancs package. My problem is to 
convert the spatstat owin-object (studyarea) to use it in the splancs 
package. This is the structure of my studyarea:

str(studyarea)
Formal class 'SpatialPolygonsDataFrame' [package "sp"] with 5 slots
  ..@ data       :'data.frame': 1 obs. of  4 variables:
  .. ..$ Id       : int 0
  .. ..$ Area_sqmi: num 513
  .. ..$ Areasqmi : num 513
  .. ..$ Areakm2  : num 1329
  ..@ polygons   :List of 1
  .. ..$ :Formal class 'Polygons' [package "sp"] with 5 slots
  .. .. .. ..@ Polygons :List of 1
  .. .. .. .. ..$ :Formal class 'Polygon' [package "sp"] with 5 slots
  .. .. .. .. .. .. ..@ labpt  : num [1:2] 1446129 850484
  .. .. .. .. .. .. ..@ area   : num 1.33e+09
  .. .. .. .. .. .. ..@ hole   : logi FALSE
  .. .. .. .. .. .. ..@ ringDir: int 1
  .. .. .. .. .. .. ..@ coords : num [1:3530, 1:2] 1458298 1458329 1458357 
1458411 1458494 ...
  .. .. .. ..@ plotOrder: int 1
  .. .. .. ..@ labpt    : num [1:2] 1446129 850484
  .. .. .. ..@ ID       : chr "0"
  .. .. .. ..@ area     : num 1.33e+09
  ..@ plotOrder  : int 1
  ..@ bbox       : num [1:2, 1:2] 1420242 828662 1476943 872228
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : chr [1:2] "r1" "r2"
  .. .. ..$ : chr [1:2] "min" "max"
  ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slots
  .. .. ..@ projargs: chr " +proj=lcc +lat_1=34.91666666666666 
+lat_2=27.41666666666667 +lat_0=31.16666666666667 +lon_0=-100 +x_0=1000000 
+y_0=1000000 +el"| __truncated__
>

Thank you for your help!
Marco


From T.Hengl at uva.nl  Tue Apr  7 12:19:22 2009
From: T.Hengl at uva.nl (Tomislav Hengl)
Date: Tue, 7 Apr 2009 12:19:22 +0200
Subject: [R-sig-Geo] Spatial Interpolation of Regularly Gridded Data
Message-ID: <089CB1DC079F451E951D2C0DDD15C6E3@pcibed193>


Hi Greg,

Yes, there are many possibilities for downscaling grids in R, so you are at the right place.  :) 

1. If you only wish to downscale climatic grids (e.g. using splines), then probably the most
efficient (fastest; can handle large grids) way is to use the downscaling method in SAGA:

> library(RSAGA)
> library(RCurl)
> out.url <-
getURL("https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090406/6b460881/attachment.obj",
ssl.verifypeer=F)
> write(out.url, "out.csv")
> out <- read.csv("out.csv", header=T, sep=",")
> str(out)
> coordinates(out) <- ~lon+lat
> proj4string(out) <- CRS("+proj=longlat +datum=WGS84")
> writeOGR(out, ".", "out", "ESRI Shapefile")
# convert to a grid:
> rsaga.geoprocessor(lib="grid_gridding", module=3, param=list(GRID="out5deg.sgrd", INPUT="out.shp",
FIELD=2, LINE_TYPE=0, USER_CELL_SIZE=0.5, USER_FIT_EXTENT=T))
# downscale the grid using Bicubic spline interpolation:
> rsaga.geoprocessor(lib="grid_tools", module=0, param=list(INPUT="out5deg.sgrd",
GRID="out25deg.sgrd", METHOD=0, DIMENSIONS_CELLSIZE=0.25, SCALE_DOWN_METHOD=3))


2. Otherwise, I would really suggest that you try downscaling grids using auxiliary information /
geostatistical modelling, which is explained in e.g. the following two papers:

Hengl, T., Bajat, B., Reuter, H.I., Blagojevic, D., 2008. Geostatistical modelling of topography
using auxiliary maps. Computers & Geosciences, 34: 1886-1899.
http://geomorphometry.org/view_scripts.asp?id=6 
 
Grohmann, C.H., Steiner, S.S., 2008. SRTM resample with Short Distance-Low Nugget Kriging.
International Journal of Geographical Information Science, 22 (8):895-906.
http://dx.doi.org/10.1080/13658810701730152 

HTH,

T. Hengl


> -----Original Message-----
> From: r-sig-geo-bounces at stat.math.ethz.ch [mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf
> Of Greg King
> Sent: Tuesday, April 07, 2009 12:01 AM
> To: r-sig-geo at stat.math.ethz.ch
> Subject: [R-sig-Geo] Spatial Interpolation of Regularly Gridded Data
> 
> Hi,
> 
> I'm fairly new to R, but finding the experience a good one.  However I am a little overwhelmed by
> the number of packages and not sure I am necessarily using the most appropriate ones.
> 
> Here is the background to what I am trying to achieve:  I have a CSV file which contains weather
> forecast data for latitude and longitude points (see attached out.csv, the data I understand is on
> WGS84 http://www.ready.noaa.gov/faq/geodatums.html).  The sample points are at half degree
> intervals.  My objective is to work out what the forecast data is at any specific given
> latitude/longitude by interpolating data from the 0.5x0.5 degree grid.  I am doing this for a
> number of different time points using the following functions:
> 
> 
> library(akima)
> library(rgdal)
> 
> gks <- function(inLat,inLon,dframe,variab) {
>     wind.grid <- expand.grid(lat=inLat, lon=inLon)
>     coordinates(wind.grid) <- ~ lat+lon
>     proj4string(wind.grid) <- CRS("+init=epsg:4326")
>     pnt<-interpp(coordinates(dframe)[,1], coordinates(dframe)[,2], z=as.data.frame(dframe)[,1],
> coordinates(wind.grid)[,1],coordinates(wind.grid)[,2],linear=TRUE)
>     return(pnt$z)
> }
> 
> interp_gk <- function(lat, lon) {
>     wind<-read.csv(file="/Users/greg/Out.csv",head=TRUE,sep=",",
> colClasses=c("POSIXct","numeric","numeric","numeric","numeric"))
>     coordinates(wind)=~lat+lon
>     proj4string(wind) <- CRS("+init=epsg:4326")
> 
>     times<-unique(wind$vt)
>     columns<-names(wind)[2:length(names(wind))]
> 
>     dOut<-data.frame(dateTime=times[1])
> 
>     for (i in 1:length(times)) {
>     dOut[i,"dateTime"]<-times[i]
>         for (j in 1:length(columns)) {
>             sset<-subset(wind, wind$vt==times[i], select=c(columns[j]))
>             dOut[i,columns[j]]<-gks(lat,lon,sset,columns[j])
>         }
>     }
>     dOut<-cbind(dOut, mag=sqrt(dOut$ugrd_0^2+dOut$vgrd_0^2))
>     return(dOut)
> }
> 
> 
> However, I have the following concerns:
> 
> 
> *	Should I really be using akima?  The documentation states it is not for use on regularly
> spaced grids - what are my alternatives?
> *	The interp funcrtion will not work for cubic spline "linear=FALSE" interpolation (is it
> because my data is regularly gridded?).  How can I achieve cubic spline interpolation?
> *	Is my function really using the Cordinate reference system specified?  When I comment out
> the CRS lines, my functions return the same values?
> 
> 
> Lots of questions I appreciate, but I am curious!  It seems R can achieve what I am trying to
> do... but I may just be missing some vital bits of information.
> 
> Thanks,
> 
> Greg
>


From r.hijmans at gmail.com  Tue Apr  7 13:52:10 2009
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Tue, 7 Apr 2009 19:52:10 +0800
Subject: [R-sig-Geo] how to handle large datafile in R?
In-Reply-To: <a28956f70904070031w2273981dh4b5567e166ed7075@mail.gmail.com>
References: <a28956f70904062340v5c8aa955w120ece187bc0a447@mail.gmail.com>
	<alpine.LRH.2.00.0904070909090.18101@reclus.nhh.no>
	<a28956f70904070031w2273981dh4b5567e166ed7075@mail.gmail.com>
Message-ID: <dc22b2570904070452w64883431u589138122cb0da0b@mail.gmail.com>

Anwesha,

Assuming you want the data timestep by timestep (but you can adjust it
for all timesteps, pixel by pixel) you can do something like the
below. I copied it straight from  ?get.var.ncdf


library(ncdf)
ncdata<-open.ncdf("air.2m.1950-1999.nc")
lon<-get.var.ncdf(ncdata,"lon")
lat<-get.var.ncdf(ncdata,"lat")
time<-get.var.ncdf(ncdata,"time")

v3      <- ncdata$var[["air"]]
varsize <- v3$varsize
ndims   <- v3$ndims

nt      <- varsize[ndims]  # Remember timelike dim is always the LAST dimension!
for( i in 1:nt ) {
        # Initialize start and count to read one timestep of the variable.
        start <- rep(1,ndims)   # begin with start=(1,1,1,...,1)
        start[ndims] <- i       # change to start=(1,1,1,...,i) to
read timestep i
        count <- varsize        # begin w/count=(nx,ny,nz,...,nt),
reads entire var
        count[ndims] <- 1       # change to count=(nx,ny,nz,...,1) to
read 1 tstep
        data3 <- get.var.ncdf( ncdata, v3, start=start, count=count )

        # Now read in the value of the timelike dimension
        timeval <- get.var.ncdf( ncdata, v3$dim[[ndims]]$name,
start=i, count=1 )

        print(paste("Data for variable",v3$name,"at timestep",i,
                " (time value=",timeval,v3$dim[[ndims]]$units,"):"))
#       print(data3)
        }

close.ncdf(nc)



On Tue, Apr 7, 2009 at 3:31 PM, Anwesha Chakrabarti <c.anwesha at gmail.com> wrote:
> i'm really sorry for that.
> let me state the problem once again with the codes.
>
> graphics.off()
>> library(ncdf)
>> ncdata<-open.ncdf("air.2m.1950-1999.nc")
>> lon<-get.var.ncdf(ncdata,"lon")
>> lat<-get.var.ncdf(ncdata,"lat")
>> time<-get.var.ncdf(ncdata,"time")
>> dat<-get.var.ncdf(ncdata,"air")
> Error: cannot allocate vector of size 1.2 Gb
> now my question is how do i load the subsets of the data?
>
> regards
>
> On Tue, Apr 7, 2009 at 12:42 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> ?On Tue, 7 Apr 2009, Anwesha Chakrabarti wrote:
>>
>> hi all,
>>> i want to read a .netcdf file in R. the file contains one variable that
>>> has
>>> three dimensions lon, lat and time.
>>> and the data consists of a 192x94 matrix of the variable. whenever i'm
>>> trying to open the file i'm getting the following error msg
>>> "can not allocate vector of size 1.2gb"!
>>> so i guess i have to open the data in short slices.
>>> could anyone tell me how can i do this?
>>>
>>
>> They cannot. In order to get any help, it is essential that you paste a
>> copy of your code into your message - including the error message(s),
>> followed by the output of traceback() and sessionInfo() in that order. We
>> don't even know which function in which package you are using, and whether
>> you are using it correctly. As far as I know, no-one on the list can see
>> over your shoulder ...
>>
>> Roger
>>
>>
>>> regards
>>> anwesha
>>>
>>> ? ? ? ?[[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>> --
>> Roger Bivand
>> Economic Geography Section, Department of Economics, Norwegian School of
>> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From gianni.lavaredo at gmail.com  Tue Apr  7 16:43:39 2009
From: gianni.lavaredo at gmail.com (gianni lavaredo)
Date: Tue, 7 Apr 2009 16:43:39 +0200
Subject: [R-sig-Geo] problem to module MERGE GRID in RSAGA
Message-ID: <518dff330904070743x1324d4cald3ac0326416904be@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090407/41429550/attachment.pl>

From alinashe at gmail.com  Tue Apr  7 17:11:06 2009
From: alinashe at gmail.com (Alina Sheyman)
Date: Tue, 7 Apr 2009 11:11:06 -0400
Subject: [R-sig-Geo] Europe zip code shapefiles
Message-ID: <f58db2700904070811q798c598didff456a8736a1bf0@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090407/0443f8a7/attachment.pl>

From T.Hengl at uva.nl  Tue Apr  7 17:18:25 2009
From: T.Hengl at uva.nl (Tomislav Hengl)
Date: Tue, 7 Apr 2009 17:18:25 +0200
Subject: [R-sig-Geo] problem to module MERGE GRID in RSAGA
In-Reply-To: <518dff330904070743x1324d4cald3ac0326416904be@mail.gmail.com>
References: <518dff330904070743x1324d4cald3ac0326416904be@mail.gmail.com>
Message-ID: <CC4ED2D9D05B499EAA65B9C1F662AFCD@pcibed193>


> -----Original Message-----
> From: r-sig-geo-bounces at stat.math.ethz.ch [mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf
> Of gianni lavaredo
> Sent: Tuesday, April 07, 2009 4:44 PM
> To: r-sig-geo at stat.math.ethz.ch
> Subject: [R-sig-Geo] problem to module MERGE GRID in RSAGA
> 
> Dear R Users
> 
> I have a problem to understand the loop merge in RSAGA
> 
> I have this file (not order name)
> DEM2644147
> DEM2644148
> DEM2644149
> DEM2744150
> DEM2744155
> DEM2744168
> 
> I did a file list in CSV:
> 
> path<- ("C:/mydata/")
> temp  <- paste(path,"input.csv", sep="")
> input  <- read.csv(temp, header = TRUE)
> attach(input)
> names(input)
> temp <- file
> file.list <- as.list(temp)
> 
> 
> # USE POWER TO DEM
> power <- seq(1.0, 10.0, by=0.1)
> 
> # power of DCM
> for(i in 1:length(file.list)){
> for (method in 1:length(power)){
>       rsaga.grid.calculus(in.grids = c(paste("C:/mydata/DEM",
> file.list[[i]],".sgrd", sep="")),
>            out.grid =
> c(paste("C:/mydata/Power_DEM",file.list[[i]],"_",method+9,".sgrd",sep="")),
>            formula = paste("a^",power[method],sep=""))
> }
> }
> 
> #TRY with two DEM with power^1
> rsaga.geoprocessor(lib="grid_tools", module=3,
> param=list(GRIDS="C:/mydata/Power_DEM2644147_10.sgrd;C:/mydata/Power_DEM2644148_10.sgrd",
> MERGED="C:/mydata/merge_power10.sgrd",TYPE=6,INTERPOL=0,OVERLAP=0))
> 
> Now I am trying to merge in a LOOP every DEM to have:
> all_merge_power10
> all_merge_power11
> all_merge_power12
> all_merge_power13
> etc
> 
> 
> for(i in 1:length(file.list)){
> for (method in 1:length(power)){
> rsaga.geoprocessor(lib="grid_tools", module=3,
>    param=list(GRIDS=c(paste("C:/mydata/Power_DEM",file.list[[i]],"method+9",".sgrd",sep="")),
>    MERGED="C:/mydata/all_merge_power10.sgrd",
>    TYPE=6,
>    INTERPOL=0,
>    OVERLAP=0))
> }
> }

why do you loop?

simly do:

> GRIDS=paste(set.file.extension(file.list, ".sgrd"), collapse=";")

There is also no need to write the working directory every time. Just set it up at the beginning:

> setwd("C:/mydata/")

Some similar examples here:

http://spatial-analyst.net/wiki/index.php?title=Software#SAGA_GIS

T. Hengl

> 
> 
> 
> I have diffucult to load all DEM power 10, ect etc and every time I have a
> Error :-(.
> 
> Thanks a lot
> 
> Gianni
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From ksafi at orn.mpg.de  Tue Apr  7 17:32:22 2009
From: ksafi at orn.mpg.de (Kamran Safi)
Date: Tue, 07 Apr 2009 17:32:22 +0200
Subject: [R-sig-Geo] suggestion for projection
Message-ID: <49DB7206.1050801@orn.mpg.de>

Dear list,

I am in search of a good projection with which I could run habitat 
utilization models on a continental scale. The projection I am looking 
for should preserve distances between points as good as possible and the 
map units should be meters. I think from what I have explored so far 
from the implementations of movement in habitat use models, preserving 
distance is the most important factor. Most solutions I found ready made 
were fine if you are working on a small scale of a few hectares or even 
a couple of square kilometers. The projection I am looking for should 
optimize "truth" in distances and be in meters (at least for the time 
being) for almost all of North-America and large stretches of 
South-America. I am aware that there is no single real solution out 
there for this large area, but there should be some projections with a 
minimal amount of error given the extent (so to speak an optimum). I 
quite often used spTransform, but never dealt with other things than 
longlat into moll or aitoff sometimes in utm and vice versa. I have no 
experience whatsoever with map units (and wouldn't know how to set or 
change them), as this wasn't an issue up to now, and only scratched the 
surface of oblique projections (sorry I am a biololgist in the first 
place trying to avoid making all too many mistakes in geography). I 
appreciate some expert opinion on this.

The bbox (in longlat) of the area for which I am looking for a good 
projection is:    
 min   max
x1 -127.2 -46.8
x2  -19.7  48.6

Many thanks in advance,

Kami


 
-- 
Kamran Safi

Max Planck Institute for Ornithology
Vogelwarte Radolfzell
Schlossallee 2
78315 Radolfzell
Germany

and

Institute of Zoology
Zoological Society of London
Regent's Park
NW1 4RY London
United Kingdom
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/x-pkcs7-signature
Size: 3275 bytes
Desc: S/MIME Cryptographic Signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090407/12b10815/attachment.bin>

From gregspam at kooji.com  Tue Apr  7 22:32:35 2009
From: gregspam at kooji.com (Greg King)
Date: Tue, 7 Apr 2009 21:32:35 +0100
Subject: [R-sig-Geo] Spatial Interpolation of Regularly Gridded Data
In-Reply-To: <alpine.LRH.2.00.0904070921300.18101@reclus.nhh.no>
References: <c7dbc1ea0904061500q1bcfc024o507fa9635667f518@mail.gmail.com>
	<alpine.LRH.2.00.0904070921300.18101@reclus.nhh.no>
Message-ID: <c7dbc1ea0904071332l6f1d60c2l48feac2cca157032@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090407/d9583ca1/attachment.pl>

From tech_dev at wildintellect.com  Tue Apr  7 22:45:14 2009
From: tech_dev at wildintellect.com (Alex Mandel)
Date: Tue, 07 Apr 2009 13:45:14 -0700
Subject: [R-sig-Geo] suggestion for projection
In-Reply-To: <49DB7206.1050801@orn.mpg.de>
References: <49DB7206.1050801@orn.mpg.de>
Message-ID: <49DBBB5A.3060703@wildintellect.com>

I'm no expert here but I poked around spatialrefernce.org a bit and
found some stuff that might get you going in the right direction.

North American Equidistant Conic
http://spatialreference.org/ref/esri/102010/
South American Equidistant Conic
http://spatialreference.org/ref/esri/102032/

Any chance you could run the study using great circle distances, there
is support for such distance measuring in R using spDistsN1 in the sp
package. That way all you'd have to do is pick a spheroid to standardize on.

Alex


Kamran Safi wrote:
> Dear list,
> 
> I am in search of a good projection with which I could run habitat
> utilization models on a continental scale. The projection I am looking
> for should preserve distances between points as good as possible and the
> map units should be meters. I think from what I have explored so far
> from the implementations of movement in habitat use models, preserving
> distance is the most important factor. Most solutions I found ready made
> were fine if you are working on a small scale of a few hectares or even
> a couple of square kilometers. The projection I am looking for should
> optimize "truth" in distances and be in meters (at least for the time
> being) for almost all of North-America and large stretches of
> South-America. I am aware that there is no single real solution out
> there for this large area, but there should be some projections with a
> minimal amount of error given the extent (so to speak an optimum). I
> quite often used spTransform, but never dealt with other things than
> longlat into moll or aitoff sometimes in utm and vice versa. I have no
> experience whatsoever with map units (and wouldn't know how to set or
> change them), as this wasn't an issue up to now, and only scratched the
> surface of oblique projections (sorry I am a biololgist in the first
> place trying to avoid making all too many mistakes in geography). I
> appreciate some expert opinion on this.
> 
> The bbox (in longlat) of the area for which I am looking for a good
> projection is:    min   max
> x1 -127.2 -46.8
> x2  -19.7  48.6
> 
> Many thanks in advance,
> 
> Kami
> 
> 
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From josh.london at noaa.gov  Tue Apr  7 23:04:59 2009
From: josh.london at noaa.gov (Josh London)
Date: Tue, 07 Apr 2009 14:04:59 -0700
Subject: [R-sig-Geo] georectify an image with tiepoints
Message-ID: <49DBBFFB.407@noaa.gov>

Hello

I trying to work out method for georectifying QuickSCAT sea-ice GIFs
(http://nereids.jpl.nasa.gov/cgi-bin/ice.cgi?show=scat). The daily
images are consistent in their layout and include overlayed graticules.
In ArcMap, I create tiepoints at the graticule intersections and
geo-rectify from those. This works, but, these days, I try an avoid
opening ArcMap when I can and I am hoping R can provide a method that
will be easier to batch process and automate.

Any help getting me started or advice from others who have done similar 
tasks would be appreciated.

Thanks
josh

-- 
Josh M. London, PhD

Wildlife Biologist
Polar Ecosystem Program
National Marine Mammal Lab
Alaska Fisheries Science Center, NOAA Fisheries
Seattle, WA

The contents of this message are mine personally and do not
necessarily reflect any position of the Government or the
National Oceanic and Atmospheric Administration.


From mihastaut at yahoo.co.uk  Tue Apr  7 23:54:22 2009
From: mihastaut at yahoo.co.uk (Miha Staut)
Date: Tue, 7 Apr 2009 21:54:22 +0000 (GMT)
Subject: [R-sig-Geo] Spatial Interpolation of Regularly Gridded Data
Message-ID: <157733.79234.qm@web28603.mail.ukl.yahoo.com>


Dear Greg,

A while back I did a similar task with the function interp.surface() from the fileds package. It briefly does bilinear interpolation from a regular grid to arbitrary point. It is computationally quite inexpensive since the method of interpolation is quite simple. 

Hope I understood you correctly. 

All best
Miha


--- On Tue, 7/4/09, Greg King <gregspam at kooji.com> wrote:

> From: Greg King <gregspam at kooji.com>
> Subject: Re: [R-sig-Geo] Spatial Interpolation of Regularly Gridded Data
> To: Roger.Bivand at nhh.no
> Cc: r-sig-geo at stat.math.ethz.ch
> Date: Tuesday, 7 April, 2009, 10:32 PM
> Thanks for your reply Roger.? I
> little while back I got kriging working in
> the gstat package with my data, but found that for my
> purposes it was too
> computationally expensive (read slow).? Therefore I am
> looking for something
> a little quicker.? I now appreciate I cannot use
> interp due to it treating
> coordinates as planar.? I found a good tutorial for
> kriging in gstat at
> http://casoilresource.lawr.ucdavis.edu/drupal/node/442.?
> >From a quick play
> around I can't immediately see how functions like Tps in
> the field package
> meet my needs.? Could anyone provide directions to
> primers on the web?.
> Googling for R is quite tricky (even with rseek).
> 
> Essentially I want a fast simple method for interpolating a
> single point
> value from its surounding points.? It shouldn't be too
> difficult but I must
> admit I am struggling a little!
> 
> Greg
> 
> On Tue, Apr 7, 2009 at 8:26 AM, Roger Bivand <Roger.Bivand at nhh.no>
> wrote:
> 
> > On Mon, 6 Apr 2009, Greg King wrote:
> >
> >? Hi,
> >>
> >> I'm fairly new to R, but finding the experience a
> good one.? However I am
> >> a
> >> little overwhelmed by the number of packages and
> not sure I am necessarily
> >> using the most appropriate ones.
> >>
> >
> > Have you read the Spatial Task View on your nearest
> CRAN? There you should
> > find some information to help. Firstly, akima treats
> all coordinates as
> > planar, so don't use interp(). Both fields and gstat
> can interpolate using
> > geographical coordinates, gstat with IDW and kriging,
> fields with thin plate
> > splines (I believe using rdist.earth, but have not
> checked) and kriging. You
> > are trying to interpolate, so why not use a
> geostatistical method? You could
> > see whether the new automap package (running gstat
> internally) can handle
> > geographical coordinates - check by comparing the
> output with runs with the
> > proj4string set and unset.
> >
> > Hope this helps,
> >
> > Roger
> >
> >
> >
> >> Here is the background to what I am trying to
> achieve:? I have a CSV file
> >> which contains weather forecast data for latitude
> and longitude points
> >> (see
> >> attached out.csv, the data I understand is on
> WGS84
> >> http://www.ready.noaa.gov/faq/geodatums.html).?
> The sample points are at
> >> half degree intervals.? My objective is to
> work out what the forecast data
> >> is at any specific given latitude/longitude by
> interpolating data from the
> >> 0.5x0.5 degree grid.? I am doing this for a
> number of different time
> >> points
> >> using the following functions:
> >>
> >> library(akima)
> >> library(rgdal)
> >>
> >> gks <- function(inLat,inLon,dframe,variab) {
> >>???wind.grid <-
> expand.grid(lat=inLat, lon=inLon)
> >>???coordinates(wind.grid) <- ~
> lat+lon
> >>???proj4string(wind.grid) <-
> CRS("+init=epsg:4326")
> >>???pnt<-interpp(coordinates(dframe)[,1],
> coordinates(dframe)[,2],
> >> z=as.data.frame(dframe)[,1],
> >>
> coordinates(wind.grid)[,1],coordinates(wind.grid)[,2],linear=TRUE)
> >>???return(pnt$z)
> >> }
> >>
> >> interp_gk <- function(lat, lon) {
> >>???wind<-read.csv(file="/Users/greg/Out.csv",head=TRUE,sep=",",
> >>
> colClasses=c("POSIXct","numeric","numeric","numeric","numeric"))
> >>???coordinates(wind)=~lat+lon
> >>???proj4string(wind) <-
> CRS("+init=epsg:4326")
> >>
> >>???times<-unique(wind$vt)
> >>???columns<-names(wind)[2:length(names(wind))]
> >>
> >>???dOut<-data.frame(dateTime=times[1])
> >>
> >>???for (i in 1:length(times)) {
> >>???dOut[i,"dateTime"]<-times[i]
> >>? ? ???for (j in
> 1:length(columns)) {
> >>? ? ? ?
> ???sset<-subset(wind, wind$vt==times[i],
> select=c(columns[j]))
> >>? ? ? ?
> ???dOut[i,columns[j]]<-gks(lat,lon,sset,columns[j])
> >>? ? ???}
> >>???}
> >>???dOut<-cbind(dOut,
> mag=sqrt(dOut$ugrd_0^2+dOut$vgrd_0^2))
> >>???return(dOut)
> >> }
> >>
> >> However, I have the following concerns:
> >>
> >>? - Should I really be using akima?? The
> documentation states it is not for
> >>? use on regularly spaced grids - what are my
> alternatives?
> >>? - The interp funcrtion will not work for
> cubic spline "linear=FALSE"
> >>? interpolation (is it because my data is
> regularly gridded?).? How can I
> >>? achieve cubic spline interpolation?
> >>? - Is my function really using the Cordinate
> reference system specified?
> >>? When I comment out the CRS lines, my
> functions return the same values?
> >>
> >> Lots of questions I appreciate, but I am
> curious!? It seems R can achieve
> >> what I am trying to do... but I may just be
> missing some vital bits of
> >> information.
> >>
> >> Thanks,
> >>
> >> Greg
> >>
> >>
> > --
> > Roger Bivand
> > Economic Geography Section, Department of Economics,
> Norwegian School of
> > Economics and Business Administration, Helleveien 30,
> N-5045 Bergen,
> > Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> > e-mail: Roger.Bivand at nhh.no
> >
> >
> 
> ??? [[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 





From gregspam at kooji.com  Wed Apr  8 00:28:24 2009
From: gregspam at kooji.com (Greg King)
Date: Tue, 7 Apr 2009 23:28:24 +0100
Subject: [R-sig-Geo] Spatial Interpolation of Regularly Gridded Data
In-Reply-To: <157733.79234.qm@web28603.mail.ukl.yahoo.com>
References: <157733.79234.qm@web28603.mail.ukl.yahoo.com>
Message-ID: <c7dbc1ea0904071528n345e5691y8fc8dd6d1d62b5af@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090407/530c179d/attachment.pl>

From gianni.lavaredo at gmail.com  Wed Apr  8 15:51:03 2009
From: gianni.lavaredo at gmail.com (gianni lavaredo)
Date: Wed, 8 Apr 2009 15:51:03 +0200
Subject: [R-sig-Geo] problem to module MERGE GRID in RSAGA
In-Reply-To: <CC4ED2D9D05B499EAA65B9C1F662AFCD@pcibed193>
References: <518dff330904070743x1324d4cald3ac0326416904be@mail.gmail.com>
	<CC4ED2D9D05B499EAA65B9C1F662AFCD@pcibed193>
Message-ID: <518dff330904080651k1809dd52k51d258df8d5d2240@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090408/54c459cf/attachment.pl>

From doufuu at gmail.com  Wed Apr  8 21:21:56 2009
From: doufuu at gmail.com (x wong)
Date: Wed, 8 Apr 2009 13:21:56 -0600
Subject: [R-sig-Geo] (no subject)
Message-ID: <9f9c6eed0904081221k38c9ecb4o4fc7111166f9caaa@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090408/4f273273/attachment.pl>

From mwdenslow at yahoo.com  Wed Apr  8 21:33:52 2009
From: mwdenslow at yahoo.com (Michael Denslow)
Date: Wed, 8 Apr 2009 12:33:52 -0700 (PDT)
Subject: [R-sig-Geo] different samples size for each polygon and raster
	question
Message-ID: <304510.71004.qm@web33103.mail.mud.yahoo.com>


Dear r-sig-geo,

I would like to generate random points within each of several polygons. I would like for the sample size of each point sample to be different for each polygon. I would then like to overlay a grid or raster to visualize these point over the entire study area. In other words have the cell value be based on the number of points that fall into each of the grid cells. I have included a reproducible example below to illustrate my problem.

library(sp)
Sr1 = Polygon(cbind(c(2, 4, 4, 1, 2), c(2, 3, 5, 4, 2)))
Sr2 = Polygon(cbind(c(5, 4, 2, 5), c(2, 3, 2, 2)))
Srs1 = Polygons(list(Sr1), "s1")
Srs2 = Polygons(list(Sr2), "s2")
SpP = SpatialPolygons(list(Srs1, Srs2), 1:2)

attr = data.frame(a = 1:2, b = 2:1, row.names = c("s1",
	 "s2"))
SrDf = SpatialPolygonsDataFrame(SpP, attr)

plot(SpP)
## try to get same number in each polygon
# this seems to generate 10 total not 10 for each
# the help file says 'use subsetting to vary sampling intensity'
# I am not sure how to do this
points(spsample(SrDf,n=10,type="random"), pch=3, cex=.5)

## 3 try to get unique sample size for each based on attribute data
# this does not work
points(spsample(SrDf,n=SrDf[[2]],type="random"), pch=3, cex=.5)

## generate a grid file?
## use overlay to combine grid with points?


Thanks in advance for any help you can provide,
Michael

Michael Denslow

Graduate Student
I.W. Carpenter Jr. Herbarium [BOON]
Department of Biology
Appalachian State University
Boone, North Carolina U.S.A.

-- AND --

Communications Manager
Southeast Regional Network of Expertise and Collections
sernec.org


From greenberg at ucdavis.edu  Wed Apr  8 21:43:17 2009
From: greenberg at ucdavis.edu (Jonathan Greenberg)
Date: Wed, 08 Apr 2009 12:43:17 -0700
Subject: [R-sig-Geo] (no subject)
In-Reply-To: <9f9c6eed0904081221k38c9ecb4o4fc7111166f9caaa@mail.gmail.com>
References: <9f9c6eed0904081221k38c9ecb4o4fc7111166f9caaa@mail.gmail.com>
Message-ID: <49DCFE55.2030201@ucdavis.edu>

It seems that a raster-based approach would make more sense, rather than 
the hugely computationally inefficient approach you are suggesting -- 
how about using a least cost path or euclidean distance approach?  Both 
are available in many GIS packages (ArcMap, GRASS GIS, etc...)

--j

x wong wrote:
> dear all,
>
>
>
> I have a raster GIS map converted to points. Now, I am trying to calculate
> the nearest neighbor distance for every point to a cluster of points within
> this map. Since the number of points is more than two millions, I am
> wondering whether there is a computation efficient way to do this.
>
>
>
> The following is what the data looks like:
>
> point_id,x_coord,y_coord,class
>
> 675,-821292,6896866,GL
>
> 738,-819294,6895866,GL
>
> 803,-819294,6894867,GL
>
> 804,-818295,6894867,GL
>
> 805,-817296,6894867,GL
>
> 806,-816297,6894867,RCK
>
> 873,-818296,6893867,GL
>
> 874,-817297,6893867,GL
>
> 875,-816298,6893868,RCK
>
> 876,-815299,6893868,RCK
>
> 877,-814300,6893868,RCK
>
> 878,-813300,6893868,GL
>
> 945,-817297,6892867,GL
>
> 946,-816298,6892868,RCK
>
> 947,-815299,6892868,RCK
>
> 948,-814300,6892868,RCK
>
> 949,-813301,6892868,GL
>
> 950,-812302,6892869,GL
>
> 951,-811303,6892869,GL
>
> 1021,-816298,6891868,RCK
>
> 1023,-814300,6891868,RCK
>
> 1024,-813301,6891869,GL
>
> 1025,-812302,6891869,GL
>
> 1027,-810304,6891869,GL
>
> 1028,-809305,6891870,GL
>
> 1029,-808306,6891870,GL
>
> 1098,-816299,6890868,RCK
>
> 1099,-815300,6890868,RCK
>
> 1100,-814301,6890868,GL
>
> 1101,-813302,6890869,GL
>
> ............................................
>
>
>
> I want to calculate, for example, the nearest distances for all GL points to
> the RCK class.
>
>
>
>
>
> X.W.
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From reeves at nceas.ucsb.edu  Wed Apr  8 21:47:11 2009
From: reeves at nceas.ucsb.edu (rick reeves)
Date: Wed, 08 Apr 2009 12:47:11 -0700
Subject: [R-sig-Geo] (no subject)
In-Reply-To: <49DCFE55.2030201@ucdavis.edu>
References: <9f9c6eed0904081221k38c9ecb4o4fc7111166f9caaa@mail.gmail.com>
	<49DCFE55.2030201@ucdavis.edu>
Message-ID: <49DCFF3F.4040206@nceas.ucsb.edu>

Assuming that this dataset fits within the confines of R, this could be 
done with sp package:  spdistsN1() function
See attached sample solution:

http://nceas.ucsb.edu/scicomp/GISSeminar/UseCases/AssignClosestPointsR/AssignClosestPointsR.html

Hope this helps! RR

Jonathan Greenberg wrote:
> It seems that a raster-based approach would make more sense, rather 
> than the hugely computationally inefficient approach you are 
> suggesting -- how about using a least cost path or euclidean distance 
> approach?  Both are available in many GIS packages (ArcMap, GRASS GIS, 
> etc...)
>
> --j
>
> x wong wrote:
>> dear all,
>>
>>
>>
>> I have a raster GIS map converted to points. Now, I am trying to 
>> calculate
>> the nearest neighbor distance for every point to a cluster of points 
>> within
>> this map. Since the number of points is more than two millions, I am
>> wondering whether there is a computation efficient way to do this.
>>
>>
>>
>> The following is what the data looks like:
>>
>> point_id,x_coord,y_coord,class
>>
>> 675,-821292,6896866,GL
>>
>> 738,-819294,6895866,GL
>>
>> 803,-819294,6894867,GL
>>
>> 804,-818295,6894867,GL
>>
>> 805,-817296,6894867,GL
>>
>> 806,-816297,6894867,RCK
>>
>> 873,-818296,6893867,GL
>>
>> 874,-817297,6893867,GL
>>
>> 875,-816298,6893868,RCK
>>
>> 876,-815299,6893868,RCK
>>
>> 877,-814300,6893868,RCK
>>
>> 878,-813300,6893868,GL
>>
>> 945,-817297,6892867,GL
>>
>> 946,-816298,6892868,RCK
>>
>> 947,-815299,6892868,RCK
>>
>> 948,-814300,6892868,RCK
>>
>> 949,-813301,6892868,GL
>>
>> 950,-812302,6892869,GL
>>
>> 951,-811303,6892869,GL
>>
>> 1021,-816298,6891868,RCK
>>
>> 1023,-814300,6891868,RCK
>>
>> 1024,-813301,6891869,GL
>>
>> 1025,-812302,6891869,GL
>>
>> 1027,-810304,6891869,GL
>>
>> 1028,-809305,6891870,GL
>>
>> 1029,-808306,6891870,GL
>>
>> 1098,-816299,6890868,RCK
>>
>> 1099,-815300,6890868,RCK
>>
>> 1100,-814301,6890868,GL
>>
>> 1101,-813302,6890869,GL
>>
>> ............................................
>>
>>
>>
>> I want to calculate, for example, the nearest distances for all GL 
>> points to
>> the RCK class.
>>
>>
>>
>>
>>
>> X.W.
>>
>>     [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


-- 
Rick Reeves
Scientific Programmer/Analyst and Data Manager
National Center for Ecological Analysis and Synthesis
UC Santa Barbara
www.nceas.ucsb.edu
805 892 2533


From doufuu at gmail.com  Thu Apr  9 02:10:29 2009
From: doufuu at gmail.com (x wong)
Date: Wed, 8 Apr 2009 17:10:29 -0700
Subject: [R-sig-Geo] (no subject)
In-Reply-To: <49DCFF3F.4040206@nceas.ucsb.edu>
References: <9f9c6eed0904081221k38c9ecb4o4fc7111166f9caaa@mail.gmail.com>
	<49DCFE55.2030201@ucdavis.edu> <49DCFF3F.4040206@nceas.ucsb.edu>
Message-ID: <9f9c6eed0904081710j264d549bjc01ebf51763ba1ee@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090408/c0b6ab19/attachment.pl>

From adrian at maths.uwa.edu.au  Thu Apr  9 07:05:16 2009
From: adrian at maths.uwa.edu.au (Adrian Baddeley)
Date: Thu, 09 Apr 2009 13:05:16 +0800
Subject: [R-sig-Geo] convert spatstat owin-object to splancs
In-Reply-To: <mailman.11.1239184802.23990.r-sig-geo@stat.math.ethz.ch>
References: <mailman.11.1239184802.23990.r-sig-geo@stat.math.ethz.ch>
Message-ID: <49DD820C.1070001@maths.uwa.edu.au>

Marco Helbich <marco.helbich at gmx.at> wrote:

> I have the following problem: my dataset contains some events (points) and a 
> studyarea, I used some spatstat functions and now I want to use the 
> bandwidth estimation mse2d() in the splancs package. My problem is to 
> convert the spatstat owin-object (studyarea) to use it in the splancs 
> package. This is the structure of my studyarea:
>
> str(studyarea)
> Formal class 'SpatialPolygonsDataFrame' [package "sp"] with 5 slots
The output says that 'studyarea' is an object of class 
'SpatialPolygonsDataFrame', not an object of class 'owin'.

The SpatialPolygonsDataFrame class is part of the 'sp' package. Since 
the 'splancs' package depends on 'sp', I would have expected that 
splancs could cope with this object.

But if you *did* have an object of class 'owin' (from spatstat) that you 
wanted to convert to a SpatialPolygons object, you could just apply the 
following function to it:

owin2SP <- function(x) {
    stopifnot(is.owin(x))
    x <- as.polygonal(x)
    closering <- function(df) { df[c(seq(nrow(df)), 1), ] }
    pieces <- lapply(x$bdry,
                               function(p) { 
Polygon(coords=closering(cbind(p$x,p$y)), hole=is.hole.xypolygon(p))  })
    whole <- Polygons(pieces, "1")
    SpatialPolygons(list(whole))
}


regards
Adrian Baddeley


From Roger.Bivand at nhh.no  Thu Apr  9 11:07:51 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 9 Apr 2009 11:07:51 +0200 (CEST)
Subject: [R-sig-Geo] (no subject)
In-Reply-To: <9f9c6eed0904081710j264d549bjc01ebf51763ba1ee@mail.gmail.com>
References: <9f9c6eed0904081221k38c9ecb4o4fc7111166f9caaa@mail.gmail.com>
	<49DCFE55.2030201@ucdavis.edu> <49DCFF3F.4040206@nceas.ucsb.edu>
	<9f9c6eed0904081710j264d549bjc01ebf51763ba1ee@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.0904091100140.7710@reclus.nhh.no>

On Wed, 8 Apr 2009, x wong wrote:

> Thank you very much, that is very helpful.
>
>
> x.w.
>
> On Wed, Apr 8, 2009 at 12:47 PM, rick reeves <reeves at nceas.ucsb.edu> wrote:
>
>> Assuming that this dataset fits within the confines of R, this could be
>> done with sp package:  spdistsN1() function
>> See attached sample solution:
>>
>>
>> http://nceas.ucsb.edu/scicomp/GISSeminar/UseCases/AssignClosestPointsR/AssignClosestPointsR.html
>>
>> Hope this helps! RR
>>

Note that this will be inefficient in that it calculates all the 
distances. I have an off-CRAN package interfacing ANN, which - given two 
sets of points, returns the k nearest in the first set (with distances) 
for each point in the second set. ANN builds a tree of the first set, so 
searches for nearest neighbours efficiently. Look for:

http://spatial.nhh.no/R/etc/ann*

The Windows binary wasn't built for the current release of R, so probably 
needs rebuilding - let me know if you use Windows, and I'll re-build it.

Hope this helps,

Roger

>>
>> Jonathan Greenberg wrote:
>>
>>> It seems that a raster-based approach would make more sense, rather than
>>> the hugely computationally inefficient approach you are suggesting -- how
>>> about using a least cost path or euclidean distance approach?  Both are
>>> available in many GIS packages (ArcMap, GRASS GIS, etc...)
>>>
>>> --j
>>>
>>> x wong wrote:
>>>
>>>> dear all,
>>>>
>>>>
>>>>
>>>> I have a raster GIS map converted to points. Now, I am trying to
>>>> calculate
>>>> the nearest neighbor distance for every point to a cluster of points
>>>> within
>>>> this map. Since the number of points is more than two millions, I am
>>>> wondering whether there is a computation efficient way to do this.
>>>>
>>>>
>>>>
>>>> The following is what the data looks like:
>>>>
>>>> point_id,x_coord,y_coord,class
>>>>
>>>> 675,-821292,6896866,GL
>>>>
>>>> 738,-819294,6895866,GL
>>>>
>>>> 803,-819294,6894867,GL
>>>>
>>>> 804,-818295,6894867,GL
>>>>
>>>> 805,-817296,6894867,GL
>>>>
>>>> 806,-816297,6894867,RCK
>>>>
>>>> 873,-818296,6893867,GL
>>>>
>>>> 874,-817297,6893867,GL
>>>>
>>>> 875,-816298,6893868,RCK
>>>>
>>>> 876,-815299,6893868,RCK
>>>>
>>>> 877,-814300,6893868,RCK
>>>>
>>>> 878,-813300,6893868,GL
>>>>
>>>> 945,-817297,6892867,GL
>>>>
>>>> 946,-816298,6892868,RCK
>>>>
>>>> 947,-815299,6892868,RCK
>>>>
>>>> 948,-814300,6892868,RCK
>>>>
>>>> 949,-813301,6892868,GL
>>>>
>>>> 950,-812302,6892869,GL
>>>>
>>>> 951,-811303,6892869,GL
>>>>
>>>> 1021,-816298,6891868,RCK
>>>>
>>>> 1023,-814300,6891868,RCK
>>>>
>>>> 1024,-813301,6891869,GL
>>>>
>>>> 1025,-812302,6891869,GL
>>>>
>>>> 1027,-810304,6891869,GL
>>>>
>>>> 1028,-809305,6891870,GL
>>>>
>>>> 1029,-808306,6891870,GL
>>>>
>>>> 1098,-816299,6890868,RCK
>>>>
>>>> 1099,-815300,6890868,RCK
>>>>
>>>> 1100,-814301,6890868,GL
>>>>
>>>> 1101,-813302,6890869,GL
>>>>
>>>> ............................................
>>>>
>>>>
>>>>
>>>> I want to calculate, for example, the nearest distances for all GL points
>>>> to
>>>> the RCK class.
>>>>
>>>>
>>>>
>>>>
>>>>
>>>> X.W.
>>>>
>>>>    [[alternative HTML version deleted]]
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at stat.math.ethz.ch
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>>
>> --
>> Rick Reeves
>> Scientific Programmer/Analyst and Data Manager
>> National Center for Ecological Analysis and Synthesis
>> UC Santa Barbara
>> www.nceas.ucsb.edu
>> 805 892 2533
>>
>>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From doufuu at gmail.com  Thu Apr  9 16:06:02 2009
From: doufuu at gmail.com (x wong)
Date: Thu, 9 Apr 2009 08:06:02 -0600
Subject: [R-sig-Geo] (no subject)
In-Reply-To: <alpine.LRH.2.00.0904091100140.7710@reclus.nhh.no>
References: <9f9c6eed0904081221k38c9ecb4o4fc7111166f9caaa@mail.gmail.com>
	<49DCFE55.2030201@ucdavis.edu> <49DCFF3F.4040206@nceas.ucsb.edu>
	<9f9c6eed0904081710j264d549bjc01ebf51763ba1ee@mail.gmail.com>
	<alpine.LRH.2.00.0904091100140.7710@reclus.nhh.no>
Message-ID: <9f9c6eed0904090706k69170c6ci1372558c9a8c607f@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090409/9e0a23e8/attachment.pl>

From a.lam at geo.uu.nl  Thu Apr  9 16:33:17 2009
From: a.lam at geo.uu.nl (Arien Lam)
Date: Thu, 9 Apr 2009 16:33:17 +0200 (CEST)
Subject: [R-sig-Geo] different samples size for each polygon and raster
 question
In-Reply-To: <304510.71004.qm@web33103.mail.mud.yahoo.com>
References: <304510.71004.qm@web33103.mail.mud.yahoo.com>
Message-ID: <f6d6d757ffd01e077a3acc1287648502.squirrel@webmail.geo.uu.nl>

On Wed, April 8, 2009 21:33, Michael Denslow wrote:
>
> Dear r-sig-geo,
>
> I would like to generate random points within each of several polygons. I
> would like for the sample size of each point sample to be different for
> each polygon. I would then like to overlay a grid or raster to visualize
> these point over the entire study area. In other words have the cell value
> be based on the number of points that fall into each of the grid cells. I
> have included a reproducible example below to illustrate my problem.
>
> library(sp)
> Sr1 = Polygon(cbind(c(2, 4, 4, 1, 2), c(2, 3, 5, 4, 2)))
> Sr2 = Polygon(cbind(c(5, 4, 2, 5), c(2, 3, 2, 2)))
> Srs1 = Polygons(list(Sr1), "s1")
> Srs2 = Polygons(list(Sr2), "s2")
> SpP = SpatialPolygons(list(Srs1, Srs2), 1:2)
>
> attr = data.frame(a = 1:2, b = 2:1, row.names = c("s1",
> 	 "s2"))
> SrDf = SpatialPolygonsDataFrame(SpP, attr)
>
> plot(SpP)
> ## try to get same number in each polygon
> # this seems to generate 10 total not 10 for each
> # the help file says 'use subsetting to vary sampling intensity'
> # I am not sure how to do this
> points(spsample(SrDf,n=10,type="random"), pch=3, cex=.5)

I don't know how to do it directly, but the following works (though I
would have expected that type='stratify' would also do something like
this)

ptsin1 <- spsample(SrDf[1,],n=10,type="random")
ptsin2 <- spsample(SrDf[2,],n=10,type="random")

plot(SrDf)
points(ptsin1,col='blue')
points(ptsin2,col='red')

allpts <- SpatialPoints(rbind(coordinates(ptsin1),coordinates(ptsin2)))
points(allpts,pch=3)

> ## 3 try to get unique sample size for each based on attribute data
> # this does not work
> points(spsample(SrDf,n=SrDf[[2]],type="random"), pch=3, cex=.5)

You could work the subsetting to a function, e.g. (not optimized):

stratsample <- function(spPolDf, neach=c(10,100)) {
   k = length(spPolDf at polygons)
   allcoors=c(0,0)
   for(i in 1:k) {
     ni = neach[i]
     ptsi <- spsample(spPolDf[i,],n=ni, type="random")
     allcoors = rbind(allcoors,coordinates(ptsi))
     }
   SpatialPoints(allcoors[-1,])
   }

Cheers, Arien (skipping the grid question)

>
> ## generate a grid file?
> ## use overlay to combine grid with points?
>
>
> Thanks in advance for any help you can provide,
> Michael
>
> Michael Denslow
>
> Graduate Student
> I.W. Carpenter Jr. Herbarium [BOON]
> Department of Biology
> Appalachian State University
> Boone, North Carolina U.S.A.
>
> -- AND --
>
> Communications Manager
> Southeast Regional Network of Expertise and Collections
> sernec.org
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


-- 
drs. H.A. (Arien) Lam (Ph.D. student)
Department of Physical Geography
Faculty of Geosciences
Utrecht University, The Netherlands


From alessandro.montaghi at unifi.it  Thu Apr  9 16:49:55 2009
From: alessandro.montaghi at unifi.it (Alessandro)
Date: Thu, 9 Apr 2009 16:49:55 +0200
Subject: [R-sig-Geo] HELP to cbind several data.frame with a LOOP
Message-ID: <010801c9b922$72ea3cb0$58beb610$@montaghi@unifi.it>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090409/fd42f6a3/attachment.pl>

From Roger.Bivand at nhh.no  Thu Apr  9 22:42:01 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 9 Apr 2009 22:42:01 +0200 (CEST)
Subject: [R-sig-Geo] (no subject)
In-Reply-To: <9f9c6eed0904090706k69170c6ci1372558c9a8c607f@mail.gmail.com>
References: <9f9c6eed0904081221k38c9ecb4o4fc7111166f9caaa@mail.gmail.com>
	<49DCFE55.2030201@ucdavis.edu> <49DCFF3F.4040206@nceas.ucsb.edu>
	<9f9c6eed0904081710j264d549bjc01ebf51763ba1ee@mail.gmail.com>
	<alpine.LRH.2.00.0904091100140.7710@reclus.nhh.no>
	<9f9c6eed0904090706k69170c6ci1372558c9a8c607f@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.0904092236460.9599@reclus.nhh.no>

On Thu, 9 Apr 2009, x wong wrote:

> I do use Windows, and thank you very much for the help!
>
> I know how to do this in GIS as Jonathan suggested; however, I haven't tried
> it in R with the solution Rick recommended since i am still cleaning my
> input data.
>
> The problem of this task is very obvious: it will be super inefficient if
> all the distances have to be calculated. My initial thought was to locate
> the target points and subset the dataset before any calculations being made,
> but it may require quite a bit coding...... What you described sounds great
> to me, and i am looking forward to seeing it.
>
> b.t.w. the link you provided doesn't work, would you please double check it?

The link works:

http://spatial.nhh.no/R/etc/ann*

means look in:

http://spatial.nhh.no/R/etc/

for all files with names beginning with ann. The build for R 2.8.* is at:

http://spatial.nhh.no/R/etc/ann_0.3-2.zip

You will have to subset your data into two matrices of planar coordinates, 
one matrix for the data= argument, the other for the query= argument to 
ann(). The output object contains the k nearest neighbours in data= for 
each point in query=, and their distances. See ?ann after installing the 
package.

Roger

>
> X.W.
>
>
>
>
>
>
> On Thu, Apr 9, 2009 at 3:07 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> On Wed, 8 Apr 2009, x wong wrote:
>>
>> Thank you very much, that is very helpful.
>>>
>>>
>>> x.w.
>>>
>>> On Wed, Apr 8, 2009 at 12:47 PM, rick reeves <reeves at nceas.ucsb.edu>
>>> wrote:
>>>
>>> Assuming that this dataset fits within the confines of R, this could be
>>>> done with sp package:  spdistsN1() function
>>>> See attached sample solution:
>>>>
>>>>
>>>>
>>>> http://nceas.ucsb.edu/scicomp/GISSeminar/UseCases/AssignClosestPointsR/AssignClosestPointsR.html
>>>>
>>>> Hope this helps! RR
>>>>
>>>>
>> Note that this will be inefficient in that it calculates all the distances.
>> I have an off-CRAN package interfacing ANN, which - given two sets of
>> points, returns the k nearest in the first set (with distances) for each
>> point in the second set. ANN builds a tree of the first set, so searches for
>> nearest neighbours efficiently. Look for:
>>
>> http://spatial.nhh.no/R/etc/ann*
>>
>> The Windows binary wasn't built for the current release of R, so probably
>> needs rebuilding - let me know if you use Windows, and I'll re-build it.
>>
>> Hope this helps,
>>
>> Roger
>>
>>
>>
>>>> Jonathan Greenberg wrote:
>>>>
>>>> It seems that a raster-based approach would make more sense, rather than
>>>>> the hugely computationally inefficient approach you are suggesting --
>>>>> how
>>>>> about using a least cost path or euclidean distance approach?  Both are
>>>>> available in many GIS packages (ArcMap, GRASS GIS, etc...)
>>>>>
>>>>> --j
>>>>>
>>>>> x wong wrote:
>>>>>
>>>>> dear all,
>>>>>>
>>>>>>
>>>>>>
>>>>>> I have a raster GIS map converted to points. Now, I am trying to
>>>>>> calculate
>>>>>> the nearest neighbor distance for every point to a cluster of points
>>>>>> within
>>>>>> this map. Since the number of points is more than two millions, I am
>>>>>> wondering whether there is a computation efficient way to do this.
>>>>>>
>>>>>>
>>>>>>
>>>>>> The following is what the data looks like:
>>>>>>
>>>>>> point_id,x_coord,y_coord,class
>>>>>>
>>>>>> 675,-821292,6896866,GL
>>>>>>
>>>>>> 738,-819294,6895866,GL
>>>>>>
>>>>>> 803,-819294,6894867,GL
>>>>>>
>>>>>> 804,-818295,6894867,GL
>>>>>>
>>>>>> 805,-817296,6894867,GL
>>>>>>
>>>>>> 806,-816297,6894867,RCK
>>>>>>
>>>>>> 873,-818296,6893867,GL
>>>>>>
>>>>>> 874,-817297,6893867,GL
>>>>>>
>>>>>> 875,-816298,6893868,RCK
>>>>>>
>>>>>> 876,-815299,6893868,RCK
>>>>>>
>>>>>> 877,-814300,6893868,RCK
>>>>>>
>>>>>> 878,-813300,6893868,GL
>>>>>>
>>>>>> 945,-817297,6892867,GL
>>>>>>
>>>>>> 946,-816298,6892868,RCK
>>>>>>
>>>>>> 947,-815299,6892868,RCK
>>>>>>
>>>>>> 948,-814300,6892868,RCK
>>>>>>
>>>>>> 949,-813301,6892868,GL
>>>>>>
>>>>>> 950,-812302,6892869,GL
>>>>>>
>>>>>> 951,-811303,6892869,GL
>>>>>>
>>>>>> 1021,-816298,6891868,RCK
>>>>>>
>>>>>> 1023,-814300,6891868,RCK
>>>>>>
>>>>>> 1024,-813301,6891869,GL
>>>>>>
>>>>>> 1025,-812302,6891869,GL
>>>>>>
>>>>>> 1027,-810304,6891869,GL
>>>>>>
>>>>>> 1028,-809305,6891870,GL
>>>>>>
>>>>>> 1029,-808306,6891870,GL
>>>>>>
>>>>>> 1098,-816299,6890868,RCK
>>>>>>
>>>>>> 1099,-815300,6890868,RCK
>>>>>>
>>>>>> 1100,-814301,6890868,GL
>>>>>>
>>>>>> 1101,-813302,6890869,GL
>>>>>>
>>>>>> ............................................
>>>>>>
>>>>>>
>>>>>>
>>>>>> I want to calculate, for example, the nearest distances for all GL
>>>>>> points
>>>>>> to
>>>>>> the RCK class.
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>> X.W.
>>>>>>
>>>>>>   [[alternative HTML version deleted]]
>>>>>>
>>>>>> _______________________________________________
>>>>>> R-sig-Geo mailing list
>>>>>> R-sig-Geo at stat.math.ethz.ch
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>>
>>>>>>
>>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at stat.math.ethz.ch
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>
>>>>>
>>>>
>>>> --
>>>> Rick Reeves
>>>> Scientific Programmer/Analyst and Data Manager
>>>> National Center for Ecological Analysis and Synthesis
>>>> UC Santa Barbara
>>>> www.nceas.ucsb.edu
>>>> 805 892 2533
>>>>
>>>>
>>>>
>>>        [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>> --
>> Roger Bivand
>> Economic Geography Section, Department of Economics, Norwegian School of
>> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From doufuu at gmail.com  Thu Apr  9 22:46:53 2009
From: doufuu at gmail.com (x wong)
Date: Thu, 9 Apr 2009 14:46:53 -0600
Subject: [R-sig-Geo] (no subject)
In-Reply-To: <alpine.LRH.2.00.0904092236460.9599@reclus.nhh.no>
References: <9f9c6eed0904081221k38c9ecb4o4fc7111166f9caaa@mail.gmail.com>
	<49DCFE55.2030201@ucdavis.edu> <49DCFF3F.4040206@nceas.ucsb.edu>
	<9f9c6eed0904081710j264d549bjc01ebf51763ba1ee@mail.gmail.com>
	<alpine.LRH.2.00.0904091100140.7710@reclus.nhh.no>
	<9f9c6eed0904090706k69170c6ci1372558c9a8c607f@mail.gmail.com>
	<alpine.LRH.2.00.0904092236460.9599@reclus.nhh.no>
Message-ID: <9f9c6eed0904091346u7736f3d0w333d37fa4594c013@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090409/c7c94c45/attachment.pl>

From edzer.pebesma at uni-muenster.de  Fri Apr 10 10:18:56 2009
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 10 Apr 2009 10:18:56 +0200
Subject: [R-sig-Geo] hscattergram between two different variables
In-Reply-To: <12380410.1540151238865492055.JavaMail.root@wmail49>
References: <12380410.1540151238865492055.JavaMail.root@wmail49>
Message-ID: <49DF00F0.80701@uni-muenster.de>

facrimas at libero.it wrote:
> Dear all,
>
>
> I want to plot the cross hscattergram between two different variables.
>
> I used the following instruction:
>
> hscat(jura.pred$Cd~jura.pred$Zn, jura.pred, c(0, 0.1, 0.2, 0.3, 0.5, 1), 
> alpha=c(0,45))
>
> where jura.pred$Cd and jura.pred$Ni are the two variables, but the result 
> obtained is the same of the univariate case when I put 1 instead of jura.
> pred$Zn.
>
> Can you help me?
>   
This cannot be done with hscat (package gstat), right now. It doesn't
say so explicitly, but from the description:

 formula: specifies the dependent variable

you could have understood that a single dependent variable is considered.

It doesn't seem terribly hard to program, either from scratch or
building upon the sources in package gstat.
--
Edzer
> Thanks
>
> Cristiano
>
>   
>> ----Messaggio originale----
>> Da: Roger.Bivand at nhh.no
>> Data: 03/04/2009 21.40
>> A: "milton ruser"<milton.ruser at gmail.com>
>> Cc: <r-sig-geo at stat.math.ethz.ch>
>> Ogg: Re: [R-sig-Geo] rasterize shape file and output as .img
>>
>> On Fri, 3 Apr 2009, milton ruser wrote:
>>
>>     
>>> Dear all,
>>>
>>> I have a set of shapefile and I need rasterized it using a collumn called
>>> ClassCover,
>>> and with the resolution of 30 meters. How can I do this on R?
>>>       
>> Use bbox() of the SpatialPolygonDataFrame to find the extent. Create a 
>> GridTopology object, and overlay the polygons - possibly just with 
>> ClassCover - and the SpatialGrid built with the GridTopology object. This 
>> should yield a SpatialGridDataFrame with a single band, with NAs outside 
>> the polygons, and the polygon column values for raster cells where their 
>> centres fall inside the polygons.
>>
>>     
>>> Another thing is that I need to output the raster as IMG (erdas/arcgis)
>>> format.
>>>       
>> writeGDAL in rgdal.
>>
>> Hope this helps,
>>
>> Roger
>>
>>     
>>> Any help are welcome.
>>>
>>> Best wishes,
>>>
>>> milton
>>> Brasil/Toronto
>>>
>>>       
>>>> require(maptools)
>>>> require(sp)
>>>> require(rgdal)
>>>> todos<-readShapePoly("myshape.shp")
>>>> sessionInfo()
>>>>         
>>> R version 2.9.0 alpha (2009-03-26 r48224)
>>> i386-pc-mingw32
>>> locale:
>>> LC_COLLATE=English_Canada.1252;LC_CTYPE=English_Canada.1252;
>>>       
> LC_MONETARY=English_Canada.1252;LC_NUMERIC=C;LC_TIME=English_Canada.1252
>   
>>> attached base packages:
>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>> other attached packages:
>>> [1] rgdal_0.6-7     maptools_0.7-20 sp_0.9-32       foreign_0.8-34
>>> loaded via a namespace (and not attached):
>>> [1] grid_2.9.0      lattice_0.17-20
>>>
>>> 	[[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>       
>> -- 
>> Roger Bivand
>> Economic Geography Section, Department of Economics, Norwegian School of
>> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>     
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de/
http://www.springer.com/978-0-387-78170-9 e.pebesma at wwu.de


From edzer.pebesma at uni-muenster.de  Fri Apr 10 10:38:24 2009
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 10 Apr 2009 10:38:24 +0200
Subject: [R-sig-Geo] different samples size for each polygon and raster
 question
In-Reply-To: <f6d6d757ffd01e077a3acc1287648502.squirrel@webmail.geo.uu.nl>
References: <304510.71004.qm@web33103.mail.mud.yahoo.com>
	<f6d6d757ffd01e077a3acc1287648502.squirrel@webmail.geo.uu.nl>
Message-ID: <49DF0580.1060804@uni-muenster.de>

Arien Lam wrote:
> On Wed, April 8, 2009 21:33, Michael Denslow wrote:
>   
>> Dear r-sig-geo,
>>
>> I would like to generate random points within each of several polygons. I
>> would like for the sample size of each point sample to be different for
>> each polygon. I would then like to overlay a grid or raster to visualize
>> these point over the entire study area. In other words have the cell value
>> be based on the number of points that fall into each of the grid cells. I
>> have included a reproducible example below to illustrate my problem.
>>
>> library(sp)
>> Sr1 = Polygon(cbind(c(2, 4, 4, 1, 2), c(2, 3, 5, 4, 2)))
>> Sr2 = Polygon(cbind(c(5, 4, 2, 5), c(2, 3, 2, 2)))
>> Srs1 = Polygons(list(Sr1), "s1")
>> Srs2 = Polygons(list(Sr2), "s2")
>> SpP = SpatialPolygons(list(Srs1, Srs2), 1:2)
>>
>> attr = data.frame(a = 1:2, b = 2:1, row.names = c("s1",
>> 	 "s2"))
>> SrDf = SpatialPolygonsDataFrame(SpP, attr)
>>
>> plot(SpP)
>> ## try to get same number in each polygon
>> # this seems to generate 10 total not 10 for each
>> # the help file says 'use subsetting to vary sampling intensity'
>> # I am not sure how to do this
>> points(spsample(SrDf,n=10,type="random"), pch=3, cex=.5)
>>     
>
> I don't know how to do it directly, but the following works (though I
> would have expected that type='stratify' would also do something like
> this)
>   
type = 'stratify' follows the ideas of spatially stratified sampling,
(B.D. Ripley, 1981. Spatial Statistics, Wiley) where the strata are
square blocks layed out over the study area. Yes, it would be nice to
have a more generic stratified sampling scheme here.

Getting the number of points in grid cells should be fairly easy: assign
values 1 to the sampled points, overlay them with the grid and use
function sum to get the grid cell total; this might help:

require(sp)
data(meuse.grid)
gridded(meuse.grid) = ~x+y
x = SpatialPixels(SpatialPoints(makegrid(meuse.grid, 20)))
n = nrow(coordinates(x))
pts = spsample(meuse.grid, 100, "random")
x = SpatialPixelsDataFrame(x, data.frame(a = rep(1,n)))
m = as.matrix(table(overlay(x, pts)))
x$b = rep(0,n)
x$b[as.numeric(rownames(m))] = m[,1]
x$b
image(x["b"])
--
Edzer

> ptsin1 <- spsample(SrDf[1,],n=10,type="random")
> ptsin2 <- spsample(SrDf[2,],n=10,type="random")
>
> plot(SrDf)
> points(ptsin1,col='blue')
> points(ptsin2,col='red')
>
> allpts <- SpatialPoints(rbind(coordinates(ptsin1),coordinates(ptsin2)))
> points(allpts,pch=3)
>
>   
>> ## 3 try to get unique sample size for each based on attribute data
>> # this does not work
>> points(spsample(SrDf,n=SrDf[[2]],type="random"), pch=3, cex=.5)
>>     
>
> You could work the subsetting to a function, e.g. (not optimized):
>
> stratsample <- function(spPolDf, neach=c(10,100)) {
>    k = length(spPolDf at polygons)
>    allcoors=c(0,0)
>    for(i in 1:k) {
>      ni = neach[i]
>      ptsi <- spsample(spPolDf[i,],n=ni, type="random")
>      allcoors = rbind(allcoors,coordinates(ptsi))
>      }
>    SpatialPoints(allcoors[-1,])
>    }
>
> Cheers, Arien (skipping the grid question)
>
>   
>> ## generate a grid file?
>> ## use overlay to combine grid with points?
>>
>>
>> Thanks in advance for any help you can provide,
>> Michael
>>
>> Michael Denslow
>>
>> Graduate Student
>> I.W. Carpenter Jr. Herbarium [BOON]
>> Department of Biology
>> Appalachian State University
>> Boone, North Carolina U.S.A.
>>
>> -- AND --
>>
>> Communications Manager
>> Southeast Regional Network of Expertise and Collections
>> sernec.org
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>     
>
>
>   

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de/
http://www.springer.com/978-0-387-78170-9 e.pebesma at wwu.de


From gianni.lavaredo at gmail.com  Fri Apr 10 18:20:30 2009
From: gianni.lavaredo at gmail.com (gianni lavaredo)
Date: Fri, 10 Apr 2009 18:20:30 +0200
Subject: [R-sig-Geo] caclulate "root mean square error"
Message-ID: <518dff330904100920p2583eb45h82b1a0729b2b452b@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090410/4c23ddbf/attachment.pl>

From kingsfordjones at gmail.com  Fri Apr 10 18:56:15 2009
From: kingsfordjones at gmail.com (Kingsford Jones)
Date: Fri, 10 Apr 2009 10:56:15 -0600
Subject: [R-sig-Geo] caclulate "root mean square error"
In-Reply-To: <518dff330904100920p2583eb45h82b1a0729b2b452b@mail.gmail.com>
References: <518dff330904100920p2583eb45h82b1a0729b2b452b@mail.gmail.com>
Message-ID: <2ad0cc110904100956y4efbcb1cve5e2dbddceb2c14d@mail.gmail.com>

If 'obs' are the true values and 'pred' are the predicted values, it's just

rmse <- function(obs, pred) sqrt(mean((obs-pred)^2))

hth,
Kingsford Jones

On Fri, Apr 10, 2009 at 10:20 AM, gianni lavaredo
<gianni.lavaredo at gmail.com> wrote:
> Dear User,
>
> is there a package to caclulate the root mean square error from two
> data-serie (real value vs predicted value)?
>
> thanks and "BUONA PASQUA"
>
> Gianni
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From Thierry.ONKELINX at inbo.be  Sat Apr 11 17:47:20 2009
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Sat, 11 Apr 2009 17:47:20 +0200
Subject: [R-sig-Geo] Questions about spautolm
Message-ID: <2E9C414912813E4EB981326983E0A1040656F59E@inboexch.inbo.be>

Dear all,

I have a few questions about spautolm from the spdep package.

I get warning about "Assymetric weights" with family = "CAR". The
weights are defined like the code below. The dataset is roughly based on
a 1000 x 500m grid. But only the gridpoints in forest are measured.
Hence it is not possible to get symmetric weights. Is this violating an
assumuption of the model? Or can this cause another problem?

Buren <- dnearneigh(cbind(dataset$X, dataset$Y), d1 = 0, d2 = 6500)
Weights <- nb2listw(Buren, style = "W", zero.policy = TRUE)

My second question is about prediction. Is it possible to use a spautolm
model to make predictions for other locations?

Regards,

Thierry

------------------------------------------------------------------------
----
ir. Thierry Onkelinx
Instituut voor natuur- en bosonderzoek / Research Institute for Nature
and Forest
Cel biometrie, methodologie en kwaliteitszorg / Section biometrics,
methodology and quality assurance
Gaverstraat 4
9500 Geraardsbergen
Belgium 
tel. + 32 54/436 185
Thierry.Onkelinx at inbo.be 
www.inbo.be 

To call in the statistician after the experiment is done may be no more
than asking him to perform a post-mortem examination: he may be able to
say what the experiment died of.
~ Sir Ronald Aylmer Fisher

The plural of anecdote is not data.
~ Roger Brinner

The combination of some data and an aching desire for an answer does not
ensure that a reasonable answer can be extracted from a given body of
data.
~ John Tukey

Dit bericht en eventuele bijlagen geven enkel de visie van de schrijver weer 
en binden het INBO onder geen enkel beding, zolang dit bericht niet bevestigd is
door een geldig ondertekend document. The views expressed in  this message 
and any annex are purely those of the writer and may not be regarded as stating 
an official position of INBO, as long as the message is not confirmed by a duly 
signed document.


From Roger.Bivand at nhh.no  Sat Apr 11 23:23:18 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 11 Apr 2009 23:23:18 +0200
Subject: [R-sig-Geo] Questions about spautolm
References: <2E9C414912813E4EB981326983E0A1040656F59E@inboexch.inbo.be>
Message-ID: <AD51AB79BC327C40AB2C7EB75D57A3C40512F2@TOLAR.valuta.nhh.no>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090411/ee0b0f4a/attachment.pl>

From gianni.lavaredo at gmail.com  Sun Apr 12 18:23:46 2009
From: gianni.lavaredo at gmail.com (gianni lavaredo)
Date: Sun, 12 Apr 2009 18:23:46 +0200
Subject: [R-sig-Geo] Help to save the value of "Multiple R-Squared" in a a
	simple regression model
Message-ID: <518dff330904120923p128dd983m831553e4997f96c7@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090412/43651cfe/attachment.pl>

From kingsfordjones at gmail.com  Sun Apr 12 21:08:29 2009
From: kingsfordjones at gmail.com (Kingsford Jones)
Date: Sun, 12 Apr 2009 13:08:29 -0600
Subject: [R-sig-Geo] Help to save the value of "Multiple R-Squared" in a
	a simple regression model
In-Reply-To: <518dff330904120923p128dd983m831553e4997f96c7@mail.gmail.com>
References: <518dff330904120923p128dd983m831553e4997f96c7@mail.gmail.com>
Message-ID: <2ad0cc110904121208t4b48f914k8347b4c9f6e19abf@mail.gmail.com>

On Sun, Apr 12, 2009 at 10:23 AM, gianni lavaredo
<gianni.lavaredo at gmail.com> wrote:
> Dear R User,
>
> "Buona Pasqua".

> I have a simple regression model
>
> myModel <- lm( y ~ x)
> Summary(myModel)
>
> I wish to save the value of "Multiple R-Squared" in a list or data.frame
> format.

Hi Gianni,

For a 'simple' regression

r2 <- cor(y,x)^2

More generally, names(summary(MyModel)) will tell you the names of the
objects in the list produced by summary.lm -- or use the 'str'
function to see a summary of the structure of the object. Since the
R-squared list element is named 'r.squared' it can be extracted with

r2 <- summary(myModel)$r.squared

As for making a data frame or list object,

lst <- list(r2)
or
df <- data.frame(r2)

Buona Pasqua,

Kingsford Jones

>
> Thanks
>
> Gianni
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From Shelob1985 at libero.it  Mon Apr 13 14:57:45 2009
From: Shelob1985 at libero.it (Shelob1985 at libero.it)
Date: Mon, 13 Apr 2009 14:57:45 +0200 (CEST)
Subject: [R-sig-Geo] locate a point
Message-ID: <5142739.12681239627465464.JavaMail.defaultUser@defaultHost>

>Hi everybody. I have a very elementary question but any help is appreciated.
>I have a database which contains the indication of latitude and 
>longitude of, say, South American mineral ores. I have to find out in which 
country 
>of South America each mineral ore is located. There are certainly maps of 
South America with the indication of states boundaries which can be 
read and drawn by R. Is there any way I can use R to assign each data point 
to the country in which it falls? 
Thanks, 
Sheila


From everton.emanuel at gmail.com  Mon Apr 13 18:02:49 2009
From: everton.emanuel at gmail.com (Everton Emanuel)
Date: Mon, 13 Apr 2009 13:02:49 -0300
Subject: [R-sig-Geo] How to deal with missing values in geospatial data
Message-ID: <df06e3df0904130902y1f408230x2af73afe855eab3c@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090413/5fc8244b/attachment.pl>

From zev at zevross.com  Mon Apr 13 21:44:08 2009
From: zev at zevross.com (Zev Ross)
Date: Mon, 13 Apr 2009 15:44:08 -0400
Subject: [R-sig-Geo] RPyGeo Query -- probably easy
In-Reply-To: <49D39E46.4000702@uwaterloo.ca>
References: <49CBEB4F.4060905@zevross.com> <49D39E46.4000702@uwaterloo.ca>
Message-ID: <49E39608.9030608@zevross.com>

Hi Alex,

Thank you so much for the suggestion and apologies for taking so long to 
test it. I think the quotes are still a problem. I do indeed write all 
my code in R-WinEdt but must be doing something wrong. In Python your 
suggested escaped quotes works fine but perhaps I missed something in 
RPyGeo:

This code works in Python:

gp.makefeaturelayer("abc.shp", "walk")
gp.SelectLayerByAttribute('walk','NEW_SELECTION','\"hrwk05\" <> 0')

This code works in R:

rpygeo.geoprocessor(
"makefeaturelayer('abc.shp', 'walk')",
"SelectLayerByAttribute('walk','NEW_SELECTION','')",
env=myenv)

This code gives me an error in R:

rpygeo.geoprocessor(
"makefeaturelayer('abc.shp','walk')",
"SelectLayerByAttribute('walk','NEW_SELECTION','\"hrwk05\" <> 0')",
 env=myenv)

File "x:\projects\rpygeo.py", line 10
gp.makefeaturelayer('abc.shp','walk')( 
"SelectLayerByAttribute('walk','NEW_SELECTION','"hrwk05" <> 0')" )
                                                                                                 
^
SyntaxError: invalid syntax
NULL

(note from Zev -- the carrot occurs under the "05")


Alexander Brenning wrote:
> Hi Zev,
>
> the problems are definitely your quotes. First, they are syntactically 
> incorrect - I count seven double quotes (I recommend using some editor 
> with syntax highlighting, like Tinn-R or R-WinEdt, this helps discover 
> mismatches). Second, escaping them (\") should allow you to put double 
> quotes inside a double-quoted character string.
>
> This might be closer to what you want to do (but I haven't tried to 
> run it - sorry, busy end of term...):
>
> rpygeo.geoprocessor("makefeaturelayer('X:\\abc.shp','walk')",
>     "SelectLayerByAttribute('walk','NEW_SELECTION','\"hrwk05\"<>0')",
>     env=myenv)
>
> Note that an additional argument clean.up=FALSE to the 
> rpygeo.geoprocessor allows you to inspect the Python file to check 
> whether the quotes are syntactically correct in Python.
>
> I hope this helps
>  Alex
>
>
>
> Zev Ross wrote:
>> Hi All,
>>
>> I'm wondering if anybody could give me a little guidance on 
>> formatting a query using RPyGeo. I'm excited to be able to run Python 
>> geoprocessing functions straight from R but am having trouble with 
>> the quote, double quote kinds of issues.
>>
>> Here's an example of what I'd like to run
>>
>> rpygeo.geoprocessor("makefeaturelayer('X:\\abc.shp',
>> 'walk')", "SelectLayerByAttribute('walk','NEW_SELECTION', ' "hrwk05" 
>> '<>0")",env=myenv)
>>
>> Where the sticking point is hrwk05 <> 0. In Python my query would be 
>> double quote, field name, close double quote, comparison, number e.g, 
>> "hrwk05" <> 0 but I'm not sure how to put this into RPyGeo
>>
>> If I run like so:
>>
>> rpygeo.geoprocessor("makefeaturelayer('X:\\abc.shp',
>> 'walk')", "SelectLayerByAttribute('walk','NEW_SELECTION', 
>> '')",env=myenv)
>>
>> it runs.
>>
>> Thank you in advance for assistance.
>>
>> Zev
>>
>

-- 
Zev Ross
ZevRoss Spatial Analysis
120 N Aurora, Suite 3A
Ithaca, NY 14850
607-277-0004 (phone)
866-877-3690 (fax, toll-free)
zev at zevross.com


From Roger.Bivand at nhh.no  Mon Apr 13 21:58:03 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 13 Apr 2009 21:58:03 +0200 (CEST)
Subject: [R-sig-Geo] How to deal with missing values in geospatial data
In-Reply-To: <df06e3df0904130902y1f408230x2af73afe855eab3c@mail.gmail.com>
References: <df06e3df0904130902y1f408230x2af73afe855eab3c@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.0904132149370.29917@reclus.nhh.no>

On Mon, 13 Apr 2009, Everton Emanuel wrote:

> Dear all,
>
> I am doing some spatial analysis for the Federal Unities of Brazil. At this
> point I am dealing with some  problems concerning "missing values" in the
> spatial data set. My question is:
>
> How can I create maps if I have missing values in some spatial units?

The spplot, plot, and image methods treat NAs (assuming that you have set 
your missing values to NA) as other R graphics methods - they show the 
background colour. So you can in general ignore the NAs, or if need be 
reset the background colour:

library(sp)
data(meuse.grid)
coordinates(meuse.grid) <- c("x", "y")
gridded(meuse.grid) <- TRUE
summary(meuse.grid$dist)
image(meuse.grid, "dist", axes=TRUE)
is.na(meuse.grid$dist) <- meuse.grid$dist < 0.3
summary(meuse.grid$dist)
image(meuse.grid, "dist", axes=TRUE)

Hope this helps,

Roger

>
> Can I solve this problem by inputing values to this lacks of information?
>
> Thank you all,
> Everton.
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Mon Apr 13 22:01:06 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 13 Apr 2009 22:01:06 +0200 (CEST)
Subject: [R-sig-Geo] RPyGeo Query -- probably easy
In-Reply-To: <49E39608.9030608@zevross.com>
References: <49CBEB4F.4060905@zevross.com> <49D39E46.4000702@uwaterloo.ca>
	<49E39608.9030608@zevross.com>
Message-ID: <alpine.LRH.2.00.0904132158460.29917@reclus.nhh.no>

On Mon, 13 Apr 2009, Zev Ross wrote:

> Hi Alex,
>
> Thank you so much for the suggestion and apologies for taking so long to test 
> it. I think the quotes are still a problem. I do indeed write all my code in 
> R-WinEdt but must be doing something wrong. In Python your suggested escaped 
> quotes works fine but perhaps I missed something in RPyGeo:

Is it possible that shQuote() might help here - maybe the multiple layers 
are a problem, but quite often this function is good at guessing?

Roger

>
> This code works in Python:
>
> gp.makefeaturelayer("abc.shp", "walk")
> gp.SelectLayerByAttribute('walk','NEW_SELECTION','\"hrwk05\" <> 0')
>
> This code works in R:
>
> rpygeo.geoprocessor(
> "makefeaturelayer('abc.shp', 'walk')",
> "SelectLayerByAttribute('walk','NEW_SELECTION','')",
> env=myenv)
>
> This code gives me an error in R:
>
> rpygeo.geoprocessor(
> "makefeaturelayer('abc.shp','walk')",
> "SelectLayerByAttribute('walk','NEW_SELECTION','\"hrwk05\" <> 0')",
> env=myenv)
>
> File "x:\projects\rpygeo.py", line 10
> gp.makefeaturelayer('abc.shp','walk')( 
> "SelectLayerByAttribute('walk','NEW_SELECTION','"hrwk05" <> 0')" )
>                                                                                                ^
> SyntaxError: invalid syntax
> NULL
>
> (note from Zev -- the carrot occurs under the "05")
>
>
> Alexander Brenning wrote:
>> Hi Zev,
>> 
>> the problems are definitely your quotes. First, they are syntactically 
>> incorrect - I count seven double quotes (I recommend using some editor with 
>> syntax highlighting, like Tinn-R or R-WinEdt, this helps discover 
>> mismatches). Second, escaping them (\") should allow you to put double 
>> quotes inside a double-quoted character string.
>> 
>> This might be closer to what you want to do (but I haven't tried to run it 
>> - sorry, busy end of term...):
>> 
>> rpygeo.geoprocessor("makefeaturelayer('X:\\abc.shp','walk')",
>>     "SelectLayerByAttribute('walk','NEW_SELECTION','\"hrwk05\"<>0')",
>>     env=myenv)
>> 
>> Note that an additional argument clean.up=FALSE to the rpygeo.geoprocessor 
>> allows you to inspect the Python file to check whether the quotes are 
>> syntactically correct in Python.
>> 
>> I hope this helps
>>  Alex
>> 
>> 
>> 
>> Zev Ross wrote:
>>> Hi All,
>>> 
>>> I'm wondering if anybody could give me a little guidance on formatting a 
>>> query using RPyGeo. I'm excited to be able to run Python geoprocessing 
>>> functions straight from R but am having trouble with the quote, double 
>>> quote kinds of issues.
>>> 
>>> Here's an example of what I'd like to run
>>> 
>>> rpygeo.geoprocessor("makefeaturelayer('X:\\abc.shp',
>>> 'walk')", "SelectLayerByAttribute('walk','NEW_SELECTION', ' "hrwk05" 
>>> '<>0")",env=myenv)
>>> 
>>> Where the sticking point is hrwk05 <> 0. In Python my query would be 
>>> double quote, field name, close double quote, comparison, number e.g, 
>>> "hrwk05" <> 0 but I'm not sure how to put this into RPyGeo
>>> 
>>> If I run like so:
>>> 
>>> rpygeo.geoprocessor("makefeaturelayer('X:\\abc.shp',
>>> 'walk')", "SelectLayerByAttribute('walk','NEW_SELECTION', '')",env=myenv)
>>> 
>>> it runs.
>>> 
>>> Thank you in advance for assistance.
>>> 
>>> Zev
>>> 
>> 
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Nicholas.Nagle at Colorado.EDU  Mon Apr 13 23:55:00 2009
From: Nicholas.Nagle at Colorado.EDU (Nicholas N Nagle)
Date: Mon, 13 Apr 2009 15:55:00 -0600 (MDT)
Subject: [R-sig-Geo] R/Grass Interface
Message-ID: <20090413155500.AIN54945@riddler.int.colorado.edu>

Dear list,
I am trying to load the spgrass6 library from within GRASS.  I am running R 2.8.0 and GRASS6.4 from within QGIS (i.e. Plugins -> GRASS -> Open Grass Tools -> Shell).

Here is the problem I am getting:
> library(spgrass6)
Error in system(paste("g.version", .addexe(), sep = ""), intern = TRUE) : 
  g.version not found
In addition: Warning message:
package 'spgrass6' was built under R version 2.8.1 
Error in library(spgrass6) : .First.lib failed for 'spgrass6'

The warning, is usual for me, and has not caused any problems in the past.

I don't know if this helps, but I also get:

> system("g.version")
Warning message:
In system("g.version") : g.version not found
> system("g.version.exe")
GRASS 6.4.0svn (2009) 

so I CAN run g.version.exe, but not g.version.  Is this a problem for spgrass6?

Thanks,

Nicholas



Nicholas N. Nagle, Assistant Professor
University of Colorado
Department of Geography
UCB 260, Guggenheim 110
Boulder, CO 80309-0260
phone: 303-492-4794


From brenning at uwaterloo.ca  Tue Apr 14 02:09:55 2009
From: brenning at uwaterloo.ca (Alexander Brenning)
Date: Mon, 13 Apr 2009 20:09:55 -0400
Subject: [R-sig-Geo] RPyGeo Query -- probably easy
In-Reply-To: <49E39608.9030608@zevross.com>
References: <49CBEB4F.4060905@zevross.com> <49D39E46.4000702@uwaterloo.ca>
	<49E39608.9030608@zevross.com>
Message-ID: <49E3D453.8020703@uwaterloo.ca>

well, these are two separate Python commands:

> gp.makefeaturelayer("abc.shp", "walk")
> gp.SelectLayerByAttribute('walk','NEW_SELECTION','\"hrwk05\" <> 0')

but this...

 > rpygeo.geoprocessor(
 > "makefeaturelayer('abc.shp','walk')",
 > "SelectLayerByAttribute('walk','NEW_SELECTION','\"hrwk05\" <> 0')",
 > env=myenv)
 >
 > File "x:\projects\rpygeo.py", line 10
 > gp.makefeaturelayer('abc.shp','walk')(
 > "SelectLayerByAttribute('walk','NEW_SELECTION','"hrwk05" <> 0')" )

...apparently creates a Python function call 
gp.makefeaturelayer('abc.shp','walk') that is then considered to be a 
function that itself is able to make sense of the argument 
"SelectLayerByAttribute('walk','NEW_SELECTION','"hrwk05" <> 0')"

This is not what you want. The problem is that in

 > rpygeo.geoprocessor(
 > "makefeaturelayer('abc.shp','walk')",
 > "SelectLayerByAttribute('walk','NEW_SELECTION','\"hrwk05\" <> 0')",
 > env=myenv)

the "Select...." thing is considered to be an argument to the function 
defined by the first argument of the geoprocessor (please have a look at 
?rpygeo.geoprocessor - I am a bit in a hurry now because I am on a trip 
to Chile and ready for a delicious dinner ;-)

So try using c( ) (after having a closer look at the rpygeo.geoprocessor 
help / command syntax), or use separate rpygeo.geoprocessor calls for 
the two gp. commands...

> rpygeo.geoprocessor(
> c("makefeaturelayer('abc.shp', 'walk')",
> "SelectLayerByAttribute('walk','NEW_SELECTION','')"),
> env=myenv)

I hope this helps...
   Alex

p.s.: will be without email for the rest of the week

-- 
Alexander Brenning
brenning at uwaterloo.ca - T +1-519-888-4567 ext 35783
Department of Geography and Environmental Management
University of Waterloo
200 University Ave. W - Waterloo, ON - Canada N2L 3G1
http://www.fes.uwaterloo.ca/geography/faculty/brenning/


From milton.ruser at gmail.com  Tue Apr 14 06:41:57 2009
From: milton.ruser at gmail.com (milton ruser)
Date: Tue, 14 Apr 2009 00:41:57 -0400
Subject: [R-sig-Geo] R/Grass Interface
In-Reply-To: <20090413155500.AIN54945@riddler.int.colorado.edu>
References: <20090413155500.AIN54945@riddler.int.colorado.edu>
Message-ID: <3aaf1a030904132141td83a74ci12cbe03b78bb75d6@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090414/c532784a/attachment.pl>

From Roger.Bivand at nhh.no  Tue Apr 14 08:31:25 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 14 Apr 2009 08:31:25 +0200 (CEST)
Subject: [R-sig-Geo] R/Grass Interface
In-Reply-To: <3aaf1a030904132141td83a74ci12cbe03b78bb75d6@mail.gmail.com>
References: <20090413155500.AIN54945@riddler.int.colorado.edu>
	<3aaf1a030904132141td83a74ci12cbe03b78bb75d6@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.0904140815110.6455@reclus.nhh.no>

On Tue, 14 Apr 2009, milton ruser wrote:

> Nicholas,
>
> I have the same problem, and change to R 2.9.0 and the things works fine
> under windows Vista. But the preparing my command to send to system("...")
> we need to include the .exe on the command. According to Roger Bivand, this
> issue will be solve on next versions.
>
> Try install R 2.9.0 alpha, and good luck.

2.9.0 is due later this week, so I'd wait for the official release. The R 
version isn't the problem - the problem is that (your choice of) Windows 
Native GRASS 6.3, 6.4, GRASS on Cygwin, QGIS (any version) vary in how 
they name executable commands. In principle QGIS runs through msys, so 
sets a Windows environment variable to say so, but things may vary from 
version to version of GRASS through QGIS.

The forthcoming spgrass_0.6-* release tries to centralise the reading of 
the auspices wrt. which Windows version is running, and provides an 
execGRASS() function wrapping a doGRASS() function building a command line 
for system(), and based on parseGRASS(), which reads the GRASS command 
interface description. Unix (GNU Linux/OSX/etc) users have access to the 
source by anonymous CVS on sourceforge on the r-spatial project; a draft 
Windows release is at:

http://spatial.nhh.no/R/Devel/spgrass6_0.6-3.zip

Nicholas - could you please try the draft and see if it helps?

Best wishes,

Roger

>
> best wishes
>
> miltinho
> brazil-toronto
>
> On Mon, Apr 13, 2009 at 5:55 PM, Nicholas N Nagle <
> Nicholas.Nagle at colorado.edu> wrote:
>
>> Dear list,
>> I am trying to load the spgrass6 library from within GRASS.  I am running R
>> 2.8.0 and GRASS6.4 from within QGIS (i.e. Plugins -> GRASS -> Open Grass
>> Tools -> Shell).
>>
>> Here is the problem I am getting:
>>> library(spgrass6)
>> Error in system(paste("g.version", .addexe(), sep = ""), intern = TRUE) :
>>  g.version not found
>> In addition: Warning message:
>> package 'spgrass6' was built under R version 2.8.1
>> Error in library(spgrass6) : .First.lib failed for 'spgrass6'
>>
>> The warning, is usual for me, and has not caused any problems in the past.
>>
>> I don't know if this helps, but I also get:
>>
>>> system("g.version")
>> Warning message:
>> In system("g.version") : g.version not found
>>> system("g.version.exe")
>> GRASS 6.4.0svn (2009)
>>
>> so I CAN run g.version.exe, but not g.version.  Is this a problem for
>> spgrass6?
>>
>> Thanks,
>>
>> Nicholas
>>
>>
>>
>> Nicholas N. Nagle, Assistant Professor
>> University of Colorado
>> Department of Geography
>> UCB 260, Guggenheim 110
>> Boulder, CO 80309-0260
>> phone: 303-492-4794
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From manderse at nmsu.edu  Tue Apr 14 18:26:57 2009
From: manderse at nmsu.edu (Mark Andersen)
Date: Tue, 14 Apr 2009 10:26:57 -0600
Subject: [R-sig-Geo] Need an algorithm to identify spatial clusters
Message-ID: <49E4B951.40806@nmsu.edu>

Hello, all,

I am currently interested in simulating the initiation and spread of 
forest fires in simulated landscapes consisting of 2 tree species (a 
native and an invasive). I'm simulating fire seasons of fixed length; 
fires can start at any time and in either tree species during this fire 
season, and spread through the simulated forest according to a simple 
percolation-like process. I have developed the algorithms for this in 
Matlab, and don't anticipate any problems converting them to R if I need 
to.

However, it's the next task that has me at a loss. At the end of each 
fire season, there will be several burned patches on the simulated 
landscape; the number of these patches won't necessarily correspond to 
the total number of fires that season, because fires may coalesce. I 
need to count how many of these burned patches there are, and find the 
size of each. It seems that there should be an algorithm available to do 
this, but I haven't found one, possibly because I haven't been using the 
right search criteria. I used RSiteSearch("spatial cluster"), and got 
many references to the spatclus package. However, from the spatclus 
documentation it appears that this is not quite what I'm looking for. 
Spatclus looks like it picks out potential clusters of occurrence of 
some phenomenon (such as earthqukes or cancer); I need something that 
will delineate clusters of contiguous pixels with the same value (i.e., 
burned in my simulations). Could anyone point me towards such an 
algorithm, or help me get started finding one?

-- 
Dr. Mark C. Andersen, Professor
Department of Fish, Wildlife, and Conservation Ecology
New Mexico State University
Las Cruces, NM 88003
575-646-8034
fax: 575-646-1281
web: web.nmsu.edu/~manderse


From miguel.gil.biraud at ieee.org  Tue Apr 14 18:37:47 2009
From: miguel.gil.biraud at ieee.org (Miguel Eduardo Gil Biraud)
Date: Tue, 14 Apr 2009 18:37:47 +0200
Subject: [R-sig-Geo] Need an algorithm to identify spatial clusters
In-Reply-To: <49E4B951.40806@nmsu.edu>
References: <49E4B951.40806@nmsu.edu>
Message-ID: <bba7081f0904140937y1b2e8142p4f6d020728e6aa67@mail.gmail.com>

Hi,

I'm not an expert at all but maybe this page will put you in the right
direction.
http://home.dei.polimi.it/matteucc/Clustering/tutorial_html/

>From what I understood you might be interested in looking into K-means
clustering, which a quick google search of R K-means returns a few
results and among them:
http://www.r-cookbook.com/node/23

Cheers,
Miguel

On Tue, Apr 14, 2009 at 18:26, Mark Andersen <manderse at nmsu.edu> wrote:
> Hello, all,
>
> I am currently interested in simulating the initiation and spread of forest
> fires in simulated landscapes consisting of 2 tree species (a native and an
> invasive). I'm simulating fire seasons of fixed length; fires can start at
> any time and in either tree species during this fire season, and spread
> through the simulated forest according to a simple percolation-like process.
> I have developed the algorithms for this in Matlab, and don't anticipate any
> problems converting them to R if I need to.
>
> However, it's the next task that has me at a loss. At the end of each fire
> season, there will be several burned patches on the simulated landscape; the
> number of these patches won't necessarily correspond to the total number of
> fires that season, because fires may coalesce. I need to count how many of
> these burned patches there are, and find the size of each. It seems that
> there should be an algorithm available to do this, but I haven't found one,
> possibly because I haven't been using the right search criteria. I used
> RSiteSearch("spatial cluster"), and got many references to the spatclus
> package. However, from the spatclus documentation it appears that this is
> not quite what I'm looking for. Spatclus looks like it picks out potential
> clusters of occurrence of some phenomenon (such as earthqukes or cancer); I
> need something that will delineate clusters of contiguous pixels with the
> same value (i.e., burned in my simulations). Could anyone point me towards
> such an algorithm, or help me get started finding one?
>
> --
> Dr. Mark C. Andersen, Professor
> Department of Fish, Wildlife, and Conservation Ecology
> New Mexico State University
> Las Cruces, NM 88003
> 575-646-8034
> fax: 575-646-1281
> web: web.nmsu.edu/~manderse
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
http://franchu.net


From dan.putler at sauder.ubc.ca  Tue Apr 14 18:41:48 2009
From: dan.putler at sauder.ubc.ca (Dan Putler)
Date: Tue, 14 Apr 2009 09:41:48 -0700
Subject: [R-sig-Geo] Need an algorithm to identify spatial clusters
In-Reply-To: <25993_1239726597_1239726597_49E4B951.40806@nmsu.edu>
References: <25993_1239726597_1239726597_49E4B951.40806@nmsu.edu>
Message-ID: <1239727308.6873.6.camel@whitebox>

Hi Mark,

Is your data on a raster grid? If yes, could it be converted to a vector
point set? If you can get it into a vector point set then DBSCAN might
solve your problem. The remaining issue is the choice of a cluster
validation method to determine the number of clusters. I have developed
one that seems to work well for two dimensional data (which is your
case), but is still under development. If you have an interest, let me
know, I can send code along.

Dan

On Tue, 2009-04-14 at 10:26 -0600, Mark Andersen wrote:
> Hello, all,
> 
> I am currently interested in simulating the initiation and spread of 
> forest fires in simulated landscapes consisting of 2 tree species (a 
> native and an invasive). I'm simulating fire seasons of fixed length; 
> fires can start at any time and in either tree species during this fire 
> season, and spread through the simulated forest according to a simple 
> percolation-like process. I have developed the algorithms for this in 
> Matlab, and don't anticipate any problems converting them to R if I need 
> to.
> 
> However, it's the next task that has me at a loss. At the end of each 
> fire season, there will be several burned patches on the simulated 
> landscape; the number of these patches won't necessarily correspond to 
> the total number of fires that season, because fires may coalesce. I 
> need to count how many of these burned patches there are, and find the 
> size of each. It seems that there should be an algorithm available to do 
> this, but I haven't found one, possibly because I haven't been using the 
> right search criteria. I used RSiteSearch("spatial cluster"), and got 
> many references to the spatclus package. However, from the spatclus 
> documentation it appears that this is not quite what I'm looking for. 
> Spatclus looks like it picks out potential clusters of occurrence of 
> some phenomenon (such as earthqukes or cancer); I need something that 
> will delineate clusters of contiguous pixels with the same value (i.e., 
> burned in my simulations). Could anyone point me towards such an 
> algorithm, or help me get started finding one?
> 
-- 
Dan Putler
Sauder School of Business
University of British Columbia


From b.rowlingson at lancaster.ac.uk  Tue Apr 14 18:44:35 2009
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Tue, 14 Apr 2009 17:44:35 +0100
Subject: [R-sig-Geo] Need an algorithm to identify spatial clusters
In-Reply-To: <49E4B951.40806@nmsu.edu>
References: <49E4B951.40806@nmsu.edu>
Message-ID: <d8ad40b50904140944pec3dc7kde2dc41395049e51@mail.gmail.com>

On Tue, Apr 14, 2009 at 5:26 PM, Mark Andersen <manderse at nmsu.edu> wrote:
> Hello, all,
>
> I am currently interested in simulating the initiation and spread of forest
> fires in simulated landscapes consisting of 2 tree species (a native and an
> invasive). I'm simulating fire seasons of fixed length; fires can start at
> any time and in either tree species during this fire season, and spread
> through the simulated forest according to a simple percolation-like process.
> I have developed the algorithms for this in Matlab, and don't anticipate any
> problems converting them to R if I need to.
>
> However, it's the next task that has me at a loss. At the end of each fire
> season, there will be several burned patches on the simulated landscape; the
> number of these patches won't necessarily correspond to the total number of
> fires that season, because fires may coalesce. I need to count how many of
> these burned patches there are, and find the size of each. It seems that
> there should be an algorithm available to do this, but I haven't found one,
> possibly because I haven't been using the right search criteria. I used
> RSiteSearch("spatial cluster"), and got many references to the spatclus
> package. However, from the spatclus documentation it appears that this is
> not quite what I'm looking for. Spatclus looks like it picks out potential
> clusters of occurrence of some phenomenon (such as earthqukes or cancer); I
> need something that will delineate clusters of contiguous pixels with the
> same value (i.e., burned in my simulations). Could anyone point me towards
> such an algorithm, or help me get started finding one?
>

 This kind of analysis of gridded data comes into the area of Image
Analysis. A quick search reveals EBImage, which is part of
Bioconductor, might be able to do what you want. It's possibly related
to image segmentation techniques, where you break an image up into
areas. The EBImage docs show an example of identifying cell nuclei in
a microscope slide image. Your task is a bit easier since you've
probably already got an easy way of identifying burnt cells, whereas
with the microscope image they have to carefully set a threshold
first...

Barry


From jmburgos at u.washington.edu  Tue Apr 14 18:56:15 2009
From: jmburgos at u.washington.edu (Julian Burgos)
Date: Tue, 14 Apr 2009 09:56:15 -0700 (PDT)
Subject: [R-sig-Geo] [R-sig-eco] Need an algorithm to identify spatial
	clusters
In-Reply-To: <49E4B951.40806@nmsu.edu>
Message-ID: <Pine.LNX.4.43.0904140956150.10687@hymn14.u.washington.edu>

Hi Mark,

What you are looking for is a connected component algorithm.  The algorithm
should receive a binary matrix (i.e. 0's and 1's for fire/no fire) and delineate
isolated groups of pixels following either a 4 or 8 neighbor rule.  Some time
ago I coded a function to do this (I couldn't find a package with this
functionality), and I would be happy to pass it along.  My function wasn't
extremely efficient but worked well enough to process thousand of matrices (each
100x100) in a relatively short time.  Let me know if you need it.

Julian Burgos, PhD
University of Washington



On Tue, 14 Apr 2009, Mark Andersen wrote:

> Hello, all,
>
> I am currently interested in simulating the initiation and spread of forest 
> fires in simulated landscapes consisting of 2 tree species (a native and an 
> invasive). I'm simulating fire seasons of fixed length; fires can start at any 
> time and in either tree species during this fire season, and spread through the 
> simulated forest according to a simple percolation-like process. I have 
> developed the algorithms for this in Matlab, and don't anticipate any problems 
> converting them to R if I need to.
>
> However, it's the next task that has me at a loss. At the end of each fire 
> season, there will be several burned patches on the simulated landscape; the 
> number of these patches won't necessarily correspond to the total number of 
> fires that season, because fires may coalesce. I need to count how many of 
> these burned patches there are, and find the size of each. It seems that there 
> should be an algorithm available to do this, but I haven't found one, possibly 
> because I haven't been using the right search criteria. I used 
> RSiteSearch("spatial cluster"), and got many references to the spatclus 
> package. However, from the spatclus documentation it appears that this is not 
> quite what I'm looking for. Spatclus looks like it picks out potential clusters 
> of occurrence of some phenomenon (such as earthqukes or cancer); I need 
> something that will delineate clusters of contiguous pixels with the same value 
> (i.e., burned in my simulations). Could anyone point me towards such an 
> algorithm, or help me get started finding one?
>
> -- 
> Dr. Mark C. Andersen, Professor
> Department of Fish, Wildlife, and Conservation Ecology
> New Mexico State University
> Las Cruces, NM 88003
> 575-646-8034
> fax: 575-646-1281
> web: web.nmsu.edu/~manderse
>
> _______________________________________________
> R-sig-ecology mailing list
> R-sig-ecology at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-ecology
>


From zev at zevross.com  Tue Apr 14 21:19:53 2009
From: zev at zevross.com (Zev Ross)
Date: Tue, 14 Apr 2009 19:19:53 +0000 (UTC)
Subject: [R-sig-Geo] HELP to cbind several data.frame with a LOOP
References: <3370.51079045541$1239289342@news.gmane.org>
Message-ID: <loom.20090414T191926-456@post.gmane.org>


Something like this might get you started. If you've got very big data, though,
looping wouldn't be the efficient way to go.

Tableanalysis_firenze_10<-data.frame(a=1:10, b=1:10)
Tableanalysis_firenze_20<-x
Tableanalysis_firenze_30<-x

mydata<-paste("Tableanalysis_firenze_", seq(10, 30, by=10), sep="")

alldata<-NULL
for(i in 1:length(mydata))
{
alldata<-rbind(alldata, eval(as.name(mydata[i])))
}


Zev


From J.vanEtten at cgiar.org  Wed Apr 15 01:53:39 2009
From: J.vanEtten at cgiar.org (van Etten, Jacob (IRRI))
Date: Wed, 15 Apr 2009 07:53:39 +0800
Subject: [R-sig-Geo] Need an algorithm to identify spatial clusters
In-Reply-To: <49E4B951.40806@nmsu.edu>
References: <49E4B951.40806@nmsu.edu>
Message-ID: <AFBF317E3DEC0B43BF750B4618EBFA0D015C8490@HERMES>

Mark,

The package igraph has a quick connected component algorithm,
implemented in C. 

You would first need to create a graph from your grid, connecting
adjacent cells. Raster (downloadable from R-Forge) has the function
'adjacency' that might be helpful in doing that (plus other
functionality that might be helpful with grids in general).

Good luck.

Jacob van Etten

-----Original Message-----
From: r-sig-geo-bounces at stat.math.ethz.ch
[mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of Mark Andersen
Sent: Wednesday, April 15, 2009 12:27 AM
To: r-sig-ecology at r-project.org; r-sig-geo at stat.math.ethz.ch
Subject: [R-sig-Geo] Need an algorithm to identify spatial clusters

Hello, all,

I am currently interested in simulating the initiation and spread of 
forest fires in simulated landscapes consisting of 2 tree species (a 
native and an invasive). I'm simulating fire seasons of fixed length; 
fires can start at any time and in either tree species during this fire 
season, and spread through the simulated forest according to a simple 
percolation-like process. I have developed the algorithms for this in 
Matlab, and don't anticipate any problems converting them to R if I need

to.

However, it's the next task that has me at a loss. At the end of each 
fire season, there will be several burned patches on the simulated 
landscape; the number of these patches won't necessarily correspond to 
the total number of fires that season, because fires may coalesce. I 
need to count how many of these burned patches there are, and find the 
size of each. It seems that there should be an algorithm available to do

this, but I haven't found one, possibly because I haven't been using the

right search criteria. I used RSiteSearch("spatial cluster"), and got 
many references to the spatclus package. However, from the spatclus 
documentation it appears that this is not quite what I'm looking for. 
Spatclus looks like it picks out potential clusters of occurrence of 
some phenomenon (such as earthqukes or cancer); I need something that 
will delineate clusters of contiguous pixels with the same value (i.e., 
burned in my simulations). Could anyone point me towards such an 
algorithm, or help me get started finding one?

-- 
Dr. Mark C. Andersen, Professor
Department of Fish, Wildlife, and Conservation Ecology
New Mexico State University
Las Cruces, NM 88003
575-646-8034
fax: 575-646-1281
web: web.nmsu.edu/~manderse

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Thierry.ONKELINX at inbo.be  Wed Apr 15 09:45:46 2009
From: Thierry.ONKELINX at inbo.be (ONKELINX, Thierry)
Date: Wed, 15 Apr 2009 09:45:46 +0200
Subject: [R-sig-Geo] Questions about spautolm
In-Reply-To: <AD51AB79BC327C40AB2C7EB75D57A3C40512F2@TOLAR.valuta.nhh.no>
References: <2E9C414912813E4EB981326983E0A1040656F59E@inboexch.inbo.be>
	<AD51AB79BC327C40AB2C7EB75D57A3C40512F2@TOLAR.valuta.nhh.no>
Message-ID: <2E9C414912813E4EB981326983E0A1040656F88C@inboexch.inbo.be>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090415/82455b60/attachment.pl>

From sven.mueller at tu-dresden.de  Wed Apr 15 11:12:50 2009
From: sven.mueller at tu-dresden.de (=?ISO-8859-15?Q?Sven_M=FCller?=)
Date: Wed, 15 Apr 2009 11:12:50 +0200
Subject: [R-sig-Geo] gwr.sel, missing values
Message-ID: <49E5A512.5000508@tu-dresden.de>

Hi all,

I have the following problem with finding an adaptive kernel in GWR. I 
use R2.8.1. In my dataset I have a few variables with missing values. 
Now, I try to find a bandwith for an adaptive kernel using 'gwr.sel' and 
it gives the following error message:
Warning in w.i * weights: Length of the longer object is not a multiple 
of the shorter object
If I run 'gwr.sel' using variables without missing values everything is 
working fine. Just for the variables with missing values this error 
message occurs.
What is my fault?
Every hint is gratefully acknowledged.

Cheers

Sven

-- 
Dr. rer. pol. Sven M?ller
MA Economic Geography

Dresden University of Technology
Institute for Transport and Economics
Chair of Business Administration, Transport and Logistics

Andreas Schubert Str. 23,  01062 Dresden

Room 510

Phone: +49 351 463 36797
Fax: +49 351 463 37758

sven.mueller at tu-dresden.de
http://www.vbl-dresden.de


From Roger.Bivand at nhh.no  Wed Apr 15 11:32:04 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 15 Apr 2009 11:32:04 +0200 (CEST)
Subject: [R-sig-Geo] gwr.sel, missing values
In-Reply-To: <49E5A512.5000508@tu-dresden.de>
References: <49E5A512.5000508@tu-dresden.de>
Message-ID: <alpine.LRH.2.00.0904151117390.10508@reclus.nhh.no>

On Wed, 15 Apr 2009, Sven M?ller wrote:

> Hi all,
>
> I have the following problem with finding an adaptive kernel in GWR. I use 
> R2.8.1. In my dataset I have a few variables with missing values. Now, I try 
> to find a bandwith for an adaptive kernel using 'gwr.sel' and it gives the 
> following error message:
> Warning in w.i * weights: Length of the longer object is not a multiple of 
> the shorter object
> If I run 'gwr.sel' using variables without missing values everything is 
> working fine. Just for the variables with missing values this error message 
> occurs.
> What is my fault?

Including missing values on the data points. Don't do it - you cannot fit 
the local regressions there, so they should be subsetted out first. Look 
at the output of lm() of the same model, with default na.action it will 
show that you have lost observations.

Roger

> Every hint is gratefully acknowledged.
>
> Cheers
>
> Sven
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From Bjarke.Christensen at sydbank.dk  Wed Apr 15 14:03:10 2009
From: Bjarke.Christensen at sydbank.dk (Bjarke Christensen)
Date: Wed, 15 Apr 2009 14:03:10 +0200
Subject: [R-sig-Geo] Need an algorithm to identify spatial clusters
In-Reply-To: <mailman.15.1239789604.8943.r-sig-geo@stat.math.ethz.ch>
Message-ID: <OFE440C11B.58CC4D01-ONC1257599.003D3E2A-C1257599.0042355D@bdpnet.dk>

Hi,

Mark Andersen:
>I need something that
>will delineate clusters of contiguous pixels with the same value (i.e.,
>burned in my simulations). Could anyone point me towards such an
>algorithm, or help me get started finding one?

It seems to me that you are basically looking for a cluster analysis
algorithm, so simply omitting 'spatial' from your search would hopefully
lead you towards the Cluster Analysis Task View
(http://cran.r-project.org/web/views/Cluster.html).

I've used agglomerative clustering (functions stats:hclust or
cluster:agnes) to accomplish a similar task before. Here is my suggestion,
assuming that your simulated forest is an equispaced grid of trees: Save
the coordinates of only those trees that have burned. Calculate the
distances between these points using dist. Run agglomerative clustering
using the minimum distance from a point to any point in a cluster as your
agglomeration method. Cut the tree at a minimum distance slightly larger
than your grid cell dimension. Voil?: you have one cluster per patch of
burned trees.

An example:

#Generate random data for an example:
set.seed(45)
pts <- expand.grid(1:10, 1:10)
names(pts) <- c("X", "Y")
pts$burned<- rbinom(nrow(pts), 1, .3)
coordinates(pts) <- c("X", "Y")
gridded(pts) <- T

#We now have a SpatialGridDataFrame, which I assume is similar to what your
data would look like.

image(pts, attr="burned", col=c("white", "gray"))

#Now calculate euclidean distances between those trees that are burned. If
that's not good enough, use lapply with sp:spDistsN1.

#Coordinates of burned trees:
coords <- coordinates(pts)[pts$burned==1,]
#Distances between them:
distances <- dist(coords)
#Agglomerative cluster analysis:
hc <- hclust(distances, method="single")
#Cluster burned trees by adjacency
patches.rook <- cutree(hc, h=1.1)
patches.queen <- cutree(hc, h=1.5)

#How many patches?
max(patches.rook)  #counts the big patch on the right as one
max(patches.queen) #counts the big patch on the right as five
#or
nlevels(factor(patches.rook))
nlevels(factor(patches.queen))

#How big is each (measured in number of trees/pixels)?
table(patches.rook)

Hope this helps,
Bjarke Christensen.

From p.hiemstra at geo.uu.nl  Wed Apr 15 18:13:30 2009
From: p.hiemstra at geo.uu.nl (Paul Hiemstra)
Date: Wed, 15 Apr 2009 18:13:30 +0200
Subject: [R-sig-Geo] locate a point
In-Reply-To: <5142739.12681239627465464.JavaMail.defaultUser@defaultHost>
References: <5142739.12681239627465464.JavaMail.defaultUser@defaultHost>
Message-ID: <49E607AA.2020000@geo.uu.nl>

Shelob1985 at libero.it schreef:
>> Hi everybody. I have a very elementary question but any help is appreciated.
>> I have a database which contains the indication of latitude and 
>> longitude of, say, South American mineral ores. I have to find out in which 
>>     
> country 
>   
>> of South America each mineral ore is located. There are certainly maps of 
>>     
> South America with the indication of states boundaries which can be 
> read and drawn by R. Is there any way I can use R to assign each data point 
> to the country in which it falls? 
> Thanks, 
> Sheila
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   
Hi,

Take a look at the overlay() command in the sp package. See also the 
rgdal package to read any boundary data into R.

cheers,
Paul

-- 
Drs. Paul Hiemstra
Department of Physical Geography
Faculty of Geosciences
University of Utrecht
Heidelberglaan 2
P.O. Box 80.115
3508 TC Utrecht
Phone:  +3130 274 3113 Mon-Tue
Phone:  +3130 253 5773 Wed-Fri
http://intamap.geo.uu.nl/~paul


From milton.ruser at gmail.com  Wed Apr 15 18:56:06 2009
From: milton.ruser at gmail.com (milton ruser)
Date: Wed, 15 Apr 2009 12:56:06 -0400
Subject: [R-sig-Geo] distance map from raster class
Message-ID: <3aaf1a030904150956j2a208a3dn2101200d3a1d74c7@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090415/326ca7df/attachment.pl>

From sdveloz at ucdavis.edu  Wed Apr 15 20:32:48 2009
From: sdveloz at ucdavis.edu (Sam Veloz)
Date: Wed, 15 Apr 2009 11:32:48 -0700
Subject: [R-sig-Geo] identifying clusters between sets of points
Message-ID: <49E62850.1060708@ucdavis.edu>

I have 3 sets of points (A,B,C) with coordinates. I would like to test 
whether points from group A are more spatially clustered around points 
in group B or are points from group A more spatially clustered around 
points in group C. Can anyone suggest a test(or r function) for doing this?
Thanks,
Sam
-- 
****************************************************
Sam Veloz
Postdoctoral Researcher
Department of Environmental Science and Policy
University of California, Davis
sdveloz at ucdavis.edu


From Nicholas.Nagle at Colorado.EDU  Wed Apr 15 20:54:55 2009
From: Nicholas.Nagle at Colorado.EDU (Nicholas N Nagle)
Date: Wed, 15 Apr 2009 12:54:55 -0600 (MDT)
Subject: [R-sig-Geo] Need an algorithm to identify spatial
Message-ID: <20090415125455.AIO96057@riddler.int.colorado.edu>

Perhaps I am misunderstanding this, but it sounds like what you want to do is not what is typically called 'spatial clustering.'

If your data were in vector format (i.e. a polygon for each fire), what you might do is first merge (or aggregate) contiguous polygons and then simply count the number of burned polygons and find the areas of the polygons. I don't know how to merge polygons in Matlab or R but this a straightforward GIS operation.

If your data are a raster, then most GIS packages have a tool for converting raster data to vector data, and contiguous cells are automatically merged in this process.  In ArcGIS, this conversion tool might be in the Spatial Analyst Toolbox, but it's been awhile since I last checked.

So it sounds like what you want is not a clustering algorithm, but can be solved with basic GIS processing.

Nicholas



Nicholas N. Nagle, Assistant Professor
University of Colorado
Department of Geography
UCB 260, Guggenheim 110
Boulder, CO 80309-0260
phone: 303-492-4794


From Nicholas.Nagle at Colorado.EDU  Wed Apr 15 21:15:37 2009
From: Nicholas.Nagle at Colorado.EDU (Nicholas N Nagle)
Date: Wed, 15 Apr 2009 13:15:37 -0600 (MDT)
Subject: [R-sig-Geo] [R-sig-geo] R/Grass Interface
Message-ID: <20090415131537.AIO97308@riddler.int.colorado.edu>

Roger,

This was exactly the solution!  I am now happily R'ing from within Grass from within QGIS.

Thanks!

Nicholas


Nicholas N. Nagle, Assistant Professor
University of Colorado
Department of Geography
UCB 260, Guggenheim 110
Boulder, CO 80309-0260
phone: 303-492-4794


From sdveloz at ucdavis.edu  Wed Apr 15 23:43:22 2009
From: sdveloz at ucdavis.edu (Sam Veloz)
Date: Wed, 15 Apr 2009 14:43:22 -0700
Subject: [R-sig-Geo] identifying clusters between sets of points
In-Reply-To: <49E64AEE.6030808@ub.edu>
References: <49E62850.1060708@ucdavis.edu> <49E64AEE.6030808@ub.edu>
Message-ID: <49E654FA.4020902@ucdavis.edu>

I had thought Ripley's K was only for univariate situations but I just 
found the k12hat function in the splancs package for bivariate 
situations. I will give that a try.
Thanks,
Sam


Jos? Manuel Blanco Moreno wrote:
> I'm not sure that I have correctly understood your problem, but it 
> sounds like the sort of problems that are usually solved through 
> Ripley's K (or some of its derivatives: Condit's Omega, Pair Correlation 
> Function, Circumcircle methods...)
> Good luck.
> Jos? M. Blanco
> 
> Sam Veloz escribi?:
>> I have 3 sets of points (A,B,C) with coordinates. I would like to test 
>> whether points from group A are more spatially clustered around points 
>> in group B or are points from group A more spatially clustered around 
>> points in group C. Can anyone suggest a test(or r function) for doing 
>> this?
>> Thanks,
>> Sam
> 
> 

-- 
****************************************************
Sam Veloz
Postdoctoral Researcher
Department of Environmental Science and Policy
University of California, Davis
sdveloz at ucdavis.edu


From kingsfordjones at gmail.com  Thu Apr 16 00:04:08 2009
From: kingsfordjones at gmail.com (Kingsford Jones)
Date: Wed, 15 Apr 2009 16:04:08 -0600
Subject: [R-sig-Geo] identifying clusters between sets of points
In-Reply-To: <49E62850.1060708@ucdavis.edu>
References: <49E62850.1060708@ucdavis.edu>
Message-ID: <2ad0cc110904151504h4155f8a0m154231ba606f69f9@mail.gmail.com>

Hi Sam.

The spatstat package provides a variety of tools for working with
multitype marked point patterns.  See Part IV of Adrian Baddeley's
spatstat workshop notes, which can be accessed here:

http://www.csiro.au/resources/Spatial-Point-Patterns-in-R.html


hth,
Kingsford Jones

On Wed, Apr 15, 2009 at 12:32 PM, Sam Veloz <sdveloz at ucdavis.edu> wrote:
> I have 3 sets of points (A,B,C) with coordinates. I would like to test
> whether points from group A are more spatially clustered around points in
> group B or are points from group A more spatially clustered around points in
> group C. Can anyone suggest a test(or r function) for doing this?
> Thanks,
> Sam
> --
> ****************************************************
> Sam Veloz
> Postdoctoral Researcher
> Department of Environmental Science and Policy
> University of California, Davis
> sdveloz at ucdavis.edu
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From tom.gottfried at wzw.tum.de  Thu Apr 16 12:32:35 2009
From: tom.gottfried at wzw.tum.de (Tom Gottfried)
Date: Thu, 16 Apr 2009 12:32:35 +0200
Subject: [R-sig-Geo] locate a point
In-Reply-To: <5142739.12681239627465464.JavaMail.defaultUser@defaultHost>
References: <5142739.12681239627465464.JavaMail.defaultUser@defaultHost>
Message-ID: <49E70943.5070600@wzw.tum.de>

Hi Sheila,

the maps package might be interesting for you too. Maybe you have to
check how precise/reliable the data provided by this package are.
If you get boundary data in shape-format, the maptools package can be
useful for importing too (besides rgdal which can handle many other
formats).

Tom


From adrian at maths.uwa.edu.au  Thu Apr 16 13:00:52 2009
From: adrian at maths.uwa.edu.au (Adrian Baddeley)
Date: Thu, 16 Apr 2009 19:00:52 +0800
Subject: [R-sig-Geo]  distance map from raster class
Message-ID: <49E70FE4.9070301@maths.uwa.edu.au>

Milton writes:

> I have binary images, and would like to generate a distance map from the ONEs.

> I tryed to use spatstat to solve this but may be it not work.

distmap has a method for 'owin' objects, but not for 'im' objects. 
The quick solution is to convert your image to an owin object using as.owin() and then apply distmap.

In your example, type
     my.distmap <- distmap(as.owin(my.image))

If you want the opposite, use complement.owin

regards
Adrian Baddeley


From adrian at maths.uwa.edu.au  Thu Apr 16 13:11:10 2009
From: adrian at maths.uwa.edu.au (Adrian Baddeley)
Date: Thu, 16 Apr 2009 19:11:10 +0800
Subject: [R-sig-Geo]  distance map from raster class
Message-ID: <49E7124E.4050503@maths.uwa.edu.au>

Sorry, I misspoke, ... in spatstat the correct way to convert a 0/1 
valued image to a window is to use 'solutionset'. Example:
         my.window <- solutionset(my.image == 1)
         my.distmap <- distmap(my.window)
The first line computes the region of 'ONEs' --- all pixels which have 
the pixel value 1 in my.image.

Adrian Baddeley


From gianni.lavaredo at gmail.com  Thu Apr 16 15:45:04 2009
From: gianni.lavaredo at gmail.com (gianni lavaredo)
Date: Thu, 16 Apr 2009 15:45:04 +0200
Subject: [R-sig-Geo] calculate major axe inside a polygon
Message-ID: <518dff330904160645v4ca8cfa0v19a0f7c871b44535@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090416/de0b6d16/attachment.pl>

From j.burke at earthlink.net  Fri Apr 17 00:29:25 2009
From: j.burke at earthlink.net (Jim Burke)
Date: Thu, 16 Apr 2009 17:29:25 -0500
Subject: [R-sig-Geo] Lattice PDF two polygon maps per page - help
Message-ID: <49E7B145.2@earthlink.net>

I would like to print two polygon maps per
PDF page. The following code prints each
map on two PDF pages. The maps are small
enough to print two on one page.

MY QUESTION. How can I get these two polygon
maps to print on ONE PAGE?

I have Deepayan Sarkar's "Lattice Multivariate
Data Visulaization with R" book and want to
do a polygon display like the graphs in Figure
1.2.

Using R 2.8.1 latest updates on Windows XP

CODE FRAGMENT FOLLOWS:

pdf(file = "myoutputfile.pdf", width=7, height=10)

library(lattice)                    
trellis.par.set(sp.theme())         

spplot(tx3_sp, c("D_PCT"),
    colorkey=list(height=1.0, width=0.6),
    main = list(label="My first title",cex=.5),
    line=0,
    sp.layout = list("sp.text",coordinates(tx3_sp),
    as.character(tx3_sp$PCT,cex=.02),
    as.table = TRUE)
 )
spplot(tx3_sp, c("D_TOT"),
    colorkey=list(height=1.0, width=0.6),
    main = list(label="My second title",cex=.5),
    line=0,
    sp.layout = list("sp.text",coordinates(tx3_sp),
    as.character(tx3_sp$PCT, cex=.02),
    as.table = TRUE),
    newpage = FALSE
 )
dev.off()

Thanks in advance for your suggestions!
Jim Burke


From j.burke at earthlink.net  Fri Apr 17 07:34:20 2009
From: j.burke at earthlink.net (Jim Burke)
Date: Fri, 17 Apr 2009 00:34:20 -0500
Subject: [R-sig-Geo] Lattice PDF two polygon maps per page - help
In-Reply-To: <49E7B145.2@earthlink.net>
References: <49E7B145.2@earthlink.net>
Message-ID: <49E814DC.7000007@earthlink.net>

Hi everyone, I fixed this myself. I am
posting the fix in case anyone else
has a similar issue.

I found my solution on pp 179-180 in Fig
10.11 in "Lattice Multivariate Data
Visulaization with R" by Deepayan Sarkar.

ACTIONS TAKEN.
1. output both spplot(s) to new frames.
1a.Each frame has a different scale.
2. plot those new frames giving them each
   half a page.
3. Make the titles larger (minor)

CORRECT CODE SNIPPET:

pdf(  file = "myoutputfile.pdf",
      paper= "letter",
      width=8,
      height=10,
      onefile = TRUE,
      bg="white",
      pagecentre=TRUE
   )

library(lattice)
trellis.par.set(sp.theme())

vote_percent <-
spplot(tx3_sp, c("D_PCT"),
    colorkey=list(height=1.0, width=0.6),
    main = list(label="My first title",cex=1),
    line=0,
    sp.layout = list("sp.text",coordinates(tx3_sp),
    as.character(tx3_sp$PCT,cex=.02),
    as.table = TRUE)
 )

total_votes <-
spplot(tx3_sp, c("D_TOT"),
    colorkey=list(height=1.0, width=0.6),
    main = list(label="My second title",cex=1),
    line=0,
    sp.layout = list("sp.text",coordinates(tx3_sp),
    as.character(tx3_sp$PCT, cex=.02),
    as.table = TRUE)
 )

plot(vote_percent, position=c(0, 0.50, 1, 1  ))
plot(total_votes,  position=c(0, 0,    1, .50), newpage = FALSE)
dev.off()

Good luck,
Jim Burke



Jim Burke wrote:
> I would like to print two polygon maps per
> PDF page. The following code prints each
> map on two PDF pages. The maps are small
> enough to print two on one page.
>
> MY QUESTION. How can I get these two polygon
> maps to print on ONE PAGE?
>
> I have Deepayan Sarkar's "Lattice Multivariate
> Data Visulaization with R" book and want to
> do a polygon display like the graphs in Figure
> 1.2.
>
> Using R 2.8.1 latest updates on Windows XP
>
> CODE FRAGMENT FOLLOWS:
>
> pdf(file = "myoutputfile.pdf", width=7, height=10)
>
> library(lattice)                    trellis.par.set(sp.theme())        
> spplot(tx3_sp, c("D_PCT"),
>    colorkey=list(height=1.0, width=0.6),
>    main = list(label="My first title",cex=.5),
>    line=0,
>    sp.layout = list("sp.text",coordinates(tx3_sp),
>    as.character(tx3_sp$PCT,cex=.02),
>    as.table = TRUE)
> )
> spplot(tx3_sp, c("D_TOT"),
>    colorkey=list(height=1.0, width=0.6),
>    main = list(label="My second title",cex=.5),
>    line=0,
>    sp.layout = list("sp.text",coordinates(tx3_sp),
>    as.character(tx3_sp$PCT, cex=.02),
>    as.table = TRUE),
>    newpage = FALSE
> )
> dev.off()
>
> Thanks in advance for your suggestions!
> Jim Burke
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


From edzer.pebesma at uni-muenster.de  Fri Apr 17 09:45:38 2009
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 17 Apr 2009 09:45:38 +0200
Subject: [R-sig-Geo] Lattice PDF two polygon maps per page - help
In-Reply-To: <49E7B145.2@earthlink.net>
References: <49E7B145.2@earthlink.net>
Message-ID: <49E833A2.60207@uni-muenster.de>

I think you need to save the trellis objects returned by spplot:

plt1 = spplot(map1, ...)
plt2 = spplot(map2, ...)

and then plot them in a single device:

print(plt1, ..., more = TRUE)
print(plt2, ..., more = FALSE)

where you replace the ... with the relevant argument for position OR
split, read ?print.trellis for the details.
--
Edzer

Jim Burke wrote:
> I would like to print two polygon maps per
> PDF page. The following code prints each
> map on two PDF pages. The maps are small
> enough to print two on one page.
>
> MY QUESTION. How can I get these two polygon
> maps to print on ONE PAGE?
>
> I have Deepayan Sarkar's "Lattice Multivariate
> Data Visulaization with R" book and want to
> do a polygon display like the graphs in Figure
> 1.2.
>
> Using R 2.8.1 latest updates on Windows XP
>
> CODE FRAGMENT FOLLOWS:
>
> pdf(file = "myoutputfile.pdf", width=7, height=10)
>
> library(lattice)                    trellis.par.set(sp.theme())        
> spplot(tx3_sp, c("D_PCT"),
>    colorkey=list(height=1.0, width=0.6),
>    main = list(label="My first title",cex=.5),
>    line=0,
>    sp.layout = list("sp.text",coordinates(tx3_sp),
>    as.character(tx3_sp$PCT,cex=.02),
>    as.table = TRUE)
> )
> spplot(tx3_sp, c("D_TOT"),
>    colorkey=list(height=1.0, width=0.6),
>    main = list(label="My second title",cex=.5),
>    line=0,
>    sp.layout = list("sp.text",coordinates(tx3_sp),
>    as.character(tx3_sp$PCT, cex=.02),
>    as.table = TRUE),
>    newpage = FALSE
> )
> dev.off()
>
> Thanks in advance for your suggestions!
> Jim Burke
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de/
http://www.springer.com/978-0-387-78170-9 e.pebesma at wwu.de


From corey.sparks at UTSA.EDU  Fri Apr 17 16:57:23 2009
From: corey.sparks at UTSA.EDU (Corey Sparks)
Date: Fri, 17 Apr 2009 09:57:23 -0500
Subject: [R-sig-Geo] image classification in R
Message-ID: <EBFB8501-2847-4E75-A1A1-C0559584BEA5@utsa.edu>

Dear list,
I want to do some unsupervised image classification of some landsat  
imagery, I think I can read in the multi-band rasters using rgdal, but  
has anyone tried doing this in R?  I am thinking (after looking at  
documentation for how GRASS and ArcGIS do it) that I need to do an  
initial hierarchical clustering to define clusters, but does anyone  
have an idea on how to do a maximum likelihood classification of the  
imagery?  Would a discriminant function approach work?  Any advice  
anyone may have would be greatly appreciated, and i'm very sorry but I  
don't have a working example yet.
Best

Corey

Corey Sparks
Assistant Professor
Department of Demography and Organization Studies
University of Texas at San Antonio
One UTSA Circle
San Antonio, TX 78249
210 458 6858
corey.sparks 'at' utsa.edu


From edzer.pebesma at uni-muenster.de  Fri Apr 17 17:32:05 2009
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 17 Apr 2009 17:32:05 +0200
Subject: [R-sig-Geo] image classification in R
In-Reply-To: <EBFB8501-2847-4E75-A1A1-C0559584BEA5@utsa.edu>
References: <EBFB8501-2847-4E75-A1A1-C0559584BEA5@utsa.edu>
Message-ID: <49E8A0F5.1000609@uni-muenster.de>

Corey,

you can use functions lda or qda (in library MASS) for linear or
quadratic discriminant analysis, respectively, on your training/ground
truth data, and then use the predict method on the resulting objects,
passing the bands (you need to convert the SpatialGridDataFrame to a
data.frame) as newdata to obtain the classified pixels. Make sure that
the band names have identical name in both cases. Then assign the
predicted class to the SpatialGridDataFrame and export.

It has never been clear to me whether "maximum likelihood
classification" in RS refers to lda or qda. Anyway, it's called
discriminant analysis in the statistical literature.
--
Edzer


Corey Sparks wrote:
> Dear list,
> I want to do some unsupervised image classification of some landsat
> imagery, I think I can read in the multi-band rasters using rgdal, but
> has anyone tried doing this in R?  I am thinking (after looking at
> documentation for how GRASS and ArcGIS do it) that I need to do an
> initial hierarchical clustering to define clusters, but does anyone
> have an idea on how to do a maximum likelihood classification of the
> imagery?  Would a discriminant function approach work?  Any advice
> anyone may have would be greatly appreciated, and i'm very sorry but I
> don't have a working example yet.
> Best
>
> Corey
>
> Corey Sparks
> Assistant Professor
> Department of Demography and Organization Studies
> University of Texas at San Antonio
> One UTSA Circle
> San Antonio, TX 78249
> 210 458 6858
> corey.sparks 'at' utsa.edu
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de/
http://www.springer.com/978-0-387-78170-9 e.pebesma at wwu.de


From T.Hengl at uva.nl  Fri Apr 17 19:49:43 2009
From: T.Hengl at uva.nl (Hengl, T.)
Date: Fri, 17 Apr 2009 19:49:43 +0200
Subject: [R-sig-Geo] image classification in R
References: <EBFB8501-2847-4E75-A1A1-C0559584BEA5@utsa.edu>
	<49E8A0F5.1000609@uni-muenster.de>
Message-ID: <37382E8DCB905042969BA78541F65706754292@kwek.ic.uva.nl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090417/d4a9bba8/attachment.pl>

From edzer.pebesma at uni-muenster.de  Fri Apr 17 23:12:18 2009
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 17 Apr 2009 23:12:18 +0200
Subject: [R-sig-Geo] image classification in R
In-Reply-To: <37382E8DCB905042969BA78541F65706754292@kwek.ic.uva.nl>
References: <EBFB8501-2847-4E75-A1A1-C0559584BEA5@utsa.edu>	<49E8A0F5.1000609@uni-muenster.de>
	<37382E8DCB905042969BA78541F65706754292@kwek.ic.uva.nl>
Message-ID: <49E8F0B2.9030400@uni-muenster.de>

There's a Task View on clustering, linked from CRAN:

http://cran.r-project.org/web/views/Cluster.html

that will lead you to all types of clustering available, including
hierarchical. I  don't know how well it will work for large data sets
such as images, as it calls for constructing n x n distance matrices,
with n the number of pixels.
--
Edzer

Hengl, T. wrote:
> Don't forget that you can also use different types of unsupervised classification methods, such as the fuzzy k-means as implemented in the "kmeans" method.
>
> Here is an example (with landform classes):
> http://spatial-analyst.net/wiki/index.php?title=Analysis_of_DEMs_in_R%2BILWIS/SAGA
>
> If you work with large grids, consider also using R+SAGA:
> https://stat.ethz.ch/pipermail/r-sig-geo/2009-February/005155.html
>
>
> T. Hengl
>
>
>
> -----Original Message-----
> From: r-sig-geo-bounces at stat.math.ethz.ch on behalf of Edzer Pebesma
> Sent: Fri 4/17/2009 5:32 PM
> To: Corey Sparks
> Cc: r-sig-geo at stat.math.ethz.ch
> Subject: Re: [R-sig-Geo] image classification in R
>  
> Corey,
>
> you can use functions lda or qda (in library MASS) for linear or
> quadratic discriminant analysis, respectively, on your training/ground
> truth data, and then use the predict method on the resulting objects,
> passing the bands (you need to convert the SpatialGridDataFrame to a
> data.frame) as newdata to obtain the classified pixels. Make sure that
> the band names have identical name in both cases. Then assign the
> predicted class to the SpatialGridDataFrame and export.
>
> It has never been clear to me whether "maximum likelihood
> classification" in RS refers to lda or qda. Anyway, it's called
> discriminant analysis in the statistical literature.
> --
> Edzer
>
>
> Corey Sparks wrote:
>   
>> Dear list,
>> I want to do some unsupervised image classification of some landsat
>> imagery, I think I can read in the multi-band rasters using rgdal, but
>> has anyone tried doing this in R?  I am thinking (after looking at
>> documentation for how GRASS and ArcGIS do it) that I need to do an
>> initial hierarchical clustering to define clusters, but does anyone
>> have an idea on how to do a maximum likelihood classification of the
>> imagery?  Would a discriminant function approach work?  Any advice
>> anyone may have would be greatly appreciated, and i'm very sorry but I
>> don't have a working example yet.
>> Best
>>
>> Corey
>>
>> Corey Sparks
>> Assistant Professor
>> Department of Demography and Organization Studies
>> University of Texas at San Antonio
>> One UTSA Circle
>> San Antonio, TX 78249
>> 210 458 6858
>> corey.sparks 'at' utsa.edu
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>     
>
>   
> ------------------------------------------------------------------------
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de/
http://www.springer.com/978-0-387-78170-9 e.pebesma at wwu.de


From apineda at dataquick.com  Fri Apr 17 23:21:11 2009
From: apineda at dataquick.com (Adalberto Pineda)
Date: Fri, 17 Apr 2009 14:21:11 -0700
Subject: [R-sig-Geo] Converting Tessellation objects into shape files
Message-ID: <D53712A05C0B5F44A2F605AF7EB76EFB0117815C@sd1ex1.mscorp.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090417/371ca542/attachment.pl>

From marcel.austenfeld at uni-bielefeld.de  Sat Apr 18 08:56:42 2009
From: marcel.austenfeld at uni-bielefeld.de (Marcel Austenfeld)
Date: Sat, 18 Apr 2009 08:56:42 +0200
Subject: [R-sig-Geo] image classification in R
Message-ID: <20504_1240037805_ZZg0s6z5TPFmX.00_49E979AA.70805@uni-bielefeld.de>

Hello,

I've implemented in my application a GUI for the "clara" algorithm from 
the "cluster" package to cluster image layers
(The layers and clustering results are visualized in ImageJ).
This works quite well for RGB images up to 5000*5000 pixel on a 32-bit 
Windows system.
The standard k-means algorithm works also well but for smaller images.

Cluster Analysis: Max 5000*5000*3(RGB) -> 6 centers: 70sec., 12 centers: 
100s (byte transfer!)

Hardware: AMD Turion 2.0 GHz Dual core, 3Gb RAM Windows Vista 32-bit.

Here is an Example:
http://www.uni-bielefeld.de/biologie/Oekosystembiologie/bio7app/flashtut/cluster.htm


With kind regards

M. Austenfeld


From alobolistas at gmail.com  Sat Apr 18 13:54:04 2009
From: alobolistas at gmail.com (Agustin Lobo)
Date: Sat, 18 Apr 2009 13:54:04 +0200
Subject: [R-sig-Geo] image classification in R
In-Reply-To: <49E8F0B2.9030400@uni-muenster.de>
References: <EBFB8501-2847-4E75-A1A1-C0559584BEA5@utsa.edu>	<49E8A0F5.1000609@uni-muenster.de>	<37382E8DCB905042969BA78541F65706754292@kwek.ic.uva.nl>
	<49E8F0B2.9030400@uni-muenster.de>
Message-ID: <49E9BF5C.4040102@gmail.com>

In my opinion, and considering that imagery uses to be  very large
datasets, unless you want to include spatial characteristics, the best
is to subsample your imagery with your gis, then import the
dataset to R, perform classification with the many tools
available, save the centroids (means, sds, covar matrices depending
on your method) and then allocate pixels to those centroids in your
gis.

Images are too large for R

Agus

Edzer Pebesma wrote:
> There's a Task View on clustering, linked from CRAN:
>
> http://cran.r-project.org/web/views/Cluster.html
>
> that will lead you to all types of clustering available, including
> hierarchical. I  don't know how well it will work for large data sets
> such as images, as it calls for constructing n x n distance matrices,
> with n the number of pixels.
> --
> Edzer
>
> Hengl, T. wrote:
>   
>> Don't forget that you can also use different types of unsupervised classification methods, such as the fuzzy k-means as implemented in the "kmeans" method.
>>
>> Here is an example (with landform classes):
>> http://spatial-analyst.net/wiki/index.php?title=Analysis_of_DEMs_in_R%2BILWIS/SAGA
>>
>> If you work with large grids, consider also using R+SAGA:
>> https://stat.ethz.ch/pipermail/r-sig-geo/2009-February/005155.html
>>
>>
>> T. Hengl
>>
>>
>>
>> -----Original Message-----
>> From: r-sig-geo-bounces at stat.math.ethz.ch on behalf of Edzer Pebesma
>> Sent: Fri 4/17/2009 5:32 PM
>> To: Corey Sparks
>> Cc: r-sig-geo at stat.math.ethz.ch
>> Subject: Re: [R-sig-Geo] image classification in R
>>  
>> Corey,
>>
>> you can use functions lda or qda (in library MASS) for linear or
>> quadratic discriminant analysis, respectively, on your training/ground
>> truth data, and then use the predict method on the resulting objects,
>> passing the bands (you need to convert the SpatialGridDataFrame to a
>> data.frame) as newdata to obtain the classified pixels. Make sure that
>> the band names have identical name in both cases. Then assign the
>> predicted class to the SpatialGridDataFrame and export.
>>
>> It has never been clear to me whether "maximum likelihood
>> classification" in RS refers to lda or qda. Anyway, it's called
>> discriminant analysis in the statistical literature.
>> --
>> Edzer
>>
>>
>> Corey Sparks wrote:
>>   
>>     
>>> Dear list,
>>> I want to do some unsupervised image classification of some landsat
>>> imagery, I think I can read in the multi-band rasters using rgdal, but
>>> has anyone tried doing this in R?  I am thinking (after looking at
>>> documentation for how GRASS and ArcGIS do it) that I need to do an
>>> initial hierarchical clustering to define clusters, but does anyone
>>> have an idea on how to do a maximum likelihood classification of the
>>> imagery?  Would a discriminant function approach work?  Any advice
>>> anyone may have would be greatly appreciated, and i'm very sorry but I
>>> don't have a working example yet.
>>> Best
>>>
>>> Corey
>>>
>>> Corey Sparks
>>> Assistant Professor
>>> Department of Demography and Organization Studies
>>> University of Texas at San Antonio
>>> One UTSA Circle
>>> San Antonio, TX 78249
>>> 210 458 6858
>>> corey.sparks 'at' utsa.edu
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>     
>>>       
>>   
>> ------------------------------------------------------------------------
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>   
>>     
>
>   

-------------- next part --------------
A non-text attachment was scrubbed...
Name: alobolistas.vcf
Type: text/x-vcard
Size: 251 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090418/0dcd7d60/attachment.vcf>

From evion12000 at gmail.com  Sat Apr 18 14:21:30 2009
From: evion12000 at gmail.com (evion12000 at gmail.com)
Date: Sat, 18 Apr 2009 12:21:30 +0000
Subject: [R-sig-Geo] R-sig-Geo Digest, Vol 68, Issue 18
In-Reply-To: <mailman.15.1240048804.4647.r-sig-geo@stat.math.ethz.ch>
References: <mailman.15.1240048804.4647.r-sig-geo@stat.math.ethz.ch>
Message-ID: <1745356106-1240057312-cardhu_decombobulator_blackberry.rim.net-1768214191-@bxe1121.bisx.prod.on.blackberry>


Este mensaje ha sido enviado gracias al servicio BlackBerry de Movilnet

-----Original Message-----
From: r-sig-geo-request at stat.math.ethz.ch

Date: Sat, 18 Apr 2009 12:00:04 
To: <r-sig-geo at stat.math.ethz.ch>
Subject: R-sig-Geo Digest, Vol 68, Issue 18


Send R-sig-Geo mailing list submissions to
	r-sig-geo at stat.math.ethz.ch

To subscribe or unsubscribe via the World Wide Web, visit
	https://stat.ethz.ch/mailman/listinfo/r-sig-geo
or, via email, send a message with subject or body 'help' to
	r-sig-geo-request at stat.math.ethz.ch

You can reach the person managing the list at
	r-sig-geo-owner at stat.math.ethz.ch

When replying, please edit your Subject line so it is more specific
than "Re: Contents of R-sig-Geo digest..."


Today's Topics:

   1. image classification in R (Corey Sparks)
   2. Re: image classification in R (Edzer Pebesma)
   3. Re: image classification in R (Hengl, T.)
   4. Re: image classification in R (Edzer Pebesma)
   5. Converting Tessellation objects into shape files
      (Adalberto Pineda)
   6. Re: image classification in R (Marcel Austenfeld)


----------------------------------------------------------------------

Message: 1
Date: Fri, 17 Apr 2009 09:57:23 -0500
From: Corey Sparks <corey.sparks at UTSA.EDU>
Subject: [R-sig-Geo] image classification in R
To: r-sig-geo at stat.math.ethz.ch
Message-ID: <EBFB8501-2847-4E75-A1A1-C0559584BEA5 at utsa.edu>
Content-Type: text/plain; charset="US-ASCII"; format=flowed; delsp=yes

Dear list,
I want to do some unsupervised image classification of some landsat  
imagery, I think I can read in the multi-band rasters using rgdal, but  
has anyone tried doing this in R?  I am thinking (after looking at  
documentation for how GRASS and ArcGIS do it) that I need to do an  
initial hierarchical clustering to define clusters, but does anyone  
have an idea on how to do a maximum likelihood classification of the  
imagery?  Would a discriminant function approach work?  Any advice  
anyone may have would be greatly appreciated, and i'm very sorry but I  
don't have a working example yet.
Best

Corey

Corey Sparks
Assistant Professor
Department of Demography and Organization Studies
University of Texas at San Antonio
One UTSA Circle
San Antonio, TX 78249
210 458 6858
corey.sparks 'at' utsa.edu



------------------------------

Message: 2
Date: Fri, 17 Apr 2009 17:32:05 +0200
From: Edzer Pebesma <edzer.pebesma at uni-muenster.de>
Subject: Re: [R-sig-Geo] image classification in R
To: Corey Sparks <corey.sparks at UTSA.EDU>
Cc: r-sig-geo at stat.math.ethz.ch
Message-ID: <49E8A0F5.1000609 at uni-muenster.de>
Content-Type: text/plain; charset=ISO-8859-1

Corey,

you can use functions lda or qda (in library MASS) for linear or
quadratic discriminant analysis, respectively, on your training/ground
truth data, and then use the predict method on the resulting objects,
passing the bands (you need to convert the SpatialGridDataFrame to a
data.frame) as newdata to obtain the classified pixels. Make sure that
the band names have identical name in both cases. Then assign the
predicted class to the SpatialGridDataFrame and export.

It has never been clear to me whether "maximum likelihood
classification" in RS refers to lda or qda. Anyway, it's called
discriminant analysis in the statistical literature.
--
Edzer


Corey Sparks wrote:
> Dear list,
> I want to do some unsupervised image classification of some landsat
> imagery, I think I can read in the multi-band rasters using rgdal, but
> has anyone tried doing this in R?  I am thinking (after looking at
> documentation for how GRASS and ArcGIS do it) that I need to do an
> initial hierarchical clustering to define clusters, but does anyone
> have an idea on how to do a maximum likelihood classification of the
> imagery?  Would a discriminant function approach work?  Any advice
> anyone may have would be greatly appreciated, and i'm very sorry but I
> don't have a working example yet.
> Best
>
> Corey
>
> Corey Sparks
> Assistant Professor
> Department of Demography and Organization Studies
> University of Texas at San Antonio
> One UTSA Circle
> San Antonio, TX 78249
> 210 458 6858
> corey.sparks 'at' utsa.edu
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de/
http://www.springer.com/978-0-387-78170-9 e.pebesma at wwu.de



------------------------------

Message: 3
Date: Fri, 17 Apr 2009 19:49:43 +0200
From: "Hengl, T." <T.Hengl at uva.nl>
Subject: Re: [R-sig-Geo] image classification in R
To: "Corey Sparks" <corey.sparks at UTSA.EDU>
Cc: r-sig-geo at stat.math.ethz.ch
Message-ID: <37382E8DCB905042969BA78541F65706754292 at kwek.ic.uva.nl>
Content-Type: text/plain


Don't forget that you can also use different types of unsupervised classification methods, such as the fuzzy k-means as implemented in the "kmeans" method.

Here is an example (with landform classes):
http://spatial-analyst.net/wiki/index.php?title=Analysis_of_DEMs_in_R%2BILWIS/SAGA

If you work with large grids, consider also using R+SAGA:
https://stat.ethz.ch/pipermail/r-sig-geo/2009-February/005155.html


T. Hengl



-----Original Message-----
From: r-sig-geo-bounces at stat.math.ethz.ch on behalf of Edzer Pebesma
Sent: Fri 4/17/2009 5:32 PM
To: Corey Sparks
Cc: r-sig-geo at stat.math.ethz.ch
Subject: Re: [R-sig-Geo] image classification in R
 
Corey,

you can use functions lda or qda (in library MASS) for linear or
quadratic discriminant analysis, respectively, on your training/ground
truth data, and then use the predict method on the resulting objects,
passing the bands (you need to convert the SpatialGridDataFrame to a
data.frame) as newdata to obtain the classified pixels. Make sure that
the band names have identical name in both cases. Then assign the
predicted class to the SpatialGridDataFrame and export.

It has never been clear to me whether "maximum likelihood
classification" in RS refers to lda or qda. Anyway, it's called
discriminant analysis in the statistical literature.
--
Edzer


Corey Sparks wrote:
> Dear list,
> I want to do some unsupervised image classification of some landsat
> imagery, I think I can read in the multi-band rasters using rgdal, but
> has anyone tried doing this in R?  I am thinking (after looking at
> documentation for how GRASS and ArcGIS do it) that I need to do an
> initial hierarchical clustering to define clusters, but does anyone
> have an idea on how to do a maximum likelihood classification of the
> imagery?  Would a discriminant function approach work?  Any advice
> anyone may have would be greatly appreciated, and i'm very sorry but I
> don't have a working example yet.
> Best
>
> Corey
>
> Corey Sparks
> Assistant Professor
> Department of Demography and Organization Studies
> University of Texas at San Antonio
> One UTSA Circle
> San Antonio, TX 78249
> 210 458 6858
> corey.sparks 'at' utsa.edu
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de/
http://www.springer.com/978-0-387-78170-9 e.pebesma at wwu.de

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch
https://stat.ethz.ch/mailman/listinfo/r-sig-geo



	[[alternative HTML version deleted]]



------------------------------

Message: 4
Date: Fri, 17 Apr 2009 23:12:18 +0200
From: Edzer Pebesma <edzer.pebesma at uni-muenster.de>
Subject: Re: [R-sig-Geo] image classification in R
To: "Hengl, T." <T.Hengl at uva.nl>
Cc: r-sig-geo at stat.math.ethz.ch, Corey Sparks <corey.sparks at UTSA.EDU>
Message-ID: <49E8F0B2.9030400 at uni-muenster.de>
Content-Type: text/plain; charset=ISO-8859-1

There's a Task View on clustering, linked from CRAN:

http://cran.r-project.org/web/views/Cluster.html

that will lead you to all types of clustering available, including
hierarchical. I  don't know how well it will work for large data sets
such as images, as it calls for constructing n x n distance matrices,
with n the number of pixels.
--
Edzer

Hengl, T. wrote:
> Don't forget that you can also use different types of unsupervised classification methods, such as the fuzzy k-means as implemented in the "kmeans" method.
>
> Here is an example (with landform classes):
> http://spatial-analyst.net/wiki/index.php?title=Analysis_of_DEMs_in_R%2BILWIS/SAGA
>
> If you work with large grids, consider also using R+SAGA:
> https://stat.ethz.ch/pipermail/r-sig-geo/2009-February/005155.html
>
>
> T. Hengl
>
>
>
> -----Original Message-----
> From: r-sig-geo-bounces at stat.math.ethz.ch on behalf of Edzer Pebesma
> Sent: Fri 4/17/2009 5:32 PM
> To: Corey Sparks
> Cc: r-sig-geo at stat.math.ethz.ch
> Subject: Re: [R-sig-Geo] image classification in R
>  
> Corey,
>
> you can use functions lda or qda (in library MASS) for linear or
> quadratic discriminant analysis, respectively, on your training/ground
> truth data, and then use the predict method on the resulting objects,
> passing the bands (you need to convert the SpatialGridDataFrame to a
> data.frame) as newdata to obtain the classified pixels. Make sure that
> the band names have identical name in both cases. Then assign the
> predicted class to the SpatialGridDataFrame and export.
>
> It has never been clear to me whether "maximum likelihood
> classification" in RS refers to lda or qda. Anyway, it's called
> discriminant analysis in the statistical literature.
> --
> Edzer
>
>
> Corey Sparks wrote:
>   
>> Dear list,
>> I want to do some unsupervised image classification of some landsat
>> imagery, I think I can read in the multi-band rasters using rgdal, but
>> has anyone tried doing this in R?  I am thinking (after looking at
>> documentation for how GRASS and ArcGIS do it) that I need to do an
>> initial hierarchical clustering to define clusters, but does anyone
>> have an idea on how to do a maximum likelihood classification of the
>> imagery?  Would a discriminant function approach work?  Any advice
>> anyone may have would be greatly appreciated, and i'm very sorry but I
>> don't have a working example yet.
>> Best
>>
>> Corey
>>
>> Corey Sparks
>> Assistant Professor
>> Department of Demography and Organization Studies
>> University of Texas at San Antonio
>> One UTSA Circle
>> San Antonio, TX 78249
>> 210 458 6858
>> corey.sparks 'at' utsa.edu
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>     
>
>   
> ------------------------------------------------------------------------
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de/
http://www.springer.com/978-0-387-78170-9 e.pebesma at wwu.de



------------------------------

Message: 5
Date: Fri, 17 Apr 2009 14:21:11 -0700
From: "Adalberto Pineda" <apineda at dataquick.com>
Subject: [R-sig-Geo] Converting Tessellation objects into shape files
To: <r-sig-geo at stat.math.ethz.ch>
Message-ID:
	<D53712A05C0B5F44A2F605AF7EB76EFB0117815C at sd1ex1.mscorp.com>
Content-Type: text/plain

Hello, 
I was trying to convert an object of class tess generated using the spatstat package into a shape file, just as shown in this posting: 
 https://stat.ethz.ch/pipermail/r-sig-geo/2009-January/004854.html
Then I tried coercing my object into a owin object as follows:   

owin.points<-as.owin(tess.points),  where tess.points comes from:
centroid.points<-ppp(results$cluster_X, results$cluster_Y, c(-4,4), c(-4,4))  
tess.points<-dirichlet(centroid.points)

but the owin object (owin.points) would only return the tesselation's window and lose other points.
Has anybody found a way to do the conversion?
Any suggestions are welcome, 


Adalberto Pineda
Data Analytics Specialist
MDA Dataquick
9620 Towne Centre Dr.
San Diego, CA.  92121.




This message contains confidential information and is in...{{dropped:8}}



------------------------------

Message: 6
Date: Sat, 18 Apr 2009 08:56:42 +0200
From: Marcel Austenfeld <marcel.austenfeld at uni-bielefeld.de>
Subject: Re: [R-sig-Geo] image classification in R
To: r-sig-geo at stat.math.ethz.ch
Message-ID:
	<20504_1240037805_ZZg0s6z5TPFmX.00_49E979AA.70805 at uni-bielefeld.de>
Content-Type: text/plain; charset=ISO-8859-15; format=flowed

Hello,

I've implemented in my application a GUI for the "clara" algorithm from 
the "cluster" package to cluster image layers
(The layers and clustering results are visualized in ImageJ).
This works quite well for RGB images up to 5000*5000 pixel on a 32-bit 
Windows system.
The standard k-means algorithm works also well but for smaller images.

Cluster Analysis: Max 5000*5000*3(RGB) -> 6 centers: 70sec., 12 centers: 
100s (byte transfer!)

Hardware: AMD Turion 2.0 GHz Dual core, 3Gb RAM Windows Vista 32-bit.

Here is an Example:
http://www.uni-bielefeld.de/biologie/Oekosystembiologie/bio7app/flashtut/cluster.htm


With kind regards

M. Austenfeld



------------------------------

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


End of R-sig-Geo Digest, Vol 68, Issue 18
*****************************************

From corey.sparks at UTSA.EDU  Sat Apr 18 18:34:26 2009
From: corey.sparks at UTSA.EDU (Corey Sparks)
Date: Sat, 18 Apr 2009 11:34:26 -0500
Subject: [R-sig-Geo] image classification in R
In-Reply-To: <49E9BF5C.4040102@gmail.com>
References: <EBFB8501-2847-4E75-A1A1-C0559584BEA5@utsa.edu>	<49E8A0F5.1000609@uni-muenster.de>	<37382E8DCB905042969BA78541F65706754292@kwek.ic.uva.nl>
	<49E8F0B2.9030400@uni-muenster.de> <49E9BF5C.4040102@gmail.com>
Message-ID: <89DFD074-2413-4274-86B9-C1014B04AD5F@UTSA.EDU>

Yes, I've already run into this problem trying to run hclust on a  
landsat image.  I'm on an imac with leopard and 4gb of ram and the  
distance matrix needed wouldn't fit into memory.  I will try the sub- 
sampling technique.  Thank you all for you assistance.
Corey
Corey Sparks
Assistant Professor
Department of Demography and Organization Studies
College of Public Policy
One UTSA Circle
San Antonio, TX 78239
corey.sparks 'at' utsa.edu




On Apr 18, 2009, at 6:54 AM, Agustin Lobo wrote:

> In my opinion, and considering that imagery uses to be  very large
> datasets, unless you want to include spatial characteristics, the best
> is to subsample your imagery with your gis, then import the
> dataset to R, perform classification with the many tools
> available, save the centroids (means, sds, covar matrices depending
> on your method) and then allocate pixels to those centroids in your
> gis.
>
> Images are too large for R
>
> Agus
>
> Edzer Pebesma wrote:
>> There's a Task View on clustering, linked from CRAN:
>>
>> http://cran.r-project.org/web/views/Cluster.html
>>
>> that will lead you to all types of clustering available, including
>> hierarchical. I  don't know how well it will work for large data sets
>> such as images, as it calls for constructing n x n distance matrices,
>> with n the number of pixels.
>> --
>> Edzer
>>
>> Hengl, T. wrote:
>>
>>> Don't forget that you can also use different types of  
>>> unsupervised classification methods, such as the fuzzy k-means as  
>>> implemented in the "kmeans" method.
>>>
>>> Here is an example (with landform classes):
>>> http://spatial-analyst.net/wiki/index.php? 
>>> title=Analysis_of_DEMs_in_R%2BILWIS/SAGA
>>>
>>> If you work with large grids, consider also using R+SAGA:
>>> https://stat.ethz.ch/pipermail/r-sig-geo/2009-February/005155.html
>>>
>>>
>>> T. Hengl
>>>
>>>
>>>
>>> -----Original Message-----
>>> From: r-sig-geo-bounces at stat.math.ethz.ch on behalf of Edzer Pebesma
>>> Sent: Fri 4/17/2009 5:32 PM
>>> To: Corey Sparks
>>> Cc: r-sig-geo at stat.math.ethz.ch
>>> Subject: Re: [R-sig-Geo] image classification in R
>>>  Corey,
>>>
>>> you can use functions lda or qda (in library MASS) for linear or
>>> quadratic discriminant analysis, respectively, on your training/ 
>>> ground
>>> truth data, and then use the predict method on the resulting  
>>> objects,
>>> passing the bands (you need to convert the SpatialGridDataFrame to a
>>> data.frame) as newdata to obtain the classified pixels. Make sure  
>>> that
>>> the band names have identical name in both cases. Then assign the
>>> predicted class to the SpatialGridDataFrame and export.
>>>
>>> It has never been clear to me whether "maximum likelihood
>>> classification" in RS refers to lda or qda. Anyway, it's called
>>> discriminant analysis in the statistical literature.
>>> --
>>> Edzer
>>>
>>>
>>> Corey Sparks wrote:
>>>
>>>> Dear list,
>>>> I want to do some unsupervised image classification of some landsat
>>>> imagery, I think I can read in the multi-band rasters using  
>>>> rgdal, but
>>>> has anyone tried doing this in R?  I am thinking (after looking at
>>>> documentation for how GRASS and ArcGIS do it) that I need to do an
>>>> initial hierarchical clustering to define clusters, but does anyone
>>>> have an idea on how to do a maximum likelihood classification of  
>>>> the
>>>> imagery?  Would a discriminant function approach work?  Any advice
>>>> anyone may have would be greatly appreciated, and i'm very sorry  
>>>> but I
>>>> don't have a working example yet.
>>>> Best
>>>>
>>>> Corey
>>>>
>>>> Corey Sparks
>>>> Assistant Professor
>>>> Department of Demography and Organization Studies
>>>> University of Texas at San Antonio
>>>> One UTSA Circle
>>>> San Antonio, TX 78249
>>>> 210 458 6858
>>>> corey.sparks 'at' utsa.edu
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at stat.math.ethz.ch
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>    
>>> -------------------------------------------------------------------- 
>>> ----
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>>
>
> <alobolistas.vcf>


From jeroen.druyts at student.kuleuven.be  Sun Apr 19 14:20:19 2009
From: jeroen.druyts at student.kuleuven.be (Jeroen Druyts)
Date: Sun, 19 Apr 2009 14:20:19 +0200
Subject: [R-sig-Geo] krige() option na.action
Message-ID: <A1AC534C18F14EB4BF0A322CEB765EAD@laptopjerre>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090419/16e0f4a5/attachment.pl>

From edzer.pebesma at uni-muenster.de  Sun Apr 19 16:06:41 2009
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sun, 19 Apr 2009 16:06:41 +0200
Subject: [R-sig-Geo] krige() option na.action
In-Reply-To: <A1AC534C18F14EB4BF0A322CEB765EAD@laptopjerre>
References: <A1AC534C18F14EB4BF0A322CEB765EAD@laptopjerre>
Message-ID: <49EB2FF1.4030002@uni-muenster.de>

Jeroen Druyts wrote:
> Hello,
>
> the output of krige() returns some NA values. I'd like to draw a semivariogram of this output, but then I get the warning
> "Error: dimensions do not match: locations 109078 and data 54536" This is because of the three NA-values in the predictions of krige (109078/2=54539). 
>   
Is it unreasonable that these NA values are returned? What causes them?
> I tried allready with the command na.action = na.omit in the krige command, but the NA's keep appearing.
> How do I prevent that there are NA values in the krige() output?
>   
As an alternative, you could try to remove them when passing data to
variogram():

library(gstat)
data(meuse)
coordinates(meuse) = ~x+y
meuse$z = meuse$zinc
meuse$z[1]=NA
variogram(z~1,meuse) # fails
variogram(z~1,meuse[!is.na(meuse$z),]) #passes

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de/
http://www.springer.com/978-0-387-78170-9 e.pebesma at wwu.de


From s.chamaille at yahoo.fr  Sun Apr 19 23:16:55 2009
From: s.chamaille at yahoo.fr (=?iso-8859-1?Q?Simon_Chamaill=E9?=)
Date: Sun, 19 Apr 2009 21:16:55 +0000 (GMT)
Subject: [R-sig-Geo] Lattice with autocorrelation and predetermined values
Message-ID: <202819.39669.qm@web24307.mail.ird.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090419/6538abbb/attachment.pl>

From Virgilio.Gomez at uclm.es  Sun Apr 19 23:51:49 2009
From: Virgilio.Gomez at uclm.es (Virgilio Gomez Rubio)
Date: Sun, 19 Apr 2009 23:51:49 +0200
Subject: [R-sig-Geo] Lattice with autocorrelation and predetermined
 values
In-Reply-To: <202819.39669.qm@web24307.mail.ird.yahoo.com>
References: <202819.39669.qm@web24307.mail.ird.yahoo.com>
Message-ID: <1240177909.7529.196.camel@Virgilio-Gomez>

Dear Simon,


Perhaps you could model your data using a multivariate Normal with
spatial autocorrelation (using a SAR or CAR specification). In this way,
you can fix some of the values and then simulate the rest. You can tune
the autocorrelation coefficient to make sure that the spatial
correlation is large enough to give high values of Moran's I.

Hope this helps,

Virgilio

El dom, 19-04-2009 a las 21:16 +0000, Simon Chamaill? escribi?:
> Dear all,
> 
> I want to distribute a vector of known values onto a lattice, while still making sure that the Moran autocorrelation is higher than a specific threshold.
> 
> I know of several ways of getting a lattice with some pre-determined levels of approximate spatial autocorrelation, but all involve some random number generation of one sort or another, whereas I want cell values to have some pre-determined values.
> 
> I assume that I could:
> 1) generate a lattice
> 2) randomly distribute my pre-determined values
> 3) compute Moran's I, then randomly permutate two cell values
> 5) recompute Moran's I and, and if higher that the one calculated in 3) keep the new lattice
> 6) back to 3) for permutation, or stop when Moran's I higher than my threshold, or kill the simulation when i've reached a specific number of iterations.
> 
> The above is obviously so inefficient that it is likely to be of no use for a lattice of even a moderate size or for a high autocorrelation threshold to be reached. I intend to work on approx. 100*100 lattice, with values equally distributed between 0-100, and autocorrelation threshold of approx. 0.3.
>  
> Any suggestions (hum..., even 'don't even think of doing something like this'), would be appreciated.
> Thanks,
> simon
> 
> 
>       
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From pshayes at maine.rr.com  Mon Apr 20 00:14:06 2009
From: pshayes at maine.rr.com (Peter S. Hayes)
Date: Sun, 19 Apr 2009 18:14:06 -0400
Subject: [R-sig-Geo] I've a problem with krige and would appreciate any
	thoughts...
Message-ID: <49EBA22E.6030405@maine.rr.com>

Hello list,

I have some data I am attempting to krige as an example for my class to 
perform.

Most of the work has been reading in, reprojecting, and formatting 
data... all fine.

But, when I create the variogram, grid, and variogram model and pass 
these into fit.variogram, I receive an error that - on the surface - 
seems to make no sense.

I considered that the singular variogram model might be the problem, but 
that made no difference when changed. I'm puzzled... any thoughts?

Thank you all!



Pete Hayes


str(fishtr)
Formal class 'SpatialPointsDataFrame' [package "sp"] with 5 slots
..@ data :'data.frame': 364 obs. of 8 variables:
.. ..$ X : int [1:364] 1 2 3 4 5 6 8 9 10 11 ...
.. ..$ Cruise_Tow: int [1:364] 199402 199402 199402 199402 199402 199402 
199402 199402 199402 199402 ...
.. ..$ YearNo : int [1:364] 0 0 0 0 0 0 0 0 0 0 ...
.. ..$ NUMBER : int [1:364] 2 19 12 10 1 12 18 8 23 7 ...
.. ..$ WEIGHT_KG : num [1:364] 0.9 2.2 2 2.4 0.5 0.8 1.7 1.2 3.6 1.9 ...
.. ..$ DSaco : num [1:364] 164743 156002 152330 167741 179798 ...
.. ..$ IDSaco : num [1:364] 6.07e-06 6.41e-06 6.56e-06 5.96e-06 5.56e-06 ...
.. ..$ lwt : num [1:364] -0.105 0.788 0.693 0.875 -0.693 ...
..@ coords.nrs : num(0)
..@ coords : num [1:364, 1:2] 421360 415658 432270 462808 460247 ...
.. ..- attr(*, "dimnames")=List of 2
.. .. ..$ : NULL
.. .. ..$ : chr [1:2] "DECLON" "DECLAT"
..@ bbox : num [1:2, 1:2] 347047 4641166 595022 4902398
.. ..- attr(*, "dimnames")=List of 2
.. .. ..$ : chr [1:2] "DECLON" "DECLAT"
.. .. ..$ : chr [1:2] "min" "max"
..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slots
.. .. ..@ projargs: chr " +proj=utm +zone=19 +ellps=GRS80 +datum=NAD83 
+units=m +no_defs +towgs84=0,0,0"
 > str(vg)
Classes ?gstatVariogram? and 'data.frame': 15 obs. of 6 variables:
$ np : num 490 1120 1758 2125 2678 ...
$ dist : num 5126 12320 20132 28176 36059 ...
$ gamma : num 1.18 1.48 1.33 1.52 1.6 ...
$ dir.hor: num 0 0 0 0 0 0 0 0 0 0 ...
$ dir.ver: num 0 0 0 0 0 0 0 0 0 0 ...
$ id : Factor w/ 1 level "var1": 1 1 1 1 1 1 1 1 1 1 ...
- attr(*, "direct")='data.frame': 1 obs. of 2 variables:
..$ id : Factor w/ 1 level "var1": 1
..$ is.direct: logi TRUE
 > str(vg.fit)
Classes ?variogramModel? and 'data.frame': 2 obs. of 9 variables:
$ model: Factor w/ 19 levels "Nug","Exp","Sph",..: 1 3
$ psill: num 0.698 0.761
$ range: num 0 10342
$ kappa: num 0 0.5
$ ang1 : num 0 0
$ ang2 : num 0 0
$ ang3 : num 0 0
$ anis1: num 1 1
$ anis2: num 1 1
- attr(*, "singular")= logi TRUE
- attr(*, "SSErr")= num 2.16e-07
 > str(spgrid)
Formal class 'SpatialGrid' [package "sp"] with 5 slots
..@ grid :Formal class 'GridTopology' [package "sp"] with 3 slots
.. .. ..@ cellcentre.offset: num [1:2] 347046 4641165
.. .. ..@ cellsize : num [1:2] 1000 1000
.. .. ..@ cells.dim : int [1:2] 255 265
..@ grid.index : int(0)
..@ coords : num [1:2, 1:2] 347046 601046 4641165 4905165
.. ..- attr(*, "dimnames")=List of 2
.. .. ..$ : NULL
.. .. ..$ : chr [1:2] "coords.x1" "coords.x2"
..@ bbox : num [1:2, 1:2] 346546 4640665 601546 4905665
.. ..- attr(*, "dimnames")=List of 2
.. .. ..$ : chr [1:2] "coords.x1" "coords.x2"
.. .. ..$ : chr [1:2] "min" "max"
..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slots
.. .. ..@ projargs: chr " +proj=utm +zone=19 +ellps=GRS80 +datum=NAD83 
+units=m +no_defs +towgs84=0,0,0"
 >
 > lwt.uk <- krige(lwt~IDSaco,fishtr,spgrid,vg.fit)
Error in eval(expr, envir, enclos) : object "IDSaco" not found
 >


From adrian at maths.uwa.edu.au  Mon Apr 20 07:44:48 2009
From: adrian at maths.uwa.edu.au (Adrian Baddeley)
Date: Mon, 20 Apr 2009 13:44:48 +0800
Subject: [R-sig-Geo]  Converting Tessellation objects into shape files
Message-ID: <49EC0BD0.5080709@maths.uwa.edu.au>

Adalberto Pineda <apineda at dataquick.com> writes:

> I was trying to convert an object of class tess generated using the spatstat package into a shape file

Source the code below, and then apply the function 'tess2SP' to your tessellation object. This will convert it to a SpatialPolygons object, which you can then output as a shapefile. 

(This only works if the tessellation is made of polygons or rectangles.)

Adrian Baddeley

-----------------------------------------------------------------------------------------

require(spatstat)
require(sp)

# convert spatstat objects to sp classes

owin2Polygons <- function(x, id="1") {
  stopifnot(is.owin(x))
  x <- as.polygonal(x)
  closering <- function(df) { df[c(seq(nrow(df)), 1), ] }
  pieces <- lapply(x$bdry,
                   function(p) { 
                     Polygon(coords=closering(cbind(p$x,p$y)),
                             hole=is.hole.xypolygon(p))  })
  z <- Polygons(pieces, id)
  return(z)
}

tess2SP <- function(x) {
  stopifnot(is.tess(x))
  y <- tiles(x)
  nom <- names(y)
  z <- list()
  for(i in seq(y))
    z[[i]] <- owin2Polygons(y[[i]], nom[i])
  return(SpatialPolygons(z))
}

owin2SP <- function(x) {
  stopifnot(is.owin(x))
  y <- owin2Polygons(x)
  z <- SpatialPolygons(list(y))
  return(z)
}


From edzer.pebesma at uni-muenster.de  Mon Apr 20 09:07:18 2009
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 20 Apr 2009 09:07:18 +0200
Subject: [R-sig-Geo] I've a problem with krige and would appreciate any
 thoughts...
In-Reply-To: <49EBA22E.6030405@maine.rr.com>
References: <49EBA22E.6030405@maine.rr.com>
Message-ID: <49EC1F26.3040607@uni-muenster.de>

The problem is that for universal kriging prediction, you need IDSaco
values at the prediction locations. So, you need to make the prediction
locations grid (newdata) a SpatialGridDataFrame that has these values on
each prediction location (grid node).
--
Edzer

Peter S. Hayes wrote:
> Hello list,
>
> I have some data I am attempting to krige as an example for my class
> to perform.
>
> Most of the work has been reading in, reprojecting, and formatting
> data... all fine.
>
> But, when I create the variogram, grid, and variogram model and pass
> these into fit.variogram, I receive an error that - on the surface -
> seems to make no sense.
>
> I considered that the singular variogram model might be the problem,
> but that made no difference when changed. I'm puzzled... any thoughts?
>
> Thank you all!
>
>
>
> Pete Hayes
>
>
> str(fishtr)
> Formal class 'SpatialPointsDataFrame' [package "sp"] with 5 slots
> ..@ data :'data.frame': 364 obs. of 8 variables:
> .. ..$ X : int [1:364] 1 2 3 4 5 6 8 9 10 11 ...
> .. ..$ Cruise_Tow: int [1:364] 199402 199402 199402 199402 199402
> 199402 199402 199402 199402 199402 ...
> .. ..$ YearNo : int [1:364] 0 0 0 0 0 0 0 0 0 0 ...
> .. ..$ NUMBER : int [1:364] 2 19 12 10 1 12 18 8 23 7 ...
> .. ..$ WEIGHT_KG : num [1:364] 0.9 2.2 2 2.4 0.5 0.8 1.7 1.2 3.6 1.9 ...
> .. ..$ DSaco : num [1:364] 164743 156002 152330 167741 179798 ...
> .. ..$ IDSaco : num [1:364] 6.07e-06 6.41e-06 6.56e-06 5.96e-06
> 5.56e-06 ...
> .. ..$ lwt : num [1:364] -0.105 0.788 0.693 0.875 -0.693 ...
> ..@ coords.nrs : num(0)
> ..@ coords : num [1:364, 1:2] 421360 415658 432270 462808 460247 ...
> .. ..- attr(*, "dimnames")=List of 2
> .. .. ..$ : NULL
> .. .. ..$ : chr [1:2] "DECLON" "DECLAT"
> ..@ bbox : num [1:2, 1:2] 347047 4641166 595022 4902398
> .. ..- attr(*, "dimnames")=List of 2
> .. .. ..$ : chr [1:2] "DECLON" "DECLAT"
> .. .. ..$ : chr [1:2] "min" "max"
> ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slots
> .. .. ..@ projargs: chr " +proj=utm +zone=19 +ellps=GRS80 +datum=NAD83
> +units=m +no_defs +towgs84=0,0,0"
> > str(vg)
> Classes ?gstatVariogram? and 'data.frame': 15 obs. of 6 variables:
> $ np : num 490 1120 1758 2125 2678 ...
> $ dist : num 5126 12320 20132 28176 36059 ...
> $ gamma : num 1.18 1.48 1.33 1.52 1.6 ...
> $ dir.hor: num 0 0 0 0 0 0 0 0 0 0 ...
> $ dir.ver: num 0 0 0 0 0 0 0 0 0 0 ...
> $ id : Factor w/ 1 level "var1": 1 1 1 1 1 1 1 1 1 1 ...
> - attr(*, "direct")='data.frame': 1 obs. of 2 variables:
> ..$ id : Factor w/ 1 level "var1": 1
> ..$ is.direct: logi TRUE
> > str(vg.fit)
> Classes ?variogramModel? and 'data.frame': 2 obs. of 9 variables:
> $ model: Factor w/ 19 levels "Nug","Exp","Sph",..: 1 3
> $ psill: num 0.698 0.761
> $ range: num 0 10342
> $ kappa: num 0 0.5
> $ ang1 : num 0 0
> $ ang2 : num 0 0
> $ ang3 : num 0 0
> $ anis1: num 1 1
> $ anis2: num 1 1
> - attr(*, "singular")= logi TRUE
> - attr(*, "SSErr")= num 2.16e-07
> > str(spgrid)
> Formal class 'SpatialGrid' [package "sp"] with 5 slots
> ..@ grid :Formal class 'GridTopology' [package "sp"] with 3 slots
> .. .. ..@ cellcentre.offset: num [1:2] 347046 4641165
> .. .. ..@ cellsize : num [1:2] 1000 1000
> .. .. ..@ cells.dim : int [1:2] 255 265
> ..@ grid.index : int(0)
> ..@ coords : num [1:2, 1:2] 347046 601046 4641165 4905165
> .. ..- attr(*, "dimnames")=List of 2
> .. .. ..$ : NULL
> .. .. ..$ : chr [1:2] "coords.x1" "coords.x2"
> ..@ bbox : num [1:2, 1:2] 346546 4640665 601546 4905665
> .. ..- attr(*, "dimnames")=List of 2
> .. .. ..$ : chr [1:2] "coords.x1" "coords.x2"
> .. .. ..$ : chr [1:2] "min" "max"
> ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slots
> .. .. ..@ projargs: chr " +proj=utm +zone=19 +ellps=GRS80 +datum=NAD83
> +units=m +no_defs +towgs84=0,0,0"
> >
> > lwt.uk <- krige(lwt~IDSaco,fishtr,spgrid,vg.fit)
> Error in eval(expr, envir, enclos) : object "IDSaco" not found
> >
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de/
http://www.springer.com/978-0-387-78170-9 e.pebesma at wwu.de


From Roger.Bivand at nhh.no  Mon Apr 20 10:09:15 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 20 Apr 2009 10:09:15 +0200 (CEST)
Subject: [R-sig-Geo] Lattice with autocorrelation and predetermined
 values
In-Reply-To: <1240177909.7529.196.camel@Virgilio-Gomez>
References: <202819.39669.qm@web24307.mail.ird.yahoo.com>
	<1240177909.7529.196.camel@Virgilio-Gomez>
Message-ID: <alpine.LRH.2.00.0904200932000.3594@reclus.nhh.no>

On Sun, 19 Apr 2009, Virgilio Gomez Rubio wrote:

> Dear Simon,
>
>
> Perhaps you could model your data using a multivariate Normal with
> spatial autocorrelation (using a SAR or CAR specification). In this way,
> you can fix some of the values and then simulate the rest. You can tune
> the autocorrelation coefficient to make sure that the spatial
> correlation is large enough to give high values of Moran's I.

Yes, this is the way to go, but raises practical problems for a 100 by 100 
grid (10') observations. In this case, you would need to use a "W" or "C" 
style weights list, convert to sparse matrix format, and power the matrix 
some k times. The inverse of (I - rho W) will then be the sum of:

rho^i W^i, for i=0,...,k

Using the "B" style and/or some kinds of general weights may lead to a 
slow convergence of rho^k W^k to machine zero.

Note also that rho is not Moran's I, but is scaled depending on the 
structure of W and its extreme eigenvalues.

The original idea of swapping values cell-wise will not work, because the 
values propagate through (I - rho W)^{-1}, so you'd need to choose from n 
samples (permutations) of the input vector. Just sample the vector say 
10000 times, compute Moran's I (possibly simplifying the code for speed), 
and choose one of the outputs satisfying your criteria. You need to think 
about storage and about reproducibility (think set.seed() and friends, to 
record the state of the RNG before each permutation, rather than the 
permutation vector.

For a 10 by 10 raster, this might look like:

library(spdep)
n <- 100
set.seed(1)
input <- rnorm(n)
nb <- cell2nb(10, 10, torus=TRUE)
lw <- nb2listw(nb, style="C")
S0 <- Szero(lw)
seeds <- sample.int(1e7, 1e4)
outI <- sapply(seeds, function(x) {
   set.seed(x)
   perm <- sample.int(n, n)
   moran(input[perm], lw, n, S0)$I
})
hist(outI)

What you notice is that you'd actually need a very large number of samples 
to achieve even moderate autocorrelation, so maybe the SAR simulation is 
the way to go, or maybe an SMA scheme:

n <- 100
set.seed(1)
input <- rnorm(n)
nb <- cell2nb(10, 10, torus=TRUE)
lw <- nb2listw(nb, style="C")
S0 <- Szero(lw)
input <- input + 0.9 * lag(lw, input)
moran(input, lw, n, S0)$I

for avoiding the problem of inverting a large matrix, or approximating 
through the sum of a power series.

Hope this helps,

Roger

>
> Hope this helps,
>
> Virgilio
>
> El dom, 19-04-2009 a las 21:16 +0000, Simon Chamaill? escribi?:
>> Dear all,
>> 
>> I want to distribute a vector of known values onto a lattice, while still making sure that the Moran autocorrelation is higher than a specific threshold.
>> 
>> I know of several ways of getting a lattice with some pre-determined levels of approximate spatial autocorrelation, but all involve some random number generation of one sort or another, whereas I want cell values to have some pre-determined values.
>> 
>> I assume that I could:
>> 1) generate a lattice
>> 2) randomly distribute my pre-determined values
>> 3) compute Moran's I, then randomly permutate two cell values
>> 5) recompute Moran's I and, and if higher that the one calculated in 3) keep the new lattice
>> 6) back to 3) for permutation, or stop when Moran's I higher than my threshold, or kill the simulation when i've reached a specific number of iterations.
>> 
>> The above is obviously so inefficient that it is likely to be of no use for a lattice of even a moderate size or for a high autocorrelation threshold to be reached. I intend to work on approx. 100*100 lattice, with values equally distributed between 0-100, and autocorrelation threshold of approx. 0.3.
>> 
>> Any suggestions (hum..., even 'don't even think of doing something like this'), would be appreciated.
>> Thanks,
>> simon
>> 
>>
>>
>> 	[[alternative HTML version deleted]]
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From s.chamaille at yahoo.fr  Mon Apr 20 17:56:23 2009
From: s.chamaille at yahoo.fr (=?iso-8859-1?Q?Simon_Chamaill=E9?=)
Date: Mon, 20 Apr 2009 15:56:23 +0000 (GMT)
Subject: [R-sig-Geo] Re : Lattice with autocorrelation and predetermined
	values
In-Reply-To: <alpine.LRH.2.00.0904200932000.3594@reclus.nhh.no>
References: <202819.39669.qm@web24307.mail.ird.yahoo.com>
	<1240177909.7529.196.camel@Virgilio-Gomez>
	<alpine.LRH.2.00.0904200932000.3594@reclus.nhh.no>
Message-ID: <51911.25451.qm@web24301.mail.ird.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090420/64f56ab4/attachment.pl>

From alinashe at gmail.com  Mon Apr 20 19:26:38 2009
From: alinashe at gmail.com (Alina Sheyman)
Date: Mon, 20 Apr 2009 13:26:38 -0400
Subject: [R-sig-Geo] creating polygons
Message-ID: <f58db2700904201026n8de839frf72181b90a17b771@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090420/b5719f31/attachment.pl>

From corey.sparks at UTSA.EDU  Mon Apr 20 20:32:33 2009
From: corey.sparks at UTSA.EDU (Corey Sparks)
Date: Mon, 20 Apr 2009 13:32:33 -0500
Subject: [R-sig-Geo] Building rgdal 0.6-7 on Mac
Message-ID: <419C0C93-121D-40EE-8F21-B81321057864@utsa.edu>

Dear list,
I've just built my new version of R 2.9.0 and installed my packages.

 > sessionInfo()
R version 2.9.0 Patched (2009-04-20 r48365)
i386-apple-darwin9.6.0

locale:
C

attached base packages:
[1] stats     graphics  grDevices datasets  utils     methods   base


I use rgdal for reading and writing raster data but when I try to  
install version 0.6-7 (I already have 0.6-5 installed) from source, I  
get an error.  I have installed all of the external dependencies  
(GDAL, PROJ4, etc) and think I am specifying the installation command  
correctly.  I have rgdal_0.6-7.tar.gz in my home directory, here is my  
command

R --arch=x86_64 CMD INSTALL rgdal_0.6-7.tar.gz --configure-args='-- 
with-gdal-config=/Library/Frameworks/GDAL.framework/Versions/1.6/ 
Programs/gdal-config --with-proj-lib=/Library/Frameworks/ 
PROJ.framework/Versions/4.6/unix/lib --with-proj-include=/Library/ 
Frameworks/PROJ.framework/Versions/4.6/Headers' rgdal_0.6-7.tar.gz

Here is what happens: Please forgive the voluminous output.

* Installing to library '/Library/Frameworks/R.framework/Resources/ 
library'
* Installing *source* package 'rgdal' ...
gdal-config: /Library/Frameworks/GDAL.framework/Versions/1.6/Programs/ 
gdal-config
checking for gcc... gcc -arch x86_64 -std=gnu99
checking for C compiler default output file name... a.out
checking whether the C compiler works... yes
checking whether we are cross compiling... no
checking for suffix of executables...
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether gcc -arch x86_64 -std=gnu99 accepts -g... yes
checking for gcc -arch x86_64 -std=gnu99 option to accept ANSI C...  
none needed
checking how to run the C preprocessor... gcc -arch x86_64 -std=gnu99 -E
checking for egrep... grep -E
checking for ANSI C header files... rm: conftest.dSYM: is a directory
rm: conftest.dSYM: is a directory
yes
checking for sys/types.h... yes
checking for sys/stat.h... yes
checking for stdlib.h... yes
checking for string.h... yes
checking for memory.h... yes
checking for strings.h... yes
checking for inttypes.h... yes
checking for stdint.h... yes
checking for unistd.h... yes
checking proj_api.h usability... yes
checking proj_api.h presence... yes
checking for proj_api.h... yes
checking for pj_init_plus in -lproj... yes
Package CPP flags: -I/Library/Frameworks/PROJ.framework/Versions/4.6/ 
Headers -I/Library/Frameworks/GDAL.framework/Versions/1.6/Headers
Package LIBS:  -L/Library/Frameworks/PROJ.framework/Versions/4.6/unix/ 
lib -L/Library/Frameworks/GDAL.framework/Versions/1.6/unix/lib -lgdal
configure: creating ./config.status
config.status: creating src/Makevars
** libs
** arch - x86_64
g++ -arch x86_64 -I/Library/Frameworks/R.framework/Resources/include - 
I/Library/Frameworks/R.framework/Resources/include/x86_64 -I/Library/ 
Frameworks/PROJ.framework/Versions/4.6/Headers -I/Library/Frameworks/ 
GDAL.framework/Versions/1.6/Headers -I/usr/local/include    -fPIC  -g - 
O2 -c OGR_write.cpp -o OGR_write.o
g++ -arch x86_64 -I/Library/Frameworks/R.framework/Resources/include - 
I/Library/Frameworks/R.framework/Resources/include/x86_64 -I/Library/ 
Frameworks/PROJ.framework/Versions/4.6/Headers -I/Library/Frameworks/ 
GDAL.framework/Versions/1.6/Headers -I/usr/local/include    -fPIC  -g - 
O2 -c gdal-bindings.cpp -o gdal-bindings.o
g++ -arch x86_64 -I/Library/Frameworks/R.framework/Resources/include - 
I/Library/Frameworks/R.framework/Resources/include/x86_64 -I/Library/ 
Frameworks/PROJ.framework/Versions/4.6/Headers -I/Library/Frameworks/ 
GDAL.framework/Versions/1.6/Headers -I/usr/local/include    -fPIC  -g - 
O2 -c ogr_geom.cpp -o ogr_geom.o
g++ -arch x86_64 -I/Library/Frameworks/R.framework/Resources/include - 
I/Library/Frameworks/R.framework/Resources/include/x86_64 -I/Library/ 
Frameworks/PROJ.framework/Versions/4.6/Headers -I/Library/Frameworks/ 
GDAL.framework/Versions/1.6/Headers -I/usr/local/include    -fPIC  -g - 
O2 -c ogr_proj.cpp -o ogr_proj.o
g++ -arch x86_64 -I/Library/Frameworks/R.framework/Resources/include - 
I/Library/Frameworks/R.framework/Resources/include/x86_64 -I/Library/ 
Frameworks/PROJ.framework/Versions/4.6/Headers -I/Library/Frameworks/ 
GDAL.framework/Versions/1.6/Headers -I/usr/local/include    -fPIC  -g - 
O2 -c ogrdrivers.cpp -o ogrdrivers.o
g++ -arch x86_64 -I/Library/Frameworks/R.framework/Resources/include - 
I/Library/Frameworks/R.framework/Resources/include/x86_64 -I/Library/ 
Frameworks/PROJ.framework/Versions/4.6/Headers -I/Library/Frameworks/ 
GDAL.framework/Versions/1.6/Headers -I/usr/local/include    -fPIC  -g - 
O2 -c ogrsource.cpp -o ogrsource.o
g++ -arch x86_64 -I/Library/Frameworks/R.framework/Resources/include - 
I/Library/Frameworks/R.framework/Resources/include/x86_64 -I/Library/ 
Frameworks/PROJ.framework/Versions/4.6/Headers -I/Library/Frameworks/ 
GDAL.framework/Versions/1.6/Headers -I/usr/local/include    -fPIC  -g - 
O2 -c projectit.cpp -o projectit.o
g++ -arch x86_64 -dynamiclib -Wl,-headerpad_max_install_names - 
undefined dynamic_lookup -single_module -multiply_defined suppress -L/ 
usr/local/lib -o rgdal.so OGR_write.o gdal-bindings.o ogr_geom.o  
ogr_proj.o ogrdrivers.o ogrsource.o projectit.o -L/Library/Frameworks/ 
PROJ.framework/Versions/4.6/unix/lib -L/Library/Frameworks/ 
GDAL.framework/Versions/1.6/unix/lib -lgdal -lproj -F/Library/ 
Frameworks/R.framework/.. -framework R -Wl,-framework -Wl,CoreFoundation
** R
** inst
** preparing package for lazy loading
** help
*** installing help indices
  >>> Building/Updating help pages for package 'rgdal'
      Formats: text html latex example
   CRS-class                         text    html    latex   example
   GDALDataset-class                 text    html    latex
   GDALDriver-class                  text    html    latex   example
   GDALMajorObject-class             text    html    latex   example
   GDALRasterBand-class              text    html    latex   example
   GDALReadOnlyDataset-class         text    html    latex   example
   GDALReadOnlyDataset-methods       text    html    latex   example
   GDALTransientDataset-class        text    html    latex   example
   RGB2PCT                           text    html    latex   example
   SGDF2PCT                          text    html    latex   example
   SpatialGDAL-class                 text    html    latex   example
   closeDataset-methods              text    html    latex
   displayDataset                    text    html    latex   example
   make_EPSG                         text    html    latex   example
   projInfo                          text    html    latex   example
   project                           text    html    latex   example
   readGDAL                          text    html    latex   example
   readOGR                           text    html    latex   example
   showWKT                           text    html    latex   example
   spTransform-methods               text    html    latex   example
   writeOGR                          text    html    latex   example
** building package indices ...
* DONE (rgdal)

* Installing *source* package 'rgdal' ...
mv: rename /Library/Frameworks/R.framework/Resources/library/rgdal to / 
Library/Frameworks/R.framework/Resources/library/00LOCK/rgdal/rgdal:  
Directory not empty
gdal-config: /Library/Frameworks/GDAL.framework/Versions/1.6/Programs/ 
gdal-config
checking for gcc... gcc -arch x86_64 -std=gnu99
checking for C compiler default output file name... a.out
checking whether the C compiler works... yes
checking whether we are cross compiling... no
checking for suffix of executables...
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether gcc -arch x86_64 -std=gnu99 accepts -g... yes
checking for gcc -arch x86_64 -std=gnu99 option to accept ANSI C...  
none needed
checking how to run the C preprocessor... gcc -arch x86_64 -std=gnu99 -E
checking for egrep... grep -E
checking for ANSI C header files... rm: conftest.dSYM: is a directory
rm: conftest.dSYM: is a directory
yes
checking for sys/types.h... yes
checking for sys/stat.h... yes
checking for stdlib.h... yes
checking for string.h... yes
checking for memory.h... yes
checking for strings.h... yes
checking for inttypes.h... yes
checking for stdint.h... yes
checking for unistd.h... yes
checking proj_api.h usability... yes
checking proj_api.h presence... yes
checking for proj_api.h... yes
checking for pj_init_plus in -lproj... yes
Package CPP flags: -I/Library/Frameworks/PROJ.framework/Versions/4.6/ 
Headers -I/Library/Frameworks/GDAL.framework/Versions/1.6/Headers
Package LIBS:  -L/Library/Frameworks/PROJ.framework/Versions/4.6/unix/ 
lib -L/Library/Frameworks/GDAL.framework/Versions/1.6/unix/lib -lgdal
configure: creating ./config.status
config.status: creating src/Makevars
** libs
** arch - x86_64
make: Nothing to be done for `all'.
** R
** inst
** preparing package for lazy loading
Error in nchar(filename) : element 1 is empty;
    the part of the args list of '.Internal' being evaluated was:
    (x, type, allowNA)
Error : unable to load R code in package 'rgdal'
ERROR: lazy loading failed for package 'rgdal'
* Removing '/Library/Frameworks/R.framework/Resources/library/rgdal'
* Restoring previous '/Library/Frameworks/R.framework/Resources/ 
library/rgdal'

Any thoughts would be greatly appreciated.  Thanks
Corey

Corey Sparks
Assistant Professor
Department of Demography and Organization Studies
University of Texas at San Antonio
One UTSA Circle
San Antonio, TX 78249
210 458 6858
corey.sparks 'at' utsa.edu


From Roger.Bivand at nhh.no  Mon Apr 20 20:59:02 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 20 Apr 2009 20:59:02 +0200 (CEST)
Subject: [R-sig-Geo] Building rgdal 0.6-7 on Mac
In-Reply-To: <419C0C93-121D-40EE-8F21-B81321057864@utsa.edu>
References: <419C0C93-121D-40EE-8F21-B81321057864@utsa.edu>
Message-ID: <alpine.LRH.2.00.0904202046320.5721@reclus.nhh.no>

On Mon, 20 Apr 2009, Corey Sparks wrote:

> Dear list,
> I've just built my new version of R 2.9.0 and installed my packages.
>
>> sessionInfo()
> R version 2.9.0 Patched (2009-04-20 r48365)
> i386-apple-darwin9.6.0
>
> locale:
> C
>
> attached base packages:
> [1] stats     graphics  grDevices datasets  utils     methods   base
>
>
> I use rgdal for reading and writing raster data but when I try to install 
> version 0.6-7 (I already have 0.6-5 installed) from source, I get an error.

Was 0.6-5 built with R 2.8.1? If you feel like taking risks, please try to 
see whether installing rgdal_0.6-5 under R 2.9.0 provokes the same 
problem. Have you tried asking on R-sig-mac - the changes from 0.6-5 to 
0.6-7 were very small (a "[" subsetting operation with an omitted 
drop=FALSE)?

See for example:

http://rgdal.cvs.sourceforge.net/viewvc/rgdal/rgdal/R/sp_gdal.R?r1=1.30&r2=1.31

Nothing there should trigger problems, so I'd look to see whether there is 
something platform and/or R release related.

On Linux i386 and x86_64, and Windows i386, everything looks OK.

Roger

> I have installed all of the external dependencies (GDAL, PROJ4, etc) and 
> think I am specifying the installation command correctly.  I have 
> rgdal_0.6-7.tar.gz in my home directory, here is my command
>
> R --arch=x86_64 CMD INSTALL rgdal_0.6-7.tar.gz 
> --configure-args='--with-gdal-config=/Library/Frameworks/GDAL.framework/Versions/1.6/Programs/gdal-config 
> --with-proj-lib=/Library/Frameworks/PROJ.framework/Versions/4.6/unix/lib 
> --with-proj-include=/Library/Frameworks/PROJ.framework/Versions/4.6/Headers' 
> rgdal_0.6-7.tar.gz
>
> Here is what happens: Please forgive the voluminous output.
>
> * Installing to library '/Library/Frameworks/R.framework/Resources/library'
> * Installing *source* package 'rgdal' ...
> gdal-config: 
> /Library/Frameworks/GDAL.framework/Versions/1.6/Programs/gdal-config
> checking for gcc... gcc -arch x86_64 -std=gnu99
> checking for C compiler default output file name... a.out
> checking whether the C compiler works... yes
> checking whether we are cross compiling... no
> checking for suffix of executables...
> checking for suffix of object files... o
> checking whether we are using the GNU C compiler... yes
> checking whether gcc -arch x86_64 -std=gnu99 accepts -g... yes
> checking for gcc -arch x86_64 -std=gnu99 option to accept ANSI C... none 
> needed
> checking how to run the C preprocessor... gcc -arch x86_64 -std=gnu99 -E
> checking for egrep... grep -E
> checking for ANSI C header files... rm: conftest.dSYM: is a directory
> rm: conftest.dSYM: is a directory
> yes
> checking for sys/types.h... yes
> checking for sys/stat.h... yes
> checking for stdlib.h... yes
> checking for string.h... yes
> checking for memory.h... yes
> checking for strings.h... yes
> checking for inttypes.h... yes
> checking for stdint.h... yes
> checking for unistd.h... yes
> checking proj_api.h usability... yes
> checking proj_api.h presence... yes
> checking for proj_api.h... yes
> checking for pj_init_plus in -lproj... yes
> Package CPP flags: -I/Library/Frameworks/PROJ.framework/Versions/4.6/Headers 
> -I/Library/Frameworks/GDAL.framework/Versions/1.6/Headers
> Package LIBS:  -L/Library/Frameworks/PROJ.framework/Versions/4.6/unix/lib 
> -L/Library/Frameworks/GDAL.framework/Versions/1.6/unix/lib -lgdal
> configure: creating ./config.status
> config.status: creating src/Makevars
> ** libs
> ** arch - x86_64
> g++ -arch x86_64 -I/Library/Frameworks/R.framework/Resources/include 
> -I/Library/Frameworks/R.framework/Resources/include/x86_64 
> -I/Library/Frameworks/PROJ.framework/Versions/4.6/Headers 
> -I/Library/Frameworks/GDAL.framework/Versions/1.6/Headers 
> -I/usr/local/include    -fPIC  -g -O2 -c OGR_write.cpp -o OGR_write.o
> g++ -arch x86_64 -I/Library/Frameworks/R.framework/Resources/include 
> -I/Library/Frameworks/R.framework/Resources/include/x86_64 
> -I/Library/Frameworks/PROJ.framework/Versions/4.6/Headers 
> -I/Library/Frameworks/GDAL.framework/Versions/1.6/Headers 
> -I/usr/local/include    -fPIC  -g -O2 -c gdal-bindings.cpp -o gdal-bindings.o
> g++ -arch x86_64 -I/Library/Frameworks/R.framework/Resources/include 
> -I/Library/Frameworks/R.framework/Resources/include/x86_64 
> -I/Library/Frameworks/PROJ.framework/Versions/4.6/Headers 
> -I/Library/Frameworks/GDAL.framework/Versions/1.6/Headers 
> -I/usr/local/include    -fPIC  -g -O2 -c ogr_geom.cpp -o ogr_geom.o
> g++ -arch x86_64 -I/Library/Frameworks/R.framework/Resources/include 
> -I/Library/Frameworks/R.framework/Resources/include/x86_64 
> -I/Library/Frameworks/PROJ.framework/Versions/4.6/Headers 
> -I/Library/Frameworks/GDAL.framework/Versions/1.6/Headers 
> -I/usr/local/include    -fPIC  -g -O2 -c ogr_proj.cpp -o ogr_proj.o
> g++ -arch x86_64 -I/Library/Frameworks/R.framework/Resources/include 
> -I/Library/Frameworks/R.framework/Resources/include/x86_64 
> -I/Library/Frameworks/PROJ.framework/Versions/4.6/Headers 
> -I/Library/Frameworks/GDAL.framework/Versions/1.6/Headers 
> -I/usr/local/include    -fPIC  -g -O2 -c ogrdrivers.cpp -o ogrdrivers.o
> g++ -arch x86_64 -I/Library/Frameworks/R.framework/Resources/include 
> -I/Library/Frameworks/R.framework/Resources/include/x86_64 
> -I/Library/Frameworks/PROJ.framework/Versions/4.6/Headers 
> -I/Library/Frameworks/GDAL.framework/Versions/1.6/Headers 
> -I/usr/local/include    -fPIC  -g -O2 -c ogrsource.cpp -o ogrsource.o
> g++ -arch x86_64 -I/Library/Frameworks/R.framework/Resources/include 
> -I/Library/Frameworks/R.framework/Resources/include/x86_64 
> -I/Library/Frameworks/PROJ.framework/Versions/4.6/Headers 
> -I/Library/Frameworks/GDAL.framework/Versions/1.6/Headers 
> -I/usr/local/include    -fPIC  -g -O2 -c projectit.cpp -o projectit.o
> g++ -arch x86_64 -dynamiclib -Wl,-headerpad_max_install_names -undefined 
> dynamic_lookup -single_module -multiply_defined suppress -L/usr/local/lib -o 
> rgdal.so OGR_write.o gdal-bindings.o ogr_geom.o ogr_proj.o ogrdrivers.o 
> ogrsource.o projectit.o 
> -L/Library/Frameworks/PROJ.framework/Versions/4.6/unix/lib 
> -L/Library/Frameworks/GDAL.framework/Versions/1.6/unix/lib -lgdal -lproj 
> -F/Library/Frameworks/R.framework/.. -framework R -Wl,-framework 
> -Wl,CoreFoundation
> ** R
> ** inst
> ** preparing package for lazy loading
> ** help
> *** installing help indices
>>>> Building/Updating help pages for package 'rgdal'
>    Formats: text html latex example
> CRS-class                         text    html    latex   example
> GDALDataset-class                 text    html    latex
> GDALDriver-class                  text    html    latex   example
> GDALMajorObject-class             text    html    latex   example
> GDALRasterBand-class              text    html    latex   example
> GDALReadOnlyDataset-class         text    html    latex   example
> GDALReadOnlyDataset-methods       text    html    latex   example
> GDALTransientDataset-class        text    html    latex   example
> RGB2PCT                           text    html    latex   example
> SGDF2PCT                          text    html    latex   example
> SpatialGDAL-class                 text    html    latex   example
> closeDataset-methods              text    html    latex
> displayDataset                    text    html    latex   example
> make_EPSG                         text    html    latex   example
> projInfo                          text    html    latex   example
> project                           text    html    latex   example
> readGDAL                          text    html    latex   example
> readOGR                           text    html    latex   example
> showWKT                           text    html    latex   example
> spTransform-methods               text    html    latex   example
> writeOGR                          text    html    latex   example
> ** building package indices ...
> * DONE (rgdal)
>
> * Installing *source* package 'rgdal' ...
> mv: rename /Library/Frameworks/R.framework/Resources/library/rgdal to 
> /Library/Frameworks/R.framework/Resources/library/00LOCK/rgdal/rgdal: 
> Directory not empty
> gdal-config: 
> /Library/Frameworks/GDAL.framework/Versions/1.6/Programs/gdal-config
> checking for gcc... gcc -arch x86_64 -std=gnu99
> checking for C compiler default output file name... a.out
> checking whether the C compiler works... yes
> checking whether we are cross compiling... no
> checking for suffix of executables...
> checking for suffix of object files... o
> checking whether we are using the GNU C compiler... yes
> checking whether gcc -arch x86_64 -std=gnu99 accepts -g... yes
> checking for gcc -arch x86_64 -std=gnu99 option to accept ANSI C... none 
> needed
> checking how to run the C preprocessor... gcc -arch x86_64 -std=gnu99 -E
> checking for egrep... grep -E
> checking for ANSI C header files... rm: conftest.dSYM: is a directory
> rm: conftest.dSYM: is a directory
> yes
> checking for sys/types.h... yes
> checking for sys/stat.h... yes
> checking for stdlib.h... yes
> checking for string.h... yes
> checking for memory.h... yes
> checking for strings.h... yes
> checking for inttypes.h... yes
> checking for stdint.h... yes
> checking for unistd.h... yes
> checking proj_api.h usability... yes
> checking proj_api.h presence... yes
> checking for proj_api.h... yes
> checking for pj_init_plus in -lproj... yes
> Package CPP flags: -I/Library/Frameworks/PROJ.framework/Versions/4.6/Headers 
> -I/Library/Frameworks/GDAL.framework/Versions/1.6/Headers
> Package LIBS:  -L/Library/Frameworks/PROJ.framework/Versions/4.6/unix/lib 
> -L/Library/Frameworks/GDAL.framework/Versions/1.6/unix/lib -lgdal
> configure: creating ./config.status
> config.status: creating src/Makevars
> ** libs
> ** arch - x86_64
> make: Nothing to be done for `all'.
> ** R
> ** inst
> ** preparing package for lazy loading
> Error in nchar(filename) : element 1 is empty;
>  the part of the args list of '.Internal' being evaluated was:
>  (x, type, allowNA)
> Error : unable to load R code in package 'rgdal'
> ERROR: lazy loading failed for package 'rgdal'
> * Removing '/Library/Frameworks/R.framework/Resources/library/rgdal'
> * Restoring previous 
> '/Library/Frameworks/R.framework/Resources/library/rgdal'
>
> Any thoughts would be greatly appreciated.  Thanks
> Corey
>
> Corey Sparks
> Assistant Professor
> Department of Demography and Organization Studies
> University of Texas at San Antonio
> One UTSA Circle
> San Antonio, TX 78249
> 210 458 6858
> corey.sparks 'at' utsa.edu
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From grenyer at imperial.ac.uk  Mon Apr 20 21:10:15 2009
From: grenyer at imperial.ac.uk (Rich Grenyer)
Date: Mon, 20 Apr 2009 20:10:15 +0100
Subject: [R-sig-Geo] Building rgdal 0.6-7 on Mac
In-Reply-To: <alpine.LRH.2.00.0904202046320.5721@reclus.nhh.no>
References: <419C0C93-121D-40EE-8F21-B81321057864@utsa.edu>
	<alpine.LRH.2.00.0904202046320.5721@reclus.nhh.no>
Message-ID: <3740741D-588A-4C61-B79C-D128D6B12C77@imperial.ac.uk>

> On Linux i386 and x86_64, and Windows i386, everything looks OK.

I built 0.6-7 from source this morning on i386-apple-darwin8.11.1  
without problem, linking to the Kyngesbury frameworks; it didn't fail  
with that error.

Rich


From corey.sparks at UTSA.EDU  Mon Apr 20 21:10:53 2009
From: corey.sparks at UTSA.EDU (Corey Sparks)
Date: Mon, 20 Apr 2009 14:10:53 -0500
Subject: [R-sig-Geo] Building rgdal 0.6-7 on Mac
In-Reply-To: <alpine.LRH.2.00.0904202046320.5721@reclus.nhh.no>
References: <419C0C93-121D-40EE-8F21-B81321057864@utsa.edu>
	<alpine.LRH.2.00.0904202046320.5721@reclus.nhh.no>
Message-ID: <18D077D5-ADD1-44A6-B893-821322E0CF21@UTSA.EDU>

Roger,
Here's the strange thing: it works!  I assumed that the error on  
install was fatal and nothing was built, but the bloody thing functions!

The 0.6-5 version I had before was built under 2.8.1, and following  
your suggestion, I tried to install 0.6-5 in R 2.9.0 and it gave the  
same error, but it seems to work alright, I can read in datafiles so  
far.

If I try to install 0.6-7 over 0.6-5 it won't replace the previous  
version because of the error apparently, hence the

ERROR: lazy loading failed for package ?rgdal?
* Removing ?/Library/Frameworks/R.framework/Resources/library/rgdal?
* Restoring previous ?/Library/Frameworks/R.framework/Resources/ 
library/rgdal?

But there is a functional version there.  If I go in and by brute  
force remove the version that is there (say 0.6-5) and run the install  
script for 0.6-7, it installs despite the error.

Thanks for you quick reply

Corey Sparks
Assistant Professor
Department of Demography and Organization Studies
College of Public Policy
One UTSA Circle
San Antonio, TX 78239
corey.sparks 'at' utsa.edu

On Apr 20, 2009, at 1:59 PM, Roger Bivand wrote:

> On Mon, 20 Apr 2009, Corey Sparks wrote:
>
>> Dear list,
>> I've just built my new version of R 2.9.0 and installed my packages.
>>
>>> sessionInfo()
>> R version 2.9.0 Patched (2009-04-20 r48365)
>> i386-apple-darwin9.6.0
>>
>> locale:
>> C
>>
>> attached base packages:
>> [1] stats     graphics  grDevices datasets  utils     methods   base
>>
>>
>> I use rgdal for reading and writing raster data but when I try to  
>> install version 0.6-7 (I already have 0.6-5 installed) from source,  
>> I get an error.
>
> Was 0.6-5 built with R 2.8.1? If you feel like taking risks, please  
> try to see whether installing rgdal_0.6-5 under R 2.9.0 provokes the  
> same problem. Have you tried asking on R-sig-mac - the changes from  
> 0.6-5 to 0.6-7 were very small (a "[" subsetting operation with an  
> omitted drop=FALSE)?
>
> See for example:
>
> http://rgdal.cvs.sourceforge.net/viewvc/rgdal/rgdal/R/sp_gdal.R?r1=1.30&r2=1.31
>
> Nothing there should trigger problems, so I'd look to see whether  
> there is something platform and/or R release related.
>
> On Linux i386 and x86_64, and Windows i386, everything looks OK.
>
> Roger
>
>> I have installed all of the external dependencies (GDAL, PROJ4,  
>> etc) and think I am specifying the installation command correctly.   
>> I have rgdal_0.6-7.tar.gz in my home directory, here is my command
>>
>> R --arch=x86_64 CMD INSTALL rgdal_0.6-7.tar.gz --configure-args='-- 
>> with-gdal-config=/Library/Frameworks/GDAL.framework/Versions/1.6/ 
>> Programs/gdal-config --with-proj-lib=/Library/Frameworks/ 
>> PROJ.framework/Versions/4.6/unix/lib --with-proj-include=/Library/ 
>> Frameworks/PROJ.framework/Versions/4.6/Headers' rgdal_0.6-7.tar.gz
>>
>> Here is what happens: Please forgive the voluminous output.
>>
>> * Installing to library '/Library/Frameworks/R.framework/Resources/ 
>> library'
>> * Installing *source* package 'rgdal' ...
>> gdal-config: /Library/Frameworks/GDAL.framework/Versions/1.6/ 
>> Programs/gdal-config
>> checking for gcc... gcc -arch x86_64 -std=gnu99
>> checking for C compiler default output file name... a.out
>> checking whether the C compiler works... yes
>> checking whether we are cross compiling... no
>> checking for suffix of executables...
>> checking for suffix of object files... o
>> checking whether we are using the GNU C compiler... yes
>> checking whether gcc -arch x86_64 -std=gnu99 accepts -g... yes
>> checking for gcc -arch x86_64 -std=gnu99 option to accept ANSI C...  
>> none needed
>> checking how to run the C preprocessor... gcc -arch x86_64 - 
>> std=gnu99 -E
>> checking for egrep... grep -E
>> checking for ANSI C header files... rm: conftest.dSYM: is a directory
>> rm: conftest.dSYM: is a directory
>> yes
>> checking for sys/types.h... yes
>> checking for sys/stat.h... yes
>> checking for stdlib.h... yes
>> checking for string.h... yes
>> checking for memory.h... yes
>> checking for strings.h... yes
>> checking for inttypes.h... yes
>> checking for stdint.h... yes
>> checking for unistd.h... yes
>> checking proj_api.h usability... yes
>> checking proj_api.h presence... yes
>> checking for proj_api.h... yes
>> checking for pj_init_plus in -lproj... yes
>> Package CPP flags: -I/Library/Frameworks/PROJ.framework/Versions/ 
>> 4.6/Headers -I/Library/Frameworks/GDAL.framework/Versions/1.6/Headers
>> Package LIBS:  -L/Library/Frameworks/PROJ.framework/Versions/4.6/ 
>> unix/lib -L/Library/Frameworks/GDAL.framework/Versions/1.6/unix/lib  
>> -lgdal
>> configure: creating ./config.status
>> config.status: creating src/Makevars
>> ** libs
>> ** arch - x86_64
>> g++ -arch x86_64 -I/Library/Frameworks/R.framework/Resources/ 
>> include -I/Library/Frameworks/R.framework/Resources/include/x86_64 - 
>> I/Library/Frameworks/PROJ.framework/Versions/4.6/Headers -I/Library/ 
>> Frameworks/GDAL.framework/Versions/1.6/Headers -I/usr/local/ 
>> include    -fPIC  -g -O2 -c OGR_write.cpp -o OGR_write.o
>> g++ -arch x86_64 -I/Library/Frameworks/R.framework/Resources/ 
>> include -I/Library/Frameworks/R.framework/Resources/include/x86_64 - 
>> I/Library/Frameworks/PROJ.framework/Versions/4.6/Headers -I/Library/ 
>> Frameworks/GDAL.framework/Versions/1.6/Headers -I/usr/local/ 
>> include    -fPIC  -g -O2 -c gdal-bindings.cpp -o gdal-bindings.o
>> g++ -arch x86_64 -I/Library/Frameworks/R.framework/Resources/ 
>> include -I/Library/Frameworks/R.framework/Resources/include/x86_64 - 
>> I/Library/Frameworks/PROJ.framework/Versions/4.6/Headers -I/Library/ 
>> Frameworks/GDAL.framework/Versions/1.6/Headers -I/usr/local/ 
>> include    -fPIC  -g -O2 -c ogr_geom.cpp -o ogr_geom.o
>> g++ -arch x86_64 -I/Library/Frameworks/R.framework/Resources/ 
>> include -I/Library/Frameworks/R.framework/Resources/include/x86_64 - 
>> I/Library/Frameworks/PROJ.framework/Versions/4.6/Headers -I/Library/ 
>> Frameworks/GDAL.framework/Versions/1.6/Headers -I/usr/local/ 
>> include    -fPIC  -g -O2 -c ogr_proj.cpp -o ogr_proj.o
>> g++ -arch x86_64 -I/Library/Frameworks/R.framework/Resources/ 
>> include -I/Library/Frameworks/R.framework/Resources/include/x86_64 - 
>> I/Library/Frameworks/PROJ.framework/Versions/4.6/Headers -I/Library/ 
>> Frameworks/GDAL.framework/Versions/1.6/Headers -I/usr/local/ 
>> include    -fPIC  -g -O2 -c ogrdrivers.cpp -o ogrdrivers.o
>> g++ -arch x86_64 -I/Library/Frameworks/R.framework/Resources/ 
>> include -I/Library/Frameworks/R.framework/Resources/include/x86_64 - 
>> I/Library/Frameworks/PROJ.framework/Versions/4.6/Headers -I/Library/ 
>> Frameworks/GDAL.framework/Versions/1.6/Headers -I/usr/local/ 
>> include    -fPIC  -g -O2 -c ogrsource.cpp -o ogrsource.o
>> g++ -arch x86_64 -I/Library/Frameworks/R.framework/Resources/ 
>> include -I/Library/Frameworks/R.framework/Resources/include/x86_64 - 
>> I/Library/Frameworks/PROJ.framework/Versions/4.6/Headers -I/Library/ 
>> Frameworks/GDAL.framework/Versions/1.6/Headers -I/usr/local/ 
>> include    -fPIC  -g -O2 -c projectit.cpp -o projectit.o
>> g++ -arch x86_64 -dynamiclib -Wl,-headerpad_max_install_names - 
>> undefined dynamic_lookup -single_module -multiply_defined suppress - 
>> L/usr/local/lib -o rgdal.so OGR_write.o gdal-bindings.o ogr_geom.o  
>> ogr_proj.o ogrdrivers.o ogrsource.o projectit.o -L/Library/ 
>> Frameworks/PROJ.framework/Versions/4.6/unix/lib -L/Library/ 
>> Frameworks/GDAL.framework/Versions/1.6/unix/lib -lgdal -lproj -F/ 
>> Library/Frameworks/R.framework/.. -framework R -Wl,-framework - 
>> Wl,CoreFoundation
>> ** R
>> ** inst
>> ** preparing package for lazy loading
>> ** help
>> *** installing help indices
>>>>> Building/Updating help pages for package 'rgdal'
>>   Formats: text html latex example
>> CRS-class                         text    html    latex   example
>> GDALDataset-class                 text    html    latex
>> GDALDriver-class                  text    html    latex   example
>> GDALMajorObject-class             text    html    latex   example
>> GDALRasterBand-class              text    html    latex   example
>> GDALReadOnlyDataset-class         text    html    latex   example
>> GDALReadOnlyDataset-methods       text    html    latex   example
>> GDALTransientDataset-class        text    html    latex   example
>> RGB2PCT                           text    html    latex   example
>> SGDF2PCT                          text    html    latex   example
>> SpatialGDAL-class                 text    html    latex   example
>> closeDataset-methods              text    html    latex
>> displayDataset                    text    html    latex   example
>> make_EPSG                         text    html    latex   example
>> projInfo                          text    html    latex   example
>> project                           text    html    latex   example
>> readGDAL                          text    html    latex   example
>> readOGR                           text    html    latex   example
>> showWKT                           text    html    latex   example
>> spTransform-methods               text    html    latex   example
>> writeOGR                          text    html    latex   example
>> ** building package indices ...
>> * DONE (rgdal)
>>
>> * Installing *source* package 'rgdal' ...
>> mv: rename /Library/Frameworks/R.framework/Resources/library/rgdal  
>> to /Library/Frameworks/R.framework/Resources/library/00LOCK/rgdal/ 
>> rgdal: Directory not empty
>> gdal-config: /Library/Frameworks/GDAL.framework/Versions/1.6/ 
>> Programs/gdal-config
>> checking for gcc... gcc -arch x86_64 -std=gnu99
>> checking for C compiler default output file name... a.out
>> checking whether the C compiler works... yes
>> checking whether we are cross compiling... no
>> checking for suffix of executables...
>> checking for suffix of object files... o
>> checking whether we are using the GNU C compiler... yes
>> checking whether gcc -arch x86_64 -std=gnu99 accepts -g... yes
>> checking for gcc -arch x86_64 -std=gnu99 option to accept ANSI C...  
>> none needed
>> checking how to run the C preprocessor... gcc -arch x86_64 - 
>> std=gnu99 -E
>> checking for egrep... grep -E
>> checking for ANSI C header files... rm: conftest.dSYM: is a directory
>> rm: conftest.dSYM: is a directory
>> yes
>> checking for sys/types.h... yes
>> checking for sys/stat.h... yes
>> checking for stdlib.h... yes
>> checking for string.h... yes
>> checking for memory.h... yes
>> checking for strings.h... yes
>> checking for inttypes.h... yes
>> checking for stdint.h... yes
>> checking for unistd.h... yes
>> checking proj_api.h usability... yes
>> checking proj_api.h presence... yes
>> checking for proj_api.h... yes
>> checking for pj_init_plus in -lproj... yes
>> Package CPP flags: -I/Library/Frameworks/PROJ.framework/Versions/ 
>> 4.6/Headers -I/Library/Frameworks/GDAL.framework/Versions/1.6/Headers
>> Package LIBS:  -L/Library/Frameworks/PROJ.framework/Versions/4.6/ 
>> unix/lib -L/Library/Frameworks/GDAL.framework/Versions/1.6/unix/lib  
>> -lgdal
>> configure: creating ./config.status
>> config.status: creating src/Makevars
>> ** libs
>> ** arch - x86_64
>> make: Nothing to be done for `all'.
>> ** R
>> ** inst
>> ** preparing package for lazy loading
>> Error in nchar(filename) : element 1 is empty;
>> the part of the args list of '.Internal' being evaluated was:
>> (x, type, allowNA)
>> Error : unable to load R code in package 'rgdal'
>> ERROR: lazy loading failed for package 'rgdal'
>> * Removing '/Library/Frameworks/R.framework/Resources/library/rgdal'
>> * Restoring previous '/Library/Frameworks/R.framework/Resources/ 
>> library/rgdal'
>>
>> Any thoughts would be greatly appreciated.  Thanks
>> Corey
>>
>> Corey Sparks
>> Assistant Professor
>> Department of Demography and Organization Studies
>> University of Texas at San Antonio
>> One UTSA Circle
>> San Antonio, TX 78249
>> 210 458 6858
>> corey.sparks 'at' utsa.edu
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> -- 
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian  
> School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>


From wdmccoy at geo.umass.edu  Mon Apr 20 22:07:07 2009
From: wdmccoy at geo.umass.edu (William McCoy)
Date: Mon, 20 Apr 2009 16:07:07 -0400
Subject: [R-sig-Geo] readVECT6 error in spgrass6 (CVS version)
Message-ID: <49ECD5EB.2050809@geo.umass.edu>

I am trying to duplicate the example of T. Hengl given in his message of 
  2 Apr 2009 regarding "Running analysis on DEMs using GRASS (from R?)". 
  I have retrieved the latest CVS version (as of last night) of spgrass6 
(v. 0.6-5).  I am running on a 32-bit Intel Fedora 10 system.

Everything seems to work up until the point that I try to import the 
streamt vector file into R:

 > streamt <- readVECT6("streamt")
Error in readOGR(dsn, layer = "1", verbose = !ignore.stderr, pointDropZ 
= pointDropZ) :
   unused argument(s) (pointDropZ = FALSE)

Apparently readOGR has no "pointDropZ" argument and the rgdal 
documentation seems to confirm this.  Is this a bug in this CVS version 
of spgrass6?

Here is my sessionInfo():

 > sessionInfo()
R version 2.8.1 (2008-12-22)
i386-redhat-linux-gnu

locale:
LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=C;LC_MESSAGES=en_US.UTF-8;LC_PAPER=en_US.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] spgrass6_0.6-5  XML_2.3-0       rgdal_0.6-7     maptools_0.7-22
[5] sp_0.9-34       foreign_0.8-34

loaded via a namespace (and not attached):
[1] grid_2.8.1      lattice_0.17-22 tools_2.8.1


-- 
William D. McCoy
Geosciences
University of Massachusetts
Amherst, MA 01003


From apineda at dataquick.com  Mon Apr 20 22:31:11 2009
From: apineda at dataquick.com (Adalberto Pineda)
Date: Mon, 20 Apr 2009 13:31:11 -0700
Subject: [R-sig-Geo] Converting Tessellation objects into shape files
In-Reply-To: <49EC0BD0.5080709@maths.uwa.edu.au>
Message-ID: <D53712A05C0B5F44A2F605AF7EB76EFB01178161@sd1ex1.mscorp.com>

Adrian,
Thanks a lot for sharing your script.  I was trying to write my own function but your code 
saved me a lot of time.  It worked just fine.  I just have one question.  I couldn't find
the function is.tess.  Where is it? 
 
-- Adalberto Pineda.


-----Original Message-----
From: Adrian Baddeley [mailto:adrian at maths.uwa.edu.au]
Sent: Sunday, April 19, 2009 10:45 PM
To: Adalberto Pineda; r-sig-geo at stat.math.ethz.ch; Adrian Baddeley
Subject: [R-sig-Geo] Converting Tessellation objects into shape files


Adalberto Pineda <apineda at dataquick.com> writes:

> I was trying to convert an object of class tess generated using the spatstat package into a shape file

Source the code below, and then apply the function 'tess2SP' to your tessellation object. This will convert it to a SpatialPolygons object, which you can then output as a shapefile. 

(This only works if the tessellation is made of polygons or rectangles.)

Adrian Baddeley

-----------------------------------------------------------------------------------------

require(spatstat)
require(sp)

# convert spatstat objects to sp classes

owin2Polygons <- function(x, id="1") {
  stopifnot(is.owin(x))
  x <- as.polygonal(x)
  closering <- function(df) { df[c(seq(nrow(df)), 1), ] }
  pieces <- lapply(x$bdry,
                   function(p) { 
                     Polygon(coords=closering(cbind(p$x,p$y)),
                             hole=is.hole.xypolygon(p))  })
  z <- Polygons(pieces, id)
  return(z)
}

tess2SP <- function(x) {
  stopifnot(is.tess(x))
  y <- tiles(x)
  nom <- names(y)
  z <- list()
  for(i in seq(y))
    z[[i]] <- owin2Polygons(y[[i]], nom[i])
  return(SpatialPolygons(z))
}

owin2SP <- function(x) {
  stopifnot(is.owin(x))
  y <- owin2Polygons(x)
  z <- SpatialPolygons(list(y))
  return(z)
}





This message contains confidential information and is in...{{dropped:5}}


From Roger.Bivand at nhh.no  Mon Apr 20 23:12:40 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 20 Apr 2009 23:12:40 +0200 (CEST)
Subject: [R-sig-Geo] readVECT6 error in spgrass6 (CVS version)
In-Reply-To: <49ECD5EB.2050809@geo.umass.edu>
References: <49ECD5EB.2050809@geo.umass.edu>
Message-ID: <alpine.LRH.2.00.0904202309120.5721@reclus.nhh.no>

On Mon, 20 Apr 2009, William McCoy wrote:

> I am trying to duplicate the example of T. Hengl given in his message of  2 
> Apr 2009 regarding "Running analysis on DEMs using GRASS (from R?)".  I have 
> retrieved the latest CVS version (as of last night) of spgrass6 (v. 0.6-5). 
> I am running on a 32-bit Intel Fedora 10 system.
>
> Everything seems to work up until the point that I try to import the streamt 
> vector file into R:
>
>> streamt <- readVECT6("streamt")
> Error in readOGR(dsn, layer = "1", verbose = !ignore.stderr, pointDropZ = 
> pointDropZ) :
>  unused argument(s) (pointDropZ = FALSE)
>
> Apparently readOGR has no "pointDropZ" argument and the rgdal documentation 
> seems to confirm this.  Is this a bug in this CVS version of spgrass6?

No, but you need the CVS version of rgdal too. The GRASS OGR plugin 
spuriously generates a third coordinate, so that its use in spgrass6, 
using rgdal (readOGR) led to a failure in a later script. The released 
versions of both packages are in sync, to have CVS spgrass6 work, use the 
CVS rgdal (sourceforge project rgdal, module rgdal).

Roger

>
> Here is my sessionInfo():
>
>> sessionInfo()
> R version 2.8.1 (2008-12-22)
> i386-redhat-linux-gnu
>
> locale:
> LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=C;LC_MESSAGES=en_US.UTF-8;LC_PAPER=en_US.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] spgrass6_0.6-5  XML_2.3-0       rgdal_0.6-7     maptools_0.7-22
> [5] sp_0.9-34       foreign_0.8-34
>
> loaded via a namespace (and not attached):
> [1] grid_2.8.1      lattice_0.17-22 tools_2.8.1
>
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From wdmccoy at geo.umass.edu  Mon Apr 20 23:45:30 2009
From: wdmccoy at geo.umass.edu (William McCoy)
Date: Mon, 20 Apr 2009 17:45:30 -0400
Subject: [R-sig-Geo] readVECT6 error in spgrass6 (CVS version)
In-Reply-To: <alpine.LRH.2.00.0904202309120.5721@reclus.nhh.no>
References: <49ECD5EB.2050809@geo.umass.edu>
	<alpine.LRH.2.00.0904202309120.5721@reclus.nhh.no>
Message-ID: <49ECECFA.7060109@geo.umass.edu>

Roger,

Great.  I used the rgdal from CVS and that works fine.

Thanks, Bill


Roger Bivand wrote:
> On Mon, 20 Apr 2009, William McCoy wrote:
> 
>> I am trying to duplicate the example of T. Hengl given in his message 
>> of  2 Apr 2009 regarding "Running analysis on DEMs using GRASS (from 
>> R?)".  I have retrieved the latest CVS version (as of last night) of 
>> spgrass6 (v. 0.6-5). I am running on a 32-bit Intel Fedora 10 system.
>>
>> Everything seems to work up until the point that I try to import the 
>> streamt vector file into R:
>>
>>> streamt <- readVECT6("streamt")
>> Error in readOGR(dsn, layer = "1", verbose = !ignore.stderr, 
>> pointDropZ = pointDropZ) :
>>  unused argument(s) (pointDropZ = FALSE)
>>
>> Apparently readOGR has no "pointDropZ" argument and the rgdal 
>> documentation seems to confirm this.  Is this a bug in this CVS 
>> version of spgrass6?
> 
> No, but you need the CVS version of rgdal too. The GRASS OGR plugin 
> spuriously generates a third coordinate, so that its use in spgrass6, 
> using rgdal (readOGR) led to a failure in a later script. The released 
> versions of both packages are in sync, to have CVS spgrass6 work, use 
> the CVS rgdal (sourceforge project rgdal, module rgdal).
> 
> Roger
> 
>>
>> Here is my sessionInfo():
>>
>>> sessionInfo()
>> R version 2.8.1 (2008-12-22)
>> i386-redhat-linux-gnu
>>
>> locale:
>> LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=C;LC_MESSAGES=en_US.UTF-8;LC_PAPER=en_US.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=C 
>>
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> other attached packages:
>> [1] spgrass6_0.6-5  XML_2.3-0       rgdal_0.6-7     maptools_0.7-22
>> [5] sp_0.9-34       foreign_0.8-34
>>
>> loaded via a namespace (and not attached):
>> [1] grid_2.8.1      lattice_0.17-22 tools_2.8.1
>>
>>
>>
> 

-- 
William D. McCoy
Geosciences
University of Massachusetts
Amherst, MA 01003


From macq at llnl.gov  Mon Apr 20 23:53:05 2009
From: macq at llnl.gov (Don MacQueen)
Date: Mon, 20 Apr 2009 14:53:05 -0700
Subject: [R-sig-Geo] creating polygons
In-Reply-To: <f58db2700904201026n8de839frf72181b90a17b771@mail.gmail.com>
References: <f58db2700904201026n8de839frf72181b90a17b771@mail.gmail.com>
Message-ID: <p06240806c6129ee50469@[128.115.67.9]>

This is a pretty general question, and there are potentially many 
ways to do it.

One way to get started would be to follow the example(s) in the help 
page for the overlay() function in the sp package.

-Don

At 1:26 PM -0400 4/20/09, Alina Sheyman wrote:
>  I have a list of made-up districts and corresponding zip codes. Based on
>that I want to define my own polygons (for each district) and then use them
>to create a map. Does anyone know how I would go about defining these?
>
>thank you
>
>	[[alternative HTML version deleted]]
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at stat.math.ethz.ch
>https:// stat.ethz.ch/mailman/listinfo/r-sig-geo


-- 
--------------------------------------
Don MacQueen
Environmental Protection Department
Lawrence Livermore National Laboratory
Livermore, CA, USA
925-423-1062


From Roger.Bivand at nhh.no  Tue Apr 21 08:40:11 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 21 Apr 2009 08:40:11 +0200 (CEST)
Subject: [R-sig-Geo] readVECT6 error in spgrass6 (CVS version)
In-Reply-To: <49ECECFA.7060109@geo.umass.edu>
References: <49ECD5EB.2050809@geo.umass.edu>
	<alpine.LRH.2.00.0904202309120.5721@reclus.nhh.no>
	<49ECECFA.7060109@geo.umass.edu>
Message-ID: <alpine.LRH.2.00.0904210837190.8302@reclus.nhh.no>

On Mon, 20 Apr 2009, William McCoy wrote:

> Roger,
>
> Great.  I used the rgdal from CVS and that works fine.

The spgrass6 cvs has also been updated to guard against using an argument 
to readOGR in rgdal not present in earlier versions.

Roger

>
> Thanks, Bill
>
>
> Roger Bivand wrote:
>> On Mon, 20 Apr 2009, William McCoy wrote:
>> 
>>> I am trying to duplicate the example of T. Hengl given in his message of 
>>> 2 Apr 2009 regarding "Running analysis on DEMs using GRASS (from R?)".  I 
>>> have retrieved the latest CVS version (as of last night) of spgrass6 (v. 
>>> 0.6-5). I am running on a 32-bit Intel Fedora 10 system.
>>> 
>>> Everything seems to work up until the point that I try to import the 
>>> streamt vector file into R:
>>> 
>>>> streamt <- readVECT6("streamt")
>>> Error in readOGR(dsn, layer = "1", verbose = !ignore.stderr, pointDropZ = 
>>> pointDropZ) :
>>>  unused argument(s) (pointDropZ = FALSE)
>>> 
>>> Apparently readOGR has no "pointDropZ" argument and the rgdal 
>>> documentation seems to confirm this.  Is this a bug in this CVS version of 
>>> spgrass6?
>> 
>> No, but you need the CVS version of rgdal too. The GRASS OGR plugin 
>> spuriously generates a third coordinate, so that its use in spgrass6, using 
>> rgdal (readOGR) led to a failure in a later script. The released versions 
>> of both packages are in sync, to have CVS spgrass6 work, use the CVS rgdal 
>> (sourceforge project rgdal, module rgdal).
>> 
>> Roger
>> 
>>> 
>>> Here is my sessionInfo():
>>> 
>>>> sessionInfo()
>>> R version 2.8.1 (2008-12-22)
>>> i386-redhat-linux-gnu
>>> 
>>> locale:
>>> LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=C;LC_MESSAGES=en_US.UTF-8;LC_PAPER=en_US.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=C 
>>> 
>>> attached base packages:
>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>> 
>>> other attached packages:
>>> [1] spgrass6_0.6-5  XML_2.3-0       rgdal_0.6-7     maptools_0.7-22
>>> [5] sp_0.9-34       foreign_0.8-34
>>> 
>>> loaded via a namespace (and not attached):
>>> [1] grid_2.8.1      lattice_0.17-22 tools_2.8.1
>>> 
>>> 
>>> 
>> 
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From alobolistas at gmail.com  Tue Apr 21 12:37:07 2009
From: alobolistas at gmail.com (Agustin Lobo)
Date: Tue, 21 Apr 2009 12:37:07 +0200
Subject: [R-sig-Geo] image classification in R
In-Reply-To: <89DFD074-2413-4274-86B9-C1014B04AD5F@UTSA.EDU>
References: <EBFB8501-2847-4E75-A1A1-C0559584BEA5@utsa.edu>	<49E8A0F5.1000609@uni-muenster.de>	<37382E8DCB905042969BA78541F65706754292@kwek.ic.uva.nl>	<49E8F0B2.9030400@uni-muenster.de>
	<49E9BF5C.4040102@gmail.com>
	<89DFD074-2413-4274-86B9-C1014B04AD5F@UTSA.EDU>
Message-ID: <49EDA1D3.8060104@gmail.com>

Beware that results yield by hierarchical clustering are very dependent
upon the actual initial subsample,
Agus
Corey Sparks wrote:
> Yes, I've already run into this problem trying to run hclust on a 
> landsat image. I'm on an imac with leopard and 4gb of ram and the 
> distance matrix needed wouldn't fit into memory. I will try the 
> sub-sampling technique. Thank you all for you assistance.
> Corey
> Corey Sparks
> Assistant Professor
> Department of Demography and Organization Studies
> College of Public Policy
> One UTSA Circle
> San Antonio, TX 78239
> corey.sparks 'at' utsa.edu
>
>
>
>
> On Apr 18, 2009, at 6:54 AM, Agustin Lobo wrote:
>
>> In my opinion, and considering that imagery uses to be very large
>> datasets, unless you want to include spatial characteristics, the best
>> is to subsample your imagery with your gis, then import the
>> dataset to R, perform classification with the many tools
>> available, save the centroids (means, sds, covar matrices depending
>> on your method) and then allocate pixels to those centroids in your
>> gis.
>>
>> Images are too large for R
>>
>> Agus
>>
>> Edzer Pebesma wrote:
>>> There's a Task View on clustering, linked from CRAN:
>>>
>>> http://cran.r-project.org/web/views/Cluster.html
>>>
>>> that will lead you to all types of clustering available, including
>>> hierarchical. I don't know how well it will work for large data sets
>>> such as images, as it calls for constructing n x n distance matrices,
>>> with n the number of pixels.
>>> -- 
>>> Edzer
>>>
>>> Hengl, T. wrote:
>>>
>>>> Don't forget that you can also use different types of unsupervised 
>>>> classification methods, such as the fuzzy k-means as implemented in 
>>>> the "kmeans" method.
>>>>
>>>> Here is an example (with landform classes):
>>>> http://spatial-analyst.net/wiki/index.php?title=Analysis_of_DEMs_in_R%2BILWIS/SAGA 
>>>>
>>>>
>>>> If you work with large grids, consider also using R+SAGA:
>>>> https://stat.ethz.ch/pipermail/r-sig-geo/2009-February/005155.html
>>>>
>>>>
>>>> T. Hengl
>>>>
>>>>
>>>>
>>>> -----Original Message-----
>>>> From: r-sig-geo-bounces at stat.math.ethz.ch on behalf of Edzer Pebesma
>>>> Sent: Fri 4/17/2009 5:32 PM
>>>> To: Corey Sparks
>>>> Cc: r-sig-geo at stat.math.ethz.ch
>>>> Subject: Re: [R-sig-Geo] image classification in R
>>>> Corey,
>>>>
>>>> you can use functions lda or qda (in library MASS) for linear or
>>>> quadratic discriminant analysis, respectively, on your training/ground
>>>> truth data, and then use the predict method on the resulting objects,
>>>> passing the bands (you need to convert the SpatialGridDataFrame to a
>>>> data.frame) as newdata to obtain the classified pixels. Make sure that
>>>> the band names have identical name in both cases. Then assign the
>>>> predicted class to the SpatialGridDataFrame and export.
>>>>
>>>> It has never been clear to me whether "maximum likelihood
>>>> classification" in RS refers to lda or qda. Anyway, it's called
>>>> discriminant analysis in the statistical literature.
>>>> -- 
>>>> Edzer
>>>>
>>>>
>>>> Corey Sparks wrote:
>>>>
>>>>> Dear list,
>>>>> I want to do some unsupervised image classification of some landsat
>>>>> imagery, I think I can read in the multi-band rasters using rgdal, 
>>>>> but
>>>>> has anyone tried doing this in R? I am thinking (after looking at
>>>>> documentation for how GRASS and ArcGIS do it) that I need to do an
>>>>> initial hierarchical clustering to define clusters, but does anyone
>>>>> have an idea on how to do a maximum likelihood classification of the
>>>>> imagery? Would a discriminant function approach work? Any advice
>>>>> anyone may have would be greatly appreciated, and i'm very sorry 
>>>>> but I
>>>>> don't have a working example yet.
>>>>> Best
>>>>>
>>>>> Corey
>>>>>
>>>>> Corey Sparks
>>>>> Assistant Professor
>>>>> Department of Demography and Organization Studies
>>>>> University of Texas at San Antonio
>>>>> One UTSA Circle
>>>>> San Antonio, TX 78249
>>>>> 210 458 6858
>>>>> corey.sparks 'at' utsa.edu
>>>>>
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at stat.math.ethz.ch
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>
>>>> ------------------------------------------------------------------------ 
>>>>
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at stat.math.ethz.ch
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>
>>>
>>
>> <alobolistas.vcf>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From alinashe at gmail.com  Tue Apr 21 18:25:13 2009
From: alinashe at gmail.com (Alina Sheyman)
Date: Tue, 21 Apr 2009 12:25:13 -0400
Subject: [R-sig-Geo] creating polygons
In-Reply-To: <p06240806c6129ee50469@128.115.67.9>
References: <f58db2700904201026n8de839frf72181b90a17b771@mail.gmail.com>
	<p06240806c6129ee50469@128.115.67.9>
Message-ID: <f58db2700904210925l4822d013wfaeed92a95a48e66@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090421/114f5231/attachment.pl>

From Roger.Bivand at nhh.no  Tue Apr 21 21:17:29 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 21 Apr 2009 21:17:29 +0200 (CEST)
Subject: [R-sig-Geo] creating polygons
In-Reply-To: <f58db2700904210925l4822d013wfaeed92a95a48e66@mail.gmail.com>
References: <f58db2700904201026n8de839frf72181b90a17b771@mail.gmail.com>
	<p06240806c6129ee50469@128.115.67.9>
	<f58db2700904210925l4822d013wfaeed92a95a48e66@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.0904212114460.9820@reclus.nhh.no>

On Tue, 21 Apr 2009, Alina Sheyman wrote:

> To rephrase my question and explain my problem further
> I have already created a map for revenue by zip code, in the state of
> Massachusetts. To accomplish that I used a shapefile for Massachusetts and a
> dataframe with my revenue/zip codes.
>
> What I am trying to do now is to have the same map done not by zip code, but
> rather by districts, as defined by zip codes.
>
> Basically what I've done was to introduce a new variable "district" into my
> dataset along with a zip code. At the same time my basic state map (by zip)
> still comes from a shape file and I can't introduce a new variable into the
> shape file.
>
>  Does anyone  know if there's any way I can accomplish what I'm trying to
> do or do I basically need to create a new shapefile with districts already
> in the file?

OK, that wasn't too clear before. Look at unionSpatialPolygons() in 
maptools - it will take a vector of districts matching all your zip codes, 
and join together the geometries belonging to each district, dropping 
internal boundaries. The district IDs become the Polygons object IDs. 
There is no data frame in the object, because it isn't obvious how you 
might want to aggregate it.

Hope this helps,

Roger

>
> On Mon, Apr 20, 2009 at 5:53 PM, Don MacQueen <macq at llnl.gov> wrote:
>
>> This is a pretty general question, and there are potentially many ways to
>> do it.
>>
>> One way to get started would be to follow the example(s) in the help page
>> for the overlay() function in the sp package.
>>
>> -Don
>>
>>
>> At 1:26 PM -0400 4/20/09, Alina Sheyman wrote:
>>
>>>  I have a list of made-up districts and corresponding zip codes. Based on
>>> that I want to define my own polygons (for each district) and then use
>>> them
>>> to create a map. Does anyone know how I would go about defining these?
>>>
>>> thank you
>>>
>>>        [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https:// stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>>
>> --
>> --------------------------------------
>> Don MacQueen
>> Environmental Protection Department
>> Lawrence Livermore National Laboratory
>> Livermore, CA, USA
>> 925-423-1062
>> --------------------------------------
>>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From zev at zevross.com  Tue Apr 21 21:19:18 2009
From: zev at zevross.com (Zev Ross)
Date: Tue, 21 Apr 2009 19:19:18 +0000 (UTC)
Subject: [R-sig-Geo] creating polygons
References: <f58db2700904201026n8de839frf72181b90a17b771@mail.gmail.com>
	<p06240806c6129ee50469@128.115.67.9>
	<f58db2700904210925l4822d013wfaeed92a95a48e66@mail.gmail.com>
Message-ID: <loom.20090421T191720-524@post.gmane.org>

Hi Alina,

It sounds like you want to dissolve the zips based on their membership in a
district. If I have that right, then try the function unionSpatialPolygons. The
example from the help is below.

Zev


library(sp)
library(gpclib)
nc1 <- readShapePoly(system.file("shapes/sids.shp", package="maptools")[1],
 proj4string=CRS("+proj=longlat +datum=NAD27"))
lps <- coordinates(nc1)
ID <- cut(lps[,1], quantile(lps[,1]), include.lowest=TRUE)
reg4 <- unionSpatialPolygons(nc1, ID)
sapply(slot(reg4, "polygons"), function(i) slot(i, "ID"))


From Jin.Li at ga.gov.au  Wed Apr 22 02:39:21 2009
From: Jin.Li at ga.gov.au (Jin.Li at ga.gov.au)
Date: Wed, 22 Apr 2009 10:39:21 +1000
Subject: [R-sig-Geo] spplot [SEC=UNCLASSIFIED]
Message-ID: <8D2A822B1C6C2A44ABEB777AA83FA0E32C5D7B6B2E@EXCCR01.agso.gov.au>

Dear all,

I am using spplot to generate some maps. The maps produced are beautiful as shown by the attached file, but I was wondering if it is possible to do the following modifications:
1) change the colour to brown, that is a value 0 corresponding to blank/white, 100 to brown, values in between to lighter browns, something like we can get by brown((0:100)/100); this colour is required for mud by my organisation; and
2) add lat and long on the axes/borders.

Thanks for your help in advance.

Cheers,

Jin
_______________________________________
Jin Li, PhD
Spatial Modeller/Computational Statistician
Marine & Coastal Environment
Geoscience Australia
GPO Box 378, Canberra, ACT 2601, Australia

Ph: 61 (02) 6249 9899; email: jin.li at ga.gov.au<mailto:jin.li at ga.gov.au>
_______________________________________


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090422/fab1159c/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: mud.n.KED.jpeg
Type: image/jpeg
Size: 109702 bytes
Desc: mud.n.KED.jpeg
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090422/fab1159c/attachment.jpeg>

From moliver at udel.edu  Wed Apr 22 02:53:04 2009
From: moliver at udel.edu (Matt Oliver)
Date: Tue, 21 Apr 2009 20:53:04 -0400
Subject: [R-sig-Geo] spplot [SEC=UNCLASSIFIED]
In-Reply-To: <8D2A822B1C6C2A44ABEB777AA83FA0E32C5D7B6B2E@EXCCR01.agso.gov.au>
References: <8D2A822B1C6C2A44ABEB777AA83FA0E32C5D7B6B2E@EXCCR01.agso.gov.au>
Message-ID: <6d4aad460904211753w4446a76dq872984a57f7da941@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090421/5850d2cb/attachment.pl>

From Jin.Li at ga.gov.au  Wed Apr 22 03:00:44 2009
From: Jin.Li at ga.gov.au (Jin.Li at ga.gov.au)
Date: Wed, 22 Apr 2009 11:00:44 +1000
Subject: [R-sig-Geo] spplot [SEC=UNCLASSIFIED]
In-Reply-To: <6d4aad460904211753w4446a76dq872984a57f7da941@mail.gmail.com>
Message-ID: <8D2A822B1C6C2A44ABEB777AA83FA0E32C5D7B6B2F@EXCCR01.agso.gov.au>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090422/049c3b6b/attachment.pl>

From mdsumner at utas.edu.au  Wed Apr 22 03:07:51 2009
From: mdsumner at utas.edu.au (Michael Sumner)
Date: Wed, 22 Apr 2009 11:07:51 +1000
Subject: [R-sig-Geo] spplot [SEC=UNCLASSIFIED]
Message-ID: <200904220107.n3M17pnx004269@corinna.its.utas.edu.au>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090422/02210f8e/attachment.pl>

From Jin.Li at ga.gov.au  Wed Apr 22 03:49:09 2009
From: Jin.Li at ga.gov.au (Jin.Li at ga.gov.au)
Date: Wed, 22 Apr 2009 11:49:09 +1000
Subject: [R-sig-Geo] spplot [SEC=UNCLASSIFIED]
In-Reply-To: <200904220107.n3M17pnx004269@corinna.its.utas.edu.au>
Message-ID: <8D2A822B1C6C2A44ABEB777AA83FA0E32C5D7B6B31@EXCCR01.agso.gov.au>

Thank you very much, Mike. That is very helpful. I got the colour I was after. My data are in lat/long, when I tried degAxis I got:
> degAxis(1)
Error in axis(side, at = at, labels = labels, ...) :
  plot.new has not been called yet
> degAxis(2)
Error in axis(side, at = at, labels = labels, ...) :
  plot.new has not been called yet
It seems degAxis is not working with spplot. Any suggestions? Thanks.
Cheers,
Jin


-----Original Message-----
From: Michael Sumner [mailto:mdsumner at utas.edu.au]
Sent: Wednesday, 22 April 2009 11:08
To: Li Jin
Cc: r-sig-geo at stat.math.ethz.ch
Subject: Re: [R-sig-Geo] spplot [SEC=UNCLASSIFIED]

This examples shows the use of colorRampPalette(grDevices) to create a
color ramp with sp.theme, borrowing from the spplot documentation. See
colors()[grep("brown", colors())]
 to find the browns R already knows about, or generate your own.

  library(lattice)
     trellis.par.set(sp.theme(regions = list(col =
colorRampPalette(c("sandybrown", "brown4")))) )


     data(meuse.grid)
     gridded(meuse.grid)=~x+y
     meuse.grid$g = factor(sample(letters[1:5], 3103,
replace=TRUE),levels=letters[1:10])
     meuse.grid$f = factor(sample(letters[6:10], 3103,
replace=TRUE),levels=letters[1:10])
     spplot(meuse.grid, c("f","g"))

If your data are already in latitude/longitude then just type this to add
the graticule and labels:

degAxis(1)
degAxis(2)

If your data use a different projection there's an example here that
transforms lines from lat/lon to the grid, but it would be more work to
figure out for your case:

http://geography.uoregon.edu/GeogR/examples/maps_examples02.htm
HTH

Regards, Mike.

 ==============Original message text===============
On Wed, 22 Apr 2009 10:39:21 +1000 Jin.Li at ga.gov.au wrote:

Dear all,

I am using spplot to generate some maps. The maps produced are beautiful
as shown by the attached file, but I was wondering if it is possible to
do the following modifications:
1) change the colour to brown, that is a value 0 corresponding to
blank/white, 100 to brown, values in between to lighter browns, something
like we can get by brown((0:100)/100); this colour is required for mud by
my organisation; and
2) add lat and long on the axes/borders.

Thanks for your help in advance.

Cheers,

Jin
_______________________________________
Jin Li, PhD
Spatial Modeller/Computational Statistician
Marine & Coastal Environment
Geoscience Australia
GPO Box 378, Canberra, ACT 2601, Australia

Ph: 61 (02) 6249 9899; email: jin.li at ga.gov.au<mailto:jin.li at ga.gov.au>
_______________________________________


===========End of original message text===========



If it wasn't backed-up, then it wasn't important. ~ Anon sysadmin

Mike Sumner (Phd. Candidate)
http://www.antcrc.utas.edu.au/~mdsumner/ http://www.zoo.utas.edu.au/awru/  IASOS/AWRU
University of Tasmania
Private Bag 80
Hobart Tasmania 7001
AUSTRALIA
Email: mdsumner at utas.edu.au
Phone: 03 6226 1752 (W)
       0408599921   (M)
Fax:   03 6226 2745


From mdsumner at utas.edu.au  Wed Apr 22 03:58:36 2009
From: mdsumner at utas.edu.au (Michael Sumner)
Date: Wed, 22 Apr 2009 11:58:36 +1000
Subject: [R-sig-Geo] spplot [SEC=UNCLASSIFIED]
Message-ID: <200904220158.n3M1waYD005827@corinna.its.utas.edu.au>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090422/2931cb85/attachment.pl>

From manderse at nmsu.edu  Wed Apr 22 05:42:23 2009
From: manderse at nmsu.edu (Mark Andersen)
Date: Tue, 21 Apr 2009 21:42:23 -0600
Subject: [R-sig-Geo] Need an algorithm
Message-ID: <49EE921F.4090207@nmsu.edu>

Many thanks for all the responses to my query regarding identifying 
simulated fire scars and computing their sizes. I received many helpful 
responses, and thankfully no unhelpful ones. It turns out that what I'm 
looking for is called a connected clusters algorithm, and is, as I 
suspected, well-known in percolation theory. Julian Burgos provided some 
code that will do what I need. My next decision will be whether to 
convert Julian's code to Matlab, or to convert my existing Matlab code to R.
Again, my thanks to all!
regards,
Mark A.

-- 
Dr. Mark C. Andersen, Professor
Department of Fish, Wildlife, and Conservation Ecology
New Mexico State University
Las Cruces, NM 88003
575-646-8034
fax: 575-646-1281
web: web.nmsu.edu/~manderse


From Roger.Bivand at nhh.no  Wed Apr 22 08:51:31 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 22 Apr 2009 08:51:31 +0200 (CEST)
Subject: [R-sig-Geo] spplot [SEC=UNCLASSIFIED]
In-Reply-To: <200904220158.n3M1waYD005827@corinna.its.utas.edu.au>
References: <200904220158.n3M1waYD005827@corinna.its.utas.edu.au>
Message-ID: <alpine.LRH.2.00.0904220849260.14737@reclus.nhh.no>

On Wed, 22 Apr 2009, Michael Sumner wrote:

> Ouch - sorry about that, I should have checked.
>
> I don't know how to set axis labels with spplot I'm afraid.

Something like:

library(maptools)
xx <- readShapeSpatial(system.file("shapes/sids.shp", package="maptools")[1],
  IDvar="FIPSNO", proj4string=CRS("+proj=longlat +ellps=clrk66"))
spplot(xx, c("BIR74", "BIR79"), scales=list(draw=TRUE))

Hope this helps,

Roger

>
> Regards, Mike.
>
>
> ==============Original message text===============
> On Wed, 22 Apr 2009 11:49:09 +1000 Jin.Li at ga.gov.au wrote:
>
> Thank you very much, Mike. That is very helpful. I got the colour I was
> after. My data are in lat/long, when I tried degAxis I got:
>> degAxis(1)
> Error in axis(side, at = at, labels = labels, ...) :
>  plot.new has not been called yet
>> degAxis(2)
> Error in axis(side, at = at, labels = labels, ...) :
>  plot.new has not been called yet
> It seems degAxis is not working with spplot. Any suggestions? Thanks.
> Cheers,
> Jin
>
>
> -----Original Message-----
> From: Michael Sumner [mailto:mdsumner at utas.edu.au]
> Sent: Wednesday, 22 April 2009 11:08
> To: Li Jin
> Cc: r-sig-geo at stat.math.ethz.ch
> Subject: Re: [R-sig-Geo] spplot [SEC=UNCLASSIFIED]
>
> This examples shows the use of colorRampPalette(grDevices) to create a
> color ramp with sp.theme, borrowing from the spplot documentation. See
> colors()[grep("brown", colors())]
> to find the browns R already knows about, or generate your own.
>
>  library(lattice)
>     trellis.par.set(sp.theme(regions = list(col =
> colorRampPalette(c("sandybrown", "brown4")))) )
>
>
>     data(meuse.grid)
>     gridded(meuse.grid)=~x+y
>     meuse.grid$g = factor(sample(letters[1:5], 3103,
> replace=TRUE),levels=letters[1:10])
>     meuse.grid$f = factor(sample(letters[6:10], 3103,
> replace=TRUE),levels=letters[1:10])
>     spplot(meuse.grid, c("f","g"))
>
> If your data are already in latitude/longitude then just type this to add
> the graticule and labels:
>
> degAxis(1)
> degAxis(2)
>
> If your data use a different projection there's an example here that
> transforms lines from lat/lon to the grid, but it would be more work to
> figure out for your case:
>
> http://geography.uoregon.edu/GeogR/examples/maps_examples02.htmHTH
>
> Regards, Mike.
>
> ==============Original message text===============
> On Wed, 22 Apr 2009 10:39:21 +1000 Jin.Li at ga.gov.au wrote:
>
> Dear all,
>
> I am using spplot to generate some maps. The maps produced are beautiful
> as shown by the attached file, but I was wondering if it is possible to
> do the following modifications:
> 1) change the colour to brown, that is a value 0 corresponding to
> blank/white, 100 to brown, values in between to lighter browns, something
> like we can get by brown((0:100)/100); this colour is required for mud by
> my organisation; and
> 2) add lat and long on the axes/borders.
>
> Thanks for your help in advance.
>
> Cheers,
>
> Jin
> _______________________________________
> Jin Li, PhD
> Spatial Modeller/Computational Statistician
> Marine & Coastal Environment
> Geoscience Australia
> GPO Box 378, Canberra, ACT 2601, Australia
>
> Ph: 61 (02) 6249 9899; email: jin.li at ga.gov.au<mailto:jin.li at ga.gov.au>
> _______________________________________
>
>
> ===========End of original message text===========
>
>
>
> If it wasn't backed-up, then it wasn't important. ~ Anon sysadmin
>
> Mike Sumner (Phd. Candidate)
> http://www.antcrc.utas.edu.au/~mdsumner/ http://www.zoo.utas.edu.au/awru/  IASOS/AWRUUniversity of Tasmania
> Private Bag 80
> Hobart Tasmania 7001
> AUSTRALIA
> Email: mdsumner at utas.edu.au
> Phone: 03 6226 1752 (W)
>       0408599921   (M)
> Fax:   03 6226 2745
>
>
>
>
>
>
>
>
> ===========End of original message text===========
>
>
>
> If it wasn't backed-up, then it wasn't important. ~ Anon sysadmin
>
> Mike Sumner (Phd. Candidate)
> http://www.antcrc.utas.edu.au/~mdsumner/ http://www.zoo.utas.edu.au/awru/  IASOS/AWRU
> University of Tasmania
> Private Bag 80
> Hobart Tasmania 7001
> AUSTRALIA
> Email: mdsumner at utas.edu.au
> Phone: 03 6226 1752 (W)
>       0408599921   (M)
> Fax:   03 6226 2745
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From alobolistas at gmail.com  Wed Apr 22 09:41:56 2009
From: alobolistas at gmail.com (Agustin Lobo)
Date: Wed, 22 Apr 2009 09:41:56 +0200
Subject: [R-sig-Geo] Problem with sourceforge repository
Message-ID: <49EECA44.3030205@gmail.com>

Hi!
I'm doing as stated in
http://r-spatial.sourceforge.net/

but get:
> rSpatial <- "http://r-spatial.sourceforge.net/R"
> install.packages("spgrass6", repos=rSpatial)
Warning in install.packages("spgrass6", repos = rSpatial) :
   argument 'lib' is missing: using '/usr/local/lib/R/site-library'
Warning message:
In getDependencies(pkgs, dependencies, available, lib) :
   package ?spgrass6? is not available

wrong url for the repo?

Thanks

Agus
-------------- next part --------------
A non-text attachment was scrubbed...
Name: alobolistas.vcf
Type: text/x-vcard
Size: 251 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090422/301b2a60/attachment.vcf>

From Roger.Bivand at nhh.no  Wed Apr 22 10:05:30 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 22 Apr 2009 10:05:30 +0200 (CEST)
Subject: [R-sig-Geo] Problem with sourceforge repository
In-Reply-To: <49EECA44.3030205@gmail.com>
References: <49EECA44.3030205@gmail.com>
Message-ID: <alpine.LRH.2.00.0904220959070.14737@reclus.nhh.no>

On Wed, 22 Apr 2009, Agustin Lobo wrote:

> Hi!
> I'm doing as stated in
> http://r-spatial.sourceforge.net/

We need to take that site down, nothing has been released as an R package 
there for years. Now all of the functionality of released packages is on 
CRAN, and sourceforge is only used as a CVS server by the r-spatial 
project with multiple modules, and rgdal.

To check out the current spgrass6, do:

cvs -z3 \
-d:pserver:anonymous at r-spatial.cvs.sourceforge.net:/cvsroot/r-spatial co \
-P spgrass6

as explained under the more -> code menu on:

http://sourceforge.net/projects/r-spatial/

Roger

>
> but get:
>> rSpatial <- "http://r-spatial.sourceforge.net/R"
>> install.packages("spgrass6", repos=rSpatial)
> Warning in install.packages("spgrass6", repos = rSpatial) :
>  argument 'lib' is missing: using '/usr/local/lib/R/site-library'
> Warning message:
> In getDependencies(pkgs, dependencies, available, lib) :
>  package ?spgrass6? is not available
>
> wrong url for the repo?
>
> Thanks
>
> Agus
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From alobolistas at gmail.com  Wed Apr 22 10:31:55 2009
From: alobolistas at gmail.com (Agustin Lobo)
Date: Wed, 22 Apr 2009 10:31:55 +0200
Subject: [R-sig-Geo] paste(" /"  ") and paste(" /'  ") for grass command
Message-ID: <49EED5FB.2000500@gmail.com>

I wish to write  "" using paste(), but

> paste("\"","Hola","\"",sep="")
[1] "\"Hola\""
>

while the same approach works with ''
> paste("\'","Hola","\'",sep="")
[1] "'Hola'"

why this difference? how could I do it to get "Hola" ?

I need this to write this string in R:
v.extract codigo_Montseny07_clump out=extract11917 where="(GRIDCODE = 
11917)"

and pass it to grass. Something like:
for (i in polis){
    system("g.region vect=codigo_Montseny07_clump")
    nomextract <- paste("extract",i,sep="")
    grcomm <- paste("v.extract codigo_Montseny07_clump out=",nomextract, 
" where=\"(GRIDCODE = ",i,")\" ",sep="")
    system(grcomm)

...

Thanks

Agus
-------------- next part --------------
A non-text attachment was scrubbed...
Name: alobolistas.vcf
Type: text/x-vcard
Size: 251 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090422/f11fa9e9/attachment.vcf>

From horning at amnh.org  Wed Apr 22 10:42:40 2009
From: horning at amnh.org (Ned Horning)
Date: Wed, 22 Apr 2009 11:42:40 +0300
Subject: [R-sig-Geo] image classification in R
In-Reply-To: <EBFB8501-2847-4E75-A1A1-C0559584BEA5@utsa.edu>
References: <EBFB8501-2847-4E75-A1A1-C0559584BEA5@utsa.edu>
Message-ID: <49EED880.3060609@amnh.org>

This may be a stupid question but has anyone tried the unsupervised 
option in Random Forest for unsupervised image classification? I'm not 
sure how that would work.

Ned

Corey Sparks wrote:
> Dear list,
> I want to do some unsupervised image classification of some landsat 
> imagery, I think I can read in the multi-band rasters using rgdal, but 
> has anyone tried doing this in R?  I am thinking (after looking at 
> documentation for how GRASS and ArcGIS do it) that I need to do an 
> initial hierarchical clustering to define clusters, but does anyone 
> have an idea on how to do a maximum likelihood classification of the 
> imagery?  Would a discriminant function approach work?  Any advice 
> anyone may have would be greatly appreciated, and i'm very sorry but I 
> don't have a working example yet.
> Best
>
> Corey
>
> Corey Sparks
> Assistant Professor
> Department of Demography and Organization Studies
> University of Texas at San Antonio
> One UTSA Circle
> San Antonio, TX 78249
> 210 458 6858
> corey.sparks 'at' utsa.edu
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From jaime.garcia at uni-bonn.de  Wed Apr 22 13:35:45 2009
From: jaime.garcia at uni-bonn.de (Jaime R. Garcia Marquez)
Date: Wed, 22 Apr 2009 13:35:45 +0200
Subject: [R-sig-Geo] paste(" /" ") and paste(" /' ") for grass command
In-Reply-To: <49EED5FB.2000500@gmail.com>
References: <49EED5FB.2000500@gmail.com>
Message-ID: <op.ussc5vxe5hcodf@jaimer>

Dear Agustin,

I think that using the script paste("\"","Hola","\"",sep="") will do the  
job anyway. Yes, you would get "\"Hola\"" as a result but when you pass  
the script to GRASS the \ symbol will not be considered and so you will  
get the string you are looking for.

a <- "v.extract codigo_Montseny07_clump"
b <- paste("out=extract", 11917, sep="")
c <- paste("(GRIDCODE = ", 11917, ")", sep="")
c <- paste("where=\"", c, "\"",sep="")

string <- paste(a,b,c, sep=" ")
system(string)

> string
[1] "v.extract codigo_Montseny07_clump out=extract11917 where=\"(GRIDCODE  
= 11917)\""

When the command is read in GRASS the \ symbol will mean move to the next  
line in the console.

Best,

Jaime -R


On Wed, 22 Apr 2009 10:31:55 +0200, Agustin Lobo <alobolistas at gmail.com>  
wrote:

> I wish to write  "" using paste(), but
>
>> paste("\"","Hola","\"",sep="")
> [1] "\"Hola\""
>>
>
> while the same approach works with ''
>> paste("\'","Hola","\'",sep="")
> [1] "'Hola'"
>
> why this difference? how could I do it to get "Hola" ?
>
> I need this to write this string in R:
> v.extract codigo_Montseny07_clump out=extract11917 where="(GRIDCODE =
> 11917)"
>
> and pass it to grass. Something like:
> for (i in polis){
>     system("g.region vect=codigo_Montseny07_clump")
>     nomextract <- paste("extract",i,sep="")
>     grcomm <- paste("v.extract codigo_Montseny07_clump out=",nomextract,
> " where=\"(GRIDCODE = ",i,")\" ",sep="")
>     system(grcomm)
>
> ...
>
> Thanks
>
> Agus


From evans324 at umn.edu  Wed Apr 22 16:35:18 2009
From: evans324 at umn.edu (evans324 at umn.edu)
Date: 22 Apr 2009 09:35:18 -0500
Subject: [R-sig-Geo] error using predict.sarlm
Message-ID: <Prayer.1.0.16.0904220935180.20724@vs-a.tc.umn.edu>

I am encountering difficulties using predict.sarlm to make predictions for 
a SAR lag model generated using lagsarlm and a new dataset. I used the 
following code to do so:

dak_test.10nn.predict <- predict.sarlm(reg_vars_reduced2.10nn.lag, newdata 
= "dak_test_data", listw = dak_test.10nn.listw, zero.policy = TRUE)

When I run this, I get the following error message: "Error in if 
(nrow(newdata) != length(listw$neighbours)) stop("mismatch between newdata 
and spatial weights") : argument is of length zero"

I recognize that there is a problem with my listw object, but am not sure 
how to handle it. I produced the listw using the following code sequence:

dak_test.10nn <- knearneigh(coords, k=10)
dak_test.10nn.nb <- knn2nb(dak_test.10nn, row.names=rn, sym=TRUE)
dak_test.10nn.listw <- nb2listw(dak_test.10nn.nb, zero.policy=TRUE)

Can anyone offer me some guidance in solving this problem? Thanks for your 
help.

Heather Sander


-- 
Heather Sander
Ph.D. Candidate:  Conservation Biology
Office:  305 Ecology & 420 Blegen
Mail:  
University of Minnesota
Dept. of Geography
414 Social Science Bldg.
267 19th Ave. S.
Minneapolis, MN 55455
USA


From Roger.Bivand at nhh.no  Wed Apr 22 16:56:52 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 22 Apr 2009 16:56:52 +0200 (CEST)
Subject: [R-sig-Geo] error using predict.sarlm
In-Reply-To: <Prayer.1.0.16.0904220935180.20724@vs-a.tc.umn.edu>
References: <Prayer.1.0.16.0904220935180.20724@vs-a.tc.umn.edu>
Message-ID: <alpine.LRH.2.00.0904221648220.14737@reclus.nhh.no>

On Wed, 22 Apr 2009, evans324 at umn.edu wrote:

> I am encountering difficulties using predict.sarlm to make predictions for a 
> SAR lag model generated using lagsarlm and a new dataset. I used the 
> following code to do so:
>
> dak_test.10nn.predict <- predict.sarlm(reg_vars_reduced2.10nn.lag, newdata = 
> "dak_test_data", listw = dak_test.10nn.listw, zero.policy = TRUE)

Thanks for providing the verbatim code. If this is the verbatim code, then 
newdata = "dak_test_data" is saying that newdata is not the data.frame 
object called dak_test_data, but a single element character vector - that 
is, nrow("dak_test_data") is NULL. However, this does not trigger the 
error message as such, so it could also be that you wrote newdata = 
dak_test_data, and nrow(dak_test_data) is not equal to 
length(dak_test.10nn.listw) - or here nrow(coords), which is the test.

Hope this helps,

Roger

>
> When I run this, I get the following error message: "Error in if 
> (nrow(newdata) != length(listw$neighbours)) stop("mismatch between newdata 
> and spatial weights") : argument is of length zero"
>
> I recognize that there is a problem with my listw object, but am not sure how 
> to handle it. I produced the listw using the following code sequence:
>
> dak_test.10nn <- knearneigh(coords, k=10)
> dak_test.10nn.nb <- knn2nb(dak_test.10nn, row.names=rn, sym=TRUE)
> dak_test.10nn.listw <- nb2listw(dak_test.10nn.nb, zero.policy=TRUE)
>
> Can anyone offer me some guidance in solving this problem? Thanks for your 
> help.
>
> Heather Sander
>
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From etiennebr at gmail.com  Wed Apr 22 17:01:07 2009
From: etiennebr at gmail.com (Etienne Bellemare Racine)
Date: Wed, 22 Apr 2009 11:01:07 -0400
Subject: [R-sig-Geo] Find incircle of a polygon
Message-ID: <49EF3133.6050908@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090422/e9f1d033/attachment.pl>

From gianni.lavaredo at gmail.com  Wed Apr 22 17:14:32 2009
From: gianni.lavaredo at gmail.com (gianni lavaredo)
Date: Wed, 22 Apr 2009 17:14:32 +0200
Subject: [R-sig-Geo] calculate distance node inside polygon
Message-ID: <518dff330904220814h4c857a4biaaecf922247ff169@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090422/9af9c83b/attachment.pl>

From Roger.Bivand at nhh.no  Wed Apr 22 19:06:06 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 22 Apr 2009 19:06:06 +0200 (CEST)
Subject: [R-sig-Geo] Find incircle of a polygon
In-Reply-To: <49EF3133.6050908@gmail.com>
References: <49EF3133.6050908@gmail.com>
Message-ID: <alpine.LRH.2.00.0904221855480.14737@reclus.nhh.no>

On Wed, 22 Apr 2009, Etienne Bellemare Racine wrote:

> Hi,
> I'm looking for a way to find the largest circle fitting in an irregular
> polygon. This is not the real definition of an incircle (as it has to be
> tangent to all edges, but it's a more synthetic title).
> Spatstat package has an incircle function, but designed for an owin
> class object. Before trying to adapt the function to my needs, so I can
> input a shapefile, I would be happy to get some advices (if any
> available), or another package to look at.

You can read (polygon) shapefiles into SpatialPolygon* objects using 
readShapeSpatial in maptools and readOGR in rgdal. Once there, coerce to 
an owin object with methods in maptools, something like:

x <- readOGR(".", "myshape")
ox <- as(as(x, "SpatialPolygons"), "owin")

should do it, but watch for topology checking in spatstat. Spatstat ships 
with a vignette on using shapefiles, see for an online link:

http://cran.r-project.org/web/packages/spatstat/vignettes/shapefiles.pdf

which is up to date, humourous, and should tell you what you need to know. 
Using the advice there should resolve any topology problems. If you are 
stuck after trying things from there, please follow up on this list.

Hope this helps,

Roger

>
> Thanks,
> Etienne
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Michael.Hoehle at stat.uni-muenchen.de  Wed Apr 22 22:11:20 2009
From: Michael.Hoehle at stat.uni-muenchen.de (=?ISO-8859-1?Q?Michael_H=F6hle?=)
Date: Wed, 22 Apr 2009 22:11:20 +0200
Subject: [R-sig-Geo] [Q]: Converting SpatialPolygons with proj4string to
	spatstat owin
Message-ID: <49EF79E8.2030004@stat.uni-muenchen.de>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1


Dear R-Sig-Geo,

I have a simple -- and probably trivial question -- which originates
from a lack of understanding about projections.

The problem occurs when using maptools to read some shapefile for
Germany (available from http://www.cdc.gov/epiinfo/europe/) in the WGS84
system.

library("maptools")
de <- readShapeSpatial("gm.shp",proj4string=CRS("+proj=longlat
+datum=WGS84 +ellps=WGS84"))

When plotting these data with plot(de) Germany looks nice and normal.
However, when I convert these data to a spatstat "owin":

owin.de <- as(de, "owin")
plot(owin.de)

the projection information appears to be lost, because the map is
distorted now.

Is there an easy way to fix this problem?

Best regards,

Michael

- --
> > sessionInfo()
R version 2.8.1 (2008-12-22)
i386-apple-darwin8.11.1

locale:
C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] rgdal_0.6-7     maps_2.1-0      spatstat_1.15-1 deldir_0.0-7
[5] gpclib_1.4-1    mgcv_1.4-1      maptools_0.7-21 sp_0.9-34
[9] foreign_0.8-29

loaded via a namespace (and not attached):
[1] grid_2.8.1      lattice_0.17-20 tcltk_2.8.1     tools_2.8.1
Warning message:
'DESCRIPTION' file has 'Encoding' field and re-encoding is not possible
> >

- --

Michael H?hle, Ph.D.
Department of Statistics
University of Munich
Ludwigstrasse 33
80539 Munich
Germany

Phone:    +49 89 2180 6404
Fax:      +49 89 2180 5040

Email: hoehle at stat.uni-muenchen.de
Homepage: http://www.stat.uni-muenchen.de/~hoehle
PGP public key id: 0xA9589121

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (Darwin)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iD8DBQFJ73noJenxFqlYkSERAvapAKDNTAxzAr7TFQhkUjqQnBOUvZFogACglyt3
71rdMKt6Hxvy9r0r44VTryQ=
=ks0C
-----END PGP SIGNATURE-----


From evans324 at umn.edu  Wed Apr 22 22:40:59 2009
From: evans324 at umn.edu (evans324 at umn.edu)
Date: 22 Apr 2009 15:40:59 -0500
Subject: [R-sig-Geo] error using predict.sarlm
In-Reply-To: <alpine.LRH.2.00.0904221648220.14737@reclus.nhh.no>
References: <Prayer.1.0.16.0904220935180.20724@vs-a.tc.umn.edu>
	<alpine.LRH.2.00.0904221648220.14737@reclus.nhh.no>
Message-ID: <Prayer.1.0.16.0904221540590.9822@vs-a.tc.umn.edu>

Hi Roger,

Thanks for the response. Unfortunately, I'm still getting the same error 
running predict.sarlm ("Error in if (nrow(newdata) != 
length(listw$neighbours)) stop("mismatch between newdata and spatial 
weights") : argument is of length zero"). Here's what I've done since.

>Thanks for providing the verbatim code. If this is the verbatim code, then 
>newdata = "dak_test_data" is saying that newdata is not the data.frame 
>object called dak_test_data, but a single element character vector - that 
>is, nrow("dak_test_data") is NULL. However, this does not trigger the 
>error message as such, so it could also be that you wrote newdata = 
>dak_test_data, and nrow(dak_test_data) is not equal to 

I removed quotes, but still get the same error. The dak_test_data file was 
imported using readShapePoly. I also tried importing the dataset using 
read.dbf, but still got the same error using the resulting data frame.

> However, this does not trigger the error message as such, so it could 
> also be that you wrote newdata = dak_test_data, and nrow(dak_test_data) 
> is not equal to length(dak_test.10nn.listw) - or here nrow(coords), which 
> is the test.

As you suggested, nrow(dak_test_data)is NULL and thus is not equal to 
length(dak_test.10nn.listw), which equals 3. nrow(coords) = 2255. Here's 
the sequence of code that went into creating these weights:

coords<-coordinates(dak_test_data)
rn<-sapply(slot(dak_test_data, "polygons"), function(x) slot(x, "ID"))
dak_test.10nn <- knearneigh(coords, k=10)
dak_test.10nn.nb <- knn2nb(dak_test.10nn, row.names=rn, sym=TRUE)
dak_test.10nn.listw <- nb2listw(dak_test.10nn.nb, zero.policy=TRUE)

When I ran this using the imported dbf, I used the same weights since I'm 
not aware of a way to create weights without tracing back to a shapefile. 
The data frame in this case had nrow=2255. I still received the same error 
message.

I'd appreciate any help you can offer in solving this problem.  Thanks.

Heather Sander 


-- 
Heather Sander
Ph.D. Candidate:  Conservation Biology
Office:  305 Ecology & 420 Blegen
Mail:  
University of Minnesota
Dept. of Geography
414 Social Science Bldg.
267 19th Ave. S.
Minneapolis, MN 55455
USA


From etiennebr at gmail.com  Wed Apr 22 22:51:26 2009
From: etiennebr at gmail.com (Etienne Bellemare Racine)
Date: Wed, 22 Apr 2009 16:51:26 -0400
Subject: [R-sig-Geo] Find incircle of a polygon
In-Reply-To: <alpine.LRH.2.00.0904221855480.14737@reclus.nhh.no>
References: <49EF3133.6050908@gmail.com>
	<alpine.LRH.2.00.0904221855480.14737@reclus.nhh.no>
Message-ID: <49EF834E.60606@gmail.com>

Thanks Roger it helped me a lot.
Now I would like to iteratively find the incircle in a polygon until a 
certain radii (i.e. as if I was stuffing balls in my polygon, from the 
biggest to the smallest). So I have to subtract that circle to my polygon.
Should I subtract it from my polygon by adding an inside loop (setting 
hole to TRUE, is it that simple) or can I substract it directly from the 
owin object ?

Thanks,
Etienne

Roger Bivand a ?crit :
> On Wed, 22 Apr 2009, Etienne Bellemare Racine wrote:
>
>> Hi,
>> I'm looking for a way to find the largest circle fitting in an irregular
>> polygon. This is not the real definition of an incircle (as it has to be
>> tangent to all edges, but it's a more synthetic title).
>> Spatstat package has an incircle function, but designed for an owin
>> class object. Before trying to adapt the function to my needs, so I can
>> input a shapefile, I would be happy to get some advices (if any
>> available), or another package to look at.
>
> You can read (polygon) shapefiles into SpatialPolygon* objects using 
> readShapeSpatial in maptools and readOGR in rgdal. Once there, coerce 
> to an owin object with methods in maptools, something like:
>
> x <- readOGR(".", "myshape")
> ox <- as(as(x, "SpatialPolygons"), "owin")
>
> should do it, but watch for topology checking in spatstat. Spatstat 
> ships with a vignette on using shapefiles, see for an online link:
>
> http://cran.r-project.org/web/packages/spatstat/vignettes/shapefiles.pdf
>
> which is up to date, humourous, and should tell you what you need to 
> know. Using the advice there should resolve any topology problems. If 
> you are stuck after trying things from there, please follow up on this 
> list.
>
> Hope this helps,
>
> Roger
>
>>
>> Thanks,
>> Etienne
>>
>>     [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>


From adam.okulicz.kozaryn at gmail.com  Thu Apr 23 02:20:50 2009
From: adam.okulicz.kozaryn at gmail.com (Adam Okulicz-Kozaryn)
Date: Wed, 22 Apr 2009 20:20:50 -0400
Subject: [R-sig-Geo] spdep: stsls; tot.solve=1e-12
Message-ID: <3c75698d0904221720g7629780cna79cd6b03511841e@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090422/56fe74e8/attachment.pl>

From Jin.Li at ga.gov.au  Thu Apr 23 04:06:19 2009
From: Jin.Li at ga.gov.au (Jin.Li at ga.gov.au)
Date: Thu, 23 Apr 2009 12:06:19 +1000
Subject: [R-sig-Geo] spplot [SEC=UNCLASSIFIED]
In-Reply-To: <alpine.LRH.2.00.0904220849260.14737@reclus.nhh.no>
Message-ID: <8D2A822B1C6C2A44ABEB777AA83FA0E32C5D7B6B3A@EXCCR01.agso.gov.au>

Dear Roger and Mike,
Thank you very much for your kind help. Now I have basically achieved what I initially planned. Here is the code used for plotting the attached map.

library(maptools)
pred.mud.ked<-read.table("mud.ked.csv", sep=",", header=TRUE)
par (font.axis=2, font.lab=2)
coordinates(pred.mud.ked) = ~LON+LAT
gridded(pred.mud.ked)<-TRUE
jpeg("mud.n.ked100.2.jpeg", width=670, height=670, quality=100)
trellis.par.set(sp.theme(regions = list(col = colorRampPalette(c("lightyellow", "saddlebrown")))) )
spplot(pred.mud.ked, c("bt.pred"), scales=list(draw=T), xlab=expression("Longitude"^o), ylab=expression("Latitude"^o),
    main = list("Predicted mud distribution in northern Australian EEZ area using KED", cex=1, col="black", font=2))
dev.off()
detach(package:maptools)

Now I have two other questions.
1. Given that the data range is between 0(%) to 100(%), but the scale bar shows a range beyond this data range, how could I make it start from 0(%) to 100(%) and also add unit (i.e. %) to the scale bar?
2. The text adjacent to axes only show a number without degree symbol and E or S, how to add these and make the text adjacent to axes look like http://r-spatial.sourceforge.net/gallery/#fig09.R?
Any help is greatly appreciated.
Cheers,
Jin

-----Original Message-----
From: Roger Bivand [mailto:Roger.Bivand at nhh.no]
Sent: Wednesday, 22 April 2009 4:52 PM
To: Li Jin
Cc: Michael Sumner; r-sig-geo at stat.math.ethz.ch
Subject: Re: [R-sig-Geo] spplot [SEC=UNCLASSIFIED]

On Wed, 22 Apr 2009, Michael Sumner wrote:

> Ouch - sorry about that, I should have checked.
>
> I don't know how to set axis labels with spplot I'm afraid.

Something like:

library(maptools)
xx <- readShapeSpatial(system.file("shapes/sids.shp", package="maptools")[1],
  IDvar="FIPSNO", proj4string=CRS("+proj=longlat +ellps=clrk66"))
spplot(xx, c("BIR74", "BIR79"), scales=list(draw=TRUE))

Hope this helps,

Roger

>
> Regards, Mike.
>
>
> ==============Original message text===============
> On Wed, 22 Apr 2009 11:49:09 +1000 Jin.Li at ga.gov.au wrote:
>
> Thank you very much, Mike. That is very helpful. I got the colour I was
> after. My data are in lat/long, when I tried degAxis I got:
>> degAxis(1)
> Error in axis(side, at = at, labels = labels, ...) :
>  plot.new has not been called yet
>> degAxis(2)
> Error in axis(side, at = at, labels = labels, ...) :
>  plot.new has not been called yet
> It seems degAxis is not working with spplot. Any suggestions? Thanks.
> Cheers,
> Jin
>
>
> -----Original Message-----
> From: Michael Sumner [mailto:mdsumner at utas.edu.au]
> Sent: Wednesday, 22 April 2009 11:08
> To: Li Jin
> Cc: r-sig-geo at stat.math.ethz.ch
> Subject: Re: [R-sig-Geo] spplot [SEC=UNCLASSIFIED]
>
> This examples shows the use of colorRampPalette(grDevices) to create a
> color ramp with sp.theme, borrowing from the spplot documentation. See
> colors()[grep("brown", colors())]
> to find the browns R already knows about, or generate your own.
>
>  library(lattice)
>     trellis.par.set(sp.theme(regions = list(col =
> colorRampPalette(c("sandybrown", "brown4")))) )
>
>
>     data(meuse.grid)
>     gridded(meuse.grid)=~x+y
>     meuse.grid$g = factor(sample(letters[1:5], 3103,
> replace=TRUE),levels=letters[1:10])
>     meuse.grid$f = factor(sample(letters[6:10], 3103,
> replace=TRUE),levels=letters[1:10])
>     spplot(meuse.grid, c("f","g"))
>
> If your data are already in latitude/longitude then just type this to add
> the graticule and labels:
>
> degAxis(1)
> degAxis(2)
>
> If your data use a different projection there's an example here that
> transforms lines from lat/lon to the grid, but it would be more work to
> figure out for your case:
>
> http://geography.uoregon.edu/GeogR/examples/maps_examples02.htmHTH
>
> Regards, Mike.
>
> ==============Original message text===============
> On Wed, 22 Apr 2009 10:39:21 +1000 Jin.Li at ga.gov.au wrote:
>
> Dear all,
>
> I am using spplot to generate some maps. The maps produced are beautiful
> as shown by the attached file, but I was wondering if it is possible to
> do the following modifications:
> 1) change the colour to brown, that is a value 0 corresponding to
> blank/white, 100 to brown, values in between to lighter browns, something
> like we can get by brown((0:100)/100); this colour is required for mud by
> my organisation; and
> 2) add lat and long on the axes/borders.
>
> Thanks for your help in advance.
>
> Cheers,
>
> Jin
> _______________________________________
> Jin Li, PhD
> Spatial Modeller/Computational Statistician
> Marine & Coastal Environment
> Geoscience Australia
> GPO Box 378, Canberra, ACT 2601, Australia
>
> Ph: 61 (02) 6249 9899; email: jin.li at ga.gov.au<mailto:jin.li at ga.gov.au>
> _______________________________________
>
>
> ===========End of original message text===========
>
>
>
> If it wasn't backed-up, then it wasn't important. ~ Anon sysadmin
>
> Mike Sumner (Phd. Candidate)
> http://www.antcrc.utas.edu.au/~mdsumner/ http://www.zoo.utas.edu.au/awru/  IASOS/AWRUUniversity of Tasmania
> Private Bag 80
> Hobart Tasmania 7001
> AUSTRALIA
> Email: mdsumner at utas.edu.au
> Phone: 03 6226 1752 (W)
>       0408599921   (M)
> Fax:   03 6226 2745
>
>
>
>
>
>
>
>
> ===========End of original message text===========
>
>
>
> If it wasn't backed-up, then it wasn't important. ~ Anon sysadmin
>
> Mike Sumner (Phd. Candidate)
> http://www.antcrc.utas.edu.au/~mdsumner/ http://www.zoo.utas.edu.au/awru/  IASOS/AWRU
> University of Tasmania
> Private Bag 80
> Hobart Tasmania 7001
> AUSTRALIA
> Email: mdsumner at utas.edu.au
> Phone: 03 6226 1752 (W)
>       0408599921   (M)
> Fax:   03 6226 2745
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

--
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

-------------- next part --------------
A non-text attachment was scrubbed...
Name: mud.n.ked100.2.jpeg
Type: image/jpeg
Size: 102634 bytes
Desc: mud.n.ked100.2.jpeg
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090423/8ef5a8a7/attachment.jpeg>

From alobolistas at gmail.com  Thu Apr 23 06:54:43 2009
From: alobolistas at gmail.com (Agustin Lobo)
Date: Thu, 23 Apr 2009 06:54:43 +0200
Subject: [R-sig-Geo] paste(" /" ") and paste(" /' ") for grass command
In-Reply-To: <op.ussc5vxe5hcodf@jaimer>
References: <49EED5FB.2000500@gmail.com> <op.ussc5vxe5hcodf@jaimer>
Message-ID: <49EFF493.2010803@gmail.com>

True. Also, actually grass accepts where='(GRIDCODE = 11917)', so the 
practical problem is solved.
Nevertheless, I find odd the different behavior of

paste("\"","Hola","\"",sep="")
and
paste("\'","Hola","\'",sep="")

the former printing the \
while the second one does not.

Thanks!

Agus

Jaime R. Garcia Marquez wrote:
> Dear Agustin,
>
> I think that using the script paste("\"","Hola","\"",sep="") will do 
> the job anyway. Yes, you would get "\"Hola\"" as a result but when you 
> pass the script to GRASS the \ symbol will not be considered and so 
> you will get the string you are looking for.
>
> a <- "v.extract codigo_Montseny07_clump"
> b <- paste("out=extract", 11917, sep="")
> c <- paste("(GRIDCODE = ", 11917, ")", sep="")
> c <- paste("where=\"", c, "\"",sep="")
>
> string <- paste(a,b,c, sep=" ")
> system(string)
>
>> string
> [1] "v.extract codigo_Montseny07_clump out=extract11917 
> where=\"(GRIDCODE = 11917)\""
>
> When the command is read in GRASS the \ symbol will mean move to the 
> next line in the console.
>
> Best,
>
> Jaime -R
>
>
> On Wed, 22 Apr 2009 10:31:55 +0200, Agustin Lobo 
> <alobolistas at gmail.com> wrote:
>
>> I wish to write "" using paste(), but
>>
>>> paste("\"","Hola","\"",sep="")
>> [1] "\"Hola\""
>>>
>>
>> while the same approach works with ''
>>> paste("\'","Hola","\'",sep="")
>> [1] "'Hola'"
>>
>> why this difference? how could I do it to get "Hola" ?
>>
>> I need this to write this string in R:
>> v.extract codigo_Montseny07_clump out=extract11917 where="(GRIDCODE =
>> 11917)"
>>
>> and pass it to grass. Something like:
>> for (i in polis){
>> system("g.region vect=codigo_Montseny07_clump")
>> nomextract <- paste("extract",i,sep="")
>> grcomm <- paste("v.extract codigo_Montseny07_clump out=",nomextract,
>> " where=\"(GRIDCODE = ",i,")\" ",sep="")
>> system(grcomm)
>>
>> ...
>>
>> Thanks
>>
>> Agus
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-------------- next part --------------
A non-text attachment was scrubbed...
Name: alobolistas.vcf
Type: text/x-vcard
Size: 251 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090423/a8198f9e/attachment.vcf>

From edzer.pebesma at uni-muenster.de  Thu Apr 23 08:07:30 2009
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 23 Apr 2009 08:07:30 +0200
Subject: [R-sig-Geo] spplot [SEC=UNCLASSIFIED]
In-Reply-To: <8D2A822B1C6C2A44ABEB777AA83FA0E32C5D7B6B3A@EXCCR01.agso.gov.au>
References: <8D2A822B1C6C2A44ABEB777AA83FA0E32C5D7B6B3A@EXCCR01.agso.gov.au>
Message-ID: <49F005A2.6060303@uni-muenster.de>

Dear Jin, the

  ..., scales=list(draw=T), ...

only prints the degree E and degree S on the axis tic marks when it is convinced the data are in long lat. Use 

  proj4string(pred.mud.ked) <- "+proj=longlat" 

maybe with the right datum, to set this for pred.mud.ked; in principle you could set it early on in your analysis and it should propagate. Be aware that interpolation in gstat will do something different when it finds out that data are in degrees, as it can no longer use coordinates "easily" to compute Euclidian distances.

To change the colorkey, read the help of function levelplot in package lattice, in particular argument colorkey.
--
Edzer


Jin.Li at ga.gov.au wrote:
> Dear Roger and Mike,
> Thank you very much for your kind help. Now I have basically achieved what I initially planned. Here is the code used for plotting the attached map.
>
> library(maptools)
> pred.mud.ked<-read.table("mud.ked.csv", sep=",", header=TRUE)
> par (font.axis=2, font.lab=2)
> coordinates(pred.mud.ked) = ~LON+LAT
> gridded(pred.mud.ked)<-TRUE
> jpeg("mud.n.ked100.2.jpeg", width=670, height=670, quality=100)
> trellis.par.set(sp.theme(regions = list(col = colorRampPalette(c("lightyellow", "saddlebrown")))) )
> spplot(pred.mud.ked, c("bt.pred"), scales=list(draw=T), xlab=expression("Longitude"^o), ylab=expression("Latitude"^o),
>     main = list("Predicted mud distribution in northern Australian EEZ area using KED", cex=1, col="black", font=2))
> dev.off()
> detach(package:maptools)
>
> Now I have two other questions.
> 1. Given that the data range is between 0(%) to 100(%), but the scale bar shows a range beyond this data range, how could I make it start from 0(%) to 100(%) and also add unit (i.e. %) to the scale bar?
> 2. The text adjacent to axes only show a number without degree symbol and E or S, how to add these and make the text adjacent to axes look like http://r-spatial.sourceforge.net/gallery/#fig09.R?
> Any help is greatly appreciated.
> Cheers,
> Jin
>
> -----Original Message-----
> From: Roger Bivand [mailto:Roger.Bivand at nhh.no]
> Sent: Wednesday, 22 April 2009 4:52 PM
> To: Li Jin
> Cc: Michael Sumner; r-sig-geo at stat.math.ethz.ch
> Subject: Re: [R-sig-Geo] spplot [SEC=UNCLASSIFIED]
>
> On Wed, 22 Apr 2009, Michael Sumner wrote:
>
>   
>> Ouch - sorry about that, I should have checked.
>>
>> I don't know how to set axis labels with spplot I'm afraid.
>>     
>
> Something like:
>
> library(maptools)
> xx <- readShapeSpatial(system.file("shapes/sids.shp", package="maptools")[1],
>   IDvar="FIPSNO", proj4string=CRS("+proj=longlat +ellps=clrk66"))
> spplot(xx, c("BIR74", "BIR79"), scales=list(draw=TRUE))
>
> Hope this helps,
>
> Roger
>
>   
>> Regards, Mike.
>>
>>
>> ==============Original message text===============
>> On Wed, 22 Apr 2009 11:49:09 +1000 Jin.Li at ga.gov.au wrote:
>>
>> Thank you very much, Mike. That is very helpful. I got the colour I was
>> after. My data are in lat/long, when I tried degAxis I got:
>>     
>>> degAxis(1)
>>>       
>> Error in axis(side, at = at, labels = labels, ...) :
>>  plot.new has not been called yet
>>     
>>> degAxis(2)
>>>       
>> Error in axis(side, at = at, labels = labels, ...) :
>>  plot.new has not been called yet
>> It seems degAxis is not working with spplot. Any suggestions? Thanks.
>> Cheers,
>> Jin
>>
>>
>> -----Original Message-----
>> From: Michael Sumner [mailto:mdsumner at utas.edu.au]
>> Sent: Wednesday, 22 April 2009 11:08
>> To: Li Jin
>> Cc: r-sig-geo at stat.math.ethz.ch
>> Subject: Re: [R-sig-Geo] spplot [SEC=UNCLASSIFIED]
>>
>> This examples shows the use of colorRampPalette(grDevices) to create a
>> color ramp with sp.theme, borrowing from the spplot documentation. See
>> colors()[grep("brown", colors())]
>> to find the browns R already knows about, or generate your own.
>>
>>  library(lattice)
>>     trellis.par.set(sp.theme(regions = list(col =
>> colorRampPalette(c("sandybrown", "brown4")))) )
>>
>>
>>     data(meuse.grid)
>>     gridded(meuse.grid)=~x+y
>>     meuse.grid$g = factor(sample(letters[1:5], 3103,
>> replace=TRUE),levels=letters[1:10])
>>     meuse.grid$f = factor(sample(letters[6:10], 3103,
>> replace=TRUE),levels=letters[1:10])
>>     spplot(meuse.grid, c("f","g"))
>>
>> If your data are already in latitude/longitude then just type this to add
>> the graticule and labels:
>>
>> degAxis(1)
>> degAxis(2)
>>
>> If your data use a different projection there's an example here that
>> transforms lines from lat/lon to the grid, but it would be more work to
>> figure out for your case:
>>
>> http://geography.uoregon.edu/GeogR/examples/maps_examples02.htmHTH
>>
>> Regards, Mike.
>>
>> ==============Original message text===============
>> On Wed, 22 Apr 2009 10:39:21 +1000 Jin.Li at ga.gov.au wrote:
>>
>> Dear all,
>>
>> I am using spplot to generate some maps. The maps produced are beautiful
>> as shown by the attached file, but I was wondering if it is possible to
>> do the following modifications:
>> 1) change the colour to brown, that is a value 0 corresponding to
>> blank/white, 100 to brown, values in between to lighter browns, something
>> like we can get by brown((0:100)/100); this colour is required for mud by
>> my organisation; and
>> 2) add lat and long on the axes/borders.
>>
>> Thanks for your help in advance.
>>
>> Cheers,
>>
>> Jin
>> _______________________________________
>> Jin Li, PhD
>> Spatial Modeller/Computational Statistician
>> Marine & Coastal Environment
>> Geoscience Australia
>> GPO Box 378, Canberra, ACT 2601, Australia
>>
>> Ph: 61 (02) 6249 9899; email: jin.li at ga.gov.au<mailto:jin.li at ga.gov.au>
>> _______________________________________
>>
>>
>> ===========End of original message text===========
>>
>>
>>
>> If it wasn't backed-up, then it wasn't important. ~ Anon sysadmin
>>
>> Mike Sumner (Phd. Candidate)
>> http://www.antcrc.utas.edu.au/~mdsumner/ http://www.zoo.utas.edu.au/awru/  IASOS/AWRUUniversity of Tasmania
>> Private Bag 80
>> Hobart Tasmania 7001
>> AUSTRALIA
>> Email: mdsumner at utas.edu.au
>> Phone: 03 6226 1752 (W)
>>       0408599921   (M)
>> Fax:   03 6226 2745
>>
>>
>>
>>
>>
>>
>>
>>
>> ===========End of original message text===========
>>
>>
>>
>> If it wasn't backed-up, then it wasn't important. ~ Anon sysadmin
>>
>> Mike Sumner (Phd. Candidate)
>> http://www.antcrc.utas.edu.au/~mdsumner/ http://www.zoo.utas.edu.au/awru/  IASOS/AWRU
>> University of Tasmania
>> Private Bag 80
>> Hobart Tasmania 7001
>> AUSTRALIA
>> Email: mdsumner at utas.edu.au
>> Phone: 03 6226 1752 (W)
>>       0408599921   (M)
>> Fax:   03 6226 2745
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>     
>
> --
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
>   
>
> ------------------------------------------------------------------------
>
> ------------------------------------------------------------------------
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de/
http://www.springer.com/978-0-387-78170-9 e.pebesma at wwu.de


From Roger.Bivand at nhh.no  Thu Apr 23 08:14:16 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 23 Apr 2009 08:14:16 +0200 (CEST)
Subject: [R-sig-Geo] [Q]: Converting SpatialPolygons with proj4string to
 spatstat owin
In-Reply-To: <49EF79E8.2030004@stat.uni-muenchen.de>
References: <49EF79E8.2030004@stat.uni-muenchen.de>
Message-ID: <alpine.LRH.2.00.0904230806390.27708@reclus.nhh.no>

On Wed, 22 Apr 2009, Michael H?hle wrote:

> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
>
>
> Dear R-Sig-Geo,
>
> I have a simple -- and probably trivial question -- which originates
> from a lack of understanding about projections.
>
> The problem occurs when using maptools to read some shapefile for
> Germany (available from http://www.cdc.gov/epiinfo/europe/) in the WGS84
> system.
>
> library("maptools")
> de <- readShapeSpatial("gm.shp",proj4string=CRS("+proj=longlat
> +datum=WGS84 +ellps=WGS84"))
>
> When plotting these data with plot(de) Germany looks nice and normal.
> However, when I convert these data to a spatstat "owin":
>
> owin.de <- as(de, "owin")
> plot(owin.de)

The plot method for Spatial* objects looks to see whether the geometries 
are in geographical coordinates. If they are, it applies a correction to 
the y axis depending on the distance from the Equator. You can get the 
spatstat look by fixing the aspect to 1 in plot(de, asp=1), overriding the 
adjustment.

>
> the projection information appears to be lost, because the map is
> distorted now.
>
> Is there an easy way to fix this problem?

Project the geometries to the plane (spTransform methods in rgdal).

Hope this helps,

Roger

>
> Best regards,
>
> Michael
>
> - --
>>> sessionInfo()
> R version 2.8.1 (2008-12-22)
> i386-apple-darwin8.11.1
>
> locale:
> C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] rgdal_0.6-7     maps_2.1-0      spatstat_1.15-1 deldir_0.0-7
> [5] gpclib_1.4-1    mgcv_1.4-1      maptools_0.7-21 sp_0.9-34
> [9] foreign_0.8-29
>
> loaded via a namespace (and not attached):
> [1] grid_2.8.1      lattice_0.17-20 tcltk_2.8.1     tools_2.8.1
> Warning message:
> 'DESCRIPTION' file has 'Encoding' field and re-encoding is not possible
>>>
>
> - --
>
> Michael H?hle, Ph.D.
> Department of Statistics
> University of Munich
> Ludwigstrasse 33
> 80539 Munich
> Germany
>
> Phone:    +49 89 2180 6404
> Fax:      +49 89 2180 5040
>
> Email: hoehle at stat.uni-muenchen.de
> Homepage: http://www.stat.uni-muenchen.de/~hoehle
> PGP public key id: 0xA9589121
>
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v1.4.6 (Darwin)
> Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
>
> iD8DBQFJ73noJenxFqlYkSERAvapAKDNTAxzAr7TFQhkUjqQnBOUvZFogACglyt3
> 71rdMKt6Hxvy9r0r44VTryQ=
> =ks0C
> -----END PGP SIGNATURE-----
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From Jin.Li at ga.gov.au  Thu Apr 23 09:20:39 2009
From: Jin.Li at ga.gov.au (Jin.Li at ga.gov.au)
Date: Thu, 23 Apr 2009 17:20:39 +1000
Subject: [R-sig-Geo] spplot [SEC=UNCLASSIFIED]
In-Reply-To: <49F005A2.6060303@uni-muenster.de>
Message-ID: <8D2A822B1C6C2A44ABEB777AA83FA0E32C5D7B6B3C@EXCCR01.agso.gov.au>

Thank you, Edzer.
My second question bas been solved by using:
proj4string(pred.mud.ked) <- CRS("+proj=longlat +datum=WGS84")

For the first question, I have checked ?levelplot, but found no clue to do what I intended. Thanks for any further help.
Cheers,
Jin


-----Original Message-----
From: Edzer Pebesma [mailto:edzer.pebesma at uni-muenster.de]
Sent: Thursday, 23 April 2009 4:08 PM
To: Li Jin
Cc: Roger.Bivand at nhh.no; r-sig-geo at stat.math.ethz.ch
Subject: Re: [R-sig-Geo] spplot [SEC=UNCLASSIFIED]

Dear Jin, the

  ..., scales=list(draw=T), ...

only prints the degree E and degree S on the axis tic marks when it is convinced the data are in long lat. Use

  proj4string(pred.mud.ked) <- "+proj=longlat"

maybe with the right datum, to set this for pred.mud.ked; in principle you could set it early on in your analysis and it should propagate. Be aware that interpolation in gstat will do something different when it finds out that data are in degrees, as it can no longer use coordinates "easily" to compute Euclidian distances.

To change the colorkey, read the help of function levelplot in package lattice, in particular argument colorkey.
--
Edzer


Jin.Li at ga.gov.au wrote:
> Dear Roger and Mike,
> Thank you very much for your kind help. Now I have basically achieved what I initially planned. Here is the code used for plotting the attached map.
>
> library(maptools)
> pred.mud.ked<-read.table("mud.ked.csv", sep=",", header=TRUE)
> par (font.axis=2, font.lab=2)
> coordinates(pred.mud.ked) = ~LON+LAT
> gridded(pred.mud.ked)<-TRUE
> jpeg("mud.n.ked100.2.jpeg", width=670, height=670, quality=100)
> trellis.par.set(sp.theme(regions = list(col = colorRampPalette(c("lightyellow", "saddlebrown")))) )
> spplot(pred.mud.ked, c("bt.pred"), scales=list(draw=T), xlab=expression("Longitude"^o), ylab=expression("Latitude"^o),
>     main = list("Predicted mud distribution in northern Australian EEZ area using KED", cex=1, col="black", font=2))
> dev.off()
> detach(package:maptools)
>
> Now I have two other questions.
> 1. Given that the data range is between 0(%) to 100(%), but the scale bar shows a range beyond this data range, how could I make it start from 0(%) to 100(%) and also add unit (i.e. %) to the scale bar?
> 2. The text adjacent to axes only show a number without degree symbol and E or S, how to add these and make the text adjacent to axes look like http://r-spatial.sourceforge.net/gallery/#fig09.R?
> Any help is greatly appreciated.
> Cheers,
> Jin
>
> -----Original Message-----
> From: Roger Bivand [mailto:Roger.Bivand at nhh.no]
> Sent: Wednesday, 22 April 2009 4:52 PM
> To: Li Jin
> Cc: Michael Sumner; r-sig-geo at stat.math.ethz.ch
> Subject: Re: [R-sig-Geo] spplot [SEC=UNCLASSIFIED]
>
> On Wed, 22 Apr 2009, Michael Sumner wrote:
>
>
>> Ouch - sorry about that, I should have checked.
>>
>> I don't know how to set axis labels with spplot I'm afraid.
>>
>
> Something like:
>
> library(maptools)
> xx <- readShapeSpatial(system.file("shapes/sids.shp", package="maptools")[1],
>   IDvar="FIPSNO", proj4string=CRS("+proj=longlat +ellps=clrk66"))
> spplot(xx, c("BIR74", "BIR79"), scales=list(draw=TRUE))
>
> Hope this helps,
>
> Roger
>
>
>> Regards, Mike.
>>
>>
>> ==============Original message text===============
>> On Wed, 22 Apr 2009 11:49:09 +1000 Jin.Li at ga.gov.au wrote:
>>
>> Thank you very much, Mike. That is very helpful. I got the colour I was
>> after. My data are in lat/long, when I tried degAxis I got:
>>
>>> degAxis(1)
>>>
>> Error in axis(side, at = at, labels = labels, ...) :
>>  plot.new has not been called yet
>>
>>> degAxis(2)
>>>
>> Error in axis(side, at = at, labels = labels, ...) :
>>  plot.new has not been called yet
>> It seems degAxis is not working with spplot. Any suggestions? Thanks.
>> Cheers,
>> Jin
>>
>>
>> -----Original Message-----
>> From: Michael Sumner [mailto:mdsumner at utas.edu.au]
>> Sent: Wednesday, 22 April 2009 11:08
>> To: Li Jin
>> Cc: r-sig-geo at stat.math.ethz.ch
>> Subject: Re: [R-sig-Geo] spplot [SEC=UNCLASSIFIED]
>>
>> This examples shows the use of colorRampPalette(grDevices) to create a
>> color ramp with sp.theme, borrowing from the spplot documentation. See
>> colors()[grep("brown", colors())]
>> to find the browns R already knows about, or generate your own.
>>
>>  library(lattice)
>>     trellis.par.set(sp.theme(regions = list(col =
>> colorRampPalette(c("sandybrown", "brown4")))) )
>>
>>
>>     data(meuse.grid)
>>     gridded(meuse.grid)=~x+y
>>     meuse.grid$g = factor(sample(letters[1:5], 3103,
>> replace=TRUE),levels=letters[1:10])
>>     meuse.grid$f = factor(sample(letters[6:10], 3103,
>> replace=TRUE),levels=letters[1:10])
>>     spplot(meuse.grid, c("f","g"))
>>
>> If your data are already in latitude/longitude then just type this to add
>> the graticule and labels:
>>
>> degAxis(1)
>> degAxis(2)
>>
>> If your data use a different projection there's an example here that
>> transforms lines from lat/lon to the grid, but it would be more work to
>> figure out for your case:
>>
>> http://geography.uoregon.edu/GeogR/examples/maps_examples02.htmHTH
>>
>> Regards, Mike.
>>
>> ==============Original message text===============
>> On Wed, 22 Apr 2009 10:39:21 +1000 Jin.Li at ga.gov.au wrote:
>>
>> Dear all,
>>
>> I am using spplot to generate some maps. The maps produced are beautiful
>> as shown by the attached file, but I was wondering if it is possible to
>> do the following modifications:
>> 1) change the colour to brown, that is a value 0 corresponding to
>> blank/white, 100 to brown, values in between to lighter browns, something
>> like we can get by brown((0:100)/100); this colour is required for mud by
>> my organisation; and
>> 2) add lat and long on the axes/borders.
>>
>> Thanks for your help in advance.
>>
>> Cheers,
>>
>> Jin
>> _______________________________________
>> Jin Li, PhD
>> Spatial Modeller/Computational Statistician
>> Marine & Coastal Environment
>> Geoscience Australia
>> GPO Box 378, Canberra, ACT 2601, Australia
>>
>> Ph: 61 (02) 6249 9899; email: jin.li at ga.gov.au<mailto:jin.li at ga.gov.au>
>> _______________________________________
>>
>>
>> ===========End of original message text===========
>>
>>
>>
>> If it wasn't backed-up, then it wasn't important. ~ Anon sysadmin
>>
>> Mike Sumner (Phd. Candidate)
>> http://www.antcrc.utas.edu.au/~mdsumner/ http://www.zoo.utas.edu.au/awru/  IASOS/AWRUUniversity of Tasmania
>> Private Bag 80
>> Hobart Tasmania 7001
>> AUSTRALIA
>> Email: mdsumner at utas.edu.au
>> Phone: 03 6226 1752 (W)
>>       0408599921   (M)
>> Fax:   03 6226 2745
>>
>>
>>
>>
>>
>>
>>
>>
>> ===========End of original message text===========
>>
>>
>>
>> If it wasn't backed-up, then it wasn't important. ~ Anon sysadmin
>>
>> Mike Sumner (Phd. Candidate)
>> http://www.antcrc.utas.edu.au/~mdsumner/ http://www.zoo.utas.edu.au/awru/  IASOS/AWRU
>> University of Tasmania
>> Private Bag 80
>> Hobart Tasmania 7001
>> AUSTRALIA
>> Email: mdsumner at utas.edu.au
>> Phone: 03 6226 1752 (W)
>>       0408599921   (M)
>> Fax:   03 6226 2745
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>
> --
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
>
>
> ------------------------------------------------------------------------
>
> ------------------------------------------------------------------------
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

--
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de/
http://www.springer.com/978-0-387-78170-9 e.pebesma at wwu.de


From Roger.Bivand at nhh.no  Thu Apr 23 10:20:27 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 23 Apr 2009 10:20:27 +0200 (CEST)
Subject: [R-sig-Geo] error using predict.sarlm
In-Reply-To: <Prayer.1.0.16.0904221540590.9822@vs-a.tc.umn.edu>
References: <Prayer.1.0.16.0904220935180.20724@vs-a.tc.umn.edu>
	<alpine.LRH.2.00.0904221648220.14737@reclus.nhh.no>
	<Prayer.1.0.16.0904221540590.9822@vs-a.tc.umn.edu>
Message-ID: <alpine.LRH.2.00.0904231012280.27708@reclus.nhh.no>

On Wed, 22 Apr 2009, evans324 at umn.edu wrote:

> Hi Roger,
>
> Thanks for the response. Unfortunately, I'm still getting the same error 
> running predict.sarlm ("Error in if (nrow(newdata) != 
> length(listw$neighbours)) stop("mismatch between newdata and spatial 
> weights") : argument is of length zero"). Here's what I've done since.

OK, see below for analysis

>
>> Thanks for providing the verbatim code. If this is the verbatim code, then 
>> newdata = "dak_test_data" is saying that newdata is not the data.frame 
>> object called dak_test_data, but a single element character vector - that 
>> is, nrow("dak_test_data") is NULL. However, this does not trigger the error 
>> message as such, so it could also be that you wrote newdata = 
>> dak_test_data, and nrow(dak_test_data) is not equal to 
>
> I removed quotes, but still get the same error. The dak_test_data file was 
> imported using readShapePoly. I also tried importing the dataset using 
> read.dbf, but still got the same error using the resulting data frame.

Then the dak_test_data is a SpatialPolygonsDataFrame, for which there is 
no nrow() method, leading to problems. Please get around this by saying 
newdata=as(dak_test_data, "data.frame") to coerce it to data frame. I'll 
look at providing dim methods for Spatial*DataFrame objects other than 
SpatialPointsDataFrame, which are in sp already; nrow() just returns 
dim()[1] of the object.

Thanks,

Roger

>
>> However, this does not trigger the error message as such, so it could also 
>> be that you wrote newdata = dak_test_data, and nrow(dak_test_data) is not 
>> equal to length(dak_test.10nn.listw) - or here nrow(coords), which is the 
>> test.
>
> As you suggested, nrow(dak_test_data)is NULL and thus is not equal to 
> length(dak_test.10nn.listw), which equals 3. nrow(coords) = 2255. Here's the 
> sequence of code that went into creating these weights:
>
> coords<-coordinates(dak_test_data)
> rn<-sapply(slot(dak_test_data, "polygons"), function(x) slot(x, "ID"))
> dak_test.10nn <- knearneigh(coords, k=10)
> dak_test.10nn.nb <- knn2nb(dak_test.10nn, row.names=rn, sym=TRUE)
> dak_test.10nn.listw <- nb2listw(dak_test.10nn.nb, zero.policy=TRUE)
>
> When I ran this using the imported dbf, I used the same weights since I'm not 
> aware of a way to create weights without tracing back to a shapefile. The 
> data frame in this case had nrow=2255. I still received the same error 
> message.
>
> I'd appreciate any help you can offer in solving this problem.  Thanks.
>
> Heather Sander 
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From edzer.pebesma at uni-muenster.de  Thu Apr 23 10:33:45 2009
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 23 Apr 2009 10:33:45 +0200
Subject: [R-sig-Geo] spplot [SEC=UNCLASSIFIED]
In-Reply-To: <8D2A822B1C6C2A44ABEB777AA83FA0E32C5D7B6B3C@EXCCR01.agso.gov.au>
References: <8D2A822B1C6C2A44ABEB777AA83FA0E32C5D7B6B3C@EXCCR01.agso.gov.au>
Message-ID: <49F027E9.8040906@uni-muenster.de>



Jin.Li at ga.gov.au wrote:
> Thank you, Edzer.
> My second question bas been solved by using:
> proj4string(pred.mud.ked) <- CRS("+proj=longlat +datum=WGS84")
>
> For the first question, I have checked ?levelplot, but found no clue to do what I intended. Thanks for any further help.
>   
library(sp)
data(meuse.grid)
gridded(meuse.grid) = ~x+y
spplot(meuse.grid["dist"],colorkey = list(at = c(0,.5,1), labels =
c("0%", "50%", "100%")),col.regions=cm.colors(2),at=c(0,.5,1))

> Cheers,
> Jin
>
>
> -----Original Message-----
> From: Edzer Pebesma [mailto:edzer.pebesma at uni-muenster.de]
> Sent: Thursday, 23 April 2009 4:08 PM
> To: Li Jin
> Cc: Roger.Bivand at nhh.no; r-sig-geo at stat.math.ethz.ch
> Subject: Re: [R-sig-Geo] spplot [SEC=UNCLASSIFIED]
>
> Dear Jin, the
>
>   ..., scales=list(draw=T), ...
>
> only prints the degree E and degree S on the axis tic marks when it is convinced the data are in long lat. Use
>
>   proj4string(pred.mud.ked) <- "+proj=longlat"
>
> maybe with the right datum, to set this for pred.mud.ked; in principle you could set it early on in your analysis and it should propagate. Be aware that interpolation in gstat will do something different when it finds out that data are in degrees, as it can no longer use coordinates "easily" to compute Euclidian distances.
>
> To change the colorkey, read the help of function levelplot in package lattice, in particular argument colorkey.
> --
> Edzer
>
>
> Jin.Li at ga.gov.au wrote:
>   
>> Dear Roger and Mike,
>> Thank you very much for your kind help. Now I have basically achieved what I initially planned. Here is the code used for plotting the attached map.
>>
>> library(maptools)
>> pred.mud.ked<-read.table("mud.ked.csv", sep=",", header=TRUE)
>> par (font.axis=2, font.lab=2)
>> coordinates(pred.mud.ked) = ~LON+LAT
>> gridded(pred.mud.ked)<-TRUE
>> jpeg("mud.n.ked100.2.jpeg", width=670, height=670, quality=100)
>> trellis.par.set(sp.theme(regions = list(col = colorRampPalette(c("lightyellow", "saddlebrown")))) )
>> spplot(pred.mud.ked, c("bt.pred"), scales=list(draw=T), xlab=expression("Longitude"^o), ylab=expression("Latitude"^o),
>>     main = list("Predicted mud distribution in northern Australian EEZ area using KED", cex=1, col="black", font=2))
>> dev.off()
>> detach(package:maptools)
>>
>> Now I have two other questions.
>> 1. Given that the data range is between 0(%) to 100(%), but the scale bar shows a range beyond this data range, how could I make it start from 0(%) to 100(%) and also add unit (i.e. %) to the scale bar?
>> 2. The text adjacent to axes only show a number without degree symbol and E or S, how to add these and make the text adjacent to axes look like http://r-spatial.sourceforge.net/gallery/#fig09.R?
>> Any help is greatly appreciated.
>> Cheers,
>> Jin
>>
>> -----Original Message-----
>> From: Roger Bivand [mailto:Roger.Bivand at nhh.no]
>> Sent: Wednesday, 22 April 2009 4:52 PM
>> To: Li Jin
>> Cc: Michael Sumner; r-sig-geo at stat.math.ethz.ch
>> Subject: Re: [R-sig-Geo] spplot [SEC=UNCLASSIFIED]
>>
>> On Wed, 22 Apr 2009, Michael Sumner wrote:
>>
>>
>>     
>>> Ouch - sorry about that, I should have checked.
>>>
>>> I don't know how to set axis labels with spplot I'm afraid.
>>>
>>>       
>> Something like:
>>
>> library(maptools)
>> xx <- readShapeSpatial(system.file("shapes/sids.shp", package="maptools")[1],
>>   IDvar="FIPSNO", proj4string=CRS("+proj=longlat +ellps=clrk66"))
>> spplot(xx, c("BIR74", "BIR79"), scales=list(draw=TRUE))
>>
>> Hope this helps,
>>
>> Roger
>>
>>
>>     
>>> Regards, Mike.
>>>
>>>
>>> ==============Original message text===============
>>> On Wed, 22 Apr 2009 11:49:09 +1000 Jin.Li at ga.gov.au wrote:
>>>
>>> Thank you very much, Mike. That is very helpful. I got the colour I was
>>> after. My data are in lat/long, when I tried degAxis I got:
>>>
>>>       
>>>> degAxis(1)
>>>>
>>>>         
>>> Error in axis(side, at = at, labels = labels, ...) :
>>>  plot.new has not been called yet
>>>
>>>       
>>>> degAxis(2)
>>>>
>>>>         
>>> Error in axis(side, at = at, labels = labels, ...) :
>>>  plot.new has not been called yet
>>> It seems degAxis is not working with spplot. Any suggestions? Thanks.
>>> Cheers,
>>> Jin
>>>
>>>
>>> -----Original Message-----
>>> From: Michael Sumner [mailto:mdsumner at utas.edu.au]
>>> Sent: Wednesday, 22 April 2009 11:08
>>> To: Li Jin
>>> Cc: r-sig-geo at stat.math.ethz.ch
>>> Subject: Re: [R-sig-Geo] spplot [SEC=UNCLASSIFIED]
>>>
>>> This examples shows the use of colorRampPalette(grDevices) to create a
>>> color ramp with sp.theme, borrowing from the spplot documentation. See
>>> colors()[grep("brown", colors())]
>>> to find the browns R already knows about, or generate your own.
>>>
>>>  library(lattice)
>>>     trellis.par.set(sp.theme(regions = list(col =
>>> colorRampPalette(c("sandybrown", "brown4")))) )
>>>
>>>
>>>     data(meuse.grid)
>>>     gridded(meuse.grid)=~x+y
>>>     meuse.grid$g = factor(sample(letters[1:5], 3103,
>>> replace=TRUE),levels=letters[1:10])
>>>     meuse.grid$f = factor(sample(letters[6:10], 3103,
>>> replace=TRUE),levels=letters[1:10])
>>>     spplot(meuse.grid, c("f","g"))
>>>
>>> If your data are already in latitude/longitude then just type this to add
>>> the graticule and labels:
>>>
>>> degAxis(1)
>>> degAxis(2)
>>>
>>> If your data use a different projection there's an example here that
>>> transforms lines from lat/lon to the grid, but it would be more work to
>>> figure out for your case:
>>>
>>> http://geography.uoregon.edu/GeogR/examples/maps_examples02.htmHTH
>>>
>>> Regards, Mike.
>>>
>>> ==============Original message text===============
>>> On Wed, 22 Apr 2009 10:39:21 +1000 Jin.Li at ga.gov.au wrote:
>>>
>>> Dear all,
>>>
>>> I am using spplot to generate some maps. The maps produced are beautiful
>>> as shown by the attached file, but I was wondering if it is possible to
>>> do the following modifications:
>>> 1) change the colour to brown, that is a value 0 corresponding to
>>> blank/white, 100 to brown, values in between to lighter browns, something
>>> like we can get by brown((0:100)/100); this colour is required for mud by
>>> my organisation; and
>>> 2) add lat and long on the axes/borders.
>>>
>>> Thanks for your help in advance.
>>>
>>> Cheers,
>>>
>>> Jin
>>> _______________________________________
>>> Jin Li, PhD
>>> Spatial Modeller/Computational Statistician
>>> Marine & Coastal Environment
>>> Geoscience Australia
>>> GPO Box 378, Canberra, ACT 2601, Australia
>>>
>>> Ph: 61 (02) 6249 9899; email: jin.li at ga.gov.au<mailto:jin.li at ga.gov.au>
>>> _______________________________________
>>>
>>>
>>> ===========End of original message text===========
>>>
>>>
>>>
>>> If it wasn't backed-up, then it wasn't important. ~ Anon sysadmin
>>>
>>> Mike Sumner (Phd. Candidate)
>>> http://www.antcrc.utas.edu.au/~mdsumner/ http://www.zoo.utas.edu.au/awru/  IASOS/AWRUUniversity of Tasmania
>>> Private Bag 80
>>> Hobart Tasmania 7001
>>> AUSTRALIA
>>> Email: mdsumner at utas.edu.au
>>> Phone: 03 6226 1752 (W)
>>>       0408599921   (M)
>>> Fax:   03 6226 2745
>>>
>>>
>>>
>>>
>>>
>>>
>>>
>>>
>>> ===========End of original message text===========
>>>
>>>
>>>
>>> If it wasn't backed-up, then it wasn't important. ~ Anon sysadmin
>>>
>>> Mike Sumner (Phd. Candidate)
>>> http://www.antcrc.utas.edu.au/~mdsumner/ http://www.zoo.utas.edu.au/awru/  IASOS/AWRU
>>> University of Tasmania
>>> Private Bag 80
>>> Hobart Tasmania 7001
>>> AUSTRALIA
>>> Email: mdsumner at utas.edu.au
>>> Phone: 03 6226 1752 (W)
>>>       0408599921   (M)
>>> Fax:   03 6226 2745
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>>>       
>> --
>> Roger Bivand
>> Economic Geography Section, Department of Economics, Norwegian School of
>> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>>
>>
>> ------------------------------------------------------------------------
>>
>> ------------------------------------------------------------------------
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>     
>
> --
> Edzer Pebesma
> Institute for Geoinformatics (ifgi), University of M?nster
> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
> 8333081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de/
> http://www.springer.com/978-0-387-78170-9 e.pebesma at wwu.de
>
>   

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de/
http://www.springer.com/978-0-387-78170-9 e.pebesma at wwu.de


From horning at amnh.org  Thu Apr 23 12:55:35 2009
From: horning at amnh.org (Ned Horning)
Date: Thu, 23 Apr 2009 13:55:35 +0300
Subject: [R-sig-Geo] Problems with Raster package?
Message-ID: <49F04927.5010500@amnh.org>

I just updated my R installation to 2.9 and then updated my packages. It 
looks like setRaster and setDatatype are not included in the Raster 
package that I downloaded (8.9-13). I noticed on the R-Forge site for 
the Raster package that version 8.9-14 is the most current version but 
when I run "install.packages" I get the previous version.

Can someone help me figure out what I'm doing wrong?

Ned


From gianni.lavaredo at gmail.com  Thu Apr 23 13:01:33 2009
From: gianni.lavaredo at gmail.com (gianni lavaredo)
Date: Thu, 23 Apr 2009 13:01:33 +0200
Subject: [R-sig-Geo] Help to OVERLAY (in sp) a "SpatialPointsDataFrame" with
	a 'SpatialPolygonsDataFrame"
Message-ID: <518dff330904230401v762c8ec6h1658d96914f59003@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090423/5f5177a7/attachment.pl>

From Roger.Bivand at nhh.no  Thu Apr 23 13:16:08 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 23 Apr 2009 13:16:08 +0200 (CEST)
Subject: [R-sig-Geo] Find incircle of a polygon
In-Reply-To: <49EF834E.60606@gmail.com>
References: <49EF3133.6050908@gmail.com>
	<alpine.LRH.2.00.0904221855480.14737@reclus.nhh.no>
	<49EF834E.60606@gmail.com>
Message-ID: <alpine.LRH.2.00.0904231313590.27708@reclus.nhh.no>

On Wed, 22 Apr 2009, Etienne Bellemare Racine wrote:

> Thanks Roger it helped me a lot.
> Now I would like to iteratively find the incircle in a polygon until a 
> certain radii (i.e. as if I was stuffing balls in my polygon, from the 
> biggest to the smallest). So I have to subtract that circle to my polygon.
> Should I subtract it from my polygon by adding an inside loop (setting hole 
> to TRUE, is it that simple) or can I substract it directly from the owin 
> object ?

I guess that others may have ideas here - this is uncharted territory. 
You'd be using gpclib through spatstat or maptools (or PBSmapping) to 
construct a new object with a hole, so trial and error will get you some 
of the way. Ideas, anyone?

Roger

>
> Thanks,
> Etienne
>
> Roger Bivand a ?crit :
>> On Wed, 22 Apr 2009, Etienne Bellemare Racine wrote:
>> 
>>> Hi,
>>> I'm looking for a way to find the largest circle fitting in an irregular
>>> polygon. This is not the real definition of an incircle (as it has to be
>>> tangent to all edges, but it's a more synthetic title).
>>> Spatstat package has an incircle function, but designed for an owin
>>> class object. Before trying to adapt the function to my needs, so I can
>>> input a shapefile, I would be happy to get some advices (if any
>>> available), or another package to look at.
>> 
>> You can read (polygon) shapefiles into SpatialPolygon* objects using 
>> readShapeSpatial in maptools and readOGR in rgdal. Once there, coerce to an 
>> owin object with methods in maptools, something like:
>> 
>> x <- readOGR(".", "myshape")
>> ox <- as(as(x, "SpatialPolygons"), "owin")
>> 
>> should do it, but watch for topology checking in spatstat. Spatstat ships 
>> with a vignette on using shapefiles, see for an online link:
>> 
>> http://cran.r-project.org/web/packages/spatstat/vignettes/shapefiles.pdf
>> 
>> which is up to date, humourous, and should tell you what you need to know. 
>> Using the advice there should resolve any topology problems. If you are 
>> stuck after trying things from there, please follow up on this list.
>> 
>> Hope this helps,
>> 
>> Roger
>> 
>>> 
>>> Thanks,
>>> Etienne
>>>
>>>     [[alternative HTML version deleted]]
>>> 
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> 
>> 
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From Roger.Bivand at nhh.no  Thu Apr 23 13:29:15 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 23 Apr 2009 13:29:15 +0200 (CEST)
Subject: [R-sig-Geo] spdep: stsls; tot.solve=1e-12
In-Reply-To: <3c75698d0904221720g7629780cna79cd6b03511841e@mail.gmail.com>
References: <3c75698d0904221720g7629780cna79cd6b03511841e@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.0904231316160.27708@reclus.nhh.no>

On Wed, 22 Apr 2009, Adam Okulicz-Kozaryn wrote:

> Hello,
> i am trying to run  stsls from spdep, and I am getting error:
>
> Error in solve.default(ZpZp) :
>  system is computationally singular: reciprocal condition number = 0
>
> I would get the same error in lagsarlm, but I can fix it by setting

I don't think that this is the same problem. In the *sarlm case, the 
problem is only in computing the asymptotic covariance matrix, and occurs 
when the scaling of rho or lambda and the betas varies a lot.

Here it is occurring in the middle of TSLS, and suggests that there are 
colinearities around at the second stage, probably between yendp, the 
fitted endogenous lagged y and X (yendp fitted using X and WX). Setting 
the tolerance for solve will not help here at all. If you like, set 
debug(spdep:::tsls) and before running solve(ZpZp), eyeball the values 
going into Zp (cor(Zp) for example, or pairs(Zp)).

Hope this helps,

Roger

>
> tot.solve=1e-12
>
> as suggested here
> http://www.nabble.com/Error-in-spdep%3A-system-is-computationally-singular-tt19880274.html#a19896513
>
> I cannot do that in stsls. I already rescaled variables to similar scale. Is
> there any way to fix that?
> best,
> adam
>
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From r.hijmans at gmail.com  Thu Apr 23 13:31:19 2009
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Thu, 23 Apr 2009 19:31:19 +0800
Subject: [R-sig-Geo] Problems with Raster package?
In-Reply-To: <49F04927.5010500@amnh.org>
References: <49F04927.5010500@amnh.org>
Message-ID: <dc22b2570904230431m7b43ecffv76e21ff030819155@mail.gmail.com>

Hi Ned, that is the downside of using a package under development
(albeit *quite* stable now).

"x <- setRaster(x)" has been replaced by the (generic) "x <- raster(x)"
"x <- setDatatype(x, value)" has been replaced by "dataType(x) <- value"

As for the versions, you are not doing anything wrong. It can take
couple of days before the latest version is available for (automatic)
installation from R-forge

Robert

On Thu, Apr 23, 2009 at 6:55 PM, Ned Horning <horning at amnh.org> wrote:
> I just updated my R installation to 2.9 and then updated my packages. It
> looks like setRaster and setDatatype are not included in the Raster package
> that I downloaded (8.9-13). I noticed on the R-Forge site for the Raster
> package that version 8.9-14 is the most current version but when I run
> "install.packages" I get the previous version.
>
> Can someone help me figure out what I'm doing wrong?
>
> Ned
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From Greg.Snow at imail.org  Thu Apr 23 15:21:53 2009
From: Greg.Snow at imail.org (Greg Snow)
Date: Thu, 23 Apr 2009 07:21:53 -0600
Subject: [R-sig-Geo] paste(" /" ") and paste(" /' ") for grass command
In-Reply-To: <49EFF493.2010803@gmail.com>
References: <49EED5FB.2000500@gmail.com> <op.ussc5vxe5hcodf@jaimer>
	<49EFF493.2010803@gmail.com>
Message-ID: <B37C0A15B8FB3C468B5BC7EBC7DA14CC61CFE52DDF@LP-EXMBVS10.CO.IHC.COM>

It is not the paste function (as has been mentioned before), but the print function that is doing different things.  The default behavior for printing character strings is to put "" around each string, if there is a " inside the string, then the print function will put the \ in the representation to show that it is part of the string.

Since you don't do anything with the results of paste, the print function is called on the result with the default values.  But if you call print yourself with quote=FALSE or use the cat function instead of print (or save the value to a string and look at it in a different way, etc.) then you will see the string with the " and without the \.

-- 
Gregory (Greg) L. Snow Ph.D.
Statistical Data Center
Intermountain Healthcare
greg.snow at imail.org
801.408.8111


> -----Original Message-----
> From: r-sig-geo-bounces at stat.math.ethz.ch [mailto:r-sig-geo-
> bounces at stat.math.ethz.ch] On Behalf Of Agustin Lobo
> Sent: Wednesday, April 22, 2009 10:55 PM
> To: Jaime R. Garcia Marquez
> Cc: sig-geo
> Subject: Re: [R-sig-Geo] paste(" /" ") and paste(" /' ") for grass
> command
> 
> True. Also, actually grass accepts where='(GRIDCODE = 11917)', so the
> practical problem is solved.
> Nevertheless, I find odd the different behavior of
> 
> paste("\"","Hola","\"",sep="")
> and
> paste("\'","Hola","\'",sep="")
> 
> the former printing the \
> while the second one does not.
> 
> Thanks!
> 
> Agus
> 
> Jaime R. Garcia Marquez wrote:
> > Dear Agustin,
> >
> > I think that using the script paste("\"","Hola","\"",sep="") will do
> > the job anyway. Yes, you would get "\"Hola\"" as a result but when
> you
> > pass the script to GRASS the \ symbol will not be considered and so
> > you will get the string you are looking for.
> >
> > a <- "v.extract codigo_Montseny07_clump"
> > b <- paste("out=extract", 11917, sep="") c <- paste("(GRIDCODE = ",
> > 11917, ")", sep="") c <- paste("where=\"", c, "\"",sep="")
> >
> > string <- paste(a,b,c, sep=" ")
> > system(string)
> >
> >> string
> > [1] "v.extract codigo_Montseny07_clump out=extract11917
> > where=\"(GRIDCODE = 11917)\""
> >
> > When the command is read in GRASS the \ symbol will mean move to the
> > next line in the console.
> >
> > Best,
> >
> > Jaime -R
> >
> >
> > On Wed, 22 Apr 2009 10:31:55 +0200, Agustin Lobo
> > <alobolistas at gmail.com> wrote:
> >
> >> I wish to write "" using paste(), but
> >>
> >>> paste("\"","Hola","\"",sep="")
> >> [1] "\"Hola\""
> >>>
> >>
> >> while the same approach works with ''
> >>> paste("\'","Hola","\'",sep="")
> >> [1] "'Hola'"
> >>
> >> why this difference? how could I do it to get "Hola" ?
> >>
> >> I need this to write this string in R:
> >> v.extract codigo_Montseny07_clump out=extract11917 where="(GRIDCODE
> =
> >> 11917)"
> >>
> >> and pass it to grass. Something like:
> >> for (i in polis){
> >> system("g.region vect=codigo_Montseny07_clump") nomextract <-
> >> paste("extract",i,sep="") grcomm <- paste("v.extract
> >> codigo_Montseny07_clump out=",nomextract, " where=\"(GRIDCODE =
> >> ",i,")\" ",sep="")
> >> system(grcomm)
> >>
> >> ...
> >>
> >> Thanks
> >>
> >> Agus
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >


From alinashe at gmail.com  Thu Apr 23 19:43:23 2009
From: alinashe at gmail.com (Alina Sheyman)
Date: Thu, 23 Apr 2009 13:43:23 -0400
Subject: [R-sig-Geo] creating polygons
In-Reply-To: <alpine.LRH.2.00.0904220900330.14737@reclus.nhh.no>
References: <f58db2700904201026n8de839frf72181b90a17b771@mail.gmail.com>
	<p06240806c6129ee50469@128.115.67.9>
	<f58db2700904210925l4822d013wfaeed92a95a48e66@mail.gmail.com>
	<alpine.LRH.2.00.0904212114460.9820@reclus.nhh.no>
	<f58db2700904211331l68338d67t3c892432b2bc8d79@mail.gmail.com>
	<alpine.LRH.2.00.0904220900330.14737@reclus.nhh.no>
Message-ID: <f58db2700904231043g4ac3f2cdnb007bddd4f959a19@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090423/a8f70594/attachment.pl>

From Roger.Bivand at nhh.no  Thu Apr 23 19:55:09 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 23 Apr 2009 19:55:09 +0200 (CEST)
Subject: [R-sig-Geo] creating polygons
In-Reply-To: <f58db2700904231043g4ac3f2cdnb007bddd4f959a19@mail.gmail.com>
References: <f58db2700904201026n8de839frf72181b90a17b771@mail.gmail.com>
	<p06240806c6129ee50469@128.115.67.9>
	<f58db2700904210925l4822d013wfaeed92a95a48e66@mail.gmail.com>
	<alpine.LRH.2.00.0904212114460.9820@reclus.nhh.no> 
	<f58db2700904211331l68338d67t3c892432b2bc8d79@mail.gmail.com>
	<alpine.LRH.2.00.0904220900330.14737@reclus.nhh.no>
	<f58db2700904231043g4ac3f2cdnb007bddd4f959a19@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.0904231946430.32223@reclus.nhh.no>

On Thu, 23 Apr 2009, Alina Sheyman wrote:

> I went back to the help page, but it still didn't clarify it for me.
> Yes, the two files are different length, but both have a zip variable that
> they can match on and then keep only those records that match. Or do I need
> to additionally create an index for the match to occur?
> I am understanding it that unionSpatialPolygons functions works very much in
> the same way as merge, except with geographical data. Am I wrong in this
> assumption?

Wrong, as you can see. That isn't how it works. As input, you have 
n Polygons objects in a SpatialPolygons object (with no variables at all, 
no data slot), as output m Polygons objects in a SpatialPolygons object. 
The IDs argument assigns the (possibly multiple) n input Polygons objects 
to the m output Polygons object, which means that IDs must be of length n, 
and express which j=1,m each i=1,n belongs to. So if you do length(IDs), 
it must equal n, and length(unique(IDs)) will equal m. Not complicated, 
not merge, but hard work if you don't have a list of zips broken down by 
districts that lets you create the IDs easily.

Hope this helps,

Roger

>
>
> On Wed, Apr 22, 2009 at 3:09 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> On Tue, 21 Apr 2009, Alina Sheyman wrote:
>>
>>  Hi Roger,
>>>
>>
>> Alina,
>>
>> Don't take this offlist, summarise to the list when done so that others can
>> learn from your experiences.
>>
>>  when I follow the example in  maptools
>>>
>>> coordinates(mass) <- c("lat", "long")
>>> reg4 <- unionSpatialPolygons(zipmaps3, mass$center_id)
>>>
>>
>> Right, you have not read the unionSpatialPolygons help page carefully, have
>> you?
>>
>> Do:
>>
>> length(mass$center_id)
>> length(slot(zipmaps3, "polygons")
>>
>> They differ - your mass are the districts, zipmaps3 are the zips. zipmaps3
>> has a variable giving the district IDs, what is it called? If you do
>>
>> table(zipmaps3$district_IDs)
>>
>> you see the numbers of zips in each district. This is your second argument
>> to unionSpatialPolygons; it tells the functions which zips belong to each
>> district. If you don't have such a variable, you'll have to make it. This is
>> all explained on the help page, and in the example. It is very much like the
>> other tapply(), by() and aggregate() functions, but only returns the
>> geometries.
>>
>> Hope this helps,
>>
>> Roger
>>
>>
>>
>>> I get the following error message
>>> Error in unionSpatialPolygons(zipmaps3, mass$center_id) :
>>>  input lengths differ
>>>
>>> Do you know why that is? Do I in fact need to have two files of identical
>>> length in order for the
>>> function to work?
>>>
>>> thank you
>>>
>>> On Tue, Apr 21, 2009 at 3:17 PM, Roger Bivand <Roger.Bivand at nhh.no>
>>> wrote:
>>>
>>>  On Tue, 21 Apr 2009, Alina Sheyman wrote:
>>>>
>>>>  To rephrase my question and explain my problem further
>>>>
>>>>> I have already created a map for revenue by zip code, in the state of
>>>>> Massachusetts. To accomplish that I used a shapefile for Massachusetts
>>>>> and
>>>>> a
>>>>> dataframe with my revenue/zip codes.
>>>>>
>>>>> What I am trying to do now is to have the same map done not by zip code,
>>>>> but
>>>>> rather by districts, as defined by zip codes.
>>>>>
>>>>> Basically what I've done was to introduce a new variable "district" into
>>>>> my
>>>>> dataset along with a zip code. At the same time my basic state map (by
>>>>> zip)
>>>>> still comes from a shape file and I can't introduce a new variable into
>>>>> the
>>>>> shape file.
>>>>>
>>>>>  Does anyone  know if there's any way I can accomplish what I'm trying
>>>>> to
>>>>> do or do I basically need to create a new shapefile with districts
>>>>> already
>>>>> in the file?
>>>>>
>>>>>
>>>> OK, that wasn't too clear before. Look at unionSpatialPolygons() in
>>>> maptools - it will take a vector of districts matching all your zip
>>>> codes,
>>>> and join together the geometries belonging to each district, dropping
>>>> internal boundaries. The district IDs become the Polygons object IDs.
>>>> There
>>>> is no data frame in the object, because it isn't obvious how you might
>>>> want
>>>> to aggregate it.
>>>>
>>>> Hope this helps,
>>>>
>>>> Roger
>>>>
>>>>
>>>>
>>>>  On Mon, Apr 20, 2009 at 5:53 PM, Don MacQueen <macq at llnl.gov> wrote:
>>>>>
>>>>>  This is a pretty general question, and there are potentially many ways
>>>>> to
>>>>>
>>>>>> do it.
>>>>>>
>>>>>> One way to get started would be to follow the example(s) in the help
>>>>>> page
>>>>>> for the overlay() function in the sp package.
>>>>>>
>>>>>> -Don
>>>>>>
>>>>>>
>>>>>> At 1:26 PM -0400 4/20/09, Alina Sheyman wrote:
>>>>>>
>>>>>>  I have a list of made-up districts and corresponding zip codes. Based
>>>>>>
>>>>>>> on
>>>>>>> that I want to define my own polygons (for each district) and then use
>>>>>>> them
>>>>>>> to create a map. Does anyone know how I would go about defining these?
>>>>>>>
>>>>>>> thank you
>>>>>>>
>>>>>>>      [[alternative HTML version deleted]]
>>>>>>>
>>>>>>> _______________________________________________
>>>>>>> R-sig-Geo mailing list
>>>>>>> R-sig-Geo at stat.math.ethz.ch
>>>>>>> https:// stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>> --
>>>>>> --------------------------------------
>>>>>> Don MacQueen
>>>>>> Environmental Protection Department
>>>>>> Lawrence Livermore National Laboratory
>>>>>> Livermore, CA, USA
>>>>>> 925-423-1062
>>>>>> --------------------------------------
>>>>>>
>>>>>>
>>>>>>        [[alternative HTML version deleted]]
>>>>>
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at stat.math.ethz.ch
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>
>>>>>
>>>>>  --
>>>> Roger Bivand
>>>> Economic Geography Section, Department of Economics, Norwegian School of
>>>> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>>>> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>>>> e-mail: Roger.Bivand at nhh.no
>>>>
>>>>
>>>>
>>>
>> --
>> Roger Bivand
>> Economic Geography Section, Department of Economics, Norwegian School of
>> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From gregspam at kooji.com  Thu Apr 23 22:07:38 2009
From: gregspam at kooji.com (Greg King)
Date: Thu, 23 Apr 2009 21:07:38 +0100
Subject: [R-sig-Geo] Spatial Interpolation of Regularly Gridded Data
In-Reply-To: <2A6919EF-5404-429A-A055-684A37763AC4@connect.carleton.ca>
References: <c7dbc1ea0904061500q1bcfc024o507fa9635667f518@mail.gmail.com>
	<alpine.LRH.2.00.0904070921300.18101@reclus.nhh.no>
	<c7dbc1ea0904071332l6f1d60c2l48feac2cca157032@mail.gmail.com>
	<2A6919EF-5404-429A-A055-684A37763AC4@connect.carleton.ca>
Message-ID: <c7dbc1ea0904231307g18e986a9oe7beaf3648ad5592@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090423/da214e73/attachment.pl>

From debeaudette at ucdavis.edu  Thu Apr 23 22:33:49 2009
From: debeaudette at ucdavis.edu (Dylan Beaudette)
Date: Thu, 23 Apr 2009 13:33:49 -0700
Subject: [R-sig-Geo] Spatial Interpolation of Regularly Gridded Data
In-Reply-To: <c7dbc1ea0904231307g18e986a9oe7beaf3648ad5592@mail.gmail.com>
References: <c7dbc1ea0904061500q1bcfc024o507fa9635667f518@mail.gmail.com>
	<2A6919EF-5404-429A-A055-684A37763AC4@connect.carleton.ca>
	<c7dbc1ea0904231307g18e986a9oe7beaf3648ad5592@mail.gmail.com>
Message-ID: <200904231333.49751.dylan.beaudette@gmail.com>

On Thursday 23 April 2009, Greg King wrote:
> This reply is a little late, but after much searching, I cannot find an R
> package/function that fits my needs.
>
> I am trying to perform either bilinear or  bicubic interpolation using
> great circle distances (ie using a spherical model of the earth).  Here is
> what I have tried:
>
> gstat: Can only perform kriging or IDW
> akima: Cannot interpolate regularly gridded data and does not support
> Coordinate Reference Systems
> fields: Thin plate spline function does not seem to support regularly
> gridded data or Coordinate Refernec Systems
> rsaga: Only supported on windows (I need unix based)
>
> I'm now at a bit of a loss where to look.  It seems the regular R functions
> are very good at bilinear and bicubic interpolation in cartesian geometry,
> but I can't find a way of using great circle distances for interpolation.
> Are there any more avenues I should investigate?
>
> Thanks,
>
> Greg


Have a look at GRASS, it runs on UNIX.

Cheers,
Dylan

>
> On Tue, Apr 7, 2009 at 11:06 PM, Scott W Mitchell <
>
> smitch at connect.carleton.ca> wrote:
> > Greg, you just need to come back here!  We just hired Murray Richardson,
> > and he's a whiz at R-SAGA.
> >
> > ;)
> >
> > Cheers,
> > Scott
> >
> >
> >
> > On 7-Apr-09, at 16:32 , Greg King wrote:
> >
> >  Thanks for your reply Roger.  I little while back I got kriging working
> > in
> >
> >> the gstat package with my data, but found that for my purposes it was
> >> too computationally expensive (read slow).  Therefore I am looking for
> >> something
> >> a little quicker.  I now appreciate I cannot use interp due to it
> >> treating coordinates as planar.  I found a good tutorial for kriging in
> >> gstat at http://casoilresource.lawr.ucdavis.edu/drupal/node/442.  From a
> >> quick play
> >> around I can't immediately see how functions like Tps in the field
> >> package meet my needs.  Could anyone provide directions to primers on
> >> the web?. Googling for R is quite tricky (even with rseek).
> >>
> >> Essentially I want a fast simple method for interpolating a single point
> >> value from its surounding points.  It shouldn't be too difficult but I
> >> must
> >> admit I am struggling a little!
> >>
> >> Greg
> >>
> >> On Tue, Apr 7, 2009 at 8:26 AM, Roger Bivand <Roger.Bivand at nhh.no>
> >> wrote:
> >>
> >>  On Mon, 6 Apr 2009, Greg King wrote:
> >>> Hi,
> >>>
> >>>> I'm fairly new to R, but finding the experience a good one.  However I
> >>>> am
> >>>> a
> >>>> little overwhelmed by the number of packages and not sure I am
> >>>> necessarily
> >>>> using the most appropriate ones.
> >>>
> >>> Have you read the Spatial Task View on your nearest CRAN? There you
> >>> should
> >>> find some information to help. Firstly, akima treats all coordinates as
> >>> planar, so don't use interp(). Both fields and gstat can interpolate
> >>> using
> >>> geographical coordinates, gstat with IDW and kriging, fields with thin
> >>> plate
> >>> splines (I believe using rdist.earth, but have not checked) and
> >>> kriging. You
> >>> are trying to interpolate, so why not use a geostatistical method? You
> >>> could
> >>> see whether the new automap package (running gstat internally) can
> >>> handle geographical coordinates - check by comparing the output with
> >>> runs with the
> >>> proj4string set and unset.
> >>>
> >>> Hope this helps,
> >>>
> >>> Roger
> >>>
> >>>
> >>>
> >>>  Here is the background to what I am trying to achieve:  I have a CSV
> >>>
> >>>> file
> >>>> which contains weather forecast data for latitude and longitude points
> >>>> (see
> >>>> attached out.csv, the data I understand is on WGS84
> >>>> http://www.ready.noaa.gov/faq/geodatums.html).  The sample points are
> >>>> at
> >>>> half degree intervals.  My objective is to work out what the forecast
> >>>> data
> >>>> is at any specific given latitude/longitude by interpolating data from
> >>>> the
> >>>> 0.5x0.5 degree grid.  I am doing this for a number of different time
> >>>> points
> >>>> using the following functions:
> >>>>
> >>>> library(akima)
> >>>> library(rgdal)
> >>>>
> >>>> gks <- function(inLat,inLon,dframe,variab) {
> >>>>  wind.grid <- expand.grid(lat=inLat, lon=inLon)
> >>>>  coordinates(wind.grid) <- ~ lat+lon
> >>>>  proj4string(wind.grid) <- CRS("+init=epsg:4326")
> >>>>  pnt<-interpp(coordinates(dframe)[,1], coordinates(dframe)[,2],
> >>>> z=as.data.frame(dframe)[,1],
> >>>> coordinates(wind.grid)[,1],coordinates(wind.grid)[,2],linear=TRUE)
> >>>>  return(pnt$z)
> >>>> }
> >>>>
> >>>> interp_gk <- function(lat, lon) {
> >>>>  wind<-read.csv(file="/Users/greg/Out.csv",head=TRUE,sep=",",
> >>>> colClasses=c("POSIXct","numeric","numeric","numeric","numeric"))
> >>>>  coordinates(wind)=~lat+lon
> >>>>  proj4string(wind) <- CRS("+init=epsg:4326")
> >>>>
> >>>>  times<-unique(wind$vt)
> >>>>  columns<-names(wind)[2:length(names(wind))]
> >>>>
> >>>>  dOut<-data.frame(dateTime=times[1])
> >>>>
> >>>>  for (i in 1:length(times)) {
> >>>>  dOut[i,"dateTime"]<-times[i]
> >>>>     for (j in 1:length(columns)) {
> >>>>         sset<-subset(wind, wind$vt==times[i], select=c(columns[j]))
> >>>>         dOut[i,columns[j]]<-gks(lat,lon,sset,columns[j])
> >>>>     }
> >>>>  }
> >>>>  dOut<-cbind(dOut, mag=sqrt(dOut$ugrd_0^2+dOut$vgrd_0^2))
> >>>>  return(dOut)
> >>>> }
> >>>>
> >>>> However, I have the following concerns:
> >>>>
> >>>> - Should I really be using akima?  The documentation states it is not
> >>>> for
> >>>> use on regularly spaced grids - what are my alternatives?
> >>>> - The interp funcrtion will not work for cubic spline "linear=FALSE"
> >>>> interpolation (is it because my data is regularly gridded?).  How can
> >>>> I achieve cubic spline interpolation?
> >>>> - Is my function really using the Cordinate reference system
> >>>> specified? When I comment out the CRS lines, my functions return the
> >>>> same values?
> >>>>
> >>>> Lots of questions I appreciate, but I am curious!  It seems R can
> >>>> achieve
> >>>> what I am trying to do... but I may just be missing some vital bits of
> >>>> information.
> >>>>
> >>>> Thanks,
> >>>>
> >>>> Greg
> >>>>
> >>>>
> >>>>  --
> >>>
> >>> Roger Bivand
> >>> Economic Geography Section, Department of Economics, Norwegian School
> >>> of Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> >>> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> >>> e-mail: Roger.Bivand at nhh.no
> >>
> >>        [[alternative HTML version deleted]]
> >>
> >> _______________________________________________
> >> R-sig-Geo mailing list
> >> R-sig-Geo at stat.math.ethz.ch
> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Dylan Beaudette
Soil Resource Laboratory
http://casoilresource.lawr.ucdavis.edu/
University of California at Davis
530.754.7341


From clint at ecy.wa.gov  Thu Apr 23 22:54:06 2009
From: clint at ecy.wa.gov (Clint Bowman)
Date: Thu, 23 Apr 2009 13:54:06 -0700 (PDT)
Subject: [R-sig-Geo] Spatial Interpolation of Regularly Gridded Data
In-Reply-To: <c7dbc1ea0904231307g18e986a9oe7beaf3648ad5592@mail.gmail.com>
References: <c7dbc1ea0904061500q1bcfc024o507fa9635667f518@mail.gmail.com>
	<alpine.LRH.2.00.0904070921300.18101@reclus.nhh.no>
	<c7dbc1ea0904071332l6f1d60c2l48feac2cca157032@mail.gmail.com>
	<2A6919EF-5404-429A-A055-684A37763AC4@connect.carleton.ca>
	<c7dbc1ea0904231307g18e986a9oe7beaf3648ad5592@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0904231339020.5429@aeolus.ecy.wa.gov>

Greg,

I'm quite certain that kriging would not be appropriate with model
output--you won't have any errors to produce the necessary statistics.

Are you looking at smooth terrain (e.g., over the ocean) where topographic
influences are negligible and you may want to interpolate the pressure
field and then diagnose the resulting winds, or is your interest high
enough in the atmosphere where you could use the thermal wind equation?

Recognize that the shortest resolved wavelength will likely be
approximately two grid lengths which will limit the ability of any
interpolation to match a sub-grid scale effect.  You can probably get a
better idea of the correct approach by looking in detail at the model
description--is it a spectral model?  The interpolation used by the model
(you may need to look at the model source code or communicate with the
model develoopers/maintainers) to determine an appropriate interpolation
method.

Clint

Clint Bowman			INTERNET:	clint at ecy.wa.gov
Air Dispersion Modeler		INTERNET:	clint at math.utah.edu
Air Quality Program		VOICE:		(360) 407-6815
Department of Ecology		FAX:		(360) 407-7534

	USPS:  		PO Box 47600, Olympia, WA 98504-7600
	Parcels:	300 Desmond Drive, Lacey, WA 98503-1274

On Thu, 23 Apr 2009, Greg King wrote:

> This reply is a little late, but after much searching, I cannot find an R
> package/function that fits my needs.
>
> I am trying to perform either bilinear or  bicubic interpolation using great
> circle distances (ie using a spherical model of the earth).  Here is what I
> have tried:
>
> gstat: Can only perform kriging or IDW
> akima: Cannot interpolate regularly gridded data and does not support
> Coordinate Reference Systems
> fields: Thin plate spline function does not seem to support regularly
> gridded data or Coordinate Refernec Systems
> rsaga: Only supported on windows (I need unix based)
>
> I'm now at a bit of a loss where to look.  It seems the regular R functions
> are very good at bilinear and bicubic interpolation in cartesian geometry,
> but I can't find a way of using great circle distances for interpolation.
> Are there any more avenues I should investigate?
>
> Thanks,
>
> Greg
>
> On Tue, Apr 7, 2009 at 11:06 PM, Scott W Mitchell <
> smitch at connect.carleton.ca> wrote:
>
> >
> > Greg, you just need to come back here!  We just hired Murray Richardson,
> > and he's a whiz at R-SAGA.
> >
> > ;)
> >
> > Cheers,
> > Scott
> >
> >
> >
> > On 7-Apr-09, at 16:32 , Greg King wrote:
> >
> >  Thanks for your reply Roger.  I little while back I got kriging working in
> >> the gstat package with my data, but found that for my purposes it was too
> >> computationally expensive (read slow).  Therefore I am looking for
> >> something
> >> a little quicker.  I now appreciate I cannot use interp due to it treating
> >> coordinates as planar.  I found a good tutorial for kriging in gstat at
> >> http://casoilresource.lawr.ucdavis.edu/drupal/node/442.  From a quick
> >> play
> >> around I can't immediately see how functions like Tps in the field package
> >> meet my needs.  Could anyone provide directions to primers on the web?.
> >> Googling for R is quite tricky (even with rseek).
> >>
> >> Essentially I want a fast simple method for interpolating a single point
> >> value from its surounding points.  It shouldn't be too difficult but I
> >> must
> >> admit I am struggling a little!
> >>
> >> Greg
> >>
> >> On Tue, Apr 7, 2009 at 8:26 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> >>
> >>  On Mon, 6 Apr 2009, Greg King wrote:
> >>>
> >>> Hi,
> >>>
> >>>>
> >>>> I'm fairly new to R, but finding the experience a good one.  However I
> >>>> am
> >>>> a
> >>>> little overwhelmed by the number of packages and not sure I am
> >>>> necessarily
> >>>> using the most appropriate ones.
> >>>>
> >>>>
> >>> Have you read the Spatial Task View on your nearest CRAN? There you
> >>> should
> >>> find some information to help. Firstly, akima treats all coordinates as
> >>> planar, so don't use interp(). Both fields and gstat can interpolate
> >>> using
> >>> geographical coordinates, gstat with IDW and kriging, fields with thin
> >>> plate
> >>> splines (I believe using rdist.earth, but have not checked) and kriging.
> >>> You
> >>> are trying to interpolate, so why not use a geostatistical method? You
> >>> could
> >>> see whether the new automap package (running gstat internally) can handle
> >>> geographical coordinates - check by comparing the output with runs with
> >>> the
> >>> proj4string set and unset.
> >>>
> >>> Hope this helps,
> >>>
> >>> Roger
> >>>
> >>>
> >>>
> >>>  Here is the background to what I am trying to achieve:  I have a CSV
> >>>> file
> >>>> which contains weather forecast data for latitude and longitude points
> >>>> (see
> >>>> attached out.csv, the data I understand is on WGS84
> >>>> http://www.ready.noaa.gov/faq/geodatums.html).  The sample points are
> >>>> at
> >>>> half degree intervals.  My objective is to work out what the forecast
> >>>> data
> >>>> is at any specific given latitude/longitude by interpolating data from
> >>>> the
> >>>> 0.5x0.5 degree grid.  I am doing this for a number of different time
> >>>> points
> >>>> using the following functions:
> >>>>
> >>>> library(akima)
> >>>> library(rgdal)
> >>>>
> >>>> gks <- function(inLat,inLon,dframe,variab) {
> >>>>  wind.grid <- expand.grid(lat=inLat, lon=inLon)
> >>>>  coordinates(wind.grid) <- ~ lat+lon
> >>>>  proj4string(wind.grid) <- CRS("+init=epsg:4326")
> >>>>  pnt<-interpp(coordinates(dframe)[,1], coordinates(dframe)[,2],
> >>>> z=as.data.frame(dframe)[,1],
> >>>> coordinates(wind.grid)[,1],coordinates(wind.grid)[,2],linear=TRUE)
> >>>>  return(pnt$z)
> >>>> }
> >>>>
> >>>> interp_gk <- function(lat, lon) {
> >>>>  wind<-read.csv(file="/Users/greg/Out.csv",head=TRUE,sep=",",
> >>>> colClasses=c("POSIXct","numeric","numeric","numeric","numeric"))
> >>>>  coordinates(wind)=~lat+lon
> >>>>  proj4string(wind) <- CRS("+init=epsg:4326")
> >>>>
> >>>>  times<-unique(wind$vt)
> >>>>  columns<-names(wind)[2:length(names(wind))]
> >>>>
> >>>>  dOut<-data.frame(dateTime=times[1])
> >>>>
> >>>>  for (i in 1:length(times)) {
> >>>>  dOut[i,"dateTime"]<-times[i]
> >>>>     for (j in 1:length(columns)) {
> >>>>         sset<-subset(wind, wind$vt==times[i], select=c(columns[j]))
> >>>>         dOut[i,columns[j]]<-gks(lat,lon,sset,columns[j])
> >>>>     }
> >>>>  }
> >>>>  dOut<-cbind(dOut, mag=sqrt(dOut$ugrd_0^2+dOut$vgrd_0^2))
> >>>>  return(dOut)
> >>>> }
> >>>>
> >>>> However, I have the following concerns:
> >>>>
> >>>> - Should I really be using akima?  The documentation states it is not
> >>>> for
> >>>> use on regularly spaced grids - what are my alternatives?
> >>>> - The interp funcrtion will not work for cubic spline "linear=FALSE"
> >>>> interpolation (is it because my data is regularly gridded?).  How can I
> >>>> achieve cubic spline interpolation?
> >>>> - Is my function really using the Cordinate reference system specified?
> >>>> When I comment out the CRS lines, my functions return the same values?
> >>>>
> >>>> Lots of questions I appreciate, but I am curious!  It seems R can
> >>>> achieve
> >>>> what I am trying to do... but I may just be missing some vital bits of
> >>>> information.
> >>>>
> >>>> Thanks,
> >>>>
> >>>> Greg
> >>>>
> >>>>
> >>>>  --
> >>> Roger Bivand
> >>> Economic Geography Section, Department of Economics, Norwegian School of
> >>> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> >>> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> >>> e-mail: Roger.Bivand at nhh.no
> >>>
> >>>
> >>>
> >>        [[alternative HTML version deleted]]
> >>
> >> _______________________________________________
> >> R-sig-Geo mailing list
> >> R-sig-Geo at stat.math.ethz.ch
> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >>
> >
> >
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From Jin.Li at ga.gov.au  Fri Apr 24 03:44:58 2009
From: Jin.Li at ga.gov.au (Jin.Li at ga.gov.au)
Date: Fri, 24 Apr 2009 11:44:58 +1000
Subject: [R-sig-Geo] spplot [SEC=UNCLASSIFIED]
In-Reply-To: <49F027E9.8040906@uni-muenster.de>
Message-ID: <8D2A822B1C6C2A44ABEB777AA83FA0E32C5D7B6B42@EXCCR01.agso.gov.au>

Dear all,
Thank you very much Edzer for the detailed instructions. Thank you all for your kind help. Here is my code for plotting the attached map.

library(maptools)
pred.mud.ked<-read.table("mud.ked.csv", sep=",", header=TRUE) coordinates(pred.mud.ked) = ~LON+LAT
gridded(pred.mud.ked)<-TRUE
proj4string(pred.mud.ked) <- CRS("+proj=longlat +datum=WGS84")
jpeg("mud.n.ked100.2.jpeg", width=670, height=670, quality=100)
trellis.par.set(sp.theme(regions = list(col = colorRampPalette(c("lightyellow", "saddlebrown")))) )
spplot(pred.mud.ked, c("bt.pred"), scales=list(draw=T), xlab=expression("Longitude"^o), ylab=expression("Latitude"^o),
colorkey = list(at = c(seq(0,100, 5)), labels = c("0%","","","","20%","","","","40%","","","","60%","","","", "80%","","","", "100%")),
    at=c(seq(0,100, 5)),
    main = list("Predicted mud distribution in northern Australian EEZ area using KED", cex=1, col="black", font=2))
dev.off()
detach(package:maptools)

I believe there is still much room for improvement. Any further suggestions to improve this are appreciated.

Cheers,
Jin

-----Original Message-----
From: Edzer Pebesma [mailto:edzer.pebesma at uni-muenster.de]
Sent: Thursday, 23 April 2009 6:34 PM
To: Li Jin
Cc: Roger.Bivand at nhh.no; r-sig-geo at stat.math.ethz.ch
Subject: Re: [R-sig-Geo] spplot [SEC=UNCLASSIFIED]



Jin.Li at ga.gov.au wrote:
> Thank you, Edzer.
> My second question bas been solved by using:
> proj4string(pred.mud.ked) <- CRS("+proj=longlat +datum=WGS84")
>
> For the first question, I have checked ?levelplot, but found no clue to do what I intended. Thanks for any further help.
>
library(sp)
data(meuse.grid)
gridded(meuse.grid) = ~x+y
spplot(meuse.grid["dist"],colorkey = list(at = c(0,.5,1), labels =
c("0%", "50%", "100%")),col.regions=cm.colors(2),at=c(0,.5,1))

> Cheers,
> Jin
>
>
> -----Original Message-----
> From: Edzer Pebesma [mailto:edzer.pebesma at uni-muenster.de]
> Sent: Thursday, 23 April 2009 4:08 PM
> To: Li Jin
> Cc: Roger.Bivand at nhh.no; r-sig-geo at stat.math.ethz.ch
> Subject: Re: [R-sig-Geo] spplot [SEC=UNCLASSIFIED]
>
> Dear Jin, the
>
>   ..., scales=list(draw=T), ...
>
> only prints the degree E and degree S on the axis tic marks when it is convinced the data are in long lat. Use
>
>   proj4string(pred.mud.ked) <- "+proj=longlat"
>
> maybe with the right datum, to set this for pred.mud.ked; in principle you could set it early on in your analysis and it should propagate. Be aware that interpolation in gstat will do something different when it finds out that data are in degrees, as it can no longer use coordinates "easily" to compute Euclidian distances.
>
> To change the colorkey, read the help of function levelplot in package lattice, in particular argument colorkey.
> --
> Edzer
>
>
> Jin.Li at ga.gov.au wrote:
>
>> Dear Roger and Mike,
>> Thank you very much for your kind help. Now I have basically achieved what I initially planned. Here is the code used for plotting the attached map.
>>
>> library(maptools)
>> pred.mud.ked<-read.table("mud.ked.csv", sep=",", header=TRUE)
>> par (font.axis=2, font.lab=2)
>> coordinates(pred.mud.ked) = ~LON+LAT
>> gridded(pred.mud.ked)<-TRUE
>> jpeg("mud.n.ked100.2.jpeg", width=670, height=670, quality=100)
>> trellis.par.set(sp.theme(regions = list(col = colorRampPalette(c("lightyellow", "saddlebrown")))) )
>> spplot(pred.mud.ked, c("bt.pred"), scales=list(draw=T), xlab=expression("Longitude"^o), ylab=expression("Latitude"^o),
>>     main = list("Predicted mud distribution in northern Australian EEZ area using KED", cex=1, col="black", font=2))
>> dev.off()
>> detach(package:maptools)
>>
>> Now I have two other questions.
>> 1. Given that the data range is between 0(%) to 100(%), but the scale bar shows a range beyond this data range, how could I make it start from 0(%) to 100(%) and also add unit (i.e. %) to the scale bar?
>> 2. The text adjacent to axes only show a number without degree symbol and E or S, how to add these and make the text adjacent to axes look like http://r-spatial.sourceforge.net/gallery/#fig09.R?
>> Any help is greatly appreciated.
>> Cheers,
>> Jin
>>
>> -----Original Message-----
>> From: Roger Bivand [mailto:Roger.Bivand at nhh.no]
>> Sent: Wednesday, 22 April 2009 4:52 PM
>> To: Li Jin
>> Cc: Michael Sumner; r-sig-geo at stat.math.ethz.ch
>> Subject: Re: [R-sig-Geo] spplot [SEC=UNCLASSIFIED]
>>
>> On Wed, 22 Apr 2009, Michael Sumner wrote:
>>
>>
>>
>>> Ouch - sorry about that, I should have checked.
>>>
>>> I don't know how to set axis labels with spplot I'm afraid.
>>>
>>>
>> Something like:
>>
>> library(maptools)
>> xx <- readShapeSpatial(system.file("shapes/sids.shp", package="maptools")[1],
>>   IDvar="FIPSNO", proj4string=CRS("+proj=longlat +ellps=clrk66"))
>> spplot(xx, c("BIR74", "BIR79"), scales=list(draw=TRUE))
>>
>> Hope this helps,
>>
>> Roger
>>
>>
>>
>>> Regards, Mike.
>>>
>>>
>>> ==============Original message text===============
>>> On Wed, 22 Apr 2009 11:49:09 +1000 Jin.Li at ga.gov.au wrote:
>>>
>>> Thank you very much, Mike. That is very helpful. I got the colour I was
>>> after. My data are in lat/long, when I tried degAxis I got:
>>>
>>>
>>>> degAxis(1)
>>>>
>>>>
>>> Error in axis(side, at = at, labels = labels, ...) :
>>>  plot.new has not been called yet
>>>
>>>
>>>> degAxis(2)
>>>>
>>>>
>>> Error in axis(side, at = at, labels = labels, ...) :
>>>  plot.new has not been called yet
>>> It seems degAxis is not working with spplot. Any suggestions? Thanks.
>>> Cheers,
>>> Jin
>>>
>>>
>>> -----Original Message-----
>>> From: Michael Sumner [mailto:mdsumner at utas.edu.au]
>>> Sent: Wednesday, 22 April 2009 11:08
>>> To: Li Jin
>>> Cc: r-sig-geo at stat.math.ethz.ch
>>> Subject: Re: [R-sig-Geo] spplot [SEC=UNCLASSIFIED]
>>>
>>> This examples shows the use of colorRampPalette(grDevices) to create a
>>> color ramp with sp.theme, borrowing from the spplot documentation. See
>>> colors()[grep("brown", colors())]
>>> to find the browns R already knows about, or generate your own.
>>>
>>>  library(lattice)
>>>     trellis.par.set(sp.theme(regions = list(col =
>>> colorRampPalette(c("sandybrown", "brown4")))) )
>>>
>>>
>>>     data(meuse.grid)
>>>     gridded(meuse.grid)=~x+y
>>>     meuse.grid$g = factor(sample(letters[1:5], 3103,
>>> replace=TRUE),levels=letters[1:10])
>>>     meuse.grid$f = factor(sample(letters[6:10], 3103,
>>> replace=TRUE),levels=letters[1:10])
>>>     spplot(meuse.grid, c("f","g"))
>>>
>>> If your data are already in latitude/longitude then just type this to add
>>> the graticule and labels:
>>>
>>> degAxis(1)
>>> degAxis(2)
>>>
>>> If your data use a different projection there's an example here that
>>> transforms lines from lat/lon to the grid, but it would be more work to
>>> figure out for your case:
>>>
>>> http://geography.uoregon.edu/GeogR/examples/maps_examples02.htmHTH
>>>
>>> Regards, Mike.
>>>
>>> ==============Original message text===============
>>> On Wed, 22 Apr 2009 10:39:21 +1000 Jin.Li at ga.gov.au wrote:
>>>
>>> Dear all,
>>>
>>> I am using spplot to generate some maps. The maps produced are beautiful
>>> as shown by the attached file, but I was wondering if it is possible to
>>> do the following modifications:
>>> 1) change the colour to brown, that is a value 0 corresponding to
>>> blank/white, 100 to brown, values in between to lighter browns, something
>>> like we can get by brown((0:100)/100); this colour is required for mud by
>>> my organisation; and
>>> 2) add lat and long on the axes/borders.
>>>
>>> Thanks for your help in advance.
>>>
>>> Cheers,
>>>
>>> Jin
>>> _______________________________________
>>> Jin Li, PhD
>>> Spatial Modeller/Computational Statistician
>>> Marine & Coastal Environment
>>> Geoscience Australia
>>> GPO Box 378, Canberra, ACT 2601, Australia
>>>
>>> Ph: 61 (02) 6249 9899; email: jin.li at ga.gov.au<mailto:jin.li at ga.gov.au>
>>> _______________________________________
>>>
>>>
>>> ===========End of original message text===========
>>>
>>>
>>>
>>> If it wasn't backed-up, then it wasn't important. ~ Anon sysadmin
>>>
>>> Mike Sumner (Phd. Candidate)
>>> http://www.antcrc.utas.edu.au/~mdsumner/ http://www.zoo.utas.edu.au/awru/  IASOS/AWRUUniversity of Tasmania
>>> Private Bag 80
>>> Hobart Tasmania 7001
>>> AUSTRALIA
>>> Email: mdsumner at utas.edu.au
>>> Phone: 03 6226 1752 (W)
>>>       0408599921   (M)
>>> Fax:   03 6226 2745
>>>
>>>
>>>
>>>
>>>
>>>
>>>
>>>
>>> ===========End of original message text===========
>>>
>>>
>>>
>>> If it wasn't backed-up, then it wasn't important. ~ Anon sysadmin
>>>
>>> Mike Sumner (Phd. Candidate)
>>> http://www.antcrc.utas.edu.au/~mdsumner/ http://www.zoo.utas.edu.au/awru/  IASOS/AWRU
>>> University of Tasmania
>>> Private Bag 80
>>> Hobart Tasmania 7001
>>> AUSTRALIA
>>> Email: mdsumner at utas.edu.au
>>> Phone: 03 6226 1752 (W)
>>>       0408599921   (M)
>>> Fax:   03 6226 2745
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>>>
>> --
>> Roger Bivand
>> Economic Geography Section, Department of Economics, Norwegian School of
>> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>>
>>
>> ------------------------------------------------------------------------
>>
>> ------------------------------------------------------------------------
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>
> --
> Edzer Pebesma
> Institute for Geoinformatics (ifgi), University of M?nster
> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
> 8333081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de/
> http://www.springer.com/978-0-387-78170-9 e.pebesma at wwu.de
>
>

--
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de/
http://www.springer.com/978-0-387-78170-9 e.pebesma at wwu.de

-------------- next part --------------
A non-text attachment was scrubbed...
Name: mud.n.ked100.2.jpeg
Type: image/jpeg
Size: 104608 bytes
Desc: mud.n.ked100.2.jpeg
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090424/09954c93/attachment.jpeg>

From Adrian.Baddeley at csiro.au  Fri Apr 24 11:34:26 2009
From: Adrian.Baddeley at csiro.au (Adrian.Baddeley at csiro.au)
Date: Fri, 24 Apr 2009 17:34:26 +0800
Subject: [R-sig-Geo] incircle of a polygon
Message-ID: <57DC18C299094D4299F837570C5DF1C5029DF2DA71@EXWA-MBX01.nexus.csiro.au>


Etienne Bellemare Racine <etiennebr at gmail.com> writes:

> I'm looking for a way to find the largest circle fitting in an irregular
> polygon. This is not the real definition of an incircle (as it has to be
> tangent to all edges, but it's a more synthetic title).

The mathematical definition of the incircle of a polygon is: the largest circle fitting inside it.
See the Wikipedia entry for 'incircle'. 
If the polygon is convex, then the incircle will be tangent to at least three of the edges of the
polygon. In general it cannot be tangent to all edges of the polygon (that can only happen for regular polygons).
If the polygon is not convex, then the incircle does not need to be tangent to any edges: it might just touch the 
polygon at three concave vertices. 

> Now I would like to iteratively find the incircle in a polygon until a
> certain radii (i.e. as if I was stuffing balls in my polygon, from the
> biggest to the smallest). So I have to subtract that circle to my polygon.
> Should I subtract it from my polygon by adding an inside loop (setting
> hole to TRUE, is it that simple) or can I substract it directly from the
> owin object ?

You can use disc() to create an owin object that represents a circle,
and intersect.owin and complement.owin to remove the disc from your polygon.

Here is a piece of code that will do what you wanted.

It's rather fun to try e.g.
          data(demopat)
          stuffballs(demopat$window, 100, TRUE)

Please note that the current version of spatstat (1.15-2) converts the polygon to a pixel mask
and uses the 8-connected distance transform to compute the incircle. Effectively this treats the 
circles as octagons. So, don't expect the circles to be perfectly tangent to the edges. 
You can see a few anomalies in the example above.

In the next version of spatstat, the distmap algorithm for polygons will be changed so that this
problem is vastly ameliorated.

Adrian Baddeley

----------------------
require(spatstat)

stuffballs <- function(W, rmin, plotit=TRUE) {
  stopifnot(is.owin(W))
  stopifnot(rmin > 0)
  if(plotit)
    plot(W)
  W <- as.mask(W)
  B <- as.rectangle(W)
  circles <- data.frame(x=numeric(0), y=numeric(0), r=numeric(0))
  ncircles <- 0
  while(TRUE) {
    circ <- incircle(W)
    if(circ$r <= rmin)
      break
    circles <- rbind(circles, as.data.frame(circ))
    D <- with(circ, disc(r, c(x,y)))
    if(plotit)
      plot(D, add=TRUE)
    W <- intersect.owin(W, complement.owin(D, B))
    if(area.owin(W) == 0)
      break
  }
  return(circles)
}

    


From Michael.Hoehle at stat.uni-muenchen.de  Fri Apr 24 12:34:33 2009
From: Michael.Hoehle at stat.uni-muenchen.de (=?ISO-8859-1?Q?Michael_H=F6hle?=)
Date: Fri, 24 Apr 2009 12:34:33 +0200
Subject: [R-sig-Geo] [Q]: Converting SpatialPolygons with proj4string to
 spatstat owin
In-Reply-To: <alpine.LRH.2.00.0904230806390.27708@reclus.nhh.no>
References: <49EF79E8.2030004@stat.uni-muenchen.de>
	<alpine.LRH.2.00.0904230806390.27708@reclus.nhh.no>
Message-ID: <49F195B9.1010409@stat.uni-muenchen.de>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Dear Roger,

>> The plot method for Spatial* objects looks to see whether the geometries
>> are in geographical coordinates. If they are, it applies a correction to
>> the y axis depending on the distance from the Equator. You can get the
>> spatstat look by fixing the aspect to 1 in plot(de, asp=1), overriding
>> the adjustment.
> 

Thats very helpful. Fiddling around with the aspect ratio, I tricked
spatstat to use the correct aspect ratio:

plot(owin.de,asp=attr(de,"asp"),main="")

to give me a nice looking map plotted with spatstat.

>> Project the geometries to the plane (spTransform methods in rgdal).

Ok, I'll look into that.

Thanks for the help.

Best regards,

Michael

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (Darwin)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iD8DBQFJ8ZW5JenxFqlYkSERAmA5AKC0zaSIRGchcvaCIBF+KALS4n7B8ACfRaIe
ve26DmdtmILiNCysJ53oE0M=
=mLrH
-----END PGP SIGNATURE-----


From jloehrke at umassd.edu  Fri Apr 24 14:13:14 2009
From: jloehrke at umassd.edu (Jon Loehrke)
Date: Fri, 24 Apr 2009 08:13:14 -0400
Subject: [R-sig-Geo] Help to OVERLAY (in sp) a "SpatialPointsDataFrame"
	with a 'SpatialPolygonsDataFrame"
Message-ID: <C69773F1-2C56-4A84-9B49-A743D3222CFD@umassd.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090424/8897f204/attachment.pl>

From etiennebr at gmail.com  Fri Apr 24 15:07:17 2009
From: etiennebr at gmail.com (Etienne Bellemare Racine)
Date: Fri, 24 Apr 2009 09:07:17 -0400
Subject: [R-sig-Geo] incircle of a polygon
In-Reply-To: <57DC18C299094D4299F837570C5DF1C5029DF2DA71@EXWA-MBX01.nexus.csiro.au>
References: <57DC18C299094D4299F837570C5DF1C5029DF2DA71@EXWA-MBX01.nexus.csiro.au>
Message-ID: <49F1B985.8080703@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090424/4f12e5db/attachment.pl>

From evans324 at umn.edu  Fri Apr 24 18:40:57 2009
From: evans324 at umn.edu (evans324 at umn.edu)
Date: 24 Apr 2009 11:40:57 -0500
Subject: [R-sig-Geo] error using predict.sarlm
In-Reply-To: <alpine.LRH.2.00.0904231012280.27708@reclus.nhh.no>
References: <Prayer.1.0.16.0904220935180.20724@vs-a.tc.umn.edu>
	<alpine.LRH.2.00.0904221648220.14737@reclus.nhh.no>
	<Prayer.1.0.16.0904221540590.9822@vs-a.tc.umn.edu>
	<alpine.LRH.2.00.0904231012280.27708@reclus.nhh.no>
Message-ID: <Prayer.1.0.16.0904241140570.12350@vs-m.tc.umn.edu>

Hi Roger,

>Then the dak_test_data is a SpatialPolygonsDataFrame, for which there is 
>no nrow() method, leading to problems. Please get around this by saying 
>newdata=as(dak_test_data, "data.frame") to coerce it to data frame. I'll 
>look at providing dim methods for Spatial*DataFrame objects other than 
>SpatialPointsDataFrame, which are in sp already; nrow() just returns 
>dim()[1] of the object.

Thanks for your help so far. I tried your suggestion using the following 
code:

dak_test_vars.10nn.predict <- predict.sarlm(reg_vars_formula.lag, 
newdata=as(dak_test_vars, "data.frame"), listw = 
dak_test.10nn.listw,zero.policy=TRUE)

Now I get a new error message: "Error in invIrW(listw, object$rho) %*% 
trend : non-conformable arguments". I double checked the listw object and 
data frame properties. They are as follows:

nrow(as(dak_test_vars, "data.frame") = 2255
length(dak_test.10nn.listw)
[1] 3
names(dak_test.10nn.listw)
[1] "style"      "neighbours" "weights"   
length(dak_test.10nn.listw[[2]])
[1] 2255
length(coords_test)
[1] 4510

I am unsure of how to interpret this error. Do you have any advice? Thanks 
for your help.

Heather




-- 
Heather Sander
Ph.D. Candidate:  Conservation Biology
Office:  305 Ecology & 420 Blegen
Mail:  
University of Minnesota
Dept. of Geography
414 Social Science Bldg.
267 19th Ave. S.
Minneapolis, MN 55455
USA


From Roger.Bivand at nhh.no  Fri Apr 24 18:52:26 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 24 Apr 2009 18:52:26 +0200 (CEST)
Subject: [R-sig-Geo] error using predict.sarlm
In-Reply-To: <Prayer.1.0.16.0904241140570.12350@vs-m.tc.umn.edu>
References: <Prayer.1.0.16.0904220935180.20724@vs-a.tc.umn.edu>
	<alpine.LRH.2.00.0904221648220.14737@reclus.nhh.no>
	<Prayer.1.0.16.0904221540590.9822@vs-a.tc.umn.edu>
	<alpine.LRH.2.00.0904231012280.27708@reclus.nhh.no>
	<Prayer.1.0.16.0904241140570.12350@vs-m.tc.umn.edu>
Message-ID: <alpine.LRH.2.00.0904241845570.5386@reclus.nhh.no>

On Fri, 24 Apr 2009, evans324 at umn.edu wrote:

> Hi Roger,
>
>> Then the dak_test_data is a SpatialPolygonsDataFrame, for which there is no 
>> nrow() method, leading to problems. Please get around this by saying 
>> newdata=as(dak_test_data, "data.frame") to coerce it to data frame. I'll 
>> look at providing dim methods for Spatial*DataFrame objects other than 
>> SpatialPointsDataFrame, which are in sp already; nrow() just returns 
>> dim()[1] of the object.
>
> Thanks for your help so far. I tried your suggestion using the following 
> code:
>
> dak_test_vars.10nn.predict <- predict.sarlm(reg_vars_formula.lag, 
> newdata=as(dak_test_vars, "data.frame"), listw = 
> dak_test.10nn.listw,zero.policy=TRUE)
>
> Now I get a new error message: "Error in invIrW(listw, object$rho) %*% trend 
> : non-conformable arguments". I double checked the listw object and data 
> frame properties. They are as follows:
>
> nrow(as(dak_test_vars, "data.frame") = 2255
> length(dak_test.10nn.listw)
> [1] 3
> names(dak_test.10nn.listw)
> [1] "style"      "neighbours" "weights"   length(dak_test.10nn.listw[[2]])
> [1] 2255
> length(coords_test)
> [1] 4510

The lengths are OK now - the final one is just 2*2255, so the length of 
all the elements in a two-column matrix.

The problem is occurring in multiplying (I - rho W)^{-1} by the product of 
the newdata X values and the fitted regression coefficients - and suggests 
that something else is going wrong earlier. If you know how to run 
debug(), then do debug(predict.sarlm) and step through, checking the 
dimensions and values of B and X used to create trend. If this sounds 
scary, do:

save(reg_vars_formula.lag, dak_test_vars, dak_test.10nn.listw, 
file="predict_problem.RData")

and attach the saved file to me offlist, and I'll try to see what is going 
on.

Roger

>
> I am unsure of how to interpret this error. Do you have any advice? Thanks 
> for your help.
>
> Heather
>
>
>
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Ervan.Rutishauser at ecofog.gf  Fri Apr 24 21:15:19 2009
From: Ervan.Rutishauser at ecofog.gf (Ervan Rutishauser)
Date: Fri, 24 Apr 2009 16:15:19 -0300
Subject: [R-sig-Geo] Individualizing polygons
Message-ID: <D45C8CF4C5CB2A41956F98C65F093A3A4E2D1C2B3C@funguti.ecofog.gf>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090424/06e9982a/attachment.pl>

From Roger.Bivand at nhh.no  Fri Apr 24 22:03:28 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 24 Apr 2009 22:03:28 +0200 (CEST)
Subject: [R-sig-Geo] Individualizing polygons
In-Reply-To: <D45C8CF4C5CB2A41956F98C65F093A3A4E2D1C2B3C@funguti.ecofog.gf>
References: <D45C8CF4C5CB2A41956F98C65F093A3A4E2D1C2B3C@funguti.ecofog.gf>
Message-ID: <alpine.LRH.2.00.0904242155460.5386@reclus.nhh.no>

On Fri, 24 Apr 2009, Ervan Rutishauser wrote:

> Dear all,
>
> I'm new to this list and spatial analyses, apologize for any repetition 
> from previous question. I exported a shapefile from ArcView, 
> representing gap areas on several forest plots. In ArcView, the 
> attribute table (or dbf) sepcifies notably the gap ID and the plot ID. I 
> imported successfully this shapefile in R, using readShapePoly(), 
> however it seem that the plot ID information is no longer available in 
> the SpatialPolygoneDataFrame object. This raise several questions:

If the DBF fields do not include the one you are looking for, then it will 
not be read into R. If you are only selecting the gap polygons to export, 
then most likely they do not have plot IDs, right?

>
> 1.  Do I have to name the gaps in function of the plot to not lose this 
> information? Secondly, I would like to work with individual polygons in 
> each plot.
>
> 2.  How to handle single polygon from a polygone list? Finally, I would 
> like to transform the gaps coordinates (UTM WSG84) in relative 
> coordinates (xy coordinates in the plot 250mx250m).
>
> 3.  Does the function elide() allows to do that? Or any other way to do 
> that?

You may use the elide() method for this (using the shift= argument to 
provide the offsets), or use +x0= and +y0= offsets in a 
custom projection with spTransform() methods in rgdal. You could get the 
relevant offsets from bbox() of the imported object.

Hope this helps,

Roger



>
> I spent quite long time looking for tutorials on the web, but couldn't 
> find any. Any suggestion... Thank you very much for any advice and help.
>
> Best regards,
> Ervan
> ______________________________________________________________________________
>
> Ervan Rutishauser
> PhD student
> CIRAD - UMR AMAP
> BP 701
> 97387 Kourou Cedex
> tel. 00594.594.32.92.96
>
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From j.burke at earthlink.net  Sat Apr 25 01:39:08 2009
From: j.burke at earthlink.net (Jim Burke)
Date: Fri, 24 Apr 2009 18:39:08 -0500
Subject: [R-sig-Geo] Read shapefile with correct proj4string for the data
Message-ID: <49F24D9C.9010406@earthlink.net>

Hi I have a shapefile that I open successfully
but incorrectly (data is not in lat long format)
with the following. I am curious what the correct
proj4string would be given the "prj" file below.

my_map_sp <- readShapePoly("my_shape_file.shp",
IDvar="ID", proj4string=CRS("+proj=aea
+ellps=GRS80 +datum=WGS84"))

What is the correct "proj4string" format
given the below?

PROJCS["NAD_1983_StatePlane_Texas_North_Central_FIPS_4202_Feet",
GEOGCS["GCS_North_American_1983",
DATUM["D_North_American_1983",
SPHEROID["GRS_1980",6378137.0,298.257222101]],
PRIMEM["Greenwich",0.0],
UNIT["Degree",0.0174532925199433]],
PROJECTION["Lambert_Conformal_Conic"],
PARAMETER["False_Easting",1968500.0],
PARAMETER["False_Northing",6561666.666666666],
PARAMETER["Central_Meridian",-98.5],
PARAMETER["Standard_Parallel_1",32.13333333333333],
PARAMETER["Standard_Parallel_2",33.96666666666667],
PARAMETER["Latitude_Of_Origin",31.66666666666667],
UNIT["Foot_US",0.3048006096012192]]

Thanks,
Jim Burke


From Roger.Bivand at nhh.no  Sat Apr 25 15:04:08 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 25 Apr 2009 15:04:08 +0200 (CEST)
Subject: [R-sig-Geo] Read shapefile with correct proj4string for the data
In-Reply-To: <49F24D9C.9010406@earthlink.net>
References: <49F24D9C.9010406@earthlink.net>
Message-ID: <alpine.LRH.2.00.0904251500300.8901@reclus.nhh.no>

On Fri, 24 Apr 2009, Jim Burke wrote:

> Hi I have a shapefile that I open successfully
> but incorrectly (data is not in lat long format)
> with the following. I am curious what the correct
> proj4string would be given the "prj" file below.
>
> my_map_sp <- readShapePoly("my_shape_file.shp",
> IDvar="ID", proj4string=CRS("+proj=aea
> +ellps=GRS80 +datum=WGS84"))
>
> What is the correct "proj4string" format
> given the below?
>
> PROJCS["NAD_1983_StatePlane_Texas_North_Central_FIPS_4202_Feet",
> GEOGCS["GCS_North_American_1983",
> DATUM["D_North_American_1983",
> SPHEROID["GRS_1980",6378137.0,298.257222101]],
> PRIMEM["Greenwich",0.0],
> UNIT["Degree",0.0174532925199433]],
> PROJECTION["Lambert_Conformal_Conic"],
> PARAMETER["False_Easting",1968500.0],
> PARAMETER["False_Northing",6561666.666666666],
> PARAMETER["Central_Meridian",-98.5],
> PARAMETER["Standard_Parallel_1",32.13333333333333],
> PARAMETER["Standard_Parallel_2",33.96666666666667],
> PARAMETER["Latitude_Of_Origin",31.66666666666667],
> UNIT["Foot_US",0.3048006096012192]]

library(rgdal)
EPSG <- make_EPSG()
EPSG[grep("Texas North Central", EPSG$note),]

so most likely CRS("+init=epsg:2276")

(the offsets are given in ftUS in your source, in m in EPSG)

Using readOGR() in rgdal would read the *.prj file too, but readOGR() 
doesn't (yet) handle as many DBF field types as readShapeSpatial() in 
maptools (dates are a problem).

Hope this helps,

Roger

>
> Thanks,
> Jim Burke
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From gianni.lavaredo at gmail.com  Sat Apr 25 20:36:40 2009
From: gianni.lavaredo at gmail.com (gianni lavaredo)
Date: Sat, 25 Apr 2009 20:36:40 +0200
Subject: [R-sig-Geo] Merge several shape File with RSAGA
Message-ID: <518dff330904251136i4c2e1ca1rdf36029c4130afa7@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090425/343a8881/attachment.pl>

From horning at amnh.org  Sun Apr 26 09:48:15 2009
From: horning at amnh.org (Ned Horning)
Date: Sun, 26 Apr 2009 10:48:15 +0300
Subject: [R-sig-Geo] Reading and writing large GRASS images
Message-ID: <49F411BF.5010008@amnh.org>

Hi -

Is it possible to write large GRASS raster files one line at a time in 
R? I can do this using GeoTiff and the Raster package (writeRaster) but 
I don't think GDAL supports the creation of GRASS rasters.

I'm currently using GeoTIFF and that works fine but it's a bit 
cumbersome since it involves using a few different packages to do my 
work and that means converting between formats more than I would like. 
For example, I use OSSIM to create large BigTIFF mosaics, QGIS to 
digitize training areas and evaluate classification results, GRASS to 
create colored images of my classified map, and R for random forest 
image classification. It might be easier if I can manage everything from 
GRASS or GRASS/QGIS.

Ned


From alessandro.montaghi at unifi.it  Sun Apr 26 14:02:57 2009
From: alessandro.montaghi at unifi.it (Alessandro)
Date: Sun, 26 Apr 2009 14:02:57 +0200
Subject: [R-sig-Geo] Help to select the raw in a data.frame with the max
	value
Message-ID: <026d01c9c666$f0fa2920$d2ee7b60$@montaghi@unifi.it>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090426/7a9e6080/attachment.pl>

From r.hijmans at gmail.com  Sun Apr 26 15:13:33 2009
From: r.hijmans at gmail.com (Robert Hijmans)
Date: Sun, 26 Apr 2009 21:13:33 +0800
Subject: [R-sig-Geo] Help to select the raw in a data.frame with the max
	value
In-Reply-To: <7575032995371899647@unknownmsgid>
References: <7575032995371899647@unknownmsgid>
Message-ID: <dc22b2570904260613q7097a1e5i5624510e0ee9403b@mail.gmail.com>

Hi Ale,

perhaps something like this will work for you:

ID <- c(1,2,3,4,5,6,7,8,9,10)
a1 <- c(1,2,3,4,5,6,7,8,9,10)
a2 <- c(11,12,13,14,15,16,17,18,19,20)
a3 <- c(21,22,23,24,25,26,27,28,29,30)
a4<- c(31,32,33,34,35,36,37,38,39,40)
df <- data.frame(cbind(ID, a1, a2, a3, a4))

# get max by row, exclude first column (ID)
rowmax <- apply(df[,-1], 1, max)

row <- which(rowmax == max(rowmax))
df[row,]

By the way, I think it is better not to post to two lists at the same
time (many people are not subscribed to both, and this will break the
thread).

Robert


On Sun, Apr 26, 2009 at 8:02 PM, Alessandro
<alessandro.montaghi at unifi.it> wrote:
> Dear User,
>
>
>
> thank for the attention. I have a data.frame with 5 columns (ex:ID,
> a1,a2,a3,a4) and 1000 rows. I wish to find the absolute max value for all
> data.frame and save a new data.frame with the row where is that value. Ex:
>
>
>
> ID: 1,2,3,4,5,6,7,8,9,10
>
> a1:1,2,3,4,5,6,7,8,9,10
>
> a2:11,12,13,14,15,16,17,18,19,20
>
> a3:21,22,23,24,25,26,27,28,29,30
>
> a4:31,32,33,34,35,36,37,38,39,40
>
>
>
>
>
> The max value in the four columns (a1,a2,a3,a4) is 40. The new data.frame is
>
>
>
> ID:10
>
> A1:10
>
> A2:20
>
> A3:30
>
> A4 :40
>
>
>
> Thanks
>
>
>
> Ale
>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From enrico.a.rossi at gmail.com  Sun Apr 26 22:06:35 2009
From: enrico.a.rossi at gmail.com (Enrico Rossi)
Date: Sun, 26 Apr 2009 16:06:35 -0400
Subject: [R-sig-Geo] zip code map - huge files!
Message-ID: <e303ddae0904261306q24cbc600qa68c798ba9d39346@mail.gmail.com>

Hello,

I have some data at the zip code level, and I'm using the shapefiles
downloaded from the Census TigerLine website
(http://www2.census.gov/geo/tiger/TIGER2008/tl_2008_us_zcta5.zip) to
plot a shaded map of the US. However, the files generated in this way
are enormous, and take a long time to process, even on a fast machine
with lots of memory. I'm wondering if there's a more efficient way to
do this. Maybe rasterize before plotting somehow?

If anyone on this list has experience working with zip-level data, I'd
appreciate any advice.

Here's some example code like what I'm doing:

# This works, and produces a 1.2GB PDF file! After it's done, I can
rasterize it using gs to reduce file size, but it takes almost an hour
library(maptools)
zip<-readShapePoly("tl_2008_us_zcta5")  # This takes a while!
val<-runif(length(zip[[1]])) # there are about 32000 zip codes
pdf("zipplot.pdf")
plot(zip,xlim=c(-130,-65),ylim=c(20,50),col=grey(val),lty=0)
dev.off()
system("gs -dSAFER -dBATCH -dNOPAUSE -sDEVICE=png16m -r300
-dTextAlphaBits=4 -dGraphicsAlphaBits=4 -dMaxStripSize=8192
-sOutputFile=zipplot.png zipplot.pdf")

# I've tried plotting directly to png, but it just seems to hang, my
patience ran out after two hours
png("zipplot.png")
plot(zip,xlim=c(-130,-65),ylim=c(20,50),col=grey(val),lty=0)
dev.off()

# This also takes too long, I never got any output out of it
library(lattice)
zip$val<-val
pdf("zipplot2.pdf")
spplot(zip,"val",xlim=c(-130,-65),ylim=c(20,50),lty=0)
dev.off()

Many thanks!
Enrico Rossi


From h.wickham at gmail.com  Mon Apr 27 00:53:06 2009
From: h.wickham at gmail.com (hadley wickham)
Date: Sun, 26 Apr 2009 17:53:06 -0500
Subject: [R-sig-Geo] zip code map - huge files!
In-Reply-To: <e303ddae0904261306q24cbc600qa68c798ba9d39346@mail.gmail.com>
References: <e303ddae0904261306q24cbc600qa68c798ba9d39346@mail.gmail.com>
Message-ID: <f8e6ff050904261553u14b55f56ke8de09e5f1783d4b@mail.gmail.com>

Hi Enrico,

I have some code to do map generalisation (reducing map resolution
without visible loss in detail) at
http://github.com/hadley/data-counties/tree/master.  It's applied to
counties data, but would be trivial (if slow) to modify to work with
zip codes instead

Hadley

On Sun, Apr 26, 2009 at 3:06 PM, Enrico Rossi <enrico.a.rossi at gmail.com> wrote:
> Hello,
>
> I have some data at the zip code level, and I'm using the shapefiles
> downloaded from the Census TigerLine website
> (http://www2.census.gov/geo/tiger/TIGER2008/tl_2008_us_zcta5.zip) to
> plot a shaded map of the US. However, the files generated in this way
> are enormous, and take a long time to process, even on a fast machine
> with lots of memory. I'm wondering if there's a more efficient way to
> do this. Maybe rasterize before plotting somehow?
>
> If anyone on this list has experience working with zip-level data, I'd
> appreciate any advice.
>
> Here's some example code like what I'm doing:
>
> # This works, and produces a 1.2GB PDF file! After it's done, I can
> rasterize it using gs to reduce file size, but it takes almost an hour
> library(maptools)
> zip<-readShapePoly("tl_2008_us_zcta5") ?# This takes a while!
> val<-runif(length(zip[[1]])) # there are about 32000 zip codes
> pdf("zipplot.pdf")
> plot(zip,xlim=c(-130,-65),ylim=c(20,50),col=grey(val),lty=0)
> dev.off()
> system("gs -dSAFER -dBATCH -dNOPAUSE -sDEVICE=png16m -r300
> -dTextAlphaBits=4 -dGraphicsAlphaBits=4 -dMaxStripSize=8192
> -sOutputFile=zipplot.png zipplot.pdf")
>
> # I've tried plotting directly to png, but it just seems to hang, my
> patience ran out after two hours
> png("zipplot.png")
> plot(zip,xlim=c(-130,-65),ylim=c(20,50),col=grey(val),lty=0)
> dev.off()
>
> # This also takes too long, I never got any output out of it
> library(lattice)
> zip$val<-val
> pdf("zipplot2.pdf")
> spplot(zip,"val",xlim=c(-130,-65),ylim=c(20,50),lty=0)
> dev.off()
>
> Many thanks!
> Enrico Rossi
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
http://had.co.nz/


From dylan.beaudette at gmail.com  Mon Apr 27 01:13:38 2009
From: dylan.beaudette at gmail.com (Dylan Beaudette)
Date: Sun, 26 Apr 2009 16:13:38 -0700
Subject: [R-sig-Geo] zip code map - huge files!
In-Reply-To: <f8e6ff050904261553u14b55f56ke8de09e5f1783d4b@mail.gmail.com>
References: <e303ddae0904261306q24cbc600qa68c798ba9d39346@mail.gmail.com>
	<f8e6ff050904261553u14b55f56ke8de09e5f1783d4b@mail.gmail.com>
Message-ID: <3c5546140904261613i7b0a50eap2e2e95676b4f167b@mail.gmail.com>

Hi,

You can use the v.generalize command in GRASS to reduce the complexity
of vectors like these.

Cheers,
Dylan

On Sun, Apr 26, 2009 at 3:53 PM, hadley wickham <h.wickham at gmail.com> wrote:
> Hi Enrico,
>
> I have some code to do map generalisation (reducing map resolution
> without visible loss in detail) at
> http://github.com/hadley/data-counties/tree/master. ?It's applied to
> counties data, but would be trivial (if slow) to modify to work with
> zip codes instead
>
> Hadley
>
> On Sun, Apr 26, 2009 at 3:06 PM, Enrico Rossi <enrico.a.rossi at gmail.com> wrote:
>> Hello,
>>
>> I have some data at the zip code level, and I'm using the shapefiles
>> downloaded from the Census TigerLine website
>> (http://www2.census.gov/geo/tiger/TIGER2008/tl_2008_us_zcta5.zip) to
>> plot a shaded map of the US. However, the files generated in this way
>> are enormous, and take a long time to process, even on a fast machine
>> with lots of memory. I'm wondering if there's a more efficient way to
>> do this. Maybe rasterize before plotting somehow?
>>
>> If anyone on this list has experience working with zip-level data, I'd
>> appreciate any advice.
>>
>> Here's some example code like what I'm doing:
>>
>> # This works, and produces a 1.2GB PDF file! After it's done, I can
>> rasterize it using gs to reduce file size, but it takes almost an hour
>> library(maptools)
>> zip<-readShapePoly("tl_2008_us_zcta5") ?# This takes a while!
>> val<-runif(length(zip[[1]])) # there are about 32000 zip codes
>> pdf("zipplot.pdf")
>> plot(zip,xlim=c(-130,-65),ylim=c(20,50),col=grey(val),lty=0)
>> dev.off()
>> system("gs -dSAFER -dBATCH -dNOPAUSE -sDEVICE=png16m -r300
>> -dTextAlphaBits=4 -dGraphicsAlphaBits=4 -dMaxStripSize=8192
>> -sOutputFile=zipplot.png zipplot.pdf")
>>
>> # I've tried plotting directly to png, but it just seems to hang, my
>> patience ran out after two hours
>> png("zipplot.png")
>> plot(zip,xlim=c(-130,-65),ylim=c(20,50),col=grey(val),lty=0)
>> dev.off()
>>
>> # This also takes too long, I never got any output out of it
>> library(lattice)
>> zip$val<-val
>> pdf("zipplot2.pdf")
>> spplot(zip,"val",xlim=c(-130,-65),ylim=c(20,50),lty=0)
>> dev.off()
>>
>> Many thanks!
>> Enrico Rossi
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
>
> --
> http://had.co.nz/
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From enrico.a.rossi at gmail.com  Mon Apr 27 02:54:06 2009
From: enrico.a.rossi at gmail.com (Enrico Rossi)
Date: Sun, 26 Apr 2009 20:54:06 -0400
Subject: [R-sig-Geo] zip code map - huge files!
In-Reply-To: <3c5546140904261613i7b0a50eap2e2e95676b4f167b@mail.gmail.com>
References: <e303ddae0904261306q24cbc600qa68c798ba9d39346@mail.gmail.com>
	<f8e6ff050904261553u14b55f56ke8de09e5f1783d4b@mail.gmail.com>
	<3c5546140904261613i7b0a50eap2e2e95676b4f167b@mail.gmail.com>
Message-ID: <e303ddae0904261754o45794974m4fbefe5effc67d3a@mail.gmail.com>

Hi all,

Thanks for your responses! Dylan, unfortunately I can't install GRASS
(although I'm working on getting it approved).
Hadley, your code sounds very promising. Which bit of code should I
look at? thin? thin-better? Will these methods work with SpatialPoly
objects?

Many thanks,
Enrico

On Sun, Apr 26, 2009 at 7:13 PM, Dylan Beaudette
<dylan.beaudette at gmail.com> wrote:
> Hi,
>
> You can use the v.generalize command in GRASS to reduce the complexity
> of vectors like these.
>
> Cheers,
> Dylan
>
> On Sun, Apr 26, 2009 at 3:53 PM, hadley wickham <h.wickham at gmail.com> wrote:
>> Hi Enrico,
>>
>> I have some code to do map generalisation (reducing map resolution
>> without visible loss in detail) at
>> http://github.com/hadley/data-counties/tree/master. ?It's applied to
>> counties data, but would be trivial (if slow) to modify to work with
>> zip codes instead
>>
>> Hadley
>>
>> On Sun, Apr 26, 2009 at 3:06 PM, Enrico Rossi <enrico.a.rossi at gmail.com> wrote:
>>> Hello,
>>>
>>> I have some data at the zip code level, and I'm using the shapefiles
>>> downloaded from the Census TigerLine website
>>> (http://www2.census.gov/geo/tiger/TIGER2008/tl_2008_us_zcta5.zip) to
>>> plot a shaded map of the US. However, the files generated in this way
>>> are enormous, and take a long time to process, even on a fast machine
>>> with lots of memory. I'm wondering if there's a more efficient way to
>>> do this. Maybe rasterize before plotting somehow?
>>>
>>> If anyone on this list has experience working with zip-level data, I'd
>>> appreciate any advice.
>>>
>>> Here's some example code like what I'm doing:
>>>
>>> # This works, and produces a 1.2GB PDF file! After it's done, I can
>>> rasterize it using gs to reduce file size, but it takes almost an hour
>>> library(maptools)
>>> zip<-readShapePoly("tl_2008_us_zcta5") ?# This takes a while!
>>> val<-runif(length(zip[[1]])) # there are about 32000 zip codes
>>> pdf("zipplot.pdf")
>>> plot(zip,xlim=c(-130,-65),ylim=c(20,50),col=grey(val),lty=0)
>>> dev.off()
>>> system("gs -dSAFER -dBATCH -dNOPAUSE -sDEVICE=png16m -r300
>>> -dTextAlphaBits=4 -dGraphicsAlphaBits=4 -dMaxStripSize=8192
>>> -sOutputFile=zipplot.png zipplot.pdf")
>>>
>>> # I've tried plotting directly to png, but it just seems to hang, my
>>> patience ran out after two hours
>>> png("zipplot.png")
>>> plot(zip,xlim=c(-130,-65),ylim=c(20,50),col=grey(val),lty=0)
>>> dev.off()
>>>
>>> # This also takes too long, I never got any output out of it
>>> library(lattice)
>>> zip$val<-val
>>> pdf("zipplot2.pdf")
>>> spplot(zip,"val",xlim=c(-130,-65),ylim=c(20,50),lty=0)
>>> dev.off()
>>>
>>> Many thanks!
>>> Enrico Rossi
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>>
>>
>> --
>> http://had.co.nz/
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>


From tech_dev at wildintellect.com  Mon Apr 27 03:46:54 2009
From: tech_dev at wildintellect.com (Alex Mandel)
Date: Sun, 26 Apr 2009 18:46:54 -0700
Subject: [R-sig-Geo] zip code map - huge files!
In-Reply-To: <e303ddae0904261306q24cbc600qa68c798ba9d39346@mail.gmail.com>
References: <e303ddae0904261306q24cbc600qa68c798ba9d39346@mail.gmail.com>
Message-ID: <49F50E8E.3040605@wildintellect.com>

Enrico Rossi wrote:
> Hello,
> 
> I have some data at the zip code level, and I'm using the shapefiles
> downloaded from the Census TigerLine website
> (http://www2.census.gov/geo/tiger/TIGER2008/tl_2008_us_zcta5.zip) to
> plot a shaded map of the US. However, the files generated in this way
> are enormous, and take a long time to process, even on a fast machine
> with lots of memory. I'm wondering if there's a more efficient way to
> do this. Maybe rasterize before plotting somehow?
> 
> If anyone on this list has experience working with zip-level data, I'd
> appreciate any advice.
> 
> Here's some example code like what I'm doing:
> 
> # This works, and produces a 1.2GB PDF file! After it's done, I can
> rasterize it using gs to reduce file size, but it takes almost an hour
> library(maptools)
> zip<-readShapePoly("tl_2008_us_zcta5")  # This takes a while!
> val<-runif(length(zip[[1]])) # there are about 32000 zip codes
> pdf("zipplot.pdf")
> plot(zip,xlim=c(-130,-65),ylim=c(20,50),col=grey(val),lty=0)
> dev.off()
> system("gs -dSAFER -dBATCH -dNOPAUSE -sDEVICE=png16m -r300
> -dTextAlphaBits=4 -dGraphicsAlphaBits=4 -dMaxStripSize=8192
> -sOutputFile=zipplot.png zipplot.pdf")
> 
> # I've tried plotting directly to png, but it just seems to hang, my
> patience ran out after two hours
> png("zipplot.png")
> plot(zip,xlim=c(-130,-65),ylim=c(20,50),col=grey(val),lty=0)
> dev.off()
> 
> # This also takes too long, I never got any output out of it
> library(lattice)
> zip$val<-val
> pdf("zipplot2.pdf")
> spplot(zip,"val",xlim=c(-130,-65),ylim=c(20,50),lty=0)
> dev.off()
> 
> Many thanks!
> Enrico Rossi
> 

Enrico,

What size map are you making, and how is it going to be used?
Zip code seems like a fairly small size area to plot over such a large
area, especially when you think about small cities that are only 5-10
miles wide but have 2-4 zip codes.

Have you considered aggregating neighbors based on some geographic or
other parameter.

Alex


From h.wickham at gmail.com  Mon Apr 27 04:37:21 2009
From: h.wickham at gmail.com (hadley wickham)
Date: Sun, 26 Apr 2009 21:37:21 -0500
Subject: [R-sig-Geo] zip code map - huge files!
In-Reply-To: <3c5546140904261613i7b0a50eap2e2e95676b4f167b@mail.gmail.com>
References: <e303ddae0904261306q24cbc600qa68c798ba9d39346@mail.gmail.com>
	<f8e6ff050904261553u14b55f56ke8de09e5f1783d4b@mail.gmail.com>
	<3c5546140904261613i7b0a50eap2e2e95676b4f167b@mail.gmail.com>
Message-ID: <f8e6ff050904261937q44ecbdcdjf4c25e28f72106bd@mail.gmail.com>

Yes, this is basically the method that my code implements, although I
definitely preserve all junction points, and it's not clear from the
description whether v.generalize does or not.

Hadley

On Sun, Apr 26, 2009 at 6:13 PM, Dylan Beaudette
<dylan.beaudette at gmail.com> wrote:
> Hi,
>
> You can use the v.generalize command in GRASS to reduce the complexity
> of vectors like these.
>
> Cheers,
> Dylan
>
> On Sun, Apr 26, 2009 at 3:53 PM, hadley wickham <h.wickham at gmail.com> wrote:
>> Hi Enrico,
>>
>> I have some code to do map generalisation (reducing map resolution
>> without visible loss in detail) at
>> http://github.com/hadley/data-counties/tree/master. ?It's applied to
>> counties data, but would be trivial (if slow) to modify to work with
>> zip codes instead
>>
>> Hadley
>>
>> On Sun, Apr 26, 2009 at 3:06 PM, Enrico Rossi <enrico.a.rossi at gmail.com> wrote:
>>> Hello,
>>>
>>> I have some data at the zip code level, and I'm using the shapefiles
>>> downloaded from the Census TigerLine website
>>> (http://www2.census.gov/geo/tiger/TIGER2008/tl_2008_us_zcta5.zip) to
>>> plot a shaded map of the US. However, the files generated in this way
>>> are enormous, and take a long time to process, even on a fast machine
>>> with lots of memory. I'm wondering if there's a more efficient way to
>>> do this. Maybe rasterize before plotting somehow?
>>>
>>> If anyone on this list has experience working with zip-level data, I'd
>>> appreciate any advice.
>>>
>>> Here's some example code like what I'm doing:
>>>
>>> # This works, and produces a 1.2GB PDF file! After it's done, I can
>>> rasterize it using gs to reduce file size, but it takes almost an hour
>>> library(maptools)
>>> zip<-readShapePoly("tl_2008_us_zcta5") ?# This takes a while!
>>> val<-runif(length(zip[[1]])) # there are about 32000 zip codes
>>> pdf("zipplot.pdf")
>>> plot(zip,xlim=c(-130,-65),ylim=c(20,50),col=grey(val),lty=0)
>>> dev.off()
>>> system("gs -dSAFER -dBATCH -dNOPAUSE -sDEVICE=png16m -r300
>>> -dTextAlphaBits=4 -dGraphicsAlphaBits=4 -dMaxStripSize=8192
>>> -sOutputFile=zipplot.png zipplot.pdf")
>>>
>>> # I've tried plotting directly to png, but it just seems to hang, my
>>> patience ran out after two hours
>>> png("zipplot.png")
>>> plot(zip,xlim=c(-130,-65),ylim=c(20,50),col=grey(val),lty=0)
>>> dev.off()
>>>
>>> # This also takes too long, I never got any output out of it
>>> library(lattice)
>>> zip$val<-val
>>> pdf("zipplot2.pdf")
>>> spplot(zip,"val",xlim=c(-130,-65),ylim=c(20,50),lty=0)
>>> dev.off()
>>>
>>> Many thanks!
>>> Enrico Rossi
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>>
>>
>> --
>> http://had.co.nz/
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>



-- 
http://had.co.nz/


From h.wickham at gmail.com  Mon Apr 27 04:47:05 2009
From: h.wickham at gmail.com (hadley wickham)
Date: Sun, 26 Apr 2009 21:47:05 -0500
Subject: [R-sig-Geo] zip code map - huge files!
In-Reply-To: <e303ddae0904261754o45794974m4fbefe5effc67d3a@mail.gmail.com>
References: <e303ddae0904261306q24cbc600qa68c798ba9d39346@mail.gmail.com>
	<f8e6ff050904261553u14b55f56ke8de09e5f1783d4b@mail.gmail.com>
	<3c5546140904261613i7b0a50eap2e2e95676b4f167b@mail.gmail.com>
	<e303ddae0904261754o45794974m4fbefe5effc67d3a@mail.gmail.com>
Message-ID: <f8e6ff050904261947t5a17979cne7720ae40d47d709@mail.gmail.com>

Hi Enrico,

Start with county-to-csv.r - that converts the shape files to normal
csv files.  Then look at thin-all.r, which actually does the thinning
- although I see that I've forgotten to source thin-better.csv.  I
don't have any code to convert it back to into shapefiles because I
don't use them myself.

Hadley


On Sun, Apr 26, 2009 at 7:54 PM, Enrico Rossi <enrico.a.rossi at gmail.com> wrote:
> Hi all,
>
> Thanks for your responses! Dylan, unfortunately I can't install GRASS
> (although I'm working on getting it approved).
> Hadley, your code sounds very promising. Which bit of code should I
> look at? thin? thin-better? Will these methods work with SpatialPoly
> objects?
>
> Many thanks,
> Enrico
>
> On Sun, Apr 26, 2009 at 7:13 PM, Dylan Beaudette
> <dylan.beaudette at gmail.com> wrote:
>> Hi,
>>
>> You can use the v.generalize command in GRASS to reduce the complexity
>> of vectors like these.
>>
>> Cheers,
>> Dylan
>>
>> On Sun, Apr 26, 2009 at 3:53 PM, hadley wickham <h.wickham at gmail.com> wrote:
>>> Hi Enrico,
>>>
>>> I have some code to do map generalisation (reducing map resolution
>>> without visible loss in detail) at
>>> http://github.com/hadley/data-counties/tree/master. ?It's applied to
>>> counties data, but would be trivial (if slow) to modify to work with
>>> zip codes instead
>>>
>>> Hadley
>>>
>>> On Sun, Apr 26, 2009 at 3:06 PM, Enrico Rossi <enrico.a.rossi at gmail.com> wrote:
>>>> Hello,
>>>>
>>>> I have some data at the zip code level, and I'm using the shapefiles
>>>> downloaded from the Census TigerLine website
>>>> (http://www2.census.gov/geo/tiger/TIGER2008/tl_2008_us_zcta5.zip) to
>>>> plot a shaded map of the US. However, the files generated in this way
>>>> are enormous, and take a long time to process, even on a fast machine
>>>> with lots of memory. I'm wondering if there's a more efficient way to
>>>> do this. Maybe rasterize before plotting somehow?
>>>>
>>>> If anyone on this list has experience working with zip-level data, I'd
>>>> appreciate any advice.
>>>>
>>>> Here's some example code like what I'm doing:
>>>>
>>>> # This works, and produces a 1.2GB PDF file! After it's done, I can
>>>> rasterize it using gs to reduce file size, but it takes almost an hour
>>>> library(maptools)
>>>> zip<-readShapePoly("tl_2008_us_zcta5") ?# This takes a while!
>>>> val<-runif(length(zip[[1]])) # there are about 32000 zip codes
>>>> pdf("zipplot.pdf")
>>>> plot(zip,xlim=c(-130,-65),ylim=c(20,50),col=grey(val),lty=0)
>>>> dev.off()
>>>> system("gs -dSAFER -dBATCH -dNOPAUSE -sDEVICE=png16m -r300
>>>> -dTextAlphaBits=4 -dGraphicsAlphaBits=4 -dMaxStripSize=8192
>>>> -sOutputFile=zipplot.png zipplot.pdf")
>>>>
>>>> # I've tried plotting directly to png, but it just seems to hang, my
>>>> patience ran out after two hours
>>>> png("zipplot.png")
>>>> plot(zip,xlim=c(-130,-65),ylim=c(20,50),col=grey(val),lty=0)
>>>> dev.off()
>>>>
>>>> # This also takes too long, I never got any output out of it
>>>> library(lattice)
>>>> zip$val<-val
>>>> pdf("zipplot2.pdf")
>>>> spplot(zip,"val",xlim=c(-130,-65),ylim=c(20,50),lty=0)
>>>> dev.off()
>>>>
>>>> Many thanks!
>>>> Enrico Rossi
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at stat.math.ethz.ch
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>
>>>
>>>
>>> --
>>> http://had.co.nz/
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>



-- 
http://had.co.nz/


From Jin.Li at ga.gov.au  Tue Apr 28 03:40:10 2009
From: Jin.Li at ga.gov.au (Jin.Li at ga.gov.au)
Date: Tue, 28 Apr 2009 11:40:10 +1000
Subject: [R-sig-Geo] Projection of a large spherical surface on to a plane
 [SEC=UNCLASSIFIED]
Message-ID: <8D2A822B1C6C2A44ABEB777AA83FA0E32C5D7B6B4A@EXCCR01.agso.gov.au>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090428/dfc2a95b/attachment.pl>

From j.burke at earthlink.net  Tue Apr 28 05:14:31 2009
From: j.burke at earthlink.net (Jim Burke)
Date: Mon, 27 Apr 2009 22:14:31 -0500
Subject: [R-sig-Geo] Iterating and finding points in a spatial polygon
Message-ID: <49F67497.4000006@earthlink.net>

Thanks in advance. All insight is appreciated. R is great!

HELP NEEDED DESCRIPTION
==============================
A. Matching the "lappt" to the spatial polygon. To correctly retrieve 
the "labpt" to use
    in method ptp().

    Working from the example found below. There might be a better way.
    
http://nceas.ucsb.edu/scicomp/GISSeminar/UseCases/PointInPolygonAnalysis/point_in_poly.html

B. Iteration through the two spatial polygons.

POLYGON DESCRIPTION, ITERATION, OUTPUT
==============================

1. blk_sp contains many spatial polygons that fit entirely
    into different pct_big_sp spatial polygons. No
    overlapping exists.

    Yes these are US census blocks

2. pct_big_sp contains around thirty different blk_sp
    spatial polygons.

    Yes these are precincts that contain the census blocks.

3. How this might work.

    a. iterate through every pct_big_sp, then blk_sp

    b. compares the blk_sp "labpt" (lat long format) to the
       outside edge of the larger polygon b_big_sp. Probably
       with pip().

    c. output the matching blk_sp IDs into an match_df data
       frame. On a match, gather the following items as we
       iterate.
       . blk_sp's ID     name BLK
       . pct_big_sp's ID name PCT

    d. c_df output data frame example.
       BLK               PCT
       "480019510006079",1811
       "480019510006080",1811
       "480019510006998",1811
       "480019510006999",1811
       "480039501003000",1120
       "480039501003001",1120
       "480039501003002",1120
       "480039501003003",1120

Thanks,
Jim Burke


From j.burke at earthlink.net  Tue Apr 28 08:04:58 2009
From: j.burke at earthlink.net (Jim Burke)
Date: Tue, 28 Apr 2009 01:04:58 -0500
Subject: [R-sig-Geo] Iterating and finding points in a spatial polygon -
 VERSION 2 Ignore earlier send!
Message-ID: <49F69C8A.6020401@earthlink.net>

This is version 2. Clearer description. Ignore the earlier one.

Thanks in advance. All insight is appreciated. R is great!

HELP NEEDED DESCRIPTION
==============================
A. Matching the "lappt" to the spatial polygon. To correctly retrieve 
the Slot "labpt" to use
  in method ptp(). Slot "labpt" and measurements are all in WSG84 long 
lat (see below).

  Slot "labpt":
  [1] -96.75983  32.93319

  Working from the example found below. There might be a better way.
  
http://nceas.ucsb.edu/scicomp/GISSeminar/UseCases/PointInPolygonAnalysis/point_in_poly.html 


B. Iteration through all polygons in each of the two spatial polygon 
data frames.

POLYGON DESCRIPTION, ITERATION, OUTPUT
==============================

1. blk_sp contains many spatial polygons that fit entirely
  into different pct_big_sp spatial polygons. No
  overlapping exists.

  Yes these are US census blocks

2. pct_big_sp contains around thirty different blk_sp
  spatial polygons.

  Yes these are precincts that contain the census blocks.

3. How this might work.

  a. iterate through every pct_big_sp, then blk_sp

  b. compares the blk_sp Slot "labpt" (lat long format) to the
     outside edge of the larger polygon b_big_sp. Probably
     with pip().

  c. output the matching blk_sp IDs into an match_df data
     frame. On a match, gather the following items as we
     iterate.
     . blk_sp's ID     name BLK
     . pct_big_sp's ID name PCT

  d. c_df output data frame example.
     BLK               PCT
     "480019510006079",1811
     "480019510006080",1811
     "480019510006998",1811
     "480019510006999",1811
     "480039501003000",1120
     "480039501003001",1120
     "480039501003002",1120
     "480039501003003",1120

Thanks,
Jim Burke


From p.hiemstra at geo.uu.nl  Tue Apr 28 11:37:17 2009
From: p.hiemstra at geo.uu.nl (Paul Hiemstra)
Date: Tue, 28 Apr 2009 11:37:17 +0200
Subject: [R-sig-Geo] Projection of a large spherical surface on to a
 plane [SEC=UNCLASSIFIED]
In-Reply-To: <8D2A822B1C6C2A44ABEB777AA83FA0E32C5D7B6B4A@EXCCR01.agso.gov.au>
References: <8D2A822B1C6C2A44ABEB777AA83FA0E32C5D7B6B4A@EXCCR01.agso.gov.au>
Message-ID: <49F6CE4D.5040304@geo.uu.nl>

Hi Jin Li,

I seem to remember that gstat can deal with Great circle distances, but 
I could be wrong as I have never used them before. You say that a 
certain projection does not produce satisfactory results, how have you 
defined satisfactory?

cheers,
Paul

Jin.Li at ga.gov.au wrote:
> Dear all,
>
> We are going to interpolate biophysical variables into continuous surface data using point samples in Australian EEZ that covers an area of 10 utm zones and ca. 44 degrees in terms of latitude. Our data is in lat and long (i.e., WGS84). We intend to apply kriging methods to such a big area. Of course, we can divide the whole EEZ into some subregions and actually we are going to divide it into some subregions based on a number of factors, but these sub-regions are still quite large and can cover 2 to 3 utms and 7-15 degrees in terms of latitude. Obviously it is not quite appropriate to treat a spherical surface as a plane. Given that kriging can not handle a spherical surface (hope this assumption is still valid), perhaps an alternative is project such spherical surface on to a plane. We have tried some equal distance projections to convert our data for Australian EEZ, but it seems that none of them can produce satisfactory projections, although sinusoidal gave slightly bette!
>  r results in comparison with utm projection. Any suggestions? Thanks in advance.
>
> Cheers,
>
> Jin
> _______________________________________
> Jin Li, PhD
> Spatial Modeller/Computational Statistician
> Marine & Coastal Environment
> Geoscience Australia
> GPO Box 378, Canberra, ACT 2601, Australia
>
> Ph: 61 (02) 6249 9899; email: jin.li at ga.gov.au<mailto:jin.li at ga.gov.au>
> _______________________________________
>
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   


-- 
Drs. Paul Hiemstra
Department of Physical Geography
Faculty of Geosciences
University of Utrecht
Heidelberglaan 2
P.O. Box 80.115
3508 TC Utrecht
Phone:  +3130 274 3113 Mon-Tue
Phone:  +3130 253 5773 Wed-Fri
http://intamap.geo.uu.nl/~paul


From alobolistas at gmail.com  Tue Apr 28 12:31:47 2009
From: alobolistas at gmail.com (Agustin Lobo)
Date: Tue, 28 Apr 2009 12:31:47 +0200
Subject: [R-sig-Geo] readRAST6 problem
Message-ID: <49F6DB13.2090400@gmail.com>

Hi!

I'm getting this message at reading a grass raster file:

rastdum <- readRAST6("nomdum",cat=F)
raster map/current region mismatch detected in components:
           cols            rows origin.northing  origin.easting
           TRUE            TRUE           FALSE            TRUE
set plugin=TRUE to override; continuing with plugin=FALSE
ERROR 6: SetColorTable() only supported for Byte or UInt16 bands in TIFF 
format.
/media/Transcend/Montseny/GrassData//carlos/A_TOTAL/.tmp/caminoccg/nomdum 
has GDAL driver GTiff
and has 94 rows and 116 columns

1. I don't think I have to worry about the ERROR 6:
2. But why is it stating a GTiff driver for reading a grass raster? Is 
there a previous conversion from raster to GTiff?

Thanks

Agus

-- 
Carlos Luis Camino Gonz?lez
Grupo Ecolog?a Del Paisaje
?rea de Biodiversidad
Centro Tecnol?gico Forestal de Catalu?a
Ctra. Sant Lloren? de Morunys, km. 2
Solsona (LLeida)
Tel 973481752
Fax. 973480431
http://todosig.awardspace.com/  Web de Sig y Teledetecci?n   ??en 
Construcci?n!!

-------------- next part --------------
A non-text attachment was scrubbed...
Name: alobolistas.vcf
Type: text/x-vcard
Size: 251 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090428/2a673e66/attachment.vcf>

From Roger.Bivand at nhh.no  Tue Apr 28 12:48:13 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 28 Apr 2009 12:48:13 +0200 (CEST)
Subject: [R-sig-Geo] readRAST6 problem
In-Reply-To: <49F6DB13.2090400@gmail.com>
References: <49F6DB13.2090400@gmail.com>
Message-ID: <alpine.LRH.2.00.0904281243180.24694@reclus.nhh.no>

On Tue, 28 Apr 2009, Agustin Lobo wrote:

> Hi!
>
> I'm getting this message at reading a grass raster file:
>
> rastdum <- readRAST6("nomdum",cat=F)
> raster map/current region mismatch detected in components:
>          cols            rows origin.northing  origin.easting
>          TRUE            TRUE           FALSE            TRUE
> set plugin=TRUE to override; continuing with plugin=FALSE
> ERROR 6: SetColorTable() only supported for Byte or UInt16 bands in TIFF 
> format.
> /media/Transcend/Montseny/GrassData//carlos/A_TOTAL/.tmp/caminoccg/nomdum has 
> GDAL driver GTiff
> and has 94 rows and 116 columns
>
> 1. I don't think I have to worry about the ERROR 6:

No, this message is conditional on your GRASS r.out.gdal version, recent 
versions support a flag to turn off colour table export to GTiff.

> 2. But why is it stating a GTiff driver for reading a grass raster? Is there 
> a previous conversion from raster to GTiff?

Yes, as you will see, your working region and the region of the raster 
differ. The plugin exports the raster in its own region, not the current 
region, while r.out.gdal respects the current region. If the two do not 
match, r.out.gdal/readGDAL are used with a temporary file rather than the 
plugin. To extract the raster in its own region, use execGRASS("g.region", 
parameters=list(rast="nomdum")) first, then the plugin region and the 
current region should be the same.

Hope this helps,

Roger

>
> Thanks
>
> Agus
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From alobolistas at gmail.com  Tue Apr 28 12:52:04 2009
From: alobolistas at gmail.com (Agustin Lobo)
Date: Tue, 28 Apr 2009 12:52:04 +0200
Subject: [R-sig-Geo] [GRASS-stats] R-sig-Geo nabble forum request
In-Reply-To: <1240902173507-2731888.post@n2.nabble.com>
References: <null> <Pine.LNX.4.64.0810160932380.2735@reclus.nhh.no>
	<null>	<null> <1240902173507-2731888.post@n2.nabble.com>
Message-ID: <49F6DFD4.9050101@gmail.com>

Great!
The URL is
http://n2.nabble.com/R-sig-geo-f2731867.html

but it's readonly (I think), we cannot post from there, Posting would be
the real advantage
of using Nabble. Note that anything posted from Nabble goes through the
list, Nabble
is just a front end, users have to be subscribed to the list to post.

Also, I think there might be a way to upload the archive (or part of
it). It's easier to search
the archive through Nabble, and searching the archive is most useful.

A close example would be the Nabble interface for r-sig-ecology:

http://n2.nabble.com/r-sig-ecology-f471788.html

Agus

Roger Bivand wrote:
> OK, the R-sig-geo list is now being archived on Nabble2. We'll see how it
> works ...
>
> Roger
>
>
> Bio7 wrote:
>   
>>
>> Markus Neteler OSGeo wrote:
>>     
>>> Roger Bivand wrote:
>>>       
>>>> On Thu, 16 Oct 2008, Bio7 wrote:
>>>> ...
>>>> Naturally, no-one can stop forum creation, but it does constitute a 
>>>> forking of discussion, where the presumptively useful discussion takes 
>>>> place where developer(s) can see it.
>>>> ...
>>>>
>>>>         
>>> A fork is definitely bad. But AFAIK Nabble is bidirectional. Let's see if
>>> this comes through... (send through nabble).
>>>
>>> Markus
>>>
>>>       
>> And this is the nabble interface to it:
>>
>> http://www.nabble.com/GRASS-f1200.html
>>
>>
>>     
>
>   


-------------- next part --------------
A non-text attachment was scrubbed...
Name: alobolistas.vcf
Type: text/x-vcard
Size: 251 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090428/f4747532/attachment.vcf>

From Roger.Bivand at nhh.no  Tue Apr 28 13:00:39 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 28 Apr 2009 04:00:39 -0700 (PDT)
Subject: [R-sig-Geo] [GRASS-stats] R-sig-Geo nabble forum request
In-Reply-To: <49F6DFD4.9050101@gmail.com>
References: <49F6DFD4.9050101@gmail.com>
Message-ID: <1240916439921-2732681.post@n2.nabble.com>




Agustin Lobo wrote:
> 
> Great!
> The URL is
> http://n2.nabble.com/R-sig-geo-f2731867.html
> 
> but it's readonly (I think), we cannot post from there, Posting would be
> the real advantage
> of using Nabble. Note that anything posted from Nabble goes through the
> list, Nabble
> is just a front end, users have to be subscribed to the list to post.
> 
> 
> I hope that I have fixed this now, but would welcome confirmation.
> 
> Also, I think there might be a way to upload the archive (or part of
> it). It's easier to search
> the archive through Nabble, and searching the archive is most useful.
> 
> No idea.
> 
> Roger
> 
> A close example would be the Nabble interface for r-sig-ecology:
> 
> http://n2.nabble.com/r-sig-ecology-f471788.html
> 
> Agus
> 
> Roger Bivand wrote:
>> OK, the R-sig-geo list is now being archived on Nabble2. We'll see how it
>> works ...
>>
>> Roger
>>
>>
>> Bio7 wrote:
>>   
>>>
>>> Markus Neteler OSGeo wrote:
>>>     
>>>> Roger Bivand wrote:
>>>>       
>>>>> On Thu, 16 Oct 2008, Bio7 wrote:
>>>>> ...
>>>>> Naturally, no-one can stop forum creation, but it does constitute a 
>>>>> forking of discussion, where the presumptively useful discussion takes 
>>>>> place where developer(s) can see it.
>>>>> ...
>>>>>
>>>>>         
>>>> A fork is definitely bad. But AFAIK Nabble is bidirectional. Let's see
>>>> if
>>>> this comes through... (send through nabble).
>>>>
>>>> Markus
>>>>
>>>>       
>>> And this is the nabble interface to it:
>>>
>>> http://www.nabble.com/GRASS-f1200.html
>>>
>>>
>>>     
>>
>>   
> 
> 
> 
> begin:vcard
> fn:Agustin Lobo
> n:Lobo;Agustin
> org:Institut de Ciencies de la Terra "Jaume Almera" CSIC
> adr:;;Lluis Sole Sabris s/n;Barcelona;;08028;Spain
> email;internet:Agustin.Lobo at ija.csic.es
> url:http://www.ija.csic.es/gt/obster
> version:2.1
> end:vcard
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 


-----
Roger Bivand
Economic Geography Section
Department of Economics
Norwegian School of Economics and Business Administration
Helleveien 30
N-5045 Bergen, Norway

-- 
View this message in context: http://n2.nabble.com/Re%3A--GRASS-stats--R-sig-Geo-nabble-forum-request-tp2732653p2732681.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From alobolistas at gmail.com  Tue Apr 28 13:18:19 2009
From: alobolistas at gmail.com (Agustin Lobo)
Date: Tue, 28 Apr 2009 13:18:19 +0200
Subject: [R-sig-Geo] readRAST6 problem
In-Reply-To: <alpine.LRH.2.00.0904281243180.24694@reclus.nhh.no>
References: <49F6DB13.2090400@gmail.com>
	<alpine.LRH.2.00.0904281243180.24694@reclus.nhh.no>
Message-ID: <49F6E5FB.1000809@gmail.com>

In my case, I do not see the reason why the current region and the 
raster region should be
different. Everything is within a for() loop, in which I
set the region,
create a MASK,
create a raster with r.mapcalc (hence the same region than the current 
region)
import the raster to R

It's not critical for what I'm doing now (R calculates a textural 
statistics for small irregular windows)
but could be a problem if I had to bring back an R-modified SGDF to 
grass, right?

(btw, I never know if I can/have to CC to grass-stats about these 
issues, there is the cross-posting
problem)

Agus

Roger Bivand wrote:
> On Tue, 28 Apr 2009, Agustin Lobo wrote:
>
>> Hi!
>>
>> I'm getting this message at reading a grass raster file:
>>
>> rastdum <- readRAST6("nomdum",cat=F)
>> raster map/current region mismatch detected in components:
>> cols rows origin.northing origin.easting
>> TRUE TRUE FALSE TRUE
>> set plugin=TRUE to override; continuing with plugin=FALSE
>> ERROR 6: SetColorTable() only supported for Byte or UInt16 bands in 
>> TIFF format.
>> /media/Transcend/Montseny/GrassData//carlos/A_TOTAL/.tmp/caminoccg/nomdum 
>> has GDAL driver GTiff
>> and has 94 rows and 116 columns
>>
>> 1. I don't think I have to worry about the ERROR 6:
>
> No, this message is conditional on your GRASS r.out.gdal version, 
> recent versions support a flag to turn off colour table export to GTiff.
>
>> 2. But why is it stating a GTiff driver for reading a grass raster? 
>> Is there a previous conversion from raster to GTiff?
>
> Yes, as you will see, your working region and the region of the raster 
> differ. The plugin exports the raster in its own region, not the 
> current region, while r.out.gdal respects the current region. If the 
> two do not match, r.out.gdal/readGDAL are used with a temporary file 
> rather than the plugin. To extract the raster in its own region, use 
> execGRASS("g.region", parameters=list(rast="nomdum")) first, then the 
> plugin region and the current region should be the same.
>
> Hope this helps,
>
> Roger
>
>>
>> Thanks
>>
>> Agus
>>
>>
>

-------------- next part --------------
A non-text attachment was scrubbed...
Name: alobolistas.vcf
Type: text/x-vcard
Size: 251 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090428/11e14473/attachment.vcf>

From edzer.pebesma at uni-muenster.de  Tue Apr 28 13:23:09 2009
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 28 Apr 2009 13:23:09 +0200
Subject: [R-sig-Geo] Projection of a large spherical surface on to a
 plane [SEC=UNCLASSIFIED]
In-Reply-To: <49F6CE4D.5040304@geo.uu.nl>
References: <8D2A822B1C6C2A44ABEB777AA83FA0E32C5D7B6B4A@EXCCR01.agso.gov.au>
	<49F6CE4D.5040304@geo.uu.nl>
Message-ID: <49F6E71D.6070108@uni-muenster.de>

Paul, as mentioned here:

https://stat.ethz.ch/pipermail/r-sig-geo/2008-October/004456.html

gstat does use spherical distances when data are in geographical
coordinates, however the usual variogram models are typically not
non-negative definite on the sphere, and no appropriate models are
available. Some people use it despite this, but it would surely worry
me. In experiments with random points and an exponential variogram
without nugget, I've found very weird results.

To be honest I dislike it so much that I'm thinking about making it as
hard as cokriging without a valid LMC: break with an error message that
you could override, as for experimenting, and so protecting people who
don't understand what positive definite means.
--
Edzer

Paul Hiemstra wrote:
> Hi Jin Li,
>
> I seem to remember that gstat can deal with Great circle distances,
> but I could be wrong as I have never used them before. You say that a
> certain projection does not produce satisfactory results, how have you
> defined satisfactory?
>
> cheers,
> Paul
>
> Jin.Li at ga.gov.au wrote:
>> Dear all,
>>
>> We are going to interpolate biophysical variables into continuous
>> surface data using point samples in Australian EEZ that covers an
>> area of 10 utm zones and ca. 44 degrees in terms of latitude. Our
>> data is in lat and long (i.e., WGS84). We intend to apply kriging
>> methods to such a big area. Of course, we can divide the whole EEZ
>> into some subregions and actually we are going to divide it into some
>> subregions based on a number of factors, but these sub-regions are
>> still quite large and can cover 2 to 3 utms and 7-15 degrees in terms
>> of latitude. Obviously it is not quite appropriate to treat a
>> spherical surface as a plane. Given that kriging can not handle a
>> spherical surface (hope this assumption is still valid), perhaps an
>> alternative is project such spherical surface on to a plane. We have
>> tried some equal distance projections to convert our data for
>> Australian EEZ, but it seems that none of them can produce
>> satisfactory projections, although sinusoidal gave slightly bet!
> te!
>>  r results in comparison with utm projection. Any suggestions? Thanks
>> in advance.
>>
>> Cheers,
>>
>> Jin
>> _______________________________________
>> Jin Li, PhD
>> Spatial Modeller/Computational Statistician
>> Marine & Coastal Environment
>> Geoscience Australia
>> GPO Box 378, Canberra, ACT 2601, Australia
>>
>> Ph: 61 (02) 6249 9899; email: jin.li at ga.gov.au<mailto:jin.li at ga.gov.au>
>> _______________________________________
>>
>>
>>
>>     [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>   
>
>

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de/
http://www.springer.com/978-0-387-78170-9 e.pebesma at wwu.de


From martin.renner at stonebow.otago.ac.nz  Tue Apr 28 19:01:29 2009
From: martin.renner at stonebow.otago.ac.nz (Martin Renner)
Date: Tue, 28 Apr 2009 09:01:29 -0800
Subject: [R-sig-Geo] Projection of a large spherical surface on to a
	plane [SEC=UNCLASSIFIED]
In-Reply-To: <49F6CE4D.5040304@geo.uu.nl>
References: <8D2A822B1C6C2A44ABEB777AA83FA0E32C5D7B6B4A@EXCCR01.agso.gov.au>
	<49F6CE4D.5040304@geo.uu.nl>
Message-ID: <1C90271C-CA48-460C-9084-944B2E1C922B@stonebow.otago.ac.nz>

While it should be straightforward to calculate great circle  
distances, designing a rectangular grid on a sphere is not. There's a  
solution for a global grid using hexagons (Teanby, 2006), but I  
haven't seen it implemented in R (yet). My gut feeling is that for  
Australia there's a standard projection used by geographers that's  
reasonably distortion-free and should be plenty accurate given that  
you're working on such a large scale. Checking the fine print of that  
big map on your wall might be a good start.

HTH,
Martin


Martin Renner					
current address:
Alaska Maritime NWR             		907-226-4672 (work)
Homer, AK 99603, USA				907-235-7783 (fax)





@article{Teanby:2006aa,
	Author = {Teanby, N. A.},
	Journal = {Computers and Geosciences},
	Number = {9},
	Pages = {1442--1450},
	Title = {An icosahedron-based method for even binning of globally  
distributed remote sensing data},
	Volume = {32},
	Year = {2006}}





On 28 Apr 2009, at 01:37 , Paul Hiemstra wrote:

> Hi Jin Li,
>
> I seem to remember that gstat can deal with Great circle distances,  
> but I could be wrong as I have never used them before. You say that  
> a certain projection does not produce satisfactory results, how have  
> you defined satisfactory?
>
> cheers,
> Paul
>
> Jin.Li at ga.gov.au wrote:
>> Dear all,
>>
>> We are going to interpolate biophysical variables into continuous  
>> surface data using point samples in Australian EEZ that covers an  
>> area of 10 utm zones and ca. 44 degrees in terms of latitude. Our  
>> data is in lat and long (i.e., WGS84). We intend to apply kriging  
>> methods to such a big area. Of course, we can divide the whole EEZ  
>> into some subregions and actually we are going to divide it into  
>> some subregions based on a number of factors, but these sub-regions  
>> are still quite large and can cover 2 to 3 utms and 7-15 degrees in  
>> terms of latitude. Obviously it is not quite appropriate to treat a  
>> spherical surface as a plane. Given that kriging can not handle a  
>> spherical surface (hope this assumption is still valid), perhaps an  
>> alternative is project such spherical surface on to a plane. We  
>> have tried some equal distance projections to convert our data for  
>> Australian EEZ, but it seems that none of them can produce  
>> satisfactory projections, although sinusoidal gave slightly bet!
> te!
>> r results in comparison with utm projection. Any suggestions?  
>> Thanks in advance.
>>
>> Cheers,
>>
>> Jin
>> _______________________________________
>> Jin Li, PhD
>> Spatial Modeller/Computational Statistician
>> Marine & Coastal Environment
>> Geoscience Australia
>> GPO Box 378, Canberra, ACT 2601, Australia
>>
>> Ph: 61 (02) 6249 9899; email: jin.li at ga.gov.au<mailto:jin.li at ga.gov.au 
>> >
>> _______________________________________
>>
>>
>>
>> 	[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
> -- 
> Drs. Paul Hiemstra
> Department of Physical Geography
> Faculty of Geosciences
> University of Utrecht
> Heidelberglaan 2
> P.O. Box 80.115
> 3508 TC Utrecht
> Phone:  +3130 274 3113 Mon-Tue
> Phone:  +3130 253 5773 Wed-Fri
> http://intamap.geo.uu.nl/~paul
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From alinashe at gmail.com  Tue Apr 28 22:47:05 2009
From: alinashe at gmail.com (Alina Sheyman)
Date: Tue, 28 Apr 2009 16:47:05 -0400
Subject: [R-sig-Geo] unique spatial polygons
Message-ID: <f58db2700904281347q11449bcdl26571eb80aa6030c@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090428/e646c951/attachment.pl>

From Roger.Bivand at nhh.no  Wed Apr 29 08:42:35 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 29 Apr 2009 08:42:35 +0200 (CEST)
Subject: [R-sig-Geo] unique spatial polygons
In-Reply-To: <f58db2700904281347q11449bcdl26571eb80aa6030c@mail.gmail.com>
References: <f58db2700904281347q11449bcdl26571eb80aa6030c@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.0904290825150.30188@reclus.nhh.no>

On Tue, 28 Apr 2009, Alina Sheyman wrote:

> I'm trying to combine two shapefiles using
> zipmaps5 <- spRbind(zipmaps1,zipmaps2)
>
> and getting the following error message
> Error in spRbind(as(obj, "SpatialPolygons"), as(x, "SpatialPolygons")) :
>  non-unique polygon IDs
>
> Does anyone know how I can get rid of duplicate polygons in a shapefile?

This isn't the problem. The real problem is that zipmaps1 and zipmaps2 
have non-unique polygon IDs, so that it isn't obvious to the function what 
you want to do. By default:

sapply(slot(zipmaps1, "polygons"), slot, "ID")

is set to the FID of the shapefile in readOGR() and equivalently in 
readShapeSpatial() in maptools. These typically run 0:(n-1). For two 
objects, they obviously overlap. Please use spChFIDs() methods in maptools 
to assign IDs that are unique for the output object; in the worst case:

zipmaps1 <- spChFIDs(zipmaps1, paste("map1", sapply(slot(zipmaps1,
   "polygons"), slot, "ID"), sep="_"))

and a different "map*" string for zipmaps2 will work, but a unique, 
meaningful ID is best.

This is covered in detail in the code examples for Chapter 5 in our book, 
and on the help page for ?"spChFIDs-methods".

Hope this helps,

Roger

>
> thank you!
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Jin.Li at ga.gov.au  Wed Apr 29 08:44:28 2009
From: Jin.Li at ga.gov.au (Jin.Li at ga.gov.au)
Date: Wed, 29 Apr 2009 16:44:28 +1000
Subject: [R-sig-Geo] Projection of a large spherical surface on to a
 plane [SEC=UNCLASSIFIED]
In-Reply-To: <49F6E71D.6070108@uni-muenster.de>
Message-ID: <8D2A822B1C6C2A44ABEB777AA83FA0E32C5D7B6B4E@EXCCR01.agso.gov.au>

Thank you all for your kind help.

Following examples from the link provided by Edzer, I tested the difference between:
1. projection specified
coordinates(data.file.dev) = ~LON+LAT
proj4string(data.file.dev)=CRS("+proj=longlat")
vgm1 <- variogram(sqrt(mud)~1, data.file.dev)
model.1 <- fit.variogram(vgm1,vgm(1,"Exp",5,1))
coordinates(data.file.pred) = ~LON+LAT
proj4string(data.file.pred)=CRS("+proj=longlat")
mud.ok <- krige(sqrt(mud)~1, data.file.dev, data.file.pred, model = model.1)
mud.pred<- as.data.frame(mud.ok)

2. projection not specified
coordinates(data.file.dev) = ~LON+LAT
vgm1 <- variogram(sqrt(mud)~1, data.file.dev)
model.1 <- fit.variogram(vgm1,vgm(1,"Exp",5,1))
coordinates(data.file.pred) = ~LON+LAT
mud.ok <- krige(sqrt(mud)~1, data.file.dev, data.file.pred, model = model.1)
mud.pred<- as.data.frame(mud.ok)

The above code was applied to 50 datasets from an area spanning ca. 20 degrees in terms of longitude from 9 to 18 degrees south in latitude. Kriging with projection specified gave 'Warning: singular model in variogram fit' for three datasets and the consequent predictions are poor. After removing the results for these datasets, the average MAE and RMSE for the remaining 47 datasets are:
Projection specified    MAE             RMSE
Yes                             12.986  18.335
No                              12.977  18.326
It seems that the difference in terms of MAE and RMSE is really marginal. Is there any thing wrong with the code or we can really ignore the specification of projection?

To Paul, the impression was based on the comparison of the results from a few equal distance projection methods with utm projection that was used as a control.

To Martin, the projection used for the map you mentioned is Lambert conformal conic. The hexagons method seems doing a good job at pole area, while for regions between 0 to 50 degrees in latitude the effect is not so obvious.

Cheers,
Jin

-----Original Message-----
From: Edzer Pebesma [mailto:edzer.pebesma at uni-muenster.de]
Sent: Tuesday, 28 April 2009 9:23 PM
To: Paul Hiemstra
Cc: Li Jin; r-sig-geo at stat.math.ethz.ch
Subject: Re: [R-sig-Geo] Projection of a large spherical surface on to a plane [SEC=UNCLASSIFIED]

Paul, as mentioned here:

https://stat.ethz.ch/pipermail/r-sig-geo/2008-October/004456.html

gstat does use spherical distances when data are in geographical
coordinates, however the usual variogram models are typically not
non-negative definite on the sphere, and no appropriate models are
available. Some people use it despite this, but it would surely worry
me. In experiments with random points and an exponential variogram
without nugget, I've found very weird results.

To be honest I dislike it so much that I'm thinking about making it as
hard as cokriging without a valid LMC: break with an error message that
you could override, as for experimenting, and so protecting people who
don't understand what positive definite means.
--
Edzer

Paul Hiemstra wrote:
> Hi Jin Li,
>
> I seem to remember that gstat can deal with Great circle distances,
> but I could be wrong as I have never used them before. You say that a
> certain projection does not produce satisfactory results, how have you
> defined satisfactory?
>
> cheers,
> Paul
>
> Jin.Li at ga.gov.au wrote:
>> Dear all,
>>
>> We are going to interpolate biophysical variables into continuous
>> surface data using point samples in Australian EEZ that covers an
>> area of 10 utm zones and ca. 44 degrees in terms of latitude. Our
>> data is in lat and long (i.e., WGS84). We intend to apply kriging
>> methods to such a big area. Of course, we can divide the whole EEZ
>> into some subregions and actually we are going to divide it into some
>> subregions based on a number of factors, but these sub-regions are
>> still quite large and can cover 2 to 3 utms and 7-15 degrees in terms
>> of latitude. Obviously it is not quite appropriate to treat a
>> spherical surface as a plane. Given that kriging can not handle a
>> spherical surface (hope this assumption is still valid), perhaps an
>> alternative is project such spherical surface on to a plane. We have
>> tried some equal distance projections to convert our data for
>> Australian EEZ, but it seems that none of them can produce
>> satisfactory projections, although sinusoidal gave slightly bet!
> te!
>>  r results in comparison with utm projection. Any suggestions? Thanks
>> in advance.
>>
>> Cheers,
>>
>> Jin
>> _______________________________________
>> Jin Li, PhD
>> Spatial Modeller/Computational Statistician
>> Marine & Coastal Environment
>> Geoscience Australia
>> GPO Box 378, Canberra, ACT 2601, Australia
>>
>> Ph: 61 (02) 6249 9899; email: jin.li at ga.gov.au<mailto:jin.li at ga.gov.au>
>> _______________________________________
>>
>>
>>
>>     [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>

--
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de/
http://www.springer.com/978-0-387-78170-9 e.pebesma at wwu.de


From alexandre.villers at cebc.cnrs.fr  Wed Apr 29 12:12:42 2009
From: alexandre.villers at cebc.cnrs.fr (Alexandre VILLERS)
Date: Wed, 29 Apr 2009 12:12:42 +0200
Subject: [R-sig-Geo] Characterizing the position (central vs peripheral) of
 a point in a point pattern
Message-ID: <49F8281A.9020608@cebc.cnrs.fr>

Good morning,

I would like to characterize the position of  a given nest in a 
population of breeding birds. Does anyone know a statisitics (and 
associated R package) that could objectively tell whether a nest has a 
central or peripheral location ? It also needs to be density independent 
(not affected by sample size)
Hope this is a trivial question !

Thanks for your help.

Alex

-- 
Alexandre Villers
PhD Student
Team "Biodiversity"
Centre d'Etudes Biologiques de Chiz?-CNRS UPR1934
79360 Beauvoir sur Niort

Phone +33 (0)5 49 09 96 13
Fax   +33 (0)5 49 09 65 26




__________ Information from ESET Mail Security, version of virus signature database 4042 (20090429) __________

The message was checked by ESET Mail Security.
http://www.eset.com


From alinashe at gmail.com  Wed Apr 29 18:11:09 2009
From: alinashe at gmail.com (Alina Sheyman)
Date: Wed, 29 Apr 2009 12:11:09 -0400
Subject: [R-sig-Geo] unique spatial polygons
In-Reply-To: <alpine.LRH.2.00.0904290825150.30188@reclus.nhh.no>
References: <f58db2700904281347q11449bcdl26571eb80aa6030c@mail.gmail.com>
	<alpine.LRH.2.00.0904290825150.30188@reclus.nhh.no>
Message-ID: <f58db2700904290911r7a5ffe4ct4ed83ff16b1fca2c@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090429/3a956bff/attachment.pl>

From alinashe at gmail.com  Wed Apr 29 18:22:23 2009
From: alinashe at gmail.com (Alina Sheyman)
Date: Wed, 29 Apr 2009 12:22:23 -0400
Subject: [R-sig-Geo] unique spatial polygons
In-Reply-To: <f58db2700904290911r7a5ffe4ct4ed83ff16b1fca2c@mail.gmail.com>
References: <f58db2700904281347q11449bcdl26571eb80aa6030c@mail.gmail.com>
	<alpine.LRH.2.00.0904290825150.30188@reclus.nhh.no>
	<f58db2700904290911r7a5ffe4ct4ed83ff16b1fca2c@mail.gmail.com>
Message-ID: <f58db2700904290922u6f824be9w669ec18568d5ccca@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090429/e36988ea/attachment.pl>

From Roger.Bivand at nhh.no  Wed Apr 29 19:32:56 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 29 Apr 2009 19:32:56 +0200 (CEST)
Subject: [R-sig-Geo] unique spatial polygons
In-Reply-To: <f58db2700904290911r7a5ffe4ct4ed83ff16b1fca2c@mail.gmail.com>
References: <f58db2700904281347q11449bcdl26571eb80aa6030c@mail.gmail.com>
	<alpine.LRH.2.00.0904290825150.30188@reclus.nhh.no>
	<f58db2700904290911r7a5ffe4ct4ed83ff16b1fca2c@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.0904291918400.30188@reclus.nhh.no>

On Wed, 29 Apr 2009, Alina Sheyman wrote:

> Using examples in Chapter 5, I am trying to get rid of non-unique polygons.

Actually, maybe my advice wasn't well-judged, unless you are happy to 
interpret code in a fairly naked setting, you may actually need the book 
text to see what is going on. The code treats a number of different 
issues, not all of which are necessarily relevant for your case.

> I'm working with a Massachusetts shapefile by zips. The file consists the
> following fields
> ZCTA  NAME LSAD   LSAD_TRANS
>
> I've done the following  to get rid of duplicate records
>
>> zipmaps1_df <- as(zipmaps1, "data.frame")[!duplicated(zipmaps1$LSAT_TRANS)]
# not LSAD_TRANS?
>> row.names(zipmaps1_df) <- zipmaps1_df$LSAD_TRANS
>> zipmaps1a <- SpatialPolygonsDataFrame(zipmaps1, zipmaps1_df) ,
>

I guess that you need all of the features (geometries) in zipmaps1, but 
that some zipcodes have several features. Don't discard geometries 
unless you know that that is what you really want to do. Even if they are 
not contiguous, use:

zipmaps1u <- unionSpatialPolygons(as(zipmaps1, "SpatialPolygons"),
   as.character(zipmaps1$LSAD_TRANS))

to group all of the features belonging to each value of LSAD_TRANS as 
Polygon objects in unique Polygons objects (with multiple features).

The output (re. your next mail) is a SpatialPolygons object. How you then 
aggregate the data.frame part of the input object is up to you. The ID 
values of the Polygons objects in zipmaps1u will be the unique values of 
LSAD_TRANS. Unless you need to work with attribute data, you could stay 
just with SpatialPolygons objects until you are through.

> but get the following error message
> Error in SpatialPolygonsDataFrame(zipmaps1, zipmaps1_df) :
>  row.names of data and Polygons IDs do not match
>
>
> How do I find out what field R is treating as Polygon ID, so that I can set
> my row.names to that?

If you need it later on, you could look at spChFIDs as I suggested before.

Hope this helps,

Roger

>
>
> On Wed, Apr 29, 2009 at 2:42 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> On Tue, 28 Apr 2009, Alina Sheyman wrote:
>>
>>  I'm trying to combine two shapefiles using
>>> zipmaps5 <- spRbind(zipmaps1,zipmaps2)
>>>
>>> and getting the following error message
>>> Error in spRbind(as(obj, "SpatialPolygons"), as(x, "SpatialPolygons")) :
>>>  non-unique polygon IDs
>>>
>>> Does anyone know how I can get rid of duplicate polygons in a shapefile?
>>>
>>
>> This isn't the problem. The real problem is that zipmaps1 and zipmaps2 have
>> non-unique polygon IDs, so that it isn't obvious to the function what you
>> want to do. By default:
>>
>> sapply(slot(zipmaps1, "polygons"), slot, "ID")
>>
>> is set to the FID of the shapefile in readOGR() and equivalently in
>> readShapeSpatial() in maptools. These typically run 0:(n-1). For two
>> objects, they obviously overlap. Please use spChFIDs() methods in maptools
>> to assign IDs that are unique for the output object; in the worst case:
>>
>> zipmaps1 <- spChFIDs(zipmaps1, paste("map1", sapply(slot(zipmaps1,
>>  "polygons"), slot, "ID"), sep="_"))
>>
>> and a different "map*" string for zipmaps2 will work, but a unique,
>> meaningful ID is best.
>>
>> This is covered in detail in the code examples for Chapter 5 in our book,
>> and on the help page for ?"spChFIDs-methods".
>>
>> Hope this helps,
>>
>> Roger
>>
>>
>>> thank you!
>>>
>>>        [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>> --
>> Roger Bivand
>> Economic Geography Section, Department of Economics, Norwegian School of
>> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From loechl at ivt.baug.ethz.ch  Thu Apr 30 17:36:52 2009
From: loechl at ivt.baug.ethz.ch (Loechl  Michael)
Date: Thu, 30 Apr 2009 17:36:52 +0200
Subject: [R-sig-Geo] How to access p-values of lagsarlm coefficients?
Message-ID: <F96649F3FF2EAE4DB48E36714AFE881C055DD38E@EX5.d.ethz.ch>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20090430/7d0873a0/attachment.pl>

From yud at mail.montclair.edu  Thu Apr 30 18:01:15 2009
From: yud at mail.montclair.edu (Danlin Yu)
Date: Thu, 30 Apr 2009 12:01:15 -0400
Subject: [R-sig-Geo] How to access p-values of lagsarlm coefficients?
In-Reply-To: <F96649F3FF2EAE4DB48E36714AFE881C055DD38E@EX5.d.ethz.ch>
References: <F96649F3FF2EAE4DB48E36714AFE881C055DD38E@EX5.d.ethz.ch>
Message-ID: <49F9CB4B.8040100@mail.montclair.edu>

Michael:

For the SARLM objects (be it lag or error), the p-values are replaced by 
the calculated z-values, and significance tests follow similar ways as 
in using the p-values.

Hope this helps.

Cheers,
Danlin

Loechl Michael ??:
> Dear list,
>
>  
>
> is there a way to access the p-values of the coefficients in a
> sarlm-object?
>
>  
>
> Any hint is appreciated.
>
>  
>
> Best regards,
>
> Michael
>
>  
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   

-- 
___________________________________________
Danlin Yu, Ph.D.
Assistant Professor of GIS and Urban Geography
Department of Earth & Environmental Studies
Montclair State University
Montclair, NJ, 07043
Tel: 973-655-4313
Fax: 973-655-4072
email: yud at mail.montclair.edu
webpage: csam.montclair.edu/~yu


From Roger.Bivand at nhh.no  Thu Apr 30 18:33:15 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 30 Apr 2009 18:33:15 +0200 (CEST)
Subject: [R-sig-Geo] How to access p-values of lagsarlm coefficients?
In-Reply-To: <49F9CB4B.8040100@mail.montclair.edu>
References: <F96649F3FF2EAE4DB48E36714AFE881C055DD38E@EX5.d.ethz.ch>
	<49F9CB4B.8040100@mail.montclair.edu>
Message-ID: <alpine.LRH.2.00.0904301822580.3563@reclus.nhh.no>

On Thu, 30 Apr 2009, Danlin Yu wrote:

> Michael:
>
> For the SARLM objects (be it lag or error), the p-values are replaced by the 
> calculated z-values, and significance tests follow similar ways as in using 
> the p-values.
>
> Hope this helps.
>
> Cheers,
> Danlin
>
> Loechl Michael ??:
>> Dear list,
>>
>> 
>> is there a way to access the p-values of the coefficients in a
>> sarlm-object?
>>

Try:

library(spdep)
data(oldcol)
COL.lag.eig <- lagsarlm(CRIME ~ INC + HOVAL, data=COL.OLD,
   nb2listw(COL.nb, style="W"))
summary(COL.lag.eig)$Coef
summary(COL.lag.eig)$Coef[,4]

that is, get them from the object returned by summary() of the sarlm 
object for the regression coefficients. For rho, you have the LR test 
anyway, at:

c(summary(COL.lag.eig)$LR1$p.value)

(inside c() to drop unneeded attributes), and if method="eigen", you also 
have the p.value of the Wald statistic, which is the same as the 
asymptotic test on rho, even though computed differently:

c(summary(COL.lag.eig)$Wald1$p.value)

Does that give you what you need?

Roger

>> 
>> Any hint is appreciated.
>>
>> 
>> Best regards,
>> 
>> Michael
>>
>> 
>>
>> 	[[alternative HTML version deleted]]
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From nikko at hailmail.net  Thu Apr 30 22:28:41 2009
From: nikko at hailmail.net (Nicholas Lewin-Koh)
Date: Thu, 30 Apr 2009 13:28:41 -0700
Subject: [R-sig-Geo] Characterizing the position (central vs >
 peripheral) of a point in a point pattern
In-Reply-To: <mailman.17.1241085606.29262.r-sig-geo@stat.math.ethz.ch>
References: <mailman.17.1241085606.29262.r-sig-geo@stat.math.ethz.ch>
Message-ID: <1241123321.2950.1313167747@webmail.messagingengine.com>

Hi Alex
I think the following might be close to what you want;
1) calculate the convex hull of your point set
2) Calculate the centroid of the convex hull polygon
3) for each point:
   calculate the distance to the centroid (d_c)
   calculate the distance to the closest boundary (d_b)
4) interior = d_c < d_b

If this simple 50/50 rule is to simple, you could use convex hull
peeling
to determine the exterior points for some threshold, eg the outer 30% of
the data.

hope this helps
Nicholas
> ----------------------------------------------------------------------
> 
> Message: 1
> Date: Wed, 29 Apr 2009 12:12:42 +0200
> From: Alexandre VILLERS <alexandre.villers at cebc.cnrs.fr>
> Subject: [R-sig-Geo] Characterizing the position (central vs
> 	peripheral) of a point in a point pattern
> To: Aide R SIG GEO <r-sig-geo at stat.math.ethz.ch>
> Message-ID: <49F8281A.9020608 at cebc.cnrs.fr>
> Content-Type: text/plain; charset=ISO-8859-1; format=flowed
> 
> Good morning,
> 
> I would like to characterize the position of  a given nest in a 
> population of breeding birds. Does anyone know a statisitics (and 
> associated R package) that could objectively tell whether a nest has a 
> central or peripheral location ? It also needs to be density independent 
> (not affected by sample size)
> Hope this is a trivial question !
> 
> Thanks for your help.
> 
> Alex
> 
> -- 
> Alexandre Villers
> PhD Student
> Team "Biodiversity"
> Centre d'Etudes Biologiques de Chiz?-CNRS UPR1934
> 79360 Beauvoir sur Niort
> 
> Phone +33 (0)5 49 09 96 13
> Fax   +33 (0)5 49 09 65 26
> 
> 
> 
> 
> __________ Information from ESET Mail Security, version of virus
> signature database 4042 (20090429) __________
> 
> The message was checked by ESET Mail Security.
> http://www.eset.com
> 
>


