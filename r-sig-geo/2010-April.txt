From mark_connolly at acm.org  Thu Apr  1 14:25:56 2010
From: mark_connolly at acm.org (Mark Connolly)
Date: Thu, 01 Apr 2010 08:25:56 -0400
Subject: [R-sig-Geo] spatstat, maptools, sp, and as.ppp
Message-ID: <4BB490D4.4010401@acm.org>

I may be just dense, but maybe this will help someone else avoid some 
head-brick wall interactions.

If you just _know_ that yesterday you weren't getting "Error in 
as.ppp.default(varname) : Can't interpret X as a point pattern" when you 
were executing as.ppp on a SpatialPoints instance, then it may be that 
yesterday you were loading maptools and today you are not.


From hengl at spatial-analyst.net  Thu Apr  1 15:54:24 2010
From: hengl at spatial-analyst.net (Tomislav Hengl)
Date: Thu, 1 Apr 2010 15:54:24 +0200
Subject: [R-sig-Geo] Updated repository of worldmaps (300MB of data at 5km
	resolution)
Message-ID: <000601cad1a2$d789cd40$869d67c0$@net>


Dear R-sig-geo,

FYI: I have just updated the small repository of publicly available data sets of interest for global modeling/mapping that I have launched about a year ago. This now contains 62 layers at resolution of 0.05 arcdegrees and with a complete world coverage (it use to be 65S-65N only). The data is available for download at [http://spatial-analyst.net/worldmaps/]. Each layer comes with a raster description file *.rdc, which typically has the same name as the attached layer (description of the fields is available in the [http://spatial-analyst.net/worldmaps/README.txt]). The raster description file includes also a link to an R script that (should) show all processing steps from download to export of maps (I advise you to run the scripts step by step because the data sets are usually Huge). If you want to read more about what is all available on this repository (and outside), please read the complete article [http://spatial-analyst.net/wiki/index.php?title=Global_datasets]. You can also browse a gallery of worldmaps from here:

http://commons.wikimedia.org/wiki/Publicly_available_global_data_sets# 

Note that some maps have limited geographical coverage (e.g. PCEVI, GLC2000), which usually means that the data for polar regions is missing.

In about 2-3 weeks, I will tidy up the small errors and finalize the maps and metadata. If you think that I have maybe missed some important (publicly available) layers, please let me know. For example, I have tried to include also the map of airline flight paths from [http://commons.wikimedia.org/wiki/File:World_airline_routes.png], but could not determine coordinate system, lineage etc. I am sure that there is much more what is available (on and off the web), but I would at least try to be representative.

My next project will be to prepare the 1 km data (about 70% of maps listed are available also in this resolution) and put them into some database format such as WKT raster or rasdaman. This way anybody will be able to overlay point, line, polygon features and fetch only the results of queries from the server. But it looks as this will take more time than I have initially anticipated.


ARE THESE MAPS JUST COPIES?
Many of the layers listed (cca 20-30%) are simply resampled and reformatted maps that are already available from the original providers (e.g. pcclim, GLC2000, himpact etc.). The great majority of maps are basically original layers that you will not be able to find elsewhere. For example, PCEVI1 is the 1st Principal Component of the total time-series of monthly MODIS EVI bands (this image basically shows the average long-term 'biomass' in the world). If you wish to cite some of the maps I have prepared, then you should refer to the chapter #4 in my book [http://spatial-analyst.net/book/DataSources], otherwise I advise you to refer to the original data providers. 
Each *.rdc file contains information about the data source, including the link to where you can find the source data and peer-reviewed publication that describes the dataset.
Personally, I find it frustrating that there are several global mapping projects in the world that overlap (for example, there are at least four global land cover maps!). In some cases I solve the problem by simply taking the average (e.g. globedem is a an average between two maps), but the categorical maps cannot be average as easy. My second frustration are the license and copyright problems. Some data producers (usually the USA mapping agencies) have a very clear policy and even support copying and distribution of the maps they produce (provided that the source is acknowledged); others (e.g. himpacts) are not really clear. I am only interested in processing and organizing the publicly available data.


MEMORY LIMIT PROBLEMS
Going from 10 km to 5 km resolution brought me to many technical headaches. Just to download the input data takes about one week (the input data I used to generate the 62 layers, now of size 300MB, is about 500GB!). Each layer now has cca 26M pixels, which will obviously lead to many memory and computational limit problems. For example, I doubt it that you will be able to load these data into R on a standard PC (2-4GB RAM) or visualize the maps using spplot. I also tried to derive some DEM parameters such as SAGA TWI, height above channel channels etc, but the maps are simply too big (processing takes >24 hours), so it is very likely that you will also face memory limit and computational problems on your computers. PS: I used a Dell 2.8GHz with dual processor and 64Bit Window XP OS with 4GB of RAM to run processing, and this configuration was already on the edge.

I am really thankful to Frank Warmerdam and colleagues for providing excellent utilities [http://www.gdal.org/gdal_utilities.html] which I heavily used to prepare the maps. I actually did run a small comparison between the gdalwarp utility and Erdas Imagine and ArcGIS and discovered that gdal utilities are (1) faster and (2) more easy to script (+ you have a support for proj4 strings and largest family of GIS data formats). The second on my list was SAGA GIS, which can also crunch Huge data (up to 2GB) and has a large library of GIS operations. I highly recommend these two programs and would support further development very much. In some cases, I could not find any functionality for the analysis in gdal utilities and SAGA, so I used ILWIS GIS (e.g. to run principle component analysis and to extract density of lines and point features). Unfortunately linking of R and ILWIS is not as smooth, so I often finished running part of the analysis in ILWIS separately. This is just an important information for the people that will focus only on using the R scripts.

I am looking forward to your feedback and further comments. 

A copy of this mail in html format (you can insert comments below) is also available here:

http://spatial-analyst.net/book/updated_worldmaps 

yours,

T. Hengl
http://home.medewerker.uva.nl/t.hengl/


From stegen at email.unc.edu  Thu Apr  1 23:19:09 2010
From: stegen at email.unc.edu (James Stegen)
Date: Thu, 01 Apr 2010 17:19:09 -0400
Subject: [R-sig-Geo] read in a csv with readOGR
Message-ID: <4BB50DCD.4030408@email.unc.edu>

I am trying to read-in a .csv file that has two columns, one for 
longitude and one for latitude to then overlay on a raster map that I am 
reading in with readGDAL.
I read in the raster as:

test = readGDAL("tmean1.bil")

This seems to work fine.
I then try to read in the csv file as:

coord = readOGR("Lat_Long_105.csv",layer="Lat_Long_105")

, but I get this out

Error in ogrInfo(dsn = dsn, layer = layer, input_field_name_encoding = 
input_field_name_encoding) :
  Multiple # dimensions:

It's unclear to me if I am totally missing the boat when I try to read 
in the csv file. In particular, dsn is also the layer (i.e. there is 
only one file).
Do I need something else for the layer?

Thanks,
James

-- 
James C. Stegen
NSF Postdoctoral Fellow in Bioinformatics
University of North Carolina
Chapel Hill, NC
919-962-8795
stegen at email.unc.edu


From b.rowlingson at lancaster.ac.uk  Thu Apr  1 23:24:36 2010
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Thu, 1 Apr 2010 22:24:36 +0100
Subject: [R-sig-Geo] read in a csv with readOGR
In-Reply-To: <4BB50DCD.4030408@email.unc.edu>
References: <4BB50DCD.4030408@email.unc.edu>
Message-ID: <m2hd8ad40b51004011424jfaaa9384y5d75be46a96098e0@mail.gmail.com>

On Thu, Apr 1, 2010 at 10:19 PM, James Stegen <stegen at email.unc.edu> wrote:
> I am trying to read-in a .csv file that has two columns, one for longitude
> and one for latitude to then overlay on a raster map that I am reading in
> with readGDAL.
> I read in the raster as:
>
> test = readGDAL("tmean1.bil")
>
> This seems to work fine.
> I then try to read in the csv file as:
>
> coord = readOGR("Lat_Long_105.csv",layer="Lat_Long_105")
>
> , but I get this out
>
> Error in ogrInfo(dsn = dsn, layer = layer, input_field_name_encoding =
> input_field_name_encoding) :
> ?Multiple # dimensions:
>
> It's unclear to me if I am totally missing the boat when I try to read in
> the csv file. In particular, dsn is also the layer (i.e. there is only one
> file).
> Do I need something else for the layer?

 Read it into a non-spatial, ordinary, common-or-garden dataframe with
'read.csv'. Then give it coordinates, something like:

 thing = read.csv("thing.csv")
 coordinates(thing)=~long+lat

then by magic you'll have a spatial points data frame

that's assuming your column names in 'thing' are long and lat for X
and Y coords. You might also want to set a CRS too, so it knows what
coordinate system it is (probably WGS 84...)

Barry


From alonsarp at um.es  Fri Apr  2 11:22:12 2010
From: alonsarp at um.es (Francisco Alonso Sarria)
Date: Fri, 02 Apr 2010 11:22:12 +0200
Subject: [R-sig-Geo] saga grid_gridding problem
Message-ID: <20100402112212.11803xtq0xtjnfwk@webmail.atica.um.es>


Hi:

I'm begining to work with rsaga and saga compiled on ubuntu linux and  
I have  problems when I want to generate a grid from a point file (by  
the way is the example  of section 6.3.1 in Hengl's book "A practical  
guide to geoestatistical mapping")

I have a seg. fault when I try to take the grid properties from a sgrd  
file and if I try to define the grid in command line it doesn't work  
properly. In detail:


$ saga_cmd libgrid_gridding.so 0 -INPUT AS_ICP40 -GRID AS_ICP40_5  
-LINE_TYPE 0 -FIELD 0 -TARGET 1 -GRID_GRID geomap_sapa.sgrd

_____________________________________________
   #####   ##   #####    ##
  ###     ###  ##       ###
   ###   # ## ##  #### # ##
    ### ##### ##    # #####
##### #   ##  ##### #   ##

SAGA CMD 2.0.4
_____________________________________________
library path:	/usr/local/lib/saga/
library name:	libgrid_gridding.so
module name :	Shapes to Grid
author      :	O.Conrad (c) 2003
_____________________________________________
go...

Load shapes: AS_ICP40...
100%
ready

okay




Parameters




Grid: [not set]
Shapes: AS_ICP40
Attribute: AS_ICP40
Method for Lines: thin
Preferred Target Grid Type: Floating Point (4 byte)
Target Grid: grid

Fallo de segmentaci?n   (spanish for seg.fault ;-)

On the other hand:

$ saga_cmd libgrid_gridding.so 0 -INPUT AS_ICP40 -GRID AS_ICP40_5  
-LINE_TYPE 0 -FIELD 1 -TARGET 1 -USER_YMAX 3217500 -USER_YMIN 262500  
-USER_XMIN -2402500 -USER_XMAX 2292500 -USER_SIZE 5000

____________________________________________
   #####   ##   #####    ##
  ###     ###  ##       ###
   ###   # ## ##  #### # ##
    ### ##### ##    # #####
##### #   ##  ##### #   ##

SAGA CMD 2.0.4
_____________________________________________
library path:	/usr/local/lib/saga/
library name:	libgrid_gridding.so
module name :	Shapes to Grid
author      :	O.Conrad (c) 2003
_____________________________________________
go...

Load shapes: AS_ICP40...
100%
ready

okay




Parameters




Grid: [not set]
Shapes: AS_ICP40
Attribute: AS_ICP40
Method for Lines: thin
Preferred Target Grid Type: Floating Point (4 byte)
Target Grid: user defined

100%
Save grid: AS_ICP40_5...
100%
ready

okay


all ok but:

$ cat AS_ICP40_5.sgrd

NAME	= AS_ICP40 [AS_ICP40]
DESCRIPTION	=
UNIT	=
DATAFILE_OFFSET	= 0
DATAFORMAT	= FLOAT
BYTEORDER_BIG	= FALSE
POSITION_XMIN	= -2402500.0000000000
POSITION_YMIN	= 262500.0000000000
CELLCOUNT_X	= 203
CELLCOUNT_Y	= 101
CELLSIZE	= 5000.0000000000
Z_FACTOR	= 1.000000
NODATA_VALUE	= -99999.000000
TOPTOBOTTOM	= FALSE

As you can see CELLCOUNT_* don't fit with the USER_* parameters passed  
and the resulting map has no data because there are no points in that  
particular subgrid. If I change CELLSIZE to 50000 the CELLCOUNT_* are  
the same but now all the points are in the grid and I have a map.

Is it a bug in the linux version of SAGA?

Thanks in advance for any help

Paco

=========================
Francisco Alonso Sarr?a
Departamento de Geograf?a
Universidad de Murcia
=========================


From Roger.Bivand at nhh.no  Fri Apr  2 12:04:31 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 2 Apr 2010 12:04:31 +0200 (CEST)
Subject: [R-sig-Geo] read in a csv with readOGR
In-Reply-To: <m2hd8ad40b51004011424jfaaa9384y5d75be46a96098e0@mail.gmail.com>
References: <4BB50DCD.4030408@email.unc.edu>
	<m2hd8ad40b51004011424jfaaa9384y5d75be46a96098e0@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1004021159480.11562@reclus.nhh.no>

On Thu, 1 Apr 2010, Barry Rowlingson wrote:

> On Thu, Apr 1, 2010 at 10:19 PM, James Stegen <stegen at email.unc.edu> wrote:
>> I am trying to read-in a .csv file that has two columns, one for longitude
>> and one for latitude to then overlay on a raster map that I am reading in
>> with readGDAL.
>> I read in the raster as:
>>
>> test = readGDAL("tmean1.bil")
>>
>> This seems to work fine.
>> I then try to read in the csv file as:
>>
>> coord = readOGR("Lat_Long_105.csv",layer="Lat_Long_105")
>>
>> , but I get this out
>>
>> Error in ogrInfo(dsn = dsn, layer = layer, input_field_name_encoding =
>> input_field_name_encoding) :
>> ?Multiple # dimensions:
>>
>> It's unclear to me if I am totally missing the boat when I try to read in
>> the csv file. In particular, dsn is also the layer (i.e. there is only one
>> file).
>> Do I need something else for the layer?
>
> Read it into a non-spatial, ordinary, common-or-garden dataframe with
> 'read.csv'. Then give it coordinates, something like:

While this is the standard answer, you can also create a *.vrt file to 
accompany your csv file, as described in:

http://www.gdal.org/ogr/drv_csv.html

For larger projects, this means that the OGR driver will read the data 
successfully. With just the *.csv file, however, go though read.csv() or 
read.csv2(); in some cases in some locales, read.csv2() may be the only 
option, as explained on the CSV driver help page.

Roger

>
> thing = read.csv("thing.csv")
> coordinates(thing)=~long+lat
>
> then by magic you'll have a spatial points data frame
>
> that's assuming your column names in 'thing' are long and lat for X
> and Y coords. You might also want to set a CRS too, so it knows what
> coordinate system it is (probably WGS 84...)
>
> Barry
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From lukas.brodsky at gisat.cz  Fri Apr  2 19:16:27 2010
From: lukas.brodsky at gisat.cz (Lukas Brodsky)
Date: Fri, 02 Apr 2010 19:16:27 +0200
Subject: [R-sig-Geo] gstat/R indicator co-kriging
Message-ID: <4BB6266B.9020005@gisat.cz>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100402/84204484/attachment.pl>

From finleya at msu.edu  Fri Apr  2 19:26:24 2010
From: finleya at msu.edu (Andrew Finley)
Date: Fri, 02 Apr 2010 13:26:24 -0400
Subject: [R-sig-Geo] gstat/R indicator co-kriging
In-Reply-To: <4BB6266B.9020005@gisat.cz>
References: <4BB6266B.9020005@gisat.cz>
Message-ID: <4BB628C0.7030203@msu.edu>

Hi Lukas,
If you feel like being Bayesian, you might want to check out the spMvGLM 
function in spBayes. Please let me know if it works for you or if you 
have any questions.
Andy

Lukas Brodsky wrote:
> Hello,
> is there any example on indicator co-kriging in gstat/R?
> 
> Any suggestion for creating a map (e.g. indicator) of binary variable 
> for which I have co-variable that is co-located and is known at each 
> prediction location? The binary variable has also known property (in 
> sampled limited points) that is continuous but only in case of binary 
> variable = 1.
> 
> Thanks :-) Regards,
> Lukas
> 

-- 
Andrew Finley, PhD
Natural Resources Building
Michigan State University
East Lansing, MI 48824-1222
Phone: 517-432-7219
Fax: 517-432-1143
web: http://blue.for.msu.edu


From edzer.pebesma at uni-muenster.de  Fri Apr  2 22:02:26 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 02 Apr 2010 22:02:26 +0200
Subject: [R-sig-Geo] gstat/R indicator co-kriging
In-Reply-To: <4BB6266B.9020005@gisat.cz>
References: <4BB6266B.9020005@gisat.cz>
Message-ID: <4BB64D52.9040102@uni-muenster.de>

Lukas Brodsky wrote:

> Hello,
> is there any example on indicator co-kriging in gstat/R?

demo(cokriging)

> Any suggestion for creating a map (e.g. indicator) of binary variable 
> for which I have co-variable that is co-located and is known at each 
> prediction location? The binary variable has also known property (in 
> sampled limited points) that is continuous but only in case of binary 
> variable = 1.

>From the non-Bayesian geostatisical side, methods adopted here include
colocated cokriging; another option might be kriging with external
drift/universal kriging, although I'm not so sure how much sense this
makes for indicators.
-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From wouter at paramo.be  Sat Apr  3 16:51:47 2010
From: wouter at paramo.be (Wouter Buytaert)
Date: Sat, 3 Apr 2010 15:51:47 +0100 (BST)
Subject: [R-sig-Geo] class for georeferenced time series
Message-ID: <alpine.DEB.2.00.1004031536010.2412@cotopaxi>


Hi all,

this question is mainly aimed at the developers of sp, but any feedback is 
welcome.

We are designing some classes for hydrological modelling in R (the r-hydro 
package on R-Forge) and facing the decision of how to design a class for 
georeferenced time series (e.g., a precipitation or river flow series, 
the first referring to a point and the second to an area).

We're considering an xts time series with an sp object as attribute, but 
there may be other options (xts as data slot in an sp object for instance) 
that may be preferrable for reasons beyond my knowledge. Also, there may 
be similar efforts underway of which we have no knowledge.

cheers
wouter


From jgarcia at ija.csic.es  Sat Apr  3 22:21:46 2010
From: jgarcia at ija.csic.es (jgarcia at ija.csic.es)
Date: Sat, 3 Apr 2010 22:21:46 +0200 (CEST)
Subject: [R-sig-Geo] class for georeferenced time series
In-Reply-To: <alpine.DEB.2.00.1004031536010.2412@cotopaxi>
References: <alpine.DEB.2.00.1004031536010.2412@cotopaxi>
Message-ID: <57056.86.0.54.218.1270326106.squirrel@paleo.ija.csic.es>

Hi Wouter,
I'm not an sp developer. Anyway, I think you should take into account
memory issues for hydrological modelling. So, depending on the functions
you are preparing, to include all the attributes of sp classes in time
series (either spatially lumped or distributed) passed as arguments to the
underlying functions (I guess C code), may make your code slower (e.g., if
it is to conduct MC runs or optimizations). So, perhaps some functions
should be stripped of all attributes, mostly if spatial distributed models
are to be used. Of course this may not apply within a very few years.

Best wishes,
Javier
---
Javier Garc?a-Pintado
Euromediterranean Water Institut
75 Trotsworth Court
Christchurch Road
Virginia Water
GU25 4H
Surrey
United Kingdom

>
> Hi all,
>
> this question is mainly aimed at the developers of sp, but any feedback is
> welcome.
>
> We are designing some classes for hydrological modelling in R (the r-hydro
> package on R-Forge) and facing the decision of how to design a class for
> georeferenced time series (e.g., a precipitation or river flow series,
> the first referring to a point and the second to an area).
>
> We're considering an xts time series with an sp object as attribute, but
> there may be other options (xts as data slot in an sp object for instance)
> that may be preferrable for reasons beyond my knowledge. Also, there may
> be similar efforts underway of which we have no knowledge.
>
> cheers
> wouter
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From edzer.pebesma at uni-muenster.de  Sat Apr  3 22:30:08 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sat, 03 Apr 2010 22:30:08 +0200
Subject: [R-sig-Geo] class for georeferenced time series
In-Reply-To: <alpine.DEB.2.00.1004031536010.2412@cotopaxi>
References: <alpine.DEB.2.00.1004031536010.2412@cotopaxi>
Message-ID: <4BB7A550.90101@uni-muenster.de>

Dear Wouter,

as to your question on related work, Blair Christian has started two
threads on this list:

https://stat.ethz.ch/pipermail/r-sig-geo/2009-September/006435.html
https://stat.ethz.ch/pipermail/r-sig-geo/2009-September/006491.html

and the resulting work is now at r-forge, called spt, see
http://r-forge.r-project.org/projects/spt

it is a mix of classes and methods for spatio-temporal data and
functions that are needed for his particular research domain. It has a
vignette.

For the two suggestions you make I cannot say much; if you have running
prototypes I'd be happy to look at them.

Simply adding an sp object to a time series (as attribute) [or a set of
time stamps to an sp object] means that you'll sacrifice the
multi-atribute space for multiple spatial entities [time entities], so
your objects become univariable. That might only work as a short-term
solution; next time you'll want to work with water chemistry data.

Best regards,
--
Edzer

Wouter Buytaert wrote:
> 
> Hi all,
> 
> this question is mainly aimed at the developers of sp, but any feedback
> is welcome.
> 
> We are designing some classes for hydrological modelling in R (the
> r-hydro package on R-Forge) and facing the decision of how to design a
> class for georeferenced time series (e.g., a precipitation or river flow
> series, the first referring to a point and the second to an area).
> 
> We're considering an xts time series with an sp object as attribute, but
> there may be other options (xts as data slot in an sp object for
> instance) that may be preferrable for reasons beyond my knowledge. Also,
> there may be similar efforts underway of which we have no knowledge.
> 
> cheers
> wouter
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From blair.christian at gmail.com  Sun Apr  4 16:28:06 2010
From: blair.christian at gmail.com (Blair Christian)
Date: Sun, 4 Apr 2010 10:28:06 -0400
Subject: [R-sig-Geo] R-sig-Geo Digest, Vol 80, Issue 4
In-Reply-To: <mailman.7.1270375203.14388.r-sig-geo@stat.math.ethz.ch>
References: <mailman.7.1270375203.14388.r-sig-geo@stat.math.ethz.ch>
Message-ID: <k2v6c35a4fc1004040728la8e9dc39jb7ff9c1c242975f0@mail.gmail.com>

Hello Wouter et al,

I have plenty to say about all aspects of this.  Currently at SAMSI we
are discussing similar topics in a subgroup of a spatial stat comp
working group...
http://sisla06.samsi.info/spatial/comp/doku.php

My feature list for spt is growing exponentially lately for spt
related things.  I welcome any and all interested in working on such a
library.  I spent a large amount of time reading up on different
date/time libraries, their differences, their inheritances, etc.  I'm
happy for you to bounce any ideas off me about what your constraints
are (eg data structure sizes, data structure processing times,
vizualization needs, etc)

I have been out of the R realm lately, working more with
python+gis+statistical modeling code, as well as with building a
geocoded data collection sensor (arduino + gps + sensor(s) of choice +
sd card).  I'm trying to gather some microclimate data and fit some
models (just a personal side project, but has some useful
applications).

If you have some very specific needs, I may already have the
alpha/beta classes/methods working.  Please contact me offline (or via
the listserve) with any specific needs/questions/comments.  If you can
write up some clear use cases/methods/classes you want, I could
probably put them together within a week or two...  Just let me know.

Best,
Blair



In response to:

Dear Wouter,

as to your question on related work, Blair Christian has started two
threads on this list:

https://stat.ethz.ch/pipermail/r-sig-geo/2009-September/006435.html
https://stat.ethz.ch/pipermail/r-sig-geo/2009-September/006491.html

and the resulting work is now at r-forge, called spt, see
http://r-forge.r-project.org/projects/spt

it is a mix of classes and methods for spatio-temporal data and
functions that are needed for his particular research domain. It has a
vignette.

For the two suggestions you make I cannot say much; if you have running
prototypes I'd be happy to look at them.

Simply adding an sp object to a time series (as attribute) [or a set of
time stamps to an sp object] means that you'll sacrifice the
multi-atribute space for multiple spatial entities [time entities], so
your objects become univariable. That might only work as a short-term
solution; next time you'll want to work with water chemistry data.

Best regards,
--
Edzer

Wouter Buytaert wrote:
>
> Hi all,
>
> this question is mainly aimed at the developers of sp, but any feedback
> is welcome.
>
> We are designing some classes for hydrological modelling in R (the
> r-hydro package on R-Forge) and facing the decision of how to design a
> class for georeferenced time series (e.g., a precipitation or river flow
> series, the first referring to a point and the second to an area).
>
> We're considering an xts time series with an sp object as attribute, but
> there may be other options (xts as data slot in an sp object for
> instance) that may be preferrable for reasons beyond my knowledge. Also,
> there may be similar efforts underway of which we have no knowledge.
>
> cheers
> wouter


From euan.reavie at gmail.com  Mon Apr  5 01:27:48 2010
From: euan.reavie at gmail.com (Euan Reavie)
Date: Sun, 4 Apr 2010 18:27:48 -0500
Subject: [R-sig-Geo] Adding miniature plots at specific locations on a map
Message-ID: <u2xc35612a61004041627se4e01395gc2cc1ccae42bd521@mail.gmail.com>

Hello all. I have plotted a map of the Great Lakes using maptools:
> lakes <- readShapePoly('C:/grtlakes/',proj4string=CRS("+proj=longlat"))
> plot(lakes, xlim=c(-93.5,-74.5),ylim=c(41,49.5),lwd=3,new=TRUE)

Now I want to plot small scatterplots relative to several sample
locations on the map. After an afternoon of trying I have not been
able to find a way to do this using a matrix of lat/long data (sample
locations). I was hoping I could implement something similar to the
"floating.pie" command in the plotrix package, except for scatter
plots. For an example of what I'm trying to do (using line plots) see
Fig. 1 in:
http://epa.gov/glnpo/monitoring/publications/articles/laurentian_II.pdf

At this point I'm not concerned about crowding. If I can simply place
the small plots on a map I can figure out crowding issues later. Is
there a package that can do this, or can I work with the base package?
At this point, if i could figure out a way to assign lat/long
coordinates to a simple plot like:
> plot(sample(10,10,10))
...I would be happy. Any recommendations for packages, etc. would be welcome.

-Euan
University of Minnesota Duluth.


From Virgilio.Gomez at uclm.es  Mon Apr  5 10:37:51 2010
From: Virgilio.Gomez at uclm.es (Virgilio =?ISO-8859-1?Q?G=F3mez-Rubio?=)
Date: Mon, 05 Apr 2010 10:37:51 +0200
Subject: [R-sig-Geo] Adding miniature plots at specific locations on a
 map
In-Reply-To: <u2xc35612a61004041627se4e01395gc2cc1ccae42bd521@mail.gmail.com>
References: <u2xc35612a61004041627se4e01395gc2cc1ccae42bd521@mail.gmail.com>
Message-ID: <1270456671.2996.3.camel@Virgilio-Gomez>

Hi,

You could also check the book "R Graphics" by Paul Murrell. You can see
an example of a map (of Australia) with some other graphs on it here:

http://www.stat.auckland.ac.nz/~paul/RGraphics/chapter7.html

He also provides the source code.

Hope this helps,

Virgilio

El dom, 04-04-2010 a las 18:27 -0500, Euan Reavie escribi?: 
> Hello all. I have plotted a map of the Great Lakes using maptools:
> > lakes <- readShapePoly('C:/grtlakes/',proj4string=CRS("+proj=longlat"))
> > plot(lakes, xlim=c(-93.5,-74.5),ylim=c(41,49.5),lwd=3,new=TRUE)
> 
> Now I want to plot small scatterplots relative to several sample
> locations on the map. After an afternoon of trying I have not been
> able to find a way to do this using a matrix of lat/long data (sample
> locations). I was hoping I could implement something similar to the
> "floating.pie" command in the plotrix package, except for scatter
> plots. For an example of what I'm trying to do (using line plots) see
> Fig. 1 in:
> http://epa.gov/glnpo/monitoring/publications/articles/laurentian_II.pdf
> 
> At this point I'm not concerned about crowding. If I can simply place
> the small plots on a map I can figure out crowding issues later. Is
> there a package that can do this, or can I work with the base package?
> At this point, if i could figure out a way to assign lat/long
> coordinates to a simple plot like:
> > plot(sample(10,10,10))
> ...I would be happy. Any recommendations for packages, etc. would be welcome.
> 
> -Euan
> University of Minnesota Duluth.
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From jim at bitwrit.com.au  Mon Apr  5 10:54:58 2010
From: jim at bitwrit.com.au (Jim Lemon)
Date: Mon, 05 Apr 2010 18:54:58 +1000
Subject: [R-sig-Geo] Adding miniature plots at specific locations on a
 map
In-Reply-To: <u2xc35612a61004041627se4e01395gc2cc1ccae42bd521@mail.gmail.com>
References: <u2xc35612a61004041627se4e01395gc2cc1ccae42bd521@mail.gmail.com>
Message-ID: <4BB9A562.10504@bitwrit.com.au>

On 04/05/2010 09:27 AM, Euan Reavie wrote:
> Hello all. I have plotted a map of the Great Lakes using maptools:
>> lakes<- readShapePoly('C:/grtlakes/',proj4string=CRS("+proj=longlat"))
>> plot(lakes, xlim=c(-93.5,-74.5),ylim=c(41,49.5),lwd=3,new=TRUE)
>
> Now I want to plot small scatterplots relative to several sample
> locations on the map. After an afternoon of trying I have not been
> able to find a way to do this using a matrix of lat/long data (sample
> locations). I was hoping I could implement something similar to the
> "floating.pie" command in the plotrix package, except for scatter
> plots. For an example of what I'm trying to do (using line plots) see
> Fig. 1 in:
> http://epa.gov/glnpo/monitoring/publications/articles/laurentian_II.pdf
>
> At this point I'm not concerned about crowding. If I can simply place
> the small plots on a map I can figure out crowding issues later. Is
> there a package that can do this, or can I work with the base package?
> At this point, if i could figure out a way to assign lat/long
> coordinates to a simple plot like:
>> plot(sample(10,10,10))
> ...I would be happy. Any recommendations for packages, etc. would be welcome.
>
Hi Euan,
I think the subplot function in the TeachingDemos package might do what 
you want.

Jim


From hengl at spatial-analyst.net  Mon Apr  5 15:04:56 2010
From: hengl at spatial-analyst.net (Tomislav Hengl)
Date: Mon, 05 Apr 2010 15:04:56 +0200
Subject: [R-sig-Geo] saga grid_gridding problem
In-Reply-To: <20100402112212.11803xtq0xtjnfwk@webmail.atica.um.es>
References: <20100402112212.11803xtq0xtjnfwk@webmail.atica.um.es>
Message-ID: <20100405150456.b5noq8b1wco4ow84@spatial-analyst.net>

Quoting Francisco Alonso Sarria <alonsarp at um.es>:

>
> Hi:
>
> I'm begining to work with rsaga and saga compiled on ubuntu linux and I
> have  problems when I want to generate a grid from a point file (by the
> way is the example  of section 6.3.1 in Hengl's book "A practical guide
> to geoestatistical mapping")
>
> I have a seg. fault when I try to take the grid properties from a sgrd
> file and if I try to define the grid in command line it doesn't work
> properly. In detail:
>
>
> $ saga_cmd libgrid_gridding.so 0 -INPUT AS_ICP40 -GRID AS_ICP40_5
> -LINE_TYPE 0 -FIELD 0 -TARGET 1 -GRID_GRID geomap_sapa.sgrd
>
> _____________________________________________
>   #####   ##   #####    ##
>  ###     ###  ##       ###
>   ###   # ## ##  #### # ##
>    ### ##### ##    # #####
> ##### #   ##  ##### #   ##
>
> SAGA CMD 2.0.4
> _____________________________________________
> library path:	/usr/local/lib/saga/
> library name:	libgrid_gridding.so
> module name :	Shapes to Grid
> author      :	O.Conrad (c) 2003
> _____________________________________________
> go...
>
> Load shapes: AS_ICP40...
> 100%
> ready
>
> okay
>
>
>
>
> Parameters
>
>
>
>
> Grid: [not set]
> Shapes: AS_ICP40
> Attribute: AS_ICP40
> Method for Lines: thin
> Preferred Target Grid Type: Floating Point (4 byte)
> Target Grid: grid
>
> Fallo de segmentaci?n   (spanish for seg.fault ;-)
>
> On the other hand:
>
> $ saga_cmd libgrid_gridding.so 0 -INPUT AS_ICP40 -GRID AS_ICP40_5
> -LINE_TYPE 0 -FIELD 1 -TARGET 1 -USER_YMAX 3217500 -USER_YMIN 262500
> -USER_XMIN -2402500 -USER_XMAX 2292500 -USER_SIZE 5000
>
> ____________________________________________
>   #####   ##   #####    ##
>  ###     ###  ##       ###
>   ###   # ## ##  #### # ##
>    ### ##### ##    # #####
> ##### #   ##  ##### #   ##
>
> SAGA CMD 2.0.4
> _____________________________________________
> library path:	/usr/local/lib/saga/
> library name:	libgrid_gridding.so
> module name :	Shapes to Grid
> author      :	O.Conrad (c) 2003
> _____________________________________________
> go...
>
> Load shapes: AS_ICP40...
> 100%
> ready
>
> okay
>
>
>
>
> Parameters
>
>
>
>
> Grid: [not set]
> Shapes: AS_ICP40
> Attribute: AS_ICP40
> Method for Lines: thin
> Preferred Target Grid Type: Floating Point (4 byte)
> Target Grid: user defined
>
> 100%
> Save grid: AS_ICP40_5...
> 100%
> ready
>
> okay
>
>
> all ok but:
>
> $ cat AS_ICP40_5.sgrd
>
> NAME	= AS_ICP40 [AS_ICP40]
> DESCRIPTION	=
> UNIT	=
> DATAFILE_OFFSET	= 0
> DATAFORMAT	= FLOAT
> BYTEORDER_BIG	= FALSE
> POSITION_XMIN	= -2402500.0000000000
> POSITION_YMIN	= 262500.0000000000
> CELLCOUNT_X	= 203
> CELLCOUNT_Y	= 101
> CELLSIZE	= 5000.0000000000
> Z_FACTOR	= 1.000000
> NODATA_VALUE	= -99999.000000
> TOPTOBOTTOM	= FALSE
>
> As you can see CELLCOUNT_* don't fit with the USER_* parameters passed
> and the resulting map has no data because there are no points in that
> particular subgrid. If I change CELLSIZE to 50000 the CELLCOUNT_* are
> the same but now all the points are in the grid and I have a map.
>
> Is it a bug in the linux version of SAGA?

First of all, I do not send operations to SAGA command line directly,  
but use the RSAGA package instead (it is then easier to combine R  
objects and SAGA operations). As far as I know, RSAGA should work on  
Linux machines also  
[https://stat.ethz.ch/pipermail/r-sig-geo/2009-July/006075.html]. So  
the point to raster operation you mention would look like this:

----------------------------------
> rsaga.geoprocessor(lib="grid_gridding", module=0,  
> param=list(GRID="PB_ICP40.sgrd", INPUT="PB_ICP40.shp", FIELD=0, 
> LINE_TYPE=0, USER_CELL_SIZE=5000, USER_X_EXTENT_MIN=-2402500,  
> USER_X_EXTENT_MAX=2292500, USER_Y_EXTENT_MIN=262500,  
> USER_Y_EXTENT_MAX=3217500))

SAGA CMD 2.0.4

Load table: D:\BOOK\NGS\saga.srs...

failed
library path:   C:/Progra~1/saga_vc/modules
library name:   grid_gridding
module name :   Shapes to Grid
author      :   (c) 2003 by O.Conrad

Load shapes: PB_ICP40.shp...
ready

ready

Parameters

Grid: [not set]
Shapes: PB_ICP40
Attribute: PB_ICP40
Target Dimensions: User defined
Method for Lines: thin

Save grid: PB_ICP40.sgrd...
ready

> GDALinfo("PB_ICP40.sdat")
rows        592
columns     940
bands       1
origin.x        -2405000
origin.y        260000
res.x       5000
res.y       5000
oblique.x   0
oblique.y   0
driver      SAGA
projection  NA
file        PB_ICP40.sdat
apparent band summary:
    GDType        Bmin       Bmax
1 Float32 -4294967295 4294967295
--------------------------------------------------------------------

which means that the operation was successful. Note that I point to  
field "0", i.e. first field in the table and not field "1" as in you  
example. Of course, the point data needs to be in the same coordinate  
system, otherwise the resulting map will be empty.

I doubt it that there is a bug in the SAGA operation. SAGA for Linux  
is just compiled in a different way, but the code (C++) is the same.  
Please try to closely follow the R script  
(http://spatial-analyst.net/book/NGS.R) and then let me know if you  
still experience problems. Otherwise, you should report the problem to  
the SAGA GIS user's forum  
[http://sourceforge.net/projects/saga-gis/forums/forum/790705].


T. Hengl
http://home.medewerker.uva.nl/t.hengl/



>
> Thanks in advance for any help
>
> Paco
>
> =========================
> Francisco Alonso Sarr?a
> Departamento de Geograf?a
> Universidad de Murcia
> =========================
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From ilona.naujo.lewis at gmail.com  Mon Apr  5 16:56:48 2010
From: ilona.naujo.lewis at gmail.com (Ilona Naujokaitis-Lewis)
Date: Mon, 5 Apr 2010 10:56:48 -0400
Subject: [R-sig-Geo] grabriel graphs weighted by alternative distance measure
Message-ID: <o2ve756ab631004050756tfd83b5ct42a68f920c614845@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100405/7d6f748b/attachment.pl>

From nikko at hailmail.net  Mon Apr  5 19:46:21 2010
From: nikko at hailmail.net (Nicholas Lewin-Koh)
Date: Mon, 05 Apr 2010 10:46:21 -0700
Subject: [R-sig-Geo] Adding miniature plots at specific locations on a map
In-Reply-To: <mailman.7.1270461603.16157.r-sig-geo@stat.math.ethz.ch>
References: <mailman.7.1270461603.16157.r-sig-geo@stat.math.ethz.ch>
Message-ID: <1270489581.32010.1368370741@webmail.messagingengine.com>

Hi Euan,
Another approach that I personally think is much cleaner is to use
linked micromaps, ala Dan Carr. 
I have been able to do them using latticeExtra using the c() function
and you could probably do them in ggplot
using viewports. Here is a sample using laticeExtra.  
http://junkcharts.typepad.com/junk_charts/2010/02/convention-and-function-2.html
And here are some better examples 
http://gis.cancer.gov/images/tools/lm/lm2.png
Dan has code to do this on his class website, but it is structured in
such a way that you have to fix
the page size, so is not very flexible.

Hope this helps

Nicholas

> ------------------------------
> 
> Message: 2
> Date: Sun, 4 Apr 2010 18:27:48 -0500
> From: Euan Reavie <euan.reavie at gmail.com>
> To: r-sig-geo at stat.math.ethz.ch
> Subject: [R-sig-Geo] Adding miniature plots at specific locations on a
> 	map
> Message-ID:
> 	<u2xc35612a61004041627se4e01395gc2cc1ccae42bd521 at mail.gmail.com>
> Content-Type: text/plain; charset=ISO-8859-1
> 
> Hello all. I have plotted a map of the Great Lakes using maptools:
> > lakes <- readShapePoly('C:/grtlakes/',proj4string=CRS("+proj=longlat"))
> > plot(lakes, xlim=c(-93.5,-74.5),ylim=c(41,49.5),lwd=3,new=TRUE)
> 
> Now I want to plot small scatterplots relative to several sample
> locations on the map. After an afternoon of trying I have not been
> able to find a way to do this using a matrix of lat/long data (sample
> locations). I was hoping I could implement something similar to the
> "floating.pie" command in the plotrix package, except for scatter
> plots. For an example of what I'm trying to do (using line plots) see
> Fig. 1 in:
> http://epa.gov/glnpo/monitoring/publications/articles/laurentian_II.pdf
> 
> At this point I'm not concerned about crowding. If I can simply place
> the small plots on a map I can figure out crowding issues later. Is
> there a package that can do this, or can I work with the base package?
> At this point, if i could figure out a way to assign lat/long
> coordinates to a simple plot like:
> > plot(sample(10,10,10))
> ...I would be happy. Any recommendations for packages, etc. would be
> welcome.
> 
> -Euan
> University of Minnesota Duluth.
> 
> 
> 
> ------------------------------


From euan.reavie at gmail.com  Mon Apr  5 21:21:38 2010
From: euan.reavie at gmail.com (Euan Reavie)
Date: Mon, 5 Apr 2010 14:21:38 -0500
Subject: [R-sig-Geo] Adding miniature plots at specific locations on a
	map
In-Reply-To: <4BB9A562.10504@bitwrit.com.au>
References: <u2xc35612a61004041627se4e01395gc2cc1ccae42bd521@mail.gmail.com>
	<4BB9A562.10504@bitwrit.com.au>
Message-ID: <4bba3846.5744f10a.2de1.ffffe5e2@mx.google.com>

Thank you Jim and others. The subplot function does exactly what I need. For
example, the following places a small plot in the middle of Lake Superior:

> subplot(plot(sample(10,10,10)),-88,48,size=c(.3,.3))

I am also exploring some of the latticeExtra functions.

Best - Euan.

> -----Original Message-----
> From: Jim Lemon [mailto:jim at bitwrit.com.au]
> Sent: Monday, April 05, 2010 3:55 AM
> To: Euan Reavie
> Cc: r-sig-geo at stat.math.ethz.ch
> Subject: Re: [R-sig-Geo] Adding miniature plots at specific locations on a
> map
> 
> On 04/05/2010 09:27 AM, Euan Reavie wrote:
> > Hello all. I have plotted a map of the Great Lakes using maptools:
> >> lakes<- readShapePoly('C:/grtlakes/',proj4string=CRS("+proj=longlat"))
> >> plot(lakes, xlim=c(-93.5,-74.5),ylim=c(41,49.5),lwd=3,new=TRUE)
> >
> > Now I want to plot small scatterplots relative to several sample
> > locations on the map. After an afternoon of trying I have not been
> > able to find a way to do this using a matrix of lat/long data (sample
> > locations). I was hoping I could implement something similar to the
> > "floating.pie" command in the plotrix package, except for scatter
> > plots. For an example of what I'm trying to do (using line plots) see
> > Fig. 1 in:
> > http://epa.gov/glnpo/monitoring/publications/articles/laurentian_II.pdf
> >
> > At this point I'm not concerned about crowding. If I can simply place
> > the small plots on a map I can figure out crowding issues later. Is
> > there a package that can do this, or can I work with the base package?
> > At this point, if i could figure out a way to assign lat/long
> > coordinates to a simple plot like:
> >> plot(sample(10,10,10))
> > ...I would be happy. Any recommendations for packages, etc. would be
> welcome.
> >
> Hi Euan,
> I think the subplot function in the TeachingDemos package might do what
> you want.
> 
> Jim


From brianadr at optusnet.com.au  Tue Apr  6 11:05:18 2010
From: brianadr at optusnet.com.au (brian cooper)
Date: Tue, 6 Apr 2010 19:05:18 +1000
Subject: [R-sig-Geo] PCA (Factor Analysis) with R spatial
In-Reply-To: <000601cad1a2$d789cd40$869d67c0$@net>
References: <000601cad1a2$d789cd40$869d67c0$@net>
Message-ID: <007001cad568$481e49a0$d85adce0$@com.au>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100406/9d43306f/attachment.pl>

From Roger.Bivand at nhh.no  Tue Apr  6 12:09:41 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 6 Apr 2010 12:09:41 +0200 (CEST)
Subject: [R-sig-Geo] grabriel graphs weighted by alternative distance
 measure
In-Reply-To: <o2ve756ab631004050756tfd83b5ct42a68f920c614845@mail.gmail.com>
References: <o2ve756ab631004050756tfd83b5ct42a68f920c614845@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1004061205240.2194@reclus.nhh.no>

On Mon, 5 Apr 2010, Ilona Naujokaitis-Lewis wrote:

> Hello everyone,
>
> I am working on the problem of creating alternative types of graphs (i.e.
> networks) based on alternative distance measures and then comparing
> topological differences between them.  Specifically I am constructing graphs
> created using euclidean distances versus genetic distances. These different
> distance measures are used to create alternative graphs as they represent
> the links (or edges) between the nodes (vertices).
> I would like to compare 3 types of graphs:
> 1. Complete (saturated graphs where all nodes are connected to one another)
> 2. Gabriel graphs,
> 3. minimum spanning trees
>
> I can build complete and minimum spanning trees using both distance types as
> weights for the links. For the minimum spanning tree situation, this creates
> 2 very different looking graphs. I am currently not able to create Gabriel
> graphs using an alternative to Euclidean distance as links between nodes.
> Although, gabriel graphs are a type of planar graph, it is my understanding
> that one should be able to construct Gabriel graphs based on alternative
> distance measures. In the population genetics software it is possible to do
> this. The result is generally 2 Gabriel graphs where the links between nodes
> are in different locations (i.e. the graphs should not look identical). I
> would like to do this in R but am running into trouble as the Garbriel
> functions seem to only use coordinates as inputs. I have looked into the
> following packages: spdep (spatial neighbour applications), igraph,
> spatgraphs, ade4.
>
> The data I have are:
> 1. coordinates of nodes (vertices)
> 2. pairwise distance matrix of genetic and euclidean distance between nodes
>
> Here is a small bit of code using some simulated data.
>
> # Create coordinate data
> x <- round(runif(20,1,10),1)
> y <- round(runif(20,5,10),1)
> xy <- cbind(x,y)
> # Create gabriel graph based on Euclidean distance
> col.gab <- graph2nb(gabrielneigh(xy))
> plot(col.gab,xy)
>
>
> # create a matrix of weights: in my case this represents measures of genetic
> distance between each pair of nodes
> # diagonal = 0
> # lower and upper matrix parts have identical values
> genetic <- matrix(0,nrow=20,ncol=20)
> genetic <- matrix(rnorm(500, 0.5, 0.25),nrow=20,ncol=20)
> genetic[lower.tri(genetic)] <- genetic[upper.tri(genetic)]
> diag(genetic)<-c(rep(0,length(genetic[1,])))
>
>
> Weighting the links after the Gabriel graph is created based on Euclidean
> distance does not make sense for me.
> If anyone has an idea of how I might try and create Gabriel graphs based on
> a distance measure that is not Euclidean, I would love to hear it.
>
> Thanks in advance for everyone's help.

In an earlier thread relevant to this topic, it was suggested that 
syntheic coordinates could be extracted from multidimensional scaling of 
the non-Euclidean distance matrix. You could try this, and judge how far 
from what you need you land by doing complete and MST on the synthetic 
coordinates for comparison. If this shows that the synthetic coordinates 
are no use, you'll be obliged to program your own Gabriel function for 
user-supplied distances. If you'd like to contribute such a function back, 
I think others would be grateful.

Hope this helps,

Roger

>
> I am currently using R (v.2.10.1) on Windows XP.
>
> Ilona Naujokaitis-Lewis, PhD student
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From saldanha.plangeo at gmail.com  Tue Apr  6 19:54:30 2010
From: saldanha.plangeo at gmail.com (Raphael Saldanha)
Date: Tue, 6 Apr 2010 14:54:30 -0300
Subject: [R-sig-Geo] PCA (Factor Analysis) with R spatial
In-Reply-To: <007001cad568$481e49a0$d85adce0$@com.au>
References: <000601cad1a2$d789cd40$869d67c0$@net>
	<007001cad568$481e49a0$d85adce0$@com.au>
Message-ID: <g2ic85849371004061054h46a3ee81l510be5cc21a60da@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100406/4c52cfca/attachment.pl>

From gianni.lavaredo at gmail.com  Tue Apr  6 23:59:34 2010
From: gianni.lavaredo at gmail.com (gianni lavaredo)
Date: Tue, 6 Apr 2010 23:59:34 +0200
Subject: [R-sig-Geo] problem to plot in 3D in raster library
Message-ID: <s2v518dff331004061459if3cfc4dtea68091deff870c6@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100406/2cc51ce5/attachment.pl>

From r.hijmans at gmail.com  Wed Apr  7 00:54:09 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 6 Apr 2010 15:54:09 -0700
Subject: [R-sig-Geo] problem to plot in 3D in raster library
In-Reply-To: <s2v518dff331004061459if3cfc4dtea68091deff870c6@mail.gmail.com>
References: <s2v518dff331004061459if3cfc4dtea68091deff870c6@mail.gmail.com>
Message-ID: <n2hdc22b2571004061554uf84d2333u397864785c3f222d@mail.gmail.com>

Gianni,
It is a bug, thanks for finding it. Fixed in version 1.0.0-8
(available at R-Forge in 24 hrs or so)
Robert


On Tue, Apr 6, 2010 at 2:59 PM, gianni lavaredo
<gianni.lavaredo at gmail.com> wrote:
> dear All,
>
> I have a problem to use polt3d in raster, and I don't understand where is
> the set-up problem
>
>> plot3D(IDW_DEM,maxpixels=100000,asRaster = TRUE)
>
> Errore in sampleRegular(x, n = maxpixels, asRaster = TRUE) :
> ?unused argument(s) (n = maxpixels)
>
> thanks
> Gianni
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From dray at biomserv.univ-lyon1.fr  Wed Apr  7 10:08:56 2010
From: dray at biomserv.univ-lyon1.fr (=?ISO-8859-1?Q?St=E9phane_Dray?=)
Date: Wed, 07 Apr 2010 10:08:56 +0200
Subject: [R-sig-Geo] PCA (Factor Analysis) with R spatial
In-Reply-To: <g2ic85849371004061054h46a3ee81l510be5cc21a60da@mail.gmail.com>
References: <000601cad1a2$d789cd40$869d67c0$@net>	<007001cad568$481e49a0$d85adce0$@com.au>
	<g2ic85849371004061054h46a3ee81l510be5cc21a60da@mail.gmail.com>
Message-ID: <4BBC3D98.5040102@biomserv.univ-lyon1.fr>

you can have a look to 
http://pbil.univ-lyon1.fr/members/dray/articles/SD807.php which presents 
a spatially-constrained version of multivariate analysis. It is 
implemented in the multispati function of the ade4 package.

Cheers.

Raphael Saldanha wrote:
> Hi Brian,
>
> A few time ago, I had recommended these references to a new "spatial" R
> user:
>
> You need first take a good look at the spdep package documentation
> (here <http://cran.r-project.org/web/packages/spdep/index.html>
> and here <http://cran.r-project.org/web/packages/spdep/spdep.pdf>),  and
> some good tutorials maded by the CISS <http://www.csiss.org/>, like
> this one<http://geodacenter.asu.edu/system/files/rex1.pdf>. Also,
> I recommed the Roger Bivand's book Applied Spatial
> Analysis<http://www.springer.com/public+health/epidemiology/book/978-0-387-78170-9>
> .
>
> A while ago, I had done some spatial analysis with PCA help. First, I had
> managed the spatial lag of the variables, and then, with detrended
> variables, started the PCA analysis. Please, let me known more about your
> research.
>
> 2010/4/6 brian cooper <brianadr at optusnet.com.au>
>
>   
>> Dear List,
>>
>>
>>
>> I am just learning R and associated spatial analysis.
>>
>>
>>
>> I am attempting to compare the impact of location has on a PCA. To do this
>> I
>> will be using the same data set to conduct a PCA using SPSS. Then using the
>> same data set attached to LAT/LONG coordinates (Polygon Centroid)   and
>> polygons, I will attempt to conduct a PCA using geo statistics.
>>
>>
>>
>> The question I am asking is there any difference between aspatial and
>> spatial analysis approaches on the same data. The particular approach is
>> factor analysis.
>>
>>
>>
>> The file I am using has approximately 640 cases and 23 variables one of
>> which is the geographical tag (in this case postcode), SPSS format. I have
>> a
>> polygon file for the postcodes, which is currently in MapInfo format.
>>
>>
>>
>> In my preliminary analysis, I established using vertical mapper (a MapInfo
>> add-on) there was a difference in results.
>>
>>
>>
>> Now in R spatial, I want to replicate the results. Is it possible to
>> include
>> the polygon as a variable in the calculation as opposed to the centroid of
>> the polygon?
>>
>> 1.  How does one store the results especially the factor scores associated
>> with each row as new columns.
>>
>> 2.  Is it better to have the variables attached to the polygon, or merge
>> files.
>>
>> 3.  Which is the most effective modules to use.
>>
>>
>>
>> Brian Cooper
>>
>>
>>        [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>     
>
>
>
>   

-- 
St?phane DRAY (dray at biomserv.univ-lyon1.fr )
Laboratoire BBE-CNRS-UMR-5558, Univ. C. Bernard - Lyon I
43, Bd du 11 Novembre 1918, 69622 Villeurbanne Cedex, France
Tel: 33 4 72 43 27 57       Fax: 33 4 72 43 13 88
http://pbil.univ-lyon1.fr/members/dray/


From jaime.garcia at uni-bonn.de  Wed Apr  7 10:55:32 2010
From: jaime.garcia at uni-bonn.de (Jaime R. Garcia Marquez)
Date: Wed, 07 Apr 2010 10:55:32 +0200
Subject: [R-sig-Geo] strip in spplot do not show
Message-ID: <web-4111528@be1.uni-bonn.de>

Dear list users,

Surely, a very simple question but I did not manage to 
solve it after a while trying.

I want to use spplot to plot one variable of a 
SpatialGridDataFrame BUT I want the normal lattice 'strip' 
to appear in the plot.

data(meuse.grid)
coordinates(meuse.grid) <- c("x","y")
gridded(meuse.grid) <- TRUE
fullgrid(meuse.grid) <- TRUE

if I plot two variables

spplot(meuse.grid, zcol=c(1,2))

then the strip of each panel appears with the name of the 
variable, in this case 'part.a' and 'part.b'.

But if I plot just one variable the strip does not appear.

spplot(meuse.grid, zcol=1)

Not even when I specify the 'strip' argument

spplot(meuse.grid, zcol=1, strip=TRUE, names.attr="please 
show up")

spplot(meuse.grid, zcol=1, strip= 
strip.custom(var.names="Please show up"))

What am I missing???

Any help or suggestion is appreciated.

Best,

Jaime R.


From manguefleur at yahoo.fr  Wed Apr  7 15:07:46 2010
From: manguefleur at yahoo.fr (Lho Lho)
Date: Wed, 7 Apr 2010 13:07:46 +0000 (GMT)
Subject: [R-sig-Geo] help: how to convert into geodata class with "borders"
	and "others"
Message-ID: <11529.48267.qm@web29203.mail.ird.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100407/bc3e7d17/attachment.pl>

From paulojus at c3sl.ufpr.br  Wed Apr  7 15:17:44 2010
From: paulojus at c3sl.ufpr.br (Paulo Justiniano Ribeiro Jr)
Date: Wed, 7 Apr 2010 10:17:44 -0300 (BRT)
Subject: [R-sig-Geo] help: how to convert into geodata class with
 "borders" and "others"
In-Reply-To: <11529.48267.qm@web29203.mail.ird.yahoo.com>
References: <11529.48267.qm@web29203.mail.ird.yahoo.com>
Message-ID: <alpine.DEB.2.00.1004071013110.13962@bowmore.c3sl.ufpr.br>

Dear Lho

A "geodata" object is a list with at least $coords and $data
and possibly others as mentioned in ?as.geodata

I suspect what may be missing is to assign the class "geodata"
with something like

class(obj) <- "geodata"

Alternatively you can use as.geodata() to convert from a data-frame
(and there as also functions to convert from other formats)

If this does not solve the problem please send some commands you are 
trying with




Paulo Justiniano Ribeiro Jr
LEG (Laboratorio de Estatistica e Geoinformacao)
Universidade Federal do Parana
Caixa Postal 19.081
CEP 81.531-990
Curitiba, PR  -  Brasil
Tel: (+55) 41 3361 3573
Fax: (+55) 41 3361 3141
e-mail: paulojus AT  ufpr  br
http://www.leg.ufpr.br/~paulojus



On Wed, 7 Apr 2010, Lho Lho wrote:

> Dear all
>
> I am not able to build the same geodata list as ca20 (in package geoR) with more than:
>
> "$coords"
> "$data"
> "$covariates".
>
> Actually, I would like to understand how to use as.geodata() in order to include:
>
> "$borders" and "$others: reg1,reg2,reg3.
>
> I tried in multiple ways but I failed.
>
> It doesn't prevent me to perform my geostatistical analysis with geoR as mentioned by the authors, however, it is so helpfull if I can build a geodata object with all variables I need.
>
> Could you help me?
>
> Best regards,
>
> Hocine PhD student?
> my mail: manguefleur at yahoo.fr
>
>
>
>
>
>
>
>
> 	[[alternative HTML version deleted]]
>
>


From ilona.naujo.lewis at gmail.com  Wed Apr  7 17:05:33 2010
From: ilona.naujo.lewis at gmail.com (Ilona Naujokaitis-Lewis)
Date: Wed, 7 Apr 2010 11:05:33 -0400
Subject: [R-sig-Geo] grabriel graphs weighted by alternative distance
	measure
In-Reply-To: <alpine.LRH.2.00.1004061205240.2194@reclus.nhh.no>
References: <o2ve756ab631004050756tfd83b5ct42a68f920c614845@mail.gmail.com>
	<alpine.LRH.2.00.1004061205240.2194@reclus.nhh.no>
Message-ID: <k2le756ab631004070805xef4631a2i433f44815d33bf62@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100407/31d63cdc/attachment.pl>

From misha.spisok at gmail.com  Wed Apr  7 21:19:36 2010
From: misha.spisok at gmail.com (Misha Spisok)
Date: Wed, 7 Apr 2010 12:19:36 -0700
Subject: [R-sig-Geo] Adding labels to map with either spplot or maptools (or
	anything else suggested)
Message-ID: <h2zbe919b321004071219s87fc71adrda08f0283174d72b@mail.gmail.com>

Hello,

In brief: I want to label regions on a map.

I would like to place region names (or abbreviations, if space is too
limited) on a map.  I have tried the examples pasted below, having
copied and adapted various examples I have found but without success
(not to mention countless failed experiments).  The first example,
using 'sp,' is self-contained, but the second one, using 'maptools,'
requires the .shp file, which can retrieved at
http://www.gadm.org/country.  I didn't comment the code because I
don't understand anything beyond trivial 'R' stuff.

-----     Example 1     -----
library(sp)
con <- url("http://gadm.org/data/rda/ITA_adm1.RData")
print(load(con))
close(con)

regionnames <- c("Piemonte", "Valle d'Aosta", "Liguria", "Lombardia",
       "Trentino-Alto Adige/S?dtirol", "Veneto", "Friuli-Venezia Giulia",
       "Emilia-Romagna", "Toscana", "Umbria", "Marche", "Lazio",
"Abruzzo", "Molise",
       "Campania", "Puglia", "Basilicata", "Calabria", "Sicilia", "Sardegna")

gadm$regionnames <- as.factor(regionnames)
col = rainbow(length(levels(gadm$regionnames)))
spplot(gadm, "regionnames", col.regions=col, main="Italian Regions")

This gets me a map with regions colored, but I would like uncolored
(i.e., plain white) regions with the labels in 'regionnames' placed in
the appropriate region.  Furthermore, the colors do not correctly
match the names.  I suppose I could manually re-order my regionnames
vector, but that seems avoidable in a way that I cannot see.  Finally,
I do not want the legend, as it would be meaningless for my use.

-----     Example 2     -----
library(maptools)
nc2 <- readShapePoly("ITA_adm1.shp")
plot(nc2)
invisible(text(getSpPPolygonsLabptSlots(nc2),
labels=as.character(regionnames), cex=0.4))

I also tried the following assignments for 'nc2':
nc2 <- readShapePoly("ITA_adm1.shp"[1], proj4string=CRS("ITA_adm1.dbf"))
nc2 <- readShapePoly("ITA_adm1.shp"[1], proj4string=CRS("+proj=longlat
+datum=NAD27"))

...but these were no more helpful.

This gets me a map with regions outlined (as desired), but the names
don't land where I want them to.  A relatively "klunky" solution is to
just re-order them manually when I declare

regionnames <- c( etc ),

but I'd like to learn how to use what seems to be already available
functionality in either the .shp or .dbf file.

Finally, I also tried to append this (copied then altered) code after
'plot(nc2)':
centroids <- coordinates(nc2)
text(centroids, label=nc2$NAME)

Thank you for taking the time to read this and for any help you may offer.

Best,

misha


From wgu at uab.edu  Wed Apr  7 21:20:23 2010
From: wgu at uab.edu (Weidong Gu)
Date: Wed, 7 Apr 2010 14:20:23 -0500
Subject: [R-sig-Geo] how to pass panel index in spplot
Message-ID: <540FAB030B18B14B8E672DB4B500635B176E0CD1C0@UABEXMBS6.ad.uab.edu>

Hi,

I have a question about spplot: can it transfer somehow panel index, such as subscripts in xyplot to panels. 

The question arose when I needed to plot numbers of disease incidents on state map. The reproducible code is below. I thought panel=function () might be the solution but I couldn't get panel index in individual panels.

library(maps)
library(maptools)
state=map('state',plot=F,fill=T)
IDs=sapply(strsplit(state$names,':'), function(x) x[1])
crs=CRS('+proj=longlat +ellps=WGS84')
sp.st=map2SpatialPolygons(state, IDs, proj4string=crs)

state.inc=data.frame(State=sapply(slot(sp.st,'polygons'),function(x) slot(x,'ID')))
state.inc$D1=rpois(length(state.inc$State),100)
state.inc$D2=rpois(length(state.inc$State),150)
row.names(state.inc)=state.inc$State
inc.spdf=SpatialPolygonsDataFrame(sp.st,state.inc)

spplot(inc.spdf, zcol=2:3,
    panel = function(...) {
        sp.polygons(inc.spdf) 
        sp.text(coordinates(inc.spdf),zcol)
    }
    )

I would appreciate you help and advice.

Weidong Gu
University of Alabama, Birmingham
220A Bevill Biomedical Research Bldg
845 19th Street S., Birmingham, Alabama 35294


From edzer.pebesma at uni-muenster.de  Wed Apr  7 21:48:13 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 07 Apr 2010 21:48:13 +0200
Subject: [R-sig-Geo] strip in spplot do not show
In-Reply-To: <web-4111528@be1.uni-bonn.de>
References: <web-4111528@be1.uni-bonn.de>
Message-ID: <4BBCE17D.9070007@uni-muenster.de>

I browsed through the figures of Deepayan Sarkar's book on Lattice, and
found on http://lmdvr.r-forge.r-project.org/figures/figures.html figure
11.3, which seem to be what you need. Using his code, and building on
your example:

library(sp)
library(lattice)
data(meuse.grid)
coordinates(meuse.grid) <- c("x","y")
gridded(meuse.grid) <- TRUE
fullgrid(meuse.grid) <- TRUE
spplot(meuse.grid, zcol=c(1,2))
update(trellis.last.object(), layout = c(1, 1))[2]

Hth,

Jaime R. Garcia Marquez wrote:
> Dear list users,
> 
> Surely, a very simple question but I did not manage to solve it after a
> while trying.
> 
> I want to use spplot to plot one variable of a SpatialGridDataFrame BUT
> I want the normal lattice 'strip' to appear in the plot.
> 
> data(meuse.grid)
> coordinates(meuse.grid) <- c("x","y")
> gridded(meuse.grid) <- TRUE
> fullgrid(meuse.grid) <- TRUE
> 
> if I plot two variables
> 
> spplot(meuse.grid, zcol=c(1,2))
> 
> then the strip of each panel appears with the name of the variable, in
> this case 'part.a' and 'part.b'.
> 
> But if I plot just one variable the strip does not appear.
> 
> spplot(meuse.grid, zcol=1)
> 
> Not even when I specify the 'strip' argument
> 
> spplot(meuse.grid, zcol=1, strip=TRUE, names.attr="please show up")
> 
> spplot(meuse.grid, zcol=1, strip= strip.custom(var.names="Please show up"))
> 
> What am I missing???
> 
> Any help or suggestion is appreciated.
> 
> Best,
> 
> Jaime R.
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From edzer.pebesma at uni-muenster.de  Wed Apr  7 22:05:06 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 07 Apr 2010 22:05:06 +0200
Subject: [R-sig-Geo] Adding labels to map with either spplot or maptools
 (or	anything else suggested)
In-Reply-To: <h2zbe919b321004071219s87fc71adrda08f0283174d72b@mail.gmail.com>
References: <h2zbe919b321004071219s87fc71adrda08f0283174d72b@mail.gmail.com>
Message-ID: <4BBCE572.60204@uni-muenster.de>

Misha, you were close. I managed to get somewhat closer with:

plot(gadm)
text(getSpPPolygonsLabptSlots(gadm), labels=regionnames, cex=0.4)

still, you need to provide regionnames in the order of the polygons in
gadm, whether you use plot or spplot, in order to have the right labels.
The command factor orders them alphabetically, unless told otherwise.
The as.character was not needed, as regionnames already was character.

spplot is not an easy path for the plot you want, as it tries to give
colors to polygons in order to communicate something. Of course, you
could make all colors white but then there's still the legend to get rid
of. Plotting text on particular locations can be done by passing an
sp.layout argument - see ?spplot.

Hope this helps,

Misha Spisok wrote:
> Hello,
> 
> In brief: I want to label regions on a map.
> 
> I would like to place region names (or abbreviations, if space is too
> limited) on a map.  I have tried the examples pasted below, having
> copied and adapted various examples I have found but without success
> (not to mention countless failed experiments).  The first example,
> using 'sp,' is self-contained, but the second one, using 'maptools,'
> requires the .shp file, which can retrieved at
> http://www.gadm.org/country.  I didn't comment the code because I
> don't understand anything beyond trivial 'R' stuff.
> 
> -----     Example 1     -----
> library(sp)
> con <- url("http://gadm.org/data/rda/ITA_adm1.RData")
> print(load(con))
> close(con)
> 
> regionnames <- c("Piemonte", "Valle d'Aosta", "Liguria", "Lombardia",
>        "Trentino-Alto Adige/S?dtirol", "Veneto", "Friuli-Venezia Giulia",
>        "Emilia-Romagna", "Toscana", "Umbria", "Marche", "Lazio",
> "Abruzzo", "Molise",
>        "Campania", "Puglia", "Basilicata", "Calabria", "Sicilia", "Sardegna")
> 
> gadm$regionnames <- as.factor(regionnames)
> col = rainbow(length(levels(gadm$regionnames)))
> spplot(gadm, "regionnames", col.regions=col, main="Italian Regions")
> 
> This gets me a map with regions colored, but I would like uncolored
> (i.e., plain white) regions with the labels in 'regionnames' placed in
> the appropriate region.  Furthermore, the colors do not correctly
> match the names.  I suppose I could manually re-order my regionnames
> vector, but that seems avoidable in a way that I cannot see.  Finally,
> I do not want the legend, as it would be meaningless for my use.
> 
> -----     Example 2     -----
> library(maptools)
> nc2 <- readShapePoly("ITA_adm1.shp")
> plot(nc2)
> invisible(text(getSpPPolygonsLabptSlots(nc2),
> labels=as.character(regionnames), cex=0.4))
> 
> I also tried the following assignments for 'nc2':
> nc2 <- readShapePoly("ITA_adm1.shp"[1], proj4string=CRS("ITA_adm1.dbf"))
> nc2 <- readShapePoly("ITA_adm1.shp"[1], proj4string=CRS("+proj=longlat
> +datum=NAD27"))
> 
> ...but these were no more helpful.
> 
> This gets me a map with regions outlined (as desired), but the names
> don't land where I want them to.  A relatively "klunky" solution is to
> just re-order them manually when I declare
> 
> regionnames <- c( etc ),
> 
> but I'd like to learn how to use what seems to be already available
> functionality in either the .shp or .dbf file.
> 
> Finally, I also tried to append this (copied then altered) code after
> 'plot(nc2)':
> centroids <- coordinates(nc2)
> text(centroids, label=nc2$NAME)
> 
> Thank you for taking the time to read this and for any help you may offer.
> 
> Best,
> 
> misha
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From edzer.pebesma at uni-muenster.de  Wed Apr  7 22:08:48 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 07 Apr 2010 22:08:48 +0200
Subject: [R-sig-Geo] how to pass panel index in spplot
In-Reply-To: <540FAB030B18B14B8E672DB4B500635B176E0CD1C0@UABEXMBS6.ad.uab.edu>
References: <540FAB030B18B14B8E672DB4B500635B176E0CD1C0@UABEXMBS6.ad.uab.edu>
Message-ID: <4BBCE650.2000602@uni-muenster.de>

Dear Weidong,

for multi-group panel functions, the way to retrieve subscripts in
custom panel functions is

panel = function(x,y,subscripts, ...) {
 ... # do sth with subscripts here
}

see also

library(lattice)
?panel.superpose

I hope this helped,

Weidong Gu wrote:
> Hi,
> 
> I have a question about spplot: can it transfer somehow panel index, such as subscripts in xyplot to panels. 
> 
> The question arose when I needed to plot numbers of disease incidents on state map. The reproducible code is below. I thought panel=function () might be the solution but I couldn't get panel index in individual panels.
> 
> library(maps)
> library(maptools)
> state=map('state',plot=F,fill=T)
> IDs=sapply(strsplit(state$names,':'), function(x) x[1])
> crs=CRS('+proj=longlat +ellps=WGS84')
> sp.st=map2SpatialPolygons(state, IDs, proj4string=crs)
> 
> state.inc=data.frame(State=sapply(slot(sp.st,'polygons'),function(x) slot(x,'ID')))
> state.inc$D1=rpois(length(state.inc$State),100)
> state.inc$D2=rpois(length(state.inc$State),150)
> row.names(state.inc)=state.inc$State
> inc.spdf=SpatialPolygonsDataFrame(sp.st,state.inc)
> 
> spplot(inc.spdf, zcol=2:3,
>     panel = function(...) {
>         sp.polygons(inc.spdf) 
>         sp.text(coordinates(inc.spdf),zcol)
>     }
>     )
> 
> I would appreciate you help and advice.
> 
> Weidong Gu
> University of Alabama, Birmingham
> 220A Bevill Biomedical Research Bldg
> 845 19th Street S., Birmingham, Alabama 35294
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From wgu at uab.edu  Wed Apr  7 22:20:00 2010
From: wgu at uab.edu (Weidong Gu)
Date: Wed, 7 Apr 2010 15:20:00 -0500
Subject: [R-sig-Geo] Adding labels to map with either spplot or maptools
 (or anything else suggested)
Message-ID: <540FAB030B18B14B8E672DB4B500635B176E0CD1C2@UABEXMBS6.ad.uab.edu>

Try

spplot(gadm,zcol=1,panel=function(...){
sp.polygons(gadm)
sp.text(coordinates(gadm),regionnames,cex=0.6)
},colorkey=F)


Weidong Gu, PhD

University of Alabama, Birmingham


From wgu at uab.edu  Wed Apr  7 22:41:48 2010
From: wgu at uab.edu (Weidong Gu)
Date: Wed, 7 Apr 2010 15:41:48 -0500
Subject: [R-sig-Geo] how to pass panel index in spplot
In-Reply-To: <4BBCE650.2000602@uni-muenster.de>
References: <540FAB030B18B14B8E672DB4B500635B176E0CD1C0@UABEXMBS6.ad.uab.edu>
	<4BBCE650.2000602@uni-muenster.de>
Message-ID: <540FAB030B18B14B8E672DB4B500635B176E0CD1C3@UABEXMBS6.ad.uab.edu>

Thanks Edzer for advising the option. But I could not figure out how to draw spatial polygons like state map with xyplot.

Weidong

> -----Original Message-----
> From: Edzer Pebesma [mailto:edzer.pebesma at uni-muenster.de]
> Sent: Wednesday, April 07, 2010 3:09 PM
> To: Weidong Gu
> Cc: 'r-sig-geo at stat.math.ethz.ch'
> Subject: Re: [R-sig-Geo] how to pass panel index in spplot
> 
> Dear Weidong,
> 
> for multi-group panel functions, the way to retrieve subscripts in
> custom panel functions is
> 
> panel = function(x,y,subscripts, ...) {
>  ... # do sth with subscripts here
> }
> 
> see also
> 
> library(lattice)
> ?panel.superpose
> 
> I hope this helped,
> 
> Weidong Gu wrote:
> > Hi,
> >
> > I have a question about spplot: can it transfer somehow panel index,
> such as subscripts in xyplot to panels.
> >
> > The question arose when I needed to plot numbers of disease incidents
> on state map. The reproducible code is below. I thought panel=function
> () might be the solution but I couldn't get panel index in individual
> panels.
> >
> > library(maps)
> > library(maptools)
> > state=map('state',plot=F,fill=T)
> > IDs=sapply(strsplit(state$names,':'), function(x) x[1])
> > crs=CRS('+proj=longlat +ellps=WGS84')
> > sp.st=map2SpatialPolygons(state, IDs, proj4string=crs)
> >
> > state.inc=data.frame(State=sapply(slot(sp.st,'polygons'),function(x)
> slot(x,'ID')))
> > state.inc$D1=rpois(length(state.inc$State),100)
> > state.inc$D2=rpois(length(state.inc$State),150)
> > row.names(state.inc)=state.inc$State
> > inc.spdf=SpatialPolygonsDataFrame(sp.st,state.inc)
> >
> > spplot(inc.spdf, zcol=2:3,
> >     panel = function(...) {
> >         sp.polygons(inc.spdf)
> >         sp.text(coordinates(inc.spdf),zcol)
> >     }
> >     )
> >
> > I would appreciate you help and advice.
> >
> > Weidong Gu
> > University of Alabama, Birmingham
> > 220A Bevill Biomedical Research Bldg
> > 845 19th Street S., Birmingham, Alabama 35294
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> --
> Edzer Pebesma
> Institute for Geoinformatics (ifgi), University of M?nster
> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
> 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
> http://www.52north.org/geostatistics      e.pebesma at wwu.de


From misha.spisok at gmail.com  Wed Apr  7 22:44:30 2010
From: misha.spisok at gmail.com (Misha Spisok)
Date: Wed, 7 Apr 2010 13:44:30 -0700
Subject: [R-sig-Geo] Adding labels to map with either spplot or maptools
	(or anything else suggested)
In-Reply-To: <h2zbe919b321004071219s87fc71adrda08f0283174d72b@mail.gmail.com>
References: <h2zbe919b321004071219s87fc71adrda08f0283174d72b@mail.gmail.com>
Message-ID: <r2sbe919b321004071344x33af2dc9ib5474003727b5b11@mail.gmail.com>

Thank you for the replies, Edzer and Weidong.

I did the following.  I used 'names(nc2)' (with respect to the
original code in Example 2), then, guessing and confirming that
'NAME_1' contained the region names, I changed the line 'text(...)' to
contain 'NAME_1' instead of 'NAME,' (as given below the output from
'names(nc2)').

> names(nc2)
 [1] "ID_0"       "ISO"        "NAME_0"     "ID_1"       "NAME_1"
 [6] "VARNAME_1"  "NL_NAME_1"  "HASC_1"     "CC_1"       "TYPE_1"
[11] "ENGTYPE_1"  "VALIDFR_1"  "VALIDTO_1"  "REMARKS_1"  "Shape_Leng"
[16] "Shape_Area"

text(centroids, label=nc2$NAME_1)

As a follow up...

Is there a way to enlarge the map, rather than adjusting the font size
(via 'cex')?
Is there a way to rotate the map?

Thanks again,

Misha


On Wed, Apr 7, 2010 at 12:19 PM, Misha Spisok <misha.spisok at gmail.com> wrote:
> Hello,
>
> In brief: I want to label regions on a map.
>
> I would like to place region names (or abbreviations, if space is too
> limited) on a map. ?I have tried the examples pasted below, having
> copied and adapted various examples I have found but without success
> (not to mention countless failed experiments). ?The first example,
> using 'sp,' is self-contained, but the second one, using 'maptools,'
> requires the .shp file, which can retrieved at
> http://www.gadm.org/country. ?I didn't comment the code because I
> don't understand anything beyond trivial 'R' stuff.
>
> ----- ? ? Example 1 ? ? -----
> library(sp)
> con <- url("http://gadm.org/data/rda/ITA_adm1.RData")
> print(load(con))
> close(con)
>
> regionnames <- c("Piemonte", "Valle d'Aosta", "Liguria", "Lombardia",
> ? ? ? "Trentino-Alto Adige/S?dtirol", "Veneto", "Friuli-Venezia Giulia",
> ? ? ? "Emilia-Romagna", "Toscana", "Umbria", "Marche", "Lazio",
> "Abruzzo", "Molise",
> ? ? ? "Campania", "Puglia", "Basilicata", "Calabria", "Sicilia", "Sardegna")
>
> gadm$regionnames <- as.factor(regionnames)
> col = rainbow(length(levels(gadm$regionnames)))
> spplot(gadm, "regionnames", col.regions=col, main="Italian Regions")
>
> This gets me a map with regions colored, but I would like uncolored
> (i.e., plain white) regions with the labels in 'regionnames' placed in
> the appropriate region. ?Furthermore, the colors do not correctly
> match the names. ?I suppose I could manually re-order my regionnames
> vector, but that seems avoidable in a way that I cannot see. ?Finally,
> I do not want the legend, as it would be meaningless for my use.
>
> ----- ? ? Example 2 ? ? -----
> library(maptools)
> nc2 <- readShapePoly("ITA_adm1.shp")
> plot(nc2)
> invisible(text(getSpPPolygonsLabptSlots(nc2),
> labels=as.character(regionnames), cex=0.4))
>
> I also tried the following assignments for 'nc2':
> nc2 <- readShapePoly("ITA_adm1.shp"[1], proj4string=CRS("ITA_adm1.dbf"))
> nc2 <- readShapePoly("ITA_adm1.shp"[1], proj4string=CRS("+proj=longlat
> +datum=NAD27"))
>
> ...but these were no more helpful.
>
> This gets me a map with regions outlined (as desired), but the names
> don't land where I want them to. ?A relatively "klunky" solution is to
> just re-order them manually when I declare
>
> regionnames <- c( etc ),
>
> but I'd like to learn how to use what seems to be already available
> functionality in either the .shp or .dbf file.
>
> Finally, I also tried to append this (copied then altered) code after
> 'plot(nc2)':
> centroids <- coordinates(nc2)
> text(centroids, label=nc2$NAME)
>
> Thank you for taking the time to read this and for any help you may offer.
>
> Best,
>
> misha
>


From edzer.pebesma at uni-muenster.de  Wed Apr  7 23:00:47 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 07 Apr 2010 23:00:47 +0200
Subject: [R-sig-Geo] how to pass panel index in spplot
In-Reply-To: <540FAB030B18B14B8E672DB4B500635B176E0CD1C3@UABEXMBS6.ad.uab.edu>
References: <540FAB030B18B14B8E672DB4B500635B176E0CD1C0@UABEXMBS6.ad.uab.edu>
	<4BBCE650.2000602@uni-muenster.de>
	<540FAB030B18B14B8E672DB4B500635B176E0CD1C3@UABEXMBS6.ad.uab.edu>
Message-ID: <4BBCF27F.5050205@uni-muenster.de>

Weidong, is

library(maps)
library(maptools)
state=map('state',plot=F,fill=T)
IDs=sapply(strsplit(state$names,':'), function(x) x[1])
crs=CRS('+proj=longlat +ellps=WGS84')
sp.st=map2SpatialPolygons(state, IDs, proj4string=crs)

state.inc=data.frame(State=sapply(slot(sp.st,'polygons'),function(x)
slot(x,'ID')))
state.inc$D1=rpois(length(state.inc$State),100)
state.inc$D2=rpois(length(state.inc$State),150)
row.names(state.inc)=state.inc$State
inc.spdf=SpatialPolygonsDataFrame(sp.st,state.inc)

spplot(inc.spdf, zcol=2:3,
    panel = function(x,y,z,subscripts,...) {
        panel.polygonsplot(x,y,z,subscripts,...)
        sp.text(coordinates(inc.spdf), z[subscripts])
    }
)

what you want?

Weidong Gu wrote:
> Thanks Edzer for advising the option. But I could not figure out how to draw spatial polygons like state map with xyplot.
> 
> Weidong
> 
>> -----Original Message-----
>> From: Edzer Pebesma [mailto:edzer.pebesma at uni-muenster.de]
>> Sent: Wednesday, April 07, 2010 3:09 PM
>> To: Weidong Gu
>> Cc: 'r-sig-geo at stat.math.ethz.ch'
>> Subject: Re: [R-sig-Geo] how to pass panel index in spplot
>>
>> Dear Weidong,
>>
>> for multi-group panel functions, the way to retrieve subscripts in
>> custom panel functions is
>>
>> panel = function(x,y,subscripts, ...) {
>>  ... # do sth with subscripts here
>> }
>>
>> see also
>>
>> library(lattice)
>> ?panel.superpose
>>
>> I hope this helped,
>>
>> Weidong Gu wrote:
>>> Hi,
>>>
>>> I have a question about spplot: can it transfer somehow panel index,
>> such as subscripts in xyplot to panels.
>>> The question arose when I needed to plot numbers of disease incidents
>> on state map. The reproducible code is below. I thought panel=function
>> () might be the solution but I couldn't get panel index in individual
>> panels.
>>> library(maps)
>>> library(maptools)
>>> state=map('state',plot=F,fill=T)
>>> IDs=sapply(strsplit(state$names,':'), function(x) x[1])
>>> crs=CRS('+proj=longlat +ellps=WGS84')
>>> sp.st=map2SpatialPolygons(state, IDs, proj4string=crs)
>>>
>>> state.inc=data.frame(State=sapply(slot(sp.st,'polygons'),function(x)
>> slot(x,'ID')))
>>> state.inc$D1=rpois(length(state.inc$State),100)
>>> state.inc$D2=rpois(length(state.inc$State),150)
>>> row.names(state.inc)=state.inc$State
>>> inc.spdf=SpatialPolygonsDataFrame(sp.st,state.inc)
>>>
>>> spplot(inc.spdf, zcol=2:3,
>>>     panel = function(...) {
>>>         sp.polygons(inc.spdf)
>>>         sp.text(coordinates(inc.spdf),zcol)
>>>     }
>>>     )
>>>
>>> I would appreciate you help and advice.
>>>
>>> Weidong Gu
>>> University of Alabama, Birmingham
>>> 220A Bevill Biomedical Research Bldg
>>> 845 19th Street S., Birmingham, Alabama 35294
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> --
>> Edzer Pebesma
>> Institute for Geoinformatics (ifgi), University of M?nster
>> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
>> 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
>> http://www.52north.org/geostatistics      e.pebesma at wwu.de

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From wgu at uab.edu  Wed Apr  7 23:09:03 2010
From: wgu at uab.edu (Weidong Gu)
Date: Wed, 7 Apr 2010 16:09:03 -0500
Subject: [R-sig-Geo] how to pass panel index in spplot
In-Reply-To: <4BBCF27F.5050205@uni-muenster.de>
References: <540FAB030B18B14B8E672DB4B500635B176E0CD1C0@UABEXMBS6.ad.uab.edu>
	<4BBCE650.2000602@uni-muenster.de>
	<540FAB030B18B14B8E672DB4B500635B176E0CD1C3@UABEXMBS6.ad.uab.edu>
	<4BBCF27F.5050205@uni-muenster.de>
Message-ID: <540FAB030B18B14B8E672DB4B500635B176E0CD1C4@UABEXMBS6.ad.uab.edu>

Edzer,

Many thanks. This is just what I wanted, i.e. showing incidence numbers on the state map. 

Weidong

> -----Original Message-----
> From: Edzer Pebesma [mailto:edzer.pebesma at uni-muenster.de]
> Sent: Wednesday, April 07, 2010 4:01 PM
> To: Weidong Gu
> Cc: 'r-sig-geo at stat.math.ethz.ch'
> Subject: Re: [R-sig-Geo] how to pass panel index in spplot
> 
> Weidong, is
> 
> library(maps)
> library(maptools)
> state=map('state',plot=F,fill=T)
> IDs=sapply(strsplit(state$names,':'), function(x) x[1])
> crs=CRS('+proj=longlat +ellps=WGS84')
> sp.st=map2SpatialPolygons(state, IDs, proj4string=crs)
> 
> state.inc=data.frame(State=sapply(slot(sp.st,'polygons'),function(x)
> slot(x,'ID')))
> state.inc$D1=rpois(length(state.inc$State),100)
> state.inc$D2=rpois(length(state.inc$State),150)
> row.names(state.inc)=state.inc$State
> inc.spdf=SpatialPolygonsDataFrame(sp.st,state.inc)
> 
> spplot(inc.spdf, zcol=2:3,
>     panel = function(x,y,z,subscripts,...) {
>         panel.polygonsplot(x,y,z,subscripts,...)
>         sp.text(coordinates(inc.spdf), z[subscripts])
>     }
> )
> 
> what you want?
> 
> Weidong Gu wrote:
> > Thanks Edzer for advising the option. But I could not figure out how
> to draw spatial polygons like state map with xyplot.
> >
> > Weidong
> >
> >> -----Original Message-----
> >> From: Edzer Pebesma [mailto:edzer.pebesma at uni-muenster.de]
> >> Sent: Wednesday, April 07, 2010 3:09 PM
> >> To: Weidong Gu
> >> Cc: 'r-sig-geo at stat.math.ethz.ch'
> >> Subject: Re: [R-sig-Geo] how to pass panel index in spplot
> >>
> >> Dear Weidong,
> >>
> >> for multi-group panel functions, the way to retrieve subscripts in
> >> custom panel functions is
> >>
> >> panel = function(x,y,subscripts, ...) {
> >>  ... # do sth with subscripts here
> >> }
> >>
> >> see also
> >>
> >> library(lattice)
> >> ?panel.superpose
> >>
> >> I hope this helped,
> >>
> >> Weidong Gu wrote:
> >>> Hi,
> >>>
> >>> I have a question about spplot: can it transfer somehow panel index,
> >> such as subscripts in xyplot to panels.
> >>> The question arose when I needed to plot numbers of disease
> incidents
> >> on state map. The reproducible code is below. I thought
> panel=function
> >> () might be the solution but I couldn't get panel index in
> individual
> >> panels.
> >>> library(maps)
> >>> library(maptools)
> >>> state=map('state',plot=F,fill=T)
> >>> IDs=sapply(strsplit(state$names,':'), function(x) x[1])
> >>> crs=CRS('+proj=longlat +ellps=WGS84')
> >>> sp.st=map2SpatialPolygons(state, IDs, proj4string=crs)
> >>>
> >>> state.inc=data.frame(State=sapply(slot(sp.st,'polygons'),function(x)
> >> slot(x,'ID')))
> >>> state.inc$D1=rpois(length(state.inc$State),100)
> >>> state.inc$D2=rpois(length(state.inc$State),150)
> >>> row.names(state.inc)=state.inc$State
> >>> inc.spdf=SpatialPolygonsDataFrame(sp.st,state.inc)
> >>>
> >>> spplot(inc.spdf, zcol=2:3,
> >>>     panel = function(...) {
> >>>         sp.polygons(inc.spdf)
> >>>         sp.text(coordinates(inc.spdf),zcol)
> >>>     }
> >>>     )
> >>>
> >>> I would appreciate you help and advice.
> >>>
> >>> Weidong Gu
> >>> University of Alabama, Birmingham
> >>> 220A Bevill Biomedical Research Bldg
> >>> 845 19th Street S., Birmingham, Alabama 35294
> >>>
> >>> _______________________________________________
> >>> R-sig-Geo mailing list
> >>> R-sig-Geo at stat.math.ethz.ch
> >>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >> --
> >> Edzer Pebesma
> >> Institute for Geoinformatics (ifgi), University of M?nster
> >> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
> >> 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
> >> http://www.52north.org/geostatistics      e.pebesma at wwu.de
> 
> --
> Edzer Pebesma
> Institute for Geoinformatics (ifgi), University of M?nster
> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
> 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
> http://www.52north.org/geostatistics      e.pebesma at wwu.de


From german.sanchez at ais-int.com  Thu Apr  8 12:21:21 2010
From: german.sanchez at ais-int.com (=?iso-8859-1?Q?Germ=E1n_S=E1nchez?=)
Date: Thu, 8 Apr 2010 12:21:21 +0200 (CEST)
Subject: [R-sig-Geo] Shape to DB, DB to SpatialPolygon
Message-ID: <52383.10.10.2.41.1270722081.squirrel@hermes.ais-int.net>

Dear all,

I've working with spatial data since only a few months. I know how to
handle this kind of data in R using the sp package. I know how to load
shapes, plot them, merge their polygons, plotting labels, etc.

I have installed a postgis database and I can connect to it from R via
RODBC without problems. I can load a shape file (.shp and so) into the
database (command shp2pgsql  to create the needed .sql). It creates a
table with some usual fields (area, perimeter, district, etc) and the
special one: the_geom.

Now, I want to load this data to a SpatialPolygon (or
SpatialPolygonDataFrame) object using the RODBC driver. I would like to
get the same object as if I have used the "readShapePoly" function from sp
package directly over the .shp file.

Any idea? Is there a direct solution or I have to build the polygon myself?

Thank you,
Germ?n S?nchez
german.sanchez at esade.edu


From cara.tobin at epfl.ch  Thu Apr  8 13:00:40 2010
From: cara.tobin at epfl.ch (Tobin Cara)
Date: Thu, 8 Apr 2010 13:00:40 +0200
Subject: [R-sig-Geo] plotting quantiles with boxplot
Message-ID: <EDB94195DABE64488928DD39E53B8FC68BF118ACE1@REX2.intranet.epfl.ch>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100408/8382f873/attachment.pl>

From carson.farmer at gmail.com  Thu Apr  8 13:17:52 2010
From: carson.farmer at gmail.com (Carson Farmer)
Date: Thu, 8 Apr 2010 12:17:52 +0100
Subject: [R-sig-Geo] Shape to DB, DB to SpatialPolygon
In-Reply-To: <52383.10.10.2.41.1270722081.squirrel@hermes.ais-int.net>
References: <52383.10.10.2.41.1270722081.squirrel@hermes.ais-int.net>
Message-ID: <r2t94b3c8441004080417o5a080b77u3cbc7bebc7b6df5c@mail.gmail.com>

Hi Germ?n,

Have a look at package rgdal and the readOGR function.

> library(rgdal)
> ?readOGR

Here is a link with a quick bit on using rgdal to access a postgis table:
http://wiki.intamap.org/index.php/PostGIS

Regards,

Carson

On Thu, Apr 8, 2010 at 11:21 AM, Germ?n S?nchez
<german.sanchez at ais-int.com> wrote:
> Dear all,
>
> I've working with spatial data since only a few months. I know how to
> handle this kind of data in R using the sp package. I know how to load
> shapes, plot them, merge their polygons, plotting labels, etc.
>
> I have installed a postgis database and I can connect to it from R via
> RODBC without problems. I can load a shape file (.shp and so) into the
> database (command shp2pgsql ?to create the needed .sql). It creates a
> table with some usual fields (area, perimeter, district, etc) and the
> special one: the_geom.
>
> Now, I want to load this data to a SpatialPolygon (or
> SpatialPolygonDataFrame) object using the RODBC driver. I would like to
> get the same object as if I have used the "readShapePoly" function from sp
> package directly over the .shp file.
>
> Any idea? Is there a direct solution or I have to build the polygon myself?
>
> Thank you,
> Germ?n S?nchez
> german.sanchez at esade.edu
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Carson J. Q. Farmer
ISSP Doctoral Fellow
National Centre for Geocomputation
National University of Ireland, Maynooth,
http://www.carsonfarmer.com/


From gianni.lavaredo at gmail.com  Thu Apr  8 13:37:51 2010
From: gianni.lavaredo at gmail.com (gianni lavaredo)
Date: Thu, 8 Apr 2010 13:37:51 +0200
Subject: [R-sig-Geo] create a regular grid from a given point
Message-ID: <p2q518dff331004080437pb91f8456u1cb030a9abda4ab0@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100408/c365febd/attachment.pl>

From alp97 at hotmail.com  Thu Apr  8 13:42:35 2010
From: alp97 at hotmail.com (Alper ALTINOK)
Date: Thu, 8 Apr 2010 11:42:35 +0000
Subject: [R-sig-Geo] can I use GWR with zero-inflated data?
Message-ID: <SNT144-w494C90658E84E5EE9C3DCFBC160@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100408/4f0ed076/attachment.pl>

From yud at mail.montclair.edu  Thu Apr  8 19:02:28 2010
From: yud at mail.montclair.edu (Danlin Yu)
Date: Thu, 08 Apr 2010 13:02:28 -0400
Subject: [R-sig-Geo] can I use GWR with zero-inflated data?
In-Reply-To: <SNT144-w494C90658E84E5EE9C3DCFBC160@phx.gbl>
References: <SNT144-w494C90658E84E5EE9C3DCFBC160@phx.gbl>
Message-ID: <4BBE0C24.8060904@mail.montclair.edu>

Alper:

Without knowing exactly what type of data that might be, I would say the 
data probably are not the best set for GWR analysis (not even for OLS, I 
might add) due to the lack of variation of your dependent variable. In 
addition, nominal (coded, I assume?) independent variable can cause no 
variation at all in locally weighted calibration.

Is there a compelling reason that you believe GWR is a reasonable choice 
for your data analysis?

Hope this helps.

Cheers,
Danlin

Alper ALTINOK ??:
>  
>
> Dear all,
>  
> I want to hear your opinions on applicability of GWR method on the following kind of data;
>  
> Dependent:
> -Numeric > continuous. With excess zeroes (about %70).
>  
> Independent(s):
> -Numeric > nominal
> -Character > nominal
> -Numeric > ordinal
>  
>  
> Alp
>
>  		 	   		  
> _________________________________________________________________
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   

-- 
___________________________________________
Danlin Yu, Ph.D.
Assistant Professor of GIS and Urban Geography
Department of Earth & Environmental Studies
Montclair State University
Montclair, NJ, 07043
Tel: 973-655-4313
Fax: 973-655-4072
email: yud at mail.montclair.edu
webpage: csam.montclair.edu/~yu


From alp97 at hotmail.com  Thu Apr  8 19:48:50 2010
From: alp97 at hotmail.com (Alper ALTINOK)
Date: Thu, 8 Apr 2010 17:48:50 +0000
Subject: [R-sig-Geo] can I use GWR with zero-inflated data?
In-Reply-To: <4BBE0C24.8060904@mail.montclair.edu>
References: <SNT144-w494C90658E84E5EE9C3DCFBC160@phx.gbl>,
	<4BBE0C24.8060904@mail.montclair.edu>
Message-ID: <SNT144-w34A484303DA59BE7995E0BC160@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100408/a2b9e62f/attachment.pl>

From gianni.lavaredo at gmail.com  Thu Apr  8 20:39:46 2010
From: gianni.lavaredo at gmail.com (gianni lavaredo)
Date: Thu, 8 Apr 2010 20:39:46 +0200
Subject: [R-sig-Geo] suggestion to sum value inside a row in a data.frame
Message-ID: <t2q518dff331004081139v865ab8efo8702f5f12be69d80@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100408/8bef9163/attachment.pl>

From djmuser at gmail.com  Thu Apr  8 20:44:24 2010
From: djmuser at gmail.com (Dennis Murphy)
Date: Thu, 8 Apr 2010 11:44:24 -0700
Subject: [R-sig-Geo] suggestion to sum value inside a row in a data.frame
In-Reply-To: <t2q518dff331004081139v865ab8efo8702f5f12be69d80@mail.gmail.com>
References: <t2q518dff331004081139v865ab8efo8702f5f12be69d80@mail.gmail.com>
Message-ID: <v2y9a8a6c631004081144x48c43c52q510479df7223c7c8@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100408/33662b23/attachment.pl>

From milton.ruser at gmail.com  Thu Apr  8 20:46:24 2010
From: milton.ruser at gmail.com (milton ruser)
Date: Thu, 8 Apr 2010 14:46:24 -0400
Subject: [R-sig-Geo] suggestion to sum value inside a row in a data.frame
In-Reply-To: <t2q518dff331004081139v865ab8efo8702f5f12be69d80@mail.gmail.com>
References: <t2q518dff331004081139v865ab8efo8702f5f12be69d80@mail.gmail.com>
Message-ID: <j2y3aaf1a031004081146t1ab11498y27760bea205fc967@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100408/290c07c2/attachment.pl>

From dinis.joel at gmail.com  Fri Apr  9 11:53:15 2010
From: dinis.joel at gmail.com (joel dinis)
Date: Fri, 9 Apr 2010 10:53:15 +0100
Subject: [R-sig-Geo] Really fresh R-GRASS user.
Message-ID: <u2z5fd673781004090253x1b5bebcdo2045f36f303b0959@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100409/00d68d4c/attachment.pl>

From guido.lemoine at jrc.ec.europa.eu  Fri Apr  9 12:05:05 2010
From: guido.lemoine at jrc.ec.europa.eu (guido.lemoine at jrc.ec.europa.eu)
Date: Fri, 9 Apr 2010 12:05:05 +0200
Subject: [R-sig-Geo] Array indices for very large multi-band images
Message-ID: <4BB1CEF500000553@cheetah-1.jrc.it>

Dears,

I just joined the list, so please bear with me if my problem
has been dealt with already. I did an extensive google search,
making sure r-gis-geo was included, so am sort of sure my
problem is relevant.

I have a (very) large 3 band ENVI file (32431 x 47262, 4.5 Gb,
i.e. too big for normal GeoTIFF). I would like to generate
statistics for 200 by 200 sized cells (including cross-correlation
between bands).
I am using the rgdal package, trying to use the array indexing
syntax of R, running into trouble when trying to subset all
3 bands at the same time.

Using array index syntax is useful, because it produces a
SpatialGridDataFrame, which makes further processing easier.

Here's my trial script:

require(rgdal)
x<-GDAL.open("verylarge3channelENVIimage")
r <- getRasterData(x, offset = c(14000, 14000), region.dim = c(200, 200))
str(r)
# This works, but produces a simple integer array
int [1:200, 1:200, 1:3] 0 0 0 0 0 0 0 0 0 0 ...
# I'd rather do this
sub0 <- x[14000:14199, 14000:14199,]  # ... but doesn't work
Error in x[14000:14199, 14000:14199, ] :
  argument is missing, with no default
# this then?
sub1 <- x[14000:14199, 14000:14199,1:3] # no, running into memory trouble
Error: cannot allocate vector of size 2.3 Gb
# per band works:
sub2 <- x[14000:14199, 14000:14199,1]  # produces a nice spatial object.
summary(sub2)
Object of class SpatialGridDataFrame
...

Is there a way to get all 3 bands with array index syntax, preferably
as a SpatialGridDataFrame with band1, band2, band3.

Any help greatly appreciated,

GL


From p.hiemstra at geo.uu.nl  Fri Apr  9 13:15:07 2010
From: p.hiemstra at geo.uu.nl (Paul Hiemstra)
Date: Fri, 09 Apr 2010 13:15:07 +0200
Subject: [R-sig-Geo] Really fresh R-GRASS user.
In-Reply-To: <u2z5fd673781004090253x1b5bebcdo2045f36f303b0959@mail.gmail.com>
References: <u2z5fd673781004090253x1b5bebcdo2045f36f303b0959@mail.gmail.com>
Message-ID: <4BBF0C3B.9010001@geo.uu.nl>

joel dinis wrote:
> Hello to all,
>
> I'm a really new user in R and in R-GRASS interface,
> but not so new in geostatistics. I wonder if someone can
> indicate me a good starting tutorial. I've been googling
> about it but probably the experience users know best.
>
> Thank you
> JD
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   
Hi,

Take a look at the Spatial Task View, this has a section on geostatistics.

cheers,
Paul

-- 
Drs. Paul Hiemstra
Department of Physical Geography
Faculty of Geosciences
University of Utrecht
Heidelberglaan 2
P.O. Box 80.115
3508 TC Utrecht
Phone:  +3130 274 3113 Mon-Tue
Phone:  +3130 253 5773 Wed-Fri
http://intamap.geo.uu.nl/~paul
http://nl.linkedin.com/pub/paul-hiemstra/20/30b/770


From puneetd at ufl.edu  Fri Apr  9 17:00:15 2010
From: puneetd at ufl.edu (Dwivedi,Puneet)
Date: Fri, 9 Apr 2010 11:00:15 -0400
Subject: [R-sig-Geo] Clip a shpae file with a grid
Message-ID: <4102DA2A6DF4394B83D6F9EFC2AD12F73B0408546C@UFEXCH-MBXCL01.ad.ufl.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100409/6d06d655/attachment.pl>

From r.hijmans at gmail.com  Fri Apr  9 19:34:27 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Fri, 9 Apr 2010 10:34:27 -0700
Subject: [R-sig-Geo] Clip a shpae file with a grid
In-Reply-To: <4102DA2A6DF4394B83D6F9EFC2AD12F73B0408546C@UFEXCH-MBXCL01.ad.ufl.edu>
References: <4102DA2A6DF4394B83D6F9EFC2AD12F73B0408546C@UFEXCH-MBXCL01.ad.ufl.edu>
Message-ID: <g2hdc22b2571004091034p28de9a49g2a73a2052a43b0b4@mail.gmail.com>

Dear Puneet,

To clip a grid with a your polygon 'vector' you can do:

library(raster)
r = raster( extent(-117026, 582149, 2783590, 3443337) )
res(r) = 10000
rc = crop(r, vector)

If you want to know which cells are land and which are not:
rp = polygonsToRaster(vector, rc, field=-1)
plot(rp)

# rp is now a RasterLayer object with cell values 1 where the polygons
overlaps the center of the cell and NA in other cells.

plot(rp)

Robert


On Fri, Apr 9, 2010 at 8:00 AM, Dwivedi,Puneet <puneetd at ufl.edu> wrote:
> Dear All,
>
> I have created a grid for the State of FL using following command:
>
> locpred = expand.grid(X=seq(-117026, 582149, 10000), Y=seq(2783590, 3443337, 10000))
> plot(locpred)
>
> The Gulf of Mexico is also included in the above grid.
>
> I am using following command to import a shape file of FL:
>
> library(maptools)
> vector = readShapePoly("County_BND.shp")
> plot(vector)
>
> Now, I am looking for some code which can help me in obtaining exact grid of FL using above imported shape file as a clipping surface.
>
> It will be great if somebody can guide me on the same as I am not getting any success in finding the code. Alternate procedure is also welcome!
>
> Cheers,
> Puneet Dwivedi
>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From r.hijmans at gmail.com  Fri Apr  9 19:46:33 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Fri, 9 Apr 2010 10:46:33 -0700
Subject: [R-sig-Geo] Array indices for very large multi-band images
In-Reply-To: <4BB1CEF500000553@cheetah-1.jrc.it>
References: <4BB1CEF500000553@cheetah-1.jrc.it>
Message-ID: <i2vdc22b2571004091046i4989a89bi3cfa18f7453f2dba@mail.gmail.com>

Guido,

Perhaps the function getValuesBlock in 'raster' makes this easier to do:

library(raster)
b <- brick(system.file("external/Rlogo.grd", package="raster"))
getValuesBlock(b, row=1, nrows=3, col=1, ncols=3)

Robert

On Fri, Apr 9, 2010 at 3:05 AM,  <guido.lemoine at jrc.ec.europa.eu> wrote:
> Dears,
>
> I just joined the list, so please bear with me if my problem
> has been dealt with already. I did an extensive google search,
> making sure r-gis-geo was included, so am sort of sure my
> problem is relevant.
>
> I have a (very) large 3 band ENVI file (32431 x 47262, 4.5 Gb,
> i.e. too big for normal GeoTIFF). I would like to generate
> statistics for 200 by 200 sized cells (including cross-correlation
> between bands).
> I am using the rgdal package, trying to use the array indexing
> syntax of R, running into trouble when trying to subset all
> 3 bands at the same time.
>
> Using array index syntax is useful, because it produces a
> SpatialGridDataFrame, which makes further processing easier.
>
> Here's my trial script:
>
> require(rgdal)
> x<-GDAL.open("verylarge3channelENVIimage")
> r <- getRasterData(x, offset = c(14000, 14000), region.dim = c(200, 200))
> str(r)
> # This works, but produces a simple integer array
> int [1:200, 1:200, 1:3] 0 0 0 0 0 0 0 0 0 0 ...
> # I'd rather do this
> sub0 <- x[14000:14199, 14000:14199,] ?# ... but doesn't work
> Error in x[14000:14199, 14000:14199, ] :
> ?argument is missing, with no default
> # this then?
> sub1 <- x[14000:14199, 14000:14199,1:3] # no, running into memory trouble
> Error: cannot allocate vector of size 2.3 Gb
> # per band works:
> sub2 <- x[14000:14199, 14000:14199,1] ?# produces a nice spatial object.
> summary(sub2)
> Object of class SpatialGridDataFrame
> ...
>
> Is there a way to get all 3 bands with array index syntax, preferably
> as a SpatialGridDataFrame with band1, band2, band3.
>
> Any help greatly appreciated,
>
> GL
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From eaeff at mtsu.edu  Fri Apr  9 20:59:28 2010
From: eaeff at mtsu.edu (E. Anthon Eff)
Date: Fri, 09 Apr 2010 13:59:28 -0500
Subject: [R-sig-Geo] Really fresh R-GRASS user.
In-Reply-To: <u2z5fd673781004090253x1b5bebcdo2045f36f303b0959@mail.gmail.com>
References: <u2z5fd673781004090253x1b5bebcdo2045f36f303b0959@mail.gmail.com>
Message-ID: <4BBF7910.9050007@mtsu.edu>

This book is still the best introduction to using R for spatial 
statistics: http://www.asdar-book.org/

Example code for using GRASS from within R is found on Tomislav Hengl's 
blog: http://spatial-analyst.net/wiki/index.php?title=Software

This search engine will usually find what you need: 
http://www.rseek.org/   (the "Support Lists" tab often returns 
especially helpful results)

--Anthon

joel dinis wrote:
> Hello to all,
>
> I'm a really new user in R and in R-GRASS interface,
> but not so new in geostatistics. I wonder if someone can
> indicate me a good starting tutorial. I've been googling
> about it but probably the experience users know best.
>
> Thank you
> JD
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   

-- 
E. Anthon Eff, Associate Professor
Dept. of Economics, Middle Tennessee State University
Box X050, Murfreesboro TN 37132
Phone: 615.898.2387
http://www.mtsu.edu/~eaeff/

Natura non facit saltum.


From Roger.Bivand at nhh.no  Fri Apr  9 21:19:15 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 9 Apr 2010 21:19:15 +0200 (CEST)
Subject: [R-sig-Geo] OSX and rgdal (32 bit Intel)
Message-ID: <alpine.LRH.2.00.1004092102050.17077@reclus.nhh.no>

A brief "heads up" for people using 32 bit R on OSX with an Intel 
processor:

Prof. Brian Ripley has built binary rgdal packages for R 2.10 and the 
shortly forthcoming 2.11, and published them on his CRAN extras 
repository. Feedback to me would be welcome on his installation 
instructions:

> setRepositories(ind=1:2)
> install.packages('rgdal')

where the first command includes both regular CRAN (for the sp dependency) 
and his CRAN extras repository. The OGR and GDAL drivers are as in the 
CRAN Windows 32-bit binary.

I am very grateful to him for his help with this, and I'm sure that 
feedback would be appreciated (to me, I'll summarise and pass it on to 
him). When we hear back from OSX users, I'll modify other OSX installation 
instructions to include this route as the main one, and the Kyngchaos 
frameworks as a more advanced alternative offering additional drivers.

I would particularly value feedback from GRASS users. I realise that 
because spgrass6 depends on rgdal, there is no OSX binary package on CRAN, 
but if there is enough interest, we may be able to find a resolution to 
that too. I realise that OSX GRASS users already probably have the 
Kyngchaos frameworks installed (because GRASS needs them), so it may well 
be that installing both rgdal and spgrass6 as source packages is the most 
practical solution. So feedback would be very helpful!

Roger

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From j.m.signer at gmail.com  Sat Apr 10 07:20:30 2010
From: j.m.signer at gmail.com (Johannes Signer)
Date: Sat, 10 Apr 2010 07:20:30 +0200
Subject: [R-sig-Geo] Really fresh R-GRASS user.
In-Reply-To: <u2z5fd673781004090253x1b5bebcdo2045f36f303b0959@mail.gmail.com>
References: <u2z5fd673781004090253x1b5bebcdo2045f36f303b0959@mail.gmail.com>
Message-ID: <i2paa7630001004092220n4c5c9050gb55805bfce973387@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100410/dc34d15c/attachment.pl>

From dinis.joel at gmail.com  Sat Apr 10 19:15:26 2010
From: dinis.joel at gmail.com (joel dinis)
Date: Sat, 10 Apr 2010 18:15:26 +0100
Subject: [R-sig-Geo] Really fresh R-GRASS user.
In-Reply-To: <i2paa7630001004092220n4c5c9050gb55805bfce973387@mail.gmail.com>
References: <u2z5fd673781004090253x1b5bebcdo2045f36f303b0959@mail.gmail.com>
	<i2paa7630001004092220n4c5c9050gb55805bfce973387@mail.gmail.com>
Message-ID: <y2q5fd673781004101015qd8c5a311wce7a1c7ca062deaa@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100410/bb79b886/attachment.pl>

From hobokener at gmail.com  Sat Apr 10 22:47:14 2010
From: hobokener at gmail.com (Christopher Cardinal)
Date: Sat, 10 Apr 2010 16:47:14 -0400
Subject: [R-sig-Geo] spgwr and selecting aic for bandwidth configuration
Message-ID: <x2zaf66389e1004101347o9c3763b5m392b50ef6c852103@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100410/086a47da/attachment.pl>

From jdownes at cida.ve  Sun Apr 11 06:57:30 2010
From: jdownes at cida.ve (Juan Jose Downes)
Date: Sun, 11 Apr 2010 00:27:30 -0430
Subject: [R-sig-Geo] Question - Efficient matrix element selection
In-Reply-To: <v2y9a8a6c631004081144x48c43c52q510479df7223c7c8@mail.gmail.com>
References: <t2q518dff331004081139v865ab8efo8702f5f12be69d80@mail.gmail.com>
	<v2y9a8a6c631004081144x48c43c52q510479df7223c7c8@mail.gmail.com>
Message-ID: <D5046707-AB6A-419A-81B8-BC2DF90AD7D8@cida.ve>

Dear all,

I am working in a code whose goal is the
selection of matrix rows according to their 
column values.

The problem is that the matrix I am working
with has 60 columns per 6.000.000 rows, so
I am looking for the most efficient way to
perform the selection.

Any hint about that?

Thanks in advance

Juan


From yong.li at unimelb.edu.au  Sun Apr 11 14:58:29 2010
From: yong.li at unimelb.edu.au (Yong Li)
Date: Sun, 11 Apr 2010 22:58:29 +1000
Subject: [R-sig-Geo] Carry out non-isotropic kriging
References: <mailman.5.1270807208.20893.r-sig-geo@stat.math.ethz.ch>
	<86DBA0678E017341B449A62F258E2956386D12@IS-EX-BEV3.unimelb.edu.au>
Message-ID: <86DBA0678E017341B449A62F258E2956386D13@IS-EX-BEV3.unimelb.edu.au>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100411/0a580ea2/attachment.pl>

From gianni.lavaredo at gmail.com  Mon Apr 12 13:47:44 2010
From: gianni.lavaredo at gmail.com (gianni lavaredo)
Date: Mon, 12 Apr 2010 13:47:44 +0200
Subject: [R-sig-Geo] Fill hole in a spatialdpolygon
Message-ID: <n2z518dff331004120447xa5dea360jeaa954588759cecc@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100412/fc227ca7/attachment.pl>

From dinis.joel at gmail.com  Mon Apr 12 17:19:14 2010
From: dinis.joel at gmail.com (joel dinis)
Date: Mon, 12 Apr 2010 16:19:14 +0100
Subject: [R-sig-Geo] caught segfault?!
Message-ID: <t2w5fd673781004120819j6113ae30n7c67a9da28f7b800@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100412/34513303/attachment.pl>

From Roger.Bivand at nhh.no  Mon Apr 12 18:26:22 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 12 Apr 2010 18:26:22 +0200 (CEST)
Subject: [R-sig-Geo] caught segfault?!
In-Reply-To: <t2w5fd673781004120819j6113ae30n7c67a9da28f7b800@mail.gmail.com>
References: <t2w5fd673781004120819j6113ae30n7c67a9da28f7b800@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1004121819260.31324@reclus.nhh.no>

On Mon, 12 Apr 2010, joel dinis wrote:

> Hello to all,
>
> I'm currently using R-GRASS GIS
> interface and I get an error when I'm trying
> to read a vector through readVECT6:
>
>> area <- readVECT6("area1")
>
> *** caught segfault ***
> address (nil), cause 'memory not mapped'

Which platform are you using?

Can you do v.out.ogr on area1, and try to recreate the error reading 
directly reading with readOGR?

Do you have the GRASS GDAL plugin installed (I believe that you do as the 
traceback (thanks for including it!) has layer="1"), and if so does 
running:

area <- readVECT6("area1", plugin=FALSE)

make a difference? If it makes a difference, there is a problem with the 
GRASS GDAL plugin. Please report back on this list, or the lower-volume 
statgrass list.

Hope this helps,

Roger

>
> Traceback:
> 1: .Call("ogrInfo", as.character(dsn), as.character(layer), PACKAGE =
> "rgdal")
> 2: ogrInfo(dsn = dsn, layer = layer, input_field_name_encoding =
> input_field_name_encoding)
> 3: readOGR(dsn, layer = "1", verbose = !ignore.stderr, pointDropZ =
> pointDropZ)
> 4: readVECT6("area1")
>
> Possible actions:
> 1: abort (with core dump, if enabled)
> 2: normal R exit
> 3: exit R without saving workspace
> 4: exit R saving workspace
> Selection: 1
> aborting ...
>
> Can anyone tell me why this happen,
> and how can I solve this?
>
> Thanks
> JD
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From dinis.joel at gmail.com  Mon Apr 12 18:41:29 2010
From: dinis.joel at gmail.com (joel dinis)
Date: Mon, 12 Apr 2010 17:41:29 +0100
Subject: [R-sig-Geo] caught segfault?!
In-Reply-To: <alpine.LRH.2.00.1004121819260.31324@reclus.nhh.no>
References: <t2w5fd673781004120819j6113ae30n7c67a9da28f7b800@mail.gmail.com>
	<alpine.LRH.2.00.1004121819260.31324@reclus.nhh.no>
Message-ID: <l2z5fd673781004120941g1ba3a986gc1706ec0a6a3853@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100412/ace5adf7/attachment.pl>

From Roger.Bivand at nhh.no  Mon Apr 12 18:48:01 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 12 Apr 2010 18:48:01 +0200 (CEST)
Subject: [R-sig-Geo] caught segfault?!
In-Reply-To: <l2z5fd673781004120941g1ba3a986gc1706ec0a6a3853@mail.gmail.com>
References: <t2w5fd673781004120819j6113ae30n7c67a9da28f7b800@mail.gmail.com>
	<alpine.LRH.2.00.1004121819260.31324@reclus.nhh.no>
	<l2z5fd673781004120941g1ba3a986gc1706ec0a6a3853@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1004121845030.31324@reclus.nhh.no>

On Mon, 12 Apr 2010, joel dinis wrote:

> Hello Roger,
>
> I did what you sugest, i.e.:
>
> area <- readVECT6("area1", plugin=FALSE)
>
> and it works just fine!

So something is broken in your GRASS/GDAL installation. If you determine 
what it is (report platform, OS, and how GDAL and GRASS were installed), 
please post on statgrass, where GRASS developers are also helpers.

Roger

>
> Thanks a lot
> JD
>
> On Mon, Apr 12, 2010 at 5:26 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> On Mon, 12 Apr 2010, joel dinis wrote:
>>
>>  Hello to all,
>>>
>>> I'm currently using R-GRASS GIS
>>> interface and I get an error when I'm trying
>>> to read a vector through readVECT6:
>>>
>>>  area <- readVECT6("area1")
>>>>
>>>
>>> *** caught segfault ***
>>> address (nil), cause 'memory not mapped'
>>>
>>
>> Which platform are you using?
>>
>> Can you do v.out.ogr on area1, and try to recreate the error reading
>> directly reading with readOGR?
>>
>> Do you have the GRASS GDAL plugin installed (I believe that you do as the
>> traceback (thanks for including it!) has layer="1"), and if so does running:
>>
>> area <- readVECT6("area1", plugin=FALSE)
>>
>> make a difference? If it makes a difference, there is a problem with the
>> GRASS GDAL plugin. Please report back on this list, or the lower-volume
>> statgrass list.
>>
>> Hope this helps,
>>
>> Roger
>>
>>
>>> Traceback:
>>> 1: .Call("ogrInfo", as.character(dsn), as.character(layer), PACKAGE =
>>> "rgdal")
>>> 2: ogrInfo(dsn = dsn, layer = layer, input_field_name_encoding =
>>> input_field_name_encoding)
>>> 3: readOGR(dsn, layer = "1", verbose = !ignore.stderr, pointDropZ =
>>> pointDropZ)
>>> 4: readVECT6("area1")
>>>
>>> Possible actions:
>>> 1: abort (with core dump, if enabled)
>>> 2: normal R exit
>>> 3: exit R without saving workspace
>>> 4: exit R saving workspace
>>> Selection: 1
>>> aborting ...
>>>
>>> Can anyone tell me why this happen,
>>> and how can I solve this?
>>>
>>> Thanks
>>> JD
>>>
>>>        [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>> --
>> Roger Bivand
>> Economic Geography Section, Department of Economics, Norwegian School of
>> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From german.sanchez at ais-int.com  Mon Apr 12 18:59:19 2010
From: german.sanchez at ais-int.com (=?iso-8859-1?Q?Germ=E1n_S=E1nchez_Hern=E1ndez?=)
Date: Mon, 12 Apr 2010 18:59:19 +0200
Subject: [R-sig-Geo] Shape to DB, DB to SpatialPolygon
In-Reply-To: <r2t94b3c8441004080417o5a080b77u3cbc7bebc7b6df5c@mail.gmail.com>
References: <52383.10.10.2.41.1270722081.squirrel@hermes.ais-int.net>
	<r2t94b3c8441004080417o5a080b77u3cbc7bebc7b6df5c@mail.gmail.com>
Message-ID: <AE1B56AF-35F3-4E48-8C0D-9EB654260625@ais-int.com>

Hi Carson (and list!),

I have corretly installed rgdal package in R (with some initial problems but finally working).

If I run ogrDrivers() no driver for PostgreSQL is listed (remember that the postgresql database is correctly running with the PostGIS extension, and I can connect through RODBC package):

> ogrDrivers()
             name write
1          AVCBin FALSE
2          AVCE00 FALSE
3             BNA  TRUE
4             CSV  TRUE
5             DGN  TRUE
6             DXF  TRUE
7  ESRI Shapefile  TRUE
8      Geoconcept  TRUE
9         GeoJSON  TRUE
10         GeoRSS  TRUE
11            GML  TRUE
12            GMT  TRUE
13  GPSTrackMaker  TRUE
14            GPX  TRUE
15            KML  TRUE
16   MapInfo File  TRUE
17         Memory  TRUE
18         PCIDSK FALSE
19            REC FALSE
20            S57  TRUE
21           SDTS FALSE
22         SQLite  TRUE
23          TIGER  TRUE
24        UK .NTF FALSE
25            VFK FALSE
26            VRT FALSE
27         XPlane FALSE

What am I missing?

Thank you!
Germ?n S?nchez
german.sanchez at esade.edu

El 08/04/2010, a las 13:17, Carson Farmer escribi?:

> Hi Germ?n,
> 
> Have a look at package rgdal and the readOGR function.
> 
>> library(rgdal)
>> ?readOGR
> 
> Here is a link with a quick bit on using rgdal to access a postgis table:
> http://wiki.intamap.org/index.php/PostGIS
> 
> Regards,
> 
> Carson
> 
> On Thu, Apr 8, 2010 at 11:21 AM, Germ?n S?nchez
> <german.sanchez at ais-int.com> wrote:
>> Dear all,
>> 
>> I've working with spatial data since only a few months. I know how to
>> handle this kind of data in R using the sp package. I know how to load
>> shapes, plot them, merge their polygons, plotting labels, etc.
>> 
>> I have installed a postgis database and I can connect to it from R via
>> RODBC without problems. I can load a shape file (.shp and so) into the
>> database (command shp2pgsql  to create the needed .sql). It creates a
>> table with some usual fields (area, perimeter, district, etc) and the
>> special one: the_geom.
>> 
>> Now, I want to load this data to a SpatialPolygon (or
>> SpatialPolygonDataFrame) object using the RODBC driver. I would like to
>> get the same object as if I have used the "readShapePoly" function from sp
>> package directly over the .shp file.
>> 
>> Any idea? Is there a direct solution or I have to build the polygon myself?
>> 
>> Thank you,
>> Germ?n S?nchez
>> german.sanchez at esade.edu
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
> 
> 
> 
> -- 
> Carson J. Q. Farmer
> ISSP Doctoral Fellow
> National Centre for Geocomputation
> National University of Ireland, Maynooth,
> http://www.carsonfarmer.com/


From Roger.Bivand at nhh.no  Mon Apr 12 19:14:45 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 12 Apr 2010 19:14:45 +0200 (CEST)
Subject: [R-sig-Geo] Shape to DB, DB to SpatialPolygon
In-Reply-To: <AE1B56AF-35F3-4E48-8C0D-9EB654260625@ais-int.com>
References: <52383.10.10.2.41.1270722081.squirrel@hermes.ais-int.net>
	<r2t94b3c8441004080417o5a080b77u3cbc7bebc7b6df5c@mail.gmail.com>
	<AE1B56AF-35F3-4E48-8C0D-9EB654260625@ais-int.com>
Message-ID: <alpine.LRH.2.00.1004121905130.31324@reclus.nhh.no>

On Mon, 12 Apr 2010, Germ?n S?nchez Hern?ndez wrote:

> Hi Carson (and list!),
>
> I have corretly installed rgdal package in R (with some initial problems 
> but finally working).
>
> If I run ogrDrivers() no driver for PostgreSQL is listed (remember that 
> the postgresql database is correctly running with the PostGIS extension, 
> and I can connect through RODBC package):

The OGR driver will only be present if you have built OGR with PostGIS 
enabled. If you use the CRAN Windows 32-bit binary, or the CRAN extras OSX 
32-bit or Windows 64-bit binaries, the driver is not included. To use 
PostGIS with OGR, install GDAL with PostGIS enabled, and check with:

$ ogrinfo --formats

Until you see PostGIS/PostgreSQL there, you will not see it inside R 
either, having installed rgdal from source. Using PostGIS effectively 
presupposes that you have some experience in installing software from 
source, and that your platform has the necessary build trains; these kinds 
of things rarely work "out of the box". The rgdal package as a binary has 
most commonly used drivers, and more will not be added, because they 
depend on libraries/DLLs external to GDAL/OGR.

Roger

>
>> ogrDrivers()
>             name write
> 1          AVCBin FALSE
> 2          AVCE00 FALSE
> 3             BNA  TRUE
> 4             CSV  TRUE
> 5             DGN  TRUE
> 6             DXF  TRUE
> 7  ESRI Shapefile  TRUE
> 8      Geoconcept  TRUE
> 9         GeoJSON  TRUE
> 10         GeoRSS  TRUE
> 11            GML  TRUE
> 12            GMT  TRUE
> 13  GPSTrackMaker  TRUE
> 14            GPX  TRUE
> 15            KML  TRUE
> 16   MapInfo File  TRUE
> 17         Memory  TRUE
> 18         PCIDSK FALSE
> 19            REC FALSE
> 20            S57  TRUE
> 21           SDTS FALSE
> 22         SQLite  TRUE
> 23          TIGER  TRUE
> 24        UK .NTF FALSE
> 25            VFK FALSE
> 26            VRT FALSE
> 27         XPlane FALSE
>
> What am I missing?
>
> Thank you!
> Germ?n S?nchez
> german.sanchez at esade.edu
>
> El 08/04/2010, a las 13:17, Carson Farmer escribi?:
>
>> Hi Germ?n,
>>
>> Have a look at package rgdal and the readOGR function.
>>
>>> library(rgdal)
>>> ?readOGR
>>
>> Here is a link with a quick bit on using rgdal to access a postgis table:
>> http://wiki.intamap.org/index.php/PostGIS
>>
>> Regards,
>>
>> Carson
>>
>> On Thu, Apr 8, 2010 at 11:21 AM, Germ?n S?nchez
>> <german.sanchez at ais-int.com> wrote:
>>> Dear all,
>>>
>>> I've working with spatial data since only a few months. I know how to
>>> handle this kind of data in R using the sp package. I know how to load
>>> shapes, plot them, merge their polygons, plotting labels, etc.
>>>
>>> I have installed a postgis database and I can connect to it from R via
>>> RODBC without problems. I can load a shape file (.shp and so) into the
>>> database (command shp2pgsql  to create the needed .sql). It creates a
>>> table with some usual fields (area, perimeter, district, etc) and the
>>> special one: the_geom.
>>>
>>> Now, I want to load this data to a SpatialPolygon (or
>>> SpatialPolygonDataFrame) object using the RODBC driver. I would like to
>>> get the same object as if I have used the "readShapePoly" function from sp
>>> package directly over the .shp file.
>>>
>>> Any idea? Is there a direct solution or I have to build the polygon myself?
>>>
>>> Thank you,
>>> Germ?n S?nchez
>>> german.sanchez at esade.edu
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>>
>>
>> --
>> Carson J. Q. Farmer
>> ISSP Doctoral Fellow
>> National Centre for Geocomputation
>> National University of Ireland, Maynooth,
>> http://www.carsonfarmer.com/
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From mudrak at wisc.edu  Mon Apr 12 19:29:20 2010
From: mudrak at wisc.edu (Erika Mudrak)
Date: Mon, 12 Apr 2010 12:29:20 -0500
Subject: [R-sig-Geo] spatstat: test plant growth patterns against
 environmental covariate? - kstest
Message-ID: <7410ea9b7b6d.4bc31220@wiscmail.wisc.edu>



I have a point pattern data set (SPECIES.ppp) of stem locations for a species, and I want to see if they depend on several Environmental variables such as light and soil properties (working one at a time, for now, generally named Envir, of class im, which was obtained using IDW of sample locations evenly distributed throughout the study region).  I realize that since I'm working on the assumption that my variables are continuously varying, I should use KS-tests rather than X-squared quadrat-based tests. 

I would like to use the KS test as outlined in the spatstat notes, but I am confused about the difference in null models for the below tests:

1)
KS=kstest(X=SPECIES.ppp,covariate=Envir)	#Using ppp and covariate
2)
fit=ppm(SPECIES.ppp,~E  , covariates=list(E=Envir))
KSfit=kstest(model=fit,covariate=Envir)         # Using ppm and covariate

I get slightly different results (though both p-values are very low).

Thank you!
Erika

-- 
-------------------------------------------
Erika Mudrak
Graduate Student
Department of Botany
University of Wisconsin-Madison
430 Lincoln Dr
Madison WI, 53706
608-265-2191
mudrak at wisc.edu
http://botany.wisc.edu/waller/lab/Mudrak/


From nikhil.list at gmail.com  Mon Apr 12 21:27:41 2010
From: nikhil.list at gmail.com (nikhil kaza)
Date: Mon, 12 Apr 2010 15:27:41 -0400
Subject: [R-sig-Geo] spdep and rgdal
Message-ID: <k2h642b93e21004121227ze708a77ct9c987a618ddc1f4f@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100412/91ce77b1/attachment.pl>

From Roger.Bivand at nhh.no  Mon Apr 12 21:43:18 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 12 Apr 2010 21:43:18 +0200 (CEST)
Subject: [R-sig-Geo] spdep and rgdal
In-Reply-To: <k2h642b93e21004121227ze708a77ct9c987a618ddc1f4f@mail.gmail.com>
References: <k2h642b93e21004121227ze708a77ct9c987a618ddc1f4f@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1004122135110.31324@reclus.nhh.no>

On Mon, 12 Apr 2010, nikhil kaza wrote:

> I am using theR -2.11 prerelase on windows 7 x64. I want to bring to
> attention couple of issues to the list in case they have not been reported.
> I understand that the R version is unstable, nevertheless here it is.

Excellent report, thanks very much! This kind of feedback really helps 
push development forward!

Please try the most recent R beta for Windows 64-bit version. It may be 
that the methods issue has been resolved there. If the problem persists, 
please post on R-devel, where your report will reach the people with most 
experience on internal issues.

With regard to spdep, if spam is the only problem, I can change it to 
suggested and condition on it for those needing method="spam" in model 
fitting until it becomes available.

Roger

>
>> library(rgdal)
> --
> Error in registerS3method(Info[i, 1], Info[i, 2], Info[i, 3], env) :
>  trying to get slot "methods" from an object of a basic class ("NULL") with
> no slots
> Error: package/namespace load failed for 'rgdal'
> ---
>
> spdep requires spam package which is not yet available for this windows and
> so cannot be loaded. The package maintainer (Reinhard  Furrer) is aware of
> the issue and is working on it.
>
> Any work arounds?
>
> Many thanks.
>
> regards
> Nikhil
>
>
> ---
> R version 2.11.0 Under development (unstable) (2010-03-24 r51389)
> x86_64-pc-mingw64
>
> locale:
> [1] LC_COLLATE=English_United States.1252
> [2] LC_CTYPE=English_United States.1252
> [3] LC_MONETARY=English_United States.1252
> [4] LC_NUMERIC=C
> [5] LC_TIME=English_United States.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From isabella at ghement.ca  Mon Apr 12 23:20:12 2010
From: isabella at ghement.ca (Isabella Ghement)
Date: Mon, 12 Apr 2010 14:20:12 -0700
Subject: [R-sig-Geo] Array to GeoTiff
Message-ID: <CEEDLPBNOCMDHIGPLIJLMELJCIAA.isabella@ghement.ca>

Hi everyone,

I need to create a multi-band GeoTiff file from a 3-dimensional R array
whose 3rd dimension is
used to represent bands.  Can anyone let me know how to best proceed?

I played around with writeRGDAL but was unable to figure out how to
manipulate the array
in order to get writeRGDAL to recognize it.

Any ideas would be greatly appreciated.

Sincerely,

Isabella

Isabella R. Ghement, Ph.D.
Ghement Statistical Consulting Company
301-7031 Blundell Road, Richmond, B.C., Canada, V6Y 1J5
Tel: 604-767-1250
Fax: 604-270-3922
E-mail: isabella at ghement.ca
Web: www.ghement.ca


From nikhil.list at gmail.com  Tue Apr 13 04:24:35 2010
From: nikhil.list at gmail.com (Nikhil Kaza)
Date: Mon, 12 Apr 2010 22:24:35 -0400
Subject: [R-sig-Geo] spdep and rgdal
In-Reply-To: <alpine.LRH.2.00.1004122135110.31324@reclus.nhh.no>
References: <k2h642b93e21004121227ze708a77ct9c987a618ddc1f4f@mail.gmail.com>
	<alpine.LRH.2.00.1004122135110.31324@reclus.nhh.no>
Message-ID: <D5CE7A1A-C859-49E3-ADF7-B37DF7C92093@gmail.com>

Roger,

Happy to report that methods issue is resolved in the R 2.11 beta  
version.

spam is still an issue but I presume once Reinhard fixes it by Apr 22,  
it should be fine.

Thanks
Nikhil


On Apr 12, 2010, at 3:43 PM, Roger Bivand wrote:

> On Mon, 12 Apr 2010, nikhil kaza wrote:
>
>> I am using theR -2.11 prerelase on windows 7 x64. I want to bring to
>> attention couple of issues to the list in case they have not been  
>> reported.
>> I understand that the R version is unstable, nevertheless here it is.
>
> Excellent report, thanks very much! This kind of feedback really  
> helps push development forward!
>
> Please try the most recent R beta for Windows 64-bit version. It may  
> be that the methods issue has been resolved there. If the problem  
> persists, please post on R-devel, where your report will reach the  
> people with most experience on internal issues.
>
> With regard to spdep, if spam is the only problem, I can change it  
> to suggested and condition on it for those needing method="spam" in  
> model fitting until it becomes available.
>
> Roger
>
>>
>>> library(rgdal)
>> --
>> Error in registerS3method(Info[i, 1], Info[i, 2], Info[i, 3], env) :
>> trying to get slot "methods" from an object of a basic class  
>> ("NULL") with
>> no slots
>> Error: package/namespace load failed for 'rgdal'
>> ---
>>
>> spdep requires spam package which is not yet available for this  
>> windows and
>> so cannot be loaded. The package maintainer (Reinhard  Furrer) is  
>> aware of
>> the issue and is working on it.
>>
>> Any work arounds?
>>
>> Many thanks.
>>
>> regards
>> Nikhil
>>
>>
>> ---
>> R version 2.11.0 Under development (unstable) (2010-03-24 r51389)
>> x86_64-pc-mingw64
>>
>> locale:
>> [1] LC_COLLATE=English_United States.1252
>> [2] LC_CTYPE=English_United States.1252
>> [3] LC_MONETARY=English_United States.1252
>> [4] LC_NUMERIC=C
>> [5] LC_TIME=English_United States.1252
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> 	[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> -- 
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian  
> School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>


From edzer.pebesma at uni-muenster.de  Tue Apr 13 08:28:23 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 13 Apr 2010 08:28:23 +0200
Subject: [R-sig-Geo] Array to GeoTiff
In-Reply-To: <CEEDLPBNOCMDHIGPLIJLMELJCIAA.isabella@ghement.ca>
References: <CEEDLPBNOCMDHIGPLIJLMELJCIAA.isabella@ghement.ca>
Message-ID: <4BC40F07.907@uni-muenster.de>

Hi Isabella,

you haven't told us how exactly your data are organized, what the first
two dimensions mean, and whether e.g. an increase in the second
dimension relates to x (long) or y (lat), and whether increase in the y
index means going north or south. This all matters. Below is a quick
example that only works, but may be not useful for your particular data
setup.

nr = nc = 100; nb = 3
x = array(runif(nr*nc*3) * 255, c(nc,nr,nb))
summary(data.frame(apply(x, 3, as.vector)))
df = data.frame(apply(x, 3, as.vector))
gt = GridTopology(c(0,0), c(1,1), c(nc,nr))
sgdf = SpatialGridDataFrame(gt, data.frame(apply(x, 3, as.vector)))
library(rgdal)
writeGDAL(sgdf, "out.tif", "GTiff")

GridTopology defines the topology of a geographic grid: the offset, cell
size and dimensions of the grid. To the function SpatialGridDataFrame
you can further more pass information about the coordinate reference
system, so that the GeoTiff could be related to some place on the earth,
and could be handled sensibly by a GIS.

Hth,
--
Edzer

Isabella Ghement wrote:
> Hi everyone,
> 
> I need to create a multi-band GeoTiff file from a 3-dimensional R array
> whose 3rd dimension is
> used to represent bands.  Can anyone let me know how to best proceed?
> 
> I played around with writeRGDAL but was unable to figure out how to
> manipulate the array
> in order to get writeRGDAL to recognize it.
> 
> Any ideas would be greatly appreciated.
> 
> Sincerely,
> 
> Isabella
> 
> Isabella R. Ghement, Ph.D.
> Ghement Statistical Consulting Company
> 301-7031 Blundell Road, Richmond, B.C., Canada, V6Y 1J5
> Tel: 604-767-1250
> Fax: 604-270-3922
> E-mail: isabella at ghement.ca
> Web: www.ghement.ca
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From edzer.pebesma at uni-muenster.de  Tue Apr 13 08:57:34 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 13 Apr 2010 08:57:34 +0200
Subject: [R-sig-Geo] Array indices for very large multi-band images
In-Reply-To: <i2vdc22b2571004091046i4989a89bi3cfa18f7453f2dba@mail.gmail.com>
References: <4BB1CEF500000553@cheetah-1.jrc.it>
	<i2vdc22b2571004091046i4989a89bi3cfa18f7453f2dba@mail.gmail.com>
Message-ID: <4BC415DE.2030008@uni-muenster.de>

Over the weekend I corrected the bug in rgdal that caused the following
error in Guido's email:

sub1 <- x[14000:14199, 14000:14199,1:3]
> Error: cannot allocate vector of size 2.3 Gb

in rgdal 0.6-26 this should be resolved, and only require the amount of
memory needed for the small selection. Sources are committed to
http://sourceforge.net/projects/rgdal/

It might take some time before this new gdal version reaches CRAN, as
rgdal is trying to hit the win64 and mac-osx walls, which is also not
insignificant.
--
Edzer


Robert J. Hijmans wrote:
> Guido,
> 
> Perhaps the function getValuesBlock in 'raster' makes this easier to do:
> 
> library(raster)
> b <- brick(system.file("external/Rlogo.grd", package="raster"))
> getValuesBlock(b, row=1, nrows=3, col=1, ncols=3)
> 
> Robert
> 
> On Fri, Apr 9, 2010 at 3:05 AM,  <guido.lemoine at jrc.ec.europa.eu> wrote:
>> Dears,
>>
>> I just joined the list, so please bear with me if my problem
>> has been dealt with already. I did an extensive google search,
>> making sure r-gis-geo was included, so am sort of sure my
>> problem is relevant.
>>
>> I have a (very) large 3 band ENVI file (32431 x 47262, 4.5 Gb,
>> i.e. too big for normal GeoTIFF). I would like to generate
>> statistics for 200 by 200 sized cells (including cross-correlation
>> between bands).
>> I am using the rgdal package, trying to use the array indexing
>> syntax of R, running into trouble when trying to subset all
>> 3 bands at the same time.
>>
>> Using array index syntax is useful, because it produces a
>> SpatialGridDataFrame, which makes further processing easier.
>>
>> Here's my trial script:
>>
>> require(rgdal)
>> x<-GDAL.open("verylarge3channelENVIimage")
>> r <- getRasterData(x, offset = c(14000, 14000), region.dim = c(200, 200))
>> str(r)
>> # This works, but produces a simple integer array
>> int [1:200, 1:200, 1:3] 0 0 0 0 0 0 0 0 0 0 ...
>> # I'd rather do this
>> sub0 <- x[14000:14199, 14000:14199,]  # ... but doesn't work
>> Error in x[14000:14199, 14000:14199, ] :
>>  argument is missing, with no default
>> # this then?
>> sub1 <- x[14000:14199, 14000:14199,1:3] # no, running into memory trouble
>> Error: cannot allocate vector of size 2.3 Gb
>> # per band works:
>> sub2 <- x[14000:14199, 14000:14199,1]  # produces a nice spatial object.
>> summary(sub2)
>> Object of class SpatialGridDataFrame
>> ...
>>
>> Is there a way to get all 3 bands with array index syntax, preferably
>> as a SpatialGridDataFrame with band1, band2, band3.
>>
>> Any help greatly appreciated,
>>
>> GL
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From dinis.joel at gmail.com  Tue Apr 13 13:35:42 2010
From: dinis.joel at gmail.com (joel dinis)
Date: Tue, 13 Apr 2010 12:35:42 +0100
Subject: [R-sig-Geo] Classify images via spgrass6??
Message-ID: <p2q5fd673781004130435p32d287c6z46a9fa4b7eb1c57d@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100413/e5b523ff/attachment.pl>

From roman.lustrik at gmail.com  Tue Apr 13 13:45:32 2010
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Tue, 13 Apr 2010 13:45:32 +0200
Subject: [R-sig-Geo] trying to add points to a raster
Message-ID: <j2p63a206011004130445w8d32c5d2ge3082446f4044d3d@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100413/79dd30d6/attachment.pl>

From sharonb_m at yahoo.com  Tue Apr 13 16:16:18 2010
From: sharonb_m at yahoo.com (Sharon Baruch-Mordo)
Date: Tue, 13 Apr 2010 07:16:18 -0700 (PDT)
Subject: [R-sig-Geo] Obtaining 3d surface area using polygon layer and DEM
	grid
Message-ID: <655987.28461.qm@web43139.mail.sp1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100413/4162feb4/attachment.pl>

From gianni.lavaredo at gmail.com  Tue Apr 13 16:57:14 2010
From: gianni.lavaredo at gmail.com (gianni lavaredo)
Date: Tue, 13 Apr 2010 16:57:14 +0200
Subject: [R-sig-Geo] Suggestion to build a Special Filter for a Raster
	classification
Message-ID: <j2s518dff331004130757nfc1c976av1cc70d2fda4cd9df@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100413/c8070e5e/attachment.pl>

From r.hijmans at gmail.com  Tue Apr 13 18:37:55 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 13 Apr 2010 09:37:55 -0700
Subject: [R-sig-Geo] trying to add points to a raster
In-Reply-To: <j2p63a206011004130445w8d32c5d2ge3082446f4044d3d@mail.gmail.com>
References: <j2p63a206011004130445w8d32c5d2ge3082446f4044d3d@mail.gmail.com>
Message-ID: <v2ydc22b2571004130937ne7c1aa4erd5397eb80aa78b09@mail.gmail.com>

Hi Roman,

The RasterLayer rst.p is correct, I think. The problem has only to do
with the plotting. The error/warning occurs because you have (a) a
relatively large RasterLayer and (b) hardly any cells have values.
Large RasterLayers are sampled (regularly) for plotting. In this case,
none of the sampled cells get a value.  You can stop this from
happening by adding a maxpixels argument to plot:

plot(rst.p, maxpixels=ncell(rst.p))

Not that it helps much; I was not able to see the difference because
there are so few cells with values (and they are still resampled to
match the screen resolution).

For visualization (only) you could make a coarser grid:

res(rst) = 10
rst.p <- pointsToRaster(raster = rst,  xy = r,   values = r at data$walker)
plot(rst.p)

Note that the default function 'fun' is length (ie. count the number
of points per cell). As you provide a 'values' argument, I assume you
want something else. To transfer the value (of the last point that is
found for a cell) you can use

rst.p <- pointsToRaster(raster = rst,  xy = r,   values =
r at data$walker,  fun=function(x){x} )

# the mean would be fun=mean, but as 'walker'  is a factor:
rst.p <- pointsToRaster(raster = rst,  xy = r,   values =
r at data$walker,  fun=function(x){mean(as.numeric(x)) } )


I am sorry for your head.

Best,
Robert

# This is the command I use to add points but for some reason, the
# values are not added (strictly speaking, only one value is added).
# Can someone point out what I'm doing wrong?
rst.p <- pointsToRaster(raster = rst,
       xy = r,
       values = r at data$walker)
rst.p



> rst.p <- pointsToRaster(raster = rst2,
+        xy = r,
+        values = r at data$walker)
> plot(rst.p)
> ?plot



On Tue, Apr 13, 2010 at 4:45 AM, Roman Lu?trik <roman.lustrik at gmail.com> wrote:
> # Dear list,
> #
> # I'm apologizing in advance if my question is rather basic, but I've
> # been banging my head against the wall over this all day and the
> # seismology department has already contacted me to stop it.
> #
> # I'm trying to add points (SpatialPointsDataFrame object r) to a
> # raster object (rst).
>
> library(raster)
> library(sp)
>
> # object with points I'm trying to add
>
> r <- new("SpatialPointsDataFrame"
> ? ? ? ?, data = structure(list(walker = structure(c(3L, 3L, 3L, 3L, 3L,
> 12L,
> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?12L, 12L, 12L, 12L, 19L, 19L, 19L,
> 19L, 19L, 20L, 20L, 20L, 20L,
> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?20L), .Label = c("1", "2", "3", "4",
> "5", "6", "7", "8", "9",
> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?"10", "11", "12", "13", "14", "15",
> "16", "17", "18", "19", "20"
> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?), class = "factor")), .Names = "walker",
> class = "data.frame", row.names = c(212L,
> ? ? ? ? ? ? ? ? ? ? ? ?216L, 232L, 294L, 279L, 1134L, 1124L, 1173L, 1195L,
> 1123L, 1877L,
> ? ? ? ? ? ? ? ? ? ? ? ?1819L, 1810L, 1802L, 1899L, 1918L, 1965L, 1977L,
> 1952L, 1915L
> ? ? ? ? ? ? ? ?))
> ? ? ? ?, coords.nrs = 2:3
> ? ? ? ?, coords = structure(c(-23.2432695470495, -42.8570787452707,
> -25.9987883825460,
> ? ? ? ? ? ? ? ? ? ? ? ?-64.2282194183847, 15.9572133404169,
> 841.345031514424, 846.560380022882,
> ? ? ? ? ? ? ? ? ? ? ? ?858.356702340203, 829.290173246473,
> 855.204942248044, -153.570529391965,
> ? ? ? ? ? ? ? ? ? ? ? ?-222.615649663872, -189.494697286148,
> -150.755239868264, -172.405589596216,
> ? ? ? ? ? ? ? ? ? ? ? ?700.62999593643, 714.319660569588, 769.937984828572,
> 721.180459026309,
> ? ? ? ? ? ? ? ? ? ? ? ?688.932274938503, 118.294179820811,
> 114.236959667182, 141.137206092922,
> ? ? ? ? ? ? ? ? ? ? ? ?55.7030239659073, 136.785318376395,
> 707.681240819362, 691.95292905712,
> ? ? ? ? ? ? ? ? ? ? ? ?595.302752910708, 590.191085932507,
> 671.318331940053, -545.390752528143,
> ? ? ? ? ? ? ? ? ? ? ? ?-593.352201166765, -582.711927913932,
> -577.494929150682, -579.851251631267,
> ? ? ? ? ? ? ? ? ? ? ? ?-169.417426401479, -199.140015976785,
> -195.301934322738, -130.762717546069,
> ? ? ? ? ? ? ? ? ? ? ? ?-126.873035982826), .Dim = c(20L, 2L), .Dimnames =
> list(NULL,
> ? ? ? ? ? ? ? ? ? ? ? ?c("x", "y")))
> ? ? ? ?, bbox = structure(c(-222.615649663872, -593.352201166765,
> 858.356702340203,
> ? ? ? ? ? ? ? ? ? ? ? ?707.681240819362), .Dim = c(2L, 2L), .Dimnames =
> list(c("x",
> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?"y"), c("min", "max")))
> ? ? ? ?, proj4string = new("CRS"
> ? ? ? ? ? ? ? ?, projargs = NA_character_
> ? ? ? ?)
> )
>
> # This is the raster object used as a recipient
>
> rst <- raster(nrow = 2000, ncol = 2000, xmn = -1000, xmx = 1000, ymn =
> -1000, ymx = 1000)
>
> # This is the command I use to add points but for some reason, the
> # values are not added (strictly speaking, only one value is added).
> # Can someone point out what I'm doing wrong?
> rst.p <- pointsToRaster(raster = rst,
> ? ? ? ?xy = r,
> ? ? ? ?values = r at data$walker)
> rst.p
>
> # plot(rst.p)
> # Error in if (del == 0 && to == 0) return(to) :
> # ? missing value where TRUE/FALSE needed
> # In addition: Warning messages:
> # 1: In min(x) : no non-missing arguments to min; returning Inf
> # 2: In max(x) : no non-missing arguments to max; returning -Inf
> # 3: In min(x) : no non-missing arguments to min; returning Inf
> # 4: In max(x) : no non-missing arguments to max; returning -Inf
>
>
> # Cheers,
> # Roman
>
>
>
> --
> In God we trust, all others bring data.
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From jacobvanetten at yahoo.com  Tue Apr 13 18:37:38 2010
From: jacobvanetten at yahoo.com (Jacob van Etten)
Date: Tue, 13 Apr 2010 09:37:38 -0700 (PDT)
Subject: [R-sig-Geo] Suggestion to build a Special Filter for a Raster
	classification
In-Reply-To: <j2s518dff331004130757nfc1c976av1cc70d2fda4cd9df@mail.gmail.com>
Message-ID: <635812.76561.qm@web32903.mail.mud.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100413/4171909e/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Tue Apr 13 18:46:32 2010
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Tue, 13 Apr 2010 17:46:32 +0100
Subject: [R-sig-Geo] Obtaining 3d surface area using polygon layer and
	DEM grid
In-Reply-To: <655987.28461.qm@web43139.mail.sp1.yahoo.com>
References: <655987.28461.qm@web43139.mail.sp1.yahoo.com>
Message-ID: <q2sd8ad40b51004130946v2479114lb5de9d0d163fac9f@mail.gmail.com>

On Tue, Apr 13, 2010 at 3:16 PM, Sharon Baruch-Mordo
<sharonb_m at yahoo.com> wrote:
> Hello list,
>
> Is there anyway to calculate in R?the 3D surface of a polygon spatial object using a DEM grid similar to the ArcView tool developed by Jenness (2004; http://www.jennessent.com/arcview/surface_tools.htm)?

 Any way?  Well yes, but that way may mean you implementing the
algorithm described in the paper. It looks quite simple, and probably
best written in C for speed. A pure R implementation might be very
slow for large DEMs.

 I don't know of any R implementation of a surface area algorithm for
R at the moment.

Barry


From Thomas.Adams at noaa.gov  Tue Apr 13 21:43:34 2010
From: Thomas.Adams at noaa.gov (Thomas Adams)
Date: Tue, 13 Apr 2010 15:43:34 -0400
Subject: [R-sig-Geo] Help needed with spplot
Message-ID: <4BC4C966.9030608@noaa.gov>

All:

I'm using GRASS 6.4 with R 2.9.2 and sp/spgrass6. When plotting a vector 
file, read in from GRASS, using spplot, the drawing takes many minutes 
to complete. Apart from the fact that the vector file is probably more 
detailed than I need, I know time is spent drawing off-screen. I tried 
specifying xlim & ylim, but, of course, this just zooms into the area 
I'm mapping, and does not solve my underlying problem.

I also tried using pruneMap(), but this did not seem to make any 
difference in the length of time before my R prompt returned. By 
contrast, GRASS re-draws very fast, within a few seconds instead of ~5 
minutes. I want to use spplot to draw an array of maps (21), so 1+ hours 
will not work for what I am doing.

Any thoughts how I might speed-up the process?

Regards,
Tom

-- 
Thomas E Adams
National Weather Service
Ohio River Forecast Center
1901 South State Route 134
Wilmington, OH 45177

EMAIL:	thomas.adams at noaa.gov

VOICE:	937-383-0528
FAX:	937-383-0033


From debeaudette at ucdavis.edu  Tue Apr 13 22:03:59 2010
From: debeaudette at ucdavis.edu (Dylan Beaudette)
Date: Tue, 13 Apr 2010 13:03:59 -0700
Subject: [R-sig-Geo] Help needed with spplot
In-Reply-To: <4BC4C966.9030608@noaa.gov>
References: <4BC4C966.9030608@noaa.gov>
Message-ID: <201004131303.59881.dylan.beaudette@gmail.com>

On Tuesday 13 April 2010, Thomas Adams wrote:
> All:
>
> I'm using GRASS 6.4 with R 2.9.2 and sp/spgrass6. When plotting a vector
> file, read in from GRASS, using spplot, the drawing takes many minutes
> to complete. Apart from the fact that the vector file is probably more
> detailed than I need, I know time is spent drawing off-screen. I tried
> specifying xlim & ylim, but, of course, this just zooms into the area
> I'm mapping, and does not solve my underlying problem.
>
> I also tried using pruneMap(), but this did not seem to make any
> difference in the length of time before my R prompt returned. By
> contrast, GRASS re-draws very fast, within a few seconds instead of ~5
> minutes. I want to use spplot to draw an array of maps (21), so 1+ hours
> will not work for what I am doing.
>
> Any thoughts how I might speed-up the process?
>
> Regards,
> Tom

Hi Tom,

What kind of vector data are you plotting? Probably not points. If you are 
working with very detailed lines or polygons, I would suggest simplifying 
them in GRASS first. In GRASS 6.4, v.clean is the module of choice. If you 
can get GRASS 6.5, then v.generalize will work even better. Note that you 
need to work on boundaries with v.generalize, and too much "pruning" will 
result in broken topology.

I recently used an incantation like this:
v.generalize in=ca_counties out=ca_counties_simple type=boundary  
method=douglas_reduction threshold=1000

... to reduce the number of vertices in a map of CA counties, so that I could 
plot it with spplot().

Cheers,
Dylan

-- 
Dylan Beaudette
Soil Resource Laboratory
http://casoilresource.lawr.ucdavis.edu/
University of California at Davis
530.754.7341


From axel.hille at gmx.net  Tue Apr 13 22:57:57 2010
From: axel.hille at gmx.net (Axel Hille)
Date: Tue, 13 Apr 2010 22:57:57 +0200
Subject: [R-sig-Geo] raster grid does not fit to SpatialLines and -Polygons
 plotted overlays - final solution
Message-ID: <20100413205757.171580@gmx.net>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100413/b8696373/attachment.pl>

From M.Stevenson at massey.ac.nz  Wed Apr 14 04:52:14 2010
From: M.Stevenson at massey.ac.nz (Mark Stevenson)
Date: Wed, 14 Apr 2010 14:52:14 +1200
Subject: [R-sig-Geo] spatstat ppm
Message-ID: <000001cadb7d$7d0624b0$77126e10$@Stevenson@massey.ac.nz>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100414/605b9183/attachment.pl>

From mark_connolly at acm.org  Wed Apr 14 12:32:16 2010
From: mark_connolly at acm.org (Mark Connolly)
Date: Wed, 14 Apr 2010 06:32:16 -0400
Subject: [R-sig-Geo] automap model defaults
Message-ID: <4BC599B0.2050801@acm.org>

I was wondering what is behind the selection of the default models tried 
by autofitVariogram (model=c("Sph","Exp","Gau","Ste")).  For example, 
why was linear model left out?

Thanks


From b.rowlingson at lancaster.ac.uk  Wed Apr 14 17:12:55 2010
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed, 14 Apr 2010 16:12:55 +0100
Subject: [R-sig-Geo] Obtaining 3d surface area using polygon layer and
	DEM grid
In-Reply-To: <q2sd8ad40b51004130946v2479114lb5de9d0d163fac9f@mail.gmail.com>
References: <655987.28461.qm@web43139.mail.sp1.yahoo.com>
	<q2sd8ad40b51004130946v2479114lb5de9d0d163fac9f@mail.gmail.com>
Message-ID: <q2td8ad40b51004140812p836b268dt2b4fe138197be6ac@mail.gmail.com>

On Tue, Apr 13, 2010 at 5:46 PM, Barry Rowlingson
<b.rowlingson at lancaster.ac.uk> wrote:

> ?I don't know of any R implementation of a surface area algorithm for
> R at the moment.

 Well, I do now because I've just written it. It's an implementation
of the Jenness algorithm. He doesn't say how he copes with the edges,
so what I do is extend the grid by 1 pixel all round and fill the edge
with the nearest value from the grid.

 It's written in C and does a 2000x2000 grid in a couple of seconds.

 > b=matrix(runif(2000*2000),2000,2000)
 > system.time(print(sacalc(b)))
 [1] 4592546
    user  system elapsed
   1.868   0.076   1.941

 now currently it doesn't take into account the grid spacing - it
assumes the cells are 1 unit apart and that's the same scale as the
values. Simple enough to add scaling but fiddly to integrate it into
SpatialGrid objects. Matrices are so much simpler :)

 Also, it's one C file and one R file, no documentation, and I've not
tested it hardly, and I can't build it for Windows.

Barry

-- 
blog: http://geospaced.blogspot.com/
web: http://www.maths.lancs.ac.uk/~rowlings
web: http://www.rowlingson.com/
twitter: http://twitter.com/geospacedman
pics: http://www.flickr.com/photos/spacedman


From edzer.pebesma at uni-muenster.de  Wed Apr 14 17:38:37 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 14 Apr 2010 17:38:37 +0200
Subject: [R-sig-Geo] Obtaining 3d surface area using polygon layer and
 DEM grid
In-Reply-To: <q2td8ad40b51004140812p836b268dt2b4fe138197be6ac@mail.gmail.com>
References: <655987.28461.qm@web43139.mail.sp1.yahoo.com>	<q2sd8ad40b51004130946v2479114lb5de9d0d163fac9f@mail.gmail.com>
	<q2td8ad40b51004140812p836b268dt2b4fe138197be6ac@mail.gmail.com>
Message-ID: <4BC5E17D.1070702@uni-muenster.de>

Barry, I wouldn't object integrating it in sp. Can it cope with missing
values in the grid? Would you be willing to write a short help file with
some reference to the algorithm used? (I found this one:
http://www.jennessent.com/downloads/WSB_32_3_Jenness.pdf )

Barry Rowlingson wrote:
> On Tue, Apr 13, 2010 at 5:46 PM, Barry Rowlingson
> <b.rowlingson at lancaster.ac.uk> wrote:
> 
>>  I don't know of any R implementation of a surface area algorithm for
>> R at the moment.
> 
>  Well, I do now because I've just written it. It's an implementation
> of the Jenness algorithm. He doesn't say how he copes with the edges,
> so what I do is extend the grid by 1 pixel all round and fill the edge
> with the nearest value from the grid.
> 
>  It's written in C and does a 2000x2000 grid in a couple of seconds.
> 
>  > b=matrix(runif(2000*2000),2000,2000)
>  > system.time(print(sacalc(b)))
>  [1] 4592546
>     user  system elapsed
>    1.868   0.076   1.941
> 
>  now currently it doesn't take into account the grid spacing - it
> assumes the cells are 1 unit apart and that's the same scale as the
> values. Simple enough to add scaling but fiddly to integrate it into
> SpatialGrid objects. Matrices are so much simpler :)

That's why SpatialGridDataFrames have an as.matrix method. Of course you
loose the cell size.

> 
>  Also, it's one C file and one R file, no documentation, and I've not
> tested it hardly, and I can't build it for Windows.
> 
> Barry
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From sharonb_m at yahoo.com  Wed Apr 14 18:00:06 2010
From: sharonb_m at yahoo.com (Sharon Baruch-Mordo)
Date: Wed, 14 Apr 2010 09:00:06 -0700 (PDT)
Subject: [R-sig-Geo] Obtaining 3d surface area using polygon layer and
	DEM grid
In-Reply-To: <4BC5E17D.1070702@uni-muenster.de>
References: <655987.28461.qm@web43139.mail.sp1.yahoo.com>
	<q2sd8ad40b51004130946v2479114lb5de9d0d163fac9f@mail.gmail.com>
	<q2td8ad40b51004140812p836b268dt2b4fe138197be6ac@mail.gmail.com>
	<4BC5E17D.1070702@uni-muenster.de>
Message-ID: <801650.29037.qm@web43143.mail.sp1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100414/098644dd/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Wed Apr 14 18:03:51 2010
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed, 14 Apr 2010 17:03:51 +0100
Subject: [R-sig-Geo] Obtaining 3d surface area using polygon layer and
	DEM grid
In-Reply-To: <4BC5E17D.1070702@uni-muenster.de>
References: <655987.28461.qm@web43139.mail.sp1.yahoo.com>
	<q2sd8ad40b51004130946v2479114lb5de9d0d163fac9f@mail.gmail.com>
	<q2td8ad40b51004140812p836b268dt2b4fe138197be6ac@mail.gmail.com>
	<4BC5E17D.1070702@uni-muenster.de>
Message-ID: <l2zd8ad40b51004140903lcaf345b8i8f90e3d287bbba87@mail.gmail.com>

On Wed, Apr 14, 2010 at 4:38 PM, Edzer Pebesma
<edzer.pebesma at uni-muenster.de> wrote:
> Barry, I wouldn't object integrating it in sp. Can it cope with missing
> values in the grid? Would you be willing to write a short help file with
> some reference to the algorithm used? (I found this one:
> http://www.jennessent.com/downloads/WSB_32_3_Jenness.pdf )

 Not sure what to do about missing values, but that would be the way
to deal with non-rectangular areas. An NA cell would obviously
contribute 0 to the total surface, but it also affects the calculation
of surface areas for the eight adjacent cells.

 Currently it's just C code called with .C, so dealing with NA is
inherently troublesome anyway! Maybe I can rewrite to use .Call, but
there's a cricket match on...

Barry


-- 
blog: http://geospaced.blogspot.com/
web: http://www.maths.lancs.ac.uk/~rowlings
web: http://www.rowlingson.com/
twitter: http://twitter.com/geospacedman
pics: http://www.flickr.com/photos/spacedman


From b.rowlingson at lancaster.ac.uk  Wed Apr 14 18:08:28 2010
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed, 14 Apr 2010 17:08:28 +0100
Subject: [R-sig-Geo] Obtaining 3d surface area using polygon layer and
	DEM grid
In-Reply-To: <801650.29037.qm@web43143.mail.sp1.yahoo.com>
References: <655987.28461.qm@web43139.mail.sp1.yahoo.com>
	<q2sd8ad40b51004130946v2479114lb5de9d0d163fac9f@mail.gmail.com>
	<q2td8ad40b51004140812p836b268dt2b4fe138197be6ac@mail.gmail.com>
	<4BC5E17D.1070702@uni-muenster.de>
	<801650.29037.qm@web43143.mail.sp1.yahoo.com>
Message-ID: <w2xd8ad40b51004140908m54b2ef73n14f0c4639436e986@mail.gmail.com>

On Wed, Apr 14, 2010 at 5:00 PM, Sharon Baruch-Mordo
<sharonb_m at yahoo.com> wrote:
> Thanks you Barry and Edzer for your replies!
>
> I should have mentioned that I'm a relatively?new to?spatial analysis in
> R,?and unfortunately I'm not familiar with programing in C. But I'm ready to
> learn! In trying to understand the code below, I see that?you are generating
> a 2000x2000 matrix with a random uniform number then?using the function
> sacalc, but how is it calculating the 3d surface (I tried the web for
> documentation on sacalc but didn't get too far... )??Would that be the
> equivalent of getting a DEM clipped by the polygon of interest and then
> running it?through sacalc?
>

 Ah, sorry, sacalc() is the function I wrote, and it's not included. The line:

   b=matrix(runif(2000*2000),2000,2000)

 just creates a 2000x2000 matrix of random numbers (representing
heights) between 0 and 1. It won't be a very smooth surface! The
resulting output being about 2000x2000 shows I'm getting in the right
ballpark. In fact if I change the values in "b" to be smaller, meaning
a relatively flatter surface compared to the grid size, the result
tends towards 2000x2000, which is comforting.

 sacalc just works on a 2d matrix of values, and treats them as
heights in the DEM. It can't clip it to a polygon, but Edzer's
comments on NA (missing data) values has given me some ideas...

Barry


From b.rowlingson at lancaster.ac.uk  Wed Apr 14 19:09:00 2010
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed, 14 Apr 2010 18:09:00 +0100
Subject: [R-sig-Geo] Obtaining 3d surface area using polygon layer and
	DEM grid
In-Reply-To: <l2zd8ad40b51004140903lcaf345b8i8f90e3d287bbba87@mail.gmail.com>
References: <655987.28461.qm@web43139.mail.sp1.yahoo.com>
	<q2sd8ad40b51004130946v2479114lb5de9d0d163fac9f@mail.gmail.com>
	<q2td8ad40b51004140812p836b268dt2b4fe138197be6ac@mail.gmail.com>
	<4BC5E17D.1070702@uni-muenster.de>
	<l2zd8ad40b51004140903lcaf345b8i8f90e3d287bbba87@mail.gmail.com>
Message-ID: <q2qd8ad40b51004141009h23e44beue9a0013b6c996273@mail.gmail.com>

On Wed, Apr 14, 2010 at 5:03 PM, Barry Rowlingson
<b.rowlingson at lancaster.ac.uk> wrote:

> ?Not sure what to do about missing values, but that would be the way
> to deal with non-rectangular areas. An NA cell would obviously
> contribute 0 to the total surface, but it also affects the calculation
> of surface areas for the eight adjacent cells.
>
> ?Currently it's just C code called with .C, so dealing with NA is
> inherently troublesome anyway! Maybe I can rewrite to use .Call, but
> there's a cricket match on...

 Right, well I didn't realise you could call ISNA(x) from .C code.
I've just implemented something for handling NA...

 When considering a cell with an NA value, the area contribution is
zero (whatever its neighbours are)

 When considering a non-NA cell with NA-valued neighbours, pretend the
neighbour cell had the same value as the considered cell.

 I've implemented this, and it seems to be consistent with
expectations... Will sort out docs tomorrow.

Barry


From jeffrey.cardille at umontreal.ca  Wed Apr 14 21:47:01 2010
From: jeffrey.cardille at umontreal.ca (Prof. Jeffrey Cardille)
Date: Wed, 14 Apr 2010 15:47:01 -0400
Subject: [R-sig-Geo] Correspondence between gstat and ArcGIS functionality?
Message-ID: <3BA0C246-51E0-4B50-879B-F38DAF837726@umontreal.ca>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100414/923de59e/attachment.pl>

From edzer.pebesma at uni-muenster.de  Wed Apr 14 23:14:44 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 14 Apr 2010 23:14:44 +0200
Subject: [R-sig-Geo] Correspondence between gstat and ArcGIS
	functionality?
In-Reply-To: <3BA0C246-51E0-4B50-879B-F38DAF837726@umontreal.ca>
References: <3BA0C246-51E0-4B50-879B-F38DAF837726@umontreal.ca>
Message-ID: <4BC63044.3070009@uni-muenster.de>

Hi,

telling us what the drop-down menus tell you leaves me a bit of guess
work. Universal probably means universal kriging; linear drift a first
order trend in the coordinates (pass degree = 1 to krige, and something
like value~x+y to variogram, when long/lat are named x and y). Does the
first "Linear" in "Linear with linear drift" refer to a fitted linear
variogram model?

Prof. Jeffrey Cardille wrote:
> Hello all,
> 
> This is my first posting to R-sig-geo; I looked for the answer in the archives, but have not had any luck for my particular question. 
> 
> I have a newbie question about the correspondence between gstat and ArcGIS.  I have a problem that gives very very satisfying results in ArcGIS, and I would like to write a public function in R for others to use that does the same thing.  The choice I used in Arc was "Universal" and in the dropdown menu it says "Linear with Linear Drift".  My data matrix is pretty standard:  2000 x 2000, with some NA, and values between 0 and 255.
> 
> So I have a few questions.  Maybe I'll enumerate them.
> 1. Has anyone made a comprehensive list between ArcGIS functionality and how to do it in gstat?

Great idea!

> 2. If not: does anyone know a simple correspondence between what ArcGIS is doing and how to set up a gstat call for "Universal/Linear with Linear Drift"?  I have looked online for precise details about Arc's behavior, but haven't seen anything detailed enough.

Well, you have a license, doesn't that come with access to some sort of
documentation?
> 
> 3. Are there any tricks in gstat that make interpolation with gstat especially fast or slow?  For example, if the numbers were treated faster if they were between 0 and 1, or if NA should be recoded, or if I should never use a data frame but always a matrix.  That sort of thing.
>
Not the things you mention; defining a local neighbourhood matters --
small neighbourhoods are faster, but at some stage also produce worse
interpolations.

For filling in missing strips in images I'd try to use segmented
neighbourhoods, to guarantee values are taken from all sides. Quadrant
search is available in the gstat C code, but not interfaced through the
R package. I will implement it if you volunteer to test it.

> If not, I'll resort to trial and error and diving deeper into the gstat documentation.  But it seems like a good idea to check in first.  For anyone interested, I am trying to repair Landsat satellite photos, which have big broken strips of nodata due to a mechanical failure.  The strips are up to 14 pixels wide.  I need to do this 2000x2000 interpolation about 2000 times-- so speed differences of even a few seconds or minutes are quite important..

I'm interested in your findings!

BTW, just out of curiosity, why don't you do the whole thing with ArcGIS?

> 
> Thanks!
> Jeff
> 
> ------------------------------------------
> Prof. Jeffrey Cardille
> jeffrey.cardille at umontreal.ca
> 
> ******************************************************************************************
> **  http://www.geog.umontreal.ca :                Web                                   **
> **  http://sites.google.com/site/jeffcardille :   Plans de Cours et Recherche           **
> **                                                                                      **
> **  "Petit ? petit l'oiseau fait son nid ..."    N'h?sitez pas ? corriger mon fran?ais  **
> *********************************************************************************************************
> **     D?partement de G?ographie                        **     Bureau:                                 **
> **     assistant professor / professeur adjoint         **     Salle 440                               **
> **     Universit? de Montr?al                           **     Pavillon Strathcona                     **
> **     C.P. 6128                                        **     520, chemin de la C?te-Ste-Catherine    **
> **     Succursale Centre-ville                          **     Montreal, QC H2V 2B8                    **
> **     Montr?al, QC, H3C 3J7                            **     T?l?: (514) 343-8003                    **
> *********************************************************************************************************
> **
> **  Pour aider ? Haiti avec votre int?r?t de g?ographie, visitez:
> **  http://groups.google.com/group/udem-geo-aide/
> **
> *********************************************************************************************************
> 
> 
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From jeffrey.cardille at umontreal.ca  Thu Apr 15 03:30:24 2010
From: jeffrey.cardille at umontreal.ca (Prof. Jeffrey Cardille)
Date: Wed, 14 Apr 2010 21:30:24 -0400
Subject: [R-sig-Geo] Correspondence between gstat and ArcGIS
	functionality?
In-Reply-To: <4BC63044.3070009@uni-muenster.de>
References: <3BA0C246-51E0-4B50-879B-F38DAF837726@umontreal.ca>
	<4BC63044.3070009@uni-muenster.de>
Message-ID: <4D6D92AD-5E22-413E-97A8-FCBCDB02E873@umontreal.ca>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100414/3a2443e3/attachment.pl>

From hengl at spatial-analyst.net  Thu Apr 15 08:57:22 2010
From: hengl at spatial-analyst.net (Tomislav Hengl)
Date: Thu, 15 Apr 2010 08:57:22 +0200
Subject: [R-sig-Geo] Derivation of intermediate points (great circle
	geometry) in the	geosphere package
Message-ID: <20100415085722.ysx4zhzoboo8k00g@spatial-analyst.net>


I have started using the geosphere package kindly provided by Robert  
Hijmans [http://cran.r-project.org/web/packages/geosphere/]. My  
intention is to derive a global map of the air routes density using  
the open access flight routes [http://openflights.org/data.html].

I have discovered some strange results when trying to derive the  
intermediate points on a path:

gcIntermediate(p1, p2, n)
*this uses the formulas described in  
[http://williams.best.vwh.net/avform.htm#Intermediate]

I discovered that, depending on the location of points considering  
quadrants, the current formula will (systematically?) shift the  
coordinates to some new quadrant, which is obviously a bug:

> library(geosphere)
> gcIntermediate(c(0,0), c(10,10), 5)  # this one is OK
           lon      lat
[1,] 1.803343 1.830237
[2,] 3.422141 3.468623
[3,] 4.961631 5.019001
[4,] 6.508449 6.565756
[5,] 8.150886 8.192447
> gcIntermediate(c(-10,10), c(10,10), 5)  # this one needs to be  
> fixed: ifelse(lon>0, lon+180, 180-lon); -1*lat
            lon       lat
[1,]  173.6232 -10.08957
[2,]  176.8920 -10.13646
[3,]  180.0000 -10.15108
[4,] -176.8920 -10.13646
[5,] -173.6232 -10.08957
> gcIntermediate(c(-20,-10), c(5,10), 5)  # this is OK
              lon       lat
[1,] -15.4984322 -6.467336
[2,] -11.4054190 -3.175910
[3,]  -7.5000000  0.000000
[4,]  -3.5945810  3.175910
[5,]   0.4984322  6.467336
> gcIntermediate(c(-20,-25), c(10,5), 5) # this needs to be fixed:   
> for(lon2<lon1) {ifelse(lon>0, 180-lon, 180+lon)}; -1*lat
            lon        lat
[1,]  165.7968 20.0356468
[2,]  170.9455 15.1760517
[3,]  175.7253 10.3444590
[4,] -179.6410  5.4446120
[5,] -174.9524  0.3684525


Is somebody really good in geosphere geometry?

BR & thanx

T. Hengl
http://home.medewerker.uva.nl/t.hengl/


From p.hiemstra at geo.uu.nl  Thu Apr 15 13:42:38 2010
From: p.hiemstra at geo.uu.nl (Paul Hiemstra)
Date: Thu, 15 Apr 2010 13:42:38 +0200
Subject: [R-sig-Geo] automap model defaults
In-Reply-To: <4BC599B0.2050801@acm.org>
References: <4BC599B0.2050801@acm.org>
Message-ID: <4BC6FBAE.8030807@geo.uu.nl>

Mark Connolly wrote:
> I was wondering what is behind the selection of the default models 
> tried by autofitVariogram (model=c("Sph","Exp","Gau","Ste")).  For 
> example, why was linear model left out?
>
> Thanks
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
Hi Mark,

These models are the models that are most often used, so it seemed 
logical to use these ones. But why do you want to include the linear 
model specifically?

cheers,
Paul

-- 
Drs. Paul Hiemstra
Department of Physical Geography
Faculty of Geosciences
University of Utrecht
Heidelberglaan 2
P.O. Box 80.115
3508 TC Utrecht
Phone:  +3130 274 3113 Mon-Tue
Phone:  +3130 253 5773 Wed-Fri
http://intamap.geo.uu.nl/~paul
http://nl.linkedin.com/pub/paul-hiemstra/20/30b/770


From mark_connolly at acm.org  Thu Apr 15 14:09:26 2010
From: mark_connolly at acm.org (Mark Connolly)
Date: Thu, 15 Apr 2010 08:09:26 -0400
Subject: [R-sig-Geo] automap model defaults
In-Reply-To: <4BC6FBAE.8030807@geo.uu.nl>
References: <4BC599B0.2050801@acm.org> <4BC6FBAE.8030807@geo.uu.nl>
Message-ID: <4BC701F6.3090202@acm.org>

On 04/15/2010 07:42 AM, Paul Hiemstra wrote:
> Mark Connolly wrote:
>> I was wondering what is behind the selection of the default models 
>> tried by autofitVariogram (model=c("Sph","Exp","Gau","Ste")).  For 
>> example, why was linear model left out?
>>
>> Thanks
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> Hi Mark,
>
> These models are the models that are most often used, so it seemed 
> logical to use these ones. But why do you want to include the linear 
> model specifically?
>
> cheers,
> Paul
>
Only because it sometimes results in a lower SSError.  I guess that is 
my real question: why wouldn't I want to try the linear model in the 
set?  The field I am looking at is a layered ag field in a coastal 
plain, and the five depth layers (which extend to less than a meter from 
the surface) I am looking at are often fairly homogeneous for specific 
properties.  Some of property values I am fitting produce a linear model 
as the best fit in a specific layer.  (Although sometimes when this is 
the case, the linear model is just barely better and than the next-best 
non-linear model.)

I assume the selection of the default models is not arbitrary, but I 
lack the experience to include/exclude linear models in the best fit 
search.  Best to stick with the default?

Thanks,
Mark


From edzer.pebesma at uni-muenster.de  Thu Apr 15 14:49:12 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 15 Apr 2010 14:49:12 +0200
Subject: [R-sig-Geo] automap model defaults
In-Reply-To: <4BC701F6.3090202@acm.org>
References: <4BC599B0.2050801@acm.org> <4BC6FBAE.8030807@geo.uu.nl>
	<4BC701F6.3090202@acm.org>
Message-ID: <4BC70B48.40103@uni-muenster.de>

Mark, please note that the linear model (with nugget), having only two
parameters where most models have three (nugget, range, sill) or four (+
smoothness) arises as a special case of e.g. the spherical or
exponential model when the range becomes infinite, or at least very
large compared to the spatial extent. I'm not sure if automap allows
fitting of very large range values.
--
Edzer

Mark Connolly wrote:
> On 04/15/2010 07:42 AM, Paul Hiemstra wrote:
>> Mark Connolly wrote:
>>> I was wondering what is behind the selection of the default models
>>> tried by autofitVariogram (model=c("Sph","Exp","Gau","Ste")).  For
>>> example, why was linear model left out?
>>>
>>> Thanks
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> Hi Mark,
>>
>> These models are the models that are most often used, so it seemed
>> logical to use these ones. But why do you want to include the linear
>> model specifically?
>>
>> cheers,
>> Paul
>>
> Only because it sometimes results in a lower SSError.  I guess that is
> my real question: why wouldn't I want to try the linear model in the
> set?  The field I am looking at is a layered ag field in a coastal
> plain, and the five depth layers (which extend to less than a meter from
> the surface) I am looking at are often fairly homogeneous for specific
> properties.  Some of property values I am fitting produce a linear model
> as the best fit in a specific layer.  (Although sometimes when this is
> the case, the linear model is just barely better and than the next-best
> non-linear model.)
> 
> I assume the selection of the default models is not arbitrary, but I
> lack the experience to include/exclude linear models in the best fit
> search.  Best to stick with the default?
> 
> Thanks,
> Mark
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From p.hiemstra at geo.uu.nl  Thu Apr 15 15:54:23 2010
From: p.hiemstra at geo.uu.nl (Paul Hiemstra)
Date: Thu, 15 Apr 2010 15:54:23 +0200
Subject: [R-sig-Geo] automap model defaults
In-Reply-To: <4BC70B48.40103@uni-muenster.de>
References: <4BC599B0.2050801@acm.org> <4BC6FBAE.8030807@geo.uu.nl>
	<4BC701F6.3090202@acm.org> <4BC70B48.40103@uni-muenster.de>
Message-ID: <4BC71A8F.8010102@geo.uu.nl>

Edzer Pebesma wrote:
> Mark, please note that the linear model (with nugget), having only two
> parameters where most models have three (nugget, range, sill) or four (+
> smoothness) arises as a special case of e.g. the spherical or
> exponential model when the range becomes infinite, or at least very
> large compared to the spatial extent. I'm not sure if automap allows
> fitting of very large range values.
>   
See the following example:

data(meuse)
coordinates(meuse) = ~x+y
vgm1 <- variogram(log(zinc)~1, meuse)
vgm1$gamma = 1:15 + 0.00001*runif(15)
v1 = fit.variogram(vgm1, vgm(15,"Sph",1000,1))
v2 = fit.variogram(vgm1, vgm(15,"Lin",1000,1))
plot(vgm1, v1) #Sph
plot(vgm1, v2) #Lin

Probably the difference in the estimated covariance matrix is quite 
small between the linear and the spherical variogram. In this example 
the range is quite a bit larger than the spatial extent, so I think 
automap can handle this.

cheers,
Paul
> --
> Edzer
>
> Mark Connolly wrote:
>   
>> On 04/15/2010 07:42 AM, Paul Hiemstra wrote:
>>     
>>> Mark Connolly wrote:
>>>       
>>>> I was wondering what is behind the selection of the default models
>>>> tried by autofitVariogram (model=c("Sph","Exp","Gau","Ste")).  For
>>>> example, why was linear model left out?
>>>>
>>>> Thanks
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at stat.math.ethz.ch
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>         
>>> Hi Mark,
>>>
>>> These models are the models that are most often used, so it seemed
>>> logical to use these ones. But why do you want to include the linear
>>> model specifically?
>>>
>>> cheers,
>>> Paul
>>>
>>>       
>> Only because it sometimes results in a lower SSError.  I guess that is
>> my real question: why wouldn't I want to try the linear model in the
>> set?  The field I am looking at is a layered ag field in a coastal
>> plain, and the five depth layers (which extend to less than a meter from
>> the surface) I am looking at are often fairly homogeneous for specific
>> properties.  Some of property values I am fitting produce a linear model
>> as the best fit in a specific layer.  (Although sometimes when this is
>> the case, the linear model is just barely better and than the next-best
>> non-linear model.)
>>
>> I assume the selection of the default models is not arbitrary, but I
>> lack the experience to include/exclude linear models in the best fit
>> search.  Best to stick with the default?
>>
>> Thanks,
>> Mark
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>     
>
>   


-- 
Drs. Paul Hiemstra
Department of Physical Geography
Faculty of Geosciences
University of Utrecht
Heidelberglaan 2
P.O. Box 80.115
3508 TC Utrecht
Phone:  +3130 274 3113 Mon-Tue
Phone:  +3130 253 5773 Wed-Fri
http://intamap.geo.uu.nl/~paul
http://nl.linkedin.com/pub/paul-hiemstra/20/30b/770


From p.hiemstra at geo.uu.nl  Thu Apr 15 15:56:29 2010
From: p.hiemstra at geo.uu.nl (Paul Hiemstra)
Date: Thu, 15 Apr 2010 15:56:29 +0200
Subject: [R-sig-Geo] automap model defaults
In-Reply-To: <4BC701F6.3090202@acm.org>
References: <4BC599B0.2050801@acm.org> <4BC6FBAE.8030807@geo.uu.nl>
	<4BC701F6.3090202@acm.org>
Message-ID: <4BC71B0D.1090001@geo.uu.nl>

Mark Connolly wrote:
> On 04/15/2010 07:42 AM, Paul Hiemstra wrote:
>> Mark Connolly wrote:
>>> I was wondering what is behind the selection of the default models 
>>> tried by autofitVariogram (model=c("Sph","Exp","Gau","Ste")).  For 
>>> example, why was linear model left out?
>>>
>>> Thanks
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> Hi Mark,
>>
>> These models are the models that are most often used, so it seemed 
>> logical to use these ones. But why do you want to include the linear 
>> model specifically?
>>
>> cheers,
>> Paul
>>
> Only because it sometimes results in a lower SSError.
But probably the result in terms of kriging prediction is almost the 
same between a spherical with a very large range and a linear variogram.
> I guess that is my real question: why wouldn't I want to try the 
> linear model in the set?  The field I am looking at is a layered ag 
> field in a coastal plain, and the five depth layers (which extend to 
> less than a meter from the surface) I am looking at are often fairly 
> homogeneous for specific properties.  Some of property values I am 
> fitting produce a linear model as the best fit in a specific layer.  
> (Although sometimes when this is the case, the linear model is just 
> barely better and than the next-best non-linear model.)
>
> I assume the selection of the default models is not arbitrary, but I 
> lack the experience to include/exclude linear models in the best fit 
> search.  Best to stick with the default?
I would say yes, because the spherical includes (in practice) the linear 
variogram model as a special case.

cheers,
Paul
>
>
> Thanks,
> Mark


-- 
Drs. Paul Hiemstra
Department of Physical Geography
Faculty of Geosciences
University of Utrecht
Heidelberglaan 2
P.O. Box 80.115
3508 TC Utrecht
Phone:  +3130 274 3113 Mon-Tue
Phone:  +3130 253 5773 Wed-Fri
http://intamap.geo.uu.nl/~paul
http://nl.linkedin.com/pub/paul-hiemstra/20/30b/770


From german.sanchez at ais-int.com  Thu Apr 15 16:45:49 2010
From: german.sanchez at ais-int.com (=?iso-8859-1?Q?Germ=E1n_S=E1nchez_Hern=E1ndez?=)
Date: Thu, 15 Apr 2010 16:45:49 +0200
Subject: [R-sig-Geo] Shape to DB, DB to SpatialPolygon
In-Reply-To: <alpine.LRH.2.00.1004121905130.31324@reclus.nhh.no>
References: <52383.10.10.2.41.1270722081.squirrel@hermes.ais-int.net>
	<r2t94b3c8441004080417o5a080b77u3cbc7bebc7b6df5c@mail.gmail.com>
	<AE1B56AF-35F3-4E48-8C0D-9EB654260625@ais-int.com>
	<alpine.LRH.2.00.1004121905130.31324@reclus.nhh.no>
Message-ID: <75612842-70DA-4DDD-909B-25E0721F588C@ais-int.com>

Hi again,

I'm under Linux RedHat, and R 2.9.0.

I've tried to enable PG in GDAL configuration:

./configure --with-static-proj4=/usr/local/lib \
 --with-threads --with-libtiff=internal --with-geotiff=internal \
 --with-jpeg=internal --with-gif=internal --with-png=internal \
 --with-libz=internal --without-expat --without-jasper --without-ecw \
 --without-curl --without-dwgdirect --without-mrsid --without-jp2mrsid \
 --without-mysql --without-odbc --without-grib --with-ogr --with-pg=/usr/bin/pg_config
make
make install
But PG driver is not loaded:

$ ogrinfo --formats
Supported Formats:
  -> "ESRI Shapefile" (read/write)
  -> "MapInfo File" (read/write)
  -> "UK .NTF" (readonly)
  -> "SDTS" (readonly)
  -> "TIGER" (read/write)
  -> "S57" (read/write)
  -> "DGN" (read/write)
  -> "VRT" (readonly)
  -> "REC" (readonly)
  -> "Memory" (read/write)
  -> "BNA" (read/write)
  -> "CSV" (read/write)
  -> "GML" (read/write)
  -> "GPX" (read/write)
  -> "KML" (read/write)
  -> "GeoJSON" (read/write)
  -> "GMT" (read/write)
  -> "SQLite" (read/write)
  -> "PCIDSK" (readonly)
  -> "XPlane" (readonly)
  -> "AVCBin" (readonly)
  -> "AVCE00" (readonly)
  -> "DXF" (read/write)
  -> "Geoconcept" (read/write)
  -> "GeoRSS" (read/write)
  -> "GPSTrackMaker" (read/write)
  -> "VFK" (readonly)

After that, I have installed rgdal by source
 R CMD INSTALL -l /home/german/R/Packages/ /home/german/R/Packages/rgdal_0.6-23.tar.gz

And, of course, in R the PG driver is not loaded (ogrDrivers()).

Any idea?
Thank you!
Germ?n S?nchez

El 12/04/2010, a las 19:14, Roger Bivand escribi?:

> On Mon, 12 Apr 2010, Germ?n S?nchez Hern?ndez wrote:
> 
>> Hi Carson (and list!),
>> 
>> I have corretly installed rgdal package in R (with some initial problems but finally working).
>> 
>> If I run ogrDrivers() no driver for PostgreSQL is listed (remember that the postgresql database is correctly running with the PostGIS extension, and I can connect through RODBC package):
> 
> The OGR driver will only be present if you have built OGR with PostGIS enabled. If you use the CRAN Windows 32-bit binary, or the CRAN extras OSX 32-bit or Windows 64-bit binaries, the driver is not included. To use PostGIS with OGR, install GDAL with PostGIS enabled, and check with:
> 
> $ ogrinfo --formats
> 
> Until you see PostGIS/PostgreSQL there, you will not see it inside R either, having installed rgdal from source. Using PostGIS effectively presupposes that you have some experience in installing software from source, and that your platform has the necessary build trains; these kinds of things rarely work "out of the box". The rgdal package as a binary has most commonly used drivers, and more will not be added, because they depend on libraries/DLLs external to GDAL/OGR.
> 
> Roger
> 
>> 
>>> ogrDrivers()
>>            name write
>> 1          AVCBin FALSE
>> 2          AVCE00 FALSE
>> 3             BNA  TRUE
>> 4             CSV  TRUE
>> 5             DGN  TRUE
>> 6             DXF  TRUE
>> 7  ESRI Shapefile  TRUE
>> 8      Geoconcept  TRUE
>> 9         GeoJSON  TRUE
>> 10         GeoRSS  TRUE
>> 11            GML  TRUE
>> 12            GMT  TRUE
>> 13  GPSTrackMaker  TRUE
>> 14            GPX  TRUE
>> 15            KML  TRUE
>> 16   MapInfo File  TRUE
>> 17         Memory  TRUE
>> 18         PCIDSK FALSE
>> 19            REC FALSE
>> 20            S57  TRUE
>> 21           SDTS FALSE
>> 22         SQLite  TRUE
>> 23          TIGER  TRUE
>> 24        UK .NTF FALSE
>> 25            VFK FALSE
>> 26            VRT FALSE
>> 27         XPlane FALSE
>> 
>> What am I missing?
>> 
>> Thank you!
>> Germ?n S?nchez
>> german.sanchez at esade.edu
>> 
>> El 08/04/2010, a las 13:17, Carson Farmer escribi?:
>> 
>>> Hi Germ?n,
>>> 
>>> Have a look at package rgdal and the readOGR function.
>>> 
>>>> library(rgdal)
>>>> ?readOGR
>>> 
>>> Here is a link with a quick bit on using rgdal to access a postgis table:
>>> http://wiki.intamap.org/index.php/PostGIS
>>> 
>>> Regards,
>>> 
>>> Carson
>>> 
>>> On Thu, Apr 8, 2010 at 11:21 AM, Germ?n S?nchez
>>> <german.sanchez at ais-int.com> wrote:
>>>> Dear all,
>>>> 
>>>> I've working with spatial data since only a few months. I know how to
>>>> handle this kind of data in R using the sp package. I know how to load
>>>> shapes, plot them, merge their polygons, plotting labels, etc.
>>>> 
>>>> I have installed a postgis database and I can connect to it from R via
>>>> RODBC without problems. I can load a shape file (.shp and so) into the
>>>> database (command shp2pgsql  to create the needed .sql). It creates a
>>>> table with some usual fields (area, perimeter, district, etc) and the
>>>> special one: the_geom.
>>>> 
>>>> Now, I want to load this data to a SpatialPolygon (or
>>>> SpatialPolygonDataFrame) object using the RODBC driver. I would like to
>>>> get the same object as if I have used the "readShapePoly" function from sp
>>>> package directly over the .shp file.
>>>> 
>>>> Any idea? Is there a direct solution or I have to build the polygon myself?
>>>> 
>>>> Thank you,
>>>> Germ?n S?nchez
>>>> german.sanchez at esade.edu
>>>> 
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at stat.math.ethz.ch
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>> 
>>> 
>>> 
>>> 
>>> --
>>> Carson J. Q. Farmer
>>> ISSP Doctoral Fellow
>>> National Centre for Geocomputation
>>> National University of Ireland, Maynooth,
>>> http://www.carsonfarmer.com/
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
> 
> -- 
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no


From german.sanchez at ais-int.com  Thu Apr 15 17:12:29 2010
From: german.sanchez at ais-int.com (German Sanchez Hernandez)
Date: Thu, 15 Apr 2010 17:12:29 +0200
Subject: [R-sig-Geo] Shape to DB, DB to SpatialPolygon
In-Reply-To: <alpine.LRH.2.00.1004121905130.31324@reclus.nhh.no>
References: <52383.10.10.2.41.1270722081.squirrel@hermes.ais-int.net>
	<r2t94b3c8441004080417o5a080b77u3cbc7bebc7b6df5c@mail.gmail.com>
	<AE1B56AF-35F3-4E48-8C0D-9EB654260625@ais-int.com>
	<alpine.LRH.2.00.1004121905130.31324@reclus.nhh.no>
Message-ID: <5062CBFF-1360-421A-BC95-17447049DA20@ais-int.com>

Other thing:

If I see the config.log file located in the folder which has the source of gdal, it seems PG driver is correctly installed!

config.log (extract):

  $ ./configure --with-static-proj4=/usr/local/lib --with-threads --with-libtiff=internal --with-geotiff=internal --with-jpeg=internal --with-gif=internal --with-png=internal --with-libz=internal --without-expat --without-jasper --without-ecw --without-curl --without-dwgdirect --without-mrsid --without-jp2mrsid --without-mysql --without-odbc --without-grib --with-ogr --with-pg=/usr/bin/pg_config
 HAVE_PG='yes'
 PG_CONFIG='/usr/bin/pg_config'
 PG_INC='-I/usr/include -I/usr/include/pgsql/server  -DPG_HAS_PQESCAPESTRINGCONN'
 PG_LIB=''


El 12/04/2010, a las 19:14, Roger Bivand escribi?:

> On Mon, 12 Apr 2010, Germ?n S?nchez Hern?ndez wrote:
> 
>> Hi Carson (and list!),
>> 
>> I have corretly installed rgdal package in R (with some initial problems but finally working).
>> 
>> If I run ogrDrivers() no driver for PostgreSQL is listed (remember that the postgresql database is correctly running with the PostGIS extension, and I can connect through RODBC package):
> 
> The OGR driver will only be present if you have built OGR with PostGIS enabled. If you use the CRAN Windows 32-bit binary, or the CRAN extras OSX 32-bit or Windows 64-bit binaries, the driver is not included. To use PostGIS with OGR, install GDAL with PostGIS enabled, and check with:
> 
> $ ogrinfo --formats
> 
> Until you see PostGIS/PostgreSQL there, you will not see it inside R either, having installed rgdal from source. Using PostGIS effectively presupposes that you have some experience in installing software from source, and that your platform has the necessary build trains; these kinds of things rarely work "out of the box". The rgdal package as a binary has most commonly used drivers, and more will not be added, because they depend on libraries/DLLs external to GDAL/OGR.
> 
> Roger
> 
>> 
>>> ogrDrivers()
>>            name write
>> 1          AVCBin FALSE
>> 2          AVCE00 FALSE
>> 3             BNA  TRUE
>> 4             CSV  TRUE
>> 5             DGN  TRUE
>> 6             DXF  TRUE
>> 7  ESRI Shapefile  TRUE
>> 8      Geoconcept  TRUE
>> 9         GeoJSON  TRUE
>> 10         GeoRSS  TRUE
>> 11            GML  TRUE
>> 12            GMT  TRUE
>> 13  GPSTrackMaker  TRUE
>> 14            GPX  TRUE
>> 15            KML  TRUE
>> 16   MapInfo File  TRUE
>> 17         Memory  TRUE
>> 18         PCIDSK FALSE
>> 19            REC FALSE
>> 20            S57  TRUE
>> 21           SDTS FALSE
>> 22         SQLite  TRUE
>> 23          TIGER  TRUE
>> 24        UK .NTF FALSE
>> 25            VFK FALSE
>> 26            VRT FALSE
>> 27         XPlane FALSE
>> 
>> What am I missing?
>> 
>> Thank you!
>> Germ?n S?nchez
>> german.sanchez at esade.edu
>> 
>> El 08/04/2010, a las 13:17, Carson Farmer escribi?:
>> 
>>> Hi Germ?n,
>>> 
>>> Have a look at package rgdal and the readOGR function.
>>> 
>>>> library(rgdal)
>>>> ?readOGR
>>> 
>>> Here is a link with a quick bit on using rgdal to access a postgis table:
>>> http://wiki.intamap.org/index.php/PostGIS
>>> 
>>> Regards,
>>> 
>>> Carson
>>> 
>>> On Thu, Apr 8, 2010 at 11:21 AM, Germ?n S?nchez
>>> <german.sanchez at ais-int.com> wrote:
>>>> Dear all,
>>>> 
>>>> I've working with spatial data since only a few months. I know how to
>>>> handle this kind of data in R using the sp package. I know how to load
>>>> shapes, plot them, merge their polygons, plotting labels, etc.
>>>> 
>>>> I have installed a postgis database and I can connect to it from R via
>>>> RODBC without problems. I can load a shape file (.shp and so) into the
>>>> database (command shp2pgsql  to create the needed .sql). It creates a
>>>> table with some usual fields (area, perimeter, district, etc) and the
>>>> special one: the_geom.
>>>> 
>>>> Now, I want to load this data to a SpatialPolygon (or
>>>> SpatialPolygonDataFrame) object using the RODBC driver. I would like to
>>>> get the same object as if I have used the "readShapePoly" function from sp
>>>> package directly over the .shp file.
>>>> 
>>>> Any idea? Is there a direct solution or I have to build the polygon myself?
>>>> 
>>>> Thank you,
>>>> Germ?n S?nchez
>>>> german.sanchez at esade.edu
>>>> 
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at stat.math.ethz.ch
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>> 
>>> 
>>> 
>>> 
>>> --
>>> Carson J. Q. Farmer
>>> ISSP Doctoral Fellow
>>> National Centre for Geocomputation
>>> National University of Ireland, Maynooth,
>>> http://www.carsonfarmer.com/
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
> 
> -- 
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no


From tmj at visi.com  Thu Apr 15 17:31:37 2010
From: tmj at visi.com (Thomas Juntunen)
Date: Thu, 15 Apr 2010 10:31:37 -0500
Subject: [R-sig-Geo] Correspondence between gstat and ArcGIS
 functionality?
In-Reply-To: <3BA0C246-51E0-4B50-879B-F38DAF837726@umontreal.ca>
References: <3BA0C246-51E0-4B50-879B-F38DAF837726@umontreal.ca>
Message-ID: <20100415103137770067.ffe9c344@visi.com>

On Wed, 14 Apr 2010 15:47:01 -0400, Prof. Jeffrey Cardille wrote:

> For anyone 
> interested, I am trying to repair Landsat satellite photos, which have big 
> broken strips of nodata due to a mechanical failure.  The strips are up to 14 
> pixels wide.  I need to do this 2000x2000 interpolation about 2000 times-- so 
> speed differences of even a few seconds or minutes are quite important..

Hello,

I'm a graduate student at the University of Minnesota in the GIS program. For 
the past couple years I have been assisting a conservation biology doctoral 
student with GIS aspects of her dissertation, which involved acquiring Landsat 
data. I presume you are talking about the scan line corrector problem that 
developed in 2003 on Landsat 7 in the extended thematic mapper?

USGS engineers at EROS have tried several approaches to correcting the gaps, 
primarily by interpolation and filling in from other scenes from the same 
season. I don't have a reference handy, but I did read something that found 
that method had an unreasonable amount of cloud cover interference. However, 
the EROS folks eventually published a paper describing how their "multi-scale 
segmentation" technique worked that was then used for EROS terrain-corrected 
products. If you haven't read it, the paper has lots of valuable information on 
the exact nature of the problem. Here's a link to the citation from the ACM 
portal:

http://portal.acm.org/citation.cfm?id=1393487

For my purposes, the EROS corrected data were sufficient, but some applications 
such as permeability studies may require pixel-level precision.

Good luck with your endeavor and if you find a solution, I hope you'll post 
about it here.


Thomas Juntunen
MGIS Program, University of Minnesota


From mark_connolly at acm.org  Thu Apr 15 18:06:14 2010
From: mark_connolly at acm.org (Mark Connolly)
Date: Thu, 15 Apr 2010 12:06:14 -0400
Subject: [R-sig-Geo] automap model defaults
In-Reply-To: <4BC71B0D.1090001@geo.uu.nl>
References: <4BC599B0.2050801@acm.org> <4BC6FBAE.8030807@geo.uu.nl>
	<4BC701F6.3090202@acm.org> <4BC71B0D.1090001@geo.uu.nl>
Message-ID: <4BC73976.5060401@acm.org>

On 04/15/2010 09:56 AM, Paul Hiemstra wrote:
> Mark Connolly wrote:
>> On 04/15/2010 07:42 AM, Paul Hiemstra wrote:
>>> Mark Connolly wrote:
>>>> I was wondering what is behind the selection of the default models 
>>>> tried by autofitVariogram (model=c("Sph","Exp","Gau","Ste")).  For 
>>>> example, why was linear model left out?
>>>>
>>>> Thanks
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at stat.math.ethz.ch
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> Hi Mark,
>>>
>>> These models are the models that are most often used, so it seemed 
>>> logical to use these ones. But why do you want to include the linear 
>>> model specifically?
>>>
>>> cheers,
>>> Paul
>>>
>> Only because it sometimes results in a lower SSError.
> But probably the result in terms of kriging prediction is almost the 
> same between a spherical with a very large range and a linear variogram.
>> I guess that is my real question: why wouldn't I want to try the 
>> linear model in the set?  The field I am looking at is a layered ag 
>> field in a coastal plain, and the five depth layers (which extend to 
>> less than a meter from the surface) I am looking at are often fairly 
>> homogeneous for specific properties.  Some of property values I am 
>> fitting produce a linear model as the best fit in a specific layer.  
>> (Although sometimes when this is the case, the linear model is just 
>> barely better and than the next-best non-linear model.)
>>
>> I assume the selection of the default models is not arbitrary, but I 
>> lack the experience to include/exclude linear models in the best fit 
>> search.  Best to stick with the default?
> I would say yes, because the spherical includes (in practice) the 
> linear variogram model as a special case.
>
> cheers,
> Paul
>>
>>
>> Thanks,
>> Mark
>
>
Thanks.  This and the related responses from you and Edzer are very 
helpful and make perfect sense.  I think I was losing the forest for the 
trees, or in the case the the maize stand for the maize stalks.

Mark


From r.hijmans at gmail.com  Thu Apr 15 18:42:51 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 15 Apr 2010 09:42:51 -0700
Subject: [R-sig-Geo] Derivation of intermediate points (great circle
	geometry) in the geosphere package
In-Reply-To: <20100415085722.ysx4zhzoboo8k00g@spatial-analyst.net>
References: <20100415085722.ysx4zhzoboo8k00g@spatial-analyst.net>
Message-ID: <g2idc22b2571004150942n3e06b197l7fe5fcd6e810279c@mail.gmail.com>

HI Tom, Can you try the latests version that is on R-Forge? I have
fixed and improved a couple of  things in it, and am about to upload
this version to CRAN. Robert

On Wed, Apr 14, 2010 at 11:57 PM, Tomislav Hengl
<hengl at spatial-analyst.net> wrote:
>
> I have started using the geosphere package kindly provided by Robert Hijmans
> [http://cran.r-project.org/web/packages/geosphere/]. My intention is to
> derive a global map of the air routes density using the open access flight
> routes [http://openflights.org/data.html].
>
> I have discovered some strange results when trying to derive the
> intermediate points on a path:
>
> gcIntermediate(p1, p2, n)
> *this uses the formulas described in
> [http://williams.best.vwh.net/avform.htm#Intermediate]
>
> I discovered that, depending on the location of points considering
> quadrants, the current formula will (systematically?) shift the coordinates
> to some new quadrant, which is obviously a bug:
>
>> library(geosphere)
>> gcIntermediate(c(0,0), c(10,10), 5) ?# this one is OK
>
> ? ? ? ? ?lon ? ? ?lat
> [1,] 1.803343 1.830237
> [2,] 3.422141 3.468623
> [3,] 4.961631 5.019001
> [4,] 6.508449 6.565756
> [5,] 8.150886 8.192447
>>
>> gcIntermediate(c(-10,10), c(10,10), 5) ?# this one needs to be fixed:
>> ifelse(lon>0, lon+180, 180-lon); -1*lat
>
> ? ? ? ? ? lon ? ? ? lat
> [1,] ?173.6232 -10.08957
> [2,] ?176.8920 -10.13646
> [3,] ?180.0000 -10.15108
> [4,] -176.8920 -10.13646
> [5,] -173.6232 -10.08957
>>
>> gcIntermediate(c(-20,-10), c(5,10), 5) ?# this is OK
>
> ? ? ? ? ? ? lon ? ? ? lat
> [1,] -15.4984322 -6.467336
> [2,] -11.4054190 -3.175910
> [3,] ?-7.5000000 ?0.000000
> [4,] ?-3.5945810 ?3.175910
> [5,] ? 0.4984322 ?6.467336
>>
>> gcIntermediate(c(-20,-25), c(10,5), 5) # this needs to be fixed:
>> ?for(lon2<lon1) {ifelse(lon>0, 180-lon, 180+lon)}; -1*lat
>
> ? ? ? ? ? lon ? ? ? ?lat
> [1,] ?165.7968 20.0356468
> [2,] ?170.9455 15.1760517
> [3,] ?175.7253 10.3444590
> [4,] -179.6410 ?5.4446120
> [5,] -174.9524 ?0.3684525
>
>
> Is somebody really good in geosphere geometry?
>
> BR & thanx
>
> T. Hengl
> http://home.medewerker.uva.nl/t.hengl/
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From german.sanchez at ais-int.com  Thu Apr 15 19:10:26 2010
From: german.sanchez at ais-int.com (German Sanchez Hernandez)
Date: Thu, 15 Apr 2010 19:10:26 +0200
Subject: [R-sig-Geo] Shape to DB, DB to SpatialPolygon
In-Reply-To: <alpine.LRH.2.00.1004151841170.11249@reclus.nhh.no>
References: <52383.10.10.2.41.1270722081.squirrel@hermes.ais-int.net>
	<r2t94b3c8441004080417o5a080b77u3cbc7bebc7b6df5c@mail.gmail.com>
	<AE1B56AF-35F3-4E48-8C0D-9EB654260625@ais-int.com>
	<alpine.LRH.2.00.1004121905130.31324@reclus.nhh.no>
	<5062CBFF-1360-421A-BC95-17447049DA20@ais-int.com>
	<alpine.LRH.2.00.1004151841170.11249@reclus.nhh.no>
Message-ID: <253EA1FD-C59E-4970-860A-2E0F44804575@ais-int.com>

I almost don't know what are you speaking about so I don't think I have done it.

If I get the "included" libraries in ldconfig, I get the following (I only post those I think are related to PG):
	libpgtypes.so.2 (libc6,x86-64) => /usr/lib64/libpgtypes.so.2
	libpgtypes.so.2 (libc6) => /usr/lib/libpgtypes.so.2
	libpgtypes.so (libc6,x86-64) => /usr/lib64/libpgtypes.so
	liblwgeom.so.1 (libc6,x86-64) => /usr/lib64/pgsql/liblwgeom.so.1
	liblwgeom.so (libc6,x86-64) => /usr/lib64/pgsql/liblwgeom.so

In the config log of gdal, the var "PG_LIB" is empty. Maybe is it the problem?

PS: sorry for sending you the email. I wrote it quickly and I forget to change the receiver.

El 15/04/2010, a las 18:44, Roger Bivand escribi?:

> On Thu, 15 Apr 2010, German Sanchez Hernandez wrote:
> 
> Please don't write to me directly on a posted list topic. I'm at a conference in a different time zone, have to pay for internet access, and don't use PostgreSQL myself. If you put my name as To:, other helpers will think that I'm helping and not do so themselves. The only thing that I can think of is that OGR drivers need the dependent *.so to be on the load path - did you add the PG library directory to the list searched by ldconfig?
> 
> Roger
> 
>> Other thing:
>> 
>> If I see the config.log file located in the folder which has the source of gdal, it seems PG driver is correctly installed!
>> 
>> config.log (extract):
>> 
>> $ ./configure --with-static-proj4=/usr/local/lib --with-threads --with-libtiff=internal --with-geotiff=internal --with-jpeg=internal --with-gif=internal --with-png=internal --with-libz=internal --without-expat --without-jasper --without-ecw --without-curl --without-dwgdirect --without-mrsid --without-jp2mrsid --without-mysql --without-odbc --without-grib --with-ogr --with-pg=/usr/bin/pg_config
>> HAVE_PG='yes'
>> PG_CONFIG='/usr/bin/pg_config'
>> PG_INC='-I/usr/include -I/usr/include/pgsql/server  -DPG_HAS_PQESCAPESTRINGCONN'
>> PG_LIB=''
>> 
>> 
>> El 12/04/2010, a las 19:14, Roger Bivand escribi?:
>> 
>>> On Mon, 12 Apr 2010, Germ?n S?nchez Hern?ndez wrote:
>>> 
>>>> Hi Carson (and list!),
>>>> 
>>>> I have corretly installed rgdal package in R (with some initial problems but finally working).
>>>> 
>>>> If I run ogrDrivers() no driver for PostgreSQL is listed (remember that the postgresql database is correctly running with the PostGIS extension, and I can connect through RODBC package):
>>> 
>>> The OGR driver will only be present if you have built OGR with PostGIS enabled. If you use the CRAN Windows 32-bit binary, or the CRAN extras OSX 32-bit or Windows 64-bit binaries, the driver is not included. To use PostGIS with OGR, install GDAL with PostGIS enabled, and check with:
>>> 
>>> $ ogrinfo --formats
>>> 
>>> Until you see PostGIS/PostgreSQL there, you will not see it inside R either, having installed rgdal from source. Using PostGIS effectively presupposes that you have some experience in installing software from source, and that your platform has the necessary build trains; these kinds of things rarely work "out of the box". The rgdal package as a binary has most commonly used drivers, and more will not be added, because they depend on libraries/DLLs external to GDAL/OGR.
>>> 
>>> Roger
>>> 
>>>> 
>>>>> ogrDrivers()
>>>>           name write
>>>> 1          AVCBin FALSE
>>>> 2          AVCE00 FALSE
>>>> 3             BNA  TRUE
>>>> 4             CSV  TRUE
>>>> 5             DGN  TRUE
>>>> 6             DXF  TRUE
>>>> 7  ESRI Shapefile  TRUE
>>>> 8      Geoconcept  TRUE
>>>> 9         GeoJSON  TRUE
>>>> 10         GeoRSS  TRUE
>>>> 11            GML  TRUE
>>>> 12            GMT  TRUE
>>>> 13  GPSTrackMaker  TRUE
>>>> 14            GPX  TRUE
>>>> 15            KML  TRUE
>>>> 16   MapInfo File  TRUE
>>>> 17         Memory  TRUE
>>>> 18         PCIDSK FALSE
>>>> 19            REC FALSE
>>>> 20            S57  TRUE
>>>> 21           SDTS FALSE
>>>> 22         SQLite  TRUE
>>>> 23          TIGER  TRUE
>>>> 24        UK .NTF FALSE
>>>> 25            VFK FALSE
>>>> 26            VRT FALSE
>>>> 27         XPlane FALSE
>>>> 
>>>> What am I missing?
>>>> 
>>>> Thank you!
>>>> Germ?n S?nchez
>>>> german.sanchez at esade.edu
>>>> 
>>>> El 08/04/2010, a las 13:17, Carson Farmer escribi?:
>>>> 
>>>>> Hi Germ?n,
>>>>> 
>>>>> Have a look at package rgdal and the readOGR function.
>>>>> 
>>>>>> library(rgdal)
>>>>>> ?readOGR
>>>>> 
>>>>> Here is a link with a quick bit on using rgdal to access a postgis table:
>>>>> http://wiki.intamap.org/index.php/PostGIS
>>>>> 
>>>>> Regards,
>>>>> 
>>>>> Carson
>>>>> 
>>>>> On Thu, Apr 8, 2010 at 11:21 AM, Germ?n S?nchez
>>>>> <german.sanchez at ais-int.com> wrote:
>>>>>> Dear all,
>>>>>> 
>>>>>> I've working with spatial data since only a few months. I know how to
>>>>>> handle this kind of data in R using the sp package. I know how to load
>>>>>> shapes, plot them, merge their polygons, plotting labels, etc.
>>>>>> 
>>>>>> I have installed a postgis database and I can connect to it from R via
>>>>>> RODBC without problems. I can load a shape file (.shp and so) into the
>>>>>> database (command shp2pgsql  to create the needed .sql). It creates a
>>>>>> table with some usual fields (area, perimeter, district, etc) and the
>>>>>> special one: the_geom.
>>>>>> 
>>>>>> Now, I want to load this data to a SpatialPolygon (or
>>>>>> SpatialPolygonDataFrame) object using the RODBC driver. I would like to
>>>>>> get the same object as if I have used the "readShapePoly" function from sp
>>>>>> package directly over the .shp file.
>>>>>> 
>>>>>> Any idea? Is there a direct solution or I have to build the polygon myself?
>>>>>> 
>>>>>> Thank you,
>>>>>> Germ?n S?nchez
>>>>>> german.sanchez at esade.edu
>>>>>> 
>>>>>> _______________________________________________
>>>>>> R-sig-Geo mailing list
>>>>>> R-sig-Geo at stat.math.ethz.ch
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>> 
>>>>> 
>>>>> 
>>>>> 
>>>>> --
>>>>> Carson J. Q. Farmer
>>>>> ISSP Doctoral Fellow
>>>>> National Centre for Geocomputation
>>>>> National University of Ireland, Maynooth,
>>>>> http://www.carsonfarmer.com/
>>>> 
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at stat.math.ethz.ch
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>> 
>>> 
>>> --
>>> Roger Bivand
>>> Economic Geography Section, Department of Economics, Norwegian School of
>>> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>>> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>>> e-mail: Roger.Bivand at nhh.no
>> 
>> 
> 
> -- 
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no


From WRoberts at csir.co.za  Fri Apr 16 08:34:13 2010
From: WRoberts at csir.co.za (Wesley Roberts)
Date: Fri, 16 Apr 2010 08:34:13 +0200
Subject: [R-sig-Geo] Correspondence between gstat and ArcGIS	
	functionality?
In-Reply-To: <3BA0C246-51E0-4B50-879B-F38DAF837726@umontreal.ca>
References: <3BA0C246-51E0-4B50-879B-F38DAF837726@umontreal.ca>
Message-ID: <4BC82105.8E2F.0073.1@csir.co.za>

Hi Jeff,

You may not need to use gstat or indeed R. NASA have kindly developed
the following software to take care of the gaps. Be aware though that
the method requires several images from different dates of the same
area. 

http://landsathandbook.gsfc.nasa.gov/handbook/software/gap_filling_software.html

Alternatively GRASS GIS has a function / module called r.fillnulls
which uses splines interpolation to fill the gaps.

http://grass.itc.it/grass65/manuals/html65_user/r.fillnulls.html 

Hope this helps,

Wesley

Wesley Roberts MSc.
Researcher: Earth Observation
Natural Resources & the Environment (NRE)
CSIR
Tel: +27 (0)21 888-2490
Fax: +27 (0)21 888-2693
"To know the road ahead, ask those coming back."
- Chinese proverb


>>> "Prof. Jeffrey Cardille" <jeffrey.cardille at umontreal.ca> 4/14/2010
9:47 PM >>>
Hello all,

This is my first posting to R-sig-geo; I looked for the answer in the
archives, but have not had any luck for my particular question. 

I have a newbie question about the correspondence between gstat and
ArcGIS.  I have a problem that gives very very satisfying results in
ArcGIS, and I would like to write a public function in R for others to
use that does the same thing.  The choice I used in Arc was "Universal"
and in the dropdown menu it says "Linear with Linear Drift".  My data
matrix is pretty standard:  2000 x 2000, with some NA, and values
between 0 and 255.

So I have a few questions.  Maybe I'll enumerate them.
1. Has anyone made a comprehensive list between ArcGIS functionality
and how to do it in gstat?

2. If not: does anyone know a simple correspondence between what ArcGIS
is doing and how to set up a gstat call for "Universal/Linear with
Linear Drift"?  I have looked online for precise details about Arc's
behavior, but haven't seen anything detailed enough.

3. Are there any tricks in gstat that make interpolation with gstat
especially fast or slow?  For example, if the numbers were treated
faster if they were between 0 and 1, or if NA should be recoded, or if I
should never use a data frame but always a matrix.  That sort of thing.

If not, I'll resort to trial and error and diving deeper into the gstat
documentation.  But it seems like a good idea to check in first.  For
anyone interested, I am trying to repair Landsat satellite photos, which
have big broken strips of nodata due to a mechanical failure.  The
strips are up to 14 pixels wide.  I need to do this 2000x2000
interpolation about 2000 times-- so speed differences of even a few
seconds or minutes are quite important..

Thanks!
Jeff

------------------------------------------
Prof. Jeffrey Cardille
jeffrey.cardille at umontreal.ca 

******************************************************************************************
**  http://www.geog.umontreal.ca :                Web                  
                **
**  http://sites.google.com/site/jeffcardille :   Plans de Cours et
Recherche           **
**                                                                     
                **
**  "Petit ? petit l'oiseau fait son nid ..."    N'h?sitez pas ?
corriger mon fran?ais  **
*********************************************************************************************************
**     D?partement de G?ographie                        **     Bureau: 
                               **
**     assistant professor / professeur adjoint         **     Salle
440                               **
**     Universit? de Montr?al                           **     Pavillon
Strathcona                     **
**     C.P. 6128                                        **     520,
chemin de la C?te-Ste-Catherine    **
**     Succursale Centre-ville                          **    
Montreal, QC H2V 2B8                    **
**     Montr?al, QC, H3C 3J7                            **     T?l?:
(514) 343-8003                    **
*********************************************************************************************************
**
**  Pour aider ? Haiti avec votre int?r?t de g?ographie, visitez:
**  http://groups.google.com/group/udem-geo-aide/ 
**
*********************************************************************************************************





	[[alternative HTML version deleted]]


-- 
This message is subject to the CSIR's copyright terms and conditions, e-mail legal notice, and implemented Open Document Format (ODF) standard. 
The full disclaimer details can be found at http://www.csir.co.za/disclaimer.html.


From hengl at spatial-analyst.net  Fri Apr 16 10:11:04 2010
From: hengl at spatial-analyst.net (Tomislav Hengl)
Date: Fri, 16 Apr 2010 10:11:04 +0200
Subject: [R-sig-Geo] Updated repository of worldmaps (300MB of data at
	5km resolution)
In-Reply-To: <000601cad1a2$d789cd40$869d67c0$@net>
References: <000601cad1a2$d789cd40$869d67c0$@net>
Message-ID: <000001cadd3c$5c0d4430$1427cc90$@net>


FYI: I have now fixed small errors and added few more layers (SOC, LSTD/LSTN, airroute) to the 5 km repository of worldmaps. You can browse the maps available in this repository from:

http://spatial-analyst.net/worldmaps/ 

*for a data description look at: http://spatial-analyst.net/worldmaps/README.txt 
*thumbnail images available at: http://commons.wikimedia.org/wiki/Category:Publicly_available_global_data_sets 

The complete article is available at:

http://spatial-analyst.net/wiki/index.php?title=Global_datasets 
*Loads somewhat slower because of the large amount of PNG images.

Some visualizations using Google Maps/Earth can be found under e.g.:

Google Maps with ground overlay: http://spatial-analyst.net/worldmaps/PCEVI1.htm 
Google Earth preview: http://spatial-analyst.net/worldmaps/worldmaps.kml 

Coming autumn I plan to prepare these maps in higher (1 km) resolution. In fact, most of the maps I already have in the 1 km resolution - the problem is where/in which format to put them (I need at least 5GB of webspace). Then, I will also consider putting the maps into some raster-type data base format such as WKT Raster or Rasdaman (possibly also build closer links with some R package e.g. "raster", "geonames", "maps" etc.), and make procedures to rescale/tile the maps automatically.

All comment/corrections are welcome.

T. Hengl
http://spatial-analyst.net/book/updated_worldmaps
 


> -----Original Message-----
> From: r-sig-geo-bounces at stat.math.ethz.ch [mailto:r-sig-geo-
> bounces at stat.math.ethz.ch] On Behalf Of Tomislav Hengl
> Sent: Thursday, April 01, 2010 3:54 PM
> To: r-sig-geo at stat.math.ethz.ch
> Cc: Caspar.Hallmann at sovon.nl; bob.macmillan at wur.nl; 'Batjes, Niels'
> Subject: [R-sig-Geo] Updated repository of worldmaps (300MB of data at 5km
> resolution)
> 
> 
> Dear R-sig-geo,
> 
> FYI: I have just updated the small repository of publicly available data sets of
> interest for global modeling/mapping that I have launched about a year ago. This
> now contains 62 layers at resolution of 0.05 arcdegrees and with a complete world
> coverage (it use to be 65S-65N only). The data is available for download at
> [http://spatial-analyst.net/worldmaps/]. Each layer comes with a raster
> description file *.rdc, which typically has the same name as the attached layer
> (description of the fields is available in the [http://spatial-
> analyst.net/worldmaps/README.txt]). The raster description file includes also a
> link to an R script that (should) show all processing steps from download to
> export of maps (I advise you to run the scripts step by step because the data
> sets are usually Huge). If you want to read more about what is all available on
> this repository (and outside), please read the complete article [http://spatial-
> analyst.net/wiki/index.php?title=Global_datasets]. You can !
>  also browse a gallery of worldmaps from here:
> 
> http://commons.wikimedia.org/wiki/Publicly_available_global_data_sets#
> 
> Note that some maps have limited geographical coverage (e.g. PCEVI, GLC2000),
> which usually means that the data for polar regions is missing.
> 
> In about 2-3 weeks, I will tidy up the small errors and finalize the maps and
> metadata. If you think that I have maybe missed some important (publicly
> available) layers, please let me know. For example, I have tried to include also
> the map of airline flight paths from
> [http://commons.wikimedia.org/wiki/File:World_airline_routes.png], but could not
> determine coordinate system, lineage etc. I am sure that there is much more what
> is available (on and off the web), but I would at least try to be representative.
> 
> My next project will be to prepare the 1 km data (about 70% of maps listed are
> available also in this resolution) and put them into some database format such as
> WKT raster or rasdaman. This way anybody will be able to overlay point, line,
> polygon features and fetch only the results of queries from the server. But it
> looks as this will take more time than I have initially anticipated.
> 
> 
> ARE THESE MAPS JUST COPIES?
> Many of the layers listed (cca 20-30%) are simply resampled and reformatted maps
> that are already available from the original providers (e.g. pcclim, GLC2000,
> himpact etc.). The great majority of maps are basically original layers that you
> will not be able to find elsewhere. For example, PCEVI1 is the 1st Principal
> Component of the total time-series of monthly MODIS EVI bands (this image
> basically shows the average long-term 'biomass' in the world). If you wish to
> cite some of the maps I have prepared, then you should refer to the chapter #4 in
> my book [http://spatial-analyst.net/book/DataSources], otherwise I advise you to
> refer to the original data providers.
> Each *.rdc file contains information about the data source, including the link to
> where you can find the source data and peer-reviewed publication that describes
> the dataset.
> Personally, I find it frustrating that there are several global mapping projects
> in the world that overlap (for example, there are at least four global land cover
> maps!). In some cases I solve the problem by simply taking the average (e.g.
> globedem is a an average between two maps), but the categorical maps cannot be
> average as easy. My second frustration are the license and copyright problems.
> Some data producers (usually the USA mapping agencies) have a very clear policy
> and even support copying and distribution of the maps they produce (provided that
> the source is acknowledged); others (e.g. himpacts) are not really clear. I am
> only interested in processing and organizing the publicly available data.
> 
> 
> MEMORY LIMIT PROBLEMS
> Going from 10 km to 5 km resolution brought me to many technical headaches. Just
> to download the input data takes about one week (the input data I used to
> generate the 62 layers, now of size 300MB, is about 500GB!). Each layer now has
> cca 26M pixels, which will obviously lead to many memory and computational limit
> problems. For example, I doubt it that you will be able to load these data into R
> on a standard PC (2-4GB RAM) or visualize the maps using spplot. I also tried to
> derive some DEM parameters such as SAGA TWI, height above channel channels etc,
> but the maps are simply too big (processing takes >24 hours), so it is very
> likely that you will also face memory limit and computational problems on your
> computers. PS: I used a Dell 2.8GHz with dual processor and 64Bit Window XP OS
> with 4GB of RAM to run processing, and this configuration was already on the
> edge.
> 
> I am really thankful to Frank Warmerdam and colleagues for providing excellent
> utilities [http://www.gdal.org/gdal_utilities.html] which I heavily used to
> prepare the maps. I actually did run a small comparison between the gdalwarp
> utility and Erdas Imagine and ArcGIS and discovered that gdal utilities are (1)
> faster and (2) more easy to script (+ you have a support for proj4 strings and
> largest family of GIS data formats). The second on my list was SAGA GIS, which
> can also crunch Huge data (up to 2GB) and has a large library of GIS operations.
> I highly recommend these two programs and would support further development very
> much. In some cases, I could not find any functionality for the analysis in gdal
> utilities and SAGA, so I used ILWIS GIS (e.g. to run principle component analysis
> and to extract density of lines and point features). Unfortunately linking of R
> and ILWIS is not as smooth, so I often finished running part of the analysis in
> ILWIS separately. This is just an !
>  important information for the people that will focus only on using the R
> scripts.
> 
> I am looking forward to your feedback and further comments.
> 
> A copy of this mail in html format (you can insert comments below) is also
> available here:
> 
> http://spatial-analyst.net/book/updated_worldmaps
> 
> yours,
> 
> T. Hengl
> http://home.medewerker.uva.nl/t.hengl/
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From german.sanchez at ais-int.com  Fri Apr 16 13:26:20 2010
From: german.sanchez at ais-int.com (German Sanchez Hernandez)
Date: Fri, 16 Apr 2010 13:26:20 +0200
Subject: [R-sig-Geo] Shape to DB, DB to SpatialPolygon (solved!)
In-Reply-To: <alpine.LRH.2.00.1004151841170.11249@reclus.nhh.no>
References: <52383.10.10.2.41.1270722081.squirrel@hermes.ais-int.net>
	<r2t94b3c8441004080417o5a080b77u3cbc7bebc7b6df5c@mail.gmail.com>
	<AE1B56AF-35F3-4E48-8C0D-9EB654260625@ais-int.com>
	<alpine.LRH.2.00.1004121905130.31324@reclus.nhh.no>
	<5062CBFF-1360-421A-BC95-17447049DA20@ais-int.com>
	<alpine.LRH.2.00.1004151841170.11249@reclus.nhh.no>
Message-ID: <6845950C-D85D-4E60-89C9-F5B3ACE6FE52@ais-int.com>

Hi again!

I finally have solved my issue (enabling postgreSQL driver in (r)gdal)!

All I had to do is uninstall gdal (make clean) and install again with the correct opciones (./configure [...] --with-pg=/usr/bin/pg_config).

Thank you and regards,
Germ?n S?nchez

El 15/04/2010, a las 18:44, Roger Bivand escribi?:

> On Thu, 15 Apr 2010, German Sanchez Hernandez wrote:
> 
> Please don't write to me directly on a posted list topic. I'm at a conference in a different time zone, have to pay for internet access, and don't use PostgreSQL myself. If you put my name as To:, other helpers will think that I'm helping and not do so themselves. The only thing that I can think of is that OGR drivers need the dependent *.so to be on the load path - did you add the PG library directory to the list searched by ldconfig?
> 
> Roger
> 
>> Other thing:
>> 
>> If I see the config.log file located in the folder which has the source of gdal, it seems PG driver is correctly installed!
>> 
>> config.log (extract):
>> 
>> $ ./configure --with-static-proj4=/usr/local/lib --with-threads --with-libtiff=internal --with-geotiff=internal --with-jpeg=internal --with-gif=internal --with-png=internal --with-libz=internal --without-expat --without-jasper --without-ecw --without-curl --without-dwgdirect --without-mrsid --without-jp2mrsid --without-mysql --without-odbc --without-grib --with-ogr --with-pg=/usr/bin/pg_config
>> HAVE_PG='yes'
>> PG_CONFIG='/usr/bin/pg_config'
>> PG_INC='-I/usr/include -I/usr/include/pgsql/server  -DPG_HAS_PQESCAPESTRINGCONN'
>> PG_LIB=''
>> 
>> 
>> El 12/04/2010, a las 19:14, Roger Bivand escribi?:
>> 
>>> On Mon, 12 Apr 2010, Germ?n S?nchez Hern?ndez wrote:
>>> 
>>>> Hi Carson (and list!),
>>>> 
>>>> I have corretly installed rgdal package in R (with some initial problems but finally working).
>>>> 
>>>> If I run ogrDrivers() no driver for PostgreSQL is listed (remember that the postgresql database is correctly running with the PostGIS extension, and I can connect through RODBC package):
>>> 
>>> The OGR driver will only be present if you have built OGR with PostGIS enabled. If you use the CRAN Windows 32-bit binary, or the CRAN extras OSX 32-bit or Windows 64-bit binaries, the driver is not included. To use PostGIS with OGR, install GDAL with PostGIS enabled, and check with:
>>> 
>>> $ ogrinfo --formats
>>> 
>>> Until you see PostGIS/PostgreSQL there, you will not see it inside R either, having installed rgdal from source. Using PostGIS effectively presupposes that you have some experience in installing software from source, and that your platform has the necessary build trains; these kinds of things rarely work "out of the box". The rgdal package as a binary has most commonly used drivers, and more will not be added, because they depend on libraries/DLLs external to GDAL/OGR.
>>> 
>>> Roger
>>> 
>>>> 
>>>>> ogrDrivers()
>>>>           name write
>>>> 1          AVCBin FALSE
>>>> 2          AVCE00 FALSE
>>>> 3             BNA  TRUE
>>>> 4             CSV  TRUE
>>>> 5             DGN  TRUE
>>>> 6             DXF  TRUE
>>>> 7  ESRI Shapefile  TRUE
>>>> 8      Geoconcept  TRUE
>>>> 9         GeoJSON  TRUE
>>>> 10         GeoRSS  TRUE
>>>> 11            GML  TRUE
>>>> 12            GMT  TRUE
>>>> 13  GPSTrackMaker  TRUE
>>>> 14            GPX  TRUE
>>>> 15            KML  TRUE
>>>> 16   MapInfo File  TRUE
>>>> 17         Memory  TRUE
>>>> 18         PCIDSK FALSE
>>>> 19            REC FALSE
>>>> 20            S57  TRUE
>>>> 21           SDTS FALSE
>>>> 22         SQLite  TRUE
>>>> 23          TIGER  TRUE
>>>> 24        UK .NTF FALSE
>>>> 25            VFK FALSE
>>>> 26            VRT FALSE
>>>> 27         XPlane FALSE
>>>> 
>>>> What am I missing?
>>>> 
>>>> Thank you!
>>>> Germ?n S?nchez
>>>> german.sanchez at esade.edu
>>>> 
>>>> El 08/04/2010, a las 13:17, Carson Farmer escribi?:
>>>> 
>>>>> Hi Germ?n,
>>>>> 
>>>>> Have a look at package rgdal and the readOGR function.
>>>>> 
>>>>>> library(rgdal)
>>>>>> ?readOGR
>>>>> 
>>>>> Here is a link with a quick bit on using rgdal to access a postgis table:
>>>>> http://wiki.intamap.org/index.php/PostGIS
>>>>> 
>>>>> Regards,
>>>>> 
>>>>> Carson
>>>>> 
>>>>> On Thu, Apr 8, 2010 at 11:21 AM, Germ?n S?nchez
>>>>> <german.sanchez at ais-int.com> wrote:
>>>>>> Dear all,
>>>>>> 
>>>>>> I've working with spatial data since only a few months. I know how to
>>>>>> handle this kind of data in R using the sp package. I know how to load
>>>>>> shapes, plot them, merge their polygons, plotting labels, etc.
>>>>>> 
>>>>>> I have installed a postgis database and I can connect to it from R via
>>>>>> RODBC without problems. I can load a shape file (.shp and so) into the
>>>>>> database (command shp2pgsql  to create the needed .sql). It creates a
>>>>>> table with some usual fields (area, perimeter, district, etc) and the
>>>>>> special one: the_geom.
>>>>>> 
>>>>>> Now, I want to load this data to a SpatialPolygon (or
>>>>>> SpatialPolygonDataFrame) object using the RODBC driver. I would like to
>>>>>> get the same object as if I have used the "readShapePoly" function from sp
>>>>>> package directly over the .shp file.
>>>>>> 
>>>>>> Any idea? Is there a direct solution or I have to build the polygon myself?
>>>>>> 
>>>>>> Thank you,
>>>>>> Germ?n S?nchez
>>>>>> german.sanchez at esade.edu
>>>>>> 
>>>>>> _______________________________________________
>>>>>> R-sig-Geo mailing list
>>>>>> R-sig-Geo at stat.math.ethz.ch
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>> 
>>>>> 
>>>>> 
>>>>> 
>>>>> --
>>>>> Carson J. Q. Farmer
>>>>> ISSP Doctoral Fellow
>>>>> National Centre for Geocomputation
>>>>> National University of Ireland, Maynooth,
>>>>> http://www.carsonfarmer.com/
>>>> 
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at stat.math.ethz.ch
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>> 
>>> 
>>> --
>>> Roger Bivand
>>> Economic Geography Section, Department of Economics, Norwegian School of
>>> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>>> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>>> e-mail: Roger.Bivand at nhh.no
>> 
>> 
> 
> -- 
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no


From vkepoglu at gmail.com  Fri Apr 16 18:56:46 2010
From: vkepoglu at gmail.com (Volkan Kepoglu)
Date: Fri, 16 Apr 2010 19:56:46 +0300
Subject: [R-sig-Geo] convertion delaunay triangulation to SpatialPolygons
Message-ID: <w2y8b5938321004160956t50d18470l9157af036661fcbd@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100416/47badf9a/attachment.pl>

From patrick.giraudoux at univ-fcomte.fr  Sat Apr 17 11:48:42 2010
From: patrick.giraudoux at univ-fcomte.fr (Patrick Giraudoux)
Date: Sat, 17 Apr 2010 11:48:42 +0200
Subject: [R-sig-Geo] sp, area and SpatialPolygons
Message-ID: <4BC983FA.2020201@univ-fcomte.fr>


I did not find a function in sp to extract area from SpatialPolygons 
objects. Thus I was thinking about writing some function to do the job 
similar to the functions written in order to extract lengths from 
SpatialLines objects (see ?SpatialLines). I have incidentally discovered 
a strange thing. Let us define a list of 3 polygons:

   polylist <- list(structure(c(180016, 180034, 180452, 180588, 180615, 
180533,
     180225, 180016, 332182, 331756, 331774, 332074, 332418, 332518,
     332319, 332182), .Dim = c(8L, 2L)), structure(c(179907, 180325,
     180397, 180152, 179781, 179672, 179735, 179907, 331611, 331611,
     331266, 330931, 330967, 331266, 331466, 331611), .Dim = c(8L,
     2L)), structure(c(179499, 179971, 180343, 180161, 179753, 179418,
     179499, 330577, 330768, 330468, 330096, 330078, 330369, 330577
     ), .Dim = c(7L, 2L)))

And make a simple SpatialPolygons object with them:

 SP<-SpatialPolygons(list(Polygons(list(Polygon(polylist[[1]])),ID="P1"),Polygons(list(Polygon(polylist[[2]])),ID="P2"),Polygons(list(Polygon(polylist[[3]])),ID="P3")),pO=as.integer(c(1,2,3)))
  
It looks like if the area of Polygons #1 was not computed:

SP at polygons[[1]]@area
[1] 0

Whilst the area of the Polygons are:

 SP at polygons[[1]]@Polygons[[1]]@area
[1] 322111

However, no trouble with the next Polygons:
 > SP at polygons[[2]]@area
[1] 384740
 > SP at polygons[[2]]@Polygons[[1]]@area
[1] 384740
 > SP at polygons[[3]]@area
[1] 423937
 > SP at polygons[[3]]@Polygons[[1]]@area
[1] 423937

Did I do something wrong, miss something or is there a bug in the 
SpatialPolygons function ?

Patrick


From sidney86_115 at hotmail.com  Sat Apr 17 17:37:15 2010
From: sidney86_115 at hotmail.com (Sidney Bernal)
Date: Sat, 17 Apr 2010 10:37:15 -0500
Subject: [R-sig-Geo] Variogram models in gstat
Message-ID: <SNT117-W61894D6D8AA733D868DD48A70D0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100417/51680b0e/attachment.pl>

From edzer.pebesma at uni-muenster.de  Sat Apr 17 18:47:43 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sat, 17 Apr 2010 18:47:43 +0200
Subject: [R-sig-Geo] Variogram models in gstat
In-Reply-To: <SNT117-W61894D6D8AA733D868DD48A70D0@phx.gbl>
References: <SNT117-W61894D6D8AA733D868DD48A70D0@phx.gbl>
Message-ID: <4BC9E62F.1090607@uni-muenster.de>

Most of them can be found on page 38 of http://www.gstat.org/gstat.pdf

The Mat / Ste models are e.g. described in M. Stein, "Interpolation of
Spatial Data: Some Theory for Kriging", Springer.

Let me know if there are further descriptions missing.
--
Edzer

Sidney Bernal wrote:
> 
>  
> Good Morning
> 
> Today I make a geostatistics course, so I'm using R 2.10.1 and I am writing to ask the please of the mathematical formulas of the 19 models of covariogram variogram programmed in the gstat package.
>  
>    short                                      long
> 1    Nug                              Nug (nugget)
> 2    Exp                         Exp (exponential)
> 3    Sph                           Sph (spherical)
> 4    Gau                            Gau (gaussian)
> 5    Exc               Exclass (Exponential class)
> 6    Mat                              Mat (Matern)
> 7    Ste Mat (Matern, M. Stein's parameterization)
> 8    Cir                            Cir (circular)
> 9    Lin                              Lin (linear)
> 10   Bes                              Bes (bessel)
> 11   Pen                      Pen (pentaspherical)
> 12   Per                            Per (periodic)
> 13   Hol                                Hol (hole)
> 14   Log                         Log (logarithmic)
> 15   Pow                               Pow (power)
> 16   Spl                              Spl (spline)
> 17   Leg                            Leg (Legendre)
> 18   Err                   Err (Measurement error)
> 19   Int                           Int (Intercept)
>  
> Awaiting your prompt response.
>  
> Sidney Bernal
> sidney86_115 at hotmail.com
> 
>  
>  
> Sidney Bernal
> 
>  		 	   		  
> _________________________________________________________________
> 
> 
> e=wlmailtagline
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From Roger.Bivand at nhh.no  Sat Apr 17 21:26:35 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 17 Apr 2010 21:26:35 +0200 (CEST)
Subject: [R-sig-Geo] sp, area and SpatialPolygons
In-Reply-To: <4BC983FA.2020201@univ-fcomte.fr>
References: <4BC983FA.2020201@univ-fcomte.fr>
Message-ID: <alpine.LRH.2.00.1004172120140.18699@reclus.nhh.no>

On Sat, 17 Apr 2010, Patrick Giraudoux wrote:

>
> I did not find a function in sp to extract area from SpatialPolygons objects. 
> Thus I was thinking about writing some function to do the job similar to the 
> functions written in order to extract lengths from SpatialLines objects (see 
> ?SpatialLines). I have incidentally discovered a strange thing. Let us define 
> a list of 3 polygons:
>
>  polylist <- list(structure(c(180016, 180034, 180452, 180588, 180615, 
> 180533,
>    180225, 180016, 332182, 331756, 331774, 332074, 332418, 332518,
>    332319, 332182), .Dim = c(8L, 2L)), structure(c(179907, 180325,
>    180397, 180152, 179781, 179672, 179735, 179907, 331611, 331611,
>    331266, 330931, 330967, 331266, 331466, 331611), .Dim = c(8L,
>    2L)), structure(c(179499, 179971, 180343, 180161, 179753, 179418,
>    179499, 330577, 330768, 330468, 330096, 330078, 330369, 330577
>    ), .Dim = c(7L, 2L)))
>
> And make a simple SpatialPolygons object with them:
>
> SP<-SpatialPolygons(list(Polygons(list(Polygon(polylist[[1]])),ID="P1"),Polygons(list(Polygon(polylist[[2]])),ID="P2"),Polygons(list(Polygon(polylist[[3]])),ID="P3")),pO=as.integer(c(1,2,3)))
> It looks like if the area of Polygons #1 was not computed:

Patrick,

There is a bug, not not a simple one. The ring direction of your first 
Polygon object signals that it is a hole, but in Polygons(), singleton 
holes are made into islands, and the largest hole in an all-hole list of 
Polygon objects is also made into an island. The bug was that the hole 
vector used for assigning the area had not been updated, so the area slot 
in the Polygons object was assigned 0 (because it was still treated as a 
hole). Had you said hole=FALSE for P1, it would have been OK. The updating 
is now in place.

Thanks,

Roger

>
> SP at polygons[[1]]@area
> [1] 0
>
> Whilst the area of the Polygons are:
>
> SP at polygons[[1]]@Polygons[[1]]@area
> [1] 322111
>
> However, no trouble with the next Polygons:
>> SP at polygons[[2]]@area
> [1] 384740
>> SP at polygons[[2]]@Polygons[[1]]@area
> [1] 384740
>> SP at polygons[[3]]@area
> [1] 423937
>> SP at polygons[[3]]@Polygons[[1]]@area
> [1] 423937
>
> Did I do something wrong, miss something or is there a bug in the 
> SpatialPolygons function ?
>
> Patrick
>
>
>
>
>
>
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Thomas.Adams at noaa.gov  Sat Apr 17 23:05:03 2010
From: Thomas.Adams at noaa.gov (Thomas Adams)
Date: Sat, 17 Apr 2010 17:05:03 -0400
Subject: [R-sig-Geo] Help needed with spplot
In-Reply-To: <201004131303.59881.dylan.beaudette@gmail.com>
References: <4BC4C966.9030608@noaa.gov>
	<201004131303.59881.dylan.beaudette@gmail.com>
Message-ID: <4BCA227F.1020802@noaa.gov>

Dylan,

Thank you for the suggestion and it did help. But, I think another 
problem is the way spplot handles drawing off-screen. This does not seem 
to be handled well. Ultimately, I was able to find a generalized 
shapefile of the CONUS (48) states; this draws tolerably well. I 
conducted a few little experiments?

I think the moral of the story is to restrict the vector map to the area 
one is interested in and not to be sloppy. I'm still trying to grasp the 
subtleties of v.generalize?

Thanks again,
Tom

Dylan Beaudette wrote:
> On Tuesday 13 April 2010, Thomas Adams wrote:
>   
>> All:
>>
>> I'm using GRASS 6.4 with R 2.9.2 and sp/spgrass6. When plotting a vector
>> file, read in from GRASS, using spplot, the drawing takes many minutes
>> to complete. Apart from the fact that the vector file is probably more
>> detailed than I need, I know time is spent drawing off-screen. I tried
>> specifying xlim & ylim, but, of course, this just zooms into the area
>> I'm mapping, and does not solve my underlying problem.
>>
>> I also tried using pruneMap(), but this did not seem to make any
>> difference in the length of time before my R prompt returned. By
>> contrast, GRASS re-draws very fast, within a few seconds instead of ~5
>> minutes. I want to use spplot to draw an array of maps (21), so 1+ hours
>> will not work for what I am doing.
>>
>> Any thoughts how I might speed-up the process?
>>
>> Regards,
>> Tom
>>     
>
> Hi Tom,
>
> What kind of vector data are you plotting? Probably not points. If you are 
> working with very detailed lines or polygons, I would suggest simplifying 
> them in GRASS first. In GRASS 6.4, v.clean is the module of choice. If you 
> can get GRASS 6.5, then v.generalize will work even better. Note that you 
> need to work on boundaries with v.generalize, and too much "pruning" will 
> result in broken topology.
>
> I recently used an incantation like this:
> v.generalize in=ca_counties out=ca_counties_simple type=boundary  
> method=douglas_reduction threshold=1000
>
> ... to reduce the number of vertices in a map of CA counties, so that I could 
> plot it with spplot().
>
> Cheers,
> Dylan
>
>   


-- 
Thomas E Adams
National Weather Service
Ohio River Forecast Center
1901 South State Route 134
Wilmington, OH 45177

EMAIL:	thomas.adams at noaa.gov

VOICE:	937-383-0528
FAX:	937-383-0033


From patrick.giraudoux at univ-fcomte.fr  Sun Apr 18 08:41:47 2010
From: patrick.giraudoux at univ-fcomte.fr (Patrick Giraudoux)
Date: Sun, 18 Apr 2010 08:41:47 +0200
Subject: [R-sig-Geo] sp, area and SpatialPolygons
In-Reply-To: <alpine.LRH.2.00.1004172120140.18699@reclus.nhh.no>
References: <4BC983FA.2020201@univ-fcomte.fr>
	<alpine.LRH.2.00.1004172120140.18699@reclus.nhh.no>
Message-ID: <4BCAA9AB.6010006@univ-fcomte.fr>

Except this inexpected 'bug' discovery point the fact that I draw the 
hole inadvertently ! I wanted to draw standards polygons but did the 
first counterclockwise (so a hole...)... Chaos added to chaos = bug fix. 
Let us call that the French wine method... hips !

Anyway, thanks a lot Roger,

Cheers,

Patrick






Roger Bivand a ?crit :
> On Sat, 17 Apr 2010, Patrick Giraudoux wrote:
>
>>
>> I did not find a function in sp to extract area from SpatialPolygons 
>> objects. Thus I was thinking about writing some function to do the 
>> job similar to the functions written in order to extract lengths from 
>> SpatialLines objects (see ?SpatialLines). I have incidentally 
>> discovered a strange thing. Let us define a list of 3 polygons:
>>
>>  polylist <- list(structure(c(180016, 180034, 180452, 180588, 180615, 
>> 180533,
>>    180225, 180016, 332182, 331756, 331774, 332074, 332418, 332518,
>>    332319, 332182), .Dim = c(8L, 2L)), structure(c(179907, 180325,
>>    180397, 180152, 179781, 179672, 179735, 179907, 331611, 331611,
>>    331266, 330931, 330967, 331266, 331466, 331611), .Dim = c(8L,
>>    2L)), structure(c(179499, 179971, 180343, 180161, 179753, 179418,
>>    179499, 330577, 330768, 330468, 330096, 330078, 330369, 330577
>>    ), .Dim = c(7L, 2L)))
>>
>> And make a simple SpatialPolygons object with them:
>>
>> SP<-SpatialPolygons(list(Polygons(list(Polygon(polylist[[1]])),ID="P1"),Polygons(list(Polygon(polylist[[2]])),ID="P2"),Polygons(list(Polygon(polylist[[3]])),ID="P3")),pO=as.integer(c(1,2,3))) 
>>
>> It looks like if the area of Polygons #1 was not computed:
>
> Patrick,
>
> There is a bug, not not a simple one. The ring direction of your first 
> Polygon object signals that it is a hole, but in Polygons(), singleton 
> holes are made into islands, and the largest hole in an all-hole list 
> of Polygon objects is also made into an island. The bug was that the 
> hole vector used for assigning the area had not been updated, so the 
> area slot in the Polygons object was assigned 0 (because it was still 
> treated as a hole). Had you said hole=FALSE for P1, it would have been 
> OK. The updating is now in place.
>
> Thanks,
>
> Roger
>
>>
>> SP at polygons[[1]]@area
>> [1] 0
>>
>> Whilst the area of the Polygons are:
>>
>> SP at polygons[[1]]@Polygons[[1]]@area
>> [1] 322111
>>
>> However, no trouble with the next Polygons:
>>> SP at polygons[[2]]@area
>> [1] 384740
>>> SP at polygons[[2]]@Polygons[[1]]@area
>> [1] 384740
>>> SP at polygons[[3]]@area
>> [1] 423937
>>> SP at polygons[[3]]@Polygons[[1]]@area
>> [1] 423937
>>
>> Did I do something wrong, miss something or is there a bug in the 
>> SpatialPolygons function ?
>>
>> Patrick
>>
>>
>>
>>
>>
>>
>>
>>
>


From yong.li at unimelb.edu.au  Sun Apr 18 12:53:56 2010
From: yong.li at unimelb.edu.au (Yong Li)
Date: Sun, 18 Apr 2010 20:53:56 +1000
Subject: [R-sig-Geo] Use estimateAnisotropy by intamap package
References: <mailman.7.1271584802.20987.r-sig-geo@stat.math.ethz.ch>
Message-ID: <86DBA0678E017341B449A62F258E2956386D1A@IS-EX-BEV3.unimelb.edu.au>

Dear All,

I tried to inspect the geometric anisotropy by using the function of estimateAnisotropy with parameter "formulaString" in intamap, but never worked.
Any help will be highly appreciated. 

Cheers,

Yong


-----Original Message-----
From: r-sig-geo-bounces at stat.math.ethz.ch ?? r-sig-geo-request at stat.math.ethz.ch
Sent: 2010-4-18 (???) 20:00
To: r-sig-geo at stat.math.ethz.ch
Subject: R-sig-Geo Digest, Vol 80, Issue 18
 
Send R-sig-Geo mailing list submissions to
	r-sig-geo at stat.math.ethz.ch

To subscribe or unsubscribe via the World Wide Web, visit
	https://stat.ethz.ch/mailman/listinfo/r-sig-geo
or, via email, send a message with subject or body 'help' to
	r-sig-geo-request at stat.math.ethz.ch

You can reach the person managing the list at
	r-sig-geo-owner at stat.math.ethz.ch

When replying, please edit your Subject line so it is more specific
than "Re: Contents of R-sig-Geo digest..."


Today's Topics:

   1. Variogram models in gstat (Sidney Bernal)
   2. Re: Variogram models in gstat (Edzer Pebesma)
   3. Re: sp, area and SpatialPolygons (Roger Bivand)
   4. Re: Help needed with spplot (Thomas Adams)
   5. Re: sp, area and SpatialPolygons (Patrick Giraudoux)


----------------------------------------------------------------------

Message: 1
Date: Sat, 17 Apr 2010 10:37:15 -0500
From: Sidney Bernal <sidney86_115 at hotmail.com>
To: <r-sig-geo at stat.math.ethz.ch>, Sidney Bernal
	<sidney86_115 at hotmail.com>
Subject: [R-sig-Geo] Variogram models in gstat
Message-ID: <SNT117-W61894D6D8AA733D868DD48A70D0 at phx.gbl>
Content-Type: text/plain




Good Morning

Today I make a geostatistics course, so I'm using R 2.10.1 and I am writing to ask the please of the mathematical formulas of the 19 models of covariogram variogram programmed in the gstat package.

   short                                      long
1    Nug                              Nug (nugget)
2    Exp                         Exp (exponential)
3    Sph                           Sph (spherical)
4    Gau                            Gau (gaussian)
5    Exc               Exclass (Exponential class)
6    Mat                              Mat (Matern)
7    Ste Mat (Matern, M. Stein's parameterization)
8    Cir                            Cir (circular)
9    Lin                              Lin (linear)
10   Bes                              Bes (bessel)
11   Pen                      Pen (pentaspherical)
12   Per                            Per (periodic)
13   Hol                                Hol (hole)
14   Log                         Log (logarithmic)
15   Pow                               Pow (power)
16   Spl                              Spl (spline)
17   Leg                            Leg (Legendre)
18   Err                   Err (Measurement error)
19   Int                           Int (Intercept)

Awaiting your prompt response.

Sidney Bernal
sidney86_115 at hotmail.com



Sidney Bernal

 		 	   		  
_________________________________________________________________


e=wlmailtagline
	[[alternative HTML version deleted]]



------------------------------

Message: 2
Date: Sat, 17 Apr 2010 18:47:43 +0200
From: Edzer Pebesma <edzer.pebesma at uni-muenster.de>
To: Sidney Bernal <sidney86_115 at hotmail.com>
Cc: r-sig-geo at stat.math.ethz.ch
Subject: Re: [R-sig-Geo] Variogram models in gstat
Message-ID: <4BC9E62F.1090607 at uni-muenster.de>
Content-Type: text/plain; charset=ISO-8859-1

Most of them can be found on page 38 of http://www.gstat.org/gstat.pdf

The Mat / Ste models are e.g. described in M. Stein, "Interpolation of
Spatial Data: Some Theory for Kriging", Springer.

Let me know if there are further descriptions missing.
--
Edzer

Sidney Bernal wrote:
> 
>  
> Good Morning
> 
> Today I make a geostatistics course, so I'm using R 2.10.1 and I am writing to ask the please of the mathematical formulas of the 19 models of covariogram variogram programmed in the gstat package.
>  
>    short                                      long
> 1    Nug                              Nug (nugget)
> 2    Exp                         Exp (exponential)
> 3    Sph                           Sph (spherical)
> 4    Gau                            Gau (gaussian)
> 5    Exc               Exclass (Exponential class)
> 6    Mat                              Mat (Matern)
> 7    Ste Mat (Matern, M. Stein's parameterization)
> 8    Cir                            Cir (circular)
> 9    Lin                              Lin (linear)
> 10   Bes                              Bes (bessel)
> 11   Pen                      Pen (pentaspherical)
> 12   Per                            Per (periodic)
> 13   Hol                                Hol (hole)
> 14   Log                         Log (logarithmic)
> 15   Pow                               Pow (power)
> 16   Spl                              Spl (spline)
> 17   Leg                            Leg (Legendre)
> 18   Err                   Err (Measurement error)
> 19   Int                           Int (Intercept)
>  
> Awaiting your prompt response.
>  
> Sidney Bernal
> sidney86_115 at hotmail.com
> 
>  
>  
> Sidney Bernal
> 
>  		 	   		  
> _________________________________________________________________
> 
> 
> e=wlmailtagline
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de



------------------------------

Message: 3
Date: Sat, 17 Apr 2010 21:26:35 +0200 (CEST)
From: Roger Bivand <Roger.Bivand at nhh.no>
To: Patrick Giraudoux <patrick.giraudoux at univ-fcomte.fr>
Cc: Edzer Pebesma <e.pebesma at gmail.com>, r-sig-geo at stat.math.ethz.ch
Subject: Re: [R-sig-Geo] sp, area and SpatialPolygons
Message-ID: <alpine.LRH.2.00.1004172120140.18699 at reclus.nhh.no>
Content-Type: TEXT/PLAIN; charset=US-ASCII; format=flowed

On Sat, 17 Apr 2010, Patrick Giraudoux wrote:

>
> I did not find a function in sp to extract area from SpatialPolygons objects. 
> Thus I was thinking about writing some function to do the job similar to the 
> functions written in order to extract lengths from SpatialLines objects (see 
> ?SpatialLines). I have incidentally discovered a strange thing. Let us define 
> a list of 3 polygons:
>
>  polylist <- list(structure(c(180016, 180034, 180452, 180588, 180615, 
> 180533,
>    180225, 180016, 332182, 331756, 331774, 332074, 332418, 332518,
>    332319, 332182), .Dim = c(8L, 2L)), structure(c(179907, 180325,
>    180397, 180152, 179781, 179672, 179735, 179907, 331611, 331611,
>    331266, 330931, 330967, 331266, 331466, 331611), .Dim = c(8L,
>    2L)), structure(c(179499, 179971, 180343, 180161, 179753, 179418,
>    179499, 330577, 330768, 330468, 330096, 330078, 330369, 330577
>    ), .Dim = c(7L, 2L)))
>
> And make a simple SpatialPolygons object with them:
>
> SP<-SpatialPolygons(list(Polygons(list(Polygon(polylist[[1]])),ID="P1"),Polygons(list(Polygon(polylist[[2]])),ID="P2"),Polygons(list(Polygon(polylist[[3]])),ID="P3")),pO=as.integer(c(1,2,3)))
> It looks like if the area of Polygons #1 was not computed:

Patrick,

There is a bug, not not a simple one. The ring direction of your first 
Polygon object signals that it is a hole, but in Polygons(), singleton 
holes are made into islands, and the largest hole in an all-hole list of 
Polygon objects is also made into an island. The bug was that the hole 
vector used for assigning the area had not been updated, so the area slot 
in the Polygons object was assigned 0 (because it was still treated as a 
hole). Had you said hole=FALSE for P1, it would have been OK. The updating 
is now in place.

Thanks,

Roger

>
> SP at polygons[[1]]@area
> [1] 0
>
> Whilst the area of the Polygons are:
>
> SP at polygons[[1]]@Polygons[[1]]@area
> [1] 322111
>
> However, no trouble with the next Polygons:
>> SP at polygons[[2]]@area
> [1] 384740
>> SP at polygons[[2]]@Polygons[[1]]@area
> [1] 384740
>> SP at polygons[[3]]@area
> [1] 423937
>> SP at polygons[[3]]@Polygons[[1]]@area
> [1] 423937
>
> Did I do something wrong, miss something or is there a bug in the 
> SpatialPolygons function ?
>
> Patrick
>
>
>
>
>
>
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



------------------------------

Message: 4
Date: Sat, 17 Apr 2010 17:05:03 -0400
From: Thomas Adams <Thomas.Adams at noaa.gov>
To: dylan.beaudette at gmail.com
Cc: r-sig-geo at stat.math.ethz.ch
Subject: Re: [R-sig-Geo] Help needed with spplot
Message-ID: <4BCA227F.1020802 at noaa.gov>
Content-Type: text/plain; charset=windows-1252; format=flowed

Dylan,

Thank you for the suggestion and it did help. But, I think another 
problem is the way spplot handles drawing off-screen. This does not seem 
to be handled well. Ultimately, I was able to find a generalized 
shapefile of the CONUS (48) states; this draws tolerably well. I 
conducted a few little experiments?

I think the moral of the story is to restrict the vector map to the area 
one is interested in and not to be sloppy. I'm still trying to grasp the 
subtleties of v.generalize?

Thanks again,
Tom

Dylan Beaudette wrote:
> On Tuesday 13 April 2010, Thomas Adams wrote:
>   
>> All:
>>
>> I'm using GRASS 6.4 with R 2.9.2 and sp/spgrass6. When plotting a vector
>> file, read in from GRASS, using spplot, the drawing takes many minutes
>> to complete. Apart from the fact that the vector file is probably more
>> detailed than I need, I know time is spent drawing off-screen. I tried
>> specifying xlim & ylim, but, of course, this just zooms into the area
>> I'm mapping, and does not solve my underlying problem.
>>
>> I also tried using pruneMap(), but this did not seem to make any
>> difference in the length of time before my R prompt returned. By
>> contrast, GRASS re-draws very fast, within a few seconds instead of ~5
>> minutes. I want to use spplot to draw an array of maps (21), so 1+ hours
>> will not work for what I am doing.
>>
>> Any thoughts how I might speed-up the process?
>>
>> Regards,
>> Tom
>>     
>
> Hi Tom,
>
> What kind of vector data are you plotting? Probably not points. If you are 
> working with very detailed lines or polygons, I would suggest simplifying 
> them in GRASS first. In GRASS 6.4, v.clean is the module of choice. If you 
> can get GRASS 6.5, then v.generalize will work even better. Note that you 
> need to work on boundaries with v.generalize, and too much "pruning" will 
> result in broken topology.
>
> I recently used an incantation like this:
> v.generalize in=ca_counties out=ca_counties_simple type=boundary 
> method=douglas_reduction threshold=1000
>
> ... to reduce the number of vertices in a map of CA counties, so that I could 
> plot it with spplot().
>
> Cheers,
> Dylan
>
>   


-- 
Thomas E Adams
National Weather Service
Ohio River Forecast Center
1901 South State Route 134
Wilmington, OH 45177

EMAIL:	thomas.adams at noaa.gov

VOICE:	937-383-0528
FAX:	937-383-0033



------------------------------

Message: 5
Date: Sun, 18 Apr 2010 08:41:47 +0200
From: Patrick Giraudoux <patrick.giraudoux at univ-fcomte.fr>
To: Roger.Bivand at nhh.no
Cc: Edzer Pebesma <e.pebesma at gmail.com>, r-sig-geo at stat.math.ethz.ch
Subject: Re: [R-sig-Geo] sp, area and SpatialPolygons
Message-ID: <4BCAA9AB.6010006 at univ-fcomte.fr>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed

Except this inexpected 'bug' discovery point the fact that I draw the 
hole inadvertently ! I wanted to draw standards polygons but did the 
first counterclockwise (so a hole...)... Chaos added to chaos = bug fix. 
Let us call that the French wine method... hips !

Anyway, thanks a lot Roger,

Cheers,

Patrick






Roger Bivand a ?crit :
> On Sat, 17 Apr 2010, Patrick Giraudoux wrote:
>
>>
>> I did not find a function in sp to extract area from SpatialPolygons 
>> objects. Thus I was thinking about writing some function to do the 
>> job similar to the functions written in order to extract lengths from 
>> SpatialLines objects (see ?SpatialLines). I have incidentally 
>> discovered a strange thing. Let us define a list of 3 polygons:
>>
>>  polylist <- list(structure(c(180016, 180034, 180452, 180588, 180615, 
>> 180533,
>>    180225, 180016, 332182, 331756, 331774, 332074, 332418, 332518,
>>    332319, 332182), .Dim = c(8L, 2L)), structure(c(179907, 180325,
>>    180397, 180152, 179781, 179672, 179735, 179907, 331611, 331611,
>>    331266, 330931, 330967, 331266, 331466, 331611), .Dim = c(8L,
>>    2L)), structure(c(179499, 179971, 180343, 180161, 179753, 179418,
>>    179499, 330577, 330768, 330468, 330096, 330078, 330369, 330577
>>    ), .Dim = c(7L, 2L)))
>>
>> And make a simple SpatialPolygons object with them:
>>
>> SP<-SpatialPolygons(list(Polygons(list(Polygon(polylist[[1]])),ID="P1"),Polygons(list(Polygon(polylist[[2]])),ID="P2"),Polygons(list(Polygon(polylist[[3]])),ID="P3")),pO=as.integer(c(1,2,3))) 
>>
>> It looks like if the area of Polygons #1 was not computed:
>
> Patrick,
>
> There is a bug, not not a simple one. The ring direction of your first 
> Polygon object signals that it is a hole, but in Polygons(), singleton 
> holes are made into islands, and the largest hole in an all-hole list 
> of Polygon objects is also made into an island. The bug was that the 
> hole vector used for assigning the area had not been updated, so the 
> area slot in the Polygons object was assigned 0 (because it was still 
> treated as a hole). Had you said hole=FALSE for P1, it would have been 
> OK. The updating is now in place.
>
> Thanks,
>
> Roger
>
>>
>> SP at polygons[[1]]@area
>> [1] 0
>>
>> Whilst the area of the Polygons are:
>>
>> SP at polygons[[1]]@Polygons[[1]]@area
>> [1] 322111
>>
>> However, no trouble with the next Polygons:
>>> SP at polygons[[2]]@area
>> [1] 384740
>>> SP at polygons[[2]]@Polygons[[1]]@area
>> [1] 384740
>>> SP at polygons[[3]]@area
>> [1] 423937
>>> SP at polygons[[3]]@Polygons[[1]]@area
>> [1] 423937
>>
>> Did I do something wrong, miss something or is there a bug in the 
>> SpatialPolygons function ?
>>
>> Patrick
>>
>>
>>
>>
>>
>>
>>
>>
>



------------------------------

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


End of R-sig-Geo Digest, Vol 80, Issue 18
*****************************************

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/ms-tnef
Size: 9934 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100418/1fdf8c93/attachment.bin>

From edzer.pebesma at uni-muenster.de  Sun Apr 18 13:28:58 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sun, 18 Apr 2010 13:28:58 +0200
Subject: [R-sig-Geo] Use estimateAnisotropy by intamap package
In-Reply-To: <86DBA0678E017341B449A62F258E2956386D1A@IS-EX-BEV3.unimelb.edu.au>
References: <mailman.7.1271584802.20987.r-sig-geo@stat.math.ethz.ch>
	<86DBA0678E017341B449A62F258E2956386D1A@IS-EX-BEV3.unimelb.edu.au>
Message-ID: <4BCAECFA.1010904@uni-muenster.de>

An example, building on example(estimateAnisotropy), is:

library(intamap)
data(sic2004)
coordinates(sic.val)=~x+y
estimateAnisotropy(sic.val,formulaString=joker~1)

I'd agree that "formula" would have been a better name for the third
parameter than "formulaString", as a string is not allowed here (this
matches the docs, btw). For your convenience,

estimateAnisotropy(sic.val,formula=joker~1)

also works, by R's partial matching of argument names.
--
Edzer

Yong Li wrote:
> Dear All,
> 
> I tried to inspect the geometric anisotropy by using the function of estimateAnisotropy with parameter "formulaString" in intamap, but never worked.
> Any help will be highly appreciated. 
> 
> Cheers,
> 
> Yong
> 
> 
> -----Original Message-----
> From: r-sig-geo-bounces at stat.math.ethz.ch ?? r-sig-geo-request at stat.math.ethz.ch
> Sent: 2010-4-18 (???) 20:00
> To: r-sig-geo at stat.math.ethz.ch
> Subject: R-sig-Geo Digest, Vol 80, Issue 18
>  
> Send R-sig-Geo mailing list submissions to
> 	r-sig-geo at stat.math.ethz.ch
> 
> To subscribe or unsubscribe via the World Wide Web, visit
> 	https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> or, via email, send a message with subject or body 'help' to
> 	r-sig-geo-request at stat.math.ethz.ch
> 
> You can reach the person managing the list at
> 	r-sig-geo-owner at stat.math.ethz.ch
> 
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of R-sig-Geo digest..."
> 
> 
> Today's Topics:
> 
>    1. Variogram models in gstat (Sidney Bernal)
>    2. Re: Variogram models in gstat (Edzer Pebesma)
>    3. Re: sp, area and SpatialPolygons (Roger Bivand)
>    4. Re: Help needed with spplot (Thomas Adams)
>    5. Re: sp, area and SpatialPolygons (Patrick Giraudoux)
> 
> 
> ----------------------------------------------------------------------
> 
> Message: 1
> Date: Sat, 17 Apr 2010 10:37:15 -0500
> From: Sidney Bernal <sidney86_115 at hotmail.com>
> To: <r-sig-geo at stat.math.ethz.ch>, Sidney Bernal
> 	<sidney86_115 at hotmail.com>
> Subject: [R-sig-Geo] Variogram models in gstat
> Message-ID: <SNT117-W61894D6D8AA733D868DD48A70D0 at phx.gbl>
> Content-Type: text/plain
> 
> 
> 
> 
> Good Morning
> 
> Today I make a geostatistics course, so I'm using R 2.10.1 and I am writing to ask the please of the mathematical formulas of the 19 models of covariogram variogram programmed in the gstat package.
> 
>    short                                      long
> 1    Nug                              Nug (nugget)
> 2    Exp                         Exp (exponential)
> 3    Sph                           Sph (spherical)
> 4    Gau                            Gau (gaussian)
> 5    Exc               Exclass (Exponential class)
> 6    Mat                              Mat (Matern)
> 7    Ste Mat (Matern, M. Stein's parameterization)
> 8    Cir                            Cir (circular)
> 9    Lin                              Lin (linear)
> 10   Bes                              Bes (bessel)
> 11   Pen                      Pen (pentaspherical)
> 12   Per                            Per (periodic)
> 13   Hol                                Hol (hole)
> 14   Log                         Log (logarithmic)
> 15   Pow                               Pow (power)
> 16   Spl                              Spl (spline)
> 17   Leg                            Leg (Legendre)
> 18   Err                   Err (Measurement error)
> 19   Int                           Int (Intercept)
> 
> Awaiting your prompt response.
> 
> Sidney Bernal
> sidney86_115 at hotmail.com
> 
> 
> 
> Sidney Bernal
> 
>  		 	   		  
> _________________________________________________________________
> 
> 
> e=wlmailtagline
> 	[[alternative HTML version deleted]]
> 
> 
> 
> ------------------------------
> 
> Message: 2
> Date: Sat, 17 Apr 2010 18:47:43 +0200
> From: Edzer Pebesma <edzer.pebesma at uni-muenster.de>
> To: Sidney Bernal <sidney86_115 at hotmail.com>
> Cc: r-sig-geo at stat.math.ethz.ch
> Subject: Re: [R-sig-Geo] Variogram models in gstat
> Message-ID: <4BC9E62F.1090607 at uni-muenster.de>
> Content-Type: text/plain; charset=ISO-8859-1
> 
> Most of them can be found on page 38 of http://www.gstat.org/gstat.pdf
> 
> The Mat / Ste models are e.g. described in M. Stein, "Interpolation of
> Spatial Data: Some Theory for Kriging", Springer.
> 
> Let me know if there are further descriptions missing.
> --
> Edzer
> 
> Sidney Bernal wrote:
>>  
>> Good Morning
>>
>> Today I make a geostatistics course, so I'm using R 2.10.1 and I am writing to ask the please of the mathematical formulas of the 19 models of covariogram variogram programmed in the gstat package.
>>  
>>    short                                      long
>> 1    Nug                              Nug (nugget)
>> 2    Exp                         Exp (exponential)
>> 3    Sph                           Sph (spherical)
>> 4    Gau                            Gau (gaussian)
>> 5    Exc               Exclass (Exponential class)
>> 6    Mat                              Mat (Matern)
>> 7    Ste Mat (Matern, M. Stein's parameterization)
>> 8    Cir                            Cir (circular)
>> 9    Lin                              Lin (linear)
>> 10   Bes                              Bes (bessel)
>> 11   Pen                      Pen (pentaspherical)
>> 12   Per                            Per (periodic)
>> 13   Hol                                Hol (hole)
>> 14   Log                         Log (logarithmic)
>> 15   Pow                               Pow (power)
>> 16   Spl                              Spl (spline)
>> 17   Leg                            Leg (Legendre)
>> 18   Err                   Err (Measurement error)
>> 19   Int                           Int (Intercept)
>>  
>> Awaiting your prompt response.
>>  
>> Sidney Bernal
>> sidney86_115 at hotmail.com
>>
>>  
>>  
>> Sidney Bernal
>>
>>  		 	   		  
>> _________________________________________________________________
>>
>>
>> e=wlmailtagline
>> 	[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From edzer.pebesma at uni-muenster.de  Sun Apr 18 19:22:33 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sun, 18 Apr 2010 19:22:33 +0200
Subject: [R-sig-Geo] Variogram models in gstat
In-Reply-To: <SNT117-W56AC5851D05D39206F40B1A70C0@phx.gbl>
References: <SNT117-W61894D6D8AA733D868DD48A70D0@phx.gbl>,
	<4BC9E62F.1090607@uni-muenster.de>
	<SNT117-W56AC5851D05D39206F40B1A70C0@phx.gbl>
Message-ID: <4BCB3FD9.4070504@uni-muenster.de>

Sidney, I'm taking the liberty to copy r-sig-geo in this.

the answer is in the C sources, I looked at
http://svn.52north.org/cgi-bin/viewvc.cgi/main/gstat/src/vario_fn.c?view=markup&root=geostatistics

copying the essential C snippets from the code:

Sidney Bernal wrote:
>  
> Edzer Thanks, really helped me the link you sent me, but still need the mathematical formulas variogram of the following models:
>  
> 5    Exc               Exclass (Exponential class)

1.0 - exp(-pow(h/r[0],r[1]))

> 6    Mat                              Mat (Matern)

1.0 - (pow(2.0, -(kappa - 1.0))/gammafn(kappa)) *
			pow(hr, kappa) * bessel_k(hr, kappa, 1.0);

> 7    Ste Mat (Matern, M. Stein's parameterization)

	bes = bessel_k(2.0 * sqrt(delta[1]) * h, delta[1], 1.0);
	if (!isfinite(bes))
		return 0.0;
	if (bes == 0.0)
		return 1.0;
	mult = pow(2.0, 1.0 - delta[1]) / gammafn(delta[1]) *
		pow((2.0 * sqrt(delta[1]) * h), delta[1]);
	if (!isfinite(mult))
		return 1.0;
	return 1.0 - bes * mult;

> 13   Hol                                Hol (hole)

	return 1.0 - sin(h/(*r))/(h/(*r));

> 16   Spl                              Spl (spline)

	return h * h * log(h);
(I'm not sure this is a legal model)

> 17   Leg                            Leg (Legendre)

	r2 = r[0] * r[0];
	ang = h / (PI * 6378.137);
	return 2.0 - (1.0 - r2)/(1 - 2.0 * r[0] * cos(ang) + r2);

These are all unit variogram models, and get multiplied by their partial
sill. r[0] is range, r[1] is kappa for the partial model defined in
vgm(). h is distance.

Good luck with your geostatistics course,
--
Edzer

> 
> 
> 
>  
> 
>  
>  
>  
>  
>  
> Sidney Bernal
> 
> 
>  
> 
>> Date: Sat, 17 Apr 2010 18:47:43 +0200
>> From: edzer.pebesma at uni-muenster.de
>> To: sidney86_115 at hotmail.com
>> CC: r-sig-geo at stat.math.ethz.ch
>> Subject: Re: [R-sig-Geo] Variogram models in gstat
>>
>> Most of them can be found on page 38 of http://www.gstat.org/gstat.pdf
>>
>> The Mat / Ste models are e.g. described in M. Stein, "Interpolation of
>> Spatial Data: Some Theory for Kriging", Springer.
>>
>> Let me know if there are further descriptions missing.
>> --
>> Edzer
>>
>> Sidney Bernal wrote:
>>>
>>> Good Morning
>>>
>>> Today I make a geostatistics course, so I'm using R 2.10.1 and I am writing to ask the please of the mathematical formulas of the 19 models of covariogram variogram programmed in the gstat package.
>>>
>>> short long
>>> 1 Nug Nug (nugget)
>>> 2 Exp Exp (exponential)
>>> 3 Sph Sph (spherical)
>>> 4 Gau Gau (gaussian)
>>> 5 Exc Exclass (Exponential class)
>>> 6 Mat Mat (Matern)
>>> 7 Ste Mat (Matern, M. Stein's parameterization)
>>> 8 Cir Cir (circular)
>>> 9 Lin Lin (linear)
>>> 10 Bes Bes (bessel)
>>> 11 Pen Pen (pentaspherical)
>>> 12 Per Per (periodic)
>>> 13 Hol Hol (hole)
>>> 14 Log Log (logarithmic)
>>> 15 Pow Pow (power)
>>> 16 Spl Spl (spline)
>>> 17 Leg Leg (Legendre)
>>> 18 Err Err (Measurement error)
>>> 19 Int Int (Intercept)
>>>
>>> Awaiting your prompt response.
>>>
>>> Sidney Bernal
>>> sidney86_115 at hotmail.com
>>>
>>>
>>>
>>> Sidney Bernal
>>>
>>>
>>> _________________________________________________________________
>>>
>>>
>>> e=wlmailtagline
>>> [[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> -- 
>> Edzer Pebesma
>> Institute for Geoinformatics (ifgi), University of M?nster
>> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
>> 8333081, Fax: +49 251 8339763 http://ifgi.uni-muenster.de
>> http://www.52north.org/geostatistics e.pebesma at wwu.de
>  		 	   		  
> _________________________________________________________________
> News, entertainment and everything you care about at Live.com. Get it now!
> http://www.live.com/getstarted.aspx

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From evann.g.smith at gmail.com  Sun Apr 18 22:06:17 2010
From: evann.g.smith at gmail.com (Evann Smith)
Date: Sun, 18 Apr 2010 16:06:17 -0400
Subject: [R-sig-Geo] polygon/raster overlay error
Message-ID: <v2w520aebcf1004181306sbb4ecbdakb7af95aa43c0533d@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100418/c4fce7c5/attachment.pl>

From eick at vistracks.com  Mon Apr 19 02:27:55 2010
From: eick at vistracks.com (Stephen G. Eick)
Date: Sun, 18 Apr 2010 19:27:55 -0500
Subject: [R-sig-Geo] R Scoping Rules
Message-ID: <003901cadf57$28cf6630$7a6e3290$@uic.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100418/c8ce6a69/attachment.pl>

From ggrothendieck at gmail.com  Mon Apr 19 02:59:46 2010
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sun, 18 Apr 2010 20:59:46 -0400
Subject: [R-sig-Geo] R Scoping Rules
In-Reply-To: <003901cadf57$28cf6630$7a6e3290$@uic.edu>
References: <003901cadf57$28cf6630$7a6e3290$@uic.edu>
Message-ID: <t2n971536df1004181759k8f4b4bb9nbf06c06656f3dbf4@mail.gmail.com>

R uses lexical scope. That means that when a variable is not found in
a function it next looks where the function was _defined_ and not
where the function was called from.   Since simple is defined in the
global environment it looks there for height if can`t find it within
simple.  The parent environment is where the function was defined and
the parent frame is where it was called from.  To force it to look in
the parent frame rather than the parent environment try this:

simple <- function(env = parent.frame()) {
   if(exists("height", env)) cat("height exists\n")
   else cat("height does not exist\n")
}
foo <- function() { height <- 3; simple() }
foo() # height exists


On Sun, Apr 18, 2010 at 8:27 PM, Stephen G. Eick <eick at vistracks.com> wrote:
> simple<-function() {
>
> if(exists("height"))
>
> cat("height exists\n")
>
> else
>
> cat("height does not exist\n")
>
> }
>
>
>
> foo<-function() {
>
> height<-10
>
> simple()
>
> }
>
>
>
>> foo()
>
> height does not exist
>
>
>
> Can somebody please explain why "simple" does not find the "height" variable
> when I run it?
>
>
>
> Is there an easy way to make R use scoping rules like python where it
> searches over all frames to find the value of an symbol?
>
>
>
> Thanks, Steve Eick
>
>
>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From eick at vistracks.com  Mon Apr 19 03:17:55 2010
From: eick at vistracks.com (Stephen G. Eick)
Date: Sun, 18 Apr 2010 20:17:55 -0500
Subject: [R-sig-Geo] R Scoping Rules
In-Reply-To: <t2n971536df1004181759k8f4b4bb9nbf06c06656f3dbf4@mail.gmail.com>
References: <003901cadf57$28cf6630$7a6e3290$@uic.edu>
	<t2n971536df1004181759k8f4b4bb9nbf06c06656f3dbf4@mail.gmail.com>
Message-ID: <004901cadf5e$24f004f0$6ed00ed0$@uic.edu>

Thanks.  This makes sense.  Is there any way to make R search over every
frame all the way back to the global frame?  

simple <- function(env = parent.frame()) {
   if(exists("height", env)) cat("height exists\n")
   else cat("height does not exist\n")
}
a<-function()simple()
foo <- function() { height <- 3; a() }
foo() # height does not exist

-----Original Message-----
From: Gabor Grothendieck [mailto:ggrothendieck at gmail.com] 
Sent: Sunday, April 18, 2010 8:00 PM
To: eick at cs.uic.edu
Cc: r-sig-geo at stat.math.ethz.ch
Subject: Re: [R-sig-Geo] R Scoping Rules

R uses lexical scope. That means that when a variable is not found in
a function it next looks where the function was _defined_ and not
where the function was called from.   Since simple is defined in the
global environment it looks there for height if can`t find it within
simple.  The parent environment is where the function was defined and
the parent frame is where it was called from.  To force it to look in
the parent frame rather than the parent environment try this:

simple <- function(env = parent.frame()) {
   if(exists("height", env)) cat("height exists\n")
   else cat("height does not exist\n")
}
foo <- function() { height <- 3; simple() }
foo() # height exists


On Sun, Apr 18, 2010 at 8:27 PM, Stephen G. Eick <eick at vistracks.com> wrote:
> simple<-function() {
>
> if(exists("height"))
>
> cat("height exists\n")
>
> else
>
> cat("height does not exist\n")
>
> }
>
>
>
> foo<-function() {
>
> height<-10
>
> simple()
>
> }
>
>
>
>> foo()
>
> height does not exist
>
>
>
> Can somebody please explain why "simple" does not find the "height"
variable
> when I run it?
>
>
>
> Is there an easy way to make R use scoping rules like python where it
> searches over all frames to find the value of an symbol?
>
>
>
> Thanks, Steve Eick
>
>
>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From ggrothendieck at gmail.com  Mon Apr 19 03:40:52 2010
From: ggrothendieck at gmail.com (Gabor Grothendieck)
Date: Sun, 18 Apr 2010 21:40:52 -0400
Subject: [R-sig-Geo] R Scoping Rules
In-Reply-To: <004901cadf5e$24f004f0$6ed00ed0$@uic.edu>
References: <003901cadf57$28cf6630$7a6e3290$@uic.edu>
	<t2n971536df1004181759k8f4b4bb9nbf06c06656f3dbf4@mail.gmail.com>
	<004901cadf5e$24f004f0$6ed00ed0$@uic.edu>
Message-ID: <g2u971536df1004181840nc2e22f37sa552906c8f6b84ed@mail.gmail.com>

You can use parent.frame(n), see ?parent.frame and ?get,  but its
probably not a good idea since you will wind up with a function that
does not work in the way the rest of R works.

On Sun, Apr 18, 2010 at 9:17 PM, Stephen G. Eick <eick at vistracks.com> wrote:
> Thanks. ?This makes sense. ?Is there any way to make R search over every
> frame all the way back to the global frame?
>
> simple <- function(env = parent.frame()) {
> ? if(exists("height", env)) cat("height exists\n")
> ? else cat("height does not exist\n")
> }
> a<-function()simple()
> foo <- function() { height <- 3; a() }
> foo() # height does not exist
>
> -----Original Message-----
> From: Gabor Grothendieck [mailto:ggrothendieck at gmail.com]
> Sent: Sunday, April 18, 2010 8:00 PM
> To: eick at cs.uic.edu
> Cc: r-sig-geo at stat.math.ethz.ch
> Subject: Re: [R-sig-Geo] R Scoping Rules
>
> R uses lexical scope. That means that when a variable is not found in
> a function it next looks where the function was _defined_ and not
> where the function was called from. ? Since simple is defined in the
> global environment it looks there for height if can`t find it within
> simple. ?The parent environment is where the function was defined and
> the parent frame is where it was called from. ?To force it to look in
> the parent frame rather than the parent environment try this:
>
> simple <- function(env = parent.frame()) {
> ? if(exists("height", env)) cat("height exists\n")
> ? else cat("height does not exist\n")
> }
> foo <- function() { height <- 3; simple() }
> foo() # height exists
>
>
> On Sun, Apr 18, 2010 at 8:27 PM, Stephen G. Eick <eick at vistracks.com> wrote:
>> simple<-function() {
>>
>> if(exists("height"))
>>
>> cat("height exists\n")
>>
>> else
>>
>> cat("height does not exist\n")
>>
>> }
>>
>>
>>
>> foo<-function() {
>>
>> height<-10
>>
>> simple()
>>
>> }
>>
>>
>>
>>> foo()
>>
>> height does not exist
>>
>>
>>
>> Can somebody please explain why "simple" does not find the "height"
> variable
>> when I run it?
>>
>>
>>
>> Is there an easy way to make R use scoping rules like python where it
>> searches over all frames to find the value of an symbol?
>>
>>
>>
>> Thanks, Steve Eick
>>
>>
>>
>>
>> ? ? ? ?[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>


From vkepoglu at gmail.com  Mon Apr 19 08:49:33 2010
From: vkepoglu at gmail.com (Volkan Kepoglu)
Date: Mon, 19 Apr 2010 09:49:33 +0300
Subject: [R-sig-Geo] convertion delaunay triangulation to SpatialPolygons
In-Reply-To: <2FECBA36D6EF8645A9D736633F186F815EDCB926CC@foedmail02n>
References: <w2y8b5938321004160956t50d18470l9157af036661fcbd@mail.gmail.com>
	<2FECBA36D6EF8645A9D736633F186F815EDCB926CC@foedmail02n>
Message-ID: <l2s8b5938321004182349g5211fea3i3f766ce21cf3dea5@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100419/d58c3ff4/attachment.pl>

From hengl at spatial-analyst.net  Mon Apr 19 09:28:15 2010
From: hengl at spatial-analyst.net (Tomislav Hengl)
Date: Mon, 19 Apr 2010 09:28:15 +0200
Subject: [R-sig-Geo] polygon/raster overlay error
In-Reply-To: <v2w520aebcf1004181306sbb4ecbdakb7af95aa43c0533d@mail.gmail.com>
References: <v2w520aebcf1004181306sbb4ecbdakb7af95aa43c0533d@mail.gmail.com>
Message-ID: <4BCC060F.1000301@spatial-analyst.net>


Evann Smith wrote:
> Hello,
> 
> I am attempting to calculate the mean value in a raster (3432 x 8640) for
> each of 689 polygons (code at end of email). To that end, I have a few
> questions:
> 
> First, the for loop runs fine for a while (2 hours, maybe) before
> terminating itself and returning this error:
> 
> Error in unlist(lapply(rings, function(x, pts) pointsInPolygon(pts, x,  :
>   negative length vectors are not allowed
> 
> Based on the output matrix, it seems to have gotten hung up on polygon 24.
> Any ideas why this might be and how I can fix it? In reading the shapefile I
> both delete null objects and force rings.
> 
> Second, this process (if it works) will take forever. I've tried an approach
> where I covert the polygons to a raster, but this seems to result in data
> loss and produce a lot of null values. I've also read on this list a
> discussion about just using those points in the bounding box. However, it
> was entirely unclear to me how to implement that recommendation.

Maybe you should try using the SAGA module "Grid Statistics for 
Polygons". SAGA (implemented in C++) is pretty efficient in processing 
large data. I would be interested to learn how much time did it take on 
the end with your specific dataset.

 > library(RSAGA)
 > rsaga.get.usage("shapes_grid", 2)
SAGA CMD 2.0.4
library path:   C:/Progra~1/saga_vc/modules
library name:   shapes_grid
module name :   Grid Statistics for Polygons
Usage: 2 -GRID <str> -POLY <str> -RESULT <str> [-QUANTILES] 
[-QUANTILE_STEP <num>]
   -GRID:<str>           Grid
         Grid (input)
   -POLY:<str>           Polygons
         Shapes (input)
   -RESULT:<str>         Result
         Shapes (output)
   -QUANTILES            Quantiles
         Boolean
   -QUANTILE_STEP:<num>  Quantile Step
         Choice
         Available Choices:
         [0] median
         [1] quartiles
         [2] deciles


T. Hengl
http://home.medewerker.uva.nl/t.hengl/

> 
> Any help would be greatly appreciated.
> 
> Cheers,
> Evann
> 
> 
> R Code:
> # Projection
> prj <- CRS("+proj=longlat +ellps=WGS84")
> 
> # Shapefile
> polys <- readShapePoly("GeoEPR/geoepr-20100212-1248.shp", proj4string=prj,
> verbose=TRUE, delete_null_obj=TRUE, force_ring=TRUE)
> summary(polys)
> 
> # Raster
> popimg <- readGDAL("PopDens/glds05ag.bil")
> proj4string(popimg) <- prj
> summary(popimg)
> 
> # Values
> y <- slot(popimg,"data")
> head(y)
> 
> # Total polygons
> n <- length(slot(polys,"polygons"))
> n
> 
> # Empty matrix
> output1 <- as.data.frame(matrix(NA, nrow=n, ncol=4))
> names(output1) <- c("cowgroup", "start", "end", "popdens")
> head(output1)
> 
> # Beastly for loop
> for(i in 1:n) {
>    output1[i,1] <- slot(polys, "data")[i,1]
>    output1[i,2] <- slot(polys, "data")[i,2]
>    output1[i,3] <- slot(polys, "data")[i,3]
>    overlap <- overlay(popimg,polys[i,])
>    output1[i,4] <- mean(y[overlap==1 & !is.na(overlap),1], na.rm=TRUE)
>    }
> 
> ============================================
> Evann Smith
> Doctoral Student
> Department of Government, Harvard University
> ============================================
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From p.vanbreugel at gmail.com  Mon Apr 19 13:15:43 2010
From: p.vanbreugel at gmail.com (Paulo van Breugel)
Date: Mon, 19 Apr 2010 14:15:43 +0300
Subject: [R-sig-Geo] polygon/raster overlay error
Message-ID: <4BCC3B5F.6020403@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100419/ed83b5fa/attachment.pl>

From tlumley at u.washington.edu  Mon Apr 19 18:06:48 2010
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Mon, 19 Apr 2010 09:06:48 -0700 (PDT)
Subject: [R-sig-Geo] R Scoping Rules
In-Reply-To: <003901cadf57$28cf6630$7a6e3290$@uic.edu>
Message-ID: <alpine.LRH.2.01.1004190906480.4182@hymn13.u.washington.edu>

On Sun, 18 Apr 2010, Stephen G. Eick wrote:

> simple<-function() {
>
> if(exists("height"))
>
> cat("height exists\n")
>
> else
>
> cat("height does not exist\n")
>
> }
>
>
>
> foo<-function() {
>
> height<-10
>
> simple()
>
> }
>
>
>
>> foo()
>
> height does not exist
>
>
>
> Can somebody please explain why "simple" does not find the "height" variable
> when I run it?
>

'height' is neither a local variable, nor visible in the environment where 'simple()' was defined.  That's the point of static lexical scope -- the scope depends on what was visible where the function was defined.

You seem to want dynamic scope, where variables in the calling environment are visible.  This can be faked with eval.parent(), but isn't how R naturally works.

>
> Is there an easy way to make R use scoping rules like python where it
> searches over all frames to find the value of an symbol?

R *does* use scoping rules like python (since python 2.1).  Your example doesn't work in python, for exactly the same reason.

>>> def simple():
...     print height
... 
>>> def foo():
...     height = 10
...     simple()
... 
>>> foo()
Traceback (most recent call last):
   File "<stdin>", line 1, in <module>
   File "<stdin>", line 3, in foo
   File "<stdin>", line 2, in simple
NameError: global name 'height' is not defined

      -thomas

Thomas Lumley			Assoc. Professor, Biostatistics
tlumley at u.washington.edu	University of Washington, Seattle


From wildlife.email at gmail.com  Tue Apr 20 01:12:17 2010
From: wildlife.email at gmail.com (Wild Life)
Date: Tue, 20 Apr 2010 00:12:17 +0100
Subject: [R-sig-Geo] Moran's I negative binomial generalized linear model
Message-ID: <r2iaff322651004191612jdb3859b5q868f298cc57f234d@mail.gmail.com>

Dear list,
I'm interested in testing the spatial autocorrelation of the residuals
of an negative binomial generalized linear model (glm.nb) using
Moran's I test.
My question is about the best method to do this. Can I use the
function lm.morantest? Or is there another more appropriate way?

Regards,

Antonio Silva


From Adrian.Baddeley at csiro.au  Tue Apr 20 02:41:53 2010
From: Adrian.Baddeley at csiro.au (Adrian.Baddeley at csiro.au)
Date: Tue, 20 Apr 2010 08:41:53 +0800
Subject: [R-sig-Geo]  convertion delaunay triangulation to SpatialPolygons
Message-ID: <57DC18C299094D4299F837570C5DF1C52B0F8FA923@EXWA-MBX01.nexus.csiro.au>

Volkan Kepoglu wrote:

> how can i convert the delaunay triangulation to spatial polygons?

You can do this using the 'spatstat' package to construct the triangles 
(spatstat calls deldir to compute them) and the 'maptools' package to 
convert between spatstat and sp formats. See example below.

Adrian Baddeley
---------------------------

library(spatstat)
library(maptools)

x   <- c(2.3,3.0,7.0,1.0,3.0,8.0)
y   <- c(2.3,3.0,2.0,5.0,8.0,9.0)
df <- data.frame(x=x, y=y)

# need a boundary window so do one of the following:
W <- ripras(df, shape="rectangle")
W <- owin(c(0, 10), c(0, 10))

# create point pattern
X <- as.ppp(df, W=W)
plot(X)

# compute Dirichlet triangles
Y <- dirichlet(X)
plot(Y)

# convert
Z <- as(Y, "SpatialPolygons")

From Adrian.Baddeley at csiro.au  Tue Apr 20 05:07:01 2010
From: Adrian.Baddeley at csiro.au (Adrian.Baddeley at csiro.au)
Date: Tue, 20 Apr 2010 11:07:01 +0800
Subject: [R-sig-Geo] convertion delaunay triangulation to SpatialPolygons
In-Reply-To: <57DC18C299094D4299F837570C5DF1C52B0F8FA923@EXWA-MBX01.nexus.csiro.au>
References: <57DC18C299094D4299F837570C5DF1C52B0F8FA923@EXWA-MBX01.nexus.csiro.au>
Message-ID: <57DC18C299094D4299F837570C5DF1C52B0F8FA926@EXWA-MBX01.nexus.csiro.au>

Sorry, that should of course have read delaunay(X) not dirichlet(X)

A

________________________________________
From: Baddeley, Adrian (CMIS, Floreat)

Volkan Kepoglu wrote:

> how can i convert the delaunay triangulation to spatial polygons?

You can do this using the 'spatstat' package to construct the triangles
(spatstat calls deldir to compute them) and the 'maptools' package to
convert between spatstat and sp formats. See example below.

Adrian Baddeley
---------------------------

library(spatstat)
library(maptools)

x   <- c(2.3,3.0,7.0,1.0,3.0,8.0)
y   <- c(2.3,3.0,2.0,5.0,8.0,9.0)
df <- data.frame(x=x, y=y)

# need a boundary window so do one of the following:
W <- ripras(df, shape="rectangle")
W <- owin(c(0, 10), c(0, 10))

# create point pattern
X <- as.ppp(df, W=W)
plot(X)

# compute Dirichlet triangles
Y <- dirichlet(X)
plot(Y)

# convert
Z <- as(Y, "SpatialPolygons")


From roman.lustrik at gmail.com  Tue Apr 20 09:23:15 2010
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Tue, 20 Apr 2010 09:23:15 +0200
Subject: [R-sig-Geo] assigning raster cell values based on predefined
	criteria
Message-ID: <t2z63a206011004200023sd7800674u40e511be7f88e5ea@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100420/27367bd2/attachment.pl>

From roberto.patuelli at usi.ch  Tue Apr 20 12:15:18 2010
From: roberto.patuelli at usi.ch (Roberto Patuelli)
Date: Tue, 20 Apr 2010 12:15:18 +0200
Subject: [R-sig-Geo] Moran's I negative binomial generalized linear model
Message-ID: <A8B089E1099A43E6B150C5A6D367A4F1@Ciretto>

Dear Antonio,
You may want to look at Jacqmin-Gadda et al. (1997), Tests of Geographical 
Correlation with Adjustment for Explanatory Variables: An Application to 
Dyspnoea in the Elderly, Statistics in Medicine 16, 1283-97.
Cheers
Roberto

****************************

Dear list,
I'm interested in testing the spatial autocorrelation of the residuals
of an negative binomial generalized linear model (glm.nb) using
Moran's I test.
My question is about the best method to do this. Can I use the
function lm.morantest? Or is there another more appropriate way?

Regards,

Antonio Silva

********************
Roberto Patuelli, Ph.D.
Istituto Ricerche Economiche (IRE) (Institute for Economic Research)
Universit? della Svizzera Italiana (University of Lugano)
via Maderno 24, CP 4361
CH-6904 Lugano
Switzerland
Phone: +41-(0)58-666-4166
Fax: +39-02-700419665
Email: roberto.patuelli at usi.ch
Homepage: http://www.people.lu.unisi.ch/patuellr


From sebastiano.trevisani at libero.it  Tue Apr 20 12:36:14 2010
From: sebastiano.trevisani at libero.it (seba)
Date: Tue, 20 Apr 2010 12:36:14 +0200
Subject: [R-sig-Geo] ntamap: mixed anisotropy
Message-ID: <01NM6BMDS2OM0003PI@mx1.pd.cnr.it>


>Date: Tue, 20 Apr 2010 12:24:34 +0200
>To: r-sig-geo at stat.math.ethz.ch
>From: "S. Trevisani" <s.trevisani at irpi.cnr.it>
>Subject: Intamap: mixed anisotropy
>
>Dear list members
>
>I'm using some of the functions of the intamap packages.
>I like very much the estimate anisotropy function, it is really 
>useful for my tasks.
>But I'm wondering how to deal with zonal or mixed anisotropy considering that
>the function is designed for detecting geometric anisotropy (anyway, 
>I saw that also in the case of geometric anisotropy, the function tells
>me correctly the direction of maximum variability, but I'm not sure 
>how to interpret the ratio).
>
>Thank you for your feedback!
>
>Sincerely
>Sebastiano


From hans at sociologi.cjb.net  Tue Apr 20 17:16:57 2010
From: hans at sociologi.cjb.net (Hans Ekbrand)
Date: Tue, 20 Apr 2010 17:16:57 +0200
Subject: [R-sig-Geo] complete linkage Agglomerative hierarchical clustering,
	nnclust, spatclus or something else?
Message-ID: <20100420151657.GA32632@samir>

I have just read about clustering on wikipedia, and learnt that what I
want is:

Agglomerative hierarchical clustering, with complete linkage

I searched for suitable r-packages for this and found nnclust, and
spatclus. Are those the packages that you could recommend for
clustering events data (the events here is urban fires, created by
arsonists)? Or do you want to suggest other packages?

In this first analysis I want to do the clustering should only by
location, and ignore the point in time.

Later on I will also include time data, so if the clustering package
could handle time too, that would be great, but that is not a
requirement at this time.

The aim at this stage is only to group events with the same, or almost
the same, location. In my data-set the coordiante-data is a bit too
precise in some cases.

I guess a crude way of clustering would be to round the
coordinate-data to a lesser number of significant digits, however, a
sound clustering algorithm would be better :-)

I also need to grasp the scale here:

With this proj4string, and datapoints as below:

  ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slots
  .. .. ..@ projargs: chr " +proj=utm +zone=33 +ellps=GRS80 +units=m +no_defs"

head(fires at coords, 2)
         East   North
[1,] 315359.9 6393110
[2,] 325862.4 6405239

dist(head(fires at coords, 2))
         1
2 16044.10

Is this in meters?

TIA

-- 
Hans Ekbrand (http://sociologi.cjb.net) <hans at sociologi.cjb.net>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100420/edb90403/attachment.bin>

From Roger.Bivand at nhh.no  Tue Apr 20 17:25:51 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 20 Apr 2010 17:25:51 +0200 (CEST)
Subject: [R-sig-Geo] complete linkage Agglomerative hierarchical
 clustering, nnclust, spatclus or something else?
In-Reply-To: <20100420151657.GA32632@samir>
References: <20100420151657.GA32632@samir>
Message-ID: <alpine.LRH.2.00.1004201723450.31288@reclus.nhh.no>

On Tue, 20 Apr 2010, Hans Ekbrand wrote:

> I have just read about clustering on wikipedia, and learnt that what I
> want is:
>
> Agglomerative hierarchical clustering, with complete linkage

library(cluster)
?hclust

is for clustering with moderate numbers of points.

Below: in UTM, the units are metres, so distances are in metres too.

Hope this helps,

Roger

>
> I searched for suitable r-packages for this and found nnclust, and
> spatclus. Are those the packages that you could recommend for
> clustering events data (the events here is urban fires, created by
> arsonists)? Or do you want to suggest other packages?
>
> In this first analysis I want to do the clustering should only by
> location, and ignore the point in time.
>
> Later on I will also include time data, so if the clustering package
> could handle time too, that would be great, but that is not a
> requirement at this time.
>
> The aim at this stage is only to group events with the same, or almost
> the same, location. In my data-set the coordiante-data is a bit too
> precise in some cases.
>
> I guess a crude way of clustering would be to round the
> coordinate-data to a lesser number of significant digits, however, a
> sound clustering algorithm would be better :-)
>
> I also need to grasp the scale here:
>
> With this proj4string, and datapoints as below:
>
>  ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slots
>  .. .. ..@ projargs: chr " +proj=utm +zone=33 +ellps=GRS80 +units=m +no_defs"
>
> head(fires at coords, 2)
>         East   North
> [1,] 315359.9 6393110
> [2,] 325862.4 6405239
>
> dist(head(fires at coords, 2))
>         1
> 2 16044.10
>
> Is this in meters?
>
> TIA
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From r.hijmans at gmail.com  Tue Apr 20 18:55:51 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 20 Apr 2010 09:55:51 -0700
Subject: [R-sig-Geo] assigning raster cell values based on predefined
	criteria
In-Reply-To: <t2z63a206011004200023sd7800674u40e511be7f88e5ea@mail.gmail.com>
References: <t2z63a206011004200023sd7800674u40e511be7f88e5ea@mail.gmail.com>
Message-ID: <w2ldc22b2571004200955w5a55dc17p19a76406591a09c2@mail.gmail.com>

Dear Roman,

I think it depends on your data. Below are two examples (both assuming
your polygons do not overlap).

A) works if each cell in a polygon is closest to its own centroid (and
not that of another polygon). It makes a distance surface with
distanceFromPoints() and then uses mask() to mask out the areas not
covered by polygons.

B) uses linesToRaster() to set up a raster with impenetrable
boundaries (the polygon outlines) and then use gridDistance()  (i.e.
the distance when only allowed to traverse certain cells). This method
would fail if you have a polygon representing several islands; or a
polygon with a hole with the centroid inside that hole. Also, you do
not have values for the outer cells of a polygon. This is perhaps OK
when polygons are adjacent (whose cell is it anyway?). If they are not
adjacent yo could use edge() with 'outer' argument on the rasterized
polygons instead of linesToRaster

library(raster)
p1 <- rbind(c(-180,-20), c(-140,55), c(-20, 0), c(-140,-60), c(-180,-20))
hole <- rbind(c(-150,-20), c(-100,-10), c(-110,20), c(-150,-20))
p2 <- rbind(c(-10,0), c(140,60), c(160,0), c(140,-55), c(-10,0))
pols <- SpatialPolygons( list(  Polygons(list(Polygon(p1)), 1),
Polygons(list(Polygon(p2)), 2)))
xy <- coordinates(pols)

#A
r <- raster(nrow=18, ncol=36)
r <- polygonsToRaster(pols, r)
d <- distanceFromPoints(r, xy)
x <- mask(d, r)
plot(x)

#B
r <- raster(nrow=18, ncol=36)
r <- polygonsToRaster(pols, r)
l <- linesToRaster(pols, r)
l[l>0] <- 0
p <- pointsToRaster(r, xy)
pp <- cover(p, l)
gd <- gridDistance(pp)
gd[!is.na(l)] <- NA
plot(gd)


Robert

On Tue, Apr 20, 2010 at 12:23 AM, Roman Lu?trik <roman.lustrik at gmail.com> wrote:
> Dear list,
>
> I have a polygon that I converted to raster (kudos to polygonsToRaster()). I
> would like to assign values (through a custom function) to cells within this
> polygon (now as raster). Roughly speaking, cell value will depend on its
> distance from the central cell (polygon centroid). How would you go about
> doing this? Is there a more efficient way of doing this, or will I have to
> hard code it, cell by cell?
>
> Cheers,
> Roman
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From vkepoglu at gmail.com  Tue Apr 20 19:22:02 2010
From: vkepoglu at gmail.com (Volkan Kepoglu)
Date: Tue, 20 Apr 2010 20:22:02 +0300
Subject: [R-sig-Geo] convertion delaunay triangulation to SpatialPolygons
In-Reply-To: <57DC18C299094D4299F837570C5DF1C52B0F8FA926@EXWA-MBX01.nexus.csiro.au>
References: <57DC18C299094D4299F837570C5DF1C52B0F8FA923@EXWA-MBX01.nexus.csiro.au>
	<57DC18C299094D4299F837570C5DF1C52B0F8FA926@EXWA-MBX01.nexus.csiro.au>
Message-ID: <w2z8b5938321004201022z13013f69hf8c77dda5cf78e72@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100420/b11f722b/attachment.pl>

From edzer.pebesma at uni-muenster.de  Tue Apr 20 22:40:56 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 20 Apr 2010 22:40:56 +0200
Subject: [R-sig-Geo] ntamap: mixed anisotropy
In-Reply-To: <01NM6BMDS2OM0003PI@mx1.pd.cnr.it>
References: <01NM6BMDS2OM0003PI@mx1.pd.cnr.it>
Message-ID: <4BCE1158.2050905@uni-muenster.de>

Dear Seba, Giannis Spilliopoulos, the author of estimateAnisotropy, sent
me the answer below when I forwarded your email to the intamap-info list
on sourceforge.

Dear Sebastiano and Edzer

Thank for using Intamap package. The "estimateAnisotropy" function is
developed to detect only geometric anisotropy. It is not tested in case
of zonal anisotropy, as  we consider it future work.

As for the anisotropy estimates, given a Cartesian coordinate system
(X,Y) we examine two cases:

a)In the case of zero direction and ratio R (0,R). One should interpret
this result as the correlation length along X axis  is R times bigger
the correlation length along Y axis.

b)In case of  theta degrees and ratio R (theta,R). You should think that
the major correlation length
needs a theta degrees (clockwise) rotation to align with the horizontal
axis. In case of negative angle the rotation should be performed
counter-clockwise. Ratio R in this case yields that the correlation
length on theta degrees is R times bigger than the correlation length in
theta+90 degrees.

To sum up the direction represents the angle between the direction of
the major correlation length and the horizontal axis. While the ratio
represents the ratio of the major to minor correlation lengths.

I hope this helps.

Sincerely
Giannis


seba wrote:
> 
>> Date: Tue, 20 Apr 2010 12:24:34 +0200
>> To: r-sig-geo at stat.math.ethz.ch
>> From: "S. Trevisani" <s.trevisani at irpi.cnr.it>
>> Subject: Intamap: mixed anisotropy
>>
>> Dear list members
>>
>> I'm using some of the functions of the intamap packages.
>> I like very much the estimate anisotropy function, it is really useful
>> for my tasks.
>> But I'm wondering how to deal with zonal or mixed anisotropy
>> considering that
>> the function is designed for detecting geometric anisotropy (anyway, I
>> saw that also in the case of geometric anisotropy, the function tells
>> me correctly the direction of maximum variability, but I'm not sure
>> how to interpret the ratio).
>>
>> Thank you for your feedback!
>>
>> Sincerely
>> Sebastiano
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From hans at sociologi.cjb.net  Tue Apr 20 23:13:22 2010
From: hans at sociologi.cjb.net (Hans Ekbrand)
Date: Tue, 20 Apr 2010 23:13:22 +0200
Subject: [R-sig-Geo] complete linkage Agglomerative hierarchical
 clustering, nnclust, spatclus or something else?
In-Reply-To: <alpine.LRH.2.00.1004201723450.31288@reclus.nhh.no>
References: <20100420151657.GA32632@samir>
	<alpine.LRH.2.00.1004201723450.31288@reclus.nhh.no>
Message-ID: <4BCE18F2.8080909@sociologi.cjb.net>

Roger Bivand wrote:
> On Tue, 20 Apr 2010, Hans Ekbrand wrote:
>
>> I have just read about clustering on wikipedia, and learnt that what I
>> want is:
>>
>> Agglomerative hierarchical clustering, with complete linkage
>
> library(cluster)
> ?hclust
>
> is for clustering with moderate numbers of points.
Thanks. In a first run I have 900 points, but the whole set contains
70.000 points.
>
>
> Below: in UTM, the units are metres, so distances are in metres too.

OK, good to know.


-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 260 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100420/1f8e19ab/attachment.bin>

From hans at sociologi.cjb.net  Wed Apr 21 09:59:51 2010
From: hans at sociologi.cjb.net (Hans Ekbrand)
Date: Wed, 21 Apr 2010 09:59:51 +0200
Subject: [R-sig-Geo] complete linkage Agglomerative
	hierarchical	clustering, nnclust, spatclus or something else?
In-Reply-To: <4BCE18F2.8080909@sociologi.cjb.net>
References: <20100420151657.GA32632@samir>
	<alpine.LRH.2.00.1004201723450.31288@reclus.nhh.no>
	<4BCE18F2.8080909@sociologi.cjb.net>
Message-ID: <20100421075950.GA16006@samir>

On Tue, Apr 20, 2010 at 11:13:22PM +0200, Hans Ekbrand wrote:
> Roger Bivand wrote:
> > On Tue, 20 Apr 2010, Hans Ekbrand wrote:
> >
> >> I have just read about clustering on wikipedia, and learnt that what I
> >> want is:
> >>
> >> Agglomerative hierarchical clustering, with complete linkage
> >
> > library(cluster)
> > ?hclust

print(load(url("http://sociologi.cjb.net/temp/clust.geo.test.RData")))
clust.geo.test.tree <- hclust(dist(clust.geo.test at coords))
clust.geo.test.tree$height

head(clust.geo.test.tree$height, 70)
 [1]   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000
[11]   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000
[21]   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000
[31]   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000
[41]   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000
[51]   0.000000   0.000000   0.000000   0.000000   3.160631  18.963676  30.398644  32.232351  37.927539  44.987446
[61]  50.065192  81.542472  82.691738  93.553729  95.971207 105.325405 115.218371 119.540239 125.235381 130.181302

As I understand this, the 54 zeroes represent identical coordinates.
The positive numbers represent the distance in meters between points
that have been grouped together at a certain level of the tree. Now, I
am not interested in grouping together points with distances larger
than 100 meters, so I would like to stop the clustering process at
that point - or, after the hclust has completed, extract the clusters
that were in effect at that level. In the above example that would be
at level 65.

I didn't understand from the documentation of hclust how to accomplish
that, can someone on the list help me?

The goal is to count, for each cluster, the number of fires and then
to analyse how the fires within each cluster is distributed over time,
and to count how many of them that are too close in time to be
considered independent.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100421/6fd09231/attachment.bin>

From sebastiano.trevisani at libero.it  Wed Apr 21 10:26:45 2010
From: sebastiano.trevisani at libero.it (seba)
Date: Wed, 21 Apr 2010 10:26:45 +0200
Subject: [R-sig-Geo] intamap: mixed anisotropy
In-Reply-To: <4BCE1158.2050905@uni-muenster.de>
References: <01NM6BMDS2OM0003PI@mx1.pd.cnr.it>
	<4BCE1158.2050905@uni-muenster.de>
Message-ID: <FBCMCL01B040ixxQCwC0018d801@FBCMCL01B04.fbc.local>

Dear Edzer and Giannis

Thank you for your reply. I think that I should 
subscibe to intamap-info list considering
that I'm using extensively some of the intamap 
functions....and sooner or later I think
to use them in my geostatistics courses.

Ok, so you confirm that is limited to geometric 
anistropy. Now I'll try to check
what the routine do in presence of mixed 
anisotropy; as I mentioned earlier I have the fealing (coming
from using it with very heterogenous, from the 
spatial variability point of view, data sets) that
the anisotropy ratio coming out is meaningfull 
also in case of zonal/mixed anisotropy (at least for my task
that is for spatial variability carachterization 
and not for conducting interpolation with kriging). I'm going
to check it.
Thank you again for your help

Sebastiano

At 10.40   20/04/10, Edzer Pebesma wrote:
>Dear Seba, Giannis Spilliopoulos, the author of estimateAnisotropy, sent
>me the answer below when I forwarded your email to the intamap-info list
>on sourceforge.
>
>Dear Sebastiano and Edzer
>
>Thank for using Intamap package. The "estimateAnisotropy" function is
>developed to detect only geometric anisotropy. It is not tested in case
>of zonal anisotropy, as  we consider it future work.
>
>As for the anisotropy estimates, given a Cartesian coordinate system
>(X,Y) we examine two cases:
>
>a)In the case of zero direction and ratio R (0,R). One should interpret
>this result as the correlation length along X axis  is R times bigger
>the correlation length along Y axis.
>
>b)In case of  theta degrees and ratio R (theta,R). You should think that
>the major correlation length
>needs a theta degrees (clockwise) rotation to align with the horizontal
>axis. In case of negative angle the rotation should be performed
>counter-clockwise. Ratio R in this case yields that the correlation
>length on theta degrees is R times bigger than the correlation length in
>theta+90 degrees.
>
>To sum up the direction represents the angle between the direction of
>the major correlation length and the horizontal axis. While the ratio
>represents the ratio of the major to minor correlation lengths.
>
>I hope this helps.
>
>Sincerely
>Giannis
>
>
>seba wrote:
> >
> >> Date: Tue, 20 Apr 2010 12:24:34 +0200
> >> To: r-sig-geo at stat.math.ethz.ch
> >> From: "S. Trevisani" <s.trevisani at irpi.cnr.it>
> >> Subject: Intamap: mixed anisotropy
> >>
> >> Dear list members
> >>
> >> I'm using some of the functions of the intamap packages.
> >> I like very much the estimate anisotropy function, it is really useful
> >> for my tasks.
> >> But I'm wondering how to deal with zonal or mixed anisotropy
> >> considering that
> >> the function is designed for detecting geometric anisotropy (anyway, I
> >> saw that also in the case of geometric anisotropy, the function tells
> >> me correctly the direction of maximum variability, but I'm not sure
> >> how to interpret the ratio).
> >>
> >> Thank you for your feedback!
> >>
> >> Sincerely
> >> Sebastiano
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>--
>Edzer Pebesma
>Institute for Geoinformatics (ifgi), University of M?nster
>Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
>8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
>http://www.52north.org/geostatistics e.pebesma at wwu.de


From hans at sociologi.cjb.net  Wed Apr 21 13:38:57 2010
From: hans at sociologi.cjb.net (Hans Ekbrand)
Date: Wed, 21 Apr 2010 13:38:57 +0200
Subject: [R-sig-Geo] [SOLVED: complete linkage
	Agglomerative	hierarchical clustering]
In-Reply-To: <20100421075950.GA16006@samir>
References: <20100420151657.GA32632@samir>
	<alpine.LRH.2.00.1004201723450.31288@reclus.nhh.no>
	<4BCE18F2.8080909@sociologi.cjb.net> <20100421075950.GA16006@samir>
Message-ID: <20100421113857.GB16006@samir>

On Wed, Apr 21, 2010 at 09:59:51AM +0200, Hans Ekbrand wrote:

[...]

> head(clust.geo.test.tree$height, 70)
>  [1]   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000
> [11]   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000
> [21]   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000
> [31]   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000
> [41]   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000
> [51]   0.000000   0.000000   0.000000   0.000000   3.160631  18.963676  30.398644  32.232351  37.927539  44.987446
> [61]  50.065192  81.542472  82.691738  93.553729  95.971207 105.325405 115.218371 119.540239 125.235381 130.181302
> 
> As I understand this, the 54 zeroes represent identical coordinates.
> The positive numbers represent the distance in meters between points
> that have been grouped together at a certain level of the tree. Now, I
> am not interested in grouping together points with distances larger
> than 100 meters, so I would like to stop the clustering process at
> that point - or, after the hclust has completed, extract the clusters
> that were in effect at that level. In the above example that would be
> at level 65.

I found cutree(), and understood the "h" parameter of cutree, and then
it all worked out. Here's an example for the archives.

# Clustering
max.distance.in.same.cluster <- 100
print(load(url("http://sociologi.cjb.net/temp/clust.geo.test.RData")))
clust.geo.test.tree <- hclust(dist(clust.geo.test at coords))
my.cluster <- cutree(clust.geo.test.tree, h = max.distance.in.same.cluster)
# Which clusters have more than one member?
sort(unique(my.cluster[which(duplicated(my.cluster))]))

# How many members do these cluster have?
sapply(sort(unique(my.cluster[which(duplicated(my.cluster))])), function(x) {length(which(my.cluster == x))})

# Print a sorted list of the longest distances within each of these clusters.
sort(sapply(sort(unique(my.cluster[which(duplicated(my.cluster))])), function(x) {max(dist(clust.geo.test at coords[which(my.cluster == x),]))}))


Thanks again, Roger, for the pointer to hclust() 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100421/91e87d8a/attachment.bin>

From Roger.Bivand at nhh.no  Wed Apr 21 13:42:05 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 21 Apr 2010 13:42:05 +0200 (CEST)
Subject: [R-sig-Geo] complete linkage Agglomerative
 hierarchical	clustering, nnclust, spatclus or something else?
In-Reply-To: <20100421075950.GA16006@samir>
References: <20100420151657.GA32632@samir>
	<alpine.LRH.2.00.1004201723450.31288@reclus.nhh.no>
	<4BCE18F2.8080909@sociologi.cjb.net> <20100421075950.GA16006@samir>
Message-ID: <alpine.LRH.2.00.1004211339130.2078@reclus.nhh.no>

On Wed, 21 Apr 2010, Hans Ekbrand wrote:

> On Tue, Apr 20, 2010 at 11:13:22PM +0200, Hans Ekbrand wrote:
>> Roger Bivand wrote:
>>> On Tue, 20 Apr 2010, Hans Ekbrand wrote:
>>>
>>>> I have just read about clustering on wikipedia, and learnt that what I
>>>> want is:
>>>>
>>>> Agglomerative hierarchical clustering, with complete linkage
>>>
>>> library(cluster)
>>> ?hclust
>
> print(load(url("http://sociologi.cjb.net/temp/clust.geo.test.RData")))
> clust.geo.test.tree <- hclust(dist(clust.geo.test at coords))
> clust.geo.test.tree$height
>
> head(clust.geo.test.tree$height, 70)
> [1]   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000
> [11]   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000
> [21]   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000
> [31]   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000
> [41]   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000   0.000000
> [51]   0.000000   0.000000   0.000000   0.000000   3.160631  18.963676  30.398644  32.232351  37.927539  44.987446
> [61]  50.065192  81.542472  82.691738  93.553729  95.971207 105.325405 115.218371 119.540239 125.235381 130.181302
>
> As I understand this, the 54 zeroes represent identical coordinates.
> The positive numbers represent the distance in meters between points
> that have been grouped together at a certain level of the tree. Now, I
> am not interested in grouping together points with distances larger
> than 100 meters, so I would like to stop the clustering process at
> that point - or, after the hclust has completed, extract the clusters
> that were in effect at that level. In the above example that would be
> at level 65.
>
> I didn't understand from the documentation of hclust how to accomplish
> that, can someone on the list help me?

So you do not want hclust at all, really. Look at dnearneigh() in spdep, 
setting a 100m bound. Then use n.comp.nb() to see which points belong to 
which graph component, using perhaps plot.nb with colours to distinguish 
the subgraphs.

Roger

>
> The goal is to count, for each cluster, the number of fires and then
> to analyse how the fires within each cluster is distributed over time,
> and to count how many of them that are too close in time to be
> considered independent.
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From roberto.patuelli at usi.ch  Wed Apr 21 13:40:00 2010
From: roberto.patuelli at usi.ch (Roberto Patuelli)
Date: Wed, 21 Apr 2010 13:40:00 +0200
Subject: [R-sig-Geo] Lagrange multiplier tests for weighted least squares
Message-ID: <A44B2473B67B4B04BB126F7C81DF75A7@Ciretto>

Hi everyone,

The help file for the spdep command "lm.LMtests" for running Lagrange 
multiplier tests per spatial dependence suggests not to use weights in the 
lm object given as argument.
If weights are highly relevant for a certain model (for example, because of 
strong heterogeneity in the size/importance of the regions being analysed), 
is there a way to get around this limitation? I struggle to find anything 
online relating weighted least squares and LM tests for spatial dependence.

Thanks for the help.
Roberto

********************
Roberto Patuelli, Ph.D.
Istituto Ricerche Economiche (IRE) (Institute for Economic Research)
Universit? della Svizzera Italiana (University of Lugano)
via Maderno 24, CP 4361
CH-6904 Lugano
Switzerland
Phone: +41-(0)58-666-4166
Fax: +39-02-700419665
Email: roberto.patuelli at usi.ch
Homepage: http://www.people.lu.unisi.ch/patuellr


From hans at sociologi.cjb.net  Wed Apr 21 14:04:27 2010
From: hans at sociologi.cjb.net (Hans Ekbrand)
Date: Wed, 21 Apr 2010 14:04:27 +0200
Subject: [R-sig-Geo] complete linkage Agglomerative
	hierarchical	clustering, nnclust, spatclus or something else?
In-Reply-To: <alpine.LRH.2.00.1004211339130.2078@reclus.nhh.no>
References: <20100420151657.GA32632@samir>
	<alpine.LRH.2.00.1004201723450.31288@reclus.nhh.no>
	<4BCE18F2.8080909@sociologi.cjb.net> <20100421075950.GA16006@samir>
	<alpine.LRH.2.00.1004211339130.2078@reclus.nhh.no>
Message-ID: <20100421120427.GA10970@samir>

On Wed, Apr 21, 2010 at 01:42:05PM +0200, Roger Bivand wrote:
> So you do not want hclust at all, really. Look at dnearneigh() in spdep,  
> setting a 100m bound. Then use n.comp.nb() to see which points belong to  
> which graph component, using perhaps plot.nb with colours to distinguish  
> the subgraphs.

Well, hclust was useful, once I understood how cutree works. What
would be the benefit of dnearneigh(), is it faster?
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100421/161c7af8/attachment.bin>

From Roger.Bivand at nhh.no  Wed Apr 21 15:14:46 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 21 Apr 2010 15:14:46 +0200 (CEST)
Subject: [R-sig-Geo] complete linkage Agglomerative
 hierarchical	clustering, nnclust, spatclus or something else?
In-Reply-To: <20100421120427.GA10970@samir>
References: <20100420151657.GA32632@samir>
	<alpine.LRH.2.00.1004201723450.31288@reclus.nhh.no>
	<4BCE18F2.8080909@sociologi.cjb.net> <20100421075950.GA16006@samir>
	<alpine.LRH.2.00.1004211339130.2078@reclus.nhh.no>
	<20100421120427.GA10970@samir>
Message-ID: <alpine.LRH.2.00.1004211511280.2367@reclus.nhh.no>

On Wed, 21 Apr 2010, Hans Ekbrand wrote:

> On Wed, Apr 21, 2010 at 01:42:05PM +0200, Roger Bivand wrote:
>> So you do not want hclust at all, really. Look at dnearneigh() in spdep,
>> setting a 100m bound. Then use n.comp.nb() to see which points belong to
>> which graph component, using perhaps plot.nb with colours to distinguish
>> the subgraphs.
>
> Well, hclust was useful, once I understood how cutree works. What
> would be the benefit of dnearneigh(), is it faster?
>

For larger data sets, hclust needs a triangular distance matrix, 
dnearneigh does not. Finding graph components in the output "nb" object 
also seems conceptually more direct. But if your solution works for you, 
that is fine.

Roger

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Wed Apr 21 15:19:25 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 21 Apr 2010 15:19:25 +0200 (CEST)
Subject: [R-sig-Geo] Lagrange multiplier tests for weighted least squares
In-Reply-To: <A44B2473B67B4B04BB126F7C81DF75A7@Ciretto>
References: <A44B2473B67B4B04BB126F7C81DF75A7@Ciretto>
Message-ID: <alpine.LRH.2.00.1004211515040.2367@reclus.nhh.no>

On Wed, 21 Apr 2010, Roberto Patuelli wrote:

> Hi everyone,
>
> The help file for the spdep command "lm.LMtests" for running Lagrange 
> multiplier tests per spatial dependence suggests not to use weights in the lm 
> object given as argument.
> If weights are highly relevant for a certain model (for example, because of 
> strong heterogeneity in the size/importance of the regions being analysed), 
> is there a way to get around this limitation? I struggle to find anything 
> online relating weighted least squares and LM tests for spatial dependence.

I think econometricians, spatial or not, typically do not "do" weights, 
but prefer to use HAC or similar standard errors. LM tests are fro the 
spatial econometrics approach, so they do not accommodate weights. To add 
them would mean doing the math to see where in the development the omega 
should be added into the spatial process, then one would need to show that 
the tests perform as expected. Nice paper if one had time!

Roger

>
> Thanks for the help.
> Roberto
>
> ********************
> Roberto Patuelli, Ph.D.
> Istituto Ricerche Economiche (IRE) (Institute for Economic Research)
> Universit? della Svizzera Italiana (University of Lugano)
> via Maderno 24, CP 4361
> CH-6904 Lugano
> Switzerland
> Phone: +41-(0)58-666-4166
> Fax: +39-02-700419665
> Email: roberto.patuelli at usi.ch
> Homepage: http://www.people.lu.unisi.ch/patuellr
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From hans at sociologi.cjb.net  Wed Apr 21 15:24:30 2010
From: hans at sociologi.cjb.net (Hans Ekbrand)
Date: Wed, 21 Apr 2010 15:24:30 +0200
Subject: [R-sig-Geo] complete linkage Agglomerative
	hierarchical	clustering, nnclust, spatclus or something else?
In-Reply-To: <alpine.LRH.2.00.1004211511280.2367@reclus.nhh.no>
References: <20100420151657.GA32632@samir>
	<alpine.LRH.2.00.1004201723450.31288@reclus.nhh.no>
	<4BCE18F2.8080909@sociologi.cjb.net> <20100421075950.GA16006@samir>
	<alpine.LRH.2.00.1004211339130.2078@reclus.nhh.no>
	<20100421120427.GA10970@samir>
	<alpine.LRH.2.00.1004211511280.2367@reclus.nhh.no>
Message-ID: <20100421132429.GB10970@samir>

On Wed, Apr 21, 2010 at 03:14:46PM +0200, Roger Bivand wrote:
> On Wed, 21 Apr 2010, Hans Ekbrand wrote:

[...]

>> Well, hclust was useful, once I understood how cutree works. What
>> would be the benefit of dnearneigh(), is it faster?
>>
>
> For larger data sets, hclust needs a triangular distance matrix,  
> dnearneigh does not. Finding graph components in the output "nb" object  
> also seems conceptually more direct. 

OK, good to know if I run into trouble when using the code on larger
data-sets later on.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100421/2f074037/attachment.bin>

From tlumley at u.washington.edu  Wed Apr 21 17:53:21 2010
From: tlumley at u.washington.edu (Thomas Lumley)
Date: Wed, 21 Apr 2010 08:53:21 -0700 (PDT)
Subject: [R-sig-Geo] complete linkage Agglomerative hierarchical
 clustering, nnclust, spatclus or something else?
In-Reply-To: <20100421132429.GB10970@samir>
Message-ID: <alpine.LRH.2.01.1004210853210.7039@hymn31.u.washington.edu>



You asked earlier about nnclust:  it does single-linkage rather than complete-linkage clustering, that is, it defines clusters so that each point in the cluster has a nearest neighbour in the cluster closer than the threshold distance. This produces much less circular clusters than complete-linkage clustering.

The main distinctive feature of nnclust is that it is feasible even for quite large data sets, taking linear space and roughly nlogn time.

         -thomas


On Wed, 21 Apr 2010, Hans Ekbrand wrote:

> On Wed, Apr 21, 2010 at 03:14:46PM +0200, Roger Bivand wrote:
>> On Wed, 21 Apr 2010, Hans Ekbrand wrote:
>
> [...]
>
>>> Well, hclust was useful, once I understood how cutree works. What
>>> would be the benefit of dnearneigh(), is it faster?
>>>
>>
>> For larger data sets, hclust needs a triangular distance matrix,
>> dnearneigh does not. Finding graph components in the output "nb" object
>> also seems conceptually more direct.
>
> OK, good to know if I run into trouble when using the code on larger
> data-sets later on.
>

Thomas Lumley			Assoc. Professor, Biostatistics
tlumley at u.washington.edu	University of Washington, Seattle


From grant.j.gillis at gmail.com  Wed Apr 21 18:06:29 2010
From: grant.j.gillis at gmail.com (Grant Gillis)
Date: Wed, 21 Apr 2010 12:06:29 -0400
Subject: [R-sig-Geo] converting lat/long to North American lambert x/y
Message-ID: <v2me7529c931004210906nfff7bafav5e0af8b20bf1afbe@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100421/88c61f34/attachment.pl>

From horacio.samaniego at gmail.com  Wed Apr 21 18:07:20 2010
From: horacio.samaniego at gmail.com (Horacio Samaniego)
Date: Wed, 21 Apr 2010 12:07:20 -0400
Subject: [R-sig-Geo] memory limit...
Message-ID: <p2zcde5e0661004210907n227cf405z779c3a84237849a2@mail.gmail.com>

I'm trying to import a grass raster using

library(spgrass6)
a = paste("prec",1:12,sep="")
prec = readRAST6(a)


this usually will create a SpatialGridDataFrame object width my 12
grass rasters in the 'data' slot.

Howvere, I'm running intospace limitations in spite of having 8GB of
Ram and large HD at the disposition of the CPU (2.9GHz Quad-Core)

I have tryed will little succed to star R with several flags to
increase the memory. But I recognize to be lost in what part of the
problem is due to the linux OS and which to R.

Could anyone give me some guidelines on how to provide more memory to
import raster maps under the sp model?

will summarize!

thanks


From Thomas.Adams at noaa.gov  Wed Apr 21 20:15:39 2010
From: Thomas.Adams at noaa.gov (Thomas Adams)
Date: Wed, 21 Apr 2010 14:15:39 -0400
Subject: [R-sig-Geo] Trying to read a list of maps using readRAST6
Message-ID: <4BCF40CB.6040306@noaa.gov>

All:

With sp & spgrass6 I have no problem reading a list of maps with 
readRAST6 when I do the following:

data<-readRAST6(c("map1","map2","map3",?))

however, I need to do this dynamically within a script, for example:

 > inputfile<-Sys.getenv("R_INPUT_FILE")
 > map_list<-scan(inputfile,list(""))

Read 21 records

 > map_list

[[1]]
[1] "sref_em.t09z.pgrb212.ctl" "sref_em.t09z.pgrb212.n1"
[3] "sref_em.t09z.pgrb212.n2" "sref_em.t09z.pgrb212.p1"
[5] "sref_em.t09z.pgrb212.p2" "sref_eta.t09z.pgrb212.ctl1"
[7] "sref_eta.t09z.pgrb212.ctl2" "sref_eta.t09z.pgrb212.n1"
[9] "sref_eta.t09z.pgrb212.n2" "sref_eta.t09z.pgrb212.p1"
[11] "sref_eta.t09z.pgrb212.p2" "sref_nmm.t09z.pgrb212.ctl"
[13] "sref_nmm.t09z.pgrb212.n1" "sref_nmm.t09z.pgrb212.n2"
[15] "sref_nmm.t09z.pgrb212.p1" "sref_nmm.t09z.pgrb212.p2"
[17] "sref_rsm.t09z.pgrb212.ctl1" "sref_rsm.t09z.pgrb212.n1"
[19] "sref_rsm.t09z.pgrb212.n2" "sref_rsm.t09z.pgrb212.p1"
[21] "sref_rsm.t09z.pgrb212.p2"


data<-readRAST6(map_list)
spplot(data,?)

What happens is that "map_list" is treated literally, not as: 
data<-readRAST6(c("map1","map2","map3",?)) which works. I have tried a 
number of things, such as:

data<-readRAST6(as.list(map_list))
data<-readRAST6(c(map_list))
data<-readRAST6(as.vector(map_list))
data<-readRAST6(eval(map_list))

How do I do this?

Regards,
Tom

-- 
Thomas E Adams
National Weather Service
Ohio River Forecast Center
1901 South State Route 134
Wilmington, OH 45177

EMAIL:	thomas.adams at noaa.gov

VOICE:	937-383-0528
FAX:	937-383-0033


From edzer.pebesma at uni-muenster.de  Wed Apr 21 20:48:58 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 21 Apr 2010 20:48:58 +0200
Subject: [R-sig-Geo] Trying to read a list of maps using readRAST6
In-Reply-To: <4BCF40CB.6040306@noaa.gov>
References: <4BCF40CB.6040306@noaa.gov>
Message-ID: <4BCF489A.3030505@uni-muenster.de>

Thomas, perhaps:

data <- readRAST6(map_list[[1]])

as map_list is a list, and readRAST6 seems to want a character vector,
which is in the first list element of map_list.

Thomas Adams wrote:
> All:
> 
> With sp & spgrass6 I have no problem reading a list of maps with
> readRAST6 when I do the following:
> 
> data<-readRAST6(c("map1","map2","map3",?))
> 
> however, I need to do this dynamically within a script, for example:
> 
>> inputfile<-Sys.getenv("R_INPUT_FILE")
>> map_list<-scan(inputfile,list(""))
> 
> Read 21 records
> 
>> map_list
> 
> [[1]]
> [1] "sref_em.t09z.pgrb212.ctl" "sref_em.t09z.pgrb212.n1"
> [3] "sref_em.t09z.pgrb212.n2" "sref_em.t09z.pgrb212.p1"
> [5] "sref_em.t09z.pgrb212.p2" "sref_eta.t09z.pgrb212.ctl1"
> [7] "sref_eta.t09z.pgrb212.ctl2" "sref_eta.t09z.pgrb212.n1"
> [9] "sref_eta.t09z.pgrb212.n2" "sref_eta.t09z.pgrb212.p1"
> [11] "sref_eta.t09z.pgrb212.p2" "sref_nmm.t09z.pgrb212.ctl"
> [13] "sref_nmm.t09z.pgrb212.n1" "sref_nmm.t09z.pgrb212.n2"
> [15] "sref_nmm.t09z.pgrb212.p1" "sref_nmm.t09z.pgrb212.p2"
> [17] "sref_rsm.t09z.pgrb212.ctl1" "sref_rsm.t09z.pgrb212.n1"
> [19] "sref_rsm.t09z.pgrb212.n2" "sref_rsm.t09z.pgrb212.p1"
> [21] "sref_rsm.t09z.pgrb212.p2"
> 
> 
> data<-readRAST6(map_list)
> spplot(data,?)
> 
> What happens is that "map_list" is treated literally, not as:
> data<-readRAST6(c("map1","map2","map3",?)) which works. I have tried a
> number of things, such as:
> 
> data<-readRAST6(as.list(map_list))
> data<-readRAST6(c(map_list))
> data<-readRAST6(as.vector(map_list))
> data<-readRAST6(eval(map_list))
> 
> How do I do this?
> 
> Regards,
> Tom
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From wmconnol at ncsu.edu  Wed Apr 21 21:21:38 2010
From: wmconnol at ncsu.edu (Mark Connolly)
Date: Wed, 21 Apr 2010 15:21:38 -0400
Subject: [R-sig-Geo] range from fit.variogram
Message-ID: <1271877698.5945.8.camel@localhost>

I think the range determined by fit.variogram is not the "practical"
range as mentioned in Applied Spatial Data Analysis with R.  Do I have
this right?  To get the range used for interpolation, I adjust the range
(eg. 3^0.5 * range)?


From edzer.pebesma at uni-muenster.de  Wed Apr 21 21:44:11 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 21 Apr 2010 21:44:11 +0200
Subject: [R-sig-Geo] range from fit.variogram
In-Reply-To: <1271877698.5945.8.camel@localhost>
References: <1271877698.5945.8.camel@localhost>
Message-ID: <4BCF558B.90501@uni-muenster.de>

That is right, Mark; the adjustment factor is dependent on the model
used (Gaussian, it seems, in your case); e.g. for the exponential it
would be 3 * a. And of course depends also on how you define practical
range in the cases where the variogram reaches the sill asymptotically.
--
Edzer

Mark Connolly wrote:
> I think the range determined by fit.variogram is not the "practical"
> range as mentioned in Applied Spatial Data Analysis with R.  Do I have
> this right?  To get the range used for interpolation, I adjust the range
> (eg. 3^0.5 * range)?
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From Thomas.Adams at noaa.gov  Wed Apr 21 22:00:08 2010
From: Thomas.Adams at noaa.gov (Thomas Adams)
Date: Wed, 21 Apr 2010 16:00:08 -0400
Subject: [R-sig-Geo] Trying to read a list of maps using readRAST6
In-Reply-To: <4BCF489A.3030505@uni-muenster.de>
References: <4BCF40CB.6040306@noaa.gov> <4BCF489A.3030505@uni-muenster.de>
Message-ID: <4BCF5948.90904@noaa.gov>

Robert,

My apologies, your suggestion

data<-readRAST6(unlist(map_list))

did work, only I had another error in my scripting that made it appear 
that your suggestion was not working. Thank you so much for your help. 
I'm still very much a novice with most of R!

Regards,
Tom


Edzer Pebesma wrote:
> Thomas, perhaps:
>
> data <- readRAST6(map_list[[1]])
>
> as map_list is a list, and readRAST6 seems to want a character vector,
> which is in the first list element of map_list.
>
> Thomas Adams wrote:
>   
>> All:
>>
>> With sp & spgrass6 I have no problem reading a list of maps with
>> readRAST6 when I do the following:
>>
>> data<-readRAST6(c("map1","map2","map3",?))
>>
>> however, I need to do this dynamically within a script, for example:
>>
>>     
>>> inputfile<-Sys.getenv("R_INPUT_FILE")
>>> map_list<-scan(inputfile,list(""))
>>>       
>> Read 21 records
>>
>>     
>>> map_list
>>>       
>> [[1]]
>> [1] "sref_em.t09z.pgrb212.ctl" "sref_em.t09z.pgrb212.n1"
>> [3] "sref_em.t09z.pgrb212.n2" "sref_em.t09z.pgrb212.p1"
>> [5] "sref_em.t09z.pgrb212.p2" "sref_eta.t09z.pgrb212.ctl1"
>> [7] "sref_eta.t09z.pgrb212.ctl2" "sref_eta.t09z.pgrb212.n1"
>> [9] "sref_eta.t09z.pgrb212.n2" "sref_eta.t09z.pgrb212.p1"
>> [11] "sref_eta.t09z.pgrb212.p2" "sref_nmm.t09z.pgrb212.ctl"
>> [13] "sref_nmm.t09z.pgrb212.n1" "sref_nmm.t09z.pgrb212.n2"
>> [15] "sref_nmm.t09z.pgrb212.p1" "sref_nmm.t09z.pgrb212.p2"
>> [17] "sref_rsm.t09z.pgrb212.ctl1" "sref_rsm.t09z.pgrb212.n1"
>> [19] "sref_rsm.t09z.pgrb212.n2" "sref_rsm.t09z.pgrb212.p1"
>> [21] "sref_rsm.t09z.pgrb212.p2"
>>
>>
>> data<-readRAST6(map_list)
>> spplot(data,?)
>>
>> What happens is that "map_list" is treated literally, not as:
>> data<-readRAST6(c("map1","map2","map3",?)) which works. I have tried a
>> number of things, such as:
>>
>> data<-readRAST6(as.list(map_list))
>> data<-readRAST6(c(map_list))
>> data<-readRAST6(as.vector(map_list))
>> data<-readRAST6(eval(map_list))
>>
>> How do I do this?
>>
>> Regards,
>> Tom
>>
>>     
>
>   


-- 
Thomas E Adams
National Weather Service
Ohio River Forecast Center
1901 South State Route 134
Wilmington, OH 45177

EMAIL:	thomas.adams at noaa.gov

VOICE:	937-383-0528
FAX:	937-383-0033


From edzer.pebesma at uni-muenster.de  Wed Apr 21 22:38:09 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 21 Apr 2010 22:38:09 +0200
Subject: [R-sig-Geo] memory limit...
In-Reply-To: <p2zcde5e0661004210907n227cf405z779c3a84237849a2@mail.gmail.com>
References: <p2zcde5e0661004210907n227cf405z779c3a84237849a2@mail.gmail.com>
Message-ID: <4BCF6231.5080507@uni-muenster.de>



Horacio Samaniego wrote:
> I'm trying to import a grass raster using
> 
> library(spgrass6)
> a = paste("prec",1:12,sep="")
> prec = readRAST6(a)
> 
> 
> this usually will create a SpatialGridDataFrame object width my 12
> grass rasters in the 'data' slot.
> 
> Howvere, I'm running intospace limitations in spite of having 8GB of
> Ram and large HD at the disposition of the CPU (2.9GHz Quad-Core)
> 
> I have tryed will little succed to star R with several flags to
> increase the memory. But I recognize to be lost in what part of the
> problem is due to the linux OS and which to R.

If the linux version is 64 bits, it will have no problem using all your
memory for a single process (R). Check it with:

$ uname -a
Linux ... 2.6.26-2-amd64 #1 SMP Thu Feb 11 00:59:32 UTC 2010 x86_64
GNU/Linux

the x86_64 here indicates it's a 64 bit platform. If you installed a 32
bit platform, processes are limited to 4 Gb, 3 Gb on a standard ubuntu
kernel, so you're lost, basically, until you reinstall linux.

> 
> Could anyone give me some guidelines on how to provide more memory to
> import raster maps under the sp model?

There is always the possibility that your maps are simply too large. How
large are they? Have you tried to import a single one? Two simple
thoughts: buy more RAM, or increase your swap space (and be patient).

Alternatives are to use package gdal, and not read the complete map in
memory but go through it tile by tile using [ to select, or use package
raster which is on r-forge.
-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From hengl at spatial-analyst.net  Wed Apr 21 23:35:22 2010
From: hengl at spatial-analyst.net (Tomislav Hengl)
Date: Wed, 21 Apr 2010 23:35:22 +0200
Subject: [R-sig-Geo] converting lat/long to North American lambert x/y
In-Reply-To: <v2me7529c931004210906nfff7bafav5e0af8b20bf1afbe@mail.gmail.com>
References: <v2me7529c931004210906nfff7bafav5e0af8b20bf1afbe@mail.gmail.com>
Message-ID: <49f7d23d2789fee98d4e131b0a01d0ad.squirrel@spatial-analyst.net>


You should use the proj4 functionality implemented in the rgdal package.
This is what I get:

> library(rgdal)
Geospatial Data Abstraction Library extensions to R successfully loaded
Loaded GDAL runtime: GDAL 1.7.0dev, released 2008/11/26
Path to GDAL shared files: C:/PROGRA~1/R/R-210~1.0/library/rgdal/gdal
Loaded PROJ.4 runtime: Rel. 4.6.1, 21 August 2008
Path to PROJ.4 shared files: C:/PROGRA~1/R/R-210~1.0/library/rgdal/proj
# pan-american projection:
> AEA <- "+proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23 +lon_0=-96 +x_0=0
+y_0=0 +ellps=GRS80 +datum=NAD83 +units=m +no_defs"
> pnts <- data.frame(lat=c(39.953438, 45.271987), long=c(-119.511746,
-97.339382))
> coordinates(pnts) <- ~long+lat
> proj4string(pnts) <- CRS("+proj=longlat +ellps=WGS84")
> spTransform(pnts, CRS(AEA))
SpatialPoints:
           long     lat
[1,] -1970668.1 2126789
[2,]  -105037.3 2476717
Coordinate Reference System (CRS)
arguments: +proj=aea +lat_1=29.5
+lat_2=45.5 +lat_0=23 +lon_0=-96
+x_0=0 +y_0=0 +ellps=GRS80
+datum=NAD83 +units=m +no_defs
+towgs84=0,0,0

# your projection:
> LCC <- "+proj=lcc +lat_1=20 +lat_2=60 +lat_0=40 +lon_0=-96 +x_0=0
+y_0=0 +ellps=GRS80 +datum=NAD83 +units=m +no_defs"
> spTransform(pnts, CRS(LCC))
SpatialPoints:
            long      lat
[1,] -1864716.27 248057.1
[2,]   -98990.79 551251.4
Coordinate Reference System (CRS)
arguments: +proj=lcc +lat_1=20
+lat_2=60 +lat_0=40 +lon_0=-96
+x_0=0 +y_0=0 +ellps=GRS80
+datum=NAD83 +units=m +no_defs
+towgs84=0,0,0


Hmmm, if you set-up the datum to NAD83, then (I think) you should not
get +towgs84=0,0,0 but it looks like these two things are compatible.

HTH

T. Hengl
More examples with US data: http://spatial-analyst.net/book/NGS.R

> Hello List,
>
> Thanks for any help in advance!  I am new to spatial analysis in R and in
> general and so apologize if I am missing something simple.
>
> I have a set of lat/long coordinates that span North America and I would
> like to convert them to utm's (North_America_Lambert_Conformal_Conic).  I
> have attempted to do this using the mapproject command in the mapproj
> library but I keep getting strangely low utm's.  My attempts are
> replicated
> below
>
> My map attributes:
>
>> summary(NAm)
> Object of class SpatialPolygonsDataFrame
> Coordinates:
>         min     max
> r1 -4907279 4031980
> r2 -3453182 5806061
> Is projected: TRUE
> proj4string :
> [+proj=lcc +lat_1=20 +lat_2=60 +lat_0=40 +lon_0=-96 +x_0=0 +y_0=0
> +ellps=GRS80 +datum=NAD83 +units=m +no_defs +towgs84=0,0,0]
> Data attributes:
> North America
>             1
>
> sample lat/longs:
>
> x <-    c(39.953438, 45.271987, 43.179207, 49.8703, 41.864192, 47.0049,
> 54.727594, 48.719167, 41.338611, 49, 51.363957, 45.187723, 50.203889,
> 50.094167, 27.479949, 51.384852, 58.943633, 52.4, 55.87)
> y <-    c(-119.511746, -97.339382, -112.280316, -88.939133, -121.144867,
> -99.435282, -107.509804, -88.458611, -112.858611, -94.666667, -105.239754,
> -96.130199, -88.758333, -88.337222, -97.314835,    -96.550598, -113.24913,
> -123.05, -115.3275)
>
> coords<-as.data.frame(cbind(x,y))
>
> My code and results:
>
>> x <-    c(39.953438, 45.271987, 43.179207, 49.8703, 41.864192, 47.0049,
> 54.727594, 48.719167, 41.338611, 49, 51.363957, 45.187723, 50.203889,
> 50.094167, 27.479949, 51.384852, 58.943633, 52.4, 55.87)
>> y <-    c(-119.511746, -97.339382, -112.280316, -88.939133, -121.144867,
> -99.435282, -107.509804, -88.458611, -112.858611, -94.666667, -105.239754,
> -96.130199, -88.758333, -88.337222, -97.314835,    -96.550598, -113.24913,
> -123.05, -115.3275)
>>
>> coords<-as.data.frame(cbind(x,y))
>>
>>
>>
>> mapproject((coords), projection = "lambert", param = c(20, 60),
> orientation = c(40,-96,0))
> $x
>  [1] -0.34331799 -0.11436538 -0.27206521  0.01792251 -0.33693782
> -0.13471935
> -0.16832946  0.02711496 -0.28870789 -0.07032821 -0.17079579
> [12] -0.09824454  0.02089270  0.02835444 -0.15848767 -0.08855674
> -0.17102350
> -0.25815791 -0.20128084
>
> $y
>  [1] -1.401480 -1.797972 -1.514287 -1.986024 -1.369876 -1.750728 -1.574392
> -1.997333 -1.509375 -1.851279 -1.624597 -1.823937 -1.990606 -2.001015
> [15] -1.834957 -1.806036 -1.463011 -1.315917 -1.432837
>
> $range
> [1] -0.34331799  0.02835444 -2.00101509 -1.31591678
>
> $error
> [1] 0
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From corey.sparks at utsa.edu  Thu Apr 22 05:03:25 2010
From: corey.sparks at utsa.edu (Corey Sparks)
Date: Wed, 21 Apr 2010 22:03:25 -0500
Subject: [R-sig-Geo] Help with defining local spatial clustering: local.moran
Message-ID: <07A52224-AEDA-4F99-9407-C4C499894987@utsa.edu>

Hello all,
I have a question that I hope the list may be able to help with.
So I understand how the LISA application of the Local Moran statistic
works in terms of calculating local moran's I.  The thing I'm wrestling
with is how, say in GeoDA or ArcGIS, the local clusters are defined  
and mapped.  Say you
have an area that is a high-high cluster, I'm assuming that this is an
area that has a high z-score for the attribute, and a high z-score for
the lagged value of the attribute. Although the local.moran function  
will calculate the local estimate of the moran's I, but how can you go  
about mapping the type of local cluster.
  If I were to do this in R, I would
do something like:

xx <- readShapePoly(system.file("shapes/sids.shp", package="maptools") 
[1], IDvar="FIPSNO", proj4string=CRS("+proj=longlat +ellps=clrk66"))

sid.nb<-poly2nb(xx)
lw<-nb2listw(sid.nb)
xx$rt79<-xx$SID79/xx$BIR79
my.moran<-function (x, listw, zero.policy = FALSE)
{
   require(RColorBrewer)
require(spdep)
    wx<-lag.listw(listw, x)
     lag.z<-scale(wx, center=T, scale=T)
     dat.z<-scale(x, center=T, scale=T)
     mor.dat<-data.frame(lz=lag.z, z=dat.z)
     mor.dat$clusters<-"UN"
     mor.dat$clusters[mor.dat$lz>1&mor.dat$z>1]<-"HH"   #both z scores  
are "high"
     mor.dat$clusters[mor.dat$lz< -1&mor.dat$z< -1]<-"LL"  #both z  
scores are "low"
     mor.dat$clusters[mor.dat$lz>1&mor.dat$z< -1]<-"LH"  #one z score  
high, the other low
     mor.dat$clusters[mor.dat$lz< -1&mor.dat$z>1]<-"HL"

#Where UN = unclustered, HH=high/high, HL=high/low, LH=low/high,  
LL=low/low

   cols<-brewer.pal(5, "RdBu")
   mor.dat$col[mor.dat$clusters=="UN"]<-cols[3]
   mor.dat$col[mor.dat$clusters=="HH"]<-cols[1]
   mor.dat$col[mor.dat$clusters=="LL"]<-cols[5]
   mor.dat$col[mor.dat$clusters=="HL"]<-cols[2]
   mor.dat$col[mor.dat$clusters=="LH"]<-cols[4]
   mor.dat
   }

test<-my.moran(xx$rt79, lw)

plot(xx, col=test$col)

Is this effectively what geoda/arc-gis, etc that makes these cluster
plots is doing?  I know that this is not based on a randomisation
methodology, and am pretty sure i'm missing something, but i'm just  
trying to answer the rudimentary question on how the local clusters  
are defined and mapped.
Any advice would be welcomed.
Thanks,
Corey Sparks


Corey Sparks
Assistant Professor
Department of Demography and Organization Studies
College of Public Policy
501 West Durango Blvd
Monterrey Building 2.270C
San Antonio, TX 78207
corey.sparks 'at' utsa.edu
210 458 3166


From sjmyers at syr.edu  Thu Apr 22 06:40:53 2010
From: sjmyers at syr.edu (Seth J Myers)
Date: Thu, 22 Apr 2010 04:40:53 +0000
Subject: [R-sig-Geo] Moran's I with a twist?
Message-ID: <266CBFBFD14254478D52158AE6BF90170C3245BB@BL2PRD0103MB038.prod.exchangelabs.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100422/f497ef15/attachment.pl>

From german.sanchez at ais-int.com  Thu Apr 22 14:03:21 2010
From: german.sanchez at ais-int.com (German Sanchez Hernandez)
Date: Thu, 22 Apr 2010 14:03:21 +0200
Subject: [R-sig-Geo] Adding a shape with writeOGR
Message-ID: <224BDB65-4FB8-4396-BC31-F0F280CE5BC1@ais-int.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100422/a40fa042/attachment.pl>

From roman.lustrik at gmail.com  Thu Apr 22 14:05:44 2010
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Thu, 22 Apr 2010 14:05:44 +0200
Subject: [R-sig-Geo] assigning raster cell values based on predefined
	criteria
In-Reply-To: <w2ldc22b2571004200955w5a55dc17p19a76406591a09c2@mail.gmail.com>
References: <t2z63a206011004200023sd7800674u40e511be7f88e5ea@mail.gmail.com> 
	<w2ldc22b2571004200955w5a55dc17p19a76406591a09c2@mail.gmail.com>
Message-ID: <y2u63a206011004220505s391c0160s677a92ad77737ba1@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100422/b313c5e5/attachment.pl>

From marcelino.delacruz at upm.es  Thu Apr 22 14:54:11 2010
From: marcelino.delacruz at upm.es (Marcelino de la Cruz)
Date: Thu, 22 Apr 2010 14:54:11 +0200
Subject: [R-sig-Geo] assigning raster cell values based on predefined
 criteria
In-Reply-To: <y2u63a206011004220505s391c0160s677a92ad77737ba1@mail.gmail .com>
References: <t2z63a206011004200023sd7800674u40e511be7f88e5ea@mail.gmail.com>
	<w2ldc22b2571004200955w5a55dc17p19a76406591a09c2@mail.gmail.com>
	<y2u63a206011004220505s391c0160s677a92ad77737ba1@mail.gmail.com>
Message-ID: <201004221254.o3MCsCt3014088@edison.ccupm.upm.es>


How about this?:

library(spatstat)

library(maptools)

# A example of polygon:
  ho_sp <- 
SpatialPolygons(list(Polygons(list(Polygon(cbind(c(0,1,1,0,0), 
c(0,0,1,1,0)))), ID="ho")))
plot(ho_sp)
ho.win <- as(ho_sp,"owin")
ho.mask <- as.mask(ho.win)
ho.dist<-bdist.pixels(ho.mask)
plot(ho.dist)

ho.dist$v[1:10,1:5]



HTH,

Marcelino










At 14:05 22/04/2010, Roman Lu?trik wrote:
>Content-Type: text/plain
>Content-Disposition: inline
>Content-length: 3181
>
>This is the normal behavior (see image
>here<http://imagepaste.nullnetwork.net/viewimage.php?id=837>)
>when I use option A-ish (calculating distance to a single point).
>
>Intuitively, however, I would expect the plot to look something like
>this (crudely
>drawn for your 
>amusement<http://imagepaste.nullnetwork.net/viewimage.php?id=838>).
>Can someone explain the logic behind the "tiled" pattern?
>
>They say a picture is worth a thousand words - hopefully, this is the case
>here and my question is clear.
>
>
>
>Cheers,
>Roman
>
>
>On Tue, Apr 20, 2010 at 6:55 PM, Robert J. Hijmans <r.hijmans at gmail.com>wrote:
>
> > Dear Roman,
> >
> > I think it depends on your data. Below are two examples (both assuming
> > your polygons do not overlap).
> >
> > A) works if each cell in a polygon is closest to its own centroid (and
> > not that of another polygon). It makes a distance surface with
> > distanceFromPoints() and then uses mask() to mask out the areas not
> > covered by polygons.
> >
> > B) uses linesToRaster() to set up a raster with impenetrable
> > boundaries (the polygon outlines) and then use gridDistance()  (i.e.
> > the distance when only allowed to traverse certain cells). This method
> > would fail if you have a polygon representing several islands; or a
> > polygon with a hole with the centroid inside that hole. Also, you do
> > not have values for the outer cells of a polygon. This is perhaps OK
> > when polygons are adjacent (whose cell is it anyway?). If they are not
> > adjacent yo could use edge() with 'outer' argument on the rasterized
> > polygons instead of linesToRaster
> >
> > library(raster)
> > p1 <- rbind(c(-180,-20), c(-140,55), c(-20, 0), c(-140,-60), c(-180,-20))
> > hole <- rbind(c(-150,-20), c(-100,-10), c(-110,20), c(-150,-20))
> > p2 <- rbind(c(-10,0), c(140,60), c(160,0), c(140,-55), c(-10,0))
> > pols <- SpatialPolygons( list(  Polygons(list(Polygon(p1)), 1),
> > Polygons(list(Polygon(p2)), 2)))
> > xy <- coordinates(pols)
> >
> > #A
> > r <- raster(nrow=18, ncol=36)
> > r <- polygonsToRaster(pols, r)
> > d <- distanceFromPoints(r, xy)
> > x <- mask(d, r)
> > plot(x)
> >
> > #B
> > r <- raster(nrow=18, ncol=36)
> > r <- polygonsToRaster(pols, r)
> > l <- linesToRaster(pols, r)
> > l[l>0] <- 0
> > p <- pointsToRaster(r, xy)
> > pp <- cover(p, l)
> > gd <- gridDistance(pp)
> > gd[!is.na(l)] <- NA
> > plot(gd)
> >
> >
> > Robert
> >
> > On Tue, Apr 20, 2010 at 12:23 AM, Roman Lu?trik <roman.lustrik at gmail.com>
> > wrote:
> > > Dear list,
> > >
> > > I have a polygon that I converted to raster (kudos to
> > polygonsToRaster()). I
> > > would like to assign values (through a custom function) to cells within
> > this
> > > polygon (now as raster). Roughly speaking, cell value will depend on its
> > > distance from the central cell (polygon centroid). How would you go about
> > > doing this? Is there a more efficient way of doing this, or will I have
> > to
> > > hard code it, cell by cell?
> > >
> > > Cheers,
> > > Roman
> > >
> > >        [[alternative HTML version deleted]]
> > >
> > > _______________________________________________
> > > R-sig-Geo mailing list
> > > R-sig-Geo at stat.math.ethz.ch
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > >
> >
>
>
>
>--
>In God we trust, all others bring data.
>
>         [[alternative HTML version deleted]]
>
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at stat.math.ethz.ch
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo

________________________________

Marcelino de la Cruz Rot

Departamento de  Biolog?a Vegetal
E.U.T.I. Agr?cola
Universidad Polit?cnica de Madrid
28040-Madrid
Tel.: 91 336 54 35
Fax: 91 336 56 56
marcelino.delacruz at upm.es
_________________________________ 


From marcelino.delacruz at upm.es  Thu Apr 22 15:21:18 2010
From: marcelino.delacruz at upm.es (Marcelino de la Cruz)
Date: Thu, 22 Apr 2010 15:21:18 +0200
Subject: [R-sig-Geo] assigning raster cell values based on predefined
 criteria
In-Reply-To: <201004221254.o3MCsCt3014088@edison.ccupm.upm.es>
References: <t2z63a206011004200023sd7800674u40e511be7f88e5ea@mail.gmail.com>
	<w2ldc22b2571004200955w5a55dc17p19a76406591a09c2@mail.gmail.com>
	<y2u63a206011004220505s391c0160s677a92ad77737ba1@mail.gmail.com>
	<201004221254.o3MCsCt3014088@edison.ccupm.upm.es>
Message-ID: <201004221321.o3MDLIWQ018996@edison.ccupm.upm.es>


Sorry, that was the distance to the border of the polygon.




For the distance to the centroid:

# A example of polygon:
  ho_sp <- 
SpatialPolygons(list(Polygons(list(Polygon(cbind(c(0,1,1,0,0), 
c(0,0,1,1,0)))), ID="ho")))

ho.win <- as(ho_sp,"owin")

centroide <- centroid.owin(ho.win)
h2.ppp<-ppp(centroide$x, centroide$y, window=ho.win)
ho.dist<-distmap(h2.ppp)

plot(ho.dist)
ho.dist$v[1:5,1:5]



HNTH,

Marcelino


At 14:54 22/04/2010, Marcelino de la Cruz wrote:

>How about this?:
>
>library(spatstat)
>
>library(maptools)
>
># A example of polygon:
>  ho_sp <- 
> SpatialPolygons(list(Polygons(list(Polygon(cbind(c(0,1,1,0,0), 
> c(0,0,1,1,0)))), ID="ho")))
>plot(ho_sp)
>ho.win <- as(ho_sp,"owin")
>ho.mask <- as.mask(ho.win)
>ho.dist<-bdist.pixels(ho.mask)
>plot(ho.dist)
>
>ho.dist$v[1:10,1:5]
>
>
>
>HTH,
>
>Marcelino
>
>
>
>
>
>
>
>
>
>
>At 14:05 22/04/2010, Roman Lu?trik wrote:
>>Content-Type: text/plain
>>Content-Disposition: inline
>>Content-length: 3181
>>
>>This is the normal behavior (see image
>>here<http://imagepaste.nullnetwork.net/viewimage.php?id=837>)
>>when I use option A-ish (calculating distance to a single point).
>>
>>Intuitively, however, I would expect the plot to look something like
>>this (crudely
>>drawn for your 
>>amusement<http://imagepaste.nullnetwork.net/viewimage.php?id=838>).
>>Can someone explain the logic behind the "tiled" pattern?
>>
>>They say a picture is worth a thousand words - hopefully, this is the case
>>here and my question is clear.
>>
>>
>>
>>Cheers,
>>Roman
>>
>>
>>On Tue, Apr 20, 2010 at 6:55 PM, Robert J. 
>>Hijmans <r.hijmans at gmail.com>wrote:
>>
>> > Dear Roman,
>> >
>> > I think it depends on your data. Below are two examples (both assuming
>> > your polygons do not overlap).
>> >
>> > A) works if each cell in a polygon is closest to its own centroid (and
>> > not that of another polygon). It makes a distance surface with
>> > distanceFromPoints() and then uses mask() to mask out the areas not
>> > covered by polygons.
>> >
>> > B) uses linesToRaster() to set up a raster with impenetrable
>> > boundaries (the polygon outlines) and then use gridDistance()  (i.e.
>> > the distance when only allowed to traverse certain cells). This method
>> > would fail if you have a polygon representing several islands; or a
>> > polygon with a hole with the centroid inside that hole. Also, you do
>> > not have values for the outer cells of a polygon. This is perhaps OK
>> > when polygons are adjacent (whose cell is it anyway?). If they are not
>> > adjacent yo could use edge() with 'outer' argument on the rasterized
>> > polygons instead of linesToRaster
>> >
>> > library(raster)
>> > p1 <- rbind(c(-180,-20), c(-140,55), c(-20, 0), c(-140,-60), c(-180,-20))
>> > hole <- rbind(c(-150,-20), c(-100,-10), c(-110,20), c(-150,-20))
>> > p2 <- rbind(c(-10,0), c(140,60), c(160,0), c(140,-55), c(-10,0))
>> > pols <- SpatialPolygons( list(  Polygons(list(Polygon(p1)), 1),
>> > Polygons(list(Polygon(p2)), 2)))
>> > xy <- coordinates(pols)
>> >
>> > #A
>> > r <- raster(nrow=18, ncol=36)
>> > r <- polygonsToRaster(pols, r)
>> > d <- distanceFromPoints(r, xy)
>> > x <- mask(d, r)
>> > plot(x)
>> >
>> > #B
>> > r <- raster(nrow=18, ncol=36)
>> > r <- polygonsToRaster(pols, r)
>> > l <- linesToRaster(pols, r)
>> > l[l>0] <- 0
>> > p <- pointsToRaster(r, xy)
>> > pp <- cover(p, l)
>> > gd <- gridDistance(pp)
>> > gd[!is.na(l)] <- NA
>> > plot(gd)
>> >
>> >
>> > Robert
>> >
>> > On Tue, Apr 20, 2010 at 12:23 AM, Roman Lu?trik <roman.lustrik at gmail.com>
>> > wrote:
>> > > Dear list,
>> > >
>> > > I have a polygon that I converted to raster (kudos to
>> > polygonsToRaster()). I
>> > > would like to assign values (through a custom function) to cells within
>> > this
>> > > polygon (now as raster). Roughly speaking, cell value will depend on its
>> > > distance from the central cell (polygon 
>> centroid). How would you go about
>> > > doing this? Is there a more efficient way of doing this, or will I have
>> > to
>> > > hard code it, cell by cell?
>> > >
>> > > Cheers,
>> > > Roman
>> > >
>> > >        [[alternative HTML version deleted]]
>> > >
>> > > _______________________________________________
>> > > R-sig-Geo mailing list
>> > > R-sig-Geo at stat.math.ethz.ch
>> > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> > >
>> >
>>
>>
>>
>>--
>>In God we trust, all others bring data.
>>
>>         [[alternative HTML version deleted]]
>>
>>
>>_______________________________________________
>>R-sig-Geo mailing list
>>R-sig-Geo at stat.math.ethz.ch
>>https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>________________________________
>
>Marcelino de la Cruz Rot
>
>Departamento de  Biolog?a Vegetal
>E.U.T.I. Agr?cola
>Universidad Polit?cnica de Madrid
>28040-Madrid
>Tel.: 91 336 54 35
>Fax: 91 336 56 56
>marcelino.delacruz at upm.es
>_________________________________
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at stat.math.ethz.ch
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo

________________________________

Marcelino de la Cruz Rot

Departamento de  Biolog?a Vegetal
E.U.T.I. Agr?cola
Universidad Polit?cnica de Madrid
28040-Madrid
Tel.: 91 336 54 35
Fax: 91 336 56 56
marcelino.delacruz at upm.es
_________________________________ 


From p.vanbreugel at gmail.com  Thu Apr 22 15:53:12 2010
From: p.vanbreugel at gmail.com (Paulo van Breugel)
Date: Thu, 22 Apr 2010 16:53:12 +0300
Subject: [R-sig-Geo] execGRASS parsing problem
Message-ID: <4BD054C8.30505@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100422/b2e211f2/attachment.pl>

From Thomas.Adams at noaa.gov  Thu Apr 22 17:32:05 2010
From: Thomas.Adams at noaa.gov (Thomas Adams)
Date: Thu, 22 Apr 2010 11:32:05 -0400
Subject: [R-sig-Geo] With spplot how to control panel font size?
Message-ID: <4BD06BF5.5000305@noaa.gov>

All:

I am using spplot to automatically generate a 21-panel eps graphic 
within a script where the titles for the individual panes are too large 
and they get cut-off at the beginning and end of the string. I have not 
been able to find how to fix the font size so the titles will fit. I've 
tried setting the the dimensions of the graphic, but that does not seem 
to have an effect. I have searched and can not find any examples of how 
this can be done?

Regards,
Tom

-- 
Thomas E Adams
National Weather Service
Ohio River Forecast Center
1901 South State Route 134
Wilmington, OH 45177

EMAIL:	thomas.adams at noaa.gov

VOICE:	937-383-0528
FAX:	937-383-0033


From dylan.beaudette at gmail.com  Thu Apr 22 17:40:43 2010
From: dylan.beaudette at gmail.com (Dylan Beaudette)
Date: Thu, 22 Apr 2010 08:40:43 -0700
Subject: [R-sig-Geo] With spplot how to control panel font size?
In-Reply-To: <4BD06BF5.5000305@noaa.gov>
References: <4BD06BF5.5000305@noaa.gov>
Message-ID: <p2g3c5546141004220840pca494666p95c0e74fab406c24@mail.gmail.com>

Hi Thomas,

check out the generic lattice argument "par.strip.text". It accepts a
list with common formatting options.

Cheers,
Dylan

On Thu, Apr 22, 2010 at 8:32 AM, Thomas Adams <Thomas.Adams at noaa.gov> wrote:
> All:
>
> I am using spplot to automatically generate a 21-panel eps graphic within a
> script where the titles for the individual panes are too large and they get
> cut-off at the beginning and end of the string. I have not been able to find
> how to fix the font size so the titles will fit. I've tried setting the the
> dimensions of the graphic, but that does not seem to have an effect. I have
> searched and can not find any examples of how this can be done?
>
> Regards,
> Tom
>
> --
> Thomas E Adams
> National Weather Service
> Ohio River Forecast Center
> 1901 South State Route 134
> Wilmington, OH 45177
>
> EMAIL: ?thomas.adams at noaa.gov
>
> VOICE: ?937-383-0528
> FAX: ? ?937-383-0033
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From Thomas.Adams at noaa.gov  Thu Apr 22 18:47:06 2010
From: Thomas.Adams at noaa.gov (Thomas Adams)
Date: Thu, 22 Apr 2010 12:47:06 -0400
Subject: [R-sig-Geo] With spplot how to control panel font size?
In-Reply-To: <p2g3c5546141004220840pca494666p95c0e74fab406c24@mail.gmail.com>
References: <4BD06BF5.5000305@noaa.gov>
	<p2g3c5546141004220840pca494666p95c0e74fab406c24@mail.gmail.com>
Message-ID: <4BD07D8A.9090004@noaa.gov>

Dylan,

Thank you so much! That's just the tidbit I needed?

BTW, I have your iPhone app ? it's awesome!

Regards,
Tom


Dylan Beaudette wrote:
> Hi Thomas,
>
> check out the generic lattice argument "par.strip.text". It accepts a
> list with common formatting options.
>
> Cheers,
> Dylan
>
> On Thu, Apr 22, 2010 at 8:32 AM, Thomas Adams <Thomas.Adams at noaa.gov> wrote:
>   
>> All:
>>
>> I am using spplot to automatically generate a 21-panel eps graphic within a
>> script where the titles for the individual panes are too large and they get
>> cut-off at the beginning and end of the string. I have not been able to find
>> how to fix the font size so the titles will fit. I've tried setting the the
>> dimensions of the graphic, but that does not seem to have an effect. I have
>> searched and can not find any examples of how this can be done?
>>
>> Regards,
>> Tom
>>
>> --
>> Thomas E Adams
>> National Weather Service
>> Ohio River Forecast Center
>> 1901 South State Route 134
>> Wilmington, OH 45177
>>
>> EMAIL:  thomas.adams at noaa.gov
>>
>> VOICE:  937-383-0528
>> FAX:    937-383-0033
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>     


-- 
Thomas E Adams
National Weather Service
Ohio River Forecast Center
1901 South State Route 134
Wilmington, OH 45177

EMAIL:	thomas.adams at noaa.gov

VOICE:	937-383-0528
FAX:	937-383-0033


From tech_dev at wildintellect.com  Thu Apr 22 19:12:58 2010
From: tech_dev at wildintellect.com (Alex Mandel)
Date: Thu, 22 Apr 2010 10:12:58 -0700
Subject: [R-sig-Geo] Adding a shape with writeOGR
In-Reply-To: <224BDB65-4FB8-4396-BC31-F0F280CE5BC1@ais-int.com>
References: <224BDB65-4FB8-4396-BC31-F0F280CE5BC1@ais-int.com>
Message-ID: <4BD0839A.8070109@wildintellect.com>

German Sanchez Hernandez wrote:
> Dear all,
> 
> I'm trying to save some shapes to a postGIS table. I can do it by:
> 
>  shape <- readShapePoly(...)
>  writeOGR(shape, dsn="PG:dbname=gis user=gis password=...", layer='onetable', driver="PostgreSQL", layer_options="overwrite=yes")
> 
> It empties the "onetable" table. Then, how could I do if I want to add other shape to this table without overwritting it?
> 
> I've searched for the params of "layer_options", but I didn't find nothing.
> 
> Thank you!
> Germ?n S?nchez
> 

The obvious question here, what happens if you set overwrite=no?

If the only thing you're using R for is converting a shapefile to
postgis you might want to just use ogr2ogr on the command line with the
-append option. Postgis also ships with a shp2pgsql tool that might
handle this too.

Alternately you can always load more data into a temp table and then run
 some SQL to add the additional records to the first table.


Alex


From r.hijmans at gmail.com  Thu Apr 22 19:21:34 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 22 Apr 2010 10:21:34 -0700
Subject: [R-sig-Geo] assigning raster cell values based on predefined
	criteria
In-Reply-To: <y2u63a206011004220505s391c0160s677a92ad77737ba1@mail.gmail.com>
References: <t2z63a206011004200023sd7800674u40e511be7f88e5ea@mail.gmail.com>
	<w2ldc22b2571004200955w5a55dc17p19a76406591a09c2@mail.gmail.com>
	<y2u63a206011004220505s391c0160s677a92ad77737ba1@mail.gmail.com>
Message-ID: <l2ydc22b2571004221021g72d3ff0egf7fc06f199f76a5b@mail.gmail.com>

I suspect this is because the raster you are using has a
longitude/latitude CRS. This is the default if you create it using
raster()  -- I may change that.
Set it to NA (or to what it really is)

projection(r) <-  NA

And try again...

Robert


The picture suggest that you are not computing the distance to a
single point, but rather to a checkerboard (for one 'color' the black
or the white fields) like distributed set of points.

2010/4/22 Roman Lu?trik <roman.lustrik at gmail.com>:
> This is the normal behavior (see image here) when I use option A-ish
> (calculating distance to a single point).
>
> Intuitively, however, I would expect the plot to look something like this
> (crudely drawn for your amusement). Can someone explain the logic behind the
> "tiled" pattern?
>
> They say a picture is worth a thousand words - hopefully, this is the case
> here and my question is clear.
>
>
>
> Cheers,
> Roman
>
>
> On Tue, Apr 20, 2010 at 6:55 PM, Robert J. Hijmans <r.hijmans at gmail.com>
> wrote:
>>
>> Dear Roman,
>>
>> I think it depends on your data. Below are two examples (both assuming
>> your polygons do not overlap).
>>
>> A) works if each cell in a polygon is closest to its own centroid (and
>> not that of another polygon). It makes a distance surface with
>> distanceFromPoints() and then uses mask() to mask out the areas not
>> covered by polygons.
>>
>> B) uses linesToRaster() to set up a raster with impenetrable
>> boundaries (the polygon outlines) and then use gridDistance() ?(i.e.
>> the distance when only allowed to traverse certain cells). This method
>> would fail if you have a polygon representing several islands; or a
>> polygon with a hole with the centroid inside that hole. Also, you do
>> not have values for the outer cells of a polygon. This is perhaps OK
>> when polygons are adjacent (whose cell is it anyway?). If they are not
>> adjacent yo could use edge() with 'outer' argument on the rasterized
>> polygons instead of linesToRaster
>>
>> library(raster)
>> p1 <- rbind(c(-180,-20), c(-140,55), c(-20, 0), c(-140,-60), c(-180,-20))
>> hole <- rbind(c(-150,-20), c(-100,-10), c(-110,20), c(-150,-20))
>> p2 <- rbind(c(-10,0), c(140,60), c(160,0), c(140,-55), c(-10,0))
>> pols <- SpatialPolygons( list( ?Polygons(list(Polygon(p1)), 1),
>> Polygons(list(Polygon(p2)), 2)))
>> xy <- coordinates(pols)
>>
>> #A
>> r <- raster(nrow=18, ncol=36)
>> r <- polygonsToRaster(pols, r)
>> d <- distanceFromPoints(r, xy)
>> x <- mask(d, r)
>> plot(x)
>>
>> #B
>> r <- raster(nrow=18, ncol=36)
>> r <- polygonsToRaster(pols, r)
>> l <- linesToRaster(pols, r)
>> l[l>0] <- 0
>> p <- pointsToRaster(r, xy)
>> pp <- cover(p, l)
>> gd <- gridDistance(pp)
>> gd[!is.na(l)] <- NA
>> plot(gd)
>>
>>
>> Robert
>>
>> On Tue, Apr 20, 2010 at 12:23 AM, Roman Lu?trik <roman.lustrik at gmail.com>
>> wrote:
>> > Dear list,
>> >
>> > I have a polygon that I converted to raster (kudos to
>> > polygonsToRaster()). I
>> > would like to assign values (through a custom function) to cells within
>> > this
>> > polygon (now as raster). Roughly speaking, cell value will depend on its
>> > distance from the central cell (polygon centroid). How would you go
>> > about
>> > doing this? Is there a more efficient way of doing this, or will I have
>> > to
>> > hard code it, cell by cell?
>> >
>> > Cheers,
>> > Roman
>> >
>> > ? ? ? ?[[alternative HTML version deleted]]
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at stat.math.ethz.ch
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >
>
>
>
> --
> In God we trust, all others bring data.
>


From Roger.Bivand at nhh.no  Fri Apr 23 06:04:29 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 23 Apr 2010 06:04:29 +0200 (CEST)
Subject: [R-sig-Geo] execGRASS parsing problem
In-Reply-To: <4BD054C8.30505@gmail.com>
References: <4BD054C8.30505@gmail.com>
Message-ID: <alpine.LRH.2.00.1004230528090.10258@reclus.nhh.no>

On Thu, 22 Apr 2010, Paulo van Breugel wrote:

> Dear list,
>
> In my GRASS GIS database I have the vector map 'inmap', which is a
> vegetation map with different vegetation types defined in column 'VT'. I
> want to split the vector map according to the VT in different vector
> maps as part of a larger script. I wrote a small script following the
> steps described below:

There seems to be something odd about your use of Name= and VT=, perhaps? 
Cross-platform quoting is always problematic. Had you considered using R 
to subset the vector object if it isn't too large (example in spearfish):

library(spgrass6)
soils <- readVECT6("soils")
labs <- levels(soils$label)
clabs <- as.character(soils$label)
for (i in labs) {
   cat(i, "\n")
   writeVECT6(soils[clabs == i,], paste("soils", i, sep="_"))
}

or something similar. I have also added extra quote protection in doGRASS 
- please check out the current CVS development source from sourceforge, 
r-spatial, module spgrass6, with:

param <- list(input=inmap, output=namelist2[i],
   where=paste("\"Name", "='", namelist1[i], "'\"", sep=""))

so that automatic quote protection of spaced strings is avoided by 
providing the quotes manually, thus for all strings. This may not work 
cross-platform - please test and report back.

Hope this helps,

Roger

>
> First I extract the values of the column VT into a character vector
> namelist1
>
> > namelist1:
>  [1] "Acacia and allied vegetation"
>  [2] "Alpine"
>  [3] "Bamboo woodland and thicket"
>  [4] "Bare land"
>
> Because I want to avoid spaces in the names of the resulting vector
> maps, I convert namelist1 into namelist2:
>
> > namelist2
>  [1] "Acacia_and_allied_vegetation"
>  [2] "Alpine"
>  [3] "Bamboo_woodland_and_thicket"
>  [4] "Bare_land"
>
> I am using these two as input for v.extract, using a loop (for this
> occassion using doGRASS instead of execGRASS):
>
> for(i in 1:length(namelist1){
>    param <- list(input=inmap, output=namelist2[i],
> where=paste("Name","='",namelist1[i], "'",sep=""))
>    flags <- c("d")
>    doGRASS("v.extract", parameters=param, flags=flags)
> }
>
> For i=1, the following is send to GRASS:
> v.extract -d input=trapnel1 output=Acacia_and_allied_vegetation
> where=\"Name='Acacia and allied vegetation'\""
>
> For i=2, the following is send to GRASS:
> v.extract -d input=trapnel1 output=Alpine where=Name='Alpine'
>
> In the second example the argument for the second parameter 'where' is
> not surrounded by double quotation marks, resulting in an error in the
> execution of the command in GRASS. This always seems to happen when the
> argument consist of one string without spaces.
>
> For now I am running the same command via system call -
> system(paste("v.extract -d input='",inmap, "' output='", namelist3[i],
> "' where=\" VT='", namelist1[i], "'\"", sep="")) -, which works fine.
> However, I would like to know what/if I am doing something wrong here.
>
>
> Best regards
>
> Paulo
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From roman.lustrik at gmail.com  Fri Apr 23 10:05:04 2010
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Fri, 23 Apr 2010 10:05:04 +0200
Subject: [R-sig-Geo] assigning raster cell values based on predefined
	criteria
In-Reply-To: <l2ydc22b2571004221021g72d3ff0egf7fc06f199f76a5b@mail.gmail.com>
References: <t2z63a206011004200023sd7800674u40e511be7f88e5ea@mail.gmail.com> 
	<w2ldc22b2571004200955w5a55dc17p19a76406591a09c2@mail.gmail.com> 
	<y2u63a206011004220505s391c0160s677a92ad77737ba1@mail.gmail.com> 
	<l2ydc22b2571004221021g72d3ff0egf7fc06f199f76a5b@mail.gmail.com>
Message-ID: <k2z63a206011004230105k6abf346fy572ae4b0d493b6a6@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100423/249ac62d/attachment.pl>

From wildlife.email at gmail.com  Fri Apr 23 11:59:21 2010
From: wildlife.email at gmail.com (Wild Life)
Date: Fri, 23 Apr 2010 10:59:21 +0100
Subject: [R-sig-Geo] Moran's I negative binomial generalized linear model
In-Reply-To: <A8B089E1099A43E6B150C5A6D367A4F1@Ciretto>
References: <A8B089E1099A43E6B150C5A6D367A4F1@Ciretto>
Message-ID: <n2iaff322651004230259s583029e8re78474a3cb889d6b@mail.gmail.com>

Yes I know the work of Jacqmin-Gadda et al. (1997) which proposes the
use of a new statistic T.
However, more recent work of Lin and Zhang (2007) uses the test of
Moran's I to access the autocorrelation of residuals.
I'm more interested in using this approach, which has been used by
several authors.
The question would be if I should calculate the test using a sparse
matrix (lm.morantest) since it's on residuals or if I should calculate
it by the normal way (moran.test) as suggested by Lin and Zhang
(2007).

Many thanks for the reply.

Regards,

Ant?nio Silva


On Tue, Apr 20, 2010 at 11:15 AM, Roberto Patuelli
<roberto.patuelli at usi.ch> wrote:
> Dear Antonio,
> You may want to look at Jacqmin-Gadda et al. (1997), Tests of Geographical
> Correlation with Adjustment for Explanatory Variables: An Application to
> Dyspnoea in the Elderly, Statistics in Medicine 16, 1283-97.
> Cheers
> Roberto
>
> ****************************
>
> Dear list,
> I'm interested in testing the spatial autocorrelation of the residuals
> of an negative binomial generalized linear model (glm.nb) using
> Moran's I test.
> My question is about the best method to do this. Can I use the
> function lm.morantest? Or is there another more appropriate way?
>
> Regards,
>
> Antonio Silva
>
> ********************
> Roberto Patuelli, Ph.D.
> Istituto Ricerche Economiche (IRE) (Institute for Economic Research)
> Universit? della Svizzera Italiana (University of Lugano)
> via Maderno 24, CP 4361
> CH-6904 Lugano
> Switzerland
> Phone: +41-(0)58-666-4166
> Fax: +39-02-700419665
> Email: roberto.patuelli at usi.ch
> Homepage: http://www.people.lu.unisi.ch/patuellr
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From ted.rosenbaum at yale.edu  Fri Apr 23 13:23:22 2010
From: ted.rosenbaum at yale.edu (Ted Rosenbaum)
Date: Fri, 23 Apr 2010 07:23:22 -0400
Subject: [R-sig-Geo] areal data to pixel image
Message-ID: <t2lc15201271004230423q9b7da96ch80a617be812eea1b@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100423/617faa47/attachment.pl>

From victor.homar at uib.cat  Fri Apr 23 13:22:18 2010
From: victor.homar at uib.cat (=?iso-8859-1?Q?V=EDctor_Homar_Santaner?=)
Date: Fri, 23 Apr 2010 13:22:18 +0200
Subject: [R-sig-Geo] wish: transparent remove.duplicates on non-duplicated
	sp objects
Message-ID: <D60744B9-77E0-497C-8175-F3F3F69BB1A4@uib.cat>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100423/c4639185/attachment.pl>

From edzer.pebesma at uni-muenster.de  Fri Apr 23 15:23:03 2010
From: edzer.pebesma at uni-muenster.de (edzer pebesma)
Date: Fri, 23 Apr 2010 15:23:03 +0200
Subject: [R-sig-Geo] wish: transparent remove.duplicates on
	non-duplicated	sp objects
In-Reply-To: <D60744B9-77E0-497C-8175-F3F3F69BB1A4@uib.cat>
References: <D60744B9-77E0-497C-8175-F3F3F69BB1A4@uib.cat>
Message-ID: <48082bfa-a0b6-4d8f-98bc-d3b335dfc7f3@email.android.com>

Yes, thanks. Will do this.

"V?ctor Homar Santaner" <victor.homar at uib.cat> wrote:

>Hi and thanks to all R developers and helpers,>
>>
>I'm writing a few words of code to perform automatic ordinary krigings for a number of dates. In my dataset some duplicated locations exist (at the resolution of the coordinates I use) for some days. Thus, I run the straight-forward solution of using the "remove.duplicates" and the process works well.>
>>
>The problem is when the loop applies "remove.duplicates" for an object with no duplicates. The output of this command is not the original object but an empty one:>
>>
>> str(Pst)>
>Formal class 'SpatialPointsDataFrame' [package "sp"] with 5 slots>
>  ..@ data       :'data.frame':	177 obs. of  1 variable:>
>  .. ..$ PCP: num [1:177] 0 0 0 0 0 0 1.2 0.6 0 0 ...>
>  ..@ coords.nrs : num(0) >
>  ..@ coords     : num [1:177, 1:2] 518 494 490 489 490 ...>
>  .. ..- attr(*, "dimnames")=List of 2>
>  .. .. ..$ : chr [1:177] "B001" "B007" "B013" "B014" ...>
>  .. .. ..$ : chr [1:2] "X(km)" "Y(km)">
>  ..@ bbox       : num [1:2, 1:2] 345 4280 612 4438>
>  .. ..- attr(*, "dimnames")=List of 2>
>  .. .. ..$ : chr [1:2] "X(km)" "Y(km)">
>  .. .. ..$ : chr [1:2] "min" "max">
>  ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slots>
>  .. .. ..@ projargs: chr "+proj=utm +zone=31 +units=km">
>>
>> remove.duplicates(Pst)>
>[1] coordinates PCP        >
><0 rows> (or 0-length row.names)>
>Warning messages:>
>1: In min(x) : no non-missing arguments to min; returning Inf>
>2: In max(x) : no non-missing arguments to max; returning -Inf>
>3: In min(x) : no non-missing arguments to min; returning Inf>
>4: In max(x) : no non-missing arguments to max; returning -Inf>
>>
>Wouldn't it be nice if "remove.duplicates" left objects with no duplicates unmodified?>
>>
>>
>Thanks,>
>>
>V?ctor.>
>-->
>-------------------------------------------------------------------->
>V?ctor Homar Santaner>
>Grup de Meteorologia			Departament de F?sica>
>Edif. Mateu Orfila                      Tel: +34 971 17 2505>
>Universitat de les Illes Balears        Fax: +34 971 17 3426>
>07122 Palma de Mallorca (SPAIN)         Email: Victor.Homar at uib.es>
>>
>                Knowledge is contagious. Infect truth.>
>-------------------------------------------------------------------->
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>
>	[[alternative HTML version deleted]]
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at stat.math.ethz.ch
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo

From hans at sociologi.cjb.net  Fri Apr 23 16:37:38 2010
From: hans at sociologi.cjb.net (Hans Ekbrand)
Date: Fri, 23 Apr 2010 16:37:38 +0200
Subject: [R-sig-Geo] creating polygons of clusters of points?
Message-ID: <20100423143737.GA10965@samir>

How to create nice polygons from a number of clusters?

I have sorted list of clusters representing hot-spots

> sorted.list.of.clusters
 [1]  7  1 11  9 26  2  5 10 33 40 18 28 37 20 30 47 53

whereas my.cluster holds the classification of events (criminal
fire-setting) to clusters:

head(my.cluster, 100)
  [1]  1  2  3  3  4  5  6  7  8  5  9 10 11 12  1 13  2 14 15 10 16 17  5 13  7  7 18 19 18 20 20  2 21 16 22 18 10  1
 [39]  9 23  4  7 24  9  9  7  7  5  2 11 25 12  7  7 26 27 13  7  7 28 18 28 29  9  2  5 30 11 31 14 18  1 32 26  2 31
 [77] 29 33  2 34  2 26 35 36  7  2 35 37 26 38 11  2 11 26 30  7  4 11  8 11

> number.of.fires.at.hotspots <- sapply(sorted.list.of.clusters, function(x) {length(which(my.cluster == x))})
> number.of.fires.at.hotspots
 [1] 44 39 38 32 22 21 21 21 15 15 14 14 14 12 12 12 12

The "SpatialPointsDataFrame" object clust.geo.test holds the events.

A list coordinates of the events of each cluster is generated with:

> sapply(sorted.list.of.clusters, function(x) {clust.geo.test at coords[which(my.cluster == x),]})
[[1]]
           Ost    Nord
 [1,] 322737.4 6406939
 [2,] 323104.9 6406968
 [3,] 323104.9 6406968
...

[[2]]
           Ost    Nord
 [1,] 315359.9 6393110
 [2,] 315177.0 6394031
 [3,] 314697.8 6394565
...

And I can plot the points in the hot-spots with

> plot(sdn)
> sapply(sorted.list.of.clusters, function(x) {plot(clust.geo.test[which(my.cluster == x),], add = T)})

But would like to plot each cluster as a polygon, ideally filled with
darker colors for clusters with higher number of fires.

I guess I need to create polygons for each cluster and then plot each
polygon. How do you do that?

For your convenience I have created a RData object containing the
objects refered to above and uploaded to this URI

http://sociologi.cjb.net/temp/to-polygons-help.RData, so 

print(load(url("http://sociologi.cjb.net/temp/to-polygons-help.RData")))
plot(sdn)
sapply(sorted.list.of.clusters, function(x) {plot(clust.geo.test[which(my.cluster == x),], add = T)})

would get you to the point I am now.

Hans Ekbrand
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: Digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100423/bc728e00/attachment.bin>

From roman.lustrik at gmail.com  Fri Apr 23 17:12:44 2010
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Fri, 23 Apr 2010 17:12:44 +0200
Subject: [R-sig-Geo] creating polygons of clusters of points?
In-Reply-To: <20100423143737.GA10965@samir>
References: <20100423143737.GA10965@samir>
Message-ID: <y2u63a206011004230812y8d9ac6eazedca990bd76a1eea@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100423/bfd5b2dc/attachment.pl>

From p.hiemstra at geo.uu.nl  Fri Apr 23 17:17:09 2010
From: p.hiemstra at geo.uu.nl (Paul Hiemstra)
Date: Fri, 23 Apr 2010 17:17:09 +0200
Subject: [R-sig-Geo] areal data to pixel image
In-Reply-To: <t2lc15201271004230423q9b7da96ch80a617be812eea1b@mail.gmail.com>
References: <t2lc15201271004230423q9b7da96ch80a617be812eea1b@mail.gmail.com>
Message-ID: <4BD1B9F5.3020705@geo.uu.nl>

Hi Ted,

Take a look at the polygonsToRaster() function form the raster package. 
In general, the raster package looks like a good package for your type 
of research.

cheers,
Paul

Ted Rosenbaum wrote:
> Hi,
> I am trying to make a smooth representation of US population data (ie in an
> pixel image in spatstat) using county level population data.  Does someone
> know of a good way to do this.
> (I am a beginner, so I apologize if this is an obvious question).
> Thanks,
> Ted Rosenbaum
>
> --------------------------
> Graduate Student
> Department of Economics
> Yale University
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   


-- 
Drs. Paul Hiemstra
Department of Physical Geography
Faculty of Geosciences
University of Utrecht
Heidelberglaan 2
P.O. Box 80.115
3508 TC Utrecht
Phone:  +3130 274 3113 Mon-Tue
Phone:  +3130 253 5773 Wed-Fri
http://intamap.geo.uu.nl/~paul
http://nl.linkedin.com/pub/paul-hiemstra/20/30b/770


From p.vanbreugel at gmail.com  Fri Apr 23 17:18:14 2010
From: p.vanbreugel at gmail.com (Paulo van Breugel)
Date: Fri, 23 Apr 2010 18:18:14 +0300
Subject: [R-sig-Geo] execGRASS parsing problem
In-Reply-To: <alpine.LRH.2.00.1004230528090.10258@reclus.nhh.no>
References: <4BD054C8.30505@gmail.com>
	<alpine.LRH.2.00.1004230528090.10258@reclus.nhh.no>
Message-ID: <4BD1BA36.5050606@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100423/373b1bb0/attachment.pl>

From debeaudette at ucdavis.edu  Fri Apr 23 18:19:37 2010
From: debeaudette at ucdavis.edu (Dylan Beaudette)
Date: Fri, 23 Apr 2010 09:19:37 -0700
Subject: [R-sig-Geo] creating polygons of clusters of points?
In-Reply-To: <y2u63a206011004230812y8d9ac6eazedca990bd76a1eea@mail.gmail.com>
References: <20100423143737.GA10965@samir>
	<y2u63a206011004230812y8d9ac6eazedca990bd76a1eea@mail.gmail.com>
Message-ID: <201004230919.37827.dylan.beaudette@gmail.com>

Hi,

Here is another approach, using something like a 'concave hull' -- i.e. alpha 
shapes:

http://casoilresource.lawr.ucdavis.edu/drupal/node/919

Cheers,
Dylan

On Friday 23 April 2010, Roman Lu?trik wrote:
> How does this function sound (convexhull.xy {spatstat})?
>
> http://bm2.genes.nig.ac.jp/RGM2/R_current/library/spatstat/man/convexhull.x
>y.html
>
> Convex Hull of Points Description
>
> Computes the convex hull of a set of points in two dimensions.
> Usage
>
> convexhull.xy(x, y=NULL)
>
> Arguments x vector of x coordinates of observed points, or a 2-column
> matrix giving x,y coordinates, or a list with components x,y giving
> coordinates (such as a point pattern object of class "ppp".) y (optional)
> vector of ycoordinates of observed points, if
> x is a vector.
>
> Cheers,
> Roman
>
> On Fri, Apr 23, 2010 at 4:37 PM, Hans Ekbrand <hans at sociologi.cjb.net>wrote:
> > How to create nice polygons from a number of clusters?
> >
> > I have sorted list of clusters representing hot-spots
> >
> > > sorted.list.of.clusters
> >
> >  [1]  7  1 11  9 26  2  5 10 33 40 18 28 37 20 30 47 53
> >
> > whereas my.cluster holds the classification of events (criminal
> > fire-setting) to clusters:
> >
> > head(my.cluster, 100)
> >  [1]  1  2  3  3  4  5  6  7  8  5  9 10 11 12  1 13  2 14 15 10 16 17  5
> > 13  7  7 18 19 18 20 20  2 21 16 22 18 10  1
> >  [39]  9 23  4  7 24  9  9  7  7  5  2 11 25 12  7  7 26 27 13  7  7 28
> > 18 28 29  9  2  5 30 11 31 14 18  1 32 26  2 31
> >  [77] 29 33  2 34  2 26 35 36  7  2 35 37 26 38 11  2 11 26 30  7  4 11 
> > 8 11
> >
> > > number.of.fires.at.hotspots <- sapply(sorted.list.of.clusters,
> >
> > function(x) {length(which(my.cluster == x))})
> >
> > > number.of.fires.at.hotspots
> >
> >  [1] 44 39 38 32 22 21 21 21 15 15 14 14 14 12 12 12 12
> >
> > The "SpatialPointsDataFrame" object clust.geo.test holds the events.
> >
> > A list coordinates of the events of each cluster is generated with:
> > > sapply(sorted.list.of.clusters, function(x)
> > > {clust.geo.test at coords[which(my.cluster
> >
> > == x),]})
> > [[1]]
> >           Ost    Nord
> >  [1,] 322737.4 6406939
> >  [2,] 323104.9 6406968
> >  [3,] 323104.9 6406968
> > ...
> >
> > [[2]]
> >           Ost    Nord
> >  [1,] 315359.9 6393110
> >  [2,] 315177.0 6394031
> >  [3,] 314697.8 6394565
> > ...
> >
> > And I can plot the points in the hot-spots with
> >
> > > plot(sdn)
> > > sapply(sorted.list.of.clusters, function(x)
> >
> > {plot(clust.geo.test[which(my.cluster == x),], add = T)})
> >
> > But would like to plot each cluster as a polygon, ideally filled with
> > darker colors for clusters with higher number of fires.
> >
> > I guess I need to create polygons for each cluster and then plot each
> > polygon. How do you do that?
> >
> > For your convenience I have created a RData object containing the
> > objects refered to above and uploaded to this URI
> >
> > http://sociologi.cjb.net/temp/to-polygons-help.RData, so
> >
> > print(load(url("http://sociologi.cjb.net/temp/to-polygons-help.RData")))
> > plot(sdn)
> > sapply(sorted.list.of.clusters, function(x)
> > {plot(clust.geo.test[which(my.cluster == x),], add = T)})
> >
> > would get you to the point I am now.
> >
> > Hans Ekbrand
> >
> > -----BEGIN PGP SIGNATURE-----
> > Version: GnuPG v1.4.9 (GNU/Linux)
> >
> > iEYEARECAAYFAkvRsLEACgkQfCyHKnBQYU4JrQCfWMlOgECamin5ZugGoHcUpqx3
> > fuQAoNDoG6iMVlLJCOYfoP5MRbNYHGlI
> > =jKTU
> > -----END PGP SIGNATURE-----
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Dylan Beaudette
Soil Resource Laboratory
http://casoilresource.lawr.ucdavis.edu/
University of California at Davis
530.754.7341


From Jean-Paul.Kibambe at uclouvain.be  Fri Apr 23 19:11:43 2010
From: Jean-Paul.Kibambe at uclouvain.be (Jean-Paul Kibambe Lubamba)
Date: Fri, 23 Apr 2010 19:11:43 +0200
Subject: [R-sig-Geo] Customized cost distance function ?
Message-ID: <4BD1D4CF.1060806@uclouvain.be>

Hello list,

I want to compute a cost distance function (or even an euclidean 
distance), from a polyline object.

Instead of closest cells (to polylines) of the resulting cost distance 
raster having a value of 0, I would want them to pick up an attribute 
value of the related line object. Their neighborhood cells will have  
values  based on the cost distance or euclidean distance algorithm. 
Roughly speaking, I do not want "origin" cells of the cost distance 
raster to have a value of zero but a value from an attribute of the 
nearest line object.
 
Does anyone have a suggestion ?

Any help is welcome... Thanks in advance !


JP


From Roger.Bivand at nhh.no  Sat Apr 24 04:18:31 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 24 Apr 2010 04:18:31 +0200 (CEST)
Subject: [R-sig-Geo] Moran's I negative binomial generalized linear model
In-Reply-To: <n2iaff322651004230259s583029e8re78474a3cb889d6b@mail.gmail.com>
References: <A8B089E1099A43E6B150C5A6D367A4F1@Ciretto>
	<n2iaff322651004230259s583029e8re78474a3cb889d6b@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1004240409070.32498@reclus.nhh.no>

On Fri, 23 Apr 2010, Wild Life wrote:

> Yes I know the work of Jacqmin-Gadda et al. (1997) which proposes the
> use of a new statistic T.
> However, more recent work of Lin and Zhang (2007) uses the test of
> Moran's I to access the autocorrelation of residuals.
> I'm more interested in using this approach, which has been used by
> several authors.
> The question would be if I should calculate the test using a sparse
> matrix (lm.morantest) since it's on residuals or if I should calculate
> it by the normal way (moran.test) as suggested by Lin and Zhang
> (2007).

If you examine the class of a model object fitted using glm(), you'll see 
that it also inherits from "lm". This means that you may use 
lm.morantest() at your own risk. This is not the same as moran.test(), and 
I do not believe that Lin and Zhang suggested its use. I have no idea why 
you think that sparse matrices are involved. In testing model residuals, 
it is essential to handle the presence of the X variables, which is what 
lm.morantest() does. Since no studies have been done to find out how 
accurately this test detects spatial autocorrelation in glm errors, it is 
premature to simply extend findings for lm objects. It is also unclear 
whether this is what Lin and Zhang did, as I am unaware of them having 
published their code.

Hope this helps,

Roger

>
> Many thanks for the reply.
>
> Regards,
>
> Ant?nio Silva
>
>
> On Tue, Apr 20, 2010 at 11:15 AM, Roberto Patuelli
> <roberto.patuelli at usi.ch> wrote:
>> Dear Antonio,
>> You may want to look at Jacqmin-Gadda et al. (1997), Tests of Geographical
>> Correlation with Adjustment for Explanatory Variables: An Application to
>> Dyspnoea in the Elderly, Statistics in Medicine 16, 1283-97.
>> Cheers
>> Roberto
>>
>> ****************************
>>
>> Dear list,
>> I'm interested in testing the spatial autocorrelation of the residuals
>> of an negative binomial generalized linear model (glm.nb) using
>> Moran's I test.
>> My question is about the best method to do this. Can I use the
>> function lm.morantest? Or is there another more appropriate way?
>>
>> Regards,
>>
>> Antonio Silva
>>
>> ********************
>> Roberto Patuelli, Ph.D.
>> Istituto Ricerche Economiche (IRE) (Institute for Economic Research)
>> Universit? della Svizzera Italiana (University of Lugano)
>> via Maderno 24, CP 4361
>> CH-6904 Lugano
>> Switzerland
>> Phone: +41-(0)58-666-4166
>> Fax: +39-02-700419665
>> Email: roberto.patuelli at usi.ch
>> Homepage: http://www.people.lu.unisi.ch/patuellr
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From hengl at spatial-analyst.net  Sat Apr 24 08:30:19 2010
From: hengl at spatial-analyst.net (Tomislav Hengl)
Date: Sat, 24 Apr 2010 08:30:19 +0200
Subject: [R-sig-Geo] areal data to pixel image
In-Reply-To: <t2lc15201271004230423q9b7da96ch80a617be812eea1b@mail.gmail.com>
References: <t2lc15201271004230423q9b7da96ch80a617be812eea1b@mail.gmail.com>
Message-ID: <4BD28FFB.6060402@spatial-analyst.net>


I think you want to use the kernel density funcionality of spatstat 
[http://spatstat.org]; this will allow you to atach population at 
polygon centers as weigths. Here are some examples:

 > library(spatstat)
...
 > wosCR.ppp <- ppp(wosmap at coords[,1], wosmap at coords[,2], 
marks=wosmap$CR, window=wowin)
 > densCR <- density.ppp(wosCR.ppp, 0.5, weights=wosmap$CR, edge=TRUE)
...

[http://spatial-analyst.net/wiki/index.php?title=Mapping_research_hot-spots]

T. Hengl
http://home.medewerker.uva.nl/t.hengl/


Ted Rosenbaum wrote:
> Hi,
> I am trying to make a smooth representation of US population data (ie in an
> pixel image in spatstat) using county level population data.  Does someone
> know of a good way to do this.
> (I am a beginner, so I apologize if this is an obvious question).
> Thanks,
> Ted Rosenbaum
> 
> --------------------------
> Graduate Student
> Department of Economics
> Yale University
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From hans at sociologi.cjb.net  Mon Apr 26 01:30:47 2010
From: hans at sociologi.cjb.net (Hans Ekbrand)
Date: Mon, 26 Apr 2010 01:30:47 +0200
Subject: [R-sig-Geo] creating polygons of clusters of points?
In-Reply-To: <201004230919.37827.dylan.beaudette@gmail.com>
References: <20100423143737.GA10965@samir>
	<y2u63a206011004230812y8d9ac6eazedca990bd76a1eea@mail.gmail.com>
	<201004230919.37827.dylan.beaudette@gmail.com>
Message-ID: <4BD4D0A7.4080408@sociologi.cjb.net>

Dylan Beaudette wrote:
> Hi,
>
> Here is another approach, using something like a 'concave hull' -- i.e. alpha 
> shapes:
>
> http://casoilresource.lawr.ucdavis.edu/drupal/node/919
>   
Thanks Dylan and thanks Roman for your advice. (convexhull.xy was what I
wanted).

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 260 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100426/bf425de2/attachment.bin>

From breitbach at uni-mainz.de  Mon Apr 26 14:10:58 2010
From: breitbach at uni-mainz.de (Breitbach, Nils)
Date: Mon, 26 Apr 2010 12:10:58 +0000
Subject: [R-sig-Geo] Polygons from lines with open endings
Message-ID: <E7F1EF063B11DA4DAD16374549B879E8016FA7@e14mdb-01.zdv.Uni-Mainz.DE>

Dear Community,

I am looking for a way to create polygons from a line-shape. I have now have a line-shape where streets are characterised by the space between the right and the left boarder of the street and the boarders consist of lines. Of course the lines/streets are open at their endings and thus it was not possible to create polygons with ArcGIS or any tools from the toolbox. Since, I cannot manually close all endings, I would like to do find a way to create polygons from lines with open endings.
Any suggestions ...?

Cheers,

Nils

_________________________________________________________

Nils Breitbach, Dipl.-Biol.
Institut f?r Zoologie, Abt. 5: ?kologie
J.-J.-Becher-Weg 13
Johannes Gutenberg-Universit?t
55128 Mainz
Germany

phone: +49 6131 39-22718
fax:   +49 6131 39-23731
WWW: www.community-ecology.uni-mainz.de/126_ENG_HTML.php


From carson.farmer at gmail.com  Mon Apr 26 14:57:57 2010
From: carson.farmer at gmail.com (Carson Farmer)
Date: Mon, 26 Apr 2010 13:57:57 +0100
Subject: [R-sig-Geo] Polygons from lines with open endings
In-Reply-To: <E7F1EF063B11DA4DAD16374549B879E8016FA7@e14mdb-01.zdv.Uni-Mainz.DE>
References: <E7F1EF063B11DA4DAD16374549B879E8016FA7@e14mdb-01.zdv.Uni-Mainz.DE>
Message-ID: <z2t94b3c8441004260557t3daacc6fxe26c7d414f9665c9@mail.gmail.com>

> Since, I cannot manually close all endings, I would like to do find a way to create polygons from lines with open endings.
> Any suggestions ...?

If your lines are valid (i.e. correctly ordered pairs of coords), you
could probably just grab the first set of points in the list and add
that to the end... something like the following
(where line_layer is a SpatialLinesDataFrame):

> coords <- line_layer at lines[[1]]@Lines[[1]]@coords
> coords <- rbind(coords,coords[1,])
> line_layer at lines[[1]]@Lines[[1]]@coords <- coords

Note that it is simple to figure out how many features and geometries
(multipart features) to go through:

> length(line_layer at lines)
[1] 1032

> length(line_layer at lines[[1]]@Lines)
[1] 1

so then of course you can do this for all features in your line layer:

 tmp_lines <- line_layer at lines
 for (i in seq(length(tmp_lines))) {
     tmp_Lines <- tmp_lines[[i]]@Lines
     for (j in seq(length(tmp_Lines))) {
         coords <- tmp_Lines[[j]]@coords
         coords <- rbind(coords,coords[1,])
         line_layer at lines[[i]]@Lines[[j]]@coords <- coords
     }
}

There are probably faster ways to do this using apply etc. but this
works, and is relatively readable...

Hope that helps,

Carson

-- 
Carson J. Q. Farmer
ISSP Doctoral Fellow
National Centre for Geocomputation
National University of Ireland, Maynooth,
http://www.carsonfarmer.com/


From folopez at ivic.gob.ve  Mon Apr 26 16:14:30 2010
From: folopez at ivic.gob.ve (=?UTF-8?Q?Freddy_L=C3=B3pez?=)
Date: Mon, 26 Apr 2010 09:14:30 -0500
Subject: [R-sig-Geo] About lmadogram.-
Message-ID: <t2jcac512fc1004260714t907b6642t69187b38a45bac9c@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100426/6d602ddd/attachment.pl>

From edzer.pebesma at uni-muenster.de  Mon Apr 26 17:15:01 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 26 Apr 2010 17:15:01 +0200
Subject: [R-sig-Geo] About lmadogram.-
In-Reply-To: <t2jcac512fc1004260714t907b6642t69187b38a45bac9c@mail.gmail.com>
References: <t2jcac512fc1004260714t907b6642t69187b38a45bac9c@mail.gmail.com>
Message-ID: <4BD5ADF5.4000101@uni-muenster.de>

When running example(lmadogram) to get something similar without having
access to your particular data, R 2.10.1 gives me in addition:

Warning message:
In persp.default(lambda, dist, lmado, xlab = xlab, ylab = ylab,  :
  semi-transparency is not supported on this device: reported only once
per page

which should have been enough to give you a hint. If you use e.g.

pdf('lmadogram-1.pdf')

and then (if needed) convert the pdf using pdf2ps, it should be fine,
except that the file size grew in my case from 75K (pdf) to 18M (ps)!
Maybe transparency is just not dealt with so well in eps.
--
Edzer


Freddy L?pez wrote:
> Dear All,
> 
> My request is a technical request, I guess.
> 
> I'm working with SpatialExtremes library and all works nicely.
> 
> Now, when I plot a lambda-madogram I can see the plot in the windows, but
> when I save it (using the traditional commands:
> 
> postscript('lmadograma-1.eps')
> lmadogram(datos,as.matrix(coor),n.bins=231)
> dev.off()
> 
> )
> 
> my graphical object is empty. Empty. Just the axis are present but not the
> graphic indeed.
> 
> The same problem is present under, at least, two platforms: Windows (Xp) and
> Debian (Lenny).
> 
> Have you any ideas how can I solve it and save my plot?
> 
> Cheers and have a nice day.
> 
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From folopez at ivic.gob.ve  Mon Apr 26 17:28:23 2010
From: folopez at ivic.gob.ve (=?UTF-8?Q?Freddy_L=C3=B3pez?=)
Date: Mon, 26 Apr 2010 10:28:23 -0500
Subject: [R-sig-Geo] About lmadogram.-
In-Reply-To: <4BD5ADF5.4000101@uni-muenster.de>
References: <t2jcac512fc1004260714t907b6642t69187b38a45bac9c@mail.gmail.com> 
	<4BD5ADF5.4000101@uni-muenster.de>
Message-ID: <p2ocac512fc1004260828rdaabfac6g7c119af95b227712@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100426/4739c774/attachment.pl>

From hacke78 at googlemail.com  Mon Apr 26 17:55:08 2010
From: hacke78 at googlemail.com (Jan Hackenberg)
Date: Mon, 26 Apr 2010 17:55:08 +0200
Subject: [R-sig-Geo] Package rgdal
Message-ID: <n2zbd496c5e1004260855zd5f0c72frd25875dd2ed9fdfc@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100426/971b9795/attachment.pl>

From Roger.Bivand at nhh.no  Mon Apr 26 18:00:54 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 26 Apr 2010 18:00:54 +0200 (CEST)
Subject: [R-sig-Geo] CRAN down until tomorrow (?) was: Re:  Package rgdal
In-Reply-To: <n2zbd496c5e1004260855zd5f0c72frd25875dd2ed9fdfc@mail.gmail.com>
References: <n2zbd496c5e1004260855zd5f0c72frd25875dd2ed9fdfc@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1004261759220.12086@reclus.nhh.no>

On Mon, 26 Apr 2010, Jan Hackenberg wrote:

> Hi
> i am seriously having problems with installing this package on my Linux-
> Ubuntu machine. I think that i have installed the external gdal packages
> correctly.

CRAN is down - major unplanned power outage in Vienna:

https://stat.ethz.ch/pipermail/r-help/2010-April/236601.html

Roger

>
> The error message is in German :
>
>> install.packages('rgdal',dep = TRUE , lib = '~/lib/R')
> --- Bitte einen CRAN Spiegel f?r diese Sitzung ausw?hlen ---
> Lade Tcl/Tk Interface ... fertig
> Warnmeldungen:
> 1: In open.connection(con, "r") :
>  kann nicht mit 'cran.r-project.org' auf Port 80 verbinden
> 2: In getDependencies(pkgs, dependencies, available, lib) :
>  package ?rgdal? is not available
>
> this means :
> 1)  cant connect to cran.r-project.org on port 80
>
> And it takes about 5 Minutes to get the choose mirror window being opened. I
> also recognized that pages like *cran*.*r*-project.org seem to be offline
> too.
> So my quesion is, are there some server problems right now, and that is the
> reason for not being able to install this package?
> I need it to transform some Gauss krueger coordinates into latlong and this
> sptransform method from the package is the one i want to use.
>
> Best regards
> Jan Hackenberg
>
> 	[[alternative HTML version deleted]]
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From hacke78 at googlemail.com  Mon Apr 26 19:46:01 2010
From: hacke78 at googlemail.com (Jan Hackenberg)
Date: Mon, 26 Apr 2010 19:46:01 +0200
Subject: [R-sig-Geo] Package rgdal
In-Reply-To: <n2zbd496c5e1004260855zd5f0c72frd25875dd2ed9fdfc@mail.gmail.com>
References: <n2zbd496c5e1004260855zd5f0c72frd25875dd2ed9fdfc@mail.gmail.com>
Message-ID: <o2kbd496c5e1004261046w794b7d01n1f67ed90559b2609@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100426/4cd97f47/attachment.pl>

From Scott.Minkoff at Colorado.EDU  Mon Apr 26 21:54:37 2010
From: Scott.Minkoff at Colorado.EDU (Scott L Minkoff)
Date: Mon, 26 Apr 2010 13:54:37 -0600
Subject: [R-sig-Geo] ArcGIS SWMs in R
Message-ID: <000001cae57a$4ec22e80$ec468b80$@minkoff@colorado.edu>

Hello,

I am still fairly new to spatial data analysis using R and would appreciate
any help the list might be able to provide.  I have been using Roger's code
to bring ArcGIS Spatial Weights Matrices into R (see below).  However, when
I go to run spatial lag models, I get the following error: 

"NAs are not allowed in subscripted assignments"

I have tried the various na.action arguments to no avail.  Note that the
objects seem to work fine for Moran's I tests.  Does anybody know how to
solve this problem?

Thanks in advance,
Scott

Roger's Script for bringing Arc SWMs into R and making them list objects:

library(foreign)
x <- read.dbf("spatialweightmatrix3.dbf")
from_IDs <- sort(unique(x$FID2))
to_IDs <- sort(unique(x$NID))
# find the IDs used
all.equal(from_IDs, to_IDs)
o <- order(x$FID2, x$NID)
# order the object
xx <- x[o,]
# convert manually to a spatial.neighbours representation
sn <- data.frame(from=match(xx$FID2, from_IDs), to=match(xx$NID+1,
   to_IDs), weihts=xx$WEIGHT)
attr(sn, "n") <- length(from_IDs)
attr(sn, "region.id") <- as.character(from_IDs)
class(sn) <- c("spatial.neighbour", class(sn))
library(spdep)
lw <- sn2listw(sn)
lw
summary(sapply(lw$weights, sum))
table(card(lw$neighbours))


From Scott.Minkoff at Colorado.EDU  Mon Apr 26 23:23:32 2010
From: Scott.Minkoff at Colorado.EDU (Scott L Minkoff)
Date: Mon, 26 Apr 2010 15:23:32 -0600
Subject: [R-sig-Geo] ArcGIS SWMs in R
In-Reply-To: <000001cae57a$4ec22e80$ec468b80$@minkoff@colorado.edu>
References: <000001cae57a$4ec22e80$ec468b80$@minkoff@colorado.edu>
Message-ID: <000301cae586$b9623580$2c26a080$@minkoff@colorado.edu>

To be a bit more precise than I was in the previous note, the full error
message I get is:

Error in res[i, listw$neighbours[[i]]] <- listw$weights[[i]] : 
  NAs are not allowed in subscripted assignments

Thanks, 
Scott

-----Original Message-----
From: r-sig-geo-bounces at stat.math.ethz.ch
[mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of Scott L Minkoff
Sent: Monday, April 26, 2010 1:55 PM
To: r-sig-geo at stat.math.ethz.ch
Subject: [R-sig-Geo] ArcGIS SWMs in R

Hello,

I am still fairly new to spatial data analysis using R and would appreciate
any help the list might be able to provide.  I have been using Roger's code
to bring ArcGIS Spatial Weights Matrices into R (see below).  However, when
I go to run spatial lag models, I get the following error: 

"NAs are not allowed in subscripted assignments"

I have tried the various na.action arguments to no avail.  Note that the
objects seem to work fine for Moran's I tests.  Does anybody know how to
solve this problem?

Thanks in advance,
Scott

Roger's Script for bringing Arc SWMs into R and making them list objects:

library(foreign)
x <- read.dbf("spatialweightmatrix3.dbf")
from_IDs <- sort(unique(x$FID2))
to_IDs <- sort(unique(x$NID))
# find the IDs used
all.equal(from_IDs, to_IDs)
o <- order(x$FID2, x$NID)
# order the object
xx <- x[o,]
# convert manually to a spatial.neighbours representation
sn <- data.frame(from=match(xx$FID2, from_IDs), to=match(xx$NID+1,
   to_IDs), weihts=xx$WEIGHT)
attr(sn, "n") <- length(from_IDs)
attr(sn, "region.id") <- as.character(from_IDs)
class(sn) <- c("spatial.neighbour", class(sn))
library(spdep)
lw <- sn2listw(sn)
lw
summary(sapply(lw$weights, sum))
table(card(lw$neighbours))

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Roger.Bivand at nhh.no  Tue Apr 27 11:10:11 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 27 Apr 2010 11:10:11 +0200 (CEST)
Subject: [R-sig-Geo] ArcGIS SWMs in R
In-Reply-To: <000301cae586$b9623580$2c26a080$@minkoff@colorado.edu>
References: <000001cae57a$4ec22e80$ec468b80$@minkoff@colorado.edu>
	<000301cae586$b9623580$2c26a080$@minkoff@colorado.edu>
Message-ID: <alpine.LRH.2.00.1004271048060.15907@reclus.nhh.no>

On Mon, 26 Apr 2010, Scott L Minkoff wrote:

> To be a bit more precise than I was in the previous note, the full error
> message I get is:
>
> Error in res[i, listw$neighbours[[i]]] <- listw$weights[[i]] :
>  NAs are not allowed in subscripted assignments

That helps a little - the output of traceback() would have helped more, 
and shows (by grepping the source code) that the error occurs in 
listw2mat(), so at least one of listw$neighbours[[i]]] is an NA. Since I 
have a copy of the input data file, I see that:

> summary(unlist(lw$neighbours))
    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's
     2.0   336.0   668.0   667.9  1006.0  1330.0   137.0

If you form the sn object dropping the possibly spurious +1 in 
to=match(xx$NID+1, to_IDs):

sn <- data.frame(from=match(xx$FID2, from_IDs), to=match(xx$NID,
    to_IDs), weights=xx$WEIGHT)

the sn object converts to a listw object and on to a matrix without 
complaining. match() by default returns NA when no match is found. I think 
the original +1 came from being misled by the 0-base in the FID values.

Hope this helps,

Roger


>
> Thanks,
> Scott
>
> -----Original Message-----
> From: r-sig-geo-bounces at stat.math.ethz.ch
> [mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of Scott L Minkoff
> Sent: Monday, April 26, 2010 1:55 PM
> To: r-sig-geo at stat.math.ethz.ch
> Subject: [R-sig-Geo] ArcGIS SWMs in R
>
> Hello,
>
> I am still fairly new to spatial data analysis using R and would appreciate
> any help the list might be able to provide.  I have been using Roger's code
> to bring ArcGIS Spatial Weights Matrices into R (see below).  However, when
> I go to run spatial lag models, I get the following error:
>
> "NAs are not allowed in subscripted assignments"
>
> I have tried the various na.action arguments to no avail.  Note that the
> objects seem to work fine for Moran's I tests.  Does anybody know how to
> solve this problem?
>
> Thanks in advance,
> Scott
>
> Roger's Script for bringing Arc SWMs into R and making them list objects:
>
> library(foreign)
> x <- read.dbf("spatialweightmatrix3.dbf")
> from_IDs <- sort(unique(x$FID2))
> to_IDs <- sort(unique(x$NID))
> # find the IDs used
> all.equal(from_IDs, to_IDs)
> o <- order(x$FID2, x$NID)
> # order the object
> xx <- x[o,]
> # convert manually to a spatial.neighbours representation
> sn <- data.frame(from=match(xx$FID2, from_IDs), to=match(xx$NID+1,
>   to_IDs), weihts=xx$WEIGHT)
> attr(sn, "n") <- length(from_IDs)
> attr(sn, "region.id") <- as.character(from_IDs)
> class(sn) <- c("spatial.neighbour", class(sn))
> library(spdep)
> lw <- sn2listw(sn)
> lw
> summary(sapply(lw$weights, sum))
> table(card(lw$neighbours))
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From p.hiemstra at geo.uu.nl  Tue Apr 27 11:17:28 2010
From: p.hiemstra at geo.uu.nl (Paul Hiemstra)
Date: Tue, 27 Apr 2010 11:17:28 +0200
Subject: [R-sig-Geo] Plotting SpatialPolygonsDataFrame using ggplot2
Message-ID: <4BD6ABA8.7060709@geo.uu.nl>

Hi people,

I have a question regarding plotting a SpatialPolygonsDataFrame using 
ggplot2. To convert the SPDF to a dataframe with the coordinates I 
already use the excellent solution provided by Hadley in:

http://tolstoy.newcastle.edu.au/R/e6/help/09/03/8668.html

Some example code:

library(maptools)
library(ggplot2)
x <- readShapePoly(system.file("shapes/sids.shp", package="maptools")[1],
      IDvar="FIPSNO", proj4string=CRS("+proj=longlat +ellps=clrk66"))
dum = fortify(x, region = "CNTY_ID")
ggplot(dum, aes(x = long, y = lat)) + geom_path()

My problem is that not only the counties are drawn, but also lines 
between the end point of one countie polygon and the beginning of the 
next. I solve this right now by adding the counties I want to plot one 
by one using:

p + geom_path(subset(dum, id == 1) + geom_path(subset(dum, id == 2) + 
... etc

This is of course a solution, but not an elegant one. Creating a new 
ggplot object like:

unique_ids = unique(dum$id)
bla = ggplot(subset(dum, id == unique_ids[1]), aes(x =long, y = lat)) + 
geom_path()
for(id in unique_ids[2:length(unique_ids)]) {
       bla = bla + layer(data = subset(dum, id == id), mapping = aes(x 
=long, y = lat), geom = "path")
    }
print(bla)
    
Has exactly the same problem as using ggplot(dum, aes(x = long, y = 
lat)) + geom_path(). I browsed the net and the maling list and could not 
find the answer, only references to the fortify() solution of Hadley.

Anybody have an idea for an elegant solution to the problem?

cheers,
Paul

-- 
Drs. Paul Hiemstra
Department of Physical Geography
Faculty of Geosciences
University of Utrecht
Heidelberglaan 2
P.O. Box 80.115
3508 TC Utrecht
Phone:  +3130 274 3113 Mon-Tue
Phone:  +3130 253 5773 Wed-Fri
http://intamap.geo.uu.nl/~paul
http://nl.linkedin.com/pub/paul-hiemstra/20/30b/770


From h.wickham at gmail.com  Tue Apr 27 14:54:16 2010
From: h.wickham at gmail.com (hadley wickham)
Date: Tue, 27 Apr 2010 07:54:16 -0500
Subject: [R-sig-Geo] Plotting SpatialPolygonsDataFrame using ggplot2
In-Reply-To: <4BD6ABA8.7060709@geo.uu.nl>
References: <4BD6ABA8.7060709@geo.uu.nl>
Message-ID: <r2if8e6ff051004270554o88d41688v667ec6eca3e441a5@mail.gmail.com>

Hi Paul,

You're missing the group specification:

ggplot(dum, aes(x = long, y = lat)) + geom_path(aes(group = group))

Hadley

On Tue, Apr 27, 2010 at 4:17 AM, Paul Hiemstra <p.hiemstra at geo.uu.nl> wrote:
> Hi people,
>
> I have a question regarding plotting a SpatialPolygonsDataFrame using
> ggplot2. To convert the SPDF to a dataframe with the coordinates I already
> use the excellent solution provided by Hadley in:
>
> http://tolstoy.newcastle.edu.au/R/e6/help/09/03/8668.html
>
> Some example code:
>
> library(maptools)
> library(ggplot2)
> x <- readShapePoly(system.file("shapes/sids.shp", package="maptools")[1],
> ? ? IDvar="FIPSNO", proj4string=CRS("+proj=longlat +ellps=clrk66"))
> dum = fortify(x, region = "CNTY_ID")
> ggplot(dum, aes(x = long, y = lat)) + geom_path()
>
> My problem is that not only the counties are drawn, but also lines between
> the end point of one countie polygon and the beginning of the next. I solve
> this right now by adding the counties I want to plot one by one using:
>
> p + geom_path(subset(dum, id == 1) + geom_path(subset(dum, id == 2) + ...
> etc
>
> This is of course a solution, but not an elegant one. Creating a new ggplot
> object like:
>
> unique_ids = unique(dum$id)
> bla = ggplot(subset(dum, id == unique_ids[1]), aes(x =long, y = lat)) +
> geom_path()
> for(id in unique_ids[2:length(unique_ids)]) {
> ? ? ?bla = bla + layer(data = subset(dum, id == id), mapping = aes(x =long,
> y = lat), geom = "path")
> ? }
> print(bla)
> ? Has exactly the same problem as using ggplot(dum, aes(x = long, y = lat))
> + geom_path(). I browsed the net and the maling list and could not find the
> answer, only references to the fortify() solution of Hadley.
>
> Anybody have an idea for an elegant solution to the problem?
>
> cheers,
> Paul
>
> --
> Drs. Paul Hiemstra
> Department of Physical Geography
> Faculty of Geosciences
> University of Utrecht
> Heidelberglaan 2
> P.O. Box 80.115
> 3508 TC Utrecht
> Phone: ?+3130 274 3113 Mon-Tue
> Phone: ?+3130 253 5773 Wed-Fri
> http://intamap.geo.uu.nl/~paul
> http://nl.linkedin.com/pub/paul-hiemstra/20/30b/770
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Assistant Professor / Dobelman Family Junior Chair
Department of Statistics / Rice University
http://had.co.nz/


From p.hiemstra at geo.uu.nl  Tue Apr 27 15:15:21 2010
From: p.hiemstra at geo.uu.nl (Paul Hiemstra)
Date: Tue, 27 Apr 2010 15:15:21 +0200
Subject: [R-sig-Geo] Plotting SpatialPolygonsDataFrame using ggplot2
In-Reply-To: <r2if8e6ff051004270554o88d41688v667ec6eca3e441a5@mail.gmail.com>
References: <4BD6ABA8.7060709@geo.uu.nl>
	<r2if8e6ff051004270554o88d41688v667ec6eca3e441a5@mail.gmail.com>
Message-ID: <4BD6E369.1000807@geo.uu.nl>

Hi Hadley,

That worked like a charm. Thanks.

cheers,
Paul

hadley wickham wrote:
> Hi Paul,
>
> You're missing the group specification:
>
> ggplot(dum, aes(x = long, y = lat)) + geom_path(aes(group = group))
>
> Hadley
>
> On Tue, Apr 27, 2010 at 4:17 AM, Paul Hiemstra <p.hiemstra at geo.uu.nl> wrote:
>   
>> Hi people,
>>
>> I have a question regarding plotting a SpatialPolygonsDataFrame using
>> ggplot2. To convert the SPDF to a dataframe with the coordinates I already
>> use the excellent solution provided by Hadley in:
>>
>> http://tolstoy.newcastle.edu.au/R/e6/help/09/03/8668.html
>>
>> Some example code:
>>
>> library(maptools)
>> library(ggplot2)
>> x <- readShapePoly(system.file("shapes/sids.shp", package="maptools")[1],
>>     IDvar="FIPSNO", proj4string=CRS("+proj=longlat +ellps=clrk66"))
>> dum = fortify(x, region = "CNTY_ID")
>> ggplot(dum, aes(x = long, y = lat)) + geom_path()
>>
>> My problem is that not only the counties are drawn, but also lines between
>> the end point of one countie polygon and the beginning of the next. I solve
>> this right now by adding the counties I want to plot one by one using:
>>
>> p + geom_path(subset(dum, id == 1) + geom_path(subset(dum, id == 2) + ...
>> etc
>>
>> This is of course a solution, but not an elegant one. Creating a new ggplot
>> object like:
>>
>> unique_ids = unique(dum$id)
>> bla = ggplot(subset(dum, id == unique_ids[1]), aes(x =long, y = lat)) +
>> geom_path()
>> for(id in unique_ids[2:length(unique_ids)]) {
>>      bla = bla + layer(data = subset(dum, id == id), mapping = aes(x =long,
>> y = lat), geom = "path")
>>   }
>> print(bla)
>>   Has exactly the same problem as using ggplot(dum, aes(x = long, y = lat))
>> + geom_path(). I browsed the net and the maling list and could not find the
>> answer, only references to the fortify() solution of Hadley.
>>
>> Anybody have an idea for an elegant solution to the problem?
>>
>> cheers,
>> Paul
>>
>> --
>> Drs. Paul Hiemstra
>> Department of Physical Geography
>> Faculty of Geosciences
>> University of Utrecht
>> Heidelberglaan 2
>> P.O. Box 80.115
>> 3508 TC Utrecht
>> Phone:  +3130 274 3113 Mon-Tue
>> Phone:  +3130 253 5773 Wed-Fri
>> http://intamap.geo.uu.nl/~paul
>> http://nl.linkedin.com/pub/paul-hiemstra/20/30b/770
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>     
>
>
>
>   


-- 
Drs. Paul Hiemstra
Department of Physical Geography
Faculty of Geosciences
University of Utrecht
Heidelberglaan 2
P.O. Box 80.115
3508 TC Utrecht
Phone:  +3130 274 3113 Mon-Tue
Phone:  +3130 253 5773 Wed-Fri
http://intamap.geo.uu.nl/~paul
http://nl.linkedin.com/pub/paul-hiemstra/20/30b/770


From bli at lsu.edu  Tue Apr 27 18:17:45 2010
From: bli at lsu.edu (Bin Li)
Date: Tue, 27 Apr 2010 11:17:45 -0500
Subject: [R-sig-Geo] Guam island map
Message-ID: <D1FB60396F4B7341B9BDB77753D1D53C018D8785@email001.lsu.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100427/cbfe36b2/attachment.pl>

From r.hijmans at gmail.com  Tue Apr 27 18:38:49 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 27 Apr 2010 09:38:49 -0700
Subject: [R-sig-Geo] Guam island map
In-Reply-To: <D1FB60396F4B7341B9BDB77753D1D53C018D8785@email001.lsu.edu>
References: <D1FB60396F4B7341B9BDB77753D1D53C018D8785@email001.lsu.edu>
Message-ID: <t2tdc22b2571004270938s7b99b239v66aadba1be928e26@mail.gmail.com>

Here is one approach (out of many)

library(raster)
guam = getData('GADM', country='GUM', level=0)
library(maps)
data(world.cities)
cit = subset(world.cities, country.etc == 'Guam')

plot(guam, col='grey', lwd=2)
points(cit$lon, cit$lat, col='red', pch=19)


Robert

On Tue, Apr 27, 2010 at 9:17 AM, Bin Li <bli at lsu.edu> wrote:
> I am trying to draw a map of Guam island in R. Basically, I'd like to draw the coastlines of the island and point some cities on it. I tried maps package but output a line (see the code below).
>
> library(maps)
> data(world.cities)
> try<-which((world.cities[,5]>144.6)&(world.cities[,5]<144.94))
> world.cities[try,]
> map("world", "USA:Guam")
>
>
> Any feedback is welcome. Thanks.
>
> Bin
>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From cheluna at gmail.com  Tue Apr 27 23:09:46 2010
From: cheluna at gmail.com (Consuelo Hermosilla)
Date: Tue, 27 Apr 2010 23:09:46 +0200
Subject: [R-sig-Geo] error in dudi.pca (adehabitat)
Message-ID: <j2j62a688d1004271409qc28b506o8c8528cf7c4161f7@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100427/815bb28d/attachment.pl>

From basille at biomserv.univ-lyon1.fr  Tue Apr 27 23:31:36 2010
From: basille at biomserv.univ-lyon1.fr (Mathieu Basille)
Date: Tue, 27 Apr 2010 17:31:36 -0400
Subject: [R-sig-Geo] error in dudi.pca (adehabitat)
In-Reply-To: <j2j62a688d1004271409qc28b506o8c8528cf7c4161f7@mail.gmail.com>
References: <j2j62a688d1004271409qc28b506o8c8528cf7c4161f7@mail.gmail.com>
Message-ID: <4BD757B8.9080404@biomserv.univ-lyon1.fr>

Dear Consuelo,

I guess the error just propagates from the initial import, and has 
nothing to do with dudi.pca (which is by the way from the ade4 package 
-- not directly related to adehabitat).

Your approach otherwise seems (quite) OK. Unfortunately, you didn't 
provide enough details to check. Could you provide the whole code, with 
possibly some data, so that we can reproduce the problem?

Cheers,
Mathieu.



Consuelo Hermosilla a ?crit :
> Hi folks,
> 
> I'm trying to implement an ecological niche factor analysis with octopus but
> I have some problems. I think it is related to the fact I have No-data
> values. Since it's a marine species, I have land areas where I have no-data
> values. Can I have grids with no-data values?
> 
> The thing is I'm able to import the ascii grid (using import.asc) and I'm
> even able to plot it (and see the image), so I guessed I have no problems
> with the no-data values. If I checked the grid, I got this:
> 
> str(chl)
>  asc [1:1214, 1:761] NA NA NA NA NA NA NA NA NA NA ...
>  - attr(*, "xll")= num -18.6
>  - attr(*, "yll")= num 16.7
>  - attr(*, "cellsize")= num 0.05
>  - attr(*, "type")= chr "numeric"
> 
> It looks wrong, but it's OK since my first values are indeed NA. In fact,
> besides the fact I'm able to plot it, I can calculate grid means and other
> stats, so I think the problem is not here. Then, when I grouped all the
> grids (with the as.kasc function), I got this:
> 
> str(env_maps)
> Classes ?kasc? and 'data.frame':        923854 obs. of  13 variables:
>  $ : num  NA NA NA NA NA NA NA NA NA NA ...
>  $ : num  NA NA NA NA NA NA NA NA NA NA ...
>  $ : num  NA NA NA NA NA NA NA NA NA NA ...
>  $ : num  NA NA NA NA NA NA NA NA NA NA ...
>  $ : num  NA NA NA NA NA NA NA NA NA NA ...
>  $ : num  NA NA NA NA NA NA NA NA NA NA ...
>  $ : num  NA NA NA NA NA NA NA NA NA NA ...
>  $ : num  NA NA NA NA NA NA NA NA NA NA ...
>  $ : num  NA NA NA NA NA NA NA NA NA NA ...
>  $ : num  NA NA NA NA NA NA NA NA NA NA ...
>  $ : num  NA NA NA NA NA NA NA NA NA NA ...
>  $ : num  NA NA NA NA NA NA NA NA NA NA ...
>  $ : num  NA NA NA NA NA NA NA NA NA NA ...
>  - attr(*, "cellsize")= num 0.05
>  - attr(*, "xll")= num -18.6
>  - attr(*, "yll")= num 16.7
>  - attr(*, "ncol")= int 1214
>  - attr(*, "nrow")= int 761
>  - attr(*, "type")= chr  "numeric" "numeric" "numeric" "numeric" ...
> 
> Still looks wrong, but it shouldn't be. Then, I proceed with the data2enfa
> function, that seemed to work. But in the next step, when I was calculating
> the dudi.pca, it failed, with this error:
> 
> Error in `rownames<-`(`*tmp*`, value = c("1", "2", "3", "4", "5", "6",  :
>   attempt to set rownames on object with no dimensions
> 
> I checked the data2enfa result and I got this:
> 
> List of 4
>  $ tab  :'data.frame':  923854 obs. of  0 variables
>  $ pr   : int [1:923854] 0 0 0 0 0 0 0 0 0 0 ...
>  $ index: int [1:923854] 1 2 3 4 5 6 7 8 9 10 ...
>  $ attr :Class 'mapattr'  atomic [1:1] 0
>   .. ..- attr(*, "xll")= num -18.6
>   .. ..- attr(*, "yll")= num 16.7
>   .. ..- attr(*, "cellsize")= num 0.05
>   .. ..- attr(*, "nrow")= int 761
>   .. ..- attr(*, "ncol")= int 1214
>  - attr(*, "class")= chr "dataenfa"
> 
> When I check the $tab, I got this:
> 
> octopus.hab$tab
> data frame with 0 columns and 923854 rows*
> 
> *And I have no idea of what's wrong.... any ideas? do you suggest anything?
> Why do I have 0 columns and 923854 rows? Is that possible? Can the data2enfa
> funcion deal with no-data values?
> 
> I tried the magagNAkasc, but doesn't work...
> 
> managNAkasc (env_maps)
> Raster map of class "kasc":
> Cell size:  0.05
> Number of rows:  761
> Number of columns:  1214
> 
> Variables measured:
> 1. : numeric
> Error in .subset2(x, i, exact = exact) :
>   attempt to select less than one element
> 
> I have tried in Windows Vista and Linux (both R 2.10.1 and adehabitat v
> 1.83.
> 
> I'd appreciate any help!!
> 
> Thanks!!!
> 
> Consuelo
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 

~$ whoami
Mathieu Basille, Post-Doc

~$ locate
Laboratoire d'?cologie Comportementale et de Conservation de la Faune
+ Centre d'?tude de la For?t
D?partement de Biologie
Universit? Laval, Qu?bec

~$ info
http://ase-research.org/basille

~$ fortune
``If you can't win by reason, go for volume.''
Calvin, by Bill Watterson.


From cheluna at gmail.com  Tue Apr 27 23:44:09 2010
From: cheluna at gmail.com (Consuelo Hermosilla)
Date: Tue, 27 Apr 2010 23:44:09 +0200
Subject: [R-sig-Geo] error in dudi.pca (adehabitat)
In-Reply-To: <4BD757B8.9080404@biomserv.univ-lyon1.fr>
References: <j2j62a688d1004271409qc28b506o8c8528cf7c4161f7@mail.gmail.com> 
	<4BD757B8.9080404@biomserv.univ-lyon1.fr>
Message-ID: <i2t62a688d1004271444u87c12b8ft4ce35c6d740323f4@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100427/45330e2f/attachment.pl>

From basille at biomserv.univ-lyon1.fr  Tue Apr 27 23:58:31 2010
From: basille at biomserv.univ-lyon1.fr (Mathieu Basille)
Date: Tue, 27 Apr 2010 17:58:31 -0400
Subject: [R-sig-Geo] error in dudi.pca (adehabitat)
In-Reply-To: <i2t62a688d1004271444u87c12b8ft4ce35c6d740323f4@mail.gmail.com>
References: <j2j62a688d1004271409qc28b506o8c8528cf7c4161f7@mail.gmail.com>
	<4BD757B8.9080404@biomserv.univ-lyon1.fr>
	<i2t62a688d1004271444u87c12b8ft4ce35c6d740323f4@mail.gmail.com>
Message-ID: <4BD75E07.5040205@biomserv.univ-lyon1.fr>

The code seems OK (try to avoid the '=' as the attribution sign, and use 
always '<-' instead). Do you have access to a public (or not) ftp server 
that you could use temporarily for the occasion? Otherwise, you can use 
e.g. http://dl.free.fr/ (in French, but should be easy), where you can 
protect your files with a password.

I'm not sure I can debug this without the data...

Cheers,
Mathieu.


Consuelo Hermosilla a ?crit :
> Dear Mathieu,
> 
> Thanks for your quick reply!!! :)
> 
> I thought that too, but then, why I'm able to plot the imported map? It 
> makes no sense, I wouldn't be able to plot it if there was an error 
> there, would I?
> 
> This was my code:
> 
> library(adehabitat)
> 
> chl= import.asc("chl-box_qt.asc", type ="numeric")
> sst = import.asc("sst-box_QT.asc", type ="numeric")
> dep = import.asc("dep-box_QT.asc", type ="numeric")
> euph = import.asc("euph-box_QT.asc", type ="numeric")
> OX0 = import.asc("OX0-box_QT.asc", type ="numeric")
> OX200 = import.asc("OX200-box_QT.asc", type ="numeric")
> OX50 = import.asc("OX50-box_QT.asc", type ="numeric")
> P0 = import.asc("P0-box_QT.asc", type ="numeric")
> P100 = import.asc("P100-box_QT.asc", type ="numeric")
> P125 = import.asc("P125-box_QT.asc", type ="numeric")
> P150 = import.asc("P150-box_QT.asc", type ="numeric")
> P200 = import.asc("P200-box_QT.asc", type ="numeric")
> pre = import.asc("pre-box_QT.asc", type ="numeric")
> 
> env_maps = as.kasc(list(chl, sst, dep, euph, OX0, OX200, OX50, P0, P100, 
> P125, P150, P200, pre))
> 
> managNAkasc (env_maps)  # just to check
> presence <- read.csv("presence.csv")
> octopus.hab <- data2enfa(env_maps, presence)
> pca.octopus <- dudi.pca(octopus.hab$tab, scannf=FALSE)
> 
> Can I attach files? How do you want me to provide data?
> 
> Consuelo
> 
> -------------
> Consuelo Hermosilla
> PhD student
> Departamento de Ecolog?a y Biolog?a Animal
> Departamento de Bioqu?mica, Gen?tica e Inmunolog?a, ?rea de Gen?tica
> Facultad de Ciencias del Mar
> Campus de As Lagoas-Marcosende
> Universidad de Vigo
> 36310 Vigo
> SPAIN
> Mobile: +34 692 633 298
> 
> oooO
> (     ) Oooo
>    (   (     )
>   _)    )  /
>         (_/
> 
> Stop Gaza Massacre
> 
> 
> On Tue, Apr 27, 2010 at 11:31 PM, Mathieu Basille 
> <basille at biomserv.univ-lyon1.fr <mailto:basille at biomserv.univ-lyon1.fr>> 
> wrote:
> 
>     Dear Consuelo,
> 
>     I guess the error just propagates from the initial import, and has
>     nothing to do with dudi.pca (which is by the way from the ade4
>     package -- not directly related to adehabitat).
> 
>     Your approach otherwise seems (quite) OK. Unfortunately, you didn't
>     provide enough details to check. Could you provide the whole code,
>     with possibly some data, so that we can reproduce the problem?
> 
>     Cheers,
>     Mathieu.
> 
> 
> 
>     Consuelo Hermosilla a ?crit :
> 
>         Hi folks,
> 
>         I'm trying to implement an ecological niche factor analysis with
>         octopus but
>         I have some problems. I think it is related to the fact I have
>         No-data
>         values. Since it's a marine species, I have land areas where I
>         have no-data
>         values. Can I have grids with no-data values?
> 
>         The thing is I'm able to import the ascii grid (using
>         import.asc) and I'm
>         even able to plot it (and see the image), so I guessed I have no
>         problems
>         with the no-data values. If I checked the grid, I got this:
> 
>         str(chl)
>          asc [1:1214, 1:761] NA NA NA NA NA NA NA NA NA NA ...
>          - attr(*, "xll")= num -18.6
>          - attr(*, "yll")= num 16.7
>          - attr(*, "cellsize")= num 0.05
>          - attr(*, "type")= chr "numeric"
> 
>         It looks wrong, but it's OK since my first values are indeed NA.
>         In fact,
>         besides the fact I'm able to plot it, I can calculate grid means
>         and other
>         stats, so I think the problem is not here. Then, when I grouped
>         all the
>         grids (with the as.kasc function), I got this:
> 
>         str(env_maps)
>         Classes ?kasc? and 'data.frame':        923854 obs. of  13
>         variables:
>          $ : num  NA NA NA NA NA NA NA NA NA NA ...
>          $ : num  NA NA NA NA NA NA NA NA NA NA ...
>          $ : num  NA NA NA NA NA NA NA NA NA NA ...
>          $ : num  NA NA NA NA NA NA NA NA NA NA ...
>          $ : num  NA NA NA NA NA NA NA NA NA NA ...
>          $ : num  NA NA NA NA NA NA NA NA NA NA ...
>          $ : num  NA NA NA NA NA NA NA NA NA NA ...
>          $ : num  NA NA NA NA NA NA NA NA NA NA ...
>          $ : num  NA NA NA NA NA NA NA NA NA NA ...
>          $ : num  NA NA NA NA NA NA NA NA NA NA ...
>          $ : num  NA NA NA NA NA NA NA NA NA NA ...
>          $ : num  NA NA NA NA NA NA NA NA NA NA ...
>          $ : num  NA NA NA NA NA NA NA NA NA NA ...
>          - attr(*, "cellsize")= num 0.05
>          - attr(*, "xll")= num -18.6
>          - attr(*, "yll")= num 16.7
>          - attr(*, "ncol")= int 1214
>          - attr(*, "nrow")= int 761
>          - attr(*, "type")= chr  "numeric" "numeric" "numeric" "numeric" ...
> 
>         Still looks wrong, but it shouldn't be. Then, I proceed with the
>         data2enfa
>         function, that seemed to work. But in the next step, when I was
>         calculating
>         the dudi.pca, it failed, with this error:
> 
>         Error in `rownames<-`(`*tmp*`, value = c("1", "2", "3", "4",
>         "5", "6",  :
>          attempt to set rownames on object with no dimensions
> 
>         I checked the data2enfa result and I got this:
> 
>         List of 4
>          $ tab  :'data.frame':  923854 obs. of  0 variables
>          $ pr   : int [1:923854] 0 0 0 0 0 0 0 0 0 0 ...
>          $ index: int [1:923854] 1 2 3 4 5 6 7 8 9 10 ...
>          $ attr :Class 'mapattr'  atomic [1:1] 0
>          .. ..- attr(*, "xll")= num -18.6
>          .. ..- attr(*, "yll")= num 16.7
>          .. ..- attr(*, "cellsize")= num 0.05
>          .. ..- attr(*, "nrow")= int 761
>          .. ..- attr(*, "ncol")= int 1214
>          - attr(*, "class")= chr "dataenfa"
> 
>         When I check the $tab, I got this:
> 
>         octopus.hab$tab
>         data frame with 0 columns and 923854 rows*
> 
>         *And I have no idea of what's wrong.... any ideas? do you
>         suggest anything?
>         Why do I have 0 columns and 923854 rows? Is that possible? Can
>         the data2enfa
>         funcion deal with no-data values?
> 
>         I tried the magagNAkasc, but doesn't work...
> 
>         managNAkasc (env_maps)
>         Raster map of class "kasc":
>         Cell size:  0.05
>         Number of rows:  761
>         Number of columns:  1214
> 
>         Variables measured:
>         1. : numeric
>         Error in .subset2(x, i, exact = exact) :
>          attempt to select less than one element
> 
>         I have tried in Windows Vista and Linux (both R 2.10.1 and
>         adehabitat v
>         1.83.
> 
>         I'd appreciate any help!!
> 
>         Thanks!!!
> 
>         Consuelo
> 
>                [[alternative HTML version deleted]]
> 
>         _______________________________________________
>         R-sig-Geo mailing list
>         R-sig-Geo at stat.math.ethz.ch <mailto:R-sig-Geo at stat.math.ethz.ch>
>         https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 
>     -- 
> 
>     ~$ whoami
>     Mathieu Basille, Post-Doc
> 
>     ~$ locate
>     Laboratoire d'?cologie Comportementale et de Conservation de la Faune
>     + Centre d'?tude de la For?t
>     D?partement de Biologie
>     Universit? Laval, Qu?bec
> 
>     ~$ info
>     http://ase-research.org/basille
> 
>     ~$ fortune
>     ``If you can't win by reason, go for volume.''
>     Calvin, by Bill Watterson.
> 
> 

-- 

~$ whoami
Mathieu Basille, Post-Doc

~$ locate
Laboratoire d'?cologie Comportementale et de Conservation de la Faune
+ Centre d'?tude de la For?t
D?partement de Biologie
Universit? Laval, Qu?bec

~$ info
http://ase-research.org/basille

~$ fortune
``If you can't win by reason, go for volume.''
Calvin, by Bill Watterson.


From basille at biomserv.univ-lyon1.fr  Wed Apr 28 05:11:28 2010
From: basille at biomserv.univ-lyon1.fr (Mathieu Basille)
Date: Tue, 27 Apr 2010 23:11:28 -0400
Subject: [R-sig-Geo] error in dudi.pca (adehabitat)
In-Reply-To: <i2t62a688d1004271444u87c12b8ft4ce35c6d740323f4@mail.gmail.com>
References: <j2j62a688d1004271409qc28b506o8c8528cf7c4161f7@mail.gmail.com>
	<4BD757B8.9080404@biomserv.univ-lyon1.fr>
	<i2t62a688d1004271444u87c12b8ft4ce35c6d740323f4@mail.gmail.com>
Message-ID: <4BD7A760.9050601@biomserv.univ-lyon1.fr>

Wow, this one gave me a real hard time, especially considering how easy 
the solution was.

In brief, you have to specify names in the list, in the as.kasc 
function. Otherwise, none of the layers have actually names, which 
induces a lot of problems afterwards.

The fix is quite easy then. I took also some the liberty to clean the 
code at different places:

library(adehabitat)

chl <- import.asc("chl-box_qt.asc")
sst <- import.asc("sst-box_QT.asc")
dep <- import.asc("dep-box_QT.asc")
euph <- import.asc("euph-box_QT.asc")
OX0 <- import.asc("OX0-box_QT.asc")
OX200 <- import.asc("OX200-box_QT.asc")
OX50 <- import.asc("OX50-box_QT.asc")
P0 <- import.asc("P0-box_QT.asc")
P100 <- import.asc("P100-box_QT.asc")
P125 <- import.asc("P125-box_QT.asc")
P150 <- import.asc("P150-box_QT.asc")
P200 <- import.asc("P200-box_QT.asc")
pre <- import.asc("pre-box_QT.asc")

# The problem was here:
env_maps <- as.kasc(list(chl = chl, sst = sst, dep = dep, euph = euph, 
OX0 = OX0, OX200 = OX200, OX50 = OX50, P0 = P0, P100 = P100, P125 = 
P125, P150 = P150, P200 = P200, pre = pre))

# You forgot to save the output of this, but in your case, that was not
# a problem
env_maps <- managNAkasc(env_maps)  # just to check

presence <- read.csv("presence5.csv")
# I assumed that the second and third columns give X-Y coordinates. But
# it is somehow weird since many of them fall in the water -- assuming
# it's islands and water
octopus.hab <- data2enfa(env_maps, presence[, 2:3])

pca.octopus <- dudi.pca(octopus.hab$tab, scannf = FALSE)


Hope this helps,
Cheers,
Mathieu.


Consuelo Hermosilla a ?crit :
> Dear Mathieu,
> 
> Thanks for your quick reply!!! :)
> 
> I thought that too, but then, why I'm able to plot the imported map? It 
> makes no sense, I wouldn't be able to plot it if there was an error 
> there, would I?
> 
> This was my code:
> 
> library(adehabitat)
> 
> chl= import.asc("chl-box_qt.asc", type ="numeric")
> sst = import.asc("sst-box_QT.asc", type ="numeric")
> dep = import.asc("dep-box_QT.asc", type ="numeric")
> euph = import.asc("euph-box_QT.asc", type ="numeric")
> OX0 = import.asc("OX0-box_QT.asc", type ="numeric")
> OX200 = import.asc("OX200-box_QT.asc", type ="numeric")
> OX50 = import.asc("OX50-box_QT.asc", type ="numeric")
> P0 = import.asc("P0-box_QT.asc", type ="numeric")
> P100 = import.asc("P100-box_QT.asc", type ="numeric")
> P125 = import.asc("P125-box_QT.asc", type ="numeric")
> P150 = import.asc("P150-box_QT.asc", type ="numeric")
> P200 = import.asc("P200-box_QT.asc", type ="numeric")
> pre = import.asc("pre-box_QT.asc", type ="numeric")
> 
> env_maps = as.kasc(list(chl, sst, dep, euph, OX0, OX200, OX50, P0, P100, 
> P125, P150, P200, pre))
> 
> managNAkasc (env_maps)  # just to check
> presence <- read.csv("presence.csv")
> octopus.hab <- data2enfa(env_maps, presence)
> pca.octopus <- dudi.pca(octopus.hab$tab, scannf=FALSE)
> 
> Can I attach files? How do you want me to provide data?
> 
> Consuelo
> 
> -------------
> Consuelo Hermosilla
> PhD student
> Departamento de Ecolog?a y Biolog?a Animal
> Departamento de Bioqu?mica, Gen?tica e Inmunolog?a, ?rea de Gen?tica
> Facultad de Ciencias del Mar
> Campus de As Lagoas-Marcosende
> Universidad de Vigo
> 36310 Vigo
> SPAIN
> Mobile: +34 692 633 298
> 
> oooO
> (     ) Oooo
>    (   (     )
>   _)    )  /
>         (_/
> 
> Stop Gaza Massacre
> 
> 
> On Tue, Apr 27, 2010 at 11:31 PM, Mathieu Basille 
> <basille at biomserv.univ-lyon1.fr <mailto:basille at biomserv.univ-lyon1.fr>> 
> wrote:
> 
>     Dear Consuelo,
> 
>     I guess the error just propagates from the initial import, and has
>     nothing to do with dudi.pca (which is by the way from the ade4
>     package -- not directly related to adehabitat).
> 
>     Your approach otherwise seems (quite) OK. Unfortunately, you didn't
>     provide enough details to check. Could you provide the whole code,
>     with possibly some data, so that we can reproduce the problem?
> 
>     Cheers,
>     Mathieu.
> 
> 
> 
>     Consuelo Hermosilla a ?crit :
> 
>         Hi folks,
> 
>         I'm trying to implement an ecological niche factor analysis with
>         octopus but
>         I have some problems. I think it is related to the fact I have
>         No-data
>         values. Since it's a marine species, I have land areas where I
>         have no-data
>         values. Can I have grids with no-data values?
> 
>         The thing is I'm able to import the ascii grid (using
>         import.asc) and I'm
>         even able to plot it (and see the image), so I guessed I have no
>         problems
>         with the no-data values. If I checked the grid, I got this:
> 
>         str(chl)
>          asc [1:1214, 1:761] NA NA NA NA NA NA NA NA NA NA ...
>          - attr(*, "xll")= num -18.6
>          - attr(*, "yll")= num 16.7
>          - attr(*, "cellsize")= num 0.05
>          - attr(*, "type")= chr "numeric"
> 
>         It looks wrong, but it's OK since my first values are indeed NA.
>         In fact,
>         besides the fact I'm able to plot it, I can calculate grid means
>         and other
>         stats, so I think the problem is not here. Then, when I grouped
>         all the
>         grids (with the as.kasc function), I got this:
> 
>         str(env_maps)
>         Classes ?kasc? and 'data.frame':        923854 obs. of  13
>         variables:
>          $ : num  NA NA NA NA NA NA NA NA NA NA ...
>          $ : num  NA NA NA NA NA NA NA NA NA NA ...
>          $ : num  NA NA NA NA NA NA NA NA NA NA ...
>          $ : num  NA NA NA NA NA NA NA NA NA NA ...
>          $ : num  NA NA NA NA NA NA NA NA NA NA ...
>          $ : num  NA NA NA NA NA NA NA NA NA NA ...
>          $ : num  NA NA NA NA NA NA NA NA NA NA ...
>          $ : num  NA NA NA NA NA NA NA NA NA NA ...
>          $ : num  NA NA NA NA NA NA NA NA NA NA ...
>          $ : num  NA NA NA NA NA NA NA NA NA NA ...
>          $ : num  NA NA NA NA NA NA NA NA NA NA ...
>          $ : num  NA NA NA NA NA NA NA NA NA NA ...
>          $ : num  NA NA NA NA NA NA NA NA NA NA ...
>          - attr(*, "cellsize")= num 0.05
>          - attr(*, "xll")= num -18.6
>          - attr(*, "yll")= num 16.7
>          - attr(*, "ncol")= int 1214
>          - attr(*, "nrow")= int 761
>          - attr(*, "type")= chr  "numeric" "numeric" "numeric" "numeric" ...
> 
>         Still looks wrong, but it shouldn't be. Then, I proceed with the
>         data2enfa
>         function, that seemed to work. But in the next step, when I was
>         calculating
>         the dudi.pca, it failed, with this error:
> 
>         Error in `rownames<-`(`*tmp*`, value = c("1", "2", "3", "4",
>         "5", "6",  :
>          attempt to set rownames on object with no dimensions
> 
>         I checked the data2enfa result and I got this:
> 
>         List of 4
>          $ tab  :'data.frame':  923854 obs. of  0 variables
>          $ pr   : int [1:923854] 0 0 0 0 0 0 0 0 0 0 ...
>          $ index: int [1:923854] 1 2 3 4 5 6 7 8 9 10 ...
>          $ attr :Class 'mapattr'  atomic [1:1] 0
>          .. ..- attr(*, "xll")= num -18.6
>          .. ..- attr(*, "yll")= num 16.7
>          .. ..- attr(*, "cellsize")= num 0.05
>          .. ..- attr(*, "nrow")= int 761
>          .. ..- attr(*, "ncol")= int 1214
>          - attr(*, "class")= chr "dataenfa"
> 
>         When I check the $tab, I got this:
> 
>         octopus.hab$tab
>         data frame with 0 columns and 923854 rows*
> 
>         *And I have no idea of what's wrong.... any ideas? do you
>         suggest anything?
>         Why do I have 0 columns and 923854 rows? Is that possible? Can
>         the data2enfa
>         funcion deal with no-data values?
> 
>         I tried the magagNAkasc, but doesn't work...
> 
>         managNAkasc (env_maps)
>         Raster map of class "kasc":
>         Cell size:  0.05
>         Number of rows:  761
>         Number of columns:  1214
> 
>         Variables measured:
>         1. : numeric
>         Error in .subset2(x, i, exact = exact) :
>          attempt to select less than one element
> 
>         I have tried in Windows Vista and Linux (both R 2.10.1 and
>         adehabitat v
>         1.83.
> 
>         I'd appreciate any help!!
> 
>         Thanks!!!
> 
>         Consuelo
> 
>                [[alternative HTML version deleted]]
> 
>         _______________________________________________
>         R-sig-Geo mailing list
>         R-sig-Geo at stat.math.ethz.ch <mailto:R-sig-Geo at stat.math.ethz.ch>
>         https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 
>     -- 
> 
>     ~$ whoami
>     Mathieu Basille, Post-Doc
> 
>     ~$ locate
>     Laboratoire d'?cologie Comportementale et de Conservation de la Faune
>     + Centre d'?tude de la For?t
>     D?partement de Biologie
>     Universit? Laval, Qu?bec
> 
>     ~$ info
>     http://ase-research.org/basille
> 
>     ~$ fortune
>     ``If you can't win by reason, go for volume.''
>     Calvin, by Bill Watterson.
> 
> 

-- 

~$ whoami
Mathieu Basille, Post-Doc

~$ locate
Laboratoire d'?cologie Comportementale et de Conservation de la Faune
+ Centre d'?tude de la For?t
D?partement de Biologie
Universit? Laval, Qu?bec

~$ info
http://ase-research.org/basille

~$ fortune
``If you can't win by reason, go for volume.''
Calvin, by Bill Watterson.


From roman.lustrik at gmail.com  Wed Apr 28 07:25:01 2010
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Wed, 28 Apr 2010 07:25:01 +0200
Subject: [R-sig-Geo] Guam island map
In-Reply-To: <D1FB60396F4B7341B9BDB77753D1D53C018D8785@email001.lsu.edu>
References: <D1FB60396F4B7341B9BDB77753D1D53C018D8785@email001.lsu.edu>
Message-ID: <j2k63a206011004272225j5dd0198dkc6385e416379b4d@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100428/e6433c6d/attachment.pl>

From roman.lustrik at gmail.com  Wed Apr 28 09:37:20 2010
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Wed, 28 Apr 2010 09:37:20 +0200
Subject: [R-sig-Geo] raster sizes
Message-ID: <l2k63a206011004280037m16e2e0b8p60252dafc3800587@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100428/ebb5c4a8/attachment.pl>

From jacobvanetten at yahoo.com  Wed Apr 28 10:07:10 2010
From: jacobvanetten at yahoo.com (Jacob van Etten)
Date: Wed, 28 Apr 2010 01:07:10 -0700 (PDT)
Subject: [R-sig-Geo] raster sizes
In-Reply-To: <l2k63a206011004280037m16e2e0b8p60252dafc3800587@mail.gmail.com>
Message-ID: <767315.28165.qm@web32906.mail.mud.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100428/adf9e82f/attachment.pl>

From cheluna at gmail.com  Wed Apr 28 11:31:54 2010
From: cheluna at gmail.com (Consuelo Hermosilla)
Date: Wed, 28 Apr 2010 11:31:54 +0200
Subject: [R-sig-Geo] error in dudi.pca (adehabitat)
In-Reply-To: <4BD7A760.9050601@biomserv.univ-lyon1.fr>
References: <j2j62a688d1004271409qc28b506o8c8528cf7c4161f7@mail.gmail.com> 
	<4BD757B8.9080404@biomserv.univ-lyon1.fr>
	<i2t62a688d1004271444u87c12b8ft4ce35c6d740323f4@mail.gmail.com>
	<4BD7A760.9050601@biomserv.univ-lyon1.fr>
Message-ID: <z2j62a688d1004280231i947e530eoc5106b2f0708e11f@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100428/b2a96b48/attachment.pl>

From timerbrecht at web.de  Wed Apr 28 12:54:44 2010
From: timerbrecht at web.de (Tim Erbrecht)
Date: Wed, 28 Apr 2010 12:54:44 +0200 (CEST)
Subject: [R-sig-Geo] Calculate area of raster cells
Message-ID: <13435090.524295.1272452084682.JavaMail.fmail@mwmweb030>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100428/bd26a984/attachment.html>

From p.hiemstra at geo.uu.nl  Wed Apr 28 13:07:21 2010
From: p.hiemstra at geo.uu.nl (Paul Hiemstra)
Date: Wed, 28 Apr 2010 13:07:21 +0200
Subject: [R-sig-Geo] Calculate area of raster cells
In-Reply-To: <13435090.524295.1272452084682.JavaMail.fmail@mwmweb030>
References: <13435090.524295.1272452084682.JavaMail.fmail@mwmweb030>
Message-ID: <4BD816E9.4020005@geo.uu.nl>

Tim Erbrecht wrote:
>
> Dear all,
>
>  
>
> having data in a SpatialGridDataFrame with geographic coordinates, is 
> there a simple method to calculate the spatial area for each cell? I 
> wasn't able to find anything in the list archives ...
>
>  
>
> Thanks and best regards
>
> Tim
>
> ------------------------------------------------------------------------
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>   
with the meuse dataset:

library(sp)
data(meuse.grid)
gridded(meuse.grid) = ~x+y
fullgrid(meuse.grid) = TRUE
bla = gridparameters(meuse.grid)
area = bla$cellsize[1] * bla$cellsize[2]
area

cheers,
Paul

-- 
Drs. Paul Hiemstra
Department of Physical Geography
Faculty of Geosciences
University of Utrecht
Heidelberglaan 2
P.O. Box 80.115
3508 TC Utrecht
Phone:  +3130 274 3113 Mon-Tue
Phone:  +3130 253 5773 Wed-Fri
http://intamap.geo.uu.nl/~paul
http://nl.linkedin.com/pub/paul-hiemstra/20/30b/770


From Roger.Bivand at nhh.no  Wed Apr 28 13:16:14 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 28 Apr 2010 13:16:14 +0200 (CEST)
Subject: [R-sig-Geo] Calculate area of raster cells
In-Reply-To: <4BD816E9.4020005@geo.uu.nl>
References: <13435090.524295.1272452084682.JavaMail.fmail@mwmweb030>
	<4BD816E9.4020005@geo.uu.nl>
Message-ID: <alpine.LRH.2.00.1004281314350.20567@reclus.nhh.no>

On Wed, 28 Apr 2010, Paul Hiemstra wrote:

> Tim Erbrecht wrote:
>> 
>> Dear all,
>>
>> 
>> having data in a SpatialGridDataFrame with geographic coordinates, is there 
>> a simple method to calculate the spatial area for each cell? I wasn't able 
>> to find anything in the list archives ...
>>
>> 
>> Thanks and best regards
>> 
>> Tim
>> 
>> ------------------------------------------------------------------------
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
> with the meuse dataset:
>
> library(sp)
> data(meuse.grid)
> gridded(meuse.grid) = ~x+y
> fullgrid(meuse.grid) = TRUE
> bla = gridparameters(meuse.grid)
> area = bla$cellsize[1] * bla$cellsize[2]
> area

These are projected, not geographical coordinates, unfortunately. The case 
for calculating areas on an ellipsoid is much harder, I'm afraid.

Roger

>
> cheers,
> Paul
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From basille at biomserv.univ-lyon1.fr  Wed Apr 28 14:33:50 2010
From: basille at biomserv.univ-lyon1.fr (Mathieu Basille)
Date: Wed, 28 Apr 2010 08:33:50 -0400
Subject: [R-sig-Geo] error in dudi.pca (adehabitat)
In-Reply-To: <z2j62a688d1004280231i947e530eoc5106b2f0708e11f@mail.gmail.com>
References: <j2j62a688d1004271409qc28b506o8c8528cf7c4161f7@mail.gmail.com>
	<4BD757B8.9080404@biomserv.univ-lyon1.fr>
	<i2t62a688d1004271444u87c12b8ft4ce35c6d740323f4@mail.gmail.com>
	<4BD7A760.9050601@biomserv.univ-lyon1.fr>
	<z2j62a688d1004280231i947e530eoc5106b2f0708e11f@mail.gmail.com>
Message-ID: <4BD82B2E.1020001@biomserv.univ-lyon1.fr>

Glad that it does work now.

But considering it is a marine species, I'm not sure what you want to do 
with data2enfa. This function returns 1) a data frame with the value for 
each pixel (that you can get directly with kasc2df) and 2) a vector of 
presence ($pr) which gives the number of localisations in each pixel of 
the map (i.e. not NA). For a perfect marine species, it should give you 
only 0s.

Now in your case, you get 99 localisations (on a total of 212) on the 
ground... Maybe that's a normal behaviour for this species, or maybe 
it's a problem of location error, but that's what made me think about 
what you exactly want to do.

Cheers,
Mathieu.


Consuelo Hermosilla a ?crit :
> Hello Mathieu,
> 
> I cannot believe it!! I have tried adding the names, with less layers, 
> and it didn't work either, so I guessed that was not the problem. I 
> guess I have others problems too. But now it does work! I'm amazed. I'm 
> sorry you lost so much time. I deeply thank you.
> 
> Yes. the second and third columns were the coordinates, I apologize, I 
> thought I sent you a file with the coordinates only. And about falling 
> into the water, they must do that! it's a marine species.
> 
> Thank you very very much Mathieu,
> 
> Consuelo
> 
> -------------
> Consuelo Hermosilla
> PhD student
> Departamento de Ecolog?a y Biolog?a Animal
> Departamento de Bioqu?mica, Gen?tica e Inmunolog?a, ?rea de Gen?tica
> Facultad de Ciencias del Mar
> Campus de As Lagoas-Marcosende
> Universidad de Vigo
> 36310 Vigo
> SPAIN
> Mobile: +34 692 633 298
> 
> oooO
> (     ) Oooo
>    (   (     )
>   _)    )  /
>         (_/
> 
> Stop Gaza Massacre
> 
> 
> On Wed, Apr 28, 2010 at 5:11 AM, Mathieu Basille 
> <basille at biomserv.univ-lyon1.fr <mailto:basille at biomserv.univ-lyon1.fr>> 
> wrote:
> 
>     Wow, this one gave me a real hard time, especially considering how
>     easy the solution was.
> 
>     In brief, you have to specify names in the list, in the as.kasc
>     function. Otherwise, none of the layers have actually names, which
>     induces a lot of problems afterwards.
> 
>     The fix is quite easy then. I took also some the liberty to clean
>     the code at different places:
> 
>     library(adehabitat)
> 
>     chl <- import.asc("chl-box_qt.asc")
>     sst <- import.asc("sst-box_QT.asc")
>     dep <- import.asc("dep-box_QT.asc")
>     euph <- import.asc("euph-box_QT.asc")
>     OX0 <- import.asc("OX0-box_QT.asc")
>     OX200 <- import.asc("OX200-box_QT.asc")
>     OX50 <- import.asc("OX50-box_QT.asc")
>     P0 <- import.asc("P0-box_QT.asc")
>     P100 <- import.asc("P100-box_QT.asc")
>     P125 <- import.asc("P125-box_QT.asc")
>     P150 <- import.asc("P150-box_QT.asc")
>     P200 <- import.asc("P200-box_QT.asc")
>     pre <- import.asc("pre-box_QT.asc")
> 
>     # The problem was here:
>     env_maps <- as.kasc(list(chl = chl, sst = sst, dep = dep, euph =
>     euph, OX0 = OX0, OX200 = OX200, OX50 = OX50, P0 = P0, P100 = P100,
>     P125 = P125, P150 = P150, P200 = P200, pre = pre))
> 
>     # You forgot to save the output of this, but in your case, that was not
>     # a problem
>     env_maps <- managNAkasc(env_maps)  # just to check
> 
>     presence <- read.csv("presence5.csv")
>     # I assumed that the second and third columns give X-Y coordinates. But
>     # it is somehow weird since many of them fall in the water -- assuming
>     # it's islands and water
>     octopus.hab <- data2enfa(env_maps, presence[, 2:3])
> 
> 
>     pca.octopus <- dudi.pca(octopus.hab$tab, scannf = FALSE)
> 
> 
>     Hope this helps,
> 
>     Cheers,
>     Mathieu.
> 
> 
>     Consuelo Hermosilla a ?crit :
> 
>         Dear Mathieu,
> 
> 
>         Thanks for your quick reply!!! :)
> 
>         I thought that too, but then, why I'm able to plot the imported
>         map? It makes no sense, I wouldn't be able to plot it if there
>         was an error there, would I?
> 
>         This was my code:
> 
>         library(adehabitat)
> 
>         chl= import.asc("chl-box_qt.asc", type ="numeric")
>         sst = import.asc("sst-box_QT.asc", type ="numeric")
>         dep = import.asc("dep-box_QT.asc", type ="numeric")
>         euph = import.asc("euph-box_QT.asc", type ="numeric")
>         OX0 = import.asc("OX0-box_QT.asc", type ="numeric")
>         OX200 = import.asc("OX200-box_QT.asc", type ="numeric")
>         OX50 = import.asc("OX50-box_QT.asc", type ="numeric")
>         P0 = import.asc("P0-box_QT.asc", type ="numeric")
>         P100 = import.asc("P100-box_QT.asc", type ="numeric")
>         P125 = import.asc("P125-box_QT.asc", type ="numeric")
>         P150 = import.asc("P150-box_QT.asc", type ="numeric")
>         P200 = import.asc("P200-box_QT.asc", type ="numeric")
>         pre = import.asc("pre-box_QT.asc", type ="numeric")
> 
>         env_maps = as.kasc(list(chl, sst, dep, euph, OX0, OX200, OX50,
>         P0, P100, P125, P150, P200, pre))
> 
>         managNAkasc (env_maps)  # just to check
>         presence <- read.csv("presence.csv")
>         octopus.hab <- data2enfa(env_maps, presence)
>         pca.octopus <- dudi.pca(octopus.hab$tab, scannf=FALSE)
> 
>         Can I attach files? How do you want me to provide data?
> 
>         Consuelo
> 
>         -------------
>         Consuelo Hermosilla
>         PhD student
>         Departamento de Ecolog?a y Biolog?a Animal
>         Departamento de Bioqu?mica, Gen?tica e Inmunolog?a, ?rea de Gen?tica
>         Facultad de Ciencias del Mar
>         Campus de As Lagoas-Marcosende
>         Universidad de Vigo
>         36310 Vigo
>         SPAIN
>         Mobile: +34 692 633 298
> 
>         oooO
>         (     ) Oooo
>           (   (     )
>          _)    )  /
>                (_/
> 
>         Stop Gaza Massacre
> 
> 
>         On Tue, Apr 27, 2010 at 11:31 PM, Mathieu Basille
>         <basille at biomserv.univ-lyon1.fr
>         <mailto:basille at biomserv.univ-lyon1.fr>
>         <mailto:basille at biomserv.univ-lyon1.fr
>         <mailto:basille at biomserv.univ-lyon1.fr>>> wrote:
> 
>            Dear Consuelo,
> 
>            I guess the error just propagates from the initial import,
>         and has
>            nothing to do with dudi.pca (which is by the way from the ade4
>            package -- not directly related to adehabitat).
> 
>            Your approach otherwise seems (quite) OK. Unfortunately, you
>         didn't
>            provide enough details to check. Could you provide the whole
>         code,
>            with possibly some data, so that we can reproduce the problem?
> 
>            Cheers,
>            Mathieu.
> 
> 
> 
>            Consuelo Hermosilla a ?crit :
> 
>                Hi folks,
> 
>                I'm trying to implement an ecological niche factor
>         analysis with
>                octopus but
>                I have some problems. I think it is related to the fact I
>         have
>                No-data
>                values. Since it's a marine species, I have land areas
>         where I
>                have no-data
>                values. Can I have grids with no-data values?
> 
>                The thing is I'm able to import the ascii grid (using
>                import.asc) and I'm
>                even able to plot it (and see the image), so I guessed I
>         have no
>                problems
>                with the no-data values. If I checked the grid, I got this:
> 
>                str(chl)
>                 asc [1:1214, 1:761] NA NA NA NA NA NA NA NA NA NA ...
>                 - attr(*, "xll")= num -18.6
>                 - attr(*, "yll")= num 16.7
>                 - attr(*, "cellsize")= num 0.05
>                 - attr(*, "type")= chr "numeric"
> 
>                It looks wrong, but it's OK since my first values are
>         indeed NA.
>                In fact,
>                besides the fact I'm able to plot it, I can calculate
>         grid means
>                and other
>                stats, so I think the problem is not here. Then, when I
>         grouped
>                all the
>                grids (with the as.kasc function), I got this:
> 
>                str(env_maps)
>                Classes ?kasc? and 'data.frame':        923854 obs. of  13
>                variables:
>                 $ : num  NA NA NA NA NA NA NA NA NA NA ...
>                 $ : num  NA NA NA NA NA NA NA NA NA NA ...
>                 $ : num  NA NA NA NA NA NA NA NA NA NA ...
>                 $ : num  NA NA NA NA NA NA NA NA NA NA ...
>                 $ : num  NA NA NA NA NA NA NA NA NA NA ...
>                 $ : num  NA NA NA NA NA NA NA NA NA NA ...
>                 $ : num  NA NA NA NA NA NA NA NA NA NA ...
>                 $ : num  NA NA NA NA NA NA NA NA NA NA ...
>                 $ : num  NA NA NA NA NA NA NA NA NA NA ...
>                 $ : num  NA NA NA NA NA NA NA NA NA NA ...
>                 $ : num  NA NA NA NA NA NA NA NA NA NA ...
>                 $ : num  NA NA NA NA NA NA NA NA NA NA ...
>                 $ : num  NA NA NA NA NA NA NA NA NA NA ...
>                 - attr(*, "cellsize")= num 0.05
>                 - attr(*, "xll")= num -18.6
>                 - attr(*, "yll")= num 16.7
>                 - attr(*, "ncol")= int 1214
>                 - attr(*, "nrow")= int 761
>                 - attr(*, "type")= chr  "numeric" "numeric" "numeric"
>         "numeric" ...
> 
>                Still looks wrong, but it shouldn't be. Then, I proceed
>         with the
>                data2enfa
>                function, that seemed to work. But in the next step, when
>         I was
>                calculating
>                the dudi.pca, it failed, with this error:
> 
>                Error in `rownames<-`(`*tmp*`, value = c("1", "2", "3", "4",
>                "5", "6",  :
>                 attempt to set rownames on object with no dimensions
> 
>                I checked the data2enfa result and I got this:
> 
>                List of 4
>                 $ tab  :'data.frame':  923854 obs. of  0 variables
>                 $ pr   : int [1:923854] 0 0 0 0 0 0 0 0 0 0 ...
>                 $ index: int [1:923854] 1 2 3 4 5 6 7 8 9 10 ...
>                 $ attr :Class 'mapattr'  atomic [1:1] 0
>                 .. ..- attr(*, "xll")= num -18.6
>                 .. ..- attr(*, "yll")= num 16.7
>                 .. ..- attr(*, "cellsize")= num 0.05
>                 .. ..- attr(*, "nrow")= int 761
>                 .. ..- attr(*, "ncol")= int 1214
>                 - attr(*, "class")= chr "dataenfa"
> 
>                When I check the $tab, I got this:
> 
>                octopus.hab$tab
>                data frame with 0 columns and 923854 rows*
> 
>                *And I have no idea of what's wrong.... any ideas? do you
>                suggest anything?
>                Why do I have 0 columns and 923854 rows? Is that
>         possible? Can
>                the data2enfa
>                funcion deal with no-data values?
> 
>                I tried the magagNAkasc, but doesn't work...
> 
>                managNAkasc (env_maps)
>                Raster map of class "kasc":
>                Cell size:  0.05
>                Number of rows:  761
>                Number of columns:  1214
> 
>                Variables measured:
>                1. : numeric
>                Error in .subset2(x, i, exact = exact) :
>                 attempt to select less than one element
> 
>                I have tried in Windows Vista and Linux (both R 2.10.1 and
>                adehabitat v
>                1.83.
> 
>                I'd appreciate any help!!
> 
>                Thanks!!!
> 
>                Consuelo
> 
>                       [[alternative HTML version deleted]]
> 
>                _______________________________________________
>                R-sig-Geo mailing list
>                R-sig-Geo at stat.math.ethz.ch
>         <mailto:R-sig-Geo at stat.math.ethz.ch>
>         <mailto:R-sig-Geo at stat.math.ethz.ch
>         <mailto:R-sig-Geo at stat.math.ethz.ch>>
> 
>                https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 
>            --
>            ~$ whoami
>            Mathieu Basille, Post-Doc
> 
>            ~$ locate
>            Laboratoire d'?cologie Comportementale et de Conservation de
>         la Faune
>            + Centre d'?tude de la For?t
>            D?partement de Biologie
>            Universit? Laval, Qu?bec
> 
>            ~$ info
>            http://ase-research.org/basille
> 
>            ~$ fortune
>            ``If you can't win by reason, go for volume.''
>            Calvin, by Bill Watterson.
> 
> 
> 
>     -- 
> 
>     ~$ whoami
>     Mathieu Basille, Post-Doc
> 
>     ~$ locate
>     Laboratoire d'?cologie Comportementale et de Conservation de la Faune
>     + Centre d'?tude de la For?t
>     D?partement de Biologie
>     Universit? Laval, Qu?bec
> 
>     ~$ info
>     http://ase-research.org/basille
> 
>     ~$ fortune
>     ``If you can't win by reason, go for volume.''
>     Calvin, by Bill Watterson.
> 
> 

-- 

~$ whoami
Mathieu Basille, Post-Doc

~$ locate
Laboratoire d'?cologie Comportementale et de Conservation de la Faune
+ Centre d'?tude de la For?t
D?partement de Biologie
Universit? Laval, Qu?bec

~$ info
http://ase-research.org/basille

~$ fortune
``If you can't win by reason, go for volume.''
Calvin, by Bill Watterson.


From ted.rosenbaum at yale.edu  Wed Apr 28 17:09:45 2010
From: ted.rosenbaum at yale.edu (Ted Rosenbaum)
Date: Wed, 28 Apr 2010 11:09:45 -0400
Subject: [R-sig-Geo] point process panel regression?
Message-ID: <s2qc15201271004280809vd5398747zc1ec0ad5ed6f30a9@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100428/31237e7f/attachment.pl>

From r.hijmans at gmail.com  Wed Apr 28 19:02:42 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 28 Apr 2010 10:02:42 -0700
Subject: [R-sig-Geo] Calculate area of raster cells
In-Reply-To: <13435090.524295.1272452084682.JavaMail.fmail@mwmweb030>
References: <13435090.524295.1272452084682.JavaMail.fmail@mwmweb030>
Message-ID: <q2xdc22b2571004281002u392d2b47g594115e8853f8317@mail.gmail.com>

Tim,

if your SpatialGridDataFrame is called 'spgdf', you can do

library(raster)
r = raster(spgdf)
a = area(r)
plot(a)
spgdf2 = as(a, 'SpatialGridDataFrame')

That gives a reasonable estimate in most cases (it uses the
longitudinal span of the center of each cell).

For more precise computations,  you can coerce the grid (or perhaps
the first cell of each row if the grid is large) to polygons and then
use "areaPolygons" in the development version (on R-Forge) of
"geosphere".
install.packages("geosphere", repos="http://R-Forge.R-project.org")

This function computes the area of spherical polygons.  How you would
implement this could very well depend on the size of your raster

rr = raster(r)
p = rasterToPolygons(rr)   # or an sp coerce method from the spgdf
rr[] = areaPolygon(p)

Here is a short illustration:
r = raster(nrow=30, ncol=4, ymn=-89)  # excluding South Pole; bugs there
p = rasterToPolygons(r)
library(geosphere)
r[] = areaPolygon(p)
plot(r)


Robert

On Wed, Apr 28, 2010 at 3:54 AM, Tim Erbrecht <timerbrecht at web.de> wrote:
> Dear all,
>
>
>
> having data in a SpatialGridDataFrame with geographic coordinates, is there
> a simple method to calculate the spatial area for each cell? I wasn't able
> to find anything in the list archives ...
>
>
>
> Thanks and best regards
>
> Tim
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


From r.hijmans at gmail.com  Wed Apr 28 19:06:35 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 28 Apr 2010 10:06:35 -0700
Subject: [R-sig-Geo] Calculate area of raster cells
In-Reply-To: <alpine.LRH.2.00.1004281314350.20567@reclus.nhh.no>
References: <13435090.524295.1272452084682.JavaMail.fmail@mwmweb030>
	<4BD816E9.4020005@geo.uu.nl>
	<alpine.LRH.2.00.1004281314350.20567@reclus.nhh.no>
Message-ID: <p2hdc22b2571004281006y49101e99he548c121ce3d0425@mail.gmail.com>

P.S. The solution I just posted assumes the earth is a sphere, not an
ellipsoid (which would be more accurate).

> These are projected, not geographical coordinates, unfortunately. The case
> for calculating areas on an ellipsoid is much harder, I'm afraid.
>
> Roger


On Wed, Apr 28, 2010 at 4:16 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> On Wed, 28 Apr 2010, Paul Hiemstra wrote:
>
>> Tim Erbrecht wrote:
>>>
>>> Dear all,
>>>
>>>
>>> having data in a SpatialGridDataFrame with geographic coordinates, is
>>> there a simple method to calculate the spatial area for each cell? I wasn't
>>> able to find anything in the list archives ...
>>>
>>>
>>> Thanks and best regards
>>>
>>> Tim
>>>
>>> ------------------------------------------------------------------------
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>> with the meuse dataset:
>>
>> library(sp)
>> data(meuse.grid)
>> gridded(meuse.grid) = ~x+y
>> fullgrid(meuse.grid) = TRUE
>> bla = gridparameters(meuse.grid)
>> area = bla$cellsize[1] * bla$cellsize[2]
>> area
>
> These are projected, not geographical coordinates, unfortunately. The case
> for calculating areas on an ellipsoid is much harder, I'm afraid.
>
> Roger
>
>>
>> cheers,
>> Paul
>>
>>
>
> --
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From gildemir at gmail.com  Thu Apr 29 05:43:10 2010
From: gildemir at gmail.com (Francisco Silva)
Date: Thu, 29 Apr 2010 00:43:10 -0300
Subject: [R-sig-Geo] Wheight matrices
Message-ID: <j2q48d290dc1004282043p5e9df491zdd7f4ccbfd074e61@mail.gmail.com>

Hi folks,

I am trying to do an spatial econometric model and I need a wheigt matrix.
I have tried so many times to do such thing in R, but I did not find the way.
I would like to know, if is possible to do the matrix in R?
If yes, how does i should do? Please, send the steps because I have
tried with so many packages and always i get wornings messages.
If somebody can help me I can send the .shp file to see how this work.
I know how to read a shape file and even plot maps, but i did not find
the way to construct an adjascency matrix.

Thanks a lot,
Francisco Gildemir Ferreira da Silva


From nikhil.list at gmail.com  Thu Apr 29 06:01:37 2010
From: nikhil.list at gmail.com (Nikhil Kaza)
Date: Thu, 29 Apr 2010 00:01:37 -0400
Subject: [R-sig-Geo] Wheight matrices
In-Reply-To: <j2q48d290dc1004282043p5e9df491zdd7f4ccbfd074e61@mail.gmail.com>
References: <j2q48d290dc1004282043p5e9df491zdd7f4ccbfd074e61@mail.gmail.com>
Message-ID: <FF18938B-4E77-4687-9B41-A171E40A07A4@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100429/46f17d40/attachment.pl>

From julien.beguin.1 at ulaval.ca  Thu Apr 29 17:25:39 2010
From: julien.beguin.1 at ulaval.ca (Julien Beguin)
Date: Thu, 29 Apr 2010 11:25:39 -0400
Subject: [R-sig-Geo] RE :  Wheight matrices
In-Reply-To: <j2q48d290dc1004282043p5e9df491zdd7f4ccbfd074e61@mail.gmail.com>
References: <j2q48d290dc1004282043p5e9df491zdd7f4ccbfd074e61@mail.gmail.com>
Message-ID: <B56D7C27B4408243B93FBC46ABECB5A0011A85049D73@EXCH-MBX-F.ulaval.ca>

Hi Francisco,

In complement to the previous answer, the following code (with "spdep" package) might give you what you are looking for (1st order neighborhood):

------------------------------------------------------------------------------------------------
   require(spdep) 
   shape <- readShapePoly("path_to_my_shapefile", IDvar="Id_of_your_polygons")
   shape_nb<-poly2nb(shape)

   data<-list(
   N = length(shape_nb),
   num=sapply(shape_nb, length),
   adj=unlist(shape_nb),
   lst = attr(shape_nb, "region.id"),
   adj2 = lst[unlist(shape_nb)],
   sumNumNeigh=length(unlist(shape_nb)
                  )
------------------------------------------------------------------------------------------------

If you want to vary the order of neighborhood: see ?nblag 

The lines 3 to 6 make the format of the adjacency matrix compatible for Winbugs but you can play around that to get any desirable format, depending on which software or R-model you use.

Hope it helps,

Julien Beguin 

______________________________________
De : r-sig-geo-bounces at stat.math.ethz.ch [r-sig-geo-bounces at stat.math.ethz.ch] de la part de Francisco Silva [gildemir at gmail.com]
Date d'envoi : 28 avril 2010 23:43
? : r-sig-geo at stat.math.ethz.ch
Objet : [R-sig-Geo] Wheight matrices

Hi folks,

I am trying to do an spatial econometric model and I need a wheigt matrix.
I have tried so many times to do such thing in R, but I did not find the way.
I would like to know, if is possible to do the matrix in R?
If yes, how does i should do? Please, send the steps because I have
tried with so many packages and always i get wornings messages.
If somebody can help me I can send the .shp file to see how this work.
I know how to read a shape file and even plot maps, but i did not find
the way to construct an adjascency matrix.

Thanks a lot,
Francisco Gildemir Ferreira da Silva

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch
https://stat.ethz.ch/mailman/listinfo/r-sig-geo

From german.sanchez at ais-int.com  Thu Apr 29 17:57:05 2010
From: german.sanchez at ais-int.com (German Sanchez Hernandez)
Date: Thu, 29 Apr 2010 17:57:05 +0200
Subject: [R-sig-Geo] Adding a shape with writeOGR
In-Reply-To: <224BDB65-4FB8-4396-BC31-F0F280CE5BC1@ais-int.com>
References: <224BDB65-4FB8-4396-BC31-F0F280CE5BC1@ais-int.com>
Message-ID: <4CE184CB-7B5B-4137-964B-76E5E9F531C2@ais-int.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100429/90515f90/attachment.pl>

From edzer.pebesma at uni-muenster.de  Thu Apr 29 18:31:06 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 29 Apr 2010 18:31:06 +0200
Subject: [R-sig-Geo] Adding a shape with writeOGR
In-Reply-To: <4CE184CB-7B5B-4137-964B-76E5E9F531C2@ais-int.com>
References: <224BDB65-4FB8-4396-BC31-F0F280CE5BC1@ais-int.com>
	<4CE184CB-7B5B-4137-964B-76E5E9F531C2@ais-int.com>
Message-ID: <4BD9B44A.30904@uni-muenster.de>



German Sanchez Hernandez wrote:
> Hi again,
> 
> The "overwrite=no" doesn't work (it is not recognized so the error I get is that the table yet exists).
> 
> I'm using R not only to save my shape files into a database but to "sptransform" some of them and to perform some operations on them.
> 
> I've made a script to do all operations over the shapes and to write them in a unique folder. So, I could process them using shp2pgsql (with the "-a" flag for appending them to an existing table).
> 
> But I would like to do it using R because the current approach (reading, processing, writting to disk, reading and writting to DB) is not efficient at all. The alternative (reading, processing, writting to a temp table, moving to the final table and dropping the temp table) is better but it still has some expendable steps.
> 
> Any other idea?

Maybe, for finding help, I guess you need to get involved somehow with
the person who wrote or maintain the postgis driver in gdal -- R simply
interfaces to it, but has no possibility nor any pretention to extend
gdal drivers as such.
--
Edzer

> 
> Thanks,
> Germ?n S?nchez
> 
> On 22/04/2010, Alex Mandel wrote:
> The obvious question here, what happens if you set overwrite=no?
> 
> If the only thing you're using R for is converting a shapefile to
> postgis you might want to just use ogr2ogr on the command line with the
> -append option. Postgis also ships with a shp2pgsql tool that might
> handle this too.
> 
> Alternately you can always load more data into a temp table and then run
>  some SQL to add the additional records to the first table.
> 
> 
> Alex
> 
> El 22/04/2010, a las 14:03, German Sanchez Hernandez escribi?:
> 
>> Dear all,
>>
>> I'm trying to save some shapes to a postGIS table. I can do it by:
>>
>>  shape <- readShapePoly(...)
>>  writeOGR(shape, dsn="PG:dbname=gis user=gis password=...", layer='onetable', driver="PostgreSQL", layer_options="overwrite=yes")
>>
>> It empties the "onetable" table. Then, how could I do if I want to add other shape to this table without overwritting it?
>>
>> I've searched for the params of "layer_options", but I didn't find nothing.
>>
>> Thank you!
>> Germ?n S?nchez
>>
> 
> 
> 	[[alternative HTML version deleted]]
> 
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From Jason.Gasper at noaa.gov  Thu Apr 29 22:20:15 2010
From: Jason.Gasper at noaa.gov (Jason Gasper)
Date: Thu, 29 Apr 2010 12:20:15 -0800
Subject: [R-sig-Geo] Weighted Head-Banging and Weighted Median
Message-ID: <4BD9E9FF.9010307@noaa.gov>

Hi Folks,

Thanks everyone for their time.  I am wondering if there is an R package 
out there for spatial smoothing using a weighted median and/or weighted 
head-banging algorithm (Mungiole et. al 1999). If not, does someone have 
some code they would be willing to share?

Thanks-Jason

-- 
Jason Gasper
National Marine Fisheries Service
Alaska Region, Sustainable Fisheries Division
709 W. 9th St. Juneau, Alaska 99801 
Juneau, Alaska 99801


From tom.richardson at bristol.ac.uk  Thu Apr 29 22:21:51 2010
From: tom.richardson at bristol.ac.uk (Tom_R)
Date: Thu, 29 Apr 2010 13:21:51 -0700 (PDT)
Subject: [R-sig-Geo] Spatstat- nearest neighbour correlation, nncorr
Message-ID: <1272572511193-4982162.post@n2.nabble.com>


Hi R users,

In the package Spatstat, I'd like to apply 'nncorr' to a point pattern (with
continuous marks), like this:

NNcorrel <- nncorr(pattern) *

However, I'm getting this error: "Error in nncorr(pattern) : Insufficient
data". This error is not because there are no points inside the window
(there are always >= 2 points). I think the error occurs because the mean
nearest neighbour distance is above a critical value. This critical value
seems to be the same as the 'range' argument that's used in the 'markcorr'
and 'pcf' R functions. I don't really understand why nncorr returns an error
when the points are far apart... 

So the question is, how do I tell nncorr to measure the correlation between
nearest-neighbours, IRRESPECTIVE of the mean nearest neighbour distance  ??

Thanks!
Tom

* actually I'm using a special correlation function for angular marks (see
help(markcorr) for details): 
NNcorrel <- nncorr(pattina, function(m1,m2) {sin(m1-m2)^2})
However, that's not particularly relevant as both this & the simpler version
given above return the same error.

-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Spatstat-nearest-neighbour-correlation-nncorr-tp4982162p4982162.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Adrian.Baddeley at csiro.au  Fri Apr 30 06:00:33 2010
From: Adrian.Baddeley at csiro.au (Adrian.Baddeley at csiro.au)
Date: Fri, 30 Apr 2010 12:00:33 +0800
Subject: [R-sig-Geo]  point process panel regression?
Message-ID: <57DC18C299094D4299F837570C5DF1C52B1201DB4C@EXWA-MBX01.nexus.csiro.au>

Ted Rosenbaum <ted.rosenbaum at yale.edu> wrote:

> I am looking to estimate a model using a MLE model of an inhomogenous
> Poisson point process (using ppm) in spatstat.  I have data on points that
> span many years (panel data) and I am looking to estimate a model where
> I can have the same coefficients for covariates for all years, but have
> different values of the covariates (points in space) for each year
> (basically run a traditional panel data regression, but for a point
> process), and allow for differing mean intensity by year (ie a year "fixed
> effect").  Is there a way to do this in spatstat (or another simple way to
> do it, without needing to code up the MLE and accompanying integral by
> myself).

In a forthcoming version of spatstat it will be possible to do this seamlessly. (The code already exists but is not yet released.)

For now, the simplest way to do this is to attach a mark to each point representing the year. Make sure that the mark is a factor. Then for each covariate, construct a function with arguments (x,y,year) that extracts the value of the covariate at location (x,y) in the given year. These functions should be in the global environment. Then fit a model using these covariate functions.

Example:
          # make some point data
          X2001 <- runifpoint(42)
          X2002 <- runifpoint(30)
          # make some covariate images
          pH2001 <- density(runifpoint(17))
          pH2002 <- density(runifpoint(20))
          # tweak
          X <- superimpose("2001"=X2001, "2002"=X2002)          
          pH <- function(x,y,year) { 
                 ifelse(year == "2001", pH2001[cbind(x,y)], pH2002[cbind(x,y)] )
          }
          # go
          ppm(X, ~marks + pH(x,y,marks))

In the model formula, the first term 'marks' gives you the fixed effect for each year. A typical result is:

..................................
Nonstationary multitype Poisson process
Possible marks: 
2001 2002

Trend formula: ~marks + pH(x, y, marks)

Fitted coefficients for trend formula:
    (Intercept)       marks2002 pH(x, y, marks) 
    3.852512251    -0.308405720    -0.006997323 

..................................

So the fixed effect estimates are 3.85 for 2001, and 3.85-0.31 = 3.54 for 2002, while the (year-independent) coefficient of the pH covariate is -0.007.

You can also do things like

         ppm(X, ~marks + polynom(pH(x,y,marks), 3))

to get a cubic function of the pH covariate.

Adrian Baddeley

--------------------------------

Prof Adrian Baddeley (UWA/CSIRO)
CSIRO Mathematics, Informatics & Statistics
Leeuwin Centre, 65 Brockway Road, Floreat WA 6014, Australia
Tel: 08 9333 6177 | Fax: 08 9333 6121 | Mob: 0410 447 821


From renger at ecoplan.ch  Fri Apr 30 11:08:35 2010
From: renger at ecoplan.ch (Renger van Nieuwkoop)
Date: Fri, 30 Apr 2010 11:08:35 +0200
Subject: [R-sig-Geo] Combining regions in one map
Message-ID: <7CD806EFDC19B64E82120E3FC0ADF6A35425E1@mx.ecoplan.local>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20100430/0fe4c934/attachment.pl>

From michal.palenik at freemap.sk  Fri Apr 30 11:15:25 2010
From: michal.palenik at freemap.sk (Michal Palenik)
Date: Fri, 30 Apr 2010 11:15:25 +0200
Subject: [R-sig-Geo] Combining regions in one map
In-Reply-To: <7CD806EFDC19B64E82120E3FC0ADF6A35425E1@mx.ecoplan.local>
References: <7CD806EFDC19B64E82120E3FC0ADF6A35425E1@mx.ecoplan.local>
Message-ID: <20100430091525.GA20700@tanicka.iz.sk>

hello

maybe postgis and its aggregate function would be a better tool for this
http://postgis.refractions.net/documentation/manual-svn/ch08.html#PostGIS_Aggregate_Functions



michal palenik
On Fri, Apr 30, 2010 at 11:08:35AM +0200, Renger van Nieuwkoop wrote:
> Hi
> I just started using PBSmapping for R and have the following question:
> I have shape files for the quartier level of a big city.Now I want to combine several quartiers to one bigger region.
> I have an attribute which relates the PID from the quartiers to the regions, but I do not manage to get a map of the region.
> It might be simple, but I haven't found out yet.
> Can anybody help me?
> Thanks
> Renger
> 
> _________________________________________
> Renger van Nieuwkoop
> Centre for Energy Policy and Economics, ETH
> Z?richbergstrasse 18 (ZUE)
> CH - 8032 Z?rich
> mailto: renger at vannieuwkoop.ch
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 

> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


-- 
michal palenik
www.freemap.sk
http://wiki.freemap.sk


