From dubroca at szn.it  Fri Sep  1 12:46:21 2006
From: dubroca at szn.it (Laurent Dubroca)
Date: Fri, 01 Sep 2006 12:46:21 +0200
Subject: [R-sig-Geo] CRS parameters
Message-ID: <44F80F7D.1050202@szn.it>

Hello list,

I use spmaps 0.1-4+gdal 1.3.1+proj 4.4.9 with R 2.3.1.
Starting with the example of the spmaps package and the 
map2SpatialPolygons function, it seems that the proj4strings parameters 
of this line are not correct :

nor_coast_poly_sp <- map2SpatialPolygons(nor_coast_poly, IDs=IDs, 
proj4string=CRS("+proj=longlat +datum=wgs84"))

The message returned is

"Erreur dans CRS("+proj=longlat +datum=wgs84") :
         unknown elliptical parameter name"

With the proj -l command I cannot find the projection called "latlong".

What's wrong ? Does my installed version of gdal or proj aren't correct ?

Laurent





-- 
Laurent Dubroca -  laurent.dubroca at szn.it
  http://laurent.dubroca.free.fr
Phone/FAX: 0039 081 5833 247/224
  Stazione Zoologica Anton Dohrn
Villa Comunale  80121 Naples Italy



From Roger.Bivand at nhh.no  Fri Sep  1 13:09:41 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 1 Sep 2006 13:09:41 +0200 (CEST)
Subject: [R-sig-Geo] CRS parameters
In-Reply-To: <44F80F7D.1050202@szn.it>
Message-ID: <Pine.LNX.4.44.0609011258200.5974-100000@reclus.nhh.no>

On Fri, 1 Sep 2006, Laurent Dubroca wrote:

> Hello list,
> 
> I use spmaps 0.1-4+gdal 1.3.1+proj 4.4.9 with R 2.3.1.
> Starting with the example of the spmaps package and the 
> map2SpatialPolygons function, it seems that the proj4strings parameters 
> of this line are not correct :
> 
> nor_coast_poly_sp <- map2SpatialPolygons(nor_coast_poly, IDs=IDs, 
> proj4string=CRS("+proj=longlat +datum=wgs84"))
> 
> The message returned is
> 
> "Erreur dans CRS("+proj=longlat +datum=wgs84") :
>          unknown elliptical parameter name"

You are running with rgdal loaded. I get the same error, because the datum
should be WGS84 rather than wgs84, see proj -le. I'll correct the example.

> 
> With the proj -l command I cannot find the projection called "latlong".
> 

No, that's OK, the longlat and latlong are placeholders for unprojected 
data - we use longlat because the X coordinates are the first column, not 
the second.

Thanks for a helpful report.

Roger

> What's wrong ? Does my installed version of gdal or proj aren't correct ?
> 
> Laurent
> 
> 
> 
> 
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From twgriffi at purdue.edu  Tue Sep  5 03:46:55 2006
From: twgriffi at purdue.edu (Griffin, Terry W)
Date: Mon, 4 Sep 2006 21:46:55 -0400
Subject: [R-sig-Geo] Continuous geostatistical approach to regression
Message-ID: <CD7951A61CF9644B8FC63A55CED4194B01A29FA2@EXCH03.purdue.lcl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20060904/87a58767/attachment.pl>

From paulojus at c3sl.ufpr.br  Tue Sep  5 05:36:39 2006
From: paulojus at c3sl.ufpr.br (Paulo Justiniano Ribeiro Jr)
Date: Tue, 5 Sep 2006 00:36:39 -0300 (BRT)
Subject: [R-sig-Geo] Continuous geostatistical approach to regression
In-Reply-To: <CD7951A61CF9644B8FC63A55CED4194B01A29FA2@EXCH03.purdue.lcl>
References: <CD7951A61CF9644B8FC63A55CED4194B01A29FA2@EXCH03.purdue.lcl>
Message-ID: <Pine.LNX.4.58.0609050033530.8456@macalan.c3sl.ufpr.br>

Hi Terry

The function likfit() in the package geoR allows you to do that.
You can specifiy a usual regression model in the argument "trend"
and the tyope of covariance structure.

For an example see the data set "hoef"

require(geoR)
data(hoef)
?hoef

best
P.J.



On Mon, 4 Sep 2006, Griffin, Terry W wrote:

> I want to perform inferential statistical regressions of spatial data
> and compare a few methods.  I have been working with the techniques to
> perform the discrete approach to spatial data, i.e. techniques in spdep,
> spatial econometric, etc., all along and want to broaden the available
> tools.  I would like to perform the continuous approach in addition to
> the discrete approach, i.e. geostatistical, direct representation,
> variogram, Cressie's REML, etc. in the same datasets.  For instance, I
> would like to regress dependent variables on a set of explanatory
> variables where OLS residuals were spatially autocorrelated.  From the
> regression, I wish to determine the effect of small changes of each
> explanatory variable on the dependent variable.
>
>
>
> Any suggestions are appreciated.
>
>
>
> Thank you,
>
>
> Terry
>
>
>
>
>
> Terry W. Griffin
>
> Graduate Research Assistant
>
> Agricultural Economics
>
> Purdue University
>
> 403 W State St
>
> West Lafayette, IN 47907
>
> 765-494-4257
>
> http://web.ics.purdue.edu/~twgriffi/
> <http://web.ics.purdue.edu/~twgriffi/>
>
>
>
>
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



From twgriffi at purdue.edu  Thu Sep  7 04:47:24 2006
From: twgriffi at purdue.edu (Griffin, Terry W)
Date: Wed, 6 Sep 2006 22:47:24 -0400
Subject: [R-sig-Geo] spatial autoregressive parameter space
Message-ID: <CD7951A61CF9644B8FC63A55CED4194B01A29FB3@EXCH03.purdue.lcl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20060906/e8ac00d4/attachment.pl>

From Roger.Bivand at nhh.no  Thu Sep  7 09:18:35 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 7 Sep 2006 09:18:35 +0200 (CEST)
Subject: [R-sig-Geo] spatial autoregressive parameter space
In-Reply-To: <CD7951A61CF9644B8FC63A55CED4194B01A29FB3@EXCH03.purdue.lcl>
Message-ID: <Pine.LNX.4.44.0609070832510.7556-100000@reclus.nhh.no>

On Wed, 6 Sep 2006, Griffin, Terry W wrote:

> Greetings once again,
>  
> I've been searching to explain some odd results that I'm having with
> general moments (GM) estimators with the spatial error model.  The
> spatial autoregressive parameter lambda is outside the parameter space
> and is usually 1.1 to 1.2.
>  
> 
> This has occurred in several software packages and routines, including
> those in spdep.  The sample sizes of my datasets are 3,000 or greater
> and include site-specific information from agricultural experiments,
> i.e. yield monitor data.  All variables are highly spatially
> autocorrelated.  
>  
> In Kelejian and Prucha's (2006) paper "Specification and Estimation of
> Spatial Autoregressive Models with Autoregressive and Heteroskedastic
> Disturbances,"
> <http://www.econ.umd.edu/~prucha/Papers/WP_Prucha_3_2006.pdf>  they
> discuss in section 2.2 that the lambda needs to be transformed with the
> scalar normalization factor used to standardize the weights matrix.
> This of course, assumes I understood the K&P paper.  If the weights
> matrix is globally standardized, this normalization factor is simple to
> obtain, but with row-standardization it is not so clear.  In addition,
> the row-standardized weights matrix produces results that I might expect
> while the globally standardized weights matrix produces more erratic
> coefficients.  
>  
> Any suggestions or other comments? 

If you need a reliable estimator for the error simultaneous autoregressive
model (SAR really, not in K&P's terminology), use ML, GM is not a viable
alternative. I understand that for moderate sized data sets and high
dependence, results like yours are not unusual. K&P claim that the
contraint on the parameter in the Jacobian only applies exactly to (say)  
lambda == 1/max(eig(W)) at the top end, equivalently at the lower end, and
that values beyond these are OK.

This does not accord with Cressie (1993, p. 471, 7.2.35) or Schabenberger
& Gotway (2005, p. 336 - they refer to Haining 1990, p. 82), that is the
heavy spatial stats monographs (as I read them). GM fits optimise lambda
and sigma^2, and from my observations slither about a lot on a very flat
surface (which may have multiple local optima - see Guyon).  The optimiser
can be tuned to get a bit more precision (control=), but since GM assumes
that you can fit without properly respecting the Jacobian, it isn't
surprising that it hits more trouble when lambda approaches its upper
limit. If you have been using GMerrorsar() with return_LL=TRUE (default),
you've been using internal sparse methods to get the Jacobian to compute
the log likelihood for the GLS fit based on the lambda found by GM; in
that case going to ML shouldn't be painful.

With 3000 observations, I would have thought that ML is an option
(probably provided that your W is symmetric or row-standardised
symmetric). spdep can use sparse methods for this, as can James LeSage's
Matlab code, and the underlying code in GeoDa can also use sparse methods
(two latter untried by me recently). Of course ML will take a little
longer, but do use the value of the Jacobian (though there may be
numerical issues - I have seen log(|I - lambda*W|) of under -300, so the
actual value of the determinant is really as close to zero as you can get.

The spdep errorsarlm() has been run using method="SparseM" for n > 12000 
with style="B" with a good deal of argument-passing to set the bounds for 
line optimisation (interval=) and the SparseM det() allocation parameters 
cholAlloc=.

Hope this helps,

Roger

>  
> Thank you,
>  
> Terry
>  
> 
>  
> 
>  
> 
> Terry W. Griffin
> 
> Graduate Research Assistant
> 
> Agricultural Economics
> 
> Purdue University
> 
> 403 W State St
> 
> West Lafayette, IN 47907
> 
> 765-494-4257
> 
> http://web.ics.purdue.edu/~twgriffi/
> <http://web.ics.purdue.edu/~twgriffi/> 
> 
>  
> 
>  
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From isidora10 at yahoo.com  Thu Sep  7 14:58:39 2006
From: isidora10 at yahoo.com (isidora k)
Date: Thu, 7 Sep 2006 05:58:39 -0700 (PDT)
Subject: [R-sig-Geo] merging tables by columns AND row names (coordinates)
Message-ID: <20060907125840.81400.qmail@web52114.mail.yahoo.com>

Hi everyone!
I have 100 tables of the form:
XCOORD,YCOORD,OBSERVATION
27.47500,42.52641,177
27.48788,42.52641,177
27.50075,42.52641,179
27.51362,42.52641,178
27.52650,42.52641,180
27.53937,42.52641,178
27.55225,42.52641,181
27.56512,42.52641,177
27.57800,42.52641,181
27.59087,42.52641,181
27.60375,42.52641,180
27.61662,42.52641,181
..., ..., ...
with approximately 1000000 observations for each. All
these tables have the same xcoord and ycoord and I
would like to get a table of the form
XCOORD,YCOORD,OBSERVATION1,OBSERVATION2,... 
27.47500,42.52641,177,233,...
27.48788,42.52641,177,345,...
27.50075,42.52641,179,233,...
27.51362,42.52641,178,123,...
27.52650,42.52641,180,178,...
27.53937,42.52641,178,...,...
27.55225,42.52641,181,...
27.56512,42.52641,177,...
27.57800,42.52641,181,...
27.59087,42.52641,181,...
27.60375,42.52641,180,...
27.61662,42.52641,181,...
In other words I would like to merge all the tables
taking into account the common row names of their
xcoords AND ycoords.
Not all tables have the same number of observations
which means that not all pairs of x and y coords
match.
Is there a way to do this in R?
I would be grateful for any advice.
Many thanks
Isidora



From jonthayn at ku.edu  Fri Sep  8 00:02:34 2006
From: jonthayn at ku.edu (Jonathan Boyd Thayn)
Date: Thu, 7 Sep 2006 17:02:34 -0500
Subject: [R-sig-Geo] rgdal on Mac OS X 3.9
Message-ID: <d0d99d7663293e405a8c988c449e60d2@ku.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20060907/42a1d1bc/attachment.pl>

From debarchana.ghosh at gmail.com  Thu Sep  7 23:56:55 2006
From: debarchana.ghosh at gmail.com (Debarchana Ghosh)
Date: Thu, 7 Sep 2006 16:56:55 -0500
Subject: [R-sig-Geo] exact ponit location of dsease and clustering problem
Message-ID: <d1b8ff630609071456k65eb3f57q1788e58f085a50d6@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20060907/9c14ae0d/attachment.pl>

From mdsumner at utas.edu.au  Fri Sep  8 00:26:42 2006
From: mdsumner at utas.edu.au (Michael Sumner)
Date: Fri, 08 Sep 2006 08:26:42 +1000
Subject: [R-sig-Geo] merging tables by columns AND row names
	(coordinates)
In-Reply-To: <20060907125840.81400.qmail@web52114.mail.yahoo.com>
References: <20060907125840.81400.qmail@web52114.mail.yahoo.com>
Message-ID: <45009CA2.7020908@utas.edu.au>

Hello, I can think of a couple of simple-minded approaches that would 
take some time - either relying on direct string-matching for the unique 
coordinates, or by some contrived overlay.

However, there's probably far better approaches - a couple of questions:

Can you predefine the set of all unique coordinates without reading all 
the tables from file? 
 - if so you might simplify the identification of each individual 
coordinate, for matching the records

Are the coordinates (intended to be) on a regular grid?  (This seems 
unlikely, although it is nearly true given your X coordinates).

Cheers, Mike.


isidora k wrote:
> Hi everyone!
> I have 100 tables of the form:
> XCOORD,YCOORD,OBSERVATION
> 27.47500,42.52641,177
> 27.48788,42.52641,177
> 27.50075,42.52641,179
> 27.51362,42.52641,178
> 27.52650,42.52641,180
> 27.53937,42.52641,178
> 27.55225,42.52641,181
> 27.56512,42.52641,177
> 27.57800,42.52641,181
> 27.59087,42.52641,181
> 27.60375,42.52641,180
> 27.61662,42.52641,181
> ..., ..., ...
> with approximately 1000000 observations for each. All
> these tables have the same xcoord and ycoord and I
> would like to get a table of the form
> XCOORD,YCOORD,OBSERVATION1,OBSERVATION2,... 
> 27.47500,42.52641,177,233,...
> 27.48788,42.52641,177,345,...
> 27.50075,42.52641,179,233,...
> 27.51362,42.52641,178,123,...
> 27.52650,42.52641,180,178,...
> 27.53937,42.52641,178,...,...
> 27.55225,42.52641,181,...
> 27.56512,42.52641,177,...
> 27.57800,42.52641,181,...
> 27.59087,42.52641,181,...
> 27.60375,42.52641,180,...
> 27.61662,42.52641,181,...
> In other words I would like to merge all the tables
> taking into account the common row names of their
> xcoords AND ycoords.
> Not all tables have the same number of observations
> which means that not all pairs of x and y coords
> match.
> Is there a way to do this in R?
> I would be grateful for any advice.
> Many thanks
> Isidora
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>



From Roger.Bivand at nhh.no  Fri Sep  8 09:04:46 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 8 Sep 2006 09:04:46 +0200 (CEST)
Subject: [R-sig-Geo] merging tables by columns AND row names
	(coordinates)
In-Reply-To: <45009CA2.7020908@utas.edu.au>
Message-ID: <Pine.LNX.4.44.0609080846560.8545-100000@reclus.nhh.no>

On Fri, 8 Sep 2006, Michael Sumner wrote:

> Hello, I can think of a couple of simple-minded approaches that would 
> take some time - either relying on direct string-matching for the unique 
> coordinates, or by some contrived overlay.
> 
> However, there's probably far better approaches - a couple of questions:
> 
> Can you predefine the set of all unique coordinates without reading all 
> the tables from file? 
>  - if so you might simplify the identification of each individual 
> coordinate, for matching the records
> 
> Are the coordinates (intended to be) on a regular grid?  (This seems 
> unlikely, although it is nearly true given your X coordinates).

The key question is what the data are. To me they look like a global 
regular grid with some slippage in the print() - the underlying diff() of 
the unique x's and y's is almost certainly regular. I'm not sure why they 
are in text files either (model output?). But some bits of the grid may be 
missing, the question being whether this is regular. If as an earlier 
response indicated different data sets have different grid cells 
missing, then we need the overall grid to start with, then grab the row 
and column indices (and/or grid index), and attach these to the data rows. 

If the solution needs to be robust, and have a longer term utility, I 
would go for using MySQL, Terralib, and aRT. The data representation is 
that of the Terralib Cell object, so the question would be how to upload 
to the database from the text files.

aRT is at:

http://www.est.ufpr.br/aRT/

By the way, 1M by 100 by 8 bytes is pushing 32-bit R - but handing off a 
lot of the data storage to a database relieves this greatly.

Roger

> 
> Cheers, Mike.
> 
> 
> isidora k wrote:
> > Hi everyone!
> > I have 100 tables of the form:
> > XCOORD,YCOORD,OBSERVATION
> > 27.47500,42.52641,177
> > 27.48788,42.52641,177
> > 27.50075,42.52641,179
> > 27.51362,42.52641,178
> > 27.52650,42.52641,180
> > 27.53937,42.52641,178
> > 27.55225,42.52641,181
> > 27.56512,42.52641,177
> > 27.57800,42.52641,181
> > 27.59087,42.52641,181
> > 27.60375,42.52641,180
> > 27.61662,42.52641,181
> > ..., ..., ...
> > with approximately 1000000 observations for each. All
> > these tables have the same xcoord and ycoord and I
> > would like to get a table of the form
> > XCOORD,YCOORD,OBSERVATION1,OBSERVATION2,... 
> > 27.47500,42.52641,177,233,...
> > 27.48788,42.52641,177,345,...
> > 27.50075,42.52641,179,233,...
> > 27.51362,42.52641,178,123,...
> > 27.52650,42.52641,180,178,...
> > 27.53937,42.52641,178,...,...
> > 27.55225,42.52641,181,...
> > 27.56512,42.52641,177,...
> > 27.57800,42.52641,181,...
> > 27.59087,42.52641,181,...
> > 27.60375,42.52641,180,...
> > 27.61662,42.52641,181,...
> > In other words I would like to merge all the tables
> > taking into account the common row names of their
> > xcoords AND ycoords.
> > Not all tables have the same number of observations
> > which means that not all pairs of x and y coords
> > match.
> > Is there a way to do this in R?
> > I would be grateful for any advice.
> > Many thanks
> > Isidora
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> >
> >
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Roger.Bivand at nhh.no  Fri Sep  8 09:12:07 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 8 Sep 2006 09:12:07 +0200 (CEST)
Subject: [R-sig-Geo] rgdal on Mac OS X 3.9
In-Reply-To: <d0d99d7663293e405a8c988c449e60d2@ku.edu>
Message-ID: <Pine.LNX.4.44.0609080906300.8545-100000@reclus.nhh.no>

On Thu, 7 Sep 2006, Jonathan Boyd Thayn wrote:

> I am trying to install the rgdal package on my Mac OS X 3.9.  I have 
> installed the proj4 library and the GDAL library.  I get the following 
> error:  How do I know where the GDAL libraries are located?  What is 
> their path?  Thanks.

Could an OSX user please reply with help on how to find GDAL? Could 
someone also comment on the viability of this OS version?

We have had user reports of success building rgdal from source on OSX, but 
I don't think the specific OS version(s) used are known - could OSX users 
please reply to this thread so that the list archives have a body of 
experience about this, please? The same applies to the way(s) in which 
GDAL and PROJ.4 were installed.

Roger

> 
> 
> * Installing *source* package 'rgdal' ...
> ./configure: line 1: gdal-config: command not found
> 
> I was unable to find the gdal-config script distributed with
> GDAL. If you have not installed the GDAL libraries, you can
> download the source from  http://www.remotesensing.org/gdal/
> If you have installed the GDAL libraries, then make sure that
> gdal-config is in your path. Try typing gdal-config at a
> shell prompt and see if it runs. If not, find it and add its
> path to your shell path.
> 
> ** Removing 
> '/Library/Frameworks/R.framework/Versions/2.2/Resources/library/rgdal'
> ** Restoring previous 
> '/Library/Frameworks/R.framework/Versions/2.2/Resources/library/rgdal'
> ERROR: configuration failed for package 'rgdal'
> 
> 
> Jonathan B. Thayn
> Kansas Applied Remote Sensing (KARS) Program
> University of Kansas
> Higuchi Hall
> 2101 Constant Avenue
> Lawrence, Kansas 66047-3759
> jonthayn at ku.edu
> www.kars.ku.edu/about/people/thayn/JonSite/Welcome.html
> 	[[alternative text/enriched version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From marcelino.delacruz at upm.es  Fri Sep  8 11:40:24 2006
From: marcelino.delacruz at upm.es (Marcelino de la Cruz)
Date: Fri, 08 Sep 2006 11:40:24 +0200
Subject: [R-sig-Geo] exact ponit location of dsease and clustering
 problem
In-Reply-To: <d1b8ff630609071456k65eb3f57q1788e58f085a50d6@mail.gmail.co
 m>
References: <d1b8ff630609071456k65eb3f57q1788e58f085a50d6@mail.gmail.com>
Message-ID: <6.1.2.0.0.20060908113507.022e8388@correo.upm.es>

At 23:56 07/09/2006, Debarchana Ghosh wrote:


>Hi,
>
>I have a data set with exact locations (x,y) of  West Nile Virus positive
>birds and mosquitoes. From what I read and understood (hopefully) in the
>Dcluster package, the clustering methods requires the study area to be
>divided into small regions and use the centroids of those constructed
>regions.  But in my case I have a study area and exact locations of 200
>positive birds. I was wondering how to use the clustering methods mentioned
>in the Dcluster package to do a cluster analysis of disease data points.
>Also if I cannot use the clustering methods in the DCluster  package,  what
>other methods/packages should I check to do a point clustering analysis.
>
>Any help on this will be very much appreciated.
>
>Thanks,
>Debs.
>
>--
>Debarchana Ghosh
>Research Assistant,
>Department of Geography
>University of Minnesota.
>PH: 8143607580
>www.tc.umn.edu/~ghos0033/


For point clustering analysis, you may consider reading  the interesting 
lecture-notes on Spatial Statistics for Environmental Epidemiology of Peter 
Diggle (you can find them on its personal web page 
(http://www.maths.lancs.ac.uk/~diggle/)


Marcelino


***************************************
Marcelino de la Cruz Rot
Depto. Biologia Vegetal
ETS Ingenieros Agronomos
Universidad Politecnica de Madrid
28040-Madrid
SPAIN
marcelino.delacruz at upm.es



From v.gomezrubio at imperial.ac.uk  Fri Sep  8 13:11:30 2006
From: v.gomezrubio at imperial.ac.uk (Gomez Rubio, Virgilio)
Date: Fri, 8 Sep 2006 12:11:30 +0100
Subject: [R-sig-Geo] exact ponit location of dsease and clustering
	problem
References: <d1b8ff630609071456k65eb3f57q1788e58f085a50d6@mail.gmail.com>
Message-ID: <29D2CB9634376B4ABAE92E3891C5604F0145D8B9@icex2.ic.ac.uk>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20060908/d5454463/attachment.pl>

From Scott_Mitchell at carleton.ca  Fri Sep  8 19:56:29 2006
From: Scott_Mitchell at carleton.ca (Scott Mitchell)
Date: Fri, 8 Sep 2006 13:56:29 -0400
Subject: [R-sig-Geo] rgdal on Mac OS X 3.9
In-Reply-To: <Pine.LNX.4.44.0609080906300.8545-100000@reclus.nhh.no>
References: <Pine.LNX.4.44.0609080906300.8545-100000@reclus.nhh.no>
Message-ID: <EC56A8AA-F774-49EF-AFA9-DF3651DD8474@carleton.ca>


On 8-Sep-06, at 03:12, Roger Bivand wrote:

> On Thu, 7 Sep 2006, Jonathan Boyd Thayn wrote:
>
>> I am trying to install the rgdal package on my Mac OS X 3.9.  I have
>> installed the proj4 library and the GDAL library.  I get the  
>> following
>> error:  How do I know where the GDAL libraries are located?  What is
>> their path?  Thanks.
>
> Could an OSX user please reply with help on how to find GDAL?

Depends on how you installed GDAL.  There are Frameworks versions  
available, there's the fink package manager, and there's the option  
to compile from source yourself.  Probably more options are available  
too.  How did you do it, Jonathan?

If you compiled and installed yourself, it's probably in the default  
install location of /usr/local/bin/gdal-config, in which case you  
probably just need to add /usr/local/bin to your PATH in the shell  
you are using.  For example, at the shell prompt, before starting R,  
type
export PATH=$PATH:/usr/local/bin
to add that directory to the end of your path specification.
As long as the install can find the gdal-config program, that program  
should be able to tell the build system where to find the libraries  
and headers.

If you installed GDAL another way, you still need to figure out where  
it has been installed - if it is a framework install, it's probably  
in a subdirectory under /Library/Frameworks.  If you can provide more  
details of your install we can probably figure it out together.

> Could
> someone also comment on the viability of this OS version?

If I understand correctly, the binary downloads work only for OS  
10.4.4 and up, but it should be possible to compile R from source on  
10.3.9 -- again, that's IF I understand correctly.

>
> We have had user reports of success building rgdal from source on  
> OSX, but
> I don't think the specific OS version(s) used are known - could OSX  
> users
> please reply to this thread so that the list archives have a body of
> experience about this, please? The same applies to the way(s) in which
> GDAL and PROJ.4 were installed.

My answer to this got more complicated the more I delved into it.  So  
I've decided to document the full "transcript" here, in case it helps  
others (or points out mistakes in my interpretations):

The machine I happen to be using at the moment appears to have R2.3.0  
installed from the official Mac binary download site, with various  
geo-related libraries added afterwards, including rgdal 0.4-3.  I  
haven't done updates on this machine for quite a while, and don't  
know precisely what OS version was used when I did the installs, but  
it would have been 10.4.something.  It had GDAL 1.3.0 installed from  
source into /usr/local, PROJ 4.4.x also from source in /usr/local.   
That USED to work (so I've left the above text to document a  
different combination of versions that used to work), but now I have  
GDAL 1.3.1, and in my attempt to load the rgdal library I run into  
trouble because it can't find a symbol.  So I'm using this  
opportunity to update my R.

To try to correspond to the original poster's situation a little more  
closely, I'm compiling R from source instead of using the binaries.   
Note, however, that I AM using  OS 10.4.7 on a G5 machine with XCode  
2.2.1 developer tools.  The first FORTRAN compiler in my path is the  
GNU g77, version 3.4.3, provided by Fink (fink.sf.net).

./configure without any arguments provided the following summary:

R is now configured for powerpc-apple-darwin8.7.0

   Source directory:          .
   Installation directory:    /Library/Frameworks

   C compiler:                gcc  -g -O2 -std=gnu99
   Fortran 77 compiler:       gfortran  -g -O2

   C++ compiler:              g++  -g -O2
   Fortran 90/95 compiler:    gfortran -g -O2

   Interfaces supported:      X11, aqua, tcltk
   External libraries:        readline, BLAS(generic), LAPACK(in blas)
   Additional capabilities:   PNG, JPEG, iconv, MBCS, NLS
   Options enabled:           framework, R profiling

   Recommended packages:      yes

Running make after that worked fine, but then since it upgraded the  
existing R installation, my old extra packages are still in there.  I  
thought that I could make this work by reinstalling the packages that  
use GDAL, and I came close, but ran into a new problem.  If I  
interpret correctly, when I first built R, it was for PPC only.  Now  
R tries to build universal binaries that can work on either PPC or  
Intel chips, and I do have a build system that should handle this,  
BUT some of my R packages are still leftover from the first build,  
and I'm getting errors when it tries to build rgdal.

So, to fix that, I did:

sudo rm -rf /Library/Frameworks/R.framework
cd ~/src/R-2.3.1 (wherever your R source is, I had already done the  
"make" step)
sudo make install

Then, from an R session started by root (you could also use R CMD  
INSTALL):

install.packages(c("rgdal", "sp"), dependencies=TRUE, type="source")

and now the rgdal library successfully compiles and loads.

To put back some of the other packages I used to have installed, I  
then did:

install.packages("ctv")
library("ctv")
install.views("Spatial")

That mostly worked, but complained about a couple of dependencies not  
working, which is because some packages are only available as source  
packages for Macs.  The packages with errors were rgdal and VR.   
Since I've already installed rgdal, I ignore that one, but for VR:

install.packages("VR", dependencies=TRUE, type="source")

And all looks good.

Hopefully all that might help someone trying to do something similar  
in the future, even if it does diverge a bit from this initial post.


>
> Roger

Cheers,
Scott

>

----
Scott Mitchell, Assistant Professor, Carleton University
Department of Geography & Environmental Studies, Loeb B443A
& Geomatics and Landscape Ecology Research Laboratory, Nesbitt 340
Mailing:  Loeb B349, 1125 Colonel By Dr., Ottawa, ON K1S 5B6 Canada
+1-613-520-2600 x2695 Fax: +1-613-520-4301 Scott_Mitchell at carleton.ca



From smitch at connect.carleton.ca  Fri Sep  8 20:03:33 2006
From: smitch at connect.carleton.ca (Scott W Mitchell)
Date: Fri, 8 Sep 2006 14:03:33 -0400
Subject: [R-sig-Geo] followup on rgdal - invalid alignment error
Message-ID: <AEBB784E-7615-4D6C-A759-C2561E7A1057@connect.carleton.ca>

After sending my last post, detailing my system setup with a working  
R/GDAL/rgdal installation on a Mac, I played a bit more and came  
across a glitch when I tried example(readGDAL) on the fresh build.

It gets through translating the data set and the image command, but  
then on summary() I get:

rdGDAL> summary(x)

*** caught bus error ***
address 0x17, cause 'invalid alignment'

Traceback:
1: sort(x, partial = unique(c(lo, hi)))
2: quantile.default(object)
3: stats::quantile(object)
4: summary.default(X[[1]], ...)
5: FUN(X[[1]], ...)
6: lapply(as.list(object), summary, maxsum = maxsum, digits =  
12,     ...)
7: summary.data.frame(object at att)
8: summary(object at data)
9: summary(object at data)
10: summary(x)
11: summary(x)
12: eval.with.vis(expr, envir, enclos)
13: eval.with.vis(ei, envir)
14: source(zfile, local, echo = echo, prompt.echo = prompt.echo,      
verbose = verbose, max.deparse.length = 250, encoding = encoding)
15: example(readGDAL)

Possible actions:
1: abort (with core dump)
2: normal R exit
3: exit R without saving workspace
4: exit R saving workspace
Selection:

A byte-ordering issue???

Any suggestions?

Scott




----
Scott Mitchell, Assistant Professor, Carleton University
Department of Geography & Environmental Studies, Loeb B443A
& Geomatics and Landscape Ecology Research Laboratory, Nesbitt 340
Mailing:  Loeb B349, 1125 Colonel By Dr., Ottawa, ON K1S 5B6 Canada
+1-613-520-2600 x2695 Fax: +1-613-520-4301 Scott_Mitchell at carleton.ca



From Roger.Bivand at nhh.no  Fri Sep  8 20:23:04 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 8 Sep 2006 20:23:04 +0200 (CEST)
Subject: [R-sig-Geo] followup on rgdal - invalid alignment error
In-Reply-To: <AEBB784E-7615-4D6C-A759-C2561E7A1057@connect.carleton.ca>
Message-ID: <Pine.LNX.4.44.0609082015030.8545-100000@reclus.nhh.no>

On Fri, 8 Sep 2006, Scott W Mitchell wrote:

> After sending my last post, detailing my system setup with a working  
> R/GDAL/rgdal installation on a Mac, I played a bit more and came  
> across a glitch when I tried example(readGDAL) on the fresh build.

Scott:

Thanks very much for your detailed descriptions, and I hope updating to 
try to help the original questioner hasn't broken things you need now.

> 
> It gets through translating the data set and the image command, but  
> then on summary() I get:

Can you re-run the example code by hand, line by line (copy & paste for
example)? From what you write, image displays correctly, is that right?  
That suggests that the data has been read correctly, otherwise it would
not have displayed? Which image is this - several are read in the example?  
Does example(GDAL.open) run smoothly? Something in the first band of the
data is causing sort to choke, could it be an NA? can you copy out the 
band to a regular vector, and save it to file as an R object? If it is a 
value in the band, it should be saved in a platform independent way. GDAL 
also swaps to suit endianness.

Roger

> 
> rdGDAL> summary(x)
> 
> *** caught bus error ***
> address 0x17, cause 'invalid alignment'
> 
> Traceback:
> 1: sort(x, partial = unique(c(lo, hi)))
> 2: quantile.default(object)
> 3: stats::quantile(object)
> 4: summary.default(X[[1]], ...)
> 5: FUN(X[[1]], ...)
> 6: lapply(as.list(object), summary, maxsum = maxsum, digits =  
> 12,     ...)
> 7: summary.data.frame(object at att)
> 8: summary(object at data)
> 9: summary(object at data)
> 10: summary(x)
> 11: summary(x)
> 12: eval.with.vis(expr, envir, enclos)
> 13: eval.with.vis(ei, envir)
> 14: source(zfile, local, echo = echo, prompt.echo = prompt.echo,      
> verbose = verbose, max.deparse.length = 250, encoding = encoding)
> 15: example(readGDAL)
> 
> Possible actions:
> 1: abort (with core dump)
> 2: normal R exit
> 3: exit R without saving workspace
> 4: exit R saving workspace
> Selection:
> 
> A byte-ordering issue???
> 
> Any suggestions?
> 
> Scott
> 
> 
> 
> 
> ----
> Scott Mitchell, Assistant Professor, Carleton University
> Department of Geography & Environmental Studies, Loeb B443A
> & Geomatics and Landscape Ecology Research Laboratory, Nesbitt 340
> Mailing:  Loeb B349, 1125 Colonel By Dr., Ottawa, ON K1S 5B6 Canada
> +1-613-520-2600 x2695 Fax: +1-613-520-4301 Scott_Mitchell at carleton.ca
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From tkeitt at gmail.com  Fri Sep  8 21:09:01 2006
From: tkeitt at gmail.com (Tim Keitt)
Date: Fri, 8 Sep 2006 14:09:01 -0500
Subject: [R-sig-Geo] followup on rgdal - invalid alignment error
In-Reply-To: <Pine.LNX.4.44.0609082015030.8545-100000@reclus.nhh.no>
References: <AEBB784E-7615-4D6C-A759-C2561E7A1057@connect.carleton.ca>
	<Pine.LNX.4.44.0609082015030.8545-100000@reclus.nhh.no>
Message-ID: <6262c54c0609081209m355b1b4do34d108869c1b5c9a@mail.gmail.com>

One possibility is that the size of the GDAL data type is not the same
as the size of the R data type. This will definitely cause problems as
allocation is done by R and the pointer is cast to void when passed to
GDAL. My original C++ code simply assumes that both are 32-bit (or at
least equivalent size), but things will break if they are different.
(Roger -- you probably noticed the "fix me!" comments to myself in
there -- that was what I was talking about.)

GDAL data types include the size information (e.g., UInt32), but R
simply uses INTSXP and so on. Does anyone know how one determines for
any particular build of R the size of these R types? If I know the
size of INTSXP, then I can pick the corresponding GDAL data type.

THK

On 9/8/06, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> On Fri, 8 Sep 2006, Scott W Mitchell wrote:
>
> > After sending my last post, detailing my system setup with a working
> > R/GDAL/rgdal installation on a Mac, I played a bit more and came
> > across a glitch when I tried example(readGDAL) on the fresh build.
>
> Scott:
>
> Thanks very much for your detailed descriptions, and I hope updating to
> try to help the original questioner hasn't broken things you need now.
>
> >
> > It gets through translating the data set and the image command, but
> > then on summary() I get:
>
> Can you re-run the example code by hand, line by line (copy & paste for
> example)? From what you write, image displays correctly, is that right?
> That suggests that the data has been read correctly, otherwise it would
> not have displayed? Which image is this - several are read in the example?
> Does example(GDAL.open) run smoothly? Something in the first band of the
> data is causing sort to choke, could it be an NA? can you copy out the
> band to a regular vector, and save it to file as an R object? If it is a
> value in the band, it should be saved in a platform independent way. GDAL
> also swaps to suit endianness.
>
> Roger
>
> >
> > rdGDAL> summary(x)
> >
> > *** caught bus error ***
> > address 0x17, cause 'invalid alignment'
> >
> > Traceback:
> > 1: sort(x, partial = unique(c(lo, hi)))
> > 2: quantile.default(object)
> > 3: stats::quantile(object)
> > 4: summary.default(X[[1]], ...)
> > 5: FUN(X[[1]], ...)
> > 6: lapply(as.list(object), summary, maxsum = maxsum, digits =
> > 12,     ...)
> > 7: summary.data.frame(object at att)
> > 8: summary(object at data)
> > 9: summary(object at data)
> > 10: summary(x)
> > 11: summary(x)
> > 12: eval.with.vis(expr, envir, enclos)
> > 13: eval.with.vis(ei, envir)
> > 14: source(zfile, local, echo = echo, prompt.echo = prompt.echo,
> > verbose = verbose, max.deparse.length = 250, encoding = encoding)
> > 15: example(readGDAL)
> >
> > Possible actions:
> > 1: abort (with core dump)
> > 2: normal R exit
> > 3: exit R without saving workspace
> > 4: exit R saving workspace
> > Selection:
> >
> > A byte-ordering issue???
> >
> > Any suggestions?
> >
> > Scott
> >
> >
> >
> >
> > ----
> > Scott Mitchell, Assistant Professor, Carleton University
> > Department of Geography & Environmental Studies, Loeb B443A
> > & Geomatics and Landscape Ecology Research Laboratory, Nesbitt 340
> > Mailing:  Loeb B349, 1125 Colonel By Dr., Ottawa, ON K1S 5B6 Canada
> > +1-613-520-2600 x2695 Fax: +1-613-520-4301 Scott_Mitchell at carleton.ca
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
> --
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


-- 
Timothy H. Keitt
http://www.keittlab.org/



From mi2kelgrum at yahoo.com  Fri Sep  8 21:13:32 2006
From: mi2kelgrum at yahoo.com (Mikkel Grum)
Date: Fri, 8 Sep 2006 12:13:32 -0700 (PDT)
Subject: [R-sig-Geo] merging tables by columns AND row names
	(coordinates)
In-Reply-To: <Pine.LNX.4.44.0609080846560.8545-100000@reclus.nhh.no>
Message-ID: <20060908191332.79991.qmail@web60220.mail.yahoo.com>

merge(Table1, Table2, 
   by = intersect(c("XCOORD", "YCOORD"), 
   c("XCOORD", "YCOORD")), all = TRUE)

It might not handle the amount of data you have, but,
if your tables are normal dataframes, it would do the
job with a smaller dataset. It doesn't work with
Spatial*DataFrames (yet?).

Mikkel

--- Roger Bivand <Roger.Bivand at nhh.no> wrote:

> On Fri, 8 Sep 2006, Michael Sumner wrote:
> 
> > Hello, I can think of a couple of simple-minded
> approaches that would 
> > take some time - either relying on direct
> string-matching for the unique 
> > coordinates, or by some contrived overlay.
> > 
> > However, there's probably far better approaches -
> a couple of questions:
> > 
> > Can you predefine the set of all unique
> coordinates without reading all 
> > the tables from file? 
> >  - if so you might simplify the identification of
> each individual 
> > coordinate, for matching the records
> > 
> > Are the coordinates (intended to be) on a regular
> grid?  (This seems 
> > unlikely, although it is nearly true given your X
> coordinates).
> 
> The key question is what the data are. To me they
> look like a global 
> regular grid with some slippage in the print() - the
> underlying diff() of 
> the unique x's and y's is almost certainly regular.
> I'm not sure why they 
> are in text files either (model output?). But some
> bits of the grid may be 
> missing, the question being whether this is regular.
> If as an earlier 
> response indicated different data sets have
> different grid cells 
> missing, then we need the overall grid to start
> with, then grab the row 
> and column indices (and/or grid index), and attach
> these to the data rows. 
> 
> If the solution needs to be robust, and have a
> longer term utility, I 
> would go for using MySQL, Terralib, and aRT. The
> data representation is 
> that of the Terralib Cell object, so the question
> would be how to upload 
> to the database from the text files.
> 
> aRT is at:
> 
> http://www.est.ufpr.br/aRT/
> 
> By the way, 1M by 100 by 8 bytes is pushing 32-bit R
> - but handing off a 
> lot of the data storage to a database relieves this
> greatly.
> 
> Roger
> 
> > 
> > Cheers, Mike.
> > 
> > 
> > isidora k wrote:
> > > Hi everyone!
> > > I have 100 tables of the form:
> > > XCOORD,YCOORD,OBSERVATION
> > > 27.47500,42.52641,177
> > > 27.48788,42.52641,177
> > > 27.50075,42.52641,179
> > > 27.51362,42.52641,178
> > > 27.52650,42.52641,180
> > > 27.53937,42.52641,178
> > > 27.55225,42.52641,181
> > > 27.56512,42.52641,177
> > > 27.57800,42.52641,181
> > > 27.59087,42.52641,181
> > > 27.60375,42.52641,180
> > > 27.61662,42.52641,181
> > > ..., ..., ...
> > > with approximately 1000000 observations for
> each. All
> > > these tables have the same xcoord and ycoord and
> I
> > > would like to get a table of the form
> > > XCOORD,YCOORD,OBSERVATION1,OBSERVATION2,... 
> > > 27.47500,42.52641,177,233,...
> > > 27.48788,42.52641,177,345,...
> > > 27.50075,42.52641,179,233,...
> > > 27.51362,42.52641,178,123,...
> > > 27.52650,42.52641,180,178,...
> > > 27.53937,42.52641,178,...,...
> > > 27.55225,42.52641,181,...
> > > 27.56512,42.52641,177,...
> > > 27.57800,42.52641,181,...
> > > 27.59087,42.52641,181,...
> > > 27.60375,42.52641,180,...
> > > 27.61662,42.52641,181,...
> > > In other words I would like to merge all the
> tables
> > > taking into account the common row names of
> their
> > > xcoords AND ycoords.
> > > Not all tables have the same number of
> observations
> > > which means that not all pairs of x and y coords
> > > match.
> > > Is there a way to do this in R?
> > > I would be grateful for any advice.
> > > Many thanks
> > > Isidora
> > >
> > > _______________________________________________
> > > R-sig-Geo mailing list
> > > R-sig-Geo at stat.math.ethz.ch
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > >
> > >
> > >
> > 
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > 
> 
> -- 
> Roger Bivand
> Economic Geography Section, Department of Economics,
> Norwegian School of
> Economics and Business Administration, Helleveien
> 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



From Roger.Bivand at nhh.no  Fri Sep  8 21:27:42 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 8 Sep 2006 21:27:42 +0200 (CEST)
Subject: [R-sig-Geo] followup on rgdal - invalid alignment error
In-Reply-To: <6262c54c0609081209m355b1b4do34d108869c1b5c9a@mail.gmail.com>
Message-ID: <Pine.LNX.4.44.0609082118380.8545-100000@reclus.nhh.no>

On Fri, 8 Sep 2006, Tim Keitt wrote:

> One possibility is that the size of the GDAL data type is not the same
> as the size of the R data type. This will definitely cause problems as
> allocation is done by R and the pointer is cast to void when passed to
> GDAL. My original C++ code simply assumes that both are 32-bit (or at
> least equivalent size), but things will break if they are different.
> (Roger -- you probably noticed the "fix me!" comments to myself in
> there -- that was what I was talking about.)

(about line 750 in src/gdal-bindings.cpp)

Yes, but this is an example that is run very often on i386 at least, so 
I'm not sure why it should show up now on an other-endian platform? GDAL 
knows about endian-ness, doesn't it? Without access to the specific 
platform and build train, it would be difficult to debug? What else do we 
know about the platform? Is a G5 64-bit (ie. how big is an int)? What 
happens now is that sizeof(int) * ncells or sizeof(double) * ncells is 
made available for copying.

Note that there were changes in this code recently because 2.4.0 imposes 
stronger type checking, but I don't think that is it?

Roger

> 
> GDAL data types include the size information (e.g., UInt32), but R
> simply uses INTSXP and so on. Does anyone know how one determines for
> any particular build of R the size of these R types? If I know the
> size of INTSXP, then I can pick the corresponding GDAL data type.
> 
> THK
> 
> On 9/8/06, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> > On Fri, 8 Sep 2006, Scott W Mitchell wrote:
> >
> > > After sending my last post, detailing my system setup with a working
> > > R/GDAL/rgdal installation on a Mac, I played a bit more and came
> > > across a glitch when I tried example(readGDAL) on the fresh build.
> >
> > Scott:
> >
> > Thanks very much for your detailed descriptions, and I hope updating to
> > try to help the original questioner hasn't broken things you need now.
> >
> > >
> > > It gets through translating the data set and the image command, but
> > > then on summary() I get:
> >
> > Can you re-run the example code by hand, line by line (copy & paste for
> > example)? From what you write, image displays correctly, is that right?
> > That suggests that the data has been read correctly, otherwise it would
> > not have displayed? Which image is this - several are read in the example?
> > Does example(GDAL.open) run smoothly? Something in the first band of the
> > data is causing sort to choke, could it be an NA? can you copy out the
> > band to a regular vector, and save it to file as an R object? If it is a
> > value in the band, it should be saved in a platform independent way. GDAL
> > also swaps to suit endianness.
> >
> > Roger
> >
> > >
> > > rdGDAL> summary(x)
> > >
> > > *** caught bus error ***
> > > address 0x17, cause 'invalid alignment'
> > >
> > > Traceback:
> > > 1: sort(x, partial = unique(c(lo, hi)))
> > > 2: quantile.default(object)
> > > 3: stats::quantile(object)
> > > 4: summary.default(X[[1]], ...)
> > > 5: FUN(X[[1]], ...)
> > > 6: lapply(as.list(object), summary, maxsum = maxsum, digits =
> > > 12,     ...)
> > > 7: summary.data.frame(object at att)
> > > 8: summary(object at data)
> > > 9: summary(object at data)
> > > 10: summary(x)
> > > 11: summary(x)
> > > 12: eval.with.vis(expr, envir, enclos)
> > > 13: eval.with.vis(ei, envir)
> > > 14: source(zfile, local, echo = echo, prompt.echo = prompt.echo,
> > > verbose = verbose, max.deparse.length = 250, encoding = encoding)
> > > 15: example(readGDAL)
> > >
> > > Possible actions:
> > > 1: abort (with core dump)
> > > 2: normal R exit
> > > 3: exit R without saving workspace
> > > 4: exit R saving workspace
> > > Selection:
> > >
> > > A byte-ordering issue???
> > >
> > > Any suggestions?
> > >
> > > Scott
> > >
> > >
> > >
> > >
> > > ----
> > > Scott Mitchell, Assistant Professor, Carleton University
> > > Department of Geography & Environmental Studies, Loeb B443A
> > > & Geomatics and Landscape Ecology Research Laboratory, Nesbitt 340
> > > Mailing:  Loeb B349, 1125 Colonel By Dr., Ottawa, ON K1S 5B6 Canada
> > > +1-613-520-2600 x2695 Fax: +1-613-520-4301 Scott_Mitchell at carleton.ca
> > >
> > > _______________________________________________
> > > R-sig-Geo mailing list
> > > R-sig-Geo at stat.math.ethz.ch
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > >
> >
> > --
> > Roger Bivand
> > Economic Geography Section, Department of Economics, Norwegian School of
> > Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> > Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> > e-mail: Roger.Bivand at nhh.no
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> 
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From tkeitt at gmail.com  Fri Sep  8 21:39:49 2006
From: tkeitt at gmail.com (Tim Keitt)
Date: Fri, 8 Sep 2006 14:39:49 -0500
Subject: [R-sig-Geo] followup on rgdal - invalid alignment error
In-Reply-To: <Pine.LNX.4.44.0609082118380.8545-100000@reclus.nhh.no>
References: <6262c54c0609081209m355b1b4do34d108869c1b5c9a@mail.gmail.com>
	<Pine.LNX.4.44.0609082118380.8545-100000@reclus.nhh.no>
Message-ID: <6262c54c0609081239x687ac870ka10bd50c998ab5eb@mail.gmail.com>

On 9/8/06, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> On Fri, 8 Sep 2006, Tim Keitt wrote:
>
> > One possibility is that the size of the GDAL data type is not the same
> > as the size of the R data type. This will definitely cause problems as
> > allocation is done by R and the pointer is cast to void when passed to
> > GDAL. My original C++ code simply assumes that both are 32-bit (or at
> > least equivalent size), but things will break if they are different.
> > (Roger -- you probably noticed the "fix me!" comments to myself in
> > there -- that was what I was talking about.)
>
> (about line 750 in src/gdal-bindings.cpp)
>
> Yes, but this is an example that is run very often on i386 at least, so
> I'm not sure why it should show up now on an other-endian platform? GDAL
> knows about endian-ness, doesn't it? Without access to the specific
> platform and build train, it would be difficult to debug? What else do we
> know about the platform? Is a G5 64-bit (ie. how big is an int)? What
> happens now is that sizeof(int) * ncells or sizeof(double) * ncells is
> made available for copying.

If its 64 bit, this is likely the problem. GDAL's types are the same
size regardless of the platform, but my guess is that R's types change
size.

>
> Note that there were changes in this code recently because 2.4.0 imposes
> stronger type checking, but I don't think that is it?

Nope. Shouldn't be a problem.

THK

>
> Roger
>
> >
> > GDAL data types include the size information (e.g., UInt32), but R
> > simply uses INTSXP and so on. Does anyone know how one determines for
> > any particular build of R the size of these R types? If I know the
> > size of INTSXP, then I can pick the corresponding GDAL data type.
> >
> > THK
> >
> > On 9/8/06, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> > > On Fri, 8 Sep 2006, Scott W Mitchell wrote:
> > >
> > > > After sending my last post, detailing my system setup with a working
> > > > R/GDAL/rgdal installation on a Mac, I played a bit more and came
> > > > across a glitch when I tried example(readGDAL) on the fresh build.
> > >
> > > Scott:
> > >
> > > Thanks very much for your detailed descriptions, and I hope updating to
> > > try to help the original questioner hasn't broken things you need now.
> > >
> > > >
> > > > It gets through translating the data set and the image command, but
> > > > then on summary() I get:
> > >
> > > Can you re-run the example code by hand, line by line (copy & paste for
> > > example)? From what you write, image displays correctly, is that right?
> > > That suggests that the data has been read correctly, otherwise it would
> > > not have displayed? Which image is this - several are read in the example?
> > > Does example(GDAL.open) run smoothly? Something in the first band of the
> > > data is causing sort to choke, could it be an NA? can you copy out the
> > > band to a regular vector, and save it to file as an R object? If it is a
> > > value in the band, it should be saved in a platform independent way. GDAL
> > > also swaps to suit endianness.
> > >
> > > Roger
> > >
> > > >
> > > > rdGDAL> summary(x)
> > > >
> > > > *** caught bus error ***
> > > > address 0x17, cause 'invalid alignment'
> > > >
> > > > Traceback:
> > > > 1: sort(x, partial = unique(c(lo, hi)))
> > > > 2: quantile.default(object)
> > > > 3: stats::quantile(object)
> > > > 4: summary.default(X[[1]], ...)
> > > > 5: FUN(X[[1]], ...)
> > > > 6: lapply(as.list(object), summary, maxsum = maxsum, digits =
> > > > 12,     ...)
> > > > 7: summary.data.frame(object at att)
> > > > 8: summary(object at data)
> > > > 9: summary(object at data)
> > > > 10: summary(x)
> > > > 11: summary(x)
> > > > 12: eval.with.vis(expr, envir, enclos)
> > > > 13: eval.with.vis(ei, envir)
> > > > 14: source(zfile, local, echo = echo, prompt.echo = prompt.echo,
> > > > verbose = verbose, max.deparse.length = 250, encoding = encoding)
> > > > 15: example(readGDAL)
> > > >
> > > > Possible actions:
> > > > 1: abort (with core dump)
> > > > 2: normal R exit
> > > > 3: exit R without saving workspace
> > > > 4: exit R saving workspace
> > > > Selection:
> > > >
> > > > A byte-ordering issue???
> > > >
> > > > Any suggestions?
> > > >
> > > > Scott
> > > >
> > > >
> > > >
> > > >
> > > > ----
> > > > Scott Mitchell, Assistant Professor, Carleton University
> > > > Department of Geography & Environmental Studies, Loeb B443A
> > > > & Geomatics and Landscape Ecology Research Laboratory, Nesbitt 340
> > > > Mailing:  Loeb B349, 1125 Colonel By Dr., Ottawa, ON K1S 5B6 Canada
> > > > +1-613-520-2600 x2695 Fax: +1-613-520-4301 Scott_Mitchell at carleton.ca
> > > >
> > > > _______________________________________________
> > > > R-sig-Geo mailing list
> > > > R-sig-Geo at stat.math.ethz.ch
> > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > >
> > >
> > > --
> > > Roger Bivand
> > > Economic Geography Section, Department of Economics, Norwegian School of
> > > Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> > > Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> > > e-mail: Roger.Bivand at nhh.no
> > >
> > > _______________________________________________
> > > R-sig-Geo mailing list
> > > R-sig-Geo at stat.math.ethz.ch
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > >
> >
> >
> >
>
> --
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
>
>


-- 
Timothy H. Keitt
http://www.keittlab.org/



From massimodisasha at yahoo.it  Fri Sep  8 22:08:05 2006
From: massimodisasha at yahoo.it (massimodisasha)
Date: Fri, 8 Sep 2006 22:08:05 +0200
Subject: [R-sig-Geo] rgdal on Mac OS X 10.3.9
In-Reply-To: <mailman.13.1157709604.6524.r-sig-geo@stat.math.ethz.ch>
References: <mailman.13.1157709604.6524.r-sig-geo@stat.math.ethz.ch>
Message-ID: <DE5929D5-9804-43F9-8644-ACD750F25CE1@yahoo.it>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20060908/57fac113/attachment.pl>

From Scott_Mitchell at carleton.ca  Fri Sep  8 22:10:08 2006
From: Scott_Mitchell at carleton.ca (Scott Mitchell)
Date: Fri, 8 Sep 2006 16:10:08 -0400
Subject: [R-sig-Geo] followup on rgdal - invalid alignment error
In-Reply-To: <Pine.LNX.4.44.0609082015030.8545-100000@reclus.nhh.no>
References: <Pine.LNX.4.44.0609082015030.8545-100000@reclus.nhh.no>
Message-ID: <03244D8D-4503-4AA8-B393-D440F99B8C2A@carleton.ca>


On 8-Sep-06, at 14:23, Roger Bivand wrote:

> On Fri, 8 Sep 2006, Scott W Mitchell wrote:
>
>>
>> It gets through translating the data set and the image command, but
>> then on summary() I get:
>
> Can you re-run the example code by hand, line by line (copy & paste  
> for
> example)? From what you write, image displays correctly, is that  
> right?
> That suggests that the data has been read correctly, otherwise it  
> would
> not have displayed? Which image is this - several are read in the  
> example?

Yes, sorry, it does display the image, and then chokes on the summary 
(x) - this is in the FIRST part of the example - identical behaviour  
when run manually.

>
> Does example(GDAL.open) run smoothly?

No.

OK, before I got any further through your suggestions, I thought I  
should try eliminating the version of gcc used as a potential cause,  
as mentioned in my followup message to the original post.

I have just downloaded the R binary for OS 10.4.4+, which also comes  
with a version of gcc with the bug fixed, and then I reinstalled  
rgdal, sp, and VR from source, and sure enough, now I get through the  
examples fine.  So, it's solved.  At least now the warning against  
using recent Apple-supplied gcc for this will now be documented in  
this list, as it was in R-sig-mac.

The good news is that I don't imagine this will apply at all to  
Jonathan, running OS 10.3.9 and (I presume) older development tools  
(i.e. https://stat.ethz.ch/pipermail/r-sig-geo/2006-September/ 
001263.html ), since I'm almost certain that this bug in the Apple- 
supplied gcc did not exist prior to XCode-2.2.x.

That would make sense with my "alignment issue", since this version  
of the dev tools added support for universal binaries to handle the  
new architecture to the general public.  Hopefully they'll fix it  
soon.  In the meantime, the gcc supplied by the Mac team at CRAN does  
the trick.

Cheers,
Scott

> Something in the first band of the
> data is causing sort to choke, could it be an NA? can you copy out the
> band to a regular vector, and save it to file as an R object? If it  
> is a
> value in the band, it should be saved in a platform independent  
> way. GDAL
> also swaps to suit endianness.
>
> Roger
>
>>
>> rdGDAL> summary(x)
>>
>> *** caught bus error ***
>> address 0x17, cause 'invalid alignment'
>>
>> Traceback:
>> 1: sort(x, partial = unique(c(lo, hi)))
>> 2: quantile.default(object)
>> 3: stats::quantile(object)
>> 4: summary.default(X[[1]], ...)
>> 5: FUN(X[[1]], ...)
>> 6: lapply(as.list(object), summary, maxsum = maxsum, digits =
>> 12,     ...)
>> 7: summary.data.frame(object at att)
>> 8: summary(object at data)
>> 9: summary(object at data)
>> 10: summary(x)
>> 11: summary(x)
>> 12: eval.with.vis(expr, envir, enclos)
>> 13: eval.with.vis(ei, envir)
>> 14: source(zfile, local, echo = echo, prompt.echo = prompt.echo,
>> verbose = verbose, max.deparse.length = 250, encoding = encoding)
>> 15: example(readGDAL)
>>
>> Possible actions:
>> 1: abort (with core dump)
>> 2: normal R exit
>> 3: exit R without saving workspace
>> 4: exit R saving workspace
>> Selection:
>>
>> A byte-ordering issue???
>>
>> Any suggestions?
>>
>> Scott
>>



From Roger.Bivand at nhh.no  Fri Sep  8 23:16:55 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 8 Sep 2006 23:16:55 +0200 (CEST)
Subject: [R-sig-Geo] followup on rgdal - invalid alignment error
In-Reply-To: <6262c54c0609081239x687ac870ka10bd50c998ab5eb@mail.gmail.com>
Message-ID: <Pine.LNX.4.44.0609082314070.8545-100000@reclus.nhh.no>

On Fri, 8 Sep 2006, Tim Keitt wrote:

> On 9/8/06, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> > On Fri, 8 Sep 2006, Tim Keitt wrote:
> >
> > > One possibility is that the size of the GDAL data type is not the same
> > > as the size of the R data type. This will definitely cause problems as
> > > allocation is done by R and the pointer is cast to void when passed to
> > > GDAL. My original C++ code simply assumes that both are 32-bit (or at
> > > least equivalent size), but things will break if they are different.
> > > (Roger -- you probably noticed the "fix me!" comments to myself in
> > > there -- that was what I was talking about.)
> >
> > (about line 750 in src/gdal-bindings.cpp)
> >
> > Yes, but this is an example that is run very often on i386 at least, so
> > I'm not sure why it should show up now on an other-endian platform? GDAL
> > knows about endian-ness, doesn't it? Without access to the specific
> > platform and build train, it would be difficult to debug? What else do we
> > know about the platform? Is a G5 64-bit (ie. how big is an int)? What
> > happens now is that sizeof(int) * ncells or sizeof(double) * ncells is
> > made available for copying.
> 
> If its 64 bit, this is likely the problem. GDAL's types are the same
> size regardless of the platform, but my guess is that R's types change
> size.

Luckily this time the problem is resolved, but I agree that we'll need to 
work out what happens when R thinks that int is long. I don't have access 
to any 64-bit platforms to try this out, but from the lack of reports - 
and some people are running on 64-bit - maybe this just gets done 
correctly?

Roger

> 
> >
> > Note that there were changes in this code recently because 2.4.0 imposes
> > stronger type checking, but I don't think that is it?
> 
> Nope. Shouldn't be a problem.
> 
> THK
> 
> >
> > Roger
> >
> > >
> > > GDAL data types include the size information (e.g., UInt32), but R
> > > simply uses INTSXP and so on. Does anyone know how one determines for
> > > any particular build of R the size of these R types? If I know the
> > > size of INTSXP, then I can pick the corresponding GDAL data type.
> > >
> > > THK
> > >
> > > On 9/8/06, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> > > > On Fri, 8 Sep 2006, Scott W Mitchell wrote:
> > > >
> > > > > After sending my last post, detailing my system setup with a working
> > > > > R/GDAL/rgdal installation on a Mac, I played a bit more and came
> > > > > across a glitch when I tried example(readGDAL) on the fresh build.
> > > >
> > > > Scott:
> > > >
> > > > Thanks very much for your detailed descriptions, and I hope updating to
> > > > try to help the original questioner hasn't broken things you need now.
> > > >
> > > > >
> > > > > It gets through translating the data set and the image command, but
> > > > > then on summary() I get:
> > > >
> > > > Can you re-run the example code by hand, line by line (copy & paste for
> > > > example)? From what you write, image displays correctly, is that right?
> > > > That suggests that the data has been read correctly, otherwise it would
> > > > not have displayed? Which image is this - several are read in the example?
> > > > Does example(GDAL.open) run smoothly? Something in the first band of the
> > > > data is causing sort to choke, could it be an NA? can you copy out the
> > > > band to a regular vector, and save it to file as an R object? If it is a
> > > > value in the band, it should be saved in a platform independent way. GDAL
> > > > also swaps to suit endianness.
> > > >
> > > > Roger
> > > >
> > > > >
> > > > > rdGDAL> summary(x)
> > > > >
> > > > > *** caught bus error ***
> > > > > address 0x17, cause 'invalid alignment'
> > > > >
> > > > > Traceback:
> > > > > 1: sort(x, partial = unique(c(lo, hi)))
> > > > > 2: quantile.default(object)
> > > > > 3: stats::quantile(object)
> > > > > 4: summary.default(X[[1]], ...)
> > > > > 5: FUN(X[[1]], ...)
> > > > > 6: lapply(as.list(object), summary, maxsum = maxsum, digits =
> > > > > 12,     ...)
> > > > > 7: summary.data.frame(object at att)
> > > > > 8: summary(object at data)
> > > > > 9: summary(object at data)
> > > > > 10: summary(x)
> > > > > 11: summary(x)
> > > > > 12: eval.with.vis(expr, envir, enclos)
> > > > > 13: eval.with.vis(ei, envir)
> > > > > 14: source(zfile, local, echo = echo, prompt.echo = prompt.echo,
> > > > > verbose = verbose, max.deparse.length = 250, encoding = encoding)
> > > > > 15: example(readGDAL)
> > > > >
> > > > > Possible actions:
> > > > > 1: abort (with core dump)
> > > > > 2: normal R exit
> > > > > 3: exit R without saving workspace
> > > > > 4: exit R saving workspace
> > > > > Selection:
> > > > >
> > > > > A byte-ordering issue???
> > > > >
> > > > > Any suggestions?
> > > > >
> > > > > Scott
> > > > >
> > > > >
> > > > >
> > > > >
> > > > > ----
> > > > > Scott Mitchell, Assistant Professor, Carleton University
> > > > > Department of Geography & Environmental Studies, Loeb B443A
> > > > > & Geomatics and Landscape Ecology Research Laboratory, Nesbitt 340
> > > > > Mailing:  Loeb B349, 1125 Colonel By Dr., Ottawa, ON K1S 5B6 Canada
> > > > > +1-613-520-2600 x2695 Fax: +1-613-520-4301 Scott_Mitchell at carleton.ca
> > > > >
> > > > > _______________________________________________
> > > > > R-sig-Geo mailing list
> > > > > R-sig-Geo at stat.math.ethz.ch
> > > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > > >
> > > >
> > > > --
> > > > Roger Bivand
> > > > Economic Geography Section, Department of Economics, Norwegian School of
> > > > Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> > > > Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> > > > e-mail: Roger.Bivand at nhh.no
> > > >
> > > > _______________________________________________
> > > > R-sig-Geo mailing list
> > > > R-sig-Geo at stat.math.ethz.ch
> > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > >
> > >
> > >
> > >
> >
> > --
> > Roger Bivand
> > Economic Geography Section, Department of Economics, Norwegian School of
> > Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> > Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> > e-mail: Roger.Bivand at nhh.no
> >
> >
> >
> 
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Scott_Mitchell at carleton.ca  Sat Sep  9 02:58:29 2006
From: Scott_Mitchell at carleton.ca (Scott W Mitchell)
Date: Fri, 8 Sep 2006 20:58:29 -0400
Subject: [R-sig-Geo] followup on rgdal - invalid alignment error
In-Reply-To: <Pine.LNX.4.44.0609082118380.8545-100000@reclus.nhh.no>
References: <Pine.LNX.4.44.0609082118380.8545-100000@reclus.nhh.no>
Message-ID: <9CD9A411-5BFC-4664-A9B4-915AC595B274@carleton.ca>


On 8 Sep 2006, at 15:27, Roger Bivand wrote:

> On Fri, 8 Sep 2006, Tim Keitt wrote:
>
>> One possibility is that the size of the GDAL data type is not the  
>> same
>> as the size of the R data type. This will definitely cause  
>> problems as
>> allocation is done by R and the pointer is cast to void when  
>> passed to
>> GDAL. My original C++ code simply assumes that both are 32-bit (or at
>> least equivalent size), but things will break if they are different.
>> (Roger -- you probably noticed the "fix me!" comments to myself in
>> there -- that was what I was talking about.)
>
> (about line 750 in src/gdal-bindings.cpp)
>
> Yes, but this is an example that is run very often on i386 at  
> least, so
> I'm not sure why it should show up now on an other-endian platform?  
> GDAL
> knows about endian-ness, doesn't it? Without access to the specific
> platform and build train, it would be difficult to debug?

I can certainly provide access to a test system and/or follow  
instructions for testing if that would help.  If you'll be in  
Lausanne next week, we could discuss this more there.

> What else do we
> know about the platform? Is a G5 64-bit (ie. how big is an int)?

Yes, G5 is 64 bit, but if I understand correctly, one needs to  
"request" this capability when compiling.  I see that sizeof(int)  
returns a value of 4 if I run it on a G5 or a G4 (which is not 64  
bit)...

Actually, looking a little deeper and reading the gcc man page, if I  
just compile with defaults, int is 4 and long is 4, but if I use -m64  
when compiling, int is still 4 but long is 8.

The powerpc build uses the same flags as the i386 for 32/64 (from man  
gcc):

        -m32
        -m64
            Generate code for 32-bit or 64-bit environments of Darwin  
and SVR4
            targets (including GNU/Linux).  The 32-bit environment  
sets int,
            long and pointer to 32 bits and generates code that runs  
on any
            PowerPC variant.  The 64-bit environment sets int to 32  
bits and
            long and pointer to 64 bits, and generates code for  
PowerPC64, as
            for -mpowerpc64.

Hope that helps,
Scott



------
Scott W. Mitchell	Scott_Mitchell at carleton.ca
Geomatics and Landscape Ecology Research Laboratory
Department of Geography and Environmental Studies
Carleton University, B349 Loeb Building
Ottawa, ON Canada K1S 5B6
+1-613-520-2600 ext 2695



From Roger.Bivand at nhh.no  Sat Sep  9 10:28:34 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 9 Sep 2006 10:28:34 +0200 (CEST)
Subject: [R-sig-Geo] followup on rgdal - invalid alignment error
In-Reply-To: <9CD9A411-5BFC-4664-A9B4-915AC595B274@carleton.ca>
Message-ID: <Pine.LNX.4.44.0609091011270.9698-100000@reclus.nhh.no>

On Fri, 8 Sep 2006, Scott W Mitchell wrote:
> 
> On 8 Sep 2006, at 15:27, Roger Bivand wrote:
> 
> > On Fri, 8 Sep 2006, Tim Keitt wrote:
> >
> >> One possibility is that the size of the GDAL data type is not the  
> >> same
> >> as the size of the R data type. This will definitely cause  
> >> problems as
> >> allocation is done by R and the pointer is cast to void when  
> >> passed to
> >> GDAL. My original C++ code simply assumes that both are 32-bit (or at
> >> least equivalent size), but things will break if they are different.
> >> (Roger -- you probably noticed the "fix me!" comments to myself in
> >> there -- that was what I was talking about.)
> >
> > (about line 750 in src/gdal-bindings.cpp)
> >
> > Yes, but this is an example that is run very often on i386 at  
> > least, so
> > I'm not sure why it should show up now on an other-endian platform?  
> > GDAL
> > knows about endian-ness, doesn't it? Without access to the specific
> > platform and build train, it would be difficult to debug?
> 
> I can certainly provide access to a test system and/or follow  
> instructions for testing if that would help.  If you'll be in  
> Lausanne next week, we could discuss this more there.

Yes, I'll be in Lausanne, which for those not aware of it, is a meeting 
between and about software projects in "Free And Open Source Software for 
Geoinformatics", http://www.foss4g2006.org/, all next week. The R/GRASS 
interface is being presented in a workshop, together with rgdal and 
friends, on Tuesday afternoon, 12 September.

> 
> > What else do we
> > know about the platform? Is a G5 64-bit (ie. how big is an int)?
> 
> Yes, G5 is 64 bit, but if I understand correctly, one needs to  
> "request" this capability when compiling.  I see that sizeof(int)  
> returns a value of 4 if I run it on a G5 or a G4 (which is not 64  
> bit)...
> 
> Actually, looking a little deeper and reading the gcc man page, if I  
> just compile with defaults, int is 4 and long is 4, but if I use -m64  
> when compiling, int is still 4 but long is 8.

This seems to happen in config.h when R is built, and the details are I 
think in the constants returned by .Machine. We can follow this up in 
Lausanne.

Roger

> 
> The powerpc build uses the same flags as the i386 for 32/64 (from man  
> gcc):
> 
>         -m32
>         -m64
>             Generate code for 32-bit or 64-bit environments of Darwin  
> and SVR4
>             targets (including GNU/Linux).  The 32-bit environment  
> sets int,
>             long and pointer to 32 bits and generates code that runs  
> on any
>             PowerPC variant.  The 64-bit environment sets int to 32  
> bits and
>             long and pointer to 64 bits, and generates code for  
> PowerPC64, as
>             for -mpowerpc64.
> 
> Hope that helps,
> Scott
> 
> 
> 
> ------
> Scott W. Mitchell	Scott_Mitchell at carleton.ca
> Geomatics and Landscape Ecology Research Laboratory
> Department of Geography and Environmental Studies
> Carleton University, B349 Loeb Building
> Ottawa, ON Canada K1S 5B6
> +1-613-520-2600 ext 2695
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Roger.Bivand at nhh.no  Sat Sep  9 15:34:30 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 9 Sep 2006 15:34:30 +0200 (CEST)
Subject: [R-sig-Geo] merging tables by columns AND row names
	(coordinates)
In-Reply-To: <20060908191332.79991.qmail@web60220.mail.yahoo.com>
Message-ID: <Pine.LNX.4.44.0609091531380.9698-100000@reclus.nhh.no>

On Fri, 8 Sep 2006, Mikkel Grum wrote:

> merge(Table1, Table2, 
>    by = intersect(c("XCOORD", "YCOORD"), 
>    c("XCOORD", "YCOORD")), all = TRUE)
> 
> It might not handle the amount of data you have, but,
> if your tables are normal dataframes, it would do the
> job with a smaller dataset. It doesn't work with
> Spatial*DataFrames (yet?).

I would be wary of this with coords as floating point, because they ought
to be snapped together. I believe that the original data were from a
regular grid with missing cells. If that is the case, and the coordinates
can be mapped to integer row and column IDs, then certainly your route
will work. You are right that there is as yet no cbind/rbind/merge 
facility for Spatial*DataFrames.

Roger

> 
> Mikkel
> 
> --- Roger Bivand <Roger.Bivand at nhh.no> wrote:
> 
> > On Fri, 8 Sep 2006, Michael Sumner wrote:
> > 
> > > Hello, I can think of a couple of simple-minded
> > approaches that would 
> > > take some time - either relying on direct
> > string-matching for the unique 
> > > coordinates, or by some contrived overlay.
> > > 
> > > However, there's probably far better approaches -
> > a couple of questions:
> > > 
> > > Can you predefine the set of all unique
> > coordinates without reading all 
> > > the tables from file? 
> > >  - if so you might simplify the identification of
> > each individual 
> > > coordinate, for matching the records
> > > 
> > > Are the coordinates (intended to be) on a regular
> > grid?  (This seems 
> > > unlikely, although it is nearly true given your X
> > coordinates).
> > 
> > The key question is what the data are. To me they
> > look like a global 
> > regular grid with some slippage in the print() - the
> > underlying diff() of 
> > the unique x's and y's is almost certainly regular.
> > I'm not sure why they 
> > are in text files either (model output?). But some
> > bits of the grid may be 
> > missing, the question being whether this is regular.
> > If as an earlier 
> > response indicated different data sets have
> > different grid cells 
> > missing, then we need the overall grid to start
> > with, then grab the row 
> > and column indices (and/or grid index), and attach
> > these to the data rows. 
> > 
> > If the solution needs to be robust, and have a
> > longer term utility, I 
> > would go for using MySQL, Terralib, and aRT. The
> > data representation is 
> > that of the Terralib Cell object, so the question
> > would be how to upload 
> > to the database from the text files.
> > 
> > aRT is at:
> > 
> > http://www.est.ufpr.br/aRT/
> > 
> > By the way, 1M by 100 by 8 bytes is pushing 32-bit R
> > - but handing off a 
> > lot of the data storage to a database relieves this
> > greatly.
> > 
> > Roger
> > 
> > > 
> > > Cheers, Mike.
> > > 
> > > 
> > > isidora k wrote:
> > > > Hi everyone!
> > > > I have 100 tables of the form:
> > > > XCOORD,YCOORD,OBSERVATION
> > > > 27.47500,42.52641,177
> > > > 27.48788,42.52641,177
> > > > 27.50075,42.52641,179
> > > > 27.51362,42.52641,178
> > > > 27.52650,42.52641,180
> > > > 27.53937,42.52641,178
> > > > 27.55225,42.52641,181
> > > > 27.56512,42.52641,177
> > > > 27.57800,42.52641,181
> > > > 27.59087,42.52641,181
> > > > 27.60375,42.52641,180
> > > > 27.61662,42.52641,181
> > > > ..., ..., ...
> > > > with approximately 1000000 observations for
> > each. All
> > > > these tables have the same xcoord and ycoord and
> > I
> > > > would like to get a table of the form
> > > > XCOORD,YCOORD,OBSERVATION1,OBSERVATION2,... 
> > > > 27.47500,42.52641,177,233,...
> > > > 27.48788,42.52641,177,345,...
> > > > 27.50075,42.52641,179,233,...
> > > > 27.51362,42.52641,178,123,...
> > > > 27.52650,42.52641,180,178,...
> > > > 27.53937,42.52641,178,...,...
> > > > 27.55225,42.52641,181,...
> > > > 27.56512,42.52641,177,...
> > > > 27.57800,42.52641,181,...
> > > > 27.59087,42.52641,181,...
> > > > 27.60375,42.52641,180,...
> > > > 27.61662,42.52641,181,...
> > > > In other words I would like to merge all the
> > tables
> > > > taking into account the common row names of
> > their
> > > > xcoords AND ycoords.
> > > > Not all tables have the same number of
> > observations
> > > > which means that not all pairs of x and y coords
> > > > match.
> > > > Is there a way to do this in R?
> > > > I would be grateful for any advice.
> > > > Many thanks
> > > > Isidora
> > > >
> > > > _______________________________________________
> > > > R-sig-Geo mailing list
> > > > R-sig-Geo at stat.math.ethz.ch
> > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > >
> > > >
> > > >
> > > 
> > > _______________________________________________
> > > R-sig-Geo mailing list
> > > R-sig-Geo at stat.math.ethz.ch
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > 
> > 
> > -- 
> > Roger Bivand
> > Economic Geography Section, Department of Economics,
> > Norwegian School of
> > Economics and Business Administration, Helleveien
> > 30, N-5045 Bergen,
> > Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> > e-mail: Roger.Bivand at nhh.no
> > 
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > 
> 
> 
> __________________________________________________
> Do You Yahoo!?
> Tired of spam?  Yahoo! Mail has the best spam protection around 
> http://mail.yahoo.com 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From tkeitt at gmail.com  Sat Sep  9 17:12:21 2006
From: tkeitt at gmail.com (Tim Keitt)
Date: Sat, 9 Sep 2006 10:12:21 -0500
Subject: [R-sig-Geo] followup on rgdal - invalid alignment error
In-Reply-To: <Pine.LNX.4.44.0609091011270.9698-100000@reclus.nhh.no>
References: <9CD9A411-5BFC-4664-A9B4-915AC595B274@carleton.ca>
	<Pine.LNX.4.44.0609091011270.9698-100000@reclus.nhh.no>
Message-ID: <6262c54c0609090812iba3d58ajf51c4e28344587dc@mail.gmail.com>

I found the type size defs in Rinternals.h. They are
R_XDR_INTEGER_SIZE and R_XDR_DOUBLE_SIZE. I've added a check in rgdal
to ensure that type sizes match up.

THK

-- 
Timothy H. Keitt
http://www.keittlab.org/



From mi2kelgrum at yahoo.com  Sat Sep  9 20:17:25 2006
From: mi2kelgrum at yahoo.com (Mikkel Grum)
Date: Sat, 9 Sep 2006 11:17:25 -0700 (PDT)
Subject: [R-sig-Geo] merging tables by columns AND row names
	(coordinates)
In-Reply-To: <Pine.LNX.4.44.0609091531380.9698-100000@reclus.nhh.no>
Message-ID: <20060909181725.85844.qmail@web60214.mail.yahoo.com>

Thanks Roger, I've been using this to bind rows
together, where I don't necessarily have the exact
same columns in each table. It seems to work fine for
that, so I hadn't noticed that it didn't actually
merge floating points. However, it looks like merging
will work, if you can afford to round off the
coordinates and convert them to a character variable:

Table1$XCOORD <- as.charater(round(Table1$XCOORD, 12))

The number of digits you need to round to will depend
on your data set and you might have trouble spotting
errors in a large data set. If the points belong to a
regular grid and you can attach the row and column
indices, that would be more robust.

Mikkel

--- Roger Bivand <Roger.Bivand at nhh.no> wrote:

> On Fri, 8 Sep 2006, Mikkel Grum wrote:
> 
> > merge(Table1, Table2, 
> >    by = intersect(c("XCOORD", "YCOORD"), 
> >    c("XCOORD", "YCOORD")), all = TRUE)
> > 
> > It might not handle the amount of data you have,
> but,
> > if your tables are normal dataframes, it would do
> the
> > job with a smaller dataset. It doesn't work with
> > Spatial*DataFrames (yet?).
> 
> I would be wary of this with coords as floating
> point, because they ought
> to be snapped together. I believe that the original
> data were from a
> regular grid with missing cells. If that is the
> case, and the coordinates
> can be mapped to integer row and column IDs, then
> certainly your route
> will work. You are right that there is as yet no
> cbind/rbind/merge 
> facility for Spatial*DataFrames.
> 
> Roger
> 
> > 
> > Mikkel
> > 
> > --- Roger Bivand <Roger.Bivand at nhh.no> wrote:
> > 
> > > On Fri, 8 Sep 2006, Michael Sumner wrote:
> > > 
> > > > Hello, I can think of a couple of
> simple-minded
> > > approaches that would 
> > > > take some time - either relying on direct
> > > string-matching for the unique 
> > > > coordinates, or by some contrived overlay.
> > > > 
> > > > However, there's probably far better
> approaches -
> > > a couple of questions:
> > > > 
> > > > Can you predefine the set of all unique
> > > coordinates without reading all 
> > > > the tables from file? 
> > > >  - if so you might simplify the identification
> of
> > > each individual 
> > > > coordinate, for matching the records
> > > > 
> > > > Are the coordinates (intended to be) on a
> regular
> > > grid?  (This seems 
> > > > unlikely, although it is nearly true given
> your X
> > > coordinates).
> > > 
> > > The key question is what the data are. To me
> they
> > > look like a global 
> > > regular grid with some slippage in the print() -
> the
> > > underlying diff() of 
> > > the unique x's and y's is almost certainly
> regular.
> > > I'm not sure why they 
> > > are in text files either (model output?). But
> some
> > > bits of the grid may be 
> > > missing, the question being whether this is
> regular.
> > > If as an earlier 
> > > response indicated different data sets have
> > > different grid cells 
> > > missing, then we need the overall grid to start
> > > with, then grab the row 
> > > and column indices (and/or grid index), and
> attach
> > > these to the data rows. 
> > > 
> > > If the solution needs to be robust, and have a
> > > longer term utility, I 
> > > would go for using MySQL, Terralib, and aRT. The
> > > data representation is 
> > > that of the Terralib Cell object, so the
> question
> > > would be how to upload 
> > > to the database from the text files.
> > > 
> > > aRT is at:
> > > 
> > > http://www.est.ufpr.br/aRT/
> > > 
> > > By the way, 1M by 100 by 8 bytes is pushing
> 32-bit R
> > > - but handing off a 
> > > lot of the data storage to a database relieves
> this
> > > greatly.
> > > 
> > > Roger
> > > 
> > > > 
> > > > Cheers, Mike.
> > > > 
> > > > 
> > > > isidora k wrote:
> > > > > Hi everyone!
> > > > > I have 100 tables of the form:
> > > > > XCOORD,YCOORD,OBSERVATION
> > > > > 27.47500,42.52641,177
> > > > > 27.48788,42.52641,177
> > > > > 27.50075,42.52641,179
> > > > > 27.51362,42.52641,178
> > > > > 27.52650,42.52641,180
> > > > > 27.53937,42.52641,178
> > > > > 27.55225,42.52641,181
> > > > > 27.56512,42.52641,177
> > > > > 27.57800,42.52641,181
> > > > > 27.59087,42.52641,181
> > > > > 27.60375,42.52641,180
> > > > > 27.61662,42.52641,181
> > > > > ..., ..., ...
> > > > > with approximately 1000000 observations for
> > > each. All
> > > > > these tables have the same xcoord and ycoord
> and
> > > I
> > > > > would like to get a table of the form
> > > > > XCOORD,YCOORD,OBSERVATION1,OBSERVATION2,... 
> > > > > 27.47500,42.52641,177,233,...
> > > > > 27.48788,42.52641,177,345,...
> > > > > 27.50075,42.52641,179,233,...
> > > > > 27.51362,42.52641,178,123,...
> > > > > 27.52650,42.52641,180,178,...
> > > > > 27.53937,42.52641,178,...,...
> > > > > 27.55225,42.52641,181,...
> > > > > 27.56512,42.52641,177,...
> > > > > 27.57800,42.52641,181,...
> > > > > 27.59087,42.52641,181,...
> > > > > 27.60375,42.52641,180,...
> > > > > 27.61662,42.52641,181,...
> > > > > In other words I would like to merge all the
> > > tables
> > > > > taking into account the common row names of
> > > their
> > > > > xcoords AND ycoords.
> > > > > Not all tables have the same number of
> > > observations
> > > > > which means that not all pairs of x and y
> coords
> > > > > match.
> > > > > Is there a way to do this in R?
> > > > > I would be grateful for any advice.
> > > > > Many thanks
> > > > > Isidora
> > > > >
> > > > >
> _______________________________________________
> > > > > R-sig-Geo mailing list
> > > > > R-sig-Geo at stat.math.ethz.ch
> > > > >
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > > >
> > > > >
> > > > >
> > > > 
> > > >
> _______________________________________________
> > > > R-sig-Geo mailing list
> > > > R-sig-Geo at stat.math.ethz.ch
> > > >
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > > 
> > > 
> > > -- 
> > > Roger Bivand
> > > Economic Geography Section, Department of
> Economics,
> > > Norwegian School of
> > > Economics and Business Administration,
> Helleveien
> > > 30, N-5045 Bergen,
> > > Norway. voice: +47 55 95 93 55; fax +47 55 95 95
> 43
> > > e-mail: Roger.Bivand at nhh.no
> > > 
> > > _______________________________________________
> > > R-sig-Geo mailing list
> > > R-sig-Geo at stat.math.ethz.ch
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > 
> > 
> > 
> > __________________________________________________
> > Do You Yahoo!?

> protection around 
> 
=== message truncated ===



From jgreenberg at arc.nasa.gov  Sun Sep 10 00:22:43 2006
From: jgreenberg at arc.nasa.gov (Jonathan Greenberg)
Date: Sat, 09 Sep 2006 15:22:43 -0700
Subject: [R-sig-Geo] GRASS and R question
Message-ID: <C1288CC3.BFAF%jgreenberg@arc.nasa.gov>

I was wondering if I could get some brief feedback on exactly what are the
capabilities of the sp and spgrass6 -- say I'd like to use R to calculate
and NDVI image (I know GRASS's mapcalc can do this fine, but I'm thinking of
some more complicated analyses that aren't easily performed in R and I
figured if I can figure out NDVI I can figure out the rest of them) -- Does
sp, spgrass6 and R itself provide both the data ingestion capabilities as
well as the necessary subsetting capabilities if my file is very large (e.g.
Can R do a per-pixel or per-line read/process/write routine, or will it
attempt to load an entire raster into memory)?

If R can deal with import of a multiband image and tiled processing, can
someone here perhaps post an example of how to accomplish the above task
(taking a 4 band large file, calculating NDVI and then writing out the NDVI
to disk) using R?  Thanks!

--j


-- 
Jonathan A. Greenberg, PhD
NRC Research Associate
NASA Ames Research Center
MS 242-4
Moffett Field, CA 94035-1000
Office: 650-604-5896
Cell: 415-794-5043
AIM: jgrn307
MSN: jgrn307 at hotmail.com



From tkeitt at gmail.com  Sun Sep 10 02:00:54 2006
From: tkeitt at gmail.com (Tim Keitt)
Date: Sat, 9 Sep 2006 19:00:54 -0500
Subject: [R-sig-Geo] GRASS and R question
In-Reply-To: <C1288CC3.BFAF%jgreenberg@arc.nasa.gov>
References: <C1288CC3.BFAF%jgreenberg@arc.nasa.gov>
Message-ID: <6262c54c0609091700r7baad635u948ca27605a285fe@mail.gmail.com>

Jonathan,

This is what rgdal was designed to do. Here's an example,

ds1 <- GDAL.open("input.tif")
driver <- new('GDALDriver', 'GTiff')
ds2 <- new('GDALTransientDataset', driver, nrow(ds1), ncol(ds1), type
= "Float64")
for (row in nrow(ds1)) {

  x <- getRasterData(ds1, offset = c(row - 1, 0), region = c(1, ncol(ds1)))
  ndvi <- (x[,2] - x[,1]) / (x[,2] + x[,1])
  putRasterData(ds2, ndvi, offset = c(row - 1, 0))

}
saveDataset(ds2, "result.tif")

This scales to absurd image sizes as only a single scanline is loaded
into memory. (Note: I didn't try this code, but it should be about
right.)

I'm in the process of adding an 'apply' function to rgdal, so pretty
soon you'll be able to do:

ds2 <- blockApply(ds1, function(x) (x[,2]-x[,1]) / (x[,2]+x[,1]))

The apply function will automatically use the optimal block size
supplied by GDAL and so should be really fast on tiled images.

For smaller images, it may be easier to use 'sp' classes. My approach
is to use the rgdal classes for big images and then convert reduced
resolution versions to 'sp' for display.

THK

On 9/9/06, Jonathan Greenberg <jgreenberg at arc.nasa.gov> wrote:
> I was wondering if I could get some brief feedback on exactly what are the
> capabilities of the sp and spgrass6 -- say I'd like to use R to calculate
> and NDVI image (I know GRASS's mapcalc can do this fine, but I'm thinking of
> some more complicated analyses that aren't easily performed in R and I
> figured if I can figure out NDVI I can figure out the rest of them) -- Does
> sp, spgrass6 and R itself provide both the data ingestion capabilities as
> well as the necessary subsetting capabilities if my file is very large (e.g.
> Can R do a per-pixel or per-line read/process/write routine, or will it
> attempt to load an entire raster into memory)?
>
> If R can deal with import of a multiband image and tiled processing, can
> someone here perhaps post an example of how to accomplish the above task
> (taking a 4 band large file, calculating NDVI and then writing out the NDVI
> to disk) using R?  Thanks!
>
> --j
>
>
> --
> Jonathan A. Greenberg, PhD
> NRC Research Associate
> NASA Ames Research Center
> MS 242-4
> Moffett Field, CA 94035-1000
> Office: 650-604-5896
> Cell: 415-794-5043
> AIM: jgrn307
> MSN: jgrn307 at hotmail.com
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


-- 
Timothy H. Keitt
http://www.keittlab.org/



From jgreenberg at arc.nasa.gov  Sun Sep 10 02:34:35 2006
From: jgreenberg at arc.nasa.gov (Jonathan Greenberg)
Date: Sat, 09 Sep 2006 17:34:35 -0700
Subject: [R-sig-Geo] [R-SIG-Mac] Problems installing rgdal from source
Message-ID: <C128ABAB.BFC0%jgreenberg@arc.nasa.gov>

I am going through some similar problems getting rgdal running on macos x:

sudo ./usr/local/bin/R64 CMD INSTALL
--configure-args='--with-proj-include=/usr/local/include
--with-proj-lib=/usr/local/lib' rgdal

...
checking proj_api.h usability... yes
checking proj_api.h presence... yes
checking for proj_api.h... yes
checking for pj_init_plus in -lproj... no
libproj.a and/or proj_api.h not found.
If the PROJ.4 library is installed in a non-standard location,
use --configure-args='--with-proj-include=/opt/local/include
--with-proj-lib=/opt/local/lib' for example, replacing /opt/local/*
with appropriate values for your installation.
If PROJ.4 is not installed, install it.
ERROR: configuration failed for package 'rgdal'
** Removing '/usr/local/lib64/R/library/rgdal'
** Restoring previous '/usr/local/lib64/R/library/rgdal'

Response from ls /usr/local/lib/libproj*:

/usr/local/lib/libproj.0.5.0.dylib      /usr/local/lib/libproj.dylib
/usr/local/lib/libproj.0.dylib          /usr/local/lib/libproj.la
/usr/local/lib/libproj.a

***

I did a standard ./configure, make, sudo make install for proj-4.4.9 (after
going through the same fink issue as the previous poster).  Any suggestions?
You'll note the only real difference (I can't imagine why this would matter)
is that I'm running the 64 bit version of R found at
http://r.research.att.com/

--j


-- 
Jonathan A. Greenberg, PhD
NRC Research Associate
NASA Ames Research Center
MS 242-4
Moffett Field, CA 94035-1000
Office: 650-604-5896
Cell: 415-794-5043
AIM: jgrn307
MSN: jgrn307 at hotmail.com



From jgreenberg at arc.nasa.gov  Sun Sep 10 06:40:04 2006
From: jgreenberg at arc.nasa.gov (Jonathan Greenberg)
Date: Sat, 09 Sep 2006 21:40:04 -0700
Subject: [R-sig-Geo] Failure to install spgrass6
Message-ID: <C128E534.BFD7%jgreenberg@arc.nasa.gov>

I'm getting this error while trying to install spgrass6 on a dual G5/2ghz w
4gb ram, and macos x 10.4.7:

> rS <- "http://r-spatial.sourceforge.net/R"
> install.packages("spgrass6", repos=rS, dependencies=TRUE)

 *** caught segfault ***
address 0x5f4d4550, cause 'memory not mapped'

Traceback:
 1: download.file(url = paste(repos, "PACKAGES.gz", sep = "/"), destfile =
tmpf,     method = method, cacheOK = FALSE, quiet = TRUE, mode = "wb")
 2: try(download.file(url = paste(repos, "PACKAGES.gz", sep = "/"),
destfile = tmpf, method = method, cacheOK = FALSE, quiet = TRUE,     mode =
"wb"), silent = TRUE)
 3: available.packages(contriburl = contriburl, method = method)
 4: .install.macbinary(pkgs = pkgs, lib = lib, contriburl = contriburl,
method = method, available = available, destdir = destdir,
installWithVers = installWithVers, dependencies = dependencies)
 5: install.packages("spgrass6", repos = rS, dependencies = TRUE)

Possible actions:
1: abort (with core dump)
2: normal R exit
3: exit R without saving workspace
4: exit R saving workspace
Selection: 

***

The dependencies have installed correctly, as far as I know.  Any thoughts?
Is this an issue with the fact that the machine is 64 bit?  I tried
installing this with the 64 bit version of R and couldn't get rgdal
installed...

--j

-- 
Jonathan A. Greenberg, PhD
NRC Research Associate
NASA Ames Research Center
MS 242-4
Moffett Field, CA 94035-1000
Office: 650-604-5896
Cell: 415-794-5043
AIM: jgrn307
MSN: jgrn307 at hotmail.com



From smitch at connect.carleton.ca  Sun Sep 10 15:53:39 2006
From: smitch at connect.carleton.ca (Scott W Mitchell)
Date: Sun, 10 Sep 2006 09:53:39 -0400
Subject: [R-sig-Geo] Failure to install spgrass6
In-Reply-To: <C128E534.BFD7%jgreenberg@arc.nasa.gov>
References: <C128E534.BFD7%jgreenberg@arc.nasa.gov>
Message-ID: <808F3231-1704-44EC-822B-F14CBAFB4C0E@connect.carleton.ca>

Did you try adding type="source" to the install.packages command?  I  
don't know why not having it would lead to a segfault, but I still  
would have thought you'd need it to avoid it trying to find a binary  
package for the Mac (at least, that's my experience on my G5).

On 10 Sep 2006, at 0:40, Jonathan Greenberg wrote:

> I'm getting this error while trying to install spgrass6 on a dual  
> G5/2ghz w
> 4gb ram, and macos x 10.4.7:
>
>> rS <- "http://r-spatial.sourceforge.net/R"
>> install.packages("spgrass6", repos=rS, dependencies=TRUE)
>
>  *** caught segfault ***
> address 0x5f4d4550, cause 'memory not mapped'
>
> Traceback:
>  1: download.file(url = paste(repos, "PACKAGES.gz", sep = "/"),  
> destfile =
> tmpf,     method = method, cacheOK = FALSE, quiet = TRUE, mode = "wb")
>  2: try(download.file(url = paste(repos, "PACKAGES.gz", sep = "/"),
> destfile = tmpf, method = method, cacheOK = FALSE, quiet =  
> TRUE,     mode =
> "wb"), silent = TRUE)
>  3: available.packages(contriburl = contriburl, method = method)
>  4: .install.macbinary(pkgs = pkgs, lib = lib, contriburl =  
> contriburl,
> method = method, available = available, destdir = destdir,
> installWithVers = installWithVers, dependencies = dependencies)
>  5: install.packages("spgrass6", repos = rS, dependencies = TRUE)
>
> Possible actions:
> 1: abort (with core dump)
> 2: normal R exit
> 3: exit R without saving workspace
> 4: exit R saving workspace
> Selection:
>
> ***
>
> The dependencies have installed correctly, as far as I know.  Any  
> thoughts?
> Is this an issue with the fact that the machine is 64 bit?  I tried
> installing this with the 64 bit version of R and couldn't get rgdal
> installed...
>
> --j
>
> -- 
> Jonathan A. Greenberg, PhD
> NRC Research Associate
> NASA Ames Research Center
> MS 242-4
> Moffett Field, CA 94035-1000
> Office: 650-604-5896
> Cell: 415-794-5043
> AIM: jgrn307
> MSN: jgrn307 at hotmail.com
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From Roger.Bivand at nhh.no  Sun Sep 10 16:05:38 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sun, 10 Sep 2006 16:05:38 +0200 (CEST)
Subject: [R-sig-Geo] Failure to install spgrass6
In-Reply-To: <808F3231-1704-44EC-822B-F14CBAFB4C0E@connect.carleton.ca>
Message-ID: <Pine.LNX.4.44.0609101603500.4678-100000@reclus.nhh.no>

On Sun, 10 Sep 2006, Scott W Mitchell wrote:

> Did you try adding type="source" to the install.packages command?  I  
> don't know why not having it would lead to a segfault, but I still  
> would have thought you'd need it to avoid it trying to find a binary  
> package for the Mac (at least, that's my experience on my G5).

There has been a thread recently on one of the R lists about segfaults 
when trying to access an invalid http address (as would be the case trying 
to find a mac.binary, the default here. I think the segfault is replaced 
by an error message in install.packages() now.

Roger

> 
> On 10 Sep 2006, at 0:40, Jonathan Greenberg wrote:
> 
> > I'm getting this error while trying to install spgrass6 on a dual  
> > G5/2ghz w
> > 4gb ram, and macos x 10.4.7:
> >
> >> rS <- "http://r-spatial.sourceforge.net/R"
> >> install.packages("spgrass6", repos=rS, dependencies=TRUE)
> >
> >  *** caught segfault ***
> > address 0x5f4d4550, cause 'memory not mapped'
> >
> > Traceback:
> >  1: download.file(url = paste(repos, "PACKAGES.gz", sep = "/"),  
> > destfile =
> > tmpf,     method = method, cacheOK = FALSE, quiet = TRUE, mode = "wb")
> >  2: try(download.file(url = paste(repos, "PACKAGES.gz", sep = "/"),
> > destfile = tmpf, method = method, cacheOK = FALSE, quiet =  
> > TRUE,     mode =
> > "wb"), silent = TRUE)
> >  3: available.packages(contriburl = contriburl, method = method)
> >  4: .install.macbinary(pkgs = pkgs, lib = lib, contriburl =  
> > contriburl,
> > method = method, available = available, destdir = destdir,
> > installWithVers = installWithVers, dependencies = dependencies)
> >  5: install.packages("spgrass6", repos = rS, dependencies = TRUE)
> >
> > Possible actions:
> > 1: abort (with core dump)
> > 2: normal R exit
> > 3: exit R without saving workspace
> > 4: exit R saving workspace
> > Selection:
> >
> > ***
> >
> > The dependencies have installed correctly, as far as I know.  Any  
> > thoughts?
> > Is this an issue with the fact that the machine is 64 bit?  I tried
> > installing this with the 64 bit version of R and couldn't get rgdal
> > installed...
> >
> > --j
> >
> > -- 
> > Jonathan A. Greenberg, PhD
> > NRC Research Associate
> > NASA Ames Research Center
> > MS 242-4
> > Moffett Field, CA 94035-1000
> > Office: 650-604-5896
> > Cell: 415-794-5043
> > AIM: jgrn307
> > MSN: jgrn307 at hotmail.com
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Roger.Bivand at nhh.no  Sun Sep 10 16:11:29 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sun, 10 Sep 2006 16:11:29 +0200 (CEST)
Subject: [R-sig-Geo] [R-SIG-Mac] Problems installing rgdal from source
In-Reply-To: <C128ABAB.BFC0%jgreenberg@arc.nasa.gov>
Message-ID: <Pine.LNX.4.44.0609101607550.4678-100000@reclus.nhh.no>

On Sat, 9 Sep 2006, Jonathan Greenberg wrote:

> I am going through some similar problems getting rgdal running on macos x:
> 
> sudo ./usr/local/bin/R64 CMD INSTALL
> --configure-args='--with-proj-include=/usr/local/include
> --with-proj-lib=/usr/local/lib' rgdal
> 
> ...
> checking proj_api.h usability... yes
> checking proj_api.h presence... yes
> checking for proj_api.h... yes
> checking for pj_init_plus in -lproj... no
> libproj.a and/or proj_api.h not found.
> If the PROJ.4 library is installed in a non-standard location,
> use --configure-args='--with-proj-include=/opt/local/include
> --with-proj-lib=/opt/local/lib' for example, replacing /opt/local/*
> with appropriate values for your installation.
> If PROJ.4 is not installed, install it.
> ERROR: configuration failed for package 'rgdal'
> ** Removing '/usr/local/lib64/R/library/rgdal'
> ** Restoring previous '/usr/local/lib64/R/library/rgdal'


Is there any possibility that pj_init_plus is being hidden? Is this maybe 
a symptom of the buggy gcc (gcc not running correctly in configure)? With 
two people with the same problem (configure not finding a function in 
libproj.a that has to be there, and when libproj.a is in a very standard 
place), it must be possible to establish what they share. What is the gcc 
version?

Roger

> 
> Response from ls /usr/local/lib/libproj*:
> 
> /usr/local/lib/libproj.0.5.0.dylib      /usr/local/lib/libproj.dylib
> /usr/local/lib/libproj.0.dylib          /usr/local/lib/libproj.la
> /usr/local/lib/libproj.a
> 
> ***
> 
> I did a standard ./configure, make, sudo make install for proj-4.4.9 (after
> going through the same fink issue as the previous poster).  Any suggestions?
> You'll note the only real difference (I can't imagine why this would matter)
> is that I'm running the 64 bit version of R found at
> http://r.research.att.com/
> 
> --j
> 
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Roger.Bivand at nhh.no  Sun Sep 10 16:21:53 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sun, 10 Sep 2006 16:21:53 +0200 (CEST)
Subject: [R-sig-Geo] GRASS and R question
In-Reply-To: <6262c54c0609091700r7baad635u948ca27605a285fe@mail.gmail.com>
Message-ID: <Pine.LNX.4.44.0609101611360.4678-100000@reclus.nhh.no>

On Sat, 9 Sep 2006, Tim Keitt wrote:

> Jonathan,
> 
> This is what rgdal was designed to do. Here's an example,
> 
> ds1 <- GDAL.open("input.tif")
> driver <- new('GDALDriver', 'GTiff')
> ds2 <- new('GDALTransientDataset', driver, nrow(ds1), ncol(ds1), type
> = "Float64")
> for (row in nrow(ds1)) {
> 
>   x <- getRasterData(ds1, offset = c(row - 1, 0), region = c(1, ncol(ds1)))
>   ndvi <- (x[,2] - x[,1]) / (x[,2] + x[,1])
>   putRasterData(ds2, ndvi, offset = c(row - 1, 0))
> 
> }
> saveDataset(ds2, "result.tif")
> 
> This scales to absurd image sizes as only a single scanline is loaded
> into memory. (Note: I didn't try this code, but it should be about
> right.)

For reading, if the GDAL GRASS plugin is available, you can read the GRASS 
raster as a single band as Tim suggests in rgdal using offset= and 
region.dim=. The plugin doesn't have a write functionality, though.

If spgrass6 is a feasible route, you'd use g.region to imitate the 
subwindow choice, perhaps setting up sequences of regions and storing them 
first - I guess you could use loops and paste() in R to construct the 
regions if you like. Output would also be for the regions, probably to be 
r.patch-ed together later. Now both reading from and writing to GRASS use 
r.*.bin and temporary files.

> 
> I'm in the process of adding an 'apply' function to rgdal, so pretty
> soon you'll be able to do:
> 
> ds2 <- blockApply(ds1, function(x) (x[,2]-x[,1]) / (x[,2]+x[,1]))
> 
> The apply function will automatically use the optimal block size
> supplied by GDAL and so should be really fast on tiled images.
> 

This will be a useful avenue if you are outside GRASS, I'm not sure if the 
plugin GRASS drive is blocked/tiled. 

Roger

> For smaller images, it may be easier to use 'sp' classes. My approach
> is to use the rgdal classes for big images and then convert reduced
> resolution versions to 'sp' for display.
> 
> THK
> 
> On 9/9/06, Jonathan Greenberg <jgreenberg at arc.nasa.gov> wrote:
> > I was wondering if I could get some brief feedback on exactly what are the
> > capabilities of the sp and spgrass6 -- say I'd like to use R to calculate
> > and NDVI image (I know GRASS's mapcalc can do this fine, but I'm thinking of
> > some more complicated analyses that aren't easily performed in R and I
> > figured if I can figure out NDVI I can figure out the rest of them) -- Does
> > sp, spgrass6 and R itself provide both the data ingestion capabilities as
> > well as the necessary subsetting capabilities if my file is very large (e.g.
> > Can R do a per-pixel or per-line read/process/write routine, or will it
> > attempt to load an entire raster into memory)?
> >
> > If R can deal with import of a multiband image and tiled processing, can
> > someone here perhaps post an example of how to accomplish the above task
> > (taking a 4 band large file, calculating NDVI and then writing out the NDVI
> > to disk) using R?  Thanks!
> >
> > --j
> >
> >
> > --
> > Jonathan A. Greenberg, PhD
> > NRC Research Associate
> > NASA Ames Research Center
> > MS 242-4
> > Moffett Field, CA 94035-1000
> > Office: 650-604-5896
> > Cell: 415-794-5043
> > AIM: jgrn307
> > MSN: jgrn307 at hotmail.com
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> 
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From jgreenberg at arc.nasa.gov  Sun Sep 10 18:47:44 2006
From: jgreenberg at arc.nasa.gov (Jonathan Greenberg)
Date: Sun, 10 Sep 2006 09:47:44 -0700
Subject: [R-sig-Geo] Failure to install spgrass6
In-Reply-To: <808F3231-1704-44EC-822B-F14CBAFB4C0E@connect.carleton.ca>
Message-ID: <C1298FC0.BFF9%jgreenberg@arc.nasa.gov>

Yep, by doing R CMD INSTALL spgrass6 using the downloaded spgrass6 it worked
fine!  Thanks!

--j


On 9/10/06 6:53 AM, "Scott W Mitchell" <smitch at connect.carleton.ca> wrote:

> Did you try adding type="source" to the install.packages command?  I
> don't know why not having it would lead to a segfault, but I still
> would have thought you'd need it to avoid it trying to find a binary
> package for the Mac (at least, that's my experience on my G5).
> 
> On 10 Sep 2006, at 0:40, Jonathan Greenberg wrote:
> 
>> I'm getting this error while trying to install spgrass6 on a dual
>> G5/2ghz w
>> 4gb ram, and macos x 10.4.7:
>> 
>>> rS <- "http://r-spatial.sourceforge.net/R"
>>> install.packages("spgrass6", repos=rS, dependencies=TRUE)
>> 
>>  *** caught segfault ***
>> address 0x5f4d4550, cause 'memory not mapped'
>> 
>> Traceback:
>>  1: download.file(url = paste(repos, "PACKAGES.gz", sep = "/"),
>> destfile =
>> tmpf,     method = method, cacheOK = FALSE, quiet = TRUE, mode = "wb")
>>  2: try(download.file(url = paste(repos, "PACKAGES.gz", sep = "/"),
>> destfile = tmpf, method = method, cacheOK = FALSE, quiet =
>> TRUE,     mode =
>> "wb"), silent = TRUE)
>>  3: available.packages(contriburl = contriburl, method = method)
>>  4: .install.macbinary(pkgs = pkgs, lib = lib, contriburl =
>> contriburl,
>> method = method, available = available, destdir = destdir,
>> installWithVers = installWithVers, dependencies = dependencies)
>>  5: install.packages("spgrass6", repos = rS, dependencies = TRUE)
>> 
>> Possible actions:
>> 1: abort (with core dump)
>> 2: normal R exit
>> 3: exit R without saving workspace
>> 4: exit R saving workspace
>> Selection:
>> 
>> ***
>> 
>> The dependencies have installed correctly, as far as I know.  Any
>> thoughts?
>> Is this an issue with the fact that the machine is 64 bit?  I tried
>> installing this with the 64 bit version of R and couldn't get rgdal
>> installed...
>> 
>> --j
>> 
>> -- 
>> Jonathan A. Greenberg, PhD
>> NRC Research Associate
>> NASA Ames Research Center
>> MS 242-4
>> Moffett Field, CA 94035-1000
>> Office: 650-604-5896
>> Cell: 415-794-5043
>> AIM: jgrn307
>> MSN: jgrn307 at hotmail.com
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 


-- 
Jonathan A. Greenberg, PhD
NRC Research Associate
NASA Ames Research Center
MS 242-4
Moffett Field, CA 94035-1000
Office: 650-604-5896
Cell: 415-794-5043
AIM: jgrn307
MSN: jgrn307 at hotmail.com



From simon.urbanek at r-project.org  Mon Sep 11 17:17:08 2006
From: simon.urbanek at r-project.org (Simon Urbanek)
Date: Mon, 11 Sep 2006 11:17:08 -0400
Subject: [R-sig-Geo] [R-SIG-Mac] Problems installing rgdal from source
In-Reply-To: <Pine.LNX.4.44.0609101607550.4678-100000@reclus.nhh.no>
References: <Pine.LNX.4.44.0609101607550.4678-100000@reclus.nhh.no>
Message-ID: <4CF0DDA4-1E1A-43C2-9086-1D40522DE609@r-project.org>


On Sep 10, 2006, at 10:11 AM, Roger Bivand wrote:

> On Sat, 9 Sep 2006, Jonathan Greenberg wrote:
>
>> I am going through some similar problems getting rgdal running on  
>> macos x:
>>
>> sudo ./usr/local/bin/R64 CMD INSTALL
^^^
  +--- are you sure you have 64-bit version of libproj? Apparently  
you're using 64-bit R, so 32-bit libraries won't work.

A common mistake is to have a library for one architecture (ppc and  
ppc64 in this case, but commonly also ppc and i686), which then  
passes a linker test, but doesn't contain any relevant symbols,  
because they belong to another architecture. Just an idea ...

Cheers,
Simon



>> --configure-args='--with-proj-include=/usr/local/include
>> --with-proj-lib=/usr/local/lib' rgdal
>>
>> ...
>> checking proj_api.h usability... yes
>> checking proj_api.h presence... yes
>> checking for proj_api.h... yes
>> checking for pj_init_plus in -lproj... no
>> libproj.a and/or proj_api.h not found.
>> If the PROJ.4 library is installed in a non-standard location,
>> use --configure-args='--with-proj-include=/opt/local/include
>> --with-proj-lib=/opt/local/lib' for example, replacing /opt/local/*
>> with appropriate values for your installation.
>> If PROJ.4 is not installed, install it.
>> ERROR: configuration failed for package 'rgdal'
>> ** Removing '/usr/local/lib64/R/library/rgdal'
>> ** Restoring previous '/usr/local/lib64/R/library/rgdal'
>
>
> Is there any possibility that pj_init_plus is being hidden? Is this  
> maybe
> a symptom of the buggy gcc (gcc not running correctly in  
> configure)? With
> two people with the same problem (configure not finding a function in
> libproj.a that has to be there, and when libproj.a is in a very  
> standard
> place), it must be possible to establish what they share. What is  
> the gcc
> version?
>
> Roger
>
>>
>> Response from ls /usr/local/lib/libproj*:
>>
>> /usr/local/lib/libproj.0.5.0.dylib      /usr/local/lib/libproj.dylib
>> /usr/local/lib/libproj.0.dylib          /usr/local/lib/libproj.la
>> /usr/local/lib/libproj.a
>>
>> ***
>>
>> I did a standard ./configure, make, sudo make install for  
>> proj-4.4.9 (after
>> going through the same fink issue as the previous poster).  Any  
>> suggestions?
>> You'll note the only real difference (I can't imagine why this  
>> would matter)
>> is that I'm running the 64 bit version of R found at
>> http://r.research.att.com/
>>
>> --j
>>
>>
>>
>
> -- 
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian  
> School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
> _______________________________________________
> R-SIG-Mac mailing list
> R-SIG-Mac at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-mac
>
>



From zev at zevross.com  Mon Sep 11 17:42:45 2006
From: zev at zevross.com (Zev Ross)
Date: Mon, 11 Sep 2006 11:42:45 -0400
Subject: [R-sig-Geo] readOGR loses projection name?
Message-ID: <450583F5.2010703@zevross.com>

Hi All,

I think this is probably a simple one. I'm reading a shapefile, making a 
couple of changes and then sending it back out to shapefile. I am making 
no changes to the prj information but for some reason it seems that the 
projection name is being lost in the process. This is a non-traditional 
projection, one used by many California government agencies. It appears 
that the actual projection information is being maintained correctly, 
but I'd like to keep the name.

Zev

Here's the relevant piece of the code:

myprj<-readOGR("c:/junk/monitors", layer="monitors_all")
showWKT(proj4string(myprj),file="c/junk/monitors_all.prj")

here is the prj that I'm reading in

PROJCS["NAD_1983_California_Teale_Albers",GEOGCS["GCS_North_American_1983",
DATUM["D_North_American_1983",SPHEROID["GRS_1980",6378137.0,298.257222101]],
PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Albers"],
PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",-4000000.0],
PARAMETER["Central_Meridian",-120.0],PARAMETER["Standard_Parallel_1",34.0],
PARAMETER["Standard_Parallel_2",40.5],PARAMETER["Latitude_Of_Origin",0.0],UNIT["Meter",1.0]]


here is the output prj

PROJCS["Unknown",GEOGCS["GCS_North_American_1983",
DATUM["D_North_American_1983",SPHEROID["GRS_1980",6378137,298.257222101]],
PRIMEM["Greenwich",0],UNIT["Degree",0.017453292519943295]],PROJECTION["Albers"],
PARAMETER["standard_parallel_1",34],PARAMETER["standard_parallel_2",40.5],
PARAMETER["latitude_of_origin",0],PARAMETER["central_meridian",-120],
PARAMETER["false_easting",0],PARAMETER["false_northing",-4000000],UNIT["Meter",1]] 



-- 
Zev Ross
ZevRoss Spatial Analysis
303 Fairmount Ave.
Ithaca, NY 14850
(607) 277-0004 (phone)
(866) 877-3690 (fax toll-free)
zev at zevross.com
www.zevross.com



From tkeitt at gmail.com  Mon Sep 11 18:00:50 2006
From: tkeitt at gmail.com (Tim Keitt)
Date: Mon, 11 Sep 2006 11:00:50 -0500
Subject: [R-sig-Geo] readOGR loses projection name?
In-Reply-To: <450583F5.2010703@zevross.com>
References: <450583F5.2010703@zevross.com>
Message-ID: <6262c54c0609110900v5e3e2fc1we934bb632ba2409d@mail.gmail.com>

My best guess is that you need to add your projection to one of the
files in /usr/share/gdal or in the projection definition files shipped
with rgdal. Please send it upstream if you do.

THK

On 9/11/06, Zev Ross <zev at zevross.com> wrote:
> Hi All,
>
> I think this is probably a simple one. I'm reading a shapefile, making a
> couple of changes and then sending it back out to shapefile. I am making
> no changes to the prj information but for some reason it seems that the
> projection name is being lost in the process. This is a non-traditional
> projection, one used by many California government agencies. It appears
> that the actual projection information is being maintained correctly,
> but I'd like to keep the name.
>
> Zev
>
> Here's the relevant piece of the code:
>
> myprj<-readOGR("c:/junk/monitors", layer="monitors_all")
> showWKT(proj4string(myprj),file="c/junk/monitors_all.prj")
>
> here is the prj that I'm reading in
>
> PROJCS["NAD_1983_California_Teale_Albers",GEOGCS["GCS_North_American_1983",
> DATUM["D_North_American_1983",SPHEROID["GRS_1980",6378137.0,298.257222101]],
> PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Albers"],
> PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",-4000000.0],
> PARAMETER["Central_Meridian",-120.0],PARAMETER["Standard_Parallel_1",34.0],
> PARAMETER["Standard_Parallel_2",40.5],PARAMETER["Latitude_Of_Origin",0.0],UNIT["Meter",1.0]]
>
>
> here is the output prj
>
> PROJCS["Unknown",GEOGCS["GCS_North_American_1983",
> DATUM["D_North_American_1983",SPHEROID["GRS_1980",6378137,298.257222101]],
> PRIMEM["Greenwich",0],UNIT["Degree",0.017453292519943295]],PROJECTION["Albers"],
> PARAMETER["standard_parallel_1",34],PARAMETER["standard_parallel_2",40.5],
> PARAMETER["latitude_of_origin",0],PARAMETER["central_meridian",-120],
> PARAMETER["false_easting",0],PARAMETER["false_northing",-4000000],UNIT["Meter",1]]
>
>
>
> --
> Zev Ross
> ZevRoss Spatial Analysis
> 303 Fairmount Ave.
> Ithaca, NY 14850
> (607) 277-0004 (phone)
> (866) 877-3690 (fax toll-free)
> zev at zevross.com
> www.zevross.com
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


-- 
Timothy H. Keitt
http://www.keittlab.org/



From Martin at Hvidberg.net  Mon Sep 11 11:04:28 2006
From: Martin at Hvidberg.net (Martin Hvidberg)
Date: Mon, 11 Sep 2006 11:04:28 +0200
Subject: [R-sig-Geo] Q: How to do LUR (Land Use Regression)?
Message-ID: <4505269C.9000001@Hvidberg.net>

Dear group

I would like to try a technique called LUR (Land Use Regression)
Any one know if/how R do this???

:-) Martin

Links to LUR related stuff:

http://www.environmental-expert.com/resulteacharticle4.asp?codi=4780
http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=Retrieve&db=PubMed&list_uids=16047040&dopt=Abstract 

http://www.ij-healthgeographics.com/content/4/1/26
http://www.pnwis.org/Ch_VI/Luncheon%20Notices/April%2026%202005%20Luncheon%20Notice.pdf#search=%22%22Land%20Use%20Regression%22%22 

http://communicate.aag.org/eseries/aag_org/program/AbstractDetail.cfm?AbstractID=7842 

--------------------------------------------
My mailbox is spam-free with ChoiceMail, the leader in personal and corporate anti-spam solutions. Download your free copy of ChoiceMail from www.digiportal.com



From Roger.Bivand at nhh.no  Mon Sep 11 22:13:55 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 11 Sep 2006 22:13:55 +0200 (CEST)
Subject: [R-sig-Geo] readOGR loses projection name?
In-Reply-To: <6262c54c0609110900v5e3e2fc1we934bb632ba2409d@mail.gmail.com>
Message-ID: <Pine.LNX.4.44.0609112211520.5472-100000@reclus.nhh.no>

On Mon, 11 Sep 2006, Tim Keitt wrote:

> My best guess is that you need to add your projection to one of the
> files in /usr/share/gdal or in the projection definition files shipped
> with rgdal. Please send it upstream if you do.

Yes. rgdal does take over the GDAL and PROJ data directories when the 
package is loaded, this was needed for a number of reasons but is a bit 
heavy handed. We can try to work out where to keep updates to the public 
GDAL/PROJ.4 tables.

Roger

> 
> THK
> 
> On 9/11/06, Zev Ross <zev at zevross.com> wrote:
> > Hi All,
> >
> > I think this is probably a simple one. I'm reading a shapefile, making a
> > couple of changes and then sending it back out to shapefile. I am making
> > no changes to the prj information but for some reason it seems that the
> > projection name is being lost in the process. This is a non-traditional
> > projection, one used by many California government agencies. It appears
> > that the actual projection information is being maintained correctly,
> > but I'd like to keep the name.
> >
> > Zev
> >
> > Here's the relevant piece of the code:
> >
> > myprj<-readOGR("c:/junk/monitors", layer="monitors_all")
> > showWKT(proj4string(myprj),file="c/junk/monitors_all.prj")
> >
> > here is the prj that I'm reading in
> >
> > PROJCS["NAD_1983_California_Teale_Albers",GEOGCS["GCS_North_American_1983",
> > DATUM["D_North_American_1983",SPHEROID["GRS_1980",6378137.0,298.257222101]],
> > PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Albers"],
> > PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",-4000000.0],
> > PARAMETER["Central_Meridian",-120.0],PARAMETER["Standard_Parallel_1",34.0],
> > PARAMETER["Standard_Parallel_2",40.5],PARAMETER["Latitude_Of_Origin",0.0],UNIT["Meter",1.0]]
> >
> >
> > here is the output prj
> >
> > PROJCS["Unknown",GEOGCS["GCS_North_American_1983",
> > DATUM["D_North_American_1983",SPHEROID["GRS_1980",6378137,298.257222101]],
> > PRIMEM["Greenwich",0],UNIT["Degree",0.017453292519943295]],PROJECTION["Albers"],
> > PARAMETER["standard_parallel_1",34],PARAMETER["standard_parallel_2",40.5],
> > PARAMETER["latitude_of_origin",0],PARAMETER["central_meridian",-120],
> > PARAMETER["false_easting",0],PARAMETER["false_northing",-4000000],UNIT["Meter",1]]
> >
> >
> >
> > --
> > Zev Ross
> > ZevRoss Spatial Analysis
> > 303 Fairmount Ave.
> > Ithaca, NY 14850
> > (607) 277-0004 (phone)
> > (866) 877-3690 (fax toll-free)
> > zev at zevross.com
> > www.zevross.com
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> 
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From ghos0033 at UMN.EDU  Mon Sep 11 23:27:27 2006
From: ghos0033 at UMN.EDU (Debarchana Ghosh)
Date: Mon, 11 Sep 2006 16:27:27 -0500
Subject: [R-sig-Geo] How to convert esri shapefiles to ppp objetcs/ owin
	object
Message-ID: <d1b8ff630609111427m1cbef3bdp90698b6740b37ebe@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20060911/ddfefac5/attachment.pl>

From Roger.Bivand at nhh.no  Tue Sep 12 10:45:47 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 12 Sep 2006 10:45:47 +0200 (CEST)
Subject: [R-sig-Geo] How to convert esri shapefiles to ppp objetcs/ owin
 object
In-Reply-To: <d1b8ff630609111427m1cbef3bdp90698b6740b37ebe@mail.gmail.com>
Message-ID: <Pine.LNX.4.44.0609121038240.6083-100000@reclus.nhh.no>

On Mon, 11 Sep 2006, Debarchana Ghosh wrote:

> Hi All,
> 
> I'm in the process of conducting spatial point clustering where the
> locations are very important by using splancs and spatstat packages. However
> it looks like I'm stuck at the very first step. Even after reading the
> manuals, I can't figure it out how to create the ppp class object from the
> esri shapefiles specially the uneven polygon. I have a study area of seven
> counties. Any help on this will greatly appreciated.

Please have a look at the functions in the spspatstat package on 
sourceforge - http://r-spatial.sourceforge.net/ and see download for 
download instructions. If the sp package is installed first:

rSpatial <- "http://r-spatial.sourceforge.net/R"
install.packages("spspatstat", repos=rSpatial)

should work (unless OSX when type="source" is also needed). That lets you 
convert points and windows from sp class objects. See the R News note on 
sp classes in 2005/2, pp. 9-13.

If you can see additions to the interface package that would be useful, 
please let us know.

Roger

> 
> Thanks,
> Debs.
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From tkeitt at gmail.com  Tue Sep 12 20:17:04 2006
From: tkeitt at gmail.com (Tim Keitt)
Date: Tue, 12 Sep 2006 13:17:04 -0500
Subject: [R-sig-Geo] CVS updates to rgdal
Message-ID: <6262c54c0609121117v2f128a07mb5e2a683715f660f@mail.gmail.com>

Hi Folks,

Just though I'd let people know that there is an experimental branch
("THK") of rgdal in CVS at the sourceforge site. It passes "R CMD
check" on my machine.

Major changes are:

1) "new" is no longer used to open datasets. "openDataset" (or
equivalently "GDAL.open") is now the only way to open existing
datasets, eg,

    ds1 <- openDataset("test.tif", read.only = FALSE)

I'd like to have a consistent set of function names, so I'm
considering deprecating GDAL.(open|close).

2) A "createDataset" function is defined to make it easy to create a
GDAL dataset to hold the output of your analysis, eg,

   ds2 <- createDataset("GTiff", 1024, 1024, 1, "Float64", "output.tif")
   # calls to putRasterData
   closeDataset(ds2)

(Also, in general you can now provide either the driver object or the
driver name as a string.)

2a) There are some tricky issues with the "copyDataset" (GDAL's copy
dataset function does not actually copy any data by design) and
"saveDataset" functions. These may go away or be rewritten from
scratch.

3) The "offset" argument to "getRasterData" and "getRasterTable" has
been replaced with "at" which specifies the location of the upper-left
corner to begin reading/writing rather than the offset from the image
origin. This simplifies looping over scanlines or blocks. I'd like to
see this change however to some more general and flexible mechanism of
specifying data regions. One that would allow using (x,y) and
(row,column) interchangably, and perhaps in the future allow for
arbitrary polygons.

4) A new function "RGB2PCT" will convert three bands of raster data
into a single-band dithered image with a pseudocolor lookup table. The
"displayDataset" function has returned. It only displays a single
band, but will automatically use the pseudocolor lookup table
generated by "RGB2PCT" (or whatever color table is attached to the
raster band). "displayDataset" automatically decimates the input to
make drawing the image faster, but does not yet use embedded
overviews. (Roger also has a function that takes a 3-band
SpatialGridDataFrame and dithers/builds the PCT -- we probably need to
merge these or wrap one with the other.)

The change from "offset" to "at" is likely to have broken the "sp"
related functions. We'll need to review those or come up with the
alternative to "at" and rewrite as necessary.

A few more items that would be nice to include might be having
"getRasterData" and  "putRasterData" return/accept "sp" objects. It
will add an extra step when reading raster data as it would require
the data to be unpacked from the "sp" object for manipulation in R (if
I understand the "sp" setup). It would be no more than obj$data or
something like that.

Cheers,
Tim

-- 
Timothy H. Keitt
http://www.keittlab.org/



From ghos0033 at UMN.EDU  Wed Sep 13 01:21:25 2006
From: ghos0033 at UMN.EDU (Debarchana Ghosh)
Date: Tue, 12 Sep 2006 18:21:25 -0500
Subject: [R-sig-Geo] Problem in converting SpatialPolygonsDataFrame to owin
	object
Message-ID: <d1b8ff630609121621u5773f91fu1e71e0c7130ef6c0@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20060912/d36976e7/attachment.pl>

From e.pebesma at geo.uu.nl  Wed Sep 13 09:33:20 2006
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Wed, 13 Sep 2006 09:33:20 +0200
Subject: [R-sig-Geo] Problem in converting SpatialPolygonsDataFrame to
 owin	object
In-Reply-To: <d1b8ff630609121621u5773f91fu1e71e0c7130ef6c0@mail.gmail.com>
References: <d1b8ff630609121621u5773f91fu1e71e0c7130ef6c0@mail.gmail.com>
Message-ID: <4507B440.5090406@geo.uu.nl>

Debarchana Ghosh wrote:
> Hi,
>
> Using readShapePoly from maptools I've read a ESRI shapefile to a object of
> class 'SpatialPolygonsDataFrame'.
>
> xx<-readShapePoly("tcma.shp")
>   
>> plot(xx, border="blue", las=1)
>> str(xx)
>>     
>
> Formal class 'SpatialPolygonsDataFrame' [package "sp"] with 5 slots
>   ..@ data       :`data.frame': 7 obs. of  5 variables:
>   .. ..$ COUNTY   : Factor w/ 7 levels "27003","27019",..: 1 2 3 4 5 6 7
>   .. ..$ CountyDum: num [1:7] 1 2 3 4 5 6 7
>   .. ..$ area     : num [1:7] 1.15e+09 9.74e+08 1.52e+09 1.57e+09 4.40e+08...
>   .. ..$ X        : num [1:7] 480680 436555 494806 462435 492163 ...
>   .. ..$ Y        : num [1:7] 5013322 4963352 4946475 4983552 4984842 ...
>
> However I'm getting errors to convert xx(SpatialPolygonsDataFrame-object) to
> 'owin' object by using spspatstat package.
>
>   
>> xx1<-as(as(xx, "SpatialPolygons"), "owin")
>>     
> Polygons 1 and 4 cross over
> Polygons 1 and 5 cross over
> Polygons 1 and 7 cross over
> Polygons 2 and 4 cross over
> Polygons 2 and 6 cross over
> Polygons 3 and 4 cross over
> Polygons 3 and 5 cross over
> Polygons 3 and 6 cross over
> Polygons 3 and 7 cross over
> Polygons 4 and 5 cross over
> Polygons 4 and 6 cross over
> Polygons 5 and 7 cross over
> Error in owin(poly = opls) : Polygon data contain overlaps between polygons
>   
These error messages are from spatstat, and seem to indicate that there 
is a problem with the polygons you provide: do they have line segments 
that intersect?
> Also,
>   
>>  
>>     
> Error in asMethod(object) : W must be a SpatialPolygons object
>   
You can ignore this message; proceed with the previous version.
> After getting this error I realised SpatialPolygons is not same as
> SpatialPolygonDataFrame. If I'm correct how will I convert
>   
SpatialPolygonDataFrame simply extends SpatialPolygons with a data slot 
containing the attributes. The is() relation holds, but it was 
inherits() that was used in the code. Changed that.
> 'SpatialPolygonDataFrame' to 'SpatialPolygons' obgect?
>   
The

as(xx, "SpatialPolygons")
works fine; I modified the code such that
xx1<-as(xx, "owin")

will work fine as well in the future.
--
Edzer



From sq210 at cam.ac.uk  Wed Sep 13 15:19:13 2006
From: sq210 at cam.ac.uk (Suhel Quader)
Date: Wed, 13 Sep 2006 14:19:13 +0100 (BST)
Subject: [R-sig-Geo] Geostatistical model with uncertainty in response
	variable
Message-ID: <Pine.LNX.4.64.0609131359490.11573@hermes-2.csi.cam.ac.uk>

Hello all,

I wonder whether someone could advise on my problem:

I want to use AIC to conduct model selection for a geostatistical model in 
which the response variable is roughly normally distributed. But each 
y-value is an estimate, and so I would like to take into account variation 
in the uncertainties of the estimates. Also, I want to use the Matern 
structure to model spatial correlations.

I have found several options, each of which has one or more drawbacks:

1. Use gls() in nlme. I think this can do all I want, except there is no 
Matern corStruct class.

2. Use likfit() or krige.bayes() in geoR. But these can't take into 
account uncertainty in the response variable

3. Use another way of direct ML estimation of parameters (Hoeting et al. 
2006. Ecological Applications 16:87-98). But this can't take into account 
uncertainty of the response, and also doesn't give variance estimates of 
the regression parameters.

Does anyone have any suggestions about how I might proceed? I'd like to 
avoid having to construct a new corStruct class if possible (don't really 
have the necessary expertise).

Many thanks!
  Suhel

Suhel Quader, PhD
Department of Zoology
University of Cambridge



From Roger.Bivand at nhh.no  Thu Sep 14 09:11:53 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 14 Sep 2006 09:11:53 +0200
Subject: [R-sig-Geo] (no subject)
Message-ID: <6B6649B7F4ECA549A0332CEC519751F30C8F2D@TOLAR.valuta.nhh.no>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20060914/c45fcece/attachment.pl>

From e.pebesma at geo.uu.nl  Thu Sep 14 09:29:27 2006
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Thu, 14 Sep 2006 09:29:27 +0200
Subject: [R-sig-Geo] Problem in converting SpatialPolygonsDataFrame to
 owin object
In-Reply-To: <d1b8ff630609131046v38838cc7y4b5103fc1a202e58@mail.gmail.com>
References: <d1b8ff630609121621u5773f91fu1e71e0c7130ef6c0@mail.gmail.com>	
	<4507B440.5090406@geo.uu.nl>
	<d1b8ff630609131046v38838cc7y4b5103fc1a202e58@mail.gmail.com>
Message-ID: <450904D7.7070004@geo.uu.nl>

Debarchana Ghosh wrote:
>
>   
>  

>     works fine; I modified the code such that
>     xx1<-as(xx, "owin")
>
>     will work fine as well in the future.
>     --
>
>
>
> So I just download and install the updated spspatstat package?
I said "future", not "near future" or "now"; spspatstat isn't on CRAN. 
If you wish you could download the source from anonymous cvs on the 
r-spatial sourceforge project. It is not there where your problem is, 
however, as you were able to transform to SpatialPolygons anyway.
> Also, I know attachment is not the right way to converse on this 
> list-serve but I couldn't think of any other way to show my study 
> area. So I've attached the image of my study area (polygon). As i've 
> mentioned in my earlier email, I've read a shapefile in R and created 
> a object (xx)  of class SpatialPolygonDataFrame. Howver when I try to 
> convert xx to owin I get the following error. As shown in the 
> attachment, the lines do not intersect but has 7 contigous US counties.
>
> Any solution to this problem will be very helpful.
The problem may be that polygons are only slightly intersecting (which 
you cannot find out from a bitmap image), or that some code is making 
wrong assumptions. The error message comes from the owin function in the 
spatstat package. If the author of the package doesn't listen to this 
list, you could contact him directly (I Cc:d this message). To me, at 
first glance it looked like the error generating code is a fairly recent 
add to spatstat, but I may be wrong on that.
--
Edzer



From Roger.Bivand at nhh.no  Thu Sep 14 12:19:18 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 14 Sep 2006 12:19:18 +0200 (CEST)
Subject: [R-sig-Geo] Problem in converting SpatialPolygonsDataFrame to
 owin object
In-Reply-To: <450904D7.7070004@geo.uu.nl>
Message-ID: <Pine.LNX.4.44.0609141216090.8312-100000@reclus.nhh.no>

On Thu, 14 Sep 2006, Edzer J. Pebesma wrote:

> Debarchana Ghosh wrote:
> >
> >   
> >  
> 
> >     works fine; I modified the code such that
> >     xx1<-as(xx, "owin")
> >
> >     will work fine as well in the future.
> >     --
> >
> >
> >
> > So I just download and install the updated spspatstat package?
> I said "future", not "near future" or "now"; spspatstat isn't on CRAN. 
> If you wish you could download the source from anonymous cvs on the 
> r-spatial sourceforge project. It is not there where your problem is, 
> however, as you were able to transform to SpatialPolygons anyway.
> > Also, I know attachment is not the right way to converse on this 
> > list-serve but I couldn't think of any other way to show my study 
> > area. So I've attached the image of my study area (polygon). As i've 
> > mentioned in my earlier email, I've read a shapefile in R and created 
> > a object (xx)  of class SpatialPolygonDataFrame. Howver when I try to 
> > convert xx to owin I get the following error. As shown in the 
> > attachment, the lines do not intersect but has 7 contigous US counties.
> >
> > Any solution to this problem will be very helpful.
> The problem may be that polygons are only slightly intersecting (which 
> you cannot find out from a bitmap image), or that some code is making 
> wrong assumptions. The error message comes from the owin function in the 
> spatstat package. If the author of the package doesn't listen to this 
> list, you could contact him directly (I Cc:d this message). To me, at 
> first glance it looked like the error generating code is a fairly recent 
> add to spatstat, but I may be wrong on that.

Is it possible to make the offending shapefiles available to me/others? 
Without them it is very difficult to debug - SpatialPolygons do not check 
for intersections. I would suggest using spgpc (also on sourceforge) to 
clean the polygons, but first we need to find out if they do intersect.

Roger

> --
> Edzer
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From jahernan at umn.edu  Thu Sep 14 16:59:33 2006
From: jahernan at umn.edu (Jose A. Hernandez)
Date: Thu, 14 Sep 2006 09:59:33 -0500
Subject: [R-sig-Geo] Assistant professor in spatial data quality and
	statistics
Message-ID: <45096E55.7050202@umn.edu>

"Assistant professor in spatial data quality and statistics" at the 
International Institute for Geo-Information Science and Earth 
Observation <http://www.itc.nl>.

For the job description, deadline, requisites and contacts, please 
visit: http://www.pedometrics.org/jobs.asp?id=19

Best regards,

Jose

-- 
Jose A. Hernandez
Precision Agriculture Center
Department of Soil, Water, and Climate
University of Minnesota
1991 Upper Buford Circle
St. Paul, MN 55108

Ph. +1 (612) 625-0445, Fax. +1 (612) 625-2208



From adrian at maths.uwa.edu.au  Fri Sep 15 05:37:04 2006
From: adrian at maths.uwa.edu.au (Adrian Baddeley)
Date: Fri, 15 Sep 2006 11:37:04 +0800
Subject: [R-sig-Geo] Problem in converting SpatialPolygonsDataFrame to owin
	object
Message-ID: <17674.8160.607603.898339@maths.uwa.edu.au>


Debarchana Ghosh reports a problem in converting an object
of class SpatialPolygonsDataFrame to class 'owin'.

Without any other information (without the data and knowing 
nothing about 'sp') my guess is that you are trying to 
make a single polygonal region out of several polygons that are adjoining 
i.e. there are two polygons that share an edge, like the 
borders of adjoining countries.

Did you want to end up with a single region of space,
or with a list of different regions?

In the spatstat package, an object of class `owin' always represents 
a region of space with an inside, an outside and a boundary. 
To create a region with a polygonal boundary, you have to supply
the coordinates of the *boundary* line segments. That is, every 
edge of your polygon must be part of the *boundary* of the spatial region
(the region separating the inside from the outside).

For example, to define the USA as an owin object, 
you would supply the coordinates of the international borders
(USA-Canada and USA-Mexico) and the ocean coast, but **not** the 
interstate borders.

When you create a polygonal region as an object of class 'owin',
spatstat checks its validity by checking for
	 - self-intersection in each polygon
	 - intersections between different polygons
	   (including common boundaries).
It will not automatically `join' together two adjacent polygons.
That kind of functionality is better handled by other code like gpclib.

Alternatively you can convert each separate polygon
to an `owin' object, then use 'union.owin' to compute their union
(which is doen by converting the polygons to binary images).

Adrian Baddeley



From ekkehardt.altpeter at bag.admin.ch  Fri Sep 15 16:09:16 2006
From: ekkehardt.altpeter at bag.admin.ch (ekkehardt.altpeter at bag.admin.ch)
Date: Fri, 15 Sep 2006 16:09:16 +0200
Subject: [R-sig-Geo] Converting contours to shapefiles and export them
Message-ID: <C8FA58B611127B41A7307C05F15CC00098BF39@edi021ex.edi.intra.admin.ch>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20060915/56933b00/attachment.pl>

From Roger.Bivand at nhh.no  Fri Sep 15 20:40:44 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 15 Sep 2006 20:40:44 +0200 (CEST)
Subject: [R-sig-Geo] Converting contours to shapefiles and export them
In-Reply-To: <C8FA58B611127B41A7307C05F15CC00098BF39@edi021ex.edi.intra.admin.ch>
Message-ID: <Pine.LNX.4.44.0609152034280.9057-100000@reclus.nhh.no>

On Fri, 15 Sep 2006 ekkehardt.altpeter at bag.admin.ch wrote:

> Dear List members,
> 
> I am running R 2.3.1 on a Windows 2000 machine. I have loaded the
> following packages: foreign, sp, maptools. I could load package
> shapefile as well, but this leads to conflicts with the packages sp and
> maptools.
> 
> I have the following question
> 
> I estimated by means of kde2d a 2-dimensional density based on a
> sample of points. I passed this estimation to contour. I would like to 
> export the result to a shapefile with lines. I have loaded foreign, sp 
> and maptools. Can you give me a hint?

?contourLines2SLDF
?writeLinesShape

gets you there in two steps. Have a look at their examples.
> 
> The result of contour is a list which has a vector for x and y and a
> 
> matrix for z mit dimension dim(x) X dim (y).
> 
>  
> 
> Thank's a lot for your feedbacks.
> 
>  
> 
> Ekkehardt Altpeter
> 
>  
> 
>  
> 
> _______________________________________________________
> 
> Bundesamt f?r Gesundheit
> 
> Direktionsbereich ?ffentliche Gesundheit
> 
> Sektion Infektionskrankheiten
> 
> Dr. med. Ekkehardt Altpeter
> 
> wissenschaftlicher Mitarbeiter
> 
>  
> 
> Postadresse: Postfach, CH-3003 Bern
> 
> B?ro: Schwarztorstr. 96
> 
> Telefon: +41 (0)31 324 98 34 FAX +41 (0)31 323 87 95
> 
> E-Mail: ekkehardt.altpeter at bag.admin.ch
> 
> Internet: www.bag.admin.ch 
> 
>  
> 
> 
> 	[[alternative HTML version deleted]]
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From sf2257 at columbia.edu  Fri Sep 15 21:33:57 2006
From: sf2257 at columbia.edu (Sam Field)
Date: Fri, 15 Sep 2006 15:33:57 -0400
Subject: [R-sig-Geo] Sampling from a SAR error model
Message-ID: <1158348837.450b002518870@cubmail.cc.columbia.edu>

List,

I am having trouble writing a script that samples from an SAR error
process. I've done it successfully for a spatial lag model, but not
for the spatial error model.  For the spatial lag model, I have the
following:

y_lag <- (solve(diag(100)- p*w))%*%X_mat%*%parms +
solve(diag(100)-p*w)%*%e

where parms is a parameter vector
X_mat is n by p matrix of independent variables (+ constant)
e is a vector of indepndent normal deviates (mean = 0)
p is the autoregressive paramter
and w is a square, n by n contiguity matrix (row normalized).

This works beautifully.  lagsarlm recovers parms and p without a
problem. Over repeated sampling, the estimated values are centered
on the value for p in the simulation.


Is there something wrong with the following for the spatial error
model?

y_error <- X_mat%*%parms + (solve(diag(100)-p*w))%*%e


The distribution of values for p obtain from errorsarlm over
repeated sampling are not centered around the value for the
simulation, but are typically much lower and all over the place.  I
have only looked at values for p ranging from .3 to .7.

any help would be greatly appreciated!



-- 
Samuel H. Field, Ph.D.
Associate Research Scholar
Institute for Social and Economic Research and Policy (ISERP)
Columbia University
420 W. 118th Street
Mail code 3355
New York, NY  10027
215-731-0106



From Roger.Bivand at nhh.no  Fri Sep 15 21:49:53 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 15 Sep 2006 21:49:53 +0200 (CEST)
Subject: [R-sig-Geo] Problem in converting SpatialPolygonsDataFrame to
 owin object
In-Reply-To: <17674.8160.607603.898339@maths.uwa.edu.au>
Message-ID: <Pine.LNX.4.44.0609152108320.9109-100000@reclus.nhh.no>

On Fri, 15 Sep 2006, Adrian Baddeley wrote:

> 
> Debarchana Ghosh reports a problem in converting an object
> of class SpatialPolygonsDataFrame to class 'owin'.
> 
> Without any other information (without the data and knowing 
> nothing about 'sp') my guess is that you are trying to 
> make a single polygonal region out of several polygons that are adjoining 
> i.e. there are two polygons that share an edge, like the 
> borders of adjoining countries.

Yes, correct. The real culprit is the very messy shapefile (which was made 
available to me offline), which not only appears to be of 7 contiguous 
counties, but when dissolved using:

library(spgpc)
tcma_outer <- unionSpatialPolygons(as(tcma, "SpatialPolygons"), rep(1, 7))

has a single outer boundary and as many as 428 internal slivers. My 
immediate suggestion to the questioner would be to locate a better data 
source, such as:

http://www.census.gov/geo/cob/bdy/co/co00shp/co27_d00_shp.zip

In R:

library(rgdal)
tcma <- readOGR(".", "DG_tcma")
library(maptools)
mn <- readShapePoly("co27_d00.shp", proj4string=CRS("+proj=longlat +datum=WGS84"))
mn_FIPS <- paste(as.character(mn$STATE), as.character(mn$COUNTY), sep="")
match(as.character(tcma$COUNTY), mn_FIPS)
mn_subset <- mn[match(as.character(tcma$COUNTY), mn_FIPS),]
mn_subset_utm15N <- spTransform(mn_subset, CRS(proj4string(tcma)))
plot(mn_subset_utm15N, lwd=3, axes=TRUE)
plot(tcma, add=TRUE, border="red")
library(spgpc)
tcma_outer <- unionSpatialPolygons(as(mn_subset_utm15N, "SpatialPolygons"), rep(1, 7))
plot(tcma_outer)
library(spspatstat)
tcma_owin <- as(as(tcma_outer, "SpatialPolygons"), "owin")
plot(tcma_owin)

The key problem was the very messy shapefile, followed by not having 
understood that owin objects cannot be contiguous. The wrapper packages 
are on the sourceforge site. 

Hope this helps,

Roger

> 
> Did you want to end up with a single region of space,
> or with a list of different regions?
> 
> In the spatstat package, an object of class `owin' always represents 
> a region of space with an inside, an outside and a boundary. 
> To create a region with a polygonal boundary, you have to supply
> the coordinates of the *boundary* line segments. That is, every 
> edge of your polygon must be part of the *boundary* of the spatial region
> (the region separating the inside from the outside).
> 
> For example, to define the USA as an owin object, 
> you would supply the coordinates of the international borders
> (USA-Canada and USA-Mexico) and the ocean coast, but **not** the 
> interstate borders.
> 
> When you create a polygonal region as an object of class 'owin',
> spatstat checks its validity by checking for
> 	 - self-intersection in each polygon
> 	 - intersections between different polygons
> 	   (including common boundaries).
> It will not automatically `join' together two adjacent polygons.
> That kind of functionality is better handled by other code like gpclib.
> 
> Alternatively you can convert each separate polygon
> to an `owin' object, then use 'union.owin' to compute their union
> (which is doen by converting the polygons to binary images).
> 
> Adrian Baddeley
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Roger.Bivand at nhh.no  Sat Sep 16 00:09:28 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 16 Sep 2006 00:09:28 +0200 (CEST)
Subject: [R-sig-Geo] Sampling from a SAR error model
In-Reply-To: <1158348837.450b002518870@cubmail.cc.columbia.edu>
Message-ID: <Pine.LNX.4.44.0609152152001.9174-100000@reclus.nhh.no>

On Fri, 15 Sep 2006, Sam Field wrote:

> List,
> 
> I am having trouble writing a script that samples from an SAR error
> process. I've done it successfully for a spatial lag model, but not
> for the spatial error model.  For the spatial lag model, I have the
> following:
> 
> y_lag <- (solve(diag(100)- p*w))%*%X_mat%*%parms +
> solve(diag(100)-p*w)%*%e
> 
> where parms is a parameter vector
> X_mat is n by p matrix of independent variables (+ constant)
> e is a vector of indepndent normal deviates (mean = 0)
> p is the autoregressive paramter
> and w is a square, n by n contiguity matrix (row normalized).
> 
> This works beautifully.  lagsarlm recovers parms and p without a
> problem. Over repeated sampling, the estimated values are centered
> on the value for p in the simulation.
> 
> 
> Is there something wrong with the following for the spatial error
> model?
> 
> y_error <- X_mat%*%parms + (solve(diag(100)-p*w))%*%e
> 

Interesting question. Where is the sigma^2 going in your case - is it in 
the generation of e? Could you try to use the columbus dataset and 
set.seed to generate a reproducible example - it may be that what you have 
written does not communicate exactly what you have done?

Roger

> 
> The distribution of values for p obtain from errorsarlm over
> repeated sampling are not centered around the value for the
> simulation, but are typically much lower and all over the place.  I
> have only looked at values for p ranging from .3 to .7.
> 
> any help would be greatly appreciated!
> 
> 
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From twgriffi at purdue.edu  Sat Sep 16 00:10:18 2006
From: twgriffi at purdue.edu (Griffin, Terry W)
Date: Fri, 15 Sep 2006 18:10:18 -0400
Subject: [R-sig-Geo] Sampling from a SAR error model
In-Reply-To: <1158348837.450b002518870@cubmail.cc.columbia.edu>
Message-ID: <CD7951A61CF9644B8FC63A55CED4194B01A29FFF@EXCH03.purdue.lcl>

Dr. Field,

I'm working on similar simulations and have induced a range of spatial
autocorrelation levels into the error term with a spatial weights matrix
using the invIrM function in the spdep package.

Besides being described in the spedep package reference manual, the
invIrM function is used in Luc Anselin's "Spatial Regression Analysis in
R, A Workbook" which can be found at:
http://www.sal.uiuc.edu/stuff/stuff-sum/tutorials

I'm not sure if this is exactly what you're looking for, but I would
appreciate any feedback about what you find useful that may influence my
work.

Thank you,

Terry




Terry W. Griffin

Graduate Research Assistant

Agricultural Economics - Purdue University

765-494-4257

http://web.ics.purdue.edu/~twgriffi/

 

 

-----Original Message-----
From: r-sig-geo-bounces at stat.math.ethz.ch
[mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of Sam Field
Sent: Friday, September 15, 2006 3:34 PM
To: r-sig-geo at stat.math.ethz.ch
Subject: [R-sig-Geo] Sampling from a SAR error model

List,

I am having trouble writing a script that samples from an SAR error
process. I've done it successfully for a spatial lag model, but not
for the spatial error model.  For the spatial lag model, I have the
following:

y_lag <- (solve(diag(100)- p*w))%*%X_mat%*%parms +
solve(diag(100)-p*w)%*%e

where parms is a parameter vector
X_mat is n by p matrix of independent variables (+ constant)
e is a vector of indepndent normal deviates (mean = 0)
p is the autoregressive paramter
and w is a square, n by n contiguity matrix (row normalized).

This works beautifully.  lagsarlm recovers parms and p without a
problem. Over repeated sampling, the estimated values are centered
on the value for p in the simulation.


Is there something wrong with the following for the spatial error
model?

y_error <- X_mat%*%parms + (solve(diag(100)-p*w))%*%e


The distribution of values for p obtain from errorsarlm over
repeated sampling are not centered around the value for the
simulation, but are typically much lower and all over the place.  I
have only looked at values for p ranging from .3 to .7.

any help would be greatly appreciated!



-- 
Samuel H. Field, Ph.D.
Associate Research Scholar
Institute for Social and Economic Research and Policy (ISERP)
Columbia University
420 W. 118th Street
Mail code 3355
New York, NY  10027
215-731-0106

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch
https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From sf2257 at columbia.edu  Sat Sep 16 17:48:46 2006
From: sf2257 at columbia.edu (Sam Field)
Date: Sat, 16 Sep 2006 11:48:46 -0400
Subject: [R-sig-Geo] Sampling from a SAR error model
Message-ID: <1158421726.450c1cdead252@cubmail.cc.columbia.edu>

Roger and Terry,

Thanks to both of you for your reply. Yes, sigma^2 enters into the
generation of e. The systematic component of the model,
X_mat%*%parms, has a variance of around 10^2.  e is typically
around 4^2, or...

e <- rnorm(n,mean=0,sd=4)


I went ahead and copied the code below (it isn't too long) - in case
others are interested in this exersise.  The car package is only
necessary for the n.bins function in the last lines of the code. So
it is optional.  I also tried the invIrM function suggested by
Terry.  It seems to produce the same results that I get.  It also
appears in the code below. Any help/suggestions would be greatly
appreciated.  I am stuck.



#creating data

library(spdep)
library(car)


#sample size
n <- 100





#coordinates

x_coord <- runif(n,0,10)
y_coord <- runif(n,0,10)


## w matrix and row normalized

w_raw <- matrix(nrow=length(x_coord),ncol=length(x_coord),1)

for(i in 1:length(x_coord)){for(j in 1:length(x_coord))
{w_raw[i,j]<- (sqrt((x_coord[i]-x_coord[j])^2 +
(y_coord[i]-y_coord[j])^2))}}


w_dummy <-  matrix(nrow=length(x_coord),ncol=length(x_coord),1)


#defines neighborhood distance

neighbor_dist <- 3

for(i in 1:length(x_coord)){for(j in 1:length(x_coord))
{if(w_raw[i,j] > neighbor_dist) w_dummy[i,j] <- 0}}

for(i in 1:length(x_coord)){for(j in 1:length(x_coord))
{if( i == j ) w_dummy[i,j] <- 0}}


row_sum <- rep(1,length(x_coord))
for(i in 1:length(x_coord))
	{row_sum[i] <- sum(w_dummy[i,]) }

w <- matrix(nrow=length(x_coord),ncol=length(x_coord),1)


# divide by row sums
for(i in 1:length(x_coord)){for(j in 1:length(x_coord))
	{w[i,j] <- w_dummy[i,j]/row_sum[i]}}



neighbors <- dnearneigh(cbind(x_coord,y_coord),0,neighbor_dist)
nb_list <- nb2listw(neighbors)

#create some independent variables
X1 <- rnorm(n,4,2)
X2 <- rnorm(n,2,2)
X3 <- rnorm(n,0,1)
X4 <- rnorm(n,13,3)
X5 <- rnorm(n,21,.5)
X_mat <- cbind(rep(1,n),X1,X2,X3,X4,X5)

# population parameters
parms <- c(12.4,2,-4,5,1,-.5)
rho <- .3



#begin iterations
n_iter <- 100  #draw 1500 samples of size n

estimates <- matrix(nrow=n_iter,ncol=7)
estimates2 <- matrix(nrow=n_iter,ncol=7)
estimates3 <- matrix(nrow=n_iter,ncol=7)


for(iter in 1:n_iter)
	{



e <- rnorm(n,mean=0,sd=4)


# drawing samples
y_lag <- (solve(diag(100)- rho*w))%*%X_mat%*%parms +
solve(diag(100)-rho*w)%*%e
y_error <- X_mat%*%parms + (solve(diag(100)-rho*w))%*%e
y_error2 <- X_mat%*%parms + invIrM(neighbors,.3)%*%e


lag_model <- lagsarlm(y_lag ~ X1 + X2 + X3 + X4 + X5,
listw=nb_list,type='lag')
lag_model2 <- errorsarlm(y_error ~ X1 + X2 + X3 + X4 + X5,
listw=nb_list)
lag_model3 <- errorsarlm(y_error2 ~ X1 + X2 + X3 + X4 + X5,
listw=nb_list)


# retrieve parameter estimates

estimates[iter,] <- coefficients(lag_model)
estimates2[iter,] <- coefficients(lag_model2)
estimates3[iter,] <- coefficients(lag_model3)
}



mean(estimates[,7])
hist(estimates[,7],nclass=n.bins(estimates[,7]),probability=TRUE)
lines(density(estimates[,7]),lwd=2)

mean(estimates2[,7])
hist(estimates2[,7],nclass=n.bins(estimates2[,7]),probability=TRUE)
lines(density(estimates2[,7]),lwd=2)

mean(estimates3[,7])
hist(estimates3[,7],nclass=n.bins(estimates3[,7]),probability=TRUE)
lines(density(estimates3[,7]),lwd=2)


#data <- data.frame(cbind(y_lag, y_error,
X1,X2,X3,X4,X5,x_coord,y_coord))
#names(data) <- c("y_lag","y_error",names(data)[3:9])
#write.table(data,file="C:/test.txt")








Quoting Roger Bivand <Roger.Bivand at nhh.no>:

> On Fri, 15 Sep 2006, Sam Field wrote:
>
> > List,
> >
> > I am having trouble writing a script that samples from an SAR
> error
> > process. I've done it successfully for a spatial lag model, but
> not
> > for the spatial error model.  For the spatial lag model, I have
> the
> > following:
> >
> > y_lag <- (solve(diag(100)- p*w))%*%X_mat%*%parms +
> > solve(diag(100)-p*w)%*%e
> >
> > where parms is a parameter vector
> > X_mat is n by p matrix of independent variables (+ constant)
> > e is a vector of indepndent normal deviates (mean = 0)
> > p is the autoregressive paramter
> > and w is a square, n by n contiguity matrix (row normalized).
> >
> > This works beautifully.  lagsarlm recovers parms and p without
> a
> > problem. Over repeated sampling, the estimated values are
> centered
> > on the value for p in the simulation.
> >
> >
> > Is there something wrong with the following for the spatial
> error
> > model?
> >
> > y_error <- X_mat%*%parms + (solve(diag(100)-p*w))%*%e
> >
>
> Interesting question. Where is the sigma^2 going in your case -
> is it in
> the generation of e? Could you try to use the columbus dataset
> and
> set.seed to generate a reproducible example - it may be that what
> you have
> written does not communicate exactly what you have done?
>
> Roger
>
> >
> > The distribution of values for p obtain from errorsarlm over
> > repeated sampling are not centered around the value for the
> > simulation, but are typically much lower and all over the
> place.  I
> > have only looked at values for p ranging from .3 to .7.
> >
> > any help would be greatly appreciated!
> >
> >
> >
> >
>
> --
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian
> School of
> Economics and Business Administration, Helleveien 30, N-5045
> Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
>


-- 
Samuel H. Field, Ph.D.
Associate Research Scholar
Institute for Social and Economic Research and Policy (ISERP)
Columbia University
420 W. 118th Street
Mail code 3355
New York, NY  10027
215-731-0106



From twgriffi at purdue.edu  Sun Sep 17 19:02:12 2006
From: twgriffi at purdue.edu (Griffin, Terry W)
Date: Sun, 17 Sep 2006 13:02:12 -0400
Subject: [R-sig-Geo] geoR likfit in simulation loop
In-Reply-To: <1158421726.450c1cdead252@cubmail.cc.columbia.edu>
References: <1158421726.450c1cdead252@cubmail.cc.columbia.edu>
Message-ID: <7740E1E6-09E3-4AA6-8B4F-2972BBA43A5E@mimectl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20060917/0d72a8cf/attachment.pl>

From tkobayas at indiana.edu  Tue Sep 19 01:30:15 2006
From: tkobayas at indiana.edu (Takatsugu Kobayashi)
Date: Mon, 18 Sep 2006 19:30:15 -0400
Subject: [R-sig-Geo] create a grid data
References: Pine.LNX.4.44.0608252233450.19440-100000@reclus.nhh.no
Message-ID: <450F2C07.7090605@indiana.edu>

Dear Dr. Bivand:

I do have both datasets. I will try interp() for an irregularly spaced data. 

On Fri, 25 Aug 2006 [EMAIL PROTECTED] wrote:

> Dear R users-
> 
> 
> I have a dataset that has X, Y and other values (Zs) attached to points 
> (X,Y). To show a map of this dataset, a matrix of Zs should be created 
> because I would like to use filled.contour function.

Do your x,y coordinates form a grid, or are they irregularly spaced? If 
so, you need to interpolate to a grid, for example using interp() in the 
akima package.

> 
> Is there any recommendation to go about this?
> 
> Thanks you very much
> 
> Taka
> R-2.3.1
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: [EMAIL PROTECTED]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch
https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From karl.sommer at dpi.vic.gov.au  Tue Sep 19 04:01:51 2006
From: karl.sommer at dpi.vic.gov.au (karl.sommer at dpi.vic.gov.au)
Date: Tue, 19 Sep 2006 12:01:51 +1000
Subject: [R-sig-Geo] spplot(), size of plotting symbol in legend
Message-ID: <OFD1CD9B5F.D03868AD-ONCA2571EE.000A0A96-CA2571EE.000B27D7@nre.vic.gov.au>

Hello list,

I was wondering if it were possible in spplot() to influence the size of
the plotting symbol appearing in the legend independently of the size of
the plotting symbol in the graph.
I have a situation where the symbol in the graph needs to be very small,
i.e. cex=0.1.  Consequently, the symbol appearing in the legend becomes
almost illegible. I need to make it bigger, independently of the symbol
size in the graph.

Thanks

Karl
_________________________________
Karl J Sommer,
Department of Primary Industries,
Catchment & Agriculture Services,
PO Box 905
Mildura, VIC, Australia 3502

Tel: +61 (0)3 5051 4390
Fax +61 (0)3 5051 4534

Email:     karl.sommer at dpi.vic.gov.au



From e.pebesma at geo.uu.nl  Tue Sep 19 08:51:09 2006
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Tue, 19 Sep 2006 08:51:09 +0200
Subject: [R-sig-Geo] spplot(), size of plotting symbol in legend
In-Reply-To: <OFD1CD9B5F.D03868AD-ONCA2571EE.000A0A96-CA2571EE.000B27D7@nre.vic.gov.au>
References: <OFD1CD9B5F.D03868AD-ONCA2571EE.000A0A96-CA2571EE.000B27D7@nre.vic.gov.au>
Message-ID: <450F935D.50301@geo.uu.nl>

Karl, I don't see an easy way for this, except by changing the code. 
Perhaps you could save the object the spplot returns (spplot basically 
wraps xyplot), and go in there.
--
Edzer

karl.sommer at dpi.vic.gov.au wrote:
> Hello list,
>
> I was wondering if it were possible in spplot() to influence the size of
> the plotting symbol appearing in the legend independently of the size of
> the plotting symbol in the graph.
> I have a situation where the symbol in the graph needs to be very small,
> i.e. cex=0.1.  Consequently, the symbol appearing in the legend becomes
> almost illegible. I need to make it bigger, independently of the symbol
> size in the graph.
>
> Thanks
>
> Karl
> _________________________________
> Karl J Sommer,
> Department of Primary Industries,
> Catchment & Agriculture Services,
> PO Box 905
> Mildura, VIC, Australia 3502
>
> Tel: +61 (0)3 5051 4390
> Fax +61 (0)3 5051 4534
>
> Email:     karl.sommer at dpi.vic.gov.au
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



From Roger.Bivand at nhh.no  Tue Sep 19 10:20:11 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 19 Sep 2006 10:20:11 +0200 (CEST)
Subject: [R-sig-Geo] Sampling from a SAR error model
In-Reply-To: <1158421726.450c1cdead252@cubmail.cc.columbia.edu>
Message-ID: <Pine.LNX.4.44.0609191005140.13705-100000@reclus.nhh.no>

Sam,

Indeed perplexing. I've tried to slim things down to:

library(spdep)
nsamp <- 100
rho <- 0.4
nb7rt <- cell2nb(7, 7, torus=TRUE)
set.seed(20060918)
e <- matrix(rnorm(nsamp*length(nb7rt)), nrow=length(nb7rt))
listw <- nb2listw(nb7rt)
invmat <- invIrW(listw, rho=rho)
y <- invmat %*% e
lag_res0 <- lapply(1:nsamp, function(i)
  lagsarlm(y[,i] ~ 1, listw=listw))
err_res0 <- lapply(1:nsamp, function(i)
  errorsarlm(y[,i] ~ 1, listw=listw))
summary(do.call("rbind", lapply(lag_res0, coefficients)))
summary(do.call("rbind", lapply(err_res0, coefficients)))

to just take the null models in both cases, where lambda == rho by 
definition, but the intercept term differs (I'm not sure how to insert 
autocorrelation into the intercept in the lag model, which is probably a 
source of error in the simulation.

I also had a look at Haining 1990 and the use of the Cholesky lower 
triangle of the SAR (simultaneous autoregressive) covariance matrix, and 
tried:

W <- listw2mat(listw)
Id <- diag(length(nb7rt))
sarcov <- solve(t(Id - rho*W) %*% (Id - rho*W))
sarcovL <- chol((sarcov + t(sarcov))/2)
y <- t(sarcovL) %*% e # Kaluzny et al. 1996, p. 160
lag_res1 <- lapply(1:nsamp, function(i)
  lagsarlm(y[,i] ~ 1, listw=listw))
err_res1 <- lapply(1:nsamp, function(i)
  errorsarlm(y[,i] ~ 1, listw=listw))
summary(do.call("rbind", lapply(lag_res1, coefficients)))
summary(do.call("rbind", lapply(err_res1, coefficients)))

which is similar to, but not the same as just premultiplying by 
(I - \rho W)^{-1}, and where I'm very unsure how to simulate for the lag 
model correctly. The error model simulation is, however, perhaps best done 
this way, isn't it? 

Running this shows that none of them retrieve the input coefficient value 
exactly. The weights here are about as well-behaved as possible, all 
observations have four (grid on a torus), and things perhaps get worse 
with less regular weights.

Simulating for the error model is discussed in the literature, but the lag 
model is something of an oddity, certainly worth sorting out.

Best wishes,

Roger


On Sat, 16 Sep 2006, Sam Field wrote:

> Roger and Terry,
> 
> Thanks to both of you for your reply. Yes, sigma^2 enters into the
> generation of e. The systematic component of the model,
> X_mat%*%parms, has a variance of around 10^2.  e is typically
> around 4^2, or...
> 
> e <- rnorm(n,mean=0,sd=4)
> 
> 
> I went ahead and copied the code below (it isn't too long) - in case
> others are interested in this exersise.  The car package is only
> necessary for the n.bins function in the last lines of the code. So
> it is optional.  I also tried the invIrM function suggested by
> Terry.  It seems to produce the same results that I get.  It also
> appears in the code below. Any help/suggestions would be greatly
> appreciated.  I am stuck.
> 
> 
> 
> #creating data
> 
> library(spdep)
> library(car)
> 
> 
> #sample size
> n <- 100
> 
> 
> 
> 
> 
> #coordinates
> 
> x_coord <- runif(n,0,10)
> y_coord <- runif(n,0,10)
> 
> 
> ## w matrix and row normalized
> 
> w_raw <- matrix(nrow=length(x_coord),ncol=length(x_coord),1)
> 
> for(i in 1:length(x_coord)){for(j in 1:length(x_coord))
> {w_raw[i,j]<- (sqrt((x_coord[i]-x_coord[j])^2 +
> (y_coord[i]-y_coord[j])^2))}}
> 
> 
> w_dummy <-  matrix(nrow=length(x_coord),ncol=length(x_coord),1)
> 
> 
> #defines neighborhood distance
> 
> neighbor_dist <- 3
> 
> for(i in 1:length(x_coord)){for(j in 1:length(x_coord))
> {if(w_raw[i,j] > neighbor_dist) w_dummy[i,j] <- 0}}
> 
> for(i in 1:length(x_coord)){for(j in 1:length(x_coord))
> {if( i == j ) w_dummy[i,j] <- 0}}
> 
> 
> row_sum <- rep(1,length(x_coord))
> for(i in 1:length(x_coord))
> 	{row_sum[i] <- sum(w_dummy[i,]) }
> 
> w <- matrix(nrow=length(x_coord),ncol=length(x_coord),1)
> 
> 
> # divide by row sums
> for(i in 1:length(x_coord)){for(j in 1:length(x_coord))
> 	{w[i,j] <- w_dummy[i,j]/row_sum[i]}}
> 
> 
> 
> neighbors <- dnearneigh(cbind(x_coord,y_coord),0,neighbor_dist)
> nb_list <- nb2listw(neighbors)
> 
> #create some independent variables
> X1 <- rnorm(n,4,2)
> X2 <- rnorm(n,2,2)
> X3 <- rnorm(n,0,1)
> X4 <- rnorm(n,13,3)
> X5 <- rnorm(n,21,.5)
> X_mat <- cbind(rep(1,n),X1,X2,X3,X4,X5)
> 
> # population parameters
> parms <- c(12.4,2,-4,5,1,-.5)
> rho <- .3
> 
> 
> 
> #begin iterations
> n_iter <- 100  #draw 1500 samples of size n
> 
> estimates <- matrix(nrow=n_iter,ncol=7)
> estimates2 <- matrix(nrow=n_iter,ncol=7)
> estimates3 <- matrix(nrow=n_iter,ncol=7)
> 
> 
> for(iter in 1:n_iter)
> 	{
> 
> 
> 
> e <- rnorm(n,mean=0,sd=4)
> 
> 
> # drawing samples
> y_lag <- (solve(diag(100)- rho*w))%*%X_mat%*%parms +
> solve(diag(100)-rho*w)%*%e
> y_error <- X_mat%*%parms + (solve(diag(100)-rho*w))%*%e
> y_error2 <- X_mat%*%parms + invIrM(neighbors,.3)%*%e
> 
> 
> lag_model <- lagsarlm(y_lag ~ X1 + X2 + X3 + X4 + X5,
> listw=nb_list,type='lag')
> lag_model2 <- errorsarlm(y_error ~ X1 + X2 + X3 + X4 + X5,
> listw=nb_list)
> lag_model3 <- errorsarlm(y_error2 ~ X1 + X2 + X3 + X4 + X5,
> listw=nb_list)
> 
> 
> # retrieve parameter estimates
> 
> estimates[iter,] <- coefficients(lag_model)
> estimates2[iter,] <- coefficients(lag_model2)
> estimates3[iter,] <- coefficients(lag_model3)
> }
> 
> 
> 
> mean(estimates[,7])
> hist(estimates[,7],nclass=n.bins(estimates[,7]),probability=TRUE)
> lines(density(estimates[,7]),lwd=2)
> 
> mean(estimates2[,7])
> hist(estimates2[,7],nclass=n.bins(estimates2[,7]),probability=TRUE)
> lines(density(estimates2[,7]),lwd=2)
> 
> mean(estimates3[,7])
> hist(estimates3[,7],nclass=n.bins(estimates3[,7]),probability=TRUE)
> lines(density(estimates3[,7]),lwd=2)
> 
> 
> #data <- data.frame(cbind(y_lag, y_error,
> X1,X2,X3,X4,X5,x_coord,y_coord))
> #names(data) <- c("y_lag","y_error",names(data)[3:9])
> #write.table(data,file="C:/test.txt")
> 
> 
> 
> 
> 
> 
> 
> 
> Quoting Roger Bivand <Roger.Bivand at nhh.no>:
> 
> > On Fri, 15 Sep 2006, Sam Field wrote:
> >
> > > List,
> > >
> > > I am having trouble writing a script that samples from an SAR
> > error
> > > process. I've done it successfully for a spatial lag model, but
> > not
> > > for the spatial error model.  For the spatial lag model, I have
> > the
> > > following:
> > >
> > > y_lag <- (solve(diag(100)- p*w))%*%X_mat%*%parms +
> > > solve(diag(100)-p*w)%*%e
> > >
> > > where parms is a parameter vector
> > > X_mat is n by p matrix of independent variables (+ constant)
> > > e is a vector of indepndent normal deviates (mean = 0)
> > > p is the autoregressive paramter
> > > and w is a square, n by n contiguity matrix (row normalized).
> > >
> > > This works beautifully.  lagsarlm recovers parms and p without
> > a
> > > problem. Over repeated sampling, the estimated values are
> > centered
> > > on the value for p in the simulation.
> > >
> > >
> > > Is there something wrong with the following for the spatial
> > error
> > > model?
> > >
> > > y_error <- X_mat%*%parms + (solve(diag(100)-p*w))%*%e
> > >
> >
> > Interesting question. Where is the sigma^2 going in your case -
> > is it in
> > the generation of e? Could you try to use the columbus dataset
> > and
> > set.seed to generate a reproducible example - it may be that what
> > you have
> > written does not communicate exactly what you have done?
> >
> > Roger
> >
> > >
> > > The distribution of values for p obtain from errorsarlm over
> > > repeated sampling are not centered around the value for the
> > > simulation, but are typically much lower and all over the
> > place.  I
> > > have only looked at values for p ranging from .3 to .7.
> > >
> > > any help would be greatly appreciated!
> > >
> > >
> > >
> > >
> >
> > --
> > Roger Bivand
> > Economic Geography Section, Department of Economics, Norwegian
> > School of
> > Economics and Business Administration, Helleveien 30, N-5045
> > Bergen,
> > Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> > e-mail: Roger.Bivand at nhh.no
> >
> >
> 
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From guis at teledetection.fr  Tue Sep 19 17:39:43 2006
From: guis at teledetection.fr (guis at teledetection.fr)
Date: Tue, 19 Sep 2006 11:39:43 -0400
Subject: [R-sig-Geo] Moran test on residuals of a logistic regression
Message-ID: <380-220069219153943859@M2W016.mail2web.com>

Hi

I have a logistic regression model, and I would like to see if the
residuals of this model are spatially autocorrelated. I saw that the
lm.morantest function could be used to test for autocorrelation in
residuals from a linear model (lm). Does a similar function exist for
residuals of a logistic regression models? (one of the arguments of the
lm.morantest is an lm object: x.lm)
I thought of extracting the residuals of my model (with the residuals
function) and then applying a moran.test, but I read that this wasn't
correct as there was no correction for the fact that these were residuals
(I didn't understand why). Is there a way to specify that the moran.test is
applied to residuals, making it possible to use this function in my case? 
I have a last question : if I extract residuals of the logistic models,
what type of residuals should I choose : deviance, pearson, working,
response, partial...?
I would be grateful for any help
Thanks

Helene Guis
PhD student CIRAD - University of Franche-Comt?, France.
guis at teledetection.fr

--------------------------------------------------------------------
mail2web - Check your email from the web at
http://mail2web.com/ .



From Roger.Bivand at nhh.no  Tue Sep 19 21:08:24 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 19 Sep 2006 21:08:24 +0200 (CEST)
Subject: [R-sig-Geo] Moran test on residuals of a logistic regression
In-Reply-To: <380-220069219153943859@M2W016.mail2web.com>
Message-ID: <Pine.LNX.4.44.0609192050110.14094-100000@reclus.nhh.no>

On Tue, 19 Sep 2006, guis at teledetection.fr wrote:

> Hi
> 
> I have a logistic regression model, and I would like to see if the
> residuals of this model are spatially autocorrelated. I saw that the
> lm.morantest function could be used to test for autocorrelation in
> residuals from a linear model (lm). Does a similar function exist for
> residuals of a logistic regression models? (one of the arguments of the
> lm.morantest is an lm object: x.lm)

No, it doesn't.

> I thought of extracting the residuals of my model (with the residuals
> function) and then applying a moran.test, but I read that this wasn't
> correct as there was no correction for the fact that these were residuals
> (I didn't understand why). 

The classic reference is Cliff and Ord (1981) p. 200, section 8.2.4, who 
point out that sample model residuals are correlated anyway, because they 
are estimated using the fitted regression coefficients. An alternative 
they also mention but discard is to test n-k independent BLUS residuals, 
chosen by dropping k spatial units. They also state that "random 
permutations are not the appropriate reference set for testing the 
residuals". So lm.morantest() or its Saddlepoint approximation equivalent 
are the only game in town for Moran's I of regression residuals. Of course 
I can be computed, but the basis for inference will most likely be 
unsound.

> Is there a way to specify that the moran.test is
> applied to residuals, making it possible to use this function in my case? 
> I have a last question : if I extract residuals of the logistic models,
> what type of residuals should I choose : deviance, pearson, working,
> response, partial...?

(All responsibility waived!!)

If you replace the test:

if(class(model) != "lm")

in lm.morantest()

with:

if(!inherits(model, "lm"))

lm.morantest() will "work" for some definition of work on glm objects 
using deviance residuals. Until somebody tests this properly, I would 
certainly not advise using the output for anything other than electron 
recycling.

Hope this helps,

Roger

> I would be grateful for any help
> Thanks
> 
> Helene Guis
> PhD student CIRAD - University of Franche-Comt?, France.
> guis at teledetection.fr
> 
> --------------------------------------------------------------------
> mail2web - Check your email from the web at
> http://mail2web.com/ .
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From karl.sommer at dpi.vic.gov.au  Wed Sep 20 05:54:29 2006
From: karl.sommer at dpi.vic.gov.au (karl.sommer at dpi.vic.gov.au)
Date: Wed, 20 Sep 2006 13:54:29 +1000
Subject: [R-sig-Geo] spplot(), size of plotting symbol in legend
Message-ID: <OF7D7DF1D6.78C3DBC1-ONCA2571EF.001496C6-CA2571EF.001577CE@nre.vic.gov.au>


Hi Edzer,

your suggestion worked well.  I saved the plot as an object named z1. In
the legend variable I found the settings for symbol size. In my case there
were 4 entries which I changed from 0.1 to 1
using the following statement.

z1$legend$inside$args$key$points$cex <- c(1,1,1,1)
plot(z1)

Regards

Karl



|---------+---------------------------->
|         |           e.pebesma at geo.uu.|
|         |           nl               |
|         |                            |
|         |           19/09/2006 16:51 |
|         |                            |
|---------+---------------------------->
  >------------------------------------------------------------------------------------------------------------------------------|
  |                                                                                                                              |
  |       To:       karl.sommer at dpi.vic.gov.au                                                                                   |
  |       cc:       r-sig-geo at stat.math.ethz.ch                                                                                  |
  |       Subject:  Re: [R-sig-Geo] spplot(), size of plotting symbol in legend                                                  |
  >------------------------------------------------------------------------------------------------------------------------------|




Karl, I don't see an easy way for this, except by changing the code.
Perhaps you could save the object the spplot returns (spplot basically
wraps xyplot), and go in there.
--
Edzer

karl.sommer at dpi.vic.gov.au wrote:
> Hello list,
>
> I was wondering if it were possible in spplot() to influence the size of
> the plotting symbol appearing in the legend independently of the size of
> the plotting symbol in the graph.
> I have a situation where the symbol in the graph needs to be very small,
> i.e. cex=0.1.  Consequently, the symbol appearing in the legend becomes
> almost illegible. I need to make it bigger, independently of the symbol
> size in the graph.
>
> Thanks
>
> Karl
> _________________________________
> Karl J Sommer,
> Department of Primary Industries,
> Catchment & Agriculture Services,
> PO Box 905
> Mildura, VIC, Australia 3502
>
> Tel: +61 (0)3 5051 4390
> Fax +61 (0)3 5051 4534
>
> Email:     karl.sommer at dpi.vic.gov.au
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



From sf2257 at columbia.edu  Thu Sep 21 21:39:05 2006
From: sf2257 at columbia.edu (Sam Field)
Date: Thu, 21 Sep 2006 15:39:05 -0400
Subject: [R-sig-Geo] Sampling from a SAR error model
Message-ID: <1158867545.4512ea5967aa2@cubmail.cc.columbia.edu>

Roger,

Thanks for the code.  Just now had time to get back to the problem.
Sorry it took so long.

you wrote,

> to just take the null models in both cases, where lambda == rho
> by
> definition, but the intercept term differs (I'm not sure how to
> insert
> autocorrelation into the intercept in the lag model, which is
> probably a
> source of error in the simulation.

I am a little confused by this statement.  I thought that the only
difference between the lag and error model is that in the error
model, spatial "spill overs" are restricted to the error term.  I
was thinking that lambda would always equal rho.  Not just in the
null model.  I was also thinking that the spatial lag model would
not be properly identified without at least on covariate, since
absent any variation in the systematic component of the model (Xb),
what would the spatial lag model mean? If you premultipy a vector of
constants by (I-pW)^-1, you just get back another vector of
constants.  A couple of other observations.

When the sample size in your example is increased, the lambda and
rho estimates are quite a bit closer to their simluated values.

I added a single covariate in your example, and the recovery of
labmda and rho preformed about as well as the null models.

Although your example didn't recover the simulated values exactly. 
They were close enough to make me think that there is something
funny about my example. So this is where I now turn.

thanks for your input!

Sam



Quoting Roger Bivand <Roger.Bivand at nhh.no>:

> Sam,
>
> Indeed perplexing. I've tried to slim things down to:
>
> library(spdep)
> nsamp <- 100
> rho <- 0.4
> nb7rt <- cell2nb(7, 7, torus=TRUE)
> set.seed(20060918)
> e <- matrix(rnorm(nsamp*length(nb7rt)), nrow=length(nb7rt))
> listw <- nb2listw(nb7rt)
> invmat <- invIrW(listw, rho=rho)
> y <- invmat %*% e
> lag_res0 <- lapply(1:nsamp, function(i)
>   lagsarlm(y[,i] ~ 1, listw=listw))
> err_res0 <- lapply(1:nsamp, function(i)
>   errorsarlm(y[,i] ~ 1, listw=listw))
> summary(do.call("rbind", lapply(lag_res0, coefficients)))
> summary(do.call("rbind", lapply(err_res0, coefficients)))
>
> to just take the null models in both cases, where lambda == rho
> by
> definition, but the intercept term differs (I'm not sure how to
> insert
> autocorrelation into the intercept in the lag model, which is
> probably a
> source of error in the simulation.
>
> I also had a look at Haining 1990 and the use of the Cholesky
> lower
> triangle of the SAR (simultaneous autoregressive) covariance
> matrix, and
> tried:
>
> W <- listw2mat(listw)
> Id <- diag(length(nb7rt))
> sarcov <- solve(t(Id - rho*W) %*% (Id - rho*W))
> sarcovL <- chol((sarcov + t(sarcov))/2)
> y <- t(sarcovL) %*% e # Kaluzny et al. 1996, p. 160
> lag_res1 <- lapply(1:nsamp, function(i)
>   lagsarlm(y[,i] ~ 1, listw=listw))
> err_res1 <- lapply(1:nsamp, function(i)
>   errorsarlm(y[,i] ~ 1, listw=listw))
> summary(do.call("rbind", lapply(lag_res1, coefficients)))
> summary(do.call("rbind", lapply(err_res1, coefficients)))
>
> which is similar to, but not the same as just premultiplying by
> (I - rho W)^{-1}, and where I'm very unsure how to simulate for
> the lag
> model correctly. The error model simulation is, however, perhaps
> best done
> this way, isn't it?
>
> Running this shows that none of them retrieve the input
> coefficient value
> exactly. The weights here are about as well-behaved as possible,
> all
> observations have four (grid on a torus), and things perhaps get
> worse
> with less regular weights.
>
> Simulating for the error model is discussed in the literature,
> but the lag
> model is something of an oddity, certainly worth sorting out.
>
> Best wishes,
>
> Roger
>
>
> On Sat, 16 Sep 2006, Sam Field wrote:
>
> > Roger and Terry,
> >
> > Thanks to both of you for your reply. Yes, sigma^2 enters into
> the
> > generation of e. The systematic component of the model,
> > X_mat%*%parms, has a variance of around 10^2.  e is typically
> > around 4^2, or...
> >
> > e <- rnorm(n,mean=0,sd=4)
> >
> >
> > I went ahead and copied the code below (it isn't too long) - in
> case
> > others are interested in this exersise.  The car package is
> only
> > necessary for the n.bins function in the last lines of the
> code. So
> > it is optional.  I also tried the invIrM function suggested by
> > Terry.  It seems to produce the same results that I get.  It
> also
> > appears in the code below. Any help/suggestions would be
> greatly
> > appreciated.  I am stuck.
> >
> >
> >
> > #creating data
> >
> > library(spdep)
> > library(car)
> >
> >
> > #sample size
> > n <- 100
> >
> >
> >
> >
> >
> > #coordinates
> >
> > x_coord <- runif(n,0,10)
> > y_coord <- runif(n,0,10)
> >
> >
> > ## w matrix and row normalized
> >
> > w_raw <- matrix(nrow=length(x_coord),ncol=length(x_coord),1)
> >
> > for(i in 1:length(x_coord)){for(j in 1:length(x_coord))
> > {w_raw[i,j]<- (sqrt((x_coord[i]-x_coord[j])^2 +
> > (y_coord[i]-y_coord[j])^2))}}
> >
> >
> > w_dummy <-  matrix(nrow=length(x_coord),ncol=length(x_coord),1)
> >
> >
> > #defines neighborhood distance
> >
> > neighbor_dist <- 3
> >
> > for(i in 1:length(x_coord)){for(j in 1:length(x_coord))
> > {if(w_raw[i,j] > neighbor_dist) w_dummy[i,j] <- 0}}
> >
> > for(i in 1:length(x_coord)){for(j in 1:length(x_coord))
> > {if( i == j ) w_dummy[i,j] <- 0}}
> >
> >
> > row_sum <- rep(1,length(x_coord))
> > for(i in 1:length(x_coord))
> > 	{row_sum[i] <- sum(w_dummy[i,]) }
> >
> > w <- matrix(nrow=length(x_coord),ncol=length(x_coord),1)
> >
> >
> > # divide by row sums
> > for(i in 1:length(x_coord)){for(j in 1:length(x_coord))
> > 	{w[i,j] <- w_dummy[i,j]/row_sum[i]}}
> >
> >
> >
> > neighbors <- dnearneigh(cbind(x_coord,y_coord),0,neighbor_dist)
> > nb_list <- nb2listw(neighbors)
> >
> > #create some independent variables
> > X1 <- rnorm(n,4,2)
> > X2 <- rnorm(n,2,2)
> > X3 <- rnorm(n,0,1)
> > X4 <- rnorm(n,13,3)
> > X5 <- rnorm(n,21,.5)
> > X_mat <- cbind(rep(1,n),X1,X2,X3,X4,X5)
> >
> > # population parameters
> > parms <- c(12.4,2,-4,5,1,-.5)
> > rho <- .3
> >
> >
> >
> > #begin iterations
> > n_iter <- 100  #draw 1500 samples of size n
> >
> > estimates <- matrix(nrow=n_iter,ncol=7)
> > estimates2 <- matrix(nrow=n_iter,ncol=7)
> > estimates3 <- matrix(nrow=n_iter,ncol=7)
> >
> >
> > for(iter in 1:n_iter)
> > 	{
> >
> >
> >
> > e <- rnorm(n,mean=0,sd=4)
> >
> >
> > # drawing samples
> > y_lag <- (solve(diag(100)- rho*w))%*%X_mat%*%parms +
> > solve(diag(100)-rho*w)%*%e
> > y_error <- X_mat%*%parms + (solve(diag(100)-rho*w))%*%e
> > y_error2 <- X_mat%*%parms + invIrM(neighbors,.3)%*%e
> >
> >
> > lag_model <- lagsarlm(y_lag ~ X1 + X2 + X3 + X4 + X5,
> > listw=nb_list,type='lag')
> > lag_model2 <- errorsarlm(y_error ~ X1 + X2 + X3 + X4 + X5,
> > listw=nb_list)
> > lag_model3 <- errorsarlm(y_error2 ~ X1 + X2 + X3 + X4 + X5,
> > listw=nb_list)
> >
> >
> > # retrieve parameter estimates
> >
> > estimates[iter,] <- coefficients(lag_model)
> > estimates2[iter,] <- coefficients(lag_model2)
> > estimates3[iter,] <- coefficients(lag_model3)
> > }
> >
> >
> >
> > mean(estimates[,7])
> >
> hist(estimates[,7],nclass=n.bins(estimates[,7]),probability=TRUE)
> > lines(density(estimates[,7]),lwd=2)
> >
> > mean(estimates2[,7])
> >
>
hist(estimates2[,7],nclass=n.bins(estimates2[,7]),probability=TRUE)
> > lines(density(estimates2[,7]),lwd=2)
> >
> > mean(estimates3[,7])
> >
>
hist(estimates3[,7],nclass=n.bins(estimates3[,7]),probability=TRUE)
> > lines(density(estimates3[,7]),lwd=2)
> >
> >
> > #data <- data.frame(cbind(y_lag, y_error,
> > X1,X2,X3,X4,X5,x_coord,y_coord))
> > #names(data) <- c("y_lag","y_error",names(data)[3:9])
> > #write.table(data,file="C:/test.txt")
> >
> >
> >
> >
> >
> >
> >
> >
> > Quoting Roger Bivand <Roger.Bivand at nhh.no>:
> >
> > > On Fri, 15 Sep 2006, Sam Field wrote:
> > >
> > > > List,
> > > >
> > > > I am having trouble writing a script that samples from an
> SAR
> > > error
> > > > process. I've done it successfully for a spatial lag model,
> but
> > > not
> > > > for the spatial error model.  For the spatial lag model, I
> have
> > > the
> > > > following:
> > > >
> > > > y_lag <- (solve(diag(100)- p*w))%*%X_mat%*%parms +
> > > > solve(diag(100)-p*w)%*%e
> > > >
> > > > where parms is a parameter vector
> > > > X_mat is n by p matrix of independent variables (+
> constant)
> > > > e is a vector of indepndent normal deviates (mean = 0)
> > > > p is the autoregressive paramter
> > > > and w is a square, n by n contiguity matrix (row
> normalized).
> > > >
> > > > This works beautifully.  lagsarlm recovers parms and p
> without
> > > a
> > > > problem. Over repeated sampling, the estimated values are
> > > centered
> > > > on the value for p in the simulation.
> > > >
> > > >
> > > > Is there something wrong with the following for the spatial
> > > error
> > > > model?
> > > >
> > > > y_error <- X_mat%*%parms + (solve(diag(100)-p*w))%*%e
> > > >
> > >
> > > Interesting question. Where is the sigma^2 going in your case
> -
> > > is it in
> > > the generation of e? Could you try to use the columbus
> dataset
> > > and
> > > set.seed to generate a reproducible example - it may be that
> what
> > > you have
> > > written does not communicate exactly what you have done?
> > >
> > > Roger
> > >
> > > >
> > > > The distribution of values for p obtain from errorsarlm
> over
> > > > repeated sampling are not centered around the value for the
> > > > simulation, but are typically much lower and all over the
> > > place.  I
> > > > have only looked at values for p ranging from .3 to .7.
> > > >
> > > > any help would be greatly appreciated!
> > > >
> > > >
> > > >
> > > >
> > >
> > > --
> > > Roger Bivand
> > > Economic Geography Section, Department of Economics,
> Norwegian
> > > School of
> > > Economics and Business Administration, Helleveien 30, N-5045
> > > Bergen,
> > > Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> > > e-mail: Roger.Bivand at nhh.no
> > >
> > >
> >
> >
> >
>
> --
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian
> School of
> Economics and Business Administration, Helleveien 30, N-5045
> Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
>


-- 
Samuel H. Field, Ph.D.
Associate Research Scholar
Institute for Social and Economic Research and Policy (ISERP)
Columbia University
420 W. 118th Street
Mail code 3355
New York, NY  10027
215-731-0106



From Roger.Bivand at nhh.no  Thu Sep 21 21:53:02 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 21 Sep 2006 21:53:02 +0200 (CEST)
Subject: [R-sig-Geo] Sampling from a SAR error model
In-Reply-To: <1158867545.4512ea5967aa2@cubmail.cc.columbia.edu>
Message-ID: <Pine.LNX.4.44.0609212149320.16395-100000@reclus.nhh.no>

On Thu, 21 Sep 2006, Sam Field wrote:

> Roger,
> 
> Thanks for the code.  Just now had time to get back to the problem.
> Sorry it took so long.
> 
> you wrote,
> 
> > to just take the null models in both cases, where lambda == rho
> > by
> > definition, but the intercept term differs (I'm not sure how to
> > insert
> > autocorrelation into the intercept in the lag model, which is
> > probably a
> > source of error in the simulation.
> 
> I am a little confused by this statement.  I thought that the only
> difference between the lag and error model is that in the error
> model, spatial "spill overs" are restricted to the error term.  I
> was thinking that lambda would always equal rho.  Not just in the
> null model.  I was also thinking that the spatial lag model would
> not be properly identified without at least on covariate, since
> absent any variation in the systematic component of the model (Xb),
> what would the spatial lag model mean? If you premultipy a vector of
> constants by (I-pW)^-1, you just get back another vector of
> constants.  

For row-standardised, yes, but not necessarily in other styles of 
weighting, so it is a bit picky. The code in the functions tries to 
accommodate that, following reports from users not using row 
standardisation.

> A couple of other observations. When the sample size in your example is
> increased, the lambda and rho estimates are quite a bit closer to their
> simluated values.
> 
> I added a single covariate in your example, and the recovery of
> labmda and rho preformed about as well as the null models.
> 
> Although your example didn't recover the simulated values exactly. 
> They were close enough to make me think that there is something
> funny about my example. So this is where I now turn.
> 

OK, that seems sensible. Please keep the list informed of where this takes 
you.

Best wishes,

Roger

> thanks for your input!
> 
> Sam
> 
> 
> 
> Quoting Roger Bivand <Roger.Bivand at nhh.no>:
> 
> > Sam,
> >
> > Indeed perplexing. I've tried to slim things down to:
> >
> > library(spdep)
> > nsamp <- 100
> > rho <- 0.4
> > nb7rt <- cell2nb(7, 7, torus=TRUE)
> > set.seed(20060918)
> > e <- matrix(rnorm(nsamp*length(nb7rt)), nrow=length(nb7rt))
> > listw <- nb2listw(nb7rt)
> > invmat <- invIrW(listw, rho=rho)
> > y <- invmat %*% e
> > lag_res0 <- lapply(1:nsamp, function(i)
> >   lagsarlm(y[,i] ~ 1, listw=listw))
> > err_res0 <- lapply(1:nsamp, function(i)
> >   errorsarlm(y[,i] ~ 1, listw=listw))
> > summary(do.call("rbind", lapply(lag_res0, coefficients)))
> > summary(do.call("rbind", lapply(err_res0, coefficients)))
> >
> > to just take the null models in both cases, where lambda == rho
> > by
> > definition, but the intercept term differs (I'm not sure how to
> > insert
> > autocorrelation into the intercept in the lag model, which is
> > probably a
> > source of error in the simulation.
> >
> > I also had a look at Haining 1990 and the use of the Cholesky
> > lower
> > triangle of the SAR (simultaneous autoregressive) covariance
> > matrix, and
> > tried:
> >
> > W <- listw2mat(listw)
> > Id <- diag(length(nb7rt))
> > sarcov <- solve(t(Id - rho*W) %*% (Id - rho*W))
> > sarcovL <- chol((sarcov + t(sarcov))/2)
> > y <- t(sarcovL) %*% e # Kaluzny et al. 1996, p. 160
> > lag_res1 <- lapply(1:nsamp, function(i)
> >   lagsarlm(y[,i] ~ 1, listw=listw))
> > err_res1 <- lapply(1:nsamp, function(i)
> >   errorsarlm(y[,i] ~ 1, listw=listw))
> > summary(do.call("rbind", lapply(lag_res1, coefficients)))
> > summary(do.call("rbind", lapply(err_res1, coefficients)))
> >
> > which is similar to, but not the same as just premultiplying by
> > (I - rho W)^{-1}, and where I'm very unsure how to simulate for
> > the lag
> > model correctly. The error model simulation is, however, perhaps
> > best done
> > this way, isn't it?
> >
> > Running this shows that none of them retrieve the input
> > coefficient value
> > exactly. The weights here are about as well-behaved as possible,
> > all
> > observations have four (grid on a torus), and things perhaps get
> > worse
> > with less regular weights.
> >
> > Simulating for the error model is discussed in the literature,
> > but the lag
> > model is something of an oddity, certainly worth sorting out.
> >
> > Best wishes,
> >
> > Roger
> >
> >
> > On Sat, 16 Sep 2006, Sam Field wrote:
> >
> > > Roger and Terry,
> > >
> > > Thanks to both of you for your reply. Yes, sigma^2 enters into
> > the
> > > generation of e. The systematic component of the model,
> > > X_mat%*%parms, has a variance of around 10^2.  e is typically
> > > around 4^2, or...
> > >
> > > e <- rnorm(n,mean=0,sd=4)
> > >
> > >
> > > I went ahead and copied the code below (it isn't too long) - in
> > case
> > > others are interested in this exersise.  The car package is
> > only
> > > necessary for the n.bins function in the last lines of the
> > code. So
> > > it is optional.  I also tried the invIrM function suggested by
> > > Terry.  It seems to produce the same results that I get.  It
> > also
> > > appears in the code below. Any help/suggestions would be
> > greatly
> > > appreciated.  I am stuck.
> > >
> > >
> > >
> > > #creating data
> > >
> > > library(spdep)
> > > library(car)
> > >
> > >
> > > #sample size
> > > n <- 100
> > >
> > >
> > >
> > >
> > >
> > > #coordinates
> > >
> > > x_coord <- runif(n,0,10)
> > > y_coord <- runif(n,0,10)
> > >
> > >
> > > ## w matrix and row normalized
> > >
> > > w_raw <- matrix(nrow=length(x_coord),ncol=length(x_coord),1)
> > >
> > > for(i in 1:length(x_coord)){for(j in 1:length(x_coord))
> > > {w_raw[i,j]<- (sqrt((x_coord[i]-x_coord[j])^2 +
> > > (y_coord[i]-y_coord[j])^2))}}
> > >
> > >
> > > w_dummy <-  matrix(nrow=length(x_coord),ncol=length(x_coord),1)
> > >
> > >
> > > #defines neighborhood distance
> > >
> > > neighbor_dist <- 3
> > >
> > > for(i in 1:length(x_coord)){for(j in 1:length(x_coord))
> > > {if(w_raw[i,j] > neighbor_dist) w_dummy[i,j] <- 0}}
> > >
> > > for(i in 1:length(x_coord)){for(j in 1:length(x_coord))
> > > {if( i == j ) w_dummy[i,j] <- 0}}
> > >
> > >
> > > row_sum <- rep(1,length(x_coord))
> > > for(i in 1:length(x_coord))
> > > 	{row_sum[i] <- sum(w_dummy[i,]) }
> > >
> > > w <- matrix(nrow=length(x_coord),ncol=length(x_coord),1)
> > >
> > >
> > > # divide by row sums
> > > for(i in 1:length(x_coord)){for(j in 1:length(x_coord))
> > > 	{w[i,j] <- w_dummy[i,j]/row_sum[i]}}
> > >
> > >
> > >
> > > neighbors <- dnearneigh(cbind(x_coord,y_coord),0,neighbor_dist)
> > > nb_list <- nb2listw(neighbors)
> > >
> > > #create some independent variables
> > > X1 <- rnorm(n,4,2)
> > > X2 <- rnorm(n,2,2)
> > > X3 <- rnorm(n,0,1)
> > > X4 <- rnorm(n,13,3)
> > > X5 <- rnorm(n,21,.5)
> > > X_mat <- cbind(rep(1,n),X1,X2,X3,X4,X5)
> > >
> > > # population parameters
> > > parms <- c(12.4,2,-4,5,1,-.5)
> > > rho <- .3
> > >
> > >
> > >
> > > #begin iterations
> > > n_iter <- 100  #draw 1500 samples of size n
> > >
> > > estimates <- matrix(nrow=n_iter,ncol=7)
> > > estimates2 <- matrix(nrow=n_iter,ncol=7)
> > > estimates3 <- matrix(nrow=n_iter,ncol=7)
> > >
> > >
> > > for(iter in 1:n_iter)
> > > 	{
> > >
> > >
> > >
> > > e <- rnorm(n,mean=0,sd=4)
> > >
> > >
> > > # drawing samples
> > > y_lag <- (solve(diag(100)- rho*w))%*%X_mat%*%parms +
> > > solve(diag(100)-rho*w)%*%e
> > > y_error <- X_mat%*%parms + (solve(diag(100)-rho*w))%*%e
> > > y_error2 <- X_mat%*%parms + invIrM(neighbors,.3)%*%e
> > >
> > >
> > > lag_model <- lagsarlm(y_lag ~ X1 + X2 + X3 + X4 + X5,
> > > listw=nb_list,type='lag')
> > > lag_model2 <- errorsarlm(y_error ~ X1 + X2 + X3 + X4 + X5,
> > > listw=nb_list)
> > > lag_model3 <- errorsarlm(y_error2 ~ X1 + X2 + X3 + X4 + X5,
> > > listw=nb_list)
> > >
> > >
> > > # retrieve parameter estimates
> > >
> > > estimates[iter,] <- coefficients(lag_model)
> > > estimates2[iter,] <- coefficients(lag_model2)
> > > estimates3[iter,] <- coefficients(lag_model3)
> > > }
> > >
> > >
> > >
> > > mean(estimates[,7])
> > >
> > hist(estimates[,7],nclass=n.bins(estimates[,7]),probability=TRUE)
> > > lines(density(estimates[,7]),lwd=2)
> > >
> > > mean(estimates2[,7])
> > >
> >
> hist(estimates2[,7],nclass=n.bins(estimates2[,7]),probability=TRUE)
> > > lines(density(estimates2[,7]),lwd=2)
> > >
> > > mean(estimates3[,7])
> > >
> >
> hist(estimates3[,7],nclass=n.bins(estimates3[,7]),probability=TRUE)
> > > lines(density(estimates3[,7]),lwd=2)
> > >
> > >
> > > #data <- data.frame(cbind(y_lag, y_error,
> > > X1,X2,X3,X4,X5,x_coord,y_coord))
> > > #names(data) <- c("y_lag","y_error",names(data)[3:9])
> > > #write.table(data,file="C:/test.txt")
> > >
> > >
> > >
> > >
> > >
> > >
> > >
> > >
> > > Quoting Roger Bivand <Roger.Bivand at nhh.no>:
> > >
> > > > On Fri, 15 Sep 2006, Sam Field wrote:
> > > >
> > > > > List,
> > > > >
> > > > > I am having trouble writing a script that samples from an
> > SAR
> > > > error
> > > > > process. I've done it successfully for a spatial lag model,
> > but
> > > > not
> > > > > for the spatial error model.  For the spatial lag model, I
> > have
> > > > the
> > > > > following:
> > > > >
> > > > > y_lag <- (solve(diag(100)- p*w))%*%X_mat%*%parms +
> > > > > solve(diag(100)-p*w)%*%e
> > > > >
> > > > > where parms is a parameter vector
> > > > > X_mat is n by p matrix of independent variables (+
> > constant)
> > > > > e is a vector of indepndent normal deviates (mean = 0)
> > > > > p is the autoregressive paramter
> > > > > and w is a square, n by n contiguity matrix (row
> > normalized).
> > > > >
> > > > > This works beautifully.  lagsarlm recovers parms and p
> > without
> > > > a
> > > > > problem. Over repeated sampling, the estimated values are
> > > > centered
> > > > > on the value for p in the simulation.
> > > > >
> > > > >
> > > > > Is there something wrong with the following for the spatial
> > > > error
> > > > > model?
> > > > >
> > > > > y_error <- X_mat%*%parms + (solve(diag(100)-p*w))%*%e
> > > > >
> > > >
> > > > Interesting question. Where is the sigma^2 going in your case
> > -
> > > > is it in
> > > > the generation of e? Could you try to use the columbus
> > dataset
> > > > and
> > > > set.seed to generate a reproducible example - it may be that
> > what
> > > > you have
> > > > written does not communicate exactly what you have done?
> > > >
> > > > Roger
> > > >
> > > > >
> > > > > The distribution of values for p obtain from errorsarlm
> > over
> > > > > repeated sampling are not centered around the value for the
> > > > > simulation, but are typically much lower and all over the
> > > > place.  I
> > > > > have only looked at values for p ranging from .3 to .7.
> > > > >
> > > > > any help would be greatly appreciated!
> > > > >
> > > > >
> > > > >
> > > > >
> > > >
> > > > --
> > > > Roger Bivand
> > > > Economic Geography Section, Department of Economics,
> > Norwegian
> > > > School of
> > > > Economics and Business Administration, Helleveien 30, N-5045
> > > > Bergen,
> > > > Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> > > > e-mail: Roger.Bivand at nhh.no
> > > >
> > > >
> > >
> > >
> > >
> >
> > --
> > Roger Bivand
> > Economic Geography Section, Department of Economics, Norwegian
> > School of
> > Economics and Business Administration, Helleveien 30, N-5045
> > Bergen,
> > Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> > e-mail: Roger.Bivand at nhh.no
> >
> >
> 
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Roger.Bivand at nhh.no  Fri Sep 22 21:03:45 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 22 Sep 2006 21:03:45 +0200 (CEST)
Subject: [R-sig-Geo] Markus Neteler Wins Sol Katz GFOSS Award
Message-ID: <Pine.LNX.4.44.0609222053130.30418-100000@reclus.nhh.no>

I'm very pleased to be able to pass on the excellent news that:

"During the closing plenary of the FOSS4G 2006 conference Markus Neteler 
was honored with the Sol Katz GFOSS Award for 2006. Markus is the leader 
of the GRASS GIS project, and has played a pivotal role in the 
revitalization of the project and it's community. Markus is also a 
founding member of OSGeo, and has been active in building the broader 
FOSS4G community for many years."

https://www.osgeo.org/servlets/NewsItemView?newsItemID=41

As members of this list will probably know, Markus has a sustained 
interest in GRASS/R integration, in addition to all the other things he 
manages to find time to do.

Congratulations!

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From sf2257 at columbia.edu  Fri Sep 22 22:11:45 2006
From: sf2257 at columbia.edu (Sam Field)
Date: Fri, 22 Sep 2006 16:11:45 -0400
Subject: [R-sig-Geo] zoom for edit.nb
Message-ID: <1158955905.451443814b5e2@cubmail.cc.columbia.edu>

Is there a way to zoom into a region on the map using the edit.nb
function.  I have tried the xlim and ylim arguments to no effect
(they work when ploting polylists).  This would be a great feature
for large maps.

thanks,

Sam


-- 
Samuel H. Field, Ph.D.
Associate Research Scholar
Institute for Social and Economic Research and Policy (ISERP)
Columbia University
420 W. 118th Street
Mail code 3355
New York, NY  10027
215-731-0106



From Roger.Bivand at nhh.no  Sat Sep 23 12:12:33 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 23 Sep 2006 12:12:33 +0200 (CEST)
Subject: [R-sig-Geo] zoom for edit.nb
In-Reply-To: <1158955905.451443814b5e2@cubmail.cc.columbia.edu>
Message-ID: <Pine.LNX.4.44.0609231212080.31075-100000@reclus.nhh.no>

On Fri, 22 Sep 2006, Sam Field wrote:

> Is there a way to zoom into a region on the map using the edit.nb
> function.  I have tried the xlim and ylim arguments to no effect
> (they work when ploting polylists).  This would be a great feature
> for large maps.

Sorry, no zoom, contributions welcome!

Roger

> 
> thanks,
> 
> Sam
> 
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From sf2257 at columbia.edu  Sat Sep 23 14:26:52 2006
From: sf2257 at columbia.edu (Sam Field)
Date: Sat, 23 Sep 2006 08:26:52 -0400
Subject: [R-sig-Geo] zoom for edit.nb
In-Reply-To: <Pine.LNX.4.44.0609231212080.31075-100000@reclus.nhh.no>
References: <Pine.LNX.4.44.0609231212080.31075-100000@reclus.nhh.no>
Message-ID: <1159014412.4515280c220a3@cubmail.cc.columbia.edu>

I might contribute something in the future, but I am new to R, so
what I do is pretty clunky.  I wrote a simple program last night
that does distant weighted lest squares estimation of spatial trend
(using kernel smoother) - described in Haining's 2003 text, p. 231. 
Not ready for prime time.  It is not a function and it uses a full
weight matrix, so it is very slow.  Perhaps this is already
available?   Seem like a handy tool, especially for looking for
preliminary evidence of trend in noisey data (i.e. residuals from a
regression).  It may be something that can already be accomplished
using a generic locally weighted regression function.






Quoting Roger Bivand <Roger.Bivand at nhh.no>:

> On Fri, 22 Sep 2006, Sam Field wrote:
>
> > Is there a way to zoom into a region on the map using the
> edit.nb
> > function.  I have tried the xlim and ylim arguments to no
> effect
> > (they work when ploting polylists).  This would be a great
> feature
> > for large maps.
>
> Sorry, no zoom, contributions welcome!
>
> Roger
>
> >
> > thanks,
> >
> > Sam
> >
> >
> >
>
> --
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian
> School of
> Economics and Business Administration, Helleveien 30, N-5045
> Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
>


-- 
Samuel H. Field, Ph.D.
Associate Research Scholar
Institute for Social and Economic Research and Policy (ISERP)
Columbia University
420 W. 118th Street
Mail code 3355
New York, NY  10027
215-731-0106



From borghor at yahoo.ca  Mon Sep 25 21:19:43 2006
From: borghor at yahoo.ca (bertrand toupin)
Date: Mon, 25 Sep 2006 15:19:43 -0400 (EDT)
Subject: [R-sig-Geo] RE : Mass conversions of Lat/Long to UTM (many zone)
In-Reply-To: <Pine.LNX.4.44.0608251823360.19440-100000@reclus.nhh.no>
Message-ID: <20060925191943.43823.qmail@web42202.mail.scd.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20060925/9b9865be/attachment.pl>

From Roger.Bivand at nhh.no  Mon Sep 25 21:31:31 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 25 Sep 2006 21:31:31 +0200 (CEST)
Subject: [R-sig-Geo] RE : Mass conversions of Lat/Long to UTM (many zone)
In-Reply-To: <20060925191943.43823.qmail@web42202.mail.scd.yahoo.com>
Message-ID: <Pine.LNX.4.44.0609252128360.27019-100000@reclus.nhh.no>

On Mon, 25 Sep 2006, bertrand toupin wrote:

> Hi!  It's me again.....  I've tried everything this morning and it seems to work perfectly.  so a big thank you to eberyone that answered.
> 
> However, I still have a last question regarding this matter.  You said :
> "+proj=laea +lat_0=45 +lon_0=-100 +x_0=0 +y_0=0 +a=6370997 +b=6370997 +units=m
> 
>  with some modification of +lat_0 and +lon_0 to suit your region."
> 
> So, my question : Should I chose approximatly the center of my database
> for lat_0 and long_0 ?
> 

That was what I was thinking, the US National Atlas values will be 
eccentric to your study area.

> Thanks!  I hope I posted this msg the correct way this time :)
> 

Yes, fine, thanks for helping with this!

Roger

> Roger Bivand <Roger.Bivand at nhh.no> wrote: On Fri, 25 Aug 2006, Philippe Roy wrote:
> 
> "Ok, so, in my kriging code, I need to specify a maximum distance in km
> (or meter can't remember).  Is this Lambert Azimuthal Equal Area good for
> Euclidian distance?  I mean, I need to specify the maximum distance to
> consider a station or not for each grid point of my regular grid.  Would
> that be good then?
> 
> Sorry if it sounds non-understandable! :/ "
> 
> (and using an HTML mailer - please do not, it makes thread management very 
> difficult!)
> 
> Have you tried? (Hint: the metric is meters/metres). Yes, you can give a
> maximum distance, otherwise the 2300 by 2300 martix of distances between
> stations is unnecessarily large (and it is unlikely that interactions
> across the whole region are strong).
>                          
> 
> 
> > 
> > -----Message d'origine-----
> > De : Roger Bivand [mailto:Roger.Bivand at nhh.no] 
> > Envoy? : 24 ao?t 2006 15:28
> > ? : Philippe Roy
> > Cc : r-sig-geo at stat.math.ethz.ch
> > Objet : Re: [R-sig-Geo] Mass conversions of Lat/Long to UTM (many zone)
> > 
> > On Thu, 24 Aug 2006, Philippe Roy wrote:
> > 
> > > Hi everyone!  I'm new to R.  I'll try using it for some Kriging.  My aim
> > > in the short-term is to convert my 2300 stations database from lat-long
> > > to UTM.  This network of stations goes from Virginia to the south, to
> > > Montr?al to the north, east coast to Michigan in the west.  So, I have a
> > > lot of UTM zones to consider.
> > > 
> > >  
> > > 
> > > Reading the archives, I've seen this formula to calculate the zones,
> > > based on lat-long coordinates :
> > > 
> > >  
> > > 
> > > UTM = floor((lon + 180) / 6) + 1
> > > 
> > >  
> > > 
> > > So, if I understand correctly, I need to run this formula on each
> > > station to get their zone, abnd then I use something like convUL ?
> > > 
> > 
> > If you want to use all the stations together, then they must be in the 
> > same zone (otherwise the western edge of the zone will jump for stations 
> > in different zones). I think that for continental North America a central 
> > UTM zone will not be a very good idea, and that probably a Lambert 
> > Azimuthal Equal Area is a better choice.
> > 
> > You can then use project() or spTransform() in the rgdal package, for 
> > example, with EPSG code 2163:
> > 
> > US National Atlas Equal Area
> > 
> > +proj=laea +lat_0=45 +lon_0=-100 +x_0=0 +y_0=0 +a=6370997 +b=6370997 +units=m
> > 
> > with some modification of +lat_0 and +lon_0 to suit your region.
> > 
> > > 
> > >  [[alternative HTML version deleted]]
> > > 
> > > 
> > 
> > 
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From pir2.jv at wanadoo.fr  Wed Sep 27 09:24:44 2006
From: pir2.jv at wanadoo.fr (pir2.jv)
Date: Wed, 27 Sep 2006 09:24:44 +0200
Subject: [R-sig-Geo] (no subject)
Message-ID: <96CA44EE-5849-46C0-BDC9-9E653E1EBBD9@wanadoo.fr>

I thinh spproj is not available for Mac Users ?


 > rSpatial = "http://r-spatial.sourceforge.net/R"
 > install.packages("spproj", repos=rSpatial)
Avis : unable to access index for repository http://r- 
spatial.sourceforge.net/R/bin/macosx/powerpc/contrib/2.3
Avis dans download.packages(pkgs, destdir = tmpd, available =  
available,  :
	 no package 'spproj' at the repositories
 >

Jacques Vernin



From e.pebesma at geo.uu.nl  Wed Sep 27 09:29:07 2006
From: e.pebesma at geo.uu.nl (Edzer J. Pebesma)
Date: Wed, 27 Sep 2006 09:29:07 +0200
Subject: [R-sig-Geo] (no subject)
In-Reply-To: <96CA44EE-5849-46C0-BDC9-9E653E1EBBD9@wanadoo.fr>
References: <96CA44EE-5849-46C0-BDC9-9E653E1EBBD9@wanadoo.fr>
Message-ID: <451A2843.4030709@geo.uu.nl>

Jacques,

the projection functions are now in package rgdal which is on CRAN so 
should have Mac binaries. Look for the function spTransform.

Also, an email I sent to you last night answering a question related to 
sp bounced; please resend the question to this list.
--
Edzer

pir2.jv wrote:
> I thinh spproj is not available for Mac Users ?
>
>
>  > rSpatial = "http://r-spatial.sourceforge.net/R"
>  > install.packages("spproj", repos=rSpatial)
> Avis : unable to access index for repository http://r- 
> spatial.sourceforge.net/R/bin/macosx/powerpc/contrib/2.3
> Avis dans download.packages(pkgs, destdir = tmpd, available =  
> available,  :
> 	 no package 'spproj' at the repositories
>  >
>
> Jacques Vernin
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



From Roger.Bivand at nhh.no  Wed Sep 27 09:59:28 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 27 Sep 2006 09:59:28 +0200 (CEST)
Subject: [R-sig-Geo] (no subject)
In-Reply-To: <451A2843.4030709@geo.uu.nl>
Message-ID: <Pine.LNX.4.44.0609270954030.28502-100000@reclus.nhh.no>

On Wed, 27 Sep 2006, Edzer J. Pebesma wrote:

> Jacques,
> 
> the projection functions are now in package rgdal which is on CRAN so 
> should have Mac binaries. Look for the function spTransform.
> 

Sorry, no automatic OSX binaries, because of dependence on external 
libraries PROJ.4 and GDAL. Mac OSX installation is carried out from the 
source package, details in the section of the Rgeo website describing 
rgdal:

http://www.sal.uiuc.edu/tools/tools-sum/rgeo/rgeo-detail/map-packages-on-cran

Thanks to Uwe Ligges, we have Windows binaries, but after discussions with 
the OSX maintainers, we found that with multiple architectures and 64/32 
bit issues, Mac OSX should be treated like Linux/Unix for rgdal - 
installed from source respecting the installed external dependencies.  

Roger

> Also, an email I sent to you last night answering a question related to 
> sp bounced; please resend the question to this list.
> --
> Edzer
> 
> pir2.jv wrote:
> > I thinh spproj is not available for Mac Users ?
> >
> >
> >  > rSpatial = "http://r-spatial.sourceforge.net/R"
> >  > install.packages("spproj", repos=rSpatial)
> > Avis : unable to access index for repository http://r- 
> > spatial.sourceforge.net/R/bin/macosx/powerpc/contrib/2.3
> > Avis dans download.packages(pkgs, destdir = tmpd, available =  
> > available,  :
> > 	 no package 'spproj' at the repositories
> >  >
> >
> > Jacques Vernin
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From horacio.samaniego at gmail.com  Wed Sep 27 17:31:18 2006
From: horacio.samaniego at gmail.com (Horacio Samaniego)
Date: Wed, 27 Sep 2006 09:31:18 -0600
Subject: [R-sig-Geo] contours of a SpatialPixelsDataFrame?
Message-ID: <DB117FAD-3529-4B6B-BD4D-E52D27BB1D36@unm.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20060927/772180a0/attachment.pl>

From Roger.Bivand at nhh.no  Wed Sep 27 17:51:07 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 27 Sep 2006 17:51:07 +0200 (CEST)
Subject: [R-sig-Geo] contours of a SpatialPixelsDataFrame?
In-Reply-To: <DB117FAD-3529-4B6B-BD4D-E52D27BB1D36@unm.edu>
Message-ID: <Pine.LNX.4.44.0609271735450.1314-100000@reclus.nhh.no>

On Wed, 27 Sep 2006, Horacio Samaniego wrote:

> I am unsure on how to deal with this... (this is usually easy on  
> grass), however cuz all me figs have been done in R I need to be  
> consistent.
> 
> The question is how to to get a contour plot from a  
> SpatialPixelsDataFrame.
> 
> So far I have generated I seem to be succesfully generating the plot  
> using :
>  >    contour(seq(-2423411.1,271933.9,length=674),seq 
> (248129.5,3239402.6,length=748),matrix(grPC at data$PC1,ncol=748))
> 
> but the plot seem to be upside down. It looks ok, but wen adding the  
> map lines with :
>  > plot(usaca,add=T)
> 
> I notice that only the 'y' axis is shifted.... a transformation of  
> the matrix won't do the trick.  So, I wonder is what the best  
> approach is for this. I tried making an image of it, but thinking  
> that  as.image.SpatialGridDataFrame will create a usable matrix don't  
> seem to be quite right
> 

No, because it creates the input list of x, y, z used by image() and 
contour - the z component is the matrix.

> anyhow, I hope that some more experienced user will be able to tell  
> me the correct way to do this,
> 
> thanks,
> 

It's not hard (from the example for image.SpatialGridDataFrame):

data(meuse.grid)
coordinates(meuse.grid) = c("x", "y")
gridded(meuse.grid) = TRUE
class(meuse.grid) # is a "SpatialPixelsDataFrame"
xyz <- as.image.SpatialGridDataFrame(meuse.grid["dist"]) # choose the 
                                          # variable you need
image(meuse.grid["dist"], axes=TRUE)
contour(xyz, add=TRUE)

(if you just do contour() on the matrix, the coordinates and aspect get 
blown away) and if you want the contours as a SpatialLinesDataFrame:

SLDF <- contourLines2SLDF(contourLines(xyz))
image(meuse.grid["dist"], axes=TRUE)
plot(SLDF, add=TRUE)

Roger

> 
> PD: here is the definition of my sp object:
> 
>  > str(grPC)
> Formal class 'SpatialPixelsDataFrame' [package "sp"] with 7 slots
>    ..@ data       :Formal class 'AttributeList' [package "sp"] with 1  
> slots
>    .. .. ..@ att:List of 6
>    .. .. .. ..$ PC1: num [1:504152] 0.299 0.301 0.302 0.303 0.305 ...
>    .. .. .. ..$ PC2: num [1:504152] -0.218 -0.219 -0.220 -0.220  
> -0.221 ...
>    .. .. .. ..$ PC3: num [1:504152] -0.0222 -0.0226 -0.0230 -0.0233  
> -0.0237 ...
>    .. .. .. ..$ PC4: num [1:504152] -0.0290 -0.0288 -0.0286 -0.0285  
> -0.0283 ...
>    .. .. .. ..$ PC5: num [1:504152] 0.0607 0.0608 0.0609 0.0610  
> 0.0611 ...
>    .. .. .. ..$ PC6: num [1:504152] 0.0681 0.0683 0.0685 0.0687  
> 0.0688 ...
>    ..@ coords.nrs : num(0)
>    ..@ grid       :Formal class 'GridTopology' [package "sp"] with 3  
> slots
>    .. .. ..@ cellcentre.offset: Named num [1:2] -2421412   250129
>    .. .. .. ..- attr(*, "names")= chr [1:2] "s1" "s2"
>    .. .. ..@ cellsize         : Named num [1:2] 3999 3999
>    .. .. .. ..- attr(*, "names")= chr [1:2] "s1" "s2"
>    .. .. ..@ cells.dim        : Named int [1:2] 674 748
>    .. .. .. ..- attr(*, "names")= chr [1:2] "s1" "s2"
>    ..@ grid.index : int [1:504152] 1 2 3 4 5 6 7 8 9 10 ...
>    ..@ coords     : num [1:504152, 1:2] -2421412 -2417413 -2413414  
> -2409414 -2405415 ...
>    .. ..- attr(*, "dimnames")=List of 2
>    .. .. ..$ : NULL
>    .. .. ..$ : chr [1:2] "s1" "s2"
>    ..@ bbox       : num [1:2, 1:2] -2423411   248130   271934  3239403
>    .. ..- attr(*, "dimnames")=List of 2
>    .. .. ..$ : chr [1:2] "s1" "s2"
>    .. .. ..$ : chr [1:2] "min" "max"
>    ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slots
>    .. .. ..@ projargs: chr NA
> 
> --
> Horacio Samaniego
> Dept. Biology
> University of New Mexico
> Albuquerque 87106, NM
> 
> http://www.unm.edu/~horacio
> 
> 
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From jahernan at umn.edu  Wed Sep 27 19:26:59 2006
From: jahernan at umn.edu (Jose A. Hernandez)
Date: Wed, 27 Sep 2006 12:26:59 -0500
Subject: [R-sig-Geo] Postdoctoral Research Fellow: spatio-temporal analysis
Message-ID: <451AB463.5040301@umn.edu>

Postdoctoral Research Fellow

Job description:

?Methods of spatio-temporal analysis of landscape variability? The 
position is to be filled as soon as possible. The successful applicant 
will develop new methods for analysing spatio-temporal variability in 
agricultural landscapes and apply these methods within ongoing ZALF 
research projects. Using (geo-)statistical and/or mathematical 
approaches (e.g., wavelet analysis), space-time structures of different 
landscape compartments (soil, vegetation, land use pattern etc.) have to 
be analysed based on data provided by non-invasive methods. For this 
purpose, high resolution digital elevation models, remote sensing data 
as well as geophysical information will be used. Procedures of multidata 
fusion should also be developed. In addition, the researcher will 
contribute with statistical consulting activities to other research 
projects.

For more information go to: http://www.pedometrics.org/jobs.asp?id=20



-- 
Jose A. Hernandez
Precision Agriculture Center
Department of Soil, Water, and Climate
University of Minnesota
1991 Upper Buford Circle
St. Paul, MN 55108

Ph. +1 (612) 625-0445, Fax. +1 (612) 625-2208



From hi_ono2001 at yahoo.co.jp  Thu Sep 28 06:44:24 2006
From: hi_ono2001 at yahoo.co.jp (Hisaji ONO)
Date: Thu, 28 Sep 2006 13:44:24 +0900 (JST)
Subject: [R-sig-Geo] Considering "boundary effect" in spdep or spgwr
Message-ID: <20060928044424.90331.qmail@web10702.mail.bbt.yahoo.co.jp>

Hello.

 In some "geo-spatial analysis" text books & articles,
"boundary effect" was referred.

 For spatial weight matrix and its related statistical
methods, this issue is very important, I think.

 For this issue, I've looked for this in "spdep" and
"spgwr" in their "manual" pdf files, but no luck.

 Current version of these packages consider "boundary
effect"? 



 Regards.



From pir2.jv at wanadoo.fr  Thu Sep 28 08:57:08 2006
From: pir2.jv at wanadoo.fr (pir2.jv)
Date: Thu, 28 Sep 2006 08:57:08 +0200
Subject: [R-sig-Geo] nc in Rnews_2005-2.pdf
Message-ID: <661F15ED-41BD-4696-877C-6C2469DB8BB2@wanadoo.fr>

I read Rnews_2005-2.pdf  and I can't do the test.

For instance, on page 10:
maptools and sp are active,

 > fname = system.file("shapes/sids.shp",  package="maptools")
 > p4s = CRS("+proj=longlat +datum=NAD27")
 > nc = readShapePoly(fname, proj4string=p4s)
 >  plot(nc, axes = TRUE, col=grey(1-nc$SID79/57))
Erreur dans plot.window(xlim, ylim, log, asp, ...) :
	'xlim' n?cessite des valeurs finies
De plus : Warning messages:
1: aucun argument trouv? pour min ; Inf est renvoy?
2: aucun argument pour max ; -Inf est renvoy?
3: aucun argument trouv? pour min ; Inf est renvoy?
4: aucun argument pour max ; -Inf est renvoy?


How t resolve these problems ?
Thanks

JV
==============
nc is really a big thing !:
 > class(nc)
[1] "SpatialPolygonsDataFrame"
attr(,"package")
[1] "sp"


 > str(nc)
Formal class 'SpatialPolygonsDataFrame' [package "sp"] with 5 slots
   ..@ data       :`data.frame':	100 obs. of  14 variables:
   .. ..$ AREA     : num [1:100] 0.114 0.061 0.143 0.07 0.153 0.097  
0.062 0.091 0.118 0.124 ...
   .. ..$ PERIMETER: num [1:100] 1.44 1.23 1.63 2.97 2.21 ...
   .. ..$ CNTY_    : num [1:100] 1825 1827 1828 1831 1832 ...
   .. ..$ CNTY_ID  : num [1:100] 1825 1827 1828 1831 1832 ...
   .. ..$ NAME     : Factor w/ 100 levels "Alamance","Alexander",..:  
5 3 86 27 66 46 15 37 93 85 ...
   .. ..$ FIPS     : Factor w/ 100 levels "37001","37003",..: 5 3 86  
27 66 46 15 37 93 85 ...
   .. ..$ FIPSNO   : num [1:100] 37009 37005 37171 37053 37131 ...
   .. ..$ CRESS_ID : num [1:100] 5 3 86 27 66 46 15 37 93 85 ...
   .. ..$ BIR74    : num [1:100] 1091  487 3188  508 1421 ...
   .. ..$ SID74    : num [1:100] 1 0 5 1 9 7 0 0 4 1 ...
   .. ..$ NWBIR74  : num [1:100]   10   10  208  123 1066 ...
   .. ..$ BIR79    : num [1:100] 1364  542 3616  830 1606 ...
   .. ..$ SID79    : num [1:100] 0 3 6 2 3 5 2 2 2 5 ...
   .. ..$ NWBIR79  : num [1:100]   19   12  260  145 1197 ...
   .. ..- attr(*, "data_types")= chr [1:14] "N" "N" "N" "N" ...
   ..@ polygons   :List of 100
   .. ..$ :Formal class 'Polygons' [package "sp"] with 5 slots
   .. .. .. ..@ Polygons :List of 1
   .. .. .. .. ..$ :Formal class 'Polygon' [package "sp"] with 5 slots
   .. .. .. .. .. .. ..@ labpt  : num [1:2] -81.5  36.4
.. .. .. .. .. .. ..@ area   : num 0.114
   .. .. .. .. .. .. ..@ hole   : logi FALSE
   .. .. .. .. .. .. ..@ ringDir: int 1
   .. .. .. .. .. .. ..@ coords : num [1:27, 1:2] -81.5 -81.5 -81.6  
-81.6 -81.7 ...
   .. .. .. ..@ plotOrder: int 1
   .. .. .. ..@ labpt    : num [1:2] -81.5  36.4
   .. .. .. ..@ ID       : chr "0"
   .. .. .. ..@ area     : num 0.114


.......

.. ..$ :Formal class 'Polygons' [package "sp"] with 5 slots
   .. .. .. ..@ Polygons :List of 1
   .. .. .. .. ..$ :Formal class 'Polygon' [package "sp"] with 5 slots
   .. .. .. .. .. .. ..@ labpt  : num [1:2] -78.3  34.1
   .. .. .. .. .. .. ..@ area   : num 0.212
   .. .. .. .. .. .. ..@ hole   : logi FALSE
   .. .. .. .. .. .. ..@ ringDir: int 1
   .. .. .. .. .. .. ..@ coords : num [1:27, 1:2] -78.7 -78.6 -78.6  
-78.6 -78.6 ...
   .. .. .. ..@ plotOrder: int 1
   .. .. .. ..@ labpt    : num [1:2] -78.3  34.1
   .. .. .. ..@ ID       : chr "99"
   .. .. .. ..@ area     : num 0.212
   ..@ plotOrder  : int [1:100] 79 98 94 96 37 97 100 54 88 57 ...
   ..@ bbox       : num [1:2, 1:2] -84.3  33.9 -75.5  36.6
   .. ..- attr(*, "dimnames")=List of 2
   .. .. ..$ : chr [1:2] "r1" "r2"
   .. .. ..$ : chr [1:2] "min" "max"
   ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slots
   .. .. ..@ projargs: chr "+proj=longlat +datum=NAD27"

===================
I have:

 > nc at bbox
          min       max
r1 -84.32385 -75.45698
r2  33.88199  36.58965
=========================
nc$SID79
   [1]  0  3  6  2  3  5  2  2  2  5  2  5  4  4  6 17  4  7  1  0   
1  0  1  0
[25] 18 38 11  5  6 22  7  2  9  9  1  1 31  2  5  3  2  8 15  0  0   
5 12  3
[49] 13  8 11 21 18 13  8  1  4  2  4  6  8 23 10 21  7  5  5 35 20   
8  7  8
[73]  1 14  4 26  0  3  4  1  1 57  2  9  4  6  0  7  7  0 18 16 23  
26  4  5
[97]  3 17  9  6

=======================
 > str(nc at polygons[[100]])
Formal class 'Polygons' [package "sp"] with 5 slots
   ..@ Polygons :List of 1
   .. ..$ :Formal class 'Polygon' [package "sp"] with 5 slots
   .. .. .. ..@ labpt  : num [1:2] -78.3  34.1
   .. .. .. ..@ area   : num 0.212
   .. .. .. ..@ hole   : logi FALSE
   .. .. .. ..@ ringDir: int 1
   .. .. .. ..@ coords : num [1:27, 1:2] -78.7 -78.6 -78.6 -78.6  
-78.6 ...
   ..@ plotOrder: int 1
   ..@ labpt    : num [1:2] -78.3  34.1
   ..@ ID       : chr "99"
   ..@ area     : num 0.212


I tried:
 >  plot(nc at polygons[[100]], axes = TRUE, col=grey(1-nc$SID79/57))
Erreur dans plot.window(xlim, ylim, log, asp, ...) :
	'xlim' n?cessite des valeurs finies
De plus : Warning messages:
1: aucun argument trouv? pour min ; Inf est renvoy?
2: aucun argument pour max ; -Inf est renvoy?
3: aucun argument trouv? pour min ; Inf est renvoy?
4: aucun argument pour max ; -Inf est renvoy?

 > Xlim= c(-84,-75)
 > Ylim = c(33,37)

  plot(nc at polygons[[100]], axes = TRUE, col=grey(1-nc 
$SID79/57),xlim=Xlim,ylim=Ylim)
gives me no error, but a blank result, as:
 >  plot(nc, axes = TRUE, col=grey(1-nc$SID79/57),xlim=Xlim,ylim=Ylim)

I can't understand that:
 >  nc at polygons[[100]]
An object of class ?Polygons?
Slot "Polygons":
[[1]]
An object of class ?Polygon?
Slot "labpt":
[1] -78.25073  34.07663

Slot "area":
[1] 0.2116459

Slot "hole":
[1] FALSE

Slot "ringDir":
[1] 1

Slot "coords":
            [,1]     [,2]
[1,] -78.65572 33.94867
[2,] -78.63472 33.97798
[3,] -78.63027 34.01020
[4,] -78.58778 34.03061
[5,] -78.56343 34.05894
[6,] -78.54428 34.13416
[7,] -78.52724 34.15486
[8,] -78.49274 34.15850
[9,] -78.42543 34.13807
[10,] -78.36112 34.18672
[11,] -78.37357 34.20235
[12,] -78.26106 34.21526
[13,] -78.15479 34.36224
[14,] -78.13024 34.36412
[15,] -78.02592 34.32877
[16,] -78.01131 34.31261
[17,] -78.00702 34.28482
[18,] -77.99539 34.28280
[19,] -78.00022 34.26788
[20,] -77.98315 34.26168
[21,] -77.97528 34.24336
[22,] -77.96587 34.24229
[23,] -77.96073 34.18924
[24,] -77.95853 33.99258
[25,] -78.03481 33.91429
[26,] -78.57972 33.88199
[27,] -78.65572 33.94867



Slot "plotOrder":
[1] 1

Slot "labpt":
[1] -78.25073  34.07663

Slot "ID":
[1] "99"

Slot "area":
[1] 0.2116459

  and +++++++++++++++++++++++++++++

 >  nc at polygons[[100]]@area
[1] 0.2116459
 >  nc at polygons[[100]]@ID
[1] "99"
 >  nc at polygons[[100]]@labpt
[1] -78.25073  34.07663
 >  nc at polygons[[100]]@plotOrder
[1] 1

but:
 >  nc at polygons[[100]]@coords
Erreur : aucun slot de nom "coords" pour cet objet de la classe  
"Polygons"
 >  nc at polygons[[100]]@ringDir
Erreur : aucun slot de nom "ringDir" pour cet objet de la classe  
"Polygons"
 >  nc at polygons[[100]]@hole
Erreur : aucun slot de nom "hole" pour cet objet de la classe "Polygons"

What differences ?


Jacques Vernin



From mdsumner at utas.edu.au  Thu Sep 28 09:17:31 2006
From: mdsumner at utas.edu.au (Michael Sumner)
Date: Thu, 28 Sep 2006 17:17:31 +1000
Subject: [R-sig-Geo] nc in Rnews_2005-2.pdf
In-Reply-To: <661F15ED-41BD-4696-877C-6C2469DB8BB2@wanadoo.fr>
References: <661F15ED-41BD-4696-877C-6C2469DB8BB2@wanadoo.fr>
Message-ID: <451B770B.9070102@utas.edu.au>

This works for me.  Perhaps you don't have 'sp' loaded?  What does 
sessionInfo() show?

Cheers, Mike.

 library(maptools)

 fname = system.file("shapes/sids.shp",  package="maptools")
 p4s = CRS("+proj=longlat +datum=NAD27")
  nc = readShapePoly(fname, proj4string=p4s)
   plot(nc, axes = TRUE, col=grey(1-nc$SID79/57))
 detach(package:maptools)

   plot(nc, axes = TRUE, col=grey(1-nc$SID79/57))

sessionInfo()

Version 2.3.1 (2006-06-01)
i386-pc-mingw32

attached base packages:
[1] "methods"   "stats"     "graphics"  "grDevices" "utils"     "datasets"
[7] "base"    

other attached packages:
maptools       sp  foreign
"0.5-12" "0.8-16" "0.8-15"


> I read Rnews_2005-2.pdf  and I can't do the test.
>
> For instance, on page 10:
> maptools and sp are active,
>
>  > fname = system.file("shapes/sids.shp",  package="maptools")
>  > p4s = CRS("+proj=longlat +datum=NAD27")
>  > nc = readShapePoly(fname, proj4string=p4s)
>  >  plot(nc, axes = TRUE, col=grey(1-nc$SID79/57))
> Erreur dans plot.window(xlim, ylim, log, asp, ...) :
> 	'xlim' n?cessite des valeurs finies
> De plus : Warning messages:
> 1: aucun argument trouv? pour min ; Inf est renvoy?
> 2: aucun argument pour max ; -Inf est renvoy?
> 3: aucun argument trouv? pour min ; Inf est renvoy?
> 4: aucun argument pour max ; -Inf est renvoy?
>
>
> How t resolve these problems ?
> Thanks
>
> JV
> ==============



From pir2.jv at wanadoo.fr  Thu Sep 28 10:45:27 2006
From: pir2.jv at wanadoo.fr (pir2.jv)
Date: Thu, 28 Sep 2006 10:45:27 +0200
Subject: [R-sig-Geo] (no subject)
Message-ID: <87D1F563-77D9-4E7D-B085-7E3C62C4A624@wanadoo.fr>


I have a misfit whan I want to see the gallery:

demo(gallery)
......... all is OK at the beginning

but:



 > library(sp)

 > library(maptools)

 > nc2 <- readShapePoly(system.file("shapes/sids.shp",
     package = "maptools")[1], proj4string = CRS("+proj=longlat  
+datum=NAD27"))

 > plot(nc2)
Erreur dans plot.window(xlim, ylim, log, asp, ...) :
	'xlim' n?cessite des valeurs finies
De plus : Il y a eu 13 avis (utilisez warnings() pour les visionner)
  >
  > warnings()
Messages d'avis :
1: la condition a une longueur > 1 et seul le premier ?l?ment est  
utilis? in: if (x$x.scales$draw) {  ...
2: la condition a une longueur > 1 et seul le premier ?l?ment est  
utilis? in: if (x$y.scales$draw) {  ...
3: la condition a une longueur > 1 et seul le premier ?l?ment est  
utilis? in: if (x$x.scales$draw) {  ...
4: la condition a une longueur > 1 et seul le premier ?l?ment est  
utilis? in: if (x$y.scales$draw) {  ...
5: la condition a une longueur > 1 et seul le premier ?l?ment est  
utilis? in: if (x$x.scales$draw) {  ...
6: la condition a une longueur > 1 et seul le premier ?l?ment est  
utilis? in: if (x$y.scales$draw) {  ...
7: la condition a une longueur > 1 et seul le premier ?l?ment est  
utilis? in: if (x$x.scales$draw) {  ...
8: la condition a une longueur > 1 et seul le premier ?l?ment est  
utilis? in: if (x$y.scales$draw) {  ...
9: la condition a une longueur > 1 et seul le premier ?l?ment est  
utilis? in: if (do.log) {  ...
10: aucun argument trouv? pour min ; Inf est renvoy?
11: aucun argument pour max ; -Inf est renvoy?
12: aucun argument trouv? pour min ; Inf est renvoy?
13: aucun argument pour max ; -Inf est renvoy?

When I see session info:
 > sessionInfo()
Version 2.3.1 (2006-06-01)
powerpc-apple-darwin8.6.0

attached base packages:
[1] "methods"   "stats"     "graphics"  "grDevices" "utils"      
"datasets"
[7] "base"

other attached packages:
maptools  lattice       sp    gstat  foreign
"0.5-15" "0.13-8" "0.8-20" "0.9-33" "0.8-15"



Best regards
Jacques Vernin



From Roger.Bivand at nhh.no  Thu Sep 28 11:03:04 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 28 Sep 2006 11:03:04 +0200 (CEST)
Subject: [R-sig-Geo] (no subject)
In-Reply-To: <87D1F563-77D9-4E7D-B085-7E3C62C4A624@wanadoo.fr>
Message-ID: <Pine.LNX.4.44.0609281059400.1994-100000@reclus.nhh.no>

On Thu, 28 Sep 2006, pir2.jv wrote:

> 
> I have a misfit whan I want to see the gallery:
> 
> demo(gallery)
> ......... all is OK at the beginning

Nothing is OK. You clearly have a malfunctioning system, at least one of 
the packages is wrongly installed. You have not included version 
information - the output of sessionInfo() at least. My guess is that you 
are running on Windows and have made some blunder in installing packages, 
but nobody can help you unless you give more *relevant* information since 
you have now asked the same question four times.

> 
> but:
> 
> 
> 
>  > library(sp)
> 
>  > library(maptools)
> 
>  > nc2 <- readShapePoly(system.file("shapes/sids.shp",
>      package = "maptools")[1], proj4string = CRS("+proj=longlat  
> +datum=NAD27"))
> 
>  > plot(nc2)
> Erreur dans plot.window(xlim, ylim, log, asp, ...) :
> 	'xlim' n?cessite des valeurs finies
> De plus : Il y a eu 13 avis (utilisez warnings() pour les visionner)
>   >
>   > warnings()
> Messages d'avis :
> 1: la condition a une longueur > 1 et seul le premier ?l?ment est  
> utilis? in: if (x$x.scales$draw) {  ...
> 2: la condition a une longueur > 1 et seul le premier ?l?ment est  
> utilis? in: if (x$y.scales$draw) {  ...
> 3: la condition a une longueur > 1 et seul le premier ?l?ment est  
> utilis? in: if (x$x.scales$draw) {  ...
> 4: la condition a une longueur > 1 et seul le premier ?l?ment est  
> utilis? in: if (x$y.scales$draw) {  ...
> 5: la condition a une longueur > 1 et seul le premier ?l?ment est  
> utilis? in: if (x$x.scales$draw) {  ...
> 6: la condition a une longueur > 1 et seul le premier ?l?ment est  
> utilis? in: if (x$y.scales$draw) {  ...
> 7: la condition a une longueur > 1 et seul le premier ?l?ment est  
> utilis? in: if (x$x.scales$draw) {  ...
> 8: la condition a une longueur > 1 et seul le premier ?l?ment est  
> utilis? in: if (x$y.scales$draw) {  ...
> 9: la condition a une longueur > 1 et seul le premier ?l?ment est  
> utilis? in: if (do.log) {  ...
> 10: aucun argument trouv? pour min ; Inf est renvoy?
> 11: aucun argument pour max ; -Inf est renvoy?
> 12: aucun argument trouv? pour min ; Inf est renvoy?
> 13: aucun argument pour max ; -Inf est renvoy?
> 
> When I see session info:
>  > sessionInfo()
> Version 2.3.1 (2006-06-01)
> powerpc-apple-darwin8.6.0
> 
> attached base packages:
> [1] "methods"   "stats"     "graphics"  "grDevices" "utils"      
> "datasets"
> [7] "base"
> 
> other attached packages:
> maptools  lattice       sp    gstat  foreign
> "0.5-15" "0.13-8" "0.8-20" "0.9-33" "0.8-15"
> 
> 
> 
> Best regards
> Jacques Vernin
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From p.hiemstra at geo.uu.nl  Thu Sep 28 11:12:23 2006
From: p.hiemstra at geo.uu.nl (Paul Hiemstra)
Date: Thu, 28 Sep 2006 11:12:23 +0200
Subject: [R-sig-Geo] loading GML files into R
Message-ID: <6.1.0.6.0.20060928110816.01a61b40@pop3.geo.uu.nl>

Dear All,

I am using sp and gstat to interpolate radiation data from the Dutch 
Radiation Monitoring Network. One of the goals of this project is to use 
inter operable data formats, in this case probably GML (Geography Markup 
Language). I have not found a package to parse GML files directly into R. 
Is anyone aware of a way to read GML files into R?

regards,

Paul Hiemstra
University of Utrecht



From Roger.Bivand at nhh.no  Thu Sep 28 11:28:30 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 28 Sep 2006 11:28:30 +0200 (CEST)
Subject: [R-sig-Geo] loading GML files into R
In-Reply-To: <6.1.0.6.0.20060928110816.01a61b40@pop3.geo.uu.nl>
Message-ID: <Pine.LNX.4.44.0609281124140.1994-100000@reclus.nhh.no>

On Thu, 28 Sep 2006, Paul Hiemstra wrote:

> Dear All,
> 
> I am using sp and gstat to interpolate radiation data from the Dutch 
> Radiation Monitoring Network. One of the goals of this project is to use 
> inter operable data formats, in this case probably GML (Geography Markup 
> Language). I have not found a package to parse GML files directly into R. 
> Is anyone aware of a way to read GML files into R?

(Assuming GML vector data)

Which platform are you on? If Linux/Unix/OSX, install GDAL with support in
OGR for GML vector files, and use the rgdal package; this should work, but
needs care in installing Xerces and other libraries. If Windows, use the
binary rgdal package on CRAN to read a file converted from GML to one of
the small range of drivers available - for example using the FWTools suite
of Windows binaries - see ogrinfo and ogr2ogr in that suite.

Roger

> 
> regards,
> 
> Paul Hiemstra
> University of Utrecht
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From p.hiemstra at geo.uu.nl  Thu Sep 28 11:54:14 2006
From: p.hiemstra at geo.uu.nl (Paul Hiemstra)
Date: Thu, 28 Sep 2006 11:54:14 +0200
Subject: [R-sig-Geo] loading GML files into R
In-Reply-To: <Pine.LNX.4.44.0609281124140.1994-100000@reclus.nhh.no>
References: <6.1.0.6.0.20060928110816.01a61b40@pop3.geo.uu.nl>
	<Pine.LNX.4.44.0609281124140.1994-100000@reclus.nhh.no>
Message-ID: <6.1.0.6.0.20060928115055.01a6e328@pop3.geo.uu.nl>

I'm running Windows and the GML files will consist of point data.

Thank for the fast response :),

Paul

At 11:28 28-9-2006, you wrote:
>On Thu, 28 Sep 2006, Paul Hiemstra wrote:
>
> > Dear All,
> >
> > I am using sp and gstat to interpolate radiation data from the Dutch
> > Radiation Monitoring Network. One of the goals of this project is to use
> > inter operable data formats, in this case probably GML (Geography Markup
> > Language). I have not found a package to parse GML files directly into R.
> > Is anyone aware of a way to read GML files into R?
>
>(Assuming GML vector data)
>
>Which platform are you on? If Linux/Unix/OSX, install GDAL with support in
>OGR for GML vector files, and use the rgdal package; this should work, but
>needs care in installing Xerces and other libraries. If Windows, use the
>binary rgdal package on CRAN to read a file converted from GML to one of
>the small range of drivers available - for example using the FWTools suite
>of Windows binaries - see ogrinfo and ogr2ogr in that suite.
>
>Roger
>
> >
> > regards,
> >
> > Paul Hiemstra
> > University of Utrecht
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
>--
>Roger Bivand
>Economic Geography Section, Department of Economics, Norwegian School of
>Economics and Business Administration, Helleveien 30, N-5045 Bergen,
>Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
>e-mail: Roger.Bivand at nhh.no



From Roger.Bivand at nhh.no  Thu Sep 28 12:13:09 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 28 Sep 2006 12:13:09 +0200 (CEST)
Subject: [R-sig-Geo] (no subject)
In-Reply-To: <044C1C75-00D6-48E7-881F-6CC3B07DBDAF@wanadoo.fr>
Message-ID: <Pine.LNX.4.44.0609281203270.1994-100000@reclus.nhh.no>

(Reverting to list)

On Thu, 28 Sep 2006, pir2.jv wrote:

> 
> Le 28 sept. 06 ?? 11:03, Roger Bivand a ??crit :
> 
> > On Thu, 28 Sep 2006, pir2.jv wrote:
> >
> >>
> >> I have a misfit whan I want to see the gallery:
> >>
> >> demo(gallery)
> >> ......... all is OK at the beginning
> >
> > Nothing is OK.
> I mean that the developpment seems to be the good one.
> > You clearly have a malfunctioning system, at least one of
> > the packages is wrongly installed. You have not included version
> > information - the output of sessionInfo() at least
> 
> I do not understand:
>  > sessionInfo()
> Version 2.3.1 (2006-06-01)
> powerpc-apple-darwin8.6.0
> 
> attached base packages:
> [1] "methods"   "stats"     "graphics"  "grDevices" "utils"      
> "datasets"
> [7] "base"
> 
> other attached packages:
> maptools  lattice       sp    gstat  foreign
> "0.5-15" "0.13-8" "0.8-20" "0.9-33" "0.8-15"
> 
> 
> > . My guess is that you
> > are running on Windows
> powerpc-apple-darwin8.6.0
> Mac OS 10.4.7

So possibly there is an endian issue, or a contaminated shapefile.

In a fresh R session, please do:

library(maptools)
sessionInfo()
fn <- system.file("shapes/sids.shp", package="maptools")[1]
file.info(fn)
xx <- readShapePoly(fn, proj4string=CRS("+proj=longlat +ellps=clrk66"))
class(xx)
bbox(xx)
summary(xx)

and post the output to the list?

(Keeping discussions on the list is vital to accumulating shared knowledge 
- a maxim of open source is that the difficulty of solving problems is 
inversely proportional to the number of eyes seeing them)

> 
> > and have made some blunder
> blunder |??bl??nd??r| |??bl??nd??r| |??bl??nd??|
> noun
> a stupid or careless mistake.
> stupid: perhaps, probably
> careless: no

Well, yes, no information on platform and package versions isn't careful.

> 
> > in installing packages,
> 
> > but nobody can help you unless you give more *relevant* information
> I don't understand what you mean by *relevant* information. I tried  
> to load maptools and sp again. The results are:
> +++++++++++++++++++++++++++++++++++++++++++++++ FOR MAPTOOLS
> essai de l'URL 'http://cran.univ-lyon1.fr/bin/macosx/powerpc/contrib/ 
> 2.3/maptools_0.5-15.tgz'
> Content type 'application/x-tar' length 279674 bytes
> URL ouverte
> ==================================================
> downloaded 273Kb
> 
> 
> The downloaded packages are in
> 	/tmp/RtmpyYsU1Y/downloaded_packages
> 
> 
> ++++++++++++++++++++++++++++++++++++++++++++++++++ FOR SP
> essai de l'URL 'http://cran.univ-lyon1.fr/bin/macosx/powerpc/contrib/ 
> 2.3/sp_0.8-20.tgz'
> Content type 'application/x-tar' length 474239 bytes
> URL ouverte
> ==================================================
> downloaded 463Kb
> 
> 
> The downloaded packages are in
> 	/tmp/RtmpyYsU1Y/downloaded_packages
> +++++++++++++++++++++++++++++++++++++++++++++++++++
> 
> > since
> > you have now asked the same question four times.
> I beg your indulgence.
> >
> 
> But, now, it is a new thing:
>  > sessionInfo()
> Version 2.3.1 (2006-06-01)
> powerpc-apple-darwin8.6.0
> 
> attached base packages:
> [1] "methods"   "stats"     "graphics"  "grDevices" "utils"      
> "datasets"
> [7] "base"
> 
> other attached packages:
> maptools  lattice       sp    gstat  foreign
> "0.5-15" "0.13-8" "0.8-20" "0.9-33" "0.8-15"
> Warning messages:
> 1: impossible de cr??er l'index HTML des packages in:  
> make.packages.html()
> 2: impossible de cr??er l'index HTML des packages in:  
> make.packages.html()
> 
> These warnings are new.
> 
> I know I am stupid, but I tried to see what is in /tmp/RtmpyYsU1Y/
> There are 2 files created today at the same time that the downloaded  
> packages.
> I tried to read them:

Please never do this, it will not help.

> 
>  > load("/private/tmp/RtmpyYsU1Y/libloc_%2fLibrary%2fFrameworks% 
> 2fR.framework%2fVersions%2f2.3%2fResources%2flibrary.rds")
> Erreur : mauvais num??ro magique de restauration de fichier (le  
> fichier est peut ??tre corrompu) -- aucune donn??e charg??e
>  > load("/private/tmp/RtmpyYsU1Y/repos_http%3a%2f%2fcran.univ-lyon1.fr 
> %2fbin%2fmacosx%2fpowerpc%2fcontrib%2f2.3.rds")
> Erreur : mauvais num??ro magique de restauration de fichier (le  
> fichier est peut ??tre corrompu) -- aucune donn??e charg??e
> 
> I don't know if there is a link.
> 
> 
> Jacques Vernin
> 
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Roger.Bivand at nhh.no  Thu Sep 28 12:14:58 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 28 Sep 2006 12:14:58 +0200 (CEST)
Subject: [R-sig-Geo] loading GML files into R
In-Reply-To: <6.1.0.6.0.20060928115055.01a6e328@pop3.geo.uu.nl>
Message-ID: <Pine.LNX.4.44.0609281213260.1994-100000@reclus.nhh.no>

On Thu, 28 Sep 2006, Paul Hiemstra wrote:

> I'm running Windows and the GML files will consist of point data.
> 
> Thank for the fast response :),

Please try the route through FWTools binaries for Windows, ogr2ogr, and 
let us know how you get on, I'm sure others will find your report useful. 
You should be able to call ogr2ogr through system() from within R if you 
need to.

Roger

> 
> Paul
> 
> At 11:28 28-9-2006, you wrote:
> >On Thu, 28 Sep 2006, Paul Hiemstra wrote:
> >
> > > Dear All,
> > >
> > > I am using sp and gstat to interpolate radiation data from the Dutch
> > > Radiation Monitoring Network. One of the goals of this project is to use
> > > inter operable data formats, in this case probably GML (Geography Markup
> > > Language). I have not found a package to parse GML files directly into R.
> > > Is anyone aware of a way to read GML files into R?
> >
> >(Assuming GML vector data)
> >
> >Which platform are you on? If Linux/Unix/OSX, install GDAL with support in
> >OGR for GML vector files, and use the rgdal package; this should work, but
> >needs care in installing Xerces and other libraries. If Windows, use the
> >binary rgdal package on CRAN to read a file converted from GML to one of
> >the small range of drivers available - for example using the FWTools suite
> >of Windows binaries - see ogrinfo and ogr2ogr in that suite.
> >
> >Roger
> >
> > >
> > > regards,
> > >
> > > Paul Hiemstra
> > > University of Utrecht
> > >
> > > _______________________________________________
> > > R-sig-Geo mailing list
> > > R-sig-Geo at stat.math.ethz.ch
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > >
> >
> >--
> >Roger Bivand
> >Economic Geography Section, Department of Economics, Norwegian School of
> >Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> >Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> >e-mail: Roger.Bivand at nhh.no
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From pir2.jv at wanadoo.fr  Thu Sep 28 12:56:59 2006
From: pir2.jv at wanadoo.fr (pir2.jv)
Date: Thu, 28 Sep 2006 12:56:59 +0200
Subject: [R-sig-Geo] (no subject)
In-Reply-To: <Pine.LNX.4.44.0609281203270.1994-100000@reclus.nhh.no>
References: <Pine.LNX.4.44.0609281203270.1994-100000@reclus.nhh.no>
Message-ID: <16E14A92-ABA6-4B9D-BDC2-BD63116DD50A@wanadoo.fr>


Le 28 sept. 06 ? 12:13, Roger Bivand a ?crit :

> (Reverting to list)
>
>
> So possibly there is an endian issue, or a contaminated shapefile.
>
> In a fresh R session, please do:
>
> library(maptools)
> sessionInfo()
> fn <- system.file("shapes/sids.shp", package="maptools")[1]
> file.info(fn)
> xx <- readShapePoly(fn, proj4string=CRS("+proj=longlat  
> +ellps=clrk66"))
> class(xx)
> bbox(xx)
> summary(xx)
>
> and post the output to the list?

 > load("/Users/jver/Desktop/HMP/.RData")
 > library(maptools)
Le chargement a n?cessit? le package : foreign
Le chargement a n?cessit? le package : sp

 > sessionInfo()
Version 2.3.1 (2006-06-01)
powerpc-apple-darwin8.6.0

attached base packages:
[1] "methods"   "stats"     "graphics"  "grDevices" "utils"      
"datasets"
[7] "base"

other attached packages:
maptools       sp  foreign
"0.5-15" "0.8-20" "0.8-15"

 > fn <- system.file("shapes/sids.shp", package="maptools")[1]
 > str(fn)
chr "/Library/Frameworks/R.framework/Versions/2.3/Resources/library/ 
maptools/shapes/sids.shp"


 > file.info(fn)
                                                                         
                   size
/Library/Frameworks/R.framework/Versions/2.3/Resources/library/ 
maptools/shapes/sids.shp 46196
                                                                         
                  isdir
/Library/Frameworks/R.framework/Versions/2.3/Resources/library/ 
maptools/shapes/sids.shp FALSE
                                                                         
                  mode
/Library/Frameworks/R.framework/Versions/2.3/Resources/library/ 
maptools/shapes/sids.shp  644
                                                                         
                                mtime
/Library/Frameworks/R.framework/Versions/2.3/Resources/library/ 
maptools/shapes/sids.shp 2006-09-23 10:15:57
                                                                         
                                ctime
/Library/Frameworks/R.framework/Versions/2.3/Resources/library/ 
maptools/shapes/sids.shp 2006-09-28 11:39:39
                                                                         
                                atime
/Library/Frameworks/R.framework/Versions/2.3/Resources/library/ 
maptools/shapes/sids.shp 2006-09-28 11:39:39
                                                                         
                  uid
/Library/Frameworks/R.framework/Versions/2.3/Resources/library/ 
maptools/shapes/sids.shp 501
                                                                         
                  gid
/Library/Frameworks/R.framework/Versions/2.3/Resources/library/ 
maptools/shapes/sids.shp  80
                                                                         
                  uname
/Library/Frameworks/R.framework/Versions/2.3/Resources/library/ 
maptools/shapes/sids.shp  jver
                                                                         
                  grname
/Library/Frameworks/R.framework/Versions/2.3/Resources/library/ 
maptools/shapes/sids.shp  admin

 > xx <- readShapePoly(fn, proj4string=CRS("+proj=longlat  
+ellps=clrk66"))
 > class(xx)
[1] "SpatialPolygonsDataFrame"
attr(,"package")
[1] "sp"
 > bbox(xx)
          min       max
r1 -84.32385 -75.45698
r2  33.88199  36.58965
 > summary(xx)
Object of class SpatialPolygonsDataFrame
Coordinates:
          min       max
r1 -84.32385 -75.45698
r2  33.88199  36.58965
Is projected: FALSE
proj4string : [+proj=longlat +ellps=clrk66]
Data attributes:
       AREA          PERIMETER         CNTY_          
CNTY_ID            NAME
Min.   :0.0420   Min.   :0.999   Min.   :1825   Min.   :1825    
Alamance : 1
1st Qu.:0.0910   1st Qu.:1.324   1st Qu.:1902   1st Qu.:1902    
Alexander: 1
Median :0.1205   Median :1.609   Median :1982   Median :1982    
Alleghany: 1
Mean   :0.1263   Mean   :1.673   Mean   :1986   Mean   :1986    
Anson    : 1
3rd Qu.:0.1542   3rd Qu.:1.859   3rd Qu.:2067   3rd Qu.:2067    
Ashe     : 1
Max.   :0.2410   Max.   :3.640   Max.   :2241   Max.   :2241    
Avery    : 1
                                                                  
(Other)  :94
       FIPS        FIPSNO         CRESS_ID          BIR74            
SID74
37001  : 1   Min.   :37001   Min.   :  1.00   Min.   :  248    
Min.   : 0.00
37003  : 1   1st Qu.:37050   1st Qu.: 25.75   1st Qu.: 1077   1st  
Qu.: 2.00
37005  : 1   Median :37100   Median : 50.50   Median : 2180    
Median : 4.00
37007  : 1   Mean   :37100   Mean   : 50.50   Mean   : 3300    
Mean   : 6.67
37009  : 1   3rd Qu.:37150   3rd Qu.: 75.25   3rd Qu.: 3936   3rd  
Qu.: 8.25
37011  : 1   Max.   :37199   Max.   :100.00   Max.   :21588   Max.   : 
44.00
(Other):94
     NWBIR74           BIR79           SID79          NWBIR79
Min.   :   1.0   Min.   :  319   Min.   : 0.00   Min.   :    3.0
1st Qu.: 190.0   1st Qu.: 1336   1st Qu.: 2.00   1st Qu.:  250.5
Median : 697.5   Median : 2636   Median : 5.00   Median :  874.5
Mean   :1050.8   Mean   : 4224   Mean   : 8.36   Mean   : 1352.8
3rd Qu.:1168.5   3rd Qu.: 4889   3rd Qu.:10.25   3rd Qu.: 1406.8
Max.   :8027.0   Max.   :30757   Max.   :57.00   Max.   :11631.0

>
>
>

Jacques Vernin



From Roger.Bivand at nhh.no  Thu Sep 28 13:09:24 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 28 Sep 2006 13:09:24 +0200 (CEST)
Subject: [R-sig-Geo] (no subject)
In-Reply-To: <16E14A92-ABA6-4B9D-BDC2-BD63116DD50A@wanadoo.fr>
Message-ID: <Pine.LNX.4.44.0609281305080.1994-100000@reclus.nhh.no>

On Thu, 28 Sep 2006, pir2.jv wrote:

> 
> Le 28 sept. 06 ? 12:13, Roger Bivand a ?crit :
> 
> > (Reverting to list)
> >
> >
> > So possibly there is an endian issue, or a contaminated shapefile.
> >
> > In a fresh R session, please do:
> >
> > library(maptools)
> > sessionInfo()
> > fn <- system.file("shapes/sids.shp", package="maptools")[1]
> > file.info(fn)
> > xx <- readShapePoly(fn, proj4string=CRS("+proj=longlat  
> > +ellps=clrk66"))
> > class(xx)
> > bbox(xx)
> > summary(xx)
> >
> > and post the output to the list?

OK, the file size at least looks correct, and the output of the summary 
looks good too. By the way, why the load()?

Could you now try plot(xx, axes=TRUE), and then traceback() immediately 
after the error occurs?

Roger

> 
>  > load("/Users/jver/Desktop/HMP/.RData")
>  > library(maptools)
> Le chargement a n?cessit? le package : foreign
> Le chargement a n?cessit? le package : sp
> 
>  > sessionInfo()
> Version 2.3.1 (2006-06-01)
> powerpc-apple-darwin8.6.0
> 
> attached base packages:
> [1] "methods"   "stats"     "graphics"  "grDevices" "utils"      
> "datasets"
> [7] "base"
> 
> other attached packages:
> maptools       sp  foreign
> "0.5-15" "0.8-20" "0.8-15"
> 
>  > fn <- system.file("shapes/sids.shp", package="maptools")[1]
>  > str(fn)
> chr "/Library/Frameworks/R.framework/Versions/2.3/Resources/library/ 
> maptools/shapes/sids.shp"
> 
> 
>  > file.info(fn)
>                                                                          
>                    size
> /Library/Frameworks/R.framework/Versions/2.3/Resources/library/ 
> maptools/shapes/sids.shp 46196
>                                                                          
>                   isdir
> /Library/Frameworks/R.framework/Versions/2.3/Resources/library/ 
> maptools/shapes/sids.shp FALSE
>                                                                          
>                   mode
> /Library/Frameworks/R.framework/Versions/2.3/Resources/library/ 
> maptools/shapes/sids.shp  644
>                                                                          
>                                 mtime
> /Library/Frameworks/R.framework/Versions/2.3/Resources/library/ 
> maptools/shapes/sids.shp 2006-09-23 10:15:57
>                                                                          
>                                 ctime
> /Library/Frameworks/R.framework/Versions/2.3/Resources/library/ 
> maptools/shapes/sids.shp 2006-09-28 11:39:39
>                                                                          
>                                 atime
> /Library/Frameworks/R.framework/Versions/2.3/Resources/library/ 
> maptools/shapes/sids.shp 2006-09-28 11:39:39
>                                                                          
>                   uid
> /Library/Frameworks/R.framework/Versions/2.3/Resources/library/ 
> maptools/shapes/sids.shp 501
>                                                                          
>                   gid
> /Library/Frameworks/R.framework/Versions/2.3/Resources/library/ 
> maptools/shapes/sids.shp  80
>                                                                          
>                   uname
> /Library/Frameworks/R.framework/Versions/2.3/Resources/library/ 
> maptools/shapes/sids.shp  jver
>                                                                          
>                   grname
> /Library/Frameworks/R.framework/Versions/2.3/Resources/library/ 
> maptools/shapes/sids.shp  admin
> 
>  > xx <- readShapePoly(fn, proj4string=CRS("+proj=longlat  
> +ellps=clrk66"))
>  > class(xx)
> [1] "SpatialPolygonsDataFrame"
> attr(,"package")
> [1] "sp"
>  > bbox(xx)
>           min       max
> r1 -84.32385 -75.45698
> r2  33.88199  36.58965
>  > summary(xx)
> Object of class SpatialPolygonsDataFrame
> Coordinates:
>           min       max
> r1 -84.32385 -75.45698
> r2  33.88199  36.58965
> Is projected: FALSE
> proj4string : [+proj=longlat +ellps=clrk66]
> Data attributes:
>        AREA          PERIMETER         CNTY_          
> CNTY_ID            NAME
> Min.   :0.0420   Min.   :0.999   Min.   :1825   Min.   :1825    
> Alamance : 1
> 1st Qu.:0.0910   1st Qu.:1.324   1st Qu.:1902   1st Qu.:1902    
> Alexander: 1
> Median :0.1205   Median :1.609   Median :1982   Median :1982    
> Alleghany: 1
> Mean   :0.1263   Mean   :1.673   Mean   :1986   Mean   :1986    
> Anson    : 1
> 3rd Qu.:0.1542   3rd Qu.:1.859   3rd Qu.:2067   3rd Qu.:2067    
> Ashe     : 1
> Max.   :0.2410   Max.   :3.640   Max.   :2241   Max.   :2241    
> Avery    : 1
>                                                                   
> (Other)  :94
>        FIPS        FIPSNO         CRESS_ID          BIR74            
> SID74
> 37001  : 1   Min.   :37001   Min.   :  1.00   Min.   :  248    
> Min.   : 0.00
> 37003  : 1   1st Qu.:37050   1st Qu.: 25.75   1st Qu.: 1077   1st  
> Qu.: 2.00
> 37005  : 1   Median :37100   Median : 50.50   Median : 2180    
> Median : 4.00
> 37007  : 1   Mean   :37100   Mean   : 50.50   Mean   : 3300    
> Mean   : 6.67
> 37009  : 1   3rd Qu.:37150   3rd Qu.: 75.25   3rd Qu.: 3936   3rd  
> Qu.: 8.25
> 37011  : 1   Max.   :37199   Max.   :100.00   Max.   :21588   Max.   : 
> 44.00
> (Other):94
>      NWBIR74           BIR79           SID79          NWBIR79
> Min.   :   1.0   Min.   :  319   Min.   : 0.00   Min.   :    3.0
> 1st Qu.: 190.0   1st Qu.: 1336   1st Qu.: 2.00   1st Qu.:  250.5
> Median : 697.5   Median : 2636   Median : 5.00   Median :  874.5
> Mean   :1050.8   Mean   : 4224   Mean   : 8.36   Mean   : 1352.8
> 3rd Qu.:1168.5   3rd Qu.: 4889   3rd Qu.:10.25   3rd Qu.: 1406.8
> Max.   :8027.0   Max.   :30757   Max.   :57.00   Max.   :11631.0
> 
> >
> >
> >
> 
> Jacques Vernin
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From pir2.jv at wanadoo.fr  Thu Sep 28 14:38:28 2006
From: pir2.jv at wanadoo.fr (pir2.jv)
Date: Thu, 28 Sep 2006 14:38:28 +0200
Subject: [R-sig-Geo] (no subject)
In-Reply-To: <Pine.LNX.4.44.0609281305080.1994-100000@reclus.nhh.no>
References: <Pine.LNX.4.44.0609281305080.1994-100000@reclus.nhh.no>
Message-ID: <7250552E-3968-42D6-AC0E-7B721434EF1A@wanadoo.fr>


Le 28 sept. 06 ? 13:09, Roger Bivand a ?crit :

>
> OK, the file size at least looks correct, and the output of the  
> summary
> looks good too. By the way, why the load()?

The load is the system response when I click the R.data in the  
project directory
>
> Could you now try plot(xx, axes=TRUE), and then traceback()  
> immediately
> after the error occurs?

 > plot(xx,axes=TRUE)
Erreur dans plot.window(xlim, ylim, log, asp, ...) :
	'xlim' n?cessite des valeurs finies
De plus : Warning messages:
1: aucun argument trouv? pour min ; Inf est renvoy?
2: aucun argument pour max ; -Inf est renvoy?
3: aucun argument trouv? pour min ; Inf est renvoy?
4: aucun argument pour max ; -Inf est renvoy?
 > traceback()
4: plot.window(...)
3: localWindow(xlim, ylim, log, asp, ...)
2: plot.default(xx, axes = TRUE)
1: plot(xx, axes = TRUE)

> ===============


If, I put:
 > Xlim
[1] -84 -75

 > Ylim
[1] 33 37
 > plot(xx,axes=TRUE,xlim=Xlim,ylim=Ylim)

give an empty image
========================
But;
spplot(xx,axes=TRUE) seems to product the good image.



Thanks

> Roger
>
>>
>>> load("/Users/jver/Desktop/HMP/.RData")
>>> library(maptools)
>> Le chargement a n?cessit? le package : foreign
>> Le chargement a n?cessit? le package : sp
>>
>>> sessionInfo()
>> Version 2.3.1 (2006-06-01)
>> powerpc-apple-darwin8.6.0
>>
>> attached base packages:
>> [1] "methods"   "stats"     "graphics"  "grDevices" "utils"
>> "datasets"
>> [7] "base"
>>
>> other attached packages:
>> maptools       sp  foreign
>> "0.5-15" "0.8-20" "0.8-15"
>>
>>> fn <- system.file("shapes/sids.shp", package="maptools")[1]
>>> str(fn)
>> chr "/Library/Frameworks/R.framework/Versions/2.3/Resources/library/
>> maptools/shapes/sids.shp"
>>
>>
>>> file.info(fn)
>>
>>                    size
>> /Library/Frameworks/R.framework/Versions/2.3/Resources/library/
>> maptools/shapes/sids.shp 46196
>>
>>                   isdir
>> /Library/Frameworks/R.framework/Versions/2.3/Resources/library/
>> maptools/shapes/sids.shp FALSE
>>
>>                   mode
>> /Library/Frameworks/R.framework/Versions/2.3/Resources/library/
>> maptools/shapes/sids.shp  644
>>
>>                                 mtime
>> /Library/Frameworks/R.framework/Versions/2.3/Resources/library/
>> maptools/shapes/sids.shp 2006-09-23 10:15:57
>>
>>                                 ctime
>> /Library/Frameworks/R.framework/Versions/2.3/Resources/library/
>> maptools/shapes/sids.shp 2006-09-28 11:39:39
>>
>>                                 atime
>> /Library/Frameworks/R.framework/Versions/2.3/Resources/library/
>> maptools/shapes/sids.shp 2006-09-28 11:39:39
>>
>>                   uid
>> /Library/Frameworks/R.framework/Versions/2.3/Resources/library/
>> maptools/shapes/sids.shp 501
>>
>>                   gid
>> /Library/Frameworks/R.framework/Versions/2.3/Resources/library/
>> maptools/shapes/sids.shp  80
>>
>>                   uname
>> /Library/Frameworks/R.framework/Versions/2.3/Resources/library/
>> maptools/shapes/sids.shp  jver
>>
>>                   grname
>> /Library/Frameworks/R.framework/Versions/2.3/Resources/library/
>> maptools/shapes/sids.shp  admin
>>
>>> xx <- readShapePoly(fn, proj4string=CRS("+proj=longlat
>> +ellps=clrk66"))
>>> class(xx)
>> [1] "SpatialPolygonsDataFrame"
>> attr(,"package")
>> [1] "sp"
>>> bbox(xx)
>>           min       max
>> r1 -84.32385 -75.45698
>> r2  33.88199  36.58965
>>> summary(xx)
>> Object of class SpatialPolygonsDataFrame
>> Coordinates:
>>           min       max
>> r1 -84.32385 -75.45698
>> r2  33.88199  36.58965
>> Is projected: FALSE
>> proj4string : [+proj=longlat +ellps=clrk66]
>> Data attributes:
>>        AREA          PERIMETER         CNTY_
>> CNTY_ID            NAME
>> Min.   :0.0420   Min.   :0.999   Min.   :1825   Min.   :1825
>> Alamance : 1
>> 1st Qu.:0.0910   1st Qu.:1.324   1st Qu.:1902   1st Qu.:1902
>> Alexander: 1
>> Median :0.1205   Median :1.609   Median :1982   Median :1982
>> Alleghany: 1
>> Mean   :0.1263   Mean   :1.673   Mean   :1986   Mean   :1986
>> Anson    : 1
>> 3rd Qu.:0.1542   3rd Qu.:1.859   3rd Qu.:2067   3rd Qu.:2067
>> Ashe     : 1
>> Max.   :0.2410   Max.   :3.640   Max.   :2241   Max.   :2241
>> Avery    : 1
>>
>> (Other)  :94
>>        FIPS        FIPSNO         CRESS_ID          BIR74
>> SID74
>> 37001  : 1   Min.   :37001   Min.   :  1.00   Min.   :  248
>> Min.   : 0.00
>> 37003  : 1   1st Qu.:37050   1st Qu.: 25.75   1st Qu.: 1077   1st
>> Qu.: 2.00
>> 37005  : 1   Median :37100   Median : 50.50   Median : 2180
>> Median : 4.00
>> 37007  : 1   Mean   :37100   Mean   : 50.50   Mean   : 3300
>> Mean   : 6.67
>> 37009  : 1   3rd Qu.:37150   3rd Qu.: 75.25   3rd Qu.: 3936   3rd
>> Qu.: 8.25
>> 37011  : 1   Max.   :37199   Max.   :100.00   Max.   :21588    
>> Max.   :
>> 44.00
>> (Other):94
>>      NWBIR74           BIR79           SID79          NWBIR79
>> Min.   :   1.0   Min.   :  319   Min.   : 0.00   Min.   :    3.0
>> 1st Qu.: 190.0   1st Qu.: 1336   1st Qu.: 2.00   1st Qu.:  250.5
>> Median : 697.5   Median : 2636   Median : 5.00   Median :  874.5
>> Mean   :1050.8   Mean   : 4224   Mean   : 8.36   Mean   : 1352.8
>> 3rd Qu.:1168.5   3rd Qu.: 4889   3rd Qu.:10.25   3rd Qu.: 1406.8
>> Max.   :8027.0   Max.   :30757   Max.   :57.00   Max.   :11631.0
>>
>>>
>

Jacques Vernin



From Roger.Bivand at nhh.no  Thu Sep 28 15:06:19 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 28 Sep 2006 15:06:19 +0200 (CEST)
Subject: [R-sig-Geo] (no subject)
In-Reply-To: <7250552E-3968-42D6-AC0E-7B721434EF1A@wanadoo.fr>
Message-ID: <Pine.LNX.4.44.0609281456390.1994-100000@reclus.nhh.no>

On Thu, 28 Sep 2006, pir2.jv wrote:

> 
> Le 28 sept. 06 ? 13:09, Roger Bivand a ?crit :
> 
> >
> > OK, the file size at least looks correct, and the output of the  
> > summary
> > looks good too. By the way, why the load()?
> 
> The load is the system response when I click the R.data in the  
> project directory

I think that this is the problem, and that you have an alternative local 
copy of plot that disturbs the method dispatch.

If you say ls(), do the names of any of the objects begin with plot?

> >
> > Could you now try plot(xx, axes=TRUE), and then traceback()  
> > immediately
> > after the error occurs?
> 
>  > plot(xx,axes=TRUE)
> Erreur dans plot.window(xlim, ylim, log, asp, ...) :
> 	'xlim' n?cessite des valeurs finies
> De plus : Warning messages:
> 1: aucun argument trouv? pour min ; Inf est renvoy?
> 2: aucun argument pour max ; -Inf est renvoy?
> 3: aucun argument trouv? pour min ; Inf est renvoy?
> 4: aucun argument pour max ; -Inf est renvoy?
>  > traceback()
> 4: plot.window(...)
> 3: localWindow(xlim, ylim, log, asp, ...)
> 2: plot.default(xx, axes = TRUE)
> 1: plot(xx, axes = TRUE)
> 

This is where it is going wrong. If you do:

is(xx)

you should see:

[1] "SpatialPolygonsDataFrame" "SpatialPolygons"         
[3] "Spatial"  

and method dispatch should choose plot.SpatialPolygons - can you try

plot.SpatialPolygons(xx, axes=TRUE)

directly. I'm fairly certain that the method dispatch of plot is getting 
interfered with, since the class of xx is OK.

Roger


> > ===============
> 
> 
> If, I put:
>  > Xlim
> [1] -84 -75
> 
>  > Ylim
> [1] 33 37
>  > plot(xx,axes=TRUE,xlim=Xlim,ylim=Ylim)
> 
> give an empty image
> ========================
> But;
> spplot(xx,axes=TRUE) seems to product the good image.
> 
> 
> 
> Thanks
> 
> > Roger
> >
> >>
> >>> load("/Users/jver/Desktop/HMP/.RData")
> >>> library(maptools)
> >> Le chargement a n?cessit? le package : foreign
> >> Le chargement a n?cessit? le package : sp
> >>
> >>> sessionInfo()
> >> Version 2.3.1 (2006-06-01)
> >> powerpc-apple-darwin8.6.0
> >>
> >> attached base packages:
> >> [1] "methods"   "stats"     "graphics"  "grDevices" "utils"
> >> "datasets"
> >> [7] "base"
> >>
> >> other attached packages:
> >> maptools       sp  foreign
> >> "0.5-15" "0.8-20" "0.8-15"
> >>
> >>> fn <- system.file("shapes/sids.shp", package="maptools")[1]
> >>> str(fn)
> >> chr "/Library/Frameworks/R.framework/Versions/2.3/Resources/library/
> >> maptools/shapes/sids.shp"
> >>
> >>
> >>> file.info(fn)
> >>
> >>                    size
> >> /Library/Frameworks/R.framework/Versions/2.3/Resources/library/
> >> maptools/shapes/sids.shp 46196
> >>
> >>                   isdir
> >> /Library/Frameworks/R.framework/Versions/2.3/Resources/library/
> >> maptools/shapes/sids.shp FALSE
> >>
> >>                   mode
> >> /Library/Frameworks/R.framework/Versions/2.3/Resources/library/
> >> maptools/shapes/sids.shp  644
> >>
> >>                                 mtime
> >> /Library/Frameworks/R.framework/Versions/2.3/Resources/library/
> >> maptools/shapes/sids.shp 2006-09-23 10:15:57
> >>
> >>                                 ctime
> >> /Library/Frameworks/R.framework/Versions/2.3/Resources/library/
> >> maptools/shapes/sids.shp 2006-09-28 11:39:39
> >>
> >>                                 atime
> >> /Library/Frameworks/R.framework/Versions/2.3/Resources/library/
> >> maptools/shapes/sids.shp 2006-09-28 11:39:39
> >>
> >>                   uid
> >> /Library/Frameworks/R.framework/Versions/2.3/Resources/library/
> >> maptools/shapes/sids.shp 501
> >>
> >>                   gid
> >> /Library/Frameworks/R.framework/Versions/2.3/Resources/library/
> >> maptools/shapes/sids.shp  80
> >>
> >>                   uname
> >> /Library/Frameworks/R.framework/Versions/2.3/Resources/library/
> >> maptools/shapes/sids.shp  jver
> >>
> >>                   grname
> >> /Library/Frameworks/R.framework/Versions/2.3/Resources/library/
> >> maptools/shapes/sids.shp  admin
> >>
> >>> xx <- readShapePoly(fn, proj4string=CRS("+proj=longlat
> >> +ellps=clrk66"))
> >>> class(xx)
> >> [1] "SpatialPolygonsDataFrame"
> >> attr(,"package")
> >> [1] "sp"
> >>> bbox(xx)
> >>           min       max
> >> r1 -84.32385 -75.45698
> >> r2  33.88199  36.58965
> >>> summary(xx)
> >> Object of class SpatialPolygonsDataFrame
> >> Coordinates:
> >>           min       max
> >> r1 -84.32385 -75.45698
> >> r2  33.88199  36.58965
> >> Is projected: FALSE
> >> proj4string : [+proj=longlat +ellps=clrk66]
> >> Data attributes:
> >>        AREA          PERIMETER         CNTY_
> >> CNTY_ID            NAME
> >> Min.   :0.0420   Min.   :0.999   Min.   :1825   Min.   :1825
> >> Alamance : 1
> >> 1st Qu.:0.0910   1st Qu.:1.324   1st Qu.:1902   1st Qu.:1902
> >> Alexander: 1
> >> Median :0.1205   Median :1.609   Median :1982   Median :1982
> >> Alleghany: 1
> >> Mean   :0.1263   Mean   :1.673   Mean   :1986   Mean   :1986
> >> Anson    : 1
> >> 3rd Qu.:0.1542   3rd Qu.:1.859   3rd Qu.:2067   3rd Qu.:2067
> >> Ashe     : 1
> >> Max.   :0.2410   Max.   :3.640   Max.   :2241   Max.   :2241
> >> Avery    : 1
> >>
> >> (Other)  :94
> >>        FIPS        FIPSNO         CRESS_ID          BIR74
> >> SID74
> >> 37001  : 1   Min.   :37001   Min.   :  1.00   Min.   :  248
> >> Min.   : 0.00
> >> 37003  : 1   1st Qu.:37050   1st Qu.: 25.75   1st Qu.: 1077   1st
> >> Qu.: 2.00
> >> 37005  : 1   Median :37100   Median : 50.50   Median : 2180
> >> Median : 4.00
> >> 37007  : 1   Mean   :37100   Mean   : 50.50   Mean   : 3300
> >> Mean   : 6.67
> >> 37009  : 1   3rd Qu.:37150   3rd Qu.: 75.25   3rd Qu.: 3936   3rd
> >> Qu.: 8.25
> >> 37011  : 1   Max.   :37199   Max.   :100.00   Max.   :21588    
> >> Max.   :
> >> 44.00
> >> (Other):94
> >>      NWBIR74           BIR79           SID79          NWBIR79
> >> Min.   :   1.0   Min.   :  319   Min.   : 0.00   Min.   :    3.0
> >> 1st Qu.: 190.0   1st Qu.: 1336   1st Qu.: 2.00   1st Qu.:  250.5
> >> Median : 697.5   Median : 2636   Median : 5.00   Median :  874.5
> >> Mean   :1050.8   Mean   : 4224   Mean   : 8.36   Mean   : 1352.8
> >> 3rd Qu.:1168.5   3rd Qu.: 4889   3rd Qu.:10.25   3rd Qu.: 1406.8
> >> Max.   :8027.0   Max.   :30757   Max.   :57.00   Max.   :11631.0
> >>
> >>>
> >
> 
> Jacques Vernin
> 
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Roger.Bivand at nhh.no  Thu Sep 28 15:26:55 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 28 Sep 2006 15:26:55 +0200 (CEST)
Subject: [R-sig-Geo] (no subject)
In-Reply-To: <Pine.LNX.4.44.0609281456390.1994-100000@reclus.nhh.no>
Message-ID: <Pine.LNX.4.44.0609281526100.1994-100000@reclus.nhh.no>

On Thu, 28 Sep 2006, Roger Bivand wrote:

> On Thu, 28 Sep 2006, pir2.jv wrote:
> 
> > 
> > Le 28 sept. 06 ? 13:09, Roger Bivand a ?crit :
> > 
> > >
> > > OK, the file size at least looks correct, and the output of the  
> > > summary
> > > looks good too. By the way, why the load()?
> > 
> > The load is the system response when I click the R.data in the  
> > project directory
> 
> I think that this is the problem, and that you have an alternative local 
> copy of plot that disturbs the method dispatch.
> 
> If you say ls(), do the names of any of the objects begin with plot?
> 
> > >
> > > Could you now try plot(xx, axes=TRUE), and then traceback()  
> > > immediately
> > > after the error occurs?
> > 
> >  > plot(xx,axes=TRUE)
> > Erreur dans plot.window(xlim, ylim, log, asp, ...) :
> > 	'xlim' n?cessite des valeurs finies
> > De plus : Warning messages:
> > 1: aucun argument trouv? pour min ; Inf est renvoy?
> > 2: aucun argument pour max ; -Inf est renvoy?
> > 3: aucun argument trouv? pour min ; Inf est renvoy?
> > 4: aucun argument pour max ; -Inf est renvoy?
> >  > traceback()
> > 4: plot.window(...)
> > 3: localWindow(xlim, ylim, log, asp, ...)
> > 2: plot.default(xx, axes = TRUE)
> > 1: plot(xx, axes = TRUE)
> > 
> 
> This is where it is going wrong. If you do:
> 
> is(xx)
> 
> you should see:
> 
> [1] "SpatialPolygonsDataFrame" "SpatialPolygons"         
> [3] "Spatial"  
> 
> and method dispatch should choose plot.SpatialPolygons - can you try
> 
> plot.SpatialPolygons(xx, axes=TRUE)

Sorry, that should have been:

sp:::plot.SpatialPolygons(xx, axes=TRUE)

not as above.

> 
> directly. I'm fairly certain that the method dispatch of plot is getting 
> interfered with, since the class of xx is OK.
> 
> Roger
> 
> 
> > > ===============
> > 
> > 
> > If, I put:
> >  > Xlim
> > [1] -84 -75
> > 
> >  > Ylim
> > [1] 33 37
> >  > plot(xx,axes=TRUE,xlim=Xlim,ylim=Ylim)
> > 
> > give an empty image
> > ========================
> > But;
> > spplot(xx,axes=TRUE) seems to product the good image.
> > 
> > 
> > 
> > Thanks
> > 
> > > Roger
> > >
> > >>
> > >>> load("/Users/jver/Desktop/HMP/.RData")
> > >>> library(maptools)
> > >> Le chargement a n?cessit? le package : foreign
> > >> Le chargement a n?cessit? le package : sp
> > >>
> > >>> sessionInfo()
> > >> Version 2.3.1 (2006-06-01)
> > >> powerpc-apple-darwin8.6.0
> > >>
> > >> attached base packages:
> > >> [1] "methods"   "stats"     "graphics"  "grDevices" "utils"
> > >> "datasets"
> > >> [7] "base"
> > >>
> > >> other attached packages:
> > >> maptools       sp  foreign
> > >> "0.5-15" "0.8-20" "0.8-15"
> > >>
> > >>> fn <- system.file("shapes/sids.shp", package="maptools")[1]
> > >>> str(fn)
> > >> chr "/Library/Frameworks/R.framework/Versions/2.3/Resources/library/
> > >> maptools/shapes/sids.shp"
> > >>
> > >>
> > >>> file.info(fn)
> > >>
> > >>                    size
> > >> /Library/Frameworks/R.framework/Versions/2.3/Resources/library/
> > >> maptools/shapes/sids.shp 46196
> > >>
> > >>                   isdir
> > >> /Library/Frameworks/R.framework/Versions/2.3/Resources/library/
> > >> maptools/shapes/sids.shp FALSE
> > >>
> > >>                   mode
> > >> /Library/Frameworks/R.framework/Versions/2.3/Resources/library/
> > >> maptools/shapes/sids.shp  644
> > >>
> > >>                                 mtime
> > >> /Library/Frameworks/R.framework/Versions/2.3/Resources/library/
> > >> maptools/shapes/sids.shp 2006-09-23 10:15:57
> > >>
> > >>                                 ctime
> > >> /Library/Frameworks/R.framework/Versions/2.3/Resources/library/
> > >> maptools/shapes/sids.shp 2006-09-28 11:39:39
> > >>
> > >>                                 atime
> > >> /Library/Frameworks/R.framework/Versions/2.3/Resources/library/
> > >> maptools/shapes/sids.shp 2006-09-28 11:39:39
> > >>
> > >>                   uid
> > >> /Library/Frameworks/R.framework/Versions/2.3/Resources/library/
> > >> maptools/shapes/sids.shp 501
> > >>
> > >>                   gid
> > >> /Library/Frameworks/R.framework/Versions/2.3/Resources/library/
> > >> maptools/shapes/sids.shp  80
> > >>
> > >>                   uname
> > >> /Library/Frameworks/R.framework/Versions/2.3/Resources/library/
> > >> maptools/shapes/sids.shp  jver
> > >>
> > >>                   grname
> > >> /Library/Frameworks/R.framework/Versions/2.3/Resources/library/
> > >> maptools/shapes/sids.shp  admin
> > >>
> > >>> xx <- readShapePoly(fn, proj4string=CRS("+proj=longlat
> > >> +ellps=clrk66"))
> > >>> class(xx)
> > >> [1] "SpatialPolygonsDataFrame"
> > >> attr(,"package")
> > >> [1] "sp"
> > >>> bbox(xx)
> > >>           min       max
> > >> r1 -84.32385 -75.45698
> > >> r2  33.88199  36.58965
> > >>> summary(xx)
> > >> Object of class SpatialPolygonsDataFrame
> > >> Coordinates:
> > >>           min       max
> > >> r1 -84.32385 -75.45698
> > >> r2  33.88199  36.58965
> > >> Is projected: FALSE
> > >> proj4string : [+proj=longlat +ellps=clrk66]
> > >> Data attributes:
> > >>        AREA          PERIMETER         CNTY_
> > >> CNTY_ID            NAME
> > >> Min.   :0.0420   Min.   :0.999   Min.   :1825   Min.   :1825
> > >> Alamance : 1
> > >> 1st Qu.:0.0910   1st Qu.:1.324   1st Qu.:1902   1st Qu.:1902
> > >> Alexander: 1
> > >> Median :0.1205   Median :1.609   Median :1982   Median :1982
> > >> Alleghany: 1
> > >> Mean   :0.1263   Mean   :1.673   Mean   :1986   Mean   :1986
> > >> Anson    : 1
> > >> 3rd Qu.:0.1542   3rd Qu.:1.859   3rd Qu.:2067   3rd Qu.:2067
> > >> Ashe     : 1
> > >> Max.   :0.2410   Max.   :3.640   Max.   :2241   Max.   :2241
> > >> Avery    : 1
> > >>
> > >> (Other)  :94
> > >>        FIPS        FIPSNO         CRESS_ID          BIR74
> > >> SID74
> > >> 37001  : 1   Min.   :37001   Min.   :  1.00   Min.   :  248
> > >> Min.   : 0.00
> > >> 37003  : 1   1st Qu.:37050   1st Qu.: 25.75   1st Qu.: 1077   1st
> > >> Qu.: 2.00
> > >> 37005  : 1   Median :37100   Median : 50.50   Median : 2180
> > >> Median : 4.00
> > >> 37007  : 1   Mean   :37100   Mean   : 50.50   Mean   : 3300
> > >> Mean   : 6.67
> > >> 37009  : 1   3rd Qu.:37150   3rd Qu.: 75.25   3rd Qu.: 3936   3rd
> > >> Qu.: 8.25
> > >> 37011  : 1   Max.   :37199   Max.   :100.00   Max.   :21588    
> > >> Max.   :
> > >> 44.00
> > >> (Other):94
> > >>      NWBIR74           BIR79           SID79          NWBIR79
> > >> Min.   :   1.0   Min.   :  319   Min.   : 0.00   Min.   :    3.0
> > >> 1st Qu.: 190.0   1st Qu.: 1336   1st Qu.: 2.00   1st Qu.:  250.5
> > >> Median : 697.5   Median : 2636   Median : 5.00   Median :  874.5
> > >> Mean   :1050.8   Mean   : 4224   Mean   : 8.36   Mean   : 1352.8
> > >> 3rd Qu.:1168.5   3rd Qu.: 4889   3rd Qu.:10.25   3rd Qu.: 1406.8
> > >> Max.   :8027.0   Max.   :30757   Max.   :57.00   Max.   :11631.0
> > >>
> > >>>
> > >
> > 
> > Jacques Vernin
> > 
> > 
> > 
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From Roger.Bivand at nhh.no  Thu Sep 28 15:51:01 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 28 Sep 2006 15:51:01 +0200 (CEST)
Subject: [R-sig-Geo] Please read before upgrading to R 2.4.0!
Message-ID: <Pine.LNX.4.44.0609281543000.1994-100000@reclus.nhh.no>

The release of R 2.4.0 is imminent, and will involve major changes in the 
handling of objects of classes defined in the sp package. Please make sure 
to export any objects you need to use to external files before upgrading 
to R 2.4.0, then upgrade and update packages. The 0.9-* series of the sp 
package are for R >= 2.4.0, 0.8-* for R <= 2.3.1. 

This warning applies to users who save sp objects using save() or 
save.image(), that is save them in their internal form. It is this form 
that is being changed because of improvements in the core methods package, 
so the advice given here is unavoidable. 

Since this incompatibility is happening anyway, we have taken the
opportunity of changing the representation of the data slot in
SpatialPointsDataFrame, SpatialPixelsDataFrame and SpatialGridDataFrame
objects from AttributeList to data.frame, because the handling of row
names in the R core data.frame object has been improved for objects with
many rows.

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From pir2.jv at wanadoo.fr  Thu Sep 28 16:13:24 2006
From: pir2.jv at wanadoo.fr (pir2.jv)
Date: Thu, 28 Sep 2006 16:13:24 +0200
Subject: [R-sig-Geo] (no subject)
In-Reply-To: <Pine.LNX.4.44.0609281456390.1994-100000@reclus.nhh.no>
References: <Pine.LNX.4.44.0609281456390.1994-100000@reclus.nhh.no>
Message-ID: <721BC477-74D0-4982-9067-1435E91906FF@wanadoo.fr>


Le 28 sept. 06 ? 15:06, Roger Bivand a ?crit :

>>>   By the way, why the load()?
>>
>> The load is the system response when I click the R.data in the
>> project directory
>
> I think that this is the problem, and that you have an alternative  
> local
> copy of plot that disturbs the method dispatch.
>
> If you say ls(), do the names of any of the objects begin with plot?

 > ls(pat="plot")
[1] "BBplot"             "Bplot"              "draw.plotmath.cell"
[4] "plot"               "plotG"              "plotM"
[7] "plotx"              "plotxx"

plotx, plotxx, plotG and plotM are functions of mine. Is there a  
problem ?

>
>>>
>>> Could you now try plot(xx, axes=TRUE), and then traceback()
>>> immediately
>>> after the error occurs?
>>
>>> plot(xx,axes=TRUE)
>> Erreur dans plot.window(xlim, ylim, log, asp, ...) :
>> 	'xlim' n?cessite des valeurs finies
>> De plus : Warning messages:
>> 1: aucun argument trouv? pour min ; Inf est renvoy?
>> 2: aucun argument pour max ; -Inf est renvoy?
>> 3: aucun argument trouv? pour min ; Inf est renvoy?
>> 4: aucun argument pour max ; -Inf est renvoy?
>>> traceback()
>> 4: plot.window(...)
>> 3: localWindow(xlim, ylim, log, asp, ...)
>> 2: plot.default(xx, axes = TRUE)
>> 1: plot(xx, axes = TRUE)
>>
>
> This is where it is going wrong. If you do:
>
> is(xx)

 > is(xx)
[1] "SpatialPolygonsDataFrame" "SpatialPolygons"
[3] "Spatial"
seems to be good

>
> you should see:
>
> [1] "SpatialPolygonsDataFrame" "SpatialPolygons"
> [3] "Spatial"
>
> and method dispatch should choose plot.SpatialPolygons - can you try
>
> plot.SpatialPolygons(xx, axes=TRUE)
>
> directly.


sp:::plot.SpatialPolygons(xx, axes=TRUE)


give a map which seems to be good one !!!
(but I had removed the plot* as below before this instruction)

> I'm fairly certain that the method dispatch of plot is getting
> interfered with, since the class of xx is OK.



Jacques Vernin



From Roger.Bivand at nhh.no  Thu Sep 28 16:18:47 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 28 Sep 2006 16:18:47 +0200 (CEST)
Subject: [R-sig-Geo] (no subject)
In-Reply-To: <721BC477-74D0-4982-9067-1435E91906FF@wanadoo.fr>
Message-ID: <Pine.LNX.4.44.0609281615010.1994-100000@reclus.nhh.no>

On Thu, 28 Sep 2006, pir2.jv wrote:

> 
> Le 28 sept. 06 ? 15:06, Roger Bivand a ?crit :
> 
> >>>   By the way, why the load()?
> >>
> >> The load is the system response when I click the R.data in the
> >> project directory
> >
> > I think that this is the problem, and that you have an alternative  
> > local
> > copy of plot that disturbs the method dispatch.
> >
> > If you say ls(), do the names of any of the objects begin with plot?
> 
>  > ls(pat="plot")
> [1] "BBplot"             "Bplot"              "draw.plotmath.cell"
> [4] "plot"               "plotG"              "plotM"
> [7] "plotx"              "plotxx"
> 
> plotx, plotxx, plotG and plotM are functions of mine. Is there a  
> problem ?

The problem is that your local function plot is masking the one which 
understands that "SpatialPolygons" objects have their own method and need 
to be sent there, so yes, at least your local plot is the problem. The 
standard advice if you have a number of functions is to write a package 
with a NAMESPACE, and that will protect you from R not choosing the one 
you intended.

Roger

> 
> >
> >>>
> >>> Could you now try plot(xx, axes=TRUE), and then traceback()
> >>> immediately
> >>> after the error occurs?
> >>
> >>> plot(xx,axes=TRUE)
> >> Erreur dans plot.window(xlim, ylim, log, asp, ...) :
> >> 	'xlim' n?cessite des valeurs finies
> >> De plus : Warning messages:
> >> 1: aucun argument trouv? pour min ; Inf est renvoy?
> >> 2: aucun argument pour max ; -Inf est renvoy?
> >> 3: aucun argument trouv? pour min ; Inf est renvoy?
> >> 4: aucun argument pour max ; -Inf est renvoy?
> >>> traceback()
> >> 4: plot.window(...)
> >> 3: localWindow(xlim, ylim, log, asp, ...)
> >> 2: plot.default(xx, axes = TRUE)
> >> 1: plot(xx, axes = TRUE)
> >>
> >
> > This is where it is going wrong. If you do:
> >
> > is(xx)
> 
>  > is(xx)
> [1] "SpatialPolygonsDataFrame" "SpatialPolygons"
> [3] "Spatial"
> seems to be good
> 
> >
> > you should see:
> >
> > [1] "SpatialPolygonsDataFrame" "SpatialPolygons"
> > [3] "Spatial"
> >
> > and method dispatch should choose plot.SpatialPolygons - can you try
> >
> > plot.SpatialPolygons(xx, axes=TRUE)
> >
> > directly.
> 
> 
> sp:::plot.SpatialPolygons(xx, axes=TRUE)
> 
> 
> give a map which seems to be good one !!!
> (but I had removed the plot* as below before this instruction)
> 
> > I'm fairly certain that the method dispatch of plot is getting
> > interfered with, since the class of xx is OK.
> 
> 
> 
> Jacques Vernin
> 
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



From pir2.jv at wanadoo.fr  Thu Sep 28 16:42:13 2006
From: pir2.jv at wanadoo.fr (pir2.jv)
Date: Thu, 28 Sep 2006 16:42:13 +0200
Subject: [R-sig-Geo] (no subject)
In-Reply-To: <Pine.LNX.4.44.0609281615010.1994-100000@reclus.nhh.no>
References: <Pine.LNX.4.44.0609281615010.1994-100000@reclus.nhh.no>
Message-ID: <17BA21AD-D749-497A-B848-6CAEC5AC3ECD@wanadoo.fr>


Le 28 sept. 06 ? 16:18, Roger Bivand a ?crit :

>>>
>>> If you say ls(), do the names of any of the objects begin with plot?
>>
>>> ls(pat="plot")
>> [1] "BBplot"             "Bplot"              "draw.plotmath.cell"
>> [4] "plot"               "plotG"              "plotM"
>> [7] "plotx"              "plotxx"
>>
>> plotx, plotxx, plotG and plotM are functions of mine. Is there a
>> problem ?
>
> The problem is that your local function plot is masking the one which
> understands that "SpatialPolygons" objects have their own method  
> and need
> to be sent there, so yes, at least your local plot is the problem. The
> standard advice if you have a number of functions is to write a  
> package
> with a NAMESPACE, and that will protect you from R not choosing the  
> one
> you intended.
>
Why would be my function plot local ? It is not.
I removed the others

============
 > plot
function (x, y, ...)
{
     if (is.null(attr(x, "class")) && is.function(x)) {
         nms <- names(list(...))
         if (missing(y))
             y <- {
                 if (!"from" %in% nms)
                   0
                 else if (!"to" %in% nms)
                   1
                 else if (!"xlim" %in% nms)
                   NULL
             }
         if ("ylab" %in% nms)
             plot.function(x, y, ...)
         else plot.function(x, y, ylab = paste(deparse(substitute(x)),
             "(x)"), ...)
     }
     else UseMethod("plot")
}
<environment: namespace:graphics>

=============================
>
>

Jacques Vernin



From frank.hardisty at gmail.com  Thu Sep 28 20:07:52 2006
From: frank.hardisty at gmail.com (Frank Hardisty)
Date: Thu, 28 Sep 2006 14:07:52 -0400
Subject: [R-sig-Geo] (no subject)
In-Reply-To: <s51ba887.096@gwm.sc.edu>
References: <s51ba887.096@gwm.sc.edu>
Message-ID: <f1498be70609281107s1531c226w667ad895ca6aaf19@mail.gmail.com>

Dear Jacques Vernin (and All),

I appreciate that you are experiencing some difficulties when using R
and spatial extensions.

However, please realize that Roger Bivand has been wonderfully patient
and helpful to many, many people, as you can see in the history of
this email list.

Please remember that R and R spatial extensions are written,
maintained, and supported by volunteer labor.

Your email "tone of voice" is not very sweet, considering that you are
asking for free help.

regards,
-Frank Hardisty

~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Frank Hardisty
Department of Geography
University of South Carolina
hardisty at sc.edu
Office -- 803-777-5729
Fax -- 803-777-4972
http://people.cas.sc.edu/hardistf/


On 9/28/06, Frank Hardisty <HardistF at gwm.sc.edu> wrote:
>
>
> ---------- Forwarded message ----------
> From: "pir2.jv" <pir2.jv at wanadoo.fr>
> To: Roger.Bivand at nhh.no
> Date: Thu, 28 Sep 2006 16:42:13 +0200
> Subject: Re: [R-sig-Geo] (no subject)
>
> Le 28 sept. 06 ? 16:18, Roger Bivand a ?crit :
>
> >>>
> >>> If you say ls(), do the names of any of the objects begin with plot?
> >>
> >>> ls(pat="plot")
> >> [1] "BBplot"             "Bplot"              "draw.plotmath.cell"
> >> [4] "plot"               "plotG"              "plotM"
> >> [7] "plotx"              "plotxx"
> >>
> >> plotx, plotxx, plotG and plotM are functions of mine. Is there a
> >> problem ?
> >
> > The problem is that your local function plot is masking the one which
> > understands that "SpatialPolygons" objects have their own method
> > and need
> > to be sent there, so yes, at least your local plot is the problem. The
> > standard advice if you have a number of functions is to write a
> > package
> > with a NAMESPACE, and that will protect you from R not choosing the
> > one
> > you intended.
> >
> Why would be my function plot local ? It is not.
> I removed the others
>
> ============
>  > plot
> function (x, y, ...)
> {
>      if (is.null(attr(x, "class")) && is.function(x)) {
>          nms <- names(list(...))
>          if (missing(y))
>              y <- {
>                  if (!"from" %in% nms)
>                    0
>                  else if (!"to" %in% nms)
>                    1
>                  else if (!"xlim" %in% nms)
>                    NULL
>              }
>          if ("ylab" %in% nms)
>              plot.function(x, y, ...)
>          else plot.function(x, y, ylab = paste(deparse(substitute(x)),
>              "(x)"), ...)
>      }
>      else UseMethod("plot")
> }
> <environment: namespace:graphics>
>
> =============================
> >
> >
>
> Jacques Vernin
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


-- 
~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Frank Hardisty
Department of Geography
University of South Carolina
hardisty at sc.edu
Office -- 803-777-5729
Fax -- 803-777-4972
http://people.cas.sc.edu/hardistf/



From Roger.Bivand at nhh.no  Thu Sep 28 20:45:38 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 28 Sep 2006 20:45:38 +0200 (CEST)
Subject: [R-sig-Geo] (no subject)
In-Reply-To: <f1498be70609281107s1531c226w667ad895ca6aaf19@mail.gmail.com>
Message-ID: <Pine.LNX.4.44.0609282033110.1994-100000@reclus.nhh.no>

On Thu, 28 Sep 2006, Frank Hardisty wrote:

> Dear Jacques Vernin (and All),
> 
> I appreciate that you are experiencing some difficulties when using R
> and spatial extensions.
> 
> However, please realize that Roger Bivand has been wonderfully patient
> and helpful to many, many people, as you can see in the history of
> this email list.
> 
> Please remember that R and R spatial extensions are written,
> maintained, and supported by volunteer labor.

Thanks for your kind words, Frank! But in fact at least one of my replies
to Jacques was brusque, I can get annoyed when people do not follow
general R list advice and state their platform and package versions. So
his choice of tone is partly my choice. 

The resolution here is that overloading existing functions is *not a good
idea* and can lead to unexpected consequences, like this method
dispatching muddle. Using the package framework and guarding the local
code in a namespace should solve it.

Roger

PS. I had a very interesting talk at FOSS4G with someone attacking the 
spatial R/Java puzzle through JRI (see the rJava package), who reported 
much more success than we had two years ago.

> 
> Your email "tone of voice" is not very sweet, considering that you are
> asking for free help.
> 
> regards,
> -Frank Hardisty
> 
> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> Frank Hardisty
> Department of Geography
> University of South Carolina
> hardisty at sc.edu
> Office -- 803-777-5729
> Fax -- 803-777-4972
> http://people.cas.sc.edu/hardistf/
> 
> 
> On 9/28/06, Frank Hardisty <HardistF at gwm.sc.edu> wrote:
> >
> >
> > ---------- Forwarded message ----------
> > From: "pir2.jv" <pir2.jv at wanadoo.fr>
> > To: Roger.Bivand at nhh.no
> > Date: Thu, 28 Sep 2006 16:42:13 +0200
> > Subject: Re: [R-sig-Geo] (no subject)
> >
> > Le 28 sept. 06 ? 16:18, Roger Bivand a ?crit :
> >
> > >>>
> > >>> If you say ls(), do the names of any of the objects begin with plot?
> > >>
> > >>> ls(pat="plot")
> > >> [1] "BBplot"             "Bplot"              "draw.plotmath.cell"
> > >> [4] "plot"               "plotG"              "plotM"
> > >> [7] "plotx"              "plotxx"
> > >>
> > >> plotx, plotxx, plotG and plotM are functions of mine. Is there a
> > >> problem ?
> > >
> > > The problem is that your local function plot is masking the one which
> > > understands that "SpatialPolygons" objects have their own method
> > > and need
> > > to be sent there, so yes, at least your local plot is the problem. The
> > > standard advice if you have a number of functions is to write a
> > > package
> > > with a NAMESPACE, and that will protect you from R not choosing the
> > > one
> > > you intended.
> > >
> > Why would be my function plot local ? It is not.
> > I removed the others
> >
> > ============
> >  > plot
> > function (x, y, ...)
> > {
> >      if (is.null(attr(x, "class")) && is.function(x)) {
> >          nms <- names(list(...))
> >          if (missing(y))
> >              y <- {
> >                  if (!"from" %in% nms)
> >                    0
> >                  else if (!"to" %in% nms)
> >                    1
> >                  else if (!"xlim" %in% nms)
> >                    NULL
> >              }
> >          if ("ylab" %in% nms)
> >              plot.function(x, y, ...)
> >          else plot.function(x, y, ylab = paste(deparse(substitute(x)),
> >              "(x)"), ...)
> >      }
> >      else UseMethod("plot")
> > }
> > <environment: namespace:graphics>
> >
> > =============================
> > >
> > >
> >
> > Jacques Vernin
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at stat.math.ethz.ch
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> >
> 
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



