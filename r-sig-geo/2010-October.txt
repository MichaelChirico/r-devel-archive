From Roger.Bivand at nhh.no  Fri Oct  1 08:30:19 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 1 Oct 2010 08:30:19 +0200 (CEST)
Subject: [R-sig-Geo] all localR2 has NA values in gwr
In-Reply-To: <4CA4FDCF.4080909@mail.montclair.edu>
References: <AANLkTi=cx0btJ23P0-2VRaQyjUcQXW-VBftCDTVNCi-L@mail.gmail.com>
	<4CA4FDCF.4080909@mail.montclair.edu>
Message-ID: <alpine.LRH.2.00.1010010824500.10143@reclus.nhh.no>

On Thu, 30 Sep 2010, Danlin Yu wrote:

>
> Jorge:
>
> From what I see on your code, I would suspect that you kind of confuse the 
> bandwidth with numbers of nearest neighbor. In your code, you use 20, and I 
> assume that meant the 20 nearest neighbors that you want for GWR calibration. 
> Yet you didn't specify the adapt parameter in the code, which make the code 
> think 20 is a distance value. I am not sure how the distance of 20 with 
> longitude and latitude values would be, but I suspect this might be the 
> cause.

See ?spDistsN1, the distances are in kilometers.

> In addition, in the coordinates specification, longitude shall be the 
> x, and latitude the y.
>

Exactly!

> Try:
>
> test=gwr(y~x1+x2,data=yourdata,cbind(longitude, 
> latitude),adapt=0.05,gwr.bisquare,longlat=T)
>
> to see what happens (I use 0.05 just for testing purpose, which means 5% of 
> the total sample as the nearest neighbor for local estimation. Since you have 
> more than 10,000 samples, the value will result in a local sample (local 
> nearest neighbors) of 500. If you wan to try 20, then you can probably use 
> 0.002 for the adapt parameter).
>

I agree that adapt= may here be a better choice than a fixed bandwidth. I 
do not, however, think that local R2 will be available for this number of 
data points, as the hat matrix would be too big for memory. Please read up 
on the difference between fit points and data points, and consider fitting 
a model with hat matrix on a subset of the data, then using the 
fittedGWRobject= argument to provide the elements needed to get to local 
R2 (which is not the R2 of each local fit, it seems). Have you tried 
fitting in GWR3, SAM, or ArcGIS?

Hope this helps,

Roger

> Hope this helps.
>
> Cheers,
> Dr. Danlin Yu
>
>
>
> On 2010-9-30 12:53, Jorge Fernando Saraiva de Menezes wrote:
>> Dear list,
>> 
>> When I run a gwr using a model with two independent variables my local R2
>> only has NA values. I've read in some topic that this is problably because
>> the function cannot estimate localR2 correctly.
>> I tryed to get the same result with the columbus data, but was not able to.
>> Does anyone know what usually cause this? maybe a small or large bandwdth?
>> And a side question, when longlat=T,and your coordinates are in WGS84 the
>> values of bandwidth must be given in degrees?
>> 
>> 
>> I'm using R2.10.1 and package spgwr version 0.6-2. i give a summary of my
>> variables below. also my data is information collected in 10433 islands of
>> the American continent, which mean that I have distances between my points
>> varying from few meters to thousands of kilometers. I use a bandwidth of 
>> 20,
>> and used the bisquare method.
>> 
>> summary of my data
>>              y          x1            x2
>> Min.      0.00    1.310e-02   4.254e-02
>> 1st Qu.  32.00  8.319e-01   1.628e+00
>> Median   47.00  1.696e+00  2.005e+01
>> Mean     84.25   2.043e+02 1.329e+02
>> 3rd Qu. 143.00   5.822e+00 1.758e+02
>> Max.    425.00   5.152e+05  3.114e+03
>> 
>> code
>> test=gwr(y~x1+x2,,cbind(latitude,longitude),20,gwr.bisquare,longlat=T)
>> 
>> Thanks in advance,
>> Jorge Menezes
>>
>> 	[[alternative HTML version deleted]]
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From carson.farmer at gmail.com  Fri Oct  1 13:53:01 2010
From: carson.farmer at gmail.com (Carson Farmer)
Date: Fri, 1 Oct 2010 12:53:01 +0100
Subject: [R-sig-Geo] spatial interaction models
Message-ID: <AANLkTi=ztT0NB-g0bbDsmqjLKemjA2V2NT2T0S56bH65@mail.gmail.com>

Hi List,

This question has come up with the past, but I have yet to find a
clear response, so I'm going to ask myself.
Has anyone had much experience with spatial interaction models,
specifically in the form of Poisson regression?
I'm a bit unsure of how to operationalize this using glm(), and would
appreciate any pointers from those with more experience.

Basically, the conventional origin constrained model would look
something like this:
T_{ij} = exp(\delta_{i} + \log{A_{j}} - \beta D_{ij}) ~ \varepsilon_{ij}
where \delta_{i} is a constant parameter speci?c to the ith zone,
A_{j} is the attractiveness of the jth location, and D_{ij} is the
distance between i and j.
Note that \varepsilon_{ij} is just the multiplicative error term of
the ?ow from i to j, and \beta is the distance decay parameter.

Similarly, the doubly constrained model follows the form:
T_{ij} = exp(\delta_{i} + \gamma_{j} - \beta D_{ij}) ~ \varepsilon_{ij}
where everything is defined as above, except exp(\gamma_{j}) is an
estimate of the attractiveness of location A_{j}.

Hopefully the above description makes things a bit clearer,
essentially my question is this:
What factors or in what form do I have to have my data in order to be
able to run such a model following the glm syntax?
I know this should be relatively straight-forward, I just can't seem
to get my head wrapped around it at the moment?
If it helps, I can provide some sample data to those who request it.

Thanks in advance,

Carson

-- 
Carson J. Q. Farmer
ISSP Doctoral Fellow
National Centre for Geocomputation
National University of Ireland, Maynooth,
http://www.carsonfarmer.com/


From Roger.Bivand at nhh.no  Fri Oct  1 15:47:22 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 1 Oct 2010 15:47:22 +0200 (CEST)
Subject: [R-sig-Geo] all localR2 has NA values in gwr
In-Reply-To: <alpine.LRH.2.00.1010010824500.10143@reclus.nhh.no>
References: <AANLkTi=cx0btJ23P0-2VRaQyjUcQXW-VBftCDTVNCi-L@mail.gmail.com>
	<4CA4FDCF.4080909@mail.montclair.edu>
	<alpine.LRH.2.00.1010010824500.10143@reclus.nhh.no>
Message-ID: <alpine.LRH.2.00.1010011528240.10829@reclus.nhh.no>

On Fri, 1 Oct 2010, Roger Bivand wrote:

> On Thu, 30 Sep 2010, Danlin Yu wrote:
>
>> 
>> Jorge:
>> 
>> From what I see on your code, I would suspect that you kind of confuse the 
>> bandwidth with numbers of nearest neighbor. In your code, you use 20, and I 
>> assume that meant the 20 nearest neighbors that you want for GWR 
>> calibration. Yet you didn't specify the adapt parameter in the code, which 
>> make the code think 20 is a distance value. I am not sure how the distance 
>> of 20 with longitude and latitude values would be, but I suspect this might 
>> be the cause.
>
> See ?spDistsN1, the distances are in kilometers.
>
>> In addition, in the coordinates specification, longitude shall be the x, 
>> and latitude the y.
>> 
>
> Exactly!
>
>> Try:
>> 
>> test=gwr(y~x1+x2,data=yourdata,cbind(longitude, 
>> latitude),adapt=0.05,gwr.bisquare,longlat=T)
>> 
>> to see what happens (I use 0.05 just for testing purpose, which means 5% of 
>> the total sample as the nearest neighbor for local estimation. Since you 
>> have more than 10,000 samples, the value will result in a local sample 
>> (local nearest neighbors) of 500. If you wan to try 20, then you can 
>> probably use 0.002 for the adapt parameter).
>> 
>
> I agree that adapt= may here be a better choice than a fixed bandwidth. I do 
> not, however, think that local R2 will be available for this number of data 
> points, as the hat matrix would be too big for memory. Please read up on the 
> difference between fit points and data points, and consider fitting a model 
> with hat matrix on a subset of the data, then using the fittedGWRobject= 
> argument to provide the elements needed to get to local R2 (which is not the 
> R2 of each local fit, it seems). Have you tried fitting in GWR3, SAM, or 
> ArcGIS?

My analysis was incorrect, and the NA localR2 are coming from the very low 
sums of weights for each observation:

library(spgwr)
res.adpt <- gwr(PctBach ~ TotPop90 + PctRural + PctEld + PctFB + PctPov + 
PctBlack, data=gSRDF, adapt=0.01)
summary(res.adpt$SDF)
res.adpt <- gwr(PctBach ~ TotPop90 + PctRural + PctEld + PctFB + PctPov + 
PctBlack, data=gSRDF, adapt=0.001)
summary(res.adpt$SDF)

With sums of local weights of 1, so only including the i'th observation in 
its own local regression, the localR2 suffers numerical meltdown in 
several elements. The hat matrix is not required to compute the localR2 if 
the data points are the fit points. In your case, and with a 20km fixed 
bandwidth, you most likely only have the i'th observations in their own 
local regressions.

Hope this helps more,

Roger

>
> Hope this helps,
>
> Roger
>
>> Hope this helps.
>> 
>> Cheers,
>> Dr. Danlin Yu
>> 
>> 
>> 
>> On 2010-9-30 12:53, Jorge Fernando Saraiva de Menezes wrote:
>>> Dear list,
>>> 
>>> When I run a gwr using a model with two independent variables my local R2
>>> only has NA values. I've read in some topic that this is problably because
>>> the function cannot estimate localR2 correctly.
>>> I tryed to get the same result with the columbus data, but was not able 
>>> to.
>>> Does anyone know what usually cause this? maybe a small or large bandwdth?
>>> And a side question, when longlat=T,and your coordinates are in WGS84 the
>>> values of bandwidth must be given in degrees?
>>> 
>>> 
>>> I'm using R2.10.1 and package spgwr version 0.6-2. i give a summary of my
>>> variables below. also my data is information collected in 10433 islands of
>>> the American continent, which mean that I have distances between my points
>>> varying from few meters to thousands of kilometers. I use a bandwidth of 
>>> 20,
>>> and used the bisquare method.
>>> 
>>> summary of my data
>>>              y          x1            x2
>>> Min.      0.00    1.310e-02   4.254e-02
>>> 1st Qu.  32.00  8.319e-01   1.628e+00
>>> Median   47.00  1.696e+00  2.005e+01
>>> Mean     84.25   2.043e+02 1.329e+02
>>> 3rd Qu. 143.00   5.822e+00 1.758e+02
>>> Max.    425.00   5.152e+05  3.114e+03
>>> 
>>> code
>>> test=gwr(y~x1+x2,,cbind(latitude,longitude),20,gwr.bisquare,longlat=T)
>>> 
>>> Thanks in advance,
>>> Jorge Menezes
>>>
>>> 	[[alternative HTML version deleted]]
>>> 
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
>> 
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From ricardorodot02 at gmail.com  Fri Oct  1 19:52:23 2010
From: ricardorodot02 at gmail.com (=?ISO-8859-1?Q?Ricardo_Rodr=EDguez?=)
Date: Fri, 1 Oct 2010 12:52:23 -0500
Subject: [R-sig-Geo] custom reports
Message-ID: <AANLkTinGKCORyAaUNXBiUVEcCMDvamca7fBh=PVjBNOO@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101001/a40d1da5/attachment.pl>

From ricardorodot02 at gmail.com  Fri Oct  1 19:58:53 2010
From: ricardorodot02 at gmail.com (=?ISO-8859-1?Q?Ricardo_Rodr=EDguez?=)
Date: Fri, 1 Oct 2010 12:58:53 -0500
Subject: [R-sig-Geo] creating maps for raster interpolation
Message-ID: <AANLkTin2Uy_JGchbxDyEOdYtn8a_ihiBgFeBBLWpEZNM@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101001/07e55560/attachment.pl>

From greenberg at ucdavis.edu  Fri Oct  1 20:42:20 2010
From: greenberg at ucdavis.edu (Jonathan Greenberg)
Date: Fri, 1 Oct 2010 11:42:20 -0700
Subject: [R-sig-Geo] Proper PROJ settings for lat-long?
Message-ID: <AANLkTin+EPQ0mahH+cQp1F8U5HT8kZ3OYHZ_grzGe3_z@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101001/4a05ed21/attachment.pl>

From wisfool at email.arizona.edu  Fri Oct  1 21:42:26 2010
From: wisfool at email.arizona.edu (Roberto Badilla Fuentes)
Date: Fri, 1 Oct 2010 12:42:26 -0700
Subject: [R-sig-Geo] Random Movement Generator
Message-ID: <AANLkTimhbkSLgNJXpSAk0msaNX=ADbtB7EZjd7ZE6fxM@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101001/712dd90c/attachment.pl>

From wisfool at email.arizona.edu  Fri Oct  1 21:42:26 2010
From: wisfool at email.arizona.edu (Roberto Badilla Fuentes)
Date: Fri, 1 Oct 2010 12:42:26 -0700
Subject: [R-sig-Geo] Random Movement Generator
Message-ID: <AANLkTimhbkSLgNJXpSAk0msaNX=ADbtB7EZjd7ZE6fxM@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101001/712dd90c/attachment-0001.pl>

From wisfool at email.arizona.edu  Fri Oct  1 21:42:26 2010
From: wisfool at email.arizona.edu (Roberto Badilla Fuentes)
Date: Fri, 1 Oct 2010 12:42:26 -0700
Subject: [R-sig-Geo] Random Movement Generator
Message-ID: <AANLkTimhbkSLgNJXpSAk0msaNX=ADbtB7EZjd7ZE6fxM@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101001/712dd90c/attachment-0002.pl>

From wisfool at email.arizona.edu  Fri Oct  1 21:42:26 2010
From: wisfool at email.arizona.edu (Roberto Badilla Fuentes)
Date: Fri, 1 Oct 2010 12:42:26 -0700
Subject: [R-sig-Geo] Random Movement Generator
Message-ID: <AANLkTimhbkSLgNJXpSAk0msaNX=ADbtB7EZjd7ZE6fxM@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101001/712dd90c/attachment-0003.pl>

From wisfool at email.arizona.edu  Fri Oct  1 21:42:26 2010
From: wisfool at email.arizona.edu (Roberto Badilla Fuentes)
Date: Fri, 1 Oct 2010 12:42:26 -0700
Subject: [R-sig-Geo] Random Movement Generator
Message-ID: <AANLkTimhbkSLgNJXpSAk0msaNX=ADbtB7EZjd7ZE6fxM@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101001/712dd90c/attachment-0004.pl>

From wisfool at email.arizona.edu  Fri Oct  1 21:42:26 2010
From: wisfool at email.arizona.edu (Roberto Badilla Fuentes)
Date: Fri, 1 Oct 2010 12:42:26 -0700
Subject: [R-sig-Geo] Random Movement Generator
Message-ID: <AANLkTimhbkSLgNJXpSAk0msaNX=ADbtB7EZjd7ZE6fxM@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101001/712dd90c/attachment-0005.pl>

From Andy.Bunn at wwu.edu  Fri Oct  1 23:30:25 2010
From: Andy.Bunn at wwu.edu (Andy Bunn)
Date: Fri, 1 Oct 2010 14:30:25 -0700
Subject: [R-sig-Geo] Random Movement Generator
In-Reply-To: <AANLkTimhbkSLgNJXpSAk0msaNX=ADbtB7EZjd7ZE6fxM@mail.gmail.com>
References: <AANLkTimhbkSLgNJXpSAk0msaNX=ADbtB7EZjd7ZE6fxM@mail.gmail.com>
Message-ID: <7E6EA3F4372E474F8F3F850DD262FDA9035C11B4F4@ExchMailbox3.univ.dir.wwu.edu>

> -----Original Message-----
> From: r-sig-geo-bounces at stat.math.ethz.ch [mailto:r-sig-geo-
> bounces at stat.math.ethz.ch] On Behalf Of Roberto Badilla Fuentes
> Sent: Friday, October 01, 2010 12:42 PM
> To: r-sig-geo
> Subject: [R-sig-Geo] Random Movement Generator
> 
> Hi All,
> 
> Is there a functionality in R that allows for the creation of random
> path or
> trajectory?  Probably Brownian Motion can help but I'd like to output
> the
> data points and be able to have the points separated, say every 30
> minutes.

I've used like this before in class to teach about random walks. Maybe this will get you going? HTH, Andy

require(sp)
xinit <- 0
yinit <- 0
d2move <- 1
nsteps <- 99
x <- c(xinit,rep(NA,nsteps))
y <- c(yinit,rep(NA,nsteps))
for(i in 2:(nsteps+1)){
  theta <- runif(1,pi/180,360*pi/180) 
  xi <- d2move * cos(theta)
  yi <- d2move * sin(theta)
  x[i] <- x[i-1] + xi
  y[i] <- y[i-1] + yi
}
plot(x,y,type='b')
xy <- SpatialPoints(cbind(x,y))
str(xy)






> 
> 
> I also tried BM{sde}.  Is there a way plot the points generated?
> 
> Thanks in advance
> Roberto
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From roman.lustrik at gmail.com  Sat Oct  2 00:59:21 2010
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Sat, 2 Oct 2010 00:59:21 +0200
Subject: [R-sig-Geo] custom reports
In-Reply-To: <AANLkTinGKCORyAaUNXBiUVEcCMDvamca7fBh=PVjBNOO@mail.gmail.com>
References: <AANLkTinGKCORyAaUNXBiUVEcCMDvamca7fBh=PVjBNOO@mail.gmail.com>
Message-ID: <AANLkTim=zk8UZV1ExY5hNGNj9NzsEQTHCCJQjO9b7usW@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101002/d59b996c/attachment.pl>

From mdsumner at gmail.com  Sat Oct  2 04:44:21 2010
From: mdsumner at gmail.com (Michael Sumner)
Date: Sat, 2 Oct 2010 12:44:21 +1000
Subject: [R-sig-Geo] Random Movement Generator
In-Reply-To: <7E6EA3F4372E474F8F3F850DD262FDA9035C11B4F4@ExchMailbox3.univ.dir.wwu.edu>
References: <AANLkTimhbkSLgNJXpSAk0msaNX=ADbtB7EZjd7ZE6fxM@mail.gmail.com>
	<7E6EA3F4372E474F8F3F850DD262FDA9035C11B4F4@ExchMailbox3.univ.dir.wwu.edu>
Message-ID: <AANLkTikwuM7rWRA=UHiE152Gmj1xkmTx3qQJHbAvDrAs@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101002/f10ff458/attachment.pl>

From mdsumner at gmail.com  Sat Oct  2 05:21:04 2010
From: mdsumner at gmail.com (Michael Sumner)
Date: Sat, 2 Oct 2010 13:21:04 +1000
Subject: [R-sig-Geo] Random Movement Generator
In-Reply-To: <AANLkTikwuM7rWRA=UHiE152Gmj1xkmTx3qQJHbAvDrAs@mail.gmail.com>
References: <AANLkTimhbkSLgNJXpSAk0msaNX=ADbtB7EZjd7ZE6fxM@mail.gmail.com>
	<7E6EA3F4372E474F8F3F850DD262FDA9035C11B4F4@ExchMailbox3.univ.dir.wwu.edu>
	<AANLkTikwuM7rWRA=UHiE152Gmj1xkmTx3qQJHbAvDrAs@mail.gmail.com>
Message-ID: <AANLkTikbD8-e6n0ViNzWek74q0BoA8N02WLC=mXpx=az@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101002/92193f61/attachment.pl>

From basille at ase-research.org  Sat Oct  2 06:19:09 2010
From: basille at ase-research.org (Mathieu Basille)
Date: Sat, 02 Oct 2010 00:19:09 -0400
Subject: [R-sig-Geo] Random Movement Generator
In-Reply-To: <AANLkTimhbkSLgNJXpSAk0msaNX=ADbtB7EZjd7ZE6fxM@mail.gmail.com>
References: <AANLkTimhbkSLgNJXpSAk0msaNX=ADbtB7EZjd7ZE6fxM@mail.gmail.com>
Message-ID: <4CA6B2BD.4050600@ase-research.org>

Hi Roberto,

Did you have a look at the package adehabitat, and especially the simm.* 
functions (Brownian bridge motion, Bivariate Brownian Motion, Correlated 
Random Walk, Levy Walk, Arithmetic Brownian Motion, Bivariate 
Ornstein-Uhlenbeck Process)? This might be particularly helpful.

Hope this helps,
Mathieu.


Le 01/10/2010 15:42, Roberto Badilla Fuentes a ?crit :
> Hi All,
>
> Is there a functionality in R that allows for the creation of random path or
> trajectory?  Probably Brownian Motion can help but I'd like to output the
> data points and be able to have the points separated, say every 30 minutes.
>
>
> I also tried BM{sde}.  Is there a way plot the points generated?
>
> Thanks in advance
> Roberto
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 

~$ whoami
Mathieu Basille, Post-Doc

~$ locate
Laboratoire d'?cologie Comportementale et de Conservation de la Faune
+ Centre d'?tude de la For?t
D?partement de Biologie
Universit? Laval, Qu?bec

~$ info
http://ase-research.org/basille

~$ fortune
``If you can't win by reason, go for volume.''
Calvin, by Bill Watterson.


From r.hijmans at gmail.com  Sat Oct  2 12:07:14 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sat, 2 Oct 2010 13:07:14 +0300
Subject: [R-sig-Geo] Proper PROJ settings for lat-long?
In-Reply-To: <AANLkTin+EPQ0mahH+cQp1F8U5HT8kZ3OYHZ_grzGe3_z@mail.gmail.com>
References: <AANLkTin+EPQ0mahH+cQp1F8U5HT8kZ3OYHZ_grzGe3_z@mail.gmail.com>
Message-ID: <AANLkTin1ZPXVBjNH2ntAzSDbT1VuzSz940dvUEf7QwNu@mail.gmail.com>

Jonathan,

I do not think so, but I think you can do something like:

crd <- coordinates(x)
crd[crd[,1] > 180,  1] <- crd[crd[,1] > 180, 1] - 360
sp <- SpatialPoints(crd)

Robert


On Fri, Oct 1, 2010 at 9:42 PM, Jonathan Greenberg
<greenberg at ucdavis.edu> wrote:
> Folks:
>
> I have two sets of spatialpoints data, one that is in lat long which
> longitude ranging from -180 to 180, and another that ranges from 0 to 360.
> ?What are the appropriate proj settings for these two different datasets
> such that one can be properly reprojected to the other? ?I have:
>
> "++proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs" for the dataset ranging
> -180 to 180 -- is this right?
>
> --j
>
> --
> Jonathan A. Greenberg, PhD
> Assistant Project Scientist
> Center for Spatial Technologies and Remote Sensing (CSTARS)
> Department of Land, Air and Water Resources
> University of California, Davis
> One Shields Avenue
> Davis, CA 95616
> Phone: 415-763-5476
> AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From r.hijmans at gmail.com  Sat Oct  2 12:10:32 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sat, 2 Oct 2010 13:10:32 +0300
Subject: [R-sig-Geo] Step characteristics on raster maps
In-Reply-To: <4CA4DD7F.4070306@ase-research.org>
References: <4CA4869E.8000405@ase-research.org>
	<AANLkTim5WMwCdQsVJHoB82mRvfsWzXdzbOO75_ESF2FP@mail.gmail.com>
	<4CA4DD7F.4070306@ase-research.org>
Message-ID: <AANLkTin0eTU+XRSGn8SMALq8X971o23kmxH=GmzVvQ62@mail.gmail.com>

On Thu, Sep 30, 2010 at 9:57 PM, Mathieu Basille
<basille at ase-research.org> wrote:
> Dear Robert,
>
> I just understood the interest of 'crosstab' with 'mask', this is pretty
> neat! Thanks for the suggestion.
>
> However, I can see some potential drawbacks with this approach: as my
> objective is to describe each step (each segment), I should first cut
> each 'SpatialLines' into a list of 'Lines', each 'Lines' being a segment
> (and not the whole trajectory). I apology if I'm totally wrong, I'm not
> that familiar with SpatialLines...
>
> But then, what about crossing/overlaping segments, i.e. several segments
> that all fall in the same pixel (which usually happens a lot)? With
> linesToRaster, only the last segment would be kept. So that I should run
> independently the approach for each 'Line' (each segment) just to avoid
> these crossings, and that would result in as many new rasters as the
> number of segments (and I'm talking about hundreds of thousands here,
> over large rasters).
>


You are right, of course. I have added a function "lineValues" (akin
to "polygonValues" that existed) to the raster package. This function
should not have this problem. It is in the development version
available from R-Forge, please try it if you can.

Robert

>
> Basically, to rephrase my problem, here is what I want to achieve. Given
> a set of points (say a SpatialPointsDataFrame, or SpatialLinesDataFrame,
> or ltraj), I'd like to be able to compute new variables that give for
> each point summaries or characteristics (e.g. proportion of each type of
> the raster if it is categorical, or mean if is continuous) of the
> segment from that point to the next (or previous, it doesn't matter).
>
> It seems to be a simple problem in terms of low-level functions
> (segments over raster), but a complex one in terms of data structure (an
> single object with a set of individual trajectories which are themselves
> sets of segments). And I have to admit that I have some troubles going
> from the former to the latter.
>
> Thanks again for your time,
> Mathieu.
>
>
> Le 2010-09-30 11:28, Robert J. Hijmans a ?crit :
>> Perhaps you can do something like
>>
>> r is a Raster* object
>> line is a SpatialLines* object
>>
>> library(raster)
>> rr <- linesToRaster(line, r)
>> rm <- mask(r, rr)
>> crosstab(rm, rr)
>>
>> Robert
>>
>> On Thu, Sep 30, 2010 at 5:46 AM, Mathieu Basille
>> <basille at ase-research.org> wrote:
>>> Dear list members,
>>>
>>> I'm trying to compute characteristics along steps (i.e. segments between two
>>> points), based on underlying raster maps. The steps originally come from
>>> radiotracking data, converted to ltraj objects (adehabitat). The idea is to
>>> compute (for example) the habitat composition corresponding to each step
>>> instead of each points, as we are interesting in the movement path.
>>>
>>> I tried different solutions, as I would like to do it with R. I did not find
>>> any solution using adehabitat (or the development versions adehabitatMA/LS);
>>> 'join' only works for point characteristics, not steps. I also tried using
>>> sp and SpatialLinesDataFrame, but overlay does not seem to work with
>>> SpatialLines(DataFrame) and SpatialPixelsDataFrame:
>>>
>>> Error in function (classes, fdef, mtable) ?:
>>> ?unable to find an inherited method for function "overlay", for signature
>>> "SpatialPixelsDataFrame", "SpatialLinesDataFrame"
>>>
>>> I also investigated packages raster, trip, and rgeos, without success. Maybe
>>> the low level functions of rgeos could be used, but it seems a bit out of my
>>> skills (and time available) at the moment.
>>>
>>> Another solution might be to use spgrass6 in conjunction with GRASS, but I'm
>>> not familiar enough with GRASS to judge if it is a viable alternative...
>>>
>>> I'd welcome any hints/thoughts on this question.
>>> Sincerely,
>>> Mathieu Basille.
>>>
>>>
>>> --
>>>
>>> ~$ whoami
>>> Mathieu Basille, Post-Doc
>>>
>>> ~$ locate
>>> Laboratoire d'?cologie Comportementale et de Conservation de la Faune
>>> + Centre d'?tude de la For?t
>>> D?partement de Biologie
>>> Universit? Laval, Qu?bec
>>>
>>> ~$ info
>>> http://ase-research.org/basille
>>>
>>> ~$ fortune
>>> ``If you can't win by reason, go for volume.''
>>> Calvin, by Bill Watterson.
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>
> --
>
> ~$ whoami
> Mathieu Basille, Post-Doc
>
> ~$ locate
> Laboratoire d'?cologie Comportementale et de Conservation de la Faune
> + Centre d'?tude de la For?t
> D?partement de Biologie
> Universit? Laval, Qu?bec
>
> ~$ info
> http://ase-research.org/basille
>
> ~$ fortune
> ``If you can't win by reason, go for volume.''
> Calvin, by Bill Watterson.
>


From mspinola10 at gmail.com  Sat Oct  2 14:11:52 2010
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Sat, 02 Oct 2010 06:11:52 -0600
Subject: [R-sig-Geo] Error with function kfold in package dismo
Message-ID: <4CA72188.4060601@gmail.com>

  Dear list members,

I got this error in package "dismo".

fold <- kfold(bradypus, k=5)
 > bradytrain <- bradypus[fold != 1, ]
 > me <- maxent(predictores, bradytrain)
Error en .readRowsAscii(raster, rows[i], 1) : elemento 1 esta vacio;
   la parte de la lista de argumentos  '>' ha sido evaluada:
    (startcol, 1)

Function maxent works perfect for "bradypus" (data frame with 116 
observations), but it doesn't work for "bradytrain" when I use kfold 
function.
"bradytrain" is also a data frame but with 93 observations.  The message 
is in Sapnish, but basically say that element 1 is empty.
  Thank you very much in advance.
  Best,

Manuel

-- 
Manuel Sp?nola, Ph.D.
Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
Universidad Nacional
Apartado 1350-3000
Heredia
COSTA RICA
mspinola at una.ac.cr
mspinola10 at gmail.com
Tel?fono: (506) 2277-3598
Fax: (506) 2237-7036


From mdsumner at gmail.com  Sat Oct  2 14:30:46 2010
From: mdsumner at gmail.com (Michael Sumner)
Date: Sat, 2 Oct 2010 22:30:46 +1000
Subject: [R-sig-Geo] Proper PROJ settings for lat-long?
In-Reply-To: <AANLkTin+EPQ0mahH+cQp1F8U5HT8kZ3OYHZ_grzGe3_z@mail.gmail.com>
References: <AANLkTin+EPQ0mahH+cQp1F8U5HT8kZ3OYHZ_grzGe3_z@mail.gmail.com>
Message-ID: <AANLkTimU4BCW8jZu5Pwt3AtPtW6sdyXMAsXvfHa_OEC_@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101002/8148d9d0/attachment.pl>

From basille at ase-research.org  Sat Oct  2 17:56:12 2010
From: basille at ase-research.org (Mathieu Basille)
Date: Sat, 02 Oct 2010 11:56:12 -0400
Subject: [R-sig-Geo] Step characteristics on raster maps
In-Reply-To: <AANLkTin0eTU+XRSGn8SMALq8X971o23kmxH=GmzVvQ62@mail.gmail.com>
References: <4CA4869E.8000405@ase-research.org>	<AANLkTim5WMwCdQsVJHoB82mRvfsWzXdzbOO75_ESF2FP@mail.gmail.com>	<4CA4DD7F.4070306@ase-research.org>
	<AANLkTin0eTU+XRSGn8SMALq8X971o23kmxH=GmzVvQ62@mail.gmail.com>
Message-ID: <4CA7561C.6070603@ase-research.org>

Dear Robert,

This is amazing! Exactly what I needed :)
I really want to thank you for this addition.

So far, I managed to make it work on a rather limited example (3 
segments...):

r <- raster(nrow=18, ncol=9)
r[] <- rep(c(1, 2, 3, 4), c(40, 41, 40, 41))

cds1 <- rbind(c(-50,0), c(0,60))
cds2 <- rbind(c(80,20), c(140,60))
cds3 <- rbind(c(-180,-20), c(-140,-60))
lines <- SpatialLines(list(Lines(list(Line(cds1)), "1"), 
Lines(list(Line(cds2)), "2"), Lines(list(Line(cds3)), "3") ))

image(r)
abline(h = (-10:10)*10, col = grey(0.5))
abline(v = (-10:10)*20, col = grey(0.5))
plot(lines, add = TRUE)

lineValues(lines, r)

And it gives exactly what I want. Now, it seemed a little bit slow on my 
personal computer which is actually dying... I'll have to test in on 
real conditions (on a real computer...) to see how long it'll take with 
real trajectories (hundreds of thousands of segments over a large 
raster). And I still have to find a way to convert different ltraj to 
list of segments (to make sure that each segment is a 'Lines', but this 
does not sound like a difficult task.

Once again, thanks a lot for this function!
Mathieu.


Le 02/10/2010 06:10, Robert J. Hijmans a ?crit :
> On Thu, Sep 30, 2010 at 9:57 PM, Mathieu Basille
> <basille at ase-research.org>  wrote:
>> Dear Robert,
>>
>> I just understood the interest of 'crosstab' with 'mask', this is pretty
>> neat! Thanks for the suggestion.
>>
>> However, I can see some potential drawbacks with this approach: as my
>> objective is to describe each step (each segment), I should first cut
>> each 'SpatialLines' into a list of 'Lines', each 'Lines' being a segment
>> (and not the whole trajectory). I apology if I'm totally wrong, I'm not
>> that familiar with SpatialLines...
>>
>> But then, what about crossing/overlaping segments, i.e. several segments
>> that all fall in the same pixel (which usually happens a lot)? With
>> linesToRaster, only the last segment would be kept. So that I should run
>> independently the approach for each 'Line' (each segment) just to avoid
>> these crossings, and that would result in as many new rasters as the
>> number of segments (and I'm talking about hundreds of thousands here,
>> over large rasters).
>>
>
>
> You are right, of course. I have added a function "lineValues" (akin
> to "polygonValues" that existed) to the raster package. This function
> should not have this problem. It is in the development version
> available from R-Forge, please try it if you can.
>
> Robert
>
>>
>> Basically, to rephrase my problem, here is what I want to achieve. Given
>> a set of points (say a SpatialPointsDataFrame, or SpatialLinesDataFrame,
>> or ltraj), I'd like to be able to compute new variables that give for
>> each point summaries or characteristics (e.g. proportion of each type of
>> the raster if it is categorical, or mean if is continuous) of the
>> segment from that point to the next (or previous, it doesn't matter).
>>
>> It seems to be a simple problem in terms of low-level functions
>> (segments over raster), but a complex one in terms of data structure (an
>> single object with a set of individual trajectories which are themselves
>> sets of segments). And I have to admit that I have some troubles going
>> from the former to the latter.
>>
>> Thanks again for your time,
>> Mathieu.
>>
>>
>> Le 2010-09-30 11:28, Robert J. Hijmans a ?crit :
>>> Perhaps you can do something like
>>>
>>> r is a Raster* object
>>> line is a SpatialLines* object
>>>
>>> library(raster)
>>> rr<- linesToRaster(line, r)
>>> rm<- mask(r, rr)
>>> crosstab(rm, rr)
>>>
>>> Robert
>>>
>>> On Thu, Sep 30, 2010 at 5:46 AM, Mathieu Basille
>>> <basille at ase-research.org>  wrote:
>>>> Dear list members,
>>>>
>>>> I'm trying to compute characteristics along steps (i.e. segments between two
>>>> points), based on underlying raster maps. The steps originally come from
>>>> radiotracking data, converted to ltraj objects (adehabitat). The idea is to
>>>> compute (for example) the habitat composition corresponding to each step
>>>> instead of each points, as we are interesting in the movement path.
>>>>
>>>> I tried different solutions, as I would like to do it with R. I did not find
>>>> any solution using adehabitat (or the development versions adehabitatMA/LS);
>>>> 'join' only works for point characteristics, not steps. I also tried using
>>>> sp and SpatialLinesDataFrame, but overlay does not seem to work with
>>>> SpatialLines(DataFrame) and SpatialPixelsDataFrame:
>>>>
>>>> Error in function (classes, fdef, mtable)  :
>>>>   unable to find an inherited method for function "overlay", for signature
>>>> "SpatialPixelsDataFrame", "SpatialLinesDataFrame"
>>>>
>>>> I also investigated packages raster, trip, and rgeos, without success. Maybe
>>>> the low level functions of rgeos could be used, but it seems a bit out of my
>>>> skills (and time available) at the moment.
>>>>
>>>> Another solution might be to use spgrass6 in conjunction with GRASS, but I'm
>>>> not familiar enough with GRASS to judge if it is a viable alternative...
>>>>
>>>> I'd welcome any hints/thoughts on this question.
>>>> Sincerely,
>>>> Mathieu Basille.
>>>>
>>>>
>>>> --
>>>>
>>>> ~$ whoami
>>>> Mathieu Basille, Post-Doc
>>>>
>>>> ~$ locate
>>>> Laboratoire d'?cologie Comportementale et de Conservation de la Faune
>>>> + Centre d'?tude de la For?t
>>>> D?partement de Biologie
>>>> Universit? Laval, Qu?bec
>>>>
>>>> ~$ info
>>>> http://ase-research.org/basille
>>>>
>>>> ~$ fortune
>>>> ``If you can't win by reason, go for volume.''
>>>> Calvin, by Bill Watterson.
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at stat.math.ethz.ch
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>
>> --
>>
>> ~$ whoami
>> Mathieu Basille, Post-Doc
>>
>> ~$ locate
>> Laboratoire d'?cologie Comportementale et de Conservation de la Faune
>> + Centre d'?tude de la For?t
>> D?partement de Biologie
>> Universit? Laval, Qu?bec
>>
>> ~$ info
>> http://ase-research.org/basille
>>
>> ~$ fortune
>> ``If you can't win by reason, go for volume.''
>> Calvin, by Bill Watterson.
>>

-- 

~$ whoami
Mathieu Basille, Post-Doc

~$ locate
Laboratoire d'?cologie Comportementale et de Conservation de la Faune
+ Centre d'?tude de la For?t
D?partement de Biologie
Universit? Laval, Qu?bec

~$ info
http://ase-research.org/basille

~$ fortune
``If you can't win by reason, go for volume.''
Calvin, by Bill Watterson.


From r.hijmans at gmail.com  Sat Oct  2 20:11:59 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sat, 2 Oct 2010 21:11:59 +0300
Subject: [R-sig-Geo] Error with function kfold in package dismo
In-Reply-To: <4CA72188.4060601@gmail.com>
References: <4CA72188.4060601@gmail.com>
Message-ID: <AANLkTikD8KYFPUVZZVCjP3TfunM9hSK7Nwz_OMi-Weit@mail.gmail.com>

Manuel,

This looks like a bug in 'raster' that I think I have fixed in version
1.5-13 (should be available on R-Forge in 24 hrs or so).

As a work around, you can save ascii files to binary (once):

predictores <- writeRaster(predictores, 'predictores.grd' )
# or
predictores <- writeRaster(predictores, 'predictores.tif' )

and then in the script use:

predictores <- brick('predictores.grd')
# or
predictores <- brick('predictores.tif')


This also has the advantage of being much faster.

Robert

On Sat, Oct 2, 2010 at 3:11 PM, Manuel Sp?nola <mspinola10 at gmail.com> wrote:
> ?Dear list members,
>
> I got this error in package "dismo".
>
> fold <- kfold(bradypus, k=5)
>> bradytrain <- bradypus[fold != 1, ]
>> me <- maxent(predictores, bradytrain)
> Error en .readRowsAscii(raster, rows[i], 1) : elemento 1 esta vacio;
> ?la parte de la lista de argumentos ?'>' ha sido evaluada:
> ? (startcol, 1)
>
> Function maxent works perfect for "bradypus" (data frame with 116
> observations), but it doesn't work for "bradytrain" when I use kfold
> function.
> "bradytrain" is also a data frame but with 93 observations. ?The message is
> in Sapnish, but basically say that element 1 is empty.
> ?Thank you very much in advance.
> ?Best,
>
> Manuel
>
> --
> Manuel Sp?nola, Ph.D.
> Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
> Universidad Nacional
> Apartado 1350-3000
> Heredia
> COSTA RICA
> mspinola at una.ac.cr
> mspinola10 at gmail.com
> Tel?fono: (506) 2277-3598
> Fax: (506) 2237-7036
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From jorgefernandosaraiva at gmail.com  Sat Oct  2 21:42:52 2010
From: jorgefernandosaraiva at gmail.com (Jorge Fernando Saraiva de Menezes)
Date: Sat, 2 Oct 2010 16:42:52 -0300
Subject: [R-sig-Geo] all localR2 has NA values in gwr
In-Reply-To: <alpine.LRH.2.00.1010011528240.10829@reclus.nhh.no>
References: <AANLkTi=cx0btJ23P0-2VRaQyjUcQXW-VBftCDTVNCi-L@mail.gmail.com>
	<4CA4FDCF.4080909@mail.montclair.edu>
	<alpine.LRH.2.00.1010010824500.10143@reclus.nhh.no>
	<alpine.LRH.2.00.1010011528240.10829@reclus.nhh.no>
Message-ID: <AANLkTikSt84tQKahp5+4pjGL5586goJc5nAGMbrWUVv+@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101002/342899b2/attachment.pl>

From r.hijmans at gmail.com  Sat Oct  2 23:41:37 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sun, 3 Oct 2010 00:41:37 +0300
Subject: [R-sig-Geo] creating maps for raster interpolation
In-Reply-To: <AANLkTin2Uy_JGchbxDyEOdYtn8a_ihiBgFeBBLWpEZNM@mail.gmail.com>
References: <AANLkTin2Uy_JGchbxDyEOdYtn8a_ihiBgFeBBLWpEZNM@mail.gmail.com>
Message-ID: <AANLkTi=8ODCqbqattA0w=gaNBWkF6Rj2VoBr_RUdPn_+@mail.gmail.com>

Ricardo,

Here is the basic idea of directly writing a plot to a pdf file:

x <- runif(100)
y <- runif(100)

pdf()
plot(x,y)
abline(0, 1, col='blue')
dev.off()


See ?pdf for more info.

Robert

On Fri, Oct 1, 2010 at 8:58 PM, Ricardo Rodr?guez
<ricardorodot02 at gmail.com> wrote:
> hi all, how I can create maps in pdf files directly in R with raster that
> are a result of interpolations gstat additionally as I can reclassify these
> raster files, I'm working script for the interpolation of points and values
> driving this from scratch to higher than 5, you can create a range of 10
> items for the classification of files.
>
> thank you all for your time and help
>
> Ricardo Rodr?guez
> Univalle
>
> ? ? ? ?[[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


From mspinola10 at gmail.com  Sun Oct  3 13:56:11 2010
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Sun, 03 Oct 2010 05:56:11 -0600
Subject: [R-sig-Geo] Error with function kfold in package dismo
In-Reply-To: <AANLkTikD8KYFPUVZZVCjP3TfunM9hSK7Nwz_OMi-Weit@mail.gmail.com>
References: <4CA72188.4060601@gmail.com>
	<AANLkTikD8KYFPUVZZVCjP3TfunM9hSK7Nwz_OMi-Weit@mail.gmail.com>
Message-ID: <4CA86F5B.802@gmail.com>

  Thank you very much Robert.
Best,

Manuel

On 02/10/2010 12:11 p.m., Robert J. Hijmans wrote:
> Manuel,
>
> This looks like a bug in 'raster' that I think I have fixed in version
> 1.5-13 (should be available on R-Forge in 24 hrs or so).
>
> As a work around, you can save ascii files to binary (once):
>
> predictores<- writeRaster(predictores, 'predictores.grd' )
> # or
> predictores<- writeRaster(predictores, 'predictores.tif' )
>
> and then in the script use:
>
> predictores<- brick('predictores.grd')
> # or
> predictores<- brick('predictores.tif')
>
>
> This also has the advantage of being much faster.
>
> Robert
>
> On Sat, Oct 2, 2010 at 3:11 PM, Manuel Sp?nola<mspinola10 at gmail.com>  wrote:
>>   Dear list members,
>>
>> I got this error in package "dismo".
>>
>> fold<- kfold(bradypus, k=5)
>>> bradytrain<- bradypus[fold != 1, ]
>>> me<- maxent(predictores, bradytrain)
>> Error en .readRowsAscii(raster, rows[i], 1) : elemento 1 esta vacio;
>>   la parte de la lista de argumentos  '>' ha sido evaluada:
>>    (startcol, 1)
>>
>> Function maxent works perfect for "bradypus" (data frame with 116
>> observations), but it doesn't work for "bradytrain" when I use kfold
>> function.
>> "bradytrain" is also a data frame but with 93 observations.  The message is
>> in Sapnish, but basically say that element 1 is empty.
>>   Thank you very much in advance.
>>   Best,
>>
>> Manuel
>>
>> --
>> Manuel Sp?nola, Ph.D.
>> Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
>> Universidad Nacional
>> Apartado 1350-3000
>> Heredia
>> COSTA RICA
>> mspinola at una.ac.cr
>> mspinola10 at gmail.com
>> Tel?fono: (506) 2277-3598
>> Fax: (506) 2237-7036
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>


-- 
Manuel Sp?nola, Ph.D.
Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
Universidad Nacional
Apartado 1350-3000
Heredia
COSTA RICA
mspinola at una.ac.cr
mspinola10 at gmail.com
Tel?fono: (506) 2277-3598
Fax: (506) 2237-7036


From a.mosnier at gmail.com  Sun Oct  3 16:04:52 2010
From: a.mosnier at gmail.com (Arnaud Mosnier)
Date: Sun, 3 Oct 2010 10:04:52 -0400
Subject: [R-sig-Geo] Step characteristics on raster maps (Mathieu
	Basille)
Message-ID: <AANLkTinCttoN9CLb76cuardDoJgbdu86zrw5L5cbdjqb@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101003/959fcca7/attachment.pl>

From gianni.lavaredo at gmail.com  Sun Oct  3 17:51:55 2010
From: gianni.lavaredo at gmail.com (gianni lavaredo)
Date: Sun, 3 Oct 2010 17:51:55 +0200
Subject: [R-sig-Geo] help with "Tps" function to create a surface
Message-ID: <AANLkTinETVLt21vNOTA3t1H_N3zTd5iD2FcDBHFWH0dJ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101003/b72aa989/attachment.pl>

From basille at ase-research.org  Sun Oct  3 17:59:53 2010
From: basille at ase-research.org (Mathieu Basille)
Date: Sun, 03 Oct 2010 11:59:53 -0400
Subject: [R-sig-Geo] Step characteristics on raster maps (Mathieu
	Basille)
In-Reply-To: <AANLkTinCttoN9CLb76cuardDoJgbdu86zrw5L5cbdjqb@mail.gmail.com>
References: <AANLkTinCttoN9CLb76cuardDoJgbdu86zrw5L5cbdjqb@mail.gmail.com>
Message-ID: <4CA8A879.60204@ase-research.org>

Dear Arnaud,

This is actually on my todo list, a test with the polygon approach, 
although I'm not sure how to start to "polygonize" the segments... But 
in the end, that would allow a performance comparison with different 
approaches (and that would also allow the calculation of the 
characteristics of buffers around the segments, which might be 
interesting for us, too).

Thanks for the suggestion,
Mathieu.


Le 03/10/2010 10:04, Arnaud Mosnier a ?crit :
> Hi Mathieu,
>
> An easy workaround could be to convert each segment to a polygon doing a
> very small buffer around each segment then use the overlay method to
> obtain info in each of these polygon.
>
> Arnaud

-- 

~$ whoami
Mathieu Basille, Post-Doc

~$ locate
Laboratoire d'?cologie Comportementale et de Conservation de la Faune
+ Centre d'?tude de la For?t
D?partement de Biologie
Universit? Laval, Qu?bec

~$ info
http://ase-research.org/basille

~$ fortune
``If you can't win by reason, go for volume.''
Calvin, by Bill Watterson.


From edzer.pebesma at uni-muenster.de  Sun Oct  3 18:08:49 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sun, 03 Oct 2010 18:08:49 +0200
Subject: [R-sig-Geo] Step characteristics on raster maps
	(Mathieu	Basille)
In-Reply-To: <4CA8A879.60204@ase-research.org>
References: <AANLkTinCttoN9CLb76cuardDoJgbdu86zrw5L5cbdjqb@mail.gmail.com>
	<4CA8A879.60204@ase-research.org>
Message-ID: <4CA8AA91.7070306@uni-muenster.de>

I don't know. I can't reproduce your example, and a simple example on
the meuse data set:

library(sp)
library(fields)
data(meuse)
Tps(data.frame(meuse$x,meuse$y), meuse$zinc)

seemed to work. You could provide a reproducable example, or you could
contact the author(s) of the fields package, I believe they're not
listening to this list.
--
Edzer

On 10/03/2010 05:59 PM, Mathieu Basille wrote:
> Dear Arnaud,
> 
> This is actually on my todo list, a test with the polygon approach,
> although I'm not sure how to start to "polygonize" the segments... But
> in the end, that would allow a performance comparison with different
> approaches (and that would also allow the calculation of the
> characteristics of buffers around the segments, which might be
> interesting for us, too).
> 
> Thanks for the suggestion,
> Mathieu.
> 
> 
> Le 03/10/2010 10:04, Arnaud Mosnier a ?crit :
>> Hi Mathieu,
>>
>> An easy workaround could be to convert each segment to a polygon doing a
>> very small buffer around each segment then use the overlay method to
>> obtain info in each of these polygon.
>>
>> Arnaud
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From clement.calenge at oncfs.gouv.fr  Sun Oct  3 18:09:14 2010
From: clement.calenge at oncfs.gouv.fr (=?ISO-8859-1?Q?Cl=E9ment_Calenge?=)
Date: Sun, 03 Oct 2010 18:09:14 +0200
Subject: [R-sig-Geo] Step characteristics on raster maps
	(Mathieu	Basille)
In-Reply-To: <4CA8A879.60204@ase-research.org>
References: <AANLkTinCttoN9CLb76cuardDoJgbdu86zrw5L5cbdjqb@mail.gmail.com>
	<4CA8A879.60204@ase-research.org>
Message-ID: <4CA8AAAA.4040809@oncfs.gouv.fr>

Or, if you want to use this approach for your problem (transforming a 
line into a polygon and then rasterize), a solution would be to use the 
function "buffer" from the package adehabitatMA (on RForge), which 
calculates a buffer from a SpatialLines.
Best regards,

Cl?ment.


On 10/03/2010 05:59 PM, Mathieu Basille wrote:
> Dear Arnaud,
>
> This is actually on my todo list, a test with the polygon approach, 
> although I'm not sure how to start to "polygonize" the segments... But 
> in the end, that would allow a performance comparison with different 
> approaches (and that would also allow the calculation of the 
> characteristics of buffers around the segments, which might be 
> interesting for us, too).
>
> Thanks for the suggestion,
> Mathieu.
>
>
> Le 03/10/2010 10:04, Arnaud Mosnier a ?crit :
>> Hi Mathieu,
>>
>> An easy workaround could be to convert each segment to a polygon doing a
>> very small buffer around each segment then use the overlay method to
>> obtain info in each of these polygon.
>>
>> Arnaud
>


-- 
Cl?ment CALENGE
Cellule d'appui ? l'analyse de donn?es
Direction des Etudes et de la Recherche
Office national de la chasse et de la faune sauvage
Saint Benoist - 78610 Auffargis
tel. (33) 01.30.46.54.14


From edzer.pebesma at uni-muenster.de  Sun Oct  3 18:10:10 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sun, 03 Oct 2010 18:10:10 +0200
Subject: [R-sig-Geo] help with "Tps" function to create a surface
In-Reply-To: <AANLkTinETVLt21vNOTA3t1H_N3zTd5iD2FcDBHFWH0dJ@mail.gmail.com>
References: <AANLkTinETVLt21vNOTA3t1H_N3zTd5iD2FcDBHFWH0dJ@mail.gmail.com>
Message-ID: <4CA8AAE2.70609@uni-muenster.de>

Sorry this went to the wrong thread.

I don't know. I can't reproduce your example, and a simple example on
the meuse data set:

library(sp)
library(fields)
data(meuse)
Tps(data.frame(meuse$x,meuse$y), meuse$zinc)

seemed to work. You could provide a reproducable example, or you could
contact the author(s) of the fields package, I believe they're not
listening to this list.
--
Edzer


On 10/03/2010 05:51 PM, gianni lavaredo wrote:
> Dear Researchers,
> 
> 
> I have a problem with Tps function. I tried several days and I am worked
> saturday night and I am working sunday, but I have always the same Error. I
> didn't find a solution in the web sorry.
> 
> I have a "SpatialPointsDataFrame" with X, Y and H value
> 
>> class( input.train)
> [1] "SpatialPointsDataFrame"
> attr(,"package")
> [1] "sp"
> 
> # extract X and Y
> x <- input.train at coords[,1]
> y <- input.train at coords[,2]
> xy <- data.frame(x,y)
> 
> # extract the value
> v <- input.train at data[,c("H")]
> 
> Tps(xy,v)
> 
> Errore in rep(0, n1 * n2) : argomento 'times' non valido
> Errore in out$W2 %d*% do.call(out$cov.function.name, c(out$args, list(x1 =
> out$knots,  :
>   error in evaluating the argument 'y' in selecting a method for function
> '%d*%'
> Errore in t(out$W2 %d*% do.call(out$cov.function.name, c(out$args, list(x1 =
> out$knots,  :
>   error in evaluating the argument 'x' in selecting a method for function
> 't'
> 
> 
> Sorry and thanks for Help
> Gianni
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From gianni.lavaredo at gmail.com  Sun Oct  3 18:21:32 2010
From: gianni.lavaredo at gmail.com (gianni lavaredo)
Date: Sun, 3 Oct 2010 18:21:32 +0200
Subject: [R-sig-Geo] help with "Tps" function to create a surface
In-Reply-To: <4CA8AAE2.70609@uni-muenster.de>
References: <AANLkTinETVLt21vNOTA3t1H_N3zTd5iD2FcDBHFWH0dJ@mail.gmail.com>
	<4CA8AAE2.70609@uni-muenster.de>
Message-ID: <AANLkTi=XcFCOQxH1XOfTy6iuOhcio9MtVvWUcAP44pvF@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101003/405370bf/attachment.pl>

From basille at ase-research.org  Mon Oct  4 01:56:23 2010
From: basille at ase-research.org (Mathieu Basille)
Date: Sun, 03 Oct 2010 19:56:23 -0400
Subject: [R-sig-Geo] Step characteristics on raster maps
	(Mathieu	Basille)
In-Reply-To: <4CA8AAAA.4040809@oncfs.gouv.fr>
References: <AANLkTinCttoN9CLb76cuardDoJgbdu86zrw5L5cbdjqb@mail.gmail.com>
	<4CA8A879.60204@ase-research.org> <4CA8AAAA.4040809@oncfs.gouv.fr>
Message-ID: <4CA91827.80307@ase-research.org>

Actually, I just found out this method for SpatialLines! Thanks for the 
suggestion, I'll run some tests with the different approaches and let 
the list know about the results of my investigations.

Thank you all for the help,
Mathieu.


Le 03/10/2010 12:09, Cl?ment Calenge a ?crit :
> Or, if you want to use this approach for your problem (transforming a
> line into a polygon and then rasterize), a solution would be to use the
> function "buffer" from the package adehabitatMA (on RForge), which
> calculates a buffer from a SpatialLines.
> Best regards,
>
> Cl?ment.
>
>
> On 10/03/2010 05:59 PM, Mathieu Basille wrote:
>> Dear Arnaud,
>>
>> This is actually on my todo list, a test with the polygon approach,
>> although I'm not sure how to start to "polygonize" the segments... But
>> in the end, that would allow a performance comparison with different
>> approaches (and that would also allow the calculation of the
>> characteristics of buffers around the segments, which might be
>> interesting for us, too).
>>
>> Thanks for the suggestion,
>> Mathieu.
>>
>>
>> Le 03/10/2010 10:04, Arnaud Mosnier a ?crit :
>>> Hi Mathieu,
>>>
>>> An easy workaround could be to convert each segment to a polygon doing a
>>> very small buffer around each segment then use the overlay method to
>>> obtain info in each of these polygon.
>>>
>>> Arnaud
>>
>
>

-- 

~$ whoami
Mathieu Basille, Post-Doc

~$ locate
Laboratoire d'?cologie Comportementale et de Conservation de la Faune
+ Centre d'?tude de la For?t
D?partement de Biologie
Universit? Laval, Qu?bec

~$ info
http://ase-research.org/basille

~$ fortune
``If you can't win by reason, go for volume.''
Calvin, by Bill Watterson.


From aramucia at hotmail.com  Mon Oct  4 11:07:14 2010
From: aramucia at hotmail.com (Arantzazu Blanco Bernardeau)
Date: Mon, 4 Oct 2010 09:07:14 +0000
Subject: [R-sig-Geo] nugget in variogram
In-Reply-To: <4CA4BD3A.1030304@uni-muenster.de>
References: <SNT127-W33D24FEFADC71E914CE391CE680@phx.gbl>,
	<4CA4BD3A.1030304@uni-muenster.de>
Message-ID: <SNT127-W42799CCFF61A2FD5709C0FCE6C0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101004/82b8ced0/attachment.pl>

From gianni.lavaredo at gmail.com  Mon Oct  4 11:26:04 2010
From: gianni.lavaredo at gmail.com (gianni lavaredo)
Date: Mon, 4 Oct 2010 11:26:04 +0200
Subject: [R-sig-Geo] Help find a package with "Modifed Quadratic Shepard",
 "Spline with tension", "inverse quadratic"
Message-ID: <AANLkTi=x6mhy5UzSRJXpEpbL-GbKGR5EcXs01om2Vj_A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101004/d42d5277/attachment.pl>

From edzer.pebesma at uni-muenster.de  Mon Oct  4 11:55:19 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 04 Oct 2010 11:55:19 +0200
Subject: [R-sig-Geo] nugget in variogram
In-Reply-To: <SNT127-W42799CCFF61A2FD5709C0FCE6C0@phx.gbl>
References: <SNT127-W33D24FEFADC71E914CE391CE680@phx.gbl>,
	<4CA4BD3A.1030304@uni-muenster.de>
	<SNT127-W42799CCFF61A2FD5709C0FCE6C0@phx.gbl>
Message-ID: <4CA9A487.3060604@uni-muenster.de>

Because you do not pass an (initial) nugget value to function vgm(), you
are fitting an exponential model without a nugget. Without a nugget
model, the nugget is (implicitly) zero. Compare:

> vgm(1, "Exp", 300)
  model psill range
1   Exp     1   300
> vgm(1, "Exp", 300, 1)
  model psill range
1   Nug     1     0
2   Exp     1   300

You are also wrong if you think that you now fix (as of: not fit)
parameters in the fit.variogram step; for this you have to pass
parameters fit.ranges and/or fit.sills; e.g. to fit the nugget but fix
the partial sill, pass fit.sills = c(TRUE,FALSE), to fix the nugget but
fit the partial sill, pass fit.sill=c(FALSE, TRUE).

On 10/04/2010 11:07 AM, Arantzazu Blanco Bernardeau wrote:
> Hello
> I am really glad of your answer, but for me it does not work as I would like
> So, my data are called cc (is a subset of a bigger spatialdataframe) and the variogram would be
> varcc=variogram(pf1_3atm~1,cc, width=500,cutoff=10000) 
>  
> Then I fix the sill and the range of the variogram
> inisill=var(cc at data$pf1_3atm,na.rm=T) 
> iniran=var$dist[varcc$gamma>0.9*inisill][1]
> varcc.fit=fit.variogram(varcc,vgm(psill=inisill, "Exp", iniran)) # I can not fix the nugget because the output gives errors ("Singular model")
> plot(varcc,varcc.fit)
>> varcc[1,"gamma"]  this would be the nugget (where the model cuts the axis)
> [1] 11.97
> The problem in the indicator you suggest is:
> varcc.fit$psill[1] / sum(varcc.fit$psill)= 1, because  varcc.fit$psill[1] = sum(varcc.fit$psill)
> as the output of varcc.fit gives:
> varcc.fit
>   model    psill    range
> 1   Exp 41.46455 1297.040
> 
> I have tried (don't know if it is correct):
>>  varcc[1,"gamma"]/sum(varcc.fit$psill)
> [1] 0.2886803
> (and this would mean that the spatial correlation is weak because we have a relative big nugget effect)
> Can this be done? 
> Thanks a lot again for your attention.
> 
>> Date: Thu, 30 Sep 2010 18:39:22 +0200
>> From: edzer.pebesma at uni-muenster.de
>> To: r-sig-geo at stat.math.ethz.ch
>> Subject: Re: [R-sig-Geo] nugget in variogram
>>
>>
>>
>> On 09/30/2010 04:13 PM, Arantzazu Blanco Bernardeau wrote:
>>> Hello everybody
>>> I am new on geostatistics so maybe my question is trivial or is
>>> already answered (I can not find the solution in the thread list). I
>>> have a variogram where I did not fix the nugget, because doing it
>>> was giving "singular models". I would like to know the nugget ratio
>>> of my variograms but I don't know how to get then the nugget value.
>>> So I did look in the output of variogram and did take the minimum
>>> value of gamma. Is this correct?
>>
>> Well, it's not the usual way, where you would fit a model:
>>
>> library(gstat)
>> data(meuse)
>> coordinates(meuse) = ~x+y
>> v = variogram(log(zinc)~1, meuse)
>> v.m = fit.variogram(v, vgm(1, "Sph", 500, 1))
>> v[1, "gamma"] # your estimator:
>> plot(v, v.m)
>> v.m$psill[1] / sum(v.m$psill) # the usual estimator:
>>
>> Only when you have plenty of measurements at very short distances
>> apart, I can imagine you would use the sample variogram (v) value.
>>
>>> Thanks very much for your attention. 
>>>  		 	   		  
>>> 	[[alternative HTML version deleted]]
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> -- 
>> Edzer Pebesma
>> Institute for Geoinformatics (ifgi), University of M?nster
>> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
>> 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
>> http://www.52north.org/geostatistics      e.pebesma at wwu.de
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>  		 	   		  

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From gianni.lavaredo at gmail.com  Mon Oct  4 14:52:29 2010
From: gianni.lavaredo at gmail.com (gianni lavaredo)
Date: Mon, 4 Oct 2010 14:52:29 +0200
Subject: [R-sig-Geo] problem with smooth.spline
Message-ID: <AANLkTi=5F2ieKn2W47aYAcsUNYQ7dnjstWi4ZNT841dL@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101004/1574dd45/attachment.pl>

From geomalik at live.com  Mon Oct  4 17:30:56 2010
From: geomalik at live.com (Malik Shahzad)
Date: Mon, 4 Oct 2010 22:30:56 +0700
Subject: [R-sig-Geo] Library for Satellite Images Classification\Segmentation
Message-ID: <SNT111-W376F20790F057A9C867AA4AC6C0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101004/31bc45d9/attachment.pl>

From landis at isciences.com  Mon Oct  4 17:35:16 2010
From: landis at isciences.com (Matthew Landis)
Date: Mon, 04 Oct 2010 11:35:16 -0400
Subject: [R-sig-Geo] Library for Satellite Images
	Classification\Segmentation
In-Reply-To: <SNT111-W376F20790F057A9C867AA4AC6C0@phx.gbl>
References: <SNT111-W376F20790F057A9C867AA4AC6C0@phx.gbl>
Message-ID: <4CA9F434.5050604@isciences.com>

  Dear Malik,

The raster package will probably do a lot of what you want.  That's 
where I'd start.

M


-- 
~~~~~~~~~~~~~~~~~~~~~~~~~~
Matthew Landis, Ph.D.
Research Scientist
ISciences, LLC
61 Main St. Suite 200
Burlington VT 05401
~~~~~~~~~~~~~~~~~~~~~~~~~~



On 10/4/2010 11:30 AM, Malik Shahzad wrote:
> Dear I am new to R. I need help to know that which library is good to open High resolution (Satellite) Images in R and for classification\segmentation.
>
>
>
> Thanks in Advance...
> with Best Regards,
>
> Malik Shahzad
> Visiting Researcher
> National Institute of Informatics (NII)
> Tokyo, Japan
>
> Doctoral Student
> Asian Institute of Technology (AIT)
> Bangkok, Thailand
> +66-8-7676-5616
>
>
>
>   		 	   		
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From kmcoulib at gmail.com  Mon Oct  4 17:56:20 2010
From: kmcoulib at gmail.com (kapo coulibaly)
Date: Mon, 4 Oct 2010 11:56:20 -0400
Subject: [R-sig-Geo] Help find a package with "Modifed Quadratic
 Shepard", "Spline with tension", "inverse quadratic"
In-Reply-To: <AANLkTi=x6mhy5UzSRJXpEpbL-GbKGR5EcXs01om2Vj_A@mail.gmail.com>
References: <AANLkTi=x6mhy5UzSRJXpEpbL-GbKGR5EcXs01om2Vj_A@mail.gmail.com>
Message-ID: <AANLkTinJGMPOCE5VgVxgp3SULpyTKa07RgXGnvkQeM19@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101004/6d61960d/attachment.pl>

From ricardorodot02 at gmail.com  Mon Oct  4 22:15:05 2010
From: ricardorodot02 at gmail.com (=?ISO-8859-1?Q?Ricardo_Rodr=EDguez?=)
Date: Mon, 4 Oct 2010 15:15:05 -0500
Subject: [R-sig-Geo] xml package not install
Message-ID: <AANLkTikEhVhpwenQ9omqudzrEv=h+J7VP89K51-x-yxU@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101004/34e950a6/attachment.pl>

From j.m.signer at gmail.com  Mon Oct  4 22:53:08 2010
From: j.m.signer at gmail.com (Johannes Signer)
Date: Mon, 4 Oct 2010 22:53:08 +0200
Subject: [R-sig-Geo] xml package not install
In-Reply-To: <AANLkTikEhVhpwenQ9omqudzrEv=h+J7VP89K51-x-yxU@mail.gmail.com>
References: <AANLkTikEhVhpwenQ9omqudzrEv=h+J7VP89K51-x-yxU@mail.gmail.com>
Message-ID: <AANLkTi=7VHnB7wXrBPFh7-sbu=SZT0B1C=wE2qYPt+ah@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101004/dd001650/attachment.pl>

From horning at amnh.org  Mon Oct  4 23:08:26 2010
From: horning at amnh.org (Ned Horning)
Date: Mon, 04 Oct 2010 17:08:26 -0400
Subject: [R-sig-Geo] Extract area of overlapping images
Message-ID: <4CAA424A.2030504@amnh.org>

Hi - I'm trying to extract the rectangle of pixels formed by the overlap 
of two images to try different image normalization techniques. I'm 
trying the following code but this results in integer vectors 
(image1subset and image2subset) of different lengths. I thought that by 
intersecting the two images and then applying that intersected area to 
the individual images I'd have two image subsets of equal size. I think 
I'm missing something basic. Can someone provide insight into how I can 
do this?

Thanks in advance,

Ned

--
image1Raster <- raster(image1)
image2Raster <- raster(image2)

NAvalue(image1Raster) <- 0
NAvalue(image2Raster) <- 0

intersect <- intersectExtent(image1Raster, image2Raster)

image1subset <- getValuesExtent(image1Raster, intersect)
image2subset <- getValuesExtent(image2Raster, intersect)


From ricardorodot02 at gmail.com  Tue Oct  5 00:58:36 2010
From: ricardorodot02 at gmail.com (=?ISO-8859-1?Q?Ricardo_Rodr=EDguez?=)
Date: Mon, 4 Oct 2010 17:58:36 -0500
Subject: [R-sig-Geo] gis packages not work in rpy2
Message-ID: <AANLkTin1BDF6Ne4SMuMLaAQdp01zStq6ts2KXUHm90-w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101004/1cba55a7/attachment.pl>

From eac16 at psu.edu  Tue Oct  5 05:20:19 2010
From: eac16 at psu.edu (Elizabeth Crisfield)
Date: Mon, 4 Oct 2010 23:20:19 -0400
Subject: [R-sig-Geo] Raster package writeRaster format="NCF"
Message-ID: <AANLkTik5XNG7x8kzOYrrq7WqCULgmqkXi3vDpEeECknE@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101004/f0c6763b/attachment.pl>

From hengl at spatial-analyst.net  Tue Oct  5 09:27:32 2010
From: hengl at spatial-analyst.net (Tomislav Hengl)
Date: Tue, 05 Oct 2010 09:27:32 +0200
Subject: [R-sig-Geo] Step characteristics on raster maps
In-Reply-To: <4CA4DD7F.4070306@ase-research.org>
References: <4CA4869E.8000405@ase-research.org>	<AANLkTim5WMwCdQsVJHoB82mRvfsWzXdzbOO75_ESF2FP@mail.gmail.com>
	<4CA4DD7F.4070306@ase-research.org>
Message-ID: <4CAAD364.5030305@spatial-analyst.net>


Hi Basile,

If you work with large data, then you should definitively consider using 
SAGA GIS. Here are some examples:

--------------

# download gridded data:
 > 
download.file("http://geomorphometry.org/sites/default/files/volcano_maungawhau.zip", 
destfile=paste(getwd(), "volcano_maungawhau.zip", sep="/"))
 > unzip("volcano_maungawhau.zip")
 > volcano <- readGDAL("volcano_maungawhau.asc")
 > writeGDAL(volcano, "volcano_dem.sdat", "SAGA")

# create a shape file:
 > tmp <- 
list(Lines(list(Line(data.frame(x=c(2667700,2667700),y=c(6479520,6478720)))), 
"1"))
 > trans <- SpatialLinesDataFrame(SpatialLines(tmp), 
data.frame(ID=c("1")), match.ID=FALSE)
 > writeOGR(trans, "trans.shp", "trans", "ESRI Shapefile")

# overlay shapes over grids:
 > rsaga.get.usage("shapes_grid", 1)
SAGA CMD 2.0.4
library path:   C:/PROGRA~1/R/R-211~1.1/library/RSAGA/saga_vc/modules
library name:   shapes_grid
module name :   Get Grid Data for Shapes
Usage: 1 -SHAPES <str> -GRIDS <str> -RESULT <str> [-INTERPOL <num>]
   -SHAPES:<str>         Shapes
         Shapes (input)
   -GRIDS:<str>          Grids
         Grid list (input)
   -RESULT:<str>         Shapes (Grid Information)
         Shapes (output)
   -INTERPOL:<num>       Interpolation
         Choice
         Available Choices:
         [0] Nearest Neighbor
         [1] Bilinear Interpolation
         [2] Inverse Distance Interpolation
         [3] Bicubic Spline Interpolation
 > rsaga.geoprocessor("shapes_grid", 1, param=list(SHAPES="trans.shp", 
GRIDS="volcano_dem.sgrd", RESULT="trans_ov.shp", INTERPOL=0))
# get's an error message; looks like a bug :(

# convert segments to points:
 > rsaga.geoprocessor("shapes_points", 5, 
param=list(POINTS="trans_pt.shp", LINES="trans.shp", ADD=TRUE, DIST=20))
# now overlay points and lines:
 > trans.pt <- readOGR("trans_pt.shp", "trans_pt")
 > ov.trans <- overlay(volcano, trans.pt)
 > summary(ov.trans)
Object of class SpatialPointsDataFrame
Coordinates:
               min     max
coords.x1 2667700 2667700
coords.x2 6478740 6479520
Is projected: NA
proj4string : [NA]
Number of points: 41
Data attributes:
    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
   109.0   134.0   158.0   150.7   166.0   195.0

--------------


T. Hengl
[http://www.wewur.wur.nl/popups/vcard.aspx?id=HENGL001]


Op 30-9-2010 20:57, Mathieu Basille schreef:
> Dear Robert,
>
> I just understood the interest of 'crosstab' with 'mask', this is pretty
> neat! Thanks for the suggestion.
>
> However, I can see some potential drawbacks with this approach: as my
> objective is to describe each step (each segment), I should first cut
> each 'SpatialLines' into a list of 'Lines', each 'Lines' being a segment
> (and not the whole trajectory). I apology if I'm totally wrong, I'm not
> that familiar with SpatialLines...
>
> But then, what about crossing/overlaping segments, i.e. several segments
> that all fall in the same pixel (which usually happens a lot)? With
> linesToRaster, only the last segment would be kept. So that I should run
> independently the approach for each 'Line' (each segment) just to avoid
> these crossings, and that would result in as many new rasters as the
> number of segments (and I'm talking about hundreds of thousands here,
> over large rasters).
>
> Basically, to rephrase my problem, here is what I want to achieve. Given
> a set of points (say a SpatialPointsDataFrame, or SpatialLinesDataFrame,
> or ltraj), I'd like to be able to compute new variables that give for
> each point summaries or characteristics (e.g. proportion of each type of
> the raster if it is categorical, or mean if is continuous) of the
> segment from that point to the next (or previous, it doesn't matter).
>
> It seems to be a simple problem in terms of low-level functions
> (segments over raster), but a complex one in terms of data structure (an
> single object with a set of individual trajectories which are themselves
> sets of segments). And I have to admit that I have some troubles going
> from the former to the latter.
>
> Thanks again for your time,
> Mathieu.
>
>
> Le 2010-09-30 11:28, Robert J. Hijmans a ?crit :
>> Perhaps you can do something like
>>
>> r is a Raster* object
>> line is a SpatialLines* object
>>
>> library(raster)
>> rr<- linesToRaster(line, r)
>> rm<- mask(r, rr)
>> crosstab(rm, rr)
>>
>> Robert
>>
>> On Thu, Sep 30, 2010 at 5:46 AM, Mathieu Basille
>> <basille at ase-research.org>  wrote:
>>> Dear list members,
>>>
>>> I'm trying to compute characteristics along steps (i.e. segments between two
>>> points), based on underlying raster maps. The steps originally come from
>>> radiotracking data, converted to ltraj objects (adehabitat). The idea is to
>>> compute (for example) the habitat composition corresponding to each step
>>> instead of each points, as we are interesting in the movement path.
>>>
>>> I tried different solutions, as I would like to do it with R. I did not find
>>> any solution using adehabitat (or the development versions adehabitatMA/LS);
>>> 'join' only works for point characteristics, not steps. I also tried using
>>> sp and SpatialLinesDataFrame, but overlay does not seem to work with
>>> SpatialLines(DataFrame) and SpatialPixelsDataFrame:
>>>
>>> Error in function (classes, fdef, mtable)  :
>>>   unable to find an inherited method for function "overlay", for signature
>>> "SpatialPixelsDataFrame", "SpatialLinesDataFrame"
>>>
>>> I also investigated packages raster, trip, and rgeos, without success. Maybe
>>> the low level functions of rgeos could be used, but it seems a bit out of my
>>> skills (and time available) at the moment.
>>>
>>> Another solution might be to use spgrass6 in conjunction with GRASS, but I'm
>>> not familiar enough with GRASS to judge if it is a viable alternative...
>>>
>>> I'd welcome any hints/thoughts on this question.
>>> Sincerely,
>>> Mathieu Basille.
>>>
>>>
>>> --
>>>
>>> ~$ whoami
>>> Mathieu Basille, Post-Doc
>>>
>>> ~$ locate
>>> Laboratoire d'?cologie Comportementale et de Conservation de la Faune
>>> + Centre d'?tude de la For?t
>>> D?partement de Biologie
>>> Universit? Laval, Qu?bec
>>>
>>> ~$ info
>>> http://ase-research.org/basille
>>>
>>> ~$ fortune
>>> ``If you can't win by reason, go for volume.''
>>> Calvin, by Bill Watterson.
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>


From aubreymoore at guam.net  Tue Oct  5 11:56:35 2010
From: aubreymoore at guam.net (Aubrey Moore)
Date: Tue, 05 Oct 2010 19:56:35 +1000
Subject: [R-sig-Geo] syntax problem with r.mapcalculator
Message-ID: <4CAAF653.1010200@guam.net>

  I created a raster map, "R20101001", using v.surf.rst.  The 
interpolation overshoots and dips below zero in a few areas.  I'd like 
to use r.mapcalculator, called from spgrass6, to replace all negative 
values with zeros.  But I can't seem to get the syntax right.  The 
following fails and produces the error message: "The system cannot find 
the file specified."

execGRASS("r.mapcalculator", flags = c("overwrite"),
    parameters=list(outfile="result", amap="R20100101", 
formula='if(A<0,0,A)'))

I would appreciate it if anyone can spot the mistake.


From Roger.Bivand at nhh.no  Tue Oct  5 12:58:36 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 5 Oct 2010 12:58:36 +0200 (CEST)
Subject: [R-sig-Geo] spatial interaction models
In-Reply-To: <AANLkTi=ztT0NB-g0bbDsmqjLKemjA2V2NT2T0S56bH65@mail.gmail.com>
References: <AANLkTi=ztT0NB-g0bbDsmqjLKemjA2V2NT2T0S56bH65@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1010051254330.28869@reclus.nhh.no>

On Fri, 1 Oct 2010, Carson Farmer wrote:

> Hi List,
>
> This question has come up with the past, but I have yet to find a
> clear response, so I'm going to ask myself.
> Has anyone had much experience with spatial interaction models,
> specifically in the form of Poisson regression?
> I'm a bit unsure of how to operationalize this using glm(), and would
> appreciate any pointers from those with more experience.

Maybe just do it in the usual way, repeating the i and j specific 
variables? Unless you want to constrain anything, it shouldn't be more 
than reshaping to long format and rep()'ing the origin and destination 
variables, should it? Maybe provide a link to data and output using other 
approaches?

Roger

>
> Basically, the conventional origin constrained model would look
> something like this:
> T_{ij} = exp(\delta_{i} + \log{A_{j}} - \beta D_{ij}) ~ \varepsilon_{ij}
> where \delta_{i} is a constant parameter speci?c to the ith zone,
> A_{j} is the attractiveness of the jth location, and D_{ij} is the
> distance between i and j.
> Note that \varepsilon_{ij} is just the multiplicative error term of
> the ?ow from i to j, and \beta is the distance decay parameter.
>
> Similarly, the doubly constrained model follows the form:
> T_{ij} = exp(\delta_{i} + \gamma_{j} - \beta D_{ij}) ~ \varepsilon_{ij}
> where everything is defined as above, except exp(\gamma_{j}) is an
> estimate of the attractiveness of location A_{j}.
>
> Hopefully the above description makes things a bit clearer,
> essentially my question is this:
> What factors or in what form do I have to have my data in order to be
> able to run such a model following the glm syntax?
> I know this should be relatively straight-forward, I just can't seem
> to get my head wrapped around it at the moment?
> If it helps, I can provide some sample data to those who request it.
>
> Thanks in advance,
>
> Carson
>
> -- 
> Carson J. Q. Farmer
> ISSP Doctoral Fellow
> National Centre for Geocomputation
> National University of Ireland, Maynooth,
> http://www.carsonfarmer.com/
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From jfloeter at uni-hamburg.de  Tue Oct  5 12:57:07 2010
From: jfloeter at uni-hamburg.de (Jens Floeter)
Date: Tue, 05 Oct 2010 12:57:07 +0200
Subject: [R-sig-Geo] How to calculate a cross-correlogram based on Morans I
Message-ID: <4CAB0483.5090102@uni-hamburg.de>

  Dear list members,

i need a hint - i am stuck on my search for a function.

I would like to calculate cross-correlograms between two variables 
(predator and prey densities) and use this as an index of spatial overlap.

I used the spdep pakcage and use e.g.

sp.correlogram(xy.data.nb, prey, order = 5 , method = "I", 
zero.policy=TRUE, style = "W")
sp.correlogram(xy.data.nb, predator, order = 5 , method = "I", 
zero.policy=TRUE, style = "W")

to calculate the (auto-) correlograms for predator and prey individually.

But how do i combine them to calculate the cross-correlogram ?

Any hint would be highly appreciated...

Best wishes !
jens


From rainer.stuetz at gmail.com  Tue Oct  5 13:01:03 2010
From: rainer.stuetz at gmail.com (Rainer Stuetz)
Date: Tue, 5 Oct 2010 13:01:03 +0200
Subject: [R-sig-Geo] xml package not install
In-Reply-To: <AANLkTikEhVhpwenQ9omqudzrEv=h+J7VP89K51-x-yxU@mail.gmail.com>
References: <AANLkTikEhVhpwenQ9omqudzrEv=h+J7VP89K51-x-yxU@mail.gmail.com>
Message-ID: <AANLkTineixEr1EcGTTEvxMiWbp36_bs+6GeQTOjkhj34@mail.gmail.com>

On Mon, Oct 4, 2010 at 10:15 PM, Ricardo Rodr?guez
<ricardorodot02 at gmail.com> wrote:
> hi all, I have problems with ?installation of package 'XML' ?and I need as
> rgdal not working with grass for lack of this package suggestions.
>
> * installing *source* package ?XML? ...
> ....
> checking for xml2-config... no
> Cannot find xml2-config
> ERROR: configuration failed for package ?XML?

The xml2-config script installed by LIBXML could not be found on your system.
You didn't specify your distribution, but for example in Debian/Ubuntu
you need to
install the libxml2-dev package:

> apt-file search xml2-config
libxml2-dev: /usr/bin/xml2-config
libxml2-dev: /usr/share/man/man1/xml2-config.1.gz
> sudo apt-get install libxml2-dev

Also see this: http://cran.r-project.org/web/packages/XML/INSTALL

HTH,
Rainer


From Roger.Bivand at nhh.no  Tue Oct  5 13:28:14 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 5 Oct 2010 13:28:14 +0200 (CEST)
Subject: [R-sig-Geo] syntax problem with r.mapcalculator
In-Reply-To: <4CAAF653.1010200@guam.net>
References: <4CAAF653.1010200@guam.net>
Message-ID: <alpine.LRH.2.00.1010051322050.28869@reclus.nhh.no>

On Tue, 5 Oct 2010, Aubrey Moore wrote:

>
> I created a raster map, "R20101001", using v.surf.rst.  The interpolation 
> overshoots and dips below zero in a few areas.  I'd like to use 
> r.mapcalculator, called from spgrass6, to replace all negative values with 
> zeros.  But I can't seem to get the syntax right.  The following fails and 
> produces the error message: "The system cannot find the file specified."
>
> execGRASS("r.mapcalculator", flags = c("overwrite"),
>   parameters=list(outfile="result", amap="R20100101", 
> formula='if(A<0,0,A)'))
>
> I would appreciate it if anyone can spot the mistake.

library(spgrass6)
data(meuse.grid)
coordinates(meuse.grid) <- c("x", "y")
gridded(meuse.grid) <- TRUE
fullgrid(meuse.grid) <- TRUE
meuse.grid$ddev <- meuse.grid$dist - mean(meuse.grid$dist, na.rm=TRUE)
loc <- initGRASS("/home/rsb/topics/GRASS/g640/grass-6.4.0",
   home=tempdir(), SG=meuse.grid)
writeRAST6(meuse.grid["ddev"], "ddev")
execGRASS("r.mapcalculator", flags = c("overwrite"),
   parameters=list(outfile="result", amap="ddev", formula="'if(A<0,0,A)'"))
res <- readRAST6("result")
summary(res)
summary(meuse.grid["ddev"])

works for me under Linux with: formula="'if(A<0,0,A)'", protecting the 
inner quotes with outer quotes. On Windows the incantation will be 
different, possibly:

execGRASS("r.mapcalculator", flags = c("overwrite"),
   parameters=list(outfile="result", amap="ddev",
     formula="\"if(A<0,0,A)\""))

(untried on Windows, also works on Linux).

Hope this helps,

Roger

PS. The statsgrass list has more direct access to GRASS users and 
developers with experience of shell quoting solutions.


>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From geomalik at live.com  Tue Oct  5 14:09:38 2010
From: geomalik at live.com (Malik Shahzad)
Date: Tue, 5 Oct 2010 19:09:38 +0700
Subject: [R-sig-Geo] Syntax for reading & Ploting Satellite Image using
	raster library
Message-ID: <SNT111-W503D1FEC7603ACF8488349AC6D0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101005/4e173f27/attachment.pl>

From moshersteven at gmail.com  Tue Oct  5 18:38:05 2010
From: moshersteven at gmail.com (steven mosher)
Date: Tue, 5 Oct 2010 09:38:05 -0700
Subject: [R-sig-Geo] Raster package writeRaster format="NCF"
In-Reply-To: <AANLkTik5XNG7x8kzOYrrq7WqCULgmqkXi3vDpEeECknE@mail.gmail.com>
References: <AANLkTik5XNG7x8kzOYrrq7WqCULgmqkXi3vDpEeECknE@mail.gmail.com>
Message-ID: <AANLkTincyE128k4r5H702PaBo2_VvbpOj2h_gW4qrau2@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101005/abff1102/attachment.pl>

From moshersteven at gmail.com  Tue Oct  5 18:42:07 2010
From: moshersteven at gmail.com (steven mosher)
Date: Tue, 5 Oct 2010 09:42:07 -0700
Subject: [R-sig-Geo] Syntax for reading & Ploting Satellite Image using
 raster library
In-Reply-To: <SNT111-W503D1FEC7603ACF8488349AC6D0@phx.gbl>
References: <SNT111-W503D1FEC7603ACF8488349AC6D0@phx.gbl>
Message-ID: <AANLkTi=FsWzB5+snYXNSsyTCQ6f=Su6JbOk7dGffzeSP@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101005/1214ecf7/attachment.pl>

From aubreymoore at guam.net  Tue Oct  5 22:49:01 2010
From: aubreymoore at guam.net (Aubrey Moore)
Date: Wed, 06 Oct 2010 06:49:01 +1000
Subject: [R-sig-Geo] syntax problem with r.mapcalculator
In-Reply-To: <4CAAF653.1010200@guam.net>
References: <4CAAF653.1010200@guam.net>
Message-ID: <4CAB8F3D.8090906@guam.net>

  Thanks, Roger

Your suggested "incantation" is the correct syntax for Windows.

execGRASS("r.mapcalculator", flags = c("overwrite"),
   parameters=list(outfile="result", amap="ddev",
     formula="\"if(A<0,0,A)\""))

- Aubrey


On 10/5/2010 7:56 PM, Aubrey Moore wrote:
>  I created a raster map, "R20101001", using v.surf.rst.  The 
> interpolation overshoots and dips below zero in a few areas.  I'd like 
> to use r.mapcalculator, called from spgrass6, to replace all negative 
> values with zeros.  But I can't seem to get the syntax right.  The 
> following fails and produces the error message: "The system cannot 
> find the file specified."
>
> execGRASS("r.mapcalculator", flags = c("overwrite"),
>    parameters=list(outfile="result", amap="R20100101", 
> formula='if(A<0,0,A)'))
>
> I would appreciate it if anyone can spot the mistake.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From r.hijmans at gmail.com  Wed Oct  6 10:16:20 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 6 Oct 2010 11:16:20 +0300
Subject: [R-sig-Geo] Raster package writeRaster format="NCF"
In-Reply-To: <AANLkTik5XNG7x8kzOYrrq7WqCULgmqkXi3vDpEeECknE@mail.gmail.com>
References: <AANLkTik5XNG7x8kzOYrrq7WqCULgmqkXi3vDpEeECknE@mail.gmail.com>
Message-ID: <AANLkTi=BmeGaybz15x+1bFqpFrhq+=hdau0qyHZuN3jz@mail.gmail.com>

Elizabeth,

Creating a raster object from a nc file is probably easiest done like this:

r <- raster(filename, band=1)

Or to get the all:

b <- brick(filename)

then:

ba <- aggregate(b, ....)

Normally, you should be able to do this to save it as ncdf:

ba <- writeRaster(ba, filename='out.nc')

Or in one step:

ba <- aggregate(b, filename='out.nc')

However, you have uncovered a bug in writing to a ncdf file when
values are not in memory, I'll think I have fixed that  in the
development version (available from R-Forge in 24 hrs). For now, a
work around is to do 'readAll' before you use writeRaster (this will
fail if the file is too large, but that is probably not the case)

r <- readAll(r)
r <- writeRaster(...


Robert


On Tue, Oct 5, 2010 at 6:20 AM, Elizabeth Crisfield <eac16 at psu.edu> wrote:
> I have read a 10 band .nc file into R using *open.ncdf* and
> *get.var.ncdf*and I've read each band into a raster format e.g.
> *raster(data[,,1])*. I used *aggregate* to upscale the data, and now I want
> to write it back out to netcdf format. For some reason, I can write each
> band out separately (e.g. *writeRaster(newdataband1, "newdataband1",
> format="CDF")* but if I *stack* the data first, I get an error when I try to
> write the stack out to netcdf. The error says "*CDF is not a supported file
> format. See writeFormats()"*. Sure enough, *writeFormats()* gives me a long
> list of formats that are enabled, and CDF is not in the list.
>
> ?
>
> I am running R (R 2.11.1 GUI 1.34 Leopard build 64-bit (5589)) on Mac OS X
> (10.6.4) with up-to-date packages of ncdf and Raster. I've also installed
> netcdf through MacPorts and the libraries are in /opt/local rather than
> /usr/local (I'm wondering if I have a library or path problem?)
>
> How can I get the writeRaster to add CDF to the list of writeFormats?
>
> Is there another way to reconstruct this netcdf file from the 10 raster
> layers in R? (*create.ncdf*?) Alternatively, since I think I have them
> written out to separate netcdfs I could maybe bind them back together using
> another utility outside of R?
>
> Thanks in advance.
>
> Elizabeth
> ____________________
> Elizabeth Crisfield
> Research Assistant
> Geography Department
> Penn State University
> phone 814-777-3395
> eac16 at psu.edu
> www.elizabethcrisfield.com
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From roman.lustrik at gmail.com  Wed Oct  6 11:32:43 2010
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Wed, 6 Oct 2010 11:32:43 +0200
Subject: [R-sig-Geo] accessing raster::lineValues
Message-ID: <AANLkTi=jaNaKzkH_L=pThYHgRWsHbxiaoWtWbitMPk2r@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101006/e2782740/attachment.pl>

From roman.lustrik at gmail.com  Wed Oct  6 12:05:35 2010
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Wed, 6 Oct 2010 12:05:35 +0200
Subject: [R-sig-Geo] accessing raster::lineValues
In-Reply-To: <AANLkTi=jaNaKzkH_L=pThYHgRWsHbxiaoWtWbitMPk2r@mail.gmail.com>
References: <AANLkTi=jaNaKzkH_L=pThYHgRWsHbxiaoWtWbitMPk2r@mail.gmail.com>
Message-ID: <AANLkTi=iQKfQf3zxVmii7Be4g=8JYXEW0t7VrnB9HoEv@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101006/be34f917/attachment.pl>

From jfloeter at uni-hamburg.de  Wed Oct  6 12:37:36 2010
From: jfloeter at uni-hamburg.de (Jens Floeter)
Date: Wed, 06 Oct 2010 12:37:36 +0200
Subject: [R-sig-Geo] increment and distance in correlog
In-Reply-To: <4CAB0483.5090102@uni-hamburg.de>
References: <4CAB0483.5090102@uni-hamburg.de>
Message-ID: <4CAC5170.3040407@uni-hamburg.de>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101006/1f859f22/attachment.html>

From edzer.pebesma at uni-muenster.de  Wed Oct  6 12:58:34 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 06 Oct 2010 12:58:34 +0200
Subject: [R-sig-Geo] increment and distance in correlog
In-Reply-To: <4CAC5170.3040407@uni-hamburg.de>
References: <4CAB0483.5090102@uni-hamburg.de> <4CAC5170.3040407@uni-hamburg.de>
Message-ID: <4CAC565A.8020607@uni-muenster.de>

Jens,

in your code snippet below, the number 6370 rings a bell. According to
http://en.wikipedia.org/wiki/Earth_radius it is close to the average
earth radius. In km. Given that there's just one such number, it seems
the code assumes a sphere is close enough to approximate the earth.


On 10/06/2010 12:37 PM, Jens Floeter wrote:
>   Hello again,
> 
> okay, i found the ncf package and the correlog function.
> 
> # correlog(x, y, z, w = NULL, increment, resamp = 100, latlon = FALSE, na.rm = 
> FALSE, quiet = FALSE)
> 
> my short question is:
> 
> *if latlon = T and the positions are "degree, decimal-minutes" then increment 
> has the unit of "km" and distance bins are in "km" as well - is that correct ?*
> 
> I found it in the sourcecode :
> 
> #then generating geographic distances
> if(latlon){
> #these are geographic distances from lat-lon coordinates
> dmat <- matrix(0, nrow = n, ncol = n)
> for(i in 1:(n-1)) {
> for(j in (i+1):n) {
> dmat[j, i] <- gcdist(x[i], y[i], x[j], y[j])
> dmat[i, j] <- dmat[j, i]
> 
> with gcdist =
> 
> r <- 360/(2 * pi)
> lon1 <- x1 / r
> lat1 <- y1 / r
> lon2 <- x2 / r
> lat2 <- y2 / r
> dlon <- lon2 - lon1
> dlat <- lat2 - lat1
> a <- (sin(dlat/2))^2 + cos(lat1) * cos(lat2) * (sin(dlon/2))^2
> c <- 2 * atan2( sqrt(a), sqrt(1-a) )
> return(6370 * c)
> }
> 
> but i cannot the answer from this....does gcdist deliver km units ?
> 
> Cheers!
> jens
> 
> 
> 
> 
> 
> Am 05.10.2010 12:57, schrieb Jens Floeter:
>> Dear list members,
>>
>> i need a hint - i am stuck on my search for a function.
>>
>> I would like to calculate cross-correlograms between two variables (predator 
>> and prey densities) and use this as an index of spatial overlap.
>>
>> I used the spdep pakcage and use e.g.
>>
>> sp.correlogram(xy.data.nb, prey, order = 5 , method = "I", zero.policy=TRUE, 
>> style = "W")
>> sp.correlogram(xy.data.nb, predator, order = 5 , method = "I", 
>> zero.policy=TRUE, style = "W")
>>
>> to calculate the (auto-) correlograms for predator and prey individually.
>>
>> But how do i combine them to calculate the cross-correlogram ?
>>
>> Any hint would be highly appreciated...
>>
>> Best wishes !
>> jens
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo 
> 
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From geomalik at live.com  Wed Oct  6 13:36:40 2010
From: geomalik at live.com (Malik Shahzad)
Date: Wed, 6 Oct 2010 18:36:40 +0700
Subject: [R-sig-Geo] Basic Info. requried
Message-ID: <SNT111-W340C2DB40918749F1B02EEAC6E0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101006/efa5299e/attachment.pl>

From p.hiemstra at geo.uu.nl  Wed Oct  6 14:53:36 2010
From: p.hiemstra at geo.uu.nl (Paul Hiemstra)
Date: Wed, 06 Oct 2010 14:53:36 +0200
Subject: [R-sig-Geo] Basic Info. requried
In-Reply-To: <SNT111-W340C2DB40918749F1B02EEAC6E0@phx.gbl>
References: <SNT111-W340C2DB40918749F1B02EEAC6E0@phx.gbl>
Message-ID: <4CAC7150.8060409@geo.uu.nl>

Hi Malik,

To a look at the rgdal package to read your tiff file and spplot from 
the sp package to plot it.

cheers,
Paul

On 10/06/2010 01:36 PM, Malik Shahzad wrote:
> I want to read Iknos image and then want to see display in R. Just read and display nothing else.
> I try using raster package
>
>    
>> rasterfile<-system.file("C:/iknos/edwards_airbase_usa_1m_tc.tif",package="raster")
>>      
> Then plot with the help of this command
>
>    
>> plot(rasterfile)
>>      
> Error in plot.window(...) : need finite 'ylim' values
> In addition: Warning messages:
> 1: In min(x) : no non-missing arguments to min; returning Inf
> 2: In max(x) : no non-missing arguments to max; returning -Inf
>
> Need help from where I can learn basic things, I already read raster package manual but unable to see the image.
>
>
>
> with Best Regards,
>
> Malik Shahzad
> Visiting Researcher
> National Institute of Informatics (NII)
> Tokyo, Japan
>
> Doctoral Student
> Asian Institute of Technology (AIT)
> Bangkok, Thailand
> +66-8-7676-5616
>
>
>
>
>   		 	   		
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>    


-- 
Drs. Paul Hiemstra
Department of Physical Geography
Faculty of Geosciences
University of Utrecht
Heidelberglaan 2
P.O. Box 80.115
3508 TC Utrecht
Phone:  +3130 253 5773
http://intamap.geo.uu.nl/~paul
http://nl.linkedin.com/pub/paul-hiemstra/20/30b/770


From kmcoulib at gmail.com  Wed Oct  6 15:44:08 2010
From: kmcoulib at gmail.com (kapo coulibaly)
Date: Wed, 6 Oct 2010 09:44:08 -0400
Subject: [R-sig-Geo] Basic Info. requried
In-Reply-To: <SNT111-W340C2DB40918749F1B02EEAC6E0@phx.gbl>
References: <SNT111-W340C2DB40918749F1B02EEAC6E0@phx.gbl>
Message-ID: <AANLkTi=oveLdMU90tOt7utVfgc+c1ObGy6zAdskRyKDR@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101006/ac4351f4/attachment.pl>

From r.hijmans at gmail.com  Wed Oct  6 16:49:35 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 6 Oct 2010 17:49:35 +0300
Subject: [R-sig-Geo] Basic Info. requried
In-Reply-To: <AANLkTi=oveLdMU90tOt7utVfgc+c1ObGy6zAdskRyKDR@mail.gmail.com>
References: <SNT111-W340C2DB40918749F1B02EEAC6E0@phx.gbl>
	<AANLkTi=oveLdMU90tOt7utVfgc+c1ObGy6zAdskRyKDR@mail.gmail.com>
Message-ID: <AANLkTi=6DcKUtcOz3M502eJTPKtnY7AimiGBF2DG_wKP@mail.gmail.com>

Indeed, and as Malik is not using a "system file" (files packaged with
R to serve as examples), you can should leave that bit out and do:

r <-raster("C:/iknos/edwards_airbase_usa_1m_tc.tif')

plot(r)

Robert

On Wed, Oct 6, 2010 at 4:44 PM, kapo coulibaly <kmcoulib at gmail.com> wrote:
> I believe there is a mistake in your command. You skipped the "raster"
> command itself. From the raster help files here is the correct way:
>
> r <- raster(system.file("external/test.grd", package="raster"))
>
>
>
> On Wed, Oct 6, 2010 at 7:36 AM, Malik Shahzad <geomalik at live.com> wrote:
>
>>
>> I want to read Iknos image and then want to see display in R. Just read and
>> display nothing else.
>> I try using raster package
>>
>> >
>> rasterfile<-system.file("C:/iknos/edwards_airbase_usa_1m_tc.tif",package="raster")
>>
>> Then plot with the help of this command
>>
>> > plot(rasterfile)
>>
>> Error in plot.window(...) : need finite 'ylim' values
>> In addition: Warning messages:
>> 1: In min(x) : no non-missing arguments to min; returning Inf
>> 2: In max(x) : no non-missing arguments to max; returning -Inf
>>
>> Need help from where I can learn basic things, I already read raster
>> package manual but unable to see the image.
>>
>>
>>
>> with Best Regards,
>>
>> Malik Shahzad
>> Visiting Researcher
>> National Institute of Informatics (NII)
>> Tokyo, Japan
>>
>> Doctoral Student
>> Asian Institute of Technology (AIT)
>> Bangkok, Thailand
>> +66-8-7676-5616
>>
>>
>>
>>
>>
>> ? ? ? ?[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From geomalik at live.com  Wed Oct  6 17:04:13 2010
From: geomalik at live.com (Malik Shahzad)
Date: Wed, 6 Oct 2010 22:04:13 +0700
Subject: [R-sig-Geo] R Basic Info. requried
In-Reply-To: <AANLkTi=6DcKUtcOz3M502eJTPKtnY7AimiGBF2DG_wKP@mail.gmail.com>
References: <SNT111-W340C2DB40918749F1B02EEAC6E0@phx.gbl>,
	<AANLkTi=oveLdMU90tOt7utVfgc+c1ObGy6zAdskRyKDR@mail.gmail.com>,
	<AANLkTi=6DcKUtcOz3M502eJTPKtnY7AimiGBF2DG_wKP@mail.gmail.com>
Message-ID: <SNT111-W21C7E3511F7E51F2D49AB9AC6E0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101006/a465f559/attachment.pl>

From landis at isciences.com  Wed Oct  6 17:13:34 2010
From: landis at isciences.com (Matthew Landis)
Date: Wed, 06 Oct 2010 11:13:34 -0400
Subject: [R-sig-Geo] R Basic Info. requried
In-Reply-To: <SNT111-W21C7E3511F7E51F2D49AB9AC6E0@phx.gbl>
References: <SNT111-W340C2DB40918749F1B02EEAC6E0@phx.gbl>,
	<AANLkTi=oveLdMU90tOt7utVfgc+c1ObGy6zAdskRyKDR@mail.gmail.com>,
	<AANLkTi=6DcKUtcOz3M502eJTPKtnY7AimiGBF2DG_wKP@mail.gmail.com>
	<SNT111-W21C7E3511F7E51F2D49AB9AC6E0@phx.gbl>
Message-ID: <4CAC921E.3000607@isciences.com>

  Malik,

In your example, rasterfile is not a RasterLayer object, but just a 
character vector (and perhaps an empty one at that).  Try 
class(rasterfile) or just type rasterfile at the prompt to see what it is.

I think you need to do:
edwards <- raster('C:/iknos/edwards_airbase_usa_1m_tc.tif')
class(edwards)  # Should indicate that it is a RasterLayer object.
plot(edwards)

or in other words:
rasterfile <- 'C:/iknos/edwards_airbase_usa_1m_tc.tif'
edwards <- raster(rasterfile)
plot(edwards)

Matt


On 10/6/2010 11:04 AM, Malik Shahzad wrote:
> Dear thanks for help,
>
> In first line there is no problem
>
>
>
> rasterfile<-system.file("C:/iknos/edwards_airbase_usa_1m_tc.tif",package="raster")
>
>
>
> This works fine without any error, It mean image has been loaded into variable raster file, but now how i can display raster file in R. I mean I want to see my image that is stored in this variable. When I use plot(rasterfile) it shows error. Before this I work with rImage package to load image(*.jpg) file and then show with the help of plot(image). it works there fine and I can see image but now I am unable to see my output.
>


-- 
~~~~~~~~~~~~~~~~~~~~~~~~~~
Matthew Landis, Ph.D.
Research Scientist
ISciences, LLC
61 Main St. Suite 200
Burlington VT 05401
802.864.2999
~~~~~~~~~~~~~~~~~~~~~~~~~~


From taras at calgaryzoo.ab.ca  Wed Oct  6 18:24:54 2010
From: taras at calgaryzoo.ab.ca (tara)
Date: Wed, 6 Oct 2010 09:24:54 -0700 (PDT)
Subject: [R-sig-Geo] spatial correlogram
Message-ID: <1286382294082-5607783.post@n2.nabble.com>


Hello 
I am trying to use the correlog function to estimate a spatial correlogram
for the residuals of a logistic regression and I have run accross the
following error. 
  
> summary(binom1 <- glm(Use~X20mslop+X20mdem+soilsst, family=binomial, 
+ data=M60m2000NE_1.df)) 

> correlog1.1 <- correlog(M60m2000NE_1.df$X, M60m2000NE_1.df$Y,
> residuals(binom1),w=NULL, 
+ na.rm=T, increment=1, resamp=0) 

Error in split.default(moran, dkl) : 
  Group length is 0 but data length > 0 

Can anyone help me to understand what this error is referring to and suggest
how I can fix it? 
Thanks 
Tara 
PS Please see the file uploaded below :)
http://r-sig-geo.2731867.n2.nabble.com/file/n5607783/Modified60m2000TrainingSetANoEcotour_05_25B.csv
Modified60m2000TrainingSetANoEcotour_05_25B.csv 
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/spatial-correlogram-tp5607783p5607783.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From taras at calgaryzoo.ab.ca  Wed Oct  6 21:49:32 2010
From: taras at calgaryzoo.ab.ca (tara)
Date: Wed, 6 Oct 2010 12:49:32 -0700 (PDT)
Subject: [R-sig-Geo] Why can you not calculate Moran's i for glm()
	residuals?
In-Reply-To: <1648993377.1171009.1285379813741.JavaMail.root@jaguar9.sfu.ca>
References: <1648993377.1171009.1285379813741.JavaMail.root@jaguar9.sfu.ca>
Message-ID: <1286394572067-5608678.post@n2.nabble.com>



Hello Jenn

Unfortunately I can not offer any advice but I am facing very similar
challenges and actively searching for answers. I have presence/absence data
for a colonial species and I am trying to compare the performance of a
logistic model with spatial models: 1) a glm including an autocovariate and
2) a glmm. Currently I have resorted to using spatial correlograms for
visual inspection of residual spatial autocorrelation (interesting that we
both came up with the same posible option). Not ideal and I have not found
any information as to whether this is valid but I am stumped. 
I was wondering if you have found any more information on the topics you
described and if so would you mind sharing what you found with me. I will
certainly return the favour. 

Thanks so much and Good Luck! 

Sincerely 
Tara 
MSc Candidate

-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Why-can-you-not-calculate-Moran-s-i-for-glm-residuals-tp5568942p5608678.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From lestes at princeton.edu  Thu Oct  7 05:13:26 2010
From: lestes at princeton.edu (Lyndon Estes)
Date: Wed, 6 Oct 2010 23:13:26 -0400
Subject: [R-sig-Geo] spplot with two SpatialPolygonsDataFrame: 1) filling
 background polygon; 2) left justifying text
Message-ID: <AANLkTi=HefgM--L8+5CmqK-6VBx+NRUV9LFZgFjpZY_Q@mail.gmail.com>

Greetings,

I have two questions/problems related to spplot:

1. I am trying to plot one SpatialPolygonsDataFrame over another, and
fill the background polygon with grey. I can't seem to fill the
background polygon without having it cover over my supposed foreground
polygon, even if I specify "first = T" (which fails):

link1 <- "http://sites.google.com/site/ldemisc/spplot-question/demo.mdshp.RData"
link2 <- "http://sites.google.com/site/ldemisc/spplot-question/demo.sashp.RData"

load(url(link1)); load(url(link2))

# Set up plot background shape and additional text

#sa.lst = list("sp.polygons", sa.shp, fill = "grey", col = "black") #
Covers over md.shp
#sa.lst = list("sp.polygons", sa.shp, fill = "grey", first = F, col =
"black") # Covers over md.shp
#sa.lst = list("sp.polygons", sa.shp, fill = "grey", first = T, col =
"black") # sa.shp doesn't plot
sa.lst = list("sp.polygons", sa.shp, col = "black")? # Shape of South
Africa as background polygon -
???????????????????????????????????????????????????? #?? works, but no fill

# Additional text - overall mean yield.
text1 <- list("sp.text", c(360000, -3210000),
???????????? paste("Overall mean yield =",
round(mean(md.shp at data[-c(22,69), 4]), 0), "kg/ha"),
???????????? col ="red", cex = 1)

# Scale bar limits and title
scmax? <- round(max(md.shp at data[, 4]) / 50, 0) * 50
scmin? <- round(min(md.shp at data[, 4]) / 50, 0) * 50
byval? <- 25
titlevec <- "Mean district maize yields (kg/ha) 1981-99: Cultivar PAN6528"

# Spplot
dev.new()
spplot(md.shp[-c(22,69),], z = 4,
?????? sp.layout = list(sa.lst, text1),
?????? col.regions = topo.colors(500),
?????? at = seq(scmin, scmax, by = byval),
?????? main = titlevec)

Any advice on how to correctly set "sa.lst" so that sa.shp fills
underneat md.shp will be much appreciated.  I haven't been able to
find a ready answer in the help files, except for this:

"The order of items in sp.layout matters; objects are drawn in the
order they appear. Plot order and prevalence of sp.layout items: for
points and lines, sp.layout items are drawn before the points (to
allow for grids and polygons); for grids and polygons sp.layout is
drawn afterwards (so the item will not be overdrawn by the grid and/or
polygon). Although a matter of taste, transparency may help when
combining things. "

But, beyond what I have tried so far, I can't figure out how to write
the code so that sa.shp is drawn first.

The second question:

2. Is there an option to pass to:

text1 <- list("sp.text", c(360000, -3210000),
             paste("Overall mean yield =",
round(mean(md.shp at data[-c(22,69), 4]), 0), "kg/ha"),
             col ="red", cex = 1)

so that the text is left-justified on the coordinates  c(360000,
-3210000)? At the moment it seems that the text is centered at this
location.

Thanks in advance for any help you can provide.

Best, Lyndon


From carson.farmer at gmail.com  Thu Oct  7 11:56:11 2010
From: carson.farmer at gmail.com (Carson Farmer)
Date: Thu, 7 Oct 2010 10:56:11 +0100
Subject: [R-sig-Geo] spatial interaction models
In-Reply-To: <alpine.LRH.2.00.1010051254330.28869@reclus.nhh.no>
References: <AANLkTi=ztT0NB-g0bbDsmqjLKemjA2V2NT2T0S56bH65@mail.gmail.com>
	<alpine.LRH.2.00.1010051254330.28869@reclus.nhh.no>
Message-ID: <AANLkTimL33cBw4WA6uuJZWSvh0FY4=i1Tgjpx9eXi=Qk@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101007/72638645/attachment.pl>

From jochen at hunter.cuny.edu  Thu Oct  7 15:15:20 2010
From: jochen at hunter.cuny.edu (Jochen Albrecht)
Date: Thu, 07 Oct 2010 09:15:20 -0400
Subject: [R-sig-Geo] Moving origin of a raster dataset
In-Reply-To: <4CA7561C.6070603@ase-research.org>
References: <4CA4869E.8000405@ase-research.org>
	<AANLkTim5WMwCdQsVJHoB82mRvfsWzXdzbOO75_ESF2FP@mail.gmail.com>
	<4CA4DD7F.4070306@ase-research.org>
	<AANLkTin0eTU+XRSGn8SMALq8X971o23kmxH=GmzVvQ62@mail.gmail.com>
	<4CA7561C.6070603@ase-research.org>
Message-ID: <4CADC7E8.8060408@hunter.cuny.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101007/172d3e99/attachment.pl>

From jochen at hunter.cuny.edu  Thu Oct  7 16:12:34 2010
From: jochen at hunter.cuny.edu (Jochen Albrecht)
Date: Thu, 07 Oct 2010 10:12:34 -0400
Subject: [R-sig-Geo] Moving origin of a raster dataset
In-Reply-To: <4CADD123.2060104@isciences.com>
References: <4CADD123.2060104@isciences.com>
Message-ID: <4CADD552.6050308@hunter.cuny.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101007/e020ce96/attachment.pl>

From jbcorrea at univalle.edu.co  Fri Oct  8 06:31:33 2010
From: jbcorrea at univalle.edu.co (jbcorrea at univalle.edu.co)
Date: Thu, 7 Oct 2010 23:31:33 -0500 (COT)
Subject: [R-sig-Geo] header intact
Message-ID: <49598.192.168.20.33.1286512293.squirrel@swebse47.univalle.edu.co>


From arnald.marcer at uab.cat  Fri Oct  8 11:12:07 2010
From: arnald.marcer at uab.cat (Arnald Marcer)
Date: Fri, 08 Oct 2010 11:12:07 +0200
Subject: [R-sig-Geo] points, raster
Message-ID: <4CAEE067.1060009@uab.cat>

  Hi,

Can anybody help me a little on how to transfer values from a data frame 
(coord.x, coord.y, value) to
a raster file. I have a raster initialized to 0 values and I want to 
substitute zeros for the specific values
at coord.x and coord.y

Thank you very much,

Arnald Marcer
CREAF


From moshersteven at gmail.com  Fri Oct  8 12:31:19 2010
From: moshersteven at gmail.com (steven mosher)
Date: Fri, 8 Oct 2010 03:31:19 -0700
Subject: [R-sig-Geo] points, raster
In-Reply-To: <4CAEE067.1060009@uab.cat>
References: <4CAEE067.1060009@uab.cat>
Message-ID: <AANLkTinbf75ps42iETAbqquUT0c0mp6MW_jiCp9Mg=es@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101008/cc691489/attachment.pl>

From lestes at princeton.edu  Fri Oct  8 16:18:13 2010
From: lestes at princeton.edu (Lyndon Estes)
Date: Fri, 8 Oct 2010 10:18:13 -0400
Subject: [R-sig-Geo] spplot: 1) filling background polygon without
 overwriting foreground polygon; 2) left justifying sp.layout text
Message-ID: <AANLkTi=4b+eXxkxBqDnkkMs2C5dRWbBAAgqcQa_6fD53@mail.gmail.com>

Greetings,

I have two questions related to spplot:

1. I am trying to plot one SpatialPolygonsDataFrame over another, and
fill the background polygon with grey. I can't seem to fill the
background polygon without having it cover over my supposed foreground
polygon, even if I specify "first = T" (which fails to draw the
background polygon):

# Code

# Load shapefiles
con1 <- url("http://sites.google.com/site/ldemisc/spplot-question/demo.mdshp.RData")
con2 <- url("http://sites.google.com/site/ldemisc/spplot-question/demo.sashp.RData")
load(con1); load(con2); close(con1); close(con2)

# Set up plot background shape and additional text for map

# Covers over md.shp
#sa.lst = list("sp.polygons", sa.shp, fill = "grey", col = "black")

# Covers over md.shp
#sa.lst = list("sp.polygons", sa.shp, fill = "grey", first = F, col =
"black")

# sa.shp doesn't plot
#sa.lst = list("sp.polygons", sa.shp, fill = "grey", first = T, col = "black")

# Background polygon works like this, but without fill
sa.lst = list("sp.polygons", sa.shp, col = "black")

# Additional text - overall mean yield.
text1 <- list("sp.text", c(360000, -3210000),
???????????? paste("Overall mean yield =",
round(mean(md.shp at data[-c(22,69), 4]), 0), "kg/ha"),
???????????? col ="red", cex = 1)

# Scale bar limits and title
scmax? <- round(max(md.shp at data[, 4]) / 50, 0) * 50
scmin? <- round(min(md.shp at data[, 4]) / 50, 0) * 50
byval? <- 25
titlevec <- "Mean district maize yields (kg/ha) 1981-99: Cultivar PAN6528"

# Spplot
dev.new()
spplot(md.shp[-c(22,69),], z = 4,
?????? sp.layout = list(sa.lst, text1),
?????? col.regions = topo.colors(500),
?????? at = seq(scmin, scmax, by = byval),
?????? main = titlevec)

Any advice on how to correctly set "sa.lst" so that sa.shp fills
underneath md.shp will be much appreciated. ?I haven't been able to
find a ready answer in the help files, except for this:

"The order of items in sp.layout matters; objects are drawn in the
order they appear. Plot order and prevalence of sp.layout items: for
points and lines, sp.layout items are drawn before the points (to
allow for grids and polygons); for grids and polygons sp.layout is
drawn afterwards (so the item will not be overdrawn by the grid and/or
polygon). Although a matter of taste, transparency may help when
combining things. "

But, beyond what I have tried so far, I can't figure out how to write
the code so that sa.shp is drawn first.

The second question:

2. Is there an option to pass to:

text1 <- list("sp.text", c(360000, -3210000),
? ? ? ? ? ? paste("Overall mean yield =",
round(mean(md.shp at data[-c(22,69), 4]), 0), "kg/ha"),
? ? ? ? ? ? col ="red", cex = 1)

so that the text is left-justified on the coordinates ?c(360000,
-3210000)? At the moment it seems that the text is centered at this
location.

Thanks in advance for any help you can provide.

Best, Lyndon


From gianni.lavaredo at gmail.com  Fri Oct  8 16:44:56 2010
From: gianni.lavaredo at gmail.com (gianni lavaredo)
Date: Fri, 8 Oct 2010 16:44:56 +0200
Subject: [R-sig-Geo] problem to read ASCII file in Raster or readAsciiGrid
 (different stretched value and classified value)
Message-ID: <AANLkTikW5LTHYWpNtbdJKMJCpC-wnNpuWL+e0kTkgDC0@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101008/27913849/attachment.pl>

From edzer.pebesma at uni-muenster.de  Fri Oct  8 16:51:30 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 08 Oct 2010 16:51:30 +0200
Subject: [R-sig-Geo] spplot: 1) filling background polygon without
 overwriting foreground polygon; 2) left justifying sp.layout text
In-Reply-To: <AANLkTi=4b+eXxkxBqDnkkMs2C5dRWbBAAgqcQa_6fD53@mail.gmail.com>
References: <AANLkTi=4b+eXxkxBqDnkkMs2C5dRWbBAAgqcQa_6fD53@mail.gmail.com>
Message-ID: <4CAF2FF2.8050309@uni-muenster.de>

Thanks for the reproducable example. I can see what you want, and even
with the intended syntax, i.e.

sa.lst = list("sp.polygons", sa.shp, fill = "grey", first = T, col =
"black")

you don't get what I think you'd like. If the image attached is what you
want, I committed a code change to the sp repository. I want to run some
more checks to see whether it does not badly affect something else.

Best regards,

On 10/08/2010 04:18 PM, Lyndon Estes wrote:
> Greetings,
> 
> I have two questions related to spplot:
> 
> 1. I am trying to plot one SpatialPolygonsDataFrame over another, and
> fill the background polygon with grey. I can't seem to fill the
> background polygon without having it cover over my supposed foreground
> polygon, even if I specify "first = T" (which fails to draw the
> background polygon):
> 
> # Code
> 
> # Load shapefiles
> con1 <- url("http://sites.google.com/site/ldemisc/spplot-question/demo.mdshp.RData")
> con2 <- url("http://sites.google.com/site/ldemisc/spplot-question/demo.sashp.RData")
> load(con1); load(con2); close(con1); close(con2)
> 
> # Set up plot background shape and additional text for map
> 
> # Covers over md.shp
> #sa.lst = list("sp.polygons", sa.shp, fill = "grey", col = "black")
> 
> # Covers over md.shp
> #sa.lst = list("sp.polygons", sa.shp, fill = "grey", first = F, col =
> "black")
> 
> # sa.shp doesn't plot
> #sa.lst = list("sp.polygons", sa.shp, fill = "grey", first = T, col = "black")
> 
> # Background polygon works like this, but without fill
> sa.lst = list("sp.polygons", sa.shp, col = "black")
> 
> # Additional text - overall mean yield.
> text1 <- list("sp.text", c(360000, -3210000),
>              paste("Overall mean yield =",
> round(mean(md.shp at data[-c(22,69), 4]), 0), "kg/ha"),
>              col ="red", cex = 1)
> 
> # Scale bar limits and title
> scmax  <- round(max(md.shp at data[, 4]) / 50, 0) * 50
> scmin  <- round(min(md.shp at data[, 4]) / 50, 0) * 50
> byval  <- 25
> titlevec <- "Mean district maize yields (kg/ha) 1981-99: Cultivar PAN6528"
> 
> # Spplot
> dev.new()
> spplot(md.shp[-c(22,69),], z = 4,
>        sp.layout = list(sa.lst, text1),
>        col.regions = topo.colors(500),
>        at = seq(scmin, scmax, by = byval),
>        main = titlevec)
> 
> Any advice on how to correctly set "sa.lst" so that sa.shp fills
> underneath md.shp will be much appreciated.  I haven't been able to
> find a ready answer in the help files, except for this:
> 
> "The order of items in sp.layout matters; objects are drawn in the
> order they appear. Plot order and prevalence of sp.layout items: for
> points and lines, sp.layout items are drawn before the points (to
> allow for grids and polygons); for grids and polygons sp.layout is
> drawn afterwards (so the item will not be overdrawn by the grid and/or
> polygon). Although a matter of taste, transparency may help when
> combining things. "
> 
> But, beyond what I have tried so far, I can't figure out how to write
> the code so that sa.shp is drawn first.
> 
> The second question:
> 
> 2. Is there an option to pass to:
> 
> text1 <- list("sp.text", c(360000, -3210000),
>             paste("Overall mean yield =",
> round(mean(md.shp at data[-c(22,69), 4]), 0), "kg/ha"),
>             col ="red", cex = 1)
> 
> so that the text is left-justified on the coordinates  c(360000,
> -3210000)? At the moment it seems that the text is centered at this
> location.
> 
> Thanks in advance for any help you can provide.
> 
> Best, Lyndon
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de
-------------- next part --------------
A non-text attachment was scrubbed...
Name: spplot.png
Type: image/png
Size: 70093 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101008/dd682129/attachment.png>

From lestes at princeton.edu  Fri Oct  8 17:14:58 2010
From: lestes at princeton.edu (Lyndon Estes)
Date: Fri, 8 Oct 2010 11:14:58 -0400
Subject: [R-sig-Geo] spplot: 1) filling background polygon without
 overwriting foreground polygon; 2) left justifying sp.layout text
In-Reply-To: <4CAF2FF2.8050309@uni-muenster.de>
References: <AANLkTi=4b+eXxkxBqDnkkMs2C5dRWbBAAgqcQa_6fD53@mail.gmail.com>
	<4CAF2FF2.8050309@uni-muenster.de>
Message-ID: <AANLkTin8dLTEyo9+_EyMbrkW8zdHHG6Z0fd=tHJxPzKd@mail.gmail.com>

Dear Edzer,

Very many thanks for the rapid response.  What you posted is exactly
what I was hoping for!

I will download the updated sp package and reproduce my maps.  Thanks again!

Best, Lyndon

On Fri, Oct 8, 2010 at 10:51 AM, Edzer Pebesma
<edzer.pebesma at uni-muenster.de> wrote:
> Thanks for the reproducable example. I can see what you want, and even
> with the intended syntax, i.e.
>
> sa.lst = list("sp.polygons", sa.shp, fill = "grey", first = T, col =
> "black")
>
> you don't get what I think you'd like. If the image attached is what you
> want, I committed a code change to the sp repository. I want to run some
> more checks to see whether it does not badly affect something else.
>
> Best regards,
>
> On 10/08/2010 04:18 PM, Lyndon Estes wrote:
>> Greetings,
>>
>> I have two questions related to spplot:
>>
>> 1. I am trying to plot one SpatialPolygonsDataFrame over another, and
>> fill the background polygon with grey. I can't seem to fill the
>> background polygon without having it cover over my supposed foreground
>> polygon, even if I specify "first = T" (which fails to draw the
>> background polygon):
>>
>> # Code
>>
>> # Load shapefiles
>> con1 <- url("http://sites.google.com/site/ldemisc/spplot-question/demo.mdshp.RData")
>> con2 <- url("http://sites.google.com/site/ldemisc/spplot-question/demo.sashp.RData")
>> load(con1); load(con2); close(con1); close(con2)
>>
>> # Set up plot background shape and additional text for map
>>
>> # Covers over md.shp
>> #sa.lst = list("sp.polygons", sa.shp, fill = "grey", col = "black")
>>
>> # Covers over md.shp
>> #sa.lst = list("sp.polygons", sa.shp, fill = "grey", first = F, col =
>> "black")
>>
>> # sa.shp doesn't plot
>> #sa.lst = list("sp.polygons", sa.shp, fill = "grey", first = T, col = "black")
>>
>> # Background polygon works like this, but without fill
>> sa.lst = list("sp.polygons", sa.shp, col = "black")
>>
>> # Additional text - overall mean yield.
>> text1 <- list("sp.text", c(360000, -3210000),
>> ? ? ? ? ? ? ?paste("Overall mean yield =",
>> round(mean(md.shp at data[-c(22,69), 4]), 0), "kg/ha"),
>> ? ? ? ? ? ? ?col ="red", cex = 1)
>>
>> # Scale bar limits and title
>> scmax ?<- round(max(md.shp at data[, 4]) / 50, 0) * 50
>> scmin ?<- round(min(md.shp at data[, 4]) / 50, 0) * 50
>> byval ?<- 25
>> titlevec <- "Mean district maize yields (kg/ha) 1981-99: Cultivar PAN6528"
>>
>> # Spplot
>> dev.new()
>> spplot(md.shp[-c(22,69),], z = 4,
>> ? ? ? ?sp.layout = list(sa.lst, text1),
>> ? ? ? ?col.regions = topo.colors(500),
>> ? ? ? ?at = seq(scmin, scmax, by = byval),
>> ? ? ? ?main = titlevec)
>>
>> Any advice on how to correctly set "sa.lst" so that sa.shp fills
>> underneath md.shp will be much appreciated. ?I haven't been able to
>> find a ready answer in the help files, except for this:
>>
>> "The order of items in sp.layout matters; objects are drawn in the
>> order they appear. Plot order and prevalence of sp.layout items: for
>> points and lines, sp.layout items are drawn before the points (to
>> allow for grids and polygons); for grids and polygons sp.layout is
>> drawn afterwards (so the item will not be overdrawn by the grid and/or
>> polygon). Although a matter of taste, transparency may help when
>> combining things. "
>>
>> But, beyond what I have tried so far, I can't figure out how to write
>> the code so that sa.shp is drawn first.
>>
>> The second question:
>>
>> 2. Is there an option to pass to:
>>
>> text1 <- list("sp.text", c(360000, -3210000),
>> ? ? ? ? ? ? paste("Overall mean yield =",
>> round(mean(md.shp at data[-c(22,69), 4]), 0), "kg/ha"),
>> ? ? ? ? ? ? col ="red", cex = 1)
>>
>> so that the text is left-justified on the coordinates ?c(360000,
>> -3210000)? At the moment it seems that the text is centered at this
>> location.
>>
>> Thanks in advance for any help you can provide.
>>
>> Best, Lyndon
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> --
> Edzer Pebesma
> Institute for Geoinformatics (ifgi), University of M?nster
> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
> 8333081, Fax: +49 251 8339763 ?http://ifgi.uni-muenster.de
> http://www.52north.org/geostatistics ? ? ?e.pebesma at wwu.de
>


From ogbos.okike at gmail.com  Fri Oct  8 17:42:05 2010
From: ogbos.okike at gmail.com (ogbos okike)
Date: Fri, 8 Oct 2010 17:42:05 +0200
Subject: [R-sig-Geo] World map in magnetic coordinates
In-Reply-To: <AANLkTinLrBaQubVyRdy0LW6-WiLEsRG=CO5ieCuzE1tE@mail.gmail.com>
References: <AANLkTinLrBaQubVyRdy0LW6-WiLEsRG=CO5ieCuzE1tE@mail.gmail.com>
Message-ID: <AANLkTimt_v-WC2WhKToDL5Rr0=-HMqKQaPoB3yDi+WYO@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101008/d7df1ee6/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Fri Oct  8 18:05:16 2010
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Fri, 8 Oct 2010 17:05:16 +0100
Subject: [R-sig-Geo] World map in magnetic coordinates
In-Reply-To: <AANLkTimt_v-WC2WhKToDL5Rr0=-HMqKQaPoB3yDi+WYO@mail.gmail.com>
References: <AANLkTinLrBaQubVyRdy0LW6-WiLEsRG=CO5ieCuzE1tE@mail.gmail.com>
	<AANLkTimt_v-WC2WhKToDL5Rr0=-HMqKQaPoB3yDi+WYO@mail.gmail.com>
Message-ID: <AANLkTime2ZuTu+pA5GTOs=ngP7iRW=srhRpRgRPx5MWa@mail.gmail.com>

On Fri, Oct 8, 2010 at 4:42 PM, ogbos okike <ogbos.okike at gmail.com> wrote:

> However, I am interested in organizing my data in magnetic coordinates. I
> have converted my data points from geographic coordinates to magnetic
> coordinates.

> My problem now is to generate world map in magnetic coordinates.
> Can anybody please give me a hint on how to go about this.

 Possibly the same way that you converted your data points from
geographic to magnetic coordinates? How did you do that?

 The usual way of converting from coordinate systems is to use
spTransform and specify the coords via EPSG coordinate codes - does
your magnetic coordinate system have an EPSG code? I suspect that with
the magnetic poles wandering about it will change quite frequently. Is
this the case?

Barry


From ogbos.okike at gmail.com  Fri Oct  8 18:32:57 2010
From: ogbos.okike at gmail.com (ogbos okike)
Date: Fri, 8 Oct 2010 18:32:57 +0200
Subject: [R-sig-Geo] World map in magnetic coordinates
In-Reply-To: <AANLkTime2ZuTu+pA5GTOs=ngP7iRW=srhRpRgRPx5MWa@mail.gmail.com>
References: <AANLkTinLrBaQubVyRdy0LW6-WiLEsRG=CO5ieCuzE1tE@mail.gmail.com>
	<AANLkTimt_v-WC2WhKToDL5Rr0=-HMqKQaPoB3yDi+WYO@mail.gmail.com>
	<AANLkTime2ZuTu+pA5GTOs=ngP7iRW=srhRpRgRPx5MWa@mail.gmail.com>
Message-ID: <AANLkTinUZnVH4qLHPBGgLNXCwmQe=VROPoVQY-H=wgux@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101008/21768c49/attachment.pl>

From sturgeon09 at gmail.com  Fri Oct  8 19:51:32 2010
From: sturgeon09 at gmail.com (Samuel Turgeon)
Date: Fri, 8 Oct 2010 13:51:32 -0400
Subject: [R-sig-Geo] Question about back-transformation(geoR)
Message-ID: <AANLkTiks+VPACJheRDUNbc3eoVc0h5q4sQUotqe6OoKi@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101008/900a82f9/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Fri Oct  8 19:52:39 2010
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Fri, 8 Oct 2010 18:52:39 +0100
Subject: [R-sig-Geo] World map in magnetic coordinates
In-Reply-To: <AANLkTinUZnVH4qLHPBGgLNXCwmQe=VROPoVQY-H=wgux@mail.gmail.com>
References: <AANLkTinLrBaQubVyRdy0LW6-WiLEsRG=CO5ieCuzE1tE@mail.gmail.com>
	<AANLkTimt_v-WC2WhKToDL5Rr0=-HMqKQaPoB3yDi+WYO@mail.gmail.com>
	<AANLkTime2ZuTu+pA5GTOs=ngP7iRW=srhRpRgRPx5MWa@mail.gmail.com>
	<AANLkTinUZnVH4qLHPBGgLNXCwmQe=VROPoVQY-H=wgux@mail.gmail.com>
Message-ID: <AANLkTimQBTNUjAboRVM=cf2SZmHGsdRX+OgORfMm1U4N@mail.gmail.com>

On Fri, Oct 8, 2010 at 5:32 PM, ogbos okike <ogbos.okike at gmail.com> wrote:

> My data points are given in latitude and longitude (geographic). Using AACGM
> geomagnetic coordinate software, I converted them to magnetic coordinates.
> World map (such as implemented in R, which can be generated using maps has
> no data points). It is only implemented in R such that one can use maps
> library to generate it. However, that is in geographic coordinates.

 I'm not sure what world map you are referring to here. Can you tell
us the R commands that plot it?

 The data points are in there somewhere, and if you want to transform
them with something that isn't spTransform then we'll have to tell you
how to get them. If the map is a SpatialPolygonsDataFrame then the
coordinates are obtained by getting the individual polygons which are
made up of rings which are made up of points and so on. Messy but
possible to apply a generic transformation function to them.

 What does your conversion software work on? Text files?

Barry


From paulojus at c3sl.ufpr.br  Fri Oct  8 20:11:58 2010
From: paulojus at c3sl.ufpr.br (Paulo Justiniano Ribeiro Jr)
Date: Fri, 8 Oct 2010 15:11:58 -0300 (BRT)
Subject: [R-sig-Geo] Question about back-transformation(geoR)
In-Reply-To: <AANLkTiks+VPACJheRDUNbc3eoVc0h5q4sQUotqe6OoKi@mail.gmail.com>
References: <AANLkTiks+VPACJheRDUNbc3eoVc0h5q4sQUotqe6OoKi@mail.gmail.com>
Message-ID: <alpine.DEB.2.00.1010081509030.10862@macalan.c3sl.ufpr.br>

Samuel

No, it is not exp(prediction on the normal scale)
by
exp(porediction in the normal scale + 0.5*variance or the prediction in 
the normal scale)

geoiR folows lcosely what is describe in Diggle and Ribeiro (2007)

The Section 3.8 (transformed Gaussian models) it describes the 
basis for the implemented computations :
---------------------------------------------------------------------
The log-transformation is perhaps the most widely used in
practice, and explicit expressions can be derived for its
mean and covariance structure. Suppose that $T(x)= \exp\{S(x)\}$,
where $S(x)$ is a stationary Gaussian process with mean
$\mu$, variance $\sigma^2$ and correlation function
$\rho(u)$. The moment generating function of $S(x)$ is
\begin{equation}
M(a) = {\rm E}[\exp\{aS(x)\}]
      =\exp\{a \mu + \frac{1}{2} a^2 \sigma^2\}.
\end{equation}
It follows from~(\ref{eqn03:mgf}), setting $a=1$, that $T(x)$ has
expectation
\begin{equation}
\mu_T = \exp\left(\mu + \frac{1}{2} \sigma^2\right).
\end{equation}
Similarly, setting $a=2$ in (\ref{eqn03:mgf}) gives ${\rm E}[T(x)^2]$,
and hence the variance of $T(x)$ as
\begin{equation}
\sigma_T^2 = \exp(2 \mu + \sigma^2)\{\exp(\sigma^2)-1\}.
\label{eqn03:lognormalvar}
\end{equation}
Finally,
for any two locations $x$ and $x^\prime$,
$T(x)T(x^\prime) = \exp\{S(x)+S(x^\prime)\}$, and
$S(x)+S(x^\prime)$ is Gaussian with mean $m=2 \mu$ and
variance $v=2\sigma^2\{1+\rho(||x-x^\prime||)\}$. It follows
that
${\rm E}[T(x)T(x^\prime)] = \exp(m+v/2)$, and straightforward
algebra gives the
correlation function of $T(x)$ as
\begin{equation}
\rho_T(u) = [\exp\{\sigma^2 \rho(u)\}- 1]/
           [\exp\{\sigma^2\} - 1].


Paulo Justiniano Ribeiro Jr
LEG (Laboratorio de Estatistica e Geoinformacao)
Universidade Federal do Parana
Caixa Postal 19.081
CEP 81.531-990
Curitiba, PR  -  Brasil
Tel: (+55) 41 3361 3573
VOIP: (+55) (41) (3361 3600) 1053 1066
Fax: (+55) 41 3361 3141
e-mail: paulojus AT  ufpr  br
http://www.leg.ufpr.br/~paulojus

On Fri, 8 Oct 2010, Samuel Turgeon wrote:

> Hi,
>
> I'm working with the function krige.conv of the library geoR. I'm wondering
> how the predicted result are back-transformed when the lambda parameter is
> set to 0 (log-transformation)? Is it a simply transformation like
> exp(result$prediction)? I saw some code example on the web where the exp()
> function was used after the kriging of log-transformed data. Those examples
> were using gstat and the krige function. I have limited knowledge in
> geostatistic, but I think that we cannot use exp() to do the
> backtransformation of the predicted data.... that's why I would like to know
> how the result are back-transformed in the function krige.conv.
>
>
> Thanks
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From ogbos.okike at gmail.com  Fri Oct  8 20:21:45 2010
From: ogbos.okike at gmail.com (ogbos okike)
Date: Fri, 8 Oct 2010 20:21:45 +0200
Subject: [R-sig-Geo] World map in magnetic coordinates
In-Reply-To: <AANLkTimQBTNUjAboRVM=cf2SZmHGsdRX+OgORfMm1U4N@mail.gmail.com>
References: <AANLkTinLrBaQubVyRdy0LW6-WiLEsRG=CO5ieCuzE1tE@mail.gmail.com>
	<AANLkTimt_v-WC2WhKToDL5Rr0=-HMqKQaPoB3yDi+WYO@mail.gmail.com>
	<AANLkTime2ZuTu+pA5GTOs=ngP7iRW=srhRpRgRPx5MWa@mail.gmail.com>
	<AANLkTinUZnVH4qLHPBGgLNXCwmQe=VROPoVQY-H=wgux@mail.gmail.com>
	<AANLkTimQBTNUjAboRVM=cf2SZmHGsdRX+OgORfMm1U4N@mail.gmail.com>
Message-ID: <AANLkTin2VqTc2LhiV4i4x8nvFTkPQ2m5+9jqAkjNw7Kg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101008/ce200916/attachment.pl>

From eick at vistracks.com  Fri Oct  8 23:01:37 2010
From: eick at vistracks.com (eick at vistracks.com)
Date: Fri, 8 Oct 2010 16:01:37 -0500
Subject: [R-sig-Geo] transparent png images for map overlays
Message-ID: <008901cb672b$ffb8b1e0$ff2a15a0$@cs.uic.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101008/48477be9/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Sat Oct  9 00:17:12 2010
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Fri, 8 Oct 2010 23:17:12 +0100
Subject: [R-sig-Geo] World map in magnetic coordinates
In-Reply-To: <AANLkTin2VqTc2LhiV4i4x8nvFTkPQ2m5+9jqAkjNw7Kg@mail.gmail.com>
References: <AANLkTinLrBaQubVyRdy0LW6-WiLEsRG=CO5ieCuzE1tE@mail.gmail.com>
	<AANLkTimt_v-WC2WhKToDL5Rr0=-HMqKQaPoB3yDi+WYO@mail.gmail.com>
	<AANLkTime2ZuTu+pA5GTOs=ngP7iRW=srhRpRgRPx5MWa@mail.gmail.com>
	<AANLkTinUZnVH4qLHPBGgLNXCwmQe=VROPoVQY-H=wgux@mail.gmail.com>
	<AANLkTimQBTNUjAboRVM=cf2SZmHGsdRX+OgORfMm1U4N@mail.gmail.com>
	<AANLkTin2VqTc2LhiV4i4x8nvFTkPQ2m5+9jqAkjNw7Kg@mail.gmail.com>
Message-ID: <AANLkTi=7aE-4x1_Gp4TnrkpekaMOQAi+SoYTxqCohLkz@mail.gmail.com>

On Fri, Oct 8, 2010 at 7:21 PM, ogbos okike <ogbos.okike at gmail.com> wrote:

> library(maps)
> ?data(worldMapEnv)
> ?map("world")
> The three steps above in R gives you the world map I mean.

 if you do:

 w = map("world")

 then w will be a simple list with $x and $y components, as well as
$range and $names. If you write the $x and $y to a file, convert, then
read back into $x and $y (and then convert the $range, which is the
bounding box) you should have something you can plot in transformed
coordinates.

 Note that polygons are separated by an NA in $x and $y, so you will
have to make sure you preserve those too.

Barry


From clint at ecy.wa.gov  Sat Oct  9 00:24:08 2010
From: clint at ecy.wa.gov (Clint Bowman)
Date: Fri, 8 Oct 2010 15:24:08 -0700 (PDT)
Subject: [R-sig-Geo] World map in magnetic coordinates
In-Reply-To: <AANLkTi=7aE-4x1_Gp4TnrkpekaMOQAi+SoYTxqCohLkz@mail.gmail.com>
References: <AANLkTinLrBaQubVyRdy0LW6-WiLEsRG=CO5ieCuzE1tE@mail.gmail.com>
	<AANLkTimt_v-WC2WhKToDL5Rr0=-HMqKQaPoB3yDi+WYO@mail.gmail.com>
	<AANLkTime2ZuTu+pA5GTOs=ngP7iRW=srhRpRgRPx5MWa@mail.gmail.com>
	<AANLkTinUZnVH4qLHPBGgLNXCwmQe=VROPoVQY-H=wgux@mail.gmail.com>
	<AANLkTimQBTNUjAboRVM=cf2SZmHGsdRX+OgORfMm1U4N@mail.gmail.com>
	<AANLkTin2VqTc2LhiV4i4x8nvFTkPQ2m5+9jqAkjNw7Kg@mail.gmail.com>
	<AANLkTi=7aE-4x1_Gp4TnrkpekaMOQAi+SoYTxqCohLkz@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1010081523090.5836@aeolus.ecy.wa.gov>

Why not plot data and map in original coordinates and then overlay 
with grid lines showing magnetic coordinates?

-- 
Clint Bowman			INTERNET:	clint at ecy.wa.gov
Air Quality Modeler		INTERNET:	clint at math.utah.edu
Department of Ecology		VOICE:		(360) 407-6815
PO Box 47600			FAX:		(360) 407-7534
Olympia, WA 98504-7600

On Fri, 8 Oct 2010, Barry Rowlingson wrote:

> On Fri, Oct 8, 2010 at 7:21 PM, ogbos okike <ogbos.okike at gmail.com> wrote:
>
>> library(maps)
>> ?data(worldMapEnv)
>> ?map("world")
>> The three steps above in R gives you the world map I mean.
>
> if you do:
>
> w = map("world")
>
> then w will be a simple list with $x and $y components, as well as
> $range and $names. If you write the $x and $y to a file, convert, then
> read back into $x and $y (and then convert the $range, which is the
> bounding box) you should have something you can plot in transformed
> coordinates.
>
> Note that polygons are separated by an NA in $x and $y, so you will
> have to make sure you preserve those too.
>
> Barry
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

From govindas at msu.edu  Sat Oct  9 01:32:09 2010
From: govindas at msu.edu (govindas at msu.edu)
Date: Fri, 08 Oct 2010 19:32:09 -0400
Subject: [R-sig-Geo] reading .grd file in R?
Message-ID: <20101008193209.12352l6w81xau03d@mail.msu.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101008/ffa7bf70/attachment.pl>

From roman.lustrik at gmail.com  Sat Oct  9 08:49:31 2010
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Sat, 9 Oct 2010 08:49:31 +0200
Subject: [R-sig-Geo] reading .grd file in R?
In-Reply-To: <20101008193209.12352l6w81xau03d@mail.msu.edu>
References: <20101008193209.12352l6w81xau03d@mail.msu.edu>
Message-ID: <AANLkTinWLzkNeeq-X9vuMZSGAxVv0s_SMa6=7-gYS4ox@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101009/c3c38afd/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Sat Oct  9 10:19:20 2010
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Sat, 9 Oct 2010 09:19:20 +0100
Subject: [R-sig-Geo] reading .grd file in R?
In-Reply-To: <20101008193209.12352l6w81xau03d@mail.msu.edu>
References: <20101008193209.12352l6w81xau03d@mail.msu.edu>
Message-ID: <AANLkTinRJ8wmMP9ky3D7HghrqSemuecFgEnfT8Ldnwgs@mail.gmail.com>

On Sat, Oct 9, 2010 at 12:32 AM,  <govindas at msu.edu> wrote:
>
>
> Can someone let me know what package and function should be used to read *.grd files in R? I tried readGDAL, open.ncdf functions already which threw errors for file format mismatch.

 A file extension is not a good indication of what the file type is. I
could rename any file 'foo.grd' and it could be anything.

 Show us what readGDAL gives as an error message, and then we might be
able to help. readGDAL tries to guess the file format, maybe it
guessed right but the file is corrupted.

 Where did the file come from? Can we get it? Can you open it in a
text editor? Do you have a unix/linux box so you can run the command
'file' on it?

Barry


From govindas at msu.edu  Sat Oct  9 19:22:36 2010
From: govindas at msu.edu (govindas at msu.edu)
Date: Sat, 09 Oct 2010 13:22:36 -0400
Subject: [R-sig-Geo] reading .grd file in R?
In-Reply-To: <AANLkTinRJ8wmMP9ky3D7HghrqSemuecFgEnfT8Ldnwgs@mail.gmail.com>
References: <20101008193209.12352l6w81xau03d@mail.msu.edu>
	<AANLkTinRJ8wmMP9ky3D7HghrqSemuecFgEnfT8Ldnwgs@mail.gmail.com>
Message-ID: <20101009132236.12931k4z1ww82sik@mail.msu.edu>



Yes, i know its a Grads file ..! i have attached the control file and the grid file can be downloaded frm the link given below!

http://www.4shared.com/file/cuSG-05j/rf05_1975.html

I have not used Grads before, still i was able to read in  the control file and get the basic info.!?but, i am not sure about the package  required for .grd files in R - will i be able to read a Grads grid file into  R??? 

Thank u all,
Mahalakshmi 

 Quoting Barry Rowlingson <b.rowlingson at lancaster.ac.uk>:

> On Sat, Oct 9, 2010 at 12:32 AM,? <govindas at msu.edu> wrote:
>>
>>
>> Can someone let me know what package and function should be used to 
>> read *.grd files in R? I tried readGDAL, open.ncdf functions already 
>> which threw errors for file format mismatch.
>
>? A file extension is not a good indication of what the file type is. I
> could rename any file 'foo.grd' and it could be anything.
>
>? Show us what readGDAL gives as an error message, and then we might be
> able to help. readGDAL tries to guess the file format, maybe it
> guessed right but the file is corrupted.
>
>? Where did the file come from? Can we get it? Can you open it in a
> text editor? Do you have a unix/linux box so you can run the command
> 'file' on it?
>
> Barry
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101009/17dafa28/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: rfpt5.ctl
Type: application/octet-stream
Size: 279 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101009/17dafa28/attachment.obj>

From rhurlin at gwdg.de  Sat Oct  9 21:49:50 2010
From: rhurlin at gwdg.de (Rainer Hurling)
Date: Sat, 09 Oct 2010 21:49:50 +0200
Subject: [R-sig-Geo] reading .grd file in R?
In-Reply-To: <20101009132236.12931k4z1ww82sik@mail.msu.edu>
References: <20101008193209.12352l6w81xau03d@mail.msu.edu>	<AANLkTinRJ8wmMP9ky3D7HghrqSemuecFgEnfT8Ldnwgs@mail.gmail.com>
	<20101009132236.12931k4z1ww82sik@mail.msu.edu>
Message-ID: <4CB0C75E.8090903@gwdg.de>

Hi Mahalakshmi,

On 09.10.2010 19:22 (UTC+1), govindas at msu.edu wrote:
> Yes, i know its a Grads file ..! i have attached the control file and
> the grid file can be downloaded frm the link given below!
>
> http://www.4shared.com/file/cuSG-05j/rf05_1975.html
>
> I have not used Grads before, still i was able to read in the control
> file and get the basic info.! but, i am not sure about the package
> required for .grd files in R - will i be able to read a Grads grid file
> into R???

I am afraid there is no direct solution at this time in R. Perhaps the 
following script can help converting the data?

http://cookbooks.opengrads.org/index.php?title=Recipe-002:_Saving_GrADS_variable_data_to_a_text_file

Hope this helps,
Rainer


> Thank u all,
> Mahalakshmi
>
> Quoting Barry Rowlingson <b.rowlingson at lancaster.ac.uk>:
>
>  > On Sat, Oct 9, 2010 at 12:32 AM, <govindas at msu.edu> wrote:
>  >>
>  >>
>  >> Can someone let me know what package and function should be used to
>  >> read *.grd files in R? I tried readGDAL, open.ncdf functions already
>  >> which threw errors for file format mismatch.
>  >
>  >  A file extension is not a good indication of what the file type is. I
>  > could rename any file 'foo.grd' and it could be anything.
>  >
>  >  Show us what readGDAL gives as an error message, and then we might be
>  > able to help. readGDAL tries to guess the file format, maybe it
>  > guessed right but the file is corrupted.
>  >
>  >  Where did the file come from? Can we get it? Can you open it in a
>  > text editor? Do you have a unix/linux box so you can run the command
>  > 'file' on it?
>  >
>  > Barry


From r.m.krug at gmail.com  Sun Oct 10 17:43:37 2010
From: r.m.krug at gmail.com (Rainer M Krug)
Date: Sun, 10 Oct 2010 17:43:37 +0200
Subject: [R-sig-Geo] Question concerning calc() function in raster
Message-ID: <AANLkTin4CHxKbQas3msggJizsnPC_WSkykXYpFuwd5mz@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101010/37a0ddef/attachment.pl>

From r.hijmans at gmail.com  Sun Oct 10 19:07:21 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sun, 10 Oct 2010 13:07:21 -0400
Subject: [R-sig-Geo] Question concerning calc() function in raster
In-Reply-To: <AANLkTin4CHxKbQas3msggJizsnPC_WSkykXYpFuwd5mz@mail.gmail.com>
References: <AANLkTin4CHxKbQas3msggJizsnPC_WSkykXYpFuwd5mz@mail.gmail.com>
Message-ID: <AANLkTim7=5rFKXXWXNrzgSik8LhAb-FW_pjiZssHdJgD@mail.gmail.com>

Hi Rainer,

1) .calcLayers is only used for functions that operate on a matrix;
not in other cases. Perhaps calc does not work correctly in some cases
(for some functions), and to investigate that it would be useful to
know what you are trying to accomplish.

2) yes that was wrong and now fixed. Thanks!

Best,
Robert


On Sun, Oct 10, 2010 at 11:43 AM, Rainer M Krug <r.m.krug at gmail.com> wrote:
> Hi
> I have two questions concerning the function calc() (more accurately
> .calcLayers()) (I append the code of the function below) :
> 1) The value given to the function fun() is a matrix, containig the values
> for many calls from all layers - this is not clear from the help page, and
> probably should be changed as it complicates the development of fun()
> functions. It effectively assumes, that the function fun() does vectorize
> the input parameter, which is in most cases when more complicated
> calculations are done, not the case (at least not for me). I would suggest
> to put it up to discussion, if this behaviour should be changed.
> 2) Is the (!canProcessInMemory(x, 2)) correct? I would actually assume, that
> the processing in one piece is only done, when canProcessInMemory() is
> TRUE?
> Cheers and thanks a lot for this really hice package (I am back and using it
> again),
> Rainer
>
> .calcLayers <- function(x, fun, filename='', ...) {
> filename <- trim(filename)
> outraster <- brick(x, values=FALSE)
> if (!canProcessInMemory(x, 2)) {
> v <- t( fun( t( getValues(x) )) )
> if (filename != '') {
> outraster <- writeRaster(outraster)
> }
> return( setValues(outraster, v) )
> }
> if ( filename == '') {
> filename <- rasterTmpFile()
> }
> outraster <- writeStart(outraster, filename=filename, ...)
> tr <- blockSize(outraster)
> pb <- pbCreate(tr$n, type=.progress(...))
> for (i in 1:tr$n) {
> sv <- t( fun( t( getValues(x, row=tr$row[i], nrows=tr$nrows[i]) )) )
> outraster <- writeValues(outraster, sv, tr$row[i])
> pbStep(pb)
> }
> outraster <- writeStop(outraster)
> pbClose(pb)
> return(outraster)
> }
>
> --
> NEW GERMAN FAX NUMBER!!!
>
> Rainer M. Krug, PhD (Conservation Ecology, SUN), MSc (Conservation Biology,
> UCT), Dipl. Phys. (Germany)
>
> Centre of Excellence for Invasion Biology
> Natural Sciences Building
> Office Suite 2039
> Stellenbosch University
> Main Campus, Merriman Avenue
> Stellenbosch
> South Africa
>
> Cell:? ? ? ? ?? +27 - (0)83 9479 042
> Fax:? ? ? ? ? ? +27 - (0)86 516 2782
> Fax:? ? ? ? ? ? +49 - (0)321 2125 2244
> email:? ? ? ? ? Rainer at krugs.de
>
> Skype:? ? ? ? ? RMkrug
> Google:? ? ? ?? R.M.Krug at gmail.com
>
>


From govindas at msu.edu  Sun Oct 10 21:58:36 2010
From: govindas at msu.edu (govindas at msu.edu)
Date: Sun, 10 Oct 2010 15:58:36 -0400
Subject: [R-sig-Geo] reading .grd file in R?
In-Reply-To: <4CB0C75E.8090903@gwdg.de>
References: <20101008193209.12352l6w81xau03d@mail.msu.edu>
	<AANLkTinRJ8wmMP9ky3D7HghrqSemuecFgEnfT8Ldnwgs@mail.gmail.com>
	<20101009132236.12931k4z1ww82sik@mail.msu.edu>
	<4CB0C75E.8090903@gwdg.de>
Message-ID: <20101010155836.15831esixful2vvw@mail.msu.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101010/74114a7c/attachment.pl>

From alobolistas at gmail.com  Sun Oct 10 22:36:12 2010
From: alobolistas at gmail.com (Agustin Lobo)
Date: Sun, 10 Oct 2010 22:36:12 +0200
Subject: [R-sig-Geo] CRS: list of datum?
Message-ID: <AANLkTi=tXp2EHZuaUa_c-QZ7kcXwgGzxw=zzB8UUOo5y@mail.gmail.com>

HI!

While
> CRS("+proj=utm +zone=32 +datum=WGS84")
CRS arguments:
 +proj=utm +zone=32 +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0

is correct, the same with ED50 is not:

> CRS("+proj=utm +zone=32 +datum=ED50")
Error in CRS("+proj=utm +zone=32 +datum=ED50") :
  unknown elliptical parameter name

Is there any way to get the list of available datum acronyms?

Thanks

Agus


From williamkarlwilson at yahoo.com  Mon Oct 11 00:06:51 2010
From: williamkarlwilson at yahoo.com (karl wilson)
Date: Sun, 10 Oct 2010 15:06:51 -0700 (PDT)
Subject: [R-sig-Geo] degAxis() does not print degree symbol
In-Reply-To: <mailman.11.1286704803.6256.r-sig-geo@stat.math.ethz.ch>
Message-ID: <268293.51767.qm@web59714.mail.ac4.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101010/fb26b4d3/attachment.pl>

From edzer.pebesma at uni-muenster.de  Mon Oct 11 07:49:21 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 11 Oct 2010 07:49:21 +0200
Subject: [R-sig-Geo] degAxis() does not print degree symbol
In-Reply-To: <268293.51767.qm@web59714.mail.ac4.yahoo.com>
References: <268293.51767.qm@web59714.mail.ac4.yahoo.com>
Message-ID: <4CB2A561.1070704@uni-muenster.de>

Karl, I'm running Ubuntu and do not have such problems.

Can you provide us with a reproducable example, a .png of the output you
see, and give us the output of sessionInfo() ? Is it only the degree
symbol that gives problems, or do you have other font issues?

On 10/11/2010 12:06 AM, karl wilson wrote:
> Hello,
>  
> I have recently been trying Bivand's book and tried to print the degree symbol along with longitude and latitude in the axes. It only prints a gamma or kappa symbol. 
> 
> I am using Ubuntu 10.10 on an i486 . The version of R is the latest R version 2.11.1 (2010-05-31)
> 
> I have a slice of Debian lenny running on the same machine and it can print the degree symbol perfectly.
> 
> Does anyone know if this is an Ubuntu problem or just a problem with the latest R distribution. Should I ask this question on an R forum?
> 
> I did find some chatter about this on another forum ( I can not remember which) but it did not get resolved there, or I could not find the resolution. 
> I believe someone said that Ripley, B. had contacted them off forum for some advice.
> 
> Any advice on this would be appreciated. 
> 
> Karl Wilson
> 
> --- On Sun, 10/10/10, r-sig-geo-request at stat.math.ethz.ch <r-sig-geo-request at stat.math.ethz.ch> wrote:
> 
> From: r-sig-geo-request at stat.math.ethz.ch <r-sig-geo-request at stat.math.ethz.ch>
> Subject: R-sig-Geo Digest, Vol 86, Issue 10
> To: r-sig-geo at stat.math.ethz.ch
> Date: Sunday, October 10, 2010, 10:00 AM
> 
> Send R-sig-Geo mailing list submissions to
>     r-sig-geo at stat.math.ethz.ch
> 
> To subscribe or unsubscribe via the World Wide Web, visit
>     https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> or, via email, send a message with subject or body 'help' to
>     r-sig-geo-request at stat.math.ethz.ch
> 
> You can reach the person managing the list at
>     r-sig-geo-owner at stat.math.ethz.ch
> 
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of R-sig-Geo digest..."
> 
> 
> Today's Topics:
> 
>    1. Re: reading .grd file in R? (govindas at msu.edu)
>    2. Re: reading .grd file in R? (Rainer Hurling)
> 
> 
> ----------------------------------------------------------------------
> 
> Message: 1
> Date: Sat, 09 Oct 2010 13:22:36 -0400
> From: govindas at msu.edu
> To: Barry Rowlingson <b.rowlingson at lancaster.ac.uk>
> Cc: r-sig-geo at stat.math.ethz.ch
> Subject: Re: [R-sig-Geo] reading .grd file in R?
> Message-ID: <20101009132236.12931k4z1ww82sik at mail.msu.edu>
> Content-Type: text/plain; charset="iso-8859-1"
> 
> 
> 
> Yes, i know its a Grads file ..! i have attached the control file and the g[[elided Yahoo spam]]
> 
> http://www.4shared.com/file/cuSG-05j/rf05_1975.html
> 
> I have not used Grads before, still i was able to read in  the control file and get the basic info.!?but, i am not sure about the package  required for .grd files in R - will i be able to read a Grads grid file into  R??? 
> 
> Thank u all,
> Mahalakshmi 
> 
>  Quoting Barry Rowlingson <b.rowlingson at lancaster.ac.uk>:
> 
>> On Sat, Oct 9, 2010 at 12:32 AM,? <govindas at msu.edu> wrote:
>>>
>>>
>>> Can someone let me know what package and function should be used to 
>>> read *.grd files in R? I tried readGDAL, open.ncdf functions already 
>>> which threw errors for file format mismatch.
>>
>> ? A file extension is not a good indication of what the file type is. I
>> could rename any file 'foo.grd' and it could be anything.
>>
>> ? Show us what readGDAL gives as an error message, and then we might be
>> able to help. readGDAL tries to guess the file format, maybe it
>> guessed right but the file is corrupted.
>>
>> ? Where did the file come from? Can we get it? Can you open it in a
>> text editor? Do you have a unix/linux box so you can run the command
>> 'file' on it?
>>
>> Barry
>>
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101009/17dafa28/attachment-0001.html>
> -------------- next part --------------
> A non-text attachment was scrubbed...
> Name: rfpt5.ctl
> Type: application/octet-stream
> Size: 279 bytes
> Desc: not available
> URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101009/17dafa28/attachment-0001.obj>
> 
> ------------------------------
> 
> Message: 2
> Date: Sat, 09 Oct 2010 21:49:50 +0200
> From: Rainer Hurling <rhurlin at gwdg.de>
> To: govindas at msu.edu
> Cc: r-sig-geo at stat.math.ethz.ch
> Subject: Re: [R-sig-Geo] reading .grd file in R?
> Message-ID: <4CB0C75E.8090903 at gwdg.de>
> Content-Type: text/plain; charset=ISO-8859-1; format=flowed
> 
> Hi Mahalakshmi,
> 
> On 09.10.2010 19:22 (UTC+1), govindas at msu.edu wrote:
>> Yes, i know its a Grads file ..! i have attached the control file and
> [[elided Yahoo spam]]
>>
>> http://www.4shared.com/file/cuSG-05j/rf05_1975.html
>>
>> I have not used Grads before, still i was able to read in the control
>> file and get the basic info.! but, i am not sure about the package
>> required for .grd files in R - will i be able to read a Grads grid file
>> into R???
> 
> I am afraid there is no direct solution at this time in R. Perhaps the 
> following script can help converting the data?
> 
> http://cookbooks.opengrads.org/index.php?title=Recipe-002:_Saving_GrADS_variable_data_to_a_text_file
> 
> Hope this helps,
> Rainer
> 
> 
>> Thank u all,
>> Mahalakshmi
>>
>> Quoting Barry Rowlingson <b.rowlingson at lancaster.ac.uk>:
>>
>>   > On Sat, Oct 9, 2010 at 12:32 AM, <govindas at msu.edu> wrote:
>>   >>
>>   >>
>>   >> Can someone let me know what package and function should be used to
>>   >> read *.grd files in R? I tried readGDAL, open.ncdf functions already
>>   >> which threw errors for file format mismatch.
>>   >
>>   >  A file extension is not a good indication of what the file type is. I
>>   > could rename any file 'foo.grd' and it could be anything.
>>   >
>>   >  Show us what readGDAL gives as an error message, and then we might be
>>   > able to help. readGDAL tries to guess the file format, maybe it
>>   > guessed right but the file is corrupted.
>>   >
>>   >  Where did the file come from? Can we get it? Can you open it in a
>>   > text editor? Do you have a unix/linux box so you can run the command
>>   > 'file' on it?
>>   >
>>   > Barry
> 
> 
> 
> ------------------------------
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 
> End of R-sig-Geo Digest, Vol 86, Issue 10
> *****************************************
> 
> 
> 
>       
> 	[[alternative HTML version deleted]]
> 
> 
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From caspar.hallmann at gmail.com  Mon Oct 11 08:59:43 2010
From: caspar.hallmann at gmail.com (caspar hallmann)
Date: Mon, 11 Oct 2010 08:59:43 +0200
Subject: [R-sig-Geo] CRS: list of datum?
In-Reply-To: <AANLkTi=tXp2EHZuaUa_c-QZ7kcXwgGzxw=zzB8UUOo5y@mail.gmail.com>
References: <AANLkTi=tXp2EHZuaUa_c-QZ7kcXwgGzxw=zzB8UUOo5y@mail.gmail.com>
Message-ID: <AANLkTimoKkMC=vObnWK+BpnB=+DQgd4TQ72zRfCiAH9W@mail.gmail.com>

HI Agus,

see
A=make_EPSG()
A

in rgdal

Caspar





On Sun, Oct 10, 2010 at 10:36 PM, Agustin Lobo <alobolistas at gmail.com> wrote:
> HI!
>
> While
>> CRS("+proj=utm +zone=32 +datum=WGS84")
> CRS arguments:
> ?+proj=utm +zone=32 +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0
>
> is correct, the same with ED50 is not:
>
>> CRS("+proj=utm +zone=32 +datum=ED50")
> Error in CRS("+proj=utm +zone=32 +datum=ED50") :
> ?unknown elliptical parameter name
>
> Is there any way to get the list of available datum acronyms?
>
> Thanks
>
> Agus
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From alobolistas at gmail.com  Mon Oct 11 10:54:17 2010
From: alobolistas at gmail.com (Agustin Lobo)
Date: Mon, 11 Oct 2010 10:54:17 +0200
Subject: [R-sig-Geo] CRS: list of datum?
In-Reply-To: <AANLkTimoKkMC=vObnWK+BpnB=+DQgd4TQ72zRfCiAH9W@mail.gmail.com>
References: <AANLkTi=tXp2EHZuaUa_c-QZ7kcXwgGzxw=zzB8UUOo5y@mail.gmail.com>
	<AANLkTimoKkMC=vObnWK+BpnB=+DQgd4TQ72zRfCiAH9W@mail.gmail.com>
Message-ID: <AANLkTim3dNMvi1ROBjCXkuDiJNnvkxxujscL8spQbAYF@mail.gmail.com>

Casper,

Thanks, this is very useful, although does not solve my problem.
What I would need is to define:

proj4string(lakes) <- CRS("+proj=utm +zone=35 +datum=ED87
+towgs84=-82.981,-99.719,-110.709,-0.5076,0.1503,0.3898")

according to
http://www.asprs.org/resources/grids/10-99-norway.pdf

My question is why +datum=WGS84 works but +datum=ED87 or +datum=ED50
do not work?

Using A <- make_EPSG() I've been able to find:

> A$note[grep("ED",A$note)]
> A[160,]
    code   note                               prj4
160 4231 # ED87 +proj=longlat +ellps=intl +no_defs

but this is a lonlat projection, what I need is a UTM projection.

I've also found:

> A[2540,]
      code                  note
      prj4
2540 23035 # ED50 / UTM zone 35N +proj=utm +zone=35 +ellps=intl
+units=m +no_defs

and have used:

> proj4string(lakes) <-CRS(paste("+init=epsg:23035",
 "+towgs84=-82.981,-99.719,-110.709,-0.5076,0.1503,0.3898"))
> lakesll <- spTransform(lakes, CRS("+proj=longlat +datum=WGS84"))
> writeOGR(lakesll,dsn="Kolalakesll",layer="Kolalakesll",driver="ESRI Shapefile")

but lakesll is shifted if overlaid on an image with lonlat and WGS84
"projection" and
I suspect the reason is using ED50 instead of ED87.

Note1. lakes comes from:

library(StatDA)
library(maptools)
xy <- kola.background$lakes
names(xy) <- c("x", "y")
lakes <- map2SpatialLines(xy)
lakesdata <- data.frame(ID=1:131,lakename=rep("",131),stringsAsFactors=F)
row.names(lakesdata) <- 1:131
lakes <- SpatialLinesDataFrame(sl=lakes, data=lakesdata, match.ID = TRUE)

Note2: sessionInfo()
R version 2.11.1 (2010-05-31)
i486-pc-linux-gnu

locale:
 [1] LC_CTYPE=en_US.UTF-8          LC_NUMERIC=C
LC_TIME=en_US.UTF-8
 [4] LC_COLLATE=en_US.UTF-8        LC_MONETARY=en_US.UTF-8
LC_MESSAGES=en_US.UTF-8
 [7] LC_PAPER=en_US.UTF-8          LC_NAME=en_US.UTF-8
LC_ADDRESS=en_US.UTF-8
[10] LC_TELEPHONE=en_US.UTF-8      LC_MEASUREMENT=en_US.UTF-8
LC_IDENTIFICATION=en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] rgdal_0.6-27 raster_1.1.2 sp_0.9-62    rkward_0.5.4

loaded via a namespace (and not attached):
[1] grid_2.11.1     lattice_0.19-11 tools_2.11.1

Thanks!
Agus

2010/10/11 caspar hallmann <caspar.hallmann at gmail.com>:
> HI Agus,
>
> see
> A=make_EPSG()
> A
>
> in rgdal
>
> Caspar
>
>
>
>
>
> On Sun, Oct 10, 2010 at 10:36 PM, Agustin Lobo <alobolistas at gmail.com> wrote:
>> HI!
>>
>> While
>>> CRS("+proj=utm +zone=32 +datum=WGS84")
>> CRS arguments:
>> ?+proj=utm +zone=32 +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0
>>
>> is correct, the same with ED50 is not:
>>
>>> CRS("+proj=utm +zone=32 +datum=ED50")
>> Error in CRS("+proj=utm +zone=32 +datum=ED50") :
>> ?unknown elliptical parameter name
>>
>> Is there any way to get the list of available datum acronyms?
>>
>> Thanks
>>
>> Agus
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From edzer.pebesma at uni-muenster.de  Mon Oct 11 12:35:26 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 11 Oct 2010 12:35:26 +0200
Subject: [R-sig-Geo] spplot: 1) filling background polygon without
 overwriting foreground polygon; 2) left justifying sp.layout text
In-Reply-To: <AANLkTi=4b+eXxkxBqDnkkMs2C5dRWbBAAgqcQa_6fD53@mail.gmail.com>
References: <AANLkTi=4b+eXxkxBqDnkkMs2C5dRWbBAAgqcQa_6fD53@mail.gmail.com>
Message-ID: <4CB2E86E.20400@uni-muenster.de>

sp 0.9-71, which propagates through CRAN, solves this, as discussed
earlier in
http://r-sig-geo.2731867.n2.nabble.com/spplot-1-filling-background-polygon-without-overwriting-foreground-polygon-2-left-justifying-sp-layot-td5615087.html#a5615087

Best regards,

On 10/08/2010 04:18 PM, Lyndon Estes wrote:
> Greetings,
> 
> I have two questions related to spplot:
> 
> 1. I am trying to plot one SpatialPolygonsDataFrame over another, and
> fill the background polygon with grey. I can't seem to fill the
> background polygon without having it cover over my supposed foreground
> polygon, even if I specify "first = T" (which fails to draw the
> background polygon):
> 
> # Code
> 
> # Load shapefiles
> con1 <- url("http://sites.google.com/site/ldemisc/spplot-question/demo.mdshp.RData")
> con2 <- url("http://sites.google.com/site/ldemisc/spplot-question/demo.sashp.RData")
> load(con1); load(con2); close(con1); close(con2)
> 
> # Set up plot background shape and additional text for map
> 
> # Covers over md.shp
> #sa.lst = list("sp.polygons", sa.shp, fill = "grey", col = "black")
> 
> # Covers over md.shp
> #sa.lst = list("sp.polygons", sa.shp, fill = "grey", first = F, col =
> "black")
> 
> # sa.shp doesn't plot
> #sa.lst = list("sp.polygons", sa.shp, fill = "grey", first = T, col = "black")
> 
> # Background polygon works like this, but without fill
> sa.lst = list("sp.polygons", sa.shp, col = "black")
> 
> # Additional text - overall mean yield.
> text1 <- list("sp.text", c(360000, -3210000),
>              paste("Overall mean yield =",
> round(mean(md.shp at data[-c(22,69), 4]), 0), "kg/ha"),
>              col ="red", cex = 1)
> 
> # Scale bar limits and title
> scmax  <- round(max(md.shp at data[, 4]) / 50, 0) * 50
> scmin  <- round(min(md.shp at data[, 4]) / 50, 0) * 50
> byval  <- 25
> titlevec <- "Mean district maize yields (kg/ha) 1981-99: Cultivar PAN6528"
> 
> # Spplot
> dev.new()
> spplot(md.shp[-c(22,69),], z = 4,
>        sp.layout = list(sa.lst, text1),
>        col.regions = topo.colors(500),
>        at = seq(scmin, scmax, by = byval),
>        main = titlevec)
> 
> Any advice on how to correctly set "sa.lst" so that sa.shp fills
> underneath md.shp will be much appreciated.  I haven't been able to
> find a ready answer in the help files, except for this:
> 
> "The order of items in sp.layout matters; objects are drawn in the
> order they appear. Plot order and prevalence of sp.layout items: for
> points and lines, sp.layout items are drawn before the points (to
> allow for grids and polygons); for grids and polygons sp.layout is
> drawn afterwards (so the item will not be overdrawn by the grid and/or
> polygon). Although a matter of taste, transparency may help when
> combining things. "
> 
> But, beyond what I have tried so far, I can't figure out how to write
> the code so that sa.shp is drawn first.
> 
> The second question:
> 
> 2. Is there an option to pass to:
> 
> text1 <- list("sp.text", c(360000, -3210000),
>             paste("Overall mean yield =",
> round(mean(md.shp at data[-c(22,69), 4]), 0), "kg/ha"),
>             col ="red", cex = 1)
> 
> so that the text is left-justified on the coordinates  c(360000,
> -3210000)? At the moment it seems that the text is centered at this
> location.
> 
> Thanks in advance for any help you can provide.
> 
> Best, Lyndon
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From tom.gottfried at wzw.tum.de  Mon Oct 11 15:01:12 2010
From: tom.gottfried at wzw.tum.de (Tom Gottfried)
Date: Mon, 11 Oct 2010 15:01:12 +0200
Subject: [R-sig-Geo] CRS: list of datum?
In-Reply-To: <AANLkTim3dNMvi1ROBjCXkuDiJNnvkxxujscL8spQbAYF@mail.gmail.com>
References: <AANLkTim3dNMvi1ROBjCXkuDiJNnvkxxujscL8spQbAYF@mail.gmail.com>
Message-ID: <4CB30A98.2030007@wzw.tum.de>

Hi Agustin,

you can use `cs2cs -ld' directly in your shell to list all datums known to proj.4

Tom
-- 
Technische Universit?t M?nchen
Department f?r Pflanzenwissenschaften
Lehrstuhl f?r Gr?nlandlehre
Alte Akademie 12
85350 Freising / Germany
Phone: ++49 (0)8161 715324
Fax:   ++49 (0)8161 713243
email: tom.gottfried at wzw.tum.de
http://www.wzw.tum.de/gruenland


From alobolistas at gmail.com  Mon Oct 11 16:28:38 2010
From: alobolistas at gmail.com (Agustin Lobo)
Date: Mon, 11 Oct 2010 16:28:38 +0200
Subject: [R-sig-Geo] CRS: list of datum?
In-Reply-To: <4CB30A98.2030007@wzw.tum.de>
References: <AANLkTim3dNMvi1ROBjCXkuDiJNnvkxxujscL8spQbAYF@mail.gmail.com>
	<4CB30A98.2030007@wzw.tum.de>
Message-ID: <AANLkTimi7k32ykvVVCDoGN5H=C-U_qFXoRKV9fEEf0MU@mail.gmail.com>

Thanks,

I see the problem: have 11 datums and ED50 or ED87 are not
among them. Is there any way to add datums? or is this something that
comes with proj4 and it is just as it is?

Agus


2010/10/11 Tom Gottfried <tom.gottfried at wzw.tum.de>:
> Hi Agustin,
>
> you can use `cs2cs -ld' directly in your shell to list all datums known to
> proj.4
>
> Tom
> --
> Technische Universit?t M?nchen
> Department f?r Pflanzenwissenschaften
> Lehrstuhl f?r Gr?nlandlehre
> Alte Akademie 12
> 85350 Freising / Germany
> Phone: ++49 (0)8161 715324
> Fax: ? ++49 (0)8161 713243
> email: tom.gottfried at wzw.tum.de
> http://www.wzw.tum.de/gruenland
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From tom.gottfried at wzw.tum.de  Mon Oct 11 17:35:49 2010
From: tom.gottfried at wzw.tum.de (Tom Gottfried)
Date: Mon, 11 Oct 2010 17:35:49 +0200
Subject: [R-sig-Geo] CRS: list of datum?
In-Reply-To: <AANLkTimi7k32ykvVVCDoGN5H=C-U_qFXoRKV9fEEf0MU@mail.gmail.com>
References: <AANLkTim3dNMvi1ROBjCXkuDiJNnvkxxujscL8spQbAYF@mail.gmail.com>	<4CB30A98.2030007@wzw.tum.de>
	<AANLkTimi7k32ykvVVCDoGN5H=C-U_qFXoRKV9fEEf0MU@mail.gmail.com>
Message-ID: <4CB32ED5.7000003@wzw.tum.de>

I'm really not an expert, but I know that in GRASS exist four different sets of +towgs84 parameters 
for the potsdam datum (due to regional differences that seem to go back to inaccuracies in the 
original land survey by Karl Friedrich Gau? in Germany). If one of these is specified, it is not 
necessary to specify +datum=potsdam, as all of the information seems to be in +towgs84. So if you 
have the +towgs84 parameter set for the datum you need, I would think you can just specify that. 
What you can read here seems to approve this:

http://trac.osgeo.org/proj/wiki/GenParms#towgs84-DatumtransformationtoWGS84

Tom

Am 11.10.2010 16:28, schrieb Agustin Lobo:
> Thanks,
>
> I see the problem: have 11 datums and ED50 or ED87 are not
> among them. Is there any way to add datums? or is this something that
> comes with proj4 and it is just as it is?
>
> Agus
>
>
> 2010/10/11 Tom Gottfried<tom.gottfried at wzw.tum.de>:
>> Hi Agustin,
>>
>> you can use `cs2cs -ld' directly in your shell to list all datums known to
>> proj.4
>>
>> Tom
>> --
>> Technische Universit?t M?nchen
>> Department f?r Pflanzenwissenschaften
>> Lehrstuhl f?r Gr?nlandlehre
>> Alte Akademie 12
>> 85350 Freising / Germany
>> Phone: ++49 (0)8161 715324
>> Fax:   ++49 (0)8161 713243
>> email: tom.gottfried at wzw.tum.de
>> http://www.wzw.tum.de/gruenland
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>

-- 
Technische Universit?t M?nchen
Department f?r Pflanzenwissenschaften
Lehrstuhl f?r Gr?nlandlehre
Alte Akademie 12
85350 Freising / Germany
Phone: ++49 (0)8161 715324
Fax:   ++49 (0)8161 713243
email: tom.gottfried at wzw.tum.de
http://www.wzw.tum.de/gruenland


From dguignet at arec.umd.edu  Mon Oct 11 19:23:11 2010
From: dguignet at arec.umd.edu (Dennis Guignet)
Date: Mon, 11 Oct 2010 13:23:11 -0400
Subject: [R-sig-Geo] gwt2nb - regions with zero links
Message-ID: <E7C57FAA7891B94DBA265B591642DE2587E24C7C4C@mail.arec.umd.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101011/2bc31781/attachment.pl>

From Roger.Bivand at nhh.no  Mon Oct 11 23:01:03 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 11 Oct 2010 23:01:03 +0200 (CEST)
Subject: [R-sig-Geo] CRS: list of datum?
In-Reply-To: <AANLkTim3dNMvi1ROBjCXkuDiJNnvkxxujscL8spQbAYF@mail.gmail.com>
References: <AANLkTi=tXp2EHZuaUa_c-QZ7kcXwgGzxw=zzB8UUOo5y@mail.gmail.com>
	<AANLkTimoKkMC=vObnWK+BpnB=+DQgd4TQ72zRfCiAH9W@mail.gmail.com>
	<AANLkTim3dNMvi1ROBjCXkuDiJNnvkxxujscL8spQbAYF@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1010112258390.15258@reclus.nhh.no>

On Mon, 11 Oct 2010, Agustin Lobo wrote:

> Casper,
>
> Thanks, this is very useful, although does not solve my problem.

The list of datums known to proj4 is given by projInfo("datum") - untried, 
please try yourself. If they are not given, it is because they are 
ambiguous, so proj4 sensibly errs on the side of caution. You have to give 
the towgs84= values yourself for your area.

Roger

> What I would need is to define:
>
> proj4string(lakes) <- CRS("+proj=utm +zone=35 +datum=ED87
> +towgs84=-82.981,-99.719,-110.709,-0.5076,0.1503,0.3898")
>
> according to
> http://www.asprs.org/resources/grids/10-99-norway.pdf
>
> My question is why +datum=WGS84 works but +datum=ED87 or +datum=ED50
> do not work?
>
> Using A <- make_EPSG() I've been able to find:
>
>> A$note[grep("ED",A$note)]
>> A[160,]
>    code   note                               prj4
> 160 4231 # ED87 +proj=longlat +ellps=intl +no_defs
>
> but this is a lonlat projection, what I need is a UTM projection.
>
> I've also found:
>
>> A[2540,]
>      code                  note
>      prj4
> 2540 23035 # ED50 / UTM zone 35N +proj=utm +zone=35 +ellps=intl
> +units=m +no_defs
>
> and have used:
>
>> proj4string(lakes) <-CRS(paste("+init=epsg:23035",
> "+towgs84=-82.981,-99.719,-110.709,-0.5076,0.1503,0.3898"))
>> lakesll <- spTransform(lakes, CRS("+proj=longlat +datum=WGS84"))
>> writeOGR(lakesll,dsn="Kolalakesll",layer="Kolalakesll",driver="ESRI Shapefile")
>
> but lakesll is shifted if overlaid on an image with lonlat and WGS84
> "projection" and
> I suspect the reason is using ED50 instead of ED87.
>
> Note1. lakes comes from:
>
> library(StatDA)
> library(maptools)
> xy <- kola.background$lakes
> names(xy) <- c("x", "y")
> lakes <- map2SpatialLines(xy)
> lakesdata <- data.frame(ID=1:131,lakename=rep("",131),stringsAsFactors=F)
> row.names(lakesdata) <- 1:131
> lakes <- SpatialLinesDataFrame(sl=lakes, data=lakesdata, match.ID = TRUE)
>
> Note2: sessionInfo()
> R version 2.11.1 (2010-05-31)
> i486-pc-linux-gnu
>
> locale:
> [1] LC_CTYPE=en_US.UTF-8          LC_NUMERIC=C
> LC_TIME=en_US.UTF-8
> [4] LC_COLLATE=en_US.UTF-8        LC_MONETARY=en_US.UTF-8
> LC_MESSAGES=en_US.UTF-8
> [7] LC_PAPER=en_US.UTF-8          LC_NAME=en_US.UTF-8
> LC_ADDRESS=en_US.UTF-8
> [10] LC_TELEPHONE=en_US.UTF-8      LC_MEASUREMENT=en_US.UTF-8
> LC_IDENTIFICATION=en_US.UTF-8
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] rgdal_0.6-27 raster_1.1.2 sp_0.9-62    rkward_0.5.4
>
> loaded via a namespace (and not attached):
> [1] grid_2.11.1     lattice_0.19-11 tools_2.11.1
>
> Thanks!
> Agus
>
> 2010/10/11 caspar hallmann <caspar.hallmann at gmail.com>:
>> HI Agus,
>>
>> see
>> A=make_EPSG()
>> A
>>
>> in rgdal
>>
>> Caspar
>>
>>
>>
>>
>>
>> On Sun, Oct 10, 2010 at 10:36 PM, Agustin Lobo <alobolistas at gmail.com> wrote:
>>> HI!
>>>
>>> While
>>>> CRS("+proj=utm +zone=32 +datum=WGS84")
>>> CRS arguments:
>>> ?+proj=utm +zone=32 +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0
>>>
>>> is correct, the same with ED50 is not:
>>>
>>>> CRS("+proj=utm +zone=32 +datum=ED50")
>>> Error in CRS("+proj=utm +zone=32 +datum=ED50") :
>>> ?unknown elliptical parameter name
>>>
>>> Is there any way to get the list of available datum acronyms?
>>>
>>> Thanks
>>>
>>> Agus
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From b.rowlingson at lancaster.ac.uk  Tue Oct 12 00:35:33 2010
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Mon, 11 Oct 2010 23:35:33 +0100
Subject: [R-sig-Geo] reading .grd file in R?
In-Reply-To: <4CB0C75E.8090903@gwdg.de>
References: <20101008193209.12352l6w81xau03d@mail.msu.edu>
	<AANLkTinRJ8wmMP9ky3D7HghrqSemuecFgEnfT8Ldnwgs@mail.gmail.com>
	<20101009132236.12931k4z1ww82sik@mail.msu.edu>
	<4CB0C75E.8090903@gwdg.de>
Message-ID: <AANLkTi=MWT52kpLGfT_nFqkb5-LLiVDH1d6-W=LrhByW@mail.gmail.com>

On Sat, Oct 9, 2010 at 8:49 PM, Rainer Hurling <rhurlin at gwdg.de> wrote:

> http://cookbooks.opengrads.org/index.php?title=Recipe-002:_Saving_GrADS_variable_data_to_a_text_file

Grads .grd files are raw binary files, and so can be read using the
GDAL .vrt mechanism once you know the basics of the binary format and
the metadata in the .ctl file.

Looking at the .ctl file I guess the grids are 69x65 pixels square,
and that there are 365 of them (daily data for a year). From the size
of the file I see this means 4 bytes per pixel (69x65*365*4 = size of
file exactly). There's no header and no padding. Its four bytes per
value.

 However we don't know the format of the value. It could be floating
point, 32 bit integers etc etc.

 Here's a .vrt file that reads in the second day's data (which is what
the offset of 17940=69*65*4 skips to):

<VRTDataset rasterXSize="69" rasterYSize="65">
  <VRTRasterBand dataType="UInt32" band="1" subClass="VRTRawRasterBand">
    <SourceFilename relativeToVRT="1">rf0.5_1975.grd</SourceFilename>
    <ImageOffset>17940</ImageOffset>
    <PixelOffset>4</PixelOffset>
    <LineOffset>276</LineOffset>
    <ByteOrder>LSB</ByteOrder>
  </VRTRasterBand>
</VRTDataset>

If you read that in with v2=readGDAL("file.vrt") (put it in the same
folder as the .grd file) then you will get something reasonable if you
do image(v2), however I'm not sure we got the dataType right, since
the values are all over the place. Further day's data can be read by
changing the image offset in multiples of 17940.

 I'd fix it more but it's bedtime.

Barry


From alobolistas at gmail.com  Tue Oct 12 12:08:08 2010
From: alobolistas at gmail.com (Agustin Lobo)
Date: Tue, 12 Oct 2010 12:08:08 +0200
Subject: [R-sig-Geo] CRS: list of datum?
In-Reply-To: <alpine.LRH.2.00.1010112258390.15258@reclus.nhh.no>
References: <AANLkTi=tXp2EHZuaUa_c-QZ7kcXwgGzxw=zzB8UUOo5y@mail.gmail.com>
	<AANLkTimoKkMC=vObnWK+BpnB=+DQgd4TQ72zRfCiAH9W@mail.gmail.com>
	<AANLkTim3dNMvi1ROBjCXkuDiJNnvkxxujscL8spQbAYF@mail.gmail.com>
	<alpine.LRH.2.00.1010112258390.15258@reclus.nhh.no>
Message-ID: <AANLkTikWHUzH6XNJP9qZDKb1NVZCyB0s+pGSs9MOj9XL@mail.gmail.com>

Roger,

projInfo("datum") works fine and outputs 10 datum,
ED50 and ED87 not listed.

Anyway, looking for an operational solution, is this correct for Norway?

CRS("+proj=utm +zone=35 +ellps=intl +units=m +no_defs
+towgs84=-82.981,-99.719,-110.709,-0.5076,0.1503,0.3898")

(I'm assuming that the Kola data in StatDa follow projection standards
for Norway as in
http://www.asprs.org/resources/grids/10-99-norway.pdf).

because the fact is that the output layer produced by spTransform()
seems to be shifted.

Agus

2010/10/11 Roger Bivand <Roger.Bivand at nhh.no>:
> On Mon, 11 Oct 2010, Agustin Lobo wrote:
>
>> Casper,
>>
>> Thanks, this is very useful, although does not solve my problem.
>
> The list of datums known to proj4 is given by projInfo("datum") - untried,
> please try yourself. If they are not given, it is because they are
> ambiguous, so proj4 sensibly errs on the side of caution. You have to give
> the towgs84= values yourself for your area.
>
> Roger
>
>> What I would need is to define:
>>
>> proj4string(lakes) <- CRS("+proj=utm +zone=35 +datum=ED87
>> +towgs84=-82.981,-99.719,-110.709,-0.5076,0.1503,0.3898")
>>
>> according to
>> http://www.asprs.org/resources/grids/10-99-norway.pdf
>>
>> My question is why +datum=WGS84 works but +datum=ED87 or +datum=ED50
>> do not work?
>>
>> Using A <- make_EPSG() I've been able to find:
>>
>>> A$note[grep("ED",A$note)]
>>> A[160,]
>>
>> ? code ? note ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? prj4
>> 160 4231 # ED87 +proj=longlat +ellps=intl +no_defs
>>
>> but this is a lonlat projection, what I need is a UTM projection.
>>
>> I've also found:
>>
>>> A[2540,]
>>
>> ? ? code ? ? ? ? ? ? ? ? ?note
>> ? ? prj4
>> 2540 23035 # ED50 / UTM zone 35N +proj=utm +zone=35 +ellps=intl
>> +units=m +no_defs
>>
>> and have used:
>>
>>> proj4string(lakes) <-CRS(paste("+init=epsg:23035",
>>
>> "+towgs84=-82.981,-99.719,-110.709,-0.5076,0.1503,0.3898"))
>>>
>>> lakesll <- spTransform(lakes, CRS("+proj=longlat +datum=WGS84"))
>>> writeOGR(lakesll,dsn="Kolalakesll",layer="Kolalakesll",driver="ESRI
>>> Shapefile")
>>
>> but lakesll is shifted if overlaid on an image with lonlat and WGS84
>> "projection" and
>> I suspect the reason is using ED50 instead of ED87.
>>
>> Note1. lakes comes from:
>>
>> library(StatDA)
>> library(maptools)
>> xy <- kola.background$lakes
>> names(xy) <- c("x", "y")
>> lakes <- map2SpatialLines(xy)
>> lakesdata <- data.frame(ID=1:131,lakename=rep("",131),stringsAsFactors=F)
>> row.names(lakesdata) <- 1:131
>> lakes <- SpatialLinesDataFrame(sl=lakes, data=lakesdata, match.ID = TRUE)
>>
>> Note2: sessionInfo()
>> R version 2.11.1 (2010-05-31)
>> i486-pc-linux-gnu
>>
>> locale:
>> [1] LC_CTYPE=en_US.UTF-8 ? ? ? ? ?LC_NUMERIC=C
>> LC_TIME=en_US.UTF-8
>> [4] LC_COLLATE=en_US.UTF-8 ? ? ? ?LC_MONETARY=en_US.UTF-8
>> LC_MESSAGES=en_US.UTF-8
>> [7] LC_PAPER=en_US.UTF-8 ? ? ? ? ?LC_NAME=en_US.UTF-8
>> LC_ADDRESS=en_US.UTF-8
>> [10] LC_TELEPHONE=en_US.UTF-8 ? ? ?LC_MEASUREMENT=en_US.UTF-8
>> LC_IDENTIFICATION=en_US.UTF-8
>>
>> attached base packages:
>> [1] stats ? ? graphics ?grDevices utils ? ? datasets ?methods ? base
>>
>> other attached packages:
>> [1] rgdal_0.6-27 raster_1.1.2 sp_0.9-62 ? ?rkward_0.5.4
>>
>> loaded via a namespace (and not attached):
>> [1] grid_2.11.1 ? ? lattice_0.19-11 tools_2.11.1
>>
>> Thanks!
>> Agus
>>
>> 2010/10/11 caspar hallmann <caspar.hallmann at gmail.com>:
>>>
>>> HI Agus,
>>>
>>> see
>>> A=make_EPSG()
>>> A
>>>
>>> in rgdal
>>>
>>> Caspar
>>>
>>>
>>>
>>>
>>>
>>> On Sun, Oct 10, 2010 at 10:36 PM, Agustin Lobo <alobolistas at gmail.com>
>>> wrote:
>>>>
>>>> HI!
>>>>
>>>> While
>>>>>
>>>>> CRS("+proj=utm +zone=32 +datum=WGS84")
>>>>
>>>> CRS arguments:
>>>> ?+proj=utm +zone=32 +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0
>>>>
>>>> is correct, the same with ED50 is not:
>>>>
>>>>> CRS("+proj=utm +zone=32 +datum=ED50")
>>>>
>>>> Error in CRS("+proj=utm +zone=32 +datum=ED50") :
>>>> ?unknown elliptical parameter name
>>>>
>>>> Is there any way to get the list of available datum acronyms?
>>>>
>>>> Thanks
>>>>
>>>> Agus
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at stat.math.ethz.ch
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> --
> Roger Bivand
> Economic Geography Section, Department of Economics, Norwegian School of
> Economics and Business Administration, Helleveien 30, N-5045 Bergen,
> Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


From villers.alexandre at gmail.com  Tue Oct 12 17:40:11 2010
From: villers.alexandre at gmail.com (Alexandre Villers)
Date: Tue, 12 Oct 2010 18:40:11 +0300
Subject: [R-sig-Geo] [R-sig-eco] Coordinates Spatstat
In-Reply-To: <AANLkTi=f+-TfjJgaPR+UR_spofBVUyxZTcQzoJwErouh@mail.gmail.com>
References: <AANLkTi=f+-TfjJgaPR+UR_spofBVUyxZTcQzoJwErouh@mail.gmail.com>
Message-ID: <4CB4815B.7090503@gmail.com>

  Good evening,

Next time, send a small piece of code of what is not working... it will 
be easier to know what you mean with coordinates are in other format...
If your coordinates are the way written below, then you should try to 
convert them into numbers rather than factors (523259N for example will 
be treated as a factor). Coordinates in meters are fine and I don't see 
where the problem could come from.
Well in fact, I guess if you need help, you should be more precise. Not 
easy without knowing the real problem.

So waiting for your next post to help...

Cheers

Alex


  On 12/10/2010 18:28, Nelson Fernandez wrote:

Dear List members,
> We are working with spatstat package. We are trying to carry out a point
> pattern analysis, but We have some problems with our data due they are in
> UTM coordinates (i.e. 523259N, 448062E). Spatstat routine mention, in this
> case, that the coordinates are very long or that Y coordinate is no found or
> it is failed.
>
> In additon, we have notice, in some examples, that coordinates are in other
> format. Somebody could help us with this, I will appreciate so much.
>
> Kind Regards
>
> Nelson
>
> Grupo de Investigaci?nes en Ecolog?a y Biogeograf?a
>
> Universidad de Pamplona. Colombia
>
> *
>
>
> *
>
> 	[[alternative HTML version deleted]]
>
>
>
> _______________________________________________
> R-sig-ecology mailing list
> R-sig-ecology at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-ecology


-- 
Alexandre Villers, PhD.
Postdoc researcher
Spatial Ecology & Population Dynamics
Section of Ecology, Department of Biology
University of Turku
FIN-20014 Turku
Finland

@mail: alexandre.villers at utu.fi
phone: 00358 (0)2 333 5049

Skype You can skype me (but think of using Ekiga instead !) 
<skype:aquila06?call>


*Use open source and free softwares*
<http://cran.r-project.org/> <http://grass.itc.it/> 
<http://www.qgis.org/> <http://fr.openoffice.org/> 
<http://www.mozilla-europe.org/fr/> <http://www.mozilla-europe.org/fr/>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101012/95ba145a/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Skypelogo.jpg
Type: image/jpeg
Size: 5395 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101012/95ba145a/attachment.jpg>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Rlogo.jpg
Type: image/jpeg
Size: 1753 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101012/95ba145a/attachment-0001.jpg>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: GRASSlogo.png
Type: image/png
Size: 3277 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101012/95ba145a/attachment.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: QGIS.png
Type: image/png
Size: 4144 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101012/95ba145a/attachment-0001.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: OOlogo.gif
Type: image/gif
Size: 4246 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101012/95ba145a/attachment.gif>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: TBlogo.jpg
Type: image/jpeg
Size: 1385 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101012/95ba145a/attachment-0002.jpg>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: FFlogo.jpg
Type: image/jpeg
Size: 1686 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101012/95ba145a/attachment-0003.jpg>

From b.rowlingson at lancaster.ac.uk  Tue Oct 12 20:36:05 2010
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Tue, 12 Oct 2010 19:36:05 +0100
Subject: [R-sig-Geo] reading .grd file in R?
In-Reply-To: <AANLkTi=MWT52kpLGfT_nFqkb5-LLiVDH1d6-W=LrhByW@mail.gmail.com>
References: <20101008193209.12352l6w81xau03d@mail.msu.edu>
	<AANLkTinRJ8wmMP9ky3D7HghrqSemuecFgEnfT8Ldnwgs@mail.gmail.com>
	<20101009132236.12931k4z1ww82sik@mail.msu.edu>
	<4CB0C75E.8090903@gwdg.de>
	<AANLkTi=MWT52kpLGfT_nFqkb5-LLiVDH1d6-W=LrhByW@mail.gmail.com>
Message-ID: <AANLkTimdv3Vjv63KwYJ-NkN8do=P9o0VUOEXJvfhQKcE@mail.gmail.com>

Anybody still reading this?

I'm sometimes so stuck with sp-objects and rgdal that I forget that
the easiest way to read raw binary data is with readBin. Wrap it into
a function, make it a matrix, now I can easily read time slices:

readTime <-
  function(f,tm,x=69,y=65,size=4,type="double",NAvalue=-999){
    c = file(f,open="rb")
    seek(c,x*y*(tm-1)*size)
    m=matrix(readBin(c,type,x*y,size),x,y)
    close(c)
    m[abs(m-NAvalue)<.Machine$double.eps] = NA
    m
  }

 par(mfrow=c(2,2))
 for(p in 1:4){
 image(readTime("rf0.5_1975.grd",p))
 }

 I didn't realise it was India because my gdal virtual raster was sideways.

Barry


From ogbos.okike at gmail.com  Tue Oct 12 20:51:28 2010
From: ogbos.okike at gmail.com (ogbos okike)
Date: Tue, 12 Oct 2010 20:51:28 +0200
Subject: [R-sig-Geo] World map in magnetic coordinates: Problem Fixed
Message-ID: <AANLkTikpg8bULVgv+1DCAuAJz9muw15GQT_MTA2bFh=Y@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101012/bdd6349c/attachment.pl>

From jsbarret at sfu.ca  Tue Oct 12 22:00:00 2010
From: jsbarret at sfu.ca (Jenn.B)
Date: Tue, 12 Oct 2010 13:00:00 -0700 (PDT)
Subject: [R-sig-Geo] Why can you not calculate Moran's i for glm()
	residuals?
In-Reply-To: <1286394572067-5608678.post@n2.nabble.com>
References: <1648993377.1171009.1285379813741.JavaMail.root@jaguar9.sfu.ca>
	<1286394572067-5608678.post@n2.nabble.com>
Message-ID: <1286913600763-5628276.post@n2.nabble.com>


Hi Tara,

I have not been able to find any additional information on an acceptable
method for examining spatial autocorrelation in the residuals of a glm model
(or any model besides an lm), nor have I been able to ascertain whether
visual inspection of Moran's i correlograms is the way to go in this case
(rather than testing for significance), or if a variogram is a better option
(if anyone else on this list can add to this, that would be much appreciated
- by both of us I'm sure)!

On a side note: In creating your correlograms, are you using the ncf or
pgrimess package (the latter of which is a wrapper for spdep's moran.test )?
I've found that even when run on the dependent variable (i.e., not the
residuals, but the Y variable, which in my case is a count or
presence/absence) the two functions produce very different correlograms,
particularly in the largest distance bins.

Cheers - and good luck,
Jenn
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Why-can-you-not-calculate-Moran-s-i-for-glm-residuals-tp5568942p5628276.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From rhurlin at gwdg.de  Tue Oct 12 22:00:49 2010
From: rhurlin at gwdg.de (Rainer Hurling)
Date: Tue, 12 Oct 2010 22:00:49 +0200
Subject: [R-sig-Geo] reading .grd file in R?
In-Reply-To: <AANLkTimdv3Vjv63KwYJ-NkN8do=P9o0VUOEXJvfhQKcE@mail.gmail.com>
References: <20101008193209.12352l6w81xau03d@mail.msu.edu>	<AANLkTinRJ8wmMP9ky3D7HghrqSemuecFgEnfT8Ldnwgs@mail.gmail.com>	<20101009132236.12931k4z1ww82sik@mail.msu.edu>	<4CB0C75E.8090903@gwdg.de>	<AANLkTi=MWT52kpLGfT_nFqkb5-LLiVDH1d6-W=LrhByW@mail.gmail.com>
	<AANLkTimdv3Vjv63KwYJ-NkN8do=P9o0VUOEXJvfhQKcE@mail.gmail.com>
Message-ID: <4CB4BE71.9050809@gwdg.de>

On 12.10.2010 20:36 (UTC+1), Barry Rowlingson wrote:
> Anybody still reading this?

Yes, even though I am not working with grd data, the problem is 
interesting. Instead I am working with .sgrd (SAGA GRID binaries), which 
can be read with rgdal and/or RSAGA.

> I'm sometimes so stuck with sp-objects and rgdal that I forget that
> the easiest way to read raw binary data is with readBin. Wrap it into
> a function, make it a matrix, now I can easily read time slices:
>
> readTime<-
>    function(f,tm,x=69,y=65,size=4,type="double",NAvalue=-999){
>      c = file(f,open="rb")
>      seek(c,x*y*(tm-1)*size)
>      m=matrix(readBin(c,type,x*y,size),x,y)
>      close(c)
>      m[abs(m-NAvalue)<.Machine$double.eps] = NA
>      m
>    }
>
>   par(mfrow=c(2,2))
>   for(p in 1:4){
>   image(readTime("rf0.5_1975.grd",p))
>   }
>
>   I didn't realise it was India because my gdal virtual raster was sideways.

Thanks for showing this way for working with binary data,
Rainer Hurling

> Barry


From govindas at msu.edu  Tue Oct 12 22:04:42 2010
From: govindas at msu.edu (govindas at msu.edu)
Date: Tue, 12 Oct 2010 16:04:42 -0400
Subject: [R-sig-Geo] reading .grd file in R?
In-Reply-To: <AANLkTimdv3Vjv63KwYJ-NkN8do=P9o0VUOEXJvfhQKcE@mail.gmail.com>
References: <20101008193209.12352l6w81xau03d@mail.msu.edu>
	<AANLkTinRJ8wmMP9ky3D7HghrqSemuecFgEnfT8Ldnwgs@mail.gmail.com>
	<20101009132236.12931k4z1ww82sik@mail.msu.edu>
	<4CB0C75E.8090903@gwdg.de>
	<AANLkTi=MWT52kpLGfT_nFqkb5-LLiVDH1d6-W=LrhByW@mail.gmail.com>
	<AANLkTimdv3Vjv63KwYJ-NkN8do=P9o0VUOEXJvfhQKcE@mail.gmail.com>
Message-ID: <20101012160442.2430760hev50t4d6@mail.msu.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101012/d21f414c/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Tue Oct 12 23:27:54 2010
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Tue, 12 Oct 2010 22:27:54 +0100
Subject: [R-sig-Geo] reading .grd file in R?
In-Reply-To: <20101012160442.2430760hev50t4d6@mail.msu.edu>
References: <20101008193209.12352l6w81xau03d@mail.msu.edu>
	<AANLkTinRJ8wmMP9ky3D7HghrqSemuecFgEnfT8Ldnwgs@mail.gmail.com>
	<20101009132236.12931k4z1ww82sik@mail.msu.edu>
	<4CB0C75E.8090903@gwdg.de>
	<AANLkTi=MWT52kpLGfT_nFqkb5-LLiVDH1d6-W=LrhByW@mail.gmail.com>
	<AANLkTimdv3Vjv63KwYJ-NkN8do=P9o0VUOEXJvfhQKcE@mail.gmail.com>
	<20101012160442.2430760hev50t4d6@mail.msu.edu>
Message-ID: <AANLkTinyLmSx=S1cq3nYLyCFccURRSE065w44v-kP3ZS@mail.gmail.com>

On Tue, Oct 12, 2010 at 9:04 PM,  <govindas at msu.edu> wrote:
>
>
> Thanks a lot for cracking this Barry.... But, I am still not able to
> completely understand this as I?am not so experienced in R! I got an image
> display with 4 plots in it. If I am not wrong, are these the plots of
> rainfall Values (or the gridded dataset) for the 1st four days? can you
> explain this function's overall purpose, so that I could know if I got it
> right!

 All the metadata comes from the .ctl file, which looks like this:

DSET ^rf0.5_1975.grd
options template
TITLE 0.5 degranalyzed normal grids
UNDEF -999.0
XDEF  69  LINEAR  66.5 0.5
YDEF  65  LINEAR  6.5 0.5
ZDEF   1 linear 1 1
TDEF 365 LINEAR 1jan1975 1DY
* FOR LEAP YEARS CHANGE NO. OF RECORDS TO 366 *
VARS  1
rf 0 99 GRIDDED RAINFALL
ENDVARS

 I don't understand all of it, but that's where I get the X and Y size
of the grid, and also how I know its 365 time grids. The UNDEF line
tells me that -999.0 is missing data or no data in some sense.

> I have some other doubts as well which i have mentioned below!

 Yes, it wasn't exactly well commented code! Here goes:

 > c = file(f,open="rb")
 > seek(c,x*y*(tm-1)*size)??????????????????????? #what is its purpose?

 The file() function opens a 'connection' to the file, and then 'seek'
skips a number of bytes into the connection so that the next readBin
starts there. In this case we skip 69*65*(tm-1)*4 bytes, which gets us
to the tm'th time grid (there are 4 (the size of each number) times 69
times 65 bytes per time grid).

 > m=matrix(readBin(c,type,x*y,size),x,y)

 This then reads the binary data as 'double' values, 69*65 of them,
and puts them in a 69x65 matrix.

 > close(c)
 > m[abs(m-NAvalue)<.Machine$double.eps] = NA???????????? # a datavalue in
 > matrix is checked for its lowest possible value and assigned "NA" if its so?

Its fairly common to use an extreme low or high value for missing
data. In this case the value is specified in the .ctl file (see
above). I use a test against .Machine$double.eps because testing for
exact equality with floating point numbers doesn't always work as
expected.

 > par(mfrow=c(2,2))
 > for(p in 1:4){
 > image(readTime("rf0.5_1975.grd",p))
 > }

 The 'par' splits the window into 4 and then the loop does indeed plot
the data for time=1 to time=4.

 The next thing to do (I really should go to bed now) is assign X and
Y coordinates. In the .ctl they are:

XDEF  69  LINEAR  66.5 0.5
YDEF  65  LINEAR  6.5 0.5

 so I think they are:

 x = seq(66.5,len=69, by=0.5)
 y = seq(6.5,len=65, by=0.5)

You can then create a list of x, y and z values this way:

 r3=list(x=seq(66.5,len=69, by=0.5),y=seq(6.5,len=65,
by=0.5),z=readTime("rf0.5_1975.grd",3))

and get a properly georeferenced image matrix, which you could overlay
on a map of india from the 'maps' package:

 library(maps)
 map("world","india")
 image(r3,add=TRUE)

 which is nice.

 Info about the grads metadata file is here:

http://www.iges.org/grads/gadoc/descriptorfile.html

Barry


From govindas at msu.edu  Wed Oct 13 00:35:33 2010
From: govindas at msu.edu (govindas at msu.edu)
Date: Tue, 12 Oct 2010 18:35:33 -0400
Subject: [R-sig-Geo] reading .grd file in R?
In-Reply-To: <AANLkTinyLmSx=S1cq3nYLyCFccURRSE065w44v-kP3ZS@mail.gmail.com>
References: <20101008193209.12352l6w81xau03d@mail.msu.edu>
	<AANLkTinRJ8wmMP9ky3D7HghrqSemuecFgEnfT8Ldnwgs@mail.gmail.com>
	<20101009132236.12931k4z1ww82sik@mail.msu.edu>
	<4CB0C75E.8090903@gwdg.de>
	<AANLkTi=MWT52kpLGfT_nFqkb5-LLiVDH1d6-W=LrhByW@mail.gmail.com>
	<AANLkTimdv3Vjv63KwYJ-NkN8do=P9o0VUOEXJvfhQKcE@mail.gmail.com>
	<20101012160442.2430760hev50t4d6@mail.msu.edu>
	<AANLkTinyLmSx=S1cq3nYLyCFccURRSE065w44v-kP3ZS@mail.gmail.com>
Message-ID: <20101012183533.174655ptnz3fw33p@mail.msu.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101012/67486db7/attachment.pl>

From pensterfuzzer at yahoo.de  Wed Oct 13 15:37:00 2010
From: pensterfuzzer at yahoo.de (Werner W.)
Date: Wed, 13 Oct 2010 14:37:00 +0100 (BST)
Subject: [R-sig-Geo] UTM problem
Message-ID: <656339.67994.qm@web29517.mail.ird.yahoo.com>

Hi,

this questions is not really about R but it would be great if somebody could 
point me to a forum or so where I can get help with this.

I only know a few basics about GIS and have a problem with some UTM coordinates 
from a survey.
Coordinates are given as, e.g.
3258843     32780
which are supposedly zone 36N on system WGS84 (according to the documentation).
If I convert it to long/lat using gdal:
> require(rgdal)
> SP <- SpatialPoints(cbind(X=3258843, Y=32780),proj4string=CRS("+proj=utm 
>+zone=36 +ellps=WGS84"))
> spTransform(SP, CRS("+proj=longlat +ellps=WGS84")) # x1=longitude x2=lat
SpatialPoints:
           X         Y
[1,] 57.0489 0.2706471
Coordinate Reference System (CRS) arguments: +proj=longlat +ellps=WGS84 

The point should be close to Kampala which has the coordinates 0.3?, 32.633333? 
and UTM 36N 459199 33160 on WGS84. My data's easting seems quite off. 

Has anybody an idea what I am doing wrongly? 

Thanks so much,
  Werner




From sarah.goslee at gmail.com  Wed Oct 13 15:48:50 2010
From: sarah.goslee at gmail.com (Sarah Goslee)
Date: Wed, 13 Oct 2010 09:48:50 -0400
Subject: [R-sig-Geo] UTM problem
In-Reply-To: <656339.67994.qm@web29517.mail.ird.yahoo.com>
References: <656339.67994.qm@web29517.mail.ird.yahoo.com>
Message-ID: <AANLkTina0yC7W4GHmOa=PctoDSoie_MhXQ82m=r5VNpw@mail.gmail.com>

Hi,

I double-checked your results with an online conversion tool
(http://www.rcn.montana.edu/resources/tools/coordinates.aspx)
and got the same answer.

That means that your R code is fine, and there's something
wrong with the original data. If possible, you should check with
the source. There could be a problem with the metadata, or
with the data themselves.

Sarah

On Wed, Oct 13, 2010 at 9:37 AM, Werner W. <pensterfuzzer at yahoo.de> wrote:
> Hi,
>
> this questions is not really about R but it would be great if somebody could
> point me to a forum or so where I can get help with this.
>
> I only know a few basics about GIS and have a problem with some UTM coordinates
> from a survey.
> Coordinates are given as, e.g.
> 3258843 ? ? 32780
> which are supposedly zone 36N on system WGS84 (according to the documentation).
> If I convert it to long/lat using gdal:
>> require(rgdal)
>> SP <- SpatialPoints(cbind(X=3258843, Y=32780),proj4string=CRS("+proj=utm
>>+zone=36 +ellps=WGS84"))
>> spTransform(SP, CRS("+proj=longlat +ellps=WGS84")) # x1=longitude x2=lat
> SpatialPoints:
> ? ? ? ? ? X ? ? ? ? Y
> [1,] 57.0489 0.2706471
> Coordinate Reference System (CRS) arguments: +proj=longlat +ellps=WGS84
>
> The point should be close to Kampala which has the coordinates 0.3?, 32.633333?
> and UTM 36N 459199 33160 on WGS84. My data's easting seems quite off.
>
> Has anybody an idea what I am doing wrongly?
>
> Thanks so much,
> ?Werner
>
>
>


-- 
Sarah Goslee
http://www.functionaldiversity.org


From pensterfuzzer at yahoo.de  Wed Oct 13 16:08:59 2010
From: pensterfuzzer at yahoo.de (Werner W.)
Date: Wed, 13 Oct 2010 15:08:59 +0100 (BST)
Subject: [R-sig-Geo] UTM problem
In-Reply-To: <AANLkTina0yC7W4GHmOa=PctoDSoie_MhXQ82m=r5VNpw@mail.gmail.com>
References: <656339.67994.qm@web29517.mail.ird.yahoo.com>
	<AANLkTina0yC7W4GHmOa=PctoDSoie_MhXQ82m=r5VNpw@mail.gmail.com>
Message-ID: <368367.3195.qm@web29501.mail.ird.yahoo.com>

Hi Sarah,

many thanks for checking this. I looked at the documentation again and this is 
the info about the GPS receiver setting they used:
POSITION FRMT: hddd.ddddd
MAP DATUM: WGS 84
CDI: +-0.25
UNITS: METRIC
HEADINGS: GRID E000
DEGEES


I'm not sure if this is any useful.
Any idea what I should be looking for?

The survey actually covers the whole of Uganda. Can it actually be that the 
entire country is UTM zone 36N or does the zone have to change? The docu 
suggests it is all 36N.

Thanks again,
  Werner




----- Urspr?ngliche Mail ----
> Von: Sarah Goslee <sarah.goslee at gmail.com>
> An: Werner W. <pensterfuzzer at yahoo.de>
> CC: r-sig-geo at stat.math.ethz.ch
> Gesendet: Mittwoch, den 13. Oktober 2010, 14:48:50 Uhr
> Betreff: Re: [R-sig-Geo] UTM problem
> 
> Hi,
> 
> I double-checked your results with an online conversion tool
> (http://www.rcn.montana.edu/resources/tools/coordinates.aspx)
> and got the  same answer.
> 
> That means that your R code is fine, and there's  something
> wrong with the original data. If possible, you should check  with
> the source. There could be a problem with the metadata, or
> with the  data themselves.
> 
> Sarah
> 
> On Wed, Oct 13, 2010 at 9:37 AM, Werner W.  <pensterfuzzer at yahoo.de>  wrote:
> > Hi,
> >
> > this questions is not really about R but it  would be great if somebody 
could
> > point me to a forum or so where I can  get help with this.
> >
> > I only know a few basics about GIS and have  a problem with some UTM 
>coordinates
> > from a survey.
> > Coordinates  are given as, e.g.
> > 3258843     32780
> > which are supposedly zone  36N on system WGS84 (according to the 
>documentation).
> > If I convert it to  long/lat using gdal:
> >> require(rgdal)
> >> SP <-  SpatialPoints(cbind(X=3258843,  Y=32780),proj4string=CRS("+proj=utm
> >>+zone=36  +ellps=WGS84"))
> >> spTransform(SP, CRS("+proj=longlat +ellps=WGS84")) #  x1=longitude x2=lat
> > SpatialPoints:
> >           X         Y
> >  [1,] 57.0489 0.2706471
> > Coordinate Reference System (CRS) arguments:  +proj=longlat +ellps=WGS84
> >
> > The point should be close to Kampala  which has the coordinates 0.3?, 
>32.633333?
> > and UTM 36N 459199 33160 on  WGS84. My data's easting seems quite off.
> >
> > Has anybody an idea  what I am doing wrongly?
> >
> > Thanks so much,
> >   Werner
> >
> >
> >
> 
> 
> -- 
> Sarah Goslee
> http://www.functionaldiversity.org
> 




From ageel_bushara at yahoo.com  Wed Oct 13 16:17:21 2010
From: ageel_bushara at yahoo.com (Ageel Ibrahim Bushara)
Date: Wed, 13 Oct 2010 07:17:21 -0700 (PDT)
Subject: [R-sig-Geo] UTM problem
Message-ID: <246934.72619.qm@web35806.mail.mud.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101013/263a7786/attachment.pl>

From sarah.goslee at gmail.com  Wed Oct 13 16:24:50 2010
From: sarah.goslee at gmail.com (Sarah Goslee)
Date: Wed, 13 Oct 2010 10:24:50 -0400
Subject: [R-sig-Geo] UTM problem
In-Reply-To: <368367.3195.qm@web29501.mail.ird.yahoo.com>
References: <656339.67994.qm@web29517.mail.ird.yahoo.com>
	<AANLkTina0yC7W4GHmOa=PctoDSoie_MhXQ82m=r5VNpw@mail.gmail.com>
	<368367.3195.qm@web29501.mail.ird.yahoo.com>
Message-ID: <AANLkTimpeX-Fovv7MPyG60OeBp4T-ByqSF=w14RRs5dW@mail.gmail.com>

It looks like Uganda is mostly but not entirely in 36N. It's possible
the data switches zones, or that it keeps the same zone throughout
and uses northing and/or easting values outside the usual range.
Plotting the entire dataset as x, y coordinates would answer that
question very quickly.

Here's some more information:
http://commons.wikimedia.org/wiki/File:LA2-Africa-UTM-zones.png
http://en.wikipedia.org/wiki/Universal_Transverse_Mercator_coordinate_system

Sarah

On Wed, Oct 13, 2010 at 10:08 AM, Werner W. <pensterfuzzer at yahoo.de> wrote:
> Hi Sarah,
>
> many thanks for checking this. I looked at the documentation again and this is
> the info about the GPS receiver setting they used:
> POSITION FRMT: hddd.ddddd
> MAP DATUM: WGS 84
> CDI: +-0.25
> UNITS: METRIC
> HEADINGS: GRID E000
> DEGEES
>
>
> I'm not sure if this is any useful.
> Any idea what I should be looking for?
>
> The survey actually covers the whole of Uganda. Can it actually be that the
> entire country is UTM zone 36N or does the zone have to change? The docu
> suggests it is all 36N.
>
> Thanks again,
> ?Werner
>
>
>
>
> ----- Urspr?ngliche Mail ----
>> Von: Sarah Goslee <sarah.goslee at gmail.com>
>> An: Werner W. <pensterfuzzer at yahoo.de>
>> CC: r-sig-geo at stat.math.ethz.ch
>> Gesendet: Mittwoch, den 13. Oktober 2010, 14:48:50 Uhr
>> Betreff: Re: [R-sig-Geo] UTM problem
>>
>> Hi,
>>
>> I double-checked your results with an online conversion tool
>> (http://www.rcn.montana.edu/resources/tools/coordinates.aspx)
>> and got the ?same answer.
>>
>> That means that your R code is fine, and there's ?something
>> wrong with the original data. If possible, you should check ?with
>> the source. There could be a problem with the metadata, or
>> with the ?data themselves.
>>
>> Sarah
>>
>> On Wed, Oct 13, 2010 at 9:37 AM, Werner W. ?<pensterfuzzer at yahoo.de> ?wrote:
>> > Hi,
>> >
>> > this questions is not really about R but it ?would be great if somebody
> could
>> > point me to a forum or so where I can ?get help with this.
>> >
>> > I only know a few basics about GIS and have ?a problem with some UTM
>>coordinates
>> > from a survey.
>> > Coordinates ?are given as, e.g.
>> > 3258843 ? ? 32780
>> > which are supposedly zone ?36N on system WGS84 (according to the
>>documentation).
>> > If I convert it to ?long/lat using gdal:
>> >> require(rgdal)
>> >> SP <- ?SpatialPoints(cbind(X=3258843, ?Y=32780),proj4string=CRS("+proj=utm
>> >>+zone=36 ?+ellps=WGS84"))
>> >> spTransform(SP, CRS("+proj=longlat +ellps=WGS84")) # ?x1=longitude x2=lat
>> > SpatialPoints:
>> > ? ? ? ? ? X ? ? ? ? Y
>> > ?[1,] 57.0489 0.2706471
>> > Coordinate Reference System (CRS) arguments: ?+proj=longlat +ellps=WGS84
>> >
>> > The point should be close to Kampala ?which has the coordinates 0.3?,
>>32.633333?
>> > and UTM 36N 459199 33160 on ?WGS84. My data's easting seems quite off.
>> >
>> > Has anybody an idea ?what I am doing wrongly?
>> >
>> > Thanks so much,
>> > ? Werner
>> >
>> >

-- 
Sarah Goslee
http://www.functionaldiversity.org


From karl at huftis.org  Wed Oct 13 16:30:17 2010
From: karl at huftis.org (Karl Ove Hufthammer)
Date: Wed, 13 Oct 2010 16:30:17 +0200
Subject: [R-sig-Geo] Creating density heatmaps for geographical data
Message-ID: <i94fpq$356$1@dough.gmane.org>

Dear list members,

Does anybody have suggestions for the best way of creating density heatmaps 
for geographical data? With ?density heatmaps? I?m not thinking of heatmaps 
as in R?s ?heatmap? function, but more along the lines of

http://www.heatmapapi.com/
or
http://blog.spatialkey.com/2010/02/comparing-thematic-maps-with-density-
heatmaps/

(Yes, basically, it?s just a 2D density estimate overlain a map.)

I *have* managed to create an OK heatmap using ?sm.density? to get a density 
estimate, converting it a format ?levelplot? understands, plotting it with 
?levelplot?, with the ?panel? function set to include a ?sp.polygon? 
function to first draw a simple map before drawing the actual density with 
?panel.levelplot?.

I?m not entirely happy with this approach, though. First note that the main 
reason I use ?sm.density? instead of ?kde2d? is that ?sm.density? accepts a 
?weights? arguments. Since each of my observations contains frequency/weight 
information, I need this, and ?sm.density? seems to handle it well.

However, since the ?heatmap? is really a density estimate, it integrates to 
1. I would instead want the heatmap colours to correspond to real 
frequencies (of course, they do, but the actual mapping is not visible on 
the colour scale). It would also be nice if I could set the range used for 
the colour scale directly, so that maps created at different times would be 
comparable in terms of their visual appearance (e.g., dark red would always 
correspond to a value of 1000). Right now I use the bpy.colors palette, but 
other suggestions are very welcome.

Another problem is that ?sm.density? uses a Gaussian kernel. This means that 
my *entire* map is coloured, even areas far from any observations (and of 
course overlapping the background map). My solution to this is to change 
small values of the density estimate to NA values, but selecting the right 
threshold is a rather manual procedure, and a value that works for one 
density map may not work for a map for a different place, or at a different 
time. The best solution would be a function that used a kernel with finite 
support, so that any areas with a distance greater than the bandwidth from 
the nearest observation would be transparent (have NA values).

Also, any special issues I should be aware of since this is *geographical* 
data? I?m planning to use a UTM projection to avoid the problem with the 
length of longitudes varying with the latitude. My data cover a rather large 
area, so this is not a perfect solution, but should be good enough. (But if 
there are any functions that can calculate heatmaps taking into account the 
shape of the Earth, this would of course great).

So, any suggestions or experience with this type of plotting problem? 
Perhaps I?m missing something obvious? :)

-- 
Regards,
Karl Ove Hufthammer


From pensterfuzzer at yahoo.de  Wed Oct 13 17:14:42 2010
From: pensterfuzzer at yahoo.de (Werner W.)
Date: Wed, 13 Oct 2010 16:14:42 +0100 (BST)
Subject: [R-sig-Geo] UTM problem
In-Reply-To: <AANLkTimpeX-Fovv7MPyG60OeBp4T-ByqSF=w14RRs5dW@mail.gmail.com>
References: <656339.67994.qm@web29517.mail.ird.yahoo.com>
	<AANLkTina0yC7W4GHmOa=PctoDSoie_MhXQ82m=r5VNpw@mail.gmail.com>
	<368367.3195.qm@web29501.mail.ird.yahoo.com>
	<AANLkTimpeX-Fovv7MPyG60OeBp4T-ByqSF=w14RRs5dW@mail.gmail.com>
Message-ID: <290699.47025.qm@web29508.mail.ird.yahoo.com>

Many thanks for your replies Ageel and Sarah!
I still have no clue what to do with the data to make it usable. 
The northings are in the range of 26237 to 38149 which seem to make sense but 
the eastings are in the range of 3252446 to 3264111 and these don't seem to be 
in Uganda.
If I use one of these converters, I even get an error message that this data is 
not within a given range.
http://geographiclib.sourceforge.net/cgi-bin/GeoConvert?input=29437+3254314&zone=36&prec=0&option=Submit


It is really weird.


Thanks,
  Werner


----- Urspr?ngliche Mail ----
> Von: Sarah Goslee <sarah.goslee at gmail.com>
> An: Werner W. <pensterfuzzer at yahoo.de>
> CC: r-sig-geo at stat.math.ethz.ch
> Gesendet: Mittwoch, den 13. Oktober 2010, 15:24:50 Uhr
> Betreff: Re: [R-sig-Geo] UTM problem
> 
> It looks like Uganda is mostly but not entirely in 36N. It's possible
> the  data switches zones, or that it keeps the same zone throughout
> and uses  northing and/or easting values outside the usual range.
> Plotting the entire  dataset as x, y coordinates would answer that
> question very  quickly.
> 
> Here's some more information:
> http://commons.wikimedia.org/wiki/File:LA2-Africa-UTM-zones.png
> http://en.wikipedia.org/wiki/Universal_Transverse_Mercator_coordinate_system
> 
> Sarah
> 
> On  Wed, Oct 13, 2010 at 10:08 AM, Werner W. <pensterfuzzer at yahoo.de>  wrote:
> > Hi Sarah,
> >
> > many thanks for checking this. I looked  at the documentation again and this 
>is
> > the info about the GPS receiver  setting they used:
> > POSITION FRMT: hddd.ddddd
> > MAP DATUM: WGS  84
> > CDI: +-0.25
> > UNITS: METRIC
> > HEADINGS: GRID E000
> >  DEGEES
> >
> >
> > I'm not sure if this is any useful.
> > Any  idea what I should be looking for?
> >
> > The survey actually covers  the whole of Uganda. Can it actually be that the
> > entire country is UTM  zone 36N or does the zone have to change? The docu
> > suggests it is all  36N.
> >
> > Thanks again,
> >   Werner
> >
> >
> >
> >
> > ----- Urspr?ngliche Mail  ----
> >> Von: Sarah Goslee <sarah.goslee at gmail.com>
> >>  An: Werner W. <pensterfuzzer at yahoo.de>
> >>  CC: r-sig-geo at stat.math.ethz.ch
> >>  Gesendet: Mittwoch, den 13. Oktober 2010, 14:48:50 Uhr
> >> Betreff: Re:  [R-sig-Geo] UTM problem
> >>
> >> Hi,
> >>
> >> I  double-checked your results with an online conversion tool
> >> (http://www.rcn.montana.edu/resources/tools/coordinates.aspx)
> >>  and got the  same answer.
> >>
> >> That means that your R code is  fine, and there's  something
> >> wrong with the original data. If  possible, you should check  with
> >> the source. There could be a  problem with the metadata, or
> >> with the  data  themselves.
> >>
> >> Sarah
> >>
> >> On Wed, Oct  13, 2010 at 9:37 AM, Werner W.  <pensterfuzzer at yahoo.de>  
> wrote:
> >> > Hi,
> >> >
> >> > this questions is  not really about R but it  would be great if somebody
> > could
> >>  > point me to a forum or so where I can  get help with this.
> >>  >
> >> > I only know a few basics about GIS and have  a problem  with some UTM
> >>coordinates
> >> > from a survey.
> >>  > Coordinates  are given as, e.g.
> >> > 3258843      32780
> >> > which are supposedly zone  36N on system WGS84 (according  to the
> >>documentation).
> >> > If I convert it to  long/lat  using gdal:
> >> >> require(rgdal)
> >> >> SP <-   SpatialPoints(cbind(X=3258843, 
> Y=32780),proj4string=CRS("+proj=utm
> >>  >>+zone=36  +ellps=WGS84"))
> >> >> spTransform(SP,  CRS("+proj=longlat +ellps=WGS84")) #  x1=longitude 
>x2=lat
> >> >  SpatialPoints:
> >> >           X         Y
> >> >  [1,]  57.0489 0.2706471
> >> > Coordinate Reference System (CRS) arguments:   +proj=longlat +ellps=WGS84
> >> >
> >> > The point should  be close to Kampala  which has the coordinates  0.3?,
> >>32.633333?
> >> > and UTM 36N 459199 33160 on  WGS84.  My data's easting seems quite off.
> >> >
> >> > Has anybody  an idea  what I am doing wrongly?
> >> >
> >> > Thanks so  much,
> >> >   Werner
> >> >
> >> >
> 
> -- 
> Sarah Goslee
> http://www.functionaldiversity.org
> 




From b.rowlingson at lancaster.ac.uk  Wed Oct 13 17:23:48 2010
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed, 13 Oct 2010 16:23:48 +0100
Subject: [R-sig-Geo] UTM problem
In-Reply-To: <290699.47025.qm@web29508.mail.ird.yahoo.com>
References: <656339.67994.qm@web29517.mail.ird.yahoo.com>
	<AANLkTina0yC7W4GHmOa=PctoDSoie_MhXQ82m=r5VNpw@mail.gmail.com>
	<368367.3195.qm@web29501.mail.ird.yahoo.com>
	<AANLkTimpeX-Fovv7MPyG60OeBp4T-ByqSF=w14RRs5dW@mail.gmail.com>
	<290699.47025.qm@web29508.mail.ird.yahoo.com>
Message-ID: <AANLkTimP1T7g+jebUho3eYq=4GODT3f=tpLX75HrT9Jh@mail.gmail.com>

On Wed, Oct 13, 2010 at 4:14 PM, Werner W. <pensterfuzzer at yahoo.de> wrote:

"""
>Coordinates are given as, e.g.
3258843     32780
which are supposedly zone 36N on system WGS84 (according to the documentation).

The point should be close to Kampala which has the coordinates 0.3?, 32.633333?
and UTM 36N 459199 33160 on WGS84. My data's easting seems quite off.

 """

 Are you sure they are UTM zone coords? Not just plain degrees in EPSG4326?

Maybe your 3258843 is Kampala's 32.633  (32.58843 with no decimal) and
the 32780 is 0.3 (0.32780 with no leading zero or decimal)?

Just a thought.

Barry


From thi_veloso at yahoo.com.br  Wed Oct 13 18:27:18 2010
From: thi_veloso at yahoo.com.br (Thiago Veloso)
Date: Wed, 13 Oct 2010 09:27:18 -0700 (PDT)
Subject: [R-sig-Geo] reading .grd file in R?
Message-ID: <46332.24729.qm@web54302.mail.re2.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101013/d868bafe/attachment.pl>

From kmcoulib at gmail.com  Wed Oct 13 21:32:14 2010
From: kmcoulib at gmail.com (kapo coulibaly)
Date: Wed, 13 Oct 2010 15:32:14 -0400
Subject: [R-sig-Geo] DBF file size
Message-ID: <AANLkTinFjJfyR1iK2CHN24yu=CPpza8RJhGYdQy89vSN@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101013/69a84367/attachment.pl>

From a.mosnier at gmail.com  Wed Oct 13 21:34:31 2010
From: a.mosnier at gmail.com (Arnaud Mosnier)
Date: Wed, 13 Oct 2010 15:34:31 -0400
Subject: [R-sig-Geo] Convert asc grid to points
Message-ID: <AANLkTi=eeYWPV48X3X_H2cgrA2OVeb8ATL_SMAM1-oCp@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101013/876f457d/attachment.pl>

From tech_dev at wildintellect.com  Wed Oct 13 22:11:49 2010
From: tech_dev at wildintellect.com (Alex Mandel)
Date: Wed, 13 Oct 2010 13:11:49 -0700
Subject: [R-sig-Geo] DBF file size
In-Reply-To: <AANLkTinFjJfyR1iK2CHN24yu=CPpza8RJhGYdQy89vSN@mail.gmail.com>
References: <AANLkTinFjJfyR1iK2CHN24yu=CPpza8RJhGYdQy89vSN@mail.gmail.com>
Message-ID: <4CB61285.7050205@wildintellect.com>

On 10/13/2010 12:32 PM, kapo coulibaly wrote:
> I imported a DBF with more than 256 columns using read.dbf. But when i write
> it back out with write.dbf, only the first 256 columns are written out. Is
> there a way to export dbf files with more columns. (I actually need about
> 1200 columns)
> 
> thanks
> 
> 	[[alternative HTML version deleted]]
> 

Nope, that is a limitation of the dbf format. Depending on your usage of
the output file it would be best to choose another format. Are you
exporting a spatial file or just a data table? What end program do you
need to be able to pull the created file into?

Thanks,
Alex


From kmcoulib at gmail.com  Wed Oct 13 22:20:23 2010
From: kmcoulib at gmail.com (kapo coulibaly)
Date: Wed, 13 Oct 2010 16:20:23 -0400
Subject: [R-sig-Geo] DBF file size
In-Reply-To: <4CB61285.7050205@wildintellect.com>
References: <AANLkTinFjJfyR1iK2CHN24yu=CPpza8RJhGYdQy89vSN@mail.gmail.com>
	<4CB61285.7050205@wildintellect.com>
Message-ID: <AANLkTikgTcetx-3Q3kD-dPiDOLbyWWisGkh3vEgRT0km@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101013/801a6fcd/attachment.pl>

From govindas at msu.edu  Thu Oct 14 03:36:12 2010
From: govindas at msu.edu (govindas at msu.edu)
Date: Wed, 13 Oct 2010 21:36:12 -0400
Subject: [R-sig-Geo] legend does not appear in all cases in a plot?
Message-ID: <20101013213612.10885dx607v7zyx8@mail.msu.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101013/2546758b/attachment.pl>

From edzer.pebesma at uni-muenster.de  Thu Oct 14 08:15:58 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 14 Oct 2010 08:15:58 +0200
Subject: [R-sig-Geo] legend does not appear in all cases in a plot?
In-Reply-To: <20101013213612.10885dx607v7zyx8@mail.msu.edu>
References: <20101013213612.10885dx607v7zyx8@mail.msu.edu>
Message-ID: <4CB6A01E.7050805@uni-muenster.de>

The x and y ranges of your plot depend on your data, but the (first)
legend command hard codes coordinate values (-2, 0.5). These coordinate
values may not be near enough to you data values to see it.

On 10/14/2010 03:36 AM, govindas at msu.edu wrote:
> 
> 
> Hello all,
> 
> Here I am with a plot issue - when I try to add legend it does not work at all times. Can someone tell me what's wrong with my code?
> 
> the following legend does not work!
> 
> plot(ts(tot_avg1[,1], freq=12, start=c(1981,12), end=c(2009,12)), ylim=c(min(tot_avg1[,1]), max(tot_avg1[,3])),
> xlab="Time", ylab="SST (deg Celcius)", lty=2, col=2)      #red
> lines(ts(tot_avg1[,2], freq=12, start=c(1981,12), end=c(2009,12)))   #black
> lines(ts(tot_avg1[,3], freq=12, start=c(1981,12), end=c(2009,12)), lty=3, col=4) #blue
> legend(-2, 0.5, c("Min", "Mean", "Max"), col=c(2,1,4), lty=c(2,1,3))
>  
> 
> but, if i specify the position in words, like the one given below, it works!
> legend("topright", c("Min", "Mean", "Max"), col=c(2,1,4), lty=c(2,1,3))
> 
> is there something i am missing here? 
> 
> Thanks,
> Mahalakshmi
> 	[[alternative HTML version deleted]]
> 
> 
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From kvormoor at uni-bonn.de  Thu Oct 14 09:11:31 2010
From: kvormoor at uni-bonn.de (Klaus Vormoor)
Date: Thu, 14 Oct 2010 00:11:31 -0700 (PDT)
Subject: [R-sig-Geo] problem with the sp.layout command
Message-ID: <1287040291731-5633972.post@n2.nabble.com>


Dear list,

I try to produce a map by sp.plot showing runoff forecasts along a river
network. Additionally to the river network (lines), I want to plot a coast
line (lines) and lakes (polygons) by using the sp.layout command. The
drawing order should be the following: 1. rivers, 2. coast line, 3. lakes.
To avoid the pre-defined drawing order of sp.plot, i used first = FALSE
within the sp.layout command as it was suggested once earlier in this forum.
But no matter where i place first = FLASE, the drawing order do not change.

This is the plotting command i use:
 
spplot(rivers, "Q_forecast", col.regions=col.key,
  sp.layout=list(list("sp.lines","coast"),
list("sp.polygons","lakes",col="lightblue",fill="lightblue"), first=FALSE),
  xlim=c(-77506.04,318494), ylim=c(6429304,6900000)

Does anyone see whats wrong or have a alternative suggestion to solve this
problem?

Thanks in advance!

Klaus


-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/problem-with-the-sp-layout-command-tp5633972p5633972.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From karl at huftis.org  Thu Oct 14 14:56:46 2010
From: karl at huftis.org (Karl Ove Hufthammer)
Date: Thu, 14 Oct 2010 14:56:46 +0200
Subject: [R-sig-Geo] Creating density heatmaps for geographical data
References: <i94fpq$356$1@dough.gmane.org>
Message-ID: <i96umf$ama$1@dough.gmane.org>

Karl Ove Hufthammer wrote:

> However, since the ?heatmap? is really a density estimate, it integrates
> to 1. I would instead want the heatmap colours to correspond to real
> frequencies (of course, they do, but the actual mapping is not visible on
> the colour scale).

I have been thinking a bit more on this, and what I really need is having 
the value at a point correspond to the *sum* of the weights close to the 
points (e.g., in a 1 km radius).

An example:

x=c(.2, .25, .8)
y=c(.75, .7, .2)

If all the points have unit weight, the output value at the two points at 
the top-left corner should be 2, and the value at the bottom right corner 
should be 1. If we have weights

w=c(10, 10, 20)

the output value should be 20 near both point clusters, 10 in areas only 
close to *one* of the points in the top-left clusters, and 0 everywhere 
else.

A couple of real-life examples:

1. The weights being housing prices, and the output being the money earned
   by selling all the houses in an area (a circle centred at the output
   point).
2. The weights being the quantity (number or weight) of fish caught at
   different locations, and the output being the total amount caught in
   an area.

I could of course set up a grid for this, and simply calculate the sum of 
weights in each grid cell, but I would prefer using distance from the centre 
of each cell to select which observations to count. And using some sort of 
kernel smoothing sounds like a good idea, at least in theory. But the (lack 
of) a normalizing constant makes the solution non-obvious (for me). And 
computational issues when there are many observations may of course also be 
a problem. I feel there must already be an R function/package written for 
just this type of calculation. :)

So, any ideas?

-- 
Karl Ove Hufthammer


From lestes at princeton.edu  Thu Oct 14 15:11:16 2010
From: lestes at princeton.edu (Lyndon Estes)
Date: Thu, 14 Oct 2010 09:11:16 -0400
Subject: [R-sig-Geo] problem with the sp.layout command
In-Reply-To: <1287040291731-5633972.post@n2.nabble.com>
References: <1287040291731-5633972.post@n2.nabble.com>
Message-ID: <AANLkTikBufwxq4rtOj0n2=DuAkAO2Xfw_tzCy4Ja7AmQ@mail.gmail.com>

Hi Klaus,

I recently wrote about the same problem, which Edzer has fixed with an
sp package update:

http://r-sig-geo.2731867.n2.nabble.com/spplot-1-filling-background-polygon-without-overwriting-foreground-polygon-2-left-justifying-sp-layot-td5615087.html#a5615087

Cheers, Lyndon

On Thu, Oct 14, 2010 at 3:11 AM, Klaus Vormoor <kvormoor at uni-bonn.de> wrote:
>
> Dear list,
>
> I try to produce a map by sp.plot showing runoff forecasts along a river
> network. Additionally to the river network (lines), I want to plot a coast
> line (lines) and lakes (polygons) by using the sp.layout command. The
> drawing order should be the following: 1. rivers, 2. coast line, 3. lakes.
> To avoid the pre-defined drawing order of sp.plot, i used first = FALSE
> within the sp.layout command as it was suggested once earlier in this forum.
> But no matter where i place first = FLASE, the drawing order do not change.
>
> This is the plotting command i use:
>
> spplot(rivers, "Q_forecast", col.regions=col.key,
> ?sp.layout=list(list("sp.lines","coast"),
> list("sp.polygons","lakes",col="lightblue",fill="lightblue"), first=FALSE),
> ?xlim=c(-77506.04,318494), ylim=c(6429304,6900000)
>
> Does anyone see whats wrong or have a alternative suggestion to solve this
> problem?
>
> Thanks in advance!
>
> Klaus
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/problem-with-the-sp-layout-command-tp5633972p5633972.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Lyndon Estes
Research Associate
Woodrow Wilson School
Princeton University
+1-609-258-2392 (o)
+1-609-258-6082 (f)
+1-202-431-0496 (m)
lestes at princeton.edu


From seanpor at acm.org  Thu Oct 14 15:12:43 2010
From: seanpor at acm.org (Sean O'Riordain)
Date: Thu, 14 Oct 2010 14:12:43 +0100
Subject: [R-sig-Geo] Creating density heatmaps for geographical data
In-Reply-To: <i96umf$ama$1@dough.gmane.org>
References: <i94fpq$356$1@dough.gmane.org>
	<i96umf$ama$1@dough.gmane.org>
Message-ID: <AANLkTin5+QSUKyDNxe+vrrswkRSR5kQQXqojMPe5WRHT@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101014/cd436ee4/attachment.pl>

From mdsumner at gmail.com  Thu Oct 14 15:16:26 2010
From: mdsumner at gmail.com (Michael Sumner)
Date: Fri, 15 Oct 2010 00:16:26 +1100
Subject: [R-sig-Geo] Creating density heatmaps for geographical data
In-Reply-To: <i94fpq$356$1@dough.gmane.org>
References: <i94fpq$356$1@dough.gmane.org>
Message-ID: <AANLkTi=h=+QWsuOb0EjnkHT1raFsGV3kv9P7Ns2Hf_ZN@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101015/33cd7a02/attachment.pl>

From lestes at princeton.edu  Thu Oct 14 15:11:16 2010
From: lestes at princeton.edu (Lyndon Estes)
Date: Thu, 14 Oct 2010 09:11:16 -0400
Subject: [R-sig-Geo] problem with the sp.layout command
In-Reply-To: <1287040291731-5633972.post@n2.nabble.com>
References: <1287040291731-5633972.post@n2.nabble.com>
Message-ID: <AANLkTikBufwxq4rtOj0n2=DuAkAO2Xfw_tzCy4Ja7AmQ@mail.gmail.com>

Hi Klaus,

I recently wrote about the same problem, which Edzer has fixed with an
sp package update:

http://r-sig-geo.2731867.n2.nabble.com/spplot-1-filling-background-polygon-without-overwriting-foreground-polygon-2-left-justifying-sp-layot-td5615087.html#a5615087

Cheers, Lyndon

On Thu, Oct 14, 2010 at 3:11 AM, Klaus Vormoor <kvormoor at uni-bonn.de> wrote:
>
> Dear list,
>
> I try to produce a map by sp.plot showing runoff forecasts along a river
> network. Additionally to the river network (lines), I want to plot a coast
> line (lines) and lakes (polygons) by using the sp.layout command. The
> drawing order should be the following: 1. rivers, 2. coast line, 3. lakes.
> To avoid the pre-defined drawing order of sp.plot, i used first = FALSE
> within the sp.layout command as it was suggested once earlier in this forum.
> But no matter where i place first = FLASE, the drawing order do not change.
>
> This is the plotting command i use:
>
> spplot(rivers, "Q_forecast", col.regions=col.key,
> ?sp.layout=list(list("sp.lines","coast"),
> list("sp.polygons","lakes",col="lightblue",fill="lightblue"), first=FALSE),
> ?xlim=c(-77506.04,318494), ylim=c(6429304,6900000)
>
> Does anyone see whats wrong or have a alternative suggestion to solve this
> problem?
>
> Thanks in advance!
>
> Klaus
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/problem-with-the-sp-layout-command-tp5633972p5633972.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Lyndon Estes
Research Associate
Woodrow Wilson School
Princeton University
+1-609-258-2392 (o)
+1-609-258-6082 (f)
+1-202-431-0496 (m)
lestes at princeton.edu


From b.rowlingson at lancaster.ac.uk  Thu Oct 14 15:37:58 2010
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Thu, 14 Oct 2010 14:37:58 +0100
Subject: [R-sig-Geo] DBF file size
In-Reply-To: <AANLkTikgTcetx-3Q3kD-dPiDOLbyWWisGkh3vEgRT0km@mail.gmail.com>
References: <AANLkTinFjJfyR1iK2CHN24yu=CPpza8RJhGYdQy89vSN@mail.gmail.com>
	<4CB61285.7050205@wildintellect.com>
	<AANLkTikgTcetx-3Q3kD-dPiDOLbyWWisGkh3vEgRT0km@mail.gmail.com>
Message-ID: <AANLkTi=TY47OG9oLfV9uNHW-Ct=417ipART2t40105Jt@mail.gmail.com>

On Wed, Oct 13, 2010 at 9:20 PM, kapo coulibaly <kmcoulib at gmail.com> wrote:
> I'm doing Groundwater Modeling and that is the appropriate input format for
> the GUI I'm using (Groundwater vistas) for what I'm trying to do. Funny
> enough I was able to create a dbf with 512 columns in ArcGIS but as I said I
> needed more.
>

 write.dbf from package 'foreign' can write bigger dbfs than 512 columns.

 > d=as.data.frame(t(1:1200))
 > dim(d)
 [1]    1 1200
 > d=rbind(d,d+1)
 > d=rbind(d,d+10)
 > dim(d)
 [1]    4 1200
 > write.dbf(d,"big.dbf")

 - thats now a 1200 column x 4 row dbf file.

 Reading it back with read.dbf in R gets the data back fine, but
OpenOffice stops at 1024 columns and gives an error message about too
many *rows*!

Barry


From govindas at msu.edu  Thu Oct 14 16:13:52 2010
From: govindas at msu.edu (govindas at msu.edu)
Date: Thu, 14 Oct 2010 10:13:52 -0400
Subject: [R-sig-Geo] reading .grd file in R?
In-Reply-To: <46332.24729.qm@web54302.mail.re2.yahoo.com>
References: <46332.24729.qm@web54302.mail.re2.yahoo.com>
Message-ID: <20101014101352.38154x9ira3ffh9c@mail.msu.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101014/0ba09e03/attachment.pl>

From aparenti at ec.unipi.it  Thu Oct 14 16:14:49 2010
From: aparenti at ec.unipi.it (Angela Parenti)
Date: Thu, 14 Oct 2010 16:14:49 +0200
Subject: [R-sig-Geo] How to build a spatial weights list for pooled data
Message-ID: <4CB71059.20805@ec.unipi.it>


Hello Roger and everybody else.

I have another question about Weight Matrices. For one of my models I 
estimate a pooled regression. Then, in order run the Moran test on the 
pooled regression residuals I need to construct a spatial weights list 
of the same dimension.
I already found the way for the spatial matrix built on the inverse 
distance between neighbours. Here the code for inverse distance matrix:

#####################
# Moran's Test for spatial effects
sampleCentroid.Pooled <- 
rbind(samplecentroid.europeReorderedCamEcon,samplecentroid.europeReorderedCamEcon)
eu.regions.nb_pooled <- dnearneigh(sampleCentroid.Pooled[iii,], 0, 
max(distanceMatrix), row.names=NULL, longlat=TRUE)
coords_pooled <- sampleCentroid.Pooled[iii,]
dlist_pooled <- nbdists(eu.regions.nb_pooled, coords_pooled, longlat=TRUE)

dlist1_pooled <- lapply(dlist_pooled, function(x) 1/(x^2))
eu.regions.w1_pooled <- nb2listw(eu.regions.nb_pooled, 
glist=dlist1_pooled, style="W", zero.policy=TRUE)

moranTestmodelI_w1 <- lm.morantest(modelI, 
eu.regions.w1_pooled,zero.policy=TRUE, alternative="two.sided")
print(rbind(c("Global Moran's I for Model I","w1_EK","bivand",""),
            c("Observed Moran's I", "EI", "VI", "p-value"),
            
c(as.numeric(moranTestmodelI_w1$estimate[1]),as.numeric(moranTestmodelI_w1$estimate[2]),
            
as.numeric(moranTestmodelI_w1$estimate[3]),moranTestmodelI_w1$p.value)
            ))
######################

Differently, I didn't understand yet how to build a spatial weights list 
for pooled data in case of first-order contiguity matrix. Can you help me?

Thank you in advance,
Angela Parenti


From karl at huftis.org  Thu Oct 14 16:23:58 2010
From: karl at huftis.org (Karl Ove Hufthammer)
Date: Thu, 14 Oct 2010 16:23:58 +0200
Subject: [R-sig-Geo] Rgshhs for getting maps around longitude 0
Message-ID: <i973pv$3vj$1@dough.gmane.org>

Dear list members

The GSHHS map data uses longitudes from 0 to 360, which causes problems 
fetching maps around longitude 0. Example:

library(maptools)
gpclibPermit()
gshhs.c.b <- system.file("share/gshhs_c.b", package="maptools")
xl=c(-30,30)
yl=c(50,80)
rmap=Rgshhs(gshhs.c.b, xlim=xl, ylim=yl)
plot(rmap$SP)

There are no error messages, but some countries are just missing, e.g., 
Ireland, Iceland and Greenland. To get a map containing them, we have to use 
xlim=c(330,360). But what if we want to have both countries to the east and 
to the west of long = 0 on the same map (i.e., SpatialPolygons)?

Rgshhs takes a ?shift? argument, but this only changes the *output* 
coordinates from 0,360 to -180,180; it doesn?t change the accepted input 
variables.

Is it necessary to fetch the map twice? If so, which xlim values should be 
used, and how should the two maps be merged into one SpatialPolygons? Note 
that if I change ?xlim? to c(0,30), Great Britain is missing ... :-(

-- 
Karl Ove Hufthammer


From karl at huftis.org  Thu Oct 14 16:42:51 2010
From: karl at huftis.org (Karl Ove Hufthammer)
Date: Thu, 14 Oct 2010 16:42:51 +0200
Subject: [R-sig-Geo] Creating density heatmaps for geographical data
References: <i94fpq$356$1@dough.gmane.org> <i96umf$ama$1@dough.gmane.org>
	<AANLkTin5+QSUKyDNxe+vrrswkRSR5kQQXqojMPe5WRHT@mail.gmail.com>
Message-ID: <i974tc$9g7$1@dough.gmane.org>

Sean O'Riordain wrote:

> Thank you for that - some interesting ideas there.  While not a solution
> for you - I'm working on a similar problem and I've discovered
> mapserver(.org) for the display side of things.  It will handle rasters
> and shape files and display them quickly on a google map background.

Thanks for your ideas. My main worry about different projections is the 
statistical part, not the visualisation part. For example, an area with 
width w and height h in one projection (or as unprojected values) won?t 
have an actual area of (an constant times) w ? h, and the actual area
varies with the latitude.

Using a UTM transformation *before* calculating anything mostly solves this 
problem. And having the same projection for the calculations and end map is 
also a good idea, since the reprojected data may be confusing (for example, 
why are the square grid now curved?).

Fortunately, the spTransform function makes reprojection of data in R very 
easy. The only problem I?ve had is with reprojections of actual maps (the 
output of the map function). Depending on the bounding box, I get a bunch of 
?transformed point not finite?, and the projection fails. It?s not a very 
strange thing to happen, but very annoying.

The reason I get such problems, is that the unprojected map that I work with 
must have a (sometimes much) bigger bounding box than the area I?m actually 
interested in, since the projected first coordinate of the lower left corner 
of the unprojected bounding box is not equal to the projected first 
coordinate of the upper left corner of this bounding box. So to ensure that 
no countries/polygons go missing, you have to enlarge the bounding box, 
which may include areas so far north that the projection / spTransform can?t 
handle them (even though these areas wouldn?t be used on the final map.
I haven?t found a solution for this yet. :/

-- 
Karl Ove Hufthammer


From mspinola10 at gmail.com  Thu Oct 14 17:16:23 2010
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Thu, 14 Oct 2010 09:16:23 -0600
Subject: [R-sig-Geo] Clip a raster
Message-ID: <4CB71EC7.8030403@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101014/fee1711b/attachment.pl>

From r.macdonald at cranfield.ac.uk  Thu Oct 14 17:26:58 2010
From: r.macdonald at cranfield.ac.uk (Macdonald, Robert)
Date: Thu, 14 Oct 2010 16:26:58 +0100
Subject: [R-sig-Geo] Requesting Jenks natural breaks implementation in R or
	Statistica
Message-ID: <6E3C09D338C1BB46AD3778BB99012D6005E7BBF016@CCEXCHSTORE-2.central.cranfield.ac.uk>

Dear r-sig-geo,

I have data distributions (particle size distributions) and I have been advised to separate parts of the distributions using jenks natural breaks procedure. I am seeking a macro written directly for Statistica that can implement this, or else I am seeking Jenks natural breaks coded in R and an idiots guide to implementing that in Statistica.

All help greatfully received!

Thanks for your time,
Robert


From j.m.signer at gmail.com  Thu Oct 14 17:39:28 2010
From: j.m.signer at gmail.com (Johannes Signer)
Date: Thu, 14 Oct 2010 17:39:28 +0200
Subject: [R-sig-Geo] Clip a raster
In-Reply-To: <4CB71EC7.8030403@gmail.com>
References: <4CB71EC7.8030403@gmail.com>
Message-ID: <AANLkTim3ZObrTb7SzaYnD0y43bdXFfC4Y-xNFEGpq7u4@mail.gmail.com>

Hi,

with the raster package you could use: polygons to raster
(?polygonsToRaster), converting the Costa Rica shapefile to a raster
and then use mask (?mask).

Best
Johannes

On Thu, Oct 14, 2010 at 5:16 PM, Manuel Sp?nola <mspinola10 at gmail.com> wrote:
> ?Dear list members,
>
> I download bioclim data in a raster format (estension: .bil) and I would
> like to clip the variables to a ploygon stored as a shapefile (Costa
> Rica outline).
> How can I do that?
>
> I read the raster file like this:
>
> x <- readGDAL("bio1_23.bil")
>
> Thank you very much in advance.
> Best,
>
> Manuel
>
>
> --
> *Manuel Sp?nola, Ph.D.*
> Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
> Universidad Nacional
> Apartado 1350-3000
> Heredia
> COSTA RICA
> mspinola at una.ac.cr
> mspinola10 at gmail.com
> Tel?fono: (506) 2277-3598
> Fax: (506) 2237-7036
> Personal website: Lobito de r?o
> <https://sites.google.com/site/lobitoderio/>
> Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


From seanpor at acm.org  Thu Oct 14 17:53:48 2010
From: seanpor at acm.org (Sean O'Riordain)
Date: Thu, 14 Oct 2010 16:53:48 +0100
Subject: [R-sig-Geo] Requesting Jenks natural breaks implementation in R
 or Statistica
In-Reply-To: <6E3C09D338C1BB46AD3778BB99012D6005E7BBF016@CCEXCHSTORE-2.central.cranfield.ac.uk>
References: <6E3C09D338C1BB46AD3778BB99012D6005E7BBF016@CCEXCHSTORE-2.central.cranfield.ac.uk>
Message-ID: <AANLkTi=0M5xu=EzAbouqvoAQVOQO5YpwbZzNSa+Csg_-@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101014/b177c1a7/attachment.pl>

From tech_dev at wildintellect.com  Thu Oct 14 18:02:53 2010
From: tech_dev at wildintellect.com (Alex Mandel)
Date: Thu, 14 Oct 2010 09:02:53 -0700
Subject: [R-sig-Geo] DBF file size
In-Reply-To: <AANLkTikgTcetx-3Q3kD-dPiDOLbyWWisGkh3vEgRT0km@mail.gmail.com>
References: <AANLkTinFjJfyR1iK2CHN24yu=CPpza8RJhGYdQy89vSN@mail.gmail.com>	<4CB61285.7050205@wildintellect.com>
	<AANLkTikgTcetx-3Q3kD-dPiDOLbyWWisGkh3vEgRT0km@mail.gmail.com>
Message-ID: <4CB729AD.4010601@wildintellect.com>

Oh right I was thinking about max number of characters in a text field.
It's possibly that the limit is based on the maximum number of bytes
that can be used to hold one record. So the number of Columns would vary
with how much data is actually in them.
http://www.dbase.com/KnowledgeBase/int/db7_file_fmt.htm

Might be worthwhile to ask the creator of your Groundwater app if it's
possible to use other formats.

Also check on the R-sig-db email list, maybe there's a compile time
option to tweak the max columns on write.dbf

Alex

On 10/13/2010 01:20 PM, kapo coulibaly wrote:
> I'm doing Groundwater Modeling and that is the appropriate input format for
> the GUI I'm using (Groundwater vistas) for what I'm trying to do. Funny
> enough I was able to create a dbf with 512 columns in ArcGIS but as I said I
> needed more.
> 
> Thanks
> 
> On Wed, Oct 13, 2010 at 4:11 PM, Alex Mandel <tech_dev at wildintellect.com>wrote:
> 
>> On 10/13/2010 12:32 PM, kapo coulibaly wrote:
>>> I imported a DBF with more than 256 columns using read.dbf. But when i
>> write
>>> it back out with write.dbf, only the first 256 columns are written out.
>> Is
>>> there a way to export dbf files with more columns. (I actually need about
>>> 1200 columns)
>>>
>>> thanks
>>>
>>>       [[alternative HTML version deleted]]
>>>
>>
>> Nope, that is a limitation of the dbf format. Depending on your usage of
>> the output file it would be best to choose another format. Are you
>> exporting a spatial file or just a data table? What end program do you
>> need to be able to pull the created file into?
>>
>> Thanks,
>> Alex
>>
>> 
>


From r.hijmans at gmail.com  Thu Oct 14 18:21:51 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 14 Oct 2010 09:21:51 -0700
Subject: [R-sig-Geo] Clip a raster
In-Reply-To: <4CB71EC7.8030403@gmail.com>
References: <4CB71EC7.8030403@gmail.com>
Message-ID: <AANLkTi=XG_P3BwNWY4ZHvgK=0rCcMvQrw6NmvC5egkcp@mail.gmail.com>

Manuel,

if "costarica" is a SpatialPolygons* object, you can do:

r <- raster("bio1_23.bil")
cr <- crop(r, costarica)

Robert

On Thu, Oct 14, 2010 at 8:16 AM, Manuel Sp?nola <mspinola10 at gmail.com> wrote:
> ?Dear list members,
>
> I download bioclim data in a raster format (estension: .bil) and I would
> like to clip the variables to a ploygon stored as a shapefile (Costa
> Rica outline).
> How can I do that?
>
> I read the raster file like this:
>
> x <- readGDAL("bio1_23.bil")
>
> Thank you very much in advance.
> Best,
>
> Manuel
>
>
> --
> *Manuel Sp?nola, Ph.D.*
> Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
> Universidad Nacional
> Apartado 1350-3000
> Heredia
> COSTA RICA
> mspinola at una.ac.cr
> mspinola10 at gmail.com
> Tel?fono: (506) 2277-3598
> Fax: (506) 2237-7036
> Personal website: Lobito de r?o
> <https://sites.google.com/site/lobitoderio/>
> Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


From mspinola10 at gmail.com  Thu Oct 14 18:27:36 2010
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Thu, 14 Oct 2010 10:27:36 -0600
Subject: [R-sig-Geo] Clip a raster
In-Reply-To: <AANLkTik2euijzKFrJFK7ctCsk+CVHLViChoo55g6KUqP@mail.gmail.com>
References: <4CB71EC7.8030403@gmail.com>
	<AANLkTik2euijzKFrJFK7ctCsk+CVHLViChoo55g6KUqP@mail.gmail.com>
Message-ID: <4CB72F78.1080908@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101014/e048da0c/attachment.pl>

From mspinola10 at gmail.com  Thu Oct 14 18:42:40 2010
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Thu, 14 Oct 2010 10:42:40 -0600
Subject: [R-sig-Geo] Clip a raster
In-Reply-To: <AANLkTi=XG_P3BwNWY4ZHvgK=0rCcMvQrw6NmvC5egkcp@mail.gmail.com>
References: <4CB71EC7.8030403@gmail.com>
	<AANLkTi=XG_P3BwNWY4ZHvgK=0rCcMvQrw6NmvC5egkcp@mail.gmail.com>
Message-ID: <4CB73300.5000209@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101014/d8aed6bb/attachment.pl>

From r.turner at auckland.ac.nz  Thu Oct 14 21:24:37 2010
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Fri, 15 Oct 2010 08:24:37 +1300
Subject: [R-sig-Geo] Convert asc grid to points
In-Reply-To: <AANLkTi=eeYWPV48X3X_H2cgrA2OVeb8ATL_SMAM1-oCp@mail.gmail.com>
References: <AANLkTi=eeYWPV48X3X_H2cgrA2OVeb8ATL_SMAM1-oCp@mail.gmail.com>
Message-ID: <38C9725B-43A1-4B22-86EE-A6FD51ED948F@auckland.ac.nz>


On 14/10/2010, at 8:34 AM, Arnaud Mosnier wrote:

> Dear GeoR users,
> 
> Is there a function to convert ascii grid (created with adehabitat kernel
> function) into a points format (ppp or others).

I don't know from ``ascii grid'' or ``adehabitat kernel'' but it is possible
that you may find useful ideas in Adrian Baddeley's vignette ``Handling shapefiles
in the spatstat package'' (under the Downloads for spatstat on CRAN).

	cheers,

		Rolf Turner

From mspinola10 at gmail.com  Thu Oct 14 22:22:18 2010
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Thu, 14 Oct 2010 14:22:18 -0600
Subject: [R-sig-Geo] Problems with mask (raster)
Message-ID: <4CB7667A.1010200@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101014/367a1d4a/attachment.pl>

From r.hijmans at gmail.com  Thu Oct 14 22:44:28 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 14 Oct 2010 13:44:28 -0700
Subject: [R-sig-Geo] Problems with mask (raster)
In-Reply-To: <4CB7667A.1010200@gmail.com>
References: <4CB7667A.1010200@gmail.com>
Message-ID: <AANLkTik5H2f4t3nVR0LuVBgmaQrk-vanExGZQGWEcOT1@mail.gmail.com>

I think it should be:

res <- mask(bio1cr, crmask)

On Thu, Oct 14, 2010 at 1:22 PM, Manuel Sp?nola <mspinola10 at gmail.com> wrote:
> ?Dear list members,
>
> I am working with bioclim variables to model species distribution.
> The files downloaded from Worldclim.org are generic raster files (.bil)
> I transform this files to raster:
>
> bio1 <- raster("bio1_23.bil")
>
> cr = readOGR(dsn="C:/ProyectoRespacial/EvalHab_reporte",
> layer="Cr_wgs84_meso")
>
> bio1cr <- crop(bio1, cr)
> crmask <- polygonsToRaster(cr, bio1cr)
> res <- mask(bio1, crmask)
> Error en compare(x, mask) : Different bounding box
>
> plot(bio1cr) the scale legend shows numbers from 0 to 55000
>
> Best,
>
> Manuel
>
>
> --
> *Manuel Sp?nola, Ph.D.*
> Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
> Universidad Nacional
> Apartado 1350-3000
> Heredia
> COSTA RICA
> mspinola at una.ac.cr
> mspinola10 at gmail.com
> Tel?fono: (506) 2277-3598
> Fax: (506) 2237-7036
> Personal website: Lobito de r?o
> <https://sites.google.com/site/lobitoderio/>
> Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


From ricardorodot02 at gmail.com  Thu Oct 14 23:51:47 2010
From: ricardorodot02 at gmail.com (=?ISO-8859-1?Q?Ricardo_Rodr=EDguez?=)
Date: Thu, 14 Oct 2010 16:51:47 -0500
Subject: [R-sig-Geo] trouble with readOGR() and shapes files
Message-ID: <AANLkTinm88_UsdumHFU7JFRQMbEPSz2-r2XrgUyvUfNA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101014/dfc04be5/attachment.pl>

From mdsumner at gmail.com  Fri Oct 15 00:12:46 2010
From: mdsumner at gmail.com (Michael Sumner)
Date: Fri, 15 Oct 2010 09:12:46 +1100
Subject: [R-sig-Geo] trouble with readOGR() and shapes files
In-Reply-To: <AANLkTinm88_UsdumHFU7JFRQMbEPSz2-r2XrgUyvUfNA@mail.gmail.com>
References: <AANLkTinm88_UsdumHFU7JFRQMbEPSz2-r2XrgUyvUfNA@mail.gmail.com>
Message-ID: <AANLkTi=LJdYU4Hp6iZB8fRXUo6PjzhVCA7azFUpubv+H@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101015/69d60b24/attachment.pl>

From mspinola10 at gmail.com  Fri Oct 15 00:17:25 2010
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Thu, 14 Oct 2010 16:17:25 -0600
Subject: [R-sig-Geo] Problems with mask (raster)
In-Reply-To: <AANLkTik5H2f4t3nVR0LuVBgmaQrk-vanExGZQGWEcOT1@mail.gmail.com>
References: <4CB7667A.1010200@gmail.com>
	<AANLkTik5H2f4t3nVR0LuVBgmaQrk-vanExGZQGWEcOT1@mail.gmail.com>
Message-ID: <4CB78175.6030407@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101014/56d3aae1/attachment.pl>

From ricardorodot02 at gmail.com  Fri Oct 15 01:36:35 2010
From: ricardorodot02 at gmail.com (=?ISO-8859-1?Q?Ricardo_Rodr=EDguez?=)
Date: Thu, 14 Oct 2010 18:36:35 -0500
Subject: [R-sig-Geo] trouble with idw and writeGDAL
Message-ID: <AANLkTimAJM=qJpqrM-5mPJ1jT5N2ETJ2g52QBBL-1Ck7@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101014/bcf330db/attachment.pl>

From eac16 at psu.edu  Fri Oct 15 05:11:29 2010
From: eac16 at psu.edu (Elizabeth Crisfield)
Date: Thu, 14 Oct 2010 23:11:29 -0400
Subject: [R-sig-Geo] Raster Package Aggregate new coordinates?
Message-ID: <AANLkTikx8s1VKav3Bz3AL9zpu=5ssc5nRzhm5QSxN2=0@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101014/9dabb321/attachment.pl>

From r.hijmans at gmail.com  Fri Oct 15 06:48:02 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 14 Oct 2010 21:48:02 -0700
Subject: [R-sig-Geo] Raster Package Aggregate new coordinates?
In-Reply-To: <AANLkTikx8s1VKav3Bz3AL9zpu=5ssc5nRzhm5QSxN2=0@mail.gmail.com>
References: <AANLkTikx8s1VKav3Bz3AL9zpu=5ssc5nRzhm5QSxN2=0@mail.gmail.com>
Message-ID: <AANLkTi=roTw+BPmhbCQdR62UVv-NJG6QVOeUNrrPc0Qz@mail.gmail.com>

On Thu, Oct 14, 2010 at 8:11 PM, Elizabeth Crisfield <eac16 at psu.edu> wrote:
> I'm using aggregate in the raster package.
>
> It looks like it uses the coordinate pair of the northwest corner of the
> original high res dataset as the new northwest corner of the aggregated
> dataset.

Correct, and the SE corner is adjusted, if necessary.

> This would be right if the coordinates were taken to be grid
> centered. But when I browse the data in arc, it *looks* like the Raster
> package is using cell center coordinates.
> (But it could be arc that is confusing grid and cell-centered.)

The Raster* objects do not use cell-center coordinates, but in arc you
are looking at a file, and what you are seeing could be a
file-format-specific matter. What format did you write to? This issue
does cause a lot of confusion, and it certainly possible that
something goes wrong in writing that file in raster (perhaps via
rgdal), or in Arc. Can you produce a reproducible example, perhaps
starting from the example in the aggregate help file?

> In case it matters, these files were netcdfs, with bands converted to
> rasters, and then stacked to prep for the aggregate.
> I still haven't gotten
> crop to work on them, erroring with "Error in intersectExtent(x,y):Invalid
> extent" so maybe I have deeper coordinate system read-in problems...

Sounds like an invalid extent argument to crop. Likely the extend that
you want to use to crop does not at all overlap with the raster. If
they do you should be able to see that when doing plot(raster);
plot(extent, add=TRUE)

Cheers, Robert
>
>
> Elizabeth
> ____________________
> Elizabeth Crisfield
> Research Assistant
> Geography Department
> Penn State University
> phone 814-777-3395
> eac16 at psu.edu
> www.elizabethcrisfield.com
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From kvormoor at uni-bonn.de  Fri Oct 15 12:37:02 2010
From: kvormoor at uni-bonn.de (Klaus Vormoor)
Date: Fri, 15 Oct 2010 12:37:02 +0200
Subject: [R-sig-Geo] problem with the sp.layout command
In-Reply-To: <AANLkTikBufwxq4rtOj0n2=DuAkAO2Xfw_tzCy4Ja7AmQ@mail.gmail.com>
References: <1287040291731-5633972.post@n2.nabble.com>
	<AANLkTikBufwxq4rtOj0n2=DuAkAO2Xfw_tzCy4Ja7AmQ@mail.gmail.com>
Message-ID: <web-5499219@be1.uni-bonn.de>

Thnaks Lyndon!

I read about your problem a couple of days ago and thought 
that I updated the sp package afterwards. Therefore, I 
wondered why it was not fixed. Now, I realized that I used 
R 2.9.2 but the package update needs > 2.10. So that was 
the error. Thanks for let me checking this agian.

Cheers, Klaus


On Thu, 14 Oct 2010 09:11:16 -0400
  Lyndon Estes <lestes at princeton.edu> wrote:
> Hi Klaus,
> 
> I recently wrote about the same problem, which Edzer has 
>fixed with an
> sp package update:
> 
> http://r-sig-geo.2731867.n2.nabble.com/spplot-1-filling-background-polygon-without-overwriting-foreground-polygon-2-left-justifying-sp-layot-td5615087.html#a5615087
> 
> Cheers, Lyndon
>


From jaime.garcia at uni-bonn.de  Fri Oct 15 13:10:55 2010
From: jaime.garcia at uni-bonn.de (Jaime R. Garcia Marquez)
Date: Fri, 15 Oct 2010 13:10:55 +0200
Subject: [R-sig-Geo] Problems with mask (raster)
In-Reply-To: <4CB78175.6030407@gmail.com>
References: <4CB7667A.1010200@gmail.com>
	<AANLkTik5H2f4t3nVR0LuVBgmaQrk-vanExGZQGWEcOT1@mail.gmail.com>
	<4CB78175.6030407@gmail.com>
Message-ID: <web-5499765@be1.uni-bonn.de>

Hola Manuel,

Regarding the values of the .bil files I was dealing with 
that also sometime ago.

I found this link in a forum who helped me understand what 
is going on with these files:

http://pvanb.wordpress.com/2010/02/06/importing-worldclim-climate-bil-datalayers-in-grass-gis/

So I wrote in R something like this to get the right 
values:

library(raster)
bio <- raster("bio1_23.bil")
ind <- which(bio[] > 32767)
bio[ind] <- bio[ind] - (65535+1)
bio[bio[] == -9999] <- NA
bio
plot(bio)

Hope this helps.

Saludos, pura vida

Jaime

On Thu, 14 Oct 2010 16:17:25 -0600
  Manuel Sp?nola <mspinola10 at gmail.com> wrote:
>  Thank you very much Robert,
> 
> Now I have this error:
> 
> > me <- maxent(bio1res, arb)
> Error en .local(x, p, ...) :
>   more than half of the presence points have NA 
>predictor values
> 
> It could be related to the raster "bio1res"?  The origin 
>of this file is 
> .bil files.  Which is the best file format to work with 
>bioclim data?
> The plot(bio1res) display with a legend with values from 
>0 to 50000 and 
> the raster is for temperature.
> 
> bio1res
> class       : RasterLayer
> filename    :
> nrow        : 382
> ncol        : 407
> ncell       : 155474
> min value   : 47
> max value   : 55537
> projection  : NA
> xmin        : -85.95
> xmax        : -82.55833
> ymin        : 8.041667
> ymax        : 11.225
> xres        : 0.008333333
> yres        : 0.008333333
> 
> Best,
> 
> Manuel
> 
> 
> On 14/10/2010 02:44 p.m., Robert J. Hijmans wrote:
>> I think it should be:
>>
>> res<- mask(bio1cr, crmask)
>>
>> On Thu, Oct 14, 2010 at 1:22 PM, Manuel 
>>Sp?nola<mspinola10 at gmail.com>  wrote:
>>>   Dear list members,
>>>
>>> I am working with bioclim variables to model species 
>>>distribution.
>>> The files downloaded from Worldclim.org are generic 
>>>raster files (.bil)
>>> I transform this files to raster:
>>>
>>> bio1<- raster("bio1_23.bil")
>>>
>>> cr = readOGR(dsn="C:/ProyectoRespacial/EvalHab_reporte",
>>> layer="Cr_wgs84_meso")
>>>
>>> bio1cr<- crop(bio1, cr)
>>> crmask<- polygonsToRaster(cr, bio1cr)
>>> res<- mask(bio1, crmask)
>>> Error en compare(x, mask) : Different bounding box
>>>
>>> plot(bio1cr) the scale legend shows numbers from 0 to 
>>>55000
>>>
>>> Best,
>>>
>>> Manuel
>>>
>>>
>>> --
>>> *Manuel Sp?nola, Ph.D.*
>>> Instituto Internacional en Conservaci?n y Manejo de Vida 
>>>Silvestre
>>> Universidad Nacional
>>> Apartado 1350-3000
>>> Heredia
>>> COSTA RICA
>>> mspinola at una.ac.cr
>>> mspinola10 at gmail.com
>>> Tel?fono: (506) 2277-3598
>>> Fax: (506) 2237-7036
>>> Personal website: Lobito de r?o
>>> <https://sites.google.com/site/lobitoderio/>
>>> Institutional website: 
>>>ICOMVIS<http://www.icomvis.una.ac.cr/>
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
> 
> 
> -- 
> *Manuel Sp?nola, Ph.D.*
> Instituto Internacional en Conservaci?n y Manejo de Vida 
>Silvestre
> Universidad Nacional
> Apartado 1350-3000
> Heredia
> COSTA RICA
> mspinola at una.ac.cr
> mspinola10 at gmail.com
> Tel?fono: (506) 2277-3598
>Fax: (506) 2237-7036
> Personal website: Lobito de r?o 
> <https://sites.google.com/site/lobitoderio/>
> Institutional website: ICOMVIS 
><http://www.icomvis.una.ac.cr/>
> 
> 	[[alternative HTML version deleted]]
>


From kmcoulib at gmail.com  Fri Oct 15 14:55:32 2010
From: kmcoulib at gmail.com (kapo coulibaly)
Date: Fri, 15 Oct 2010 08:55:32 -0400
Subject: [R-sig-Geo] DBF file size
In-Reply-To: <4CB729AD.4010601@wildintellect.com>
References: <AANLkTinFjJfyR1iK2CHN24yu=CPpza8RJhGYdQy89vSN@mail.gmail.com>
	<4CB61285.7050205@wildintellect.com>
	<AANLkTikgTcetx-3Q3kD-dPiDOLbyWWisGkh3vEgRT0km@mail.gmail.com>
	<4CB729AD.4010601@wildintellect.com>
Message-ID: <AANLkTimiZmPERo+JYjcHBbY+p=_CG5g0Qz_eD1AQwjrf@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101015/bd7bdf30/attachment.pl>

From paulobrando at gmail.com  Fri Oct 15 17:50:45 2010
From: paulobrando at gmail.com (Paulo Brando)
Date: Fri, 15 Oct 2010 11:50:45 -0400
Subject: [R-sig-Geo] Clip a raster
In-Reply-To: <4CB73300.5000209@gmail.com>
References: <4CB71EC7.8030403@gmail.com>
	<AANLkTi=XG_P3BwNWY4ZHvgK=0rCcMvQrw6NmvC5egkcp@mail.gmail.com>
	<4CB73300.5000209@gmail.com>
Message-ID: <AANLkTi=sYSDau=F=xK_8BcU_3BeqLTBPBADSVkdtwxwU@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101015/c122f45f/attachment.pl>

From r.hijmans at gmail.com  Fri Oct 15 18:13:37 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Fri, 15 Oct 2010 09:13:37 -0700
Subject: [R-sig-Geo] Problems with mask (raster)
In-Reply-To: <web-5499765@be1.uni-bonn.de>
References: <4CB7667A.1010200@gmail.com>
	<AANLkTik5H2f4t3nVR0LuVBgmaQrk-vanExGZQGWEcOT1@mail.gmail.com>
	<4CB78175.6030407@gmail.com> <web-5499765@be1.uni-bonn.de>
Message-ID: <AANLkTimrosexCeU5DDV8kjaZm6NXdcXgAN7QXAQGxAH7@mail.gmail.com>

Here is alternative (non-computational) approach to ensure that the
files are read as signed integers:

library(raster)
bio <- raster("bio1_23.bil", native=T)
dataType(bio) <- 'INT2S'
NAvalue(bio) <- -9999

plot(bio)

Robert

On Fri, Oct 15, 2010 at 4:10 AM, Jaime R. Garcia Marquez
<jaime.garcia at uni-bonn.de> wrote:
> Hola Manuel,
>
> Regarding the values of the .bil files I was dealing with that also sometime
> ago.
>
> I found this link in a forum who helped me understand what is going on with
> these files:
>
> http://pvanb.wordpress.com/2010/02/06/importing-worldclim-climate-bil-datalayers-in-grass-gis/
>
> So I wrote in R something like this to get the right values:
>
> library(raster)
> bio <- raster("bio1_23.bil")
> ind <- which(bio[] > 32767)
> bio[ind] <- bio[ind] - (65535+1)
> bio[bio[] == -9999] <- NA
> bio
> plot(bio)
>
> Hope this helps.
>
> Saludos, pura vida
>
> Jaime
>
> On Thu, 14 Oct 2010 16:17:25 -0600
> ?Manuel Sp?nola <mspinola10 at gmail.com> wrote:
>>
>> ?Thank you very much Robert,
>>
>> Now I have this error:
>>
>> > me <- maxent(bio1res, arb)
>> Error en .local(x, p, ...) :
>> ?more than half of the presence points have NA predictor values
>>
>> It could be related to the raster "bio1res"? ?The origin of this file is
>> .bil files. ?Which is the best file format to work with bioclim data?
>> The plot(bio1res) display with a legend with values from 0 to 50000 and
>> the raster is for temperature.
>>
>> bio1res
>> class ? ? ? : RasterLayer
>> filename ? ?:
>> nrow ? ? ? ?: 382
>> ncol ? ? ? ?: 407
>> ncell ? ? ? : 155474
>> min value ? : 47
>> max value ? : 55537
>> projection ?: NA
>> xmin ? ? ? ?: -85.95
>> xmax ? ? ? ?: -82.55833
>> ymin ? ? ? ?: 8.041667
>> ymax ? ? ? ?: 11.225
>> xres ? ? ? ?: 0.008333333
>> yres ? ? ? ?: 0.008333333
>>
>> Best,
>>
>> Manuel
>>
>>
>> On 14/10/2010 02:44 p.m., Robert J. Hijmans wrote:
>>>
>>> I think it should be:
>>>
>>> res<- mask(bio1cr, crmask)
>>>
>>> On Thu, Oct 14, 2010 at 1:22 PM, Manuel Sp?nola<mspinola10 at gmail.com>
>>> ?wrote:
>>>>
>>>> ?Dear list members,
>>>>
>>>> I am working with bioclim variables to model species distribution.
>>>> The files downloaded from Worldclim.org are generic raster files (.bil)
>>>> I transform this files to raster:
>>>>
>>>> bio1<- raster("bio1_23.bil")
>>>>
>>>> cr = readOGR(dsn="C:/ProyectoRespacial/EvalHab_reporte",
>>>> layer="Cr_wgs84_meso")
>>>>
>>>> bio1cr<- crop(bio1, cr)
>>>> crmask<- polygonsToRaster(cr, bio1cr)
>>>> res<- mask(bio1, crmask)
>>>> Error en compare(x, mask) : Different bounding box
>>>>
>>>> plot(bio1cr) the scale legend shows numbers from 0 to 55000
>>>>
>>>> Best,
>>>>
>>>> Manuel
>>>>
>>>>
>>>> --
>>>> *Manuel Sp?nola, Ph.D.*
>>>> Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
>>>> Universidad Nacional
>>>> Apartado 1350-3000
>>>> Heredia
>>>> COSTA RICA
>>>> mspinola at una.ac.cr
>>>> mspinola10 at gmail.com
>>>> Tel?fono: (506) 2277-3598
>>>> Fax: (506) 2237-7036
>>>> Personal website: Lobito de r?o
>>>> <https://sites.google.com/site/lobitoderio/>
>>>> Institutional website: ICOMVIS<http://www.icomvis.una.ac.cr/>
>>>>
>>>> ? ? ? ?[[alternative HTML version deleted]]
>>>>
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at stat.math.ethz.ch
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>>
>>
>>
>> --
>> *Manuel Sp?nola, Ph.D.*
>> Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
>> Universidad Nacional
>> Apartado 1350-3000
>> Heredia
>> COSTA RICA
>> mspinola at una.ac.cr
>> mspinola10 at gmail.com
>> Tel?fono: (506) 2277-3598
>> Fax: (506) 2237-7036
>> Personal website: Lobito de r?o
>> <https://sites.google.com/site/lobitoderio/>
>> Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>
>>
>> ? ? ? ?[[alternative HTML version deleted]]
>>
>
>
>
>


From r.hijmans at gmail.com  Fri Oct 15 18:24:28 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Fri, 15 Oct 2010 09:24:28 -0700
Subject: [R-sig-Geo] Clip a raster
In-Reply-To: <AANLkTi=sYSDau=F=xK_8BcU_3BeqLTBPBADSVkdtwxwU@mail.gmail.com>
References: <4CB71EC7.8030403@gmail.com>
	<AANLkTi=XG_P3BwNWY4ZHvgK=0rCcMvQrw6NmvC5egkcp@mail.gmail.com>
	<4CB73300.5000209@gmail.com>
	<AANLkTi=sYSDau=F=xK_8BcU_3BeqLTBPBADSVkdtwxwU@mail.gmail.com>
Message-ID: <AANLkTikEVs23GenREySuTkxt9OQWWSGUOv78q64NCRK+@mail.gmail.com>

Paulo,

If the polygon does not cover half the edge-pixel, it is ignored. That
should probably change so that all cells that are touched are
included.

To be safe you could use a slightly larger extent, as in:

e <- intersectExtent(x, extent(y))  + 2 * xres(x)

crop(x, e)


Robert

On Fri, Oct 15, 2010 at 8:50 AM, Paulo Brando <paulobrando at gmail.com> wrote:
> Dear All,
>
> I have been using the crop function in the raster package, but haven't
> figured out yet how this function deals with pixels that falls on the edge
> of a polygon.
>
> Thanks,
>
> Paulo
>
> On Thu, Oct 14, 2010 at 12:42 PM, Manuel Sp?nola <mspinola10 at gmail.com>
> wrote:
>>
>> ?Thank you very much Robert.
>> That's works perfect.
>>
>> Manuel
>>
>> On 14/10/2010 10:21 a.m., Robert J. Hijmans wrote:
>> > Manuel,
>> >
>> > if "costarica" is a SpatialPolygons* object, you can do:
>> >
>> > r<- raster("bio1_23.bil")
>> > cr<- crop(r, costarica)
>> >
>> > Robert
>> >
>> > On Thu, Oct 14, 2010 at 8:16 AM, Manuel Sp?nola<mspinola10 at gmail.com>
>> > ?wrote:
>> >> ? Dear list members,
>> >>
>> >> I download bioclim data in a raster format (estension: .bil) and I
>> >> would
>> >> like to clip the variables to a ploygon stored as a shapefile (Costa
>> >> Rica outline).
>> >> How can I do that?
>> >>
>> >> I read the raster file like this:
>> >>
>> >> x<- readGDAL("bio1_23.bil")
>> >>
>> >> Thank you very much in advance.
>> >> Best,
>> >>
>> >> Manuel
>> >>
>> >>
>> >> --
>> >> *Manuel Sp?nola, Ph.D.*
>> >> Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
>> >> Universidad Nacional
>> >> Apartado 1350-3000
>> >> Heredia
>> >> COSTA RICA
>> >> mspinola at una.ac.cr
>> >> mspinola10 at gmail.com
>> >> Tel?fono: (506) 2277-3598
>> >> Fax: (506) 2237-7036
>> >> Personal website: Lobito de r?o
>> >> <https://sites.google.com/site/lobitoderio/>
>> >> Institutional website: ICOMVIS<http://www.icomvis.una.ac.cr/>
>> >>
>> >> ? ? ? ? [[alternative HTML version deleted]]
>> >>
>> >>
>> >> _______________________________________________
>> >> R-sig-Geo mailing list
>> >> R-sig-Geo at stat.math.ethz.ch
>> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >>
>> >>
>>
>>
>> --
>> *Manuel Sp?nola, Ph.D.*
>> Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
>> Universidad Nacional
>> Apartado 1350-3000
>> Heredia
>> COSTA RICA
>> mspinola at una.ac.cr
>> mspinola10 at gmail.com
>> Tel?fono: (506) 2277-3598
>> Fax: (506) 2237-7036
>> Personal website: Lobito de r?o
>> <https://sites.google.com/site/lobitoderio/>
>> Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>
>>
>> ? ? ? ?[[alternative HTML version deleted]]
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>


From ricardorodot02 at gmail.com  Fri Oct 15 18:53:45 2010
From: ricardorodot02 at gmail.com (=?ISO-8859-1?Q?Ricardo_Rodr=EDguez?=)
Date: Fri, 15 Oct 2010 11:53:45 -0500
Subject: [R-sig-Geo] shape to SpatialGridDataFrame
Message-ID: <AANLkTi=H2uF2Fkdt4=sWahbNObviK1fmT0sAErGKw0se@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101015/a1a8988a/attachment.pl>

From ricardorodot02 at gmail.com  Fri Oct 15 20:21:55 2010
From: ricardorodot02 at gmail.com (=?ISO-8859-1?Q?Ricardo_Rodr=EDguez?=)
Date: Fri, 15 Oct 2010 13:21:55 -0500
Subject: [R-sig-Geo] writeGDAL() grid error for get .tiff image
Message-ID: <AANLkTinbDFvqz9OObRi2=Y_QasgXiFXQO2tsQMm_8gbF@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101015/e57a8fe6/attachment.pl>

From edzer.pebesma at uni-muenster.de  Fri Oct 15 21:35:28 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 15 Oct 2010 21:35:28 +0200
Subject: [R-sig-Geo] writeGDAL() grid error for get .tiff image
In-Reply-To: <AANLkTinbDFvqz9OObRi2=Y_QasgXiFXQO2tsQMm_8gbF@mail.gmail.com>
References: <AANLkTinbDFvqz9OObRi2=Y_QasgXiFXQO2tsQMm_8gbF@mail.gmail.com>
Message-ID: <4CB8AD00.3040902@uni-muenster.de>

Have you tried to make gridded true, say, by

gridded(prueba2) = TRUE

?

On 10/15/2010 08:21 PM, Ricardo Rodr?guez wrote:
> hi all I have problems to export the results of interpolation to tiff.
> 
> I use this:
> 
> 
> *
> writeGDAL(prueba2,"/var/www/outputs/prueba2.tiff",type="Float32",driver="GTiff")
> *
> 
> and I get this error:
> 
> *Error: gridded(dataset) is not TRUE*
> 
> 
> as does the operation, and make a grid of interpolation, but there is
> another way to do it or should I do to correct this error.
> 
> thanks for your help and time
> 
> Ricardo Rodr?guez
> Univalle
> 
> 	[[alternative HTML version deleted]]
> 
> 
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From mspinola10 at gmail.com  Sat Oct 16 13:33:19 2010
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Sat, 16 Oct 2010 05:33:19 -0600
Subject: [R-sig-Geo] Converting UTM to geographical coordinates
Message-ID: <4CB98D7F.9070409@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101016/551f89f1/attachment.pl>

From villers.alexandre at gmail.com  Sat Oct 16 13:41:16 2010
From: villers.alexandre at gmail.com (Alexandre Villers)
Date: Sat, 16 Oct 2010 14:41:16 +0300
Subject: [R-sig-Geo] Converting UTM to geographical coordinates
In-Reply-To: <4CB98D7F.9070409@gmail.com>
References: <4CB98D7F.9070409@gmail.com>
Message-ID: <4CB98F5C.5030905@gmail.com>

  Hey Manual,

One thing to do first would be to ask where you can find the 
information... here for example 
http://rwiki.sciviews.org/doku.php?id=tips:spatial-data:change_crs 
everything you look for is on that page
And have a look a Applied Spatial Data Analysis with R (ASDAR) to 
understand the basics of Spatial objects in sp package and how to 
perform what you are looking for. It will be much more benefitial for 
you to learn it by yourself that simply copy a code one can provide you 
with...

HTH

Best regards

Alex

-- 
Alexandre Villers, PhD.
Postdoc researcher
Spatial Ecology & Population Dynamics
Section of Ecology, Department of Biology
University of Turku
FIN-20014 Turku
Finland

@mail: alexandre.villers at utu.fi
phone: 00358 (0)2 333 5049

Skype You can skype me (but think of using Ekiga instead !) 
<skype:aquila06?call>


*Use open source and free softwares*
<http://cran.r-project.org/> <http://grass.itc.it/> 
<http://www.qgis.org/> <http://fr.openoffice.org/> 
<http://www.mozilla-europe.org/fr/> <http://www.mozilla-europe.org/fr/>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101016/5524cf85/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Skypelogo.jpg
Type: image/jpeg
Size: 5395 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101016/5524cf85/attachment.jpg>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Rlogo.jpg
Type: image/jpeg
Size: 1753 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101016/5524cf85/attachment-0001.jpg>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: GRASSlogo.png
Type: image/png
Size: 3277 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101016/5524cf85/attachment.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: QGIS.png
Type: image/png
Size: 4144 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101016/5524cf85/attachment-0001.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: OOlogo.gif
Type: image/gif
Size: 4246 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101016/5524cf85/attachment.gif>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: TBlogo.jpg
Type: image/jpeg
Size: 1385 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101016/5524cf85/attachment-0002.jpg>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: FFlogo.jpg
Type: image/jpeg
Size: 1686 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101016/5524cf85/attachment-0003.jpg>

From jano at rjb.csic.es  Sat Oct 16 15:52:45 2010
From: jano at rjb.csic.es (=?ISO-8859-1?Q?Alejandro_Gonz=E1lez?=)
Date: Sat, 16 Oct 2010 15:52:45 +0200
Subject: [R-sig-Geo] reading AML scripts in R
In-Reply-To: <mailman.13.1287136808.30492.r-sig-geo@stat.math.ethz.ch>
References: <mailman.13.1287136808.30492.r-sig-geo@stat.math.ethz.ch>
Message-ID: <4CB9AE2D.6070300@rjb.csic.es>

  Dear all,
Is there any way to read AML ArcInfo scripts within R environment?

Thanks

Alejandro Gonz?lez
Departamento de Biodiversidad y Conservaci?n
Real Jard?n Bot?nico
Consejo Superior de Investigaciones Cient?ficas

Claudio Moyano, 1
28014 Madrid, Spain

Tel +0034 914203017


From mspinola10 at gmail.com  Sat Oct 16 16:45:23 2010
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Sat, 16 Oct 2010 08:45:23 -0600
Subject: [R-sig-Geo] Converting UTM to geographical coordinates
In-Reply-To: <4CB98F5C.5030905@gmail.com>
References: <4CB98D7F.9070409@gmail.com> <4CB98F5C.5030905@gmail.com>
Message-ID: <4CB9BA83.5040701@gmail.com>

  Thank you very much Alexander.
I am looking at the website right now.
In my case I have a very particular coordinate system (CRTM, Costa Rica 
Transverse MErcator) in this case, which parameter I need to know to 
make the conversion?

Best,

Manuel

On 16/10/2010 05:41 a.m., Alexandre Villers wrote:
> Hey Manual,
>
> One thing to do first would be to ask where you can find the 
> information... here for example 
> http://rwiki.sciviews.org/doku.php?id=tips:spatial-data:change_crs 
> everything you look for is on that page
> And have a look a Applied Spatial Data Analysis with R (ASDAR) to 
> understand the basics of Spatial objects in sp package and how to 
> perform what you are looking for. It will be much more benefitial for 
> you to learn it by yourself that simply copy a code one can provide 
> you with...
>
> HTH
>
> Best regards
>
> Alex
>
> -- 
> Alexandre Villers, PhD.
> Postdoc researcher
> Spatial Ecology & Population Dynamics
> Section of Ecology, Department of Biology
> University of Turku
> FIN-20014 Turku
> Finland
>
> @mail: alexandre.villers at utu.fi
> phone: 00358 (0)2 333 5049
>
> Skype You can skype me (but think of using Ekiga instead !) 
> <skype:aquila06?call>
>
>
> *Use open source and free softwares*
> <http://cran.r-project.org/> <http://grass.itc.it/> 
> <http://www.qgis.org/> <http://fr.openoffice.org/> 
> <http://www.mozilla-europe.org/fr/> <http://www.mozilla-europe.org/fr/>
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


-- 
*Manuel Sp?nola, Ph.D.*
Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
Universidad Nacional
Apartado 1350-3000
Heredia
COSTA RICA
mspinola at una.ac.cr
mspinola10 at gmail.com
Tel?fono: (506) 2277-3598
Fax: (506) 2237-7036
Personal website: Lobito de r?o 
<https://sites.google.com/site/lobitoderio/>
Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101016/6cd0eae2/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/jpeg
Size: 5395 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101016/6cd0eae2/attachment.jpe>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/jpeg
Size: 1753 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101016/6cd0eae2/attachment-0001.jpe>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/png
Size: 3277 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101016/6cd0eae2/attachment.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/png
Size: 4144 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101016/6cd0eae2/attachment-0001.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/gif
Size: 4246 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101016/6cd0eae2/attachment.gif>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/jpeg
Size: 1385 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101016/6cd0eae2/attachment-0002.jpe>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/jpeg
Size: 1686 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101016/6cd0eae2/attachment-0003.jpe>

From r.hijmans at gmail.com  Sat Oct 16 22:32:07 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sat, 16 Oct 2010 13:32:07 -0700
Subject: [R-sig-Geo] Converting UTM to geographical coordinates
In-Reply-To: <4CB9BA83.5040701@gmail.com>
References: <4CB98D7F.9070409@gmail.com> <4CB98F5C.5030905@gmail.com>
	<4CB9BA83.5040701@gmail.com>
Message-ID: <AANLkTi=Umx-jDko2jv9WQEgCaQ5-v_FYpnoErTJChZ5n@mail.gmail.com>

Manuel,

Costa Rica Transverse Mercator is a type of Transverse Mercator (like UTM).

http://www.remotesensing.org/geotiff/proj_list/transverse_mercator.html

So we have, in proj.4 notation

+proj=tmerc

It is revealed here:
http://www.asprs.org/resources/GRIDS/04-2008-costarica.pd<http://www.asprs.org/resources/GRIDS/04-2008-costarica.pdf>

that the for *

"Proyecci?n CRTM90-WGS84" the

*central meridian is 84 degrees so we have:

+proj=tmerc  *

+lon_0=-84

*
*


*
*

The same author and the document below (a search for "Proyecci?n CRTM90-WGS84" )

*
*


*
*http://www.geotecnologias.com/Documentos/TSCArcGIS_9x.pdf*

provide some additional info such that I would think you are probably
dealing with :
*

+proj=tmerc

+lon_0=-84 +lat_0=0

+k=0.9996 +datum=WGS84

*

Although there might be *

CRTM90 projections with a different datum out there. And watch for
those false eastings and northings (horizontal and/or vertical shifts
to express the coordinates in smaller numbers. (I am assuming +

**

x_0=0 +y_0=0

**

)

*

http://spatialreference.org/ <http://spatialreference.org/ref/sr-org/6993/> did
not have it, but I have uploaded here, so that you can easily test it by
clicking on a map:

http://spatialreference.org/ref/sr-org/6993/

With this you could try your luck with spTransform

Best, Robert


On Sat, Oct 16, 2010 at 7:45 AM, Manuel Sp?nola <mspinola10 at gmail.com>wrote:

>  Thank you very much Alexander.
> I am looking at the website right now.
> In my case I have a very particular coordinate system (CRTM, Costa Rica
> Transverse MErcator) in this case, which parameter I need to know to make
> the conversion?
>
> Best,
>
> Manuel
>
>
> On 16/10/2010 05:41 a.m., Alexandre Villers wrote:
>
> Hey Manual,
>
> One thing to do first would be to ask where you can find the information...
> here for example
> http://rwiki.sciviews.org/doku.php?id=tips:spatial-data:change_crseverything you look for is on that page
> And have a look a Applied Spatial Data Analysis with R (ASDAR) to
> understand the basics of Spatial objects in sp package and how to perform
> what you are looking for. It will be much more benefitial for you to learn
> it by yourself that simply copy a code one can provide you with...
>
> HTH
>
> Best regards
>
> Alex
>
> --
>  Alexandre Villers, PhD.
> Postdoc researcher
> Spatial Ecology & Population Dynamics
> Section of Ecology, Department of Biology
> University of Turku
> FIN-20014 Turku
> Finland
>
> @mail: alexandre.villers at utu.fi
> phone: 00358 (0)2 333 5049
>
> Skype [image: You can skype me (but think of using Ekiga instead !)]
> *Use open source and free softwares*
>  <http://cran.r-project.org/> <http://grass.itc.it/>
> <http://www.qgis.org/> <http://fr.openoffice.org/>
> <http://www.mozilla-europe.org/fr/> <http://www.mozilla-europe.org/fr/>
>
>
> _______________________________________________
> R-sig-Geo mailing listR-sig-Geo at stat.math.ethz.chhttps://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>
> --
> *Manuel Sp?nola, Ph.D.*
> Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
> Universidad Nacional
> Apartado 1350-3000
> Heredia
> COSTA RICA
> mspinola at una.ac.cr
> mspinola10 at gmail.com
> Tel?fono: (506) 2277-3598
> Fax: (506) 2237-7036
> Personal website: Lobito de r?o<https://sites.google.com/site/lobitoderio/>
> Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101016/4ed243de/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/png
Size: 4144 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101016/4ed243de/attachment.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/png
Size: 3277 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101016/4ed243de/attachment-0001.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/jpeg
Size: 5395 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101016/4ed243de/attachment.jpe>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/jpeg
Size: 1753 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101016/4ed243de/attachment-0001.jpe>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/jpeg
Size: 1385 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101016/4ed243de/attachment-0002.jpe>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/gif
Size: 4246 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101016/4ed243de/attachment.gif>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/jpeg
Size: 1686 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101016/4ed243de/attachment-0003.jpe>

From kmcoulib at gmail.com  Sat Oct 16 23:15:20 2010
From: kmcoulib at gmail.com (kapo coulibaly)
Date: Sat, 16 Oct 2010 17:15:20 -0400
Subject: [R-sig-Geo] Convert array to list
Message-ID: <AANLkTim7fvqGhOcC+k-Zh-J6C0gFEga-3W2nDw33UZ7K@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101016/987f8348/attachment.pl>

From edzer.pebesma at uni-muenster.de  Sun Oct 17 00:00:58 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sun, 17 Oct 2010 00:00:58 +0200
Subject: [R-sig-Geo] Convert array to list
In-Reply-To: <AANLkTim7fvqGhOcC+k-Zh-J6C0gFEga-3W2nDw33UZ7K@mail.gmail.com>
References: <AANLkTim7fvqGhOcC+k-Zh-J6C0gFEga-3W2nDw33UZ7K@mail.gmail.com>
Message-ID: <4CBA209A.8060201@uni-muenster.de>

a = array(1:27, c(3,3,3))
a
unlist(lapply(apply(a,1,function(x) apply(x,1,list)),
  function(x) unlist(x, recursive = FALSE)), recursive = FALSE)


On 10/16/2010 11:15 PM, kapo coulibaly wrote:
> Is there a quick way to convert a 3 dimensional array to a list of vectors
> of the third dimension. ex:
> array[a,b,c] to a list containing array[1,1,], array[1,2,],
> array[1,3].........array[1,b], array[2,1,] ......array[a,b,c]
> 
> preferably avoiding l;oops.
> 
> Thanks
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From mspinola10 at gmail.com  Sun Oct 17 01:34:25 2010
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Sat, 16 Oct 2010 17:34:25 -0600
Subject: [R-sig-Geo] Converting UTM to geographical coordinates
In-Reply-To: <AANLkTi=Umx-jDko2jv9WQEgCaQ5-v_FYpnoErTJChZ5n@mail.gmail.com>
References: <4CB98D7F.9070409@gmail.com>	<4CB98F5C.5030905@gmail.com>	<4CB9BA83.5040701@gmail.com>
	<AANLkTi=Umx-jDko2jv9WQEgCaQ5-v_FYpnoErTJChZ5n@mail.gmail.com>
Message-ID: <4CBA3681.5010406@gmail.com>

  Thank you very much Robert,

I need CRTM05 and according the information that you sent me it will be:

+proj=tmerc  + lon_0=-84 + lat_0=0 + k=0.9999 +datum=WGS84

I guess I only need to set the 0.9999 instead of 0.9996.

It make sense?

Best,

Manuel

On 16/10/2010 02:32 p.m., Robert J. Hijmans wrote:
> Manuel,
>
> Costa Rica Transverse Mercator is a type of Transverse Mercator (like 
> UTM).
>
> http://www.remotesensing.org/geotiff/proj_list/transverse_mercator.html
>
> So we have, in proj.4 notation
>
> +proj=tmerc
>
> It is revealed here: 
> http://www.asprs.org/resources/GRIDS/04-2008-costarica.pd 
> <http://www.asprs.org/resources/GRIDS/04-2008-costarica.pdf>
>
> that the for *
> "Proyecci?n CRTM90-WGS84" the
> *central meridian is 84 degrees so we have:
>
> +proj=tmerc *
> +lon_0=-84
> *
> *
> *
> *
> The same author and the document below (a search for "Proyecci?n CRTM90-WGS84" )
> *
> *
>
>
> *
> *http://www.geotecnologias.com/Documentos/TSCArcGIS_9x.pdf*
>
> provide some additional info such that I would think you are probably 
> dealing with :
> *
> +proj=tmerc *
> +lon_0=-84 +lat_0=0
> **
> +k=0.9996 +datum=WGS84
> *
> *
>
> Although there might be *
> CRTM90 projections with a different datum out there. And watch for those false eastings and northings (horizontal and/or vertical shifts to express the coordinates in smaller numbers. (I am assuming +
> **
> *
> x_0=0/  /+y_0=0*
> **
> )
> *
>
> http://spatialreference.org/ 
> <http://spatialreference.org/ref/sr-org/6993/> did not have it, but I 
> have uploaded here, so that you can easily test it by clicking on a map:
>
> http://spatialreference.org/ref/sr-org/6993/
>
> With this you could try your luck with spTransform
>
> Best, Robert
>
>
> On Sat, Oct 16, 2010 at 7:45 AM, Manuel Sp?nola <mspinola10 at gmail.com 
> <mailto:mspinola10 at gmail.com>> wrote:
>
>     Thank you very much Alexander.
>     I am looking at the website right now.
>     In my case I have a very particular coordinate system (CRTM, Costa
>     Rica Transverse MErcator) in this case, which parameter I need to
>     know to make the conversion?
>
>     Best,
>
>     Manuel
>
>
>     On 16/10/2010 05:41 a.m., Alexandre Villers wrote:
>>     Hey Manual,
>>
>>     One thing to do first would be to ask where you can find the
>>     information... here for example
>>     http://rwiki.sciviews.org/doku.php?id=tips:spatial-data:change_crs everything
>>     you look for is on that page
>>     And have a look a Applied Spatial Data Analysis with R (ASDAR) to
>>     understand the basics of Spatial objects in sp package and how to
>>     perform what you are looking for. It will be much more benefitial
>>     for you to learn it by yourself that simply copy a code one can
>>     provide you with...
>>
>>     HTH
>>
>>     Best regards
>>
>>     Alex
>>
>>     -- 
>>     Alexandre Villers, PhD.
>>     Postdoc researcher
>>     Spatial Ecology & Population Dynamics
>>     Section of Ecology, Department of Biology
>>     University of Turku
>>     FIN-20014 Turku
>>     Finland
>>
>>     @mail: alexandre.villers at utu.fi <mailto:alexandre.villers at utu.fi>
>>     phone: 00358 (0)2 333 5049
>>
>>     Skype You can skype me (but think of using Ekiga instead !)
>>
>>
>>     *Use open source and free softwares*
>>     <http://cran.r-project.org/> <http://grass.itc.it/>
>>     <http://www.qgis.org/> <http://fr.openoffice.org/>
>>     <http://www.mozilla-europe.org/fr/>
>>     <http://www.mozilla-europe.org/fr/>
>>
>>
>>     _______________________________________________
>>     R-sig-Geo mailing list
>>     R-sig-Geo at stat.math.ethz.ch  <mailto:R-sig-Geo at stat.math.ethz.ch>
>>     https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>     -- 
>     *Manuel Sp?nola, Ph.D.*
>     Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
>     Universidad Nacional
>     Apartado 1350-3000
>     Heredia
>     COSTA RICA
>     mspinola at una.ac.cr <mailto:mspinola at una.ac.cr>
>     mspinola10 at gmail.com <mailto:mspinola10 at gmail.com>
>     Tel?fono: (506) 2277-3598
>     Fax: (506) 2237-7036
>     Personal website: Lobito de r?o
>     <https://sites.google.com/site/lobitoderio/>
>     Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>
>
>     _______________________________________________
>     R-sig-Geo mailing list
>     R-sig-Geo at stat.math.ethz.ch <mailto:R-sig-Geo at stat.math.ethz.ch>
>     https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


-- 
*Manuel Sp?nola, Ph.D.*
Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
Universidad Nacional
Apartado 1350-3000
Heredia
COSTA RICA
mspinola at una.ac.cr
mspinola10 at gmail.com
Tel?fono: (506) 2277-3598
Fax: (506) 2237-7036
Personal website: Lobito de r?o 
<https://sites.google.com/site/lobitoderio/>
Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101016/195e5db7/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/jpeg
Size: 5395 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101016/195e5db7/attachment.jpe>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/jpeg
Size: 1753 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101016/195e5db7/attachment-0001.jpe>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/png
Size: 3277 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101016/195e5db7/attachment.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/png
Size: 4144 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101016/195e5db7/attachment-0001.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/gif
Size: 4246 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101016/195e5db7/attachment.gif>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/jpeg
Size: 1385 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101016/195e5db7/attachment-0002.jpe>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/jpeg
Size: 1686 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101016/195e5db7/attachment-0003.jpe>

From Roger.Bivand at nhh.no  Sun Oct 17 22:13:41 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sun, 17 Oct 2010 22:13:41 +0200 (CEST)
Subject: [R-sig-Geo] gwt2nb - regions with zero links
In-Reply-To: <E7C57FAA7891B94DBA265B591642DE2587E24C7C4C@mail.arec.umd.edu>
References: <E7C57FAA7891B94DBA265B591642DE2587E24C7C4C@mail.arec.umd.edu>
Message-ID: <alpine.LRH.2.00.1010172208300.27679@reclus.nhh.no>

On Mon, 11 Oct 2010, Dennis Guignet wrote:

> Dear All,
>
> My end goal is to run a spatial lag model, where the weight matrix will 
> be nonsymmetric and contain observations with zero neighbors.  I am 
> having some difficulties in creating the neighbor list in R.  Any advice 
> or pointers on where to find more information would be greatly 
> appreciated.

Maybe try some other format, such as the MATLAB-style sparse matrix in 
read.dat2listw(). However then you cannot use your codes, just the 
sequence 1:n. If this doesn't help, put the file(s) on a website and post 
the link - debugging without the input data is hard. I can't follow how a 
region with only zero links has non-zero links (below).

Roger

>
> I needed to account for both time and space when defining a list of 
> neighbors, and did so first using ArcInfo and then SAS, and saved the 
> final list as a dbf.  It seems I next want to convert this dbf into a 
> neighbor list in R, and was told the best thing to do is save the dbf as 
> a gwt file and change the header line.  A brief portion is pasted below:
>
> 0 34451 nfred3 DGID
> 105450   105578   1
> 105451   105763   1
> 105451   105627   1
> 105451   105899   1
> 105451   105898   1
> 105451   105915   1
> 105452   105763   1
> 105452   105841   1
>
> nfred3 is the name of the gwt file, and DGID is the unique id for each 
> observation.  There are a total of 34,451 unique observations, some of 
> which do not have any neighbors and are thus not included in the above 
> gwt file.  If I run gwt2nb accounting for these zero link observations I 
> get the following warning messages:
>
>> DGID<-sales$dgid
>> length(DGID)
> [1] 34451
>> n2n<-read.gwt2nb("nfred3.gwt", region.id=DGID)
> Warning messages:
> 1: In read.gwt2nb("nfred3.gwt", region.id = DGID) :
>  region.id not named DGID
> 2: In read.gwt2nb("nfred3.gwt", region.id = DGID) :
>  105462, 105463, 105466, 105468, 105472, ...  [... truncated]
> 3: In read.gwt2nb("nfred3.gwt", region.id = DGID) :
>  105450, 105454, 105455, 105462, 105468, ... [... truncated]
>
> The issue is that there are a total of 1,555 regions with no links, but 
> 1,090 of these regions should have a positive number of links .  The 
> truncated list in the warning message contains id numbers that should 
> have zero links, as well as some that should have nonzero links.
>
> If I run similar code but only account for observations with nonzero 
> links, then I have the correct number of nonzero links. So this neighbor 
> list at first glance seems correct, but I still need to account for 
> observations with zero links when later forming the weights, and I am 
> concerned about the below warning messages.
>
>> #create vector of unique sale ids with nonzero spatial link (i.e. has neighbors)
>> n2n0<-read.table("nfred4.gwt",header=FALSE,skip=1)
>> DGID<-unique(n2n0$V1)
>> length(DGID)
> [1] 33986
>> n2n<-read.gwt2nb("nfred4.gwt", region.id=DGID)
> Warning messages:
> 1: In read.gwt2nb("nfred4.gwt", region.id = DGID) :
>  region.id not named DGID
> 2: In read.gwt2nb("nfred4.gwt", region.id = DGID) :
>  105450, 105454, 105455, 105470, ... [... truncated]
>
> Any advice or pointers of where I can find some helpful info would be 
> greatly appreciated.
>
> Thank you,
> Denny
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Sun Oct 17 22:16:57 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sun, 17 Oct 2010 22:16:57 +0200 (CEST)
Subject: [R-sig-Geo] Rgshhs for getting maps around longitude 0
In-Reply-To: <i973pv$3vj$1@dough.gmane.org>
References: <i973pv$3vj$1@dough.gmane.org>
Message-ID: <alpine.LRH.2.00.1010172214230.27679@reclus.nhh.no>

On Thu, 14 Oct 2010, Karl Ove Hufthammer wrote:

> Dear list members
>
> The GSHHS map data uses longitudes from 0 to 360, which causes problems 
> fetching maps around longitude 0. Example:
>
> library(maptools)
> gpclibPermit()
> gshhs.c.b <- system.file("share/gshhs_c.b", package="maptools")
> xl=c(-30,30)
> yl=c(50,80)
> rmap=Rgshhs(gshhs.c.b, xlim=xl, ylim=yl)
> plot(rmap$SP)
>
> There are no error messages, but some countries are just missing, e.g., 
> Ireland, Iceland and Greenland. To get a map containing them, we have to use 
> xlim=c(330,360). But what if we want to have both countries to the east and 
> to the west of long = 0 on the same map (i.e., SpatialPolygons)?
>
> Rgshhs takes a ?shift? argument, but this only changes the *output* 
> coordinates from 0,360 to -180,180; it doesn?t change the accepted input 
> variables.
>
> Is it necessary to fetch the map twice? If so, which xlim values should be 
> used, and how should the two maps be merged into one SpatialPolygons? Note 
> that if I change ?xlim? to c(0,30), Great Britain is missing ... :-(

As things stand, I suspect that there is no alternative, but will take a 
look (and encourage others to do so too!). Merging with 
unionSpatialPolygons() as usual.

Roger

>
> -- 
> Karl Ove Hufthammer
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From b.rowlingson at lancaster.ac.uk  Sun Oct 17 22:46:16 2010
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Sun, 17 Oct 2010 21:46:16 +0100
Subject: [R-sig-Geo] reading AML scripts in R
In-Reply-To: <4CB9AE2D.6070300@rjb.csic.es>
References: <mailman.13.1287136808.30492.r-sig-geo@stat.math.ethz.ch>
	<4CB9AE2D.6070300@rjb.csic.es>
Message-ID: <AANLkTimu5Byy6zNaJzZHMirG6DaiQ90Chgh8iX7QGO8L@mail.gmail.com>

2010/10/16 Alejandro Gonz?lez <jano at rjb.csic.es>:
> ?Dear all,
> Is there any way to read AML ArcInfo scripts within R environment?

Aren't they plain text files? Use readLines and get it into a character vector.

Barry


From r.hijmans at gmail.com  Mon Oct 18 02:09:17 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sun, 17 Oct 2010 17:09:17 -0700
Subject: [R-sig-Geo] reading AML scripts in R
In-Reply-To: <AANLkTimu5Byy6zNaJzZHMirG6DaiQ90Chgh8iX7QGO8L@mail.gmail.com>
References: <mailman.13.1287136808.30492.r-sig-geo@stat.math.ethz.ch>
	<4CB9AE2D.6070300@rjb.csic.es>
	<AANLkTimu5Byy6zNaJzZHMirG6DaiQ90Chgh8iX7QGO8L@mail.gmail.com>
Message-ID: <AANLkTikWAONjTi-3XotvHF0G7D8DKuHjA0nEZBTSm5Fj@mail.gmail.com>

Alejandro, reading, yes, but interpreting (which is how I understand
your question), no. Translating the flow of AML to R would be easy,
although you would probably want to do things differently in R (fewer
loops). Another matter is whether R has functions equivalent to those
of ArcInfo. Certainly not all of them, but I think that the functions
in the 'raster' package are roughly equivalent to those in the ArcInfo
'grid' module. Robert

2010/10/17 Barry Rowlingson <b.rowlingson at lancaster.ac.uk>:
> 2010/10/16 Alejandro Gonz?lez <jano at rjb.csic.es>:
>> ?Dear all,
>> Is there any way to read AML ArcInfo scripts within R environment?
>
> Aren't they plain text files? Use readLines and get it into a character vector.
>
> Barry
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From Roger.Bivand at nhh.no  Mon Oct 18 08:58:15 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 18 Oct 2010 08:58:15 +0200 (CEST)
Subject: [R-sig-Geo] How to build a spatial weights list for pooled data
In-Reply-To: <4CB71059.20805@ec.unipi.it>
References: <4CB71059.20805@ec.unipi.it>
Message-ID: <alpine.LRH.2.00.1010180849050.3192@reclus.nhh.no>

On Thu, 14 Oct 2010, Angela Parenti wrote:

>
> Hello Roger and everybody else.
>
> I have another question about Weight Matrices. For one of my models I 
> estimate a pooled regression. Then, in order run the Moran test on the pooled 
> regression residuals I need to construct a spatial weights list of the same 
> dimension.
> I already found the way for the spatial matrix built on the inverse distance 
> between neighbours. Here the code for inverse distance matrix:
>
> #####################
> # Moran's Test for spatial effects
> sampleCentroid.Pooled <- 
> rbind(samplecentroid.europeReorderedCamEcon,samplecentroid.europeReorderedCamEcon)
> eu.regions.nb_pooled <- dnearneigh(sampleCentroid.Pooled[iii,], 0, 
> max(distanceMatrix), row.names=NULL, longlat=TRUE)
> coords_pooled <- sampleCentroid.Pooled[iii,]
> dlist_pooled <- nbdists(eu.regions.nb_pooled, coords_pooled, longlat=TRUE)
>
> dlist1_pooled <- lapply(dlist_pooled, function(x) 1/(x^2))
> eu.regions.w1_pooled <- nb2listw(eu.regions.nb_pooled, glist=dlist1_pooled, 
> style="W", zero.policy=TRUE)
>
> moranTestmodelI_w1 <- lm.morantest(modelI, 
> eu.regions.w1_pooled,zero.policy=TRUE, alternative="two.sided")
> print(rbind(c("Global Moran's I for Model I","w1_EK","bivand",""),
>           c("Observed Moran's I", "EI", "VI", "p-value"),
>           c(as.numeric(moranTestmodelI_w1$estimate[1]),as.numeric(moranTestmodelI_w1$estimate[2]),
>           as.numeric(moranTestmodelI_w1$estimate[3]),moranTestmodelI_w1$p.value)
>           ))
> ######################
>
> Differently, I didn't understand yet how to build a spatial weights list for 
> pooled data in case of first-order contiguity matrix. Can you help me?

By "pooled", do you mean an NxT by NxT matrix? Is your data 
spatio-temporal in that case? How large is N, and how large T? Did your 
IDW procedure induce "spatial" relations above and below the block 
diagonal, or do you just need T replicated N by N weights matrices down 
the block diagonal? You may have a result from IDW, but is it what you 
think it is - should d_{itjt} == d_{itj(t-1)} == d_{itj(t+1)} and so on?

To create a contiguity matrix, you can use graph-based methods listed 
under ?graph2nb or contiguity using ?poly2nb, for which you do need the 
boundaries of your regions as for example a shapefile.

Roger

>
> Thank you in advance,
> Angela Parenti
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From karl at huftis.org  Mon Oct 18 10:10:24 2010
From: karl at huftis.org (Karl Ove Hufthammer)
Date: Mon, 18 Oct 2010 10:10:24 +0200
Subject: [R-sig-Geo] Rgshhs for getting maps around longitude 0
References: <i973pv$3vj$1@dough.gmane.org>
	<alpine.LRH.2.00.1010172214230.27679@reclus.nhh.no>
Message-ID: <i9gvdh$l5p$1@dough.gmane.org>

Roger Bivand wrote:

>> Is it necessary to fetch the map twice? If so, which xlim values should
>> be used, and how should the two maps be merged into one SpatialPolygons?
>> Note that if I change ?xlim? to c(0,30), Great Britain is missing ... :-(
> 
> As things stand, I suspect that there is no alternative, but will take a
> look (and encourage others to do so too!). Merging with
> unionSpatialPolygons() as usual.

OK. I?ve created a function for doing this automatically. I haven?t tested
it *very* much, but it seems to work fine for both negative coordinates,
positive coordinates and mixed coordinates.

Having to change the IDs (row names) like this just to merge (rbind) two 
polygons seems a bit too complicated, but I guess it?s necessary?

getRgshhsMap = function (xl, yl, fn = system.file("share/gshhs_c.b", package = "maptools"), 
        shift = TRUE, level = 1, no.clip = FALSE) 
{
    # First try fetching the map directly, possibly with negative coordinates.
    # Note that some polygons with longitude < 0 use negative coordinates 
    # (e.g., Great Britain), and some use positve coordinates (e.g., Ireland).
    #    
    # (Must use 'try' here, because for example xl=c(-40,-10)
    # results in an error, while xl=c(-40,-5) does not.)
    map1 = try(Rgshhs(fn, xlim = xl, ylim = yl, shift = shift, 
                    level = level, no.clip = no.clip)$SP)
    
    # Now try fetching the same area using positive coordinates.
    xl.west = (xl + 360)%%360
    if (xl.west[2] < xl.west[1])
        xl.west[2] = 360
    map2 = Rgshhs(fn, xlim = xl.west, ylim = yl, shift = shift, 
            level = level, no.clip = no.clip)$SP
    
    # If there where no polygons with negative coordinates, just
    # use the positive coordinates.
    if (class(map1) == "try-error") 
        map.union = map2 else { # Else merge the two maps into one.
        
        # First store the original polygon IDs in data frames.
        df1 = data.frame(polyID = row.names(map1))
        row.names(df1) = df1$polyID
        map1.spdf = SpatialPolygonsDataFrame(map1, df1)
        
        df2 = data.frame(polyID = row.names(map2))
        row.names(df2) = df2$polyID
        map2.spdf = SpatialPolygonsDataFrame(map2, df2)
        
        # Generate new polygon IDs to avoid duplicate IDs when
        # rbinding the two maps.
        row.names(map1.spdf) = as.character(seq_along(map1 at polygons))
        row.names(map2.spdf) = as.character(length(map1 at polygons) + 
                        seq_along(map2 at polygons))
        map.merged = rbind(map1.spdf, map2.spdf)
        
        # Finally, combine all the polygons, using the
        # original polyon IDs.
        map.union = unionSpatialPolygons(map.merged, map.merged$polyID)
    }
    map.union
}

-- 
Karl Ove Hufthammer


From karl at huftis.org  Mon Oct 18 13:43:55 2010
From: karl at huftis.org (Karl Ove Hufthammer)
Date: Mon, 18 Oct 2010 13:43:55 +0200
Subject: [R-sig-Geo] Creating density heatmaps for geographical data
References: <i94fpq$356$1@dough.gmane.org>
	<AANLkTi=h=+QWsuOb0EjnkHT1raFsGV3kv9P7Ns2Hf_ZN@mail.gmail.com>
Message-ID: <i9hbts$cj0$1@dough.gmane.org>

Michael Sumner wrote:

> Just answering your first question, you could call sm.density for each
> point individually, then trim back to whatever level you want. Sum each
> grid for each point and you might get a better "trim".
> 
> Otherwise, you'd need to hack the density functions in kde2d or
> sm.density, or maybe in KernSmooth to get non-Gaussians, or otherwise to
> ensure the density is only calculated for a smaller local region around
> the point.
> 
> KernSmooth package may well have more control over this stuff.

Thanks for the suggestion. KernSmooth did not have any more options, but I 
finally found a solution I?m mostly happy with. ?density.ppp? in ?spatstat? 
estimates the intensity function, i.e., the expected number of observations
per area, and accepts weighted observations. It?s possible to specify both
the resolution and the bandwidth, but not the kernel. And 'density.ppp' is 
blazingly fast!

'ppp' objects used by 'spatstat' have an annoying structure, but it?s not 
difficult to convert 'sp' objects to this structure. Be aware of duplicate 
points, though.

Since I use an UTM projection, I get estimates of the expected numbers of 
observations per square meter. Multiplying this with 1000^2 gives the 
expected number per square kilometer, if I have understood things correctly.
I then replace all grid cells with a value < 1 with NA (modifying the ?v? 
variables on the output object directly). Using ?con2tr? converts this into
something ?levelplot? in ?lattice? accepts. Putting this on top of a GSHHS 
map and using 'bpy.colors' basically gives me what I need.

-- 
Karl Ove Hufthammer


From karl at huftis.org  Mon Oct 18 15:36:08 2010
From: karl at huftis.org (Karl Ove Hufthammer)
Date: Mon, 18 Oct 2010 15:36:08 +0200
Subject: [R-sig-Geo] R 2.12.0 and rgdal
Message-ID: <i9hig9$c4r$1@dough.gmane.org>

Dear list members.

I have just updated to R 2.12.0, and see that the ?rgdal? package isn?t 
available for installing from CRAN. Is it just a matter of time before it?s 
available, or are there some technical problems?

-- 
Karl Ove Hufthammer


From mayeul.kauffmann at jrc.ec.europa.eu  Mon Oct 18 15:44:09 2010
From: mayeul.kauffmann at jrc.ec.europa.eu (Mayeul KAUFFMANN)
Date: Mon, 18 Oct 2010 15:44:09 +0200
Subject: [R-sig-Geo] Clip a raster
In-Reply-To: <AANLkTim3ZObrTb7SzaYnD0y43bdXFfC4Y-xNFEGpq7u4@mail.gmail.com>
References: <4CB71EC7.8030403@gmail.com>
	<AANLkTim3ZObrTb7SzaYnD0y43bdXFfC4Y-xNFEGpq7u4@mail.gmail.com>
Message-ID: <007201cb6eca$8ad2efc0$a078cf40$@kauffmann@jrc.ec.europa.eu>

Hi,
Just a comment to sum up: Robert and Johannes mentioned two ways of clipping
that give different results.
My example: clipping MODIS raster data to Democratic Republic of Congo (DRC)

Robert suggested:
MODIS_Drc_cropped<-crop(MODIS, Drc_spdf) # Here, MODIS cropped over a rectangle,
so bigger than AOI

Johannes suggested:
MODIS_Drc_cropped<-crop(MODIS, Drc_spdf)
DRC_mask_raster <- polygonsToRaster(Drc_spdf, raster(MODIS_Drc, values=NA),
  field=-1, updateRaster=TRUE ) # Make a raster mask from DRC area
MODIS_Drc<- mask( MODIS_Drc_cropped, DRC_mask_raster) # apply the masked to the
small rectangle MODIS

MODIS_Drc_cropped is MODIS clipped over a rectangle which is the bounding box of
DRC.
MODIS_Drc has only data within the borders (the rest is NA)

Mayeul
_____________________________________________________
Dr. Mayeul KAUFFMANN, Conflict Specialist
European Commission, Joint Research Centre (JRC)
Institute for the Protection and Security of the Citizen (IPSC)
Global Security and Crisis Management - ISFEREA
Via E. Fermi 2749 - I-21027 Ispra (VA), ITALY
Phone: (+39) 033278 5071
http://isferea.jrc.ec.europa.eu/Staff/Pages/Kauffmann-Mayeul.aspx

(Office: building 48c, 1st floor, room 123. TP: 483)

-----Original Message-----
From: r-sig-geo-bounces at stat.math.ethz.ch
[mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of Johannes Signer
Sent: Thursday, October 14, 2010 5:39 PM
To: Manuel Sp?nola
Cc: r-sig-geo at stat.math.ethz.ch
Subject: Re: [R-sig-Geo] Clip a raster

Hi,

with the raster package you could use: polygons to raster
(?polygonsToRaster), converting the Costa Rica shapefile to a raster
and then use mask (?mask).

Best
Johannes

On Thu, Oct 14, 2010 at 5:16 PM, Manuel Sp?nola <mspinola10 at gmail.com> wrote:
> ?Dear list members,
>
> I download bioclim data in a raster format (estension: .bil) and I would
> like to clip the variables to a ploygon stored as a shapefile (Costa
> Rica outline).
> How can I do that?
>
> I read the raster file like this:
>
> x <- readGDAL("bio1_23.bil")
>
> Thank you very much in advance.
> Best,
>
> Manuel
>
>
> --
> *Manuel Sp?nola, Ph.D.*
> Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
> Universidad Nacional
> Apartado 1350-3000
> Heredia
> COSTA RICA
> mspinola at una.ac.cr
> mspinola10 at gmail.com
> Tel?fono: (506) 2277-3598
> Fax: (506) 2237-7036
> Personal website: Lobito de r?o
> <https://sites.google.com/site/lobitoderio/>
> Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Roger.Bivand at nhh.no  Mon Oct 18 15:59:56 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 18 Oct 2010 15:59:56 +0200 (CEST)
Subject: [R-sig-Geo] R 2.12.0 and rgdal
In-Reply-To: <i9hig9$c4r$1@dough.gmane.org>
References: <i9hig9$c4r$1@dough.gmane.org>
Message-ID: <alpine.LRH.2.00.1010181548200.3662@reclus.nhh.no>

On Mon, 18 Oct 2010, Karl Ove Hufthammer wrote:

> Dear list members.
>
> I have just updated to R 2.12.0, and see that the ?rgdal? package isn?t 
> available for installing from CRAN. Is it just a matter of time before it?s 
> available, or are there some technical problems?

No, the migration of binaries for Windows for both 32 and 64 bit has led 
to rgdal being provided from the CRAN extras repository rather than on 
CRAN mirrors, because of the extensive external dependencies, see:

http://cran.r-project.org/bin/windows/contrib/r-release/ReadMe

On OSX one says:

setRepositories(ind=1:2)
install.packages("rgdal")

but I don't have access now to a Windows installation, so cannot check the 
incantation. If those interested could check, I'll summarise to the list.

Roger

>
> -- 
> Karl Ove Hufthammer
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From Roger.Bivand at nhh.no  Mon Oct 18 17:26:54 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 18 Oct 2010 17:26:54 +0200 (CEST)
Subject: [R-sig-Geo] R 2.12.0 and rgdal
In-Reply-To: <alpine.LRH.2.00.1010181548200.3662@reclus.nhh.no>
References: <i9hig9$c4r$1@dough.gmane.org>
	<alpine.LRH.2.00.1010181548200.3662@reclus.nhh.no>
Message-ID: <alpine.LRH.2.00.1010181708360.8424@reclus.nhh.no>

On Mon, 18 Oct 2010, Roger Bivand wrote:

> On Mon, 18 Oct 2010, Karl Ove Hufthammer wrote:
>
>> Dear list members.
>> 
>> I have just updated to R 2.12.0, and see that the ?rgdal? package isn?t 
>> available for installing from CRAN. Is it just a matter of time before it?s 
>> available, or are there some technical problems?
>
> No, the migration of binaries for Windows for both 32 and 64 bit has led to 
> rgdal being provided from the CRAN extras repository rather than on CRAN 
> mirrors, because of the extensive external dependencies, see:
>
> http://cran.r-project.org/bin/windows/contrib/r-release/ReadMe
>
> On OSX one says:
>
> setRepositories(ind=1:2)
> install.packages("rgdal")
>
> but I don't have access now to a Windows installation, so cannot check the 
> incantation. If those interested could check, I'll summarise to the list.

Two users have confirmed that the same incantation works. On my fresh 
32-bit Windows R binary, my Packages -> Select repositories ... menu 
chooses both CRAN and CRAN (extras) by default, and when used the first 
time will replace CRAN by the mirror selected from a further menu. I'm 
running plain:

update.packages(checkBuilt=TRUE)

on a local library defined in the R_LIBS environment variable, and this 
(as well as being the advised way of managing packages) picks up CRAN 
extras automatically for other packages too, because it is pre-chosen. So 
two conclusions so far:

1)

setRepositories(ind=1:2)
install.packages("rgdal")

works;

2)

update.packages(checkBuilt=TRUE)

works without setting the repository if you have a local library as 
described in the Windows FAQ, point 4.2. The CRAN extras rgdal includes a 
copy of GDAL 1.7.1, we'll try to move to 1.7.2 when the road bump of 
making R windows binaries multi-architectures passes.

Experiences of those running the 64-bit Windows implementation are 
invited!

Roger



>
> Roger
>
>> 
>> -- 
>> Karl Ove Hufthammer
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From thi_veloso at yahoo.com.br  Mon Oct 18 21:31:07 2010
From: thi_veloso at yahoo.com.br (Thiago Veloso)
Date: Mon, 18 Oct 2010 12:31:07 -0700 (PDT)
Subject: [R-sig-Geo] Finding polygon centroid
Message-ID: <875817.46985.qm@web54302.mail.re2.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101018/d7f4b8f8/attachment.pl>

From carson.farmer at gmail.com  Mon Oct 18 21:39:47 2010
From: carson.farmer at gmail.com (Carson Farmer)
Date: Mon, 18 Oct 2010 20:39:47 +0100
Subject: [R-sig-Geo] Finding polygon centroid
In-Reply-To: <875817.46985.qm@web54302.mail.re2.yahoo.com>
References: <875817.46985.qm@web54302.mail.re2.yahoo.com>
Message-ID: <AANLkTimVyNyRE+ayZ4cfDtPCK0rR6j=1ttZUF29icdBw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101018/71d96e27/attachment.pl>

From r.turner at auckland.ac.nz  Mon Oct 18 22:09:29 2010
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Tue, 19 Oct 2010 09:09:29 +1300
Subject: [R-sig-Geo] Creating density heatmaps for geographical data
In-Reply-To: <i9hbts$cj0$1@dough.gmane.org>
References: <i94fpq$356$1@dough.gmane.org>
	<AANLkTi=h=+QWsuOb0EjnkHT1raFsGV3kv9P7Ns2Hf_ZN@mail.gmail.com>
	<i9hbts$cj0$1@dough.gmane.org>
Message-ID: <3CFD474A-0E56-44FF-B7C6-9EDA37FB4E87@auckland.ac.nz>


On 19/10/2010, at 12:43 AM, Karl Ove Hufthammer wrote:

	<SNIP>

> 'ppp' objects used by 'spatstat' have an annoying structure

	<SNIP>

Annoyance is in the mind of the beholder I think.  Personally I
find the structure of ppp objects absolutely *delightful*! :-)

Also, they are simple, intuitive, easy to work with, and easy to
understand, take apart, dissect, and manipulate.  Furthermore the
tools in spatstat make it easy to do unto ppp objects pretty well
anything one might want to do to a point pattern.  (I'm not being
immodest here; the tools are mainly down to Adrian.)

Just *what* do you find ``annoying'' about the structure of ppp objects?

	cheers,

		Rolf


From thi_veloso at yahoo.com.br  Mon Oct 18 22:20:14 2010
From: thi_veloso at yahoo.com.br (Thiago Veloso)
Date: Mon, 18 Oct 2010 13:20:14 -0700 (PDT)
Subject: [R-sig-Geo] Finding polygon centroid
In-Reply-To: <AANLkTimVyNyRE+ayZ4cfDtPCK0rR6j=1ttZUF29icdBw@mail.gmail.com>
Message-ID: <772126.62610.qm@web54307.mail.re2.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101018/624853a1/attachment.pl>

From ssefick at gmail.com  Tue Oct 19 00:59:09 2010
From: ssefick at gmail.com (stephen sefick)
Date: Mon, 18 Oct 2010 17:59:09 -0500
Subject: [R-sig-Geo] GRASS vector attribute table read into R
Message-ID: <AANLkTin_eW119iSpcu4FKwsK+sfX+huBKLfE51fAm1tM@mail.gmail.com>

I would like to just read in a vector table that is stored in the
GRASS dbf format into R.  Is there a way that I am over looking with
the spgrass6 package?  I can just go to the dbf file of the grass
mapset, but I was looking for a better option.  Thanks in advance.
kindest regards,

-- 
Stephen Sefick
____________________________________
| Auburn University? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?? |
| Department of Biological Sciences? ? ? ? ?? |
| 331 Funchess Hall? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? |
| Auburn, Alabama? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?? |
| 36849? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? |
|___________________________________|
| sas0025 at auburn.edu? ? ? ? ? ? ? ? ? ? ? ? ? ?? |
| http://www.auburn.edu/~sas0025? ? ? ? ? ?? |
|___________________________________|

Let's not spend our time and resources thinking about things that are
so little or so large that all they really do for us is puff us up and
make us feel like gods.? We are mammals, and have not exhausted the
annoying little problems of being mammals.

? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? -K. Mullis

"A big computer, a complex algorithm and a long time does not equal science."

? ? ? ? ? ? ? ? ? ? ? ? ? ? ? -Robert Gentleman

From Adrian.Baddeley at csiro.au  Tue Oct 19 03:25:45 2010
From: Adrian.Baddeley at csiro.au (Adrian.Baddeley at csiro.au)
Date: Tue, 19 Oct 2010 09:25:45 +0800
Subject: [R-sig-Geo] Tessellation error in spatstat
In-Reply-To: <7D41D4B7-ADD8-4270-99C5-4B0E9CCE1E49@auckland.ac.nz>
References: <A7F8EE3E-FF94-4CB9-8412-8A0F8CDB3502@auckland.ac.nz>
	<7D41D4B7-ADD8-4270-99C5-4B0E9CCE1E49@auckland.ac.nz>
Message-ID: <57DC18C299094D4299F837570C5DF1C52C92D9AF7B@EXWA-MBX01.nexus.csiro.au>

Richard Mort wrote (on R-help):

...................
> I have confocal images 512x512 from which I have extracted x,y positions of the coordiates 
> of labelled cells exported from ImageJ as a.csv file. I also have images that define an 
> underlying pattern in the tissue defined as areas of different pixel values 0 or 255 
> (also 512x512) I've exported these images as .txt files. I'd like to use spatstat to 
> look at how the individual cells plot onto these patterns.

> #I can import my x,y data and do basic stats with spatstat
>  by doing the following:

> library(spatstat)
> data01 <- read.csv("250810.csv", skip=1) 
> x <- data01[[2]]
> y <- data01[[3]]
> data02 <- ppp(x, y, xrange=c(0,512), yrange=c(0,512)) 
> unitname(data02) <- c("pixel", "pixels") 
> plot(data02)

> #I can also import my text images and convert them to a tessellation
> using the following:

> a <- read.table("FOLLICLES.txt")
> win <- owin(c(0,512), c(0,512))
> unitname(win) <- c("pixel", "pixels")
> b <- as.matrix(a, xrange=c(0,512), yrange=c(0,512)) 

      *** Error here ^^^ 

> unitname(b) <- c("pixel", "pixels")
> c <- im(b, xcol=seq(ncol(b)), yrow=seq(nrow(b)), unitname="pixels") 

      *** Error here ^^^ 

> d <- tess(image = c)
> plot(d)

> #I can then plot my ppp pattern on top of my tessellation using:
> plot(d)
> plot(data02, add=TRUE)

> #So far so good, but when I run for example:
> qb <- quadratcount(data02, tess = d)

> #I get the following error:

> Warning message:
> In quadratcount.ppp(data02, tess = d) :
>   Tessellation does not contain all the points of X

> #When I investigate further the following is returned for each object:

> > d
> Tessellation
> Tessellation is determined by a factor-valued image with 2 levels window: binary image mask
> 512 x 512 pixel array (ny, nx)
> enclosing rectangle: [0.5, 512.5] x [0.5, 512.5] pixels  
> > data02
>  planar point pattern: 254 points
> window: rectangle = [0, 512] x [0, 512] units

> #I don't understand why my tessellation is a different size but even
> taking this into account my ppp should plot inside the window 
> and does when i do plot(data02, add=TRUE). 
> I've spent ages playing around with redefining the windows but I must be missing something (probably obvious).
................................

The output shows that the enclosing rectangle for 'd' is [0.5, 512.5] x [0.5, 512.5] 
while the point pattern 'data02' is enclosed in the rectangle [0, 512] x [0, 512]. 
If there are data points which have x-coordinates between 0 and 0.5 (for example) then these points 
will lie outside the domain of the tessellation 'd', causing an error, although the problem 
would probably not be visible in a plot. This appears to have happened with the pattern 'data02'.

The problem is with the following commands

> b <- as.matrix(a, xrange=c(0,512), yrange=c(0,512)) 
> unitname(b) <- c("pixel", "pixels")
> c <- im(b, xcol=seq(ncol(b)), yrow=seq(nrow(b)), unitname="pixels") 

'as.matrix' is part of the base R system. It doesn't have arguments 'xrange', 'yrange'
and these will be ignored (silently!). So b is just an ordinary matrix.
Then in the call to 'im' you have specified the coordinates of the pixel CENTRES to be
(1,1), ...., (512, 512) and the pixels are squares of side 1, so the pixels cover the
rectangle [0.5, 512.5] x [0.5, 512.5]. 

If I understand correctly you want 'b' to be a 512 x 512 matrix, 
and 'c' to be an image defined on the rectangle [0, 512] x [0,512].
To do that, it's probably easiest to use 'as.im':

     b <- matrix(b, nrow=512)
     c <- as.im(b, owin(c(0,512),c(0,512)))

or more portably
 
     c <- as.im(b, as.owin(data02))

the last line ensures that the windows of 'data02' and 'c' are identical.

It's probably wise to avoid using 'c' as the name of a dataset, 
because 'c' is also a function name

regards
Adrian Baddeley


From dguignet at arec.umd.edu  Tue Oct 19 05:52:28 2010
From: dguignet at arec.umd.edu (Dennis Guignet)
Date: Mon, 18 Oct 2010 23:52:28 -0400
Subject: [R-sig-Geo] gwt2nb - regions with zero links
In-Reply-To: <alpine.LRH.2.00.1010172208300.27679@reclus.nhh.no>
References: <E7C57FAA7891B94DBA265B591642DE2587E24C7C4C@mail.arec.umd.edu>
	<alpine.LRH.2.00.1010172208300.27679@reclus.nhh.no>
Message-ID: <E7C57FAA7891B94DBA265B591642DE2588046E3A73@mail.arec.umd.edu>

Roger, 

Thank you for the suggestions.  I recently discovered that the issue was that I had included unique ids for some neighbors in the gwt file that were not included in the vector defining the unique ids that was inputted into the gwt2nb function.

Everything worked great (including the observations with no neighbors) after I made sure the same set of observations used to define the vector of unique ids were used creating the neighbor list.  

Thanks again for your help.

Denny

-----Original Message-----
From: Roger Bivand [mailto:Roger.Bivand at nhh.no] 
Sent: Sunday, October 17, 2010 4:14 PM
To: Dennis Guignet
Cc: r-sig-geo at stat.math.ethz.ch
Subject: Re: [R-sig-Geo] gwt2nb - regions with zero links

On Mon, 11 Oct 2010, Dennis Guignet wrote:

> Dear All,
>
> My end goal is to run a spatial lag model, where the weight matrix will 
> be nonsymmetric and contain observations with zero neighbors.  I am 
> having some difficulties in creating the neighbor list in R.  Any advice 
> or pointers on where to find more information would be greatly 
> appreciated.

Maybe try some other format, such as the MATLAB-style sparse matrix in 
read.dat2listw(). However then you cannot use your codes, just the 
sequence 1:n. If this doesn't help, put the file(s) on a website and post 
the link - debugging without the input data is hard. I can't follow how a 
region with only zero links has non-zero links (below).

Roger

>
> I needed to account for both time and space when defining a list of 
> neighbors, and did so first using ArcInfo and then SAS, and saved the 
> final list as a dbf.  It seems I next want to convert this dbf into a 
> neighbor list in R, and was told the best thing to do is save the dbf as 
> a gwt file and change the header line.  A brief portion is pasted below:
>
> 0 34451 nfred3 DGID
> 105450   105578   1
> 105451   105763   1
> 105451   105627   1
> 105451   105899   1
> 105451   105898   1
> 105451   105915   1
> 105452   105763   1
> 105452   105841   1
>
> nfred3 is the name of the gwt file, and DGID is the unique id for each 
> observation.  There are a total of 34,451 unique observations, some of 
> which do not have any neighbors and are thus not included in the above 
> gwt file.  If I run gwt2nb accounting for these zero link observations I 
> get the following warning messages:
>
>> DGID<-sales$dgid
>> length(DGID)
> [1] 34451
>> n2n<-read.gwt2nb("nfred3.gwt", region.id=DGID)
> Warning messages:
> 1: In read.gwt2nb("nfred3.gwt", region.id = DGID) :
>  region.id not named DGID
> 2: In read.gwt2nb("nfred3.gwt", region.id = DGID) :
>  105462, 105463, 105466, 105468, 105472, ...  [... truncated]
> 3: In read.gwt2nb("nfred3.gwt", region.id = DGID) :
>  105450, 105454, 105455, 105462, 105468, ... [... truncated]
>
> The issue is that there are a total of 1,555 regions with no links, but 
> 1,090 of these regions should have a positive number of links .  The 
> truncated list in the warning message contains id numbers that should 
> have zero links, as well as some that should have nonzero links.
>
> If I run similar code but only account for observations with nonzero 
> links, then I have the correct number of nonzero links. So this neighbor 
> list at first glance seems correct, but I still need to account for 
> observations with zero links when later forming the weights, and I am 
> concerned about the below warning messages.
>
>> #create vector of unique sale ids with nonzero spatial link (i.e. has neighbors)
>> n2n0<-read.table("nfred4.gwt",header=FALSE,skip=1)
>> DGID<-unique(n2n0$V1)
>> length(DGID)
> [1] 33986
>> n2n<-read.gwt2nb("nfred4.gwt", region.id=DGID)
> Warning messages:
> 1: In read.gwt2nb("nfred4.gwt", region.id = DGID) :
>  region.id not named DGID
> 2: In read.gwt2nb("nfred4.gwt", region.id = DGID) :
>  105450, 105454, 105455, 105470, ... [... truncated]
>
> Any advice or pointers of where I can find some helpful info would be 
> greatly appreciated.
>
> Thank you,
> Denny
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From karl at huftis.org  Tue Oct 19 12:48:12 2010
From: karl at huftis.org (Karl Ove Hufthammer)
Date: Tue, 19 Oct 2010 12:48:12 +0200
Subject: [R-sig-Geo] R 2.12.0 and rgdal
References: <i9hig9$c4r$1@dough.gmane.org>
	<alpine.LRH.2.00.1010181548200.3662@reclus.nhh.no>
	<alpine.LRH.2.00.1010181708360.8424@reclus.nhh.no>
Message-ID: <i9jt1c$957$1@dough.gmane.org>

Roger Bivand wrote:

>> setRepositories(ind=1:2)
>> install.packages("rgdal")
>>
>> but I don't have access now to a Windows installation, so cannot check
>> the incantation. If those interested could check, I'll summarise to the
>> list.
> 
> Two users have confirmed that the same incantation works. On my fresh
> 32-bit Windows R binary, my Packages -> Select repositories ... menu
> chooses both CRAN and CRAN (extras) by default, and when used the first
> time will replace CRAN by the mirror selected from a further menu.

Thanks. The reason the ?rgdal? package wasn?t available for me turned out 
simply be that only CRAN itself was allowed by our proxy server.

-- 
Karl Ove Hufthammer


From karl at huftis.org  Tue Oct 19 12:58:19 2010
From: karl at huftis.org (Karl Ove Hufthammer)
Date: Tue, 19 Oct 2010 12:58:19 +0200
Subject: [R-sig-Geo] Creating density heatmaps for geographical data
References: <i94fpq$356$1@dough.gmane.org>
	<AANLkTi=h=+QWsuOb0EjnkHT1raFsGV3kv9P7Ns2Hf_ZN@mail.gmail.com>
	<i9hbts$cj0$1@dough.gmane.org>
	<3CFD474A-0E56-44FF-B7C6-9EDA37FB4E87@auckland.ac.nz>
Message-ID: <i9jtkb$chr$1@dough.gmane.org>

Rolf Turner wrote:

>> 'ppp' objects used by 'spatstat' have an annoying structure
> 
> <SNIP>
> 
> Annoyance is in the mind of the beholder I think.  Personally I
> find the structure of ppp objects absolutely *delightful*! :-)
> 
> Also, they are simple, intuitive, easy to work with, and easy to
> understand, take apart, dissect, and manipulate.  Furthermore the
> tools in spatstat make it easy to do unto ppp objects pretty well
> anything one might want to do to a point pattern.  (I'm not being
> immodest here; the tools are mainly down to Adrian.)
> 
> Just what do you find ``annoying'' about the structure of ppp objects?

Well, I guess only the fact that they?re not ?sp? objects, really. And
that?s very annoying ? :)

And though the ?window? element of ?ppp? objects may be of use to some 
people, I haven?t had any use for it. The annoying thing here is that the 
constructor doesn?t generate the window automatically, based on the extent / 
bounding box of the data, and don?t have an *option* for doing this, either.
Whenever I have used ?spatstat? (not too often), I have had to spend too 
much time looking up how the window should be specified. Having [0,1] ? 
[0,1] as the *default* window, and excluding any points outside this does 
seems like a strange design decision.

-- 
Karl Ove Hufthammer


From thi_veloso at yahoo.com.br  Tue Oct 19 13:41:59 2010
From: thi_veloso at yahoo.com.br (Thiago Veloso)
Date: Tue, 19 Oct 2010 04:41:59 -0700 (PDT)
Subject: [R-sig-Geo] How to clip and interpolate data using shapefile as a
	boundary
Message-ID: <544562.80561.qm@web54307.mail.re2.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101019/f56b1d9d/attachment.pl>

From marcelino.delacruz at upm.es  Tue Oct 19 13:53:05 2010
From: marcelino.delacruz at upm.es (Marcelino de la Cruz)
Date: Tue, 19 Oct 2010 13:53:05 +0200
Subject: [R-sig-Geo] Creating density heatmaps for geographical data
In-Reply-To: <i9jtkb$chr$1@dough.gmane.org>
References: <i94fpq$356$1@dough.gmane.org>
	<AANLkTi=h=+QWsuOb0EjnkHT1raFsGV3kv9P7Ns2Hf_ZN@mail.gmail.com>
	<i9hbts$cj0$1@dough.gmane.org>
	<3CFD474A-0E56-44FF-B7C6-9EDA37FB4E87@auckland.ac.nz>
	<i9jtkb$chr$1@dough.gmane.org>
Message-ID: <201010191153.o9JBrAOs029904@smtp.upm.es>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101019/957ce00d/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Tue Oct 19 13:54:19 2010
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Tue, 19 Oct 2010 12:54:19 +0100
Subject: [R-sig-Geo] Creating density heatmaps for geographical data
In-Reply-To: <i9jtkb$chr$1@dough.gmane.org>
References: <i94fpq$356$1@dough.gmane.org>
	<AANLkTi=h=+QWsuOb0EjnkHT1raFsGV3kv9P7Ns2Hf_ZN@mail.gmail.com>
	<i9hbts$cj0$1@dough.gmane.org>
	<3CFD474A-0E56-44FF-B7C6-9EDA37FB4E87@auckland.ac.nz>
	<i9jtkb$chr$1@dough.gmane.org>
Message-ID: <AANLkTi=4xedv6vN8zzryeH=seKiSs9gSMefFk+WmDE0M@mail.gmail.com>

On Tue, Oct 19, 2010 at 11:58 AM, Karl Ove Hufthammer <karl at huftis.org> wrote:

> And though the ?window? element of ?ppp? objects may be of use to some
> people, I haven?t had any use for it. The annoying thing here is that the
> constructor doesn?t generate the window automatically, based on the extent /
> bounding box of the data, and don?t have an *option* for doing this, either.
> Whenever I have used ?spatstat? (not too often), I have had to spend too
> much time looking up how the window should be specified. Having [0,1] ?
> [0,1] as the *default* window, and excluding any points outside this does
> seems like a strange design decision.

 I had this 'argument' with Rolf and Adrian a few years ago during a
very nice stay in Perth with them. spatstat is not about (geo)spatial
data - it's about statistical point pattern analysis. A statistical
point pattern is only well-defined when there's a window. Otherwise it
aint a point pattern. And spatstat doesn't have any business with
non-spatial point patterns! :)

 There's a lot of functionality in spatstat that people want to use in
other contexts, such as some of the transformations or window
manipulation functions, and I think these could be usefully taken out
and put into a package that works with sp-class objects.

 But ppp objects are perfectly understandable and sensible if all you
do is point pattern analysis!

Barry


From roman.lustrik at gmail.com  Tue Oct 19 13:58:07 2010
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Tue, 19 Oct 2010 13:58:07 +0200
Subject: [R-sig-Geo] How to clip and interpolate data using shapefile as
	a boundary
In-Reply-To: <544562.80561.qm@web54307.mail.re2.yahoo.com>
References: <544562.80561.qm@web54307.mail.re2.yahoo.com>
Message-ID: <AANLkTineHuDwcf93G91go1F1wkHr=tup1ZzCAxeQ=p6y@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101019/d88a4b48/attachment.pl>

From Giovanni_Millo at Generali.com  Tue Oct 19 14:29:35 2010
From: Giovanni_Millo at Generali.com (Millo Giovanni)
Date: Tue, 19 Oct 2010 14:29:35 +0200
Subject: [R-sig-Geo] How to build a spatial weights list for pooled data
In-Reply-To: <mailman.9.1287396006.4701.r-sig-geo@stat.math.ethz.ch>
References: <mailman.9.1287396006.4701.r-sig-geo@stat.math.ethz.ch>
Message-ID: <28643F754DDB094D8A875617EC4398B206A9E018@BEMAILEXTV03.corp.generali.net>


Dear Roger, dear list:

regarding the simplest possible interpretation of Angela's question
below (Roger's first guess in the original email): making the proximity
matrix for a pooled model in "stacked cross-sections" notation, as (I_T
kronecker W), where W is the original, cross-sectional proximity matrix,
in order to 
- estimate the pooled model by lagsarlm() or errorsarlm()
- perform Moran's tests etc. on the pooled OLS model,
I'd like to add some considerations and ask for your insights. I
apologize in advance if I'm going out of topic.

It is fairly straightforward to transform W in 'listw' form to 'matrix',
do a kronecker product and retransform it back, like this:

library(spdep)
## Columbus data, as in example(errorsarlm)
data(oldcol)
COL.listw <- nb2listw(COL.nb, style="W")
## transform into 'matrix'
COL.mat <- listw2mat(COL.listw)
## make pooled W, e.g. T=3
COL.mat.p3 <- kronecker(diag(1,3), COL.mat)
## back to 'listw'
COL.listw.p3 <- mat2listw(COL.mat.p3)

so that a simple function that does the job might be:


poolW <- function(w, t) {
	return(mat2listw(kronecker(diag(1,t), listw2mat(w))))
}

The problem is, the 'style' of the 'listw' object is changed from "W" to
generic "M", as can readily be seen:
 
COL.listw$style    ## this is "W"
COL.listw.p3$style ## ...and this is the generic style "M"

This change in the 'style' has consequences when trying to use the
advanced/fast options for the calculation of the Jacobian's determinant
(method="spam" or method="Matrix"), which do work only with 'listw's of
style "B", "C", "W" and "S". For this reason, it is for example not
possible to do

errorsarlm(formula, data, listw=COL.listw.p3, method="spam") ## not run
(*)

without getting a (rather verbose) error because of the listw being
transformed into an inappropriate kind of matrix.

Yet the weights obtained by the above procedure **seem** to be
consistent with the "W" style as well, despite 'mat2listw' not knowing
what happened upstream and thus assigning the most general "M" style. In
my current work on spatial panels I needed to transform a (huge) matrix
to listw with 'style="W"' (without having the original shapefiles, or
'nb' etc.), and I had some success by using mat2lisw() and then manually
setting the $style to "W"  and setting the $d component of the 'weights'
attribute to the appropriate (?) value by hand, like this:

COL.listw.p3$style <- "W"
attr(COL.listw.p3$weights,
"comp")$d<-unlist(lapply(COL.listw.p3$weights, length))
 
after which the above code line (*) looks like working fine, despite
some very small differences in the estimated lambda parameter, possibly
inherent to the different method? I still wonder whether this very dirty
procedure really gives reliable results...

All in all, though, **if**, as Roger put it, 
- Angela means an NxT by NxT matrix
- N and T are small enough for the Jacobian to be treated with plain
vanilla methods
- and there are no spatial correlations between the different
cross-sections,
the above code might solve her problem.

I'll be grateful for any insights re: coercion to "W" of the $style
attribute.
Cheers,
Giovanni

Giovanni Millo
Research Dept.,
Assicurazioni Generali SpA
Via Machiavelli 4, 
34132 Trieste (Italy)
tel. +39 040 671184 
fax  +39 040 671160 

-------------- Original message ----------------

Message: 5
Date: Mon, 18 Oct 2010 08:58:15 +0200 (CEST)
From: Roger Bivand <>
To: Angela Parenti <>
Cc: r-sig-geo at stat.math.ethz.ch, Davide Fiaschi
	<dfiaschi at ec.unipi.it>,	Mario A Lavezzi <lavezzi at unipa.it>
Subject: 
Message-ID: <alpine.LRH.2.00.1010180849050.3192 at reclus.nhh.no>
Content-Type: TEXT/PLAIN; format=flowed; charset=US-ASCII

On Thu, 14 Oct 2010, Angela Parenti wrote:

>
> Hello Roger and everybody else.
>
> I have another question about Weight Matrices. For one of my models I 
> estimate a pooled regression. Then, in order run the Moran test on the
pooled 
> regression residuals I need to construct a spatial weights list of the
same 
> dimension.
> I already found the way for the spatial matrix built on the inverse
distance 
> between neighbours. Here the code for inverse distance matrix:
>
> #####################
> # Moran's Test for spatial effects
> sampleCentroid.Pooled <- 
>
rbind(samplecentroid.europeReorderedCamEcon,samplecentroid.europeReorder
edCamEcon)
> eu.regions.nb_pooled <- dnearneigh(sampleCentroid.Pooled[iii,], 0, 
> max(distanceMatrix), row.names=NULL, longlat=TRUE)
> coords_pooled <- sampleCentroid.Pooled[iii,]
> dlist_pooled <- nbdists(eu.regions.nb_pooled, coords_pooled,
longlat=TRUE)
>
> dlist1_pooled <- lapply(dlist_pooled, function(x) 1/(x^2))
> eu.regions.w1_pooled <- nb2listw(eu.regions.nb_pooled,
glist=dlist1_pooled, 
> style="W", zero.policy=TRUE)
>
> moranTestmodelI_w1 <- lm.morantest(modelI, 
> eu.regions.w1_pooled,zero.policy=TRUE, alternative="two.sided")
> print(rbind(c("Global Moran's I for Model I","w1_EK","bivand",""),
>           c("Observed Moran's I", "EI", "VI", "p-value"),
>
c(as.numeric(moranTestmodelI_w1$estimate[1]),as.numeric(moranTestmodelI_
w1$estimate[2]),
>
as.numeric(moranTestmodelI_w1$estimate[3]),moranTestmodelI_w1$p.value)
>           ))
> ######################
>
> Differently, I didn't understand yet how to build a spatial weights
list for 
> pooled data in case of first-order contiguity matrix. Can you help me?

By "pooled", do you mean an NxT by NxT matrix? Is your data 
spatio-temporal in that case? How large is N, and how large T? Did your 
IDW procedure induce "spatial" relations above and below the block 
diagonal, or do you just need T replicated N by N weights matrices down 
the block diagonal? You may have a result from IDW, but is it what you 
think it is - should d_{itjt} == d_{itj(t-1)} == d_{itj(t+1)} and so on?

To create a contiguity matrix, you can use graph-based methods listed 
under ?graph2nb or contiguity using ?poly2nb, for which you do need the 
boundaries of your regions as for example a shapefile.

Roger

>
> Thank you in advance,
> Angela Parenti
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

-------------- End original message ----------------

 
Ai sensi del D.Lgs. 196/2003 si precisa che le informazi...{{dropped:13}}


From jeremy.raw at dot.gov  Tue Oct 19 15:52:53 2010
From: jeremy.raw at dot.gov (jeremy.raw at dot.gov)
Date: Tue, 19 Oct 2010 09:52:53 -0400
Subject: [R-sig-Geo] Creating density heatmaps for geographical data
In-Reply-To: <AANLkTi=4xedv6vN8zzryeH=seKiSs9gSMefFk+WmDE0M@mail.gmail.com>
References: <i94fpq$356$1@dough.gmane.org><AANLkTi=h=+QWsuOb0EjnkHT1raFsGV3kv9P7Ns2Hf_ZN@mail.gmail.com><i9hbts$cj0$1@dough.gmane.org><3CFD474A-0E56-44FF-B7C6-9EDA37FB4E87@auckland.ac.nz><i9jtkb$chr$1@dough.gmane.org>
	<AANLkTi=4xedv6vN8zzryeH=seKiSs9gSMefFk+WmDE0M@mail.gmail.com>
Message-ID: <B3C9A56C0E6FBF48A7D3ED79E9A7A9C003868817@OSTMAIL03VS3.ad.dot.gov>

I'll offer my two cents as someone who has been using spatstat a lot recently to do spatial point process analysis.

I think it's an entirely useful when organizing spatial analysis libraries to look at the sp package as a master package for getting spatial data in and out of R and for performing basic metadata operations on such data (so one can simplify a lot by using OGR/GDAL or projection functionality through this interface).

Packages like spatstat (or raster, or whatever) might include some shortcuts to directly import common data from the world at large, but they are also armed with functions to convert in and out of sp data types (so the burden of wide-ranging input/output formats and geospatial projection is carried through sp).  The main need for data conversion functions in packages like spatstat is to take data in forms the user is likely to have and convert them into a structure that permits efficient application of the algorithms to which the package is dedicated (spatial point process, raster evaluation, etc.).  So I have nothing wrong with spatstat working with its own specialized types that can be built out of more general spatial data.  In fact, I even think it's rather nice to do that, because it helps one form an effective mental map of what you're doing and thus avoid some basic errors (e.g. trying to get meaningful spatial point process analyses when you haven't identified a window).

For novices trying to get their minds around what is going on with R spatial packages, that observation suggests the useful strategy of first trying to understand each package in its own terms (why was it created, what is it supposed to do, what functions does it provide, and what are the requirements of the data structures on which those functions operate), then trying to match one's own problem to the package functionality, and finally gluing the data and operations together with a minimal set of conversions.  Naturally, that's an iterative process in practice.  But that approach has helped me avoid the perilous shortcut of simply trying to apply function X from package P to my data D (which inevitably means that I impose my own fantasy of what X should do, and then bog down dealing with "bugs" that emerge directly from my own lack of understanding of how the problem, the tools, and the data properly fit together).

>From a package interface standpoint, I think a significant source of confusion for newcomers is the fact that you can do (for example) raster calculations on lots of different types of objects, using different functions, with different interfaces:  an im object in spatstat, for example, would use 'eval.im', but raster provides the 'calc' function, and sp lets you do basic data-frame computations transparently.  And of course, there's the fact that the standard plotting facilities for each of these packages provide different defaults and capabilities (which for me is the biggest headache -- I end up doing a lot of data conversions just so I don't have to remember all the alternative options and defaults).

This gets to Barry's point about spatstat (or almost any well-developed spatial package) providing a lot of functionality that supports the primary mission, but that also has more general applicability.  For users who specialize in spatial point process analysis, it's very nice to have a complete set of tools on hand in spatstat so you don't have to go hunting around.  But the pitfall is that if you add a lot of "extras", it encourages users to expect that the "perilous shortcut" I described above is available to them (that they can just throw random data at a function they only half understand and magically get the answer they are looking for).

In the long run, it would probably be helpful (perhaps in sp or some supporting package such as maptools or rgeos) to "establish" some generic functions for additional operations such as raster calculations that can be specialized in a package around a common interface so that common geospatial functions can easily be perceived as common.  But the example of what has happened with the spplot output functions in sp (specifically, that specializations are not widely available in other packages) is perhaps a cautionary tale about how such an approach is likely to work in practice.  I suspect this kind of anarchy reflects both the strength and weakness of distributed package development by unrelated teams:  each team does what they need (including supporting tools) with greater or lesser attention to what might be available in the larger environment or other packages.  Teams and users then end up working with whatever version of the overlapping functionality that they find easiest and most comprehensible.  That's good, because such "competition" and selection helps drive innovation as we all collectively contribute to figuring out what works best.  But it's also bad, especially for novices who end up writing strange mash-ups of data conversions, performing the same operation here and there with partially equivalent functions from several different packages, and struggling with general confusion about what's going on and why.

Notwithstanding the challenges, I am deeply grateful to all the R spatial developers who have put together this amazing set of useful resources...

Jeremy Raw, P.E., AICP
FHWA Office of Planning
jeremy.raw at dot.gov
(202) 366-0986


-----Original Message-----
From: r-sig-geo-bounces at stat.math.ethz.ch [mailto:r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of Barry Rowlingson
Sent: Tuesday, October 19, 2010 7:54 AM
To: Karl Ove Hufthammer
Cc: r-sig-geo at stat.math.ethz.ch
Subject: Re: [R-sig-Geo] Creating density heatmaps for geographical data

On Tue, Oct 19, 2010 at 11:58 AM, Karl Ove Hufthammer <karl at huftis.org> wrote:

> And though the 'window' element of 'ppp' objects may be of use to some
> people, I haven't had any use for it. The annoying thing here is that the
> constructor doesn't generate the window automatically, based on the extent /
> bounding box of the data, and don't have an *option* for doing this, either.
> Whenever I have used 'spatstat' (not too often), I have had to spend too
> much time looking up how the window should be specified. Having [0,1] ?
> [0,1] as the *default* window, and excluding any points outside this does
> seems like a strange design decision.

 I had this 'argument' with Rolf and Adrian a few years ago during a
very nice stay in Perth with them. spatstat is not about (geo)spatial
data - it's about statistical point pattern analysis. A statistical
point pattern is only well-defined when there's a window. Otherwise it
aint a point pattern. And spatstat doesn't have any business with
non-spatial point patterns! :)

 There's a lot of functionality in spatstat that people want to use in
other contexts, such as some of the transformations or window
manipulation functions, and I think these could be usefully taken out
and put into a package that works with sp-class objects.

 But ppp objects are perfectly understandable and sensible if all you
do is point pattern analysis!

Barry

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at stat.math.ethz.ch
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From isabelle.boulangeat at gmail.com  Tue Oct 19 16:50:22 2010
From: isabelle.boulangeat at gmail.com (isabelle boulangeat)
Date: Tue, 19 Oct 2010 16:50:22 +0200
Subject: [R-sig-Geo]  Extract xy values from a SpatialPolygon
Message-ID: <AANLkTimF5MzKqnATMBsG=nfZkeoXgGqc0xdLzowj-jm4@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101019/a229029f/attachment.pl>

From roman.lustrik at gmail.com  Tue Oct 19 17:39:14 2010
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Tue, 19 Oct 2010 17:39:14 +0200
Subject: [R-sig-Geo] Extract xy values from a SpatialPolygon
In-Reply-To: <AANLkTimF5MzKqnATMBsG=nfZkeoXgGqc0xdLzowj-jm4@mail.gmail.com>
References: <AANLkTimF5MzKqnATMBsG=nfZkeoXgGqc0xdLzowj-jm4@mail.gmail.com>
Message-ID: <AANLkTikA2=uXLphBve5sMbGB21LXJ9qHxAKMRaKHtOFv@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101019/acbc1cf7/attachment.pl>

From r.hijmans at gmail.com  Tue Oct 19 17:55:33 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 19 Oct 2010 08:55:33 -0700
Subject: [R-sig-Geo] Extract xy values from a SpatialPolygon
In-Reply-To: <AANLkTimF5MzKqnATMBsG=nfZkeoXgGqc0xdLzowj-jm4@mail.gmail.com>
References: <AANLkTimF5MzKqnATMBsG=nfZkeoXgGqc0xdLzowj-jm4@mail.gmail.com>
Message-ID: <AANLkTinYYgbxD4hUAiaay42U2xmNw1Gcrx9GauNbksoB@mail.gmail.com>

Isabelle, You can use the sp function 'overlay'. Robert

On Tue, Oct 19, 2010 at 7:50 AM, isabelle boulangeat
<isabelle.boulangeat at gmail.com> wrote:
> Dear list members,
>
> Does anybody have suggestions to extract xy values from a SpatialPolygon.
> The equivalent for xyValues in the package raster.
>
> Regards,
>
> Isabelle.
>
> --
> Isabelle Boulangeat, PhD student
> Ecosystem dynamics and plant traits
>
> Bureau 203, +33 (0) 476 635 733
>
> Laboratoire d'?cologie Alpine (LECA)
> Grenoble, France
> lab' s website : http://www-leca.ujf-grenoble.fr/
> my website : http://j.boulangeat.free.fr/
>
> ? ? ? ?[[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


From Roger.Bivand at nhh.no  Tue Oct 19 19:03:16 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 19 Oct 2010 19:03:16 +0200 (CEST)
Subject: [R-sig-Geo] How to build a spatial weights list for pooled data
In-Reply-To: <28643F754DDB094D8A875617EC4398B206A9E018@BEMAILEXTV03.corp.generali.net>
References: <mailman.9.1287396006.4701.r-sig-geo@stat.math.ethz.ch>
	<28643F754DDB094D8A875617EC4398B206A9E018@BEMAILEXTV03.corp.generali.net>
Message-ID: <alpine.LRH.2.00.1010191854340.13298@reclus.nhh.no>

On Tue, 19 Oct 2010, Millo Giovanni wrote:

>
> Dear Roger, dear list:
>
> regarding the simplest possible interpretation of Angela's question
> below (Roger's first guess in the original email): making the proximity
> matrix for a pooled model in "stacked cross-sections" notation, as (I_T
> kronecker W), where W is the original, cross-sectional proximity matrix,
> in order to
> - estimate the pooled model by lagsarlm() or errorsarlm()
> - perform Moran's tests etc. on the pooled OLS model,
> I'd like to add some considerations and ask for your insights. I
> apologize in advance if I'm going out of topic.
>
> It is fairly straightforward to transform W in 'listw' form to 'matrix',
> do a kronecker product and retransform it back, like this:
>
> library(spdep)
> ## Columbus data, as in example(errorsarlm)
> data(oldcol)
> COL.listw <- nb2listw(COL.nb, style="W")
> ## transform into 'matrix'
> COL.mat <- listw2mat(COL.listw)
> ## make pooled W, e.g. T=3
> COL.mat.p3 <- kronecker(diag(1,3), COL.mat)
> ## back to 'listw'
> COL.listw.p3 <- mat2listw(COL.mat.p3)
>
> so that a simple function that does the job might be:
>
>
> poolW <- function(w, t) {
> 	return(mat2listw(kronecker(diag(1,t), listw2mat(w))))
> }
>
> The problem is, the 'style' of the 'listw' object is changed from "W" to
> generic "M", as can readily be seen:
>
> COL.listw$style    ## this is "W"
> COL.listw.p3$style ## ...and this is the generic style "M"
>
> This change in the 'style' has consequences when trying to use the
> advanced/fast options for the calculation of the Jacobian's determinant
> (method="spam" or method="Matrix"), which do work only with 'listw's of
> style "B", "C", "W" and "S". For this reason, it is for example not
> possible to do
>
> errorsarlm(formula, data, listw=COL.listw.p3, method="spam") ## not run
> (*)
>
> without getting a (rather verbose) error because of the listw being
> transformed into an inappropriate kind of matrix.
>
> Yet the weights obtained by the above procedure **seem** to be
> consistent with the "W" style as well, despite 'mat2listw' not knowing
> what happened upstream and thus assigning the most general "M" style.

mat2listw() can be passed an arbitrary square matrix, so it cannot set the 
style component unless it runs nb2listw() internally with a given style. 
The function could be edited to do this, but the user can also do it 
externally. If you'd prefer to have a:

mat2listw <- function(x, row.names=NULL, style="M") {
...

where setting the style= argument to something other than "M" would lead 
to nb2listw() being called, please let me know.

Hope this helps,

Roger


> In my current work on spatial panels I needed to transform a (huge) 
> matrix to listw with 'style="W"' (without having the original 
> shapefiles, or 'nb' etc.), and I had some success by using mat2lisw() 
> and then manually setting the $style to "W"  and setting the $d 
> component of the 'weights' attribute to the appropriate (?) value by 
> hand, like this:
>
> COL.listw.p3$style <- "W"
> attr(COL.listw.p3$weights,
> "comp")$d<-unlist(lapply(COL.listw.p3$weights, length))
>
> after which the above code line (*) looks like working fine, despite
> some very small differences in the estimated lambda parameter, possibly
> inherent to the different method? I still wonder whether this very dirty
> procedure really gives reliable results...
>
> All in all, though, **if**, as Roger put it,
> - Angela means an NxT by NxT matrix
> - N and T are small enough for the Jacobian to be treated with plain
> vanilla methods
> - and there are no spatial correlations between the different
> cross-sections,
> the above code might solve her problem.
>
> I'll be grateful for any insights re: coercion to "W" of the $style
> attribute.
> Cheers,
> Giovanni
>
> Giovanni Millo
> Research Dept.,
> Assicurazioni Generali SpA
> Via Machiavelli 4,
> 34132 Trieste (Italy)
> tel. +39 040 671184
> fax  +39 040 671160
>
> -------------- Original message ----------------
>
> Message: 5
> Date: Mon, 18 Oct 2010 08:58:15 +0200 (CEST)
> From: Roger Bivand <>
> To: Angela Parenti <>
> Cc: r-sig-geo at stat.math.ethz.ch, Davide Fiaschi
> 	<dfiaschi at ec.unipi.it>,	Mario A Lavezzi <lavezzi at unipa.it>
> Subject:
> Message-ID: <alpine.LRH.2.00.1010180849050.3192 at reclus.nhh.no>
> Content-Type: TEXT/PLAIN; format=flowed; charset=US-ASCII
>
> On Thu, 14 Oct 2010, Angela Parenti wrote:
>
>>
>> Hello Roger and everybody else.
>>
>> I have another question about Weight Matrices. For one of my models I
>> estimate a pooled regression. Then, in order run the Moran test on the
> pooled
>> regression residuals I need to construct a spatial weights list of the
> same
>> dimension.
>> I already found the way for the spatial matrix built on the inverse
> distance
>> between neighbours. Here the code for inverse distance matrix:
>>
>> #####################
>> # Moran's Test for spatial effects
>> sampleCentroid.Pooled <-
>>
> rbind(samplecentroid.europeReorderedCamEcon,samplecentroid.europeReorder
> edCamEcon)
>> eu.regions.nb_pooled <- dnearneigh(sampleCentroid.Pooled[iii,], 0,
>> max(distanceMatrix), row.names=NULL, longlat=TRUE)
>> coords_pooled <- sampleCentroid.Pooled[iii,]
>> dlist_pooled <- nbdists(eu.regions.nb_pooled, coords_pooled,
> longlat=TRUE)
>>
>> dlist1_pooled <- lapply(dlist_pooled, function(x) 1/(x^2))
>> eu.regions.w1_pooled <- nb2listw(eu.regions.nb_pooled,
> glist=dlist1_pooled,
>> style="W", zero.policy=TRUE)
>>
>> moranTestmodelI_w1 <- lm.morantest(modelI,
>> eu.regions.w1_pooled,zero.policy=TRUE, alternative="two.sided")
>> print(rbind(c("Global Moran's I for Model I","w1_EK","bivand",""),
>>           c("Observed Moran's I", "EI", "VI", "p-value"),
>>
> c(as.numeric(moranTestmodelI_w1$estimate[1]),as.numeric(moranTestmodelI_
> w1$estimate[2]),
>>
> as.numeric(moranTestmodelI_w1$estimate[3]),moranTestmodelI_w1$p.value)
>>           ))
>> ######################
>>
>> Differently, I didn't understand yet how to build a spatial weights
> list for
>> pooled data in case of first-order contiguity matrix. Can you help me?
>
> By "pooled", do you mean an NxT by NxT matrix? Is your data
> spatio-temporal in that case? How large is N, and how large T? Did your
> IDW procedure induce "spatial" relations above and below the block
> diagonal, or do you just need T replicated N by N weights matrices down
> the block diagonal? You may have a result from IDW, but is it what you
> think it is - should d_{itjt} == d_{itj(t-1)} == d_{itj(t+1)} and so on?
>
> To create a contiguity matrix, you can use graph-based methods listed
> under ?graph2nb or contiguity using ?poly2nb, for which you do need the
> boundaries of your regions as for example a shapefile.
>
> Roger
>
>>
>> Thank you in advance,
>> Angela Parenti
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From r.turner at auckland.ac.nz  Tue Oct 19 21:24:56 2010
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Wed, 20 Oct 2010 08:24:56 +1300
Subject: [R-sig-Geo] Creating density heatmaps for geographical data
In-Reply-To: <i9jtkb$chr$1@dough.gmane.org>
References: <i94fpq$356$1@dough.gmane.org>
	<AANLkTi=h=+QWsuOb0EjnkHT1raFsGV3kv9P7Ns2Hf_ZN@mail.gmail.com>
	<i9hbts$cj0$1@dough.gmane.org>
	<3CFD474A-0E56-44FF-B7C6-9EDA37FB4E87@auckland.ac.nz>
	<i9jtkb$chr$1@dough.gmane.org>
Message-ID: <C7EEE8C8-E321-4FA8-AB67-6C3C12B79116@auckland.ac.nz>


The spatstat package is designed for the analysis of spatial point
patterns.  In this context the existence of a window --- the
*observation* window --- is absolutely crucial.  You have to know where
points have been *looked for*, because there is information in where
the points aren't, as well as in where they are.  And you can't say
anything about where they aren't unless you know where they have been
looked for.

If you are putting spatstat to other uses where the nature of the process
generating the points is not of interest, and you want a default window
which has the nature of a bounding box, then this is easy to arrange.
E.g. you could write your own simple little utility, say

ppp_koh <- function(x,y,wrecked=TRUE,f,marks=NULL) {
require(spatstat)
ppp(x,y,window=ripras(x,y,shape=if(wrecked) "rectangle" else "convex",f=f),marks=marks)
}

Then you can do things like:
set.seed(42)
x <- runif(100,3,7)
y <- runif(100,-2,9)
X <- ppp_koh(x,y)

Note that by default the ripras() function called by ppp_koh() expands the
bounding box of the points slightly from extent of the data (to give a ``maximum
likelihood estimate'' of the bounding box).

If you don't want this expansion then specify f=1:

Y <- ppp_koh(x,y,f=1)

Note that this will cause at least two points of the pattern (and probably
four or more) to lie on the boundary of the window.

In genuine spatial point process applications one is advised to eschew
the use of the ripras() function.

	cheers,

		Rolf

On 19/10/2010, at 11:58 PM, Karl Ove Hufthammer wrote:

> Rolf Turner wrote:
> 
>>> 'ppp' objects used by 'spatstat' have an annoying structure
>> 
>> <SNIP>
>> 
>> Annoyance is in the mind of the beholder I think.  Personally I
>> find the structure of ppp objects absolutely *delightful*! :-)
>> 
>> Also, they are simple, intuitive, easy to work with, and easy to
>> understand, take apart, dissect, and manipulate.  Furthermore the
>> tools in spatstat make it easy to do unto ppp objects pretty well
>> anything one might want to do to a point pattern.  (I'm not being
>> immodest here; the tools are mainly down to Adrian.)
>> 
>> Just what do you find ``annoying'' about the structure of ppp objects?
> 
> Well, I guess only the fact that they?re not ?sp? objects, really. And
> that?s very annoying ? :)
> 
> And though the ?window? element of ?ppp? objects may be of use to some 
> people, I haven?t had any use for it. The annoying thing here is that the 
> constructor doesn?t generate the window automatically, based on the extent / 
> bounding box of the data, and don?t have an *option* for doing this, either.
> Whenever I have used ?spatstat? (not too often), I have had to spend too 
> much time looking up how the window should be specified. Having [0,1] ? 
> [0,1] as the *default* window, and excluding any points outside this does 
> seems like a strange design decision.


From thi_veloso at yahoo.com.br  Tue Oct 19 22:06:29 2010
From: thi_veloso at yahoo.com.br (Thiago Veloso)
Date: Tue, 19 Oct 2010 13:06:29 -0700 (PDT)
Subject: [R-sig-Geo] How to clip and interpolate data using shapefile as
	a boundary
In-Reply-To: <AANLkTineHuDwcf93G91go1F1wkHr=tup1ZzCAxeQ=p6y@mail.gmail.com>
Message-ID: <230531.56498.qm@web54307.mail.re2.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101019/6e113cc7/attachment.pl>

From r.hijmans at gmail.com  Tue Oct 19 22:19:59 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 19 Oct 2010 13:19:59 -0700
Subject: [R-sig-Geo] How to clip and interpolate data using shapefile as
	a boundary
In-Reply-To: <230531.56498.qm@web54307.mail.re2.yahoo.com>
References: <AANLkTineHuDwcf93G91go1F1wkHr=tup1ZzCAxeQ=p6y@mail.gmail.com>
	<230531.56498.qm@web54307.mail.re2.yahoo.com>
Message-ID: <AANLkTi=z1UKMQ0C87N89Z=OpLF7B5LdKAf2wwGs5pzzj@mail.gmail.com>

Thiago,

You could get the bbox(polygon) and then subset the points for the
area of the polygon (keeping points just outside of it) and use these
points in e.g. gstat if you want to interpolate.

You can also turn this into a SpatialPointsDataFrame object and use
gridded(obj) = TRUE

In raster, to avoid the strips, you could try:
rprecip<-raster(xmn=-82.90,xmx=-34.30,ymn=-50.30,ymx=12.10)
res(rprecip) = 0.2
(i.e. assure that the resolution matches your data, and that points
fall in the center, not the intersections of, grid cell).

Hope this helps,

Robert


On Tue, Oct 19, 2010 at 1:06 PM, Thiago Veloso <thi_veloso at yahoo.com.br> wrote:
> ??Thank you, Roman.
> ??I was following that topic, but my case is slightly different. I have a xyz ascii file which needs to be converted to raster. With your tip I have read the reference manual of "raster" package and found the rasterfromXYZ function.
> ??However, I am facing some troubles during this conversion. Below I am reproducing (with my data) the example demonstrated in the reference manual:
>> prec_ETA<-read.csv("AS_2010010112_obs20km.txt",sep=";",header=F)> prec_ETA<-na.omit(prec_ETA)> head(prec_ETA)?? ? V1 ? ?V2 ? V31 -82.8 -50.2 0.002 -82.8 -50.0 1.363 -82.8 -49.8 2.864 -82.8 -49.6 3.635 -82.8 -49.4 3.266 -82.8 -49.2 3.40> rprecip<-raster(nrow=244,ncol=312,xmn=-82.80,xmx=-34.20,ymn=-50.20,ymx=12.00)> cells <- cellFromXY(rprecip, prec_ETA[,1:2])> rprecip[cells] <- prec_ETA[,3]> plot(rprecip)
> ??When plotting the resulting raster, something seems to be wrong. The map contains unwanted strips, as seen at this link:?http://img140.imageshack.us/img140/4994/plotrprecip.png
> ??So, I don't know where I'm going wrong... Any ideas?
> ??Cheers,
> ??Thiago.
> --- On Tue, 19/10/10, Roman Lu?trik <roman.lustrik at gmail.com> wrote:
>
> From: Roman Lu?trik <roman.lustrik at gmail.com>
> Subject: Re: [R-sig-Geo] How to clip and interpolate data using shapefile as a boundary
> To: "Thiago Veloso" <thi_veloso at yahoo.com.br>
> Cc: "R SIG list" <r-sig-geo at stat.math.ethz.ch>
> Date: Tuesday, 19 October, 2010, 9:58
>
> You can easily clip rasters with polygons (or other rasters) via raster package.
>
> See this recent thread for one example using crop() and polygonsToRaster() functions. Other than that, the packages has comprehensive vignettes and maybe that's the place to start.
>
>
>
> Cheers,
> Roman
>
>
>
>
> On Tue, Oct 19, 2010 at 1:41 PM, Thiago Veloso <thi_veloso at yahoo.com.br> wrote:
>
>
> ??Dear R-SIGgers,
>
> ??My current rainfall dataset (ascii, at 0.2 degree resolution) spans the entire South America and has been loaded into R as a xyz variable:
>
>> summary(prec_data)?? ? ? V1 ? ? ? ? ? ? ? V2 ? ? ? ? ? ? ? V3 ? ? ? ???Min. ? :-82.80 ? Min. ? :-50.20 ? Min. ? : ?0.000 ??1st Qu.:-70.65 ? 1st Qu.:-34.65 ? 1st Qu.: ?0.000 ??Median :-58.50 ? Median :-19.10 ? Median : ?0.000 ??Mean ? :-58.50 ? Mean ? :-19.10 ? Mean ? : ?4.002 ??3rd Qu.:-46.35 ? 3rd Qu.: -3.55 ? 3rd Qu.: ?2.430 ??Max. ? :-34.20 ? Max. ? : 12.00 ? Max. ? :250.150 ?> head(prec_data)?? ? V1 ? ?V2 ? V31 -82.8 -50.2 0.002 -82.8 -50.0 1.363 -82.8 -49.8 2.864 -82.8 -49.6 3.635 -82.8 -49.4 3.266 -82.8 -49.2 3.40>
>
>
>
> ??My objectives are the following:
>
> ??1) Clip the data using a shapefile;
>
> ??2) In order to completely fill the area with rainfall information, perform a interpolation technique (IDW or kriging) using as boundary the same shapefile above. This will allow me to generate risk maps for the occurence of a certain plant disease.
>
>
>
> ??Could anybody please point me the directions on how to do this?
>
> ??Thanks in advance,
>
> ??Thiago.
>
>
>
>
>
>
>
> ?? ? ? ?[[alternative HTML version deleted]]
>
>
>
>
> _______________________________________________
>
> R-sig-Geo mailing list
>
> R-sig-Geo at stat.math.ethz.ch
>
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>
>
>
> --
> In God we trust, all others bring data.
>
>
>
>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


From Roger.Bivand at nhh.no  Tue Oct 19 22:24:57 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 19 Oct 2010 22:24:57 +0200 (CEST)
Subject: [R-sig-Geo] GRASS vector attribute table read into R
In-Reply-To: <AANLkTin_eW119iSpcu4FKwsK+sfX+huBKLfE51fAm1tM@mail.gmail.com>
References: <AANLkTin_eW119iSpcu4FKwsK+sfX+huBKLfE51fAm1tM@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1010191905230.13298@reclus.nhh.no>

On Mon, 18 Oct 2010, stephen sefick wrote:

> I would like to just read in a vector table that is stored in the
> GRASS dbf format into R.  Is there a way that I am over looking with
> the spgrass6 package?  I can just go to the dbf file of the grass
> mapset, but I was looking for a better option.  Thanks in advance.
> kindest regards,

Stephen,

Do you mean read the GRASS vector, or just the DBF file? If the vector 
with its attributes, readVECT6() in spgrass6, which I think you know of. 
Otherwise, perhaps:

zz <- execGRASS("db.select", parameters=list(table="newbugs"),
   intern=TRUE)
con <- textConnection(zz)
zzz <- read.table(con, header=TRUE, sep="|")
close(con)

Hope this helps,

Roger


>
> -- 
> Stephen Sefick
> ____________________________________
> | Auburn University? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?? |
> | Department of Biological Sciences? ? ? ? ?? |
> | 331 Funchess Hall? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? |
> | Auburn, Alabama? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?? |
> | 36849? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? |
> |___________________________________|
> | sas0025 at auburn.edu? ? ? ? ? ? ? ? ? ? ? ? ? ?? |
> | http://www.auburn.edu/~sas0025? ? ? ? ? ?? |
> |___________________________________|
>
> Let's not spend our time and resources thinking about things that are
> so little or so large that all they really do for us is puff us up and
> make us feel like gods.? We are mammals, and have not exhausted the
> annoying little problems of being mammals.
>
> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? -K. Mullis
>
> "A big computer, a complex algorithm and a long time does not equal science."
>
> ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? -Robert Gentleman
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From sarah.goslee at gmail.com  Tue Oct 19 22:26:43 2010
From: sarah.goslee at gmail.com (Sarah Goslee)
Date: Tue, 19 Oct 2010 16:26:43 -0400
Subject: [R-sig-Geo] GRASS vector attribute table read into R
In-Reply-To: <alpine.LRH.2.00.1010191905230.13298@reclus.nhh.no>
References: <AANLkTin_eW119iSpcu4FKwsK+sfX+huBKLfE51fAm1tM@mail.gmail.com>
	<alpine.LRH.2.00.1010191905230.13298@reclus.nhh.no>
Message-ID: <AANLkTi=HhJ3_zh_yOG31aH=n_Bi=APJR36D_HEto36uk@mail.gmail.com>

An even more straight-forward way is to use read.dbf() from the
foreign package.

Sarah

On Tue, Oct 19, 2010 at 4:24 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> On Mon, 18 Oct 2010, stephen sefick wrote:
>
>> I would like to just read in a vector table that is stored in the
>> GRASS dbf format into R. ?Is there a way that I am over looking with
>> the spgrass6 package? ?I can just go to the dbf file of the grass
>> mapset, but I was looking for a better option. ?Thanks in advance.
>> kindest regards,
>
> Stephen,
>
> Do you mean read the GRASS vector, or just the DBF file? If the vector with
> its attributes, readVECT6() in spgrass6, which I think you know of.
> Otherwise, perhaps:
>
> zz <- execGRASS("db.select", parameters=list(table="newbugs"),
> ?intern=TRUE)
> con <- textConnection(zz)
> zzz <- read.table(con, header=TRUE, sep="|")
> close(con)
>
> Hope this helps,
>
> Roger
>
>
>>


-- 
Sarah Goslee
http://www.functionaldiversity.org


From Roger.Bivand at nhh.no  Tue Oct 19 22:33:14 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 19 Oct 2010 22:33:14 +0200 (CEST)
Subject: [R-sig-Geo] Creating density heatmaps for geographical data
In-Reply-To: <C7EEE8C8-E321-4FA8-AB67-6C3C12B79116@auckland.ac.nz>
References: <i94fpq$356$1@dough.gmane.org>
	<AANLkTi=h=+QWsuOb0EjnkHT1raFsGV3kv9P7Ns2Hf_ZN@mail.gmail.com>
	<i9hbts$cj0$1@dough.gmane.org>
	<3CFD474A-0E56-44FF-B7C6-9EDA37FB4E87@auckland.ac.nz>
	<i9jtkb$chr$1@dough.gmane.org>
	<C7EEE8C8-E321-4FA8-AB67-6C3C12B79116@auckland.ac.nz>
Message-ID: <alpine.LRH.2.00.1010192226520.13793@reclus.nhh.no>

On Wed, 20 Oct 2010, Rolf Turner wrote:

>
> The spatstat package is designed for the analysis of spatial point
> patterns.  In this context the existence of a window --- the
> *observation* window --- is absolutely crucial.  You have to know where
> points have been *looked for*, because there is information in where
> the points aren't, as well as in where they are.  And you can't say
> anything about where they aren't unless you know where they have been
> looked for.
>
> If you are putting spatstat to other uses where the nature of the process
> generating the points is not of interest, and you want a default window
> which has the nature of a bounding box, then this is easy to arrange.
> E.g. you could write your own simple little utility, say
>
> ppp_koh <- function(x,y,wrecked=TRUE,f,marks=NULL) {
> require(spatstat)
> ppp(x,y,window=ripras(x,y,shape=if(wrecked) "rectangle" else "convex",f=f),marks=marks)
> }
>
> Then you can do things like:
> set.seed(42)
> x <- runif(100,3,7)
> y <- runif(100,-2,9)
> X <- ppp_koh(x,y)

Or using the suite of coercion methods in in the maptools package:

library(maptools)
set.seed(42)
x <- runif(100,3,7)
y <- runif(100,-2,9)
xy <- SpatialPoints(cbind(x, y))
X <- as(xy, "ppp")

and so on. There are horses for courses, and the ppp, psp, im, and other 
representations, like polygons windows, are well tailored to their 
applications. So using coercion methods is a less invasive way of 
providing interoperability than trying to make a single set of 
representations fit all uses.

Roger

>
> Note that by default the ripras() function called by ppp_koh() expands the
> bounding box of the points slightly from extent of the data (to give a ``maximum
> likelihood estimate'' of the bounding box).
>
> If you don't want this expansion then specify f=1:
>
> Y <- ppp_koh(x,y,f=1)
>
> Note that this will cause at least two points of the pattern (and probably
> four or more) to lie on the boundary of the window.
>
> In genuine spatial point process applications one is advised to eschew
> the use of the ripras() function.
>
> 	cheers,
>
> 		Rolf
>
> On 19/10/2010, at 11:58 PM, Karl Ove Hufthammer wrote:
>
>> Rolf Turner wrote:
>>
>>>> 'ppp' objects used by 'spatstat' have an annoying structure
>>>
>>> <SNIP>
>>>
>>> Annoyance is in the mind of the beholder I think.  Personally I
>>> find the structure of ppp objects absolutely *delightful*! :-)
>>>
>>> Also, they are simple, intuitive, easy to work with, and easy to
>>> understand, take apart, dissect, and manipulate.  Furthermore the
>>> tools in spatstat make it easy to do unto ppp objects pretty well
>>> anything one might want to do to a point pattern.  (I'm not being
>>> immodest here; the tools are mainly down to Adrian.)
>>>
>>> Just what do you find ``annoying'' about the structure of ppp objects?
>>
>> Well, I guess only the fact that they?re not ?sp? objects, really. And
>> that?s very annoying ? :)
>>
>> And though the ?window? element of ?ppp? objects may be of use to some
>> people, I haven?t had any use for it. The annoying thing here is that the
>> constructor doesn?t generate the window automatically, based on the extent /
>> bounding box of the data, and don?t have an *option* for doing this, either.
>> Whenever I have used ?spatstat? (not too often), I have had to spend too
>> much time looking up how the window should be specified. Having [0,1] ?
>> [0,1] as the *default* window, and excluding any points outside this does
>> seems like a strange design decision.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From jmburgos at uw.edu  Wed Oct 20 04:37:26 2010
From: jmburgos at uw.edu (Julian Burgos)
Date: Wed, 20 Oct 2010 02:37:26 +0000
Subject: [R-sig-Geo] problem with spTransform and SpatialPixelsDataFrame
Message-ID: <AANLkTi=TtPPYuda0RPS_0QSEEMxA-V3HEXsg+G=C=Q_h@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101020/07c66b3e/attachment.pl>

From mdsumner at gmail.com  Wed Oct 20 05:14:15 2010
From: mdsumner at gmail.com (Michael Sumner)
Date: Wed, 20 Oct 2010 14:14:15 +1100
Subject: [R-sig-Geo] problem with spTransform and SpatialPixelsDataFrame
In-Reply-To: <AANLkTi=TtPPYuda0RPS_0QSEEMxA-V3HEXsg+G=C=Q_h@mail.gmail.com>
References: <AANLkTi=TtPPYuda0RPS_0QSEEMxA-V3HEXsg+G=C=Q_h@mail.gmail.com>
Message-ID: <AANLkTi=qHQ2R9qu6F0JgsTs0towzGqVjZK=j+1SG=oSW@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101020/83d4d033/attachment.pl>

From Roger.Bivand at nhh.no  Wed Oct 20 08:56:45 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 20 Oct 2010 08:56:45 +0200 (CEST)
Subject: [R-sig-Geo] problem with spTransform and SpatialPixelsDataFrame
In-Reply-To: <AANLkTi=TtPPYuda0RPS_0QSEEMxA-V3HEXsg+G=C=Q_h@mail.gmail.com>
References: <AANLkTi=TtPPYuda0RPS_0QSEEMxA-V3HEXsg+G=C=Q_h@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1010200851120.16077@reclus.nhh.no>

On Wed, 20 Oct 2010, Julian Burgos wrote:

> Dear list,
> I have a problem trying to change the projection of a
> SpatialPixelsDataFrame, from UTM to lat/long.  My object has the following
> characteristics:
>
>> summary(mb)
> Object of class SpatialPixelsDataFrame
> Coordinates:
>        min       max
> X -14.17196 -13.76879
> Y  63.75071  63.96791
> Is projected: TRUE
> proj4string : [+proj=utm +zone=28 +datum=WGS84]
> Number of points: 5669540
> Grid attributes:
>  cellcentre.offset     cellsize cells.dim
> X         -14.17189 1.347473e-04      2992
> Y          63.75074 5.944386e-05      3654
> Data attributes:
>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
>  108.5   230.3   256.9   283.0   287.9   987.6
>
> when using the  spTransform I get the following error message:
>
>> mb=spTransform(mb,CRS("proj=longlat +datum=WGS84"))
> Error in spTransform(mb, CRS("proj=longlat +datum=WGS84")) :
>  error in evaluating the argument 'CRSobj' in selecting a method for
> function 'spTransform'

The error was caused by a missing +:

library(rgdal)
data(meuse.grid)
gridded(meuse.grid) <- TRUE
proj4string(meuse.grid) <- CRS("+init=epsg:28992")
ll <- spTransform(meuse.grid, CRS("proj=longlat +datum=WGS84"))
ll <- spTransform(meuse.grid, CRS("+proj=longlat +datum=WGS84"))

which coerces to points first, as Mike said it should.

Roger

>
> Any ideas what is the problem?
> Many thanks,
>
> Julian Burgos
>
> Julian Mariano Burgos
> Hafranns?knastofnunin/Marine Research Institute
> Sk?lagata 4, 121 Reykjav?k, Iceland
> S?mi/Telephone : +354-5752037
> Br?fs?mi/Telefax:  +354-5752001
> Netfang/Email: julian at hafro.is, jmburgos at uw.edu
>
> 	[[alternative HTML version deleted]]
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From isabelle.boulangeat at gmail.com  Wed Oct 20 10:31:14 2010
From: isabelle.boulangeat at gmail.com (isabelle boulangeat)
Date: Wed, 20 Oct 2010 10:31:14 +0200
Subject: [R-sig-Geo] Extract xy values from a SpatialPolygon
In-Reply-To: <AANLkTinYYgbxD4hUAiaay42U2xmNw1Gcrx9GauNbksoB@mail.gmail.com>
References: <AANLkTimF5MzKqnATMBsG=nfZkeoXgGqc0xdLzowj-jm4@mail.gmail.com>
	<AANLkTinYYgbxD4hUAiaay42U2xmNw1Gcrx9GauNbksoB@mail.gmail.com>
Message-ID: <AANLkTimYO6TvMbyL6ta7n80D3-rcKx629nZWPOzacP67@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101020/c5a10a10/attachment.pl>

From aparenti at ec.unipi.it  Wed Oct 20 11:20:36 2010
From: aparenti at ec.unipi.it (Angela Parenti)
Date: Wed, 20 Oct 2010 11:20:36 +0200
Subject: [R-sig-Geo] How to build a spatial weights list for pooled data
In-Reply-To: <28643F754DDB094D8A875617EC4398B206A9E018@BEMAILEXTV03.corp.generali.net>
References: <mailman.9.1287396006.4701.r-sig-geo@stat.math.ethz.ch>
	<28643F754DDB094D8A875617EC4398B206A9E018@BEMAILEXTV03.corp.generali.net>
Message-ID: <4CBEB464.9060004@ec.unipi.it>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101020/86092f68/attachment.pl>

From E.Couce.07 at bristol.ac.uk  Wed Oct 20 12:56:15 2010
From: E.Couce.07 at bristol.ac.uk (ElenaC)
Date: Wed, 20 Oct 2010 03:56:15 -0700 (PDT)
Subject: [R-sig-Geo] trouble coercing SpatialPixelsDataFrame into
	SpatialGridDataFrame?
Message-ID: <1287572175784-5654305.post@n2.nabble.com>


Dear all,

I'm having trouble doing what I thought would be a very simple conversion. I
have a SpatialPixelsDataFrame variable which has a single data attribute, a
logical variable:

> summary(data_pixels)
Object of class SpatialPixelsDataFrame
Coordinates:
           min max
coords.x1 -180 180
coords.x2  -60  60
Is projected: NA
proj4string : [NA]
Number of points: 3972
Grid attributes:
          cellcentre.offset cellsize cells.dim
coords.x1            -179.5        1       360
coords.x2             -59.5        1       120
Data attributes:
   Mode   FALSE    TRUE    NA's
logical    3733     239       0 


When I try to convert it to SpatialGridDataFrame, for some reason I lose all
the grid cells which were TRUE:

> data_grid <- as(data_pixels,'SpatialGridDataFrame')
> summary(data_grid)
Object of class SpatialGridDataFrame
Coordinates:
           min max
coords.x1 -180 180
coords.x2  -60  60
Is projected: NA
proj4string : [NA]
Number of points: 2
Grid attributes:
          cellcentre.offset cellsize cells.dim
coords.x1            -179.5        1       360
coords.x2             -59.5        1       120
Data attributes:
   Mode   FALSE    NA's
logical    3733   39467 


Sorry if this is really obvious, but I don't understand why this is
happening. What I wanted to do was keep both the FALSE and TRUE data and
fill in all the rest of the grid cells with NAs. Any hint would be greatly
appreciated!

Regards,
Elena
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/trouble-coercing-SpatialPixelsDataFrame-into-SpatialGridDataFrame-tp5654305p5654305.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From edzer.pebesma at uni-muenster.de  Wed Oct 20 14:14:20 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 20 Oct 2010 14:14:20 +0200
Subject: [R-sig-Geo] trouble coercing SpatialPixelsDataFrame
	into	SpatialGridDataFrame?
In-Reply-To: <1287572175784-5654305.post@n2.nabble.com>
References: <1287572175784-5654305.post@n2.nabble.com>
Message-ID: <4CBEDD1C.6050701@uni-muenster.de>

When trying the example below, I can't reproduce your problem. Could you
provide us with the output of sessionInfo(), and a way to reproduce your
problem?

library(sp)
data(meuse.grid)
gridded(meuse.grid) = ~x+y
summary(meuse.grid)
meuse.grid$B = meuse.grid$dist > .2
summary(meuse.grid)
summary(as(meuse.grid, "SpatialGridDataFrame"))
# try a single band grid:
m = SpatialPixelsDataFrame(as(meuse.grid, "SpatialPixels"),
  data.frame(B = meuse.grid[["B"]]))
summary(m)
summary(as(m, "SpatialGridDataFrame"))


On 10/20/2010 12:56 PM, ElenaC wrote:
> 
> Dear all,
> 
> I'm having trouble doing what I thought would be a very simple conversion. I
> have a SpatialPixelsDataFrame variable which has a single data attribute, a
> logical variable:
> 
>> summary(data_pixels)
> Object of class SpatialPixelsDataFrame
> Coordinates:
>            min max
> coords.x1 -180 180
> coords.x2  -60  60
> Is projected: NA
> proj4string : [NA]
> Number of points: 3972
> Grid attributes:
>           cellcentre.offset cellsize cells.dim
> coords.x1            -179.5        1       360
> coords.x2             -59.5        1       120
> Data attributes:
>    Mode   FALSE    TRUE    NA's
> logical    3733     239       0 
> 
> 
> When I try to convert it to SpatialGridDataFrame, for some reason I lose all
> the grid cells which were TRUE:
> 
>> data_grid <- as(data_pixels,'SpatialGridDataFrame')
>> summary(data_grid)
> Object of class SpatialGridDataFrame
> Coordinates:
>            min max
> coords.x1 -180 180
> coords.x2  -60  60
> Is projected: NA
> proj4string : [NA]
> Number of points: 2
> Grid attributes:
>           cellcentre.offset cellsize cells.dim
> coords.x1            -179.5        1       360
> coords.x2             -59.5        1       120
> Data attributes:
>    Mode   FALSE    NA's
> logical    3733   39467 
> 
> 
> Sorry if this is really obvious, but I don't understand why this is
> happening. What I wanted to do was keep both the FALSE and TRUE data and
> fill in all the rest of the grid cells with NAs. Any hint would be greatly
> appreciated!
> 
> Regards,
> Elena

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From E.Couce.07 at bristol.ac.uk  Wed Oct 20 18:34:18 2010
From: E.Couce.07 at bristol.ac.uk (ElenaC)
Date: Wed, 20 Oct 2010 09:34:18 -0700 (PDT)
Subject: [R-sig-Geo] trouble coercing SpatialPixelsDataFrame
	into	SpatialGridDataFrame?
In-Reply-To: <4CBEDD1C.6050701@uni-muenster.de>
References: <1287572175784-5654305.post@n2.nabble.com>
	<4CBEDD1C.6050701@uni-muenster.de>
Message-ID: <1287592458966-5655660.post@n2.nabble.com>


I can't reproduce the problem with the meuse data either, so I've uploaded my
original data:
http://r-sig-geo.2731867.n2.nabble.com/file/n5655660/data_error.RData
data_error.RData 

I get the problem when I do:

library(sp)
load("data_error.RData")
summary(data_pixels)
summary(as(data_pixels,'SpatialGridDataFrame'))


Here is the output from sessionInfo:

> sessionInfo()
R version 2.10.1 (2009-12-14) 
x86_64-apple-darwin9.8.0 

locale:
[1] en_GB.UTF-8/en_GB.UTF-8/C/C/en_GB.UTF-8/en_GB.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] sp_0.9-65

loaded via a namespace (and not attached):
[1] grid_2.10.1    lattice_0.18-3

-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/trouble-coercing-SpatialPixelsDataFrame-into-SpatialGridDataFrame-tp5654305p5655660.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From phate207 at hotmail.com  Wed Oct 20 19:08:13 2010
From: phate207 at hotmail.com (Valentina.de)
Date: Wed, 20 Oct 2010 10:08:13 -0700 (PDT)
Subject: [R-sig-Geo] European Union NUTS2, NUTS3 regions (SHP format)
In-Reply-To: <AANLkTi=H2gqJnDRg0SkqhHXrbSjU12t4nWNSUP_+A1+e@mail.gmail.com>
References: <4C77A4E3.6020704@tuke.sk>
	<AANLkTi=H2gqJnDRg0SkqhHXrbSjU12t4nWNSUP_+A1+e@mail.gmail.com>
Message-ID: <1287594493607-5655781.post@n2.nabble.com>



Barry Rowlingson wrote:
> 
> 2010/8/27 Tomas Zelinsky <tomas.zelinsky at tuke.sk>:
>>...
>  Looking at NUTS_RG_60M_2006.SHP there's a STAT_LEVL_ variable which I
> guess is the NUTS level code - this is probably documented in the
> meta-data somewhere. So you can do:
> 
>  require(rgdal)
>  s = readOGR(".","NUTS_RG_60M_2006")
>  plot(s[s$STAT_LEVL_==0,])
>  plot(s[s$STAT_LEVL_==1,])
> ....
> 

Hello, 

can you please explain me the steps to do it?I can't understand where I can
require the extraction..

Moreover I need to change the order of the entries ( by alphabetical order
for the NUTS 2  name) as I have to add a column with the cluster name (from
the analysis I am doing) in order to succeed -finally- at creating a map of
nuts 2 with different colors for each cluster of regions.

I am grateful for you kind attention, 

Valentina.
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/European-Union-NUTS2-NUTS3-regions-SHP-format-tp5469117p5655781.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Roger.Bivand at nhh.no  Wed Oct 20 21:16:12 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 20 Oct 2010 21:16:12 +0200 (CEST)
Subject: [R-sig-Geo] trouble coercing SpatialPixelsDataFrame into
 SpatialGridDataFrame?
In-Reply-To: <1287592458966-5655660.post@n2.nabble.com>
References: <1287572175784-5654305.post@n2.nabble.com>
	<4CBEDD1C.6050701@uni-muenster.de>
	<1287592458966-5655660.post@n2.nabble.com>
Message-ID: <alpine.LRH.2.00.1010202106540.17805@reclus.nhh.no>

On Wed, 20 Oct 2010, ElenaC wrote:

>
> I can't reproduce the problem with the meuse data either, so I've uploaded my
> original data:
> http://r-sig-geo.2731867.n2.nabble.com/file/n5655660/data_error.RData
> data_error.RData
>
> I get the problem when I do:
>
> library(sp)
> load("data_error.RData")
> summary(data_pixels)
> summary(as(data_pixels,'SpatialGridDataFrame'))

Thanks for posting the data. The problem is that your TRUE values are 
duplicate observations, so that TRUE is assigned to the grid cell first, 
because they come "before" FALSE (observations 1:241):

length(slot(data_pixels, "grid.index"))
length(unique(slot(data_pixels, "grid.index")))
zerodist(data_pixels)

How was the data_pixels object constructed? Did you intend to have 
duplicate pixels?

Maybe the SpatialPixels constructor should warn if points are duplicated?

Hope this helps,

Roger

>
>
> Here is the output from sessionInfo:
>
>> sessionInfo()
> R version 2.10.1 (2009-12-14)
> x86_64-apple-darwin9.8.0
>
> locale:
> [1] en_GB.UTF-8/en_GB.UTF-8/C/C/en_GB.UTF-8/en_GB.UTF-8
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] sp_0.9-65
>
> loaded via a namespace (and not attached):
> [1] grid_2.10.1    lattice_0.18-3
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From E.Couce.07 at bristol.ac.uk  Wed Oct 20 23:54:16 2010
From: E.Couce.07 at bristol.ac.uk (ElenaC)
Date: Wed, 20 Oct 2010 14:54:16 -0700 (PDT)
Subject: [R-sig-Geo] trouble coercing SpatialPixelsDataFrame into
 SpatialGridDataFrame?
In-Reply-To: <alpine.LRH.2.00.1010202106540.17805@reclus.nhh.no>
References: <1287572175784-5654305.post@n2.nabble.com>
	<4CBEDD1C.6050701@uni-muenster.de>
	<1287592458966-5655660.post@n2.nabble.com>
	<alpine.LRH.2.00.1010202106540.17805@reclus.nhh.no>
Message-ID: <1287611656556-5656786.post@n2.nabble.com>


Thanks a lot, Roger!

There was indeed a problem with the way I built data_pixels, there shouldn't
have been any duplicated observations. I've fixed it and all is working now. 

A warning for duplicates might be a good idea

Cheers,
Elena
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/trouble-coercing-SpatialPixelsDataFrame-into-SpatialGridDataFrame-tp5654305p5656786.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Adrian.Baddeley at csiro.au  Thu Oct 21 07:07:33 2010
From: Adrian.Baddeley at csiro.au (Adrian.Baddeley at csiro.au)
Date: Thu, 21 Oct 2010 13:07:33 +0800
Subject: [R-sig-Geo] [R] Spatstat: tessellation problems.
In-Reply-To: <4CBF37F2.4080804@hgu.mrc.ac.uk>
References: <4CBF37F2.4080804@hgu.mrc.ac.uk>
Message-ID: <57DC18C299094D4299F837570C5DF1C52C92D9AF88@EXWA-MBX01.nexus.csiro.au>

Hello all

This is a bug (related to changes in the handling of factors in R)
 
It will be fixed in the next version of spatstat (1.20-4) which will be released shortly

regards
Adrian Baddeley

Neba Funwi-Gabga <fusigabsmail at gmail.com> writes:

> I am trying to do a quadrat count defined by covariate properties in
> spatstat. I have read my elevation raster into R (from ascii) and converted
> to class "im" for use in spatstat.
> I have also created a tessellation of the elevation image into 4 categories
> as follows:

>> >elev.cut<-cut(elevation.im, breaks=elev.quantiles, 
>>   labels=c("Very low","Low","High","Very High"))
>> >elev.tess<-tess(image=elev.cut)

> I would like to do a quadrat count to know how many points lie in each of
> the elevation categories I have created, and as far as I know, this function
> should give that:

>>  >elev.quad.count<-quadratcount(points, tess=elev.tess)

> But when I do this, I get a warning message saying:

> Warning message:
> In quadratcount.ppp(points, tess = aspect.tess) :
>   Tessellation does not contain all the points of X


From valerio.bartolino at uniroma1.it  Thu Oct 21 12:46:05 2010
From: valerio.bartolino at uniroma1.it (valerio.bartolino at uniroma1.it)
Date: Thu, 21 Oct 2010 12:46:05 +0200
Subject: [R-sig-Geo] random effect
Message-ID: <OF467FF045.4954FCF0-ONC12577C3.003B2693-C12577C3.003B26A4@Uniroma1.it>

Dear R-sig-Geo list,
I've a question about a spatial regression model I'm working with. Here
is my problem and question:

I'm modeling the local densities of a species (y) as a second order
polynom of the geographical position (lon,lat), time (year), and a
certain number of other variables:

mod1 <- lm( y ~ ... + poly(lon,lat, degree=2)*as.factor(year))

Then, I know that the sampling has a certain spatial resolution, that I
can represent with a regular grid. Thus, I was thinking that
observations within the same cell of the grid (gr.id) cannot be
considered completely independent, and that this could be represented
with a random effect like:

mod2 <- lme( y ~ ... + poly(lon,lat, degree=2)*as.factor(year),
random=list(gr.id=~1))

An additional level of complexity within my formulation, is given by the
temporal resolution. Thus, I would like to group the spatial dependency
of observations from the same cell within certain time intervals
(time.gr). Here my problem comes. I'm a bit confused on how to formulate
exactly the random effect expressed above into time.gr groups. I have
alternative slightly different formulations in mind, but I miss their
difference in practice.

Thanks in advance for any help or advice.

Valerio


-- 
Valerio Bartolino, PhD

Institute of Marine Research - Swedish Board of Fisheries
PO Box 4, 45321 Lysekil, Sweden

Department of Earth Sciences - Gothenburg University
PO Box 460, 40530 G?teborg, Sweden

e-mail: valerio.bartolino at gvc.gu.se
        valerio.bartolino at gmail.com

><(((*> ----- ><(((*> ----- ><(((*> ----- ><(((*>

From mspinola10 at gmail.com  Thu Oct 21 12:51:53 2010
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Thu, 21 Oct 2010 04:51:53 -0600
Subject: [R-sig-Geo] Evaluating maxent model in dismo package
Message-ID: <4CC01B49.2030407@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101021/02cd3f02/attachment.pl>

From lists at remoteinformation.com.au  Thu Oct 21 14:13:39 2010
From: lists at remoteinformation.com.au (Ben Madin)
Date: Thu, 21 Oct 2010 23:13:39 +1100
Subject: [R-sig-Geo] Error in readOGR / ogrInfo
Message-ID: <7F017C08-93DC-4E63-A039-DBEF904997AD@remoteinformation.com.au>

G'day all,

I am having a problem with using the rgdal function readOGR, but the error message actually relates to using ogrInfo.

> backgroundmap <- readOGR("PG:dbname=gms user=benmadin password=xdi4frt", "seaplus_countries")
Error in ogrInfo(dsn = dsn, layer = layer, input_field_name_encoding = input_field_name_encoding) : 
  
	GDAL Error 1: No field definitions found for 'seaplus_countries', is it a table?
> ogrInfo("PG:dbname=gms user=benmadin password= xdi4frt", "seaplus_countries", input_field_name_encoding=UTF-8)
Error in ogrInfo("PG:dbname=gms user=benmadin password= xdi4frt", "seaplus_countries",  : 
  
	GDAL Error 1: No field definitions found for 'seaplus_countries', is it a table?


Yet when I use ogrInfo from the command line it shows me the information :

warrambat:~ benmadin$ ogrinfo "PG:dbname=gms user=benmadin password= xdi4frt"
INFO: Open of `PG:dbname=gms user=benmadin password= xdi4frt'
      using driver `PostgreSQL' successful.

rows deleted

20: public.country (Multi Polygon)
21: public.seaplus_countries (Multi Polygon)
22: public.worldboundaries (Multi Polygon)

and I can load the layer and display it in QGIS or uDig.

The problem occurs both in the GUI and the command line versions of R. 

> sessionInfo()
R version 2.11.1 Patched (2010-09-30 r53084)
Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)

locale:
[1] en_AU.UTF-8/en_AU.UTF-8/C/C/en_AU.UTF-8/en_AU.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] rgdal_0.6-28 sp_0.9-72   

loaded via a namespace (and not attached):
[1] grid_2.11.1     lattice_0.19-13

I have tried this with a number of postgis tables in different databases, and it is not working. I am trying to re-run code that has previously worked fine, but I am on a new computer and using R2.11 and a more recent version of rgdal.

My first question is - what does the error message mean?

My second question - why is it occurring in R, but not (apparently) a problem outside of R?

My third question - am I on the right list?

cheers

Ben


From dorothea.lemke at uni-muenster.de  Thu Oct 21 15:00:22 2010
From: dorothea.lemke at uni-muenster.de (Dorothea Lemke)
Date: Thu, 21 Oct 2010 15:00:22 +0200 (CEST)
Subject: [R-sig-Geo] marked ppp-object
Message-ID: <permail-20101021130022f7e55a9d00005d6a-dlemk_01@message-id.uni-muenster.de>

Hi list,

that's probably an easy question but I couldn't get it right.
I want to coerce a SpatialPointsDataFrame to a marked ppp- object. But I don't
know how to attach the marks to the ppp-object.


>C67mF_K<-readOGR (".", "C67mF_K")  #read shapefile that contains points for
>cases and controls with one variable "typ"

str (C67mF_K)
Formal class 'SpatialPointsDataFrame' [package "sp"] with 5 slots
  ..@ data       :'data.frame': 5968 obs. of  4 variables:
  .. ..$ ID     : num [1:5968] 4336 4106 994 325 3145 ...
  .. ..$ POINT_X: num [1:5968] 2576860 2574710 2576790 2575400 2575600 ...
  .. ..$ POINT_Y: num [1:5968] 5706080 5706060 5706230 5706210 5706310 ...
  .. ..$ typ    : Factor w/ 2 levels "F","K": 2 2 2 2 2 2 2 2 2 2 ...
  ..@ coords.nrs : num(0)
  ..@ coords     : num [1:5968, 1:2] 368483 366335 368420 367030 367234 ...
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : NULL
  .. .. ..$ : chr [1:2] "coords.x1" "coords.x2"
  ..@ bbox       : num [1:2, 1:2] 322028 5705358 451515 5808359
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : chr [1:2] "coords.x1" "coords.x2"
  .. .. ..$ : chr [1:2] "min" "max"
  ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slots
  .. .. ..@ projargs: chr " +proj=utm +zone=32 +ellps=GRS80 +units=m +no_defs"

ppC67mF_K<-as(C67mF_K, "ppp", marks = typ)

I get the error message: unused arguments:  (marks = typ)

I would grateful for any hint.

Dorothea


From edzer.pebesma at uni-muenster.de  Thu Oct 21 15:46:55 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 21 Oct 2010 15:46:55 +0200
Subject: [R-sig-Geo] marked ppp-object
In-Reply-To: <permail-20101021130022f7e55a9d00005d6a-dlemk_01@message-id.uni-muenster.de>
References: <permail-20101021130022f7e55a9d00005d6a-dlemk_01@message-id.uni-muenster.de>
Message-ID: <4CC0444F.6080406@uni-muenster.de>



On 10/21/2010 03:00 PM, Dorothea Lemke wrote:
> Hi list,
> 
> that's probably an easy question but I couldn't get it right.
> I want to coerce a SpatialPointsDataFrame to a marked ppp- object. But I don't
> know how to attach the marks to the ppp-object.
> 
> 
>> C67mF_K<-readOGR (".", "C67mF_K")  #read shapefile that contains points for
>> cases and controls with one variable "typ"
> 
> str (C67mF_K)
> Formal class 'SpatialPointsDataFrame' [package "sp"] with 5 slots
>   ..@ data       :'data.frame': 5968 obs. of  4 variables:
>   .. ..$ ID     : num [1:5968] 4336 4106 994 325 3145 ...
>   .. ..$ POINT_X: num [1:5968] 2576860 2574710 2576790 2575400 2575600 ...
>   .. ..$ POINT_Y: num [1:5968] 5706080 5706060 5706230 5706210 5706310 ...
>   .. ..$ typ    : Factor w/ 2 levels "F","K": 2 2 2 2 2 2 2 2 2 2 ...
>   ..@ coords.nrs : num(0)
>   ..@ coords     : num [1:5968, 1:2] 368483 366335 368420 367030 367234 ...
>   .. ..- attr(*, "dimnames")=List of 2
>   .. .. ..$ : NULL
>   .. .. ..$ : chr [1:2] "coords.x1" "coords.x2"
>   ..@ bbox       : num [1:2, 1:2] 322028 5705358 451515 5808359
>   .. ..- attr(*, "dimnames")=List of 2
>   .. .. ..$ : chr [1:2] "coords.x1" "coords.x2"
>   .. .. ..$ : chr [1:2] "min" "max"
>   ..@ proj4string:Formal class 'CRS' [package "sp"] with 1 slots
>   .. .. ..@ projargs: chr " +proj=utm +zone=32 +ellps=GRS80 +units=m +no_defs"
> 
> ppC67mF_K<-as(C67mF_K, "ppp", marks = typ)
> 
> I get the error message: unused arguments:  (marks = typ)
> 
> I would grateful for any hint.

Dorothea,

looking at the sources of as.ppp.SpatialPointsDataFrame, my guess is
that the following should work:

ppC67mF_K <- as(C67mF_K["typ"], "ppp")

> 
> Dorothea
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From gianni.lavaredo at gmail.com  Thu Oct 21 18:06:04 2010
From: gianni.lavaredo at gmail.com (gianni lavaredo)
Date: Thu, 21 Oct 2010 18:06:04 +0200
Subject: [R-sig-Geo] help to select a data.frame in fuction of ID
Message-ID: <AANLkTinumqOTpD+5i79XHqTcEeP1xjHrVVQBdmhMd3yE@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101021/f58328ba/attachment.pl>

From r.hijmans at gmail.com  Thu Oct 21 19:54:21 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 21 Oct 2010 10:54:21 -0700
Subject: [R-sig-Geo] Evaluating maxent model in dismo package
In-Reply-To: <4CC01B49.2030407@gmail.com>
References: <4CC01B49.2030407@gmail.com>
Message-ID: <AANLkTi=0Voh6SpupSJLCOXYFFgTf7ZBW7nq1w00UN5Vk@mail.gmail.com>

Manuel,

You are making two maxent models "me" (with all data) and "me2" (with
partitioned data) (I realize you copied this this error in the help
file..., sorry about that). You could test (with some caveats) me2
with the data withheld (see below). But I think you are testing me
instead (using data it had to fit the model). Even so, 1 is a high AUC
score. Perhaps you have something like a spatially clustered clump
presence points and absence points that are far away (i.e. a somewhat
trivial problem).

# predict to testing points
testp <- predict(me2, pvtest)
head(testp)
testa <- predict(me2, avtest)



Here is a fixed example that I have put in the help file


# get predictor variables
predictors <- stack(list.files(path=paste(system.file(package="dismo"),
'/ex', sep=''), pattern='grd', full.names=TRUE ))
plot(predictors)

# file with presence points
occurence <- paste(system.file(package="dismo"), '/ex/bradypus.csv', sep='')
occ <- read.table(occurence, header=TRUE, sep=',')[,-1]

# witholding a 20% sample for testing
fold <- kfold(occ, k=5)
occtest <- occ[fold == 1, ]
occtrain <- occ[fold != 1, ]

# fit model, biome is a categorical variable
me <- maxent(predictors, occtrain, factors='biome')
# see the maxent results in a browser:
# me

# use "args"
# me2 <- maxent(predictors, occtrain, factors='biome', args=c("-J", "-P"))

# plot showing importance of each variable
plot(me)

# predict to entire dataset
r <- predict(me, predictors, progress='text')
# r <- predict(me, predictors, progress='text', args=c("outputformat=raw"))

plot(r)
points(occ)

#testing
# background data
bg <- randomPoints(predictors, 1000)

#simplest way to use 'evaluate'
e1 = evaluate(me, p=occtest, a=bg, x=predictors)

# alternative 1
# extract values
pvtest <- data.frame(xyValues(predictors, occtest))
avtest <- data.frame(xyValues(predictors, bg))

e2 = evaluate(me, p=pvtest, a=avtest)

# alternative 2
# predict to testing points
testp <- predict(me, pvtest)
head(testp)
testa <- predict(me, avtest)

e3 = evaluate(p=testp, a=testa)
e3
plot(e3, 'ROC')


On Thu, Oct 21, 2010 at 3:51 AM, Manuel Sp?nola <mspinola10 at gmail.com> wrote:
> Dear list member,
>
> I am running a maxent model in dismo package and I got AUC = 1, but I am
> not sure if this is right. ?Is there a way to find out if my evaluation
> is correct?
> Here is my code:
>
> # fit model
> me <- maxent(predictores, dendro)
>
> # plot showing importance of each variable
> plot(me)
>
> # predict to entire dataset
> r <- predict(me, predictores, progress='text')
> # r <- predict(me, predictors, progress='text', args=c("outputformat=raw"))
>
> plot(r)
> points(dendro)
>
>
> # The below is equivalent (except that we use
> # k-fold partitioning of the data for testing purposes
>
> # extract values
> pv <- data.frame(xyValues(predictores, dendro))
> fp <- kfold(pv, k=5)
> pvtrain <- pv[fp != 1, ]
> pvtest <- pv[fp == 1, ]
> head(pvtest)
>
> # background data
> bg <- randomPoints(predictores, 210)
> av <- data.frame(xyValues(predictores, bg))
> fb <- kfold(av, k=5)
> avtrain <- av[fb != 1, ]
> avtest <- av[fb == 1, ]
>
> # combine train presence and background data
> train <- rbind(pvtrain, avtrain)
> # vector indicating presence or absence
> p <- c(rep(1, nrow(pvtrain)), rep(0, nrow(avtrain)))
>
> # fit maxent model
> me2 <- maxent(x=train, p=p)
>
> # predict to testing points
> testp <- predict(me, pvtest)
> head(testp)
> testa <- predict(me, avtest)
>
> #evaluate
> e = evaluate(p=testp, a=testa)
> e
> plot(e, 'ROC')
>
> RESULTADOS:
> ?> e
> class ? ? ? ? ? ?: ModelEvaluation
> n presences ? ? ?: 14
> n absences ? ? ? : 42
> AUC ? ? ? ? ? ? ?: 1
> cor ? ? ? ? ? ? ?: 0.9428767
> TPR+TNR threshold: 0.04
>
>
> Thank you very much in advance.
> Best,
>
> Manuel
>
>
> --
> *Manuel Sp?nola, Ph.D.*
> Instituto Internacional en Conservaci?n y Manejo de Vida Silvestre
> Universidad Nacional
> Apartado 1350-3000
> Heredia
> COSTA RICA
> mspinola at una.ac.cr
> mspinola10 at gmail.com
> Tel?fono: (506) 2277-3598
> Fax: (506) 2237-7036
> Personal website: Lobito de r?o
> <https://sites.google.com/site/lobitoderio/>
> Institutional website: ICOMVIS <http://www.icomvis.una.ac.cr/>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


From Roger.Bivand at nhh.no  Thu Oct 21 20:06:36 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 21 Oct 2010 20:06:36 +0200 (CEST)
Subject: [R-sig-Geo] Error in readOGR / ogrInfo
In-Reply-To: <7F017C08-93DC-4E63-A039-DBEF904997AD@remoteinformation.com.au>
References: <7F017C08-93DC-4E63-A039-DBEF904997AD@remoteinformation.com.au>
Message-ID: <alpine.LRH.2.00.1010211959280.4450@reclus.nhh.no>

On Thu, 21 Oct 2010, Ben Madin wrote:

> G'day all,
>
> I am having a problem with using the rgdal function readOGR, but the error message actually relates to using ogrInfo.
>
>> backgroundmap <- readOGR("PG:dbname=gms user=benmadin password=xdi4frt", "seaplus_countries")
> Error in ogrInfo(dsn = dsn, layer = layer, input_field_name_encoding = input_field_name_encoding) :
>
> 	GDAL Error 1: No field definitions found for 'seaplus_countries', is it a table?
>> ogrInfo("PG:dbname=gms user=benmadin password= xdi4frt", "seaplus_countries", input_field_name_encoding=UTF-8)
> Error in ogrInfo("PG:dbname=gms user=benmadin password= xdi4frt", "seaplus_countries",  :
>
> 	GDAL Error 1: No field definitions found for 'seaplus_countries', is it a table?
>
>
> Yet when I use ogrInfo from the command line it shows me the information :
>
> warrambat:~ benmadin$ ogrinfo "PG:dbname=gms user=benmadin password= xdi4frt"
> INFO: Open of `PG:dbname=gms user=benmadin password= xdi4frt'
>      using driver `PostgreSQL' successful.
>
> rows deleted
>
> 20: public.country (Multi Polygon)
> 21: public.seaplus_countries (Multi Polygon)
> 22: public.worldboundaries (Multi Polygon)
>
> and I can load the layer and display it in QGIS or uDig.
>
> The problem occurs both in the GUI and the command line versions of R.
>
>> sessionInfo()
> R version 2.11.1 Patched (2010-09-30 r53084)
> Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)
>
> locale:
> [1] en_AU.UTF-8/en_AU.UTF-8/C/C/en_AU.UTF-8/en_AU.UTF-8
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] rgdal_0.6-28 sp_0.9-72
>
> loaded via a namespace (and not attached):
> [1] grid_2.11.1     lattice_0.19-13
>
> I have tried this with a number of postgis tables in different databases, and it is not working. I am trying to re-run code that has previously worked fine, but I am on a new computer and using R2.11 and a more recent version of rgdal.
>
> My first question is - what does the error message mean?
>

I don't run PostGIS, so cannot tell, nor OSX. Is the table named as given 
(what does the "public." prefix mean)? Can you use ogrinfo to examine the 
table itself rather than the list of tables? I assume that you know what 
you are doing; PostGIS is not something I know about.

> My second question - why is it occurring in R, but not (apparently) a 
> problem outside of R?

Most likely the OGR drivers in the GDAL shared object used by rgdal are 
not the same as those used by ogrinfo, QGIS, etc., elsewhere. How did you 
install rgdal - as a binary package (from where) or as a source package? 
If the latter, do you have multiple GDAL shared objects on your system?

>
> My third question - am I on the right list?

Yes.

Roger

>
> cheers
>
> Ben
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From zua3 at cornell.edu  Thu Oct 21 20:42:56 2010
From: zua3 at cornell.edu (Zia Ahmed)
Date: Thu, 21 Oct 2010 14:42:56 -0400
Subject: [R-sig-Geo] Help: CDF plot
In-Reply-To: <4C75ECB4.60503@csiro.au>
References: <4C75ECB4.60503@csiro.au>
Message-ID: <4CC089B0.8010208@cornell.edu>




I want to write a R- function to make a CDF plot of all realizations 
(sim1, sim2, sim3........) with CDF of observed data (suppose zinc of 
muse data). Help will be appreciated
Thanks
Zia

library(gstat)

data(meuse)

data(meuse.grid)

coordinates(meuse) = ~x + y

coordinates(meuse.grid) = ~x + y

lzn.vgm <- variogram(log(zinc) ~ 1, meuse)

lzn.fit <- fit.variogram(lzn.vgm, model = vgm(1, "Sph", 900, 1))

lzn.sim <- krige(log(zinc) ~ 1, meuse, meuse.grid, v.fit, nsim = 6, nmax 
= 40)

/lzn.sim at data <- exp(lzn.sim at data)/

/ /


/ /



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101021/9857b9c7/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: zua3.vcf
Type: text/x-vcard
Size: 281 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101021/9857b9c7/attachment.vcf>

From r.turner at auckland.ac.nz  Thu Oct 21 21:04:29 2010
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Fri, 22 Oct 2010 08:04:29 +1300
Subject: [R-sig-Geo] marked ppp-object
In-Reply-To: <permail-20101021130022f7e55a9d00005d6a-dlemk_01@message-id.uni-muenster.de>
References: <permail-20101021130022f7e55a9d00005d6a-dlemk_01@message-id.uni-muenster.de>
Message-ID: <B3FF3404-7C48-48FD-BE68-4545791EA136@auckland.ac.nz>


On 22/10/2010, at 2:00 AM, Dorothea Lemke wrote:

> Hi list,
> 
> that's probably an easy question but I couldn't get it right.
> I want to coerce a SpatialPointsDataFrame to a marked ppp- object. But I don't
> know how to attach the marks to the ppp-object.

	<SNIP>

If you have created an object X which is an object of class "ppp", and
you have a vector x which you wish to be the marks of X, just do

	marks(X) <- x

The vector x should be either numeric or a factor, and should be of length
equal to the number of points in the point pattern X.

I your particular case I think that (something like)

	temp <- readOGR(".","C67mF_K)
	C67mF_K <- as(temp,"ppp")
	marks(C67mF_K) <- temp at data$typ

should work.


	cheers,

		Rolf Turner

From edzer.pebesma at uni-muenster.de  Thu Oct 21 21:12:39 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 21 Oct 2010 21:12:39 +0200
Subject: [R-sig-Geo] Help: CDF plot
In-Reply-To: <4CC089B0.8010208@cornell.edu>
References: <4C75ECB4.60503@csiro.au> <4CC089B0.8010208@cornell.edu>
Message-ID: <4CC090A7.5090809@uni-muenster.de>



On 10/21/2010 08:42 PM, Zia Ahmed wrote:
> 
> 
> 
> I want to write a R- function to make a CDF plot of all realizations
> (sim1, sim2, sim3........) with CDF of observed data (suppose zinc of
> muse data). Help will be appreciated

It can be me, but after reading your wish several times, I still don't
understand what you want. Do you want to make a cdf plot of each
realization?

plot(ecdf(lzn.sim[[1]])) # etc

Or for each location over all realizations? For threshold z:

z = 5.0
nsim = 6
lzn.sim$z = apply(as.data.frame(lzn.sim)[-(1:2)] <= z, 1, sum)/nsim
spplot(lzn.sim["z"])

Or of the observed values?

plot(ecdf(meuse$zinc))

> Thanks
> Zia
> 
> library(gstat)
> 
> data(meuse)
> 
> data(meuse.grid)
> 
> coordinates(meuse) = ~x + y
> 
> coordinates(meuse.grid) = ~x + y
> 
> lzn.vgm <- variogram(log(zinc) ~ 1, meuse)
> 
> lzn.fit <- fit.variogram(lzn.vgm, model = vgm(1, "Sph", 900, 1))
> 
> lzn.sim <- krige(log(zinc) ~ 1, meuse, meuse.grid, v.fit, nsim = 6, nmax
> = 40)
> 
> /lzn.sim at data <- exp(lzn.sim at data)/
> 
> / /
> 
> 
> / /
> 
> 
> 
> 
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From mspinola10 at gmail.com  Thu Oct 21 21:45:42 2010
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Thu, 21 Oct 2010 13:45:42 -0600
Subject: [R-sig-Geo] Error when transforming a shapefile with spTransform
Message-ID: <AANLkTinRBf15eZQwYkEYsESedqF4Za+RUHjSweF2EJK9@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101021/09a6f036/attachment.pl>

From mdsumner at gmail.com  Thu Oct 21 22:05:12 2010
From: mdsumner at gmail.com (Michael Sumner)
Date: Fri, 22 Oct 2010 07:05:12 +1100
Subject: [R-sig-Geo] Error when transforming a shapefile with spTransform
In-Reply-To: <AANLkTinRBf15eZQwYkEYsESedqF4Za+RUHjSweF2EJK9@mail.gmail.com>
References: <AANLkTinRBf15eZQwYkEYsESedqF4Za+RUHjSweF2EJK9@mail.gmail.com>
Message-ID: <AANLkTi=0S8d2ejTog_v0y0hoZCX36rdJWTiN_-gX8k4o@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101022/368a6596/attachment.pl>

From mdsumner at gmail.com  Thu Oct 21 22:14:29 2010
From: mdsumner at gmail.com (Michael Sumner)
Date: Fri, 22 Oct 2010 07:14:29 +1100
Subject: [R-sig-Geo] marked ppp-object
In-Reply-To: <4CC0444F.6080406@uni-muenster.de>
References: <permail-20101021130022f7e55a9d00005d6a-dlemk_01@message-id.uni-muenster.de>
	<4CC0444F.6080406@uni-muenster.de>
Message-ID: <AANLkTingfPf_UrE2_2T9OioJ0zHC+k8XGNw0yAVqk1hL@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101022/ab9c89f6/attachment.pl>

From mdsumner at gmail.com  Thu Oct 21 22:55:57 2010
From: mdsumner at gmail.com (Michael Sumner)
Date: Fri, 22 Oct 2010 07:55:57 +1100
Subject: [R-sig-Geo] Error when transforming a shapefile with spTransform
In-Reply-To: <AANLkTi=0KCn9jQ61HqC5COcfZCyM7kUAVUs7BMjf3JHB@mail.gmail.com>
References: <AANLkTinRBf15eZQwYkEYsESedqF4Za+RUHjSweF2EJK9@mail.gmail.com>
	<AANLkTi=0S8d2ejTog_v0y0hoZCX36rdJWTiN_-gX8k4o@mail.gmail.com>
	<AANLkTi=0KCn9jQ61HqC5COcfZCyM7kUAVUs7BMjf3JHB@mail.gmail.com>
Message-ID: <AANLkTi=C=N_tgCmkEMoZRD=_HRduZGTHuh+A+bRt+xoB@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101022/c28fe328/attachment.pl>

From lestes at princeton.edu  Thu Oct 21 22:59:18 2010
From: lestes at princeton.edu (Lyndon Estes)
Date: Thu, 21 Oct 2010 16:59:18 -0400
Subject: [R-sig-Geo] Error in readOGR / ogrInfo
In-Reply-To: <7F017C08-93DC-4E63-A039-DBEF904997AD@remoteinformation.com.au>
References: <7F017C08-93DC-4E63-A039-DBEF904997AD@remoteinformation.com.au>
Message-ID: <AANLkTinYXb4JE4cJK0syJNdCTv7UQi3p2URh8cOUz-tc@mail.gmail.com>

Hi Ben,

I had pretty much the same problem on my Mac when I was trying to read
an ESRI shapefile in with readOGR.  I still don't know exactly what
caused it, but the problem seems to have been related to my having
first the .shp and its associated files from a Windows machine onto my
Mac, and then tried to use readOGR.  Using readOGR to import the .shp
file directly from the Windows location (with a smb connection) worked
just fine, on the other hand.

It thus seems that OSX did something to the DBF file structure when it
was moved from Windows, and readOGR didn't like it.

Perhaps what I found is not relevant at all, but maybe this experience
provides a starting point for looking for the problem?

Cheers, Lyndon

On Thu, Oct 21, 2010 at 8:13 AM, Ben Madin
<lists at remoteinformation.com.au> wrote:
> G'day all,
>
> I am having a problem with using the rgdal function readOGR, but the error message actually relates to using ogrInfo.
>
>> backgroundmap <- readOGR("PG:dbname=gms user=benmadin password=xdi4frt", "seaplus_countries")
> Error in ogrInfo(dsn = dsn, layer = layer, input_field_name_encoding = input_field_name_encoding) :
>
> ? ? ? ?GDAL Error 1: No field definitions found for 'seaplus_countries', is it a table?
>> ogrInfo("PG:dbname=gms user=benmadin password= xdi4frt", "seaplus_countries", input_field_name_encoding=UTF-8)
> Error in ogrInfo("PG:dbname=gms user=benmadin password= xdi4frt", "seaplus_countries", ?:
>
> ? ? ? ?GDAL Error 1: No field definitions found for 'seaplus_countries', is it a table?
>
>
> Yet when I use ogrInfo from the command line it shows me the information :
>
> warrambat:~ benmadin$ ogrinfo "PG:dbname=gms user=benmadin password= xdi4frt"
> INFO: Open of `PG:dbname=gms user=benmadin password= xdi4frt'
> ? ? ?using driver `PostgreSQL' successful.
>
> rows deleted
>
> 20: public.country (Multi Polygon)
> 21: public.seaplus_countries (Multi Polygon)
> 22: public.worldboundaries (Multi Polygon)
>
> and I can load the layer and display it in QGIS or uDig.
>
> The problem occurs both in the GUI and the command line versions of R.
>
>> sessionInfo()
> R version 2.11.1 Patched (2010-09-30 r53084)
> Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)
>
> locale:
> [1] en_AU.UTF-8/en_AU.UTF-8/C/C/en_AU.UTF-8/en_AU.UTF-8
>
> attached base packages:
> [1] stats ? ? graphics ?grDevices utils ? ? datasets ?methods ? base
>
> other attached packages:
> [1] rgdal_0.6-28 sp_0.9-72
>
> loaded via a namespace (and not attached):
> [1] grid_2.11.1 ? ? lattice_0.19-13
>
> I have tried this with a number of postgis tables in different databases, and it is not working. I am trying to re-run code that has previously worked fine, but I am on a new computer and using R2.11 and a more recent version of rgdal.
>
> My first question is - what does the error message mean?
>
> My second question - why is it occurring in R, but not (apparently) a problem outside of R?
>
> My third question - am I on the right list?
>
> cheers
>
> Ben
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Lyndon Estes
Research Associate
Woodrow Wilson School
Princeton University
+1-609-258-2392 (o)
+1-609-258-6082 (f)
+1-202-431-0496 (m)
lestes at princeton.edu


From mspinola10 at gmail.com  Fri Oct 22 00:50:56 2010
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Thu, 21 Oct 2010 16:50:56 -0600
Subject: [R-sig-Geo] More problems with spTransform
Message-ID: <AANLkTikNUa5ZtO4=OQ_3PO47hH=GU53PfG57R3D_rpO_@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101021/03799e5a/attachment.pl>

From carstennh at aol.com  Fri Oct 22 02:43:41 2010
From: carstennh at aol.com (Carsten Neumann)
Date: Fri, 22 Oct 2010 02:43:41 +0200
Subject: [R-sig-Geo] image.plot legend problem with layerstack
Message-ID: <4CC0DE3D.30008@aol.com>

  Dear experts,

I simply try to plot an S4 object with a legend using image.plot 
provided by the fields package, but the legend does not occur. I also 
tried the filled.contour function with no succes, either. I wonder 
weather image.plot cannot deal with S4 data to plot a legend. Can anyone 
help me to find out the mistake in my processing steps or is there 
another simple way to create an imagelegend plot of an satellite image 
whithout transfroming it into a matrix (matrix will lose automated 
coordinate allocation to axes in the plot window and data has to be 
loaded into memory).

library(raster)
library(fields)

a1<-stack('layerstack_surf_sub')
d<-colors()
new.pallette <- colorRampPalette( c(d[34], d[142], d[27]) )
image.plot(a1 at layers[[19]],col=new.pallette(255))
?????????
###Error in if (del == 0 && to == 0) return(to) :
###Missing Value, where TRUE/FALSE needed
?????????

The image occur in defined colorscale, but without a legend!

Very Great Thanks in Advance!

Carsten


From lists at remoteinformation.com.au  Fri Oct 22 02:44:50 2010
From: lists at remoteinformation.com.au (Ben Madin)
Date: Fri, 22 Oct 2010 11:44:50 +1100
Subject: [R-sig-Geo] Error in readOGR / ogrInfo
In-Reply-To: <alpine.LRH.2.00.1010211959280.4450@reclus.nhh.no>
References: <7F017C08-93DC-4E63-A039-DBEF904997AD@remoteinformation.com.au>
	<alpine.LRH.2.00.1010211959280.4450@reclus.nhh.no>
Message-ID: <F0965B7C-B9AD-4C25-A345-5D6C72C8FEBD@remoteinformation.com.au>

Thanks Roger,

On 22/10/2010, at 5:06 AM, Roger Bivand wrote:

> I don't run PostGIS, so cannot tell, nor OSX. Is the table named as given (what does the "public." prefix mean)? Can you use ogrinfo to examine the table itself rather than the list of tables? I assume that you know what you are doing; PostGIS is not something I know about.

the public. bit refers to the database schema - not something you probably wanted or needed to know, but ironically the clue to the problem - it seems that the tables had at some point (I'm not sure why or how, but I'm doing a few late nights) migrated to the public schema, but they were registered in the geometry columns table as being in the gms. schema. the ogrinfo looked for them, but couldn't find them, and just returned the full list of tables.

It seems that the R ogrInfo() might have stopped if they weren't in the geometry columns table. I don't know why, but they are now all in the same schema and it seems happy enough. Specifying the different schemas in the dsn (schemas=gms,public) didn't seem to overcome this issue.

>> My second question - why is it occurring in R, but not (apparently) a problem outside of R?
> 
> Most likely the OGR drivers in the GDAL shared object used by rgdal are not the same as those used by ogrinfo, QGIS, etc., elsewhere. How did you install rgdal - as a binary package (from where) or as a source package? If the latter, do you have multiple GDAL shared objects on your system?

The OGR box and dice (GDAL & rgdal) were installed using William Kyngesbury's Frameworks (R was from Simon Urbanek's page). It doesn't appear that this was the problem, the frameworks are the only gdal I can find.

>> My third question - am I on the right list?
> 
> Yes.

Thanks - I'm trying to finish my thesis, and I appreciate the speedy responses!

cheers

Ben


From r.hijmans at gmail.com  Fri Oct 22 04:28:32 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 21 Oct 2010 19:28:32 -0700
Subject: [R-sig-Geo] More problems with spTransform
In-Reply-To: <AANLkTikNUa5ZtO4=OQ_3PO47hH=GU53PfG57R3D_rpO_@mail.gmail.com>
References: <AANLkTikNUa5ZtO4=OQ_3PO47hH=GU53PfG57R3D_rpO_@mail.gmail.com>
Message-ID: <AANLkTi=WjM=PGUXe5XJX1L0+o4jGea=MYq0psvOtwPkU@mail.gmail.com>

Dear Manuel,

What is it about the map that looks wrong? What do you mean it has a
"longitud 0" (the projected coordinates do not refer to longitude).
Perhaps it is shifted in EW direction? Google (CRTM05) suggests that
you need to use a false easting, +x_0=500000.

Robert


On Thu, Oct 21, 2010 at 3:50 PM, Manuel Sp?nola <mspinola10 at gmail.com> wrote:
> Dear list members,
>
> I know that this is not a problem with the function, but I am trying to work
> with CRTM05 (for Costa Rica) with these parameters ("+proj=tmerc +lon_0=-84
> +lat_0=0 +k=0.9999 +datum=WGS84") . ?I am trying to project a map in
> geographic coordinates to CRTM05 but the projected map doesn't look right,
> it has a longitud 0.
>
>> corr = readOGR(dsn="C:/ProyectoRespacial/EvalHab_reporte",
> layer="corredor05unico") # en coordenadas geogr?ficas
> OGR data source with driver: ESRI Shapefile
> Source: "C:/ProyectoRespacial/EvalHab_reporte", layer: "corredor05unico"
> with 1 features and 4 fields
> Feature type: wkbPolygon with 2 dimensions
>
>> corr.transf = spTransform(corr, CRS("+proj=tmerc +lon_0=-84 +lat_0=0
> +k=0.9999 +datum=WGS84")) # para CRTM05
>> writeOGR(corr.transf,
> dsn="C:/ProyectoRespacial/CBSS/Shapefiles_proyectados",
> layer="corredorCRTM05", driver="ESRI Shapefile") # para escribir el shape
>> corre = readOGR(dsn="C:/ProyectoRespacial/CBSS/Shapefiles_proyectados",
> layer="corredorCRTM05")
> OGR data source with driver: ESRI Shapefile
> Source: "C:/ProyectoRespacial/CBSS/Shapefiles_proyectados", layer:
> "corredorCRTM05"
> with 1 features and 4 fields
> Feature type: wkbPolygon with 2 dimensions
>
>> proj4string(corre)
> [1] " +proj=tmerc +lat_0=0 +lon_0=-84 +k=0.9999 +x_0=0 +y_0=0 +ellps=WGS84
> +datum=WGS84 +units=m +no_defs +towgs84=0,0,0"
>
> Am I missing some parameter to do the right projection?
> Best,
>
> Manuel
>
> ? ? ? ?[[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


From Adrian.Baddeley at csiro.au  Fri Oct 22 05:21:25 2010
From: Adrian.Baddeley at csiro.au (Adrian.Baddeley at csiro.au)
Date: Fri, 22 Oct 2010 11:21:25 +0800
Subject: [R-sig-Geo] Spatstat: tessellation problems.
In-Reply-To: <4CBF37F2.4080804@hgu.mrc.ac.uk>
References: <4CBF37F2.4080804@hgu.mrc.ac.uk>
Message-ID: <57DC18C299094D4299F837570C5DF1C52C92D9AF90@EXWA-MBX01.nexus.csiro.au>

The bug that caused the following error message ..

> quadratcount(X, tess=Z)
> Warning message:
> In quadratcount.ppp(X, tess = Z) :
>  Tessellation does not contain all the points of X

.. has been fixed in the next version of spatstat (1.20-4) 
which has just been sent to CRAN.

regards
Adrian 


From r.hijmans at gmail.com  Fri Oct 22 06:07:23 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 21 Oct 2010 21:07:23 -0700
Subject: [R-sig-Geo] help to select a data.frame in fuction of ID
In-Reply-To: <AANLkTinumqOTpD+5i79XHqTcEeP1xjHrVVQBdmhMd3yE@mail.gmail.com>
References: <AANLkTinumqOTpD+5i79XHqTcEeP1xjHrVVQBdmhMd3yE@mail.gmail.com>
Message-ID: <AANLkTinrTLVXGsPRrBduWcBxWrxSndpXdTcK-O2=Nqd1@mail.gmail.com>

Gianni,

Is this what you are looking for?

mydata$limit2 <- mydata$limit * 2
mydata[mydata$H > mydata$limit2, ]

Robert

On Thu, Oct 21, 2010 at 9:06 AM, gianni lavaredo
<gianni.lavaredo at gmail.com> wrote:
> Dear Researchers,
>
> sorry If I ask a simple question, but this night I have no idea to resolv
> this question. I have a data.frame (just a simple example)
>
>
> mydata <- data.frame(id=c(1,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,5),
> H=c(1,30,43,67,33,78,90,45,4,8,34,3,82,94,12,15,62,89,3,56,96,3),
> limit=c(4,4,4,4,4,3,3,3,3,6,6,6,6,7,7,7,7,8,8,8,8,8))
>
>
> i wish to select by "id" the row with "H" value >= of the boulde of limit (H
>>= limit*2) to have a new data.frame
>
> mydata
> ? id ?H limit limit2
> 2 ? 1 30 ? ? 4 ? ? ?8
> 3 ? 1 43 ? ? 4 ? ? ?8
> 4 ? 1 67 ? ? 4 ? ? ?8
> 5 ? 1 33 ? ? 4 ? ? ?8
> 6 ? 2 78 ? ? 3 ? ? ?6
> 7 ? 2 90 ? ? 3 ? ? ?6
> 8 ? 2 45 ? ? 3 ? ? ?6
> 11 ?3 34 ? ? 6 ? ? 12
> 13 ?3 82 ? ? 6 ? ? 12
> 14 ?4 94 ? ? 7 ? ? 14
> 16 ?4 15 ? ? 7 ? ? 14
> 17 ?4 62 ? ? 7 ? ? 14
> 18 ?5 89 ? ? 8 ? ? 16
> 20 ?5 56 ? ? 8 ? ? 16
> 21 ?5 96 ? ? 8 ? ? 16
>
>
> thanks and sorry for desturb with easy question
>
> gianni
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From edzer.pebesma at uni-muenster.de  Fri Oct 22 11:36:31 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 22 Oct 2010 11:36:31 +0200
Subject: [R-sig-Geo] Help: CDF plot
In-Reply-To: <4CC09422.70200@cornell.edu>
References: <4C75ECB4.60503@csiro.au> <4CC089B0.8010208@cornell.edu>
	<4CC090A7.5090809@uni-muenster.de> <4CC09422.70200@cornell.edu>
Message-ID: <4CC15B1F.4060708@uni-muenster.de>




On 10/21/2010 09:27 PM, Zia Ahmed wrote:
>  Thanks again.  I want to create a plot  with  cdf of all realizations
> overlay with observed  cdf value  just for comparing the distribution
> of  all realizations  with observed data (instead of histogram). I have
> already done threshold part. I sed 1st, 5th and 9th decile values as
> thresholds.   Thanks
> Zia

maybe this? It compares the first realisation to those of the observations:

qqplot(lzn.sim$sim1, log(meuse$zinc))
abline(0,1)

It's of course questionable in the first place whether these two
distributions _should_ be equal!

> 
> On 10/21/2010 3:12 PM, Edzer Pebesma wrote:
>>
>> On 10/21/2010 08:42 PM, Zia Ahmed wrote:
>>>
>>>
>>> I want to write a R- function to make a CDF plot of all realizations
>>> (sim1, sim2, sim3........) with CDF of observed data (suppose zinc of
>>> muse data). Help will be appreciated
>> It can be me, but after reading your wish several times, I still don't
>> understand what you want. Do you want to make a cdf plot of each
>> realization?
>>
>> plot(ecdf(lzn.sim[[1]])) # etc
>>
>> Or for each location over all realizations? For threshold z:
>>
>> z = 5.0
>> nsim = 6
>> lzn.sim$z = apply(as.data.frame(lzn.sim)[-(1:2)]<= z, 1, sum)/nsim
>> spplot(lzn.sim["z"])
>>
>> Or of the observed values?
>>
>> plot(ecdf(meuse$zinc))
>>
>>> Thanks
>>> Zia
>>>
>>> library(gstat)
>>>
>>> data(meuse)
>>>
>>> data(meuse.grid)
>>>
>>> coordinates(meuse) = ~x + y
>>>
>>> coordinates(meuse.grid) = ~x + y
>>>
>>> lzn.vgm<- variogram(log(zinc) ~ 1, meuse)
>>>
>>> lzn.fit<- fit.variogram(lzn.vgm, model = vgm(1, "Sph", 900, 1))
>>>
>>> lzn.sim<- krige(log(zinc) ~ 1, meuse, meuse.grid, v.fit, nsim = 6, nmax
>>> = 40)
>>>
>>> /lzn.sim at data<- exp(lzn.sim at data)/
>>>
>>> / /
>>>
>>>
>>> / /
>>>
>>>
>>>
>>>
>>>
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From jmburgos at uw.edu  Fri Oct 22 14:07:45 2010
From: jmburgos at uw.edu (Julian Burgos)
Date: Fri, 22 Oct 2010 12:07:45 +0000
Subject: [R-sig-Geo] problem with spTransform and SpatialPixelsDataFrame
In-Reply-To: <alpine.LRH.2.00.1010200851120.16077@reclus.nhh.no>
References: <AANLkTi=TtPPYuda0RPS_0QSEEMxA-V3HEXsg+G=C=Q_h@mail.gmail.com>
	<alpine.LRH.2.00.1010200851120.16077@reclus.nhh.no>
Message-ID: <AANLkTi=84DRHMRgEUNhir54GMtb-tz+j+64zkReqFr86@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101022/9ea54d41/attachment.pl>

From dazhi.jiao at gmail.com  Fri Oct 22 15:40:23 2010
From: dazhi.jiao at gmail.com (Dazhi Jiao)
Date: Fri, 22 Oct 2010 09:40:23 -0400
Subject: [R-sig-Geo] How to map longitude/latitude to shapes
Message-ID: <AANLkTi=RjCRWehZBaSt2pmOTg5n6ct4iidcN_5W7pEWg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101022/5994aac5/attachment.pl>

From dan.putler at sauder.ubc.ca  Fri Oct 22 17:24:02 2010
From: dan.putler at sauder.ubc.ca (Dan Putler)
Date: Fri, 22 Oct 2010 08:24:02 -0700
Subject: [R-sig-Geo] How to map longitude/latitude to shapes
In-Reply-To: <26704_1287754910_1287754910_AANLkTi=RjCRWehZBaSt2pmOTg5n6ct4iidcN_5W7pEWg@mail.gmail.com>
References: <26704_1287754910_1287754910_AANLkTi=RjCRWehZBaSt2pmOTg5n6ct4iidcN_5W7pEWg@mail.gmail.com>
Message-ID: <4CC1AC92.5090607@sauder.ubc.ca>

Hi Dazhi,

The way to do this is use a point-in-polygon test. The sp package (which 
maptools has as a dependency) has the function point.in.polygon which 
performs a point in polygon test.

Dan

On 10/22/2010 06:40 AM, Dazhi Jiao wrote:
> Hi,
>
> I am new to spatial data analysis so sorry to ask a dummy question. I am
> trying to use R maptools to map longitude/latitude to a list of school
> districts. I have read in the shapefile and there are about 500 polygons.
> Now given a new point with longitude and latitude, how can I decide which
> polygon it belongs to?
>
> Thank you!
>
> Dazhi
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From mspinola10 at gmail.com  Fri Oct 22 17:52:23 2010
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Fri, 22 Oct 2010 09:52:23 -0600
Subject: [R-sig-Geo] More problems with spTransform
In-Reply-To: <AANLkTi=WjM=PGUXe5XJX1L0+o4jGea=MYq0psvOtwPkU@mail.gmail.com>
References: <AANLkTikNUa5ZtO4=OQ_3PO47hH=GU53PfG57R3D_rpO_@mail.gmail.com>
	<AANLkTi=WjM=PGUXe5XJX1L0+o4jGea=MYq0psvOtwPkU@mail.gmail.com>
Message-ID: <AANLkTikt-7VxnzapkirS3UJC3qeHZY4WjFoGJJhBtsnx@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101022/95239b78/attachment.pl>

From m.fairbrother at bristol.ac.uk  Fri Oct 22 19:26:31 2010
From: m.fairbrother at bristol.ac.uk (Malcolm Fairbrother)
Date: Fri, 22 Oct 2010 18:26:31 +0100
Subject: [R-sig-Geo] joining two polygons into a single polygon region?
In-Reply-To: <mailman.13.1287741604.27092.r-sig-geo@stat.math.ethz.ch>
References: <mailman.13.1287741604.27092.r-sig-geo@stat.math.ethz.ch>
Message-ID: <3F8C333D-9504-42D7-93DC-6B717BEAC648@bristol.ac.uk>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101022/4452ffe4/attachment.pl>

From Roger.Bivand at nhh.no  Fri Oct 22 21:01:24 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 22 Oct 2010 21:01:24 +0200 (CEST)
Subject: [R-sig-Geo] joining two polygons into a single polygon region?
In-Reply-To: <3F8C333D-9504-42D7-93DC-6B717BEAC648@bristol.ac.uk>
References: <mailman.13.1287741604.27092.r-sig-geo@stat.math.ethz.ch>
	<3F8C333D-9504-42D7-93DC-6B717BEAC648@bristol.ac.uk>
Message-ID: <alpine.LRH.2.00.1010222046270.13766@reclus.nhh.no>

On Fri, 22 Oct 2010, Malcolm Fairbrother wrote:

> Dear all,
>
> I'm working with a SpatialPolygonsDataFrame, with 176 rows. This is a 
> subset of an RData file downloaded from http://www.gadm.org/country
>
> One row corresponds to the main part of the Indian subdistrict Hubli 
> which you can see here: http://www.dharwad.nic.in/dist_dwd.htm. 
> Currently, a *separate* row in the SpatialPolygonsDataFrame corresponds 
> to the smaller part of the same subdistrict, which as you can see is not 
> contiguous with the larger part of the subdistrict.

Thank you for a full report, this makes things much easier to analyse!

>
> If possible, I'd like to merge the two rows, so that a single row in the 
> SpatialPolygonsDataFrame corresponds to *both* parts of Hubli subregion 
> (and the polygons slot for this row describes both parts of the 
> subdistrict, recognising that they are not contiguous). Is this 
> possible?

The downloaded RData file for India at GADM level 3 contains the 
SpatialPolygonsDataFrame object gadm:

karnat <- gadm[gadm$NAME_1 == "Karnataka",]
dharwad <- karnat[karnat$NAME_2 == "Dharwad",]
plot(dharwad)
text(coordinates(dharwad), labels=as.character(dharwad$NAME_3))

shows that there is a problem. The sub-polygon has NAME_3 given as
"n.a. ( 1897)" not "Hubli". There is one other detached polygon (I think) 
that will need attention: "n.a. ( 2050)". Add an extra variable to karnak:

karnak$NNAMES_3 <- karnak$NAMES_3
karnak$NNAMES_3[karnak$NNAMES_3 == "n.a. ( 1897)"] <- "Hubli"

and make the similar substitution for "n.a. ( 2050)".


>
> My impression is that unionSpatialPolygons might be the function I need, 
> but I haven't been able to figure out the right syntax, and haven't had 
> any luck searching this list's archives. From the help page, I thought 
> that I might need something like:

Then you merge the SpatialPolygons by:

library(maptools)
library(gpclib)
gpclibPermit() # never for non-educational purposes
karnak_1 <- unionSpatialPolygons(as(karnak), "SpatialPolygons"),
   IDs=as.character(karnak$NNAME_3))

which will be identified by the unique values of karnak$NNAME_3.

>
> reg <- 1:dim(karnat)[1] # karnat is my SpatialPolygonsDataFrame
> reg[78] < reg[75]
> karnat2 <- unionSpatialPolygons(karnat, reg) # an attempt to merge or combine rows 75 and 78

This works with reg[78] <- reg[75] and gpclibPermit(), but the region IDs 
are uninformative, and would be hard to match against at the next stage. 
It's better to use informative IDs that are clear and unique. Because the 
output object has no data slot, the IDs are the only way of knowing which 
multipolygon is which.

Hope this helps,

Roger

>
> But this isn't working at all, and I'm a bit stuck. If you can see what 
> I'm trying to do, can anyone suggest the syntax I want?
>
> Any help would be much appreciated.
>
> - Malcolm
>
>
> Dr Malcolm Fairbrother
> Lecturer
> School of Geographical Sciences
> University of Bristol
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From mspinola10 at gmail.com  Fri Oct 22 21:01:50 2010
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Fri, 22 Oct 2010 13:01:50 -0600
Subject: [R-sig-Geo] Loosing information when projecting and writing a
	shapefile with rgdal
Message-ID: <AANLkTi=ZDp7jS_B5-ud7o5sc5sEmyh3W93ShByL8qt69@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101022/56e6ba99/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Sat Oct 23 00:32:34 2010
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Fri, 22 Oct 2010 23:32:34 +0100
Subject: [R-sig-Geo] Loosing information when projecting and writing a
 shapefile with rgdal
In-Reply-To: <AANLkTi=ZDp7jS_B5-ud7o5sc5sEmyh3W93ShByL8qt69@mail.gmail.com>
References: <AANLkTi=ZDp7jS_B5-ud7o5sc5sEmyh3W93ShByL8qt69@mail.gmail.com>
Message-ID: <AANLkTimEkfdKWL0zdVF=xngbuvtdtYKMJmHM+oovZ4U5@mail.gmail.com>

On Fri, Oct 22, 2010 at 8:01 PM, Manuel Sp?nola <mspinola10 at gmail.com> wrote:

> cob.transf = spTransform(cob, CRS("+proj=tmerc +lon_0=-84 +lat_0=0
> +x_0=500000 +k=0.9999 +datum=WGS84")) # to CRTM05

 Is it just a typo? You called it 'cob.transf' above, but below you've
written 'corr.transf':

> writeOGR(corr.transf,
> dsn="C:/ProyectoRespacial/CBSS/Shapefiles_proyectados",
> layer="coberturaCRTM05", driver="ESRI Shapefile")

?

--
blog: http://geospaced.blogspot.com/
web: http://www.maths.lancs.ac.uk/~rowlings
web: http://www.rowlingson.com/
twitter: http://twitter.com/geospacedman
pics: http://www.flickr.com/photos/spacedman


From Lee.Hachadoorian+L at gmail.com  Sat Oct 23 05:06:10 2010
From: Lee.Hachadoorian+L at gmail.com (Lee Hachadoorian)
Date: Fri, 22 Oct 2010 23:06:10 -0400
Subject: [R-sig-Geo] Error in readOGR / ogrInfo
In-Reply-To: <F0965B7C-B9AD-4C25-A345-5D6C72C8FEBD@remoteinformation.com.au>
References: <7F017C08-93DC-4E63-A039-DBEF904997AD@remoteinformation.com.au>	<alpine.LRH.2.00.1010211959280.4450@reclus.nhh.no>
	<F0965B7C-B9AD-4C25-A345-5D6C72C8FEBD@remoteinformation.com.au>
Message-ID: <i9tjfj$ebk$1@dough.gmane.org>

Ben,

schema=<schema> cannot be used in a Postgres DSN. Apparently (I haven't
tried it) you can use ConnSettings in the Postgres ODBC driver to pass
in a number of different settings otherwise unsupported, but
ConnSettings doesn't seem to be supported in rgdal.

But jumping through hoops to get that to work probably isn't the way to
go. Just use the schema qualified table name. If you would prefer to
have your table seaplus_countries in schema gms, you just need to do

readOGR("PG:dbname=gms user=benmadin password=xdi4frt",
"gms.seaplus_countries")

Note that you would run into a similar problem with straight SQL. If
seaplus_countries moved to schema gms,

SELECT * FROM seaplus_countries;

would not work either. (But you probably know that.)

With a little testing it seems that rgdal returns "GDAL Error 1: No
field definitions found for 'geo_li_tracts', is it a table?" when it
can't find the table, and returns "Layer not found" when it *can* find
the table, but the table is not registered in geometry_columns.

Interstingly, while specifying public.table_name in SQL is harmless,
when I tried it in rgdal, I got the "Layer not found" error, even though
the table was properly registered in geometry_columns.

--Lee

-- 
Lee Hachadoorian
PhD Student, Geography
Program in Earth & Environmental Sciences
CUNY Graduate Center

On 10/21/2010 08:44 PM, Ben Madin wrote:
> the public. bit refers to the database schema - not something you probably wanted or needed to know, but ironically the clue to the problem - it seems that the tables had at some point (I'm not sure why or how, but I'm doing a few late nights) migrated to the public schema, but they were registered in the geometry columns table as being in the gms. schema. the ogrinfo looked for them, but couldn't find them, and just returned the full list of tables.
> 
> It seems that the R ogrInfo() might have stopped if they weren't in the geometry columns table. I don't know why, but they are now all in the same schema and it seems happy enough. Specifying the different schemas in the dsn (schemas=gms,public) didn't seem to overcome this issue.


From govindas at msu.edu  Sun Oct 24 02:41:34 2010
From: govindas at msu.edu (govindas at msu.edu)
Date: Sat, 23 Oct 2010 20:41:34 -0400
Subject: [R-sig-Geo] issue with creating .ncdf file in R
Message-ID: <20101023204134.147662r3nzaftdj2@mail.msu.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101023/271befaf/attachment.pl>

From martin_brandt at gmx.net  Sun Oct 24 11:05:20 2010
From: martin_brandt at gmx.net (Martin)
Date: Sun, 24 Oct 2010 02:05:20 -0700 (PDT)
Subject: [R-sig-Geo] Grass and raster package
Message-ID: <1287911120433-5667199.post@n2.nabble.com>


Dear all,

is it possible to load a complete Grass mapset into a raster stack or brick
with a single command? 

-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Grass-and-raster-package-tp5667199p5667199.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From dmsilv at gmail.com  Sun Oct 24 19:55:05 2010
From: dmsilv at gmail.com (Daniel)
Date: Sun, 24 Oct 2010 15:55:05 -0200
Subject: [R-sig-Geo] Why I can't install RGDAL after R 2.12.0 release?
Message-ID: <AANLkTimHqvcv6wAByRG1neHodS6vcXbV87tWgAOKu4ky@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101024/16f2a9dd/attachment.pl>

From Roger.Bivand at nhh.no  Sun Oct 24 21:34:58 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sun, 24 Oct 2010 21:34:58 +0200 (CEST)
Subject: [R-sig-Geo] Why I can't install RGDAL after R 2.12.0 release?
In-Reply-To: <AANLkTimHqvcv6wAByRG1neHodS6vcXbV87tWgAOKu4ky@mail.gmail.com>
References: <AANLkTimHqvcv6wAByRG1neHodS6vcXbV87tWgAOKu4ky@mail.gmail.com>
Message-ID: <alpine.LRH.2.00.1010242118590.23670@reclus.nhh.no>

On Sun, 24 Oct 2010, Daniel wrote:

> Why I can't install RGDAL after R 2.12.0 release?
> I install again GDAL, but I still got the error.

Well, you could start by reading the explanatory message. In addition, you 
have an OSX system (saying so would make things simpler). Beyond that, you 
have not been using a local library in which to install your packages (I 
think) so that when R is upgraded, the old system library is no longer 
visible. This is a very good reason to use a local library - upgrading R 
does not then remove your installed contributed libraries.

The message says that gdal-config cannot be found. Find it, and add its 
path to the configure argument.

Hope this helps,

Roger

PS. On OSX, if installing the rgdal source package is impractical, 
consider installing binary packages either using Kyngchaos:

http://www.kyngchaos.com/software/frameworks

for R 2.10 or 2.11 (not 2.12 yet), or (with fewer drivers) in R say:

setRepositories(ind=1:2)
install.packages("rgdal")

from CRAN extras for leopard+.

>
> Daniel
>
> downloaded 1.4 Mb
>
> * installing *source* package ?rgdal? ...
> gdal-config: gdal-config
> Error: gdal-config not found
> The gdal-config script distributed with GDAL could not be found.
> If you have not installed the GDAL libraries, you can
> download the source from  http://www.gdal.org/
> If you have installed the GDAL libraries, then make sure that
> gdal-config is in your path. Try typing gdal-config at a
> shell prompt and see if it runs. If not, use:
> --configure-args='--with-gdal-config=/usr/local/bin/gdal-config' echo with
> appropriate values for your installation.
>
> ./configure: line 1311: gdal-config: command not found
> ERROR: configuration failed for package ?rgdal?
> * removing
> ?/Library/Frameworks/R.framework/Versions/2.12/Resources/library/rgdal?
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From ashenkin at ufl.edu  Mon Oct 25 01:44:21 2010
From: ashenkin at ufl.edu (Alexander Shenkin)
Date: Sun, 24 Oct 2010 18:44:21 -0500
Subject: [R-sig-Geo] Calculating areas from point data?
Message-ID: <4CC4C4D5.9090409@ufl.edu>

Hello All,

I laid out polygons based on a transect tape, and perpendicular
distances from that tape.  So, for example, one polygon could be 48m
long, at 10m, one point lies 5m to the right, at 15m another point lies
8m to the left, etc.  Connecting those points creates the polygon.

I am interested in calculating the area of those polygons.  I'm not sure
if R has a package that makes such calculations, or if I'd be better off
using something else - I'm really not sure where to turn to do this. 
Any suggestions would be greatly appreciated.

Thanks,
Allie


From r.turner at auckland.ac.nz  Mon Oct 25 01:54:18 2010
From: r.turner at auckland.ac.nz (Turner Rolf)
Date: Mon, 25 Oct 2010 12:54:18 +1300
Subject: [R-sig-Geo] Calculating areas from point data?
In-Reply-To: <4CC4C4D5.9090409@ufl.edu>
References: <4CC4C4D5.9090409@ufl.edu>
Message-ID: <2FECBA36D6EF8645A9D736633F186F815EFD7B11FA@foedmail02n>


________________________________________
From: r-sig-geo-bounces at stat.math.ethz.ch [r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of Alexander Shenkin [ashenkin at ufl.edu]
Sent: Monday, 25 October 2010 12:44 p.m.
To: r-sig-geo at stat.math.ethz.ch
Subject: [R-sig-Geo] Calculating areas from point data?

Hello All,

I laid out polygons based on a transect tape, and perpendicular
distances from that tape.  So, for example, one polygon could be 48m
long, at 10m, one point lies 5m to the right, at 15m another point lies
8m to the left, etc.  Connecting those points creates the polygon.

I am interested in calculating the area of those polygons.  I'm not sure
if R has a package that makes such calculations, or if I'd be better off
using something else - I'm really not sure where to turn to do this.
Any suggestions would be greatly appreciated.


The spatstat package has such facilities.

       cheers,

             Rolf Turner

From Roger.Bivand at nhh.no  Mon Oct 25 10:08:51 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 25 Oct 2010 10:08:51 +0200 (CEST)
Subject: [R-sig-Geo] Calculating areas from point data?
In-Reply-To: <4CC4C4D5.9090409@ufl.edu>
References: <4CC4C4D5.9090409@ufl.edu>
Message-ID: <alpine.LRH.2.00.1010251006410.26068@reclus.nhh.no>

On Sun, 24 Oct 2010, Alexander Shenkin wrote:

> Hello All,
>
> I laid out polygons based on a transect tape, and perpendicular
> distances from that tape.  So, for example, one polygon could be 48m
> long, at 10m, one point lies 5m to the right, at 15m another point lies
> 8m to the left, etc.  Connecting those points creates the polygon.
>
> I am interested in calculating the area of those polygons.  I'm not sure
> if R has a package that makes such calculations, or if I'd be better off
> using something else - I'm really not sure where to turn to do this.
> Any suggestions would be greatly appreciated.

library(sp)
x <- c(0, 15, 48, 10, 0)
y <- c(0, -8, 0, 5, 0)
slot(Polygon(cbind(x, y)), "area")

or:

library(spatstat)
owin(poly=list(x=x[-5], y=y[-5]))$bdry[[1]]$area

both work, treating the tape line as the x axis, and perpendicular 
distances from it as the y axis.

Hope this helps,

Roger

>
> Thanks,
> Allie
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From martin_brandt at gmx.net  Mon Oct 25 13:58:40 2010
From: martin_brandt at gmx.net (Martin)
Date: Mon, 25 Oct 2010 04:58:40 -0700 (PDT)
Subject: [R-sig-Geo] Grass and raster package
In-Reply-To: <1287911120433-5667199.post@n2.nabble.com>
References: <1287911120433-5667199.post@n2.nabble.com>
Message-ID: <1288007920225-5670360.post@n2.nabble.com>


i found a solution, if someone else is interested:

system("g.mlist type=rast pattern='lin*' >tmp")

k=c(scan("tmp", what='string'))  

x=readRAST6(k)

b=brick(x)
-- 
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Grass-and-raster-package-tp5667199p5670360.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Roger.Bivand at nhh.no  Mon Oct 25 14:31:00 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 25 Oct 2010 14:31:00 +0200 (CEST)
Subject: [R-sig-Geo] Grass and raster package
In-Reply-To: <1288007920225-5670360.post@n2.nabble.com>
References: <1287911120433-5667199.post@n2.nabble.com>
	<1288007920225-5670360.post@n2.nabble.com>
Message-ID: <alpine.LRH.2.00.1010251427200.26068@reclus.nhh.no>

On Mon, 25 Oct 2010, Martin wrote:

>
> i found a solution, if someone else is interested:
>
> system("g.mlist type=rast pattern='lin*' >tmp")
>
> k=c(scan("tmp", what='string'))

Indeed, using GRASS itself often helps! You can simplify to:

k <- execGRASS("g.mlist", parameters=list(type="rast",
   pattern="'elev*'"), intern=TRUE)

(example tried in spearfish, also works in Linux with pattern="elev*")

Roger

>
> x=readRAST6(k)
>
> b=brick(x)
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From ricardorodot02 at gmail.com  Mon Oct 25 18:39:39 2010
From: ricardorodot02 at gmail.com (=?ISO-8859-1?Q?Ricardo_Rodr=EDguez?=)
Date: Mon, 25 Oct 2010 11:39:39 -0500
Subject: [R-sig-Geo] trouble with plotting maps in pdf
Message-ID: <AANLkTinvDoapai+B7zd5ANLMz1nOhPqzW+o6X8ma0pMB@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101025/16f9c3b5/attachment.pl>

From alaios at yahoo.com  Mon Oct 25 18:50:16 2010
From: alaios at yahoo.com (Alaios)
Date: Mon, 25 Oct 2010 09:50:16 -0700 (PDT)
Subject: [R-sig-Geo] how to zoom
Message-ID: <713983.91972.qm@web120107.mail.ne1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101025/064f92f9/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Mon Oct 25 18:56:43 2010
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Mon, 25 Oct 2010 17:56:43 +0100
Subject: [R-sig-Geo] trouble with plotting maps in pdf
In-Reply-To: <AANLkTinvDoapai+B7zd5ANLMz1nOhPqzW+o6X8ma0pMB@mail.gmail.com>
References: <AANLkTinvDoapai+B7zd5ANLMz1nOhPqzW+o6X8ma0pMB@mail.gmail.com>
Message-ID: <AANLkTim7dEFMKzQNmwQ6gYADmmFHbAB2Q-9yyEooN57G@mail.gmail.com>

On Mon, Oct 25, 2010 at 5:39 PM, Ricardo Rodr?guez
<ricardorodot02 at gmail.com> wrote:

> ? ? ? ? ? ?print(spplot(Rmap1["var1.pred"], AXES = TRUE,
> col.regions=bpy.colors(20),xlab="E-O",ylab="S-N"),scales=list(draw=TRUE),main="map
> 1")

 First, spplot doesn't do AXES=TRUE, so I don't know where you got that from.

 Secondly, your 'main' and 'scales' parameter are outside your spplot call.

 print(
   spplot(
     Rmap1["var1.pred"],
     AXES = TRUE,
     col.regions=bpy.colors(20),
     xlab="E-O",ylab="S-N"
     ), # end of spplot
 scales=list(draw=TRUE),main="map 1"
) # end of print

Put them inside the right parenthesis and they'll work...

Barry


From edzer.pebesma at uni-muenster.de  Mon Oct 25 19:26:18 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 25 Oct 2010 19:26:18 +0200
Subject: [R-sig-Geo] how to zoom
In-Reply-To: <713983.91972.qm@web120107.mail.ne1.yahoo.com>
References: <713983.91972.qm@web120107.mail.ne1.yahoo.com>
Message-ID: <4CC5BDBA.1010607@uni-muenster.de>



On 10/25/2010 06:50 PM, Alaios wrote:
> in a simple plot. When i do plot is it possible to zoom in or out or this is not 
> possible at all?

zooming is not the standard behaviour of an R plotting device. But you
could of course plot to a pdf, and zoom with its viewer, or set the xlim
and ylim arguments of the plot.

> Best Regards
> Alex
> 
> 
> 
>       
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From eric.jabot at ujf-grenoble.fr  Tue Oct 26 09:02:49 2010
From: eric.jabot at ujf-grenoble.fr (eric.jabot at ujf-grenoble.fr)
Date: Tue, 26 Oct 2010 09:02:49 +0200 (CEST)
Subject: [R-sig-Geo] KED trend coefficients in Gstat with R
In-Reply-To: <2610.194.254.67.151.1288011411.squirrel@mail.lthe.fr>
References: <2610.194.254.67.151.1288011411.squirrel@mail.lthe.fr>
Message-ID: <1133.194.254.67.151.1288076569.squirrel@mail.lthe.fr>

Hello,

I would like to know if there is a way to get the trend coefficents when
doing kriging with external drift. I would like to compare with the
coefficients that I can have when doing temperature = f(altitude) for a
sample of stations.
Thanks for your answer(s).

Eric


From edzer.pebesma at uni-muenster.de  Tue Oct 26 09:17:26 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 26 Oct 2010 09:17:26 +0200
Subject: [R-sig-Geo] KED trend coefficients in Gstat with R
In-Reply-To: <1133.194.254.67.151.1288076569.squirrel@mail.lthe.fr>
References: <2610.194.254.67.151.1288011411.squirrel@mail.lthe.fr>
	<1133.194.254.67.151.1288076569.squirrel@mail.lthe.fr>
Message-ID: <4CC68086.9080807@uni-muenster.de>



On 10/26/2010 09:02 AM, eric.jabot at ujf-grenoble.fr wrote:
> Hello,
> 
> I would like to know if there is a way to get the trend coefficents when
> doing kriging with external drift. I would like to compare with the
> coefficients that I can have when doing temperature = f(altitude) for a
> sample of stations.
> Thanks for your answer(s).
> 
> Eric
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Eric, try

library(gstat)
demo(blue)

shows you one way how to do this. It is a bit tricky, because you're
using prediction equations (that disregard the residual, if BLUE=TRUE)
to get them. But then, in the end if your regression model is

  beta0 * Intercept + beta1 * altitude,

setting Intercept to 0 and altitude to 1 gives you beta1, with its
estimation error.

Another, maybe more direct way could be find by using the mixed models
in package nlme.
-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From hengl at spatial-analyst.net  Tue Oct 26 10:48:22 2010
From: hengl at spatial-analyst.net (Tomislav Hengl)
Date: Tue, 26 Oct 2010 10:48:22 +0200
Subject: [R-sig-Geo] KED trend coefficients in Gstat with R
In-Reply-To: <4CC68086.9080807@uni-muenster.de>
References: <2610.194.254.67.151.1288011411.squirrel@mail.lthe.fr>	<1133.194.254.67.151.1288076569.squirrel@mail.lthe.fr>
	<4CC68086.9080807@uni-muenster.de>
Message-ID: <4CC695D6.9080003@spatial-analyst.net>


Op 26-10-2010 9:17, Edzer Pebesma schreef:
>
>
> On 10/26/2010 09:02 AM, eric.jabot at ujf-grenoble.fr wrote:
>> Hello,
>>
>> I would like to know if there is a way to get the trend coefficents when
>> doing kriging with external drift. I would like to compare with the
>> coefficients that I can have when doing temperature = f(altitude) for a
>> sample of stations.
>> Thanks for your answer(s).
>>
>> Eric
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> Eric, try
>
> library(gstat)
> demo(blue)
>
> shows you one way how to do this. It is a bit tricky, because you're
> using prediction equations (that disregard the residual, if BLUE=TRUE)
> to get them. But then, in the end if your regression model is
>
>    beta0 * Intercept + beta1 * altitude,
>
> setting Intercept to 0 and altitude to 1 gives you beta1, with its
> estimation error.
>
> Another, maybe more direct way could be find by using the mixed models
> in package nlme.


You might want to take a look at how geoR package does this. geoR does 
print by default the regression coefficients (which I think any RK/KED 
system should always do) e.g.:

 > zinc.rvgm2 <- likfit(zinc.geo, lambda=0, 
trend=step.zinc$call$formula[c(1,3)],
+ messages=FALSE, ini=c(var(residuals(step.zinc)),500), 
cov.model="exponential")
 > zinc.rvgm2
likfit: estimated model parameters:
beta0 beta1 beta2 beta3 beta4 beta5
" 5.6919" " -0.4028" " -0.1203" " -0.0176" " 0.0090" " -0.3199"
tausq sigmasq phi
" 0.0526" " 0.1894" "499.9983"
Practical Range with cor=0.05 for asymptotic range: 1498
likfit: maximised log-likelihood = -975

See also p.143 in [http://spatial-analyst.net/book/GstatIntro]

T. Hengl
http://www.wewur.wur.nl/popups/vcard.aspx?id=HENGL001


From jgarcia at ija.csic.es  Tue Oct 26 13:04:47 2010
From: jgarcia at ija.csic.es (jgarcia at ija.csic.es)
Date: Tue, 26 Oct 2010 13:04:47 +0200 (CEST)
Subject: [R-sig-Geo] eculidean threshold for clustering
In-Reply-To: <1287911120433-5667199.post@n2.nabble.com>
References: <1287911120433-5667199.post@n2.nabble.com>
Message-ID: <1410.88.2.120.143.1288091087.squirrel@paleo.ija.csic.es>

Dear all,
I am wondering if there is a direct function (I cannot find any) in R, to
obtain, a "factor" vector to identify which points could be grouped in a
set, using a specific threshold distance as clustering criterion.

#e.g, with 7 points with coordinates:

x <- c(1.01,0.95,1.05,1.03,3.03,2.99,3.04)
y <- c(3.01,3.02,3.04,5.23,2.01,2.02,1.98)

# and, let's say, distance threshold 0.5, the answer would be:
(1,1,1,2,3,3,3)

# where the threshold is the maximum distance between any two points for
each cluster

A better approach would be that threshold could be specified as the
distance between any point in each cluster, and its corresponding center
of mass for that cluster, but I guess this would require some loops. Isn't
it? S, I would be happy enough with the abovementioned approach.

If there isn't a direct function, don't worry. I'll try to find a solution
computing distances...

Thanks,
Javier
---




> is it possible to load a complete Grass mapset into a raster stack or
> brick
> with a single command?
>
> --
> View this message in context:
> http://r-sig-geo.2731867.n2.nabble.com/Grass-and-raster-package-tp5667199p5667199.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From Roger.Bivand at nhh.no  Tue Oct 26 13:05:06 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 26 Oct 2010 13:05:06 +0200 (CEST)
Subject: [R-sig-Geo] eculidean threshold for clustering
In-Reply-To: <1410.88.2.120.143.1288091087.squirrel@paleo.ija.csic.es>
References: <1287911120433-5667199.post@n2.nabble.com>
	<1410.88.2.120.143.1288091087.squirrel@paleo.ija.csic.es>
Message-ID: <alpine.LRH.2.00.1010261302330.3665@reclus.nhh.no>

On Tue, 26 Oct 2010, jgarcia at ija.csic.es wrote:

> Dear all,
> I am wondering if there is a direct function (I cannot find any) in R, to
> obtain, a "factor" vector to identify which points could be grouped in a
> set, using a specific threshold distance as clustering criterion.
>
> #e.g, with 7 points with coordinates:
>
> x <- c(1.01,0.95,1.05,1.03,3.03,2.99,3.04)
> y <- c(3.01,3.02,3.04,5.23,2.01,2.02,1.98)

library(spdep)
dnb <- dnearneigh(cbind(x, y), 0, 0.5)
n.comp.nb(dnb)$comp.id
# [1] 1 1 1 2 3 3 3

>
> # and, let's say, distance threshold 0.5, the answer would be:
> (1,1,1,2,3,3,3)
>
> # where the threshold is the maximum distance between any two points for
> each cluster
>
> A better approach would be that threshold could be specified as the
> distance between any point in each cluster, and its corresponding center
> of mass for that cluster, but I guess this would require some loops. Isn't
> it? S, I would be happy enough with the abovementioned approach.

I think that this might need hierarchical clustering and custom cut-offs 
and # clusters.

Hope this helps,

Roger

>
> If there isn't a direct function, don't worry. I'll try to find a solution
> computing distances...
>
> Thanks,
> Javier
> ---
>
>
>
>
>> is it possible to load a complete Grass mapset into a raster stack or
>> brick
>> with a single command?
>>
>> --
>> View this message in context:
>> http://r-sig-geo.2731867.n2.nabble.com/Grass-and-raster-package-tp5667199p5667199.html
>> Sent from the R-sig-geo mailing list archive at Nabble.com.
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From marcelino.delacruz at upm.es  Tue Oct 26 13:53:22 2010
From: marcelino.delacruz at upm.es (Marcelino de la Cruz)
Date: Tue, 26 Oct 2010 13:53:22 +0200
Subject: [R-sig-Geo] eculidean threshold for clustering
In-Reply-To: <1410.88.2.120.143.1288091087.squirrel@paleo.ija.csic.es>
References: <1287911120433-5667199.post@n2.nabble.com>
	<1410.88.2.120.143.1288091087.squirrel@paleo.ija.csic.es>
Message-ID: <201010261153.o9QBrQ3L011770@smtp.upm.es>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101026/a7ed5a86/attachment.pl>

From jgarcia at ija.csic.es  Tue Oct 26 15:55:33 2010
From: jgarcia at ija.csic.es (jgarcia at ija.csic.es)
Date: Tue, 26 Oct 2010 15:55:33 +0200 (CEST)
Subject: [R-sig-Geo] eculidean threshold for clustering
In-Reply-To: <201010261153.o9QBrQ3L011770@smtp.upm.es>
References: <1287911120433-5667199.post@n2.nabble.com>
	<1410.88.2.120.143.1288091087.squirrel@paleo.ija.csic.es>
	<201010261153.o9QBrQ3L011770@smtp.upm.es>
Message-ID: <1158.95.124.175.163.1288101333.squirrel@paleo.ija.csic.es>

Thank you, Marcelino, Roger and Alexander,
I didn't know any of these.
Cheers,
Javier
...

> This seems a single linkage clustering issue:
>
>  > grouping <- hclust(dist(data.frame(x,y)),"single")
>  > cutree(grouping, h=0.5)
> [1] 1 1 1 2 3 3 3
>
> Cheers,
>
> Marcelino
>
>
>
> At 13:04 26/10/2010, jgarcia at ija.csic.es wrote:
>>Dear all,
>>I am wondering if there is a direct function (I cannot find any) in R, to
>>obtain, a "factor" vector to identify which points could be grouped in a
>>set, using a specific threshold distance as clustering criterion.
>>
>>#e.g, with 7 points with coordinates:
>>
>>x <- c(1.01,0.95,1.05,1.03,3.03,2.99,3.04)
>>y <- c(3.01,3.02,3.04,5.23,2.01,2.02,1.98)
>>
>># and, let's say, distance threshold 0.5, the answer would be:
>>(1,1,1,2,3,3,3)
>>
>># where the threshold is the maximum distance between any two points for
>>each cluster
>>
>>A better approach would be that threshold could be specified as the
>>distance between any point in each cluster, and its corresponding center
>>of mass for that cluster, but I guess this would require some loops.
>> Isn't
>>it? S, I would be happy enough with the abovementioned approach.
>>
>>If there isn't a direct function, don't worry. I'll try to find a
>> solution
>>computing distances...
>>
>>Thanks,
>>Javier
>>---
>>
>>
>>
>>
>> > is it possible to load a complete Grass mapset into a raster stack or
>> > brick
>> > with a single command?
>> >
>> > --
>> > View this message in context:
>> >
>> http://r-sig-geo.2731867.n2.nabble.com/Grass-and-raster-package-tp5667199p5667199.html
>> > Sent from the R-sig-geo mailing list archive at Nabble.com.
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at stat.math.ethz.ch
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >
>>
>>_______________________________________________
>>R-sig-Geo mailing list
>>R-sig-Geo at stat.math.ethz.ch
>>https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> ____________________________________
>
> Marcelino de la Cruz Rot
> Depto. Biologia Vegetal
> EUIT Agricola
> Universidad Politecnica de Madrid
>
> tel: 34 + 913365435
> ____________________________________


From yan_boulanger at hotmail.com  Tue Oct 26 15:59:03 2010
From: yan_boulanger at hotmail.com (Yan Boulanger)
Date: Tue, 26 Oct 2010 13:59:03 +0000
Subject: [R-sig-Geo] Spatial clustering using skater for similar adjacent
	polygons
In-Reply-To: <201010261153.o9QBrQ3L011770@smtp.upm.es>
References: <1287911120433-5667199.post@n2.nabble.com>,
	<1410.88.2.120.143.1288091087.squirrel@paleo.ija.csic.es>,
	<201010261153.o9QBrQ3L011770@smtp.upm.es>
Message-ID: <SNT124-W26418B41033F9248B89F338D420@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101026/ab72cda2/attachment.pl>

From matevz.pavlic at gi-zrmk.si  Tue Oct 26 19:03:27 2010
From: matevz.pavlic at gi-zrmk.si (=?iso-8859-2?Q?Matev=BE_Pavli=E8?=)
Date: Tue, 26 Oct 2010 19:03:27 +0200
Subject: [R-sig-Geo] "chfactor.c", line 130: error
Message-ID: <AD5CA6183570B54F92AA45CE2619F9B9D96669@gi-zrmk.si>

Hi, 

 

I saw a post on  R forum about the ["chfactor.c", line 130: singular matrix in function LDLfactor() ] error. I am experiencing the same error now and have tried pretty much all I could read about it and still haven had any luck with it. I have tried with the zerodist() and there are no duplicate point within the dataset. Could you please (if you can find the time) take a look at the attached data and r.code to see if you find any error. 

 

Thank you in advance, 

 

Regards, 

 

Matev?

 

 

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101026/1e0d89de/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/jpeg
Size: 9728 bytes
Desc: image001.jpg
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101026/1e0d89de/attachment.jpe>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: CatKriging_v2.r
Type: application/octet-stream
Size: 3028 bytes
Desc: CatKriging_v2.r
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101026/1e0d89de/attachment.obj>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: odel1.csv
Type: application/octet-stream
Size: 12317 bytes
Desc: odel1.csv
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101026/1e0d89de/attachment-0001.obj>

From reeves at nceas.ucsb.edu  Tue Oct 26 21:05:44 2010
From: reeves at nceas.ucsb.edu (Rick Reeves)
Date: Tue, 26 Oct 2010 12:05:44 -0700
Subject: [R-sig-Geo] Question re: Intamap package / Interpolate method:
 Inputs NOT both Spatial Points Data Frame?
Message-ID: <4CC72688.6040400@nceas.ucsb.edu>

Hello:

I note a conflict in the documentation for Intamap/interpolate(), need 
to know how to resolve:

I have two SpatalPointsDataFrame objects:

  growingDegreeObservations <- readShapePoints("OhioGDDStationsGP.shp")  
# computed surface phenomena, for individual lat/lon points
  OrgStaLocs <- readShapePoints("Org_Locations.shp")                    
# species observation stations, for DIFFERENT lat/lon points

# Objective: Interpolate the growingDegree points into a SpatialGrid (?) 
raster field, and then
# overlay the observation stations on to the field, and assign field 
values to each observation station points

# according to intamap documentation, the interpolate() method accepts 
two SptatialPointsDataFrame objects, interpolates
# the first ($value field) into a grid, and assigns interpolated 
observations to the predicted locations (monarchStaLocs).

interpImage <- interpolate(growingDegreeObservations 
,OrgStaLocs,list(mean=TRUE, variance=TRUE))

However, when this line is executed, the error occurs:

Error in function (classes, fdef, mtable)  :
   unable to find an inherited method for function "interpolate", for 
signature "SpatialPointsDataFrame"

I guess that this refers to the first argument, and that the argument 
must be a SpatialPixels or SpatialGrid data frame.
Questions:

1) Do I understand the inputs and outputs of interpolate() correctly?

2) How best to transform the incorrect (SpatialPointsDataFrame) argument
      to match the required inputs? E.G., create the interpolated 
SpatialPixelsDataFrame
      of observations before calling interpolate())

3) Is there a better R technique (e.g., direct call to krige()) for 
computing my solution?

Thanks, Rick R


From edzer.pebesma at uni-muenster.de  Tue Oct 26 21:07:17 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 26 Oct 2010 21:07:17 +0200
Subject: [R-sig-Geo] "chfactor.c", line 130: error
In-Reply-To: <AD5CA6183570B54F92AA45CE2619F9B9D96669@gi-zrmk.si>
References: <AD5CA6183570B54F92AA45CE2619F9B9D96669@gi-zrmk.si>
Message-ID: <4CC726E5.3090306@uni-muenster.de>

Your code runs fine here, at least up to the predict statement where you
got the error. Have you updated R and/or gstat packages recently? Could
you give the output of

sessionInfo()

after loading the packages needed?

On 10/26/2010 07:03 PM, Matev? Pavli? wrote:
> Hi, 
> 
>  
> 
> I saw a post on  R forum about the ["chfactor.c", line 130: singular matrix in function LDLfactor() ] error. I am experiencing the same error now and have tried pretty much all I could read about it and still haven had any luck with it. I have tried with the zerodist() and there are no duplicate point within the dataset. Could you please (if you can find the time) take a look at the attached data and r.code to see if you find any error. 
> 
>  
> 
> Thank you in advance, 
> 
>  
> 
> Regards, 
> 
>  
> 
> Matev?
> 
>  
> 
>  
> 
>  
> 
>  
> 
> 
> 
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From zua3 at cornell.edu  Tue Oct 26 22:02:21 2010
From: zua3 at cornell.edu (Zia Ahmed)
Date: Tue, 26 Oct 2010 16:02:21 -0400
Subject: [R-sig-Geo] Help: control font size of spplot of names.attr
In-Reply-To: <AANLkTinvDoapai+B7zd5ANLMz1nOhPqzW+o6X8ma0pMB@mail.gmail.com>
References: <AANLkTinvDoapai+B7zd5ANLMz1nOhPqzW+o6X8ma0pMB@mail.gmail.com>
Message-ID: <4CC733CD.9030006@cornell.edu>


Is it possible to  change the font size of attribute name in sppot?  
also the background color? Thanks
Zia

spplot(zn, c("a", "b", "c", "d"),

names.attr = c("ordinary kriging", "universal kriging with dist to 
river", "stratified kriging with flood freq", "inverse distance"),

as.table = TRUE, main = "log-zinc interpolation",

sp.layout = list(rv, scale, text1, text2)

)

* *


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101026/f6fcd557/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: zua3.vcf
Type: text/x-vcard
Size: 281 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101026/f6fcd557/attachment.vcf>

From edzer.pebesma at uni-muenster.de  Tue Oct 26 22:09:09 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 26 Oct 2010 22:09:09 +0200
Subject: [R-sig-Geo] Question re: Intamap package / Interpolate method:
 Inputs NOT both Spatial Points Data Frame?
In-Reply-To: <4CC72688.6040400@nceas.ucsb.edu>
References: <4CC72688.6040400@nceas.ucsb.edu>
Message-ID: <4CC73565.8020509@uni-muenster.de>

Are you sure you loaded package intamap before trying this?

On 10/26/2010 09:05 PM, Rick Reeves wrote:
> Hello:
> 
> I note a conflict in the documentation for Intamap/interpolate(), 
> to know how to resolve:
> 
> I have two SpatalPointsDataFrame objects:
> 
>  growingDegreeObservations <- readShapePoints("OhioGDDStationsGP.shp") 
> # computed surface phenomena, for individual lat/lon points
>  OrgStaLocs <- readShapePoints("Org_Locations.shp")                    #
> species observation stations, for DIFFERENT lat/lon points
> 
> # Objective: Interpolate the growingDegree points into a SpatialGrid (?)
> raster field, and then
> # overlay the observation stations on to the field, and assign field
> values to each observation station points
> 
> # according to intamap documentation, the interpolate() method accepts
> two SptatialPointsDataFrame objects, interpolates
> # the first ($value field) into a grid, and assigns interpolated
> observations to the predicted locations (monarchStaLocs).
> 
> interpImage <- interpolate(growingDegreeObservations
> ,OrgStaLocs,list(mean=TRUE, variance=TRUE))
> 
> However, when this line is executed, the error occurs:
> 
> Error in function (classes, fdef, mtable)  :
>   unable to find an inherited method for function "interpolate", for
> signature "SpatialPointsDataFrame"
> 
> I guess that this refers to the first argument, and that the argument
> must be a SpatialPixels or SpatialGrid data frame.
> Questions:
> 
> 1) Do I understand the inputs and outputs of interpolate() correctly?
> 
> 2) How best to transform the incorrect (SpatialPointsDataFrame) argument
>      to match the required inputs? E.G., create the interpolated
> SpatialPixelsDataFrame
>      of observations before calling interpolate())
> 
> 3) Is there a better R technique (e.g., direct call to krige()) for
> computing my solution?
> 
> Thanks, Rick R
> 
> 
> 
> 
> 
> 
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From advaitgodbole at gmail.com  Tue Oct 26 22:13:47 2010
From: advaitgodbole at gmail.com (Advait Godbole)
Date: Tue, 26 Oct 2010 16:13:47 -0400
Subject: [R-sig-Geo] udunits on Windows
Message-ID: <AANLkTimjpsHKOUdukngxxVrSAyRHUWRzvfZUKig312TQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101026/052f036d/attachment.pl>

From edzer.pebesma at uni-muenster.de  Tue Oct 26 22:39:37 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 26 Oct 2010 22:39:37 +0200
Subject: [R-sig-Geo] Help: control font size of spplot of names.attr
In-Reply-To: <4CC733CD.9030006@cornell.edu>
References: <AANLkTinvDoapai+B7zd5ANLMz1nOhPqzW+o6X8ma0pMB@mail.gmail.com>
	<4CC733CD.9030006@cornell.edu>
Message-ID: <4CC73C89.6030309@uni-muenster.de>



On 10/26/2010 10:02 PM, Zia Ahmed wrote:
> 
> Is it possible to  change the font size of attribute name in sppot? 
> also the background color? Thanks
> Zia
> 
> spplot(zn, c("a", "b", "c", "d"),
> 
> names.attr = c("ordinary kriging", "universal kriging with dist to
> river", "stratified kriging with flood freq", "inverse distance"),
> 
> as.table = TRUE, main = "log-zinc interpolation",
> 
> sp.layout = list(rv, scale, text1, text2)

, par.strip.text = list(cex = .5)

> 
> )
> 
> * *
> 
> 
> 
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From reeves at nceas.ucsb.edu  Tue Oct 26 22:43:22 2010
From: reeves at nceas.ucsb.edu (Rick Reeves)
Date: Tue, 26 Oct 2010 13:43:22 -0700
Subject: [R-sig-Geo] Question re: Intamap package / Interpolate method:
 Inputs NOT both Spatial Points Data Frame?
In-Reply-To: <4CC73565.8020509@uni-muenster.de>
References: <4CC72688.6040400@nceas.ucsb.edu>
	<4CC73565.8020509@uni-muenster.de>
Message-ID: <4CC73D6A.2090803@nceas.ucsb.edu>

Hello Edzer:

(by the way, I am using R 2.12)

Yes, I had - BUT - I rechecked my script, and the 'interpolate' method 
in intamap was apparently MASKED
by the 'interpolate' method in the subsequently loaded raster package. 
(in-progress code is below...)

I canceled the loading of the raster package, and re-ran the script with 
better results. This time,
the line:

   interpImage <- interpolate(gddThisYear,monarchStaLocs,list(mean=TRUE, 
variance=TRUE))

results in:
-------------------------------------------------
R 2010-10-26 13:31:48 interpolating 133 observations, 94 prediction 
locations
[1] "estimated time for  copula 60.5284609039258"
Error in min(dataObs) : invalid 'type' (S4) of argument
In addition: Warning message:
In predictTime(nObs = dim(observations)[1], nPred = 
dim(coordinates(predictionLocations))[1],  :

  using standard model for estimating time. For better
  platform spesific predictions, please run
  timeModels <- generateTimeModels()
   and save the workspace
------------------------------------------------
So intamap::interpolate documentation matches the argument list. But, my 
script is still not correct.

I suspect that this error happens because I do not fully understand how 
to use 'interpolate' for this task.

My task could also be solved by an approach like that demonstrated in 
Dylan Beaudette's excellent example at:

http://casoilresource.lawr.ucdavis.edu/drupal/node/442

.. but using intamap::interpolate would be much simpler if I have made 
the correct assumptions.

What are your thoughts?

Thanks,
Rick R
























##############################################################################################################

interpGddData <- function()
{
#   require(gstat)
    require(intamap)
#   require(rgdal)
    require(maptools)
#   require(raster)

    setwd("v:/MigrationDynamics/NCEAS PROCESS")

    firstGddCol <- 5

#   setwd("/data/scientist_share/scientist/MigrationDynamics/NCEAS 
PROCESS")

    gddTable <- readShapePoints("OhioGDDStationsGP.shp")
    monarchStaLocs <- readShapePoints("OH_Locations.shp")

    numGddCols <- 1 + (ncol(gddTable) - firstGddCol)

# The Idea: For each sampling year, generate one map for each GDD parameter.
# Each map is an interpolated 'surface' from all of the GDD-calculated 
'station'
# locations in the input file.

    theYears <- unique(gddTable at data$YR)
    numYears <- length(theYears)

    for (curYear in theYears)
    {
       gddThisYear <- gddTable[which(gddTable at data$YR==curYear),] # 
table entries: all stations, current year

    # make input table copy to append with interpolated GDD values for 
current year

       monarchStasWithGDD <- gddThisYear

# Write one output ESRI Shape File for each year, containing the Monarch 
station
# location points with all of the interpolated GDD parameters for the 
current year appended.

       outFileName <- sprintf("OH_MonarchSta_GDD_%d.tif",curYear)
#      theBase <- [,1:(firstGddColumn-1)]

# Create one interpolated image for each parameter, resulting in a named 
matrix file.

       for (jCtr in firstGddCol : numGddCols)
       {
#         fieldName <- names(gddThisYear)[jCtr] # we need this for the 
fileName
#         fileName <- sprintf("%s_%d.tif",fieldName,curYear)

          gddThisYear$value <- gddThisYear[,jCtr]

# Note: gddThisYear needs to be upgraded to a spatialPixelsDataFrame  so 
that it is a grid
# Despite documentation, A SpatialPointsDataFrame object is not a valid 
input.
# first argument(spatialPoints): measurement locations (in our case, the 
GDD values)
# second argument(spatialPixels): where to place the interpolated grid 
of measurement values.
# I need to make an empty grid to hold the data.

          interpImage <- 
interpolate(gddThisYear,monarchStaLocs,list(mean=TRUE, variance=TRUE))
          message("Latest interp done!")
          browser()

# Assign the result of interpolation as an attribute to the Monarch 
Station Locations File: 'newcol'

          cbind(monarchStasWithGDD at data,newcol)
       }
# Write the output file

       writePointsShape(monarchStasWithGDD,outFileName)

    }
}
############################################################################################################



On 10/26/2010 1:09 PM, Edzer Pebesma wrote:
> Are you sure you loaded package intamap before trying this?
>
> On 10/26/2010 09:05 PM, Rick Reeves wrote:
>> Hello:
>>
>> I note a conflict in the documentation for Intamap/interpolate(),
>> to know how to resolve:
>>
>> I have two SpatalPointsDataFrame objects:
>>
>>   growingDegreeObservations<- readShapePoints("OhioGDDStationsGP.shp")
>> # computed surface phenomena, for individual lat/lon points
>>   OrgStaLocs<- readShapePoints("Org_Locations.shp")                    #
>> species observation stations, for DIFFERENT lat/lon points
>>
>> # Objective: Interpolate the growingDegree points into a SpatialGrid (?)
>> raster field, and then
>> # overlay the observation stations on to the field, and assign field
>> values to each observation station points
>>
>> # according to intamap documentation, the interpolate() method accepts
>> two SptatialPointsDataFrame objects, interpolates
>> # the first ($value field) into a grid, and assigns interpolated
>> observations to the predicted locations (monarchStaLocs).
>>
>> interpImage<- interpolate(growingDegreeObservations
>> ,OrgStaLocs,list(mean=TRUE, variance=TRUE))
>>
>> However, when this line is executed, the error occurs:
>>
>> Error in function (classes, fdef, mtable)  :
>>    unable to find an inherited method for function "interpolate", for
>> signature "SpatialPointsDataFrame"
>>
>> I guess that this refers to the first argument, and that the argument
>> must be a SpatialPixels or SpatialGrid data frame.
>> Questions:
>>
>> 1) Do I understand the inputs and outputs of interpolate() correctly?
>>
>> 2) How best to transform the incorrect (SpatialPointsDataFrame) argument
>>       to match the required inputs? E.G., create the interpolated
>> SpatialPixelsDataFrame
>>       of observations before calling interpolate())
>>
>> 3) Is there a better R technique (e.g., direct call to krige()) for
>> computing my solution?
>>
>> Thanks, Rick R
>>
>>
>>
>>
>>
>>
>>


From edzer.pebesma at uni-muenster.de  Tue Oct 26 22:57:31 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 26 Oct 2010 22:57:31 +0200
Subject: [R-sig-Geo] Question re: Intamap package / Interpolate method:
 Inputs NOT both Spatial Points Data Frame?
In-Reply-To: <4CC73D6A.2090803@nceas.ucsb.edu>
References: <4CC72688.6040400@nceas.ucsb.edu>
	<4CC73565.8020509@uni-muenster.de>
	<4CC73D6A.2090803@nceas.ucsb.edu>
Message-ID: <4CC740BB.8050707@uni-muenster.de>

Thanks for pointing out that packages intamap and raster make
incompatible assumptions about the function (in raster: method)
interpolate. Sth we need to sort out.

In your script, you assign

gddThisYear$value <- gddThisYear[,jCtr]

it is too bad that this does not give a warning or error, apparently one
can assign S4 objects to data.frame columns -- it might even be
documented behaviour.

anyway, check the class of gddThisYear[,jCtr] yourself and try instead

gddThisYear$value <- gddThisYear[[jCtr]]

Hth,

On 10/26/2010 10:43 PM, Rick Reeves wrote:
> Hello Edzer:
> 
> (by the way, I am using R 2.12)
> 
> Yes, I had - BUT - I rechecked my script, and the 'interpolate' method
> in intamap was apparently MASKED
> by the 'interpolate' method in the subsequently loaded raster package.
> (in-progress code is below...)
> 
> I canceled the loading of the raster package, and re-ran the script with
> better results. This time,
> the line:
> 
>   interpImage <- interpolate(gddThisYear,monarchStaLocs,list(mean=TRUE,
> variance=TRUE))
> 
> results in:
> -------------------------------------------------
> R 2010-10-26 13:31:48 interpolating 133 observations, 94 prediction
> locations
> [1] "estimated time for  copula 60.5284609039258"
> Error in min(dataObs) : invalid 'type' (S4) of argument
> In addition: Warning message:
> In predictTime(nObs = dim(observations)[1], nPred =
> dim(coordinates(predictionLocations))[1],  :
> 
>  using standard model for estimating time. For better
>  platform spesific predictions, please run
>  timeModels <- generateTimeModels()
>   and save the workspace
> ------------------------------------------------
> So intamap::interpolate documentation matches the argument list. But, my
> script is still not correct.
> 
> I suspect that this error happens because I do not fully understand how
> to use 'interpolate' for this task.
> 
> My task could also be solved by an approach like that demonstrated in
> Dylan Beaudette's excellent example at:
> 
> http://casoilresource.lawr.ucdavis.edu/drupal/node/442
> 
> .. but using intamap::interpolate would be much simpler if I have made
> the correct assumptions.
> 
> What are your thoughts?
> 
> Thanks,
> Rick R
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> ##############################################################################################################
> 
> 
> interpGddData <- function()
> {
> #   require(gstat)
>    require(intamap)
> #   require(rgdal)
>    require(maptools)
> #   require(raster)
> 
>    setwd("v:/MigrationDynamics/NCEAS PROCESS")
> 
>    firstGddCol <- 5
> 
> #   setwd("/data/scientist_share/scientist/MigrationDynamics/NCEAS
> PROCESS")
> 
>    gddTable <- readShapePoints("OhioGDDStationsGP.shp")
>    monarchStaLocs <- readShapePoints("OH_Locations.shp")
> 
>    numGddCols <- 1 + (ncol(gddTable) - firstGddCol)
> 
> # The Idea: For each sampling year, generate one map for each GDD
> parameter.
> # Each map is an interpolated 'surface' from all of the GDD-calculated
> 'station'
> # locations in the input file.
> 
>    theYears <- unique(gddTable at data$YR)
>    numYears <- length(theYears)
> 
>    for (curYear in theYears)
>    {
>       gddThisYear <- gddTable[which(gddTable at data$YR==curYear),] # table
> entries: all stations, current year
> 
>    # make input table copy to append with interpolated GDD values for
> current year
> 
>       monarchStasWithGDD <- gddThisYear
> 
> # Write one output ESRI Shape File for each year, containing the Monarch
> station
> # location points with all of the interpolated GDD parameters for the
> current year appended.
> 
>       outFileName <- sprintf("OH_MonarchSta_GDD_%d.tif",curYear)
> #      theBase <- [,1:(firstGddColumn-1)]
> 
> # Create one interpolated image for each parameter, resulting in a named
> matrix file.
> 
>       for (jCtr in firstGddCol : numGddCols)
>       {
> #         fieldName <- names(gddThisYear)[jCtr] # we need this for the
> fileName
> #         fileName <- sprintf("%s_%d.tif",fieldName,curYear)
> 
>          gddThisYear$value <- gddThisYear[,jCtr]
> 
> # Note: gddThisYear needs to be upgraded to a spatialPixelsDataFrame  so
> that it is a grid
> # Despite documentation, A SpatialPointsDataFrame object is not a valid
> input.
> # first argument(spatialPoints): measurement locations (in our case, the
> GDD values)
> # second argument(spatialPixels): where to place the interpolated grid
> of measurement values.
> # I need to make an empty grid to hold the data.
> 
>          interpImage <-
> interpolate(gddThisYear,monarchStaLocs,list(mean=TRUE, variance=TRUE))
>          message("Latest interp done!")
>          browser()
> 
> # Assign the result of interpolation as an attribute to the Monarch
> Station Locations File: 'newcol'
> 
>          cbind(monarchStasWithGDD at data,newcol)
>       }
> # Write the output file
> 
>       writePointsShape(monarchStasWithGDD,outFileName)
> 
>    }
> }
> ############################################################################################################
> 
> 
> 
> 
> On 10/26/2010 1:09 PM, Edzer Pebesma wrote:
>> Are you sure you loaded package intamap before trying this?
>>
>> On 10/26/2010 09:05 PM, Rick Reeves wrote:
>>> Hello:
>>>
>>> I note a conflict in the documentation for Intamap/interpolate(),
>>> to know how to resolve:
>>>
>>> I have two SpatalPointsDataFrame objects:
>>>
>>>   growingDegreeObservations<- readShapePoints("OhioGDDStationsGP.shp")
>>> # computed surface phenomena, for individual lat/lon points
>>>   OrgStaLocs<- readShapePoints("Org_Locations.shp")                    #
>>> species observation stations, for DIFFERENT lat/lon points
>>>
>>> # Objective: Interpolate the growingDegree points into a SpatialGrid (?)
>>> raster field, and then
>>> # overlay the observation stations on to the field, and assign field
>>> values to each observation station points
>>>
>>> # according to intamap documentation, the interpolate() method accepts
>>> two SptatialPointsDataFrame objects, interpolates
>>> # the first ($value field) into a grid, and assigns interpolated
>>> observations to the predicted locations (monarchStaLocs).
>>>
>>> interpImage<- interpolate(growingDegreeObservations
>>> ,OrgStaLocs,list(mean=TRUE, variance=TRUE))
>>>
>>> However, when this line is executed, the error occurs:
>>>
>>> Error in function (classes, fdef, mtable)  :
>>>    unable to find an inherited method for function "interpolate", for
>>> signature "SpatialPointsDataFrame"
>>>
>>> I guess that this refers to the first argument, and that the argument
>>> must be a SpatialPixels or SpatialGrid data frame.
>>> Questions:
>>>
>>> 1) Do I understand the inputs and outputs of interpolate() correctly?
>>>
>>> 2) How best to transform the incorrect (SpatialPointsDataFrame) argument
>>>       to match the required inputs? E.G., create the interpolated
>>> SpatialPixelsDataFrame
>>>       of observations before calling interpolate())
>>>
>>> 3) Is there a better R technique (e.g., direct call to krige()) for
>>> computing my solution?
>>>
>>> Thanks, Rick R
>>>
>>>
>>>
>>>
>>>
>>>
>>>
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From horning at amnh.org  Tue Oct 26 22:59:30 2010
From: horning at amnh.org (Ned Horning)
Date: Tue, 26 Oct 2010 16:59:30 -0400
Subject: [R-sig-Geo] as.data.frame.default error using Raster package predict
Message-ID: <4CC74132.8090607@amnh.org>

Hi - I am trying to use the predict function from the raster package to 
predict using a random forest object using the following command:
 > predict (randfor, imageRaster, filename=outImage, progress='text', 
format='GTiff', datatype='FLT4S', type='response', overwrite=TRUE)

I get the following error:
Error in as.data.frame.default(newdata) :
   cannot coerce class structure("RasterStack", package = "raster") into 
a data.frame

I get the same error when trying this with a gbm object. The input image 
is an 8-band 32 bit floating point image. I am able to use the predict 
function with random forests when the image with the predictor variables 
and the data used to build the model are different. Here is the 
description of the RasterStack image I am using:
--
 > imageRaster
class       : RasterStack
filename    :
nlayers     : 8
nrow        : 121
ncol        : 133
ncell       : 16093
projection  : +proj=utm +zone=19 +ellps=clrk66 +datum=NAD27 +units=m 
+no_defs +nadgrids=@conus, at alaska, at ntv2_0.gsb, at ntv1_can.dat
min value   : NA NA NA NA NA NA NA NA
max value   : NA NA NA NA NA NA NA NA
xmin        : 272614.0766
xmax        : 285914.0766
ymin        : 4862555.9603
ymax        : 4874655.9603
xres        : 100
yres        : 100
--
Any idea what the problem might be?

Ned


From r.hijmans at gmail.com  Tue Oct 26 23:41:55 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 26 Oct 2010 14:41:55 -0700
Subject: [R-sig-Geo] as.data.frame.default error using Raster package
	predict
In-Reply-To: <4CC74132.8090607@amnh.org>
References: <4CC74132.8090607@amnh.org>
Message-ID: <AANLkTi=SAd_3yrvCD_m+OT9LRXXJr5TZdfhZjDvLcf7-@mail.gmail.com>

Ned,

I think the order of the first two arguments is wrong and should be:

predict (imageRaster, randfor, filename=outImage, progress='text',
format='GTiff', datatype='FLT4S', type='response', overwrite=TRUE)

Robert


On Tue, Oct 26, 2010 at 1:59 PM, Ned Horning <horning at amnh.org> wrote:
> Hi - I am trying to use the predict function from the raster package to
> predict using a random forest object using the following command:
>> predict (randfor, imageRaster, filename=outImage, progress='text',
>> format='GTiff', datatype='FLT4S', type='response', overwrite=TRUE)
>
> I get the following error:
> Error in as.data.frame.default(newdata) :
> ?cannot coerce class structure("RasterStack", package = "raster") into a
> data.frame
>
> I get the same error when trying this with a gbm object. The input image is
> an 8-band 32 bit floating point image. I am able to use the predict function
> with random forests when the image with the predictor variables and the data
> used to build the model are different. Here is the description of the
> RasterStack image I am using:
> --
>> imageRaster
> class ? ? ? : RasterStack
> filename ? ?:
> nlayers ? ? : 8
> nrow ? ? ? ?: 121
> ncol ? ? ? ?: 133
> ncell ? ? ? : 16093
> projection ?: +proj=utm +zone=19 +ellps=clrk66 +datum=NAD27 +units=m
> +no_defs +nadgrids=@conus, at alaska, at ntv2_0.gsb, at ntv1_can.dat
> min value ? : NA NA NA NA NA NA NA NA
> max value ? : NA NA NA NA NA NA NA NA
> xmin ? ? ? ?: 272614.0766
> xmax ? ? ? ?: 285914.0766
> ymin ? ? ? ?: 4862555.9603
> ymax ? ? ? ?: 4874655.9603
> xres ? ? ? ?: 100
> yres ? ? ? ?: 100
> --
> Any idea what the problem might be?
>
> Ned
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From fsantos at ujaen.es  Wed Oct 27 10:03:39 2010
From: fsantos at ujaen.es (fsantos at ujaen.es)
Date: Wed, 27 Oct 2010 10:03:39 +0200 (CEST)
Subject: [R-sig-Geo] Help with GIS
Message-ID: <1457e3f35b2e965d637e59bb56b37d8a.squirrel@webmail.ujaen.es>

Dear R community,

I'm sorry, but I am newbie with GIS. I have to import a tiff using a
geotiff tool, and convert it into a data matrix. The initial projection is
Lambert Azimuthal Equal Area, and I would like to get the final matrix in
a regular lat/lon grid.

It is possible to do it with R?

Thanks in advance.


From yan_boulanger at hotmail.com  Wed Oct 27 15:39:50 2010
From: yan_boulanger at hotmail.com (Yan Boulanger)
Date: Wed, 27 Oct 2010 13:39:50 +0000
Subject: [R-sig-Geo] connecting subgraphs
In-Reply-To: <1457e3f35b2e965d637e59bb56b37d8a.squirrel@webmail.ujaen.es>
References: <1457e3f35b2e965d637e59bb56b37d8a.squirrel@webmail.ujaen.es>
Message-ID: <SNT124-W38F381761BDA32E5524C0D8D430@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101027/da167a35/attachment.pl>

From hengl at spatial-analyst.net  Wed Oct 27 16:55:51 2010
From: hengl at spatial-analyst.net (Tomislav Hengl)
Date: Wed, 27 Oct 2010 16:55:51 +0200
Subject: [R-sig-Geo] Help with GIS
In-Reply-To: <1457e3f35b2e965d637e59bb56b37d8a.squirrel@webmail.ujaen.es>
References: <1457e3f35b2e965d637e59bb56b37d8a.squirrel@webmail.ujaen.es>
Message-ID: <4CC83D77.4000108@spatial-analyst.net>



Op 27-10-2010 10:03, fsantos at ujaen.es schreef:
> Dear R community,
>
> I'm sorry, but I am newbie with GIS. I have to import a tiff using a
> geotiff tool, and convert it into a data matrix. The initial projection is
> Lambert Azimuthal Equal Area, and I would like to get the final matrix in
> a regular lat/lon grid.
>
> It is possible to do it with R?
>
> Thanks in advance.
>

That is called "reprojecting raster maps" or simply "resampling" 
[http://spatial-analyst.net/wiki/index.php?title=Export_maps_to_GE#Reprojecting_and_resampling_maps]. 
I normally use the "gdalwarp" for this 
[http://spatial-analyst.net/wiki/index.php?title=Software#FWTools] 
because you can put all these operations in one command, but you could 
also try RSAGA.


T. Hengl
[http://www.wewur.wur.nl/popups/vcard.aspx?id=HENGL001]


> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From kmcoulib at gmail.com  Wed Oct 27 21:01:14 2010
From: kmcoulib at gmail.com (kapo coulibaly)
Date: Wed, 27 Oct 2010 15:01:14 -0400
Subject: [R-sig-Geo] issue with creating .ncdf file in R
In-Reply-To: <20101023204134.147662r3nzaftdj2@mail.msu.edu>
References: <20101023204134.147662r3nzaftdj2@mail.msu.edu>
Message-ID: <AANLkTimAiBFRmRDzxRRDad2uue0dgmHFQcC1kNB_FwOM@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101027/fd85d8ea/attachment.pl>

From Roger.Bivand at nhh.no  Wed Oct 27 21:20:28 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 27 Oct 2010 21:20:28 +0200 (CEST)
Subject: [R-sig-Geo] connecting subgraphs
In-Reply-To: <SNT124-W38F381761BDA32E5524C0D8D430@phx.gbl>
References: <1457e3f35b2e965d637e59bb56b37d8a.squirrel@webmail.ujaen.es>
	<SNT124-W38F381761BDA32E5524C0D8D430@phx.gbl>
Message-ID: <alpine.LRH.2.00.1010272050180.14381@reclus.nhh.no>

On Wed, 27 Oct 2010, Yan Boulanger wrote:

>
> Dear Rsig community,
>
> I'm quite new to R-sig. Here's my problem :
>
> I have a set of polygons representing Canada's ecodistricts. Although 
> the great majority of polygons are contiguous, few are "isolated" from 
> the main "polygon mass". I created a nb object using the poly2nb 
> function. When I use the snap function (let say 60 km), it links all 
> polygons together, without leaving unconnected subgraphs. Obviously, 
> this also create additionnal links between polygons that are not 
> "really" contiguous INSIDE a given subgraph. I would like to keep only 
> the additionnal links that connect the subgraphs together using a 
> threshold distance (60 km).
>
> My question is : is it possible to connect subgraphs that are isolated 
> from each other by a certain threshold distance without doing it 
> manually ?

Not with polygon representation at present, although the rgeos package on 
may make it possible to buffer around member polygons in each subgraph to 
identify the closest ones. With centroid representation of the polygons, 
one could first find the members of subgraphs, then check distances. But 
this wouldn't be the same as polygon representation.

Roger

>
> Thanks in advance,
>
> Yan
>
> Yan Boulanger
> Dendrolab - Datation de b?timents patrimoniaux par dendrochronologie
> www.dendrolab.ca
> info at dendrolab.ca
>
>
>
> Universit? du Qu?bec ? Rimouski
> D?partement de Biologie
> Centre d'?tudes nordiques
> 300, all?e des Ursulines
> Rimouski, PQ G5L 3A1
> (418) 723-1986 poste 1482
>
>
>
> 	[[alternative HTML version deleted]]
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From govindas at msu.edu  Wed Oct 27 22:01:04 2010
From: govindas at msu.edu (govindas at msu.edu)
Date: Wed, 27 Oct 2010 16:01:04 -0400
Subject: [R-sig-Geo] issue with creating .ncdf file in R
In-Reply-To: <AANLkTimAiBFRmRDzxRRDad2uue0dgmHFQcC1kNB_FwOM@mail.gmail.com>
References: <20101023204134.147662r3nzaftdj2@mail.msu.edu>
	<AANLkTimAiBFRmRDzxRRDad2uue0dgmHFQcC1kNB_FwOM@mail.gmail.com>
Message-ID: <20101027160104.21342jtsh9r4bshs@mail.msu.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101027/8b776e03/attachment.pl>

From mdsumner at gmail.com  Wed Oct 27 23:16:49 2010
From: mdsumner at gmail.com (Michael Sumner)
Date: Thu, 28 Oct 2010 08:16:49 +1100
Subject: [R-sig-Geo] Help with GIS
In-Reply-To: <1457e3f35b2e965d637e59bb56b37d8a.squirrel@webmail.ujaen.es>
References: <1457e3f35b2e965d637e59bb56b37d8a.squirrel@webmail.ujaen.es>
Message-ID: <AANLkTikFhV_CF40mVrVHRhmhyp4+wEwoN5kDpsuN3qCn@mail.gmail.com>

This is a dummy example - especially in terms of made up coordinate
system details, but shows how you can reproject with the raster
package:

library(rgdal)

## create a grid, with dummy coordinates / projection

im <- image2Grid(list(x = 1e5 * (1:nrow(volcano)), y = 1e5 *
(1:ncol(volcano)), z = volcano), p4 = "+proj=laea")

writeGDAL(im, "dummy.tif")

## now the process, using raster package

library(raster)


r0 <- raster("dummy.tif")

# proj.4 projection description
newproj <- "+proj=longlat +ellps=WGS84"

pr <- projectExtent(r0, newproj)
## (optionally) Adjust the cell size
## res(pr) <- res(pr)/2


# project the values of RasterLayer 'r' to the new RasterLayer 'projras'
projras <- projectRaster(r0, pr)

## now go back to sp and extract matrix

spprojras <- as(projras, "SpatialGridDataFrame")

m <- as.image.SpatialGridDataFrame(spprojras)$z

image(m)


I'm not sure if the coercion to SpatialGridDataFrame will
automatically give you all of the detail in the source by default for
large grids, but there would be a way.

Cheers, MIke.
On Wed, Oct 27, 2010 at 7:03 PM,  <fsantos at ujaen.es> wrote:
> Dear R community,
>
> I'm sorry, but I am newbie with GIS. I have to import a tiff using a
> geotiff tool, and convert it into a data matrix. The initial projection is
> Lambert Azimuthal Equal Area, and I would like to get the final matrix in
> a regular lat/lon grid.
>
> It is possible to do it with R?
>
> Thanks in advance.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Michael Sumner
Institute for Marine and Antarctic Studies, University of Tasmania
Hobart, Australia
e-mail: mdsumner at gmail.com


From senator at ecotoxicology.de  Thu Oct 28 00:29:51 2010
From: senator at ecotoxicology.de (=?iso-8859-1?Q?Ralf_Sch=E4fer?=)
Date: Thu, 28 Oct 2010 00:29:51 +0200
Subject: [R-sig-Geo]  Why I can't install RGDAL after R 2.12.0 release?
Message-ID: <1C99CC51-68A6-4295-A209-A4CFBB438057@ecotoxicology.de>

Hello,

don`t know if this issue is already fixed given that Roger posted an answer.
However, I just installed from source with the command:

install.packages("rgdal", configure.args='--with-gdal-config=/Library/Frameworks/GDAL.Framework/Unix/bin/gdal-config --with-proj-include=/Library/Frameworks/PROJ.framework/unix/include-with-proj-lib=/Library/Frameworks/PROJ.framework/unix/lib/',dependencies=TRUE, type="source")

R version 2.12.0 (2010-10-15)
Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)

The frameworks provided on Kyngchaos do not work for me under 2.12.

Regards,
Ralf

------------------------------------------------------------

Prof. Dr. rer. nat. Ralf Bernhard Sch?fer
Juniorprofessor Quantitative Landscape Ecology
Environmental Scientist (M.Sc.)
Institute for Environmental Sciences
University Koblenz-Landau
Forststrasse 7
76829 Landau
Germany
Mail: schaefer-ralf at uni-landau.de
Phone: ++49 (0) 6341 280-31536


From r.hijmans at gmail.com  Thu Oct 28 00:54:36 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 27 Oct 2010 15:54:36 -0700
Subject: [R-sig-Geo] Help with GIS
In-Reply-To: <AANLkTikFhV_CF40mVrVHRhmhyp4+wEwoN5kDpsuN3qCn@mail.gmail.com>
References: <1457e3f35b2e965d637e59bb56b37d8a.squirrel@webmail.ujaen.es>
	<AANLkTikFhV_CF40mVrVHRhmhyp4+wEwoN5kDpsuN3qCn@mail.gmail.com>
Message-ID: <AANLkTikDx_N=qWK=n2yki3Vg0fk+AMMyUCW8pBkzOStM@mail.gmail.com>

After this:

> projras <- projectRaster(r0, pr)

You could also do plot(projras) or image(projras) and

v <- getValues(projras, format='matrix')

To get a matrix of values, with the advantage that values in this
matrix are organized as on the map (probably what you would expect),
which is different in matrix 'm' in Mike's example.

Robert

On Wed, Oct 27, 2010 at 2:16 PM, Michael Sumner <mdsumner at gmail.com> wrote:
> This is a dummy example - especially in terms of made up coordinate
> system details, but shows how you can reproject with the raster
> package:
>
> library(rgdal)
>
> ## create a grid, with dummy coordinates / projection
>
> im <- image2Grid(list(x = 1e5 * (1:nrow(volcano)), y = 1e5 *
> (1:ncol(volcano)), z = volcano), p4 = "+proj=laea")
>
> writeGDAL(im, "dummy.tif")
>
> ## now the process, using raster package
>
> library(raster)
>
>
> r0 <- raster("dummy.tif")
>
> # proj.4 projection description
> newproj <- "+proj=longlat +ellps=WGS84"
>
> pr <- projectExtent(r0, newproj)
> ## (optionally) Adjust the cell size
> ## res(pr) <- res(pr)/2
>
>
> # project the values of RasterLayer 'r' to the new RasterLayer 'projras'
> projras <- projectRaster(r0, pr)
>
> ## now go back to sp and extract matrix
>
> spprojras <- as(projras, "SpatialGridDataFrame")
>
> m <- as.image.SpatialGridDataFrame(spprojras)$z
>
> image(m)
>
>
> I'm not sure if the coercion to SpatialGridDataFrame will
> automatically give you all of the detail in the source by default for
> large grids, but there would be a way.
>
> Cheers, MIke.
> On Wed, Oct 27, 2010 at 7:03 PM, ?<fsantos at ujaen.es> wrote:
>> Dear R community,
>>
>> I'm sorry, but I am newbie with GIS. I have to import a tiff using a
>> geotiff tool, and convert it into a data matrix. The initial projection is
>> Lambert Azimuthal Equal Area, and I would like to get the final matrix in
>> a regular lat/lon grid.
>>
>> It is possible to do it with R?
>>
>> Thanks in advance.
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
>
> --
> Michael Sumner
> Institute for Marine and Antarctic Studies, University of Tasmania
> Hobart, Australia
> e-mail: mdsumner at gmail.com
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From mdsumner at gmail.com  Thu Oct 28 01:01:41 2010
From: mdsumner at gmail.com (Michael Sumner)
Date: Thu, 28 Oct 2010 10:01:41 +1100
Subject: [R-sig-Geo] Help with GIS
In-Reply-To: <AANLkTikDx_N=qWK=n2yki3Vg0fk+AMMyUCW8pBkzOStM@mail.gmail.com>
References: <1457e3f35b2e965d637e59bb56b37d8a.squirrel@webmail.ujaen.es>
	<AANLkTikFhV_CF40mVrVHRhmhyp4+wEwoN5kDpsuN3qCn@mail.gmail.com>
	<AANLkTikDx_N=qWK=n2yki3Vg0fk+AMMyUCW8pBkzOStM@mail.gmail.com>
Message-ID: <AANLkTi=bWOFKn4xRB9dxpZ2PEt=akWXveAomhhW+N9eg@mail.gmail.com>

Thanks Robert, I still haven't explored raster enough.

I tried as.matrix(projras) - have you considered adding methods like
this? I'm afraid I still don't know the structure of the raster data
sets enough to know if that makes sense, but I think sp returns
another orientation in this way:

 as.matrix(spprojras)


Cheers, Mike.

On Thu, Oct 28, 2010 at 9:54 AM, Robert J. Hijmans <r.hijmans at gmail.com> wrote:
> After this:
>
>> projras <- projectRaster(r0, pr)
>
> You could also do plot(projras) or image(projras) and
>
> v <- getValues(projras, format='matrix')
>
> To get a matrix of values, with the advantage that values in this
> matrix are organized as on the map (probably what you would expect),
> which is different in matrix 'm' in Mike's example.
>
> Robert
>
> On Wed, Oct 27, 2010 at 2:16 PM, Michael Sumner <mdsumner at gmail.com> wrote:
>> This is a dummy example - especially in terms of made up coordinate
>> system details, but shows how you can reproject with the raster
>> package:
>>
>> library(rgdal)
>>
>> ## create a grid, with dummy coordinates / projection
>>
>> im <- image2Grid(list(x = 1e5 * (1:nrow(volcano)), y = 1e5 *
>> (1:ncol(volcano)), z = volcano), p4 = "+proj=laea")
>>
>> writeGDAL(im, "dummy.tif")
>>
>> ## now the process, using raster package
>>
>> library(raster)
>>
>>
>> r0 <- raster("dummy.tif")
>>
>> # proj.4 projection description
>> newproj <- "+proj=longlat +ellps=WGS84"
>>
>> pr <- projectExtent(r0, newproj)
>> ## (optionally) Adjust the cell size
>> ## res(pr) <- res(pr)/2
>>
>>
>> # project the values of RasterLayer 'r' to the new RasterLayer 'projras'
>> projras <- projectRaster(r0, pr)
>>
>> ## now go back to sp and extract matrix
>>
>> spprojras <- as(projras, "SpatialGridDataFrame")
>>
>> m <- as.image.SpatialGridDataFrame(spprojras)$z
>>
>> image(m)
>>
>>
>> I'm not sure if the coercion to SpatialGridDataFrame will
>> automatically give you all of the detail in the source by default for
>> large grids, but there would be a way.
>>
>> Cheers, MIke.
>> On Wed, Oct 27, 2010 at 7:03 PM, ?<fsantos at ujaen.es> wrote:
>>> Dear R community,
>>>
>>> I'm sorry, but I am newbie with GIS. I have to import a tiff using a
>>> geotiff tool, and convert it into a data matrix. The initial projection is
>>> Lambert Azimuthal Equal Area, and I would like to get the final matrix in
>>> a regular lat/lon grid.
>>>
>>> It is possible to do it with R?
>>>
>>> Thanks in advance.
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>>
>>
>> --
>> Michael Sumner
>> Institute for Marine and Antarctic Studies, University of Tasmania
>> Hobart, Australia
>> e-mail: mdsumner at gmail.com
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Michael Sumner
Institute for Marine and Antarctic Studies, University of Tasmania
Hobart, Australia
e-mail: mdsumner at gmail.com


From r.hijmans at gmail.com  Thu Oct 28 02:39:53 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 27 Oct 2010 17:39:53 -0700
Subject: [R-sig-Geo] Help with GIS
In-Reply-To: <AANLkTi=bWOFKn4xRB9dxpZ2PEt=akWXveAomhhW+N9eg@mail.gmail.com>
References: <1457e3f35b2e965d637e59bb56b37d8a.squirrel@webmail.ujaen.es>
	<AANLkTikFhV_CF40mVrVHRhmhyp4+wEwoN5kDpsuN3qCn@mail.gmail.com>
	<AANLkTikDx_N=qWK=n2yki3Vg0fk+AMMyUCW8pBkzOStM@mail.gmail.com>
	<AANLkTi=bWOFKn4xRB9dxpZ2PEt=akWXveAomhhW+N9eg@mail.gmail.com>
Message-ID: <AANLkTikHB_tuY0qc1QTnfdA29tNQO5iVQAG2nzkS7JdG@mail.gmail.com>

Hi Mike,

Thanks for that suggestion, It had not occurred to me to overload
as.matrix. Done that now (raster version 1.6-7) such that
as.matrix(projras) works.

Best, Robert


On Wed, Oct 27, 2010 at 4:01 PM, Michael Sumner <mdsumner at gmail.com> wrote:
> Thanks Robert, I still haven't explored raster enough.
>
> I tried as.matrix(projras) - have you considered adding methods like
> this? I'm afraid I still don't know the structure of the raster data
> sets enough to know if that makes sense, but I think sp returns
> another orientation in this way:
>
> ?as.matrix(spprojras)
>
>
> Cheers, Mike.
>
> On Thu, Oct 28, 2010 at 9:54 AM, Robert J. Hijmans <r.hijmans at gmail.com> wrote:
>> After this:
>>
>>> projras <- projectRaster(r0, pr)
>>
>> You could also do plot(projras) or image(projras) and
>>
>> v <- getValues(projras, format='matrix')
>>
>> To get a matrix of values, with the advantage that values in this
>> matrix are organized as on the map (probably what you would expect),
>> which is different in matrix 'm' in Mike's example.
>>
>> Robert
>>
>> On Wed, Oct 27, 2010 at 2:16 PM, Michael Sumner <mdsumner at gmail.com> wrote:
>>> This is a dummy example - especially in terms of made up coordinate
>>> system details, but shows how you can reproject with the raster
>>> package:
>>>
>>> library(rgdal)
>>>
>>> ## create a grid, with dummy coordinates / projection
>>>
>>> im <- image2Grid(list(x = 1e5 * (1:nrow(volcano)), y = 1e5 *
>>> (1:ncol(volcano)), z = volcano), p4 = "+proj=laea")
>>>
>>> writeGDAL(im, "dummy.tif")
>>>
>>> ## now the process, using raster package
>>>
>>> library(raster)
>>>
>>>
>>> r0 <- raster("dummy.tif")
>>>
>>> # proj.4 projection description
>>> newproj <- "+proj=longlat +ellps=WGS84"
>>>
>>> pr <- projectExtent(r0, newproj)
>>> ## (optionally) Adjust the cell size
>>> ## res(pr) <- res(pr)/2
>>>
>>>
>>> # project the values of RasterLayer 'r' to the new RasterLayer 'projras'
>>> projras <- projectRaster(r0, pr)
>>>
>>> ## now go back to sp and extract matrix
>>>
>>> spprojras <- as(projras, "SpatialGridDataFrame")
>>>
>>> m <- as.image.SpatialGridDataFrame(spprojras)$z
>>>
>>> image(m)
>>>
>>>
>>> I'm not sure if the coercion to SpatialGridDataFrame will
>>> automatically give you all of the detail in the source by default for
>>> large grids, but there would be a way.
>>>
>>> Cheers, MIke.
>>> On Wed, Oct 27, 2010 at 7:03 PM, ?<fsantos at ujaen.es> wrote:
>>>> Dear R community,
>>>>
>>>> I'm sorry, but I am newbie with GIS. I have to import a tiff using a
>>>> geotiff tool, and convert it into a data matrix. The initial projection is
>>>> Lambert Azimuthal Equal Area, and I would like to get the final matrix in
>>>> a regular lat/lon grid.
>>>>
>>>> It is possible to do it with R?
>>>>
>>>> Thanks in advance.
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at stat.math.ethz.ch
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>
>>>
>>>
>>> --
>>> Michael Sumner
>>> Institute for Marine and Antarctic Studies, University of Tasmania
>>> Hobart, Australia
>>> e-mail: mdsumner at gmail.com
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at stat.math.ethz.ch
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
>
> --
> Michael Sumner
> Institute for Marine and Antarctic Studies, University of Tasmania
> Hobart, Australia
> e-mail: mdsumner at gmail.com
>


From fsantos at ujaen.es  Thu Oct 28 12:39:37 2010
From: fsantos at ujaen.es (Francisco Javier Santos Alamillos)
Date: Thu, 28 Oct 2010 12:39:37 +0200
Subject: [R-sig-Geo] Help with GIS
In-Reply-To: <AANLkTikHB_tuY0qc1QTnfdA29tNQO5iVQAG2nzkS7JdG@mail.gmail.com>
References: <1457e3f35b2e965d637e59bb56b37d8a.squirrel@webmail.ujaen.es>
	<AANLkTikFhV_CF40mVrVHRhmhyp4+wEwoN5kDpsuN3qCn@mail.gmail.com>
	<AANLkTikDx_N=qWK=n2yki3Vg0fk+AMMyUCW8pBkzOStM@mail.gmail.com>
	<AANLkTi=bWOFKn4xRB9dxpZ2PEt=akWXveAomhhW+N9eg@mail.gmail.com>
	<AANLkTikHB_tuY0qc1QTnfdA29tNQO5iVQAG2nzkS7JdG@mail.gmail.com>
Message-ID: <AANLkTimXyrCQNcuK+LO4xe-6qGtiiTXSGHOV3BPbqqSN@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101028/6647ca31/attachment.pl>

From aslantas at metu.edu.tr  Thu Oct 28 15:41:57 2010
From: aslantas at metu.edu.tr (Pinar Aslantas Bostan)
Date: Thu, 28 Oct 2010 16:41:57 +0300
Subject: [R-sig-Geo] !SPAM: prediction error variance
Message-ID: <20101028164157.1330487cem6jjlb9@horde.metu.edu.tr>

Dear all,

I performed gwr() and obtained predictions for 31223 data points. Now  
I want to calculate prediction error variance at each estimation  
point. Is there a function to calculate them or do you have any idea  
about calculating these values?

Thanks!

Pinar

********************************************************************************
Pinar Aslantas Bostan
Research Assistant
Department of Geodetic and
Geographic Information Technologies (GGIT)
Middle East Technical University
06531 Ankara/TURKEY
aslantas at metu.edu.tr


From Roger.Bivand at nhh.no  Thu Oct 28 16:42:13 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 28 Oct 2010 16:42:13 +0200 (CEST)
Subject: [R-sig-Geo] !SPAM: prediction error variance
In-Reply-To: <20101028164157.1330487cem6jjlb9@horde.metu.edu.tr>
References: <20101028164157.1330487cem6jjlb9@horde.metu.edu.tr>
Message-ID: <alpine.LRH.2.00.1010281637250.19118@reclus.nhh.no>

On Thu, 28 Oct 2010, Pinar Aslantas Bostan wrote:

> Dear all,
>
> I performed gwr() and obtained predictions for 31223 data points. Now I 
> want to calculate prediction error variance at each estimation point. Is 
> there a function to calculate them or do you have any idea about 
> calculating these values?

You need to pass in a fittedGWRobject, and set se.fit, to provide the 
estimate of sigma needed to achieve this. The fitted object must have a 
hatmatrix, which is not possible with this N, so you will have to 
subsample to be able to get the sigma based on effective degrees of 
freedom. I don't think that this has been tried, and I'm not sure what it 
provides of value, given the uncertainty present about the method.

Hope this helps,

Roger

>
> Thanks!
>
> Pinar
>
> ********************************************************************************
> Pinar Aslantas Bostan
> Research Assistant
> Department of Geodetic and
> Geographic Information Technologies (GGIT)
> Middle East Technical University
> 06531 Ankara/TURKEY
> aslantas at metu.edu.tr
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Christoph.Hauser at uibk.ac.at  Thu Oct 28 17:55:45 2010
From: Christoph.Hauser at uibk.ac.at (Hauser, Christoph)
Date: Thu, 28 Oct 2010 17:55:45 +0200
Subject: [R-sig-Geo] Problem nblag_cumul
Message-ID: <A7E98C2BA8986D41B47ED5BDC95B25700C3031DA@VEX01.uibk.ac.at>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101028/9286bb22/attachment.pl>

From moshersteven at gmail.com  Thu Oct 28 19:58:28 2010
From: moshersteven at gmail.com (steven mosher)
Date: Thu, 28 Oct 2010 10:58:28 -0700
Subject: [R-sig-Geo] Why I can't install RGDAL after R 2.12.0 release?
In-Reply-To: <1C99CC51-68A6-4295-A209-A4CFBB438057@ecotoxicology.de>
References: <1C99CC51-68A6-4295-A209-A4CFBB438057@ecotoxicology.de>
Message-ID: <AANLkTimkyRH9O_-38sk3vWJdgSJMSkpqsrL6YOh1=0Db@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101028/a14f19f2/attachment.pl>

From tom.kurkowski at alaska.edu  Thu Oct 28 20:23:41 2010
From: tom.kurkowski at alaska.edu (Tom Kurkowski)
Date: Thu, 28 Oct 2010 10:23:41 -0800
Subject: [R-sig-Geo] list to points, reproject, interpolate
Message-ID: <AANLkTin5vq4DGq-5B9xyfLG0pH-NdO-n3eYQYMQqpVJP@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101028/7dd18250/attachment.pl>

From Roger.Bivand at nhh.no  Thu Oct 28 20:56:42 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 28 Oct 2010 20:56:42 +0200 (CEST)
Subject: [R-sig-Geo] Problem nblag_cumul
In-Reply-To: <A7E98C2BA8986D41B47ED5BDC95B25700C3031DA@VEX01.uibk.ac.at>
References: <A7E98C2BA8986D41B47ED5BDC95B25700C3031DA@VEX01.uibk.ac.at>
Message-ID: <alpine.LRH.2.00.1010282050540.19687@reclus.nhh.no>

On Thu, 28 Oct 2010, Hauser, Christoph wrote:

> Hi all!
>
>
>
> As a newcomer to both r and spatial econometrics I am trying to become
> familiar with both worlds. I have a question which is hopefully not too
> trivial: I am trying to create a second order queen matrix for European
> regions. As indicated in the documentation on spdep nblag and
> cumul_nblag are the appropriate commands to carry out this task
> (starting from the poly2nb command). Both commands worked fine, but they
> provided me with a second order matrix with one region having zero
> second order neighbors  (IE01 - Central Ireland). When I tried to
> convert the nb object from cumul_nblag to a listw object the command
> failed with the error message that one region has zero neighbors. This
> struck me as odd given that the combination of first and second order
> matrices should make sure that each region has a neighbor (I don't have
> islands in my set). After inspecting the two neighbor matrices I noticed
> that the combination  of the two matrices based on cumul_nblag worked
> out for every region except the one with zero second order neighbors. My
> question now is if it is customary for nblag_cumul to endow each region
> that has zero second order neighbors also in the cumulated matrix with
> zero regions? Does that make sense from a theoretical point of view?
>

Please put the input data and your code on a website, post the link, and 
I'll try to see whether this is intended or not. It may well be that the 
region with no second order neighbours is causing havoc.

Roger

>
>
> I would be grateful for any help in this regard!
>
>
>
> Christoph
>
>
>
> PS: I am happy to provide my dataset if that is helpful.
>
>
>
> Dr. Christoph Hauser
>
> University of Innsbruck
>
> Department of Economic s
>
> Universitaetsstrasse 15
>
> 6020 Innsbruck
>
> Tel.: 0043 512 507 7354
>
> Fax: 0043 512 507 2980
>
>
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From pslarson2 at gmail.com  Thu Oct 28 21:12:27 2010
From: pslarson2 at gmail.com (Peter Larson)
Date: Thu, 28 Oct 2010 21:12:27 +0200
Subject: [R-sig-Geo] fix color scale
Message-ID: <AANLkTikJuBD3tySpX=dwzo0vKX9NAb0Cz2=SdSn6Jr49@mail.gmail.com>

Hello!

I have a problem.

I am using IDW to interpolate a daily series of geospatial
observations. Thus, I want to produce a large number of sequential
maps.

I want them to all represent the same color scale. Is there any way to
fix the color scale so that it is the same for all the plots?

Thanks,

Pete


From r.hijmans at gmail.com  Thu Oct 28 21:28:34 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 28 Oct 2010 12:28:34 -0700
Subject: [R-sig-Geo] list to points, reproject, interpolate
In-Reply-To: <AANLkTin5vq4DGq-5B9xyfLG0pH-NdO-n3eYQYMQqpVJP@mail.gmail.com>
References: <AANLkTin5vq4DGq-5B9xyfLG0pH-NdO-n3eYQYMQqpVJP@mail.gmail.com>
Message-ID: <AANLkTi=pemiDFW2MwjDEw8Qg_PEhwX6vg9r1428aUedY@mail.gmail.com>

Dear Tom,

Here are some hints:

Do you really have a "list" object? Or do you have a matrix or data.frame?
If you have a matrix 'xyz', create a data.frame like:

xyv <- data.frame(xyv)

library(sp)
#define crs
crs <- CRS("+proj=longlat +datum=WGS84")

# create sp object
pts <-  SpatialPointsDataFrame(coords=xyv[,1:2],
data=xyv[,3,drop=FALSE], proj4string=crs )

# alternative route:
pts <- data.frame(xyv)
colnames(pts) <- c('lon', 'lat')
coordinates(pts) <- ~ lon + lat
pts at proj4string <- crs


# However, if you got the data from a RasterLayer (it looks like it)
# you can avoid the above and simply do:
library(raster)
pts <- rasterToPoints(r, spatial=TRUE)


# Either way, now you can use spTransform

prpts <- spTransform( pts, crs=CRS("+proj=aea +lat_1=55 +lat_2=65
+lat_0=50 +lon_0=-154 +x_0=0 +y_0=0 +ellps=GRS80 +datum=NAD83 +units=m
+no_defs"  ))

# and perhaps extract the coordinates again

newxy <- coordinates(prpts)

For spline interpolation see fields (and the example in
raster::interpolate) and perhaps akima package. I do not know if
natural neighbor is available.

Robert

On Thu, Oct 28, 2010 at 11:23 AM, Tom Kurkowski
<tom.kurkowski at alaska.edu> wrote:
> I have a list of points as (X,Y,value) corresponding to longitude, latitude,
> value. ?The points come from files that are assigned crs="+proj=longlat
> +datum=WGS84"
>
> My goal is to convert this list into some type of geographically referenced
> vector format, and then to reproject it to NAD83 Alaska Albers
> (crs="+proj=aea +lat_1=55 +lat_2=65 +lat_0=50 +lon_0=-154 +x_0=0 +y_0=0
> +ellps=GRS80 +datum=NAD83 +units=m +no_defs")
>
> I am familiar with the raster package, but is there a similar package that
> can do the above using vector formats?
>
> The next step would be to interpolate these newly projected points using
> natural neighbor or the spline methods setting a specific cell size. ?Which
> packages can use these methods?
>
> In summary, list > pts > reproject pts > interpolate pts
>
> I appreciate any guidance immensely,
> Tom
>
> ?Tom Kurkowski | Data Solutions Lead
> Scenarios Network for Alaska & Arctic Planning <http://www.snap.uaf.edu/>
> University of Alaska | 3352 College Rd | Fairbanks AK 99709
> tom.kurkowski at alaska.edu | 907.474.5539
> Find us on Facebook!<http://www.facebook.com/pages/SNAP-and-ACCAP/112992248723524?v=wall>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From senator at ecotoxicology.de  Thu Oct 28 21:53:35 2010
From: senator at ecotoxicology.de (=?iso-8859-1?Q?Ralf_Sch=E4fer?=)
Date: Thu, 28 Oct 2010 21:53:35 +0200
Subject: [R-sig-Geo] Why I can't install RGDAL after R 2.12.0 release?
In-Reply-To: <AANLkTimkyRH9O_-38sk3vWJdgSJMSkpqsrL6YOh1=0Db@mail.gmail.com>
References: <1C99CC51-68A6-4295-A209-A4CFBB438057@ecotoxicology.de>
	<AANLkTimkyRH9O_-38sk3vWJdgSJMSkpqsrL6YOh1=0Db@mail.gmail.com>
Message-ID: <2A81211D-0099-43C8-A3AC-D002584A8134@ecotoxicology.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101028/24a0cdd1/attachment.pl>

From pslarson2 at gmail.com  Thu Oct 28 22:23:04 2010
From: pslarson2 at gmail.com (Peter Larson)
Date: Thu, 28 Oct 2010 22:23:04 +0200
Subject: [R-sig-Geo] Why I can't install RGDAL after R 2.12.0 release?
In-Reply-To: <1C99CC51-68A6-4295-A209-A4CFBB438057@ecotoxicology.de>
References: <1C99CC51-68A6-4295-A209-A4CFBB438057@ecotoxicology.de>
Message-ID: <AANLkTikWdK5sHNVuHafChqUQgdUE81uM7gAGQ2moVW7Z@mail.gmail.com>

Hello all,

I have a grid of points and a spatial polygon shape file. I want to
clip the grid so that I only have the point which lie within the
shapefile.

I tried the following code:

## create a grid onto which we will interpolate:
## first get the range in data
x.range <- c(37,50)
y.range <- c(29,38)

## now expand to a grid with 500 meter spacing:
grd <- expand.grid(x=seq(from=x.range[1], to=x.range[2], by=.01),
y=seq(from=y.range[1], to=y.range[2], by=.01) )

## convert to SpatialPixel class
coordinates(grd) <- ~ x+y
gridded(grd) <- TRUE

## Read in Shapefile
ccShapet=readShapePoly('IRQ_adm0') # here cbg00barncnty is an ArcGIS shapefile

## Clip
clip <- overlay(grd, ccShapet)

#Plot
plot(clip)

BUT it does not work. I just get a vector of number and NA's, but not
the clipped grid.

Any ideas?

Thanks

Pete


From pslarson2 at gmail.com  Thu Oct 28 22:23:45 2010
From: pslarson2 at gmail.com (Peter Larson)
Date: Thu, 28 Oct 2010 22:23:45 +0200
Subject: [R-sig-Geo] Clipping problem
Message-ID: <AANLkTin9AR1BuLExJ_YUhp7PzQ1BAdqd5zj=qybC=W_K@mail.gmail.com>

Hello all,

I have a grid of points and a spatial polygon shape file. I want to
clip the grid so that I only have the point which lie within the
shapefile.

I tried the following code:

## create a grid onto which we will interpolate:
## first get the range in data
x.range <- c(37,50)
y.range <- c(29,38)

## now expand to a grid with 500 meter spacing:
grd <- expand.grid(x=seq(from=x.range[1], to=x.range[2], by=.01),
y=seq(from=y.range[1], to=y.range[2], by=.01) )

## convert to SpatialPixel class
coordinates(grd) <- ~ x+y
gridded(grd) <- TRUE

## Read in Shapefile
ccShapet=readShapePoly('IRQ_adm0') # here cbg00barncnty is an ArcGIS shapefile

## Clip
clip <- overlay(grd, ccShapet)

#Plot
plot(clip)

BUT it does not work. I just get a vector of number and NA's, but not
the clipped grid.

Any ideas?

Thanks

Pete


From edzer.pebesma at uni-muenster.de  Thu Oct 28 22:42:39 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 28 Oct 2010 22:42:39 +0200
Subject: [R-sig-Geo] Clipping problem
In-Reply-To: <AANLkTin9AR1BuLExJ_YUhp7PzQ1BAdqd5zj=qybC=W_K@mail.gmail.com>
References: <AANLkTin9AR1BuLExJ_YUhp7PzQ1BAdqd5zj=qybC=W_K@mail.gmail.com>
Message-ID: <4CC9E03F.3000307@uni-muenster.de>

And that is how it is documented: the help obtained by

methods?overlay

tells you about the method used:

     x = "SpatialPoints", y = "SpatialPolygons" returns a numeric
          vector of length equal to the number of points; the number is
          the index (number) of the polygon of ?y? in which a point
          falls; NA denotes the point does not fall in a polygon; if a
          point falls in multiple polygons, the last polygon is
          recorded.

so

plot(grd[!is.na(clip)])

should give you the pixels inside the polygon(s).

On 10/28/2010 10:23 PM, Peter Larson wrote:
> Hello all,
> 
> I have a grid of points and a spatial polygon shape file. I want to
> clip the grid so that I only have the point which lie within the
> shapefile.
> 
> I tried the following code:
> 
> ## create a grid onto which we will interpolate:
> ## first get the range in data
> x.range <- c(37,50)
> y.range <- c(29,38)
> 
> ## now expand to a grid with 500 meter spacing:
> grd <- expand.grid(x=seq(from=x.range[1], to=x.range[2], by=.01),
> y=seq(from=y.range[1], to=y.range[2], by=.01) )
> 
> ## convert to SpatialPixel class
> coordinates(grd) <- ~ x+y
> gridded(grd) <- TRUE
> 
> ## Read in Shapefile
> ccShapet=readShapePoly('IRQ_adm0') # here cbg00barncnty is an ArcGIS shapefile
> 
> ## Clip
> clip <- overlay(grd, ccShapet)
> 
> #Plot
> plot(clip)
> 
> BUT it does not work. I just get a vector of number and NA's, but not
> the clipped grid.
> 
> Any ideas?
> 
> Thanks
> 
> Pete
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From ksafi at orn.mpg.de  Thu Oct 28 22:47:56 2010
From: ksafi at orn.mpg.de (Kamran Safi)
Date: Thu, 28 Oct 2010 22:47:56 +0200
Subject: [R-sig-Geo] Clipping problem
In-Reply-To: <AANLkTin9AR1BuLExJ_YUhp7PzQ1BAdqd5zj=qybC=W_K@mail.gmail.com>
References: <AANLkTin9AR1BuLExJ_YUhp7PzQ1BAdqd5zj=qybC=W_K@mail.gmail.com>
Message-ID: <4CC9E17C.10804@orn.mpg.de>

Hi Pete,

you get the indices of the points inside the polygons and the associated 
polygon ID value.

something like

clip<- grd[!is.na(overlay(grd, ccShapet)),]



should do.

Hope this helps, although I did not check the line in particular (just 
from the top of my head)

Kamran

Am 28.10.2010 22:23, schrieb Peter Larson:
> Hello all,
>
> I have a grid of points and a spatial polygon shape file. I want to
> clip the grid so that I only have the point which lie within the
> shapefile.
>
> I tried the following code:
>
> ## create a grid onto which we will interpolate:
> ## first get the range in data
> x.range<- c(37,50)
> y.range<- c(29,38)
>
> ## now expand to a grid with 500 meter spacing:
> grd<- expand.grid(x=seq(from=x.range[1], to=x.range[2], by=.01),
> y=seq(from=y.range[1], to=y.range[2], by=.01) )
>
> ## convert to SpatialPixel class
> coordinates(grd)<- ~ x+y
> gridded(grd)<- TRUE
>
> ## Read in Shapefile
> ccShapet=readShapePoly('IRQ_adm0') # here cbg00barncnty is an ArcGIS shapefile
>
> ## Clip
> clip<- overlay(grd, ccShapet)
>
> #Plot
> plot(clip)
>
> BUT it does not work. I just get a vector of number and NA's, but not
> the clipped grid.
>
> Any ideas?
>
> Thanks
>
> Pete
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: ksafi.vcf
Type: text/x-vcard
Size: 400 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101028/9c8f2c8d/attachment.vcf>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 5861 bytes
Desc: S/MIME Cryptographic Signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101028/9c8f2c8d/attachment.bin>

From David.Clifford at csiro.au  Fri Oct 29 01:30:46 2010
From: David.Clifford at csiro.au (David.Clifford at csiro.au)
Date: Fri, 29 Oct 2010 10:30:46 +1100
Subject: [R-sig-Geo] Changing the coordinates of a SpatialGridDataFrame
Message-ID: <27CDE7124B2936429F279F96320D71735EEF0707EE@EXNSW-MBX02.nexus.csiro.au>

Hi there,

I have a SpatialGridDataFrame object and I wish to round the coordinates associated with the grid to three decimal places in order to match points in this object with points on another spatial object where the coordinates are recorded to three decimal places. 

Some information about the obj. It is quite a large grid that covers Australia with over 2 million points in it.

> coords1 <- coordinates(obj)
> dim(coords1)  
[1] 2287841       2
> head(coords1)
            x         y
[1,] 112.0013 -9.999004
[2,] 112.0263 -9.999004
[3,] 112.0513 -9.999004
[4,] 112.0763 -9.999004
[5,] 112.1013 -9.999004
[6,] 112.1263 -9.999004
> 
> obj at coords
            x          y
[1,] 112.0013 -43.999004
[2,] 154.0013  -9.999004
> bbox(obj)
       min        max
x 111.9888 154.013789
y -44.0115  -9.986504
>

My first attempt to do the rounding was based on the coordinates function. When I read the help file it  indicates that one can set the coordinates by passing a matrix here. I get an error as listed below.

> ## First suggestion
> coordinates(obj) <- round(coordinates(obj),3)
Error in `coordinates<-`(`*tmp*`, value = c(112.001, 112.026, 112.051,  : 
  setting coordinates cannot be done on Spatial objects, where they have already been set

A second way was suggested to me that involved rounding obj at coords directly. This produces no errors but also doesn't do the job as you can see below. It does round the obj at coords part but this doesn't have any effect on coordinates(obj) or on bbox(obj).

> ## Second suggestion
> roundcoordinates = function(obj, r = 3) {
+   obj at coords = round(obj at coords, r)
+   obj
+ }
> 
> obj <- roundcoordinates(obj)
> 
> obj at coords
           x       y
[1,] 112.001 -43.999
[2,] 154.001  -9.999
> bbox(obj)
       min        max
x 111.9888 154.013789
y -44.0115  -9.986504
> 
> coords2 <- coordinates(obj)
> head(coords2)
            x         y
[1,] 112.0013 -9.999004
[2,] 112.0263 -9.999004
[3,] 112.0513 -9.999004
[4,] 112.0763 -9.999004
[5,] 112.1013 -9.999004
[6,] 112.1263 -9.999004
>

Does anyone know how to go about this in a way that will also not cause other potential problems - ie changing obj at coords doesn't automatically update coordinates(obj) or bbox(obj). 

Thanks in advance,

David

Dr David Clifford
Research Scientist
CSIRO Division of Mathematics, Informatics and Statistics
Phone: +61 7 3214 2816 | Fax: +61 7 3214 2855 
David.Clifford at csiro.au | www.csiro.au | www.csiro.au/people/David.Clifford.html 
Address: CSIRO Long Pocket Laboratories, 120 Meiers Road, INDOOROOPILLY QLD 4068 
New Postal Address from Nov 2010: CSIRO, EcoSciences Precinct, PO Box 2583, Brisbane, QLD 4001
New Street Address from Nov 2010: CSIRO, EcoSciences Precinct, 41 Boggo Road, Annerley, QLD 4103
New Phone from Nov 2010: +61 7 3833 5532

PLEASE NOTE
The information contained in this email may be confidential or privileged. Any unauthorised use or disclosure is prohibited. If you have received this email in error, please delete it immediately and notify the sender by return email. Thank you. To the extent permitted by law, CSIRO does not represent, warrant and/or guarantee that the integrity of this communication has been maintained or that the communication is free of errors, virus, interception or interference.
Please consider the environment before printing this email.


From mdsumner at gmail.com  Fri Oct 29 01:54:11 2010
From: mdsumner at gmail.com (Michael Sumner)
Date: Fri, 29 Oct 2010 10:54:11 +1100
Subject: [R-sig-Geo] Changing the coordinates of a SpatialGridDataFrame
In-Reply-To: <27CDE7124B2936429F279F96320D71735EEF0707EE@EXNSW-MBX02.nexus.csiro.au>
References: <27CDE7124B2936429F279F96320D71735EEF0707EE@EXNSW-MBX02.nexus.csiro.au>
Message-ID: <AANLkTik+fZ0oJbEk7DTWJkOvbirhqDSOO71Ro6fFtru8@mail.gmail.com>

Probably the best way to do this is to modify the GridTopology and
recreate the grid.

The coordinates of a SpatialGridDataFrame are calculated from the 6
values of the grid topology, only SpatialPixelsDataFrame stores every
cell coordinate (possibly sparsely).

It's best to recreate the object, otherwise you might miss some of the
properties that the constructors generate.


## using your offset from the coords, but assuming equal cellsize and
smallish dims (so my max coordinates differ)
g0 <- GridTopology(cellcentre.offset = c(112.0013, -43.999004),
cellsize = c(0.025, 0.025), cells.dim = c(50, 100))

obj <- SpatialGridDataFrame(g0, data.frame(dat = 1:(50*100)))


## check the min coordinates match yours
 bbox(obj)
##               min      max
##coords.x1 111.9888 113.2388
##coords.x2 -44.0115 -41.5115


g1 <- GridTopology(cellcentre.offset = round(c(112.0013, -43.999004),
3), cellsize = c(0.025, 0.025), cells.dim = c(50, 100))

obj1 <- SpatialGridDataFrame(g1, data.frame(dat = 1:(50*100)))

Another brute force way to do this (brute as it generates every
coordinate, then detects the underlying pattern:

g1 <- points2grid(SpatialPoints(round(coordinates(obj), 3)))

I think that achieves what you were attempting in a literal sense, but
whether it is sensible is another question.

By rounding the "coordinates" directly you may break the regularity of
the grid, though you could work with the coordinates independently of
the grid object itself, as a single matrix or data.frame.

HTH

On Fri, Oct 29, 2010 at 10:30 AM,  <David.Clifford at csiro.au> wrote:
> Hi there,
>
> I have a SpatialGridDataFrame object and I wish to round the coordinates associated with the grid to three decimal places in order to match points in this object with points on another spatial object where the coordinates are recorded to three decimal places.
>
> Some information about the obj. It is quite a large grid that covers Australia with over 2 million points in it.
>
>> coords1 <- coordinates(obj)
>> dim(coords1)
> [1] 2287841 ? ? ? 2
>> head(coords1)
> ? ? ? ? ? ?x ? ? ? ? y
> [1,] 112.0013 -9.999004
> [2,] 112.0263 -9.999004
> [3,] 112.0513 -9.999004
> [4,] 112.0763 -9.999004
> [5,] 112.1013 -9.999004
> [6,] 112.1263 -9.999004
>>
>> obj at coords
> ? ? ? ? ? ?x ? ? ? ? ?y
> [1,] 112.0013 -43.999004
> [2,] 154.0013 ?-9.999004
>> bbox(obj)
> ? ? ? min ? ? ? ?max
> x 111.9888 154.013789
> y -44.0115 ?-9.986504
>>
>
> My first attempt to do the rounding was based on the coordinates function. When I read the help file it ?indicates that one can set the coordinates by passing a matrix here. I get an error as listed below.
>
>> ## First suggestion
>> coordinates(obj) <- round(coordinates(obj),3)
> Error in `coordinates<-`(`*tmp*`, value = c(112.001, 112.026, 112.051, ?:
> ?setting coordinates cannot be done on Spatial objects, where they have already been set
>
> A second way was suggested to me that involved rounding obj at coords directly. This produces no errors but also doesn't do the job as you can see below. It does round the obj at coords part but this doesn't have any effect on coordinates(obj) or on bbox(obj).
>
>> ## Second suggestion
>> roundcoordinates = function(obj, r = 3) {
> + ? obj at coords = round(obj at coords, r)
> + ? obj
> + }
>>
>> obj <- roundcoordinates(obj)
>>
>> obj at coords
> ? ? ? ? ? x ? ? ? y
> [1,] 112.001 -43.999
> [2,] 154.001 ?-9.999
>> bbox(obj)
> ? ? ? min ? ? ? ?max
> x 111.9888 154.013789
> y -44.0115 ?-9.986504
>>
>> coords2 <- coordinates(obj)
>> head(coords2)
> ? ? ? ? ? ?x ? ? ? ? y
> [1,] 112.0013 -9.999004
> [2,] 112.0263 -9.999004
> [3,] 112.0513 -9.999004
> [4,] 112.0763 -9.999004
> [5,] 112.1013 -9.999004
> [6,] 112.1263 -9.999004
>>
>
> Does anyone know how to go about this in a way that will also not cause other potential problems - ie changing obj at coords doesn't automatically update coordinates(obj) or bbox(obj).
>
> Thanks in advance,
>
> David
>
> Dr David Clifford
> Research Scientist
> CSIRO Division of Mathematics, Informatics and Statistics
> Phone: +61 7 3214 2816 | Fax: +61 7 3214 2855
> David.Clifford at csiro.au | www.csiro.au | www.csiro.au/people/David.Clifford.html
> Address: CSIRO Long Pocket Laboratories, 120 Meiers Road, INDOOROOPILLY QLD 4068
> New Postal Address from Nov 2010: CSIRO, EcoSciences Precinct, PO Box 2583, Brisbane, QLD 4001
> New Street Address from Nov 2010: CSIRO, EcoSciences Precinct, 41 Boggo Road, Annerley, QLD 4103
> New Phone from Nov 2010: +61 7 3833 5532
>
> PLEASE NOTE
> The information contained in this email may be confidential or privileged. Any unauthorised use or disclosure is prohibited. If you have received this email in error, please delete it immediately and notify the sender by return email. Thank you. To the extent permitted by law, CSIRO does not represent, warrant and/or guarantee that the integrity of this communication has been maintained or that the communication is free of errors, virus, interception or interference.
> Please consider the environment before printing this email.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Michael Sumner
Institute for Marine and Antarctic Studies, University of Tasmania
Hobart, Australia
e-mail: mdsumner at gmail.com


From ksafi at orn.mpg.de  Fri Oct 29 10:21:16 2010
From: ksafi at orn.mpg.de (Kamran Safi)
Date: Fri, 29 Oct 2010 10:21:16 +0200
Subject: [R-sig-Geo] Changing the coordinates of a SpatialGridDataFrame
In-Reply-To: <27CDE7124B2936429F279F96320D71735EEF0707EE@EXNSW-MBX02.nexus.csiro.au>
References: <27CDE7124B2936429F279F96320D71735EEF0707EE@EXNSW-MBX02.nexus.csiro.au>
Message-ID: <4CCA83FC.5080305@orn.mpg.de>

Hi,

why don't you do:

temp<- as.data.frame("your grid")
temp$lon <- round(temp$lon, 3)
temp$lat <- round(temp$lat, 3)
"your grid" <- temp
coordinates("your grid") <- ~lon+lat
gridded("your grid") <- TRUE

This can be done with less command lines, just wanted to make the 
interpretation easier.

hth

Kamran

Am 29.10.2010 01:30, schrieb David.Clifford at csiro.au:
> Hi there,
>
> I have a SpatialGridDataFrame object and I wish to round the coordinates associated with the grid to three decimal places in order to match points in this object with points on another spatial object where the coordinates are recorded to three decimal places.
>
> Some information about the obj. It is quite a large grid that covers Australia with over 2 million points in it.
>
>> coords1<- coordinates(obj)
>> dim(coords1)
> [1] 2287841       2
>> head(coords1)
>              x         y
> [1,] 112.0013 -9.999004
> [2,] 112.0263 -9.999004
> [3,] 112.0513 -9.999004
> [4,] 112.0763 -9.999004
> [5,] 112.1013 -9.999004
> [6,] 112.1263 -9.999004
>> obj at coords
>              x          y
> [1,] 112.0013 -43.999004
> [2,] 154.0013  -9.999004
>> bbox(obj)
>         min        max
> x 111.9888 154.013789
> y -44.0115  -9.986504
> My first attempt to do the rounding was based on the coordinates function. When I read the help file it  indicates that one can set the coordinates by passing a matrix here. I get an error as listed below.
>
>> ## First suggestion
>> coordinates(obj)<- round(coordinates(obj),3)
> Error in `coordinates<-`(`*tmp*`, value = c(112.001, 112.026, 112.051,  :
>    setting coordinates cannot be done on Spatial objects, where they have already been set
>
> A second way was suggested to me that involved rounding obj at coords directly. This produces no errors but also doesn't do the job as you can see below. It does round the obj at coords part but this doesn't have any effect on coordinates(obj) or on bbox(obj).
>
>> ## Second suggestion
>> roundcoordinates = function(obj, r = 3) {
> +   obj at coords = round(obj at coords, r)
> +   obj
> + }
>> obj<- roundcoordinates(obj)
>>
>> obj at coords
>             x       y
> [1,] 112.001 -43.999
> [2,] 154.001  -9.999
>> bbox(obj)
>         min        max
> x 111.9888 154.013789
> y -44.0115  -9.986504
>> coords2<- coordinates(obj)
>> head(coords2)
>              x         y
> [1,] 112.0013 -9.999004
> [2,] 112.0263 -9.999004
> [3,] 112.0513 -9.999004
> [4,] 112.0763 -9.999004
> [5,] 112.1013 -9.999004
> [6,] 112.1263 -9.999004
> Does anyone know how to go about this in a way that will also not cause other potential problems - ie changing obj at coords doesn't automatically update coordinates(obj) or bbox(obj).
>
> Thanks in advance,
>
> David
>
> Dr David Clifford
> Research Scientist
> CSIRO Division of Mathematics, Informatics and Statistics
> Phone: +61 7 3214 2816 | Fax: +61 7 3214 2855
> David.Clifford at csiro.au | www.csiro.au | www.csiro.au/people/David.Clifford.html
> Address: CSIRO Long Pocket Laboratories, 120 Meiers Road, INDOOROOPILLY QLD 4068
> New Postal Address from Nov 2010: CSIRO, EcoSciences Precinct, PO Box 2583, Brisbane, QLD 4001
> New Street Address from Nov 2010: CSIRO, EcoSciences Precinct, 41 Boggo Road, Annerley, QLD 4103
> New Phone from Nov 2010: +61 7 3833 5532
>
> PLEASE NOTE
> The information contained in this email may be confidential or privileged. Any unauthorised use or disclosure is prohibited. If you have received this email in error, please delete it immediately and notify the sender by return email. Thank you. To the extent permitted by law, CSIRO does not represent, warrant and/or guarantee that the integrity of this communication has been maintained or that the communication is free of errors, virus, interception or interference.
> Please consider the environment before printing this email.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: ksafi.vcf
Type: text/x-vcard
Size: 400 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101029/efd5d799/attachment.vcf>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 5861 bytes
Desc: S/MIME Cryptographic Signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101029/efd5d799/attachment.bin>

From b.rowlingson at lancaster.ac.uk  Fri Oct 29 11:02:36 2010
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Fri, 29 Oct 2010 10:02:36 +0100
Subject: [R-sig-Geo] fix color scale
In-Reply-To: <AANLkTikJuBD3tySpX=dwzo0vKX9NAb0Cz2=SdSn6Jr49@mail.gmail.com>
References: <AANLkTikJuBD3tySpX=dwzo0vKX9NAb0Cz2=SdSn6Jr49@mail.gmail.com>
Message-ID: <AANLkTimjjGWZqinQsHcJz2fnPPSSmxxvVwYw46NHKu2k@mail.gmail.com>

On Thu, Oct 28, 2010 at 8:12 PM, Peter Larson <pslarson2 at gmail.com> wrote:
> Hello!
>
> I have a problem.
>
> I am using IDW to interpolate a daily series of geospatial
> observations. Thus, I want to produce a large number of sequential
> maps.
>
> I want them to all represent the same color scale. Is there any way to
> fix the color scale so that it is the same for all the plots?
>

 I have a solution!

 It's called my colourscheme package:

https://r-forge.r-project.org/projects/colourscheme/

 you create a colourscheme function that maps values to colours, and
then apply that function to the data you want to plot.

For example:

rs = rampInterpolate ( limits =c(-2 , 2),
               ramp = c("red", " yellow ", " blue "))

creates a colour scheme function that maps -2 to red, 0 to yellow, and
2 to blue with continuous RGB interpolation between those values, and
NA elsewhere:

 rs(seq(-3,3,len=10))
 [1] NA          NA          "#FF2A00FF" "#FF8000FF" "#FFD400FF" "#D5D52AFF"
 [7] "#808080FF" "#2B2BD4FF" NA          NA

 plot(seq(-3,3,len=100),col=rs(seq(-3,3,len=100)),pch=19)

 So whatever your data, if you do:

 plot(x,y,col=rs(z))

 you'll get the same colour mapping: -2 is red, +2 is blue.

Barry


From jim at bitwrit.com.au  Fri Oct 29 11:13:36 2010
From: jim at bitwrit.com.au (Jim Lemon)
Date: Fri, 29 Oct 2010 20:13:36 +1100
Subject: [R-sig-Geo] fix color scale
In-Reply-To: <AANLkTikJuBD3tySpX=dwzo0vKX9NAb0Cz2=SdSn6Jr49@mail.gmail.com>
References: <AANLkTikJuBD3tySpX=dwzo0vKX9NAb0Cz2=SdSn6Jr49@mail.gmail.com>
Message-ID: <4CCA9040.7060708@bitwrit.com.au>

On 10/29/2010 06:12 AM, Peter Larson wrote:
> Hello!
>
> I have a problem.
>
> I am using IDW to interpolate a daily series of geospatial
> observations. Thus, I want to produce a large number of sequential
> maps.
>
> I want them to all represent the same color scale. Is there any way to
> fix the color scale so that it is the same for all the plots?
>
Hi Pete,
This can be done with the color.scale function by tacking the extreme 
values onto the actual ones for the scaling, then removing the extreme 
values when plotting. See the second example for the barp function in 
the plotrix package. This may work for other value to color 
transformation functions as well.

Jim


From plieger at knmi.nl  Fri Oct 29 15:10:40 2010
From: plieger at knmi.nl (Maarten Plieger)
Date: Fri, 29 Oct 2010 13:10:40 +0000
Subject: [R-sig-Geo] spplot vs sp.polygon - Problem when drawing polygon
 with holes/islands overlay
Message-ID: <4CCAC7D0.6080603@knmi.nl>

Hi all,

I am having a (known) problem with plotting polygons with islands and 
holes. I would like to visually mask my raster data with a polygon 
overlay. The problem is that my polygon data has islands/holes, and 
these are not drawn correctly when used as an overlay with the spplot 
panel function.

When I use spplot directly to plot my polygons there is no problem:
spplot(countryOverlay [which(countryOverlay 
$FID_Countr==0),],"CNTRYNAME",   ylim=c(300000,624000),    
xlim=c(0,285000),col.regions=c("transparent","transparent","transparent","blue","transparent")  
)
(see spplot.png)

Now I would like to use the spplot panel function to draw the same data 
as an overlay:
spplot(countryOverlay,"CNTRYNAME" ,ylim=c(300000,624000),    
xlim=c(0,285000)  , 
   panel = function(...) {
    sp.polygons( countryOverlay [which(countryOverlay $FID_Countr==0),], 
fill = "blue",col = "black")
    }
)
But now, the islands are gone! (see sp.polygons.png)
(The example above is just to demonstrate this problem/feature, it does 
not draw my gridded data.)

Is it possible to draw the polygons as an overlay, and preserve the 
islands? Maybe use another function?
I see that sp.polygon uses grid::polygonGrob, and is documented that 
this function does not preserve the holes.
I find it strange that spplot itself can draw the dataset correctly, so 
it must be possible to draw the polygon correctly as an overlay... or not?

If people are interested, I have a small R script available with some 
test data to demonstrate the problem.

Best Regards,
Maarten Plieger

-- 
Maarten Plieger
KNMI, R&D Information and Observation Technology, De Bilt
(t) +31 30 2206330

-------------- next part --------------
A non-text attachment was scrubbed...
Name: sp.polygons.png
Type: image/png
Size: 10830 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101029/8e805da2/attachment.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: spplot.png
Type: image/png
Size: 10795 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101029/8e805da2/attachment-0001.png>

From lestes at princeton.edu  Fri Oct 29 15:50:43 2010
From: lestes at princeton.edu (Lyndon Estes)
Date: Fri, 29 Oct 2010 09:50:43 -0400
Subject: [R-sig-Geo] fix color scale
In-Reply-To: <AANLkTikJuBD3tySpX=dwzo0vKX9NAb0Cz2=SdSn6Jr49@mail.gmail.com>
References: <AANLkTikJuBD3tySpX=dwzo0vKX9NAb0Cz2=SdSn6Jr49@mail.gmail.com>
Message-ID: <AANLkTimZK2mOESRCNNu=T-FfQjqsCrSQ9H1x0fw30UU+@mail.gmail.com>

Hi Peter,

I am not sure which plot function you are using, but I did something
similar where I plotted a series of maps for crop yields with a
constant scale for yield, using sp.plot. My data were in an attribute
table linked to a polygon, whereas yours are grids, but maybe
something in the following can be used?

  # Loop through columns of shapefile (eval.shp2) to plot: Yield from
various cultivars
  for (i in 4:13) {

   print(paste("Plotting column: ", i))  # Column counter

    # Establish scale limits and title vector
      scmax  <- round(max(eval.shp2 at data[, 4:12]) / 100, 0) * 100  #
Set max scale value
      scmin  <- round(min(eval.shp2 at data[, 4:12]) / 100, 0) * 100  #
Set min scale value
      byval  <- 25
      titlevec <- paste("district maize yields (kg/ha) 1981-99:
Cultivar", culnames[i - 3])

    # Spplot
    print(spplot(eval.shp2[-c(22,69),], z = i,
          sp.layout = list(sa.lst),
          col.regions = topo.colors(500),
          at = seq(scmin, scmax, by = byval), main = titlevec))
  }

In your case, since you are using grids, maybe you can read the
interpolated grids' metadata first to extract the max and min and
values for setting your scale.  Or perhaps you know in advance what
the max and min should be, and can simply enter those values?

Hope this is somewhat useful.

Cheers, Lyndon




On Thu, Oct 28, 2010 at 3:12 PM, Peter Larson <pslarson2 at gmail.com> wrote:
> Hello!
>
> I have a problem.
>
> I am using IDW to interpolate a daily series of geospatial
> observations. Thus, I want to produce a large number of sequential
> maps.
>
> I want them to all represent the same color scale. Is there any way to
> fix the color scale so that it is the same for all the plots?
>
> Thanks,
>
> Pete
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>



-- 
Lyndon Estes
Research Associate
Woodrow Wilson School
Princeton University
+1-609-258-2392 (o)
+1-609-258-6082 (f)
+1-202-431-0496 (m)
lestes at princeton.edu


From dazhi.jiao at gmail.com  Fri Oct 29 16:10:26 2010
From: dazhi.jiao at gmail.com (Dazhi Jiao)
Date: Fri, 29 Oct 2010 10:10:26 -0400
Subject: [R-sig-Geo] convert NAD83 to latitude/longitude
Message-ID: <AANLkTikTa8ommAsj9CyaWDi-VU7iCGtUOpQgbscMg18C@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101029/6ae2d417/attachment.pl>

From lestes at princeton.edu  Fri Oct 29 16:21:21 2010
From: lestes at princeton.edu (Lyndon Estes)
Date: Fri, 29 Oct 2010 10:21:21 -0400
Subject: [R-sig-Geo] Advice on raster workflow: subs -> resample
Message-ID: <AANLkTin0AX8wBahD6r4fmmkj51RhzMSe31pprKOJ0QOC@mail.gmail.com>

Hello,

I am writing to ask for advice as to whether I am following the most
efficient/fastest workflow for a task using the raster package. This
involves 3 datasets:

1. modtest: A ~927 m resolution satellite-derived image:
nrow        : 141
ncol        : 189
ncell       : 26649
min value   : ?
max value   : ?
projection  : +proj=aea +lat_1=-18 +lat_2=-32 +lat_0=0 +lon_0=24
+x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs
+towgs84=0,0,0
xmin        : 415851.2
xmax        : 590983.4
ymin        : -2670093
ymax        : -2539439
xres        : 926.6254
yres        : 926.6254

2. lt.q.test: a ~92 m resolution grid representing identifiers for
unique climate-soil combinations:
nrow        : 1403
ncol        : 1878
ncell       : 2634834
min value   : ?
max value   : ?
projection  : +proj=aea +lat_1=-18 +lat_2=-32 +lat_0=0 +lon_0=24
+x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs
+towgs84=0,0,0
xmin        : 415926.7
xmax        : 590091.6
ymin        : -2670093
ymax        : -2539979
xres        : 92.73961
yres        : 92.73961

3. sum.stats: A dataframe within a list with several variables
relating to outputs from a crop simulations, and one variable
containing values corresponding to the identifiers in yld.test.

My task is to
1. assign crop yield values from sum.stats to lt.q.test
2. resample the result of 1 to the resolution of modtest, so that the
images are lined up, and so that the yield values in yld.test are
averaged/aggregated to modtest's resolution.

The solution I have come up with so far is:

library(raster)

lt.q.test <- raster(paste(path.in, "lt_quin_test1.img", sep = ""))

# Assign values from sum.stats (in y.mn column) to yld.test,
outputting values as integers.
setwd(path.out)
subs(lt.q.test, sum.stats[[1]], by = "VALUE", which = "y.mn",
subsWithNA = TRUE,
                 filename = "yld.rst4.img", format = 'HFA', datatype = "INT2S")

# Resample yld.test to resolution of modtest
yld.test <- raster("yld.rst4.img")
modtest <- raster("MOD_SA_NDVI_amp_albers_test.img")
resample(yld.test, modtest, method = "bilinear", filename =
"yld.resamp.test.img", datatype = "INT2S",
         format = "HFA")  # This seems to work

The above is performed on fairly small test datasets, and I must now
apply this approach multiple times to the full size versions of the
input datasets, where the dimensions of lt.q.test are:

nrow        : 15170
ncol        : 17364
ncell       : 263411880

and modtest's dimensions are:

nrow        : 1651
ncol        : 1937
ncell       : 3197987

I was thus wondering if there is a more efficient approach that I
should adopt, or if there are any other
concerns of which I should be aware?

Thanks in advance for any advice.

Cheers, Lyndon


From dazhi.jiao at gmail.com  Fri Oct 29 16:57:00 2010
From: dazhi.jiao at gmail.com (Dazhi Jiao)
Date: Fri, 29 Oct 2010 10:57:00 -0400
Subject: [R-sig-Geo] convert NAD83 to latitude/longitude
In-Reply-To: <AANLkTimxPUEzW_LCR+DG2njmxGE3BxxzYKL2Wr6QO1N_@mail.gmail.com>
References: <AANLkTikTa8ommAsj9CyaWDi-VU7iCGtUOpQgbscMg18C@mail.gmail.com>
	<AANLkTimxPUEzW_LCR+DG2njmxGE3BxxzYKL2Wr6QO1N_@mail.gmail.com>
Message-ID: <AANLkTiknY6U=j9KOCvQ3XEdyJt7+hn141iXjQ_KWWs_c@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101029/e8617408/attachment.pl>

From landis at isciences.com  Fri Oct 29 17:12:14 2010
From: landis at isciences.com (Matthew Landis)
Date: Fri, 29 Oct 2010 11:12:14 -0400
Subject: [R-sig-Geo] fix color scale
In-Reply-To: <AANLkTikJuBD3tySpX=dwzo0vKX9NAb0Cz2=SdSn6Jr49@mail.gmail.com>
References: <AANLkTikJuBD3tySpX=dwzo0vKX9NAb0Cz2=SdSn6Jr49@mail.gmail.com>
Message-ID: <4CCAE44E.9040504@isciences.com>

Peter,
is it more complicated than simply specifying the colors and breaks?

e.g.
zbreaks <- c(seq(-100, 100, length = 10))  # or any other sequence of breaks
zcol <- heat.colors(length(zbreaks) - 1)    # or any other color 
palette, e.g. from colorspace or RColorBrewer

for( i in 1:maps ){
     image(z = maps[i], breaks = zbreaks, col = zcol)  # image needs x 
and y too, omitted for simplicity
}

Matt

On 10/28/2010 3:12 PM, Peter Larson wrote:
> I want them to all represent the same color scale. Is there any way to
> fix the color scale so that it is the same for all the plots?

-- 
~~~~~~~~~~~~~~~~~~~~~~~~~~
Matthew Landis, Ph.D.
Research Scientist
ISciences, LLC
61 Main St. Suite 200
Burlington VT 05401
802.864.2999
~~~~~~~~~~~~~~~~~~~~~~~~~~


From govindas at msu.edu  Fri Oct 29 17:30:24 2010
From: govindas at msu.edu (govindas at msu.edu)
Date: Fri, 29 Oct 2010 11:30:24 -0400
Subject: [R-sig-Geo] doubt in climate variability analysis in R!
Message-ID: <20101029113024.15747b3x72zlbt00@mail.msu.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101029/b6a01258/attachment.pl>

From moshersteven at gmail.com  Fri Oct 29 18:13:56 2010
From: moshersteven at gmail.com (steven mosher)
Date: Fri, 29 Oct 2010 09:13:56 -0700
Subject: [R-sig-Geo] doubt in climate variability analysis in R!
In-Reply-To: <20101029113024.15747b3x72zlbt00@mail.msu.edu>
References: <20101029113024.15747b3x72zlbt00@mail.msu.edu>
Message-ID: <AANLkTin9z70cvkF1ki5SJxKhSLvLVug0fzRHBdwNOL2g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101029/f2dfab38/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Fri Oct 29 18:21:09 2010
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Fri, 29 Oct 2010 17:21:09 +0100
Subject: [R-sig-Geo] convert NAD83 to latitude/longitude
In-Reply-To: <AANLkTiknY6U=j9KOCvQ3XEdyJt7+hn141iXjQ_KWWs_c@mail.gmail.com>
References: <AANLkTikTa8ommAsj9CyaWDi-VU7iCGtUOpQgbscMg18C@mail.gmail.com>
	<AANLkTimxPUEzW_LCR+DG2njmxGE3BxxzYKL2Wr6QO1N_@mail.gmail.com>
	<AANLkTiknY6U=j9KOCvQ3XEdyJt7+hn141iXjQ_KWWs_c@mail.gmail.com>
Message-ID: <AANLkTinwC7bMPj9gXRysthSKyLpKicpxNHtGR8zWBqu3@mail.gmail.com>

On Fri, Oct 29, 2010 at 3:57 PM, Dazhi Jiao <dazhi.jiao at gmail.com> wrote:
> Hi, Barry,
>
> Thank you for the reply. Here are a few examples.
>
> They are registered to NAD 83 California Zone V in feet. What I want to map
> to should be the most common longitude latitude system. For example,
> 6638699, 1924377 should be projected to -117.745, 34.28
>
>
> 6425591 1894450
> 6425843 1893769
> 6425828 1893347

 Ah ha, that's more like it. I look up California in my handle table
of EPSG codes and find:

+proj=lcc +lat_1=35.46666666666667 +lat_2=34.03333333333333
+lat_0=33.5 +lon_0=-118 +x_0=2000000.0001016 +y_0=500000.0001016001
+ellps=GRS80 +datum=NAD83 +to_meter=0.3048006096012192 +no_defs

 or epsg:2229 for short is NAD83/California Zone 5 (ftUS)

So I can do:

library(sp);library(rgdal)
pts = data.frame(x=c(6425591,6425843,6425828,6638699),y=c(1894450,1893769,1893347,1924377))
coordinates(pts)=~x+y
proj4string(pts)=CRS("+init=epsg:2229")
ptsLL = spTransform(pts,CRS("+proj=longlat +datum=WGS84"))

giving:

ptsLL:

SpatialPoints:
             x        y
[1,] -118.4500 34.19720
[2,] -118.4492 34.19533
[3,] -118.4492 34.19417
[4,] -117.7450 34.28000
Coordinate Reference System (CRS) arguments: +proj=longlat +datum=WGS84
+ellps=WGS84 +towgs84=0,0,0


How's that?

Barry


From dazhi.jiao at gmail.com  Fri Oct 29 18:42:41 2010
From: dazhi.jiao at gmail.com (Dazhi Jiao)
Date: Fri, 29 Oct 2010 12:42:41 -0400
Subject: [R-sig-Geo] convert NAD83 to latitude/longitude
In-Reply-To: <AANLkTinwC7bMPj9gXRysthSKyLpKicpxNHtGR8zWBqu3@mail.gmail.com>
References: <AANLkTikTa8ommAsj9CyaWDi-VU7iCGtUOpQgbscMg18C@mail.gmail.com>
	<AANLkTimxPUEzW_LCR+DG2njmxGE3BxxzYKL2Wr6QO1N_@mail.gmail.com>
	<AANLkTiknY6U=j9KOCvQ3XEdyJt7+hn141iXjQ_KWWs_c@mail.gmail.com>
	<AANLkTinwC7bMPj9gXRysthSKyLpKicpxNHtGR8zWBqu3@mail.gmail.com>
Message-ID: <AANLkTimmwEhO1vWMb5RsKUUnsCdrp4mztwviHU2bSHev@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101029/90985eb5/attachment.pl>

From r.hijmans at gmail.com  Fri Oct 29 18:52:51 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Fri, 29 Oct 2010 09:52:51 -0700
Subject: [R-sig-Geo] Advice on raster workflow: subs -> resample
In-Reply-To: <AANLkTin0AX8wBahD6r4fmmkj51RhzMSe31pprKOJ0QOC@mail.gmail.com>
References: <AANLkTin0AX8wBahD6r4fmmkj51RhzMSe31pprKOJ0QOC@mail.gmail.com>
Message-ID: <AANLkTim-aCtCfG1P8+e6xXNaxAoZUuZpBSP2bLbKOxYh@mail.gmail.com>

Dear Lyndon,

That looks good to me, except that I do not think it is wise to
resample when the resolutions are different by an order of magnitude.
I think it is better to first use aggregate to get a similar
resolution and then use resample (although I never formally compared
these different strategies). As in the below.

lt.q.test <- raster(paste(path.in, "lt_quin_test1.img", sep = ""))
# Assign values from sum.stats (in y.mn column) to yld.test,
outputting values as integers.
setwd(path.out)
yld.test = subs(lt.q.test, sum.stats[[1]], by="VALUE", which="y.mn",
subsWithNA = TRUE, filename="yld.rst4.img", format='HFA',
datatype="INT2S")

# perhaps first aggregate
agg <- aggregate(yld.test, 10, fun=mean, na.rm=TRUE)

# Resample agg to resolution of modtest
modtest <- raster("MOD_SA_NDVI_amp_albers_test.img")
aggres <- resample(agg, modtest, method = "bilinear", filename =
"yld.resamp.test.img", datatype = "INT2S", format = "HFA")  # This
seems to work


These are functions are not very fast, but I do not think there is a
better alternative with 'raster'. Computers are patient, fortunately.

R


On Fri, Oct 29, 2010 at 7:21 AM, Lyndon Estes <lestes at princeton.edu> wrote:
> Hello,
>
> I am writing to ask for advice as to whether I am following the most
> efficient/fastest workflow for a task using the raster package. This
> involves 3 datasets:
>
> 1. modtest: A ~927 m resolution satellite-derived image:
> nrow ? ? ? ?: 141
> ncol ? ? ? ?: 189
> ncell ? ? ? : 26649
> min value ? : ?
> max value ? : ?
> projection ?: +proj=aea +lat_1=-18 +lat_2=-32 +lat_0=0 +lon_0=24
> +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs
> +towgs84=0,0,0
> xmin ? ? ? ?: 415851.2
> xmax ? ? ? ?: 590983.4
> ymin ? ? ? ?: -2670093
> ymax ? ? ? ?: -2539439
> xres ? ? ? ?: 926.6254
> yres ? ? ? ?: 926.6254
>
> 2. lt.q.test: a ~92 m resolution grid representing identifiers for
> unique climate-soil combinations:
> nrow ? ? ? ?: 1403
> ncol ? ? ? ?: 1878
> ncell ? ? ? : 2634834
> min value ? : ?
> max value ? : ?
> projection ?: +proj=aea +lat_1=-18 +lat_2=-32 +lat_0=0 +lon_0=24
> +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs
> +towgs84=0,0,0
> xmin ? ? ? ?: 415926.7
> xmax ? ? ? ?: 590091.6
> ymin ? ? ? ?: -2670093
> ymax ? ? ? ?: -2539979
> xres ? ? ? ?: 92.73961
> yres ? ? ? ?: 92.73961
>
> 3. sum.stats: A dataframe within a list with several variables
> relating to outputs from a crop simulations, and one variable
> containing values corresponding to the identifiers in yld.test.
>
> My task is to
> 1. assign crop yield values from sum.stats to lt.q.test
> 2. resample the result of 1 to the resolution of modtest, so that the
> images are lined up, and so that the yield values in yld.test are
> averaged/aggregated to modtest's resolution.
>
> The solution I have come up with so far is:
>
> library(raster)
>
> lt.q.test <- raster(paste(path.in, "lt_quin_test1.img", sep = ""))
>
> # Assign values from sum.stats (in y.mn column) to yld.test,
> outputting values as integers.
> setwd(path.out)
> subs(lt.q.test, sum.stats[[1]], by = "VALUE", which = "y.mn",
> subsWithNA = TRUE,
> ? ? ? ? ? ? ? ? filename = "yld.rst4.img", format = 'HFA', datatype = "INT2S")
>
> # Resample yld.test to resolution of modtest
> yld.test <- raster("yld.rst4.img")
> modtest <- raster("MOD_SA_NDVI_amp_albers_test.img")
> resample(yld.test, modtest, method = "bilinear", filename =
> "yld.resamp.test.img", datatype = "INT2S",
> ? ? ? ? format = "HFA") ?# This seems to work
>
> The above is performed on fairly small test datasets, and I must now
> apply this approach multiple times to the full size versions of the
> input datasets, where the dimensions of lt.q.test are:
>
> nrow ? ? ? ?: 15170
> ncol ? ? ? ?: 17364
> ncell ? ? ? : 263411880
>
> and modtest's dimensions are:
>
> nrow ? ? ? ?: 1651
> ncol ? ? ? ?: 1937
> ncell ? ? ? : 3197987
>
> I was thus wondering if there is a more efficient approach that I
> should adopt, or if there are any other
> concerns of which I should be aware?
>
> Thanks in advance for any advice.
>
> Cheers, Lyndon
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From lestes at princeton.edu  Fri Oct 29 19:58:59 2010
From: lestes at princeton.edu (Lyndon Estes)
Date: Fri, 29 Oct 2010 13:58:59 -0400
Subject: [R-sig-Geo] Advice on raster workflow: subs -> resample
In-Reply-To: <AANLkTim-aCtCfG1P8+e6xXNaxAoZUuZpBSP2bLbKOxYh@mail.gmail.com>
References: <AANLkTin0AX8wBahD6r4fmmkj51RhzMSe31pprKOJ0QOC@mail.gmail.com>
	<AANLkTim-aCtCfG1P8+e6xXNaxAoZUuZpBSP2bLbKOxYh@mail.gmail.com>
Message-ID: <AANLkTik1Ddo2gXqcO5k9zuZHxn8X_gMnwyd+5naqBUBB@mail.gmail.com>

Dear Robert,

Many thanks for your advice.  I hadn't considered the differences in
resolutions, so am inserting that step (it works nicely).

Much appreciated.

Cheers, Lyndon

On Fri, Oct 29, 2010 at 12:52 PM, Robert J. Hijmans <r.hijmans at gmail.com> wrote:
> Dear Lyndon,
>
> That looks good to me, except that I do not think it is wise to
> resample when the resolutions are different by an order of magnitude.
> I think it is better to first use aggregate to get a similar
> resolution and then use resample (although I never formally compared
> these different strategies). As in the below.
>
> lt.q.test <- raster(paste(path.in, "lt_quin_test1.img", sep = ""))
> # Assign values from sum.stats (in y.mn column) to yld.test,
> outputting values as integers.
> setwd(path.out)
> yld.test = subs(lt.q.test, sum.stats[[1]], by="VALUE", which="y.mn",
> subsWithNA = TRUE, filename="yld.rst4.img", format='HFA',
> datatype="INT2S")
>
> # perhaps first aggregate
> agg <- aggregate(yld.test, 10, fun=mean, na.rm=TRUE)
>
> # Resample agg to resolution of modtest
> modtest <- raster("MOD_SA_NDVI_amp_albers_test.img")
> aggres <- resample(agg, modtest, method = "bilinear", filename =
> "yld.resamp.test.img", datatype = "INT2S", format = "HFA") ?# This
> seems to work
>
>
> These are functions are not very fast, but I do not think there is a
> better alternative with 'raster'. Computers are patient, fortunately.
>
> R
>
>
> On Fri, Oct 29, 2010 at 7:21 AM, Lyndon Estes <lestes at princeton.edu> wrote:
>> Hello,
>>
>> I am writing to ask for advice as to whether I am following the most
>> efficient/fastest workflow for a task using the raster package. This
>> involves 3 datasets:
>>
>> 1. modtest: A ~927 m resolution satellite-derived image:
>> nrow ? ? ? ?: 141
>> ncol ? ? ? ?: 189
>> ncell ? ? ? : 26649
>> min value ? : ?
>> max value ? : ?
>> projection ?: +proj=aea +lat_1=-18 +lat_2=-32 +lat_0=0 +lon_0=24
>> +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs
>> +towgs84=0,0,0
>> xmin ? ? ? ?: 415851.2
>> xmax ? ? ? ?: 590983.4
>> ymin ? ? ? ?: -2670093
>> ymax ? ? ? ?: -2539439
>> xres ? ? ? ?: 926.6254
>> yres ? ? ? ?: 926.6254
>>
>> 2. lt.q.test: a ~92 m resolution grid representing identifiers for
>> unique climate-soil combinations:
>> nrow ? ? ? ?: 1403
>> ncol ? ? ? ?: 1878
>> ncell ? ? ? : 2634834
>> min value ? : ?
>> max value ? : ?
>> projection ?: +proj=aea +lat_1=-18 +lat_2=-32 +lat_0=0 +lon_0=24
>> +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs
>> +towgs84=0,0,0
>> xmin ? ? ? ?: 415926.7
>> xmax ? ? ? ?: 590091.6
>> ymin ? ? ? ?: -2670093
>> ymax ? ? ? ?: -2539979
>> xres ? ? ? ?: 92.73961
>> yres ? ? ? ?: 92.73961
>>
>> 3. sum.stats: A dataframe within a list with several variables
>> relating to outputs from a crop simulations, and one variable
>> containing values corresponding to the identifiers in yld.test.
>>
>> My task is to
>> 1. assign crop yield values from sum.stats to lt.q.test
>> 2. resample the result of 1 to the resolution of modtest, so that the
>> images are lined up, and so that the yield values in yld.test are
>> averaged/aggregated to modtest's resolution.
>>
>> The solution I have come up with so far is:
>>
>> library(raster)
>>
>> lt.q.test <- raster(paste(path.in, "lt_quin_test1.img", sep = ""))
>>
>> # Assign values from sum.stats (in y.mn column) to yld.test,
>> outputting values as integers.
>> setwd(path.out)
>> subs(lt.q.test, sum.stats[[1]], by = "VALUE", which = "y.mn",
>> subsWithNA = TRUE,
>> ? ? ? ? ? ? ? ? filename = "yld.rst4.img", format = 'HFA', datatype = "INT2S")
>>
>> # Resample yld.test to resolution of modtest
>> yld.test <- raster("yld.rst4.img")
>> modtest <- raster("MOD_SA_NDVI_amp_albers_test.img")
>> resample(yld.test, modtest, method = "bilinear", filename =
>> "yld.resamp.test.img", datatype = "INT2S",
>> ? ? ? ? format = "HFA") ?# This seems to work
>>
>> The above is performed on fairly small test datasets, and I must now
>> apply this approach multiple times to the full size versions of the
>> input datasets, where the dimensions of lt.q.test are:
>>
>> nrow ? ? ? ?: 15170
>> ncol ? ? ? ?: 17364
>> ncell ? ? ? : 263411880
>>
>> and modtest's dimensions are:
>>
>> nrow ? ? ? ?: 1651
>> ncol ? ? ? ?: 1937
>> ncell ? ? ? : 3197987
>>
>> I was thus wondering if there is a more efficient approach that I
>> should adopt, or if there are any other
>> concerns of which I should be aware?
>>
>> Thanks in advance for any advice.
>>
>> Cheers, Lyndon
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>



-- 
Lyndon Estes
Research Associate
Woodrow Wilson School
Princeton University
+1-609-258-2392 (o)
+1-609-258-6082 (f)
+1-202-431-0496 (m)
lestes at princeton.edu


From pslarson2 at gmail.com  Fri Oct 29 21:28:49 2010
From: pslarson2 at gmail.com (Peter Larson)
Date: Fri, 29 Oct 2010 21:28:49 +0200
Subject: [R-sig-Geo] convert from spatstat to sp
Message-ID: <AANLkTim0a0NEkMuRu1ND=Wuyu5j897NeXKRxPemYxc0j@mail.gmail.com>

Hello all,

Is there any way to convert from spatstat to sp?

Specifically, I am looking to clip a density plot produced in spatstat
to include only points within a polygon boundary in a shapefile. if
there is a way to clip in spatstat, this would also be acceptable.

Any ideas?

Thanks

pete


From r.hijmans at gmail.com  Fri Oct 29 21:37:44 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Fri, 29 Oct 2010 12:37:44 -0700
Subject: [R-sig-Geo] convert from spatstat to sp
In-Reply-To: <AANLkTim0a0NEkMuRu1ND=Wuyu5j897NeXKRxPemYxc0j@mail.gmail.com>
References: <AANLkTim0a0NEkMuRu1ND=Wuyu5j897NeXKRxPemYxc0j@mail.gmail.com>
Message-ID: <AANLkTi=gqGXaAaXEK_p28Fa21eQGvzsT0a2o=jUjFN2U@mail.gmail.com>

Peter,

If this is an "im" object you can use

library(raster)
r <- raster(im)
r <- polygonsToRaster(pols, r, mask=TRUE)

You can also use the coercion methods between spatsat and sp that are
available in maptools and then use sp overlay methods

I do not know if you can clip in spatstat, but I would guess so.

Robert


On Fri, Oct 29, 2010 at 12:28 PM, Peter Larson <pslarson2 at gmail.com> wrote:
> Hello all,
>
> Is there any way to convert from spatstat to sp?
>
> Specifically, I am looking to clip a density plot produced in spatstat
> to include only points within a polygon boundary in a shapefile. if
> there is a way to clip in spatstat, this would also be acceptable.
>
> Any ideas?
>
> Thanks
>
> pete
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From edzer.pebesma at uni-muenster.de  Fri Oct 29 22:36:51 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 29 Oct 2010 22:36:51 +0200
Subject: [R-sig-Geo] convert from spatstat to sp
In-Reply-To: <AANLkTim0a0NEkMuRu1ND=Wuyu5j897NeXKRxPemYxc0j@mail.gmail.com>
References: <AANLkTim0a0NEkMuRu1ND=Wuyu5j897NeXKRxPemYxc0j@mail.gmail.com>
Message-ID: <4CCB3063.5050502@uni-muenster.de>

There is; if your question is about converting an object of class im
(spatstat) to an object of class SpatialGridDataFrame (sp), it is in
package maptools:

library(spatstat)
whitenoise <- im(matrix(rnorm(1200),30,40))
library(maptools)
x = as(as(whitenoise, "SpatialGridDataFrame"), "SpatialPixelsDataFrame")

if your polygons are in SpatialPolygons object pol, then

sel = overlay(x, pol)
x.sel = x[!is.na(sel),]
spplot(x.sel)

should get you there.


On 10/29/2010 09:28 PM, Peter Larson wrote:
> Hello all,
> 
> Is there any way to convert from spatstat to sp?
> 
> Specifically, I am looking to clip a density plot produced in spatstat
> to include only points within a polygon boundary in a shapefile. if
> there is a way to clip in spatstat, this would also be acceptable.
> 
> Any ideas?
> 
> Thanks
> 
> pete
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From Roger.Bivand at nhh.no  Fri Oct 29 23:46:41 2010
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 29 Oct 2010 23:46:41 +0200 (CEST)
Subject: [R-sig-Geo] Problem nblag_cumul
In-Reply-To: <alpine.LRH.2.00.1010282050540.19687@reclus.nhh.no>
References: <A7E98C2BA8986D41B47ED5BDC95B25700C3031DA@VEX01.uibk.ac.at>
	<alpine.LRH.2.00.1010282050540.19687@reclus.nhh.no>
Message-ID: <alpine.LRH.2.00.1010292335510.23934@reclus.nhh.no>

On Thu, 28 Oct 2010, Roger Bivand wrote:

> On Thu, 28 Oct 2010, Hauser, Christoph wrote:
>
>> Hi all!
>> 
>> 
>> 
>> As a newcomer to both r and spatial econometrics I am trying to become
>> familiar with both worlds. I have a question which is hopefully not too
>> trivial: I am trying to create a second order queen matrix for European
>> regions. As indicated in the documentation on spdep nblag and
>> cumul_nblag are the appropriate commands to carry out this task
>> (starting from the poly2nb command). Both commands worked fine, but they
>> provided me with a second order matrix with one region having zero
>> second order neighbors  (IE01 - Central Ireland). When I tried to
>> convert the nb object from cumul_nblag to a listw object the command
>> failed with the error message that one region has zero neighbors. This
>> struck me as odd given that the combination of first and second order
>> matrices should make sure that each region has a neighbor (I don't have
>> islands in my set). After inspecting the two neighbor matrices I noticed
>> that the combination  of the two matrices based on cumul_nblag worked
>> out for every region except the one with zero second order neighbors. My
>> question now is if it is customary for nblag_cumul to endow each region
>> that has zero second order neighbors also in the cumulated matrix with
>> zero regions? Does that make sense from a theoretical point of view?
>> 
>
> Please put the input data and your code on a website, post the link, and I'll 
> try to see whether this is intended or not. It may well be that the region 
> with no second order neighbours is causing havoc.

Is the problem that you have a data set (maybe from GISCO) that includes 
different NUTS levels in the same file? The one I'm looking at includes 
IE, IE0 - identical, all Eire, then IE01 and IE02, which divide Eire into 
two parts at NUTS2, then IE01?, IE02?, in total 8 NUTS3 regions? Which 
level of NUTS are you working at, and where have your boundaries come 
from? Are you sure that your file does not include multiple levels - I can 
reproduce the problem when multiple levels are present, but not otherwise.

Roger

>
> Roger
>
>> 
>> 
>> I would be grateful for any help in this regard!
>> 
>> 
>> 
>> Christoph
>> 
>> 
>> 
>> PS: I am happy to provide my dataset if that is helpful.
>> 
>> 
>> 
>> Dr. Christoph Hauser
>> 
>> University of Innsbruck
>> 
>> Department of Economic s
>> 
>> Universitaetsstrasse 15
>> 
>> 6020 Innsbruck
>> 
>> Tel.: 0043 512 507 7354
>> 
>> Fax: 0043 512 507 2980
>> 
>> 
>> 
>>
>> 	[[alternative HTML version deleted]]
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From r.turner at auckland.ac.nz  Sat Oct 30 00:23:23 2010
From: r.turner at auckland.ac.nz (Turner Rolf)
Date: Sat, 30 Oct 2010 11:23:23 +1300
Subject: [R-sig-Geo] convert from spatstat to sp
In-Reply-To: <AANLkTim0a0NEkMuRu1ND=Wuyu5j897NeXKRxPemYxc0j@mail.gmail.com>
References: <AANLkTim0a0NEkMuRu1ND=Wuyu5j897NeXKRxPemYxc0j@mail.gmail.com>
Message-ID: <2FECBA36D6EF8645A9D736633F186F815EFD7B12C7@foedmail02n>


________________________________________
From: r-sig-geo-bounces at stat.math.ethz.ch [r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of Peter Larson [pslarson2 at gmail.com]
Sent: Saturday, 30 October 2010 8:28 a.m.
To: r-sig-geo at stat.math.ethz.ch
Subject: [R-sig-Geo] convert from spatstat to sp

Hello all,

Is there any way to convert from spatstat to sp?

Specifically, I am looking to clip a density plot produced in spatstat
to include only points within a polygon boundary in a shapefile. if
there is a way to clip in spatstat, this would also be acceptable.

Clipping in spatstat is done simply using [] --- let X be your density plot (image; object of class "im")
and let W be an object of class owin determined by the polygonal boundary that you have in mind.

Just do

    Y <- X[W]

to get X clipped to the window W.  To find out how to make ``a polygon boundary in a shapefile'' into
a window, see the vignette on handling shapefiles in spatstat:

    vignette("shapefiles")

        cheers,

              Rolf Turner

From mspinola10 at gmail.com  Sat Oct 30 01:18:40 2010
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Fri, 29 Oct 2010 17:18:40 -0600
Subject: [R-sig-Geo] How to make a raster from a shapefile
Message-ID: <AANLkTimZVN=fk1_mtkeJ+hhREzLu4fMG6fjOTeSZmQ+s@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101029/21cf3e1e/attachment.pl>

From r.hijmans at gmail.com  Sat Oct 30 01:54:53 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Fri, 29 Oct 2010 16:54:53 -0700
Subject: [R-sig-Geo] How to make a raster from a shapefile
In-Reply-To: <AANLkTimZVN=fk1_mtkeJ+hhREzLu4fMG6fjOTeSZmQ+s@mail.gmail.com>
References: <AANLkTimZVN=fk1_mtkeJ+hhREzLu4fMG6fjOTeSZmQ+s@mail.gmail.com>
Message-ID: <AANLkTim89tv=pyR+Q2DTCVmUiO1nsGTFignQM23Nn7s=@mail.gmail.com>

Manuel,

You can use overlay methods in sp or, in raster, one of:
linesToRaster, polygonsToRaster, or pointsToRaster.

This:

cob = raster(cobertura)

returns an 'empty' raster with the same extent as cobertura.

Robert


On Fri, Oct 29, 2010 at 4:18 PM, Manuel Sp?nola <mspinola10 at gmail.com> wrote:
> Dear list members,
>
> How I make a raster file from a shapefile?
>
> I tried this, but I don't think is right. ?Also, I lost the projection in
> the raster "cob", why?
>
>> cob = raster(cobertura) # cobertura is a shapefile
>> plot(cob)
> Error en .plotraster(x, col = col, maxpixels = maxpixels, ...) :
> ?no values associated with this RasterLayer
>
> Best,
>
> Manuel
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From edzer.pebesma at uni-muenster.de  Sat Oct 30 12:24:55 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sat, 30 Oct 2010 12:24:55 +0200
Subject: [R-sig-Geo] convert from spatstat to sp;
	RFC about generic behaviour
In-Reply-To: <2FECBA36D6EF8645A9D736633F186F815EFD7B12C7@foedmail02n>
References: <AANLkTim0a0NEkMuRu1ND=Wuyu5j897NeXKRxPemYxc0j@mail.gmail.com>
	<2FECBA36D6EF8645A9D736633F186F815EFD7B12C7@foedmail02n>
Message-ID: <4CCBF277.4060502@uni-muenster.de>

I like that solution; it seems intuitive, and as this seems to be a FAQ,
I would like to copy this behaviour to sp classes, such that

obj[geom,] # in case there are attribute data in obj, or

obj[geom] # in case obj has only geometry

return the items in obj that are within the geometry of geom. This would
liberate us from selecting the non-NA indexes returned from overlay (or
in case of a grid, assign NA to everything outside).

A problem occurs when obj is pixels or a grid (or raster or im), and
geom lines or polygons, I can see two difficult cases:

- the grid cell centre does not, but part of the grid cell does overlap
with geom or cross geom,
- the grid cell touches geom, but does not overlap / cross.

Robert, how does raster deal with these two cases? Does it have fixed
behaviour, or can the user choose?

Rolf, how does spatstat deal with these two cases?

On 10/30/2010 12:23 AM, Turner Rolf wrote:
> 
> ________________________________________
> From: r-sig-geo-bounces at stat.math.ethz.ch [r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of Peter Larson [pslarson2 at gmail.com]
> Sent: Saturday, 30 October 2010 8:28 a.m.
> To: r-sig-geo at stat.math.ethz.ch
> Subject: [R-sig-Geo] convert from spatstat to sp
> 
> Hello all,
> 
> Is there any way to convert from spatstat to sp?
> 
> Specifically, I am looking to clip a density plot produced in spatstat
> to include only points within a polygon boundary in a shapefile. if
> there is a way to clip in spatstat, this would also be acceptable.
> 
> Clipping in spatstat is done simply using [] --- let X be your density plot (image; object of class "im")
> and let W be an object of class owin determined by the polygonal boundary that you have in mind.
> 
> Just do
> 
>     Y <- X[W]
> 
> to get X clipped to the window W.  To find out how to make ``a polygon boundary in a shapefile'' into
> a window, see the vignette on handling shapefiles in spatstat:
> 
>     vignette("shapefiles")
> 
>         cheers,
> 
>               Rolf Turner
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From mspinola10 at gmail.com  Sat Oct 30 12:57:43 2010
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Sat, 30 Oct 2010 04:57:43 -0600
Subject: [R-sig-Geo] How to make a raster from a shapefile
In-Reply-To: <AANLkTim89tv=pyR+Q2DTCVmUiO1nsGTFignQM23Nn7s=@mail.gmail.com>
References: <AANLkTimZVN=fk1_mtkeJ+hhREzLu4fMG6fjOTeSZmQ+s@mail.gmail.com>
	<AANLkTim89tv=pyR+Q2DTCVmUiO1nsGTFignQM23Nn7s=@mail.gmail.com>
Message-ID: <4CCBFA27.5090002@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101030/36621f44/attachment.pl>

From mspinola10 at gmail.com  Sat Oct 30 13:11:18 2010
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Sat, 30 Oct 2010 05:11:18 -0600
Subject: [R-sig-Geo] How to make a raster from a shapefile
In-Reply-To: <AANLkTim89tv=pyR+Q2DTCVmUiO1nsGTFignQM23Nn7s=@mail.gmail.com>
References: <AANLkTimZVN=fk1_mtkeJ+hhREzLu4fMG6fjOTeSZmQ+s@mail.gmail.com>
	<AANLkTim89tv=pyR+Q2DTCVmUiO1nsGTFignQM23Nn7s=@mail.gmail.com>
Message-ID: <4CCBFD56.4070507@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101030/734497ba/attachment.pl>

From mspinola10 at gmail.com  Sun Oct 31 02:08:08 2010
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Sat, 30 Oct 2010 18:08:08 -0600
Subject: [R-sig-Geo] Help with polygonsToRaster
Message-ID: <4CCCB368.5010309@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101030/5447cbe1/attachment.pl>

From r.hijmans at gmail.com  Sun Oct 31 02:39:51 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sat, 30 Oct 2010 17:39:51 -0700
Subject: [R-sig-Geo] convert from spatstat to sp;
	RFC about generic behaviour
In-Reply-To: <4CCBF277.4060502@uni-muenster.de>
References: <AANLkTim0a0NEkMuRu1ND=Wuyu5j897NeXKRxPemYxc0j@mail.gmail.com>
	<2FECBA36D6EF8645A9D736633F186F815EFD7B12C7@foedmail02n>
	<4CCBF277.4060502@uni-muenster.de>
Message-ID: <AANLkTin-DvmpWtMTTWCQj57gtLWthBMqJ0QTsv3fn4wG@mail.gmail.com>

Dear Edzer,

In raster the default approach for extracting raster values with
polygons is that a polygon has to cover the center of a cell, for the
cell to be included. However, you can use argument "weights=TRUE" in
which case you get, apart from the cell values, the percentage of each
cell that is covered by the polygon, so that you can apply, e.g., a
50% area covered threshold, or compute an area-weighted average.

In the case of lines, any cell that is crossed by a line is included.
For lines and points, a cell that is only 'touched' is included when
it is below or to the right (or both) of the line segment/point
(except for the bottom row and right most column).

I agree that this is very elegant ( I do not find it very intuitive,
but that might change when I get used to it! ) For its elegance I have
added it to raster (v 1.6-9) ( also in the spirit of, where possible,
trying to have similar approaches in spatial packages that Jeremy
recently called for
http://www.mail-archive.com/r-sig-geo at stat.math.ethz.ch/msg09015.html
). I have also added raster[polygons] <- value  , a wrapper around
polygonsToRaster(raster, value, update=TRUE) )

Robert



On Sat, Oct 30, 2010 at 3:24 AM, Edzer Pebesma
<edzer.pebesma at uni-muenster.de> wrote:
> I like that solution; it seems intuitive, and as this seems to be a FAQ,
> I would like to copy this behaviour to sp classes, such that
>
> obj[geom,] # in case there are attribute data in obj, or
>
> obj[geom] # in case obj has only geometry
>
> return the items in obj that are within the geometry of geom. This would
> liberate us from selecting the non-NA indexes returned from overlay (or
> in case of a grid, assign NA to everything outside).
>
> A problem occurs when obj is pixels or a grid (or raster or im), and
> geom lines or polygons, I can see two difficult cases:
>
> - the grid cell centre does not, but part of the grid cell does overlap
> with geom or cross geom,
> - the grid cell touches geom, but does not overlap / cross.
>
> Robert, how does raster deal with these two cases? Does it have fixed
> behaviour, or can the user choose?
>
> Rolf, how does spatstat deal with these two cases?
>
> On 10/30/2010 12:23 AM, Turner Rolf wrote:
>>
>> ________________________________________
>> From: r-sig-geo-bounces at stat.math.ethz.ch [r-sig-geo-bounces at stat.math.ethz.ch] On Behalf Of Peter Larson [pslarson2 at gmail.com]
>> Sent: Saturday, 30 October 2010 8:28 a.m.
>> To: r-sig-geo at stat.math.ethz.ch
>> Subject: [R-sig-Geo] convert from spatstat to sp
>>
>> Hello all,
>>
>> Is there any way to convert from spatstat to sp?
>>
>> Specifically, I am looking to clip a density plot produced in spatstat
>> to include only points within a polygon boundary in a shapefile. if
>> there is a way to clip in spatstat, this would also be acceptable.
>>
>> Clipping in spatstat is done simply using [] --- let X be your density plot (image; object of class "im")
>> and let W be an object of class owin determined by the polygonal boundary that you have in mind.
>>
>> Just do
>>
>> ? ? Y <- X[W]
>>
>> to get X clipped to the window W. ?To find out how to make ``a polygon boundary in a shapefile'' into
>> a window, see the vignette on handling shapefiles in spatstat:
>>
>> ? ? vignette("shapefiles")
>>
>> ? ? ? ? cheers,
>>
>> ? ? ? ? ? ? ? Rolf Turner
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> --
> Edzer Pebesma
> Institute for Geoinformatics (ifgi), University of M?nster
> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
> 8333081, Fax: +49 251 8339763 ?http://ifgi.uni-muenster.de
> http://www.52north.org/geostatistics ? ? ?e.pebesma at wwu.de
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From roman.lustrik at gmail.com  Sun Oct 31 07:33:33 2010
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Sun, 31 Oct 2010 07:33:33 +0100
Subject: [R-sig-Geo] Help with polygonsToRaster
In-Reply-To: <4CCCB368.5010309@gmail.com>
References: <4CCCB368.5010309@gmail.com>
Message-ID: <AANLkTinNKEyZduRo5La4CCjJAuf9oPay7qmN-iCtgpuc@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101031/9712c61e/attachment.pl>

From alexandru.dumitrescu at gmail.com  Sun Oct 31 09:24:10 2010
From: alexandru.dumitrescu at gmail.com (Alexandru Dumitrescu)
Date: Sun, 31 Oct 2010 10:24:10 +0200
Subject: [R-sig-Geo] "sp.text" background
Message-ID: <AANLkTim1wbw8U=t6sdweihRQmzFHriX+h1t7D=gKrtok@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101031/75234c2d/attachment.pl>

From valerio.bartolino at uniroma1.it  Sun Oct 31 11:21:53 2010
From: valerio.bartolino at uniroma1.it (valerio.bartolino at uniroma1.it)
Date: Sun, 31 Oct 2010 11:21:53 +0100
Subject: [R-sig-Geo] corSpatial and zero distance
Message-ID: <OFD186C275.2C397297-ONC12577CD.0038EF6D-C12577CD.0038EF72@Uniroma1.it>

Dear list,
it is probably a very simple question with an obvious answer, that unfortunately I cannot find by myself.

Why I cannot fit a spatial correlation structure model if I've some observations in the same location? Shouldn't the nugget account exactly for this small-scale variability and measurement errors?

I'm using one of the correlation models in the generic function 'lme' (package:nlme)

Thank you

Valerio

-- 
Valerio Bartolino, PhD

Institute of Marine Research - Swedish Board of Fisheries
PO Box 4, 45321 Lysekil, Sweden

Department of Earth Sciences - Gothenburg University
PO Box 460, 40530 G?teborg, Sweden

e-mail: valerio.bartolino at gvc.gu.se
        valerio.bartolino at gmail.com

><(((*> ----- ><(((*> ----- ><(((*> ----- ><(((*>


From p.hiemstra at geo.uu.nl  Sun Oct 31 11:31:48 2010
From: p.hiemstra at geo.uu.nl (Paul Hiemstra)
Date: Sun, 31 Oct 2010 11:31:48 +0100
Subject: [R-sig-Geo] fix color scale
In-Reply-To: <AANLkTikJuBD3tySpX=dwzo0vKX9NAb0Cz2=SdSn6Jr49@mail.gmail.com>
References: <AANLkTikJuBD3tySpX=dwzo0vKX9NAb0Cz2=SdSn6Jr49@mail.gmail.com>
Message-ID: <4CCD4594.5030400@geo.uu.nl>

Hi Peter,

When creating such a large amount of illustrations with the same 
colorscale, I automatically think of lattice graphics. Under the hood 
spplot also uses lattice graphics. Take a look at the levelplot() 
function from lattice which produces the grid plots for spplot (if I'm 
correct). Alternatively, I've been using ggplot now for quite a while to 
make plots of a lot of grids. A small example says more than a thousand 
words:

library(ggplot2)
library(sp)

data(meuse.grid)
summary(meuse.grid)

# Note that I do not transform meuse.grid to SpatialPixelsDataFrame
# Let's make a simple grid plot
dum = meuse.grid[c("x","y","dist")]
ggplot(aes(x = x, y = y, fill = dist), data = dum) + geom_tile()

# Let's make a few more attributes to the grid
# could be measurements on other dates for example
new_atts = do.call("cbind", lapply(1:100, function(num) dum$dist + 
runif(dum$dist)))
summary(new_atts)
dum = data.frame(cbind(dum, new_atts))

# Important step now is to
# restructure the data
dum_ggplot = melt(dum, id.vars = c("x","y"))

# Now make a plot using dum_ggplot
# of 'x' and 'y' using value as a 'fill'
# with a plot per 'variable', can take a minute to plot
ggplot(aes(x = x, y = y, fill = value), data = dum_ggplot) + geom_tile() 
+ facet_wrap(~variable) +
       scale_x_continuous('', labels = NA, breaks = NA) +
       scale_y_continuous('', labels = NA, breaks = NA) + 
opts(aspect.ratio = 1)
# These last two lines get rid of the labels on the axes and set aspect 
ratio to 1

Now you have a plot with 101 maps with the same colorscale, with ggplot 
doing all the hard work. It takes some time to get the hang of ggplot, 
but I think it is worth the investment, also for spatial plots.

cheers and hope this helps,
Paul

On 10/28/2010 09:12 PM, Peter Larson wrote:
> Hello!
>
> I have a problem.
>
> I am using IDW to interpolate a daily series of geospatial
> observations. Thus, I want to produce a large number of sequential
> maps.
>
> I want them to all represent the same color scale. Is there any way to
> fix the color scale so that it is the same for all the plots?
>
> Thanks,
>
> Pete
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>    


-- 
Drs. Paul Hiemstra
Department of Physical Geography
Faculty of Geosciences
University of Utrecht
Heidelberglaan 2
P.O. Box 80.115
3508 TC Utrecht
Phone:  +3130 253 5773
http://intamap.geo.uu.nl/~paul
http://nl.linkedin.com/pub/paul-hiemstra/20/30b/770


From edzer.pebesma at uni-muenster.de  Sun Oct 31 11:33:47 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sun, 31 Oct 2010 11:33:47 +0100
Subject: [R-sig-Geo] corSpatial and zero distance
In-Reply-To: <OFD186C275.2C397297-ONC12577CD.0038EF6D-C12577CD.0038EF72@Uniroma1.it>
References: <OFD186C275.2C397297-ONC12577CD.0038EF6D-C12577CD.0038EF72@Uniroma1.it>
Message-ID: <4CCD460B.8090108@uni-muenster.de>

lme fits using (restricted) maximum likelihood, and that requires a
covariance/correlation matrix that is non-singular, to be inverted each
iteration.

Under spatial correlation models, even the pure nugget model,
observations with identical location are perfectly correlated (as in:
the correlation of X with itself), and so result in duplicate rows/cols,
making the covariance/correlation matrix singular.

On 10/31/2010 11:21 AM, valerio.bartolino at uniroma1.it wrote:
> Dear list,
> it is probably a very simple question with an obvious answer, that unfortunately I cannot find by myself.
> 
> Why I cannot fit a spatial correlation structure model if I've some observations in the same location? Shouldn't the nugget account exactly for this small-scale variability and measurement errors?
> 
> I'm using one of the correlation models in the generic function 'lme' (package:nlme)
> 
> Thank you
> 
> Valerio
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From southandy at gmail.com  Sun Oct 31 13:41:53 2010
From: southandy at gmail.com (andy south)
Date: Sun, 31 Oct 2010 12:41:53 +0000
Subject: [R-sig-Geo] same colour scale,
	problem with image(spatialGridDataFrame)
Message-ID: <AANLkTin-Mi4n2e7=3ySByQzquFmJdAW+P36v629MOQ22@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101031/f8b35804/attachment.pl>

From southandy at gmail.com  Sun Oct 31 14:13:38 2010
From: southandy at gmail.com (andy south)
Date: Sun, 31 Oct 2010 13:13:38 +0000
Subject: [R-sig-Geo] same colour scale,
	problem with image(spatialGridDataFrame)
Message-ID: <AANLkTinU3joDPuVHinB+tfvbTvuBLDX1EgJ03HPT_HD+@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20101031/9698fbee/attachment.pl>

From edzer.pebesma at uni-muenster.de  Sun Oct 31 14:40:10 2010
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sun, 31 Oct 2010 14:40:10 +0100
Subject: [R-sig-Geo] same colour scale,
	problem with image(spatialGridDataFrame)
In-Reply-To: <AANLkTinU3joDPuVHinB+tfvbTvuBLDX1EgJ03HPT_HD+@mail.gmail.com>
References: <AANLkTinU3joDPuVHinB+tfvbTvuBLDX1EgJ03HPT_HD+@mail.gmail.com>
Message-ID: <4CCD71BA.1040609@uni-muenster.de>

The reason is that it is being "absorbed" by the ... in the argument
list, and then gets passed on both to plot (to set up the plotting
region, aspect ration, axes etc) and to image. The first however doesn't
understand this, hence the warning. This doesn't look hard to solve,
it's basically a bit sloppy / lazy programming.

On 10/31/2010 02:13 PM, andy south wrote:
> Apologies, having just updated sp from version 0.9-66, 2010-07-07, (I know I
> should have done that before posting) it seems that the main problem has
> been fixed, but image(spatialGridDataFrame,breaks=) does still seem to
> generate the warning 'breaks' is not a valid graphical parameter.
> 
> Thanks,
> Andy
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From pslarson2 at gmail.com  Sun Oct 31 19:38:30 2010
From: pslarson2 at gmail.com (Peter Larson)
Date: Sun, 31 Oct 2010 14:38:30 -0400
Subject: [R-sig-Geo] distance to polygon (and line_
In-Reply-To: <4CCD71BA.1040609@uni-muenster.de>
References: <AANLkTinU3joDPuVHinB+tfvbTvuBLDX1EgJ03HPT_HD+@mail.gmail.com>
	<4CCD71BA.1040609@uni-muenster.de>
Message-ID: <4CCDB7A6.8080708@gmail.com>

Hello all,

I have a database of point (lat long) data.
I also have shapefiles of polygon and line data.

I need to find the distances from each of the points to 1) the nearest 
polygon and 2) the nearest line.

Is this possible?

Thanks,

Pete


From r.turner at auckland.ac.nz  Sun Oct 31 21:29:41 2010
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Mon, 1 Nov 2010 09:29:41 +1300
Subject: [R-sig-Geo] distance to polygon (and line_
In-Reply-To: <4CCDB7A6.8080708@gmail.com>
References: <AANLkTinU3joDPuVHinB+tfvbTvuBLDX1EgJ03HPT_HD+@mail.gmail.com>
	<4CCD71BA.1040609@uni-muenster.de> <4CCDB7A6.8080708@gmail.com>
Message-ID: <89A84F9C-9390-451C-A252-EA80C3216E2A@auckland.ac.nz>


On 1/11/2010, at 7:38 AM, Peter Larson wrote:

> Hello all,
> 
> I have a database of point (lat long) data.
> I also have shapefiles of polygon and line data.
> 
> I need to find the distances from each of the points to 1) the nearest 
> polygon and 2) the nearest line.
> 
> Is this possible?


In R all things are possible.

You may have problems with units; the units in which your points are expressed
must be the same as those in which the lines and polygons are expressed.

If you can express everything in terms of two dimensional Euclidean units,
then the facilities of spatstat will allow you to do what you want.  Currently
spatstat does not handle great circle distances.

If you express your collection of polygons as a single owin object, say "xxx", then
distfun(xxx)(x,y) will give the distances from to xxx.  These will be the
minima of the distances from the points to the individual polygons.

Likewise if you express your collection of lines as a psp object, say "lll",
then distfun(lll)(x,y) will the distance from each point to the nearest line.

In the foregoing "x" represents the vector of x-coordinates of your points,
and y the vector of y-coordinates.

See

	vignette("shapefiles")

for instructions on how to turn shapefile data into spatstat style objects.

	cheers,

		Rolf

From r.hijmans at gmail.com  Sun Oct 31 22:06:33 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sun, 31 Oct 2010 14:06:33 -0700
Subject: [R-sig-Geo] distance to polygon (and line_
In-Reply-To: <89A84F9C-9390-451C-A252-EA80C3216E2A@auckland.ac.nz>
References: <AANLkTinU3joDPuVHinB+tfvbTvuBLDX1EgJ03HPT_HD+@mail.gmail.com>
	<4CCD71BA.1040609@uni-muenster.de> <4CCDB7A6.8080708@gmail.com>
	<89A84F9C-9390-451C-A252-EA80C3216E2A@auckland.ac.nz>
Message-ID: <AANLkTim_XmcSvWZSuHjt3ozCZkOYge2irvD7LiW2onic@mail.gmail.com>

But if you would like to do this using longitude/latitude data, you
could try dist2Lines in 'geosphere'

library(geosphere)
dist2Line(points, SpatialPolygons)

(this function ONLY works for lon/lat, and NOT for a flat earth
coordinate system)

Robert

On Sun, Oct 31, 2010 at 1:29 PM, Rolf Turner <r.turner at auckland.ac.nz> wrote:
>
> On 1/11/2010, at 7:38 AM, Peter Larson wrote:
>
>> Hello all,
>>
>> I have a database of point (lat long) data.
>> I also have shapefiles of polygon and line data.
>>
>> I need to find the distances from each of the points to 1) the nearest
>> polygon and 2) the nearest line.
>>
>> Is this possible?
>
>
> In R all things are possible.
>
> You may have problems with units; the units in which your points are expressed
> must be the same as those in which the lines and polygons are expressed.
>
> If you can express everything in terms of two dimensional Euclidean units,
> then the facilities of spatstat will allow you to do what you want. ?Currently
> spatstat does not handle great circle distances.
>
> If you express your collection of polygons as a single owin object, say "xxx", then
> distfun(xxx)(x,y) will give the distances from to xxx. ?These will be the
> minima of the distances from the points to the individual polygons.
>
> Likewise if you express your collection of lines as a psp object, say "lll",
> then distfun(lll)(x,y) will the distance from each point to the nearest line.
>
> In the foregoing "x" represents the vector of x-coordinates of your points,
> and y the vector of y-coordinates.
>
> See
>
> ? ? ? ?vignette("shapefiles")
>
> for instructions on how to turn shapefile data into spatstat style objects.
>
> ? ? ? ?cheers,
>
> ? ? ? ? ? ? ? ?Rolf
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at stat.math.ethz.ch
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From pslarson2 at gmail.com  Sun Oct 31 22:33:31 2010
From: pslarson2 at gmail.com (Peter Larson)
Date: Sun, 31 Oct 2010 17:33:31 -0400
Subject: [R-sig-Geo] distance to polygon (and line_
In-Reply-To: <AANLkTim_XmcSvWZSuHjt3ozCZkOYge2irvD7LiW2onic@mail.gmail.com>
References: <AANLkTinU3joDPuVHinB+tfvbTvuBLDX1EgJ03HPT_HD+@mail.gmail.com>	<4CCD71BA.1040609@uni-muenster.de>	<4CCDB7A6.8080708@gmail.com>	<89A84F9C-9390-451C-A252-EA80C3216E2A@auckland.ac.nz>
	<AANLkTim_XmcSvWZSuHjt3ozCZkOYge2irvD7LiW2onic@mail.gmail.com>
Message-ID: <4CCDE0AB.2050904@gmail.com>

OK! That works for the polygons.

Thank you for your help,

Pete



On 2010/10/31 17:06, Robert J. Hijmans wrote:
> But if you would like to do this using longitude/latitude data, you
> could try dist2Lines in 'geosphere'
>
> library(geosphere)
> dist2Line(points, SpatialPolygons)
>
> (this function ONLY works for lon/lat, and NOT for a flat earth
> coordinate system)
>
> Robert
>
> On Sun, Oct 31, 2010 at 1:29 PM, Rolf Turner<r.turner at auckland.ac.nz>  wrote:
>> On 1/11/2010, at 7:38 AM, Peter Larson wrote:
>>
>>> Hello all,
>>>
>>> I have a database of point (lat long) data.
>>> I also have shapefiles of polygon and line data.
>>>
>>> I need to find the distances from each of the points to 1) the nearest
>>> polygon and 2) the nearest line.
>>>
>>> Is this possible?
>>
>> In R all things are possible.
>>
>> You may have problems with units; the units in which your points are expressed
>> must be the same as those in which the lines and polygons are expressed.
>>
>> If you can express everything in terms of two dimensional Euclidean units,
>> then the facilities of spatstat will allow you to do what you want.  Currently
>> spatstat does not handle great circle distances.
>>
>> If you express your collection of polygons as a single owin object, say "xxx", then
>> distfun(xxx)(x,y) will give the distances from to xxx.  These will be the
>> minima of the distances from the points to the individual polygons.
>>
>> Likewise if you express your collection of lines as a psp object, say "lll",
>> then distfun(lll)(x,y) will the distance from each point to the nearest line.
>>
>> In the foregoing "x" represents the vector of x-coordinates of your points,
>> and y the vector of y-coordinates.
>>
>> See
>>
>>         vignette("shapefiles")
>>
>> for instructions on how to turn shapefile data into spatstat style objects.
>>
>>         cheers,
>>
>>                 Rolf
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at stat.math.ethz.ch
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>


From pslarson2 at gmail.com  Sun Oct 31 22:34:34 2010
From: pslarson2 at gmail.com (Peter Larson)
Date: Sun, 31 Oct 2010 17:34:34 -0400
Subject: [R-sig-Geo] Open grd files in R
In-Reply-To: <AANLkTim_XmcSvWZSuHjt3ozCZkOYge2irvD7LiW2onic@mail.gmail.com>
References: <AANLkTinU3joDPuVHinB+tfvbTvuBLDX1EgJ03HPT_HD+@mail.gmail.com>	<4CCD71BA.1040609@uni-muenster.de>	<4CCDB7A6.8080708@gmail.com>	<89A84F9C-9390-451C-A252-EA80C3216E2A@auckland.ac.nz>
	<AANLkTim_XmcSvWZSuHjt3ozCZkOYge2irvD7LiW2onic@mail.gmail.com>
Message-ID: <4CCDE0EA.6050106@gmail.com>

Hello again,

Next question. Does anyone know how to open grd files in R? Or how to 
convert them into ascii? I find some info, but what I find doesn't work 
for me, or requires that I buy something.

Any ideas?

Pete


From pslarson2 at gmail.com  Sun Oct 31 22:42:15 2010
From: pslarson2 at gmail.com (Peter Larson)
Date: Sun, 31 Oct 2010 17:42:15 -0400
Subject: [R-sig-Geo] grd files PROBLEM SOLVED
In-Reply-To: <AANLkTim_XmcSvWZSuHjt3ozCZkOYge2irvD7LiW2onic@mail.gmail.com>
References: <AANLkTinU3joDPuVHinB+tfvbTvuBLDX1EgJ03HPT_HD+@mail.gmail.com>	<4CCD71BA.1040609@uni-muenster.de>	<4CCDB7A6.8080708@gmail.com>	<89A84F9C-9390-451C-A252-EA80C3216E2A@auckland.ac.nz>
	<AANLkTim_XmcSvWZSuHjt3ozCZkOYge2irvD7LiW2onic@mail.gmail.com>
Message-ID: <4CCDE2B7.4060002@gmail.com>

Hello,

grd file problem solved.

I used DIVA to convert the file to an ASCII.

Thanks,

Pete


From r.hijmans at gmail.com  Sun Oct 31 23:23:54 2010
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sun, 31 Oct 2010 15:23:54 -0700
Subject: [R-sig-Geo] grd files PROBLEM SOLVED
In-Reply-To: <4CCDE2B7.4060002@gmail.com>
References: <AANLkTinU3joDPuVHinB+tfvbTvuBLDX1EgJ03HPT_HD+@mail.gmail.com>
	<4CCD71BA.1040609@uni-muenster.de> <4CCDB7A6.8080708@gmail.com>
	<89A84F9C-9390-451C-A252-EA80C3216E2A@auckland.ac.nz>
	<AANLkTim_XmcSvWZSuHjt3ozCZkOYge2irvD7LiW2onic@mail.gmail.com>
	<4CCDE2B7.4060002@gmail.com>
Message-ID: <AANLkTinVexX32TT2ykwLYFgioRBx6NQPn0kd6Y_zGhCf@mail.gmail.com>

Perhaps easier to access them in R:

library(raster)
r <- raster(filename.grd)

and then, e.g.,

plot(r)
spg <- as(r, 'SpatialGridDataFrame')

Robert



On Sun, Oct 31, 2010 at 2:42 PM, Peter Larson <pslarson2 at gmail.com> wrote:
> Hello,
>
> grd file problem solved.
>
> I used DIVA to convert the file to an ASCII.
>
> Thanks,
>
> Pete
>
>
>


From David.Clifford at csiro.au  Sun Oct 31 23:41:29 2010
From: David.Clifford at csiro.au (David.Clifford at csiro.au)
Date: Mon, 1 Nov 2010 09:41:29 +1100
Subject: [R-sig-Geo] Changing the coordinates of a SpatialGridDataFrame
Message-ID: <27CDE7124B2936429F279F96320D71735EEF0707FC@EXNSW-MBX02.nexus.csiro.au>

Big thanks to all the respondents for their help with my problem last week. Based on their suggestions it seems that the way to solve my problem is to use the following commands:

gp <- gridparameters(obj)
gp <- round(gp,3)
GT <- with(gp, GridTopolopy(cellcentre.offset, cellsize, cells.dim))
obj <- SpatialGridDataFrame(GT, slot(obj,"data"))

kind regards,

David

Dr David Clifford
Research Scientist
CSIRO Division of Mathematics, Informatics and Statistics
Phone: +61 7 3214 2816 |?Fax: +61 7 3214 2855 
David.Clifford at csiro.au?|?www.csiro.au?|?www.csiro.au/people/David.Clifford.html?
Address:?CSIRO Long Pocket Laboratories, 120 Meiers Road, INDOOROOPILLY QLD 4068 
New Postal Address from Nov 2010:?CSIRO, EcoSciences Precinct, PO Box 2583, Brisbane, QLD 4001
New Street Address from Nov 2010:?CSIRO, EcoSciences Precinct, 41 Boggo Road, Annerley, QLD 4103
New Phone from Nov 2010: +61 7 3833 5532
PLEASE NOTE
The information contained in this email may be confidential or privileged. Any unauthorised use or disclosure is prohibited. If you have received this email in error, please delete it immediately and notify?the sender by return email. Thank you. To the extent permitted by law, CSIRO does not represent, warrant and/or guarantee that the integrity of this communication has been maintained or that the communication is free of errors, virus, interception or interference.
Please consider the environment before printing this email.


