From antonio.bubbico at gmail.com  Sun Dec  1 08:08:32 2013
From: antonio.bubbico at gmail.com (Antonio Bubbico)
Date: Sun, 1 Dec 2013 08:08:32 +0100
Subject: [R-sig-Geo] sphet using two Ws in the first equation
In-Reply-To: <alpine.LRH.2.03.1311291958540.17122@reclus.nhh.no>
References: <CABW+3tAk9_6Cva2rXkgux-a2yDZmQtNCCBkD_hAtY_ZYznqzVg@mail.gmail.com>
	<alpine.LRH.2.03.1311291958540.17122@reclus.nhh.no>
Message-ID: <CABW+3tCd-FjsYRb3zDpFAnEMWa=GmKsF1OGLBJbMn+r1t1QM-Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131201/e061a0d8/attachment.pl>

From Roger.Bivand at nhh.no  Sun Dec  1 16:25:37 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sun, 1 Dec 2013 16:25:37 +0100
Subject: [R-sig-Geo] sphet using two Ws in the first equation
In-Reply-To: <CABW+3tCd-FjsYRb3zDpFAnEMWa=GmKsF1OGLBJbMn+r1t1QM-Q@mail.gmail.com>
References: <CABW+3tAk9_6Cva2rXkgux-a2yDZmQtNCCBkD_hAtY_ZYznqzVg@mail.gmail.com>
	<alpine.LRH.2.03.1311291958540.17122@reclus.nhh.no>
	<CABW+3tCd-FjsYRb3zDpFAnEMWa=GmKsF1OGLBJbMn+r1t1QM-Q@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1312011623490.4150@reclus.nhh.no>

On Sun, 1 Dec 2013, Antonio Bubbico wrote:

> Hello,
>
> I am wondering if it is possible to run the following model through
> lagsarlm in spdep package:
>
> y = X \beta + \rho_{1}  W_{1} y + \rho_{2} W_{2} y + u

No, there are no model fitting functions or impacts methods for this case, 
neither GMM nor ML. There are constraints on the coefficients that are not 
well established in the literature.

Roger

>
> Thanks,
>
> Antonio
>
>
>
> 2013/11/29 Roger Bivand <Roger.Bivand at nhh.no>
>
>> On Wed, 27 Nov 2013, Antonio Bubbico wrote:
>>
>>  Hello,
>>>
>>> I would like to run a "generalized spatial two stage least squares" using
>>> the sphet package,
>>> where the model is given by:
>>>
>>> y = X \beta + \rho_{1}  W_{1} y + \rho_{2} W_{2} y + u
>>> u = \lambda W u + \varepsilon
>>>
>>> Actually I don't know how to run that model in R, and obviously the
>>> problem
>>> is the second W in the first equation.
>>>
>>> Do you know if there is possibility to implement the code to run that kind
>>> of model?
>>>
>>
>> This model is not implemented in sphet or elsewhere in R packages as far
>> as I know in any form. A reference to something similar is:
>>
>> http://ideas.repec.org/p/ces/ceswps/_2356.html
>>
>> but you may know this already. The domain of a process of this kind is
>> something which has not been exhaustively studied.
>>
>> Hope this clarifies,
>>
>> Roger
>>
>>
>>> Regards,
>>>
>>> Antonio Bubbico.
>>>
>>>
>>>
>> --
>> Roger Bivand
>> Department of Economics, Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>>
>
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From ROONEYJ4 at tcd.ie  Sun Dec  1 18:05:34 2013
From: ROONEYJ4 at tcd.ie (James Rooney)
Date: Sun, 1 Dec 2013 17:05:34 +0000
Subject: [R-sig-Geo] Resolved -> RE: Help - calling OpenBugs through
 R2OpenBugs problem
In-Reply-To: <75C8D19A1470D344A8AF5312F01160A602BBB78CFE19@GOMAIL.college.tcd.ie>
References: <75C8D19A1470D344A8AF5312F01160A602BBB78CFE16@GOMAIL.college.tcd.ie>
	<75C8D19A1470D344A8AF5312F01160A602BBB78CFE18@GOMAIL.college.tcd.ie>,
	<1385584156.2906.3.camel@virgil-HP-Compaq-8000-Elite-USDT-PC>,
	<75C8D19A1470D344A8AF5312F01160A602BBB78CFE19@GOMAIL.college.tcd.ie>
Message-ID: <75C8D19A1470D344A8AF5312F01160A602BBB78CFE28@GOMAIL.college.tcd.ie>

Dear all,

With thanks to Virgilio, we have resolved this issue. The problem was with my specification of the pathway to the bugs directory. My code was:
BugsDir<-"C:/Program Files (x86)/OpenBUGS/OpenBUGS322/"

.....when I should have had........:
BugsDir<-"C:/Program Files (x86)/OpenBUGS/OpenBUGS322/OpenBugs.exe"

Apparently my original code was enough for R2OpenBugs to not complain about not finding the executable, but not enough for it to run correctly!
Many thanks anyone who attempted to help here. Special thanks to Virgilio for helping me find the problem!

James

________________________________________
From: r-sig-geo-bounces at r-project.org [r-sig-geo-bounces at r-project.org] On Behalf Of James Rooney [ROONEYJ4 at tcd.ie]
Sent: 27 November 2013 21:13
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] Help - calling OpenBugs through R2OpenBugs problem

Dear Virgilio,

Many thanks for taking a look at it!

That  'debug = TRUE' is already set!!!! It doesn't make any difference!!

I'm running R in Windows 7 through Parallels on a Macbook Pro  (OSx Mavericks). I have shut down OsX and booted purely into windows and it doesn't make any difference.
I've experienced this problem under both R 2.15 and R 3.01. It also happens both in R Studio and in the standard R interface. I have Openbugs version 3.2.2. Running latest version of the packages used.

My thinking is that something is crashing OpenBugs when it attempts to open - but I cant' figure out how or why. I wonder is there a file size limit for passing things into OpenBugs ?

Appreciate any help!
James

________________________________________
From: Virgilio G?mez-Rubio [virgilio.gomez at uclm.es]
Sent: 27 November 2013 20:29
To: James Rooney
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] Help - calling OpenBugs through R2OpenBugs problem

Dear James,

I'll be happy to look into this but I will need more information about
your system. Also, could you run the code using 'debug=TRUE' as seen in
the error message?

Best wishes,

Virgilio

On mi?, 2013-11-27 at 20:13 +0000, James Rooney wrote:
> Hi everyone,
>
> Has anyone looked at this problem below ?
> Even if nobody has an answer I'd be keen to know if the problem replicated for others.
>
> Many thanks,
>
> James
>
> ________________________________________
> From: r-sig-geo-bounces at r-project.org [r-sig-geo-bounces at r-project.org] On Behalf Of James Rooney [ROONEYJ4 at tcd.ie]
> Sent: 23 November 2013 16:30
> To: r-sig-geo at r-project.org
> Subject: [R-sig-Geo] Help - caling OpenBugs thourgh R2OpenBugs problem
>
> Hi all,
>
> I am working on a Bayesian spatial smoothing project - and have implemented the BYM model, similar to the description in Chapter 11 of the ASDAR book. However, I have been having a huge problem calling OpenBugs from within R and I cannot figure out why. I would veyr much liek to do this as it would speed up the whole process. I'm stared at this for a omnth or two now to no avail so I'm hoping that somebody might spot a mistake. Basically when I call OpenBugs from R using the bugs command through R2OpenBugs - it throws a non-specific error and tells me to heck the bugs log file. The problem is Bugs does not generate one. This is made all the weirder by the fact that if I manually start up bugs and start it running using the data and inits files gnerated by R2OpenBugs - it runs fine without complaint. This is how I have been working so far. But I want to parallelize Bugs using Snow - so I need R2OpenBugs to work properly. I'm hoping someone here can help!!!
>
> I've made a simulation to recreate the problem. My apologies it is a little complex, but I wanted to use the shapefile I'm actually working with which is freely downloadable for those willing to take a look.
> So here goes.
>
> 1. Go here for the shapefile:
> http://www.cso.ie/en/census/census2011boundaryfiles/
>
> 2. Click on the word "Disclaimer" to access the shapefiles (should you agree with the disclaimer!!). After clicking through the Disclaimer stuff, the file to download is: "Census2011_Electoral_Divisions_generalised20m.zip"
>
> 3. Set up a directory for this and save the shapefiles there.
>
> 4. You will need a bugs model. Cut and paste the below into a txt file and save it to your directory under the name "spatial_CAR.txt"
>
> model
> {
>
>   for(i in 1:N)
>   {
>     observed[i]~dpois(mu[i])
>     log(theta[i])<-alpha + u[i] + v[i]
>     mu[i]<-expected[i]*theta[i]
>     u[i] ~dnorm(0,tau)
>   }
>
> v[1:N]~car.normal(adj[],weights[],num[],precv)
>
>   alpha ~dflat()
>   tau ~dgamma(0.001,0.001)
>   precv ~dgamma(0.1,0.1)
> }
>
> 5. Now open R and paste in the R code below. Remember to set your working directory to the same directory you saved the shapefiles and bugs model into. Also you might need to modify the path to OpenBugs on your machine.
>
> 6. Run the code. For me the final line throws the error:
> "Error in bugs.run(n.burnin, OpenBUGS.pgm, debug = debug, WINE = WINE,  :
>   Look at the log file in  C:......<SNIP>................./R2OpenBugs Simulation  and
> try again with 'debug=TRUE' to figure out what went wrong within OpenBUGS."
>
> I cannot figure out why!!! The log file does not exist!! If you manually open bugs and use the data and init files it works. Why ? No idea!!!!
> Any and all help much appreciated!!!
> Apologies for the length of this!!
>
> James
>
>
> R Code:
>
> library(rgdal)
> library(spdep)
> library(R2OpenBUGS)
>
> setwd("....your working directory here......")
>
> #Read in Spatial Polygon Data Frame
> SPolyDF<-readOGR(".","Census2011_Electoral_Divisions_generalised20m",TRUE)
>
> # Detect neighbours
> nb<-poly2nb(SPolyDF,queen=T,snap=0.1) # snap at 100m distance
>
> # Create nb weights
> nb.w<-nb2listw(nb,zero.policy=T,style="B")
>
> # Create BUGS CAR weights
> nbBugs<-listw2WB(nb.w)
>
> # Simulate some count data for observed and expected cases
> N<-nrow(SPolyDF)
> SPolyDF$obs<-sample.int(100, N, TRUE)
> SPolyDF$exp<-sample.int(100, N, TRUE)
>
> # Prep Data for OpenBugs
> d<-list(N = N, observed = SPolyDF$obs, expected = SPolyDF$exp, adj=nbBugs$adj, weights=nbBugs$weights, num=nbBugs$num)
>
> # Specify dir where bugs lives
> BugsDir<-"C:/Program Files (x86)/OpenBUGS/OpenBUGS322"
>
> # Define initial values for bugs
> inits<-list(
>    list(u=rep(0,N),v=rep(0,N),alpha=0,tau=0.0001,precv=0.002)
>    ,list(u=rep(0,N),v=rep(0,N),alpha=0.1,tau=0.0002,precv=0.001))
>
> # Define working directory as current directory
> wdir=getwd()
>
> # Openbugs call
> MCMCres<-bugs(data=d,inits=inits,parameters.to.save =c("theta","alpha","tau","precv"),
>               n.iter=1000,model.file="spatial_CAR.txt",n.chains=2,n.burnin=100,n.thin=1,
>               OpenBUGS.pgm=BugsDir,working.directory=wdir,codaPkg=F,debug=T)
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From davbauman at gmail.com  Sun Dec  1 18:27:21 2013
From: davbauman at gmail.com (David Bauman)
Date: Sun, 1 Dec 2013 19:27:21 +0200
Subject: [R-sig-Geo] MEM : Spatial structures detection issues
In-Reply-To: <alpine.LRH.2.03.1311301659190.20544@reclus.nhh.no>
References: <CAGrRo0c_=40zT6zr8s_NrmfYfq+wiqKN3hZp+D0Nx97oaWz_uA@mail.gmail.com>
	<alpine.LRH.2.03.1311301659190.20544@reclus.nhh.no>
Message-ID: <CAGrRo0e0hZgCQnVwDAsGnTxuhW3jAjb7OaPK0Uw=f5jYQNATjg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131201/d3a3f29c/attachment.pl>

From Roger.Bivand at nhh.no  Sun Dec  1 20:53:58 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sun, 1 Dec 2013 20:53:58 +0100
Subject: [R-sig-Geo] MEM : Spatial structures detection issues
In-Reply-To: <CAGrRo0e0hZgCQnVwDAsGnTxuhW3jAjb7OaPK0Uw=f5jYQNATjg@mail.gmail.com>
References: <CAGrRo0c_=40zT6zr8s_NrmfYfq+wiqKN3hZp+D0Nx97oaWz_uA@mail.gmail.com>
	<alpine.LRH.2.03.1311301659190.20544@reclus.nhh.no>
	<CAGrRo0e0hZgCQnVwDAsGnTxuhW3jAjb7OaPK0Uw=f5jYQNATjg@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1312012044450.4821@reclus.nhh.no>

On Sun, 1 Dec 2013, David Bauman wrote:

> My sampled plots are represented by x-y coordinates corresponding to the
> central point of the plots. The euclidean distance matrix is computed from
> this dataframe.
>
> Plot    x    y
> 01a    112.5    12.5
> 02a    112.5    62.5
> 03c    187.5    12.5
> ...
>
> The permanent forest plot is a rectangular area of 200 x 500 m. All this
> area has been divided in 25x25 m plots, from which I sampled 24 more or
> less regularly dispersed over the forest.
>
> What I would like to know is how can I give to R the necessary information
> so that those plots are considered as squared areas of 25x25 m, and not as
> simple points. And when this is done, how do I compute an euclidean
> distance matrix between my 24 plots ?
>
> Which packages/functions allow to do this ?

library(sp)
GT <- GridTopology(c(12.5, 12.5), c(25, 25), c(8, 20))
SG <- SpatialGrid(GT)
bbox(SG) # if the orientation is rotated, reverse the third
# argument to GridTopology()
SPix <- as(SG, "SpatialPixels")
SPol <- as(SPix, "SpatialPolygons")
plot(SPol)
set.seed(1) # emulating your sample
ids <- sample.int(length(SPol), 24)
C_ids <- coordinates(SPol)[ids,] # C_ids are your sample centre points
o <- over(SpatialPoints(C_ids), SPol)
SSPol <- SPol[o]
plot(SSPol, col="yellow", add=TRUE)
text(coordinates(SSPol), label=row.names(SSPol), cex=0.6)
library(rgeos)
GD <- gDistance(SSPol, byid=TRUE) # matrix of distances

gives a matrix of distances between plots.

sp gets most of the way there, finishing with rgeos for distances between 
geometries.

Roger

>
> Thank you
>
>
> 2013/11/30 Roger Bivand <Roger.Bivand at nhh.no>
>
>> On Sat, 30 Nov 2013, David Bauman wrote:
>>
>>  Hi everyone,
>>>
>>> I am facing a problem I really do not know how to resolve about
>>> detecting significant spatial structures in a region I am studying.
>>>
>>> The study is about the Miombo forest (wooded savanna). I am working in
>>> a 10 ha permanent forest plot, where all trees are mapped and
>>> identified. I sampled 24 more or less regulately scattered plots of 25
>>> x 25 m over the 10 ha. In each plot of 25 x 25 m I got 5 soil samples
>>> on which I will measure a battery of variables (the explanatory
>>> variables).
>>> What I want to study is the b?ta-diversity of the ectomycorrhizal
>>> community, so that in each plot I got about 15 pieces of root
>>> containing some ectomycorrhizal fungus on it (response variables).
>>>
>>> My purpose is to explain the spatial variation of the ectomycorrhizal
>>> diversity thanks to the soil variables I will have measured.
>>>
>>> To do so, I want to use a PCNM (or MEM).
>>>
>>> My problem is that :
>>>
>>> All the 24 plots are considered as points, so that the euclidean
>>> distance between them is overestimated. Two adjacent, contiguous,
>>> plots are considered to be 25 m far from each other, while the
>>> distance should be 0, since they "touch" each other.
>>>
>>
>> Well, how are you representing the support of the plots? If you are only
>> providing a central point rather than a polygon, you are getting what you
>> asked for. If you are providing polygon boundaries, but using the
>> coordinates() method to return the central points, the same follows. If tou
>> need distances between polygon objects, use gDistance() in rgeos (if your
>> positional data are projected).
>>
>> It always helps if questioners show their reasoning by including a small
>> example with code, as the problem may result from an unfortunate choice of
>> functions in the workflow. Also always include the output of sessionInfo()
>> as functions may behave differently in different versions of R and packages.
>>
>> Hope this clarifies,
>>
>> Roger
>>
>>  This leads me to the problem that the truncation threshold distance is
>>> to high to allow the RDA of the response dataframe on the spatial PCNM
>>> variables to detect a significant linear link between both matrices
>>> (function anova.cca()).
>>>
>>> So the question is : How can I do so that the area of my plots are
>>> taken into account, and they are not considered as points anymore ?
>>> This would lower the truncation distance and probably allow me to
>>> detect spatial structures that, I really think, do exist.
>>>
>>> I hope someone with some experience and good ideas will be able to help.
>>>
>>> If you want some more concrete information about the study, do not
>>> hesitate to ask it to me.
>>>
>>> Thanks a lot,
>>>
>>> David Bauman
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>> --
>> Roger Bivand
>> Department of Economics, Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From davbauman at gmail.com  Sun Dec  1 22:23:49 2013
From: davbauman at gmail.com (David Bauman)
Date: Sun, 1 Dec 2013 23:23:49 +0200
Subject: [R-sig-Geo] MEM : Spatial structures detection issues
In-Reply-To: <alpine.LRH.2.03.1312012044450.4821@reclus.nhh.no>
References: <CAGrRo0c_=40zT6zr8s_NrmfYfq+wiqKN3hZp+D0Nx97oaWz_uA@mail.gmail.com>
	<alpine.LRH.2.03.1311301659190.20544@reclus.nhh.no>
	<CAGrRo0e0hZgCQnVwDAsGnTxuhW3jAjb7OaPK0Uw=f5jYQNATjg@mail.gmail.com>
	<alpine.LRH.2.03.1312012044450.4821@reclus.nhh.no>
Message-ID: <CAGrRo0dE7QPMK0tAB+889O=0=xOLEDpNnE2_Umh68DV1jK1oSA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131201/93b0ca0e/attachment.pl>

From grothered at gmail.com  Mon Dec  2 03:07:46 2013
From: grothered at gmail.com (GD)
Date: Sun, 1 Dec 2013 18:07:46 -0800 (PST)
Subject: [R-sig-Geo] How extract multiple points from a buffer created
 from the same points?
In-Reply-To: <1385776580237-7585239.post@n2.nabble.com>
References: <1385776580237-7585239.post@n2.nabble.com>
Message-ID: <1385950066361-7585250.post@n2.nabble.com>

I'm not 100% sure what you mean -- but it sounds like could try running
'spDists' on the tree's coordinates, which will return a distance matrix for
the trees (i.e. all pairwise distances). Then for each row, you could find
the indices which are < your distance threshold -- this should tell you the
neighbours of each tree. 



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/How-extract-multiple-points-from-a-buffer-created-from-the-same-points-tp7585239p7585250.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From grothered at gmail.com  Mon Dec  2 06:22:38 2013
From: grothered at gmail.com (GD)
Date: Sun, 1 Dec 2013 21:22:38 -0800 (PST)
Subject: [R-sig-Geo] How extract multiple points from a buffer created
 from the same points?
In-Reply-To: <1385950575049-7585251.post@n2.nabble.com>
References: <1385776580237-7585239.post@n2.nabble.com>
	<1385950066361-7585250.post@n2.nabble.com>
	<1385950575049-7585251.post@n2.nabble.com>
Message-ID: <1385961758668-7585252.post@n2.nabble.com>

 Try this

library(sp)
# Hypothetical point coordinates -- 20 points in total, in a 'unit box'
mycoords=cbind(runif(20),runif(20))
# Chosen distance threshold for 'neighbours'
mythresh=0.2
# Distance matrix
myDists=spDists(mycoords)

# Compute neighbours -- store result in a list
# NOTE: All points have themselves as a neighbour
myNeighbours=list()
for(i in 1:nrow(mycoords)){
    myNeighbours[[i]]=which(myDists[i,]<mythresh)
}

# To get indices of neighbours from e.g. mycoords[5,]
myNeighbours[[5]]





--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/How-extract-multiple-points-from-a-buffer-created-from-the-same-points-tp7585239p7585252.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From etiennebr at gmail.com  Mon Dec  2 20:41:32 2013
From: etiennebr at gmail.com (Etienne B. Racine)
Date: Mon, 2 Dec 2013 14:41:32 -0500
Subject: [R-sig-Geo] Attach metadata to raster object
Message-ID: <CALjAYt7w=7quTkqN=VEpwDE5EiCQafCqtS_3sr3F8EFO1eUsag@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131202/3182ff8f/attachment.pl>

From marceivissa at gmail.com  Tue Dec  3 11:56:07 2013
From: marceivissa at gmail.com (=?ISO-8859-1?Q?Marc_Mar=ED_Dell=27Olmo?=)
Date: Tue, 3 Dec 2013 11:56:07 +0100
Subject: [R-sig-Geo] Problem converting shp ED50 to WGS84 with spTransform
	and writeOGR
Message-ID: <CAAZSCQ7ZxOEHfZeqjYt1b3bWthbj5dUyU5ahrZte-jFu1jeUWw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131203/22849319/attachment.pl>

From Roger.Bivand at nhh.no  Tue Dec  3 12:52:57 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 3 Dec 2013 12:52:57 +0100
Subject: [R-sig-Geo] Problem converting shp ED50 to WGS84 with
 spTransform and writeOGR
In-Reply-To: <CAAZSCQ7ZxOEHfZeqjYt1b3bWthbj5dUyU5ahrZte-jFu1jeUWw@mail.gmail.com>
References: <CAAZSCQ7ZxOEHfZeqjYt1b3bWthbj5dUyU5ahrZte-jFu1jeUWw@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1312031228580.15139@reclus.nhh.no>

On Tue, 3 Dec 2013, Marc Mar? Dell'Olmo wrote:

> Dear all,
>
> I'm trying to convert a map of Barcelona (in shp format) with reference
> ED50 to a kml with Google Maps reference. I have used the following syntax,
> but it creates a slightly displaced map (maybe just a few meters) and do
> not understand why!

When you understand the +datum= and +towgs84= tags, you'll understand. You 
haven't given a datum, and ED50 is not a single standard. You also did not 
quote yout sessionInfo() output, nor the startup messages from loading 
rgdal.

My guess is that you are using Windows, are using an older Windows rgdal 
binary from CRAN with PROJ.4 4.7.*, and have not read:

https://stat.ethz.ch/pipermail/r-sig-geo/2013-November/019884.html

So, guessing further, if you upgrade to the latest Windows rgdal binary 
from CRAN, which has PROJ.4 4.8.*, you will see:

> CRS("+init=epsg:23031")
CRS arguments:
  +init=epsg:23031 +proj=utm +zone=31 +ellps=intl
+towgs84=-87,-98,-121,0,0,0,0 +units=m +no_defs

which gives a three-parameter transformation from the local Spanish 
version of ED50 to WGS84 accepted by EPSG as reasonable.

If you do not give +towgs84= or a known +datum=, or they (one, other, or 
both) are not returned from +init=epsg:*, spTransform assumes that the 
datum is WGS84. The best resource for details on datums (and local 
transformation parameters) is:

http://www.asprs.org/Grids-Datums.html

with Spain July 2000, quoting the three parameters as:

\delta X = ?84m ? 5m, \delta Y = ?107m ? 6m, \delta Z = ?120m ? 3m.

which are not quite the same as the EPSG values, so you could use those or 
values near those for possibly increased accuracy. In any case, using 
+towgs84= with the EPSG values will get you much closer than not using 
+towgs84=.

Hope this clarifies,

Roger


>
>
> setwd("C:/dir")
> barcelona <- readOGR("C:/dir", "Dist_postals_BCN")
> proj4string(barcelona) <- CRS("+proj=utm +zone=31 +ellps=intl +units=m
> +no_defs")
> # Or proj4string(barcelona) <- CRS("+init=epsg:23031")
> x1 <- spTransform(barcelona, CRS("+proj=longlat +datum=WGS84 +no_defs"))
> writeOGR(x1, "districtes.kml", "x1" ,  driver="KML")
>
>
> If you want to try, you can download the ED50 shp map here:
> https://dl.dropboxusercontent.com/u/14934021/map.zip
>
> And here de displaced kml:
> https://dl.dropboxusercontent.com/u/14934021/districtes.kml
>
> Thank you!!
>
> Marc
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From marceivissa at gmail.com  Tue Dec  3 14:33:02 2013
From: marceivissa at gmail.com (=?ISO-8859-1?Q?Marc_Mar=ED_Dell=27Olmo?=)
Date: Tue, 3 Dec 2013 14:33:02 +0100
Subject: [R-sig-Geo] Problem converting shp ED50 to WGS84 with
 spTransform and writeOGR
In-Reply-To: <alpine.LRH.2.03.1312031228580.15139@reclus.nhh.no>
References: <CAAZSCQ7ZxOEHfZeqjYt1b3bWthbj5dUyU5ahrZte-jFu1jeUWw@mail.gmail.com>
	<alpine.LRH.2.03.1312031228580.15139@reclus.nhh.no>
Message-ID: <CAAZSCQ4Tj48EuHZroNBg1ea0yDUmuCY5gaX61N2unxkQhHYsvQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131203/cc649f2b/attachment.pl>

From marceivissa at gmail.com  Tue Dec  3 14:42:32 2013
From: marceivissa at gmail.com (=?ISO-8859-1?Q?Marc_Mar=ED_Dell=27Olmo?=)
Date: Tue, 3 Dec 2013 14:42:32 +0100
Subject: [R-sig-Geo] Problem converting shp ED50 to WGS84 with
 spTransform and writeOGR
In-Reply-To: <alpine.LRH.2.03.1312031228580.15139@reclus.nhh.no>
References: <CAAZSCQ7ZxOEHfZeqjYt1b3bWthbj5dUyU5ahrZte-jFu1jeUWw@mail.gmail.com>
	<alpine.LRH.2.03.1312031228580.15139@reclus.nhh.no>
Message-ID: <CAAZSCQ5MA9atPMizSxpRo0e8KajrSweLboD5Z0VtQ-VF2PM5hg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131203/7a0f9f92/attachment.pl>

From marceivissa at gmail.com  Tue Dec  3 14:48:17 2013
From: marceivissa at gmail.com (=?ISO-8859-1?Q?Marc_Mar=ED_Dell=27Olmo?=)
Date: Tue, 3 Dec 2013 14:48:17 +0100
Subject: [R-sig-Geo] Problem converting shp ED50 to WGS84 with
 spTransform and writeOGR
In-Reply-To: <alpine.LRH.2.03.1312031228580.15139@reclus.nhh.no>
References: <CAAZSCQ7ZxOEHfZeqjYt1b3bWthbj5dUyU5ahrZte-jFu1jeUWw@mail.gmail.com>
	<alpine.LRH.2.03.1312031228580.15139@reclus.nhh.no>
Message-ID: <CAAZSCQ5A-w9sa_Pu+X89PvifQLA2naXAEgvCitnesHeUM--sqg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131203/7e466b26/attachment.pl>

From g.ridhima at gmail.com  Tue Dec  3 18:22:02 2013
From: g.ridhima at gmail.com (Ridhima Gupta)
Date: Tue, 3 Dec 2013 22:52:02 +0530
Subject: [R-sig-Geo] testing for spatial corrrelation in a dynamic panel
	data framework
Message-ID: <CAOrsxwVSpdCs2tM_6Vp1Q1AfvmwtYaJMPUkh5urNi+EhZPaUzg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131203/b0fb3797/attachment.pl>

From joshmobrien at gmail.com  Tue Dec  3 19:57:27 2013
From: joshmobrien at gmail.com (Josh O'Brien)
Date: Tue, 3 Dec 2013 10:57:27 -0800
Subject: [R-sig-Geo] 3rd+ rasters added using "plot(r,
	add=TRUE)" are misregistered
Message-ID: <CAOwKfPQL2_-r1AWxtN03OKrtNOmogr3d3L3S8dA0fdRUzc-JZA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131203/1fd7a57c/attachment.pl>

From jgrn at illinois.edu  Tue Dec  3 21:42:49 2013
From: jgrn at illinois.edu (Jonathan Greenberg)
Date: Tue, 3 Dec 2013 14:42:49 -0600
Subject: [R-sig-Geo] rasterEngine at AGU
Message-ID: <CABG0rfthc_uHXW84KwU1G+bck-=kUdqT_OyL9em6AYWMqG42wg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131203/2cf4110e/attachment.pl>

From ldecola at comcast.net  Wed Dec  4 19:37:02 2013
From: ldecola at comcast.net (ldecola at comcast.net)
Date: Wed, 4 Dec 2013 18:37:02 +0000 (UTC)
Subject: [R-sig-Geo] original coordinates of the redwood data?
In-Reply-To: <52976F24.7060500@gmail.com>
Message-ID: <1334334282.755872.1386182222740.JavaMail.root@sz0206a.westchester.pa.mail.comcast.net>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131204/0dcc03fb/attachment.pl>

From marceivissa at gmail.com  Wed Dec  4 19:37:24 2013
From: marceivissa at gmail.com (=?ISO-8859-1?Q?Marc_Mar=ED_Dell=27Olmo?=)
Date: Wed, 4 Dec 2013 19:37:24 +0100
Subject: [R-sig-Geo] kml choropleth map of quintiles
Message-ID: <CAAZSCQ6SV-itAqZuqYTB7PuhwbH+Ga2nDbWOv2xwoDU_vSpvNw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131204/c3157f6f/attachment.pl>

From marcelino.delacruz at upm.es  Wed Dec  4 21:01:51 2013
From: marcelino.delacruz at upm.es (Marcelino de la Cruz)
Date: Wed, 04 Dec 2013 21:01:51 +0100
Subject: [R-sig-Geo] original coordinates of the redwood data?
In-Reply-To: <1334334282.755872.1386182222740.JavaMail.root@sz0206a.westchester.pa.mail.comcast.net>
References: <1334334282.755872.1386182222740.JavaMail.root@sz0206a.westchester.pa.mail.comcast.net>
Message-ID: <529F8A2F.3090407@upm.es>

You can complaint directly to  to David Strauss for their unscientific 
behaviour. :-p

As ?redwoodfull says:

"The dataset redwoodfull contains the full point pattern of 195 trees. 
The window has been rescaled to the unit square. Its physical size is 
approximately 130 feet across.
...
The plot of the data published by Strauss (1975) was scanned and 
digitised by Sandra Pereira, University of Western Australia, 2002."


So you can digitize yourself the original true coordinates  from the 
plot in Strauss (1975).

Cheers,

Marcelino


El 04/12/2013 19:37, ldecola at comcast.net escribi?:
>
> does anyone know the original, true coordinates of the spatstat redwoodfull data? i can't find them in:
>
> Strauss, D. J. (1975). "A Model for Clustering." Biometrika 62(2): 467-475.
>
> i think reporting spatial data in rescaled units is unscientific.
>
>
> Lee De Cola, PhD, MCP.
> DATA to Insight
> LDECOLA at COMCAST.NET
> Reston, Virginia
> 703 709 6972
> 571 315 0577 mobile
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From ldecola at comcast.net  Wed Dec  4 21:39:56 2013
From: ldecola at comcast.net (ldecola at comcast.net)
Date: Wed, 4 Dec 2013 20:39:56 +0000 (UTC)
Subject: [R-sig-Geo] original coordinates of the redwood data?
In-Reply-To: <529F8A2F.3090407@upm.es>
Message-ID: <274993466.758635.1386189596629.JavaMail.root@sz0206a.westchester.pa.mail.comcast.net>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131204/1e1effbb/attachment.pl>

From r.turner at auckland.ac.nz  Wed Dec  4 22:51:14 2013
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Thu, 05 Dec 2013 10:51:14 +1300
Subject: [R-sig-Geo] original coordinates of the redwood data?
In-Reply-To: <529F8A2F.3090407@upm.es>
References: <1334334282.755872.1386182222740.JavaMail.root@sz0206a.westchester.pa.mail.comcast.net>
	<529F8A2F.3090407@upm.es>
Message-ID: <529FA3D2.1010300@auckland.ac.nz>


Some years ago I noticed that Strauss's seminal paper in Biometrika 
(vol. 62, No. 2,
1975, pp. 467 - 475) states that there are n = 77 points in region I.   
(See page 474,
just below Figure 1.) However if one looks at the region I pattern in 
spatstat, e.g.:

     X <- with(redwoodfull.extra, redwoodfull[regionI])
     npoints(X)

one gets n = 71.  A careful count of the points in Region I in Strauss's 
Figure 1 (page 474)
also gives  n = 71.  A possible explanation for this anomaly is that 
there are
hidden points in Strauss's Figure 1.  These points would of necessity 
lie very close to
points that we "know about" which fact would inflate the number of 
r-close pairs, for
any value of r used in any modelling exercise.

It would be kind of nice to find out what is *really* going on, but I 
expect that the
original data are sadly lost in the mists of time.

     cheers,

     Rolf Turner


On 12/05/13 09:01, Marcelino de la Cruz wrote:
> You can complaint directly to  to David Strauss for their unscientific 
> behaviour. :-p
>
> As ?redwoodfull says:
>
> "The dataset redwoodfull contains the full point pattern of 195 trees. 
> The window has been rescaled to the unit square. Its physical size is 
> approximately 130 feet across.
> ...
> The plot of the data published by Strauss (1975) was scanned and 
> digitised by Sandra Pereira, University of Western Australia, 2002."
>
>
> So you can digitize yourself the original true coordinates  from the 
> plot in Strauss (1975).
>
> Cheers,
>
> Marcelino
>
>
> El 04/12/2013 19:37, ldecola at comcast.net escribi?:
>>
>> does anyone know the original, true coordinates of the spatstat 
>> redwoodfull data? i can't find them in:
>>
>> Strauss, D. J. (1975). "A Model for Clustering." Biometrika 62(2): 
>> 467-475.
>>
>> i think reporting spatial data in rescaled units is unscientific.
>>
>>
>> Lee De Cola, PhD, MCP.
>> DATA to Insight
>> LDECOLA at COMCAST.NET
>> Reston, Virginia
>> 703 709 6972
>> 571 315 0577 mobile


From ldecola at comcast.net  Thu Dec  5 01:56:32 2013
From: ldecola at comcast.net (ldecola at comcast.net)
Date: Thu, 5 Dec 2013 00:56:32 +0000 (UTC)
Subject: [R-sig-Geo] original coordinates of the redwood data?
In-Reply-To: <529FA3D2.1010300@auckland.ac.nz>
Message-ID: <1060921811.762480.1386204992927.JavaMail.root@sz0206a.westchester.pa.mail.comcast.net>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131205/e4e75f02/attachment.pl>

From HodgessE at uhd.edu  Thu Dec  5 04:36:36 2013
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Thu, 5 Dec 2013 03:36:36 +0000
Subject: [R-sig-Geo] covariance matrix
Message-ID: <FF9DB805FC41CC4E95825A50F680630217ACAF5B@challenger.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131205/314e56bd/attachment.pl>

From grothered at gmail.com  Thu Dec  5 09:19:20 2013
From: grothered at gmail.com (GD)
Date: Thu, 5 Dec 2013 00:19:20 -0800 (PST)
Subject: [R-sig-Geo] 3rd+ rasters added using "plot(r,
	add=TRUE)" are misregistered
In-Reply-To: <CAOwKfPQL2_-r1AWxtN03OKrtNOmogr3d3L3S8dA0fdRUzc-JZA@mail.gmail.com>
References: <CAOwKfPQL2_-r1AWxtN03OKrtNOmogr3d3L3S8dA0fdRUzc-JZA@mail.gmail.com>
Message-ID: <1386231560126-7585271.post@n2.nabble.com>

Good catch. 
I have no solution -- but I get the same problem on an earlier version of R
in a different environment (so it is not just because of your setup). 
My session info is below.
Cheers,
Gareth. 

> sessionInfo()
R version 3.0.1 (2013-05-16)
Platform: x86_64-unknown-linux-gnu (64-bit)

locale:
 [1] LC_CTYPE=en_AU.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_AU.UTF-8        LC_COLLATE=en_AU.UTF-8    
 [5] LC_MONETARY=en_AU.UTF-8    LC_MESSAGES=en_AU.UTF-8   
 [7] LC_PAPER=C                 LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_AU.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] grid      stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
[1] rgdal_0.8-10    rgeos_0.2-19    raster_2.1-59   maptools_0.8-25
[5] lattice_0.20-15 sp_1.0-11       foreign_0.8-53 



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/3rd-rasters-added-using-plot-r-add-TRUE-are-misregistered-tp7585262p7585271.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From ben.graeler at uni-muenster.de  Thu Dec  5 09:28:27 2013
From: ben.graeler at uni-muenster.de (=?ISO-8859-1?Q?Benedikt_Gr=E4ler?=)
Date: Thu, 05 Dec 2013 09:28:27 +0100
Subject: [R-sig-Geo] covariance matrix
In-Reply-To: <FF9DB805FC41CC4E95825A50F680630217ACAF5B@challenger.uhd.campus>
References: <FF9DB805FC41CC4E95825A50F680630217ACAF5B@challenger.uhd.campus>
Message-ID: <f8058e0c-acdb-4b05-a0aa-d027085e4291@email.android.com>

Dear Erin,

you might want to take a look at the gstat function "variogramLine" and set the parameter "covariance" to TRUE. The argument "dist_vector" takes as well a distance matrix and will then return a covariance matrix. 

HTH, best wishes,

 Ben

"Hodgess, Erin" <HodgessE at uhd.edu> wrote:
>Hi!
>
>Here is a goofy question, please:  how do I get the covariance matrix
>based on the estimated model, say exponential, please?
>
>I was looking at the "variogram" function in gstat and I think that the
>gamma values may be part of the solution, but I'm not sure how to
>finish it out.
>
>I'm experimenting with putting together a toy data set through the
>variogram and kriging process by hand (to a certain extent)
>
>Thanks for any help!
>Sincerely,
>Erin
>
>
>	[[alternative HTML version deleted]]
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Benedikt Gr?ler

Institute for Geoinformatics
University of M?nster

http://www.ifgi.de/graeler

+49 251 83 33082


From edzer.pebesma at uni-muenster.de  Thu Dec  5 09:56:44 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 05 Dec 2013 09:56:44 +0100
Subject: [R-sig-Geo] covariance matrix
In-Reply-To: <FF9DB805FC41CC4E95825A50F680630217ACAF5B@challenger.uhd.campus>
References: <FF9DB805FC41CC4E95825A50F680630217ACAF5B@challenger.uhd.campus>
Message-ID: <52A03FCC.2000907@uni-muenster.de>

Erin,

http://ifgi.uni-muenster.de/~epebe_01/mstp/lec5.html
http://ifgi.uni-muenster.de/~epebe_01/mstp/lec7.html

contain some "minimal", one-dimensional kriging functions that I used in
my class recently.

R markdown source files are on https://github.com/edzer/mstp

On 12/05/2013 04:36 AM, Hodgess, Erin wrote:
> Hi!
> 
> Here is a goofy question, please:  how do I get the covariance matrix based on the estimated model, say exponential, please?
> 
> I was looking at the "variogram" function in gstat and I think that the gamma values may be part of the solution, but I'm not sure how to finish it out.
> 
> I'm experimenting with putting together a toy data set through the variogram and kriging process by hand (to a certain extent)
> 
> Thanks for any help!
> Sincerely,
> Erin
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 555 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131205/75f775d1/attachment.bin>

From carotenuto_francesco at yahoo.it  Thu Dec  5 10:39:36 2013
From: carotenuto_francesco at yahoo.it (Francesco Carotenuto)
Date: Thu, 5 Dec 2013 09:39:36 +0000 (GMT)
Subject: [R-sig-Geo] Strange lines when projecting a world map
Message-ID: <1386236376.47715.YahooMailNeo@web172505.mail.ir2.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131205/42aa0e86/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Thu Dec  5 12:04:27 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Thu, 5 Dec 2013 11:04:27 +0000
Subject: [R-sig-Geo] original coordinates of the redwood data?
In-Reply-To: <74c21d012fac4a3db77e55c4c2f4f777@EX-0-HT0.lancs.local>
References: <1334334282.755872.1386182222740.JavaMail.root@sz0206a.westchester.pa.mail.comcast.net>
	<74c21d012fac4a3db77e55c4c2f4f777@EX-0-HT0.lancs.local>
Message-ID: <CANVKczPVArZ4RDTOzAeFRuro99Fuo3McCNg19E6NF8a+MNbnEA@mail.gmail.com>

On Wed, Dec 4, 2013 at 8:01 PM, Marcelino de la Cruz
<marcelino.delacruz at upm.es> wrote:
..
> The plot of the data published by Strauss (1975) was scanned and
> digitised by Sandra Pereira, University of Western Australia, 2002."
>
>
> So you can digitize yourself the original true coordinates  from the
> plot in Strauss (1975).

 Except the plot in Strauss (1975) doesn't have any coordinate labels!
Nor a scale bar, north arrow or any of that chart junk.

 We have a clue to the scale in that the distance 'r1' marked on the
plot is 'about six feet'. If anyone would like to rescale the redwood
data into units of 'about six feet' then I think that would be a nice
waste of their time.

Barry


From HodgessE at uhd.edu  Thu Dec  5 14:40:06 2013
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Thu, 5 Dec 2013 13:40:06 +0000
Subject: [R-sig-Geo] covariance matrix
In-Reply-To: <52A03FCC.2000907@uni-muenster.de>
References: <FF9DB805FC41CC4E95825A50F680630217ACAF5B@challenger.uhd.campus>,
	<52A03FCC.2000907@uni-muenster.de>
Message-ID: <FF9DB805FC41CC4E95825A50F680630217ACB126@challenger.uhd.campus>

Thanks to all for the good help...it's great!

Sincerely,
Erin

________________________________________
From: r-sig-geo-bounces at r-project.org [r-sig-geo-bounces at r-project.org] on behalf of Edzer Pebesma [edzer.pebesma at uni-muenster.de]
Sent: Thursday, December 05, 2013 2:56 AM
To: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] covariance matrix

Erin,

http://ifgi.uni-muenster.de/~epebe_01/mstp/lec5.html
http://ifgi.uni-muenster.de/~epebe_01/mstp/lec7.html

contain some "minimal", one-dimensional kriging functions that I used in
my class recently.

R markdown source files are on https://github.com/edzer/mstp

On 12/05/2013 04:36 AM, Hodgess, Erin wrote:
> Hi!
>
> Here is a goofy question, please:  how do I get the covariance matrix based on the estimated model, say exponential, please?
>
> I was looking at the "variogram" function in gstat and I think that the gamma values may be part of the solution, but I'm not sure how to finish it out.
>
> I'm experimenting with putting together a toy data set through the variogram and kriging process by hand (to a certain extent)
>
> Thanks for any help!
> Sincerely,
> Erin
>
>
>       [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

--
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795



From ldecola at comcast.net  Thu Dec  5 20:03:45 2013
From: ldecola at comcast.net (ldecola at comcast.net)
Date: Thu, 5 Dec 2013 19:03:45 +0000 (UTC)
Subject: [R-sig-Geo] original coordinates of the redwood data?
In-Reply-To: <CANVKczPVArZ4RDTOzAeFRuro99Fuo3McCNg19E6NF8a+MNbnEA@mail.gmail.com>
Message-ID: <351139314.775457.1386270225704.JavaMail.root@sz0206a.westchester.pa.mail.comcast.net>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131205/64761041/attachment.pl>

From Roger.Bivand at nhh.no  Thu Dec  5 21:22:58 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 5 Dec 2013 21:22:58 +0100
Subject: [R-sig-Geo] Strange lines when projecting a world map
In-Reply-To: <1386236376.47715.YahooMailNeo@web172505.mail.ir2.yahoo.com>
References: <1386236376.47715.YahooMailNeo@web172505.mail.ir2.yahoo.com>
Message-ID: <alpine.LRH.2.03.1312052114530.23791@reclus.nhh.no>

On Thu, 5 Dec 2013, Francesco Carotenuto wrote:

> Dear list, as in
> the title, I found that when projecting a world map by mollweide projection and
> setting a?? longitude value, some strange
> parallels are drawn. The real problem is that these lines ???interact??? with a
> raster when performing the ???over??? function.
> How can I manage
> it?

The underlying question is what you want to do with the objects after 
projection. The problem in your example is that some polygons/lines cross 
-180+66 degrees, so get reflected back across. A possible solution is to 
clip the polygons before projection at -180+66 degrees +/- a small number, 
but before looking at this in more detail, I need to know what the 
projected object is intended for. When +lon_0=0, there is no such effect, 
as this data set is clipped at -180 already.

Roger

> Here I provide a
> simulated example to let you understand what I mean
> Thanks.??
>
>
> #Example of a
> world map mollweide projection with a specific longitude value
> library(sp)
> library(maptools)
> library(rgdal)
> data(wrld_simpl)
> w_pol<-wrld_simpl
> w_pol<-spTransform(w_pol,
> CRS("+proj=moll +lon_0=66"))
> plot(w_pol)
> ??
> # Intersecting a
> grid with the projected world map
> gr<-expand.grid(x
> = seq(-180, 180, length.out = 100), y = seq(-90, 90, length.out = 100))
> coordinates(gr)<-~x+y
> proj4string(gr)<-CRS("+proj=longlat
> +ellps=WGS84 +datum=WGS84 +no_defs")
> gr<-spTransform(gr,
> CRS("+proj=moll +lon_0=66"))
> plot(gr[w_pol,])
> ??
>
> ??
> Dr. Francesco Carotenuto (Ph.D.)
> Department of Earth Sciences
> Federico II University
> Largo S. Marcellino 10,
> 80138 NAPLES (ITALY)
> http://francesco-carotenuto.blogspot.it/
> http://3dpaleontology.blogspot.it/??
> 	[[alternative HTML version deleted]]
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From carotenuto_francesco at yahoo.it  Thu Dec  5 22:26:20 2013
From: carotenuto_francesco at yahoo.it (Francesco Carotenuto)
Date: Thu, 5 Dec 2013 21:26:20 +0000 (GMT)
Subject: [R-sig-Geo] Strange lines when projecting a world map
In-Reply-To: <alpine.LRH.2.03.1312052114530.23791@reclus.nhh.no>
References: <1386236376.47715.YahooMailNeo@web172505.mail.ir2.yahoo.com>
	<alpine.LRH.2.03.1312052114530.23791@reclus.nhh.no>
Message-ID: <1386278780.80935.YahooMailNeo@web172504.mail.ir2.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131205/41401838/attachment.pl>

From mdsumner at gmail.com  Thu Dec  5 23:02:37 2013
From: mdsumner at gmail.com (Michael Sumner)
Date: Fri, 6 Dec 2013 09:02:37 +1100
Subject: [R-sig-Geo] 3rd+ rasters added using "plot(r,
	add=TRUE)" are misregistered
In-Reply-To: <CAOwKfPQL2_-r1AWxtN03OKrtNOmogr3d3L3S8dA0fdRUzc-JZA@mail.gmail.com>
References: <CAOwKfPQL2_-r1AWxtN03OKrtNOmogr3d3L3S8dA0fdRUzc-JZA@mail.gmail.com>
Message-ID: <CAAcGz9-6jDLG97BhDuybxYTzxG=vg-U79MFvrgXd0b_4NX3XbQ@mail.gmail.com>

I just wonder if this is related to an existing resize problem when
overplotting? I see this on the windows() graphics device, you need to
try these two sets of plot commands and resize the window (especially
stretch it in one direction) to see the problem at ## 1 and ## 2

v <- list(x = seq(0, 1, length = nrow(volcano)), y = seq(0, 1, length
= ncol(volcano)), z = volcano)
cl <- contourLines(v, levels = 160)[[2]]

image(v, xaxs = "i")
lines(cl)
## (1) now resize the window, it's all good - the contour stays in the
## right place


## however, resize after adding the lines to a raster plot
## and the relationship is broken
library(raster)

plot(raster(v), xaxs = "i")

lines(cl)

## (2)

May be totally unrelated but I thought it worth pointing out. It's
hard to trace through the setting up that raster's plot does (well, I
find it hard to do - I've tried a few times to figure out where these
problems are happening).

Cheers, Mike.

On Wed, Dec 4, 2013 at 5:57 AM, Josh O'Brien <joshmobrien at gmail.com> wrote:
> Hi all,
>
> Briefly, running the following code will not produce a single grey ring, as
> would be expected. The first three raster layers all stack up neatly, but
> the 4th and subsequent raster layers are all shifted/skewed to the right.
>
> It appears that the plotting engine loses track of the fact that some space
> in the original plot was allocated to a legend, and just begins plotting as
> if a wider canvas were available to it.
>
> I'm not sure whether this is ultimately an issue with raster or sp or
> something else, which is why I'm noting it here on R-sig-geo. (I'm also
> fully aware that there are other and better ways to add several raster
> layers to a plot, but still think the following behavior qualifies as a bug
> that I ought to report.)
>
>   library(maptools) ## Only needs to be installed for example data
>   library(raster)
>   library(rgeos)
>
>   ## Create an example raster
>   p <- shapefile(system.file("shapes/co37_d90.shp", package="maptools"))
>   p <- p[31,]  ## A tall narrow county polygon
>   pr <- gDifference(gBuffer(p, width=.01), p)
>   r <- rasterize(pr, raster(extent(pr), ncol=100, nrow=100))
>
>   ## These three are properly registered on one another
>   plot(r, col="yellow", legend=FALSE)
>   plot(r, col="green", legend=FALSE, add=TRUE)
>   plot(r, col="grey", legend=FALSE, add=TRUE)
>   ## All subsequent "layers" are improperly shifted/skewed to right
>   plot(r, col="yellow", legend=FALSE, add=TRUE)
>   plot(r, col="blue", legend=FALSE, add=TRUE)
>   plot(r, col="red", legend=FALSE, add=TRUE)
>   plot(r, col="grey20", legend=FALSE, add=TRUE)
>   ## Following the above, SpatialPolygons are also shifted/skewed
>   plot(p)
>
>
>
> My session info, in case it matters, is:
>
>> sessionInfo()
> R version 3.0.2 (2013-09-25)
> Platform: i386-w64-mingw32/i386 (32-bit)
>
> locale:
> [1] LC_COLLATE=English_United States.1252
> [2] LC_CTYPE=English_United States.1252
> [3] LC_MONETARY=English_United States.1252
> [4] LC_NUMERIC=C
> [5] LC_TIME=English_United States.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] rgdal_0.8-14  rgeos_0.3-2   raster_2.1-66 sp_1.0-14
>
> loaded via a namespace (and not attached):
> [1] compiler_3.0.2  grid_3.0.2      lattice_0.20-24 tools_3.0.2
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Michael Sumner
Hobart, Australia
e-mail: mdsumner at gmail.com


From Roger.Bivand at nhh.no  Thu Dec  5 23:58:36 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 5 Dec 2013 23:58:36 +0100
Subject: [R-sig-Geo] Strange lines when projecting a world map
In-Reply-To: <1386278780.80935.YahooMailNeo@web172504.mail.ir2.yahoo.com>
References: <1386236376.47715.YahooMailNeo@web172505.mail.ir2.yahoo.com>
	<alpine.LRH.2.03.1312052114530.23791@reclus.nhh.no>
	<1386278780.80935.YahooMailNeo@web172504.mail.ir2.yahoo.com>
Message-ID: <alpine.LRH.2.03.1312052337330.24165@reclus.nhh.no>

On Thu, 5 Dec 2013, Francesco Carotenuto wrote:

> Thank you for the answer. The object is the prediction location in an 
> interpolation process. The function of "overlay" is involved in an 
> automatic process and the longitude (and the kind of projection too) can 
> change according to the dataset that is, in some cases, worldwide 
> distributed.

This doesn't help much - do you mean that the grid is of prediction 
locations? Are the polygons used for anything other than visualization? If 
you change the visualization projection (shifting the meridian (+lon_0) 
for worldwide distributions) repeatedly, you will have to clip to suit. If 
visualization, does it make sense to modify the meridian (the reader may 
see the shifts as confusing)?

You are trying to deal with multiple somethings that you are interpolating 
(to a grid?) and displaying in possibly different windows possibly 
depending on the extent of the prediction grid. Your workflow isn't 
obvious.

You haven't explained why you need the projection so far (other than 
aesthetics, maybe?). You may be able to interpolate on the sphere, so 
unless the target grid cells must be of fixed area - and possibly not even 
then, you don't need to make life complicated. There are problems in 
creating global visualizations in any case, as the lines/polygons need 
clipping at +/- 180 degrees from the meridian.

Roger

>
>
> ?
> Dr. Francesco Carotenuto (Ph.D.)
> Department of Earth Sciences
> Federico II University
> Largo S. Marcellino 10,
> 80138 NAPLES (ITALY)
> http://francesco-carotenuto.blogspot.it/
> http://3dpaleontology.blogspot.it/?
>
>
>
> Il Gioved? 5 Dicembre 2013 21:23, Roger Bivand <Roger.Bivand at nhh.no> ha scritto:
> 
> On Thu, 5 Dec 2013, Francesco Carotenuto wrote:
>
>> Dear list, as in
>> the title, I found that when projecting a world map by mollweide projection and
>> setting a?? longitude value, some strange
>> parallels are drawn. The real problem is that these lines ???interact??? with a
>> raster when performing the ???over??? function.
>> How can I manage
>> it?
>
> The underlying question is what you want to do with the objects after 
> projection. The problem in your example is that some polygons/lines cross 
> -180+66 degrees, so get reflected back across. A possible solution is to 
> clip the polygons before projection at -180+66 degrees +/- a small number, 
> but before looking at this in more detail, I need to know what the 
> projected object is intended for. When +lon_0=0, there is no such effect, 
> as this data set is clipped at -180 already.
>
> Roger
>
>
>> Here I provide a
>> simulated example to let you understand what I mean
>> Thanks.??
>>
>>
>> #Example of a
>> world map mollweide projection with a specific longitude value
>> library(sp)
>> library(maptools)
>> library(rgdal)
>> data(wrld_simpl)
>> w_pol<-wrld_simpl
>> w_pol<-spTransform(w_pol,
>> CRS("+proj=moll +lon_0=66"))
>> plot(w_pol)
>> ??
>> # Intersecting a
>> grid with the projected world map
>> gr<-expand.grid(x
>> = seq(-180, 180, length.out = 100), y = seq(-90, 90, length.out = 100))
>> coordinates(gr)<-~x+y
>> proj4string(gr)<-CRS("+proj=longlat
>> +ellps=WGS84 +datum=WGS84 +no_defs")
>> gr<-spTransform(gr,
>> CRS("+proj=moll +lon_0=66"))
>> plot(gr[w_pol,])
>> ??
>>
>> ??
>> Dr. Francesco Carotenuto (Ph.D.)
>> Department of Earth Sciences
>> Federico II University
>> Largo S. Marcellino 10,
>> 80138 NAPLES (ITALY)
>> http://francesco-carotenuto.blogspot.it/
>> http://3dpaleontology.blogspot.it/??
>> ??? [[alternative HTML version deleted]]
>>
>>
>
> -- 
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From joshmobrien at gmail.com  Fri Dec  6 01:58:05 2013
From: joshmobrien at gmail.com (Josh O'Brien)
Date: Thu, 5 Dec 2013 16:58:05 -0800
Subject: [R-sig-Geo] 3rd+ rasters added using "plot(r,
	add=TRUE)" are misregistered
In-Reply-To: <CAAcGz9-6jDLG97BhDuybxYTzxG=vg-U79MFvrgXd0b_4NX3XbQ@mail.gmail.com>
References: <CAOwKfPQL2_-r1AWxtN03OKrtNOmogr3d3L3S8dA0fdRUzc-JZA@mail.gmail.com>
	<CAAcGz9-6jDLG97BhDuybxYTzxG=vg-U79MFvrgXd0b_4NX3XbQ@mail.gmail.com>
Message-ID: <CAOwKfPR9iLJdUv3oiPTsecLRaiT5zMHjv04FvB0_-bbwPSgvbg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131205/ec613a3b/attachment.pl>

From mdsumner at gmail.com  Fri Dec  6 02:26:47 2013
From: mdsumner at gmail.com (Michael Sumner)
Date: Fri, 6 Dec 2013 12:26:47 +1100
Subject: [R-sig-Geo] 3rd+ rasters added using "plot(r,
	add=TRUE)" are misregistered
In-Reply-To: <CAOwKfPR9iLJdUv3oiPTsecLRaiT5zMHjv04FvB0_-bbwPSgvbg@mail.gmail.com>
References: <CAOwKfPQL2_-r1AWxtN03OKrtNOmogr3d3L3S8dA0fdRUzc-JZA@mail.gmail.com>
	<CAAcGz9-6jDLG97BhDuybxYTzxG=vg-U79MFvrgXd0b_4NX3XbQ@mail.gmail.com>
	<CAOwKfPR9iLJdUv3oiPTsecLRaiT5zMHjv04FvB0_-bbwPSgvbg@mail.gmail.com>
Message-ID: <CAAcGz99sgi0ZUwqrkscP497et8ZW3yZuOvsxv_q5pOarvagyJg@mail.gmail.com>

Interesting and difficult!  Thanks for pointing out the useRaster
difference, I had mixed up TRUE/FALSE in my original report (offlist)
on that one. That might help me find the solution, though sorry I have
nothing for your issue. :)

Cheers, Mike.

On Fri, Dec 6, 2013 at 11:58 AM, Josh O'Brien <joshmobrien at gmail.com> wrote:
> Hi Michael,
>
> Thanks for those thoughts.
>
> The issue you raise (which has bit me before as well) appears to be
> unrelated. In particular, your resizing issue disappears if one sets
> useRaster=FALSE, whereas my problem persists whether or not rasterImage() is
> used to draw the raster. Try this to get a version of the volcano and
> contour that resize/stretch in sync:
>
>     plot(raster(v), xaxs = "i", useRaster=FALSE)
>     lines(cl)
>     ## Check that resizing works correctly. (It does, presumably b/c
>     ## image(..., useRaster=FALSE) doesn't attempt to maintain aspect ratio
> of the raster.
>
> The problem I described seems related to resetting of elements of `par` by
> the first call to `plot(r, ..., add=TRUE)`, as can be seen by doing:
>
>
>     plot(r, col="yellow", legend=FALSE)
>     p0 <- par()
>
>     plot(r, col="green", legend=FALSE, add=TRUE)
>     p1 <- par()
>
>     plot(r, col="grey", legend=FALSE, add=TRUE)
>     p2 <- par()
>
>     plot(r, col="yellow", legend=FALSE, add=TRUE)
>     p3 <- par()
>
>     ## Find elements of par that are changed by first call to plot(r, ...,
> add=TRUE)
>     names(p1)[!mapply(identical, p0,p1)]
>     # [1] "cxy" "pin" "plt"
>
>     ## Show that par does not change thereafter
>     all(identical(p1,p2), identical(p2,p3))
>     # [1] TRUE
>
> As might be expected if par is to blame, frequently resetting par to its
> 'original' value makes the plots come out right:
>
>     plot(r, col="yellow", legend=FALSE)
>     p0 <- par(no.readonly=TRUE)
>
>     plot(r, col="green", legend=FALSE, add=TRUE)
>     plot(r, col="blue", legend=FALSE, add=TRUE)
>     par(p0)
>
>     plot(r, col="red", legend=FALSE, add=TRUE)
>     plot(r, col="grey", legend=FALSE, add=TRUE)
>     par(p0)
>     plot(r, col="dodgerblue", legend=FALSE, add=TRUE)
>
> The piece that is most puzzling to me is that, although cxy, pin, & plt get
> reset after the first added layer is plotted, it isn't until _two_ more
> layers are added that the problem manifests itself
>
> Seems like an interesting puzzle here, which might be solvable by doing
> `debug(raster:::.imageplot)` and stepping through it, paying careful
> attention to how par gets set and reset during each of the calls to plot().
>
> Cheers,
>
> Josh
>
>
> On Thu, Dec 5, 2013 at 2:02 PM, Michael Sumner <mdsumner at gmail.com> wrote:
>>
>> I just wonder if this is related to an existing resize problem when
>> overplotting? I see this on the windows() graphics device, you need to
>> try these two sets of plot commands and resize the window (especially
>> stretch it in one direction) to see the problem at ## 1 and ## 2
>>
>> v <- list(x = seq(0, 1, length = nrow(volcano)), y = seq(0, 1, length
>> = ncol(volcano)), z = volcano)
>> cl <- contourLines(v, levels = 160)[[2]]
>>
>> image(v, xaxs = "i")
>> lines(cl)
>> ## (1) now resize the window, it's all good - the contour stays in the
>> ## right place
>>
>>
>> ## however, resize after adding the lines to a raster plot
>> ## and the relationship is broken
>> library(raster)
>>
>> plot(raster(v), xaxs = "i")
>>
>> lines(cl)
>>
>> ## (2)
>>
>> May be totally unrelated but I thought it worth pointing out. It's
>> hard to trace through the setting up that raster's plot does (well, I
>> find it hard to do - I've tried a few times to figure out where these
>> problems are happening).
>>
>> Cheers, Mike.
>>
>> On Wed, Dec 4, 2013 at 5:57 AM, Josh O'Brien <joshmobrien at gmail.com>
>> wrote:
>> > Hi all,
>> >
>> > Briefly, running the following code will not produce a single grey ring,
>> > as
>> > would be expected. The first three raster layers all stack up neatly,
>> > but
>> > the 4th and subsequent raster layers are all shifted/skewed to the
>> > right.
>> >
>> > It appears that the plotting engine loses track of the fact that some
>> > space
>> > in the original plot was allocated to a legend, and just begins plotting
>> > as
>> > if a wider canvas were available to it.
>> >
>> > I'm not sure whether this is ultimately an issue with raster or sp or
>> > something else, which is why I'm noting it here on R-sig-geo. (I'm also
>> > fully aware that there are other and better ways to add several raster
>> > layers to a plot, but still think the following behavior qualifies as a
>> > bug
>> > that I ought to report.)
>> >
>> >   library(maptools) ## Only needs to be installed for example data
>> >   library(raster)
>> >   library(rgeos)
>> >
>> >   ## Create an example raster
>> >   p <- shapefile(system.file("shapes/co37_d90.shp", package="maptools"))
>> >   p <- p[31,]  ## A tall narrow county polygon
>> >   pr <- gDifference(gBuffer(p, width=.01), p)
>> >   r <- rasterize(pr, raster(extent(pr), ncol=100, nrow=100))
>> >
>> >   ## These three are properly registered on one another
>> >   plot(r, col="yellow", legend=FALSE)
>> >   plot(r, col="green", legend=FALSE, add=TRUE)
>> >   plot(r, col="grey", legend=FALSE, add=TRUE)
>> >   ## All subsequent "layers" are improperly shifted/skewed to right
>> >   plot(r, col="yellow", legend=FALSE, add=TRUE)
>> >   plot(r, col="blue", legend=FALSE, add=TRUE)
>> >   plot(r, col="red", legend=FALSE, add=TRUE)
>> >   plot(r, col="grey20", legend=FALSE, add=TRUE)
>> >   ## Following the above, SpatialPolygons are also shifted/skewed
>> >   plot(p)
>> >
>> >
>> >
>> > My session info, in case it matters, is:
>> >
>> >> sessionInfo()
>> > R version 3.0.2 (2013-09-25)
>> > Platform: i386-w64-mingw32/i386 (32-bit)
>> >
>> > locale:
>> > [1] LC_COLLATE=English_United States.1252
>> > [2] LC_CTYPE=English_United States.1252
>> > [3] LC_MONETARY=English_United States.1252
>> > [4] LC_NUMERIC=C
>> > [5] LC_TIME=English_United States.1252
>> >
>> > attached base packages:
>> > [1] stats     graphics  grDevices utils     datasets  methods   base
>> >
>> > other attached packages:
>> > [1] rgdal_0.8-14  rgeos_0.3-2   raster_2.1-66 sp_1.0-14
>> >
>> > loaded via a namespace (and not attached):
>> > [1] compiler_3.0.2  grid_3.0.2      lattice_0.20-24 tools_3.0.2
>> >
>> >         [[alternative HTML version deleted]]
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at r-project.org
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>>
>> --
>> Michael Sumner
>> Hobart, Australia
>> e-mail: mdsumner at gmail.com
>
>



-- 
Michael Sumner
Hobart, Australia
e-mail: mdsumner at gmail.com


From adrian.baddeley at uwa.edu.au  Fri Dec  6 04:06:52 2013
From: adrian.baddeley at uwa.edu.au (Adrian Baddeley)
Date: Fri, 6 Dec 2013 11:06:52 +0800
Subject: [R-sig-Geo]  original coordinates of the redwood data?
In-Reply-To: <mailman.15.1386241205.8697.r-sig-geo@r-project.org>
References: <mailman.15.1386241205.8697.r-sig-geo@r-project.org>
Message-ID: <CF5661163F77A44781208D9AC4FDEA7226E8DF9732@IS-WIN-376.staffad.uwa.edu.au>

Lee De Cola <ldecola at comcast.net> writes:

> does anyone know the original, true coordinates of the spatstat redwoodfull data?
>  i can't find them in:
> Strauss, D. J. (1975). "A Model for Clustering." Biometrika 62(2): 467-475.

> i think reporting spatial data in rescaled units is unscientific. 

Please first read the help file for the dataset. 
(I think it is unprofessional to send out a question before you have read the documentation %^])

The help file says that these data were scanned manually from a reprint of Strauss's paper
and that the dimensions of the figure are only *approximately* known to be about 128 feet across.

The paper by Strauss does not give the exact dimensions of the figure, and does not give the
original coordinates. The data are lost, according to David Strauss. Hence we were obliged to
scan a reprint - which has the risk of inaccuracy (coincident points may be lost; the x and y axes
may have been unequally scaled, nonlinearly scaled, etc).

If you are confident enough about the dimensions, it is easy to rescale the data:
       X <- rescale(redwoodfull, 128)
       unitname(X) <- c("foot", "feet")
In spatstat we do not attribute physical scales to datasets unless the scale is reliable,
and that is why 'redwoodfull' is not scaled to 128 feet.

> i think reporting spatial data in rescaled units is unscientific. 

Sure, the redwood dataset does not meet modern standards of data integrity.
The redwood patterm is a 'legacy' dataset that  has been widely used and re-used
 over the years to compare different methods (a bit like Fisher's iris data or the sunspot series). 
That is why it is included in spatstat.

In the 1970's it was actually standard practice to rescale point patterns to the unit square, to avoid
numerical difficulties (for example all the data in Peter Diggle's 1983 book are rescaled to the unit square).
 Also it was a lot harder to obtain data, and scientists were even more protective of their data than they are now, 
so spatial data were not widely shared, and when shared  it was often 'anonymised' by removing the spatial scale 
so that competitors could not re-analyse the data. 

Adrian Baddeley
author of 'spatstat'

Prof Adrian Baddeley FAA
University of Western Australia 

From culinovic.domagoj at gmail.com  Fri Dec  6 10:08:44 2013
From: culinovic.domagoj at gmail.com (Domagoj Culinovic)
Date: Fri, 6 Dec 2013 10:08:44 +0100
Subject: [R-sig-Geo] R and MS SQL Spatial
Message-ID: <CACgt3o=7WRCwj+7ojQcLgVg-DrCrFQm3whEemBsuOwCdUKORaQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131206/a108d45b/attachment.pl>

From madiazl at gmail.com  Fri Dec  6 10:35:10 2013
From: madiazl at gmail.com (Andres Diaz)
Date: Fri, 6 Dec 2013 10:35:10 +0100
Subject: [R-sig-Geo] R and MS SQL Spatial
In-Reply-To: <CACgt3o=7WRCwj+7ojQcLgVg-DrCrFQm3whEemBsuOwCdUKORaQ@mail.gmail.com>
References: <CACgt3o=7WRCwj+7ojQcLgVg-DrCrFQm3whEemBsuOwCdUKORaQ@mail.gmail.com>
Message-ID: <CAMXOh=0QtH8BikHcA4BCRGzOhjmdboAuW2tov0-hgtwVLcsiXw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131206/7049644c/attachment.pl>

From Roger.Bivand at nhh.no  Fri Dec  6 10:37:49 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 6 Dec 2013 10:37:49 +0100
Subject: [R-sig-Geo] R and MS SQL Spatial
In-Reply-To: <CACgt3o=7WRCwj+7ojQcLgVg-DrCrFQm3whEemBsuOwCdUKORaQ@mail.gmail.com>
References: <CACgt3o=7WRCwj+7ojQcLgVg-DrCrFQm3whEemBsuOwCdUKORaQ@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1312061025090.26376@reclus.nhh.no>

On Fri, 6 Dec 2013, Domagoj Culinovic wrote:

> I have a lot of spatial and statistical data stored in MS SQL Spatial. Now
> i am using web-gis server to produce thematic maps, but for better analyses
> i need R.
> Can someone help me to find solution for MS SQL Spatial. Some examples code
> will be welcome too, because i am new in R.
>

If you are using Windows, and have installed the rgdal CRAN Windows binary 
package, then the correct driver should be available. The driver should 
work as desrcibed in OGR:

http://www.gdal.org/ogr/drv_mssqlspatial.html

On loading rgdal, look for MSSQLSpatial in:

library(rgdal)
ogrDrivers()

You may need to proceed by trial and error to find the incantation for 
dsn= and layer= in ogrInfo() and readOGR() to access your data. Maybe try 
ogrListLayers() with your supposed dsn= first to see which layers are 
reported. I don't use this driver, so advice from others who do would be 
very useful.

Hope this helps,

Roger

> 	[[alternative HTML version deleted]]

PS: only post plain text please! HTML mail is larger in size and can 
contain bad payloads that consume energy to remove. This is a low-carbon 
footprint list.

>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From pnajnin at gmail.com  Fri Dec  6 10:54:05 2013
From: pnajnin at gmail.com (pnajnin at gmail.com)
Date: Fri, 6 Dec 2013 10:54:05 +0100
Subject: [R-sig-Geo] R and MS SQL Spatial
In-Reply-To: <CAMXOh=0QtH8BikHcA4BCRGzOhjmdboAuW2tov0-hgtwVLcsiXw@mail.gmail.com>
References: <CACgt3o=7WRCwj+7ojQcLgVg-DrCrFQm3whEemBsuOwCdUKORaQ@mail.gmail.com>
	<CAMXOh=0QtH8BikHcA4BCRGzOhjmdboAuW2tov0-hgtwVLcsiXw@mail.gmail.com>
Message-ID: <11693D5D-1F5E-420F-A833-5B208A29882D@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131206/c6edeab7/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Fri Dec  6 11:17:45 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Fri, 6 Dec 2013 10:17:45 +0000
Subject: [R-sig-Geo] R and MS SQL Spatial
In-Reply-To: <4f76d403e3b1466a8e16a1fc95cff49d@EX-1-HT0.lancs.local>
References: <4f76d403e3b1466a8e16a1fc95cff49d@EX-1-HT0.lancs.local>
Message-ID: <CANVKczPzDB6YVFrrJR_QedfDT8aK2aadVRXhvJDLCENZX4xS=g@mail.gmail.com>

On Fri, Dec 6, 2013 at 9:08 AM, Domagoj Culinovic
<culinovic.domagoj at gmail.com> wrote:
> I have a lot of spatial and statistical data stored in MS SQL Spatial. Now
> i am using web-gis server to produce thematic maps, but for better analyses
> i need R.
> Can someone help me to find solution for MS SQL Spatial. Some examples code
> will be welcome too, because i am new in R.

Access to spatial data in R is best done using the rgdal package,
which uses the C library GDAL to access different types of spatial
data store - shapefiles, Mapinfo files, GML etc.

If you can install GDAL with support for MS SQL Spatial then you can
read your data using `readOGR` from the `rgdal` package. Install the
rgdal package, do require(rgdal);ogrDrivers() to get a list of drivers
that your rgdal package has. If it includes MSSQLSpatial then you may
be sorted. Mine does, and I'm not even running Windows, which
surprised me and I fell off my chair:

 > any(ogrDrivers()$name == "MSSQLSpatial")
 [1] TRUE

The next problem is simply working out the exact form of the
connection string (the "dsn") to the database so that it can pass your
server name, username, and password, and database name. The GDAL guide
might help:

http://www.gdal.org/ogr/drv_mssqlspatial.html

but I don't have a server I can experiment with.

[Someone has just suggested switching to MySQL, which is probably a
bit pointless - you'd be better off switching to PostGIS]

Barry


From Bastien.Ferland-Raymond at mrn.gouv.qc.ca  Fri Dec  6 14:42:29 2013
From: Bastien.Ferland-Raymond at mrn.gouv.qc.ca (Bastien Ferland-Raymond)
Date: Fri, 6 Dec 2013 05:42:29 -0800 (PST)
Subject: [R-sig-Geo] Attach metadata to raster object
In-Reply-To: <CALjAYt7w=7quTkqN=VEpwDE5EiCQafCqtS_3sr3F8EFO1eUsag@mail.gmail.com>
References: <CALjAYt7w=7quTkqN=VEpwDE5EiCQafCqtS_3sr3F8EFO1eUsag@mail.gmail.com>
Message-ID: <1386337348994-7585290.post@n2.nabble.com>

Hello ?tienne,

I'm a little disappointed nobody replied to your question, as this is
something I'm also interested in.  The slot you are proposing to add
metadata to raster* object could also be useful to allow categorical raster,
something the raster package do not do.  I think it would be great to be
able to use integer in the rasters values and than add in the metadata slot
the key that specify the factors values (ex: 1=private land, 2=public land,
etc.).  Having all that within the same R object would be a must.

Bastien
   



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Attach-metadata-to-raster-object-tp7585254p7585290.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From john.tellat at gmail.com  Fri Dec  6 16:49:50 2013
From: john.tellat at gmail.com (John Tellat)
Date: Fri, 6 Dec 2013 16:49:50 +0100
Subject: [R-sig-Geo] Taking elevation into account when calculating
	distance
In-Reply-To: <CAEBQMMkNSmjui_E=Dhsxqc5JShXTEDyVPmBw-0UHKySYMb9LAw@mail.gmail.com>
References: <CAOPvn+i-TCbmF7STCQho4Pwz8gTXrPDTQR48mRyt_QAYCoPL5Q@mail.gmail.com>
	<CAEBQMMkNSmjui_E=Dhsxqc5JShXTEDyVPmBw-0UHKySYMb9LAw@mail.gmail.com>
Message-ID: <CAOPvn+iR8FBnLxORokGthPoKQrta8P_gNikkFDe5ZRiahZbisg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131206/5d31e929/attachment.pl>

From palfaro at motionsoft.com.uy  Fri Dec  6 18:22:30 2013
From: palfaro at motionsoft.com.uy (Pablo Alfaro)
Date: Fri, 6 Dec 2013 15:22:30 -0200
Subject: [R-sig-Geo] Intamap, reduce verbose output of idw method
In-Reply-To: <5293619C.80308@jrc.ec.europa.eu>
References: <CAGFWpktq+b0tARuGFGN3=QaUt9AG43Jm_9ZnCgJ8e1igZHNZJA@mail.gmail.com>
	<5293619C.80308@jrc.ec.europa.eu>
Message-ID: <CALDV4snDGNQoVtMMtmGNy7_pmsncG87ryLpV_dKbdYBgSc5Yeg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131206/157f7b19/attachment.pl>

From tephilippi at gmail.com  Fri Dec  6 18:34:41 2013
From: tephilippi at gmail.com (Tom Philippi)
Date: Fri, 6 Dec 2013 09:34:41 -0800
Subject: [R-sig-Geo] Attach metadata to raster object
In-Reply-To: <1386337348994-7585290.post@n2.nabble.com>
References: <CALjAYt7w=7quTkqN=VEpwDE5EiCQafCqtS_3sr3F8EFO1eUsag@mail.gmail.com>
	<1386337348994-7585290.post@n2.nabble.com>
Message-ID: <CALyPt8x93g3DLri7D=vaKYKsrfzphZ3DPVejMTKFAxJ2WLtbXw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131206/85fc2d1b/attachment.pl>

From joshmobrien at gmail.com  Fri Dec  6 18:39:19 2013
From: joshmobrien at gmail.com (Josh O'Brien)
Date: Fri, 6 Dec 2013 09:39:19 -0800 (PST)
Subject: [R-sig-Geo] Attach metadata to raster object
In-Reply-To: <1386337348994-7585290.post@n2.nabble.com>
References: <CALjAYt7w=7quTkqN=VEpwDE5EiCQafCqtS_3sr3F8EFO1eUsag@mail.gmail.com>
	<1386337348994-7585290.post@n2.nabble.com>
Message-ID: <1386351559713-7585294.post@n2.nabble.com>

Bastien Ferland-Raymond wrote
> Hello ?tienne,
> 
> I'm a little disappointed nobody replied to your question, as this is
> something I'm also interested in.  The slot you are proposing to add
> metadata to raster* object could also be useful to allow categorical
> raster, something the raster package do not do.  I think it would be great
> to be able to use integer in the rasters values and than add in the
> metadata slot the key that specify the factors values (ex: 1=private land,
> 2=public land, etc.).  Having all that within the same R object would be a
> must.
> 
> Bastien

Hi Bastien,

The raster package**does** support categorical rasters, to some extent. Type
?ratify for the relevant documentation, and for a quick taste of what's
possible, try:

    library(raster)
    library(rasterVis)  ## For its levelplot method for rasters
    example(ratify)    ## Creates a categorical raster with three veg types
    levelpot(ratify)    ## Plots them with an categorical legend
    levels(x)[[1]]      ## Have a look at the layer's "RAT" (Raster
Attribute Table)

HTH,

Josh



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Attach-metadata-to-raster-object-tp7585254p7585294.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From b.rowlingson at lancaster.ac.uk  Fri Dec  6 19:56:50 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Fri, 6 Dec 2013 18:56:50 +0000
Subject: [R-sig-Geo] Taking elevation into account when calculating
	distance
In-Reply-To: <c2ce1ccbcf2f428dacd42c045c25086b@EX-1-HT0.lancs.local>
References: <CAOPvn+i-TCbmF7STCQho4Pwz8gTXrPDTQR48mRyt_QAYCoPL5Q@mail.gmail.com>
	<CAEBQMMkNSmjui_E=Dhsxqc5JShXTEDyVPmBw-0UHKySYMb9LAw@mail.gmail.com>
	<c2ce1ccbcf2f428dacd42c045c25086b@EX-1-HT0.lancs.local>
Message-ID: <CANVKczMh_F3u3t-Oy0414LMMpJQnDgKiywnwGYJZCV-7dqQj=Q@mail.gmail.com>

On Fri, Dec 6, 2013 at 3:49 PM, John Tellat <john.tellat at gmail.com> wrote:

> But it gives me 0.15m, which is not really the expected distance ...

 I get:

 > costDistance(tr1, cc)
           A
 B 0.01137836

But I'm not sure this is the right thing to do. The transition matrix
cost-distance approach only works on the cell level, so the distance
from the bottom left corner of your lower cell to the to right point
of your upper cell will be the same as from the two corners nearest
each other in that cell. (I think).

What's the distance from the bottom to the top of the stairs in my
house? For me its Pythagoras, sqrt(dx^2 + dy^2), but for a spider its
dx+dy - it has to crawl across every tread and up every riser.

 At first I thought the problem could be solved by taking the profile
of the path between the start and end points and taking the length of
that, but you have to sample the profile at a resolution, and if you
use a fine resolution you get the "spider" result and if you use a
large resolution you get the "human" result.

 You'll maybe get a better answer if you can treat your raster as a
continuous smooth surface, then the length of the profile should be
stable as you increase the resolution and not tend to dx+dy. But the
fundamental problem is that your raster is a discrete model of a
continuous reality [1] so any distances are going to be
approximations...

 This must be a GIS research question with some literature behind it...

Barry

[1] okay, lets argue if reality is continuous, discrete, fractal or
quantum string soup some other time!


From Bastien.Ferland-Raymond at mrn.gouv.qc.ca  Fri Dec  6 21:27:39 2013
From: Bastien.Ferland-Raymond at mrn.gouv.qc.ca (Bastien Ferland-Raymond)
Date: Fri, 6 Dec 2013 12:27:39 -0800 (PST)
Subject: [R-sig-Geo] Attach metadata to raster object
In-Reply-To: <1386351559713-7585294.post@n2.nabble.com>
References: <CALjAYt7w=7quTkqN=VEpwDE5EiCQafCqtS_3sr3F8EFO1eUsag@mail.gmail.com>
	<1386337348994-7585290.post@n2.nabble.com>
	<1386351559713-7585294.post@n2.nabble.com>
Message-ID: <1386361659970-7585296.post@n2.nabble.com>

Thanks Tom and Josh,  I'll take a look at ratify, it looks like exactly what
I was looking for.  The raster package is great! :)  I love R so much...

Bastien




--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Attach-metadata-to-raster-object-tp7585254p7585296.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From rahmannorthampton at gmail.com  Fri Dec  6 22:04:42 2013
From: rahmannorthampton at gmail.com (Lutfor)
Date: Fri, 6 Dec 2013 13:04:42 -0800 (PST)
Subject: [R-sig-Geo] mcp calculation
In-Reply-To: <52967ED0.2090306@ase-research.org>
References: <1385591474760-7585219.post@n2.nabble.com>
	<52967ED0.2090306@ase-research.org>
Message-ID: <1386363882098-7585297.post@n2.nabble.com>

Dear Mathieu,
Thanks for extending your kind help.
It works perfect with the example data.
However, I had difficulty when I wanted to use following data unless I
converted x, y corordinates to spatial data by the command of
SpatialPointsDataFrame. Please see commands below. I wonder is there any
other way to calculate MCP without converting SpatialPointsDataFrame. 

mcpdata1<-read.csv("DataMCPKernel.csv",header=T)
attach(mcpdata1)
XY=mcpdata1[,c("x","y")]
#Convering your coordinates to spatial data
*rel2<-SpatialPointsDataFrame(XY, data=mcpdata1)*
cp2 <- mcp(rel2[,1], percent=100)
as.data.frame(cp2)
mcp.area(rel2[,1])

Data: 

Stage	x	y
incubation	646395.1	5213765
incubation	646395.1	5213765
incubation	646395.1	5213765
incubation	646395.1	5213765
incubation	646382.9	5213765
incubation	646395.1	5213765
incubation	646238.7	5213946
incubation	646531.6	5213897
incubation	646408	5213765
incubation	646395.1	5213765
incubation	646395.1	5213765

Kind regards
Lutfor



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/mcp-calculation-tp7585219p7585297.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From sarah.goslee at gmail.com  Fri Dec  6 22:18:27 2013
From: sarah.goslee at gmail.com (Sarah Goslee)
Date: Fri, 6 Dec 2013 16:18:27 -0500
Subject: [R-sig-Geo] mcp calculation
In-Reply-To: <1386363882098-7585297.post@n2.nabble.com>
References: <1385591474760-7585219.post@n2.nabble.com>
	<52967ED0.2090306@ase-research.org>
	<1386363882098-7585297.post@n2.nabble.com>
Message-ID: <CAM_vjunFdC8tmnhi=dmzQqm-ng0G1C6hdniPxh+=XG_NfefM1Q@mail.gmail.com>

Hi,

On Fri, Dec 6, 2013 at 4:04 PM, Lutfor <rahmannorthampton at gmail.com> wrote:
> Dear Mathieu,

I have no idea who Mathieu is: you sent this message to the entire
r-sig-geo list, if by way of the horrid nabble "interface."

> Thanks for extending your kind help.
> It works perfect with the example data.
> However, I had difficulty when I wanted to use following data unless I
> converted x, y corordinates to spatial data by the command of
> SpatialPointsDataFrame. Please see commands below. I wonder is there any
> other way to calculate MCP without converting SpatialPointsDataFrame.
>
> mcpdata1<-read.csv("DataMCPKernel.csv",header=T)
> attach(mcpdata1)
> XY=mcpdata1[,c("x","y")]
> #Convering your coordinates to spatial data
> *rel2<-SpatialPointsDataFrame(XY, data=mcpdata1)*
> cp2 <- mcp(rel2[,1], percent=100)
> as.data.frame(cp2)
> mcp.area(rel2[,1])

You don't say, but I'm assuming you are using the package
adehabitatHR. It's very important to tell us where you get your
functions from.

If you read the help for mcp.area, you will see:

Arguments

xy An object inheriting the class SpatialPoints containing the x and y
relocations of the animal. If xy inherits the class
SpatialPointsDataFrame, it should contain only one column (a factor)
corresponding to the identity of the animals for each relocation.

So yes, you need a Spatial object. There are other advantages to
Spatial objects, though.

This might be a slightly less convoluted approach:
mcpdata1 <-  structure(list(Stage = structure(c(1L, 1L, 1L, 1L, 1L, 1L, 1L,
1L, 1L, 1L, 1L), .Label = "incubation", class = "factor"), x = c(646395.1,
646395.1, 646395.1, 646395.1, 646382.9, 646395.1, 646238.7, 646531.6,
646408, 646395.1, 646395.1), y = c(5213765L, 5213765L, 5213765L,
5213765L, 5213765L, 5213765L, 5213946L, 5213897L, 5213765L, 5213765L,
5213765L)), .Names = c("Stage", "x", "y"), class = "data.frame",
row.names = c(NA,
-11L))

library(adehabitatHR)

rel2 <- mcpdata1
coordinates(rel2) <- ~x + y

cp2 <- mcp(rel2, percent=100)
mcp.area(rel2)

Sarah

> Data:
>
> Stage   x       y
> incubation      646395.1        5213765
> incubation      646395.1        5213765
> incubation      646395.1        5213765
> incubation      646395.1        5213765
> incubation      646382.9        5213765
> incubation      646395.1        5213765
> incubation      646238.7        5213946
> incubation      646531.6        5213897
> incubation      646408  5213765
> incubation      646395.1        5213765
> incubation      646395.1        5213765
>
> Kind regards
> Lutfor
>
>
>

-- 
Sarah Goslee
http://www.functionaldiversity.org


From Roger.Bivand at nhh.no  Sat Dec  7 19:18:01 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 7 Dec 2013 19:18:01 +0100
Subject: [R-sig-Geo] Strange lines when projecting a world map
In-Reply-To: <1386342530.65274.YahooMailNeo@web172502.mail.ir2.yahoo.com>
References: <1386236376.47715.YahooMailNeo@web172505.mail.ir2.yahoo.com>
	<alpine.LRH.2.03.1312052114530.23791@reclus.nhh.no>
	<1386278780.80935.YahooMailNeo@web172504.mail.ir2.yahoo.com>
	<alpine.LRH.2.03.1312052337330.24165@reclus.nhh.no>
	<1386342530.65274.YahooMailNeo@web172502.mail.ir2.yahoo.com>
Message-ID: <alpine.LRH.2.03.1312071854160.7125@reclus.nhh.no>

On Fri, 6 Dec 2013, Francesco Carotenuto wrote:

> Roger you are right, my explanation is still a bit confusing. Keeping 
> apart the automatic procedure, that is not so much important now, the 
> real problem, as you said, is only aesthetic. When the dataset is 
> worldwide distributed, I don't need to change the default longitude, but 
> when, for instance, I have to consider a dataset distributed in Africa 
> and the whole Eurasia, I need to focus my study on the particular 
> distribution of the data. The grid itself is used to sample values in 
> each cell from a points distribution and, to keep constant the sampling 
> power, I need an equal area projection that can fit well this so huge 
> geographical extent. But in this procedure I don't need ?a projected map 
> of the word. The process of intersecting the grid by using the world map 
> is only an aesthetic need to better interpret (and submit) the results 
> of the interpolation.

If you don't need the whole world, then it may make sense to project just 
the continents you do need, avoiding the lines running across the "back" 
of the map. Using wrld_simpl:

library(maptools)
data(wrld_simpl)
EAAw <- wrld_simpl[wrld_simpl$REGION==2 | wrld_simpl$REGION==142 |
  wrld_simpl$REGION==150,]
library(rgdal)
EAAwmoll <- spTransform(EAAw, CRS("+proj=moll +lon_0=66"))
plot(EAAwmoll)

or:

library(rworldmap)
data(countriesCoarse)
EAA <- countriesCoarse[grep("Asia|Europe|Africa", countriesCoarse$GBD),]
library(rgdal)
EAAmoll <- spTransform(EAA, CRS("+proj=moll +lon_0=66"))
plot(EAAmoll)

Both of these give Eurasia+Africa maps that can be projected without the 
stripe artefacts. I suggest doing this, and staying global on +lon_0=0 for 
the global datasets. The rworldmap package is better supported than the 
wrld_simpl dataset in maptools. All of them have geometry issues probably 
introduced under line generalisation from detailed coastlines. It may be 
possible to use maptools::Rgshhs() as an alternative, but here there are 
no country polygons.

Hope this helps,

Roger

> As you can see in the attached figure, the

PS. Your reply didn't reach the list, possibly because of a large 
attachment. On the list, it is best not to attach anything, but to provide 
a link to where the material can be accessed (3000 subscribers are not 
equally interested in all topics).

> interpolation output is difficult to interpret because you can?t 
> understand where are African data and Eurasian ones (the example A in 
> the figure). In the panel C of the same figure I removed the sea portion 
> by intersecting the grid with the world map and this process produces 
> the problem we are talking about. In the panel B I can simply overlap 
> the grid and the world map but the ?strange lines? are still there. I 
> could manage the output in the panel A of the figure externally, by 
> using image or gis softwares, but as I?m creating a script that allows 
> one to perform automatically analyses like this, I?d like to provide the 
> users a "finished result". Honestly, the polygons of the states are not 
> necessary because these are pure "macroecological" analyses and I don't 
> need political boundaries, but I really need the continental ones and to 
> exclude sea/ocean portions correctly.
>
> ?
> Dr. Francesco Carotenuto (Ph.D.)
> Department of Earth Sciences
> Federico II University
> Largo S. Marcellino 10,
> 80138 NAPLES (ITALY)
> http://francesco-carotenuto.blogspot.it/
> http://3dpaleontology.blogspot.it/?
>
>
>
> Il Gioved? 5 Dicembre 2013 23:58, Roger Bivand <Roger.Bivand at nhh.no> ha scritto:
> 
> On Thu, 5 Dec 2013, Francesco Carotenuto wrote:
>
>> Thank you for the answer. The object is the prediction location in an 
>> interpolation process. The function of "overlay" is involved in an 
>> automatic process and the longitude (and the kind of projection too) can 
>> change according to the dataset that is, in some cases, worldwide 
>> distributed.
>
> This doesn't help much - do you mean that the grid is of prediction 
> locations? Are the polygons used for anything other than visualization? If 
> you change the visualization projection (shifting the meridian (+lon_0) 
> for worldwide distributions) repeatedly, you will have to clip to suit. If 
> visualization, does it make sense to modify the meridian (the reader may 
> see the shifts as confusing)?
>
> You are trying to deal with multiple somethings that you are interpolating 
> (to a grid?) and displaying in possibly different windows possibly 
> depending on the extent of the prediction grid. Your workflow isn't 
> obvious.
>
> You haven't explained why you need the projection so far (other than 
> aesthetics, maybe?). You may be able to interpolate on the sphere, so 
> unless the target grid cells must be of fixed area - and possibly not even 
> then, you don't need to make life complicated. There are problems in 
> creating global visualizations in any case, as the lines/polygons need 
> clipping at +/- 180 degrees from the meridian.
>
> Roger
>
>>
>>
>> ?
>> Dr. Francesco Carotenuto (Ph.D.)
>> Department of Earth Sciences
>> Federico II University
>> Largo S. Marcellino 10,
>> 80138 NAPLES (ITALY)
>> http://francesco-carotenuto.blogspot.it/
>> http://3dpaleontology.blogspot.it/?
>>
>>
>>
>> Il Gioved? 5 Dicembre 2013 21:23, Roger Bivand <Roger.Bivand at nhh.no> ha scritto:
>> 
>> On Thu, 5 Dec 2013, Francesco Carotenuto wrote:
>>
>>> Dear list, as in
>>> the title, I found that when projecting a world map by mollweide projection and
>>> setting a?? longitude value, some strange
>>> parallels are drawn. The real problem is that these lines ???interact??? with a
>>> raster when performing the ???over??? function.
>>> How can I manage
>>> it?
>>
>> The underlying question is what you want to do with the objects after 
>> projection. The problem in your example is that some polygons/lines cross 
>> -180+66 degrees, so get reflected back across. A possible solution is to 
>> clip the polygons before projection at -180+66 degrees +/- a small number, 
>> but before looking at this in more detail, I need to know what the 
>> projected object is intended for. When +lon_0=0, there is no such effect, 
>> as this data set is clipped at -180 already.
>>
>> Roger
>>
>>
>>> Here I provide a
>>> simulated example to let you understand what I mean
>>> Thanks.??
>>>
>>>
>>> #Example of a
>>> world map mollweide projection with a specific longitude value
>>> library(sp)
>>> library(maptools)
>>> library(rgdal)
>>> data(wrld_simpl)
>>> w_pol<-wrld_simpl
>>> w_pol<-spTransform(w_pol,
>>> CRS("+proj=moll +lon_0=66"))
>>> plot(w_pol)
>>> ??
>>> # Intersecting a
>>> grid with the projected world map
>>> gr<-expand.grid(x
>>> = seq(-180, 180, length.out = 100), y = seq(-90, 90, length.out = 100))
>>> coordinates(gr)<-~x+y
>>> proj4string(gr)<-CRS("+proj=longlat
>>> +ellps=WGS84 +datum=WGS84 +no_defs")
>>> gr<-spTransform(gr,
>>> CRS("+proj=moll +lon_0=66"))
>>> plot(gr[w_pol,])
>>> ??
>>>
>>> ??
>>> Dr. Francesco Carotenuto (Ph.D.)
>>> Department of Earth Sciences
>>> Federico II University
>>> Largo S. Marcellino 10,
>>> 80138 NAPLES (ITALY)
>>> http://francesco-carotenuto.blogspot.it/
>>> http://3dpaleontology.blogspot.it/??
>>> ??? [[alternative HTML version deleted]]
>>>
>>>
>>
>> -- 
>> Roger Bivand
>> Department of Economics, Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>
>>
>
> -- 
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From HodgessE at uhd.edu  Sat Dec  7 20:18:37 2013
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Sat, 7 Dec 2013 19:18:37 +0000
Subject: [R-sig-Geo] another covariance matrix question
Message-ID: <FF9DB805FC41CC4E95825A50F680630217ACD491@challenger.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131207/a8b85896/attachment.pl>

From carotenuto_francesco at yahoo.it  Sat Dec  7 22:21:11 2013
From: carotenuto_francesco at yahoo.it (Francesco Carotenuto)
Date: Sat, 7 Dec 2013 21:21:11 +0000 (GMT)
Subject: [R-sig-Geo] Strange lines when projecting a world map
In-Reply-To: <alpine.LRH.2.03.1312071854160.7125@reclus.nhh.no>
References: <1386236376.47715.YahooMailNeo@web172505.mail.ir2.yahoo.com>
	<alpine.LRH.2.03.1312052114530.23791@reclus.nhh.no>
	<1386278780.80935.YahooMailNeo@web172504.mail.ir2.yahoo.com>
	<alpine.LRH.2.03.1312052337330.24165@reclus.nhh.no>
	<1386342530.65274.YahooMailNeo@web172502.mail.ir2.yahoo.com>
	<alpine.LRH.2.03.1312071854160.7125@reclus.nhh.no>
Message-ID: <1386451271.14817.YahooMailNeo@web172501.mail.ir2.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131207/affc385f/attachment.pl>

From mauriziomarchi85 at gmail.com  Sun Dec  8 00:21:45 2013
From: mauriziomarchi85 at gmail.com (Maurizio Marchi)
Date: Sun, 8 Dec 2013 00:21:45 +0100
Subject: [R-sig-Geo] Problem converting shp ED50 to WGS84 with spTransform
	and writeOGR
Message-ID: <CANJhsN1TsZjQtRjf7U0vH-093PyWmBuDFrUUNs0WWXg-C5ugcQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131208/2044ee4d/attachment.pl>

From madiazl at gmail.com  Sun Dec  8 18:45:42 2013
From: madiazl at gmail.com (Andres Diaz)
Date: Sun, 8 Dec 2013 18:45:42 +0100
Subject: [R-sig-Geo] R and MS SQL Spatial
In-Reply-To: <11693D5D-1F5E-420F-A833-5B208A29882D@gmail.com>
References: <CACgt3o=7WRCwj+7ojQcLgVg-DrCrFQm3whEemBsuOwCdUKORaQ@mail.gmail.com>
	<CAMXOh=0QtH8BikHcA4BCRGzOhjmdboAuW2tov0-hgtwVLcsiXw@mail.gmail.com>
	<11693D5D-1F5E-420F-A833-5B208A29882D@gmail.com>
Message-ID: <CAMXOh=3zUf0147XOo60tEDK36V_-RDpN0Pfy=HOGP0ebO0t_3Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131208/da850844/attachment.pl>

From eddieatr at gmail.com  Sun Dec  8 20:22:50 2013
From: eddieatr at gmail.com (Eddie Smith)
Date: Sun, 8 Dec 2013 19:22:50 +0000
Subject: [R-sig-Geo] Error in writeRaster as IDRISI(rst) file
Message-ID: <CABaJH7_LeojpiH=8Bdc6EnXbHp7h76HMiyty56SYKXtZzK7sOQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131208/16181823/attachment.pl>

From dicko.ahmadou at gmail.com  Sun Dec  8 20:46:50 2013
From: dicko.ahmadou at gmail.com (Ahmadou Dicko)
Date: Sun, 8 Dec 2013 19:46:50 +0000
Subject: [R-sig-Geo] Error in writeRaster as IDRISI(rst) file
In-Reply-To: <CABaJH7_LeojpiH=8Bdc6EnXbHp7h76HMiyty56SYKXtZzK7sOQ@mail.gmail.com>
References: <CABaJH7_LeojpiH=8Bdc6EnXbHp7h76HMiyty56SYKXtZzK7sOQ@mail.gmail.com>
Message-ID: <CAP8THHVrzmN4tUrukYHM9J3SrUk4kxw58_Z6H74w8saOb9x5Jw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131208/9cedec9a/attachment.pl>

From dicko.ahmadou at gmail.com  Sun Dec  8 20:51:18 2013
From: dicko.ahmadou at gmail.com (Ahmadou Dicko)
Date: Sun, 8 Dec 2013 19:51:18 +0000
Subject: [R-sig-Geo] Error in writeRaster as IDRISI(rst) file
In-Reply-To: <CAP8THHVrzmN4tUrukYHM9J3SrUk4kxw58_Z6H74w8saOb9x5Jw@mail.gmail.com>
References: <CABaJH7_LeojpiH=8Bdc6EnXbHp7h76HMiyty56SYKXtZzK7sOQ@mail.gmail.com>
	<CAP8THHVrzmN4tUrukYHM9J3SrUk4kxw58_Z6H74w8saOb9x5Jw@mail.gmail.com>
Message-ID: <CAP8THHVAxwj2fU91=abQCUsdLRfZKokdAYMHke8XZxgPs5HXEA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131208/3abdbcc4/attachment.pl>

From eddieatr at gmail.com  Sun Dec  8 21:10:05 2013
From: eddieatr at gmail.com (Eddie Smith)
Date: Sun, 8 Dec 2013 20:10:05 +0000
Subject: [R-sig-Geo] Error in writeRaster as IDRISI(rst) file
In-Reply-To: <CAP8THHVAxwj2fU91=abQCUsdLRfZKokdAYMHke8XZxgPs5HXEA@mail.gmail.com>
References: <CABaJH7_LeojpiH=8Bdc6EnXbHp7h76HMiyty56SYKXtZzK7sOQ@mail.gmail.com>
	<CAP8THHVrzmN4tUrukYHM9J3SrUk4kxw58_Z6H74w8saOb9x5Jw@mail.gmail.com>
	<CAP8THHVAxwj2fU91=abQCUsdLRfZKokdAYMHke8XZxgPs5HXEA@mail.gmail.com>
Message-ID: <CABaJH78TpWpN==HuJVqn_BOqH0OqK8ppd8CAr82FPEC_61ONfw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131208/c73918f7/attachment.pl>

From edzer.pebesma at uni-muenster.de  Sun Dec  8 21:16:57 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sun, 08 Dec 2013 21:16:57 +0100
Subject: [R-sig-Geo] another covariance matrix question
In-Reply-To: <FF9DB805FC41CC4E95825A50F680630217ACD491@challenger.uhd.campus>
References: <FF9DB805FC41CC4E95825A50F680630217ACD491@challenger.uhd.campus>
Message-ID: <52A4D3B9.7060709@uni-muenster.de>



On 12/07/2013 08:18 PM, Hodgess, Erin wrote:
> Hi again.
> 
> I have a question about covariance matrices (again)
> 
> Suppose we have an exponential model with c=2 and a=3.
> 
> Then for
> 
> c_{ij} = c exp(-h_{ij}/a),
> when i=j,
> we should have:
> c_{ii} = 2 exp(0) = 2
> 
> But shouldn't c_{ii} = 1, please?

No, the covariance matrix has variances on the diagional, the
correlation matrix has 1 on the diagonal.

> 
> Thanks,
> Erin
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795


From eddieatr at gmail.com  Sun Dec  8 21:36:18 2013
From: eddieatr at gmail.com (Eddie Smith)
Date: Sun, 8 Dec 2013 20:36:18 +0000
Subject: [R-sig-Geo] Error in writeRaster as IDRISI(rst) file
In-Reply-To: <CABaJH78TpWpN==HuJVqn_BOqH0OqK8ppd8CAr82FPEC_61ONfw@mail.gmail.com>
References: <CABaJH7_LeojpiH=8Bdc6EnXbHp7h76HMiyty56SYKXtZzK7sOQ@mail.gmail.com>
	<CAP8THHVrzmN4tUrukYHM9J3SrUk4kxw58_Z6H74w8saOb9x5Jw@mail.gmail.com>
	<CAP8THHVAxwj2fU91=abQCUsdLRfZKokdAYMHke8XZxgPs5HXEA@mail.gmail.com>
	<CABaJH78TpWpN==HuJVqn_BOqH0OqK8ppd8CAr82FPEC_61ONfw@mail.gmail.com>
Message-ID: <CABaJH7-D5pjBC3nAsF2Zaqd4teMKHGjxbvQC_Q3sw2htz-R51Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131208/6b8bf370/attachment.pl>

From HodgessE at uhd.edu  Sun Dec  8 22:50:33 2013
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Sun, 8 Dec 2013 21:50:33 +0000
Subject: [R-sig-Geo] another covariance matrix question
In-Reply-To: <52A4D3B9.7060709@uni-muenster.de>
References: <FF9DB805FC41CC4E95825A50F680630217ACD491@challenger.uhd.campus>,
	<52A4D3B9.7060709@uni-muenster.de>
Message-ID: <FF9DB805FC41CC4E95825A50F680630217ACF12F@challenger.uhd.campus>

Eeek!  I can't believe it.  Thanks so much!

________________________________________
From: r-sig-geo-bounces at r-project.org [r-sig-geo-bounces at r-project.org] on behalf of Edzer Pebesma [edzer.pebesma at uni-muenster.de]
Sent: Sunday, December 08, 2013 2:16 PM
To: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] another covariance matrix question

On 12/07/2013 08:18 PM, Hodgess, Erin wrote:
> Hi again.
>
> I have a question about covariance matrices (again)
>
> Suppose we have an exponential model with c=2 and a=3.
>
> Then for
>
> c_{ij} = c exp(-h_{ij}/a),
> when i=j,
> we should have:
> c_{ii} = 2 exp(0) = 2
>
> But shouldn't c_{ii} = 1, please?

No, the covariance matrix has variances on the diagional, the
correlation matrix has 1 on the diagonal.

>
> Thanks,
> Erin
>
>
>       [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

--
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From ROONEYJ4 at tcd.ie  Mon Dec  9 13:05:24 2013
From: ROONEYJ4 at tcd.ie (James Rooney)
Date: Mon, 9 Dec 2013 12:05:24 +0000
Subject: [R-sig-Geo] add image to plot
Message-ID: <75C8D19A1470D344A8AF5312F01160A602BBB78CFE2C@GOMAIL.college.tcd.ie>

Hi all,

I need to add a logo to a plot. I have the logo in eps and jpg formats though can convert it to something else if needed.
My preference is to use the eps version since I am plotting my graphs to an eps file.
However I'm having a problem - with grImport - it is not detecting all the features of the image (not picking up colours and missing internal features of plot.

My code is thus:

PostScriptTrace("LogoLarge.eps")
logo<-readPicture("LogoLarge.eps.xml")

Does anyone know why it is not catching all features of the image ?
Any other way of doing is ?

James

From etiennebr at gmail.com  Mon Dec  9 14:01:36 2013
From: etiennebr at gmail.com (Etienne B. Racine)
Date: Mon, 9 Dec 2013 08:01:36 -0500
Subject: [R-sig-Geo] Attach metadata to raster object
In-Reply-To: <CALyPt8x93g3DLri7D=vaKYKsrfzphZ3DPVejMTKFAxJ2WLtbXw@mail.gmail.com>
References: <CALjAYt7w=7quTkqN=VEpwDE5EiCQafCqtS_3sr3F8EFO1eUsag@mail.gmail.com>
	<1386337348994-7585290.post@n2.nabble.com>
	<CALyPt8x93g3DLri7D=vaKYKsrfzphZ3DPVejMTKFAxJ2WLtbXw@mail.gmail.com>
Message-ID: <CALjAYt4dyxuj-SHthC_aDsNTLMZh4m_jfkKj6q=7ARDBE202rg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131209/55a508d0/attachment.pl>

From albin.blaschka at standortsanalyse.net  Mon Dec  9 14:51:09 2013
From: albin.blaschka at standortsanalyse.net (Albin Blaschka)
Date: Mon, 09 Dec 2013 14:51:09 +0100
Subject: [R-sig-Geo] Taking elevation into account when calculating
	distance
In-Reply-To: <CANVKczMh_F3u3t-Oy0414LMMpJQnDgKiywnwGYJZCV-7dqQj=Q@mail.gmail.com>
References: <CAOPvn+i-TCbmF7STCQho4Pwz8gTXrPDTQR48mRyt_QAYCoPL5Q@mail.gmail.com>	<CAEBQMMkNSmjui_E=Dhsxqc5JShXTEDyVPmBw-0UHKySYMb9LAw@mail.gmail.com>	<c2ce1ccbcf2f428dacd42c045c25086b@EX-1-HT0.lancs.local>
	<CANVKczMh_F3u3t-Oy0414LMMpJQnDgKiywnwGYJZCV-7dqQj=Q@mail.gmail.com>
Message-ID: <52A5CACD.9030706@standortsanalyse.net>

Hello!

I had the same problem and took the following approximation:

I had a DEM and calculated the slope in a GIS. Then, I took the 
resulting raster and trigonometric functions:

if your raster resolution / cell size is 20m, then the "surface 
distance" is

20/cos(slope)

Caveat: R ist calculating cosinus in radians, if you have degrees you 
have to convert it:

1 Degree = 0.017453292519943 rad

I read the slope raster into R, calculated this approximation and wrote 
a new raster file with this "surface distance"...

It is an approximation, as the distance is only valid either in strict 
x- or y- direction, but for my use (and raster resolution) this is ok 
and a certain rasterization is given if you use a rester dataset...

Hope this helps!
Albin






Am 06.12.2013 19:56, schrieb Barry Rowlingson:
> On Fri, Dec 6, 2013 at 3:49 PM, John Tellat <john.tellat at gmail.com> wrote:
>
>> But it gives me 0.15m, which is not really the expected distance ...
>
>   I get:
>
>   > costDistance(tr1, cc)
>             A
>   B 0.01137836
>
> But I'm not sure this is the right thing to do. The transition matrix
> cost-distance approach only works on the cell level, so the distance
> from the bottom left corner of your lower cell to the to right point
> of your upper cell will be the same as from the two corners nearest
> each other in that cell. (I think).
>
> What's the distance from the bottom to the top of the stairs in my
> house? For me its Pythagoras, sqrt(dx^2 + dy^2), but for a spider its
> dx+dy - it has to crawl across every tread and up every riser.
>
>   At first I thought the problem could be solved by taking the profile
> of the path between the start and end points and taking the length of
> that, but you have to sample the profile at a resolution, and if you
> use a fine resolution you get the "spider" result and if you use a
> large resolution you get the "human" result.
>
>   You'll maybe get a better answer if you can treat your raster as a
> continuous smooth surface, then the length of the profile should be
> stable as you increase the resolution and not tend to dx+dy. But the
> fundamental problem is that your raster is a discrete model of a
> continuous reality [1] so any distances are going to be
> approximations...
>
>   This must be a GIS research question with some literature behind it...
>
> Barry
>
> [1] okay, lets argue if reality is continuous, discrete, fractal or
> quantum string soup some other time!
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
| Albin Blaschka, Mag.rer.nat.
| Etrichstrasse 26, A-5020 Salzburg
| * www.albinblaschka.info *
| * www.researchgate.net/profile/Albin_Blaschka *
| - It's hard to live in the mountains, hard but not hopeless!


From alobolistas at gmail.com  Mon Dec  9 16:52:37 2013
From: alobolistas at gmail.com (Agustin Lobo)
Date: Mon, 9 Dec 2013 16:52:37 +0100
Subject: [R-sig-Geo] contours in SpatialPixelsDataFrame
Message-ID: <CAG4NReKBY2gLGDJQseZWU5S4=+yb5q8yK8S0+LCs-+P4SKOQAg@mail.gmail.com>

I have a set of regularly distributed points (a grid) as a SpatialPoints DF.
In order to display the distribution of a continuos varaible in the data table,
I transform to SpatialPixelsDataFrame (using gridded(a) <- TRUE)
and after calculating the dimensions of the grid I use rasterize() to convert
to raster and then use rasterVIS::levelplot()

My question is, can equivalent contours be drawn directely on the
SpatialPixelsDataFrame object
to skip the tansform to raster?
I've tried with spplot(), but get filled intervals, not line contours.

Thanks

Agus


From alobolistas at gmail.com  Mon Dec  9 18:53:48 2013
From: alobolistas at gmail.com (Agustin Lobo)
Date: Mon, 9 Dec 2013 18:53:48 +0100
Subject: [R-sig-Geo] ggmap::fortify()
Message-ID: <CAG4NRe+GYy6zcDQjzSXB4Pyyo9bdoSax-HiTXzMJrL3cTetimA@mail.gmail.com>

Does anyone know why function fortify() (to be run before plotting the
object with qmap) accepts spatial polygons DF and not
spatial points DF or spatial pixels DF?
Thanks

Agus


From alobolistas at gmail.com  Mon Dec  9 19:00:47 2013
From: alobolistas at gmail.com (Agustin Lobo)
Date: Mon, 9 Dec 2013 19:00:47 +0100
Subject: [R-sig-Geo] Use a PNG image as background for lattice plotting
 with rasterVis
In-Reply-To: <CAMLL7bnf+wM7vU5GbUSi=+Ytn4ZY39tbOWCtb09rh_W=ghH6Bw@mail.gmail.com>
References: <A632B3F93D861843A3C966F3962C3F840148B25E94E3@EMAIL05.pnl.gov>
	<CAMLL7bnf+wM7vU5GbUSi=+Ytn4ZY39tbOWCtb09rh_W=ghH6Bw@mail.gmail.com>
Message-ID: <CAG4NReLSUQRcdvkS3dmjXMyQ_2KXVV08_eY8u6Ov+VGMRvxk-g@mail.gmail.com>

Is it possible to get just the contours on top of the gmap?
If I use levelplot(...,contour=TRUE,...) I get the contours but
the filled levels as well.
Thanks
Agus

On Sat, Oct 19, 2013 at 10:05 AM, Oscar Perpi?an
<oscar.perpinan at gmail.com> wrote:
> Hello,
>
> Let's suppose that 'gmap' is the image resulting from a GetMap.bbox() call
> and 'r' is your Raster*.  A suitable solution is:
>
> library(rasterVis)
>
> levelplot(r) + layer_(grid.raster(gmap,
>                                                              x=lonCenter,
> y=latCenter,
>                                                              width=width,
> height=height,
>
> default.units='native'))
>
> The 'lonCenter', 'latCenter', 'width' and 'height' parameters have to be
> extracted from the image attributes. In the next links you will find an
> example using ggmap (which is built upon RgoogleMaps). Between lines 17 and
> 25 you will find details to extract them:
>
> https://gist.github.com/oscarperpinan/5451682
> http://procomun.wordpress.com/2013/04/24/stamen-maps-with-spplot/
>
> Perhaps you will have to play with the 'alpha' values to mix the result of
> levelplot and grid.raster.
>
> Best,
>
> Oscar Perpi??n Lamigueiro
> Grupo de Sistemas Fotovoltaicos (IES-UPM)
> Dpto. Ingenier?a El?ctrica (EUITI-UPM)
> URL: http://oscarperpinan.github.io
> Twitter: @oscarperpinan
> LinkedIn: http://es.linkedin.com/in/oscarperpinan
> El 18/10/2013 23:56, "Waichler, Scott R" <Scott.Waichler at pnnl.gov> escribi?:
>
>> Hi,
>>
>> I've learned the basics of using RgoogleMaps and rasterVis, and now I want
>> to combine their capabilities to use levelplot() with a georeferenced PNG
>> image as a background in the lattice panel.  And, I want to plot to the
>> normal R graphics devices, not the web as package plotGoogleMaps does.  Can
>> anyone provide an example of how to use the result of RgoogleMaps'
>> GetMap.bbox() as a background image in a plot produced with the rasterVis
>> version of lattice graphics?
>>
>> Thanks,
>> Scott Waichler
>> Pacific Northwest National Laboratory
>> Richland, WA USA
>> scott.waichler at pnnl.gov
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>         [[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From edzer.pebesma at uni-muenster.de  Mon Dec  9 19:11:14 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 09 Dec 2013 19:11:14 +0100
Subject: [R-sig-Geo] ggmap::fortify()
In-Reply-To: <CAG4NRe+GYy6zcDQjzSXB4Pyyo9bdoSax-HiTXzMJrL3cTetimA@mail.gmail.com>
References: <CAG4NRe+GYy6zcDQjzSXB4Pyyo9bdoSax-HiTXzMJrL3cTetimA@mail.gmail.com>
Message-ID: <52A607C2.6080800@uni-muenster.de>



On 12/09/2013 06:53 PM, Agustin Lobo wrote:
> Does anyone know why function fortify() (to be run before plotting the
> object with qmap) accepts spatial polygons DF and not
> spatial points DF or spatial pixels DF?
> Thanks

Have you asked the maintainer of ggmap? Or have you tried converting
objects of the latter two classes to data.frame?

> 
> Agus
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795


From b.rowlingson at lancaster.ac.uk  Mon Dec  9 19:18:46 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Mon, 9 Dec 2013 18:18:46 +0000
Subject: [R-sig-Geo] ggmap::fortify()
In-Reply-To: <8a98c38d326b4aba98c788243fc3200c@EX-1-HT0.lancs.local>
References: <8a98c38d326b4aba98c788243fc3200c@EX-1-HT0.lancs.local>
Message-ID: <CANVKczNAo=2hbE+3MruEO0BHypQ_C5eoUXoDXKG4PSzkpDr0ww@mail.gmail.com>

Because that's how it works.

ggplot likes to have everything in as long a data frame as possible,
rather than a wide data frame. So to plot some polygons with
geom_polygon, for example, you have to create a data frame with one
row per point, and each polygon has a separate id variable (see
?geom_polygon for example).

Same is true for ggmap - fortify puts all the coordinates of each
vector of every polygon into a data frame, adds an id variable and a
bunch of other things for the plot order and whether its a hole or not
etc. Then ggmap uses that to reconstruct the individual polygons to
draw them. Its the ggplot way. Stick everything into as long a data
frame as conceivably possible given the data. Once you realise that,
you'll start to 'get' ggplot.

If you want to use ggplot with SpatialPoints, just get the
coordinates(sppts) and turn into a data frame with x and y coords.

But essentially I don't think ggplot plays nicely with sp class objects.

You can't pass spatial*dataframes into ggplot even if you aren;t using
the spatial components, for example using the scot_BNG from ?readOGR:

It has X_COOR and Y_COOR attributes, lets try and plot those (you
could use any attributes, even non-spatial ones here)

 > ggplot(scot_BNG,aes(x=X_COOR,y=Y_COOR))+geom_point()
Regions defined for each Polygons
Error in eval(expr, envir, enclos) : object 'X_COOR' not found

 - basically it won't treat it like a vanilla data frame. I don't know
what its trying to do. It seems to have some idea that its got
polygons, but then it just gives up.

You have to convert to a plain vanilla data frame first:


 > scot_BNGd=data.frame(scot_BNG)
 > ggplot(scot_BNGd,aes(x=X_COOR,y=Y_COOR))+geom_point()

 - works

such is code.




On Mon, Dec 9, 2013 at 5:53 PM, Agustin Lobo <alobolistas at gmail.com> wrote:
> Does anyone know why function fortify() (to be run before plotting the
> object with qmap) accepts spatial polygons DF and not
> spatial points DF or spatial pixels DF?
> Thanks
>
> Agus
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From oscar.perpinan at gmail.com  Mon Dec  9 22:35:04 2013
From: oscar.perpinan at gmail.com (=?ISO-8859-1?Q?Oscar_Perpi=F1an?=)
Date: Mon, 9 Dec 2013 22:35:04 +0100
Subject: [R-sig-Geo] Use a PNG image as background for lattice plotting
 with rasterVis
In-Reply-To: <CAG4NReLSUQRcdvkS3dmjXMyQ_2KXVV08_eY8u6Ov+VGMRvxk-g@mail.gmail.com>
References: <A632B3F93D861843A3C966F3962C3F840148B25E94E3@EMAIL05.pnl.gov>
	<CAMLL7bnf+wM7vU5GbUSi=+Ytn4ZY39tbOWCtb09rh_W=ghH6Bw@mail.gmail.com>
	<CAG4NReLSUQRcdvkS3dmjXMyQ_2KXVV08_eY8u6Ov+VGMRvxk-g@mail.gmail.com>
Message-ID: <CAMLL7bnAdx5ihtEW5eomOKSzFRwATBq8_O=1t32TmOtdYOGpsg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131209/c3142861/attachment.pl>

From alobolistas at gmail.com  Tue Dec 10 08:56:09 2013
From: alobolistas at gmail.com (Agustin Lobo)
Date: Tue, 10 Dec 2013 08:56:09 +0100
Subject: [R-sig-Geo] ggmap::fortify()
In-Reply-To: <52A607C2.6080800@uni-muenster.de>
References: <CAG4NRe+GYy6zcDQjzSXB4Pyyo9bdoSax-HiTXzMJrL3cTetimA@mail.gmail.com>
	<52A607C2.6080800@uni-muenster.de>
Message-ID: <CAG4NReJf4dbrOtrrR+qFTEhgH7bJWhrYTpyPbK7S5sD1vpu2Eg@mail.gmail.com>

Not yet, I thought it made sense asking about it in this list first to
consider previous experiences (i.e., as described by Barry) and make
sure there were no
simple workarounds or details that I had overlooked.
I will do it now and CC to this list.
Agus

On Mon, Dec 9, 2013 at 7:11 PM, Edzer Pebesma
<edzer.pebesma at uni-muenster.de> wrote:
>
>
> On 12/09/2013 06:53 PM, Agustin Lobo wrote:
>> Does anyone know why function fortify() (to be run before plotting the
>> object with qmap) accepts spatial polygons DF and not
>> spatial points DF or spatial pixels DF?
>> Thanks
>
> Have you asked the maintainer of ggmap? Or have you tried converting
> objects of the latter two classes to data.frame?
>
>>
>> Agus
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> --
> Edzer Pebesma
> Institute for Geoinformatics (ifgi), University of M?nster
> Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
> 83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From alobolistas at gmail.com  Tue Dec 10 09:38:28 2013
From: alobolistas at gmail.com (Agustin Lobo)
Date: Tue, 10 Dec 2013 09:38:28 +0100
Subject: [R-sig-Geo] ggmap::fortify()
In-Reply-To: <CANVKczNAo=2hbE+3MruEO0BHypQ_C5eoUXoDXKG4PSzkpDr0ww@mail.gmail.com>
References: <8a98c38d326b4aba98c788243fc3200c@EX-1-HT0.lancs.local>
	<CANVKczNAo=2hbE+3MruEO0BHypQ_C5eoUXoDXKG4PSzkpDr0ww@mail.gmail.com>
Message-ID: <CAG4NRe+7oJj7dib1XGQipBWt9SLEqbni6uFiLCR+mKThnNdy6w@mail.gmail.com>

Thanks.

The example with an spatial polygons DF in p. 159 of
http://journal.r-project.org/archive/2013-1/kahle-wickham.pdf
works nicely.

Instead, fortify() refuses processing spatial poins or pixels DF
with an error:
Error: ggplot2 doesn't know how to deal with data of class
SpatialPixelsDataFrame

Based on what you say, using
adf <- dataframe(a)
where a is an spatial points DF in epsg 4326 (== CRS("+proj=longlat
+ellps=WGS84 +no_defs"))
results into a dataframe adf that is as the table of a but including
the coordinates as well.
Then doing the equivalent to that explained in the pdf for the
polygons seems to work.
It might be that for the case of spatial points DF, dataframe() is
enough and fortify() is just not required.

Agus



On Mon, Dec 9, 2013 at 7:18 PM, Barry Rowlingson
<b.rowlingson at lancaster.ac.uk> wrote:
> Because that's how it works.
>
> ggplot likes to have everything in as long a data frame as possible,
> rather than a wide data frame. So to plot some polygons with
> geom_polygon, for example, you have to create a data frame with one
> row per point, and each polygon has a separate id variable (see
> ?geom_polygon for example).
>
> Same is true for ggmap - fortify puts all the coordinates of each
> vector of every polygon into a data frame, adds an id variable and a
> bunch of other things for the plot order and whether its a hole or not
> etc. Then ggmap uses that to reconstruct the individual polygons to
> draw them. Its the ggplot way. Stick everything into as long a data
> frame as conceivably possible given the data. Once you realise that,
> you'll start to 'get' ggplot.
>
> If you want to use ggplot with SpatialPoints, just get the
> coordinates(sppts) and turn into a data frame with x and y coords.
>
> But essentially I don't think ggplot plays nicely with sp class objects.
>
> You can't pass spatial*dataframes into ggplot even if you aren;t using
> the spatial components, for example using the scot_BNG from ?readOGR:
>
> It has X_COOR and Y_COOR attributes, lets try and plot those (you
> could use any attributes, even non-spatial ones here)
>
>  > ggplot(scot_BNG,aes(x=X_COOR,y=Y_COOR))+geom_point()
> Regions defined for each Polygons
> Error in eval(expr, envir, enclos) : object 'X_COOR' not found
>
>  - basically it won't treat it like a vanilla data frame. I don't know
> what its trying to do. It seems to have some idea that its got
> polygons, but then it just gives up.
>
> You have to convert to a plain vanilla data frame first:
>
>
>  > scot_BNGd=data.frame(scot_BNG)
>  > ggplot(scot_BNGd,aes(x=X_COOR,y=Y_COOR))+geom_point()
>
>  - works
>
> such is code.
>
>
>
>
> On Mon, Dec 9, 2013 at 5:53 PM, Agustin Lobo <alobolistas at gmail.com> wrote:
>> Does anyone know why function fortify() (to be run before plotting the
>> object with qmap) accepts spatial polygons DF and not
>> spatial points DF or spatial pixels DF?
>> Thanks
>>
>> Agus
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From edzer.pebesma at uni-muenster.de  Tue Dec 10 09:44:36 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 10 Dec 2013 09:44:36 +0100
Subject: [R-sig-Geo] ggmap::fortify()
In-Reply-To: <CAG4NRe+7oJj7dib1XGQipBWt9SLEqbni6uFiLCR+mKThnNdy6w@mail.gmail.com>
References: <8a98c38d326b4aba98c788243fc3200c@EX-1-HT0.lancs.local>	<CANVKczNAo=2hbE+3MruEO0BHypQ_C5eoUXoDXKG4PSzkpDr0ww@mail.gmail.com>
	<CAG4NRe+7oJj7dib1XGQipBWt9SLEqbni6uFiLCR+mKThnNdy6w@mail.gmail.com>
Message-ID: <52A6D474.7060901@uni-muenster.de>



On 12/10/2013 09:38 AM, Agustin Lobo wrote:
> Thanks.
> 
> The example with an spatial polygons DF in p. 159 of
> http://journal.r-project.org/archive/2013-1/kahle-wickham.pdf
> works nicely.
> 
> Instead, fortify() refuses processing spatial poins or pixels DF
> with an error:
> Error: ggplot2 doesn't know how to deal with data of class
> SpatialPixelsDataFrame
> 
> Based on what you say, using
> adf <- dataframe(a)
> where a is an spatial points DF in epsg 4326 (== CRS("+proj=longlat
> +ellps=WGS84 +no_defs"))
> results into a dataframe adf that is as the table of a but including
> the coordinates as well.
> Then doing the equivalent to that explained in the pdf for the
> polygons seems to work.
> It might be that for the case of spatial points DF, dataframe() is
> enough and fortify() is just not required.

data.frame(), not dataframe()

for educational purposes, I'd prefer

as.data.frame(a)

# or

as(a, "data.frame")

> 
> Agus
> 
> 
> 
> On Mon, Dec 9, 2013 at 7:18 PM, Barry Rowlingson
> <b.rowlingson at lancaster.ac.uk> wrote:
>> Because that's how it works.
>>
>> ggplot likes to have everything in as long a data frame as possible,
>> rather than a wide data frame. So to plot some polygons with
>> geom_polygon, for example, you have to create a data frame with one
>> row per point, and each polygon has a separate id variable (see
>> ?geom_polygon for example).
>>
>> Same is true for ggmap - fortify puts all the coordinates of each
>> vector of every polygon into a data frame, adds an id variable and a
>> bunch of other things for the plot order and whether its a hole or not
>> etc. Then ggmap uses that to reconstruct the individual polygons to
>> draw them. Its the ggplot way. Stick everything into as long a data
>> frame as conceivably possible given the data. Once you realise that,
>> you'll start to 'get' ggplot.
>>
>> If you want to use ggplot with SpatialPoints, just get the
>> coordinates(sppts) and turn into a data frame with x and y coords.
>>
>> But essentially I don't think ggplot plays nicely with sp class objects.
>>
>> You can't pass spatial*dataframes into ggplot even if you aren;t using
>> the spatial components, for example using the scot_BNG from ?readOGR:
>>
>> It has X_COOR and Y_COOR attributes, lets try and plot those (you
>> could use any attributes, even non-spatial ones here)
>>
>>  > ggplot(scot_BNG,aes(x=X_COOR,y=Y_COOR))+geom_point()
>> Regions defined for each Polygons
>> Error in eval(expr, envir, enclos) : object 'X_COOR' not found
>>
>>  - basically it won't treat it like a vanilla data frame. I don't know
>> what its trying to do. It seems to have some idea that its got
>> polygons, but then it just gives up.
>>
>> You have to convert to a plain vanilla data frame first:
>>
>>
>>  > scot_BNGd=data.frame(scot_BNG)
>>  > ggplot(scot_BNGd,aes(x=X_COOR,y=Y_COOR))+geom_point()
>>
>>  - works
>>
>> such is code.
>>
>>
>>
>>
>> On Mon, Dec 9, 2013 at 5:53 PM, Agustin Lobo <alobolistas at gmail.com> wrote:
>>> Does anyone know why function fortify() (to be run before plotting the
>>> object with qmap) accepts spatial polygons DF and not
>>> spatial points DF or spatial pixels DF?
>>> Thanks
>>>
>>> Agus
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 555 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131210/e0ce42fb/attachment.bin>

From alobolistas at gmail.com  Tue Dec 10 11:36:28 2013
From: alobolistas at gmail.com (Agustin Lobo)
Date: Tue, 10 Dec 2013 11:36:28 +0100
Subject: [R-sig-Geo] image background for spplot of gridded data
In-Reply-To: <CAMLL7bnvgJ=f-F1MAeeyE-Tnhmzhf7mYqhHBAhOjuiDB+NTS9g@mail.gmail.com>
References: <A632B3F93D861843A3C966F3962C3F840148B3B6B674@EMAIL05.pnl.gov>
	<CAMLL7bnvgJ=f-F1MAeeyE-Tnhmzhf7mYqhHBAhOjuiDB+NTS9g@mail.gmail.com>
Message-ID: <CAG4NRe+OM-0C4KhjdbekDCLKpXbSHSpcqVJq+hPEfGdTH88v1A@mail.gmail.com>

and would it possible a similar plot using contourplot() (or
levelplot()) overlaid
on a gmap?

I've tried the equivalent to the
stamen.R function that you refer to:

contourplot(rinvmod2goog,zscaleLog=TRUE,
            at=my.at,colorkey=myColorkey,margin=FALSE,add=TRUE) +
  layer(grid.raster(gmap2,
                    x=lonCenter2, y=latCenter2,
                    width=width2, height=height2,
                    default.units='native'),under=TRUE)

and get no error but just the contour. I've tried with my object in
pseudomercator and "lon-lat" geographic coordinates:
rinvmod2goog <- projectRaster(from=rinvmod2, crs=CRS("+init=epsg:3857"))
rinvmod2lonlat <- projectRaster(from=rinvmod2, crs=CRS("+proj=longlat
+ellps=WGS84 +no_defs"))

both rinvmod2 and and gmap2 display fine independently.

Data:
https://dl.dropboxusercontent.com/u/3180464/rinvmod2.rda
https://dl.dropboxusercontent.com/u/3180464/gmap2.rda
(to be used with load())

Thanks

Agus

On Wed, Nov 20, 2013 at 6:47 PM, Oscar Perpi?an
<oscar.perpinan at gmail.com> wrote:
> Hi,
>
> For the sake of completeness: just a few days ago I received a comment
> to a post about spplot and ggmap
> (http://procomun.wordpress.com/2013/04/24/stamen-maps-with-spplot/).
> There I was using a SpatialPointsDataFrame object. Because of that
> comment I posted another example with SpatialPolygonsDataFrame:
> https://gist.github.com/oscarperpinan/7482848
>
> Best,
>
> Oscar.
> -----------------------------------------------------------------
> Oscar Perpi??n Lamigueiro
> Grupo de Sistemas Fotovoltaicos (IES-UPM)
> Dpto. Ingenier?a El?ctrica (ETSIDI-UPM)
> URL: http://oscarperpinan.github.io
> Twitter: @oscarperpinan
>
>
> 2013/11/20 Waichler, Scott R <Scott.Waichler at pnnl.gov>:
>> I was told, among other things, to look for previous messages by Oscar that would explain how to do this.  Here is Oscar's solution that I found to work for the case where you want to plot two rasters that have different extents.  In my case, gmap is a satellite image obtained with RgoogleMaps, and z are the results I want to plot over the background image.  I made the alpha values of z less than 1 so that the background image would show through.
>>
>> library(rasterVis)
>> levelplot(z~x*y) +
>> layer_(grid.raster(gmap, y=latCenter, width=width, height=height, default.units='native'))
>>
>> Scott Waichler
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From oscar.perpinan at gmail.com  Tue Dec 10 11:51:26 2013
From: oscar.perpinan at gmail.com (=?ISO-8859-1?Q?Oscar_Perpi=F1an?=)
Date: Tue, 10 Dec 2013 11:51:26 +0100
Subject: [R-sig-Geo] image background for spplot of gridded data
In-Reply-To: <CAG4NRe+OM-0C4KhjdbekDCLKpXbSHSpcqVJq+hPEfGdTH88v1A@mail.gmail.com>
References: <A632B3F93D861843A3C966F3962C3F840148B3B6B674@EMAIL05.pnl.gov>
	<CAMLL7bnvgJ=f-F1MAeeyE-Tnhmzhf7mYqhHBAhOjuiDB+NTS9g@mail.gmail.com>
	<CAG4NRe+OM-0C4KhjdbekDCLKpXbSHSpcqVJq+hPEfGdTH88v1A@mail.gmail.com>
Message-ID: <CAMLL7bmS0g2LxtQ0h9WHaQdtam_2R54bQpVMum3fFnq-VvK_Vw@mail.gmail.com>

It works for me using rinvmod2lonlat (long-lat coordinates).

Oscar.
-----------------------------------------------------------------
Oscar Perpi??n Lamigueiro
Grupo de Sistemas Fotovoltaicos (IES-UPM)
Dpto. Ingenier?a El?ctrica (ETSIDI-UPM)
URL: http://oscarperpinan.github.io
Twitter: @oscarperpinan


2013/12/10 Agustin Lobo <alobolistas at gmail.com>:
> and would it possible a similar plot using contourplot() (or
> levelplot()) overlaid
> on a gmap?
>
> I've tried the equivalent to the
> stamen.R function that you refer to:
>
> contourplot(rinvmod2goog,zscaleLog=TRUE,
>             at=my.at,colorkey=myColorkey,margin=FALSE,add=TRUE) +
>   layer(grid.raster(gmap2,
>                     x=lonCenter2, y=latCenter2,
>                     width=width2, height=height2,
>                     default.units='native'),under=TRUE)
>
> and get no error but just the contour. I've tried with my object in
> pseudomercator and "lon-lat" geographic coordinates:
> rinvmod2goog <- projectRaster(from=rinvmod2, crs=CRS("+init=epsg:3857"))
> rinvmod2lonlat <- projectRaster(from=rinvmod2, crs=CRS("+proj=longlat
> +ellps=WGS84 +no_defs"))
>
> both rinvmod2 and and gmap2 display fine independently.
>
> Data:
> https://dl.dropboxusercontent.com/u/3180464/rinvmod2.rda
> https://dl.dropboxusercontent.com/u/3180464/gmap2.rda
> (to be used with load())
>
> Thanks
>
> Agus
>
> On Wed, Nov 20, 2013 at 6:47 PM, Oscar Perpi?an
> <oscar.perpinan at gmail.com> wrote:
>> Hi,
>>
>> For the sake of completeness: just a few days ago I received a comment
>> to a post about spplot and ggmap
>> (http://procomun.wordpress.com/2013/04/24/stamen-maps-with-spplot/).
>> There I was using a SpatialPointsDataFrame object. Because of that
>> comment I posted another example with SpatialPolygonsDataFrame:
>> https://gist.github.com/oscarperpinan/7482848
>>
>> Best,
>>
>> Oscar.
>> -----------------------------------------------------------------
>> Oscar Perpi??n Lamigueiro
>> Grupo de Sistemas Fotovoltaicos (IES-UPM)
>> Dpto. Ingenier?a El?ctrica (ETSIDI-UPM)
>> URL: http://oscarperpinan.github.io
>> Twitter: @oscarperpinan
>>
>>
>> 2013/11/20 Waichler, Scott R <Scott.Waichler at pnnl.gov>:
>>> I was told, among other things, to look for previous messages by Oscar that would explain how to do this.  Here is Oscar's solution that I found to work for the case where you want to plot two rasters that have different extents.  In my case, gmap is a satellite image obtained with RgoogleMaps, and z are the results I want to plot over the background image.  I made the alpha values of z less than 1 so that the background image would show through.
>>>
>>> library(rasterVis)
>>> levelplot(z~x*y) +
>>> layer_(grid.raster(gmap, y=latCenter, width=width, height=height, default.units='native'))
>>>
>>> Scott Waichler
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From oscar.perpinan at upm.es  Tue Dec 10 12:04:55 2013
From: oscar.perpinan at upm.es (=?ISO-8859-1?Q?Oscar_Perpi=F1an?=)
Date: Tue, 10 Dec 2013 12:04:55 +0100
Subject: [R-sig-Geo] contours in SpatialPixelsDataFrame
In-Reply-To: <CAG4NReKBY2gLGDJQseZWU5S4=+yb5q8yK8S0+LCs-+P4SKOQAg@mail.gmail.com>
References: <CAG4NReKBY2gLGDJQseZWU5S4=+yb5q8yK8S0+LCs-+P4SKOQAg@mail.gmail.com>
Message-ID: <CAMLL7bkodAbM7m-FQMURQfFO19jawfTcgQqYWqwrbL6xKVD0Xw@mail.gmail.com>

Hi,

spplot for SpatialPixelsDataFrame is built upon lattice::levelplot.
Thus, you can use most of its arguments in spplot. For your problem
you have to set "contour=TRUE" and "region=FALSE". Moreover, you can
customize the labels with (surprise!) "labels". This is documented in
the help page of lattice::panel.levelplot:

library(sp)
data(meuse.grid)
m <- SpatialPixelsDataFrame(points = meuse.grid[c("x", "y")],
    data = meuse.grid)

spplot(m["dist"],
       contour=TRUE, region=FALSE,
       labels=list(cex=0.6))

Best,

Oscar.
-----------------------------------------------------------------
Oscar Perpi??n Lamigueiro
Dpto. Ingenier?a El?ctrica (ETSIDI-UPM)
Grupo de Sistemas Fotovoltaicos (IES-UPM)
URL: http://oscarperpinan.github.io
Twitter: @oscarperpinan


2013/12/9 Agustin Lobo <alobolistas at gmail.com>:
> I have a set of regularly distributed points (a grid) as a SpatialPoints DF.
> In order to display the distribution of a continuos varaible in the data table,
> I transform to SpatialPixelsDataFrame (using gridded(a) <- TRUE)
> and after calculating the dimensions of the grid I use rasterize() to convert
> to raster and then use rasterVIS::levelplot()
>
> My question is, can equivalent contours be drawn directely on the
> SpatialPixelsDataFrame object
> to skip the tansform to raster?
> I've tried with spplot(), but get filled intervals, not line contours.
>
> Thanks
>
> Agus
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From alobolistas at gmail.com  Tue Dec 10 13:59:29 2013
From: alobolistas at gmail.com (Agustin Lobo)
Date: Tue, 10 Dec 2013 13:59:29 +0100
Subject: [R-sig-Geo] image background for spplot of gridded data
In-Reply-To: <CAMLL7bmS0g2LxtQ0h9WHaQdtam_2R54bQpVMum3fFnq-VvK_Vw@mail.gmail.com>
References: <A632B3F93D861843A3C966F3962C3F840148B3B6B674@EMAIL05.pnl.gov>
	<CAMLL7bnvgJ=f-F1MAeeyE-Tnhmzhf7mYqhHBAhOjuiDB+NTS9g@mail.gmail.com>
	<CAG4NRe+OM-0C4KhjdbekDCLKpXbSHSpcqVJq+hPEfGdTH88v1A@mail.gmail.com>
	<CAMLL7bmS0g2LxtQ0h9WHaQdtam_2R54bQpVMum3fFnq-VvK_Vw@mail.gmail.com>
Message-ID: <CAG4NReL56jFzQRxn-xFmUxZByhFiTus_eR=h5-Q6XKj44fLYQQ@mail.gmail.com>

Yes, it does for me as well: I had messed with the parameters of the
map in the original function.
Here I've made a page showing what I do and what I get:
https://dl.dropboxusercontent.com/u/3180464/contourOngmap_log.html

Is it possible doing the reverse, overlaying the contour on top of the
map instead of putting the map under the contour?
I need the plume in the context of the country.

Agus


Agus

On Tue, Dec 10, 2013 at 11:51 AM, Oscar Perpi?an
<oscar.perpinan at gmail.com> wrote:
> It works for me using rinvmod2lonlat (long-lat coordinates).
>
> Oscar.
> -----------------------------------------------------------------
> Oscar Perpi??n Lamigueiro
> Grupo de Sistemas Fotovoltaicos (IES-UPM)
> Dpto. Ingenier?a El?ctrica (ETSIDI-UPM)
> URL: http://oscarperpinan.github.io
> Twitter: @oscarperpinan
>
>
> 2013/12/10 Agustin Lobo <alobolistas at gmail.com>:
>> and would it possible a similar plot using contourplot() (or
>> levelplot()) overlaid
>> on a gmap?
>>
>> I've tried the equivalent to the
>> stamen.R function that you refer to:
>>
>> contourplot(rinvmod2goog,zscaleLog=TRUE,
>>             at=my.at,colorkey=myColorkey,margin=FALSE,add=TRUE) +
>>   layer(grid.raster(gmap2,
>>                     x=lonCenter2, y=latCenter2,
>>                     width=width2, height=height2,
>>                     default.units='native'),under=TRUE)
>>
>> and get no error but just the contour. I've tried with my object in
>> pseudomercator and "lon-lat" geographic coordinates:
>> rinvmod2goog <- projectRaster(from=rinvmod2, crs=CRS("+init=epsg:3857"))
>> rinvmod2lonlat <- projectRaster(from=rinvmod2, crs=CRS("+proj=longlat
>> +ellps=WGS84 +no_defs"))
>>
>> both rinvmod2 and and gmap2 display fine independently.
>>
>> Data:
>> https://dl.dropboxusercontent.com/u/3180464/rinvmod2.rda
>> https://dl.dropboxusercontent.com/u/3180464/gmap2.rda
>> (to be used with load())
>>
>> Thanks
>>
>> Agus
>>
>> On Wed, Nov 20, 2013 at 6:47 PM, Oscar Perpi?an
>> <oscar.perpinan at gmail.com> wrote:
>>> Hi,
>>>
>>> For the sake of completeness: just a few days ago I received a comment
>>> to a post about spplot and ggmap
>>> (http://procomun.wordpress.com/2013/04/24/stamen-maps-with-spplot/).
>>> There I was using a SpatialPointsDataFrame object. Because of that
>>> comment I posted another example with SpatialPolygonsDataFrame:
>>> https://gist.github.com/oscarperpinan/7482848
>>>
>>> Best,
>>>
>>> Oscar.
>>> -----------------------------------------------------------------
>>> Oscar Perpi??n Lamigueiro
>>> Grupo de Sistemas Fotovoltaicos (IES-UPM)
>>> Dpto. Ingenier?a El?ctrica (ETSIDI-UPM)
>>> URL: http://oscarperpinan.github.io
>>> Twitter: @oscarperpinan
>>>
>>>
>>> 2013/11/20 Waichler, Scott R <Scott.Waichler at pnnl.gov>:
>>>> I was told, among other things, to look for previous messages by Oscar that would explain how to do this.  Here is Oscar's solution that I found to work for the case where you want to plot two rasters that have different extents.  In my case, gmap is a satellite image obtained with RgoogleMaps, and z are the results I want to plot over the background image.  I made the alpha values of z less than 1 so that the background image would show through.
>>>>
>>>> library(rasterVis)
>>>> levelplot(z~x*y) +
>>>> layer_(grid.raster(gmap, y=latCenter, width=width, height=height, default.units='native'))
>>>>
>>>> Scott Waichler
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From oscar.perpinan at gmail.com  Tue Dec 10 15:10:18 2013
From: oscar.perpinan at gmail.com (=?ISO-8859-1?Q?Oscar_Perpi=F1an?=)
Date: Tue, 10 Dec 2013 15:10:18 +0100
Subject: [R-sig-Geo] image background for spplot of gridded data
In-Reply-To: <CAG4NReL56jFzQRxn-xFmUxZByhFiTus_eR=h5-Q6XKj44fLYQQ@mail.gmail.com>
References: <A632B3F93D861843A3C966F3962C3F840148B3B6B674@EMAIL05.pnl.gov>
	<CAMLL7bnvgJ=f-F1MAeeyE-Tnhmzhf7mYqhHBAhOjuiDB+NTS9g@mail.gmail.com>
	<CAG4NRe+OM-0C4KhjdbekDCLKpXbSHSpcqVJq+hPEfGdTH88v1A@mail.gmail.com>
	<CAMLL7bmS0g2LxtQ0h9WHaQdtam_2R54bQpVMum3fFnq-VvK_Vw@mail.gmail.com>
	<CAG4NReL56jFzQRxn-xFmUxZByhFiTus_eR=h5-Q6XKj44fLYQQ@mail.gmail.com>
Message-ID: <CAMLL7b=oHZNpfPCCaYQNeGkenEeRsZVRw3gAy3cm3RxmN4MjhA@mail.gmail.com>

Try this:

rinvmod2Ext <- extend(rinvmod2lonlat,
                         with(bbMap2, c(ll.lon, ur.lon, ll.lat, ur.lat)))

contourplot(rinvmod2Ext, zscaleLog=TRUE, margin=FALSE) +
    layer(grid.raster(gmap2,
                      x=lonCenter2, y=latCenter2,
                      width=width2, height=height2,
                      default.units='native'),
          under=TRUE)

Best,

Oscar.
-----------------------------------------------------------------
Oscar Perpi??n Lamigueiro
Grupo de Sistemas Fotovoltaicos (IES-UPM)
Dpto. Ingenier?a El?ctrica (ETSIDI-UPM)
URL: http://oscarperpinan.github.io
Twitter: @oscarperpinan


2013/12/10 Agustin Lobo <alobolistas at gmail.com>:
> Yes, it does for me as well: I had messed with the parameters of the
> map in the original function.
> Here I've made a page showing what I do and what I get:
> https://dl.dropboxusercontent.com/u/3180464/contourOngmap_log.html
>
> Is it possible doing the reverse, overlaying the contour on top of the
> map instead of putting the map under the contour?
> I need the plume in the context of the country.
>
> Agus
>
>
> Agus
>
> On Tue, Dec 10, 2013 at 11:51 AM, Oscar Perpi?an
> <oscar.perpinan at gmail.com> wrote:
>> It works for me using rinvmod2lonlat (long-lat coordinates).
>>
>> Oscar.
>> -----------------------------------------------------------------
>> Oscar Perpi??n Lamigueiro
>> Grupo de Sistemas Fotovoltaicos (IES-UPM)
>> Dpto. Ingenier?a El?ctrica (ETSIDI-UPM)
>> URL: http://oscarperpinan.github.io
>> Twitter: @oscarperpinan
>>
>>
>> 2013/12/10 Agustin Lobo <alobolistas at gmail.com>:
>>> and would it possible a similar plot using contourplot() (or
>>> levelplot()) overlaid
>>> on a gmap?
>>>
>>> I've tried the equivalent to the
>>> stamen.R function that you refer to:
>>>
>>> contourplot(rinvmod2goog,zscaleLog=TRUE,
>>>             at=my.at,colorkey=myColorkey,margin=FALSE,add=TRUE) +
>>>   layer(grid.raster(gmap2,
>>>                     x=lonCenter2, y=latCenter2,
>>>                     width=width2, height=height2,
>>>                     default.units='native'),under=TRUE)
>>>
>>> and get no error but just the contour. I've tried with my object in
>>> pseudomercator and "lon-lat" geographic coordinates:
>>> rinvmod2goog <- projectRaster(from=rinvmod2, crs=CRS("+init=epsg:3857"))
>>> rinvmod2lonlat <- projectRaster(from=rinvmod2, crs=CRS("+proj=longlat
>>> +ellps=WGS84 +no_defs"))
>>>
>>> both rinvmod2 and and gmap2 display fine independently.
>>>
>>> Data:
>>> https://dl.dropboxusercontent.com/u/3180464/rinvmod2.rda
>>> https://dl.dropboxusercontent.com/u/3180464/gmap2.rda
>>> (to be used with load())
>>>
>>> Thanks
>>>
>>> Agus
>>>
>>> On Wed, Nov 20, 2013 at 6:47 PM, Oscar Perpi?an
>>> <oscar.perpinan at gmail.com> wrote:
>>>> Hi,
>>>>
>>>> For the sake of completeness: just a few days ago I received a comment
>>>> to a post about spplot and ggmap
>>>> (http://procomun.wordpress.com/2013/04/24/stamen-maps-with-spplot/).
>>>> There I was using a SpatialPointsDataFrame object. Because of that
>>>> comment I posted another example with SpatialPolygonsDataFrame:
>>>> https://gist.github.com/oscarperpinan/7482848
>>>>
>>>> Best,
>>>>
>>>> Oscar.
>>>> -----------------------------------------------------------------
>>>> Oscar Perpi??n Lamigueiro
>>>> Grupo de Sistemas Fotovoltaicos (IES-UPM)
>>>> Dpto. Ingenier?a El?ctrica (ETSIDI-UPM)
>>>> URL: http://oscarperpinan.github.io
>>>> Twitter: @oscarperpinan
>>>>
>>>>
>>>> 2013/11/20 Waichler, Scott R <Scott.Waichler at pnnl.gov>:
>>>>> I was told, among other things, to look for previous messages by Oscar that would explain how to do this.  Here is Oscar's solution that I found to work for the case where you want to plot two rasters that have different extents.  In my case, gmap is a satellite image obtained with RgoogleMaps, and z are the results I want to plot over the background image.  I made the alpha values of z less than 1 so that the background image would show through.
>>>>>
>>>>> library(rasterVis)
>>>>> levelplot(z~x*y) +
>>>>> layer_(grid.raster(gmap, y=latCenter, width=width, height=height, default.units='native'))
>>>>>
>>>>> Scott Waichler
>>>>>
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From alobolistas at gmail.com  Tue Dec 10 17:19:31 2013
From: alobolistas at gmail.com (Agustin Lobo)
Date: Tue, 10 Dec 2013 17:19:31 +0100
Subject: [R-sig-Geo] image background for spplot of gridded data
In-Reply-To: <CAMLL7b=oHZNpfPCCaYQNeGkenEeRsZVRw3gAy3cm3RxmN4MjhA@mail.gmail.com>
References: <A632B3F93D861843A3C966F3962C3F840148B3B6B674@EMAIL05.pnl.gov>
	<CAMLL7bnvgJ=f-F1MAeeyE-Tnhmzhf7mYqhHBAhOjuiDB+NTS9g@mail.gmail.com>
	<CAG4NRe+OM-0C4KhjdbekDCLKpXbSHSpcqVJq+hPEfGdTH88v1A@mail.gmail.com>
	<CAMLL7bmS0g2LxtQ0h9WHaQdtam_2R54bQpVMum3fFnq-VvK_Vw@mail.gmail.com>
	<CAG4NReL56jFzQRxn-xFmUxZByhFiTus_eR=h5-Q6XKj44fLYQQ@mail.gmail.com>
	<CAMLL7b=oHZNpfPCCaYQNeGkenEeRsZVRw3gAy3cm3RxmN4MjhA@mail.gmail.com>
Message-ID: <CAG4NRe+EtNF6e6fp=_Lqxr=OEOxGMgDy6a7HnW7gDyt+9kwQeg@mail.gmail.com>

Yes!
I also noticed that making a custom box for the plot is not
straightforward because
the user cannot set the box in get_map. I've managed to do it using
the extend() trick.
html updated
https://dl.dropboxusercontent.com/u/3180464/contourOngmap_log.html

Thanks!
Agus

On Tue, Dec 10, 2013 at 3:10 PM, Oscar Perpi?an
<oscar.perpinan at gmail.com> wrote:
> Try this:
>
> rinvmod2Ext <- extend(rinvmod2lonlat,
>                          with(bbMap2, c(ll.lon, ur.lon, ll.lat, ur.lat)))
>
> contourplot(rinvmod2Ext, zscaleLog=TRUE, margin=FALSE) +
>     layer(grid.raster(gmap2,
>                       x=lonCenter2, y=latCenter2,
>                       width=width2, height=height2,
>                       default.units='native'),
>           under=TRUE)
>
> Best,
>
> Oscar.
> -----------------------------------------------------------------
> Oscar Perpi??n Lamigueiro
> Grupo de Sistemas Fotovoltaicos (IES-UPM)
> Dpto. Ingenier?a El?ctrica (ETSIDI-UPM)
> URL: http://oscarperpinan.github.io
> Twitter: @oscarperpinan
>
>
> 2013/12/10 Agustin Lobo <alobolistas at gmail.com>:
>> Yes, it does for me as well: I had messed with the parameters of the
>> map in the original function.
>> Here I've made a page showing what I do and what I get:
>> https://dl.dropboxusercontent.com/u/3180464/contourOngmap_log.html
>>
>> Is it possible doing the reverse, overlaying the contour on top of the
>> map instead of putting the map under the contour?
>> I need the plume in the context of the country.
>>
>> Agus
>>
>>
>> Agus
>>
>> On Tue, Dec 10, 2013 at 11:51 AM, Oscar Perpi?an
>> <oscar.perpinan at gmail.com> wrote:
>>> It works for me using rinvmod2lonlat (long-lat coordinates).
>>>
>>> Oscar.
>>> -----------------------------------------------------------------
>>> Oscar Perpi??n Lamigueiro
>>> Grupo de Sistemas Fotovoltaicos (IES-UPM)
>>> Dpto. Ingenier?a El?ctrica (ETSIDI-UPM)
>>> URL: http://oscarperpinan.github.io
>>> Twitter: @oscarperpinan
>>>
>>>
>>> 2013/12/10 Agustin Lobo <alobolistas at gmail.com>:
>>>> and would it possible a similar plot using contourplot() (or
>>>> levelplot()) overlaid
>>>> on a gmap?
>>>>
>>>> I've tried the equivalent to the
>>>> stamen.R function that you refer to:
>>>>
>>>> contourplot(rinvmod2goog,zscaleLog=TRUE,
>>>>             at=my.at,colorkey=myColorkey,margin=FALSE,add=TRUE) +
>>>>   layer(grid.raster(gmap2,
>>>>                     x=lonCenter2, y=latCenter2,
>>>>                     width=width2, height=height2,
>>>>                     default.units='native'),under=TRUE)
>>>>
>>>> and get no error but just the contour. I've tried with my object in
>>>> pseudomercator and "lon-lat" geographic coordinates:
>>>> rinvmod2goog <- projectRaster(from=rinvmod2, crs=CRS("+init=epsg:3857"))
>>>> rinvmod2lonlat <- projectRaster(from=rinvmod2, crs=CRS("+proj=longlat
>>>> +ellps=WGS84 +no_defs"))
>>>>
>>>> both rinvmod2 and and gmap2 display fine independently.
>>>>
>>>> Data:
>>>> https://dl.dropboxusercontent.com/u/3180464/rinvmod2.rda
>>>> https://dl.dropboxusercontent.com/u/3180464/gmap2.rda
>>>> (to be used with load())
>>>>
>>>> Thanks
>>>>
>>>> Agus
>>>>
>>>> On Wed, Nov 20, 2013 at 6:47 PM, Oscar Perpi?an
>>>> <oscar.perpinan at gmail.com> wrote:
>>>>> Hi,
>>>>>
>>>>> For the sake of completeness: just a few days ago I received a comment
>>>>> to a post about spplot and ggmap
>>>>> (http://procomun.wordpress.com/2013/04/24/stamen-maps-with-spplot/).
>>>>> There I was using a SpatialPointsDataFrame object. Because of that
>>>>> comment I posted another example with SpatialPolygonsDataFrame:
>>>>> https://gist.github.com/oscarperpinan/7482848
>>>>>
>>>>> Best,
>>>>>
>>>>> Oscar.
>>>>> -----------------------------------------------------------------
>>>>> Oscar Perpi??n Lamigueiro
>>>>> Grupo de Sistemas Fotovoltaicos (IES-UPM)
>>>>> Dpto. Ingenier?a El?ctrica (ETSIDI-UPM)
>>>>> URL: http://oscarperpinan.github.io
>>>>> Twitter: @oscarperpinan
>>>>>
>>>>>
>>>>> 2013/11/20 Waichler, Scott R <Scott.Waichler at pnnl.gov>:
>>>>>> I was told, among other things, to look for previous messages by Oscar that would explain how to do this.  Here is Oscar's solution that I found to work for the case where you want to plot two rasters that have different extents.  In my case, gmap is a satellite image obtained with RgoogleMaps, and z are the results I want to plot over the background image.  I made the alpha values of z less than 1 so that the background image would show through.
>>>>>>
>>>>>> library(rasterVis)
>>>>>> levelplot(z~x*y) +
>>>>>> layer_(grid.raster(gmap, y=latCenter, width=width, height=height, default.units='native'))
>>>>>>
>>>>>> Scott Waichler
>>>>>>
>>>>>> _______________________________________________
>>>>>> R-sig-Geo mailing list
>>>>>> R-sig-Geo at r-project.org
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From agus.camacho at gmail.com  Tue Dec 10 18:36:13 2013
From: agus.camacho at gmail.com (Agus Camacho)
Date: Tue, 10 Dec 2013 15:36:13 -0200
Subject: [R-sig-Geo] contours in SpatialPixelsDataFrame
In-Reply-To: <CAMLL7bkodAbM7m-FQMURQfFO19jawfTcgQqYWqwrbL6xKVD0Xw@mail.gmail.com>
References: <CAG4NReKBY2gLGDJQseZWU5S4=+yb5q8yK8S0+LCs-+P4SKOQAg@mail.gmail.com>
	<CAMLL7bkodAbM7m-FQMURQfFO19jawfTcgQqYWqwrbL6xKVD0Xw@mail.gmail.com>
Message-ID: <CALsJ7pRw+6LaDtm34mn8Piym3AmmX5shrtfc786hRfjaGe48vg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131210/5c07328b/attachment.pl>

From droletguillaume at gmail.com  Tue Dec 10 18:57:53 2013
From: droletguillaume at gmail.com (Guillaume Drolet)
Date: Tue, 10 Dec 2013 09:57:53 -0800 (PST)
Subject: [R-sig-Geo] Error in .gd_SetProject(transient, crs(r))
Message-ID: <1386698273714-7585330.post@n2.nabble.com>

Hello,

This morning I updated RStudio to version 0.98.484, and Quantum GIS to
version 2.0.1 (Dufour) using the standalone installer.

After that, I tried to run some code in RStudio and I got the error message
below when running the following command:

> filename <- "test.tif"
> try(writeRaster(raster(matrix(1, 1, 1)), filename = filename, overwrite =
> overwrite))

Error in .gd_SetProject(transient, crs(r)) : 
  STRING_ELT() can only be applied to a 'character vector', not a 'logical'

Then, I updated rgdal to version 0.8-14 and now I get this error when
running the same code:

Error in .gd_SetProject(object, ...) : 
  STRING_ELT() can only be applied to a 'character vector', not a 'logical'

Until this morning, I never had any problem with that line of code above. I
suspect this could be due to the QGIS installation that could have messed
with my GDAL installation: is that possible (is GDAL used by rgdal at all)?
I tried uninstalling QGIS but I still get the same error message.

My session info:

R version 3.0.2 (2013-09-25)
Platform: x86_64-w64-mingw32/x64 (64-bit)

locale:
[1] LC_COLLATE=French_Canada.1252  LC_CTYPE=French_Canada.1252   
LC_MONETARY=French_Canada.1252
[4] LC_NUMERIC=C                   LC_TIME=French_Canada.1252    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] fmask_0.1         RSAGA_0.93-6      plyr_1.8          shapefiles_0.7   
foreign_0.8-55   
 [6] gstat_1.0-18      data.table_1.8.10 rgdal_0.8-14      roxygen2_3.0.0   
raster_2.1-68    
[11] sp_1.0-14        

loaded via a namespace (and not attached):
 [1] brew_1.0-6       codetools_0.2-8  digest_0.6.3     grid_3.0.2      
intervals_0.14.0 lattice_0.20-23 
 [7] spacetime_1.0-9  stringr_0.6.2    tools_3.0.2      xts_0.9-7       
zoo_1.7-10   

I will be very grateful of any help or piece of advice on how to fix that or
where to look for clues.

Best wishes,
Guillaume



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Error-in-gd-SetProject-transient-crs-r-tp7585330.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From etiennebr at gmail.com  Tue Dec 10 20:24:19 2013
From: etiennebr at gmail.com (Etienne B. Racine)
Date: Tue, 10 Dec 2013 14:24:19 -0500
Subject: [R-sig-Geo] Error in .gd_SetProject(transient, crs(r))
In-Reply-To: <1386698273714-7585330.post@n2.nabble.com>
References: <1386698273714-7585330.post@n2.nabble.com>
Message-ID: <CALjAYt7fperJ=GJ2jJCPC36Z8DA-_5NM_R43V=Q6s5OtoFJK3A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131210/0863c587/attachment.pl>

From simonwohlfahrt at posteo.de  Tue Dec 10 20:48:16 2013
From: simonwohlfahrt at posteo.de (Simon Wohlfahrt)
Date: Tue, 10 Dec 2013 20:48:16 +0100
Subject: [R-sig-Geo] Problems with getting less than 100% home range area by
 CharHull{adehabitatHR}
Message-ID: <a8f91f69eefadfb19d301782a4a79b46@posteo.de>

Hello,

I want to construct home ranges by the CharHull-function in 
adehabitatHR (CharHull {adehabitatHR} - Estimation of the Home Range by 
Delaunay Triangulation method).

The Description says that I could "select a given percentage of the 
smallest triangles (measured by their area) as the home-range 
estimation".
Now I want to select an home range with an area less than 100% of the 
total CharHull-Area, and finally plotting the contour or converting to a 
shape-file.
But the command "getverticeshr()" doesn't result in 95 % homerange 
area, it only shows a single small polygon which is a part of the outer 
polygons of the total home range.

So is there any argument like the "percent= ...." - command in the 
mcp()-function? The argument "percent=..." in plot() also result in 
these same single polygons.

I hope, you can help me.

For your information: I have a SpatialPointsDataFrame with one animal 
but more than 6000 points which I have transformed to CharHull - 
Polygons, a successfully but after this the unsolved problem have begun.

Thank you!

Simon

simonwohlfahrt at posteo.de


From afischbach at usgs.gov  Tue Dec 10 21:18:49 2013
From: afischbach at usgs.gov (Anthony Fischbach)
Date: Tue, 10 Dec 2013 12:18:49 -0800 (PST)
Subject: [R-sig-Geo] clipping SpatialPolygonsDataFrames
Message-ID: <1386706729757-7585333.post@n2.nabble.com>

I wish to clip SpatialPolygonsDataFrames with a SpatialPolygonsDataFrame and
return a SpatialPolygonsDataFrames with new clipped boundaries and with data
from the source SpatialPolygonsDataFrames.
[The ArcGIS equivalent is:
arcpy.Identity_analysis("InterestingPolygonsToBeClipped","StudyAreaClippingPolygons",
                                   
"resultingPolygons.shp","ALL","#","NO_RELATIONSHIPS")]  

Some have suggested that polygon on polygon clipping may best be done by a
GIS, and have lamented that efforts to implement this within R have suffered
from depenentcies on commercial software (see for example:
http://r-sig-geo.2731867.n2.nabble.com/clipping-polygons-overlaying-big-polygon-on-polygons-td4606656.html). 
Yet, I still wish to be able to do this entirely within R, because I have
needs to clip a large number  (sample size ~ 1000) of daily sea ice extent
polygons by study area polygons, and wish to handle the tabulated results
with the richness of R.

Without the ability to clip SpatialPolygonsDataFrames by a
SpatialPolygonsDataFrame , I am trying to solve this problem with the raster
package.  I rasterize my stack of sea ice extent polygons , as well as the
study area polygons.  Then overlay operations are run within the raster
context.  
## Code sketch  ##
## Dates is a data.frame containing columns for dates, names of sea ice
shape files 
## provided by a sea ice agency, and a column for the results.
## Study Area is a SpatialPolygonsDataframe defined elsewhere.
## First read in raster of appropriate resolution (5km x 5km cells from
across the study area).
r<-raster(file='rasterOfAppropriateResolution.tif')
StudyArea.r<-rasterize(StudyArea, r)  ## rasterize a
SpatialPolygonsDataFrame of the study area
                                                         ## StudyArea.r
cells are 1 in the study area, 0 elsewhere.

for(d 1:nrow(Dates)){  ##Loop through the hundreds of days of sea ice data
     Ice<-readOGR(dsn='D:/Temp/Ice', layer=Dates[d, 'shapeFile'])  ## Read
the Ice shape file
     Ice.r<-rasterize(Ice, StudyArea.r, getCover=TRUE)   ## rasterize sea
ice SpatialPolygonsDataFrame
     IceInStudyArea.r<-Ice.r * StudyArea.r  ## raster multiplication
     Dates[d,'IceInStudyArea']<-(cellStats(IceInStudyArea.r, stat=sum)/100)
}

It works great, but runs slowly on my workstation.  Is there a better
approach?



-----
Tony Fischbach, Wildlife Biologist
Walrus Research Program
Alaska Science Center
U.S. Geological Survey
4210 University Drive
Anchorage, AK 99508-4650

AFischbach at usgs.gov
http://alaska.usgs.gov/science/biology/walrus
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/clipping-SpatialPolygonsDataFrames-tp7585333.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From tephilippi at gmail.com  Tue Dec 10 21:38:30 2013
From: tephilippi at gmail.com (Tom Philippi)
Date: Tue, 10 Dec 2013 12:38:30 -0800
Subject: [R-sig-Geo] clipping SpatialPolygonsDataFrames
In-Reply-To: <1386706729757-7585333.post@n2.nabble.com>
References: <1386706729757-7585333.post@n2.nabble.com>
Message-ID: <CALyPt8zaYLOsrYeH2=k8G_oXat=Bq7TWROXebB4fvCPo7Z85PA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131210/28e26051/attachment.pl>

From afischbach at usgs.gov  Wed Dec 11 00:36:26 2013
From: afischbach at usgs.gov (Anthony Fischbach)
Date: Tue, 10 Dec 2013 15:36:26 -0800 (PST)
Subject: [R-sig-Geo] clipping SpatialPolygonsDataFrames
In-Reply-To: <CALyPt8zaYLOsrYeH2=k8G_oXat=Bq7TWROXebB4fvCPo7Z85PA@mail.gmail.com>
References: <1386706729757-7585333.post@n2.nabble.com>
	<CALyPt8zaYLOsrYeH2=k8G_oXat=Bq7TWROXebB4fvCPo7Z85PA@mail.gmail.com>
Message-ID: <1386718586762-7585335.post@n2.nabble.com>

Thank you Tom!
I tried the rgeos::gIntersection() approach on a quad dual core Windows 7
workstation, but found that it choked on a TopologyException after running
for over 10 minutes.

The raster approach to the problem produced a clean result in 77 seconds,
requiring under a single day of processing to handle each of my study areas
across the study years.  This now seems reasonable.

I then implemented this in Python for ArcGIS and found that the polygon
clipping required less than 7 seconds, reducing my process time to a little
over 3 hours.

O.K. then, perhaps its best to perform the GIS overlay with Python / ArcGIS
for now and then bring the results back into R from there.



-----
Tony Fischbach, Wildlife Biologist
Walrus Research Program
Alaska Science Center
U.S. Geological Survey
4210 University Drive
Anchorage, AK 99508-4650

AFischbach at usgs.gov
http://alaska.usgs.gov/science/biology/walrus
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/clipping-SpatialPolygonsDataFrames-tp7585333p7585335.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From alobolistas at gmail.com  Wed Dec 11 08:36:51 2013
From: alobolistas at gmail.com (Agustin Lobo)
Date: Wed, 11 Dec 2013 08:36:51 +0100
Subject: [R-sig-Geo] contours in SpatialPixelsDataFrame
In-Reply-To: <CALsJ7pRw+6LaDtm34mn8Piym3AmmX5shrtfc786hRfjaGe48vg@mail.gmail.com>
References: <CAG4NReKBY2gLGDJQseZWU5S4=+yb5q8yK8S0+LCs-+P4SKOQAg@mail.gmail.com>
	<CAMLL7bkodAbM7m-FQMURQfFO19jawfTcgQqYWqwrbL6xKVD0Xw@mail.gmail.com>
	<CALsJ7pRw+6LaDtm34mn8Piym3AmmX5shrtfc786hRfjaGe48vg@mail.gmail.com>
Message-ID: <CAG4NReLUs2-P9VJ_GQF7kp_MibrppnqRqGzi9ko0OW9yoxUq9A@mail.gmail.com>

Thanks Agus Camacho,
but this is essentially what I was doing: create a raster (an image is
a raster) out of the points
and then use contour() or the more sophisticated
rasterVis::contourplot or levelplot. In this
particular case the raster can be created with no interpolation, as
the points are arranged as a grid
and the spatial resolution is already the one we had selected for the
dispersion model.
The question was if the conversion to raster could be skipped, which
is the case in the way Oscar
kindly indicated.
Agus


On Tue, Dec 10, 2013 at 6:36 PM, Agus Camacho <agus.camacho at gmail.com> wrote:
> Maybe too obvious to be useful, but have you tried using the "akima"
> package for plotting your variable?
>
> It only needs the coordinates and the value of your variable:
>
>
> require(akima)
>                   data(akima)
>   ## linear interpolation
>   akima.li <- interp(akima$x, akima$y, akima$z)
>   image  (akima.li, add=TRUE)
>   contour(akima.li, add=TRUE)
>   points (akima, pch = 3)
>
> Saludos
> Agus
>
>
>
> 2013/12/10 Oscar Perpi?an <oscar.perpinan at upm.es>
>
>> Hi,
>>
>> spplot for SpatialPixelsDataFrame is built upon lattice::levelplot.
>> Thus, you can use most of its arguments in spplot. For your problem
>> you have to set "contour=TRUE" and "region=FALSE". Moreover, you can
>> customize the labels with (surprise!) "labels". This is documented in
>> the help page of lattice::panel.levelplot:
>>
>> library(sp)
>> data(meuse.grid)
>> m <- SpatialPixelsDataFrame(points = meuse.grid[c("x", "y")],
>>     data = meuse.grid)
>>
>> spplot(m["dist"],
>>        contour=TRUE, region=FALSE,
>>        labels=list(cex=0.6))
>>
>> Best,
>>
>> Oscar.
>> -----------------------------------------------------------------
>> Oscar Perpi??n Lamigueiro
>> Dpto. Ingenier?a El?ctrica (ETSIDI-UPM)
>> Grupo de Sistemas Fotovoltaicos (IES-UPM)
>> URL: http://oscarperpinan.github.io
>> Twitter: @oscarperpinan
>>
>>
>> 2013/12/9 Agustin Lobo <alobolistas at gmail.com>:
>> > I have a set of regularly distributed points (a grid) as a SpatialPoints
>> DF.
>> > In order to display the distribution of a continuos varaible in the data
>> table,
>> > I transform to SpatialPixelsDataFrame (using gridded(a) <- TRUE)
>> > and after calculating the dimensions of the grid I use rasterize() to
>> convert
>> > to raster and then use rasterVIS::levelplot()
>> >
>> > My question is, can equivalent contours be drawn directely on the
>> > SpatialPixelsDataFrame object
>> > to skip the tansform to raster?
>> > I've tried with spplot(), but get filled intervals, not line contours.
>> >
>> > Thanks
>> >
>> > Agus
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at r-project.org
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
>
> --
> Agust?n Camacho Guerrero.
> Doutor em Zoologia.
> Laborat?rio de Herpetologia, Departamento de Zoologia, Instituto de
> Bioci?ncias, USP.
> Rua do Mat?o, trav. 14, n? 321, Cidade Universit?ria,
> S?o Paulo - SP, CEP: 05508-090, Brasil.
>
>         [[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From dicko.ahmadou at gmail.com  Wed Dec 11 12:03:53 2013
From: dicko.ahmadou at gmail.com (Ahmadou Dicko)
Date: Wed, 11 Dec 2013 11:03:53 +0000
Subject: [R-sig-Geo] Error in .gd_SetProject(transient, crs(r))
In-Reply-To: <CALjAYt7fperJ=GJ2jJCPC36Z8DA-_5NM_R43V=Q6s5OtoFJK3A@mail.gmail.com>
References: <1386698273714-7585330.post@n2.nabble.com>
	<CALjAYt7fperJ=GJ2jJCPC36Z8DA-_5NM_R43V=Q6s5OtoFJK3A@mail.gmail.com>
Message-ID: <CAP8THHWAGhYS2Y1Rhf==ym=TPa_WA+vJ40WE_FjPyO+Gu7EyxA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131211/df409a41/attachment.pl>

From ROONEYJ4 at tcd.ie  Wed Dec 11 12:10:29 2013
From: ROONEYJ4 at tcd.ie (James Rooney)
Date: Wed, 11 Dec 2013 11:10:29 +0000
Subject: [R-sig-Geo] add image to plot
In-Reply-To: <75C8D19A1470D344A8AF5312F01160A602BBB78CFE2C@GOMAIL.college.tcd.ie>
References: <75C8D19A1470D344A8AF5312F01160A602BBB78CFE2C@GOMAIL.college.tcd.ie>
Message-ID: <75C8D19A1470D344A8AF5312F01160A602BBB78CFE2D@GOMAIL.college.tcd.ie>

Anyone got experience with grImport even ?
I'm at my wits end with this. Think I'm going to have to just do it in photoshop or something after the fact.

James
________________________________________
From: r-sig-geo-bounces at r-project.org [r-sig-geo-bounces at r-project.org] On Behalf Of James Rooney [ROONEYJ4 at tcd.ie]
Sent: 09 December 2013 12:05
To: r-sig-geo at r-project.org
Subject: [R-sig-Geo] add image to plot

Hi all,

I need to add a logo to a plot. I have the logo in eps and jpg formats though can convert it to something else if needed.
My preference is to use the eps version since I am plotting my graphs to an eps file.
However I'm having a problem - with grImport - it is not detecting all the features of the image (not picking up colours and missing internal features of plot.

My code is thus:

PostScriptTrace("LogoLarge.eps")
logo<-readPicture("LogoLarge.eps.xml")

Does anyone know why it is not catching all features of the image ?
Any other way of doing is ?

James
_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From alobolistas at gmail.com  Wed Dec 11 13:42:50 2013
From: alobolistas at gmail.com (Agustin Lobo)
Date: Wed, 11 Dec 2013 13:42:50 +0100
Subject: [R-sig-Geo] add image to plot
In-Reply-To: <75C8D19A1470D344A8AF5312F01160A602BBB78CFE2D@GOMAIL.college.tcd.ie>
References: <75C8D19A1470D344A8AF5312F01160A602BBB78CFE2C@GOMAIL.college.tcd.ie>
	<75C8D19A1470D344A8AF5312F01160A602BBB78CFE2D@GOMAIL.college.tcd.ie>
Message-ID: <CAG4NRe+cPqZzUaqPiWv=DSJQF0e_ti2xXh43=ms4GuijwBqVSg@mail.gmail.com>

James,
Are you sure this is the right list for this question?
I would rather use gimp for that purpose.
Agus


On Wed, Dec 11, 2013 at 12:10 PM, James Rooney <ROONEYJ4 at tcd.ie> wrote:
> Anyone got experience with grImport even ?
> I'm at my wits end with this. Think I'm going to have to just do it in photoshop or something after the fact.
>
> James
> ________________________________________
> From: r-sig-geo-bounces at r-project.org [r-sig-geo-bounces at r-project.org] On Behalf Of James Rooney [ROONEYJ4 at tcd.ie]
> Sent: 09 December 2013 12:05
> To: r-sig-geo at r-project.org
> Subject: [R-sig-Geo] add image to plot
>
> Hi all,
>
> I need to add a logo to a plot. I have the logo in eps and jpg formats though can convert it to something else if needed.
> My preference is to use the eps version since I am plotting my graphs to an eps file.
> However I'm having a problem - with grImport - it is not detecting all the features of the image (not picking up colours and missing internal features of plot.
>
> My code is thus:
>
> PostScriptTrace("LogoLarge.eps")
> logo<-readPicture("LogoLarge.eps.xml")
>
> Does anyone know why it is not catching all features of the image ?
> Any other way of doing is ?
>
> James
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From ROONEYJ4 at tcd.ie  Wed Dec 11 14:38:18 2013
From: ROONEYJ4 at tcd.ie (James Rooney)
Date: Wed, 11 Dec 2013 13:38:18 +0000
Subject: [R-sig-Geo] add image to plot
In-Reply-To: <CAG4NRe+cPqZzUaqPiWv=DSJQF0e_ti2xXh43=ms4GuijwBqVSg@mail.gmail.com>
References: <75C8D19A1470D344A8AF5312F01160A602BBB78CFE2C@GOMAIL.college.tcd.ie>
	<75C8D19A1470D344A8AF5312F01160A602BBB78CFE2D@GOMAIL.college.tcd.ie>,
	<CAG4NRe+cPqZzUaqPiWv=DSJQF0e_ti2xXh43=ms4GuijwBqVSg@mail.gmail.com>
Message-ID: <75C8D19A1470D344A8AF5312F01160A602BBB78CFE2E@GOMAIL.college.tcd.ie>

Hi Agus,

Eh perhaps not - is there a more suitable list ? I thought sticking logos into maps would be common enough practice here ?
I'm not sure gimp is a solution since it also depends on ghostscript.
I'm starting to tihnk Adobe Ilustrator is my only option - which is irritating since I don't have it.

James
________________________________________
From: Agustin Lobo [alobolistas at gmail.com]
Sent: 11 December 2013 12:42
To: James Rooney
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] add image to plot

James,
Are you sure this is the right list for this question?
I would rather use gimp for that purpose.
Agus


On Wed, Dec 11, 2013 at 12:10 PM, James Rooney <ROONEYJ4 at tcd.ie> wrote:
> Anyone got experience with grImport even ?
> I'm at my wits end with this. Think I'm going to have to just do it in photoshop or something after the fact.
>
> James
> ________________________________________
> From: r-sig-geo-bounces at r-project.org [r-sig-geo-bounces at r-project.org] On Behalf Of James Rooney [ROONEYJ4 at tcd.ie]
> Sent: 09 December 2013 12:05
> To: r-sig-geo at r-project.org
> Subject: [R-sig-Geo] add image to plot
>
> Hi all,
>
> I need to add a logo to a plot. I have the logo in eps and jpg formats though can convert it to something else if needed.
> My preference is to use the eps version since I am plotting my graphs to an eps file.
> However I'm having a problem - with grImport - it is not detecting all the features of the image (not picking up colours and missing internal features of plot.
>
> My code is thus:
>
> PostScriptTrace("LogoLarge.eps")
> logo<-readPicture("LogoLarge.eps.xml")
>
> Does anyone know why it is not catching all features of the image ?
> Any other way of doing is ?
>
> James
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Roger.Bivand at nhh.no  Wed Dec 11 14:58:49 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 11 Dec 2013 14:58:49 +0100
Subject: [R-sig-Geo] add image to plot
In-Reply-To: <75C8D19A1470D344A8AF5312F01160A602BBB78CFE2E@GOMAIL.college.tcd.ie>
References: <75C8D19A1470D344A8AF5312F01160A602BBB78CFE2C@GOMAIL.college.tcd.ie>
	<75C8D19A1470D344A8AF5312F01160A602BBB78CFE2D@GOMAIL.college.tcd.ie>,
	<CAG4NRe+cPqZzUaqPiWv=DSJQF0e_ti2xXh43=ms4GuijwBqVSg@mail.gmail.com>
	<75C8D19A1470D344A8AF5312F01160A602BBB78CFE2E@GOMAIL.college.tcd.ie>
Message-ID: <alpine.LRH.2.03.1312111453130.2354@reclus.nhh.no>

On Wed, 11 Dec 2013, James Rooney wrote:

> Hi Agus,
>
> Eh perhaps not - is there a more suitable list ? I thought sticking 
> logos into maps would be common enough practice here ? I'm not sure gimp 
> is a solution since it also depends on ghostscript. I'm starting to 
> tihnk Adobe Ilustrator is my only option - which is irritating since I 
> don't have it.

You want to add an image for which you have either JPEG or EPS versions 
available to base R plots? If you convert your JPEG to PNM, use:

library(pixmap)
?"addlogo-methods"

Consider using locator() to provide the anchor for the logo.

Roger

>
> James
> ________________________________________
> From: Agustin Lobo [alobolistas at gmail.com]
> Sent: 11 December 2013 12:42
> To: James Rooney
> Cc: r-sig-geo at r-project.org
> Subject: Re: [R-sig-Geo] add image to plot
>
> James,
> Are you sure this is the right list for this question?
> I would rather use gimp for that purpose.
> Agus
>
>
> On Wed, Dec 11, 2013 at 12:10 PM, James Rooney <ROONEYJ4 at tcd.ie> wrote:
>> Anyone got experience with grImport even ?
>> I'm at my wits end with this. Think I'm going to have to just do it in photoshop or something after the fact.
>>
>> James
>> ________________________________________
>> From: r-sig-geo-bounces at r-project.org [r-sig-geo-bounces at r-project.org] On Behalf Of James Rooney [ROONEYJ4 at tcd.ie]
>> Sent: 09 December 2013 12:05
>> To: r-sig-geo at r-project.org
>> Subject: [R-sig-Geo] add image to plot
>>
>> Hi all,
>>
>> I need to add a logo to a plot. I have the logo in eps and jpg formats though can convert it to something else if needed.
>> My preference is to use the eps version since I am plotting my graphs to an eps file.
>> However I'm having a problem - with grImport - it is not detecting all the features of the image (not picking up colours and missing internal features of plot.
>>
>> My code is thus:
>>
>> PostScriptTrace("LogoLarge.eps")
>> logo<-readPicture("LogoLarge.eps.xml")
>>
>> Does anyone know why it is not catching all features of the image ?
>> Any other way of doing is ?
>>
>> James
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From btupper at bigelow.org  Wed Dec 11 15:37:21 2013
From: btupper at bigelow.org (Ben Tupper)
Date: Wed, 11 Dec 2013 09:37:21 -0500
Subject: [R-sig-Geo] add image to plot
In-Reply-To: <alpine.LRH.2.03.1312111453130.2354@reclus.nhh.no>
References: <75C8D19A1470D344A8AF5312F01160A602BBB78CFE2C@GOMAIL.college.tcd.ie>
	<75C8D19A1470D344A8AF5312F01160A602BBB78CFE2D@GOMAIL.college.tcd.ie>,
	<CAG4NRe+cPqZzUaqPiWv=DSJQF0e_ti2xXh43=ms4GuijwBqVSg@mail.gmail.com>
	<75C8D19A1470D344A8AF5312F01160A602BBB78CFE2E@GOMAIL.college.tcd.ie>
	<alpine.LRH.2.03.1312111453130.2354@reclus.nhh.no>
Message-ID: <BA0476BF-30EE-4648-BD6E-57D536F38155@bigelow.org>

Hi,

On Dec 11, 2013, at 8:58 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:

> On Wed, 11 Dec 2013, James Rooney wrote:
> 
>> Hi Agus,
>> 
>> Eh perhaps not - is there a more suitable list ? I thought sticking logos into maps would be common enough practice here ? I'm not sure gimp is a solution since it also depends on ghostscript. I'm starting to tihnk Adobe Ilustrator is my only option - which is irritating since I don't have it.
> 
> You want to add an image for which you have either JPEG or EPS versions available to base R plots? If you convert your JPEG to PNM, use:
> 
> library(pixmap)
> ?"addlogo-methods"
> 
> Consider using locator() to provide the anchor for the logo.
> 

You might also find it easy to use the jpeg package.

http://cran.r-project.org/web/packages/jpeg/index.html

Cheers,
Ben

 



> Roger
> 
>> 
>> James
>> ________________________________________
>> From: Agustin Lobo [alobolistas at gmail.com]
>> Sent: 11 December 2013 12:42
>> To: James Rooney
>> Cc: r-sig-geo at r-project.org
>> Subject: Re: [R-sig-Geo] add image to plot
>> 
>> James,
>> Are you sure this is the right list for this question?
>> I would rather use gimp for that purpose.
>> Agus
>> 
>> 
>> On Wed, Dec 11, 2013 at 12:10 PM, James Rooney <ROONEYJ4 at tcd.ie> wrote:
>>> Anyone got experience with grImport even ?
>>> I'm at my wits end with this. Think I'm going to have to just do it in photoshop or something after the fact.
>>> 
>>> James
>>> ________________________________________
>>> From: r-sig-geo-bounces at r-project.org [r-sig-geo-bounces at r-project.org] On Behalf Of James Rooney [ROONEYJ4 at tcd.ie]
>>> Sent: 09 December 2013 12:05
>>> To: r-sig-geo at r-project.org
>>> Subject: [R-sig-Geo] add image to plot
>>> 
>>> Hi all,
>>> 
>>> I need to add a logo to a plot. I have the logo in eps and jpg formats though can convert it to something else if needed.
>>> My preference is to use the eps version since I am plotting my graphs to an eps file.
>>> However I'm having a problem - with grImport - it is not detecting all the features of the image (not picking up colours and missing internal features of plot.
>>> 
>>> My code is thus:
>>> 
>>> PostScriptTrace("LogoLarge.eps")
>>> logo<-readPicture("LogoLarge.eps.xml")
>>> 
>>> Does anyone know why it is not catching all features of the image ?
>>> Any other way of doing is ?
>>> 
>>> James
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> 
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
> 
> -- 
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

Ben Tupper
Bigelow Laboratory for Ocean Sciences
60 Bigelow Drive, P.O. Box 380
East Boothbay, Maine 04544
http://www.bigelow.org


From etiennebr at gmail.com  Wed Dec 11 16:04:59 2013
From: etiennebr at gmail.com (Etienne B. Racine)
Date: Wed, 11 Dec 2013 10:04:59 -0500
Subject: [R-sig-Geo] Error in .gd_SetProject(transient, crs(r))
In-Reply-To: <CAP8THHWAGhYS2Y1Rhf==ym=TPa_WA+vJ40WE_FjPyO+Gu7EyxA@mail.gmail.com>
References: <1386698273714-7585330.post@n2.nabble.com>
	<CALjAYt7fperJ=GJ2jJCPC36Z8DA-_5NM_R43V=Q6s5OtoFJK3A@mail.gmail.com>
	<CAP8THHWAGhYS2Y1Rhf==ym=TPa_WA+vJ40WE_FjPyO+Gu7EyxA@mail.gmail.com>
Message-ID: <CALjAYt6Adub0zSe3XyqFO=cJV8JcE5XpNVcaiYotdzeUkBaG6g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131211/0f83761a/attachment.pl>

From bakare at ualberta.ca  Wed Dec 11 18:17:14 2013
From: bakare at ualberta.ca (Moshood Agba Bakare)
Date: Wed, 11 Dec 2013 10:17:14 -0700
Subject: [R-sig-Geo] variogram model with gstat
Message-ID: <CAJRR3XO7=wwBAyZOkhy8vp2GsafQKxBZxa4jfndzJ+buAS0kBg@mail.gmail.com>

Dear All,
I used gstat package of R to fit variogram model to experimental variogram
having normalized the raw data as

VN = (VP -VMean)/VSd

Where VN is the normalized yield value, VP is the original yield value at
sampling point, VMean is average yield  value, and VSd is the standard
deviation of yield value.

The reason for normalization is to be able to assess the stability of
spatial pattern of yield over a number of years. Having normalized the
data, I expected the sill i.e. the variance of the data to be one but to my
surprise the semivariogram plot shows sill of 0.8. What is responsible for
this?

The result of fitting exponential function showed a nugget effect of zero
as showed below

## Exponential variogram model> exp.var<-vgm(psill = 0.8, model="Exp",
range= 15, nugget= 0.1)> exp.mod<-fit.variogram(empvar,model=exp.var)>
print(exp.mod)  model     psill    range
1   Nug 0.0000000  0.00000
2   Exp 0.8066099 11.36279


Does it mean the exponential structure explained 100 percent of total
variation in a normalized yield variable? I am confused! Have a look at the
attached file for the semivariogram plot. Do I need to detrend before
fitting the model? it seems the plot increases monotonically without level
off. Please advise.

Thank you
Moshood
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131211/bbfc37f4/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: variogram model.docx
Type: application/vnd.openxmlformats-officedocument.wordprocessingml.document
Size: 29178 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131211/bbfc37f4/attachment.bin>

From edzer.pebesma at uni-muenster.de  Wed Dec 11 18:50:11 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 11 Dec 2013 18:50:11 +0100
Subject: [R-sig-Geo] variogram model with gstat
In-Reply-To: <CAJRR3XO7=wwBAyZOkhy8vp2GsafQKxBZxa4jfndzJ+buAS0kBg@mail.gmail.com>
References: <CAJRR3XO7=wwBAyZOkhy8vp2GsafQKxBZxa4jfndzJ+buAS0kBg@mail.gmail.com>
Message-ID: <52A8A5D3.8060408@uni-muenster.de>

Try:

library(sp)
demo(meuse,ask=F)
library(gstat)
m = meuse$zinc
meuse$m = (meuse$zinc - mean(meuse$zinc))/sd(meuse$zinc)
var(meuse$m)
# [1] 1
variogram(m~1, meuse, cutoff=1e6)$gamma
# [1] 1

you see that the semivariogram averaged over ALL distances equals the
variance of the variable. What you look at is (for good reasons) the
semivariogram computed up to a certain distance.

Hth,

On 12/11/2013 06:17 PM, Moshood Agba Bakare wrote:
> Dear All,
> I used gstat package of R to fit variogram model to experimental variogram
> having normalized the raw data as
> 
> VN = (VP -VMean)/VSd
> 
> Where VN is the normalized yield value, VP is the original yield value at
> sampling point, VMean is average yield  value, and VSd is the standard
> deviation of yield value.
> 
> The reason for normalization is to be able to assess the stability of
> spatial pattern of yield over a number of years. Having normalized the
> data, I expected the sill i.e. the variance of the data to be one but to my
> surprise the semivariogram plot shows sill of 0.8. What is responsible for
> this?
> 
> The result of fitting exponential function showed a nugget effect of zero
> as showed below
> 
> ## Exponential variogram model> exp.var<-vgm(psill = 0.8, model="Exp",
> range= 15, nugget= 0.1)> exp.mod<-fit.variogram(empvar,model=exp.var)>
> print(exp.mod)  model     psill    range
> 1   Nug 0.0000000  0.00000
> 2   Exp 0.8066099 11.36279
> 
> 
> Does it mean the exponential structure explained 100 percent of total
> variation in a normalized yield variable? I am confused! Have a look at the
> attached file for the semivariogram plot. Do I need to detrend before
> fitting the model? it seems the plot increases monotonically without level
> off. Please advise.
> 
> Thank you
> Moshood
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 555 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131211/9cf448d0/attachment.bin>

From bakare at ualberta.ca  Wed Dec 11 19:34:23 2013
From: bakare at ualberta.ca (Moshood Agba Bakare)
Date: Wed, 11 Dec 2013 11:34:23 -0700
Subject: [R-sig-Geo] variogram model with gstat
In-Reply-To: <52A8A5D3.8060408@uni-muenster.de>
References: <CAJRR3XO7=wwBAyZOkhy8vp2GsafQKxBZxa4jfndzJ+buAS0kBg@mail.gmail.com>
	<52A8A5D3.8060408@uni-muenster.de>
Message-ID: <CAJRR3XMEJXiyC6OH6k_xJ2CB-hBhm4Fr+ew=WKnO1FbYfg_CLw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131211/e6e749b3/attachment.pl>

From gerardommc at gmail.com  Thu Dec 12 02:57:36 2013
From: gerardommc at gmail.com (Gerardo Martin)
Date: Thu, 12 Dec 2013 11:57:36 +1000
Subject: [R-sig-Geo] Mahalanobis scores for training data
Message-ID: <52A91810.9090705@gmail.com>

Hi all. I have a series of distribution models with the mahalanobis 
distance implementation of dismo. I used the data.frame method because 
of the nature of data. However in order to run the proper diagnostic 
tests (not the traditional AUC) I need to calculate the distances of the 
training data. To date I've done this using the predict function as:

predict(model, data)

Bus this only gives scores of 1, which is incorrect given that all 
scores should normally go from 0 to -inf. I suppose that what the 
function is doing is identifying training data and returning 1 as 
closest to training data. But is there a way to compute the raw distances?

Regards

Gerardo


From alobolistas at gmail.com  Thu Dec 12 14:23:38 2013
From: alobolistas at gmail.com (Agustin Lobo)
Date: Thu, 12 Dec 2013 14:23:38 +0100
Subject: [R-sig-Geo] Error in .gd_SetProject(transient, crs(r))
In-Reply-To: <1386698273714-7585330.post@n2.nabble.com>
References: <1386698273714-7585330.post@n2.nabble.com>
Message-ID: <CAG4NReKF_eaEJZjUscFuuyxXM376LG1SzOMnsZ_--kSR3oD4fA@mail.gmail.com>

I have no problem on linux with QGIS 2.01, RStudio Version 0.98.484
and
rgdal: version: 0.8-11, (SVN revision 479M)
Geospatial Data Abstraction Library extensions to R successfully loaded
Loaded GDAL runtime: GDAL 1.10.0, released 2013/04/24
> sessionInfo()
R version 3.0.2 (2013-09-25)
Platform: x86_64-pc-linux-gnu (64-bit)

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
LC_TIME=es_ES.UTF-8        LC_COLLATE=en_US.UTF-8
 [5] LC_MONETARY=es_ES.UTF-8    LC_MESSAGES=en_US.UTF-8
LC_PAPER=es_ES.UTF-8       LC_NAME=C
 [9] LC_ADDRESS=C               LC_TELEPHONE=C
LC_MEASUREMENT=es_ES.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] raster_2.1-49 rgdal_0.8-11  sp_1.0-13     lmodel2_1.7-1
xtable_1.7-1  knitr_1.5

loaded via a namespace (and not attached):
[1] codetools_0.2-8 digest_0.6.3    evaluate_0.5.1  formatR_0.9
grid_3.0.2      lattice_0.20-24 markdown_0.6.3
[8] stringr_0.6.2   tools_3.0.2


On Tue, Dec 10, 2013 at 6:57 PM, Guillaume Drolet
<droletguillaume at gmail.com> wrote:
> Hello,
>
> This morning I updated RStudio to version 0.98.484, and Quantum GIS to
> version 2.0.1 (Dufour) using the standalone installer.
>
> After that, I tried to run some code in RStudio and I got the error message
> below when running the following command:
>
>> filename <- "test.tif"
>> try(writeRaster(raster(matrix(1, 1, 1)), filename = filename, overwrite =
>> overwrite))
>
> Error in .gd_SetProject(transient, crs(r)) :
>   STRING_ELT() can only be applied to a 'character vector', not a 'logical'
>
> Then, I updated rgdal to version 0.8-14 and now I get this error when
> running the same code:
>
> Error in .gd_SetProject(object, ...) :
>   STRING_ELT() can only be applied to a 'character vector', not a 'logical'
>
> Until this morning, I never had any problem with that line of code above. I
> suspect this could be due to the QGIS installation that could have messed
> with my GDAL installation: is that possible (is GDAL used by rgdal at all)?
> I tried uninstalling QGIS but I still get the same error message.
>
> My session info:
>
> R version 3.0.2 (2013-09-25)
> Platform: x86_64-w64-mingw32/x64 (64-bit)
>
> locale:
> [1] LC_COLLATE=French_Canada.1252  LC_CTYPE=French_Canada.1252
> LC_MONETARY=French_Canada.1252
> [4] LC_NUMERIC=C                   LC_TIME=French_Canada.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
>  [1] fmask_0.1         RSAGA_0.93-6      plyr_1.8          shapefiles_0.7
> foreign_0.8-55
>  [6] gstat_1.0-18      data.table_1.8.10 rgdal_0.8-14      roxygen2_3.0.0
> raster_2.1-68
> [11] sp_1.0-14
>
> loaded via a namespace (and not attached):
>  [1] brew_1.0-6       codetools_0.2-8  digest_0.6.3     grid_3.0.2
> intervals_0.14.0 lattice_0.20-23
>  [7] spacetime_1.0-9  stringr_0.6.2    tools_3.0.2      xts_0.9-7
> zoo_1.7-10
>
> I will be very grateful of any help or piece of advice on how to fix that or
> where to look for clues.
>
> Best wishes,
> Guillaume
>
>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Error-in-gd-SetProject-transient-crs-r-tp7585330.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From dicko.ahmadou at gmail.com  Thu Dec 12 14:35:02 2013
From: dicko.ahmadou at gmail.com (Ahmadou Dicko)
Date: Thu, 12 Dec 2013 13:35:02 +0000
Subject: [R-sig-Geo] Error in .gd_SetProject(transient, crs(r))
In-Reply-To: <CAG4NReKF_eaEJZjUscFuuyxXM376LG1SzOMnsZ_--kSR3oD4fA@mail.gmail.com>
References: <1386698273714-7585330.post@n2.nabble.com>
	<CAG4NReKF_eaEJZjUscFuuyxXM376LG1SzOMnsZ_--kSR3oD4fA@mail.gmail.com>
Message-ID: <CAP8THHW+kc5V1K1RLVtc5oGYn-rCEozUGrZA1A0UUU6m+i9AMQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131212/80869523/attachment.pl>

From rahmannorthampton at gmail.com  Thu Dec 12 17:41:38 2013
From: rahmannorthampton at gmail.com (Lutfor)
Date: Thu, 12 Dec 2013 08:41:38 -0800 (PST)
Subject: [R-sig-Geo] mcp calculation
In-Reply-To: <CAM_vjunFdC8tmnhi=dmzQqm-ng0G1C6hdniPxh+=XG_NfefM1Q@mail.gmail.com>
References: <1385591474760-7585219.post@n2.nabble.com>
	<52967ED0.2090306@ase-research.org>
	<1386363882098-7585297.post@n2.nabble.com>
	<CAM_vjunFdC8tmnhi=dmzQqm-ng0G1C6hdniPxh+=XG_NfefM1Q@mail.gmail.com>
Message-ID: <1386866498439-7585350.post@n2.nabble.com>

Thank you Sarah for your clarification.
Your codes also helpful to create scale bar on the contour map.

Kind regards
Lutfor



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/mcp-calculation-tp7585219p7585350.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From simonwohlfahrt at posteo.de  Thu Dec 12 17:53:44 2013
From: simonwohlfahrt at posteo.de (Simon Wohlfahrt)
Date: Thu, 12 Dec 2013 17:53:44 +0100
Subject: [R-sig-Geo] now with an example for you: Problems with getting less
 than 100% of home range area by CharHull{adehabitatHR}
Message-ID: <42e392cbd6a729e51e05dffa08e8273e@posteo.de>

Hello,

- now i create an example which you can use (see below) -

I want to create home ranges by the CharHull-function in adehabitatHR 
(CharHull {adehabitatHR} - Estimation of the Home Range by Delaunay 
Triangulation method).

The Description says that I could "select a given percentage of the 
smallest triangles (measured by their area) as the home-range 
estimation". Now I want to select an home range with an area less than 
100% of the total CharHull-Area, and finally plotting the contour or 
converting to a shape-file. But the command "getverticeshr()" doesn't 
result in 95 % homerange area, it only shows a single small polygon 
which is a part of the outer polygons of the total home range.

So is there any argument like the "percent= ...." - command in the 
mcp()-function? The argument "percent=..." in plot() also result in 
these same single polygons.

I hope, you can help me.

For your information: I have a SpatialPointsDataFrame with one animal 
but more than 6000 points which I have transformed successfully to 
CharHull - Polygons, a "MCHu"-class-object but after this the unsolved 
problem has begun.

And here is an example-data:

###start###

     library(sp)
     library(rgdal)
     library(adehabitatHR)

### first the data.frame by dput(spdf_proj)
spdf_proj <-
     structure(list(tag.local.identifier = structure(c(1L, 1L, 1L,
     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
     1L), .Label = "2337", class = "factor"), utm.easting = 
c(683974.34404956,
     683974.760661362, 683965.172048386, 683987.281009456, 
683985.362453604,
     683982.219900401, 688531.512618968, 688646.734103846, 
688648.699663448,
     688645.493334214, 688672.516759366, 688647.254958931, 
687718.469882875,
     687720.16874801, 687713.469156302, 687715.945476163, 
684638.357135326,
     682851.713841839, 682477.884670838, 686067.563387058, 
682250.807247258,
     682257.865282583, 681883.067916919, 681785.074428023, 
679682.011093641,
     679683.959645211, 679679.61072749, 679682.334770195, 
679682.016356632,
     681870.417032469, 681833.431666185, 681835.819298651, 
682169.045982226,
     682481.102026817, 681898.903336465, 681815.124474645, 
681767.856349565,
     679683.60677096, 679679.512331425, 679685.090362144, 
680056.806449304,
     680669.183843293, 680574.455914651, 680135.313954264, 
679377.580233857,
     679962.24379583, 681449.590749334, 682487.75669767, 
680411.258032117,
     679696.668518938, 679693.528686564, 679772.603933245, 
679773.633868724,
     679736.151907987, 679052.282925451, 678976.337308103, 
679033.29446238,
     678931.539793955, 678958.703684971, 678946.400181795, 
678850.167005458,
     678773.910379499, 678698.286869888, 678670.305173271, 
678919.107223046,
     678849.346729342, 681189.259381922, 681760.407535151, 
681703.846635682,
     681398.684724269, 681404.573105136, 680342.303016419, 
680154.993589284,
     678462.168244616, 678391.786039819, 676898.732907242, 
676001.82835349,
     678008.813312216, 681769.954749672, 681759.207974324, 
681507.518781024,
     681593.03220131, 681540.302993985, 681484.948396701, 
681473.096193411,
     681472.290180181, 681495.69034936, 681435.364563687, 
681447.201456387,
     681484.561357977, 681486.557645373, 681560.45748688, 
681569.439596909,
     681563.610777719, 681588.547306751, 681569.219963467, 
681513.790788761,
     681152.416214584, 681081.49854309, 681135.953821302), utm.northing 
= c(5872351.4785664,
     5872343.56503875, 5872346.22796992, 5872363.42149295, 
5872353.8039064,
     5872349.47411571, 5868340.77361732, 5868243.52829709, 
5868235.77558357,
     5868232.40916611, 5868253.49144986, 5868237.26716877, 
5869057.86016266,
     5869090.09085241, 5869056.34011199, 5869062.72910834, 
5870701.37302118,
     5874368.47157975, 5876177.09623027, 5878230.03361947, 
5870680.9824509,
     5870676.63887016, 5870979.35579, 5871339.76634507, 
5873840.86397719,
     5873841.23739579, 5873841.43141602, 5873842.6355962, 
5873844.68392672,
     5871046.00928802, 5870883.25601619, 5870971.63656481, 
5870724.34128791,
     5870884.41119196, 5871004.71015641, 5870912.68946024, 
5871079.80253065,
     5873839.88786636, 5873837.58571748, 5873842.99459642, 
5871951.44683181,
     5870220.93377831, 5870073.8804179, 5869500.17597069, 
5868159.55631067,
     5867142.10863469, 5870163.2230145, 5871573.15193546, 
5873155.16709993,
     5873906.4137855, 5873904.82657411, 5873914.76176622, 
5873923.17474623,
     5873499.82015583, 5872526.93430836, 5872245.66202465, 
5872260.85296241,
     5869177.40600652, 5869162.02197482, 5869085.16044548, 
5868978.3021106,
     5868905.01581302, 5868857.42295838, 5868902.29988844, 
5868275.63384941,
     5867353.8085983, 5868186.05946818, 5868896.81150499, 
5869342.47718761,
     5869161.06440822, 5868981.86688963, 5867817.37248634, 
5867771.05004108,
     5868056.05939298, 5868402.53585019, 5868159.41355345, 
5868319.36565231,
     5868603.79684903, 5869309.1656903, 5868948.79591208, 
5869112.41864817,
     5869300.35951534, 5869263.37159654, 5869176.9064542, 
5869136.82566771,
     5869116.05926684, 5869101.72778812, 5869055.03378991, 
5869106.26144798,
     5869151.08873567, 5869141.30813259, 5869115.13596271, 
5868956.49020514,
     5868937.08258008, 5869027.92636603, 5869132.38225557, 
5869118.44574871,
     5869157.45021195, 5869112.02210622, 5869153.69116562)), .Names = 
c("tag.local.identifier",
     "utm.easting", "utm.northing"), class = "data.frame", row.names = 
362243:362342)

### projection
utm32CRS <- CRS("+proj=utm +zone=32 +datum=WGS84")
coordinates(spdf_proj) <- c("utm.easting", "utm.northing")
proj4string(spdf_proj) <- utm32CRS

### CharHull
spdf_CharHull <- CharHull(spdf_proj)

### Plotting
plot(spdf_CharHull, percent=95)
### -> only one single outer polygon instead of wanted 95 % - area of 
the total CharHull-Polygons

### getting contours
getverticeshr.MCHu(spdf_CharHull, percent=95)
### same problem as above

###end###


-------- Originalnachricht --------
Betreff: [R-sig-Geo] Problems with getting less than 100% home range 
area by CharHull{adehabitatHR}
Datum: 10.12.2013 20:48
Von: Simon Wohlfahrt <simonwohlfahrt at posteo.de>
An: <r-sig-geo at r-project.org>

Hello,

I want to construct home ranges by the CharHull-function in 
adehabitatHR (CharHull {adehabitatHR} - Estimation of the Home Range by 
Delaunay Triangulation method).

The Description says that I could "select a given percentage of the 
smallest triangles (measured by their area) as the home-range 
estimation".
Now I want to select an home range with an area less than 100% of the 
total CharHull-Area, and finally plotting the contour or converting to a 
shape-file.
But the command "getverticeshr()" doesn't result in 95 % homerange 
area, it only shows a single small polygon which is a part of the outer 
polygons of the total home range.

So is there any argument like the "percent= ...." - command in the 
mcp()-function? The argument "percent=..." in plot() also result in 
these same single polygons.

I hope, you can help me.

For your information: I have a SpatialPointsDataFrame with one animal 
but more than 6000 points which I have transformed to CharHull - 
Polygons, a successfully but after this the unsolved problem have begun.

Thank you!

Simon

simonwohlfahrt at posteo.de

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From juihan.chang at maine.edu  Thu Dec 12 20:20:09 2013
From: juihan.chang at maine.edu (Jui-Han Chang)
Date: Thu, 12 Dec 2013 14:20:09 -0500
Subject: [R-sig-Geo] covariance matrix for kriging predictions
Message-ID: <CAOH3MAktDbTPdkyZCE5ufR9iKWK1K0fxhwr9DUtL6Amn3xSKjA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131212/b553517f/attachment.pl>

From edzer.pebesma at uni-muenster.de  Thu Dec 12 22:54:02 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 12 Dec 2013 22:54:02 +0100
Subject: [R-sig-Geo] covariance matrix for kriging predictions
In-Reply-To: <CAOH3MAktDbTPdkyZCE5ufR9iKWK1K0fxhwr9DUtL6Amn3xSKjA@mail.gmail.com>
References: <CAOH3MAktDbTPdkyZCE5ufR9iKWK1K0fxhwr9DUtL6Amn3xSKjA@mail.gmail.com>
Message-ID: <52AA307A.2080504@uni-muenster.de>



On 12/12/2013 08:20 PM, Jui-Han Chang wrote:
> Hi all,
> 
> I am trying to get covariance matrix for kriging predictions. I used krige0
> function in the gstat library with options fullCovariance=TRUE and
> computeVar=TRUE. I got a covariance matrix but the values seem to be too
> large. I converted the covariance matrix to correlation matrix and got
> values larger than 1. Following are the codes to derive the matrices:
> 
> library(gstat)
> data(meuse)
> coordinates(meuse) = ~x+y
> data(meuse.grid)
> gridded(meuse.grid) = ~x+y
> 
> m <- vgm(.59, "Sph", 874, .04)
> x <- krige0(log(zinc)~1, meuse, meuse.grid, model =
> m,fullCovariance=TRUE,computeVar=TRUE)
> 
> x$var[1:5,1:5]
> 
>        [,1]      [,2]      [,3]      [,4]      [,5]
> 1 0.3108421 0.2794621 0.2883862 0.3019975 0.2528104
> 2 0.2794621 0.2414045 0.2546174 0.2727450 0.2074984
> 3 0.2883862 0.2546174 0.2631935 0.2769452 0.2263174
> 4 0.3019975 0.2727450 0.2769452 0.2863739 0.2499542
> 5 0.2528104 0.2074984 0.2263174 0.2499542 0.1648699
> 
> cov2cor(x$var[1:5,1:5])
> 
>       [,1]     [,2]     [,3]     [,4]     [,5]
> 1 1.000000 1.020188 1.008247 1.012201 1.116746
> 2 1.020188 1.000000 1.010131 1.037331 1.040091
> 3 1.008247 1.010131 1.000000 1.008764 1.086450
> 4 1.012201 1.037331 1.008764 1.000000 1.150331
> 5 1.116746 1.040091 1.086450 1.150331 1.000000
> 
> I am not sure what I am getting here now. Is this covariance matrix for
> kriging predictions? If not does anyone know how to get a covariance
> matrix? Any help will be appreciated.

Thanks, this is clearly wrong. My feeling is that c0 in the computation
of the kriging predictions covariance matrix needs be specified
differently, not as a constant, however I haven't sorted out how, so far.
-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 555 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131212/b751d607/attachment.bin>

From eddieatr at gmail.com  Thu Dec 12 23:11:07 2013
From: eddieatr at gmail.com (Eddie Smith)
Date: Thu, 12 Dec 2013 22:11:07 +0000
Subject: [R-sig-Geo] How to output the minimum and maximum value from
 rasterstack into csv/text file??
Message-ID: <CABaJH79tWXLb6teYuZve52tjNfKp_As4DBnRQktg_4xOunhtWA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131212/5b5b9f08/attachment.pl>

From roman.lustrik at gmail.com  Thu Dec 12 23:34:56 2013
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Thu, 12 Dec 2013 23:34:56 +0100
Subject: [R-sig-Geo] How to output the minimum and maximum value from
 rasterstack into csv/text file??
In-Reply-To: <CABaJH79tWXLb6teYuZve52tjNfKp_As4DBnRQktg_4xOunhtWA@mail.gmail.com>
References: <CABaJH79tWXLb6teYuZve52tjNfKp_As4DBnRQktg_4xOunhtWA@mail.gmail.com>
Message-ID: <CAHT1vphACuAM2bQnqwWn+2yj7aN1WqqUV_-0mwLZpEr6ETUTQg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131212/6a24bd6a/attachment.pl>

From vitale232 at gmail.com  Fri Dec 13 01:44:16 2013
From: vitale232 at gmail.com (Andrew P Vitale)
Date: Thu, 12 Dec 2013 16:44:16 -0800
Subject: [R-sig-Geo] How to output the minimum and maximum value from
 rasterstack into csv/text file??
In-Reply-To: <CABaJH79tWXLb6teYuZve52tjNfKp_As4DBnRQktg_4xOunhtWA@mail.gmail.com>
References: <CABaJH79tWXLb6teYuZve52tjNfKp_As4DBnRQktg_4xOunhtWA@mail.gmail.com>
Message-ID: <52AA5860.60306@gmail.com>

I think this is what you're going for:

library(raster)
r <- raster(nrow=5, ncol=5)
s <- stack( sapply(1:5, function(i) setValues(r, rnorm(ncell(r), i, 3) )) )

min <- cellStats(s, 'min')
max <- cellStats(s, 'max')
mean <- cellStats(s, 'mean')

df <- data.frame(min, max, mean)

write.csv(df, 'df.csv')

On 12/12/2013 2:11 PM, Eddie Smith wrote:
> Hi guys,
>
> library(raster)
> r <- raster(nrow=5, ncol=5)
> s <- stack( sapply(1:5, function(i) setValues(r, rnorm(ncell(r), i, 3) )) )
>
> class       : RasterStack
> dimensions  : 5, 5, 25, 5  (nrow, ncol, ncell, nlayers)
> resolution  : 72, 36  (x, y)
> coord. ref. : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0
> names       :    layer.1,    layer.2,    layer.3,    layer.4,    layer.5
> min values  : -4.2962007, -2.6573262, -1.3929480,  0.1079140, -0.1711899
> max values  :   5.888370,   7.654831,  10.222458,  10.486516,   9.694796
>
> How do I export the minimum and maximum values for all layers? (I have few
> hundreds of layers in a rasterstack). Is it also possible to get the mean
> values?
>
> Thank you.
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From clement.calenge at oncfs.gouv.fr  Fri Dec 13 10:32:58 2013
From: clement.calenge at oncfs.gouv.fr (Clement Calenge)
Date: Fri, 13 Dec 2013 10:32:58 +0100
Subject: [R-sig-Geo] now with an example for you: Problems with getting
 less than 100% of home range area by CharHull{adehabitatHR}
In-Reply-To: <42e392cbd6a729e51e05dffa08e8273e@posteo.de>
References: <42e392cbd6a729e51e05dffa08e8273e@posteo.de>
Message-ID: <52AAD44A.8070101@oncfs.gouv.fr>


> - now i create an example which you can use (see below) -
>
> I want to create home ranges by the CharHull-function in adehabitatHR
> (CharHull {adehabitatHR} - Estimation of the Home Range by Delaunay
> Triangulation method).
>
> The Description says that I could "select a given percentage of the
> smallest triangles (measured by their area) as the home-range
> estimation". Now I want to select an home range with an area less than
> 100% of the total CharHull-Area, and finally plotting the contour or
> converting to a shape-file. But the command "getverticeshr()" doesn't
> result in 95 % homerange area, it only shows a single small polygon
> which is a part of the outer polygons of the total home range.
>
> So is there any argument like the "percent= ...." - command in the
> mcp()-function? The argument "percent=..." in plot() also result in
> these same single polygons.

There is indeed a problem with the function CharHull. Actually, an 
object returned by the function CharHull is an object of class MCHu, 
which is basically a list of SpatialPolygonsDataFrame (one spdf per 
animal). In the case of the function CharHull, each row of the 
SpatialPolygonsDataFrame corresponds to one additional hull added to the 
home range, but it should correspond to the additionnal hull merged with 
hulls corresponding to lower percentage. I will correct this bug in the 
package asap. Meanwhile, you can use the following function to correct 
the object returned by CharHull:

correctCharHull <- function(x, unin = c("m", "km"), unout = c("ha", 
"m2", "km2"))
{
     if (!require(rgeos))
         stop("the package rgeos is required for this function")
     if (!require(maptools))
         stop("the package maptools is required for this function")
     unin <- match.arg(unin)
     unout <- match.arg(unout)

     resu <- lapply(x, function(polr) {
         pfs <- proj4string(polr)
         pol <- as(polr, "SpatialPolygons")
         lip <- list(pol[1])
         for (i in 2:nrow(polr)) {
             poo <- rbind(pol[i], lip[[i-1]])
             pls <- slot(poo, "polygons")
             pls1 <- lapply(pls, maptools::checkPolygonsHoles)
             slot(poo, "polygons") <- pls1
             lip[[i]] <- rgeos::gUnionCascaded(poo, id = rep(i,
                 length(row.names(poo))))
         }
         are <- adehabitatHR:::.arcpspdf(lip[[1]])
         for (i in 2:length(lip)) {
             are[i] <- adehabitatHR:::.arcpspdf(lip[[i]])
         }
                 spP <- do.call("rbind", lip)
         if (unin == "m") {
             if (unout == "ha")
                 are <- are/10000
             if (unout == "km2")
                 are <- are/1e+06
         }
         if (unin == "km") {
             if (unout == "ha")
                 are <- are * 100
             if (unout == "m2")
                 are <- are * 1e+06
         }
         df <- data.frame(area = are, percent = polr[[2]])
         res <- SpatialPolygonsDataFrame(spP, df)
         if (!is.na(pfs))
             proj4string(res) <- CRS(pfs)
         return(res)
     })
     class(resu) <- "MCHu"
     return(resu)
}


For example:

data(puechabonsp)
lo<-puechabonsp$relocs[,1]

## Home Range Estimation
res <- CharHull(lo)
## Use of the correcting function:
res <- correctCharHull(res)
## get the 80% home range
ver <- getverticeshr(res,80)
plot(ver, col="grey")


HTH,

Cl?ment Calenge


>
> I hope, you can help me.
>
> For your information: I have a SpatialPointsDataFrame with one animal
> but more than 6000 points which I have transformed successfully to
> CharHull - Polygons, a "MCHu"-class-object but after this the unsolved
> problem has begun.
>
> And here is an example-data:
>
> ###start###
>
>       library(sp)
>       library(rgdal)
>       library(adehabitatHR)
>
> ### first the data.frame by dput(spdf_proj)
> spdf_proj <-
>       structure(list(tag.local.identifier = structure(c(1L, 1L, 1L,
>       1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
>       1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
>       1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
>       1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
>       1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
>       1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
>       1L), .Label = "2337", class = "factor"), utm.easting =
> c(683974.34404956,
>       683974.760661362, 683965.172048386, 683987.281009456,
> 683985.362453604,
>       683982.219900401, 688531.512618968, 688646.734103846,
> 688648.699663448,
>       688645.493334214, 688672.516759366, 688647.254958931,
> 687718.469882875,
>       687720.16874801, 687713.469156302, 687715.945476163,
> 684638.357135326,
>       682851.713841839, 682477.884670838, 686067.563387058,
> 682250.807247258,
>       682257.865282583, 681883.067916919, 681785.074428023,
> 679682.011093641,
>       679683.959645211, 679679.61072749, 679682.334770195,
> 679682.016356632,
>       681870.417032469, 681833.431666185, 681835.819298651,
> 682169.045982226,
>       682481.102026817, 681898.903336465, 681815.124474645,
> 681767.856349565,
>       679683.60677096, 679679.512331425, 679685.090362144,
> 680056.806449304,
>       680669.183843293, 680574.455914651, 680135.313954264,
> 679377.580233857,
>       679962.24379583, 681449.590749334, 682487.75669767,
> 680411.258032117,
>       679696.668518938, 679693.528686564, 679772.603933245,
> 679773.633868724,
>       679736.151907987, 679052.282925451, 678976.337308103,
> 679033.29446238,
>       678931.539793955, 678958.703684971, 678946.400181795,
> 678850.167005458,
>       678773.910379499, 678698.286869888, 678670.305173271,
> 678919.107223046,
>       678849.346729342, 681189.259381922, 681760.407535151,
> 681703.846635682,
>       681398.684724269, 681404.573105136, 680342.303016419,
> 680154.993589284,
>       678462.168244616, 678391.786039819, 676898.732907242,
> 676001.82835349,
>       678008.813312216, 681769.954749672, 681759.207974324,
> 681507.518781024,
>       681593.03220131, 681540.302993985, 681484.948396701,
> 681473.096193411,
>       681472.290180181, 681495.69034936, 681435.364563687,
> 681447.201456387,
>       681484.561357977, 681486.557645373, 681560.45748688,
> 681569.439596909,
>       681563.610777719, 681588.547306751, 681569.219963467,
> 681513.790788761,
>       681152.416214584, 681081.49854309, 681135.953821302), utm.northing
> = c(5872351.4785664,
>       5872343.56503875, 5872346.22796992, 5872363.42149295,
> 5872353.8039064,
>       5872349.47411571, 5868340.77361732, 5868243.52829709,
> 5868235.77558357,
>       5868232.40916611, 5868253.49144986, 5868237.26716877,
> 5869057.86016266,
>       5869090.09085241, 5869056.34011199, 5869062.72910834,
> 5870701.37302118,
>       5874368.47157975, 5876177.09623027, 5878230.03361947,
> 5870680.9824509,
>       5870676.63887016, 5870979.35579, 5871339.76634507,
> 5873840.86397719,
>       5873841.23739579, 5873841.43141602, 5873842.6355962,
> 5873844.68392672,
>       5871046.00928802, 5870883.25601619, 5870971.63656481,
> 5870724.34128791,
>       5870884.41119196, 5871004.71015641, 5870912.68946024,
> 5871079.80253065,
>       5873839.88786636, 5873837.58571748, 5873842.99459642,
> 5871951.44683181,
>       5870220.93377831, 5870073.8804179, 5869500.17597069,
> 5868159.55631067,
>       5867142.10863469, 5870163.2230145, 5871573.15193546,
> 5873155.16709993,
>       5873906.4137855, 5873904.82657411, 5873914.76176622,
> 5873923.17474623,
>       5873499.82015583, 5872526.93430836, 5872245.66202465,
> 5872260.85296241,
>       5869177.40600652, 5869162.02197482, 5869085.16044548,
> 5868978.3021106,
>       5868905.01581302, 5868857.42295838, 5868902.29988844,
> 5868275.63384941,
>       5867353.8085983, 5868186.05946818, 5868896.81150499,
> 5869342.47718761,
>       5869161.06440822, 5868981.86688963, 5867817.37248634,
> 5867771.05004108,
>       5868056.05939298, 5868402.53585019, 5868159.41355345,
> 5868319.36565231,
>       5868603.79684903, 5869309.1656903, 5868948.79591208,
> 5869112.41864817,
>       5869300.35951534, 5869263.37159654, 5869176.9064542,
> 5869136.82566771,
>       5869116.05926684, 5869101.72778812, 5869055.03378991,
> 5869106.26144798,
>       5869151.08873567, 5869141.30813259, 5869115.13596271,
> 5868956.49020514,
>       5868937.08258008, 5869027.92636603, 5869132.38225557,
> 5869118.44574871,
>       5869157.45021195, 5869112.02210622, 5869153.69116562)), .Names =
> c("tag.local.identifier",
>       "utm.easting", "utm.northing"), class = "data.frame", row.names =
> 362243:362342)
>
> ### projection
> utm32CRS <- CRS("+proj=utm +zone=32 +datum=WGS84")
> coordinates(spdf_proj) <- c("utm.easting", "utm.northing")
> proj4string(spdf_proj) <- utm32CRS
>
> ### CharHull
> spdf_CharHull <- CharHull(spdf_proj)
>
> ### Plotting
> plot(spdf_CharHull, percent=95)
> ### -> only one single outer polygon instead of wanted 95 % - area of
> the total CharHull-Polygons
>
> ### getting contours
> getverticeshr.MCHu(spdf_CharHull, percent=95)
> ### same problem as above
>
> ###end###
>
>
> -------- Originalnachricht --------
> Betreff: [R-sig-Geo] Problems with getting less than 100% home range
> area by CharHull{adehabitatHR}
> Datum: 10.12.2013 20:48
> Von: Simon Wohlfahrt <simonwohlfahrt at posteo.de>
> An: <r-sig-geo at r-project.org>
>
> Hello,
>
> I want to construct home ranges by the CharHull-function in
> adehabitatHR (CharHull {adehabitatHR} - Estimation of the Home Range by
> Delaunay Triangulation method).
>
> The Description says that I could "select a given percentage of the
> smallest triangles (measured by their area) as the home-range
> estimation".
> Now I want to select an home range with an area less than 100% of the
> total CharHull-Area, and finally plotting the contour or converting to a
> shape-file.
> But the command "getverticeshr()" doesn't result in 95 % homerange
> area, it only shows a single small polygon which is a part of the outer
> polygons of the total home range.
>
> So is there any argument like the "percent= ...." - command in the
> mcp()-function? The argument "percent=..." in plot() also result in
> these same single polygons.
>
> I hope, you can help me.
>
> For your information: I have a SpatialPointsDataFrame with one animal
> but more than 6000 points which I have transformed to CharHull -
> Polygons, a successfully but after this the unsolved problem have begun.
>
> Thank you!
>
> Simon
>
> simonwohlfahrt at posteo.de
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> .
>


-- 
Cl?ment CALENGE
Cellule d'appui ? l'analyse de donn?es
Direction des Etudes et de la Recherche
Office national de la chasse et de la faune sauvage
Saint Benoist - 78610 Auffargis
tel. (33) 01.30.46.54.14


From eddieatr at gmail.com  Fri Dec 13 12:21:16 2013
From: eddieatr at gmail.com (Eddie Smith)
Date: Fri, 13 Dec 2013 11:21:16 +0000
Subject: [R-sig-Geo] How to output the minimum and maximum value from
 rasterstack into csv/text file??
In-Reply-To: <52AA5860.60306@gmail.com>
References: <CABaJH79tWXLb6teYuZve52tjNfKp_As4DBnRQktg_4xOunhtWA@mail.gmail.com>
	<52AA5860.60306@gmail.com>
Message-ID: <CABaJH7-aEkZ22foeqYGEriToXV9pnJWymXEZeyWvPf65CLZifw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131213/ef3a7436/attachment.pl>

From r.hijmans at gmail.com  Fri Dec 13 16:22:37 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Fri, 13 Dec 2013 07:22:37 -0800
Subject: [R-sig-Geo] Mahalanobis scores for training data
In-Reply-To: <52A91810.9090705@gmail.com>
References: <52A91810.9090705@gmail.com>
Message-ID: <CANtt_hzC-6SskGL=H=voT4=zkH2MOOuhURDKQzYUUwYyty55jw@mail.gmail.com>

Gerardo:

?mahal says:

"The predictions are (1-distance). I.e. the highest possible value is
1, and there will likely be large negative numbers"

So I suppose you could do:

predict(model, data) - 1

Best, RH

On Wed, Dec 11, 2013 at 5:57 PM, Gerardo Martin <gerardommc at gmail.com> wrote:
> Hi all. I have a series of distribution models with the mahalanobis distance
> implementation of dismo. I used the data.frame method because of the nature
> of data. However in order to run the proper diagnostic tests (not the
> traditional AUC) I need to calculate the distances of the training data. To
> date I've done this using the predict function as:
>
> predict(model, data)
>
> Bus this only gives scores of 1, which is incorrect given that all scores
> should normally go from 0 to -inf. I suppose that what the function is doing
> is identifying training data and returning 1 as closest to training data.
> But is there a way to compute the raw distances?
>
> Regards
>
> Gerardo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From droletguillaume at gmail.com  Fri Dec 13 16:51:59 2013
From: droletguillaume at gmail.com (Guillaume Drolet)
Date: Fri, 13 Dec 2013 07:51:59 -0800 (PST)
Subject: [R-sig-Geo] Intermittent error using clusterR
Message-ID: <1386949919376-7585360.post@n2.nabble.com>

Hi,

I wrote a code which uses clusterR to run a function on multiple CPUs [see
this thread showing part of the code, that has fixed based on Robert's help:
http://r-sig-geo.2731867.n2.nabble.com/cluster-error-with-clusterR-and-calc-td7585148.html]. 

Intermittently, my code stops with this error (along with its traceback): 

Error in serialize(data, node$con) : error writing to connection 
serialize(data, node$con) 
sendData.SOCKnode(con, list(type = type, data = value, tag = tag)) 
sendData(con, list(type = type, data = value, tag = tag)) 
postNode(con, "EXEC", list(fun = fun, args = args, return = return,  
sendCall(cl[[i]], clusfun, list(fun, i), tag = i) 
clusterR(s, fun1, filename = f) at calculateCloudH.R#33
calculateCloudH(current.h, t.cloudbase, t.cloud, file.cloudH,  at
fmask.R#332
fmask(mtl, filename = ofile, nodes = 8, overwrite = TRUE) 

Sometimes it doesn't stop, some other times it does. It may be similar to
this same problem in which they attribute it to a call to a C function
through .Call()
[http://stackoverflow.com/questions/17015598/error-calling-serialize-r-function].
As in that thread, showConnections() show my connections are still opened
and ready for read/write (but, there are 6 connections instead of 8: maybe
this is due to this call I use when I initialize the cluster,
on.exit(endCluster()), and which didn't do is job completely...?)

Has anyone else ever experienced this same problem with clusterR? If so, I
would appreciate your advice on how you fixed it if you did. Thanks!

>sessionInfo():
R version 3.0.2 (2013-09-25)
Platform: x86_64-w64-mingw32/x64 (64-bit)

locale:
[1] LC_COLLATE=French_Canada.1252  LC_CTYPE=French_Canada.1252   
LC_MONETARY=French_Canada.1252
[4] LC_NUMERIC=C                   LC_TIME=French_Canada.1252    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] igraph_0.6.6      snow_0.3-13       fmask_0.1         RSAGA_0.93-6     
plyr_1.8         
 [6] shapefiles_0.7    foreign_0.8-55    gstat_1.0-18      data.table_1.8.10
rgdal_0.8-14     
[11] raster_2.1-68     sp_1.0-14         roxygen2_3.0.0   

loaded via a namespace (and not attached):
 [1] brew_1.0-6       codetools_0.2-8  digest_0.6.3     grid_3.0.2      
intervals_0.14.0 lattice_0.20-23 
 [7] spacetime_1.0-9  stringr_0.6.2    tools_3.0.2      xts_0.9-7       
zoo_1.7-10   




--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Intermittent-error-using-clusterR-tp7585360.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From ben.graeler at uni-muenster.de  Fri Dec 13 17:07:47 2013
From: ben.graeler at uni-muenster.de (=?ISO-8859-1?Q?Benedikt_Gr=E4ler?=)
Date: Fri, 13 Dec 2013 17:07:47 +0100
Subject: [R-sig-Geo] covariance matrix for kriging predictions
In-Reply-To: <52AA307A.2080504@uni-muenster.de>
References: <CAOH3MAktDbTPdkyZCE5ufR9iKWK1K0fxhwr9DUtL6Amn3xSKjA@mail.gmail.com>
	<52AA307A.2080504@uni-muenster.de>
Message-ID: <52AB30D3.9010006@uni-muenster.de>

Dear Jui-Han,

I believe the following script does what you are looking after. The idea
is to start with the covariance matrix purely defined by the variogram
model (i.e. with the joint sill on the diagonal). Rescale this
covariance matrix first to correlations and then back to covariances
using the marginal variances obtained from the kriging predictor. I will
correct the krige0 function in gstat accordingly.

Let me know if this is what you have been looking for.

Best wishes,

 Ben

#--R-Script--#
# get some data
library(gstat)
library(sp)

data(meuse)
coordinates(meuse) = ~x+y
data(meuse.grid)
gridded(meuse.grid) = ~x+y

m <- vgm(0.59,"Sph", 897, 0.05)

# do the prediction to get the marginal kriging
# variance for each grid cell
pred <- krige(log(zinc)~1, meuse, meuse.grid, m)

# calculate the covariacne strucutre of the desired
# grid: 3103 x 3103 matrix
covMat <- variogramLine(m, dist_vector = spDists(meuse.grid,
meuse.grid), covariance = TRUE)

# rescale to correlation matrix
corMat <- cov2cor(covMat)

# scale back to the desired variances on the
# diagonal, just the same way backwards as cov2cor
# does it:
covMat <- corMat*matrix(sqrt(pred$var1.var) %x%
sqrt(pred$var1.var),3103,3103)
covMat[1:5,1:5]

# check for correlation
cov2cor(covMat[1:5,1:5])

# check prediction variance:
diag(covMat) - pred$var1.var

#--R-Script--#

On 12.12.2013 22:54, Edzer Pebesma wrote:
> 
> 
> On 12/12/2013 08:20 PM, Jui-Han Chang wrote:
>> Hi all,
>>
>> I am trying to get covariance matrix for kriging predictions. I used krige0
>> function in the gstat library with options fullCovariance=TRUE and
>> computeVar=TRUE. I got a covariance matrix but the values seem to be too
>> large. I converted the covariance matrix to correlation matrix and got
>> values larger than 1. Following are the codes to derive the matrices:
>>
>> library(gstat)
>> data(meuse)
>> coordinates(meuse) = ~x+y
>> data(meuse.grid)
>> gridded(meuse.grid) = ~x+y
>>
>> m <- vgm(.59, "Sph", 874, .04)
>> x <- krige0(log(zinc)~1, meuse, meuse.grid, model =
>> m,fullCovariance=TRUE,computeVar=TRUE)
>>
>> x$var[1:5,1:5]
>>
>>        [,1]      [,2]      [,3]      [,4]      [,5]
>> 1 0.3108421 0.2794621 0.2883862 0.3019975 0.2528104
>> 2 0.2794621 0.2414045 0.2546174 0.2727450 0.2074984
>> 3 0.2883862 0.2546174 0.2631935 0.2769452 0.2263174
>> 4 0.3019975 0.2727450 0.2769452 0.2863739 0.2499542
>> 5 0.2528104 0.2074984 0.2263174 0.2499542 0.1648699
>>
>> cov2cor(x$var[1:5,1:5])
>>
>>       [,1]     [,2]     [,3]     [,4]     [,5]
>> 1 1.000000 1.020188 1.008247 1.012201 1.116746
>> 2 1.020188 1.000000 1.010131 1.037331 1.040091
>> 3 1.008247 1.010131 1.000000 1.008764 1.086450
>> 4 1.012201 1.037331 1.008764 1.000000 1.150331
>> 5 1.116746 1.040091 1.086450 1.150331 1.000000
>>
>> I am not sure what I am getting here now. Is this covariance matrix for
>> kriging predictions? If not does anyone know how to get a covariance
>> matrix? Any help will be appreciated.
> 
> Thanks, this is clearly wrong. My feeling is that c0 in the computation
> of the kriging predictions covariance matrix needs be specified
> differently, not as a constant, however I haven't sorted out how, so far.
> 
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Benedikt Gr?ler

ifgi - Institute for Geoinformatics
University of Muenster

http://ifgi.uni-muenster.de/graeler

Phone: +49 251 83-33082
Mail: ben.graeler at uni-muenster.de

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 560 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131213/6aa82fb3/attachment.bin>

From vitale232 at gmail.com  Fri Dec 13 19:47:03 2013
From: vitale232 at gmail.com (Andrew Vitale)
Date: Fri, 13 Dec 2013 10:47:03 -0800
Subject: [R-sig-Geo] How to output the minimum and maximum value from
 rasterstack into csv/text file??
In-Reply-To: <CABaJH7-aEkZ22foeqYGEriToXV9pnJWymXEZeyWvPf65CLZifw@mail.gmail.com>
References: <CABaJH79tWXLb6teYuZve52tjNfKp_As4DBnRQktg_4xOunhtWA@mail.gmail.com>	<52AA5860.60306@gmail.com>
	<CABaJH7-aEkZ22foeqYGEriToXV9pnJWymXEZeyWvPf65CLZifw@mail.gmail.com>
Message-ID: <52AB5627.4060201@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131213/0b61eed0/attachment.pl>

From ldecola at comcast.net  Fri Dec 13 20:10:11 2013
From: ldecola at comcast.net (ldecola at comcast.net)
Date: Fri, 13 Dec 2013 19:10:11 +0000 (UTC)
Subject: [R-sig-Geo] a spatial bestiary?
In-Reply-To: <52AB5627.4060201@gmail.com>
Message-ID: <1380010390.28177.1386961811566.JavaMail.root@sz0206a.westchester.pa.mail.comcast.net>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131213/e4c02abe/attachment.pl>

From kgfisher at alumni.unc.edu  Fri Dec 13 21:06:56 2013
From: kgfisher at alumni.unc.edu (karengrace84)
Date: Fri, 13 Dec 2013 12:06:56 -0800 (PST)
Subject: [R-sig-Geo] assigning densities to polygons & chloropleth maps
Message-ID: <1386965216080-7585364.post@n2.nabble.com>

I am looking at fish tagging data throughout the state of Louisiana. I have a
shapefile of the state divided into 480 polygons, and I would like to make a
chloropleth map by number of fish tagged in each polygon. Just wondering
what the best way to do this is.

I have no problem assigning all of the tag locations (gps points) to their
designated polygon. But I am not sure how to proceed from there. 

ggplot looks to be the best way to create the graph, but I don't know how to
get my data in the correct format for that function. 

Any guidance is much appreciated!



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/assigning-densities-to-polygons-chloropleth-maps-tp7585364.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From b.rowlingson at lancaster.ac.uk  Sat Dec 14 12:12:48 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Sat, 14 Dec 2013 11:12:48 +0000
Subject: [R-sig-Geo] assigning densities to polygons & chloropleth maps
In-Reply-To: <1d21fa45160a4f2ca34de919ab38ebec@EX-1-HT0.lancs.local>
References: <1d21fa45160a4f2ca34de919ab38ebec@EX-1-HT0.lancs.local>
Message-ID: <CANVKczMVTFAsAnkH7xvuNjtuy=xgp8+Rq+gWJob2aE=J33sB5w@mail.gmail.com>

On Fri, Dec 13, 2013 at 8:06 PM, karengrace84 <kgfisher at alumni.unc.edu> wrote:
> I am looking at fish tagging data throughout the state of Louisiana. I have a
> shapefile of the state divided into 480 polygons, and I would like to make a
> chloropleth map by number of fish tagged in each polygon. Just wondering
> what the best way to do this is.
>
> I have no problem assigning all of the tag locations (gps points) to their
> designated polygon. But I am not sure how to proceed from there.

 So what's the output from that process look like? You want to make a
SpatialPolygonsDataFrame with "NumberOfFish" as one of the variables.
You can work out the number of fish in each polygon from a list of
polygon-ids just by using 'table'. Then match the counts back to the
polygon ids in your SpatialPolygonsDataFrame....

 Once that's done then spplot(df,"NumberOfFish") gets you 99% of the
way there. See the help for spplot for more examples.

> ggplot looks to be the best way to create the graph, but I don't know how to
> get my data in the correct format for that function.

 If you really want to use ggplot/ggmap then you still need a
SpatialPolygonsDataFrame, but you have to "fortify" it and that adds
another level of complication, and I think ggplot still doesn't handle
polygon features with holes and islands as neatly as the routines in
the sp package.

Barry


From hi181904665 at msn.com  Sat Dec 14 13:36:43 2013
From: hi181904665 at msn.com (chenliang wang)
Date: Sat, 14 Dec 2013 20:36:43 +0800
Subject: [R-sig-Geo] Codes or programs that implement models Bayesian
 Spatially Varying Coefficient Process(SVCP) Model
Message-ID: <BLU0-SMTP1653F264316DF41885C1BBCF4DE0@phx.gbl>

Hi, list:

Hopefully this is appropriate here.

I am recently reading some papers about Bayesian Spatially Varying
Coefficient Process(SVCP) Model. I am interested in comparison of
coefficients between BSVCP and GWR.Yet I searched a while on the web
(and within R archives) and trying to locate some codes or routines that
implement BSVCP without much luck. If anyone has any leads, I would
greatly appreciate it.

Thanks in advance.

Best,
Chenliang Wang


From jeandaniel.sylvain at gmail.com  Sat Dec 14 17:03:01 2013
From: jeandaniel.sylvain at gmail.com (Jean-Daniel Sylvain)
Date: Sat, 14 Dec 2013 11:03:01 -0500
Subject: [R-sig-Geo] Intermittent error using clusterR
In-Reply-To: <1386949919376-7585360.post@n2.nabble.com>
References: <1386949919376-7585360.post@n2.nabble.com>
Message-ID: <52AC8135.7000300@gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131214/9f908ba2/attachment.pl>

From mfiandor at gmail.com  Sun Dec 15 23:49:06 2013
From: mfiandor at gmail.com (=?ISO-8859-1?Q?Miguel_Fiandor_Guti=E9rrez?=)
Date: Sun, 15 Dec 2013 23:49:06 +0100
Subject: [R-sig-Geo] how to create maps from topojson files and csv data?
Message-ID: <CACWkvhOs_eH6=ARdYo4jKy6oYT2xHUU36nwwF1hO-xQwMNJWLg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131215/09c0d317/attachment.pl>

From hugues.santin-janin at oncfs.gouv.fr  Mon Dec 16 10:01:41 2013
From: hugues.santin-janin at oncfs.gouv.fr (hugues Santin-Janin)
Date: Mon, 16 Dec 2013 10:01:41 +0100
Subject: [R-sig-Geo] How to estimate LGCP parameters for replicated point
	pattern
Message-ID: <00BFA4D1E0694871BA397308CC6C568E@oncfs.intra>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131216/c4bac530/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Mon Dec 16 11:31:39 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Mon, 16 Dec 2013 10:31:39 +0000
Subject: [R-sig-Geo] how to create maps from topojson files and csv data?
In-Reply-To: <d3712caee38d41f1b28c514a560abf4c@EX-0-HT0.lancs.local>
References: <d3712caee38d41f1b28c514a560abf4c@EX-0-HT0.lancs.local>
Message-ID: <CANVKczOSEFAbkW0g5PstgQnmdqS9d3ZjDnVMqZ+_hZJ8ifBiog@mail.gmail.com>

The geoJSON driver in gdal/ogr will read it from version 2 of OGR:

http://www.gdal.org/ogr/drv_geojson.html

but I think that's very leading-edge (I seem to have v 1.10  on my system).

So the solution would seem to be to convert your topojson to something
that your gdal/ogr can handle, and then read it into R using the rgdal
package readOGR function. I'm having trouble finding a utility that
will do the conversion that way, since most people start from
something and convert it _to_ topojson for fast rendering! I think it
might be necessary to cruft something  together from various python or
javascript modules lying around the web,

>From there its straightforward SpatialPolygonsDataFrame stuff.

Barry

On Sun, Dec 15, 2013 at 10:49 PM, Miguel Fiandor Guti?rrez
<mfiandor at gmail.com> wrote:
> Hi,
>
> I do have some maps in topojson format, and I would like to display data on
> them that i have in .CSVs and access database. So far I play with them with
> d3.js,<http://transparenciadecuentaspublicas.es/2012/madrid/gastos-personales>but
> i'd like to learn too with R.
> My question is not about the csv or db to data frame or similar, is how to
> display any data variable with this kind of map files, I have not found
> literature about it. Yes, each region of the map has its own id code.
>
> The output will end on a pdf file or website, but as soon as I can print
> the map or export it it would be enough.
>
> Thanks
>
> Miguel Fiandor
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From b.rowlingson at lancaster.ac.uk  Mon Dec 16 13:01:56 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Mon, 16 Dec 2013 12:01:56 +0000
Subject: [R-sig-Geo] how to create maps from topojson files and csv data?
In-Reply-To: <CANVKczOSEFAbkW0g5PstgQnmdqS9d3ZjDnVMqZ+_hZJ8ifBiog@mail.gmail.com>
References: <d3712caee38d41f1b28c514a560abf4c@EX-0-HT0.lancs.local>
	<CANVKczOSEFAbkW0g5PstgQnmdqS9d3ZjDnVMqZ+_hZJ8ifBiog@mail.gmail.com>
Message-ID: <CANVKczP=PRP5A4gGWuJtpoceS9EjNZ_-N3Xnu6kx6yhPns5Wdg@mail.gmail.com>

On a more positive note, topojson, like geojson, is just a JSON file,
so you can read it with any of the R JSON interface packages (I've
just read a us.json file using package:RJSONIO).

 The job is then to unweave the structure into something plottable.
topojson works by defining features as sequences of arcs, and arcs as
sequences of coordinates. The arcs are actually defined as a start
point and x-y offsets.

 With a whole load of array lookups (remembering that arc -342 is arc
342 in the reverse direction) you could write some R code to go from
topojson to SpatialPolygons.

 I'm loathe to do this at the moment since I suspect the functionality
to convert from topojson to shapefiles/geojson/some other standard
exists (apart from in ogr 2.0) and it would be easier to re-use that.

 Ooh, it takes me back to my reverse-engineering Arc/Info .e00 files...

Barry


On Mon, Dec 16, 2013 at 10:31 AM, Barry Rowlingson
<b.rowlingson at lancaster.ac.uk> wrote:
> The geoJSON driver in gdal/ogr will read it from version 2 of OGR:
>
> http://www.gdal.org/ogr/drv_geojson.html
>
> but I think that's very leading-edge (I seem to have v 1.10  on my system).
>
> So the solution would seem to be to convert your topojson to something
> that your gdal/ogr can handle, and then read it into R using the rgdal
> package readOGR function. I'm having trouble finding a utility that
> will do the conversion that way, since most people start from
> something and convert it _to_ topojson for fast rendering! I think it
> might be necessary to cruft something  together from various python or
> javascript modules lying around the web,
>
> From there its straightforward SpatialPolygonsDataFrame stuff.
>
> Barry
>
> On Sun, Dec 15, 2013 at 10:49 PM, Miguel Fiandor Guti?rrez
> <mfiandor at gmail.com> wrote:
>> Hi,
>>
>> I do have some maps in topojson format, and I would like to display data on
>> them that i have in .CSVs and access database. So far I play with them with
>> d3.js,<http://transparenciadecuentaspublicas.es/2012/madrid/gastos-personales>but
>> i'd like to learn too with R.
>> My question is not about the csv or db to data frame or similar, is how to
>> display any data variable with this kind of map files, I have not found
>> literature about it. Yes, each region of the map has its own id code.
>>
>> The output will end on a pdf file or website, but as soon as I can print
>> the map or export it it would be enough.
>>
>> Thanks
>>
>> Miguel Fiandor
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From juihan.chang at maine.edu  Mon Dec 16 17:20:54 2013
From: juihan.chang at maine.edu (Jui-Han Chang)
Date: Mon, 16 Dec 2013 11:20:54 -0500
Subject: [R-sig-Geo] covariance matrix for kriging predictions
In-Reply-To: <CAOH3MAktDbTPdkyZCE5ufR9iKWK1K0fxhwr9DUtL6Amn3xSKjA@mail.gmail.com>
References: <CAOH3MAktDbTPdkyZCE5ufR9iKWK1K0fxhwr9DUtL6Amn3xSKjA@mail.gmail.com>
Message-ID: <CAOH3MAk-45YJHJzNU+4M0ZOFTAaYEWvbNUzhBHu+JzUedy6Eow@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131216/8e81b189/attachment.pl>

From kgfisher at alumni.unc.edu  Mon Dec 16 18:23:40 2013
From: kgfisher at alumni.unc.edu (karengrace84)
Date: Mon, 16 Dec 2013 09:23:40 -0800 (PST)
Subject: [R-sig-Geo] assigning densities to polygons & chloropleth maps
In-Reply-To: <CANVKczMVTFAsAnkH7xvuNjtuy=xgp8+Rq+gWJob2aE=J33sB5w@mail.gmail.com>
References: <1386965216080-7585364.post@n2.nabble.com>
	<CANVKczMVTFAsAnkH7xvuNjtuy=xgp8+Rq+gWJob2aE=J33sB5w@mail.gmail.com>
Message-ID: <1387214620171-7585374.post@n2.nabble.com>

Thank you for your help! I had a table (as a data.frame, 2 columns) of each
polygon ID and # of fish tagged in it. Linking it back to the spatial data
was my missing step. I used spCbind to create the SpatialPolygonsDataFrame,
and then spplot as you suggested. Looks good, but I still need to tweak some
of the customization. Any tips on changing the coloration or the breaks in
the scale?





--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/assigning-densities-to-polygons-chloropleth-maps-tp7585364p7585374.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From sravan.mattevada at unthsc.edu  Mon Dec 16 19:19:47 2013
From: sravan.mattevada at unthsc.edu (sravankcm)
Date: Mon, 16 Dec 2013 10:19:47 -0800 (PST)
Subject: [R-sig-Geo] Erron on predict.gstatModel : block kriging for
 long-lat data undefined
Message-ID: <1387217987377-7585375.post@n2.nabble.com>

Hi, 

   I am trying to do Regression Kriging for a metal concentrations with
Depth and Elevation as co-variates.



   Arsenic.txt has columns : X, Y, Metal_Values.
   Covariates are 2 raster files :Depth.tif and Elevation.tif 
   The region is Texas. 

   The projection I am using is : 
           "+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"  
   This is the projection of the .tif file I generated using ArcMap. 

    Both the input metal and co-variates are  in same projection and when I
run the command 

  rf <- fit.gstatModel(metal, formulaString, covariates,
method="randomForest") 

   I get below response.

Fitting a randomForest model...
Warning: Shapiro-Wilk normality test and Anderson-Darling normality test
report probability of < .05 indicating lack of normal distribution for
residuals
Fitting a 2D variogram...
Subsetting observations to 68.2 percent
Saving an object of class 'gstatModel'...
     
  but when I try to use the 

   predict.gstatModel(rf,covariates,nmax=12,predict.method="RK", nfold=5)

    I am getting the below error

   Generating predictions using the trend model (RK method)...
[using ordinary kriging]
  0% done
Error in predict.gstat(g, newdata = newdata, block = block, nsim = nsim,  : 
  gstat: value not allowed for: block kriging for long-lat data undefined

I read through a post having a similar error and changed the projection  to 
"+proj=robin +lon_0=0 +x_0=0 +y_0=0 +datum=WGS84 +units=m +no_defs
+ellps=WGS84 +towgs84=0,0,0"

but this way even the fit.gstatModel(metal, formulaString, covariates,
method="randomForest") 

is throwing an error

Fitting a randomForest model...
Error in randomForest.default(m, y, ...) : data (x) has 0 rows
In addition: Warning message:
In randomForest.default(m, y, ...) :
  The response has five or fewer unique values.  Are you sure you want to do
regression?

Can anybody please help me get the prediction results ? 

 
Thanks 



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Erron-on-predict-gstatModel-block-kriging-for-long-lat-data-undefined-tp7585375.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From mfiandor at gmail.com  Mon Dec 16 19:31:39 2013
From: mfiandor at gmail.com (=?ISO-8859-1?Q?Miguel_Fiandor_Guti=E9rrez?=)
Date: Mon, 16 Dec 2013 19:31:39 +0100
Subject: [R-sig-Geo] how to create maps from topojson files and csv data?
In-Reply-To: <CANVKczP=PRP5A4gGWuJtpoceS9EjNZ_-N3Xnu6kx6yhPns5Wdg@mail.gmail.com>
References: <d3712caee38d41f1b28c514a560abf4c@EX-0-HT0.lancs.local>
	<CANVKczOSEFAbkW0g5PstgQnmdqS9d3ZjDnVMqZ+_hZJ8ifBiog@mail.gmail.com>
	<CANVKczP=PRP5A4gGWuJtpoceS9EjNZ_-N3Xnu6kx6yhPns5Wdg@mail.gmail.com>
Message-ID: <CACWkvhM7MrCv5h4muj_oOdfMUgTTH__-sK7Mmjpso4kww5Leng@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131216/ad199b50/attachment.pl>

From dicko.ahmadou at gmail.com  Mon Dec 16 19:43:54 2013
From: dicko.ahmadou at gmail.com (Ahmadou Dicko)
Date: Mon, 16 Dec 2013 18:43:54 +0000
Subject: [R-sig-Geo] how to create maps from topojson files and csv data?
In-Reply-To: <CACWkvhM7MrCv5h4muj_oOdfMUgTTH__-sK7Mmjpso4kww5Leng@mail.gmail.com>
References: <d3712caee38d41f1b28c514a560abf4c@EX-0-HT0.lancs.local>
	<CANVKczOSEFAbkW0g5PstgQnmdqS9d3ZjDnVMqZ+_hZJ8ifBiog@mail.gmail.com>
	<CANVKczP=PRP5A4gGWuJtpoceS9EjNZ_-N3Xnu6kx6yhPns5Wdg@mail.gmail.com>
	<CACWkvhM7MrCv5h4muj_oOdfMUgTTH__-sK7Mmjpso4kww5Leng@mail.gmail.com>
Message-ID: <CAP8THHWEhEeHeEE7TyjXp_MPe4vv+XLxs5bHC87GrUukobWekQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131216/edd57b8e/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Mon Dec 16 20:03:23 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Mon, 16 Dec 2013 19:03:23 +0000
Subject: [R-sig-Geo] how to create maps from topojson files and csv data?
In-Reply-To: <925d532c81aa4a7d9333621cd02de401@EX-1-HT0.lancs.local>
References: <d3712caee38d41f1b28c514a560abf4c@EX-0-HT0.lancs.local>
	<CANVKczOSEFAbkW0g5PstgQnmdqS9d3ZjDnVMqZ+_hZJ8ifBiog@mail.gmail.com>
	<CANVKczP=PRP5A4gGWuJtpoceS9EjNZ_-N3Xnu6kx6yhPns5Wdg@mail.gmail.com>
	<CACWkvhM7MrCv5h4muj_oOdfMUgTTH__-sK7Mmjpso4kww5Leng@mail.gmail.com>
	<925d532c81aa4a7d9333621cd02de401@EX-1-HT0.lancs.local>
Message-ID: <CANVKczMXptJa9Lw9U7HLefuc4sDvUrY3jVRgOoPFZ8po87JYoQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131216/801314a4/attachment.pl>

From senawusl at yahoo.com  Tue Dec 17 00:36:39 2013
From: senawusl at yahoo.com (senani karunaratne)
Date: Mon, 16 Dec 2013 15:36:39 -0800 (PST)
Subject: [R-sig-Geo] error in vegan - ordiR2step
Message-ID: <1387236999.97353.YahooMailNeo@web121604.mail.ne1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131216/9072cdb4/attachment.pl>

From r.turner at auckland.ac.nz  Tue Dec 17 02:21:57 2013
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Tue, 17 Dec 2013 14:21:57 +1300
Subject: [R-sig-Geo] How to estimate LGCP parameters for replicated
 point pattern
In-Reply-To: <00BFA4D1E0694871BA397308CC6C568E@oncfs.intra>
References: <00BFA4D1E0694871BA397308CC6C568E@oncfs.intra>
Message-ID: <52AFA735.2000704@auckland.ac.nz>



Good question!  (And very clearly expressed.)  I think that the answer 
to "Is there
any way ....?" is currently "no".  We have mppm() which will fit a model 
to independent
replicate patterns assumed to arise from a ***Gibbs*** model, but this 
function
does not work for models arising from clustering mechanisms, which get 
fitted via
the method of minimum contrast.  (Using, as you have noted, kppm().)

I'm not sure how hard (or easy!) it would be to add such a facility.  I 
would guess
not ***too*** hard, but my guesses have sometimes been known to be horribly
wrong.  Adrian B., to whom I am cc-ing this message, will know off the 
top of his
head.  In any event I think a substantial amount of effort would be 
required to
add this facility, and it would take time.

     cheers,

     Rolf Turner

On 16/12/13 22:01, hugues Santin-Janin wrote:
> Dear all,
>
>   
>
> Let P1, P2 and P3 to be 3 realizations of a Log Gaussian Cox Process, say:
>
>   
>
> #Setting parameter values
>
> sigma2 <- 1
>
> kappa <- 1
>
> beta0 <-  3
>
> beta1 <-  4.5
>
> beta2 <- -1.5
>
> beta3 <- 2.5
>
>   
>
> ## spatstat_1.33-0
>
> ##R  3.0.1
>
> library(spatstat)
>
>   
>
> m <- as.im(function(x, y){beta0 + beta1 * x + beta2 * (x^2) + beta3 * y},
> W=owin())
>
>   
>
> #Generating replicated point patterns
>
> set.seed(1)
>
> P1 <- rLGCP("matern", m, c(0, variance=sigma2, nugget=0, scale=1/kappa,
> nu=1))
>
> set.seed(2)
>
> P2 <- rLGCP("matern", m, c(0, variance=sigma2, nugget=0, scale=1/kappa,
> nu=1))
>
> set.seed(3)
>
> P3 <- rLGCP("matern", m, c(0, variance=sigma2, nugget=0, scale=1/kappa,
> nu=1))
>
>   
>
>   
>
> Considering either replicate P1, P2 or P3, estimates of the parameters
> beta0, beta1, beta2, eta3, sigma2 and kappa can be obtained using the kppm
> function:
>
>   
>
> Q1 <- quadscheme(P1)
>
> Est1 <- kppm(Q1, trend=~polynom(x, 2) + y, cluster= "LGCP", method="clik",
> covmodel=list(model="matern", nu=1))
>
>   
>
> Is is possible (and if yes how) to use the kppm function, or any other R
> function,  to estimate the parameters beta0, beta1, beta2, beta3, sigma2 and
> kappa based on the whole dataset (i.e., using the three replicates P1, P2
> and P3) ?


From adrian.baddeley at uwa.edu.au  Tue Dec 17 03:22:32 2013
From: adrian.baddeley at uwa.edu.au (Adrian Baddeley)
Date: Tue, 17 Dec 2013 10:22:32 +0800
Subject: [R-sig-Geo] How to estimate LGCP parameters for replicated
 point pattern
In-Reply-To: <52AFA735.2000704@auckland.ac.nz>
References: <00BFA4D1E0694871BA397308CC6C568E@oncfs.intra>,
	<52AFA735.2000704@auckland.ac.nz>
Message-ID: <CF5661163F77A44781208D9AC4FDEA7226E8DF9754@IS-WIN-376.staffad.uwa.edu.au>

Hugues Santin-Janin writes:

> Is it possible to use the kppm function to estimate the parameters
>  beta0, beta1, beta2, beta3, sigma2 and kappa based on the whole dataset 
> (i.e., using the three replicates P1, P2 and P3) ?

This can be done by pooling the K-functions and using lgcp.estK.

First use 'mppm' to estimate the trend parameters beta*. 

     Data <- hyperframe(Points=list(P1,P2,P3))
     fit <- mppm(Points ~ polynom(x,2) + y, data=Data)

Then use predict.mppm to compute the fitted intensity.

    Lam <- predict(fit)
    Data$Lambda <- Lam

Then use Kinhom to estimate the inhomogeneous K-functions for each of the
patterns P1, P2, P3.

     K <- with(Data, Kinhom(Points, Lambda))

At the moment, these functions must be pooled by hand.
Use weights proportional to n*(n-1) where
n is the number of points in each pattern. 

     n <- with(Data, npoints(Points))
     nn1 <- n * (n-1)
     
     K1 <- K[[1]]
     K2 <- K[[2]]
     K3 <- K[[3]]
     Kpool <- eval.fv( (K1 * nn1[1]  + K2 * nn1[2] + K3 * nn1[3])/sum(nn1))
    
Finally 

     mod <- lgcp.estK(Kpool)


In future, mppm() will be able to do this.

Prof Adrian Baddeley FAA
University of Western Australia
________________________________________
From: Rolf Turner [r.turner at auckland.ac.nz]
Sent: Tuesday, 17 December 2013 9:21 AM
To: hugues Santin-Janin
Cc: r-sig-geo at r-project.org; Adrian Baddeley
Subject: Re: [R-sig-Geo] How to estimate LGCP parameters for replicated point pattern

Good question!  (And very clearly expressed.)  I think that the answer
to "Is there
any way ....?" is currently "no".  We have mppm() which will fit a model
to independent
replicate patterns assumed to arise from a ***Gibbs*** model, but this
function
does not work for models arising from clustering mechanisms, which get
fitted via
the method of minimum contrast.  (Using, as you have noted, kppm().)

I'm not sure how hard (or easy!) it would be to add such a facility.  I
would guess
not ***too*** hard, but my guesses have sometimes been known to be horribly
wrong.  Adrian B., to whom I am cc-ing this message, will know off the
top of his
head.  In any event I think a substantial amount of effort would be
required to
add this facility, and it would take time.

     cheers,

     Rolf Turner

On 16/12/13 22:01, hugues Santin-Janin wrote:
> Dear all,
>
>
>
> Let P1, P2 and P3 to be 3 realizations of a Log Gaussian Cox Process, say:
>
>
>
> #Setting parameter values
>
> sigma2 <- 1
>
> kappa <- 1
>
> beta0 <-  3
>
> beta1 <-  4.5
>
> beta2 <- -1.5
>
> beta3 <- 2.5
>
>
>
> ## spatstat_1.33-0
>
> ##R  3.0.1
>
> library(spatstat)
>
>
>
> m <- as.im(function(x, y){beta0 + beta1 * x + beta2 * (x^2) + beta3 * y},
> W=owin())
>
>
>
> #Generating replicated point patterns
>
> set.seed(1)
>
> P1 <- rLGCP("matern", m, c(0, variance=sigma2, nugget=0, scale=1/kappa,
> nu=1))
>
> set.seed(2)
>
> P2 <- rLGCP("matern", m, c(0, variance=sigma2, nugget=0, scale=1/kappa,
> nu=1))
>
> set.seed(3)
>
> P3 <- rLGCP("matern", m, c(0, variance=sigma2, nugget=0, scale=1/kappa,
> nu=1))
>
>
>
>
>
> Considering either replicate P1, P2 or P3, estimates of the parameters
> beta0, beta1, beta2, eta3, sigma2 and kappa can be obtained using the kppm
> function:
>
>
>
> Q1 <- quadscheme(P1)
>
> Est1 <- kppm(Q1, trend=~polynom(x, 2) + y, cluster= "LGCP", method="clik",
> covmodel=list(model="matern", nu=1))
>
>
>
> Is is possible (and if yes how) to use the kppm function, or any other R
> function,  to estimate the parameters beta0, beta1, beta2, beta3, sigma2 and
> kappa based on the whole dataset (i.e., using the three replicates P1, P2
> and P3) ?


From alobolistas at gmail.com  Tue Dec 17 09:06:10 2013
From: alobolistas at gmail.com (Agustin Lobo)
Date: Tue, 17 Dec 2013 09:06:10 +0100
Subject: [R-sig-Geo] Error in .gd_SetProject(transient, crs(r))
In-Reply-To: <CAP8THHW+kc5V1K1RLVtc5oGYn-rCEozUGrZA1A0UUU6m+i9AMQ@mail.gmail.com>
References: <1386698273714-7585330.post@n2.nabble.com>
	<CAG4NReKF_eaEJZjUscFuuyxXM376LG1SzOMnsZ_--kSR3oD4fA@mail.gmail.com>
	<CAP8THHW+kc5V1K1RLVtc5oGYn-rCEozUGrZA1A0UUU6m+i9AMQ@mail.gmail.com>
Message-ID: <CAG4NReK=YqMdbymVPyh2Ak-MsaY9uvLjgKDUWyRafVf=rccWjw@mail.gmail.com>

Well, I rather don't, rgdal is critical for me.
Perhaps it is more a problem of gdal itself than of rgdal or raster.
I'm using
Loaded GDAL runtime: GDAL 1.10.0, released 2013/04/24

Which gdal version are you using?
Agus

On Thu, Dec 12, 2013 at 2:35 PM, Ahmadou Dicko <dicko.ahmadou at gmail.com> wrote:
> Using rgdal_0.8-14  and raster_2.1-71 it doesn't work for me.
> Try to update your packages and try again.
>
> sessionInfo()
> R version 3.0.2 Patched (2013-12-05 r64394)
> Platform: x86_64-unknown-linux-gnu (64-bit)
>
> locale:
>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
>  [9] LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods
> [7] base
>
> other attached packages:
> [1] rgdal_0.8-14  raster_2.1-71 sp_1.0-14
>
> loaded via a namespace (and not attached):
> [1] grid_3.0.2      lattice_0.20-24
>
>
>
>
>
> On Thu, Dec 12, 2013 at 1:23 PM, Agustin Lobo <alobolistas at gmail.com> wrote:
>
>> I have no problem on linux with QGIS 2.01, RStudio Version 0.98.484
>> and
>> rgdal: version: 0.8-11, (SVN revision 479M)
>> Geospatial Data Abstraction Library extensions to R successfully loaded
>> Loaded GDAL runtime: GDAL 1.10.0, released 2013/04/24
>> > sessionInfo()
>> R version 3.0.2 (2013-09-25)
>> Platform: x86_64-pc-linux-gnu (64-bit)
>>
>> locale:
>>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>> LC_TIME=es_ES.UTF-8        LC_COLLATE=en_US.UTF-8
>>  [5] LC_MONETARY=es_ES.UTF-8    LC_MESSAGES=en_US.UTF-8
>> LC_PAPER=es_ES.UTF-8       LC_NAME=C
>>  [9] LC_ADDRESS=C               LC_TELEPHONE=C
>> LC_MEASUREMENT=es_ES.UTF-8 LC_IDENTIFICATION=C
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> other attached packages:
>> [1] raster_2.1-49 rgdal_0.8-11  sp_1.0-13     lmodel2_1.7-1
>> xtable_1.7-1  knitr_1.5
>>
>> loaded via a namespace (and not attached):
>> [1] codetools_0.2-8 digest_0.6.3    evaluate_0.5.1  formatR_0.9
>> grid_3.0.2      lattice_0.20-24 markdown_0.6.3
>> [8] stringr_0.6.2   tools_3.0.2
>>
>>
>> On Tue, Dec 10, 2013 at 6:57 PM, Guillaume Drolet
>> <droletguillaume at gmail.com> wrote:
>> > Hello,
>> >
>> > This morning I updated RStudio to version 0.98.484, and Quantum GIS to
>> > version 2.0.1 (Dufour) using the standalone installer.
>> >
>> > After that, I tried to run some code in RStudio and I got the error
>> message
>> > below when running the following command:
>> >
>> >> filename <- "test.tif"
>> >> try(writeRaster(raster(matrix(1, 1, 1)), filename = filename, overwrite
>> =
>> >> overwrite))
>> >
>> > Error in .gd_SetProject(transient, crs(r)) :
>> >   STRING_ELT() can only be applied to a 'character vector', not a
>> 'logical'
>> >
>> > Then, I updated rgdal to version 0.8-14 and now I get this error when
>> > running the same code:
>> >
>> > Error in .gd_SetProject(object, ...) :
>> >   STRING_ELT() can only be applied to a 'character vector', not a
>> 'logical'
>> >
>> > Until this morning, I never had any problem with that line of code
>> above. I
>> > suspect this could be due to the QGIS installation that could have messed
>> > with my GDAL installation: is that possible (is GDAL used by rgdal at
>> all)?
>> > I tried uninstalling QGIS but I still get the same error message.
>> >
>> > My session info:
>> >
>> > R version 3.0.2 (2013-09-25)
>> > Platform: x86_64-w64-mingw32/x64 (64-bit)
>> >
>> > locale:
>> > [1] LC_COLLATE=French_Canada.1252  LC_CTYPE=French_Canada.1252
>> > LC_MONETARY=French_Canada.1252
>> > [4] LC_NUMERIC=C                   LC_TIME=French_Canada.1252
>> >
>> > attached base packages:
>> > [1] stats     graphics  grDevices utils     datasets  methods   base
>> >
>> > other attached packages:
>> >  [1] fmask_0.1         RSAGA_0.93-6      plyr_1.8          shapefiles_0.7
>> > foreign_0.8-55
>> >  [6] gstat_1.0-18      data.table_1.8.10 rgdal_0.8-14      roxygen2_3.0.0
>> > raster_2.1-68
>> > [11] sp_1.0-14
>> >
>> > loaded via a namespace (and not attached):
>> >  [1] brew_1.0-6       codetools_0.2-8  digest_0.6.3     grid_3.0.2
>> > intervals_0.14.0 lattice_0.20-23
>> >  [7] spacetime_1.0-9  stringr_0.6.2    tools_3.0.2      xts_0.9-7
>> > zoo_1.7-10
>> >
>> > I will be very grateful of any help or piece of advice on how to fix
>> that or
>> > where to look for clues.
>> >
>> > Best wishes,
>> > Guillaume
>> >
>> >
>> >
>> > --
>> > View this message in context:
>> http://r-sig-geo.2731867.n2.nabble.com/Error-in-gd-SetProject-transient-crs-r-tp7585330.html
>> > Sent from the R-sig-geo mailing list archive at Nabble.com.
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at r-project.org
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
>
> --
> Ahmadou H. DICKO
> statistician economist (Ing?nieur Statisticien ?conomiste)
> PhD candidate in Climate change economics
> Faculty of economics and managment - Cheikh Anta Diop University
> West African Science Service Center on Climate Change and Adaptated Land
> Use (WASCAL)
> Center for Development Research (ZEF) - University of Bonn
> email : ahmadou.dicko at ucad.edu.sn
> twitter : @dickoah
> github : github/dickoa <https://github.com/dickoa>
> tel : +221 33 827 55 16
> portable: +221 77 123 81 69
>
>         [[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From dicko.ahmadou at gmail.com  Tue Dec 17 09:15:12 2013
From: dicko.ahmadou at gmail.com (Ahmadou Dicko)
Date: Tue, 17 Dec 2013 08:15:12 +0000
Subject: [R-sig-Geo] Error in .gd_SetProject(transient, crs(r))
In-Reply-To: <CAG4NReK=YqMdbymVPyh2Ak-MsaY9uvLjgKDUWyRafVf=rccWjw@mail.gmail.com>
References: <1386698273714-7585330.post@n2.nabble.com>
	<CAG4NReKF_eaEJZjUscFuuyxXM376LG1SzOMnsZ_--kSR3oD4fA@mail.gmail.com>
	<CAP8THHW+kc5V1K1RLVtc5oGYn-rCEozUGrZA1A0UUU6m+i9AMQ@mail.gmail.com>
	<CAG4NReK=YqMdbymVPyh2Ak-MsaY9uvLjgKDUWyRafVf=rccWjw@mail.gmail.com>
Message-ID: <CAP8THHUz2KPDZYeYmibYDk2S+FivBhFMYmxN4pW=Vm6uR6FAMQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131217/adcf61f3/attachment.pl>

From jari.oksanen at oulu.fi  Tue Dec 17 09:22:52 2013
From: jari.oksanen at oulu.fi (Jari Oksanen)
Date: Tue, 17 Dec 2013 08:22:52 +0000
Subject: [R-sig-Geo] error in vegan - ordiR2step
In-Reply-To: <1387236999.97353.YahooMailNeo@web121604.mail.ne1.yahoo.com>
References: <1387236999.97353.YahooMailNeo@web121604.mail.ne1.yahoo.com>
Message-ID: <E3BD7036-783C-4183-B5A7-17DF7D319D63@oulu.fi>

Dear Senani Karunratne,

This does not look like a question for r-sig-geo, but should rather be addressed to r-sig-eco. Further, this is not reproducible: I cannot find a combination of commands, data or models that gives this error message (I can generate several other messages by making deliberate errors, but not this one). Please make a small reproducible example and send it to, say, r-sig-eco, and we can try to see what was the problem.

Cheers, Jari Oksanen
On 17/12/2013, at 01:36 AM, senani karunaratne wrote:

> Dear Members,
> I get an error when I used ordiR2step command in "Vegan". However, same command is work for another dataset. 
> 
> nsk.rda.forward <- ordiR2step(rda(sp.h~1, data=env_d, scale=F), scope=formula(nsk.rda.all), direction="forward", pstep=100, perm.max = 1000)
> 
> 
> ## error
> Error in eval(expr, envir, enclos) : could not find function "Condition"
> 
> 
> Information about the two matixes are as follows; 
>> dim(sp.h)
> 
> [1] 718 171
> 
> 
>> dim(env_d)
> 
> 718  65
> 
> 
> Much appreciated if any one tell me how to fixed this issue. 
> 
> Thanks
> 
> Senani
> 
>  
> senani karunaratne
> University of Sydney
> Australia
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From alexandresantosbr at yahoo.com.br  Tue Dec 17 12:13:19 2013
From: alexandresantosbr at yahoo.com.br (ASANTOS)
Date: Tue, 17 Dec 2013 08:13:19 -0300
Subject: [R-sig-Geo] Create unusual data set with ppp object
Message-ID: <52B031CF.7080309@yahoo.com.br>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131217/e8478f30/attachment.pl>

From pisicandru at hotmail.com  Tue Dec 17 16:50:27 2013
From: pisicandru at hotmail.com (Monica Pisica)
Date: Tue, 17 Dec 2013 15:50:27 +0000
Subject: [R-sig-Geo] Convert polyline shapefile to points 1m apart and add
	xy coordinates
Message-ID: <BAY168-W3994FD876D94D6F65E780FC3DB0@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131217/ca503ccf/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Tue Dec 17 19:10:46 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Tue, 17 Dec 2013 18:10:46 +0000
Subject: [R-sig-Geo] how to create maps from topojson files and csv data?
In-Reply-To: <76043ee8e79b4e258f0fa5a405c70e81@EX-0-HT0.lancs.local>
References: <d3712caee38d41f1b28c514a560abf4c@EX-0-HT0.lancs.local>
	<CANVKczOSEFAbkW0g5PstgQnmdqS9d3ZjDnVMqZ+_hZJ8ifBiog@mail.gmail.com>
	<CANVKczP=PRP5A4gGWuJtpoceS9EjNZ_-N3Xnu6kx6yhPns5Wdg@mail.gmail.com>
	<CACWkvhM7MrCv5h4muj_oOdfMUgTTH__-sK7Mmjpso4kww5Leng@mail.gmail.com>
	<925d532c81aa4a7d9333621cd02de401@EX-1-HT0.lancs.local>
	<76043ee8e79b4e258f0fa5a405c70e81@EX-0-HT0.lancs.local>
Message-ID: <CANVKczPFp=r6p4BbzZoWn4i4XCMCP45xX23fhppAS3KM5=-hVw@mail.gmail.com>

On Mon, Dec 16, 2013 at 7:03 PM, Rowlingson, Barry
<b.rowlingson at lancaster.ac.uk> wrote:

> I might try and bash out a converter based on RJSONIO if I get a spare hour
> tomorrow or if anyone wants to pledge some cold hard cash!

 I've done a chunk of work on this, the problem now is just working
round the fiddly bits of various geometry specifications and the
irregularities of how JSON gets read into R structures.

 I suppose if I pushed it to github all of you could help out...

Barry


From dicko.ahmadou at gmail.com  Tue Dec 17 20:48:35 2013
From: dicko.ahmadou at gmail.com (Ahmadou Dicko)
Date: Tue, 17 Dec 2013 19:48:35 +0000
Subject: [R-sig-Geo] how to create maps from topojson files and csv data?
In-Reply-To: <CANVKczPFp=r6p4BbzZoWn4i4XCMCP45xX23fhppAS3KM5=-hVw@mail.gmail.com>
References: <d3712caee38d41f1b28c514a560abf4c@EX-0-HT0.lancs.local>
	<CANVKczOSEFAbkW0g5PstgQnmdqS9d3ZjDnVMqZ+_hZJ8ifBiog@mail.gmail.com>
	<CANVKczP=PRP5A4gGWuJtpoceS9EjNZ_-N3Xnu6kx6yhPns5Wdg@mail.gmail.com>
	<CACWkvhM7MrCv5h4muj_oOdfMUgTTH__-sK7Mmjpso4kww5Leng@mail.gmail.com>
	<925d532c81aa4a7d9333621cd02de401@EX-1-HT0.lancs.local>
	<76043ee8e79b4e258f0fa5a405c70e81@EX-0-HT0.lancs.local>
	<CANVKczPFp=r6p4BbzZoWn4i4XCMCP45xX23fhppAS3KM5=-hVw@mail.gmail.com>
Message-ID: <CAP8THHVkcKW0P3Q8x6o0QRWraH-RK_ZP+GxY+ve3gHqOUDjq7Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131217/a8f1e885/attachment.pl>

From r.hijmans at gmail.com  Wed Dec 18 03:26:47 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 17 Dec 2013 18:26:47 -0800
Subject: [R-sig-Geo] Error in .gd_SetProject(transient, crs(r))
In-Reply-To: <CAP8THHUz2KPDZYeYmibYDk2S+FivBhFMYmxN4pW=Vm6uR6FAMQ@mail.gmail.com>
References: <1386698273714-7585330.post@n2.nabble.com>
	<CAG4NReKF_eaEJZjUscFuuyxXM376LG1SzOMnsZ_--kSR3oD4fA@mail.gmail.com>
	<CAP8THHW+kc5V1K1RLVtc5oGYn-rCEozUGrZA1A0UUU6m+i9AMQ@mail.gmail.com>
	<CAG4NReK=YqMdbymVPyh2Ak-MsaY9uvLjgKDUWyRafVf=rccWjw@mail.gmail.com>
	<CAP8THHUz2KPDZYeYmibYDk2S+FivBhFMYmxN4pW=Vm6uR6FAMQ@mail.gmail.com>
Message-ID: <CANtt_hwd_SQpOc=Ux96rqXmptJAFHGZYWi=V__tNM4R38KquWg@mail.gmail.com>

I think this has been fixed in the development version, which I will
release this week.
You can download and try this version from here:
http://r-forge.r-project.org/R/?group_id=294
Or: install.packages("raster", repos="http://R-Forge.R-project.org")
Robert

On Tue, Dec 17, 2013 at 12:15 AM, Ahmadou Dicko <dicko.ahmadou at gmail.com> wrote:
> I use GDAL 1.10 too
>
> gdalinfo --version
> GDAL 1.10.0, released 2013/04/24
>
>
>
>
> On Tue, Dec 17, 2013 at 8:06 AM, Agustin Lobo <alobolistas at gmail.com> wrote:
>
>> Well, I rather don't, rgdal is critical for me.
>> Perhaps it is more a problem of gdal itself than of rgdal or raster.
>> I'm using
>> Loaded GDAL runtime: GDAL 1.10.0, released 2013/04/24
>>
>> Which gdal version are you using?
>> Agus
>>
>> On Thu, Dec 12, 2013 at 2:35 PM, Ahmadou Dicko <dicko.ahmadou at gmail.com>
>> wrote:
>> > Using rgdal_0.8-14  and raster_2.1-71 it doesn't work for me.
>> > Try to update your packages and try again.
>> >
>> > sessionInfo()
>> > R version 3.0.2 Patched (2013-12-05 r64394)
>> > Platform: x86_64-unknown-linux-gnu (64-bit)
>> >
>> > locale:
>> >  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>> >  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>> >  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>> >  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
>> >  [9] LC_ADDRESS=C               LC_TELEPHONE=C
>> > [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>> >
>> > attached base packages:
>> > [1] stats     graphics  grDevices utils     datasets  methods
>> > [7] base
>> >
>> > other attached packages:
>> > [1] rgdal_0.8-14  raster_2.1-71 sp_1.0-14
>> >
>> > loaded via a namespace (and not attached):
>> > [1] grid_3.0.2      lattice_0.20-24
>> >
>> >
>> >
>> >
>> >
>> > On Thu, Dec 12, 2013 at 1:23 PM, Agustin Lobo <alobolistas at gmail.com>
>> wrote:
>> >
>> >> I have no problem on linux with QGIS 2.01, RStudio Version 0.98.484
>> >> and
>> >> rgdal: version: 0.8-11, (SVN revision 479M)
>> >> Geospatial Data Abstraction Library extensions to R successfully loaded
>> >> Loaded GDAL runtime: GDAL 1.10.0, released 2013/04/24
>> >> > sessionInfo()
>> >> R version 3.0.2 (2013-09-25)
>> >> Platform: x86_64-pc-linux-gnu (64-bit)
>> >>
>> >> locale:
>> >>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>> >> LC_TIME=es_ES.UTF-8        LC_COLLATE=en_US.UTF-8
>> >>  [5] LC_MONETARY=es_ES.UTF-8    LC_MESSAGES=en_US.UTF-8
>> >> LC_PAPER=es_ES.UTF-8       LC_NAME=C
>> >>  [9] LC_ADDRESS=C               LC_TELEPHONE=C
>> >> LC_MEASUREMENT=es_ES.UTF-8 LC_IDENTIFICATION=C
>> >>
>> >> attached base packages:
>> >> [1] stats     graphics  grDevices utils     datasets  methods   base
>> >>
>> >> other attached packages:
>> >> [1] raster_2.1-49 rgdal_0.8-11  sp_1.0-13     lmodel2_1.7-1
>> >> xtable_1.7-1  knitr_1.5
>> >>
>> >> loaded via a namespace (and not attached):
>> >> [1] codetools_0.2-8 digest_0.6.3    evaluate_0.5.1  formatR_0.9
>> >> grid_3.0.2      lattice_0.20-24 markdown_0.6.3
>> >> [8] stringr_0.6.2   tools_3.0.2
>> >>
>> >>
>> >> On Tue, Dec 10, 2013 at 6:57 PM, Guillaume Drolet
>> >> <droletguillaume at gmail.com> wrote:
>> >> > Hello,
>> >> >
>> >> > This morning I updated RStudio to version 0.98.484, and Quantum GIS to
>> >> > version 2.0.1 (Dufour) using the standalone installer.
>> >> >
>> >> > After that, I tried to run some code in RStudio and I got the error
>> >> message
>> >> > below when running the following command:
>> >> >
>> >> >> filename <- "test.tif"
>> >> >> try(writeRaster(raster(matrix(1, 1, 1)), filename = filename,
>> overwrite
>> >> =
>> >> >> overwrite))
>> >> >
>> >> > Error in .gd_SetProject(transient, crs(r)) :
>> >> >   STRING_ELT() can only be applied to a 'character vector', not a
>> >> 'logical'
>> >> >
>> >> > Then, I updated rgdal to version 0.8-14 and now I get this error when
>> >> > running the same code:
>> >> >
>> >> > Error in .gd_SetProject(object, ...) :
>> >> >   STRING_ELT() can only be applied to a 'character vector', not a
>> >> 'logical'
>> >> >
>> >> > Until this morning, I never had any problem with that line of code
>> >> above. I
>> >> > suspect this could be due to the QGIS installation that could have
>> messed
>> >> > with my GDAL installation: is that possible (is GDAL used by rgdal at
>> >> all)?
>> >> > I tried uninstalling QGIS but I still get the same error message.
>> >> >
>> >> > My session info:
>> >> >
>> >> > R version 3.0.2 (2013-09-25)
>> >> > Platform: x86_64-w64-mingw32/x64 (64-bit)
>> >> >
>> >> > locale:
>> >> > [1] LC_COLLATE=French_Canada.1252  LC_CTYPE=French_Canada.1252
>> >> > LC_MONETARY=French_Canada.1252
>> >> > [4] LC_NUMERIC=C                   LC_TIME=French_Canada.1252
>> >> >
>> >> > attached base packages:
>> >> > [1] stats     graphics  grDevices utils     datasets  methods   base
>> >> >
>> >> > other attached packages:
>> >> >  [1] fmask_0.1         RSAGA_0.93-6      plyr_1.8
>>  shapefiles_0.7
>> >> > foreign_0.8-55
>> >> >  [6] gstat_1.0-18      data.table_1.8.10 rgdal_0.8-14
>>  roxygen2_3.0.0
>> >> > raster_2.1-68
>> >> > [11] sp_1.0-14
>> >> >
>> >> > loaded via a namespace (and not attached):
>> >> >  [1] brew_1.0-6       codetools_0.2-8  digest_0.6.3     grid_3.0.2
>> >> > intervals_0.14.0 lattice_0.20-23
>> >> >  [7] spacetime_1.0-9  stringr_0.6.2    tools_3.0.2      xts_0.9-7
>> >> > zoo_1.7-10
>> >> >
>> >> > I will be very grateful of any help or piece of advice on how to fix
>> >> that or
>> >> > where to look for clues.
>> >> >
>> >> > Best wishes,
>> >> > Guillaume
>> >> >
>> >> >
>> >> >
>> >> > --
>> >> > View this message in context:
>> >>
>> http://r-sig-geo.2731867.n2.nabble.com/Error-in-gd-SetProject-transient-crs-r-tp7585330.html
>> >> > Sent from the R-sig-geo mailing list archive at Nabble.com.
>> >> >
>> >> > _______________________________________________
>> >> > R-sig-Geo mailing list
>> >> > R-sig-Geo at r-project.org
>> >> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >>
>> >> _______________________________________________
>> >> R-sig-Geo mailing list
>> >> R-sig-Geo at r-project.org
>> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >>
>> >
>> >
>> >
>> > --
>> > Ahmadou H. DICKO
>> > statistician economist (Ing?nieur Statisticien ?conomiste)
>> > PhD candidate in Climate change economics
>> > Faculty of economics and managment - Cheikh Anta Diop University
>> > West African Science Service Center on Climate Change and Adaptated Land
>> > Use (WASCAL)
>> > Center for Development Research (ZEF) - University of Bonn
>> > email : ahmadou.dicko at ucad.edu.sn
>> > twitter : @dickoah
>> > github : github/dickoa <https://github.com/dickoa>
>> > tel : +221 33 827 55 16
>> > portable: +221 77 123 81 69
>> >
>> >         [[alternative HTML version deleted]]
>> >
>> >
>> > _______________________________________________
>> > R-sig-Geo mailing list
>> > R-sig-Geo at r-project.org
>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> >
>>
>
>
>
> --
> Ahmadou H. DICKO
> statistician economist (Ing?nieur Statisticien ?conomiste)
> PhD candidate in Climate change economics
> Faculty of economics and managment - Cheikh Anta Diop University
> West African Science Service Center on Climate Change and Adaptated Land
> Use (WASCAL)
> Center for Development Research (ZEF) - University of Bonn
> email : ahmadou.dicko at ucad.edu.sn
> twitter : @dickoah
> github : github/dickoa <https://github.com/dickoa>
> tel : +221 33 827 55 16
> portable: +221 77 123 81 69
>
>         [[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From edzer.pebesma at uni-muenster.de  Wed Dec 18 12:07:00 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 18 Dec 2013 12:07:00 +0100
Subject: [R-sig-Geo] One-Click-Reproduce
Message-ID: <52B181D4.2010800@uni-muenster.de>

In the earth and planetary innovation contest organized by Elsevier, the
jury decided to award the first price to my One-Click-Reproduce (with R)
proposal; see

http://www.elsevier-epic.com/

and

http://ifgi.uni-muenster.de/~epebe_01/epic.pdf

for the full proposal text. In January, we will start talking with
Elsevier on how to realize this. Suggestions are welcome!

I'm grateful to Chris Kray, Gilberto Camara, Christoph Stasch, Roger
Bivand, Tom Hengl, Gerard Heuvelink and Daniel Nuest, who all helped
with suggestions and improvements.
-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 555 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131218/113d5a22/attachment.bin>

From culinovic.domagoj at gmail.com  Wed Dec 18 12:19:10 2013
From: culinovic.domagoj at gmail.com (Domagoj Culinovic)
Date: Wed, 18 Dec 2013 12:19:10 +0100
Subject: [R-sig-Geo] R -> QGIS - Web-GIS
Message-ID: <CACgt3onO-154jhDkD0e-HgAQC0Ph6ckRfXM=yJvr+YZcoH=qRA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131218/15804c35/attachment.pl>

From jon.skoien at jrc.ec.europa.eu  Wed Dec 18 14:04:29 2013
From: jon.skoien at jrc.ec.europa.eu (jon skoien)
Date: Wed, 18 Dec 2013 14:04:29 +0100
Subject: [R-sig-Geo] Intamap, reduce verbose output of idw method
In-Reply-To: <CALDV4snDGNQoVtMMtmGNy7_pmsncG87ryLpV_dKbdYBgSc5Yeg@mail.gmail.com>
References: <CAGFWpktq+b0tARuGFGN3=QaUt9AG43Jm_9ZnCgJ8e1igZHNZJA@mail.gmail.com>
	<5293619C.80308@jrc.ec.europa.eu>
	<CALDV4snDGNQoVtMMtmGNy7_pmsncG87ryLpV_dKbdYBgSc5Yeg@mail.gmail.com>
Message-ID: <7470fc6f2826.52b1ab6d@jrc.ec.europa.eu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131218/cbca510f/attachment.pl>

From alexander.zimmermann.ii at uni-potsdam.de  Wed Dec 18 16:08:45 2013
From: alexander.zimmermann.ii at uni-potsdam.de (Alexander Zimmermann)
Date: Wed, 18 Dec 2013 16:08:45 +0100
Subject: [R-sig-Geo] Combining polygons and calculating their area (i.e.
	number of	cells)
Message-ID: <20131218160845.y3i58izfkkswcw8k@webmail.uni-potsdam.de>

Dear All,

I have a problem with combining polygons and calculating their area.
In the following I try to provide a description of the problem:
I have a simple raster (created with R-package: raster). Using the function
"rasterToPolygons" I get polygons of all raster cells that contain the  
value "1":

library(raster)
dat = list()
dat$x = seq(1.5, by = 10, len = 10)
dat$y = seq(3.5, by = 10, len = 15)
dat$z = matrix(sample(c(0,1), size = 10*15, replace = T), 10, 15)
r=raster(dat);plot(r)
r_poly = rasterToPolygons(r, fun = function(r) {r == 1}, dissolve = F)
plot(r_poly, add = T)

I do not use "dissolve = T" to avoid that all polygons are merged into  
one big polygon (i.e. a multipart polygon). Instead, I wish to obtain  
a new SpatialPolygonsDataFrame in which all polygons that share an  
edge or a point are combined. Polygons that are clearly separated  
should be identifiable as individual polygons (i.e. I wish to avoid to  
obtain a multipart polygon). Based on the new SpatialPolygonsDataFrame  
I would like to analyze the size of the combined (individual) polygons  
as follows:

b = extract(r,r_poly_new) # "r_poly_new" contains the combined polygons
str(b)                    # list of clearly separated polygons
tab = lapply(b,table)
tab

My question is twofold:
1) How to combine polygons that share an edge or point (under the  
constraint that clearly separated polygons remain individual polygons)?
2) How to get this information into a format which allows analyzing  
the areas of the combined (but not multipart) polygons?

Thank you very much for your feedback.

Alex Zimmermann

--------------------------------------------------------------------
Dr. Alexander Zimmermann
Institute of Earth and Environmental Science, University of Potsdam
Karl-Liebknecht-Str. 24-25, 14476 Potsdam - Golm, Germany
phone +49-(0)331-9772047, fax +49-(0)331-9772068


From b.rowlingson at lancaster.ac.uk  Wed Dec 18 16:31:25 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Wed, 18 Dec 2013 15:31:25 +0000
Subject: [R-sig-Geo] how to create maps from topojson files and csv data?
In-Reply-To: <d3f08614caa143f489ef060eb16903fc@EX-1-HT0.lancs.local>
References: <d3712caee38d41f1b28c514a560abf4c@EX-0-HT0.lancs.local>
	<CANVKczOSEFAbkW0g5PstgQnmdqS9d3ZjDnVMqZ+_hZJ8ifBiog@mail.gmail.com>
	<CANVKczP=PRP5A4gGWuJtpoceS9EjNZ_-N3Xnu6kx6yhPns5Wdg@mail.gmail.com>
	<CACWkvhM7MrCv5h4muj_oOdfMUgTTH__-sK7Mmjpso4kww5Leng@mail.gmail.com>
	<925d532c81aa4a7d9333621cd02de401@EX-1-HT0.lancs.local>
	<76043ee8e79b4e258f0fa5a405c70e81@EX-0-HT0.lancs.local>
	<CANVKczPFp=r6p4BbzZoWn4i4XCMCP45xX23fhppAS3KM5=-hVw@mail.gmail.com>
	<d3f08614caa143f489ef060eb16903fc@EX-1-HT0.lancs.local>
Message-ID: <CANVKczOmEMTA7vyVXTA375G_szMjTPjLjMoXpRkxjqm88KOokw@mail.gmail.com>

Here you are:

https://github.com/barryrowlingson/rtopojson

its very alpha at the moment, and its shortcomings are hopefully fully
spelled out in the README file!

Barry


On Tue, Dec 17, 2013 at 7:48 PM, Ahmadou Dicko <dicko.ahmadou at gmail.com> wrote:
>> I suppose if I pushed it to github all of you could help out...
>
>
> Sure, I can give a try.
> Just let me know when you push it
>
>
>
>
> On Tue, Dec 17, 2013 at 6:10 PM, Barry Rowlingson
> <b.rowlingson at lancaster.ac.uk> wrote:
>>
>> On Mon, Dec 16, 2013 at 7:03 PM, Rowlingson, Barry
>> <b.rowlingson at lancaster.ac.uk> wrote:
>>
>> > I might try and bash out a converter based on RJSONIO if I get a spare
>> > hour
>> > tomorrow or if anyone wants to pledge some cold hard cash!
>>
>>  I've done a chunk of work on this, the problem now is just working
>> round the fiddly bits of various geometry specifications and the
>> irregularities of how JSON gets read into R structures.
>>
>>  I suppose if I pushed it to github all of you could help out...
>>
>> Barry
>
>
>
>
> --
> Ahmadou H. DICKO
> statistician economist (Ing?nieur Statisticien ?conomiste)
> PhD candidate in Climate change economics
> Faculty of economics and managment - Cheikh Anta Diop University
> West African Science Service Center on Climate Change and Adaptated Land Use
> (WASCAL)
> Center for Development Research (ZEF) - University of Bonn
> email : ahmadou.dicko at ucad.edu.sn
> twitter : @dickoah
> github : github/dickoa
> tel : +221 33 827 55 16
> portable: +221 77 123 81 69


From amcrgrodrigues at gmail.com  Wed Dec 18 16:42:43 2013
From: amcrgrodrigues at gmail.com (=?ISO-8859-1?Q?Ant=F3nio_M=2E_Rodrigues?=)
Date: Wed, 18 Dec 2013 15:42:43 +0000
Subject: [R-sig-Geo] R -> QGIS - Web-GIS
In-Reply-To: <CACgt3onO-154jhDkD0e-HgAQC0Ph6ckRfXM=yJvr+YZcoH=qRA@mail.gmail.com>
References: <CACgt3onO-154jhDkD0e-HgAQC0Ph6ckRfXM=yJvr+YZcoH=qRA@mail.gmail.com>
Message-ID: <CAC+EZtTc1UuFNq8abndHroS+f5cMiM3WvqXvBxH2cYjw3vXF9g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131218/691290d1/attachment.pl>

From chrjan70 at gmail.com  Wed Dec 18 17:37:48 2013
From: chrjan70 at gmail.com (Christian Jansson)
Date: Wed, 18 Dec 2013 13:37:48 -0300
Subject: [R-sig-Geo] Problems with gDelaunayTriangulation and neighbors.
Message-ID: <CAAHdiqzsbdO_bXuWqgALMP0-s98xcW74UML8hv-LjQ_dzdPv2g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131218/ca0b6cd7/attachment.pl>

From tech_dev at wildintellect.com  Wed Dec 18 17:40:32 2013
From: tech_dev at wildintellect.com (Alex Mandel)
Date: Wed, 18 Dec 2013 08:40:32 -0800
Subject: [R-sig-Geo] R -> QGIS - Web-GIS
In-Reply-To: <CAC+EZtTc1UuFNq8abndHroS+f5cMiM3WvqXvBxH2cYjw3vXF9g@mail.gmail.com>
References: <CACgt3onO-154jhDkD0e-HgAQC0Ph6ckRfXM=yJvr+YZcoH=qRA@mail.gmail.com>
	<CAC+EZtTc1UuFNq8abndHroS+f5cMiM3WvqXvBxH2cYjw3vXF9g@mail.gmail.com>
Message-ID: <52B1D000.4060404@wildintellect.com>

ManageR plugin for QGIS with rpy2 bindings, or the Processing Plugins.
QGIS Server with QGIS Client <- least amount of coding.
Otherwise any of the previous choices mentioned are good.

Data (In a spatial format, so export with rgdal)
A web server (ie Apache)
A spatial web server (Geoserver, Mapserver, QGIS Server) you can skip
this part if you just export geojson or kml.
A web client (Leaflet or Openlayers based html/js page loaded onto your
Apache server)

For more options and a test environment:
http://live.osgeo.org/en/overview/overview.html

Don't want to host it yourself see:
QGIS Cloud, Mapbox, or CartoDB websites

Enjoy,
Alex

On 12/18/2013 07:42 AM, Ant?nio M. Rodrigues wrote:
> Perhaps R shiny (http://www.rstudio.com/shiny/) with leaflet bindings (
> https://github.com/jcheng5/leaflet-shiny).
> 
> Regards,
> Ant?nio
> 
> 
> 2013/12/18 Domagoj Culinovic <culinovic.domagoj at gmail.com>
> 
>> I need some advice how to use R with QGIS and best option how to publish to
>> web-gis server (MapServer Geoserver????).
>> Examples and workflows are welcome....
>>
>>         [[alternative HTML version deleted]]
>>


From r.hijmans at gmail.com  Wed Dec 18 18:25:53 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 18 Dec 2013 09:25:53 -0800
Subject: [R-sig-Geo] Combining polygons and calculating their area (i.e.
 number of cells)
In-Reply-To: <20131218160845.y3i58izfkkswcw8k@webmail.uni-potsdam.de>
References: <20131218160845.y3i58izfkkswcw8k@webmail.uni-potsdam.de>
Message-ID: <CANtt_hx4bUdSij_AW+LJ8jeHeCS5rKJpKxOWA2x4O=2v3qR3XQ@mail.gmail.com>

Alex,
Do you need to create polygons? You can do things like:

m <- clump(r)
freq(m)

But if you insist on polygons:

m <- clump(r)
p <- rasterToPolygons(m, dissolve=TRUE)

Robert

On Wed, Dec 18, 2013 at 7:08 AM, Alexander Zimmermann
<alexander.zimmermann.ii at uni-potsdam.de> wrote:
> Dear All,
>
> I have a problem with combining polygons and calculating their area.
> In the following I try to provide a description of the problem:
> I have a simple raster (created with R-package: raster). Using the function
> "rasterToPolygons" I get polygons of all raster cells that contain the value
> "1":
>
> library(raster)
> dat = list()
> dat$x = seq(1.5, by = 10, len = 10)
> dat$y = seq(3.5, by = 10, len = 15)
> dat$z = matrix(sample(c(0,1), size = 10*15, replace = T), 10, 15)
> r=raster(dat);plot(r)
> r_poly = rasterToPolygons(r, fun = function(r) {r == 1}, dissolve = F)
> plot(r_poly, add = T)
>
> I do not use "dissolve = T" to avoid that all polygons are merged into one
> big polygon (i.e. a multipart polygon). Instead, I wish to obtain a new
> SpatialPolygonsDataFrame in which all polygons that share an edge or a point
> are combined. Polygons that are clearly separated should be identifiable as
> individual polygons (i.e. I wish to avoid to obtain a multipart polygon).
> Based on the new SpatialPolygonsDataFrame I would like to analyze the size
> of the combined (individual) polygons as follows:
>
> b = extract(r,r_poly_new) # "r_poly_new" contains the combined polygons
> str(b)                    # list of clearly separated polygons
> tab = lapply(b,table)
> tab
>
> My question is twofold:
> 1) How to combine polygons that share an edge or point (under the constraint
> that clearly separated polygons remain individual polygons)?
> 2) How to get this information into a format which allows analyzing the
> areas of the combined (but not multipart) polygons?
>
> Thank you very much for your feedback.
>
> Alex Zimmermann
>
> --------------------------------------------------------------------
> Dr. Alexander Zimmermann
> Institute of Earth and Environmental Science, University of Potsdam
> Karl-Liebknecht-Str. 24-25, 14476 Potsdam - Golm, Germany
> phone +49-(0)331-9772047, fax +49-(0)331-9772068
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From joshmobrien at gmail.com  Wed Dec 18 18:28:55 2013
From: joshmobrien at gmail.com (Josh O'Brien)
Date: Wed, 18 Dec 2013 09:28:55 -0800 (PST)
Subject: [R-sig-Geo] Combining polygons and calculating their area (i.e.
	number of	cells)
In-Reply-To: <20131218160845.y3i58izfkkswcw8k@webmail.uni-potsdam.de>
References: <20131218160845.y3i58izfkkswcw8k@webmail.uni-potsdam.de>
Message-ID: <1387387734978-7585401.post@n2.nabble.com>

This is cross-posted from StackOverflow
(http://stackoverflow.com/questions/20659186/combining-polygons-and-calculating-their-area-i-e-number-of-cells-in-r),
where it has received an answer that I believe answers both questions.



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Combining-polygons-and-calculating-their-area-i-e-number-of-cells-tp7585395p7585401.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Wade.A.Wall at usace.army.mil  Wed Dec 18 20:42:24 2013
From: Wade.A.Wall at usace.army.mil (Wall, Wade A ERDC-RDE-CERL-IL)
Date: Wed, 18 Dec 2013 19:42:24 +0000
Subject: [R-sig-Geo] shell command on Windows 7
Message-ID: <C1524BE4BF45454293B8DF38FB9B5ECA115AA862@MS-EX1VKS.erdc.dren.mil>

Hi all,

I am trying to run the script located at http://geomorphometry.org/content/geomorphometry-r-saga-ilwis-grass to integrate R, SAGA, ILWIS, and GRASS, but I am getting error messages when I try to use the shell() command.

The relevant lines of code are:

ILWIS <- "C:\\Progra~1\\N52\\Ilwis35\\IlwisClient.exe -C"
shell(cmd=paste(ILWIS, "setcsy dem25m.grf gk_6.csy -force"), wait=F)

When I try to run these two commands, I get the error message (when I leave out "wait=F")

1: running command 'C:\Windows\system32\cmd.exe /c C:\Program Files (x86)\N52\Ilwis35\IlwisClient.exe setcsy dem25m.grf gk_6.csy -force' had status 1 
2: In shell(cmd = paste(ILWIS, "setcsy dem25m.grf gk_6.csy -force")) :
  'C:\Program Files (x86)\N52\Ilwis35\IlwisClient.exe setcsy dem25m.grf gk_6.csy -force' execution failed with error code 1

I have changed the path in the object ILWIS to "C:\\Program Files (x86)\\ . . . .exe -C" and included quotation marks, as one might do when using cmd.exe

I can get shell.exec to work, but only to open ILWIS. 

If I try to run another program, for example Python 2.7 that resides on the C drive, (C:\Python27\python.exe), I can use the shell command, but it does not open inside cmd.exe, but rather in the R workspace. Then it stops and I am back at the command prompt.

Has anyone else had this problem using Windows 7?

Wade A. Wall
US Army ERDC-CERL
P.O. Box 9005
Champaign, IL  61826-9005
1-217-373-4420
Wade.A.Wall at usace.army.mil


From etiennebr at gmail.com  Wed Dec 18 23:15:29 2013
From: etiennebr at gmail.com (Etienne B. Racine)
Date: Wed, 18 Dec 2013 17:15:29 -0500
Subject: [R-sig-Geo] a spatial bestiary?
In-Reply-To: <1380010390.28177.1386961811566.JavaMail.root@sz0206a.westchester.pa.mail.comcast.net>
References: <52AB5627.4060201@gmail.com>
	<1380010390.28177.1386961811566.JavaMail.root@sz0206a.westchester.pa.mail.comcast.net>
Message-ID: <CALjAYt6pbSHhUqrK10-2bgUxNKu4HQ6G90EUfqjj-FBdcYRdWg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131218/5e0f49af/attachment.pl>

From bmartinez at ucm.es  Thu Dec 19 12:28:27 2013
From: bmartinez at ucm.es (beamiranzo)
Date: Thu, 19 Dec 2013 03:28:27 -0800 (PST)
Subject: [R-sig-Geo] kernerloverlap function
In-Reply-To: <1387363010364-7585391.post@n2.nabble.com>
References: <1387363010364-7585391.post@n2.nabble.com>
Message-ID: <1387452507902-7585404.post@n2.nabble.com>





--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/kernerloverlap-function-tp7585391p7585404.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From Roger.Bivand at nhh.no  Thu Dec 19 13:04:24 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 19 Dec 2013 13:04:24 +0100
Subject: [R-sig-Geo] kernerloverlap function
In-Reply-To: <1387452507902-7585404.post@n2.nabble.com>
References: <1387363010364-7585391.post@n2.nabble.com>
	<1387452507902-7585404.post@n2.nabble.com>
Message-ID: <alpine.LRH.2.03.1312191257440.20214@reclus.nhh.no>

On Thu, 19 Dec 2013, beamiranzo wrote:

>
>

When you write to an R list, please follow:

http://www.r-project.org/posting-guide.html

and

http://www.r-project.org/mail.html#instructions

You may not like or agree with these, but they are the way in which things 
are run, and this is the only forum consistently read by the developers 
and adequately archived.

Your message is invisible because you posted via nabble, and posted HTML, 
rather than posting plain text only (check the settings of your email 
client to do this), best directly to: r-sig-geo at r-project.org, as 
suggested on:

https://stat.ethz.ch/mailman/listinfo/r-sig-geo

It is possible to post via nabble, but you then have fewer chances of 
detecting problems with your posting, as yours demonstrates.

Roger

>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/kernerloverlap-function-tp7585391p7585404.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Thu Dec 19 13:23:40 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 19 Dec 2013 13:23:40 +0100
Subject: [R-sig-Geo] Combining polygons and calculating their area (i.e.
 number of	cells)
In-Reply-To: <1387387734978-7585401.post@n2.nabble.com>
References: <20131218160845.y3i58izfkkswcw8k@webmail.uni-potsdam.de>
	<1387387734978-7585401.post@n2.nabble.com>
Message-ID: <alpine.LRH.2.03.1312191307550.20214@reclus.nhh.no>

On Wed, 18 Dec 2013, Josh O'Brien wrote:

> This is cross-posted from StackOverflow
> (http://stackoverflow.com/questions/20659186/combining-polygons-and-calculating-their-area-i-e-number-of-cells-in-r),
> where it has received an answer that I believe answers both questions.
>

Because of the forking to SO, the code now displayed is suboptimal. 
Developers not interested in (or simply irritated by) gamifying are not 
going to waste time on SO, OK?

The last block concludes with:

## Get cluster areas from SpatialPolygons object
transform(data.frame(SPclus),
           area = sapply(SPclus at polygons, function(X) X at area))

and @JoshO'Brien commented: "However, I discovered that the last part of 
the R-code (i.e Get cluster areas from SpatialPolygons object) was not 
always working properly. Interestingly, (sometimes) the area of the 
largest cluster from the SpatialPolygons object was overestimated"

This is documented in:

library(sp)
?"Polygons-class"

and in Bivand et al. (2013) pp. 41-44; the area values are an adjunct 
to plotting polygons in the largest to smallest order to prevent small 
polygons being overpainted on some devices. If you want the area of a 
Polygons object, use rgeos::gArea(SPclus, byid=TRUE).

By the way, always avoid accessing S4 objects directly using @, do use 
slot(obj, "slotname") - the sapply should read:

area = sapply(slot(SPclus, "polygons"), slot, "area")

for the SO version with possibly incorrect areas, and

area = gArea(SPclus, byid=TRUE)

for correct ones. Finally, never use T/F for TRUE and FALSE, try:

T <- FALSE

and TRUE <- FALSE

and see the difference.

Terminally uninterested in winning points on SO,

Roger

>
>
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Combining-polygons-and-calculating-their-area-i-e-number-of-cells-tp7585395p7585401.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From alobolistas at gmail.com  Thu Dec 19 13:29:49 2013
From: alobolistas at gmail.com (Agustin Lobo)
Date: Thu, 19 Dec 2013 13:29:49 +0100
Subject: [R-sig-Geo] R -> QGIS - Web-GIS
In-Reply-To: <52B1D000.4060404@wildintellect.com>
References: <CACgt3onO-154jhDkD0e-HgAQC0Ph6ckRfXM=yJvr+YZcoH=qRA@mail.gmail.com>
	<CAC+EZtTc1UuFNq8abndHroS+f5cMiM3WvqXvBxH2cYjw3vXF9g@mail.gmail.com>
	<52B1D000.4060404@wildintellect.com>
Message-ID: <CAG4NRe+1AbTzo2p7qiGzqkVvBBWXCmxoKVu1=EMw-4VXiz0MTQ@mail.gmail.com>

ManageR was great but is no longer being developed or maintained, afaik.
The processing plugin is more for developing specific tools that you
use from within QGIS,
do not really integrate R and QGIS in the way manageR intended to.
I normally work in R (sp, rgdal, raster...), then save using
writeRaster() or writeOGR() and display
in QGIS.

Agus



On Wed, Dec 18, 2013 at 5:40 PM, Alex Mandel <tech_dev at wildintellect.com> wrote:
> ManageR plugin for QGIS with rpy2 bindings, or the Processing Plugins.
> QGIS Server with QGIS Client <- least amount of coding.
> Otherwise any of the previous choices mentioned are good.
>
> Data (In a spatial format, so export with rgdal)
> A web server (ie Apache)
> A spatial web server (Geoserver, Mapserver, QGIS Server) you can skip
> this part if you just export geojson or kml.
> A web client (Leaflet or Openlayers based html/js page loaded onto your
> Apache server)
>
> For more options and a test environment:
> http://live.osgeo.org/en/overview/overview.html
>
> Don't want to host it yourself see:
> QGIS Cloud, Mapbox, or CartoDB websites
>
> Enjoy,
> Alex
>
> On 12/18/2013 07:42 AM, Ant?nio M. Rodrigues wrote:
>> Perhaps R shiny (http://www.rstudio.com/shiny/) with leaflet bindings (
>> https://github.com/jcheng5/leaflet-shiny).
>>
>> Regards,
>> Ant?nio
>>
>>
>> 2013/12/18 Domagoj Culinovic <culinovic.domagoj at gmail.com>
>>
>>> I need some advice how to use R with QGIS and best option how to publish to
>>> web-gis server (MapServer Geoserver????).
>>> Examples and workflows are welcome....
>>>
>>>         [[alternative HTML version deleted]]
>>>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From amcrgrodrigues at gmail.com  Thu Dec 19 15:39:42 2013
From: amcrgrodrigues at gmail.com (=?ISO-8859-1?Q?Ant=F3nio_M=2E_Rodrigues?=)
Date: Thu, 19 Dec 2013 14:39:42 +0000
Subject: [R-sig-Geo] R -> QGIS - Web-GIS
In-Reply-To: <CAG4NRe+1AbTzo2p7qiGzqkVvBBWXCmxoKVu1=EMw-4VXiz0MTQ@mail.gmail.com>
References: <CACgt3onO-154jhDkD0e-HgAQC0Ph6ckRfXM=yJvr+YZcoH=qRA@mail.gmail.com>
	<CAC+EZtTc1UuFNq8abndHroS+f5cMiM3WvqXvBxH2cYjw3vXF9g@mail.gmail.com>
	<52B1D000.4060404@wildintellect.com>
	<CAG4NRe+1AbTzo2p7qiGzqkVvBBWXCmxoKVu1=EMw-4VXiz0MTQ@mail.gmail.com>
Message-ID: <CAC+EZtTorf6G2CRBGc5AJM5rgyT9KEeY4MiA+cwApMwDx0rCEw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131219/8f07c594/attachment.pl>

From carson.farmer at gmail.com  Thu Dec 19 16:45:39 2013
From: carson.farmer at gmail.com (Carson Farmer)
Date: Thu, 19 Dec 2013 10:45:39 -0500
Subject: [R-sig-Geo] R -> QGIS - Web-GIS
In-Reply-To: <CAC+EZtTorf6G2CRBGc5AJM5rgyT9KEeY4MiA+cwApMwDx0rCEw@mail.gmail.com>
References: <CACgt3onO-154jhDkD0e-HgAQC0Ph6ckRfXM=yJvr+YZcoH=qRA@mail.gmail.com>
	<CAC+EZtTc1UuFNq8abndHroS+f5cMiM3WvqXvBxH2cYjw3vXF9g@mail.gmail.com>
	<52B1D000.4060404@wildintellect.com>
	<CAG4NRe+1AbTzo2p7qiGzqkVvBBWXCmxoKVu1=EMw-4VXiz0MTQ@mail.gmail.com>
	<CAC+EZtTorf6G2CRBGc5AJM5rgyT9KEeY4MiA+cwApMwDx0rCEw@mail.gmail.com>
Message-ID: <CADB6tZs8__NFNRC8_B-Xn6UfTaw0pjzcm=HRizV2r7RmpGdRwg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131219/9a4c348d/attachment.pl>

From amcrgrodrigues at gmail.com  Thu Dec 19 16:57:16 2013
From: amcrgrodrigues at gmail.com (=?ISO-8859-1?Q?Ant=F3nio_M=2E_Rodrigues?=)
Date: Thu, 19 Dec 2013 15:57:16 +0000
Subject: [R-sig-Geo] R -> QGIS - Web-GIS
In-Reply-To: <CADB6tZs8__NFNRC8_B-Xn6UfTaw0pjzcm=HRizV2r7RmpGdRwg@mail.gmail.com>
References: <CACgt3onO-154jhDkD0e-HgAQC0Ph6ckRfXM=yJvr+YZcoH=qRA@mail.gmail.com>
	<CAC+EZtTc1UuFNq8abndHroS+f5cMiM3WvqXvBxH2cYjw3vXF9g@mail.gmail.com>
	<52B1D000.4060404@wildintellect.com>
	<CAG4NRe+1AbTzo2p7qiGzqkVvBBWXCmxoKVu1=EMw-4VXiz0MTQ@mail.gmail.com>
	<CAC+EZtTorf6G2CRBGc5AJM5rgyT9KEeY4MiA+cwApMwDx0rCEw@mail.gmail.com>
	<CADB6tZs8__NFNRC8_B-Xn6UfTaw0pjzcm=HRizV2r7RmpGdRwg@mail.gmail.com>
Message-ID: <CAC+EZtTAFG3w3PbzurxNRXwg5W0B9jtiLQLMmo0cc2QjSXaS3g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131219/604dc432/attachment.pl>

From joshmobrien at gmail.com  Thu Dec 19 18:55:23 2013
From: joshmobrien at gmail.com (Josh O'Brien)
Date: Thu, 19 Dec 2013 09:55:23 -0800
Subject: [R-sig-Geo] Combining polygons and calculating their area (i.e.
 number of cells)
In-Reply-To: <alpine.LRH.2.03.1312191307550.20214@reclus.nhh.no>
References: <20131218160845.y3i58izfkkswcw8k@webmail.uni-potsdam.de>
	<1387387734978-7585401.post@n2.nabble.com>
	<alpine.LRH.2.03.1312191307550.20214@reclus.nhh.no>
Message-ID: <CAOwKfPRsQanZSw14zNsH9OBvJ57LJLxF+JUi7Ud7n6nXTi0Kuw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131219/bc1ec067/attachment.pl>

From r.turner at auckland.ac.nz  Fri Dec 20 07:50:11 2013
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Fri, 20 Dec 2013 19:50:11 +1300
Subject: [R-sig-Geo] Problems with gDelaunayTriangulation and neighbors.
In-Reply-To: <CAAHdiqzsbdO_bXuWqgALMP0-s98xcW74UML8hv-LjQ_dzdPv2g@mail.gmail.com>
References: <CAAHdiqzsbdO_bXuWqgALMP0-s98xcW74UML8hv-LjQ_dzdPv2g@mail.gmail.com>
Message-ID: <52B3E8A3.2030005@auckland.ac.nz>



If you are going to do Delaunay triangulation, why not use the 
appropriate software,
i.e. "deldir"?  I ***know*** it's appropriate because I wrote it. :-)

It works without stumbling, and is lucidly documented.  I ***know*** 
it's lucidly
documented because I wrote the documentation. :-)

     cheers,

     Rolf Turner

On 19/12/13 05:37, Christian Jansson wrote:
> Hi,
>
> I'm very happy that rgeos was updated to also do delaunay triangulation,
> but I have problems to match the results with the points.
>
> I need to to what is in the example-code in gDelaunayTriangulation-help.
> With meuse-data it works, but not with my own data.
>
> How can the error in the following code be avoided? So I get out5.
>
> -------------
> library(sp)
> library(rgeos)
>
> tmp.coords <- structure(list(lon = c(-69.9601058046182, -69.9307142312949,
> -69.9492587302774, -69.938119947523, -69.9599320928521, -69.958492947506,
> -69.9517184088961, -69.9515127466649, -69.9608290339626,
> -69.9463054201695), lat = c(-17.922645866545, -17.9157740845672,
> -17.9166152585801, -17.9329659455957, -17.9270430312235, -17.933297069203,
> -17.9170708735245, -17.916779044717, -17.9405611407101,
> -17.9098645380403)), .Names = c("lon", "lat"), class = "data.frame",
> row.names = c(NA, -10L))
> coordinates(tmp.coords) <- c("lon", "lat")
> plot(gDelaunayTriangulation(tmp.coords))
> points(tmp.coords)
>
> out <- gDelaunayTriangulation(tmp.coords, onlyEdges=TRUE)
> lns <- slot(slot(out, "lines")[[1]], "Lines")
> out1 <- SpatialLines(lapply(seq(along=lns), function(i)
> Lines(list(lns[[i]]), ID=as.character(i))))
> out2 <- lapply(1:length(out1), function(i) which(gTouches(tmp.coords,
> out1[i], byid=TRUE)))
> out3 <- do.call("rbind", out2)
> o <- order(out3[,1], out3[,2])
> # The previous line generates "Error in out3[, 1] : subscript out of bounds"
>
> out4 <- out3[o,]
> out5 <- data.frame(from=out4[,1], to=out4[,2], weight=1)


From r.turner at auckland.ac.nz  Fri Dec 20 08:13:56 2013
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Fri, 20 Dec 2013 20:13:56 +1300
Subject: [R-sig-Geo] Create unusual data set with ppp object
In-Reply-To: <52B031CF.7080309@yahoo.com.br>
References: <52B031CF.7080309@yahoo.com.br>
Message-ID: <52B3EE34.9070802@auckland.ac.nz>



What are you actually ***trying to do***?  It is completely opaque to me.

You have created a polygonal window --- "W"; that's fine.

You have create a set of 13 points.  All of these points lie outside the 
window W that
you have just created.  (So why work with these points and this window 
Makes no
sense to me.)

You wind up with an empty ppp object with an attribute of 13 rejected 
(illegal)
points.

What do you want to do now?

What (on earth!) do you mean by "presence" and "absence"? Presence and
absence where?

Get your thoughts together and come back with a coherently expressed 
question.

     cheers,

     Rolf Turner

P. S. It seems to me that your use of the coordinates() function from 
"sp" is completely
spurious.  Not only is it ludicrously unnecessary but it also creates an 
error.

     R. T.

On 18/12/13 00:13, ASANTOS wrote:
> Dear Members,
>
>          I want to make a data set with 1 for presence in point location
> (in xpoint and ypoint coordinates), 0 for absence of point location
> (inside of window W) and NA for points outside the window for each
> coordinate in my syn.ppp object of spatstat package.//I try to create a
> geotif for this//, but I have some problems that involves ppp objects
> and writeGDAL() function in rgdal package and I need members ideas for
> make this,  in my example:
>
> require(spatstat)
> require(sp)
>
>
> # Two polygons
> coordinates------------------------------------------------------
>
> #Polygon 1
> x.coords1<-c(371299.9,    371266.4,    371205.6,    371111.8,
> 371047.6,    371018.2,    371014.0,
>                 371009.3,    370983.1,    370919.7,    370853.6,
> 370785.6,    370748.8,    370711.8,
>                 370687.8,    370696.4,    370785.9,    370885.5,
> 371035.8,    371148.1,    371205.2,
>                 371231.7,    371236.5,    371240.3,    371285.8,
> 371326.5,    371397.2,    371417.1,
>                 371432.9,    371445.0,    371455.7,    371466.4,
> 371476.6,    371502.6,    371536.0,
>                 371550.0,    371546.8,    371528.3,    371470.0,
> 371393.3,    371299.9,    371299.9)
>
> y.coords1<-c(8246589,    8246560,    8246508,    8246428, 8246373,
> 8246349,    8246348,
>                8246352,    8246385,    8246465,    8246551, 8246638,
> 8246685,    8246732,
>                8246764,    8246771,    8246846,    8246932, 8247062,
> 8247160,    8247209,
>                8247230,    8247224,    8247221,    8247160, 8247107,
> 8247016,    8246991,
>                8246967,    8246939,    8246914,    8246892, 8246875,
> 8246846,    8246821,
>                8246809,    8246802,    8246785,    8246735, 8246669,
> 8246589,    8246589)
>
> #Polygon 2
>
> x.coords2<-c(368382.9,    368399.4,    368394.1,    368464.7,
> 368652.2,    368683.7,    368699.7,
>                368714.9,    368714.9,    368714.9,    368860.9,
> 368932.1,    368994.8,    368994.8,
>                369015.7,    369014.5,    369014.5,    369026.8,
> 369045.2,    369020.0,    368952.9,
>                368951.4,    368952.9,    368951.4,    368936.8,
> 368923.4,    368804.1,    368676.0,
>                368178.1,    368182.4,    368202.2,    368216.2,
> 368233.4,    368251.3,    368270.3,
>                368281.7,    368300.6,    368323.8,    368344.8,
> 368364.6,    368374.2,    368382.9)
>
>
>
> y.coords2<-c(8249120,    8249150,    8249153,    8249244, 8249173,
> 8249167,    8249154,
>                   8249145,    8249145,    8249145,    8249048,
> 8249026,    8249003,    8249003,
>                8248993,    8248991,    8248991,    8248984, 8248970,
> 8248889,    8248833,
>                8248829,    8248833,    8248829,    8248790, 8248765,
> 8248626,    8248526,
>                8248774,    8248780,    8248815,    8248843, 8248871,
> 8248903,    8248934,
>                8248952,    8248978,    8249013,    8249049, 8249086,
> 8249103,    8249120)
>
> # Window creation
>
> D1 <- unique(data.frame(x=rev(x.coords1),y=rev(y.coords1)))
> W1 <- owin(poly=D1)
> D2 <- unique(data.frame(x=rev(x.coords2),y=rev(y.coords2)))
> W2 <- owin(poly=D2)
> W   <- union.owin(W1,W2)
> plot(W)
>
> # Create plot points inside the windows
> xpoint<-c(517291.6, 517290.3, 517287.3, 517286.9, 517289.5, 517290.4,
> 517892.6,
>               517892.5,    517892.0,    517893.7,    517893.2,
> 517892.1,    517892.2)
> ypoint<-c(7970141, 7970139,    7970141,    7970145, 7970147,
> 7970146,    7970641,
>             7970641, 7970641,    7970643,    7970643,    7970643, 7970643)
> syn.ppp<-ppp(x=coordinates(xpoint),y=coordinates(ypoint),window=W)
> plot(syn.ppp, main=" ")
> # END


From alobolistas at gmail.com  Fri Dec 20 09:26:45 2013
From: alobolistas at gmail.com (Agustin Lobo)
Date: Fri, 20 Dec 2013 09:26:45 +0100
Subject: [R-sig-Geo] Error in .gd_SetProject(transient, crs(r))
In-Reply-To: <CANtt_hwd_SQpOc=Ux96rqXmptJAFHGZYWi=V__tNM4R38KquWg@mail.gmail.com>
References: <1386698273714-7585330.post@n2.nabble.com>
	<CAG4NReKF_eaEJZjUscFuuyxXM376LG1SzOMnsZ_--kSR3oD4fA@mail.gmail.com>
	<CAP8THHW+kc5V1K1RLVtc5oGYn-rCEozUGrZA1A0UUU6m+i9AMQ@mail.gmail.com>
	<CAG4NReK=YqMdbymVPyh2Ak-MsaY9uvLjgKDUWyRafVf=rccWjw@mail.gmail.com>
	<CAP8THHUz2KPDZYeYmibYDk2S+FivBhFMYmxN4pW=Vm6uR6FAMQ@mail.gmail.com>
	<CANtt_hwd_SQpOc=Ux96rqXmptJAFHGZYWi=V__tNM4R38KquWg@mail.gmail.com>
Message-ID: <CAG4NRe+9dQRYtxvvsYt=9er2v1QgfUR0BkohBCbhg5ZaenS0DQ@mail.gmail.com>

Ahmadou, Guillaume,

As you had updated to the previous version and detected the problem,
would you be so kind of testing Robert's new version and report back
to the list?
I personally cannot take the risk of having these tools becoming
unstable at this moment.
Thanks
Agus


On Wed, Dec 18, 2013 at 3:26 AM, Robert J. Hijmans <r.hijmans at gmail.com> wrote:
> I think this has been fixed in the development version, which I will
> release this week.
> You can download and try this version from here:
> http://r-forge.r-project.org/R/?group_id=294
> Or: install.packages("raster", repos="http://R-Forge.R-project.org")
> Robert
>
> On Tue, Dec 17, 2013 at 12:15 AM, Ahmadou Dicko <dicko.ahmadou at gmail.com> wrote:
>> I use GDAL 1.10 too
>>
>> gdalinfo --version
>> GDAL 1.10.0, released 2013/04/24
>>
>>
>>
>>
>> On Tue, Dec 17, 2013 at 8:06 AM, Agustin Lobo <alobolistas at gmail.com> wrote:
>>
>>> Well, I rather don't, rgdal is critical for me.
>>> Perhaps it is more a problem of gdal itself than of rgdal or raster.
>>> I'm using
>>> Loaded GDAL runtime: GDAL 1.10.0, released 2013/04/24
>>>
>>> Which gdal version are you using?
>>> Agus
>>>
>>> On Thu, Dec 12, 2013 at 2:35 PM, Ahmadou Dicko <dicko.ahmadou at gmail.com>
>>> wrote:
>>> > Using rgdal_0.8-14  and raster_2.1-71 it doesn't work for me.
>>> > Try to update your packages and try again.
>>> >
>>> > sessionInfo()
>>> > R version 3.0.2 Patched (2013-12-05 r64394)
>>> > Platform: x86_64-unknown-linux-gnu (64-bit)
>>> >
>>> > locale:
>>> >  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>>> >  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8
>>> >  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8
>>> >  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C
>>> >  [9] LC_ADDRESS=C               LC_TELEPHONE=C
>>> > [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>>> >
>>> > attached base packages:
>>> > [1] stats     graphics  grDevices utils     datasets  methods
>>> > [7] base
>>> >
>>> > other attached packages:
>>> > [1] rgdal_0.8-14  raster_2.1-71 sp_1.0-14
>>> >
>>> > loaded via a namespace (and not attached):
>>> > [1] grid_3.0.2      lattice_0.20-24
>>> >
>>> >
>>> >
>>> >
>>> >
>>> > On Thu, Dec 12, 2013 at 1:23 PM, Agustin Lobo <alobolistas at gmail.com>
>>> wrote:
>>> >
>>> >> I have no problem on linux with QGIS 2.01, RStudio Version 0.98.484
>>> >> and
>>> >> rgdal: version: 0.8-11, (SVN revision 479M)
>>> >> Geospatial Data Abstraction Library extensions to R successfully loaded
>>> >> Loaded GDAL runtime: GDAL 1.10.0, released 2013/04/24
>>> >> > sessionInfo()
>>> >> R version 3.0.2 (2013-09-25)
>>> >> Platform: x86_64-pc-linux-gnu (64-bit)
>>> >>
>>> >> locale:
>>> >>  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C
>>> >> LC_TIME=es_ES.UTF-8        LC_COLLATE=en_US.UTF-8
>>> >>  [5] LC_MONETARY=es_ES.UTF-8    LC_MESSAGES=en_US.UTF-8
>>> >> LC_PAPER=es_ES.UTF-8       LC_NAME=C
>>> >>  [9] LC_ADDRESS=C               LC_TELEPHONE=C
>>> >> LC_MEASUREMENT=es_ES.UTF-8 LC_IDENTIFICATION=C
>>> >>
>>> >> attached base packages:
>>> >> [1] stats     graphics  grDevices utils     datasets  methods   base
>>> >>
>>> >> other attached packages:
>>> >> [1] raster_2.1-49 rgdal_0.8-11  sp_1.0-13     lmodel2_1.7-1
>>> >> xtable_1.7-1  knitr_1.5
>>> >>
>>> >> loaded via a namespace (and not attached):
>>> >> [1] codetools_0.2-8 digest_0.6.3    evaluate_0.5.1  formatR_0.9
>>> >> grid_3.0.2      lattice_0.20-24 markdown_0.6.3
>>> >> [8] stringr_0.6.2   tools_3.0.2
>>> >>
>>> >>
>>> >> On Tue, Dec 10, 2013 at 6:57 PM, Guillaume Drolet
>>> >> <droletguillaume at gmail.com> wrote:
>>> >> > Hello,
>>> >> >
>>> >> > This morning I updated RStudio to version 0.98.484, and Quantum GIS to
>>> >> > version 2.0.1 (Dufour) using the standalone installer.
>>> >> >
>>> >> > After that, I tried to run some code in RStudio and I got the error
>>> >> message
>>> >> > below when running the following command:
>>> >> >
>>> >> >> filename <- "test.tif"
>>> >> >> try(writeRaster(raster(matrix(1, 1, 1)), filename = filename,
>>> overwrite
>>> >> =
>>> >> >> overwrite))
>>> >> >
>>> >> > Error in .gd_SetProject(transient, crs(r)) :
>>> >> >   STRING_ELT() can only be applied to a 'character vector', not a
>>> >> 'logical'
>>> >> >
>>> >> > Then, I updated rgdal to version 0.8-14 and now I get this error when
>>> >> > running the same code:
>>> >> >
>>> >> > Error in .gd_SetProject(object, ...) :
>>> >> >   STRING_ELT() can only be applied to a 'character vector', not a
>>> >> 'logical'
>>> >> >
>>> >> > Until this morning, I never had any problem with that line of code
>>> >> above. I
>>> >> > suspect this could be due to the QGIS installation that could have
>>> messed
>>> >> > with my GDAL installation: is that possible (is GDAL used by rgdal at
>>> >> all)?
>>> >> > I tried uninstalling QGIS but I still get the same error message.
>>> >> >
>>> >> > My session info:
>>> >> >
>>> >> > R version 3.0.2 (2013-09-25)
>>> >> > Platform: x86_64-w64-mingw32/x64 (64-bit)
>>> >> >
>>> >> > locale:
>>> >> > [1] LC_COLLATE=French_Canada.1252  LC_CTYPE=French_Canada.1252
>>> >> > LC_MONETARY=French_Canada.1252
>>> >> > [4] LC_NUMERIC=C                   LC_TIME=French_Canada.1252
>>> >> >
>>> >> > attached base packages:
>>> >> > [1] stats     graphics  grDevices utils     datasets  methods   base
>>> >> >
>>> >> > other attached packages:
>>> >> >  [1] fmask_0.1         RSAGA_0.93-6      plyr_1.8
>>>  shapefiles_0.7
>>> >> > foreign_0.8-55
>>> >> >  [6] gstat_1.0-18      data.table_1.8.10 rgdal_0.8-14
>>>  roxygen2_3.0.0
>>> >> > raster_2.1-68
>>> >> > [11] sp_1.0-14
>>> >> >
>>> >> > loaded via a namespace (and not attached):
>>> >> >  [1] brew_1.0-6       codetools_0.2-8  digest_0.6.3     grid_3.0.2
>>> >> > intervals_0.14.0 lattice_0.20-23
>>> >> >  [7] spacetime_1.0-9  stringr_0.6.2    tools_3.0.2      xts_0.9-7
>>> >> > zoo_1.7-10
>>> >> >
>>> >> > I will be very grateful of any help or piece of advice on how to fix
>>> >> that or
>>> >> > where to look for clues.
>>> >> >
>>> >> > Best wishes,
>>> >> > Guillaume
>>> >> >
>>> >> >
>>> >> >
>>> >> > --
>>> >> > View this message in context:
>>> >>
>>> http://r-sig-geo.2731867.n2.nabble.com/Error-in-gd-SetProject-transient-crs-r-tp7585330.html
>>> >> > Sent from the R-sig-geo mailing list archive at Nabble.com.
>>> >> >
>>> >> > _______________________________________________
>>> >> > R-sig-Geo mailing list
>>> >> > R-sig-Geo at r-project.org
>>> >> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> >>
>>> >> _______________________________________________
>>> >> R-sig-Geo mailing list
>>> >> R-sig-Geo at r-project.org
>>> >> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> >>
>>> >
>>> >
>>> >
>>> > --
>>> > Ahmadou H. DICKO
>>> > statistician economist (Ing?nieur Statisticien ?conomiste)
>>> > PhD candidate in Climate change economics
>>> > Faculty of economics and managment - Cheikh Anta Diop University
>>> > West African Science Service Center on Climate Change and Adaptated Land
>>> > Use (WASCAL)
>>> > Center for Development Research (ZEF) - University of Bonn
>>> > email : ahmadou.dicko at ucad.edu.sn
>>> > twitter : @dickoah
>>> > github : github/dickoa <https://github.com/dickoa>
>>> > tel : +221 33 827 55 16
>>> > portable: +221 77 123 81 69
>>> >
>>> >         [[alternative HTML version deleted]]
>>> >
>>> >
>>> > _______________________________________________
>>> > R-sig-Geo mailing list
>>> > R-sig-Geo at r-project.org
>>> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> >
>>>
>>
>>
>>
>> --
>> Ahmadou H. DICKO
>> statistician economist (Ing?nieur Statisticien ?conomiste)
>> PhD candidate in Climate change economics
>> Faculty of economics and managment - Cheikh Anta Diop University
>> West African Science Service Center on Climate Change and Adaptated Land
>> Use (WASCAL)
>> Center for Development Research (ZEF) - University of Bonn
>> email : ahmadou.dicko at ucad.edu.sn
>> twitter : @dickoah
>> github : github/dickoa <https://github.com/dickoa>
>> tel : +221 33 827 55 16
>> portable: +221 77 123 81 69
>>
>>         [[alternative HTML version deleted]]
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From alobolistas at gmail.com  Fri Dec 20 09:36:53 2013
From: alobolistas at gmail.com (Agustin Lobo)
Date: Fri, 20 Dec 2013 09:36:53 +0100
Subject: [R-sig-Geo] a spatial bestiary?
In-Reply-To: <CALjAYt6pbSHhUqrK10-2bgUxNKu4HQ6G90EUfqjj-FBdcYRdWg@mail.gmail.com>
References: <52AB5627.4060201@gmail.com>
	<1380010390.28177.1386961811566.JavaMail.root@sz0206a.westchester.pa.mail.comcast.net>
	<CALjAYt6pbSHhUqrK10-2bgUxNKu4HQ6G90EUfqjj-FBdcYRdWg@mail.gmail.com>
Message-ID: <CAG4NReKuxEHAmDjS=9Wup5EYaS=TMu9Xc=-urc-p+3zAzvOR5Q@mail.gmail.com>

Both links are great, but not actually addressing the point that Lee
is raising. Perhaps
not only a guide is needed and an effort to review, harmonize and even
re-organize
different spatial objects might be needed.
But an structured guide presenting current spatial object classes
would be great help and
could actually highlight eventual needs for re-organization. Let's try
to find time for this
among all users.
Agus



On Wed, Dec 18, 2013 at 11:15 PM, Etienne B. Racine <etiennebr at gmail.com> wrote:
> Lee, I share your confusion. Maybe something like a cheatsheet could help ?
> It's not highly structured, but it present information in a different way.
> These are two I'm aware of (I've made the last one).
>
> http://www.maths.lancs.ac.uk/~rowlings/Teaching/UseR2012/cheatsheet.html
> or
> http://www.rpubs.com/etiennebr/visualraster
>
> Etienne
>
>
> 2013/12/13 <ldecola at comcast.net>
>
>>
>>
>>
>> I?ve been teaching and using R (and S-PLUS) for a couple of decades, and
>> using its spatial libraries for about half of that, but i still get
>> confused by the various ?geographically-aware? data objects that are
>> supported. Although Bivand?s Spatial.html page is quite helpful, I wonder
>> is there a ?bestiary? that outlines (perhaps in some kind of tree format?)
>> what they are, what geometries are represented, which libraries create or
>> support them, etc.?
>>
>> Lee De Cola, PhD, MCP.
>> DATA to Insight
>> LDECOLA at COMCAST.NET
>> Reston, Virginia
>> 703 709 6972
>> 571 315 0577 mobile
>>
>>         [[alternative HTML version deleted]]
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>
>         [[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From gab.cozzi at gmail.com  Fri Dec 20 09:48:36 2013
From: gab.cozzi at gmail.com (Gabriele Cozzi)
Date: Fri, 20 Dec 2013 09:48:36 +0100
Subject: [R-sig-Geo] problems plotting a SpatialPolygonsDataFrame with
 geom_polygon() over a ggmap() produced object
Message-ID: <CADr8yXBP1ai9JjfC_4xrS5hTFX42qPh1BuNt=B=NE6v9xrE+Eg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131220/eccd7462/attachment.pl>

From l.hilger at ku.de  Fri Dec 20 09:53:57 2013
From: l.hilger at ku.de (Ludwig Hilger)
Date: Fri, 20 Dec 2013 00:53:57 -0800 (PST)
Subject: [R-sig-Geo] focal.function() adds NA value to output
Message-ID: <1387529637959-7585417.post@n2.nabble.com>

Hello everybody,

I have an .asc file containing only 0 and 1 and I am running
focal.function() from the RSAGA package to sum these values in a moving
window. Using a 5*5 window, the values I get in the output grid do not range
between 0 and 25 but between -99999 and 99974, so evidently, the NA values
(-99999 in my case) is added to every single window output. I can not find
any explanation for this.

Appreciating you help and time,
regards,
Ludwig

*SessionInfo:*
R version 3.0.2 (2013-09-25)
Platform: x86_64-w64-mingw32/x64 (64-bit)

locale:
[1] LC_COLLATE=German_Germany.1252  LC_CTYPE=German_Germany.1252   
LC_MONETARY=German_Germany.1252 LC_NUMERIC=C                   
LC_TIME=German_Germany.1252    

attached base packages:
[1] grDevices datasets  splines   graphics  stats     tcltk     utils    
methods   base     

other attached packages:
 [1] lattice_0.20-23 outliers_0.14   gplots_2.12.1   rgdal_0.8-11   
raster_2.1-49   sp_1.0-13       RSAGA_0.93-6    plyr_1.8       
shapefiles_0.7  foreign_0.8-55  gstat_1.0-17    svSocket_0.9-55 TinnR_1.0-5    
[14] R2HTML_2.2.1    Hmisc_3.12-2    Formula_1.1-1   survival_2.37-4

loaded via a namespace (and not attached):
 [1] bitops_1.0-6       caTools_1.14       cluster_1.14.4     gdata_2.13.2      
grid_3.0.2         gtools_3.1.0       intervals_0.14.0   KernSmooth_2.23-10
rpart_4.1-3        spacetime_1.0-9    svMisc_0.9-69     
[12] tools_3.0.2        xts_0.9-7          zoo_1.7-10 

*The input grid can be found here: *
http:///www.altmuehlnet.de/~hilger/Diff_not_sig_plus.asc

*Here is my code:*

library(RSAGA)
ws <- 5

focal.function(
  in.grid = "Diff_not_sig_plus.asc",
  path = getwd(),
  fun = "sum",
  radius = (ws-1)/2,
  out.grid.prefix = paste("Diff_not_sig_plus_", ws, "mal", ws, sep = ""),
  varnames = "counts",   
  is.pixel.radius = TRUE,
  valid.range = c(-10000, 10000),
  out.nodata.value = -99999,
  no.data.values = c(-99999),
  mw.to.vector = FALSE,
  mw.na.rm = TRUE,
  search.mode = "square",
  digits = 1,
  dec = ".",
  quiet = TRUE)



-----
Dipl. Geogr. Ludwig Hilger
Wiss. MA
Lehrstuhl f?r Physische Geographie
Katholische Universit?t Eichst?tt-Ingolstadt
Ostenstra?e 18
85072 Eichst?tt

Tel.: 08421-93-1180 
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/focal-function-adds-NA-value-to-output-tp7585417.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From mdsumner at gmail.com  Fri Dec 20 14:06:29 2013
From: mdsumner at gmail.com (Michael Sumner)
Date: Sat, 21 Dec 2013 00:06:29 +1100
Subject: [R-sig-Geo] a spatial bestiary?
In-Reply-To: <CAG4NReKuxEHAmDjS=9Wup5EYaS=TMu9Xc=-urc-p+3zAzvOR5Q@mail.gmail.com>
References: <52AB5627.4060201@gmail.com>
	<1380010390.28177.1386961811566.JavaMail.root@sz0206a.westchester.pa.mail.comcast.net>
	<CALjAYt6pbSHhUqrK10-2bgUxNKu4HQ6G90EUfqjj-FBdcYRdWg@mail.gmail.com>
	<CAG4NReKuxEHAmDjS=9Wup5EYaS=TMu9Xc=-urc-p+3zAzvOR5Q@mail.gmail.com>
Message-ID: <CAAcGz99hKAxh=OqsTo9R-QxMwaQeCCQRE=8zq6xERPkL8nm-oQ@mail.gmail.com>

I love the "idea", but it really is beast-ridden, so good luck to
anyone proceeding forth from here. :)

On Fri, Dec 20, 2013 at 7:36 PM, Agustin Lobo <alobolistas at gmail.com> wrote:
> Both links are great, but not actually addressing the point that Lee
> is raising. Perhaps
> not only a guide is needed and an effort to review, harmonize and even
> re-organize
> different spatial objects might be needed.
> But an structured guide presenting current spatial object classes
> would be great help and
> could actually highlight eventual needs for re-organization. Let's try
> to find time for this
> among all users.
> Agus
>
>
>
> On Wed, Dec 18, 2013 at 11:15 PM, Etienne B. Racine <etiennebr at gmail.com> wrote:
>> Lee, I share your confusion. Maybe something like a cheatsheet could help ?
>> It's not highly structured, but it present information in a different way.
>> These are two I'm aware of (I've made the last one).
>>
>> http://www.maths.lancs.ac.uk/~rowlings/Teaching/UseR2012/cheatsheet.html
>> or
>> http://www.rpubs.com/etiennebr/visualraster
>>
>> Etienne
>>
>>
>> 2013/12/13 <ldecola at comcast.net>
>>
>>>
>>>
>>>
>>> I?ve been teaching and using R (and S-PLUS) for a couple of decades, and
>>> using its spatial libraries for about half of that, but i still get
>>> confused by the various ?geographically-aware? data objects that are
>>> supported. Although Bivand?s Spatial.html page is quite helpful, I wonder
>>> is there a ?bestiary? that outlines (perhaps in some kind of tree format?)
>>> what they are, what geometries are represented, which libraries create or
>>> support them, etc.?
>>>
>>> Lee De Cola, PhD, MCP.
>>> DATA to Insight
>>> LDECOLA at COMCAST.NET
>>> Reston, Virginia
>>> 703 709 6972
>>> 571 315 0577 mobile
>>>
>>>         [[alternative HTML version deleted]]
>>>
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>>
>>         [[alternative HTML version deleted]]
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Michael Sumner
Hobart, Australia
e-mail: mdsumner at gmail.com


From Roger.Bivand at nhh.no  Fri Dec 20 14:38:40 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 20 Dec 2013 14:38:40 +0100
Subject: [R-sig-Geo] Combining polygons and calculating their area (i.e.
 number of cells)
In-Reply-To: <CAOwKfPRsQanZSw14zNsH9OBvJ57LJLxF+JUi7Ud7n6nXTi0Kuw@mail.gmail.com>
References: <20131218160845.y3i58izfkkswcw8k@webmail.uni-potsdam.de>
	<1387387734978-7585401.post@n2.nabble.com>
	<alpine.LRH.2.03.1312191307550.20214@reclus.nhh.no>
	<CAOwKfPRsQanZSw14zNsH9OBvJ57LJLxF+JUi7Ud7n6nXTi0Kuw@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1312201414290.26305@reclus.nhh.no>

On Thu, 19 Dec 2013, Josh O'Brien wrote:

> On Thu, Dec 19, 2013 at 4:23 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> On Wed, 18 Dec 2013, Josh O'Brien wrote:
>>
>
> <...snip...>
>
> By the way, always avoid accessing S4 objects directly using @, do use
>> slot(obj, "slotname") - the sapply should read:
>>
>> area = sapply(slot(SPclus, "polygons"), slot, "area")
>>
>> for the SO version with possibly incorrect areas, and
>>
>> area = gArea(SPclus, byid=TRUE)
>>
>> for correct ones.
>
>
> Would you mind explaining why the functional form, slot(obj, "slotname"),
> should always be used instead of obj at slotname ? I've seen this admonition
> repeatedly -- I think just from you -- and don't know whether it's a purely
> stylistic preference on your part, or whether there  is some other
> rationale for preferring that form.

When sp was written (2003-5), we chose to use S4 (new style) classes. We 
used Chambers (1998), referring to Ch. 7, and on slots pp. 290-292. There 
the distinction between S3 (old style) "$" and "$<-" access and 
replacement methods, and S4 "@" and particularly "@<-" was made more 
forcefully than in Chambers (2008). Contemporary uses described in 
Venables and Ripley (2000) also distinguish between the two.

All of these point to the formal use of S4 class definitions, not least to 
ensure that storage mode checking when using .C() and .Call() cease to be 
so time-consuming. This is an issue with S3 classes, because there is 
nothing to stop the user modifying the storage mode of list components, 
with potentially bad consequences in compiled code. Defensive changes in 
the underlying R engine to detect mode mismatch were introduced very much 
later, I believe, so mode mismatch could crash the engine until them.

For both S3 and S4 classes, the user is encouraged to use access functions 
where provided. If the classes and methods are sufficiently well written, 
there should only be a few occasions in which the user might want to 
access components (S3) or slots (S4) that are not exposed via methods. If 
scripts consistently contain @, and no access or replacement methods are 
provided, consider asking the package maintainer to add the missing 
functionality. slot() is a little less ugly, but the user shouldn't really 
need it either, unless something inside an object has to be shown or 
manipulated.

In this case, the "area" slot is documented, but precisely because it is 
not intended to be used as a measure of area, there is no access method.

The danger is that "@<-" and "$<-" are used to insert values into 
components/slots without sufficient care being taken; access is perhaps 
less of a problem.

I particularly react to usages such as:

sdf at data$var

for sdf a Spatial*DataFrame object, as "$" and "$<-" methods *are* 
provided to let these objects appear to be data.frame objects. This usage 
is redundant, and displays ignorance about the class/method systems in S 
and R. Of course, all are free to write what they like, so my preferences 
may be just a matter of taste, but at least they are based on the books 
written to establish the structure of the language.

Hope this clarifies,

Roger

>
> FWIW, the ?slot help page doesn't include any such direction, only noting
> in its documentation of the name argument that:
>
>          In the case of the ?slot? function, ?name? can be any
>          expression that evaluates to a valid slot in the class
>          definition.  Generally, the only reason to use the functional
>          form rather than the simpler operator is _because_ the slot
>          name has to be computed.
>
> Is there some other reason to prefer the functional form?
>
> Josh
>
>
>> Finally, never use T/F for TRUE and FALSE, try:
>>
>> T <- FALSE
>>
>> and TRUE <- FALSE
>>
>> and see the difference.
>>
>> Terminally uninterested in winning points on SO,
>>
>> Roger
>>
>>
>>>
>>> --
>>> View this message in context: http://r-sig-geo.2731867.n2.
>>> nabble.com/Combining-polygons-and-calculating-their-area-i-
>>> e-number-of-cells-tp7585395p7585401.html
>>> Sent from the R-sig-geo mailing list archive at Nabble.com.
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>>
>> --
>> Roger Bivand
>> Department of Economics, Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From alobolistas at gmail.com  Fri Dec 20 15:03:41 2013
From: alobolistas at gmail.com (Agustin Lobo)
Date: Fri, 20 Dec 2013 15:03:41 +0100
Subject: [R-sig-Geo] =?windows-1252?q?invalid_class_=93SpatialPolygons=94_?=
	=?windows-1252?q?object=3A_non-unique_Polygons_ID_slot_values?=
Message-ID: <CAG4NReKZWSVbiNL9Ob=WMMsNZttDM+dYwEOvnCGXLOgOAjNqaA@mail.gmail.com>

Hi!

I've got the "invalid class ?SpatialPolygons? object: non-unique
Polygons ID slot values"
error at trying to use rbind() (or spRbind()) with two spatial
polygons dataframes that
come from readOGR() of shapefiles.
Not having done this operation in a long while, It took me quite a
long time to remember about the spChFIDs() solution
(i.e. http://r-sig-geo.2731867.n2.nabble.com/rbind-of-SpPolDFs-td5070215.html)
despite the fact that the help page of spRbind() mentions the  spChFIDs-methods.

Could an example in which spChFIDs() has to be run be added to the
Examples of the spRbind help page?
Actually I think that the case in which 2 spatial polygons dataframes
have independently assigned IDs (and thus most often require the
spChFIDs step) is more common than the case of the current example and
many users just remain confused looking at the error "invalid class
?SpatialPolygons? object: non-unique Polygons ID slot values".

Also, could the rbind() help page contemplate the case of sp objects?

Thanks

Agus


From alexander.brenning at uwaterloo.ca  Fri Dec 20 16:07:10 2013
From: alexander.brenning at uwaterloo.ca (Alexander Brenning)
Date: Fri, 20 Dec 2013 15:07:10 +0000
Subject: [R-sig-Geo] focal.function() adds NA value to output
Message-ID: <7751194102F32C41B664258D78FE5BC571C9042D@connmbx1>

Dear Ludwig,

the reason for this issue seems to be that the correct argument name is nodata.values, not no.data.values.

Your 'no.data.values' argument is passed on to the function specified in your 'fun' argument, i.e. 'sum', which in turn happily accepts '...' as arguments and just adds your no.data.values to the values from the moving window. focal.function doesn't cause an error because the argument is just passed on, and sum doesn't cause an error for 'unused argument' because it accepts named arguments of whatever name, as in
     sum(c(1,2,3), no.data.values=-99999)

All the best
  Alex

--
Alexander Brenning
brenning at uwaterloo.ca - T +1-519-888-4567 ext 35783
Department of Geography and Environmental Management
University of Waterloo
200 University Ave. W - Waterloo, ON - Canada N2L 3G1
UW: https://uwaterloo.ca/gem/people-profiles/alexander-brenning
Academia.edu: http://uwaterloo.academia.edu/AlexanderBrenning
LinkedIn: http://ca.linkedin.com/pub/alexander-brenning/3/242/440

________________________________________

Date: Fri, 20 Dec 2013 00:53:57 -0800 (PST)
From: Ludwig Hilger <l.hilger at ku.de>
To: r-sig-geo at r-project.org
Subject: [R-sig-Geo] focal.function() adds NA value to output
Message-ID: <1387529637959-7585417.post at n2.nabble.com>
Content-Type: text/plain; charset=UTF-8

Hello everybody,

I have an .asc file containing only 0 and 1 and I am running
focal.function() from the RSAGA package to sum these values in a moving
window. Using a 5*5 window, the values I get in the output grid do not range
between 0 and 25 but between -99999 and 99974, so evidently, the NA values
(-99999 in my case) is added to every single window output. I can not find
any explanation for this.

Appreciating you help and time,
regards,
Ludwig

*SessionInfo:*
R version 3.0.2 (2013-09-25)
Platform: x86_64-w64-mingw32/x64 (64-bit)

locale:
[1] LC_COLLATE=German_Germany.1252  LC_CTYPE=German_Germany.1252
LC_MONETARY=German_Germany.1252 LC_NUMERIC=C
LC_TIME=German_Germany.1252

attached base packages:
[1] grDevices datasets  splines   graphics  stats     tcltk     utils
methods   base

other attached packages:
 [1] lattice_0.20-23 outliers_0.14   gplots_2.12.1   rgdal_0.8-11
raster_2.1-49   sp_1.0-13       RSAGA_0.93-6    plyr_1.8
shapefiles_0.7  foreign_0.8-55  gstat_1.0-17    svSocket_0.9-55 TinnR_1.0-5
[14] R2HTML_2.2.1    Hmisc_3.12-2    Formula_1.1-1   survival_2.37-4

loaded via a namespace (and not attached):
 [1] bitops_1.0-6       caTools_1.14       cluster_1.14.4     gdata_2.13.2
grid_3.0.2         gtools_3.1.0       intervals_0.14.0   KernSmooth_2.23-10
rpart_4.1-3        spacetime_1.0-9    svMisc_0.9-69
[12] tools_3.0.2        xts_0.9-7          zoo_1.7-10

*The input grid can be found here: *
http:///www.altmuehlnet.de/~hilger/Diff_not_sig_plus.asc

*Here is my code:*

library(RSAGA)
ws <- 5

focal.function(
  in.grid = "Diff_not_sig_plus.asc",
  path = getwd(),
  fun = "sum",
  radius = (ws-1)/2,
  out.grid.prefix = paste("Diff_not_sig_plus_", ws, "mal", ws, sep = ""),
  varnames = "counts",
  is.pixel.radius = TRUE,
  valid.range = c(-10000, 10000),
  out.nodata.value = -99999,
  no.data.values = c(-99999),
  mw.to.vector = FALSE,
  mw.na.rm = TRUE,
  search.mode = "square",
  digits = 1,
  dec = ".",
  quiet = TRUE)



-----
Dipl. Geogr. Ludwig Hilger
Wiss. MA
Lehrstuhl f?r Physische Geographie
Katholische Universit?t Eichst?tt-Ingolstadt
Ostenstra?e 18
85072 Eichst?tt

Tel.: 08421-93-1180
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/focal-function-adds-NA-value-to-output-tp7585417.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From e.defriez11 at imperial.ac.uk  Fri Dec 20 16:12:37 2013
From: e.defriez11 at imperial.ac.uk (Defriez, Emma)
Date: Fri, 20 Dec 2013 15:12:37 +0000
Subject: [R-sig-Geo] Problem with singular matrix errosarlm
Message-ID: <2E74FF57C79A824FB51A7B057F8497172CD91295@icexch-m4.ic.ac.uk>

Hi,

I am trying to fit a spatial regression model with errorsarlm in spdep, but I have been running into some problems.

I can get weights style W and B to work with method LU however not S or C I get the following error (traceback below): Error in solve.default(-(mat), tol.solve = tol.solve) : system is computationally singular: reciprocal condition number = 0

I have rescaled the RHS variables to mean 0 and standard deviation 1. I have also tried removing all but two of the RHS variables which are definitely not collinear to see if that was the problem but I get the same error.

Each data point represents a 1by1 degree cell for the world's oceans, because I am using dnearneigh points at the equator have far fewer neighbours than those nearer the poles. Could this unequal number of neighbours be the reason for the error?

Also this model has 4647 points and takes around 50minutes to run which seems like a long time do you think this is due to the number of neighbours? The full data set has 31609 so I imagine this is going to take an extremely long time.

Code:

chl<-(chl-mean(chl,na.rm=T))/sd(chl)
sst<-(sst-mean(sst,na.rm=T))/sd(sst)
chlm<-(chlm-mean(chlm,na.rm=T))/sd(chlm)
sstm<-(sstm-mean(sstm,na.rm=T))/sd(sstm)
depth<-(depth-mean(depth,na.rm=T))/sd(depth)
lats<-(lats-mean(lats,na.rm=T))/sd(lats)
longs<-(longs-mean(longs,na.rm=T))/sd(longs)

ols<-lm(chl~sst+depth+chlm+sstm+lats+longs)

coords<-cbind(longs,lats)
coords<-as.matrix(coords)

#Define neighbourhood here max is 200km
nn<-dnearneigh(coords,0,200,longlat = TRUE)

nn
Neighbour list object:
Number of regions: 4647
Number of nonzero links: 11438816
Percentage nonzero weights: 52.9707
Average number of links: 2461.549

#get inverse distances 
dsts <- nbdists(nn, coords)
idw <- lapply(dsts, function(x) 1/(x))

#Spatial weights
nnweights<-nb2listw(nn, glist=idw, style='S')


sem0_500<-errorsarlm(formula(ols), listw=nnweights,na.action=na.omit, method='LU',
+               tol.solve=1e-16, control=list(returnHcov=FALSE))
Error in solve.default(-(mat), tol.solve = tol.solve) :
  system is computationally singular: reciprocal condition number = 0

> traceback()
5: solve.default(-(mat), tol.solve = tol.solve)
4: solve(-(mat), tol.solve = tol.solve)
3: solve(-(mat), tol.solve = tol.solve)
2: getVmate(coefs, env, s2, trs, tol.solve = tol.solve, optim = con$optimHess,
       optimM = con$optimHessMethod)
1: errorsarlm(formula(ols), listw = nnweights, na.action = na.omit,
       method = "LU", tol.solve = 1e-16, control = list(returnHcov = FALSE))

when I try to run it with different method I got a different error


> sem0_500<-errorsarlm(formula(ols), listw=nnweights,na.action=na.omit, method='Matrix',
+  tol.solve=1e-16, control=list(returnHcov=FALSE))                                
 Warning message: In .local(object, ...) :
  Cholmod warning 'matrix not positive definite' at file ../Supernodal/t_cholmod_super_numeric.c, line 729

Error in determinant(update(nChol, nW, 1/coef)) :
  error in evaluating the argument 'x' in selecting a method for function 'determinant': Error in .local(object, ...) : CHOLMOD factorization was unsuccessful

> traceback()
8: determinant(update(nChol, nW, 1/coef))
7: ifelse(coef > b, n * log(coef) + (.f * c(determinant(update(nChol,
       nW, 1/coef))$modulus)), ifelse(coef < a, n * log(-(coef)) +
       (.f * c(determinant(update(pChol, csrw, 1/(-coef)))$modulus)),
       0))
6: Matrix_ldet(coef, env, which = which)
5: do_ldet(lambda, env)
4: f(arg, ...)
3: (function (arg)
   -f(arg, ...))(0.930150734356483)
2: optimize(sar.error.f, interval = interval, maximum = TRUE, tol = con$tol.opt,
       env = env)
1: errorsarlm(formula(ols), listw = nnweights, na.action = na.omit,
       method = "Matrix", tol.solve = 1e-16, control = list(returnHcov = FALSE))

> sessionInfo()
R version 3.0.2 (2013-09-25)
Platform: x86_64-pc-linux-gnu (64-bit)

locale:
 [1] LC_CTYPE=en_GB.UTF-8       LC_NUMERIC=C
 [3] LC_TIME=en_GB.UTF-8        LC_COLLATE=en_GB.UTF-8
 [5] LC_MONETARY=en_GB.UTF-8    LC_MESSAGES=en_GB.UTF-8
 [7] LC_PAPER=en_GB.UTF-8       LC_NAME=C
 [9] LC_ADDRESS=C               LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_GB.UTF-8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] ncf_1.1-4    spdep_0.5-68 Matrix_1.1-0 sp_1.0-14

loaded via a namespace (and not attached):
[1] boot_1.3-9      coda_0.16-1     deldir_0.1-1    grid_3.0.2
[5] lattice_0.20-24 LearnBayes_2.12 MASS_7.3-29     nlme_3.1-111
[9] splines_3.0.2

I feel I am doing something wrong when specifying the weights matrix but I can't work out what. Any help would be hugely appreciated.


Thanks,

Emma

PhD student
Imperial College London


From etiennebr at gmail.com  Fri Dec 20 17:10:38 2013
From: etiennebr at gmail.com (Etienne B. Racine)
Date: Fri, 20 Dec 2013 11:10:38 -0500
Subject: [R-sig-Geo] Error in .gd_SetProject(transient, crs(r))
In-Reply-To: <CAG4NRe+9dQRYtxvvsYt=9er2v1QgfUR0BkohBCbhg5ZaenS0DQ@mail.gmail.com>
References: <1386698273714-7585330.post@n2.nabble.com>
	<CAG4NReKF_eaEJZjUscFuuyxXM376LG1SzOMnsZ_--kSR3oD4fA@mail.gmail.com>
	<CAP8THHW+kc5V1K1RLVtc5oGYn-rCEozUGrZA1A0UUU6m+i9AMQ@mail.gmail.com>
	<CAG4NReK=YqMdbymVPyh2Ak-MsaY9uvLjgKDUWyRafVf=rccWjw@mail.gmail.com>
	<CAP8THHUz2KPDZYeYmibYDk2S+FivBhFMYmxN4pW=Vm6uR6FAMQ@mail.gmail.com>
	<CANtt_hwd_SQpOc=Ux96rqXmptJAFHGZYWi=V__tNM4R38KquWg@mail.gmail.com>
	<CAG4NRe+9dQRYtxvvsYt=9er2v1QgfUR0BkohBCbhg5ZaenS0DQ@mail.gmail.com>
Message-ID: <CALjAYt4M5zq-uTwC+VymUnE-mOuauCGbJnWXYxBB3gN0u3baQQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131220/499e7c0c/attachment.pl>

From joshmobrien at gmail.com  Fri Dec 20 18:20:56 2013
From: joshmobrien at gmail.com (Josh O'Brien)
Date: Fri, 20 Dec 2013 09:20:56 -0800
Subject: [R-sig-Geo] Combining polygons and calculating their area (i.e.
 number of cells)
In-Reply-To: <alpine.LRH.2.03.1312201414290.26305@reclus.nhh.no>
References: <20131218160845.y3i58izfkkswcw8k@webmail.uni-potsdam.de>
	<1387387734978-7585401.post@n2.nabble.com>
	<alpine.LRH.2.03.1312191307550.20214@reclus.nhh.no>
	<CAOwKfPRsQanZSw14zNsH9OBvJ57LJLxF+JUi7Ud7n6nXTi0Kuw@mail.gmail.com>
	<alpine.LRH.2.03.1312201414290.26305@reclus.nhh.no>
Message-ID: <CAOwKfPRA7C6_smVmn7ZcqgfTSugUs_5KdOUtCrXWk=6M3nzdSg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131220/9ea830cb/attachment.pl>

From chrjan70 at gmail.com  Fri Dec 20 18:52:02 2013
From: chrjan70 at gmail.com (Christian Jansson)
Date: Fri, 20 Dec 2013 14:52:02 -0300
Subject: [R-sig-Geo] Problems with gDelaunayTriangulation and neighbors.
In-Reply-To: <52B3E8A3.2030005@auckland.ac.nz>
References: <CAAHdiqzsbdO_bXuWqgALMP0-s98xcW74UML8hv-LjQ_dzdPv2g@mail.gmail.com>
	<52B3E8A3.2030005@auckland.ac.nz>
Message-ID: <CAAHdiqzDOsrPu7g0XKGROxSbS0yLeFq05gOPxXfR2PbkWCGJhw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131220/ac3d6de4/attachment.pl>

From edzer.pebesma at uni-muenster.de  Fri Dec 20 20:06:09 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 20 Dec 2013 20:06:09 +0100
Subject: [R-sig-Geo] Combining polygons and calculating their area (i.e.
 number of cells)
In-Reply-To: <CAOwKfPRA7C6_smVmn7ZcqgfTSugUs_5KdOUtCrXWk=6M3nzdSg@mail.gmail.com>
References: <20131218160845.y3i58izfkkswcw8k@webmail.uni-potsdam.de>	<1387387734978-7585401.post@n2.nabble.com>	<alpine.LRH.2.03.1312191307550.20214@reclus.nhh.no>	<CAOwKfPRsQanZSw14zNsH9OBvJ57LJLxF+JUi7Ud7n6nXTi0Kuw@mail.gmail.com>	<alpine.LRH.2.03.1312201414290.26305@reclus.nhh.no>
	<CAOwKfPRA7C6_smVmn7ZcqgfTSugUs_5KdOUtCrXWk=6M3nzdSg@mail.gmail.com>
Message-ID: <52B49521.2020609@uni-muenster.de>



On 12/20/2013 06:20 PM, Josh O'Brien wrote:
> On Fri, Dec 20, 2013 at 5:38 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> 
>> On Thu, 19 Dec 2013, Josh O'Brien wrote:
>>
>>  On Thu, Dec 19, 2013 at 4:23 AM, Roger Bivand <Roger.Bivand at nhh.no>
>>> wrote:
>>>
>>>  On Wed, 18 Dec 2013, Josh O'Brien wrote:
>>>>
>>>>
>>> <...snip...>
>>>
>>> By the way, always avoid accessing S4 objects directly using @, do use
>>>
>>>> slot(obj, "slotname") - the sapply should read:
>>>>
>>>> area = sapply(slot(SPclus, "polygons"), slot, "area")
>>>>
>>>> for the SO version with possibly incorrect areas, and
>>>>
>>>> area = gArea(SPclus, byid=TRUE)
>>>>
>>>> for correct ones.
>>>>
>>>
>>>
>>> Would you mind explaining why the functional form, slot(obj, "slotname"),
>>> should always be used instead of obj at slotname ? I've seen this admonition
>>> repeatedly -- I think just from you -- and don't know whether it's a
>>> purely
>>> stylistic preference on your part, or whether there  is some other
>>> rationale for preferring that form.
>>>
>>
>> When sp was written (2003-5), we chose to use S4 (new style) classes. We
>> used Chambers (1998), referring to Ch. 7, and on slots pp. 290-292. There
>> the distinction between S3 (old style) "$" and "$<-" access and replacement
>> methods, and S4 "@" and particularly "@<-" was made more forcefully than in
>> Chambers (2008). Contemporary uses described in Venables and Ripley (2000)
>> also distinguish between the two.
>>
>> All of these point to the formal use of S4 class definitions, not least to
>> ensure that storage mode checking when using .C() and .Call() cease to be
>> so time-consuming. This is an issue with S3 classes, because there is
>> nothing to stop the user modifying the storage mode of list components,
>> with potentially bad consequences in compiled code. Defensive changes in
>> the underlying R engine to detect mode mismatch were introduced very much
>> later, I believe, so mode mismatch could crash the engine until them.
>>
>> For both S3 and S4 classes, the user is encouraged to use access functions
>> where provided. If the classes and methods are sufficiently well written,
>> there should only be a few occasions in which the user might want to access
>> components (S3) or slots (S4) that are not exposed via methods. If scripts
>> consistently contain @, and no access or replacement methods are provided,
>> consider asking the package maintainer to add the missing functionality.
>> slot() is a little less ugly, but the user shouldn't really need it either,
>> unless something inside an object has to be shown or manipulated.
>>
>> In this case, the "area" slot is documented, but precisely because it is
>> not intended to be used as a measure of area, there is no access method.
>>
>> The danger is that "@<-" and "$<-" are used to insert values into
>> components/slots without sufficient care being taken; access is perhaps
>> less of a problem.
>>
>> I particularly react to usages such as:
>>
>> sdf at data$var
>>
>> for sdf a Spatial*DataFrame object, as "$" and "$<-" methods *are*
>> provided to let these objects appear to be data.frame objects. This usage
>> is redundant, and displays ignorance about the class/method systems in S
>> and R. Of course, all are free to write what they like, so my preferences
>> may be just a matter of taste, but at least they are based on the books
>> written to establish the structure of the language.
>>
>> Hope this clarifies,
>>
>> Roger
>>
> 
> None of that seems like just a matter of taste _except_ perhaps for the
> preference for slot(obj, "slotname") over obj at slotname (which, by the way,
> is used extensively in the sp package's code base).

I agree.

As Roger says, access methods allow developers to improve implementation
of a class, while keeping scripts to work. If a package user works
directly on the slots, [s]he takes the risk that a change in the class
later breaks the script. Package developers own the class
implementation, they need to use the slots to make methods work.

Access functions may also do more than you think:

> library(sp)
> data(meuse)
> coordinates(meuse) = ~x+y
# this removes x and y from @data slot, to avoid redundancy:
> object.size(meuse)
39880 bytes
> meuse at data$x[1:10] # of course, they're no longer here:
NULL
# but:
> meuse$x[1:10] # retrieves x from @coords slot
     1      2      3      4      5      6      7      8      9     10
181072 181025 181165 181298 181307 181390 181165 181027 181060 181232
# alternatively:
> data(meuse)
> coordinates(meuse) = meuse[c("x", "y")]
# x and y are now both in @data and @coords, so:
> object.size(meuse)
42528 bytes
# and we can do a
> meuse at data$x[1:10]
 [1] 181072 181025 181165 181298 181307 181390 181165 181027 181060 181232

But all that was not your initial question.

> 
> Thanks for your thoughtful and enlightening reply,
> 
> - Josh
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 555 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131220/1fd57a05/attachment.bin>

From Roger.Bivand at nhh.no  Fri Dec 20 20:10:43 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 20 Dec 2013 20:10:43 +0100
Subject: [R-sig-Geo] Combining polygons and calculating their area (i.e.
 number of cells)
In-Reply-To: <CAOwKfPRA7C6_smVmn7ZcqgfTSugUs_5KdOUtCrXWk=6M3nzdSg@mail.gmail.com>
References: <20131218160845.y3i58izfkkswcw8k@webmail.uni-potsdam.de>
	<1387387734978-7585401.post@n2.nabble.com>
	<alpine.LRH.2.03.1312191307550.20214@reclus.nhh.no>
	<CAOwKfPRsQanZSw14zNsH9OBvJ57LJLxF+JUi7Ud7n6nXTi0Kuw@mail.gmail.com>
	<alpine.LRH.2.03.1312201414290.26305@reclus.nhh.no>
	<CAOwKfPRA7C6_smVmn7ZcqgfTSugUs_5KdOUtCrXWk=6M3nzdSg@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1312202004480.29099@reclus.nhh.no>

On Fri, 20 Dec 2013, Josh O'Brien wrote:

> On Fri, Dec 20, 2013 at 5:38 AM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>
>> On Thu, 19 Dec 2013, Josh O'Brien wrote:
>>
>>  On Thu, Dec 19, 2013 at 4:23 AM, Roger Bivand <Roger.Bivand at nhh.no>
>>> wrote:
>>>
>>>  On Wed, 18 Dec 2013, Josh O'Brien wrote:
>>>>
>>>>
>>> <...snip...>
>>>
>>> By the way, always avoid accessing S4 objects directly using @, do use
>>>
>>>> slot(obj, "slotname") - the sapply should read:
>>>>
>>>> area = sapply(slot(SPclus, "polygons"), slot, "area")
>>>>
>>>> for the SO version with possibly incorrect areas, and
>>>>
>>>> area = gArea(SPclus, byid=TRUE)
>>>>
>>>> for correct ones.
>>>>
>>>
>>>
>>> Would you mind explaining why the functional form, slot(obj, "slotname"),
>>> should always be used instead of obj at slotname ? I've seen this admonition
>>> repeatedly -- I think just from you -- and don't know whether it's a
>>> purely
>>> stylistic preference on your part, or whether there  is some other
>>> rationale for preferring that form.
>>>
>>
>> When sp was written (2003-5), we chose to use S4 (new style) classes. We
>> used Chambers (1998), referring to Ch. 7, and on slots pp. 290-292. There
>> the distinction between S3 (old style) "$" and "$<-" access and replacement
>> methods, and S4 "@" and particularly "@<-" was made more forcefully than in
>> Chambers (2008). Contemporary uses described in Venables and Ripley (2000)
>> also distinguish between the two.
>>
>> All of these point to the formal use of S4 class definitions, not least to
>> ensure that storage mode checking when using .C() and .Call() cease to be
>> so time-consuming. This is an issue with S3 classes, because there is
>> nothing to stop the user modifying the storage mode of list components,
>> with potentially bad consequences in compiled code. Defensive changes in
>> the underlying R engine to detect mode mismatch were introduced very much
>> later, I believe, so mode mismatch could crash the engine until them.
>>
>> For both S3 and S4 classes, the user is encouraged to use access functions
>> where provided. If the classes and methods are sufficiently well written,
>> there should only be a few occasions in which the user might want to access
>> components (S3) or slots (S4) that are not exposed via methods. If scripts
>> consistently contain @, and no access or replacement methods are provided,
>> consider asking the package maintainer to add the missing functionality.
>> slot() is a little less ugly, but the user shouldn't really need it either,
>> unless something inside an object has to be shown or manipulated.
>>
>> In this case, the "area" slot is documented, but precisely because it is
>> not intended to be used as a measure of area, there is no access method.
>>
>> The danger is that "@<-" and "$<-" are used to insert values into
>> components/slots without sufficient care being taken; access is perhaps
>> less of a problem.
>>
>> I particularly react to usages such as:
>>
>> sdf at data$var
>>
>> for sdf a Spatial*DataFrame object, as "$" and "$<-" methods *are*
>> provided to let these objects appear to be data.frame objects. This usage
>> is redundant, and displays ignorance about the class/method systems in S
>> and R. Of course, all are free to write what they like, so my preferences
>> may be just a matter of taste, but at least they are based on the books
>> written to establish the structure of the language.
>>
>> Hope this clarifies,
>>
>> Roger
>>
>
> None of that seems like just a matter of taste _except_ perhaps for the
> preference for slot(obj, "slotname") over obj at slotname (which, by the way,
> is used extensively in the sp package's code base).

Thanks for responding - use of "@" is said in the books to be OK inside 
functions, especially in the package defining the classes. I think one 
should expect package authors to maintain consistency in slot names and 
types themselves!

However, users should prefer access and replacement functions, and ask for 
more if they aren't there when needed. The same may well apply to other 
package authors importing classes - using access functions protects 
against road bumps if class definitions get changed (we get told by CRAN 
if our changes break downstream packages).

Roger


>
> Thanks for your thoughtful and enlightening reply,
>
> - Josh
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Fri Dec 20 20:14:35 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 20 Dec 2013 20:14:35 +0100
Subject: [R-sig-Geo] =?utf-8?q?invalid_class_=E2=80=9CSpatialPolygons?=
	=?utf-8?q?=E2=80=9D_object=3A_non-unique_Polygons_ID_slot_values?=
In-Reply-To: <CAG4NReKZWSVbiNL9Ob=WMMsNZttDM+dYwEOvnCGXLOgOAjNqaA@mail.gmail.com>
References: <CAG4NReKZWSVbiNL9Ob=WMMsNZttDM+dYwEOvnCGXLOgOAjNqaA@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1312202012060.29099@reclus.nhh.no>

On Fri, 20 Dec 2013, Agustin Lobo wrote:

> Hi!
>
> I've got the "invalid class ?SpatialPolygons? object: non-unique
> Polygons ID slot values"
> error at trying to use rbind() (or spRbind()) with two spatial
> polygons dataframes that
> come from readOGR() of shapefiles.
> Not having done this operation in a long while, It took me quite a
> long time to remember about the spChFIDs() solution
> (i.e. http://r-sig-geo.2731867.n2.nabble.com/rbind-of-SpPolDFs-td5070215.html)
> despite the fact that the help page of spRbind() mentions the  spChFIDs-methods.
>
> Could an example in which spChFIDs() has to be run be added to the
> Examples of the spRbind help page?
> Actually I think that the case in which 2 spatial polygons dataframes
> have independently assigned IDs (and thus most often require the
> spChFIDs step) is more common than the case of the current example and
> many users just remain confused looking at the error "invalid class
> ?SpatialPolygons? object: non-unique Polygons ID slot values".

Does:

library(maptools)
vignette("combine_maptools")

help?

Roger

>
> Also, could the rbind() help page contemplate the case of sp objects?
>
> Thanks
>
> Agus
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From Roger.Bivand at nhh.no  Fri Dec 20 22:18:31 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 20 Dec 2013 22:18:31 +0100
Subject: [R-sig-Geo] Problems with gDelaunayTriangulation and neighbors.
In-Reply-To: <CAAHdiqzsbdO_bXuWqgALMP0-s98xcW74UML8hv-LjQ_dzdPv2g@mail.gmail.com>
References: <CAAHdiqzsbdO_bXuWqgALMP0-s98xcW74UML8hv-LjQ_dzdPv2g@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1312202209340.29379@reclus.nhh.no>

On Wed, 18 Dec 2013, Christian Jansson wrote:

> Hi,
>
> I'm very happy that rgeos was updated to also do delaunay triangulation,
> but I have problems to match the results with the points.
>
> I need to to what is in the example-code in gDelaunayTriangulation-help.
> With meuse-data it works, but not with my own data.

Thanks for a reproducible example.

Well, the Meuse bank data are projected, yours are not. So you also run 
into the GEOS scaling issue. Your input longitude for the third point is:

> print(coordinates(tmp.coords[3]), digits=15)
                    lon               lat
[1,] -69.9492587302774 -17.9166152585801

while after having been through the GEOS triangulation operator, you get 
for example:

> print(coordinates(out1[22]), digits=20)
[[1]]
[[1]][[1]]
                           x                      y
[1,] -69.951718409999998016 -17.917070869999999871
[2,] -69.949258729999996831 -17.916615260000000376

where -69.949258729999996831 and -69.9492587302774 do not touch at least 
at the standard scale.

The rgeos function is there simply to expose what GEOS now offers, hence 
the code example on the help page (which you used without referring to it) 
is there to show the hoops you have to jump through to get GEOS to deliver 
triangles or egdes identified by point IDs. As you've seen, deldir does a 
better job at this, but trying alternatives is always sensible.

>
> How can the error in the following code be avoided? So I get out5.
>

Project the geographical coordinates?

Hope this clarifies,

Roger

> -------------
> library(sp)
> library(rgeos)
>
> tmp.coords <- structure(list(lon = c(-69.9601058046182, -69.9307142312949,
> -69.9492587302774, -69.938119947523, -69.9599320928521, -69.958492947506,
> -69.9517184088961, -69.9515127466649, -69.9608290339626,
> -69.9463054201695), lat = c(-17.922645866545, -17.9157740845672,
> -17.9166152585801, -17.9329659455957, -17.9270430312235, -17.933297069203,
> -17.9170708735245, -17.916779044717, -17.9405611407101,
> -17.9098645380403)), .Names = c("lon", "lat"), class = "data.frame",
> row.names = c(NA, -10L))
> coordinates(tmp.coords) <- c("lon", "lat")
> plot(gDelaunayTriangulation(tmp.coords))
> points(tmp.coords)
>
> out <- gDelaunayTriangulation(tmp.coords, onlyEdges=TRUE)
> lns <- slot(slot(out, "lines")[[1]], "Lines")
> out1 <- SpatialLines(lapply(seq(along=lns), function(i)
> Lines(list(lns[[i]]), ID=as.character(i))))
> out2 <- lapply(1:length(out1), function(i) which(gTouches(tmp.coords,
> out1[i], byid=TRUE)))
> out3 <- do.call("rbind", out2)
> o <- order(out3[,1], out3[,2])
> # The previous line generates "Error in out3[, 1] : subscript out of bounds"
>
> out4 <- out3[o,]
> out5 <- data.frame(from=out4[,1], to=out4[,2], weight=1)
> -------------
>
> Thanks.
>
> Best Regards,
> Chris
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Fri Dec 20 22:36:06 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 20 Dec 2013 22:36:06 +0100
Subject: [R-sig-Geo] Problem with singular matrix errosarlm
In-Reply-To: <2E74FF57C79A824FB51A7B057F8497172CD91295@icexch-m4.ic.ac.uk>
References: <2E74FF57C79A824FB51A7B057F8497172CD91295@icexch-m4.ic.ac.uk>
Message-ID: <alpine.LRH.2.03.1312202223290.29379@reclus.nhh.no>

On Fri, 20 Dec 2013, Defriez, Emma wrote:

> Hi,
>
> I am trying to fit a spatial regression model with errorsarlm in spdep, 
> but I have been running into some problems.
>
> I can get weights style W and B to work with method LU however not S or 
> C I get the following error (traceback below): Error in 
> solve.default(-(mat), tol.solve = tol.solve) : system is computationally 
> singular: reciprocal condition number = 0

My guess would be that the interval= argument should be given for S and C. 
In the LU case, the interval is set to -1,0.999 internally, and for each 
of these cases, the spatial coefficient may be being returned outside its 
domain, thus leading to failure in inverting the matrix returned by the 
numerical Hessian. Something similar may happen with Matrix - the Cholesky 
method.

>
> I have rescaled the RHS variables to mean 0 and standard deviation 1. I 
> have also tried removing all but two of the RHS variables which are 
> definitely not collinear to see if that was the problem but I get the 
> same error.
>
> Each data point represents a 1by1 degree cell for the world's oceans, 
> because I am using dnearneigh points at the equator have far fewer 
> neighbours than those nearer the poles. Could this unequal number of 
> neighbours be the reason for the error?
>
> Also this model has 4647 points and takes around 50minutes to run which 
> seems like a long time do you think this is due to the number of 
> neighbours? The full data set has 31609 so I imagine this is going to 
> take an extremely long time.
>

This is almost certainly caused by your choice of distance weights - you 
have 52% dense matrices, so lots of operations are being done on almost 
dense matrices. With 4647 points, you can use the eigen method too, which 
would give the domain interval exactly. You seem to have a mean number of 
links of 2461, so something rather odd is going on. The 1by1 degree cell 
for the world's land areas used in Bivand, Hauke & Kossowski (Geographical 
Analysis, 2013) with about 15K cells doesn't cause problems, but is very 
sparse.

Hope this clarifies,

Roger

> Code:
>
> chl<-(chl-mean(chl,na.rm=T))/sd(chl)
> sst<-(sst-mean(sst,na.rm=T))/sd(sst)
> chlm<-(chlm-mean(chlm,na.rm=T))/sd(chlm)
> sstm<-(sstm-mean(sstm,na.rm=T))/sd(sstm)
> depth<-(depth-mean(depth,na.rm=T))/sd(depth)
> lats<-(lats-mean(lats,na.rm=T))/sd(lats)
> longs<-(longs-mean(longs,na.rm=T))/sd(longs)
>
> ols<-lm(chl~sst+depth+chlm+sstm+lats+longs)
>
> coords<-cbind(longs,lats)
> coords<-as.matrix(coords)
>
> #Define neighbourhood here max is 200km
> nn<-dnearneigh(coords,0,200,longlat = TRUE)
>
> nn
> Neighbour list object:
> Number of regions: 4647
> Number of nonzero links: 11438816
> Percentage nonzero weights: 52.9707
> Average number of links: 2461.549
>
> #get inverse distances
> dsts <- nbdists(nn, coords)
> idw <- lapply(dsts, function(x) 1/(x))
>
> #Spatial weights
> nnweights<-nb2listw(nn, glist=idw, style='S')
>
>
> sem0_500<-errorsarlm(formula(ols), listw=nnweights,na.action=na.omit, method='LU',
> +               tol.solve=1e-16, control=list(returnHcov=FALSE))
> Error in solve.default(-(mat), tol.solve = tol.solve) :
>  system is computationally singular: reciprocal condition number = 0
>
>> traceback()
> 5: solve.default(-(mat), tol.solve = tol.solve)
> 4: solve(-(mat), tol.solve = tol.solve)
> 3: solve(-(mat), tol.solve = tol.solve)
> 2: getVmate(coefs, env, s2, trs, tol.solve = tol.solve, optim = con$optimHess,
>       optimM = con$optimHessMethod)
> 1: errorsarlm(formula(ols), listw = nnweights, na.action = na.omit,
>       method = "LU", tol.solve = 1e-16, control = list(returnHcov = FALSE))
>
> when I try to run it with different method I got a different error
>
>
>> sem0_500<-errorsarlm(formula(ols), listw=nnweights,na.action=na.omit, method='Matrix',
> +  tol.solve=1e-16, control=list(returnHcov=FALSE))
> Warning message: In .local(object, ...) :
>  Cholmod warning 'matrix not positive definite' at file ../Supernodal/t_cholmod_super_numeric.c, line 729
>
> Error in determinant(update(nChol, nW, 1/coef)) :
>  error in evaluating the argument 'x' in selecting a method for function 'determinant': Error in .local(object, ...) : CHOLMOD factorization was unsuccessful
>
>> traceback()
> 8: determinant(update(nChol, nW, 1/coef))
> 7: ifelse(coef > b, n * log(coef) + (.f * c(determinant(update(nChol,
>       nW, 1/coef))$modulus)), ifelse(coef < a, n * log(-(coef)) +
>       (.f * c(determinant(update(pChol, csrw, 1/(-coef)))$modulus)),
>       0))
> 6: Matrix_ldet(coef, env, which = which)
> 5: do_ldet(lambda, env)
> 4: f(arg, ...)
> 3: (function (arg)
>   -f(arg, ...))(0.930150734356483)
> 2: optimize(sar.error.f, interval = interval, maximum = TRUE, tol = con$tol.opt,
>       env = env)
> 1: errorsarlm(formula(ols), listw = nnweights, na.action = na.omit,
>       method = "Matrix", tol.solve = 1e-16, control = list(returnHcov = FALSE))
>
>> sessionInfo()
> R version 3.0.2 (2013-09-25)
> Platform: x86_64-pc-linux-gnu (64-bit)
>
> locale:
> [1] LC_CTYPE=en_GB.UTF-8       LC_NUMERIC=C
> [3] LC_TIME=en_GB.UTF-8        LC_COLLATE=en_GB.UTF-8
> [5] LC_MONETARY=en_GB.UTF-8    LC_MESSAGES=en_GB.UTF-8
> [7] LC_PAPER=en_GB.UTF-8       LC_NAME=C
> [9] LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_GB.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] ncf_1.1-4    spdep_0.5-68 Matrix_1.1-0 sp_1.0-14
>
> loaded via a namespace (and not attached):
> [1] boot_1.3-9      coda_0.16-1     deldir_0.1-1    grid_3.0.2
> [5] lattice_0.20-24 LearnBayes_2.12 MASS_7.3-29     nlme_3.1-111
> [9] splines_3.0.2
>
> I feel I am doing something wrong when specifying the weights matrix but I can't work out what. Any help would be hugely appreciated.
>
>
> Thanks,
>
> Emma
>
> PhD student
> Imperial College London
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From chrjan70 at gmail.com  Fri Dec 20 22:36:54 2013
From: chrjan70 at gmail.com (Christian Jansson)
Date: Fri, 20 Dec 2013 18:36:54 -0300
Subject: [R-sig-Geo] Problems with gDelaunayTriangulation and neighbors.
In-Reply-To: <alpine.LRH.2.03.1312202209340.29379@reclus.nhh.no>
References: <CAAHdiqzsbdO_bXuWqgALMP0-s98xcW74UML8hv-LjQ_dzdPv2g@mail.gmail.com>
	<alpine.LRH.2.03.1312202209340.29379@reclus.nhh.no>
Message-ID: <CAAHdiqwx_+1iNZTFNirvdzPNmwn6v73zdySd7buXxPVUF=pgxA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131220/afabee2e/attachment.pl>

From dicko.ahmadou at gmail.com  Fri Dec 20 22:53:52 2013
From: dicko.ahmadou at gmail.com (Ahmadou Dicko)
Date: Fri, 20 Dec 2013 21:53:52 +0000
Subject: [R-sig-Geo] Error in .gd_SetProject(transient, crs(r))
In-Reply-To: <CALjAYt4M5zq-uTwC+VymUnE-mOuauCGbJnWXYxBB3gN0u3baQQ@mail.gmail.com>
References: <1386698273714-7585330.post@n2.nabble.com>
	<CAG4NReKF_eaEJZjUscFuuyxXM376LG1SzOMnsZ_--kSR3oD4fA@mail.gmail.com>
	<CAP8THHW+kc5V1K1RLVtc5oGYn-rCEozUGrZA1A0UUU6m+i9AMQ@mail.gmail.com>
	<CAG4NReK=YqMdbymVPyh2Ak-MsaY9uvLjgKDUWyRafVf=rccWjw@mail.gmail.com>
	<CAP8THHUz2KPDZYeYmibYDk2S+FivBhFMYmxN4pW=Vm6uR6FAMQ@mail.gmail.com>
	<CANtt_hwd_SQpOc=Ux96rqXmptJAFHGZYWi=V__tNM4R38KquWg@mail.gmail.com>
	<CAG4NRe+9dQRYtxvvsYt=9er2v1QgfUR0BkohBCbhg5ZaenS0DQ@mail.gmail.com>
	<CALjAYt4M5zq-uTwC+VymUnE-mOuauCGbJnWXYxBB3gN0u3baQQ@mail.gmail.com>
Message-ID: <CAP8THHVRjXdpTfo7txPnDMksDSLyFcBxM8e2y9+H93tzOnrvWQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131220/48052cb8/attachment.pl>

From buckley.tom at gmail.com  Sat Dec 21 05:18:21 2013
From: buckley.tom at gmail.com (Tom Buckley)
Date: Fri, 20 Dec 2013 23:18:21 -0500
Subject: [R-sig-Geo] how to create maps from topojson files and csv data?
In-Reply-To: <CANVKczOmEMTA7vyVXTA375G_szMjTPjLjMoXpRkxjqm88KOokw@mail.gmail.com>
References: <d3712caee38d41f1b28c514a560abf4c@EX-0-HT0.lancs.local>
	<CANVKczOSEFAbkW0g5PstgQnmdqS9d3ZjDnVMqZ+_hZJ8ifBiog@mail.gmail.com>
	<CANVKczP=PRP5A4gGWuJtpoceS9EjNZ_-N3Xnu6kx6yhPns5Wdg@mail.gmail.com>
	<CACWkvhM7MrCv5h4muj_oOdfMUgTTH__-sK7Mmjpso4kww5Leng@mail.gmail.com>
	<925d532c81aa4a7d9333621cd02de401@EX-1-HT0.lancs.local>
	<76043ee8e79b4e258f0fa5a405c70e81@EX-0-HT0.lancs.local>
	<CANVKczPFp=r6p4BbzZoWn4i4XCMCP45xX23fhppAS3KM5=-hVw@mail.gmail.com>
	<d3f08614caa143f489ef060eb16903fc@EX-1-HT0.lancs.local>
	<CANVKczOmEMTA7vyVXTA375G_szMjTPjLjMoXpRkxjqm88KOokw@mail.gmail.com>
Message-ID: <CAK-oKLqMzXpKcVBscDGEhnvdfqo0HRVzdB--zcFx8MkeC0Md=A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131220/6644d048/attachment.pl>

From alobolistas at gmail.com  Sat Dec 21 12:16:57 2013
From: alobolistas at gmail.com (Agustin Lobo)
Date: Sat, 21 Dec 2013 12:16:57 +0100
Subject: [R-sig-Geo]
	=?windows-1252?q?invalid_class_=93SpatialPolygons=94_?=
	=?windows-1252?q?object=3A_non-unique_Polygons_ID_slot_values?=
In-Reply-To: <alpine.LRH.2.03.1312202012060.29099@reclus.nhh.no>
References: <CAG4NReKZWSVbiNL9Ob=WMMsNZttDM+dYwEOvnCGXLOgOAjNqaA@mail.gmail.com>
	<alpine.LRH.2.03.1312202012060.29099@reclus.nhh.no>
Message-ID: <CAG4NReKPuQj+0yOVjuwLLFaE+ndMxgEMggiUynk_nfcSihrkyw@mail.gmail.com>

Had looked into the vignette. No, it does not really help. spRbind() is only
mentioned in "2.1 Dissolving Polygons" and not in "3.1 Combining
Positional Data".
Including an example where the  "non-unique Polygons ID slot values" occurs in
section 3.1. and the way to fix it using spRbind() would be very helpful. But
having the same example in the help page also would be even better.
I also find the Note
"2. some rbind can accept objects with duplicated IDs,..."
in the spRbind help page very confusing, as it is vague and the rbind
help page does not mention spatial objects at all.

The error I mention is frequent when combining SpPolDF objects that
come from  imported shapefiles
and is probably rare in "only R" processing chains.

Thanks for caring about this.

Agus

On Fri, Dec 20, 2013 at 8:14 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
> On Fri, 20 Dec 2013, Agustin Lobo wrote:
>
>> Hi!
>>
>> I've got the "invalid class ?SpatialPolygons? object: non-unique
>> Polygons ID slot values"
>> error at trying to use rbind() (or spRbind()) with two spatial
>> polygons dataframes that
>> come from readOGR() of shapefiles.
>> Not having done this operation in a long while, It took me quite a
>> long time to remember about the spChFIDs() solution
>> (i.e.
>> http://r-sig-geo.2731867.n2.nabble.com/rbind-of-SpPolDFs-td5070215.html)
>> despite the fact that the help page of spRbind() mentions the
>> spChFIDs-methods.
>>
>> Could an example in which spChFIDs() has to be run be added to the
>> Examples of the spRbind help page?
>> Actually I think that the case in which 2 spatial polygons dataframes
>> have independently assigned IDs (and thus most often require the
>> spChFIDs step) is more common than the case of the current example and
>> many users just remain confused looking at the error "invalid class
>> ?SpatialPolygons? object: non-unique Polygons ID slot values".
>
>
> Does:
>
> library(maptools)
> vignette("combine_maptools")
>
> help?
>
> Roger
>
>>
>> Also, could the rbind() help page contemplate the case of sp objects?
>>
>> Thanks
>>
>> Agus
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From edzer.pebesma at uni-muenster.de  Sat Dec 21 14:23:37 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sat, 21 Dec 2013 14:23:37 +0100
Subject: [R-sig-Geo]
 =?windows-1252?q?invalid_class_=93SpatialPolygons=94_?=
 =?windows-1252?q?object=3A_non-unique_Polygons_ID_slot_values?=
In-Reply-To: <CAG4NReKPuQj+0yOVjuwLLFaE+ndMxgEMggiUynk_nfcSihrkyw@mail.gmail.com>
References: <CAG4NReKZWSVbiNL9Ob=WMMsNZttDM+dYwEOvnCGXLOgOAjNqaA@mail.gmail.com>	<alpine.LRH.2.03.1312202012060.29099@reclus.nhh.no>
	<CAG4NReKPuQj+0yOVjuwLLFaE+ndMxgEMggiUynk_nfcSihrkyw@mail.gmail.com>
Message-ID: <52B59659.1000505@uni-muenster.de>

Looking at the code,

x = rbind(x1, x2, x3, makeUniqueIDs = TRUE)

ought to work, but I haven't tried.

You are right that neither ?rbind nor ?rbind.SpatialPolygons tells you
about this.


On 12/21/2013 12:16 PM, Agustin Lobo wrote:
> Had looked into the vignette. No, it does not really help. spRbind() is only
> mentioned in "2.1 Dissolving Polygons" and not in "3.1 Combining
> Positional Data".
> Including an example where the  "non-unique Polygons ID slot values" occurs in
> section 3.1. and the way to fix it using spRbind() would be very helpful. But
> having the same example in the help page also would be even better.
> I also find the Note
> "2. some rbind can accept objects with duplicated IDs,..."
> in the spRbind help page very confusing, as it is vague and the rbind
> help page does not mention spatial objects at all.
> 
> The error I mention is frequent when combining SpPolDF objects that
> come from  imported shapefiles
> and is probably rare in "only R" processing chains.
> 
> Thanks for caring about this.
> 
> Agus
> 
> On Fri, Dec 20, 2013 at 8:14 PM, Roger Bivand <Roger.Bivand at nhh.no> wrote:
>> On Fri, 20 Dec 2013, Agustin Lobo wrote:
>>
>>> Hi!
>>>
>>> I've got the "invalid class ?SpatialPolygons? object: non-unique
>>> Polygons ID slot values"
>>> error at trying to use rbind() (or spRbind()) with two spatial
>>> polygons dataframes that
>>> come from readOGR() of shapefiles.
>>> Not having done this operation in a long while, It took me quite a
>>> long time to remember about the spChFIDs() solution
>>> (i.e.
>>> http://r-sig-geo.2731867.n2.nabble.com/rbind-of-SpPolDFs-td5070215.html)
>>> despite the fact that the help page of spRbind() mentions the
>>> spChFIDs-methods.
>>>
>>> Could an example in which spChFIDs() has to be run be added to the
>>> Examples of the spRbind help page?
>>> Actually I think that the case in which 2 spatial polygons dataframes
>>> have independently assigned IDs (and thus most often require the
>>> spChFIDs step) is more common than the case of the current example and
>>> many users just remain confused looking at the error "invalid class
>>> ?SpatialPolygons? object: non-unique Polygons ID slot values".
>>
>>
>> Does:
>>
>> library(maptools)
>> vignette("combine_maptools")
>>
>> help?
>>
>> Roger
>>
>>>
>>> Also, could the rbind() help page contemplate the case of sp objects?
>>>
>>> Thanks
>>>
>>> Agus
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>> --
>> Roger Bivand
>> Department of Economics, Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 555 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131221/80886885/attachment.bin>

From HodgessE at uhd.edu  Sat Dec 21 23:19:39 2013
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Sat, 21 Dec 2013 22:19:39 +0000
Subject: [R-sig-Geo] a projection question
Message-ID: <FF9DB805FC41CC4E95825A50F680630217AF5036@challenger.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131221/75df5cc8/attachment.pl>

From ldecola at comcast.net  Sun Dec 22 01:31:34 2013
From: ldecola at comcast.net (ldecola at comcast.net)
Date: Sun, 22 Dec 2013 00:31:34 +0000 (UTC)
Subject: [R-sig-Geo] a spatial bestiary?
In-Reply-To: <CAAcGz99hKAxh=OqsTo9R-QxMwaQeCCQRE=8zq6xERPkL8nm-oQ@mail.gmail.com>
Message-ID: <774153428.141874.1387672294227.JavaMail.root@sz0206a.westchester.pa.mail.comcast.net>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131222/69c9eab9/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Sun Dec 22 11:16:41 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Sun, 22 Dec 2013 10:16:41 +0000
Subject: [R-sig-Geo] a projection question
In-Reply-To: <b1f60e701efe4867b4345b2f6145a2ff@EX-0-HT0.lancs.local>
References: <b1f60e701efe4867b4345b2f6145a2ff@EX-0-HT0.lancs.local>
Message-ID: <CANVKczPQUBakG_0R1DgQjFK0uKuihq-F3pGHaivYRJ=rT_qYGw@mail.gmail.com>

First thought is to try and project a sample point and catch any error
messages, but you can't be sure that your sample point is valid in the
given coordinate system.

Second thought was to look at the proj4 and rgdal packages to see if
they implemented checking of PROJ.4 strings. Couldn't see it.

So third thought was to look at the PROJ.4 API and see what its got:

http://trac.osgeo.org/proj/wiki/pj_init_plus

which is a C function to initialise a projection. So I wrote a little wrapper:

#include <proj_api.h>

void ptest(char *proj[], int *status){
  projPJ out;
  if(!(out = pj_init_plus(proj[0]))){
    *status = 1;
  }else{
    *status = 0;
   /* need to pj_free the out object here... I think... */
  }
}

with an R wrapper: isValidProjection <-
function(s){.C("ptest",s,status=as.integer(-1))$status==0}

compiled it, linked with libproj.so and tested it:


> isValidProjection("+init=epsg:4326")
[1] TRUE

- user typo:

> isValidProjection("+init=apsg:4326")
[1] FALSE

- try more than +init strings:

> isValidProjection("+proj=tmerc +lon_0 +datum=WGS84")
[1] TRUE

- some bogus EPSG codes:

> isValidProjection("+init=epsg:4326999")
[1] FALSE
> isValidProjection("+init=epsg:-1")
[1] FALSE

Looks like it works. The tricky part of all this is linking the C code
with libproj.so which I did by doing:

R CMD SHLIB projtest.c /usr/lib/libproj.so

on the command line. Might work for you, but it might be worth asking
Roger, as maintainer or rgdal, or Smon Urbanek as maintainer of
project, to add it as a top-level R function.

 Maybe I'll check out the rgdal source and push a change for Roger...

Barry




On Sat, Dec 21, 2013 at 10:19 PM, Hodgess, Erin <HodgessE at uhd.edu> wrote:
> Hello everyone:
>
> I'm setting up a function in which the user enters the projection (as part of other stuff).
>
> What is the best way to determine if the entered projection is correct, please? (so I can send back an error message right away).
>
> Thanks,
> Erin
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From b.rowlingson at lancaster.ac.uk  Sun Dec 22 11:33:11 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Sun, 22 Dec 2013 10:33:11 +0000
Subject: [R-sig-Geo] how to create maps from topojson files and csv data?
In-Reply-To: <16529d6e4f3e4320bcb891dcc3fcff2a@EX-1-HT0.lancs.local>
References: <d3712caee38d41f1b28c514a560abf4c@EX-0-HT0.lancs.local>
	<CANVKczOSEFAbkW0g5PstgQnmdqS9d3ZjDnVMqZ+_hZJ8ifBiog@mail.gmail.com>
	<CANVKczP=PRP5A4gGWuJtpoceS9EjNZ_-N3Xnu6kx6yhPns5Wdg@mail.gmail.com>
	<CACWkvhM7MrCv5h4muj_oOdfMUgTTH__-sK7Mmjpso4kww5Leng@mail.gmail.com>
	<925d532c81aa4a7d9333621cd02de401@EX-1-HT0.lancs.local>
	<76043ee8e79b4e258f0fa5a405c70e81@EX-0-HT0.lancs.local>
	<CANVKczPFp=r6p4BbzZoWn4i4XCMCP45xX23fhppAS3KM5=-hVw@mail.gmail.com>
	<d3f08614caa143f489ef060eb16903fc@EX-1-HT0.lancs.local>
	<CANVKczOmEMTA7vyVXTA375G_szMjTPjLjMoXpRkxjqm88KOokw@mail.gmail.com>
	<16529d6e4f3e4320bcb891dcc3fcff2a@EX-1-HT0.lancs.local>
Message-ID: <CANVKczMty8io0aMYc8rfaaEG2uZOOPsHLCze+8TxVtFbqdyX=Q@mail.gmail.com>

On Sat, Dec 21, 2013 at 4:18 AM, Tom Buckley <buckley.tom at gmail.com> wrote:
> Nice to see some kindred spirits out there!
>
> TopoJSON --> SP presents some interesting challenges/questions.
>
> I've been writing some amateurish code to address some of these here:
>
> https://github.com/buckleytom/topojson/
>
> Comments/questions welcome. Sorry for the rough shape its in.

 Yes, it might be nice to have a standard way to store objects with
topology in R, since they take up less memory and its easier to
compute things like adjacency using them. However they must be a bit
slower to draw since you need to reassemble the polygons (at least
when drawing filled polygons) and you still then draw every outline
twice.

 SpatialTopoPolygonsDataFrame anyone? It would be coerceable to a
SpatialPolygonsDataFrame with as(x,"SpatialPolygonsDataFrame") but
also have some specific methods that would take advantage of the
topological structure.

 Subsetting is an interesting problem - unless you keep all the
geometry so the arc numbers don't change, you have to change all the
arc numbers... Hmmm....

Barry


Barry


From HodgessE at uhd.edu  Sun Dec 22 17:21:16 2013
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Sun, 22 Dec 2013 16:21:16 +0000
Subject: [R-sig-Geo] a projection question
In-Reply-To: <CANVKczPQUBakG_0R1DgQjFK0uKuihq-F3pGHaivYRJ=rT_qYGw@mail.gmail.com>
References: <b1f60e701efe4867b4345b2f6145a2ff@EX-0-HT0.lancs.local>,
	<CANVKczPQUBakG_0R1DgQjFK0uKuihq-F3pGHaivYRJ=rT_qYGw@mail.gmail.com>
Message-ID: <FF9DB805FC41CC4E95825A50F680630217AF529A@challenger.uhd.campus>

Great!  This is so cool!

Thanks!

________________________________________
From: b.rowlingson at gmail.com [b.rowlingson at gmail.com] on behalf of Barry Rowlingson [b.rowlingson at lancaster.ac.uk]
Sent: Sunday, December 22, 2013 4:16 AM
To: Hodgess, Erin
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] a projection question

First thought is to try and project a sample point and catch any error
messages, but you can't be sure that your sample point is valid in the
given coordinate system.

Second thought was to look at the proj4 and rgdal packages to see if
they implemented checking of PROJ.4 strings. Couldn't see it.

So third thought was to look at the PROJ.4 API and see what its got:

http://trac.osgeo.org/proj/wiki/pj_init_plus

which is a C function to initialise a projection. So I wrote a little wrapper:

#include <proj_api.h>

void ptest(char *proj[], int *status){
  projPJ out;
  if(!(out = pj_init_plus(proj[0]))){
    *status = 1;
  }else{
    *status = 0;
   /* need to pj_free the out object here... I think... */
  }
}

with an R wrapper: isValidProjection <-
function(s){.C("ptest",s,status=as.integer(-1))$status==0}

compiled it, linked with libproj.so and tested it:


> isValidProjection("+init=epsg:4326")
[1] TRUE

- user typo:

> isValidProjection("+init=apsg:4326")
[1] FALSE

- try more than +init strings:

> isValidProjection("+proj=tmerc +lon_0 +datum=WGS84")
[1] TRUE

- some bogus EPSG codes:

> isValidProjection("+init=epsg:4326999")
[1] FALSE
> isValidProjection("+init=epsg:-1")
[1] FALSE

Looks like it works. The tricky part of all this is linking the C code
with libproj.so which I did by doing:

R CMD SHLIB projtest.c /usr/lib/libproj.so

on the command line. Might work for you, but it might be worth asking
Roger, as maintainer or rgdal, or Smon Urbanek as maintainer of
project, to add it as a top-level R function.

 Maybe I'll check out the rgdal source and push a change for Roger...

Barry




On Sat, Dec 21, 2013 at 10:19 PM, Hodgess, Erin <HodgessE at uhd.edu> wrote:
> Hello everyone:
>
> I'm setting up a function in which the user enters the projection (as part of other stuff).
>
> What is the best way to determine if the entered projection is correct, please? (so I can send back an error message right away).
>
> Thanks,
> Erin
>
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Roger.Bivand at nhh.no  Sun Dec 22 18:29:04 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sun, 22 Dec 2013 18:29:04 +0100
Subject: [R-sig-Geo] a projection question
In-Reply-To: <CANVKczPQUBakG_0R1DgQjFK0uKuihq-F3pGHaivYRJ=rT_qYGw@mail.gmail.com>
References: <b1f60e701efe4867b4345b2f6145a2ff@EX-0-HT0.lancs.local>
	<CANVKczPQUBakG_0R1DgQjFK0uKuihq-F3pGHaivYRJ=rT_qYGw@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1312221824170.17107@reclus.nhh.no>

On Sun, 22 Dec 2013, Barry Rowlingson wrote:

> First thought is to try and project a sample point and catch any error
> messages, but you can't be sure that your sample point is valid in the
> given coordinate system.
>
> Second thought was to look at the proj4 and rgdal packages to see if
> they implemented checking of PROJ.4 strings. Couldn't see it.

?checkCRSArgs

checkCRSArgs("+init=epsg:4326")
checkCRSArgs("+init=apsg:4326")
checkCRSArgs("+init=epsg:4326999")
checkCRSArgs("+init=epsg:-1")

Been there a long time.

Roger

>
> So third thought was to look at the PROJ.4 API and see what its got:
>
> http://trac.osgeo.org/proj/wiki/pj_init_plus
>
> which is a C function to initialise a projection. So I wrote a little wrapper:
>
> #include <proj_api.h>
>
> void ptest(char *proj[], int *status){
>  projPJ out;
>  if(!(out = pj_init_plus(proj[0]))){
>    *status = 1;
>  }else{
>    *status = 0;
>   /* need to pj_free the out object here... I think... */
>  }
> }
>
> with an R wrapper: isValidProjection <-
> function(s){.C("ptest",s,status=as.integer(-1))$status==0}
>
> compiled it, linked with libproj.so and tested it:
>
>
>> isValidProjection("+init=epsg:4326")
> [1] TRUE
>
> - user typo:
>
>> isValidProjection("+init=apsg:4326")
> [1] FALSE
>
> - try more than +init strings:
>
>> isValidProjection("+proj=tmerc +lon_0 +datum=WGS84")
> [1] TRUE
>
> - some bogus EPSG codes:
>
>> isValidProjection("+init=epsg:4326999")
> [1] FALSE
>> isValidProjection("+init=epsg:-1")
> [1] FALSE
>
> Looks like it works. The tricky part of all this is linking the C code
> with libproj.so which I did by doing:
>
> R CMD SHLIB projtest.c /usr/lib/libproj.so
>
> on the command line. Might work for you, but it might be worth asking
> Roger, as maintainer or rgdal, or Smon Urbanek as maintainer of
> project, to add it as a top-level R function.
>
> Maybe I'll check out the rgdal source and push a change for Roger...
>
> Barry
>
>
>
>
> On Sat, Dec 21, 2013 at 10:19 PM, Hodgess, Erin <HodgessE at uhd.edu> wrote:
>> Hello everyone:
>>
>> I'm setting up a function in which the user enters the projection (as part of other stuff).
>>
>> What is the best way to determine if the entered projection is correct, please? (so I can send back an error message right away).
>>
>> Thanks,
>> Erin
>>
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From ptitle at umich.edu  Sun Dec 22 21:25:44 2013
From: ptitle at umich.edu (Pascal Title)
Date: Sun, 22 Dec 2013 12:25:44 -0800
Subject: [R-sig-Geo] calculate surfaceArea across a broad extent in R
Message-ID: <CAPSA=yfSOXionSrwauzbD=1_mgUdgQVT9gz+wmFUZsbXv2tjqg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131222/ee63a5d3/attachment.pl>

From mdsumner at gmail.com  Sun Dec 22 22:38:41 2013
From: mdsumner at gmail.com (Michael Sumner)
Date: Mon, 23 Dec 2013 08:38:41 +1100
Subject: [R-sig-Geo] calculate surfaceArea across a broad extent in R
In-Reply-To: <CAPSA=yfSOXionSrwauzbD=1_mgUdgQVT9gz+wmFUZsbXv2tjqg@mail.gmail.com>
References: <CAPSA=yfSOXionSrwauzbD=1_mgUdgQVT9gz+wmFUZsbXv2tjqg@mail.gmail.com>
Message-ID: <CAAcGz9_V_OvdK5afc8StSNW_JDGTEoAV5nzeU2CvOWg41yjpfA@mail.gmail.com>

On Mon, Dec 23, 2013 at 7:25 AM, Pascal Title <ptitle at umich.edu> wrote:
> Hi,
>
> I would like to calculate surface area (area when elevation is taken into
> account) for various regions across South America.
>
> The following code example illustrates what I am doing:
>
> require(maptools)
> require(raster)
> require(rgeos)
> bb <- SpatialPoints(rbind(c(-85,15),c(-31,-57)))
> r <- raster(bb,nrow=100,ncol=100)
> values(r) <- abs(rnorm(10000,mean=500,sd=100))
> proj4string(r) <- CRS('+proj=longlat +datum=WGS84')
>
> #Create an arbitrary polygon
> poly <-
> gConvexHull(SpatialPoints(rbind(c(-70,5),c(-70,-15),c(-45,-20),c(-45,-7))))
> proj4string(poly) <- CRS('+proj=longlat +datum=WGS84')
>
> #subset raster to polygon
> rsub <- mask(r,poly)
>
> #what does it look like?
> data(wrld_simpl)
> plot(rsub)
> plot(wrld_simpl,add=T)
> plot(poly,add=T,border='blue')
>
> #Calculate surface area
> z <- as.matrix(rsub)
> surfaceArea(z, cellx=res(rsub)[1],celly=res(rsub)[2])
>
> Is this the proper way to do this? My main concern is that my coordinates
> are in longlat, but my elevation data (from worldclim.org) is in meters. It
> seems like the correct thing to do would be to transform the elevation
> raster and polygon into UTM so as to have everything in meters, but how do
> you do that when the area spans across multiple UTM zones?
>

Just don't use UTM!  There are many other good choices that don't have
this zone limitation. (Folks who peddle/refer-to UTM as if it's
somehow the *only* planar projection out there have a lot to answer
for . . .)

It really depends on your study region and needs, but you probably
cannot go wrong with Lambert Azimuthal Equal Area, build your own such
as:

"+proj=laea +lon_0=-60 +lat_0=-21 +datum=WGS84"

Please explore this with your own parameter values and seek further
expert advice for your study.  There are many many choices for an
appropriate projection and many guides already exist.

Cheers, Mike.


> Any advice welcome! Thank you!
> -Pascal
>
> --
> Pascal Title, MSc.
> PhD student, Rabosky Lab <http://www-personal.umich.edu/~drabosky/Home.html>
> Dept of Ecology and Evolutionary Biology
> University of Michigan
> ptitle at umich.edu
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Michael Sumner
Hobart, Australia
e-mail: mdsumner at gmail.com


From r.hijmans at gmail.com  Sun Dec 22 23:21:59 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sun, 22 Dec 2013 14:21:59 -0800
Subject: [R-sig-Geo] calculate surfaceArea across a broad extent in R
In-Reply-To: <CAAcGz9_V_OvdK5afc8StSNW_JDGTEoAV5nzeU2CvOWg41yjpfA@mail.gmail.com>
References: <CAPSA=yfSOXionSrwauzbD=1_mgUdgQVT9gz+wmFUZsbXv2tjqg@mail.gmail.com>
	<CAAcGz9_V_OvdK5afc8StSNW_JDGTEoAV5nzeU2CvOWg41yjpfA@mail.gmail.com>
Message-ID: <CANtt_hzxDN+guXyGhWH=9VnLpHhFzUw-0ijVYWoqu6c71XEArA@mail.gmail.com>

Can you avoid transforming, by computing the surface area for each
lon/lat cell, and then extract the values by polygon. Perhaps
something like this (I am not sure if this is how slope correction
should be done)?

library(raster)
elevation <- getData('alt', country='CHE')
slope <- terrain(elevation, opt='slope', unit='radians')
# c^2 = a^2 + b^2; let a be 1; atan(slope) = b/a = b
correction <- sqrt(atan(slope)^2 + 1)
area <- area(elevation)
cor_area <- area * correction

Robert

On Sun, Dec 22, 2013 at 1:38 PM, Michael Sumner <mdsumner at gmail.com> wrote:
> On Mon, Dec 23, 2013 at 7:25 AM, Pascal Title <ptitle at umich.edu> wrote:
>> Hi,
>>
>> I would like to calculate surface area (area when elevation is taken into
>> account) for various regions across South America.
>>
>> The following code example illustrates what I am doing:
>>
>> require(maptools)
>> require(raster)
>> require(rgeos)
>> bb <- SpatialPoints(rbind(c(-85,15),c(-31,-57)))
>> r <- raster(bb,nrow=100,ncol=100)
>> values(r) <- abs(rnorm(10000,mean=500,sd=100))
>> proj4string(r) <- CRS('+proj=longlat +datum=WGS84')
>>
>> #Create an arbitrary polygon
>> poly <-
>> gConvexHull(SpatialPoints(rbind(c(-70,5),c(-70,-15),c(-45,-20),c(-45,-7))))
>> proj4string(poly) <- CRS('+proj=longlat +datum=WGS84')
>>
>> #subset raster to polygon
>> rsub <- mask(r,poly)
>>
>> #what does it look like?
>> data(wrld_simpl)
>> plot(rsub)
>> plot(wrld_simpl,add=T)
>> plot(poly,add=T,border='blue')
>>
>> #Calculate surface area
>> z <- as.matrix(rsub)
>> surfaceArea(z, cellx=res(rsub)[1],celly=res(rsub)[2])
>>
>> Is this the proper way to do this? My main concern is that my coordinates
>> are in longlat, but my elevation data (from worldclim.org) is in meters. It
>> seems like the correct thing to do would be to transform the elevation
>> raster and polygon into UTM so as to have everything in meters, but how do
>> you do that when the area spans across multiple UTM zones?
>>
>
> Just don't use UTM!  There are many other good choices that don't have
> this zone limitation. (Folks who peddle/refer-to UTM as if it's
> somehow the *only* planar projection out there have a lot to answer
> for . . .)
>
> It really depends on your study region and needs, but you probably
> cannot go wrong with Lambert Azimuthal Equal Area, build your own such
> as:
>
> "+proj=laea +lon_0=-60 +lat_0=-21 +datum=WGS84"
>
> Please explore this with your own parameter values and seek further
> expert advice for your study.  There are many many choices for an
> appropriate projection and many guides already exist.
>
> Cheers, Mike.
>
>
>> Any advice welcome! Thank you!
>> -Pascal
>>
>> --
>> Pascal Title, MSc.
>> PhD student, Rabosky Lab <http://www-personal.umich.edu/~drabosky/Home.html>
>> Dept of Ecology and Evolutionary Biology
>> University of Michigan
>> ptitle at umich.edu
>>
>>         [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>
> --
> Michael Sumner
> Hobart, Australia
> e-mail: mdsumner at gmail.com
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From rvaldezr at gmail.com  Sun Dec 22 23:41:27 2013
From: rvaldezr at gmail.com (Rolando Valdez)
Date: Sun, 22 Dec 2013 23:41:27 +0100
Subject: [R-sig-Geo] Creating a map with metropolitan areas
Message-ID: <001301ceff66$f448ec90$dcdac5b0$@gmail.com>

Hi,

I'm new in this list, and new in the R environment. I'm trying to plot a map
with the index localization by metropolitan area.

I have a .shp with states (32 obs); 

https://skydrive.live.com/redir?resid=C319779BEF3A0241!1369&authkey=!AGj5MTC
l0waT_w0&v=3&ithint=photo%2c.png

then, I have a .shp with municipalities (2454 obs);

https://skydrive.live.com/redir?resid=C319779BEF3A0241!1370&authkey=!AFhsFOZ
_kERbGKA&v=3&ithint=photo%2c.png

then, I have the index localization by municipalities (345 municipalities)
grouped in metropolitan areas and I need to plot something like this map:

https://skydrive.live.com/redir?resid=C319779BEF3A0241!1364&authkey=!AEki9Sa
DxCfPmy8&v=3&ithint=photo%2c.jpg

I hope you can help me.

Regards,

Rolando


From e.defriez11 at imperial.ac.uk  Mon Dec 23 12:23:29 2013
From: e.defriez11 at imperial.ac.uk (Defriez, Emma)
Date: Mon, 23 Dec 2013 11:23:29 +0000
Subject: [R-sig-Geo] Problem with singular matrix errosarlm
In-Reply-To: <alpine.LRH.2.03.1312202223290.29379@reclus.nhh.no>
References: <2E74FF57C79A824FB51A7B057F8497172CD91295@icexch-m4.ic.ac.uk>
	<alpine.LRH.2.03.1312202223290.29379@reclus.nhh.no>
Message-ID: <2E74FF57C79A824FB51A7B057F8497172CD93995@icexch-m4.ic.ac.uk>

Roger,

Thank you so much for your reply. The problem with the weights was that I was rescaling the variables before calculating the weights matrix. As lat and long are variables in my model they too are rescaled therefore having nonsense values when it came to calculating neighbours. It is now a much sparser matrix and the model takes only seconds to run.

Fixing this also seems to have fixed the errors I was getting.

Thank you again

Emma


PhD student
Imperial College London

-----Original Message-----
From: Roger Bivand [mailto:Roger.Bivand at nhh.no] 
Sent: 20 December 2013 21:36
To: Defriez, Emma
Cc: 'r-sig-geo at r-project.org'
Subject: Re: [R-sig-Geo] Problem with singular matrix errosarlm

On Fri, 20 Dec 2013, Defriez, Emma wrote:

> Hi,
>
> I am trying to fit a spatial regression model with errorsarlm in 
> spdep, but I have been running into some problems.
>
> I can get weights style W and B to work with method LU however not S 
> or C I get the following error (traceback below): Error in 
> solve.default(-(mat), tol.solve = tol.solve) : system is 
> computationally
> singular: reciprocal condition number = 0

My guess would be that the interval= argument should be given for S and C. 
In the LU case, the interval is set to -1,0.999 internally, and for each of these cases, the spatial coefficient may be being returned outside its domain, thus leading to failure in inverting the matrix returned by the numerical Hessian. Something similar may happen with Matrix - the Cholesky method.

>
> I have rescaled the RHS variables to mean 0 and standard deviation 1. 
> I have also tried removing all but two of the RHS variables which are 
> definitely not collinear to see if that was the problem but I get the 
> same error.
>
> Each data point represents a 1by1 degree cell for the world's oceans, 
> because I am using dnearneigh points at the equator have far fewer 
> neighbours than those nearer the poles. Could this unequal number of 
> neighbours be the reason for the error?
>
> Also this model has 4647 points and takes around 50minutes to run 
> which seems like a long time do you think this is due to the number of 
> neighbours? The full data set has 31609 so I imagine this is going to 
> take an extremely long time.
>

This is almost certainly caused by your choice of distance weights - you have 52% dense matrices, so lots of operations are being done on almost dense matrices. With 4647 points, you can use the eigen method too, which would give the domain interval exactly. You seem to have a mean number of links of 2461, so something rather odd is going on. The 1by1 degree cell for the world's land areas used in Bivand, Hauke & Kossowski (Geographical Analysis, 2013) with about 15K cells doesn't cause problems, but is very sparse.

Hope this clarifies,

Roger

> Code:
>
> chl<-(chl-mean(chl,na.rm=T))/sd(chl)
> sst<-(sst-mean(sst,na.rm=T))/sd(sst)
> chlm<-(chlm-mean(chlm,na.rm=T))/sd(chlm)
> sstm<-(sstm-mean(sstm,na.rm=T))/sd(sstm)
> depth<-(depth-mean(depth,na.rm=T))/sd(depth)
> lats<-(lats-mean(lats,na.rm=T))/sd(lats)
> longs<-(longs-mean(longs,na.rm=T))/sd(longs)
>
> ols<-lm(chl~sst+depth+chlm+sstm+lats+longs)
>
> coords<-cbind(longs,lats)
> coords<-as.matrix(coords)
>
> #Define neighbourhood here max is 200km 
> nn<-dnearneigh(coords,0,200,longlat = TRUE)
>
> nn
> Neighbour list object:
> Number of regions: 4647
> Number of nonzero links: 11438816
> Percentage nonzero weights: 52.9707
> Average number of links: 2461.549
>
> #get inverse distances
> dsts <- nbdists(nn, coords)
> idw <- lapply(dsts, function(x) 1/(x))
>
> #Spatial weights
> nnweights<-nb2listw(nn, glist=idw, style='S')
>
>
> sem0_500<-errorsarlm(formula(ols), listw=nnweights,na.action=na.omit, 
> method='LU',
> +               tol.solve=1e-16, control=list(returnHcov=FALSE))
> Error in solve.default(-(mat), tol.solve = tol.solve) :
>  system is computationally singular: reciprocal condition number = 0
>
>> traceback()
> 5: solve.default(-(mat), tol.solve = tol.solve)
> 4: solve(-(mat), tol.solve = tol.solve)
> 3: solve(-(mat), tol.solve = tol.solve)
> 2: getVmate(coefs, env, s2, trs, tol.solve = tol.solve, optim = con$optimHess,
>       optimM = con$optimHessMethod)
> 1: errorsarlm(formula(ols), listw = nnweights, na.action = na.omit,
>       method = "LU", tol.solve = 1e-16, control = list(returnHcov = 
> FALSE))
>
> when I try to run it with different method I got a different error
>
>
>> sem0_500<-errorsarlm(formula(ols), listw=nnweights,na.action=na.omit, 
>> method='Matrix',
> +  tol.solve=1e-16, control=list(returnHcov=FALSE))
> Warning message: In .local(object, ...) :
>  Cholmod warning 'matrix not positive definite' at file 
> ../Supernodal/t_cholmod_super_numeric.c, line 729
>
> Error in determinant(update(nChol, nW, 1/coef)) :
>  error in evaluating the argument 'x' in selecting a method for 
> function 'determinant': Error in .local(object, ...) : CHOLMOD 
> factorization was unsuccessful
>
>> traceback()
> 8: determinant(update(nChol, nW, 1/coef))
> 7: ifelse(coef > b, n * log(coef) + (.f * c(determinant(update(nChol,
>       nW, 1/coef))$modulus)), ifelse(coef < a, n * log(-(coef)) +
>       (.f * c(determinant(update(pChol, csrw, 1/(-coef)))$modulus)),
>       0))
> 6: Matrix_ldet(coef, env, which = which)
> 5: do_ldet(lambda, env)
> 4: f(arg, ...)
> 3: (function (arg)
>   -f(arg, ...))(0.930150734356483)
> 2: optimize(sar.error.f, interval = interval, maximum = TRUE, tol = con$tol.opt,
>       env = env)
> 1: errorsarlm(formula(ols), listw = nnweights, na.action = na.omit,
>       method = "Matrix", tol.solve = 1e-16, control = list(returnHcov 
> = FALSE))
>
>> sessionInfo()
> R version 3.0.2 (2013-09-25)
> Platform: x86_64-pc-linux-gnu (64-bit)
>
> locale:
> [1] LC_CTYPE=en_GB.UTF-8       LC_NUMERIC=C
> [3] LC_TIME=en_GB.UTF-8        LC_COLLATE=en_GB.UTF-8
> [5] LC_MONETARY=en_GB.UTF-8    LC_MESSAGES=en_GB.UTF-8
> [7] LC_PAPER=en_GB.UTF-8       LC_NAME=C
> [9] LC_ADDRESS=C               LC_TELEPHONE=C
> [11] LC_MEASUREMENT=en_GB.UTF-8 LC_IDENTIFICATION=C
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] ncf_1.1-4    spdep_0.5-68 Matrix_1.1-0 sp_1.0-14
>
> loaded via a namespace (and not attached):
> [1] boot_1.3-9      coda_0.16-1     deldir_0.1-1    grid_3.0.2
> [5] lattice_0.20-24 LearnBayes_2.12 MASS_7.3-29     nlme_3.1-111
> [9] splines_3.0.2
>
> I feel I am doing something wrong when specifying the weights matrix but I can't work out what. Any help would be hugely appreciated.
>
>
> Thanks,
>
> Emma
>
> PhD student
> Imperial College London
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

--
Roger Bivand
Department of Economics, Norwegian School of Economics, Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Mon Dec 23 14:26:24 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 23 Dec 2013 14:26:24 +0100
Subject: [R-sig-Geo] a projection question
In-Reply-To: <FF9DB805FC41CC4E95825A50F680630217AF5036@challenger.uhd.campus>
References: <FF9DB805FC41CC4E95825A50F680630217AF5036@challenger.uhd.campus>
Message-ID: <alpine.LRH.2.03.1312231412160.20036@reclus.nhh.no>

On Sat, 21 Dec 2013, Hodgess, Erin wrote:

> Hello everyone:
>
> I'm setting up a function in which the user enters the projection (as 
> part of other stuff).
>
> What is the best way to determine if the entered projection is correct, 
> please? (so I can send back an error message right away).
>

Getting back to the real question, after a detour through checking the 
syntactic validity of strings submitted to PROJ.4, you may need to think 
of the semantic correctness of an apparently syntactically correct string. 
Even with CRS objects read from files on import (with for example readGDAL 
or readOGR), it happens that the metadata, including the projection are 
wrong or incomplete (they often miss the +datum= and +towgs84= tags). If 
the user enters a projection as a string directly, guidance may be needed 
to show how to check for semantic correctness.

A practical way to do this for vector objects is to define the projection 
given the user's best knowledge, spTransform() (perhaps a part) to 
"+proj=longlat +datum=WGS84", and export to KML with writeOGR. When the 
KML file is loaded into GE, one can see whether the projection string 
appears adequate, or whether more research (for example using 
http://www.asprs.org/Grids-Datums.html) is needed - maybe getting back to 
the data providers for authority if the discrepancy is large.

This is harder to do for grids, unless known ground control points are 
available, to be treated like vector data.

Hope this helps,

Roger

> Thanks,
> Erin
>
>
> 	[[alternative HTML version deleted]]

Please post plain text!

>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From juantomas.sayago at gmail.com  Mon Dec 23 21:30:42 2013
From: juantomas.sayago at gmail.com (Juan Tomas Sayago Gomez)
Date: Mon, 23 Dec 2013 15:30:42 -0500
Subject: [R-sig-Geo] sphet using two Ws in the first equation
In-Reply-To: <alpine.LRH.2.03.1312011623490.4150@reclus.nhh.no>
References: <CABW+3tAk9_6Cva2rXkgux-a2yDZmQtNCCBkD_hAtY_ZYznqzVg@mail.gmail.com>
	<alpine.LRH.2.03.1311291958540.17122@reclus.nhh.no>
	<CABW+3tCd-FjsYRb3zDpFAnEMWa=GmKsF1OGLBJbMn+r1t1QM-Q@mail.gmail.com>
	<alpine.LRH.2.03.1312011623490.4150@reclus.nhh.no>
Message-ID: <CAEOXpNCyyvut4dcrZZWnjJKNe4FMWF=c6Qo6HeXo6_nTeyOzRA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131223/46fb7880/attachment.pl>

From agus.camacho at gmail.com  Mon Dec 23 23:36:12 2013
From: agus.camacho at gmail.com (Agus Camacho)
Date: Mon, 23 Dec 2013 23:36:12 +0100
Subject: [R-sig-Geo] new error message from gbif
Message-ID: <CALsJ7pTfmUocWYOP7NY=BHxbKWLr6Nofapuo8rrwAaOKh_hr3w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131223/2973def4/attachment.pl>

From r.hijmans at gmail.com  Tue Dec 24 00:43:48 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 23 Dec 2013 15:43:48 -0800
Subject: [R-sig-Geo] new error message from gbif
In-Reply-To: <CALsJ7pTfmUocWYOP7NY=BHxbKWLr6Nofapuo8rrwAaOKh_hr3w@mail.gmail.com>
References: <CALsJ7pTfmUocWYOP7NY=BHxbKWLr6Nofapuo8rrwAaOKh_hr3w@mail.gmail.com>
Message-ID: <CANtt_hwgrVZLoUisk9FaNBJzc_0t21Uc_CV4x=mu+gvRW42Bwg@mail.gmail.com>

Agus,

If this email was meant for me, then you should not send it a mailing
list. If it was meant for the mailing list, then you should not
address it to me.

Robert

On Mon, Dec 23, 2013 at 2:36 PM, Agus Camacho <agus.camacho at gmail.com> wrote:
> Dear Robert Hijmans,
>
> I have been using the function gbif for while and had an error message I
> never saw before.
>
> sprecords=gbif(genus="Trichoglossus", species=" haematodus")
> Trichoglossus haematodus : 145597 occurrences found
> 0-1000PCDATA invalid Char value 23
> PCDATA invalid Char value 23
> Error : 1: PCDATA invalid Char value 23
> 2: PCDATA invalid Char value 23
>
> It keeps trying and trying, but nothing comes. Already asked to the gbif
> but had no answer on this.
>
> Thanks for keeping up the gbif function, its very helpful.
> Agus
> --
> Agust?n Camacho Guerrero.
> Doutor em Zoologia.
> Laborat?rio de Herpetologia, Departamento de Zoologia, Instituto de
> Bioci?ncias, USP.
> Rua do Mat?o, trav. 14, n? 321, Cidade Universit?ria,
> S?o Paulo - SP, CEP: 05508-090, Brasil.
>
>         [[alternative HTML version deleted]]
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>


From r.hijmans at gmail.com  Tue Dec 24 20:57:58 2013
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 24 Dec 2013 11:57:58 -0800
Subject: [R-sig-Geo] new error message from gbif
In-Reply-To: <CANtt_hwgrVZLoUisk9FaNBJzc_0t21Uc_CV4x=mu+gvRW42Bwg@mail.gmail.com>
References: <CALsJ7pTfmUocWYOP7NY=BHxbKWLr6Nofapuo8rrwAaOKh_hr3w@mail.gmail.com>
	<CANtt_hwgrVZLoUisk9FaNBJzc_0t21Uc_CV4x=mu+gvRW42Bwg@mail.gmail.com>
Message-ID: <CANtt_hyHua=x6tWWABWGrzkV9bHy=0Nmh0idptSLwkPRx6DEag@mail.gmail.com>

Agus,

I think this is the offending record:
http://data.gbif.org/ws/rest/occurrence/get/500956821
Firefox shows where the problem is (Chrome does not show anything; and
Internet Explorer is not helpful either).

There is an ETB (ASCII control code 23, "\027") character between '35'
and '28'  in the original longitude and in the latitude description
(this is thus bad in more than one way).

I suppose I could check each file for inappropriate ASCII codes before
the XML parsing (where the error occurs); but this is really something
that GBIF should clean up; so you were right in contacting them first.

Best,
Robert

On Mon, Dec 23, 2013 at 3:43 PM, Robert J. Hijmans <r.hijmans at gmail.com> wrote:
> Agus,
>
> If this email was meant for me, then you should not send it a mailing
> list. If it was meant for the mailing list, then you should not
> address it to me.
>
> Robert
>
> On Mon, Dec 23, 2013 at 2:36 PM, Agus Camacho <agus.camacho at gmail.com> wrote:
>> Dear Robert Hijmans,
>>
>> I have been using the function gbif for while and had an error message I
>> never saw before.
>>
>> sprecords=gbif(genus="Trichoglossus", species=" haematodus")
>> Trichoglossus haematodus : 145597 occurrences found
>> 0-1000PCDATA invalid Char value 23
>> PCDATA invalid Char value 23
>> Error : 1: PCDATA invalid Char value 23
>> 2: PCDATA invalid Char value 23
>>
>> It keeps trying and trying, but nothing comes. Already asked to the gbif
>> but had no answer on this.
>>
>> Thanks for keeping up the gbif function, its very helpful.
>> Agus
>> --
>> Agust?n Camacho Guerrero.
>> Doutor em Zoologia.
>> Laborat?rio de Herpetologia, Departamento de Zoologia, Instituto de
>> Bioci?ncias, USP.
>> Rua do Mat?o, trav. 14, n? 321, Cidade Universit?ria,
>> S?o Paulo - SP, CEP: 05508-090, Brasil.
>>
>>         [[alternative HTML version deleted]]
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>


From ldecola at comcast.net  Thu Dec 26 22:04:24 2013
From: ldecola at comcast.net (ldecola at comcast.net)
Date: Thu, 26 Dec 2013 21:04:24 +0000 (UTC)
Subject: [R-sig-Geo] a spatial bestiary?
In-Reply-To: <CALjAYt6pbSHhUqrK10-2bgUxNKu4HQ6G90EUfqjj-FBdcYRdWg@mail.gmail.com>
Message-ID: <890252853.182164.1388091864711.JavaMail.root@sz0206a.westchester.pa.mail.comcast.net>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131226/44f01efd/attachment.pl>

From 538280 at gmail.com  Thu Dec 26 23:02:46 2013
From: 538280 at gmail.com (Greg Snow)
Date: Thu, 26 Dec 2013 15:02:46 -0700
Subject: [R-sig-Geo] Creating a map with metropolitan areas
In-Reply-To: <001301ceff66$f448ec90$dcdac5b0$@gmail.com>
References: <001301ceff66$f448ec90$dcdac5b0$@gmail.com>
Message-ID: <CAFEqCdwgEZsDoe6Qm9--jg-eF=2C6uxonLh7pMEm=mcHD13p4A@mail.gmail.com>

What have you tried so far?

Do you want base graphics? lattice graphics? gglot2 graphics? or any of them?

I would probably start with the sp and maptools packages, but there
are other tools listed in the spatial task view that may help as well.

You are more likely to receive useful help if you show what you have
tried (in a way that others can copy and paste to try themselves) and
explain what you would like to be different.


On Sun, Dec 22, 2013 at 3:41 PM, Rolando Valdez <rvaldezr at gmail.com> wrote:
> Hi,
>
> I'm new in this list, and new in the R environment. I'm trying to plot a map
> with the index localization by metropolitan area.
>
> I have a .shp with states (32 obs);
>
> https://skydrive.live.com/redir?resid=C319779BEF3A0241!1369&authkey=!AGj5MTC
> l0waT_w0&v=3&ithint=photo%2c.png
>
> then, I have a .shp with municipalities (2454 obs);
>
> https://skydrive.live.com/redir?resid=C319779BEF3A0241!1370&authkey=!AFhsFOZ
> _kERbGKA&v=3&ithint=photo%2c.png
>
> then, I have the index localization by municipalities (345 municipalities)
> grouped in metropolitan areas and I need to plot something like this map:
>
> https://skydrive.live.com/redir?resid=C319779BEF3A0241!1364&authkey=!AEki9Sa
> DxCfPmy8&v=3&ithint=photo%2c.jpg
>
> I hope you can help me.
>
> Regards,
>
> Rolando
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Gregory (Greg) L. Snow Ph.D.
538280 at gmail.com


From agus.camacho at gmail.com  Fri Dec 27 10:27:09 2013
From: agus.camacho at gmail.com (Agus Camacho)
Date: Fri, 27 Dec 2013 10:27:09 +0100
Subject: [R-sig-Geo] a spatial bestiary?
In-Reply-To: <890252853.182164.1388091864711.JavaMail.root@sz0206a.westchester.pa.mail.comcast.net>
References: <CALjAYt6pbSHhUqrK10-2bgUxNKu4HQ6G90EUfqjj-FBdcYRdWg@mail.gmail.com>
	<890252853.182164.1388091864711.JavaMail.root@sz0206a.westchester.pa.mail.comcast.net>
Message-ID: <CALsJ7pT82TeZB_X_rGaahsh3Y5LvurY8MRZvOBvN1snGwRVUcQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131227/e59f6336/attachment.pl>

From rvaldezr at gmail.com  Fri Dec 27 16:00:14 2013
From: rvaldezr at gmail.com (Rolando Valdez)
Date: Fri, 27 Dec 2013 16:00:14 +0100
Subject: [R-sig-Geo] +AFs-R-sig-Geo+AF0- Creating a map with
	metropolitan areas
In-Reply-To: <CAFEqCdwgEZsDoe6Qm9--jg-eF=2C6uxonLh7pMEm=mcHD13p4A@mail.gmail.com>
References: +ADw-001301ceff66+ACQ-f448ec90+ACQ-dcdac5b0+ACQAQA-gmail.com+AD4-
	+ADw-CAFEqCdwgEZsDoe6Qm9--jg-eF+AD0-2C6uxonLh7pMEm+AD0-mcHD13p4A+AEA-mail.gmail.com+AD4-
Message-ID: <001701cf0314$59f9b500$0ded1f00$@gmail.com>

I have no tried anything, that's why I'm looking for help.

Maybe this list is too advanced for my skills in R environment, because I need to start from the begining.

My idea basicly is to merge both maps, and go painting the data by metropolitan area excluding the municipalities left.

Perhaps you can guide me with some manuals for beginners about the maptools and sp. Some examples may help also.

Thanks,

Rol+AH4-

-----Mensaje original-----
De: Greg Snow +AFs-mailto:538280+AEA-gmail.com+AF0- 
Enviado el: jueves, 26 de diciembre de 2013 11:03 p. m.
Para: Rolando Valdez
CC: r-sig-geo+AEA-r-project.org
Asunto: Re: +AFs-R-sig-Geo+AF0- Creating a map with metropolitan areas

What have you tried so far?

Do you want base graphics? lattice graphics? gglot2 graphics? or any of them?

I would probably start with the sp and maptools packages, but there are other tools listed in the spatial task view that may help as well.

You are more likely to receive useful help if you show what you have tried (in a way that others can copy and paste to try themselves) and explain what you would like to be different.


On Sun, Dec 22, 2013 at 3:41 PM, Rolando Valdez +ADw-rvaldezr+AEA-gmail.com+AD4- wrote:
+AD4- Hi,
+AD4-
+AD4- I'm new in this list, and new in the R environment. I'm trying to plot 
+AD4- a map with the index localization by metropolitan area.
+AD4-
+AD4- I have a .shp with states (32 obs)+ADs-
+AD4-
+AD4- https://skydrive.live.com/redir?resid+AD0-C319779BEF3A0241+ACE-1369+ACY-authkey+AD0AIQ-A
+AD4- Gj5MTC
+AD4- l0waT+AF8-w0+ACY-v+AD0-3+ACY-ithint+AD0-photo+ACU-2c.png
+AD4-
+AD4- then, I have a .shp with municipalities (2454 obs)+ADs-
+AD4-
+AD4- https://skydrive.live.com/redir?resid+AD0-C319779BEF3A0241+ACE-1370+ACY-authkey+AD0AIQ-A
+AD4- FhsFOZ
+AD4- +AF8-kERbGKA+ACY-v+AD0-3+ACY-ithint+AD0-photo+ACU-2c.png
+AD4-
+AD4- then, I have the index localization by municipalities (345 
+AD4- municipalities) grouped in metropolitan areas and I need to plot something like this map:
+AD4-
+AD4- https://skydrive.live.com/redir?resid+AD0-C319779BEF3A0241+ACE-1364+ACY-authkey+AD0AIQ-A
+AD4- Eki9Sa
+AD4- DxCfPmy8+ACY-v+AD0-3+ACY-ithint+AD0-photo+ACU-2c.jpg
+AD4-
+AD4- I hope you can help me.
+AD4-
+AD4- Regards,
+AD4-
+AD4- Rolando
+AD4-
+AD4- +AF8AXwBfAF8AXwBfAF8AXwBfAF8AXwBfAF8AXwBfAF8AXwBfAF8AXwBfAF8AXwBfAF8AXwBfAF8AXwBfAF8AXwBfAF8AXwBfAF8AXwBfAF8AXwBfAF8AXwBfAF8AXw-
+AD4- R-sig-Geo mailing list
+AD4- R-sig-Geo+AEA-r-project.org
+AD4- https://stat.ethz.ch/mailman/listinfo/r-sig-geo



--
Gregory (Greg) L. Snow Ph.D.
538280+AEA-gmail.com


From 538280 at gmail.com  Fri Dec 27 18:53:41 2013
From: 538280 at gmail.com (Greg Snow)
Date: Fri, 27 Dec 2013 10:53:41 -0700
Subject: [R-sig-Geo] +AFs-R-sig-Geo+AF0- Creating a map with
	metropolitan areas
In-Reply-To: <001701cf0314$59f9b500$0ded1f00$@gmail.com>
References: <CAFEqCdwgEZsDoe6Qm9--jg-eF=2C6uxonLh7pMEm=mcHD13p4A@mail.gmail.com>
	<001701cf0314$59f9b500$0ded1f00$@gmail.com>
Message-ID: <CAFEqCdyG+_R4Vkx8Wy05hZ5GhJcCaC4oAAGqGZJB5vd=O5DGOg@mail.gmail.com>

I would suggest installing both the sp and maptools packages (they
work closely together), then run the command:

vignette('combine_maptools')

This will open a pdf file with description and example code that
should at least get you started.

Or you can find the pdf file here:
http://cran.r-project.org/web/packages/maptools/vignettes/combine_maptools.pdf

if you want to look at it before installing.

The "intro_sp" and "over" vignettes in the sp package may also be of interest.

If that is not enough for you to create the plot that you want, send
us the code of what you tried and how the results differ from what you
want and we can be of more help.

On Fri, Dec 27, 2013 at 8:00 AM, Rolando Valdez <rvaldezr at gmail.com> wrote:
> I have no tried anything, that's why I'm looking for help.
>
> Maybe this list is too advanced for my skills in R environment, because I need to start from the begining.
>
> My idea basicly is to merge both maps, and go painting the data by metropolitan area excluding the municipalities left.
>
> Perhaps you can guide me with some manuals for beginners about the maptools and sp. Some examples may help also.
>
> Thanks,
>
> Rol~
>
> -----Mensaje original-----
> De: Greg Snow [mailto:538280 at gmail.com]
> Enviado el: jueves, 26 de diciembre de 2013 11:03 p. m.
> Para: Rolando Valdez
> CC: r-sig-geo at r-project.org
> Asunto: Re: [R-sig-Geo] Creating a map with metropolitan areas
>
> What have you tried so far?
>
> Do you want base graphics? lattice graphics? gglot2 graphics? or any of them?
>
> I would probably start with the sp and maptools packages, but there are other tools listed in the spatial task view that may help as well.
>
> You are more likely to receive useful help if you show what you have tried (in a way that others can copy and paste to try themselves) and explain what you would like to be different.
>
>
> On Sun, Dec 22, 2013 at 3:41 PM, Rolando Valdez <rvaldezr at gmail.com> wrote:
>> Hi,
>>
>> I'm new in this list, and new in the R environment. I'm trying to plot
>> a map with the index localization by metropolitan area.
>>
>> I have a .shp with states (32 obs);
>>
>> https://skydrive.live.com/redir?resid=C319779BEF3A0241!1369&authkey=!A
>> Gj5MTC
>> l0waT_w0&v=3&ithint=photo%2c.png
>>
>> then, I have a .shp with municipalities (2454 obs);
>>
>> https://skydrive.live.com/redir?resid=C319779BEF3A0241!1370&authkey=!A
>> FhsFOZ
>> _kERbGKA&v=3&ithint=photo%2c.png
>>
>> then, I have the index localization by municipalities (345
>> municipalities) grouped in metropolitan areas and I need to plot something like this map:
>>
>> https://skydrive.live.com/redir?resid=C319779BEF3A0241!1364&authkey=!A
>> Eki9Sa
>> DxCfPmy8&v=3&ithint=photo%2c.jpg
>>
>> I hope you can help me.
>>
>> Regards,
>>
>> Rolando
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>
> --
> Gregory (Greg) L. Snow Ph.D.
> 538280 at gmail.com
>



-- 
Gregory (Greg) L. Snow Ph.D.
538280 at gmail.com


From Roger.Bivand at nhh.no  Fri Dec 27 19:59:16 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 27 Dec 2013 19:59:16 +0100
Subject: [R-sig-Geo] +AFs-R-sig-Geo+AF0- Creating a map
 with	metropolitan areas
In-Reply-To: <001701cf0314$59f9b500$0ded1f00$@gmail.com>
References: +ADw-001301ceff66+ACQ-f448ec90+ACQ-dcdac5b0+ACQAQA-gmail.com+AD4-
	+ADw-CAFEqCdwgEZsDoe6Qm9--jg-eF+AD0-2C6uxonLh7pMEm+AD0-mcHD13p4A+AEA-mail.gmail.com+AD4-
	<001701cf0314$59f9b500$0ded1f00$@gmail.com>
Message-ID: <alpine.LRH.2.03.1312271943470.2412@reclus.nhh.no>

On Fri, 27 Dec 2013, Rolando Valdez wrote:

> I have no tried anything, that's why I'm looking for help.
>
> Maybe this list is too advanced for my skills in R environment, because 
> I need to start from the begining.
>
> My idea basicly is to merge both maps, and go painting the data by 
> metropolitan area excluding the municipalities left.
>
> Perhaps you can guide me with some manuals for beginners about the 
> maptools and sp. Some examples may help also.

In addition to Greg's constructive suggestions, you (and others) may find 
the resources at:

http://geostat-course.org/Topic_Bivand_2012

useful. There are other materials in the course to which this belongs:

http://geostat-course.org/Muenster_2012

This link shows the available recordings from M?nster in 2012 and Landau 
2011:

http://archive.org/search.php?query=GEOSTAT

with:

http://archive.org/details/GeostatIntroductionToRepresentingSpatialObjectsInR

the recording of my 2012 talk (1 1/2 hours, I'm afraid). The slides and 
accompanying materials cover much of chapters 2-5 of the second edition of 
our book (2013), so there is information around. However, as users' needs 
vary greatly, it is never easy to provide general advice that is a good 
match to specific cases.

Hope this helps,

Roger

>
> Thanks,
>
> Rol~
>
> -----Mensaje original-----
> De: Greg Snow [mailto:538280 at gmail.com]
> Enviado el: jueves, 26 de diciembre de 2013 11:03 p. m.
> Para: Rolando Valdez
> CC: r-sig-geo at r-project.org
> Asunto: Re: [R-sig-Geo] Creating a map with metropolitan areas
>
> What have you tried so far?
>
> Do you want base graphics? lattice graphics? gglot2 graphics? or any of them?
>
> I would probably start with the sp and maptools packages, but there are other tools listed in the spatial task view that may help as well.
>
> You are more likely to receive useful help if you show what you have tried (in a way that others can copy and paste to try themselves) and explain what you would like to be different.
>
>
> On Sun, Dec 22, 2013 at 3:41 PM, Rolando Valdez <rvaldezr at gmail.com> wrote:
>> Hi,
>>
>> I'm new in this list, and new in the R environment. I'm trying to plot
>> a map with the index localization by metropolitan area.
>>
>> I have a .shp with states (32 obs);
>>
>> https://skydrive.live.com/redir?resid=C319779BEF3A0241!1369&authkey=!A
>> Gj5MTC
>> l0waT_w0&v=3&ithint=photo%2c.png
>>
>> then, I have a .shp with municipalities (2454 obs);
>>
>> https://skydrive.live.com/redir?resid=C319779BEF3A0241!1370&authkey=!A
>> FhsFOZ
>> _kERbGKA&v=3&ithint=photo%2c.png
>>
>> then, I have the index localization by municipalities (345
>> municipalities) grouped in metropolitan areas and I need to plot something like this map:
>>
>> https://skydrive.live.com/redir?resid=C319779BEF3A0241!1364&authkey=!A
>> Eki9Sa
>> DxCfPmy8&v=3&ithint=photo%2c.jpg
>>
>> I hope you can help me.
>>
>> Regards,
>>
>> Rolando
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>
> --
> Gregory (Greg) L. Snow Ph.D.
> 538280 at gmail.com
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From Roger.Bivand at nhh.no  Fri Dec 27 20:09:40 2013
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 27 Dec 2013 20:09:40 +0100
Subject: [R-sig-Geo] a spatial bestiary?
In-Reply-To: <CALsJ7pT82TeZB_X_rGaahsh3Y5LvurY8MRZvOBvN1snGwRVUcQ@mail.gmail.com>
References: <CALjAYt6pbSHhUqrK10-2bgUxNKu4HQ6G90EUfqjj-FBdcYRdWg@mail.gmail.com>
	<890252853.182164.1388091864711.JavaMail.root@sz0206a.westchester.pa.mail.comcast.net>
	<CALsJ7pT82TeZB_X_rGaahsh3Y5LvurY8MRZvOBvN1snGwRVUcQ@mail.gmail.com>
Message-ID: <alpine.LRH.2.03.1312271959490.2412@reclus.nhh.no>

On Fri, 27 Dec 2013, Agus Camacho wrote:

> Many thanks for that Lee,
>
> As a student, I think would appreciate having in that script a summary of
> general strategies for extracting the values from each type of object and
> also for applying functions to them.

Please refer to the resources mentioned in:

https://stat.ethz.ch/pipermail/r-sig-geo/2013-December/020127.html

in a different thread. Because spatial data can be approached from 
different disciplinary and professional starting points, such as:

@techreport{herring11,
    author = {John R. Herring},
    title = {{OpenGIS\textregistered} Implementation Standard for 
Geographic information - Simple feature access - Part 1: Common 
architecture},
    institution = {Open Geospatial Consortium Inc.},
    number = {1.2.1, OGC 06-103r4},
    year = {2011}
}

or

@incollection{kresseetal:12,
   author = {Wolfgang Kresse and David M. Danko and Kian Fadaie},
   title = {Standardization},
   year = {2012},
   editor = {Wolfgang Kresse and David M. Danko},
   booktitle = {Springer Handbook of Geographic Information},
   publisher = {Springer},
   address = {Berlin Heidelberg},
   pages = {393--565}
}

it isn't obvious which end of the beast to examine first, tail, hoof, 
ears? At base this is a question about reference ontologies and support, 
so "a point" is very rarely just a numeric vector of length two or three, 
really. The sp classes don't even try to touch positional measurement 
error, for example, nor the data collection protocolls implicit in the 
given "position". It is hard to get the classes clear, and then methods 
require more again. The materials in the link are as far as we've got.

Roger

>
> Cheers
> Agus,
>
>
> 2013/12/26 <ldecola at comcast.net>
>
>> you can find a first cut at presenting BASE and SPATIAL objects at :
>>
>> http://ldecola.net/programs/R/bestiary.R
>>
>> i'll be using this in spatial R workshops i conduct and would appreciate
>> comments!
>>
>>
>> Lee De Cola.
>> ----- Original Message -----
>> From: "Etienne B. Racine" <etiennebr at gmail.com>
>> To: "Lee De Cola" <ldecola at comcast.net>
>> Cc: r-sig-geo at r-project.org
>> Sent: Wednesday, December 18, 2013 5:15:29 PM
>> Subject: Re: [R-sig-Geo] a spatial bestiary?
>>
>>
>>
>>
>> Lee, I share your confusion. Maybe something like a cheatsheet could help
>> ? It's not highly structured, but it present information in a different
>> way. These are two I'm aware of (I've made the last one).
>>
>> http://www.maths.lancs.ac.uk/~rowlings/Teaching/UseR2012/cheatsheet.html
>> or
>> http://www.rpubs.com/etiennebr/visualraster
>>
>> Etienne
>>
>>
>>
>>
>> 2013/12/13 < ldecola at comcast.net >
>>
>>
>>
>>
>>
>> I?ve been teaching and using R (and S-PLUS) for a couple of decades, and
>> using its spatial libraries for about half of that, but i still get
>> confused by the various ?geographically-aware? data objects that are
>> supported. Although Bivand?s Spatial.html page is quite helpful, I wonder
>> is there a ?bestiary? that outlines (perhaps in some kind of tree format?)
>> what they are, what geometries are represented, which libraries create or
>> support them, etc.?
>>
>> Lee De Cola, PhD, MCP.
>> DATA to Insight
>> LDECOLA at COMCAST.NET
>> Reston, Virginia
>> 703 709 6972
>> 571 315 0577 mobile
>>
>> [[alternative HTML version deleted]]
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>>
>>
>>
>>         [[alternative HTML version deleted]]
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From HodgessE at uhd.edu  Sat Dec 28 03:57:02 2013
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Sat, 28 Dec 2013 02:57:02 +0000
Subject: [R-sig-Geo] problems with plotting STFDF
Message-ID: <FF9DB805FC41CC4E95825A50F680630217AF6A71@challenger.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131228/ad1c2127/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Sat Dec 28 10:02:54 2013
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Sat, 28 Dec 2013 09:02:54 +0000
Subject: [R-sig-Geo] problems with plotting STFDF
In-Reply-To: <f8974a620c8c4e2d9a6757d8de52b84c@EX-1-HT0.lancs.local>
References: <f8974a620c8c4e2d9a6757d8de52b84c@EX-1-HT0.lancs.local>
Message-ID: <CANVKczMXeGCY1QZUku=_KPwoHLkRWJRas24iUJ7gA-6FCdqzMQ@mail.gmail.com>

On Sat, Dec 28, 2013 at 2:57 AM, Hodgess, Erin <HodgessE at uhd.edu> wrote:
> Hello everyone!
>
> Hope you're enjoying some holiday time!
>
> I'm running into a little snag here.  I'm working through the example on krigeST, which produces an STFDF object.  Fine so far.
>
> However, I would like to produce a Google Earth object from that.
>
> When I use plotKML, I get:
>
>> plotKML(DE_kriged,"var1.pred")
> Error in (function (classes, fdef, mtable)  :
>   unable to find an inherited method  for function ?plotKML? for signature ?"STFDF"?
>>
>
> Or when I use kml, I get:
>
>> kml(DE_kriged,"var1.pred")
> Error in (function (classes, fdef, mtable)  :
>   unable to find an inherited method for function ?kml? for signature ?"STFDF"?
>>
>
> What should I be doing, please?

 The functions are essentially saying "I don't know what to do with an
STFDF object". Is there any documentation that says these functions
can do something sensible with STFDF data? Maybe the code is yet to be
written...

Barry


From edzer.pebesma at uni-muenster.de  Sun Dec 29 16:55:56 2013
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sun, 29 Dec 2013 16:55:56 +0100
Subject: [R-sig-Geo] problems with plotting STFDF
In-Reply-To: <CANVKczMXeGCY1QZUku=_KPwoHLkRWJRas24iUJ7gA-6FCdqzMQ@mail.gmail.com>
References: <f8974a620c8c4e2d9a6757d8de52b84c@EX-1-HT0.lancs.local>
	<CANVKczMXeGCY1QZUku=_KPwoHLkRWJRas24iUJ7gA-6FCdqzMQ@mail.gmail.com>
Message-ID: <52C0460C.7010309@uni-muenster.de>



On 12/28/2013 10:02 AM, Barry Rowlingson wrote:
> On Sat, Dec 28, 2013 at 2:57 AM, Hodgess, Erin <HodgessE at uhd.edu> wrote:
>> Hello everyone!
>>
>> Hope you're enjoying some holiday time!
>>
>> I'm running into a little snag here.  I'm working through the example on krigeST, which produces an STFDF object.  Fine so far.
>>
>> However, I would like to produce a Google Earth object from that.
>>
>> When I use plotKML, I get:
>>
>>> plotKML(DE_kriged,"var1.pred")
>> Error in (function (classes, fdef, mtable)  :
>>   unable to find an inherited method  for function ?plotKML? for signature ?"STFDF"?
>>>
>>
>> Or when I use kml, I get:
>>
>>> kml(DE_kriged,"var1.pred")
>> Error in (function (classes, fdef, mtable)  :
>>   unable to find an inherited method for function ?kml? for signature ?"STFDF"?
>>>
>>
>> What should I be doing, please?
> 
>  The functions are essentially saying "I don't know what to do with an
> STFDF object". Is there any documentation that says these functions
> can do something sensible with STFDF data? Maybe the code is yet to be
> written...
> 
> Barry
>  

library(plotKML)
showMethods("plotKML")

and also ?plotKML confirm what Barry just suggested.
-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Heisenbergstra?e 2, 48149 M?nster, Germany. Phone: +49 251
83 33081 http://ifgi.uni-muenster.de GPG key ID 0xAC227795

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 555 bytes
Desc: OpenPGP digital signature
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20131229/f95543ea/attachment.bin>

From hengl at spatial-analyst.net  Sun Dec 29 19:12:25 2013
From: hengl at spatial-analyst.net (Tomislav Hengl)
Date: Sun, 29 Dec 2013 19:12:25 +0100
Subject: [R-sig-Geo] problems with plotting STFDF
In-Reply-To: <52C0460C.7010309@uni-muenster.de>
References: <f8974a620c8c4e2d9a6757d8de52b84c@EX-1-HT0.lancs.local>	<CANVKczMXeGCY1QZUku=_KPwoHLkRWJRas24iUJ7gA-6FCdqzMQ@mail.gmail.com>
	<52C0460C.7010309@uni-muenster.de>
Message-ID: <52C06609.3050102@spatial-analyst.net>


Hi Erin,

In the spacetime package there should be a function that allows you to 
coerce from STFDF to STIDF class e.g. "as.STIDF.STFDF" 
(https://r-forge.r-project.org/scm/viewvc.php/pkg/R/coerce.R?view=markup&root=spacetime 
<https://r-forge.r-project.org/scm/viewvc.php/pkg/R/coerce.R?view=markup&root=spacetime&pathrev=25>). 
Once your object is of STIDF class, then you can use "kml" function e.g. 
in a loop:

x <- as.STIDF.STFDF(x)
kml_open("x.kml")
kml_layer(x, colour="var1.pred")
kml_close("x.kml")

I might add plotting support for STFDF objects in the future. At the 
moment I do not see a special reason for this because STFDF is basically 
a 'compressed' / special case of STIDF, which hence needs to be 
'decompressed' anyway before you can write it to KML (classes in the 
spacetime package are hence more creative than in the KML, but then the 
beauty of KML is that it is rather simple while the compression is 
implemented usually through zipping / KMZ).

HTH

T. Hengl
https://www.vcard.wur.nl/Views/Profile/View.aspx?id=37263


On 29-12-2013 16:55, Edzer Pebesma wrote:
>
> On 12/28/2013 10:02 AM, Barry Rowlingson wrote:
>> On Sat, Dec 28, 2013 at 2:57 AM, Hodgess, Erin <HodgessE at uhd.edu> wrote:
>>> Hello everyone!
>>>
>>> Hope you're enjoying some holiday time!
>>>
>>> I'm running into a little snag here.  I'm working through the example on krigeST, which produces an STFDF object.  Fine so far.
>>>
>>> However, I would like to produce a Google Earth object from that.
>>>
>>> When I use plotKML, I get:
>>>
>>>> plotKML(DE_kriged,"var1.pred")
>>> Error in (function (classes, fdef, mtable)  :
>>>    unable to find an inherited method  for function ?plotKML? for signature ?"STFDF"?
>>> Or when I use kml, I get:
>>>
>>>> kml(DE_kriged,"var1.pred")
>>> Error in (function (classes, fdef, mtable)  :
>>>    unable to find an inherited method for function ?kml? for signature ?"STFDF"?
>>> What should I be doing, please?
>>   The functions are essentially saying "I don't know what to do with an
>> STFDF object". Is there any documentation that says these functions
>> can do something sensible with STFDF data? Maybe the code is yet to be
>> written...
>>
>> Barry
>>   
> library(plotKML)
> showMethods("plotKML")
>
> and also ?plotKML confirm what Barry just suggested.
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From HodgessE at uhd.edu  Sun Dec 29 19:43:19 2013
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Sun, 29 Dec 2013 18:43:19 +0000
Subject: [R-sig-Geo] problems with plotting STFDF
In-Reply-To: <52C06609.3050102@spatial-analyst.net>
References: <f8974a620c8c4e2d9a6757d8de52b84c@EX-1-HT0.lancs.local>
	<CANVKczMXeGCY1QZUku=_KPwoHLkRWJRas24iUJ7gA-6FCdqzMQ@mail.gmail.com>
	<52C0460C.7010309@uni-muenster.de>,
	<52C06609.3050102@spatial-analyst.net>
Message-ID: <FF9DB805FC41CC4E95825A50F680630217AF6E8C@challenger.uhd.campus>

I had tried x <- as(x, "STIDF")
but it didn't like that.


Thanks!

Erin

________________________________________
From: r-sig-geo-bounces at r-project.org [r-sig-geo-bounces at r-project.org] on behalf of Tomislav Hengl [hengl at spatial-analyst.net]
Sent: Sunday, December 29, 2013 12:12 PM
To: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] problems with plotting STFDF

Hi Erin,

In the spacetime package there should be a function that allows you to
coerce from STFDF to STIDF class e.g. "as.STIDF.STFDF"
(https://r-forge.r-project.org/scm/viewvc.php/pkg/R/coerce.R?view=markup&root=spacetime
<https://r-forge.r-project.org/scm/viewvc.php/pkg/R/coerce.R?view=markup&root=spacetime&pathrev=25>).
Once your object is of STIDF class, then you can use "kml" function e.g.
in a loop:

x <- as.STIDF.STFDF(x)
kml_open("x.kml")
kml_layer(x, colour="var1.pred")
kml_close("x.kml")

I might add plotting support for STFDF objects in the future. At the
moment I do not see a special reason for this because STFDF is basically
a 'compressed' / special case of STIDF, which hence needs to be
'decompressed' anyway before you can write it to KML (classes in the
spacetime package are hence more creative than in the KML, but then the
beauty of KML is that it is rather simple while the compression is
implemented usually through zipping / KMZ).

HTH

T. Hengl
https://www.vcard.wur.nl/Views/Profile/View.aspx?id=37263


On 29-12-2013 16:55, Edzer Pebesma wrote:
>
> On 12/28/2013 10:02 AM, Barry Rowlingson wrote:
>> On Sat, Dec 28, 2013 at 2:57 AM, Hodgess, Erin <HodgessE at uhd.edu> wrote:
>>> Hello everyone!
>>>
>>> Hope you're enjoying some holiday time!
>>>
>>> I'm running into a little snag here.  I'm working through the example on krigeST, which produces an STFDF object.  Fine so far.
>>>
>>> However, I would like to produce a Google Earth object from that.
>>>
>>> When I use plotKML, I get:
>>>
>>>> plotKML(DE_kriged,"var1.pred")
>>> Error in (function (classes, fdef, mtable)  :
>>>    unable to find an inherited method  for function ?plotKML? for signature ?"STFDF"?
>>> Or when I use kml, I get:
>>>
>>>> kml(DE_kriged,"var1.pred")
>>> Error in (function (classes, fdef, mtable)  :
>>>    unable to find an inherited method for function ?kml? for signature ?"STFDF"?
>>> What should I be doing, please?
>>   The functions are essentially saying "I don't know what to do with an
>> STFDF object". Is there any documentation that says these functions
>> can do something sensible with STFDF data? Maybe the code is yet to be
>> written...
>>
>> Barry
>>
> library(plotKML)
> showMethods("plotKML")
>
> and also ?plotKML confirm what Barry just suggested.
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From markpayneatwork at gmail.com  Tue Dec 31 13:09:06 2013
From: markpayneatwork at gmail.com (Mark Payne)
Date: Tue, 31 Dec 2013 13:09:06 +0100
Subject: [R-sig-Geo] Remove holes from a SpatialPolygon
Message-ID: <CAGBzUO-BTF4AcdUQ6YrjCNiy6crv8MVgne8uRv9xu0qMr=vhCA@mail.gmail.com>

Hi,

I have a SpatialPolygon that I have created through a series of
processing steps. The SP consists of one outer-boundary, with a series
of holes punched in it - think of it as the coastline of an island
with a series of lakes in it. However, I am only interested in the
"external" coastline and don't want the "lakes". How do I best remove
these holes?

Here is what I have tried so far (bufr is the object of interest)

holes <- sapply(bufr at polygons[[1]]@Polygons,slot,"hole")
bufr.hole.free <- bufr
bufr.hole.free at polygons[[1]]@Polygons <-
bufr.hole.free at polygons[[1]]@Polygons[!holes]
bufr.hole.free at polygons[[1]]@plotOrder <-
as.integer(rank(bufr.hole.free at polygons[[1]]@plotOrder[holes]))

However, this fails when I try to use it later with rgeos:

 roi.raw <- gDifference(bufr.hole.free,borders)
Error in RGEOSBinTopoFunc(spgeom1, spgeom2, byid, id, "rgeos_difference") :
  lengths of comment and Polygons slot differ


How should I remove the holes in a manner that maintains the integrity
of the SpatialPolygons class?

Mark


From ROONEYJ4 at tcd.ie  Tue Dec 31 15:55:48 2013
From: ROONEYJ4 at tcd.ie (James Rooney)
Date: Tue, 31 Dec 2013 14:55:48 +0000
Subject: [R-sig-Geo] spatial polygon - max id length
Message-ID: <75C8D19A1470D344A8AF5312F01160A602BBB78CFE35@GOMAIL.college.tcd.ie>

Hi,

I'm wondering does anyone know the maximum allowed length for the ID slot of a spatial polygons ?

I'm having some troubles I think may be caused by trying to assign slot names that are too long. Can change it of course but it would be useful to know the max length to determine how much I need to change things.

Thanks,
James

From ROONEYJ4 at tcd.ie  Tue Dec 31 16:40:17 2013
From: ROONEYJ4 at tcd.ie (James Rooney)
Date: Tue, 31 Dec 2013 15:40:17 +0000
Subject: [R-sig-Geo] Resolved -> RE: spatial polygon - max id length
In-Reply-To: <75C8D19A1470D344A8AF5312F01160A602BBB78CFE35@GOMAIL.college.tcd.ie>
References: <75C8D19A1470D344A8AF5312F01160A602BBB78CFE35@GOMAIL.college.tcd.ie>
Message-ID: <75C8D19A1470D344A8AF5312F01160A602BBB78CFE36@GOMAIL.college.tcd.ie>

Apologies!

I had a coding error and this was not the problem. It seems to accept quite long strings in fact!
For example "047041005/047041001/047041004/047041002/047041003/047319001" - is fine!

James

________________________________________
From: r-sig-geo-bounces at r-project.org [r-sig-geo-bounces at r-project.org] On Behalf Of James Rooney [ROONEYJ4 at tcd.ie]
Sent: 31 December 2013 14:55
To: r-sig-geo at r-project.org
Subject: [R-sig-Geo] spatial polygon - max id length

Hi,

I'm wondering does anyone know the maximum allowed length for the ID slot of a spatial polygons ?

I'm having some troubles I think may be caused by trying to assign slot names that are too long. Can change it of course but it would be useful to know the max length to determine how much I need to change things.

Thanks,
James
_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


