From @own@|ch@nd|m@ @end|ng |rom gm@||@com  Tue Apr  5 10:10:00 2022
From: @own@|ch@nd|m@ @end|ng |rom gm@||@com (sownal chand)
Date: Tue, 5 Apr 2022 20:10:00 +1200
Subject: [R-sig-Geo] Contour plot
In-Reply-To: <CAH5tCz28gDZycXe1WUUQwbkgZVjinKOB+uPru=CZVkLAHw8tpg@mail.gmail.com>
References: <CAH5tCz28gDZycXe1WUUQwbkgZVjinKOB+uPru=CZVkLAHw8tpg@mail.gmail.com>
Message-ID: <CAH5tCz1RJkn_EwtamRvGC2pAC323=JCC+OxyS+oGOjMefyzB_Q@mail.gmail.com>

Hello sir/madam,

I have been writing codes using R and was trying to overlay contour lines
on the map using the data set provided in the attachment. The code which I
am working on is attached below. The problem is the overlay of the contours
is not showing in the final map. If someone can assist in correcting the
codes would be really appreciated .

 # Packages
#if (!require("rspatial")) remotes::install_github('rspatial/rspatial')
library(rspatial)
library(sp)
library(rgdal)
library(rgoes)
library(raster)
library(ggplot2)

# Fiji geo data
# download
#Draft map of Fiji
world <- rnaturalearth::ne_countries(scale = "Large", returnclass = "sf")

# map of Fiji Islands
Fiji <- ggplot(data=world) +
  geom_sf() +
  coord_sf(
    crs = 3832, # https://epsg.io/3832
    xlim = c(2984265.06, 3539584.72), # limits are taken from projected
bounds
    ylim = c(-2224162.41, -1811688.88)  # of EPSG:3832
  )+ theme_bw()

#Plot map of Fiji
Fiji

#read csv data from excel file for contoure analysis
data.Fdf <- read.csv("C://Users/Sownal/Documents/data.csv")
View(data.Fdf)
class(data.Fdf)

#remove NA values in the spatial Data Frame
data.dfclean <- na.omit(data.Fdf)
data.dfclean

data.dfclean$long <- as.numeric(data$Longitude)
data.dfclean$lat <- as.numeric(data$Latitude)

# convert data to spatial data fame for spatial analysis and raster analysis
data.FSP <- SpatialPointsDataFrame(data= data.dfclean, coords =
data.dfclean$lat, data.dfclean$long)
data.FSP
#select one years data and overlay contours on the Map of Fiji

Fiji <- ggplot(data=world) +
  geom_sf() +
  coord_sf(
    crs = 3832, # https://epsg.io/3832
    xlim = c(2984265.06, 3539584.72), # limits are taken from projected
bounds
    ylim = c(-2224162.41, -1811688.88)  # of EPSG:3832
  )+ theme_bw() + filled.contour(data.dfclean$Year)


# plot the map of Fiji with the contours lines
Fiji

******************************************************************************************************

Thanking you in advance
sownalc

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20220405/31904f5b/attachment.html>

-------------- next part --------------
A non-text attachment was scrubbed...
Name: DataR.csv
Type: text/csv
Size: 628 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20220405/31904f5b/attachment.csv>

From t@v|b@r @end|ng |rom gm@||@com  Tue Apr  5 14:39:39 2022
From: t@v|b@r @end|ng |rom gm@||@com (Micha Silver)
Date: Tue, 5 Apr 2022 15:39:39 +0300
Subject: [R-sig-Geo] Contour plot
In-Reply-To: <CAH5tCz1RJkn_EwtamRvGC2pAC323=JCC+OxyS+oGOjMefyzB_Q@mail.gmail.com>
References: <CAH5tCz28gDZycXe1WUUQwbkgZVjinKOB+uPru=CZVkLAHw8tpg@mail.gmail.com>
 <CAH5tCz1RJkn_EwtamRvGC2pAC323=JCC+OxyS+oGOjMefyzB_Q@mail.gmail.com>
Message-ID: <1132483a-ff17-4c1f-a33d-9ab7b0a56119@gmail.com>

An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20220405/c6c465ca/attachment.html>

From @own@|ch@nd|m@ @end|ng |rom gm@||@com  Tue Apr  5 17:45:00 2022
From: @own@|ch@nd|m@ @end|ng |rom gm@||@com (sownal chand)
Date: Wed, 6 Apr 2022 03:45:00 +1200
Subject: [R-sig-Geo] Contour plot
In-Reply-To: <1132483a-ff17-4c1f-a33d-9ab7b0a56119@gmail.com>
References: <CAH5tCz28gDZycXe1WUUQwbkgZVjinKOB+uPru=CZVkLAHw8tpg@mail.gmail.com>
 <CAH5tCz1RJkn_EwtamRvGC2pAC323=JCC+OxyS+oGOjMefyzB_Q@mail.gmail.com>
 <1132483a-ff17-4c1f-a33d-9ab7b0a56119@gmail.com>
Message-ID: <CAH5tCz02ij4V6i-8eNn1t1=F0hH6gvAhRCnr6hJP+p3jnnn39Q@mail.gmail.com>

Thanks Micha,

I would also try out your suggestion on interpolation of data.
Kind regards
Sownal

On Wed, Apr 6, 2022, 00:39 Micha Silver <tsvibar at gmail.com> wrote:

> Hi:
>
> I would point to two issues with your code. First, we should be switching
> totally to sf. You have some spatial vectors as sf classes and some as sp.
> This should be avoided today.
>
>
> Here's my version for plotting
>
>
> library(ggplot2)
> library(sf)
> library(rnaturalearth)
>
> #Draft map of Fiji
> world <- ne_countries(returnclass = "sf")
>
> Fiji <- ne_countries(country="Fiji", returnclass="sf")
> data.Fdf <- read.csv("DataR.csv")
> # Get rid of that last summary row with no coordinates!
> data.Fdf <- data.Fdf[complete.cases(data.Fdf),]
> data.sf <- st_as_sf(data.Fdf, coords=c("long", "lat"), crs="EPSG:4326")
>
> # map of Fiji Islands
> Fiji.plot <- ggplot() +
>   geom_sf(data=world) +
>   geom_sf(data=Fiji) +
>   geom_sf(data=data.sf, aes(color=Year.1965)) +
>   coord_sf(crs = 3832, # https://epsg.io/3832
>     xlim = c(2984265.06, 3539584.72), # limits are taken from projected
> bounds
>     ylim = c(-2224162.41, -1811688.88)  # of EPSG:3832
>   ) +
>   theme_bw()
>
> #Plot map of Fiji
> Fiji.plot
>
>
> But more to your question: filled.contour() is not a ggplot2 function, so
> you cannot include it in a string of ggplot elements. filled.contour()
> takes three main variables: a sequence of 'x' and 'y' values for the grid
> on which to plot the contours, and a matrix 'z' of values from which
> contours are derived. You are working with a (very) small set of *point*
> data. No matrix of values.... Typically the 'z' matrix would be created by
> interpolating between the points to get a continuous raster, then use that
> for the 'z' parameter to filled.contour().
>
>
> Given that you are covering an area of several 100 km, with only 13 data
> points (and some are almost exactly overlapping), and much of the area is
> ocean, with no measurements and probably totally different precipitation
> behavior, I don't see any clear way to get a reliable precipitation
> distribution, so no isohyetal contour lines.
> Sorry :-(
>
>
> To continue with this, I would first deal with only the main island of
> Fiji, then do a kriging interpolation of annual rainfall, year by year, and
> from those interpolated rasters, you can derive contours. You would use the
> `contour` function from `terra` package for this.
>
>
>
>
>
>
> On 05/04/2022 11:10, sownal chand wrote:
>
>
>
>
> Hello sir/madam,
>
> I have been writing codes using R and was trying to overlay contour lines
> on the map using the data set provided in the attachment. The code which I
> am working on is attached below. The problem is the overlay of the contours
> is not showing in the final map. If someone can assist in correcting the
> codes would be really appreciated .
>
>  # Packages
> #if (!require("rspatial")) remotes::install_github('rspatial/rspatial')
> library(rspatial)
> library(sp)
> library(rgdal)
> library(rgoes)
> library(raster)
> library(ggplot2)
>
> # Fiji geo data
> # download
> #Draft map of Fiji
> world <- rnaturalearth::ne_countries(scale = "Large", returnclass = "sf")
>
> # map of Fiji Islands
> Fiji <- ggplot(data=world) +
>   geom_sf() +
>   coord_sf(
>     crs = 3832, # https://epsg.io/3832
>     xlim = c(2984265.06, 3539584.72), # limits are taken from projected
> bounds
>     ylim = c(-2224162.41, -1811688.88)  # of EPSG:3832
>   )+ theme_bw()
>
> #Plot map of Fiji
> Fiji
>
> #read csv data from excel file for contoure analysis
> data.Fdf <- read.csv("C://Users/Sownal/Documents/data.csv")
> View(data.Fdf)
> class(data.Fdf)
>
> #remove NA values in the spatial Data Frame
> data.dfclean <- na.omit(data.Fdf)
> data.dfclean
>
> data.dfclean$long <- as.numeric(data$Longitude)
> data.dfclean$lat <- as.numeric(data$Latitude)
>
> # convert data to spatial data fame for spatial analysis and raster
> analysis
> data.FSP <- SpatialPointsDataFrame(data= data.dfclean, coords =
> data.dfclean$lat, data.dfclean$long)
> data.FSP
> #select one years data and overlay contours on the Map of Fiji
>
> Fiji <- ggplot(data=world) +
>   geom_sf() +
>   coord_sf(
>     crs = 3832, # https://epsg.io/3832
>     xlim = c(2984265.06, 3539584.72), # limits are taken from projected
> bounds
>     ylim = c(-2224162.41, -1811688.88)  # of EPSG:3832
>   )+ theme_bw() + filled.contour(data.dfclean$Year)
>
>
> # plot the map of Fiji with the contours lines
> Fiji
>
>
> ******************************************************************************************************
>
> Thanking you in advance
> sownalc
>
> _______________________________________________
> R-sig-Geo mailing listR-sig-Geo at r-project.orghttps://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> --
> Micha Silver
> Ben Gurion Univ.
> Sde Boker, Remote Sensing Lab
> cell: +972-523-665918
>
>

	[[alternative HTML version deleted]]


From c||ntnko|oko@@72 @end|ng |rom gm@||@com  Wed Apr  6 12:08:27 2022
From: c||ntnko|oko@@72 @end|ng |rom gm@||@com (Clinton Nkolokosa)
Date: Wed, 6 Apr 2022 11:08:27 +0100
Subject: [R-sig-Geo] F,a,
Message-ID: <CABWyxu3mbu0Aa1=bTkbwquKzYM3iYN27vEAG_1+JnwLdx8zAjQ@mail.gmail.com>



	[[alternative HTML version deleted]]


From @w@mp @end|ng |rom b|@rg@net  Wed Apr  6 18:24:31 2022
From: @w@mp @end|ng |rom b|@rg@net (Michael Marsh)
Date: Wed, 6 Apr 2022 09:24:31 -0700
Subject: [R-sig-Geo] R-sig-Geo Digest, Vol 224, Issue 2
In-Reply-To: <mailman.28922.5.1649239202.1054.r-sig-geo@r-project.org>
References: <mailman.28922.5.1649239202.1054.r-sig-geo@r-project.org>
Message-ID: <425e6da0-2c4a-f425-cabf-81106033e8cb@blarg.net>

Those dates sound suitable to me. There should be some chicks popping up!

mike

On 4/6/2022 3:00 AM, r-sig-geo-request at r-project.org wrote:
> Send R-sig-Geo mailing list submissions to
> 	r-sig-geo at r-project.org
>
> To subscribe or unsubscribe via the World Wide Web, visit
> 	https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> or, via email, send a message with subject or body 'help' to
> 	r-sig-geo-request at r-project.org
>
> You can reach the person managing the list at
> 	r-sig-geo-owner at r-project.org
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of R-sig-Geo digest..."
>
>
> Today's Topics:
>
>     1. Re: Contour plot (Micha Silver)
>     2. Re: Contour plot (sownal chand)
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Tue, 5 Apr 2022 15:39:39 +0300
> From: Micha Silver <tsvibar at gmail.com>
> To: sownal chand <sownalchandfms at gmail.com>, r-sig-geo at r-project.org
> Subject: Re: [R-sig-Geo] Contour plot
> Message-ID: <1132483a-ff17-4c1f-a33d-9ab7b0a56119 at gmail.com>
> Content-Type: text/plain; charset="us-ascii"
>
> An HTML attachment was scrubbed...
> URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20220405/c6c465ca/attachment-0001.html>
>
>
> ------------------------------
>
> Message: 2
> Date: Wed, 6 Apr 2022 03:45:00 +1200
> From: sownal chand <sownalchandfms at gmail.com>
> To: Micha Silver <tsvibar at gmail.com>
> Cc: r-sig-geo at r-project.org
> Subject: Re: [R-sig-Geo] Contour plot
> Message-ID:
> 	<CAH5tCz02ij4V6i-8eNn1t1=F0hH6gvAhRCnr6hJP+p3jnnn39Q at mail.gmail.com>
> Content-Type: text/plain; charset="utf-8"
>
> Thanks Micha,
>
> I would also try out your suggestion on interpolation of data.
> Kind regards
> Sownal
>
> On Wed, Apr 6, 2022, 00:39 Micha Silver <tsvibar at gmail.com> wrote:
>
>> Hi:
>>
>> I would point to two issues with your code. First, we should be switching
>> totally to sf. You have some spatial vectors as sf classes and some as sp.
>> This should be avoided today.
>>
>>
>> Here's my version for plotting
>>
>>
>> library(ggplot2)
>> library(sf)
>> library(rnaturalearth)
>>
>> #Draft map of Fiji
>> world <- ne_countries(returnclass = "sf")
>>
>> Fiji <- ne_countries(country="Fiji", returnclass="sf")
>> data.Fdf <- read.csv("DataR.csv")
>> # Get rid of that last summary row with no coordinates!
>> data.Fdf <- data.Fdf[complete.cases(data.Fdf),]
>> data.sf <- st_as_sf(data.Fdf, coords=c("long", "lat"), crs="EPSG:4326")
>>
>> # map of Fiji Islands
>> Fiji.plot <- ggplot() +
>>    geom_sf(data=world) +
>>    geom_sf(data=Fiji) +
>>    geom_sf(data=data.sf, aes(color=Year.1965)) +
>>    coord_sf(crs = 3832, # https://epsg.io/3832
>>      xlim = c(2984265.06, 3539584.72), # limits are taken from projected
>> bounds
>>      ylim = c(-2224162.41, -1811688.88)  # of EPSG:3832
>>    ) +
>>    theme_bw()
>>
>> #Plot map of Fiji
>> Fiji.plot
>>
>>
>> But more to your question: filled.contour() is not a ggplot2 function, so
>> you cannot include it in a string of ggplot elements. filled.contour()
>> takes three main variables: a sequence of 'x' and 'y' values for the grid
>> on which to plot the contours, and a matrix 'z' of values from which
>> contours are derived. You are working with a (very) small set of *point*
>> data. No matrix of values.... Typically the 'z' matrix would be created by
>> interpolating between the points to get a continuous raster, then use that
>> for the 'z' parameter to filled.contour().
>>
>>
>> Given that you are covering an area of several 100 km, with only 13 data
>> points (and some are almost exactly overlapping), and much of the area is
>> ocean, with no measurements and probably totally different precipitation
>> behavior, I don't see any clear way to get a reliable precipitation
>> distribution, so no isohyetal contour lines.
>> Sorry :-(
>>
>>
>> To continue with this, I would first deal with only the main island of
>> Fiji, then do a kriging interpolation of annual rainfall, year by year, and
>> from those interpolated rasters, you can derive contours. You would use the
>> `contour` function from `terra` package for this.
>>
>>
>>
>>
>>
>>
>> On 05/04/2022 11:10, sownal chand wrote:
>>
>>
>>
>>
>> Hello sir/madam,
>>
>> I have been writing codes using R and was trying to overlay contour lines
>> on the map using the data set provided in the attachment. The code which I
>> am working on is attached below. The problem is the overlay of the contours
>> is not showing in the final map. If someone can assist in correcting the
>> codes would be really appreciated .
>>
>>   # Packages
>> #if (!require("rspatial")) remotes::install_github('rspatial/rspatial')
>> library(rspatial)
>> library(sp)
>> library(rgdal)
>> library(rgoes)
>> library(raster)
>> library(ggplot2)
>>
>> # Fiji geo data
>> # download
>> #Draft map of Fiji
>> world <- rnaturalearth::ne_countries(scale = "Large", returnclass = "sf")
>>
>> # map of Fiji Islands
>> Fiji <- ggplot(data=world) +
>>    geom_sf() +
>>    coord_sf(
>>      crs = 3832, # https://epsg.io/3832
>>      xlim = c(2984265.06, 3539584.72), # limits are taken from projected
>> bounds
>>      ylim = c(-2224162.41, -1811688.88)  # of EPSG:3832
>>    )+ theme_bw()
>>
>> #Plot map of Fiji
>> Fiji
>>
>> #read csv data from excel file for contoure analysis
>> data.Fdf <- read.csv("C://Users/Sownal/Documents/data.csv")
>> View(data.Fdf)
>> class(data.Fdf)
>>
>> #remove NA values in the spatial Data Frame
>> data.dfclean <- na.omit(data.Fdf)
>> data.dfclean
>>
>> data.dfclean$long <- as.numeric(data$Longitude)
>> data.dfclean$lat <- as.numeric(data$Latitude)
>>
>> # convert data to spatial data fame for spatial analysis and raster
>> analysis
>> data.FSP <- SpatialPointsDataFrame(data= data.dfclean, coords =
>> data.dfclean$lat, data.dfclean$long)
>> data.FSP
>> #select one years data and overlay contours on the Map of Fiji
>>
>> Fiji <- ggplot(data=world) +
>>    geom_sf() +
>>    coord_sf(
>>      crs = 3832, # https://epsg.io/3832
>>      xlim = c(2984265.06, 3539584.72), # limits are taken from projected
>> bounds
>>      ylim = c(-2224162.41, -1811688.88)  # of EPSG:3832
>>    )+ theme_bw() + filled.contour(data.dfclean$Year)
>>
>>
>> # plot the map of Fiji with the contours lines
>> Fiji
>>
>>
>> ******************************************************************************************************
>>
>> Thanking you in advance
>> sownalc
>>
>> _______________________________________________
>> R-sig-Geo mailing listR-sig-Geo at r-project.orghttps://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>> --
>> Micha Silver
>> Ben Gurion Univ.
>> Sde Boker, Remote Sensing Lab
>> cell: +972-523-665918
>>
>>
> 	[[alternative HTML version deleted]]
>
>
>
>
> ------------------------------
>
> Subject: Digest Footer
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
> ------------------------------
>
> End of R-sig-Geo Digest, Vol 224, Issue 2
> *****************************************
>


From tom@heng| @end|ng |rom gm@||@com  Fri Apr  8 12:51:42 2022
From: tom@heng| @end|ng |rom gm@||@com (Tomislav Hengl)
Date: Fri, 8 Apr 2022 12:51:42 +0200
Subject: [R-sig-Geo] Vacancies: Post-doctoral data scientist: Geocomputation
 for global environmental monitoring / 2x PhD candidates
Message-ID: <c5753856-8d0c-9e08-d3fe-5b252f237e31@gmail.com>


"Post-doctoral data scientist: Geocomputation for global environmental 
monitoring"
https://opengeohub.org/jobs/2022-post-doctoral-data-scientist-geocomputation-for-global-environmental-monitoring/

"Research assistant / PhD candidate: Geocomputation for econometric 
assessment of ecosystem services"
https://opengeohub.org/jobs/2022-research-assistant-phd-candidate-geocomputation-for-econometric-assessment-of-ecosystem-services/

"Research assistant / PhD candidate: Land Degradation & Land Potential 
modelling"
https://opengeohub.org/jobs/2022-research-assistant-phd-candidate-land-degradation-land-potential-modelling/

Application deadline: 1st of May 2022.
For more info see also: https://opengeohub.org/category/jobs/

Professional requirements include: solid knowledge of Bash, Python 
and/or R + affinity to produce highly accessible value-added datasets.

-- 
T. (Tom) Hengl
Technical director / Vice Chair
The OpenGeoHub Foundation
Visiting address: Agro Business Park 10, 6708PW Wageningen, NL
Tel: +31 (0)317 427537
Url: https://opengeohub.org/about
Twitter: https://twitter.com/opengeohub
Medium: https://opengeohub.medium.com/
https://www.youtube.com/c/OpenGeoHubFoundation
skype:tom.hengl?chat
Publications: http://scholar.google.com/citations?user=2oYU7S8AAAAJ


From tom@heng| @end|ng |rom gm@||@com  Wed Apr 13 10:51:14 2022
From: tom@heng| @end|ng |rom gm@||@com (Tomislav Hengl)
Date: Wed, 13 Apr 2022 10:51:14 +0200
Subject: [R-sig-Geo] MOOD Summer School "Analytical epidemiology,
 machine learning and disease mapping" 20-22 June 2022, Montpellier, France
Message-ID: <bbd3bc38-0fe7-262d-d4d8-350edcca476e@gmail.com>


MOOD Summer School 2022, a 3-day Summer School for PhD / post-doctoral 
researchers will take place at the Agropolis building, in Montpellier 
(France) on Monday 20th, Tuesday 21st and Wednesday 22nd June 2022.

https://mood-h2020.eu/event/mood-summer-school-2022/

Program & Topics:
The Summer School will host a series of international keynote speakers, 
including Dr Sangeeta Bhatia 
(https://www.imperial.ac.uk/people/s.bhatia), the Imperial College 
London (UK), amongst others.
Day 3 will host a use-case hackathon dedicated to Antimicrobial 
resistance data in which summer school participants will be able to 
apply newly-acquired knowledge to solve real-world issues.

Registrations:
Please register via the link above by May 1st 2022.
Please note that this event is sponsored by the Horizon-2020 MOOD 
project hence **there will be no registration fees**.
Maximum 35 spots. Waiting list will be open after maximum capacity has 
been reached.

Target communities:
Young researchers (PhD, postdoctoral researchers) interested in 
analytical epidemiology, machine learning and disease mapping, disease 
modelling, disease ecology, spatial prediction, One health, R spatial 
epidemiology community.

Technology in use:
- Zoom breakout rooms with Q&A, polls and similar;
- Mattermost channels for internal questions, screen sharing and 
markdown/code snippets;
- Computational notebooks on github.com and gitlab.com;
- Lectures will be livestreamed on the Zoom platform and published on 
TIB.AV portal (https://av.tib.eu/series/1041/mood+science+webinars) and 
on the MOOD website.

---
Valentina Delconte
Communication and PR officer
OpenGeoHub foundation
Agro Business Park 10 (unit 1.05), 6708 PW Wageningen, NL
valentina.delconte at opengeohub.org
https://opengeohub.org


From btupper @end|ng |rom b|ge|ow@org  Wed Apr 13 18:41:13 2022
From: btupper @end|ng |rom b|ge|ow@org (Ben Tupper)
Date: Wed, 13 Apr 2022 12:41:13 -0400
Subject: [R-sig-Geo] Earthdata CMR access
Message-ID: <CALrbzg0LpFwumj75XiE18UnxwL=hj88rk7hKeFX5O4BND8tiTw@mail.gmail.com>

Hello,

I am interested in accessing physical oceanography data from PO.DAAC (
https://earthdata.nasa.gov/eosdis/daacs/podaac) from within R using
opendap.  NASA is moving its data offerings to the cloud, and it is
adopting Common Metadata Repositories ("CMR",
https://cmr.earthdata.nasa.gov/search/site/docs/search/api.html) for
searching.  CMR searching is in lieu of searching THREDDS catalogs.

I'm finding the on-ramp to using CMR tricker than I had expected given the
sales pitch behind CMR (or maybe the wheels have come off my car!)  I am
wondering if anyone in this community has waded into using R-based CMR to
access cloud-based geospatial data, and, if so, might be willing to share
some insights or provide guidance?

Regards,
Ben

-- 
Ben Tupper (he/him)
Bigelow Laboratory for Ocean Science
East Boothbay, Maine
http://www.bigelow.org/
https://eco.bigelow.org

	[[alternative HTML version deleted]]


From hyok|ee @end|ng |rom hd|group@org  Wed Apr 13 19:02:57 2022
From: hyok|ee @end|ng |rom hd|group@org (Joe Lee)
Date: Wed, 13 Apr 2022 17:02:57 +0000
Subject: [R-sig-Geo] Earthdata CMR access
In-Reply-To: <CALrbzg0LpFwumj75XiE18UnxwL=hj88rk7hKeFX5O4BND8tiTw@mail.gmail.com>
References: <CALrbzg0LpFwumj75XiE18UnxwL=hj88rk7hKeFX5O4BND8tiTw@mail.gmail.com>
Message-ID: <DM6PR17MB23968DF2EAE1A592E0C23C09C2EC9@DM6PR17MB2396.namprd17.prod.outlook.com>

Hi,

I'm also interested in the solution that you're seeking 
since I've written a Python-equivalent CMR+OPeNDAP workflow a very long time ago [1].

It's both very tricky and difficult nowadays 
because NASA tries to constrain AWS egress cost via Earthdata Login authentication.

Does R provide a cURL-like library + a temporary token-based authentication?

[1] https://earthdata.nasa.gov/collaborate/open-data-services-and-software/api/opendap/gesdisc-airs-opendap-cmr


-----Original Message-----
From: R-sig-Geo <r-sig-geo-bounces at r-project.org> On Behalf Of Ben Tupper
Sent: Wednesday, April 13, 2022 11:41 AM
To: r-sig-geo <r-sig-geo at r-project.org>
Subject: [R-sig-Geo] Earthdata CMR access

Hello,

I am interested in accessing physical oceanography data from PO.DAAC (
https://earthdata.nasa.gov/eosdis/daacs/podaac) from within R using opendap.  NASA is moving its data offerings to the cloud, and it is adopting Common Metadata Repositories ("CMR",
https://cmr.earthdata.nasa.gov/search/site/docs/search/api.html) for searching.  CMR searching is in lieu of searching THREDDS catalogs.

I'm finding the on-ramp to using CMR tricker than I had expected given the sales pitch behind CMR (or maybe the wheels have come off my car!)  I am wondering if anyone in this community has waded into using R-based CMR to access cloud-based geospatial data, and, if so, might be willing to share some insights or provide guidance?

Regards,
Ben

--
Ben Tupper (he/him)
Bigelow Laboratory for Ocean Science
East Boothbay, Maine
http://www.bigelow.org/
https://eco.bigelow.org

	[[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From btupper @end|ng |rom b|ge|ow@org  Wed Apr 13 20:08:40 2022
From: btupper @end|ng |rom b|ge|ow@org (Ben Tupper)
Date: Wed, 13 Apr 2022 14:08:40 -0400
Subject: [R-sig-Geo] Earthdata CMR access
In-Reply-To: <DM6PR17MB23968DF2EAE1A592E0C23C09C2EC9@DM6PR17MB2396.namprd17.prod.outlook.com>
References: <CALrbzg0LpFwumj75XiE18UnxwL=hj88rk7hKeFX5O4BND8tiTw@mail.gmail.com>
 <DM6PR17MB23968DF2EAE1A592E0C23C09C2EC9@DM6PR17MB2396.namprd17.prod.outlook.com>
Message-ID: <CALrbzg2cWCfXcKPck2fYPiu8Ks=94CsWNhZMAw2b8sGi6y1XPw@mail.gmail.com>

Hi,

I was planning to use the httr package or the newish httr2 package
which should be able to handle the transactions.  Once a resource is
tracked down via search, I plan to use the ncdf4 package to access.

I can add headers to the http requests, so presumably that can include tokens.

But I am finding even the simple stuff like using the API to generate
a token, as shown here
https://wiki.earthdata.nasa.gov/display/EL/How+to+Generate+a+User+Token
,  to be challenging.  Thud!

Ben

httr: https://CRAN.R-project.org/package=httr
httr2: https://CRAN.R-project.org/package=httr2
ncdf4: https://CRAN.R-project.org/package=ncdf4

On Wed, Apr 13, 2022 at 1:03 PM Joe Lee <hyoklee at hdfgroup.org> wrote:
>
> Hi,
>
> I'm also interested in the solution that you're seeking
> since I've written a Python-equivalent CMR+OPeNDAP workflow a very long time ago [1].
>
> It's both very tricky and difficult nowadays
> because NASA tries to constrain AWS egress cost via Earthdata Login authentication.
>
> Does R provide a cURL-like library + a temporary token-based authentication?
>
> [1] https://earthdata.nasa.gov/collaborate/open-data-services-and-software/api/opendap/gesdisc-airs-opendap-cmr
>
>
> -----Original Message-----
> From: R-sig-Geo <r-sig-geo-bounces at r-project.org> On Behalf Of Ben Tupper
> Sent: Wednesday, April 13, 2022 11:41 AM
> To: r-sig-geo <r-sig-geo at r-project.org>
> Subject: [R-sig-Geo] Earthdata CMR access
>
> Hello,
>
> I am interested in accessing physical oceanography data from PO.DAAC (
> https://earthdata.nasa.gov/eosdis/daacs/podaac) from within R using opendap.  NASA is moving its data offerings to the cloud, and it is adopting Common Metadata Repositories ("CMR",
> https://cmr.earthdata.nasa.gov/search/site/docs/search/api.html) for searching.  CMR searching is in lieu of searching THREDDS catalogs.
>
> I'm finding the on-ramp to using CMR tricker than I had expected given the sales pitch behind CMR (or maybe the wheels have come off my car!)  I am wondering if anyone in this community has waded into using R-based CMR to access cloud-based geospatial data, and, if so, might be willing to share some insights or provide guidance?
>
> Regards,
> Ben
>
> --
> Ben Tupper (he/him)
> Bigelow Laboratory for Ocean Science
> East Boothbay, Maine
> http://www.bigelow.org/
> https://eco.bigelow.org
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Ben Tupper (he/him)
Bigelow Laboratory for Ocean Science
East Boothbay, Maine
http://www.bigelow.org/
https://eco.bigelow.org


From hyok|ee @end|ng |rom hd|group@org  Wed Apr 13 20:18:17 2022
From: hyok|ee @end|ng |rom hd|group@org (Joe Lee)
Date: Wed, 13 Apr 2022 18:18:17 +0000
Subject: [R-sig-Geo] Earthdata CMR access
In-Reply-To: <CALrbzg2cWCfXcKPck2fYPiu8Ks=94CsWNhZMAw2b8sGi6y1XPw@mail.gmail.com>
References: <CALrbzg0LpFwumj75XiE18UnxwL=hj88rk7hKeFX5O4BND8tiTw@mail.gmail.com>
 <DM6PR17MB23968DF2EAE1A592E0C23C09C2EC9@DM6PR17MB2396.namprd17.prod.outlook.com>
 <CALrbzg2cWCfXcKPck2fYPiu8Ks=94CsWNhZMAw2b8sGi6y1XPw@mail.gmail.com>
Message-ID: <DM6PR17MB2396FBD6B9292305E71520FEC2EC9@DM6PR17MB2396.namprd17.prod.outlook.com>

Yes, that's the hard part that I'm referring to.

Once you pass that step, you may also want to look at another example in MATLAB [1]
to access PODAAC data on S3 using the temporary token.

I'd really appreciate your effort if you can share a working R-code project 
that can both search with CMR and then access NASA data on S3.

Regards,

[1] https://www.hdfeos.org/zoo/PODAAC/ATM_SURFACE_TEMP_HUM_WIND_PRES_day_mean_ECCO_V4r4_nc_c.m


-----Original Message-----
From: Ben Tupper <btupper at bigelow.org> 
Sent: Wednesday, April 13, 2022 1:09 PM
To: Joe Lee <hyoklee at hdfgroup.org>
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] Earthdata CMR access

Hi,

I was planning to use the httr package or the newish httr2 package which should be able to handle the transactions.  Once a resource is tracked down via search, I plan to use the ncdf4 package to access.

I can add headers to the http requests, so presumably that can include tokens.

But I am finding even the simple stuff like using the API to generate a token, as shown here https://wiki.earthdata.nasa.gov/display/EL/How+to+Generate+a+User+Token
,  to be challenging.  Thud!

Ben

httr: https://CRAN.R-project.org/package=httr
httr2: https://CRAN.R-project.org/package=httr2
ncdf4: https://CRAN.R-project.org/package=ncdf4

On Wed, Apr 13, 2022 at 1:03 PM Joe Lee <hyoklee at hdfgroup.org> wrote:
>
> Hi,
>
> I'm also interested in the solution that you're seeking since I've 
> written a Python-equivalent CMR+OPeNDAP workflow a very long time ago [1].
>
> It's both very tricky and difficult nowadays because NASA tries to 
> constrain AWS egress cost via Earthdata Login authentication.
>
> Does R provide a cURL-like library + a temporary token-based authentication?
>
> [1] 
> https://earthdata.nasa.gov/collaborate/open-data-services-and-software
> /api/opendap/gesdisc-airs-opendap-cmr
>
>
> -----Original Message-----
> From: R-sig-Geo <r-sig-geo-bounces at r-project.org> On Behalf Of Ben 
> Tupper
> Sent: Wednesday, April 13, 2022 11:41 AM
> To: r-sig-geo <r-sig-geo at r-project.org>
> Subject: [R-sig-Geo] Earthdata CMR access
>
> Hello,
>
> I am interested in accessing physical oceanography data from PO.DAAC (
> https://earthdata.nasa.gov/eosdis/daacs/podaac) from within R using 
> opendap.  NASA is moving its data offerings to the cloud, and it is 
> adopting Common Metadata Repositories ("CMR",
> https://cmr.earthdata.nasa.gov/search/site/docs/search/api.html) for searching.  CMR searching is in lieu of searching THREDDS catalogs.
>
> I'm finding the on-ramp to using CMR tricker than I had expected given the sales pitch behind CMR (or maybe the wheels have come off my car!)  I am wondering if anyone in this community has waded into using R-based CMR to access cloud-based geospatial data, and, if so, might be willing to share some insights or provide guidance?
>
> Regards,
> Ben
>
> --
> Ben Tupper (he/him)
> Bigelow Laboratory for Ocean Science
> East Boothbay, Maine
> http://www.bigelow.org/
> https://eco.bigelow.org
>
>         [[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



--
Ben Tupper (he/him)
Bigelow Laboratory for Ocean Science
East Boothbay, Maine
http://www.bigelow.org/
https://eco.bigelow.org

From btupper @end|ng |rom b|ge|ow@org  Thu Apr 14 03:59:16 2022
From: btupper @end|ng |rom b|ge|ow@org (Ben Tupper)
Date: Wed, 13 Apr 2022 21:59:16 -0400
Subject: [R-sig-Geo] Earthdata CMR access
In-Reply-To: <DM6PR17MB2396FBD6B9292305E71520FEC2EC9@DM6PR17MB2396.namprd17.prod.outlook.com>
References: <CALrbzg0LpFwumj75XiE18UnxwL=hj88rk7hKeFX5O4BND8tiTw@mail.gmail.com>
 <DM6PR17MB23968DF2EAE1A592E0C23C09C2EC9@DM6PR17MB2396.namprd17.prod.outlook.com>
 <CALrbzg2cWCfXcKPck2fYPiu8Ks=94CsWNhZMAw2b8sGi6y1XPw@mail.gmail.com>
 <DM6PR17MB2396FBD6B9292305E71520FEC2EC9@DM6PR17MB2396.namprd17.prod.outlook.com>
Message-ID: <CALrbzg0CtYV=hSg2Z7ztF5waqweYtWA=Qu7hAJai8wvq0hCsMQ@mail.gmail.com>

What I have can search for S3 resources, but I happen to focus on OPeNDAP
instead.

As far as I can tell, the ncdf4 (and RNetCDF) packages don't provide
utilities for establishing credentialed opendap connections.  That is
handled by sort of a third party or some kind of wrapper.   Without
credentials I can search, but without credentials I cannot open a
connection to the opendap resources the search yields.

If I am understanding the error message shown at the bottom of the README
(see below), the server is receiving the request but for lack of
credentials is refusing access.  I'm stumped.

https://github.com/BigelowLab/cmr


On Wed, Apr 13, 2022 at 2:18 PM Joe Lee <hyoklee at hdfgroup.org> wrote:
>
> Yes, that's the hard part that I'm referring to.
>
> Once you pass that step, you may also want to look at another example in
MATLAB [1]
> to access PODAAC data on S3 using the temporary token.
>
> I'd really appreciate your effort if you can share a working R-code
project
> that can both search with CMR and then access NASA data on S3.
>
> Regards,
>
> [1]
https://www.hdfeos.org/zoo/PODAAC/ATM_SURFACE_TEMP_HUM_WIND_PRES_day_mean_ECCO_V4r4_nc_c.m
>
>
> -----Original Message-----
> From: Ben Tupper <btupper at bigelow.org>
> Sent: Wednesday, April 13, 2022 1:09 PM
> To: Joe Lee <hyoklee at hdfgroup.org>
> Cc: r-sig-geo at r-project.org
> Subject: Re: [R-sig-Geo] Earthdata CMR access
>
> Hi,
>
> I was planning to use the httr package or the newish httr2 package which
should be able to handle the transactions.  Once a resource is tracked down
via search, I plan to use the ncdf4 package to access.
>
> I can add headers to the http requests, so presumably that can include
tokens.
>
> But I am finding even the simple stuff like using the API to generate a
token, as shown here
https://wiki.earthdata.nasa.gov/display/EL/How+to+Generate+a+User+Token
> ,  to be challenging.  Thud!
>
> Ben
>
> httr: https://CRAN.R-project.org/package=httr
> httr2: https://CRAN.R-project.org/package=httr2
> ncdf4: https://CRAN.R-project.org/package=ncdf4
>
> On Wed, Apr 13, 2022 at 1:03 PM Joe Lee <hyoklee at hdfgroup.org> wrote:
> >
> > Hi,
> >
> > I'm also interested in the solution that you're seeking since I've
> > written a Python-equivalent CMR+OPeNDAP workflow a very long time ago
[1].
> >
> > It's both very tricky and difficult nowadays because NASA tries to
> > constrain AWS egress cost via Earthdata Login authentication.
> >
> > Does R provide a cURL-like library + a temporary token-based
authentication?
> >
> > [1]
> > https://earthdata.nasa.gov/collaborate/open-data-services-and-software
> > /api/opendap/gesdisc-airs-opendap-cmr
> >
> >
> > -----Original Message-----
> > From: R-sig-Geo <r-sig-geo-bounces at r-project.org> On Behalf Of Ben
> > Tupper
> > Sent: Wednesday, April 13, 2022 11:41 AM
> > To: r-sig-geo <r-sig-geo at r-project.org>
> > Subject: [R-sig-Geo] Earthdata CMR access
> >
> > Hello,
> >
> > I am interested in accessing physical oceanography data from PO.DAAC (
> > https://earthdata.nasa.gov/eosdis/daacs/podaac) from within R using
> > opendap.  NASA is moving its data offerings to the cloud, and it is
> > adopting Common Metadata Repositories ("CMR",
> > https://cmr.earthdata.nasa.gov/search/site/docs/search/api.html) for
searching.  CMR searching is in lieu of searching THREDDS catalogs.
> >
> > I'm finding the on-ramp to using CMR tricker than I had expected given
the sales pitch behind CMR (or maybe the wheels have come off my car!)  I
am wondering if anyone in this community has waded into using R-based CMR
to access cloud-based geospatial data, and, if so, might be willing to
share some insights or provide guidance?
> >
> > Regards,
> > Ben
> >
> > --
> > Ben Tupper (he/him)
> > Bigelow Laboratory for Ocean Science
> > East Boothbay, Maine
> > http://www.bigelow.org/
> > https://eco.bigelow.org
> >
> >         [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>
> --
> Ben Tupper (he/him)
> Bigelow Laboratory for Ocean Science
> East Boothbay, Maine
> http://www.bigelow.org/
> https://eco.bigelow.org



-- 
Ben Tupper (he/him)
Bigelow Laboratory for Ocean Science
East Boothbay, Maine
http://www.bigelow.org/
https://eco.bigelow.org
-- 
Ben Tupper Bigelow Laboratory for Ocean Sciences https://www.bigelow.org/
Tick forecast https://eco.bigelow.org/

	[[alternative HTML version deleted]]


From hyok|ee @end|ng |rom hd|group@org  Thu Apr 14 04:25:11 2022
From: hyok|ee @end|ng |rom hd|group@org (Joe Lee)
Date: Thu, 14 Apr 2022 02:25:11 +0000
Subject: [R-sig-Geo] Earthdata CMR access
In-Reply-To: <CALrbzg0CtYV=hSg2Z7ztF5waqweYtWA=Qu7hAJai8wvq0hCsMQ@mail.gmail.com>
References: <CALrbzg0LpFwumj75XiE18UnxwL=hj88rk7hKeFX5O4BND8tiTw@mail.gmail.com>
 <DM6PR17MB23968DF2EAE1A592E0C23C09C2EC9@DM6PR17MB2396.namprd17.prod.outlook.com>
 <CALrbzg2cWCfXcKPck2fYPiu8Ks=94CsWNhZMAw2b8sGi6y1XPw@mail.gmail.com>
 <DM6PR17MB2396FBD6B9292305E71520FEC2EC9@DM6PR17MB2396.namprd17.prod.outlook.com>
 <CALrbzg0CtYV=hSg2Z7ztF5waqweYtWA=Qu7hAJai8wvq0hCsMQ@mail.gmail.com>
Message-ID: <SN6PR17MB2399B4B34C8E8DF5E5728DF6C2EF9@SN6PR17MB2399.namprd17.prod.outlook.com>

Wow, what a great start!

Unlike GES DISC OPeNDAP server,
I think the PODAAC OPeNDAP server that you?d like to access
doesn?t require Earthdata Login credentials.
That eliminates a lot of complications.

My suspicion is that your R ncdf4 package is not built with OPeNDAP support.
Can you check if your R ndf4 package work with our demo OPeNDAP server [1]?
If not, you may want to install ncdf4 with your own netCDF-4 library that enabled OPeNDAP support.

Once [1] works with your R ncdf4,
I think my posting [2] can help you to redirect URLs properly
for NASA credential-enabled OPeNDAP servers.

Good luck and thanks for sharing your code on GitHub!


[1] https://eosdap.hdfgroup.org:8080/opendap/data/hdf5/grid_1_2d.h5.dmr.html
[2] https://hdfeos.org/forums/showthread.php?t=821#4


From: Ben Tupper <btupper at bigelow.org>
Sent: Wednesday, April 13, 2022 8:59 PM
To: Joe Lee <hyoklee at hdfgroup.org>
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] Earthdata CMR access

What I have can search for S3 resources, but I happen to focus on OPeNDAP instead.

As far as I can tell, the ncdf4 (and RNetCDF) packages don't provide utilities for establishing credentialed opendap connections.  That is handled by sort of a third party or some kind of wrapper.   Without credentials I can search, but without credentials I cannot open a connection to the opendap resources the search yields.

If I am understanding the error message shown at the bottom of the README (see below), the server is receiving the request but for lack of credentials is refusing access.  I'm stumped.

https://github.com/BigelowLab/cmr


On Wed, Apr 13, 2022 at 2:18 PM Joe Lee <hyoklee at hdfgroup.org<mailto:hyoklee at hdfgroup.org>> wrote:
>
> Yes, that's the hard part that I'm referring to.
>
> Once you pass that step, you may also want to look at another example in MATLAB [1]
> to access PODAAC data on S3 using the temporary token.
>
> I'd really appreciate your effort if you can share a working R-code project
> that can both search with CMR and then access NASA data on S3.
>
> Regards,
>
> [1] https://www.hdfeos.org/zoo/PODAAC/ATM_SURFACE_TEMP_HUM_WIND_PRES_day_mean_ECCO_V4r4_nc_c.m
>
>
> -----Original Message-----
> From: Ben Tupper <btupper at bigelow.org<mailto:btupper at bigelow.org>>
> Sent: Wednesday, April 13, 2022 1:09 PM
> To: Joe Lee <hyoklee at hdfgroup.org<mailto:hyoklee at hdfgroup.org>>
> Cc: r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>
> Subject: Re: [R-sig-Geo] Earthdata CMR access
>
> Hi,
>
> I was planning to use the httr package or the newish httr2 package which should be able to handle the transactions.  Once a resource is tracked down via search, I plan to use the ncdf4 package to access.
>
> I can add headers to the http requests, so presumably that can include tokens.
>
> But I am finding even the simple stuff like using the API to generate a token, as shown here https://wiki.earthdata.nasa.gov/display/EL/How+to+Generate+a+User+Token
> ,  to be challenging.  Thud!
>
> Ben
>
> httr: https://CRAN.R-project.org/package=httr
> httr2: https://CRAN.R-project.org/package=httr2
> ncdf4: https://CRAN.R-project.org/package=ncdf4
>
> On Wed, Apr 13, 2022 at 1:03 PM Joe Lee <hyoklee at hdfgroup.org<mailto:hyoklee at hdfgroup.org>> wrote:
> >
> > Hi,
> >
> > I'm also interested in the solution that you're seeking since I've
> > written a Python-equivalent CMR+OPeNDAP workflow a very long time ago [1].
> >
> > It's both very tricky and difficult nowadays because NASA tries to
> > constrain AWS egress cost via Earthdata Login authentication.
> >
> > Does R provide a cURL-like library + a temporary token-based authentication?
> >
> > [1]
> > https://earthdata.nasa.gov/collaborate/open-data-services-and-software
> > /api/opendap/gesdisc-airs-opendap-cmr
> >
> >
> > -----Original Message-----
> > From: R-sig-Geo <r-sig-geo-bounces at r-project.org<mailto:r-sig-geo-bounces at r-project.org>> On Behalf Of Ben
> > Tupper
> > Sent: Wednesday, April 13, 2022 11:41 AM
> > To: r-sig-geo <r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>>
> > Subject: [R-sig-Geo] Earthdata CMR access
> >
> > Hello,
> >
> > I am interested in accessing physical oceanography data from PO.DAAC (
> > https://earthdata.nasa.gov/eosdis/daacs/podaac) from within R using
> > opendap.  NASA is moving its data offerings to the cloud, and it is
> > adopting Common Metadata Repositories ("CMR",
> > https://cmr.earthdata.nasa.gov/search/site/docs/search/api.html) for searching.  CMR searching is in lieu of searching THREDDS catalogs.
> >
> > I'm finding the on-ramp to using CMR tricker than I had expected given the sales pitch behind CMR (or maybe the wheels have come off my car!)  I am wondering if anyone in this community has waded into using R-based CMR to access cloud-based geospatial data, and, if so, might be willing to share some insights or provide guidance?
> >
> > Regards,
> > Ben
> >
> > --
> > Ben Tupper (he/him)
> > Bigelow Laboratory for Ocean Science
> > East Boothbay, Maine
> > http://www.bigelow.org/
> > https://eco.bigelow.org
> >
> >         [[alternative HTML version deleted]]
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>
> --
> Ben Tupper (he/him)
> Bigelow Laboratory for Ocean Science
> East Boothbay, Maine
> http://www.bigelow.org/
> https://eco.bigelow.org



--
Ben Tupper (he/him)
Bigelow Laboratory for Ocean Science
East Boothbay, Maine
http://www.bigelow.org/
https://eco.bigelow.org
--
Ben Tupper Bigelow Laboratory for Ocean Sciences https://www.bigelow.org/ Tick forecast https://eco.bigelow.org/

	[[alternative HTML version deleted]]


From btupper @end|ng |rom b|ge|ow@org  Thu Apr 14 14:13:32 2022
From: btupper @end|ng |rom b|ge|ow@org (Ben Tupper)
Date: Thu, 14 Apr 2022 08:13:32 -0400
Subject: [R-sig-Geo] Earthdata CMR access
In-Reply-To: <SN6PR17MB2399B4B34C8E8DF5E5728DF6C2EF9@SN6PR17MB2399.namprd17.prod.outlook.com>
References: <CALrbzg0LpFwumj75XiE18UnxwL=hj88rk7hKeFX5O4BND8tiTw@mail.gmail.com>
 <DM6PR17MB23968DF2EAE1A592E0C23C09C2EC9@DM6PR17MB2396.namprd17.prod.outlook.com>
 <CALrbzg2cWCfXcKPck2fYPiu8Ks=94CsWNhZMAw2b8sGi6y1XPw@mail.gmail.com>
 <DM6PR17MB2396FBD6B9292305E71520FEC2EC9@DM6PR17MB2396.namprd17.prod.outlook.com>
 <CALrbzg0CtYV=hSg2Z7ztF5waqweYtWA=Qu7hAJai8wvq0hCsMQ@mail.gmail.com>
 <SN6PR17MB2399B4B34C8E8DF5E5728DF6C2EF9@SN6PR17MB2399.namprd17.prod.outlook.com>
Message-ID: <CALrbzg06hTrQ7VCNqBcMykYgOMHYx66rjG7Rr2LyKW7VajFfUw@mail.gmail.com>

Well, ncdf4 is a pretty good with OPeNDAP (which is one reason why we
love it!)  Below is an example using your handy testing resource.

Hmmm. In your example using pydap, you establish a (credentialed?)
session, and then open the OPeNDAP resource within that context?  I
don't think I have seen that before in R, at least not for OPeNDAP.
I'll poke around and see if I can find something comparable.


### Start
library(ncdf4)

url <- "https://eosdap.hdfgroup.org:8080/opendap/data/hdf5/grid_1_2d.h5"
x <- nc_open(url)
library(ncdf4)

url <- "https://eosdap.hdfgroup.org:8080/opendap/data/hdf5/grid_1_2d.h5"
x <- nc_open(url)
temp <- ncvar_get(x, varid = "temperature",
                  start = c(2,1),
                  count = c(2,3))
temp
#      [,1] [,2] [,3]
# [1,]   10   11   12
# [2,]   10   11   12
### End


On Wed, Apr 13, 2022 at 10:25 PM Joe Lee <hyoklee at hdfgroup.org> wrote:
>
> Wow, what a great start!
>
>
>
> Unlike GES DISC OPeNDAP server,
>
> I think the PODAAC OPeNDAP server that you?d like to access
>
> doesn?t require Earthdata Login credentials.
>
> That eliminates a lot of complications.
>
>
>
> My suspicion is that your R ncdf4 package is not built with OPeNDAP support.
>
> Can you check if your R ndf4 package work with our demo OPeNDAP server [1]?
>
> If not, you may want to install ncdf4 with your own netCDF-4 library that enabled OPeNDAP support.
>
>
>
> Once [1] works with your R ncdf4,
>
> I think my posting [2] can help you to redirect URLs properly
>
> for NASA credential-enabled OPeNDAP servers.
>
>
>
> Good luck and thanks for sharing your code on GitHub!
>
>
>
>
>
> [1] https://eosdap.hdfgroup.org:8080/opendap/data/hdf5/grid_1_2d.h5.dmr.html
>
> [2] https://hdfeos.org/forums/showthread.php?t=821#4
>
>
>
> From: Ben Tupper <btupper at bigelow.org>
> Sent: Wednesday, April 13, 2022 8:59 PM
> To: Joe Lee <hyoklee at hdfgroup.org>
> Cc: r-sig-geo at r-project.org
> Subject: Re: [R-sig-Geo] Earthdata CMR access
>
>
>
> What I have can search for S3 resources, but I happen to focus on OPeNDAP instead.
>
> As far as I can tell, the ncdf4 (and RNetCDF) packages don't provide utilities for establishing credentialed opendap connections.  That is handled by sort of a third party or some kind of wrapper.   Without credentials I can search, but without credentials I cannot open a connection to the opendap resources the search yields.
>
> If I am understanding the error message shown at the bottom of the README (see below), the server is receiving the request but for lack of credentials is refusing access.  I'm stumped.
>
> https://github.com/BigelowLab/cmr
>
>
>
> On Wed, Apr 13, 2022 at 2:18 PM Joe Lee <hyoklee at hdfgroup.org> wrote:
> >
> > Yes, that's the hard part that I'm referring to.
> >
> > Once you pass that step, you may also want to look at another example in MATLAB [1]
> > to access PODAAC data on S3 using the temporary token.
> >
> > I'd really appreciate your effort if you can share a working R-code project
> > that can both search with CMR and then access NASA data on S3.
> >
> > Regards,
> >
> > [1] https://www.hdfeos.org/zoo/PODAAC/ATM_SURFACE_TEMP_HUM_WIND_PRES_day_mean_ECCO_V4r4_nc_c.m
> >
> >
> > -----Original Message-----
> > From: Ben Tupper <btupper at bigelow.org>
> > Sent: Wednesday, April 13, 2022 1:09 PM
> > To: Joe Lee <hyoklee at hdfgroup.org>
> > Cc: r-sig-geo at r-project.org
> > Subject: Re: [R-sig-Geo] Earthdata CMR access
> >
> > Hi,
> >
> > I was planning to use the httr package or the newish httr2 package which should be able to handle the transactions.  Once a resource is tracked down via search, I plan to use the ncdf4 package to access.
> >
> > I can add headers to the http requests, so presumably that can include tokens.
> >
> > But I am finding even the simple stuff like using the API to generate a token, as shown here https://wiki.earthdata.nasa.gov/display/EL/How+to+Generate+a+User+Token
> > ,  to be challenging.  Thud!
> >
> > Ben
> >
> > httr: https://CRAN.R-project.org/package=httr
> > httr2: https://CRAN.R-project.org/package=httr2
> > ncdf4: https://CRAN.R-project.org/package=ncdf4
> >
> > On Wed, Apr 13, 2022 at 1:03 PM Joe Lee <hyoklee at hdfgroup.org> wrote:
> > >
> > > Hi,
> > >
> > > I'm also interested in the solution that you're seeking since I've
> > > written a Python-equivalent CMR+OPeNDAP workflow a very long time ago [1].
> > >
> > > It's both very tricky and difficult nowadays because NASA tries to
> > > constrain AWS egress cost via Earthdata Login authentication.
> > >
> > > Does R provide a cURL-like library + a temporary token-based authentication?
> > >
> > > [1]
> > > https://earthdata.nasa.gov/collaborate/open-data-services-and-software
> > > /api/opendap/gesdisc-airs-opendap-cmr
> > >
> > >
> > > -----Original Message-----
> > > From: R-sig-Geo <r-sig-geo-bounces at r-project.org> On Behalf Of Ben
> > > Tupper
> > > Sent: Wednesday, April 13, 2022 11:41 AM
> > > To: r-sig-geo <r-sig-geo at r-project.org>
> > > Subject: [R-sig-Geo] Earthdata CMR access
> > >
> > > Hello,
> > >
> > > I am interested in accessing physical oceanography data from PO.DAAC (
> > > https://earthdata.nasa.gov/eosdis/daacs/podaac) from within R using
> > > opendap.  NASA is moving its data offerings to the cloud, and it is
> > > adopting Common Metadata Repositories ("CMR",
> > > https://cmr.earthdata.nasa.gov/search/site/docs/search/api.html) for searching.  CMR searching is in lieu of searching THREDDS catalogs.
> > >
> > > I'm finding the on-ramp to using CMR tricker than I had expected given the sales pitch behind CMR (or maybe the wheels have come off my car!)  I am wondering if anyone in this community has waded into using R-based CMR to access cloud-based geospatial data, and, if so, might be willing to share some insights or provide guidance?
> > >
> > > Regards,
> > > Ben
> > >
> > > --
> > > Ben Tupper (he/him)
> > > Bigelow Laboratory for Ocean Science
> > > East Boothbay, Maine
> > > http://www.bigelow.org/
> > > https://eco.bigelow.org
> > >
> > >         [[alternative HTML version deleted]]
> > >
> > > _______________________________________________
> > > R-sig-Geo mailing list
> > > R-sig-Geo at r-project.org
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > >
> > > _______________________________________________
> > > R-sig-Geo mailing list
> > > R-sig-Geo at r-project.org
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> >
> >
> > --
> > Ben Tupper (he/him)
> > Bigelow Laboratory for Ocean Science
> > East Boothbay, Maine
> > http://www.bigelow.org/
> > https://eco.bigelow.org
>
>
>
> --
> Ben Tupper (he/him)
> Bigelow Laboratory for Ocean Science
> East Boothbay, Maine
> http://www.bigelow.org/
> https://eco.bigelow.org
>
> --
>
> Ben Tupper Bigelow Laboratory for Ocean Sciences https://www.bigelow.org/ Tick forecast https://eco.bigelow.org/



-- 
Ben Tupper (he/him)
Bigelow Laboratory for Ocean Science
East Boothbay, Maine
http://www.bigelow.org/
https://eco.bigelow.org


From hyok|ee @end|ng |rom hd|group@org  Thu Apr 14 15:04:55 2022
From: hyok|ee @end|ng |rom hd|group@org (Joe Lee)
Date: Thu, 14 Apr 2022 13:04:55 +0000
Subject: [R-sig-Geo] Earthdata CMR access
In-Reply-To: <CALrbzg06hTrQ7VCNqBcMykYgOMHYx66rjG7Rr2LyKW7VajFfUw@mail.gmail.com>
References: <CALrbzg0LpFwumj75XiE18UnxwL=hj88rk7hKeFX5O4BND8tiTw@mail.gmail.com>
 <DM6PR17MB23968DF2EAE1A592E0C23C09C2EC9@DM6PR17MB2396.namprd17.prod.outlook.com>
 <CALrbzg2cWCfXcKPck2fYPiu8Ks=94CsWNhZMAw2b8sGi6y1XPw@mail.gmail.com>
 <DM6PR17MB2396FBD6B9292305E71520FEC2EC9@DM6PR17MB2396.namprd17.prod.outlook.com>
 <CALrbzg0CtYV=hSg2Z7ztF5waqweYtWA=Qu7hAJai8wvq0hCsMQ@mail.gmail.com>
 <SN6PR17MB2399B4B34C8E8DF5E5728DF6C2EF9@SN6PR17MB2399.namprd17.prod.outlook.com>
 <CALrbzg06hTrQ7VCNqBcMykYgOMHYx66rjG7Rr2LyKW7VajFfUw@mail.gmail.com>
Message-ID: <DM6PR17MB2396481D16543CB59B0F4999C2EF9@DM6PR17MB2396.namprd17.prod.outlook.com>

Yes, you need to set context with session.
I could confirm that PO.DAAC OPeNDAP server requires session.
Thus, R ncdf4 package needs to do something extra like pydap example does.

-----Original Message-----
From: Ben Tupper <btupper at bigelow.org> 
Sent: Thursday, April 14, 2022 7:14 AM
To: Joe Lee <hyoklee at hdfgroup.org>
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] Earthdata CMR access

Well, ncdf4 is a pretty good with OPeNDAP (which is one reason why we love it!)  Below is an example using your handy testing resource.

Hmmm. In your example using pydap, you establish a (credentialed?) session, and then open the OPeNDAP resource within that context?  I don't think I have seen that before in R, at least not for OPeNDAP.
I'll poke around and see if I can find something comparable.


### Start
library(ncdf4)

url <- "https://eosdap.hdfgroup.org:8080/opendap/data/hdf5/grid_1_2d.h5"
x <- nc_open(url)
library(ncdf4)

url <- "https://eosdap.hdfgroup.org:8080/opendap/data/hdf5/grid_1_2d.h5"
x <- nc_open(url)
temp <- ncvar_get(x, varid = "temperature",
                  start = c(2,1),
                  count = c(2,3))
temp
#      [,1] [,2] [,3]
# [1,]   10   11   12
# [2,]   10   11   12
### End


On Wed, Apr 13, 2022 at 10:25 PM Joe Lee <hyoklee at hdfgroup.org> wrote:
>
> Wow, what a great start!
>
>
>
> Unlike GES DISC OPeNDAP server,
>
> I think the PODAAC OPeNDAP server that you?d like to access
>
> doesn?t require Earthdata Login credentials.
>
> That eliminates a lot of complications.
>
>
>
> My suspicion is that your R ncdf4 package is not built with OPeNDAP support.
>
> Can you check if your R ndf4 package work with our demo OPeNDAP server [1]?
>
> If not, you may want to install ncdf4 with your own netCDF-4 library that enabled OPeNDAP support.
>
>
>
> Once [1] works with your R ncdf4,
>
> I think my posting [2] can help you to redirect URLs properly
>
> for NASA credential-enabled OPeNDAP servers.
>
>
>
> Good luck and thanks for sharing your code on GitHub!
>
>
>
>
>
> [1] 
> https://eosdap.hdfgroup.org:8080/opendap/data/hdf5/grid_1_2d.h5.dmr.ht
> ml
>
> [2] https://hdfeos.org/forums/showthread.php?t=821#4
>
>
>
> From: Ben Tupper <btupper at bigelow.org>
> Sent: Wednesday, April 13, 2022 8:59 PM
> To: Joe Lee <hyoklee at hdfgroup.org>
> Cc: r-sig-geo at r-project.org
> Subject: Re: [R-sig-Geo] Earthdata CMR access
>
>
>
> What I have can search for S3 resources, but I happen to focus on OPeNDAP instead.
>
> As far as I can tell, the ncdf4 (and RNetCDF) packages don't provide utilities for establishing credentialed opendap connections.  That is handled by sort of a third party or some kind of wrapper.   Without credentials I can search, but without credentials I cannot open a connection to the opendap resources the search yields.
>
> If I am understanding the error message shown at the bottom of the README (see below), the server is receiving the request but for lack of credentials is refusing access.  I'm stumped.
>
> https://github.com/BigelowLab/cmr
>
>
>
> On Wed, Apr 13, 2022 at 2:18 PM Joe Lee <hyoklee at hdfgroup.org> wrote:
> >
> > Yes, that's the hard part that I'm referring to.
> >
> > Once you pass that step, you may also want to look at another 
> > example in MATLAB [1] to access PODAAC data on S3 using the temporary token.
> >
> > I'd really appreciate your effort if you can share a working R-code 
> > project that can both search with CMR and then access NASA data on S3.
> >
> > Regards,
> >
> > [1] 
> > https://www.hdfeos.org/zoo/PODAAC/ATM_SURFACE_TEMP_HUM_WIND_PRES_day
> > _mean_ECCO_V4r4_nc_c.m
> >
> >
> > -----Original Message-----
> > From: Ben Tupper <btupper at bigelow.org>
> > Sent: Wednesday, April 13, 2022 1:09 PM
> > To: Joe Lee <hyoklee at hdfgroup.org>
> > Cc: r-sig-geo at r-project.org
> > Subject: Re: [R-sig-Geo] Earthdata CMR access
> >
> > Hi,
> >
> > I was planning to use the httr package or the newish httr2 package which should be able to handle the transactions.  Once a resource is tracked down via search, I plan to use the ncdf4 package to access.
> >
> > I can add headers to the http requests, so presumably that can include tokens.
> >
> > But I am finding even the simple stuff like using the API to 
> > generate a token, as shown here 
> > https://wiki.earthdata.nasa.gov/display/EL/How+to+Generate+a+User+To
> > ken
> > ,  to be challenging.  Thud!
> >
> > Ben
> >
> > httr: https://CRAN.R-project.org/package=httr
> > httr2: https://CRAN.R-project.org/package=httr2
> > ncdf4: https://CRAN.R-project.org/package=ncdf4
> >
> > On Wed, Apr 13, 2022 at 1:03 PM Joe Lee <hyoklee at hdfgroup.org> wrote:
> > >
> > > Hi,
> > >
> > > I'm also interested in the solution that you're seeking since I've 
> > > written a Python-equivalent CMR+OPeNDAP workflow a very long time ago [1].
> > >
> > > It's both very tricky and difficult nowadays because NASA tries to 
> > > constrain AWS egress cost via Earthdata Login authentication.
> > >
> > > Does R provide a cURL-like library + a temporary token-based authentication?
> > >
> > > [1]
> > > https://earthdata.nasa.gov/collaborate/open-data-services-and-soft
> > > ware /api/opendap/gesdisc-airs-opendap-cmr
> > >
> > >
> > > -----Original Message-----
> > > From: R-sig-Geo <r-sig-geo-bounces at r-project.org> On Behalf Of Ben 
> > > Tupper
> > > Sent: Wednesday, April 13, 2022 11:41 AM
> > > To: r-sig-geo <r-sig-geo at r-project.org>
> > > Subject: [R-sig-Geo] Earthdata CMR access
> > >
> > > Hello,
> > >
> > > I am interested in accessing physical oceanography data from 
> > > PO.DAAC (
> > > https://earthdata.nasa.gov/eosdis/daacs/podaac) from within R 
> > > using opendap.  NASA is moving its data offerings to the cloud, 
> > > and it is adopting Common Metadata Repositories ("CMR",
> > > https://cmr.earthdata.nasa.gov/search/site/docs/search/api.html) for searching.  CMR searching is in lieu of searching THREDDS catalogs.
> > >
> > > I'm finding the on-ramp to using CMR tricker than I had expected given the sales pitch behind CMR (or maybe the wheels have come off my car!)  I am wondering if anyone in this community has waded into using R-based CMR to access cloud-based geospatial data, and, if so, might be willing to share some insights or provide guidance?
> > >
> > > Regards,
> > > Ben
> > >
> > > --
> > > Ben Tupper (he/him)
> > > Bigelow Laboratory for Ocean Science East Boothbay, Maine 
> > > http://www.bigelow.org/ https://eco.bigelow.org
> > >
> > >         [[alternative HTML version deleted]]
> > >
> > > _______________________________________________
> > > R-sig-Geo mailing list
> > > R-sig-Geo at r-project.org
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > >
> > > _______________________________________________
> > > R-sig-Geo mailing list
> > > R-sig-Geo at r-project.org
> > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
> >
> >
> > --
> > Ben Tupper (he/him)
> > Bigelow Laboratory for Ocean Science East Boothbay, Maine 
> > http://www.bigelow.org/ https://eco.bigelow.org
>
>
>
> --
> Ben Tupper (he/him)
> Bigelow Laboratory for Ocean Science
> East Boothbay, Maine
> http://www.bigelow.org/
> https://eco.bigelow.org
>
> --
>
> Ben Tupper Bigelow Laboratory for Ocean Sciences 
> https://www.bigelow.org/ Tick forecast https://eco.bigelow.org/



--
Ben Tupper (he/him)
Bigelow Laboratory for Ocean Science
East Boothbay, Maine
http://www.bigelow.org/
https://eco.bigelow.org

From btupper @end|ng |rom b|ge|ow@org  Thu Apr 14 15:13:37 2022
From: btupper @end|ng |rom b|ge|ow@org (Ben Tupper)
Date: Thu, 14 Apr 2022 09:13:37 -0400
Subject: [R-sig-Geo] Earthdata CMR access
In-Reply-To: <DM6PR17MB2396481D16543CB59B0F4999C2EF9@DM6PR17MB2396.namprd17.prod.outlook.com>
References: <CALrbzg0LpFwumj75XiE18UnxwL=hj88rk7hKeFX5O4BND8tiTw@mail.gmail.com>
 <DM6PR17MB23968DF2EAE1A592E0C23C09C2EC9@DM6PR17MB2396.namprd17.prod.outlook.com>
 <CALrbzg2cWCfXcKPck2fYPiu8Ks=94CsWNhZMAw2b8sGi6y1XPw@mail.gmail.com>
 <DM6PR17MB2396FBD6B9292305E71520FEC2EC9@DM6PR17MB2396.namprd17.prod.outlook.com>
 <CALrbzg0CtYV=hSg2Z7ztF5waqweYtWA=Qu7hAJai8wvq0hCsMQ@mail.gmail.com>
 <SN6PR17MB2399B4B34C8E8DF5E5728DF6C2EF9@SN6PR17MB2399.namprd17.prod.outlook.com>
 <CALrbzg06hTrQ7VCNqBcMykYgOMHYx66rjG7Rr2LyKW7VajFfUw@mail.gmail.com>
 <DM6PR17MB2396481D16543CB59B0F4999C2EF9@DM6PR17MB2396.namprd17.prod.outlook.com>
Message-ID: <CALrbzg3uNvKvKgZ+c+1mCbzigO2DmPrp+Fx+1VSzqn02nvo2CA@mail.gmail.com>

OK - this is very helpful, Joe.  I'll report back on what I learn.

On Thu, Apr 14, 2022 at 9:05 AM Joe Lee <hyoklee at hdfgroup.org> wrote:
>
> Yes, you need to set context with session.
> I could confirm that PO.DAAC OPeNDAP server requires session.
> Thus, R ncdf4 package needs to do something extra like pydap example does.
>
> -----Original Message-----
> From: Ben Tupper <btupper at bigelow.org>
> Sent: Thursday, April 14, 2022 7:14 AM
> To: Joe Lee <hyoklee at hdfgroup.org>
> Cc: r-sig-geo at r-project.org
> Subject: Re: [R-sig-Geo] Earthdata CMR access
>
> Well, ncdf4 is a pretty good with OPeNDAP (which is one reason why we love it!)  Below is an example using your handy testing resource.
>
> Hmmm. In your example using pydap, you establish a (credentialed?) session, and then open the OPeNDAP resource within that context?  I don't think I have seen that before in R, at least not for OPeNDAP.
> I'll poke around and see if I can find something comparable.
>
>
> ### Start
> library(ncdf4)
>
> url <- "https://eosdap.hdfgroup.org:8080/opendap/data/hdf5/grid_1_2d.h5"
> x <- nc_open(url)
> library(ncdf4)
>
> url <- "https://eosdap.hdfgroup.org:8080/opendap/data/hdf5/grid_1_2d.h5"
> x <- nc_open(url)
> temp <- ncvar_get(x, varid = "temperature",
>                   start = c(2,1),
>                   count = c(2,3))
> temp
> #      [,1] [,2] [,3]
> # [1,]   10   11   12
> # [2,]   10   11   12
> ### End
>
>
> On Wed, Apr 13, 2022 at 10:25 PM Joe Lee <hyoklee at hdfgroup.org> wrote:
> >
> > Wow, what a great start!
> >
> >
> >
> > Unlike GES DISC OPeNDAP server,
> >
> > I think the PODAAC OPeNDAP server that you?d like to access
> >
> > doesn?t require Earthdata Login credentials.
> >
> > That eliminates a lot of complications.
> >
> >
> >
> > My suspicion is that your R ncdf4 package is not built with OPeNDAP support.
> >
> > Can you check if your R ndf4 package work with our demo OPeNDAP server [1]?
> >
> > If not, you may want to install ncdf4 with your own netCDF-4 library that enabled OPeNDAP support.
> >
> >
> >
> > Once [1] works with your R ncdf4,
> >
> > I think my posting [2] can help you to redirect URLs properly
> >
> > for NASA credential-enabled OPeNDAP servers.
> >
> >
> >
> > Good luck and thanks for sharing your code on GitHub!
> >
> >
> >
> >
> >
> > [1]
> > https://eosdap.hdfgroup.org:8080/opendap/data/hdf5/grid_1_2d.h5.dmr.ht
> > ml
> >
> > [2] https://hdfeos.org/forums/showthread.php?t=821#4
> >
> >
> >
> > From: Ben Tupper <btupper at bigelow.org>
> > Sent: Wednesday, April 13, 2022 8:59 PM
> > To: Joe Lee <hyoklee at hdfgroup.org>
> > Cc: r-sig-geo at r-project.org
> > Subject: Re: [R-sig-Geo] Earthdata CMR access
> >
> >
> >
> > What I have can search for S3 resources, but I happen to focus on OPeNDAP instead.
> >
> > As far as I can tell, the ncdf4 (and RNetCDF) packages don't provide utilities for establishing credentialed opendap connections.  That is handled by sort of a third party or some kind of wrapper.   Without credentials I can search, but without credentials I cannot open a connection to the opendap resources the search yields.
> >
> > If I am understanding the error message shown at the bottom of the README (see below), the server is receiving the request but for lack of credentials is refusing access.  I'm stumped.
> >
> > https://github.com/BigelowLab/cmr
> >
> >
> >
> > On Wed, Apr 13, 2022 at 2:18 PM Joe Lee <hyoklee at hdfgroup.org> wrote:
> > >
> > > Yes, that's the hard part that I'm referring to.
> > >
> > > Once you pass that step, you may also want to look at another
> > > example in MATLAB [1] to access PODAAC data on S3 using the temporary token.
> > >
> > > I'd really appreciate your effort if you can share a working R-code
> > > project that can both search with CMR and then access NASA data on S3.
> > >
> > > Regards,
> > >
> > > [1]
> > > https://www.hdfeos.org/zoo/PODAAC/ATM_SURFACE_TEMP_HUM_WIND_PRES_day
> > > _mean_ECCO_V4r4_nc_c.m
> > >
> > >
> > > -----Original Message-----
> > > From: Ben Tupper <btupper at bigelow.org>
> > > Sent: Wednesday, April 13, 2022 1:09 PM
> > > To: Joe Lee <hyoklee at hdfgroup.org>
> > > Cc: r-sig-geo at r-project.org
> > > Subject: Re: [R-sig-Geo] Earthdata CMR access
> > >
> > > Hi,
> > >
> > > I was planning to use the httr package or the newish httr2 package which should be able to handle the transactions.  Once a resource is tracked down via search, I plan to use the ncdf4 package to access.
> > >
> > > I can add headers to the http requests, so presumably that can include tokens.
> > >
> > > But I am finding even the simple stuff like using the API to
> > > generate a token, as shown here
> > > https://wiki.earthdata.nasa.gov/display/EL/How+to+Generate+a+User+To
> > > ken
> > > ,  to be challenging.  Thud!
> > >
> > > Ben
> > >
> > > httr: https://CRAN.R-project.org/package=httr
> > > httr2: https://CRAN.R-project.org/package=httr2
> > > ncdf4: https://CRAN.R-project.org/package=ncdf4
> > >
> > > On Wed, Apr 13, 2022 at 1:03 PM Joe Lee <hyoklee at hdfgroup.org> wrote:
> > > >
> > > > Hi,
> > > >
> > > > I'm also interested in the solution that you're seeking since I've
> > > > written a Python-equivalent CMR+OPeNDAP workflow a very long time ago [1].
> > > >
> > > > It's both very tricky and difficult nowadays because NASA tries to
> > > > constrain AWS egress cost via Earthdata Login authentication.
> > > >
> > > > Does R provide a cURL-like library + a temporary token-based authentication?
> > > >
> > > > [1]
> > > > https://earthdata.nasa.gov/collaborate/open-data-services-and-soft
> > > > ware /api/opendap/gesdisc-airs-opendap-cmr
> > > >
> > > >
> > > > -----Original Message-----
> > > > From: R-sig-Geo <r-sig-geo-bounces at r-project.org> On Behalf Of Ben
> > > > Tupper
> > > > Sent: Wednesday, April 13, 2022 11:41 AM
> > > > To: r-sig-geo <r-sig-geo at r-project.org>
> > > > Subject: [R-sig-Geo] Earthdata CMR access
> > > >
> > > > Hello,
> > > >
> > > > I am interested in accessing physical oceanography data from
> > > > PO.DAAC (
> > > > https://earthdata.nasa.gov/eosdis/daacs/podaac) from within R
> > > > using opendap.  NASA is moving its data offerings to the cloud,
> > > > and it is adopting Common Metadata Repositories ("CMR",
> > > > https://cmr.earthdata.nasa.gov/search/site/docs/search/api.html) for searching.  CMR searching is in lieu of searching THREDDS catalogs.
> > > >
> > > > I'm finding the on-ramp to using CMR tricker than I had expected given the sales pitch behind CMR (or maybe the wheels have come off my car!)  I am wondering if anyone in this community has waded into using R-based CMR to access cloud-based geospatial data, and, if so, might be willing to share some insights or provide guidance?
> > > >
> > > > Regards,
> > > > Ben
> > > >
> > > > --
> > > > Ben Tupper (he/him)
> > > > Bigelow Laboratory for Ocean Science East Boothbay, Maine
> > > > http://www.bigelow.org/ https://eco.bigelow.org
> > > >
> > > >         [[alternative HTML version deleted]]
> > > >
> > > > _______________________________________________
> > > > R-sig-Geo mailing list
> > > > R-sig-Geo at r-project.org
> > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > > >
> > > > _______________________________________________
> > > > R-sig-Geo mailing list
> > > > R-sig-Geo at r-project.org
> > > > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> > >
> > >
> > >
> > > --
> > > Ben Tupper (he/him)
> > > Bigelow Laboratory for Ocean Science East Boothbay, Maine
> > > http://www.bigelow.org/ https://eco.bigelow.org
> >
> >
> >
> > --
> > Ben Tupper (he/him)
> > Bigelow Laboratory for Ocean Science
> > East Boothbay, Maine
> > http://www.bigelow.org/
> > https://eco.bigelow.org
> >
> > --
> >
> > Ben Tupper Bigelow Laboratory for Ocean Sciences
> > https://www.bigelow.org/ Tick forecast https://eco.bigelow.org/
>
>
>
> --
> Ben Tupper (he/him)
> Bigelow Laboratory for Ocean Science
> East Boothbay, Maine
> http://www.bigelow.org/
> https://eco.bigelow.org



-- 
Ben Tupper (he/him)
Bigelow Laboratory for Ocean Science
East Boothbay, Maine
http://www.bigelow.org/
https://eco.bigelow.org


From b@row||ng@on @end|ng |rom gm@||@com  Fri Apr 15 18:11:33 2022
From: b@row||ng@on @end|ng |rom gm@||@com (Barry Rowlingson)
Date: Fri, 15 Apr 2022 17:11:33 +0100
Subject: [R-sig-Geo] Inconsistent null geometry handling in sf and terra
Message-ID: <CANVKczM0jEXUtihNmBbJfKK1OO6M2XJ--p8GOO+WedQqr1hNtA@mail.gmail.com>

The `sf` package returns the extent of a null geometry as "NA", wheras
terra's `vect` returns an object with an extent of (-180,180, -90,+90).
`sf` also prints a warning.

This came from a gis stack Q:
https://gis.stackexchange.com/questions/428925/sfst-read-and-terravect-reading-in-different-extents-from-the-same-shape/428983?noredirect=1#comment699839_428983
which has link to sample data and code.

There's a few questions remaining which might be worth discussing here
before deciding if any package needs an issue/bugfix:

1. what does the SF standard say about the extent of a Null geometric
feature?
2. what does the SF standard say about the extent of a collection of
features, if one of them is Null? The `sf` package returns the extent of
the non-null features, but there's maybe an argument for saying "if I don't
know the extent of feature 23, I don't know the extent of any data frame
with feature 23 in it" (by analogy with NA+1+2+3 => NA)
3. should warnings be printed when null geometries occur (terra::vect
doesn't do this, st_read does).


Barry

	[[alternative HTML version deleted]]


From edzer@pebe@m@ @end|ng |rom un|-muen@ter@de  Sun Apr 17 11:09:28 2022
From: edzer@pebe@m@ @end|ng |rom un|-muen@ter@de (Edzer Pebesma)
Date: Sun, 17 Apr 2022 11:09:28 +0200
Subject: [R-sig-Geo] Inconsistent null geometry handling in sf and terra
In-Reply-To: <CANVKczM0jEXUtihNmBbJfKK1OO6M2XJ--p8GOO+WedQqr1hNtA@mail.gmail.com>
References: <CANVKczM0jEXUtihNmBbJfKK1OO6M2XJ--p8GOO+WedQqr1hNtA@mail.gmail.com>
Message-ID: <ae4edf22-bb59-9e44-36e5-feda882804ec@uni-muenster.de>



On 15/04/2022 18:11, Barry Rowlingson wrote:
> The `sf` package returns the extent of a null geometry as "NA", wheras
> terra's `vect` returns an object with an extent of (-180,180, -90,+90).
> `sf` also prints a warning.
> 
> This came from a gis stack Q:
> https://gis.stackexchange.com/questions/428925/sfst-read-and-terravect-reading-in-different-extents-from-the-same-shape/428983?noredirect=1#comment699839_428983
> which has link to sample data and code.
> 
> There's a few questions remaining which might be worth discussing here
> before deciding if any package needs an issue/bugfix:
> 
> 1. what does the SF standard say about the extent of a Null geometric
> feature?

"simple feature access" doesn't mention extent at all, neither as an 
operation, nor as a property.

> 2. what does the SF standard say about the extent of a collection of
> features, if one of them is Null? The `sf` package returns the extent of
> the non-null features, but there's maybe an argument for saying "if I don't
> know the extent of feature 23, I don't know the extent of any data frame
> with feature 23 in it" (by analogy with NA+1+2+3 => NA)

it doesn't say anything about properties of sets of geometries either. 
The empty geometry however is intended (as far as I understand) as the 
"no points for which" geometry, resulting for instance from the 
intersection operation on two non-intersecting geometries. It then makes 
sense, IMO, to discard it for extends; if you would propagate it like an 
NA in arithmetic ops, it would have to mean something like "a point that 
can have any coordinates" (exists, don't know where), which is not intended.

> 3. should warnings be printed when null geometries occur (terra::vect
> doesn't do this, st_read does).

You mean upon reading - I think sf prints it in the summary header, but 
does it warn?

> 
> 
> Barry
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48151 Muenster, Germany
Phone: +49 251 8333081


From g|u@eppe@@m@tu||| @end|ng |rom gm@||@com  Sun Apr 17 18:40:17 2022
From: g|u@eppe@@m@tu||| @end|ng |rom gm@||@com (Giuseppe Amatulli)
Date: Sun, 17 Apr 2022 18:40:17 +0200
Subject: [R-sig-Geo] mlr3spatial
Message-ID: <CAKoiDH+1miaAQtL2-7WXv50c6Xf81JaF6a2tFDmMD54D5E=7Lw@mail.gmail.com>

Hi,
I'm trying to apply a supervised regression following the example at
https://mlr3spatial.mlr-org.com/articles/mlr3spatial.html
In my case the response variable is a presence-absence (0/1) raster file
with many NA values

task = as_task_regr
<https://mlr3.mlr-org.com/reference/as_task_regr.html>(backend, target
= "presence-absence")

print <https://rdrr.io/r/base/print.html>(task)#> <TaskRegr:backend>
(122848 x 6)#> * Target: presence-absence#> * Properties: -#> *
Features (5):#>   - dbl (5): band2, band3, band4, band5, band6

At this point I need to extract the row_ids where
presence-absence != NA
in order to fill the

learner$train(task, row_ids = row_ids)

I have tried to search for an example but I could not find one.
Can anyone help me?
Thanks
-- 
Giuseppe Amatulli, Ph.D.

Research scientist at
School of the Environment
Yale University
New Haven, CT, USA - 06511
Twitter: @BigDataEcology
Teaching: http://spatial-ecology.net
Work:  https://environment.yale.edu/profile/giuseppe-amatulli/

	[[alternative HTML version deleted]]


From jgreenberg @end|ng |rom unr@edu  Thu Apr 21 17:30:46 2022
From: jgreenberg @end|ng |rom unr@edu (Jonathan Greenberg)
Date: Thu, 21 Apr 2022 08:30:46 -0700
Subject: [R-sig-Geo] gdalUtils future...
Message-ID: <CABG0rftt79ba2KgCagr8xg616ceqq4u_EH=qFt5TQm5uvMviBA@mail.gmail.com>

Hi all -- I know some of you have used gdalUtils in the past and some
r-sig-geo packages have dependencies on it.  At present, I do not plan to
continue support for the package myself, but I would be thrilled if someone
might be interested in stepping up to take it over.  If anyone is
interested, please shoot me an email at this address and we can arrange a
time to speak.

Here's the github repo:

https://github.com/cran/gdalUtils

--j

-- 
Jonathan A. Greenberg, PhD
Randall Endowed Professor and Associate Professor of Remote Sensing
Global Environmental Analysis and Remote Sensing (GEARS) Laboratory
Natural Resources & Environmental Science
University of Nevada, Reno
1664 N Virginia St MS 0186
Reno, NV 89557
Phone: 415-763-5476
Web: https://gearslab.org/
Twitter: @GearsLaboratory <https://twitter.com/GearsLaboratory>

	[[alternative HTML version deleted]]


From m@rt|n@hu|eny| @end|ng |rom gm@||@com  Wed Apr 27 12:11:58 2022
From: m@rt|n@hu|eny| @end|ng |rom gm@||@com (Martin Hulenyi)
Date: Wed, 27 Apr 2022 12:11:58 +0200
Subject: [R-sig-Geo] 2SLS in spatial panel model
Message-ID: <379e25bf-0b6f-7760-1db6-f94e84b3dd3d@gmail.com>

Dear all,

I would like to ask if there is a package that allows to implement 2SLS 
in spatial panel setting (we have an endogenous independent variable we 
want to instrument). If not, do you know if it is possible to implement 
it in other software?

Best,

Martin


From Roger@B|v@nd @end|ng |rom nhh@no  Wed Apr 27 12:22:26 2022
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Wed, 27 Apr 2022 12:22:26 +0200 (CEST)
Subject: [R-sig-Geo] 2SLS in spatial panel model
In-Reply-To: <379e25bf-0b6f-7760-1db6-f94e84b3dd3d@gmail.com>
References: <379e25bf-0b6f-7760-1db6-f94e84b3dd3d@gmail.com>
Message-ID: <6474350-bc3b-e71f-c869-c7e142293e25@reclus2.nhh.no>

Do you mean:

splm::spgm(..., endog=, instruments=, lag=TRUE, spatial.error=FALSE)

as in section 4.5 of https://doi.org/10.3390/math9111276 ?

Roger

On Wed, 27 Apr 2022, Martin Hulenyi wrote:

> Dear all,
>
> I would like to ask if there is a package that allows to implement 2SLS in 
> spatial panel setting (we have an endogenous independent variable we want to 
> instrument). If not, do you know if it is possible to implement it in other 
> software?
>
> Best,
>
> Martin
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://eur02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-geo&amp;data=05%7C01%7CRoger.Bivand%40nhh.no%7C324563e1a9bf48c8cea908da28366dc6%7C33a15b2f849941998d56f20b5aa91af2%7C0%7C0%7C637866511629822477%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C2000%7C%7C%7C&amp;sdata=%2Fcdcyurmp5cIHoA3q99Sa0i2x1uA9jEtiE0KRZKQTKo%3D&amp;reserved=0
>

-- 
Roger Bivand
Emeritus Professor
Department of Economics, Norwegian School of Economics,
Postboks 3490 Ytre Sandviken, 5045 Bergen, Norway.
e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From m@rt|n@hu|eny| @end|ng |rom gm@||@com  Wed Apr 27 13:47:56 2022
From: m@rt|n@hu|eny| @end|ng |rom gm@||@com (Martin Hulenyi)
Date: Wed, 27 Apr 2022 13:47:56 +0200
Subject: [R-sig-Geo] 2SLS in spatial panel model
In-Reply-To: <6474350-bc3b-e71f-c869-c7e142293e25@reclus2.nhh.no>
References: <379e25bf-0b6f-7760-1db6-f94e84b3dd3d@gmail.com>
 <6474350-bc3b-e71f-c869-c7e142293e25@reclus2.nhh.no>
Message-ID: <ee4ab66b-07df-d740-cc45-0b89b4729d5c@gmail.com>

Thanks!

Is there also possibility to show the first stage results?

Best,

Martin

On 27. 4. 2022 12:22, Roger Bivand wrote:
> Do you mean:
>
> splm::spgm(..., endog=, instruments=, lag=TRUE, spatial.error=FALSE)
>
> as in section 4.5 of https://doi.org/10.3390/math9111276 ?
>
> Roger
>
> On Wed, 27 Apr 2022, Martin Hulenyi wrote:
>
>> Dear all,
>>
>> I would like to ask if there is a package that allows to implement 
>> 2SLS in spatial panel setting (we have an endogenous independent 
>> variable we want to instrument). If not, do you know if it is 
>> possible to implement it in other software?
>>
>> Best,
>>
>> Martin
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://eur02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-geo&amp;data=05%7C01%7CRoger.Bivand%40nhh.no%7C324563e1a9bf48c8cea908da28366dc6%7C33a15b2f849941998d56f20b5aa91af2%7C0%7C0%7C637866511629822477%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C2000%7C%7C%7C&amp;sdata=%2Fcdcyurmp5cIHoA3q99Sa0i2x1uA9jEtiE0KRZKQTKo%3D&amp;reserved=0 
>>
>>
>


From Roger@B|v@nd @end|ng |rom nhh@no  Wed Apr 27 17:50:23 2022
From: Roger@B|v@nd @end|ng |rom nhh@no (Roger Bivand)
Date: Wed, 27 Apr 2022 17:50:23 +0200 (CEST)
Subject: [R-sig-Geo] 2SLS in spatial panel model
In-Reply-To: <ee4ab66b-07df-d740-cc45-0b89b4729d5c@gmail.com>
References: <379e25bf-0b6f-7760-1db6-f94e84b3dd3d@gmail.com>
 <6474350-bc3b-e71f-c869-c7e142293e25@reclus2.nhh.no>
 <ee4ab66b-07df-d740-cc45-0b89b4729d5c@gmail.com>
Message-ID: <7712fda8-82aa-1386-59d3-8ad91f2659c@reclus2.nhh.no>

Yes, but you need to use debug(splm::spgm), then debug() functions as 
chosen in that wrapper from (probably) ivsplm. It may lead from there to 
one of several other functions depending on choices made in your 
arguments - like "fixed", or implied by those choices.

Either assign a copy of the object you need to the global environment 
using <<-, or use saveRDS() to save a copy of the object you need to file 
for access later.

You'll need several attempts to see where to add debug() calls as you move 
towards finding what you need.

Hope this helps,

Roger


On Wed, 27 Apr 2022, Martin Hulenyi wrote:

> Thanks!
>
> Is there also possibility to show the first stage results?
>
> Best,
>
> Martin
>
> On 27. 4. 2022 12:22, Roger Bivand wrote:
>>  Do you mean:
>>
>>  splm::spgm(..., endog=, instruments=, lag=TRUE, spatial.error=FALSE)
>>
>>  as in section 4.5 of
>>  https://eur02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fdoi.org%2F10.3390%2Fmath9111276&amp;data=05%7C01%7CRoger.Bivand%40nhh.no%7C090d6f14635c4b0fe46208da2843c824%7C33a15b2f849941998d56f20b5aa91af2%7C0%7C0%7C637866568955957593%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=5GqzsmTWUIwGm12R3DiegUlsK7Kk8dfpWZq5i0r5BiQ%3D&amp;reserved=0
>>  ?
>>
>>  Roger
>>
>>  On Wed, 27 Apr 2022, Martin Hulenyi wrote:
>>
>>>  Dear all,
>>>
>>>  I would like to ask if there is a package that allows to implement 2SLS
>>>  in spatial panel setting (we have an endogenous independent variable we
>>>  want to instrument). If not, do you know if it is possible to implement
>>>  it in other software?
>>>
>>>  Best,
>>>
>>>  Martin
>>>
>>>  _______________________________________________
>>>  R-sig-Geo mailing list
>>>  R-sig-Geo at r-project.org
>>>  https://eur02.safelinks.protection.outlook.com/?url=https%3A%2F%2Fstat.ethz.ch%2Fmailman%2Flistinfo%2Fr-sig-geo&amp;data=05%7C01%7CRoger.Bivand%40nhh.no%7C090d6f14635c4b0fe46208da2843c824%7C33a15b2f849941998d56f20b5aa91af2%7C0%7C0%7C637866568955957593%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=rjcKTVqfSw%2Bixr4Luph0bqoh6aTnCMgPvC2Q6lDPxRs%3D&amp;reserved=0 
>>> 
>>> 
>> 
>

-- 
Roger Bivand
Emeritus Professor
Department of Economics, Norwegian School of Economics,
Postboks 3490 Ytre Sandviken, 5045 Bergen, Norway.
e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en


From ger@rd@heuve||nk @end|ng |rom wur@n|  Wed Apr 27 21:29:14 2022
From: ger@rd@heuve||nk @end|ng |rom wur@n| (Heuvelink, Gerard)
Date: Wed, 27 Apr 2022 19:29:14 +0000
Subject: [R-sig-Geo] cokriging simulation
Message-ID: <AM9PR01MB834739FDA48AA000494AD334E4FA9@AM9PR01MB8347.eurprd01.prod.exchangelabs.com>

Dear List,

We wish to create simulations from a cokriging model. I used to be able to do that in the past, but now I am struggling to get the correlations preserved. I dimplified the problem to a simple case with cross-correlation 0.8 (see script below), but simulations show no correlation at all. What do I do wrong? Thank you for your help, Gerard

library(gstat)
set.seed(12345)

d <- data.frame(0,0,0,0)
names(d) <- c("x","y","lmCres","lmNres")
coordinates(d) = ~x+y

nugC <- 1; nugN <- 1; nugCN <- 0.8
psillC <- 5; psillN <- 5; psillCN <- 4
range <- 10

g_l <- gstat(id=c("lmCres"),formula=lmCres~1,data=d,beta=0,nmax=100,
             model=vgm(psillC,"Sph",range=10,nugC))
g_l <- gstat(g_l,id="lmNres",formula=lmNres~1,data=d,beta=0,nmax=100,
             model=vgm(psillN,"Sph",range=10,nugN))
g_l <- gstat(g_l,id=c("lmCres","lmNres"),model=vgm(psillCN,"Sph",range=10,nugCN))

df <- data.frame(x=1,y=1)
coordinates(df) <- ~x+y

nsim <- 250
sim <- predict(g_l,df,nsim=nsim)
simdf <- as.data.frame(sim)

plot(as.numeric(simdf[1,3:(nsim+2)]),as.numeric(simdf[1,(nsim+3):((2*nsim)+2)]))
cor(as.numeric(simdf[1,3:(nsim+2)]),as.numeric(simdf[1,(nsim+3):((2*nsim)+2)]))

	[[alternative HTML version deleted]]


From edzer@pebe@m@ @end|ng |rom un|-muen@ter@de  Fri Apr 29 17:35:48 2022
From: edzer@pebe@m@ @end|ng |rom un|-muen@ter@de (Edzer Pebesma)
Date: Fri, 29 Apr 2022 17:35:48 +0200
Subject: [R-sig-Geo] cokriging simulation
In-Reply-To: <AM9PR01MB834739FDA48AA000494AD334E4FA9@AM9PR01MB8347.eurprd01.prod.exchangelabs.com>
References: <AM9PR01MB834739FDA48AA000494AD334E4FA9@AM9PR01MB8347.eurprd01.prod.exchangelabs.com>
Message-ID: <48c45571-e625-526a-5442-14db30348af7@uni-muenster.de>

Thanks Gerard, that has now been fixed in
https://github.com/r-spatial/gstat/issues/106

The problem was probably introduced in 2016 when I swapped out the 
shipped matrix library with R's native one. The two differed in how a 
Choleski decomposition was returned .

On 27/04/2022 21:29, Heuvelink, Gerard wrote:
> Dear List,
> 
> We wish to create simulations from a cokriging model. I used to be able to do that in the past, but now I am struggling to get the correlations preserved. I dimplified the problem to a simple case with cross-correlation 0.8 (see script below), but simulations show no correlation at all. What do I do wrong? Thank you for your help, Gerard
> 
> library(gstat)
> set.seed(12345)
> 
> d <- data.frame(0,0,0,0)
> names(d) <- c("x","y","lmCres","lmNres")
> coordinates(d) = ~x+y
> 
> nugC <- 1; nugN <- 1; nugCN <- 0.8
> psillC <- 5; psillN <- 5; psillCN <- 4
> range <- 10
> 
> g_l <- gstat(id=c("lmCres"),formula=lmCres~1,data=d,beta=0,nmax=100,
>               model=vgm(psillC,"Sph",range=10,nugC))
> g_l <- gstat(g_l,id="lmNres",formula=lmNres~1,data=d,beta=0,nmax=100,
>               model=vgm(psillN,"Sph",range=10,nugN))
> g_l <- gstat(g_l,id=c("lmCres","lmNres"),model=vgm(psillCN,"Sph",range=10,nugCN))
> 
> df <- data.frame(x=1,y=1)
> coordinates(df) <- ~x+y
> 
> nsim <- 250
> sim <- predict(g_l,df,nsim=nsim)
> simdf <- as.data.frame(sim)
> 
> plot(as.numeric(simdf[1,3:(nsim+2)]),as.numeric(simdf[1,(nsim+3):((2*nsim)+2)]))
> cor(as.numeric(simdf[1,3:(nsim+2)]),as.numeric(simdf[1,(nsim+3):((2*nsim)+2)]))
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48151 Muenster, Germany
Phone: +49 251 8333081


From tom@heng| @end|ng |rom gm@||@com  Fri Apr 29 19:51:51 2022
From: tom@heng| @end|ng |rom gm@||@com (Tomislav Hengl)
Date: Fri, 29 Apr 2022 19:51:51 +0200
Subject: [R-sig-Geo] =?utf-8?q?Summer_School_2022_=E2=80=9COpen_Source_so?=
 =?utf-8?q?lutions_for_Earth_system_data_=28R=2C_OSGeo=2C_Python=29?=
 =?utf-8?q?=E2=80=9D_Friendly_City_Hotel_Siegburg_=28close_to_Bonn=29_28?=
 =?utf-8?b?LjA4LuKAkzAzLjA5Lg==?=
Message-ID: <ce7eae76-98ab-df3a-574a-e25e7961c08d@gmail.com>


Registrations for the Summer School 2022 "Open Source solutions for 
Earth system data (R, OSGeo, Python)" Friendly City Hotel Siegburg 
(close to Bonn) 28.08.?03.09. are now open!

https://opengeohub.org/summer-school/siegburg-2022/

Learn #rspatial, Python and Julia from the leading devs and applied 
researchers. Organized jointly with 52?North GmbH. Watch interesting 
benchmarkings comparing spatial and spatiotemporal analysis in R, OSGeo, 
Pyton and Julia.

The Summer School will include:
- Live presentations and demos by leading R and OSGeo developers;
- 5 days of Earth System Analysis training sessions and R / OSGeo tutorials;
- Including 1 day of R-Spatial workshops;
- Including 1 focus day "extreme events";
- Discussion panels and break-out rooms.

Lecturers / blocks (unsorted):

- Martin Schultz (Forschungszentrum J?lich GmbH Institute for Advanced 
Simulation (IAS) J?lich Supercomputing Centre (JSC) [KISTE-Projekt]) 
"Machine learning for weather, air quality and climate";
- Ribana Roscher (Remote Sensing Group Institute of Geodesy and 
Geoinformation (IGG), University of Bonn [KISTE-Projekt]) "Explainable ML";
- Markus Konkol (Post-doctoral researcher, 52?North Spatial Information 
Research GmbH) "Open Reproducible Research (R tutorial)";
- Patrick Schratz (mlr-org core team at cynkra) "Spatial modeling using 
mlr3 (R tutorial)";
- Christian Autermann (Research Software Engineer, 52?North Spatial 
Information Research GmbH) "GeoNode as Research Data Infrastructure";
- Markus Abel (Ambrosys GmbH [KISTE-Projekt]) "Stochastic processes, 
analysis, examples (Python tutorial)";
-  Jakub Nowosad (Assistant Professor, Adam Mickiewicz University) 
"Geocomputation with R's guide to reproducible spatial data analysis (R 
tutorial)";
- Leandro Parente (Post-doctoral researcher, OpenGeoHub) "Accessing and 
using data cubes: spatial overlay, visualization and modeling (R and 
Python tutorial)";
- Krzystof Dyba (Adam Mickiewicz University) "Cross-language 
benchmarking: R, Python, Julia";
- Martijn Visser & Maarten Pronk (Deltares) "JuliaGeo: a gentle 
introduction";
- Edzer Pebesma (Professor IfGI, University of Muenster) "R-spatial 
updates: sf, sftime, stars (R tutorial)";
- Martin Fleischmann (Research Associate in the Geographic Data Science 
Lab at the University of Liverpool) "Geo-pandas";
-  Tim Appelhans (Director of Data Science - Meter Group) "Visualization 
cloud-optimized (large) datasets in R (R tutorial)";

This Summer School is a not-for-profit event and can be followed online. 
The cost-recovery registration fees are (full price): 625 EUR. Reduced 
price: 475 EUR for full-time students / ODA-recipient country.

Registration deadline: May 28th 2022.

-- 
T. (Tom) Hengl
Technical director / Vice Chair
The OpenGeoHub Foundation
Visiting address: Agro Business Park 10, 6708PW Wageningen, NL
Tel: +31 (0)317 427537
Url: https://opengeohub.org/about
Twitter: https://twitter.com/opengeohub
Medium: https://opengeohub.medium.com/
https://www.youtube.com/c/OpenGeoHubFoundation
skype:tom.hengl?chat
Publications: http://scholar.google.com/citations?user=2oYU7S8AAAAJ


