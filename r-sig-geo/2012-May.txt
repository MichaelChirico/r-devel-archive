From megotte at gmail.com  Tue May  1 01:21:23 2012
From: megotte at gmail.com (Megan Marcotte)
Date: Mon, 30 Apr 2012 16:21:23 -0700 (PDT)
Subject: [R-sig-Geo] trouble importing a .img file from ArcMap 10
Message-ID: <1335828083349-7515387.post@n2.nabble.com>

Hello,

This is a rather low level question but I'd appreciate your help. I have
given a colleague .img files from ArcMap 10 to import into R. I don't know R
and she is new to ArcMap files and we are having trouble getting the files
in. I was hoping some of you could set us straight on what we are doing
wrong.

When I look in ArcMap the file works well and contains data. There are 5
source files for the raster in ArcMap but only the .img, .img.vat.dbf, and
.rrd files were attachable by email (so I did not send a disc image file or
a lock file).

My colleague has install RGDAL and GDAL (and other packages) and tried
importing using functions raster and readGDAL to import the .img file, but
gets the following errors:

> Elev <- raster("file_name.img")
Error in .rasterObjectFromFile(x, band = band, objecttype = "RasterLayer", 
: 
  Cannot create a RasterLayer object from this file.

> Elev <- readGDAL("file_name.img")

Error in .local(.Object, ...) : 
  Unable to open file_name.img, it has zero usable bands.

(http://science.nature.nps.gov/im/monitor/stats/R/Data_io.cfm provided
instructions)

We would like to get the file successfully imported and have R know that the
coordinates are in WGS84. Can anyone please advise us on how to accomplish
this?

The file is in .img format  because I converted the coordinate system in
ArcMap. If importing it in its native coordinate system and then converting
to WGS84 in R is easier than I would gratefully accept help on that instead.

Thanks so much!
Megan

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/trouble-importing-a-img-file-from-ArcMap-10-tp7515387.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From ashton at msu.edu  Tue May  1 02:09:42 2012
From: ashton at msu.edu (Ashton Shortridge)
Date: Tue, 1 May 2012 08:09:42 +0800
Subject: [R-sig-Geo] trouble importing a .img file from ArcMap 10
In-Reply-To: <1335828083349-7515387.post@n2.nabble.com>
References: <1335828083349-7515387.post@n2.nabble.com>
Message-ID: <201205010809.42916.ashton@msu.edu>

Hi Megan,

I'm not an expert on img files, but as a workaround could you simply load the 
image into ArcMap and then export it as a geotiff? That's the format I 
generally use.

You can also do these format conversions using the GDAL command line 
utilities, and via the GDAL plugin in Quantum GIS.


On Tuesday, May 01, 2012 07:21:23 AM Megan Marcotte wrote:
> Hello,
> 
> This is a rather low level question but I'd appreciate your help. I have
> given a colleague .img files from ArcMap 10 to import into R. I don't know
> R and she is new to ArcMap files and we are having trouble getting the
> files in. I was hoping some of you could set us straight on what we are
> doing wrong.
> 
> When I look in ArcMap the file works well and contains data. There are 5
> source files for the raster in ArcMap but only the .img, .img.vat.dbf, and
> .rrd files were attachable by email (so I did not send a disc image file or
> a lock file).
> 
> My colleague has install RGDAL and GDAL (and other packages) and tried
> importing using functions raster and readGDAL to import the .img file, but
> 
> gets the following errors:
> > Elev <- raster("file_name.img")
> 
> Error in .rasterObjectFromFile(x, band = band, objecttype = "RasterLayer",
> 
>   Cannot create a RasterLayer object from this file.
> 
> > Elev <- readGDAL("file_name.img")
> 
> Error in .local(.Object, ...) :
>   Unable to open file_name.img, it has zero usable bands.
> 
> (http://science.nature.nps.gov/im/monitor/stats/R/Data_io.cfm provided
> instructions)
> 
> We would like to get the file successfully imported and have R know that
> the coordinates are in WGS84. Can anyone please advise us on how to
> accomplish this?
> 
> The file is in .img format  because I converted the coordinate system in
> ArcMap. If importing it in its native coordinate system and then converting
> to WGS84 in R is easier than I would gratefully accept help on that
> instead.
> 
> Thanks so much!
> Megan
> 
> --
> View this message in context:
> http://r-sig-geo.2731867.n2.nabble.com/trouble-importing-a-img-file-from-A
> rcMap-10-tp7515387.html Sent from the R-sig-geo mailing list archive at
> Nabble.com.
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 

Ashton Shortridge
Associate Professor
Dept. of Geography
Michigan State University
http://www.msu.edu/~ashton


From thi_veloso at yahoo.com.br  Tue May  1 04:45:56 2012
From: thi_veloso at yahoo.com.br (Thiago Veloso)
Date: Mon, 30 Apr 2012 19:45:56 -0700
Subject: [R-sig-Geo] Best approach to process massive ammounts of MODIS data
Message-ID: <1335840356.46700.YahooMailClassic@web161404.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120430/cc9070dd/attachment.pl>

From thi_veloso at yahoo.com.br  Tue May  1 05:17:01 2012
From: thi_veloso at yahoo.com.br (Thiago Veloso)
Date: Mon, 30 Apr 2012 20:17:01 -0700 (PDT)
Subject: [R-sig-Geo] Best approach to process a massive ammount of MODIS data
Message-ID: <1335842221.80807.YahooMailClassic@web161404.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120430/c60666cf/attachment.pl>

From moshersteven at gmail.com  Tue May  1 05:24:59 2012
From: moshersteven at gmail.com (steven mosher)
Date: Mon, 30 Apr 2012 20:24:59 -0700
Subject: [R-sig-Geo] Cropping a set of points with a polygon
Message-ID: <CAFFLneTFPY7uJ=JVAft2o5OzBG_HTJJoWNprZ3CY3dgJ9qusiA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120430/4fe8cb6f/attachment.pl>

From samanmonfared1 at gmail.com  Tue May  1 10:01:30 2012
From: samanmonfared1 at gmail.com (Saman Monfared)
Date: Tue, 1 May 2012 12:31:30 +0430
Subject: [R-sig-Geo] help in CompRandFld package
Message-ID: <CAOytA4b-o9ocsd0Mghdpdi7umnBmOPsRCfgQA7Zsnmi1m7eukA@mail.gmail.com>

Dear All.
I Try to use CompRandFld package for Spatio-temporal modeling of Irish
wind data.
I write Irish wind data in txt format. I calculate times in days
((year*365)+(month*30)+day)
and saved in a coloumn with name times. I want fit a spatio-temporal
covariance  like gneiting
model.

A part of My program is :


rm(list=ls())
library(CompRandFld)
library(RandomFields)
dd<-read.table("wind.txt",header=T)
names(dd)
x <- dd$x
y <- dd$y
mean <- mean(dd$values)
sill <- 1
nugget <- 0
scale <- 3
set.seed(331)
# Define the temporal sequence:
times <- seq(1,10,1)
# Simulation of a spatio-temporal Gaussian random field:
data <- RFsim(x, y, times, corrmodel="gneiting",
param=list(mean=mean,scale_s=3,scale_t=3,sill=sill,
nugget=0,power_s=1,power_t=1,sep=0.2))$data
************************************************
Error in chol.default(varcov) :
  the leading minor of order 11 is not positive definite.

Please help me.


-- 

Saman Monfared
Msc Student,
Department of Statistics, Shiraz University,
Shiraz 71454, Iran
Email: Samanmonfared1 at gmail.com

Tel: +98 917 5305167


From mas.cyrille2 at wanadoo.fr  Tue May  1 10:42:23 2012
From: mas.cyrille2 at wanadoo.fr (mas.cyrille2)
Date: Tue, 1 May 2012 10:42:23 +0200 (CEST)
Subject: [R-sig-Geo] Doughnut Chart ou Multi-level Pie Chart
Message-ID: <1270034531.64988.1335861743146.JavaMail.www@wwinf1k10>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120501/1f8a1583/attachment.pl>

From freddy.gamma at gmail.com  Tue May  1 10:53:34 2012
From: freddy.gamma at gmail.com (Freddy Gamma)
Date: Tue, 1 May 2012 10:53:34 +0200
Subject: [R-sig-Geo] trouble installing rgdal: SOLVED
Message-ID: <CAJzXPM+WVbDz3hi7eZr5adoqJG_Lkp7Bmavwwwq8xR-OtWEF6Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120501/58a8df7d/attachment.pl>

From renaud.lancelot at cirad.fr  Tue May  1 12:52:40 2012
From: renaud.lancelot at cirad.fr (lancelot)
Date: Tue, 01 May 2012 12:52:40 +0200
Subject: [R-sig-Geo] MODIS imagery
In-Reply-To: <4F9EC1F3.3030302@uni-muenster.de>
References: <mailman.0.1335798846.25347.r-sig-geo@r-project.org>
	<CAAvcZ+tAwtYaQM8-K=5woFEb6+=QrDAd65wU5y2Wm3AxK88csw@mail.gmail.com>
	<8D43BC70-93D5-45EE-AA67-74DD16E629A9@gmail.com>
	<4F9EB855.5090309@cirad.fr> <4F9EC1F3.3030302@uni-muenster.de>
Message-ID: <4F9FC078.2070407@cirad.fr>

Dear Edzer,

Thank you very much. For the record, I was able to install the MODIS 
package on my MS Windows machine, after installing Subversion from 
http://subversion.apache.org/packages.html#windows I also had to install 
SSOAP, RCurl, and XML from http://www.omegahat.org

All the best,

Renaud

Le 30/04/2012 18:46, Edzer Pebesma a ?crit :
> Please use an informative subject line.
>
> The linux version builds well from source:
>
> svn checkout svn://scm.r-forge.r-project.org/svnroot/modis/
> R CMD build pkg/MODIS
> R CMD INSTALL MODIS_0.3-11.tar.gz
>
> On 04/30/2012 06:05 PM, lancelot wrote:
>> Unfortunately it does not seem to be available at the moment, either for
>> Linux or Windows.
>>
>> Renaud
>>
>> Le 30/04/2012 17:44, Jan Verbesselt a ?crit :
>>> Hi Carlos,
>>>
>>> Have a look at the 'modis' package to download MODIS data. A compiled
>>> version for linux is available.
>>> https://r-forge.r-project.org/R/?group_id=1252
>>>
>>> for windows package please contact Matteo.
>>>
>>> Best,
>>> Jan
>>>
>>>
>>> On 30/04/2012, at 5:24 PM, carlos pombo sonderblohm wrote:
>>>
>>>> hello everybody,
>>>> Im trying to do the replica of the exercise:   Download and
>>>> resampling of
>>>> MODIS images
>>>> (
>>>> http://spatial-analyst.net/wiki/index.php?title=Download_and_resampling_of_MODIS_images
>>>>
>>>> )
>>>>
>>>> in the first step, when im trying to get the list of directories
>>>>
>>>>> items<- strsplit(getURL(MOD13A3), "\n")[[1]]
>>>>
>>>> Error in curlPerform(curl = curl, .opts = opts, .encoding = .encoding) :
>>>>    Got a 500 ftp-server response when 220 was expected
>>>>
>>>>
>>>> some help on this error?
>>>>
>>>> I got more than 220 ftp? what does means that?
>>>>
>>>> thank you very much
>>>>
>>>> Carlos
>>>>
>>>>
>>>>
>>>>
>>>>
>>>>
>>>>
>>>> 2012/4/30<r-sig-geo-request at r-project.org>
>>>>
>>>>> Welcome to the R-sig-Geo at r-project.org mailing list!
>>>>>
>>>>> To post to this list, send your message to:
>>>>>
>>>>> r-sig-geo at r-project.org
>>>>>
>>>>> General information about the mailing list is at:
>>>>>
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>
>>>>> If you ever want to unsubscribe or change your options (eg, switch to
>>>>> or from digest mode, change your password, etc.), visit your
>>>>> subscription page at:
>>>>>
>>>>> https://stat.ethz.ch/mailman/options/r-sig-geo/c.sonderblohm%40gmail.com
>>>>>
>>>>>
>>>>>
>>>>> You can also make such adjustments via email by sending a message to:
>>>>>
>>>>> R-sig-Geo-request at r-project.org
>>>>>
>>>>> with the word `help' in the subject or body (don't include the
>>>>> quotes), and you will get back a message with instructions.
>>>>>
>>>>> You must know your password to change your options (including changing
>>>>> the password, itself) or to unsubscribe without confirmation.  It is:
>>>>>
>>>>> 07760776
>>>>>
>>>>> Normally, Mailman will remind you of your r-project.org mailing list
>>>>> passwords once every month, although you can disable this if you
>>>>> prefer.  This reminder will also include instructions on how to
>>>>> unsubscribe or change your account options.  There is also a button on
>>>>> your options page that will email your current password to you.
>>>>>
>>>>
>>>>
>>>>
>>>> --
>>>> Carlos A. Pombo Sonderblohm
>>>> PhD Student on Marine Science (Fisheries)
>>>> Faculdade de Ci?ncias e Tecnolog?a
>>>> Universidade do Algarve,
>>>> Campus de Gambelas
>>>> 8005-139 Faro
>>>> Portugal
>>>> Tef. 289 800 905 ext. 7605
>>>>
>>>>      [[alternative HTML version deleted]]
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
>

-- 
Renaud Lancelot
EDENext Project, coordinator: http://www.edenext.eu/

CIRAD, UMR15, Campus International de Baillarguet TA A-DIR / B
F34398 Montpellier

Tel.  +33 4 67 59 37 17  -  Fax  +33 4 67 59 37 98
Secr. +33 4 67 59 37 37  - Cell. +33 6 77 52 08 69


From Bastien.Ferland-Raymond at mrnf.gouv.qc.ca  Tue May  1 14:08:39 2012
From: Bastien.Ferland-Raymond at mrnf.gouv.qc.ca (Bastien.Ferland-Raymond at mrnf.gouv.qc.ca)
Date: Tue, 1 May 2012 08:08:39 -0400
Subject: [R-sig-Geo] RE :  trouble importing a .img file from ArcMap 10
In-Reply-To: <mailman.15.1335866404.20134.r-sig-geo@r-project.org>
Message-ID: <161DC602615F6943A19BAEA3DBF2E4B9018C0B4B8BF6@HARFANG.intranet.mrn.gouv>


Hello Megan,

Personally, I import my .img files with the package Raster.

Try:

Elev <- stack("file_name.img")

Than you can see the result with:

Str(Elev)

And something like:

Plot(Elev)

See: http://cran.r-project.org/web/packages/raster/raster.pdf

For more details


Bastien Ferland-Raymond, M.Sc. Stat., M.Sc. Biol.

------------------------------

Message: 6
Date: Mon, 30 Apr 2012 16:21:23 -0700 (PDT)
From: Megan Marcotte < >
To: r-sig-geo at r-project.org
Subject: [
Message-ID: <1335828083349-7515387.post at n2.nabble.com>
Content-Type: text/plain; charset=us-ascii

Hello,

This is a rather low level question but I'd appreciate your help. I have
given a colleague .img files from ArcMap 10 to import into R. I don't know R
and she is new to ArcMap files and we are having trouble getting the files
in. I was hoping some of you could set us straight on what we are doing
wrong.

When I look in ArcMap the file works well and contains data. There are 5
source files for the raster in ArcMap but only the .img, .img.vat.dbf, and
.rrd files were attachable by email (so I did not send a disc image file or
a lock file).

My colleague has install RGDAL and GDAL (and other packages) and tried
importing using functions raster and readGDAL to import the .img file, but
gets the following errors:

> Elev <- raster("file_name.img")
Error in .rasterObjectFromFile(x, band = band, objecttype = "RasterLayer",
:
  Cannot create a RasterLayer object from this file.

> Elev <- readGDAL("file_name.img")

Error in .local(.Object, ...) :
  Unable to open file_name.img, it has zero usable bands.

(http://science.nature.nps.gov/im/monitor/stats/R/Data_io.cfm provided
instructions)

We would like to get the file successfully imported and have R know that the
coordinates are in WGS84. Can anyone please advise us on how to accomplish
this?

The file is in .img format  because I converted the coordinate system in
ArcMap. If importing it in its native coordinate system and then converting
to WGS84 in R is easier than I would gratefully accept help on that instead.

Thanks so much!
Megan

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/trouble-importing-a-img-file-from-ArcMap-10-tp7515387.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From samanmonfared1 at gmail.com  Tue May  1 15:28:10 2012
From: samanmonfared1 at gmail.com (Saman Monfared)
Date: Tue, 1 May 2012 17:58:10 +0430
Subject: [R-sig-Geo] Fwd: help in CompRandFld package
In-Reply-To: <CAOytA4b-o9ocsd0Mghdpdi7umnBmOPsRCfgQA7Zsnmi1m7eukA@mail.gmail.com>
References: <CAOytA4b-o9ocsd0Mghdpdi7umnBmOPsRCfgQA7Zsnmi1m7eukA@mail.gmail.com>
Message-ID: <CAOytA4Zi-EBxwxL9LgKqZzTJJ4_eXazYNTpjhu_m+oGWJrMBXw@mail.gmail.com>

---------- Forwarded message ----------
From: Saman Monfared <samanmonfared1 at gmail.com>
Date: Tue, 1 May 2012 12:31:30 +0430
Subject: help in CompRandFld package
To: r-sig-geo <r-sig-geo at r-project.org>

Dear All.
I Try to use CompRandFld package for Spatio-temporal modeling of Irish
wind data.
I write Irish wind data in txt format. I calculate times in days
((year*365)+(month*30)+day)
and saved in a coloumn with name times. I want fit a spatio-temporal
covariance  like gneiting
model.

A part of My program is :


rm(list=ls())
library(CompRandFld)
library(RandomFields)
dd<-read.table("wind.txt",header=T)
names(dd)
x <- dd$x
y <- dd$y
mean <- mean(dd$values)
sill <- 1
nugget <- 0
scale <- 3
set.seed(331)
# Define the temporal sequence:
times <- seq(1,10,1)
# Simulation of a spatio-temporal Gaussian random field:
data <- RFsim(x, y, times, corrmodel="gneiting",
param=list(mean=mean,scale_s=3,scale_t=3,sill=sill,
nugget=0,power_s=1,power_t=1,sep=0.2))$data
************************************************
Error in chol.default(varcov) :
  the leading minor of order 11 is not positive definite.

Please help me.


-- 

Saman Monfared
Msc Student,
Department of Statistics, Shiraz University,
Shiraz 71454, Iran
Email: Samanmonfared1 at gmail.com

Tel: +98 917 5305167



-- 

Saman Monfared
Msc Student,
Department of Statistics, Shiraz University,
Shiraz 71454, Iran
Email: Samanmonfared1 at gmail.com

Tel: +98 917 5305167


From edzer.pebesma at uni-muenster.de  Tue May  1 17:59:35 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 01 May 2012 17:59:35 +0200
Subject: [R-sig-Geo] Fwd: help in CompRandFld package
In-Reply-To: <CAOytA4Zi-EBxwxL9LgKqZzTJJ4_eXazYNTpjhu_m+oGWJrMBXw@mail.gmail.com>
References: <CAOytA4b-o9ocsd0Mghdpdi7umnBmOPsRCfgQA7Zsnmi1m7eukA@mail.gmail.com>
	<CAOytA4Zi-EBxwxL9LgKqZzTJJ4_eXazYNTpjhu_m+oGWJrMBXw@mail.gmail.com>
Message-ID: <4FA00867.1020406@uni-muenster.de>

Resending your email to the list twice a day is not a good style; please
assume that people read your email, or ignore it, but don't need to
receive it twice.

In this case, if reading the package documentation and relevant
literature does not help you, you might want to contact the package
authors. They may not be on this list.

On 05/01/2012 03:28 PM, Saman Monfared wrote:
> ---------- Forwarded message ----------
> From: Saman Monfared <samanmonfared1 at gmail.com>
> Date: Tue, 1 May 2012 12:31:30 +0430
> Subject: help in CompRandFld package
> To: r-sig-geo <r-sig-geo at r-project.org>
> 
> Dear All.
> I Try to use CompRandFld package for Spatio-temporal modeling of Irish
> wind data.
> I write Irish wind data in txt format. I calculate times in days
> ((year*365)+(month*30)+day)
> and saved in a coloumn with name times. I want fit a spatio-temporal
> covariance  like gneiting
> model.
> 
> A part of My program is :
> 
> 
> rm(list=ls())
> library(CompRandFld)
> library(RandomFields)
> dd<-read.table("wind.txt",header=T)
> names(dd)
> x <- dd$x
> y <- dd$y
> mean <- mean(dd$values)
> sill <- 1
> nugget <- 0
> scale <- 3
> set.seed(331)
> # Define the temporal sequence:
> times <- seq(1,10,1)
> # Simulation of a spatio-temporal Gaussian random field:
> data <- RFsim(x, y, times, corrmodel="gneiting",
> param=list(mean=mean,scale_s=3,scale_t=3,sill=sill,
> nugget=0,power_s=1,power_t=1,sep=0.2))$data
> ************************************************
> Error in chol.default(varcov) :
>   the leading minor of order 11 is not positive definite.
> 
> Please help me.
> 
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From thi_veloso at yahoo.com.br  Tue May  1 18:50:38 2012
From: thi_veloso at yahoo.com.br (Thiago Veloso)
Date: Tue, 1 May 2012 09:50:38 -0700 (PDT)
Subject: [R-sig-Geo] {Text fixed} Best approach to process a massive ammount
	of MODIS data
Message-ID: <1335891038.23131.YahooMailClassic@web161403.mail.bf1.yahoo.com>

Sorry for the two last messages: I have no ideia why the text arrives unformatted and scrambled! Hope it is fixed this time!

Dear R experts,

Recently, I have prepared a comprehensive MODIS imagery database. Ten years of LAI images (50GB of data) encompassing South America were carefully acquired and resampled/reprojected with MRT tool.

In the end, I came up with 8-day composition images like this:

lai200101.tif
lai200109.tif
lai200117.tif
lai200125.tif
        .
        .
        .
lai2011361.tif

following the naming logic of "lai{year}{julian day}.tif". 

As a final step, I need to multiply each image by its respective calibration factor. This can be done in R:

lai[lai>249]<-NA # this eliminates everything which is tagged as non-vegetation
lai_cal<-lai*0.1

After that, I would like to perform monthly integrations and save a netcdf file, something like this:

lai_jan_2001 <- lai200101.tif + lai200109.tif + lai200117.tif + lai200125.tif
lai_feb_2001 <- lai200133.tif + lai200141.tif + lai200149.tif + lai200157.tif
if(require(ncdf)){
writeRaster(lai_jan_2001,filename="/home/thiago/Desktop/lai_jan_2001.nc",format="CDF",overwrite=TRUE)
writeRaster(lai_feb_2001,filename="/home/thiago/Desktop/lai_feb_2001.nc",format="CDF",overwrite=TRUE)
}

and so on, for each month in the 2001~2011 period. I work on a HP Workstation with 6GB RAM and running Ubuntu 11.04 64bits and R 2.15.0. My current attempt to load and process one single image takes long instants:

require(raster)
require(rgdal)
lai<-raster("/home/thiago/MODIS/LAI/200101.tif")
lai[lai>249]<-NA
lai_cal<-lai*0.1
plot(lai) # optional step, but this takes LOTS of seconds to process
#Writing out calibrated image to a netcdf file
if(require(ncdf)){
writeRaster(lai_cal,filename="/home/thiago/Desktop/lai_cal.nc",format="CDF",overwrite=TRUE)
}

Also, I run out of ideas to process all the images in batch. I wonder if anyone can suggest the most effective approach, in terms of reducing both disk usage and time consumption, to process the entire database.

All the best,
Thiago Veloso.


From megotte at gmail.com  Wed May  2 03:17:44 2012
From: megotte at gmail.com (Megan Marcotte)
Date: Tue, 1 May 2012 18:17:44 -0700 (PDT)
Subject: [R-sig-Geo] RE : trouble importing a .img file from ArcMap 10
Message-ID: <CALZdh8JSt7VdbkWB86myXXeVECW0V6eN89u2FSxthRk42ynPYQ@mail.gmail.com>

Thank you Ashton and Bastien!  That is very helpful.  Both alternatives
suggested to me here worked. Apparently my issue also might have been if I
copied the files while ArcMap was open so now the raster command is working
as well on the .img file (yet another kind person helped me with that).

The files are in now and THANKS so much for your help!  Wonderful to have
that done!
Megan

On Tue, May 1, 2012 at 5:09 AM, Bastien.Ferland-Raymond [via R-sig-geo] <
ml-node+s2731867n7516680h79 at n2.nabble.com> wrote:

>
> Hello Megan,
>
> Personally, I import my .img files with the package Raster.
>
> Try:
>
> Elev <- stack("file_name.img")
>
> Than you can see the result with:
>
> Str(Elev)
>
> And something like:
>
> Plot(Elev)
>
> See: http://cran.r-project.org/web/packages/raster/raster.pdf
>
> For more details
>
>
> Bastien Ferland-Raymond, M.Sc. Stat., M.Sc. Biol.
>
> ------------------------------
>
> Message: 6
> Date: Mon, 30 Apr 2012 16:21:23 -0700 (PDT)
> From: Megan Marcotte < >
> To: [hidden email] <http://user/SendEmail.jtp?type=node&node=7516680&i=0>
> Subject: [
> Message-ID: <[hidden email]<http://user/SendEmail.jtp?type=node&node=7516680&i=1>>
>
> Content-Type: text/plain; charset=us-ascii
>
> Hello,
>
> This is a rather low level question but I'd appreciate your help. I have
> given a colleague .img files from ArcMap 10 to import into R. I don't know
> R
> and she is new to ArcMap files and we are having trouble getting the files
> in. I was hoping some of you could set us straight on what we are doing
> wrong.
>
> When I look in ArcMap the file works well and contains data. There are 5
> source files for the raster in ArcMap but only the .img, .img.vat.dbf, and
> .rrd files were attachable by email (so I did not send a disc image file
> or
> a lock file).
>
> My colleague has install RGDAL and GDAL (and other packages) and tried
> importing using functions raster and readGDAL to import the .img file, but
> gets the following errors:
>
> > Elev <- raster("file_name.img")
> Error in .rasterObjectFromFile(x, band = band, objecttype = "RasterLayer",
> :
>   Cannot create a RasterLayer object from this file.
>
> > Elev <- readGDAL("file_name.img")
>
> Error in .local(.Object, ...) :
>   Unable to open file_name.img, it has zero usable bands.
>
> (http://science.nature.nps.gov/im/monitor/stats/R/Data_io.cfm provided
> instructions)
>
> We would like to get the file successfully imported and have R know that
> the
> coordinates are in WGS84. Can anyone please advise us on how to accomplish
> this?
>
> The file is in .img format  because I converted the coordinate system in
> ArcMap. If importing it in its native coordinate system and then
> converting
> to WGS84 in R is easier than I would gratefully accept help on that
> instead.
>
> Thanks so much!
> Megan
>
> --
> View this message in context:
> http://r-sig-geo.2731867.n2.nabble.com/trouble-importing-a-img-file-from-ArcMap-10-tp7515387.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> [hidden email] <http://user/SendEmail.jtp?type=node&node=7516680&i=2>
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
> ------------------------------
>  If you reply to this email, your message will be added to the discussion
> below:
>
> http://r-sig-geo.2731867.n2.nabble.com/trouble-importing-a-img-file-from-ArcMap-10-tp7515387p7516680.html
>  To unsubscribe from trouble importing a .img file from ArcMap 10, click
> here<http://r-sig-geo.2731867.n2.nabble.com/template/NamlServlet.jtp?macro=unsubscribe_by_code&node=7515387&code=bWVnb3R0ZUBnbWFpbC5jb218NzUxNTM4N3wtMTM5Mzg0ODYwMg==>
> .
> NAML<http://r-sig-geo.2731867.n2.nabble.com/template/NamlServlet.jtp?macro=macro_viewer&id=instant_html%21nabble%3Aemail.naml&base=nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.view.web.template.NodeNamespace&breadcrumbs=notify_subscribers%21nabble%3Aemail.naml-instant_emails%21nabble%3Aemail.naml-send_instant_email%21nabble%3Aemail.naml>
>


--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Re-RE-trouble-importing-a-img-file-from-ArcMap-10-tp7518672.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From JRadinger at gmx.at  Wed May  2 10:19:41 2012
From: JRadinger at gmx.at (Johannes Radinger)
Date: Wed, 02 May 2012 10:19:41 +0200
Subject: [R-sig-Geo] cumulative distribution function of spgrass6-raster
	with NA's
Message-ID: <20120502081941.96210@gmx.net>

Hi,

I just came across following paper Bivand, R. 2007. Using the R-GRASS interface. OSGeo Journal 1, 36-38. (http://www.osgeo.org/files/journal/final_pdfs/OSGeo_vol1_GRASS-R.pdf)
I'd like to do a similar kind of analysis of a GRASS GIS raster (histograms, cumulative distribution function with  partly log-transformed axis etc.). In my case the rasters I have sucessfully imported using spgrass6 contain lots of NA's and its max is 0.7 (median ~0.003).
I just tried a quick shot by calling hist(raster) but here I get: Error in hist.default(raster) : 'x' must be numeric

I was wondering:
1) What function is used for the cumulative distribution function in the mentioned paper?
2) How do I have to handle NAs in my imported rasters to do statistics on them?

/johannes
-- 

Jetzt informieren: http://mobile.1und1.de/?ac=OM.PW.PW003K20328T7073a


From tom.gottfried at tum.de  Wed May  2 10:59:14 2012
From: tom.gottfried at tum.de (Tom Gottfried)
Date: Wed, 02 May 2012 10:59:14 +0200
Subject: [R-sig-Geo] Cropping a set of points with a polygon
In-Reply-To: <CAFFLneTFPY7uJ=JVAft2o5OzBG_HTJJoWNprZ3CY3dgJ9qusiA@mail.gmail.com>
References: <CAFFLneTFPY7uJ=JVAft2o5OzBG_HTJJoWNprZ3CY3dgJ9qusiA@mail.gmail.com>
Message-ID: <4FA0F762.8000307@tum.de>

You might be interested in over() from sp and the rgeos package.

Tom

Am 01.05.2012 05:24, schrieb steven mosher:
> I have a  dataframe of points that I would like to "crop"  or classify
> according to
> a test of whether then are inside a polygon or outside a polygon.
>
> I use "sp"  and  "rgdal"
>
> The polygon is supplied as a shapefile and comes with its own  projection.
> my datapoints are all in the projection listed below. ("+proj=longlat
> +datum=WGS84")
>
> what I'd like to do is create a function  "crop" where I feed the function,
> the datapoints and the shapefile
> and I get back a dataframe of only those points that lie inside the
> polygon. polygons will never have holes.
> I'm thinking that points.in.polygon() is going to useful, but wondering if
> there is a better way or if I am missing something
>
>
>   library(sp)
>   library(rgdal)
> #   Generate some random data that is nearby the shapefile I will use to
> crop
> dataPoints<- matrix(NA,nrow=100, ncol = 2)
>
> dataPoints[ ,1]<- sample( x = seq(-80, -45, .1), size = 100, replace =
> FALSE)
> dataPoints[ ,2]<- sample( x = seq(40, 70, .1),   size = 100, replace =
> FALSE)
> dataPoints<- SpatialPoints(dataPoints)
>
> df<- data.frame(Id = as.character(1:100))
>
> pointsDF<- SpatialPointsDataFrame(dataPoints,df,proj4string =
> CRS("+proj=longlat +datum=WGS84" ))
>
> #  read in the shapefile.. data listed for information pruposes
>   X<- readOGR(dsn = getwd(), layer = "New_Shapefile")
>
> ogrInfo(dsn=getwd(),layer = "New_Shapefile")
> Source: "G:/ShapTest", layer: "New_Shapefile"
>
>
>    Driver: ESRI Shapefile number of rows 1
>    Feature type: wkbPolygon with 2 dimensions
>    +proj=utm +zone=20 +datum=NAD83 +units=m +no_defs
>    Number of fields: 1
>    name type length typeName
>    1   Id    0      6  Integer
>
>
>    dput(X)
>
>
> new("SpatialPolygonsDataFrame"
>      , data = structure(list(Id = 1L), .Names = "Id", row.names = 0L,
> class = "data.frame")
>      , polygons = list(<S4 object of class structure("Polygons",
> package = "sp")>)
>      , plotOrder = 1L
>      , bbox = structure(c(227198.913276668, 5878401.92368424, 968033.728288047,
> 6714486.92918889), .Dim = c(2L, 2L), .Dimnames = list(c("x",
> "y"), c("min", "max")))
>      , proj4string = new("CRS"
>      , projargs = " +proj=utm +zone=20 +datum=NAD83 +units=m +no_defs
> +ellps=GRS80 +towgs84=0,0,0"
> )
> )
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Technische Universit?t M?nchen
Department f?r Pflanzenwissenschaften
Lehrstuhl f?r Gr?nlandlehre
Alte Akademie 12
85350 Freising / Germany
Phone: ++49 (0)8161 715324
Fax:   ++49 (0)8161 713243
email: tom.gottfried at wzw.tum.de
http://www.wzw.tum.de/gruenland


From JRadinger at gmx.at  Wed May  2 11:05:46 2012
From: JRadinger at gmx.at (Johannes Radinger)
Date: Wed, 02 May 2012 11:05:46 +0200
Subject: [R-sig-Geo] cumulative distribution function of spgrass6-raster
	with NA's
Message-ID: <20120502090546.181240@gmx.net>

Hi again,

I found now the answers myself. So both issues are solved:

1) I have to specify the dataframe within the spatiagriddataframe-object
like 'raster$raster' in order to do statistics on it. NA's are the recognized as NA's and are dropped for plotting histogramms etc.

2) I found the function for the empirical distribution function used in the paper. It is probably plot(ecdf(x)) from 'stats'.

/johannes
-- 

Jetzt informieren: http://mobile.1und1.de/?ac=OM.PW.PW003K20328T7073a


From Roger.Bivand at nhh.no  Wed May  2 14:42:55 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 2 May 2012 14:42:55 +0200 (CEST)
Subject: [R-sig-Geo] trouble installing rgdal: SOLVED
In-Reply-To: <CAJzXPM+WVbDz3hi7eZr5adoqJG_Lkp7Bmavwwwq8xR-OtWEF6Q@mail.gmail.com>
References: <CAJzXPM+WVbDz3hi7eZr5adoqJG_Lkp7Bmavwwwq8xR-OtWEF6Q@mail.gmail.com>
Message-ID: <alpine.LRH.2.02.1205021441180.3610@reclus.nhh.no>

On Tue, 1 May 2012, Freddy Gamma wrote:

> Hi, is still me Federico.
> No one has replied to my question (trouble in installing rgdal) yet, but I
> wished to notice I have found the trick.

Not a trick. Before, you had multiple installed versions of PROJ.4, and 
this was causing the observed mismatch. Always ensure that you order 
external dependencies in an unambiguous manner.

Roger

>
> the error message:
>
> [...]
>
> Error in dyn.load(file, DLLpath = DLLpath, ...) :
>  unable to load shared object
> '/home/me/R/i686-pc-linux-gnu-library/2.13/rgdal/libs/rgdal.so':
>  /home/me/R/i686-pc-linux-gnu-library/2.13/rgdal/libs/rgdal.so: undefined
> symbol: pj_get_default_ctx
> Error: loading failed
> Execution halted
> ERROR: loading failed
> * removing ?/home/me/R/i686-pc-linux-gnu-library/2.13/rgdal?
>
> ...I'm not a geek but as far as I understood the message meant that a link
> between rgdal and proj4 was not in place and no proper sharing was
> happening between them (as a result there was an unrecognized symbol).
>
> I managed to solve that using "ldconfig" after removing all proj4-related
> fiiles and reinstalling (with ./configure, no prefix).
>
> tar -zxf /home/me/Downloads/proj-4.8.0.tar.gz
>
> cd proj-4.8.0
>
> ./configure
>
> make
> sudo make install
> sudo ldconfig
> cd ..
>
> that did the trick...I'm very happy at the moment,...hope all will run
> smoothly afterward too.
> hope this post helps
>
> ciao
>
> Federico
>
>
> 2012/4/30 Freddy Gamma <freddy.gamma at gmail.com>
>
>> Dear sig-geoers,
>> as an R-user I'd first like to thank you for all the effrot you put into
>> the R-project.
>> I hope what following will not cause you too much time expenditure and
>> I'll be very grateful you could give an advise as I made quite an effort to
>> sort it out by myself with no success.
>>
>> I start with the preliminaries:
>>
>> INSTALLED SOFTWARE:
>>
>>
>> OS: LINUX UBUNTU 10.11 Oneiric Ocelot
>> R  2.13.1
>> GRASS GIS 6.41 binary (installed via sudo apt-get install grass)
>> GDAL 1.9 (installed form official source, tar.gz, configuration option=
>> "--without grass", I have all files stored in a prefixed folder,
>> /usr/local/myfold,  and in standard folders - /usr/local- as I noted there
>> were difficulties in finding libgdal.so.1 from prefixed folder )
>> PROJ 4.8 ( installed from official source, tar.gz, all files installed in
>> prefixed folder /usr/local/myfold, proj_api.h and projlib pointed out via
>> configuration.arg statements).  # update I have also moved everithing in
>> standard folders. usr/local/ ..
>>
>> ISSUE:
>>
>> following some threads on the R-help list I finally came to run the
>> following:
>>
>> R CMD INSTALL
>> --configure-args="--with-proj-include=/usr/local/proj4/include
>> --with-proj-lib=/usr/local/proj4/lib" rgdal_0.7-8.tar.gz
>> NOTE: having just moved all the proj4 directories in standard folders
>> (/usr/local) I could run the same command with no conf.args. I obtaiined
>> nevertheless the same error message listed below!
>>
>> and received the following error (only an extract here, I'll paste the
>> full message at the bottom page):
>>
>> [...]
>>
>> Error in dyn.load(file, DLLpath = DLLpath, ...) :
>>   unable to load shared object
>> '/home/me/R/i686-pc-linux-gnu-library/2.13/rgdal/libs/rgdal.so':
>>   /home/me/R/i686-pc-linux-gnu-library/2.13/rgdal/libs/rgdal.so: *undefined
>> symbol*: *pj_get_default_ctx
>> *Error: loading failed
>> Execution halted
>> ERROR: loading failed
>> * removing ?/home/me/R/i686-pc-linux-gnu-library/2.13/rgdal?
>>
>> ###
>>
>> As you can note seems that pj_get_default_ctx is not recognized (as far as
>> I'm inferring, i'm not a programmer).
>> I have made a research and understood that pj_get_default_ctx is a
>> something living into the proj_api.h file, into the "include" folder of the
>> installed PROJ4 (/usr/local/myfold, here).
>>
>>
>> Here is all, I hope I have furnished exhaustive informations to ease the
>> investigative task.
>>
>> I'd like to thank you in advance
>>
>> best regards
>>
>>
>> Federico Bonofiglio
>> contract researcher
>>
>>
>> ## full install message
>>
>> * installing to library ?/home/me/R/i686-pc-linux-gnu-library/2.13?
>> * installing *source* package ?rgdal? ...
>> gdal-config: gdal-config
>> checking for gcc... gcc
>> checking whether the C compiler works... yes
>> checking for C compiler default output file name... a.out
>> checking for suffix of executables...
>> checking whether we are cross compiling... no
>> checking for suffix of object files... o
>> checking whether we are using the GNU C compiler... yes
>> checking whether gcc accepts -g... yes
>> checking for gcc option to accept ISO C89... none needed
>> checking how to run the C preprocessor... gcc -E
>> checking for grep that handles long lines and -e... /bin/grep
>> checking for egrep... /bin/grep -E
>> checking for ANSI C header files... yes
>> checking for sys/types.h... yes
>> checking for sys/stat.h... yes
>> checking for stdlib.h... yes
>> checking for string.h... yes
>> checking for memory.h... yes
>> checking for strings.h... yes
>> checking for inttypes.h... yes
>> checking for stdint.h... yes
>> checking for unistd.h... yes
>> checking proj_api.h usability... yes
>> checking proj_api.h presence... yes
>> checking for proj_api.h... yes
>> checking for pj_init_plus in -lproj... yes
>> PROJ.4 Version 4.8 or later
>> *./proj_conf_test: symbol lookup error: ./proj_conf_test: undefined
>> symbol: pj_get_default_ctx
>> ./proj_conf_test: symbol lookup error: ./proj_conf_test: undefined symbol:
>> pj_get_default_ctx
>> *Package CPP flags: -DP4CTX=1 -I/usr/local/proj4/include
>> -I/usr/local/gdal/include
>> Package LIBS:  -L/usr/local/proj4/lib -L/usr/local/gdal/lib -lgdal
>> configure: creating ./config.status
>> config.status: creating src/Makevars
>> ** libs
>> g++ -I/usr/share/R/include -DP4CTX=1 -I/usr/local/proj4/include
>> -I/usr/local/gdal/include
>> -I"/home/me/R/i686-pc-linux-gnu-library/2.13/sp/include"   -fpic  -O3
>> -pipe  -g -c OGR_write.cpp -o OGR_write.o
>> g++ -I/usr/share/R/include -DP4CTX=1 -I/usr/local/proj4/include
>> -I/usr/local/gdal/include
>> -I"/home/me/R/i686-pc-linux-gnu-library/2.13/sp/include"   -fpic  -O3
>> -pipe  -g -c gdal-bindings.cpp -o gdal-bindings.o
>> gcc -I/usr/share/R/include -DP4CTX=1 -I/usr/local/proj4/include
>> -I/usr/local/gdal/include
>> -I"/home/me/R/i686-pc-linux-gnu-library/2.13/sp/include"   -fpic
>> -std=gnu99 -O3 -pipe  -g -c local_stubs.c -o local_stubs.o
>> g++ -I/usr/share/R/include -DP4CTX=1 -I/usr/local/proj4/include
>> -I/usr/local/gdal/include
>> -I"/home/me/R/i686-pc-linux-gnu-library/2.13/sp/include"   -fpic  -O3
>> -pipe  -g -c ogr_geom.cpp -o ogr_geom.o
>> gcc -I/usr/share/R/include -DP4CTX=1 -I/usr/local/proj4/include
>> -I/usr/local/gdal/include
>> -I"/home/me/R/i686-pc-linux-gnu-library/2.13/sp/include"   -fpic
>> -std=gnu99 -O3 -pipe  -g -c ogr_polygons.c -o ogr_polygons.o
>> g++ -I/usr/share/R/include -DP4CTX=1 -I/usr/local/proj4/include
>> -I/usr/local/gdal/include
>> -I"/home/me/R/i686-pc-linux-gnu-library/2.13/sp/include"   -fpic  -O3
>> -pipe  -g -c ogr_proj.cpp -o ogr_proj.o
>> g++ -I/usr/share/R/include -DP4CTX=1 -I/usr/local/proj4/include
>> -I/usr/local/gdal/include
>> -I"/home/me/R/i686-pc-linux-gnu-library/2.13/sp/include"   -fpic  -O3
>> -pipe  -g -c ogrdrivers.cpp -o ogrdrivers.o
>> g++ -I/usr/share/R/include -DP4CTX=1 -I/usr/local/proj4/include
>> -I/usr/local/gdal/include
>> -I"/home/me/R/i686-pc-linux-gnu-library/2.13/sp/include"   -fpic  -O3
>> -pipe  -g -c ogrsource.cpp -o ogrsource.o
>> g++ -I/usr/share/R/include -DP4CTX=1 -I/usr/local/proj4/include
>> -I/usr/local/gdal/include
>> -I"/home/me/R/i686-pc-linux-gnu-library/2.13/sp/include"   -fpic  -O3
>> -pipe  -g -c projectit.cpp -o projectit.o
>> g++ -shared -o rgdal.so OGR_write.o gdal-bindings.o local_stubs.o
>> ogr_geom.o ogr_polygons.o ogr_proj.o ogrdrivers.o ogrsource.o projectit.o
>> -L/usr/local/proj4/lib -L/usr/local/gdal/lib -lgdal -lproj -L/usr/lib/R/lib
>> -lR
>> installing to /home/me/R/i686-pc-linux-gnu-library/2.13/rgdal/libs
>> ** R
>> ** inst
>> ** preparing package for lazy loading
>> ** help
>> *** installing help indices
>> ** building package indices ...
>> ** testing if installed package can be loaded
>> Error in dyn.load(file, DLLpath = DLLpath, ...) :
>>   unable to load shared object
>> '/home/me/R/i686-pc-linux-gnu-library/2.13/rgdal/libs/rgdal.so':
>>   /home/me/R/i686-pc-linux-gnu-library/2.13/rgdal/libs/rgdal.so: *undefined
>> symbol: pj_get_default_ctx
>> *Error: loading failed
>> Execution halted
>> ERROR: loading failed
>> * removing ?/home/me/R/i686-pc-linux-gnu-library/2.13/rgdal?
>>
>
> 	[[alternative HTML version deleted]]
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From jon.skoien at jrc.ec.europa.eu  Wed May  2 16:39:48 2012
From: jon.skoien at jrc.ec.europa.eu (Jon Olav Skoien)
Date: Wed, 02 May 2012 16:39:48 +0200
Subject: [R-sig-Geo] Projection problem (epsg 3857 - maybe not R-related)
Message-ID: <4FA14734.3090005@jrc.ec.europa.eu>

Hi,

We are having a problem with projections that we dont know the source of 
(bugs in software or lack of understanding). The problem might not be 
related to R, but I hope someone can still help. We have a set of data 
(polygons and rasters) that are all supposed to be in projection 
epsg:3857 (WGS 84 / Pseudo-Mercator, often referred to as web mercator 
as it is used in web services such as Google Maps). However, they do not 
appear to be the same when using them in R. Below is an example that 
starts with a hypothetical polygon somewhere in Europe, and then 
transforming it with the three different proj4strings we got from the 
different objects :

cords = matrix(c( 650000, 700000, 700000, 650000, 650000, 5600000, 
5600000, 5700000, 5700000, 5600000), ncol = 2)
pol = 
SpatialPolygonsDataFrame(SpatialPolygons(list(Polygons(list(Polygon(cords)), 
ID = "1")),
     proj4string = CRS("+init=epsg:3857")), data = data.frame(test = 1))
proj4string(pol)
# [1] " +init=epsg:3857 +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 
+lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"
# This is the proj4string that R creates from this epsg code

# Below are the proj4strings that we got from the imported objects
# 1 is from an export and transformation from a postgis database of 
polygons (latlong) with ogr2ogr and target crs epsg:3857
# 2 is an export from the same data base with psql2shape
# the same proj4strings were also generated from the .prj-files when 
transforming with QGIS.
# 3 is from a geoTIFF, and practically identical to the proj4string that 
R generated from epsg:3857
projs = list()
projs[[1]] = " +proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +datum=WGS84 
+units=m +no_defs +ellps=WGS84 +towgs84=0,0,0"
projs[[2]] = " +proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +a=6378137 
+b=6378137 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"
projs[[3]] = " +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 
+x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"

# Here we print the y-coordinate of the original polygon (centroid) 
together with the y-coordinate
# of the reprojected polygon. In addition we write the result to a 
shapefile:
pols = list()
for (i in 1:3) {
   pols[[i]] = spTransform(pol, CRS(projs[[i]]))
#  writeOGR(pols[[i]], "e:/temp/Rtmp/polygons", paste("pol", i, sep = 
""), driver = "ESRI Shapefile")
   print(paste(i, coordinates(pol)[,2], coordinates(pols[[i]])[,2]))
}
#[1] "1 5650000 5619680.01465088"
#[1] "2 5650000 5619663.0232111"
#[1] "3 5650000 5650000"

The writeOGR call above is to also be able to examine the .prj files. 
The last two of these are:
pol2.prj
PROJCS["Mercator",GEOGCS["GCS_unnamed ellipse",DATUM["D_unknown", 
SPHEROID["Unknown",6378137,0]],PRIMEM["Greenwich",0],UNIT["Degree",0.017453292519943295]], 
PROJECTION["Mercator"],PARAMETER["central_meridian",0],PARAMETER["false_easting",0], 
PARAMETER["false_northing",0],PARAMETER["standard_parallel_1",0.0],UNIT["Meter",1]] 


pol3.prj
PROJCS["Mercator_2SP",GEOGCS["GCS_unnamed ellipse",DATUM["D_unknown",  
SPHEROID["Unknown",6378137,0]],PRIMEM["Greenwich",0], 
UNIT["Degree",0.017453292519943295]], 
PROJECTION["Mercator_2SP"],PARAMETER["standard_parallel_1",0], 
PARAMETER["central_meridian",0],PARAMETER["false_easting",0],PARAMETER["false_northing",0],UNIT["Meter",1]]

The only differences between these two are the PROJCS and PROJECTION 
parameters, which are "Mercator" and "Mercator_2SP", respectively, and 
the order of some parameters; the last one puts 
PARAMETER["standard_parallel_1",0] before meridian and false easting and 
northing, whereas the first one puts it after. The parameters are 
otherwise the same.

The questions are therefore:
Are the differences due to the use of "Mercator" and "Mercator_2SP"?
Can it be correct that we get different coordinates for the same epsg-code?
If not, which version should we trust, or how can we make sure that the 
same epsg-code refers to the same projection?

Thanks,
Jon

BTW:
 > sessionInfo()
R version 2.15.0 (2012-03-30)
Platform: x86_64-pc-mingw32/x64 (64-bit)

locale:
[1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United 
States.1252
[3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
[5] LC_TIME=English_United States.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] rgdal_0.7-8 sp_0.9-98

loaded via a namespace (and not attached):
[1] grid_2.15.0    lattice_0.20-6
 > getPROJ4VersionInfo()
[1] "Rel. 4.7.1, 23 September 2009, [PJ_VERSION: 470]"

-- 
Jon Olav Sk?ien
Joint Research Centre - European Commission
Institute for Environment and Sustainability (IES)
Land Resource Management Unit

Via Fermi 2749, TP 440,  I-21027 Ispra (VA), ITALY

jon.skoien at jrc.ec.europa.eu
Tel:  +39 0332 789206

Disclaimer: Views expressed in this email are those of the individual and do not necessarily represent official views of the European Commission.


From Roger.Bivand at nhh.no  Wed May  2 18:39:11 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 2 May 2012 18:39:11 +0200 (CEST)
Subject: [R-sig-Geo] Projection problem (epsg 3857 - maybe not R-related)
In-Reply-To: <4FA14734.3090005@jrc.ec.europa.eu>
References: <4FA14734.3090005@jrc.ec.europa.eu>
Message-ID: <alpine.LRH.2.02.1205021834370.3610@reclus.nhh.no>

On Wed, 2 May 2012, Jon Olav Skoien wrote:

> Hi,
>
> We are having a problem with projections that we dont know the source of 
> (bugs in software or lack of understanding). The problem might not be related 
> to R, but I hope someone can still help. We have a set of data (polygons and 
> rasters) that are all supposed to be in projection epsg:3857 (WGS 84 / 
> Pseudo-Mercator, often referred to as web mercator as it is used in web 
> services such as Google Maps). However, they do not appear to be the same 
> when using them in R. Below is an example that starts with a hypothetical 
> polygon somewhere in Europe, and then transforming it with the three 
> different proj4strings we got from the different objects :
>
> cords = matrix(c( 650000, 700000, 700000, 650000, 650000, 5600000, 5600000, 
> 5700000, 5700000, 5600000), ncol = 2)
> pol = 
> SpatialPolygonsDataFrame(SpatialPolygons(list(Polygons(list(Polygon(cords)), 
> ID = "1")),
>    proj4string = CRS("+init=epsg:3857")), data = data.frame(test = 1))
> proj4string(pol)
> # [1] " +init=epsg:3857 +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 
> +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"
> # This is the proj4string that R creates from this epsg code
>
> # Below are the proj4strings that we got from the imported objects
> # 1 is from an export and transformation from a postgis database of polygons 
> (latlong) with ogr2ogr and target crs epsg:3857
> # 2 is an export from the same data base with psql2shape
> # the same proj4strings were also generated from the .prj-files when 
> transforming with QGIS.
> # 3 is from a geoTIFF, and practically identical to the proj4string that R 
> generated from epsg:3857
> projs = list()
> projs[[1]] = " +proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +datum=WGS84 +units=m 
> +no_defs +ellps=WGS84 +towgs84=0,0,0"
> projs[[2]] = " +proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +a=6378137 +b=6378137 
> +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"
> projs[[3]] = " +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 
> +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"
>
> # Here we print the y-coordinate of the original polygon (centroid) together 
> with the y-coordinate
> # of the reprojected polygon. In addition we write the result to a shapefile:
> pols = list()
> for (i in 1:3) {
>  pols[[i]] = spTransform(pol, CRS(projs[[i]]))
> #  writeOGR(pols[[i]], "e:/temp/Rtmp/polygons", paste("pol", i, sep = ""), 
> driver = "ESRI Shapefile")
>  print(paste(i, coordinates(pol)[,2], coordinates(pols[[i]])[,2]))
> }
> #[1] "1 5650000 5619680.01465088"
> #[1] "2 5650000 5619663.0232111"
> #[1] "3 5650000 5650000"
>
> The writeOGR call above is to also be able to examine the .prj files. The 
> last two of these are:
> pol2.prj
> PROJCS["Mercator",GEOGCS["GCS_unnamed ellipse",DATUM["D_unknown", 
> SPHEROID["Unknown",6378137,0]],PRIMEM["Greenwich",0],
> UNIT["Degree",0.017453292519943295]], 
> PROJECTION["Mercator"],PARAMETER["central_meridian",0],
> PARAMETER["false_easting",0], 
> PARAMETER["false_northing",0],PARAMETER["standard_parallel_1",0.0],
> UNIT["Meter",1]] 
>
> pol3.prj
> PROJCS["Mercator_2SP",GEOGCS["GCS_unnamed ellipse",DATUM["D_unknown", 
> SPHEROID["Unknown",6378137,0]],PRIMEM["Greenwich",0], 
> UNIT["Degree",0.017453292519943295]], 
> PROJECTION["Mercator_2SP"],PARAMETER["standard_parallel_1",0], 
> PARAMETER["central_meridian",0],PARAMETER["false_easting",0],
> PARAMETER["false_northing",0],UNIT["Meter",1]]
>
> The only differences between these two are the PROJCS and PROJECTION 
> parameters, which are "Mercator" and "Mercator_2SP", respectively, and the 
> order of some parameters; the last one puts 
> PARAMETER["standard_parallel_1",0] before meridian and false easting and 
> northing, whereas the first one puts it after. The parameters are otherwise 
> the same.
>
> The questions are therefore:
> Are the differences due to the use of "Mercator" and "Mercator_2SP"?
> Can it be correct that we get different coordinates for the same epsg-code?
> If not, which version should we trust, or how can we make sure that the same 
> epsg-code refers to the same projection?

As http://spatialreference.org/ref/sr-org/6864/ points out, this is a 
rather broken configuration on a sphere. The definitions seem to be 
identical in your cases, as a @null grid or zero towgs84 coefficients will 
have the same effect. You could ask on the proj list, but my intuition is 
that this is useful for display only, not for data transfer.

Hope this clarifies,

Roger

>
> Thanks,
> Jon
>
> BTW:
>> sessionInfo()
> R version 2.15.0 (2012-03-30)
> Platform: x86_64-pc-mingw32/x64 (64-bit)
>
> locale:
> [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United 
> States.1252
> [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
> [5] LC_TIME=English_United States.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] rgdal_0.7-8 sp_0.9-98
>
> loaded via a namespace (and not attached):
> [1] grid_2.15.0    lattice_0.20-6
>> getPROJ4VersionInfo()
> [1] "Rel. 4.7.1, 23 September 2009, [PJ_VERSION: 470]"
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From aortizbobea at arec.umd.edu  Thu May  3 03:17:44 2012
From: aortizbobea at arec.umd.edu (Ariel Ortiz-Bobea)
Date: Wed, 2 May 2012 18:17:44 -0700 (PDT)
Subject: [R-sig-Geo] spml function and the spatial.error option
Message-ID: <1336007864752-7522051.post@n2.nabble.com>

Hi,

I'm trying to run a panel model (of N counties over T years) with
contemporaneous/spatial correlation in the errors. So this is a "spatial
error model" in this literature's terminology.

In order to explore this function I'm simulating spatially correlated data
and errors and comparing it to the results from the plm() function with some
Monte Carlo analysis.

However, I'm getting /exactly/ the same (wrong) results when specifying "b"
or "kkp" or "none" in the spatial.error option. 

On the other hand, while the empirical distributions I get with spml() are
more efficient (narrower) the standard errors I get are virtually identical
to the "naive" standard errors returned by the plm canned routine.

You will find my reproducible example below, although you need to download
the US shape file:
http://dl.dropbox.com/u/45311184/spatial/co99_d00.shp

So, my very broad question is, what's wrong? More specifically, 
- Is it a matter of spatial weights? 
- Am I specifying the call for spml incorrectly? 
- Why does the "p" "kkp" and "none" options return the same result? 
- Why is there a "rho" estimated in the case in which spatial.error="none"?
- Why is the "rho" reported in the "coefficients" table with my beta and not
in a "Error variance parameters" table as it is shown here (page 9):
www.jstatsoft.org/v47/i01/paper

Any help, hints, suggestions would be greatly appreciated.

Let's hope my question and code are clear enough!

Thanks,

Ariel

----------------------------------
----- CODE FROM HERE ON ----
----------------------------------

# Preliminary
#~~~~~~~~
library(rgdal)
library(spdep)
library(plm)
library(splm)

# download US shape file:
http://dl.dropbox.com/u/45311184/spatial/co99_d00.shp
counties  <- readOGR("co99_d00.shp","co99_d00")
counties  <- counties[counties$STATE %in% c("17"),] # only keep Illinois for
the example
plot(counties)
n        <- length(counties at polygons) # number of counties

# Neigbhors and weights
nb  <- poly2nb(counties)
nbw <- nb2listw(nb, style="W") # Row-standardised weights

# Parameters
beta = matrix(1, nrow=1, ncol=1)
sig2 = 25

# creating spatial correlation
distmatrix <- spDists(counties, longlat = F)
SD <- max(distmatrix)/5 # standard deviation in m
Sigma1.nor <- distmatrix
Sigma1.nor <- dnorm(Sigma1.nor, mean=0,sd=SD) / dnorm(0,mean=0,sd=SD) 
Sigma1.nor <- sig2 * Sigma1.nor
Sigma1.nor[1:10,1:10]
rm(SD)

# Ability to generate multivariate normals
vs.nor       <- svd(Sigma1.nor) 
vcsqrt.nor   <- t(vs.nor$v %*% (t(vs.nor$u) * sqrt(vs.nor$d))) 
# function to generate multivariate normals 
mrnorm.nor <- function(num.vals, mu.vec) {
   k        <- ncol(Sigma1.nor)
   ans.mat  <- sweep(matrix(rnorm(num.vals*k), nrow = num.vals) %*%
vcsqrt.nor,2,mu.vec,"+") # 1 sec
   c(t(ans.mat))
}

# Artificial data:
#~~~~~~~~~

# Panel structure
years       <- 1980:2010     # time periods
t           <- length(years) # number of time periods
dataset     <- data.frame( fips        =
as.numeric(paste(counties at data$STATE, counties at data$COUNTY, sep="")),
                           year=rep(years, each=n) )
# The Xs
set.seed(1)
dataset$Xcor <- mrnorm.nor(t , rep(1,times=n) ) # generate contemporaneously
correlated Xs over space
dataset$alpha<- rep(rnorm(n,mean=5,sd=sqrt(sig2)), times=t) # county
effect/intercept   
head(dataset)

# Mapping function 
choropleth <- function(dataframe, var, years, title,colors){   
   df     <- data.frame(matrix( dataframe[,var][dataframe$year %in% years] ,
ncol=length(years)))
   names(df)   <- years
   temp   <- SpatialPolygonsDataFrame(counties, data.frame(counties at data,
df))
   arrow = list("SpatialPolygonsRescale", layout.north.arrow(), offset =
c(-76,34), scale = 0.5, which = 2)
   spplot(temp, zcol= paste("X",years,sep=""), 
          par.settings = list(axis.line = list(col =  'transparent')), #
removes lines around plot
          names.attr = paste(years), # names on top of each panel e.g. year
          col.regions = colorRampPalette(colors)(100), #cm.colors(100), #,
heat.colors(), topo.colors()
          colorkey=list(space="right"), scales = list(draw = F), # location
of legend
          main = title,
          sp.layout = list(arrow), as.table = TRUE)
}

# Visualize Xs for year 1995 for example
choropleth(dataset, "Xcor", 1995, "Correlated X for
1995",colors=c("blue","cyan","red"))
# Same thing for errors (note Xs and Errors are not correlated )
dataset$Ecor <- mrnorm.nor(t, rep(0,times=n))
choropleth(dataset, "Ecor", 1995, "Spatially correlated errors - 1995",
colors=c("red","white","black"))

# Compute theoretical standard errors for beta
Sigma.nor    <- bdiag(lapply(1:t, function(x) Sigma1.nor) ) # block diagonal
covariance matrix
D  <- outer(dataset$fips, unique(dataset$fips), "==") + 0   # fixed-effect
dummy matrix
colnames(D) <- paste(unique(dataset$fips))
Z <- cbind(dataset$Xcor, D) # the regressor matrix
ZZ_inv <- solve(t(Z)  %*% Z)
vcov <- ZZ_inv %*% t(Z) %*% Sigma.nor %*% Z %*% ZZ_inv
rm(Z,D)
sqrt(vcov[1,1]) # teh correct standard error of beta


# Monte carlo analysis:
#~~~~~~~~~~~~~~
ndraws <-  200
fitfe.bsave  = matrix(0, nrow=ndraws, ncol=4) 
fitfe.sesave = matrix(0, nrow=ndraws, ncol=4)
# Monte Carlo experiment
system.time({ # takes ~120 secs for 200 draws in my 3-year old computer
   for (i in 1:ndraws) {  
      print(i)
      # Generate vector of errors
         Ecor <- mrnorm.nor(t, rep(0,times=n))
      # Compute the implied y variable
         dataset$y      <- as.matrix(dataset[,c("Xcor")]) %*% beta +
dataset$alpha + Ecor         
      # Run regressions
         fitfe      <-  plm( y ~ Xcor, data = dataset, model="within", index
= c("fips","year"))
         fitfe.b    <- spml(formula = y ~ Xcor, data = dataset,
model="within", index = c("fips","year"), listw = nbw, lag = FALSE,
spatial.error = "b")
         fitfe.kkp  <- spml(formula = y ~ Xcor, data = dataset,
model="within", index = c("fips","year"), listw = nbw, lag = FALSE,
spatial.error = "kkp")
         fitfe.none <- spml(formula = y ~ Xcor, data = dataset,
model="within", index = c("fips","year"), listw = nbw, lag = FALSE,
spatial.error = "none")
      # Save 
         fitfe.bsave[i,1]  <- coefficients(fitfe)
         fitfe.sesave[i,1] <- sqrt(diag(vcov(fitfe)))
         fitfe.bsave[i,2]  <- fitfe.b$coefficients[2]
         fitfe.sesave[i,2] <- sqrt(fitfe.b$vcov[2,2])
         fitfe.bsave[i,3]  <- fitfe.kkp$coefficients[2]
         fitfe.sesave[i,3] <- sqrt(fitfe.kkp$vcov[2,2])
         fitfe.bsave[i,4]  <- fitfe.none$coefficients[2]
         fitfe.sesave[i,4] <- sqrt(fitfe.none$vcov[2,2])
      # Clean up
         dataset$y      <- NULL
   }
})

# Something I dont understand: why is there a "rho" estimated in the model
where spatial.error="none"?
# Also, why is this rho in the coefficients table and not in a error
parameters table by itself?
summary(fitfe.none)

# Visualize:
#~~~~~~~~~~~

# Initial plot: distribution of beta with Xcor and Ecor
plot( density(fitfe.bsave[,1]),  ylim=c(0,10), xlim=c(0.8,1.3), type="l",
lwd=2, col= "black", xlab="coefficient", ylab="density", main=paste("Monte
Carlo analysis - ",ndraws,"draws"))

# Theoretical distribution of beta
lines(seq(beta-2,beta+2,0.0001), dnorm( seq(beta-2,beta+2,0.0001),
mean=beta, sd= sqrt(vcov[1,1])) ,lty="dashed", col="black",lwd=2)                   

# Average "naive" distributions from canned FE routine
lines(seq(beta-2,beta+2,0.0001), dnorm( seq(beta-2,beta+2,0.0001),
mean=mean(fitfe.bsave[,1]), sd= mean(fitfe.sesave[,1] )),lty="solid",
col="red",lwd=2) 

# Empirical Spatial Error Model (SER) distribution of beta 
lines(density(fitfe.bsave[,2]),lty="solid", col="blue",lwd=2) # option "b"
lines(density(fitfe.bsave[,3]),lty="solid", col="blue",lwd=2) # option "kkp"
lines(density(fitfe.bsave[,4]),lty="solid", col="blue",lwd=2) # option
"none"

# Average Spatial Error Model (SER) distribution of beta from canned routine
lines(seq(beta-2,beta+2,0.0001), dnorm( seq(beta-2,beta+2,0.0001),
mean=mean(fitfe.bsave[,2]), sd= mean(fitfe.sesave[,2] )),lty="solid",
col="cyan",lwd=2) # option "b"
lines(seq(beta-2,beta+2,0.0001), dnorm( seq(beta-2,beta+2,0.0001),
mean=mean(fitfe.bsave[,2]), sd= mean(fitfe.sesave[,3] )),lty="solid",
col="cyan",lwd=2) # option "kkp"
lines(seq(beta-2,beta+2,0.0001), dnorm( seq(beta-2,beta+2,0.0001),
mean=mean(fitfe.bsave[,2]), sd= mean(fitfe.sesave[,4] )),lty="solid",
col="cyan",lwd=2) # option "none"

# Legend and reference line
legend("topright", cex=0.7, title= "Distribution of beta",
legend=c("Empirical FE", "Theoretical FE", "Avg. naive FE", "Empirical SER
(3 lines)", "Avg. reported SER (3 lines)"),
lty=c("solid","dashed","solid","solid","solid"),
lwd=2,col=c("black","black","red","blue","cyan"))
abline(v=beta, lty=3)



-----
Ariel Ortiz-Bobea
PhD Candidate in Agricultural & Resource Economics
University of Maryland - College Park
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/spml-function-and-the-spatial-error-option-tp7522051.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From jon.skoien at jrc.ec.europa.eu  Thu May  3 10:07:11 2012
From: jon.skoien at jrc.ec.europa.eu (Jon Olav Skoien)
Date: Thu, 03 May 2012 10:07:11 +0200
Subject: [R-sig-Geo] Projection problem (epsg 3857 - maybe not R-related)
In-Reply-To: <alpine.LRH.2.02.1205021834370.3610@reclus.nhh.no>
References: <4FA14734.3090005@jrc.ec.europa.eu>
	<alpine.LRH.2.02.1205021834370.3610@reclus.nhh.no>
Message-ID: <4FA23CAF.5080405@jrc.ec.europa.eu>

On 02-May-12 18:39, Roger Bivand wrote:
> On Wed, 2 May 2012, Jon Olav Skoien wrote:
>
>> Hi,
>>
>> We are having a problem with projections that we dont know the source 
>> of (bugs in software or lack of understanding). The problem might not 
>> be related to R, but I hope someone can still help. We have a set of 
>> data (polygons and rasters) that are all supposed to be in projection 
>> epsg:3857 (WGS 84 / Pseudo-Mercator, often referred to as web 
>> mercator as it is used in web services such as Google Maps). However, 
>> they do not appear to be the same when using them in R. Below is an 
>> example that starts with a hypothetical polygon somewhere in Europe, 
>> and then transforming it with the three different proj4strings we got 
>> from the different objects :
>>
>> cords = matrix(c( 650000, 700000, 700000, 650000, 650000, 5600000, 
>> 5600000, 5700000, 5700000, 5600000), ncol = 2)
>> pol = 
>> SpatialPolygonsDataFrame(SpatialPolygons(list(Polygons(list(Polygon(cords)), 
>> ID = "1")),
>>    proj4string = CRS("+init=epsg:3857")), data = data.frame(test = 1))
>> proj4string(pol)
>> # [1] " +init=epsg:3857 +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 
>> +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"
>> # This is the proj4string that R creates from this epsg code
>>
>> # Below are the proj4strings that we got from the imported objects
>> # 1 is from an export and transformation from a postgis database of 
>> polygons (latlong) with ogr2ogr and target crs epsg:3857
>> # 2 is an export from the same data base with psql2shape
>> # the same proj4strings were also generated from the .prj-files when 
>> transforming with QGIS.
>> # 3 is from a geoTIFF, and practically identical to the proj4string 
>> that R generated from epsg:3857
>> projs = list()
>> projs[[1]] = " +proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +datum=WGS84 
>> +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0"
>> projs[[2]] = " +proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +a=6378137 
>> +b=6378137 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"
>> projs[[3]] = " +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 
>> +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"
>>
>> # Here we print the y-coordinate of the original polygon (centroid) 
>> together with the y-coordinate
>> # of the reprojected polygon. In addition we write the result to a 
>> shapefile:
>> pols = list()
>> for (i in 1:3) {
>>  pols[[i]] = spTransform(pol, CRS(projs[[i]]))
>> #  writeOGR(pols[[i]], "e:/temp/Rtmp/polygons", paste("pol", i, sep = 
>> ""), driver = "ESRI Shapefile")
>>  print(paste(i, coordinates(pol)[,2], coordinates(pols[[i]])[,2]))
>> }
>> #[1] "1 5650000 5619680.01465088"
>> #[1] "2 5650000 5619663.0232111"
>> #[1] "3 5650000 5650000"
>>
>> The writeOGR call above is to also be able to examine the .prj files. 
>> The last two of these are:
>> pol2.prj
>> PROJCS["Mercator",GEOGCS["GCS_unnamed ellipse",DATUM["D_unknown", 
>> SPHEROID["Unknown",6378137,0]],PRIMEM["Greenwich",0],
>> UNIT["Degree",0.017453292519943295]], 
>> PROJECTION["Mercator"],PARAMETER["central_meridian",0],
>> PARAMETER["false_easting",0], 
>> PARAMETER["false_northing",0],PARAMETER["standard_parallel_1",0.0],
>> UNIT["Meter",1]]
>> pol3.prj
>> PROJCS["Mercator_2SP",GEOGCS["GCS_unnamed ellipse",DATUM["D_unknown", 
>> SPHEROID["Unknown",6378137,0]],PRIMEM["Greenwich",0], 
>> UNIT["Degree",0.017453292519943295]], 
>> PROJECTION["Mercator_2SP"],PARAMETER["standard_parallel_1",0], 
>> PARAMETER["central_meridian",0],PARAMETER["false_easting",0],
>> PARAMETER["false_northing",0],UNIT["Meter",1]]
>>
>> The only differences between these two are the PROJCS and PROJECTION 
>> parameters, which are "Mercator" and "Mercator_2SP", respectively, 
>> and the order of some parameters; the last one puts 
>> PARAMETER["standard_parallel_1",0] before meridian and false easting 
>> and northing, whereas the first one puts it after. The parameters are 
>> otherwise the same.
>>
>> The questions are therefore:
>> Are the differences due to the use of "Mercator" and "Mercator_2SP"?
>> Can it be correct that we get different coordinates for the same 
>> epsg-code?
>> If not, which version should we trust, or how can we make sure that 
>> the same epsg-code refers to the same projection?
>
> As http://spatialreference.org/ref/sr-org/6864/ points out, this is a 
> rather broken configuration on a sphere. The definitions seem to be 
> identical in your cases, as a @null grid or zero towgs84 coefficients 
> will have the same effect. You could ask on the proj list, but my 
> intuition is that this is useful for display only, not for data transfer.
>
> Hope this clarifies,
>
> Roger

Roger,

If I understand the reference correct, this projection could cause 
errors in the order of 800 meters, while the ones we encountered are 
around 30 km. You are probably right that we should be careful with this 
projection and not use it without manual checking. I will also ask on 
the proj list and see if they can give some more information.

BTW, the proj4string from spatialreference.org also gives a 
y-transformation of points defined with epsg:3857 in R:
p1 = SpatialPoints(data.frame(x = 700000, y = 5700000), proj4string = 
CRS("+init=epsg:3857"))
p2 = spTransform(p1, CRS("+proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 
+a=6378137 +b=6378137 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"))
p1
p2

Thanks a lot for your help!
Jon

>
>>
>> Thanks,
>> Jon
>>
>> BTW:
>>> sessionInfo()
>> R version 2.15.0 (2012-03-30)
>> Platform: x86_64-pc-mingw32/x64 (64-bit)
>>
>> locale:
>> [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United 
>> States.1252
>> [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
>> [5] LC_TIME=English_United States.1252
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> other attached packages:
>> [1] rgdal_0.7-8 sp_0.9-98
>>
>> loaded via a namespace (and not attached):
>> [1] grid_2.15.0    lattice_0.20-6
>>> getPROJ4VersionInfo()
>> [1] "Rel. 4.7.1, 23 September 2009, [PJ_VERSION: 470]"
>>
>>
>


-- 
Jon Olav Sk?ien
Joint Research Centre - European Commission
Institute for Environment and Sustainability (IES)
Land Resource Management Unit

Via Fermi 2749, TP 440,  I-21027 Ispra (VA), ITALY

jon.skoien at jrc.ec.europa.eu
Tel:  +39 0332 789206

Disclaimer: Views expressed in this email are those of the individual and do not necessarily represent official views of the European Commission.


From Roger.Bivand at nhh.no  Thu May  3 10:50:18 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 3 May 2012 10:50:18 +0200 (CEST)
Subject: [R-sig-Geo] Projection problem (epsg 3857 - maybe not R-related)
In-Reply-To: <4FA23CAF.5080405@jrc.ec.europa.eu>
References: <4FA14734.3090005@jrc.ec.europa.eu>
	<alpine.LRH.2.02.1205021834370.3610@reclus.nhh.no>
	<4FA23CAF.5080405@jrc.ec.europa.eu>
Message-ID: <alpine.LRH.2.02.1205031043220.14764@reclus.nhh.no>

On Thu, 3 May 2012, Jon Olav Skoien wrote:

> On 02-May-12 18:39, Roger Bivand wrote:
>> On Wed, 2 May 2012, Jon Olav Skoien wrote:
>> 
>>> Hi,
>>> 
>>> We are having a problem with projections that we dont know the source of 
>>> (bugs in software or lack of understanding). The problem might not be 
>>> related to R, but I hope someone can still help. We have a set of data 
>>> (polygons and rasters) that are all supposed to be in projection epsg:3857 
>>> (WGS 84 / Pseudo-Mercator, often referred to as web mercator as it is used 
>>> in web services such as Google Maps). However, they do not appear to be 
>>> the same when using them in R. Below is an example that starts with a 
>>> hypothetical polygon somewhere in Europe, and then transforming it with 
>>> the three different proj4strings we got from the different objects :
>>> 
>>> cords = matrix(c( 650000, 700000, 700000, 650000, 650000, 5600000, 
>>> 5600000, 5700000, 5700000, 5600000), ncol = 2)
>>> pol = 
>>> SpatialPolygonsDataFrame(SpatialPolygons(list(Polygons(list(Polygon(cords)), 
>>> ID = "1")),
>>>    proj4string = CRS("+init=epsg:3857")), data = data.frame(test = 1))
>>> proj4string(pol)
>>> # [1] " +init=epsg:3857 +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 
>>> +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"
>>> # This is the proj4string that R creates from this epsg code
>>> 
>>> # Below are the proj4strings that we got from the imported objects
>>> # 1 is from an export and transformation from a postgis database of 
>>> polygons (latlong) with ogr2ogr and target crs epsg:3857
>>> # 2 is an export from the same data base with psql2shape
>>> # the same proj4strings were also generated from the .prj-files when 
>>> transforming with QGIS.
>>> # 3 is from a geoTIFF, and practically identical to the proj4string that R 
>>> generated from epsg:3857
>>> projs = list()
>>> projs[[1]] = " +proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +datum=WGS84 
>>> +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0"
>>> projs[[2]] = " +proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +a=6378137 
>>> +b=6378137 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"
>>> projs[[3]] = " +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 
>>> +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"
>>> 
>>> # Here we print the y-coordinate of the original polygon (centroid) 
>>> together with the y-coordinate
>>> # of the reprojected polygon. In addition we write the result to a 
>>> shapefile:
>>> pols = list()
>>> for (i in 1:3) {
>>>  pols[[i]] = spTransform(pol, CRS(projs[[i]]))
>>> #  writeOGR(pols[[i]], "e:/temp/Rtmp/polygons", paste("pol", i, sep = ""), 
>>> driver = "ESRI Shapefile")
>>>  print(paste(i, coordinates(pol)[,2], coordinates(pols[[i]])[,2]))
>>> }
>>> #[1] "1 5650000 5619680.01465088"
>>> #[1] "2 5650000 5619663.0232111"
>>> #[1] "3 5650000 5650000"
>>> 
>>> The writeOGR call above is to also be able to examine the .prj files. The 
>>> last two of these are:
>>> pol2.prj
>>> PROJCS["Mercator",GEOGCS["GCS_unnamed ellipse",DATUM["D_unknown", 
>>> SPHEROID["Unknown",6378137,0]],PRIMEM["Greenwich",0],
>>> UNIT["Degree",0.017453292519943295]], 
>>> PROJECTION["Mercator"],PARAMETER["central_meridian",0],
>>> PARAMETER["false_easting",0], 
>>> PARAMETER["false_northing",0],PARAMETER["standard_parallel_1",0.0],
>>> UNIT["Meter",1]]
>>> pol3.prj
>>> PROJCS["Mercator_2SP",GEOGCS["GCS_unnamed ellipse",DATUM["D_unknown", 
>>> SPHEROID["Unknown",6378137,0]],PRIMEM["Greenwich",0], 
>>> UNIT["Degree",0.017453292519943295]], 
>>> PROJECTION["Mercator_2SP"],PARAMETER["standard_parallel_1",0], 
>>> PARAMETER["central_meridian",0],PARAMETER["false_easting",0],
>>> PARAMETER["false_northing",0],UNIT["Meter",1]]
>>> 
>>> The only differences between these two are the PROJCS and PROJECTION 
>>> parameters, which are "Mercator" and "Mercator_2SP", respectively, and the 
>>> order of some parameters; the last one puts 
>>> PARAMETER["standard_parallel_1",0] before meridian and false easting and 
>>> northing, whereas the first one puts it after. The parameters are 
>>> otherwise the same.
>>> 
>>> The questions are therefore:
>>> Are the differences due to the use of "Mercator" and "Mercator_2SP"?
>>> Can it be correct that we get different coordinates for the same 
>>> epsg-code?
>>> If not, which version should we trust, or how can we make sure that the 
>>> same epsg-code refers to the same projection?
>> 
>> As http://spatialreference.org/ref/sr-org/6864/ points out, this is a 
>> rather broken configuration on a sphere. The definitions seem to be 
>> identical in your cases, as a @null grid or zero towgs84 coefficients will 
>> have the same effect. You could ask on the proj list, but my intuition is 
>> that this is useful for display only, not for data transfer.
>> 
>> Hope this clarifies,
>> 
>> Roger
>
> Roger,
>
> If I understand the reference correct, this projection could cause errors in 
> the order of 800 meters, while the ones we encountered are around 30 km. You 
> are probably right that we should be careful with this projection and not use 
> it without manual checking. I will also ask on the proj list and see if they 
> can give some more information.
>
> BTW, the proj4string from spatialreference.org also gives a y-transformation 
> of points defined with epsg:3857 in R:
> p1 = SpatialPoints(data.frame(x = 700000, y = 5700000), proj4string = 
> CRS("+init=epsg:3857"))
> p2 = spTransform(p1, CRS("+proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +a=6378137 
> +b=6378137 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"))
> p1
> p2

Yes, it does, which implies that +towgs84=0,0,0,0,0,0,0 and 
+nadgrids=@null are not equivalent in this case. Is it the minor axis 
difference in going from WGS84 to sphere that is changing y? I think that 
the proj list is the right place to follow this up, unless the final 
point on:

http://proj.maptools.org/faq.html

helps. As I read the FAQ, the definition including +towgs84= is probably 
wrong, and is forcing an understanding of +datum=WGS84. Has this changed 
between PROJ.4 releases?

Roger

>
> Thanks a lot for your help!
> Jon
>
>> 
>>> 
>>> Thanks,
>>> Jon
>>> 
>>> BTW:
>>>> sessionInfo()
>>> R version 2.15.0 (2012-03-30)
>>> Platform: x86_64-pc-mingw32/x64 (64-bit)
>>> 
>>> locale:
>>> [1] LC_COLLATE=English_United States.1252  LC_CTYPE=English_United 
>>> States.1252
>>> [3] LC_MONETARY=English_United States.1252 LC_NUMERIC=C
>>> [5] LC_TIME=English_United States.1252
>>> 
>>> attached base packages:
>>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>> 
>>> other attached packages:
>>> [1] rgdal_0.7-8 sp_0.9-98
>>> 
>>> loaded via a namespace (and not attached):
>>> [1] grid_2.15.0    lattice_0.20-6
>>>> getPROJ4VersionInfo()
>>> [1] "Rel. 4.7.1, 23 September 2009, [PJ_VERSION: 470]"
>>> 
>>> 
>> 
>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From smithtiffanyt at gmail.com  Thu May  3 16:56:57 2012
From: smithtiffanyt at gmail.com (tiffanysmith)
Date: Thu, 3 May 2012 07:56:57 -0700 (PDT)
Subject: [R-sig-Geo] gridded time series analysis
In-Reply-To: <AANLkTi=+3SAuZY0N_7aHcb14zAV3uvC8NN1RGKSou-09@mail.gmail.com>
References: <1290807311630-5778472.post@n2.nabble.com>
	<AANLkTimTdxzoDCfJQOB8bgQRhjLy3YzSbtGtMdijk9sQ@mail.gmail.com>
	<771411.8321.qm@web29709.mail.ird.yahoo.com>
	<AANLkTin2DYocWNOAR-LfGoBP4+gCtA7eVDHmoaQ6wriR@mail.gmail.com>
	<AANLkTimFw1zMH75s+TG+SFkBHfXzpURm2WXskAa8Kp=m@mail.gmail.com>
	<1290947619832-5781554.post@n2.nabble.com>
	<AANLkTi=RmjZMstKsUQiA-Ho9+v=a0L6cbrGnYG3ETYH3@mail.gmail.com>
	<1291023262728-5783724.post@n2.nabble.com>
	<1291024710318-5783798.post@n2.nabble.com>
	<AANLkTi=+3SAuZY0N_7aHcb14zAV3uvC8NN1RGKSou-09@mail.gmail.com>
Message-ID: <1336057017432-7523889.post@n2.nabble.com>

I've done the following linear regression of my gridded data vs. time:

data<-brick("data.nc")
time<-seq(1979,2011,1)
fun.lm<-function(x) {lm(x~time)$coefficients[2]} 
lm.data<-calc(data,fun.lm)

Then, I was trying to get the R^2 values, but keep getting an error:

> fun=function(x){if (in.na(x[1])){NA}else{m<-lm(x[1]~x[2])$coefficients[2];
> summary(m)$r.squared }}
> r2.data<-calc(data,fun)
Error in .local(x, fun, ...) : cannot use this function

How do I actually print out the R^2 values? Also, is there a way to mask the
output raster from the linear regression w. a 95%sig level?

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/gridded-time-series-analysis-tp5775651p7523889.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From rossiter at itc.nl  Thu May  3 17:21:05 2012
From: rossiter at itc.nl (David Rossiter)
Date: Thu, 3 May 2012 17:21:05 +0200
Subject: [R-sig-Geo] Harmonizing the sizes of side-by-side spplots
Message-ID: <ECD9692F-E9EC-4A36-B944-2FB3D2DBD9E4@itc.nl>

I often want to display two or more maps of the same area, prepared with spplot, side-by-side, but the sizes of the map do not match if (1) a legend is printed and (2) the width of the text in the legend is different. For example:

> require(gstat)
> data(jura)
> coordinates(jura.grid) <- ~ Xloc + Yloc
> gridded(jura.grid) <- T
>  fullgrid(jura.grid) <- T
> print(, split=c(1,1,2,1), more=T)
> p1 <- spplot(jura.grid, zcol="Landuse", col.regions=terrain.colors(4))
> p2 <- spplot(jura.grid, zcol="Rock", col.regions=bpy.colors(5))
> require(lattice)
> print(p1, split=c(1,1,2,1), more=T)
> print(p2, split=c(2,1,2,1), more=F)

Here, since the longest name of the rock types is longer than that of the landuse, the rock type map is smaller, to make room within the box for the legend.

(The same hapens if plotting kriging predictions next to their variances, if the numeric precision is not the same.)

I can get around the problem by adjusting the position within the box for the larger map:

print(p1, position=c(0.04,0.04,.96,.96), ?)

but this (1) requires a manual assessment (maybe I could do it automatically by looking at the legend categories?) and (2) seems a clumsy way to do this. I have waded through the

I've tried to use the panel.height and panel.width arguments to print.trellis, but without success:

> str(p.width <- lattice.getOption("layout.widths")$panel)
List of 3
 $ x    : num 1
 $ units: chr "null"
 $ data : NULL
> p.width <- list(0.9,"null",NULL)

But this (1) does not seem to affect the plots, (2) would probably only affect the whole panel, not just the map. I need to set the size of the map and legend separately.

I tried to present these as side-by-side levelplots, but since the levels are not the same this fails also:

> p3 <- spplot(jura.grid[c("Landuse","Rock")])
Error in stack.SpatialPointsDataFrame(as(data, "SpatialPointsDataFrame"),  :
  all factors should have identical levels

Thanks for any help,

D G Rossiter
Senior University Lecturer
Faculty of Geoinformation and Earth   Observation Science
Universiteit Twente.
Enschede (NL)


Faculty of Geo-Information Science and Earth Observation (ITC)
University of Twente
Chamber of Commerce: 501305360000

E-mail disclaimer
The information in this e-mail, including any attachments, is intended for the addressee only. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution or action in relation to the content of this information is strictly prohibited. If you have received this e-mail by mistake, please delete the message and any attachment and inform the sender by return e-mail. ITC accepts no liability for any error or omission in the message content or for damage of any kind that may arise as a result of e-mail transmission.


From kmcoulib at gmail.com  Thu May  3 18:44:24 2012
From: kmcoulib at gmail.com (kapo coulibaly)
Date: Thu, 3 May 2012 12:44:24 -0400
Subject: [R-sig-Geo] Help with readBin
Message-ID: <CANcefXYdkZDanwf-rmM10tTFkGL_QvQNCgWmbOdaC1ZE-GzOBg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120503/7809ca56/attachment.pl>

From r.hijmans at gmail.com  Thu May  3 18:49:20 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 3 May 2012 09:49:20 -0700
Subject: [R-sig-Geo] gridded time series analysis
In-Reply-To: <1336057017432-7523889.post@n2.nabble.com>
References: <1290807311630-5778472.post@n2.nabble.com>
	<AANLkTimTdxzoDCfJQOB8bgQRhjLy3YzSbtGtMdijk9sQ@mail.gmail.com>
	<771411.8321.qm@web29709.mail.ird.yahoo.com>
	<AANLkTin2DYocWNOAR-LfGoBP4+gCtA7eVDHmoaQ6wriR@mail.gmail.com>
	<AANLkTimFw1zMH75s+TG+SFkBHfXzpURm2WXskAa8Kp=m@mail.gmail.com>
	<1290947619832-5781554.post@n2.nabble.com>
	<AANLkTi=RmjZMstKsUQiA-Ho9+v=a0L6cbrGnYG3ETYH3@mail.gmail.com>
	<1291023262728-5783724.post@n2.nabble.com>
	<1291024710318-5783798.post@n2.nabble.com>
	<AANLkTi=+3SAuZY0N_7aHcb14zAV3uvC8NN1RGKSou-09@mail.gmail.com>
	<1336057017432-7523889.post@n2.nabble.com>
Message-ID: <CANtt_hw3gD7XO0=+kXCFkrNH=YYH=hN-hA2p9+YJn-g66hmMCw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120503/94e44ea3/attachment.pl>

From r.hijmans at gmail.com  Thu May  3 19:11:15 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 3 May 2012 10:11:15 -0700
Subject: [R-sig-Geo] {Text fixed} Best approach to process a massive
 ammount of MODIS data
In-Reply-To: <1335891038.23131.YahooMailClassic@web161403.mail.bf1.yahoo.com>
References: <1335891038.23131.YahooMailClassic@web161403.mail.bf1.yahoo.com>
Message-ID: <CANtt_hxBKnaH-7ztabtZRAkCL8ZmOpNOyJwKyGvWiuq+mPr7_Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120503/b79bba5c/attachment.pl>

From chmartin at ucdavis.edu  Thu May  3 21:55:20 2012
From: chmartin at ucdavis.edu (Chris Martin)
Date: Thu, 3 May 2012 12:55:20 -0700
Subject: [R-sig-Geo] spline question: nonparametric test to compare
 curvature of two surfaces using eff.df of thin-plate splines?
Message-ID: <CALRsq+nFZuAyuUtyNBp012rSMpu18gF_Acg4RcKNfqi4a_vwUg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120503/b8c3d635/attachment.pl>

From mathieu.rajerison at gmail.com  Fri May  4 08:53:02 2012
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Fri, 4 May 2012 08:53:02 +0200
Subject: [R-sig-Geo] Visibility Analysis in R
In-Reply-To: <CANVKczMA6goJ4f+o-11edGVZaZhNZ5EkxLdoT5DD6+yOs7Hx1w@mail.gmail.com>
References: <36404A35-C3BE-4B52-A244-56164058D259@gmail.com>
	<CANVKczMA6goJ4f+o-11edGVZaZhNZ5EkxLdoT5DD6+yOs7Hx1w@mail.gmail.com>
Message-ID: <CAGfc75m-TWo1Um0nq4N8yn7js95e0bvy4ZRWzd+o4oZYKo=AhQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120504/95484509/attachment.pl>

From Giovanni_Millo at Generali.com  Fri May  4 11:02:49 2012
From: Giovanni_Millo at Generali.com (Millo Giovanni)
Date: Fri, 4 May 2012 11:02:49 +0200
Subject: [R-sig-Geo] R: spml function and the spatial.error option
Message-ID: <28643F754DDB094D8A875617EC4398B20BE30486@BEMAILEXTV03.corp.generali.net>

Hello Ariel.
A short reply for now, as I don't have the time here to go through all
this. Will try to do it at home when I can.

----------
- Is it a matter of spatial weights? 

Don't think so, but I am not in a  position to answer yet

- Am I specifying the call for spml incorrectly? 

No, looks ok

- Why does the "p" "kkp" and "none" options return the same result? 

In FE spatial errors the individual component is eliminated; the
distinction between "b" and "kkp" is only relevant in RE. See the
JStatSoft paper referenced below. As for "none" -->

- Why is there a "rho" estimated in the case in which
spatial.error="none"?

Looks like a bug. Will check.

- Why is the "rho" reported in the "coefficients" table with my beta and
not
in a "Error variance parameters" table as it is shown here (page 9):
www.jstatsoft.org/v47/i01/paper

Different (slightly inconsistent) choice on the two developers' part.
Table shows an RE model.
-------

As for right/wrong results, this calls for a thorough investigation of
your Montecarlo. Our MC checks have been extensive, though, and the
estimators always worked fine (see section 8 in the referenced JStatSoft
47(1)).

Best,
Giovanni

------------- original message -----------------

Message: 4
Date: Wed, 2 May 2012 18:17:44 -0700 (PDT)
From: Ariel Ortiz-Bobea <aortizbobea at arec.umd.edu>
To: r-sig-geo at r-project.org
Subject: [R-sig-Geo] spml function and the spatial.error option
Message-ID: <1336007864752-7522051.post at n2.nabble.com>
Content-Type: text/plain; charset=us-ascii

Hi,

I'm trying to run a panel model (of N counties over T years) with
contemporaneous/spatial correlation in the errors. So this is a "spatial
error model" in this literature's terminology.

In order to explore this function I'm simulating spatially correlated
data
and errors and comparing it to the results from the plm() function with
some
Monte Carlo analysis.

However, I'm getting /exactly/ the same (wrong) results when specifying
"b"
or "kkp" or "none" in the spatial.error option. 

On the other hand, while the empirical distributions I get with spml()
are
more efficient (narrower) the standard errors I get are virtually
identical
to the "naive" standard errors returned by the plm canned routine.

You will find my reproducible example below, although you need to
download
the US shape file:
http://dl.dropbox.com/u/45311184/spatial/co99_d00.shp

So, my very broad question is, what's wrong? More specifically, 
- Is it a matter of spatial weights? 
- Am I specifying the call for spml incorrectly? 
- Why does the "p" "kkp" and "none" options return the same result? 
- Why is there a "rho" estimated in the case in which
spatial.error="none"?
- Why is the "rho" reported in the "coefficients" table with my beta and
not
in a "Error variance parameters" table as it is shown here (page 9):
www.jstatsoft.org/v47/i01/paper

Any help, hints, suggestions would be greatly appreciated.

Let's hope my question and code are clear enough!

Thanks,

Ariel

----------------------------------
----- CODE FROM HERE ON ----
----------------------------------

# Preliminary
#~~~~~~~~
library(rgdal)
library(spdep)
library(plm)
library(splm)

# download US shape file:
http://dl.dropbox.com/u/45311184/spatial/co99_d00.shp
counties  <- readOGR("co99_d00.shp","co99_d00")
counties  <- counties[counties$STATE %in% c("17"),] # only keep Illinois
for
the example
plot(counties)
n        <- length(counties at polygons) # number of counties

# Neigbhors and weights
nb  <- poly2nb(counties)
nbw <- nb2listw(nb, style="W") # Row-standardised weights

# Parameters
beta = matrix(1, nrow=1, ncol=1)
sig2 = 25

# creating spatial correlation
distmatrix <- spDists(counties, longlat = F)
SD <- max(distmatrix)/5 # standard deviation in m
Sigma1.nor <- distmatrix
Sigma1.nor <- dnorm(Sigma1.nor, mean=0,sd=SD) / dnorm(0,mean=0,sd=SD) 
Sigma1.nor <- sig2 * Sigma1.nor
Sigma1.nor[1:10,1:10]
rm(SD)

# Ability to generate multivariate normals
vs.nor       <- svd(Sigma1.nor) 
vcsqrt.nor   <- t(vs.nor$v %*% (t(vs.nor$u) * sqrt(vs.nor$d))) 
# function to generate multivariate normals 
mrnorm.nor <- function(num.vals, mu.vec) {
   k        <- ncol(Sigma1.nor)
   ans.mat  <- sweep(matrix(rnorm(num.vals*k), nrow = num.vals) %*%
vcsqrt.nor,2,mu.vec,"+") # 1 sec
   c(t(ans.mat))
}

# Artificial data:
#~~~~~~~~~

# Panel structure
years       <- 1980:2010     # time periods
t           <- length(years) # number of time periods
dataset     <- data.frame( fips        =
as.numeric(paste(counties at data$STATE, counties at data$COUNTY, sep="")),
                           year=rep(years, each=n) )
# The Xs
set.seed(1)
dataset$Xcor <- mrnorm.nor(t , rep(1,times=n) ) # generate
contemporaneously
correlated Xs over space
dataset$alpha<- rep(rnorm(n,mean=5,sd=sqrt(sig2)), times=t) # county
effect/intercept   
head(dataset)

# Mapping function 
choropleth <- function(dataframe, var, years, title,colors){   
   df     <- data.frame(matrix( dataframe[,var][dataframe$year %in%
years] ,
ncol=length(years)))
   names(df)   <- years
   temp   <- SpatialPolygonsDataFrame(counties,
data.frame(counties at data,
df))
   arrow = list("SpatialPolygonsRescale", layout.north.arrow(), offset =
c(-76,34), scale = 0.5, which = 2)
   spplot(temp, zcol= paste("X",years,sep=""), 
          par.settings = list(axis.line = list(col =  'transparent')), #
removes lines around plot
          names.attr = paste(years), # names on top of each panel e.g.
year
          col.regions = colorRampPalette(colors)(100), #cm.colors(100),
#,
heat.colors(), topo.colors()
          colorkey=list(space="right"), scales = list(draw = F), #
location
of legend
          main = title,
          sp.layout = list(arrow), as.table = TRUE)
}

# Visualize Xs for year 1995 for example
choropleth(dataset, "Xcor", 1995, "Correlated X for
1995",colors=c("blue","cyan","red"))
# Same thing for errors (note Xs and Errors are not correlated )
dataset$Ecor <- mrnorm.nor(t, rep(0,times=n))
choropleth(dataset, "Ecor", 1995, "Spatially correlated errors - 1995",
colors=c("red","white","black"))

# Compute theoretical standard errors for beta
Sigma.nor    <- bdiag(lapply(1:t, function(x) Sigma1.nor) ) # block
diagonal
covariance matrix
D  <- outer(dataset$fips, unique(dataset$fips), "==") + 0   #
fixed-effect
dummy matrix
colnames(D) <- paste(unique(dataset$fips))
Z <- cbind(dataset$Xcor, D) # the regressor matrix
ZZ_inv <- solve(t(Z)  %*% Z)
vcov <- ZZ_inv %*% t(Z) %*% Sigma.nor %*% Z %*% ZZ_inv
rm(Z,D)
sqrt(vcov[1,1]) # teh correct standard error of beta


# Monte carlo analysis:
#~~~~~~~~~~~~~~
ndraws <-  200
fitfe.bsave  = matrix(0, nrow=ndraws, ncol=4) 
fitfe.sesave = matrix(0, nrow=ndraws, ncol=4)
# Monte Carlo experiment
system.time({ # takes ~120 secs for 200 draws in my 3-year old computer
   for (i in 1:ndraws) {  
      print(i)
      # Generate vector of errors
         Ecor <- mrnorm.nor(t, rep(0,times=n))
      # Compute the implied y variable
         dataset$y      <- as.matrix(dataset[,c("Xcor")]) %*% beta +
dataset$alpha + Ecor         
      # Run regressions
         fitfe      <-  plm( y ~ Xcor, data = dataset, model="within",
index
= c("fips","year"))
         fitfe.b    <- spml(formula = y ~ Xcor, data = dataset,
model="within", index = c("fips","year"), listw = nbw, lag = FALSE,
spatial.error = "b")
         fitfe.kkp  <- spml(formula = y ~ Xcor, data = dataset,
model="within", index = c("fips","year"), listw = nbw, lag = FALSE,
spatial.error = "kkp")
         fitfe.none <- spml(formula = y ~ Xcor, data = dataset,
model="within", index = c("fips","year"), listw = nbw, lag = FALSE,
spatial.error = "none")
      # Save 
         fitfe.bsave[i,1]  <- coefficients(fitfe)
         fitfe.sesave[i,1] <- sqrt(diag(vcov(fitfe)))
         fitfe.bsave[i,2]  <- fitfe.b$coefficients[2]
         fitfe.sesave[i,2] <- sqrt(fitfe.b$vcov[2,2])
         fitfe.bsave[i,3]  <- fitfe.kkp$coefficients[2]
         fitfe.sesave[i,3] <- sqrt(fitfe.kkp$vcov[2,2])
         fitfe.bsave[i,4]  <- fitfe.none$coefficients[2]
         fitfe.sesave[i,4] <- sqrt(fitfe.none$vcov[2,2])
      # Clean up
         dataset$y      <- NULL
   }
})

# Something I dont understand: why is there a "rho" estimated in the
model
where spatial.error="none"?
# Also, why is this rho in the coefficients table and not in a error
parameters table by itself?
summary(fitfe.none)

# Visualize:
#~~~~~~~~~~~

# Initial plot: distribution of beta with Xcor and Ecor
plot( density(fitfe.bsave[,1]),  ylim=c(0,10), xlim=c(0.8,1.3),
type="l",
lwd=2, col= "black", xlab="coefficient", ylab="density",
main=paste("Monte
Carlo analysis - ",ndraws,"draws"))

# Theoretical distribution of beta
lines(seq(beta-2,beta+2,0.0001), dnorm( seq(beta-2,beta+2,0.0001),
mean=beta, sd= sqrt(vcov[1,1])) ,lty="dashed", col="black",lwd=2)


# Average "naive" distributions from canned FE routine
lines(seq(beta-2,beta+2,0.0001), dnorm( seq(beta-2,beta+2,0.0001),
mean=mean(fitfe.bsave[,1]), sd= mean(fitfe.sesave[,1] )),lty="solid",
col="red",lwd=2) 

# Empirical Spatial Error Model (SER) distribution of beta 
lines(density(fitfe.bsave[,2]),lty="solid", col="blue",lwd=2) # option
"b"
lines(density(fitfe.bsave[,3]),lty="solid", col="blue",lwd=2) # option
"kkp"
lines(density(fitfe.bsave[,4]),lty="solid", col="blue",lwd=2) # option
"none"

# Average Spatial Error Model (SER) distribution of beta from canned
routine
lines(seq(beta-2,beta+2,0.0001), dnorm( seq(beta-2,beta+2,0.0001),
mean=mean(fitfe.bsave[,2]), sd= mean(fitfe.sesave[,2] )),lty="solid",
col="cyan",lwd=2) # option "b"
lines(seq(beta-2,beta+2,0.0001), dnorm( seq(beta-2,beta+2,0.0001),
mean=mean(fitfe.bsave[,2]), sd= mean(fitfe.sesave[,3] )),lty="solid",
col="cyan",lwd=2) # option "kkp"
lines(seq(beta-2,beta+2,0.0001), dnorm( seq(beta-2,beta+2,0.0001),
mean=mean(fitfe.bsave[,2]), sd= mean(fitfe.sesave[,4] )),lty="solid",
col="cyan",lwd=2) # option "none"

# Legend and reference line
legend("topright", cex=0.7, title= "Distribution of beta",
legend=c("Empirical FE", "Theoretical FE", "Avg. naive FE", "Empirical
SER
(3 lines)", "Avg. reported SER (3 lines)"),
lty=c("solid","dashed","solid","solid","solid"),
lwd=2,col=c("black","black","red","blue","cyan"))
abline(v=beta, lty=3)



-----
Ariel Ortiz-Bobea
PhD Candidate in Agricultural & Resource Economics
University of Maryland - College Park
--
View this message in context:
http://r-sig-geo.2731867.n2.nabble.com/spml-function-and-the-spatial-err
or-option-tp7522051.html
Sent from the R-sig-geo mailing list archive at Nabble.com.



------------- end original message -----------------

?
Ai sensi del D.Lgs. 196/2003 si precisa che le informazi...{{dropped:12}}


From spareeth at gmail.com  Fri May  4 11:05:49 2012
From: spareeth at gmail.com (sajid pareeth)
Date: Fri, 4 May 2012 14:35:49 +0530
Subject: [R-sig-Geo] Clustering of time series data...Using R
Message-ID: <CAO7vHBFzOqLx74AhTju+Jh+vz43HMBDsr_cGnF2XdRivxMhQaw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120504/00ecb97f/attachment.pl>

From imranserver at yahoo.com  Fri May  4 13:39:43 2012
From: imranserver at yahoo.com (Muhammad Imran)
Date: Fri, 4 May 2012 04:39:43 -0700 (PDT)
Subject: [R-sig-Geo] OK smoothing effect
Message-ID: <1336131583.51650.YahooMailClassic@web161306.mail.bf1.yahoo.com>


Hi list members,

It is wekk known that OK tends to smooth the spatial variation of a variable; in particular they overestimate small values and underestimate large values. What should I percieve if I am getting a revserse effect after krging i.e. underestimated small values and overestimated large values.

regards,
Imran


From lalitathakali at gmail.com  Fri May  4 14:20:44 2012
From: lalitathakali at gmail.com (Lalita Thakali)
Date: Fri, 4 May 2012 08:20:44 -0400
Subject: [R-sig-Geo] Integrating R and Arcgis
Message-ID: <CAGDt=deKjRfa3=-u8F=3Ligc=892DOVcc5TC=HxoFFmDLgb69A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120504/be2dbd1e/attachment.pl>

From Maximilian.Spross at uibk.ac.at  Fri May  4 18:25:40 2012
From: Maximilian.Spross at uibk.ac.at (=?ISO-8859-1?Q?Maximilian_Spro=DF?=)
Date: Fri, 04 May 2012 18:25:40 +0200
Subject: [R-sig-Geo] Missing local R-squared and residuals in gwr output
In-Reply-To: <4FA3FF6A.3090005@uibk.ac.at>
References: <4FA3FF6A.3090005@uibk.ac.at>
Message-ID: <4FA40304.2050503@uibk.ac.at>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120504/fa6cdb18/attachment.pl>

From afischbach at usgs.gov  Fri May  4 18:37:55 2012
From: afischbach at usgs.gov (Anthony Fischbach)
Date: Fri, 4 May 2012 09:37:55 -0700 (PDT)
Subject: [R-sig-Geo] Cropping a set of points with a polygon
In-Reply-To: <4FA0F762.8000307@tum.de>
References: <CAFFLneTFPY7uJ=JVAft2o5OzBG_HTJJoWNprZ3CY3dgJ9qusiA@mail.gmail.com>
	<4FA0F762.8000307@tum.de>
Message-ID: <1336149475642-7527731.post@n2.nabble.com>

You may use something like this.
X.prj<-spTransform(X, proj4string(pointsDF))     ## project polygons to the
points coordinate system
pointsDF.over<-over(x=pointsDF, y=X.prj)	## perform GIS over lay opperation

-----
Tony Fischbach, Wildlife Biologist
Walrus Research Program
Alaska Science Center
U.S. Geological Survey
4210 University Drive
Anchorage, AK 99508-4650

AFischbach at usgs.gov
http://alaska.usgs.gov/science/biology/walrus
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Cropping-a-set-of-points-with-a-polygon-tp7515947p7527731.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From moshersteven at gmail.com  Fri May  4 19:18:10 2012
From: moshersteven at gmail.com (steven mosher)
Date: Fri, 4 May 2012 10:18:10 -0700
Subject: [R-sig-Geo] Cropping a set of points with a polygon
In-Reply-To: <1336149475642-7527731.post@n2.nabble.com>
References: <CAFFLneTFPY7uJ=JVAft2o5OzBG_HTJJoWNprZ3CY3dgJ9qusiA@mail.gmail.com>
	<4FA0F762.8000307@tum.de> <1336149475642-7527731.post@n2.nabble.com>
Message-ID: <CAFFLneQiYEX0zfobHMDHxPJ07aA=yAYTnq19F8Mm4JAR3ftA6w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120504/c8bd0c0b/attachment.pl>

From tephilippi at gmail.com  Fri May  4 19:20:22 2012
From: tephilippi at gmail.com (Tom Philippi)
Date: Fri, 4 May 2012 11:20:22 -0600
Subject: [R-sig-Geo] Integrating R and Arcgis
In-Reply-To: <CAGDt=deKjRfa3=-u8F=3Ligc=892DOVcc5TC=HxoFFmDLgb69A@mail.gmail.com>
References: <CAGDt=deKjRfa3=-u8F=3Ligc=892DOVcc5TC=HxoFFmDLgb69A@mail.gmail.com>
Message-ID: <CALyPt8wd3R5Lg1sbFHQh1JZ5SvBfsrDZQVdjC+pT-32KEWqyBQ@mail.gmail.com>

You may want to look at GME, Geospatial Modeling Environment,
Hawthorne Bayer's successor to Hawth's Tools.  It allows you to run
your own arbitrary R code from within ArcMap, as well as providing
simple function wrappers for several common tasks.  One potential
issue is that it uses statconnDCOM, which is not licensed for all
uses.

I have ended up doing almost nothing in ArcMap: the tools in the sp,
rgdal, raster, and gbclib packages do everything I need, and  in most
cases are substantially faster than even python & ESRI geoprocessing
tools.  YMMV.

Tom 2

On Fri, May 4, 2012 at 6:20 AM, Lalita Thakali <lalitathakali at gmail.com> wrote:
> Hi,
>
> I am very new to R. Would anyone help me how R can be used for spatial
> analysis in Arcgis. I will really appreciate for any information related to
> using R in arcgis or integrating R in Arcgis.
>
> Thanks.
> Regards,
> Lalita
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From moshersteven at gmail.com  Sat May  5 04:51:21 2012
From: moshersteven at gmail.com (steven mosher)
Date: Fri, 4 May 2012 19:51:21 -0700
Subject: [R-sig-Geo] Cropping a set of points with a polygon
In-Reply-To: <4FA0F762.8000307@tum.de>
References: <CAFFLneTFPY7uJ=JVAft2o5OzBG_HTJJoWNprZ3CY3dgJ9qusiA@mail.gmail.com>
	<4FA0F762.8000307@tum.de>
Message-ID: <CAFFLneRdy4PXNTPbcXPH5XSa+yS0vjYkQE11F1GKDseqPgp_zA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120504/60d5fa26/attachment.pl>

From Martin at Hvidberg.net  Sat May  5 13:49:08 2012
From: Martin at Hvidberg.net (Martin Hvidberg)
Date: Sat, 05 May 2012 13:49:08 +0200
Subject: [R-sig-Geo] Re.: Integrating R and Arcgis
Message-ID: <4FA513B4.5050702@Hvidberg.net>

Hi Lalita

The short answer to your question is: Only through Python scripting.

Python is rapidly growing in the Esri world/community. The (soon) to be 
released ver. 10.1 have even more Python possibilities.

To see an example on how to write and execute an R call, from inside 
ArcGIS (ver. 10.0) , please look at this page from on-line help.

"Integrating external programs within ModelBuilder"
http://help.arcgis.com/en/arcgisdesktop/10.0/help/index.html#//002w0000007w000000

Best Regards & Please share what you learn
Martin Hvidberg


From geotux_tuxman at linuxmail.org  Sat May  5 14:12:57 2012
From: geotux_tuxman at linuxmail.org (geotux_tuxman at linuxmail.org)
Date: Sat, 05 May 2012 08:12:57 -0400
Subject: [R-sig-Geo] Re.: Integrating R and Arcgis
Message-ID: <20120505121257.227100@gmx.com>

Hi Lalita,

even though I don't promote ArcGIS at all, I would suggest you having a look at this document [1] about Interfacing R and ArcGIS with Python, as well as the resources it points out.

As you can see, the interface allows you to expose an R script as an ArcGIS Geoprocessing Tool, which you could run inside ArcMap. As Martin commented, it is based on ArcGIS v.10.1.

Regards,

Germ?n Carrillo

-----------------
[1] http://ifgibox.de/g_carr02/Interfacing_R_and_ArcGIS_with_Python.pdf

 
 ?----- Original Message -----
 ?From: Martin Hvidberg
 ?Sent: 05/05/12 01:49 PM
 ?To: r-sig-geo at r-project.org
 ?Subject: [R-sig-Geo] Re.: Integrating R and Arcgis
 
 ? 
Hi Lalita

The short answer to your question is: Only through Python scripting.

Python is rapidly growing in the Esri world/community. The (soon) to be 
released ver. 10.1 have even more Python possibilities.

To see an example on how to write and execute an R call, from inside 
ArcGIS (ver. 10.0) , please look at this page from on-line help.

"Integrating external programs within ModelBuilder"
http://help.arcgis.com/en/arcgisdesktop/10.0/help/index.html#//002w0000007w000000

Best Regards & Please share what you learn
Martin Hvidberg

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo ? 

 --
-----------
??\__?
(:>__)(
??/???
Soluciones?Geoinform?ticas?Libres????????????????????????????
http://geotux.tuxfamily.org
http://twitter.com/GeoTux2


From Roger.Bivand at nhh.no  Sat May  5 16:24:04 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 5 May 2012 16:24:04 +0200 (CEST)
Subject: [R-sig-Geo] Missing local R-squared and residuals in gwr output
In-Reply-To: <4FA40304.2050503@uibk.ac.at>
References: <4FA3FF6A.3090005@uibk.ac.at> <4FA40304.2050503@uibk.ac.at>
Message-ID: <alpine.LRH.2.02.1205051616590.27123@reclus.nhh.no>

On Fri, 4 May 2012, Maximilian Spro? wrote:

> Dear r-sig-geo list!
>
> I run gwr on a multi-node cluster(on 64 slots). In the gwr output (slot
> "SDF"), the gwr residuals and the local R-squared are missing. When
> performing the same model on the local machine, these components are
> included. Unfortunately, the calculation in this way takes about 5 days
> instead of few hours when using the cluster.
>
> Perhaps, that problem arises due to the argument "fit.points", which has
> to be passed if the local coefficient estimates should be made on a
> multi node cluster.
>
> Does anyone have an idea how to solve that problem with the missing
> local R-squared and residuals if the gwr is calculated on a cluster?

The understanding for use on a cluster was that the data points and the 
fit points are different, so there is no observed dependent variable at 
the fit point, hence no local R2. I've added logic in the code that checks 
for equality between the fit and data points, and this for me resolves the 
problem, but may break other things. I've committed to R-forge, project 
rspatial, module spgwr. The source tarball and binary packages should be 
available later this evening European time from:

https://r-forge.r-project.org/R/?group_id=1014

Could you please try it out, and report back? I should also migrate spgwr 
from snow to parallel before I release it.

Best wishes,

Roger

>
>
> Thank you very much in advance!
>
> Kind regards,
>
> Max
>
>
> selected R-code:
>
> ### gwr on local machine:
>
> gwr_50 <-
> gwr(hef at data$DIF~hef at data$ELEVATION+hef at data$SKY+hef at data$SLOPE+hef at data$SOLAR,
> data=hef, bandwidth=50, gweight=gwr.Gauss)
>
>
> # part of the  str(gwr_50) output...
>
>
> List of 11
>  $ SDF      :Formal class 'SpatialPointsDataFrame' [package "sp"] with 5 slots
>   .. ..@ data       :'data.frame':	286288 obs. of  9 variables:
>   .. .. ..$ sum.w      : num [1:286288] 2009 2003 2091 2089 2086 ...
>   .. .. ..$ (Intercept): num [1:286288] -28.7 -28.5 -29.9 -29.7 -29.5 ...
>   .. .. ..$ elevation  : num [1:286288] 0.0139 0.0138 0.014 0.014 0.014 ...
>   .. .. ..$ sky        : num [1:286288] -0.153 -0.155 -0.146 -0.148 -0.149 ...
>   .. .. ..$ slope      : num [1:286288] -2.58 -2.61 -2.42 -2.45 -2.48 ...
>   .. .. ..$ solar      : num [1:286288] -0.00139 -0.00136 -0.0015 -0.00147 -0.00144 ...
>   .. .. ..$ gwr.e      : num [1:286288] -0.461 -0.683 -0.5987 -0.2692 0.0406 ...
>   .. .. ..$ pred       : num [1:286288] 0.806 0.833 0.507 0.514 0.576 ...
>   .. .. ..$ localR2    : num [1:286288] 0.621 0.618 0.638 0.635 0.632 ...
>
>
>
>
> ### gwr on cluster :
>
> cl <- makeCluster(32, type="MPI")
>
> coords <- coordinates(hef)
>
> gw <-
> gwr(hef at data$DIF~hef at data$ELEVATION+hef at data$SKY+hef at data$SLOPE+hef at data$SOLAR,
> data=hef, bandwidth=50, gweight=gwr.Gauss,fit.points=coords,
> hatmatrix=FALSE, cl=cl)
>
> # part of the  str(gwr_50) output...
>
> List of 11
>  $ SDF      :Formal class 'SpatialPointsDataFrame' [package "sp"] with 5 slots
>   .. ..@ data       :'data.frame':	286288 obs. of  6 variables:
>   .. .. ..$ sum.w      : num [1:286288] 1 1 1 1 1 ...
>   .. .. ..$ (Intercept): num [1:286288] 12541 1970 2057 -1505 -1030 ...
>   .. .. ..$ elevation  : num [1:286288] -3.891 -0.602 -0.738 0.465 0.309 ...
>   .. .. ..$ sky        : num [1:286288] -0.954 -0.425 3.714 0.159 0.152 ...
>   .. .. ..$ slope      : num [1:286288] 62.19 NA -27.21 1.95 16.03 ...
>   .. .. ..$ solar      : num [1:286288] NA NA NA NA 0.042 ...
>
>
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From edzer.pebesma at uni-muenster.de  Sat May  5 21:17:48 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sat, 05 May 2012 21:17:48 +0200
Subject: [R-sig-Geo] Harmonizing the sizes of side-by-side spplots
In-Reply-To: <ECD9692F-E9EC-4A36-B944-2FB3D2DBD9E4@itc.nl>
References: <ECD9692F-E9EC-4A36-B944-2FB3D2DBD9E4@itc.nl>
Message-ID: <4FA57CDC.8030708@uni-muenster.de>

With the help of Deepayan Sarkar, lattice_0.20-7 (on r-forge) lets you
control the key widths; the following two examples (different sized key
right, key bottom) come out with identical map extents (cartographic
scales). Thanks Deepayan!

require(gstat)
data(jura)
coordinates(jura.grid) <- ~ Xloc + Yloc
gridded(jura.grid) <- T
fullgrid(jura.grid) <- T
p1 <- spplot(jura.grid, zcol="Landuse", col.regions=terrain.colors(4))
p2 <- spplot(jura.grid, zcol="Rock", col.regions=bpy.colors(5))
require(lattice)
print(p1, split=c(1,1,2,1), more=T)
print(p2, split=c(2,1,2,1), more=F)

oopt <- lattice.options()
lattice.options(layout.widths =
        list(key.right = list(x = 3,
                 units = "cm", data = NULL)))
print(p1, split=c(1,1,2,1), more=T)
print(p2, split=c(2,1,2,1), more=F)
lattice.options(oopt)

loadMeuse()
p3 = spplot(meuse, "zinc", col.regions = bpy.colors())
p4 = spplot(meuse, "zinc", col.regions = bpy.colors(), cuts = 7)

print(p3, split=c(1,1,2,1), more=T)
print(p4, split=c(2,1,2,1), more=F)

oopt <- lattice.options()
lattice.options(layout.heights =
        list(key.bottom = list(x = 4,
                 units = "cm", data = NULL)))
print(p3, split=c(1,1,2,1), more=T)
print(p4, split=c(2,1,2,1), more=F)
lattice.options(oopt)


On 05/03/2012 05:21 PM, David Rossiter wrote:
> I often want to display two or more maps of the same area, prepared with spplot, side-by-side, but the sizes of the map do not match if (1) a legend is printed and (2) the width of the text in the legend is different. For example:
> 
>> require(gstat)
>> data(jura)
>> coordinates(jura.grid) <- ~ Xloc + Yloc
>> gridded(jura.grid) <- T
>>  fullgrid(jura.grid) <- T
>> print(, split=c(1,1,2,1), more=T)
>> p1 <- spplot(jura.grid, zcol="Landuse", col.regions=terrain.colors(4))
>> p2 <- spplot(jura.grid, zcol="Rock", col.regions=bpy.colors(5))
>> require(lattice)
>> print(p1, split=c(1,1,2,1), more=T)
>> print(p2, split=c(2,1,2,1), more=F)
> 
> Here, since the longest name of the rock types is longer than that of the landuse, the rock type map is smaller, to make room within the box for the legend.
> 
> (The same hapens if plotting kriging predictions next to their variances, if the numeric precision is not the same.)
> 
> I can get around the problem by adjusting the position within the box for the larger map:
> 
> print(p1, position=c(0.04,0.04,.96,.96), ?)
> 
> but this (1) requires a manual assessment (maybe I could do it automatically by looking at the legend categories?) and (2) seems a clumsy way to do this. I have waded through the
> 
> I've tried to use the panel.height and panel.width arguments to print.trellis, but without success:
> 
>> str(p.width <- lattice.getOption("layout.widths")$panel)
> List of 3
>  $ x    : num 1
>  $ units: chr "null"
>  $ data : NULL
>> p.width <- list(0.9,"null",NULL)
> 
> But this (1) does not seem to affect the plots, (2) would probably only affect the whole panel, not just the map. I need to set the size of the map and legend separately.
> 
> I tried to present these as side-by-side levelplots, but since the levels are not the same this fails also:
> 
>> p3 <- spplot(jura.grid[c("Landuse","Rock")])
> Error in stack.SpatialPointsDataFrame(as(data, "SpatialPointsDataFrame"),  :
>   all factors should have identical levels
> 
> Thanks for any help,
> 
> D G Rossiter
> Senior University Lecturer
> Faculty of Geoinformation and Earth   Observation Science
> Universiteit Twente.
> Enschede (NL)
> 
> 
> Faculty of Geo-Information Science and Earth Observation (ITC)
> University of Twente
> Chamber of Commerce: 501305360000
> 
> E-mail disclaimer
> The information in this e-mail, including any attachments, is intended for the addressee only. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution or action in relation to the content of this information is strictly prohibited. If you have received this e-mail by mistake, please delete the message and any attachment and inform the sender by return e-mail. ITC accepts no liability for any error or omission in the message content or for damage of any kind that may arise as a result of e-mail transmission.
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From j2kennel at gmail.com  Sun May  6 03:33:22 2012
From: j2kennel at gmail.com (Jonathan Kennel)
Date: Sat, 5 May 2012 21:33:22 -0400
Subject: [R-sig-Geo] Raster package: reading in time values from raster stack
Message-ID: <CABP0dEjQ_y9vh0b0XT9jmgr7tOxdvNDx5VyD2dHe-b7EfTQtZA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120505/b4e4a437/attachment.pl>

From dr_achughes at hotmail.co.uk  Sun May  6 20:44:12 2012
From: dr_achughes at hotmail.co.uk (alice Hughes)
Date: Sun, 6 May 2012 19:44:12 +0100
Subject: [R-sig-Geo] Overlapping area Script
In-Reply-To: <SNT143-W57654C2A7A20EB9D1510ECDD120@phx.gbl>
References: <4F3DFE8B.6030903@uni-muenster.de>,
	<CAEewEpg_D_1xaLo+RyT6SyVpDjn094C3hO57Ykz02mG8isgpdw@mail.gmail.com>,
	<alpine.LRH.2.02.1202171209110.24394@reclus.nhh.no>,
	<SNT143-W57654C2A7A20EB9D1510ECDD120@phx.gbl>
Message-ID: <SNT143-W262C7D61A56F2A291C421EDD120@phx.gbl>


Dear All

I would really appreciate some help with a script which a colleague wrote for me, but I am having problems running (and have not been able to contact my colleague).The script is designed to compare the area of suitable habitat in binary projections of a large number of species current and future distributions, and create an excel file detailing the total area suitable in the present and future scenario, in addition to the area which overlaps.These maps are made from Maxent outputs, which have been reclassified to give binary projections for each species and will be used to assess how climatic change may potentially effect the total area which is suitable for each species. However despite considerable effort I cannot get the attached script to run. It creates an excel with the first species current and future areas of suitable extent detailed, but "NA" for overlap, then gives error warnings (shown below), but changes I have tried have failed to make the script run any further (though I have generated new error messages...)Any help or advice would be very greatly appreciated, I can also send some example files of current and future distributions if anyone thinks they maybe able to help.Thanks and best wishes
Alice C Hughes 

"+ png(paste(out.dir, spp,'_overlap.png', sep=''), width=nrow(spp.asc),height=ncol(spp.asc), units='px', res=300, pointsize=5, bg='white') #start the plot+ par(mar=c(0,0,0,0)+0.1) #remove any plot margins+ image(overlap, ann=FALSE,axes=FALSE,col=cols, zlim=c(0,3)) #plot the richness+ legend.gradient(legend.pnts,cols=cols,limits=c(0,3), title='overlap', cex=2)+ dev.off()+ }Error in nrow(spp.asc) : object 'bat.asc' not foundIn addition: There were 12 warnings (use warnings() to see them)> > write.csv(overlap.matrix, paste(out.dir, "all_species.csv",sep=''))> "
Date: Fri, 17 Feb 2012 12:18:55 +0100
From: Roger.Bivand at nhh.no
To: michael.denslow at gmail.com
CC: r-sig-geo at r-project.org; skopp at esri.com
Subject: Re: [R-sig-Geo] R / ArcGIS

On Fri, 17 Feb 2012, Michael Denslow wrote:
 
> On Fri, Feb 17, 2012 at 2:15 AM, Edzer Pebesma
> <edzer.pebesma at uni-muenster.de> wrote:
>> Hi,
>>
>> I might succeed meeting with some ESRI / ArcGIS folks at AAG next week;
>> I'm in touch with them in particular about linking R to ArcGIS.
>>
>> I would like to find out if any of you has been successful (or
>> unsuccessful) in reading or writing ArcGIS geodatabase files directly
>> from R, by using the rgdal driver, or by some other means.
>
> Thanks for working on this. I have had success reading .mdb files but
> not .gdb files. I typically use rgdal for this sort of thing. I was
> under the impression that GDAL support for .gdb files started with
> 1.9.
 
This is off-topic here - the topic here is space-time data.
 
Your question is answered with respect to Personal geodatabases on the 
Windows platform in thread:
 
http://article.gmane.org/gmane.comp.lang.r.geo/13571
 
(link to gmane because it crosses a month boundary). You did join that 
thread, and said there that you are using OSX. You were able to open Pgeo 
files, I think. Are you thinking of the new file geodatabase format? If 
you read:
 
http://www.gdal.org/ogr/drv_filegdb.html
 
you will see that you must build GDAL linking to the proprietary FileGDB 
API SDK, which requires an ESRI global account. Reading the OGR format 
file would tell you that, no?
 
Roger
 
>
> I am very interested in this issue since I am a regular user of ArcGIS
> (teaching) and R (research).
>
> Michael
>
>
>>
>> Another issue is reading/writing spatio-temporal features  (netcdf does
>> spatio-temporal grids/arrays pretty well it seems); rumours go that
>> ArcGIS might, in the near future, support reading/writing SpatiaLite.
>>
>> With best regards,
>> --
>> Edzer Pebesma
>> Institute for Geoinformatics (ifgi), University of M?nster
>> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
>> 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
>> http://www.52north.org/geostatistics      e.pebesma at wwu.de
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>
>
>
 
-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo 		 	   		   		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120506/a2b53559/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: area2 (3).r
Type: application/octet-stream
Size: 3046 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120506/a2b53559/attachment.obj>

From HodgessE at uhd.edu  Sun May  6 20:52:55 2012
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Sun, 6 May 2012 13:52:55 -0500
Subject: [R-sig-Geo] getting pictures from an online webcam as jpeg
Message-ID: <586A4828D7AAA04CA9B258C50A28DA200BF5919F@BALI.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120506/385e32db/attachment.pl>

From HodgessE at uhd.edu  Sun May  6 20:57:36 2012
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Sun, 6 May 2012 13:57:36 -0500
Subject: [R-sig-Geo] getting pictures from an online webcam as jpeg: solved
Message-ID: <586A4828D7AAA04CA9B258C50A28DA200BF591A0@BALI.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120506/3dd98e98/attachment.pl>

From alobolistas at gmail.com  Sun May  6 21:13:12 2012
From: alobolistas at gmail.com (Agustin Lobo)
Date: Sun, 6 May 2012 21:13:12 +0200
Subject: [R-sig-Geo] SimpleITK from within R
Message-ID: <CAG4NReJahhESsnu+f2FitGBbfHhu_kwgjWpgaMUp3VuAP9o10A@mail.gmail.com>

Luis Iba?ez, one of the leading developers of the ITK image processing
library, gave an excellent seminar on ITK and SimpleITK in Barcelona
http://www.itk.org/itkindex.html
http://www.simpleitk.org/

We could try SimpleITK, which implements ITK for being used within python.
Luis also mentioned the current efforts to have SimpleITK from
within R:
http://www.itk.org/SimpleITKDoxygen/html/Wrapping.html

Considering SimpleITK works nicely within python,
perhaps package rpy2 could also be a way.

Just to let everyone in this list know about this exciting possibility.

Agus


From pierre.roudier at gmail.com  Mon May  7 02:17:03 2012
From: pierre.roudier at gmail.com (Pierre Roudier)
Date: Mon, 7 May 2012 12:17:03 +1200
Subject: [R-sig-Geo] SimpleITK from within R
In-Reply-To: <CAG4NReJahhESsnu+f2FitGBbfHhu_kwgjWpgaMUp3VuAP9o10A@mail.gmail.com>
References: <CAG4NReJahhESsnu+f2FitGBbfHhu_kwgjWpgaMUp3VuAP9o10A@mail.gmail.com>
Message-ID: <CADLQFsM+ThhLP6x4iQ3rpOdv-RzDx06-6jcTUY+iBGOEQQfdYA@mail.gmail.com>

Thanks for these links Agustin,

I've been wondering how difficult it would be to wrap ITK (and/or OTB)
for R using Rcpp - AFAIK these are C++ libraries and Rcpp is a really
helpful piece of code for that sort of tasks.

Pierre

2012/5/7 Agustin Lobo <alobolistas at gmail.com>:
> Luis Iba?ez, one of the leading developers of the ITK image processing
> library, gave an excellent seminar on ITK and SimpleITK in Barcelona
> http://www.itk.org/itkindex.html
> http://www.simpleitk.org/
>
> We could try SimpleITK, which implements ITK for being used within python.
> Luis also mentioned the current efforts to have SimpleITK from
> within R:
> http://www.itk.org/SimpleITKDoxygen/html/Wrapping.html
>
> Considering SimpleITK works nicely within python,
> perhaps package rpy2 could also be a way.
>
> Just to let everyone in this list know about this exciting possibility.
>
> Agus
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Scientist
Landcare Research, New Zealand


From julian at hafro.is  Mon May  7 13:44:52 2012
From: julian at hafro.is (Julian Burgos)
Date: Mon, 07 May 2012 11:44:52 +0000
Subject: [R-sig-Geo] problem with expand function (raster package)
Message-ID: <4FA7B5B4.4000901@hafro.is>

Dear list,

I cannot figure this out.  I am trying to extend a raster object, using 
the "extend" function (from the raster package), but the extension of 
the raster does not change.  Here is an example:

##############################
set.seed(100)
myraster <- raster(ncols=4, nrows=4)
myraster[] <-  sample(1:10,ncell(eff),replace=T)
extent(myraster)

ex <- extent(myraster)+2
eff <- expand(myraster, ex)
extent(myraster)
##############################

As you can see, the extent of "myraster" does not change.   What I am 
doing wrong?
Many thanks,

Julian

-- 
Julian Mariano Burgos, PhD
Hafranns?knastofnunin/Marine Research Institute
Sk?lagata 4, 121 Reykjav?k, Iceland
S?mi/Telephone : +354-5752037
Br?fs?mi/Telefax:  +354-5752001
Netfang/Email: julian at hafro.is


From julian at hafro.is  Mon May  7 13:47:58 2012
From: julian at hafro.is (Julian Burgos)
Date: Mon, 07 May 2012 11:47:58 +0000
Subject: [R-sig-Geo] problem with expand function (raster package)
In-Reply-To: <4FA7B5B4.4000901@hafro.is>
References: <4FA7B5B4.4000901@hafro.is>
Message-ID: <4FA7B66E.8000001@hafro.is>

Sorry, posted to the wrong list.

On m?n  7.ma? 2012 11:44, Julian Burgos wrote:
> Dear list,
>
> I cannot figure this out.  I am trying to extend a raster object, 
> using the "extend" function (from the raster package), but the 
> extension of the raster does not change.  Here is an example:
>
> ##############################
> set.seed(100)
> myraster <- raster(ncols=4, nrows=4)
> myraster[] <-  sample(1:10,ncell(eff),replace=T)
> extent(myraster)
>
> ex <- extent(myraster)+2
> eff <- expand(myraster, ex)
> extent(myraster)
> ##############################
>
> As you can see, the extent of "myraster" does not change.   What I am 
> doing wrong?
> Many thanks,
>
> Julian
>


-- 
Julian Mariano Burgos, PhD
Hafranns?knastofnunin/Marine Research Institute
Sk?lagata 4, 121 Reykjav?k, Iceland
S?mi/Telephone : +354-5752037
Br?fs?mi/Telefax:  +354-5752001
Netfang/Email: julian at hafro.is


From julian at hafro.is  Mon May  7 13:49:39 2012
From: julian at hafro.is (Julian Burgos)
Date: Mon, 07 May 2012 11:49:39 +0000
Subject: [R-sig-Geo] problem with expand function (raster package)
In-Reply-To: <4FA7B66E.8000001@hafro.is>
References: <4FA7B5B4.4000901@hafro.is> <4FA7B66E.8000001@hafro.is>
Message-ID: <4FA7B6D3.9010409@hafro.is>

Apologies again, this was the right list.  I need more coffee.

On m?n  7.ma? 2012 11:47, Julian Burgos wrote:
> Sorry, posted to the wrong list.
>
> On m?n  7.ma? 2012 11:44, Julian Burgos wrote:
>> Dear list,
>>
>> I cannot figure this out.  I am trying to extend a raster object, 
>> using the "extend" function (from the raster package), but the 
>> extension of the raster does not change.  Here is an example:
>>
>> ##############################
>> set.seed(100)
>> myraster <- raster(ncols=4, nrows=4)
>> myraster[] <-  sample(1:10,ncell(eff),replace=T)
>> extent(myraster)
>>
>> ex <- extent(myraster)+2
>> eff <- expand(myraster, ex)
>> extent(myraster)
>> ##############################
>>
>> As you can see, the extent of "myraster" does not change.   What I am 
>> doing wrong?
>> Many thanks,
>>
>> Julian
>>
>
>


-- 
Julian Mariano Burgos, PhD
Hafranns?knastofnunin/Marine Research Institute
Sk?lagata 4, 121 Reykjav?k, Iceland
S?mi/Telephone : +354-5752037
Br?fs?mi/Telefax:  +354-5752001
Netfang/Email: julian at hafro.is


From rlist at zeidlers.de  Mon May  7 14:27:20 2012
From: rlist at zeidlers.de (Julian Zeidler)
Date: Mon, 07 May 2012 14:27:20 +0200
Subject: [R-sig-Geo] problem with expand function (raster package)
In-Reply-To: <4FA7B6D3.9010409@hafro.is>
References: <4FA7B5B4.4000901@hafro.is> <4FA7B66E.8000001@hafro.is>
	<4FA7B6D3.9010409@hafro.is>
Message-ID: <4FA7BFA8.103@zeidlers.de>

Hi Julian,

Your input raster myraster does not change! Have a look at your output 
raster eff. Also your "shift" is to small compared to your Raster 
Resolution to result in "extended data"

Try:

ex <- extent(myraster)+100
eff <- expand(myraster, ex)
extent(eff)

Best,
Julian




Am 07.05.2012 13:49, schrieb Julian Burgos:
> Apologies again, this was the right list.  I need more coffee.
>
> On m?n  7.ma? 2012 11:47, Julian Burgos wrote:
>> Sorry, posted to the wrong list.
>>
>> On m?n  7.ma? 2012 11:44, Julian Burgos wrote:
>>> Dear list,
>>>
>>> I cannot figure this out.  I am trying to extend a raster object, 
>>> using the "extend" function (from the raster package), but the 
>>> extension of the raster does not change.  Here is an example:
>>>
>>> ##############################
>>> set.seed(100)
>>> myraster <- raster(ncols=4, nrows=4)
>>> myraster[] <-  sample(1:10,ncell(eff),replace=T)
>>> extent(myraster)
>>>
>>> ex <- extent(myraster)+2
>>> eff <- expand(myraster, ex)
>>> extent(myraster)
>>> ##############################
>>>
>>> As you can see, the extent of "myraster" does not change.   What I 
>>> am doing wrong?
>>> Many thanks,
>>>
>>> Julian
>>>
>>
>>
>
>


From Maximilian.Spross at uibk.ac.at  Mon May  7 14:38:53 2012
From: Maximilian.Spross at uibk.ac.at (=?ISO-8859-15?Q?Maximilian_Spro=DF?=)
Date: Mon, 07 May 2012 14:38:53 +0200
Subject: [R-sig-Geo] Missing local R-squared and residuals in gwr output
In-Reply-To: <alpine.LRH.2.02.1205051616590.27123@reclus.nhh.no>
References: <4FA3FF6A.3090005@uibk.ac.at> <4FA40304.2050503@uibk.ac.at>
	<alpine.LRH.2.02.1205051616590.27123@reclus.nhh.no>
Message-ID: <4FA7C25D.9070303@uibk.ac.at>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120507/7da8d82d/attachment.pl>

From Martin at Hvidberg.net  Mon May  7 14:45:08 2012
From: Martin at Hvidberg.net (Martin Hvidberg)
Date: Mon, 07 May 2012 14:45:08 +0200
Subject: [R-sig-Geo] Re.: Integrating R and Arcgis
In-Reply-To: <mailman.13.1336298404.31319.r-sig-geo@r-project.org>
References: <mailman.13.1336298404.31319.r-sig-geo@r-project.org>
Message-ID: <4FA7C3D4.8080506@Hvidberg.net>

Thanks Germ?n for qualifying this subject.

It's correct that R can be called through an ArcGIS Add-In.
It will be possible to write Add-ins in Python, from ver. 10.1 of 
ArcGIS. But actually you can do it in the present version (10.0), though 
not in Python, but in java, C++ or any .NET language. Provided that you 
can call R from inside these languages, but I'm sure there are ways to 
do that.

Best Regards
Martin


From Roger.Bivand at nhh.no  Mon May  7 14:48:57 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 7 May 2012 14:48:57 +0200 (CEST)
Subject: [R-sig-Geo] Missing local R-squared and residuals in gwr output
In-Reply-To: <4FA7C25D.9070303@uibk.ac.at>
References: <4FA3FF6A.3090005@uibk.ac.at> <4FA40304.2050503@uibk.ac.at>
	<alpine.LRH.2.02.1205051616590.27123@reclus.nhh.no>
	<4FA7C25D.9070303@uibk.ac.at>
Message-ID: <alpine.LRH.2.02.1205071446450.3968@reclus.nhh.no>

On Mon, 7 May 2012, Maximilian Spro? wrote:

> Dear Roger!
>
> Thank you very much for your fast reply and work!
>
> I'm not really an expert in HPC-computing, but i will try to report as goog 
> as i can.
>
> I updated spgwr and started a job on the cluster which takes normally 1,5 h. 
> So far, it run for 5 hours, which indicates that the parallelization does not 
> work efficient anymore. The function makeCluster(64, type="MPI") worked fine. 
> Our cluster runs with openMPI.

Correct. I'll try to add back an option to use snow instead of parallel. 
When it reaches R-forge, its revision number will be > 1252.

Roger

>
> In that context, i found on the CRAN Task view: High-Performance and Parallel 
> Computing with R the following: 
> "<http://www.dict.cc/englisch-deutsch/parallelization.html>Direct support in 
> R is starting with release 2.14.0 which includes a new package parallel 
> incorporating (slightly revised) copies of packages multicore and snow (*but 
> excluding MPI, PVM and NWS clusters*). Does the new parallel support works 
> still in the openMPI environment?
>
> regards,
>
> Max
>
> fyi:
>
> sessionInfo()
> R version 2.14.0 (2011-10-31)
> Platform: x86_64-unknown-linux-gnu (64-bit)
>
> locale:
> [1] LC_CTYPE=en_US       LC_NUMERIC=C         LC_TIME=en_US
> [4] LC_COLLATE=en_US     LC_MONETARY=en_US    LC_MESSAGES=en_US
> [7] LC_PAPER=C           LC_NAME=C            LC_ADDRESS=C
> [10] LC_TELEPHONE=C       LC_MEASUREMENT=en_US LC_IDENTIFICATION=C
>
> attached base packages:
> [1] parallel  stats     graphics  grDevices utils     datasets  methods
> [8] base
>
> other attached packages:
> [1] spgwr_0.6-15    spdep_0.5-45    coda_0.14-6     deldir_0.0-16
> [5] maptools_0.8-10 foreign_0.8-46  nlme_3.1-102    MASS_7.3-16
> [9] Matrix_1.0-1    lattice_0.20-0  boot_1.3-3      gstat_1.0-10
> [13] spacetime_0.5-7 xts_0.8-2       zoo_1.7-6       sp_0.9-98
> [17] snow_0.3-8      Rmpi_0.5-9
>
> loaded via a namespace (and not attached):
> [1] grid_2.14.0
>
>
> On 05/05/2012 04:24 PM, Roger Bivand wrote:
>> On Fri, 4 May 2012, Maximilian Spro? wrote:
>> 
>>> Dear r-sig-geo list!
>>> 
>>> I run gwr on a multi-node cluster(on 64 slots). In the gwr output (slot
>>> "SDF"), the gwr residuals and the local R-squared are missing. When
>>> performing the same model on the local machine, these components are
>>> included. Unfortunately, the calculation in this way takes about 5 days
>>> instead of few hours when using the cluster.
>>> 
>>> Perhaps, that problem arises due to the argument "fit.points", which has
>>> to be passed if the local coefficient estimates should be made on a
>>> multi node cluster.
>>> 
>>> Does anyone have an idea how to solve that problem with the missing
>>> local R-squared and residuals if the gwr is calculated on a cluster?
>> 
>> The understanding for use on a cluster was that the data points and the fit 
>> points are different, so there is no observed dependent variable at the fit 
>> point, hence no local R2. I've added logic in the code that checks for 
>> equality between the fit and data points, and this for me resolves the 
>> problem, but may break other things. I've committed to R-forge, project 
>> rspatial, module spgwr. The source tarball and binary packages should be 
>> available later this evening European time from:
>> 
>> https://r-forge.r-project.org/R/?group_id=1014
>> 
>> Could you please try it out, and report back? I should also migrate spgwr 
>> from snow to parallel before I release it.
>> 
>> Best wishes,
>> 
>> Roger
>> 
>>> 
>>> 
>>> Thank you very much in advance!
>>> 
>>> Kind regards,
>>> 
>>> Max
>>> 
>>> 
>>> selected R-code:
>>> 
>>> ### gwr on local machine:
>>> 
>>> gwr_50 <-
>>> gwr(hef at data$DIF~hef at data$ELEVATION+hef at data$SKY+hef at data$SLOPE+hef at data$SOLAR, 
>>> data=hef, bandwidth=50, gweight=gwr.Gauss)
>>> 
>>> 
>>> # part of the  str(gwr_50) output...
>>> 
>>> 
>>> List of 11
>>>  $ SDF      :Formal class 'SpatialPointsDataFrame' [package "sp"] with 5 
>>> slots
>>>   .. ..@ data       :'data.frame':    286288 obs. of  9 variables:
>>>   .. .. ..$ sum.w      : num [1:286288] 2009 2003 2091 2089 2086 ...
>>>   .. .. ..$ (Intercept): num [1:286288] -28.7 -28.5 -29.9 -29.7 -29.5 ...
>>>   .. .. ..$ elevation  : num [1:286288] 0.0139 0.0138 0.014 0.014 0.014 
>>> ...
>>>   .. .. ..$ sky        : num [1:286288] -0.153 -0.155 -0.146 -0.148 -0.149 
>>> ...
>>>   .. .. ..$ slope      : num [1:286288] -2.58 -2.61 -2.42 -2.45 -2.48 ...
>>>   .. .. ..$ solar      : num [1:286288] -0.00139 -0.00136 -0.0015 -0.00147 
>>> -0.00144 ...
>>>   .. .. ..$ gwr.e      : num [1:286288] -0.461 -0.683 -0.5987 -0.2692 
>>> 0.0406 ...
>>>   .. .. ..$ pred       : num [1:286288] 0.806 0.833 0.507 0.514 0.576 ...
>>>   .. .. ..$ localR2    : num [1:286288] 0.621 0.618 0.638 0.635 0.632 ...
>>> 
>>> 
>>> 
>>> 
>>> ### gwr on cluster :
>>> 
>>> cl <- makeCluster(32, type="MPI")
>>> 
>>> coords <- coordinates(hef)
>>> 
>>> gw <-
>>> gwr(hef at data$DIF~hef at data$ELEVATION+hef at data$SKY+hef at data$SLOPE+hef at data$SOLAR, 
>>> data=hef, bandwidth=50, gweight=gwr.Gauss,fit.points=coords,
>>> hatmatrix=FALSE, cl=cl)
>>> 
>>> # part of the  str(gwr_50) output...
>>> 
>>> List of 11
>>>  $ SDF      :Formal class 'SpatialPointsDataFrame' [package "sp"] with 5 
>>> slots
>>>   .. ..@ data       :'data.frame':    286288 obs. of  6 variables:
>>>   .. .. ..$ sum.w      : num [1:286288] 1 1 1 1 1 ...
>>>   .. .. ..$ (Intercept): num [1:286288] 12541 1970 2057 -1505 -1030 ...
>>>   .. .. ..$ elevation  : num [1:286288] -3.891 -0.602 -0.738 0.465 0.309 
>>> ...
>>>   .. .. ..$ sky        : num [1:286288] -0.954 -0.425 3.714 0.159 0.152 
>>> ...
>>>   .. .. ..$ slope      : num [1:286288] 62.19 NA -27.21 1.95 16.03 ...
>>>   .. .. ..$ solar      : num [1:286288] NA NA NA NA 0.042 ...
>>> 
>>> 
>>> 
>>>
>>>     [[alternative HTML version deleted]]
>>> 
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> 
>> 
>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From julian at hafro.is  Mon May  7 14:56:38 2012
From: julian at hafro.is (Julian Burgos)
Date: Mon, 07 May 2012 12:56:38 +0000
Subject: [R-sig-Geo] problem with expand function (raster package)
In-Reply-To: <4FA7BFA8.103@zeidlers.de>
References: <4FA7B5B4.4000901@hafro.is> <4FA7B66E.8000001@hafro.is>
	<4FA7B6D3.9010409@hafro.is> <4FA7BFA8.103@zeidlers.de>
Message-ID: <4FA7C686.60301@hafro.is>

Thanks Julian, it was that the resolution of the shift was too small 
compared to the original raster.

On m?n  7.ma? 2012 12:27, Julian Zeidler wrote:
> Hi Julian,
>
> Your input raster myraster does not change! Have a look at your output 
> raster eff. Also your "shift" is to small compared to your Raster 
> Resolution to result in "extended data"
>
> Try:
>
> ex <- extent(myraster)+100
> eff <- expand(myraster, ex)
> extent(eff)
>
> Best,
> Julian
>
>
>
>
> Am 07.05.2012 13:49, schrieb Julian Burgos:
>> Apologies again, this was the right list.  I need more coffee.
>>
>> On m?n  7.ma? 2012 11:47, Julian Burgos wrote:
>>> Sorry, posted to the wrong list.
>>>
>>> On m?n  7.ma? 2012 11:44, Julian Burgos wrote:
>>>> Dear list,
>>>>
>>>> I cannot figure this out.  I am trying to extend a raster object, 
>>>> using the "extend" function (from the raster package), but the 
>>>> extension of the raster does not change.  Here is an example:
>>>>
>>>> ##############################
>>>> set.seed(100)
>>>> myraster <- raster(ncols=4, nrows=4)
>>>> myraster[] <-  sample(1:10,ncell(eff),replace=T)
>>>> extent(myraster)
>>>>
>>>> ex <- extent(myraster)+2
>>>> eff <- expand(myraster, ex)
>>>> extent(myraster)
>>>> ##############################
>>>>
>>>> As you can see, the extent of "myraster" does not change.   What I 
>>>> am doing wrong?
>>>> Many thanks,
>>>>
>>>> Julian
>>>>
>>>
>>>
>>
>>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>


-- 
Julian Mariano Burgos, PhD
Hafranns?knastofnunin/Marine Research Institute
Sk?lagata 4, 121 Reykjav?k, Iceland
S?mi/Telephone : +354-5752037
Br?fs?mi/Telefax:  +354-5752001
Netfang/Email: julian at hafro.is


From czapelini at yahoo.com.br  Mon May  7 17:18:57 2012
From: czapelini at yahoo.com.br (Cleverson Zapelini)
Date: Mon, 7 May 2012 08:18:57 -0700 (PDT)
Subject: [R-sig-Geo] Analysis of the dot pattern from Shapefile
Message-ID: <1336403937.53701.YahooMailNeo@web122404.mail.ne1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120507/fe488dba/attachment.pl>

From marcelino.delacruz at upm.es  Mon May  7 17:24:49 2012
From: marcelino.delacruz at upm.es (Marcelino de la Cruz)
Date: Mon, 07 May 2012 17:24:49 +0200
Subject: [R-sig-Geo] Analysis of the dot pattern from Shapefile
In-Reply-To: <1336403937.53701.YahooMailNeo@web122404.mail.ne1.yahoo.com
 >
References: <1336403937.53701.YahooMailNeo@web122404.mail.ne1.yahoo.com>
Message-ID: <201205071524.q47FOoZD031279@smtp.upm.es>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120507/9cadeb6c/attachment.pl>

From Maximilian.Spross at uibk.ac.at  Mon May  7 20:15:56 2012
From: Maximilian.Spross at uibk.ac.at (=?iso-8859-15?Q?=22Spro=DF=2C_Johann=22?=)
Date: Mon, 7 May 2012 20:15:56 +0200
Subject: [R-sig-Geo] Missing local R-squared and residuals in gwr output
References: <4FA3FF6A.3090005@uibk.ac.at> <4FA40304.2050503@uibk.ac.at>
	<alpine.LRH.2.02.1205051616590.27123@reclus.nhh.no>
	<4FA7C25D.9070303@uibk.ac.at>
	<alpine.LRH.2.02.1205071446450.3968@reclus.nhh.no>
Message-ID: <3A0ABF309258464FAFF2D91B6E6874840599CB25@VEX01.uibk.ac.at>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120507/d5a95612/attachment.pl>

From Roger.Bivand at nhh.no  Mon May  7 20:45:25 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 7 May 2012 20:45:25 +0200 (CEST)
Subject: [R-sig-Geo] Missing local R-squared and residuals in gwr output
In-Reply-To: <3A0ABF309258464FAFF2D91B6E6874840599CB25@VEX01.uibk.ac.at>
References: <4FA3FF6A.3090005@uibk.ac.at> <4FA40304.2050503@uibk.ac.at>
	<alpine.LRH.2.02.1205051616590.27123@reclus.nhh.no>
	<4FA7C25D.9070303@uibk.ac.at>
	<alpine.LRH.2.02.1205071446450.3968@reclus.nhh.no>
	<3A0ABF309258464FAFF2D91B6E6874840599CB25@VEX01.uibk.ac.at>
Message-ID: <alpine.LRH.2.02.1205072044470.3968@reclus.nhh.no>

On Mon, 7 May 2012, "Spro?, Johann" wrote:

>
>
>
> --
> Mag. J. Maximilian Spro?
> Institute of Geography, University of Innsbruck
> Innrain 52
> A-6020 INNSBRUCK
>
> Tel. +43 (0)512 507 5413
> web: http://www.uibk.ac.at/geographie/projects/lidar/
>
>
>
> -----Urspr?ngliche Nachricht-----
> Von: Roger Bivand [mailto:Roger.Bivand at nhh.no]
> Gesendet: Mo 07.05.2012 14:48
> An: Maximilian Spro?
> Cc: r-sig-geo
> Betreff: Re: [R-sig-Geo] Missing local R-squared and residuals in gwr output
>
> On Mon, 7 May 2012, Maximilian Spro? wrote:
>
>> Dear Roger!
>>
>> Thank you very much for your fast reply and work!
>>
>> I'm not really an expert in HPC-computing, but i will try to report as goog
>> as i can.
>>
>> I updated spgwr and started a job on the cluster which takes normally 1,5 h.
>> So far, it run for 5 hours, which indicates that the parallelization does not
>> work efficient anymore. The function makeCluster(64, type="MPI") worked fine.
>> Our cluster runs with openMPI.
>
> Correct. I'll try to add back an option to use snow instead of parallel.
>
> I tried out the new version but it seems still using parallel.
>
> code:
>
> gwr_50 <- gwr(hef at data$DIF~hef at data$ELEVATION+hef at data$SKY+hef at data$SLOPE+hef at data$SOLAR+factor(asp_fac), data=hef, bandwidth=50, gweight=gwr.Gauss,fit.points=coords, hatmatrix=FALSE, cl=cl)

Add use_snow=TRUE to the command to switch to snow.

Roger

> Loading required package: parallel
>
> Attaching package: 'parallel'
>
> The following object(s) are masked from 'package:snow':
>
>    clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,
>    clusterExport, clusterMap, clusterSplit, makeCluster, parApply,
>    parCapply, parLapply, parRapply, parSapply, splitIndices,
>    stopCluster
>
> Max
>
>
> When it reaches R-forge, its revision number will be > 1252.
>
> Roger
>
>>
>> In that context, i found on the CRAN Task view: High-Performance and Parallel
>> Computing with R the following:
>> "<http://www.dict.cc/englisch-deutsch/parallelization.html>Direct support in
>> R is starting with release 2.14.0 which includes a new package parallel
>> incorporating (slightly revised) copies of packages multicore and snow (*but
>> excluding MPI, PVM and NWS clusters*). Does the new parallel support works
>> still in the openMPI environment?
>>
>> regards,
>>
>> Max
>>
>> fyi:
>>
>> sessionInfo()
>> R version 2.14.0 (2011-10-31)
>> Platform: x86_64-unknown-linux-gnu (64-bit)
>>
>> locale:
>> [1] LC_CTYPE=en_US       LC_NUMERIC=C         LC_TIME=en_US
>> [4] LC_COLLATE=en_US     LC_MONETARY=en_US    LC_MESSAGES=en_US
>> [7] LC_PAPER=C           LC_NAME=C            LC_ADDRESS=C
>> [10] LC_TELEPHONE=C       LC_MEASUREMENT=en_US LC_IDENTIFICATION=C
>>
>> attached base packages:
>> [1] parallel  stats     graphics  grDevices utils     datasets  methods
>> [8] base
>>
>> other attached packages:
>> [1] spgwr_0.6-15    spdep_0.5-45    coda_0.14-6     deldir_0.0-16
>> [5] maptools_0.8-10 foreign_0.8-46  nlme_3.1-102    MASS_7.3-16
>> [9] Matrix_1.0-1    lattice_0.20-0  boot_1.3-3      gstat_1.0-10
>> [13] spacetime_0.5-7 xts_0.8-2       zoo_1.7-6       sp_0.9-98
>> [17] snow_0.3-8      Rmpi_0.5-9
>>
>> loaded via a namespace (and not attached):
>> [1] grid_2.14.0
>>
>>
>> On 05/05/2012 04:24 PM, Roger Bivand wrote:
>>> On Fri, 4 May 2012, Maximilian Spro? wrote:
>>>
>>>> Dear r-sig-geo list!
>>>>
>>>> I run gwr on a multi-node cluster(on 64 slots). In the gwr output (slot
>>>> "SDF"), the gwr residuals and the local R-squared are missing. When
>>>> performing the same model on the local machine, these components are
>>>> included. Unfortunately, the calculation in this way takes about 5 days
>>>> instead of few hours when using the cluster.
>>>>
>>>> Perhaps, that problem arises due to the argument "fit.points", which has
>>>> to be passed if the local coefficient estimates should be made on a
>>>> multi node cluster.
>>>>
>>>> Does anyone have an idea how to solve that problem with the missing
>>>> local R-squared and residuals if the gwr is calculated on a cluster?
>>>
>>> The understanding for use on a cluster was that the data points and the fit
>>> points are different, so there is no observed dependent variable at the fit
>>> point, hence no local R2. I've added logic in the code that checks for
>>> equality between the fit and data points, and this for me resolves the
>>> problem, but may break other things. I've committed to R-forge, project
>>> rspatial, module spgwr. The source tarball and binary packages should be
>>> available later this evening European time from:
>>>
>>> https://r-forge.r-project.org/R/?group_id=1014
>>>
>>> Could you please try it out, and report back? I should also migrate spgwr
>>> from snow to parallel before I release it.
>>>
>>> Best wishes,
>>>
>>> Roger
>>>
>>>>
>>>>
>>>> Thank you very much in advance!
>>>>
>>>> Kind regards,
>>>>
>>>> Max
>>>>
>>>>
>>>> selected R-code:
>>>>
>>>> ### gwr on local machine:
>>>>
>>>> gwr_50 <-
>>>> gwr(hef at data$DIF~hef at data$ELEVATION+hef at data$SKY+hef at data$SLOPE+hef at data$SOLAR,
>>>> data=hef, bandwidth=50, gweight=gwr.Gauss)
>>>>
>>>>
>>>> # part of the  str(gwr_50) output...
>>>>
>>>>
>>>> List of 11
>>>>  $ SDF      :Formal class 'SpatialPointsDataFrame' [package "sp"] with 5
>>>> slots
>>>>   .. ..@ data       :'data.frame':    286288 obs. of  9 variables:
>>>>   .. .. ..$ sum.w      : num [1:286288] 2009 2003 2091 2089 2086 ...
>>>>   .. .. ..$ (Intercept): num [1:286288] -28.7 -28.5 -29.9 -29.7 -29.5 ...
>>>>   .. .. ..$ elevation  : num [1:286288] 0.0139 0.0138 0.014 0.014 0.014
>>>> ...
>>>>   .. .. ..$ sky        : num [1:286288] -0.153 -0.155 -0.146 -0.148 -0.149
>>>> ...
>>>>   .. .. ..$ slope      : num [1:286288] -2.58 -2.61 -2.42 -2.45 -2.48 ...
>>>>   .. .. ..$ solar      : num [1:286288] -0.00139 -0.00136 -0.0015 -0.00147
>>>> -0.00144 ...
>>>>   .. .. ..$ gwr.e      : num [1:286288] -0.461 -0.683 -0.5987 -0.2692
>>>> 0.0406 ...
>>>>   .. .. ..$ pred       : num [1:286288] 0.806 0.833 0.507 0.514 0.576 ...
>>>>   .. .. ..$ localR2    : num [1:286288] 0.621 0.618 0.638 0.635 0.632 ...
>>>>
>>>>
>>>>
>>>>
>>>> ### gwr on cluster :
>>>>
>>>> cl <- makeCluster(32, type="MPI")
>>>>
>>>> coords <- coordinates(hef)
>>>>
>>>> gw <-
>>>> gwr(hef at data$DIF~hef at data$ELEVATION+hef at data$SKY+hef at data$SLOPE+hef at data$SOLAR,
>>>> data=hef, bandwidth=50, gweight=gwr.Gauss,fit.points=coords,
>>>> hatmatrix=FALSE, cl=cl)
>>>>
>>>> # part of the  str(gwr_50) output...
>>>>
>>>> List of 11
>>>>  $ SDF      :Formal class 'SpatialPointsDataFrame' [package "sp"] with 5
>>>> slots
>>>>   .. ..@ data       :'data.frame':    286288 obs. of  6 variables:
>>>>   .. .. ..$ sum.w      : num [1:286288] 1 1 1 1 1 ...
>>>>   .. .. ..$ (Intercept): num [1:286288] 12541 1970 2057 -1505 -1030 ...
>>>>   .. .. ..$ elevation  : num [1:286288] -3.891 -0.602 -0.738 0.465 0.309
>>>> ...
>>>>   .. .. ..$ sky        : num [1:286288] -0.954 -0.425 3.714 0.159 0.152
>>>> ...
>>>>   .. .. ..$ slope      : num [1:286288] 62.19 NA -27.21 1.95 16.03 ...
>>>>   .. .. ..$ solar      : num [1:286288] NA NA NA NA 0.042 ...
>>>>
>>>>
>>>>
>>>>
>>>>     [[alternative HTML version deleted]]
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>
>>
>>
>>
>
> --
> Roger Bivand
> Department of Economics, NHH Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From czapelini at yahoo.com.br  Mon May  7 20:55:24 2012
From: czapelini at yahoo.com.br (Cleverson Zapelini)
Date: Mon, 7 May 2012 11:55:24 -0700 (PDT)
Subject: [R-sig-Geo] Analysis of the dot pattern from Shapefile
In-Reply-To: <201205071524.q47FOoZD031279@smtp.upm.es>
References: <1336403937.53701.YahooMailNeo@web122404.mail.ne1.yahoo.com>
	<201205071524.q47FOoZD031279@smtp.upm.es>
Message-ID: <1336416924.52077.YahooMailNeo@web122403.mail.ne1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120507/1fe6baf8/attachment.pl>

From thi_veloso at yahoo.com.br  Tue May  8 01:48:29 2012
From: thi_veloso at yahoo.com.br (Thiago Veloso)
Date: Mon, 7 May 2012 16:48:29 -0700 (PDT)
Subject: [R-sig-Geo] {Text fixed} Best approach to process a massive
	ammount of MODIS data
In-Reply-To: <CANtt_hxBKnaH-7ztabtZRAkCL8ZmOpNOyJwKyGvWiuq+mPr7_Q@mail.gmail.com>
Message-ID: <1336434509.12653.YahooMailClassic@web161406.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120507/4dba8a53/attachment.pl>

From r.hijmans at gmail.com  Tue May  8 07:08:51 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 7 May 2012 22:08:51 -0700
Subject: [R-sig-Geo] Raster package: reading in time values from raster
	stack
In-Reply-To: <CABP0dEjQ_y9vh0b0XT9jmgr7tOxdvNDx5VyD2dHe-b7EfTQtZA@mail.gmail.com>
References: <CABP0dEjQ_y9vh0b0XT9jmgr7tOxdvNDx5VyD2dHe-b7EfTQtZA@mail.gmail.com>
Message-ID: <CANtt_hz8hneJ0zsmvckh-39TZCorviHC=UJjwAdCivamQ+WHOA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120507/a8c3e799/attachment.pl>

From agus.camacho at gmail.com  Tue May  8 17:13:05 2012
From: agus.camacho at gmail.com (Agus Camacho)
Date: Tue, 8 May 2012 12:13:05 -0300
Subject: [R-sig-Geo] Managing layer Nas in occurrences
Message-ID: <CALsJ7pQw-zxnWvvNZ=Q17QNaFVfEyq38=y=oNC+u5Hfg9P9uYg@mail.gmail.com>

Dear all,

When dealing with some occurrences, I found some unexplicable Nas.
The map attached comes from nothern south america. Red dots are the
problematic occurences (=without climatic layer data) and the fine ones are
green.
It looks to me like there is some mismatching between the occurrences, the
map and the layers. However, I dont know how to solve it and I am afraid of
future problems like this for other occurences next to the coast.
Maybe should I use another coastline database and use the value of the
nearest raster cell containing data?

Any hint about this problem would be appreciated.

The code used to generate the map and dot was:
plot(wrld_simpl, xlim=c(min(x$Longitude), max(x$Longitude)),
ylim=c(min(x$Latitude), max(x$Latitude)),
axes=TRUE,col='light yellow')
box()
points(fine, col='green', pch=20, cex=0.75)
points(problems, col='red', pch=20, cex=0.75)

Thanks in advance.
Agus
-- 
Agust?n Camacho Guerrero.
Doutorando em Zoologia.
Laborat?rio de Herpetologia, Departamento de Zoologia, Instituto de
Bioci?ncias, USP.
Rua do Mat?o, trav. 14, n? 321, Cidade Universit?ria,
S?o Paulo - SP, CEP: 05508-090, Brasil.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120508/f2144cd3/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: points with Nas.png
Type: image/png
Size: 4129 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120508/f2144cd3/attachment.png>

From afischbach at usgs.gov  Tue May  8 17:33:57 2012
From: afischbach at usgs.gov (Anthony Fischbach)
Date: Tue, 8 May 2012 08:33:57 -0700 (PDT)
Subject: [R-sig-Geo] R / ArcGIS
In-Reply-To: <alpine.LRH.2.02.1202171456110.24394@reclus.nhh.no>
References: <4F3DFE8B.6030903@uni-muenster.de>
	<CAEewEpg_D_1xaLo+RyT6SyVpDjn094C3hO57Ykz02mG8isgpdw@mail.gmail.com>
	<alpine.LRH.2.02.1202171209110.24394@reclus.nhh.no>
	<4F3E5AE0.5050409@uni-muenster.de>
	<alpine.LRH.2.02.1202171456110.24394@reclus.nhh.no>
Message-ID: <1336491237007-7539547.post@n2.nabble.com>

Rodger, 
can you direct us to more on the forthcoming improvements to RODBC in R
2.15.0?
I have found RODBC useful for integrating tabular data from ArcGIS
compatable .mdb files, but found the handling of date time fields
problematic.
-Tony

-----
Tony Fischbach, Wildlife Biologist
Walrus Research Program
Alaska Science Center
U.S. Geological Survey
4210 University Drive
Anchorage, AK 99508-4650

AFischbach at usgs.gov
http://alaska.usgs.gov/science/biology/walrus
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/R-ArcGIS-tp7293420p7539547.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From r.hijmans at gmail.com  Tue May  8 18:03:08 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 8 May 2012 09:03:08 -0700
Subject: [R-sig-Geo] Managing layer Nas in occurrences
In-Reply-To: <CALsJ7pQw-zxnWvvNZ=Q17QNaFVfEyq38=y=oNC+u5Hfg9P9uYg@mail.gmail.com>
References: <CALsJ7pQw-zxnWvvNZ=Q17QNaFVfEyq38=y=oNC+u5Hfg9P9uYg@mail.gmail.com>
Message-ID: <CANtt_hzxAFECF0cpi9Btyjbbb7=HZDf3aQcBJY6S7q60nWmkDg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120508/a1fc6eef/attachment.pl>

From Roger.Bivand at nhh.no  Tue May  8 19:23:30 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 8 May 2012 19:23:30 +0200 (CEST)
Subject: [R-sig-Geo] R / ArcGIS
In-Reply-To: <1336491237007-7539547.post@n2.nabble.com>
References: <4F3DFE8B.6030903@uni-muenster.de>
	<CAEewEpg_D_1xaLo+RyT6SyVpDjn094C3hO57Ykz02mG8isgpdw@mail.gmail.com>
	<alpine.LRH.2.02.1202171209110.24394@reclus.nhh.no>
	<4F3E5AE0.5050409@uni-muenster.de>
	<alpine.LRH.2.02.1202171456110.24394@reclus.nhh.no>
	<1336491237007-7539547.post@n2.nabble.com>
Message-ID: <alpine.LRH.2.02.1205081920230.12316@reclus.nhh.no>

On Tue, 8 May 2012, Anthony Fischbach wrote:

> Rodger,
> can you direct us to more on the forthcoming improvements to RODBC in R
> 2.15.0?
> I have found RODBC useful for integrating tabular data from ArcGIS
> compatable .mdb files, but found the handling of date time fields
> problematic.

If you are referring to using readOGR() in rgdal on Windows with the CRAN 
Windows binary package, then I believe that it now contains a working Pgeo 
driver (thanks to Prof. Brian Ripley). I do not know if the use of ODBC 
there treats date time fields more gracefully than RODBC. I have no sample 
files from which to judge, I'm afraid.

Roger

> -Tony
>
> -----
> Tony Fischbach, Wildlife Biologist
> Walrus Research Program
> Alaska Science Center
> U.S. Geological Survey
> 4210 University Drive
> Anchorage, AK 99508-4650
>
> AFischbach at usgs.gov
> http://alaska.usgs.gov/science/biology/walrus
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/R-ArcGIS-tp7293420p7539547.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From ignacioquinterom at gmail.com  Wed May  9 01:32:43 2012
From: ignacioquinterom at gmail.com (ignacio.quintero)
Date: Tue, 8 May 2012 16:32:43 -0700 (PDT)
Subject: [R-sig-Geo] gdistance resistanceDistance error
In-Reply-To: <1323411440.7194.YahooMailNeo@web29702.mail.ird.yahoo.com>
References: <CAC28k7RWH1JcpHwzMnVbN12AKDFj1posHa5MOAB8TCddmTK8Ag@mail.gmail.com>
	<1323411440.7194.YahooMailNeo@web29702.mail.ird.yahoo.com>
Message-ID: <1336519963610-7541017.post@n2.nabble.com>

Dear all,

I have came across the same error using resistanceDistance (and not
costDistance with same data):

  "#Get matrix of resistance distances. 
  Error in Cholesky(Lr) : CHOLMOD factorization was unsuccessful 
  In addition: Warning message: 
  In Cholesky(Lr) : 
    Cholmod warning 'not positive definite' at 
  file:../Cholesky/t_cholmod_rowfac.c, line 432"

I was using also a very large raster grid (~5000000 cells). This seems to be
the problem (do not know if because of memory): I cropped the same big
raster into a smaller one containing the locality points (and, of course, a
big frame outside; however, currently, I do not know if the frame extent
will change the results...) and it worked perfectly.

Hope this helps (although I would like to know the exact problem (memory or
other issue) with the resistanceDistance function)

Best,

Ignacio

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/gdistance-resistanceDistance-error-tp7076485p7541017.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From jacobvanetten at yahoo.com  Wed May  9 01:53:21 2012
From: jacobvanetten at yahoo.com (Jacob van Etten)
Date: Tue, 8 May 2012 18:53:21 -0500
Subject: [R-sig-Geo] gdistance resistanceDistance error
In-Reply-To: <1336519963610-7541017.post@n2.nabble.com>
References: <CAC28k7RWH1JcpHwzMnVbN12AKDFj1posHa5MOAB8TCddmTK8Ag@mail.gmail.com>
	<1323411440.7194.YahooMailNeo@web29702.mail.ird.yahoo.com>
	<1336519963610-7541017.post@n2.nabble.com>
Message-ID: <B1D716CE-0C92-4EEB-90A8-D580A8A42E86@yahoo.com>

Dear Ignacio,

The problem may also have to do with the values in the TransitionMatrix. A reproducible example would be good to have.

Jacob

On 8/05/2012, at 18:32, "ignacio.quintero" <ignacioquinterom at gmail.com> wrote:

> Dear all,
> 
> I have came across the same error using resistanceDistance (and not
> costDistance with same data):
> 
>  "#Get matrix of resistance distances. 
>  Error in Cholesky(Lr) : CHOLMOD factorization was unsuccessful 
>  In addition: Warning message: 
>  In Cholesky(Lr) : 
>    Cholmod warning 'not positive definite' at 
>  file:../Cholesky/t_cholmod_rowfac.c, line 432"
> 
> I was using also a very large raster grid (~5000000 cells). This seems to be
> the problem (do not know if because of memory): I cropped the same big
> raster into a smaller one containing the locality points (and, of course, a
> big frame outside; however, currently, I do not know if the frame extent
> will change the results...) and it worked perfectly.
> 
> Hope this helps (although I would like to know the exact problem (memory or
> other issue) with the resistanceDistance function)
> 
> Best,
> 
> Ignacio
> 
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/gdistance-resistanceDistance-error-tp7076485p7541017.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From ignacioquinterom at gmail.com  Wed May  9 03:47:51 2012
From: ignacioquinterom at gmail.com (ignacio.quintero)
Date: Tue, 8 May 2012 18:47:51 -0700 (PDT)
Subject: [R-sig-Geo] gdistance resistanceDistance error
In-Reply-To: <B1D716CE-0C92-4EEB-90A8-D580A8A42E86@yahoo.com>
References: <CAC28k7RWH1JcpHwzMnVbN12AKDFj1posHa5MOAB8TCddmTK8Ag@mail.gmail.com>
	<1323411440.7194.YahooMailNeo@web29702.mail.ird.yahoo.com>
	<1336519963610-7541017.post@n2.nabble.com>
	<B1D716CE-0C92-4EEB-90A8-D580A8A42E86@yahoo.com>
Message-ID: <1EF2C1D4-C184-4F79-9072-76A6876DC03D@gmail.com>

Dear Jacob,

Hope you don't mind if I don't write in the post but directly to you. Actually, as you might suppose, the data is too heavy in order for me to send it. However, I will summ it up: the data is a grid of the American continent with a ~0.05x0.05 degree resolution and values that correspond to the probability of presence (ranging from ~1.5e-7 to ~0.9). There are more than 5000000 cells, but about 2/3 are NA's (is this what is causing the trouble?) I have looked how to remove this NA cells without success (when I rasterize the points, the grid automatically adds a rectangular grid with NAs where no data is found).

Any help would be most appreciated,

Best

Ignacio


On May 8, 2012, at 6:54 PM, Jacob van Etten [via R-sig-geo] wrote:

> Dear Ignacio, 
> 
> The problem may also have to do with the values in the TransitionMatrix. A reproducible example would be good to have. 
> 
> Jacob 
> 
> On 8/05/2012, at 18:32, "ignacio.quintero" <[hidden email]> wrote: 
> 
> > Dear all, 
> > 
> > I have came across the same error using resistanceDistance (and not 
> > costDistance with same data): 
> > 
> >  "#Get matrix of resistance distances. 
> >  Error in Cholesky(Lr) : CHOLMOD factorization was unsuccessful 
> >  In addition: Warning message: 
> >  In Cholesky(Lr) : 
> >    Cholmod warning 'not positive definite' at 
> >  file:../Cholesky/t_cholmod_rowfac.c, line 432" 
> > 
> > I was using also a very large raster grid (~5000000 cells). This seems to be 
> > the problem (do not know if because of memory): I cropped the same big 
> > raster into a smaller one containing the locality points (and, of course, a 
> > big frame outside; however, currently, I do not know if the frame extent 
> > will change the results...) and it worked perfectly. 
> > 
> > Hope this helps (although I would like to know the exact problem (memory or 
> > other issue) with the resistanceDistance function) 
> > 
> > Best, 
> > 
> > Ignacio 
> > 
> > -- 
> > View this message in context: http://r-sig-geo.2731867.n2.nabble.com/gdistance-resistanceDistance-error-tp7076485p7541017.html
> > Sent from the R-sig-geo mailing list archive at Nabble.com. 
> > 
> > _______________________________________________ 
> > R-sig-Geo mailing list 
> > [hidden email] 
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> _______________________________________________ 
> R-sig-Geo mailing list 
> [hidden email] 
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 
> If you reply to this email, your message will be added to the discussion below:
> http://r-sig-geo.2731867.n2.nabble.com/gdistance-resistanceDistance-error-tp7076485p7541075.html
> To unsubscribe from gdistance resistanceDistance error, click here.
> NAML



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/gdistance-resistanceDistance-error-tp7076485p7541430.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From jwittische at hotmail.com  Wed May  9 10:43:55 2012
From: jwittische at hotmail.com (Julian WITTISCHE)
Date: Wed, 9 May 2012 08:43:55 +0000
Subject: [R-sig-Geo] convex hull on PCA results of BIOCLIM variables
Message-ID: <DUB112-W10968271E5E1598CBBE5861CF110@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120509/ff4c6942/attachment.pl>

From Maximilian.Spross at uibk.ac.at  Wed May  9 12:27:08 2012
From: Maximilian.Spross at uibk.ac.at (=?ISO-8859-15?Q?Maximilian_Spro=DF?=)
Date: Wed, 09 May 2012 12:27:08 +0200
Subject: [R-sig-Geo] Missing local R-squared and residuals in gwr output
In-Reply-To: <alpine.LRH.2.02.1205072044470.3968@reclus.nhh.no>
References: <4FA3FF6A.3090005@uibk.ac.at> <4FA40304.2050503@uibk.ac.at>
	<alpine.LRH.2.02.1205051616590.27123@reclus.nhh.no>
	<4FA7C25D.9070303@uibk.ac.at>
	<alpine.LRH.2.02.1205071446450.3968@reclus.nhh.no>
	<3A0ABF309258464FAFF2D91B6E6874840599CB25@VEX01.uibk.ac.at>
	<alpine.LRH.2.02.1205072044470.3968@reclus.nhh.no>
Message-ID: <4FAA467C.2070805@uibk.ac.at>

Thank you Roger! The gwr on the MPI cluster works fine.

However, now the output object includes the intially missing three data 
slots: "gwr.e","pred" and "localR2". Unfortunately, the latter contains 
only NA's.
Sorry for of any inconvenience, but do you think you can solve that?

Thanks in advance and all the best,

Max


On 05/07/2012 08:45 PM, Roger Bivand wrote:
> On Mon, 7 May 2012, "Spro?, Johann" wrote:
>
>>
>>
>>
>> -- 
>> Mag. J. Maximilian Spro?
>> Institute of Geography, University of Innsbruck
>> Innrain 52
>> A-6020 INNSBRUCK
>>
>> Tel. +43 (0)512 507 5413
>> web: http://www.uibk.ac.at/geographie/projects/lidar/
>>
>>
>>
>> -----Urspr?ngliche Nachricht-----
>> Von: Roger Bivand [mailto:Roger.Bivand at nhh.no]
>> Gesendet: Mo 07.05.2012 14:48
>> An: Maximilian Spro?
>> Cc: r-sig-geo
>> Betreff: Re: [R-sig-Geo] Missing local R-squared and residuals in gwr 
>> output
>>
>> On Mon, 7 May 2012, Maximilian Spro? wrote:
>>
>>> Dear Roger!
>>>
>>> Thank you very much for your fast reply and work!
>>>
>>> I'm not really an expert in HPC-computing, but i will try to report 
>>> as goog
>>> as i can.
>>>
>>> I updated spgwr and started a job on the cluster which takes 
>>> normally 1,5 h.
>>> So far, it run for 5 hours, which indicates that the parallelization 
>>> does not
>>> work efficient anymore. The function makeCluster(64, type="MPI") 
>>> worked fine.
>>> Our cluster runs with openMPI.
>>
>> Correct. I'll try to add back an option to use snow instead of parallel.
>>
>> I tried out the new version but it seems still using parallel.
>>
>> code:
>>
>> gwr_50 <- 
>> gwr(hef at data$DIF~hef at data$ELEVATION+hef at data$SKY+hef at data$SLOPE+hef at data$SOLAR+factor(asp_fac), 
>> data=hef, bandwidth=50, gweight=gwr.Gauss,fit.points=coords, 
>> hatmatrix=FALSE, cl=cl)
>
> Add use_snow=TRUE to the command to switch to snow.
>
> Roger
>
>> Loading required package: parallel
>>
>> Attaching package: 'parallel'
>>
>> The following object(s) are masked from 'package:snow':
>>
>>    clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,
>>    clusterExport, clusterMap, clusterSplit, makeCluster, parApply,
>>    parCapply, parLapply, parRapply, parSapply, splitIndices,
>>    stopCluster
>>
>> Max
>>
>>
>> When it reaches R-forge, its revision number will be > 1252.
>>
>> Roger
>>
>>>
>>> In that context, i found on the CRAN Task view: High-Performance and 
>>> Parallel
>>> Computing with R the following:
>>> "<http://www.dict.cc/englisch-deutsch/parallelization.html>Direct 
>>> support in
>>> R is starting with release 2.14.0 which includes a new package parallel
>>> incorporating (slightly revised) copies of packages multicore and 
>>> snow (*but
>>> excluding MPI, PVM and NWS clusters*). Does the new parallel support 
>>> works
>>> still in the openMPI environment?
>>>
>>> regards,
>>>
>>> Max
>>>
>>> fyi:
>>>
>>> sessionInfo()
>>> R version 2.14.0 (2011-10-31)
>>> Platform: x86_64-unknown-linux-gnu (64-bit)
>>>
>>> locale:
>>> [1] LC_CTYPE=en_US       LC_NUMERIC=C         LC_TIME=en_US
>>> [4] LC_COLLATE=en_US     LC_MONETARY=en_US    LC_MESSAGES=en_US
>>> [7] LC_PAPER=C           LC_NAME=C            LC_ADDRESS=C
>>> [10] LC_TELEPHONE=C       LC_MEASUREMENT=en_US LC_IDENTIFICATION=C
>>>
>>> attached base packages:
>>> [1] parallel  stats     graphics  grDevices utils     datasets  methods
>>> [8] base
>>>
>>> other attached packages:
>>> [1] spgwr_0.6-15    spdep_0.5-45    coda_0.14-6     deldir_0.0-16
>>> [5] maptools_0.8-10 foreign_0.8-46  nlme_3.1-102    MASS_7.3-16
>>> [9] Matrix_1.0-1    lattice_0.20-0  boot_1.3-3      gstat_1.0-10
>>> [13] spacetime_0.5-7 xts_0.8-2       zoo_1.7-6       sp_0.9-98
>>> [17] snow_0.3-8      Rmpi_0.5-9
>>>
>>> loaded via a namespace (and not attached):
>>> [1] grid_2.14.0
>>>
>>>
>>> On 05/05/2012 04:24 PM, Roger Bivand wrote:
>>>> On Fri, 4 May 2012, Maximilian Spro? wrote:
>>>>
>>>>> Dear r-sig-geo list!
>>>>>
>>>>> I run gwr on a multi-node cluster(on 64 slots). In the gwr output 
>>>>> (slot
>>>>> "SDF"), the gwr residuals and the local R-squared are missing. When
>>>>> performing the same model on the local machine, these components are
>>>>> included. Unfortunately, the calculation in this way takes about 5 
>>>>> days
>>>>> instead of few hours when using the cluster.
>>>>>
>>>>> Perhaps, that problem arises due to the argument "fit.points", 
>>>>> which has
>>>>> to be passed if the local coefficient estimates should be made on a
>>>>> multi node cluster.
>>>>>
>>>>> Does anyone have an idea how to solve that problem with the missing
>>>>> local R-squared and residuals if the gwr is calculated on a cluster?
>>>>
>>>> The understanding for use on a cluster was that the data points and 
>>>> the fit
>>>> points are different, so there is no observed dependent variable at 
>>>> the fit
>>>> point, hence no local R2. I've added logic in the code that checks for
>>>> equality between the fit and data points, and this for me resolves the
>>>> problem, but may break other things. I've committed to R-forge, 
>>>> project
>>>> rspatial, module spgwr. The source tarball and binary packages 
>>>> should be
>>>> available later this evening European time from:
>>>>
>>>> https://r-forge.r-project.org/R/?group_id=1014
>>>>
>>>> Could you please try it out, and report back? I should also migrate 
>>>> spgwr
>>>> from snow to parallel before I release it.
>>>>
>>>> Best wishes,
>>>>
>>>> Roger
>>>>
>>>>>
>>>>>
>>>>> Thank you very much in advance!
>>>>>
>>>>> Kind regards,
>>>>>
>>>>> Max
>>>>>
>>>>>
>>>>> selected R-code:
>>>>>
>>>>> ### gwr on local machine:
>>>>>
>>>>> gwr_50 <-
>>>>> gwr(hef at data$DIF~hef at data$ELEVATION+hef at data$SKY+hef at data$SLOPE+hef at data$SOLAR, 
>>>>>
>>>>> data=hef, bandwidth=50, gweight=gwr.Gauss)
>>>>>
>>>>>
>>>>> # part of the  str(gwr_50) output...
>>>>>
>>>>>
>>>>> List of 11
>>>>>  $ SDF      :Formal class 'SpatialPointsDataFrame' [package "sp"] 
>>>>> with 5
>>>>> slots
>>>>>   .. ..@ data       :'data.frame':    286288 obs. of  9 variables:
>>>>>   .. .. ..$ sum.w      : num [1:286288] 2009 2003 2091 2089 2086 ...
>>>>>   .. .. ..$ (Intercept): num [1:286288] -28.7 -28.5 -29.9 -29.7 
>>>>> -29.5 ...
>>>>>   .. .. ..$ elevation  : num [1:286288] 0.0139 0.0138 0.014 0.014 
>>>>> 0.014
>>>>> ...
>>>>>   .. .. ..$ sky        : num [1:286288] -0.153 -0.155 -0.146 
>>>>> -0.148 -0.149
>>>>> ...
>>>>>   .. .. ..$ slope      : num [1:286288] -2.58 -2.61 -2.42 -2.45 
>>>>> -2.48 ...
>>>>>   .. .. ..$ solar      : num [1:286288] -0.00139 -0.00136 -0.0015 
>>>>> -0.00147
>>>>> -0.00144 ...
>>>>>   .. .. ..$ gwr.e      : num [1:286288] -0.461 -0.683 -0.5987 -0.2692
>>>>> 0.0406 ...
>>>>>   .. .. ..$ pred       : num [1:286288] 0.806 0.833 0.507 0.514 
>>>>> 0.576 ...
>>>>>   .. .. ..$ localR2    : num [1:286288] 0.621 0.618 0.638 0.635 
>>>>> 0.632 ...
>>>>>
>>>>>
>>>>>
>>>>>
>>>>> ### gwr on cluster :
>>>>>
>>>>> cl <- makeCluster(32, type="MPI")
>>>>>
>>>>> coords <- coordinates(hef)
>>>>>
>>>>> gw <-
>>>>> gwr(hef at data$DIF~hef at data$ELEVATION+hef at data$SKY+hef at data$SLOPE+hef at data$SOLAR, 
>>>>>
>>>>> data=hef, bandwidth=50, gweight=gwr.Gauss,fit.points=coords,
>>>>> hatmatrix=FALSE, cl=cl)
>>>>>
>>>>> # part of the  str(gwr_50) output...
>>>>>
>>>>> List of 11
>>>>>  $ SDF      :Formal class 'SpatialPointsDataFrame' [package "sp"] 
>>>>> with 5
>>>>> slots
>>>>>   .. ..@ data       :'data.frame':    286288 obs. of  6 variables:
>>>>>   .. .. ..$ sum.w      : num [1:286288] 1 1 1 1 1 ...
>>>>>   .. .. ..$ (Intercept): num [1:286288] 12541 1970 2057 -1505 
>>>>> -1030 ...
>>>>>   .. .. ..$ elevation  : num [1:286288] -3.891 -0.602 -0.738 0.465 
>>>>> 0.309
>>>>> ...
>>>>>   .. .. ..$ sky        : num [1:286288] -0.954 -0.425 3.714 0.159 
>>>>> 0.152
>>>>> ...
>>>>>   .. .. ..$ slope      : num [1:286288] 62.19 NA -27.21 1.95 16.03 
>>>>> ...
>>>>>   .. .. ..$ solar      : num [1:286288] NA NA NA NA 0.042 ...
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>     [[alternative HTML version deleted]]
>>>>>
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>
>>>>
>>>
>>>
>>>
>>
>> -- 
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>>
>


From Roger.Bivand at nhh.no  Wed May  9 13:19:29 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 9 May 2012 13:19:29 +0200 (CEST)
Subject: [R-sig-Geo] Missing local R-squared and residuals in gwr output
In-Reply-To: <4FAA467C.2070805@uibk.ac.at>
References: <4FA3FF6A.3090005@uibk.ac.at> <4FA40304.2050503@uibk.ac.at>
	<alpine.LRH.2.02.1205051616590.27123@reclus.nhh.no>
	<4FA7C25D.9070303@uibk.ac.at>
	<alpine.LRH.2.02.1205071446450.3968@reclus.nhh.no>
	<3A0ABF309258464FAFF2D91B6E6874840599CB25@VEX01.uibk.ac.at>
	<alpine.LRH.2.02.1205072044470.3968@reclus.nhh.no>
	<4FAA467C.2070805@uibk.ac.at>
Message-ID: <alpine.LRH.2.02.1205091312330.16117@reclus.nhh.no>

On Wed, 9 May 2012, Maximilian Spro? wrote:

> Thank you Roger! The gwr on the MPI cluster works fine.
>
> However, now the output object includes the intially missing three data 
> slots: "gwr.e","pred" and "localR2". Unfortunately, the latter contains only 
> NA's.
> Sorry for of any inconvenience, but do you think you can solve that?

I do not see any problem there, and indeed it is after the results have 
been returned from the cluster. You can tell whether you have been into 
the code block starting on line 261 in spgwr/R/gwr.R if there is no line 
beginning with "postprocess_localR2" in the timings component of the 
output object. The conditions are:

((!fp.given || fit_are_data) && is.null(fittedGWRobject))

where the first is FALSE, the second TRUE and the third TRUE in your case. 
If the "pred" column in your output contains values that are not finite, 
this may happen in this code block.

If you cannot see what is going on, we need a smaller test data set that 
replicates the problem.

Roger

>
> Thanks in advance and all the best,
>
> Max
>
>
> On 05/07/2012 08:45 PM, Roger Bivand wrote:
>> On Mon, 7 May 2012, "Spro?, Johann" wrote:
>> 
>>> 
>>> 
>>> 
>>> -- 
>>> Mag. J. Maximilian Spro?
>>> Institute of Geography, University of Innsbruck
>>> Innrain 52
>>> A-6020 INNSBRUCK
>>> 
>>> Tel. +43 (0)512 507 5413
>>> web: http://www.uibk.ac.at/geographie/projects/lidar/
>>> 
>>> 
>>> 
>>> -----Urspr?ngliche Nachricht-----
>>> Von: Roger Bivand [mailto:Roger.Bivand at nhh.no]
>>> Gesendet: Mo 07.05.2012 14:48
>>> An: Maximilian Spro?
>>> Cc: r-sig-geo
>>> Betreff: Re: [R-sig-Geo] Missing local R-squared and residuals in gwr 
>>> output
>>> 
>>> On Mon, 7 May 2012, Maximilian Spro? wrote:
>>> 
>>>> Dear Roger!
>>>> 
>>>> Thank you very much for your fast reply and work!
>>>> 
>>>> I'm not really an expert in HPC-computing, but i will try to report as 
>>>> goog
>>>> as i can.
>>>> 
>>>> I updated spgwr and started a job on the cluster which takes normally 1,5 
>>>> h.
>>>> So far, it run for 5 hours, which indicates that the parallelization does 
>>>> not
>>>> work efficient anymore. The function makeCluster(64, type="MPI") worked 
>>>> fine.
>>>> Our cluster runs with openMPI.
>>> 
>>> Correct. I'll try to add back an option to use snow instead of parallel.
>>> 
>>> I tried out the new version but it seems still using parallel.
>>> 
>>> code:
>>> 
>>> gwr_50 <- 
>>> gwr(hef at data$DIF~hef at data$ELEVATION+hef at data$SKY+hef at data$SLOPE+hef at data$SOLAR+factor(asp_fac), 
>>> data=hef, bandwidth=50, gweight=gwr.Gauss,fit.points=coords, 
>>> hatmatrix=FALSE, cl=cl)
>> 
>> Add use_snow=TRUE to the command to switch to snow.
>> 
>> Roger
>> 
>>> Loading required package: parallel
>>> 
>>> Attaching package: 'parallel'
>>> 
>>> The following object(s) are masked from 'package:snow':
>>>
>>>    clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,
>>>    clusterExport, clusterMap, clusterSplit, makeCluster, parApply,
>>>    parCapply, parLapply, parRapply, parSapply, splitIndices,
>>>    stopCluster
>>> 
>>> Max
>>> 
>>> 
>>> When it reaches R-forge, its revision number will be > 1252.
>>> 
>>> Roger
>>> 
>>>> 
>>>> In that context, i found on the CRAN Task view: High-Performance and 
>>>> Parallel
>>>> Computing with R the following:
>>>> "<http://www.dict.cc/englisch-deutsch/parallelization.html>Direct support 
>>>> in
>>>> R is starting with release 2.14.0 which includes a new package parallel
>>>> incorporating (slightly revised) copies of packages multicore and snow 
>>>> (*but
>>>> excluding MPI, PVM and NWS clusters*). Does the new parallel support 
>>>> works
>>>> still in the openMPI environment?
>>>> 
>>>> regards,
>>>> 
>>>> Max
>>>> 
>>>> fyi:
>>>> 
>>>> sessionInfo()
>>>> R version 2.14.0 (2011-10-31)
>>>> Platform: x86_64-unknown-linux-gnu (64-bit)
>>>> 
>>>> locale:
>>>> [1] LC_CTYPE=en_US       LC_NUMERIC=C         LC_TIME=en_US
>>>> [4] LC_COLLATE=en_US     LC_MONETARY=en_US    LC_MESSAGES=en_US
>>>> [7] LC_PAPER=C           LC_NAME=C            LC_ADDRESS=C
>>>> [10] LC_TELEPHONE=C       LC_MEASUREMENT=en_US LC_IDENTIFICATION=C
>>>> 
>>>> attached base packages:
>>>> [1] parallel  stats     graphics  grDevices utils     datasets  methods
>>>> [8] base
>>>> 
>>>> other attached packages:
>>>> [1] spgwr_0.6-15    spdep_0.5-45    coda_0.14-6     deldir_0.0-16
>>>> [5] maptools_0.8-10 foreign_0.8-46  nlme_3.1-102    MASS_7.3-16
>>>> [9] Matrix_1.0-1    lattice_0.20-0  boot_1.3-3      gstat_1.0-10
>>>> [13] spacetime_0.5-7 xts_0.8-2       zoo_1.7-6       sp_0.9-98
>>>> [17] snow_0.3-8      Rmpi_0.5-9
>>>> 
>>>> loaded via a namespace (and not attached):
>>>> [1] grid_2.14.0
>>>> 
>>>> 
>>>> On 05/05/2012 04:24 PM, Roger Bivand wrote:
>>>>> On Fri, 4 May 2012, Maximilian Spro? wrote:
>>>>> 
>>>>>> Dear r-sig-geo list!
>>>>>> 
>>>>>> I run gwr on a multi-node cluster(on 64 slots). In the gwr output (slot
>>>>>> "SDF"), the gwr residuals and the local R-squared are missing. When
>>>>>> performing the same model on the local machine, these components are
>>>>>> included. Unfortunately, the calculation in this way takes about 5 days
>>>>>> instead of few hours when using the cluster.
>>>>>> 
>>>>>> Perhaps, that problem arises due to the argument "fit.points", which 
>>>>>> has
>>>>>> to be passed if the local coefficient estimates should be made on a
>>>>>> multi node cluster.
>>>>>> 
>>>>>> Does anyone have an idea how to solve that problem with the missing
>>>>>> local R-squared and residuals if the gwr is calculated on a cluster?
>>>>> 
>>>>> The understanding for use on a cluster was that the data points and the 
>>>>> fit
>>>>> points are different, so there is no observed dependent variable at the 
>>>>> fit
>>>>> point, hence no local R2. I've added logic in the code that checks for
>>>>> equality between the fit and data points, and this for me resolves the
>>>>> problem, but may break other things. I've committed to R-forge, project
>>>>> rspatial, module spgwr. The source tarball and binary packages should be
>>>>> available later this evening European time from:
>>>>> 
>>>>> https://r-forge.r-project.org/R/?group_id=1014
>>>>> 
>>>>> Could you please try it out, and report back? I should also migrate 
>>>>> spgwr
>>>>> from snow to parallel before I release it.
>>>>> 
>>>>> Best wishes,
>>>>> 
>>>>> Roger
>>>>> 
>>>>>> 
>>>>>> 
>>>>>> Thank you very much in advance!
>>>>>> 
>>>>>> Kind regards,
>>>>>> 
>>>>>> Max
>>>>>> 
>>>>>> 
>>>>>> selected R-code:
>>>>>> 
>>>>>> ### gwr on local machine:
>>>>>> 
>>>>>> gwr_50 <-
>>>>>> gwr(hef at data$DIF~hef at data$ELEVATION+hef at data$SKY+hef at data$SLOPE+hef at data$SOLAR, 
>>>>>> data=hef, bandwidth=50, gweight=gwr.Gauss)
>>>>>> 
>>>>>> 
>>>>>> # part of the  str(gwr_50) output...
>>>>>> 
>>>>>> 
>>>>>> List of 11
>>>>>>  $ SDF      :Formal class 'SpatialPointsDataFrame' [package "sp"] with 
>>>>>> 5
>>>>>> slots
>>>>>>   .. ..@ data       :'data.frame':    286288 obs. of  9 variables:
>>>>>>   .. .. ..$ sum.w      : num [1:286288] 2009 2003 2091 2089 2086 ...
>>>>>>   .. .. ..$ (Intercept): num [1:286288] -28.7 -28.5 -29.9 -29.7 -29.5 
>>>>>> ...
>>>>>>   .. .. ..$ elevation  : num [1:286288] 0.0139 0.0138 0.014 0.014 0.014
>>>>>> ...
>>>>>>   .. .. ..$ sky        : num [1:286288] -0.153 -0.155 -0.146 -0.148 
>>>>>> -0.149
>>>>>> ...
>>>>>>   .. .. ..$ slope      : num [1:286288] -2.58 -2.61 -2.42 -2.45 -2.48 
>>>>>> ...
>>>>>>   .. .. ..$ solar      : num [1:286288] -0.00139 -0.00136 -0.0015 
>>>>>> -0.00147
>>>>>> -0.00144 ...
>>>>>>   .. .. ..$ gwr.e      : num [1:286288] -0.461 -0.683 -0.5987 -0.2692
>>>>>> 0.0406 ...
>>>>>>   .. .. ..$ pred       : num [1:286288] 0.806 0.833 0.507 0.514 0.576 
>>>>>> ...
>>>>>>   .. .. ..$ localR2    : num [1:286288] 0.621 0.618 0.638 0.635 0.632 
>>>>>> ...
>>>>>> 
>>>>>> 
>>>>>> 
>>>>>> 
>>>>>> ### gwr on cluster :
>>>>>> 
>>>>>> cl <- makeCluster(32, type="MPI")
>>>>>> 
>>>>>> coords <- coordinates(hef)
>>>>>> 
>>>>>> gw <-
>>>>>> gwr(hef at data$DIF~hef at data$ELEVATION+hef at data$SKY+hef at data$SLOPE+hef at data$SOLAR, 
>>>>>> data=hef, bandwidth=50, gweight=gwr.Gauss,fit.points=coords,
>>>>>> hatmatrix=FALSE, cl=cl)
>>>>>> 
>>>>>> # part of the  str(gwr_50) output...
>>>>>> 
>>>>>> List of 11
>>>>>>  $ SDF      :Formal class 'SpatialPointsDataFrame' [package "sp"] with 
>>>>>> 5
>>>>>> slots
>>>>>>   .. ..@ data       :'data.frame':    286288 obs. of  6 variables:
>>>>>>   .. .. ..$ sum.w      : num [1:286288] 1 1 1 1 1 ...
>>>>>>   .. .. ..$ (Intercept): num [1:286288] 12541 1970 2057 -1505 -1030 ...
>>>>>>   .. .. ..$ elevation  : num [1:286288] -3.891 -0.602 -0.738 0.465 
>>>>>> 0.309
>>>>>> ...
>>>>>>   .. .. ..$ sky        : num [1:286288] -0.954 -0.425 3.714 0.159 0.152
>>>>>> ...
>>>>>>   .. .. ..$ slope      : num [1:286288] 62.19 NA -27.21 1.95 16.03 ...
>>>>>>   .. .. ..$ solar      : num [1:286288] NA NA NA NA 0.042 ...
>>>>>> 
>>>>>> 
>>>>>> 
>>>>>>
>>>>>>     [[alternative HTML version deleted]]
>>>>>> 
>>>>>> _______________________________________________
>>>>>> R-sig-Geo mailing list
>>>>>> R-sig-Geo at r-project.org
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>> 
>>>>> 
>>>> 
>>>> 
>>>> 
>>> 
>>> -- 
>>> Roger Bivand
>>> Department of Economics, NHH Norwegian School of Economics,
>>> Helleveien 30, N-5045 Bergen, Norway.
>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>> e-mail: Roger.Bivand at nhh.no
>>> 
>>> 
>> 
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From matteo.mattiuzzi at boku.ac.at  Wed May  9 15:07:42 2012
From: matteo.mattiuzzi at boku.ac.at (Matteo Mattiuzzi)
Date: Wed, 09 May 2012 15:07:42 +0200
Subject: [R-sig-Geo] Intersection of Polygons (sp)
Message-ID: <4FAA883E0200002700013F61@gwia2.boku.ac.at>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120509/04af0436/attachment.pl>

From edzer.pebesma at uni-muenster.de  Wed May  9 15:20:42 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 09 May 2012 15:20:42 +0200
Subject: [R-sig-Geo] Intersection of Polygons (sp)
In-Reply-To: <4FAA883E0200002700013F61@gwia2.boku.ac.at>
References: <4FAA883E0200002700013F61@gwia2.boku.ac.at>
Message-ID: <4FAA6F2A.5010907@uni-muenster.de>



On 05/09/2012 03:07 PM, Matteo Mattiuzzi wrote:
> Dear List,
>  
> I have a table with corner coordinates:
>  
> download.file("http://landweb.nascom.nasa.gov/developers/sn_tiles/sn_gring_10deg.txt", dest=paste(tempdir(),"/sn_gring_10deg.txt",sep=""))
> x <- read.table(paste(tempdir(),"/sn_gring_10deg.txt",sep=""),skip=7,nrows=648)
> colnames(x) <- c("iv","ih","lllon","lllat","ullon","ullat","urlon","urlat","lrlon","lrlat")
> x <- x[x$lllon != -999,] # remove not valid tiles
> x[1:5,]
>  
> # and I wish to create polygons for each of the rows of "x". 
> require(sp)
> tilepolys <- list()
> for (u in 1:nrow(x)){
> attribute <- paste("h", sprintf("%02d", x$ih[u]), "v", sprintf("%02d", x$iv[u]),sep="")
> tilepolys[[u]] <- Polygons(list(Polygon(cbind(c(x$ullon[u],x$urlon[u],x$lrlon[u],x$lllon[u],x$ullon[u]),c(x$ullat[u],x$urlat[u],x$lrlat[u],x$lllat[u],x$ullat[u])),hole=FALSE)),attribute)
> }
> sr=SpatialPolygons(tilepolys)
>  
> plot(sr)
> # some polygons are crossing the lon +-180 limit and they should close the on the right side (crossing that border and not the globe). I don't understand if this happens here? And if there is a way to control it?
> #######################
> # I have a second polygon:
> po  <- Polygon(cbind(c(9.533616,17.16639,17.16639,9.533616,9.533616),c(49.01889,49.01889,46.38557,46.38557,49.01889)),hole=FALSE)
> pos <- Polygons(list(po),"austria")
> spos <- SpatialPolygons(list(pos))
>  
> plot(spos)
>  
> # Now I want to select (or better get the attribute of) every polygon in "sr" that is inside or touches the polygon "spos"?
>  
sr does not have attributes.

> I hope this is possible to do with "sp", in order to avoid further dependencies.

not without rgeos:

library(rgeos)
x = sr[spos,] # you could omit the , as sr has no attributes
plot(x)

>  
> Thanks a lot, Matteo
>  
>  
>  
>  
>  
>  
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From sarah.goslee at gmail.com  Wed May  9 16:50:44 2012
From: sarah.goslee at gmail.com (Sarah Goslee)
Date: Wed, 9 May 2012 10:50:44 -0400
Subject: [R-sig-Geo] convex hull on PCA results of BIOCLIM variables
In-Reply-To: <DUB112-W10968271E5E1598CBBE5861CF110@phx.gbl>
References: <DUB112-W10968271E5E1598CBBE5861CF110@phx.gbl>
Message-ID: <CAM_vjukQ5cBF7g7t40KAsgZS_ymbPtNN9c16DU-uyLzOzMz_Pw@mail.gmail.com>

Hi,

We don't know anything about your data. Providing a small reproducible
example would go a long way toward making it possible to answer your
question. The help file for s.chull gives some fake data; perhaps you
could use that to more clearly describe what you are doing and what is
going wrong.

Or you could use dput() to give us a small portion of your actual data.

Sarah

On Wed, May 9, 2012 at 4:43 AM, Julian WITTISCHE <jwittische at hotmail.com> wrote:
>
> Dear all,
> I have a problem to plot a convex hulls on PCA results. The PCA has reduced the 19 BIOCLIM variables to two axes and I want to plot a convex hull to be able to illustrate the environmental space overlap of two species.
> This is my script:
> library(Hmisc);library(ade4);
> #Import data
> batrabio<-read.table(file="Bioclimfull.txt", sep="\t", header=TRUE);batrabio<-batrabio[,c(1,4:22)]; ?#To select only species name and the 19 bioclim variables columns ? ? ?batrapair<-batrabio[batrabio$SCIENTIFIC_NAME=="Batrachoseps minor"| ?batrabio$SCIENTIFIC_NAME=="Batrachoseps incognitus",]; #To select two species to compare and illustrate their environmental space
> batrapair<-unique(batrapair[,]);#To select only unique localities
> #Run PCAs based on columns with climate data
> pca.ade4<-dudi.pca(batrapair[,2:20], center=T, scale=T, scannf=T); 2;#number of axes
> #Create convex hull using PCA axes, and colour-code points according to species name
> convex.hull<-s.chull(pca.ade4$li,as.factor(batrapair$SCIENTIFIC_NAME),add.plot=F, grid=F, clabel=0, origin=c(0,0),addaxes=T,col=c("red","blue"), cpoint=.65)
>
> I get the axes, the grid, the species name label but nothing else. I would greatly appreciate any advice as I have not been able to figure myself how to solve this problem.
> Thank you very much,
> Julian
>

-- 
Sarah Goslee
http://www.functionaldiversity.org


From Gema.FAviles at uclm.es  Wed May  9 17:20:25 2012
From: Gema.FAviles at uclm.es (GEMA FERNANDEZ-AVILES CALDERON)
Date: Wed, 9 May 2012 17:20:25 +0200
Subject: [R-sig-Geo] geoR -- krweights()
Message-ID: <BFE1525242E7DA4B9CBBDE2CF4DDBBFB0103A6DD@EVSAB01.uclm.es>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120509/674df2e6/attachment.pl>

From matteo.mattiuzzi at boku.ac.at  Wed May  9 17:43:03 2012
From: matteo.mattiuzzi at boku.ac.at (Matteo Mattiuzzi)
Date: Wed, 09 May 2012 17:43:03 +0200
Subject: [R-sig-Geo] Antw: Re:  Intersection of Polygons (sp)
In-Reply-To: <4FAA6F2A.5010907@uni-muenster.de>
References: <4FAA883E0200002700013F61@gwia2.boku.ac.at>
	<4FAA6F2A.5010907@uni-muenster.de>
Message-ID: <4FAAACA70200002700013F6E@gwia2.boku.ac.at>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120509/f211cad7/attachment.pl>

From paulojus at c3sl.ufpr.br  Wed May  9 18:46:56 2012
From: paulojus at c3sl.ufpr.br (Paulo Justiniano Ribeiro Jr)
Date: Wed, 9 May 2012 13:46:56 -0300 (BRT)
Subject: [R-sig-Geo] geoR -- krweights()
In-Reply-To: <BFE1525242E7DA4B9CBBDE2CF4DDBBFB0103A6DD@EVSAB01.uclm.es>
References: <BFE1525242E7DA4B9CBBDE2CF4DDBBFB0103A6DD@EVSAB01.uclm.es>
Message-ID: <alpine.DEB.2.00.1205091345180.11930@macalan.c3sl.ufpr.br>

Gema

Just a little on the context
krweights was meant more as a ilustrative function and not meant for 
"production" and therefore not extensivily used

I will have a look and feel free to contact me offline if you like




Paulo Justiniano Ribeiro Jr
LEG (Laboratorio de Estatistica e Geoinformacao)
Universidade Federal do Parana
Caixa Postal 19.081
CEP 81.531-990
Curitiba, PR  -  Brasil
Tel: (+55) 41 3361 3573
VOIP: (+55) (41) (3361 3600) 1053 1066
Fax: (+55) 41 3361 3141
e-mail: paulojus AT  ufpr  br
http://www.leg.ufpr.br/~paulojus

On Wed, 9 May 2012, GEMA FERNANDEZ-AVILES CALDERON wrote:

> Dear list:
>
> I would like to compute the weights in Ordinary Kriging.
> I try to predict only in one point, and know the OK weights but I have the following error (please, see ## (1)  ##).
> Also, I try to reply the example code but I have some errors (please, see ## (2)  ##)
>
> I am using  geoR version 1.7-2 and R-2.15.0 (RGui 32 bit). I have updated right now both (geoR and R software) because I trought that my version was obsoleted.
>
> Thanks in advance,
> Gema
>
>
>
> ## (1)  ## -------------------------------------------------------
> library(geoR)
> coord=read.table("examp_1_coord.txt",  header=TRUE)
> datos=read.table("examp1_datos.txt",  header=TRUE)
>
> objeto<-cbind(coord,datos)
> examp.2<-as.geodata(obj=objeto,coords.col = 1:2, data.col = 3)
> plot(examp.2, scatter3d=TRUE)
>
> loci <- c(0.5, 0.5)
> kc.examp.2<- krige.conv(examp.2, coords = examp.2$coords,
>          data = examp.2$data, loc=loci, krige=krige.control(cov.model="spherical",
>          cov.pars=c(5, 2), nugget= 0.0,lambda=1))
> w1 <- krweights(examp.2$coords, loc=loci, krige=kc.examp.2)
>
>> Error en match.arg(names(krige.user)[i], krige.names) :
>  'arg' should be one of ?type.krige?, ?trend.d?, ?trend.l?, ?obj.model?, ?beta?, ?cov.model?, ?cov.pars?, ?kappa?, ?nugget?, ?micro.scale?, ?dist.epsilon?, ?lambda?, ?aniso.pars?
>>
> ## ---------------------------------------------------------
>
>
>
>
> ## (2)  ## -------------------------------------------------------
> ## Figure 8.4 in Webster and Oliver (2001), see help(wo)
>> attach(wo)
> The following object(s) are masked _by_ '.GlobalEnv':
>
>    coords, data, x1
> The following object(s) are masked from 'wo (position 3)':
>
>    coords, data, x1, x2
>> par(mfrow=c(2,2))
>> plot(c(-10,130), c(-10,130), ty="n", asp=1)
>> points(rbind(coords, x1))
> Error en xy.coords(x, y) :
>  el objeto (list) no puede ser coercionado a 'double'
>> KC1 <- krige.control(cov.pars=c(0.382,90.53))
>> w1 <- krweights(wo$coords, loc=x1, krige=KC1)
> Error en loccoords(coords = coords, locations = locations) :
>  coords and locations must have two columns
>> text(coords[,1], 5+coords[,2], round(w1, dig=3))
> Error en as.graphicsAnnot(labels) : objeto 'w1' no encontrado
> ## ---------------------------------------------------------
>
>
>
>
>
>
>
>
>
>
>
>
>
> Gema Fern?ndez-Avil?s
>
> Department of Statistics
> Faculty of Law and Social Sciences
> University of Castilla-La Mancha at Toledo
>
> http://www.uclm.es/profesorado/gemafaviles/
>
> 	[[alternative HTML version deleted]]
>
>


From Wade.A.Wall at usace.army.mil  Wed May  9 18:51:07 2012
From: Wade.A.Wall at usace.army.mil (Wall, Wade A ERDC-RDE-CERL-IL)
Date: Wed, 9 May 2012 16:51:07 +0000
Subject: [R-sig-Geo] analyzing spatial segregation of sexes
Message-ID: <C1524BE4BF45454293B8DF38FB9B5ECAD310DE@MS-EX1VKS.erdc.dren.mil>

Hi all,

I have a data set that consists of x,y coordinates for individual plants, along with sex of the individual.

Example

Ind	sex	x	y
1	F	10	5
2	M	9	4
. . . 
200 	M	20	4

for 20 populations of the species. I would like to know if males and females are randomly dispersed, or tend to segregate.

I would like to use Philip Dixon's method (1994), and there is an implementation in the R package "spatialsegregation" (dixon(X, prepR=0)). However,
I am not very familiar with spatial analyses in R and am not sure how to structure the input object X. The function description says "Bivariate i.e. 2-type point pattern (see package 'spatstat')"

Does anyone know how to structure the data that I have (example above) so that I can use dixon()? Thanks for any help.

Wade A. Wall


From wtassinari at yahoo.com.br  Wed May  9 19:13:31 2012
From: wtassinari at yahoo.com.br (wtassinari at yahoo.com.br)
Date: Wed, 9 May 2012 17:13:31 +0000
Subject: [R-sig-Geo] QIC in gee models
In-Reply-To: <mailman.11.1336557604.2623.r-sig-geo@r-project.org>
References: <mailman.11.1336557604.2623.r-sig-geo@r-project.org>
Message-ID: <737894831-1336583808-cardhu_decombobulator_blackberry.rim.net-1124815942-@b25.c21.bise6.blackberry>

I don't know how to extract te QIC values in gee models in R (gee or geeglm comand)

Thank you
Tassinari, W
Enviado atrav?s do meu BlackBerry? da Nextel

-----Original Message-----
From: r-sig-geo-request at r-project.org
Sender: r-sig-geo-bounces at r-project.org
Date: Wed, 09 May 2012 12:00:04 
To: <r-sig-geo at r-project.org>
Reply-To: r-sig-geo at r-project.org
Subject: R-sig-Geo Digest, Vol 105, Issue 9

Send R-sig-Geo mailing list submissions to
	r-sig-geo at r-project.org

To subscribe or unsubscribe via the World Wide Web, visit
	https://stat.ethz.ch/mailman/listinfo/r-sig-geo
or, via email, send a message with subject or body 'help' to
	r-sig-geo-request at r-project.org

You can reach the person managing the list at
	r-sig-geo-owner at r-project.org

When replying, please edit your Subject line so it is more specific
than "Re: Contents of R-sig-Geo digest..."


Today's Topics:

   1. Managing layer Nas in occurrences (Agus Camacho)
   2. Re: R / ArcGIS (Anthony Fischbach)
   3. Re: Managing layer Nas in occurrences (Robert J. Hijmans)
   4. Re: R / ArcGIS (Roger Bivand)
   5. Re: gdistance resistanceDistance error (ignacio.quintero)
   6. Re: gdistance resistanceDistance error (Jacob van Etten)
   7. Re: gdistance resistanceDistance error (ignacio.quintero)
   8. convex hull on PCA results of BIOCLIM variables (Julian WITTISCHE)


----------------------------------------------------------------------

Message: 1
Date: Tue, 8 May 2012 12:13:05 -0300
From: Agus Camacho <agus.camacho at gmail.com>
To: r-sig-geo at r-project.org
Subject: [R-sig-Geo] Managing layer Nas in occurrences
Message-ID:
	<CALsJ7pQw-zxnWvvNZ=Q17QNaFVfEyq38=y=oNC+u5Hfg9P9uYg at mail.gmail.com>
Content-Type: text/plain; charset="iso-8859-1"

Dear all,

When dealing with some occurrences, I found some unexplicable Nas.
The map attached comes from nothern south america. Red dots are the
problematic occurences (=without climatic layer data) and the fine ones are
green.
It looks to me like there is some mismatching between the occurrences, the
map and the layers. However, I dont know how to solve it and I am afraid of
future problems like this for other occurences next to the coast.
Maybe should I use another coastline database and use the value of the
nearest raster cell containing data?

Any hint about this problem would be appreciated.

The code used to generate the map and dot was:
plot(wrld_simpl, xlim=c(min(x$Longitude), max(x$Longitude)),
ylim=c(min(x$Latitude), max(x$Latitude)),
axes=TRUE,col='light yellow')
box()
points(fine, col='green', pch=20, cex=0.75)
points(problems, col='red', pch=20, cex=0.75)

Thanks in advance.
Agus
-- 
Agust?n Camacho Guerrero.
Doutorando em Zoologia.
Laborat?rio de Herpetologia, Departamento de Zoologia, Instituto de
Bioci?ncias, USP.
Rua do Mat?o, trav. 14, n? 321, Cidade Universit?ria,
S?o Paulo - SP, CEP: 05508-090, Brasil.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120508/f2144cd3/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: points with Nas.png
Type: image/png
Size: 4129 bytes
Desc: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120508/f2144cd3/attachment-0001.png>

------------------------------

Message: 2
Date: Tue, 8 May 2012 08:33:57 -0700 (PDT)
From: Anthony Fischbach <afischbach at usgs.gov>
To: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] R / ArcGIS
Message-ID: <1336491237007-7539547.post at n2.nabble.com>
Content-Type: text/plain; charset=us-ascii

Rodger, 
can you direct us to more on the forthcoming improvements to RODBC in R
2.15.0?
I have found RODBC useful for integrating tabular data from ArcGIS
compatable .mdb files, but found the handling of date time fields
problematic.
-Tony

-----
Tony Fischbach, Wildlife Biologist
Walrus Research Program
Alaska Science Center
U.S. Geological Survey
4210 University Drive
Anchorage, AK 99508-4650

AFischbach at usgs.gov
http://alaska.usgs.gov/science/biology/walrus
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/R-ArcGIS-tp7293420p7539547.html
Sent from the R-sig-geo mailing list archive at Nabble.com.



------------------------------

Message: 3
Date: Tue, 8 May 2012 09:03:08 -0700
From: "Robert J. Hijmans" <r.hijmans at gmail.com>
To: Agus Camacho <agus.camacho at gmail.com>
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] Managing layer Nas in occurrences
Message-ID:
	<CANtt_hzxAFECF0cpi9Btyjbbb7=HZDf3aQcBJY6S7q60nWmkDg at mail.gmail.com>
Content-Type: text/plain

Agus,

If you find NAs in raster data for certain point locations, you probably
should plot these points on that raster.
And then perhaps compare the raster to wrld_simpl. Although it is a bit
simpl, as the name suggests and your plot confirms, most of these red
points are clearly on land.
For a higher resolution coastline you can use, for example,

library(raster)
wrld_cmplx <- getData('countries')

Robert


On Tue, May 8, 2012 at 8:13 AM, Agus Camacho <agus.camacho at gmail.com> wrote:

> Dear all,
>
> When dealing with some occurrences, I found some unexplicable Nas.
> The map attached comes from nothern south america. Red dots are the
> problematic occurences (=without climatic layer data) and the fine ones are
> green.
> It looks to me like there is some mismatching between the occurrences, the
> map and the layers. However, I dont know how to solve it and I am afraid of
> future problems like this for other occurences next to the coast.
> Maybe should I use another coastline database and use the value of the
> nearest raster cell containing data?
>
> Any hint about this problem would be appreciated.
>
> The code used to generate the map and dot was:
> plot(wrld_simpl, xlim=c(min(x$Longitude), max(x$Longitude)),
> ylim=c(min(x$Latitude), max(x$Latitude)),
> axes=TRUE,col='light yellow')
> box()
> points(fine, col='green', pch=20, cex=0.75)
> points(problems, col='red', pch=20, cex=0.75)
>
> Thanks in advance.
> Agus
> --
> Agust?n Camacho Guerrero.
> Doutorando em Zoologia.
> Laborat?rio de Herpetologia, Departamento de Zoologia, Instituto de
> Bioci?ncias, USP.
> Rua do Mat?o, trav. 14, n? 321, Cidade Universit?ria,
> S?o Paulo - SP, CEP: 05508-090, Brasil.
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>

	[[alternative HTML version deleted]]



------------------------------

Message: 4
Date: Tue, 8 May 2012 19:23:30 +0200 (CEST)
From: Roger Bivand <Roger.Bivand at nhh.no>
To: Anthony Fischbach <afischbach at usgs.gov>
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] R / ArcGIS
Message-ID: <alpine.LRH.2.02.1205081920230.12316 at reclus.nhh.no>
Content-Type: TEXT/PLAIN; charset=US-ASCII; format=flowed

On Tue, 8 May 2012, Anthony Fischbach wrote:

> Rodger,
> can you direct us to more on the forthcoming improvements to RODBC in R
> 2.15.0?
> I have found RODBC useful for integrating tabular data from ArcGIS
> compatable .mdb files, but found the handling of date time fields
> problematic.

If you are referring to using readOGR() in rgdal on Windows with the CRAN 
Windows binary package, then I believe that it now contains a working Pgeo 
driver (thanks to Prof. Brian Ripley). I do not know if the use of ODBC 
there treats date time fields more gracefully than RODBC. I have no sample 
files from which to judge, I'm afraid.

Roger

> -Tony
>
> -----
> Tony Fischbach, Wildlife Biologist
> Walrus Research Program
> Alaska Science Center
> U.S. Geological Survey
> 4210 University Drive
> Anchorage, AK 99508-4650
>
> AFischbach at usgs.gov
> http://alaska.usgs.gov/science/biology/walrus
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/R-ArcGIS-tp7293420p7539547.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no



------------------------------

Message: 5
Date: Tue, 8 May 2012 16:32:43 -0700 (PDT)
From: "ignacio.quintero" <ignacioquinterom at gmail.com>
To: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] gdistance resistanceDistance error
Message-ID: <1336519963610-7541017.post at n2.nabble.com>
Content-Type: text/plain; charset=us-ascii

Dear all,

I have came across the same error using resistanceDistance (and not
costDistance with same data):

  "#Get matrix of resistance distances. 
  Error in Cholesky(Lr) : CHOLMOD factorization was unsuccessful 
  In addition: Warning message: 
  In Cholesky(Lr) : 
    Cholmod warning 'not positive definite' at 
  file:../Cholesky/t_cholmod_rowfac.c, line 432"

I was using also a very large raster grid (~5000000 cells). This seems to be
the problem (do not know if because of memory): I cropped the same big
raster into a smaller one containing the locality points (and, of course, a
big frame outside; however, currently, I do not know if the frame extent
will change the results...) and it worked perfectly.

Hope this helps (although I would like to know the exact problem (memory or
other issue) with the resistanceDistance function)

Best,

Ignacio

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/gdistance-resistanceDistance-error-tp7076485p7541017.html
Sent from the R-sig-geo mailing list archive at Nabble.com.



------------------------------

Message: 6
Date: Tue, 8 May 2012 18:53:21 -0500
From: Jacob van Etten <jacobvanetten at yahoo.com>
To: "ignacio.quintero" <ignacioquinterom at gmail.com>
Cc: "r-sig-geo at r-project.org" <r-sig-geo at r-project.org>
Subject: Re: [R-sig-Geo] gdistance resistanceDistance error
Message-ID: <B1D716CE-0C92-4EEB-90A8-D580A8A42E86 at yahoo.com>
Content-Type: text/plain;	charset=us-ascii

Dear Ignacio,

The problem may also have to do with the values in the TransitionMatrix. A reproducible example would be good to have.

Jacob

On 8/05/2012, at 18:32, "ignacio.quintero" <ignacioquinterom at gmail.com> wrote:

> Dear all,
> 
> I have came across the same error using resistanceDistance (and not
> costDistance with same data):
> 
>  "#Get matrix of resistance distances. 
>  Error in Cholesky(Lr) : CHOLMOD factorization was unsuccessful 
>  In addition: Warning message: 
>  In Cholesky(Lr) : 
>    Cholmod warning 'not positive definite' at 
>  file:../Cholesky/t_cholmod_rowfac.c, line 432"
> 
> I was using also a very large raster grid (~5000000 cells). This seems to be
> the problem (do not know if because of memory): I cropped the same big
> raster into a smaller one containing the locality points (and, of course, a
> big frame outside; however, currently, I do not know if the frame extent
> will change the results...) and it worked perfectly.
> 
> Hope this helps (although I would like to know the exact problem (memory or
> other issue) with the resistanceDistance function)
> 
> Best,
> 
> Ignacio
> 
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/gdistance-resistanceDistance-error-tp7076485p7541017.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



------------------------------

Message: 7
Date: Tue, 8 May 2012 18:47:51 -0700 (PDT)
From: "ignacio.quintero" <ignacioquinterom at gmail.com>
To: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] gdistance resistanceDistance error
Message-ID: <1EF2C1D4-C184-4F79-9072-76A6876DC03D at gmail.com>
Content-Type: text/plain; charset=us-ascii

Dear Jacob,

Hope you don't mind if I don't write in the post but directly to you. Actually, as you might suppose, the data is too heavy in order for me to send it. However, I will summ it up: the data is a grid of the American continent with a ~0.05x0.05 degree resolution and values that correspond to the probability of presence (ranging from ~1.5e-7 to ~0.9). There are more than 5000000 cells, but about 2/3 are NA's (is this what is causing the trouble?) I have looked how to remove this NA cells without success (when I rasterize the points, the grid automatically adds a rectangular grid with NAs where no data is found).

Any help would be most appreciated,

Best

Ignacio


On May 8, 2012, at 6:54 PM, Jacob van Etten [via R-sig-geo] wrote:

> Dear Ignacio, 
> 
> The problem may also have to do with the values in the TransitionMatrix. A reproducible example would be good to have. 
> 
> Jacob 
> 
> On 8/05/2012, at 18:32, "ignacio.quintero" <[hidden email]> wrote: 
> 
> > Dear all, 
> > 
> > I have came across the same error using resistanceDistance (and not 
> > costDistance with same data): 
> > 
> >  "#Get matrix of resistance distances. 
> >  Error in Cholesky(Lr) : CHOLMOD factorization was unsuccessful 
> >  In addition: Warning message: 
> >  In Cholesky(Lr) : 
> >    Cholmod warning 'not positive definite' at 
> >  file:../Cholesky/t_cholmod_rowfac.c, line 432" 
> > 
> > I was using also a very large raster grid (~5000000 cells). This seems to be 
> > the problem (do not know if because of memory): I cropped the same big 
> > raster into a smaller one containing the locality points (and, of course, a 
> > big frame outside; however, currently, I do not know if the frame extent 
> > will change the results...) and it worked perfectly. 
> > 
> > Hope this helps (although I would like to know the exact problem (memory or 
> > other issue) with the resistanceDistance function) 
> > 
> > Best, 
> > 
> > Ignacio 
> > 
> > -- 
> > View this message in context: http://r-sig-geo.2731867.n2.nabble.com/gdistance-resistanceDistance-error-tp7076485p7541017.html
> > Sent from the R-sig-geo mailing list archive at Nabble.com. 
> > 
> > _______________________________________________ 
> > R-sig-Geo mailing list 
> > [hidden email] 
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> _______________________________________________ 
> R-sig-Geo mailing list 
> [hidden email] 
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 
> If you reply to this email, your message will be added to the discussion below:
> http://r-sig-geo.2731867.n2.nabble.com/gdistance-resistanceDistance-error-tp7076485p7541075.html
> To unsubscribe from gdistance resistanceDistance error, click here.
> NAML



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/gdistance-resistanceDistance-error-tp7076485p7541430.html
Sent from the R-sig-geo mailing list archive at Nabble.com.



------------------------------

Message: 8
Date: Wed, 9 May 2012 08:43:55 +0000
From: Julian WITTISCHE <jwittische at hotmail.com>
To: <r-sig-geo at r-project.org>
Subject: [R-sig-Geo] convex hull on PCA results of BIOCLIM variables
Message-ID: <DUB112-W10968271E5E1598CBBE5861CF110 at phx.gbl>
Content-Type: text/plain


Dear all,
I have a problem to plot a convex hulls on PCA results. The PCA has reduced the 19 BIOCLIM variables to two axes and I want to plot a convex hull to be able to illustrate the environmental space overlap of two species. 
This is my script:
library(Hmisc);library(ade4);
#Import data
batrabio<-read.table(file="Bioclimfull.txt", sep="\t", header=TRUE);batrabio<-batrabio[,c(1,4:22)];  #To select only species name and the 19 bioclim variables columns      batrapair<-batrabio[batrabio$SCIENTIFIC_NAME=="Batrachoseps minor"|  batrabio$SCIENTIFIC_NAME=="Batrachoseps incognitus",]; #To select two species to compare and illustrate their environmental space
batrapair<-unique(batrapair[,]);#To select only unique localities
#Run PCAs based on columns with climate data
pca.ade4<-dudi.pca(batrapair[,2:20], center=T, scale=T, scannf=T); 2;#number of axes
#Create convex hull using PCA axes, and colour-code points according to species name
convex.hull<-s.chull(pca.ade4$li,as.factor(batrapair$SCIENTIFIC_NAME),add.plot=F, grid=F, clabel=0, origin=c(0,0),addaxes=T,col=c("red","blue"), cpoint=.65) 

I get the axes, the grid, the species name label but nothing else. I would greatly appreciate any advice as I have not been able to figure myself how to solve this problem.
Thank you very much,
Julian 

 		 	   		  
	[[alternative HTML version deleted]]



------------------------------

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


End of R-sig-Geo Digest, Vol 105, Issue 9
*****************************************

From eboyd3 at tigers.lsu.edu  Wed May  9 19:53:26 2012
From: eboyd3 at tigers.lsu.edu (Ezra Boyd)
Date: Wed, 9 May 2012 12:53:26 -0500
Subject: [R-sig-Geo] Integrating R and Arcgis
In-Reply-To: <CAGDt=deKjRfa3=-u8F=3Ligc=892DOVcc5TC=HxoFFmDLgb69A@mail.gmail.com>
References: <CAGDt=deKjRfa3=-u8F=3Ligc=892DOVcc5TC=HxoFFmDLgb69A@mail.gmail.com>
Message-ID: <CAPo57m-NQ+dfE2cinRkSnrw8EWyJryQB_80WUa_wRBmMhgZR6A@mail.gmail.com>

Hi Lalita,

This website was just forwarded to me from a former professor.  It
describes using Arcgis 10 & some R for geomorphology applications:
http://gis4geomorphology.com/

Good Luck!!
Ezra


On Fri, May 4, 2012 at 7:20 AM, Lalita Thakali <lalitathakali at gmail.com> wrote:
> Hi,
>
> I am very new to R. Would anyone help me how R can be used for spatial
> analysis in Arcgis. I will really appreciate for any information related to
> using R in arcgis or integrating R in Arcgis.
>
> Thanks.
> Regards,
> Lalita
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Roger.Bivand at nhh.no  Wed May  9 20:01:39 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 9 May 2012 20:01:39 +0200 (CEST)
Subject: [R-sig-Geo] Integrating R and Arcgis
In-Reply-To: <CAPo57m-NQ+dfE2cinRkSnrw8EWyJryQB_80WUa_wRBmMhgZR6A@mail.gmail.com>
References: <CAGDt=deKjRfa3=-u8F=3Ligc=892DOVcc5TC=HxoFFmDLgb69A@mail.gmail.com>
	<CAPo57m-NQ+dfE2cinRkSnrw8EWyJryQB_80WUa_wRBmMhgZR6A@mail.gmail.com>
Message-ID: <alpine.LRH.2.02.1205091958150.16117@reclus.nhh.no>

On Wed, 9 May 2012, Ezra Boyd wrote:

> Hi Lalita,
>
> This website was just forwarded to me from a former professor.  It
> describes using Arcgis 10 & some R for geomorphology applications:
> http://gis4geomorphology.com/

I don't think that Konstantin Krivoruchko's excellent DVD-book, for 
example at:

http://esripress.esri.com/display/index.cfm?fuseaction=display&websiteID=194

and elsewhere, has been mentioned so far. There is an R chapter and 
appendix.

Roger

>
> Good Luck!!
> Ezra
>
>
> On Fri, May 4, 2012 at 7:20 AM, Lalita Thakali <lalitathakali at gmail.com> wrote:
>> Hi,
>>
>> I am very new to R. Would anyone help me how R can be used for spatial
>> analysis in Arcgis. I will really appreciate for any information related to
>> using R in arcgis or integrating R in Arcgis.
>>
>> Thanks.
>> Regards,
>> Lalita
>>
>> ? ? ? ?[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From samanmonfared1 at gmail.com  Wed May  9 20:06:22 2012
From: samanmonfared1 at gmail.com (Saman Monfared)
Date: Wed, 9 May 2012 22:36:22 +0430
Subject: [R-sig-Geo] optimization with nlm
Message-ID: <CAOytA4bAHcSnXbu78VRbLP4aNvW09QDmpHdNJ9FzXF9p_naXkg@mail.gmail.com>

Dear All.
I am very new in R.
I am trying to fit a spatio-temporal model on empirical covarance.
I calculate spatio-temporal empirical covarince that is a matrix and
now I want fit a covariance model like :

f <- function(h,u,alpha,phi)
{
exp(-alpha*u*phi)*besselJ(h*phi, nu=1)
}

How can I optimize parameters of a model?
How can I use nlm?
I read an example in help of nlm but I couldnt understand it.
Help me.

-- 

Saman Monfared
Msc Student,
Department of Statistics, Shiraz University,
Shiraz 71454, Iran
Email: Samanmonfared1 at gmail.com

Tel: +98 917 5305167


From gianni.lavaredo at gmail.com  Wed May  9 20:10:02 2012
From: gianni.lavaredo at gmail.com (gianni lavaredo)
Date: Wed, 9 May 2012 20:10:02 +0200
Subject: [R-sig-Geo] Some questions about using RASTER library and
 randomForest to classify radar image and Landsat.
Message-ID: <CAJ6JbR8f2n3KK_-VK64ptioTmzVzzDfM3R2c97C2t6TbVeiATg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120509/91834b47/attachment.pl>

From edzer.pebesma at uni-muenster.de  Wed May  9 20:28:27 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Wed, 09 May 2012 20:28:27 +0200
Subject: [R-sig-Geo] Antw: Re:  Intersection of Polygons (sp)
In-Reply-To: <4FAAACA70200002700013F6E@gwia2.boku.ac.at>
References: <4FAA883E0200002700013F61@gwia2.boku.ac.at>
	<4FAA6F2A.5010907@uni-muenster.de>
	<4FAAACA70200002700013F6E@gwia2.boku.ac.at>
Message-ID: <4FAAB74B.9090402@uni-muenster.de>



On 05/09/2012 05:43 PM, Matteo Mattiuzzi wrote:
> Dear Edzer, thanks for your answer.
>  
> Attributes: ok so I mixed "ID" of the Polygon with an "attribute".
> Basically I just want to get the "ID" of those polygons (ie: "h18v04")

> names(sr[spos,])
[1] "h05v04" "h06v04" "h18v04" "h19v04" "h29v04" "h30v04"

>  
> #The plot of:
> library(rgeos)
> x = sr[spos,] # you could omit the , as sr has no attributes
> plot(x)
> # indicates that the polygons don't close in the way I want it. Polygons
> crossing lon +-180 close by crossing the entire globe and not crossing
> the line lon +-180...Is there a way to control this?

I recall there has been discussion about the issue on this list before.
Only 15K messages to go through, according to
http://r-project.markmail.org/search/?q=r-sig-geo ;-)

>  
> Thanks Matteo  
>  
>  
>>>> Edzer Pebesma <edzer.pebesma at uni-muenster.de> 5/9/2012 3:20 pm >>>
> 
> 
> On 05/09/2012 03:07 PM, Matteo Mattiuzzi wrote:
>> Dear List,
>> 
>> I have a table with corner coordinates:
>> 
>>
> download.file("http://landweb.nascom.nasa.gov/developers/sn_tiles/sn_gring_10deg.txt",
> dest=paste(tempdir(),"/sn_gring_10deg.txt",sep=""))
>> x <-
> read.table(paste(tempdir(),"/sn_gring_10deg.txt",sep=""),skip=7,nrows=648)
>> colnames(x) <-
> c("iv","ih","lllon","lllat","ullon","ullat","urlon","urlat","lrlon","lrlat")
>> x <- x[x$lllon != -999,] # remove not valid tiles
>> x[1:5,]
>> 
>> # and I wish to create polygons for each of the rows of "x".
>> require(sp)
>> tilepolys <- list()
>> for (u in 1:nrow(x)){
>> attribute <- paste("h", sprintf("%02d", x$ih[u]), "v", sprintf("%02d",
> x$iv[u]),sep="")
>> tilepolys[[u]] <-
> Polygons(list(Polygon(cbind(c(x$ullon[u],x$urlon[u],x$lrlon[u],x$lllon[u],x$ullon[u]),c(x$ullat[u],x$urlat[u],x$lrlat[u],x$lllat[u],x$ullat[u])),hole=FALSE)),attribute)
>> }
>> sr=SpatialPolygons(tilepolys)
>> 
>> plot(sr)
>> # some polygons are crossing the lon +-180 limit and they should close
> the on the right side (crossing that border and not the globe). I don't
> understand if this happens here? And if there is a way to control it?
>> #######################
>> # I have a second polygon:
>> po  <-
> Polygon(cbind(c(9.533616,17.16639,17.16639,9.533616,9.533616),c(49.01889,49.01889,46.38557,46.38557,49.01889)),hole=FALSE)
>> pos <- Polygons(list(po),"austria")
>> spos <- SpatialPolygons(list(pos))
>> 
>> plot(spos)
>> 
>> # Now I want to select (or better get the attribute of) every polygon
> in "sr" that is inside or touches the polygon "spos"?
>> 
> sr does not have attributes.
> 
>> I hope this is possible to do with "sp", in order to avoid further
> dependencies.
> 
> not without rgeos:
> 
> library(rgeos)
> x = sr[spos,] # you could omit the , as sr has no attributes
> plot(x)
> 
>> 
>> Thanks a lot, Matteo
>> 
>> 
>> 
>> 
>> 
>> 
>>
>> [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> -- 
> Edzer Pebesma
> Institute for Geoinformatics (ifgi), University of M?nster
> Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
> 8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
> http://www.52north.org/geostatistics      e.pebesma at wwu.de
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From mathieu.rajerison at gmail.com  Thu May 10 09:27:37 2012
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Thu, 10 May 2012 09:27:37 +0200
Subject: [R-sig-Geo] analyzing spatial segregation of sexes
In-Reply-To: <C1524BE4BF45454293B8DF38FB9B5ECAD310DE@MS-EX1VKS.erdc.dren.mil>
References: <C1524BE4BF45454293B8DF38FB9B5ECAD310DE@MS-EX1VKS.erdc.dren.mil>
Message-ID: <CAGfc75nfPtTFvA_PEqOH=3Xq=zeKsuw2xYsDP+6G7Fc9r9-L7g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120510/24728f45/attachment.pl>

From Maximilian.Spross at uibk.ac.at  Thu May 10 10:50:17 2012
From: Maximilian.Spross at uibk.ac.at (=?ISO-8859-15?Q?Maximilian_Spro=DF?=)
Date: Thu, 10 May 2012 10:50:17 +0200
Subject: [R-sig-Geo] Missing local R-squared and residuals in gwr output
In-Reply-To: <alpine.LRH.2.02.1205091312330.16117@reclus.nhh.no>
References: <4FA3FF6A.3090005@uibk.ac.at> <4FA40304.2050503@uibk.ac.at>
	<alpine.LRH.2.02.1205051616590.27123@reclus.nhh.no>
	<4FA7C25D.9070303@uibk.ac.at>
	<alpine.LRH.2.02.1205071446450.3968@reclus.nhh.no>
	<3A0ABF309258464FAFF2D91B6E6874840599CB25@VEX01.uibk.ac.at>
	<alpine.LRH.2.02.1205072044470.3968@reclus.nhh.no>
	<4FAA467C.2070805@uibk.ac.at>
	<alpine.LRH.2.02.1205091312330.16117@reclus.nhh.no>
Message-ID: <4FAB8149.9010406@uibk.ac.at>

Dear Roger!

Your are right, there are no problems anymore. I did some some 
comparative tests with a small subset of the dataset. The number of 
values in the "pred" column, which are not finite depends on the 
bandwidth. With increasing bandwidth, the NA's disappear.

Unfortunately, I cannot compute gwr.sel due to the large data amount.

By the way, all problems are solved and the use of the cluster is a 
really nice feature to decrease processing time efficiently.

Thank you very much for your help!

Max

On 05/09/2012 01:19 PM, Roger Bivand wrote:
> On Wed, 9 May 2012, Maximilian Spro? wrote:
>
>> Thank you Roger! The gwr on the MPI cluster works fine.
>>
>> However, now the output object includes the intially missing three 
>> data slots: "gwr.e","pred" and "localR2". Unfortunately, the latter 
>> contains only NA's.
>> Sorry for of any inconvenience, but do you think you can solve that?
>
> I do not see any problem there, and indeed it is after the results 
> have been returned from the cluster. You can tell whether you have 
> been into the code block starting on line 261 in spgwr/R/gwr.R if 
> there is no line beginning with "postprocess_localR2" in the timings 
> component of the output object. The conditions are:
>
> ((!fp.given || fit_are_data) && is.null(fittedGWRobject))
>
> where the first is FALSE, the second TRUE and the third TRUE in your 
> case. If the "pred" column in your output contains values that are not 
> finite, this may happen in this code block.
>
> If you cannot see what is going on, we need a smaller test data set 
> that replicates the problem.
>
> Roger
>
>>
>> Thanks in advance and all the best,
>>
>> Max
>>
>>
>> On 05/07/2012 08:45 PM, Roger Bivand wrote:
>>> On Mon, 7 May 2012, "Spro?, Johann" wrote:
>>>
>>>>
>>>>
>>>>
>>>> -- 
>>>> Mag. J. Maximilian Spro?
>>>> Institute of Geography, University of Innsbruck
>>>> Innrain 52
>>>> A-6020 INNSBRUCK
>>>>
>>>> Tel. +43 (0)512 507 5413
>>>> web: http://www.uibk.ac.at/geographie/projects/lidar/
>>>>
>>>>
>>>>
>>>> -----Urspr?ngliche Nachricht-----
>>>> Von: Roger Bivand [mailto:Roger.Bivand at nhh.no]
>>>> Gesendet: Mo 07.05.2012 14:48
>>>> An: Maximilian Spro?
>>>> Cc: r-sig-geo
>>>> Betreff: Re: [R-sig-Geo] Missing local R-squared and residuals in 
>>>> gwr output
>>>>
>>>> On Mon, 7 May 2012, Maximilian Spro? wrote:
>>>>
>>>>> Dear Roger!
>>>>>
>>>>> Thank you very much for your fast reply and work!
>>>>>
>>>>> I'm not really an expert in HPC-computing, but i will try to 
>>>>> report as goog
>>>>> as i can.
>>>>>
>>>>> I updated spgwr and started a job on the cluster which takes 
>>>>> normally 1,5 h.
>>>>> So far, it run for 5 hours, which indicates that the 
>>>>> parallelization does not
>>>>> work efficient anymore. The function makeCluster(64, type="MPI") 
>>>>> worked fine.
>>>>> Our cluster runs with openMPI.
>>>>
>>>> Correct. I'll try to add back an option to use snow instead of 
>>>> parallel.
>>>>
>>>> I tried out the new version but it seems still using parallel.
>>>>
>>>> code:
>>>>
>>>> gwr_50 <- 
>>>> gwr(hef at data$DIF~hef at data$ELEVATION+hef at data$SKY+hef at data$SLOPE+hef at data$SOLAR+factor(asp_fac), 
>>>> data=hef, bandwidth=50, gweight=gwr.Gauss,fit.points=coords, 
>>>> hatmatrix=FALSE, cl=cl)
>>>
>>> Add use_snow=TRUE to the command to switch to snow.
>>>
>>> Roger
>>>
>>>> Loading required package: parallel
>>>>
>>>> Attaching package: 'parallel'
>>>>
>>>> The following object(s) are masked from 'package:snow':
>>>>
>>>>    clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,
>>>>    clusterExport, clusterMap, clusterSplit, makeCluster, parApply,
>>>>    parCapply, parLapply, parRapply, parSapply, splitIndices,
>>>>    stopCluster
>>>>
>>>> Max
>>>>
>>>>
>>>> When it reaches R-forge, its revision number will be > 1252.
>>>>
>>>> Roger
>>>>
>>>>>
>>>>> In that context, i found on the CRAN Task view: High-Performance 
>>>>> and Parallel
>>>>> Computing with R the following:
>>>>> "<http://www.dict.cc/englisch-deutsch/parallelization.html>Direct 
>>>>> support in
>>>>> R is starting with release 2.14.0 which includes a new package 
>>>>> parallel
>>>>> incorporating (slightly revised) copies of packages multicore and 
>>>>> snow (*but
>>>>> excluding MPI, PVM and NWS clusters*). Does the new parallel 
>>>>> support works
>>>>> still in the openMPI environment?
>>>>>
>>>>> regards,
>>>>>
>>>>> Max
>>>>>
>>>>> fyi:
>>>>>
>>>>> sessionInfo()
>>>>> R version 2.14.0 (2011-10-31)
>>>>> Platform: x86_64-unknown-linux-gnu (64-bit)
>>>>>
>>>>> locale:
>>>>> [1] LC_CTYPE=en_US       LC_NUMERIC=C         LC_TIME=en_US
>>>>> [4] LC_COLLATE=en_US     LC_MONETARY=en_US    LC_MESSAGES=en_US
>>>>> [7] LC_PAPER=C           LC_NAME=C            LC_ADDRESS=C
>>>>> [10] LC_TELEPHONE=C       LC_MEASUREMENT=en_US LC_IDENTIFICATION=C
>>>>>
>>>>> attached base packages:
>>>>> [1] parallel  stats     graphics  grDevices utils     datasets  
>>>>> methods
>>>>> [8] base
>>>>>
>>>>> other attached packages:
>>>>> [1] spgwr_0.6-15    spdep_0.5-45    coda_0.14-6     deldir_0.0-16
>>>>> [5] maptools_0.8-10 foreign_0.8-46  nlme_3.1-102    MASS_7.3-16
>>>>> [9] Matrix_1.0-1    lattice_0.20-0  boot_1.3-3      gstat_1.0-10
>>>>> [13] spacetime_0.5-7 xts_0.8-2       zoo_1.7-6       sp_0.9-98
>>>>> [17] snow_0.3-8      Rmpi_0.5-9
>>>>>
>>>>> loaded via a namespace (and not attached):
>>>>> [1] grid_2.14.0
>>>>>
>>>>>
>>>>> On 05/05/2012 04:24 PM, Roger Bivand wrote:
>>>>>> On Fri, 4 May 2012, Maximilian Spro? wrote:
>>>>>>
>>>>>>> Dear r-sig-geo list!
>>>>>>>
>>>>>>> I run gwr on a multi-node cluster(on 64 slots). In the gwr 
>>>>>>> output (slot
>>>>>>> "SDF"), the gwr residuals and the local R-squared are missing. When
>>>>>>> performing the same model on the local machine, these components 
>>>>>>> are
>>>>>>> included. Unfortunately, the calculation in this way takes about 
>>>>>>> 5 days
>>>>>>> instead of few hours when using the cluster.
>>>>>>>
>>>>>>> Perhaps, that problem arises due to the argument "fit.points", 
>>>>>>> which has
>>>>>>> to be passed if the local coefficient estimates should be made on a
>>>>>>> multi node cluster.
>>>>>>>
>>>>>>> Does anyone have an idea how to solve that problem with the missing
>>>>>>> local R-squared and residuals if the gwr is calculated on a 
>>>>>>> cluster?
>>>>>>
>>>>>> The understanding for use on a cluster was that the data points 
>>>>>> and the fit
>>>>>> points are different, so there is no observed dependent variable 
>>>>>> at the fit
>>>>>> point, hence no local R2. I've added logic in the code that 
>>>>>> checks for
>>>>>> equality between the fit and data points, and this for me 
>>>>>> resolves the
>>>>>> problem, but may break other things. I've committed to R-forge, 
>>>>>> project
>>>>>> rspatial, module spgwr. The source tarball and binary packages 
>>>>>> should be
>>>>>> available later this evening European time from:
>>>>>>
>>>>>> https://r-forge.r-project.org/R/?group_id=1014
>>>>>>
>>>>>> Could you please try it out, and report back? I should also 
>>>>>> migrate spgwr
>>>>>> from snow to parallel before I release it.
>>>>>>
>>>>>> Best wishes,
>>>>>>
>>>>>> Roger
>>>>>>
>>>>>>>
>>>>>>>
>>>>>>> Thank you very much in advance!
>>>>>>>
>>>>>>> Kind regards,
>>>>>>>
>>>>>>> Max
>>>>>>>
>>>>>>>
>>>>>>> selected R-code:
>>>>>>>
>>>>>>> ### gwr on local machine:
>>>>>>>
>>>>>>> gwr_50 <-
>>>>>>> gwr(hef at data$DIF~hef at data$ELEVATION+hef at data$SKY+hef at data$SLOPE+hef at data$SOLAR, 
>>>>>>> data=hef, bandwidth=50, gweight=gwr.Gauss)
>>>>>>>
>>>>>>>
>>>>>>> # part of the  str(gwr_50) output...
>>>>>>>
>>>>>>>
>>>>>>> List of 11
>>>>>>>  $ SDF      :Formal class 'SpatialPointsDataFrame' [package 
>>>>>>> "sp"] with 5
>>>>>>> slots
>>>>>>>   .. ..@ data       :'data.frame':    286288 obs. of  9 variables:
>>>>>>>   .. .. ..$ sum.w      : num [1:286288] 2009 2003 2091 2089 2086 
>>>>>>> ...
>>>>>>>   .. .. ..$ (Intercept): num [1:286288] -28.7 -28.5 -29.9 -29.7 
>>>>>>> -29.5 ...
>>>>>>>   .. .. ..$ elevation  : num [1:286288] 0.0139 0.0138 0.014 
>>>>>>> 0.014 0.014
>>>>>>> ...
>>>>>>>   .. .. ..$ sky        : num [1:286288] -0.153 -0.155 -0.146 
>>>>>>> -0.148 -0.149
>>>>>>> ...
>>>>>>>   .. .. ..$ slope      : num [1:286288] -2.58 -2.61 -2.42 -2.45 
>>>>>>> -2.48 ...
>>>>>>>   .. .. ..$ solar      : num [1:286288] -0.00139 -0.00136 
>>>>>>> -0.0015 -0.00147
>>>>>>> -0.00144 ...
>>>>>>>   .. .. ..$ gwr.e      : num [1:286288] -0.461 -0.683 -0.5987 
>>>>>>> -0.2692
>>>>>>> 0.0406 ...
>>>>>>>   .. .. ..$ pred       : num [1:286288] 0.806 0.833 0.507 0.514 
>>>>>>> 0.576 ...
>>>>>>>   .. .. ..$ localR2    : num [1:286288] 0.621 0.618 0.638 0.635 
>>>>>>> 0.632 ...
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>> ### gwr on cluster :
>>>>>>>
>>>>>>> cl <- makeCluster(32, type="MPI")
>>>>>>>
>>>>>>> coords <- coordinates(hef)
>>>>>>>
>>>>>>> gw <-
>>>>>>> gwr(hef at data$DIF~hef at data$ELEVATION+hef at data$SKY+hef at data$SLOPE+hef at data$SOLAR, 
>>>>>>> data=hef, bandwidth=50, gweight=gwr.Gauss,fit.points=coords,
>>>>>>> hatmatrix=FALSE, cl=cl)
>>>>>>>
>>>>>>> # part of the  str(gwr_50) output...
>>>>>>>
>>>>>>> List of 11
>>>>>>>  $ SDF      :Formal class 'SpatialPointsDataFrame' [package 
>>>>>>> "sp"] with 5
>>>>>>> slots
>>>>>>>   .. ..@ data       :'data.frame':    286288 obs. of  6 variables:
>>>>>>>   .. .. ..$ sum.w      : num [1:286288] 1 1 1 1 1 ...
>>>>>>>   .. .. ..$ (Intercept): num [1:286288] 12541 1970 2057 -1505 
>>>>>>> -1030 ...
>>>>>>>   .. .. ..$ elevation  : num [1:286288] -3.891 -0.602 -0.738 
>>>>>>> 0.465 0.309
>>>>>>> ...
>>>>>>>   .. .. ..$ sky        : num [1:286288] -0.954 -0.425 3.714 
>>>>>>> 0.159 0.152
>>>>>>> ...
>>>>>>>   .. .. ..$ slope      : num [1:286288] 62.19 NA -27.21 1.95 
>>>>>>> 16.03 ...
>>>>>>>   .. .. ..$ solar      : num [1:286288] NA NA NA NA 0.042 ...
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>     [[alternative HTML version deleted]]
>>>>>>>
>>>>>>> _______________________________________________
>>>>>>> R-sig-Geo mailing list
>>>>>>> R-sig-Geo at r-project.org
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>>>
>>>>>>
>>>>>
>>>>>
>>>>>
>>>>
>>>> -- 
>>>> Roger Bivand
>>>> Department of Economics, NHH Norwegian School of Economics,
>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>>> e-mail: Roger.Bivand at nhh.no
>>>>
>>>>
>>>
>>
>>
>


From marcelino.delacruz at upm.es  Thu May 10 11:03:24 2012
From: marcelino.delacruz at upm.es (Marcelino de la Cruz)
Date: Thu, 10 May 2012 11:03:24 +0200
Subject: [R-sig-Geo] analyzing spatial segregation of sexes
In-Reply-To: <CAGfc75nfPtTFvA_PEqOH=3Xq=zeKsuw2xYsDP+6G7Fc9r9-L7g@mail.g
	mail.com>
References: <C1524BE4BF45454293B8DF38FB9B5ECAD310DE@MS-EX1VKS.erdc.dren.mil>
	<CAGfc75nfPtTFvA_PEqOH=3Xq=zeKsuw2xYsDP+6G7Fc9r9-L7g@mail.gmail.com>
Message-ID: <201205100903.q4A93UJW024822@smtp.upm.es>

Hi,

with respect to the implementation of the "Bivariate i.e.2-type point 
pattern (see package 'spatstat')" you may do something like this:

library(spatstat)

plants.ppp <- ppp( x = example$x, y =example$y, marks=factor(sex), 
window = yourwindow),

where "example" is a data.frame with your data and  "yourwindow" are 
the boundaries of your study area. See help (ppp) and help (owin) to 
see several ways of specifying the window. If you are impatient and 
have many points you could try this:

plants.ppp <- ppp( x = example$x, y =example$y, marks=factor(sex), 
xrange=range(example$x), yrange = range(example$y))


Asessing segregation in spatstat would imply computing differences of 
univariata and bivariate functions;e.g., to compute the segregation 
of females you should do:

Kff <- Kcross(plants.ppp, i="F", j="F")
Kfm <- Kcross(plants.ppp, i="F", j="M")

D <- eval.fv(Kff-Kfm)

Ploting this function [i.e,  plot(D)] would show you at which scales 
(if any) D > 0 (segregation of female sex) or D < 
0  ("overdispersion" ?of female sex).

By the way, function K1K2 in package ecespa implements test of these 
functions against a null model of random labeling.

HTH,

Marcelino



At 09:27 10/05/2012, Mathieu Rajerison wrote:
>Hi!
>
>Why not use, for example, KCross spatstat function, given two point
>patterns: one for male individuals and one for female ones?
>
>
>2012/5/9 Wall, Wade A ERDC-RDE-CERL-IL <Wade.A.Wall at usace.army.mil>
>
> > Hi all,
> >
> > I have a data set that consists of x,y coordinates for individual plants,
> > along with sex of the individual.
> >
> > Example
> >
> > Ind     sex     x       y
> > 1       F       10      5
> > 2       M       9       4
> > . . .
> > 200     M       20      4
> >
> > for 20 populations of the species. I would like to know if males and
> > females are randomly dispersed, or tend to segregate.
> >
> > I would like to use Philip Dixon's method (1994), and there is an
> > implementation in the R package "spatialsegregation" (dixon(X, prepR=0)).
> > However,
> > I am not very familiar with spatial analyses in R and am not sure how to
> > structure the input object X. The function description says "Bivariate i.e.
> > 2-type point pattern (see package 'spatstat')"
> >
> > Does anyone know how to structure the data that I have (example above) so
> > that I can use dixon()? Thanks for any help.
> >
> > Wade A. Wall
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
>         [[alternative HTML version deleted]]
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Roger.Bivand at nhh.no  Thu May 10 11:10:16 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 10 May 2012 11:10:16 +0200 (CEST)
Subject: [R-sig-Geo] Missing local R-squared and residuals in gwr output
In-Reply-To: <4FAB8149.9010406@uibk.ac.at>
References: <4FA3FF6A.3090005@uibk.ac.at> <4FA40304.2050503@uibk.ac.at>
	<alpine.LRH.2.02.1205051616590.27123@reclus.nhh.no>
	<4FA7C25D.9070303@uibk.ac.at>
	<alpine.LRH.2.02.1205071446450.3968@reclus.nhh.no>
	<3A0ABF309258464FAFF2D91B6E6874840599CB25@VEX01.uibk.ac.at>
	<alpine.LRH.2.02.1205072044470.3968@reclus.nhh.no>
	<4FAA467C.2070805@uibk.ac.at>
	<alpine.LRH.2.02.1205091312330.16117@reclus.nhh.no>
	<4FAB8149.9010406@uibk.ac.at>
Message-ID: <alpine.LRH.2.02.1205101109210.20442@reclus.nhh.no>

On Thu, 10 May 2012, Maximilian Spro? wrote:

> Dear Roger!
>
> Your are right, there are no problems anymore. I did some some comparative 
> tests with a small subset of the dataset. The number of values in the "pred" 
> column, which are not finite depends on the bandwidth. With increasing 
> bandwidth, the NA's disappear.
>
> Unfortunately, I cannot compute gwr.sel due to the large data amount.
>
> By the way, all problems are solved and the use of the cluster is a really 
> nice feature to decrease processing time efficiently.

Thanks for checking and reporting back. I'll release to CRAN shortly.

Best wishes,

Roger

>
> Thank you very much for your help!
>
> Max
>
> On 05/09/2012 01:19 PM, Roger Bivand wrote:
>> On Wed, 9 May 2012, Maximilian Spro? wrote:
>> 
>>> Thank you Roger! The gwr on the MPI cluster works fine.
>>> 
>>> However, now the output object includes the intially missing three data 
>>> slots: "gwr.e","pred" and "localR2". Unfortunately, the latter contains 
>>> only NA's.
>>> Sorry for of any inconvenience, but do you think you can solve that?
>> 
>> I do not see any problem there, and indeed it is after the results have 
>> been returned from the cluster. You can tell whether you have been into the 
>> code block starting on line 261 in spgwr/R/gwr.R if there is no line 
>> beginning with "postprocess_localR2" in the timings component of the output 
>> object. The conditions are:
>> 
>> ((!fp.given || fit_are_data) && is.null(fittedGWRobject))
>> 
>> where the first is FALSE, the second TRUE and the third TRUE in your case. 
>> If the "pred" column in your output contains values that are not finite, 
>> this may happen in this code block.
>> 
>> If you cannot see what is going on, we need a smaller test data set that 
>> replicates the problem.
>> 
>> Roger
>> 
>>> 
>>> Thanks in advance and all the best,
>>> 
>>> Max
>>> 
>>> 
>>> On 05/07/2012 08:45 PM, Roger Bivand wrote:
>>>> On Mon, 7 May 2012, "Spro?, Johann" wrote:
>>>> 
>>>>> 
>>>>> 
>>>>> 
>>>>> -- 
>>>>> Mag. J. Maximilian Spro?
>>>>> Institute of Geography, University of Innsbruck
>>>>> Innrain 52
>>>>> A-6020 INNSBRUCK
>>>>> 
>>>>> Tel. +43 (0)512 507 5413
>>>>> web: http://www.uibk.ac.at/geographie/projects/lidar/
>>>>> 
>>>>> 
>>>>> 
>>>>> -----Urspr?ngliche Nachricht-----
>>>>> Von: Roger Bivand [mailto:Roger.Bivand at nhh.no]
>>>>> Gesendet: Mo 07.05.2012 14:48
>>>>> An: Maximilian Spro?
>>>>> Cc: r-sig-geo
>>>>> Betreff: Re: [R-sig-Geo] Missing local R-squared and residuals in gwr 
>>>>> output
>>>>> 
>>>>> On Mon, 7 May 2012, Maximilian Spro? wrote:
>>>>> 
>>>>>> Dear Roger!
>>>>>> 
>>>>>> Thank you very much for your fast reply and work!
>>>>>> 
>>>>>> I'm not really an expert in HPC-computing, but i will try to report as 
>>>>>> goog
>>>>>> as i can.
>>>>>> 
>>>>>> I updated spgwr and started a job on the cluster which takes normally 
>>>>>> 1,5 h.
>>>>>> So far, it run for 5 hours, which indicates that the parallelization 
>>>>>> does not
>>>>>> work efficient anymore. The function makeCluster(64, type="MPI") worked 
>>>>>> fine.
>>>>>> Our cluster runs with openMPI.
>>>>> 
>>>>> Correct. I'll try to add back an option to use snow instead of parallel.
>>>>> 
>>>>> I tried out the new version but it seems still using parallel.
>>>>> 
>>>>> code:
>>>>> 
>>>>> gwr_50 <- 
>>>>> gwr(hef at data$DIF~hef at data$ELEVATION+hef at data$SKY+hef at data$SLOPE+hef at data$SOLAR+factor(asp_fac), 
>>>>> data=hef, bandwidth=50, gweight=gwr.Gauss,fit.points=coords, 
>>>>> hatmatrix=FALSE, cl=cl)
>>>> 
>>>> Add use_snow=TRUE to the command to switch to snow.
>>>> 
>>>> Roger
>>>> 
>>>>> Loading required package: parallel
>>>>> 
>>>>> Attaching package: 'parallel'
>>>>> 
>>>>> The following object(s) are masked from 'package:snow':
>>>>>
>>>>>    clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,
>>>>>    clusterExport, clusterMap, clusterSplit, makeCluster, parApply,
>>>>>    parCapply, parLapply, parRapply, parSapply, splitIndices,
>>>>>    stopCluster
>>>>> 
>>>>> Max
>>>>> 
>>>>> 
>>>>> When it reaches R-forge, its revision number will be > 1252.
>>>>> 
>>>>> Roger
>>>>> 
>>>>>> 
>>>>>> In that context, i found on the CRAN Task view: High-Performance and 
>>>>>> Parallel
>>>>>> Computing with R the following:
>>>>>> "<http://www.dict.cc/englisch-deutsch/parallelization.html>Direct 
>>>>>> support in
>>>>>> R is starting with release 2.14.0 which includes a new package parallel
>>>>>> incorporating (slightly revised) copies of packages multicore and snow 
>>>>>> (*but
>>>>>> excluding MPI, PVM and NWS clusters*). Does the new parallel support 
>>>>>> works
>>>>>> still in the openMPI environment?
>>>>>> 
>>>>>> regards,
>>>>>> 
>>>>>> Max
>>>>>> 
>>>>>> fyi:
>>>>>> 
>>>>>> sessionInfo()
>>>>>> R version 2.14.0 (2011-10-31)
>>>>>> Platform: x86_64-unknown-linux-gnu (64-bit)
>>>>>> 
>>>>>> locale:
>>>>>> [1] LC_CTYPE=en_US       LC_NUMERIC=C         LC_TIME=en_US
>>>>>> [4] LC_COLLATE=en_US     LC_MONETARY=en_US    LC_MESSAGES=en_US
>>>>>> [7] LC_PAPER=C           LC_NAME=C            LC_ADDRESS=C
>>>>>> [10] LC_TELEPHONE=C       LC_MEASUREMENT=en_US LC_IDENTIFICATION=C
>>>>>> 
>>>>>> attached base packages:
>>>>>> [1] parallel  stats     graphics  grDevices utils     datasets  methods
>>>>>> [8] base
>>>>>> 
>>>>>> other attached packages:
>>>>>> [1] spgwr_0.6-15    spdep_0.5-45    coda_0.14-6     deldir_0.0-16
>>>>>> [5] maptools_0.8-10 foreign_0.8-46  nlme_3.1-102    MASS_7.3-16
>>>>>> [9] Matrix_1.0-1    lattice_0.20-0  boot_1.3-3      gstat_1.0-10
>>>>>> [13] spacetime_0.5-7 xts_0.8-2       zoo_1.7-6       sp_0.9-98
>>>>>> [17] snow_0.3-8      Rmpi_0.5-9
>>>>>> 
>>>>>> loaded via a namespace (and not attached):
>>>>>> [1] grid_2.14.0
>>>>>> 
>>>>>> 
>>>>>> On 05/05/2012 04:24 PM, Roger Bivand wrote:
>>>>>>> On Fri, 4 May 2012, Maximilian Spro? wrote:
>>>>>>> 
>>>>>>>> Dear r-sig-geo list!
>>>>>>>> 
>>>>>>>> I run gwr on a multi-node cluster(on 64 slots). In the gwr output 
>>>>>>>> (slot
>>>>>>>> "SDF"), the gwr residuals and the local R-squared are missing. When
>>>>>>>> performing the same model on the local machine, these components are
>>>>>>>> included. Unfortunately, the calculation in this way takes about 5 
>>>>>>>> days
>>>>>>>> instead of few hours when using the cluster.
>>>>>>>> 
>>>>>>>> Perhaps, that problem arises due to the argument "fit.points", which 
>>>>>>>> has
>>>>>>>> to be passed if the local coefficient estimates should be made on a
>>>>>>>> multi node cluster.
>>>>>>>> 
>>>>>>>> Does anyone have an idea how to solve that problem with the missing
>>>>>>>> local R-squared and residuals if the gwr is calculated on a cluster?
>>>>>>> 
>>>>>>> The understanding for use on a cluster was that the data points and 
>>>>>>> the fit
>>>>>>> points are different, so there is no observed dependent variable at 
>>>>>>> the fit
>>>>>>> point, hence no local R2. I've added logic in the code that checks for
>>>>>>> equality between the fit and data points, and this for me resolves the
>>>>>>> problem, but may break other things. I've committed to R-forge, 
>>>>>>> project
>>>>>>> rspatial, module spgwr. The source tarball and binary packages should 
>>>>>>> be
>>>>>>> available later this evening European time from:
>>>>>>> 
>>>>>>> https://r-forge.r-project.org/R/?group_id=1014
>>>>>>> 
>>>>>>> Could you please try it out, and report back? I should also migrate 
>>>>>>> spgwr
>>>>>>> from snow to parallel before I release it.
>>>>>>> 
>>>>>>> Best wishes,
>>>>>>> 
>>>>>>> Roger
>>>>>>> 
>>>>>>>> 
>>>>>>>> 
>>>>>>>> Thank you very much in advance!
>>>>>>>> 
>>>>>>>> Kind regards,
>>>>>>>> 
>>>>>>>> Max
>>>>>>>> 
>>>>>>>> 
>>>>>>>> selected R-code:
>>>>>>>> 
>>>>>>>> ### gwr on local machine:
>>>>>>>> 
>>>>>>>> gwr_50 <-
>>>>>>>> gwr(hef at data$DIF~hef at data$ELEVATION+hef at data$SKY+hef at data$SLOPE+hef at data$SOLAR, 
>>>>>>>> data=hef, bandwidth=50, gweight=gwr.Gauss)
>>>>>>>> 
>>>>>>>> 
>>>>>>>> # part of the  str(gwr_50) output...
>>>>>>>> 
>>>>>>>> 
>>>>>>>> List of 11
>>>>>>>>  $ SDF      :Formal class 'SpatialPointsDataFrame' [package "sp"] 
>>>>>>>> with 5
>>>>>>>> slots
>>>>>>>>   .. ..@ data       :'data.frame':    286288 obs. of  9 variables:
>>>>>>>>   .. .. ..$ sum.w      : num [1:286288] 2009 2003 2091 2089 2086 ...
>>>>>>>>   .. .. ..$ (Intercept): num [1:286288] -28.7 -28.5 -29.9 -29.7 -29.5 
>>>>>>>> ...
>>>>>>>>   .. .. ..$ elevation  : num [1:286288] 0.0139 0.0138 0.014 0.014 
>>>>>>>> 0.014
>>>>>>>> ...
>>>>>>>>   .. .. ..$ sky        : num [1:286288] -0.153 -0.155 -0.146 -0.148 
>>>>>>>> -0.149
>>>>>>>> ...
>>>>>>>>   .. .. ..$ slope      : num [1:286288] -2.58 -2.61 -2.42 -2.45 -2.48 
>>>>>>>> ...
>>>>>>>>   .. .. ..$ solar      : num [1:286288] -0.00139 -0.00136 -0.0015 
>>>>>>>> -0.00147
>>>>>>>> -0.00144 ...
>>>>>>>>   .. .. ..$ gwr.e      : num [1:286288] -0.461 -0.683 -0.5987 -0.2692
>>>>>>>> 0.0406 ...
>>>>>>>>   .. .. ..$ pred       : num [1:286288] 0.806 0.833 0.507 0.514 0.576 
>>>>>>>> ...
>>>>>>>>   .. .. ..$ localR2    : num [1:286288] 0.621 0.618 0.638 0.635 0.632 
>>>>>>>> ...
>>>>>>>> 
>>>>>>>> 
>>>>>>>> 
>>>>>>>> 
>>>>>>>> ### gwr on cluster :
>>>>>>>> 
>>>>>>>> cl <- makeCluster(32, type="MPI")
>>>>>>>> 
>>>>>>>> coords <- coordinates(hef)
>>>>>>>> 
>>>>>>>> gw <-
>>>>>>>> gwr(hef at data$DIF~hef at data$ELEVATION+hef at data$SKY+hef at data$SLOPE+hef at data$SOLAR, 
>>>>>>>> data=hef, bandwidth=50, gweight=gwr.Gauss,fit.points=coords,
>>>>>>>> hatmatrix=FALSE, cl=cl)
>>>>>>>> 
>>>>>>>> # part of the  str(gwr_50) output...
>>>>>>>> 
>>>>>>>> List of 11
>>>>>>>>  $ SDF      :Formal class 'SpatialPointsDataFrame' [package "sp"] 
>>>>>>>> with 5
>>>>>>>> slots
>>>>>>>>   .. ..@ data       :'data.frame':    286288 obs. of  6 variables:
>>>>>>>>   .. .. ..$ sum.w      : num [1:286288] 1 1 1 1 1 ...
>>>>>>>>   .. .. ..$ (Intercept): num [1:286288] 12541 1970 2057 -1505 -1030 
>>>>>>>> ...
>>>>>>>>   .. .. ..$ elevation  : num [1:286288] -3.891 -0.602 -0.738 0.465 
>>>>>>>> 0.309
>>>>>>>> ...
>>>>>>>>   .. .. ..$ sky        : num [1:286288] -0.954 -0.425 3.714 0.159 
>>>>>>>> 0.152
>>>>>>>> ...
>>>>>>>>   .. .. ..$ slope      : num [1:286288] 62.19 NA -27.21 1.95 16.03 
>>>>>>>> ...
>>>>>>>>   .. .. ..$ solar      : num [1:286288] NA NA NA NA 0.042 ...
>>>>>>>> 
>>>>>>>> 
>>>>>>>> 
>>>>>>>>
>>>>>>>>     [[alternative HTML version deleted]]
>>>>>>>> 
>>>>>>>> _______________________________________________
>>>>>>>> R-sig-Geo mailing list
>>>>>>>> R-sig-Geo at r-project.org
>>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>>>> 
>>>>>>> 
>>>>>> 
>>>>>> 
>>>>>> 
>>>>> 
>>>>> -- 
>>>>> Roger Bivand
>>>>> Department of Economics, NHH Norwegian School of Economics,
>>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>>>> e-mail: Roger.Bivand at nhh.no
>>>>> 
>>>>> 
>>>> 
>>> 
>>> 
>> 
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From Wade.A.Wall at usace.army.mil  Thu May 10 16:59:52 2012
From: Wade.A.Wall at usace.army.mil (Wall, Wade A ERDC-RDE-CERL-IL)
Date: Thu, 10 May 2012 14:59:52 +0000
Subject: [R-sig-Geo] analyzing spatial segregation of sexes
In-Reply-To: <201205100903.q4A93UJW024822@smtp.upm.es>
References: <C1524BE4BF45454293B8DF38FB9B5ECAD310DE@MS-EX1VKS.erdc.dren.mil>
	<CAGfc75nfPtTFvA_PEqOH=3Xq=zeKsuw2xYsDP+6G7Fc9r9-L7g@mail.gmail.com>
	<201205100903.q4A93UJW024822@smtp.upm.es>
Message-ID: <C1524BE4BF45454293B8DF38FB9B5ECAD31243@MS-EX1VKS.erdc.dren.mil>

All,

Thanks for help on this. I think that I now understand the ppp object.

Marcelino, thanks for the excellent explanation of implementing the multitype K function. I think this is the approach that I should take in analyzing the data, as Mathieu suggested. 

Robert, thanks for the link to the pdf. It looks like an excellent read.

Wade

-----Original Message-----
From: Marcelino de la Cruz [mailto:marcelino.delacruz at upm.es] 
Sent: Thursday, May 10, 2012 4:03 AM
To: Mathieu Rajerison; Wall, Wade A ERDC-RDE-CERL-IL
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] analyzing spatial segregation of sexes

Hi,

with respect to the implementation of the "Bivariate i.e.2-type point pattern (see package 'spatstat')" you may do something like this:

library(spatstat)

plants.ppp <- ppp( x = example$x, y =example$y, marks=factor(sex), window = yourwindow),

where "example" is a data.frame with your data and  "yourwindow" are the boundaries of your study area. See help (ppp) and help (owin) to see several ways of specifying the window. If you are impatient and have many points you could try this:

plants.ppp <- ppp( x = example$x, y =example$y, marks=factor(sex), xrange=range(example$x), yrange = range(example$y))


Asessing segregation in spatstat would imply computing differences of 
univariata and bivariate functions;e.g., to compute the segregation 
of females you should do:

Kff <- Kcross(plants.ppp, i="F", j="F")
Kfm <- Kcross(plants.ppp, i="F", j="M")

D <- eval.fv(Kff-Kfm)

Ploting this function [i.e,  plot(D)] would show you at which scales 
(if any) D > 0 (segregation of female sex) or D < 
0  ("overdispersion" ?of female sex).

By the way, function K1K2 in package ecespa implements test of these 
functions against a null model of random labeling.

HTH,

Marcelino



At 09:27 10/05/2012, Mathieu Rajerison wrote:
>Hi!
>
>Why not use, for example, KCross spatstat function, given two point
>patterns: one for male individuals and one for female ones?
>
>
>2012/5/9 Wall, Wade A ERDC-RDE-CERL-IL <Wade.A.Wall at usace.army.mil>
>
> > Hi all,
> >
> > I have a data set that consists of x,y coordinates for individual plants,
> > along with sex of the individual.
> >
> > Example
> >
> > Ind     sex     x       y
> > 1       F       10      5
> > 2       M       9       4
> > . . .
> > 200     M       20      4
> >
> > for 20 populations of the species. I would like to know if males and
> > females are randomly dispersed, or tend to segregate.
> >
> > I would like to use Philip Dixon's method (1994), and there is an
> > implementation in the R package "spatialsegregation" (dixon(X, prepR=0)).
> > However,
> > I am not very familiar with spatial analyses in R and am not sure how to
> > structure the input object X. The function description says "Bivariate i.e.
> > 2-type point pattern (see package 'spatstat')"
> >
> > Does anyone know how to structure the data that I have (example above) so
> > that I can use dixon()? Thanks for any help.
> >
> > Wade A. Wall
> >
> > _______________________________________________
> > R-sig-Geo mailing list
> > R-sig-Geo at r-project.org
> > https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> >
>
>         [[alternative HTML version deleted]]
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From jaimebg27 at gmail.com  Thu May 10 22:45:11 2012
From: jaimebg27 at gmail.com (=?ISO-8859-1?Q?Jaime_Burbano_Gir=F3n?=)
Date: Thu, 10 May 2012 15:45:11 -0500
Subject: [R-sig-Geo] Question about Mantel Test
Message-ID: <CADiqS862KfZuLdud9MfmqBngza=BFa5T5j1PR5gxT2OLPyZA8Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120510/bd6b746a/attachment.pl>

From jaimebg27 at gmail.com  Thu May 10 22:45:11 2012
From: jaimebg27 at gmail.com (=?ISO-8859-1?Q?Jaime_Burbano_Gir=F3n?=)
Date: Thu, 10 May 2012 15:45:11 -0500
Subject: [R-sig-Geo] Question about Mantel Test
Message-ID: <CADiqS862KfZuLdud9MfmqBngza=BFa5T5j1PR5gxT2OLPyZA8Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120510/bd6b746a/attachment-0001.pl>

From sarah.goslee at gmail.com  Thu May 10 23:00:00 2012
From: sarah.goslee at gmail.com (Sarah Goslee)
Date: Thu, 10 May 2012 17:00:00 -0400
Subject: [R-sig-Geo] [R-sig-eco] Question about Mantel Test
In-Reply-To: <CADiqS862KfZuLdud9MfmqBngza=BFa5T5j1PR5gxT2OLPyZA8Q@mail.gmail.com>
References: <CADiqS862KfZuLdud9MfmqBngza=BFa5T5j1PR5gxT2OLPyZA8Q@mail.gmail.com>
Message-ID: <CAM_vjukC2K-0mR4hr_zMquKyprtmgN-C=uj57n34n_A=q_hdmg@mail.gmail.com>

Hi,

Please don't cross-post.

A Mantel test is most suited to problems that must be expressed in
terms of distances, as Legendre states, although there is a
mathematical relationship between correlation between distances and
correlation between raw data.

If your main concern is statistical testing, you can use a permutation
test for significance of correlations without converting them to
distances first, thus avoiding the parametric assumptions.

If you want to use a Mantel approach to investigate *linear* spatial
autocorrelation, then "distance apart" is relevant, and this does
become a distance problem. You could then obtain the correlation
between difference in variable X and difference in variable Y given
their distance apart.

Are you sure there's significant spatial autocorrelation? Have you
tested for it in your data? If there is, is it meaningful in the
context of your question?

There are many approaches to dealing with spatial autocorrelation, and
you might be best served to do some reading on your own and to consult
a statistician, if you have access to one who is familiar with
ecological data.

Sarah

On Thu, May 10, 2012 at 4:45 PM, Jaime Burbano Gir?n
<jaimebg27 at gmail.com> wrote:
> Hi every body.
>
> I have some questions about Mantel Test. I expect that with experience in
> spatial analysis of people in this list I can resolve them. Your
> explanations and suggestions will help me so much, so, thanks in advance.
>
> For contextualizing. I want to explore the association between some
> environmental variables: precipitation, temperature, bio-climatic
> indicators (construction of "bio variables" proposed in WorlClim), EVI
> (Enhanced Vegetation Index from MODIS-NDVI), NPP (Net Primary Product from
> MODIS), and VCF (Vegetation Continues Fields for trees from MODIS).
>
> *1. *At first instance, I thought to calculate Pearson?s correlation
> coefficient from Mantel Test approach, however, I have some doubts about
> what I am actually doing with this.
>
> I think that I can obtain a more accurate correlation coefficient with out
> the problem of spatial auto-correlation, due to permutation implicit in
> Mantel Test, using as matrices for calculate it ?two grids of the set of
> environmental variables.
>
> My real questions comes from the definition of matrices used in Mantel
> Test, because they are proposed from literature to represent a relationship
> between points included in them (often distances), but the grids do not
> represent this, they are the raw values of environmental variables. In
> fact, Legendre recommends that Mantel tests should not be used to test
> hypotheses about the relationships of the original data tables.
>
> So am I correct in try to perform a correlation coefficient with out the
> problem of spatial auto-correlation between any two grids using the Mantel
> Test?
>
> *2. *An other option that I have thought for involving distances is to
> perform the Mantel Test using a distance matrix between the two grids (this
> distance measure could be the correlation coefficient) and the geographic
> distance between grid points (Euclidean distance), since this is a way to
> explore if a variable is spatially autocorrelated, even this is less used
> than Moran Index or Correlogram.
>
> However, I am not sure if with this option I would test the spatial
> correlation of the distance measure used, or I would obtain a correlation
> index of the association of the two grids (distance measure used) with out
> the problem of spatial auto-correlation due to permutation. Or both?
>
> *3.* How else can you recommend me to measure the relationship between two
> environmental grids trying to minimize the effect of spatial
> auto-correlation?
>
> Regards to all and thanks in advance for your help.
>

-- 
Sarah Goslee
http://www.functionaldiversity.org


From edergerardoqs at gmail.com  Fri May 11 00:16:14 2012
From: edergerardoqs at gmail.com (=?ISO-8859-1?Q?Eder_Gerardo_Qui=F1ones_Sanchez?=)
Date: Thu, 10 May 2012 19:16:14 -0300
Subject: [R-sig-Geo] question about object 'col.gal.nb'
Message-ID: <CAF-_jYodejp=upFwJz6rrL4P=qjxaBFZBJa5DLP+m1Sr9wFo=A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120510/357d232c/attachment.pl>

From karljarvis at gmail.com  Fri May 11 01:16:54 2012
From: karljarvis at gmail.com (karljarvis)
Date: Thu, 10 May 2012 16:16:54 -0700 (PDT)
Subject: [R-sig-Geo] gdistance resistanceDistance error
In-Reply-To: <1EF2C1D4-C184-4F79-9072-76A6876DC03D@gmail.com>
References: <CAC28k7RWH1JcpHwzMnVbN12AKDFj1posHa5MOAB8TCddmTK8Ag@mail.gmail.com>
	<1323411440.7194.YahooMailNeo@web29702.mail.ird.yahoo.com>
	<1336519963610-7541017.post@n2.nabble.com>
	<B1D716CE-0C92-4EEB-90A8-D580A8A42E86@yahoo.com>
	<1EF2C1D4-C184-4F79-9072-76A6876DC03D@gmail.com>
Message-ID: <1336691814301-7548673.post@n2.nabble.com>

Hi all,
As long as you're on the subject of the resistanceDistance function, I hope
you don't mind a different question.  In a homogeneous landscape, shouldn't
equidistant points have the same resistance values? There is no
directionality to this implementation of the circuitscape-type approach, so
in a symmetrical landscape the matrix should be symmetrical.  Right?

m <- matrix(1,10,10)
r <- raster(m)
t <- transition(r, mean, 8)
tg <- geoCorrection(t,type="c",multpl=FALSE)

x <- c(0.25,0.25,0.75,0.75)
y <- c(0.25,0.75,0.25,0.75)
xy <- cbind(x,y)

(rd <- resistanceDistance(tg,xy))

output:
         1        2        3
2 373.2277                  
3 243.5229 266.6885         
4 396.3933 322.7020 452.4068

The distance between each of these pairs of points are the same: (1,2),
(1,3), (2,4), (3,4), and these two are the same distance from each other:
(1,4), and (2,3).  So since all else is equal, why are their resistances
different?

Thanks,
Karl

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/gdistance-resistanceDistance-error-tp7076485p7548673.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From tom.gottfried at tum.de  Fri May 11 07:52:47 2012
From: tom.gottfried at tum.de (Tom Gottfried)
Date: Fri, 11 May 2012 07:52:47 +0200
Subject: [R-sig-Geo] question about object 'col.gal.nb'
In-Reply-To: <CAF-_jYodejp=upFwJz6rrL4P=qjxaBFZBJa5DLP+m1Sr9wFo=A@mail.gmail.com>
References: <CAF-_jYodejp=upFwJz6rrL4P=qjxaBFZBJa5DLP+m1Sr9wFo=A@mail.gmail.com>
Message-ID: <4FACA92F.8040900@tum.de>

please read the posting guide

http://www.r-project.org/posting-guide.html

and try to find the differences between the data which come with R and 
your own respectively try to produce a reproducible example.

HTH,
Tom

Am 11.05.2012 00:16, schrieb Eder Gerardo Qui?ones Sanchez:
> Hi,
>
> i'm trying to use the following code for calculate a Distance Matrix:
>
> *area<- readOGR(dsn="C:/stl_hom", layer="stl_hom")*
> *
> *
> *coords<- coordinates(area)*
> *
> *
> *col.gal.nb*
> *
> *
> *summary(col.gal.nb, coords)*
>
> it is functioning very well with the R-data included, but when i use a data
> from a Shapefile into my pc, it doesn't work.
>
> Thanks,
>
>
> ____
> *Eder Gerardo Qui?ones S.*
>
> Mestrando Engenharia de Transportes - UFC (BR)
> Ingeniero Civil - Universidad del Cauca (COL)
>
> 	[[alternative HTML version deleted]]
>
>
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Technische Universit?t M?nchen
Department f?r Pflanzenwissenschaften
Lehrstuhl f?r Gr?nlandlehre
Alte Akademie 12
85350 Freising / Germany
Phone: ++49 (0)8161 715324
Fax:   ++49 (0)8161 713243
email: tom.gottfried at wzw.tum.de
http://www.wzw.tum.de/gruenland


From mathieu.rajerison at gmail.com  Fri May 11 10:17:57 2012
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Fri, 11 May 2012 10:17:57 +0200
Subject: [R-sig-Geo] plotting raster - color values per pixel
Message-ID: <CAGfc75=oscpofsqTzxXDAd0bbyiAZ8dLxWRRq2-_B0eKs2d3vw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120511/dc31a960/attachment.pl>

From mathieu.rajerison at gmail.com  Fri May 11 10:20:08 2012
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Fri, 11 May 2012 10:20:08 +0200
Subject: [R-sig-Geo] plotting raster - color values per pixel
In-Reply-To: <CAGfc75=oscpofsqTzxXDAd0bbyiAZ8dLxWRRq2-_B0eKs2d3vw@mail.gmail.com>
References: <CAGfc75=oscpofsqTzxXDAd0bbyiAZ8dLxWRRq2-_B0eKs2d3vw@mail.gmail.com>
Message-ID: <CAGfc75mdxQvH7uB_q73KNz=mc450HDezDkx9=inkznCMAu+GDg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120511/a7214439/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Fri May 11 10:43:44 2012
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Fri, 11 May 2012 09:43:44 +0100
Subject: [R-sig-Geo] plotting raster - color values per pixel
In-Reply-To: <93eada7500344948840b740b9b647f1b@EX-1-HT0.lancs.local>
References: <CAGfc75=oscpofsqTzxXDAd0bbyiAZ8dLxWRRq2-_B0eKs2d3vw@mail.gmail.com>
	<93eada7500344948840b740b9b647f1b@EX-1-HT0.lancs.local>
Message-ID: <CANVKczNohkq8RG6saV82ySt=aMzQTMqUWeALKb8Lv4SdHBoAjQ@mail.gmail.com>

On Fri, May 11, 2012 at 9:20 AM, Mathieu Rajerison
<mathieu.rajerison at gmail.com> wrote:

>> In col, I must specify a palette, but how can I use my color vector?
>>
>> Here is the line of code for the moment (which doesn't work):
>> cols <- hsv(ifelse(values(r) > .5, 0, .7), values(r), 1)
>> plot(r, col=topo.colors(20), axes=FALSE)

 You can do this by instead of plotting the 'r' raster (which is your
values) you plot a raster containing the values 1 to nrows*ncols. and
pass col as a vector of colours of length nrows*ncols. Then each cell
in the raster maps exactly to its colour value.

 Disadvantage: the legend is now 1:(nrows*ncols)

 The other way is to create a 3-band raster from the red, green, blue
components of the colours.

Barry


From mathieu.rajerison at gmail.com  Fri May 11 11:35:48 2012
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Fri, 11 May 2012 11:35:48 +0200
Subject: [R-sig-Geo] plotting raster - color values per pixel
In-Reply-To: <CANVKczNohkq8RG6saV82ySt=aMzQTMqUWeALKb8Lv4SdHBoAjQ@mail.gmail.com>
References: <CAGfc75=oscpofsqTzxXDAd0bbyiAZ8dLxWRRq2-_B0eKs2d3vw@mail.gmail.com>
	<93eada7500344948840b740b9b647f1b@EX-1-HT0.lancs.local>
	<CANVKczNohkq8RG6saV82ySt=aMzQTMqUWeALKb8Lv4SdHBoAjQ@mail.gmail.com>
Message-ID: <CAGfc75mD0Z5rxQRdy=w8Y7qgBz7Rzb4+CK8hvn+j-FnjiAW34g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120511/dc6fc270/attachment.pl>

From david.marguerit at gmail.com  Fri May 11 12:35:40 2012
From: david.marguerit at gmail.com (David Marguerit)
Date: Fri, 11 May 2012 12:35:40 +0200
Subject: [R-sig-Geo] Projected data in R-Gstat
Message-ID: <CA+WaK3Gd9w7F7VU5CkqB29t1RfrU631-CGhkXLXnid58JbUnDA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120511/061b88bc/attachment.pl>

From oliveirajc at ufv.br  Fri May 11 14:53:10 2012
From: oliveirajc at ufv.br (julio cesar oliveira)
Date: Fri, 11 May 2012 09:53:10 -0300
Subject: [R-sig-Geo] Problem with legend and RasterLayer
Message-ID: <CAG+u5gq112bZrUdYfBT-dWOVCGD-M4gGC+XkGzoe+7XNvaibqA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120511/53a3c7d5/attachment.pl>

From jacobvanetten at yahoo.com  Fri May 11 15:31:20 2012
From: jacobvanetten at yahoo.com (Jacob van Etten)
Date: Fri, 11 May 2012 14:31:20 +0100 (BST)
Subject: [R-sig-Geo] gdistance resistanceDistance error
In-Reply-To: <1336691814301-7548673.post@n2.nabble.com>
References: <CAC28k7RWH1JcpHwzMnVbN12AKDFj1posHa5MOAB8TCddmTK8Ag@mail.gmail.com>
	<1323411440.7194.YahooMailNeo@web29702.mail.ird.yahoo.com>
	<1336519963610-7541017.post@n2.nabble.com>
	<B1D716CE-0C92-4EEB-90A8-D580A8A42E86@yahoo.com>
	<1EF2C1D4-C184-4F79-9072-76A6876DC03D@gmail.com>
	<1336691814301-7548673.post@n2.nabble.com>
Message-ID: <1336743080.83082.YahooMailNeo@web29702.mail.ird.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120511/81022111/attachment.pl>

From Wade.A.Wall at usace.army.mil  Fri May 11 18:12:06 2012
From: Wade.A.Wall at usace.army.mil (Wall, Wade A ERDC-RDE-CERL-IL)
Date: Fri, 11 May 2012 16:12:06 +0000
Subject: [R-sig-Geo] Analyzing spatial segregation; power to detect
Message-ID: <C1524BE4BF45454293B8DF38FB9B5ECAD31483@MS-EX1VKS.erdc.dren.mil>

Hi all,

I asked a question regarding analyzing the spatial distribution of male and female individuals of a plant species. This is not a specifically R-related question, but I am relatively new to spatial statistics and think that people with more experience could answer this question.

The data that I have comes from multiple populations with from 1-41 individuals. I used Ripley's K to analyze the populations > 20 individuals separately, because I was concerned about interpopulation effects. However, now my concern is the reduced power to detect a pattern due to low sample size. Is there any way to perform a power analysis for Ripley's K? I have been looking for a method, but have been unable to find anything.

What are the alternatives to subsetting the dataset by population? Is it possible to leverage the data from the full data set, or does cause problems?

Thanks for any information,

Wade 


From Wade.A.Wall at usace.army.mil  Fri May 11 18:15:07 2012
From: Wade.A.Wall at usace.army.mil (Wall, Wade A ERDC-RDE-CERL-IL)
Date: Fri, 11 May 2012 16:15:07 +0000
Subject: [R-sig-Geo] pattern simulation in R
Message-ID: <C1524BE4BF45454293B8DF38FB9B5ECAD31496@MS-EX1VKS.erdc.dren.mil>

Hi all,

Does anyone know if there is a pattern generation function in R? I would like to generate different patterns (random, clumped, overdispersed) with different numbers of points, but have been unable to find (and have been unsuccessful in coding) a function to do this. This is related to the power analysis question, but thought I would put it in a separate thread.

Thanks for any information,

Wade A. Wall


From thomas.adams at noaa.gov  Fri May 11 19:18:56 2012
From: thomas.adams at noaa.gov (Thomas Adams)
Date: Fri, 11 May 2012 13:18:56 -0400
Subject: [R-sig-Geo] pattern simulation in R
In-Reply-To: <C1524BE4BF45454293B8DF38FB9B5ECAD31496@MS-EX1VKS.erdc.dren.mil>
References: <C1524BE4BF45454293B8DF38FB9B5ECAD31496@MS-EX1VKS.erdc.dren.mil>
Message-ID: <CAEoga+Q-UfZVxfTzk6Pcjo7=1Ke0zkF7iPSZoTYva1Lnio9DwA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120511/a7f6c50d/attachment.pl>

From edergerardoqs at gmail.com  Fri May 11 19:58:50 2012
From: edergerardoqs at gmail.com (=?ISO-8859-1?Q?Eder_Gerardo_Qui=F1ones_Sanchez?=)
Date: Fri, 11 May 2012 14:58:50 -0300
Subject: [R-sig-Geo] Question about "col.gal.nb" object
Message-ID: <CAF-_jYrLeJvRjO0SSxrw5PD8sq3VUBDFm_egakYNwfSVGm-v=w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120511/77d24070/attachment.pl>

From thi_veloso at yahoo.com.br  Fri May 11 23:13:19 2012
From: thi_veloso at yahoo.com.br (Thiago Veloso)
Date: Fri, 11 May 2012 14:13:19 -0700 (PDT)
Subject: [R-sig-Geo] Error when using rowSums along with a RasterStack object
Message-ID: <1336770799.74888.YahooMailClassic@web161406.mail.bf1.yahoo.com>

Dear R-colleagues,

I am trying to sum all layers of a RasterStack object, which is summarized below:

> s
class       : RasterStack 
dimensions  : 5568, 8289, 46153152, 46  (nrow, ncol, ncell, nlayers)
resolution  : 0.00898, 0.00898  (x, y)
extent      : -104.4326, -29.99736, -40.00064, 10  (xmin, xmax, ymin, ymax)
coord. ref. : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0 
min values  : -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, ... 
max values  : 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, ... 
layer names : gpp2004001.Gpp_1km, gpp2004009.Gpp_1km, gpp2004017.Gpp_1km, gpp2004025.Gpp_1km, gpp2004033.Gpp_1km, gpp2004041.Gpp_1km, gpp2004049.Gpp_1km, gpp2004057.Gpp_1km, gpp2004065.Gpp_1km, gpp2004073.Gpp_1km, gpp2004081.Gpp_1km, gpp2004089.Gpp_1km, gpp2004097.Gpp_1km, gpp2004105.Gpp_1km, gpp2004113.Gpp_1km, ... 

The raster 's' is composed by 46 satellite images at a resolution of 1km (0.00898degree). Each layer is a 8-day composition of leaf area index and I need to integrate an entire year of LAI. When I try to run the "rowSums" function in this RasterStack, the following error is displayed:

> sos <- rowSums(s,na.rm=FALSE)
Error in rowSums(s, na.rm = FALSE) : 
  'x' must be an array of at least two dimensions

The same occurs when I try to use .rowSums providing matrix dimensions:

> sos <- .rowSums(s,5568,8289)
Error in .rowSums(s, 5568, 8289) : 'x' must be numeric


What am I doing wrong? Is there another way to integrate the layers of a RasterStack object?

Thanks in advance,
Thiago Veloso.

P.S.: Attaching sessionInfo output to provide useful information:

> sessionInfo()
R version 2.15.0 (2012-03-30)
Platform: x86_64-unknown-linux-gnu (64-bit)

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=C                 LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] ncdf_1.6.6    rgdal_0.7-11  raster_1.9-92 sp_0.9-99    

loaded via a namespace (and not attached):
[1] grid_2.15.0    lattice_0.20-6



From Wade.A.Wall at usace.army.mil  Fri May 11 23:23:14 2012
From: Wade.A.Wall at usace.army.mil (Wall, Wade A ERDC-RDE-CERL-IL)
Date: Fri, 11 May 2012 21:23:14 +0000
Subject: [R-sig-Geo] sum number of events by covariate using applynbd
Message-ID: <C1524BE4BF45454293B8DF38FB9B5ECAD314EA@MS-EX1VKS.erdc.dren.mil>

Hi all,

I am wanting to sum the number of events within r=5 distance of a set of points and segregate by a covariate. I want to use the function applynbd, but not sure how to write a custom function to do this.

For example, I have a ppp object, LS.ppp. LS.ppp$marks has two levels, M and F. 

For each point in the data set, I want to assess the sum of all points within r=5 that are M and the sum of all points that are female. 

The results would be a dataframe  of N rows, with N = the number of points in the ppp object. 

The two columns would be number of females, and number of males.

I think this could be done using dist() and looping over it for each row and then matching with a dataframe, but that seems to be a clunky way of doing it.

Does anyone know how to do this? I see how to use applynbd to get the sum of the points, but not the sum by covariate.

Thanks for any information,

Wade A. Wall


From r.turner at auckland.ac.nz  Sat May 12 02:31:27 2012
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Sat, 12 May 2012 12:31:27 +1200
Subject: [R-sig-Geo] pattern simulation in R
In-Reply-To: <C1524BE4BF45454293B8DF38FB9B5ECAD31496@MS-EX1VKS.erdc.dren.mil>
References: <C1524BE4BF45454293B8DF38FB9B5ECAD31496@MS-EX1VKS.erdc.dren.mil>
Message-ID: <4FADAF5F.1000103@auckland.ac.nz>

On 12/05/12 04:15, Wall, Wade A ERDC-RDE-CERL-IL wrote:
> Hi all,
>
> Does anyone know if there is a pattern generation function in R? I would like to generate different patterns (random, clumped, overdispersed) with different numbers of points, but have been unable to find (and have been unsuccessful in coding) a function to do this. This is related to the power analysis question, but thought I would put it in a separate thread.
>
> Thanks for any information.

There is a wide variety of pattern simulation functions in the 
"spatstat" package
(which you appear to be using already).  Execute ?spatstat and then 
scroll down
a little to "To simulate a random point pattern:" to see a list of the 
possibilities.

I'm not sure what you mean by a pattern being "overdispersed".  Do you mean
exhibiting repulsion ("unusual regularity")?  This can be simulated 
using the Strauss
process (via rmh() or rStrauss()) or the hardcore process (using 
rmh()).  The
function rSSI() also simulates patterns with (a different version of) 
hardcore
repulsion.

Clustered patterns can be simulated via, e.g. rThomas() and rMatClust().

"Random" (I presume you mean Poisson) patterns can be simulated using
rpoispp().

Is there some form of pattern generation that you want that is *not* 
currently
provided by "spatstat"?

     cheers,

         Rolf Turner


From r.turner at auckland.ac.nz  Sat May 12 03:23:34 2012
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Sat, 12 May 2012 13:23:34 +1200
Subject: [R-sig-Geo] sum number of events by covariate using applynbd
In-Reply-To: <C1524BE4BF45454293B8DF38FB9B5ECAD314EA@MS-EX1VKS.erdc.dren.mil>
References: <C1524BE4BF45454293B8DF38FB9B5ECAD314EA@MS-EX1VKS.erdc.dren.mil>
Message-ID: <4FADBB96.20104@auckland.ac.nz>



PLEASE!!!  Do NOT confuse "covariate" with "mark".  They are very
different concepts.  You want to "segregate by ***mark***" (etc.)
NOT by covariate.  The latter makes no sense at all.

As to how to accomplish the desired task, see below.

On 12/05/12 09:23, Wall, Wade A ERDC-RDE-CERL-IL wrote:
> Hi all,
>
> I am wanting to sum the number of events within r=5 distance of a set of points and segregate by a covariate. I want to use the function applynbd, but not sure how to write a custom function to do this.
>
> For example, I have a ppp object, LS.ppp. LS.ppp$marks has two levels, M and F.
>
> For each point in the data set, I want to assess the sum of all points within r=5 that are M and the sum of all points that are female.
>
> The results would be a dataframe  of N rows, with N = the number of points in the ppp object.
>
> The two columns would be number of females, and number of males.
>
> I think this could be done using dist() and looping over it for each row and then matching with a dataframe, but that seems to be a clunky way of doing it.
>
> Does anyone know how to do this? I see how to use applynbd to get the sum of the points, but not the sum by covariate.
>
> Thanks for any information.

This is actually fairly easy to do with applynbd() but is even easier to do
using markstat():

DF <- as.data.frame(t(markstat(LS.ppp,fun=table,R=5,exclude=TRUE)))

If you *really* want to use applynbd() directly ("just because you can")
then do:

foo <- function(Y,current,dists,dranks,...){table(marks(Y))}
DF <- as.data.frame(t(applynbd(LS.ppp,foo,R=5,exclude=TRUE)))

Note:  I'm using "exclude=TRUE" because I presume that you do not
want to count the point itself when tabulating the marks of points within
distance 5 of that point.  If you *do* want to count the point itself then
remove reference to "exclude" or set exclude=FALSE (the default).

     cheers,

         Rolf Turner


From tom.gottfried at tum.de  Sat May 12 07:36:52 2012
From: tom.gottfried at tum.de (Tom Gottfried)
Date: Sat, 12 May 2012 07:36:52 +0200
Subject: [R-sig-Geo] Question about "col.gal.nb" object
In-Reply-To: <CAF-_jYrLeJvRjO0SSxrw5PD8sq3VUBDFm_egakYNwfSVGm-v=w@mail.gmail.com>
References: <CAF-_jYrLeJvRjO0SSxrw5PD8sq3VUBDFm_egakYNwfSVGm-v=w@mail.gmail.com>
Message-ID: <4FADF6F4.5080701@tum.de>

Am 11.05.2012 19:58, schrieb Eder Gerardo Qui?ones Sanchez:
> Hi,
>
> i'm using the 'col.gal.nb' object for the definition of all neighbors. my
> information is loaded from a archives into may pc

Though someone might accidentally know what col.gal.nb is and where it 
comes from, having told us here would have been much nearer to 
'reproducible'.

> *library(spdep)*
> *
> *
> *city<- readOGR(dsn="C:/cities", layer="city1")*
> *coords<- coordinates(city)*
> *
> *
> *plot(col.gal.nb, coords, add=TRUE)*
> *Error: length(nb) == nrow(coords) is not TRUE*

If you refer to the documentation of the plot method you are using here, 
I suspect you find out that 'nb' refers to the first argument and 
'coords' to the second. The error message tells you they need to fulfil 
the condition given in the message ('length(nb) == nrow(coords)' is 
actually an R expression!).

HTH,
Tom

> but when i try to draw it, an error appears. i don't know what could be the
> error...
>
>
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Technische Universit?t M?nchen
Department f?r Pflanzenwissenschaften
Lehrstuhl f?r Gr?nlandlehre
Alte Akademie 12
85350 Freising / Germany
Phone: ++49 (0)8161 715324
Fax:   ++49 (0)8161 713243
email: tom.gottfried at wzw.tum.de
http://www.wzw.tum.de/gruenland


From matteo.mattiuzzi at boku.ac.at  Sat May 12 11:26:42 2012
From: matteo.mattiuzzi at boku.ac.at (Matteo Mattiuzzi)
Date: Sat, 12 May 2012 11:26:42 +0200
Subject: [R-sig-Geo] Antw: Error when using rowSums along with a RasterStack
 object
Message-ID: <4FAE48F2020000270001403D@gwia2.boku.ac.at>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120512/dcd53125/attachment.pl>

From r.hijmans at gmail.com  Sat May 12 18:43:55 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sat, 12 May 2012 09:43:55 -0700
Subject: [R-sig-Geo] Antw: Error when using rowSums along with a
 RasterStack object
In-Reply-To: <4FAE48F2020000270001403D@gwia2.boku.ac.at>
References: <4FAE48F2020000270001403D@gwia2.boku.ac.at>
Message-ID: <CANtt_hxv0Cjya9rp5DRWTRbgAAPGuf3kmYK_7jucLvCOMMg23A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120512/969b1671/attachment.pl>

From thi_veloso at yahoo.com.br  Sun May 13 01:51:38 2012
From: thi_veloso at yahoo.com.br (Thiago Veloso)
Date: Sat, 12 May 2012 16:51:38 -0700 (PDT)
Subject: [R-sig-Geo] Antw: Error when using rowSums along with a
	RasterStack object
In-Reply-To: <CANtt_hxv0Cjya9rp5DRWTRbgAAPGuf3kmYK_7jucLvCOMMg23A@mail.gmail.com>
Message-ID: <1336866698.91876.YahooMailClassic@web161406.mail.bf1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120512/9de0b2a7/attachment.pl>

From riabovvv at gmail.com  Sun May 13 10:07:00 2012
From: riabovvv at gmail.com (Yury Ryabov)
Date: Sun, 13 May 2012 12:07:00 +0400
Subject: [R-sig-Geo] How to move legend of rhohat (spatstat)?
Message-ID: <CADEJ7oO_vkRY8ay8LKRtZds3Y6ZPkOrgE0bQqAe+o=nq1ob9fA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120513/2cbd34dc/attachment.pl>

From r.turner at auckland.ac.nz  Sun May 13 10:41:57 2012
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Sun, 13 May 2012 20:41:57 +1200
Subject: [R-sig-Geo] How to move legend of rhohat (spatstat)?
In-Reply-To: <CADEJ7oO_vkRY8ay8LKRtZds3Y6ZPkOrgE0bQqAe+o=nq1ob9fA@mail.gmail.com>
References: <CADEJ7oO_vkRY8ay8LKRtZds3Y6ZPkOrgE0bQqAe+o=nq1ob9fA@mail.gmail.com>
Message-ID: <4FAF73D5.3010908@auckland.ac.nz>

On 13/05/12 20:07, Yury Ryabov wrote:
> Hi,
>
> A "rhohat" function (in "spatstat" package) has its own built-in legend
> that appears at the top left corner of the graph. Seems that it is not
> affected by "par(legend())" or I don't have a clue how to write the
> corresponding statement. Help on "rhohat" does not provide informations
> about options to control the legend. Does any one know how to move this
> legend across the graph or at least how to make its fill transparent (this
> legend blocks an important part of my graph)?

An object returned by rhohat() is of class "rhohat" and so is plotted
by the method plot.rhohat() which in turn calls upon plot.fv().

If you look at the help for plot.fv() you will see that this takes
arguments "legendpos" and "legendargs" which should allow
you to accomplish what you want.

You can also set "legend=FALSE" in the call to plot(), which will
suppress the legend completely (if it's getting in your way and
annoying you).  And you could then add your own ad hoc legend
in any manner you please by calling the legend() function
directly.

I guess that you can make the background of the legend transparent
by doing

     plot(object,legendargs=list(bg="transparent"))

(where "object" is what is returned by rhohat()) but on my system at least
the background is transparent by default, so this seems unnecessary
to me.

HTH

     cheers,

         Rolf Turner


From riabovvv at gmail.com  Sun May 13 11:03:52 2012
From: riabovvv at gmail.com (Yury Ryabov)
Date: Sun, 13 May 2012 13:03:52 +0400
Subject: [R-sig-Geo] How to move legend of rhohat (spatstat)?
In-Reply-To: <4FAF73D5.3010908@auckland.ac.nz>
References: <CADEJ7oO_vkRY8ay8LKRtZds3Y6ZPkOrgE0bQqAe+o=nq1ob9fA@mail.gmail.com>
	<4FAF73D5.3010908@auckland.ac.nz>
Message-ID: <CADEJ7oNnsLb2g2R0wAo0AqQTYocXKxHO7BDPMz4+8Uja500XDg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120513/99d51cb7/attachment.pl>

From matteo.mattiuzzi at boku.ac.at  Sun May 13 13:46:46 2012
From: matteo.mattiuzzi at boku.ac.at (Matteo Mattiuzzi)
Date: Sun, 13 May 2012 13:46:46 +0200
Subject: [R-sig-Geo] Antw: Re: Antw: Error when using rowSums along with a
 RasterStack object
Message-ID: <4FAFBB46020000270001407B@gwia2.boku.ac.at>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120513/3455975e/attachment.pl>

From r.hijmans at gmail.com  Sun May 13 18:03:40 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sun, 13 May 2012 09:03:40 -0700
Subject: [R-sig-Geo] Antw: Re: Antw: Error when using rowSums along with
 a RasterStack object
In-Reply-To: <4FAFBB46020000270001407B@gwia2.boku.ac.at>
References: <4FAFBB46020000270001407B@gwia2.boku.ac.at>
Message-ID: <CANtt_hxc+ESog66jpw0vc3JaEChn790yb4NbaA87MYttcj+KNA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120513/e175853b/attachment.pl>

From rrasterr at gmail.com  Sun May 13 18:55:29 2012
From: rrasterr at gmail.com (Ana)
Date: Sun, 13 May 2012 09:55:29 -0700 (PDT)
Subject: [R-sig-Geo] problem while creating netcdf files
Message-ID: <1336928129590-7555235.post@n2.nabble.com>

Hi!

I am creating netcdf files for climatic daily datasets for 50 years.
The problem is that I end up with huge files when trying just one point, and
I have 2000 more points to add. Am I doing something wrong or is it supposed
to be like this?

The code I am using:

# Make a few dimensions we can use
dimX <- dim.def.ncdf( "Long", "degrees", Longvector )
dimY <- dim.def.ncdf( "LAT", "degrees", Latvector )
dimT <- dim.def.ncdf( "Time", "days", 1:18250, unlim=FALSE )

# Make varables of various dimensionality, for illustration purposes
mv <- 1.e30		# missing value to use
var1d <- var.def.ncdf( "var1d", "units", dimX, mv,prec="double" )
var2d <- var.def.ncdf( "var2d", "units", list(dimX,dimY), mv,prec="double" )
var3d <- var.def.ncdf( "var3d", "units", list(dimX,dimY,dimT),
mv,prec="double" )

# Create the test file
nc <- create.ncdf( "writevals.nc", list(var1d,var2d,var3d) )
# !!*Creates a nc file with + 4 Gb*

# Adding the complete time series for one point (teh first point in the
list)
put.var.ncdf( nc, var3d,dataset[[1]], start=c(Longvector[1],Latvector[1],1),
count=c(1,1,-1))
# !! increases to + 16Gb 


Longvector and Latvector are vectors taken from the matrix with the Long and
Lat for each point
The dataset is in list format and for each point I have a list of numeric
values.



I am using the first example given in the ndcf package:
http://127.0.0.1:29386/library/ncdf/html/aput.var.ncdf.html


--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/problem-while-creating-netcdf-files-tp7555235.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From maximiliano.sepulveda at gmail.com  Sun May 13 19:27:05 2012
From: maximiliano.sepulveda at gmail.com (Maximiliano Sepulveda)
Date: Sun, 13 May 2012 13:27:05 -0400
Subject: [R-sig-Geo] spatial autocorrelation in linear environments
Message-ID: <CAKrkp9dAbyD9YzBxcTnC8C=gmvkJfrhn0zuHh_7jFWbywTKxeQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120513/90387844/attachment.pl>

From aslez at princeton.edu  Mon May 14 04:28:42 2012
From: aslez at princeton.edu (Adam Slez)
Date: Sun, 13 May 2012 22:28:42 -0400
Subject: [R-sig-Geo] error in rasterize routine?
Message-ID: <CA+9dHA9=4mu43RQim8AKsMeh-qtMLDnaDszQT_3wcfWfVhhKVw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120513/8f526434/attachment.pl>

From r.hijmans at gmail.com  Mon May 14 05:58:42 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Sun, 13 May 2012 20:58:42 -0700
Subject: [R-sig-Geo] error in rasterize routine?
In-Reply-To: <CA+9dHA9=4mu43RQim8AKsMeh-qtMLDnaDszQT_3wcfWfVhhKVw@mail.gmail.com>
References: <CA+9dHA9=4mu43RQim8AKsMeh-qtMLDnaDszQT_3wcfWfVhhKVw@mail.gmail.com>
Message-ID: <CANtt_hzxazxeX49YJRTgSurZMETLx5bZScjd5PNsu5McrPncow@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120513/77d4aa08/attachment.pl>

From Roger.Bivand at nhh.no  Mon May 14 09:53:21 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 14 May 2012 09:53:21 +0200 (CEST)
Subject: [R-sig-Geo] Question about "col.gal.nb" object
In-Reply-To: <4FADF6F4.5080701@tum.de>
References: <CAF-_jYrLeJvRjO0SSxrw5PD8sq3VUBDFm_egakYNwfSVGm-v=w@mail.gmail.com>
	<4FADF6F4.5080701@tum.de>
Message-ID: <alpine.LRH.2.02.1205140942070.11393@reclus.nhh.no>

On Sat, 12 May 2012, Tom Gottfried wrote:

> Am 11.05.2012 19:58, schrieb Eder Gerardo Qui?ones Sanchez:
>> Hi,
>> 
>> i'm using the 'col.gal.nb' object for the definition of all neighbors. my
>> information is loaded from a archives into may pc
>
> Though someone might accidentally know what col.gal.nb is and where it comes 
> from, having told us here would have been much nearer to 'reproducible'.
>
>> *library(spdep)*
>> *
>> *
>> *city<- readOGR(dsn="C:/cities", layer="city1")*
>> *coords<- coordinates(city)*
>> *
>> *
>> *plot(col.gal.nb, coords, add=TRUE)*
>> *Error: length(nb) == nrow(coords) is not TRUE*
>
> If you refer to the documentation of the plot method you are using here, I 
> suspect you find out that 'nb' refers to the first argument and 'coords' to 
> the second. The error message tells you they need to fulfil the condition 
> given in the message ('length(nb) == nrow(coords)' is actually an R 
> expression!).

The questioner is using the help files without understanding them. My 
guess is that instead of reading:

      example(columbus)
      coords <- coordinates(columbus)
      plot(col.gal.nb, coords)

from ?plot.nb in spdep, and grasping that col.gal.nb came from 
example(columbus), and so is (?columbus):

      col.gal.nb <- read.gal(system.file("etc/weights/columbus.gal",
       package="spdep")[1])

that is a GAL file of neighbours as output by OpenGeoDa and other 
applications, the questioner is assuming that it appears by itself. Both 
?read.gal and indeed class(col.gal.nb) say that it is a list of 
neighbours.

Now, unless you get lucky - or unlucky, as the case may be - the number of 
objects whose neighbours are listed in the "nb" object, and the number of 
rows (observations) in the user's own data will not match, hence the 
error. The user has to generate a new list of neighbours suiting the data 
set in question, using one of the functions in spdep, or indeed by reading 
the input shapefile into OpenGeoDa and generating a GAL file there. Which 
definition of neighbour to use depends on the research question - if the 
data are for example census tracts in a city, poly2nb() may be a good 
place to start.

Hope this clarifies,

Roger

>
> HTH,
> Tom
>
>> but when i try to draw it, an error appears. i don't know what could be the
>> error...
>> 
>> 
>> 
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From Wade.A.Wall at usace.army.mil  Mon May 14 16:27:33 2012
From: Wade.A.Wall at usace.army.mil (Wall, Wade A ERDC-RDE-CERL-IL)
Date: Mon, 14 May 2012 14:27:33 +0000
Subject: [R-sig-Geo] sum number of events by covariate using applynbd
In-Reply-To: <4FADBB96.20104@auckland.ac.nz>
References: <C1524BE4BF45454293B8DF38FB9B5ECAD314EA@MS-EX1VKS.erdc.dren.mil>
	<4FADBB96.20104@auckland.ac.nz>
Message-ID: <C1524BE4BF45454293B8DF38FB9B5ECAD31579@MS-EX1VKS.erdc.dren.mil>

Thanks,

That worked perfectly. And sorry for my sloppy use of language.

Have a great day,

Wade

-----Original Message-----
From: Rolf Turner [mailto:r.turner at auckland.ac.nz] 
Sent: Friday, May 11, 2012 8:24 PM
To: Wall, Wade A ERDC-RDE-CERL-IL
Cc: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] sum number of events by covariate using applynbd



PLEASE!!!  Do NOT confuse "covariate" with "mark".  They are very different concepts.  You want to "segregate by ***mark***" (etc.) NOT by covariate.  The latter makes no sense at all.

As to how to accomplish the desired task, see below.

On 12/05/12 09:23, Wall, Wade A ERDC-RDE-CERL-IL wrote:
> Hi all,
>
> I am wanting to sum the number of events within r=5 distance of a set of points and segregate by a covariate. I want to use the function applynbd, but not sure how to write a custom function to do this.
>
> For example, I have a ppp object, LS.ppp. LS.ppp$marks has two levels, M and F.
>
> For each point in the data set, I want to assess the sum of all points within r=5 that are M and the sum of all points that are female.
>
> The results would be a dataframe  of N rows, with N = the number of points in the ppp object.
>
> The two columns would be number of females, and number of males.
>
> I think this could be done using dist() and looping over it for each row and then matching with a dataframe, but that seems to be a clunky way of doing it.
>
> Does anyone know how to do this? I see how to use applynbd to get the sum of the points, but not the sum by covariate.
>
> Thanks for any information.

This is actually fairly easy to do with applynbd() but is even easier to do using markstat():

DF <- as.data.frame(t(markstat(LS.ppp,fun=table,R=5,exclude=TRUE)))

If you *really* want to use applynbd() directly ("just because you can") then do:

foo <- function(Y,current,dists,dranks,...){table(marks(Y))}
DF <- as.data.frame(t(applynbd(LS.ppp,foo,R=5,exclude=TRUE)))

Note:  I'm using "exclude=TRUE" because I presume that you do not want to count the point itself when tabulating the marks of points within distance 5 of that point.  If you *do* want to count the point itself then remove reference to "exclude" or set exclude=FALSE (the default).

     cheers,

         Rolf Turner


From Bastien.Ferland-Raymond at mrnf.gouv.qc.ca  Mon May 14 16:51:03 2012
From: Bastien.Ferland-Raymond at mrnf.gouv.qc.ca (Bastien.Ferland-Raymond at mrnf.gouv.qc.ca)
Date: Mon, 14 May 2012 10:51:03 -0400
Subject: [R-sig-Geo] Problem with writeOGR and overwrite_layer=T
Message-ID: <161DC602615F6943A19BAEA3DBF2E4B9018C0E1D3267@HARFANG.intranet.mrn.gouv>

Dear list,

I have to produce shapefile for a coworker which uses ArcGIS and I've hit a problem with the writeOGR function from the rgdal package.

Here is an example:

###

> library(rgdal)
Loading required package: sp
Geospatial Data Abstraction Library extensions to R successfully loaded
Loaded GDAL runtime: GDAL 1.9.0, released 2011/12/29
Path to GDAL shared files: \\sebpriv/usagers/Ferba1/R/R-2.15.0/library/rgdal/gdal
Loaded PROJ.4 runtime: Rel. 4.7.1, 23 September 2009, [PJ_VERSION: 470]
Path to PROJ.4 shared files: \\sebpriv/usagers/Ferba1/R/R-2.15.0/library/rgdal/proj
> sessionInfo()
R version 2.15.0 (2012-03-30)
Platform: i386-pc-mingw32/i386 (32-bit)

locale:
[1] LC_COLLATE=French_Canada.1252  LC_CTYPE=French_Canada.1252    LC_MONETARY=French_Canada.1252 LC_NUMERIC=C                   LC_TIME=French_Canada.1252

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] rgdal_0.7-8 sp_0.9-98

loaded via a namespace (and not attached):
[1] grid_2.15.0    lattice_0.20-6
> setwd("C:\\Documents and Settings\\ferba1\\Bureau\\test rgdal")

# make a basic shape:

> coo <- coordinates(cbind(runif(100,220000,300000),runif(100,5160000,5220000)))
> point.shape <- SpatialPointsDataFrame(coo,data.frame(ID=paste("point",1:100,sep="_")),
+   proj4string = CRS(" +proj=tmerc +lat_0=0 +lon_0=-73.5 +k=0.9999 +x_0=304800 +y_0=0 +datum=NAD83 +units=m +no_defs +ellps=GRS80 +towgs84=0,0,0"))

# now if I try to write itm it works fine for the first 2 shapes:

> writeOGR(point.shape,".","point_shape1", driver="ESRI Shapefile")
>
> writeOGR(point.shape,".","point_shape2", driver="ESRI Shapefile" )

# but then if I try to overwrite, it fails:

> writeOGR(point.shape,".","point_shape1", driver="ESRI Shapefile", overwrite_layer=T)
Error in writeOGR(point.shape, ".", "point_shape1", driver = "ESRI Shapefile",  :
  Creation of output file failed

# Interestingly, it erases 2 files from point_shape1 before failing (the .prj and the .shx).
# and from now on, it's impossible to create new shapefile:

> writeOGR(point.shape,".","point_shape3", driver="ESRI Shapefile" )
Error in writeOGR(point.shape, ".", "point_shape3", driver = "ESRI Shapefile") :
  Creation of output file failed
###

However, after restarting the whole session and erasing the files created, and try this new order:

###

>
> writeOGR(point.shape,".","point_shape1", driver="ESRI Shapefile")
>
> writeOGR(point.shape,".","point_shape1", driver="ESRI Shapefile", overwrite_layer=T)
>
> writeOGR(point.shape,".","point_shape2", driver="ESRI Shapefile" )
>
> writeOGR(point.shape,".","point_shape3", driver="ESRI Shapefile" )
>

###
Everything works fine.  So two questions arise:

1) why does overwrite_layer doesn't work when the order is changed, can it be fixed?
2) How to "reset" the writeOGR function after a fail as it seems once it fails, it get impossible to reuse it in the same session.

After reading this post: http://stackoverflow.com/questions/6219368/problem-writing-shapefiles-with-writeogr-in-r, I think it may be some connection issue.  Is there a easy way to close manually the connection after using writeOGR?  Something like close.OGR.connection()?

I know maptools::writeSpatialShape can also be used to write shapefile, however it doesn't write the projection information which I want. It seems to me that there is a problem with writeOGR, which is a good function so it could deserve to be fix.

Thanks for your help,

Bastien Ferland-Raymond, M.Sc. Stat., M.Sc. Biol.
Division des orientations et projets sp?ciaux
Direction des inventaires forestiers
Minist?re des Ressources naturelles et de la Faune


From Tom_Roche at pobox.com  Mon May 14 17:53:21 2012
From: Tom_Roche at pobox.com (Tom Roche)
Date: Mon, 14 May 2012 11:53:21 -0400
Subject: [R-sig-Geo] problem while creating netcdf files
In-Reply-To: <1336928129590-7555235.post@n2.nabble.com>
References: <1336928129590-7555235.post@n2.nabble.com>
Message-ID: <87pqa6kbda.fsf@pobox.com>


Ana Sun, 13 May 2012 09:55:29 -0700 (PDT)
> I am creating netcdf files for climatic daily datasets for 50 years.
> The problem is that I end up with huge files when trying just one
> point, and I have 2000 more points to add. Am I doing something wrong

Yes. The first thing is, use package=ncdf4

http://cran.r-project.org/web/packages/ncdf4/index.html

(rather than the now-unsupported, and deprecated, package=ncdf) and try the example for nc_create in the ncdf4 manual

http://cran.r-project.org/web/packages/ncdf4/ncdf4.pdf

I'm using it for multilayered 459x299 grids (the North American
"AQMEII domain") that are < 1 GB.

HTH, Tom Roche <Tom_Roche at pobox.com>


From r.hijmans at gmail.com  Mon May 14 18:25:43 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 14 May 2012 09:25:43 -0700
Subject: [R-sig-Geo] Antw: Re: Antw: Error when using rowSums along with
 a RasterStack object
In-Reply-To: <CANtt_hxc+ESog66jpw0vc3JaEChn790yb4NbaA87MYttcj+KNA@mail.gmail.com>
References: <4FAFBB46020000270001407B@gwia2.boku.ac.at>
	<CANtt_hxc+ESog66jpw0vc3JaEChn790yb4NbaA87MYttcj+KNA@mail.gmail.com>
Message-ID: <CANtt_hxe701185kF-YKJd-27CAYrJ_yPRrfyHidS5vDLYU06fg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120514/4c670fcd/attachment.pl>

From edzer.pebesma at uni-muenster.de  Mon May 14 18:52:08 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 14 May 2012 18:52:08 +0200
Subject: [R-sig-Geo] problem while creating netcdf files
In-Reply-To: <87pqa6kbda.fsf@pobox.com>
References: <1336928129590-7555235.post@n2.nabble.com>
	<87pqa6kbda.fsf@pobox.com>
Message-ID: <4FB13838.50703@uni-muenster.de>

Tom, this library seems not to be available for windows users. I tried
installing on ubuntu 12.4 LTS, but the netcdf-dev version in this distro
seems too old (4.1.1-6) and no nc-config is available.

Installing netcdf 4.2 from source gave me the following error message:

nc4file.c: In function 'nc4_create_file':
nc4file.c:279:38: error: 'H5F_LIBVER_18' undeclared (first use in this
function)
nc4file.c:279:38: note: each undeclared identifier is reported only once
for each function it appears in
make[2]: *** [libnetcdf4_la-nc4file.lo] Error 1

Searching for the error message gave me one hit, which didn't help me
out. Any ideas?

On 05/14/2012 05:53 PM, Tom Roche wrote:
> 
> Ana Sun, 13 May 2012 09:55:29 -0700 (PDT)
>> I am creating netcdf files for climatic daily datasets for 50 years.
>> The problem is that I end up with huge files when trying just one
>> point, and I have 2000 more points to add. Am I doing something wrong
> 
> Yes. The first thing is, use package=ncdf4
> 
> http://cran.r-project.org/web/packages/ncdf4/index.html
> 
> (rather than the now-unsupported, and deprecated, package=ncdf) and try the example for nc_create in the ncdf4 manual
> 
> http://cran.r-project.org/web/packages/ncdf4/ncdf4.pdf
> 
> I'm using it for multilayered 459x299 grids (the North American
> "AQMEII domain") that are < 1 GB.
> 
> HTH, Tom Roche <Tom_Roche at pobox.com>
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From Roger.Bivand at nhh.no  Mon May 14 19:37:32 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 14 May 2012 19:37:32 +0200 (CEST)
Subject: [R-sig-Geo] Problem with writeOGR and overwrite_layer=T
In-Reply-To: <161DC602615F6943A19BAEA3DBF2E4B9018C0E1D3267@HARFANG.intranet.mrn.gouv>
References: <161DC602615F6943A19BAEA3DBF2E4B9018C0E1D3267@HARFANG.intranet.mrn.gouv>
Message-ID: <alpine.LRH.2.02.1205141911120.15312@reclus.nhh.no>

On Mon, 14 May 2012, Bastien.Ferland-Raymond at mrnf.gouv.qc.ca wrote:

> Dear list,
>
> I have to produce shapefile for a coworker which uses ArcGIS and I've 
> hit a problem with the writeOGR function from the rgdal package.

I can reproduce the problem on Windows 7 with GDAL 1.9.0, that is, that 
parts of shapefiles created by OGR (the *.dbf and *.shp files) cannot be 
deleted by poDS->DeleteLayer() - line 473 in rgdal/src/ogrsource.cpp. This 
also applies before trying to overwrite them - they cannot be deleted in 
Windows Explorer either until the R session exits. Running as 
administrator does not help either.

This appears to be an interaction between Windows (7 in my case), GDAL >= 
1.8.0, which introduced bans on overwriting for Shapefiles, and possibly 
some unknown factors.

This is not a problem I can resolve, certainly not any time soon. It is 
not an R code problem as such (I believe), and the stackoverflow 
speculation is misleading, this has nothing to do with connections, only 
with Windows apparent file usage status.

I would appeal to interested Windows users to contribute a solution - you 
will need to be able to cross-compile GDAL for Windows under MSYS, and to 
build R packages. If Windows users know how to unlink files with an 
incorrect usage status without exiting R, this would possibly help, but 
doesn't get us much further.

Other GDAL/OGR uses such as ogr2ogr exit on error, but it might be helpful 
to know if ogr2ogr does the same - that is, is unable to overwrite a 
layer. MapInfo File, GML and other drivers do not seem to suffer from the 
same issue. Again, checking across a wider range of drivers would help.

Roger

>
> Here is an example:
>
> ###
>
>> library(rgdal)
> Loading required package: sp
> Geospatial Data Abstraction Library extensions to R successfully loaded
> Loaded GDAL runtime: GDAL 1.9.0, released 2011/12/29
> Path to GDAL shared files: \\sebpriv/usagers/Ferba1/R/R-2.15.0/library/rgdal/gdal
> Loaded PROJ.4 runtime: Rel. 4.7.1, 23 September 2009, [PJ_VERSION: 470]
> Path to PROJ.4 shared files: \\sebpriv/usagers/Ferba1/R/R-2.15.0/library/rgdal/proj
>> sessionInfo()
> R version 2.15.0 (2012-03-30)
> Platform: i386-pc-mingw32/i386 (32-bit)
>
> locale:
> [1] LC_COLLATE=French_Canada.1252  LC_CTYPE=French_Canada.1252    LC_MONETARY=French_Canada.1252 LC_NUMERIC=C                   LC_TIME=French_Canada.1252
>
> attached base packages:
> [1] stats     graphics  grDevices utils     datasets  methods   base
>
> other attached packages:
> [1] rgdal_0.7-8 sp_0.9-98
>
> loaded via a namespace (and not attached):
> [1] grid_2.15.0    lattice_0.20-6
>> setwd("C:\\Documents and Settings\\ferba1\\Bureau\\test rgdal")
>
> # make a basic shape:
>
>> coo <- coordinates(cbind(runif(100,220000,300000),runif(100,5160000,5220000)))
>> point.shape <- SpatialPointsDataFrame(coo,data.frame(ID=paste("point",1:100,sep="_")),
> +   proj4string = CRS(" +proj=tmerc +lat_0=0 +lon_0=-73.5 +k=0.9999 +x_0=304800 +y_0=0 +datum=NAD83 +units=m +no_defs +ellps=GRS80 +towgs84=0,0,0"))
>
> # now if I try to write itm it works fine for the first 2 shapes:
>
>> writeOGR(point.shape,".","point_shape1", driver="ESRI Shapefile")
>>
>> writeOGR(point.shape,".","point_shape2", driver="ESRI Shapefile" )
>
> # but then if I try to overwrite, it fails:
>
>> writeOGR(point.shape,".","point_shape1", driver="ESRI Shapefile", overwrite_layer=T)
> Error in writeOGR(point.shape, ".", "point_shape1", driver = "ESRI Shapefile",  :
>  Creation of output file failed
>
> # Interestingly, it erases 2 files from point_shape1 before failing (the .prj and the .shx).
> # and from now on, it's impossible to create new shapefile:
>
>> writeOGR(point.shape,".","point_shape3", driver="ESRI Shapefile" )
> Error in writeOGR(point.shape, ".", "point_shape3", driver = "ESRI Shapefile") :
>  Creation of output file failed
> ###
>
> However, after restarting the whole session and erasing the files created, and try this new order:
>
> ###
>
>>
>> writeOGR(point.shape,".","point_shape1", driver="ESRI Shapefile")
>>
>> writeOGR(point.shape,".","point_shape1", driver="ESRI Shapefile", overwrite_layer=T)
>>
>> writeOGR(point.shape,".","point_shape2", driver="ESRI Shapefile" )
>>
>> writeOGR(point.shape,".","point_shape3", driver="ESRI Shapefile" )
>>
>
> ###
> Everything works fine.  So two questions arise:
>
> 1) why does overwrite_layer doesn't work when the order is changed, can it be fixed?
> 2) How to "reset" the writeOGR function after a fail as it seems once it fails, it get impossible to reuse it in the same session.
>
> After reading this post: http://stackoverflow.com/questions/6219368/problem-writing-shapefiles-with-writeogr-in-r, I think it may be some connection issue.  Is there a easy way to close manually the connection after using writeOGR?  Something like close.OGR.connection()?
>
> I know maptools::writeSpatialShape can also be used to write shapefile, however it doesn't write the projection information which I want. It seems to me that there is a problem with writeOGR, which is a good function so it could deserve to be fix.
>
> Thanks for your help,
>
> Bastien Ferland-Raymond, M.Sc. Stat., M.Sc. Biol.
> Division des orientations et projets sp?ciaux
> Direction des inventaires forestiers
> Minist?re des Ressources naturelles et de la Faune
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From Roger.Bivand at nhh.no  Mon May 14 20:05:41 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 14 May 2012 20:05:41 +0200 (CEST)
Subject: [R-sig-Geo] Problem with writeOGR and overwrite_layer=T
In-Reply-To: <alpine.LRH.2.02.1205141911120.15312@reclus.nhh.no>
References: <161DC602615F6943A19BAEA3DBF2E4B9018C0E1D3267@HARFANG.intranet.mrn.gouv>
	<alpine.LRH.2.02.1205141911120.15312@reclus.nhh.no>
Message-ID: <alpine.LRH.2.02.1205142000580.15312@reclus.nhh.no>

On Mon, 14 May 2012, Roger Bivand wrote:

> On Mon, 14 May 2012, Bastien.Ferland-Raymond at mrnf.gouv.qc.ca wrote:
>
>> Dear list,
>> 
>> I have to produce shapefile for a coworker which uses ArcGIS and I've hit a 
>> problem with the writeOGR function from the rgdal package.
>
> I can reproduce the problem on Windows 7 with GDAL 1.9.0, that is, that parts 
> of shapefiles created by OGR (the *.dbf and *.shp files) cannot be deleted by 
> poDS->DeleteLayer() - line 473 in rgdal/src/ogrsource.cpp. This also applies 
> before trying to overwrite them - they cannot be deleted in Windows Explorer 
> either until the R session exits. Running as administrator does not help 
> either.
>
> This appears to be an interaction between Windows (7 in my case), GDAL >= 
> 1.8.0, which introduced bans on overwriting for Shapefiles, and possibly some 
> unknown factors.
>
> This is not a problem I can resolve, certainly not any time soon. It is not 
> an R code problem as such (I believe), and the stackoverflow speculation is 
> misleading, this has nothing to do with connections, only with Windows 
> apparent file usage status.
>
> I would appeal to interested Windows users to contribute a solution - you 
> will need to be able to cross-compile GDAL for Windows under MSYS, and to 
> build R packages.

Actually, it isn't so hard to contribute, as WinBuilder should be able to 
produce viable Windows binary packages. So contributors should check out 
rgdal anonymously from R-Forge, then let me have patches to insert, submit 
to WinBuilder, and return a download link (say 6 hours later) to see if 
the patch helped. So maybe a local build of GDAL may not be needed, but 
the time involved would be greater.

Roger

> If Windows users know how to unlink files with an incorrect 
> usage status without exiting R, this would possibly help, but doesn't get us 
> much further.
>
> Other GDAL/OGR uses such as ogr2ogr exit on error, but it might be helpful to 
> know if ogr2ogr does the same - that is, is unable to overwrite a layer. 
> MapInfo File, GML and other drivers do not seem to suffer from the same 
> issue. Again, checking across a wider range of drivers would help.
>
> Roger
>
>> 
>> Here is an example:
>> 
>> ###
>> 
>>> library(rgdal)
>> Loading required package: sp
>> Geospatial Data Abstraction Library extensions to R successfully loaded
>> Loaded GDAL runtime: GDAL 1.9.0, released 2011/12/29
>> Path to GDAL shared files: 
>> \\sebpriv/usagers/Ferba1/R/R-2.15.0/library/rgdal/gdal
>> Loaded PROJ.4 runtime: Rel. 4.7.1, 23 September 2009, [PJ_VERSION: 470]
>> Path to PROJ.4 shared files: 
>> \\sebpriv/usagers/Ferba1/R/R-2.15.0/library/rgdal/proj
>>> sessionInfo()
>> R version 2.15.0 (2012-03-30)
>> Platform: i386-pc-mingw32/i386 (32-bit)
>> 
>> locale:
>> [1] LC_COLLATE=French_Canada.1252  LC_CTYPE=French_Canada.1252 
>> LC_MONETARY=French_Canada.1252 LC_NUMERIC=C 
>> LC_TIME=French_Canada.1252
>> 
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>> 
>> other attached packages:
>> [1] rgdal_0.7-8 sp_0.9-98
>> 
>> loaded via a namespace (and not attached):
>> [1] grid_2.15.0    lattice_0.20-6
>>> setwd("C:\\Documents and Settings\\ferba1\\Bureau\\test rgdal")
>> 
>> # make a basic shape:
>> 
>>> coo <- 
>>> coordinates(cbind(runif(100,220000,300000),runif(100,5160000,5220000)))
>>> point.shape <- 
>>> SpatialPointsDataFrame(coo,data.frame(ID=paste("point",1:100,sep="_")),
>> +   proj4string = CRS(" +proj=tmerc +lat_0=0 +lon_0=-73.5 +k=0.9999 
>> +x_0=304800 +y_0=0 +datum=NAD83 +units=m +no_defs +ellps=GRS80 
>> +towgs84=0,0,0"))
>> 
>> # now if I try to write itm it works fine for the first 2 shapes:
>> 
>>> writeOGR(point.shape,".","point_shape1", driver="ESRI Shapefile")
>>> 
>>> writeOGR(point.shape,".","point_shape2", driver="ESRI Shapefile" )
>> 
>> # but then if I try to overwrite, it fails:
>> 
>>> writeOGR(point.shape,".","point_shape1", driver="ESRI Shapefile", 
>>> overwrite_layer=T)
>> Error in writeOGR(point.shape, ".", "point_shape1", driver = "ESRI 
>> Shapefile",  :
>>  Creation of output file failed
>> 
>> # Interestingly, it erases 2 files from point_shape1 before failing (the 
>> .prj and the .shx).
>> # and from now on, it's impossible to create new shapefile:
>> 
>>> writeOGR(point.shape,".","point_shape3", driver="ESRI Shapefile" )
>> Error in writeOGR(point.shape, ".", "point_shape3", driver = "ESRI 
>> Shapefile") :
>>  Creation of output file failed
>> ###
>> 
>> However, after restarting the whole session and erasing the files created, 
>> and try this new order:
>> 
>> ###
>> 
>>> 
>>> writeOGR(point.shape,".","point_shape1", driver="ESRI Shapefile")
>>> 
>>> writeOGR(point.shape,".","point_shape1", driver="ESRI Shapefile", 
>>> overwrite_layer=T)
>>> 
>>> writeOGR(point.shape,".","point_shape2", driver="ESRI Shapefile" )
>>> 
>>> writeOGR(point.shape,".","point_shape3", driver="ESRI Shapefile" )
>>> 
>> 
>> ###
>> Everything works fine.  So two questions arise:
>> 
>> 1) why does overwrite_layer doesn't work when the order is changed, can it 
>> be fixed?
>> 2) How to "reset" the writeOGR function after a fail as it seems once it 
>> fails, it get impossible to reuse it in the same session.
>> 
>> After reading this post: 
>> http://stackoverflow.com/questions/6219368/problem-writing-shapefiles-with-writeogr-in-r, 
>> I think it may be some connection issue.  Is there a easy way to close 
>> manually the connection after using writeOGR?  Something like 
>> close.OGR.connection()?
>> 
>> I know maptools::writeSpatialShape can also be used to write shapefile, 
>> however it doesn't write the projection information which I want. It seems 
>> to me that there is a problem with writeOGR, which is a good function so it 
>> could deserve to be fix.
>> 
>> Thanks for your help,
>> 
>> Bastien Ferland-Raymond, M.Sc. Stat., M.Sc. Biol.
>> Division des orientations et projets sp?ciaux
>> Direction des inventaires forestiers
>> Minist?re des Ressources naturelles et de la Faune
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From debeaudette at ucdavis.edu  Mon May 14 21:33:06 2012
From: debeaudette at ucdavis.edu (Dylan Beaudette)
Date: Mon, 14 May 2012 12:33:06 -0700
Subject: [R-sig-Geo] plotKML problem
In-Reply-To: <CAKrCUaXV-hRpeLO5cvpQJ3BSjv9G=SR+_dsPKTVz+NgwY6de-A@mail.gmail.com>
References: <CAKrCUaXV-hRpeLO5cvpQJ3BSjv9G=SR+_dsPKTVz+NgwY6de-A@mail.gmail.com>
Message-ID: <201205141233.06462.dylan.beaudette@gmail.com>

On Sunday, April 29, 2012, Daniel Arribas-Bel wrote:
> Dear R-sig-geo list,
> 
> I have succesfully installed 'plotKML' 0.1-6 under Ubuntu 11.10-32bit
> running R 2.15. I run into an error when I try to replicate one of the
> examples in the documentation, particularly that of kml-methods (
> http://plotkml.r-forge.r-project.org/kml-method.html). The first one runs
> fine but when I try to plot a SpatialPixelsDataFrame:
> 
> ## End(Not run)
> # Plotting a SpatialPixelsDataFrame or a Raster* object
> data(eberg_grid)
> coordinates(eberg_grid) <- ~x+y
> gridded(eberg_grid) <- TRUE
> proj4string(eberg_grid) <- CRS("+init=epsg:31467")
> ## Not run:
> kml(eberg_grid, colour = DEM, file = "eberg_grid-0.kml")
> 
> 
> 
> I run into the following error:
> 
> Error in paths(show.paths = TRUE) :
> >   could not find function "shortPathName"
> >
> 
> In fact, simply typing 'paths()' returns the same error. A bit of googling
> seems to reveal the method 'shortPathName' appears to only exist in the Win
> version of R, but not for linux/Mac.
> 
> Is plotKML supposed to work only under Windows? If not, am I mising
> something? Is there any workaround?
> 

This package is still very much a work in progress, and will eventually work 
on all platforms. The lead package author, Tom Hengl, may be able to provide 
some insight.

Stay tuned,
Dylan

-- 
Dylan E. Beaudette
USDA-NRCS Soil Scientist
California Soil Resource Lab
http://casoilresource.lawr.ucdavis.edu/


From edzer.pebesma at uni-muenster.de  Mon May 14 21:51:24 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Mon, 14 May 2012 21:51:24 +0200
Subject: [R-sig-Geo] Projected data in R-Gstat
In-Reply-To: <CA+WaK3Gd9w7F7VU5CkqB29t1RfrU631-CGhkXLXnid58JbUnDA@mail.gmail.com>
References: <CA+WaK3Gd9w7F7VU5CkqB29t1RfrU631-CGhkXLXnid58JbUnDA@mail.gmail.com>
Message-ID: <4FB1623C.7080608@uni-muenster.de>



On 05/11/2012 12:35 PM, David Marguerit wrote:
> Dear R-Sig-Geo,
> 
> 
> I am trying to interpolate air pollution from air monitoring thanks to
> ordinary kriging in order to assign the pollution exposure for a sample of
> individual for the city of Phoenix, Arizona, using the Gstat package.
> 
> 
> However, I have some trouble to understand how my data should be projected
> in order to fit the variogram. My data are in longitude/latitude:
> 
> 
> id    co1h    latitude    longitude
> 1    390    33.49462    -112.1310
> 2    470    33.48385    -112.1426
> 3    170    33.41045    -111.8651
> 4    210    33.56033    -112.0663
> 5    210    33.56936    -112.1915
> 6    360    33.45793    -112.0460
> 7    200    33.47968    -111.9172
> 8    300    33.46093    -112.1175
> 9    370    33.40316    -112.0753
> 10    180    33.29898    -111.8843
> 11    240    33.41240    -111.9347
> 12    150    33.63713    -112.3418
> 13    70    33.37005    -112.6207
> 14    310    33.50318    -112.0956
> 
> 
> In order to fit the variogram I use the following commands with:
> 
>  co<-read.dta("co1h.dta")
> 
> coordinates(co) = ~longitude+latitude
> 
> v <- variogram(log(co1h) ~ 1, co)
> 
> plot(v)
> 
> vgm<-vgm(0.59638453, "Hol", 0.1490525,0.02910648, anis = c(90, 0.8))
> 
> v.fit<-fit.variogram(v, vgm)
> 
> v.fit
> 
> plot(v,fit.variogram(v, vgm))
> 
> 
> 
> Does anyone know if my projection is correct or whether I need to change
> it? If it is necessary to change, do you know how can I do it and what
> should be the correct projection?

Yes, it is not correct. You didn't set it, so

proj4string(co)

will give you NA (missing). This means that gstat will assume they are
metric (in m, or km), and compute distances using regular (Euclidian)
distances -- which is wrong!

You have to do the following:

proj4string(co) =  "+proj=longlat +datum=WGS84"

(assuming this is the correct datum setting!)

and then rerun the variogram fitting. In this case, gstat will use great
circle distances instead of Euclidian distances.

An alternative would be to reproject your data, e.g. to the appropriate
UTM zone, and then re-run the variogram estimation and fitting.

http://en.wikipedia.org/wiki/Universal_Transverse_Mercator_coordinate_system

might point you to the appropriate zone.

With best regards,
> 
> 
> Thank you very much for your help!
> 
> Kind regards,
> 
> Marguerit David
> 
> PhD in economics,
> 
> University Paris Dauphine, France
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From Bastien.Ferland-Raymond at mrnf.gouv.qc.ca  Mon May 14 22:13:43 2012
From: Bastien.Ferland-Raymond at mrnf.gouv.qc.ca (Bastien.Ferland-Raymond at mrnf.gouv.qc.ca)
Date: Mon, 14 May 2012 16:13:43 -0400
Subject: [R-sig-Geo] RE :  Problem with writeOGR and overwrite_layer=T
In-Reply-To: <alpine.LRH.2.02.1205142000580.15312@reclus.nhh.no>
Message-ID: <161DC602615F6943A19BAEA3DBF2E4B9018C0E1D3269@HARFANG.intranet.mrn.gouv>

Thanks Roger for your response,

I'm happy that the problem is now known, however I'm afraid I won't be able to help much with it, I'm no programmer just a user.  Hopefully somebody out there will be able to put your explanations to good use and provide a long term solution.

Thanks again,

Bastien


-----Message d'origine-----
De : Roger Bivand [mailto:Roger.Bivand at nhh.no]
Envoy? : 14 mai 2012 14:06
? : Ferland-Raymond, Bastien (DIF)
Cc : r-sig-geo at r-project.org
Objet : Re: [R-sig-Geo] Problem with writeOGR and overwrite_layer=T

On Mon, 14 May 2012, Roger Bivand wrote:

> On Mon, 14 May 2012, Bastien.Ferland-Raymond at mrnf.gouv.qc.ca wrote:
>
>> Dear list,
>>
>> I have to produce shapefile for a coworker which uses ArcGIS and I've hit a
>> problem with the writeOGR function from the rgdal package.
>
> I can reproduce the problem on Windows 7 with GDAL 1.9.0, that is, that parts
> of shapefiles created by OGR (the *.dbf and *.shp files) cannot be deleted by
> poDS->DeleteLayer() - line 473 in rgdal/src/ogrsource.cpp. This also applies
> before trying to overwrite them - they cannot be deleted in Windows Explorer
> either until the R session exits. Running as administrator does not help
> either.
>
> This appears to be an interaction between Windows (7 in my case), GDAL >=
> 1.8.0, which introduced bans on overwriting for Shapefiles, and possibly some
> unknown factors.
>
> This is not a problem I can resolve, certainly not any time soon. It is not
> an R code problem as such (I believe), and the stackoverflow speculation is
> misleading, this has nothing to do with connections, only with Windows
> apparent file usage status.
>
> I would appeal to interested Windows users to contribute a solution - you
> will need to be able to cross-compile GDAL for Windows under MSYS, and to
> build R packages.

Actually, it isn't so hard to contribute, as WinBuilder should be able to
produce viable Windows binary packages. So contributors should check out
rgdal anonymously from R-Forge, then let me have patches to insert, submit
to WinBuilder, and return a download link (say 6 hours later) to see if
the patch helped. So maybe a local build of GDAL may not be needed, but
the time involved would be greater.

Roger

> If Windows users know how to unlink files with an incorrect
> usage status without exiting R, this would possibly help, but doesn't get us
> much further.
>
> Other GDAL/OGR uses such as ogr2ogr exit on error, but it might be helpful to
> know if ogr2ogr does the same - that is, is unable to overwrite a layer.
> MapInfo File, GML and other drivers do not seem to suffer from the same
> issue. Again, checking across a wider range of drivers would help.
>
> Roger
>
>>
>> Here is an example:
>>
>> ###
>>
>>> library(rgdal)
>> Loading required package: sp
>> Geospatial Data Abstraction Library extensions to R successfully loaded
>> Loaded GDAL runtime: GDAL 1.9.0, released 2011/12/29
>> Path to GDAL shared files:
>> \\sebpriv/usagers/Ferba1/R/R-2.15.0/library/rgdal/gdal
>> Loaded PROJ.4 runtime: Rel. 4.7.1, 23 September 2009, [PJ_VERSION: 470]
>> Path to PROJ.4 shared files:
>> \\sebpriv/usagers/Ferba1/R/R-2.15.0/library/rgdal/proj
>>> sessionInfo()
>> R version 2.15.0 (2012-03-30)
>> Platform: i386-pc-mingw32/i386 (32-bit)
>>
>> locale:
>> [1] LC_COLLATE=French_Canada.1252  LC_CTYPE=French_Canada.1252
>> LC_MONETARY=French_Canada.1252 LC_NUMERIC=C
>> LC_TIME=French_Canada.1252
>>
>> attached base packages:
>> [1] stats     graphics  grDevices utils     datasets  methods   base
>>
>> other attached packages:
>> [1] rgdal_0.7-8 sp_0.9-98
>>
>> loaded via a namespace (and not attached):
>> [1] grid_2.15.0    lattice_0.20-6
>>> setwd("C:\\Documents and Settings\\ferba1\\Bureau\\test rgdal")
>>
>> # make a basic shape:
>>
>>> coo <-
>>> coordinates(cbind(runif(100,220000,300000),runif(100,5160000,5220000)))
>>> point.shape <-
>>> SpatialPointsDataFrame(coo,data.frame(ID=paste("point",1:100,sep="_")),
>> +   proj4string = CRS(" +proj=tmerc +lat_0=0 +lon_0=-73.5 +k=0.9999
>> +x_0=304800 +y_0=0 +datum=NAD83 +units=m +no_defs +ellps=GRS80
>> +towgs84=0,0,0"))
>>
>> # now if I try to write itm it works fine for the first 2 shapes:
>>
>>> writeOGR(point.shape,".","point_shape1", driver="ESRI Shapefile")
>>>
>>> writeOGR(point.shape,".","point_shape2", driver="ESRI Shapefile" )
>>
>> # but then if I try to overwrite, it fails:
>>
>>> writeOGR(point.shape,".","point_shape1", driver="ESRI Shapefile",
>>> overwrite_layer=T)
>> Error in writeOGR(point.shape, ".", "point_shape1", driver = "ESRI
>> Shapefile",  :
>>  Creation of output file failed
>>
>> # Interestingly, it erases 2 files from point_shape1 before failing (the
>> .prj and the .shx).
>> # and from now on, it's impossible to create new shapefile:
>>
>>> writeOGR(point.shape,".","point_shape3", driver="ESRI Shapefile" )
>> Error in writeOGR(point.shape, ".", "point_shape3", driver = "ESRI
>> Shapefile") :
>>  Creation of output file failed
>> ###
>>
>> However, after restarting the whole session and erasing the files created,
>> and try this new order:
>>
>> ###
>>
>>>
>>> writeOGR(point.shape,".","point_shape1", driver="ESRI Shapefile")
>>>
>>> writeOGR(point.shape,".","point_shape1", driver="ESRI Shapefile",
>>> overwrite_layer=T)
>>>
>>> writeOGR(point.shape,".","point_shape2", driver="ESRI Shapefile" )
>>>
>>> writeOGR(point.shape,".","point_shape3", driver="ESRI Shapefile" )
>>>
>>
>> ###
>> Everything works fine.  So two questions arise:
>>
>> 1) why does overwrite_layer doesn't work when the order is changed, can it
>> be fixed?
>> 2) How to "reset" the writeOGR function after a fail as it seems once it
>> fails, it get impossible to reuse it in the same session.
>>
>> After reading this post:
>> http://stackoverflow.com/questions/6219368/problem-writing-shapefiles-with-writeogr-in-r,
>> I think it may be some connection issue.  Is there a easy way to close
>> manually the connection after using writeOGR?  Something like
>> close.OGR.connection()?
>>
>> I know maptools::writeSpatialShape can also be used to write shapefile,
>> however it doesn't write the projection information which I want. It seems
>> to me that there is a problem with writeOGR, which is a good function so it
>> could deserve to be fix.
>>
>> Thanks for your help,
>>
>> Bastien Ferland-Raymond, M.Sc. Stat., M.Sc. Biol.
>> Division des orientations et projets sp?ciaux
>> Direction des inventaires forestiers
>> Minist?re des Ressources naturelles et de la Faune
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>

--
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From andrewaduff at gmail.com  Mon May 14 22:44:55 2012
From: andrewaduff at gmail.com (Andrew Duff)
Date: Mon, 14 May 2012 13:44:55 -0700
Subject: [R-sig-Geo] TWS Spatial Ecology and Telemetry Awards
Message-ID: <CAO2uuDQb0-hQuaMTxptGWT8wsW4ue71_4WqJLhpAhpXV30vMyw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120514/e53bfbc8/attachment.pl>

From raul.jimenez.rosenberg at gmail.com  Tue May 15 09:58:11 2012
From: raul.jimenez.rosenberg at gmail.com (=?ISO-8859-1?Q?Ra=FAl_Jim=E9nez_Rosenberg?=)
Date: Tue, 15 May 2012 02:58:11 -0500
Subject: [R-sig-Geo] Raster getData() problem
Message-ID: <CAE9g_rEk7w-YDRae_X30f8XViSYCaZVMWJ2i+-Xwbi_zjgnB=w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120515/2ab9929f/attachment.pl>

From thi_veloso at yahoo.com.br  Tue May 15 13:27:15 2012
From: thi_veloso at yahoo.com.br (Thiago Veloso)
Date: Tue, 15 May 2012 04:27:15 -0700 (PDT)
Subject: [R-sig-Geo] Antw: Re: Antw: Error when using rowSums along with
	a RasterStack object
References: <4FAFBB46020000270001407B@gwia2.boku.ac.at>
	<CANtt_hxc+ESog66jpw0vc3JaEChn790yb4NbaA87MYttcj+KNA@mail.gmail.com>
	<CANtt_hxe701185kF-YKJd-27CAYrJ_yPRrfyHidS5vDLYU06fg@mail.gmail.com>
Message-ID: <1337081235.11802.YahooMailNeo@web161404.mail.bf1.yahoo.com>

? Robert and Matteo,

? Thanks for your suggestions. I ended up running the old version of my script, which, after some crop operations, takes 'only' 40 minutes per annual-summation relative to the old 51-minute mark.

? Although your suggestions on memory optimization are really tempting, the server I use is shared with my workgroup and I don't want to create a memory black hole!

? For everyone's appreciation, I am pasting the code in the end of this message.

? All the best,
? Thiago.

# loading required packages (raster will do the most of the processing,?

# rgdal is used to load images, ncdf writes the resulting netcdf files
# and maptools is used to load shapefiles which crops the images.)
library(raster)
library(rgdal)
library(ncdf)
library(maptools)

# set the working directory
setwd("/mnt/disco3/MODIS/MOSAIC/GPP")

# load and project shapefiles to crop images later
sa<-readShapePoly("/mnt/disco3/MODIS/shapes/southamerica.shp")
br<-readShapePoly("/mnt/disco3/MODIS/shapes/brazil.shp")
shape_proj<-raster('/mnt/disco3/MODIS/MOSAIC/GPP/gpp2001001.Gpp_1km.tif')
projection(sa)<-projection(shape_proj)
projection(br)<-projection(shape_proj)

# define a function to perform common tasks
fun <- function(x) {
? ? ? ? x [x > 32760] <- NA #remove unvalid range of values (water, unclassified pixes etc): 32760 for GPP and ?for LAI
? ? ? ? x <- x * 0.0001 #scale factor for MODIS GPP product: 0.0001 for GPP and 0.1 for LAI
? ? ? ? x <- sum(x,na.rm=FALSE) #integrating 46 satellite images takes 51 minutes (3,104 seconds) to run
}

# Once the function has been defined, it should be relatively
# straightforward to loop over years to perform annual integration
files <- list.files(pattern='.Gpp_1km.tif', ?full.names=TRUE)
years <- substr(files, 6, 9)
for (y in 2001:2011) {
? ? ? ?f <- files[ years == y ]
? ? ? ?# stack one year's all files
? ? ? ?s <- stack(f) #stacking 46 images takes 10 seconds to run
? ? ? ?s <- crop(s,br)
? ? ? ?fout ?<- paste('/mnt/disco3/MODIS/MOSAIC/GPP/yearly/gpp_', y,'.nc', sep='')
? ? ? ?x <- calc(s, fun, filename=fout)
}
________________________________
From: Robert J. Hijmans <r.hijmans at gmail.com>
To: thi_veloso at yahoo.com.br
Cc: r-sig-geo at r-project.org; Matteo Mattiuzzi <matteo.mattiuzzi at boku.ac.at> 
Sent: Monday, May 14, 2012 1:25 PM
Subject: Re: [R-sig-Geo] Antw: Re: Antw: Error when using rowSums along with a RasterStack object


Thiago,?

I forgot to mention that you may be able to further speed things up by processing the data in bigger chunks, using?

setOptions(chunksize= ? )

The default setting is somewhat conservative, to avoid errors from occurring, but if you want to live in the fast lane, give it a try.

Also, Matteo pointed out to me that ?calc(x, sum) ?also uses rowSums; so speed should be equivalent for sum and calc. calc has the advantage of being able to set a filename.?

Robert


On Sun, May 13, 2012 at 9:03 AM, Robert J. Hijmans <r.hijmans at gmail.com> wrote:

sum should be faster than calc(x, sum) because sum uses rowSums whereas calc, in this case, would call apply(values(x), 1, sum).?calc(x, function(i) rowSums(i)) should be equivalent to sum (in speed and results).?
>
>
>Whether making a RasterBrick is worth it depends on how many times you will use these files for this type of computation. If it is only for one computation it should be slower to first make bricks, as the main bottleneck in these computations is disk I/O.?I cannot think of another way to speed things up right now --- something we are working through clustering (probably not too helpful here), and C routines.
>
>
>30 hours is long, but it is the computer that's working, not you.
>
>Robert
>
>
>
>
>On Sun, May 13, 2012 at 4:46 AM, Matteo Mattiuzzi <matteo.mattiuzzi at boku.ac.at> wrote:
>
>Dear Thiago,
>>
>>I don't know what makes sum() more suitable comparing to calc() but I think a fakt that you are useing a stack (and not a brick) influences also the speed of processing:
>>
>>######################
>>
>>library(raster)
>>r <- raster()
>>r[] <- 1:ncell(r)
>>
>>setOptions(todisk=TRUE)
>>system.time(st <- stack(r,r,r,r,r,r,r,r,r))
>>system.time(br <- brick(r,r,r,r,r,r,r,r,r))
>>
>>system.time(sum(st,na.rm=FALSE))
>>system.time(sum(br,na.rm=FALSE))
>>
>>system.time(calc(st,sum,na.rm=FALSE))
>>system.time(calc(br,sum,na.rm=FALSE))
>>
>>setOptions(todisk=FALSE)
>>#######################
>>
>># Of coarse the creation of a brick takes a bit of time since the data needs to be re-organised physically on the disk.
>># But this initial overhead worthwhile relatively quickly, you have to check this.
>>
>># Cheers Matteo
>>
>>
>>
>>
>>>>> Thiago Veloso ?13.05.12 1.53 Uhr >>>
>>
>>?Robert,
>>?Thanks for your input. Your suggestion is more suitable to my case, but it takes almost one hour to sum a stack containing 46 satellite images. Please see below:
>>> sclass ? ? ? : RasterStack dimensions ?: 5568, 8289, 46153152, 46 ?(nrow, ncol, ncell, nlayers)resolution ?: 0.00898, 0.00898 ?(x, y)extent ? ? ?: -104.4326, -29.99736, -40.00064, 10 ?(xmin, xmax, ymin, ymax)coord. ref. : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0 min values ?: -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, ... max values ?: 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, ... layer names : gpp2004001.Gpp_1km, gpp2004009.Gpp_1km, gpp2004017.Gpp_1km, gpp2004025.Gpp_1km, gpp2004033.Gpp_1km, gpp2004041.Gpp_1km, gpp2004049.Gpp_1km, gpp2004057.Gpp_1km, gpp2004065.Gpp_1km, gpp2004073.Gpp_1km, gpp2004081.Gpp_1km, gpp2004089.Gpp_1km, gpp2004097.Gpp_1km, gpp2004105.Gpp_1km, gpp2004113.Gpp_1km, ...
>>
>>?For reference, total size of the 46 images which compose the stack reaches 4GB. Here is how long it takes to perform the sum over the stack:
>>> system.time(sos <- sum(s,na.rm=FALSE)) ? ?user ? system ?elapsed ?743.098 ? 31.258 3104.113
>>?The machine I am using to process this dataset is an 3GHz quadcore with 16GB of RAM, running Opensuse and latest R (2.15.0).
>>?As processing my entire data involves performing this operation at least 30 times, is there a way to optimize the process?
>>?All the best, ?Thiago.
>>
>>--- On Sat, 12/5/12, Robert J. Hijmans ?wrote:
>>
>>From: Robert J. Hijmans
>>
>>Subject: Re: [R-sig-Geo] Antw: Error when using rowSums along with a RasterStack object
>>To: thi_veloso at yahoo.com.br
>>Cc: r-sig-geo at r-project.org
>>Date: Saturday, 12 May, 2012, 13:43
>>
>>You can also do
>>sos <- sum(s, na.rm=FALSE)
>>Best, Robert
>>
>>
>>
>>On Sat, May 12, 2012 at 2:26 AM, Matteo Mattiuzzi ?wrote:
>>
>>Dear Thiago,
>>
>>
>>
>>is this what you need?
>>
>>####
>>
>>library(raster)
>>
>>r <- raster()
>>
>>r[]<-1:ncell(r)
>>
>>r2 <- raster()
>>
>>r2[]<-ncell(r):1
>>
>>r <-brick(r,r2)
>>
>>plot(r)
>>
>>
>>
>>sos <- calc(r,sum)
>>
>>x11()
>>
>>plot(sos)
>>
>>####
>>
>>Matteo
>>
>>
>>
>>sos <- calc(r,sum)
>>
>>plot(sos)
>>
>>
>>
>>>>> Thiago Veloso ?11.05.12 23.29 Uhr >>>
>>
>>Dear R-colleagues,
>>
>>
>>
>>I am trying to sum all layers of a RasterStack object, which is summarized below:
>>
>>
>>
>>> s
>>
>>class ? ? ? : RasterStack
>>
>>dimensions ?: 5568, 8289, 46153152, 46 ?(nrow, ncol, ncell, nlayers)
>>
>>resolution ?: 0.00898, 0.00898 ?(x, y)
>>
>>extent ? ? ?: -104.4326, -29.99736, -40.00064, 10 ?(xmin, xmax, ymin, ymax)
>>
>>coord. ref. : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0
>>
>>min values ?: -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, ...
>>
>>max values ?: 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, ...
>>
>>layer names : gpp2004001.Gpp_1km, gpp2004009.Gpp_1km, gpp2004017.Gpp_1km, gpp2004025.Gpp_1km, gpp2004033.Gpp_1km, gpp2004041.Gpp_1km, gpp2004049.Gpp_1km, gpp2004057.Gpp_1km, gpp2004065.Gpp_1km, gpp2004073.Gpp_1km, gpp2004081.Gpp_1km, gpp2004089.Gpp_1km, gpp2004097.Gpp_1km, gpp2004105.Gpp_1km, gpp2004113.Gpp_1km, ...
>>
>>
>>
>>
>>The raster 's' is composed by 46 satellite images at a resolution of 1km (0.00898degree). Each layer is a 8-day composition of leaf area index and I need to integrate an entire year of LAI. When I try to run the "rowSums" function in this RasterStack, the following error is displayed:
>>
>>
>>
>>
>>> sos <- rowSums(s,na.rm=FALSE)
>>
>>Error in rowSums(s, na.rm = FALSE) :
>>
>>?'x' must be an array of at least two dimensions
>>
>>
>>
>>The same occurs when I try to use .rowSums providing matrix dimensions:
>>
>>
>>
>>> sos <- .rowSums(s,5568,8289)
>>
>>Error in .rowSums(s, 5568, 8289) : 'x' must be numeric
>>
>>
>>
>>
>>
>>What am I doing wrong? Is there another way to integrate the layers of a RasterStack object?
>>
>>
>>
>>Thanks in advance,
>>
>>Thiago Veloso.
>>
>>
>>
>>P.S.: Attaching sessionInfo output to provide useful information:
>>
>>
>>
>>> sessionInfo()
>>
>>R version 2.15.0 (2012-03-30)
>>
>>Platform: x86_64-unknown-linux-gnu (64-bit)
>>
>>
>>
>>locale:
>>
>>?[1] LC_CTYPE=en_US.UTF-8 ? ? ? LC_NUMERIC=C
>>
>>?[3] LC_TIME=en_US.UTF-8 ? ? ? ?LC_COLLATE=en_US.UTF-8
>>
>>?[5] LC_MONETARY=en_US.UTF-8 ? ?LC_MESSAGES=en_US.UTF-8
>>
>>?[7] LC_PAPER=C ? ? ? ? ? ? ? ? LC_NAME=C
>>
>>?[9] LC_ADDRESS=C ? ? ? ? ? ? ? LC_TELEPHONE=C
>>
>>[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>>
>>
>>
>>attached base packages:
>>
>>[1] stats ? ? graphics ?grDevices utils ? ? datasets ?methods ? base
>>
>>
>>
>>other attached packages:
>>
>>[1] ncdf_1.6.6 ? ?rgdal_0.7-11 ?raster_1.9-92 sp_0.9-99
>>
>>
>>
>>loaded via a namespace (and not attached):
>>
>>[1] grid_2.15.0 ? ?lattice_0.20-6
>>
>>
>>
>>
>>
>>_______________________________________________
>>
>>R-sig-Geo mailing list
>>
>>R-sig-Geo at r-project.org
>>
>>https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>>
>>
>>
>>? ? ? ?[[alternative HTML version deleted]]
>>
>>
>>
>>_______________________________________________
>>
>>R-sig-Geo mailing list
>>
>>R-sig-Geo at r-project.org
>>
>>https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>>
>>
>>
? ?[[alternative HTML version deleted]]
>>
>>
>>
>>
>>? ? ? ?[[alternative HTML version deleted]]
>>
>>_______________________________________________
>>R-sig-Geo mailing list
>>R-sig-Geo at r-project.org
>>https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>



From hiemstra at knmi.nl  Tue May 15 14:29:02 2012
From: hiemstra at knmi.nl (Paul Hiemstra)
Date: Tue, 15 May 2012 14:29:02 +0200
Subject: [R-sig-Geo] Projected data in R-Gstat
In-Reply-To: <4FB1623C.7080608@uni-muenster.de>
References: <CA+WaK3Gd9w7F7VU5CkqB29t1RfrU631-CGhkXLXnid58JbUnDA@mail.gmail.com>
	<4FB1623C.7080608@uni-muenster.de>
Message-ID: <4FB24C0E.9020501@knmi.nl>

On 05/14/2012 09:51 PM, Edzer Pebesma wrote:
>
> On 05/11/2012 12:35 PM, David Marguerit wrote:
>> Dear R-Sig-Geo,
>>
>>
>> I am trying to interpolate air pollution from air monitoring thanks to
>> ordinary kriging in order to assign the pollution exposure for a sample of
>> individual for the city of Phoenix, Arizona, using the Gstat package.
>>
>>
>> However, I have some trouble to understand how my data should be projected
>> in order to fit the variogram. My data are in longitude/latitude:
>>
>>
>> id    co1h    latitude    longitude
>> 1    390    33.49462    -112.1310
>> 2    470    33.48385    -112.1426
>> 3    170    33.41045    -111.8651
>> 4    210    33.56033    -112.0663
>> 5    210    33.56936    -112.1915
>> 6    360    33.45793    -112.0460
>> 7    200    33.47968    -111.9172
>> 8    300    33.46093    -112.1175
>> 9    370    33.40316    -112.0753
>> 10    180    33.29898    -111.8843
>> 11    240    33.41240    -111.9347
>> 12    150    33.63713    -112.3418
>> 13    70    33.37005    -112.6207
>> 14    310    33.50318    -112.0956
>>
>>
>> In order to fit the variogram I use the following commands with:
>>
>>  co<-read.dta("co1h.dta")
>>
>> coordinates(co) = ~longitude+latitude
>>
>> v <- variogram(log(co1h) ~ 1, co)
>>
>> plot(v)
>>
>> vgm<-vgm(0.59638453, "Hol", 0.1490525,0.02910648, anis = c(90, 0.8))
>>
>> v.fit<-fit.variogram(v, vgm)
>>
>> v.fit
>>
>> plot(v,fit.variogram(v, vgm))
>>
>>
>>
>> Does anyone know if my projection is correct or whether I need to change
>> it? If it is necessary to change, do you know how can I do it and what
>> should be the correct projection?
> Yes, it is not correct. You didn't set it, so
>
> proj4string(co)
>
> will give you NA (missing). This means that gstat will assume they are
> metric (in m, or km), and compute distances using regular (Euclidian)
> distances -- which is wrong!
>
> You have to do the following:
>
> proj4string(co) =  "+proj=longlat +datum=WGS84"
>
> (assuming this is the correct datum setting!)
>
> and then rerun the variogram fitting. In this case, gstat will use great
> circle distances instead of Euclidian distances.
>
> An alternative would be to reproject your data, e.g. to the appropriate
> UTM zone, and then re-run the variogram estimation and fitting.
>
> http://en.wikipedia.org/wiki/Universal_Transverse_Mercator_coordinate_system
>
> might point you to the appropriate zone.

...in addition, for reprojection of data you can use the spTransform
function from the rgdal package.

regards,
Paul

> With best regards,
>>
>> Thank you very much for your help!
>>
>> Kind regards,
>>
>> Marguerit David
>>
>> PhD in economics,
>>
>> University Paris Dauphine, France
>>
>> 	[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


-- 
Paul Hiemstra, Ph.D.
Global Climate Division
Royal Netherlands Meteorological Institute (KNMI)
Wilhelminalaan 10 | 3732 GK | De Bilt | Kamer B 3.22
P.O. Box 201 | 3730 AE | De Bilt
tel: +31 30 2206 494

http://nl.linkedin.com/pub/paul-hiemstra/20/30b/770


From matteo.mattiuzzi at boku.ac.at  Tue May 15 14:28:56 2012
From: matteo.mattiuzzi at boku.ac.at (Matteo Mattiuzzi)
Date: Tue, 15 May 2012 14:28:56 +0200
Subject: [R-sig-Geo] Antw: Re: Antw: Error when using rowSums along with
 a RasterStack object
In-Reply-To: <1337081235.11802.YahooMailNeo@web161404.mail.bf1.yahoo.com>
References: <4FAFBB46020000270001407B@gwia2.boku.ac.at>
	<CANtt_hxc+ESog66jpw0vc3JaEChn790yb4NbaA87MYttcj+KNA@mail.gmail.com>
	<CANtt_hxe701185kF-YKJd-27CAYrJ_yPRrfyHidS5vDLYU06fg@mail.gmail.com>
	<1337081235.11802.YahooMailNeo@web161404.mail.bf1.yahoo.com>
Message-ID: <4FB268280200002700014108@gwia2.boku.ac.at>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120515/801e7ed6/attachment.pl>

From jaimebg27 at gmail.com  Tue May 15 16:38:14 2012
From: jaimebg27 at gmail.com (=?ISO-8859-1?Q?Jaime_Burbano_Gir=F3n?=)
Date: Tue, 15 May 2012 09:38:14 -0500
Subject: [R-sig-Geo] Include a Graphic Scale in a Map
Message-ID: <CADiqS84Jf0TQU4Z5+ifHTs9v-f6QqfNjnXnhOdbQgCS9nz-y7g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120515/83320e65/attachment.pl>

From jaimebg27 at gmail.com  Tue May 15 16:38:14 2012
From: jaimebg27 at gmail.com (=?ISO-8859-1?Q?Jaime_Burbano_Gir=F3n?=)
Date: Tue, 15 May 2012 09:38:14 -0500
Subject: [R-sig-Geo] Include a Graphic Scale in a Map
Message-ID: <CADiqS84Jf0TQU4Z5+ifHTs9v-f6QqfNjnXnhOdbQgCS9nz-y7g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120515/83320e65/attachment-0001.pl>

From jmolina9 at jhu.edu  Tue May 15 17:37:59 2012
From: jmolina9 at jhu.edu (Jose M Molina)
Date: Tue, 15 May 2012 11:37:59 -0400
Subject: [R-sig-Geo] Include a Graphic Scale in a Map
In-Reply-To: <CADiqS84Jf0TQU4Z5+ifHTs9v-f6QqfNjnXnhOdbQgCS9nz-y7g@mail.gmail.com>
References: <CADiqS84Jf0TQU4Z5+ifHTs9v-f6QqfNjnXnhOdbQgCS9nz-y7g@mail.gmail.com>
Message-ID: <4FB27857.6080902@jhu.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120515/76b848aa/attachment.pl>

From gianni.lavaredo at gmail.com  Tue May 15 20:09:01 2012
From: gianni.lavaredo at gmail.com (gianni lavaredo)
Date: Tue, 15 May 2012 20:09:01 +0200
Subject: [R-sig-Geo] reading a large TXT file and save in chunk
Message-ID: <CAJ6JbR94WZb0jWUgOjRWCUckL_nsenpsoveSbKU88SqoeinCJw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120515/7c55f1af/attachment.pl>

From raul.jimenez.rosenberg at gmail.com  Tue May 15 20:32:03 2012
From: raul.jimenez.rosenberg at gmail.com (=?ISO-8859-1?Q?Ra=FAl_Jim=E9nez_Rosenberg?=)
Date: Tue, 15 May 2012 13:32:03 -0500
Subject: [R-sig-Geo] pattern simulation in R
In-Reply-To: <C1524BE4BF45454293B8DF38FB9B5ECAD31496@MS-EX1VKS.erdc.dren.mil>
References: <C1524BE4BF45454293B8DF38FB9B5ECAD31496@MS-EX1VKS.erdc.dren.mil>
Message-ID: <CAE9g_rFjMR9VQGYfWi44xfaeWxX2k5hpDoe4K8FN7SGy9HaOvA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120515/0e07f441/attachment.pl>

From dbebber at earthwatch.org.uk  Tue May 15 21:55:28 2012
From: dbebber at earthwatch.org.uk (Dan Bebber)
Date: Tue, 15 May 2012 19:55:28 +0000
Subject: [R-sig-Geo] Spatial autocorrelation on a sphere
Message-ID: <072A17AB8F352A418FEE8CE1C1D4763B238D1AB1@EXCHANGE.earthwatchewe.lan>

In the case where data are sampled on a sphere (e.g. the Earth) and the spatial locations are denoted by latitude and longitude, is there a way of generating a spatial autocorrelation structure that can derive Euclidean distances from these coordinates?

I imagine that corSpher(form = ~ latitude + longitude, nugget = TRUE) would work over short distances, but would deteriorate as distance increased.

One potential solution might be to derive distances from the spDistsN1 function in package sp, or the rdist.earth function in package fields, or the distm(x, y, fun=distHaversine) in package geosphere, and somehow to supply these to corSpher.

Very grateful for any suggestions or comments.

Dan Bebber


From seanpor at acm.org  Tue May 15 22:15:03 2012
From: seanpor at acm.org (Sean O'Riordain)
Date: Tue, 15 May 2012 21:15:03 +0100
Subject: [R-sig-Geo] reading a large TXT file and save in chunk
In-Reply-To: <CAJ6JbR94WZb0jWUgOjRWCUckL_nsenpsoveSbKU88SqoeinCJw@mail.gmail.com>
References: <CAJ6JbR94WZb0jWUgOjRWCUckL_nsenpsoveSbKU88SqoeinCJw@mail.gmail.com>
Message-ID: <CA+MmmTJa8FCidgrFuYTXsFsNzhxJuU-xMvPWDvKM+p+SM7ewfQ@mail.gmail.com>

Hi Gianni,
You don't say what you are doing with the data, and it doesn't appear
from here to be very 'geo' :-)

if you are using read.table() then there is the nrows=1000000 option -
followed by write.table() in a loop etc...

You could aways says readLines('blah.txt', n=1000000) followed by
writeLines() in a loop...

Outside of R, if you are on linux etc, then there is the "split -l
1000000" command.

cheers,
Sean


On 15 May 2012 19:09, gianni lavaredo <gianni.lavaredo at gmail.com> wrote:
> Dear Researchers,
>
> I am looking for a post or function to reading a txt file of 800 Mb of
> 20,332,138 rows and split in sevarl chunk that each contain the same number
> of points (i.e. each file of 1,000,000 except for the last one)
>
>
> do you know any link or suggestions?
>
> Thanks in Advance
> Gianni
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From edzer.pebesma at uni-muenster.de  Tue May 15 22:33:11 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 15 May 2012 22:33:11 +0200
Subject: [R-sig-Geo] Spatial autocorrelation on a sphere
In-Reply-To: <072A17AB8F352A418FEE8CE1C1D4763B238D1AB1@EXCHANGE.earthwatchewe.lan>
References: <072A17AB8F352A418FEE8CE1C1D4763B238D1AB1@EXCHANGE.earthwatchewe.lan>
Message-ID: <4FB2BD87.6050902@uni-muenster.de>

Assuming this is currently not possible, I would try modify nlme::dist
to accept a spherical distance measure option, and have it call
sp::spDists; corSpher has a metric parameter.

On 05/15/2012 09:55 PM, Dan Bebber wrote:
> In the case where data are sampled on a sphere (e.g. the Earth) and the spatial locations are denoted by latitude and longitude, is there a way of generating a spatial autocorrelation structure that can derive Euclidean distances from these coordinates?
> 
> I imagine that corSpher(form = ~ latitude + longitude, nugget = TRUE) would work over short distances, but would deteriorate as distance increased.
> 
> One potential solution might be to derive distances from the spDistsN1 function in package sp, or the rdist.earth function in package fields, or the distm(x, y, fun=distHaversine) in package geosphere, and somehow to supply these to corSpher.
> 
> Very grateful for any suggestions or comments.
> 
> Dan Bebber
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From r.hijmans at gmail.com  Wed May 16 00:09:58 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 15 May 2012 15:09:58 -0700
Subject: [R-sig-Geo] reading a large TXT file and save in chunk
In-Reply-To: <CA+MmmTJa8FCidgrFuYTXsFsNzhxJuU-xMvPWDvKM+p+SM7ewfQ@mail.gmail.com>
References: <CAJ6JbR94WZb0jWUgOjRWCUckL_nsenpsoveSbKU88SqoeinCJw@mail.gmail.com>
	<CA+MmmTJa8FCidgrFuYTXsFsNzhxJuU-xMvPWDvKM+p+SM7ewfQ@mail.gmail.com>
Message-ID: <CANtt_hyccop+N-ZPNu1C=6eKhPHxtJZ3jx7EBf1ok9QacjcwUA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120515/af4f6fad/attachment.pl>

From tghoward at gw.dec.state.ny.us  Wed May 16 18:58:12 2012
From: tghoward at gw.dec.state.ny.us (Tim Howard)
Date: Wed, 16 May 2012 12:58:12 -0400
Subject: [R-sig-Geo] raster package options maxmemory and chunksize
Message-ID: <4FB3A464020000D50005A52B@gwsmtp.dec.state.ny.us>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120516/9b289066/attachment.pl>

From afischbach at usgs.gov  Thu May 17 00:56:43 2012
From: afischbach at usgs.gov (Anthony Fischbach)
Date: Wed, 16 May 2012 15:56:43 -0700 (PDT)
Subject: [R-sig-Geo] Calculating area of region with a raster
In-Reply-To: <1337180145158-7561970.post@n2.nabble.com>
References: <1337180145158-7561970.post@n2.nabble.com>
Message-ID: <1337209003714-7562866.post@n2.nabble.com>

Rhys,
using the NASA special sensor microwave imagery sea ice data set with its
constant area pixel 
(PixelArea = 25x25 ## in km) geometry I was able to solve this problem by
creating a raster with pixel values = 1 for pixels with ice and NA for
pixels without ice then I summed the values and multiplied by the PixelArea.
sum(values(raster.Ice), na.rm=T)* PixelArea
hth-

-----
Tony Fischbach, Wildlife Biologist
Walrus Research Program
Alaska Science Center
U.S. Geological Survey
4210 University Drive
Anchorage, AK 99508-4650

AFischbach at usgs.gov
http://alaska.usgs.gov/science/biology/walrus
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/Calculating-area-of-region-with-a-raster-tp7561970p7562866.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From adamhsparks at gmail.com  Thu May 17 04:54:56 2012
From: adamhsparks at gmail.com (Adam Sparks)
Date: Thu, 17 May 2012 10:54:56 +0800
Subject: [R-sig-Geo] Adding additional items to plot
Message-ID: <CAJmQPwHJw+FSnrVxrs6MqmAFrvvCrbrcK8K0tO173YBNumMQPA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120517/57b34dc3/attachment.pl>

From arthi.venkat at wipro.com  Thu May 17 06:32:45 2012
From: arthi.venkat at wipro.com (arthi.venkat at wipro.com)
Date: Thu, 17 May 2012 04:32:45 +0000
Subject: [R-sig-Geo] Learning patterns from temporal / spatial data
Message-ID: <33C03AD12DD22546B1E3301242E861E312C7A7C5@BLR-SJP-MBX-6.wipro.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120517/b6434d0c/attachment.pl>

From HodgessE at uhd.edu  Thu May 17 06:47:10 2012
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Wed, 16 May 2012 23:47:10 -0500
Subject: [R-sig-Geo] converting from UTM to Decimal degrees
Message-ID: <586A4828D7AAA04CA9B258C50A28DA200BF59228@BALI.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120516/4a873556/attachment.pl>

From mdsumner at gmail.com  Thu May 17 07:15:47 2012
From: mdsumner at gmail.com (Michael Sumner)
Date: Thu, 17 May 2012 15:15:47 +1000
Subject: [R-sig-Geo] converting from UTM to Decimal degrees
In-Reply-To: <586A4828D7AAA04CA9B258C50A28DA200BF59228@BALI.uhd.campus>
References: <586A4828D7AAA04CA9B258C50A28DA200BF59228@BALI.uhd.campus>
Message-ID: <CAAcGz9_Sy5DNZayMQGHXgjFJXBHdS+2N_XcnOzUjgeihuHP1aQ@mail.gmail.com>

See functions ?project and ?spTransform in the rgdal package. The
former is simpler but is only for transforming  a matrix of
coordinates from or to longitude / latitude, and no datum
transformation is possible. The latter can transform Spatial* objects
arbitrarily from or or to any PROJ.4 coordinate system and includes
datum transformations.


On Thu, May 17, 2012 at 2:47 PM, Hodgess, Erin <HodgessE at uhd.edu> wrote:
> Dear R Sig Geo People:
>
> Is there a function to convert UTM coordinates to Decimal degrees, please? ?This is just for a few points; nothing big.
>
> I know that this is a relatively easy one, but thought I'd check before I wrote up something.
>
> Thanks,
> Erin
>
>
>
> Erin M. Hodgess, PhD
> Associate Professor
> Department of Computer and Mathematical Sciences
> University of Houston - Downtown
> mailto: hodgesse at uhd.edu
>
>
> ? ? ? ?[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo



-- 
Michael Sumner
Institute for Marine and Antarctic Studies, University of Tasmania
Hobart, Australia
e-mail: mdsumner at gmail.com


From HodgessE at uhd.edu  Thu May 17 07:18:20 2012
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Thu, 17 May 2012 00:18:20 -0500
Subject: [R-sig-Geo] converting from UTM to Decimal degrees
References: <586A4828D7AAA04CA9B258C50A28DA200BF59228@BALI.uhd.campus>
	<CAAcGz9_Sy5DNZayMQGHXgjFJXBHdS+2N_XcnOzUjgeihuHP1aQ@mail.gmail.com>
Message-ID: <586A4828D7AAA04CA9B258C50A28DA200BF59229@BALI.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120517/b1d7bc38/attachment.pl>

From HodgessE at uhd.edu  Thu May 17 08:02:10 2012
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Thu, 17 May 2012 01:02:10 -0500
Subject: [R-sig-Geo] trouble with spTransform
Message-ID: <586A4828D7AAA04CA9B258C50A28DA200BF5922A@BALI.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120517/e7c7cc59/attachment.pl>

From Roger.Bivand at nhh.no  Thu May 17 09:15:26 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 17 May 2012 09:15:26 +0200 (CEST)
Subject: [R-sig-Geo] trouble with spTransform
In-Reply-To: <586A4828D7AAA04CA9B258C50A28DA200BF5922A@BALI.uhd.campus>
References: <586A4828D7AAA04CA9B258C50A28DA200BF5922A@BALI.uhd.campus>
Message-ID: <alpine.LRH.2.02.1205170902530.28166@reclus.nhh.no>

On Thu, 17 May 2012, Hodgess, Erin wrote:

> Hello again.
>
> I'm having a little bit of trouble with spTransform (probably I'm doing it wrong), but here is what I'm doing:
>
>
> Original data frame with UTM locations near Phuket, Thailand:
>> test1.df
>  Loc    east   north
> 1   a 748.168 602.861
> 2   b 754.302 615.609
>> proj1 <- CRS("+proj=utm +zone=47N")

Your points are 750m east and 600m north of the given projection origin. 
If you meant km, set the units by adding +units=km to the proj4string. 
However, this gives me:

          coordinates Loc
1  (101.24, 5.44994)   a
2 (101.295, 5.56496)   b

which is not on Phuket, so something else is wrong here. Do you know 
definitely that the input coordinates are UTM zone 47? Reversing the 
eastings and northings gets a bit closer:

> proj1 <- CRS("+proj=utm +zone=47N +units=km")
> coordinates(test1.df) <- c("north", "east")
> proj4string(test1.df) <- proj1
> spTransform(test1.df, CRS("+proj=longlat +datum=WGS84"))
          coordinates Loc
1  (99.9308, 6.7677)   a
2 (100.046, 6.82295)   b

but isn't there yet (reversed coordinate order does happen). What was the 
source of the coordinates?

Roger

>> coordinates(test1.df) <- c("east","north")
>> proj4string(test1.df) <- proj1
>
> Set up a spatial data frame
>> test1.df
>         coordinates Loc
> 1 (748.168, 602.861)   a
> 2 (754.302, 615.609)   b
>> spTransform(test1.df, CRS("+proj=longlat +datum=WGS84"))
>           coordinates Loc
> 1 (94.518, 0.00543748)   a
> 2 (94.518, 0.00555246)   b
>>
>
> Now the answers should be about 8 degrees north and 98 degrees East.
>
> Any suggestions would be most appreciated.
>
> Sincerely,
> Erin
>
>
> Erin M. Hodgess, PhD
> Associate Professor
> Department of Computer and Mathematical Sciences
> University of Houston - Downtown
> mailto: hodgesse at uhd.edu
>
>
> 	[[alternative HTML version deleted]]
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From gab.cozzi at gmail.com  Thu May 17 10:05:47 2012
From: gab.cozzi at gmail.com (Gabriele Cozzi)
Date: Thu, 17 May 2012 10:05:47 +0200
Subject: [R-sig-Geo] rgdal package for mac
In-Reply-To: <alpine.LRH.2.02.1205170902530.28166@reclus.nhh.no>
References: <586A4828D7AAA04CA9B258C50A28DA200BF5922A@BALI.uhd.campus>
	<alpine.LRH.2.02.1205170902530.28166@reclus.nhh.no>
Message-ID: <4FB4B15B.80804@gmail.com>

Dear all,

I am having issues installing the package "rgdal" on a Mac OS X (Lion).

# install.packages("rgdal")

actually says that there is no available package for R 2.15.0 (the 
version I am using at the moment). Yet I can successfully load the rgdal 
package on my old PC (also running R 2.15.0). Does it means rgdal is not 
implemented for mac? I find it hard to believe.

Any help would be appreciated.

Best,
Gabriele

============================================================

Gabriele Cozzi

Institute of Evolutionary Biology and Environmental Studies
Zurich University
Winterthurerstr. 190
8057 Zurich - Switzerland
E-mail: gabriele.cozzi at uzh.ch
Phone: ++41(0)44 6356116
Fax: ++41(0)44 6355711
http://www.ieu.uzh.ch
http://african-carnivores.com

Botswana Predator Conservation Trust
Private Bag 13
Maun - Botswana
E-mail: gab.cozzi at gmail.com
Mobile: +26774259312
http://www.bpctrust.org


On 17.05.2012 09:15, Roger Bivand wrote:
> On Thu, 17 May 2012, Hodgess, Erin wrote:
>
>> Hello again.
>>
>> I'm having a little bit of trouble with spTransform (probably I'm 
>> doing it wrong), but here is what I'm doing:
>>
>>
>> Original data frame with UTM locations near Phuket, Thailand:
>>> test1.df
>>  Loc    east   north
>> 1   a 748.168 602.861
>> 2   b 754.302 615.609
>>> proj1 <- CRS("+proj=utm +zone=47N")
>
> Your points are 750m east and 600m north of the given projection 
> origin. If you meant km, set the units by adding +units=km to the 
> proj4string. However, this gives me:
>
>          coordinates Loc
> 1  (101.24, 5.44994)   a
> 2 (101.295, 5.56496)   b
>
> which is not on Phuket, so something else is wrong here. Do you know 
> definitely that the input coordinates are UTM zone 47? Reversing the 
> eastings and northings gets a bit closer:
>
>> proj1 <- CRS("+proj=utm +zone=47N +units=km")
>> coordinates(test1.df) <- c("north", "east")
>> proj4string(test1.df) <- proj1
>> spTransform(test1.df, CRS("+proj=longlat +datum=WGS84"))
>          coordinates Loc
> 1  (99.9308, 6.7677)   a
> 2 (100.046, 6.82295)   b
>
> but isn't there yet (reversed coordinate order does happen). What was 
> the source of the coordinates?
>
> Roger
>
>>> coordinates(test1.df) <- c("east","north")
>>> proj4string(test1.df) <- proj1
>>
>> Set up a spatial data frame
>>> test1.df
>>         coordinates Loc
>> 1 (748.168, 602.861)   a
>> 2 (754.302, 615.609)   b
>>> spTransform(test1.df, CRS("+proj=longlat +datum=WGS84"))
>>           coordinates Loc
>> 1 (94.518, 0.00543748)   a
>> 2 (94.518, 0.00555246)   b
>>>
>>
>> Now the answers should be about 8 degrees north and 98 degrees East.
>>
>> Any suggestions would be most appreciated.
>>
>> Sincerely,
>> Erin
>>
>>
>> Erin M. Hodgess, PhD
>> Associate Professor
>> Department of Computer and Mathematical Sciences
>> University of Houston - Downtown
>> mailto: hodgesse at uhd.edu
>>
>>
>>     [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>


From Roger.Bivand at nhh.no  Thu May 17 10:06:20 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 17 May 2012 10:06:20 +0200 (CEST)
Subject: [R-sig-Geo] rgdal package for mac
In-Reply-To: <4FB4B15B.80804@gmail.com>
References: <586A4828D7AAA04CA9B258C50A28DA200BF5922A@BALI.uhd.campus>
	<alpine.LRH.2.02.1205170902530.28166@reclus.nhh.no>
	<4FB4B15B.80804@gmail.com>
Message-ID: <alpine.LRH.2.02.1205171002470.28166@reclus.nhh.no>

On Thu, 17 May 2012, Gabriele Cozzi wrote:

> Dear all,
>
> I am having issues installing the package "rgdal" on a Mac OS X (Lion).
>
> # install.packages("rgdal")
>
> actually says that there is no available package for R 2.15.0 (the version I 
> am using at the moment). Yet I can successfully load the rgdal package on my 
> old PC (also running R 2.15.0). Does it means rgdal is not implemented for 
> mac? I find it hard to believe.

Did you read the CRAN package page for rgdal? If you did, did you do what 
it said:

setRepositories(ind=1:2)
install.packages('rgdal')

to install from CRAN Extras?

Don't jump to conclusions, do try to use the resources available to reach 
well grounded solutions.

We still hope that rgdal and rgeos will be available as regular CRAN 
packages for OSX, but this seems to have stranded (again).

Roger

>
> Any help would be appreciated.
>
> Best,
> Gabriele
>
> ============================================================
>
> Gabriele Cozzi
>
> Institute of Evolutionary Biology and Environmental Studies
> Zurich University
> Winterthurerstr. 190
> 8057 Zurich - Switzerland
> E-mail: gabriele.cozzi at uzh.ch
> Phone: ++41(0)44 6356116
> Fax: ++41(0)44 6355711
> http://www.ieu.uzh.ch
> http://african-carnivores.com
>
> Botswana Predator Conservation Trust
> Private Bag 13
> Maun - Botswana
> E-mail: gab.cozzi at gmail.com
> Mobile: +26774259312
> http://www.bpctrust.org
>
>
> On 17.05.2012 09:15, Roger Bivand wrote:
>> On Thu, 17 May 2012, Hodgess, Erin wrote:
>> 
>>> Hello again.
>>> 
>>> I'm having a little bit of trouble with spTransform (probably I'm doing it 
>>> wrong), but here is what I'm doing:
>>> 
>>> 
>>> Original data frame with UTM locations near Phuket, Thailand:
>>>> test1.df
>>>  Loc    east   north
>>> 1   a 748.168 602.861
>>> 2   b 754.302 615.609
>>>> proj1 <- CRS("+proj=utm +zone=47N")
>> 
>> Your points are 750m east and 600m north of the given projection origin. If 
>> you meant km, set the units by adding +units=km to the proj4string. 
>> However, this gives me:
>>
>>          coordinates Loc
>> 1  (101.24, 5.44994)   a
>> 2 (101.295, 5.56496)   b
>> 
>> which is not on Phuket, so something else is wrong here. Do you know 
>> definitely that the input coordinates are UTM zone 47? Reversing the 
>> eastings and northings gets a bit closer:
>> 
>>> proj1 <- CRS("+proj=utm +zone=47N +units=km")
>>> coordinates(test1.df) <- c("north", "east")
>>> proj4string(test1.df) <- proj1
>>> spTransform(test1.df, CRS("+proj=longlat +datum=WGS84"))
>>          coordinates Loc
>> 1  (99.9308, 6.7677)   a
>> 2 (100.046, 6.82295)   b
>> 
>> but isn't there yet (reversed coordinate order does happen). What was the 
>> source of the coordinates?
>> 
>> Roger
>> 
>>>> coordinates(test1.df) <- c("east","north")
>>>> proj4string(test1.df) <- proj1
>>> 
>>> Set up a spatial data frame
>>>> test1.df
>>>         coordinates Loc
>>> 1 (748.168, 602.861)   a
>>> 2 (754.302, 615.609)   b
>>>> spTransform(test1.df, CRS("+proj=longlat +datum=WGS84"))
>>>           coordinates Loc
>>> 1 (94.518, 0.00543748)   a
>>> 2 (94.518, 0.00555246)   b
>>>> 
>>> 
>>> Now the answers should be about 8 degrees north and 98 degrees East.
>>> 
>>> Any suggestions would be most appreciated.
>>> 
>>> Sincerely,
>>> Erin
>>> 
>>> 
>>> Erin M. Hodgess, PhD
>>> Associate Professor
>>> Department of Computer and Mathematical Sciences
>>> University of Houston - Downtown
>>> mailto: hodgesse at uhd.edu
>>> 
>>>
>>>     [[alternative HTML version deleted]]
>>> 
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>> 
>> 
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From gab.cozzi at gmail.com  Thu May 17 10:33:21 2012
From: gab.cozzi at gmail.com (Gabriele Cozzi)
Date: Thu, 17 May 2012 10:33:21 +0200
Subject: [R-sig-Geo] rgdal package for mac
In-Reply-To: <alpine.LRH.2.02.1205171002470.28166@reclus.nhh.no>
References: <586A4828D7AAA04CA9B258C50A28DA200BF5922A@BALI.uhd.campus>
	<alpine.LRH.2.02.1205170902530.28166@reclus.nhh.no>
	<4FB4B15B.80804@gmail.com>
	<alpine.LRH.2.02.1205171002470.28166@reclus.nhh.no>
Message-ID: <4FB4B7D1.4070506@gmail.com>

Hi Roger,
sorry for troubling and thanks for the very quick answer.

I did follow the guidelines from the CRAN page
# setRepositories(ind=1:2)
# install.packages('rgdal'),
but it did not work.

I was successful, however (with the same to lines of code), after 
shutting down and restating R...

============================================================

Gabriele Cozzi

Institute of Evolutionary Biology and Environmental Studies
Zurich University
Winterthurerstr. 190
8057 Zurich - Switzerland
E-mail: gabriele.cozzi at uzh.ch
Phone: ++41(0)44 6356116
Fax: ++41(0)44 6355711
http://www.ieu.uzh.ch
http://african-carnivores.com

Botswana Predator Conservation Trust
Private Bag 13
Maun - Botswana
E-mail: gab.cozzi at gmail.com
Mobile: +26774259312
http://www.bpctrust.org


On 17.05.2012 10:06, Roger Bivand wrote:
> On Thu, 17 May 2012, Gabriele Cozzi wrote:
>
>> Dear all,
>>
>> I am having issues installing the package "rgdal" on a Mac OS X (Lion).
>>
>> # install.packages("rgdal")
>>
>> actually says that there is no available package for R 2.15.0 (the 
>> version I am using at the moment). Yet I can successfully load the 
>> rgdal package on my old PC (also running R 2.15.0). Does it means 
>> rgdal is not implemented for mac? I find it hard to believe.
>
> Did you read the CRAN package page for rgdal? If you did, did you do 
> what it said:
>
> setRepositories(ind=1:2)
> install.packages('rgdal')
>
> to install from CRAN Extras?
>
> Don't jump to conclusions, do try to use the resources available to 
> reach well grounded solutions.
>
> We still hope that rgdal and rgeos will be available as regular CRAN 
> packages for OSX, but this seems to have stranded (again).
>
> Roger
>
>>
>> Any help would be appreciated.
>>
>> Best,
>> Gabriele
>>
>> ============================================================
>>
>> Gabriele Cozzi
>>
>> Institute of Evolutionary Biology and Environmental Studies
>> Zurich University
>> Winterthurerstr. 190
>> 8057 Zurich - Switzerland
>> E-mail: gabriele.cozzi at uzh.ch
>> Phone: ++41(0)44 6356116
>> Fax: ++41(0)44 6355711
>> http://www.ieu.uzh.ch
>> http://african-carnivores.com
>>
>> Botswana Predator Conservation Trust
>> Private Bag 13
>> Maun - Botswana
>> E-mail: gab.cozzi at gmail.com
>> Mobile: +26774259312
>> http://www.bpctrust.org
>>
>>
>> On 17.05.2012 09:15, Roger Bivand wrote:
>>> On Thu, 17 May 2012, Hodgess, Erin wrote:
>>>
>>>> Hello again.
>>>>
>>>> I'm having a little bit of trouble with spTransform (probably I'm 
>>>> doing it wrong), but here is what I'm doing:
>>>>
>>>>
>>>> Original data frame with UTM locations near Phuket, Thailand:
>>>>> test1.df
>>>>  Loc    east   north
>>>> 1   a 748.168 602.861
>>>> 2   b 754.302 615.609
>>>>> proj1 <- CRS("+proj=utm +zone=47N")
>>>
>>> Your points are 750m east and 600m north of the given projection 
>>> origin. If you meant km, set the units by adding +units=km to the 
>>> proj4string. However, this gives me:
>>>
>>>          coordinates Loc
>>> 1  (101.24, 5.44994)   a
>>> 2 (101.295, 5.56496)   b
>>>
>>> which is not on Phuket, so something else is wrong here. Do you know 
>>> definitely that the input coordinates are UTM zone 47? Reversing the 
>>> eastings and northings gets a bit closer:
>>>
>>>> proj1 <- CRS("+proj=utm +zone=47N +units=km")
>>>> coordinates(test1.df) <- c("north", "east")
>>>> proj4string(test1.df) <- proj1
>>>> spTransform(test1.df, CRS("+proj=longlat +datum=WGS84"))
>>>          coordinates Loc
>>> 1  (99.9308, 6.7677)   a
>>> 2 (100.046, 6.82295)   b
>>>
>>> but isn't there yet (reversed coordinate order does happen). What 
>>> was the source of the coordinates?
>>>
>>> Roger
>>>
>>>>> coordinates(test1.df) <- c("east","north")
>>>>> proj4string(test1.df) <- proj1
>>>>
>>>> Set up a spatial data frame
>>>>> test1.df
>>>>         coordinates Loc
>>>> 1 (748.168, 602.861)   a
>>>> 2 (754.302, 615.609)   b
>>>>> spTransform(test1.df, CRS("+proj=longlat +datum=WGS84"))
>>>>           coordinates Loc
>>>> 1 (94.518, 0.00543748)   a
>>>> 2 (94.518, 0.00555246)   b
>>>>>
>>>>
>>>> Now the answers should be about 8 degrees north and 98 degrees East.
>>>>
>>>> Any suggestions would be most appreciated.
>>>>
>>>> Sincerely,
>>>> Erin
>>>>
>>>>
>>>> Erin M. Hodgess, PhD
>>>> Associate Professor
>>>> Department of Computer and Mathematical Sciences
>>>> University of Houston - Downtown
>>>> mailto: hodgesse at uhd.edu
>>>>
>>>>
>>>>     [[alternative HTML version deleted]]
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>


From b.rowlingson at lancaster.ac.uk  Thu May 17 10:55:03 2012
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Thu, 17 May 2012 09:55:03 +0100
Subject: [R-sig-Geo] Coordinate transformation for directions?
Message-ID: <CANVKczMqW4JBZUS_QALUtrEuP7kGzPN_PzwYHNc4kG=z9ExRZw@mail.gmail.com>

spTransform does a great job of transforming points from one CRS to
another, but what's the best way of transforming directions?

For example, the wind at a point is blowing from the SW in lat-long
coordinates. That would be -3pi/4 radians if you consider lat-long as
a cartesian coordinate system. But suppose you want to work in
Ordnance Survey grid references. These coords are rotated slightly
compared to epsg:4326, and the rotation is different at different
points. Lat-long North is never exactly straight up on OSGrid maps.

 My thinking is to consider a small vector (how small?) from (x,y) to
(x+dx,y+dy) in the required direction in lat-long, then transform
those two points to OSGrid, then compute the angle with the atan2
function.

 Apart from wondering how small the vector needs to be, have I missed
any other subtleties? Has anyone written this already?

 Note these are point-wise directions, not bearings of A from B. Great
circles are not involved!

Barry


From oscar.perpinan at gmail.com  Thu May 17 11:04:26 2012
From: oscar.perpinan at gmail.com (Oscar =?utf-8?B?UGVycGnDscOhbg==?= Lamigueiro)
Date: Thu, 17 May 2012 11:04:26 +0200
Subject: [R-sig-Geo] Adding additional items to plot
In-Reply-To: <CAJmQPwHJw+FSnrVxrs6MqmAFrvvCrbrcK8K0tO173YBNumMQPA@mail.gmail.com>
	(Adam Sparks's message of "Thu, 17 May 2012 10:54:56 +0800")
References: <CAJmQPwHJw+FSnrVxrs6MqmAFrvvCrbrcK8K0tO173YBNumMQPA@mail.gmail.com>
Message-ID: <878vgrrxet.fsf@gmail.com>

Adam Sparks <adamhsparks at gmail.com> writes:

> Dear all,
> I'm attempting to produce some finished product maps using R and have been
> struggling with an issue.
>
> I want to use a hillshade object created from a DEM using the hillShade()
> function as a backdrop for my raster data that I'm presenting.
>
> Behind that I want to use lightsteelblue2 as the color where there is water.
>
> On top of this I want to plot the country outlines for the areas of
> interest.
>
> So in summary I have:
>  the first layer, blue for water
>  the second layer, hillshade DEM
>  the third layer, my raster data I'm presenting
>  the fourth layer, the country outline
>

Hello,

Try this approach using rasterVis and latticeExtra:

library(raster)
library(rasterVis)
library(maptools) ##for readShapeLines
library(latticeExtra)

## Get the data from gadm and data-vis
download.file('http://www.gadm.org/data/shp/ETH_adm.zip', '~/temp/ETH_adm.zip')
unzip('~/temp/ETH_adm.zip', exdir='~/temp')
download.file('http://www.diva-gis.org/data/msk_alt/ETH_msk_alt.zip', '~/temp/ETH_msk_alt.zip')
unzip('~/temp/ETH_msk_alt.zip', exdir='~/temp')
download.file('http://www.diva-gis.org/data/wat/ETH_wat.zip', '~/temp/ETH_wat.zip')
unzip('~/temp/ETH_wat.zip', exdir='~/temp')

## Read the files
proj <- CRS(' +proj=longlat +ellps=WGS84')
ethAdm <- readShapeLines('~/temp/ETH_adm1.shp', proj4string=proj)
ethWat <- readShapeLines('~/temp/ETH_water_lines_dcw.shp', proj4string=proj)
ethAlt <- raster('~/temp/ETH_msk_alt')

## and plot using the "+.trellis" and "layer" functions
## from latticeExtra
levelplot(ethAlt, par.settings=GrTheme) +
  layer(sp.lines(ethWat, col='blue', lwd=0.6)) +
  layer(sp.lines(ethAdm, col='black', lwd=0.7))

Best,

Oscar.

-- 
Oscar Perpi??n Lamigueiro
Dpto. Ingenier?a El?ctrica
EUITI-UPM
URL: http://procomun.wordpress.com
Twitter: @oscarperpinan


From tghoward at gw.dec.state.ny.us  Thu May 17 14:05:32 2012
From: tghoward at gw.dec.state.ny.us (Tim Howard)
Date: Thu, 17 May 2012 08:05:32 -0400
Subject: [R-sig-Geo] raster package options maxmemory and chunksize
Message-ID: <4FB4B14C020000D50005A5E3@gwsmtp.dec.state.ny.us>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120517/e1331bb1/attachment.pl>

From r.hijmans at gmail.com  Thu May 17 21:04:17 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 17 May 2012 12:04:17 -0700
Subject: [R-sig-Geo] Calculating area of region with a raster
In-Reply-To: <1337209003714-7562866.post@n2.nabble.com>
References: <1337180145158-7561970.post@n2.nabble.com>
	<1337209003714-7562866.post@n2.nabble.com>
Message-ID: <CANtt_hyrsKgXJuJaZ0VjB7y2Dvzt5dQfKYJyEeSF4AcKCdqEUg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120517/14184de9/attachment.pl>

From r.hijmans at gmail.com  Thu May 17 21:08:34 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 17 May 2012 12:08:34 -0700
Subject: [R-sig-Geo] Raster getData() problem
In-Reply-To: <CAE9g_rEk7w-YDRae_X30f8XViSYCaZVMWJ2i+-Xwbi_zjgnB=w@mail.gmail.com>
References: <CAE9g_rEk7w-YDRae_X30f8XViSYCaZVMWJ2i+-Xwbi_zjgnB=w@mail.gmail.com>
Message-ID: <CANtt_hwFmjaQcGX5Ph8=eztH3VFGiJ4CPDd4jj+g4nz73dnV6A@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120517/e32e17e8/attachment.pl>

From mzp3769 at gmail.com  Thu May 17 21:45:33 2012
From: mzp3769 at gmail.com (m p)
Date: Thu, 17 May 2012 13:45:33 -0600
Subject: [R-sig-Geo] how to determine varying spatial correlation scale
Message-ID: <CAARDZMVa=r92dr1+yoarwBOg+Kboi_PmADPvh1B1Kg2vvzGJmQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120517/d21473fb/attachment.pl>

From m.hewson at uq.edu.au  Fri May 18 01:04:09 2012
From: m.hewson at uq.edu.au (Michael Hewson)
Date: Thu, 17 May 2012 23:04:09 +0000
Subject: [R-sig-Geo] Plotting cross-correlograms
Message-ID: <4DFD7C68C50FE54A98C0D43A76E08E0801BCA5@uqexmdb6.soe.uq.edu.au>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120517/453b1759/attachment.pl>

From r.hijmans at gmail.com  Fri May 18 03:50:58 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 17 May 2012 18:50:58 -0700
Subject: [R-sig-Geo] raster package options maxmemory and chunksize
In-Reply-To: <4FB4B14C020000D50005A5E3@gwsmtp.dec.state.ny.us>
References: <4FB4B14C020000D50005A5E3@gwsmtp.dec.state.ny.us>
Message-ID: <CANtt_hzHgJiZm=L-fMuKyy7L3hK3z-X+hqn8NRpzqmdihp-FQA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120517/2ea123c8/attachment.pl>

From tghoward at gw.dec.state.ny.us  Fri May 18 15:13:57 2012
From: tghoward at gw.dec.state.ny.us (Tim Howard)
Date: Fri, 18 May 2012 09:13:57 -0400
Subject: [R-sig-Geo] raster package options maxmemory and chunksize
In-Reply-To: <CANtt_hzHgJiZm=L-fMuKyy7L3hK3z-X+hqn8NRpzqmdihp-FQA@mail.gmail.com>
References: <4FB4B14C020000D50005A5E3@gwsmtp.dec.state.ny.us>
	<CANtt_hzHgJiZm=L-fMuKyy7L3hK3z-X+hqn8NRpzqmdihp-FQA@mail.gmail.com>
Message-ID: <4FB612D5020000D50005A78E@gwsmtp.dec.state.ny.us>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120518/bf04e262/attachment.pl>

From pl at mpifg.de  Fri May 18 16:18:33 2012
From: pl at mpifg.de (de Larminat, Pierre)
Date: Fri, 18 May 2012 16:18:33 +0200
Subject: [R-sig-Geo]  rgdal package for mac
In-Reply-To: <alpine.LRH.2.02.1205181539070.2590@reclus.nhh.no>
References: <mailman.7478.1337347734.4540.r-sig-geo@r-project.org>
	<5375E424-EB7F-439D-B52F-95D347678DCF@mpifg.de>
	<alpine.LRH.2.02.1205181539070.2590@reclus.nhh.no>
Message-ID: <85B08C10-B438-41AF-9900-417C15A974ED@mpifg.de>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120518/cfcdb2b9/attachment.pl>

From adiez at uv.es  Fri May 18 16:34:20 2012
From: adiez at uv.es (Agustin Diez Castillo)
Date: Fri, 18 May 2012 16:34:20 +0200
Subject: [R-sig-Geo] rgdal package for mac
In-Reply-To: <85B08C10-B438-41AF-9900-417C15A974ED@mpifg.de>
References: <mailman.7478.1337347734.4540.r-sig-geo@r-project.org>
	<5375E424-EB7F-439D-B52F-95D347678DCF@mpifg.de>
	<alpine.LRH.2.02.1205181539070.2590@reclus.nhh.no>
	<85B08C10-B438-41AF-9900-417C15A974ED@mpifg.de>
Message-ID: <09A14528-04BE-4627-B67B-B3B04C7125E0@uv.es>

Kyngchaos version can be installed for 2.15 [1] and 2.14 [2]
[1] http://www.kyngchaos.com/files/software/frameworks/rgdal-0.7.8-2.zip
[2] http://www.kyngchaos.com/files/software/frameworks/rgdal-0.7.8-1.zip



El May 18, 2012, a les 4:18 PM, de Larminat, Pierre va escriure:

> Hello,
> 
> I have the same problem than:
> [R-sig-Geo] rgdal package for mac
> Gabriele Cozzi gab.cozzi at gmail.com<http://gmail.com>
> Thu May 17 10:33:21 CEST 2012
> 
> I have already done:
> setRepositories(ind=1:2)
> install.packages("rgdal")
> as said on the CRAN page for rgdal.
> 
> I have restarted the computer and R.
> When I entered the lines again, I received the same message that I had received before:
> 
>> setRepositories(ind=1:2)
>> install.packages("rgdal")
> --- SVP s?lectionner un miroir CRAN pour cette session ---
> essai de l'URL 'http://www.stats.ox.ac.uk/pub/RWin/bin/macosx/leopard/contrib/2.15/rgdal_0.7-8.tgz'
> Content type 'application/x-gzip' length 13810017 bytes (13.2 Mb)
> URL ouverte
> ==================================================
> downloaded 13.2 Mb
> 
> 
> Les packages binaires t?l?charg?s sont dans
> /var/folders/zT/zTnmGA9q2RaOuE+F76E3E++++TI/-Tmp-//RtmpKnHXly/downloaded_packages
>> library(rgdal)
> Le chargement a n?cessit? le package : sp
> Error in dyn.load(file, DLLpath = DLLpath, ...) :
> impossible de charger l'objet partag? '/Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so':
> dlopen(/Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so, 6): Library not loaded: /usr/lib/libcurl.4.dylib
> Referenced from: /Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so
> Reason: Incompatible library version: rgdal.so requires version 7.0.0 or later, but libcurl.4.dylib provides version 6.0.0
> Erreur : le chargement du package / espace de noms a ?chou? pour ?rgdal?
>> 
> 
> Does anyone know how to solve this problem?
> Thank you very much,
> Pierre de Larminat.
> 
> 
> 
> Le 18 mai 2012 ? 15:45, Roger Bivand a ?crit :
> 
> On Fri, 18 May 2012, de Larminat, Pierre wrote:
> 
> Dear Prof. Bivand,
> 
> As I have trouble installing rgdal on my Macbook, I searched on some
> blog-posts by R-bloggers, and I tried to look for help on r-sig-geo. It
> seems that my message doesn't come through. Can you help me please? In
> any case, thank you for your efforts in developing rgdal. I have seen
> what others do with it. It is fascinating. Best regards, Pierre de
> Larminat.
> 
> You are subscribed as larminat at mpifg.de<mailto:larminat at mpifg.de>, and must post from that address.
> 
> Never search blogs, they are almost always misleading, and nobody takes
> responsibility for keeping the advice given up to date. Did you read the
> CRAN page for rgdal - it does explain how to install rgdal on OSX. You
> might also have searched the list archives (this question was answered
> yesterday), or googled "list:r-sig-geo rgdal Mac".
> 
> Roger Bivand
> 
> list admin.
> 
> 
> 
> - - -
> Pierre de Larminat
> Visiting doctoral fellow
> Max Planck Institute for the Study of Societies
> Paulstrasse 3, D-50676 K?ln, Germany
> office: +49.221.2767.222
> mobile: +49.152.521.704.83
> e-mail: larminat at mpifg.de<mailto:larminat at mpifg.de>
> 
> D?but du message r?exp?di? :
> 
> De : "r-sig-geo-owner at r-project.org<mailto:r-sig-geo-owner at r-project.org>" <r-sig-geo-owner at r-project.org<mailto:r-sig-geo-owner at r-project.org>>
> Date : 18 mai 2012 15:28:54 HAEC
> ? : "de Larminat, Pierre" <pl at mpifg.de<mailto:pl at mpifg.de>>
> Objet : Installing rgdal on mac
> 
> You are not allowed to post to this mailing list, and your message has
> been automatically rejected.  If you think that your messages are
> being rejected in error, contact the mailing list owner at
> r-sig-geo-owner at r-project.org<mailto:r-sig-geo-owner at r-project.org>.
> 
> 
> De : "de Larminat, Pierre" <pl at mpifg.de<mailto:pl at mpifg.de>>
> Date : 18 mai 2012 15:28:28 HAEC
> ? : "r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>" <r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>>
> Objet : Installing rgdal on mac
> 
> 
> Hello,
> 
> Working on MacOS X, I have trouble installing rgdal.
> 
> I am sorry to post about this problem, since others have probably asked the question earlier on this list, but there seem to be no search tool to look for the previous posts on the list.
> 
> Below is the R-output to my previous installation trials:
> 
> install.packages("rgdal")
> Message d'avis :
> package ?rgdal? is not available (for R version 2.15.0)
> setRepositories(ind=1:2)
> install.packages("rgdal")
> essai de l'URL 'http://www.stats.ox.ac.uk/pub/RWin/bin/macosx/leopard/contrib/2.15/rgdal_0.7-8.tgz'
> Content type 'application/x-gzip' length 13810017 bytes (13.2 Mb)
> URL ouverte
> ==================================================
> downloaded 13.2 Mb
> 
> 
> Les packages binaires t?l?charg?s sont dans
> /var/folders/zT/zTnmGA9q2RaOuE+F76E3E++++TI/-Tmp-//Rtmpu8X57c/downloaded_packages
> library(rgdal)
> Error in dyn.load(file, DLLpath = DLLpath, ...) :
> impossible de charger l'objet partag? '/Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so':
> dlopen(/Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so, 6): Library not loaded: /usr/lib/libcurl.4.dylib
> Referenced from: /Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so
> Reason: Incompatible library version: rgdal.so requires version 7.0.0 or later, but libcurl.4.dylib provides version 6.0.0
> Erreur : le chargement du package / espace de noms a ?chou? pour ?rgdal?
> 
> 
> Meanwhile, I have installed PROJ 4.8 and GDAL 1.9 Complete from http://www.kyngchaos.com/software:frameworks
> 
> but it doesn't help. When I try again with
> setRepositories(ind=1:2)
> install.packages("rgdal")
> 
> I still get the error message pasted above.
> 
> Can you help me?
> Thank you very much,
> 
> Pierre de Larminat.
> 
> 
> [[alternative HTML version deleted]]
> 
> 
> 
> 
> 
> 
> --
> Roger Bivand
> Department of Economics, NHH Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no<mailto:Roger.Bivand at nhh.no>
> 
> 
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Roger.Bivand at nhh.no  Fri May 18 17:14:24 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 18 May 2012 17:14:24 +0200 (CEST)
Subject: [R-sig-Geo] rgdal package for mac
In-Reply-To: <85B08C10-B438-41AF-9900-417C15A974ED@mpifg.de>
References: <mailman.7478.1337347734.4540.r-sig-geo@r-project.org>
	<5375E424-EB7F-439D-B52F-95D347678DCF@mpifg.de>
	<alpine.LRH.2.02.1205181539070.2590@reclus.nhh.no>
	<85B08C10-B438-41AF-9900-417C15A974ED@mpifg.de>
Message-ID: <alpine.LRH.2.02.1205181712330.2590@reclus.nhh.no>

On Fri, 18 May 2012, de Larminat, Pierre wrote:

> Hello,
>
> I have the same problem than:
> [R-sig-Geo] rgdal package for mac
> Gabriele Cozzi gab.cozzi at gmail.com<http://gmail.com>
> Thu May 17 10:33:21 CEST 2012
>
> I have already done:
> setRepositories(ind=1:2)
> install.packages("rgdal")
> as said on the CRAN page for rgdal.
>
> I have restarted the computer and R.
> When I entered the lines again, I received the same message that I had received before:
>
>> setRepositories(ind=1:2)
>> install.packages("rgdal")
> --- SVP s?lectionner un miroir CRAN pour cette session ---
> essai de l'URL 'http://www.stats.ox.ac.uk/pub/RWin/bin/macosx/leopard/contrib/2.15/rgdal_0.7-8.tgz'
> Content type 'application/x-gzip' length 13810017 bytes (13.2 Mb)
> URL ouverte
> ==================================================
> downloaded 13.2 Mb
>
>
> Les packages binaires t?l?charg?s sont dans
> /var/folders/zT/zTnmGA9q2RaOuE+F76E3E++++TI/-Tmp-//RtmpKnHXly/downloaded_packages
>> library(rgdal)
> Le chargement a n?cessit? le package : sp

This does seem to imply that sp is necessary, doesn't it? Have you 
installed sp? Messages are given to be read, rather than ignored.

Roger

> Error in dyn.load(file, DLLpath = DLLpath, ...) :
>  impossible de charger l'objet partag? '/Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so':
>  dlopen(/Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so, 6): Library not loaded: /usr/lib/libcurl.4.dylib
>  Referenced from: /Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so
>  Reason: Incompatible library version: rgdal.so requires version 7.0.0 or later, but libcurl.4.dylib provides version 6.0.0
> Erreur : le chargement du package / espace de noms a ?chou? pour ?rgdal?
>>
>
> Does anyone know how to solve this problem?
> Thank you very much,
> Pierre de Larminat.
>
>
>
> Le 18 mai 2012 ? 15:45, Roger Bivand a ?crit :
>
> On Fri, 18 May 2012, de Larminat, Pierre wrote:
>
> Dear Prof. Bivand,
>
> As I have trouble installing rgdal on my Macbook, I searched on some
> blog-posts by R-bloggers, and I tried to look for help on r-sig-geo. It
> seems that my message doesn't come through. Can you help me please? In
> any case, thank you for your efforts in developing rgdal. I have seen
> what others do with it. It is fascinating. Best regards, Pierre de
> Larminat.
>
> You are subscribed as larminat at mpifg.de<mailto:larminat at mpifg.de>, and must post from that address.
>
> Never search blogs, they are almost always misleading, and nobody takes
> responsibility for keeping the advice given up to date. Did you read the
> CRAN page for rgdal - it does explain how to install rgdal on OSX. You
> might also have searched the list archives (this question was answered
> yesterday), or googled "list:r-sig-geo rgdal Mac".
>
> Roger Bivand
>
> list admin.
>
>
>
> - - -
> Pierre de Larminat
> Visiting doctoral fellow
> Max Planck Institute for the Study of Societies
> Paulstrasse 3, D-50676 K?ln, Germany
> office: +49.221.2767.222
> mobile: +49.152.521.704.83
> e-mail: larminat at mpifg.de<mailto:larminat at mpifg.de>
>
> D?but du message r?exp?di? :
>
> De : "r-sig-geo-owner at r-project.org<mailto:r-sig-geo-owner at r-project.org>" <r-sig-geo-owner at r-project.org<mailto:r-sig-geo-owner at r-project.org>>
> Date : 18 mai 2012 15:28:54 HAEC
> ? : "de Larminat, Pierre" <pl at mpifg.de<mailto:pl at mpifg.de>>
> Objet : Installing rgdal on mac
>
> You are not allowed to post to this mailing list, and your message has
> been automatically rejected.  If you think that your messages are
> being rejected in error, contact the mailing list owner at
> r-sig-geo-owner at r-project.org<mailto:r-sig-geo-owner at r-project.org>.
>
>
> De : "de Larminat, Pierre" <pl at mpifg.de<mailto:pl at mpifg.de>>
> Date : 18 mai 2012 15:28:28 HAEC
> ? : "r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>" <r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>>
> Objet : Installing rgdal on mac
>
>
> Hello,
>
> Working on MacOS X, I have trouble installing rgdal.
>
> I am sorry to post about this problem, since others have probably asked the question earlier on this list, but there seem to be no search tool to look for the previous posts on the list.
>
> Below is the R-output to my previous installation trials:
>
> install.packages("rgdal")
> Message d'avis :
> package ?rgdal? is not available (for R version 2.15.0)
> setRepositories(ind=1:2)
> install.packages("rgdal")
> essai de l'URL 'http://www.stats.ox.ac.uk/pub/RWin/bin/macosx/leopard/contrib/2.15/rgdal_0.7-8.tgz'
> Content type 'application/x-gzip' length 13810017 bytes (13.2 Mb)
> URL ouverte
> ==================================================
> downloaded 13.2 Mb
>
>
> Les packages binaires t?l?charg?s sont dans
> /var/folders/zT/zTnmGA9q2RaOuE+F76E3E++++TI/-Tmp-//Rtmpu8X57c/downloaded_packages
> library(rgdal)
> Error in dyn.load(file, DLLpath = DLLpath, ...) :
> impossible de charger l'objet partag? '/Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so':
> dlopen(/Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so, 6): Library not loaded: /usr/lib/libcurl.4.dylib
> Referenced from: /Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so
> Reason: Incompatible library version: rgdal.so requires version 7.0.0 or later, but libcurl.4.dylib provides version 6.0.0
> Erreur : le chargement du package / espace de noms a ?chou? pour ?rgdal?
>
>
> Meanwhile, I have installed PROJ 4.8 and GDAL 1.9 Complete from http://www.kyngchaos.com/software:frameworks
>
> but it doesn't help. When I try again with
> setRepositories(ind=1:2)
> install.packages("rgdal")
>
> I still get the error message pasted above.
>
> Can you help me?
> Thank you very much,
>
> Pierre de Larminat.
>
>
> [[alternative HTML version deleted]]
>
>
>
>
>
>
> --
> Roger Bivand
> Department of Economics, NHH Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no<mailto:Roger.Bivand at nhh.no>
>
>
> 	[[alternative HTML version deleted]]
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Fri May 18 17:23:26 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 18 May 2012 17:23:26 +0200 (CEST)
Subject: [R-sig-Geo] rgdal package for mac
In-Reply-To: <09A14528-04BE-4627-B67B-B3B04C7125E0@uv.es>
References: <mailman.7478.1337347734.4540.r-sig-geo@r-project.org>
	<5375E424-EB7F-439D-B52F-95D347678DCF@mpifg.de>
	<alpine.LRH.2.02.1205181539070.2590@reclus.nhh.no>
	<85B08C10-B438-41AF-9900-417C15A974ED@mpifg.de>
	<09A14528-04BE-4627-B67B-B3B04C7125E0@uv.es>
Message-ID: <alpine.LRH.2.02.1205181714280.2590@reclus.nhh.no>

On Fri, 18 May 2012, Agustin Diez Castillo wrote:

> Kyngchaos version can be installed for 2.15 [1] and 2.14 [2]
> [1] http://www.kyngchaos.com/files/software/frameworks/rgdal-0.7.8-2.zip
> [2] http://www.kyngchaos.com/files/software/frameworks/rgdal-0.7.8-1.zip
>

If the OQ had trouble understanding an error message in his own language, 
I don't think that he wants to install and maintain the Kyngchaos 
frameworks on which these otherwise excellent binary versions depend. 
(Some OSX users know that OSX is really Unix - Kyngchaos is fine for them; 
others think that OSX is cooler Windows, and they have ontological 
problems with non-Apple phenomena and constructs). There is a minor 
possibility that OSX binary rgdal 0.7-8 may see difficulties loading with 
the sp 0.9-99 CRAN OSX binary, but so far nobody has reported that. We 
continue to hope that rgdal and rgeos will be available as standard CRAN 
OSX binaries sometime.

Roger

>
>
> El May 18, 2012, a les 4:18 PM, de Larminat, Pierre va escriure:
>
>> Hello,
>>
>> I have the same problem than:
>> [R-sig-Geo] rgdal package for mac
>> Gabriele Cozzi gab.cozzi at gmail.com<http://gmail.com>
>> Thu May 17 10:33:21 CEST 2012
>>
>> I have already done:
>> setRepositories(ind=1:2)
>> install.packages("rgdal")
>> as said on the CRAN page for rgdal.
>>
>> I have restarted the computer and R.
>> When I entered the lines again, I received the same message that I had received before:
>>
>>> setRepositories(ind=1:2)
>>> install.packages("rgdal")
>> --- SVP s?lectionner un miroir CRAN pour cette session ---
>> essai de l'URL 'http://www.stats.ox.ac.uk/pub/RWin/bin/macosx/leopard/contrib/2.15/rgdal_0.7-8.tgz'
>> Content type 'application/x-gzip' length 13810017 bytes (13.2 Mb)
>> URL ouverte
>> ==================================================
>> downloaded 13.2 Mb
>>
>>
>> Les packages binaires t?l?charg?s sont dans
>> /var/folders/zT/zTnmGA9q2RaOuE+F76E3E++++TI/-Tmp-//RtmpKnHXly/downloaded_packages
>>> library(rgdal)
>> Le chargement a n?cessit? le package : sp
>> Error in dyn.load(file, DLLpath = DLLpath, ...) :
>> impossible de charger l'objet partag? '/Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so':
>> dlopen(/Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so, 6): Library not loaded: /usr/lib/libcurl.4.dylib
>> Referenced from: /Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so
>> Reason: Incompatible library version: rgdal.so requires version 7.0.0 or later, but libcurl.4.dylib provides version 6.0.0
>> Erreur : le chargement du package / espace de noms a ?chou? pour ?rgdal?
>>>
>>
>> Does anyone know how to solve this problem?
>> Thank you very much,
>> Pierre de Larminat.
>>
>>
>>
>> Le 18 mai 2012 ? 15:45, Roger Bivand a ?crit :
>>
>> On Fri, 18 May 2012, de Larminat, Pierre wrote:
>>
>> Dear Prof. Bivand,
>>
>> As I have trouble installing rgdal on my Macbook, I searched on some
>> blog-posts by R-bloggers, and I tried to look for help on r-sig-geo. It
>> seems that my message doesn't come through. Can you help me please? In
>> any case, thank you for your efforts in developing rgdal. I have seen
>> what others do with it. It is fascinating. Best regards, Pierre de
>> Larminat.
>>
>> You are subscribed as larminat at mpifg.de<mailto:larminat at mpifg.de>, and must post from that address.
>>
>> Never search blogs, they are almost always misleading, and nobody takes
>> responsibility for keeping the advice given up to date. Did you read the
>> CRAN page for rgdal - it does explain how to install rgdal on OSX. You
>> might also have searched the list archives (this question was answered
>> yesterday), or googled "list:r-sig-geo rgdal Mac".
>>
>> Roger Bivand
>>
>> list admin.
>>
>>
>>
>> - - -
>> Pierre de Larminat
>> Visiting doctoral fellow
>> Max Planck Institute for the Study of Societies
>> Paulstrasse 3, D-50676 K?ln, Germany
>> office: +49.221.2767.222
>> mobile: +49.152.521.704.83
>> e-mail: larminat at mpifg.de<mailto:larminat at mpifg.de>
>>
>> D?but du message r?exp?di? :
>>
>> De : "r-sig-geo-owner at r-project.org<mailto:r-sig-geo-owner at r-project.org>" <r-sig-geo-owner at r-project.org<mailto:r-sig-geo-owner at r-project.org>>
>> Date : 18 mai 2012 15:28:54 HAEC
>> ? : "de Larminat, Pierre" <pl at mpifg.de<mailto:pl at mpifg.de>>
>> Objet : Installing rgdal on mac
>>
>> You are not allowed to post to this mailing list, and your message has
>> been automatically rejected.  If you think that your messages are
>> being rejected in error, contact the mailing list owner at
>> r-sig-geo-owner at r-project.org<mailto:r-sig-geo-owner at r-project.org>.
>>
>>
>> De : "de Larminat, Pierre" <pl at mpifg.de<mailto:pl at mpifg.de>>
>> Date : 18 mai 2012 15:28:28 HAEC
>> ? : "r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>" <r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>>
>> Objet : Installing rgdal on mac
>>
>>
>> Hello,
>>
>> Working on MacOS X, I have trouble installing rgdal.
>>
>> I am sorry to post about this problem, since others have probably asked the question earlier on this list, but there seem to be no search tool to look for the previous posts on the list.
>>
>> Below is the R-output to my previous installation trials:
>>
>> install.packages("rgdal")
>> Message d'avis :
>> package ?rgdal? is not available (for R version 2.15.0)
>> setRepositories(ind=1:2)
>> install.packages("rgdal")
>> essai de l'URL 'http://www.stats.ox.ac.uk/pub/RWin/bin/macosx/leopard/contrib/2.15/rgdal_0.7-8.tgz'
>> Content type 'application/x-gzip' length 13810017 bytes (13.2 Mb)
>> URL ouverte
>> ==================================================
>> downloaded 13.2 Mb
>>
>>
>> Les packages binaires t?l?charg?s sont dans
>> /var/folders/zT/zTnmGA9q2RaOuE+F76E3E++++TI/-Tmp-//Rtmpu8X57c/downloaded_packages
>> library(rgdal)
>> Error in dyn.load(file, DLLpath = DLLpath, ...) :
>> impossible de charger l'objet partag? '/Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so':
>> dlopen(/Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so, 6): Library not loaded: /usr/lib/libcurl.4.dylib
>> Referenced from: /Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so
>> Reason: Incompatible library version: rgdal.so requires version 7.0.0 or later, but libcurl.4.dylib provides version 6.0.0
>> Erreur : le chargement du package / espace de noms a ?chou? pour ?rgdal?
>>
>>
>> Meanwhile, I have installed PROJ 4.8 and GDAL 1.9 Complete from http://www.kyngchaos.com/software:frameworks
>>
>> but it doesn't help. When I try again with
>> setRepositories(ind=1:2)
>> install.packages("rgdal")
>>
>> I still get the error message pasted above.
>>
>> Can you help me?
>> Thank you very much,
>>
>> Pierre de Larminat.
>>
>>
>> [[alternative HTML version deleted]]
>>
>>
>>
>>
>>
>>
>> --
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no<mailto:Roger.Bivand at nhh.no>
>>
>>
>> 	[[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From pl at mpifg.de  Fri May 18 17:43:10 2012
From: pl at mpifg.de (de Larminat, Pierre)
Date: Fri, 18 May 2012 17:43:10 +0200
Subject: [R-sig-Geo] rgdal package for mac
In-Reply-To: <alpine.LRH.2.02.1205181712330.2590@reclus.nhh.no>
References: <mailman.7478.1337347734.4540.r-sig-geo@r-project.org>
	<5375E424-EB7F-439D-B52F-95D347678DCF@mpifg.de>
	<alpine.LRH.2.02.1205181539070.2590@reclus.nhh.no>
	<85B08C10-B438-41AF-9900-417C15A974ED@mpifg.de>
	<alpine.LRH.2.02.1205181712330.2590@reclus.nhh.no>
Message-ID: <53B800F4-A7F9-4BB4-B900-21E0CC73CA2A@mpifg.de>



Le 18 mai 2012 ? 17:14, Roger Bivand a ?crit :

> On Fri, 18 May 2012, de Larminat, Pierre wrote:
> 
>> Hello,
>> 
>> I have the same problem than:
>> [R-sig-Geo] rgdal package for mac
>> Gabriele Cozzi gab.cozzi at gmail.com<http://gmail.com>
>> Thu May 17 10:33:21 CEST 2012
>> 
>> I have already done:
>> setRepositories(ind=1:2)
>> install.packages("rgdal")
>> as said on the CRAN page for rgdal.
>> 
>> I have restarted the computer and R.
>> When I entered the lines again, I received the same message that I had received before:
>> 
>>> setRepositories(ind=1:2)
>>> install.packages("rgdal")
>> --- SVP s?lectionner un miroir CRAN pour cette session ---
>> essai de l'URL 'http://www.stats.ox.ac.uk/pub/RWin/bin/macosx/leopard/contrib/2.15/rgdal_0.7-8.tgz'
>> Content type 'application/x-gzip' length 13810017 bytes (13.2 Mb)
>> URL ouverte
>> ==================================================
>> downloaded 13.2 Mb
>> 
>> 
>> Les packages binaires t?l?charg?s sont dans
>> /var/folders/zT/zTnmGA9q2RaOuE+F76E3E++++TI/-Tmp-//RtmpKnHXly/downloaded_packages
>>> library(rgdal)
>> Le chargement a n?cessit? le package : sp
> 
> This does seem to imply that sp is necessary, doesn't it? Have you 
> installed sp? Messages are given to be read, rather than ignored.
> 
> Roger
> 
Yes I had installed sp. The message merely states that I had not charged the sp library and that R had to do it by itself. When I do run *library(sp)* in time, I still get:

>> Error in dyn.load(file, DLLpath = DLLpath, ...) :
>> impossible de charger l'objet partag? '/Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so':
>> dlopen(/Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so, 6): Library not loaded: /usr/lib/libcurl.4.dylib
>> Referenced from: /Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so
>> Reason: Incompatible library version: rgdal.so requires version 7.0.0 or later, but libcurl.4.dylib provides version 6.0.0
>> Erreur : le chargement du package / espace de noms a ?chou? pour ?rgdal?
>>> 
>> 
>> Does anyone know how to solve this problem?
>> Thank you very much,
>> Pierre de Larminat.
>> 
>> 
>> 
>> Le 18 mai 2012 ? 15:45, Roger Bivand a ?crit :
>> 
>> On Fri, 18 May 2012, de Larminat, Pierre wrote:
>> 
>> Dear Prof. Bivand,
>> 
>> As I have trouble installing rgdal on my Macbook, I searched on some
>> blog-posts by R-bloggers, and I tried to look for help on r-sig-geo. It
>> seems that my message doesn't come through. Can you help me please? In
>> any case, thank you for your efforts in developing rgdal. I have seen
>> what others do with it. It is fascinating. Best regards, Pierre de
>> Larminat.
>> 
>> You are subscribed as larminat at mpifg.de<mailto:larminat at mpifg.de>, and must post from that address.
>> 
>> Never search blogs, they are almost always misleading, and nobody takes
>> responsibility for keeping the advice given up to date. Did you read the
>> CRAN page for rgdal - it does explain how to install rgdal on OSX. You
>> might also have searched the list archives (this question was answered
>> yesterday), or googled "list:r-sig-geo rgdal Mac".
>> 
>> Roger Bivand
>> 
>> list admin.
>> 
>> 
>> 
>> - - -
>> Pierre de Larminat
>> Visiting doctoral fellow
>> Max Planck Institute for the Study of Societies
>> Paulstrasse 3, D-50676 K?ln, Germany
>> office: +49.221.2767.222
>> mobile: +49.152.521.704.83
>> e-mail: larminat at mpifg.de<mailto:larminat at mpifg.de>
>> 
>> D?but du message r?exp?di? :
>> 
>> De : "r-sig-geo-owner at r-project.org<mailto:r-sig-geo-owner at r-project.org>" <r-sig-geo-owner at r-project.org<mailto:r-sig-geo-owner at r-project.org>>
>> Date : 18 mai 2012 15:28:54 HAEC
>> ? : "de Larminat, Pierre" <pl at mpifg.de<mailto:pl at mpifg.de>>
>> Objet : Installing rgdal on mac
>> 
>> You are not allowed to post to this mailing list, and your message has
>> been automatically rejected.  If you think that your messages are
>> being rejected in error, contact the mailing list owner at
>> r-sig-geo-owner at r-project.org<mailto:r-sig-geo-owner at r-project.org>.
>> 
>> 
>> De : "de Larminat, Pierre" <pl at mpifg.de<mailto:pl at mpifg.de>>
>> Date : 18 mai 2012 15:28:28 HAEC
>> ? : "r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>" <r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>>
>> Objet : Installing rgdal on mac
>> 
>> 
>> Hello,
>> 
>> Working on MacOS X, I have trouble installing rgdal.
>> 
>> I am sorry to post about this problem, since others have probably asked the question earlier on this list, but there seem to be no search tool to look for the previous posts on the list.
>> 
>> Below is the R-output to my previous installation trials:
>> 
>> install.packages("rgdal")
>> Message d'avis :
>> package ?rgdal? is not available (for R version 2.15.0)
>> setRepositories(ind=1:2)
>> install.packages("rgdal")
>> essai de l'URL 'http://www.stats.ox.ac.uk/pub/RWin/bin/macosx/leopard/contrib/2.15/rgdal_0.7-8.tgz'
>> Content type 'application/x-gzip' length 13810017 bytes (13.2 Mb)
>> URL ouverte
>> ==================================================
>> downloaded 13.2 Mb
>> 
>> 
>> Les packages binaires t?l?charg?s sont dans
>> /var/folders/zT/zTnmGA9q2RaOuE+F76E3E++++TI/-Tmp-//Rtmpu8X57c/downloaded_packages
>> library(rgdal)
>> Error in dyn.load(file, DLLpath = DLLpath, ...) :
>> impossible de charger l'objet partag? '/Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so':
>> dlopen(/Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so, 6): Library not loaded: /usr/lib/libcurl.4.dylib
>> Referenced from: /Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so
>> Reason: Incompatible library version: rgdal.so requires version 7.0.0 or later, but libcurl.4.dylib provides version 6.0.0
>> Erreur : le chargement du package / espace de noms a ?chou? pour ?rgdal?
>> 
>> 
>> Meanwhile, I have installed PROJ 4.8 and GDAL 1.9 Complete from http://www.kyngchaos.com/software:frameworks
>> 
>> but it doesn't help. When I try again with
>> setRepositories(ind=1:2)
>> install.packages("rgdal")
>> 
>> I still get the error message pasted above.
>> 
>> Can you help me?
>> Thank you very much,
>> 
>> Pierre de Larminat.
>> 
>> 
>> [[alternative HTML version deleted]]
>> 
>> 
>> 
>> 
>> 
>> 
>> --
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no<mailto:Roger.Bivand at nhh.no>
>> 
>> 
>> 	[[alternative HTML version deleted]]
>> 
>> 
> 
> -- 
> Roger Bivand
> Department of Economics, NHH Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no
> 


From Roger.Bivand at nhh.no  Fri May 18 17:52:27 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 18 May 2012 17:52:27 +0200 (CEST)
Subject: [R-sig-Geo] rgdal package for mac
In-Reply-To: <53B800F4-A7F9-4BB4-B900-21E0CC73CA2A@mpifg.de>
References: <mailman.7478.1337347734.4540.r-sig-geo@r-project.org>
	<5375E424-EB7F-439D-B52F-95D347678DCF@mpifg.de>
	<alpine.LRH.2.02.1205181539070.2590@reclus.nhh.no>
	<85B08C10-B438-41AF-9900-417C15A974ED@mpifg.de>
	<alpine.LRH.2.02.1205181712330.2590@reclus.nhh.no>
	<53B800F4-A7F9-4BB4-B900-21E0CC73CA2A@mpifg.de>
Message-ID: <alpine.LRH.2.02.1205181749110.2590@reclus.nhh.no>

On Fri, 18 May 2012, de Larminat, Pierre wrote:

>
>
> Le 18 mai 2012 ? 17:14, Roger Bivand a ?crit :
>
>> On Fri, 18 May 2012, de Larminat, Pierre wrote:
>>
>>> Hello,
>>>
>>> I have the same problem than:
>>> [R-sig-Geo] rgdal package for mac
>>> Gabriele Cozzi gab.cozzi at gmail.com<http://gmail.com>
>>> Thu May 17 10:33:21 CEST 2012
>>>
>>> I have already done:
>>> setRepositories(ind=1:2)
>>> install.packages("rgdal")
>>> as said on the CRAN page for rgdal.
>>>
>>> I have restarted the computer and R.
>>> When I entered the lines again, I received the same message that I had received before:
>>>
>>>> setRepositories(ind=1:2)
>>>> install.packages("rgdal")
>>> --- SVP s?lectionner un miroir CRAN pour cette session ---
>>> essai de l'URL 'http://www.stats.ox.ac.uk/pub/RWin/bin/macosx/leopard/contrib/2.15/rgdal_0.7-8.tgz'
>>> Content type 'application/x-gzip' length 13810017 bytes (13.2 Mb)
>>> URL ouverte
>>> ==================================================
>>> downloaded 13.2 Mb
>>>
>>>
>>> Les packages binaires t?l?charg?s sont dans
>>> /var/folders/zT/zTnmGA9q2RaOuE+F76E3E++++TI/-Tmp-//RtmpKnHXly/downloaded_packages
>>>> library(rgdal)
>>> Le chargement a n?cessit? le package : sp
>>
>> This does seem to imply that sp is necessary, doesn't it? Have you
>> installed sp? Messages are given to be read, rather than ignored.
>>
>> Roger
>>
> Yes I had installed sp. The message merely states that I had not charged the sp library and that R had to do it by itself. When I do run *library(sp)* in time, I still get:

OK. The next error message refers to your system having "libcurl.4.dylib 
provides version 6.0.0", but that the rgdal OSX binary requires >= 7.0.0:

>
>>> Error in dyn.load(file, DLLpath = DLLpath, ...) :
>>> impossible de charger l'objet partag? '/Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so':
>>> dlopen(/Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so, 6): Library not loaded: /usr/lib/libcurl.4.dylib
>>> Referenced from: /Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so
>>> Reason: Incompatible library version: rgdal.so requires version 7.0.0 or later, but libcurl.4.dylib provides version 6.0.0

^^^^ here. Are you running an older OSX version?

Roger


>>> Erreur : le chargement du package / espace de noms a ?chou? pour ?rgdal?
>>>>
>>>
>>> Does anyone know how to solve this problem?
>>> Thank you very much,
>>> Pierre de Larminat.
>>>
>>>
>>>
>>> Le 18 mai 2012 ? 15:45, Roger Bivand a ?crit :
>>>
>>> On Fri, 18 May 2012, de Larminat, Pierre wrote:
>>>
>>> Dear Prof. Bivand,
>>>
>>> As I have trouble installing rgdal on my Macbook, I searched on some
>>> blog-posts by R-bloggers, and I tried to look for help on r-sig-geo. It
>>> seems that my message doesn't come through. Can you help me please? In
>>> any case, thank you for your efforts in developing rgdal. I have seen
>>> what others do with it. It is fascinating. Best regards, Pierre de
>>> Larminat.
>>>
>>> You are subscribed as larminat at mpifg.de<mailto:larminat at mpifg.de>, and must post from that address.
>>>
>>> Never search blogs, they are almost always misleading, and nobody takes
>>> responsibility for keeping the advice given up to date. Did you read the
>>> CRAN page for rgdal - it does explain how to install rgdal on OSX. You
>>> might also have searched the list archives (this question was answered
>>> yesterday), or googled "list:r-sig-geo rgdal Mac".
>>>
>>> Roger Bivand
>>>
>>> list admin.
>>>
>>>
>>>
>>> - - -
>>> Pierre de Larminat
>>> Visiting doctoral fellow
>>> Max Planck Institute for the Study of Societies
>>> Paulstrasse 3, D-50676 K?ln, Germany
>>> office: +49.221.2767.222
>>> mobile: +49.152.521.704.83
>>> e-mail: larminat at mpifg.de<mailto:larminat at mpifg.de>
>>>
>>> D?but du message r?exp?di? :
>>>
>>> De : "r-sig-geo-owner at r-project.org<mailto:r-sig-geo-owner at r-project.org>" <r-sig-geo-owner at r-project.org<mailto:r-sig-geo-owner at r-project.org>>
>>> Date : 18 mai 2012 15:28:54 HAEC
>>> ? : "de Larminat, Pierre" <pl at mpifg.de<mailto:pl at mpifg.de>>
>>> Objet : Installing rgdal on mac
>>>
>>> You are not allowed to post to this mailing list, and your message has
>>> been automatically rejected.  If you think that your messages are
>>> being rejected in error, contact the mailing list owner at
>>> r-sig-geo-owner at r-project.org<mailto:r-sig-geo-owner at r-project.org>.
>>>
>>>
>>> De : "de Larminat, Pierre" <pl at mpifg.de<mailto:pl at mpifg.de>>
>>> Date : 18 mai 2012 15:28:28 HAEC
>>> ? : "r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>" <r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>>
>>> Objet : Installing rgdal on mac
>>>
>>>
>>> Hello,
>>>
>>> Working on MacOS X, I have trouble installing rgdal.
>>>
>>> I am sorry to post about this problem, since others have probably asked the question earlier on this list, but there seem to be no search tool to look for the previous posts on the list.
>>>
>>> Below is the R-output to my previous installation trials:
>>>
>>> install.packages("rgdal")
>>> Message d'avis :
>>> package ?rgdal? is not available (for R version 2.15.0)
>>> setRepositories(ind=1:2)
>>> install.packages("rgdal")
>>> essai de l'URL 'http://www.stats.ox.ac.uk/pub/RWin/bin/macosx/leopard/contrib/2.15/rgdal_0.7-8.tgz'
>>> Content type 'application/x-gzip' length 13810017 bytes (13.2 Mb)
>>> URL ouverte
>>> ==================================================
>>> downloaded 13.2 Mb
>>>
>>>
>>> Les packages binaires t?l?charg?s sont dans
>>> /var/folders/zT/zTnmGA9q2RaOuE+F76E3E++++TI/-Tmp-//Rtmpu8X57c/downloaded_packages
>>> library(rgdal)
>>> Error in dyn.load(file, DLLpath = DLLpath, ...) :
>>> impossible de charger l'objet partag? '/Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so':
>>> dlopen(/Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so, 6): Library not loaded: /usr/lib/libcurl.4.dylib
>>> Referenced from: /Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so
>>> Reason: Incompatible library version: rgdal.so requires version 7.0.0 or later, but libcurl.4.dylib provides version 6.0.0
>>> Erreur : le chargement du package / espace de noms a ?chou? pour ?rgdal?
>>>
>>>
>>> Meanwhile, I have installed PROJ 4.8 and GDAL 1.9 Complete from http://www.kyngchaos.com/software:frameworks
>>>
>>> but it doesn't help. When I try again with
>>> setRepositories(ind=1:2)
>>> install.packages("rgdal")
>>>
>>> I still get the error message pasted above.
>>>
>>> Can you help me?
>>> Thank you very much,
>>>
>>> Pierre de Larminat.
>>>
>>>
>>> [[alternative HTML version deleted]]
>>>
>>>
>>>
>>>
>>>
>>>
>>> --
>>> Roger Bivand
>>> Department of Economics, NHH Norwegian School of Economics,
>>> Helleveien 30, N-5045 Bergen, Norway.
>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>> e-mail: Roger.Bivand at nhh.no<mailto:Roger.Bivand at nhh.no>
>>>
>>>
>>> 	[[alternative HTML version deleted]]
>>>
>>>
>>
>> --
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From pl at mpifg.de  Fri May 18 17:59:09 2012
From: pl at mpifg.de (de Larminat, Pierre)
Date: Fri, 18 May 2012 17:59:09 +0200
Subject: [R-sig-Geo] rgdal package for mac
In-Reply-To: <alpine.LRH.2.02.1205181749110.2590@reclus.nhh.no>
References: <mailman.7478.1337347734.4540.r-sig-geo@r-project.org>
	<5375E424-EB7F-439D-B52F-95D347678DCF@mpifg.de>
	<alpine.LRH.2.02.1205181539070.2590@reclus.nhh.no>
	<85B08C10-B438-41AF-9900-417C15A974ED@mpifg.de>
	<alpine.LRH.2.02.1205181712330.2590@reclus.nhh.no>
	<53B800F4-A7F9-4BB4-B900-21E0CC73CA2A@mpifg.de>
	<alpine.LRH.2.02.1205181749110.2590@reclus.nhh.no>
Message-ID: <294BD3C5-8D34-4485-AB1D-11F019892375@mpifg.de>

Le 18 mai 2012 ? 17:52, Roger Bivand a ?crit :

> On Fri, 18 May 2012, de Larminat, Pierre wrote:
> 
>> 
>> 
>> Le 18 mai 2012 ? 17:14, Roger Bivand a ?crit :
>> 
>>> On Fri, 18 May 2012, de Larminat, Pierre wrote:
>>> 
>>>> Hello,
>>>> 
>>>> I have the same problem than:
>>>> [R-sig-Geo] rgdal package for mac
>>>> Gabriele Cozzi gab.cozzi at gmail.com<http://gmail.com>
>>>> Thu May 17 10:33:21 CEST 2012
>>>> 
>>>> I have already done:
>>>> setRepositories(ind=1:2)
>>>> install.packages("rgdal")
>>>> as said on the CRAN page for rgdal.
>>>> 
>>>> I have restarted the computer and R.
>>>> When I entered the lines again, I received the same message that I had received before:
>>>> 
>>>>> setRepositories(ind=1:2)
>>>>> install.packages("rgdal")
>>>> --- SVP s?lectionner un miroir CRAN pour cette session ---
>>>> essai de l'URL 'http://www.stats.ox.ac.uk/pub/RWin/bin/macosx/leopard/contrib/2.15/rgdal_0.7-8.tgz'
>>>> Content type 'application/x-gzip' length 13810017 bytes (13.2 Mb)
>>>> URL ouverte
>>>> ==================================================
>>>> downloaded 13.2 Mb
>>>> 
>>>> 
>>>> Les packages binaires t?l?charg?s sont dans
>>>> /var/folders/zT/zTnmGA9q2RaOuE+F76E3E++++TI/-Tmp-//RtmpKnHXly/downloaded_packages
>>>>> library(rgdal)
>>>> Le chargement a n?cessit? le package : sp
>>> 
>>> This does seem to imply that sp is necessary, doesn't it? Have you
>>> installed sp? Messages are given to be read, rather than ignored.
>>> 
>>> Roger
>>> 
>> Yes I had installed sp. The message merely states that I had not charged the sp library and that R had to do it by itself. When I do run *library(sp)* in time, I still get:
> 
> OK. The next error message refers to your system having "libcurl.4.dylib 
> provides version 6.0.0", but that the rgdal OSX binary requires >= 7.0.0:
> 
>> 
>>>> Error in dyn.load(file, DLLpath = DLLpath, ...) :
>>>> impossible de charger l'objet partag? '/Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so':
>>>> dlopen(/Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so, 6): Library not loaded: /usr/lib/libcurl.4.dylib
>>>> Referenced from: /Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so
>>>> Reason: Incompatible library version: rgdal.so requires version 7.0.0 or later, but libcurl.4.dylib provides version 6.0.0
> 
> ^^^^ here. Are you running an older OSX version?
> 
> Roger
> 
I am running R 2.15 on MacOS 10.6.8 and I do not know what libcurl.4.dylib is.

Pierre.
> 
>>>> Erreur : le chargement du package / espace de noms a ?chou? pour ?rgdal?
>>>>> 
>>>> 
>>>> Does anyone know how to solve this problem?
>>>> Thank you very much,
>>>> Pierre de Larminat.
>>>> 
>>>> 
>>>> 
>>>> Le 18 mai 2012 ? 15:45, Roger Bivand a ?crit :
>>>> 
>>>> On Fri, 18 May 2012, de Larminat, Pierre wrote:
>>>> 
>>>> Dear Prof. Bivand,
>>>> 
>>>> As I have trouble installing rgdal on my Macbook, I searched on some
>>>> blog-posts by R-bloggers, and I tried to look for help on r-sig-geo. It
>>>> seems that my message doesn't come through. Can you help me please? In
>>>> any case, thank you for your efforts in developing rgdal. I have seen
>>>> what others do with it. It is fascinating. Best regards, Pierre de
>>>> Larminat.
>>>> 
>>>> You are subscribed as larminat at mpifg.de<mailto:larminat at mpifg.de>, and must post from that address.
>>>> 
>>>> Never search blogs, they are almost always misleading, and nobody takes
>>>> responsibility for keeping the advice given up to date. Did you read the
>>>> CRAN page for rgdal - it does explain how to install rgdal on OSX. You
>>>> might also have searched the list archives (this question was answered
>>>> yesterday), or googled "list:r-sig-geo rgdal Mac".
>>>> 
>>>> Roger Bivand
>>>> 
>>>> list admin.
>>>> 
>>>> 
>>>> 
>>>> - - -
>>>> Pierre de Larminat
>>>> Visiting doctoral fellow
>>>> Max Planck Institute for the Study of Societies
>>>> Paulstrasse 3, D-50676 K?ln, Germany
>>>> office: +49.221.2767.222
>>>> mobile: +49.152.521.704.83
>>>> e-mail: larminat at mpifg.de<mailto:larminat at mpifg.de>
>>>> 
>>>> D?but du message r?exp?di? :
>>>> 
>>>> De : "r-sig-geo-owner at r-project.org<mailto:r-sig-geo-owner at r-project.org>" <r-sig-geo-owner at r-project.org<mailto:r-sig-geo-owner at r-project.org>>
>>>> Date : 18 mai 2012 15:28:54 HAEC
>>>> ? : "de Larminat, Pierre" <pl at mpifg.de<mailto:pl at mpifg.de>>
>>>> Objet : Installing rgdal on mac
>>>> 
>>>> You are not allowed to post to this mailing list, and your message has
>>>> been automatically rejected.  If you think that your messages are
>>>> being rejected in error, contact the mailing list owner at
>>>> r-sig-geo-owner at r-project.org<mailto:r-sig-geo-owner at r-project.org>.
>>>> 
>>>> 
>>>> De : "de Larminat, Pierre" <pl at mpifg.de<mailto:pl at mpifg.de>>
>>>> Date : 18 mai 2012 15:28:28 HAEC
>>>> ? : "r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>" <r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>>
>>>> Objet : Installing rgdal on mac
>>>> 
>>>> 
>>>> Hello,
>>>> 
>>>> Working on MacOS X, I have trouble installing rgdal.
>>>> 
>>>> I am sorry to post about this problem, since others have probably asked the question earlier on this list, but there seem to be no search tool to look for the previous posts on the list.
>>>> 
>>>> Below is the R-output to my previous installation trials:
>>>> 
>>>> install.packages("rgdal")
>>>> Message d'avis :
>>>> package ?rgdal? is not available (for R version 2.15.0)
>>>> setRepositories(ind=1:2)
>>>> install.packages("rgdal")
>>>> essai de l'URL 'http://www.stats.ox.ac.uk/pub/RWin/bin/macosx/leopard/contrib/2.15/rgdal_0.7-8.tgz'
>>>> Content type 'application/x-gzip' length 13810017 bytes (13.2 Mb)
>>>> URL ouverte
>>>> ==================================================
>>>> downloaded 13.2 Mb
>>>> 
>>>> 
>>>> Les packages binaires t?l?charg?s sont dans
>>>> /var/folders/zT/zTnmGA9q2RaOuE+F76E3E++++TI/-Tmp-//Rtmpu8X57c/downloaded_packages
>>>> library(rgdal)
>>>> Error in dyn.load(file, DLLpath = DLLpath, ...) :
>>>> impossible de charger l'objet partag? '/Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so':
>>>> dlopen(/Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so, 6): Library not loaded: /usr/lib/libcurl.4.dylib
>>>> Referenced from: /Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so
>>>> Reason: Incompatible library version: rgdal.so requires version 7.0.0 or later, but libcurl.4.dylib provides version 6.0.0
>>>> Erreur : le chargement du package / espace de noms a ?chou? pour ?rgdal?
>>>> 
>>>> 
>>>> Meanwhile, I have installed PROJ 4.8 and GDAL 1.9 Complete from http://www.kyngchaos.com/software:frameworks
>>>> 
>>>> but it doesn't help. When I try again with
>>>> setRepositories(ind=1:2)
>>>> install.packages("rgdal")
>>>> 
>>>> I still get the error message pasted above.
>>>> 
>>>> Can you help me?
>>>> Thank you very much,
>>>> 
>>>> Pierre de Larminat.
>>>> 
>>>> 
>>>> [[alternative HTML version deleted]]
>>>> 
>>>> 
>>>> 
>>>> 
>>>> 
>>>> 
>>>> --
>>>> Roger Bivand
>>>> Department of Economics, NHH Norwegian School of Economics,
>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>>> e-mail: Roger.Bivand at nhh.no<mailto:Roger.Bivand at nhh.no>
>>>> 
>>>> 
>>>> 	[[alternative HTML version deleted]]
>>>> 
>>>> 
>>> 
>>> --
>>> Roger Bivand
>>> Department of Economics, NHH Norwegian School of Economics,
>>> Helleveien 30, N-5045 Bergen, Norway.
>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>> e-mail: Roger.Bivand at nhh.no
>>> 
>> 
>> 
> 
> -- 
> Roger Bivand
> Department of Economics, NHH Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no


From Roger.Bivand at nhh.no  Fri May 18 18:11:36 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri, 18 May 2012 18:11:36 +0200 (CEST)
Subject: [R-sig-Geo] rgdal package for mac
In-Reply-To: <294BD3C5-8D34-4485-AB1D-11F019892375@mpifg.de>
References: <mailman.7478.1337347734.4540.r-sig-geo@r-project.org>
	<5375E424-EB7F-439D-B52F-95D347678DCF@mpifg.de>
	<alpine.LRH.2.02.1205181539070.2590@reclus.nhh.no>
	<85B08C10-B438-41AF-9900-417C15A974ED@mpifg.de>
	<alpine.LRH.2.02.1205181712330.2590@reclus.nhh.no>
	<53B800F4-A7F9-4BB4-B900-21E0CC73CA2A@mpifg.de>
	<alpine.LRH.2.02.1205181749110.2590@reclus.nhh.no>
	<294BD3C5-8D34-4485-AB1D-11F019892375@mpifg.de>
Message-ID: <alpine.LRH.2.02.1205181801560.2590@reclus.nhh.no>

On Fri, 18 May 2012, de Larminat, Pierre wrote:

> Le 18 mai 2012 ? 17:52, Roger Bivand a ?crit :
>
>> On Fri, 18 May 2012, de Larminat, Pierre wrote:
>>
>>>
>>>
>>> Le 18 mai 2012 ? 17:14, Roger Bivand a ?crit :
>>>
>>>> On Fri, 18 May 2012, de Larminat, Pierre wrote:
>>>>
>>>>> Hello,
>>>>>
>>>>> I have the same problem than:
>>>>> [R-sig-Geo] rgdal package for mac
>>>>> Gabriele Cozzi gab.cozzi at gmail.com<http://gmail.com>
>>>>> Thu May 17 10:33:21 CEST 2012
>>>>>
>>>>> I have already done:
>>>>> setRepositories(ind=1:2)
>>>>> install.packages("rgdal")
>>>>> as said on the CRAN page for rgdal.
>>>>>
>>>>> I have restarted the computer and R.
>>>>> When I entered the lines again, I received the same message that I had received before:
>>>>>
>>>>>> setRepositories(ind=1:2)
>>>>>> install.packages("rgdal")
>>>>> --- SVP s?lectionner un miroir CRAN pour cette session ---
>>>>> essai de l'URL 'http://www.stats.ox.ac.uk/pub/RWin/bin/macosx/leopard/contrib/2.15/rgdal_0.7-8.tgz'
>>>>> Content type 'application/x-gzip' length 13810017 bytes (13.2 Mb)
>>>>> URL ouverte
>>>>> ==================================================
>>>>> downloaded 13.2 Mb
>>>>>
>>>>>
>>>>> Les packages binaires t?l?charg?s sont dans
>>>>> /var/folders/zT/zTnmGA9q2RaOuE+F76E3E++++TI/-Tmp-//RtmpKnHXly/downloaded_packages
>>>>>> library(rgdal)
>>>>> Le chargement a n?cessit? le package : sp
>>>>
>>>> This does seem to imply that sp is necessary, doesn't it? Have you
>>>> installed sp? Messages are given to be read, rather than ignored.
>>>>
>>>> Roger
>>>>
>>> Yes I had installed sp. The message merely states that I had not charged the sp library and that R had to do it by itself. When I do run *library(sp)* in time, I still get:
>>
>> OK. The next error message refers to your system having "libcurl.4.dylib
>> provides version 6.0.0", but that the rgdal OSX binary requires >= 7.0.0:
>>
>>>
>>>>> Error in dyn.load(file, DLLpath = DLLpath, ...) :
>>>>> impossible de charger l'objet partag? '/Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so':
>>>>> dlopen(/Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so, 6): Library not loaded: /usr/lib/libcurl.4.dylib
>>>>> Referenced from: /Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so
>>>>> Reason: Incompatible library version: rgdal.so requires version 7.0.0 or later, but libcurl.4.dylib provides version 6.0.0
>>
>> ^^^^ here. Are you running an older OSX version?
>>
>> Roger
>>
> I am running R 2.15 on MacOS 10.6.8 and I do not know what libcurl.4.dylib is.

Please ask on R-sig-mac, or get local help; users may not know what system 
resources are, but do suffer the consequences. The cause is probably that 
the rgdal CRAN Extras OSX binary was built on 10.7, and you are running 
10.6 - the background for building on a newer system was given in an 
earlier thread.

Roger

>
> Pierre.
>>
>>>>> Erreur : le chargement du package / espace de noms a ?chou? pour ?rgdal?
>>>>>>
>>>>>
>>>>> Does anyone know how to solve this problem?
>>>>> Thank you very much,
>>>>> Pierre de Larminat.
>>>>>
>>>>>
>>>>>
>>>>> Le 18 mai 2012 ? 15:45, Roger Bivand a ?crit :
>>>>>
>>>>> On Fri, 18 May 2012, de Larminat, Pierre wrote:
>>>>>
>>>>> Dear Prof. Bivand,
>>>>>
>>>>> As I have trouble installing rgdal on my Macbook, I searched on some
>>>>> blog-posts by R-bloggers, and I tried to look for help on r-sig-geo. It
>>>>> seems that my message doesn't come through. Can you help me please? In
>>>>> any case, thank you for your efforts in developing rgdal. I have seen
>>>>> what others do with it. It is fascinating. Best regards, Pierre de
>>>>> Larminat.
>>>>>
>>>>> You are subscribed as larminat at mpifg.de<mailto:larminat at mpifg.de>, and must post from that address.
>>>>>
>>>>> Never search blogs, they are almost always misleading, and nobody takes
>>>>> responsibility for keeping the advice given up to date. Did you read the
>>>>> CRAN page for rgdal - it does explain how to install rgdal on OSX. You
>>>>> might also have searched the list archives (this question was answered
>>>>> yesterday), or googled "list:r-sig-geo rgdal Mac".
>>>>>
>>>>> Roger Bivand
>>>>>
>>>>> list admin.
>>>>>
>>>>>
>>>>>
>>>>> - - -
>>>>> Pierre de Larminat
>>>>> Visiting doctoral fellow
>>>>> Max Planck Institute for the Study of Societies
>>>>> Paulstrasse 3, D-50676 K?ln, Germany
>>>>> office: +49.221.2767.222
>>>>> mobile: +49.152.521.704.83
>>>>> e-mail: larminat at mpifg.de<mailto:larminat at mpifg.de>
>>>>>
>>>>> D?but du message r?exp?di? :
>>>>>
>>>>> De : "r-sig-geo-owner at r-project.org<mailto:r-sig-geo-owner at r-project.org>" <r-sig-geo-owner at r-project.org<mailto:r-sig-geo-owner at r-project.org>>
>>>>> Date : 18 mai 2012 15:28:54 HAEC
>>>>> ? : "de Larminat, Pierre" <pl at mpifg.de<mailto:pl at mpifg.de>>
>>>>> Objet : Installing rgdal on mac
>>>>>
>>>>> You are not allowed to post to this mailing list, and your message has
>>>>> been automatically rejected.  If you think that your messages are
>>>>> being rejected in error, contact the mailing list owner at
>>>>> r-sig-geo-owner at r-project.org<mailto:r-sig-geo-owner at r-project.org>.
>>>>>
>>>>>
>>>>> De : "de Larminat, Pierre" <pl at mpifg.de<mailto:pl at mpifg.de>>
>>>>> Date : 18 mai 2012 15:28:28 HAEC
>>>>> ? : "r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>" <r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>>
>>>>> Objet : Installing rgdal on mac
>>>>>
>>>>>
>>>>> Hello,
>>>>>
>>>>> Working on MacOS X, I have trouble installing rgdal.
>>>>>
>>>>> I am sorry to post about this problem, since others have probably asked the question earlier on this list, but there seem to be no search tool to look for the previous posts on the list.
>>>>>
>>>>> Below is the R-output to my previous installation trials:
>>>>>
>>>>> install.packages("rgdal")
>>>>> Message d'avis :
>>>>> package ?rgdal? is not available (for R version 2.15.0)
>>>>> setRepositories(ind=1:2)
>>>>> install.packages("rgdal")
>>>>> essai de l'URL 'http://www.stats.ox.ac.uk/pub/RWin/bin/macosx/leopard/contrib/2.15/rgdal_0.7-8.tgz'
>>>>> Content type 'application/x-gzip' length 13810017 bytes (13.2 Mb)
>>>>> URL ouverte
>>>>> ==================================================
>>>>> downloaded 13.2 Mb
>>>>>
>>>>>
>>>>> Les packages binaires t?l?charg?s sont dans
>>>>> /var/folders/zT/zTnmGA9q2RaOuE+F76E3E++++TI/-Tmp-//Rtmpu8X57c/downloaded_packages
>>>>> library(rgdal)
>>>>> Error in dyn.load(file, DLLpath = DLLpath, ...) :
>>>>> impossible de charger l'objet partag? '/Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so':
>>>>> dlopen(/Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so, 6): Library not loaded: /usr/lib/libcurl.4.dylib
>>>>> Referenced from: /Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so
>>>>> Reason: Incompatible library version: rgdal.so requires version 7.0.0 or later, but libcurl.4.dylib provides version 6.0.0
>>>>> Erreur : le chargement du package / espace de noms a ?chou? pour ?rgdal?
>>>>>
>>>>>
>>>>> Meanwhile, I have installed PROJ 4.8 and GDAL 1.9 Complete from http://www.kyngchaos.com/software:frameworks
>>>>>
>>>>> but it doesn't help. When I try again with
>>>>> setRepositories(ind=1:2)
>>>>> install.packages("rgdal")
>>>>>
>>>>> I still get the error message pasted above.
>>>>>
>>>>> Can you help me?
>>>>> Thank you very much,
>>>>>
>>>>> Pierre de Larminat.
>>>>>
>>>>>
>>>>> [[alternative HTML version deleted]]
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>> --
>>>>> Roger Bivand
>>>>> Department of Economics, NHH Norwegian School of Economics,
>>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>>>> e-mail: Roger.Bivand at nhh.no<mailto:Roger.Bivand at nhh.no>
>>>>>
>>>>>
>>>>> 	[[alternative HTML version deleted]]
>>>>>
>>>>>
>>>>
>>>> --
>>>> Roger Bivand
>>>> Department of Economics, NHH Norwegian School of Economics,
>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>>> e-mail: Roger.Bivand at nhh.no
>>>>
>>>
>>>
>>
>> --
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no

From pl at mpifg.de  Fri May 18 18:17:08 2012
From: pl at mpifg.de (de Larminat, Pierre)
Date: Fri, 18 May 2012 18:17:08 +0200
Subject: [R-sig-Geo] rgdal package for mac
In-Reply-To: <alpine.LRH.2.02.1205181801560.2590@reclus.nhh.no>
References: <mailman.7478.1337347734.4540.r-sig-geo@r-project.org>
	<5375E424-EB7F-439D-B52F-95D347678DCF@mpifg.de>
	<alpine.LRH.2.02.1205181539070.2590@reclus.nhh.no>
	<85B08C10-B438-41AF-9900-417C15A974ED@mpifg.de>
	<alpine.LRH.2.02.1205181712330.2590@reclus.nhh.no>
	<53B800F4-A7F9-4BB4-B900-21E0CC73CA2A@mpifg.de>
	<alpine.LRH.2.02.1205181749110.2590@reclus.nhh.no>
	<294BD3C5-8D34-4485-AB1D-11F019892375@mpifg.de>
	<alpine.LRH.2.02.1205181801560.2590@reclus.nhh.no>
Message-ID: <AC4F7B42-8C84-4DEA-AE73-2E960EE0B5B8@mpifg.de>

Le 18 mai 2012 ? 18:11, Roger Bivand a ?crit :

> On Fri, 18 May 2012, de Larminat, Pierre wrote:
> 
>> Le 18 mai 2012 ? 17:52, Roger Bivand a ?crit :
>> 
>>> On Fri, 18 May 2012, de Larminat, Pierre wrote:
>>> 
>>>> 
>>>> 
>>>> Le 18 mai 2012 ? 17:14, Roger Bivand a ?crit :
>>>> 
>>>>> On Fri, 18 May 2012, de Larminat, Pierre wrote:
>>>>> 
>>>>>> Hello,
>>>>>> 
>>>>>> I have the same problem than:
>>>>>> [R-sig-Geo] rgdal package for mac
>>>>>> Gabriele Cozzi gab.cozzi at gmail.com<http://gmail.com>
>>>>>> Thu May 17 10:33:21 CEST 2012
>>>>>> 
>>>>>> I have already done:
>>>>>> setRepositories(ind=1:2)
>>>>>> install.packages("rgdal")
>>>>>> as said on the CRAN page for rgdal.
>>>>>> 
>>>>>> I have restarted the computer and R.
>>>>>> When I entered the lines again, I received the same message that I had received before:
>>>>>> 
>>>>>>> setRepositories(ind=1:2)
>>>>>>> install.packages("rgdal")
>>>>>> --- SVP s?lectionner un miroir CRAN pour cette session ---
>>>>>> essai de l'URL 'http://www.stats.ox.ac.uk/pub/RWin/bin/macosx/leopard/contrib/2.15/rgdal_0.7-8.tgz'
>>>>>> Content type 'application/x-gzip' length 13810017 bytes (13.2 Mb)
>>>>>> URL ouverte
>>>>>> ==================================================
>>>>>> downloaded 13.2 Mb
>>>>>> 
>>>>>> 
>>>>>> Les packages binaires t?l?charg?s sont dans
>>>>>> /var/folders/zT/zTnmGA9q2RaOuE+F76E3E++++TI/-Tmp-//RtmpKnHXly/downloaded_packages
>>>>>>> library(rgdal)
>>>>>> Le chargement a n?cessit? le package : sp
>>>>> 
>>>>> This does seem to imply that sp is necessary, doesn't it? Have you
>>>>> installed sp? Messages are given to be read, rather than ignored.
>>>>> 
>>>>> Roger
>>>>> 
>>>> Yes I had installed sp. The message merely states that I had not charged the sp library and that R had to do it by itself. When I do run *library(sp)* in time, I still get:
>>> 
>>> OK. The next error message refers to your system having "libcurl.4.dylib
>>> provides version 6.0.0", but that the rgdal OSX binary requires >= 7.0.0:
>>> 
>>>> 
>>>>>> Error in dyn.load(file, DLLpath = DLLpath, ...) :
>>>>>> impossible de charger l'objet partag? '/Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so':
>>>>>> dlopen(/Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so, 6): Library not loaded: /usr/lib/libcurl.4.dylib
>>>>>> Referenced from: /Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so
>>>>>> Reason: Incompatible library version: rgdal.so requires version 7.0.0 or later, but libcurl.4.dylib provides version 6.0.0
>>> 
>>> ^^^^ here. Are you running an older OSX version?
>>> 
>>> Roger
>>> 
>> I am running R 2.15 on MacOS 10.6.8 and I do not know what libcurl.4.dylib is.
> 
> Please ask on R-sig-mac, or get local help; users may not know what system 
> resources are, but do suffer the consequences. The cause is probably that 
> the rgdal CRAN Extras OSX binary was built on 10.7, and you are running 
> 10.6 - the background for building on a newer system was given in an 
> earlier thread.
> 
> Roger
> 

OK, thank you for the advice and for the time that you have taken to help me.

Pierre.

>>> 
>>>>>> Erreur : le chargement du package / espace de noms a ?chou? pour ?rgdal?
>>>>>>> 
>>>>>> 
>>>>>> Does anyone know how to solve this problem?
>>>>>> Thank you very much,
>>>>>> Pierre de Larminat.
>>>>>> 
>>>>>> 
>>>>>> 
>>>>>> Le 18 mai 2012 ? 15:45, Roger Bivand a ?crit :
>>>>>> 
>>>>>> On Fri, 18 May 2012, de Larminat, Pierre wrote:
>>>>>> 
>>>>>> Dear Prof. Bivand,
>>>>>> 
>>>>>> As I have trouble installing rgdal on my Macbook, I searched on some
>>>>>> blog-posts by R-bloggers, and I tried to look for help on r-sig-geo. It
>>>>>> seems that my message doesn't come through. Can you help me please? In
>>>>>> any case, thank you for your efforts in developing rgdal. I have seen
>>>>>> what others do with it. It is fascinating. Best regards, Pierre de
>>>>>> Larminat.
>>>>>> 
>>>>>> You are subscribed as larminat at mpifg.de<mailto:larminat at mpifg.de>, and must post from that address.
>>>>>> 
>>>>>> Never search blogs, they are almost always misleading, and nobody takes
>>>>>> responsibility for keeping the advice given up to date. Did you read the
>>>>>> CRAN page for rgdal - it does explain how to install rgdal on OSX. You
>>>>>> might also have searched the list archives (this question was answered
>>>>>> yesterday), or googled "list:r-sig-geo rgdal Mac".
>>>>>> 
>>>>>> Roger Bivand
>>>>>> 
>>>>>> list admin.
>>>>>> 
>>>>>> 
>>>>>> 
>>>>>> - - -
>>>>>> Pierre de Larminat
>>>>>> Visiting doctoral fellow
>>>>>> Max Planck Institute for the Study of Societies
>>>>>> Paulstrasse 3, D-50676 K?ln, Germany
>>>>>> office: +49.221.2767.222
>>>>>> mobile: +49.152.521.704.83
>>>>>> e-mail: larminat at mpifg.de<mailto:larminat at mpifg.de>
>>>>>> 
>>>>>> D?but du message r?exp?di? :
>>>>>> 
>>>>>> De : "r-sig-geo-owner at r-project.org<mailto:r-sig-geo-owner at r-project.org>" <r-sig-geo-owner at r-project.org<mailto:r-sig-geo-owner at r-project.org>>
>>>>>> Date : 18 mai 2012 15:28:54 HAEC
>>>>>> ? : "de Larminat, Pierre" <pl at mpifg.de<mailto:pl at mpifg.de>>
>>>>>> Objet : Installing rgdal on mac
>>>>>> 
>>>>>> You are not allowed to post to this mailing list, and your message has
>>>>>> been automatically rejected.  If you think that your messages are
>>>>>> being rejected in error, contact the mailing list owner at
>>>>>> r-sig-geo-owner at r-project.org<mailto:r-sig-geo-owner at r-project.org>.
>>>>>> 
>>>>>> 
>>>>>> De : "de Larminat, Pierre" <pl at mpifg.de<mailto:pl at mpifg.de>>
>>>>>> Date : 18 mai 2012 15:28:28 HAEC
>>>>>> ? : "r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>" <r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>>
>>>>>> Objet : Installing rgdal on mac
>>>>>> 
>>>>>> 
>>>>>> Hello,
>>>>>> 
>>>>>> Working on MacOS X, I have trouble installing rgdal.
>>>>>> 
>>>>>> I am sorry to post about this problem, since others have probably asked the question earlier on this list, but there seem to be no search tool to look for the previous posts on the list.
>>>>>> 
>>>>>> Below is the R-output to my previous installation trials:
>>>>>> 
>>>>>> install.packages("rgdal")
>>>>>> Message d'avis :
>>>>>> package ?rgdal? is not available (for R version 2.15.0)
>>>>>> setRepositories(ind=1:2)
>>>>>> install.packages("rgdal")
>>>>>> essai de l'URL 'http://www.stats.ox.ac.uk/pub/RWin/bin/macosx/leopard/contrib/2.15/rgdal_0.7-8.tgz'
>>>>>> Content type 'application/x-gzip' length 13810017 bytes (13.2 Mb)
>>>>>> URL ouverte
>>>>>> ==================================================
>>>>>> downloaded 13.2 Mb
>>>>>> 
>>>>>> 
>>>>>> Les packages binaires t?l?charg?s sont dans
>>>>>> /var/folders/zT/zTnmGA9q2RaOuE+F76E3E++++TI/-Tmp-//Rtmpu8X57c/downloaded_packages
>>>>>> library(rgdal)
>>>>>> Error in dyn.load(file, DLLpath = DLLpath, ...) :
>>>>>> impossible de charger l'objet partag? '/Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so':
>>>>>> dlopen(/Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so, 6): Library not loaded: /usr/lib/libcurl.4.dylib
>>>>>> Referenced from: /Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgdal/libs/i386/rgdal.so
>>>>>> Reason: Incompatible library version: rgdal.so requires version 7.0.0 or later, but libcurl.4.dylib provides version 6.0.0
>>>>>> Erreur : le chargement du package / espace de noms a ?chou? pour ?rgdal?
>>>>>> 
>>>>>> 
>>>>>> Meanwhile, I have installed PROJ 4.8 and GDAL 1.9 Complete from http://www.kyngchaos.com/software:frameworks
>>>>>> 
>>>>>> but it doesn't help. When I try again with
>>>>>> setRepositories(ind=1:2)
>>>>>> install.packages("rgdal")
>>>>>> 
>>>>>> I still get the error message pasted above.
>>>>>> 
>>>>>> Can you help me?
>>>>>> Thank you very much,
>>>>>> 
>>>>>> Pierre de Larminat.
>>>>>> 
>>>>>> 
>>>>>> [[alternative HTML version deleted]]
>>>>>> 
>>>>>> 
>>>>>> 
>>>>>> 
>>>>>> 
>>>>>> 
>>>>>> --
>>>>>> Roger Bivand
>>>>>> Department of Economics, NHH Norwegian School of Economics,
>>>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>>>>> e-mail: Roger.Bivand at nhh.no<mailto:Roger.Bivand at nhh.no>
>>>>>> 
>>>>>> 
>>>>>> 	[[alternative HTML version deleted]]
>>>>>> 
>>>>>> 
>>>>> 
>>>>> --
>>>>> Roger Bivand
>>>>> Department of Economics, NHH Norwegian School of Economics,
>>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>>>> e-mail: Roger.Bivand at nhh.no
>>>>> 
>>>> 
>>>> 
>>> 
>>> --
>>> Roger Bivand
>>> Department of Economics, NHH Norwegian School of Economics,
>>> Helleveien 30, N-5045 Bergen, Norway.
>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>> e-mail: Roger.Bivand at nhh.no
>> 
>> 
> 
> -- 
> Roger Bivand
> Department of Economics, NHH Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; fax +47 55 95 95 43
> e-mail: Roger.Bivand at nhh.no


From macqueen1 at llnl.gov  Fri May 18 19:16:15 2012
From: macqueen1 at llnl.gov (MacQueen, Don)
Date: Fri, 18 May 2012 10:16:15 -0700
Subject: [R-sig-Geo] rgdal package for mac
In-Reply-To: <AC4F7B42-8C84-4DEA-AE73-2E960EE0B5B8@mpifg.de>
Message-ID: <CBDBC545.98538%macqueen1@llnl.gov>

I have rgdal installed on two 10.6.8 machines -- one regrettably still
using R 2.14.1 and the other R 2.15.0.

Over time I have used both the CRAN Extras rgdal and the kyngchaos rgdal.
Currently I have the CRAN Extras version (0.7-8, 2012-01-18) installed,
but if there is now a version mismatch as Roger suggested might be the
case, I would try the kyngchaos version of rgdal.

My basic process for GIS support on my Macs is to
  1) download and install the necessary frameworks from kyngchaos
  2) install rgdal

#### GIS software for Mac (Snow Leopard and Lion)
http://hub.qgis.org/projects/quantum-gis/wiki/Download#3-MacOS-X
http://www.kyngchaos.com/software/qgis
http://www.kyngchaos.com/software/frameworks

The following describes the 2.15.0 machine.


#### listing of my GIS support directory, from kyngchaos qgis and
frameworks pages
GIS-support-2012-04[8]% ls -1 *.dmg *.zip
 FreeType_Framework-2.4.9-1.dmg
 GDAL_Complete-1.9.dmg
 GRASS-6.4.2-3-Snow.dmg
 GSL_Framework-1.15-2.dmg
 Qgis-1.7.4-4.dmg
 cairo_Framework-1.10.2-3a-snow.dmg
 rgdal-0.7.8-1.zip   (this is the kyngchaos version of rgdal)

#### Then in R:

## loading rgdal
> require(rgdal)
Loading required package: rgdal
Loading required package: sp
Geospatial Data Abstraction Library extensions to R successfully loaded
Loaded GDAL runtime: GDAL 1.9.0, released 2011/12/29
Path to GDAL shared files:
/Library/Frameworks/GDAL.framework/Versions/1.9/Resources/gdal
Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 470]
Path to PROJ.4 shared files: (autodetected)

> sessionInfo()
R version 2.15.0 (2012-03-30)
Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)

locale:
[1] C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] rgdal_0.7-8 sp_0.9-98   rmacq_1.1-6

loaded via a namespace (and not attached):
[1] grid_2.15.0    lattice_0.20-6 tools_2.15.0


 ####
Note that my sp is not (quite) up to date, as Roger mentioned sp 0.9.99
somewhere in this long email chain.


-Don

-- 
Don MacQueen

Lawrence Livermore National Laboratory
7000 East Ave., L-627
Livermore, CA 94550
925-423-1062





On 5/18/12 9:17 AM, "de Larminat, Pierre" <pl at mpifg.de> wrote:

>Le 18 mai 2012 ? 18:11, Roger Bivand a ?crit :
>
>> On Fri, 18 May 2012, de Larminat, Pierre wrote:
>> 
>>> Le 18 mai 2012 ? 17:52, Roger Bivand a ?crit :
>>> 
>>>> On Fri, 18 May 2012, de Larminat, Pierre wrote:
>>>> 
>>>>> 
>>>>> 
>>>>> Le 18 mai 2012 ? 17:14, Roger Bivand a ?crit :
>>>>> 
>>>>>> On Fri, 18 May 2012, de Larminat, Pierre wrote:
>>>>>> 
>>>>>>> Hello,
>>>>>>> 
>>>>>>> I have the same problem than:
>>>>>>> [R-sig-Geo] rgdal package for mac
>>>>>>> Gabriele Cozzi gab.cozzi at gmail.com<http://gmail.com>
>>>>>>> Thu May 17 10:33:21 CEST 2012
>>>>>>> 
>>>>>>> I have already done:
>>>>>>> setRepositories(ind=1:2)
>>>>>>> install.packages("rgdal")
>>>>>>> as said on the CRAN page for rgdal.
>>>>>>> 
>>>>>>> I have restarted the computer and R.
>>>>>>> When I entered the lines again, I received the same message that I
>>>>>>>had received before:
>>>>>>> 
>>>>>>>> setRepositories(ind=1:2)
>>>>>>>> install.packages("rgdal")
>>>>>>> --- SVP s?lectionner un miroir CRAN pour cette session ---
>>>>>>> essai de l'URL
>>>>>>>'http://www.stats.ox.ac.uk/pub/RWin/bin/macosx/leopard/contrib/2.15/
>>>>>>>rgdal_0.7-8.tgz'
>>>>>>> Content type 'application/x-gzip' length 13810017 bytes (13.2 Mb)
>>>>>>> URL ouverte
>>>>>>> ==================================================
>>>>>>> downloaded 13.2 Mb
>>>>>>> 
>>>>>>> 
>>>>>>> Les packages binaires t?l?charg?s sont dans
>>>>>>> 
>>>>>>>/var/folders/zT/zTnmGA9q2RaOuE+F76E3E++++TI/-Tmp-//RtmpKnHXly/downlo
>>>>>>>aded_packages
>>>>>>>> library(rgdal)
>>>>>>> Le chargement a n?cessit? le package : sp
>>>>>> 
>>>>>> This does seem to imply that sp is necessary, doesn't it? Have you
>>>>>> installed sp? Messages are given to be read, rather than ignored.
>>>>>> 
>>>>>> Roger
>>>>>> 
>>>>> Yes I had installed sp. The message merely states that I had not
>>>>>charged the sp library and that R had to do it by itself. When I do
>>>>>run *library(sp)* in time, I still get:
>>>> 
>>>> OK. The next error message refers to your system having
>>>>"libcurl.4.dylib
>>>> provides version 6.0.0", but that the rgdal OSX binary requires >=
>>>>7.0.0:
>>>> 
>>>>> 
>>>>>>> Error in dyn.load(file, DLLpath = DLLpath, ...) :
>>>>>>> impossible de charger l'objet partag?
>>>>>>>'/Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgd
>>>>>>>al/libs/i386/rgdal.so':
>>>>>>> 
>>>>>>>dlopen(/Library/Frameworks/R.framework/Versions/2.15/Resources/libra
>>>>>>>ry/rgdal/libs/i386/rgdal.so, 6): Library not loaded:
>>>>>>>/usr/lib/libcurl.4.dylib
>>>>>>> Referenced from:
>>>>>>>/Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgda
>>>>>>>l/libs/i386/rgdal.so
>>>>>>> Reason: Incompatible library version: rgdal.so requires version
>>>>>>>7.0.0 or later, but libcurl.4.dylib provides version 6.0.0
>>>> 
>>>> ^^^^ here. Are you running an older OSX version?
>>>> 
>>>> Roger
>>>> 
>>> I am running R 2.15 on MacOS 10.6.8 and I do not know what
>>>libcurl.4.dylib is.
>> 
>> Please ask on R-sig-mac, or get local help; users may not know what
>>system 
>> resources are, but do suffer the consequences. The cause is probably
>>that 
>> the rgdal CRAN Extras OSX binary was built on 10.7, and you are running
>> 10.6 - the background for building on a newer system was given in an
>> earlier thread.
>> 
>> Roger
>> 
>
>OK, thank you for the advice and for the time that you have taken to help
>me.
>
>Pierre.
>
>>>> 
>>>>>>> Erreur : le chargement du package / espace de noms a ?chou? pour
>>>>>>>?rgdal?
>>>>>>>> 
>>>>>>> 
>>>>>>> Does anyone know how to solve this problem?
>>>>>>> Thank you very much,
>>>>>>> Pierre de Larminat.
>>>>>>> 
>>>>>>> 
>>>>>>> 
>>>>>>> Le 18 mai 2012 ? 15:45, Roger Bivand a ?crit :
>>>>>>> 
>>>>>>> On Fri, 18 May 2012, de Larminat, Pierre wrote:
>>>>>>> 
>>>>>>> Dear Prof. Bivand,
>>>>>>> 
>>>>>>> As I have trouble installing rgdal on my Macbook, I searched on
>>>>>>>some
>>>>>>> blog-posts by R-bloggers, and I tried to look for help on
>>>>>>>r-sig-geo. It
>>>>>>> seems that my message doesn't come through. Can you help me
>>>>>>>please? In
>>>>>>> any case, thank you for your efforts in developing rgdal. I have
>>>>>>>seen
>>>>>>> what others do with it. It is fascinating. Best regards, Pierre de
>>>>>>> Larminat.
>>>>>>> 
>>>>>>> You are subscribed as larminat at mpifg.de<mailto:larminat at mpifg.de>,
>>>>>>>and must post from that address.
>>>>>>> 
>>>>>>> Never search blogs, they are almost always misleading, and nobody
>>>>>>>takes
>>>>>>> responsibility for keeping the advice given up to date. Did you
>>>>>>>read the
>>>>>>> CRAN page for rgdal - it does explain how to install rgdal on OSX.
>>>>>>>You
>>>>>>> might also have searched the list archives (this question was
>>>>>>>answered
>>>>>>> yesterday), or googled "list:r-sig-geo rgdal Mac".
>>>>>>> 
>>>>>>> Roger Bivand
>>>>>>> 
>>>>>>> list admin.
>>>>>>> 
>>>>>>> 
>>>>>>> 
>>>>>>> - - -
>>>>>>> Pierre de Larminat
>>>>>>> Visiting doctoral fellow
>>>>>>> Max Planck Institute for the Study of Societies
>>>>>>> Paulstrasse 3, D-50676 K?ln, Germany
>>>>>>> office: +49.221.2767.222
>>>>>>> mobile: +49.152.521.704.83
>>>>>>> e-mail: larminat at mpifg.de<mailto:larminat at mpifg.de>
>>>>>>> 
>>>>>>> D?but du message r?exp?di? :
>>>>>>> 
>>>>>>> De : 
>>>>>>>"r-sig-geo-owner at r-project.org<mailto:r-sig-geo-owner at r-project.org>
>>>>>>>" 
>>>>>>><r-sig-geo-owner at r-project.org<mailto:r-sig-geo-owner at r-project.org>
>>>>>>>>
>>>>>>> Date : 18 mai 2012 15:28:54 HAEC
>>>>>>> ? : "de Larminat, Pierre" <pl at mpifg.de<mailto:pl at mpifg.de>>
>>>>>>> Objet : Installing rgdal on mac
>>>>>>> 
>>>>>>> You are not allowed to post to this mailing list, and your message
>>>>>>>has
>>>>>>> been automatically rejected.  If you think that your messages are
>>>>>>> being rejected in error, contact the mailing list owner at
>>>>>>> 
>>>>>>>r-sig-geo-owner at r-project.org<mailto:r-sig-geo-owner at r-project.org>.
>>>>>>> 
>>>>>>> 
>>>>>>> De : "de Larminat, Pierre" <pl at mpifg.de<mailto:pl at mpifg.de>>
>>>>>>> Date : 18 mai 2012 15:28:28 HAEC
>>>>>>> ? : "r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>"
>>>>>>><r-sig-geo at r-project.org<mailto:r-sig-geo at r-project.org>>
>>>>>>> Objet : Installing rgdal on mac
>>>>>>> 
>>>>>>> 
>>>>>>> Hello,
>>>>>>> 
>>>>>>> Working on MacOS X, I have trouble installing rgdal.
>>>>>>> 
>>>>>>> I am sorry to post about this problem, since others have probably
>>>>>>>asked the question earlier on this list, but there seem to be no
>>>>>>>search tool to look for the previous posts on the list.
>>>>>>> 
>>>>>>> Below is the R-output to my previous installation trials:
>>>>>>> 
>>>>>>> install.packages("rgdal")
>>>>>>> Message d'avis :
>>>>>>> package ?rgdal? is not available (for R version 2.15.0)
>>>>>>> setRepositories(ind=1:2)
>>>>>>> install.packages("rgdal")
>>>>>>> essai de l'URL
>>>>>>>'http://www.stats.ox.ac.uk/pub/RWin/bin/macosx/leopard/contrib/2.15/
>>>>>>>rgdal_0.7-8.tgz'
>>>>>>> Content type 'application/x-gzip' length 13810017 bytes (13.2 Mb)
>>>>>>> URL ouverte
>>>>>>> ==================================================
>>>>>>> downloaded 13.2 Mb
>>>>>>> 
>>>>>>> 
>>>>>>> Les packages binaires t?l?charg?s sont dans
>>>>>>> 
>>>>>>>/var/folders/zT/zTnmGA9q2RaOuE+F76E3E++++TI/-Tmp-//Rtmpu8X57c/downlo
>>>>>>>aded_packages
>>>>>>> library(rgdal)
>>>>>>> Error in dyn.load(file, DLLpath = DLLpath, ...) :
>>>>>>> impossible de charger l'objet partag?
>>>>>>>'/Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgd
>>>>>>>al/libs/i386/rgdal.so':
>>>>>>> 
>>>>>>>dlopen(/Library/Frameworks/R.framework/Versions/2.15/Resources/libra
>>>>>>>ry/rgdal/libs/i386/rgdal.so, 6): Library not loaded:
>>>>>>>/usr/lib/libcurl.4.dylib
>>>>>>> Referenced from:
>>>>>>>/Library/Frameworks/R.framework/Versions/2.15/Resources/library/rgda
>>>>>>>l/libs/i386/rgdal.so
>>>>>>> Reason: Incompatible library version: rgdal.so requires version
>>>>>>>7.0.0 or later, but libcurl.4.dylib provides version 6.0.0
>>>>>>> Erreur : le chargement du package / espace de noms a ?chou? pour
>>>>>>>?rgdal?
>>>>>>> 
>>>>>>> 
>>>>>>> Meanwhile, I have installed PROJ 4.8 and GDAL 1.9 Complete from
>>>>>>>http://www.kyngchaos.com/software:frameworks
>>>>>>> 
>>>>>>> but it doesn't help. When I try again with
>>>>>>> setRepositories(ind=1:2)
>>>>>>> install.packages("rgdal")
>>>>>>> 
>>>>>>> I still get the error message pasted above.
>>>>>>> 
>>>>>>> Can you help me?
>>>>>>> Thank you very much,
>>>>>>> 
>>>>>>> Pierre de Larminat.
>>>>>>> 
>>>>>>> 
>>>>>>> [[alternative HTML version deleted]]
>>>>>>> 
>>>>>>> 
>>>>>>> 
>>>>>>> 
>>>>>>> 
>>>>>>> 
>>>>>>> --
>>>>>>> Roger Bivand
>>>>>>> Department of Economics, NHH Norwegian School of Economics,
>>>>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>>>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>>>>>> e-mail: Roger.Bivand at nhh.no<mailto:Roger.Bivand at nhh.no>
>>>>>>> 
>>>>>>> 
>>>>>>> 	[[alternative HTML version deleted]]
>>>>>>> 
>>>>>>> 
>>>>>> 
>>>>>> --
>>>>>> Roger Bivand
>>>>>> Department of Economics, NHH Norwegian School of Economics,
>>>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>>>>> e-mail: Roger.Bivand at nhh.no
>>>>>> 
>>>>> 
>>>>> 
>>>> 
>>>> --
>>>> Roger Bivand
>>>> Department of Economics, NHH Norwegian School of Economics,
>>>> Helleveien 30, N-5045 Bergen, Norway.
>>>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>>>> e-mail: Roger.Bivand at nhh.no
>>> 
>>> 
>> 
>> -- 
>> Roger Bivand
>> Department of Economics, NHH Norwegian School of Economics,
>> Helleveien 30, N-5045 Bergen, Norway.
>> voice: +47 55 95 93 55; fax +47 55 95 95 43
>> e-mail: Roger.Bivand at nhh.no
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From omphalodes.verna at yahoo.com  Sun May 20 09:36:22 2012
From: omphalodes.verna at yahoo.com (Omphalodes Verna)
Date: Sun, 20 May 2012 00:36:22 -0700 (PDT)
Subject: [R-sig-Geo] image segmentation in R - forest stand delineation from
	LiDAR data
Message-ID: <1337499382.49359.YahooMailNeo@web124902.mail.ne1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120520/05ea585b/attachment.pl>

From piero.campa at gmail.com  Sun May 20 13:06:23 2012
From: piero.campa at gmail.com (piero campa)
Date: Sun, 20 May 2012 04:06:23 -0700 (PDT)
Subject: [R-sig-Geo] How to properly use rsaga.close.gaps()
Message-ID: <1337511983831-7567747.post@n2.nabble.com>

Dear list,

after reading through "Spatio-temporal prediction of daily temperatures
using time-series of MODIS LST images" (Hengl et al.,
http://dx.doi.org/10.1007/s00704-011-0464-2), I wanted to try out these SAGA
*grid_tools* modules to fill the gaps in my MODIS AOT datasets.

I tried to follow what is done in the related script
(http://spatial-analyst.net/book/HRtemp.R) but I think I am missing
something, since my filled output is just identical to my input grid.

I will report my steps by means of the usual /meuse/ dataset:

data(meuse.grid)

coordinates(meuse.grid) <- ~x+y
gridded(meuse.grid) <- TRUE
fullgrid(meuse.grid) <- TRUE

# Create some hole
meuse.grid$dist[meuse.grid$dist > .3] <- NA

# Input File for SAGA
writeGDAL(meuse.grid["dist"], "dist.sdat", "SAGA")

# Run SAGA utility
rsaga.get.usage(lib="grid_tools", module=7)
rsaga.geoprocessor(lib="grid_tools", module=7, param=list(INPUT="dist.sgrd",
RESULT="sp_dist.sgrd"))
# = rsaga.close.gaps("dist.sgrd", "sp_dist.sgrd")  ?

# Import SAGA output
meuse.grid$sp_dist <- readGDAL("sp_dist.sdat")$band1

# The new gap-filled grid is indentical to the input:
spplot(meuse.grid, zcol=c("dist", "sp_dist"))


In his script, Tomislav also specified an input mask grid:
meuse.grid$mask <- as.integer(ifelse(is.na(meuse.grid$dist), NA, 1)) # or
!isna() ?
writeGDAL(meuse.grid["mask"], "mask.sdat", "SAGA")
rsaga.geoprocessor(lib="grid_tools", module=7, param=list(INPUT="dist.sgrd",
MASK="mask.sgrd",  RESULT="sp_dist.sgrd"))

I tried to mask either the is.na() and !is.na() pixels, but still no
interpolation takes place.
Any help?

Thanks.

  Piero

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/How-to-properly-use-rsaga-close-gaps-tp7567747.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From alobolistas at gmail.com  Sun May 20 13:22:27 2012
From: alobolistas at gmail.com (Agustin Lobo)
Date: Sun, 20 May 2012 13:22:27 +0200
Subject: [R-sig-Geo] Landcover grd/gri Diva files in R
Message-ID: <CAG4NReJ_yazb-obd5mu3agL+kRO5gTaNFevgVOad5DHNjsbr2g@mail.gmail.com>

Hi!

I read LC grd files (from the DIVA server) into R through raster(),
but as far as I  can tell the
landcover table (in the gri file) is not imported. I would like to use
rsgdf < as(r,SpatialGridDataFrame)

but rsgdf at data has just the column of LC numeric codes, not the LC definitions-

Is there a function to read the gri file or should I make my own?

Thanks

Agus

PS. Example in http://www.diva-gis.org/data/cov/CRI_cov.zip


From b.rowlingson at lancaster.ac.uk  Sun May 20 20:57:02 2012
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Sun, 20 May 2012 19:57:02 +0100
Subject: [R-sig-Geo] Landcover grd/gri Diva files in R
In-Reply-To: <1a3b9a4592c14812a7d3f20d29faf1be@EX-1-HT0.lancs.local>
References: <1a3b9a4592c14812a7d3f20d29faf1be@EX-1-HT0.lancs.local>
Message-ID: <CANVKczOzE=eL8c28vi-EU8z2DRDNxfCB4haa-dBtuyCMCKsDfA@mail.gmail.com>

On Sun, May 20, 2012 at 12:22 PM, Agustin Lobo <alobolistas at gmail.com> wrote:
> Hi!
>
> I read LC grd files (from the DIVA server) into R through raster(),
> but as far as I ?can tell the
> landcover table (in the gri file) is not imported. I would like to use
> rsgdf < as(r,SpatialGridDataFrame)
>
> but rsgdf at data has just the column of LC numeric codes, not the LC definitions-
>
> Is there a function to read the gri file or should I make my own?

 Looking at the size of  the files, the .gri file contains the values
and the .grd contains the meta-data. The raster() function doesn't
care if you specify the .gri or the .grd, somehow it works out the
file format and gets the info from both of them. However, as you say,
its not reading in the labels...

 The .grd file is a text file in Windows .ini file format, and the
labels you want are in the [Legend] section:

[Legend]
Count=22
Color1=16384
Min1=1
Max1=1
Label1=Tree Cover, broadleaved, evergreen
Color2=32768
Min2=2
Max2=2
Label2=Tree Cover, broadleaved, deciduous, closed
Color3=32768
Min3=3
Max3=3

 etc...

Shouldn't be too hard to read that in with readLines, look for the
[Legend] section, and then get out the labels.

Someone had a quick hack at reading ini files here:

https://stat.ethz.ch/pipermail/r-help/2007-June/134055.html

but it fails on your example because of some spaces somewhere.

Don't readLines the .gri file! :)

Barryy


From alobolistas at gmail.com  Sun May 20 22:39:19 2012
From: alobolistas at gmail.com (Agustin Lobo)
Date: Sun, 20 May 2012 22:39:19 +0200
Subject: [R-sig-Geo] Landcover grd/gri Diva files in R
In-Reply-To: <CANVKczOzE=eL8c28vi-EU8z2DRDNxfCB4haa-dBtuyCMCKsDfA@mail.gmail.com>
References: <1a3b9a4592c14812a7d3f20d29faf1be@EX-1-HT0.lancs.local>
	<CANVKczOzE=eL8c28vi-EU8z2DRDNxfCB4haa-dBtuyCMCKsDfA@mail.gmail.com>
Message-ID: <CAG4NReJmXj4maMtP8tx+-MxTSqRQk8xZ2brdKQ9bBY7mEXjVLg@mail.gmail.com>

I confused the grd and the gri files, thanks for pointing it out.
But the question remains the same. Is there a function to read the
table with the legend from the grd file or should I make my own?
The best would be that, in case a couple of grd and gri files is
present, raster()
automatically created the table. Currently, I do not think raster()
reads anything from
the grd file, but I might be wrong.

Agus

2012/5/20 Barry Rowlingson <b.rowlingson at lancaster.ac.uk>:

> ?Looking at the size of ?the files, the .gri file contains the values
> and the .grd contains the meta-data. The raster() function doesn't
> care if you specify the .gri or the .grd, somehow it works out the
> file format and gets the info from both of them. However, as you say,
> its not reading in the labels...
>
> ?The .grd file is a text file in Windows .ini file format, and the
> labels you want are in the [Legend] section:
>
> [Legend]
> Count=22
> Color1=16384
> Min1=1
> Max1=1
> Label1=Tree Cover, broadleaved, evergreen
> Color2=32768
> Min2=2
> Max2=2
> Label2=Tree Cover, broadleaved, deciduous, closed
> Color3=32768
> Min3=3
> Max3=3
>
> ?etc...
>
> Shouldn't be too hard to read that in with readLines, look for the
> [Legend] section, and then get out the labels.
>
> Someone had a quick hack at reading ini files here:
>
> https://stat.ethz.ch/pipermail/r-help/2007-June/134055.html
>
> but it fails on your example because of some spaces somewhere.
>
> Don't readLines the .gri file! :)
>
> Barryy
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From b.rowlingson at lancaster.ac.uk  Mon May 21 00:50:16 2012
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Sun, 20 May 2012 23:50:16 +0100
Subject: [R-sig-Geo] Landcover grd/gri Diva files in R
In-Reply-To: <7ed72a12594e440ebae2bd400e19a774@EX-1-HT0.lancs.local>
References: <1a3b9a4592c14812a7d3f20d29faf1be@EX-1-HT0.lancs.local>
	<CANVKczOzE=eL8c28vi-EU8z2DRDNxfCB4haa-dBtuyCMCKsDfA@mail.gmail.com>
	<7ed72a12594e440ebae2bd400e19a774@EX-1-HT0.lancs.local>
Message-ID: <CANVKczPG68muzyRUvamjgw4Y=t3pyPmb5nVaq-Gq=XGq3ruLpQ@mail.gmail.com>

On Sun, May 20, 2012 at 9:39 PM, Agustin Lobo <alobolistas at gmail.com> wrote:
> I confused the grd and the gri files, thanks for pointing it out.
> But the question remains the same. Is there a function to read the
> table with the legend from the grd file or should I make my own?
> The best would be that, in case a couple of grd and gri files is
> present, raster()
> automatically created the table. Currently, I do not think raster()
> reads anything from
> the grd file, but I might be wrong.

 If raster read it, it would probably be present in the @legend slot
(which is where categorical GTiff colour palettes end up) but its
empty.

 Here's a couple of functions to get you started reading in those .grd files:

eqparse = function(s){
  key = gsub("=.*","",s)
  val = gsub("^[^=]*=","",s)
  m = cbind(key,val)
  rownames(m)=key
  m
}

readgrd <- function(f){
lines = readLines(f)
kv = eqparse(lines)
MinValue = as.numeric(kv["MinValue","val"])
MaxValue = as.numeric(kv["MaxValue","val"])

m = list()

for(v in MinValue:MaxValue){
  m[[v]]=kv[paste("Label",v,sep=""),"val"]
}
m
}

Just do m = readgrd("foo.grd") and you'll get back a list of labels
indexed by value. I don't know if you want to decode the colour values
too - they look like 3-byte integers, but the significant order of
red, green and blue isn't known to me.

There may be bugs. I'm not sure how well this will work if the colour
labels don't start at 1, for example. I think it will work, but the
list will start at '2' or whatever.

raster is clearly reading something from the .grd file, because
otherwise it can't tell the resolution of the .gri file. I can't read
it with readGDAL or get the gdal command-line tools to read it, so I'm
guessing raster is being pretty clever already in working out the file
format.

Barry


From saimabashir11 at yahoo.com  Mon May 21 01:44:18 2012
From: saimabashir11 at yahoo.com (Saima Bashir)
Date: Sun, 20 May 2012 16:44:18 -0700 (PDT)
Subject: [R-sig-Geo] Switching from Matlab to R
Message-ID: <1337557458.32924.YahooMailNeo@web111502.mail.gq1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120520/ce2c9e11/attachment.pl>

From mdsumner at gmail.com  Mon May 21 01:49:58 2012
From: mdsumner at gmail.com (Michael Sumner)
Date: Mon, 21 May 2012 09:49:58 +1000
Subject: [R-sig-Geo] Switching from Matlab to R
In-Reply-To: <1337557458.32924.YahooMailNeo@web111502.mail.gq1.yahoo.com>
References: <1337557458.32924.YahooMailNeo@web111502.mail.gq1.yahoo.com>
Message-ID: <CAAcGz98PpCyPdjSPfB6-_MVL1rDHvKCeyi8RWcAqVxq+b+UGmg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120521/e91ed755/attachment.pl>

From Roger.Bivand at nhh.no  Mon May 21 11:52:00 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Mon, 21 May 2012 11:52:00 +0200 (CEST)
Subject: [R-sig-Geo] Switching from Matlab to R
In-Reply-To: <CAAcGz98PpCyPdjSPfB6-_MVL1rDHvKCeyi8RWcAqVxq+b+UGmg@mail.gmail.com>
References: <1337557458.32924.YahooMailNeo@web111502.mail.gq1.yahoo.com>
	<CAAcGz98PpCyPdjSPfB6-_MVL1rDHvKCeyi8RWcAqVxq+b+UGmg@mail.gmail.com>
Message-ID: <alpine.LRH.2.02.1205211144050.16717@reclus.nhh.no>

On Mon, 21 May 2012, Michael Sumner wrote:

> You can write out to binary or text from Matlab and read that in with
> readBin or read.table, there is also the R.matlab package to read some .mat
> files directly.
>

If you mean (particularly sparse) spatial weights in the spatial 
regression sense, then in Matlab do for example:

[i,j,w] = find(weights);
wts = [i,j,w];
save -ascii wts.txt wts

and in R

library(spdep)
lw0 <- read.dat2listw("wts.txt")
lw <- nb2listw(lw0$neighbours, glist=lw0$weights, style="W")

If more general structures, follow Mike's suggestions.

Roger

>
>
> On Monday, May 21, 2012, Saima Bashir wrote:
>
>> I want to import weight matrix into R from Matlab. Is it possible? if yes
>> then how??
>>
>> Thanks
>>
>> Saima
>>
>>        [[alternative HTML version deleted]]
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org <javascript:;>
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>
>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From mathieu.rajerison at gmail.com  Mon May 21 18:02:42 2012
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Mon, 21 May 2012 18:02:42 +0200
Subject: [R-sig-Geo] image segmentation in R - forest stand delineation
 from LiDAR data
In-Reply-To: <1337499382.49359.YahooMailNeo@web124902.mail.ne1.yahoo.com>
References: <1337499382.49359.YahooMailNeo@web124902.mail.ne1.yahoo.com>
Message-ID: <CAGfc75=tdQLwJjHctW+26OnOZG08vwC0AGJw==-HpmNhJ8R0MQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120521/275fec4d/attachment.pl>

From ppanday at clarku.edu  Mon May 21 19:56:14 2012
From: ppanday at clarku.edu (Panday, Prajjwal)
Date: Mon, 21 May 2012 17:56:14 +0000
Subject: [R-sig-Geo] Extract area-average from netCDF using a vector
Message-ID: <C3A65516E00A294DA9B1DBF9474A0EA617D5BB3A@CH1PRD0310MB356.namprd03.prod.outlook.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120521/cd9e1836/attachment.pl>

From r.hijmans at gmail.com  Tue May 22 22:40:29 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Tue, 22 May 2012 13:40:29 -0700
Subject: [R-sig-Geo] Extract area-average from netCDF using a vector
In-Reply-To: <C3A65516E00A294DA9B1DBF9474A0EA617D5BB3A@CH1PRD0310MB356.namprd03.prod.outlook.com>
References: <C3A65516E00A294DA9B1DBF9474A0EA617D5BB3A@CH1PRD0310MB356.namprd03.prod.outlook.com>
Message-ID: <CANtt_hzg-=X3RbVEHLfY3kLK-rN=uSVHNJ_ZgsibVUsdebcz=Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120522/4f8ab81d/attachment.pl>

From robbymarrotte at gmail.com  Tue May 22 23:00:59 2012
From: robbymarrotte at gmail.com (Robby Marrotte)
Date: Tue, 22 May 2012 17:00:59 -0400
Subject: [R-sig-Geo] RPyGeo Importing and running user generated Toolboxes
Message-ID: <CABd5c44aa4tDs72HY9XAA2SjCNw5qwZRN--mb3LcrLj5AEiW3w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120522/373ba0eb/attachment.pl>

From brenning at uwaterloo.ca  Wed May 23 15:50:56 2012
From: brenning at uwaterloo.ca (Alexander Brenning)
Date: Wed, 23 May 2012 13:50:56 +0000
Subject: [R-sig-Geo] RPyGeo Importing and running user generated
 Toolboxes
Message-ID: <7751194102F32C41B664258D78FE5BC5114CCEB4@connmbx3>

Hello,

the problem seems to be that each rpygeo.geoprocessor call starts from scratch, i.e. each call has to set its environment (Extent, OverwriteOutput etc), check out any required extensions (e.g., Spatial Analyst, if needed), and apparently also import any required user-defined toolboxes.

This means that in your case the following line of Python code would have to be added to the Python script generated by your second rpygeo.geoprocessor call:

gp.ImportToolbox( "C:/landscape_genetics/Landscape_genetics.tbx", "landgen" )

I'm afraid you will have to tweak rpygeo.geoprocessor to accomplish this, i.e. define a function my.rpygeo.geoprocessor with additional argument
   custom.code = NULL
and add the following additional R code right before expr = paste(expr, "rpygeoresult = \"\"", "\n", sep = "")

  if (!is.null(custom.code))
    expr = paste(expr, custom.code, "\n", sep = "")

Then call this modified function with your custom.code argument:

my.rpygeo.geoprocessor("EucDistanceMatrix_landgen", c("sites", "FID",
"C:/data/output/", "euclidean.txt"), env=rpygeo.env, 
 custom.code = "gp.ImportToolbox( "C:/landscape_genetics/Landscape_genetics.tbx", "landgen" )")

I'm not sure about the forward slashes in custom.code, I believe both forward slashes and double backslashes may work.
Additional modifications would be needed to handle possible error messages from the custom.code call...

I haven't tested this proposed solution but I hope this will help.

Best,
  Alex



Date: Tue, 22 May 2012 17:00:59 -0400
From: Robby Marrotte <robbymarrotte at gmail.com>
To: r-sig-geo at r-project.org
Subject: [R-sig-Geo] RPyGeo Importing and running user generated
        Toolboxes

Hello everyone,

I spend the day learning how to use rpygeo and I learned how to use most
ArcGIS 10 function in R via the "rpygeo.processor" command. However, I
wanted to run a toolbox that I use almost constantly called landscape
genetic, you can find it
here<http://resources.arcgis.com/gallery/file/geoprocessing/details?entryID=CD84455E-1422-2418-348A-13F051488BD3>,
I used the following command to import the toolbox:

# Set wd
rpygeo.env<-rpygeo.build.env(python.path="C:/Python26/ArcGIS10.0",python.command="python.exe",
                             workspace="C:/data/input/", extent =
"C:/data/input/bound.shp", overwriteoutput = 1, cellsize=100)

# Import landgen toolbox
rpygeo.geoprocessor("ImportToolbox",
c("C:/landscape_genetics/Landscape_genetics.tbx", "landgen"),
env=rpygeo.env)

All it tells me now is Null, meaning that nothing bad or good happen I
guess... Now if I run one of the modules called Euclidean Distance Matrix:

rpygeo.geoprocessor("EucDistanceMatrix_landgen", c("sites", "FID",
"C:/data/output/", "euclidean.txt"), env=rpygeo.env)

It seems like it tries to run but I dont get any error message or anything
in my output folder. Has anybody tried importing a toolbox yet?

Thanks


_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo



From mathieu.rajerison at gmail.com  Wed May 23 16:43:23 2012
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Wed, 23 May 2012 16:43:23 +0200
Subject: [R-sig-Geo] plot.raster - rgb(0,0,0,x) - jenks intervals
Message-ID: <CAGfc75nmEdiVYgEFkBFTVbQt2pHurHwzqCf_RYwf-fcFDBP=BQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120523/c9f91403/attachment.pl>

From juantomas.sayago at gmail.com  Wed May 23 20:02:06 2012
From: juantomas.sayago at gmail.com (Juan Tomas Sayago)
Date: Wed, 23 May 2012 14:02:06 -0400
Subject: [R-sig-Geo] shapefile on the wrongly placed
Message-ID: <CAEOXpND7_xjNfEH+7BRDQZswxJy=H91eJfKDD5A68L-6dw+obw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120523/993ac552/attachment.pl>

From kurbyc at gvsu.edu  Wed May 23 20:24:27 2012
From: kurbyc at gvsu.edu (Christopher Kurby)
Date: Wed, 23 May 2012 18:24:27 +0000
Subject: [R-sig-Geo] bidimensional regression
Message-ID: <1B6319CC-E364-4F71-BD4F-76F7FE8001E5@gvsu.edu>

Hello everyone,

I noticed that there was a thread for this topic in 2008, but the issue doesn't look to have been solved. Out of curiosity, does anyone know of an r package or function designed to run bidimensional regressions as described by Friedman and Kohler (2003)? I have sets of eye-movements represented as coordinates in Cartesian space, and I wish to correlate them together.

Thanks in advance,
Chris


From macqueen1 at llnl.gov  Wed May 23 22:10:23 2012
From: macqueen1 at llnl.gov (MacQueen, Don)
Date: Wed, 23 May 2012 13:10:23 -0700
Subject: [R-sig-Geo] shapefile on the wrongly placed
In-Reply-To: <CAEOXpND7_xjNfEH+7BRDQZswxJy=H91eJfKDD5A68L-6dw+obw@mail.gmail.com>
Message-ID: <CBE2910D.99159%macqueen1@llnl.gov>

May we assume you are using R to do this?

 - Read it into R using an appropriate function from an R package. (I use
readOGR from rgdal)

 - Make sure that it is assigned the correct projection.

 - Transform it to the desired projection using spTransform()

This has always worked for me.
The help page for spTransform has examples.
  

-Don

-- 
Don MacQueen

Lawrence Livermore National Laboratory
7000 East Ave., L-627
Livermore, CA 94550
925-423-1062





On 5/23/12 11:02 AM, "Juan Tomas Sayago" <juantomas.sayago at gmail.com>
wrote:

>Dear list
>I have this shape file created on one location using a specific
>projection
>and when I try to put it into WGS1984 it appears in a different place
>where
>it should be. How do I fix it? What can I do?
>Juan
>
>-- 
>Juan Tom?s Sayago G?mez
>Graduate Research Assistant
>West Virginia University - RRI
>886 Chestnut Ridge Road, Room 520
>P.O. Box 6825
>Morgantown, WV 26506-6825
>
>	[[alternative HTML version deleted]]
>


From Roger.Bivand at nhh.no  Wed May 23 22:28:09 2012
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 23 May 2012 22:28:09 +0200 (CEST)
Subject: [R-sig-Geo] shapefile on the wrongly placed
In-Reply-To: <CAEOXpND7_xjNfEH+7BRDQZswxJy=H91eJfKDD5A68L-6dw+obw@mail.gmail.com>
References: <CAEOXpND7_xjNfEH+7BRDQZswxJy=H91eJfKDD5A68L-6dw+obw@mail.gmail.com>
Message-ID: <alpine.LRH.2.02.1205232224240.13166@reclus.nhh.no>

On Wed, 23 May 2012, Juan Tomas Sayago wrote:

> Dear list I have this shape file created on one location using a 
> specific projection and when I try to put it into WGS1984 it appears in 
> a different place where it should be. How do I fix it? What can I do? 
> Juan

Please show the input projection, you retrieve it with proj4string() in 
sp. Are you sure that it is correct? You have also not shown what you 
understand by WGS1984 - do you mean a datum shift from the input datum, or 
something else?

Hope this helps,

Roger

>
>

-- 
Roger Bivand
Department of Economics, NHH Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand at nhh.no


From gaspard.charrier at univ-bpclermont.fr  Thu May 24 15:00:41 2012
From: gaspard.charrier at univ-bpclermont.fr (Gaspard Charrier)
Date: Thu, 24 May 2012 15:00:41 +0200
Subject: [R-sig-Geo] How produce several maps with bubble()
Message-ID: <4FBE30F9.9060000@univ-bpclermont.fr>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120524/8c1b2198/attachment.pl>

From edzer.pebesma at uni-muenster.de  Thu May 24 15:16:12 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 24 May 2012 15:16:12 +0200
Subject: [R-sig-Geo] How produce several maps with bubble()
In-Reply-To: <4FBE30F9.9060000@univ-bpclermont.fr>
References: <4FBE30F9.9060000@univ-bpclermont.fr>
Message-ID: <4FBE349C.8010200@uni-muenster.de>



On 05/24/2012 03:00 PM, Gaspard Charrier wrote:
> Hi!
> 
> I am a beginner on R, especially on programming. I'm trying to produce 
> several maps by page with the bubble function of the sp package. But I 
> encounter some difficulties to customize the bubble function.
> 
> I saw that classic function like par(mfrow=) or layout() don't work with 
> lattice graphics. So, I used the split parameter to define the position 
> of each map. But as I working on many variables, this solution isn't 
> really convenient. After some research, it seems that I should use the 
> panel function inside the bubble one. But my attempts failed with an 
> error like the "argument matches multiple formal arguments".
> 
> I use the meuse dataset as example of my scheme. I show you my script, 
> maybe it could help to find where I'm wrong.
> 
> |library(sp)
> library(lattice)
> data(meuse)
> coordinates(meuse) <- ~x+y
> test<-meuse[,1:4]
> 
> for (i in 1:4)
> { carte<-bubble(test,zcol=i,fill=TRUE,maxsize=2,do.sqrt=TRUE,col=2)
> }
> 
> plot(carte, index.cond = list(rep(1,4)),
>       layout = c(2, 2),
>       panel = function(x, y, ...)
>       {
>          panel.bubble(x,y,...)
> })|
> 
> |# This gives the error:| |Error in plot.trellis(carte, index.cond = 
> list(rep(1, 4)), layout = c(2,  : argument 4 matches multiple formal 
> arguments|
> 
> So the panel function don't works well in my script, but I don't 
> understand why (I also try to change panel.bubble by panel.plot, without 
> effects).

panel is not an argument of plot (see ?plot.trellis). You want to
specify it as an argument to bubble().


> 
> As I said before, my dataset contains many variables. So I add new 
> variables to the meuse dataset to have a more relevant dataset for my 
> problem.
> 
> |meuse1<-meuse[,1:6]
> meuse1$ion1<-meuse1$cadmium
> meuse1$ion2<-meuse1$copper
> meuse1$ion3<-meuse1$lead
> meuse1$ion4<-meuse1$zinc
> meuse1$ion5<-meuse1$cadmium
> meuse1$ion6<-meuse1$copper
> meuse1$ion7<-meuse1$lead
> meuse1$ion8<-meuse1$zinc
> meuse1$ion9<-meuse1$cadmium
> meuse1$ion10<-meuse1$copper
> meuse1$ion11<-meuse1$lead
> meuse1$ion12<-meuse1$zinc
> coordinates(meuse1) <- ~x+y
> test2<-meuse1[,1:16]|
> 
> I desire to create my maps with the bubble function, with a presentation 
> of six maps by page (3 lines and 2 columns). I tried to read the code of 
> the bubble function but I'm not able to understand what are doing the 
> different lines. Do you know where I could found explanations of the 
> bubble code? Or if you have any idea to improve my script, I'll be grateful.

bubble tries to deal with all the arguments it can get. Read the
documentation of ?bubble, and try to understand all arguments. If in the
body of bubble a function is called that you don't understand, read its
documentation.

> 
> Any direction (or any documentation where I could find something to go 
> ahead) would be welcome.
> 
> 
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From mspinola10 at gmail.com  Thu May 24 15:46:08 2012
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Thu, 24 May 2012 07:46:08 -0600
Subject: [R-sig-Geo] Making a raster from a shapefile using function
 rasterize with a categoric field
Message-ID: <CABkCotTRRCPcVPQgBC871Vh9mJLgu_KNGLgO6v2ZVc0a2r=htw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120524/e957a99c/attachment.pl>

From mathieu.rajerison at gmail.com  Thu May 24 16:24:45 2012
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Thu, 24 May 2012 16:24:45 +0200
Subject: [R-sig-Geo] plot.raster - rgb(0,0,0,x) - jenks intervals
In-Reply-To: <CAGfc75nmEdiVYgEFkBFTVbQt2pHurHwzqCf_RYwf-fcFDBP=BQ@mail.gmail.com>
References: <CAGfc75nmEdiVYgEFkBFTVbQt2pHurHwzqCf_RYwf-fcFDBP=BQ@mail.gmail.com>
Message-ID: <CAGfc75kocmU93HkK=vcZ7ThwLrk9GvOOGXiA9dra0QcYyvm_xA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120524/b61a64c2/attachment.pl>

From mathieu.rajerison at gmail.com  Thu May 24 16:27:46 2012
From: mathieu.rajerison at gmail.com (Mathieu Rajerison)
Date: Thu, 24 May 2012 16:27:46 +0200
Subject: [R-sig-Geo] Making a raster from a shapefile using function
 rasterize with a categoric field
In-Reply-To: <CABkCotTRRCPcVPQgBC871Vh9mJLgu_KNGLgO6v2ZVc0a2r=htw@mail.gmail.com>
References: <CABkCotTRRCPcVPQgBC871Vh9mJLgu_KNGLgO6v2ZVc0a2r=htw@mail.gmail.com>
Message-ID: <CAGfc75muykvtZP-a9FpJKRem5LqcUyVN=v+275wpiY=Cjjh+Zg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120524/5d99c214/attachment.pl>

From mauricio.zambrano at jrc.ec.europa.eu  Thu May 24 16:35:43 2012
From: mauricio.zambrano at jrc.ec.europa.eu (Mauricio Zambrano-Bigiarini)
Date: Thu, 24 May 2012 16:35:43 +0200
Subject: [R-sig-Geo] writeOGR: ID field for exporting a KML file
Message-ID: <4FBE473F.6090702@jrc.ec.europa.eu>

Dear list,

I'm trying to export a point shapefile into a KML file by using the 
'writeOGR' function of the 'rgdal' package.

Everything works fine, except that I'm not able to select the field to 
be used for labelling the KML points from the table of the original 
shapefile.

I'm able to select the ID field to be used in the KML file by using the 
'ogr2ogr' program of GDAL, but I would like to be able to do the same 
directly within R with the 'writeOGR' function.

Below you can find a reproducible example:

---------------- START ---------------------
require(rgdal)

# creating the initial shapefile for the example
cities <- readOGR(system.file("vectors", package = "rgdal")[1], "cities")

writeOGR(cities, "cities.shp", "cities", driver="ESRI Shapefile")


OGRstring <- paste("ogr2ogr -f KML ", "cities.kml", " ", "cities.shp", " 
-dsco NameField=COUNTRY", sep = "")
system(OGRstring)

---------------- END ---------------------

I would like to achieve the same final KML file, but using:

   writeOGR(cities, dsn="cities2.kml", layer="cities", driver="KML" )


but I don't know how to pass the " -dsco NameField=COUNTRY" argument to 
the 'writeOGR' function.


Any help will be very much appreciated.


  sessionInfo()
R version 2.15.0 (2012-03-30)
Platform: x86_64-redhat-linux-gnu (64-bit)

locale:
  [1] LC_CTYPE=en_GB.utf8       LC_NUMERIC=C
  [3] LC_TIME=en_GB.utf8        LC_COLLATE=en_GB.utf8
  [5] LC_MONETARY=en_GB.utf8    LC_MESSAGES=en_GB.utf8
  [7] LC_PAPER=C                LC_NAME=C
  [9] LC_ADDRESS=C              LC_TELEPHONE=C
[11] LC_MEASUREMENT=en_GB.utf8 LC_IDENTIFICATION=C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] rgdal_0.7-11 sp_0.9-99

loaded via a namespace (and not attached):
[1] grid_2.15.0    lattice_0.20-6 tools_2.15.0




Thanks in advance,

Mauricio Zambrano-Bigiarini

-- 
====================================================
Water Resources Unit
Institute for Environment and Sustainability (IES)
Joint Research Centre (JRC), European Commission
webinfo    : http://floods.jrc.ec.europa.eu/
====================================================
DISCLAIMER:\ "The views expressed are purely those of th...{{dropped:11}}


From saimabashir11 at yahoo.com  Thu May 24 21:08:35 2012
From: saimabashir11 at yahoo.com (Saima Bashir)
Date: Thu, 24 May 2012 12:08:35 -0700 (PDT)
Subject: [R-sig-Geo] Need help in R
Message-ID: <1337886515.75549.YahooMailNeo@web111509.mail.gq1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120524/0a7c1853/attachment.pl>

From sarah.goslee at gmail.com  Thu May 24 21:13:51 2012
From: sarah.goslee at gmail.com (Sarah Goslee)
Date: Thu, 24 May 2012 15:13:51 -0400
Subject: [R-sig-Geo] Need help in R
In-Reply-To: <1337886515.75549.YahooMailNeo@web111509.mail.gq1.yahoo.com>
References: <1337886515.75549.YahooMailNeo@web111509.mail.gq1.yahoo.com>
Message-ID: <CAM_vju=7qpNYhEYW9o-TKxu1W7AvuhODg+ZSXeRiYN_bBWhXzw@mail.gmail.com>

Hi,

It looks like spse isn't on CRAN, but that you can get it straight from R Forge:
https://r-forge.r-project.org/R/?group_id=1117

Sarah

On Thu, May 24, 2012 at 3:08 PM, Saima Bashir <saimabashir11 at yahoo.com> wrote:
> I have to use package "spse" to analyze my model. I am using R2.14.2 and was unable to find this package in R 2.14.2. Can some one tell me please if I can use any previous version of R. I have to use packages spse, spdep, and sphet in one version.
>
> Thank you
>
> Saima
>


-- 
Sarah Goslee
http://www.functionaldiversity.org


From juantomas.sayago at gmail.com  Thu May 24 21:30:16 2012
From: juantomas.sayago at gmail.com (Juan Tomas Sayago)
Date: Thu, 24 May 2012 15:30:16 -0400
Subject: [R-sig-Geo] shapefile on the wrongly placed
In-Reply-To: <alpine.LRH.2.02.1205232224240.13166@reclus.nhh.no>
References: <CAEOXpND7_xjNfEH+7BRDQZswxJy=H91eJfKDD5A68L-6dw+obw@mail.gmail.com>
	<alpine.LRH.2.02.1205232224240.13166@reclus.nhh.no>
Message-ID: <CAEOXpNBrK9r18Hjm3PHR7ah1ZuSRVhuqhkW6W4MiWoMwff_NZA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120524/81369c9d/attachment.pl>

From sglish at hotmail.com  Thu May 24 22:54:01 2012
From: sglish at hotmail.com (Chris English)
Date: Thu, 24 May 2012 16:54:01 -0400
Subject: [R-sig-Geo] neighborly ordering of spdf data/spacetime
Message-ID: <SNT117-W4765E81C1BBAD6103B6E18C5000@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120524/6ebda4ac/attachment.pl>

From mspinola10 at gmail.com  Thu May 24 23:16:40 2012
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Thu, 24 May 2012 15:16:40 -0600
Subject: [R-sig-Geo] Projecting a SpatialPointsDataFrame
Message-ID: <CABkCotThX5mBGwQA4jNmLHGcpZrOcWyZiQTVj-oZtKkZb3rPvA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120524/b7448da0/attachment.pl>

From r.hijmans at gmail.com  Thu May 24 23:28:14 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 24 May 2012 14:28:14 -0700
Subject: [R-sig-Geo] Projecting a SpatialPointsDataFrame
In-Reply-To: <CABkCotThX5mBGwQA4jNmLHGcpZrOcWyZiQTVj-oZtKkZb3rPvA@mail.gmail.com>
References: <CABkCotThX5mBGwQA4jNmLHGcpZrOcWyZiQTVj-oZtKkZb3rPvA@mail.gmail.com>
Message-ID: <CANtt_hwpCk0yyf-iRkX6vRx0G_+1cB0z3YnQCSTWX5vdqqmXMw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120524/bc595c21/attachment.pl>

From r.hijmans at gmail.com  Thu May 24 23:32:52 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 24 May 2012 14:32:52 -0700
Subject: [R-sig-Geo] neighborly ordering of spdf data/spacetime
In-Reply-To: <SNT117-W4765E81C1BBAD6103B6E18C5000@phx.gbl>
References: <SNT117-W4765E81C1BBAD6103B6E18C5000@phx.gbl>
Message-ID: <CANtt_hyJuQE8nCFOAaK7=wSOWO8ATCKcgfsAUWU=q5S_HXYwNw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120524/5c0ad68a/attachment.pl>

From mspinola10 at gmail.com  Fri May 25 00:25:32 2012
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Thu, 24 May 2012 16:25:32 -0600
Subject: [R-sig-Geo] Projecting a SpatialPointsDataFrame
In-Reply-To: <CANtt_hwpCk0yyf-iRkX6vRx0G_+1cB0z3YnQCSTWX5vdqqmXMw@mail.gmail.com>
References: <CABkCotThX5mBGwQA4jNmLHGcpZrOcWyZiQTVj-oZtKkZb3rPvA@mail.gmail.com>
	<CANtt_hwpCk0yyf-iRkX6vRx0G_+1cB0z3YnQCSTWX5vdqqmXMw@mail.gmail.com>
Message-ID: <CABkCotQY1VJ-iV2fk=sV5GHaxw8b10RXMFSwvXzODmqfwbUByg@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120524/4a28dd83/attachment.pl>

From piero.campa at gmail.com  Fri May 25 09:51:33 2012
From: piero.campa at gmail.com (Piero Campalani)
Date: Fri, 25 May 2012 09:51:33 +0200
Subject: [R-sig-Geo] How to properly use rsaga.close.gaps()
In-Reply-To: <1337511983831-7567747.post@n2.nabble.com>
References: <1337511983831-7567747.post@n2.nabble.com>
Message-ID: <CAMp9JaMbgGEXPVO0m0jcPYHeAofQxvppS=RK5MiQF17VHyBguA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120525/7d7a6cf0/attachment.pl>

From edzer.pebesma at uni-muenster.de  Fri May 25 10:48:56 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 25 May 2012 10:48:56 +0200
Subject: [R-sig-Geo] neighborly ordering of spdf data/spacetime
In-Reply-To: <SNT117-W4765E81C1BBAD6103B6E18C5000@phx.gbl>
References: <SNT117-W4765E81C1BBAD6103B6E18C5000@phx.gbl>
Message-ID: <4FBF4778.6070003@uni-muenster.de>

Chris, I don't exactly understand why the ordering of your polygons
matter. Do the overlap, when plotting them?

On 05/24/2012 10:54 PM, Chris English wrote:
> 
> Hello,
> I am exploring some US county level housing data.  I started with New Jersey and built a SPDF and subsequently a STFDF.  Data and spatial were in alphabetical order that madematching straight forward.  
> The problem arises that alphabetically named spatial attributes, i.e. atlantic, bergen (counties),are not close physically, indeed, often not neighbors.
> When trying to plot a variable of interest among some neighboring counties instead of the wholestate, hudson, bergen, essex, for example, many other counties have to be plotted because the SPDF was created in alphabetical order.
> I've spent the afternoon looking at spdep and deriving various neighbor, for example:
>  > nj_cty_hu_nb <- poly2nb(nj_cty_2.spdf)> summary(nj_cty_hu_nb)Neighbour list object:Number of regions: 21 Number of nonzero links: 82 Percentage nonzero weights: 18.5941 Average number of links: 3.904762 Link number distribution:
> 2 3 4 5 6 7 3 5 7 4 1 1 3 least connected regions:cape may hudson salem with 2 links1 most connected region:morris with 7 links
> Basically I'm wondering if someone can suggest how I might go back and recreate my spatial polygonsobject ordered by a more optimal neighbor approach and thence construct a new spdf based upon amore neighborly order than a-z.  
> Thanks in advance,Chris
> 
>    		 	   		  
> 	[[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From E.Couce at bristol.ac.uk  Fri May 25 16:26:04 2012
From: E.Couce at bristol.ac.uk (Elena Couce)
Date: Fri, 25 May 2012 15:26:04 +0100
Subject: [R-sig-Geo] grid interpolation with readGDAL
In-Reply-To: <F47AB8D5-973B-44E7-A371-2592A51D74C4@bristol.ac.uk>
References: <349899C1-2043-4340-8D80-086585B03F74@bristol.ac.uk>
	<F47AB8D5-973B-44E7-A371-2592A51D74C4@bristol.ac.uk>
Message-ID: <4FB8AF14-A398-4950-B9D2-4426433759D2@bristol.ac.uk>

Hello,

I was wondering if anybody knew which method/algorithm readGDAL uses for interpolating a grid when the 'output.dim' parameter doesn't match 'region.dim' (ie, when the resolution requested doesn't match the one being read). readGDAL's documentation only says this uses "GDAL's method to take care of image decimation / replication".

Many thanks,
Elena


From benny.borremans at ua.ac.be  Fri May 25 19:13:53 2012
From: benny.borremans at ua.ac.be (BennyB)
Date: Fri, 25 May 2012 10:13:53 -0700 (PDT)
Subject: [R-sig-Geo] extract by attributes from raster-image to polygons
Message-ID: <1337966033027-7576826.post@n2.nabble.com>

Dear Geo List, 

Before I ask my question let me apologize for my lack of knowledge about
spatial information processing in R, being merely a field biologist.. 

What I am trying to achieve is the quantification of a bunch of marks
(rodent scent marks) in a picture (jpeg - 
http://r-sig-geo.2731867.n2.nabble.com/file/n7576826/P1020393.JPG
P1020393.JPG ). 
This means I need to know how many marks there are, and what each mark's
area is. 

I manage to import the image and to extract only the marks using an "extract
by attributes" of the three RGB band values of the image. 
This gives me a raster layer with values 1 for the marks I want, and values
0 for everything else. 
I then use the rasterToPolygons function, which can convert the raster file
to a Spatial Polygon Dataframe. 

My problem now is the following: 
The rasterToPolygons function gives me either one polygon for each pixel
value in the raster image (dissolve=FALSE), or one multipolygon that
contains all the marks (dissolve=TRUE). 
I then do not manage to either aggregate the many polygons into one polygon
for each mark, or to separate the multipolygon into many polygons that each
represent a mark. 
For the former I have tried using the unionSpatialPolygons function, but
this again gives me only one big multipolygon instead of one polygon for
each mark. 

I have been looking like crazy on the internet and in manuals, but being
having a big lack of knowledge of the precise terminology of GIS processes,
this has been proving fruitless. 

Probably it is something very trivial I am missing, so if anybody can point
me in the right direction I would be extremely grateful! 

Many thanks, 

Benny 

Below you can see the script I have been using, and attached you can find
the original jpg image of the marks. 
---------------- 

library(raster);library(maptools) 
im=brick("P1020393.JPG") 
extract=(im[[1]]>50)&(im[[2]]>180)&(im[[3]]>220) 

# using the dissolve=T option 
poly_dissolve=rasterToPolygons(extract,fun=function(x){x==1},dissolve=T) 
# this gives me one big multipolygon and not one polygon for each mark 

# using the dissolve=F option 
poly_no_dissolve=rasterToPolygons(extract,fun=function(x){x==1},dissolve=F) 
# this gives me one polygon for each pixel having value=1 
# I then try to create aggregate those polygons, which again gives me only
one multipolygon 
uni_poly=unionSpatialPolygons(poly_no_dissolve,cut(pol_no_dissolve[,1],
quantile(pol_no_dissolve[,1]), include.lowest=TRUE))) 

-----------------
http://r-sig-geo.2731867.n2.nabble.com/file/n7576826/P1020393.JPG
P1020393.JPG 

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/extract-by-attributes-from-raster-image-to-polygons-tp7576826.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From mdsumner at gmail.com  Sat May 26 06:23:42 2012
From: mdsumner at gmail.com (Michael Sumner)
Date: Sat, 26 May 2012 14:23:42 +1000
Subject: [R-sig-Geo] grid interpolation with readGDAL
In-Reply-To: <4FB8AF14-A398-4950-B9D2-4426433759D2@bristol.ac.uk>
References: <349899C1-2043-4340-8D80-086585B03F74@bristol.ac.uk>
	<F47AB8D5-973B-44E7-A371-2592A51D74C4@bristol.ac.uk>
	<4FB8AF14-A398-4950-B9D2-4426433759D2@bristol.ac.uk>
Message-ID: <CAAcGz9-yY5WTy04t_0C4gb8qJcWN_X7nv7RkQ4XqgQt31zbVyA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120526/4f7782d2/attachment.pl>

From sglish at hotmail.com  Sat May 26 16:21:25 2012
From: sglish at hotmail.com (Chris English)
Date: Sat, 26 May 2012 10:21:25 -0400
Subject: [R-sig-Geo] neighborly ordering of spdf data/spacetime
In-Reply-To: <CANtt_hyJuQE8nCFOAaK7=wSOWO8ATCKcgfsAUWU=q5S_HXYwNw@mail.gmail.com>
References: <SNT117-W4765E81C1BBAD6103B6E18C5000@phx.gbl>,
	<CANtt_hyJuQE8nCFOAaK7=wSOWO8ATCKcgfsAUWU=q5S_HXYwNw@mail.gmail.com>
Message-ID: <SNT117-W296FED0DF6557481212BF7C5060@phx.gbl>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120526/ec74f56b/attachment.pl>

From mspinola10 at gmail.com  Sat May 26 19:17:29 2012
From: mspinola10 at gmail.com (=?ISO-8859-1?Q?Manuel_Sp=EDnola?=)
Date: Sat, 26 May 2012 11:17:29 -0600
Subject: [R-sig-Geo] Making a raster from a shapefile using function
 rasterize with a categoric field
In-Reply-To: <CAGfc75muykvtZP-a9FpJKRem5LqcUyVN=v+275wpiY=Cjjh+Zg@mail.gmail.com>
References: <CABkCotTRRCPcVPQgBC871Vh9mJLgu_KNGLgO6v2ZVc0a2r=htw@mail.gmail.com>
	<CAGfc75muykvtZP-a9FpJKRem5LqcUyVN=v+275wpiY=Cjjh+Zg@mail.gmail.com>
Message-ID: <CABkCotRUx4Uk-iquu78WEYpzfxZsOstfYakSARS4OCJ+08SD-Q@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120526/c0f118ff/attachment.pl>

From saimabashir11 at yahoo.com  Sun May 27 02:08:39 2012
From: saimabashir11 at yahoo.com (Saima Bashir)
Date: Sat, 26 May 2012 17:08:39 -0700 (PDT)
Subject: [R-sig-Geo] Simultaneous model
Message-ID: <1338077319.28301.YahooMailNeo@web111513.mail.gq1.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120526/80ecbc22/attachment.pl>

From HodgessE at uhd.edu  Sun May 27 05:42:24 2012
From: HodgessE at uhd.edu (Hodgess, Erin)
Date: Sat, 26 May 2012 22:42:24 -0500
Subject: [R-sig-Geo] [O/T] pixel question
Message-ID: <586A4828D7AAA04CA9B258C50A28DA200BF592A3@BALI.uhd.campus>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120526/0456646b/attachment.pl>

From roman.lustrik at gmail.com  Sun May 27 08:15:07 2012
From: roman.lustrik at gmail.com (=?UTF-8?Q?Roman_Lu=C5=A1trik?=)
Date: Sun, 27 May 2012 08:15:07 +0200
Subject: [R-sig-Geo] Simultaneous model
In-Reply-To: <1338077319.28301.YahooMailNeo@web111513.mail.gq1.yahoo.com>
References: <1338077319.28301.YahooMailNeo@web111513.mail.gq1.yahoo.com>
Message-ID: <CAHT1vpjJixCC8iornFXqdCAcBMU4nyWha78EbLdxjaJ_PT1KQA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120527/18dfda48/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Sun May 27 08:56:35 2012
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Sun, 27 May 2012 07:56:35 +0100
Subject: [R-sig-Geo] [O/T] pixel question
In-Reply-To: <2dd70b1fe2dd4c78afa19c0fc539f799@EX-1-HT0.lancs.local>
References: <2dd70b1fe2dd4c78afa19c0fc539f799@EX-1-HT0.lancs.local>
Message-ID: <CANVKczPzEZUR7t-5-KQFObpuJ1XR5XFhdrMuZwQiT5Ux+YSRow@mail.gmail.com>

On Sun, May 27, 2012 at 4:42 AM, Hodgess, Erin <HodgessE at uhd.edu> wrote:
> Dear Geo People:
>
> I tried to look this up on the Internet, but couldn't really find my answer.
>
> If a satellite has 16 km resolution, how many pixels/megapixels is it using, please?
>

 A satellite image (as a geoTIFF or jpg or other raster file) will
have as many pixels as the width of the image in km divided by the
pixel resolution of the image.

 The number of megapixels in the sensor is something the satellite
company know, and might be unrelated to the number of pixels in
supplied imagery since often it will be montaged or processed.

 Note that your final imagery might not have a pixel resolution the
same as the satellite's quoted resolution due to processing.

 So its not as simple as with digital cameras for ordinary human photography!

Barry


From sarah.goslee at gmail.com  Sun May 27 12:09:11 2012
From: sarah.goslee at gmail.com (Sarah Goslee)
Date: Sun, 27 May 2012 06:09:11 -0400
Subject: [R-sig-Geo] Simultaneous model
In-Reply-To: <CAHT1vpjJixCC8iornFXqdCAcBMU4nyWha78EbLdxjaJ_PT1KQA@mail.gmail.com>
References: <1338077319.28301.YahooMailNeo@web111513.mail.gq1.yahoo.com>
	<CAHT1vpjJixCC8iornFXqdCAcBMU4nyWha78EbLdxjaJ_PT1KQA@mail.gmail.com>
Message-ID: <61B54522-E556-4495-90F5-A7B74350A8BD@gmail.com>

Precisely. You're missing the final closing parenthesis, and you've misspelled TRUE at least once. The proper tools will help with that, even without diving into a full IDE. Any text editor intended for programmers will match parentheses and highlight reserved words.

Sarah

On May 27, 2012, at 2:15 AM, Roman Lu?trik <roman.lustrik at gmail.com> wrote:

> You are probably missing a close bracket. You could try one of developer's
> environments that can handle code completion, match brackets, code folding
> and much more. From top of my head, you can try ESS, RStudio and Eclipse +
> StatET.
> 
> 
> Cheers,
> Roman
> 
> 
> 
> On Sun, May 27, 2012 at 2:08 AM, Saima Bashir <saimabashir11 at yahoo.com>wrote:
> 
>> Hi,
>> 
>> 
>> I want to analyze Simultaneous equation mode. I had weight matrix imported
>> from Matlab as read.table. whenever, I type codes and hit enter i get +
>> sign. I have four equations in my model. Can any one please tell if I have
>> problem in codes. Codes are:
>> se <- spsegm(formula, data = pdata, w = W.txt, panel = TRUE, lags = list
>> (c(TRUE, FALSE, FALSE, FALSE), c(FALSE, TRUE, FALSE, FALSE), c(FALSE,
>> FALSE, TRUE, FALSE), c(FALSE, FALSE, FALSE, TRUE)), errors = list(c(FALSE,
>> TRUE, TRUE, TURE), c(TRUE, FALSE, TRUE, TRUE), c(TRUE, TRUE, FALSE, TRUE),
>> c(TRUE, TRUE, TRUE, FALSE)), endogenous = list(c(FALSE, TRUE, TRUE, TRUE),
>> c(TRUE, FALSE, TURE, TRUE), c(TRUE, TRUE, FALSE, TRUE), c(TRUE, TRUE, TRUE,
>> FALSE))
>> 
>> 
>> Thanks
>> 
>> Saima
>> 
>>       [[alternative HTML version deleted]]
>> 
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>> 
> 
> 
> 
> -- 
> In God we trust, all others bring data.
> 
>    [[alternative HTML version deleted]]
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From Bastien.Ferland-Raymond at mrnf.gouv.qc.ca  Mon May 28 16:36:05 2012
From: Bastien.Ferland-Raymond at mrnf.gouv.qc.ca (Bastien.Ferland-Raymond at mrnf.gouv.qc.ca)
Date: Mon, 28 May 2012 10:36:05 -0400
Subject: [R-sig-Geo] cost distance buffer?
Message-ID: <161DC602615F6943A19BAEA3DBF2E4B9018C0E1D3293@HARFANG.intranet.mrn.gouv>

Hello R people

I want to create a buffer around shapelines that would go around obstacle like shown in that figure:

https://www.dropbox.com/s/8qhkj6atkfllzky/unreachable_buffer.jpg

Here is the idea: I have field teams that cannot walk more than 1.5 km away from a road.  I need to know what part of the territory is accessible and what part isn't.  I cannot do a simple buffer as the other side of the lake isn't really accessible by walking.  Anybody knows if it's possible to do in R?

It's been done a couple of years ago in ArcINFO but we can't know how because the code is hidden.  However it was using raster, so it's maybe a hint of a solution.

Any ideas would be greatly appreciated!
Thanks!

Bastien Ferland-Raymond, M.Sc. Stat., M.Sc. Biol.
Division des orientations et projets sp?ciaux
Direction des inventaires forestiers
Minist?re des Ressources naturelles et de la Faune


From jacobvanetten at yahoo.com  Mon May 28 16:55:51 2012
From: jacobvanetten at yahoo.com (Jacob van Etten)
Date: Mon, 28 May 2012 15:55:51 +0100 (BST)
Subject: [R-sig-Geo] cost distance buffer?
In-Reply-To: <161DC602615F6943A19BAEA3DBF2E4B9018C0E1D3293@HARFANG.intranet.mrn.gouv>
References: <161DC602615F6943A19BAEA3DBF2E4B9018C0E1D3293@HARFANG.intranet.mrn.gouv>
Message-ID: <1338216951.11656.YahooMailNeo@web29706.mail.ird.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120528/b9908d40/attachment.pl>

From b.rowlingson at lancaster.ac.uk  Mon May 28 17:15:19 2012
From: b.rowlingson at lancaster.ac.uk (Barry Rowlingson)
Date: Mon, 28 May 2012 16:15:19 +0100
Subject: [R-sig-Geo] cost distance buffer?
In-Reply-To: <e20c2a785e9b4376842e588a41f282ba@EX-1-HT0.lancs.local>
References: <161DC602615F6943A19BAEA3DBF2E4B9018C0E1D3293@HARFANG.intranet.mrn.gouv>
	<e20c2a785e9b4376842e588a41f282ba@EX-1-HT0.lancs.local>
Message-ID: <CANVKczMeBnfyaYChx3tQnQ+3o6Dy03cX594FahHmpe6xr70-Xw@mail.gmail.com>

On Mon, May 28, 2012 at 3:55 PM, Jacob van Etten
<jacobvanetten at yahoo.com> wrote:
> gridDistance in package raster would be the first function to look at.
>
> If you want something more complicated, package gdistance might work for you.
>

 Failing all that, I'm pretty sure GRASS GIS has the functionality to
do this.  I think there's a package to ease working with R and GRASS
if rgdal isn't sufficient for data transfer...

Barry


From bgr at bgs.ac.uk  Mon May 28 18:34:43 2012
From: bgr at bgs.ac.uk (Rawlins, Barry G.)
Date: Mon, 28 May 2012 17:34:43 +0100
Subject: [R-sig-Geo] Plotting with stplot, mode="xy"
Message-ID: <28C15D104A882F47954DEE56148152CC243F7D872B@nerckwmb1.ad.nerc.ac.uk>

Hello

I am trying to plot some space-time data which encompasses 3654 time intervals (15 mins each) at 84 sites.

I would like to animate these data and so I have used the following code and my STFDF object is "sp_time":

colors.ten<-rainbow(10,start=0.0,end=0.66) # rainbow color scale
stplot(sp_time, mode="xy", animate=1, cuts=10, at=seq(5,55,5), auto.key=T,col=colors.ten)

The first plot I see is this where the points are plotted in the correct locations:


But, I wanted some bespoke rainbow colors which do not appear and I know the z-range of the data is wider than that shown - the range is actually between 6 and 44. When I run the animation the scale changes each time but I would like it to be fixed so that each time slice has the same scale. Any advice on how I can solve this? I have tried reading the help pages on levelplot but to no avail.

Thanks, Barry




-- 
This message (and any attachments) is for the recipient only. NERC
is subject to the Freedom of Information Act 2000 and the contents
of this email and any reply you make may be disclosed by NERC unless
it is exempt from release under the Act. Any material supplied to
NERC may be stored in an electronic records management system.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120528/3a90f133/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Picture (Device Independent Bitmap) 1.jpg
Type: image/jpeg
Size: 13242 bytes
Desc: Picture (Device Independent Bitmap) 1.jpg
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120528/3a90f133/attachment.jpg>

From Bastien.Ferland-Raymond at mrnf.gouv.qc.ca  Mon May 28 22:14:57 2012
From: Bastien.Ferland-Raymond at mrnf.gouv.qc.ca (Bastien.Ferland-Raymond at mrnf.gouv.qc.ca)
Date: Mon, 28 May 2012 16:14:57 -0400
Subject: [R-sig-Geo] RE :  cost distance buffer?
In-Reply-To: <CANVKczMeBnfyaYChx3tQnQ+3o6Dy03cX594FahHmpe6xr70-Xw@mail.gmail.com>
Message-ID: <161DC602615F6943A19BAEA3DBF2E4B9018C0E1D3298@HARFANG.intranet.mrn.gouv>

Thank you both for your answer.

gridDistance seems to do the trick for me.  I haven't seen anything in gdistance that could help me but I could be wrong.

As for GRASS, I'll have to get into it one day.  This thing looks powerful, but it's pretty much just a name for me so far...

Bastien


-----Message d'origine-----
De : b.rowlingson at googlemail.com [mailto:b.rowlingson at googlemail.com] De la part de Barry Rowlingson
Envoy? : 28 mai 2012 11:15
? : Jacob van Etten
Cc : Ferland-Raymond, Bastien (DIF); r-sig-geo at r-project.org
Objet : Re: [R-sig-Geo] cost distance buffer?

On Mon, May 28, 2012 at 3:55 PM, Jacob van Etten
<jacobvanetten at yahoo.com> wrote:
> gridDistance in package raster would be the first function to look at.
>
> If you want something more complicated, package gdistance might work for you.
>

 Failing all that, I'm pretty sure GRASS GIS has the functionality to
do this.  I think there's a package to ease working with R and GRASS
if rgdal isn't sufficient for data transfer...

Barry


From gavin.simpson at ucl.ac.uk  Mon May 28 23:00:41 2012
From: gavin.simpson at ucl.ac.uk (Gavin Simpson)
Date: Mon, 28 May 2012 22:00:41 +0100
Subject: [R-sig-Geo] Overlaying a grid onto a set of points
Message-ID: <1338238841.2038.8.camel@chrysothemis.geog.ucl.ac.uk>

Dear List,

I have a SpatialGrid object - a regular 5km by 5km over the entire land
mass of Great Britain & NI - and a SpatialPointsDataFrame containing a
@data slot with several attributes.

I want to identify which points are in each grid cell and average the
values of the individual attributes from the points within each cell.
Not all cells will contain a point (for those an `NA` returned value is
fine) though some cells will contain many points. Later I may wish to
calculate some other summary (min or max) rather than mean.

If I understand correctly, this gives the desired result:

aggregate(fabResults.sp, by = frameGrid, FUN = mean)

where `fabResults.sp` is my SpatialPointsDataFrame and `frameGrid` is my
Spatial Grid. This takes a while to compute however.

I was unable to come up with an `over()` call that worked.

Have I got the `aggregate()` step right? Is there a way to use `over()`
to do the same operation? Am I missing a better alternative?

Thanks in advance,

Gavin
-- 
%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%
 Dr. Gavin Simpson             [t] +44 (0)20 7679 0522
 ECRC, UCL Geography,          [f] +44 (0)20 7679 0565
 Pearson Building,             [e] gavin.simpsonATNOSPAMucl.ac.uk
 Gower Street, London          [w] http://www.ucl.ac.uk/~ucfagls/
 UK. WC1E 6BT.                 [w] http://www.freshwaters.org.uk
%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%


From aortizbobea at arec.umd.edu  Tue May 29 01:24:14 2012
From: aortizbobea at arec.umd.edu (Ariel Ortiz-Bobea)
Date: Mon, 28 May 2012 16:24:14 -0700 (PDT)
Subject: [R-sig-Geo] R: spml function and the spatial.error option
In-Reply-To: <28643F754DDB094D8A875617EC4398B20BE30486@BEMAILEXTV03.corp.generali.net>
References: <28643F754DDB094D8A875617EC4398B20BE30486@BEMAILEXTV03.corp.generali.net>
Message-ID: <1338247454394-7579082.post@n2.nabble.com>

Hello Giovanni,

I finally found what was wrong and (as expected) it had nothing to do with
the function.

I turns out that the reported S.E.s converged to the real ones when I used a
made up sp object or the US county map from the "map" package. 

On the contrary, when I started from a US shape file the reported S.E.s did
not match the ones from the Monte Carlo simulation. My guess is that
somewhere down the line the sp object I had created from the shape file was
passing incorrect information to the spml function. I did not dig down to
the root but it is certainly having to do with the spatial object and how I
constructed the neighbors and weights from it.

Anyways, thanks for the help and I hope this helps other people in the
future.

Cheers,

Ariel

-----
Ariel Ortiz-Bobea
PhD Candidate in Agricultural & Resource Economics
University of Maryland - College Park
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/R-spml-function-and-the-spatial-error-option-tp7526451p7579082.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From aortizbobea at arec.umd.edu  Tue May 29 02:00:37 2012
From: aortizbobea at arec.umd.edu (Ariel Ortiz-Bobea)
Date: Mon, 28 May 2012 17:00:37 -0700 (PDT)
Subject: [R-sig-Geo] including factors in the formula for spml?
Message-ID: <1338249637616-7579094.post@n2.nabble.com>

Hello,

I'm trying to include a "state-level time trend" in a panel model with
spatially correlated errors. I'm getting the following error when I run the
spml() function with a "factor" as part of the formula:

Error in solve.default(crossprod(xco), crossprod(xco, yco)) : 
Lapack routine dgesv: system is exactly singular

It seems spml doesnt like factors in the formula (they are ok in the pml()
function). Do you have any suggestions on how to do this without having to
de-trend my data before the analysis or creating a bunch of
dummies+interactions "manually" (using the numeric class and not factors)?

Thanks in advance.

Ariel

--- Reproductible code below -----

# Load packages
	library(spdep)
	library(plm)
	library(splm)

# Create simple spatial structure
	data    	<- expand.grid(lon=1:10, lat=1:10 )
	data$fips 	<- 1:dim(data)[1]    
	rownames(data)<- 1:dim(data)[1]
	n<-dim(data)[1]
	mylist 		<- vector('list', n)
	for(i in 1:n) { 
	   mylist[[i]] = Polygons(list(Polygon(
   	   cbind( c(data[i,"lon"]-0.5, data[i,"lon"]-0.5, data[i,"lon"]+0.5,
data[i,"lon"]+0.5, data[i,"lon"]-0.5), 
   	         
c(data[i,"lat"]-0.5,data[i,"lat"]+0.5,data[i,"lat"]+0.5,data[i,"lat"]-0.5,data[i,"lat"]-0.5)))),i) 
	} 
	polys 	<- SpatialPolygons(mylist, 1:n) 
	polys 	<- SpatialPolygonsDataFrame(polys, data) 

# Create neighbor structure and plot it
	coords 	<- coordinates(polys)  
	nb  	<- poly2nb(polys)
	dlist  	<- nbdists(nb, coords) 
	idlist 	<- lapply(dlist, function(x) 1/x) # inverse distance
	nbw    	<- nb2listw(nb, glist=idlist, style="W")  
	plot(polys) 
	plot(nb, coordinates(polys), add=T, col="red")    

# Create artificial dataset for regression
	years		<- 2000:2010     # time periods
	t    		       <- length(years) # number of time periods
	dataset   	       <- data.frame( fips  = polys at data$fips, year=rep(years,
each=n) )
	dataset$x 	<- rnorm(n*t , rep(0,times=n) ) # covariate
	dataset$a 	<- rep(rnorm(n,mean=2,sd=sqrt(3)), times=t) # fixed effect
	dataset$state<- as.factor(floor(dataset$fips/10)) # create a "state" dummy
        head(dataset)

# This is the unknown and true regression parameter to be estimated
	beta = matrix(1, nrow=1, ncol=1)

# Generate error and implied y variable
	e <- rnorm(t*n, rep(0,times=n))
	dataset$y      <- as.matrix(dataset[,c("x")]) %*% beta + dataset$a + e      

# Run FE regression with plm: this works fine...
	fit_plm  <-  plm(formula = y ~ x + state*(as.numeric(year) +
I(as.numeric(year)^2)), data = dataset, model="within", index =
c("fips","year"))
	summary(fit_plm)

# Run FE regression with spatial error: crashes (apack routine dgesv: system
is exactly singular)
	fit_spml <- spml(formula = y ~ x + state*(as.numeric(year) +
I(as.numeric(year)^2)), data = dataset, model="within",
effect=c("individual"), index = c("fips","year"), listw = nbw, lag = FALSE,
spatial.error = "b")







-----
Ariel Ortiz-Bobea
PhD Candidate in Agricultural & Resource Economics
University of Maryland - College Park
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/including-factors-in-the-formula-for-spml-tp7579094.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From lyndon.estes at gmail.com  Tue May 29 02:38:24 2012
From: lyndon.estes at gmail.com (Lyndon Estes)
Date: Mon, 28 May 2012 20:38:24 -0400
Subject: [R-sig-Geo] Overlaying a grid onto a set of points
In-Reply-To: <1338238841.2038.8.camel@chrysothemis.geog.ucl.ac.uk>
References: <1338238841.2038.8.camel@chrysothemis.geog.ucl.ac.uk>
Message-ID: <CALuVVaYVxFUoABjF=H9OJ3w4vELgHW6o3zDmAhRS2br0yo1a7w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120528/a84876d8/attachment.pl>

From karljarvis at gmail.com  Tue May 29 02:52:12 2012
From: karljarvis at gmail.com (karljarvis)
Date: Mon, 28 May 2012 17:52:12 -0700 (PDT)
Subject: [R-sig-Geo] zero cost in gdistance
Message-ID: <1338252732368-7579110.post@n2.nabble.com>

Hi all,
I'd like to find cost distances in situations were some of the cells are 0,
to compare population genetic and landscape genetic results.  For example, a
landscape with panmixis on either side of a barrier. However, when I try it
in gdistance it gives the result "Inf" throughout in the matrix.

x <- c(-5,-5,5,5)
y <- c(-5,5,-5,5)
xy <- cbind(x,y)

m0 <- matrix(0,101,101)
m0[,51] <- 1
r0 <- raster(m0)
extent(r0) <- c(-10,10,-10,10)

t0 <- transition(r0,mean,8)
g0 <- geoCorrection(t0,type="c",multpl=FALSE)
c0 <- costDistance(g0,xy)

Is there a way to do this in R? 
I've heard that there are ways of doing cost distance in GRASS - does anyone
know if GRASS can deal with 0 resistance cells?
Karl


--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/zero-cost-in-gdistance-tp7579110.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From jacobvanetten at yahoo.com  Tue May 29 03:23:45 2012
From: jacobvanetten at yahoo.com (Jacob van Etten)
Date: Tue, 29 May 2012 02:23:45 +0100 (BST)
Subject: [R-sig-Geo] zero cost in gdistance
In-Reply-To: <1338252732368-7579110.post@n2.nabble.com>
References: <1338252732368-7579110.post@n2.nabble.com>
Message-ID: <1338254625.61280.YahooMailNeo@web29701.mail.ird.yahoo.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120529/9ac694a1/attachment.pl>

From karljarvis at gmail.com  Tue May 29 03:59:02 2012
From: karljarvis at gmail.com (karljarvis)
Date: Mon, 28 May 2012 18:59:02 -0700 (PDT)
Subject: [R-sig-Geo] zero cost in gdistance
In-Reply-To: <1338254625.61280.YahooMailNeo@web29701.mail.ird.yahoo.com>
References: <1338252732368-7579110.post@n2.nabble.com>
	<1338254625.61280.YahooMailNeo@web29701.mail.ird.yahoo.com>
Message-ID: <1338256742069-7579132.post@n2.nabble.com>

Many thanks! My mistake. I hadn't read carefully enough and thought the
distinction between cost and conductance was only a difference in how
gdistance calculates matrices, but now I see I just need to invert my
matrices.

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/zero-cost-in-gdistance-tp7579110p7579132.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From r.hijmans at gmail.com  Tue May 29 04:36:36 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Mon, 28 May 2012 19:36:36 -0700
Subject: [R-sig-Geo] Overlaying a grid onto a set of points
In-Reply-To: <1338238841.2038.8.camel@chrysothemis.geog.ucl.ac.uk>
References: <1338238841.2038.8.camel@chrysothemis.geog.ucl.ac.uk>
Message-ID: <CANtt_hyfzQzNruGBfNCf8QRzt1JLtwjy5EhTZBf00Xb=g06UXQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120528/7052c179/attachment.pl>

From m.hewson at uq.edu.au  Tue May 29 06:39:20 2012
From: m.hewson at uq.edu.au (Michael Hewson)
Date: Tue, 29 May 2012 04:39:20 +0000
Subject: [R-sig-Geo] GSTAT and anisotropy
Message-ID: <4DFD7C68C50FE54A98C0D43A76E08E0801E45A@uqexmdb6.soe.uq.edu.au>

I would like an opinion please on package gstat and examining anisotropy in variograms.

I have a set of atmospheric science variables in a regular grid of 3000 points at 1 km resolution.


When I use this code for one variable:



plot(variogram(d1$wrfae ~ 1, d1, alpha=c(0, 45, 90, 135)))

I can see the four different directions have different experimental variograms thus exhibiting anisotropy for that variable (as one might expect in an atmospheric data set). I can do the same for another variable of course.

I construct a cross-variogram for two of the variables and plot for anisotropy thus (because this is what I want - the cross-variogram examining spatial correlation):

g <- gstat(NULL, id = "ae", form = wrfae ~ 1, data=d1)
g <- gstat(g, id = "in", form = intensity ~ 1, data=d1)
xv1.aeVin <- variogram(g, alpha=c(0))
xv2.aeVin <- variogram(g, alpha=c(45))
xv3.aeVin <- variogram(g, alpha=c(90))
xv4.aeVin <- variogram(g, alpha=c(135))
plot(xv1.aeVin)
plot(xv2.aeVin)
plot(xv3.aeVin)
plot(xv4.aeVin)

but - I get exactly the same experimental variograms for two variables - and the cross-variogram - for each direction (thus implying isotropy).

If I use:
g <- gstat(NULL, id = "ae", form = wrfae ~ 1, data=d1)
g <- gstat(g, id = "in", form = intensity ~ 1, data=d1)
xv.aeVin <- variogram(g, alpha=c(0, 45, 90, 135))

then I can see the anisotropy for the larger varying variable variogram - but the now superimposed graphs contain also the small varying variable variogram - and the cross-variogram - these lines are not distinguishable from the x-axis in the four plots (thus unreadable for analysis).

I'm looking for a single plot set (2 variograms and a cross variogram for a given direction) - can I achieve that with some code amendments to my second set of code above?

Alternatively - can I extent the y axis (semi-variance) in the third set of code above?

If it helps I can add the plots ...

My thanks,
________________________________________________________
Michael Hewson PhD candidate
Climate Research Group<http://www.gpem.uq.edu.au/crg> | Centre for Spatial Environmental Research<http://www.gpem.uq.edu.au/cser>
The University of Queensland | Brisbane Q 4072 | Australia
m.hewson at uq.edu.au | +61 (0)408 379 373

[Description: ClimateResearchGroupbanner]


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120529/811d7019/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.jpg
Type: image/jpeg
Size: 8446 bytes
Desc: image001.jpg
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120529/811d7019/attachment.jpg>

From aortizbobea at arec.umd.edu  Tue May 29 07:11:36 2012
From: aortizbobea at arec.umd.edu (Ariel Ortiz-Bobea)
Date: Mon, 28 May 2012 22:11:36 -0700 (PDT)
Subject: [R-sig-Geo] how to determine varying spatial correlation scale
In-Reply-To: <CAARDZMVa=r92dr1+yoarwBOg+Kboi_PmADPvh1B1Kg2vvzGJmQ@mail.gmail.com>
References: <CAARDZMVa=r92dr1+yoarwBOg+Kboi_PmADPvh1B1Kg2vvzGJmQ@mail.gmail.com>
Message-ID: <1338268295969-7579195.post@n2.nabble.com>

Have you looked at:
http://en.wikipedia.org/wiki/Moran's_I
http://en.wikipedia.org/wiki/Geary%27s_C

This presentation by Roger Bivand might be useful:
http://www.bias-project.org.uk/ASDARcourse/unit6_slides.pdf

Also, the book "Applied Spatial Data Analysis with R" is a good reference.

I think you should clarify your question in terms of a varying weight matrix
(W) over space or a varying  autocorrelation coefficient (lambda) over
space. Your term "scale" seems a little loose, but seems to point to the a
varying W structure over space.

Ariel

-----
Ariel Ortiz-Bobea
PhD Candidate in Agricultural & Resource Economics
University of Maryland - College Park
--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/how-to-determine-varying-spatial-correlation-scale-tp7564409p7579195.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From jaimebg27 at gmail.com  Tue May 29 07:16:48 2012
From: jaimebg27 at gmail.com (=?ISO-8859-1?Q?Jaime_Burbano_Gir=F3n?=)
Date: Tue, 29 May 2012 00:16:48 -0500
Subject: [R-sig-Geo] Space-Time Model for NVDI
Message-ID: <CADiqS85vBZnyLahe3FEadx3HK5k1AJiyL2iuBdroJ1W65XOyQA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120529/375e49a9/attachment.pl>

From jaimebg27 at gmail.com  Tue May 29 07:16:48 2012
From: jaimebg27 at gmail.com (=?ISO-8859-1?Q?Jaime_Burbano_Gir=F3n?=)
Date: Tue, 29 May 2012 00:16:48 -0500
Subject: [R-sig-Geo] Space-Time Model for NVDI
Message-ID: <CADiqS85vBZnyLahe3FEadx3HK5k1AJiyL2iuBdroJ1W65XOyQA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120529/375e49a9/attachment-0001.pl>

From tom.gottfried at tum.de  Tue May 29 07:36:58 2012
From: tom.gottfried at tum.de (Tom Gottfried)
Date: Tue, 29 May 2012 07:36:58 +0200
Subject: [R-sig-Geo] GSTAT and anisotropy
In-Reply-To: <4DFD7C68C50FE54A98C0D43A76E08E0801E45A@uqexmdb6.soe.uq.edu.au>
References: <4DFD7C68C50FE54A98C0D43A76E08E0801E45A@uqexmdb6.soe.uq.edu.au>
Message-ID: <4FC4607A.4080905@tum.de>

This example

 > library(gstat)
 > data(meuse)
 > coordinates(meuse) <- 1:2
 > sum(variogram(zinc~1, meuse)$np)
[1] 6883
 > sum(variogram(zinc~1, meuse, alpha=45)$np)
[1] 6883
 > sum(variogram(zinc~1, meuse, alpha=45, tol.hor=10)$np)
[1] 1450

shows the effect of the default value of the argument tol.hor 
(documented in the "Usage"-section of ?variogram). Specifying a single 
value for alpha thus gives an isotropic variogram with the default for 
tol.hor.

Am 29.05.2012 06:39, schrieb Michael Hewson:
>
> xv.aeVin <- variogram(g, alpha=c(0, 45, 90, 135))
>
> then I can see the anisotropy for the larger varying variable variogram
> ? but the now superimposed graphs contain also the small varying
> variable variogram ? and the cross-variogram ? these lines are not
> distinguishable from the x-axis in the four plots (thus unreadable for
> analysis).

I assume you plotted xv.aeVin with plot.gstatVariogram. From the 
following example I would conclude you have to provide your own panel 
function or use something else than simply the plot method, as both 
values given to scales yield the same result. But it might well be that 
I missed something here. There are many screws you can screw in the 
world of lattice.

g <- gstat(NULL, "z", zinc~1, meuse)
g <- gstat(g, "l", lead~1, meuse)
plot(variogram(g, alpha=c(45,90,135,0)), scales=list(relation="same"))
plot(variogram(g, alpha=c(45,90,135,0)), scales=list(relation="free"))

HTH,
Tom

> I?m looking for a single plot set (2 variograms and a cross variogram
> for a given direction) ? can I achieve that with some code amendments to
> my second set of code above?
>
> Alternatively ? can I extent the y axis (semi-variance) in the third set
> of code above?
>
> If it helps I can add the plots ?
>
> My thanks,
>
> */________________________________________________________/*
>
> */Michael Hewson /*/PhD candidate/
>
> Climate Research Group <http://www.gpem.uq.edu.au/crg> | Centre for
> Spatial Environmental Research <http://www.gpem.uq.edu.au/cser>
>
> The University of Queensland | Brisbane Q 4072 | Australia
>
> m.hewson at uq.edu.au | */+61 (0)408 379 373/*
>
> Description: ClimateResearchGroupbanner
>
>
>
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Technische Universit?t M?nchen
Department f?r Pflanzenwissenschaften
Lehrstuhl f?r Gr?nlandlehre
Alte Akademie 12
85350 Freising / Germany
Phone: ++49 (0)8161 715324
Fax:   ++49 (0)8161 713243
email: tom.gottfried at wzw.tum.de
http://www.wzw.tum.de/gruenland


From edzer.pebesma at uni-muenster.de  Tue May 29 11:58:54 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 29 May 2012 11:58:54 +0200
Subject: [R-sig-Geo] Overlaying a grid onto a set of points
In-Reply-To: <1338238841.2038.8.camel@chrysothemis.geog.ucl.ac.uk>
References: <1338238841.2038.8.camel@chrysothemis.geog.ucl.ac.uk>
Message-ID: <4FC49DDE.1060509@uni-muenster.de>



On 05/28/2012 11:00 PM, Gavin Simpson wrote:
> Dear List,
> 
> I have a SpatialGrid object - a regular 5km by 5km over the entire land
> mass of Great Britain & NI - and a SpatialPointsDataFrame containing a
> @data slot with several attributes.
> 
> I want to identify which points are in each grid cell and average the
> values of the individual attributes from the points within each cell.
> Not all cells will contain a point (for those an `NA` returned value is
> fine) though some cells will contain many points. Later I may wish to
> calculate some other summary (min or max) rather than mean.
> 
> If I understand correctly, this gives the desired result:
> 
> aggregate(fabResults.sp, by = frameGrid, FUN = mean)
> 
> where `fabResults.sp` is my SpatialPointsDataFrame and `frameGrid` is my
> Spatial Grid. This takes a while to compute however.
> 
> I was unable to come up with an `over()` call that worked.
> 
> Have I got the `aggregate()` step right? Is there a way to use `over()`
> to do the same operation? Am I missing a better alternative?

aggregate.Spatial uses over() under the hood:

> sp::aggregate.Spatial
function (x, by, FUN = mean, ...)
{
    by0 = by
    if (gridded(by))
        by = as(by, "SpatialPolygons")
    df = over(by, x, fn = FUN, ...)
    addAttrToGeom(by0, df, match.ID = FALSE)
}

but returns the Spatial* object, rather than a vector, data.frame or
list. As you can see, it coerces the grid to polygons first, which may
be very inefficient.

Did it work?
-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From edzer.pebesma at uni-muenster.de  Tue May 29 12:28:21 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 29 May 2012 12:28:21 +0200
Subject: [R-sig-Geo] Plotting with stplot, mode="xy"
In-Reply-To: <28C15D104A882F47954DEE56148152CC243F7D872B@nerckwmb1.ad.nerc.ac.uk>
References: <28C15D104A882F47954DEE56148152CC243F7D872B@nerckwmb1.ad.nerc.ac.uk>
Message-ID: <4FC4A4C5.4040002@uni-muenster.de>

Hi Barry, the following should have worked:

library(spacetime)
loadMeuse()
d = as.data.frame(meuse)[c("cadmium", "copper", "lead", "zinc")]
x = STFDF(meuse, Sys.time()+1:4, stack(d))
stplot(x, animate=1, col.regions=bpy.colors(),
   cuts=c(1,10,100,1000,10000))

but doesn't fix the legend with current spacetime on CRAN, as the 'cuts'
argument was not passed on to spplot.

spacetime 0.7-1 in subversion has this fixed.

the 'col' argument needs to be called 'col.regions'.

On 05/28/2012 06:34 PM, Rawlins, Barry G. wrote:
> Hello
>  
> I am trying to plot some space-time data which encompasses 3654 time
> intervals (15 mins each) at 84 sites.
>  
> I would like to animate these data and so I have used the following code
> and my STFDF object is ?sp_time?:
>  
> colors.ten<-rainbow(10,start=0.0,end=0.66) # rainbow color scale
> stplot(sp_time, mode="xy", animate=1, cuts=10, at=seq(5,55,5),
> auto.key=T,col=colors.ten)
>  
> The first plot I see is this where the points are plotted in the correct
> locations:
>  
> But, I wanted some bespoke rainbow colors which do not appear and I know
> the z-range of the data is wider than that shown ? the range is actually
> between 6 and 44. When I run the animation the scale changes each time
> but I would like it to be fixed so that each time slice has the same
> scale. Any advice on how I can solve this? I have tried reading the help
> pages on levelplot but to no avail.
>  
> Thanks, Barry
>  
>  
>  
>  
> 
> -- 
> This message (and any attachments) is for the recipient only. NERC
> is subject to the Freedom of Information Act 2000 and the contents
> of this email and any reply you make may be disclosed by NERC unless
> it is exempt from release under the Act. Any material supplied to
> NERC may be stored in an electronic records management system.
> 
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From E.Couce at bristol.ac.uk  Tue May 29 14:35:58 2012
From: E.Couce at bristol.ac.uk (Elena_C)
Date: Tue, 29 May 2012 05:35:58 -0700 (PDT)
Subject: [R-sig-Geo] extracting row of data in a SpatialGridDataFrame object
Message-ID: <1338294958427-7579385.post@n2.nabble.com>

Hello all,

I believe my question must be quite basic, but I've spent quite some time
and I haven't managed to figure it out on my own, so any help would be
greatly appreciated.

I have a SpatialGridDataFrame object and I'm trying to extract the
associated data, by both rows and columns, as vectors. Ive managed to get
the columns to work with the operator [[ ]]:

> class(bio_grid)
[1] "SpatialGridDataFrame"
attr(,"package")
[1] "sp"
> dim(bio_grid)
[1] 43200    33

> class(bio_grid[[1]])
[1] "numeric"
> length(bio_grid[[1]])
[1] 43200

Is it possible to do the same with rows instead of columns? I'm not sure
what "bio_grid[1,]" does, but it is not the first row of the data frame:
> dim(bio_grid[1,])
[1] 360  33

I know it is possible to extract the data.frame and work with it normally:
bio_data <- data.frame(bio_grid)
Extract row number 'i': bio_data[i,]

But I was wondering if it could be done directly from the SpatialGrid,
because I have very large objects and my computer takes forever and
sometimes hangs up when I try to extract the data.frame

Thanks a lot,
Elena



--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/extracting-row-of-data-in-a-SpatialGridDataFrame-object-tp7579385.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From edzer.pebesma at uni-muenster.de  Tue May 29 14:51:19 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 29 May 2012 14:51:19 +0200
Subject: [R-sig-Geo] extracting row of data in a SpatialGridDataFrame
 object
In-Reply-To: <1338294958427-7579385.post@n2.nabble.com>
References: <1338294958427-7579385.post@n2.nabble.com>
Message-ID: <4FC4C647.9000108@uni-muenster.de>

bio_grid[1,] is the first row of the grid (think of the grid as a
matrix), not the first row of the data.frame with attributes.

Although direct manipulation of slots is not recommended in general, in
case of large objects it may be useful to address the data values at
grid cells directly by the data.frame that carries them: bio_grid at data;
its first row is

bio_grid at data[1,]

Hth,

On 05/29/2012 02:35 PM, Elena_C wrote:
> Hello all,
> 
> I believe my question must be quite basic, but I've spent quite some time
> and I haven't managed to figure it out on my own, so any help would be
> greatly appreciated.
> 
> I have a SpatialGridDataFrame object and I'm trying to extract the
> associated data, by both rows and columns, as vectors. Ive managed to get
> the columns to work with the operator [[ ]]:
> 
>> class(bio_grid)
> [1] "SpatialGridDataFrame"
> attr(,"package")
> [1] "sp"
>> dim(bio_grid)
> [1] 43200    33
> 
>> class(bio_grid[[1]])
> [1] "numeric"
>> length(bio_grid[[1]])
> [1] 43200
> 
> Is it possible to do the same with rows instead of columns? I'm not sure
> what "bio_grid[1,]" does, but it is not the first row of the data frame:
>> dim(bio_grid[1,])
> [1] 360  33
> 
> I know it is possible to extract the data.frame and work with it normally:
> bio_data <- data.frame(bio_grid)
> Extract row number 'i': bio_data[i,]
> 
> But I was wondering if it could be done directly from the SpatialGrid,
> because I have very large objects and my computer takes forever and
> sometimes hangs up when I try to extract the data.frame
> 
> Thanks a lot,
> Elena
> 
> 
> 
> --
> View this message in context: http://r-sig-geo.2731867.n2.nabble.com/extracting-row-of-data-in-a-SpatialGridDataFrame-object-tp7579385.html
> Sent from the R-sig-geo mailing list archive at Nabble.com.
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From thi_veloso at yahoo.com.br  Tue May 29 15:03:23 2012
From: thi_veloso at yahoo.com.br (Thiago Veloso)
Date: Tue, 29 May 2012 06:03:23 -0700 (PDT)
Subject: [R-sig-Geo] Antw: Re: Antw: Error when using rowSums along with
	a RasterStack object
In-Reply-To: <4FB268280200002700014108@gwia2.boku.ac.at>
References: <4FAFBB46020000270001407B@gwia2.boku.ac.at>
	<CANtt_hxc+ESog66jpw0vc3JaEChn790yb4NbaA87MYttcj+KNA@mail.gmail.com>
	<CANtt_hxe701185kF-YKJd-27CAYrJ_yPRrfyHidS5vDLYU06fg@mail.gmail.com>
	<1337081235.11802.YahooMailNeo@web161404.mail.bf1.yahoo.com>
	<4FB268280200002700014108@gwia2.boku.ac.at>
Message-ID: <1338296603.4794.YahooMailNeo@web161405.mail.bf1.yahoo.com>

? Matteo,

? I am very sorry for taking so long to answer - I took some days off starting in the same day you sent the message.

? I have tested the alternative you proposed. Indeed rowSums makes all the difference, take a look:

> s
class ? ? ? : RasterStack?
dimensions ?: 5568, 8289, 46153152, 45 ?(nrow, ncol, ncell, nlayers)
resolution ?: 0.00898, 0.00898 ?(x, y)
extent ? ? ?: -104.4326, -29.99736, -40.00064, 10 ?(xmin, xmax, ymin, ymax)
coord. ref. : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0?
min values ?: -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, ...?
max values ?: 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, ...?
layer names : gpp2001001.Gpp_1km, gpp2001009.Gpp_1km, gpp2001017.Gpp_1km, gpp2001025.Gpp_1km, gpp2001033.Gpp_1km, gpp2001041.Gpp_1km, gpp2001049.Gpp_1km, gpp2001057.Gpp_1km, gpp2001065.Gpp_1km, gpp2001073.Gpp_1km, gpp2001081.Gpp_1km, gpp2001089.Gpp_1km, gpp2001097.Gpp_1km, gpp2001105.Gpp_1km, gpp2001113.Gpp_1km, ...?

?> fun <- function(x) {
+ ? ? ? ? x [x > 32760] <- NA
+ ? ? ? ? x <- x * 0.0001
+ ? ? ? ? x <- sum(x,na.rm=FALSE)
+ }

> fout ?<- paste('/mnt/disco3/MODIS/MOSAIC/GPP/yearly/gpp_2001(sum).nc', sep='')

> system.time(x <- calc(s, fun, filename=fout))
? ? user ? system ?elapsed?
1485.619 ? 47.935 3320.638

? Function 'sum' took ~55 minutes to integrate 45 images

> fun <- function(x) {
+ ? ? ? ? x [x > 32760] <- NA
+ ? ? ? ? x <- x * 0.0001
+ ? ? ? ? x <- rowSums(x,na.rm=FALSE)

+ }
> fout ?<- paste('/mnt/disco3/MODIS/MOSAIC/GPP/yearly/gpp_2001(rowSums).nc', sep='')
> system.time(x <- calc(s, fun, filename=fout))

? ? user ? system ?elapsed?
?393.477 ? 79.516 2197.248?

? Same 45 images took ~36 minutes to be integrated using 'rowSums' function!!

? Thanks for this tip - it will certainly speed up my work!

? All the best,
? Thiago.
________________________________
From: Matteo Mattiuzzi <matteo.mattiuzzi at boku.ac.at>
To: Robert J. Hijmans <r.hijmans at gmail.com>; Thiago Veloso <thi_veloso at yahoo.com.br> 
Cc: "r-sig-geo at r-project.org" <r-sig-geo at r-project.org> 
Sent: Tuesday, May 15, 2012 9:28 AM
Subject: Re: [R-sig-Geo] Antw: Re: Antw: Error when using rowSums along with a RasterStack object


Hi Thiago, have you tested this?

# vectorized version.?Here x is a matrix!?(1 "chunk" of data, depend on blockSize(data).)
fun <- function(x) {
??????? x[x>32761] <- NA
??????? x <- x * 0.0001
??????? x <- rowSums(x,na.rm=FALSE)
}
x <- calc(s, fun,forceFun=TRUE)

I'm confident that you will win another 30% of time...let me know I'm curious.

Matteo

>>> Thiago Veloso <thi_veloso at yahoo.com.br> 5/15/2012 1:27 pm >>>
? Robert and Matteo,

? Thanks for your suggestions. I ended up running the old version of my script, which, after some crop operations, takes 'only' 40 minutes per annual-summation relative to the old 51-minute mark.

? Although your suggestions on memory optimization are really tempting, the server I use is shared with my workgroup and I don't want to create a memory black hole!

? For everyone's appreciation, I am pasting the code in the end of this message.

? All the best,
? Thiago.

# loading required packages (raster will do the most of the processing, 

# rgdal is used to load images, ncdf writes the resulting netcdf files
# and maptools is used to load shapefiles which crops the images.)
library(raster)
library(rgdal)
library(ncdf)
library(maptools)

# set the working directory
setwd("/mnt/disco3/MODIS/MOSAIC/GPP")

# load and project shapefiles to crop images later
sa<-readShapePoly("/mnt/disco3/MODIS/shapes/southamerica.shp")
br<-readShapePoly("/mnt/disco3/MODIS/shapes/brazil.shp")
shape_proj<-raster('/mnt/disco3/MODIS/MOSAIC/GPP/gpp2001001.Gpp_1km.tif')
projection(sa)<-projection(shape_proj)
projection(br)<-projection(shape_proj)

# define a function to perform common tasks
fun <- function(x) {
??????? x [x > 32760] <- NA #remove unvalid range of values (water, unclassified pixes etc): 32760 for GPP and? for LAI
??????? x <- x * 0.0001 #scale factor for MODIS GPP product: 0.0001 for GPP and 0.1 for LAI
??????? x <- sum(x,na.rm=FALSE) #integrating 46 satellite images takes 51 minutes (3,104 seconds) to run
}

# Once the function has been defined, it should be relatively
# straightforward to loop over years to perform annual integration
files <- list.files(pattern='.Gpp_1km.tif',? full.names=TRUE)
years <- substr(files, 6, 9)
for (y in 2001:2011) {
?????? f <- files[ years == y ]
?????? # stack one year's all files
?????? s <- stack(f) #stacking 46 images takes 10 seconds to run
?????? s <- crop(s,br)
?????? fout? <- paste('/mnt/disco3/MODIS/MOSAIC/GPP/yearly/gpp_', y,'.nc', sep='')
?????? x <- calc(s, fun, filename=fout)
}
________________________________
From: Robert J. Hijmans <r.hijmans at gmail.com>
To: thi_veloso at yahoo.com.br
Cc: r-sig-geo at r-project.org; Matteo Mattiuzzi <matteo.mattiuzzi at boku.ac.at> 
Sent: Monday, May 14, 2012 1:25 PM
Subject: Re: [R-sig-Geo] Antw: Re: Antw: Error when using rowSums along with a RasterStack object


Thiago, 

I forgot to mention that you may be able to further speed things up by processing the data in bigger chunks, using 

setOptions(chunksize=?? )

The default setting is somewhat conservative, to avoid errors from occurring, but if you want to live in the fast lane, give it a try.

Also, Matteo pointed out to me that? calc(x, sum)? also uses rowSums; so speed should be equivalent for sum and calc. calc has the advantage of being able to set a filename. 

Robert


On Sun, May 13, 2012 at 9:03 AM, Robert J. Hijmans <r.hijmans at gmail.com> wrote:

sum should be faster than calc(x, sum) because sum uses rowSums whereas calc, in this case, would call apply(values(x), 1, sum). calc(x, function(i) rowSums(i)) should be equivalent to sum (in speed and results). 
>
>
>Whether making a RasterBrick is worth it depends on how many times you will use these files for this type of computation. If it is only for one computation it should be slower to first make bricks, as the main bottleneck in these computations is disk I/O. I cannot think of another way to speed things up right now --- something we are working through clustering (probably not too helpful here), and C routines.
>
>
>30 hours is long, but it is the computer that's working, not you.
>
>Robert
>
>
>
>
>On Sun, May 13, 2012 at 4:46 AM, Matteo Mattiuzzi <matteo.mattiuzzi at boku.ac.at> wrote:
>
>Dear Thiago,
>>
>>I don't know what makes sum() more suitable comparing to calc() but I think a fakt that you are useing a stack (and not a brick) influences also the speed of processing:
>>
>>######################
>>
>>library(raster)
>>r <- raster()
>>r[] <- 1:ncell(r)
>>
>>setOptions(todisk=TRUE)
>>system.time(st <- stack(r,r,r,r,r,r,r,r,r))
>>system.time(br <- brick(r,r,r,r,r,r,r,r,r))
>>
>>system.time(sum(st,na.rm=FALSE))
>>system.time(sum(br,na.rm=FALSE))
>>
>>system.time(calc(st,sum,na.rm=FALSE))
>>system.time(calc(br,sum,na.rm=FALSE))
>>
>>setOptions(todisk=FALSE)
>>#######################
>>
>># Of coarse the creation of a brick takes a bit of time since the data needs to be re-organised physically on the disk.
>># But this initial overhead worthwhile relatively quickly, you have to check this.
>>
>># Cheers Matteo
>>
>>
>>
>>
>>>>> Thiago Veloso? 13.05.12 1.53 Uhr >>>
>>
>> Robert,
>> Thanks for your input. Your suggestion is more suitable to my case, but it takes almost one hour to sum a stack containing 46 satellite images. Please see below:
>>> sclass?????? : RasterStack dimensions? : 5568, 8289, 46153152, 46? (nrow, ncol, ncell, nlayers)resolution? : 0.00898, 0.00898? (x, y)extent????? : -104.4326, -29.99736, -40.00064, 10? (xmin, xmax, ymin, ymax)coord. ref. : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0 min values? : -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, ... max values? : 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, ... layer names : gpp2004001.Gpp_1km, gpp2004009.Gpp_1km, gpp2004017.Gpp_1km, gpp2004025.Gpp_1km, gpp2004033.Gpp_1km, gpp2004041.Gpp_1km, gpp2004049.Gpp_1km, gpp2004057.Gpp_1km, gpp2004065.Gpp_1km, gpp2004073.Gpp_1km, gpp2004081.Gpp_1km, gpp2004089.Gpp_1km, gpp2004097.Gpp_1km, gpp2004105.Gpp_1km, gpp2004113.Gpp_1km, ...
>>
>> For reference, total size of the 46 images which compose the stack reaches 4GB. Here is how long it takes to perform the sum over the stack:
>>> system.time(sos <- sum(s,na.rm=FALSE))??? user?? system? elapsed? 743.098?? 31.258 3104.113
>> The machine I am using to process this dataset is an 3GHz quadcore with 16GB of RAM, running Opensuse and latest R (2.15.0).
>> As processing my entire data involves performing this operation at least 30 times, is there a way to optimize the process?
>> All the best,? Thiago.
>>
>>--- On Sat, 12/5/12, Robert J. Hijmans? wrote:
>>
>>From: Robert J. Hijmans
>>
>>Subject: Re: [R-sig-Geo] Antw: Error when using rowSums along with a RasterStack object
>>To: thi_veloso at yahoo.com.br
>>Cc: r-sig-geo at r-project.org
>>Date: Saturday, 12 May, 2012, 13:43
>>
>>You can also do
>>sos <- sum(s, na.rm=FALSE)
>>Best, Robert
>>
>>
>>
>>On Sat, May 12, 2012 at 2:26 AM, Matteo Mattiuzzi? wrote:
>>
>>Dear Thiago,
>>
>>
>>
>>is this what you need?
>>
>>####
>>
>>library(raster)
>>
>>r <- raster()
>>
>>r[]<-1:ncell(r)
>>
>>r2 <- raster()
>>
>>r2[]<-ncell(r):1
>>
>>r <-brick(r,r2)
>>
>>plot(r)
>>
>>
>>
>>sos <- calc(r,sum)
>>
>>x11()
>>
>>plot(sos)
>>
>>####
>>
>>Matteo
>>
>>
>>
>>sos <- calc(r,sum)
>>
>>plot(sos)
>>
>>
>>
>>>>> Thiago Veloso? 11.05.12 23.29 Uhr >>>
>>
>>Dear R-colleagues,
>>
>>
>>
>>I am trying to sum all layers of a RasterStack object, which is summarized below:
>>
>>
>>
>>> s
>>
>>class?????? : RasterStack
>>
>>dimensions? : 5568, 8289, 46153152, 46? (nrow, ncol, ncell, nlayers)
>>
>>resolution? : 0.00898, 0.00898? (x, y)
>>
>>extent????? : -104.4326, -29.99736, -40.00064, 10? (xmin, xmax, ymin, ymax)
>>
>>coord. ref. : +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0
>>
>>min values? : -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, -32768, ...
>>
>>max values? : 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, 32767, ...
>>
>>layer names : gpp2004001.Gpp_1km, gpp2004009.Gpp_1km, gpp2004017.Gpp_1km, gpp2004025.Gpp_1km, gpp2004033.Gpp_1km, gpp2004041.Gpp_1km, gpp2004049.Gpp_1km, gpp2004057.Gpp_1km, gpp2004065.Gpp_1km, gpp2004073.Gpp_1km, gpp2004081.Gpp_1km, gpp2004089.Gpp_1km, gpp2004097.Gpp_1km, gpp2004105.Gpp_1km, gpp2004113.Gpp_1km, ...
>>
>>
>>
>>
>>The raster 's' is composed by 46 satellite images at a resolution of 1km (0.00898degree). Each layer is a 8-day composition of leaf area index and I need to integrate an entire year of LAI. When I try to run the "rowSums" function in this RasterStack, the following error is displayed:
>>
>>
>>
>>
>>> sos <- rowSums(s,na.rm=FALSE)
>>
>>Error in rowSums(s, na.rm = FALSE) :
>>
>> 'x' must be an array of at least two dimensions
>>
>>
>>
>>The same occurs when I try to use .rowSums providing matrix dimensions:
>>
>>
>>
>>> sos <- .rowSums(s,5568,8289)
>>
>>Error in .rowSums(s, 5568, 8289) : 'x' must be numeric
>>
>>
>>
>>
>>
>>What am I doing wrong? Is there another way to integrate the layers of a RasterStack object?
>>
>>
>>
>>Thanks in advance,
>>
>>Thiago Veloso.
>>
>>
>>
>>P.S.: Attaching sessionInfo output to provide useful information:
>>
>>
>>
>>> sessionInfo()
>>
>>R version 2.15.0 (2012-03-30)
>>
>>Platform: x86_64-unknown-linux-gnu (64-bit)
>>
>>
>>
>>locale:
>>
>> [1] LC_CTYPE=en_US.UTF-8?????? LC_NUMERIC=C
>>
>> [3] LC_TIME=en_US.UTF-8??????? LC_COLLATE=en_US.UTF-8
>>
>> [5] LC_MONETARY=en_US.UTF-8??? LC_MESSAGES=en_US.UTF-8
>>
>> [7] LC_PAPER=C???????????????? LC_NAME=C
>>
>> [9] LC_ADDRESS=C?????????????? LC_TELEPHONE=C
>>
>>[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C
>>
>>
>>
>>attached base packages:
>>
>>[1] stats???? graphics? grDevices utils???? datasets? methods?? base
>>
>>
>>
>>other attached packages:
>>
>>[1] ncdf_1.6.6??? rgdal_0.7-11? raster_1.9-92 sp_0.9-99
>>
>>
>>
>>loaded via a namespace (and not attached):
>>
>>[1] grid_2.15.0??? lattice_0.20-6
>>
>>
>>
>>
>>
>>_______________________________________________
>>
>>R-sig-Geo mailing list
>>
>>R-sig-Geo at r-project.org
>>
>>https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>>
>>
>>
>>?????? [[alternative HTML version deleted]]
>>
>>
>>
>>_______________________________________________
>>
>>R-sig-Geo mailing list
>>
>>R-sig-Geo at r-project.org
>>
>>https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>>
>>
>>
>>
?? [[alternative HTML version deleted]]
>>
>>
>>
>>
>>?????? [[alternative HTML version deleted]]
>>
>>_______________________________________________
>>R-sig-Geo mailing list
>>R-sig-Geo at r-project.org
>>https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
>????


From matteo.mattiuzzi at boku.ac.at  Tue May 29 15:20:02 2012
From: matteo.mattiuzzi at boku.ac.at (Matteo Mattiuzzi)
Date: Tue, 29 May 2012 15:20:02 +0200
Subject: [R-sig-Geo] Antw: Re: Antw: Error when using rowSums along with
 a RasterStack object
In-Reply-To: <1338296603.4794.YahooMailNeo@web161405.mail.bf1.yahoo.com>
References: <4FAFBB46020000270001407B@gwia2.boku.ac.at>
	<CANtt_hxc+ESog66jpw0vc3JaEChn790yb4NbaA87MYttcj+KNA@mail.gmail.com>
	<CANtt_hxe701185kF-YKJd-27CAYrJ_yPRrfyHidS5vDLYU06fg@mail.gmail.com>
	<1337081235.11802.YahooMailNeo@web161404.mail.bf1.yahoo.com>
	<4FB268280200002700014108@gwia2.boku.ac.at>
	<1338296603.4794.YahooMailNeo@web161405.mail.bf1.yahoo.com>
Message-ID: <4FC4E9220200002700014349@gwia2.boku.ac.at>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120529/52b9afc2/attachment.pl>

From E.Couce at bristol.ac.uk  Tue May 29 15:32:29 2012
From: E.Couce at bristol.ac.uk (Elena_C)
Date: Tue, 29 May 2012 06:32:29 -0700 (PDT)
Subject: [R-sig-Geo] extracting row of data in a SpatialGridDataFrame
	object
In-Reply-To: <4FC4C647.9000108@uni-muenster.de>
References: <1338294958427-7579385.post@n2.nabble.com>
	<4FC4C647.9000108@uni-muenster.de>
Message-ID: <1338298349610-7579424.post@n2.nabble.com>


Thanks a lot, that explains it!

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/extracting-row-of-data-in-a-SpatialGridDataFrame-object-tp7579385p7579424.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From bgr at bgs.ac.uk  Tue May 29 16:03:01 2012
From: bgr at bgs.ac.uk (Rawlins, Barry G.)
Date: Tue, 29 May 2012 15:03:01 +0100
Subject: [R-sig-Geo] Plotting with stplot, mode="xy"
In-Reply-To: <4FC4BFAD.60707@uni-muenster.de>
References: <28C15D104A882F47954DEE56148152CC243F7D872B@nerckwmb1.ad.nerc.ac.uk>
	<4FC4A4C5.4040002@uni-muenster.de>
	<28C15D104A882F47954DEE56148152CC243F7D8AFD@nerckwmb1.ad.nerc.ac.uk>
	<4FC4BFAD.60707@uni-muenster.de>
Message-ID: <28C15D104A882F47954DEE56148152CC243F7D8CDC@nerckwmb1.ad.nerc.ac.uk>

Hi Edzer

I can see a series of folders+files on the svn area - can you just give me some direction on how I get the source code? Were you suggesting I just take the code under R/stplot.R? And build a function from this?

Best wishes, Barry

-----Original Message-----
From: Edzer Pebesma [mailto:edzer.pebesma at uni-muenster.de] 
Sent: 29 May 2012 13:23
To: Rawlins, Barry G.
Subject: Re: [R-sig-Geo] Plotting with stplot, mode="xy"

svn co https://svn.52north.org/svn/geostatistics/main/spacetime/

will give you the updated source. Let me know if it works, otherwise
we'll try the CRAN route (CRAN seems a bit over-worked, lately, for
clear reasons, throwing NOTEs if you're uploading too frequent).

I just noticed that the package DESCRIPTION file does not contain this
URL -- will modify.


On 05/29/2012 01:28 PM, Rawlins, Barry G. wrote:
> Many thanks Edzer - it is superb to have your help on such occasions.
> 
> Checking CRAN - the latest version of spacetime appears to be 0.7-0 - does that mean I need to wait for 0.7-1 (which you refer to) to be released?
> 
> I did not copy to the list because I was not sure this question was relevant to my problem.
> 
> Best wishes, Barry
> 
> 
> -----Original Message-----
> From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Edzer Pebesma
> Sent: 29 May 2012 11:28
> To: r-sig-geo at r-project.org
> Subject: Re: [R-sig-Geo] Plotting with stplot, mode="xy"
> 
> Hi Barry, the following should have worked:
> 
> library(spacetime)
> loadMeuse()
> d = as.data.frame(meuse)[c("cadmium", "copper", "lead", "zinc")]
> x = STFDF(meuse, Sys.time()+1:4, stack(d))
> stplot(x, animate=1, col.regions=bpy.colors(),
>    cuts=c(1,10,100,1000,10000))
> 
> but doesn't fix the legend with current spacetime on CRAN, as the 'cuts'
> argument was not passed on to spplot.
> 
> spacetime 0.7-1 in subversion has this fixed.
> 
> the 'col' argument needs to be called 'col.regions'.
> 
> On 05/28/2012 06:34 PM, Rawlins, Barry G. wrote:
>> Hello
>>  
>> I am trying to plot some space-time data which encompasses 3654 time
>> intervals (15 mins each) at 84 sites.
>>  
>> I would like to animate these data and so I have used the following code
>> and my STFDF object is "sp_time":
>>  
>> colors.ten<-rainbow(10,start=0.0,end=0.66) # rainbow color scale
>> stplot(sp_time, mode="xy", animate=1, cuts=10, at=seq(5,55,5),
>> auto.key=T,col=colors.ten)
>>  
>> The first plot I see is this where the points are plotted in the correct
>> locations:
>>  
>> But, I wanted some bespoke rainbow colors which do not appear and I know
>> the z-range of the data is wider than that shown - the range is actually
>> between 6 and 44. When I run the animation the scale changes each time
>> but I would like it to be fixed so that each time slice has the same
>> scale. Any advice on how I can solve this? I have tried reading the help
>> pages on levelplot but to no avail.
>>  
>> Thanks, Barry
>>  
>>  
>>  
>>  
>>
>> -- 
>> This message (and any attachments) is for the recipient only. NERC
>> is subject to the Freedom of Information Act 2000 and the contents
>> of this email and any reply you make may be disclosed by NERC unless
>> it is exempt from release under the Act. Any material supplied to
>> NERC may be stored in an electronic records management system.
>>
>>
>> _______________________________________________
>> R-sig-Geo mailing list
>> R-sig-Geo at r-project.org
>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From edzer.pebesma at uni-muenster.de  Tue May 29 18:07:04 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 29 May 2012 18:07:04 +0200
Subject: [R-sig-Geo] Plotting with stplot, mode="xy"
In-Reply-To: <28C15D104A882F47954DEE56148152CC243F7D8CDC@nerckwmb1.ad.nerc.ac.uk>
References: <28C15D104A882F47954DEE56148152CC243F7D872B@nerckwmb1.ad.nerc.ac.uk>
	<4FC4A4C5.4040002@uni-muenster.de>
	<28C15D104A882F47954DEE56148152CC243F7D8AFD@nerckwmb1.ad.nerc.ac.uk>
	<4FC4BFAD.60707@uni-muenster.de>
	<28C15D104A882F47954DEE56148152CC243F7D8CDC@nerckwmb1.ad.nerc.ac.uk>
Message-ID: <4FC4F428.9080508@uni-muenster.de>



On 05/29/2012 04:03 PM, Rawlins, Barry G. wrote:
> Hi Edzer
> 
> I can see a series of folders+files on the svn area - can you just give me some direction on how I get the source code? Were you suggesting I just take the code under R/stplot.R? And build a function from this?
> 

I was thinking about building and installing the R package from source,
but that might be a bridge too far if you're not used to doing that.

It might be easier to source the whole R/stplot.R file in your R session
-- that should work as well.

> Best wishes, Barry
> 
> -----Original Message-----
> From: Edzer Pebesma [mailto:edzer.pebesma at uni-muenster.de] 
> Sent: 29 May 2012 13:23
> To: Rawlins, Barry G.
> Subject: Re: [R-sig-Geo] Plotting with stplot, mode="xy"
> 
> svn co https://svn.52north.org/svn/geostatistics/main/spacetime/
> 
> will give you the updated source. Let me know if it works, otherwise
> we'll try the CRAN route (CRAN seems a bit over-worked, lately, for
> clear reasons, throwing NOTEs if you're uploading too frequent).
> 
> I just noticed that the package DESCRIPTION file does not contain this
> URL -- will modify.
> 
> 
> On 05/29/2012 01:28 PM, Rawlins, Barry G. wrote:
>> Many thanks Edzer - it is superb to have your help on such occasions.
>>
>> Checking CRAN - the latest version of spacetime appears to be 0.7-0 - does that mean I need to wait for 0.7-1 (which you refer to) to be released?
>>
>> I did not copy to the list because I was not sure this question was relevant to my problem.
>>
>> Best wishes, Barry
>>
>>
>> -----Original Message-----
>> From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Edzer Pebesma
>> Sent: 29 May 2012 11:28
>> To: r-sig-geo at r-project.org
>> Subject: Re: [R-sig-Geo] Plotting with stplot, mode="xy"
>>
>> Hi Barry, the following should have worked:
>>
>> library(spacetime)
>> loadMeuse()
>> d = as.data.frame(meuse)[c("cadmium", "copper", "lead", "zinc")]
>> x = STFDF(meuse, Sys.time()+1:4, stack(d))
>> stplot(x, animate=1, col.regions=bpy.colors(),
>>    cuts=c(1,10,100,1000,10000))
>>
>> but doesn't fix the legend with current spacetime on CRAN, as the 'cuts'
>> argument was not passed on to spplot.
>>
>> spacetime 0.7-1 in subversion has this fixed.
>>
>> the 'col' argument needs to be called 'col.regions'.
>>
>> On 05/28/2012 06:34 PM, Rawlins, Barry G. wrote:
>>> Hello
>>>  
>>> I am trying to plot some space-time data which encompasses 3654 time
>>> intervals (15 mins each) at 84 sites.
>>>  
>>> I would like to animate these data and so I have used the following code
>>> and my STFDF object is "sp_time":
>>>  
>>> colors.ten<-rainbow(10,start=0.0,end=0.66) # rainbow color scale
>>> stplot(sp_time, mode="xy", animate=1, cuts=10, at=seq(5,55,5),
>>> auto.key=T,col=colors.ten)
>>>  
>>> The first plot I see is this where the points are plotted in the correct
>>> locations:
>>>  
>>> But, I wanted some bespoke rainbow colors which do not appear and I know
>>> the z-range of the data is wider than that shown - the range is actually
>>> between 6 and 44. When I run the animation the scale changes each time
>>> but I would like it to be fixed so that each time slice has the same
>>> scale. Any advice on how I can solve this? I have tried reading the help
>>> pages on levelplot but to no avail.
>>>  
>>> Thanks, Barry
>>>  
>>>  
>>>  
>>>  
>>>
>>> -- 
>>> This message (and any attachments) is for the recipient only. NERC
>>> is subject to the Freedom of Information Act 2000 and the contents
>>> of this email and any reply you make may be disclosed by NERC unless
>>> it is exempt from release under the Act. Any material supplied to
>>> NERC may be stored in an electronic records management system.
>>>
>>>
>>> _______________________________________________
>>> R-sig-Geo mailing list
>>> R-sig-Geo at r-project.org
>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From d.nuest at 52north.org  Tue May 29 18:20:56 2012
From: d.nuest at 52north.org (=?windows-1252?Q?Daniel_N=FCst?=)
Date: Tue, 29 May 2012 18:20:56 +0200
Subject: [R-sig-Geo] Plotting with stplot, mode="xy"
In-Reply-To: <4FC4F428.9080508@uni-muenster.de>
References: <28C15D104A882F47954DEE56148152CC243F7D872B@nerckwmb1.ad.nerc.ac.uk>
	<4FC4A4C5.4040002@uni-muenster.de>
	<28C15D104A882F47954DEE56148152CC243F7D8AFD@nerckwmb1.ad.nerc.ac.uk>
	<4FC4BFAD.60707@uni-muenster.de>
	<28C15D104A882F47954DEE56148152CC243F7D8CDC@nerckwmb1.ad.nerc.ac.uk>
	<4FC4F428.9080508@uni-muenster.de>
Message-ID: <4FC4F768.8040203@52north.org>

Am 29.05.2012 18:07, schrieb Edzer Pebesma:
> On 05/29/2012 04:03 PM, Rawlins, Barry G. wrote:
>> I can see a series of folders+files on the svn area - can you just give me some direction on how I get the source code? Were you suggesting I just take the code under R/stplot.R? And build a function from this?
> I was thinking about building and installing the R package from source,
> but that might be a bridge too far if you're not used to doing that.
> 
> It might be easier to source the whole R/stplot.R file in your R session
> -- that should work as well.

The svn also has http access, so

source("https://svn.52north.org/svn/geostatistics/main/spacetime/R/stplot.R")

should do just that.

/Daniel

>> -----Original Message-----
>> From: Edzer Pebesma [mailto:edzer.pebesma at uni-muenster.de] 
>> Sent: 29 May 2012 13:23
>> To: Rawlins, Barry G.
>> Subject: Re: [R-sig-Geo] Plotting with stplot, mode="xy"
>>
>> svn co https://svn.52north.org/svn/geostatistics/main/spacetime/
>>
>> will give you the updated source. Let me know if it works, otherwise
>> we'll try the CRAN route (CRAN seems a bit over-worked, lately, for
>> clear reasons, throwing NOTEs if you're uploading too frequent).
>>
>> I just noticed that the package DESCRIPTION file does not contain this
>> URL -- will modify.
>>
>>
>> On 05/29/2012 01:28 PM, Rawlins, Barry G. wrote:
>>> Many thanks Edzer - it is superb to have your help on such occasions.
>>>
>>> Checking CRAN - the latest version of spacetime appears to be 0.7-0 - does that mean I need to wait for 0.7-1 (which you refer to) to be released?
>>>
>>> I did not copy to the list because I was not sure this question was relevant to my problem.
>>>
>>> Best wishes, Barry
>>>
>>>
>>> -----Original Message-----
>>> From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Edzer Pebesma
>>> Sent: 29 May 2012 11:28
>>> To: r-sig-geo at r-project.org
>>> Subject: Re: [R-sig-Geo] Plotting with stplot, mode="xy"
>>>
>>> Hi Barry, the following should have worked:
>>>
>>> library(spacetime)
>>> loadMeuse()
>>> d = as.data.frame(meuse)[c("cadmium", "copper", "lead", "zinc")]
>>> x = STFDF(meuse, Sys.time()+1:4, stack(d))
>>> stplot(x, animate=1, col.regions=bpy.colors(),
>>>    cuts=c(1,10,100,1000,10000))
>>>
>>> but doesn't fix the legend with current spacetime on CRAN, as the 'cuts'
>>> argument was not passed on to spplot.
>>>
>>> spacetime 0.7-1 in subversion has this fixed.
>>>
>>> the 'col' argument needs to be called 'col.regions'.
>>>
>>> On 05/28/2012 06:34 PM, Rawlins, Barry G. wrote:
>>>> Hello
>>>>  
>>>> I am trying to plot some space-time data which encompasses 3654 time
>>>> intervals (15 mins each) at 84 sites.
>>>>  
>>>> I would like to animate these data and so I have used the following code
>>>> and my STFDF object is "sp_time":
>>>>  
>>>> colors.ten<-rainbow(10,start=0.0,end=0.66) # rainbow color scale
>>>> stplot(sp_time, mode="xy", animate=1, cuts=10, at=seq(5,55,5),
>>>> auto.key=T,col=colors.ten)
>>>>  
>>>> The first plot I see is this where the points are plotted in the correct
>>>> locations:
>>>>  
>>>> But, I wanted some bespoke rainbow colors which do not appear and I know
>>>> the z-range of the data is wider than that shown - the range is actually
>>>> between 6 and 44. When I run the animation the scale changes each time
>>>> but I would like it to be fixed so that each time slice has the same
>>>> scale. Any advice on how I can solve this? I have tried reading the help
>>>> pages on levelplot but to no avail.
>>>>  
>>>> Thanks, Barry
>>>>  
>>>>  
>>>>  
>>>>  
>>>>
>>>> -- 
>>>> This message (and any attachments) is for the recipient only. NERC
>>>> is subject to the Freedom of Information Act 2000 and the contents
>>>> of this email and any reply you make may be disclosed by NERC unless
>>>> it is exempt from release under the Act. Any material supplied to
>>>> NERC may be stored in an electronic records management system.
>>>>
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
> 


-- 
Daniel N?st
52? North Initiative for Geospatial Open Source Software GmbH
Martin-Luther-King-Weg 24
48155 M?nster, Germany
E-Mail: d.nuest at 52north.org
Fon: +49-(0)-251?396371-36
Fax: +49-(0)-251?396371-11
http://52north.org/
General Managers: Dr. Albert Remke, Dr. Andreas Wytzisk
Local Court Muenster HRB 10849


From awpontes at syr.edu  Tue May 29 20:34:24 2012
From: awpontes at syr.edu (Alyssa W. Pontes)
Date: Tue, 29 May 2012 14:34:24 -0400
Subject: [R-sig-Geo] 95% CI w/weighted means K value
Message-ID: <CAEnqg4a43uWMu5dkVwt1BwEU4NKrJAN_qvWg2-uVuX3FTQ0Qjw@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120529/1eabaeff/attachment.pl>

From marcelino.delacruz at upm.es  Tue May 29 21:23:11 2012
From: marcelino.delacruz at upm.es (marcelino.delacruz at upm.es)
Date: Tue, 29 May 2012 20:23:11 +0100
Subject: [R-sig-Geo] 95% CI w/weighted means K value
In-Reply-To: <CAEnqg4a43uWMu5dkVwt1BwEU4NKrJAN_qvWg2-uVuX3FTQ0Qjw@mail.gmail.com>
Message-ID: <Y2anz6D6.1338319391.0732450.marcelino.delacruz@upm.es>

If you mean Ripley's K (without "correlation") and confidence
envelopes instead of CI, it is very easy with the function pool.envelope
in spatstat.
See the examples in help(pool.envelope)

Cheers,

Marcelino


Con fecha 29/5/2012, "Alyssa W. Pontes" <awpontes at syr.edu> escribi?:

>I am trying to figure out the Ripley's K correlation between points for 5
>replicates.  What I am currently doing is determining the Kcross values for
>each and taking a weighted mean to combine all the replicates into one
>value.  Now, what I need to do is determine whether or not this data is
>statistically significant.  How do I get a 95% CI for these points with the
>weighted mean?
>
>-Alyssa
>
>	[[alternative HTML version deleted]]
>
>_______________________________________________
>R-sig-Geo mailing list
>R-sig-Geo at r-project.org
>https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From awpontes at syr.edu  Tue May 29 22:19:55 2012
From: awpontes at syr.edu (Alyssa W. Pontes)
Date: Tue, 29 May 2012 16:19:55 -0400
Subject: [R-sig-Geo] 95% CI w/weighted means K value
In-Reply-To: <8ee95cc44189451b8c9dd9224e01f7ee@CH1PRD0102HT024.prod.exchangelabs.com>
References: <CAEnqg4a43uWMu5dkVwt1BwEU4NKrJAN_qvWg2-uVuX3FTQ0Qjw@mail.gmail.com>
	<8ee95cc44189451b8c9dd9224e01f7ee@CH1PRD0102HT024.prod.exchangelabs.com>
Message-ID: <CAEnqg4Yz=KEJoaC_f7vzY4mFKddpNgZpaTDmwHi2jRQOzyC2+g@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120529/84ab62c3/attachment.pl>

From r.turner at auckland.ac.nz  Wed May 30 02:14:29 2012
From: r.turner at auckland.ac.nz (Rolf Turner)
Date: Wed, 30 May 2012 12:14:29 +1200
Subject: [R-sig-Geo] 95% CI w/weighted means K value
In-Reply-To: <CAEnqg4Yz=KEJoaC_f7vzY4mFKddpNgZpaTDmwHi2jRQOzyC2+g@mail.gmail.com>
References: <CAEnqg4a43uWMu5dkVwt1BwEU4NKrJAN_qvWg2-uVuX3FTQ0Qjw@mail.gmail.com>
	<8ee95cc44189451b8c9dd9224e01f7ee@CH1PRD0102HT024.prod.exchangelabs.com>
	<CAEnqg4Yz=KEJoaC_f7vzY4mFKddpNgZpaTDmwHi2jRQOzyC2+g@mail.gmail.com>
Message-ID: <4FC56665.2070408@auckland.ac.nz>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120530/4ae44cf1/attachment.pl>

From Adrian.Baddeley at csiro.au  Wed May 30 03:19:04 2012
From: Adrian.Baddeley at csiro.au (Adrian.Baddeley at csiro.au)
Date: Wed, 30 May 2012 09:19:04 +0800
Subject: [R-sig-Geo] 95% CI w/weighted means K value
In-Reply-To: <4FC56665.2070408@auckland.ac.nz>
References: <CAEnqg4a43uWMu5dkVwt1BwEU4NKrJAN_qvWg2-uVuX3FTQ0Qjw@mail.gmail.com>
	<8ee95cc44189451b8c9dd9224e01f7ee@CH1PRD0102HT024.prod.exchangelabs.com>
	<CAEnqg4Yz=KEJoaC_f7vzY4mFKddpNgZpaTDmwHi2jRQOzyC2+g@mail.gmail.com>,
	<4FC56665.2070408@auckland.ac.nz>
Message-ID: <57DC18C299094D4299F837570C5DF1C57D93DC06BD@EXWA-MBX01.nexus.csiro.au>

This question relates to the pooling of estimates of the K-function from separate point patterns (e.g. replicates of the same experiment
or observations of similar patterns in different survey regions). Alyssa wants to obtain a pooled estimate of the true K-function (assuming all the 
patterns were generated by the same point process) and also a confidence interval for this true K-function.

Simulation envelopes are not relevant here. The data permit direct estimation of the standard error.

The relevant function in the 'spatstat' package is "pool.rat" and it works as follows

   1. For each point pattern dataset, apply Kest() with the argument 'ratio=TRUE', for example K1 <- Kest(X1, ratio=TRUE) where X1 is your first point pattern, and so on.

   2. Pool the K estimates using pool.rat:
               K <- pool(K1, K2, ......, Kn) 
     where K1, K2, ... are the estimates obtained in step 1.
     (Alyssa: this performs weighted averaging as you described)

   3. The object 'K' is the pooled K-function. It's an object of class 'fv' and contains columns like the following:
               pooliso: pooled estimate of K using Ripley's isotropic edge correction
               variso: delta-method estimate of variance of Kest with Ripley's isotropic correction
               hiiso: upper limit of two-sigma confidence interval 
               loiso: lower limit of two-sigma confidence interval
      To see the confidence interval, do something like 
            plot(K, pooliso ~ r, shade=c("hiiso", "loiso"))

For further information including references, see help(pool.rat)

Prof Adrian Baddeley FAA
CSIRO Mathematics, Informatics & Statistics
Leeuwin Centre, 65 Brockway Rd, Floreat WA 6014, Australia
tel +61 8 9333 6177 skype adrian.baddeley
________________________________________

On 30/05/12 08:19, Alyssa W. Pontes wrote:

I have been able to use the envelope function for calculating the
individual K values, but I am combining them using a weighted average and
do not know how to make an envelope for the weighted mean combined K
values, which is what my question relates to.

-Alyssa

On Tue, May 29, 2012 at 3:23 PM, marcelino.delacruz at upm.es<mailto:marcelino.delacruz at upm.es> <
marcelino.delacruz at upm.es<mailto:marcelino.delacruz at upm.es>> wrote:



If you mean Ripley's K (without "correlation") and confidence
envelopes instead of CI, it is very easy with the function pool.envelope
in spatstat.
See the examples in help(pool.envelope)

Cheers,

Marcelino


Con fecha 29/5/2012, "Alyssa W. Pontes" <awpontes at syr.edu><mailto:awpontes at syr.edu> escribi?:



I am trying to figure out the Ripley's K correlation between points for 5
replicates.  What I am currently doing is determining the Kcross values


for


each and taking a weighted mean to combine all the replicates into one
value.  Now, what I need to do is determine whether or not this data is
statistically significant.  How do I get a 95% CI for these points with


the


weighted mean?

-Alyssa

      [[alternative HTML version deleted]]

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
https://stat.ethz.ch/mailman/listinfo/r-sig-geo













_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From bgr at bgs.ac.uk  Wed May 30 09:57:57 2012
From: bgr at bgs.ac.uk (Rawlins, Barry G.)
Date: Wed, 30 May 2012 08:57:57 +0100
Subject: [R-sig-Geo] Plotting with stplot, mode="xy"
In-Reply-To: <4FC4F768.8040203@52north.org>
References: <28C15D104A882F47954DEE56148152CC243F7D872B@nerckwmb1.ad.nerc.ac.uk>
	<4FC4A4C5.4040002@uni-muenster.de>
	<28C15D104A882F47954DEE56148152CC243F7D8AFD@nerckwmb1.ad.nerc.ac.uk>
	<4FC4BFAD.60707@uni-muenster.de>
	<28C15D104A882F47954DEE56148152CC243F7D8CDC@nerckwmb1.ad.nerc.ac.uk>
	<4FC4F428.9080508@uni-muenster.de> <4FC4F768.8040203@52north.org>
Message-ID: <28C15D104A882F47954DEE56148152CC24407C86B7@nerckwmb1.ad.nerc.ac.uk>

Daniel and Edzer

I managed to build the stplot.R function and get that working - so thanks for that. The "cut" argument works fine and the scale does not change now as the animation runs. For some reason I needed to make the bin range (min and max) wider than the range of the data to make sure all the xy locations plotted in every amimation (some were dropped otherwise)  - I am not sure why that would be the case.

I will look for some instructions (presumably on other help lists) on how to build a package from the source as that is not something I have done before, but will be pleased to learn.

Best wishes, Barry

 
-----Original Message-----
From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Daniel N?st
Sent: 29 May 2012 17:21
To: r-sig-geo at r-project.org
Subject: Re: [R-sig-Geo] Plotting with stplot, mode="xy"

Am 29.05.2012 18:07, schrieb Edzer Pebesma:
> On 05/29/2012 04:03 PM, Rawlins, Barry G. wrote:
>> I can see a series of folders+files on the svn area - can you just give me some direction on how I get the source code? Were you suggesting I just take the code under R/stplot.R? And build a function from this?
> I was thinking about building and installing the R package from source,
> but that might be a bridge too far if you're not used to doing that.
> 
> It might be easier to source the whole R/stplot.R file in your R session
> -- that should work as well.

The svn also has http access, so

source("https://svn.52north.org/svn/geostatistics/main/spacetime/R/stplot.R")

should do just that.

/Daniel

>> -----Original Message-----
>> From: Edzer Pebesma [mailto:edzer.pebesma at uni-muenster.de] 
>> Sent: 29 May 2012 13:23
>> To: Rawlins, Barry G.
>> Subject: Re: [R-sig-Geo] Plotting with stplot, mode="xy"
>>
>> svn co https://svn.52north.org/svn/geostatistics/main/spacetime/
>>
>> will give you the updated source. Let me know if it works, otherwise
>> we'll try the CRAN route (CRAN seems a bit over-worked, lately, for
>> clear reasons, throwing NOTEs if you're uploading too frequent).
>>
>> I just noticed that the package DESCRIPTION file does not contain this
>> URL -- will modify.
>>
>>
>> On 05/29/2012 01:28 PM, Rawlins, Barry G. wrote:
>>> Many thanks Edzer - it is superb to have your help on such occasions.
>>>
>>> Checking CRAN - the latest version of spacetime appears to be 0.7-0 - does that mean I need to wait for 0.7-1 (which you refer to) to be released?
>>>
>>> I did not copy to the list because I was not sure this question was relevant to my problem.
>>>
>>> Best wishes, Barry
>>>
>>>
>>> -----Original Message-----
>>> From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Edzer Pebesma
>>> Sent: 29 May 2012 11:28
>>> To: r-sig-geo at r-project.org
>>> Subject: Re: [R-sig-Geo] Plotting with stplot, mode="xy"
>>>
>>> Hi Barry, the following should have worked:
>>>
>>> library(spacetime)
>>> loadMeuse()
>>> d = as.data.frame(meuse)[c("cadmium", "copper", "lead", "zinc")]
>>> x = STFDF(meuse, Sys.time()+1:4, stack(d))
>>> stplot(x, animate=1, col.regions=bpy.colors(),
>>>    cuts=c(1,10,100,1000,10000))
>>>
>>> but doesn't fix the legend with current spacetime on CRAN, as the 'cuts'
>>> argument was not passed on to spplot.
>>>
>>> spacetime 0.7-1 in subversion has this fixed.
>>>
>>> the 'col' argument needs to be called 'col.regions'.
>>>
>>> On 05/28/2012 06:34 PM, Rawlins, Barry G. wrote:
>>>> Hello
>>>>  
>>>> I am trying to plot some space-time data which encompasses 3654 time
>>>> intervals (15 mins each) at 84 sites.
>>>>  
>>>> I would like to animate these data and so I have used the following code
>>>> and my STFDF object is "sp_time":
>>>>  
>>>> colors.ten<-rainbow(10,start=0.0,end=0.66) # rainbow color scale
>>>> stplot(sp_time, mode="xy", animate=1, cuts=10, at=seq(5,55,5),
>>>> auto.key=T,col=colors.ten)
>>>>  
>>>> The first plot I see is this where the points are plotted in the correct
>>>> locations:
>>>>  
>>>> But, I wanted some bespoke rainbow colors which do not appear and I know
>>>> the z-range of the data is wider than that shown - the range is actually
>>>> between 6 and 44. When I run the animation the scale changes each time
>>>> but I would like it to be fixed so that each time slice has the same
>>>> scale. Any advice on how I can solve this? I have tried reading the help
>>>> pages on levelplot but to no avail.
>>>>  
>>>> Thanks, Barry
>>>>  
>>>>  
>>>>  
>>>>  
>>>>
>>>> -- 
>>>> This message (and any attachments) is for the recipient only. NERC
>>>> is subject to the Freedom of Information Act 2000 and the contents
>>>> of this email and any reply you make may be disclosed by NERC unless
>>>> it is exempt from release under the Act. Any material supplied to
>>>> NERC may be stored in an electronic records management system.
>>>>
>>>>
>>>> _______________________________________________
>>>> R-sig-Geo mailing list
>>>> R-sig-Geo at r-project.org
>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>
>>
> 


-- 
Daniel N?st
52? North Initiative for Geospatial Open Source Software GmbH
Martin-Luther-King-Weg 24
48155 M?nster, Germany
E-Mail: d.nuest at 52north.org
Fon: +49-(0)-251-396371-36
Fax: +49-(0)-251-396371-11
http://52north.org/
General Managers: Dr. Albert Remke, Dr. Andreas Wytzisk
Local Court Muenster HRB 10849

_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org
https://stat.ethz.ch/mailman/listinfo/r-sig-geo


From bgr at bgs.ac.uk  Wed May 30 10:30:16 2012
From: bgr at bgs.ac.uk (Rawlins, Barry G.)
Date: Wed, 30 May 2012 09:30:16 +0100
Subject: [R-sig-Geo] Plotting with stplot, mode="xy"
In-Reply-To: <4FC5D7E6.9050107@uni-muenster.de>
References: <28C15D104A882F47954DEE56148152CC243F7D872B@nerckwmb1.ad.nerc.ac.uk>
	<4FC4A4C5.4040002@uni-muenster.de>
	<28C15D104A882F47954DEE56148152CC243F7D8AFD@nerckwmb1.ad.nerc.ac.uk>
	<4FC4BFAD.60707@uni-muenster.de>
	<28C15D104A882F47954DEE56148152CC243F7D8CDC@nerckwmb1.ad.nerc.ac.uk>
	<4FC4F428.9080508@uni-muenster.de> <4FC4F768.8040203@52north.org>
	<28C15D104A882F47954DEE56148152CC24407C86B7@nerckwmb1.ad.nerc.ac.uk>
	<4FC5D7E6.9050107@uni-muenster.de>
Message-ID: <28C15D104A882F47954DEE56148152CC24407C872E@nerckwmb1.ad.nerc.ac.uk>

Edzer

Here is the data attached as an object and code to run it below:

load(file="sp_time_slice.RData")

range(sp_time_slice at data$VMC) #[1] 20.7 36.8

# so with narrow ranges (20 to 37) - some symbols dropped

stplot(sp_time_slice, animate=1, col.regions=rainbow(10,start=0.0,end=0.66),cex=2,cuts=c(seq(20,37,1.7)))

# with wider ranges (18, 38) all symbols plot

stplot(sp_time_slice, animate=1, col.regions=rainbow(10,start=0.0,end=0.66),cex=2,cuts=c(seq(18,38,2)))

I am also struggling to get a title to plot using either

lattice.options=list(main="Sensor Net volumetric moisture content (%)"))
or 
main=list(label="Sensor Net volumetric moisture content (%)")

Error in trellis.skeleton(formula = y2 ~ x2, cond = list(c(1L, 1L, 1L,  : 
  formal argument "main" matched by multiple actual arguments
In addition: Warning message:
In seq.default(min(obj[[z]], na.rm = TRUE), max(obj[[z]], na.rm = TRUE),  :
  first element used of 'length.out' argument

What would you use?

Barry

-----Original Message-----
From: Edzer Pebesma [mailto:edzer.pebesma at uni-muenster.de] 
Sent: 30 May 2012 09:19
To: Rawlins, Barry G.
Subject: Re: [R-sig-Geo] Plotting with stplot, mode="xy"

Barry,

could you please provide me with a reproducible example that
demonstrates that min/max values passed as extremes of cuts discards
some points?

I cannot reproduce it with:

> library(sp)
> loadMeuse()
> m = meuse[1:4,]
> m
       coordinates cadmium copper lead zinc  elev       dist   om ffreq soil
1 (181072, 333611)    11.7     85  299 1022 7.909 0.00135803 13.6     1    1
2 (181025, 333558)     8.6     81  277 1141 6.983 0.01222430 14.0     1    1
3 (181165, 333537)     6.5     68  199  640 7.800 0.10302900 13.0     1    1
4 (181298, 333484)     2.6     81  116  257 7.655 0.19009400  8.0     1    2
  lime landuse dist.m
1    1      Ah     50
2    1      Ah     30
3    1      Ah    150
4    0      Ga    270
> spplot(m["om"], cuts=c(8,10,12,14),col.regions=bpy.colors())
> spplot(m["cadmium"], cuts=c(2.6,8,11.7),col.regions=bpy.colors())


On 05/30/2012 09:57 AM, Rawlins, Barry G. wrote:
> Daniel and Edzer
> 
> I managed to build the stplot.R function and get that working - so thanks for that. The "cut" argument works fine and the scale does not change now as the animation runs. For some reason I needed to make the bin range (min and max) wider than the range of the data to make sure all the xy locations plotted in every amimation (some were dropped otherwise)  - I am not sure why that would be the case.
> 
> I will look for some instructions (presumably on other help lists) on how to build a package from the source as that is not something I have done before, but will be pleased to learn.
> 
> Best wishes, Barry
> 
>  
> -----Original Message-----
> From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Daniel N?st
> Sent: 29 May 2012 17:21
> To: r-sig-geo at r-project.org
> Subject: Re: [R-sig-Geo] Plotting with stplot, mode="xy"
> 
> Am 29.05.2012 18:07, schrieb Edzer Pebesma:
>> On 05/29/2012 04:03 PM, Rawlins, Barry G. wrote:
>>> I can see a series of folders+files on the svn area - can you just give me some direction on how I get the source code? Were you suggesting I just take the code under R/stplot.R? And build a function from this?
>> I was thinking about building and installing the R package from source,
>> but that might be a bridge too far if you're not used to doing that.
>>
>> It might be easier to source the whole R/stplot.R file in your R session
>> -- that should work as well.
> 
> The svn also has http access, so
> 
> source("https://svn.52north.org/svn/geostatistics/main/spacetime/R/stplot.R")
> 
> should do just that.
> 
> /Daniel
> 
>>> -----Original Message-----
>>> From: Edzer Pebesma [mailto:edzer.pebesma at uni-muenster.de] 
>>> Sent: 29 May 2012 13:23
>>> To: Rawlins, Barry G.
>>> Subject: Re: [R-sig-Geo] Plotting with stplot, mode="xy"
>>>
>>> svn co https://svn.52north.org/svn/geostatistics/main/spacetime/
>>>
>>> will give you the updated source. Let me know if it works, otherwise
>>> we'll try the CRAN route (CRAN seems a bit over-worked, lately, for
>>> clear reasons, throwing NOTEs if you're uploading too frequent).
>>>
>>> I just noticed that the package DESCRIPTION file does not contain this
>>> URL -- will modify.
>>>
>>>
>>> On 05/29/2012 01:28 PM, Rawlins, Barry G. wrote:
>>>> Many thanks Edzer - it is superb to have your help on such occasions.
>>>>
>>>> Checking CRAN - the latest version of spacetime appears to be 0.7-0 - does that mean I need to wait for 0.7-1 (which you refer to) to be released?
>>>>
>>>> I did not copy to the list because I was not sure this question was relevant to my problem.
>>>>
>>>> Best wishes, Barry
>>>>
>>>>
>>>> -----Original Message-----
>>>> From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Edzer Pebesma
>>>> Sent: 29 May 2012 11:28
>>>> To: r-sig-geo at r-project.org
>>>> Subject: Re: [R-sig-Geo] Plotting with stplot, mode="xy"
>>>>
>>>> Hi Barry, the following should have worked:
>>>>
>>>> library(spacetime)
>>>> loadMeuse()
>>>> d = as.data.frame(meuse)[c("cadmium", "copper", "lead", "zinc")]
>>>> x = STFDF(meuse, Sys.time()+1:4, stack(d))
>>>> stplot(x, animate=1, col.regions=bpy.colors(),
>>>>    cuts=c(1,10,100,1000,10000))
>>>>
>>>> but doesn't fix the legend with current spacetime on CRAN, as the 'cuts'
>>>> argument was not passed on to spplot.
>>>>
>>>> spacetime 0.7-1 in subversion has this fixed.
>>>>
>>>> the 'col' argument needs to be called 'col.regions'.
>>>>
>>>> On 05/28/2012 06:34 PM, Rawlins, Barry G. wrote:
>>>>> Hello
>>>>>  
>>>>> I am trying to plot some space-time data which encompasses 3654 time
>>>>> intervals (15 mins each) at 84 sites.
>>>>>  
>>>>> I would like to animate these data and so I have used the following code
>>>>> and my STFDF object is "sp_time":
>>>>>  
>>>>> colors.ten<-rainbow(10,start=0.0,end=0.66) # rainbow color scale
>>>>> stplot(sp_time, mode="xy", animate=1, cuts=10, at=seq(5,55,5),
>>>>> auto.key=T,col=colors.ten)
>>>>>  
>>>>> The first plot I see is this where the points are plotted in the correct
>>>>> locations:
>>>>>  
>>>>> But, I wanted some bespoke rainbow colors which do not appear and I know
>>>>> the z-range of the data is wider than that shown - the range is actually
>>>>> between 6 and 44. When I run the animation the scale changes each time
>>>>> but I would like it to be fixed so that each time slice has the same
>>>>> scale. Any advice on how I can solve this? I have tried reading the help
>>>>> pages on levelplot but to no avail.
>>>>>  
>>>>> Thanks, Barry
>>>>>  
>>>>>  
>>>>>  
>>>>>  
>>>>>
>>>>> -- 
>>>>> This message (and any attachments) is for the recipient only. NERC
>>>>> is subject to the Freedom of Information Act 2000 and the contents
>>>>> of this email and any reply you make may be disclosed by NERC unless
>>>>> it is exempt from release under the Act. Any material supplied to
>>>>> NERC may be stored in an electronic records management system.
>>>>>
>>>>>
>>>>> _______________________________________________
>>>>> R-sig-Geo mailing list
>>>>> R-sig-Geo at r-project.org
>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>
>>>
>>
> 
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de
-------------- next part --------------
A non-text attachment was scrubbed...
Name: sp_time_slice.RData
Type: application/octet-stream
Size: 4372 bytes
Desc: sp_time_slice.RData
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120530/7482ff37/attachment.obj>

From bgr at bgs.ac.uk  Wed May 30 11:02:55 2012
From: bgr at bgs.ac.uk (Rawlins, Barry G.)
Date: Wed, 30 May 2012 10:02:55 +0100
Subject: [R-sig-Geo] Plotting with stplot, mode="xy"
In-Reply-To: <4FC5DD28.80800@uni-muenster.de>
References: <28C15D104A882F47954DEE56148152CC243F7D872B@nerckwmb1.ad.nerc.ac.uk>
	<4FC4A4C5.4040002@uni-muenster.de>
	<28C15D104A882F47954DEE56148152CC243F7D8AFD@nerckwmb1.ad.nerc.ac.uk>
	<4FC4BFAD.60707@uni-muenster.de>
	<28C15D104A882F47954DEE56148152CC243F7D8CDC@nerckwmb1.ad.nerc.ac.uk>
	<4FC4F428.9080508@uni-muenster.de> <4FC4F768.8040203@52north.org>
	<28C15D104A882F47954DEE56148152CC24407C86B7@nerckwmb1.ad.nerc.ac.uk>
	<4FC5D7E6.9050107@uni-muenster.de>
	<28C15D104A882F47954DEE56148152CC24407C872E@nerckwmb1.ad.nerc.ac.uk>
	<4FC5DD28.80800@uni-muenster.de>
Message-ID: <28C15D104A882F47954DEE56148152CC2441A112EF@nerckwmb1.ad.nerc.ac.uk>

Yes that solves it- thanks.

Re: title - yes I was thinking of a title other than the "time" and I will try subtitle or putting it into an axis label - that is fine.

Sorry, one further thing - trying to save the animation to a GIF with:

library(animation)
saveGIF(

stplot(sp_time_slice, animate=1,
col.regions=rainbow(11,start=0.0,end=0.66),cex=2,cuts=c(seq(r[1],r[2],length.out=11)))

)

The animated plot just goes back to the start and the GIF does not get saved - I assume this is because stplot is not in a loop which is what saveGIF appears to require to save an animation. Any ideas how I would resolve that? I tried:

out<-stplot(sp_time_slice,...

saveGIF
(
print(out)
)

But that was no good.

By the way - these data are soil moisture sensor data (15 minute intervals) from a hillslope responding to incident rainfall. I would be happy for you to use these as example data if that is useful to you. 

Best wishes, Barry

-----Original Message-----
From: Edzer Pebesma [mailto:edzer.pebesma at uni-muenster.de] 
Sent: 30 May 2012 09:41
To: Rawlins, Barry G.
Subject: Re: [R-sig-Geo] Plotting with stplot, mode="xy"

with

> r= range(sp_time_slice at data$VMC) #[1] 20.7 36.8
> stplot(sp_time_slice, animate=1,
col.regions=rep(1,10),cex=2,cuts=c(seq(r[1],r[2],length.out=11)))

I don't see points dropping, do you?

On 05/30/2012 10:30 AM, Rawlins, Barry G. wrote:
> Edzer
> 
> Here is the data attached as an object and code to run it below:
> 
> load(file="sp_time_slice.RData")
> 
> range(sp_time_slice at data$VMC) #[1] 20.7 36.8
> 
> # so with narrow ranges (20 to 37) - some symbols dropped
> 
> stplot(sp_time_slice, animate=1, col.regions=rainbow(10,start=0.0,end=0.66),cex=2,cuts=c(seq(20,37,1.7)))
> 
> # with wider ranges (18, 38) all symbols plot
> 
> stplot(sp_time_slice, animate=1, col.regions=rainbow(10,start=0.0,end=0.66),cex=2,cuts=c(seq(18,38,2)))
> 
> I am also struggling to get a title to plot using either
> 
> lattice.options=list(main="Sensor Net volumetric moisture content (%)"))
> or 
> main=list(label="Sensor Net volumetric moisture content (%)")
> 
> Error in trellis.skeleton(formula = y2 ~ x2, cond = list(c(1L, 1L, 1L,  : 
>   formal argument "main" matched by multiple actual arguments
> In addition: Warning message:
> In seq.default(min(obj[[z]], na.rm = TRUE), max(obj[[z]], na.rm = TRUE),  :
>   first element used of 'length.out' argument
> 
> What would you use?

Well, that's a nice feature request -- I haven't given it much thought,
and main obviously is not allowed. You could use xlab="some title" or
sub="subtitle" to see something, but I agree it's not optimal; you'd
like to have time in subtitle when a main is given, right?

> 
> Barry
> 
> -----Original Message-----
> From: Edzer Pebesma [mailto:edzer.pebesma at uni-muenster.de] 
> Sent: 30 May 2012 09:19
> To: Rawlins, Barry G.
> Subject: Re: [R-sig-Geo] Plotting with stplot, mode="xy"
> 
> Barry,
> 
> could you please provide me with a reproducible example that
> demonstrates that min/max values passed as extremes of cuts discards
> some points?
> 
> I cannot reproduce it with:
> 
>> library(sp)
>> loadMeuse()
>> m = meuse[1:4,]
>> m
>        coordinates cadmium copper lead zinc  elev       dist   om ffreq soil
> 1 (181072, 333611)    11.7     85  299 1022 7.909 0.00135803 13.6     1    1
> 2 (181025, 333558)     8.6     81  277 1141 6.983 0.01222430 14.0     1    1
> 3 (181165, 333537)     6.5     68  199  640 7.800 0.10302900 13.0     1    1
> 4 (181298, 333484)     2.6     81  116  257 7.655 0.19009400  8.0     1    2
>   lime landuse dist.m
> 1    1      Ah     50
> 2    1      Ah     30
> 3    1      Ah    150
> 4    0      Ga    270
>> spplot(m["om"], cuts=c(8,10,12,14),col.regions=bpy.colors())
>> spplot(m["cadmium"], cuts=c(2.6,8,11.7),col.regions=bpy.colors())
> 
> 
> On 05/30/2012 09:57 AM, Rawlins, Barry G. wrote:
>> Daniel and Edzer
>>
>> I managed to build the stplot.R function and get that working - so thanks for that. The "cut" argument works fine and the scale does not change now as the animation runs. For some reason I needed to make the bin range (min and max) wider than the range of the data to make sure all the xy locations plotted in every amimation (some were dropped otherwise)  - I am not sure why that would be the case.
>>
>> I will look for some instructions (presumably on other help lists) on how to build a package from the source as that is not something I have done before, but will be pleased to learn.
>>
>> Best wishes, Barry
>>
>>  
>> -----Original Message-----
>> From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Daniel N?st
>> Sent: 29 May 2012 17:21
>> To: r-sig-geo at r-project.org
>> Subject: Re: [R-sig-Geo] Plotting with stplot, mode="xy"
>>
>> Am 29.05.2012 18:07, schrieb Edzer Pebesma:
>>> On 05/29/2012 04:03 PM, Rawlins, Barry G. wrote:
>>>> I can see a series of folders+files on the svn area - can you just give me some direction on how I get the source code? Were you suggesting I just take the code under R/stplot.R? And build a function from this?
>>> I was thinking about building and installing the R package from source,
>>> but that might be a bridge too far if you're not used to doing that.
>>>
>>> It might be easier to source the whole R/stplot.R file in your R session
>>> -- that should work as well.
>>
>> The svn also has http access, so
>>
>> source("https://svn.52north.org/svn/geostatistics/main/spacetime/R/stplot.R")
>>
>> should do just that.
>>
>> /Daniel
>>
>>>> -----Original Message-----
>>>> From: Edzer Pebesma [mailto:edzer.pebesma at uni-muenster.de] 
>>>> Sent: 29 May 2012 13:23
>>>> To: Rawlins, Barry G.
>>>> Subject: Re: [R-sig-Geo] Plotting with stplot, mode="xy"
>>>>
>>>> svn co https://svn.52north.org/svn/geostatistics/main/spacetime/
>>>>
>>>> will give you the updated source. Let me know if it works, otherwise
>>>> we'll try the CRAN route (CRAN seems a bit over-worked, lately, for
>>>> clear reasons, throwing NOTEs if you're uploading too frequent).
>>>>
>>>> I just noticed that the package DESCRIPTION file does not contain this
>>>> URL -- will modify.
>>>>
>>>>
>>>> On 05/29/2012 01:28 PM, Rawlins, Barry G. wrote:
>>>>> Many thanks Edzer - it is superb to have your help on such occasions.
>>>>>
>>>>> Checking CRAN - the latest version of spacetime appears to be 0.7-0 - does that mean I need to wait for 0.7-1 (which you refer to) to be released?
>>>>>
>>>>> I did not copy to the list because I was not sure this question was relevant to my problem.
>>>>>
>>>>> Best wishes, Barry
>>>>>
>>>>>
>>>>> -----Original Message-----
>>>>> From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Edzer Pebesma
>>>>> Sent: 29 May 2012 11:28
>>>>> To: r-sig-geo at r-project.org
>>>>> Subject: Re: [R-sig-Geo] Plotting with stplot, mode="xy"
>>>>>
>>>>> Hi Barry, the following should have worked:
>>>>>
>>>>> library(spacetime)
>>>>> loadMeuse()
>>>>> d = as.data.frame(meuse)[c("cadmium", "copper", "lead", "zinc")]
>>>>> x = STFDF(meuse, Sys.time()+1:4, stack(d))
>>>>> stplot(x, animate=1, col.regions=bpy.colors(),
>>>>>    cuts=c(1,10,100,1000,10000))
>>>>>
>>>>> but doesn't fix the legend with current spacetime on CRAN, as the 'cuts'
>>>>> argument was not passed on to spplot.
>>>>>
>>>>> spacetime 0.7-1 in subversion has this fixed.
>>>>>
>>>>> the 'col' argument needs to be called 'col.regions'.
>>>>>
>>>>> On 05/28/2012 06:34 PM, Rawlins, Barry G. wrote:
>>>>>> Hello
>>>>>>  
>>>>>> I am trying to plot some space-time data which encompasses 3654 time
>>>>>> intervals (15 mins each) at 84 sites.
>>>>>>  
>>>>>> I would like to animate these data and so I have used the following code
>>>>>> and my STFDF object is "sp_time":
>>>>>>  
>>>>>> colors.ten<-rainbow(10,start=0.0,end=0.66) # rainbow color scale
>>>>>> stplot(sp_time, mode="xy", animate=1, cuts=10, at=seq(5,55,5),
>>>>>> auto.key=T,col=colors.ten)
>>>>>>  
>>>>>> The first plot I see is this where the points are plotted in the correct
>>>>>> locations:
>>>>>>  
>>>>>> But, I wanted some bespoke rainbow colors which do not appear and I know
>>>>>> the z-range of the data is wider than that shown - the range is actually
>>>>>> between 6 and 44. When I run the animation the scale changes each time
>>>>>> but I would like it to be fixed so that each time slice has the same
>>>>>> scale. Any advice on how I can solve this? I have tried reading the help
>>>>>> pages on levelplot but to no avail.
>>>>>>  
>>>>>> Thanks, Barry
>>>>>>  
>>>>>>  
>>>>>>  
>>>>>>  
>>>>>>
>>>>>> -- 
>>>>>> This message (and any attachments) is for the recipient only. NERC
>>>>>> is subject to the Freedom of Information Act 2000 and the contents
>>>>>> of this email and any reply you make may be disclosed by NERC unless
>>>>>> it is exempt from release under the Act. Any material supplied to
>>>>>> NERC may be stored in an electronic records management system.
>>>>>>
>>>>>>
>>>>>> _______________________________________________
>>>>>> R-sig-Geo mailing list
>>>>>> R-sig-Geo at r-project.org
>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>
>>>>
>>>
>>
>>
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From matteo.mattiuzzi at boku.ac.at  Wed May 30 11:13:23 2012
From: matteo.mattiuzzi at boku.ac.at (Matteo Mattiuzzi)
Date: Wed, 30 May 2012 11:13:23 +0200
Subject: [R-sig-Geo] Antw: Re:  MODIS imagery
In-Reply-To: <4F9FC078.2070407@cirad.fr>
References: <mailman.0.1335798846.25347.r-sig-geo@r-project.org>
	<CAAvcZ+tAwtYaQM8-K=5woFEb6+=QrDAd65wU5y2Wm3AxK88csw@mail.gmail.com>
	<8D43BC70-93D5-45EE-AA67-74DD16E629A9@gmail.com>
	<4F9EB855.5090309@cirad.fr> <4F9EC1F3.3030302@uni-muenster.de>
	<4F9FC078.2070407@cirad.fr>
Message-ID: <4FC600D30200002700014387@gwia2.boku.ac.at>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120530/d47b7e2c/attachment.pl>

From bgr at bgs.ac.uk  Wed May 30 11:33:07 2012
From: bgr at bgs.ac.uk (Rawlins, Barry G.)
Date: Wed, 30 May 2012 10:33:07 +0100
Subject: [R-sig-Geo] Plotting with stplot, mode="xy"
In-Reply-To: <4FC5E823.6040808@uni-muenster.de>
References: <28C15D104A882F47954DEE56148152CC243F7D872B@nerckwmb1.ad.nerc.ac.uk>
	<4FC4A4C5.4040002@uni-muenster.de>
	<28C15D104A882F47954DEE56148152CC243F7D8AFD@nerckwmb1.ad.nerc.ac.uk>
	<4FC4BFAD.60707@uni-muenster.de>
	<28C15D104A882F47954DEE56148152CC243F7D8CDC@nerckwmb1.ad.nerc.ac.uk>
	<4FC4F428.9080508@uni-muenster.de> <4FC4F768.8040203@52north.org>
	<28C15D104A882F47954DEE56148152CC24407C86B7@nerckwmb1.ad.nerc.ac.uk>
	<4FC5D7E6.9050107@uni-muenster.de>
	<28C15D104A882F47954DEE56148152CC24407C872E@nerckwmb1.ad.nerc.ac.uk>
	<4FC5DD28.80800@uni-muenster.de>
	<28C15D104A882F47954DEE56148152CC2441A112EF@nerckwmb1.ad.nerc.ac.uk>
	<4FC5E823.6040808@uni-muenster.de>
Message-ID: <28C15D104A882F47954DEE56148152CC2441A11358@nerckwmb1.ad.nerc.ac.uk>

Hello Edzer

To be clear - your alteration to the cut argument in the code below:

stplot(sp_time_slice, animate=1,
col.regions=rainbow(11,start=0.0,end=0.66),cex=2,cuts=c(seq(r[1],r[2],length.out=11)))

meant that points were not dropped when I ran the code.
Barry


-----Original Message-----
From: Edzer Pebesma [mailto:edzer.pebesma at uni-muenster.de] 
Sent: 30 May 2012 10:28
To: Rawlins, Barry G.
Subject: Re: [R-sig-Geo] Plotting with stplot, mode="xy"

Please be careful including off-list messages in on-list replies.

I wanted to get clear whether your on-list suggestion that spplot (or
stplot) drops points is true, or not. Your answer still leaves me in doubt.

On 05/30/2012 11:02 AM, Rawlins, Barry G. wrote:
> Yes that solves it- thanks.
> 
> Re: title - yes I was thinking of a title other than the "time" and I will try subtitle or putting it into an axis label - that is fine.
> 
> Sorry, one further thing - trying to save the animation to a GIF with:
> 
> library(animation)
> saveGIF(
> 
> stplot(sp_time_slice, animate=1,
> col.regions=rainbow(11,start=0.0,end=0.66),cex=2,cuts=c(seq(r[1],r[2],length.out=11)))
> 
> )
> 
> The animated plot just goes back to the start and the GIF does not get saved - I assume this is because stplot is not in a loop which is what saveGIF appears to require to save an animation. Any ideas how I would resolve that? I tried:
> 
> out<-stplot(sp_time_slice,...
> 
> saveGIF
> (
> print(out)
> )
> 
> But that was no good.
> 
> By the way - these data are soil moisture sensor data (15 minute intervals) from a hillslope responding to incident rainfall. I would be happy for you to use these as example data if that is useful to you. 
> 
> Best wishes, Barry
> 
> -----Original Message-----
> From: Edzer Pebesma [mailto:edzer.pebesma at uni-muenster.de] 
> Sent: 30 May 2012 09:41
> To: Rawlins, Barry G.
> Subject: Re: [R-sig-Geo] Plotting with stplot, mode="xy"
> 
> with
> 
>> r= range(sp_time_slice at data$VMC) #[1] 20.7 36.8
>> stplot(sp_time_slice, animate=1,
> col.regions=rep(1,10),cex=2,cuts=c(seq(r[1],r[2],length.out=11)))
> 
> I don't see points dropping, do you?
> 
> On 05/30/2012 10:30 AM, Rawlins, Barry G. wrote:
>> Edzer
>>
>> Here is the data attached as an object and code to run it below:
>>
>> load(file="sp_time_slice.RData")
>>
>> range(sp_time_slice at data$VMC) #[1] 20.7 36.8
>>
>> # so with narrow ranges (20 to 37) - some symbols dropped
>>
>> stplot(sp_time_slice, animate=1, col.regions=rainbow(10,start=0.0,end=0.66),cex=2,cuts=c(seq(20,37,1.7)))
>>
>> # with wider ranges (18, 38) all symbols plot
>>
>> stplot(sp_time_slice, animate=1, col.regions=rainbow(10,start=0.0,end=0.66),cex=2,cuts=c(seq(18,38,2)))
>>
>> I am also struggling to get a title to plot using either
>>
>> lattice.options=list(main="Sensor Net volumetric moisture content (%)"))
>> or 
>> main=list(label="Sensor Net volumetric moisture content (%)")
>>
>> Error in trellis.skeleton(formula = y2 ~ x2, cond = list(c(1L, 1L, 1L,  : 
>>   formal argument "main" matched by multiple actual arguments
>> In addition: Warning message:
>> In seq.default(min(obj[[z]], na.rm = TRUE), max(obj[[z]], na.rm = TRUE),  :
>>   first element used of 'length.out' argument
>>
>> What would you use?
> 
> Well, that's a nice feature request -- I haven't given it much thought,
> and main obviously is not allowed. You could use xlab="some title" or
> sub="subtitle" to see something, but I agree it's not optimal; you'd
> like to have time in subtitle when a main is given, right?
> 
>>
>> Barry
>>
>> -----Original Message-----
>> From: Edzer Pebesma [mailto:edzer.pebesma at uni-muenster.de] 
>> Sent: 30 May 2012 09:19
>> To: Rawlins, Barry G.
>> Subject: Re: [R-sig-Geo] Plotting with stplot, mode="xy"
>>
>> Barry,
>>
>> could you please provide me with a reproducible example that
>> demonstrates that min/max values passed as extremes of cuts discards
>> some points?
>>
>> I cannot reproduce it with:
>>
>>> library(sp)
>>> loadMeuse()
>>> m = meuse[1:4,]
>>> m
>>        coordinates cadmium copper lead zinc  elev       dist   om ffreq soil
>> 1 (181072, 333611)    11.7     85  299 1022 7.909 0.00135803 13.6     1    1
>> 2 (181025, 333558)     8.6     81  277 1141 6.983 0.01222430 14.0     1    1
>> 3 (181165, 333537)     6.5     68  199  640 7.800 0.10302900 13.0     1    1
>> 4 (181298, 333484)     2.6     81  116  257 7.655 0.19009400  8.0     1    2
>>   lime landuse dist.m
>> 1    1      Ah     50
>> 2    1      Ah     30
>> 3    1      Ah    150
>> 4    0      Ga    270
>>> spplot(m["om"], cuts=c(8,10,12,14),col.regions=bpy.colors())
>>> spplot(m["cadmium"], cuts=c(2.6,8,11.7),col.regions=bpy.colors())
>>
>>
>> On 05/30/2012 09:57 AM, Rawlins, Barry G. wrote:
>>> Daniel and Edzer
>>>
>>> I managed to build the stplot.R function and get that working - so thanks for that. The "cut" argument works fine and the scale does not change now as the animation runs. For some reason I needed to make the bin range (min and max) wider than the range of the data to make sure all the xy locations plotted in every amimation (some were dropped otherwise)  - I am not sure why that would be the case.
>>>
>>> I will look for some instructions (presumably on other help lists) on how to build a package from the source as that is not something I have done before, but will be pleased to learn.
>>>
>>> Best wishes, Barry
>>>
>>>  
>>> -----Original Message-----
>>> From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Daniel N?st
>>> Sent: 29 May 2012 17:21
>>> To: r-sig-geo at r-project.org
>>> Subject: Re: [R-sig-Geo] Plotting with stplot, mode="xy"
>>>
>>> Am 29.05.2012 18:07, schrieb Edzer Pebesma:
>>>> On 05/29/2012 04:03 PM, Rawlins, Barry G. wrote:
>>>>> I can see a series of folders+files on the svn area - can you just give me some direction on how I get the source code? Were you suggesting I just take the code under R/stplot.R? And build a function from this?
>>>> I was thinking about building and installing the R package from source,
>>>> but that might be a bridge too far if you're not used to doing that.
>>>>
>>>> It might be easier to source the whole R/stplot.R file in your R session
>>>> -- that should work as well.
>>>
>>> The svn also has http access, so
>>>
>>> source("https://svn.52north.org/svn/geostatistics/main/spacetime/R/stplot.R")
>>>
>>> should do just that.
>>>
>>> /Daniel
>>>
>>>>> -----Original Message-----
>>>>> From: Edzer Pebesma [mailto:edzer.pebesma at uni-muenster.de] 
>>>>> Sent: 29 May 2012 13:23
>>>>> To: Rawlins, Barry G.
>>>>> Subject: Re: [R-sig-Geo] Plotting with stplot, mode="xy"
>>>>>
>>>>> svn co https://svn.52north.org/svn/geostatistics/main/spacetime/
>>>>>
>>>>> will give you the updated source. Let me know if it works, otherwise
>>>>> we'll try the CRAN route (CRAN seems a bit over-worked, lately, for
>>>>> clear reasons, throwing NOTEs if you're uploading too frequent).
>>>>>
>>>>> I just noticed that the package DESCRIPTION file does not contain this
>>>>> URL -- will modify.
>>>>>
>>>>>
>>>>> On 05/29/2012 01:28 PM, Rawlins, Barry G. wrote:
>>>>>> Many thanks Edzer - it is superb to have your help on such occasions.
>>>>>>
>>>>>> Checking CRAN - the latest version of spacetime appears to be 0.7-0 - does that mean I need to wait for 0.7-1 (which you refer to) to be released?
>>>>>>
>>>>>> I did not copy to the list because I was not sure this question was relevant to my problem.
>>>>>>
>>>>>> Best wishes, Barry
>>>>>>
>>>>>>
>>>>>> -----Original Message-----
>>>>>> From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Edzer Pebesma
>>>>>> Sent: 29 May 2012 11:28
>>>>>> To: r-sig-geo at r-project.org
>>>>>> Subject: Re: [R-sig-Geo] Plotting with stplot, mode="xy"
>>>>>>
>>>>>> Hi Barry, the following should have worked:
>>>>>>
>>>>>> library(spacetime)
>>>>>> loadMeuse()
>>>>>> d = as.data.frame(meuse)[c("cadmium", "copper", "lead", "zinc")]
>>>>>> x = STFDF(meuse, Sys.time()+1:4, stack(d))
>>>>>> stplot(x, animate=1, col.regions=bpy.colors(),
>>>>>>    cuts=c(1,10,100,1000,10000))
>>>>>>
>>>>>> but doesn't fix the legend with current spacetime on CRAN, as the 'cuts'
>>>>>> argument was not passed on to spplot.
>>>>>>
>>>>>> spacetime 0.7-1 in subversion has this fixed.
>>>>>>
>>>>>> the 'col' argument needs to be called 'col.regions'.
>>>>>>
>>>>>> On 05/28/2012 06:34 PM, Rawlins, Barry G. wrote:
>>>>>>> Hello
>>>>>>>  
>>>>>>> I am trying to plot some space-time data which encompasses 3654 time
>>>>>>> intervals (15 mins each) at 84 sites.
>>>>>>>  
>>>>>>> I would like to animate these data and so I have used the following code
>>>>>>> and my STFDF object is "sp_time":
>>>>>>>  
>>>>>>> colors.ten<-rainbow(10,start=0.0,end=0.66) # rainbow color scale
>>>>>>> stplot(sp_time, mode="xy", animate=1, cuts=10, at=seq(5,55,5),
>>>>>>> auto.key=T,col=colors.ten)
>>>>>>>  
>>>>>>> The first plot I see is this where the points are plotted in the correct
>>>>>>> locations:
>>>>>>>  
>>>>>>> But, I wanted some bespoke rainbow colors which do not appear and I know
>>>>>>> the z-range of the data is wider than that shown - the range is actually
>>>>>>> between 6 and 44. When I run the animation the scale changes each time
>>>>>>> but I would like it to be fixed so that each time slice has the same
>>>>>>> scale. Any advice on how I can solve this? I have tried reading the help
>>>>>>> pages on levelplot but to no avail.
>>>>>>>  
>>>>>>> Thanks, Barry
>>>>>>>  
>>>>>>>  
>>>>>>>  
>>>>>>>  
>>>>>>>
>>>>>>> -- 
>>>>>>> This message (and any attachments) is for the recipient only. NERC
>>>>>>> is subject to the Freedom of Information Act 2000 and the contents
>>>>>>> of this email and any reply you make may be disclosed by NERC unless
>>>>>>> it is exempt from release under the Act. Any material supplied to
>>>>>>> NERC may be stored in an electronic records management system.
>>>>>>>
>>>>>>>
>>>>>>> _______________________________________________
>>>>>>> R-sig-Geo mailing list
>>>>>>> R-sig-Geo at r-project.org
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>>
>>>>>
>>>>
>>>
>>>
>>
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From calamita_giuseppe at yahoo.it  Wed May 30 17:36:55 2012
From: calamita_giuseppe at yahoo.it (Giuseppe Calamita)
Date: Wed, 30 May 2012 08:36:55 -0700 (PDT)
Subject: [R-sig-Geo] How to properly use rsaga.close.gaps()
In-Reply-To: <CAMp9JaMbgGEXPVO0m0jcPYHeAofQxvppS=RK5MiQF17VHyBguA@mail.gmail.com>
References: <1337511983831-7567747.post@n2.nabble.com>
	<CAMp9JaMbgGEXPVO0m0jcPYHeAofQxvppS=RK5MiQF17VHyBguA@mail.gmail.com>
Message-ID: <1338392215538-7579969.post@n2.nabble.com>

Hi Piero! :)
I also tried the code from Hengl's book and running rsaga.* commands didn't
work. I guess that with newer versions of SAGA syntax may be changed.

Did you already check in the official documentation of SAGA GIS?
http://sourceforge.net/projects/saga-gis/files/SAGA%20-%20Documentation/SAGA%202%20User%20Guide/

enjoy! :)

Giuseppe Calamita

--
View this message in context: http://r-sig-geo.2731867.n2.nabble.com/How-to-properly-use-rsaga-close-gaps-tp7567747p7579969.html
Sent from the R-sig-geo mailing list archive at Nabble.com.


From klscales10 at gmail.com  Wed May 30 18:50:01 2012
From: klscales10 at gmail.com (Kylie Scales)
Date: Wed, 30 May 2012 17:50:01 +0100
Subject: [R-sig-Geo] rgdal - errors in projection from latlon to utm
Message-ID: <CAOCVvHOq1CPyBgNNKjNrRjEepHKAuCix1Rvcqzw_EVfe=BA-dQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120530/5ab8b8a2/attachment.pl>

From r.hijmans at gmail.com  Wed May 30 19:52:40 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Wed, 30 May 2012 10:52:40 -0700
Subject: [R-sig-Geo] rgdal - errors in projection from latlon to utm
In-Reply-To: <CAOCVvHOq1CPyBgNNKjNrRjEepHKAuCix1Rvcqzw_EVfe=BA-dQ@mail.gmail.com>
References: <CAOCVvHOq1CPyBgNNKjNrRjEepHKAuCix1Rvcqzw_EVfe=BA-dQ@mail.gmail.com>
Message-ID: <CANtt_hz5OH5kE1-fyPdUGDBf5jsa38DBJ=kcQwo+mTHpqxLR4w@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120530/1edd2a4e/attachment.pl>

From Iain.Dillingham.1 at city.ac.uk  Wed May 30 20:55:52 2012
From: Iain.Dillingham.1 at city.ac.uk (Dillingham, Iain)
Date: Wed, 30 May 2012 19:55:52 +0100
Subject: [R-sig-Geo] Modify spplot frame borders, padding and font
Message-ID: <01C181309AF8BE47AB79274E3F0A2E7A012939617AFF@NSQ165EX.enterprise.internal.city.ac.uk>

Hello everyone,

I have used spplot to draw six small-multiple choropleth maps of London. Although I am happy with the result, I would like to recolour (and potentially remove) the outline from each frame; to add some padding between each map and its containing frame; and finally to change the font used to display the heading in each frame.

I have searched the documentation. However, I am new to R and I have been unable to uncover the mechanism that would allow me to modify these attributes. Any assistance would be gratefully received!

Many thanks,

Iain

--
Iain Dillingham
School of Informatics
City University London
EC1V 0HB
http://www.soi.city.ac.uk/~abhm372/

From zua3 at cornell.edu  Wed May 30 21:08:07 2012
From: zua3 at cornell.edu (Zia Ahmed)
Date: Wed, 30 May 2012 15:08:07 -0400
Subject: [R-sig-Geo] Modify spplot frame borders, padding and font
In-Reply-To: <01C181309AF8BE47AB79274E3F0A2E7A012939617AFF@NSQ165EX.enterprise.internal.city.ac.uk>
References: <01C181309AF8BE47AB79274E3F0A2E7A012939617AFF@NSQ165EX.enterprise.internal.city.ac.uk>
Message-ID: <4FC67017.8030908@cornell.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120530/517d02a0/attachment.pl>

From Iain.Dillingham.1 at city.ac.uk  Wed May 30 22:18:27 2012
From: Iain.Dillingham.1 at city.ac.uk (Dillingham, Iain)
Date: Wed, 30 May 2012 21:18:27 +0100
Subject: [R-sig-Geo] Modify spplot frame borders, padding and font
In-Reply-To: <4FC67017.8030908@cornell.edu>
References: <01C181309AF8BE47AB79274E3F0A2E7A012939617AFF@NSQ165EX.enterprise.internal.city.ac.uk>,
	<4FC67017.8030908@cornell.edu>
Message-ID: <01C181309AF8BE47AB79274E3F0A2E7A012939617B01@NSQ165EX.enterprise.internal.city.ac.uk>

Thank you for the prompt reply. Forgive me, but how did you know that par.settings was an attribute to spplot? I'm struggling with interpreting the documentation. For example, if I wish to remove the outline and background color from each frame title, where would I look for the appropriate parameters and values?

Thank you once again,

Iain
________________________________________
From: Zia Ahmed [zua3 at cornell.edu]
Sent: 30 May 2012 20:08
To: Dillingham, Iain; sig-geo
Subject: Re: [R-sig-Geo] Modify spplot frame borders, padding and font

You can add following line to get a map without frame.
par.settings=list(axis.line=list(col=NA))
For tittle,
main=list("(a) tittle",cex=.6)
For size and space between frames (for nine frames):
windows(width=5.5, height=8)
tiff( file="Fig.tif",width=5.5, height=8,units = "in", pointsize = 12, res=1600,
restoreConsole = T,compression =  "lzw",bg="transparent")

print(a,position = c(0.05,0.5,1,1),split=c(1,1,4,2), more=TRUE,panel.width=list(1.5, "inches"),panel.height=list(1.5, "inches"))
print(b,position = c(0.15,0.5,1,1),split=c(2,1,4,2),more=TRUE,panel.width=list(1.5, "inches"),panel.height=list(1.5, "inches"))
print(c,position = c(0.45,0.5,1,1), split=c(3,1,4,2), more=TRUE,panel.width=list(1.5, "inches"),panel.height=list(1.5, "inches"))
print(d,position = c(0.05,0.5,1,0.65),split=c(1,1,4,2), more=TRUE,panel.width=list(1.5, "inches"),panel.height=list(1.5, "inches"))
print(e,position = c(0.15,0.5,1,0.65),split=c(2,1,4,2),more=TRUE,panel.width=list(1.5, "inches"),panel.height=list(1.5, "inches"))
print(f,position = c(0.45,0.5,1,0.65), split=c(3,1,4,2), more=TRUE,panel.width=list(1.5, "inches"),panel.height=list(1.5, "inches"))
print(g,position = c(0.05,0.5,1,0.30),split=c(1,1,4,2), more=TRUE,panel.width=list(1.5, "inches"),panel.height=list(1.5, "inches"))
print(h,position = c(0.15,0.5,1,0.30),split=c(2,1,4,2),more=TRUE,panel.width=list(1.5, "inches"),panel.height=list(1.5, "inches"))
print(i,position = c(0.45,0.5,1,0.30), split=c(3,1,4,2), more=TRUE,panel.width=list(1.5, "inches"),panel.height=list(1.5, "inches"))
print(j,position = c(0.05,0,1,0.15),split=c(1,1,4,2), more=TRUE,panel.width=list(1.5, "inches"),panel.height=list(1.5, "inches"))
print(k,position = c(0.15,0,1,0.15),split=c(2,1,4,2),more=TRUE,panel.width=list(1.5, "inches"),panel.height=list(1.5, "inches"))
print(l,position = c(0.45,0,1,0.15), split=c(3,1,4,2), more=TRUE,panel.width=list(1.5, "inches"),panel.height=list(1.5, "inches"))
dev.off()

On 5/30/2012 2:55 PM, Dillingham, Iain wrote:

Hello everyone,

I have used spplot to draw six small-multiple choropleth maps of London. Although I am happy with the result, I would like to recolour (and potentially remove) the outline from each frame; to add some padding between each map and its containing frame; and finally to change the font used to display the heading in each frame.

I have searched the documentation. However, I am new to R and I have been unable to uncover the mechanism that would allow me to modify these attributes. Any assistance would be gratefully received!

Many thanks,

Iain

--
Iain Dillingham
School of Informatics
City University London
EC1V 0HB
http://www.soi.city.ac.uk/~abhm372/
_______________________________________________
R-sig-Geo mailing list
R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
https://stat.ethz.ch/mailman/listinfo/r-sig-geo



--
---------------------
Zia Ahmed, PhD
Research Associate
Department of Crop and Soil Sciences
1002 Bradfield Hall, Cornell University
Ithaca, NY 14853-4203
t. 607.255.9387
f. 607.255.3207
email zua3 at cornell.edu<mailto:zua3 at cornell.edu>


From edzer.pebesma at uni-muenster.de  Thu May 31 09:17:12 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 31 May 2012 09:17:12 +0200
Subject: [R-sig-Geo] Modify spplot frame borders, padding and font
In-Reply-To: <01C181309AF8BE47AB79274E3F0A2E7A012939617B01@NSQ165EX.enterprise.internal.city.ac.uk>
References: <01C181309AF8BE47AB79274E3F0A2E7A012939617AFF@NSQ165EX.enterprise.internal.city.ac.uk>,
	<4FC67017.8030908@cornell.edu>
	<01C181309AF8BE47AB79274E3F0A2E7A012939617B01@NSQ165EX.enterprise.internal.city.ac.uk>
Message-ID: <4FC71AF8.5020408@uni-muenster.de>


library(lattice)
trellis.par.set(axis.line=list(col=NA))
library(sp)
loadMeuse()
spplot(meuse.grid[1])

takes away the border, but not only around the map area, also around the
legend colour block.

On 05/30/2012 10:18 PM, Dillingham, Iain wrote:
> Thank you for the prompt reply. Forgive me, but how did you know that par.settings was an attribute to spplot? I'm struggling with interpreting the documentation. For example, if I wish to remove the outline and background color from each frame title, where would I look for the appropriate parameters and values?
> 

AFAICS, par.settings does nothing in the code fragment below.

The spplot documentation says:

Description:

     Lattice (trellis) plot methods for spatial data with attributes

(and much later:)

     for useful values see the appropriate documentation of xyplot and
     levelplot.

so reading into how lattice plots work, e.g. modifying parameters with
trellis.par.set, or reading the documentation of xyplot and levelplot in
package lattice might help. It assumes that the words "lattice" and
"trellis" ring a bell.


> Thank you once again,
> 
> Iain
> ________________________________________
> From: Zia Ahmed [zua3 at cornell.edu]
> Sent: 30 May 2012 20:08
> To: Dillingham, Iain; sig-geo
> Subject: Re: [R-sig-Geo] Modify spplot frame borders, padding and font
> 
> You can add following line to get a map without frame.
> par.settings=list(axis.line=list(col=NA))
> For tittle,
> main=list("(a) tittle",cex=.6)
> For size and space between frames (for nine frames):
> windows(width=5.5, height=8)
> tiff( file="Fig.tif",width=5.5, height=8,units = "in", pointsize = 12, res=1600,
> restoreConsole = T,compression =  "lzw",bg="transparent")
> 
> print(a,position = c(0.05,0.5,1,1),split=c(1,1,4,2), more=TRUE,panel.width=list(1.5, "inches"),panel.height=list(1.5, "inches"))
> print(b,position = c(0.15,0.5,1,1),split=c(2,1,4,2),more=TRUE,panel.width=list(1.5, "inches"),panel.height=list(1.5, "inches"))
> print(c,position = c(0.45,0.5,1,1), split=c(3,1,4,2), more=TRUE,panel.width=list(1.5, "inches"),panel.height=list(1.5, "inches"))
> print(d,position = c(0.05,0.5,1,0.65),split=c(1,1,4,2), more=TRUE,panel.width=list(1.5, "inches"),panel.height=list(1.5, "inches"))
> print(e,position = c(0.15,0.5,1,0.65),split=c(2,1,4,2),more=TRUE,panel.width=list(1.5, "inches"),panel.height=list(1.5, "inches"))
> print(f,position = c(0.45,0.5,1,0.65), split=c(3,1,4,2), more=TRUE,panel.width=list(1.5, "inches"),panel.height=list(1.5, "inches"))
> print(g,position = c(0.05,0.5,1,0.30),split=c(1,1,4,2), more=TRUE,panel.width=list(1.5, "inches"),panel.height=list(1.5, "inches"))
> print(h,position = c(0.15,0.5,1,0.30),split=c(2,1,4,2),more=TRUE,panel.width=list(1.5, "inches"),panel.height=list(1.5, "inches"))
> print(i,position = c(0.45,0.5,1,0.30), split=c(3,1,4,2), more=TRUE,panel.width=list(1.5, "inches"),panel.height=list(1.5, "inches"))
> print(j,position = c(0.05,0,1,0.15),split=c(1,1,4,2), more=TRUE,panel.width=list(1.5, "inches"),panel.height=list(1.5, "inches"))
> print(k,position = c(0.15,0,1,0.15),split=c(2,1,4,2),more=TRUE,panel.width=list(1.5, "inches"),panel.height=list(1.5, "inches"))
> print(l,position = c(0.45,0,1,0.15), split=c(3,1,4,2), more=TRUE,panel.width=list(1.5, "inches"),panel.height=list(1.5, "inches"))
> dev.off()
> 
> On 5/30/2012 2:55 PM, Dillingham, Iain wrote:
> 
> Hello everyone,
> 
> I have used spplot to draw six small-multiple choropleth maps of London. Although I am happy with the result, I would like to recolour (and potentially remove) the outline from each frame; to add some padding between each map and its containing frame; and finally to change the font used to display the heading in each frame.
> 
> I have searched the documentation. However, I am new to R and I have been unable to uncover the mechanism that would allow me to modify these attributes. Any assistance would be gratefully received!
> 
> Many thanks,
> 
> Iain
> 
> --
> Iain Dillingham
> School of Informatics
> City University London
> EC1V 0HB
> http://www.soi.city.ac.uk/~abhm372/
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org<mailto:R-sig-Geo at r-project.org>
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
> 
> 
> 
> --
> ---------------------
> Zia Ahmed, PhD
> Research Associate
> Department of Crop and Soil Sciences
> 1002 Bradfield Hall, Cornell University
> Ithaca, NY 14853-4203
> t. 607.255.9387
> f. 607.255.3207
> email zua3 at cornell.edu<mailto:zua3 at cornell.edu>
> 
> _______________________________________________
> R-sig-Geo mailing list
> R-sig-Geo at r-project.org
> https://stat.ethz.ch/mailman/listinfo/r-sig-geo

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From mboeslin at uni-osnabrueck.de  Thu May 31 10:21:02 2012
From: mboeslin at uni-osnabrueck.de (=?utf-8?q?Matthias_B=C3=B6sling?=)
Date: Thu, 31 May 2012 10:21:02 +0200
Subject: [R-sig-Geo] RGui crashs while writing images
Message-ID: <12fe-4fc72a00-5f-57ad8500@89480272>

Dear List,

i am using R in a studentproject to build a small toolbox for remotesensing. Since remotesensing data is verry big, i am scripting a function that automaticly splits an image in several tiles. There for i use the package 'raster' wich works untill there really fine for me, but in this function (writing multiple files with 'writeRaster()') it leads to a crash of the RGui. I am working on Win XP and tried RGui 2.12.0 and 2.15.0, both showed the same behaviour. I recognized this problem as i implemented a function, that should split all files in a specified directory, so a multiple usage of the main function. So the code itself works (generates the desired output). Is it maybe a problem with closing the files or alocating memory that is still in use?
I also build a GUI for the toolbox and therefore i use the package 'tcl/tk' (only for the case that the crash could have something to do with it).

I am realy thankfull for any help to fix this problem!

summarized:
- Win XP
- RGUI
- package 'raster'
- package 'tcl/tk'
- createting multiple files (and directories in case of the second tiling-function) with 'writeRaster()' (/'dir.create()')


Thanks in advance and best regards
Matthias B?sling


From m.fairbrother at bristol.ac.uk  Thu May 31 14:42:03 2012
From: m.fairbrother at bristol.ac.uk (Malcolm Fairbrother)
Date: Thu, 31 May 2012 13:42:03 +0100
Subject: [R-sig-Geo] =?windows-1252?q?=22rasterize=22_changes_the_data_val?=
 =?windows-1252?q?ues=85_why=3F?=
Message-ID: <DF63E788-9059-4C3B-B582-6C8C85D5F52B@bristol.ac.uk>

Dear list,

I'm trying to use "rasterize" to create a raster out of a SpatialPolygonsDataFrame. The problem I'm having is that, for reasons I don't understand, the data values in the resulting raster ("faosoil") do not correspond to those of the original variable in the SpatialPolygonsDataFrame ("dsmw").

In the code below, you'll see that values for dsmw$FAOSOIL range from 1 to 186. However, when I convert dsmw into a raster, its data values range from 390 to 587, and I can't tell whether these new values correspond in some way to the original ones. I've tried both "field=1" and "field="FAOSOIL"", and they return the same result.

Can anyone tell me how to get the original-scale data into the raster, or what I'm misunderstanding?

Many thanks,
Malcolm


> summary(dsmw)
Object of class SpatialPolygonsDataFrame
Coordinates:
       min      max
x 68.11093 97.39555
y  6.74004 33.17195
Is projected: FALSE 
proj4string :
[+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0]
Data attributes:
    FAOSOIL           DOMSOI     
 Min.   :  1.00   Min.   : 1.00  
 1st Qu.: 56.00   1st Qu.:17.00  
 Median : 79.50   Median :20.00  
 Mean   : 91.47   Mean   :21.53  
 3rd Qu.:138.00   3rd Qu.:28.00  
 Max.   :186.00   Max.   :43.00  
> faosoil <- rasterize(dsmw, bio, field=1)
Found 634 region(s) and 736 polygon(s)
> summary(faosoil)
Cells:  447692 
NAs  :  34484 

               
Min.      390.0
1st Qu.   441.0
Median    495.0
Mean      481.4
3rd Qu.   508.0
Max.      587.0
NA's    34484.0


From zua3 at cornell.edu  Thu May 31 14:44:08 2012
From: zua3 at cornell.edu (Zia Ahmed)
Date: Thu, 31 May 2012 08:44:08 -0400
Subject: [R-sig-Geo] Modify spplot frame borders, padding and font
In-Reply-To: <4FC71AF8.5020408@uni-muenster.de>
References: <01C181309AF8BE47AB79274E3F0A2E7A012939617AFF@NSQ165EX.enterprise.internal.city.ac.uk>,
	<4FC67017.8030908@cornell.edu>
	<01C181309AF8BE47AB79274E3F0A2E7A012939617B01@NSQ165EX.enterprise.internal.city.ac.uk>
	<4FC71AF8.5020408@uni-muenster.de>
Message-ID: <4FC76798.7030702@cornell.edu>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120531/73e02146/attachment.pl>

From edzer.pebesma at uni-muenster.de  Thu May 31 15:07:20 2012
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Thu, 31 May 2012 15:07:20 +0200
Subject: [R-sig-Geo] Plotting with stplot, mode="xy"
In-Reply-To: <28C15D104A882F47954DEE56148152CC2441A112EF@nerckwmb1.ad.nerc.ac.uk>
References: <28C15D104A882F47954DEE56148152CC243F7D872B@nerckwmb1.ad.nerc.ac.uk>
	<4FC4A4C5.4040002@uni-muenster.de>
	<28C15D104A882F47954DEE56148152CC243F7D8AFD@nerckwmb1.ad.nerc.ac.uk>
	<4FC4BFAD.60707@uni-muenster.de>
	<28C15D104A882F47954DEE56148152CC243F7D8CDC@nerckwmb1.ad.nerc.ac.uk>
	<4FC4F428.9080508@uni-muenster.de> <4FC4F768.8040203@52north.org>
	<28C15D104A882F47954DEE56148152CC24407C86B7@nerckwmb1.ad.nerc.ac.uk>
	<4FC5D7E6.9050107@uni-muenster.de>
	<28C15D104A882F47954DEE56148152CC24407C872E@nerckwmb1.ad.nerc.ac.uk>
	<4FC5DD28.80800@uni-muenster.de>
	<28C15D104A882F47954DEE56148152CC2441A112EF@nerckwmb1.ad.nerc.ac.uk>
Message-ID: <4FC76D08.6080206@uni-muenster.de>

You'll need to re-download the stplot.R source file, which now has a
do.repeat argument, and then run:

library(spacetime)
source("/tmp/stplot.R") # or wherever it is
library(animation)
saveGIF({
 stplot(sp_time_slice, animate=0.01, col.regions=bpy.colors(),
    names.attr = paste("Whatever was measured at",
      format(index(sp_time_slice at time), "%H:%M")),
    cex=2,cuts=seq(r[1],r[2],length.out=11), do.repeat=FALSE)
})

this also solves the title issue you mentioned.


On 05/30/2012 11:02 AM, Rawlins, Barry G. wrote:
> Yes that solves it- thanks.
> 
> Re: title - yes I was thinking of a title other than the "time" and I will try subtitle or putting it into an axis label - that is fine.
> 
> Sorry, one further thing - trying to save the animation to a GIF with:
> 
> library(animation)
> saveGIF(
> 
> stplot(sp_time_slice, animate=1,
> col.regions=rainbow(11,start=0.0,end=0.66),cex=2,cuts=c(seq(r[1],r[2],length.out=11)))
> 
> )
> 
> The animated plot just goes back to the start and the GIF does not get saved - I assume this is because stplot is not in a loop which is what saveGIF appears to require to save an animation. Any ideas how I would resolve that? I tried:
> 
> out<-stplot(sp_time_slice,...
> 
> saveGIF
> (
> print(out)
> )
> 
> But that was no good.
> 
> By the way - these data are soil moisture sensor data (15 minute intervals) from a hillslope responding to incident rainfall. I would be happy for you to use these as example data if that is useful to you. 
> 
> Best wishes, Barry
> 
> -----Original Message-----
> From: Edzer Pebesma [mailto:edzer.pebesma at uni-muenster.de] 
> Sent: 30 May 2012 09:41
> To: Rawlins, Barry G.
> Subject: Re: [R-sig-Geo] Plotting with stplot, mode="xy"
> 
> with
> 
>> r= range(sp_time_slice at data$VMC) #[1] 20.7 36.8
>> stplot(sp_time_slice, animate=1,
> col.regions=rep(1,10),cex=2,cuts=c(seq(r[1],r[2],length.out=11)))
> 
> I don't see points dropping, do you?
> 
> On 05/30/2012 10:30 AM, Rawlins, Barry G. wrote:
>> Edzer
>>
>> Here is the data attached as an object and code to run it below:
>>
>> load(file="sp_time_slice.RData")
>>
>> range(sp_time_slice at data$VMC) #[1] 20.7 36.8
>>
>> # so with narrow ranges (20 to 37) - some symbols dropped
>>
>> stplot(sp_time_slice, animate=1, col.regions=rainbow(10,start=0.0,end=0.66),cex=2,cuts=c(seq(20,37,1.7)))
>>
>> # with wider ranges (18, 38) all symbols plot
>>
>> stplot(sp_time_slice, animate=1, col.regions=rainbow(10,start=0.0,end=0.66),cex=2,cuts=c(seq(18,38,2)))
>>
>> I am also struggling to get a title to plot using either
>>
>> lattice.options=list(main="Sensor Net volumetric moisture content (%)"))
>> or 
>> main=list(label="Sensor Net volumetric moisture content (%)")
>>
>> Error in trellis.skeleton(formula = y2 ~ x2, cond = list(c(1L, 1L, 1L,  : 
>>   formal argument "main" matched by multiple actual arguments
>> In addition: Warning message:
>> In seq.default(min(obj[[z]], na.rm = TRUE), max(obj[[z]], na.rm = TRUE),  :
>>   first element used of 'length.out' argument
>>
>> What would you use?
> 
> Well, that's a nice feature request -- I haven't given it much thought,
> and main obviously is not allowed. You could use xlab="some title" or
> sub="subtitle" to see something, but I agree it's not optimal; you'd
> like to have time in subtitle when a main is given, right?
> 
>>
>> Barry
>>
>> -----Original Message-----
>> From: Edzer Pebesma [mailto:edzer.pebesma at uni-muenster.de] 
>> Sent: 30 May 2012 09:19
>> To: Rawlins, Barry G.
>> Subject: Re: [R-sig-Geo] Plotting with stplot, mode="xy"
>>
>> Barry,
>>
>> could you please provide me with a reproducible example that
>> demonstrates that min/max values passed as extremes of cuts discards
>> some points?
>>
>> I cannot reproduce it with:
>>
>>> library(sp)
>>> loadMeuse()
>>> m = meuse[1:4,]
>>> m
>>        coordinates cadmium copper lead zinc  elev       dist   om ffreq soil
>> 1 (181072, 333611)    11.7     85  299 1022 7.909 0.00135803 13.6     1    1
>> 2 (181025, 333558)     8.6     81  277 1141 6.983 0.01222430 14.0     1    1
>> 3 (181165, 333537)     6.5     68  199  640 7.800 0.10302900 13.0     1    1
>> 4 (181298, 333484)     2.6     81  116  257 7.655 0.19009400  8.0     1    2
>>   lime landuse dist.m
>> 1    1      Ah     50
>> 2    1      Ah     30
>> 3    1      Ah    150
>> 4    0      Ga    270
>>> spplot(m["om"], cuts=c(8,10,12,14),col.regions=bpy.colors())
>>> spplot(m["cadmium"], cuts=c(2.6,8,11.7),col.regions=bpy.colors())
>>
>>
>> On 05/30/2012 09:57 AM, Rawlins, Barry G. wrote:
>>> Daniel and Edzer
>>>
>>> I managed to build the stplot.R function and get that working - so thanks for that. The "cut" argument works fine and the scale does not change now as the animation runs. For some reason I needed to make the bin range (min and max) wider than the range of the data to make sure all the xy locations plotted in every amimation (some were dropped otherwise)  - I am not sure why that would be the case.
>>>
>>> I will look for some instructions (presumably on other help lists) on how to build a package from the source as that is not something I have done before, but will be pleased to learn.
>>>
>>> Best wishes, Barry
>>>
>>>  
>>> -----Original Message-----
>>> From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Daniel N?st
>>> Sent: 29 May 2012 17:21
>>> To: r-sig-geo at r-project.org
>>> Subject: Re: [R-sig-Geo] Plotting with stplot, mode="xy"
>>>
>>> Am 29.05.2012 18:07, schrieb Edzer Pebesma:
>>>> On 05/29/2012 04:03 PM, Rawlins, Barry G. wrote:
>>>>> I can see a series of folders+files on the svn area - can you just give me some direction on how I get the source code? Were you suggesting I just take the code under R/stplot.R? And build a function from this?
>>>> I was thinking about building and installing the R package from source,
>>>> but that might be a bridge too far if you're not used to doing that.
>>>>
>>>> It might be easier to source the whole R/stplot.R file in your R session
>>>> -- that should work as well.
>>>
>>> The svn also has http access, so
>>>
>>> source("https://svn.52north.org/svn/geostatistics/main/spacetime/R/stplot.R")
>>>
>>> should do just that.
>>>
>>> /Daniel
>>>
>>>>> -----Original Message-----
>>>>> From: Edzer Pebesma [mailto:edzer.pebesma at uni-muenster.de] 
>>>>> Sent: 29 May 2012 13:23
>>>>> To: Rawlins, Barry G.
>>>>> Subject: Re: [R-sig-Geo] Plotting with stplot, mode="xy"
>>>>>
>>>>> svn co https://svn.52north.org/svn/geostatistics/main/spacetime/
>>>>>
>>>>> will give you the updated source. Let me know if it works, otherwise
>>>>> we'll try the CRAN route (CRAN seems a bit over-worked, lately, for
>>>>> clear reasons, throwing NOTEs if you're uploading too frequent).
>>>>>
>>>>> I just noticed that the package DESCRIPTION file does not contain this
>>>>> URL -- will modify.
>>>>>
>>>>>
>>>>> On 05/29/2012 01:28 PM, Rawlins, Barry G. wrote:
>>>>>> Many thanks Edzer - it is superb to have your help on such occasions.
>>>>>>
>>>>>> Checking CRAN - the latest version of spacetime appears to be 0.7-0 - does that mean I need to wait for 0.7-1 (which you refer to) to be released?
>>>>>>
>>>>>> I did not copy to the list because I was not sure this question was relevant to my problem.
>>>>>>
>>>>>> Best wishes, Barry
>>>>>>
>>>>>>
>>>>>> -----Original Message-----
>>>>>> From: r-sig-geo-bounces at r-project.org [mailto:r-sig-geo-bounces at r-project.org] On Behalf Of Edzer Pebesma
>>>>>> Sent: 29 May 2012 11:28
>>>>>> To: r-sig-geo at r-project.org
>>>>>> Subject: Re: [R-sig-Geo] Plotting with stplot, mode="xy"
>>>>>>
>>>>>> Hi Barry, the following should have worked:
>>>>>>
>>>>>> library(spacetime)
>>>>>> loadMeuse()
>>>>>> d = as.data.frame(meuse)[c("cadmium", "copper", "lead", "zinc")]
>>>>>> x = STFDF(meuse, Sys.time()+1:4, stack(d))
>>>>>> stplot(x, animate=1, col.regions=bpy.colors(),
>>>>>>    cuts=c(1,10,100,1000,10000))
>>>>>>
>>>>>> but doesn't fix the legend with current spacetime on CRAN, as the 'cuts'
>>>>>> argument was not passed on to spplot.
>>>>>>
>>>>>> spacetime 0.7-1 in subversion has this fixed.
>>>>>>
>>>>>> the 'col' argument needs to be called 'col.regions'.
>>>>>>
>>>>>> On 05/28/2012 06:34 PM, Rawlins, Barry G. wrote:
>>>>>>> Hello
>>>>>>>  
>>>>>>> I am trying to plot some space-time data which encompasses 3654 time
>>>>>>> intervals (15 mins each) at 84 sites.
>>>>>>>  
>>>>>>> I would like to animate these data and so I have used the following code
>>>>>>> and my STFDF object is "sp_time":
>>>>>>>  
>>>>>>> colors.ten<-rainbow(10,start=0.0,end=0.66) # rainbow color scale
>>>>>>> stplot(sp_time, mode="xy", animate=1, cuts=10, at=seq(5,55,5),
>>>>>>> auto.key=T,col=colors.ten)
>>>>>>>  
>>>>>>> The first plot I see is this where the points are plotted in the correct
>>>>>>> locations:
>>>>>>>  
>>>>>>> But, I wanted some bespoke rainbow colors which do not appear and I know
>>>>>>> the z-range of the data is wider than that shown - the range is actually
>>>>>>> between 6 and 44. When I run the animation the scale changes each time
>>>>>>> but I would like it to be fixed so that each time slice has the same
>>>>>>> scale. Any advice on how I can solve this? I have tried reading the help
>>>>>>> pages on levelplot but to no avail.
>>>>>>>  
>>>>>>> Thanks, Barry
>>>>>>>  
>>>>>>>  
>>>>>>>  
>>>>>>>  
>>>>>>>
>>>>>>> -- 
>>>>>>> This message (and any attachments) is for the recipient only. NERC
>>>>>>> is subject to the Freedom of Information Act 2000 and the contents
>>>>>>> of this email and any reply you make may be disclosed by NERC unless
>>>>>>> it is exempt from release under the Act. Any material supplied to
>>>>>>> NERC may be stored in an electronic records management system.
>>>>>>>
>>>>>>>
>>>>>>> _______________________________________________
>>>>>>> R-sig-Geo mailing list
>>>>>>> R-sig-Geo at r-project.org
>>>>>>> https://stat.ethz.ch/mailman/listinfo/r-sig-geo
>>>>>>
>>>>>
>>>>
>>>
>>>
>>
> 

-- 
Edzer Pebesma
Institute for Geoinformatics (ifgi), University of M?nster
Weseler Stra?e 253, 48151 M?nster, Germany. Phone: +49 251
8333081, Fax: +49 251 8339763  http://ifgi.uni-muenster.de
http://www.52north.org/geostatistics      e.pebesma at wwu.de


From r.hijmans at gmail.com  Thu May 31 18:21:44 2012
From: r.hijmans at gmail.com (Robert J. Hijmans)
Date: Thu, 31 May 2012 09:21:44 -0700
Subject: [R-sig-Geo]
	=?windows-1252?q?=22rasterize=22_changes_the_data_val?=
	=?windows-1252?q?ues=85_why=3F?=
In-Reply-To: <DF63E788-9059-4C3B-B582-6C8C85D5F52B@bristol.ac.uk>
References: <DF63E788-9059-4C3B-B582-6C8C85D5F52B@bristol.ac.uk>
Message-ID: <CANtt_hwcJW2HeHVw6GK231+mAgTvNhkMueFOFBOCipsX8KdgRA@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120531/392f017f/attachment.pl>

From j2kennel at gmail.com  Thu May 31 19:14:40 2012
From: j2kennel at gmail.com (Jonathan Kennel)
Date: Thu, 31 May 2012 13:14:40 -0400
Subject: [R-sig-Geo] Raster package: list vs arrays for creating a raster
	brick
Message-ID: <CABP0dEg-f1q8XCihCB+i3VZvD5geED7v2wVPhXg9jaJPrd-WBQ@mail.gmail.com>

An embedded and charset-unspecified text was scrubbed...
Name: not available
URL: <https://stat.ethz.ch/pipermail/r-sig-geo/attachments/20120531/2220d8bf/attachment.pl>

